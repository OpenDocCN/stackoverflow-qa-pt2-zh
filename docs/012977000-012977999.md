# StackOverflow 问答 12977000-12977999

# google-apps-script - ScriptDB 自动编号

> ID：12977005
> 
> 赞同：2
> 
> 时间：2012-10-19T15:00:21.510
> 
> 标签：google-apps-script

我有一个像这样的数据库：

```
var db = ScriptDb.getMyDb();

var ob = {
    type: "employee",
    employee_id: 1,
    name: {
        first: "Fatima", 
        initial: "S", 
        last: "Pauli"
    },
    address: {
        street: "4076 Washington Avenue",
        city: "Jackson", state: "MS", zip: "39201"
    },
    department_id: 52
};

var stored = db.save(ob); 
```

现在我希望在`employee_id`不循环整个现有数据库的情况下自动递增。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:07:40.170

一种解决方案是将当前的最大值存储`employee_id`在一个单独的`ScriptDB`对象中，并在读取和递增操作期间使用[LockService](https://developers.google.com/apps-script/class_lockservice)提供原子性，如此处所示[。](https://developers.google.com/apps-script/scriptdb#atomicity_and_transactions)

# php - PayPal沙盒IPN不再响应

> ID：12977015
> 
> 赞同：2
> 
> 时间：2012-10-19T15:00:45.080
> 
> 标签：php, paypal, paypal-ipn, paypal-sandbox

我正在使用 Paypal 沙箱测试我的 PHP 脚本，该脚本适用于`www.paypal.com`但不适用于`www.sandbox.paypal.com`. 我最近收到一封来自 PayPal 的电子邮件，要求使用 HTTP 1.1 协议而不是 1.0，所以我已经这样做了，并且我正在使用`Connection: close`指定的标头中的 ，但 IPN URL 挂起。当我尝试它时`www.paypal.com`没有悬挂。

PayPal 在他们的第二封电子邮件中明确说明了这一点

> 这是我们在 2012 年 9 月 6 日发送的公告的后续内容。我们注意到一些商家在更新其 IPN 脚本以使用 HTTP 1.1 时遇到问题，因为这些脚本会“挂起”或需要很长时间是时候得到“已验证”的回复了。我们包含有关如何通过在 HTTP 请求中添加“连接：关闭”标头来解决此问题的说明。

但显然这行不通。

```
$header = "POST /cgi-bin/webscr HTTP/1.1\r\n";
$header .= "Host: $url\r\n";
$header .= "Content-Type: application/x-www-form-urlencoded\r\n";
$header .= "Content-Length: " . strlen($req) . "\r\n\r\n";
$header .= "Connection: close\r\n"; 
```

有任何想法吗？非常感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-11T14:49:55.880

您在倒数第二行有 \r\n\r\n ，它需要在最后一行...

```
$header = "POST /cgi-bin/webscr HTTP/1.1\r\n";
$header .= "Host: $url\r\n";
$header .= "Content-Type: application/x-www-form-urlencoded\r\n";
$header .= "Content-Length: " . strlen($req) . "\r\n";
$header .= "Host: www.paypal.com\r\n"; 
$header .= "Connection: close\r\n\r\n"; 
```

您还需要 Host 行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:53:06.560

我不知道它为什么挂起的答案，但使用`curl`而不是`fsockopen`似乎解决了我的问题。我在这里使用了解决方案；

[https://www.x.com/developers/PayPal/documentation-tools/code-sample/216623](https://www.x.com/developers/PayPal/documentation-tools/code-sample/216623)

# php - 使用 PHP 将大型数据库转储为 JSON

> ID：12977019
> 
> 赞同：4
> 
> 时间：2012-10-19T15:00:53.733
> 
> 标签：php, mysql, json

我正在处理的应用程序有一点问题。该应用程序用作开发人员工具，用于将 MySQL 服务器中的数据库中的表转储到开发人员使用 Unix curl 命令获取的 JSON 文件。到目前为止，我们一直在使用的数据库是相对较小的表（2GB 或更少），但是最近我们进入了另一个测试阶段，使用完全填充的表（40GB+）和我的简单 PHP 脚本中断。这是我的脚本：

```
[<?php 

$database = $_GET['db'];

ini_set('display_errors', 'On');
error_reporting(E_ALL);

# Connect
mysql_connect('localhost', 'root', 'root') or die('Could not connect: ' . mysql_error());

# Choose a database
mysql_select_db('user_recording') or die('Could not select database');

# Perform database query
$query = "SELECT * from `".$database."`";
$result = mysql_query($query) or die('Query failed: ' . mysql_error());

while ($row = mysql_fetch_object($result)) {
   echo json_encode($row);
   echo ",";
}

?>] 
```

我的问题是我可以做些什么来使这个脚本更好地处理更大的数据库转储。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:21:21.600

这就是我认为的问题所在：

你正在使用`mysql_query`. mysql_query 在内存中缓冲数据，然后 mysql_fetch_object 只是从内存中获取该数据。对于非常大的表，您只是没有足够的内存（很可能您将所有 40G 的行都放入一个调用中）。

改为使用`mysql_unbuffered_query`。[有关MySQL 性能博客](http://www.mysqlperformanceblog.com/2007/07/06/php-large-result-sets-and-summary-tables/)的更多信息，您可以在此处找到导致此行为的其他一些可能原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T16:26:58.653

我想说让mysql为你做，而不是php：

```
SELECT 
 CONCAT("[",
      GROUP_CONCAT(
           CONCAT("{field_a:'",field_a,"'"),
           CONCAT(",field_b:'",field_b),"'}")
      )
 ,"]") 
AS json FROM table; 
```

它应该生成如下内容：

```
[
    {field_a:'aaa',field_b:'bbb'},
    {field_a:'AAA',field_b:'BBB'}
] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:53:44.330

MySQL 缓冲可能有问题。但是，您可能还有其他问题。如果您的脚本超时，请尝试使用 set_time_limit(0) 禁用超时。这是一个简单的修复，所以如果这不起作用，您也可以尝试：

1.  尝试离线转储数据库，然后通过脚本或直接 http 传输它。您可以尝试让第一个 PHP 脚本调用一个 shell 脚本，该脚本调用一个 PHP-CLI 脚本，将您的数据库转储为文本。然后，只需通过 HTTP 拉取数据库。
2.  尝试让您的脚本转储数据库的一部分（行 0 到 N、N+1 到 2N 等）。
3.  您是否在 http 连接上使用压缩？如果您的延迟是传输时间（而不是脚本处理时间），那么通过压缩加速传输可能会有所帮助。如果是数据传输，JSON 可能不是传输数据的最佳方式。也许是的。我不知道。这个问题可能会对您有所帮助： [Preferred method to store PHP arrays (json_encode vs serialize)](https://stackoverflow.com/questions/804045/preferred-method-to-store-php-arrays-json-encode-vs-serialize)

此外，对于选项 1 和 3，您可以尝试查看以下问题：

[处理此问题的最佳方法是什么：通过 PHP 进行大量下载 + 客户端连接缓慢 = 文件完全下载之前脚本超时](https://stackoverflow.com/questions/3610453/what-is-the-best-way-to-handle-this-large-download-via-php-slow-connection-fr)

# mysql - 在 SQL 数据库中存储权重的最佳实践？

> ID：12977021
> 
> 赞同：14
> 
> 时间：2012-10-19T15:00:58.093
> 
> 标签：mysql, database-design

我正在处理的应用程序需要存储格式的权重`X pounds, y.y ounces`。数据库是 MySQL，但我想这与 DB 无关。

我可以想到三种方法来做到这一点：

1.  将重量转换为小数磅并存储在单个字段中。（5 磅 6.2 盎司 = 5.33671875 磅）
2.  将重量转换为十进制盎司并存储在单个字段中。（5 磅 6.2 盎司 = 86.2 盎司）
3.  在两个字段中将磅部分存储为整数，将盎司部分存储为小数。

我认为#1 不是一个好主意，因为小数磅会产生任意精度的数字，这需要存储为浮点数，这可能导致浮点数固有的不准确性。

是否有令人信服的理由选择 #2 而不是 #3 或反之亦然？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-19T15:03:09.227

> # TL;博士
> 
> 选择选项#1 或选项#2——它们之间没有区别。不要使用选项#3，因为使用起来很尴尬。

您声称浮点数存在固有的不准确性。我认为这值得首先探讨一下。

在决定用[数字系统](http://en.wikipedia.org/wiki/Numeral_system)来表示数字时（无论是在一张纸上、在计算机电路中还是在其他地方），有两个*不同*的问题需要考虑：

1.  它的*依据*；和

2.  它的*格式*。

# 选择一个基地，任何基地......

**受限于有限空间，不能代表[无限集合](http://en.wikipedia.org/wiki/Infinite_set)的任意成员。** 例如：无论你买了多少纸或你的字迹有多小，总有可能找到一个不适合给定空间的整数（你可以一直附加额外的数字，直到纸用完）。因此，对于*整数*，我们通常将有限空间限制为仅表示落在某个特定区间内的那些——例如，如果我们为正/负号和三位数字留有空间，我们可能会将自己限制在区间内`[-999,+999]`。

***每个*非空[区间](http://en.wikipedia.org/wiki/Interval_(mathematics))都包含一组无限的实数。** 换句话说，无论哪个区间接管*实数*——无论是 、还是`[-999,+999]`其他任何区间——在该区间内仍然有无限的实数集（只需不断附加（非零）小数位）！因此，任意实数必须*始终*“四舍五入”为*可以*在有限空间中表示的东西。`[0,1]``[0.000001,0.000002]`

 ****可以在有限空间中表示的实数集取决于所使用的数字系统。** 在我们（熟悉的）[位置](http://en.wikipedia.org/wiki/Positional_notation) [以 10 为底的](http://en.wikipedia.org/wiki/Decimal)系统中，有限空间足以满足二分之一（）但不能满足三分之一（）；相比之下，在（不太熟悉的）位置[基 9](http://en.wikipedia.org/wiki/Nonary)系统中，情况正好相反（这些相同的数字分别是和）。所有这一切的结果是，一些数字可以仅使用位置基数为 10 的少量空间来表示（因此*出现*[`0.5[10]`](http://www.wolframalpha.com/input/?i=one-half+in+base+10)[`0.33333…[10]`](http://www.wolframalpha.com/input/?i=one-third+in+base+10)[`0.44444…[9]`](http://www.wolframalpha.com/input/?i=one-half+in+base+9)[`0.3[9]`](http://www.wolframalpha.com/input/?i=one-third+in+base+9)*对我们人类来说非常“圆”），例如十分之一，实际上需要精确存储无限的二进制电路（因此对于我们的数字朋友来说似乎不是很“圆”）！值得注意的是，由于 2 是 10 的因数，因此反过来也不一样：任何可以用有限二进制表示的数字也可以用有限十进制表示。*

 ***对于连续数量，我们不能做得更好。***最终，这样的数量必须在某个*数字系统 中使用有限表示：该系统是否恰好在计算机电路、人类手指、其他东西上或根本不存在是任意的——无论使用哪种系统，该值都*必须*四舍五入并且因此它*总是*导致“表示错误”。

换句话说，即使一个人拥有一台完全准确的测量仪器（这在物理上是不可能的），那么它报告的任何测量结果*都已经被四舍五入*到一个恰好适合其显示的数字（无论它使用什么基数——通常是十进制，原因很明显）。因此，“86.2 oz”实际上并不是“ *86.2 oz* ”，而是“ *86.1500000...oz 和 86.2499999...oz* ”之间的代表。（实际上，因为实际上该工具是不完美的，所以我们只能说我们对实际值落在该区间内有一定[程度的信心](https://en.wikipedia.org/wiki/Confidence_interval)——但这肯定与这里的观点有所不同）。

**但是对于离散量我们可以做得更好**。这些值不是“任意实数”，因此上述任何一项都不适用于它们：它们可以在定义它们的数字系统中*精确*表示——实际上，*应该是*（如转换为另一个数字系统并截断为有限长度会导致舍入为不精确的数字）。计算机可以（低效地）通过将数字表示为字符串来处理这种情况：例如，考虑[ASCII](http://en.wikipedia.org/wiki/ASCII)或[BCD](http://en.wikipedia.org/wiki/Binary-coded_decimal)编码。

# 应用格式...

由于它是数字系统（有点随意）基础的属性，因此值是否看起来是“圆形”与其***精度*****无关***。这是一个*非常重要的观察*，与许多人的直觉背道而驰（这也是我在上面花了这么多时间解释数字基础的原因）。*

 *相反，精度取决于**一个表示有****多少[有效数字](http://en.wikipedia.org/wiki/Significant_figures)**。我们需要一种能够将我们的值记录到*至少**与我们认为正确的*有效数字一样多的存储格式。以我们认为在表示为`86.2`和时正确的值为例`0.0000862`，两个最常见的选项是：

*   **Fixed point**，其中有效数字的数量*取决于幅度*：例如，在固定的 5 位小数点表示中，我们的值将存储为`86.20000`and `0.00009`（因此分别具有 7 和 1 位有效数字的精度）。在这个例子中，后一个值*失去了精度*（事实上，我们完全无法表示*任何*重要的东西并不需要更多的时间）；而前一个值存储了*[错误的精度](http://en.wikipedia.org/wiki/False_precision)*，这是对我们有限空间的浪费（实际上，值变得如此之大以至于溢出存储容量并不需要太多时间）。

    当这种格式可能适用于会计系统时，一个常见的例子是：货币金额通常必须跟踪*到美分*，而不管其大小（因此小值需要较少的精度，而大值需要更高的精度）。碰巧，货币通常也被认为是离散的（便士是不可分割的），因此这也是一个很好的例子，说明需要特定基础（大多数现代货币的十进制）以避免上面讨论的表示错误。

    > **通常通过将一个值视为公分母上的商并将分子存储为整数**来实现定点存储。在我们的示例中，公分母可以是 10 ⁵，因此用 1 代替1 将存储整数，`86.20000`并且记住它们必须除以。`0.00009``8620000``9``100000`

*   **浮点数**，其中有效数字的数量是*恒定的，与大小无关*：例如，在 5 位有效数字十进制表示中，我们的值将存储为`86.200`和`0.000086200`（并且根据定义，两次都具有 5 个有效数字）。在此示例中，两个值都已存储*而没有任何精度损失*；并且它们都具有*相同数量*的错误精度，这样浪费更少（因此我们可以使用我们的有限空间来表示更大范围的值——无论大小）。

    当这种格式可能适用于记录*任何现实世界的测量*时，一个常见的例子是：测量仪器的精度（都受到[系统](http://en.wikipedia.org/wiki/Systematic_error)误差和[随机](http://en.wikipedia.org/wiki/Random_error)误差的影响）是相当恒定的，与规模无关，因此，给定足够的有效数字（通常在 3 左右）或 4 位），*即使更改基数导致舍入到不同的*数字，也绝对不会丢失精度。

    > **通常通过将一个值视为具有整数指数的****整数[有效](http://en.wikipedia.org/wiki/Significand)**数来实现浮点存储。在我们的示例中，有效数字可以是`86200`两个值，因此（以 10 为底）指数分别是`-4`和`-9`。

    但是我们的计算机使用**的浮点存储格式有多精确？**

    *   [IEEE754](http://en.wikipedia.org/wiki/IEEE_floating_point) 单精度（ binary32 [）浮点数](http://en.wikipedia.org/wiki/Single-precision_floating-point_format)有 24 位或（超过 7）位有效数字，即它的容差小于. 换句话说，它比说“ ”更精确。`log[10](2^(24))``±0.000006%``86.20000`

    *   一个 IEEE754[双精度（binary64）浮点数](http://en.wikipedia.org/wiki/Double-precision_floating-point_format)有 53 位，或（几乎 16）位有意义——即它的容差刚好超过. 换句话说，它比说“ ”更精确。`log[10](2^(53))``±0.00000000000001%``86.2000000000000`

    要意识到的最重要的事情是，这些格式分别比说“86.2”的精度高一万多万亿倍——即使将二进制精确转换回十进制恰好包含错误的**错误**精度*（**我们*必须忽略：稍后会详细介绍）！

 ****另请注意，当已知值比格式支持的更精确时，*定点*和*浮点*格式都会导致精度损失。** 这种[舍入误差](http://en.wikipedia.org/wiki/Round-off_error)可以在算术运算中传播以产生明显错误的结果（这无疑解释了您对浮点数的“固有不准确性”的引用）：例如，在 5 位定点中将产生而不是; 并且在 5 位有效数字中，浮点数将产生而不是.`¹⁄[3] × 3000``999.99000``1000.00000``¹⁄[7] − ⁷⁄[50]``0.0028600``0.0028571`

[数值分析](http://en.wikipedia.org/wiki/Numerical_analysis)领域致力于理解这些影响，但重要的是要认识到*任何*可用的系统（甚至在你的头脑中执行计算）都容易受到这些问题的影响，因为**没有一种可以保证终止的计算方法可以提供无限的精度**：例如，考虑如何计算圆的面积——用于 π 的值必然会损失精度，这会传播到结果中。

# 结论

1.  **现实世界的测量应该使用二进制浮点**：它快速、紧凑、极其精确并且不比其他任何东西差（包括您开始使用的十进制版本）。由于[MySQL 的浮点数据类型](http://dev.mysql.com/doc/en/floating-point-types.html)是 IEEE754，这正是它们提供的。

2.  **货币应用程序应该使用 denary 定点**：虽然它很慢并且浪费内存，但它确保值不会四舍五入到不精确的数量，并且便士不会因大额货币而丢失。由于[MySQL 的定点数据类型](http://dev.mysql.com/doc/en/fixed-point-types.html)是 BCD 编码的字符串，这正是它们提供的。

最后，请记住，**编程语言通常使用二进制浮点**类型表示小数值：因此，如果您的数据库以另一种格式存储值，您需要小心它们是如何被带入您的应用程序的，否则它们可能会被转换（所有随之而来的问题）在接口处。

# 在这种情况下哪个选项最好？

希望我已经说服您，您的值可以安全地（并且*应该*）存储在浮点类型中，而不必过多担心任何“不准确”？请记住，它们比您脆弱的 3 位有效数字十进制表示*更*精确：您只需要忽略错误精度（但无论如何都必须*始终*这样做，即使使用定点十进制格式）。

至于您的问题：选择选项 1 或选项 2 而不是选项 3-它使比较更容易（例如，要找到最大质量，可以只使用`MAX(mass)`，而要跨两列有效地进行则需要一些嵌套）。

在这两者之间，选择哪一个并不重要——浮点数以恒定数量的有效位存储，*而与它们的比例*无关。

此外，虽然在一般情况下，可能会使用选项 1 将某些值四舍五入为更接近其原始十进制表示的二进制数，而同时使用选项 2 将其他值四舍五入为更接近其原始十进制表示的二进制数，如我们很快就会看到这种表示错误只会在应该始终被忽略的错误精度中表现出来。

但是，在*这种*情况下，因为碰巧有 16 盎司到 1 磅（16 是 2 的幂），原始十进制值和使用两种方法存储的二进制数之间的相对差异是*相同*的：

1.  `5.3875[10]`（不是您的问题中所述）将存储在 binary32 浮点数中为（即）：这是来自原始值（但是，如上所述，“原始值”已经是它的物理量的非常糟糕的表示代表）。`5.33671875[10]``101.011000110011001100110[2]``5.38749980926513671875[10]``0.0000036%`

    知道 binary32 浮点数只存储 7 个十进制数字的精度，我们的编译器*肯定*知道从第 8 位开始的所有内容*肯定*是错误精度，因此在*每种情况下都**必须*忽略- 因此，***只要我们的输入值不需要更多比这更精确***（如果确实如此，binary32 显然是错误的格式选择），这*保证*了返回一个十进制值，看起来和我们开始时一样圆：. 但是，我们应该真正应用[领域知识](http://en.wikipedia.org/wiki/Domain_knowledge)***`5.387500[10]`此时（就像我们应该使用任何存储格式一样）丢弃可能存在的任何进一步的错误精度，例如那两个尾随零。***

****   `86.2[10]`将存储在 binary32 浮点数中（即）：这也来自原始值。和以前一样，我们然后忽略错误精度以返回我们的原始输入。`1010110.00110011001100110[2]``86.1999969482421875[10]``0.0000036%`*** 

 ***注意数字的二进制表示是如何相同的，除了[小数点](http://en.wikipedia.org/wiki/Radix_point)的位置（相隔四位）：

```
101.0110 00110011001100110
101 0110.00110011001100110

```

这是因为 5.3875 × 2 ⁴ = 86.2。

^(顺便说一句：作为欧洲人（尽管是英国人），我对英制测量单位也有强烈的反感——处理不同尺度的值真是*太*麻烦了。我几乎肯定会以[SI 单位](http://en.wikipedia.org/wiki/International_System_of_Units)（例如千克或克）存储质量，然后在我的应用程序的*表示层中根据需要执行到英制单位的转换。*再加上严格遵守 SI 单位，有一天可能会让您免于[损失 1.25 亿美元](http://edition.cnn.com/TECH/space/9909/30/mars.metric.02)。)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-19T15:30:23.907

我很想将它存储在公制单位中，因为它们往往是简单的小数，而不是像磅和盎司这样的复杂值。这样，您可以只存储一个值（即 103.25 公斤）而不是磅 - 盎司等值，并且更容易执行转换。

这是我过去处理过的事情。我在职业摔跤和综合格斗 (MMA) 网站上做了很多工作，这些网站需要记录选手的身高和体重。它们倾向于显示为英尺和英寸以及磅和盎司，但我仍然将这些值存储在它们的厘米和千克等值中，然后在网站上显示时进行转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:05:47.337

首先，我不知道浮点数是如何不准确的——谢天谢地，后者帮助我理解：[浮点数不准确示例](https://stackoverflow.com/questions/2100490/floating-point-inaccuracy-examples)

我完全同意@eggyal - 将数据以单一格式保存在单个列中。这允许您将它公开给应用程序并让应用程序处理它的表示 - 无论是磅/盎司，四舍五入的磅，等等。

数据库应保留原始数据，而表示层决定布局。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-02T00:21:27.010

您可以对权重列使用十进制数据类型。

```
decimal('weight', 8, 2);        // precision = 8, scale = 2 
```

```
Storage size:
Precision 1-9       5 Bytes
Precision 10-19     9 Bytes
Precision 20-28     13 Bytes
Precision 29-38     17 Bytes 
```*********

# objective-c - 对 NSString 不变性感到困惑

> ID：12977024
> 
> 赞同：3
> 
> 时间：2012-10-19T15:01:05.403
> 
> 标签：objective-c, cocoa, nsstring

我是一个 Objective-C 新手。我正在为可变性/不变性这两个概念而苦苦挣扎。我正在阅读一本名为 Programming in Objective-C 4th Edition 的书。第 15 章讨论了`NSString`被声明为不可变的类。然后，这本书提供了一些似乎与此相矛盾的例子，例如：

```
NSString *str1 = @"this is string A";
NSString *str2 = @"this is string B";

str2 = [str1 stringByAppendingString:str2];

NSString *res; 

res = [str1 substringToIndex:3];
res = [str1 substringFromIndex:5];
res = [[str1 substringFromIndex:8]substringToIndex:6];
res = [str1 substringWithRange:NSMakeRange(8, 6)]; 
```

所以即使'res'是一个指向不可变对象的指针，它的值已经改变了好几次，那怎么能称为不可变呢？我想我完全没有抓住重点。任何建议，感激不尽。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:09:59.220

在以下几行中：

```
NSString *str2 = @"this is string B";
str2 = [str1 stringByAppendingString:str2]; 
```

您不会更改字符串“this is string B”的**内容**（存储在变量中`str2`），而是使变量`str2`指向不同的字符串（由该方法生成的**新**`stringByAppendingString:`字符串）。

这里的区别与 C 中的`const char*`和之间的区别非常相似`char* const`。

*   `NSString*`并且`const char*`两者都表示指向其内容无法更改的字符串（Cocoa 或 C resp.）的指针。变量仍然可以指向不同的字符串，但原始字符串不会改变其内容。
*   这与指向类似`char* const`or的字符串的常量指针不同`NSMutableString* const`，后者是指向可变字符串的常量指针，这意味着字符串本身的内容可以更改，但变量/指针将始终指向内存中的相同地址。

* * *

研究这个例子：

```
NSString* str1 = @"A";
NSString* str2 = str1; // points to the same immutable string
NSString* str3 = [str1 stringByAppendingString:@"B"];
// Now str1 and str2 both point to the string "A" and str3 points to a new string "AB"
str2 = str3;
// Now str2 points to the same string as str3 (same memory address and all)
// So str1 points to string "A" and str2 and str3 both point to "B" 
```

请注意，在该示例中， str1 没有更改并且仍然是`"A"`. 它没有发生变异。这与其他示例不同：

```
NSMutableString* str1 = [NSMutableString stringWithString:@"A"];
NSMutableString* str2 = str1; // points to the same mutable string
[str2 appendString:@"B"];
// Now str1 and str2 still both point to the same string, but
// this same string has been mutated and is now "AB"
// So the string that previously was "A" is now "AB" but is still as the same address in memory
// and both str1 and str2 points to this address so are BOTH equal to string "AB" 
```

在第二个示例中，字符串发生了变异，因此指向该字符串的两个变量`str1`现在`str2`都包含“AB”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:03:13.887

字符串对象的*内容*是不可变的。您仍然可以获取指针并使其指向另一个对象。

```
NSString *s = @"string1";
s = @"string2" 
```

这不会改变第一个字符串对象的内容。它只是分配一个新的字符串对象并`*s`指向它。内存中仍然会有一个字符串对象“string1”（如果你不使用 ARC），没有任何东西指向它（稍后会被释放）。

尝试这个：

```
NSString *s = @"string1";
NSLog(@"String object at address %p has content %@.", s, s);
s = @"string2";
NSLog(@"String object at address %p has content %@.", s, s); 
```

```
Test[1819:303] String object at address 0x100002890 has content string1.
Test[1819:303] String object at address 0x1000028d0 has content string2. 
```

如您所见，在不同的地址创建了一个新实例。

`stringWith...`以类名（如或）开头的方法`arrayWith...`通常会返回该类的新实例。

您可以使用其中一种方法进行与上述相同的测试：

```
NSString *s = @"string1";
NSLog(@"String object at address %p ha content %@", s, s);
s = [s substringToIndex:3];
NSLog(@"String object at address %p ha content %@", s, s); 
```

```
Test[1857:303] String object at address 0x1000028a0 ha content string1
Test[1857:303] String object at address 0x10012ab70 ha content str 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:02:59.857

因为您正在更改`res`指向的内容，而不是更改指向的内容。

# symfony - Symfony2 灯具

> ID：12977026
> 
> 赞同：0
> 
> 时间：2012-10-19T15:01:10.820
> 
> 标签：symfony, doctrine, fixtures

我在 Smyony2 上尝试使用 d:f:l 时遇到了这个错误，我在 Servicio 和 Usuario 上遇到了同样的错误，所以我发布了一个示例，如果你帮助我，另一个也将得到修复。

```
 [ErrorException]
  Catchable Fatal Error: Argument 1 passed to PGE\BitacoraBundle\Entity\Tarea::setServicio() must be an instance of PGE\BitacoraBundle\Entity\Servicio, integer given, called in D:\Zend\Apache2\htdocs\PGE\src\PGE\BitacoraBu
  ndle\DataFixtures\ORM\Tareas.php on line 20 and defined in D:\Zend\Apache2\htdocs\PGE\src\PGE\BitacoraBundle\Entity\Tarea.php line 281 
```

这是代码：

Tareas.php

```
<?php
namespace PGE\BitacoraBundle\DataFixtures\ORM;

use Doctrine\Common\DataFixtures\AbstractFixture;
use Doctrine\Common\DataFixtures\OrderedFixtureInterface;
use Doctrine\Common\Persistence\ObjectManager;
use PGE\BitacoraBundle\Entity\Tarea;

class Tareas extends AbstractFixture implements OrderedFixtureInterface
{
    public function getOrder()
    {
        return 3;
    }
    public function load(ObjectManager $manager)
    {
        for ($i = 1; $i < 5; $i++) {
            $entidad = new Tarea();

            $entidad->setServicio($i);

            $entidad->setFechaInicio(new \DateTime());
            $entidad->setFechaFinal(new \DateTime());
            $entidad->setDescripcion('Descripcion aqui');
            $entidad->setEstado('Pendiente');
            $entidad->setPrioridad('P1');
            $entidad->setResumen('Hola soy un resumen');
            $entidad->setSolicitante('x068753');
            $entidad->setUsuario($i);
        }
    $manager->flush();
    }
} 
```

Usuario.php

```
<?php
namespace PGE\BitacoraBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
* @ORM\Entity
* @ORM\Table(name="bitacora_usuario")
*/
class Usuario
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue
    */
    private $id;

    /** @ORM\Column(type="string", length=255) */
    private $nombre;

    /** @ORM\Column(type="string", length=255) */
    private $apellidos;

    /** @ORM\Column(type="string", length=255) */
    private $prbes;

    public function __toString()
    {
        return $this->getNombre().' '.$this->getApellidos();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set nombre
     *
     * @param string $nombre
     * @return Usuario
     */
    public function setNombre($nombre)
    {
        $this->nombre = $nombre;

        return $this;
    }

    /**
     * Get nombre
     *
     * @return string 
     */
    public function getNombre()
    {
        return $this->nombre;
    }

    /**
     * Set apellidos
     *
     * @param string $apellidos
     * @return Usuario
     */
    public function setApellidos($apellidos)
    {
        $this->apellidos = $apellidos;

        return $this;
    }

    /**
     * Get apellidos
     *
     * @return string 
     */
    public function getApellidos()
    {
        return $this->apellidos;
    }

    /**
     * Set prbes
     *
     * @param string $prbes
     * @return Usuario
     */
    public function setPrbes($prbes)
    {
        $this->prbes = $prbes;

        return $this;
    }

    /**
     * Get prbes
     *
     * @return string 
     */
    public function getPrbes()
    {
        return $this->prbes;
    }
} 
```

编辑：我正在使用 Symfony 2.1.X

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:06:42.600

捆绑包没有问题，相反，它非常清楚地表明传递给的第一个参数`$entidad->setServicio($i);`必须是一个实例`PGE\BitacoraBundle\Entity\Servicio`而不是整数。

所以你没有得到一个 Serivcio 的实例并将它传递给 setter。如果您在另一个夹具中创建服务，您需要查看捆绑文档的夹具部分[之间的共享对象。](http://symfony.com/doc/current/bundles/DoctrineFixturesBundle/index.html#sharing-objects-between-fixtures)

# c# - C#中带有两列的组合框

> ID：12977027
> 
> 赞同：1
> 
> 时间：2012-10-19T15:01:16.197
> 
> 标签：c#

> **可能重复：**
> [具有多列的 WinForms 组合框（C#）？](https://stackoverflow.com/questions/1091414/winforms-combobox-with-multiple-columns-c)

我这个程序 ALTER proc [dbo].[VCNAE] as select cnae_id,cnae_descricao, cnae_classe from tbl_CNAE order by cnae_descricao

我用于填充此数据集

```
 SqlCommand llena4 = new SqlCommand("vcnae", abre);
        llena4.CommandType = CommandType.StoredProcedure;
        da2.SelectCommand = llena4;
        da2.Fill(carga1, "cnae");//4 
```

然后我填充组合框

```
 BindingSource srd = new BindingSource();
         srd.DataSource = llenar.Tables["cnae"];
         CmbCnaePrin.DataSource = srd;
         CmbCnaePrin.DisplayMember = "cnae_descricao" ;
         CmbCnaePrin.ValueMember = "cnae_id";
         CmbCnaePrin.SelectedValue = 259; 
```

我想在显示成员中显示：

cnae_descricao, cnae_classe

```
 displaymember = "cnae_descricao"+"cnae_classe"; but this code not work how can  i solve this::???? 
```

谢谢

# java - Android - 延迟加载图像

> ID：12977039
> 
> 赞同：2
> 
> 时间：2012-10-19T15:01:57.210
> 
> 标签：java, android, imageview, handler, delay

我试图伪造某种进度条。我有 X 图像，并希望`ImageView`以一定的延迟显示它们。

我试图做这样的事情：

```
for(i=2;i<X;i++) 
{
        Handler handler = new Handler();
        handler.postDelayed(new Runnable() {  

              @Override
              public void run() {

               drawable = getResources().getDrawable(getResources()
                                .getIdentifier("img_"+i, "drawable", getPackageName()));

               imgPayment.setImageDrawable(drawable);
               }}, DELAY);                  
} 
```

但是 for 循环不会等待`run()`to 结束。我只看到第一个和最后一个图像。我尝试了其他一些方法，但无法获得预期的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:12:42.007

怎么用`Thread.sleep()`？如果您以增量方式设置每个图像的休眠间隔，它们将按顺序显示。

```
for (i = 1; i < X; i++) 
{
    //Handler handler = new Handler();
    handler.postDelayed(new Runnable() {

        @Override
        public void run() 
        {
            Thread.sleep(i * 1000); // REMARK HERE!
            drawable = getResources().getDrawable(getResources().getIdentifier
                                  ("img_" + i, "drawable", getPackageName()));
            imgPayment.setImageDrawable(drawable);
        }
    });
} 
```

但是，为了能够使用`i`上面代码中的变量，请将其声明为全局静态变量。

```
static int i = 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T16:00:01.927

为什么不使用动画 Drawable？您似乎没有动态加载图像。

```
 <animation-list android:id="@+id/selected" android:oneshot="false">
    <item android:drawable="@drawable/wheel0" android:duration="50" />
    <item android:drawable="@drawable/wheel1" android:duration="50" />
    ...
 </animation-list> 
```

我错过了什么？

[链接到文档](http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html)

[样品链接](http://developer.android.com/guide/topics/graphics/drawable-animation.html)

正如示例文档所述：

> 需要注意的是，在 Activity 的 onCreate() 方法期间不能调用 AnimationDrawable 上调用的 start() 方法，因为 AnimationDrawable 尚未完全附加到窗口。如果您想立即播放动画而不需要交互，那么您可能希望从 Activity 中的 onWindowFocusChanged() 方法调用它，当 Android 使您的窗口成为焦点时，该方法将被调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:05:35.097

我建议使用 ASyncTask ，然后从那里更新您的可绘制对象或使用回调。

# java - 为 Java 中的方法选择合适的名称

> ID：12977040
> 
> 赞同：0
> 
> 时间：2012-10-19T15:02:00.963
> 
> 标签：java, methods, getter-setter

我对某些事情有点困惑，如果你们都能对此有所了解，我将不胜感激。我有一个类支付，它有一些方法和 getter/setter。例如，我是使用 ItemCost 方法返回属性 itemCost 的阀门还是使用 getter？

```
public class Payment {
    private int itemCost, totalCost;

    public int itemCost(int itemQuantity, int itemPrice){
        itemCost = itemPrice * itemQuantity;
        return itemCost;
    }

    public int totalCost(BigDecimal itemPrice){
        totalCost = totalCost + itemCost;
        return totalCost;
    }

    public int getBalance(int clickValue, int totalCost){

        totalCost = totalCost - clickValue;
        return totalCost;
    }

    public int getTotalcost(){
        return this.totalCost;
    }    

    public void setTotalcost(int totalCost){
        this.totalCost = totalCost;
    }

    public int getItemcost(){
        return this.itemCost;
    }    

    public void setItemcost(int itemCost){
        this.itemCost = itemCost;
    }
} 
```

好的，而不是实例化： int cost = payment.itemCost(quantity, itemPrice) 在另一个类中

做：payment.itemCost(quantity, itemPrice) payment.getItemcost

?

编辑 2：让所有方法都返回 void 并且只使用 getter 是更好的编码吗？

```
public class Payment {
    private int itemCost, totalCost;

    public void calculateItemcost(int itemQuantity, int itemPrice){
        itemCost = itemPrice * itemQuantity;
    }

    public void calculateTotalCost(BigDecimal itemPrice){
        this.totalCost = totalCost + itemCost;
    }

    public void calculateBalance(int clickValue, int totalCost){
        this.totalCost = totalCost - clickValue;
    }

    public int getTotalcost(){
        return this.totalCost;
    }    

    public void setTotalcost(int totalCost){
        this.totalCost = totalCost;
    }

    public int getItemcost(){
        return this.itemCost;
    }    

    public void setItemcost(int itemCost){
        this.itemCost = itemCost;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:03:59.107

`getter`/`setters`的目的是为对象中的特定属性设置值并从对象中获取相同的值，这样您就可以将属性定义为私有并强制封装（OO 原则之一）。

当您进行任何计算（或）业务逻辑时，最好使用适当的操作名称而不是 get/set。

**编辑：**

正如 neel 评论的那样，它总是建议将 POJO 保留为简单的 bean，而不是填充业务逻辑/计算。您可能有另一个具有业务逻辑的类，并在进行计算时使用 get/setter 从 POJO 获取值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:03:34.020

一般来说，应该是`possible`仅仅从你的方法名称就可以理解你的方法应该做什么。

因此，您应该使用`getters`且`setters`仅当您想要返回或设置您的类的属性时。这样你的代码看起来更具可读性，并且`the name`清楚`methods`地说明了它会做什么。

但是，如果您的方法不是返回确切的属性，而是返回一些计算的结果，那么您应该相应地命名您的方法。

**例如： -**如果您的方法返回`cost`作为对类的某些属性的计算，则将该方法命名为`calculateCost`. 这更有意义。

**PS** : - 请记住，您的代码会比您创建的时间更长。`Code`让别人明白，而不是让别人`yourself`明白。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:13:21.960

目前你有 2 种方法可以设置`itemCost`.

```
public void setItemcost(int itemCost){
    this.itemCost = itemCost;
}

public int itemCost(int itemQuantity, int itemPrice){
    itemCost = itemPrice * itemQuantity;
    return itemCost;
} 
```

理想情况下，您将有一种设置方法，但如果您希望类像这样工作，我建议让这两种方法都返回`void`并用于`getItemCost`获取值。

# java - 弹出屏幕不起作用

> ID：12977041
> 
> 赞同：0
> 
> 时间：2012-10-19T15:02:04.257
> 
> 标签：java, blackberry, popup

对于下面显示的代码，当我按下选项按钮（由 optionsButton 变量给出）时，没有出现弹出屏幕。我究竟做错了什么 ？

```
 optionsButton.setChangeListener(new FieldChangeListener() {
        public void fieldChanged(Field arg0, int arg1) {
            PopupScreen popup = new PopupScreen(new VerticalFieldManager());
            popup.add(new LabelField("Hello!"));
            Border border = BorderFactory.createSimpleBorder(
            new XYEdges(), Border.STYLE_TRANSPARENT);
            popup.setBorder(border);
        }
    }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T15:04:28.133

```
optionsButton.setChangeListener(new FieldChangeListener() {
            public void fieldChanged(Field arg0, int arg1) {
                PopupScreen popup = new PopupScreen(new VerticalFieldManager());
                popup.add(new LabelField("Hello!"));
                Border border = BorderFactory.createSimpleBorder(
                new XYEdges(), Border.STYLE_TRANSPARENT);
                popup.setBorder(border);

                Uiapplication.getUIapplication.pushScreen(popup);
            }
        }); 
```

# c# - 在使用 itemssource 时找出鼠标在列表视图中的哪个项目

> ID：12977046
> 
> 赞同：2
> 
> 时间：2012-10-19T15:02:13.877
> 
> 标签：c#, wpf

**问题：**

当您使用项目源填充列表视图时，项目不再是`ListViewItem`它们成为类/结构或任何您用作`.ItemsSource`我不能在我的`PreviewMouseMove`事件上使用 '.IsMouseOver' 属性的含义

**我尝试了什么？**

1.  将 a转换`ListViewItem`为 a`ListViewItem`然后调用 .IsMouseOver （当您将鼠标放在列表视图上并显示“无法将 ClassName 转换为 ”时，除了在运行时崩溃之外没有任何下划线`ListViewItem`）
2.  我尝试让我的类继承自 IInputElement `public ClassName : IInputElement`Dunno，如果这可能或没有工作，说它找不到它我对 c# 有点新，所以我不知道这将如何工作，我假设它必须是可见元素为你.IsMouseOver 它。
3.  我试着让我的班级继承自`ListViewItem`这样的`public ClassName : ListViewItem`工作！但 ListViewItem 不包含该`.IsMouseOver`属性，它仍然不允许我将我的类转换为 ListViewItem 而不会崩溃 <.<

总体目标是突出显示一个列表项并使用鼠标悬停的类中的值填充一堆文本字段，我之前在 winforms 中完成了此操作，但在 winforms 中非常容易

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:11:13.520

您仍应将控件绑定到逻辑对象。虽然 SelectedItem 属性不是 ListViewItem，但可视化树仍将包含一个。对鼠标悬停的项目使用 VisualTreeHelper 和 HitTest。获得项目后，检查绑定项目的 DataContext 属性。

这是一些代码：

```
private ListViewItem FindListViewItem(DragEventArgs e)
{
    var visualHitTest = VisualTreeHelper.HitTest(_listView, e.GetPosition(_listView)).VisualHit;

    ListViewItem listViewItem = null;

    while (visualHitTest != null)
    {
        if (visualHitTest is ListViewItem)
        {
            listViewItem = visualHitTest as ListViewItem;

            break;
        }
        else if (visualHitTest == _listView)
        {
            Console.WriteLine("Found ListView instance");
            return null;
        }

        visualHitTest = VisualTreeHelper.GetParent(visualHitTest);
    }

    return listViewItem;
} 
```

另一种选择是设置您的 ItemsContainerStyle 样式以按照您想要的方式处理 MouseOver。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:09:03.507

实际上，即使您绑定了 ListView ItemsSource，您的可视化树中仍然会有 ListViewItems。这就是 WPF 所称的项目容器（例如 ListBoxItem）。

您的 ListView 上有一个名为**ItemContainerGenerator的属性。**这将返回一个 ItemContainerGenerator 对象，该对象具有一个名为**ContainerFromItem**的方法，该方法将返回与您的对象关联的 ListViewItem。

然后，借助项目容器生成器，您可以在检索到的容器上使用 IsMouseOver。

# asp.net-mvc - 如何在控制器操作中重定向到 aspx 页面

> ID：12977047
> 
> 赞同：19
> 
> 时间：2012-10-19T15:02:16.110
> 
> 标签：asp.net-mvc

是否可以在 (asp.net-mvc3 ) 控制器操作中重定向到 aspx 页面？动作的返回类型应该是什么（ActionResult？）以及应该调用哪个重定向方法（RedirectToAction？）。

BR,

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-19T15:14:06.017

您可以从 MVC 操作重定向到任何地方，您必须使用`RedirectResult`它。`RedirectResult`是 的一种`ActionResult`。

例如。

```
public RedirectResult RedirectToAspx()
{
  return Redirect("/pages/index.aspx");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:10:43.723

是的，就像剃须刀一样。

看法：

```
test.aspx 
```

控制器：

```
 public ActionResult test()
    {
        ViewBag.Message = "test。";

        return View();
    } 
```

# performance - 什么具有更好的性能：乘法还是除法？

> ID：12977050
> 
> 赞同：5
> 
> 时间：2012-10-19T15:02:27.010
> 
> 标签：performance, cpu, low-level

哪个版本更快？ `x * 0.5 or x / 2`

前段时间，我在大学里有一门叫做计算机系统的课程。从那时起，我记得可以通过比较“简单”的逻辑门来实现两个值相乘，但除法不是“本机”操作，并且需要一个循环中的求和寄存器，该求和寄存器由除数增加并与被除数相比。

现在我必须优化一个有很多部门的算法。不幸的是，它不只是除以二，所以二进制移位是没有选择的。将所有除法更改为乘法会有所不同吗？

更新：

我已经更改了我的代码，并没有发现任何区别。您可能对编译器优化是正确的。因为所有的答案都很棒，所以我都投了赞成票。我选择了 rahul 的答案，因为链接很好。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T15:06:21.813

通常除法比乘法昂贵得多，但是智能编译器通常会将除法转换为编译时常量的乘法。如果您的编译器不够智能，或者存在浮点精度问题，那么您始终可以显式进行优化，例如更改：

```
 float x = y / 2.5f; 
```

到：

```
 const float k = 1.0f / 2.5f;

 ...

 float x = y * k; 
```

**请注意，这很可能是[过早优化](http://en.wikipedia.org/wiki/Program_optimization)的情况- 如果您已对代码进行了概要分析，并且明确地将除法确定为性能瓶颈，您应该只做这种事情。**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-08-09T18:04:23.977

对于整数和浮点数（它基本上可以转换为位移），除以 2 的幂的编译时常数非常快（与乘以编译时常数相当）。

对于浮点数，即使是动态除以 2 的幂也比常规（动态或静态除法）快得多，因为它基本上变成了指数的减法。

在所有其他情况下，除法似乎比乘法慢几倍。

对于动态除数，我的*Intel(R) Core(TM) i5 CPU M 430 @ 2.27GHz*的减速因子似乎约为 8，静态因子约为 2。

结果来自我的一个小基准，我之所以做出这个基准，是因为我对此有点好奇（注意二次方的畸变）：

[![在此处输入图像描述](../Images/d631b12ded1422132cd5c9d5757ebdfa.png)](https://i.stack.imgur.com/lw7I2.png)

[![在此处输入图像描述](../Images/3cb186d5bbed5b5d928f85856cbd3de0.png)](https://i.stack.imgur.com/Ri10e.png)

*   ulong -- 64 位无符号
*   标签中的 1 表示动态参数
*   标签中的 0 表示静态已知参数

结果是从以下 bash 模板生成的：

```
#include <stdio.h>
#include <stdlib.h>
typedef unsigned long ulong;
int main(int argc, char** argv){
    $TYPE arg = atoi(argv[1]);
    $TYPE i = 0, res = 0;
    for (i=0;i< $IT;i++)
        res+=i $OP $ARG;
    printf($FMT, res);
    return 0;
} 
```

分配 $-variables 并编译`-O3`并运行生成的程序（动态值来自命令行，因为从 C 代码中很明显）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-19T15:09:15.567

这可能取决于您的特定 CPU 和参数的类型。例如，在您的示例中，您正在执行浮点乘法但整数除法。（可能，至少，在我所知道的大多数语言中，它使用 C 语法。）

如果您在汇编程序中工作，您可以查看您正在使用的特定指令并查看它们需要多长时间。

如果您不是在汇编程序中工作，您可能不需要关心。所有具有优化功能的现代编译器都会以这种方式将您的操作更改为最合适的指令。

您在优化方面的巨大胜利不会来自像这样玩弄算术。相反，请关注您使用缓存的情况。考虑是否有可能加快速度的算法更改。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-19T15:12:11.530

好吧，如果它是一个单一的计算，你几乎不会注意到任何区别，但如果你谈论数百万笔交易，那么除法肯定比乘法更昂贵。您始终可以使用最清晰易读的任何内容。

请参考此链接：-[我应该使用乘法还是除法？](https://stackoverflow.com/questions/226465/should-i-use-multiplication-or-division)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-25T09:52:37.460

如果您正在寻找数值稳定性，请注意：

不要为需要多个分量/坐标的解决方案回收除法，例如实现 nD 向量 normalize() 函数，即以下内容***不会***为您提供单位长度向量：

```
V3d v3d(x,y,z);
float l = v3d.length();
float oneOverL = 1.f / l;
v3d.x *= oneOverL;
v3d.y *= oneOverL;
v3d.z *= oneOverL;
assert(1\. == v3d.length()); // fails! 
```

..但是这段代码会..

```
V3d v3d(x,y,z);
float l = v3d.length();
v3d.x /= l;
v3d.y /= l;
v3d.z /= l;
assert(1\. == v3d.length()); // ok! 
```

猜想第一个代码摘录中的问题是额外的浮点归一化（预除法将对浮点数施加不同的比例归一化，然后强制实际结果并引入额外的错误）。

没有研究太久，所以请分享您的解释为什么会发生这种情况。用 x,y 和 z 为 .1f 进行了测试（并且使用双精度数而不是浮点数）

# ninject - 使用 WebApi 子类化 AuthorizeAttribute 不起作用返回 401？

> ID：12977051
> 
> 赞同：0
> 
> 时间：2012-10-19T15:02:29.167
> 
> 标签：ninject, asp.net-web-api, asp.net-authorization

我将 AuthorizeAttribute 子类化，因此我可以实现令牌身份验证，从而将令牌传递到请求标头中。我还在为 IoC 使用 Ninject。覆盖的 OnAuthorization 方法被调用并验证令牌，但我仍然收到 401。

关于为什么会发生这种情况的任何想法？

TokenAuthorisationAttribute.cs

```
public class TokenAuthorisationAttribute : AuthorizeAttribute
{
    private readonly IRepository _repository;

    public TokenAuthorisationAttribute(IRepository repository)
    {
        _repository = repository;
    }

    public override void OnAuthorization(
        HttpActionContext actionContext)
    {

        if (!ValidateToken(actionContext.ControllerContext.Request))
            HandleUnauthorizedRequest(actionContext);

        base.OnAuthorization(actionContext);
    }

    private bool ValidateToken(HttpRequestMessage request)
    {
        const string authenticationToken = "Authentication-Token";

        var token = request.Headers.GetValues(authenticationToken).FirstOrDefault();

        if (token == null)
            return false;

        var device = _repository.FindSingleOrDefault<Device>(x => x.Id.Equals(token));

        if (device == null || !token.Equals(device.Id))
            return false;

        return true;

    }
} 
```

NinjectWebCommon.cs

```
 public static class NinjectWebCommon 
{
    private static readonly Bootstrapper Bootstrapper = new Bootstrapper();

    /// <summary>
    /// Starts the application
    /// </summary>
    public static void Start() 
    {
        DynamicModuleUtility.RegisterModule(typeof(OnePerRequestHttpModule));
        DynamicModuleUtility.RegisterModule(typeof(NinjectHttpModule));
        Bootstrapper.Initialize(CreateKernel);
    }

    /// <summary>
    /// Stops the application.
    /// </summary>
    public static void Stop()
    {
        Bootstrapper.ShutDown();
    }

    /// <summary>
    /// Creates the kernel that will manage your application.
    /// </summary>
    /// <returns>The created kernel.</returns>
    private static IKernel CreateKernel()
    {
        var kernel = new StandardKernel();
        kernel.Bind<Func<IKernel>>().ToMethod(ctx => () => new Bootstrapper().Kernel);
        kernel.Bind<IHttpModule>().To<HttpApplicationInitializationHttpModule>();

        RegisterServices(kernel);

        GlobalConfiguration.Configuration.DependencyResolver = new NinjectDependencyResolver(kernel);
        return kernel;
    }

    /// <summary>
    /// Load your modules or register your services here!
    /// </summary>
    /// <param name="kernel">The kernel.</param>
    private static void RegisterServices(IKernel kernel)
    {
        var connectionString = ConfigurationManager.ConnectionStrings["MONGOHQ_URL"].ConnectionString;
        var databaseName = ConfigurationManager.AppSettings["Database"];

        kernel.Bind<IRepository>().To<MongoRepository>()
            .WithConstructorArgument("connectionString", connectionString)
            .WithConstructorArgument("databaseName", databaseName);

        kernel.BindHttpFilter<TokenAuthorisationAttribute>(FilterScope.Global);

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T17:21:48.373

我设法通过覆盖 IsAuthorized 方法而不是 OnAuthorization 来解决此问题。不是 100% 确定这是否是正确的方法？有意见吗？？

```
public class TokenAuthorisationAttribute : AuthorizeAttribute
{
    private readonly IRepository _repository;

    public TokenAuthorisationAttribute(IRepository repository)
    {
        _repository = repository;
    }

    protected override bool IsAuthorized(HttpActionContext actionContext)
    {
        if (actionContext.Request.Headers.Authorization == null)
            return false;

        var authToken = actionContext.Request.Headers.Authorization.Parameter;
        var decodedToken = Encoding.UTF8.GetString(Convert.FromBase64String(authToken));

        var deviceToken = new DeviceToken(decodedToken);

        var device = _repository.FindSingleOrDefault<Device>(x => x.Id.Equals(deviceToken.GetDeviceId()));

        if (device != null)
        {
            HttpContext.Current.User = new GenericPrincipal(new ApiIdentity(device), new string[] {});
            return true;
        }

        return base.IsAuthorized(actionContext);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T06:02:31.090

ASP.NET WebAPI 是一个开源项目。所以你可以在这里阅读相应的代码：

*   AuthorizationFilterAttribute [http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/03357424caf5#src%2fSystem.Web.Http%2fFilters%2fAuthorizationFilterAttribute.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/03357424caf5#src%2fSystem.Web.Http%2fFilters%2fAuthorizationFilterAttribute.cs)
*   AuthorizeAttribute [http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/03357424caf5#src%2fSystem.Web.Http%2fAuthorizeAttribute.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/03357424caf5#src%2fSystem.Web.Http%2fAuthorizeAttribute.cs)

AuthorizationFilterAttribute 在做出决定时需要考虑两个事实：

1.  是否 OnAuthorization 抛出异常；或者
2.  是否填充了actionContext的Response字段；

任何一个都满足了，剩下的动作过滤器和动作都是快捷方式。

根据您的代码，我很好奇函数 HandleUnauthorizedRequest 是否执行上述任一操作。

覆盖 IsAuthorized 之所以起作用，是因为它在 AuthorizeAttribute 级别起作用。OnAuthorization 调用 IsAuthorized 重载并将值设置为 actionContext 的 Request 属性。

谢谢，特洛伊

# asp.net - ASP.NET 更新面板变得不可见

> ID：12977056
> 
> 赞同：0
> 
> 时间：2012-10-19T15:02:42.533
> 
> 标签：asp.net, ajax

我有一个包含一些注册详细信息的网络表单。我在同一页面的更新面板中有一个提交按钮。如果用户没有输入任何内容并单击提交按钮，它应该对表单的所有必填字段进行验证，并显示一条消息，显示缺少哪些字段。

只要输入提交按钮而不输入任何内容，它就会进行验证，但会抛出一个异常：

> Microsoft JScript 运行时错误：Sys.InvalidOperationException：找不到 ID 为“ctl00_ContentPlaceHolder_Content_UpdatePanel_Submit”的 UpdatePanel。如果它是动态更新的，那么它必须在另一个 UpdatePanel 中。

我的带有提交按钮的更新面板变得不可见。代码是：

```
<asp:UpdatePanel ID="UpdatePanel_Submit" runat="server" UpdateMode='conditional'>
        <ContentTemplate>
            <div style="font-size: 12pt; width: 938px; margin-top: 5px; border-top: ridge 2px gray;">
                <div style="margin-top: 10px; width: 938px;">

                    <asp:Button ID="btn_submit" runat="server"  ToolTip="Click here to submit your request." 
                    Text='Submit Request' onclick="btn_submit_Click" />

                    <asp:LinkButton ID="btn_cancel" runat="server" ToolTip=''>Cancel</asp:LinkButton></span>
            </div>
        </div>
    </ContentTemplate>
</asp:UpdatePanel> 
```

我该怎么做才能防止我的更新面板不可见？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:19:07.237

使用[UpdateMode Conditional](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.updatemode.aspx)，您需要添加[ChildAsTriggers=true](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.childrenastriggers.aspx)或向该按钮添加[Asyncpostback 触发器](http://ramanisandeep.net/2009/04/07/asyncpostbacktrigger-vs-postbacktrigger/)

几个例子：

[http://asp-net-example.blogspot.com/2009/11/ajax-updatepanel-how-to-use-updatemode.html](http://asp-net-example.blogspot.com/2009/11/ajax-updatepanel-how-to-use-updatemode.html)

[http://www.asp.net/web-forms/videos/aspnet-ajax/how-do-i-use-the-conditional-updatemode-of-the-updatepanel](http://www.asp.net/web-forms/videos/aspnet-ajax/how-do-i-use-the-conditional-updatemode-of-the-updatepanel)

# c# - 如何使用 PcapDotNet 自动选择设备以将数据包发送到互联网？

> ID：12977057
> 
> 赞同：1
> 
> 时间：2012-10-19T15:02:41.593
> 
> 标签：c#, ethernet, pcap, pcap.net

我正在做一些使用 PcapDotNet 从互联网发送/获取数据的实验，从[这个例子](http://pcapdotnet.codeplex.com/wikipage?title=Pcap.Net%20Tutorial%20-%20Sending%20Packets)开始。

困扰我的是，在这里你必须选择一个设备来发送你的数据包。当我在做一些更高级别的（甚至是套接字）编程时，我从来没有处理过这个问题。有没有办法自动选择要使用的网络设备，除了使用每个设备 ping 您要联系的服务器？这通常是如何完成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:07:02.213

套接字在堆栈中的更高级别工作并绑定到 ipaddress。绑定到该地址的 NIC 处理流量。

Pcap 工作在较低级别，直接访问 NIC。这会导致您选择一个设备。

您可以通过枚举设备来模拟自动选择，并选择绑定到请求的 IP 地址/网络的设备

# maven - 从 Java 类路径加载 JRuby 脚本

> ID：12977058
> 
> 赞同：2
> 
> 时间：2012-10-19T15:02:45.373
> 
> 标签：maven, jruby

我有一个简单的 Maven 项目，如下所示：

*   $PROJ/src/main/java/path-to-classes/InstallerLoader.java
*   $PROJ/src/main/resources/installer.rb

这是 InstallerLoader.java 的样子：

```
package com.mycompany;

import org.jruby.embed.ScriptingContainer;
import org.jruby.embed.PathType;

public class InstallerLoader {
    public static void main(String[] args) {
        System.out.println("Running..");
        ScriptingContainer container = new ScriptingContainer();
        container.runScriptlet(PathType.CLASSPATH, "/installer.rb");
    }
} 
```

这就是installer.rb 的样子：

```
require 'optparse'

options = { :verbose => false}
optparse = OptionParser.new do |opts|
    opts.on('-v', '--verbose', 'Verbose output') do
        options[:verbose] = true
    end
end

optparse.parse!

puts options[:verbose] 
```

当我尝试运行它时，它似乎没有加载installer.rb。没有堆栈跟踪或任何其他表明未加载installer.rb 的信息。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T17:00:07.333

类路径文件名不应以`/`. 它应该只是：

```
container.runScriptlet(PathType.CLASSPATH, "installer.rb"); 
```

这是Java 的 ClassLoader API 的一个[奇怪的未记录的方面（当然，ScriptingContainer 在幕后使用它来从类路径加载文件）。](http://weaklyreachable.blogspot.com/2010/06/leading-slash-vs-classloadergetresource.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T10:59:21.043

这是最终让它工作的代码：

```
container.setArgv(args);
InputStream is = this.getClass().getResourceAsStream("/installer.rb");
container.runScriptlet(is, "installer.rb"); 
```

# scope - Velocity：是否可以嵌套使用 #@ 和 $bodyContent 的宏？

> ID：12977064
> 
> 赞同：5
> 
> 时间：2012-10-19T15:03:02.790
> 
> 标签：scope, velocity

我有一个基本上看起来像这样的宏：

```
#macro( surround $x )
  surround:$x
    $bodyContent
  /surround:$x
#end 
```

调用`#@surround("A")bunch o' stuff#end`按预期产生“环绕：一堆东西/环绕：A”。调用`#@surround("A")#@surround("B")more stuff#end#end`产生环绕：A环绕：B更多的东西/环绕：B /环绕：A这正是我想要的。

但现在我想用另一个宏向上构建

```
#macro( annotated-surround $x $y )
  #@surround( $x )
    annotate:$y
    $bodyContent
  #end
#end 
```

的预期扩展`#annotated-surround( "C" "note" ) stuff #end`是环绕：C annotate:note stuff /surround:C

...但这不起作用；我得到了带注释的环绕体内容的可怕的半无限扩展。

我已经阅读了[Velocity 模板宏中的 Closure](https://stackoverflow.com/questions/12519289/closure-in-velocity-template-macros)的答案，但仍然不太清楚我想做的事情是否可行。

我愿意在`#surround`and 的定义中做任意棘手的事情`#annotated-surround`，但我不希望这些宏的用户看到任何复杂性。整个想法是简化他们的生活。

只要我有你的耳朵：设置`macro.provide.scope.control=true`应该是“宏中的本地命名空间”。这是什么意思？提供的命名空间是否独立于默认上下文，但在所有宏的所有调用之间共享一个这样的空间？或者是否为每个宏调用提供了单独的上下文，甚至是递归的？它必须是后者，因为`$macro.parent`，对吧？

还有一个问题。考虑以下宏：

```
#macro( recursive $x )
  #if($x == 0)
    zero
  #else
    $x before . . . 
    #set($xMinusOne = $x - 1)
    #recursive($xMinusOne)
    . . . $x after
  #end
#end 
```

`#recursive( 4 )`产量：

4 之前。. . 3 之前。. . 2 之前。. . 1 之前。. . 零 。. . 0 之后。. . 0 之后。. . 0 之后。. . 4 后

现在我明白了所有那些“0”的出现：只有一个全局 $x，所以在递归调用中分配给它会破坏它并且它不会被恢复。但是最后的“4”到底是从哪里来的呢？就此而言，我的第一个“环绕”宏是如何工作到任意深度的？为什么它的最终 $x 不会在内部调用中被破坏？

很抱歉这么冗长，但我一直无法在这件事上找到明确的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-12-12T03:01:48.237

问题在于全局变量、名称冲突和延迟渲染的组合。

让我们来看看渲染过程`#@annotated-surround( "x" "y" )content#end`：

1.  渲染进入`annotated-surround`宏。上下文映射包含：
    1.  `$x`= 字符串`x`
    2.  `$y`= 字符串`y`
    3.  `$bodyContent`= 可渲染`content`- 请注意尚未评估此字符串的输出。
2.  第一行的渲染进入`surround`宏。这会将上下文映射更新为：
    1.  新`$x`= 旧`$x`= 字符串`x`
    2.  `$y`= 字符串`y`
    3.  `$bodyContent`= Renderable `annotate:$y\n$bodyContent`- 注意这个字符串的输出还没有被评估，它仍然是模板代码。
3.  渲染输出 的第一行`surround`，生成字符串`surround:x`。
4.  渲染开始评估`surround`引用的第二行`$bodyContent`。
    1.  渲染第一行`$bodyContent`会产生 String `annotate:y`。
    2.  渲染开始评估`$bodyContent`引用的第二行`$bodyContent`。
        1.  渲染第一行`$bodyContent`会产生 String `annotate:y`。
        2.  渲染开始评估`$bodyContent`引用的第二行`$bodyContent`。
            1.  等等

解决方案是删除问题组合的一部分。全局变量和延迟渲染是 Velocity 工作原理的基本部分，因此您无法触及它们。这留下了名称冲突。您需要的是`$bodyContent`用不同的名称引用每个宏。这很容易通过在调用任何其他宏之前将其分配给每个宏中具有唯一名称的新变量来实现，并在任何调用的宏的主体中使用新变量，如下所示：

```
#macro( surround $x )
  surround:$x
    $bodyContent
  /surround:$x
#end

#macro( annotated-surround $x $y )
  #set( $annotated-surround-content = $bodyContent )
  #@surround( $x )
    annotate:$y
    $annotated-surround-content
  #end
#end 
```

这个版本的渲染是这样的：

1.  渲染进入`annotated-surround`宏。上下文映射包含：
    1.  `$x`= 字符串`x`
    2.  `$y`= 字符串`y`
    3.  `$bodyContent`= 可渲染`content`- 请注意尚未评估此字符串的输出。
2.  第一行的渲染执行`#set`指令，将一个变量添加到上下文映射：`$annotated-surround-content`= current `$bodyContent`= Renderable `content`。
3.  第二行的渲染进入`surround`宏。这会将上下文映射更新为：
    1.  新`$x`= 旧`$x`= 字符串`x`
    2.  `$y`= 字符串`y`
    3.  `$annotated-surround-content`= 旧`$bodyContent`= 可渲染`content`
    4.  `$bodyContent`= 可渲染`annotate:$y\n$annotated-surround-content`
4.  渲染输出 的第一行`surround`，生成字符串`surround:x`。
5.  渲染开始评估`surround`引用的第二行`$bodyContent`。
    1.  渲染第一行`$bodyContent`会产生 String `annotate:y`。
    2.  渲染开始评估`$bodyContent`引用的第二行`$annotated-surround-content`。
        1.  渲染`$annotated-surround-content`产生 String `content`。
6.  渲染输出第三行`surround`，生成字符串`/surround:x`。

最终渲染的输出是`surround:x annotate:y content /surround:x`. 通过将此类替换应用于另一个宏调用的内容内的所有出现，可以推广这种方法`$bodyContent`，每次使用从宏名称派生的变量名称以确保唯一性。但是，如果没有额外的东西来区分每个嵌套调用，它就不适用于递归宏。

关于范围设置，所做的只是将一个`$macro`对象添加到上下文中，该对象对于每个宏调用都是唯一的，并且可以用作映射。如果您`$macro.myVar`在两个嵌套宏调用中的每一个中设置不同的值，则外部宏的值将在内部宏完成时保持不变。但是，这对解决问题没有帮助`$bodyContent`，因为对`$macro`宏内部的任何引用`$bodyContent`都将在呈现时解析为最内层的宏。

关于最后 4 个 from `#recursive( 4 )`，它来自具有本地范围并按名称传递的宏参数的组合。除了最外层的调用之外`#recursive`，参数`$x`是对全局上下文变量的引用`$xMinusOne`——当它们渲染`after`行时，使用实际上被解析为在全局上下文中`$x`查找当前值。`$xMinusOne`对于最外面的调用，它是常量 value `4`，并且内部调用的参数在完成时超出范围，因此当最外面的调用到达最后一行时，它又回到了 being `4`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T22:10:30.470

从最简单的开始，macro.provide.scope.control=true 肯定会为*每个*宏调用创建一个单独的 $macro 范围对象。否则，正如您所注意到的， $macro.parent 将是无稽之谈。“范围控制”的全部意义在于为所讨论的 VTL 块的类型提供明确的命名空间。您甚至可以使用 round.provide.scope.control=true 在#@surround bodyContent 中自动创建 $surround 范围。

关于你的第一个问题，我对发生的事情有点困惑。对#@annotate-surround 的调用和对#@surround 的嵌套调用都将使$bodyContent 引用可用。我是对的，发生的事情是使用了“错误的” $bodyContent 吗？$bodyContent 引用应该属于最近的块宏调用。要在内部宏中引用外部宏的 $bodyContent，您可能需要 #set( $macro.bodyContent = $bodyContent )，然后在内部宏中通过 $macro.parent.bodyContent 使用它

至于#recursive 的怪异，我不知道，现在必须开始其他工作。我没有在我现在的机器上检查 Velocity 也无济于事，所以我不能快速尝试。

# android - Android WebDriver 不使用 Android 测试框架加载 https 页面

> ID：12977068
> 
> 赞同：1
> 
> 时间：2012-10-19T15:03:09.840
> 
> 标签：android, selenium, https, selenium-webdriver, android-testing

如何使用 AVD 上的 Android 测试框架在 Android WebDriver 上加载 https 页面？根据 AndroidDriver 常见问题解答 (http://code.google.com/p/selenium/wiki/AndroidDriver#Android_fails_to_load_HTTPS_pages)，您需要在制作新的 AndroidDriver 时启用功能：

```
DesiredCapabilities caps = DesiredCapabilities.android();
caps.setCapability(CapabilityType.ACCEPT_SSL_CERTS, true);

AndroidDriver driver = new AndroidDriver(caps); 
```

但是，当使用 Android 测试框架时，使用的驱动程序是 AndroidWebDriver 而不是 AndroidDriver。在 AndroidDriver 构造函数中，您可以使用功能作为参数来允许 https 页面，但在 AndroidWebDriver 构造函数中，唯一的参数是需要使用的 Activity。那么，您将如何设置功能以允许 AndroidWebDriver 加载 https 页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:32:47.463

尝试从您的网站导出证书并将此证书导入您的 android 设备（google: hoe to import certificate android）。完成此步骤后，我可以在测试中访问 HTTPS。

# php - 带有位域的 PDO 准备好的语句

> ID：12977071
> 
> 赞同：4
> 
> 时间：2012-10-19T15:03:21.860
> 
> 标签：php, mysql, pdo

`bit`使用 PDO 准备好的语句和数据类型时遇到问题

当使用 PDO 准备语句从数据库中检索结果时，会返回一个空结果集，但如果查询是通过普通 sql 查询完成的，则会返回正确的结果

如果`is_demo`where 子句中的字段被省略，它应该可以正常工作！？

# 数据库表结构

```
CREATE TABLE IF NOT EXISTS `user` (
  `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
  `client_id` smallint(5) unsigned NOT NULL,
  `is_admin` bit(1) NOT NULL,
  `is_demo` bit(1) NOT NULL,
  `name` varchar(30) NOT NULL,
  `pass` varbinary(20) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `client_id` (`client_id`),
  KEY `is_admin` (`is_admin`),
  KEY `is_demo` (`is_demo`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=20 ; 
```

# PDO 准备好的声明

```
$sql = "SELECT id,client_id,is_admin,is_demo\n"
    ."FROM user\n"
    ."WHERE is_demo=? && client_id=? && name=? && pass=?\n"
    ."ORDER BY name";
$fields = [
    0,
    500,
    'test',
    123
];
$sth = $dbh->prepare($sql);
$sth->execute($fields); 
```

# 返回

```
PDOStatement Object
(
    [queryString] => SELECT id,client_id,is_admin,is_demo
FROM user
WHERE is_demo=? && client_id=? && name=? && pass=?
ORDER BY name
) 
```

没有返回行

# 普通查询

```
SELECT id, client_id, is_admin, is_demo
FROM user
WHERE is_demo=0 && client_id=500 && name='test' && pass=123
ORDER BY name 
```

# 返回

返回正确的行数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:04:28.857

这是`\n`无法查询的问题

```
$sql = "SELECT id,client_id,is_admin,is_demo\n"
."FROM user\n"
."WHERE is_demo=? && client_id=? && name=? && pass=?\n"
."ORDER BY name"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T19:08:04.867

MySQL 可以将字符串值“0”转换为在字符串前加上“B”这样的代码：

```
$sql = "SELECT id,client_id,is_admin,is_demo\n"
    ."FROM user\n"
    ."WHERE is_demo=B? && client_id=? && name=? && pass=?\n"
    ."ORDER BY name";
$fields = [
    '0', 
    500,
    'test',
    123
];
$sth = $dbh->prepare($sql);
$sth->execute($fields); 
```

# r - 如何在R中找到两个日期之间的时间差？

> ID：12977073
> 
> 赞同：3
> 
> 时间：2012-10-19T15:03:20.937
> 
> 标签：r, datetime

冒着因提出“明显”问题而被修改的极端风险，我如何在 R 中找到两个日期之间的差异（以小时为单位）？

```
> ISOdate(2004,1,6) - ISOdate(2004,1,1)
Time difference of 5 days
> as.POSIXlt(ISOdate(2004,1,6) - ISOdate(2004,1,1))
Error in as.POSIXlt.default(ISOdate(2004, 1, 6) - ISOdate(2004, 1, 1)) : 
  do not know how to convert 'ISOdate(2004, 1, 6) - ISOdate(2004, 1, 1)' to class "POSIXlt"
 > (ISOdate(2004,1,6) - ISOdate(2004,1,1))$year
Error in (ISOdate(2004, 1, 6) - ISOdate(2004, 1, 1))$year : 
  $ operator is invalid for atomic vectors
> (ISOdate(2004,1,6) - ISOdate(2004,1,1))$mon
Error in (ISOdate(2004, 1, 6) - ISOdate(2004, 1, 1))$mon : 
  $ operator is invalid for atomic vectors 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-19T15:10:07.127

使用函数`difftime`，带参数`units="hours"`：

```
x <- c(ISOdate(2004,1,6), ISOdate(2004,1,1))
difftime(x[1], x[2], units="hours")
Time difference of 120 hours 
```

* * *

我怎么知道去哪里看？

好吧，首先看看你减去两次得到的对象的结构：

```
str(x[1] - x[2])
Class 'difftime'  atomic [1:1] 5
  ..- attr(*, "units")= chr "days" 
```

所以现在你知道你正在处理一个`difftime`. 从这里很容易找到帮助：请参阅`?difftime`

# extjs - 将项目添加到窗口 Extjs 4

> ID：12977076
> 
> 赞同：2
> 
> 时间：2012-10-19T15:03:33.863
> 
> 标签：extjs, extjs4

今天早上我一直在想办法解决这个问题，我有一个 Extjs 窗口，我想在其中放置一个图表作为一个项目。我正在使用 Extjs 4，这是我的窗口：

```
Ext.define('Metrics.view.ChartWin', {   
extend: ['Ext.window.Window'],  
alias: 'widget.chartwin',   
requires :['Ext.chart.*','Ext.Window', 'Ext.fx.target.Sprite', 'Ext.layout.container.Fit', 'Ext.window.MessageBox', 'Metrics.view.DrawChart'],
    width: 800,
    height: 600,
    minHeight: 400,
    minWidth: 550,
    hidden: false,
    shadow: false,
    maximizable: true,
    title: 'Area Chart',
    renderTo: Ext.getBody(),
    layout: 'fit',
    tbar: [{
        text: 'Save Chart',
        handler: function() {
            Ext.MessageBox.confirm('Confirm Download', 'Would you like to download the chart as an image?', function(choice){
                if(choice == 'yes'){
                    chart.save({
                        type: 'image/png'
                    });
                }
            });
        }
    }],
    items:[{
                    //I guess the problem comes from here??
        xtype : 'drawchart'
    }]
    }); 
```

我的图表：

```
Ext.define('Metrics.view.DrawChart', {   
extend: 'Ext.chart.Chart',  
alias: 'widget.drawchart',   
requires: ['Ext.chart.*'],
renderTo: Ext.getBody(),
width: 700,
height: 600,
animate: true,
store:  'GraphData',
shadow : true,
legend: {
            position: 'right'
        },
axes: [
    {
        title: 'Week',
        type: 'Numeric',
        position: 'left',
        fields: ['Week'],
    grid : true

    },
    {
        title: 'In Out Backlog',
        type: 'Numeric',
        position: 'bottom',
        fields: ['BL1 Alt']

    }
],

theme: 'Red',

series: [
 {
 //BLA BLA BLA    
 }]
 }); 
```

我的图表工作正常。现在请告诉我，如何将此图表添加到我的窗口中？我收到此错误消息：

```
 Cannot read property 'isInstance' of undefined 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T00:42:53.047

消除

```
renderTo: Ext.getBody() 
```

从您的图表定义中。图表应在窗口中呈现。然后实例化一个窗口并将图表设置为那里的项目：

```
Ext.create('Ext.window.Window', {
...
items: [{
    xtype: 'drawchart'
}]
... 
```

看这里的代码：http: [//jsfiddle.net/AMx6r/1282/](http://jsfiddle.net/AMx6r/1282/)

# android - 为什么使用 Ivy 解决依赖关系在 Android 的“-pre-build”Ant 目标中不起作用？

> ID：12977077
> 
> 赞同：1
> 
> 时间：2012-10-19T15:03:34.097
> 
> 标签：android, ant, ivy

由于 Android Java 项目使用 Ant 作为构建工具，因此使用 Ivy 进行依赖管理对我来说似乎是一个自然的选择。然而，虽然基本设置工作正常，但我遇到了一个奇怪的问题。我[在 GitHub 上创建了一个现有示例的分支，](https://github.com/sschuberth/IvyAndroidExample)以轻松重现该问题。

关键是，依赖项可以很好地下载到“libs”目录中，但是调用的构建过程`ant debug`似乎没有找到 JAR。**但是**，如果我将“resolve”目标称为不是我重载的“-pre-build”目标的一部分，而是像在`ant resolve debug`.

我已经验证了这些库在“-pre-build”完成之前确实在“libs”中（通过将“libs”中的文件列为“-pre-build”目标的一部分），所以我真的想知道为什么他们找不到。

要重现，重要的是在运行 ant 之前从“libs”中删除库。任何想法这里出了什么问题？

```
resolve:
[ivy:retrieve] :: Apache Ivy 2.3.0-rc1 - 20120416000235 :: http://ant.apache.org/ivy/ ::
[ivy:retrieve] :: loading settings :: file = /Users/seschube/development/IvyAndroidExample/ivysettings.xml
[ivy:retrieve] :: resolving dependencies :: com.example#ivy-android-example;0.1
[ivy:retrieve]  confs: [default]
[ivy:retrieve]  found org.acra#acra;4.2.3 in acra
[ivy:retrieve]  found com.google.inject#guice;2.0-no_aop in maven2
[ivy:retrieve]  found com.google.zxing.core#core;1.6 in zxing
[ivy:retrieve] :: resolution report :: resolve 115ms :: artifacts dl 5ms
    ---------------------------------------------------------------------
    |                  |            modules            ||   artifacts   |
    |       conf       | number| search|dwnlded|evicted|| number|dwnlded|
    ---------------------------------------------------------------------
    |      default     |   3   |   0   |   0   |   0   ||   4   |   0   |
    ---------------------------------------------------------------------
[ivy:retrieve] :: retrieving :: com.example#ivy-android-example
[ivy:retrieve]  confs: [default]
[ivy:retrieve]  4 artifacts copied, 0 already retrieved (1195kB/76ms)

-pre-build:
     [echo] The "libs" directory contains: acra-4.2.3.jar;core-1.6.jar;guice-2.0-no_aop-javadoc.jar;guice-2.0-no_aop.jar

-code-gen:
[mergemanifest] Merging AndroidManifest files into one.
[mergemanifest] Manifest merger disabled. Using project manifest only.
     [echo] Handling aidl files...
     [aidl] No AIDL files to compile.
     [echo] ----------
     [echo] Handling RenderScript files...
[renderscript] No RenderScript files to compile.
     [echo] ----------
     [echo] Handling Resources...
     [aapt] Generating resource IDs...
     [echo] ----------
     [echo] Handling BuildConfig class...
[buildconfig] Generating BuildConfig class.

-pre-compile:

-compile:
    [javac] Compiling 3 source files to /Users/seschube/development/IvyAndroidExample/bin/classes
    [javac] /Users/seschube/development/IvyAndroidExample/src/com/example/IvyAndroidExampleActivity.java:7: error: package org.acra does not exist
    [javac] import org.acra.*;
    [javac] ^
    [javac] /Users/seschube/development/IvyAndroidExample/src/com/example/IvyAndroidExampleActivity.java:8: error: package com.google.inject does not exist
    [javac] import com.google.inject.*;
    [javac] ^
    [javac] /Users/seschube/development/IvyAndroidExample/src/com/example/IvyAndroidExampleActivity.java:9: error: package com.google.zxing does not exist
    [javac] import com.google.zxing.*;
    [javac] ^
    [javac] 3 errors

BUILD FAILED 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T11:53:53.037

我发现了发生了什么：Android SDK 的 build.xml 将`libs`目录中的所有 JAR`project.all.jars.path`作为目标的一部分添加到属性中`-build-setup`。`retrieve`但是，如果 Ivy 的目标被调用为 的一部分，这还为时过早`-pre-build`，因为`-build-setup`在之前被调用`-pre-build`。所以`-pre-build`，虽然意味着要被覆盖，但是是错误的地方。由于在调用之前似乎没有其他“虚拟”目标要被覆盖`-build-setup`，所以我现在`-build-setup`在我的 build.xml 文件中覆盖了一个依赖于`retrieve`原始版本的版本，`-build-setup`如下所示：

`<target name="-build-setup" depends="retrieve,android_rules.-build-setup" />`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T16:29:38.263

不看 build.xml 本身就很难说。

但是，当您用于`<ivy:resolve>`解决问题时，它不会自动将库放入您的项目中。最有可能的是，他们在`$HOME/.ivy2/cache`. 您需要做的是在使用`<javac>`任务之前运行`<ivy:cachepath>`以创建可在编译中使用的路径引用：

您可以看到我已经创建了`main.classpath`用我的`<ivy:cachepath>`任务调用的所需类路径。然后我可以使用它来将它包含在我的`<javac>`任务中。

如果您想将库实际下载到您的项目中，您需要执行此操作`<ivy:retrieve/>`，然后将该目录放入您的类路径中：

这对你有帮助吗？

顺便说一句，您可能想看看我在[Github](http://github.com/qazwart/ivy.dir)上的 Ivy 设置项目。如果您有很多人共享您的项目，那么包含 Ivy 会很容易。即使您只是创建一个`ivy.dir` 子目录而不是使其成为包含的子项目。这样，没有人必须安装 Ivy，因为它已经安装在您的项目中。

# ajax - 删除一个时重新编号有序的会话变量

> ID：12977078
> 
> 赞同：1
> 
> 时间：2012-10-19T15:03:35.860
> 
> 标签：ajax, asp-classic, jscript

我正在为当地的皮塔餐厅更新一个用 jScript 编写的经典 ASP 应用程序。我为他们的桌面网站创建了一个新的特定于移动设备的版本，它允许订购交付和大量定制最终的皮塔饼（想象一下 Subway 的网站，它允许您添加泡菜、生菜等）。每个皮塔饼都作为一串数字存储在会话变量中。皮塔饼的总数也被存储。会话可能如下所示：

```
PitaCount = 3  
MyPita1 = "35,23,16,231,12"  
MyPita2 = "24,23,111,52,12,23,93"  
MyPita3 = "115,24" 
```

我知道可能有更好的方法来存储数据，但是现在，由于整个事情都是编写的、工作的和生活的（并且客户很高兴），我只想解决我遇到的问题。这就是问题所在...

我在订单回顾页面上有按钮，允许客户从购物车中删除皮塔饼。当我这样做时，我想重新编号会话变量。如果客户删除了 MyPita1，我需要将 MyPita2 重新编号为 MyPita1，将 MyPita3 重新编号为 MyPita2，然后将 PitaCount 递减。

AJAX 按钮向 ASP 文件发送一个整数，其中包含要删除的皮塔饼编号 (DeleteID)。我的函数查看 PitaCount 和 DeleteID。如果它们都是 1，它只是放弃会话。如果它们都相同但大于一个，我们将删除最近添加的皮塔饼，因此不需要重新编号。但是，如果 PitaCount 大于 DeleteID，我们需要重新编号这些皮塔。这是我用来执行此操作的代码：

```
for (y=DeleteID;y<PitaCount;y++) {
    Session("MyPita" + y) = String(Session.Contents("MyPita" + (y+1)));
};
Session.Contents.Remove("MyPita" + PitaCount);
PitaCount--;
Session.Contents("PitaCount") = PitaCount; 
```

这适用于每个皮塔饼，除了替换已删除的皮塔饼，它返回“未定义”。例如，如果我的购物车中有 6 个皮塔饼，我删除了 MyPita2，我最终在购物车中有 5 个皮塔饼。数字 1、3、4 和 5 正是您所期望的，但 MyPita2 返回未定义。

我还尝试了一个 WHILE 循环：

```
while (DeleteID < PitaCount) {
    Session("MyPita" + DeleteID) = String(Session.Contents("MyPita" + (DeleteID+1)));
    DeleteID++;
};
Session.Contents.Remove("MyPita" + PitaCount);
PitaCount--;
Session.Contents("PitaCount") = PitaCount; 
```

这也返回“未定义”，就像上面的一样。

在我能够完成这项工作之前，我只是将最新的皮塔饼写入已删除的皮塔饼腾出的位置，但这会重新排序购物车，我认为这是一个可用性问题，因为人们希望他们添加到购物车中的物品保留在相同的顺序。（是的，我可以在会话中添加某种时间戳并使用它进行排序，但我认为解决我遇到的问题会更快）。

**我很困惑。为什么（使用上面的 6 pita 示例）它会在循环的第二次、第三次和第四次迭代中完美运行，但在第一次迭代中却不行？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-21T07:00:13.347

我不能确定，但​​我认为你的问题可能是值`DeleteID`是一个字符串。这可能会发生，您可以通过执行以下操作来分配其值：

```
var DeleteID = Session("DeleteID"); 
```

假设这是真的，那么在循环的第一次迭代中（写入删除的点），`y`是一个字符串，并且表达式`y+1`被解释为字符串连接而不是数字加法。例如，如果您删除 ID 1，您实际上是将 id 11 ( `"1" + 1`) 中的值复制到已删除的位置，而这在您的测试中可能不存在。这可以通过将至少 11 件商品添加到您的购物车然后删除第一个来进行测试。在下一次迭代中，增量运算符`++`强制`y`为数字，因此脚本从那时起按预期工作。

`DeleteID`解决方案是在初始化循环时转换为数字：

```
for (y = +DeleteID; y < PitaCount; y++) { 
```

将字符串转换为数字可能有更好的方法，但这`+`是我记得的。

# javascript - 如何在 knockout.js 中检测除更改事件之外的更改

> ID：12977079
> 
> 赞同：0
> 
> 时间：2012-10-19T15:03:36.790
> 
> 标签：javascript, jquery, knockout.js

我正在使用 knockout.js。我创建了一个`testViewModel`只有 1 个可观察属性的视图模型`testProperty`。

```
function testViewModel()
{
  var self = this;

  self.testProperty = ko.observable("Initial");

} 
```

比我创建了一个反映`span`改变的值的`testProperty`方法和一个`input text field`我们可以改变`testProperty`值的方法。

```
 <span data-bind="text: testProperty"></span><br />
 <input type="text" data-bind="value: testProperty" /> 
```

我创建了一个[示例小提琴](http://jsbin.com/aguyud/1/edit)。似乎在输入文本字段上执行 focusout 事件时，可观察属性值已更新。

现在**我的问题**是，我们能否将 observable 属性值更新事件从 focusout 更改为其他内容。我还创建了一个保存按钮。有什么方法可以仅在按下保存按钮时更新可观察的属性值。

我正在尝试创建一个应用程序，用户可以在其中创建和保存其配置文件并可以编辑保存的配置文件。我在创建和编辑表单中使用相同的可观察属性，这些属性是可观察的。因此，当用户编辑其个人资料时，用户界面不应更新，直到用户按下保存按钮。这是我的目标。请帮我解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:16:54.660

我建议有 testProperty 和 testProperty_temp。将输入绑定到 temp 并单击按钮时，将 testProperty 设置为 testProperty_temp

```
function testViewModel()
{
   var self = this;

   self.testProperty = ko.observable("Initial");
   self.testProperty_temp = ko.obserable("");
   self.save = function() { self.testProperty(self.testProperty_temp()); }
 } 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:49:11.927

另一种方法，与马特·伯兰德（Matt Burland）建议的思路相同：

[http://jsfiddle.net/mori57/PQxJC/](http://jsfiddle.net/mori57/PQxJC/)

基本上，将您的输入和按钮包装在一个表单中，并将表单绑定到提交：这由您的 ViewModel 上的方法处理。请参阅我内联的评论，但这里是为那些不想去 jsFiddle 的人准备的：

```
<span data-bind="text: testProperty"></span><br />
<!-- wrap the input and button in a form and
   data-bind to submit, with a reference
   to a handler on your viewmodel -->
<form data-bind="submit: updateProfile">
<!-- this must be bound to your shadow value -->
<input type="text" data-bind="value: _tmpTestProperty" />
<button type="submit">save</button>
</form>​ 
```

在你的 javascript 中

```
function testViewModel()
{
  var self = this;

  self.testProperty = ko.observable("Initial");
  // Create the "shadow" property
  // and prepopulate it with testProperty's value
  self._tmpTestProperty = ko.observable(self.testProperty());

  // Create our form handler
  self.updateProfile = function(val){
    // set the testProperty value to the 
    // value of the shadow property
    self.testProperty(self._tmpTestProperty());
  };

}

ko.applyBindings(new testViewModel());​ 
```

这样，当您失去对文本输入框的关注时，您的值不会改变，而只会在您提交表单时更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:13:23.140

您最简单的方法是为每个属性设置一个*影子*属性。因此，您将一个绑定到您的文本框，并且仅在单击保存时将值复制到另一个属性，即绑定到其他 UI 元素的那个。

见这里：http: [//jsbin.com/aguyud/5/edit](http://jsbin.com/aguyud/5/edit)

使用两个模型和 $.extend 从一个复制到另一个的更简单方法：

[http://jsbin.com/aguyud/7/edit](http://jsbin.com/aguyud/7/edit)

更新，实际上从头开始，这似乎不起作用。我尝试了这个：

[http://jsbin.com/aguyud/22/edit](http://jsbin.com/aguyud/22/edit)

第一次工作，但是在使用 $.extend 复制模型之后，它似乎也复制了所有绑定，所以它只工作一次！

# jquery - IE9 中的 jQuery UI 可拖动句柄非常小

> ID：12977088
> 
> 赞同：3
> 
> 时间：2012-10-19T15:04:13.743
> 
> 标签：jquery, jquery-ui, html5-canvas, internet-explorer-9, jquery-ui-draggable

我一直在尝试在画布中制作一个漂亮的可编辑多边形，使用 jQuery UI 来抓取顶点并移动它们。这在 Chrome、Firefox 和 Safari 上运行良好，只是在 IE9 上不太适用。

[http://jsfiddle.net/EveryoneMustWin/qNdCw/](http://jsfiddle.net/EveryoneMustWin/qNdCw/)

**CSS**

```
.vertex {width:50px; height:50px; border:0px dotted red; position:absolute; display:none; z-index:0;}

#vertexcontainer .vertex {display:block;}

.vertex div.handle {width:40px; height:40px; position:relative; left:-20px; top:-20px; border:1px solid red; border-radius:20px;z-index:1; opacity:0.5;}

.currenthandle {width:40px; height:40px; border:1px solid red; position:absolute; background-color:#fc0;} 
```

**代码**

```
$( ".vertex" ).draggable({
    stack: "div",
    snap: true,
    handle: "div.handle",
    start: function() {
        $(".currenthandle").removeClass("currenthandle");
        $(this).children("div.handle").addClass("currenthandle");
    },
    drag: function() {
        drawPoly();
    },
    stop: function() {
        drawPoly();
    }
}); 
```

顶点手柄的可拖动区域似乎很小，如果幸运的话，您可以通过单击手柄的边框来选择它。一旦您选择了顶点，就可以很好地拖动它们，因此核心可拖动行为不是问题。

我的猜测是 jQuery UI 将“.vertex div.handle”的 element.style 设置为不合适的设置。还是 CSS3 的 IE9 问题？在没有元素检查器的情况下，我不太擅长在 IE 中调查这类问题。感谢您的任何提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:34:30.163

问题 AFAICT 是 IE 忽略了对没有可点击“内容”的元素部分的鼠标点击。在这种情况下，您可以添加一个已定义`background-color`且神奇的 IE 就可以了：

```
.vertex div.handle {
    width:40px; 
    height:40px; 
    position:relative; 
    left:-20px; 
    top:-20px; 
    border:5px solid red; 
    border-radius:20px;
    z-index:1; 
    opacity:0.5; 
    background-color: #ddd;
} 
```

[http://jsfiddle.net/qNdCw/6/](http://jsfiddle.net/qNdCw/6/)

如果您不喜欢背景的不透明度，我认为您可以使用设置为背景的透明图像来“欺骗”它。

# php - PHP 5.2.17；html_entity_decode - 字符解码问题

> ID：12977092
> 
> 赞同：1
> 
> 时间：2012-10-19T15:04:27.547
> 
> 标签：php, html, version, special-characters, html-entities

所以我面临一个可怕的问题，我需要耐心解决。

我做了两个函数，一个对从所见即所得编辑器收集的数据进行编码，以将其发送到 mysql 数据库（我正在使用的表字符集是 UTF-8），另一个以相反的方式（数据库到所见即所得），你可以见下文。

```
function displayTextWithTags($textToBeDisplayed) {
    return html_entity_decode(html_entity_decode($textToBeDisplayed));
}

function sendTextToDatabase($text){
    return trim(htmlentities(htmlentities($text, ENT_QUOTES)));
} 
```

它在运行 php 5.4.4 的开发服务器中运行良好，但是当我将应用程序上传到客户端服务器（运行 php 5.2.7）时，解码无法正常工作......

例如，如果我发送一个`&\Eacute;&\eacute;`（我放置了一个 \ 以便您可以阅读代码）到数据库，`Éé`当我在我的开发服务器中检索它时，我会得到一个，当我`�?é`从客户端的服务器检索它时会得到一个。

我已经潜伏了好几个小时来为我的问题找到答案，但我没有成功，所以我请求你帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:09:39.980

我建议使用 base64_encode 和 base64_decode。这应该可以解决任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:09:50.837

我以前遇到过这个问题，但我使用 ADODB 数据库包装器。为此，我不得不使用它：

```
 $db->EXECUTE("set names 'utf8'"); 
```

不确定您是否正在使用数据库包装类，但基本上您需要将架构名称设置为 utf8。[这](https://stackoverflow.com/questions/2159434/set-names-utf8-in-mysql)是一个例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:14:53.780

我认为我们需要在这里澄清一下。您所说的“检索”是什么意思？我假设您的意思是“在浏览器中显示”，那么您是否首先通过查看您的 http 标头检查了客户端网络服务器提供的字符编码？它可以输出为 ISO-8859-1。

在旁注中，您为什么要运行两次实体解码和编码？

# ruby-on-rails - Rspec测试传递错误的var？

> ID：12977094
> 
> 赞同：0
> 
> 时间：2012-10-19T15:04:34.560
> 
> 标签：ruby-on-rails, rspec, tdd

我为控制器编写了一个测试，最近不得不稍微重构一下新方法。我的旧测试失败了，我不知道为什么它没有通过。我是测试新手，所以我的理解有限。

我下面的方法基本上接收一个`slug_text`参数。从 中`slug_text`，我们可以获得地点的 id 及其类型（多态）。使用这些值，我们可以在数据库中找到记录。

```
def new
  @slug = params[:slug_text]
  place_id = Slug.where(name: @slug).first.sluggable_id.to_i
  place_type = Slug.where(name: @slug).first.sluggable_type.to_s
  @klass = place_type.classify.constantize
  @place = @klass.find(place_id)
end 
```

该操作在视图中似乎是有效的，但是，我的测试一直失败说它`expects 1, but receives 0`。

```
it "sends the query to the correct class" do
  Hotel.should_receive(:find).with(1)
  get :new, place_type: "Hotel", id: 1
end 
```

这个测试应该检查我方法的最后两行，并确保我提取了正确的记录。

我是否错误地`place_type`作为符号传入，此外，我必须传入`:slug_text`还是可以开始测试任何行？

# .net - 有没有办法让子分组知道.NET 中 CollectionViewSource 的父分组中有多少项目

> ID：12977095
> 
> 赞同：1
> 
> 时间：2012-10-19T15:04:34.973
> 
> 标签：.net, grouping, collectionviewsource

我有一个集合视图源，其中设置了两个组描述

```
myCollectionViewSource.GroupDescriptions.Add(New PropertyGroupDescription("PrimaryProperty"))
myCollectionViewSource.GroupDescriptions.Add(New PropertyGroupDescription("SecondaryProperty")) 
```

如下图所示，主要分组已找到 338 条记录。这些根据辅助 GroupDescription 分为 179 对记录。如果我正在评估一个子分组元素，有没有办法让我获得`ItemCount`它最初来自的主要分组？

![组视图](../Images/279b7a9a5ede019a2c13a744652b6a03.png)

谢谢，麻烦您了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T07:05:51.797

根据您的本地值，您可以简单地使用以下表达式

```
((MS.Internal.Data.CollectionViewGroupInternal)myCollectionViewSource.View.Groups[0]).ItemCount 
```

# facebook-opengraph - 应用访问令牌和用户访问令牌之间的区别

> ID：12977097
> 
> 赞同：4
> 
> 时间：2012-10-19T15:04:43.520
> 
> 标签：facebook-opengraph, access-token

应用访问令牌和用户访问令牌有什么区别？

我注意到来自 FB 的 userData 不同，但我可以进行 OpenGraph 操作并在用户墙上发布或发送到朋友墙上。

我可以在 OpenGraph 操作中使用应用访问令牌吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T15:31:10.960

应用程序`access_token`允许您代表应用程序而不是用户向 Facebook API 发出请求。这很有用，例如：

*   修改你的App的参数
*   创建和管理测试用户
*   阅读您的应用程序的见解
*   *代表*已授予您的应用程序发布权限的用户向 Facebook 发布内容

现在在 Open Graph 区域：

> 如果您的应用代表其用户发布并需要没有过期时间的访问令牌，则应使用应用访问令牌。应用访问令牌是使用您的应用秘密签署的，并且不会过期；如果您重新键入/重置您的应用程序密码，它将失效。
> 
> 仅当发布功能直接来自您的服务器时才应使用应用访问令牌，以使它们对应用保持私有。
> ...
> 应用访问令牌在发布“安全开放图谱操作”实例时特别有用，开放图谱操作只能由您的应用发布，例如成就和游戏分数。在此特定示例中，通过使用用户访问令牌发布虚假分数/成就来防止用户玩弄他/她的分数。

请阅读以下文件：

*   [作为应用程序登录](https://developers.facebook.com/docs/howtos/login/login-as-app/)
*   [使用应用程序访问令牌（开放图）](https://developers.facebook.com/docs/opengraph/using-app-tokens/)

# java - Android：启动相机应用程序现在会导致应用程序崩溃

> ID：12977101
> 
> 赞同：2
> 
> 时间：2012-10-19T15:04:55.900
> 
> 标签：java, android, camera

它工作正常，我不太确定我做了什么改变以使其停止工作。当我加载相机时它工作正常，它返回到失败的页面。我已经尝试删除照片返回腿上发生的事情，看看是否会导致它翻倒，但它真的不起作用。

这是我的错误：

```
10-19 16:01:43.455: W/IInputConnectionWrapper(5309): getSelectedText on inactive InputConnection
10-19 16:01:43.455: E/Asset Sub Group(5309): 1
10-19 16:01:43.480: W/IInputConnectionWrapper(5309): setComposingText on inactive InputConnection
10-19 16:01:43.480: W/IInputConnectionWrapper(5309): finishComposingText on inactive InputConnection
10-19 16:01:47.045: W/IInputConnectionWrapper(5309): getSelectedText on inactive InputConnection
10-19 16:01:47.055: W/IInputConnectionWrapper(5309): getTextBeforeCursor on inactive InputConnection
10-19 16:01:47.055: W/IInputConnectionWrapper(5309): getTextAfterCursor on inactive InputConnection
10-19 16:01:47.300: W/IInputConnectionWrapper(5309): showStatusIcon on inactive InputConnection
10-19 16:01:52.315: W/dalvikvm(5309): threadid=1: thread exiting with uncaught exception (group=0x40c721f8)
10-19 16:01:52.320: E/AndroidRuntime(5309): FATAL EXCEPTION: main
10-19 16:01:52.320: E/AndroidRuntime(5309): android.app.SuperNotCalledException: Activity {com.directenquiries.assessment.tool/com.directenquiries.assessment.tool.AddAsset} did not call through to super.onStop()
10-19 16:01:52.320: E/AndroidRuntime(5309):     at android.app.Activity.performStop(Activity.java:4673)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at android.app.ActivityThread.performDestroyActivity(ActivityThread.java:3088)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at android.app.ActivityThread.handleDestroyActivity(ActivityThread.java:3147)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at android.app.ActivityThread.access$1200(ActivityThread.java:128)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1194)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at android.os.Handler.dispatchMessage(Handler.java:99)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at android.os.Looper.loop(Looper.java:137)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at android.app.ActivityThread.main(ActivityThread.java:4517)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at java.lang.reflect.Method.invokeNative(Native Method)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at java.lang.reflect.Method.invoke(Method.java:511)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:993)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:760)
10-19 16:01:52.320: E/AndroidRuntime(5309):     at dalvik.system.NativeStart.main(Native Method) 
```

这是我的代码：

```
public void startCamera() 
    {
        File photo = null;
        Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");
        timestamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());

        if (android.os.Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED)) 
               {
                   photo = new File(Global.Pictures + timestamp +".png");

               } 
        else 
               {
                   photo = new File(getCacheDir(), FOLDER_NAME+File.separator+timestamp+".png");
               }    
        if (photo != null) 
               {
                   intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(photo));
                   selectedImageUri = Uri.fromFile(photo);
                   startActivityForResult(intent, CAPTURE_IMAGE_CALLBACK);
               }

    }

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == 1){

    if(resultCode == RESULT_OK) {

      String PhotoDescription = DBFunctions.GetObjectName(StationObjectID);
      String PhotoDate = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date()); 

 }

    if(resultCode == RESULT_CANCELED) {

       Context context = getApplicationContext();
        CharSequence text = "Photo Capture Cancelled";
        int duration = Toast.LENGTH_SHORT;

        Toast toast = Toast.makeText(context, text, duration);
        toast.show();

    } 
```

任何帮助将不胜感激

汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:07:51.023

例外是`SuperNotCalledException`。

你只是错过了一个`super.onStop()`电话。

> 活动 {com.directenquiries.assessment.tool/com.directenquiries.assessment.tool.AddAsset} 没有调用 super.onStop()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:09:15.713

在例外情况下：`android.app.SuperNotCalledException: Activity {com.directenquiries.assessment.tool/com.directenquiries.assessment.tool.AddAsset} did not call through to super.onStop()`

你有 onStop() 方法吗？在那里你必须调用 super.onStop()。

# asp.net-mvc - asp.net mvc 自定义授权角色属性

> ID：12977103
> 
> 赞同：1
> 
> 时间：2012-10-19T15:05:08.180
> 
> 标签：asp.net-mvc

我需要将以下角色应用于我的大多数控制器，例如

```
this[Authorize(Roles="SysAdmin,Admin,Support")]. 
```

如何在基本控制器中重构此代码而不为每个控制器指定角色？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:15:33.760

[AuthorizeAttribute](http://msdn.microsoft.com/en-us/library/system.web.mvc.authorizeattribute%28v=vs.108%29.aspx)定义为

```
[AttributeUsageAttribute(AttributeTargets.Class|AttributeTargets.Method, Inherited = true, 
    AllowMultiple = true)]
public class AuthorizeAttribute : FilterAttribute, IAuthorizationFilter 
```

如您所见，它是用 定义的`Inherited = true`，因此简单地将属性应用于基本控制器应该会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:21:07.607

看看 FluentFilters lib [http://fluentfilters.codeplex.com/](http://fluentfilters.codeplex.com/)它提供了一种简单地应用全局过滤器的方法。

# objective-c - 通用 SBJason 解析器反映 Xcode 4.5 上的错误

> ID：12977109
> 
> 赞同：1
> 
> 时间：2012-10-19T15:05:35.143
> 
> 标签：objective-c, ios, xcode

我正在使用 SBJason 解析器将数据从我的服务器提取到我的应用程序中，但是在升级到 Xcode 4.5 后出现了这个新错误。

在这条线上：

```
- (void)maxDepthError {
    self.error = [NSString stringWithFormat:@"Input depth exceeds max depth of %lu", maxDepth]; //This is where the error lies
    self.state = [SBJsonStreamParserStateError sharedInstance];
} 
```

错误：

```
Format specifies type 'unsigned long' but the argument has type 'NSUInteger'(aka 'unsigned int') 
```

非常感谢任何指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:58:40.787

修复错误更改格式说明符以更正无符号整数 ( `%u`)的值

```
self.error = [NSString stringWithFormat:@"Input depth exceeds max depth of %u", maxDepth]; 
```

# python - 修改 Google App Engine 实体 ID？

> ID：12977110
> 
> 赞同：2
> 
> 时间：2012-10-19T15:05:37.197
> 
> 标签：python, google-app-engine

我正在使用 Google App Engine NDB。有时我想在指定列表中获取所有具有电话号码的用户。为此使用查询非常昂贵，所以我想我只需将 User 实体的 id 值设置为用户的电话号码，这样我就可以直接通过 id 获取。

问题是电话号码字段是可选的，所以最初创建的用户实体没有电话号码，因此没有 id 值。所以它将被创建`user = User()`而不是`user = User(id = phone_number)`.

因此，当用户稍后决定将电话号码添加到他的帐户时，是否可以将该用户实体的 id 值修改为新的电话号码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:04:36.753

实体 ID 构成实体主键的一部分，因此无法更改它。更改它与使用新密钥创建新实体并删除旧实体相同 - 如果您愿意，这是您可以做的一件事。

更好的解决方案是创建`PhoneNumber`一种提供对关联的引用的类型`User`，允许您使用 get 操作进行查找，但不要求每个用户都只有一个电话号码。

# c# - 为什么要使用 Windows.Forms.Timer？

> ID：12977111
> 
> 赞同：5
> 
> 时间：2012-10-19T15:05:41.050
> 
> 标签：c#, winforms, timer

我阅读了这篇出色的文章[Comparing the Timer Classes in the .NET Framework Class Library](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)并得出结论，我可以用它做的任何事情都`Windows.Forms.Timer`可以做得更好`Timers.Timer`- 然后是[一些](https://stackoverflow.com/a/4532859/1357272).

所以想到的明显问题是：为什么要`Windows.Forms`提供 Timer？

旧版（向后兼容性）支持？

其他？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-19T15:09:40.183

的主要方便之`Windows.Forms.Timer`处在于它的事件在 UI（Winforms）线程上触发。如果您的计时器事件执行 UI 操作，它可能是最简单的选择（而不是调用`Control.Invoke/BeginInvoke`或`SynchronizationContext.Post/Send`在您的所有事件中）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-19T15:07:51.640

这些`Windows.Forms.Timer`事件在 UI 线程上被调用，因此您可以直接从事件处理程序更新 UI，这通常不是这种情况`Timers.Timer`（因为您会遇到跨线程访问冲突异常）。

而且，正如@Robert Harvey[回答](https://stackoverflow.com/a/12977136/1583)的那样，它也有设计师的支持。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-19T15:07:51.780

Windows.Forms 的优点之一是它在 GUI 的同一线程中运行，并且在访问 Form 控件时不会出现跨线程异常。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-19T15:07:07.970

Windows.Forms.Timer 具有设计器支持。因此它的行为与任何其他 Winforms 组件一样（例如，您可以将它拖到表单上，它是 Controls 集合的一部分，等等）。

类引发的计时器事件`System.Windows.Forms.Timer`与 Windows 窗体应用程序中的其余代码同步。这意味着正在执行的应用程序代码永远不会被此计时器类的实例抢占（假设您不调用`Application.DoEvents`）。类触发的事件`Windows.Forms.Timer`与您的 Winform 控件兼容；您可以安全地与他们互动，而无需致电`Invoke()`.

该类`System.Timers.Timer`是一个基于服务器的计时器，专为在多线程环境中使用而设计和优化。可以从多个线程安全地访问此计时器类的实例。尽管`Invoke()`在技术上需要与 Winforms 交互，但 Timer 类确实提供了一个`SynchronizingObject`属性，您可以将要与之安全交互的 Windows 窗体附加到该属性。

更多信息：http: [//msdn.microsoft.com/en-us/magazine/cc164015.aspx](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-19T15:10:49.750

好吧，我认为答案是它们是两种完全不同类型的计时器。这`Windows.Forms.Timer`是一个单线程应用程序计时器，非常适合存在于客户端运行应用程序上的计时器。

> Timer 用于以用户定义的时间间隔引发事件。此 Windows 计时器专为使用 UI 线程执行处理的单线程环境而设计。它要求用户代码具有可用的 UI 消息泵，并且始终从同一个线程操作，或者将调用编组到另一个线程。

相比之下，这`Timers.Timer`是一个基于服务器的计时器，更适合 Windows 服务。

> Timer 组件是一个基于服务器的计时器，它允许您指定在应用程序中引发 Elapsed 事件的重复间隔。然后，您可以处理此事件以提供常规处理。例如，假设您有一台关键服务器必须每周 7 天、每天 24 小时保持运行。您可以创建一个使用 Timer 定期检查服务器并确保系统正常运行的服务。如果系统没有响应，该服务可能会尝试重新启动服务器或通知管理员。

您可以找到他们的文档并阅读 Microsoft 的摘录和更多内容。

并不是说永远不应该使用或始终使用一个，而是服务于两个不同的目的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T15:07:44.403

我相信它是用于 winform 设计器集成的，因为您可以将其拖到表单上，单击它并在属性窗格中设置其属性。

# android - Android 中带有复选框的 ExpandableListView

> ID：12977114
> 
> 赞同：1
> 
> 时间：2012-10-19T15:06:03.247
> 
> 标签：android, eclipse, layout, checkbox, expandablelistview

我正在尝试使用 Eclipse 在 Android 中创建一个简单的任务列表。我正在尝试构建的布局是这样的：

![布局](../Images/b9e9a37e5505b714680f44c0f25b4ed4.png)

我希望任务成为组，并且在每个任务下，有 2 个具有任务描述和任务限制日期的孩子。

在任务/组的右侧，我想要一个用于将任务标记为已完成的复选框，但我真的不知道该怎么做。我什至在为我的 ExpandableListView 使用适配器时遇到问题（我设法找到的所有问题都是关于使用 ListViews 和 Maps of Strings 从废料创建 ExpandableListView，但如果可能的话，我想在我的 XML 布局中使用已经创建的 ExpandableListView）或思考如何我将从输入中添加任务（输入是按下按钮时出现的 AlertDialog）。

任何想法都会受到赞赏，并为我的英语（不是我的母语）感到抱歉。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T19:37:54.300

我会做这样的事情的方式是使用自定义适配器（这些扩展 baseexpandableadapter 类）使您的可扩展列表视图。然后，您可以为您的组和子视图膨胀或创建不同的视图。这是一个示例，说明如果您使用可扩展列表活动（与使用可扩展列表视图的常规活动相比），您可以如何设置它：

```
public class ExpandableList1 extends ExpandableListActivity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Set up our adapter
    ExpandableListAdapter mAdapter = new MyExpandableListAdapter(this);
    setListAdapter(mAdapter);
}
    // The custom adapter part
public class MyExpandableListAdapter extends BaseExpandableListAdapter {
    // Sample data set.  children[i] contains the children (String[]) for groups[i].
    private String[] groups = { "Task1", "Task2", "Task3", "Task4"};
    private String[][] children = {
            { "Task Description", "Task time limit date" },
            { "Task Description", "Task time limit date" },
            { "Task Description", "Task time limit date" },
            { "Task Description", "Task time limit date" }
    };

public MyExpandableListAdapter(Context context) {
    super();
    this.context = context;
}

private Context context;

static class ViewHolder {
        TextView text;
        CheckBox checkbox;
    }

    public Object getChild(int groupPosition, int childPosition) {
        return children[groupPosition][childPosition];
    }

    public long getChildId(int groupPosition, int childPosition) {
        return childPosition;
    }

    public int getChildrenCount(int groupPosition) {
        return children[groupPosition].length;
    }

    public View getChildView(int groupPosition, int childPosition, boolean isLastChild,
            View convertView, ViewGroup parent) {
    return convertView;
    }

    public Object getGroup(int groupPosition) {
        return groups[groupPosition];
    }

    public int getGroupCount() {
        return groups.length;
    }

    public long getGroupId(int groupPosition) {
        return groupPosition;
    }

    public View getGroupView(int groupPosition, boolean isExpanded, View convertView,
            ViewGroup parent) {

    final ViewHolder holder;

        if (convertView == null) {
            LayoutInflater viewInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = viewInflater.inflate(R.layout.mtopics_groupview, parent, false);
            holder = new ViewHolder();
            holder.text = (TextView)convertView.findViewById(R.id.mtopicsgrouptv);
            holder.checkbox = (CheckBox)convertView.findViewById(R.id.cb_group);

            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

    holder.text.setText(getGroup(groupPosition).toString());
    return convertView;
    }

    public boolean isChildSelectable(int groupPosition, int childPosition) {
        return true;
    }

    public boolean hasStableIds() {
        return true;
    }

} 
```

您可以通过编程方式创建您的组视图和子视图，或者您可以从 xml 扩展这些视图。在我的示例中，我只为组视图从 xml 膨胀，因为对于更复杂的视图来说更容易。我知道该模式似乎是使用两行膨胀代码的一种迂回方法，但它会极大地帮助您的视图性能。您可以在此处了解更多信息：[http](http://www.youtube.com/watch?v=wDBM6wVEO70) ://www.youtube.com/watch?v=wDBM6wVEO70 。就目前而言，xml 非常简单，它只是一个文本视图和一个复选框。（小提示：groupviews 中的复选框必须将“focusable”设置为 false 并且不能直接与 group view 指示器相邻，否则 group view 将无法展开）

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <CheckBox
        android:id="@+id/cb_group"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:checked="true"
        android:focusable="false" />

    <TextView
        android:id="@+id/mtopicsgrouptv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:layout_marginLeft="40dp"
        android:focusable="false"
        android:text="Small Text"
        android:textAppearance="?android:attr/textAppearanceSmall" />

</RelativeLayout> 
```

我没有做childview，但是根据你想用它做什么，你可以在group view之后建模。您可以在其中放置一个文本视图并根据子位置设置文本。**但是我要警告你**，到目前为止，你很快就会发现你的复选框状态在你点击它们时会变得古怪。有时支票会移动或消失或根本不起作用。如果你想知道为什么我可以告诉你，但我现在只发布解决方案。您必须设置一个数组列表或映射或任何真正保存复选框状态的东西，然后加载它们（因为它们的位置将对应）。这是我在 getGroupView 部分中的操作方法。

```
// make the list
ArrayList<Boolean> group_check_states = new ArrayList<Boolean> (groups.length);
        for(int i = 0; i < groups.length; i++) {
        group_check_states.add(true);
    }
// load the checkstates
    if ((group_check_states.get(groupPosition)) == true) {
        holder.checkbox.setChecked(true);
    } else {
        holder.checkbox.setChecked(false);
    }

//   save the checkstates
holder.checkbox.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            if (holder.checkbox.isChecked()) {
                group_check_states.set(groupPosition, true);
            } else {
                group_check_states.set(groupPosition, false);
                }
            }
    }); 
```

您也可以将您的复选框操作代码放在那里。现在适配器看起来很重要，但它可能对您的意图来说太简单了。您希望能够根据输入的警报对话框动态设置任务。在这种情况下，您不想使用我使用的那个简单的数组（组和子项），您可能希望从数组列表或其他类型的列表中加载，您可以动态添加和删除事物，这将由您的警报对话框修改。

我希望它有所帮助，但我相信在此过程中还会有更多问题。如果有什么事情发生，你好。

# php - PHP 下拉菜单

> ID：12977115
> 
> 赞同：0
> 
> 时间：2012-10-19T15:06:04.690
> 
> 标签：php

我想知道 PHP 中是否有可能有多个下拉菜单，但是当您按下提交时，它会检查哪个已更改。

可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:19:31.027

您可以通过 Javascript 和隐藏字段来完成：

HTML：

```
<select class="dropdown" id="1">
....
</select>
<select class="dropdown" id="2">
....
</select>
<input type="hidden" class="dropdownValue" name="dropdownValue" /> 
```

JS（假设 jQuery）：

```
$('.dropdown').change(function(){
    $('.dropdownValue').val($(this).val());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:23:09.183

如果您正在创建一个网络表单并希望在提交后检查哪些控件已更改，我将在表单中包含包含您要检查的控件的原始值的隐藏字段，例如：

```
<select id="field1">
<option>one</option>
</select>
<input type="hidden" name="field1-original" value="original value"/> 
```

然后提交后，检查 $_POST 并将 field1 的值与 field1-original 进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:23:33.453

嗯，PHP：PHP 超文本协议，它只是一种服务器端语言，而不是作为服务器端和用户端语言的 JavaScript。

您可以使用 jQuery >> [http://filamentgroup.com/lab/jquery_ipod_style_and_flyout_menus/轻松实现下拉菜单](http://filamentgroup.com/lab/jquery_ipod_style_and_flyout_menus/)

# jquery - 切换画廊内图像的宽度，当单击一个图像时，其他图像被禁用

> ID：12977118
> 
> 赞同：4
> 
> 时间：2012-10-19T15:06:18.850
> 
> 标签：jquery, toggle

我有一个带有缩略图的画廊。单击一个缩略图时，其宽度将动画并显示完整图像。再次点击它时，它会缩小到原来的大小。我已经通过切换功能实现了这一点，并且效果很好。

问题是，当我单击缩略图时，我希望禁用其他缩略图，但我无法实现。那可能吗？

这是HTML：

```
<figure class="grid_4 alpha medium"><img class="medium pl pt" src="images/gallery/1.jpg" /><span class="rollover opa2"></span></figure>
<figure class="grid_2 small"><img class="small pr pt" src="images/gallery/4.jpg" /><span class="rollover opa2"></span></figure>
<figure class="grid_4 omega medium"><img class="medium pr pt" src="images/gallery/5.jpg" /><span class="rollover opa2"></span></figure> 
```

这是jQuery：

```
$('.gallery figure').toggle(function(){
    $(this).find('img').animate({width:620, height:620}, 500, "easeOutExpo");
},function(){
    $('.gallery .medium').animate({width:300, height:300}, 500, "easeOutExpo");
    $('.gallery .small').animate({width:140, height:140, marginTop:0}, 500, "easeOutExpo");
}); 
```

我对 jquery 不是很好，所以如果有人能提供任何帮助，我将不胜感激。

非常感谢，杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:46:16.427

我建议不要抑制切换事件（这会增加开销），而是使用一个简单的*标志*变量来确定图像当前是否扩展为全尺寸。

请参阅以下演示：http: [//jsfiddle.net/adamb/yWSBx/](http://jsfiddle.net/adamb/yWSBx/)

```
var flag = false;

$('.foo').click(function() {
    if($(this).hasClass('focus')) {
       ////////shrink image
    }
    else {
        if(!flag) {
            ////////expand image
            flag = true;
        }
    }
});​ 
```

# c++ - 具有 C++11 和线程支持的 Visual express c++

> ID：12977127
> 
> 赞同：1
> 
> 时间：2012-10-19T15:06:43.457
> 
> 标签：c++, visual-c++, c++11, visual-studio-2012, visual-studio-express

我目前正在为我的项目使用 Visual Express C++ (2010)，但我正在研究 C++11 中的功能（线程支持）。Express 2010 似乎不支持此功能。

从我目前的研究来看，我需要 Visual Express C++ 2012 版本来获得对此的支持（[http://blogs.msdn.com/b/vcblog/archive/2011/09/12/10209291.aspx](http://blogs.msdn.com/b/vcblog/archive/2011/09/12/10209291.aspx)）？

从这个页面引用：

> > 在 VC11 中，我们打算完全支持 C++11 标准库，模尚未实现的编译器功能。（此外，VC11 不会完全实现 C99 标准库，它已通过引用合并到 C++11 标准库中。请注意，VC10 和 VC11 已经具有 .）这是我们所做更改的非详尽列表制造：
> 
> 新标题：

```
 <atomic>, <chrono>, <condition_variable>, <future>,<mutex>, <ratio>,
 <scoped_allocator>, and <thread>. 
```

总而言之：我有哪些选择来获得 Visual Express 的`<thread>`支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:57:59.293

要获得对 Visual Studio Express 的支持，您需要 Visual Studio Express 2012，或者您可以购买我的[Just::Thread](http://www.stdthread.co.uk/order.html)库，它为 Windows 上的 MSVC 2005 及更高版本提供 C++11 线程库，以及跨 Windows 的各种版本的 gcc 、Linux 和 MacOSX。

# c++ - fmaf 奇怪的表现

> ID：12977128
> 
> 赞同：2
> 
> 时间：2012-10-19T15:06:45.487
> 
> 标签：c++, linux, performance, g++, intel

`fmaf`使用该功能而不是使用`*`and时，我遇到了巨大的性能下降`+`。我在两台 Linux 机器上并使用 g++ 4.4.3 和 g++ 4.6.3

在两台不同的机器上，如果在`myOut`不使用`fmaf`.

配备 g++ 4.6.3 和 Intel(R) Xeon(R) CPU E5-2650 @ 2.00GHz 的服务器

```
$ ./a.out fmaf
Time: 1.55008 seconds.
$ ./a.out muladd
Time: 0.403018 seconds. 
```

配备 g++ 4.4.3 和 Intel(R) Xeon(R) CPU X5650 @ 2.67GHz 的服务器

```
$ ./a.out fmaf
Time: 0.547544 seconds.
$ ./a.out muladd
Time: 0.34955 seconds. 
```

版本不应该`fmaf`（除了避免额外的综述然后更精确）更快吗？

```
#include <stddef.h>
#include <iostream>
#include <math.h>
#include <string.h>
#include <stdlib.h>

#include <sys/time.h>

int main(int argc, char** argv) {
  if (argc != 2) {
    std::cout << "missing parameter: 'muladd' or 'fmaf'"
              << std::endl;
    exit(-1);
  }
  struct timeval start,stop,result;
  const size_t mySize = 1e6*100;

  float* myA = new float[mySize];
  float* myB = new float[mySize];
  float* myC = new float[mySize];
  float* myOut = new float[mySize];

  gettimeofday(&start,NULL);
  if (!strcmp(argv[1], "muladd")) {
    for (size_t i = 0; i < mySize; ++i) {
      myOut[i] = myA[i]*myB[i]+myC[i];
    }
  } else if (!strcmp(argv[1], "fmaf")) {
    for (size_t i = 0; i < mySize; ++i) {
      myOut[i] = fmaf(myA[i], myB[i], myC[i]);
    }
  } else {
    std::cout << "specify 'muladd' or 'fmaf'" << std::endl;
    exit(-1);
  }

  gettimeofday(&stop,NULL);
  timersub(&stop,&start,&result);
  std::cout << "Time: " <<  result.tv_sec + result.tv_usec/1000.0/1000.0
            << " seconds." << std::endl;

  delete []myA;
  delete []myB;
  delete []myC;
  delete []myOut;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:53:06.400

据我所知，英特尔至强处理器不支持融合乘加指令。Wikipedia 指出这些可用于 AMD Piledriver 和 Bulldozer 架构处理器，英特尔将在 2013/14 年的 Haswell/Broadwell 之前推出它们。因此，如果没有直接的指令支持，该`fmaf`函数很可能被编译为模拟指令的实际函数调用。因此，存在函数调用开销以及实际的乘法和加法指令。non-`fmaf`选项产生内联乘法和加法指令，没有函数调用开销，因此速度要快得多。如有疑问，请使用`g++ -S`并检查生成的汇编代码。

此外，内联代码可以更好地优化甚至矢量化（如另一个答案中所述），但当然，结果取决于您在编译中传递的编译器和确切标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:53:17.677

您的问题的答案称为*矢量化*。比较 g++ 4.4.6 在编译时为您的代码的两个部分生成的汇编代码`g++ -O3 -S`：

部分`muladd`：

```
.L10:
    movaps  %xmm2, %xmm0
    movaps  %xmm2, %xmm1
    movlps  (%rbx,%rax), %xmm0
    movlps  (%r12,%rax), %xmm1
    movhps  8(%rbx,%rax), %xmm0
    movhps  8(%r12,%rax), %xmm1
    mulps   %xmm1, %xmm0
    movaps  %xmm2, %xmm1
    movlps  0(%rbp,%rax), %xmm1
    movhps  8(%rbp,%rax), %xmm1
    addps   %xmm1, %xmm0
    movaps  %xmm0, 0(%r13,%rax)
    addq    $16, %rax
    cmpq    $400000000, %rax
    jne     .L10 
```

所有这些都对*打包的单精度*数字`*ps`执行操作。这些是 SSE 指令，因此每个包由每个数组的 4 个连续元素组成。

 *实现`fmaf`版本的循环是：

```
.L14:
    movss   (%rbx,%r14,4), %xmm0
    movss   0(%rbp,%r14,4), %xmm2
    movss   (%r12,%r14,4), %xmm1
    call    fmaf
    movss   %xmm0, 0(%r13,%r14,4)
    addq    $1, %r14
    cmpq    $100000000, %r14
    jne     .L14 
```

这里使用标量 SSE 指令一次将数据移动一个数组元素，**并**`fmaf`在每次迭代时进行函数调用。

循环的向量部分更长，但执行的迭代次数减少了 4 倍。*

# javascript - 复制 Cargocollective jquery/lightbox

> ID：12977129
> 
> 赞同：0
> 
> 时间：2012-10-19T15:06:48.513
> 
> 标签：javascript, jquery, plugins, web, cargo

很久以前，我有一个关于 cargocollective 的网站。 [http://cargocollective.com/ruimelo](http://cargocollective.com/ruimelo)

而且我正在构建一个不使用 Cargo 的新产品，但是我喜欢 Cargocollective 在这个主题中的展示方式。虽然每件作品都显示有一个小缩略图，但您单击它，它会展开，显示完整的图像和简要说明。

我确信这已经完成了，但是对于我的生活，我找不到它，或者在线上类似的 jQuery 插件，而且当我自己编写 JS 时，我绝对不能满足。

如果有人能指出我正确的方向，我将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:36:25.500

我认为你能得到的最接近的是使用[Masonry](http://masonry.desandro.com)插件。请参阅我创建的这个小演示[http://jsfiddle.net/dfsq/838Bf/1/](http://jsfiddle.net/dfsq/838Bf/1/)

所以基本上你需要做的只是通过AJAX加载项目数据并放入相应的容器中。其余的将由插件处理。

插件的使用非常简单，比如

```
$('ul').masonry({
    itemSelector: 'li',
    columnWidth: 100
}); 
```

# python - 在 webpy 中使用 PUT 接收一个 xml 文件

> ID：12977134
> 
> 赞同：0
> 
> 时间：2012-10-19T15:07:05.550
> 
> 标签：python, web.py

我正在尝试通过 web.py 中的 PUT 接收 xml 文件，但它不起作用。任何人都可以解释以下代码中的问题

```
import web

urls = (
    '/', 'index'
)

class index:
    def PUT(self):
        postdata = web.data().read()
        fout = open('/home/test/Desktop/e.xml','w')
        fout.write(postdata)
        fout.close()
        return "Hello, world!"

if __name__ == "__main__":
    app = web.application(urls, globals())
    app.run() 
```

我得到这是终端

```
"HTTP/1.1 PUT /doc.xml" - 404 Not Found 
```

我使用 curl 上传 xml

```
curl -o log.out -H "Content-type: text/xml; charset=utf-8" -T doc.xml "http://0.0.0.0:8760" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:38:46.717

您使用了错误的`curl`选项。

如果您希望请求正文中的文件内容，您应该使用`-d`而不是`-T`

```
curl -o log.out -H "Content-type: text/xml; charset=utf-8" -d doc.xml "http://0.0.0.0:8760" 
```

编辑：

无论如何，这会将您`curl`转换为 POST 请求。要将其保留为 PUT，请使用`-X PUT`

```
curl -X PUT -o log.out -H "Content-type: text/xml; charset=utf-8" -d doc.xml "http://0.0.0.0:8760" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:53:03.860

```
import web

urls = ( '/upload', 'index')

class index:
    def PUT(self):
        datta = web.data()
        with open("another.xml", "w") as f:
            f.write(datta)
        return "hello"

if __name__ == "__main__":
    app = web.application(urls, globals())
    app.run() 
```

用这个卷曲

```
curl -T somexml.xml http://0.0.0.0:8080/upload 
```

为我工作。我需要更改 url，因为 curl 表现得很奇怪。或者在我看来。但不知何故，这段代码不能使用“/”作为 url。

# php - 安全性：跟踪像素

> ID：12977135
> 
> 赞同：0
> 
> 时间：2012-10-19T15:07:07.937
> 
> 标签：php, javascript, security

我们公司与推广我们产品的附属公司合作。他们根据给我们带来的销售额获得报酬。

为了跟踪转化，他们要求我们将第三方跟踪像素放在我们的“谢谢”页面（通过第三方计费处理器完成付款后我们的客户被重定向的最后一页）。

因此，我们最终在“谢谢”页面上获得了大量跟踪 JS 代码和隐藏的 iframe。

**安全吗？**
计费处理器通过 GET 变量将敏感数据发送到此页面，我们不希望关联公司可以访问这些数据。

或者也许有更好的方法来做到这一点？例如，将来自我们关联公司的所有跟踪代码存储在数据库中，然后只加载与客户推荐匹配的代码？

**更新**

我担心“第三方跟踪像素”不是来自“受信任的”第三方（如 Google、Yahoo），而是由我们的关联公司定制的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:11:44.060

您不必担心附属公司。通常，此类解决方案仅与您的合作伙伴交谈并在此分发。

至于 GET 参数或页面内容，只需阅读 JavaScript 代码并查看其行为方式即可。如果它不评估某些响应并且不触及 DOM 元素和 cookie，那么你就可以了。我真的认为他们没有理由需要这样做。但是，如果合作伙伴似乎不值得信任，那为什么还要与他们打交道呢？

请注意，如果您请求静态资源（作为图像），则只会发送由图像的位置域设置的 cookie。要查看您的页面上发生了什么，请使用 Firebug 或 Chrome 开发人员工具并检查正在发送的请求标头。

# css - CSS3 卡片翻转填充

> ID：12977140
> 
> 赞同：0
> 
> 时间：2012-10-19T15:07:14.910
> 
> 标签：css, animation, html

我正在使用教程中的一些代码为我将向用户展示的“卡片”列表自定义卡片翻转过渡。

我已经尝试将它与我的设计相匹配，但是我在使用 div 容器时遇到了问题——我无法弄清楚如何在不使翻转轴远离卡片中心的情况下添加填充。我希望它翻转到位，但每次我添加填充时，它都会将翻转轴向上移动一点。

我究竟可以在哪里为我的翻转卡添加样式，以便它们仍然可以正确翻转？

```
<div class="flip"> 
    <div class="card"> 
        <div class="face front"> 
            <div class="padding">
                <table class="majorTable">
                    <tr>
                        <td width="6%" class="list-number">2.</td>
                        <td width="79%" class="major">Brain and Behavioral Sciences</td>
                        <td width="15%" rowspan="2" align="right"><div id="charts2" style="height:110px; width:110px;display:inline-block;"></div></td>
                    </tr>
                    <tr>
                        <td width="5%" class="list-number"></td>
                        <td width="95%" class="major-description align-top">The term behavioural sciences encompasses all the disciplines that explore the activities of and interactions among organisms in the natural world. It involves the systematic analysis and...</td>
                    </tr>
                </table>
            </div>
        </div> 
        <div class="face back"> 

            <div class="padding">
                <table class="majorTable">
                    <tr>
                        <td width="100%" class="major-description align-top">Computer science or computing science (abbreviated CS or CompSci) designates the scientific and mathematical approach in computing. A computer scientist is a scientist who specialises in the theory of computation and the design of computers. Its subfields can be divided into practical techniques for its implementation and application in computer systems and purely theoretical areas.</td>
                    </tr>
                </table>
            </div>
        </div> 
    </div> 
</div> 
```

* * *

```
body {
 background: #ccc;   
}
.flip {
  -webkit-perspective: 800;
   width: 80%;
   height: 130px;
    position: relative;
    margin: 50px auto;
}
.flip .card.flipped {
  -webkit-transform: rotatex(180deg);
}
.flip .card {
  width: 100%;
  height: 100%;
  -webkit-transform-style: preserve-3d;
  -webkit-transition: 0.3s;
}
.flip .card .face {
  width: 100%;
  height: 100%;
  position: absolute;
  -webkit-backface-visibility: hidden ;
  z-index: 2;
    box-shadow:0px 0px 20px #555;
}
.flip .card .front {
  position: absolute;
  z-index: 1;
    background: black;
    color: white;
    cursor: pointer;
}
.flip .card .back {
  -webkit-transform: rotatex(180deg);
    background: blue;
    background: white;
    color: black;
    cursor: pointer;
} 
```

* * *

```
$('.flip').click(function(){
    $(this).find('.card').addClass('flipped').mouseleave(function(){
        $(this).removeClass('flipped');
    });
    return false;
});​ 
```

[**这是我现在拥有的小提琴。**](http://jsfiddle.net/KLqR3/)

这是我希望它看起来如何的代码：

```
.majorTable {
    width:100%;
}

.list-number {
    font-family: 'Source Sans Pro', sans-serif;
    font-size: 28px;
    font-weight:bold;
}

.major {
    font-family: 'Source Sans Pro', sans-serif;
    font-size: 28px;
    font-weight:bold;
}

.major-description {
    font-family: 'Source Sans Pro', sans-serif;
    font-size: 14px;
    line-height:2em;
    color:#555;
}

.cardButton {
    background:#F6F6F6;
    padding:10px;
    border:1px dashed #AAA;
}

.cardBorder {
    margin:15px 0 15px 0;
    border: 5px solid #F6F6F6;
} 
```

* * *

```
 <div class="cardBorder">
        <div class="cardButton">
            <table class="majorTable">
                <tr>
                    <td width="6%" class="list-number">1.</td>
                    <td width="79%" class="major">Computer Science</td>
                    <td width="15%" rowspan="2" align="right"><div id="charts1" style="height:110px; width:110px;display:inline-block;"></div></td>
                </tr>
                <tr>
                    <td width="6%" class="list-number"></td>
                    <td width="79%" class="major-description align-top">Computer science or computing science (abbreviated CS or CompSci) designates the scientific and mathematical approach in computing. A computer scientist is a scientist who specialises in the theory...</td>
                </tr>
            </table>
        </div>
    </div> 
```

![](../Images/4f46ce0898a3240f9b801b39931f8345.png) 这是我要如何设置卡片样式的屏幕截图。它基本上是两个嵌套的 div - 外部 div 的边框为 5px，内部 div 的边框为虚线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:29:00.177

将新的 .major-description 类添加到您的 css 中，填充为 5px。像这样：

```
.major-description {
   padding: 5px;
} 
```

这是修改的小提琴：http: [//jsfiddle.net/KLqR3/1/](http://jsfiddle.net/KLqR3/1/)

# c# - 如何处理从 CloudPageBlob.BeginUploadFromStream 中抛出的异常

> ID：12977141
> 
> 赞同：3
> 
> 时间：2012-10-19T15:07:15.750
> 
> 标签：c#, .net, azure, azure-blob-storage, azure-sdk-.net

我正在使用 Azure SDK 将流上传到 Azure 存储 Blob。我想做异步，所以我使用[`CloudPageBlob.BeginUploadFromStream`](http://msdn.microsoft.com/en-us/library/windowsazure/ee758150.aspx). 这样做，我开始思考如果在读取流时抛出异常会发生什么。我找不到有关异常是否会冒泡的任何信息，因此我可以使用 try catch 捕获它，或者该方法是否会调用异步回调，或者会发生什么。

为了尝试一下，我将流包装在一个继承的类中`Stream`，构造函数将我的流作为参数，并将其作为私有变量保存。然后，每个继承的方法只需在私有流上调用它的 equal。然而`Read()`，我抛出一个异常，看看如果在读取流时出现问题会发生什么。然后我将我的流包装器的一个实例传递给`BeginUploadFromStream()`，而不是实际的流。

事实证明，当抛出异常时，`BeginUploadFromStream()`完成并调用异步回调，并且没有异常冒泡到第一次调用该方法的位置，所以我无法用 try catch 捕获它。同时，我找不到有关`IAsyncResult`传递给回调的任何信息，即引发了异常。

我该怎么做才能对`BeginUploadFromStream()`未按预期完成的事实采取行动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:33:07.437

我相信你打电话时会看到异常`EndUploadFromStream`。

# java - 创建一个类型感知杰克逊反序列化器

> ID：12977144
> 
> 赞同：1
> 
> 时间：2012-10-19T15:07:35.627
> 
> 标签：java, annotations, jackson

我想配置一个杰克逊反序列化器，根据带注释的字段的目标类型，它的行为不同。

```
public class Car {
    @JsonSerialize(using=IdSerializer.class)
    @JsonDeserialize(using=IdDeserializer.class)
    String id
}

public class Bus {
    @JsonSerialize(using=IdSerializer.class)
    @JsonDeserialize(using=IdDeserializer.class)
    Id id
} 
```

Jackson 序列化程序知道它转换数据的类型，所以这是有效的：

```
public class IdSerializer extends JsonSerializer<Object> {
    @Override
    public void serialize(Object value, JsonGenerator jsonGen, SerializerProvider provider) throws IOException {

        // value is the annotated field class
        if(value instanceof String)
            jsonGen.writeObject(...);
        else if (value instanceof Id)
            jsonGen.writeObject(...);
        else 
            throw new IllegalArgumentException();
    }
} 
```

Jackson 反序列化器似乎不知道它将数据转换成的目标类型：

```
public class IdDeserializer extends JsonDeserializer<Object> {
    @Override
    public Object deserialize(JsonParser jp, DeserializationContext context) throws IOException {

        // what is the annotated field class?
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:54:32.470

在序列化程序中，您可以添加有关类型的额外信息，这些信息将在反序列化期间为您提供帮助。

从您发布的 IdSerializer 构建...

```
public class IdSerializer extends JsonSerializer<Object> {

    @Override
    public void serialize(Object value, JsonGenerator jsonGen, SerializerProvider provider) throws IOException {

        // value is the annotated field class
        if(value instanceof String){
            jsonGen.writeStartObject();
            jsonGen.writeFieldName("id");
            jsonGen.writeObject(value);
            jsonGen.writeFieldName("type");
            jsonGen.writeString("String");
            jsonGen.writeEndObject();
        }
        else if (value instanceof Id){
            Id id = (Id) value;
            jsonGen.writeStartObject();
            jsonGen.writeFieldName("id");
            jsonGen.writeString(id.getStuff());
            jsonGen.writeFieldName("type");
            jsonGen.writeString("Id");
            jsonGen.writeEndObject();
        }
        else{
            throw new IllegalArgumentException();
        }
    }
} 
```

在您的反序列化器中，您可以解析此“类型”字段并返回正确类型的对象。

# git - 如何备份 git repo 中意外删除的文件？

> ID：12977153
> 
> 赞同：0
> 
> 时间：2012-10-19T15:08:00.207
> 
> 标签：git

```
 On branch master
# Your branch is ahead of 'origin/master' by 1 commit.
#
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#       deleted:    web/img/add-btn-bg.png
#       deleted:    web/img/add-tribute-button.png
#       deleted:    web/img/bottom-shadow.png
#       deleted:    web/img/database-line.png
#       deleted:    web/img/glyphicons-halflings-white.png
#       deleted:    web/img/glyphicons-halflings.png
#       deleted:    web/img/header-logo.png
#       deleted:    web/img/horizontal-line.png
#       deleted:    web/img/icons-btn.png
#       deleted:    web/img/icons.png
#       deleted:    web/img/line-bottom-menu.png
#       deleted:    web/img/never-forget.png
#       deleted:    web/img/tribute-icon-line.png
#       deleted:    web/img/uszatek.jpg
#       deleted:    web/img/uszatek_106.jpg
#       deleted:    web/img/uszatek_148.jpg
#       deleted:    web/img/uszatek_32.jpg
#       deleted:    web/img/uszatek_50.jpg
#
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   web/app_dev.php
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#       img/
#       randomNames.csv
#       sampledb.tgz
#       watch/
#       web/assets/
#       web/uploads/ 
```

我需要从“要提交的更改”返回文件。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:09:46.070

如果您还没有提交，这里是如何取回一个文件（使用`web/img/glyphicons-halflings-white.png`作为一个例子）：

```
git reset HEAD web/img/glyphicons-halflings-white.png
git checkout -f web/img/glyphicons-halflings-white.png 
```

这将取消暂存删除操作，然后恢复文件。

# java - JBoss AS7 在 MDB 锁定后挂起

> ID：12977154
> 
> 赞同：3
> 
> 时间：2012-10-19T15:08:01.850
> 
> 标签：java, jboss, message-driven-bean

我目前在 JBoss AS7 中遇到间歇性异常，不幸的是，我还无法重现。

我们目前正在运行两个应用程序，它们基本上设置为 JMS 消息的生产者/消费者。我们使用默认的 HornetQ 配置和 5 个 MDB 池。

两个应用程序都开始正常运行，按预期发送和接收消息。但过了一会儿，所有 MDB 都被锁定（它们每个都收到一条消息，但没有完成处理），JBoss 在此之后挂起一段时间，每十分钟显示以下消息：

```
[org.jboss.ejb3.invocation] (Thread-21081 (HornetQ-client-global-threads-1636833629)) JBAS014134: EJB Invocation failed on component MyMessageListener for method public abstract void javax.jms.MessageListener.onMessage(javax.jms.Message): javax.ejb.EJBException: JBAS014516: Failed to acquire a permit within 10 MINUTES 
```

从 jarvana 中的 JBoss 代码来看，如果无法获取信号量，似乎会设置此错误：

```
 /**
 * Get an instance without identity.
 * Can be used by finders,create-methods, and activation
 *
 * @return Context /w instance
 */
public T get() {
    try {
        boolean acquired = semaphore.tryAcquire(timeout, timeUnit);
        if (!acquired)
            throw new EJBException("Failed to acquire a permit within " + timeout + " " + timeUnit);
    } catch (InterruptedException e) {
        throw new EJBException("Acquire semaphore was interrupted");
    }
... 
```

问题是，为什么 MDB 会被锁定？他们不应该超时并继续处理吗？我在standalone.xml 文件中将超时设置为5 分钟，但它们似乎永远不会超时。

```
<session-bean>
<stateless>
   <bean-instance-pool-ref pool-name="slsb-strict-max-pool"/>
</stateless>
<stateful default-access-timeout="5000" cache-ref="simple"/>
<singleton default-access-timeout="5000"/>
</session-bean> 
```

有谁知道会发生什么？

我也很乐意接受任何关于如何模拟问题或其他设置 MDB 超时的方法的建议。

任何帮助，将不胜感激。

谢谢你的时间。

**编辑：**

因此，我终于能够通过简单地将 MessageListener 发送到比实例获取超时更长的时间来重现该问题。以下是测试代码：

```
<!-- standalone.xml -->
<strict-max-pool name="mdb-strict-max-pool" max-pool-size="5" instance-acquisition-timeout="30" instance-acquisition-timeout-unit="SECONDS"/> 
```

多边开发银行：

```
@MessageDriven(name = "TestMDB", activationConfig = {
    @ActivationConfigProperty(propertyName = "destinationType", propertyValue = "javax.jms.Queue"),
    @ActivationConfigProperty(propertyName = "destination", propertyValue = "queue/myQueue"),
    @ActivationConfigProperty(propertyName = "acknowledgeMode", propertyValue = "Auto-acknowledge")//,
    })
public class TestMDB implements MessageListener {

private final static Logger LOGGER = Logger.getLogger(TestMDB.class
        .toString());

@Resource 
private MessageDrivenContext ctx;

private final static int sleepingTime = MyProperties.SLEEP_MILLISECS; 

/**
 * @see MessageListener#onMessage(Message)
 */
public void onMessage(Message rcvMessage) {
    ObjectMessage msg = null;
    Future<String> future = null;
    MyResource res = null;

    try {
        if (rcvMessage instanceof ObjectMessage) {
            msg = (ObjectMessage) rcvMessage;
            res = (MyResource)msg.getObject();

            LOGGER.info("Received resource: " + res);
            Thread.sleep(sleepingTime);
            LOGGER.info("Released resource: " + res);
        } else {
            LOGGER.warning("Message of wrong type: "
                    + rcvMessage.getClass().getName());
        }
    } catch (JMSException e) {
        throw new RuntimeException(e);
    } catch (InterruptedException e) {
        throw new RuntimeException(e);
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T13:55:20.800

似乎这种行为是意料之中的，而且问题可能与应用程序有关。

以下是问题的摘要：

1.  我们有一个 MDB 实例；
2.  MDB 从队列 Q1 接收消息；
3.  我们向队列 Q1 发送消息；
4.  MDB 尝试处理它，但由于我们模拟了一个比 instance-acquisition-timeout 花费更长的过程，HornetQ 超时并且我们得到异常：“未能在 X MINUTES 内获得许可”；
5.  不幸的是，MDB 继续处理，只有在休眠时间之后才被释放
6.  如果我们在 MDB 发布之前停止 JBoss，应用程序会继续它的处理，因为消息是持久的并且它知道我们没有完成 MDB#onMessage 方法；
7.  但是由于我们还没有发现应用程序问题，锁再次发生，我们得到一个异常循环；

理想的解决方案是找出 MDB 被锁定的原因，但在那之前，由于应用程序已经投入生产，我们需要一个备用计划。

我相信一种解决方案是在我们达到 Hornet 的等待超时（或事务超时 - @ActivationConfigProperty(propertyName = "transactionTimeout", propertyValue = "30")）后中断 MDB 线程，但似乎并不容易配置（尚未）在 JBoss AS7 中执行此操作。

可悲的方法是计时 MDB 线程执行并在 onMessage 方法中强制中断。这可以通过 ExecutorService 轻松实现（http://stackoverflow.com/questions/6460664/how-can-i-interrupt-method-execution-by-time）

对于遇到同样问题的人，我在网上发现了一些类似的讨论：

[http://bryanpendleton.blogspot.com.br/2009/05/timertask-exception-handling.html](http://bryanpendleton.blogspot.com.br/2009/05/timertask-exception-handling.html) https://community.jboss.org/thread/162822

希望这可以帮助。

并希望我能检测到应用程序有什么问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-12T02:24:20.170

我也遇到了这个问题，最后通过以下命令检查JBoss的线程找到了根本原因。

```
jstack $pid 
```

我们发现了一个线程死锁。在我们解决了僵局之后，JBoss 不再停止。

# android - Android：9-patch 图像未按预期拉伸

> ID：12977157
> 
> 赞同：9
> 
> 时间：2012-10-19T15:08:20.637
> 
> 标签：android, nine-patch

实际图像是这样的：

红色 boxex 是我制作 1 px black likes 的地方。甚至预览显示也很好。所以 9-patch 没问题

但我为以下布局得到的图像是：

```
<ImageView
    android:id="@+id/image_landing"
    android:layout_width="fill_parent"
    android:layout_height="50dp"
    android:background="@drawable/loginheader"
    android:contentDescription="@string/login_header"
     /> 
```

![在此处输入图像描述](../Images/079904c7f3dceb02a8a88611ca3080b1.png)

我预计，标志在左边，黑点在右边，它们之间的其余空间用我在顶部选择的灰色填充

谢谢你

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-19T15:46:32.613

你`ImageView`真的比你的9patch大吗？
如果没有，您需要更改`scaleType`默认为[FIT_CENTER](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html)。

使用`android:scaleType="fitXY"`或`android:adjustViewBounds="true"`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T18:47:40.723

看起来您的 9 补丁比您尝试放入的 ImageView 大。尝试将 ImageView 设置为 wrap_content 以查看它是否解决了问题。如果是这样，请尝试使 9 补丁更小，ImageView 更大或将 scaleType 设置为提到的 pcans。

# sql - 控制不同输出的case语句

> ID：12977162
> 
> 赞同：1
> 
> 时间：2012-10-19T15:08:41.273
> 
> 标签：sql

我有这样的查询

```
Select SSN, FName, MName, LName, sum(WagesAmt) as WagesAmt, sum(OtherAmt) as OtherAmt
      from #data
      group by SSN, FName, MName, LName
      having sum(WagesAmt) <> 0 
```

当涉及到另一个状态时，我希望输出结合 Lastname、Fname、Mname。

我需要做这样的事情吗：

```
declare @result table

set @result = case 
when  then select 
when  then select 
```

我的问题是如何编写案例语句来控制不同的输出要求？

对于 TX，输出会喜欢

ssn FNAME, LName, 金额 1111 jon WANG 3444

对于 CA

输出将是这样的

1111 王军 34444

很抱歉造成混淆谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:28:37.467

我想 State 是一个条件，它会告诉你是否希望你的 fName 和 Lname 作为不同的列或相同的列，对吗？

问题是，只要您在 group by 中选择您使用的所有字段，就可以了。您的案例的秘密是，当您同时拥有 Fname 和 Lname 时，您将需要一个空列，一个带有 CASE 的列，第二个带有相反 CASE 的列

我希望这个简单的例子可以帮助你：

```
CREATE table names(
firstName varchar(50),
lastName varchar(50),
condition int,
amount int)

insert into names VALUES('First1', 'Last1', 1, 10)
insert into names VALUES('First1', 'Last1', 1, 10)
insert into names VALUES('First2', 'Last2', 2, 5)
insert into names VALUES('First2', 'Last2', 2, 5)

SELECT 
case 
    when condition=1 then firstname
    else firstname + ' - ' + lastname
    END,
case
    when condition=1 then lastname
    else ''
    END,
sum(amount)
FROM names
group BY firstname, lastname, condition 
```

结果：

```
Column1                     Column2          Column3
First1                        Last1               20
First2 - Last2                                    10 
```

# java - DatagramChannel.close() 在 Windows 上保持端口打开

> ID：12977164
> 
> 赞同：2
> 
> 时间：2012-10-19T15:08:53.113
> 
> 标签：java, udp, nio

我正在实施一个发现过程：

*   打开 UDP 套接字以侦听给定端口上的广播响应
*   发送一些请求（并期待稍后的响应）
*   在给定时间后关闭 UDP 套接字

第一个电话有效。但其他调用得到一个绑定错误。地址已被使用：bind

我正在运行 Windows 7。我做了一些测试，发现在 channel.close(); Netstat 仍然给出：

netstat -a -b -sp udp | grep 55224

UDP 0.0.0.0:55224 *：*

所以 udp 端口​​还是在 OS 级别打开的

我在网上搜索，它可能是操作系统级别的泄漏：[Some java Datagram Socket questions](https://stackoverflow.com/questions/6361741/some-java-datagram-socket-questions)

我运行了 2 个测试，一个使用 NIO 通道，一个不使用（来自网络上的测试）。我用 NIO 版本重现了我的错误，但如果我不使用 NIO，它就可以工作。

我任何人都可以指出我如何使它与 NIO 一起工作。目标平台是 Android，我不`t wan`总是收听广播，而是只收听重复的时间段。

## 测试插座

```
 public void testConnectCloseWithSocket() {
    long tCumulative = 0;
    int errAt = -1;
    System.out.println("start...");
    for (int i = 0; i < 4000; i++) {
        try {
            errAt = i;
            DatagramSocket result = new DatagramSocket(null);
            result.bind(new InetSocketAddress(InetAddress.getLocalHost(), 9005));
            result.close();

            //success at last
            tCumulative = 0;

        } catch (Exception e) {
            System.out.println("Error (at="+errAt+") (waited="+tCumulative+"ms): " + e.getMessage());

            tCumulative+=50;
            try {
                Thread.sleep(50);
            } catch (InterruptedException e1) {

            }
            i--;
        }
    }
    System.out.println("end...");

} 
```

* * *

## 结果插座<

开始...错误（at=1319）（等待=0ms）：地址已在使用中：无法绑定

错误（at=1438）（等待=0ms）：地址已在使用中：无法绑定

错误（at=1587）（等待=0ms）：地址已在使用中：无法绑定

错误（at=1740）（等待=0ms）：地址已在使用中：无法绑定

结尾...

* * *

我确实遇到了一些错误，但是套接字正确关闭了……这对我的需要来说是可以的

## 使用频道测试

```
 public void testConnectCloseWithChannel() {
    long tCumulative = 0;
    int errAt = -1;
    System.out.println("start...");
    for (int i = 0; i < 4000; i++) {
        try {
            errAt = i;
            Selector selector = Selector.open();
            DatagramChannel channel = DatagramChannel.open();
            channel.configureBlocking(true);
            channel.socket().bind(new InetSocketAddress(InetAddress.getLocalHost(), 9005));
            SelectionKey clientKey = channel.register(selector, SelectionKey.OP_READ);
            clientKey.cancel();
            channel.close();

            //success at last
            tCumulative = 0;

        } catch (Exception e) {
            System.out.println("Error (at="+errAt+") (waited="+tCumulative+"ms): " + e.getMessage());

            tCumulative+=50;
            try {
                Thread.sleep(tCumulative);
            } catch (InterruptedException e1) {

            }
            i--;
        }
    }
    System.out.println("end...");

} 
```

注意：如果 channel.register 被评论测试工作..

* * *

## 结果与频道

开始... 错误 (at=0) (waited=0ms): null 错误 (at=0) (waited=50ms): 地址已在使用中：绑定

错误（at=0）（等待=100ms）：地址已在使用：绑定

错误（at=0）（等待=150ms）：地址已在使用中：绑定...

* * *

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:14:16.327

> 我确实遇到了一些错误，但是套接字正确关闭了……这对我的需要来说是可以的

不，如果您遇到错误，您的频道未正确关闭。

你必须在你的块`close`的`finally`子句中做。`try`

```
Selector selector = Selector.open();
try
{
  DatagramChannel channel = DatagramChannel.open();

  try
  {
    channel.configureBlocking(true);
    channel.socket().bind(
      new InetSocketAddress(InetAddress.getLocalHost(), 9005)
    );
    SelectionKey clientKey = channel.register(selector, SelectionKey.OP_READ);
    clientKey.cancel();
  }
  finally
  {
    channel.close();
  }
}
finally
{
  selector.close( )
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T21:17:21.460

如果通道已使用 Selector 注册，则通道关闭的某些部分将推迟到下一个 select()。它记录在 Selector、AbstractSelector、SelectorSpi、SelectableChannel、AbstractSelectableChannel 的森林中的某个地方，当我需要它时，我永远找不到它。如果您在关闭通道时处于选择循环和线程中，则可以通过调用 selectNow() 使其立即生效。

# java - JavaFX 泛化 GridPane 列约束

> ID：12977165
> 
> 赞同：5
> 
> 时间：2012-10-19T15:09:00.573
> 
> 标签：java, javafx-2, javafx

有什么方法可以将列约束应用于我的所有 GridPanes 列。我有各种 GridPane 控件，我希望它们共享以下列约束：

```
<ColumnConstraints hgrow="SOMETIMES" maxWidth="388.0" minWidth="74.0" prefWidth="74.0" /> 
```

可以使用css完成吗？

**编辑**

我最终做了这样的事情。但它不起作用（我的列宽被调整到 74 以下），有什么线索吗？

```
public static void resizeColumns(Pane parent){
        for (Node component : parent.getChildren()) {
            if (component instanceof GridPane) {
                GridPane gridPane = (GridPane) component;
                ObservableList<ColumnConstraints> columnConstraints = gridPane.getColumnConstraints();
                for (ColumnConstraints column : columnConstraints) {
                    column.setMinWidth(74.0);
                }
        } else if (component instanceof Pane) {
            resizeColumns((Pane) component);
        } else if (component instanceof ScrollPane) {
            resizeColumns((Pane) ((ScrollPane) component).getContent());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:34:44.610

在您的 java 控制器代码中，遍历列并设置您需要的任何值。

# mysql - 从表名中搜索 MySQL 数据库，其中 column1 或 column2 类似术语

> ID：12977172
> 
> 赞同：0
> 
> 时间：2012-10-19T15:09:17.657
> 
> 标签：mysql

我正在我的数据库中搜索列中的特定名称。

目前我只能搜索一列，我想搜索两列。

这是我目前的声明：

```
$rs = mysql_query('select reg, make, model from Vehicles where reg like "'. mysql_real_escape_string($_REQUEST['term']) .'%" order by reg asc limit 0,10'); 
```

如您所见，我正在搜索车辆的注册表名称，并获得其型号或制造的结果。**我想搜索注册号或品牌**。我试过：

```
$rs = mysql_query('select reg, make, model from Vehicles where reg, make like "'. mysql_real_escape_string($_REQUEST['term']) .'%" order by reg asc limit 0,10'); 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:10:55.017

`OR`如果您有多个条件，请使用。

```
select reg, make, model 
from Vehicles 
where reg like '%value%' OR
      make like '%value%'
order by reg asc 
limit 0,10 
```

# python - 多处理和队列

> ID：12977174
> 
> 赞同：-1
> 
> 时间：2012-10-19T15:09:25.660
> 
> 标签：python, python-multithreading

在对谷歌和 stackoverflow 和其他网站的帖子进行了一些查找之后，我仍然对如何在我的代码上应用队列和线程感到困惑：

```
import psycopg2
import sys
import re
# for threading and queue
import multiprocessing
from multiprocessing import Queue
# for threading and queue
import time
from datetime import datetime

class Database_connection():
    def db_call(self,query,dbHost,dbName,dbUser,dbPass):
        try:
            con = None
            con = psycopg2.connect(host=dbHost,database=dbName,
                                   user=dbUser,password=dbPass)
            cur = con.cursor()
            cur.execute(query)
            data = cur.fetchall()
            resultList = []
            for data_out in data:
                resultList.append(data_out)
            return resultList
        except psycopg2.DatabaseError, e:
                print 'Error %s' % e
                sys.exit(1)
        finally:
            if con:
                con.close()

w = Database_connection()
sql = "select stars from galaxy"

startTime = datetime.now()
for result in  w.db_call(sql, "x", "x", "x", "x"):
    print result[0]
print "Runtime: " + str(datetime.now()-startTime) 
```

假设结果将是 100+ 个值。我如何使用队列和多处理模块将这 100 多个结果放在队列中并执行（例如打印）然后 5 个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:49:59.833

你想让这段代码做什么？

您不会从此代码中获得任何输出，因为`get()`从队列 ( [doc](http://docs.python.org/library/multiprocessing.html#multiprocessing.Queue.get) ) 中返回下一个项目。您将 sql 响应中的字母一次一个字母地放入队列中。`i`in`for i...`循环遍历由 . 返回的列表`w.db_call`。这些项目是（我假设）字符串，然后您将对其进行迭代并一次添加一个到`queue`. 接下来要做的就是从队列中删除刚刚添加到队列中的元素，这会使队列在每次通过循环时保持不变。如果你`print`在循环中放一个语句，它会打印出它刚刚从队列中得到的字母。

`Queue`s 用于在进程之间传递信息。我认为您正在尝试建立一种生产者/消费者模式，其中一个进程将事物添加到队列中，而其他多个进程从队列中消费事物。请参阅[multiprocessing.Queue 的工作示例](https://stackoverflow.com/questions/5082391/working-example-of-multiprocessing-queue)和其中包含的链接（[示例](http://jeetworks.org/node/81)，[主文档](http://docs.python.org/library/multiprocessing.html#module-multiprocessing)）。

只要您不需要它在交互式外壳中运行，可能最简单的方法就是使用（从[文档中](http://docs.python.org/library/multiprocessing.html)`Pool`逐字提取）[`multiprocess`](http://docs.python.org/library/multiprocessing.html)

```
from multiprocessing import Pool
p = Pool(5) # sets the number of worker threads you want
def f(res):
    # put what ever you want to do with each of the query results in here
    return res
result_lst = w.db_call(sql, "x", "x", "x", "x")
proced_results = p.map(f, result_lst) 
```

它将您想要做的任何事情应用于每个结果（写入函数`f`）并将该操作的结果作为列表返回。要使用的子进程数由 的参数设置`Pool`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T19:28:23.640

这是我的建议...

```
import Queue
from threading import Thread

class Database_connection:
    def db_call(self,query,dbHost,dbName,dbUser,dbPass):
        # your code here
        return

# in this example each thread will execute this function
def processFtpAddrMt(queue):
    # loop will continue until queue containing FTP addresses is empty
    while True:
        # get an ftp address, a exception will be called when the
        # queue is empty and the loop will break
        try: ftp_addr = queue.get()
        except: break

        # put code to process the ftp address here

        # let queue know this task is done
        queue.task_done() 

w = Database_connection() 
sql = "select stars from galaxy"
ftp_addresses = w.db_call(sql, "x", "x", "x", "x")

# put each result of the SQL call in a Queue class
ftp_addr_queue = Queue.Queue()
for addr in ftp_addresses:
    ftp_addr_queue.put(addr)

# create five threads where each one will run analyzeFtpResult
# pass the queue to the analyzeFtpResult function
for x in range(0,5):
    t = Thread(target=processFtpAddrMt,args=(ftp_addr_queue,))
    t.setDaemon(True)
    t.start()

# blocks further execution of the script until all queue items have been processed
ftp_addr_queue.join() 
```

它使用 Queue 类来存储您的 SQL 结果，然后使用 Thread 类来处理队列。创建了五个线程类，每个线程类都使用一个 processFtpAddrMt 函数，该函数从队列中获取 ftp 地址，直到队列为空。您所要做的就是添加处理 ftp 地址的代码。希望这可以帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-19T16:54:00.423

我能够通过以下方式解决问题：

```
def worker():
    w = Database_connection()
    sql = "select stars from galaxy"
    for result in  w.db_call(sql, "x", "x", "x", "x"):
        if result:
            jobs = []
            startTime = datetime.now()
            for i in range(1):
               p = multiprocessing.Process(target=worker)
               jobs.append(p)
               p.start()
            print "Runtime: " + str(datetime.now()-startTime) 
```

我相信这不是最好的方法，但现在解决了我的问题:)

# regex - 如何使用 PowerShell 从 SVN 日志输出中修剪文件修改值

> ID：12977175
> 
> 赞同：1
> 
> 时间：2012-10-19T15:09:29.183
> 
> 标签：regex, svn, powershell, string-matching

我在 PowerShell 中捕获了一个 SVN 日志，然后我试图修改并删除除文件 URL 之外的所有内容。我遇到的问题是让正则表达式删除文件 URL 之前的所有内容。我的条目匹配为：

> M /trunk/project/application/myFile.cs

开头有两个空格，最初我试图用正则表达式替换，但似乎不起作用，所以我使用修剪并最终得到：

M /trunk/project/application/myFile.cs

现在我想摆脱文件状态指示器，所以我有一个正则表达式，如：

$entry = $entry.Replace("^[ADMR]\s+","")

其中 $entry 是匹配的文件 URL，但这似乎没有做任何事情，即使删除插入符号以查找值和空间也没有做任何事情。我知道 $entry 是一个字符串，我最初认为 Replace 不起作用，因为 $entry 不是一个字符串，但是在脚本期间运行 Get-Member 表明我有一个字符串类型。svn 文件指示器有什么特别之处吗？或者正则表达式是否以某种方式关闭？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:18:38.283

给定您的示例字符串：

```
$entry = 'M /trunk/project/application/myFile.cs'
$fileURL = ($entry -split ' /')[1] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:28:42.113

您的正则表达式不起作用，因为`string.Replace`只是进行文字字符串替换并且不了解正则表达式。您可能需要`[Regex]::Replace`或只是`-replace`操作员。

但是在将 SVN 与 PowerShell 一起使用时，我总是使用 XML 格式。SVN 允许`--xml`所有命令的选项，然后将输出 XML（尽管如果它在两者之间死亡则无效）。

例如：

```
$x = [xml](svn log -l 3 --verbose --xml)
$x.log.logentry|%{$_.paths}|%{$_.path}|%{$_.'#text'} 
```

会给你所有的路径。

但是如果你需要一个正则表达式：

```
$entry -replace '^.*?\s+' 
```

这将删除直到（包括）第一个空格序列的所有内容，这具有额外的好处，您不需要记住那里可能出现的字符。

# linux - 在不中断的情况下读取生活过程记忆

> ID：12977179
> 
> 赞同：38
> 
> 时间：2012-10-19T15:09:43.443
> 
> 标签：linux, memory

我想探索一个活着的进程的记忆，当我这样做时，这个进程一定不会受到干扰 - 所以将 gdb 附加到进程（这会阻止它）不是一种选择。因此，我想从 /proc/kcore 获取此信息（如果您知道另一种方法，请告诉我）。所以我做了一个小实验。我创建了一个名为 TEST 的文件，里面只有“EXTRATESTEXTRA”。然后我用更少的东西打开它

```
$ less TEST 
```

我得到了这个过程的PID

```
$ ps aux | grep TEST
user    7785  0.0  0.0  17944   992 pts/8    S+   16:15   0:00 less TEST
user    7798  0.0  0.0  13584   904 pts/9    S+   16:16   0:00 grep TEST 
```

然后我用这个脚本创建了所有文件的转储：

```
#!/bin/bash
grep rw-p /proc/$1/maps | sed -n 's/^\([0-9a-f]*\)-\([0-9a-f]*\) .*$/\1 \2/p' | while read start stop; do gdb --batch --pid $1 -ex "dump memory $1-$start-$stop.dump 0x$start 0x$stop"; done 
```

（我在这个网站上找到了它[https://serverfault.com/questions/173999/dump-a-linux-processs-memory-to-file](https://serverfault.com/questions/173999/dump-a-linux-processs-memory-to-file)）

```
$ sudo ./dump_all_pid_memory.sh 7785 
```

在此之后，我在所有转储文件中查找“TRATESTEX”：

```
$ grep -a -o -e '...TRATESTEX...' ./*.dump
./7785-00624000-00628000.dump:HEXTRATESTEXTRA
./7785-00b8f000-00bb0000.dump:EXTRATESTEXTRA
./7785-00b8f000-00bb0000.dump:EXTRATESTEXTRA 
```

所以我得出结论，这个字符串一定会在 0x00624000 和 0x00628000 之间出现。因此，我将偏移量转换为十进制数并使用 dd 从 /proc/kcore 获取内存：

```
$ sudo dd if="/proc/kcore" of="./y.txt" skip="0" count="1638400" bs=1 
```

令我惊讶的是，文件 y.txt 中全是零（我没有在其中找到我要查找的字符串）。

作为一个额外的惊喜，我同时用不同的测试文件运行了一个类似的测试，发现我正在使用的另一个测试字符串（两个进程同时运行）应该在同一个位置（ dump 和 greping 给出了相同的偏移量）。所以肯定有什么我不明白的地方。

*   /proc/pid/maps 不应该显示内存的偏移量（即：如果它说“XXX”位于偏移量 0x10，那么另一个程序不能使用相同的偏移量，对吗？ - 这是我的第二个惊喜的来源）

*   如何读取 /proc/kmap 以获取属于我知道的 pid 进程的内存？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2014-04-11T00:54:03.867

如果您具有 root 访问权限并且在 linux 系统上，则可以使用以下 linux 脚本（改编自[Gilles 出色的 unix.stackexchange.com 答案](https://unix.stackexchange.com/a/6302/3986)和最初在上述问题中给出的答案，但包括 SyntaxErrors 而不是 pythonic）：

```
#!/usr/bin/env python

import re
import sys

def print_memory_of_pid(pid, only_writable=True):
    """ 
    Run as root, take an integer PID and return the contents of memory to STDOUT
    """
    memory_permissions = 'rw' if only_writable else 'r-'
    sys.stderr.write("PID = %d" % pid)
    with open("/proc/%d/maps" % pid, 'r') as maps_file:
        with open("/proc/%d/mem" % pid, 'r', 0) as mem_file:
            for line in maps_file.readlines():  # for each mapped region
                m = re.match(r'([0-9A-Fa-f]+)-([0-9A-Fa-f]+) ([-r][-w])', line)
                if m.group(3) == memory_permissions: 
                    sys.stderr.write("\nOK : \n" + line+"\n")
                    start = int(m.group(1), 16)
                    if start > 0xFFFFFFFFFFFF:
                        continue
                    end = int(m.group(2), 16)
                    sys.stderr.write( "start = " + str(start) + "\n")
                    mem_file.seek(start)  # seek to region start
                    chunk = mem_file.read(end - start)  # read region contents
                    print chunk,  # dump contents to standard output
                else:
                    sys.stderr.write("\nPASS : \n" + line+"\n")

if __name__ == '__main__': # Execute this code when run from the commandline.
    try:
        assert len(sys.argv) == 2, "Provide exactly 1 PID (process ID)"
        pid = int(sys.argv[1])
        print_memory_of_pid(pid)
    except (AssertionError, ValueError) as e:
        print "Please provide 1 PID as a commandline argument."
        print "You entered: %s" % ' '.join(sys.argv)
        raise e 
```

如果你将它保存为 write_mem.py，你可以运行它（使用 python2.6 或 2.7）或在 python2.5 早期（如果你添加`from __future__ import with_statement`）：

```
sudo python write_mem.py 1234 > pid1234_memory_dump 
```

将 pid1234 内存转储到文件 pid1234_memory_dump。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-10-19T19:10:05.673

对于进程 1234，您可以通过顺序读取`/proc/1234/maps`（文本伪文件）来获取其内存映射，并通过例如[read(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/read.2.html) -ing 或[mmap(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html)`/proc/1234/mem` -ing稀疏伪文件的适当段来读取虚拟内存。

但是，我相信您无法避免某种同步（可能与[ptrace(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/ptrace.2.html)一样`gdb`），因为进程 1234 可以（并且确实）随时更改其地址空间（使用`mmap`& 相关的系统调用）。

如果受监视进程 1234 不是任意的，但如果您可以改进它以以某种方式与监视进程通信，则情况会有所不同。

我不确定你为什么要问这个。并且`gdb`能够在`watch`不停止进程的情况下到达某个位置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-07-27T09:44:17.650

自3.2版内核。您可以使用[process_vm_readv](http://man7.org/linux/man-pages/man2/process_vm_readv.2.html)系统调用来读取进程内存而不会中断。

> ```
> ssize_t process_vm_readv(pid_t pid,
>                                 const struct iovec *local_iov,
>                                 unsigned long liovcnt,
>                                 const struct iovec *remote_iov,
>                                 unsigned long riovcnt,
>                                 unsigned long flags); 
> ```
> 
> 这些系统调用在调用进程（“本地进程”）的地址空间和由 pid 标识的进程（“远程进程”）之间传输数据。数据直接在两个进程的地址空间之间移动，不经过内核空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T17:20:14.213

您必须使用来读取进程内存。我不建议尝试读取或任何内核内存功能（这很耗时）。`/proc/*pid*/mem``/proc/kcore`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-19T10:17:31.523

如果只想获取全局变量或者指定地址的值，可以使用我的工具[gvardump](https://github.com/oufm/gvardump)，而不是读取整个内存。gvardump 将解析变量地址并很好地打印其值，而不会导致进程中断。

例如：

```
root@ubuntu:/home/u/trace_test# ./gvardump.py 53670 -a 1 '*g_ss[0].sss[0].ps'
*((g_ss[0]).sss[0]).ps = {
    .a = 6,
    .sss = {
        {
            .bbb = 0,
            .ps = 0x563ca42a2020,
            .bs = {
                .m = 0,
            },
        },
        // other 9 elements are omit
    },
    ... 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2017-03-09T08:15:20.617

我通过发出以下命令实现了这一点

[root@stage1 ~]# echo "PID [MySql] 的内存使用情况："; {Private,Rss,Shared,Swap,Pss} 中的内存；执行 grep $mem /proc/ `ps aux |grep mysql |awk '{print $2}'|head -n 1`/smaps | awk -v mem_type="$mem" '{i=i+$2} END {打印 mem_type,"内存使用情况:"i}' ;完成

**结果输出**

PID [MySql] 的内存使用情况：

私有内存使用量：204

Rss 内存使用量：1264

共享内存使用量：1060

交换内存使用：0

pss内存使用量：423

# php - PHP表单验证，错误信息输出

> ID：12977183
> 
> 赞同：1
> 
> 时间：2012-10-19T15:09:48.807
> 
> 标签：php, validation

任何比我更有经验的人都可以看看这个页面并找出为什么 php 验证不起作用。这是我第一次用 PHP 编程，我通过 PHP lint 运行它，代码中没有致命错误，只需要在用户尝试提交表单时获取错误消息输出。JS 验证工作正常，红色错误消息是 jQuery 验证，所以最好关闭 JS。

谢谢

[http://www.cambrianvacation.co.uk/vpc/register1.php](http://www.cambrianvacation.co.uk/vpc/register1.php)

编辑这里的代码

```
//form processing
//import form info
//run this code when page submits test with js turned off
 if (isset($_POST["submit"])) {
$email = $_POST['email'];
$password = $_POST['password'];
$confirm_password = $_POST['confirm_password'];
$myArray = $errors();
function validate_firstname(){
//validate here, 
if(!isset($_POST['firstname'])){
     $errors = print 'Please enter your firstname';
    }
else if(strlen($_POST['firstname']) <=2){
     $errors = print 'Your firstname must be more than 2 characters';
}else{//data is fine send to encryption

    return $_POST['firstname'];
};
};

function validate_lastname(){
//validate here
if(!isset($_POST['lastname'])){
     $errors = print 'Please enter your lastname';
    }
else if(strlen($_POST['lastname']) <=2){
     $errors = print 'Your lastname must be more than 2 characters';
}else{//data is fine send to encryption

    return $_POST['lastname'];
};
};
function validate_username(){
//validate here
if(!isset($_POST['username'])){
     $errors = print 'Please enter your username';
    }
else if(strlen($_POST['username']) <=2){
     $errors = print 'Your username must be more than 2 characters';
}else{//data is fine send to encryption

    return $_POST['username'];
};
};      

  function is_valid_email_address($email){
    $qtext = '[^\\x0d\\x22\\xSc\\x80-\\xff]';
    $dtext = '[^\\x0d\\x5b-\\x5d\\x80-\\xff]';
    $atom = '[^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c' .
    '\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+';
    $quoted_pair = '\\x5c[\\x00-\\x7f]';
    $domain_literal = "\\x5b($dtext|$quoted_pair)*\\x5d";
    $quoted_string = "\\x22($qtext|$quoted_pair)*\\x22";
    $domain_ref = $atom;
    $sub_domain = "($domain_ref|$domain_literal)";
    $word = "($atom|$quoted_string)";
    $domain = "$sub_domain(\\x2e$word)*";
    $local_part = "$word(\\x2e$word)*";
    $addr_spec = "$local_part\\x40$domain";
    return preg_match("!^$addr_spec$!", $email)? 1 : 0;
  };
  if (is_valid_email_address($email)){
     $errors = print 'Your email is a valid email address';
  } else{$errors = print 'Please enter a valid email address';
    };

  function validate_password($password){
    if(!isset($password)){
          $errors = print 'Please provide a password';
    }else if(strlen($password) <=5){
        $errors = print 'Your password must be at least 25 charachters long';
    }   
    else{return $password;}
};

    function confirm_password($confirm_password){

        if ($password !== $confirm_password){
             $errors = print 'Please enter the same password as above';
        }else{ $password === $confirm_password;}
            return $confirm_password;
        };
    };
 ?>

<div id="bigwrap">
        <div id = "space"></div>
    <div class="wrapper">

        <div class="content">
            <div id="form_wrapper" class="form_wrapper">

                <form class="register active" class="cmxform" action= "regprocess.php"           id="signupForm" class = "ajaxsubmit" method="get">
                    <fieldset class="ui-widget ui-widget-content ui-corner-all">
                    <h3 class="font">REGISTER</h3>
                    <div class="column">
                        <div>
                            <label for="cname">Firstname</label>
 <input id="cfirstname" name="firstname" type="text" class="required"   minlength="2" />

                        </div>
                        <div>
                            <label for="cname">Username</label>
 <input id="cusername" name="username" type="text"  class="required"  minlength="5" />

                        </div>
                        <div>
                            <label for="cemail">E-Mail:</label>
        <input id="cemail" name="email" type="text"  class="required email" />

                        </div>
                    </div>
                    <div class="column">
                        <div>
                            <label for="cname">Lastname</label>
 <input id="cname" name="lastname" type="text" class="required" class="ui-state-highlight" minlength="2" />

                        </div>
                        <div>
                            <label for="password">Password:</label>
        <input id="password" name="password" type="password"  class="required"/>

                        </div>
                        <div>
                            <label for="confirm_password">Confirm password:</label>
        <input id="confirm_password" name="confirm_password"   type="password" class="required" />

                        </div>
                    </div>
                    <div class="bottom">
                        <div class="remember">

                        </div>
                        <input type="submit" value="Register" class= "submit"/> 
                        <a href="index.html" rel="login" class="linkform">You have an account already? Log in here</a>

                        <div class="clear"></div>
                    </div>
                    <ul><?php echo $errors; ?></ul>
                </fieldset>
                </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:13:11.497

查看以下功能：

```
error_reporting(E_ALL);
ini_set('display_errors', TRUE);
ini_set('log_errors', TRUE);
ini_set('display_startup_errors', TRUE); 
```

这些将覆盖您的错误报告配置。确保在生产时将其删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T21:25:26.170

```
//form processing
//import form info
//run this code when page submits test with js turned off
if (isset($_POST["submit"])) {
   $firstname = $_POST['firstname'];
$email = $_POST['email'];
$password = $_POST['password'];
$confirm_password = $_POST['confirm_password'];
 // $errors = array();
function validate_firstname(){
//validate here, 
 global $firstname;
 if(!isset($firstname)){

    //global $errors;
    //return  $errors;
    global $error_message1;
     $error_message1 = print 'Please enter your firstname';
    }
else if(strlen($firstname) <=2){
    //return $errors;
    global $error_message2;
     $error_message2 = print 'Your firstname must be more than 2 characters';
}else{//data is fine send to encryption

    return $firstname;
};
 };

function validate_lastname(){
//validate here
if(!isset($_POST['lastname'])){
     $errors = print 'Please enter your lastname';
    }
else if(strlen($_POST['lastname']) <=2){
     $errors = print 'Your lastname must be more than 2 characters';
}else{//data is fine send to encryption

    return $_POST['lastname'];
};
 };
function validate_username(){
//validate here
if(!isset($_POST['username'])){
     $errors = print 'Please enter your username';
    }
else if(strlen($_POST['username']) <=2){
     $errors = print 'Your username must be more than 2 characters';
}else{//data is fine send to encryption

    return $_POST['username'];
};
 };      

function is_valid_email_address($email){
    $qtext = '[^\\x0d\\x22\\xSc\\x80-\\xff]';
    $dtext = '[^\\x0d\\x5b-\\x5d\\x80-\\xff]';
    $atom = '[^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c' .
    '\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+';
    $quoted_pair = '\\x5c[\\x00-\\x7f]';
    $domain_literal = "\\x5b($dtext|$quoted_pair)*\\x5d";
    $quoted_string = "\\x22($qtext|$quoted_pair)*\\x22";
    $domain_ref = $atom;
    $sub_domain = "($domain_ref|$domain_literal)";
    $word = "($atom|$quoted_string)";
    $domain = "$sub_domain(\\x2e$word)*";
    $local_part = "$word(\\x2e$word)*";
    $addr_spec = "$local_part\\x40$domain";
    return preg_match("!^$addr_spec$!", $email)? 1 : 0;
};
if (is_valid_email_address($email)){
     $errors = print 'Your email is a valid email address';
} else{$errors = print 'Please enter a valid email address';
    };

function validate_password($password){
    if(!isset($password)){
          $errors = print 'Please provide a password';
    }else if(strlen($password) <=5){
        $errors = print 'Your password must be at least 25 charachters long';
    }   
    else{return $password;}
};

    function confirm_password($confirm_password){

        if ($password !== $confirm_password){
             $errors = print 'Please enter the same password as above';
        }else{ $password === $confirm_password;}
            return $confirm_password;
        };
    };
  ?>

 <div id="bigwrap">
        <div id = "space"></div>
    <div class="wrapper">

        <div class="content">
            <div id="form_wrapper" class="form_wrapper">

                <form class="register active" class="cmxform" action= "regprocess.php"  id="signupForm" class = "ajaxsubmit" method="post">
                    <fieldset class="ui-widget ui-widget-content ui-corner-all">
                    <h3 class="font">REGISTER</h3>
                    <div class="column">
                        <div>
                            <label for="cname">Firstname</label>
 <input id="cfirstname" name="firstname" type="text" class="required" minlength="2" />

                        </div>
                        <div>
                            <label for="cname">Username</label>
 <input id="cusername" name="username" type="text"  class="required"  minlength="5" />

                        </div>
                        <div>
                            <label for="cemail">E-Mail:</label>
        <input id="cemail" name="email" type="text"  class="required email" />

                        </div>
                    </div>
                    <div class="column">
                        <div>
                            <label for="cname">Lastname</label>
 <input id="cname" name="lastname" type="text" class="required" class="ui-state-highlight" minlength="2" />

                        </div>
                        <div>
                            <label for="password">Password:</label>
        <input id="password" name="password" type="password"  class="required"/>

                        </div>
                        <div>
                            <label for="confirm_password">Confirm password:</label>
        <input id="confirm_password" name="confirm_password"   type="password" class="required" />

                        </div>
                    </div>
                    <div class="bottom">
                        <div class="remember">

                        </div>
                        <input type="submit" value="Register" class= "submit"/> 
                        <a href="index.html" rel="login" class="linkform">You have an account already? Log in here</a>

                        <div class="clear"></div>
                    </div>
                    <ul><?php $output =  validate_firstname(); echo "$output"; ?></ul>
                </fieldset>
                </form> 
```

# objective-c - UILables、文本流和布局

> ID：12977185
> 
> 赞同：1
> 
> 时间：2012-10-19T15:09:54.027
> 
> 标签：objective-c, ios, uilabel, uitextview, core-text

考虑以下情况，我将段落数据发送到需要放置在背景图像上的视图，该背景图像在顶部和底部具有固定元素（图 1）

图。1。![UIView 显示文本流和固定元素](../Images/456c6d224c195bac76650382b8862c77.png)

我的想法是将其拆分为 4 个标签（图 1.example2），我的问题是如何让文本在标签 1-4 中流动，因为标签 1,2 和 3 ar 的高度是固定的。我在这里假设标签 3 应该在 4 之前填充，因此在附图中的布局。

有人可以举个例子来建议最好的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:55:30.620

希望我能提供更多帮助，但我想我至少可以为您指明正确的方向。

首先，您的想法似乎很有可能，但会涉及大量的文本大小计算，这会很丑陋并且可能不会产生理想的结果。我认为它的工作方式是使用 sizeWithFont: 对字符串的测试部分进行二进制搜索：直到您可以对标签适合该大小的内容进行最佳猜测并且仍然看起来“正确”。然后你必须实际分解字符串并分段跟踪它......似乎是错误的。

在 iOS 6 中（不幸的是，现在不适用于您，但我会将其发布为对其他人的潜在好处），您可能可以使用一个 UILabel 和一个 NSAttributed 字符串。这里有几个选项可供选择，（我还没有这样做，所以我不确定哪个是最好的）但似乎如果你可以用 html 格式化页面，你可以初始化属性字符串那样。

来自文档：您可以使用初始化方法 initWithHTML:documentAttributes: 和 initWithHTML:baseURL:documentAttributes: 从 HTML 数据创建属性字符串。这些方法返回由 HTML 定义的文本属性作为字符串的属性。它们通过引用 NSDictionary 对象返回由 HTML 定义的文档级属性，例如纸张和边距大小，如“RTF 文件和属性字符串”中所述。这些方法尽可能地将 HTML 转换为 Cocoa 文本系统的结构，但 Application Kit 不提供对任意 HTML 的完整、真实的呈现。

这里的另一种选择是根据图像大小仅使用可用属性、设置行缩进等。我没有在这个级别使用属性字符串，所以我最好的参考是开发人员视频和 NSAttributedString 的编程指南。[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/AttributedStrings/AttributedStrings.html#//apple_ref/doc/uid/10000036-BBCCGDBG](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/AttributedStrings/AttributedStrings.html#//apple_ref/doc/uid/10000036-BBCCGDBG)

对于较低版本的 iOS，您最好熟悉 CoreText。最后，您将获得更好看的结果、可重用性/灵活性，不胜枚举。为此，我将从 CoreText 编程指南开始：[https ://developer.apple.com/library/mac/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Introduction/Introduction.html](https://developer.apple.com/library/mac/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Introduction/Introduction.html)

也许其他人可以提供一些示例代码，但我认为仅查看文档会比尝试计算 4 个这样的标签更让您头疼。

编辑：我更改了 CoreText 的链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:44:34.797

你必须使用 CoreText：用它创建你的 AttributedString 和一个 CTFramesetter。

然后，您可以获得每个文本框的 CTFrame 并在图形上下文中绘制它。

[https://developer.apple.com/library/mac/#documentation/Carbon/Reference/CTFramesetterRef/Reference/reference.html#//apple_ref/doc/uid/TP40005105](https://developer.apple.com/library/mac/#documentation/Carbon/Reference/CTFramesetterRef/Reference/reference.html#//apple_ref/doc/uid/TP40005105)

您还可以使用 UIWebView

# c# - 启动相机意图后 SetContentView () 上的 NullReferenceException

> ID：12977186
> 
> 赞同：1
> 
> 时间：2012-10-19T15:09:55.267
> 
> 标签：c#, android, xamarin.android, nullreferenceexception

我只在 HTC 设备上遇到了非常奇怪的行为。我的应用程序在除 HTC 设备之外的所有其他设备上 100% 运行。

问题发生在我启动相机意图之后，我弹回以前的布局，然后尝试导航回启动相机意图的活动。我`setContentView()`在`OnCreate()`.

我已经包括了我的`LaunchCameraIntent`和`OnActivityResult()`功能。

有人有想法吗？

我在另一个线程上读到，这可能是从活动启动意图时发生的 HTC 特定问题，并且由于某种原因，垃圾收集器被调用以清除该活动，因此在尝试返回时会导致空引用错误。

这是线程

[http://mono-for-android.1047100.n5.nabble.com/Crash-on-HTC-td5710360.html](http://mono-for-android.1047100.n5.nabble.com/Crash-on-HTC-td5710360.html)

```
protected override void OnCreate (Bundle bundle)
{
   base.OnCreate (bundle);
   this.SetContentView (Resource.Layout.PhotoAccidentCarLayout);
}

private void LaunchCameraIntent (int picType)
    {
        Intent intent = new Intent(Android.Provider.MediaStore.ActionImageCapture);
        MDCarPicStatus.PicUri = ContentResolver.Insert (isMounted ? Android.Provider.MediaStore.Images.Media.ExternalContentUri : Android.Provider.MediaStore.Images.Media.InternalContentUri, new ContentValues ());
        intent.PutExtra (Android.Provider.MediaStore.ExtraOutput, MDCarPicStatus.PicUri);
        intent.PutExtra ("isCamera", true);
        MDCameraHelper.isCamera = true;
        StartActivityForResult (intent, picType);
    }

protected override void OnActivityResult (int requestCode, Result resultCode, Intent data)
    {

        if ((resultCode == Result.Ok)) {
            if (data == null) {
                SaveImage (MDCarPicStatus.PicUri, (PhotoType)requestCode);
            } else {
                if (data.Data == null) {
                    SaveImage (MDCarPicStatus.PicUri, (PhotoType)requestCode);
                } else {
                    SaveImage (data.Data, (PhotoType)requestCode);
                }
            }
        }

        base.OnActivityResult (requestCode, resultCode, data);

    } 
```

这是我的堆栈跟踪

```
System.NullReferenceException: Object reference not set to an instance of an object
  at (wrapper delegate-invoke) <Module>.invoke_void__this___intptr_intptr_intptr_intptr_JValue[] (intptr,intptr,intptr,intptr,Android.Runtime.JValue[]) <IL 0x00062, 0x00153>
  at Android.Runtime.JNIEnv.CallNonvirtualVoidMethod (intptr,intptr,intptr,Android.Runtime.JValue[]) [0x00000] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.2.6-branch/632e6ddf/source/monodroid/src/Mono.Android/src/Runtime/JNIEnv.g.cs:612
  at Android.App.Activity.SetContentView (int) [0x0006b] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.2.6-branch/632e6ddf/source/monodroid/src/Mono.Android/platforms/android-8/src/generated/Android.App.Activity.cs:3119
  at CCIC.MD.PhotoAccidentCarActivity.OnCreate (Android.OS.Bundle) [0x00009] in c:\Work\Sepia\Source\mobipro02.exordia.co.za\CCIC\trunk\CCIC.MD\CCIC.MD\Activities\Claim\PhotoAccidentCarActivity.cs:41
  at Android.App.Activity.n_OnCreate_Landroid_os_Bundle_ (intptr,intptr,intptr) [0x00010] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.2.6-branch/632e6ddf/source/monodroid/src/Mono.Android/platforms/android-8/src/generated/Android.App.Activity.cs:1490
  at (wrapper dynamic-method) object.2b7db9d6-0abc-4175-b134-cda100e112d6 (intptr,intptr,intptr) <IL 0x00012, 0x00033> 
```

有人知道吗？谢谢你。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout     xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/SecondaryAndroidBackgroundNoLogo"
    android:minWidth="25px"
    android:minHeight="25px">
  <LinearLayout
      android:orientation="vertical"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
  android:id="@+id/linearLayout1"
  android:minWidth="25px"
  android:minHeight="25px">
<RelativeLayout
    android:minWidth="25px"
    android:minHeight="25px"
    android:id="@+id/relativeLayout1"
    android:layout_height="match_parent"
    android:layout_width="match_parent">
  <TableLayout
      android:minWidth="25px"
      android:minHeight="25px"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:id="@+id/tableLayout2"
      android:layout_centerInParent="true">
    <TableRow
        android:id="@+id/tableRow2">
      <TableLayout
          android:minWidth="25px"
          android:minHeight="25px"
          android:layout_column="0"
          android:id="@+id/tableLayout3">
        <TableRow
            android:id="@+id/tableRow5"
             android:layout_gravity="center"
            android:minWidth="25px"
            android:minHeight="25px">
          <TextView
              android:text="Front Left"
              android:textAppearance="?android:attr/textAppearanceSmall"
               android:layout_gravity="center"
              android:layout_column="0"
              android:id="@+id/textView44"
              android:textColor="#ff003508" />
        </TableRow>
        <TableRow
            android:id="@+id/tableRow6"
            android:minWidth="25px"
            android:minHeight="25px">

          <ImageView
              android:id="@+id/btnFrontLeftCamera"
              android:layout_width="fill_parent"
              android:layout_height="50sp"
              android:scaleType="fitCenter"
              android:src="@drawable/AndroidCameraImage" />

        </TableRow>
      </TableLayout>
      <TableLayout
          android:minWidth="25px"
          android:minHeight="25px"
          android:layout_column="2"
          android:id="@+id/tableLayout4">
        <TableRow
            android:id="@+id/tableRow7"
             android:layout_gravity="center"
            android:minWidth="25px"
            android:minHeight="25px">
          <TextView
              android:text="Front Right"
               android:layout_gravity="center"
              android:textAppearance="?android:attr/textAppearanceSmall"
              android:layout_column="0"
              android:id="@+id/textView44"
              android:textColor="#ff003508" />
        </TableRow>
        <TableRow
            android:id="@+id/tableRow8"
            android:minWidth="25px"
            android:minHeight="25px">

          <ImageView
              android:id="@+id/btnFrontRightCamera"
              android:layout_width="fill_parent"
              android:layout_height="50sp"
              android:scaleType="center"
              android:src="@drawable/AndroidCameraImage" />

        </TableRow>
      </TableLayout>
    </TableRow>
    <TableRow
        android:id="@+id/tableRow3">
      <TableLayout
          android:minWidth="25px"
          android:minHeight="25px"
          android:layout_column="0"
          android:id="@+id/tableLayout6"
          android:layout_gravity="center">
        <TableRow
            android:id="@+id/tableRow12"
             android:layout_gravity="center"
            android:minWidth="25px"
            android:minHeight="25px">
          <TextView
              android:text="Left Side"
               android:layout_gravity="center"
              android:textAppearance="?android:attr/textAppearanceSmall"
              android:layout_column="0"
              android:id="@+id/textView44"
              android:textColor="#ff003508" />
        </TableRow>
        <TableRow
            android:id="@+id/tableRow13"
            android:minWidth="25px"
            android:minHeight="25px">

          <ImageView
              android:id="@+id/btnLeftSideCamera"
              android:layout_width="fill_parent"
              android:layout_height="50sp"
              android:layout_column="0"
              android:scaleType="center"
              android:src="@drawable/AndroidCameraImage" />

        </TableRow>
      </TableLayout>

      <ImageView
          android:id="@+id/imageView6"
          android:layout_width="100sp"
          android:layout_height="250sp"
          android:layout_column="1"
          android:scaleType="centerInside"
          android:src="@drawable/AndroidCarAlone" />

      <TableLayout
          android:minWidth="25px"
          android:minHeight="25px"
          android:layout_column="2"
          android:id="@+id/tableLayout5"
          android:layout_gravity="center">
        <TableRow
            android:id="@+id/tableRow9"
             android:layout_gravity="center"
            android:minWidth="25px"
            android:minHeight="25px">
          <TextView
              android:text="Right Side"
               android:layout_gravity="center"
              android:textAppearance="?android:attr/textAppearanceSmall"
              android:layout_column="0"
              android:id="@+id/textView44"
              android:textColor="#ff003508" />
        </TableRow>
        <TableRow
            android:id="@+id/tableRow10"
            android:minWidth="25px"
            android:minHeight="25px">

          <ImageView
              android:id="@+id/btnRightSideCamera"
              android:layout_width="fill_parent"
              android:layout_height="50sp"
              android:scaleType="center"
              android:src="@drawable/AndroidCameraImage" />

        </TableRow>
      </TableLayout>
    </TableRow>
    <TableRow
        android:id="@+id/tableRow4">
      <TableLayout
          android:minWidth="25px"
          android:minHeight="25px"
          android:layout_column="0"
          android:id="@+id/tableLayout7">
        <TableRow
            android:id="@+id/tableRow14"
             android:layout_gravity="center"
            android:minWidth="25px"
            android:minHeight="25px">
          <TextView
              android:text="Back Left"
               android:layout_gravity="center"
              android:textAppearance="?android:attr/textAppearanceSmall"
              android:layout_column="0"
              android:id="@+id/textView44"
              android:textColor="#ff003a03" />
        </TableRow>
        <TableRow
            android:id="@+id/tableRow15"
            android:minWidth="25px"
            android:minHeight="25px">

          <ImageView
              android:id="@+id/btnBackLeftCamera"
              android:layout_width="fill_parent"
              android:layout_height="50sp"
              android:layout_column="0"
              android:scaleType="center"
              android:src="@drawable/AndroidCameraImage" />

        </TableRow>
      </TableLayout>
      <TableLayout
          android:minWidth="25px"
          android:minHeight="25px"
          android:layout_column="2"
          android:id="@+id/tableLayout8">
        <TableRow
            android:id="@+id/tableRow16"
             android:layout_gravity="center"
            android:minWidth="25px"
            android:minHeight="25px">
          <TextView
              android:text="Back Right"
               android:layout_gravity="center"
              android:textAppearance="?android:attr/textAppearanceSmall"
              android:layout_column="0"
              android:id="@+id/textView44"
              android:textColor="#ff003a03" />
        </TableRow>
        <TableRow
            android:id="@+id/tableRow17"
            android:minWidth="25px"
            android:minHeight="25px">

          <ImageView
              android:id="@+id/btnBackRightCamera"
              android:layout_width="fill_parent"
              android:layout_height="50sp"
              android:scaleType="center"
              android:src="@drawable/AndroidCameraImage" />

        </TableRow>
      </TableLayout>
    </TableRow>
    <LinearLayout
android:orientation="vertical"
android:layout_width="match_parent"
android:layout_height="80sp"
android:id="@+id/linearLayout1"
android:minWidth="25px"
android:minHeight="25px"/>
  </TableLayout>
</RelativeLayout> 
```

# qt - 清洁后的 QMake OBJECTS 问题

> ID：12977188
> 
> 赞同：1
> 
> 时间：2012-10-19T15:09:59.887
> 
> 标签：qt, linker, qmake, object-files

我有一个预编译的目标文件，比如 myObjectFile.o。在我的 .pro 文件中，我有一个这样的代码块：

```
mac {
    ...
    OBJECTS += myObjectFile.o
} 
```

这对于将目标文件与项目的其余部分链接起来非常有用，但是有一个致命的问题。如果我进行清理，则此目标文件将被删除。而且由于它是预编译的，当我尝试再次构建时，我得到一个链接错误，直到我将文件复制回我的项目目录（我实际上在我的 .pro 文件中有一个系统调用来复制文件，所以我只是再次运行 qmake）。

这个问题很烦人，并导致我们的持续集成服务器出现一些问题。基本上，我正在寻找一种方法可以将预编译的目标文件链接到我的代码中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:13:50.860

`LIBS`您可以通过在而不是添加目标文件来做到这一点`OBJECTS`：

```
mac {
    ...
    LIBS += myObjectFile.o
} 
```

的内容按`LIBS`原样传递给链接器，这样就可以在其中包含目标文件。

# tfs - Intellij TFS 插件和 TEE 使用不同的工作区

> ID：12977192
> 
> 赞同：4
> 
> 时间：2012-10-19T15:10:06.203
> 
> 标签：tfs, intellij-idea, osx-mountain-lion, team-explorer-everywhere

我正在尝试将 Intellij 内置的 TFS 插件工作区与[TEE](http://msdn.microsoft.com/en-us/library/gg413282%28v=vs.100%29.aspx)在 OSX Mountain Lion 上的命令行“tf”命令使用的工作区同步，但失败得很惨。

[这个问题](https://stackoverflow.com/questions/12589869/appcode-workspaces-and-tfs-command-line-client-tool)似乎与我的非常相似，但是它没有提到当每个工具报告的计算机名称不同时应该做什么。

Intellij 说我的计算机名是完全限定的域名（例如：hostname.domain.com），而“tf workspaces”命令报告计算机名只是主机名（例如：主机名）。因此，他们无法使用相同的工作空间。我知道您可以更改工作区的计算机名称，但我想同时使用两者，因为我们在本地使用 'tf' 命令有一些 ant 任务。我们组中的 Windows 用户能够很好地做到这一点。

有没有办法让这些工具为计算机名称报告相同的内容？我相信我可以使用“tf workspaces”命令并使我能够在同一个工作区中同时使用两者。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T17:39:04.350

它不受支持（根据负责的开发人员）。请[提交一个请求](http://youtrack.jetbrains.net/issues/IDEA)，我们会看看可以做些什么来使它工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:40:32.307

Team Explorer Everywhere 允许您使用`computerName`系统属性覆盖本地主机名。您可以编辑您的`tf`启动器脚本以匹配 IntelliJ 使用的内容。您可以将文件的最后几行更改为：

```
exec java -Xmx512M -classpath "$CLC_CLASSPATH" \
    -DcomputerName=`hostname -f` \
    "-Dcom.microsoft.tfs.jni.native.base-directory=$BASE_DIRECTORY/native" \
    $RANDOM_DEVICE_PROPERTY com.microsoft.tfs.client.clc.vc.Main "$@" 
```

如果`hostname -f`实际上没有报告 IntelliJ 正在确定的相同主机名，当然，您可以简单地对其进行硬编码。

# php - 移动文件时出错

> ID：12977193
> 
> 赞同：0
> 
> 时间：2012-10-19T15:10:08.107
> 
> 标签：php, html

我有一个 HTML Web 表单，用户可以在其中上传多个文件。我在移动文件时遇到了麻烦。

HTML：

我的 HTML：

```
<form enctype="multipart/form-data" method="post" action="save.php">
    <input type="hidden" name="MAX_FILE_SIZE" value="500000"/>
    <input type="file" name="uploads[]" multiple="multiple" />
    <input type="submit" name="submit" value="submit"/>
 </form> 
```

保存.php：

```
<?php
    foreach ($_FILES['uploads']['name'] as $file) {
    $target= UPLOADPATH . $file;
    move_uploaded_file($file, $target)
        or die('error with moving the file');
    $file= time() . $_FILES['uploads']['name'];
            echo $file;
} 
```

我可能做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:11:41.633

您必须使用`$_FILES['uploads']['tmp_name']`而不是`$_FILES['uploads']['name']`移动文件。`name`是原始文件名，但是`tmp_name`是当前上传的文件路径。

# android - ACRA 显示通知，然后单击通知时没有对话框

> ID：12977199
> 
> 赞同：0
> 
> 时间：2012-10-19T15:10:24.940
> 
> 标签：android, acra

我在 ACRA 的静音模式下工作了很长时间。一切都很好，这是一个很棒的库。

但是今天，我只是想为客户使用通知方法。

我这样使用它：

在我的应用程序中

```
@ReportsCrashes(formKey = "****",
mode = ReportingInteractionMode.NOTIFICATION,
resToastText = R.string.crash_toast_text, // optional, displayed as soon as the crash occurs, before collecting data which can take a few seconds
resNotifTickerText = R.string.crash_notif_ticker_text,
resNotifTitle = R.string.crash_notif_title,
resNotifText = R.string.crash_notif_text,
resNotifIcon = android.R.drawable.stat_notify_error, // optional. default is a warning sign
resDialogText = R.string.crash_dialog_text,
resDialogIcon = android.R.drawable.ic_dialog_info, //optional. default is a warning sign
resDialogTitle = R.string.crash_dialog_title, // optional. default is your application name
resDialogCommentPrompt = R.string.crash_dialog_comment_prompt, // optional. when defined, adds a user text field input with this text resource as a label
resDialogOkToast = R.string.crash_dialog_ok_toast // optional. displays a Toast message when the user accepts to send a report.
) 
```

以及 xml 文件中的所有相应字符串。

在我的活动中，我让它像这样崩溃：

```
String i=null;
i.contains("kj"); 
```

以前，日志已正确发送到我的谷歌文档。

但是现在我已经激活了通知，最大的问题是我收到了通知（Android 4.1.2），当我点击它时，什么也没有发生。

Logcat 给了我这个：

```
10-19 17:08:36.599: I/ACRA(12018): READ_LOGS granted! ACRA can include LogCat and DropBox data.
10-19 17:08:36.614: D/ACRA(12018): Retrieving logcat output...
10-19 17:08:36.700: D/dalvikvm(12018): GC_CONCURRENT freed 861K, 30% free 6778K/9603K, paused 12ms+3ms, total 33ms
10-19 17:08:36.700: D/dalvikvm(12018): WAIT_FOR_CONCURRENT_GC blocked 14ms
10-19 17:08:36.700: D/ACRA(12018): Writing crash report file 1350659316000.stacktrace.
10-19 17:08:36.732: D/ACRA(12018): About to send status bar notification from #handleException
10-19 17:08:36.732: D/ACRA(12018): Creating Notification for 1350659316000.stacktrace

10-19 17:08:36.763: W/System.err(12018):    at java.lang.Thread.run(Thread.java:856)
10-19 17:08:36.771: D/ACRA(12018): Waiting for Toast + worker...
10-19 17:08:39.786: D/ACRA(12018): Wait for Toast + worker ended. Kill Application ? true 
```

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:14:21.397

霍普斯，我忘记了：

```
<activity android:name="org.acra.CrashReportDialog"
    android:theme="@android:style/Theme.Dialog"
    android:launchMode="singleInstance"
    android:excludeFromRecents="true"
    android:finishOnTaskLaunch="true" /> 
```

现在修复... :-D

# iphone - 找不到存档的 Three20/Three20.h 文件

> ID：12977201
> 
> 赞同：0
> 
> 时间：2012-10-19T15:10:26.700
> 
> 标签：iphone, ios, three20, archive, file-not-found

我正在尝试更新已经具有 Three20 库的应用程序。现在我正在使用 xcode 4.5，每次我尝试制作存档时，我都会收到此错误：

Three20/Three20.h 文件未找到

一开始我无法进行任何类型的构建，但是在构建的标题搜索路径中添加了 $(BUILT_PRODUCTS_DIR)/../three20 和 $(BUILT_PRODUCTS_DIR)/../../three20以及我可以在我的设备中进行构建的目标设置。无论如何，如果我尝试制作存档来发布我的应用程序，则会返回相同的错误。我可以做什么？我已经重新安装了 Three20 的最新版本.... 我必须尝试我在互联网上找到的这个解决方案：

转到 Xcode4 Preferences (Cmd + ,) > Locations > Build Location > 并选择“Place build products in locations specified by targets”</p>

在 xcode 4.5 中，我无法使用此解决方案...也许构建位置菜单已更改，我找不到选项“将构建产品放置在目标指定的位置”...。有人知道我在哪里可以找到此设置吗？

至少有人如何成功地在 Xcode4.5 和 Three20 上制作了存档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T15:54:12.597

我也支持从three20切换，但有时并不是那么简单。

要解决您的问题，您可以尝试使用[CocoaPods](https://github.com/CocoaPods/CocoaPods)。它是一个库依赖工具，可让您添加所需的任何库。几周前有人添加了三个 20 的 pod。

这应该让您使用标准的 xcode 归档过程来构建您的项目。

如果你不想使用 cocoapods，你也可以使用“Build for...”->“Archiving”来构建该应用程序。您可以在相同的“产品”菜单中找到它。它将生成一个 .app 文件，您可以使用该`Application Loader`应用程序提交该文件。

您可以`.app`通过在项目侧边栏中的“产品”文件夹下二次单击目标名称来找到该文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:08:44.020

我做了以下工作以使其适合我：

1.  对于three20静态库，我使用[cocoapods](http://cocoapods.org/?q=three20)将文件包含在主项目中..它刚刚摆脱了three20给我带来的所有麻烦（而且它们很多..）顺便说一句，我尝试用[Nimbus](http://nimbuskit.info/)替换three20 ..但是Nimbus缺少我的项目使用three20的一些功能......所以Nimbus没有帮助。
2.  在所有其他子项目/静态库的构建设置下将跳过安装设置为是，并在构建阶段将复制标头从公共切换到项目
3.  **最重要的是：**在子库下.. 在构建阶段我确保将**复制文件**目标从更改`Absolute path`为`products directory`.

就是这样！

**提示：**要了解导致存档创建存档文件而不是 ipa 的违规文件，请执行以下操作：

1.  选择存档并单击分发按钮。
2.  选择“保存已构建产品”选项。
3.  点击下一步并保存。
4.  在 Finder 中浏览创建的目录。
5.  “libraries”子目录将标识您需要将 Skip Install 设置为 Yes 的库。
6.  在某些情况下，`usr/local/include`将识别您需要从 Public 移动到 Project 的罪魁祸首文件，或者您必须从绝对路径更改为 products 目录的文件。但该目录（即 usr/local/include）因您的子库目录结构而异

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-22T14:15:42.447

Three20好久没更新了，bug很多，搭建这个框架非常难。

你可以试试[nimbus](https://github.com/jverkoey/nimbus)。它来自three20。

## 雨云的背景

> Nimbus 的构建灵感来自 Three20 框架。话虽如此，Nimbus 很难避免 Three20 的一些基本问题。其中：
> 
> 糟糕的文档。意大利面条依赖。患有“厨房水槽”情结。复杂的构建结构。大量难以解决的错误。接近于零的测试覆盖率。对于它的弱点，Three20 确实通过其功能集提供了很多价值。Facebook、LinkedIn、Posterous、Meetup 和 SCVNGR 等公司在应用商店的 100 多个应用中使用了它。
> 
> Nimbus 希望有一天能在逐个功能比较中提供与 Three20 一样多的价值，但同时具有崇高的文档和测试覆盖率的无价优势。

# jquery - 在执行 jQuery 操作之前暂停

> ID：12977206
> 
> 赞同：0
> 
> 时间：2012-10-19T15:10:48.403
> 
> 标签：jquery, delay, pausing-execution

我将 AJAX 表单放入引导模式。表单提交成功后，我想显示一条成功消息，然后隐藏模式。

我先将成功消息设置为 msg，然后将表单替换为消息，最后，我将 modal 隐藏在下面的三行中。

```
var msg = '<div class="alert alert-success" id="' + $(replace_selector).attr('id') + '">Feedback Submitted</div>'
$(replace_selector).replaceWith(msg);
$el_parent.modal('hide'); 
```

如何在第二行和第三行代码之间创建延迟？我尝试了[延迟](http://api.jquery.com/delay/)，但无法使其正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:15:28.030

尝试这个：

```
 $(replace_selector).replaceWith(msg);   
    setTimeout(function(){
        $el_parent.modal('hide');
    }, 3000); 
```

# mysql - MySQL 的嵌入式数据库替代品

> ID：12977208
> 
> 赞同：4
> 
> 时间：2012-10-19T15:10:51.520
> 
> 标签：mysql, postgresql

我们正在尝试寻找 MySQL 的替代品，因为 Oracle 收购了 Sun，现在该产品需要商业许可。我们目前在我们的产品中包含 MySQL 服务器、LIBMYSQL.DLL (C API) 和 JDBC 驱动程序 (JAVA API)。

我们需要研究不需要商业许可的替代方案。我们拥有的选项：

1.  使用旧版本的 MySQL pre-Oracle 收购
2.  PostgreSQL 或 MariaDB 可能是选项
3.  还有其他满足我们上述要求的选择吗？

能给我们您的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:19:11.757

首先，MySQL 现在需要商业许可证的真实性有多大？从[Oracle 页面](http://www.mysql.com/downloads/mysql/)可以看出，除了商业版之外，他们还拥有 GPL 许可的开源版本。

# asp.net-mvc - URL 中的 MVC4 连字符

> ID：12977212
> 
> 赞同：1
> 
> 时间：2012-10-19T15:10:54.737
> 
> 标签：asp.net-mvc

所以我试图在我的 URL 中使用连字符来提高可读性，但到目前为止还没有找到一种方法让它与 mvc4 一起工作。

我将从控制器中的代码开始：

```
public ViewResult Index()
    {
        ViewBag.URL = Functions.fetchURL();
        return View();
    }

    [HttpPost]
    public ActionResult Index(LogonModel model, string returnUrl)
    {
         //omitted to save space

        return View(model);
    }

    public ActionResult Forgot_Login_Info()
    {
        return View();
    }

    [HttpPost]
    public ActionResult Forgot_Login_Info(RetrievePasswordViewModel model)
    {
         //omitted to save space
        return View();

    } 
```

因此，我在“Forgot_Login_Info”中看到的操作名称使用下划线，这也是视图的名称。为了测试，我还手动创建了一个名为“Forgot-Login-Info”的视图

在我的 global.asax.cs 文件中，我只是将这一行用于路由

```
RouteConfig.RegisterRoutes(RouteTable.Routes); 
```

这是 MVC4 新项目的标准路由线，它与“RouteConfig.cs”文件挂钩，在该文件中是我拥有的代码，我在本网站的另一个问题中找到。

```
public class RouteConfig
{
    public class HyphenatedRouteHandler : MvcRouteHandler
    {
        protected override IHttpHandler GetHttpHandler(RequestContext requestContext)
        {
            requestContext.RouteData.Values["controller"] = requestContext.RouteData.Values["controller"].ToString().Replace("-","_");
            requestContext.RouteData.Values["action"] = requestContext.RouteData.Values["action"].ToString().Replace("-", "_");
            return base.GetHttpHandler(requestContext);
        }
    }

    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        );

        routes.Add(
        new Route("{controller}/{action}/{id}",
        new RouteValueDictionary(
            new { controller = "Default", action = "Index", id = UrlParameter.Optional }),
            new HyphenatedRouteHandler())
        );
    }
} 
```

最后这里是“索引”视图的代码，这是我有一个指向“Forgot_Login_Info”的链接的地方。

```
 <div class="centerBlockItem" style="width:450px; text-align:center">
@Html.ActionLink("Forgot Password?", "Forgot-Login-Info")
    @Html.ActionLink("Forgot Password?", "Forgot_Login_Info")
</div> 
```

现在我有两种方式的链接，一种使用下划线，另一种使用连字符。根据我所阅读的有关为此目的找到的代码，两个链接都应打开“Forgot_Login_Info”视图，而不是“Forgot-Login-Info”视图。但是我得到的是第二个链接工作正常，并且操作名称与视图文件名称匹配。但是当我点击第一个链接时，我得到一个 404 错误，因为系统找不到“Forgot-Login-Info”视图文件，即使我已经手动创建了一个具有该名称的文件进行测试。

还有一点需要注意，我的 routeconfig 文件中的代码，在我发现的答案中，我建议我注释掉默认路由代码行，然后离开：

```
routes.Add(
        new Route("{controller}/{action}/{id}",
        new RouteValueDictionary(
            new { controller = "Default", action = "Index", id = UrlParameter.Optional }),
            new HyphenatedRouteHandler())
        ); 
```

我也这样做了，得到了同样的结果。有什么想法让我把事情搞砸了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T16:02:52.437

好的，我知道我做错了什么，我在根 routebundle.cs 文件下列出了这个，但我试图在一个区域内完成这项工作，一旦我将此代码移动到区域注册文件，它就像一个魅力。如果有人需要我的完整代码清单，请询问，我会全部发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T15:56:23.957

当爬虫仍然可以访问控制器的下划线版本，从而复制内容时，这如何帮助 SEO。现在正在为此苦苦挣扎。

# jquery - 用按钮替换输入键

> ID：12977213
> 
> 赞同：2
> 
> 时间：2012-10-19T15:10:59.730
> 
> 标签：jquery

当按下回车键时，我生成了这个图表。我想改用一个简单的按钮：http: [//www.cb-dev.tk/A/](http://www.cb-dev.tk/A/)

这是 init.js 文件：

```
$(function(){
    var input = $('.input'),
        bar = $('.bar'),
        bw = bar.width(),
        percent = bar.find('.percent'),
        ps =  percent.find('span'),
        name = 'rotate';

    input.on('keydown', function(e){
        if (e.keyCode == 13){
            var t = $(this), val = t.val();
            if (val >=0 && val <= 1000){
                var w = 1000-val, pw = (bw*w)/1000,
                    pa = {
                        width: w/10+'%'
                    },
                    cw = (bw-pw)/2,
                    ca = {
                        left: cw
                    }
                ps.animate(pa);                 
            } 
        }
    });
}); 
```

怎么做 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:14:31.310

您可以执行以下操作：

```
var e = jQuery.Event("keydown");
e.which = 13;
$('button.yourbutton').click(function(){
  input.trigger(e); // input is your $('.input')
}); 
```

通过这样做`input.trigger(e)`，您正在“模拟”在该输入上按下回车键。所以基本上你在输入keydown上调用那个回调函数......

如果您希望另一个元素调用该函数，只需绑定其他内容而不是输入，即`$('button').click(...)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:17:38.623

只需将所有代码放入按钮单击事件中，然后摆脱您现在拥有的按键代码

```
$('button.yourbutton').click(function(){
     var input = $('.input'),
     bar = $('.bar'),
     bw = bar.width(),
     percent = bar.find('.percent'),
     ps =  percent.find('span'),
     name = 'rotate';
     var t = input, val = t.val();
        if (val >=0 && val <= 1000){
            var w = 1000-val, pw = (bw*w)/1000,
                pa = {
                    width: w/10+'%'
                },
                cw = (bw-pw)/2,
                ca = {
                    left: cw
                }
            ps.animate(pa);                 
        } 
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:18:03.837

```
$('#button-id').on('click', function(e){
    var t = $('select'), val = t.val();
    if (val >=0 && val <= 1000){
        var w = 1000-val, pw = (bw*w)/1000,
            pa = {
                width: w/10+'%'
            },
            cw = (bw-pw)/2,
            ca = {
                left: cw
            }
        ps.animate(pa);                 
    }
}); 
```

因此，您必须修改按钮的选择器。此外，在您的页面上，您从单个输入中获取数据。您以前可以使用`$(this)`来获取该选择元素，但现在不能，因为`this`单击的是按钮。所以我将代码更改为 use `$('select')`，您可能希望通过向 select 添加一个 id 并将 id 用作选择器来使其更具体。

# sql-server - 为开发人员导出生产数据库

> ID：12977215
> 
> 赞同：0
> 
> 时间：2012-10-19T15:11:05.277
> 
> 标签：sql-server

我们正在开发一个由 SQL Server 支持的 Web 应用程序。只有一个实例，因此在开发机器上创建基线数据库的规范方法是复制生产数据库。

我们将所有待处理的数据库更改保存为 SQL 脚本，因此开发人员可以随时获取生产副本，然后应用所有适用的 SQL 脚本。

生产数据库包含不应在开发机器上的敏感信息。我正在寻找一种导出数据库并以易于导入的格式为开发人员打包的好方法。

我已经用我现在的方式回答了这个问题，但我希望有更好的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:11:05.277

我备份了生产数据库并将其还原到另一台机器上。然后我运行一个脚本来删除所有敏感数据。（如果数据太大而无法进行开发，我也可以在此处修剪数据。）然后我备份此数据库并将文件提供给开发人员。

备份两次似乎效率低下，但我不希望开发人员将敏感数据暂时保存在他们的机器上。

（我相信开发人员不会滥用敏感数据，但如果他们的一台笔记本电脑被盗或以其他方式受到损害，我不想担心潜在的安全漏洞。）

# qt - QMainWindow 析构函数

> ID：12977217
> 
> 赞同：2
> 
> 时间：2012-10-19T15:11:11.570
> 
> 标签：qt, qmainwindow, virtual-destructor

为什么 QMainWindow 的析构函数不是虚拟的？如果我从 QMainWindow 继承一个类 MainWindow 并在其上有一些指针属性，我无法使用 MainWindow 的析构函数删除内存。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T18:07:54.033

QMainWindow 的析构函数是对已经存在的析构函数 ( `QWidget::~QWidget()`) 的覆盖，而后者又是对虚拟析构函数 ( `virtual QObject::~QObject()`) 的覆盖。因此，`QMainWindow::~QMainWindow()`是虚拟的。与普通成员函数相同的规则适用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T15:16:00.107

QObject 的析构函数已被声明为虚拟的。QMainWindow 间接派生自 QObject。我相信 QMainWindow 的破坏在这种情况下不需要虚拟。您在删除派生类时是否在 QMainWindow 的析构函数中设置了断点？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T22:46:57.973

这是 Qt 中的一个缺陷（未能遵守 CBP）；最好的做法是在所有派生类中始终保留修饰符，尤其是虚拟修饰符，以避免此类问题。

不继承虚拟声明意味着，作为用户，我不仅要查找类，还要查找它的所有父类，以确保我要覆盖的方法是否是虚拟的。开发人员的一点懒惰花费了我很多时间。

关于“可维护性”的争论是无关紧要的；它使该类更难使用（用户将比维护者多得多……）

# performance - 提高 Matlab 函数的性能

> ID：12977219
> 
> 赞同：-2
> 
> 时间：2012-10-19T15:11:14.150
> 
> 标签：performance, matlab, math, matrix, vectorization

我想改进我的一个简单的 matlab 函数。有没有任何算术方法来实现这个功能？我认为那会表现得更好。

```
function img_output = cutchannels(img_input, min, max)
[r c l] = size(img_input);
img_output = double(img_input);

for i = 1:r
    for j = 1:c
        for k = 1:l
            if(img_output(i:j:k)> max)
                img_output(i:j:k) = max;
            elseif(img_output(i:j:k) < min)
                img_output(i:j:k) = min;
            end
        end
    end
end
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T15:18:09.543

如果我理解正确，这就是你想要做的

```
function img_output = cutchannels(img_input, min, max)

img_output = double(img_input);
img_output(img_output>max) = max;
img_output(img_output<min) = min;

end 
```

首先，我认为您的索引存在错误：`img_output(i:j:k)`实际上应该读取`img_output(i,j,k)`- 这是索引 3D 数组的方式。

以上是在 MATLAB中使用*逻辑索引的标准方法（*[在此处阅读](http://www.mathworks.se/company/newsletters/articles/Matrix-Indexing-in-MATLAB/matrix.html)）。该声明

```
img_output>max 
```

返回大小等于 的大小的 0/1 数组`img_output`，其中所有`img_output`大于`max`1 的元素。然后您可以将此矩阵用作 中的索引`img_output`

```
img_output(img_output>max) 
```

这仅选择`img_output`逻辑索引等于 1 的条目。然后您可以为它们分配您想要的任何值

```
img_output(img_output>max) = max 
```

或者，作为旁注，对它们进行任何其他操作，例如

```
img_output(img_output>max) = img_output(img_output>max).^2; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:18:06.033

你可以做的更短：

```
function img = cutchannels(img, min_val, max_val)
    img = min( max(double(img),min_val), max_val );
end 
```

这就引出了一个问题，即为什么你想在一个函数中实现它（例如，为什么不在你需要的地方使用这个单行代码？）

作为忠告：`min`和`max`是内置 Matlab 函数的名称。虽然合法，但将它们用作变量名也是一种不好的做法。例如，什么

```
M = max(max, 5) 
```

意思是，什么时候`max`是变量名？您是使用变量作为输入来索引`max`变量还是`max`调用函数？`max`这让您以及 Matlab 的解析器感到困惑。建议：使用其他变量名称，如`minimum`or `maximum`，如上面的函数。

# javascript - 如何将数据库中的图像绑定到javascript中的图像控件

> ID：12977222
> 
> 赞同：0
> 
> 时间：2012-10-19T15:11:17.653
> 
> 标签：javascript, asp.net

我想从javascript绑定图像控件中的图像，图像以图像数据类型格式存储在数据库中。当用户单击“显示信息”按钮时，我想从数据库中检索姓名、年龄、图像、地址并将名称、年龄、地址分配给文本框并通过 javascript 将图像分配给图像控件。

如何做到这一点，handler.ashx 是否有用，我如何从处理程序页面获取姓名、年龄、图像、地址？？如何从javascript将图像绑定到图像控件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:36:52.723

您应该发布您尝试过的内容。当您说使用 javascript 时，您是否正在进行 ajax 调用并检索此信息？您确实需要从 ashx 获取图像以外的其他数据。

如果您有图像 id，则需要制作 ashx 来获取图像。

```
function GetImage(id) {

            document.getElementById("UserImage").src="Handler.ashx?id=" + id;

    } 
```

# java - 如何将 Control-Parm 中的工作流属性传递给 Alfresco 中的 FTL 文件？

> ID：12977225
> 
> 赞同：1
> 
> 时间：2012-10-19T15:11:23.760
> 
> 标签：java, html, xml, alfresco, freemarker

所以对于我的项目，我们有一些 JavaScript 代码作为规则在 Alfresco 存储库中运行。因此，每当新文档进入某个空间时，就会动态创建一个新文件夹，并将该文档移动到该新创建的空间中。此外，每当创建新文件夹时，文档的属性都会像这样更新（期望 caseID 实际上是基于我们数据库中的序列动态生成的值）：

```
//Add caseID as a property of the folder
var props = new Array(1);
props["wf:caseIDNum"] = caseID;
var newAspect = newNewSpaceName.addAspect("wf:caseID",props); 
```

但是，现在我们希望能够在我们的 share-workflow-form-config-.xml 文件中的工作流过程中引用新创建的方面/属性，以便可以将其作为参数传递给我们的控制模板。也就是说，目前我们有：

```
<field id="wf:submitCode" label-id="workflow.field.outcome" set="actions">
                  <control template="/org/alfresco/components/form/controls/workflow/custom-activiti-transitions.ftl"/>
               </field> 
```

但我们想要的是如下所示：

```
<field id="wf:submitCode" label-id="workflow.field.outcome" set="actions">
                  <control template="/org/alfresco/components/form/controls/workflow/custom-activiti-transitions.ftl">
                     <control-param name="caseID">wf:caseIDNum</control-param>
                  </control>
               </field> 
```

所以我的问题是，通过控制参数将变量/属性从工作流模型传递到 FTL 文件的正确语法是否正确？

**编辑 (10/25/12)** -

因此，根据此处提供的帮助，我尝试像这样修改我的 ftl 页面...

**自定义 activiti-transitions.ftl**：

```
<#assign caseID = "">
<#if field.control.params.caseID??>
    <#assign caseID = field.control.params.caseID>
<#else>
    <#assign caseID = null>
</#if>

<style type="text/css">

.button {
border: 1px solid #666;
background: #DCDCDC;
padding: 5px;
color: #333;
text-shadow: 1px 1px #fff;
-moz-border-radius: 5px;
-webkit-border-radius: 5px
border-radius: 5px;
cursor: pointer;
-moz-box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
-webkit-box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
}
a.button:hover {
background: #bbb;
color: #000;
text-shadow: 1px 1px #eee;
}

a.button:active {
position: relative;
top: 1px;
left: 1px;
-moz-box-shadow: none;
-webkit-box-shadow: none;
box-shadow: none;
}

</style>

<a class="button" href="#" onClick="MyWindow=window.open('http://localhost:8080/alfresco/faces/jsp/custom/CodeSelector.jsp?caseID=${caseID}','My Window','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,width=600,height=300'); return false;" style="text-decoration:none" target="_blank"><span>Add Codes</span></a> 
```

在我的**share-workflow-form-config.xml**中，我更改了以下任何实例：

```
<field id="wf:submitCode" label-id="workflow.field.outcome" set="actions">
 <control template="/org/alfresco/components/form/controls/workflow/custom-activiti-transitions.ftl">
 </control>
</field> 
```

到...

```
<field id="wf:submitCode" label-id="workflow.field.outcome" set="actions">
 <control template="/org/alfresco/components/form/controls/workflow/custom-activiti-transitions.ftl">
  <control-param name="caseID">wf:caseIDNum</control-param>
 </control>
</field> 
```

我的问题是，在我指定的**share-workflow-form-config.xml**`control-param`中，我可以让它传入一个硬编码值，如“30”。但是，当我尝试获取工作流属性的值时`wf:caseIDNum`，它会返回参数中的实际字符串，例如：

`http://localhost:8080/alfresco/faces/jsp/custom/CodeSelector.jsp?caseID=wfcaseIDNum`

而不是财产的实际价值，即“30”。

关于我可能做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T21:06:26.153

这完全取决于您如何实现控制模板。方面及其相关属性是一个静态实体，它们不会在文件夹上“创建”，而是“应用”到它。附带说明一下，请注意文件夹的子节点不会自动继承方面。

也就是说，您确实可以指定`wf:caseID`为`caseID`模板的输入参数，而不是在 FTL 中您可以使用

```
field.control.params.caseID 
```

您将需要实现逻辑来检索提供的属性并将其正确呈现在屏幕上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T08:20:48.847

就像 skuro 所说的那样，您没有正确执行此操作。

非常简单，您的配置是正确的，但您的 ftl 缺乏一些逻辑。

为什么你会先检查`<#if field.control.params.caseID??>` 然后不分配它？

它应该是：

```
<#if field.control.params.caseID??>
   <#assign caseID = field.control.params.caseID>
<#else>
   <#assign caseID = 1>
</#if> 
```

不需要上下文或参数或其他东西。

看看默认的，比如`/org/alfresco/components/form/controls/textarea.ftl`

- - - 更新 - - -

那么如何访问此模板中的另一个字段。所以我们有另一个字段“wf:caseIDNum”，我们想要访问那个字段。

您可以使用以下 hacky 机制来获取它

```
${form.fields["prop_" + caseID?replace(":","_")].value} 
```

在 form.fields 中存储了所有当前的表单属性。

顺便说一句，不要忘记显示“wf:caseIDNum”和 hidden.ftl 模板，否则该属性将不会填充到字段对象中；）。

# php - SilverStripe 3 多个 UploadField 问题

> ID：12977231
> 
> 赞同：1
> 
> 时间：2012-10-19T15:11:43.427
> 
> 标签：php, silverstripe

我在 SilverStripe CMS 中遇到了多个 UploadFields 的问题。

上传一堆图像时，它们似乎可以正确上传和预览。但是在保存页面并重新加载和查看前端时，没有图像。预览应该在哪里只是一个空白图像，前端没有 URL 输出。

图片正在上传到 assets 目录，并且数据库中文件的路径是正确的。我现在有点不知所措。

这是我的页面模型中的代码

```
<?php
class Page extends SiteTree {

public static $db = array(
);  

public static $many_many = array(
    'Images' => 'Image'
);  

    public function getCMSFields() {
    $fields = parent::getCMSFields();

    $fields->addFieldsToTab('Root.Main', new UploadField('Images','Images',$this->Images()), 'Content');

    return $fields;
}   

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:40:09.817

它只是您遇到问题的网站的前端吗？您能否在模板文件中显示用于显示图像的代码？

它应该看起来像

```
<% loop $Images %>
    $setSize(150,150) // whatever you want to use here
<% end_loop %> 
```

您不能使用 $Image.whatever，它不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:46:07.760

假设您使用默认主题“简单”，在后端（CMS）创建了“页面”类型的页面，上传了图像并发布了页面。

去 ：

> 根文件夹 -> 主题 -> 简单 -> 模板 -> 布局 -> 打开文件“Page.ss”

类型（上述“Ryan M”提供的解决方案）

```
<% loop $Images %>
    $setSize(150,150)
<% end_loop %> 
```

后

```
<div class="content">$Content</div> 
```

通过在浏览器的地址栏中提供您的页面 URL 转到前端。

# php - PHPUnit 找不到 PHPUnit_Extensions_Story_TestCase。缺少什么包裹？

> ID：12977235
> 
> 赞同：4
> 
> 时间：2012-10-19T15:11:55.410
> 
> 标签：php, phpunit

我安装了所有依赖项的 phpunit：

```
pear install -a phpunit/phpunit 
```

当我使用失败的断言运行测试时，它抱怨找不到 PHPUnit_Extensions_Story_TestCase。

我如何解决它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T18:54:08.170

`pear.phpunit.de/PHPUnit_Story`您可以[在 pear 存储库页面](http://pear.phpunit.de/)和[GitHub 存储库](https://github.com/sebastianbergmann/phpunit-story)中找到您缺少的包。

PS：我通过在谷歌中输入类名找到了这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-25T18:05:31.697

PEAR 安装已被[弃用](https://github.com/sebastianbergmann/phpunit/wiki/End-of-Life-for-PEAR-Installation-Method)，目前最好使用 Composer，这里是 PHPUnit[安装指南](http://phpunit-doc.verber.kh.ua/3.7/en/installation.html)，只是添加了波纹管

```
 "require-dev": {
    "phpunit/phpunit": "4.3.*",
    "phpunit/phpunit-story": "*",
    "phpunit/php-invoker": "*",
    "phpunit/dbunit": ">=1.2",
    "phpunit/phpunit-selenium": ">=1.2",
    "phpunit/phpunit-story": "*"
  } 
```

或更好`sudo composer global require 'phpunit/phpunit=4.3.*'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-19T12:01:32.780

我在 Yii 框架中遇到了同样的错误。

通过以下方式解决了它：

1）使用phpunit.phar安装（[安装PHPUnit](https://phpunit.de/manual/current/en/installation.html)）；

2）手动将[TestCase类](https://github.com/phpunit/phpunit-story/tree/master)添加到“自动加载器” - ../tests/bootstrap.php ：

`if (file_exists(_YII_FRAMEWORK_PATH_.'test/PHPUnit/Extensions/Story/TestCase.php')){ require_once(_YII_FRAMEWORK_PATH_.'test/PHPUnit/Extensions/Story/TestCase.php'); }`

# drupal - 如何在 Drupal 7 中使用基于当前页面的多标题

> ID：12977236
> 
> 赞同：2
> 
> 时间：2012-10-19T15:11:58.903
> 
> 标签：drupal, drupal-7, drupal-modules, drupal-theming

如标题所述，如何使用 Drupal 7 在每个页面上设置不同的标题区域。

*例如：*

*在页面 n1 : Header n1 (图片由DP在主题配置中设置)*

*在另一个页面上：标题不同（理想情况下设置在内容类型或 tpl 文件中）*

如果您知道允许我执行此功能的模块，谢谢！

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T21:40:17.637

在此之前不需要任何模块。您不能只将一个块设置为仅在一个页面上显示，另一个块在另一页上显示，这两个块都应该放在标题区域中。这种方式更加一致，您可以更轻松地更换/调整它

# java - JSF：在特定 URL 上立即执行 bean 而不是 xhtml 文件

> ID：12977243
> 
> 赞同：1
> 
> 时间：2012-10-19T15:12:21.117
> 
> 标签：java, jsf, jsf-2

我正在创建一个激活，在单击注册电子邮件中的 URL 后触发。我想立即执行我的 bean Activate.java，而不是使用 #{validate} 之类的东西创建一个 xhtml 页面。

我不需要任何 xhtml 文件，因为用户将被重定向到登录。实现这一目标的最佳方法是什么？

注意，我使用的是 JSF 2.0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:22:09.493

使用[小服务程序](https://stackoverflow.com/tags/servlets/info)。

```
@WebServlet("/activate")
public class ActivationServlet extends HttpServlet {

   @EJB
   private ActivationService service;

   @Override
   protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
       String key = request.getParameter("key");

       // ...

       response.sendRedirect(request.getContextPath() + "/login.xhtml");
   }

} 
```

这将在您调用时调用`http://localhost:8080/contextpath/activate?key=42`。

您只会尽可能地错过 JSF 验证工具`<f:viewParam>`。如果密钥丢失或无效，您想做什么？

# ios - 自动化不适用于 iOS6

> ID：12977245
> 
> 赞同：0
> 
> 时间：2012-10-19T15:12:30.477
> 
> 标签：ios, interface, rotation, ios6, uiinterfaceorientation

我希望我的 UIViewController 可以自动旋转，但只是它，而不是其他任何 uiviewcontroller。这个 UIViewController 呈现在 UINavigationController 中，它不能自动旋转。此代码适用于 iOS 5 和 4，但不适用于 iOS6。

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
    return (YES);
}

- (BOOL)shouldAutorotate
{
    return (YES);
}

- (NSUInteger)supportedInterfaceOrientations
{
    return (UIInterfaceOrientationMaskAll);
} 
```

谢谢帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T17:35:09.377

你需要继承你的 UINavigationController，在这个子类中实现你上面的旋转方法。只有当您的可旋转视图控制器可见时，您才能有条件地返回 YES/UIInterfaceOrientationMaskAll，如下所示：

shouldAutorotateToInterfaceOrientation：

```
if ([self.navigationController.visibleViewController isKindOfClass:[MyRotatableViewController class]])
 return (YES);
else
 return (toInterfaceOrientation == UIInterfaceOrientationPortrait); 
```

支持的接口方向：

```
if ([self.navigationController.visibleViewController isKindOfClass:[MyRotatableViewController class]])
 return (UIInterfaceOrientationMaskAll);
else
 return (UIInterfaceOrientationPortrait); 
```

但同样你必须在导航控制器中执行此操作，而不是它的子视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:00:23.507

iOS 6 只询问“最根”视图控制器关于旋转的问题。那必须是您的 UINavigationController （实际上是此类的子类，因此您可以在某个地方放置旋转委托方法），因为 UINavigationController 在您的其他控制器下。还要确保它被设置为窗口的根视图控制器。

# postgresql - 更改 PostgreSQL 和 pgAdminIII 中的消息输出

> ID：12977246
> 
> 赞同：4
> 
> 时间：2012-10-19T15:12:31.553
> 
> 标签：postgresql, postgresql-9.1, pgadmin

这是一件小事，但对我来说有点烦人，似乎有一种方法可以配置它。假设我有以下内容：

```
CREATE OR REPLACE FUNCTION baz()
  RETURNS void AS
$BODY$
DECLARE
BEGIN
  RAISE NOTICE 'I also did some work!';
END;
$BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100;

CREATE OR REPLACE FUNCTION bar()
  RETURNS void AS
$BODY$
DECLARE
BEGIN
  RAISE NOTICE 'I did a bunch of work and want you to know about it';
  PERFORM baz();
END;
$BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100;

CREATE OR REPLACE FUNCTION foo()
  RETURNS void AS
$BODY$
DECLARE
BEGIN
  PERFORM bar();
END;
$BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100;

select foo(); 
```

我收到以下输出消息：

```
NOTICE:  I did a bunch of work and want you to know about it
CONTEXT:  SQL statement "SELECT bar()"
PL/pgSQL function "foo" line 4 at PERFORM
NOTICE:  I also did some work!
CONTEXT:  SQL statement "SELECT baz()"
PL/pgSQL function "bar" line 5 at PERFORM
SQL statement "SELECT bar()"
PL/pgSQL function "foo" line 4 at PERFORM
Total query runtime: 31 ms.
1 row retrieved. 
```

我想要（通常）只是看到类似的东西：

```
NOTICE:  I did a bunch of work and want you to know about it
NOTICE:  I also did some work!
Total query runtime: 31 ms.
1 row retrieved. 
```

有没有办法控制/改变这个？同样，这是一件小事，几乎不值得在 Stackoverflow 上提问，但如果你有很多事情要做，它就会开始在输出中引入很多“噪音”，这让我已经超负荷的大脑在试图筛选它时受到伤害. :)

我正在使用 PostgreSQL 9.1.5 和 pgAdminIII 1.16.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:21:56.307

尝试使用`-q`选项连接。q 代表安静，可能是您需要的。

```
psql -q -d foo_db 
```

你也可以试试：

*   `\set verbosity terse`
*   `\set quiet on`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T02:18:33.177

如果您想对消息传递和界面进行更多控制，则可能值得转向真正的脚本语言。`psycopg2`使用 Python或 Perl`DBD::Pg`等工具编写数据库脚本`DBI`非常简单。

`SQL`使用真正的脚本语言不仅可以让您完全控制消息传递，还可以让您控制错误处理，为您提供循环和其他控制结构，并且通常为脚本任务提供比原始模型更好的模型。

# wpf - WPF 使用的默认转换器列表？

> ID：12977247
> 
> 赞同：18
> 
> 时间：2012-10-19T15:12:31.603
> 
> 标签：wpf, converter

在哪里可以找到 WPF 的默认转换器列表？

* * *

在查看 Google 之后，我找不到 WPF 中实际包含的任何详细列表，尤其是 MSDN 文档。只发现：

*   [WPF 是否有一组可用的默认绑定转换器？](https://stackoverflow.com/questions/9560329/does-wpf-have-a-set-of-default-binding-converters-available)
*   上的一些文章`TypeConverter`。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-19T15:26:09.743

在 System.Windows.Control (PresentationFramework.dll)

*   交替转换器
*   BooleanToVisibilityConverter
*   BorderGapMask转换器
*   数据网格长度转换器
*   MenuScrollingVisibilityConverter

在 System.Windows.Documents 中

*   缩放百分比转换器
*   JournalEntryList 转换器

在 Microsoft.Windows.Themes

*   ProgressBarBrushConverter
*   ProgressBarHighlightConverter

在 System.Windows.Navigation 中

*   JournalEntryUnifiedViewConverter

# javascript - jquery ajax 聊天滚动条 chrome

> ID：12977248
> 
> 赞同：0
> 
> 时间：2012-10-19T15:12:32.083
> 
> 标签：javascript, jquery, google-chrome, scrollbar

这个问题与堆栈溢出上发布的许多其他问题非常相似，我发现了一些基于我的代码的解决方案，但对我正在搜索的内容没有帮助，[Overstack](https://stackoverflow.com/questions/4340815/creating-an-ajax-chat-with-advanced-scrolling-features-how)，[yelotofu](http://www.yelotofu.com/2008/10/jquery-how-to-tell-if-youre-scroll-to-bottom/) 和一些类似的帖子...... （这与我几天前发布的另一个问题有关，但我很确定它现在不活跃，因为我得到了答案）。

所以我基本上创建了一个 ajax 聊天应用程序，我希望 div 的滚动条检查它是否在按钮上，如果它显示消息然后滚动。我找到了 3 种主要方法来做到这一点（删除其中一种，因为它的基本原理与其他方法相同）

任何一个：

```
 if($("#chatscreen")[0].scrollHeight - $("#chatscreen").scrollTop() == $("#chatscreen").outerHeight())
    {
    alert("work");
    } 
```

或者

```
$("#chatscreen").scroll(function(){
    if($(this)[0].scrollHeight - $(this).scrollTop() == $(this).outerHeight())
    {
    alert("work");
    }
});​ 
```

我已经在 firefox、internet explorer 和 chrome 上测试了第一个代码，它在 firefox 和 internet explorer 上运行良好，但在 chrome 上却不行。

它们之间唯一真正的区别是`$("#chatscreen").scroll(function(){`，当滚动条被使用时，它基本上会继续执行脚本，并且由于某种原因，这在我尝试使它们无法使用的所有 3 个浏览器的错误时起作用。

所以我一直在努力寻找一个可以在 Firefox、Chrome 和 Internet Explorer 上运行的好选择。

感谢您提供的任何帮助/建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T14:34:56.627

我弄清楚为什么它在 chrome 上不起作用

`$("#chatscreen")[0].scrollHeight - $("#chatscreen").scrollTop() == $("#chatscreen").outerHeight()`

是错误的，仍然不确定为什么当我们添加时它会起作用，`.scroll()`但是上面的等式需要通过在最终结果中添加 -1 来更改以使其起作用。

写在这里是因为有一天它可能会对某人有所帮助......

# multithreading - 从多个 CPU 线程调用 CUDA 内核（使用共享内存）

> ID：12977250
> 
> 赞同：2
> 
> 时间：2012-10-19T15:12:37.657
> 
> 标签：multithreading, cuda, cpu, shared-memory, reduction

我编写了一个 cuda 内核，它使用共享内存来执行归约，以便找到数组中的最小值。这与可以在此处找到的众所周知的示例非常相似：

[https://www.sharcnet.ca/help/index.php/CUDA_tips_and_tricks#Reduction](https://www.sharcnet.ca/help/index.php/CUDA_tips_and_tricks#Reduction)

当我从单个 CPU 线程运行它时，它适用于每个块的任意数量的 CUDA 线程（最多我的设备的最大值：1024）。

当我从一些 (20) 个 CPU 线程运行它时，每个块 (256) 的 CUDA 线程数量足够少，它工作正常。

但是，一旦我用多个 CPU 线程增加 CUDA 线程的数量，一切都会崩溃！

我试图删除我执行归约的内核行（因此仅在数组上保留一些操作，但在 CUDA 线程之间没有任何通信），并且它适用于任何数量的 CPU 线程中每个块的任何数量的 CUDA 线程.

关于我的问题来自哪里的任何想法？任何想法如何解决它？在此先感谢您的帮助！

PS：我使用的是单个 GTX650。

PS2：对不起，如果我的英语水平有点差，那不是我的母语....

# java - 你如何在visio中设置自定义行尾？

> ID：12977254
> 
> 赞同：0
> 
> 时间：2012-10-19T15:12:47.997
> 
> 标签：java, visio, shapes, com4j

我正在编写一个 visio 导出并创建了一个包含自定义行尾的 visio 模板文件。当我尝试使用代码设置它们时，它不起作用。

```
 //Create two shapes
    final IVMaster lApp = stencilObj.masters("Application");
    IVShape shapeFrom = pagObj.drop(lApp, 1, 1);
    IVShape shapeTo = pagObj.drop(lApp, 2, 3);

    //Connect the shapes
    final IVMaster connMaster = stencilObj.masters("Connection");
    IVShape connection = pagObj.drop(connMaster, 2, 3);
    final IVCell gluefrom1 = connection.cells("BeginX");
    final IVCell glueat1 = shapeFrom.cells("PinX");
    gluefrom1.glueTo(glueat1);

    final IVCell gluefrom2 = connection.cells("EndX");
    final IVCell glueat2 = shapeTo.cells("PinX");
    gluefrom2.glueTo(glueat2);

    //Set arrow ending
    connection.cellsU("EndArrow").formulaForceU(new Integer(46).toString()); 
```

所以 visio 中有 45 个默认行尾，列表中的第 46 个是我的。当我设置数字 45 时，它有效，数字 46 无效。当我右键单击连接并转到格式-> 行时，选择了正确的行尾并且预览也是正确的。我必须再次选择结尾并单击应用以在文档中更新它。

我正在使用 Visio 2007

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:21:55.343

好的，我发现了问题。您需要使用行尾的全名并使用它调用 visio 函数。

```
 //Set arrow ending
 connection.cellsU("EndArrow").formula("=USE(\"46: interface_in\")"); 
```

# ruby-on-rails - 在 Rails 3 中发送从商业站点到应用程序站点的 POST 创建会话

> ID：12977255
> 
> 赞同：2
> 
> 时间：2012-10-19T15:12:51.740
> 
> 标签：ruby-on-rails, authentication, devise

我希望用户在不注册帐户的情况下测试我的应用程序。为了做到这一点，我考虑在我的商业站点中包含一个链接，该链接将向我的应用程序站点（http://app/login using devise）发送一个固定的用户和密码，从而创建一个会话。我尝试使用 link_to 和 :method => 'post' 但我不知道如何在 POST 正文中发送参数！有什么建议么？

我正在尝试这个

```
link_to 'Blah', {:params => 'asdf'}, {:method => :post, :href => 'http://localhost:3001/login'} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:02:40.940

为了传递查询参数，您需要像处理*GET*请求一样将它们作为 URL 的一部分。像这样：

```
<%= link_to "Click Here", "/login?username=testuser&password=moojuice", :method => :post %> 
```

或者，如果您正在使用 Rails 路由助手

```
<%= link_to "Click here", login_path(:username => "testuser", :password => "moojuice"), :method => :post %> 
```

如果您将在与您登录的同一 Rails 应用程序中使用此链接，我不确定是否基于原始问题。如果你不是，还有另一个小问题。从外部站点发帖时，Rails 很可能会忽略您的请求，因为您将丢失 Rails 在加载页面时自动生成的 CSRF 令牌。为了实现这一点，您必须在处理您的登录的控制器中调用protect_from_forgery 方法。假设您的 /login 路由映射到*SessionsController*操作*create*：

```
class SessionsController < ApplicationController
  protect_from_forgery :except => [:create] # Need this to ignore CSRF token
  def create
    # Login logic
  end
end 
```

话虽如此，我不建议删除 CSRF 令牌，因为这会降低您的应用程序的安全性。我建议在您的*SessionsController*中实施一个特殊操作，将它们登录到自己的 Session 中，如下所示：

```
class SessionsController < ApplicationController

  def create
    # Login logic
  end

  def demo_account
    # Logic to create session for demo account
  end
end 
```

这样，您就可以忘记执行 POST 请求的链接，而只需将 /demo_login 映射到*SessionsController*的 *demo_account* 操作的*GET路由。*这将另外允许此链接在任何地方使用，而不仅仅是在您的应用程序中（例如在电子邮件中，正如之前的评论者 @allaire 所建议的那样）。但是，如果您希望它通过 Rails 应用程序中的链接工作，那么只需忽略我关于 CSRF 令牌的答案部分。

# excel - 在 EXCEL VBA 中执行命名单元格添加

> ID：12977258
> 
> 赞同：0
> 
> 时间：2012-10-19T15:13:06.110
> 
> 标签：excel, vba

我有一个名为的单元格，`DATA_FIELD_NAME`我想通过以下方式使用它：

```
Private Sub LockCells(iNumberOfDataColumns As Long)
  ActiveSheet.Unprotect
  ActiveSheet.Cells.Locked = False
  ActiveSheet.Range("DATA_FIELD_NAME:DATA_FIELD_NAME+iNumberOfDataColumns").Locked = True
  ActiveSheet.Protect Contents:=True
End Sub 
```

本质上，我想锁定从`DATA_FIELD_NAME`单元格开始水平到`DATA_FIELD_NAME + n`.

但是，这不起作用。有人可以告诉我正确的语法或替代方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:15:40.447

我会试试这个：

`ActiveSheet.Range("DATA_FIELD_NAME").Resize(1, iNumberOfDataColumns).Locked = True`

这是[Range.Resize 的参考，](http://office.microsoft.com/en-us/excel-help/HV080553487.aspx)基本上它会根据当前范围更改您正在处理的单元格数量。在我给你的内容中，它变为 1 行和 iNumberOfDataColumns 列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:31:00.913

我只是在 SO 中写了这个，没有在 XL 中测试，所以它可能包含拼写错误，但这应该有效：

```
With ActiveSheet
   Range(.Range("DATA_FIELD_NAME"), .Range("DATA_FIELD_NAME").Offset(0,iNumberOfDataColumns)
End With 
```

这个想法是结合`Offset(rows, cols)`使用`Range(range1, range2)`语法。
或者，您可以是[此处](http://support.microsoft.com/kb/830287)解释的动态范围名称。

# postgresql - 生成用于 for 循环的日期序列

> ID：12977261
> 
> 赞同：1
> 
> 时间：2012-10-19T15:13:13.000
> 
> 标签：postgresql, time-series

我有一系列按日期分区并按以下格式命名的表：

```
public.schedule_20121018 
```

有没有办法以上述`20121018`模式生成日期序列，以便我可以进行 for`SELECT`循环`information_schema.tables`？

现在我有

```
SELECT * FROM information_schema.tables
WHERE table_type = 'BASE TABLE'
AND table_schema = 'public'
AND table_name like 'schedule_%'
ORDER BY table_name; 
```

但例如，我需要最近 7 天的记录，以便日期序列从`20121012`to开始`20121018`。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:23:58.667

```
SELECT *
FROM information_schema.tables
WHERE table_type = 'BASE TABLE'
    AND table_schema = 'public'
    AND table_name in (
        select 'schedule_' || to_char(d, 'YYYYMMDD')
        from 
        generate_series(current_date - 7, current_date - 1, '1 day') s(d)
        )
ORDER BY table_name; 
```

较旧的 Postgresql 版本：

```
SELECT *
FROM information_schema.tables
WHERE table_type = 'BASE TABLE'
    AND table_schema = 'public'
    AND table_name in (
        select 'schedule_' || to_char(current_date - d, 'YYYYMMDD')
        from 
        generate_series(7, 1, -1) s(d)
        )
ORDER BY table_name; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:23:59.603

使用`generate_series`, 可能与`to_char`用于格式化。

```
regress=# select generate_series(DATE '20121012', DATE '20121018', interval '1' day);
    generate_series     
------------------------
 2012-10-12 00:00:00+08
 2012-10-13 00:00:00+08
 2012-10-14 00:00:00+08
 2012-10-15 00:00:00+08
 2012-10-16 00:00:00+08
 2012-10-17 00:00:00+08
 2012-10-18 00:00:00+08
(7 rows) 
```

# java - 允许用户移动字段的 Java gui

> ID：12977262
> 
> 赞同：1
> 
> 时间：2012-10-19T15:13:14.067
> 
> 标签：java, swing, user-interface, awt, mouse-listeners

我正在尝试创建一个 java gui，目前我正在使用他们的 gui 创建者在 netbeans IDE 中玩耍，但我也一直在阅读一本关于 Swing 的书并试图以这种方式学习它。我希望有人可以帮助我解决我遇到的问题。我试图让用户拥有一个他们可以选择的字段“池”（例如标题、段落、文本恶魔、按钮等），并能够将项目从池中移动到另一个药水窗口可以让他们创建自己的布局。此时我不需要这些字段来做任何事情，但我确实希望用户能够移动它们并创建自己的布局。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:15:52.107

我认为要做到这一点，您需要在容器上使用空布局来保存可移动组件，并且您必须提供在程序中处于活动状态的组件 MouseListeners 和 MouseMotionListeners（方便地组合成 MouseAdapters）处于设置状态，但在程序的组件已全部设置时处于非活动状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T16:28:40.423

您可以使用[`DragLayout`来自 Tips4java 网站的](http://tips4java.wordpress.com/2011/10/23/drag-layout/)。

# java - 有什么方法可以使用 JSch 禁用已知主机检查？

> ID：12977264
> 
> 赞同：22
> 
> 时间：2012-10-19T15:13:16.307
> 
> 标签：java, ssh, jsch

我正在尝试摆脱 JSch 和 SSH 从本地 Java 连接到远程 (Solaris) 主机的麻烦。我通常使用 PuTTy，每次我第一次连接某个地方时，它都会提示我一个未知主机，然后我说是，它不再这样做，因为它将已知主机存储在 Win7 注册表中。但是 JSch 需要一个 known_hosts 文件，我不知道如何制作它。我可以稍后进行调查，但现在，我宁愿跳过这一步。有谁知道它是否可行以及如何？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-10-19T15:16:24.167

您是否尝试过以下方法：

```
session.setConfig("StrictHostKeyChecking", "no"); 
```

从[这个线程](http://www.mail-archive.com/jsch-users@lists.sourceforge.net/msg00529.html)

# javascript - Javascript 中更改的选定索引

> ID：12977265
> 
> 赞同：1
> 
> 时间：2012-10-19T15:13:17.530
> 
> 标签：javascript, jquery, arrays, drop-down-menu

我有一个`Grade`带有值的下拉列表

```
["a", "b", "c"] 
```

在下拉列表的选择更改时，`Student`应加载下拉列表的值。

```
when "a" is selected, Dropdown students should populate ["Anna", "Hannah"]
When "b" is selected, Dropdown students should populate ["Billy", "Cathy"]
When "c" is selected, Dropdown students should populate ["Albert", "Deepti"] 
```

我们可以将所有成绩和学生保存在单个数组中（在 js 文件中）吗？如果是，我怎样才能从数组中仅加载在 javascript 中更改的选定索引上的那些值？

添加到描述中，我的代码是 HTML，所以我的控件是：

```
 <select id="grade" name="grade"></select>
 <select id="student" name="student"></select> 
```

修改的 ：

```
 var grades_rank;
    var grades_student;
    var grades = {     "very good": ["Anna", "Hannah"],     "good":
 ["Billy", "Cathy"],     "above average": ["Albert", "Deepti"] }  ; 
```

要加载下拉列表：

```
for (var _i = 0; _i < grades.length; _i++) {
            jQ('#Stu_Grades').append(jQ("<option></option>").attr("value", _i).text(grades[_i][grades_rank]));
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:43:07.740

如果您真的*只*想要一个数组，则可以将它们全部保存在一组对象中

```
var studentsByGrade = [ 
    { "grade": "a", "name": "Anna" }, 
    { "grade": "a", "name": "Hannah" }, 
    { "grade": "b", "name": "Billy" }, 
    { "grade": "b", "name": "Cathy" }, 
    { "grade": "c", "name": "Albert" }, 
    { "grade": "c", "name": "Deepti" }
]; 
```

使用它来填充#grade 下拉列表：

```
for (var i=0;i<studentsByGrade.length;i++) {
    if ($("#grade option[value='+"studentsByGrade[i].grade"+']").length === 0) {
        $("#grade").append("<option value='"+studentsByGrade[i].grade+'>"+studentsByGrade[i].grade+"</option>");
    }
} 
```

并将其作为更改处理程序放在#grade 下拉列表中：

```
$("#grade").on('change', function() {
    var grade = this.value;        
    students.innerHTML = "";
    for (var i=0;i<studentsByGrade.length;i++) {
        if (studentsByGrade[i].grade == grade) {
            $("#student").append("<option value='"+studentsByGrade[i].name+'>"+studentsByGrade[i].name+"</option>");
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:17:21.417

使用一个对象：

```
var grades = {
    a: ["Anna", "Hannah"],
    b: ["Billy", "Cathy"],
    c: ["Albert", "Deepti"]
} 
```

当下拉值更改时，使用其新值查找您要使用的名称：

```
grades[a]; // ["Anna", "Hannah"]
grades[b]; // ["Billy", "Cathy"] 
```

当一切都说完了，它可能看起来像下面这样：

```
// Lookup chart for grades and students
var grades = {
    a: ["Anna", "Hannah"],
    b: ["Billy", "Cathy"],
    c: ["Albert", "Deepti"]
}

// Reference our dropdown lists
var grade = document.getElementById("grade");
var student = document.getElementById("student");

// Add an event handler to the 'change' event on our grades
grade.addEventListener("change", function(){
    // A few variables we'll use
    var option, g, c, i;
    // Clear student list
    while ( c = student.firstChild ) student.removeChild( c );
    // If the new value is a grade in our lookup
    if ( g = grades[ this.value ] ) {
        // Populate student list
        for ( i = 0; i < g.length; i++ ) {
            option = document.createElement("option");
            option.text = g[i];
            student.appendChild(option);
        }
    }
}, false);​ 
```

# html - 响应式前端 web 层

> ID：12977268
> 
> 赞同：0
> 
> 时间：2012-10-19T15:13:23.810
> 
> 标签：html, css, responsive-design, mobile-website

我计划构建一个 Web 应用程序，可以通过不同的设备、带有大显示器的 PC、平板电脑和手机（IOS、Android）访问。

这样做的最佳做法是什么？我是否应该构建两个前端层，一个用于 PC，另一个用于带有触摸屏的移动设备？（我想两者都会有反应）

还是我应该制作一个可以适应所有著名屏幕尺寸的响应式前端？

这两种方法的优点和缺点是什么？建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:17:57.717

考虑使用响应[式 HTML5 Boilerplace](http://www.initializr.com/)。

HTML5 样板是启动任何网站的好方法。响应式设计适用于任何平台。 [尝试响应式设计](http://www.initializr.com/try)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:16:52.723

您还可以查看[15 个值得考虑的响应式 CSS 框架](http://speckyboy.com/2011/11/17/15-responsive-css-frameworks-worth-considering/)来选择框架。

# ms-access - 在Query中查找数据的第一个出现值

> ID：12977269
> 
> 赞同：1
> 
> 时间：2012-10-19T15:13:24.847
> 
> 标签：ms-access, ms-query

我有一张表，里面有很多数据，但只有四个类别。我想返回类型的第一次出现和最后一次出现的 ID。以下是我的数据的简化版本..

```
ID    |    FName    |    Password   |    Category    |    Outcome
-----------------------------------------------------------------
1     |    Dan      |    something  |    NEW         |    8
2     |    Faye     |    another    |    NEW         |    1
:
:
189   |    Chris    |    Password   |    OLD         |    2
190   |    Matt     |    Milk       |    OLD         |    7
:
:
1169  |    Mark     |    Dog        |    LITE        |    3
1170  |    Nick     |    Land       |    LITE        |    1 
```

所以我想要一个查询，将结果返回为

```
CATEGORY    |    ID_START   |    ID_END
----------------------------------------
NEW         |    1          |    188     
OLD         |    189        |    1168     
LITE        |    1169       |    9999 
```

我正在使用 Access 2010。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:18:16.127

我可以这样建议：

```
select category, min(id) as idStart, max(id) as idEnd
from tbl
group by category 
```

希望这可以帮助你

# spring-mvc - 杰克逊在 Spring MVC 3.1.2

> ID：12977270
> 
> 赞同：0
> 
> 时间：2012-10-19T15:13:28.577
> 
> 标签：spring-mvc, jackson

我无法让 Jackson 在我的 Spring 应用程序中工作。

我在用着

*   春天MVC 3.1.2
*   杰克逊 1.9.1 映射器 asl

我已将 Jackson 库添加到 /WEB-INF/lib/ 文件夹并添加到我的 spring 配置文件中。

弹簧配置.xml

```
<!-- language: xml-->
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:mvc="http://www.springframework.org/schema/mvc" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
    http://www.springframework.org/schema/beans     
    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.1.xsd
    http://www.springframework.org/schema/mvc
    http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

<mvc:annotation-driven />

<context:component-scan base-package="com.mason.server.controller"  />

<bean
   class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix">
        <value>/WEB-CONTENT/</value>
    </property>
    <property name="suffix">
        <value>.jsp</value>
    </property>
</bean>

<bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
   <property name="basename" value="WEB-INF/messages/messages" />
</bean> 
```

控制器中的功能

```
<!-- language: java -->
@RequestMapping(value = "/get_json", method = RequestMethod.GET, headers = "Accept=*/*")
public @ResponseBody List<String> getTechList() {
    List<String> countryList = new ArrayList<String>();

    countryList.add("test");

    return countryList;
} 
```

当我转到 localhost:8888/get_json 时，我收到错误 406。

我在互联网上尝试了一种解决方案，但似乎都没有奏效。任何帮助，将不胜感激！

PS：我将 Spring MVC 与 Google App Engine 和 Spring Security 结合使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T07:19:13.473

2天后我让它工作了。我忘了将*jackson-core-asl-1.9.10*添加到我的库中，当我使用 jQuery 发出请求时，一切正常。它无法转到浏览器中的链接，但我想现在没问题。

mvc-config.xml

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans     
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

<context:component-scan base-package="com.mason.server.controller"  />

<mvc:annotation-driven />

<bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
  <property name="mediaTypes">
    <map>
      <entry key="html" value="text/html"/>
      <entry key="json" value="application/json"/>
    </map>
  </property>
  <property name="viewResolvers">
    <list>
      <bean class="org.springframework.web.servlet.view.UrlBasedViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
        <property name="prefix" value="/WEB-CONTENT/"/>
        <property name="suffix" value=".jsp"/>
      </bean>
    </list>
  </property>
  <property name="defaultViews">
    <list>
      <bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
        <property name="prefixJson" value="true"/>
      </bean>
    </list>
  </property>
</bean> 
```

测试.jsp

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" " http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd ">
<html xmlns=" http://www.w3.org/1999/xhtml ">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Request json test</title>
<script src="http://code.jquery.com/jquery-1.5.js"></script>
<script>

$(document).ready(function(){
    //attach a jQuery live event to the button
    $('#getdata-button').live('click', function(){
        $.getJSON('/get_json', function(data) {
            //alert(data); //uncomment this for debug
            //alert (data.item1+" "+data.item2+" "+data.item3); //further debug
            $('#showdata').html("<p>"+data+"</p>");
        });
    });
});

</script>

</head>
<body>
<a href="#" id="getdata-button">Get JSON Data</a>
<div id="showdata"></div>
</body>
</html> 
```

# c# - Automapper - 为什么使用 Mapper.Initialize？

> ID：12977273
> 
> 赞同：17
> 
> 时间：2012-10-19T15:13:39.777
> 
> 标签：c#, automapper

我通常不会在这里问这种问题，但不幸的是，虽然[AutoMapper](http://automapper.org/)似乎是一个很好的映射库，但它的文档非常糟糕——没有关于该库方法的 XML 文档，以及我能找到的最官方的在线文档是[这个](https://github.com/AutoMapper/AutoMapper/wiki)，非常轻快。如果有人有更好的文档，请告诉我。

也就是说，这里的问题是：为什么使用`Mapper.Initialize`? 它似乎不是必需的，因为您可以`Mapper.CreateMap`立即使用，并且由于没有文档，我不知道要做什么`Initialize`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-22T14:23:19.233

我在 AutoMapper 用户列表上问过，这个答案基本上说明了原因：

[https://groups.google.com/forum/?fromgroups=#!topic/automapper-users/0RgIjrKi28U](https://groups.google.com/forum/?fromgroups=#!topic/automapper-users/0RgIjrKi28U)

这与允许 AutoMapper 进行确定性（随机）优化有关。在性能方面，最好在`Initialize`调用中创建所有映射。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-19T15:34:19.620

初始化运行所有地图创建一次，因此在您进行映射时完成。您可以随时创建映射，但这会减慢您的代码速度，因为映射创建涉及反射。

我发现最好为我的映射代码使用配置文件，并使用以下内容来完成所有设置：

```
public class AutoMapperConfiguration : IRequiresConfigurationOnStartUp
{
    private readonly IContainer _container;

    public AutoMapperConfiguration(IContainer container)
    {
        _container = container;
    }

    public void Configure()
    {
        Mapper.Initialize(x => GetAutoMapperConfiguration(Mapper.Configuration));
    }

    private void GetAutoMapperConfiguration(IConfiguration configuration)
    {
        var profiles = GetProfiles();
        foreach (var profile in profiles)
        {
            configuration.AddProfile(_container.GetInstance(profile) as Profile);
        }
    }

    private static IEnumerable<Type> GetProfiles()
    {
        return typeof(AutoMapperConfiguration).Assembly.GetTypes()
            .Where(type => !type.IsAbstract && typeof(Profile).IsAssignableFrom(type));
    }
} 
```

# java - 具有多个 JPanel 的 JTree

> ID：12977274
> 
> 赞同：1
> 
> 时间：2012-10-19T15:13:40.890
> 
> 标签：java, swing, jframe, jtree

我从 Java 编程开始，我想学习。这个想法是有一个JFrame，然后放一个JTree，最后放一个JPanel。然后新的JPanel 的独立，各自有各自的组件。并且选择一些 JTree 节点会加载一些独立的 JPanel。

他们喜欢在 C# 中执行此操作，但我不知道 java。例如，C# 中的按钮如下所示：

```
 private void button1_Click(object sender, EventArgs e)
{
    foreach (Control ctrl in panel1.Controls)
    {
        ctrl.Dispose();
    }
    panel1.Controls.Add(new UserControl1());
}
private void button2_Click(object sender, EventArgs e)
{
    foreach (Control ctrl in panel1.Controls)
    {
        ctrl.Dispose();
    }
    panel1.Controls.Add(new UserControl2());
} 
```

其他示例： [http ://www.c-sharpcorner.com/uploadfile/Dorababu742/using-treeview-panel-control-in-windows-form/](http://www.c-sharpcorner.com/uploadfile/Dorababu742/using-treeview-panel-control-in-windows-form/)

任何想法？对不起我的英语不好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:31:55.373

*   使用[JTree](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html)`String value`并从[TreeSelectionListener](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html#select)返回

*   将[JPanels 放入 CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)

*   selection acme from`JTree`返回 String 值作为[CardLayout#show(Container parent, String name) 的参数](http://docs.oracle.com/javase/7/docs/api/java/awt/CardLayout.html#show%28java.awt.Container,%20java.lang.String%29)

# jquery - 带有平滑滚动的粘性导航正在跳跃

> ID：12977275
> 
> 赞同：7
> 
> 时间：2012-10-19T15:13:43.420
> 
> 标签：jquery, header, navigation, sticky, smooth-scrolling

我在使用棒式导航和平滑滚动时遇到了各种问题。我只是对 jQuery 了解不足，无法进行故障排除。我正在使用 Chris Coyer 的平滑滚动片段：http: [//css-tricks.com/snippets/jquery/smooth-scrolling/](http://css-tricks.com/snippets/jquery/smooth-scrolling/)。我的页面在这里：[http](http://clients.ekcetera.com/agivingchance) ://clients.ekcetera.com/agivingchance 。

这是我的问题：

1.  对于任何导航项目，它会部分滚动，然后跳转到该位置。我很确定这是因为我不知道如何解释粘性标题，所以我将锚点放高一点以考虑锚点的高度。因此，它到达锚点并停止，然后跳转到正确的视图。
2.  单击后退按钮时，它似乎并不总是转到正确的位置 - 有时它非常随机。我认为这与问题1有关，希望它会自行解决。我什至可以完全删除浏览器历史记录/后退按钮，但就像我说的那样，JQuery 大师还不足以知道要删除什么。

有什么建议么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:26:38.470

**1.**使用[Devin Sturgeon](http://www.devinsturgeon.com/)关于平滑滚动帖子的评论中的代码。另外，我添加了一些减法来弥补您的粘性标题。调整到喜欢。

```
// your functions go here 
$('a[href*=#]:not([href=#])').click(function() {
    if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') 
        || location.hostname == this.hostname) {

        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
           if (target.length) {
             $('html,body').animate({
                 scrollTop: target.offset().top - 181
            }, 1000);
            return false;
        }
    }
}); 
```

**2.**将所有锚点移动到要滚动到的实际元素。

（参考：[http](http://css-tricks.com/snippets/jquery/smooth-scrolling/#comment-197181) ://css-tricks.com/snippets/jquery/smooth-scrolling/#comment-197181 ）

# c# - 如何基于 SortedList 类进行分页

> ID：12977276
> 
> 赞同：-2
> 
> 时间：2012-10-19T15:13:51.543
> 
> 标签：c#, paging, sortedlist

你好我有方法返回 SortedList 对象我需要做分页

`SortedList output = this.GetSearchResults(SearchQuery.QueryString, se); ViewBag.ResultSearch = output;`

如何在linq中制作等效示例

....跳过(100).Take(5);

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:17:46.920

由于 a`SortedList`没有实现`IEnumerable<T>`（与 不同[`SortedList<TKey,TValue>`](http://msdn.microsoft.com/en-us/library/ms132319.aspx)），因此您需要将其强制转换为类型以获取`IEnumerable<T>`.

例如：

```
var paged = sl.Cast<Object>()
              .Skip(100)
              .Take(5); 
```

# c# - var 默认为哪种 int 类型？

> ID：12977280
> 
> 赞同：10
> 
> 时间：2012-10-19T14:15:01.557
> 
> 标签：c#

> **可能重复：**
> [C#short/long/int 文字格式？](https://stackoverflow.com/questions/5820721/c-sharp-short-long-int-literal-format)

[阅读](http://msdn.microsoft.com/en-us/library/vstudio/bb384061.aspx%20)在编程中的使用`var`，我很好奇 var 在用于`int`类型时的默认值。例如，如果我使用

`var foo = 65535`

类型是`ushort`还是只是`int`？谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-19T14:25:09.810

真的，您要问的是**C# 中整数文字的类型是什么？**，可以在规范中找到答案：

（4.0 规范的第 2.4.4.2 节）

> 整数文字的类型确定如下：
> 
> *   如果字面量没有后缀，则它具有可以表示其值的第一种类型：int、uint、long、ulong。
> *   如果文字以 U 或 u 为后缀，则它具有可以表示其值的第一种类型：uint、ulong。
> *   如果文字以 L 或 l 为后缀，则它具有可以表示其值的第一种类型：long、ulong。
> *   如果文字以 UL、Ul、uL、ul、LU、Lu、lU 或 lu 为后缀，则为 ulong 类型。
> 
> 如果整数文字表示的值超出 ulong 类型的范围，则会发生编译时错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-19T14:17:07.700

所有整数文字都是 type ，因此除非您在末尾强制转换或添加显式类型限定符，否则您`int`的变量将是：`int`

```
var quick = 65535;         // int
var brown = (ushort)65535; // ushort
var fox = 65535L;          // long 
```

# java - 使用 Java 在文件中写入和读取多个字节 []

> ID：12977290
> 
> 赞同：5
> 
> 时间：2012-10-19T15:14:17.250
> 
> 标签：java, file, bytearray

我必须在文件中写入字节数组。我不能一次完成，所以我不能把我的数组放在一个容器里。我的数组的大小也是可变的。其次，文件非常大，所以我必须拆分它，以便逐个数组读取它。

我怎样才能做到这一点 ？我试图逐行编写我的字节数组，但我做不到。如何在我的数组之间放置一个分隔符，然后将它拆分到这个分隔符上？

编辑 ：

我试过这个：

```
ByteArrayOutputStream bos = new ByteArrayOutputStream();
ObjectOutput out = new ObjectOutputStream(bos);
out.writeObject(byteArray); 
```

但是，我多次执行此代码，因此 ObjectOutputStream 每次都会添加一个新的标头，这会破坏文件。

我也尝试：

```
out.write(byteArray); 
```

但我无法分离我的数组。所以我尝试附加一个'\ n'，但没有奏效。在我寻找像 FileUtils 这样的库以便逐行编写 byte[] 但我没有找到之后。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T15:23:25.410

您可以使用现有的集合，例如 List 来维护 byte[] 的列表并传输它

```
 List<byte[]> list = new ArrayList<byte[]>();
    list.add("HI".getBytes());
    list.add("BYE".getBytes());

    ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(
            "test.txt"));
    out.writeObject(list);

    ObjectInputStream in = new ObjectInputStream(new FileInputStream(
            "test.txt"));
    List<byte[]> byteList = (List<byte[]>) in.readObject();

    //if you want to add to list you will need to add to byteList and write it again
    for (byte[] bytes : byteList) {
        System.out.println(new String(bytes));
    } 
```

输出：

```
 HI
   BYE 
```

另一种选择是使用[RandomAccessFile](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/RandomAccessFile.html)。**这不会强迫您阅读完整的文件，您可以跳过不想阅读的数据。**

```
 DataOutputStream dataOutStream = new DataOutputStream(
            new FileOutputStream("test1"));
    int numberOfChunks = 2;
    dataOutStream.writeInt(numberOfChunks);// Write number of chunks first
    byte[] firstChunk = "HI".getBytes();
    dataOutStream.writeInt(firstChunk.length);//Write length of array a small custom protocol
    dataOutStream.write(firstChunk);//Write byte array

    byte[] secondChunk = "BYE".getBytes();
    dataOutStream.writeInt(secondChunk.length);//Write length of array
    dataOutStream.write(secondChunk);//Write byte array

    RandomAccessFile randomAccessFile = new RandomAccessFile("test1", "r");
    int chunksRead = randomAccessFile.readInt();
    for (int i = 0; i < chunksRead; i++) {
        int size = randomAccessFile.readInt();
        if (i == 1)// means we only want to read last chunk
        {
            byte[] bytes = new byte[size];
            randomAccessFile.read(bytes, 0, bytes.length);
            System.out.println(new String(bytes));
        }
        randomAccessFile.seek(4+(i+1)*size+4*(i+1));//From start so 4 int + i* size+ 4* i ie. size of i
    } 
```

输出：

```
BYE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:19:05.343

您必须在编码中描述您的数据。即添加一些元数据。

比如数组的长度，然后是数组的数据。

这称为序列化。

```
Array of int: length(4 bytes), data[0] (4 bytes), data[1] (4 bytes), data[2] (4 bytes) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T16:03:19.320

有几种方法可以做到这一点。基本上首先要指出的是文件只是一个非结构化的字节序列。任何字节。基本上你想要存储几个可变长度的字节数组。这意味着您必须以某种方式添加结构，然后在阅读时对其进行解析。

最简单的可能是使用一些您视为分隔符的字节序列（足够具体，否则它在您的数据中出现的可能性很低）。

然后在写作时，首先简单地写你的字节，然后是分隔符

```
out.write(myarray);
out.write(separator);
out.write(anotherarray); 
```

在阅读时，您需要使用某种可以检查的滑动窗口，以便确定您是否已阅读分隔符。基本上只是逐个迭代字节并将您读过的最后几个字节保存在某个缓冲区中。当您在缓冲区中看到分隔符时，您刚刚找到了数组的末尾。

对此的替代方法可以是写入固定长度的块，其中包含一些描述长度的标头，并且可能还有一些用于表示当前数组是否存在另一个数据包的位。然后，您只需读取和写入整个块。

# c++ - 使用可变参数模板和提升将表格映射到地图

> ID：12977291
> 
> 赞同：2
> 
> 时间：2012-10-19T15:14:20.093
> 
> 标签：c++, boost, variadic-templates, variadic-functions

我正在尝试在映射中复制一个数据库表，其中它的主键将是映射的键，其余列是 boost:vector 的实例。我是 boost 和可变参数模板的新手。我试图编写一个包装器，但它只适用于固定数量的列。以下是代码

```
#include <boost/container/vector.hpp>
#include <iostream>
#include <string>
#include <map>
#include <type_traits>

typedef boost::container::vector<std::string> MAPPED_COLS;
typedef std::map <int,  MAPPED_COLS >    TABLE ;
typedef std::map <int,  MAPPED_COLS > ::iterator ROW_ITER;

typedef std::string  str;

template <typename str>
class MappedTable
{
    private:
            TABLE           mapTable;
            MAPPED_COLS     cols;
            ROW_ITER        row;

            std::string     scTableName;
            int             iRows;
            int             iCols;
    public:
            MappedTable()  { iCols=3; }

            MappedTable(int iNumCols)  { iCols=iNumCols;}
            ~MappedTable() { }

            template <str>
            void    fnRowCols()     //termination version
            {
            }

            template <str>
            void    fnCols(const str& scCol2, const str& scCol3,...)
            {
                    if(cols.size()>=iCols)
                    {
                          cols.erase (cols.begin(),cols.begin()+iCols);
                    }
                    cols.push_back(scCol2);

                    fnCols(scCol3,...);
            }

            template <str>
            void fnMapRow(int iCol1,const str& scCol2,...)
            {
                    fnCols(scCol2,...);
                    mapTable[iCol1]=MAPPED_COLS(cols);
            }

            MAPPED_COLS& fnGetRow(int iFindKey)
            {
                    row=mapTable.find(iFindKey);
                    if(row!=mapTable.end())
                            return (row->second);
            }
 }; 
```

以下是上述包装器的 main() 如果我不在包装器中使用可变参数模板，它可以正常工作：-

```
 int main()
 {
    MappedTable Table(3) ;

    std::string vid[]={"11", "21", "51", "41"};
    std::string fare[]={"100", "400", "200", "4000"};
    std::string vehicle[]={"bus", "car", "train", "aeroplane"};

    int i=0;

    for(i=0;i<4;i++)
    {
            Table.fnMapRow(i,vid[i],fare[i],vehicle[i]);
    }

    for(i=0;i<4;i++)
    {
            MAPPED_COLS mpCol=Table.fnGetRow(i);
            std::cout<<"\n  "<<i<<" "<<mpCol[0]<<" "<<mpCol[1]<<" "<<mpCol[2];
    }

    std::cout<<"\n";

    return 0;
} 
```

代码使用 Boost 1.51.0 和 gcc 4.4 编译，带有 std=c++0x 选项

~~谁能建议我我错过了什么？我对更好的想法持开放态度，并且很想知道即使效率不够高，这个特定示例也将如何工作。~~

我在下面的回答中提供了工作代码片段（感谢 Rost）。如果有人能提出一些更好、更多的方法来将整个表格存储到地图中，那就太好了。

谢谢 ！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:32:23.567

您的可变参数模板函数语法看起来不正确。应该是这样的：

```
 template <typename... VarArgs>
 void fnCols(const str& scCol2, const str& scCol3, const VarArgs&... args)
 {
     // Non-relevant code skipped
     fnCols(scCol3, args...); // Recursive call with expanding arguments pack
 } 
```

类似的问题`fnMapRow`。在`template <str>`模板成员函数定义之前也不需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T10:06:24.187

我找到了问题的答案。如果将来有人需要，以下是工作代码。

```
 void    fnCols()        //termination version
            {
            }

            template <typename... VarArgs>
            void    fnCols(const str& scCol2, const VarArgs&...args)
            {
                    if(cols.size()>=iCols)
                    {
                            cols.erase (cols.begin(),cols.begin()+iCols);
                    }
                    cols.push_back(scCol2);
                    fnCols(args...);
            }

            template <typename... VarArgs>
            void fnMapRow(int iCol1, const VarArgs&... args)
            {
                    static const int iNumArgs = sizeof...(VarArgs);
                    if(iNumArgs==iCols)
                    {
                            fnCols(args...);
                            mapTable[iCol1]=MAPPED_COLS(cols);
                    }                       
            } 
```

# java - 在java中将svg转换为pdf时更改字体

> ID：12977293
> 
> 赞同：1
> 
> 时间：2012-10-19T15:14:25.343
> 
> 标签：java, pdf, fonts, svg, batik

我有一个用于将 svg 转换为 pdf 的 java 程序。在那个 svg 文件中，我给了 Myriad Pro Light 作为样式，在转换为 pdf 之后，字体又出现了别的东西。谁能建议我如何以编程方式配置字体样式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T08:30:20.130

Batik 依靠 AWT 字体来呈现 SVG 文本。如果在系统上找不到该字体或未注册该字体，您最终将使用默认的“无衬线”字体。

您必须确保在您的系统上安装了“Myriad pro light”字体，并且它的家族名称与您的 SVG 文件中引用的字体完全相同（查看 font-family 属性）；如果需要，在 SVG 文件中更正它。

如果在系统范围内安装字体不是一个选项，您可以在创建 SVGDocument 实例之前在运行时注册它，使用类似这样的东西

```
GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
InputStream is = new FileInputStream(new File("path_to_myriad.ttf"));
java.awt.Font font;
try {
    font = java.awt.Font.createFont(java.awt.Font.TRUETYPE_FONT, is);
    ge.registerFont(font);
} catch (FontFormatException e) {
    e.printStackTrace();
} 
```

# php - 简单的 XML 和 PHP

> ID：12977297
> 
> 赞同：1
> 
> 时间：2012-10-19T15:14:36.157
> 
> 标签：php, html, xml, simplexml

嘿，我有一个 XML 文件，其中包含一些与此类似的信息：

```
<root>
 <library>
   <name>TestName1</name>
   <location>TestLocation1</location>
 </library>
 <library>
   <name>TestName2</name>
   <location>TestLocation2</location>
 </library>
 <book>
   <name>Book1</name>
   <author>Author1</author>
 </book>
 <book>
   <name>Book2</name>
   <author>Author2</author>
 </book>
</root> 
```

我所做的是创建一个数组来存储信息数组。然而，我的问题在于试图只归还书籍或图书馆。

```
$xml = "libraries.xml";
$array_libraries = array();
$library = simplexml_load_file($xml);

foreach($library as $get_library) {
$name = $get_library->name;
$location = $get_library->location;
array_push($array_albums, array($name, $location));
} 
```

如果可能的话，我想将书籍和图书馆保存在同一个文件中，但我只想将图书馆放入数组中，提前谢谢你:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:17:58.313

您只需要遍历库，而不仅仅是整个 XML。

改变：

```
foreach($library as $get_library) { 
```

至

```
foreach($library->library as $get_library) { 
```

附带说明一下，SimpleXML 并不是处理 XML 的最佳选择。考虑改用[DOMDocument](http://php.net/manual/en/class.domdocument.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:17:48.017

你定义一个数组，

```
$array_libraries = array(); 
```

然后你推入另一个数组

```
array_push($array_albums, array($name, $location)); 
```

尝试推入先前声明的数组：

```
array_push($array_libraries, array($name, $location)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:30:15.780

这可能很有用

```
$xml = "libraries.xml";
$array_libraries = array();
$array_albums = array();
$library = simplexml_load_file( $xml );

foreach( $library as $get_library => $x ) {
    $name = $x->name;
    $location = $x->location;
    if ( $get_library === 'library' ) {
        array_push( $array_libraries, array( $name, $location ) );
    }
    if ( $get_library === 'book' ) {
        array_push( $array_albums, array( $name, $location ) );
    }
} 
```

如果您只想要库，则只保留 if 并删除/评论另一个库，如果您想要两个库，那么您已经有一个工作示例。

再见

# iphone - 捆绑标识符只读

> ID：12977298
> 
> 赞同：1
> 
> 时间：2012-10-19T15:14:37.357
> 
> 标签：iphone, xcode

我有一个应用程序具有我的应用程序的包标识符。

> com.sc.Quitchen_ap

我想更改它，但应用程序不允许我这样做，因为该部分是只读的。我真的需要把名字改成quitchen而不是quitchen_ap。请检查下面的图片。

![在此处输入图像描述](../Images/551e5faf8c9851f2f6c21aa44e8bfe8f.png)

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T10:06:07.487

感谢特洛伊木马。答案在另一个链接中。让我完成这个问题的答案。

**1\. 选择您的应用程序的构建目标。**

![在此处输入图像描述](../Images/18145caf9b1351cffdefe2f4ccc129c3.png)

**2\. 然后点击构建设置。**

![在此处输入图像描述](../Images/35645a8b7e0e8754b3bb44aa45f1c770.png)

**3。然后查找包装部分并更改产品名称。**“产品名称”****

![在此处输入图像描述](../Images/81b92ac2bd8c4df8a3a15b82de0f33a2.png)

**4\. 您将在应用程序的“摘要”选项卡中看到名称已更改。**

![在此处输入图像描述](../Images/85c7ddb6595cbc2459166d4ac5570e74.png)

谢谢@trojanfoe

# java - 使用 JAXB 防止 XXE 攻击

> ID：12977299
> 
> 赞同：45
> 
> 时间：2012-10-19T15:14:45.720
> 
> 标签：java, security, jaxb, ws-security, xxe

最近，我们对我们的代码进行了安全审计，其中一个问题是我们的应用程序受到了**Xml eXternal Entity** (XXE) 攻击。

基本上，该应用程序是一个计算器，它通过 Web 服务接收 XML 格式的输入。

这是对我们的应用程序进行此类 XXE 攻击的示例：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
   <soapenv:Header/>
   <soapenv:Body>
      <foo:calculateStuff>
         <!--Optional:-->
         <xmlInput><![CDATA[<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE currency [  
   <!ENTITY include SYSTEM "file:///d:/" >]>
<calcinput>...</calcinput>
]]></xmlInput>
      </foo:calculateStuff>
   </soapenv:Body>
</soapenv:Envelope> 
```

如您所见，我们可以引用指向外部文件 ( `"file:///d:/"`) 的实体。

关于 XML 输入本身（`<calcinput>...</calcinput>`部分）是用 JAXB (v2.1) 解组的。Web 服务部分基于 jaxws-rt (2.1)。

我需要做什么来保护我的网络服务？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-10-19T16:48:40.010

**JAXB**

您可以通过从`XMLStreamReader`具有`IS_SUPPORTING_EXTERNAL_ENTITIES`和/或`XMLInputFactory.SUPPORT_DTD`属性设置为`false`.

**JAX-WS**

JAX-WS 实现应该为您解决这个问题。如果不是，我建议针对特定实现打开一个错误。

* * *

**例子**

***演示***

```
package xxe;

import javax.xml.bind.*;
import javax.xml.stream.*;
import javax.xml.transform.stream.StreamSource;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Customer.class);

        XMLInputFactory xif = XMLInputFactory.newFactory();
        xif.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, false);
        xif.setProperty(XMLInputFactory.SUPPORT_DTD, false);
        XMLStreamReader xsr = xif.createXMLStreamReader(new StreamSource("src/xxe/input.xml"));

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        Customer customer = (Customer) unmarshaller.unmarshal(xsr);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(customer, System.out);
    }

} 
```

***输入.xml***

此 XML 文档包含一个实体，该实体已设置为获取我用于创建此示例的文件列表。

```
<?xml version="1.0"?>
<!DOCTYPE customer
[
<!ENTITY name SYSTEM "/Users/bdoughan/Examples/src/xxe/">
]
>
<customer>
  <name>&name;</name>
</customer> 
```

***顾客***

```
package xxe;

import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class Customer {

    private String name;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

} 
```

***输出 - 默认配置***

默认情况下，实体将被解析。

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<customer>
    <name>Customer.java
Demo.java
input.xml
</name>
</customer> 
```

***`XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES`属性设置为时输出`false`***

设置此属性时，实体不会被解析。

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<customer>
    <name></name>
</customer> 
```

***`XMLInputFactory.SUPPORT_DTD`属性设置为时输出`false`***

设置此属性时，将引发异常以尝试解析实体。

```
Exception in thread "main" javax.xml.bind.UnmarshalException
 - with linked exception:
[javax.xml.stream.XMLStreamException: ParseError at [row,col]:[8,15]
Message: The entity "name" was referenced, but not declared.]
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.handleStreamException(UnmarshallerImpl.java:436)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:372)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:342)
    at xxe.Demo.main(Demo.java:18)
Caused by: javax.xml.stream.XMLStreamException: ParseError at [row,col]:[8,15]
Message: The entity "name" was referenced, but not declared.
    at com.sun.org.apache.xerces.internal.impl.XMLStreamReaderImpl.next(XMLStreamReaderImpl.java:598)
    at com.sun.xml.bind.v2.runtime.unmarshaller.StAXStreamConnector.bridge(StAXStreamConnector.java:196)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:370)
    ... 2 more 
```

# opencv - 如何检查轮廓是否为椭圆？

> ID：12977300
> 
> 赞同：1
> 
> 时间：2012-10-19T15:14:46.103
> 
> 标签：opencv, contour, ellipse

我正在尝试使用 opencv 检测图像中的椭圆。我找到了包括椭圆和其他一些轮廓的轮廓。

关于如何检查哪些轮廓是椭圆的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T16:54:56.040

如果我理解正确，您已经检测到轮廓，其中一些是椭圆，有些不是，您希望能够确定哪些是椭圆。这样对吗？如果是，我建议使用`cv::fitEllipse()`. 该文档说它将椭圆拟合到点向量，因此 R 平方是最小的。不幸的是，该函数没有显式返回 R 平方值。你也许可以自己实现它......

作为一种解决方法，您还可以使用以下方法：

1.  获取轮廓 C
2.  将椭圆 E 拟合到 C
3.  比较 E 和 C。

要比较它们，您可以使用矩（参见`cv::moments()`和`cv::matchShapes()`）。不过，我认为您在这里不需要不变的时刻。

或者，你可以画出 C 和 E 找出有多少比例的表面重叠。

祝你好运，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-25T09:21:48.360

fitEllipse 给我们 RotatedRect。

我们可以使用可以转换为圆形的椭圆特定属性。

```
double is_ellipse( std::vector<cv::Point>  const& cloud, RotatedRect const& rr )
{
    double distance =0;

    for( auto const& point: cloud )
    {
        Point2f unit;
        unit.x = ( ( rr.center.x - point.x  ) * cos( - rr.angle*(3.1415926/180) ) -  ( rr.center.y - point.y  ) * sin( - rr.angle*(3.1415926/180) ) ) * 2 / rr.size.width ;
        unit.y = ( ( rr.center.x - point.x  ) * sin( - rr.angle*(3.1415926/180) ) +  ( rr.center.y - point.y  ) * cos( - rr.angle*(3.1415926/180) ) ) * 2 / rr.size.height;

        double len = sqrt( unit.x* unit.x +  unit.y * unit.y );
        distance += fabs( 1- len );
    }
    return distance / cloud.size();
} 
```

这里用于计算距圆边界的平均距离。修改其他一些统计函数很容易，例如：最大值、偏差。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-02-19T10:40:28.433

@Ahsan - 您必须遍历所有轮廓并尝试拟合椭圆。如果您发现曲线拟合数学很困难，那么一条捷径将是

像 - 遍历每个轮廓 - 丢弃非凸轮廓 - 现在制作当前轮廓的蒙版并使用 cv::matchShapes 函数进行 shapeMatching。

# python - 如何在队列中放置和获取一组多个项目？

> ID：12977301
> 
> 赞同：5
> 
> 时间：2012-10-19T15:14:47.967
> 
> 标签：python, variables, task-queue

工人：

```
def worker():
    while True:
        fruit, colour = q.get()
        print 'A ' + fruit + ' is ' + colour
        q.task_done() 
```

将项目放入队列：

```
fruit = 'banana'
colour = 'yellow'
q.put(fruit, colour) 
```

输出：

```
>>> A banana is yellow 
```

我怎么能做到这一点？我试过了`ValueError: too many values to unpack`，然后我才意识到我`q.put()`把两个变量都放到了队列中。

有什么方法可以将一组“变量/对象”放入一个队列项中，就像我尝试做的那样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-19T15:16:52.433

是的，使用元组：

```
fruit = 'banana'
colour = 'yellow'
q.put((fruit, colour)) 
```

它应该自动解包（应该，因为我无法在 atm 尝试）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-01T13:45:21.950

我只是列个清单：

```
fruit = 'banana'
colour = 'yellow'
q.put([fruit, colour]) 
```

然后得到它：

```
result = q.get()
fruit = result[0]
colour = result[1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:19:31.633

所以，我认为解决这个问题的最好方法是稍微重构你的数据。制作某种对象来保存一对值（在本例中为水果和颜色），然后将该对象放入队列中，然后在需要时取出变量。

如果您愿意，我可以稍后发布一些示例代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-18T20:21:03.370

Python 还借助类提供数据抽象。

因此，另一种方法是在类的帮助下放置一个对象（将相关信息抽象在一起），如下所示。

```
class Fruit(object):
   def __init__(self, name, color):
       self.name = name
       self.color = color

q.put(Fruit('banana', 'yellow'))

def worker():
    while True:
        fruit  = q.get()
        print 'A ' + fruit.name + ' is ' + fruit.color
        q.task_done() 
```

# java - HttpServlet 抛出的 GWT 捕获异常

> ID：12977306
> 
> 赞同：0
> 
> 时间：2012-10-19T15:14:55.033
> 
> 标签：java, forms, gwt, servlets, exception-handling

如果文件太大，我会从服务器代码（在 HttpServlet 中）抛出异常：

```
 public void doPost(HttpServletRequest req, HttpServletResponse res)
    throws ServletException, IOException {
 ...
 // Check if the blob has correct size, otherwise delete it
 final BlobInfo blobInfo = new BlobInfoFactory().loadBlobInfo(blobKey);
 long size = blobInfo.getSize();
 if(size > 0 && size <= BasicConstants.maxImageSize){
    res.sendRedirect("/download?blob-key=" + blobKey.getKeyString());
 } else { // size not allowed
    bs.delete(blobKey);
    throw new RuntimeException(BasicConstants.fileTooLarge);
 } 
```

从我**缺少**的客户端代码中，我无法使用此代码段成功捕获异常：

```
try {
    uploadForm.submit(); // send file to BlobStore, where the doPost method is executed
} catch (Exception ex) {
    GWT.log(ex.toString());
} 
```

但是，从这个其他客户端代码片段中，我以某种方式检测到异常何时引发了一个我根本不信任的丑陋解决方法：

```
uploadForm.addSubmitCompleteHandler(new FormPanel.SubmitCompleteHandler() {

    @Override
public void onSubmitComplete(SubmitCompleteEvent event) {
// This is what gets the result back - the content-type *must* be
// text-html
String imageUrl =event.getResults();

    // This ugly workaround apparently manages to detect when the server threw the exception
if (imageUrl.length() == 0) { // file is too large
  uploadFooter.setText(BasicConstants.fileTooLarge);
} else { // file was successfully uploaded
       ...
    } 
```

Eclipse 中的开发模式视图报告了“未捕获的异常”类型的错误，这表明我在检测它方面确实做得不好。

谁能告诉我如何正确捕获异常，以及我使用的解决方法是否有意义？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T17:52:10.977

你的第一次尝试

```
try {
    uploadForm.submit(); // send file to BlobStore, where the doPost method is executed
} catch (Exception ex) {
    GWT.log(ex.toString());
} 
```

不起作用，因为`submit()`不等到浏览器收到响应（这是一个异步调用）。

```
uploadForm.addSubmitCompleteHandler(new FormPanel.SubmitCompleteHandler() {

  @Override
  public void onSubmitComplete(SubmitCompleteEvent event) {
    ... 
```

在这里，您实际上收到了来自服务器的响应。但它是表单提交，而不是 GWT-RPC 调用，所以结果只是纯文本，而不是 GWT Java 对象。

当您在 Servlet 中抛出 RuntimeException 时，服务器将简单地发送带有错误代码的响应（可能是“500”，但最好使用 Firebug 或 Chrome 开发人员工具中的“网络”选项卡来查看实际的响应和响应代码。）因此，在成功的情况下，您将获得 URL，否则响应为空。

### 可能的解决方案

您可以在服务器端捕获异常，并明确发送更好的描述：

```
public void doPost(HttpServletRequest req, HttpServletResponse res)
    throws ServletException, IOException {

  try {

      ...
      if (...) {
        throw new MyTooLargeException();
      } else {
          ...
        res.getWriter().write("ok " + ...);
      }

  } catch (MyTooLargeException e) {
     res.getWriter().write("upload_size_exceeded"); // just an example string 
                                                    // (use your own)

     res.sendError(HttpServletResponse.SC_REQUEST_ENTITY_TOO_LARGE);
  }
} 
```

然后，在客户端，检查

```
"upload_size_exceeded".equals(event.getResults()). 
```

# xpath - xpath 中的嵌套条件 if else 语句

> ID：12977309
> 
> 赞同：9
> 
> 时间：2012-10-19T15:15:02.383
> 
> 标签：xpath, conditional, if-statement, xpath-2.0

我有这个 XML：

```
<property id="1011">
    <leasehold>No</leasehold>
    <freehold>Yes</freehold>
    <propertyTypes>
        <propertyType>RESIDENTIAL</propertyType>
    </propertyTypes>
</property> 
```

我想创建一个与以下嵌套 if-else 伪代码块相同的 xpath 语句。

```
if( propertyTypes/propertyType == 'RESIDENTIAL') {
    if( leasehold == 'Yes' ){
        return 'Rent'
    } else
        return 'Buy'
    }
} else {
    if( leasehold == 'Yes' ){
        return 'Leasehold'
    } else
        return 'Freehold'
    }
} 
```

我已经看到了有关 Becker 方法的一些信息，但我无法真正遵循它。XPath 真的不是我的强项。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-19T15:34:13.533

**I. 在 XPath 2.0 中，只需将其转换为**：

```
 if(/*/propertyTypes/propertyType = 'RESIDENTIAL')
    then
     (if(/*/leasehold='Yes')
       then 'Rent'
       else 'Buy'
     )
     else
       if(/*/leasehold='Yes')
         then 'Leasehold'
         else 'Freehold' 
```

**基于 XSLT 2.0 的验证**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:sequence select=
   "if(/*/propertyTypes/propertyType = 'RESIDENTIAL')
   then
     (if(/*/leasehold='Yes')
       then 'Rent'
       else 'Buy'
     )
     else
       if(/*/leasehold='Yes')
         then 'Leasehold'
         else 'Freehold'
   "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**：

```
<property id="1011">
    <leasehold>No</leasehold>
    <freehold>Yes</freehold>
    <propertyTypes>
        <propertyType>RESIDENTIAL</propertyType>
    </propertyTypes>
</property> 
```

**对 XPath 表达式求值，并将该求值的结果复制到输出中：**

```
Buy 
```

* * *

**二、XPath 1.0 解决方案**

在 XPath 1.0 中没有`if`运算符。

条件语句仍然可以使用单个 XPath 1.0 表达式来实现，但这更加棘手，并且表达式可能不太可读和易于理解。

这是一种通用方式（由 Jeni Tennison 首次提出）`$stringA`在条件为时`$cond`产生`true()`，否则产生`$stringB`：

```
concat(substring($stringA, 1 div $cond), substring($stringB, 1 div not($cond))) 
```

**这个公式的主要成就之一是它适用于任何长度的字符串，并且不需要指定长度**。

**说明**：

在这里，我们根据定义使用以下事实：

```
number(true()) = 1 
```

和

```
number(false()) = 0 
```

然后

```
1 div 0 = Infinity 
```

所以，如果`$cond`是`false`，上面的第一个参数`concat()`是：

```
 substring($stringA, Infinity) 
```

这是空字符串，因为`$stringA` 长度有限。

另一方面，如果`$cond`是，`true()`那么上面的第一个参数`concat()`是：

```
sibstring($stringA, 1) 
```

那只是`$stringA`。

因此，仅取决于`$cond`上述两个参数之一的值`concat()`是一个非空字符串（分别为`$stringA`或`$stringB`）。

将这个通用公式应用于具体问题，我们可以将大条件表达式的前半部分翻译成：

```
concat(
           substring('rent',
                      1 div boolean(/*[leasehold='Yes'
                                     and
                                       propertyTypes/propertyType = 'RESIDENTIAL'
                                      ]
                                  )
                      ),
           substring('buy',
                      1 div not(/*[leasehold='Yes'
                                     and
                                       propertyTypes/propertyType = 'RESIDENTIAL'
                                      ]
                                  )
                      )
               ) 
```

这应该让您了解如何将整个条件表达式转换为单个 XPath 1.0 表达式。

**基于 XSLT 1.0 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:copy-of select=
   "concat(
           substring('rent',
                      1 div boolean(/*[leasehold='Yes'
                                     and
                                       propertyTypes/propertyType = 'RESIDENTIAL'
                                      ]
                                  )
                      ),
           substring('buy',
                      1 div not(/*[leasehold='Yes'
                                     and
                                       propertyTypes/propertyType = 'RESIDENTIAL'
                                      ]
                                  )
                      )
               )
   "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档（上图）时，将评估 XPath 表达式并将此评估的结果复制到输出：**

```
buy 
```

**请注意**：

如果您决定用长度与原始字符串不同的其他字符串替换特定字符串，您只需在上面的 XPath 1.0 表达式中替换这些字符串，您不必担心指定任何长度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:39:11.503

Becker 对您的数据的方法如下：

```
concat(substring('Rent',      1 div boolean(propertyTypes/propertyType ="RESIDENTIAL" and leasehold="Yes")),
       substring('Buy',       1 div boolean(propertyTypes/propertyType ="RESIDENTIAL" and leasehold="No")),
       substring('Leasehold', 1 div boolean(propertyTypes/propertyType!="RESIDENTIAL" and leasehold="Yes")),
       substring('Freehold',  1 div boolean(propertyTypes/propertyType!="RESIDENTIAL" and leasehold="No"))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-11T22:54:25.380

今天花了一整天，但对我有用，这适用于 Xpath 1.0：

```
concat(
substring(properties/property[@name="Headline"], 1, string-length(properties/property[@name="Headline"]) * 1), 
substring(properties/property[@name="Name"], 1, not(number(string-length(properties/property[@name="Headline"]))) * string-length(properties/property[@name="Name"]))
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T15:30:53.643

试试这个

```
if (condition) 
then 
  if (condition) stmnt 
  else stmnt 
else 
  if (condition) stmnt 
  else stmnt 
```

# objective-c - TBXML textForElement 问题

> ID：12977313
> 
> 赞同：1
> 
> 时间：2012-10-19T15:15:12.653
> 
> 标签：objective-c, ios, xml-parsing, html-parsing, tbxml

我正在尝试使用适用于 iOS 的 TBXML 库解析 HTML，并且我想获取这段 HTML 的“更多文本”值：

```
<div> 
 <a href="/url/1">
   <strong>value</strong>
 </a>
 more text
</div> 
```

我已经使用了这段代码，但它似乎不起作用：

```
//Assume that "div" is a TBXMLElement* for this div 
NSString* content = [TBXML textForElement:div];
//Returns @"" when the value @"more text" is expected... 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T09:55:28.647

好的，我已经修改了 TBXML 库并且我已经解决了这个问题......如果有人有同样的问题，试试这个：

1) 在文件 TBXML.h 中为 TBXMLElement 创建一个名为 NSString* afterText 的属性。

2) 在文件 TBXML.m 中搜索此代码并对其进行注释：

```
// if parent element has children clear text
                if (parentXMLElement && parentXMLElement->firstChild)
                    parentXMLElement->text = 0; 
```

3）在步骤1的代码之前写下这段代码：

```
if (parentXMLElement && parentXMLElement->firstChild){

            //if the next string does not content...
            const char * parentNametag =  [[TBXML elementName:parentXMLElement] UTF8String];
            char * finalTag =  (char *)malloc(sizeof("</")+sizeof(parentNametag)+sizeof(">"));
            strcpy(finalTag,"</");
            strcat(finalTag,parentNametag);
            strcat(finalTag,">");

            char * elementTextStart = elementStart;//parentXMLElement->text;
            char * elementTextEnd = elementTextStart;

            elementTextEnd = strstr(elementStart,finalTag);

            if(elementTextEnd != NULL){
                long textLength = strlen(elementTextStart) - strlen(elementTextEnd) ;
                if (textLength > 0){
                    afterTextStart = (char *)malloc(textLength*sizeof(char));
                    memcpy(afterTextStart, elementTextStart,(textLength*sizeof(char)));
                    parentXMLElement->afterText = afterTextStart;
                }
            }

        } 
```

现在属性 "after text" 包含*"more text"*。

这不是一个正统的解决方案，但它对我有用。

# asp.net - 在 Site.Master 中更新登录状态

> ID：12977314
> 
> 赞同：0
> 
> 时间：2012-10-19T15:15:16.407
> 
> 标签：asp.net, session

我正在开发网络应用程序。在此应用程序中，用户需要登录才能执行某些任务。我已经制作了我的自定义登录屏幕。我想让 site.master 的登录状态在用户登录后立即更新，但坦率地说，我不知道该怎么做。

下面的代码取自 login.aspx.cs。当用户单击登录按钮时，将执行以下代码。但我不知道我可以在 site.master 中更新登录状态（包含图片）

```
 protected void Button1_Click(object sender, EventArgs e)
        {
            string user = username.Text;
            string pass = password.Text;
            Session["firstName"] = username.Text;
            localhost.UserRegistration n = new localhost.UserRegistration();

            if (n.checkUser(user, pass))
            {
                Response.Redirect("UserProfile.aspx");
            }
            else
            {
                message1.Text = "UserName or Password is Wrong. Please check your details and login again.";
            } 
```

请[单击此处](http://i49.tinypic.com/33zelqq.jpg)查看图片，以便有人可能对此有所了解。

站点主代码

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site.master.cs" Inherits="SystemSoftware.SiteMaster" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head runat="server">
    <title></title>
    <link href="~/Styles/Site.css" rel="stylesheet" type="text/css" />
    <asp:ContentPlaceHolder ID="HeadContent" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form runat="server">
    <div class="page">
        <div class="header">
            <div class="title">
                <h1>
                    My ASP.NET Application
                </h1>
            </div>
            <div class="loginDisplay">
                <asp:LoginView ID="HeadLoginView" runat="server" EnableViewState="false">
                    <AnonymousTemplate>
                        [ <a href="~/Login.aspx" ID="HeadLoginStatus" runat="server">Log In</a> ]
                    </AnonymousTemplate>
                    <LoggedInTemplate>
                        Welcome <span class="bold"><asp:LoginName ID="HeadLoginName" runat="server" /></span>!
                        [ <asp:LoginStatus ID="HeadLoginStatus" runat="server" LogoutAction="Redirect" LogoutText="Log Out" LogoutPageUrl="~/"/> ]
                    </LoggedInTemplate>
                </asp:LoginView>
            </div>
            <div class="clear hideSkiplink">
                <asp:Menu ID="NavigationMenu" runat="server" CssClass="menu" EnableViewState="false" IncludeStyleBlock="false" Orientation="Horizontal">
                    <Items>

                        <asp:MenuItem NavigateUrl="~/Create Account.aspx" Text="Create Account"/>

                    </Items>
                </asp:Menu>
            </div>
        </div>
        <div class="main">
            <asp:ContentPlaceHolder ID="MainContent" runat="server"/>
        </div>
        <div class="clear">
        </div>
    </div>
    <div class="footer">

    </div>
    </form>
</body>
</html> 
```

**站点.Master.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace SystemSoftware
{
    public partial class SiteMaster : System.Web.UI.MasterPage
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (Session["firstName"] != null)
            {
                HeadLoginView.Visible = false;
            }
            else
            {
                HeadLoginView.Visible = true;

            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:20:19.277

在您的主页加载事件中，检查您在用户登录时创建的会话。如果该会话不为空，则显示注销链接，否则保留该链接登录。在您的主 aspx 中添加 2 个链接 1 用于登录 1 用于注销。

```
protected void Page_Load(object sender, EventArgs e)
        {

            if (Session["Username"]!=null && Session["Username"]!=String.Empty)
            {
               lnkLogin.visible = false;
               lnkLogout.visible = true;
            }else{
               lnkLogin.visible = true;
               lnkLogout.visible = false;
            }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:23:13.380

您还可以从本地页面更改母版页上控件的属性，也喜欢

字符串 a = ((LinkBut​​ton)Master.FindControl("LinkLogIn")).Text

以同样的方式，您也可以修改任何其他属性

# grails - javax.servlet.ServletException：过滤器 [sitemesh]：将 grails 2.11 应用程序部署到 WebSphere 8.5 自由配置文件时无法初始化？

> ID：12977319
> 
> 赞同：3
> 
> 时间：2012-10-19T15:15:27.397
> 
> 标签：grails, websphere, websphere-liberty

当我尝试将我的 grails 应用程序部署到 WebSphere 8.5 liberty 配置文件服务器时，我收到以下错误消息。

```
Error Message: javax.servlet.ServletException: Filter [sitemesh]: could not be initialized 
```

我已经为我的应用程序设置了一个父类最后一个类加载策略。相同的war文件部署到位于同一服务器上的tomcat没有问题。关于可能导致此问题的原因以及如何解决此问题的任何想法？我在下面粘贴了完整的堆栈跟踪。

```
错误页面异常
SRVE0260E: 服务器无法使用为您的应用程序指定的错误页面来处理下面打印的原始异常。

原始例外：
错误消息：javax.servlet.ServletException：过滤器 [sitemesh]：无法初始化
错误代码：500
目标 Servlet：com.ibm.ws.webcontainer.extension.DefaultExtensionProcessor
错误堆栈：
com.opensymphony.module.sitemesh.factory.FactoryException：无法初始化DecoratorMapper：org.codehaus.groovy.grails.web.sitemesh.GrailsLayoutDecoratorMapper：org.springframework.beans.factory.NoSuchBeanDefinitionException：没有定义名为“groovyPageLayoutFinder”的bean
     在 com.opensymphony.module.sitemesh.factory.BaseFactory.pushDecoratorMapper(BaseFactory.java:117)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadDecoratorMappers(Grails5535Factory.java:231)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadConfig(Grails5535Factory.java:98)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.(Grails5535Factory.java:66)
     在 org.codehaus.groovy.grails.web.sitemesh.GrailsPageFilter.init(GrailsPageFilter.java:83)
     在 com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.init(FilterInstanceWrapper.java:142)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager._loadFilter(WebAppFilterManager.java:579)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.loadFilter(WebAppFilterManager.java:480)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterInstanceWrapper(WebAppFilterManager.java:299)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterChain(WebAppFilterManager.java:372)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:903)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1036)
     在 com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:4173)
     在 com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:302)
     在 com.ibm.ws.webcontainer.osgi.DynamicVirtualHost.handleRequest(DynamicVirtualHost.java:296)
     在 com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:1006)
     在 com.ibm.ws.webcontainer.osgi.DynamicVirtualHost$1.run(DynamicVirtualHost.java:253)
     在 com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink$TaskWrapper.run(HttpDispatcherLink.java:457)
     在 com.ibm.ws.threading.internal.Worker.executeWork(Worker.java:398)
     在 com.ibm.ws.threading.internal.Worker.run(Worker.java:380)
     在 java.lang.Thread.run(Thread.java:722)
     根本原因：
     org.springframework.beans.factory.NoSuchBeanDefinitionException：没有定义名为“groovyPageLayoutFinder”的bean
     在 org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:553)
     在 org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1095)
     在 org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:277)
     在 org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
     在 org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1102)
     在 org.codehaus.groovy.grails.web.sitemesh.GrailsLayoutDecoratorMapper.init(GrailsLayoutDecoratorMapper.java:48)
     在 com.opensymphony.module.sitemesh.factory.BaseFactory.pushDecoratorMapper(BaseFactory.java:110)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadDecoratorMappers(Grails5535Factory.java:231)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadConfig(Grails5535Factory.java:98)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.(Grails5535Factory.java:66)
     在 org.codehaus.groovy.grails.web.sitemesh.GrailsPageFilter.init(GrailsPageFilter.java:83)
     在 com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.init(FilterInstanceWrapper.java:142)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager._loadFilter(WebAppFilterManager.java:579)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.loadFilter(WebAppFilterManager.java:480)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterInstanceWrapper(WebAppFilterManager.java:299)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterChain(WebAppFilterManager.java:372)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:903)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1036)
     在 com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:4173)
     在 com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:302)
     在 com.ibm.ws.webcontainer.osgi.DynamicVirtualHost.handleRequest(DynamicVirtualHost.java:296)
     在 com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:1006)
     在 com.ibm.ws.webcontainer.osgi.DynamicVirtualHost$1.run(DynamicVirtualHost.java:253)
     在 com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink$TaskWrapper.run(HttpDispatcherLink.java:457)
     在 com.ibm.ws.threading.internal.Worker.executeWork(Worker.java:398)
     在 com.ibm.ws.threading.internal.Worker.run(Worker.java:380)
     在 java.lang.Thread.run(Thread.java:722)

错误页面异常：
错误消息：javax.servlet.ServletException：过滤器 [sitemesh]：无法初始化
错误代码：0
目标小服务程序：
错误堆栈：
com.opensymphony.module.sitemesh.factory.FactoryException：无法初始化DecoratorMapper：org.codehaus.groovy.grails.web.sitemesh.GrailsLayoutDecoratorMapper：org.springframework.beans.factory.NoSuchBeanDefinitionException：没有定义名为“groovyPageLayoutFinder”的bean
     在 com.opensymphony.module.sitemesh.factory.BaseFactory.pushDecoratorMapper(BaseFactory.java:117)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadDecoratorMappers(Grails5535Factory.java:231)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadConfig(Grails5535Factory.java:98)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.(Grails5535Factory.java:66)
     在 org.codehaus.groovy.grails.web.sitemesh.GrailsPageFilter.init(GrailsPageFilter.java:83)
     在 com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.init(FilterInstanceWrapper.java:142)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager._loadFilter(WebAppFilterManager.java:579)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.loadFilter(WebAppFilterManager.java:480)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterInstanceWrapper(WebAppFilterManager.java:299)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterChain(WebAppFilterManager.java:372)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:906)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1036)
     在 com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.dispatch(WebAppRequestDispatcher.java:1383)
     在 com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.forward(WebAppRequestDispatcher.java:191)
     在 com.ibm.ws.webcontainer.webapp.WebApp.sendError(WebApp.java:3650)
     在 com.ibm.ws.webcontainer.webapp.WebApp.handleException(WebApp.java:4203)
     在 com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:4184)
     在 com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:302)
     在 com.ibm.ws.webcontainer.osgi.DynamicVirtualHost.handleRequest(DynamicVirtualHost.java:296)
     在 com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:1006)
     在 com.ibm.ws.webcontainer.osgi.DynamicVirtualHost$1.run(DynamicVirtualHost.java:253)
     在 com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink$TaskWrapper.run(HttpDispatcherLink.java:457)
     在 com.ibm.ws.threading.internal.Worker.executeWork(Worker.java:398)
     在 com.ibm.ws.threading.internal.Worker.run(Worker.java:380)
     在 java.lang.Thread.run(Thread.java:722)
     根本原因：
     org.springframework.beans.factory.NoSuchBeanDefinitionException：没有定义名为“groovyPageLayoutFinder”的bean
     在 org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:553)
     在 org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1095)
     在 org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:277)
     在 org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
     在 org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1102)
     在 org.codehaus.groovy.grails.web.sitemesh.GrailsLayoutDecoratorMapper.init(GrailsLayoutDecoratorMapper.java:48)
     在 com.opensymphony.module.sitemesh.factory.BaseFactory.pushDecoratorMapper(BaseFactory.java:110)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadDecoratorMappers(Grails5535Factory.java:231)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.loadConfig(Grails5535Factory.java:98)
     在 org.codehaus.groovy.grails.web.sitemesh.Grails5535Factory.(Grails5535Factory.java:66)
     在 org.codehaus.groovy.grails.web.sitemesh.GrailsPageFilter.init(GrailsPageFilter.java:83)
     在 com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.init(FilterInstanceWrapper.java:142)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager._loadFilter(WebAppFilterManager.java:579)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.loadFilter(WebAppFilterManager.java:480)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterInstanceWrapper(WebAppFilterManager.java:299)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.getFilterChain(WebAppFilterManager.java:372)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:906)
     在 com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1036)
     在 com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.dispatch(WebAppRequestDispatcher.java:1383)
     在 com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.forward(WebAppRequestDispatcher.java:191)
     在 com.ibm.ws.webcontainer.webapp.WebApp.sendError(WebApp.java:3650)
     在 com.ibm.ws.webcontainer.webapp.WebApp.handleException(WebApp.java:4203)
     在 com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:4184)
     在 com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:302)
     在 com.ibm.ws.webcontainer.osgi.DynamicVirtualHost.handleRequest(DynamicVirtualHost.java:296)
     在 com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:1006)
     在 com.ibm.ws.webcontainer.osgi.DynamicVirtualHost$1.run(DynamicVirtualHost.java:253)
     在 com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink$TaskWrapper.run(HttpDispatcherLink.java:457)
     在 com.ibm.ws.threading.internal.Worker.executeWork(Worker.java:398)
     在 com.ibm.ws.threading.internal.Worker.run(Worker.java:380)
     在 java.lang.Thread.run(Thread.java:722)

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T14:43:00.270

WebSphere 8.5 Liberty Profile 在部署时不会扩展 WAR，令人惊讶的是，相当多的 Web 应用程序严重依赖该特性。这就是导致你的案子的原因。

我很确定您将 Grails Web 应用程序部署为 WAR。

解决方案非常简单 - 部署扩展的 Web 应用程序，问题就消失了。

为了证明我的想法，我运行了[2.3 创建应用程序](http://grails.org/doc/latest/guide/gettingStarted.html#creatingAnApplication)中的示例。当我部署它时，您遇到的错误消息确实显示在浏览器和日志中。

```
jacek:~/sandbox/helloworld
$ cp target/helloworld-0.1.war ~/apps/wlp/usr/servers/libertyGrails/dropins/ 
```

但是，当它询问是否扩展了 Web 存档时，您忽略了日志中的那一行。

> 原因：java.io.FileNotFoundException：ServletContext 资源 [/WEB-INF/grails-app/i18n/messages.properties] 无法解析为绝对文件路径 - Web 应用程序存档未展开？... 20 更多

`rm`我重新部署了 Web 应用程序（之后只是一个`unzip -d`），欢迎页面正确显示。

```
jacek:~/sandbox/helloworld
$ rm ~/apps/wlp/usr/servers/libertyGrails/dropins/helloworld-0.1.war
jacek:~/sandbox/helloworld
$ unzip -d ~/apps/wlp/usr/servers/libertyGrails/dropins/helloworld-0.1.war target/helloworld-0.1.war
jacek:~/sandbox/helloworld
$ open http://localhost:9080/helloworld-0.1 
```

# php - 如何让 PHP 访问 COM 对象？

> ID：12977320
> 
> 赞同：2
> 
> 时间：2012-10-19T15:15:29.143
> 
> 标签：php, com

我在我的本地 Windows 7 笔记本电脑上运行 PHP 5.3（在我们的开发服务器上尝试了这一切但没有成功，所以我试着看看我是否可以先让它在我的笔记本电脑上成功运行）。当我调用以下脚本时：

```
$objAltovaXML = new COM('AltovaXML.Application'); 
```

我得到错误：

> 未捕获的异常“com_exception”和消息“无法创建 COM 对象‘AltovaXML.Application’：访问被拒绝。

我已经使用我在 StackOverflow 其他地方找到的 PowerShell 脚本进行了检查，并确认 AltovaXML.Application 已正确注册。

但是如何让我的 PHP 脚本访问它呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:26:54.850

虽然它应该可以工作，但我只需在 COM 对象周围包装一个脚本并通过[exec](http://php.net/manual/en/function.exec.php)调用该脚本。为您省去了很多麻烦，并且易于单独调试并了解到底发生了什么。

# c++ - 如何在 PhysX 中“重用”注册对象？

> ID：12977332
> 
> 赞同：3
> 
> 时间：2012-10-19T15:16:21.203
> 
> 标签：c++, physx

我的问题是我想在场景中重用对象。

主要是我想在另一个位置使用注册的actor（在PhysX中）和它的数据，但不想在GPU上分配新的内存。

我无法弄清楚我必须设置哪些链接或指针才能达到我的目标。

有没有人有关于这个问题的提示？是否有可能复制 PxActor？

# c# - 多线程并将数据传递给新线程

> ID：12977334
> 
> 赞同：0
> 
> 时间：2012-10-19T15:16:26.640
> 
> 标签：c#, multithreading

我正在编写的应用程序存在一些问题。它的工作是使用线程解决迷宫。一个线程开始，并且对于每个分叉，它调用另一个类中的静态方法，传递另一个线程需要的参数，然后为每个路径启动线程。我的输出都搞砸了，我不确定这是多线程问题还是引用有问题。下面是一些代码（每个线程都有一个`Explorer`类的新实例）：

这是`Run()`每个线程的方法：

```
public void Explore()
{
    while (ImDone == false)
    {
        Move();
        if (ActualPosition[0] != Labyrinth.ExitPoint[0] || 
            ActualPosition[1] !=   Labyrinth.ExitPoint[1]) //I'm not at the end..
        continue;

        PrintMyStatus(); //Print in the console my parents and my complete route..
        break;
    } 
```

这是`Move()`方法：

```
List<int[]> validPaths = CheckSurroundings(); //returns a list of paths

switch (validPaths.Count)
{
    case 0:
        ImDone = true; //No more routes available
        break;
    case 1:
        MarkMyPosition(validPaths); //Change internal variables to the only new path
        break;
    default:
        lock(this) //As this involves thread creating I locked it..
        {
            //Creating deep copies of my "History" so my childs can have them..
            List<int[]> DCValidPaths = DeepCopy(validPaths);
            List<string> DCMyParents = DeepCopy(MyParents);
            string[,] DCMyExplorationMap = DeepCopy(MyExplorationMap);
            List<int[]> DCMyPositions = DeepCopy(MyPositions); 

            foreach (var path in validPaths)
            {
                DCMyParents.Add(Thread.CurrentThread.Name); //Adding myself as a parent

                ExplorationManager.ExplorerMaker(
                    DCValidPaths, 
                    DCMyParents, 
                    DCMyExplorationMap, 
                    DCMyPositions,
                    ID);  //Threads are created in the static class
            }
         }
    break;
} 
```

我`DeepCopy()`使用的方法是[这个](https://stackoverflow.com/questions/129389/how-do-you-do-a-deep-copy-an-object-in-net-c-specifically)问题的公认答案中的一种。为了解决问题，我很乐意提供任何其他需要的信息。在此先感谢您的帮助。

编辑：我的问题基本上在于：我有一个`OutOfMemoryException`in`Thread.Start()`子句，线程显示的路径包含损坏的数据（位置不正确）。我测试了该`CheckSurroundings()`方法，到目前为止只返回正确的位置（迷宫包含在二维字符串数组中）。

这是`Explorer`该类的构造函数：

```
public Explorer(List<string> myParents, int[] actualPosition, string[,]   myExplorationMap, 
        List<int[]> myPositions, int ID)
    {
        //Here I pass the data specified in Move(); 
        MyParents = myParents;
        ActualPosition = actualPosition;
        MyExplorationMap = myExplorationMap;
        MyPositions = myPositions;
        this.ID = ID + 1; //An ID for reference

        //Marking position in my map with "1" so I know I've been here already,
        //and adding the position given to my list of positions
        MyExplorationMap[ActualPosition[0], ActualPosition[1]] = "1";
        MyPositions.Add(DeepCopy(ActualPosition));
    } 
```

这是创建线程的类：

```
public static class ExplorationManager
{
    public static void ExplorerMaker(List<int[]> validPaths, List<string> myParents, string[,] myExplorationMap, List<int[]> myPositions, int ID)
    {
        foreach (var thread in validPaths.Select
            (path => new Explorer(myParents, path, myExplorationMap, myPositions,ID)).
            Select(explorer => new Thread(explorer.Explore)))
        {
            thread.Name = "Thread of " + ID + " generation"; 
            thread.Start(); //For each Path in Valid paths, create a new instance of Explorer and assign a thread to it.
        }
    }
} 
```

以及返回 ValidPaths 的方法

```
 private List<int[]> CheckSurroundings()
    {

        var validPaths = new List<int[]>();
        var posX = ActualPosition[0];
        var posY = ActualPosition[1];

        for (var dx = -1; dx <= 1; dx++)
        {
            if (dx == 0 || (posX + dx) < 0 || (posX + dx) >= Labyrinth.Size ||
                MyExplorationMap[posX + dx, posY] == "1") continue;
            var tempPos = new int[2];
            tempPos[0] = posX + dx;
            tempPos[1] = posY;
            validPaths.Add(tempPos);
        }

        for (var dy = -1; dy <= 1; dy++)
        {
            if (dy == 0 || (posY + dy) < 0 || (posY + dy) >= Labyrinth.Size ||
                MyExplorationMap[posX, posY + dy] == "1") continue;
            var tempPos = new int[2];
            tempPos[0] = posX;
            tempPos[1] = posY + dy;
            validPaths.Add(tempPos);
        }
        //This method checks up, down, left, right and returns the posible routes as `int[]` for each one
        return validPaths;
    } 
```

CheckSurroundings 使用传递给孩子的深层副本（通过构造函数）来验证他可以采取的路线。它不是为了改变父母的副本，因为他现在处于迷宫的另一条路径中。孩子只需要更新信息（通过构造函数传递），直到他们“分开”为止。而且每个孩子都必须独立于其他孩子。这就是我想要做的。但我不确定出了什么问题，也许是并发问题？请帮忙。如果您还需要什么，请告诉我。——</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:52:59.227

编辑您的更新：

myExplorationMap 是原始探索地图的深层副本。您在 Explorer 构造函数中将位置设置为 1，这会更新所有子线程共享的副本，但不会更新父线程中的原始 MyExplorationMap 属性。只有子线程会知道这个位置被访问过。我假设这是在 CheckSurroundings 方法的某处使用的？

# ruby - 将字符串分成不等长

> ID：12977335
> 
> 赞同：1
> 
> 时间：2012-10-19T15:16:27.943
> 
> 标签：ruby

我想将一个字符串分成大小不等的块（由 给出`lens`）。我的代码有效，但感觉不像是惯用的 Ruby。有什么建议么？

```
s = "red   4827spoon       jimmy john   "
lens = [6, 4, 12, 13]
i = 0
row = lens.collect {|len|
  i += len
  s[i-len, len].strip
} 
```

给

```
["red", "4827", "spoon", "jimmy john"] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:31:39.820

这可能效率较低，因为它会大量修改原始字符串，但是如何：

```
row = lengths.collect { |n| s.slice!(0..(n-1)).strip } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:54:10.600

```
s = "red   4827spoon       jimmy john   "
lens = [6, 4, 12, 13]
p s.unpack(lens.map{ |i| "A#{i}" }.join) #=>["red", "4827", "spoon", "jimmy john"]
p s.unpack(lens.map(&"A%d".method(:%)).join) #=> ["red", "4827", "spoon", "jimmy john"] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T22:57:10.753

我更喜欢 Victor 的解包解决方案，尽管对于许多 rubies 来说它们可能有点晦涩难懂。 `inject`可能有点平淡：

```
lens.inject([0]) {|spans,len|
  start = spans.pop
  spans << s[start,len].strip << start+len
}[0...-1] 
```

# c# - 在 asp.net Web 应用程序中处理用户上传文件的标准做法

> ID：12977336
> 
> 赞同：9
> 
> 时间：2012-10-19T15:16:41.293
> 
> 标签：c#, asp.net, file-upload

这是我第一次为处理用户上传的文件而构建 Web 应用程序，我对通常如何完成此操作有一些疑问：

1.  是否有任何我必须考虑的安全问题？要处理的文件本质上是我的应用程序将逐行读取的文本文件。我应该限制文件上传扩展名和/或我应该考虑其他任何预防措施吗？

2.  上传文件的最佳组织方法是什么？这些文件不需要永久存储在我的应用程序中，所以我应该将它们转储到一般的“数据”文件夹中并删除不再需要的任何内容吗？

3.  构建具有我错过的类似功能的 Web 应用程序是否还有其他重要方面？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T15:24:19.777

1.  您必须注意的唯一安全问题是将原始文本（没有数据清理以防止 SQL 注入）插入数据库。如果不涉及数据库，则应该没问题。至于扩展，限制扩展确实是一个糟糕的顶级过滤器。拥有它很好，但它只是深入了解文件真正包含的内容。文件大小限制也会有所帮助。

2.  大量事务保存到磁盘的成本可能很高，但另一方面，随着使用更多请求/更多线程，它会减少服务器内存的混乱。您也可以使用内存中的文件，但对于大文件，它最终可能是有害的。考虑您正在使用的内容并选择最佳方法。

3.  定义一个超时时间，这样上传的大文件就不会占用不必要的服务器进程，但最终还是太大了。

我假设您正在使用 ASP.NET 的`FileUpload`控件。请记住，文件不会通过回发保留（以防止安全漏洞），因此用户必须在每次请求页面时继续浏览文件。如果您有服务器端验证器，这会很麻烦。

* * *

*编辑回答评论：*

通过在内存中工作，我说的是纯粹通过代码操作上传的文件，而不是将其物理保存在服务器的磁盘上。

例如，如果您使用的是`FileUpload`控件，则可以通过 Stream 对象`FileUpload.FileContent`或作为字节数组`FileUpload.FileBytes`( [API Reference](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.fileupload.aspx) ) 访问用户文件。因为那是`Stream`您可以即时读取文件而无需先保存它。

**标记：**

```
<asp:FileUpload ID="fileUploadControl" ToolTip="Upload a file" runat="server" /> 
```

**代码隐藏：**

```
If fileUploadControl.HasFile AndAlso _
   (fileUploadControl.FileName.ToLower().EndsWith(".txt") OrElse _
    fileUploadControl.ToLower().FileName.EndsWith(".dat")) Then
    SaveThisToDataBase(fileUploadControl.FileName, fileUploadControl.FileBytes)
End If 
```

看？根本不需要保存到磁盘。`fileUploadControl.FileBytes`包含上传数据的字节数组。

如果您想保存到文件，那么您可以使用流写入磁盘。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:21:38.937

我不知道我的答案有多“标准”，但这是我在进行类似设置时所做的：

*   我将文件扩展名限制为少数文件类型，只是为了更难上传坏文件。这很容易规避，但至少这是恶意用户必须采取的又一步。

*   我必须将 IIS 下的 IUSR 帐户的写入权限添加到我存储文件的文件夹中。此文件夹是我的应用程序根文件夹的子文件夹。

*   我必须处理很多文件，所以我每个月都创建了一个新的子文件夹，例如`Uploaded\012012`,`Uploaded\022012`等。这使得文件访问速度更快，因为每个文件夹中只有几百个文件。我将每次上传都存储在数据库中，并有一个定期清理文件系统的计划任务。这也删除了旧的空文件夹。

正如我所说，我不知道这是否是标准的（或者即使它是一个非常好的做法），但它在我使用它的环境中运行良好。

# java - 不适用于 localhost 的 Java RMI 示例

> ID：12977337
> 
> 赞同：0
> 
> 时间：2012-10-19T15:16:43.567
> 
> 标签：java, rmi

我正在尝试使用 RMI 编写一个用于客户端/服务器通信的程序，这个主题对我来说是新的。我查看了大量示例，看看我是否可以尝试理解它，它们似乎都是使用本地主机设计的。我的程序不会在本地主机上运行，​​它将连接到完全不同的机器服务器。

如果有人能向我展示一个简单的例子，说明如何使用 RMI 在两台不同的机器之间建立连接，那就太棒了。我不需要看它是如何为 localhost 完成的，我已经看到了数百万个。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T07:21:02.593

假设我们正在连接两个系统，IP 地址为 192.168.1.2 的 A（服务器）和 IP 地址为 192.168.1.3 的 B（客户端）。您应该在服务器（即系统 A）上启动注册表，然后服务器程序应该像这样绑定对象

```
Naming.rebind("rmi://192.168.1.2/myObject",obj); 
```

然后在具有查找功能的系统B上编译客户端程序

```
myInterface objHandle = (myInterface)Naming.lookup("rmi://192.168.1.2/myObject"); 
```

主要问题是两个系统必须在同一个网络上进行通信，您可能必须创建自己的网络。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:40:55.933

您只需要更改客户端。

将其 Naming.lookup() 字符串从“localhost”更改为服务器的主机名或 IP 地址。bind() 或 rebind() 调用中的服务器命名字符串不会从“localhost”更改，因为服务器及其注册表始终位于同一主机上。

如果您使用 Registry 而不是 Naming，那么您只需更改客户端的 LocateRegistry.getRegistry() 调用。

# regex - 将正则表达式选项传递给 PowerShell [regex] 类型

> ID：12977338
> 
> 赞同：9
> 
> 时间：2012-10-19T15:16:44.930
> 
> 标签：regex, powershell, case-insensitive

我使用下面的正则表达式代码捕获了两个匹配的组：

```
[regex]$regex = "^([0-9]{1,20})(b|kb|mb|gb|tb)$"

$matches = $regex.match($minSize)

$size=[int64]$matches.Groups[1].Value
$unit=$matches.Groups[2].Value 
```

我的问题是我想让它不区分大小写，并且我不想使用正则表达式修饰符。

我知道您可以在 .NET 中传递正则表达式选项，但我不知道如何使用 PowerShell 来做同样的事情。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2018-09-14T16:55:16.673

[`[Regex]::Match()`](https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.match)允许以`[RegexOptions]`编程方式提供所需的静态方法的重载：

```
# You can combine several options by doing a bitwise or:
$options = [Text.RegularExpressions.RegexOptions]::IgnoreCase -bor [Text.RegularExpressions.RegexOptions]::CultureInvariant
# or by letting casting do the magic:
$options = [Text.RegularExpressions.RegexOptions]'IgnoreCase, CultureInvariant'

$match = [regex]::Match($input, $regex, $options) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-19T15:25:21.587

尝试使用 -match 代替。例如，

```
$minSize = "20Gb"
$regex = "^([0-9]{1,20})(b|kb|mb|gb|tb)$"
$minSize -match $regex #Automatic $Matches variable created
$size=[int64]$Matches[1]
$unit=$Matches[2] 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-19T15:23:42.693

请改用 PowerShell 的 -match 运算符。默认情况下不区分大小写：

```
$minSize -match '^([0-9]{1,20})(b|kb|mb|gb|tb)$' 
```

对于区分大小写的匹配，请使用 -cmatch。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-03-24T15:56:39.780

使用`[regex]`类型加速器后，Options 属性为 ReadOnly 且无法更改。但是您可以使用 RegexOptions 参数调用构造函数：

```
$regex = [System.Text.RegularExpressions.Regex]::new('^([0-9]{1,20})(b|kb|mb|gb|tb)$','IgnoreCase') 
```

要传递多个选项，请对基础值使用按位或运算符：

```
$regex = [regex]::new('^([0-9]{1,20})(b|kb|mb|gb|tb)$',[System.Text.RegularExpressions.RegexOptions]::Multiline.value__ -bor [System.Text.RegularExpressions.RegexOptions]::IgnoreCase.value__) 
```

但简单的加法似乎也有效：

```
[System.Text.RegularExpressions.RegexOptions]::Multiline + System.Text.RegularExpressions.RegexOptions]::IgnoreCase 
```

它甚至可以在提供数字标志 (35 = IgnoreCase=1 + MultiLine=2 + IgnorePatternWhitespace=32) 时工作​​，尽管直接依赖枚举值通常不是最佳实践：

```
$regex = [regex]::new('^([0-9]{1,20})(b|kb|mb|gb|tb)$',36)
$regex.Options 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-05T12:13:31.530

您还可以在您的正则表达式中包含[模式修饰符](https://www.regular-expressions.info/modifiers.html)，就像`(?i)`这样（cmatch 强制区分大小写匹配）：

```
PS H:\> 'THISISSOMETHING' -cmatch 'something'
False
PS H:\> 'THISISSOMETHING' -cmatch '(?i)something'
True 
```

# android - 将复选框添加到列表视图后，列表视图侦听器不响应单击

> ID：12977339
> 
> 赞同：0
> 
> 时间：2012-10-19T15:16:46.287
> 
> 标签：android, android-listview, android-checkbox

我在 Listview 中添加了一个复选框，并设法使用自定义适配器获取复选框侦听器。一切正常，除了列表视图项单击侦听器根本没有得到关注。

这是我的代码：

```
public class MyCursorAdapter extends SimpleCursorAdapter {

private Cursor c;
private Context context;
int selectCount;

public MyCursorAdapter(Context context, int layout, Cursor c,
        String[] from, int[] to) {
    super(context, layout, c, from, to);
    this.c = c;
    this.context = context;

}

public View getView(int pos, View inView, ViewGroup parent) {
    View v = inView;
    if (v == null) {
        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = inflater.inflate(R.layout.row_bookmark, null);
    }
    c.moveToFirst();

    c.moveToPosition(pos);

    TextView title = (TextView) v.findViewById(R.id.title);
    title.setText(this.c.getString(this.c.getColumnIndex("title")));
    TextView details = (TextView) v.findViewById(R.id.details);
    details.setText(this.c.getString(this.c.getColumnIndex("date")));

    final CheckBox cb = (CheckBox) v.findViewById(R.id.checkBox1);
    cb.setOnCheckedChangeListener(new OnCheckedChangeListener() {

        public void onCheckedChanged(CompoundButton buttonView,
                boolean isChecked) {

            if (cb.isChecked()) {
                if (cb.isClickable()) {
                    selectCount = selectCount + 1;
                }
            } else if (!cb.isChecked()) {
                if (cb.isClickable()) {
                    if (selectCount > 0)
                        selectCount--;
                }
            }

            // if any item is checked display the actionMode
            if (selectCount == 1) {
                BookmarkActivity.startmode();
            }
            if (selectCount == 0) {
                BookmarkActivity.stopmode();
            }
            if (selectCount != 0)
                BookmarkActivity.mMode.setTitle(selectCount + "    selected");
        }

    });
return (v);
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:18:48.547

您可以尝试在声明复选框的 XML 中添加以下行：

```
 android:focusable="false" 
```

我自己也遇到过这种情况，在禁用焦点后一切正常。

让我知道它是否适合你。

# ruby - 带有会话和并发访问的 Sinatra 测试

> ID：12977341
> 
> 赞同：1
> 
> 时间：2012-10-19T15:16:51.960
> 
> 标签：ruby, session, sinatra, rack

我想写一些测试来同时访问我的小 sinatra 应用程序。

这里的问题是，我使用会话（通过 Rack::Session::Pool）。我不知道如何让 rack-test 产生一个新会话。当我在请求中注入会话数据时，我总是以一个会话结束。所以我基本上一次只能有1个会话。

在我的测试中，我尝试了以下方法：

```
threads = []
2.times do |index|
  threads << Thread.new do
    get "/controller/something", {}, "rack.session" => {:id => "Thread#{index}"}
    post "/do_action"
  end
end
thrads.each{|t| t.join} 
```

是否有某种“我可以有多个实例的浏览器层”？

编辑：对不起，我必须澄清：线程示例只是获得新会话的疯狂猜测。它没有用。所以我只是在寻找一种在运行（测试）服务器上打开多个会话的方法。在开发模式下，我可以打开一个新的浏览器会话来实现这样的事情。在测试模式下，我目前迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-03T02:54:41.420

这是一个使用带有 Spec 语法扩展的 MiniTest 的工作示例。

```
# using MiniTest::Spec extensions
# http://bfts.rubyforge.org/minitest/MiniTest/Spec.html

describe 'Fun with Sinatra and multiple sessions' do
  include Rack::Test::Methods

  def app
    Sinatra::Application
  end

  it "does some stuff with multiple sessions" do
    sess1 = Rack::Test::Session.new(Rack::MockSession.new(app))
    sess2 = Rack::Test::Session.new(Rack::MockSession.new(app))
    sess1.wont_equal sess2

    sess1.get '/' # or whatever
    sess1.last_response.must_equal :ok?

    sess2.get '/' # or whatever
    sess2.last_response.must_equal :ok?
  end

  it "this does the same thing" do
    sess2 = Rack::Test::Session.new(Rack::MockSession.new(app))

    get '/' # or whatever
    last_response.must_equal :ok?

    sess2.get '/' # or whatever
    sess2.last_response.must_equal :ok?

  end

end 
```

# asp.net - 无法使用 SQL Server 2008 R2 配置 SSRS 自定义身份验证扩展

> ID：12977344
> 
> 赞同：2
> 
> 时间：2012-10-19T15:16:55.820
> 
> 标签：asp.net, sql-server-2008-r2, ssrs-2008, reporting-services

我一直致力于将 SSRS 与我们的 Web 应用程序进行 SSO 集成，但我无法让它工作。我遵循了 MSFT 的 Clife Green 的这个例子，但仍然无法让它工作：

[Reporting Services 单点登录 (SSO) 身份验证 - 第 1 部分](http://blogs.msdn.com/b/cliffgreen/archive/2011/03/29/reporting-services-single-sign-on-sso-authentication-part-1.aspx)

[Reporting Services 单点登录 (SSO) 身份验证 - 第 2 部分](http://blogs.msdn.com/b/cliffgreen/archive/2011/04/06/reporting-services-single-sign-on-sso-authentication-part-2.aspx)

我搜索了互联网并搜索了[MSDN](http://msdn.microsoft.com/en-us/library/cc281383%28v=sql.105%29.aspx)文档，但仍然无法正常工作。我不断收到的错误是在示例代码的 GetWebResponse 中引发的：

```
Authorization ticket not received by LogonUser 
```

我可以通过来回传递我自己的 cookie 并检查它，同时忽略 SSRS 管理的 cookie，但我所做的所有调用都返回为未经身份验证，因为我没有使用返回的 SSRS 会话令牌LogonUser 可以在此处的响应中找到：

```
response.Headers["RSAuthenticationHeader"] 
```

但是，即使我的 Web 服务调用继续工作，报告管理器也没有工作并返回此错误：

```
StringStartsWith can't accept null parameters 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T15:16:55.820

这是一个艰难的过程，而且关于我遇到的问题的信息并不多。有几件事不对劲。

**问题 #1：**报告经理给了我这个错误：

```
StringStartsWith can't accept null parameters 
```

**解决方案 #1：**在 SSRS 中实现自定义或表单身份验证时需要该`<loginUrl>`标记。

我必须修改 RSReportServer.Config 文件以将我的登录页面添加到`<loginUrl>`标签中。一旦我添加了这个并实现了登录页面（请参阅示例中的 UILogin.aspx），我不再收到 StringStartsWith 错误。

文件位置：*C:\Program Files\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\Reporting Services\ReportServer\RSReportServer.Config*

```
<UI>
    <ReportServerUrl></ReportServerUrl>
    <PageCountMode>Estimate</PageCountMode>
    <CustomAuthenticationUI>
        <loginUrl>[YourUrl]</loginUrl>
        <UseSSL>False</UseSSL>
        <PassThroughCookies>
             <PassThroughCookie>[YourSSOCookieName]</PassThroughCookie>
        </PassThroughCookies>
    </CustomAuthenticationUI>
</UI> 
```

**问题 2：**报告管理器和我的登录页面无休止地相互重定向。

这个问题是因为另外两个问题。

**解决方案 #2A：** SSRS 报告管理器需要知道 cookie 的名称以用于其授权票证。

首先，我必须修改报表服务器的 Web.Config 并告诉它用于授权票证的 cookie 的名称。我`sqlAuthCookie`在下面的例子中使用过。

文件位置：*C:\Program Files\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\Reporting Services\ReportServer\Web.Config*

改变：

```
 <authentication mode="Forms">
      <forms loginUrl="[YourUrl]" name="sqlAuthCookie" requireSSL="false" />
  </authentication> 
```

**解决方案 #2B：** SQL Server 2008 R2 有一个错误 - 服务补丁 2 修复了它。

由于 SQL Server 2008 R2 在处理 cookie 的方式中引入了一个错误，我仍然收到了无休止的重定向。简而言之，来自 Report Manager 的响应会告诉您的应用程序响应标头中的 SSRS 身份验证 cookie 的名称：

```
string cookieName = response.Headers["RSAuthenticationHeader"] 
```

当我在这里设置断点时，我注意到 cookie 名称实际上是这样的：

```
sqlAuthCookie,sqlAuthCookie 
```

我做了一些搜索，发现了这个问题：[SQL Server 2008 R2 (November CTP)。表单身份验证在 SSRS 中不起作用](http://connect.microsoft.com/SQLServer/feedback/details/533197/sql-server-2008-r2-november-ctp-forms-authentication-not-working-in-ssrs)

下载并安装[SQL Server 2008 R2 SP2](http://www.microsoft.com/en-us/download/details.aspx?id=30437)为我解决了这个问题，现在我的解决方案有效！

注意：您可以只安装它而不是 SP：[SQL Server 2008 R2 的累积更新包 5](http://support.microsoft.com/kb/2438347)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-31T17:37:13.123

这里是配置表单身份验证的详细说明[http://www.codeproject.com/Articles/675943/SSRS-2012-Forms-Authentication](http://www.codeproject.com/Articles/675943/SSRS-2012-Forms-Authentication)

# sql-server - T-SQL如何转义星（*）字符

> ID：12977348
> 
> 赞同：3
> 
> 时间：2012-10-19T15:17:14.813
> 
> 标签：sql-server, tsql, escaping, character

我想搜索这个字符串

```
*|* 
```

或更具体

```
LIKE '%*|*%' 
```

但是

```
* 
```

表示符号本身。如何逃脱它？

编辑：实际上，由于我的代码中的其他[问题，我被误导了。](https://stackoverflow.com/questions/12978005/why-conversion-numeric-to-varchar-does-not-give-overflow-message)无论如何，您完全正确，在 LIKE 语句中 * 字符没有特殊含义。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T15:20:33.040

你不需要逃避它。在子句`*`中没有特殊值`like`

```
 select * from yourtable where field LIKE '%*|*%' 
```

请参阅[http://msdn.microsoft.com/en-us/library/ms179859(v=sql.100).aspx](http://msdn.microsoft.com/en-us/library/ms179859(v=sql.100).aspx)

# jquery - jquery 从服务器返回的数据（已解析）中向 DOM 添加元素

> ID：12977349
> 
> 赞同：0
> 
> 时间：2012-10-19T15:17:16.093
> 
> 标签：jquery, dom

我试图从服务器的 AJAX 调用中返回的一长串数据中提取一些 HTML（a hrefs），然后将它们添加到 DOM，尝试按照先前答案的几个示例，但似乎无法获取 DOM 元素可以点击，尽管它似乎是作为链接添加的。因此，退后一步并尝试在单击另一个元素时添加一个新元素并且也无法使其正常工作-已在 jsfiddle 中尝试过，基本代码示例如下-单击 getsearchresults 时，将显示 a href在 searchresults div 中，但单击时不会触发 .clicakable_search 处理程序。

HTML 获取搜索结果

结果

JS代码

```
 $(document).ready(function() {
        $("#getsearchresults_id").click(function(event) {
        var aa = $('<a href="#" class="clickable_search">parsed substring from the return data</a>');
        $('#searchresults').append(aa);
    });

    $('.clickable_search').click(function(e) {
        console.log(".clickable_search");
        e.preventDefault();
        alert('anchor without a href was clicked');
    });
   }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:19:01.383

这是因为它在绑定时不存在于dom中。委托将事件处理程序绑定到父元素，该元素将在事件冒泡时依次侦听。确保父元素是静态元素

使用委托 - 如果使用 jQuery 1.7+，则首选方式

```
$('#searchresults').on('click', '.clickable_search',function(e){ 
    console.log(".clickable_search");
    e.preventDefault();
    alert('anchor without a href was clicked');
});​ 
```

jQuery 1.7 及更低版本

```
$('#searchresults').delegate('.clickable_search','click', function(e){ 
    console.log(".clickable_search");
    e.preventDefault();
    alert('anchor without a href was clicked');
});​ 
```

或在元素添加到 dom 后绑定 - 如果多次单击，这将添加多个

```
$(document).ready(function() {
    $("#getsearchresults_id").click(function(event) {
        var aa = $('<a href="#" class="clickable_search">parsed substring from the return data</a>');
        $('#searchresults').append(aa);
        $('.clickable_search').click(function(e) { //< --it 's your other click function
            console.log(".clickable_search");
            e.preventDefault();
            alert('anchor without a href was clicked ');
        });
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:26:51.227

您可以使用[.live()](http://api.jquery.com/live/)为现在和将来匹配当前选择器的所有元素绑定一个事件。看下面的代码：

```
$('.clickable_search').live('click', function(e) {
    console.log(".clickable_search");
    e.preventDefault();
    alert('anchor without a href was clicked');
}); 
```

您还可以在[http://jsfiddle.net/Mdv7A/上查看演示](http://jsfiddle.net/Mdv7A/)

## 更新

正如@wirey 所说，您可以用 .on() 排斥 .live() ，[如下](http://api.jquery.com/on/)所示：

```
$('body').on('click', '.clickable_search', function(e) {
    console.log(".clickable_search");
    e.preventDefault();
    alert('anchor without a href was clicked');
}); 
```

[http://jsfiddle.net/Mdv7A/3/](http://jsfiddle.net/Mdv7A/3/)

# c# - 使用 ShapeRange 在 Excel 中调整注释大小

> ID：12977353
> 
> 赞同：6
> 
> 时间：2012-10-19T15:17:21.173
> 
> 标签：c#, excel, comexception

我有一个以编程方式创建的电子表格，其中包含很多评论（最多 40,000 条）。从工作表中删除几列后，评论会调整大小。这显然是excel中的一个错误。( [http://answers.microsoft.com/en-us/office/forum/office_2007-excel/excel-comment-boxes-resizing-themselves-andor/3fdf3e72-6ca5-4186-a656-b7b6fd8db781?msgId=d55534a5-4603 -482e-ac97-9ec260124f78](http://answers.microsoft.com/en-us/office/forum/office_2007-excel/excel-comment-boxes-resizing-themselves-andor/3fdf3e72-6ca5-4186-a656-b7b6fd8db781?msgId=d55534a5-4603-482e-ac97-9ec260124f78) )

理想情况下，我想在删除列后立即自动调整所有评论的大小。

试图避免遍历每个单独的评论，这是我到目前为止所尝试的。

*   设置 AutoShapeDefaults 无效 - 删除列后，注释仍会调整大小。
*   XlPlacement 属性。XlMove 和 XLMoveAndSize 无效。
*   无论评论数量如何，Worksheet.Shapes.SelectAll 都会引发 OutOfMemory 异常

我的想法是获取电子表格中所有评论的 ShapeRange 对象并从那里设置大小。

这完美地工作：

```
 public static void ResizeComments()
        {
        Microsoft.Office.Interop.Excel.Workbook objWorkbook;
        objWorkbook = (Workbook)Globals.ThisAddIn.Application.ActiveWorkbook;
        Worksheet objSheet = (Worksheet)objWorkbook.ActiveSheet;

        int[] test = {1,2,3,4,5};
        ShapeRange sRange = objSheet.Shapes.Range[test];
        sRange.Height = 100;
        sRange.Width = 220;
        } 
```

更改为此会在 AutoSize 行引发异常“HRESULT 中的异常：0x800A03EC”。

```
 ShapeRange sRange = objSheet.Shapes.Range[test];
        sRange.TextFrame.AutoSize = true; 
```

使用我的实际形状索引数组会引发相同的异常，但在**Shapes.Range[]**处。我在调试时查看了**形状**变量，它与**test**相同，除了它是**int[249]**而不是**int[5]**；

```
 int[] shapes = (int[])shapes.ToArray(typeof(int)); 
        ShapeRange sRange = objSheet.Shapes.Range[shapes]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T11:13:27.520

好吧，我将使用必须从 Excel 的模块中运行的 VBA 代码来回答。[从这里](http://answers.microsoft.com/en-us/office/forum/office_2010-excel/format-comments-in-large-shreadsheet/899bdf4e-56f1-4a0e-8426-b6d0d8af10bb?tab=mysubscriptions#tabs)讨论和回答。

```
Sub CommentFixer()
Dim Arng As Range, Acl As Variant, InitRng As Variant, MaxSize
Set InitRng = Selection
Set Arng = Application.InputBox("Select Ranges", , , , , , , 8)

For Each Acl In Arng
    If (Not (Acl.Comment Is Nothing)) And (Acl.MergeArea.Count = 1) Then
        Acl.Select
        Selection.Comment.Visible = True
        Selection.Comment.Shape.TextFrame.AutoSize = True
        'Commented as is obsolete if no further processing is needed  
        'Selection.Comment.Shape.Select
        'Commented not to fix Comment Aspect Ratio
        'With Selection.ShapeRange       'Fix 2.5 aspect ratio
        '    .LockAspectRatio = msoFalse
        '    MaxSize = .Width / 2.5
        '    If MaxSize > .Height Then
        '        .Height = MaxSize
        '    Else
        '        .Width = .Height * 2.5
        '    End If
        'End With
        'Commented to neglect fonts
        'With Selection.Font
        '    .Bold = False
        '    .Name = "Times New Roman"
        '    .Size = 12
        'End With

        Acl.Comment.Visible = False
    End If
Next
InitRng.Select

End Sub 
```

保留不需要的代码和注释项目。我仍然需要弥补还不能处理的合并单元格。

干杯

# magento - 不能对一页应用 50% 的折扣

> ID：12977362
> 
> 赞同：0
> 
> 时间：2012-10-19T15:17:59.387
> 
> 标签：magento, magento-1.7

嗨，StackOverflow 伙计们，

首先，这是在 Magento 1.7.0.2 上。

我有3个类别。他们都使用相同的产品。我有 3 个不同的 CMS 页面，它们适用于自己的类别。因此，例如，CMS 主页显示类别 6 中的所有产品。这一切都可以找到并且花花公子...

**问题：**

我创建了另一个页面，它是主页的副本。此页面显示主页上显示的所有产品，但每个产品应享受 50% 的折扣。

当我为折扣类别 ID 应用“目录价格规则”时，它会将其应用于所有错误的类别。我只希望将 50% 应用于折扣页面...

**这是显示 50% 折扣页面的 CMS 页面：**

```
{{block type="catalog/product_list" category_id="16" template="catalog/product/list_home.phtml"}} 
```

**分类页面截图：http:** [//postimage.org/image/ux7rfdl4b/](http://postimage.org/image/ux7rfdl4b/)

**促销->目录价格规则页面的屏幕截图：http:** [//postimage.org/image/4avaqegx7/](http://postimage.org/image/4avaqegx7/)

我在发布之前尝试寻找解决方案，但无法提出任何有用的东西。我能想到的唯一其他选择是复制每个产品并给它一个不同的 SKU 编号和 50% 的价格。我希望它不会变成那样...

最好的问候，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T17:57:38.013

我认为该规则正常工作。但它将折扣应用于类别中的产品，而不是类别本身。您在 HomePage 中的产品也在 HomePage_Discounted 中（至少 9/10），因此无论您在哪里看到它们，它们都会获得折扣。

最快的方法是复制 HomePage 产品并将副本分配给 HomePage_Discounted 类别。原始的必须只保留在主页类别中。然后，一定要输入折扣规则并点击“保存并应用”按钮（不对规则进行任何更改），这样折扣产品就会重新计算。

另一种方法是创建折扣代码，将其显示在 50% 折扣 CMS 页面上，然后使用它来创建折扣（不完全符合您的要求，但效果是一样的 - 只有访问此页面的用户才能获得折扣）。

让我知道这些选项是否对您有帮助。如果没有，我们可以寻找另一种解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:23:47.123

您的配置应该可以正常工作。

验证您的目录价格规则配置：

```
If ALL these conditions are TRUE:
Category is 16 
```

然后，确保您保存并应用该规则。前端没有“应用”没有变化。

清除您的缓存，如果可能（小目录），您可以重新索引您的产品价格规则索引（通常不需要，虽然它发生在以前）

# git - 是否可以替换 git 合并算法？

> ID：12977363
> 
> 赞同：4
> 
> 时间：2012-10-19T15:18:00.170
> 
> 标签：git, merge, git-merge

我想知道是否可以编写我自己的自定义合并并使用它来代替标准合并。

想到的唯一想法是将它作为 merge.tool 放入配置中，但这将使它在标准 git-merge 之后运行，而不是代替它。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:22:14.390

阅读 gitattributes[文档](http://www.kernel.org/pub/software/scm/git/docs/gitattributes.html)：

> 定义自定义合并驱动程序
> 
> 合并驱动程序的定义是在 .git/config 文件中完成的，而不是在 gitattributes 文件中，所以严格来说这个手册页是一个错误的地方来讨论它。不过……</p>
> 
> 要定义自定义合并驱动程序文件，请在 $GIT_DIR/config 文件（或 $HOME/.gitconfig 文件）中添加一个部分，如下所示：

```
[merge "filfre"]
    name = feel-free merge driver
    driver = filfre %O %A %B
    recursive = binary 
```

# spring - 如何更改异常处理程序中的内容类型

> ID：12977368
> 
> 赞同：33
> 
> 时间：2012-10-19T15:18:12.507
> 
> 标签：spring, spring-mvc, mime-types

假设我有一个控制器，它提供`GET`请求并返回要序列化为 JSON 的 bean，并且还提供了一个`IllegalArgumentException`可以在服务中引发的异常处理程序：

```
@RequestMapping(value = "/meta/{itemId}", method = RequestMethod.GET, produces = MediaType.APPLICATION_JSON_VALUE)
@ResponseBody
public MetaInformation getMetaInformation(@PathVariable int itemId) {
    return myService.getMetaInformation(itemId);
}

@ExceptionHandler(IllegalArgumentException.class)
@ResponseStatus(value = HttpStatus.BAD_REQUEST)
@ResponseBody
public String handleIllegalArgumentException(IllegalArgumentException ex) {
    return ExceptionUtils.getStackTrace(ex);
} 
```

消息转换器是：

```
<mvc:annotation-driven>
    <mvc:message-converters>
        <bean class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter" />
        <bean class="org.springframework.http.converter.StringHttpMessageConverter" />
    </mvc:message-converters>
</mvc:annotation-driven> 
```

现在，当我在浏览器中请求给定的 URL 时，我会看到正确的 JSON 回复。但是，如果引发异常，字符串化的异常也会转换为 JSON，但我希望它由`StringHttpMessageConverter`（生成的`text/plain`mime 类型）处理。我怎么去呢？

为了使图片更完整（和复杂），假设我还有以下处理程序：

```
@RequestMapping(value = "/version", method = RequestMethod.GET)
@ResponseBody
public String getApplicationVersion() {
    return "1.0.12";
} 
```

此处理程序允许返回字符串由两者序列化，`MappingJackson2HttpMessageConverter`并`StringHttpMessageConverter`取决于`Accept-type`客户端传递的内容。返回类型和值应如下所示：

```
+----+----------+---------- -+------------------+-------------- --------+
| 神经网络 | 网址 | 接受型 | 内容类型 | 消息转换器 |
| | | 请求头 | 响应头 | |
+----+----------+---------- -+------------------+-------------- --------+
| 1\. | /版本 | 文本/html；*/* | 文本/纯文本 | StringHttpMessage 转换器 |
| 2\. | /版本 | 应用程序/json；*/* | 应用程序/json | MappingJackson2HttpMessageConverter |
| 3\. | /元/1 | 文本/html；*/* | 应用程序/json | MappingJackson2HttpMessageConverter |
| 4\. | /元/1 | 应用程序/json；*/* | 应用程序/json | MappingJackson2HttpMessageConverter |
| 5\. | /meta/0 (例外) | 文本/html；*/* | 文本/纯文本 | StringHttpMessage 转换器 |
| 6\. | /meta/0 (例外) | 应用程序/json；*/* | 文本/纯文本 | StringHttpMessage 转换器 |
+----+----------+---------- -+------------------+-------------- --------+

```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-19T16:53:57.193

我认为删除`produces = MediaType.APPLICATION_JSON_VALUE`from会给你想要的结果`@RequestMapping`。`getMetaInformation`

response-type 将根据 Accept 头中的 content-type 值进行协商。

* * *

*编辑*

由于这不涵盖场景 3,4，因此这是一个`ResponseEntity.class`直接使用的解决方案：

```
@ExceptionHandler(Exception.class)
public ResponseEntity<String> handleIllegalArgumentException(Exception ex) {
    HttpHeaders headers = new HttpHeaders();
    headers.setContentType(MediaType.TEXT_PLAIN);
    return new ResponseEntity<String>(ex.getMessage(), headers, HttpStatus.BAD_REQUEST);
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-19T17:39:21.463

有几个方面与问题有关：

*   `StringHttpMessageConverter`将包罗万象的 mime 类型添加`*/*`到支持的媒体类型列表中，而`MappingJackson2HttpMessageConverter`仅限于`application/json`。
*   在`@RequestMapping`提供时`produces = ...`，此值存储在`HttpServletRequest`（请参阅`RequestMappingInfoHandlerMapping.handleMatch()`）中，当调用错误处理程序时，此 mime 类型会自动继承和使用。

简单情况下的解决方案是将`StringHttpMessageConverter`列表放在首位：

```
<mvc:annotation-driven>
    <mvc:message-converters>
        <bean class="org.springframework.http.converter.StringHttpMessageConverter">
            <property name="supportedMediaTypes">
                <array>
                    <util:constant static-field="org.springframework.http.MediaType.TEXT_PLAIN" />
                </array>
            </property>
        </bean>
        <bean class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter" />
    </mvc:message-converters>
</mvc:annotation-driven> 
```

并`produces`从`@RequestMapping`注释中删除：

```
@RequestMapping(value = "/meta/{itemId}", method = RequestMethod.GET)
@ResponseBody
public MetaInformation getMetaInformation(@PathVariable int itemId) {
    return myService.getMetaInformation(itemId);
} 
```

现在：

*   `StringHttpMessageConverter`将丢弃所有类型，这些类型只能`MappingJackson2HttpMessageConverter`处理 ( `MetaInformation`, `java.util.Collection`, 等) 允许它们被进一步传递。
*   情况（5、6）中的异常情况`StringHttpMessageConverter`优先。

到目前为止一切顺利，但不幸的是，使用[`ObjectToStringHttpMessageConverter`](https://github.com/SpringSource/spring-framework/blob/master/spring-web/src/main/java/org/springframework/http/converter/ObjectToStringHttpMessageConverter.java). 对于处理程序返回类型`java.util.Collection<MetaInformation>`，此消息转换器将报告它可以将此类型转换为`java.lang.String`. 限制来自这样一个事实，即删除集合元素类型并且`AbstractHttpMessageConverter.canWrite(Class<?> clazz, MediaType mediaType)`方法获取`java.util.Collection<?>`类以进行检查，但是在转换步骤`ObjectToStringHttpMessageConverter`失败时。为了解决我们`produces`为`@RequestMapping`应该使用 JSON 转换器的注释保留的问题，但是为了强制异常处理程序的正确内容类型，我们将从以下位置删除`HandlerMapping.PRODUCIBLE_MEDIA_TYPES_ATTRIBUTE`属性`HttpServletRequest`：

```
@ExceptionHandler(IllegalArgumentException.class)
@ResponseStatus(value = HttpStatus.BAD_REQUEST)
@ResponseBody
public String handleIllegalArgumentException(HttpServletRequest request, IllegalArgumentException ex) {
    request.removeAttribute(HandlerMapping.PRODUCIBLE_MEDIA_TYPES_ATTRIBUTE);
    return ExceptionUtils.getStackTrace(ex);
}

@RequestMapping(value = "/meta", method = RequestMethod.GET, produces = MediaType.APPLICATION_JSON_VALUE)
@ResponseBody
public Collection<MetaInformation> getMetaInformations() {
    return myService.getMetaInformations();
} 
```

上下文保持与最初相同：

```
<mvc:annotation-driven>
    <mvc:message-converters>
        <bean class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter" />
        <bean class="org.springframework.http.converter.ObjectToStringHttpMessageConverter">
            <property name="conversionService">
                <bean class="org.springframework.context.support.ConversionServiceFactoryBean" />
            </property>
            <property name="supportedMediaTypes">
                <array>
                    <util:constant static-field="org.springframework.http.MediaType.TEXT_PLAIN" />
                </array>
            </property>
        </bean>
    </mvc:message-converters>
</mvc:annotation-driven> 
```

由于内容类型协商，现在场景（1,2,3,4）被正确处理，场景（5,6）在异常处理程序中处理。

或者，可以用数组替换集合返回类型，然后解决方案 #1 再次适用：

```
@RequestMapping(value = "/meta", method = RequestMethod.GET)
@ResponseBody
public MetaInformation[] getMetaInformations() {
    return myService.getMetaInformations().toArray();
} 
```

* * *

讨论：

我认为不`AbstractMessageConverterMethodProcessor.writeWithMessageConverters()`应该从值继承类，而是从方法签名：

`Type returnValueType = returnType.getGenericParameterType();`

并`HttpMessageConverter.canWrite(Class<?> clazz, MediaType mediaType)`应更改为：

`canWrite(Type returnType, MediaType mediaType)`

或者（如果它过于限制潜在的基于类的转换器）到

`canWrite(Class<?> valueClazz, Type returnType, MediaType mediaType)`

然后可以正确处理参数化类型，并且解决方案 #1 将再次适用。

# php - IE 中的对象预期错误

> ID：12977373
> 
> 赞同：1
> 
> 时间：2012-10-19T15:18:24.283
> 
> 标签：php, javascript, jquery

我有四个php页面：

1.  `header.php`
2.  `demo1.php`
3.  `demo2.php`
4.  `demo3.php`

我在每一页中都包括`header.php`ie`demo1.php`和. 我包含了和所需的通用JavaScript 。`demo2.php``demo3.php``demo1.php``demo2.php``demo3.php``header.php`

`header.php`代码：

```
<script type="text/javascript" src="jscript/jquery.js"></script>
<script type="text/javascript" language="javascript">
$(function(){
     $("#btn1").click(function(){
       console.log("btn1 clicked");
      });
     $("#btn2").click(function(){
      console.log("btn2 clicked");
     });

});
</script> 
```

`btn1`和`btn2`元素未在 中声明`header.php`，但它们在包含的页面中声明，如`demo1.php`,`demo2.php`和`demo3.php`.

`demo1.php`代码：

```
 <?php include "header.php";?>
 <input type="button" id="btn1" value="check"/>
 <input type="button" id="btn2" value="check"/> 
```

此`demo1.php`页面适用于除 IE 之外的所有浏览器。

在 IE 中，它显示错误**对象预期**在`$("btn1").click(function(){});`.

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T01:03:36.770

您可能在此行有一个[隐式分号或附加：](https://stackoverflow.com/questions/9230567/)

```
$("#btn1").click(function(){ 
```

这也可能是由[基本元素](https://stackoverflow.com/questions/11234172/)引起的问题。

# linq - 没有加入 Linq

> ID：12977375
> 
> 赞同：3
> 
> 时间：2012-10-19T15:18:33.647
> 
> 标签：linq

我有两个表加入了这样的查询

```
IQueryable<Auction> closed =
                (from a in CurrentDataSource.Auctions
                 join p in CurrentDataSource.Payments
                     on a.Id equals p.AuctionId
                 where <some condition>
                 select a); 
```

我真正想说的是给我所有**没有**与付款表连接或某些条件为真的拍卖。我可以用 T-SQL 做到这一点，但不知道如何用 Linq 做到这一点。你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:27:17.420

您可以使用左外连接并检查付款是否为空，就像在 T-SQL 中一样。

```
IQueryable<Auction> closed =
                (from a in CurrentDataSource.Auctions
                 join p in CurrentDataSource.Payments
                     on a.Id equals p.AuctionId into temp
                 from t in temp.DefaultIfEmpty()
                 where t == null && <some condition>
                 select a); 
```

# jquery - 整合3个功能

> ID：12977376
> 
> 赞同：0
> 
> 时间：2012-10-19T15:18:37.000
> 
> 标签：jquery

大家好，想知道是否有人可以帮助我合并以下代码。我应该能够拥有更少的代码行，但不知道如何实现这一点。

```
$(document).ready(function () {
  $(".question1").hover(function () {
    $(this).append('<div class="tooltip"><p>1This is a tooltip. It is typically used to explain something to a user without taking up space on the page.</p></div>');
  }, function () {
    $("div.tooltip").remove();
  });

  $(".question2").hover(function () {
    $(this).append('<div class="tooltip"><p>2This is a tooltip. It is typically used to explain something to a user without taking up space on the page.</p></div>');
  }, function () {
    $("div.tooltip").remove();
  });

  $(".question3").hover(function () {
    $(this).append('<div class="tooltip"><p>3This is a tooltip. It is typically used to explain something to a user without taking up space on the page.</p></div>');
  }, function () {
    $("div.tooltip").remove();
  });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:23:56.437

```
function setTooltipMessage ($elem, message) {
    $elem.hover(
        function () {
            $(this).append('<div class="tooltip"><p>'+message+'</p></div>');
        },
        function () {
            $("div.tooltip").remove();
        }
    );
} 
```

然后 ：

```
setTooltipMessage($('.question1'), '1This is a tooltip. It is typically used to explain something to a user without taking up space on the page.');
setTooltipMessage($('.question2'), '2This is a tooltip. It is typically used to explain something to a user without taking up space on the page.');
setTooltipMessage($('.question3'), '3This is a tooltip. It is typically used to explain something to a user without taking up space on the page.'); 
```

正如@geedubb 指出的那样，您可以在循环中使用此函数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:32:47.667

我会做这样的事情。

```
$('.question1, .question2, .question3').hover(function() {
    var question = $(this);
    $('<div/>', {
        'class': 'tooltip',
        'html': '<p>'+ question.data('tooltip') +'</p>'
    }).appendTo(question);
}, function() {
    $(this).find('.tooltip').remove();
}); 
```

在您的标记中，您可以像这样指定附加到每个工具提示的内容。

```
<div class="question1" data-tooltip="1This is a tooltip. It is typically used to explain something to a user without taking up space on the page."></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:22:16.767

你可以使用循环吗？

```
 $(document).ready(function () {
        for(var i = 1; i < 4; i++)
        {
      $(".question" + i).hover(function () {
        $(this).append('<div class="tooltip"><p>' + i + 'This is a tooltip. It is typically used to explain something to a user without taking up space on the page.</p></div>');
      }, function () {
        $("div.tooltip").remove();
      });
    }
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T15:25:26.173

```
 $(document).ready(function() {
        $('[class^="question"]').hover(function() {
        $(this).append('<div class="tooltip"><p>1This is a tooltip. It is typically used to explain something to a user without taking up space on the page.</p></div>');
    }, function() {
        $('.tooltip').remove();
    });
}); 
```

这更具可扩展性。

# android - 按钮 setOnClickListener 上的 NullPointerException

> ID：12977380
> 
> 赞同：2
> 
> 时间：2012-10-19T15:18:52.820
> 
> 标签：android, android-intent

```
sample = (Button) findViewById(R.id.sampleButton);
sample.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        // TODO Auto-generated method stub
    }
}); 
```

当我尝试加载我的活动时，它会在侦听器上引发空指针异常。**为什么**？我已经在全局范围内定义了我的按钮变量。

```
Button sample; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T15:20:54.547

您的按钮`sampleButton`可能不在您传递给的布局中`setContentView()`。`findViewById()`只能找到当前显示的视图。

# c++ - 在一个 Linux 发行版上使用 g++ 编译的可执行文件在另一个发行版上使用是否有限制？

> ID：12977381
> 
> 赞同：8
> 
> 时间：2012-10-19T15:18:54.050
> 
> 标签：c++, c, linux, gcc, g++

发行版之间是否存在任何会影响在一个发行版上直接在另一个发行版上使用 GCC 4.7.x 编译的 C++ 二进制文件的特性或变化？我知道理想的情况是在第二个发行版上从源代码编译，但我真的不想担心在我的生产机器上编译新的 GCC 版本和程序源代码。我是一个相对缺乏经验的 linux 用户（因此提出了问题！）并且仍然更喜欢 IDE，而不是命令行编译，ssh 是我真正可以用来访问生产机器的全部。

代码本身没有什么有趣的，但它确实利用了一些运行的操作系统工具，比如阻塞套接字等。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T15:35:12.053

除非二进制文件构建在**完全相同**的操作系统（包括版本）和**完全相同**的硬件上，否则无法保证。

在实践中：

1.  如果硬件是同一系列的芯片，它应该可以工作。

    *   这是因为大多数人没有打开硬件特定的优化（但他们可以）。
    *   跨芯片组移动二进制文件不太可能奏效
    *   将二进制文件从硬件系列的较旧成员转移到较新成员可能会奏效
    *   将二进制文件从硬件系列的较新成员移动到较旧成员的可能性较小（但将取决于优化和编译器设置（从 64 位架构迁移到 32 位架构不太可能起作用）。
2.  如果操作系统具有相同的主要编号，那么它应该（可能）工作。

    *   二进制文件可以运行的操作系统版本取决于用于构建它的编译器版本和主机操作系统。
    *   如果编译器在它生成的 ABI 中发生了变化，那么所有的赌注都会被取消。但通常编译器生成的 ABI 的变化将是一个主要问题，因此只会发生在 OS 路线图的主要点（而不是微小的增量）。
3.  我的建议是从源头构建的。

    *   不要专门去更新开发环境（使用发行版附带的环境（如果您进行默认更新，它们不会破坏向后兼容性））。
    *   `README`只需阅读文件即可轻松构建。但通常它涉及运行两个命令`./configure`和`make`. 如果你不想要任何特别的东西，你通常不需要做任何其他事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:31:47.637

使用静态链接，必须满足两个条件：

1）目标系统和构建系统必须具有相同的架构（例外：您可以在许多 64 位主机上运行 32 位二进制文​​件）

2) 目标系统上的 (g)libc 包不能是比构建系统上的旧版本（有时您可以避免微小的版本差异）

动态链接变得更加复杂。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-19T15:29:57.730

G++ 已经拥有稳定的 ABI 很长一段时间了，所以这不会引起问题。可能导致问题的是使用动态链接库。运行该程序的系统将需要具有编译可执行文件所针对的任何共享库的兼容版本。如果你只使用静态链接，你应该没有问题。`-static`您可以使用该选项打开静态链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T15:27:00.057

通常，基于较新发行版构建的二进制文件不适用于旧版本，但基于旧发行版构建的二进制文件将适用于较新发行版。目前，如果您在 RedHat EL4 上构建二进制文件，它将适用于大多数受支持的发行版。（如果缺少，您可能需要复制 libstdc++）

# solr - 如何按日期过滤solr中的查询？

> ID：12977389
> 
> 赞同：36
> 
> 时间：2012-10-19T15:19:11.787
> 
> 标签：solr

在我的 SOLR 中有日期字段（published_date），值采用这种格式*“2012-09-26T10:08:09.123Z”*

我如何通过简单的输入（如“2012-09-10”而不是完整的 ISO 日期格式）进行搜索。

SOLR 有可能吗？我试过了

`fq=[2012-09-24%20TO%20NOW]`

它应该通过过滤大于发布日期 2012-09-24 且小于现在的结果来返回。

但它返回发布日期为 2012-09-23 的数据，如下所示

```
<float name="score">2.8183863</float>
<str name="name">Local Team Inspires Obama</str>
<date name="published_date">2012-09-23T07:44:53.123Z</date> 
```

我错过了什么吗？

提前致谢。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-07-24T15:31:11.090

如果您想获得上周的出版物，您可以执行以下操作：

```
&fq=published_date:[NOW-7DAY/DAY TO NOW] 
```

但是如果你想要一个具体的日期，你必须使用 SOLR 日期格式：

```
&fq=published_date:[2013-07-17T00:00:00Z TO NOW] 
```

最后但并非最不重要的。

*   用于`[ ]`包含范围
*   用于`{ }`独占范围
*   您可以将它们混合在一起`[ }`以实现包容性 - 独占性，反之亦然`{ ]`

我希望这会有所帮助

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-04-07T09:38:53.067

Solr 日期的最简单形式是关键字“NOW”，它指的是当前日期和时间。它在 Solr 中区分大小写，但 Lucid 查询解析器将允许它在任何情况下都是如此。如果没有指定明确的日期或日期数学，则可以使用“现在”，或者如果指定了日期数学但没有明确的日期，则可以使用它。

Solr 中使用基于 ISO 8601 的格式写入明确的日期，该格式由 yyyy-mm-ddThh:mm:ss.mmmZ 形式的字符串组成，其中“yyyy”是四位数年份，第一个“mm” ' 是两位数的月份，'dd' 是两位数的日期，'T' 是强制性的文字字母 'T'，表示时间紧随其后，'hh' 是两位数的小时数（'00' 到 ' 23'），第二个 'mm' 是两位数的分钟（'00' 到 '59'），'ss' 是两位数的秒数（'00' 到 '59'），可选的 '.mmm' 是以句点开头的三位数毫秒，“Z”是强制性文字字母“Z”，表示时间为 UTC（“祖鲁”）。毫秒部分，包括它的前导周期，是可选的。

```
For example:

    2008-01-01T00:00:00Z

    2008-01-01T00:00:00

    2008-01-01T00:00 same as [2008-01-01T00:00:00Z TO 2008-01-01T00:00:59Z]

    2008-01-01T00: same as [2008-01-01T00:00:00Z TO 2008-01-01T00:59:59Z]

    2008-01-01T same as [2008-01-01T00:00:00Z TO 2008-01-01T23:59:59Z]

    2008-01-01 same as [2008-01-01T00:00:00Z TO 2008-01-01T23:59:59Z]

    2008-01 same as [2008-01-01T00:00:00Z TO 2008-01-31T23:59:59Z]

    2008 same as [2008-01-01T00:00:00Z TO 2008-12-31T23:59:59Z] 
```

归功于 Solr[文档](https://doc.lucidworks.com/fusion-server/latest/solr-reference-guide/7.2.1/working-with-dates.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-10T06:34:30.810

如果你想搜索简单的 dd-MM-yyyy 所以，你的日期 - “2012-09-26T10:08:09.123Z”

在 Solr ---Common----- q Date:[26-09-2019 TO 02-10-2019] 它给出了上述范围之间的所有数据。

# jdbc - Apache Cassandra：使用 JDBC 时出现 TTransportException

> ID：12977401
> 
> 赞同：1
> 
> 时间：2012-10-19T15:19:50.857
> 
> 标签：jdbc, cassandra, thrift, cql

使用 CQL JDBC 驱动程序 (cassandra-jdbc-1.1.2) 连接到 Apache Cassandra 数据库时出现以下错误。仅当我尝试执行 UPDATE 语句时才收到错误消息，SELECT 工作正常。我也可以使用 cqlsh 连接到 cassandra。

```
java.sql.SQLNonTransientConnectionException: org.apache.thrift.transport.TTransportException
    at org.apache.cassandra.cql.jdbc.CassandraStatement.doExecute(CassandraStatement.java:195)
    at org.apache.cassandra.cql.jdbc.CassandraStatement.execute(CassandraStatement.java:203)
    at com.concordusa.complete.dao.cassandra.keygen.MessageKeyGenerator.updateHighKeyInDatabase(MessageKeyGenerator.java:69)
    at com.concordusa.complete.dao.cassandra.keygen.MessageKeyGenerator.getNextHighKeyValue(MessageKeyGenerator.java:44)
    at com.concordusa.complete.dao.cassandra.keygen.MessageKeyGenerator.getKey(MessageKeyGenerator.java:30)
    at com.concordusa.complete.dao.cassandra.keygen.MessageKeyGenerator.main(MessageKeyGenerator.java:85)
Caused by: org.apache.thrift.transport.TTransportException
    at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)
    at org.apache.thrift.transport.TTransport.readAll(TTransport.java:84)
    at org.apache.thrift.transport.TFramedTransport.readFrame(TFramedTransport.java:129)
    at org.apache.thrift.transport.TFramedTransport.read(TFramedTransport.java:101)
    at org.apache.thrift.transport.TTransport.readAll(TTransport.java:84)
    at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:378)
    at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:297)
    at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:204)
    at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:69)
    at org.apache.cassandra.thrift.Cassandra$Client.recv_execute_cql_query(Cassandra.java:1402)
    at org.apache.cassandra.thrift.Cassandra$Client.execute_cql_query(Cassandra.java:1388)
    at org.apache.cassandra.cql.jdbc.CassandraConnection.execute(CassandraConnection.java:397)
    at org.apache.cassandra.cql.jdbc.CassandraConnection.execute(CassandraConnection.java:421)
    at org.apache.cassandra.cql.jdbc.CassandraStatement.doExecute(CassandraStatement.java:161)
    ... 5 more 
```

我在使用 cassandra 1.0.7 时没有遇到这个问题。我将 cassandra 更新为 1.1.6，因为 1.1.* 之前的版本不支持准备好的语句。

提前致谢！

编辑：这是我在服务器日志中的内容：

```
 ERROR [Thrift:13] 2012-10-23 14:50:24,327 CustomTThreadPoolServer.java (line 204) Error occurred during processing of message.
java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
    at java.util.ArrayList.RangeCheck(ArrayList.java:547)
    at java.util.ArrayList.get(ArrayList.java:322)
    at org.apache.cassandra.cql.Term.getByteBuffer(Term.java:102)
    at org.apache.cassandra.cql.UpdateStatement.mutationForKey(UpdateStatement.java:206)
    at org.apache.cassandra.cql.UpdateStatement.prepareRowMutations(UpdateStatement.java:166)
    at org.apache.cassandra.cql.UpdateStatement.prepareRowMutations(UpdateStatement.java:130)
    at org.apache.cassandra.cql.QueryProcessor.batchUpdate(QueryProcessor.java:256)
    at org.apache.cassandra.cql.QueryProcessor.processStatement(QueryProcessor.java:596)
    at org.apache.cassandra.cql.QueryProcessor.process(QueryProcessor.java:879)
    at org.apache.cassandra.thrift.CassandraServer.execute_cql_query(CassandraServer.java:1240)
    at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:3542)
    at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:3530)
    at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:32)
    at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:34)
    at org.apache.cassandra.thrift.CustomTThreadPoolServer$WorkerProcess.run(CustomTThreadPoolServer.java:186)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T14:30:02.643

看来我的问题是胡说八道。这是我的代码：

```
PreparedStatement stmt = con.prepareStatement(query);
stmt.setLong(1, key);
stmt.execute(query); 
```

`query`是（显然）字符串。解决问题的方法是`query`从`stmt.execute(query)`

我仍然不确定`execute()`在这种情况下的行为是否正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-14T08:09:02.607

这是 jdbc 驱动程序 [https://code.google.com/a/apache-extras.org/p/cassandra-jdbc/issues/detail?id=95](https://code.google.com/a/apache-extras.org/p/cassandra-jdbc/issues/detail?id=95)中的一个开放错误， 它在连接时命中，而不是在查询时命中

# jquery - TaffyDB OR 运算符如何？

> ID：12977402
> 
> 赞同：2
> 
> 时间：2012-10-19T15:19:50.727
> 
> 标签：jquery, json, operator-keyword, taffydb

从 JSON 文件中，我想选择所有标题为“hello”且价格为 50 或 2010 年出版的书。

我无法弄清楚如何使用 OR 逻辑运算符。

我已经使用 || 做了类似的事情，但我认为这不是正确的事情。

代码：

```
 var query = new TAFFY(json);

    query({Title:"hello"},{Price:"50"}||{Year:"2010"}).each(function (r) {  

     --- do Something

    }); 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T21:05:48.037

try this query:

```
query({Title:"hello"},[{Price:"50"},{Year:"2010"}]) 
```

from taffyDB page:

```
// does a match for column that is one of two values
db([{column:"value"},{column:"value2"}]);

// Real world example - records with a status of active or pending
db([{status:"Active"},{status:"Pending"}]); 
```

# c++ - 显示二维动态数组

> ID：12977404
> 
> 赞同：0
> 
> 时间：2012-10-19T15:20:02.147
> 
> 标签：c++, arrays

对不起，如果这是一个有点愚蠢的问题。

这是我的代码：

```
#include<iostream>
using namespace std;

int main()
{
  int columns, rows;
  char **map;

  cin>>columns;
  cin>>rows;

  /*creats array of pointers rows tall*/
  map = new char*[rows];

  /*creats array of chars columns tall*/
  for(int i=0; i<rows; i++)
    map[i] = new char[columns];

  //populate map with input
  map[0][0] = cin.get();
  for(int j=0; j<rows; j++)
    for(int i=0; i<columns; i++)
    {
      if (cin.peek() == '\n')
        cin.ignore(256, '\n');
      else
        map[j][i] = cin.get();
    }

  //DISPLAY
  cout<<endl;
  for(int j=0; j<rows; j++)
  {
    for(int i=0; i<columns; i++)
    {
      cout<<map[j][i];
    }
  }
  return 0;
} 
```

用户将输入如下内容：

```
7 4
#######
#S#   #
#   #E#
####### 
```

我想输出它。但是我的结果如下：

```
#######
#S#    
##   #
E##### 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:41:45.200

第一个for循环：

```
 //populate map with input

  for(int j=0; j<rows; j++)
  {
    cin.get();
    for(int i=0; i<columns; i++)
    {
      if (cin.peek() == '\n')
        cin.ignore(256, '\n');
      else
        map[j][i] = cin.get();
    }
  } 
```

并将新行添加到输出：

```
 //DISPLAY
  cout<<endl;
  for(int j=0; j<rows; j++)
  {
    for(int i=0; i<columns; i++)
    {
      cout<<map[j][i];
    }
    cout << endl;
  } 
```

在再次读取之前，请务必确保从输入流中获取尾随输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:44:08.340

几件事

*   首先，您不需要`map[0][0] = cin.get();`在循环之前，因为您将`map[0][0]`在循环期间获得

*   其次，如果有新行，则循环会跳过它，但也不会填充该位置的矩阵。你应该有这样的东西：

> ```
> for(int j=0; j<rows; j++)
>     for(int i=0; i<columns; i++)
>     {
>       while (cin.peek() == '\n')
>         cin.ignore(256, '\n');
>       map[j][i] = cin.get();
>     } 
> ```

当有 '\n' 字符时，只需跳过（忽略）。

*   第三，虽然与您的问题无关。完成后，您应该始终释放动态分配的内存（以防您忘记了）

    `delete [] map[i];` `delete [] map;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:27:49.323

我认为您的输出中需要一些换行符

```
 for(int j=0; j<rows; j++)
  {
    for(int i=0; i<columns; i++)
    {
      cout<<map[j][i];
    }
    cout << '\n';
  } 
```

# dreamweaver - 在dreamweaver cs5.5中创建一个新的默认css文件添加@charset "utf-8";?

> ID：12977405
> 
> 赞同：0
> 
> 时间：2012-10-19T15:20:06.533
> 
> 标签：dreamweaver

我正在 Dreamweaver 中编辑默认的 css 文件，它几乎可以工作。我唯一的问题是添加了一行额外的代码。在第一行添加以下代码@charset "utf-8"；

但我没有看到 Default.css 中的代码？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:27:09.170

这通常是因为您`<meta charset="utf-8" />`的 html 文档中有使用您的样式表的代码，而 Dreamweaver（它是一个非常棒的程序）检测到它并自动将其迁移到您的样式表中。不要摆脱它；它只是说您正在以 UTF-8（UCS 转换格式 - 8 位）格式保存 - 万维网的主要字符编码，占所有网页的一半以上。这段代码实际上消除了浏览器检测格式所花费的时间。Charset 是你的朋友 :)

# ios - 来自核心数据的 Objective-C 日期格式

> ID：12977409
> 
> 赞同：1
> 
> 时间：2012-10-19T15:20:14.037
> 
> 标签：ios

我的核心数据实体有一个日期字段，我可以将其输出到 UITableViewCell，它的输出如下：

![日期](../Images/06ae3b353819e331be907f70e1182d64.png)

我想做的是更改此日期格式，使其更具人类可读性，例如

10 月 19 日星期五 14:44

或者

19/10/2012 14:44

我如何在 Objective-C 中做到这一点？我想 NSDate 有一个格式化程序类，但是如何将提取的核心数据字符串转换为 NSDate？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T10:43:41.943

以上答案都不起作用，即使我尝试将核心数据对象转换为 NSDate 它仍然不会执行转换。我最终这样做了：

```
// Make a date formatter which corresponds exactly with the format of the date in core data
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyy-MM-dd HH:mm:ss Z"];

// Get the date from core data
NSString *dateStr = [[object valueForKey:@"date"] description];

// Parse from string to date
NSDate *date = [dateFormatter dateFromString:dateStr ];

// Set the date formatter to the format that I actually want
[dateFormatter setDateFormat:@"dd/MM/yy HH:mm"];

// Set the text on the date label
cell.dateLabel.text = [dateFormatter stringFromDate:date]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:26:47.563

试试这个方法：

它可能需要针对语言环境进行调整，我没有测试它，因为我没有一台能够与我一起编译代码的机器。

```
- (NSString *)dateAsString:(NSDate *)theDate {

NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setDateStyle:NSDateFormatterLongStyle]; 
[df setTimeStyle:NSDateFormatterNoStyle];

return  [df stringFromDate:theDate];
} 
```

# stored-procedures - 在报告中多次调用相同的存储过程

> ID：12977416
> 
> 赞同：0
> 
> 时间：2012-10-19T15:20:35.830
> 
> 标签：stored-procedures, ssrs-2008, subreport

我想知道是否有人知道如何解决我在使用 3 个子报表的主报表时遇到的缓慢问题，所有子报表都使用相同的存储过程，但每个只使用一个不同于其他 2 的 sp 参数。子报表基于相同存储过程，它要求 6 个变量。3 个子报表中的每一个都传递了 6 个与其他参数相同的参数中的 5 个。他们每个人只有一个参数不同。

就目前而言，该报告需要相当长的时间才能运行。我相信多次触发相同的存储过程并不是最有效的做法，只有一个参数不同。似乎是多余的。有没有办法优化这个过程？

# php - 使用 PHP 从 mySQL 表中显示图像/描述

> ID：12977422
> 
> 赞同：0
> 
> 时间：2012-10-19T15:20:58.497
> 
> 标签：php, html, mysql, css, database

我的 php 数据库链接：http: [//i163.photobucket.com/albums/t315/smc22_2007/pic1.png](http://i163.photobucket.com/albums/t315/smc22_2007/pic1.png)

我对如何显示 mysql 数据库中的图像的猜测​​：http: [//i163.photobucket.com/albums/t315/smc22_2007/pic2.png](http://i163.photobucket.com/albums/t315/smc22_2007/pic2.png)

我希望它看起来像什么：hxxp://i163.photobucket.com/albums/t315/smc22_2007/pic3.png（无法发布3个超链接，请将xx更改为tt）

请按顺序查看以上三张图片。

我可以使用“include displayitems.php”连接并显示我的数据库，但是，我想以 4 行 3 列的行显示我的数据库中的图像。

我该怎么做呢？

我真的很困惑。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:37:39.990

您需要制作一个具有固定宽度（400）的容器 div，然后将您的对象放入宽度为 100（容器的 1/4）的 div 中，然后从插入图像和文本的数据库中加载每个对象。请参见下面的示例。当对象进来时，它们将水平堆叠，一旦空间用完（在 5 处），第 5 个将转到下一行并继续前进。将其限制为 3 行必须使用 SQL --> LIMIT 0, 12;

无需为您编写整个代码，这应该可以让您很好地了解该做什么。

```
<div style="width:400px;">

  <div style="width:100px;display:inline-block;">
    <div class="image"><img src=""></div>
    <div class="description">Lorem Ipsum</div>
  </div>

  <div style="width:100px;display:inline-block;">
    <div class="image"><img src=""></div>
    <div class="description">Lorem Ipsum</div>
  </div>

  <div style="width:100px;display:inline-block;">
    <div class="image"><img src=""></div>
    <div class="description">Lorem Ipsum</div>
  </div>

  <div style="width:100px;display:inline-block;">
    <div class="image"><img src=""></div>
    <div class="description">Lorem Ipsum</div>
  </div>

</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:41:24.767

```
<div id='overall'>
<?php
$query = "select * from UFPProducts";
$result = mysql_query ($query, $connect);

while($row = mysql_fetch_array($result)) {

?>

    <div class='container'>
        <div class="image">
            <?php echo "<img src='".$row['Image']."' />"; ?>
        </div>
        <div class="text">
            <?php echo "<p>".$row['Description']."</p>"; ?>
        </div>
    </div>

    <?php

 }

 ?>
 </div>

 <style type="text/css">

 #overall {width:480px;}
 .container {width:100px; height:150px; float:left; display:inline; margin: 0px 10px; }
 .image {width:100px; height:100px;}
 .text {width:100px; height:50px;}

 </style> 
```

“边距：0 10px;” 基本上是说在顶部或底部没有边距，但在容器的每一侧都有 10px。这意味着容器 div 仍然是 100px 宽，每边有 10px 的边距（间距），因此它是 100px + 20px 宽。

因此，如果您仍然希望每行有 4 个；120 像素 x 4 = 480 像素。因此，480px 是“整体”容器的大小。

# sql - SQL Server 2008 根据文件名将 RawData 导入表

> ID：12977425
> 
> 赞同：1
> 
> 时间：2012-10-19T15:21:10.963
> 
> 标签：sql, sql-server, bulkinsert

我有一个表，其中包含保存为 RawData 的 ZIP 文件。我已经使用 BCP 解压了 ZIP 文件，然后使用 7-zip 解压缩了它们。解压缩的文件是 RTF 文件，其名称具有 ID 号。例如 56.rtf、65.rtf 等。我的问题是如何根据文件名将原始 RTF 数据导入表中的一行？我一直在玩 BULK INSERT 并将数据放入具有一列的表中，但是我如何知道表中的哪一行对应于哪个文件，以便可以通过查询检索它？我对此很陌生，所以尽量保持简单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T16:31:19.643

我会使用 SSIS 来完成这项任务。如果在 for each file 循环中创建数据流，则可以遍历文件夹中的所有文件并在 SSIS 变量中捕获每个文件的文件名，然后将其插入第二列。您的包装 st,rupture 如下：

MyPackage MyForEachLoop MyDataFlowTask MyFlatFileSource MyOLEDBDestination

# c# - 当表单请求导致文件下载时，如何防止按钮按下直到表单请求完成

> ID：12977426
> 
> 赞同：5
> 
> 时间：2012-10-19T15:21:19.010
> 
> 标签：c#, asp.net

在我的 Asp.net webforms 站点中，我有一个表单，用户可以在其中选择各种选项，这些选项会在回发中发回，该回发会生成 PDF 报告并将该文件发送回用户以通过以下代码下载：

```
 protected void btnTopGenReport_Click(object sender, EventArgs e)
    {
        var stream = new PodMainReportGenerator().GenerateReport(GetReportParameters());

        var bytes = stream.ToArray();
        stream.Close();

        // Set the content headers
        Response.Clear();
        Response.Buffer = true;
        Response.ContentType = "application/pdf";
        Response.AddHeader("Content-Disposition", "attachment;filename=testReport.pdf");
        Response.AddHeader("Content-Length", bytes.Length.ToString());

        Response.BinaryWrite(bytes);

        Response.End();
    } 
```

问题是由于需要大量的数据和处理，生成此报告可能需要 10 秒左右的时间，但我不希望人们变得不耐烦并一遍又一遍地单击按钮。

在普通页面中，我会添加 javascript 以禁用单击按钮。这是有效的，因为当回发完成后，服务器会重新启用表单按钮。但是，由于表单的响应不是 HTML 页面，而是下载的文件，我不知道如何检测。

本质上，我如何禁用表单的按钮，但一旦我们从服务器获得响应（并且启动了 http 文件传输）就重新启用它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T17:06:22.380

您只需要响应内容之外的指示器来通知您下载已完成。尝试使用 cookie 监视器，在其中将 cookie 设置为下载响应的一部分，并在主页中监视该 cookie 的存在。

[http://gruffcode.com/2010/10/28/detecting-the-file-download-dialog-in-the-browser/](http://gruffcode.com/2010/10/28/detecting-the-file-download-dialog-in-the-browser/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T16:36:37.630

在这里尝试跳出框框思考。而不是禁用/启用提交按钮，也许您可​​以设置一个会话级别的变量来指示报告正在运行。如果用户在处理前一个请求时再次单击提交按钮，则不要启动新进程。

为了获得更好的 UI 体验，您可能希望在提交表单之前触发 AJAX 调用，以检查之前的进程是否正在运行。如果是，您可以取消表单提交并显示“您之前的请求仍在处理中”的消息。

想法？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:26:41.273

//为了禁用按钮，请在页面加载时编写以下代码。

```
 System.Text.StringBuilder sbValid = new System.Text.StringBuilder();
    sbValid.Append("if (typeof(Page_ClientValidate) == 'function') { ");
    sbValid.Append("if (Page_ClientValidate() == false) { return false; }} ");
    sbValid.Append("this.value = 'Saving..';");
    sbValid.Append("this.className  = 'Save_Button_Active';");
    sbValid.Append("this.disabled = true;");
    sbValid.Append(this.Page.GetPostBackEventReference(this.btnName));
    sbValid.Append(";");
    this.btnName.Attributes.Add("onclick", sbValid.ToString());
    this.btnName.Attributes.Add("onclick", "this.className  = 'Cancel_Button_Active';"); 
```

您还可以参考以下链接了解更多信息：

[http://bytes.com/topic/c-sharp/answers/887893-disabled-button-calling-even-handler-button-click](http://bytes.com/topic/c-sharp/answers/887893-disabled-button-calling-even-handler-button-click)

[单击后按钮禁用功能](https://stackoverflow.com/questions/1582941/button-disable-function-after-clicking-on-it)

[首次单击后禁用 asp 按钮，因为它以慢速连接保存多条记录](https://stackoverflow.com/questions/7831508/disable-the-asp-button-after-first-click-because-it-save-multiple-records-in-slo)

# tomcat - Tapestry url 编码 tomcat 的 webapp 路径

> ID：12977429
> 
> 赞同：-1
> 
> 时间：2012-10-19T15:21:23.630
> 
> 标签：tomcat, tomcat6, tapestry

我正在使用 maven-tomcat-plugin 在 tomcat6 服务器上部署挂毯应用程序。部署过程运行良好，但现在我需要使用不同的生产/开发/测试/等路径多次部署它。环境，这是使用 Maven 配置文件的一种。

我已将一个部署配置文件的上下文路径设置为：`/myapp/latest`. 生成的用于部署的 URL 如下所示：

```
http://example.com:8080/manager/deploy?path=%2Fmyapp%2Flatest&update=true 
```

Tomcat 现在使用一些约定：在 .war 的文件名中，井号被斜线替换（`#`被替换为`/`），以构造应用程序的 url。战争被解压缩到一个文件夹，该文件夹的名称是战争的文件名，没有 .war 扩展名。

应用程序无法启动，原因从日志中似乎很清楚：

```
Caused by: java.io.FileNotFoundException: /var/lib/tomcat6/webapps/myapp%23latest/WEB-INF/classes/de/myapp/services/AppModule.class (No such file or directory)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(FileInputStream.java:120)
    at org.apache.tapestry5.internal.plastic.PlasticInternalUtils.getStreamForPath(PlasticInternalUtils.java:408)
    at org.apache.tapestry5.internal.plastic.PlasticInternalUtils.readBytecodeForClass(PlasticInternalUtils.java:370) 
```

路径`/var/lib/tomcat6/webapps/myapp%23latest/`不存在，`/var/lib/tomcat6/webapps/myapp#latest/`当然应该存在。`%23`是一个井号，所以我猜在某些时候它会被 url 编码。我在这个问题上找不到太多，只是涉及双哈希的tomcat7的一些[类似问题，不幸的是没有任何解决方案。](http://tapestry.1045711.n5.nabble.com/Tomcat-7-Parallel-Deployment-td5715717.html#a5715723)

我可以通过不使用子路径来避免这个问题，但我知道这个应该可以工作：我已经在 grizzly/jersey 项目中使用了相同的方法，没有任何问题。

如何正确设置子路径？有没有办法告诉应用程序不对路径进行编码？tomcat 插件在这里似乎没有提供太多选项，那么有没有办法在 web.xml 或 context.xml 之类的配置文件中设置路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T00:13:03.750

根据我的评论，我认为这可能是由于 Tapestry`PlasticInternalUtils.getStreamForPath`方法中的一个错误。在这里你会发现：

```
if (url.getProtocol().equals("file"))
    {
        String urlPath = url.getPath();
        String decoded = urlPath.replaceAll("%20", " ");
        return new FileInputStream(new File(decoded));
     } 
```

因此处理了空格，但不处理其他转义序列。我建议提交一个错误并构建您自己的 Tapestry 版本，所有转义序列都使用以下代码解码：

```
URLDecoder.decode(urlPath, "UTF-8") 
```

# java - 编组不起作用：在嵌套 Dto 的情况下

> ID：12977438
> 
> 赞同：0
> 
> 时间：2012-10-19T15:21:57.293
> 
> 标签：java, serialization, xml-serialization, xstream

我将我的配置详细信息保存在一个 xml 文件中，它的结构有点像这样

```
<A>
    <b>
        <name>xxxxx</name>
        <age>xxxxx</age>
        <c>
          <someFeilds>yyyy</someFeilds>
        </c>
        <c>
          <someFeilds>yyyy</someFeilds>
        </c>
        <c>
          <someFeilds>yyyy</someFeilds>
        </c>
    </b>
    <b>
        <name>xxxxx</name>
        <age>xxxxx</age>
        <c>
            <someFeilds>yyyy</someFeilds>
        </c>
    </b>
</A> 
```

我能够将其编组到我的 DTO，其`A`结构是

```
class A {
    public ArrayList<B> bdtoInst;
}
class B {
    public String name;
    public String age;
    public ArrayList<C> cdtoInst;
}
class C {
    public String someFeilds;
} 
```

Xstream 声明是

```
 XStream xStream = new XStream();
    xStream.alias("A", A.class);
    xStream.addImplicitCollection(A.class, "bdtoInst");
    xStream.alias("b", B.class);
    xStream.addImplicitCollection(B.class, "cdtoInst");
    xStream.alias("c", C.class); 
```

我可以将它编组到我的 DTO，但是当我解组它时，我没有得到正确的格式，它是这样的：

```
<A>
    <b>
        <name>xxxxx</name>
        <age>xxxxx</age>
        <c>
            <someFeilds>yyyy</someFeilds>
        </c>
        <c>
            <someFeilds>yyyy</someFeilds>
        </c>
        <c>
            <someFeilds>yyyy</someFeilds>
        </c>
        <c>
            <someFeilds>yyyy</someFeilds>
        </c>
    </b>
    <b>
        <name>xxxxx</name>
        <age>xxxxx</age>
        <c reference="../../b/c"/>
    </b>
</A> 
```

我正在使用**xstream-1.4.3.jar。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T19:07:09.717

由于 xstream 链接中使用了 XPATH_RELATIVE_REFERENCES：xstream 声明中的 xstream.codehaus.org/graphs.html 我们必须添加

```
 xstream.setMode(XStream.NO_REFERENCES); 
```

而不是标记参考值将被放置。

# python - 如何使用已经使用 python 脚本导入的包启动 python shell？

> ID：12977441
> 
> 赞同：1
> 
> 时间：2012-10-19T15:22:10.490
> 
> 标签：python, python-3.x

我想通过双击 python 脚本调出一些已经导入的包的 python 窗口（可能是空闲的或基于 cmd 的）。这可能吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T15:38:21.757

您可以使用 -i 解释器选项。`python -c "import os" -i`将导入 os 模块并进入解释器读取/评估循环。

您还可以将一些语句（导入、定义等）放在文件中并使用`python -i <file.py>`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:35:14.390

当然。你想要这样的东西：

```
import sys
import code

preloaded_modules = dict(sys=sys)

code.interact(local=preloaded_modules) 
```

当您将上述代码放入一个文件并运行它时，您会看到一个传统的 Python REPL（交互式解释器），除了`sys`模块已经被加载。您可以通过将更多模块导入您的脚本并将它们添加到`preloaded_modules`字典中来向您的 REPL 添加更多模块。

代码模块还具有构建各种自定义解释器的工具。

更多信息：[Python 代码模块](http://docs.python.org/library/code.html)

（注意：以上参考 Python 2.x，但在 3.x 中应该基本相同）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T16:04:27.883

您还可以使用`PYTHONSTARTUP`环境变量

[来自文档：](http://docs.python.org/using/cmdline.html#environment-variables)

> PYTHONSTARTUP 如果这是一个可读文件的名称，则该文件中的 Python 命令会在第一个提示以交互模式显示之前执行。该文件在执行交互式命令的同一名称空间中执行，以便在其中定义或导入的对象可以在交互式会话中使用而无需限定。您还可以更改此文件中的提示 sys.ps1 和 sys.ps2。

and if want more drastic change like some initializaton whenever python is run, you can modify [site.py](http://docs.python.org/library/site.html) or create your own `pth` files

# jquery - Jquery isotope - 2 个问题 - 在 chrome 中重叠并首先向左加载

> ID：12977445
> 
> 赞同：2
> 
> 时间：2012-10-19T15:22:14.910
> 
> 标签：jquery, jquery-isotope

我正在使用 jquery isotope 来获得“砌体”效果，但有问题。

首先，整个项目列表首先在左侧直接加载，然后自行纠正，但可以清楚地看到它确实如此，有时会在那里停留一秒钟左右。

第二个问题是当我下载已加载项目的页面（一次 56 个）时，它们有时会相互重叠。如果我单击“显示更多”（使用 inf-scroll twitter 方法），那么它们会自行更正它们，并在它们重叠的新项目的底部再次进行更正。

如您所见，我正在尝试加载图像的插件，但没有什么不同。

这是同位素的代码和设置：

```
var $container = $('#wall');

$container.imagesLoaded(function(){

  // isotope
  $container.isotope({
    itemSelector : '.wrap_indiv',
    transformsEnabled: false,
    getSortData: {
            name: function($element) {
                return $element.data('name');
            },

            site: function($element) {
                return $element.data('site');
            },

            date_added: function($element) {
                return $element.data('date_added');
            }

        }
  });

  // filter items when filter link is clicked
    $('#options a').click(function(){
      var selector = $(this).attr('data-filter');
      $container.isotope({ filter: selector });
      return false;
    });

    var $optionSets = $('#options .option-set'),
      $optionLinks = $optionSets.find('a');

    $optionLinks.click(function(){
    var $this = $(this);
    // don't proceed if already selected
    if ( $this.hasClass('selected') ) {
      return false;
    }
    var $optionSet = $this.parents('.option-set');
    $optionSet.find('.selected').removeClass('selected');
    $this.addClass('selected');

    });

  // infinite scroll
  $container.infinitescroll({
    navSelector  : "#page_nav",
                 // selector for the paged navigation (it will be hidden)
  nextSelector : "#page_nav a",
                 // selector for the NEXT link (to page 2)
  itemSelector : ".wrap_indiv",
                 // selector for all items you'll retrieve
  behavior: "twitter",

  loading : {
            'finishedMsg' : 'No more to load.',
            'img' : '/images/icons/loading_sml.gif',
            'selector' : '#wall'
        }
    },
    // call Isotope as a callback
    function( newElements ) {
      $container.isotope( 'insert', $( newElements ) ); 
    }
  );

}); 
```

知道为什么会发生这些吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T10:15:22.723

修复了一半的问题 - 重叠：

改变：

```
function( newElements ) {
  $container.isotope( 'insert', $( newElements ) ); 
} 
```

对此：

```
function(newElements) {
      var $newElems = $(newElements);
      $newElems.imagesLoaded(function(){
        $container.isotope('appended', $newElems );
      });
    } 
```

# sql-server-2008 - SQL Server 2008 文件流访问被拒绝

> ID：12977452
> 
> 赞同：3
> 
> 时间：2012-10-19T15:22:45.063
> 
> 标签：sql-server-2008, filestream

`Access is denied`尝试将 FILESTREAM 数据插入 SQL Server 2008 时收到错误消息，有人可以帮忙吗？

我有一个 ASP.NET 应用程序在配置有特定于应用程序的用户的应用程序池中运行。web.config 使用集成安全...

```
<connectionStrings>
   <add name="MyApp" 
        connectionString="Data Source=localhost;Initial Catalog=MyDatabase;Integrated Security=SSPI;"
        providerName="System.Data.SqlClient" />
</connectionStrings> 
```

应用程序的 Windows 用户属于数据库角色，`web_app`. 此角色具有执行和选择权限。但是我收到以下异常...

```
System.ComponentModel.Win32Exception (0x80004005): Access is denied 
```

提前感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-03T08:33:04.760

1.  检查 SQL Server 服务帐户是否有权访问文件流文件夹。
2.  检查文件流文件夹不是只读的。

# f# - F# 中的 AutoOpen 属性

> ID：12977466
> 
> 赞同：30
> 
> 时间：2012-10-19T15:23:41.773
> 
> 标签：f#, code-organization

使用 AutoOpen 属性的推荐原则是什么？

（这个问题可能是关于[何时在类似命名的类型上使用模块函数 VS 静态函数](https://stackoverflow.com/questions/2214162/f-code-organization-types-modules)的延续）

专家 F# 指出“这在定义临时顶级运算符和函数时很有用：”

所以这似乎是为了减少模块在代码组织中的作用，当您在技术上需要一个来编写代码但您从客户端的角度删除它的存在时。

还有别的吗？你什么时候使用它？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-19T15:55:49.680

我认为该`AutoOpen`属性的主要用途是当您希望在库的用户打开命名空间时使一些 let-bound 值可用。这是该属性非常有用的地方，因为我认为库通常应该导出*命名空间*中的所有定义，但出于某些目的，您需要导出*值*，而值不能在命名空间中定义。

这是一个来自[F# 异步扩展](https://github.com/tpetricek/FSharp.AsyncExtensions)的示例，它定义了一个计算构建器，因此它需要导出`asyncSeq`值（但同时，所有功能都包装在一个命名空间中）：

```
namespace FSharp.Async

type AsyncSeq<'T> = (* ... *)
type AsyncSeqBuilder() = (* ... *)

[<AutoOpen>]
module GlobalValues = 
  let asyncSeq = AsyncSeqBuilder() 
```

图书馆的用户可以写`open FSharp.Async`，他们会看到`asyncSeq`。我认为相同的模式用于各种数学库（您还想导出简单命名的函数。）

对于模块（例如`List`和`Seq`），我认为大多数人不会`open`通过模块名称（例如`List.map`）来使用和访问功能，因此尽管您可以将其用于嵌套模块，但我没有经常看到这种情况。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-10-19T15:43:26.113

它可用于将模块组织成子模块，但在外部呈现统一/单模块视图：

```
module Outer =

  [<AutoOpen>]
  module Inner1 =
    let f1() = ()

  [<AutoOpen>]
  module Inner2 =
    let f2() = ()

open Outer

let x = f1()
let y = f2() 
```

[FParsec](http://www.quanttec.com/fparsec/reference/)这样做：`open FParsec`打开所有子模块（`Primitives`、`CharParsers`等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-01T19:28:11.557

*聚会有点晚了，但我想添加另一个用法。*

我倾向于使用`[<AutoOpen>]`在命名空间中公开类型。

```
// SlimSql\Types.fs
namespace SlimSql

[<AutoOpen>]
module Types =

    type SqlOperation =
        {
            Statement : string
            Parameters : SqlParam list
        } 
```

然后我可以将函数附加到相同的类型名称，而不会出现该名称已在使用中的编译器错误。

```
// SlimSql\SqlOperation.fs
namespace SlimSql

module SqlOperation =

    let merge (operations : SqlOperation list) : SqlOperation =
        ...

    let wrapInTransaction operation =
        ... 
```

然后在消费代码中使用相同的名称很好地打包所有内容。所以当用户在 SqlOperation 数据上寻找一个行为时，他们自然可以通过键入找到它，`SqlOperation.`并且 Intellisense 会显示出来。与在实践中使用诸如此类的类型的方式非常相似`List`。

```
open SlimSql

let operations =
    [
        sql "INSERT INTO ...." [ p "@Value" 123; ... ]
        ...
    ]
let writeOp =
    operations
    |> SqlOperation.merge
    |> SqlOperation.wrapInTransaction 
```

SlimSql.Types 模块也可以自己打开，只访问与其他类型组合的类型。

我更喜欢这个解决方案来增加静态成员的类型。

# asp.net-mvc-3 - 淘汰赛映射总是返回空数组

> ID：12977467
> 
> 赞同：0
> 
> 时间：2012-10-19T15:23:42.193
> 
> 标签：asp.net-mvc-3, knockout.js, knockout-mapping-plugin

所以这是我的代码：

```
var myData= @Html.Raw(ViewBag.MyData);
console.log(myData) //log1
var viewModel = { };
viewModel.model = ko.mapping.fromJS(myData);
ko.applyBindings(viewModel);
console.log(viewModel.model); //log2 
```

在我的控制台中，`log1`将始终`[Object, Object, Object]`以正确数据的格式显示数组。

然而，`log2`始终是空的。我没有收到任何错误或任何东西。我可能做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T00:46:26.147

您是否检查过以确保 myData 的格式适用于自动映射器（即 JavaScript 对象或 JSON）。您可能想要做的一件事是通过执行以下操作将其编码为 JSON：

```
var myData = @Html.Raw(Json.Encode(ViewBag.MyData)); 
```

# css - 没有悬停的特殊情况

> ID：12977469
> 
> 赞同：0
> 
> 时间：2012-10-19T15:23:43.953
> 
> 标签：css

我有一个里面有很多`<td>`s 的表格，并且在 CSS 文件中存储了一个特定的样式，它们有一个悬停样式，但是我不想将悬停应用于一个特定的`<td>`.

所以我试着给它一个ID，让悬停看起来像背景，但它不起作用！`<td>`和其他人一样悬停

这是我的 CSS：

```
#gradient-style tbody td:hover
{
    background: #d0dafd;
    color: #339;
}

td#exception:hover
{
    padding: 0px;
    background: #e8edff;
} 
```

我的异常`<td>`没有得到它异常的悬停；它和其他人一样。怎么了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T15:25:13.053

您的选择器不够[具体](http://www.w3.org/TR/CSS21/cascade.html#specificity)。

第一个选择器比第二个选择器多一个 id 选择器，所以它赢得了级联。

利用：

```
#gradient-style tbody td#exception:hover 
```

反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:26:09.367

假设css格式正确

尝试

```
td#exception:hover
{
    padding: 0px !important;
    background: #e8edff !important;
} 
```

不应该真正使用它，但它可以工作

# php - 读取模型数据（敏捷工具包）

> ID：12977471
> 
> 赞同：1
> 
> 时间：2012-10-19T15:23:51.070
> 
> 标签：php, user-interface, frameworks, atk4

我有一个有一些记录的模型。现在如何分别获取记录？（不使用 CRUD 或网格）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T17:54:08.670

1.  模型没有记录。
2.  您必须首先阅读有关 ATK4 类结构、模型、视图等的文档和教程。
3.  此外，还不清楚“单独获取记录”是什么意思......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-10T22:58:12.770

Agile Toolkit 中的模型已被重构为一个独立的框架：Agile Data ( [http://git.io/ad](http://git.io/ad) )

本文档将广泛涵盖有关如何直接从模型中获取数据的问题的正确答案：

[http://agile-data.readthedocs.io/en/develop/results.html](http://agile-data.readthedocs.io/en/develop/results.html)

# powershell - 判断connect-msolservice是否已经被成功调用

> ID：12977477
> 
> 赞同：13
> 
> 时间：2012-10-19T15:24:02.367
> 
> 标签：powershell, office365

我正在 PowerShell 中编写 Office 365 辅助工具，我认为这是一个我找不到答案的简单问题。如何判断由创建的连接`Connect-MsolService`是否存在且处于活动状态？必须有某种方法可以知道，因为其他 cmdlet 可以检查，我只是不知道那是什么，而且我没有运气找到它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-02-04T14:29:37.940

这是我的解决方案。

```
try
{
    Get-MsolDomain -ErrorAction Stop > $null
}
catch 
{
    if ($cred -eq $null) {$cred = Get-Credential $O365Adminuser}
    Write-Output "Connecting to Office 365..."
    Connect-MsolService -Credential $cred
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T15:40:39.337

`Connect-MsolService`连接后返回一个对象，据我所知，不会添加新变量。也许您可以通过运行其中一个模块命令并根据命令的执行结果来确定：

```
Get-MsolDomain -ErrorAction SilentlyContinue

if($?)
{
    "connected"
}
else
{
    "disconnected"
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-23T16:10:53.317

我知道这是一个老问题，但这就是我这样做的方式：

```
# Only run if not already connected
if(-not (Get-MsolDomain -ErrorAction SilentlyContinue))
{
    $O365Cred = Get-Credential -Message "Please provide credentials for Microsoft Online"

    $O365Session = New-PSSession –ConfigurationName Microsoft.Exchange -ConnectionUri https://ps.outlook.com/powershell -Credential $O365Cred -Authentication Basic -AllowRedirection -ErrorAction Stop
    Connect-MsolService –Credential $O365Cred

    Import-PSSession $O365Session | Out-Null
} 
```

如果该行位于该`Connect-MsolService`行之前`$O365Session =`，则输入不正确的凭据将导致您下次运行时出现误报（它会认为您已连接，即使您不是因为凭据错误。）这样做可以防止这种情况发生发生小问题。

还要注意行`-ErrorAction Stop`尾的`$O365Session = New-PSSession`。这可以防止它`Connect-MsolService`使用不正确的凭据尝试线路。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-12T17:21:17.813

您所要做的就是`get-pssession`让您知道您是否根据配置名称连接到 msol 服务。如果您想自动化连接过程，您可以设置一个 if else 循环来检查配置名称和状态。如果您想要这样的示例，请告诉我，我在我构建的 Web 应用程序上进行了设置，用于查询 Office 365 上的用户信息并将其显示在网页上。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2020-10-07T21:40:47.513

`Connect-MsolService`将一个模块导入到名为 MSOnline 的 powershell 中，因此只需检查该模块是否存在：

```
Get-Module -Name MSOnline 
```

# javascript - 如何规范化 SVG 路径数据（跨浏览器）？

> ID：12977480
> 
> 赞同：5
> 
> 时间：2012-10-19T15:24:06.593
> 
> 标签：javascript, path, svg

我试图找到一种方法来实现跨浏览器路径规范化器。[这里](http://www.w3.org/TR/SVG/paths.html#__svg__SVGAnimatedPathData__normalizedPathSegList)描述了一种本机方式，功能示例在[这里](http://xn--dahlstrm-t4a.net/svg/dom/normalize-path.svg)，但它仅适用于最新的 Opera（但不适用于 IE、FF、Safari、Chrome）。

本机方式使用`pathElm.normalizedPathSegList`并将所有相对坐标转换为绝对坐标，并将所有路径段类型表示为以下类型子集：M、L、C、z。

我只找到了[一个 javascript 代码](https://gist.github.com/1297684/dac8f9d9d14b1d7814e0050eee705e6dca4c0b73)和[jsfiddled 功能示例](http://jsfiddle.net/ybochatay/AtTND/3/)，但它仅适用于 IE 和 FF。Chrome 给出“未捕获的错误：INDEX_SIZE_ERR：DOM 异常 1”。如何解决这个问题，使其在 Opera、Safari 和 Chrome 中也能正常工作，或者有没有其他方法可以规范化 SVG 路径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-21T16:11:05.450

编辑：不要使用这个！我对其进行了更多测试，并意识到 A->C 转换并非在所有情况下都可靠，并且其他一些路径命令组合也失败了。请改用[这个](https://stackoverflow.com/a/13035117/1691517)！

终于让它在 Safari、Opera、IE9、Firefox 和 Chrome 中工作：http: [//jsfiddle.net/timo2012/M6Bhh/41/](http://jsfiddle.net/timo2012/M6Bhh/41/)

该函数对 SVG 路径的数据进行归一化处理，以便将所有路径段转换为 M、C、L 和 z（= 绝对坐标，这意味着所有相对坐标都转换为绝对坐标）。所有其他线段都很简单且 100% 准确，但圆弧 (A) 是一种特殊情况，您可以选择将圆弧转换为直线 (L)、二次曲线 (Q) 还是三次曲线 (C)。最准确的是线条，但随后我们失去了分辨率独立性。由于某种原因，二次曲线在某些弧线中失败，但三次曲线更准确。

如果我们有以下路径：

```
<svg width="400" height="400">
    <path stroke="red" stroke-width="3" d="M30 30 S40 23 23 42 L23,42 C113.333,113.333 136.667,113.333 150,80 t40,50 T230,240 q20 20 54 20 s40 23 23 42 t20,30 a20,30 0,0,1 -50,-50"/>
</svg> 
```

并使用以下方法对其进行标准化：

```
var path = document.querySelector('path');
path.normalizePath(3, 0.1); // 3 = C = cubic curves. Best alternative, rather good accuracy and path data remains reasonable sized 
```

标准化版本是这样的：

```
<svg width="400" height="400">
    <path stroke="red" stroke-width="3" d="M 30 30 C 30 30 40 23 23 42 L 23 42 C 113.333 113.333 136.667 113.333 150 80 C 150 80 163.333 96.6667 190 130 C 216.667 163.333 230 200 230 240 C 243.333 253.333 261.333 260 284 260 C 284 260 324 283 307 302 C 307 302 313.667 312 327 332 C 324.811 336.924 321.997 341.154 318.719 344.448 C 315.441 347.741 311.762 350.033 307.893 351.194 C 304.024 352.355 300.04 352.361 296.169 351.213 C 292.298 350.064 288.616 347.783 285.333 344.5 C 282.05 341.217 279.23 336.996 277.035 332.078 C 274.839 327.161 273.311 321.642 272.537 315.839 C 271.763 310.035 271.759 304.06 272.525 298.254 C 273.291 292.448 274.811 286.924 277 282"/>
</svg> 
```

如果我们将两者布局在彼此之上，结果是这样的（红色是标准化的，黑色是原始的）：

![规范化路径和原始路径](../Images/478091f1396359285d5b230ec591f00e.png)

其他可能性如下：

```
path.normalizePath(1,0.5); // A->L, Many lines, high accuracy. Very good accuracy, but not so resolution independent, because when scaled, the corners become visible

path.normalizePath(1,40); // A->L, Few lines, less accuracy

path.normalizePath(2,0.5); // A->Q, quadratic curves. I tested this, but not good. Fails in some cases. 
```

**这样做有什么好处？**

规范化路径数据的本机方式尚未在所有浏览器中实现，所以到目前为止我们都是靠自己的。而当实现本机方式时，我们不确定所有浏览器都采用相同的方式。SVG 文档谈到将弧线转换为线，但这不是一个好方法，因为 SVG 的主要优势 - 分辨率独立性 - 将丢失。我们应该完全控制弧的标准化是如何完成的，这个脚本提供了一种方法。

当数据被规范化时，它可以像位图图像中的坐标一样被改变。如果我们想以 Illustrator 方式扭曲（Arc、Arch、Bulge、Shell、Flag、Wave、Fish、Rise、Fisheye、Inflate、Squeeze、Twist）路径或扭曲路径以实现透视错觉，可以修改归一化路径数据可靠。

该代码基于 YannickBochatay 的[脚本](https://gist.github.com/1297684/dac8f9d9d14b1d7814e0050eee705e6dca4c0b73)，我使它更跨浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T21:49:34.960

我想我已经在 Opera、Safari 和 Chrome 中找到了 DOM 异常的原因。

[SVG 文档](http://www.w3.org/TR/SVG/paths.html#InterfaceSVGPathSegList)说`getItem()` *从列表中返回指定的项目。返回的项目是项目本身，而不是副本。对项目所做的任何更改都会立即反映在列表中。*

同样`appendItem()` *在列表末尾插入一个新项目。如果 newItem 已经在列表中，则在将其插入此列表之前将**其从之前的列表中删除。**插入的项目是项目本身，而不是副本。*

所以这是指原始项目：

```
seg = path1.pathSegList.getItem(i); 
```

并且当使用此项目附加到其他路径的段列表时

```
newpath.pathSegList.appendItem(seg); 
```

每个浏览器都有自己的意见如何处理原始 seg。IE9 和 FF 将原始 path1 的段列表保持不变（或至少保留索引（上例中的 i）），并且 Safari、Chrome 和 Opera 从 path1 的段列表中删除 seg。SVG 文档清楚地说明了该项目（***已从其先前的列表中删除***），因此 IE9 和 FF 似乎有错误的实现。因此，我（还）不太确定该项目是从先前的列表中删除还是仅保留了索引（稍后我会检查）。

**编辑：检查这一点，并确认 IE9 和 FF 保持原始路径的 (path1) 段列表完好无损，当它的段附加到其他路径的段列表时，索引也被保留。在 Safari、Chrome 和 Opera 中的行为是不同的：当附加到其他列表时，该项目会从原始列表中删除，并且到目前为止当然索引也会更新（旧索引在附加后不再有效）。制作了确认差异的[jsfiddle](http://jsfiddle.net/timo2012/JDYHM/)。IE9 和 FF 返回 seg 列表长度为 1,1,10,10。Opera、Safari、Chrome 返回 1,0,10,8。**

再一次，我们必须以某种方式考虑浏览器的差异，例如。在第一项之前添加虚拟 seg 或查询 path1.numberOfItems() 以确定原始路径是否被修改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T16:29:41.007

编辑：我修复了 Raphaël 错误，并对动画和非动画复杂路径进行了彻底测试，所以我认为使用 Raphaël 进行路径规范化是明智的。错误的解释及其修复在这里：[https](https://stackoverflow.com/a/13079377/1691517) ://stackoverflow.com/a/13079377/1691517 。Raphaël 的 path2curve 函数可以轻松地将所有路径命令（也 A 即 Arc）转换为规范化形式（即三次曲线）。太好了，Cubics 可以代表所有路径命令！

* * *

另一种方法是使用新的 Raphaël，这是一个有趣的函数[`Raphael.path2curve()`](https://raw.github.com/DmitryBaranovskiy/raphael/master/raphael.js)，它将所有路径命令转换为三次曲线，但它有一些错误。下图可视化了该错误：

![在此处输入图像描述](../Images/6958153e383827c0bcc21f5f7f88f6ce.png)

功能示例在[这里](http://jsfiddle.net/timo2012/8EgfW/10/)，代码如下：

```
<style>path {fill:none}</style>
<script src="http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<div id="res" style="width:800px"></div>
<div id="raphael"></div>

<script>
window.onload = function () {
var paper = Raphael("raphael", 400, 400);
var original_path = "M30 30 S40 23 23 42 L23,42 C113.333,113.333 136.667,113.333 150,80 t40,50 T230,240 q20 20 54 20 s40 23 23 42 t20,30 a20,30 0,0,1 -50,-50";
var arr=Raphael.path2curve(original_path);
var normalized_path = arr.toString();

var path1 = paper.path(normalized_path).attr({stroke: "red", "stroke-width":6});
var path2 = paper.path(original_path).attr({stroke: "black", "stroke-width":2});

document.getElementById("res").innerHTML="ORIGINAL PATH (black):<br>"+original_path+"<br><br>NORMALIZED PATH (red):<br>"+normalized_path;
}
</script>​ 
```

在 Raphaël 中进行路径规范化会非常好，因为它支持大量浏览器并使用数组而不是 DOM 路径段（= 速度和向后兼容性）。我做[了一个错误报告](https://github.com/DmitryBaranovskiy/raphael/issues/629)。希望它在将来的某个版本中得到修复。

# python - 接收 UDP 广播 [VirtualBox, Ubuntu, Python]

> ID：12977482
> 
> 赞同：6
> 
> 时间：2012-10-19T15:24:15.890
> 
> 标签：python, networking, ubuntu, virtualbox, broadcast

我有一个 Ubuntu 虚拟机侦听主机生成的 UDP 广播数据包。如果我使用 python 的 socket.bind 方法绑定到我的网络接口 eth1 或 lo （本地环回），我不会收到任何数据包。但是，如果我使用 '' （所有接口的符号）进行绑定，那么一切都很好。我希望可以仅绑定到 eth1 的地址，但似乎并非如此。有人可以解释为什么需要''吗？是否因为我使用的是虚拟机而发生了一些奇怪的事情？我正在使用桥接网络设置，因此虚拟机看起来就像我 LAN 上的另一台机器。这是代码：

```
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1) 

# using the '' address works
sock.bind(('', UDP_PORT))
# using the address of eth1 doesn't
#sock.bind(('192.168.2.123', UDP_PORT))
# and neither does using the local loopback
#sock.bind(('127.0.0.1', UDP_PORT))

while True:
    data, addr = sock.recv(2048)
    print data 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-30T14:33:52.750

在网络编程中，空地址字符串表示*所有已配置的接口*。但是，如果指定了 IP 地址，则套接字将仅侦听具有指定 IP 地址的接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:16:38.657

There is also the option '<broadcast>' to bind to a broadcast address (according to [http://docs.python.org/2/library/socket.html](http://docs.python.org/2/library/socket.html)). So I'd suggest that you try to use your interface's broadcast address, like 192.168.2.255 (assuming your network is 192.168.2.0/24).

# jsf-2 - 使用 JSF @managed 属性从 Spring Container 调用预实例化 bean 时的空指针

> ID：12977484
> 
> 赞同：0
> 
> 时间：2012-10-19T15:24:25.170
> 
> 标签：jsf-2, nullpointerexception, spring-3

我正在尝试使用`@ManagedProperty`注释使用在 JSF ManagedBean 中的 spring 容器中创建的 bean。但是在使用该 bean 时我得到空指针。一旦我启动我的服务器，我可以看到我的 bean 是在这里创建的

```
Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@9d532ae: defining beans [org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,userBean,userService]; 
```

主页Bean.java

```
package come.test.backingbean

 @ManagedBean
    @sessionScoped

        public Class HomepageBean{

        @ManagedProperty(value="#{userBean}")
        private UserBean userBean;// getters and setters

       public String doLogin() {
            String url = "login.xhtml";
            LoginBean manager = new LoginBean();  // This bean has a condition which check for Username and password entered by user.
            if (manager.auth(username, password)) {
                isLoggedIn = true;
                url = "homepage";
                String username=sample;
                userBean.getUserInfo(username);
            } else {
                FacesContext context = FacesContext.getCurrentInstance();
                context.addMessage(username, new FacesMessage(
                        "Invalid Username and or Password"));
            }
            return url;
        } 
```

用户Bean.java

```
package com.test.mypackage

@Component
Public Class UserBean{

@Autowired
private UserService userServie  // getters and setters.

     public void getUserInfo(String userId){
      userService.findByUserId(userId)
 }
}
} 
```

用户服务.java

```
package com.test.service;

public interface UserService {

    public void save(User User);
    public void update(User user);
    public void delete(User user);
    public User findByUserId(String userId);

} 
```

我可以看到我的服务器何时启动我尝试使用的 bean 是预先实例化的。我将我`applicationContext.xml`的 in定义`web.xml`为`Context-param`. 我正在`Spring.xml` 像这样定义所有的豆子

春天.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<context:annotation-config />

<context:component-scan base-package="com.test" />

<bean class="org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor"/>

</beans> 
```

这是在我的类路径中，并将其作为资源导入`applicationContext.xml`.

应用程序上下文.xml

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:security="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <import resource="classpath:database/DataSource.xml" />

    <import resource="classpath:database/Hibernate.xml" />

   <import resource="classpath:config/Spring.xml" />

</beans> 
```

我的面孔-confi.xml

```
<application>
   <el-resolver>org.springframework.web.jsf.el.SpringBeanFacesELResolver</el-resolver>
    <resource-bundle>
        <base-name>com.test.boundles.messages</base-name>
        <var>msg</var>
    </resource-bundle>
    </application> 
```

我的方法有任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T22:12:08.327

有很多事情应该处理得更好。

1) 你只需要`<context:component-scan base-package="com.test" />`，删除 annotation-config 和 AutowiredAnnotationBeanPostProcessor。

请参阅原因： <context:annotation-config> vs <context:component-scan> 和[文档](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/annotation/AutowiredAnnotationBeanPostProcessor.html)[之间的区别](https://stackoverflow.com/questions/7414794/difference-between-contextannotation-config-vs-contextcomponent-scan)

2）您的 UserBean 上没有范围，如果您没有提及任何范围，则默认范围将是 Singleton，我认为在这种情况下不适合。

3）您正在尝试使用接口而不是实现此接口的可实例化类。

4）然后您应该使用@Service 标记实现类以自动装配。

5）我希望你有getter和setter，而不仅仅是那些评论。

有关一个很好的示例，请参阅此[链接](http://cagataycivici.wordpress.com/2007/12/19/annotate-jsf-beans-with-spring-25/)

也可以看看：

*   [@Scope（“请求”）不起作用](https://stackoverflow.com/questions/12470512/scoperequest-not-working)

# javascript - 将我的 jquery .load 转换为 .ajax

> ID：12977489
> 
> 赞同：2
> 
> 时间：2012-10-19T15:24:52.787
> 
> 标签：javascript, jquery, ajax, load

我有一个需要转换为 .ajax() 的 .load() 函数。我最初使用 .load() 是因为它易于使用，但现在我看到为了达到我想要的结果，我必须使用 .ajax()。这是我的 .load() 函数：

```
$("#rightframe").click(function(){
    $("#screen").load("form.html #contact");
  }); 
```

我想将其转换为 .ajax() 并添加以下代码以设置 .ajax() 调用所需的最短时间（这是因为我有一个加载 GIF，如果它运行时间不够长，它看起来很奇怪)

因此，当我试图弄清楚如何设置加载 GIF 所需的最短时间时，我发现[了这段代码。](https://stackoverflow.com/questions/5025839/ajax-loader-image-how-to-set-a-minimum-duration-during-which-the-loader-is-show)

```
var counter = 2;
function decrement() {
  if (--counter == 0) {
    $('#loader').hide();
  }
}
setTimeout(decrement, 1000);
$.ajax(..., complete: decrement); 
```

有谁知道如何将 .load() 函数更改为 .ajax() 并将递减函数添加到 .ajax() 函数？

谢谢，

凯蒂

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:32:11.637

我想你会想要这样的东西：

```
$("#rightframe").click(function () {
    $("#loader").show();
    setTimeout(function () {
        $.ajax({
            url: "form.html",
            complete: function () {
                $("#loader").hide();
            },
            success: function (data) {
                $("#screen").empty().append($(data).find("#contact"));
            },
            error: function () {
                // Handle an error occurring
            }
        });
    }, 2000);
}); 
```

我不确定您为什么要使用/需要该`decrement`功能，但是类似此代码的内容应该可以确保加载图像显示足够长的时间。

# sql - SQL 将 Int 转换为 Date 或 Char

> ID：12977490
> 
> 赞同：1
> 
> 时间：2012-10-19T15:24:53.347
> 
> 标签：sql, sql-server-2008

我的 dbase 具有 6 位数的日期格式和 int 数据类型（'734503' = 01/01/2012）。我已经能够成功地将这些转换为字符：

```
SELECT CONVERT(char(12),dateadd(dd,(date_paid -    639906),'1/1/1753'),101)  
FROM   vouchers       
WHERE date_paid =    '734503' 
```

这给了我 2012 年 1 月 1 日的输出。但是，如果我在这样的查询中搜索转换后的日期：

```
SELECT CONVERT(char(12),dateadd(dd,(date_paid - 639906),'1/1/1753'),101) 
FROM vouchers    
WHERE date_paid >= '09/01/2012'  AND date_paid <= '09/30/2012' 
```

为什么没有发生转换？即使我在 date_paid 字段的 WHERE 语句中使用 CONVERT，它不应该在那里工作吗？

我想我的问题是如何使用转换后的字符日期进行搜索而不必使用 6 位日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:32:05.607

您的问题是您正在将 INT 列与 STRING 值进行比较，并希望它能够像比较日期一样解决......

```
WHERE date_paid >= '09/01/2012'
  AND date_paid <= '09/30/2012' 

-- date_paid is an INT (according to your question)
-- '09/01/2012' is a STRING 
```

由于不同的数据类型，那里有一个***隐式***的CAST() 。实际上你正在做...

```
WHERE CAST(date_paid AS VARCHAR(10)) >= '09/01/2012'
  AND CAST(date_paid AS VARCHAR(10)) <= '09/30/2012' 

-- NOTE:  All of these values are now strings
--        They may LOOK like dates, but they're just strings 
```

您真正需要做的是将字符串***显式***操作为整数。

```
WHERE date_paid >= DATEDIFF(DAY, '01/01/1753', '09/01/2012') + 639906
  AND date_paid <= DATEDIFF(DAY, '01/01/1753', '09/30/2012') + 639906 
```

这也涉及隐式强制转换。DATEDIFF() 仅采用 DATETIME 数据类型，因此首先将字符串隐式转换为 DATETIME。

**编辑：**

另一种选择是将`date_paid`字段 CAST() 转换为 DateTime，然后以此为基础`WHERE`。这里
的缺点是...... - CAST() 必须在每一行上完成，然后应用 WHERE 子句
- 这可以防止任何索引的使用并显着降低性能

上面的答案对常量值进行了所有操作，以便可以在其本机状态下处理搜索到的字段；从而允许使用索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:40:15.407

首先，如果可以的话，改变你的数据库模式。date_paid 列的数据类型应该是`datetime`or `date`，而不是 'int' 或 'char'。

...但是如果您坚持使用此模式，那么您的`date_paid`值似乎是整数，其中 693596 的值表示`1 jan 1900`. （此日期是 SQL Server 零值映射到的位置。）因此，您需要做的就是将搜索值移动或偏移该数量。

假设您要搜索的日期是今天，2012 年 10 月 19 日

```
 Declare @SearchDate DateTime = '20 Oct 2012' 
```

然后将您的查询谓词编写为：

```
 Select * From vouchers
  Where date_paid = DateDiff(day, 0, @searchDate) + 693596 
```

确保构建查询结构，以便所有处理或计算都在列等号的*另一*`date_paid`侧完成（如我的示例所示）。这样，查询处理器可以使用索引`date_Paid`是否存在。如果查询有任何函数调用或其他计算`date_Paid`，则查询将不得不读取整个表并且不能使用其他可用的索引请参阅[SARGable](http://en.wikipedia.org/wiki/Sargable)。

顺便说一句，我很好奇这个设计（用这么大的整数来表示日期）的确切来源，我注意到这个值正好等于 1900 * 365，这意味着在这个方案中，一个零值 reptresetns 零年（基督出生时）的 1 月 1 日，这很酷，但不能在 SQL Server 日期中使用它，因为 SQL Server 值将日期表示为 16 位有符号整数，映射为零到 1900 年 1 月 1 日，并且仅限于 16 位整数 (-16,384) 中的最小值，这等于 1753 年左右的某个日期。

# greedy - 与急切/贪婪搜索相反的术语是什么？

> ID：12977491
> 
> 赞同：8
> 
> 时间：2012-10-19T15:24:56.527
> 
> 标签：greedy

因此，即使即将推出更好的解决方案，您也可以在急切的搜索中采用初始解决*方案*...

急切搜索*的*反义词是什么？我所有的谷歌搜索结果都让我参考了 Paul Revere 的骑行。在这些混乱和不确定的时代，确实是一个令人欣慰的想法，但并不是真的……有用。

有这样的说法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-01-16T14:27:22.623

我认为将“贪婪”和“渴望”视为相同是不正确的。

## 贪婪和节俭的优化

贪心算法是指将局部最佳选择视为最佳全局选择的优化范式。这当然是迭代完成的，因此本地邻域会发生变化。该算法始终是它在当前迭代中“看到”的选项的最佳选择。贪心优化算法的一个例子是梯度下降。

非贪婪/节俭优化算法更全局地考虑选项。它尝试检查更多选项。例如贝叶斯优化和许多形式的群体优化技术，尤其是萤火虫优化（afaik 他们找到了所有的局部最优）。

## 渴望和懒惰的学习

“渴望”用于“渴望学习”的上下文中。“渴望学习”的反面是“懒惰学习”。这些术语表示数据的数学建模是在单独的先前学习阶段发生，还是仅在该方法应用于新数据时发生。例如，多项式回归是急切的，而高斯处理回归或核回归是惰性的。

这与方法是参数化（通常是渴望学习）还是非参数化（通常是惰性学习）密切相关，但并非总是如此。例如，决策树是渴望学习者，但仍然是非参数的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-19T23:53:01.840

“节俭”是我见过的唯一术语（除“非贪婪”外）。它足够直观，大多数人都能从上下文中理解含义。

# grails - Grails从域中的belongsTo访问值？

> ID：12977492
> 
> 赞同：0
> 
> 时间：2012-10-19T15:25:02.163
> 
> 标签：grails, spring-security, grails-orm, relationship

我正在开发一个 Grails 项目，并且我有一个用户域模型，其中包含以下内容：

```
class SecUser {

    transient springSecurityService

    String username
    String email
    String password
    boolean enabled
    boolean accountExpired
    boolean accountLocked
    boolean passwordExpired

    static belongsTo = [area:Areas] 

    .....
} 
```

我也在使用 springSecurityUI，我在创建用户视图中有这个：

```
<s2ui:textFieldRow readonly='yes' name='area' labelCode='user.area.label' bean="${user}"
                                labelCodeDefault='Area' value="${area}"/> 
```

当我看到创建视图而不是看到填充当前登录用户区域的区域框时，我可以看到以下内容：

```
com.testapp.Areas : 1 
```

我假设这是该用户的部门 ID，但我想显示实际值，我该如何为关系对象执行此操作？

谢谢您的帮助

编辑.......

以下是我的区域课程

类领域{

```
String name

static hasMany = [users:SecUser] 
```

}

编辑...

我现在使用以下方法解决了这个问题：

```
value="${area.name}" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:37:46.867

`com.testapp.Areas : 1`是默认`toString()`方法的输出。要更改输出，您需要`toString()`在`Areas`.

```
class Areas {

    String toString() {
        "the actual string representation of my Areas object"
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T16:59:41.437

如果您只想显示实际的**id**属性，那么您可以这样做：

```
<s2ui:textFieldRow readonly='yes' name='area' labelCode='user.area.label' bean="${user}"
                            labelCodeDefault='Area' value="${area?.id}"/> 
```

# javascript - Websocket、iPad、Chrome 和 Safari，onend 杀死浏览器

> ID：12977495
> 
> 赞同：0
> 
> 时间：2012-10-19T15:25:13.143
> 
> 标签：javascript, ipad, google-chrome, safari, websocket

我有一个使用 websockets 的 HTML 应用程序。除了一件事之外，台式机和 iPad（Safari 和 Chrome 最新版本）上的一切都很好。如果*我有一个打开的连接*并终止了服务器，**那么 iPad 上的**两个浏览器只会**炸毁**并关闭。它适用于桌面。

有没有办法访问一些日志文件或任何东西？试图将我处理的代码包装`onclose`在 a`try-catch`但没有成功。

工作流程是这样的：`ws.onclose`启动一个尝试重新连接的间隔。就这么简单。

想法？

# jquery - jquery搜索id里面

> ID：12977496
> 
> 赞同：0
> 
> 时间：2012-10-19T15:25:15.907
> 
> 标签：jquery

我有一个用 jquery 开发的网站。我想选择所有包含 certian 字符串的 id，例如：

```
<div id="home_test_div">
</div>
<span id"agency_test_span">test</span> 
```

我想搜索其 id 中包含 string 的所有元素`test`。我知道如何搜索以某个字符串开头或以某个字符串结尾但在里面的 id？我以前从来没有这样做过。我尝试使用该代码：

```
var search = "test";
$("[id$='"+search+"']").each(function(index) {
  //some code
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:26:22.070

您可以使用[`attribute contains`](http://api.jquery.com/attribute-contains-selector/)选择器：

```
$("[id*='"+search+"']").each(function(index) {
  //some code
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:26:48.187

尝试

```
$("[id*='"+search+"']").each(function(index) { 
```

您正在尝试查找 id 以**text**结尾的选择器。但在你的情况下，我没有看到任何 id 以**test结尾。**

因此，请尝试替换为`*` 搜索包含的选择`test`器

# spring - 415 Spring 中不支持的媒体类型 JAXB

> ID：12977501
> 
> 赞同：4
> 
> 时间：2012-10-19T15:25:29.240
> 
> 标签：spring, jaxb, http-post

![我的 POST 设置标题](../Images/ad1d5b5031f2012e6f20602b1ff42e9b.png) ![主要 POST 设置](../Images/8f60d5bfd9b670864c23769872c667db.png)

我有点卡在这里。我正在尝试从 firefox 的海报上发布一小段 XML。

```
 <IntellexEvent>
 <RuleName>a rule name</RuleName>
 </IntellexEvent> 
```

很简单，现在我的课`IntellexEvent`是

```
@XmlRootElement(name = "IntellexEvent")
public class IntellexEvent {    
 // @XmlElement(name = "RuleName")
    private String RuleName;
    public String getRuleName()
    {
        return RuleName;
    }

    public void setRuleName(String RuleName)
    {
         this.RuleName = RuleName;
    } 
```

}

我的控制器是...

```
@Controller

@RequestMapping("/cace/**")
public class CaceController 
{
    @Autowired
    IUserService userService;

    public CaceController()
    {

    }

@RequestMapping(value = "/cace/postXML", method = RequestMethod.POST)
    public Result postXML(@RequestBody String intellexEvent) throws Exception
    {   
        String temp = intellexEvent;

        Result result = new Result();
        result.setStatusCode(200);
        result.setSuccess(true);
            return result;
    } 
```

}

--EDITED -- 所以在这里我将@RequestBody 作为字符串。我想要的是让它自动编组为 IntellexEvent.... 作为一个字符串，我能够在 POST 上访问我的后端，当我将字符串更改为 IntellexEvent 时，我得到一个 415 错误。

我只是希望能够访问我的后端，我已经尝试过 GET，而且我打得很好，（我没有将它们包含在我的控制器中）我在这里缺少什么？在 spring-mvc-servlet.xml 中，我定义了 jaxb2 marshaller。如果您需要更多信息，请询问，在此先感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:55:40.830

您可能缺少`Content-Type`标题，应该是`application/xml`，这是为了让 Spring-MVC 知道您正在发布一个 xml。此外，如果您希望响应是 xml，则您已使用 .xml 注释您的 postXML 方法并`@ResponseBody`具有.`Accept``application/xml`

postXML 应如下所示：

```
@RequestMapping(value = "/cace/postXML", method = RequestMethod.POST)
public @ResponseBody Result postXML(@RequestBody IntellexEvent intellexEvent) throws Exception 
```

我注意到的另一件事是您需要取消`@XmlElement(name = "RuleName")`对`ruleName`字段的注释，否则标签最终会变成`<ruleName/>`

# exception - HIVE加入问题

> ID：12977502
> 
> 赞同：0
> 
> 时间：2012-10-19T15:25:31.737
> 
> 标签：exception, join, hadoop, hive

我在 5 台机器上安装了 Hive（Hive-0.8、Hadoop-1.0.3），每当我尝试加入两个表时，我都会收到以下异常：

> java.lang.RuntimeException：从 org.apache.hadoop.hive.ql.exec 的 org.apache.hadoop.hive.ql.exec.errors.TaskLogProcessor.getErrors(TaskLogProcessor.java:130) 的任务日志 URL 读取时出错.JobDebugger.showJobFailDebugInfo(JobDebugger.java:211) at org.apache.hadoop.hive.ql.exec.JobDebugger.run(JobDebugger.java:81) at java.lang.Thread.run(Unknown Source) 原因：java .io.IOException：服务器返回 HTTP 响应代码：400 对于 URL：http://hadoop4:50060/tasklog?taskid=attempt_201210161122_0013_r_000001_4&start=-8193

url 可以指向不同的机器。

所以我通过谷歌搜索发现，如果我更改`taskid`为`attemptid`then 我可以看到实际问题，这就是这个异常：

> FATAL ExecReducer: java.lang.IllegalArgumentException: nanos > 999999999 或 < 0 at java.sql.Timestamp.setNanos(Unknown Source) at org.apache.hadoop.hive.serde2.io.TimestampWritable.populateTimestamp(TimestampWritable.java:348)在 org.apache.hadoop.hive.serde2.io.TimestampWritable.toString(TimestampWritable.java:320) 在 org.apache.hadoop.hive.serde2.lazy.LazyTimestamp.writeUTF8(LazyTimestamp.java:95) 在 org.apache .hadoop.hive.serde2.lazy.LazyUtils.writePrimitiveUTF8(LazyUtils.java:232) 在 org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe.serialize(LazySimpleSerDe.java:427) 在 org.apache.hadoop.hive .serde2.lazy.LazySimpleSerDe.serializeField(LazySimpleSerDe.java:381) 在 org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe.serialize(LazySimpleSerDe.java:365) 在 org.apache.hadoop.hive.ql.exec .FileSinkOperator.processOp(FileSinkOperator.java:569) 在 org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471) 在 org.apache.hadoop.hive.ql.exec.Operator.forward( Operator.java:762) at org.apache.hadoop.hive.ql.exec.SelectOperator.processOp(SelectOperator.java:84) at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:第471章.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471) 在 org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762) 在 org.apache.hadoop .hive.ql.exec.CommonJoinOperator.genAllOneUniqueJoinObject(CommonJoinOperator.java:749) 在 org.apache.hadoop.hive.ql.exec。CommonJoinOperator.checkAndGenObject(CommonJoinOperator.java:836) at org.apache.hadoop.hive.ql.exec.JoinOperator.endGroup(JoinOperator.java:263) at org.apache.hadoop.hive.ql.exec.ExecReducer.reduce( ExecReducer.java:198) 在 org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:519) 在 org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:420) 在 org.apache.hadoop .mapred.Child$4.run(Child.java:255) at java.security.AccessController.doPrivileged(Native Method) at javax.security.auth.Subject.doAs(Unknown Source) at org.apache.hadoop.security.UserGroupInformation .doAs(UserGroupInformation.java:1121) 在 org.apache.hadoop.mapred.Child.main(Child.java:249)263）在 org.apache.hadoop.hive.ql.exec.ExecReducer.reduce(ExecReducer.java:198) 在 org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:519) 在 org.apache.hadoop .mapred.ReduceTask.run(ReduceTask.java:420) 在 org.apache.hadoop.mapred.Child$4.run(Child.java:255) 在 java.security.AccessController.doPrivileged(Native Method) 在 javax.security。 auth.Subject.doAs(Unknown Source) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121) at org.apache.hadoop.mapred.Child.main(Child.java:249)263）在 org.apache.hadoop.hive.ql.exec.ExecReducer.reduce(ExecReducer.java:198) 在 org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:519) 在 org.apache.hadoop .mapred.ReduceTask.run(ReduceTask.java:420) 在 org.apache.hadoop.mapred.Child$4.run(Child.java:255) 在 java.security.AccessController.doPrivileged(Native Method) 在 javax.security。 auth.Subject.doAs(Unknown Source) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121) at org.apache.hadoop.mapred.Child.main(Child.java:249)java:255) at java.security.AccessController.doPrivileged(Native Method) at javax.security.auth.Subject.doAs(Unknown Source) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121) at org.apache.hadoop.mapred.Child.main(Child.java:249)java:255) 在 java.security.AccessController.doPrivileged(Native Method) 在 javax.security.auth.Subject.doAs(Unknown Source) 在 org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121) 在org.apache.hadoop.mapred.Child.main(Child.java:249)

我不确定整个堆栈跟踪是否有帮助，但我从谷歌搜索中发现，异常是指向 IBM DB2 的 IBM 更新/修复的链接。我不知道这是否与任何 Hive 问题有关，即使有，我也不知道该怎么做。

谁能指出我正确的方向？

PS：我已经尝试过针对旧版本的 Hive/Hadoop 在线建议的解决方案，但它们都没有产生任何结果。另外，我也检查了`NULL`值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-01T21:41:08.690

你真的应该提供完整的sql。在任何情况下，以下内容都是无效的：

```
nanos > 999999999 or < 0 
```

应该：

```
(nanos > 999999999 or nanos < 0) 
```

因此，“在视图中”工作正常是不正确的。作为创建视图的一部分，您必须纠正该语法错误。IOW 您的视图与独立查询*不匹配。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T16:23:03.443

您最好提供有关您的配置单元环境的更多信息。比如你的表模式和原始数据。

在您提供的上述异常中，问题可能是您存储在 hdfs 中的数据与配置单元日期列不匹配。

# r - 如何使用 R 指定特定年份每个月的天数？

> ID：12977504
> 
> 赞同：1
> 
> 时间：2012-10-19T15:25:48.013
> 
> 标签：r, binary

我正在尝试计算每月产品（二进制文件）的年度总数 [https://echange-fichiers.inra.fr/get?k=Jr3tvgeKnWUiC1B0MMY](https://echange-fichiers.inra.fr/get?k=Jr3tvgeKnWUiC1B0MMY)。所以我有 12 个文件，我必须计算总和。下面给出的代码运行良好，但我需要将每个文件乘以对应于该年该月的天数，然后计算总和。就我而言，这些数据是 2000 年（闰年），所以我想将文件号 1 的结果乘以 31，将文件号 2 的结果乘以 29，依此类推....

```
files<- list.files("C:\\jung file_2000_img", "*.img", full.names = TRUE)
x<- do.call(rbind,(lapply(files, readBin  , double() , size = 4 , n=360 * 720 , signed =TRUE)))
results <- colSums(x)
fileName <- sprintf("C:\\annual_ET2000_without999_1.img")
writeBin(as.double(results), fileName, size = 4) 
```

根据詹姆斯的回答，这将计算天数：

```
numDays <- function(month,year){
    as.numeric(strftime(as.Date(paste(year+month%/%12,month%%12+1,"01",sep="-"))-1,"%d"))
} 
```

那么现在如何将它应用到我上面的代码中呢？我的意思是我想获取每个文件的结果并将其乘以天数，例如：

```
file1*numDays(1,2000)+file2*numDays(2,2000)+file3*numDays(3,2000)
   .............file12*numDays(12,2000) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:34:55.763

您可以通过从下个月的第一天向后移动一天来获得该月的最后一天。所以，试试这个：

```
numDays <- function(month,year){
  as.numeric(strftime(as.Date(paste(year+month%/%12,month%%12+1,"01",sep="-"))-1,"%d"))
} 
```

测试：

```
numDays(2,2012)
 [1] 29
numDays(2,2011)
 [1] 28
numDays(1,2011)
 [1] 31
numDays(12,2011)
 [1] 31
# vector of all month days in year 2000
sapply(1:12,numDays,2000)
 [1] 31 29 31 30 31 30 31 31 30 31 30 31 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-02T22:30:29.790

我建议你使用 package `lubridate`，它对这些类型的东西有很多有用的功能。例如：

```
> lubridate::days_in_month(as.Date("2000-02-01"))
Feb 
 29 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T18:56:30.553

[@James](https://stackoverflow.com/a/12977662/892313)为您提供了一个查找一个月中天数的功能（您已将其纳入您的问题）。下一步是按天数对每月值进行加权。问题是你已经把所有的月份都放在一起了，没有办法知道之后哪个是哪个。所以不要把它们组合那么多：

```
files<- list.files("C:\\jung file_2000_img", "*.img", full.names = TRUE)
x<- lapply(files, readBin  , double() , size = 4 , n=360 * 720 , signed =TRUE)
results <- sapply(x, colSums)
ann.results <- sum(sapply(1:12, function(m) {results[[m]] * numDays(m, 2000)})) 
```

这是一个巨大的假设：`files[[1]]`对应于一月，`files[[12]]`对应于十二月，以及所有匹配之间。

这样做是制作一个数据框列表，每个月一个。然后它使用`colSums`整个列表来制作一个包含每个月总数的向量（与 相同的顺序`files`）。最后，将月份迭代为`results`具有天数的多个对应值（再次假设这是正确的对应月份）。

# categories - 每个类别只显示一个条目

> ID：12977505
> 
> 赞同：1
> 
> 时间：2012-10-19T15:25:54.393
> 
> 标签：categories, expressionengine

我对 EE 比较陌生，而且我在类别方面遇到了麻烦......

我在这里有这个页面：

[http://www.nationallighting.ie/testbed/index.php/products](http://www.nationallighting.ie/testbed/index.php/products)

所有的产品都被分类并分成盒子，所以当一个盒子被点击时，div 幻灯片显示类别。（到目前为止，我只添加了一些项目，例如户外类别中有 2 个）

现在我的问题是，当我单击单个项目并转到“单个产品”模板时

[http://www.nationallighting.ie/testbed/index.php/products-single](http://www.nationallighting.ie/testbed/index.php/products-single)

列出的每个类别都有一个项目，而我只想显示我最初点击的项目，所以只有一个项目在“单一产品”模板中。

这里是“单品”模板的EE代码，明显是我做错了，看不出来是什么！！！任何帮助是极大的赞赏！！！

```
 <!-- content about inside -->
    <div class="inside products">
    <h3>Product details</h3>
    {exp:channel:categories style="linear" channel="products"}
    {exp:channel:entries channel="single_product" category="{category_id}" limit="1"}
    <div class="description">

        <img src="{cat_main_image}" alt="{title}" />
        <div class="descr-inside">
        <h3>Crystal - Sgopera-3ch</h3>
        <p><strong>Description: </strong>3 Light Pendant with glass beads</p>
        <p><strong>Supplier: </strong>Endon</p>
        <p><strong>Width: </strong>455mm</p>
        <p><strong>Height: </strong>695mm</p>
        <p><strong>Lamp Type: </strong>GU10</p>
        <p><strong>Max. Wattage: </strong>3 x 50W</p>
        <p><strong>Energy saving: </strong>yes</p>
        </div>

    </div>
    {/exp:channel:entries}
    {/exp:channel:categories}
    </div> <!-- end of inside --> 
```

# java - 我想使用java对字符串值中的字符、数字和特殊字符进行分组？

> ID：12977506
> 
> 赞同：-1
> 
> 时间：2012-10-19T15:25:57.123
> 
> 标签：java, string

我想从给定的字符串输入中分离字符、数字和特殊字符。

目标是首先对字符值进行分组并添加数字，然后打印下一个带有最后一个特殊字符的字符。

```
Example:
Input:sep2tr8sg0*@sdb($67)hs
Output:seotrsqsdbhs13*@($) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:30:39.387

我可能不应该回答，但这是我的停顿；-)

```
public static void main(String args[]) {
    String s = "sep2tr8sg0*@sdb($67)hs";

    StringBuilder letters = new StringBuilder();
    StringBuilder numbers = new StringBuilder();
    StringBuilder other = new StringBuilder();

    for (char c : s.toCharArray()) {
        if (Character.isLetter(c)) letters.append(c);
        else if (Character.isDigit(c)) numbers.append(c);
        else other.append(c);
    }

    String output = letters.append(numbers).append(other).toString();

    System.out.println(output);
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-03-23T11:05:26.497

分隔字符编号和特殊符号

```
 StringBuffer alpha = new StringBuffer(),
 num = new StringBuffer(), special = new StringBuffer();
 final String txt= txtview2.getText().toString();
 alpha1.setText(txtview2.getText().toString());
 num1.setText(txtview2.getText().toString());
 special1.setText(txtview2.getText().toString());
 Toast.makeText(MainActivity.this,"you enter string:"+txt,Toast.LENGTH_SHORT).show();
 for (int i=0; i<txt.length(); i++)
 {
     if (Character.isDigit(txt.charAt(i)))
         num.append(txt.charAt(i));
     else if(Character.isLetter(txt.charAt(i)))
         alpha.append(txt.charAt(i));
     else
         special.append(txt.charAt(i);
 }
 alpha1.setText("The Character: " +alpha);
 num1.setText("The digit:" + num);
 special1.setText("The special symbol: " + special);
} 
```

# javascript - Rally 外部应用程序中的 PortfolioItem 查询

> ID：12977510
> 
> 赞同：3
> 
> 时间：2012-10-19T15:25:59.807
> 
> 标签：javascript, rally

我们希望在我们的 SharePoint 站点中显示[Portfolio Timeline Rally 应用程序](http://developer.rallydev.com/help/portfolio-item-timeline-app)，以便高层管理人员可以很好地了解我们的产品组合中的哪些内容，但看起来该功能不可用。因此，作为“下一个最好的事情”，他们想要一个包含开始/结束日期的投资组合项目列表以及在表格中显示的一些其他字段。

到目前为止，我已经能够为只读用户生成登录密钥，将其放入我在 Rally 网站和 SO 之间找到的一些示例代码中，并成功显示用户故事列表：

```
 <script type="text/javascript" src="https://rally1.rallydev.com/apps/1.28/sdk.js?loginKey=[loginkey]"></script>
 <script type="text/javascript">
    function onLoad() {
        rally.sdk.ui.AppHeader.destroy();
        var workspaceId = "0123456789";
        var projectId = "0123456789";
        var rallyDataSource = new rally.sdk.data.RallyDataSource(workspaceId,projectId, 'false', 'true');
        var config = {type: "hierarchicalrequirement", columnKeys:["FormattedID", "Name"]};
        var table = new rally.sdk.ui.Table(config, rallyDataSource);
        table.display("tableDiv");
    }
    rally.addOnLoad(onLoad);
</script> 
```

这很好用。但是，我遇到了以下问题：

*   如果我尝试将配置的类型从 hierarchyrequirement 更改为 PortfolioItem 它似乎没有检索到任何东西
*   如果我尝试将 sdk.js 上的 rev 提高到 1.28 以上，则 rally.addOnLoad 似乎根本不会触发 onLoad 事件，如果我让它触发，我会在代码中遇到一些其他错误（例如 RallyDataSource 未定义）我自己的 onLoad 事件

我错过了一些非常明显的东西吗？2.0 SDK 还有什么我应该使用的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T16:53:56.097

由于合并了 Rally Webservices API 中的更改以允许[动态键入 Portfolio Items](http://www.rallydev.com/help/portfolio-item-query-changes)，因此在使用 AppSDK 1.x 时，有必要将 AppSDK Javascript 工具包 (1.32) 的最新可用版本与 Webservices API 版本 1.37 配对，这处理 PortfolioItems 的动态类型。

以下方法应适用于您的代码：

```
<script type="text/javascript" src="https://rally1.rallydev.com/apps/1.32/sdk.js?loginKey=[loginkey]"></script>
 <script type="text/javascript">
    function onLoad() {
        rally.sdk.ui.AppHeader.destroy();
        var workspaceId = "123456789";
        var projectId = "2345678910";
        var rallyDataSource = new rally.sdk.data.RallyDataSource(workspaceId,projectId, 'false', 'true');
        // Set Webservices API version to use 1.37
        rallyDataSource.setApiVersion('1.37');
        var config = {type: "portfolioitem", columnKeys:["FormattedID", "Name"]};
        var table = new rally.sdk.ui.Table(config, rallyDataSource);
        table.display("tableDiv");
    }
    rally.addOnLoad(onLoad);
</script> 
```

AppSDK 2.0+ will be the best approach to handle Portfolio Item types moving forward as it will be the preferred and supported Javascript toolkit once it is GA. However, at this time, a "LoginKey-like" functionality is not yet available in AppSDK 2.0 preview - so the above approach should get you by with LoginKey in AppSDK 1.32 for now.

# resize - RMagick 质量不适用于 to_blob

> ID：12977511
> 
> 赞同：0
> 
> 时间：2012-10-19T15:26:02.007
> 
> 标签：resize, imagemagick, blob, rmagick

我正在尝试调整图像大小并降低从数据库中提取的图像的质量，并能够以减小的大小将其保存回数据库。

到目前为止，我正在尝试以下 RMagick 方法：

```
image = Image.from_blob(origImage.data).first do
        self.format = "png"
      end
      image.resize_to_fit!(width)
      image.quality = 60
      newImage = image.to_blob 
```

但是 image.quality 的值对来自**to_blob**的数据大小没有**影响**。

我这样做正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T16:00:31.670

尝试将质量参数放在 to_blob 方法上。

```
# image.quality = 60 # ignore this
newImage = image.to_blob { self.quality = 60 } 
```

您可能在那里输出与 origImage 相同的格式 -`format`似乎不适用于`from_blob`. `from_blob`我必须在设置PNG格式的行之后专门调用它。

```
image = Magick::Image.from_blob(origImage.data).first do
#    self.format = 'PNG'
end
image.format = 'PNG' 
```

# java - ew@OneToOne 与不使用 JOIN 的播放框架的关系

> ID：12977513
> 
> 赞同：0
> 
> 时间：2012-10-19T15:26:04.033
> 
> 标签：java, jpa, playframework, playframework-1.x

我有 2 个具有 @OneToOne 关系的模型。比方说一个模型`User`和一个模型`Player`。每个用户都是玩家，每个玩家都是用户。

这是这两个模型的代码：

```
@Entity
public class User extends Model {

    @Required
    public String name;

    @OneToOne(fetch = FetchType.EAGER)
    public Player player;
}

@Entity
public class Player extends Model {

    @Required
    public String nickname;

    @Required
    public Gender gender;
} 
```

我将始终`Player`从 a访问 a`User`并且我希望当我加载用户时，他的 Player 也被加载（这就是我使用的原因`fetch = FetchType.EAGER`）。

所以我希望（出于优化目的）当我`User`加载`Player`. 就像是 ：

```
select u, p from User u join u.player p where u.player_id = p.id 
```

但是当我查看查询计数和查询调试输出时，我可以看到执行了 2 个查询。就像是：

```
select u from User u
select p from Player p where p.id = ? 
```

但这没有优化，我怎样才能让 JPA 执行加入请求来获取我的`User`和它的`Player`？

坦克你的帮助！

**编辑：**我正在使用 Play 框架 1.2.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T12:31:31.250

**编辑：**此答案仅适用于带有 Ebean 的 Play 2.0。

目前尚不清楚您使用的是 Ebean 还是纯 JPA。

如果它是 Ebean，如[doc](http://www.avaje.org/ebean/introquery_joinquery.html)中所述，您必须获取链接实体：

```
List<User> orders =   
    Ebean.find(User.class)  
        .fetch("player")  
        .findList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T05:35:07.983

在 User 类中，正如您在评论中注意到 player 可以为 null

```
public static void findByIdWithPlayer(Long id) {
    find("select distinct user from User user left join fetch user.player where user.id=?", id).first();
} 
```

# sql - Sql中的NULL检查

> ID：12977514
> 
> 赞同：3
> 
> 时间：2012-10-19T15:26:07.577
> 
> 标签：sql, sql-server

请建议有什么区别：

1)`WHERE student.name = ISNULL(@name, student.name)`

和

2)`WHERE (student.name = @name OR @name IS NULL)`

实际上，我有一个针对我的名字分配的问题错误，当我使用第一种方法时，其中一些记录被跳过。但是当我用例如 2 替换它时得到了纠正。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T15:29:52.513

for的[第二个参数](http://msdn.microsoft.com/en-us/library/ms184325.aspx)`ISNULL()`是*替换值*，表示如果第一个参数为 null 时将被替换的值。因此，如果两者都`@name`和`student.name`是`null`，你基本上是在写：

`student.name = NULL`

这等于 false（因为`null`在 SQL 中被认为是未知的，并且从不*等于*任何东西）。

在第二个中，您使用运算符来测试空值，如果为空`IS`，它将返回。`true``@name`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:32:10.790

这是区别

```
name |student.name  |first_result  |second_result |expected*
A    |A             |true          |true          |true
A    |B             |false         |false         |false
null |A             |true          |true          |true
A    |null          |false         |false         |false
null |null          |FALSE         |TRUE          |TRUE 
```

*预期 - 一些人预期，但在我们的宇宙中不正确。

如您所见，两个值都为 NULL 时会出现差异，因为在这种情况下，您的第一个 WHERE 计算结果为：null = null（即 FALSE）。

您可以使用以下方法在 SQL Server 中进行检查：

```
select case when null = null then 1 else 0 end 
```

这会给你0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:29:25.483

第二条语句说*当学生姓名与@name 匹配或未指定姓名时选择记录*如果指定了@name，则选择该姓名。如果@name 为空，则选择所有记录。这不关心@name 为 NULL 时表中的值是什么

对于第一条语句，如果@name 为NULL，它将使用student.name 与当前行的student.name 相同

**当@name 和 student.name 都为 NULL 时**

```
WHERE student.name = @name OR @name IS NULL -- the other part of the OR is true so records will be returned 
```

和

```
WHERE student.name = ISNULL(@name, student.name) becomes WHERE NULL = NULL 
```

因为`NULL = NULL`返回 false，所以不会为该行返回任何记录

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T15:30:36.453

```
WHERE student.name = ISNULL(@name, student.name) 
```

和

```
WHERE (student.name = @name OR @name IS NULL) 
```

是等价的，除非 student.name 为空。

```
WHERE (student.name = @name OR @name IS NULL) 
```

可以简化：

```
WHERE COALESCE(student.name,'nul') = COALESCE(@name, student.name,'nul') 
```

和

```
WHERE student.name = ISNULL(@name, student.name) 
```

相当于

```
WHERE (student.name = @name OR @name IS NULL AND student.name IS NOT NULL) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T15:33:25.733

检查下面的示例，在第二个选项中，您可以在检查 name = @name 之前检查 @name 是否为空。

```
declare @name varchar(10) = null
declare @table table (name varchar(10))

insert into @table 
select 'A'
UNION
SELECT null

---returns only A because null = column is always false
select * from @table where name = ISNULL(@name, name)

--returns all rows
select * from @table where (@name is null or name = @name)

set @name = 'A'
select * from @table where name = ISNULL(@name, name)
select * from @table where (@name is null or name = @name) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T15:27:34.813

如果您设置了[ANSI_NULLS](http://msdn.microsoft.com/en-us/library/ms188048%28v=sql.100%29.aspx)系统设置，`null = anything`则为 false。

所以第一个查询不会返回任何为 null 的条目`student.name`，即使`@name`是 null，因为比较计算结果`where null=null`为 student.name 为 null 的条目，并`null=null`返回 false

# python - 相当于 D3.js 的 Python

> ID：12977517
> 
> 赞同：124
> 
> 时间：2012-10-19T15:26:16.843
> 
> 标签：python, graph, d3.js, graph-tool

谁能推荐一个可以进行**交互式**图形可视化的 Python 库？

我特别想要[d3.js 之](https://d3js.org/)类的东西，但`python`理想情况下它也是 3D 的。

我看过：

*   [NetworkX](https://networkx.readthedocs.io/en/stable/) - 它只做`Matplotlib`情节，那些似乎是 2D 的。我没有看到任何形式的交互性，例如`d3.js`提供的交互性，例如拉动节点。
*   [graph-tool](https://graph-tool.skewed.de/) - 它只做 2D 绘图并且有非常慢的*交互式*图表。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-01-05T23:59:44.267

您可以使用[d3py](https://github.com/mikedewar/d3py)一个 python 模块来生成嵌入 d3.js 脚本的 xml 页面。例如 ：

```
import d3py
import networkx as nx

import logging
logging.basicConfig(level=logging.DEBUG)

G = nx.Graph()
G.add_edge(1,2)
G.add_edge(1,3)
G.add_edge(3,2)
G.add_edge(3,4)
G.add_edge(4,2)

# use 'with' if you are writing a script and want to serve this up forever
with d3py.NetworkXFigure(G, width=500, height=500) as p:
    p += d3py.ForceLayout()
    p.show() 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-11-06T02:13:31.740

Plotly 支持交互式 2D 和 3D 绘图。图形使用 D3.js 渲染，可以使用[Python API](https://plot.ly/python)、[matplotlib](https://plot.ly/python/matplotlib-to-plotly-tutorial/)、[ggplot for Python](http://nbviewer.ipython.org/gist/msund/11349097)、[Seaborn](http://nbviewer.ipython.org/gist/msund/11349097)、[prettyplotlib](http://nbviewer.ipython.org/gist/msund/11349097)和[pandas](https://plot.ly/ipython-notebooks/big-data-analytics-with-pandas-and-sqlite/)创建。您可以缩放、平移、打开和关闭跟踪，并在悬停时查看数据。绘图可以嵌入到 HTML、应用程序、仪表板和 IPython 笔记本中。下面是显示交互性的[温度图。](http://moderndata.plot.ly/update-plotly-charts-with-cron-jobs-and-python/)有关更多示例 ，请参阅[IPython Notebooks](https://plot.ly/ipython-notebooks/) [教程库。](http://moderndata.plot.ly/)

![在此处输入图像描述](../Images/77bdbdd0b848e68448ef4d3b0bfccce3.png)

[文档](https://plot.ly/python/)提供了支持的绘图类型和代码片段的示例。

![在此处输入图像描述](../Images/fc960e0f897450ae6f2a4f8315cf3260.png)

具体到您的问题，您还可以从 NetworkX [制作交互式绘图。](https://plot.ly/ipython-notebooks/network-graphs/)

![在此处输入图像描述](../Images/ba4d71d9424771dc12aa0bc9e9e32a8b.png)

对于使用 Python 进行 3D 绘图，您可以制作具有类似交互性的 3D 散点图、线图和曲面图。绘图使用 WebGL 渲染。例如，查看英国掉期利率[的 3D 图表](https://plot.ly/~MattSundquist/11399/uk-swap-rates/)。

![在此处输入图像描述](../Images/2a25f7a36345013bffbfa65df0ae4938.png)

披露：我在 Plotly 团队。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-10-10T19:28:07.307

你看过文森特吗？Vincent 获取 Python 数据对象并将其转换为 Vega 可视化语法。Vega 是建立在 D3 之上的更高级别的可视化工具。与 D3py 相比，最近更新了 vincent repo。虽然这些例子都是静态的 D3。

更多信息：

*   [https://github.com/wrobstory/vincent](https://github.com/wrobstory/vincent)

*   [https://pypi.python.org/pypi/vincent/0.1.6](https://pypi.python.org/pypi/vincent/0.1.6)

* * *

图表可以在 Ipython 中查看，只需添加此代码

```
vincent.core.initialize_notebook() 
```

或输出到 JSON，您可以在 Vega 在线编辑器 ( [http://trifacta.github.io/vega/editor/](http://trifacta.github.io/vega/editor/) ) 中查看 JSON 输出图，或在本地 Python 服务器上查看它们。更多关于查看的信息可以在上面的 pypi 链接中找到。

不确定何时，但 Pandas 包应该在某个时候集成 D3。 [http://pandas.pydata.org/developers.html](http://pandas.pydata.org/developers.html)

Bokeh 是一个支持交互式可视化的 Python 可视化库。它的主要输出后端是 HTML5 Canvas 并使用客户端/服务器模型。

示例：[http ://continuumio.github.io/bokehjs/](http://continuumio.github.io/bokehjs/)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-03-16T23:56:37.850

我使用的一个配方（在此处描述：[Co-Director Network Data Files in GEXF and JSON from OpenCorporates Data via Scraperwiki 和 networkx](http://blog.ouseful.info/2013/02/25/co-director-network-data-files-in-gexf-and-json-from-opencorporates-data-via-scraperwiki/)）运行如下：

*   *使用networkx*生成网络表示
**   将网络导出为 JSON 文件*   将该 JSON 导入到*[d3.js](http://d3js.org/)*。（*networkx可以导出**d3.js*可以导入的树和图形/网络表示）。*

 *networkx [JSON 导出](http://networkx.github.com/documentation/latest/reference/readwrite.json_graph.html)[*器*](http://networkx.github.com/documentation/latest/reference/readwrite.json_graph.html)采用以下形式：

```
from networkx.readwrite import json_graph
import json
print json.dumps(json_graph.node_link_data(G)) 
```

或者，您可以[将网络导出](http://networkx.github.com/documentation/latest/reference/readwrite)为*GEXF* XML 文件，然后将此表示导入[sigma.js](http://sigmajs.org/examples/gexf_example.html) Javascript 可视化库。

```
from xml.etree.cElementTree import tostring
writer=gf.GEXFWriter(encoding='utf-8',prettyprint=True,version='1.1draft')
writer.add_graph(G)
print tostring(writer.xml) 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-11-21T18:37:53.117

另一种选择是[散景](http://bokeh.pydata.org/)，它刚刚升级到 0.3 版。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-11-11T14:54:17.517

对于那些推荐[pyd3](https://github.com/mikedewar/d3py)的人，它不再处于积极开发中，并指向[vincent](https://github.com/wrobstory/vincent)。vincent 也不再处于积极开发阶段，建议使用[altair](https://github.com/altair-viz/altair)。

因此，如果您想要 pythonic d3，请使用 altair。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-04-06T14:50:16.300

试试[https://altair-viz.github.io/](https://altair-viz.github.io/) - d3py 和 vincent 的继承者。也可以看看

*   [https://altair-viz.github.io/gallery/index.html](https://altair-viz.github.io/gallery/index.html)
*   [https://speakerdeck.com/jakevdp/bespoke-visualizations-with-a-declarative-twist](https://speakerdeck.com/jakevdp/bespoke-visualizations-with-a-declarative-twist)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-08-23T13:07:30.230

查看[python-nvd3](https://github.com/areski/python-nvd3)。它是 nvd3 的 python 包装器。看起来比 d3.py 更酷，并且还有更多图表选项。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-02-09T11:45:35.030

我建议使用 mpld3，它将 D3js javascript 可视化与 python 的 matplotlib 相结合。

安装和使用非常简单，它有一些很酷的插件和互动的东西。

[http://mpld3.github.io/](http://mpld3.github.io/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-05-17T05:26:27.537

**Plotly**可以为你做一些很酷的事情[![在此处输入图像描述](../Images/f4155b988e54a06f0b86453d5db7636d.png)](https://i.stack.imgur.com/hgXMO.png)

[https://plot.ly/](https://plot.ly/)

使用其离线 API 生成高度交互的图形，可以轻松地嵌入到您的私有服务器或网站的 HTML 页面中。

**更新：** 我确信它的 3D 绘图功能，因为 2D 图形很棒谢谢

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-06-13T09:06:22.550

您还可以选择序列化您的数据，然后在 D3.js 中将其可视化，如下所示： [使用 Python 和 Pandas 创建 D3 强制定向网络图](http://www.austintaylor.io/d3/python/pandas/2016/02/01/create-d3-chart-python-force-directed/)（它还附带一个[jupyter 笔记本](https://github.com/austin-taylor/austin-taylor.github.io/blob/master/static/examples/force_directed/pcap_to_d3_visual.ipynb)！）

这是要点。您以这种格式序列化您的图形数据：

```
import json
json_data = {
  "nodes":[
    {"name":"Myriel","group":1},
    {"name":"Napoleon","group":1},
    {"name":"Mlle.Baptistine","group":1},
    {"name":"Mme.Magloire","group":1},
    {"name":"CountessdeLo","group":1},
  ],
  "links":[
    {"source":1,"target":0,"value":1},
    {"source":2,"target":0,"value":8},
    {"source":3,"target":0,"value":10},
    {"source":3,"target":2,"value":6},
    {"source":4,"target":0,"value":1},
    {"source":5,"target":0,"value":1},
  ]
}
filename_out = 'graph_data.json'
json_out = open(filename_out,'w')
json_out.write(json_data)
json_out.close() 
```

然后使用 d3.js 加载数据：

```
d3.json("pcap_export.json", drawGraph); 
```

但是，对于例程`drawGraph`，我建议您参考链接。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-10-24T22:31:11.497

NetworkX 有一个有趣的 Javascript 端口，可以满足您的需求。见[http://felix-kling.de/JSNetworkX/](http://felix-kling.de/JSNetworkX/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-06-23T06:53:23.283

该库`d3graph`将从 python 中构建一个力导向的 d3-graph。您可以根据边缘权重“破坏”网络，并将鼠标悬停在节点上以获取更多信息。双击一个节点将关注该节点及其连接的边缘。

```
pip install d3graph 
```

例子：

```
source = ['node A','node F','node B','node B','node B','node A','node C','node Z']
target = ['node F','node B','node J','node F','node F','node M','node M','node A']
weight = [5.56, 0.5, 0.64, 0.23, 0.9,3.28,0.5,0.45]

# Import library
from d3graph import d3graph, vec2adjmat

# Convert to adjacency matrix
adjmat = vec2adjmat(source, target, weight=weight)
print(adjmat)
# target  node A  node B  node F  node J  node M  node C  node Z
# source                                                        
# node A    0.00     0.0    5.56    0.00    3.28     0.0     0.0
# node B    0.00     0.0    1.13    0.64    0.00     0.0     0.0
# node F    0.00     0.5    0.00    0.00    0.00     0.0     0.0
# node J    0.00     0.0    0.00    0.00    0.00     0.0     0.0
# node M    0.00     0.0    0.00    0.00    0.00     0.0     0.0
# node C    0.00     0.0    0.00    0.00    0.50     0.0     0.0
# node Z    0.45     0.0    0.00    0.00    0.00     0.0     0.0

# Example A: simple interactive network
out = d3graph(adjmat)

# Example B: Color nodes
out = d3graph(adjmat, node_color=adjmat.columns.values)

# Example C: include node size
node_size = [10,20,10,10,15,10,5]
out = d3graph(adjmat, node_color=adjmat.columns.values, node_size=node_size)

# Example D: include node-edge-size
out = d3graph(adjmat, node_color=adjmat.columns.values, node_size=node_size, node_size_edge=node_size[::-1], cmap='Set2')

# Example E: include node-edge color
out = d3graph(adjmat, node_color=adjmat.columns.values, node_size=node_size, node_size_edge=node_size[::-1], node_color_edge='#00FFFF')

# Example F: Change colormap
out = d3graph(adjmat, node_color=adjmat.columns.values, node_size=node_size, node_size_edge=node_size[::-1], node_color_edge='#00FFFF', cmap='Set2')

# Example H: Include directed links. Arrows are set from source -> target
out = d3graph(adjmat, node_color=adjmat.columns.values, node_size=node_size, node_size_edge=node_size[::-1], node_color_edge='#00FFFF', cmap='Set2', directed=True) 
```

[![d3graph 的例子](../Images/db4358abb198a8f70f2fba4b731814d6.png)](https://i.stack.imgur.com/8GaT7.png)

泰坦尼克号案例的交互式示例可以在这里找到： [https ://erdogant.github.io/docs/d3graph/titanic_example/index.html](https://erdogant.github.io/docs/d3graph/titanic_example/index.html) [https://erdogant.github.io/hnet/pages/html/Use%20Cases .html](https://erdogant.github.io/hnet/pages/html/Use%20Cases.html)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-07-11T17:04:30.713

我在这里有一个使用 Python 自动生成 D3.js 网络图的好例子：http: [//brandonrose.org/ner2sna](http://brandonrose.org/ner2sna)

很酷的是，您最终会得到自动生成的 HTML 和 JS，并且可以将交互式 D3 图表嵌入到带有 IFrame 的笔记本中*

# xslt - XSLT - 如何删除标签并保留内容？

> ID：12977518
> 
> 赞同：0
> 
> 时间：2012-10-19T15:26:18.917
> 
> 标签：xslt, xpath, xslt-1.0

我有一个类似于以下内容的 XML 文件：

```
<doc>
  <element>
    <word>
      <text>one word</text>
    </word>
    <word>
      <text>two words</text>
    </word>
  </element>
  <element>
    <other>
      <text>the sky</text>
    </other>
    <word>
      <text>NN NN</text>
    </word>
  </element>
</doc> 
```

而且我希望只有一个标签和行的内容，当有两个接一个时，就像这样：

```
<element>
    <word>
      <text>one word</text>
       <text>two words</text>
    </word>
</element> 
```

问题是我正在生成一个`<xsl:element>`以获取`<word>`标签。这`<xsl:element>`已经在一个`<xsl:for-each>`循环中，`<word>`以正确的顺序放置标签（过滤属性）。

我以前的 XML 文档是这样的：

```
<doc>
  <element class="word">
    <text>one word</text>
  </element>
  <element class="word">
    <text>NN NN</text>
  </element>
  <element class="word">
    <text>two words</text>
  </element>
  <element class="other">
    <text>the sky</text>
  </element>
</doc> 
```

任何帮助都会很棒，谢谢:)

- 更多细节 -

这是我想要的结果：

```
<doc>
   <element>
      <word>
         <text>one word</text>
         <text>two words</text>
      </word>
   </element>
   <element>
      <other>
         <text>the sky</text>
      </other>
      <word>
         <text>NN NN</text>
      </word>
  </element>
</doc> 
```

而且我无法指定标签**词**或**其他**，因为我没有封闭的标签列表。所以我使用**xsl:variable**：

```
<xsl:for-each select="element">
    <xsl:variable name="name">
      <xsl:value-of select="@class"/>
    </xsl:variable>
    <xsl:element name="{$name}">
        <text>
          <xsl:value-of select="."/>
        </text>
    </xsl:element>
</xsl:for-each> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T12:48:51.933

试试这个：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="element/*">
    <xsl:if test="not(preceding-sibling::*[name() = name(current())])">
      <xsl:copy>
        <xsl:apply-templates select="* | following-sibling::*[name()=name(current())]/*" />
      </xsl:copy>
    </xsl:if>
  </xsl:template>

  <!-- Identity template -->
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

`element`它只是查找之前没有同名兄弟的任何子节点（即每个兄弟中的第一个），然后将模板应用于它自己的子节点和任何后续同名兄弟的子节点.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:42:22.923

您只需使用`<xsl:apply-templates/>`...即可“解包”元素

**XML 输入**

```
<doc>
    <element>
        <word>
            <text>one word</text>
        </word>
        <word>
            <text>two words</text>
        </word>
    </element>
    <element>
        <other>
            <text>the sky</text>
        </other>
        <word>
            <text>NN NN</text>
        </word>
    </element>
</doc> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="element">
        <xsl:copy>
            <word>
                <xsl:apply-templates/>
            </word>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="word|other">
        <xsl:apply-templates/>
    </xsl:template>

</xsl:stylesheet> 
```

**输出**

```
<doc>
   <element>
      <word>
         <text>one word</text>
         <text>two words</text>
      </word>
   </element>
   <element>
      <word>
         <text>the sky</text>
         <text>NN NN</text>
      </word>
   </element>
</doc> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T18:27:30.197

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="element/*"/>
 <xsl:template match="element/*[1]">
     <word>
       <xsl:apply-templates select="../*/*"/>
     </word>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<doc>
    <element>
        <word>
            <text>one word</text>
        </word>
        <word>
            <text>two words</text>
        </word>
    </element>
    <element>
        <other>
            <text>the sky</text>
        </other>
        <word>
            <text>NN NN</text>
        </word>
    </element>
</doc> 
```

**产生（我猜是）想要的正确结果**：

```
<doc>
   <element>
      <word>
         <text>one word</text>
         <text>two words</text>
      </word>
   </element>
   <element>
      <word>
         <text>the sky</text>
         <text>NN NN</text>
      </word>
   </element>
</doc> 
```

# iphone - 从 AppDelegate 显示 UIView

> ID：12977521
> 
> 赞同：1
> 
> 时间：2012-10-19T15:26:23.410
> 
> 标签：iphone, ios, xcode, delegates

我正在我现有的应用程序中实施登录系统。我已经进行了设置，以便用户可以打开密码保护并设置他们的密码。

在里面

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

方法我检测用户是否启用了密码保护。如果他们这样做，我想在他们访问应用程序之前让他们登录。目前，它通过调用带有单个文本字段的警报视图来工作。

尽管这可行，但您仍然可以在后台看到不受欢迎的应用程序。

是否可以（在 AppDelegate 中）创建一个具有黑色不透明背景的 UIView，并将其显示在当前窗口的顶部。我尝试了许多解决方案（[例如这个](https://stackoverflow.com/questions/4415807/uiview-doesnt-show-in-app-delegate)），但无法使其正常工作。

注意：我正在使用 ARC 和 Storyboards。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:36:23.127

创建 UiWindow：

```
@property (strong, nonatomic) IBOutlet UIWindow *window; 
```

合成它：

```
@synthesize window = _window; 
```

在 didFinishLaunchingWithOptions 添加：

```
 UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];
    [view setBackgroundColor:[UIColor blueColor]];
    [self.window addSubview:view]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:37:30.383

为什么不呈现模态视图？在情节提要中创建视图不要连接它创建一个实例然后使用

`[self presentViewController:/*yourviewController*/ animated:yes/no completion:^{}]`

# java - DefaultComboBoxModel 和 JCombobox 之间的通信

> ID：12977524
> 
> 赞同：0
> 
> 时间：2012-10-19T15:26:46.437
> 
> 标签：java, swing, jcombobox

我正在使用 DefaultComboBoxModel 来管理我的应用程序中各种 JComboBoxes 的数据。

我想在数据加载或重新加载时禁用这些组合框（或显示“正在加载...”文本并将指针设置为沙漏）。

有没有办法通知 JComboBox 模型正在重新加载数据？

重新加载发生在一个单独的线程中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:34:04.233

中`AbstractListModel`是一个名为 的函数`addListDataListener(ListDataListener l)`。现在您可以实现自己的监听器，当方法`fireContentsChanged(Object source, int index0, int index1)`被调用时会收到通知（这将在后台完成，您不需要这样做）。

[抽象列表模型](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/AbstractListModel.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:35:39.350

*   从[JComboBox(es)](http://docs.oracle.com/javase/tutorial/uiswing/components/combobox.html)中删除所有[侦听器](http://docs.oracle.com/javase/tutorial/uiswing/events/eventsandcomponents.html)，直到刷新结束（一个无效）

*   显示[GlassPane，对 JLabel 进行描述](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)（注意仅使用鼠标事件，必须覆盖键盘事件）或[（更好地使用）JLayer for Java7](http://docs.oracle.com/javase/tutorial/uiswing/misc/jlayer.html)，基于`JXLayer (Java6)`

*   如果结束所有数据加载，则将所有[侦听器](http://docs.oracle.com/javase/tutorial/uiswing/events/eventsandcomponents.html)添加回[JComboBox(es)](http://docs.oracle.com/javase/tutorial/uiswing/components/combobox.html)（一个无效）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-19T15:50:46.903

我会为后台任务使用 SwingWorker，我会`setEnabled(false)`在 SwingWorker 的后台线程运行时调用 JComboBoxes，然后在线程完成时重新启用 JComboBoxes。这可以通过将 PropertyChangeListener 添加到 SwingWorker 来侦听其 state 属性并在 StateValue.DONE 时收到通知来确定。请注意，模型本身应仅在 Swing 事件线程上更新。因此，例如，如果数据来自数据库，则在后台线程中从数据库中获取信息，但将其传递给事件线程上的组​​合框模型。SwingWorker 的进程/发布方法对将是执行此操作的好方法。

# swig - SWIG 是否支持最终区块？

> ID：12977529
> 
> 赞同：2
> 
> 时间：2012-10-19T15:26:54.377
> 
> 标签：swig

SWIG 支持包含在加载模块时执行的代码，如下所示：

```
%init %{
    init_variables();
%} 
```

最终确定是否也存在类似的东西？我找不到关于它的任何文档，也许还有另一种好方法可以实现相同的最终确定？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-20T18:00:14.977

您可以`atexit`在`%init`. 这是一个工作示例：

```
%module sample

%{
#include <stdlib.h>
#include <stdio.h>

void cleanup()
{
    printf("cleanup!\n");
}
%}

%init %{
    atexit(cleanup);
%} 
```

结果：

```
Python 3.3.0 (v3.3.0:bd8afb90ebf2, Sep 29 2012, 10:57:17) [MSC v.1600 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import sample
>>> ^Z

cleanup! 
```

# jquery - jQuery 验证 - errorPlacement 正在破坏代码

> ID：12977533
> 
> 赞同：1
> 
> 时间：2012-10-19T15:27:12.490
> 
> 标签：jquery, jquery-validate

一旦我插入`errorPlacement:`函数，它就会破坏代码。单击提交时不会进行验证。有人可以帮忙吗？

如果我删除此功能，验证工作正常。

**进口：-**

```
<script type="text/javascript" src="/MyApp/js/jquery.js"></script>
<script type="text/javascript" src="/MyApp/js/jquery.validate.min.js"></script> 
```

**脚本：-**

```
 $(document).ready(function(){
        $("#post-an-ad").validate({
            rules:{
                articleTitle:{
                    required: true,
                    minlength: 5
                },            
                dateRequested:{
                   required: true,
                    date: true
                },
                articleLocation:{
                    required: true,
                    minlength: 8
                },
                'user.agent': "required",
                'user.firstName': "required",
                'user.emailId':{
                    required: true,
                    email: true
                },
                'user.phone':{
                    required: true,
                    minlength: 8,
                    number: true
                }
            },
             errorPlacement: function(error, element) {
             alert("This alert is not popping");
             },
            submitHandler: function(form){      
            // doing nothing on a submit.
                return false;
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:52:39.867

我将您的代码放入 jsFiddle 中，它使我的浏览器崩溃了。您的验证代码很好......但是，在函数`alert()`内部放置一个**不是**！`errorPlacement:`

 **```
errorPlacement: function(error, element) {
    alert("This alert is not popping");  //--- this is causing infinite loop
}, 
```

错误触发警报，然后当您点击“确定”警报时，它会立即重新触发，因为表单仍然无效，该过程重复......这陷入了不间断警报的无限循环。它使我的 Safari 崩溃，因为我无法在没有立即弹出下一个警报的情况下关闭警报。我确信其他浏览器正在以自己的方式处理这个循环。

其他一切工作正常。

取消注释违规行需您自担风险：

[http://jsfiddle.net/59bsp/](http://jsfiddle.net/59bsp/)

* * *

这是`errorPlacement:`完美运行的解决方案......

```
errorPlacement: function(error, element) {
    error.insertAfter(element);  //- this line demonstrates the default behavior
}, 
```

[http://jsfiddle.net/59bsp/1/](http://jsfiddle.net/59bsp/1/)**

# git - 我是如何搞砸这个非常简单的 .gitignore 文件的？

> ID：12977534
> 
> 赞同：2
> 
> 时间：2012-10-19T15:27:12.447
> 
> 标签：git, gitignore

我只想跟踪我目录中的一个文件。这个文件是`buildout.cfg`. 于是我先跑了`git init`。然后我创建了一个`.gitignore`完整的文件，如下所示：

```
* # Blacklist all files
!buildout.cfg # Whitelist the file I'm interested in 
```

但是现在当我运行命令时`git add`，git 会继续添加几十个文件——目录中的所有内容。

为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T15:33:01.990

根据[`man gitignore`](http://man.cx/gitignore)，评论只是完整的行。因此，您应该尝试将注释移动到不同的行：

```
# Blacklist all files
*
# Whitelist this file
!buildout.cfg 
```

# ruby - CSV 文件在使用 Ruby 生成的列中带有回车符 CSV 在 Excel 中返 回方形字符

> ID：12977544
> 
> 赞同：1
> 
> 时间：2012-10-19T15:27:45.767
> 
> 标签：ruby, excel, csv, fastercsv

我有一个脚本，可以生成 CSV 文件并将其通过电子邮件发送给 Windows 上的许多用户。其中一列中有换行符，当我打开生成的文件时，我会在换行符之前看到方框。这是我正在尝试做的代码示例：

```
CSV.open("/tmp/reports.csv", "w") do |csv|
  csv << ["Date", "Description", "Comments", "Status"]
  csv << ["Foo","Bar","This\r\n is \r\n where \r\n my \r\n linebreaks \r\n are,"Baz"]
end 
```

我已经尝试了我能想到的任意数量的换行和编码组合，但没有任何乐趣。我怀疑它与[这个问题](http://support.microsoft.com/kb/210372)有关，但解决方案涉及在导入后做一些事情，我不想让我的用户背负这些，特别是因为我不在这里与技术用户打交道。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T02:32:15.283

尝试 gsubbing 出 \r ：

```
csv << ["Foo","Bar","square \r\n here","Baz"].map{|col| col.gsub(/\r/, '')} 
```

# c# - 从字节数组中获取位 0

> ID：12977547
> 
> 赞同：0
> 
> 时间：2012-10-19T15:27:55.470
> 
> 标签：c#, marshalling

我在 C# 中包装了一个 C++ API。此 API 使用表示程序设置的字节数组填充提供的内存位置。我需要获取 Bit 0 来确定它的状态。这是 C++ API 和使用文档：

```
DECL_FOOAPIDLL DWORD WINAPI FOO_GetVal(
VOID *Val,  //pointer to memory where the data will be stored by the function
DWORD Len,  //length of Val in bytes
DWORD Id    //identification number of the parameter
); 
```

这是我的 C# 包装器和调用（我认为是正确的）：

```
 [DllImport(FOO_API, CharSet = CharSet.Auto)]
static public extern uint FOO_GetVal(IntPtr val, uint len, uint id);

        IntPtr Ptr = Marshal.AllocHGlobal(5);
        uint hr = NativeWrapper.FOO_GetVal(Ptr, 5, 1181);

        var byteArray = new byte[5];
        Marshal.Copy(Ptr, byteArray, 0, 5);

        Marshal.FreeHGlobal(Ptr); 
```

我如何获得位 0？

我试过（没有成功）：

```
bool b = GetBit(bytearray[0],0);

private bool GetBit(byte b, int bitnum)
{
    return (b & (1 << nitnum)) != 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:44:19.570

您是在寻找最高有效位还是最低有效位？

通常首先指的是字节中的最高有效位，而您得到的是最低有效位。

尝试`GetBit(bytearray[0],7)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T16:10:47.773

您应该考虑使用[BitArray](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)结构来使您的生活更轻松。从您的字节创建 BitArray，您可以检查所需的位。请记住 Guvante 指出的内容 - 这些位可能从最低有效位存储到最高有效位。Windows 和大多数 Linux 发行版都是[little endian](http://en.wikipedia.org/wiki/Endianness)，因此对于 .Net 程序来说这可能是一个安全的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T18:44:04.660

我所有的代码都是正确的……API 供应商为我提供了不正确的 ID 参数（第三个值）……我感谢所有评论以及我对 Guvante 解释的最低到最高位的新理解。

# powershell - Webclient.DownloadFile() .aspx 文件无法打开

> ID：12977549
> 
> 赞同：3
> 
> 时间：2012-10-19T15:28:03.143
> 
> 标签：powershell, webclient, .aspxauth, aspxcombobox

我是第一次使用 powershell。我已经学习了如何使用以下代码使用网络客户端下载文件。

```
$client = New-Object System.NET.Webclient
$client.DownloadFile( $url, $path ) 
```

这似乎很适合我最终尝试做的事情，即一次从网页下载多个文件。我在一个网站上试过这个，它的文件格式为 .pfva 文件，以 PDF 格式打开。没问题。这也是一个受密码保护的网站。

所以转移到我真正想要使用它的网站。同样，一个需要登录的站点，虽然我只是在浏览器上登录，然后运行 ​​webclient。可能是为什么我永远不必在命令脚本中通过身份验证....

此站点的文件格式为 .aspx 文件。它们将作为 PDF 文件打开。我可以简单地单击文件，保存或打开它，它自然地作为 PDF 文件工作。但是当我使用 webclient.download 文件时，它会下载到正确的位置......但是在尝试打开它时出现错误。

“Adobe 无法打开文件。它没有正确编码”……类似的东西。我现在无法收到消息，因为我在工作。下载的 URL 格式如下......

```
https://www.WebsiteABC.com/ShowDocument.aspx?DocPath=%7e%5cDocument%5cb75c6093-697a-4e59-bc26-fa2eb24f57f7%5cAUTHORIZATION.PDF 
```

怎么打不开！！！有没有解决的办法。任何帮助，将不胜感激。谢谢！。

哦顺便说一句，我将 $path 设置为计算机目录中的 .PDF 文件...因为我读到应该提供文件的路径，而不仅仅是目录。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T19:56:55.937

看起来您的脚本在大多数情况下都有效。

我找到[了这个](http://answers.oreilly.com/topic/2006-how-to-download-a-file-from-the-internet-with-windows-powershell/)页面，告诉用户代理 HTTP 标头字段对服务器很重要，所以试试这个：

```
$userAgent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2;)"
$url = "https://www.adobe.com/enterprise/pdfs/pdfarchiving.pdf"
$path = "c:\test.pdf"

$client = New-Object System.NET.Webclient
$client.Headers.Add("user-agent", $userAgent)
$client.DownloadFile( $url, $path ) 
```

# performance - 长时间运行 Flash 动画/应用程序的最有效方式

> ID：12977553
> 
> 赞同：1
> 
> 时间：2012-10-19T15:28:23.707
> 
> 标签：performance, flash, animation, adobe

我需要运行大约 12 个小时的 flash 动画（swf 文件）。这是为了展览。

由于我无法控制的限制，我从笔记本电脑（目前是 windows vista（！））运行它，但我可以通过 VGA 以 1024x768 分辨率重新安装除 mac os 之外的所有操作系统。

有没有人对此有任何最佳实践/建议的经验？

任何操作系统都会更好，我是否更好地使用仅运行 Flash 播放器的命令行 linux？将 swf 转换为本机代码并运行它会有什么好处吗？

你能想到什么陷阱？

任何建议都非常受欢迎。

注意，我已经看到了[Running the Flash Player over long time period](https://stackoverflow.com/questions/1504580/running-the-flash-player-over-long-time-period)的问题，但是我正在寻找有关各种主题的最佳实践和技巧等

如果有人觉得另一个“溢出”会给我更好的建议，请告诉我

感谢您的任何建议

安德鲁

编辑：

刚刚遇到这个： http: [//www.adobe.com/devnet/flash/articles/efficiency-tips.html](http://www.adobe.com/devnet/flash/articles/efficiency-tips.html) 这里有一些关于优化文件内容的好技巧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T16:01:08.133

在独立播放器中运行它，以提高性能并减少出错的机会。

如果它只是一个时间线动画，或者不使用 ActionScript 的东西，它应该被编译得足够好，你可以让它运行。

如果其中有任何代码，您需要确保其中没有任何泄漏，并实际检查 - 12 小时肯定足以让重大泄漏显现出来！

你跑的是什么东西？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T16:38:51.733

只是一些一般提示：

*   确保使用独立 Flash Player 的**Release**版本（Debug 版本速度较慢且占用更多内存）
*   当您不再需要事件侦听器时，请始终删除它们，并且为了安全起见，在添加事件侦听器时使用弱引用。
*   如果要将 .swf 文件加载到主 swf 中，请确保在要卸载 .swf 时调用[Loader.unloadAndStop()而不是 Loader.unload()。](http://helpx.adobe.com/flash/kb/flash-player-10-action-script.html)
*   在您不断创建新实例的所有类中，如果您确保每个实例占用大量内存，您可以更快地发现内存泄漏。只需在每个类的顶部临时添加一个大的 bitmapData（private var _debugDummy : BitmapData = new BitmapData(2000, 2000);）。然后你可以很快观察内存是否不断增加。**无论您做什么，都不要忘记在完成测试后移除这些假人！**

这种情况下的具体提示：

*   建立以更快的速度运行基于时间的逻辑的能力，因此您可以在更短的时间跨度内模拟“12 小时运行”。这将使查找泄漏变得容易得多。
*   由于这是一个展览，最好将计算机设置为在崩溃时重新启动闪存（或者如果内存不足，则静默退出，这是它意外退出的最常见原因）。我们在我工作的公司为展览所做的是从 Flash 播放器的发布版本创建一个投影仪文件 (.exe)。然后我们在机器上运行了一个小型服务（内部构建），它不断检查投影仪 .exe 是否正在运行。如果不是，它会再次启动它。正如我所说，该服务是内部构建的，但您可能会找到类似的东西。此外，最好将计算机设置为在计算机启动时启动闪存，以防断电并重新启动计算机。如果是展览，你就不能太偏执了:-)

# unix - UNIX 中基于内存的文件

> ID：12977555
> 
> 赞同：2
> 
> 时间：2012-10-19T15:28:31.733
> 
> 标签：unix, memory-management, file-io, posix

我有一个只能处理文件的第 3 方库，即使用“file:///path/path/file.ext”之类的文件名 URL 引用。但是我已经有一些我想从内存中读取的数据。

是否可以使内存缓冲区看起来像一个文件，即具有文件名，所以我可以省略将内存缓冲区写入磁盘的步骤，以便第 3 方库可以处理它？

谢谢

编辑：我添加了一些代码来演示我想做的事情：

```
const char* gFileName = "/Users/matthew.davies/Hello";

void MakeMemoryFile (const char* filename, const char* buffer, size_t size)
{

}

void DeleteMemoryFile (const char* filename)
{

}

int main()
{
    const char* buffer = "Hello World!";
    FILE* f;
    char outBuffer [13];

    MakeMemoryFile(gFileName, buffer, strlen(buffer));

    f = fopen(gFileName, "rb");
    outBuffer[12] = 0;
    fread(outBuffer, 12, 1, f);
    fclose(f);
    DeleteMemoryFile(gFileName);

    return 0;
} 
```

MakeMemoryFile() 将创建该文件，以便以后可以使用 fopen 按名称引用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T16:04:45.107

一种可能的方法是创建一个`tmpfs`（内存中的临时文件系统）并将数据写入到`mmap()`ed 缓冲区，尽管第一步需要 root 权限，而且这种情况有点过于复杂。

另一种可能的方法是滚动一个微型自定义 FUSE 文件系统，它将某些程序的内存区域作为文件公开（您需要将此 FS 集成到程序中并将 FUSE 添加到程序的依赖项中）。

此外，Linux 会进行积极的磁盘缓存，因此对于不是非常大的文件，将其留给内核可能会更好。例如，Vim 可以很好地处理大型标签文件（~100Mb）而无需显式缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:49:57.183

如果它是像 OS 一样的 unix，如何使用 mmap() 系统调用来使用内存映射文件。

# ruby-on-rails - 在 Rails 应用程序中定义子菜单的最佳方法

> ID：12977556
> 
> 赞同：0
> 
> 时间：2012-10-19T15:28:33.300
> 
> 标签：ruby-on-rails

您能否建议以下情况的最佳方法： 子菜单方法：我有不同的子菜单，如 submenu1、submenu2 等（每个子菜单都有自己的选项卡选项）。我想按页面显示子菜单意味着根据打开的页面划分子菜单。

```
What I am planning for this:
<% content_for(:menu) do %>
    <%=  render :partail => "submanu" %>
<% end %>

and calling that section by <%= yield(:menu) %> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T10:04:27.403

我已经基于辅助方法“显示菜单”和控制器中的哈希实现了类似的东西。在你的情况下，我会建议类似：

```
def show
@menu = [{title: "menu.pages.one", controller: "pages", action: "one"},
{title: "menu.test.two", controller: "test", action: "two"}]
end 
```

然后您可以将它与显示每个菜单项并创建如下链接的辅助方法结合使用：

```
link_to t(item[:title]), :controller => item[:controller], :action => item[:action] 
```

我已经使用 helper 方法为每个链接创建了一个 haml 布局，但您也可以使用部分链接。因此，您可以在每个控制器/方法中创建一个可自我解释的可扩展菜单。

# java - Shell 参数未正确传递给 Java 类

> ID：12977557
> 
> 赞同：0
> 
> 时间：2012-10-19T15:28:33.393
> 
> 标签：java, shell, unix, parameter-passing

我写了一个简短的 shell 脚本，它接受参数，检查它们（因为它们是“可选的”，如果它们是空的，它会设置默认值），然后它们将它们传递给服务器上的 Java 类。基本上，像这样：

```
x=${2:-'Default'}
y=${3:-'Default Name Has Spaces'}
echo \"$x\"
echo \"$y\"
java -d64 -ms3G -mx3G -cp example.jar -Djava.security.policy=policy com.example.JavaClass $1 \"$x\" \"$y\" 
```

但是，当 shell 调用 Java 类时，我只是返回（如果使用上述默认值）“无法识别参数名称”。

使用第 3 行和第 4 行周围的转义引号`echo`，我看到变量设置正确，并且它们像这样回显：`"Default"`并且`"Default Name Has Spaces"`，即使在 Java 调用中使用转义引号，它们似乎传递的更多比两个参数 - 就像它们被传递一样`java -d64 -ms3G -mx3G -cp example.jar -Djava.security.policy=policy com.example.JavaClass $1 Default Default Name Has Spaces"`失败，因为 Java 类只需要三个总参数。

有没有人对为什么或如何使论点正确通过有任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:37:17.260

问题是您引用了`"`，这会阻止它引用参数。只需删除反斜杠，您应该设置：

```
x=${2:-'Default'}
y=${3:-'Default Name Has Spaces'}
echo "$x"
echo "$y"
java -d64 -ms3G -mx3G -cp example.jar -Djava.security.policy=policy com.example.JavaClass $1 "$x" "$y" 
```

# google-analytics - 如何测试谷歌分析代码是否有效？

> ID：12977562
> 
> 赞同：15
> 
> 时间：2012-10-19T15:28:57.373
> 
> 标签：google-analytics

为了跟踪出站链接点击，我对[此处](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1136920)描述的代码进行了细微更改。这是我的代码：

```
function recordOutboundLink(link, label) {
  try {
    var myTracker=_gat._getTrackerByName();
    _gaq.push(['myTracker._trackEvent', 'Outbound Links', label, link.href ]);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
} 
```

然后我将它添加到我的 href 标签中，如下所示：

```
<a href="http://example.com/user/5" onclick="recordOutboundLink(this, 'example.com');return false"></a> 
```

不过，我认为它不起作用。真的很难检查它是否有效。我如何检查它是否工作？

编辑：使用 google 分析调试器 chrome 我能够看到发生了什么。它显示：

```
Account ID               : UA-XXXXX-X 
```

这很奇怪，因为正常的页面跟踪按预期工作。这就是我设置谷歌分析代码的方式：

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'my-id']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-19T17:17:25.323

查找`__utm.gif`跟踪像素请求。执行此操作的几种不同方法是：

*   像[Fiddler](http://www.fiddler2.com/fiddler2/)这样的网络调试代理（我的偏好）
*   [Firebug](http://getfirebug.com/)或 Chrome 开发者工具中的网络标签。
*   Google Analytics 调试脚本[ga_debug.js](https://developers.google.com/analytics/resources/articles/gaTrackingTroubleshooting#gaDebug)将记录跟踪请求和错误。
*   [Google Analytics 跟踪代码调试器](https://chrome.google.com/extensions/detail/jnkmfdileelhofjcijamephohjechhna)是一个启用 ga_debug.js 的 Chrome 扩展。

页面上的分析代码可能有一个 _trackPageview，因此当页面加载时，您会看到一个初始的 __utm.gif。

当 _trackEvent 触发时，应该会发出一个新的 __utm.gif 请求。在 __utm.gif URL 中检查的参数是：

*   utme=5(Outbound Links *label* link.href) -- _trackEvent 参数
*   utmac=UA-1234567-8 -- 分析 UID

[另外，（正如@Eduardo](https://stackoverflow.com/users/272031/eduardo)所指出的），看看[谷歌分析基本调试](https://developers.google.com/analytics/resources/articles/gaTrackingTroubleshooting#basicDebugging)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-13T21:40:32.693

在 Chrome 中：

*   右键单击页面上的任意位置
*   检查元素
*   单击网络选项卡
*   重新加载页面

寻找：

*   输入“图像/gif”
*   方法：“获取”
*   名称（开头）：_utm.gif?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T13:14:11.697

你可以看看[James for Chrome](https://chrome.google.com/webstore/detail/james/focgpljpblbfemgkcmgokbhafnddfdfn)，它既简单又免费，我们写的是为了调试我们的内部工具，但它对所有人都可用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:09:04.680

使用@mike 指出的谷歌分析跟踪代码调试器，我能够弄清楚这一点，尽管[http://support.google.com/analytics/bin/answer.py?hl=en&answer=1136920](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1136920)告诉我们使用

```
var myTracker=_gat._getTrackerByName();
_gaq.push(['myTracker._trackEvent', 'Outbound Links', label, link.href ]); 
```

不再起作用，应该使用

```
_gaq.push(['_trackEvent', 'Outbound Links', label, link.href ]); 
```

反而。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-27T02:39:30.580

您还必须确保您的标签已插入所有页面。这是可以做到这一点的免费服务：[http](http://www.tagcheckr.com) ://www.tagcheckr.com 希望这会有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-19T08:52:02.103

你可以使用这个名为[Trackie 的免费 chrome 扩展](https://github.com/pualien/Trackie)

# nofollow - 从 noindex 更改为 index 后，如何让我的网站（快速）被索引？

> ID：12977564
> 
> 赞同：0
> 
> 时间：2012-10-19T15:29:09.570
> 
> 标签：nofollow, noindex

我不小心将带有“noindex，nofollow”的 index.html 放到了我的网络服务器上，并放置了几天。现在我已将其更改为“索引，关注”，添加了 sitemap.xml，并将网页添加到谷歌网站管理员。

我还能做些什么来告诉谷歌尽快将其编入索引？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:32:03.877

你无能为力。但是想想看，*每个人都*希望他们的网站尽快被索引。如果有办法，每个人都会去做，很快就会变得像等待一样慢……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T21:29:10.037

谷歌网站管理员工具允许您提交您的网站以供索引。无法保证他们会这样做，但无论如何都值得这样做（这就是服务存在的原因）。

您可以在此处提交您的 URL 以进行索引： [https ://www.google.com/webmasters/tools/submit-url/](https://www.google.com/webmasters/tools/submit-url/)

这里有更多信息： [https ://support.google.com/webmasters/answer/1352276?hl=en](https://support.google.com/webmasters/answer/1352276?hl=en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-30T10:33:37.423

在 Google 搜索引擎中很难找到`noindex`过去的网站。

组织起来的选项：

*   提供从其他网站到您网站的链接
*   实施谷歌分析
*   在 Google 网站管理员工具中注册，该位置的`sitemap.xml`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-15T16:16:52.313

You can also use the Google Webmaster Tools "Fetch as Google" option in the Crawl section. After you fetch a page, you have the option to submit it to the index, you can also tell them to crawl all the links on the page submitted (choose "Crawl this URL and its direct links" after clicking on "Submit to index"). i think Google Webmaster Tools limits users to 10 submissions per day.

The Analytics will not help getting the pages re-indexed.

To check how many pages are indexed, use the "site:" query (type in Google - [site:mydomain.com](https://www.google.com/search?q=api%20for%20website%20traffic&gl=US&gws_rd=ssl#gl=US&q=site%3adomain.com)).

What may help speed things up is getting the pages a few links from external sites, this can even be done by using ping services, or RSS submissions. Just don't spam or get low quality links, or you may get banned from Google.

# javascript - 合作咖啡脚本服务/课程

> ID：12977565
> 
> 赞同：1
> 
> 时间：2012-10-19T15:29:15.330
> 
> 标签：javascript, oop, dependency-injection, coffeescript

我有两个类，一个依赖于另一个。它是这样实现的：

```
class myns.ClassA
  constructor(@serviceB): ->

  publicFunctionA: ->
    privateFunctionB.call this

  privateFunctionB = ->
    @serviceB.someFunction() 
```

然后我用胶水实例化它：

```
myns.classA = new myns.ClassA(myns.serviceB) 
```

并用作：

```
myns.classA.publicFunctionA() 
```

这里的问题是我想从 privateFunctionB 访问 serviceB。除了使用之外，还有更合适的方法`call`吗？

或者我的整个方法可能被我的 Java 背景污染太多了？我需要的是相互依赖的代码模块，相当于单例服务。我知道我可以使用 coffeescript 类函数并避免实例化，但是如何以干净的方式处理注入 serviceB 呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:49:36.150

您可以将`ClassA`实例作为参数而不是作为`this`. 如果您将每个类保存在自己的文件中，然后在没有`--bare`选项的情况下进行编译，我建议将该私有函数放在类之外并将其用作普通函数（它将是文件私有的，因此无需担心外面的东西泄漏）：

```
privateFunctionB = (a) ->
  a.serviceB.someFunction()

class myns.ClassA
  constructor(@serviceB): ->

  publicFunctionA: ->
    privateFunctionB @ 
```

如果您不喜欢将函数放在文件的顶层，您也可以将它放在类中（我更喜欢将它放在那里，因为我认为它只是一个简单的函数更容易理解）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T17:33:08.977

关于您关于 Java 习语的问题：

CoffeeScript 中没有公共和私有的概念。你`privateFunctionB`只是在类的闭包中声明的一个普通函数。模拟私有函数通常不是一个好习惯，因为这些函数具有非常不同的语义（例如，如果`privateFunctionB`是类之外的变量，它将被覆盖，而`publicFunctionA`.

因此，最好的办法是*将这两个函数编写为普通的类属性*（这就是您所说的公共函数。然后您的代码简化为：

```
class myns.ClassA
  constructor(@serviceB): ->

  functionA: ->
    @functionB()

  functionB: ->
    @serviceB.someFunction() 
```

对于在 CS 中可以但在 java 中不能做的类似单例的事情，您可以做的另一件事是使用全局变量。这通常不被认为是最佳实践，但这取决于您的应用程序（例如，如果编写库代码，这是一个很大的禁忌，但在最终用户之类的事情中可能没问题，具体取决于使用情况）。

此外，您还可以考虑避免使用整个类并将其编写为普通对象，如果没有实例并且您打算不进行子类化等，这可能是一个好主意。

# java - 一个批次中有两个不同的准备好的语句

> ID：12977568
> 
> 赞同：20
> 
> 时间：2012-10-19T15:29:23.393
> 
> 标签：java, sql, jdbc, prepared-statement

我想*在一批中发送两个不同的准备好的语句*。

目前，正如您在注释行中看到的那样，我正在分两步执行此操作，并且它有效，但这不是这里的主要目标。谁能告诉我用什么来代替这些评论才能让这件事发挥作用？

```
import java.lang.ClassNotFoundException;
import java.math.BigDecimal;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.DriverManager;

public class Main
{
    public static void main(String[] args)
    {
        Connection connection = null;
        PreparedStatement preparedStatementWithdraw = null;
        PreparedStatement preparedStatementDeposit = null;

        try
        {
            Class.forName("com.mysql.jdbc.Driver");
            connection = DriverManager.getConnection("jdbc:mysql://localhost:3306/youtube", "root", "root");

            preparedStatementWithdraw = withdrawFromChecking(connection, preparedStatementWithdraw, new BigDecimal(100), 1);
            preparedStatementDeposit = depositIntoSaving(connection, preparedStatementDeposit, new BigDecimal(300), 1);

            //preparedStatementDeposit.executeBatch();
            //preparedStatementWithdraw.executeBatch();
            System.out.println("Account Modified!");
        }
        catch(ClassNotFoundException error)
        {
            System.out.println("Error: " + error.getMessage());
        }
        catch(SQLException error)
        {
            System.out.println("Error: " + error.getMessage());
        }
        finally
        {
            if(connection != null) try{connection.close();} catch(SQLException error) {}
            if(preparedStatementDeposit != null) try{preparedStatementDeposit.close();} catch(SQLException error) {}
        }
    }

    public static PreparedStatement withdrawFromChecking(Connection connection, PreparedStatement preparedStatement, BigDecimal balance, int id) throws SQLException
    {
        preparedStatement = connection.prepareStatement("UPDATE bankAccount SET checkingBalance = checkingBalance - ? WHERE id = ?");
        preparedStatement.setBigDecimal(1, balance);
        preparedStatement.setInt(2, id);
        preparedStatement.addBatch();

        return preparedStatement;
    }

    public static PreparedStatement depositIntoSaving(Connection connection, PreparedStatement preparedStatement, BigDecimal balance, int id) throws SQLException
    {
        preparedStatement = connection.prepareStatement("UPDATE bankAccount SET savingBalance = savingBalance + ? WHERE id = ?");
        preparedStatement.setBigDecimal(1, balance);
        preparedStatement.setInt(2, id);
        preparedStatement.addBatch();

        return preparedStatement;
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T15:34:08.293

你可以尝试执行这两条语句是一个单一的事务，像这样：

```
connection.setAutoCommit(false);
try {
    stmt1.execute();
    stmt2.execute();
    connection.commit();
} catch (Exception ex) {
    connection.rollback();
} 
```

问题是 addBatch 适用于单个准备好的语句，请参阅[这是](http://www.tutorialspoint.com/jdbc/jdbc-batch-processing.htm)如何将多个 sql 语句与 addBatch 一起使用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-19T15:39:56.140

您不能在一个批处理中执行两个不同的语句。正如@dan 提到的，您可以并且*必须*在单个事务中完成它们。

另一种选择是使用存储过程，该过程可以在与服务器的一次往返中完成所有操作，同时保持单个事务的好处

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:41:55.843

> 我正在尝试使用准备好的语句和批处理！我说语句是因为我想在一批中发送两个准备好的语句。

当您谈论*PreparedStatement*时，批处理与此*PreparedStatement*对象的命令批处理相关联，而**不是**相反。您应该查看[javadoc](http://docs.oracle.com/javase/7/docs/api/java/sql/PreparedStatement.html#addBatch%28%29)的`addBatch()`方法以了解更多信息。

所以在你的情况下，这就是我会做的：

*   创建新交易并设置批次限制
*   为每个 PreparedStatement 创建一组批次并增加一个批次计数器
*   当我达到限制并重置计数器时执行批处理
*   完成后提交我的交易

所以你的代码看起来像这样：

```
preparedStatementWithdraw = connection.prepareStatement(....);
preparedStatementDeposit  = connection.prepareStatement(....);
boolean autoCommit        = connection.getAutoCommit();

int batchLimit = 1000; //limit that you can vary
int batchCounter = 0;
try{
    connection.setAutoCommit(false);

    //set the params and start adding your batch statements, as per your requirement, something like
    preparedStatementWithdraw.addBatch();
    preparedStatementDeposit.addBatch();
    batchCounter++;

    if(batchCounter == batchLimit){
        try{
            preparedStatementWithdraw.executeBatch();
            preparedStatementDeposit.executeBatch();
        }catch(Exception exe){
            //log your error
        }finally{
            preparedStatementWithdraw.clearBatch();
            preparedStatementDeposit.clearBatch();
            batchCounter = 0;
        }
    }
}finally{
        //process if any more statements are remaining in the batch
        try{
            preparedStatementWithdraw.executeBatch();
            preparedStatementDeposit.executeBatch();
        }catch(Exception exe){
            //log your error
        }finally{
            preparedStatementWithdraw.clearBatch();
            preparedStatementDeposit.clearBatch();
        }

    //1\. depending on your requirement, commit/rollback the transation
    //2\. Set autocommit to its original value
    connection.setAutoCommit(autoCommit);
    //3\. Resoure management statements
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T15:52:18.977

我认为您可能希望将您的语句查询合并为一个并执行以下操作：

```
 String updateAccount= "UPDATE bankAccount 
                      SET if(? is not null ) 
                        then checkingBalance = checkingBalance - ? end if, 
                        if(? is not null ) 
                         then savingBalance = savingBalance + ? end if
                      WHERE id = ?";                
 PreparedStatement = dbConnection.prepareStatement(updateAccount);

 preparedStatement.setDouble(1, new Double(100));
 preparedStatement.setDouble(2, new Double(100));
 preparedStatement.setDouble(3, null);
 preparedStatement.setDouble(4, null);
 preparedStatement.setInt(5, 1);
 preparedStatement.addBatch();

 preparedStatement.setDouble(1, null);
 preparedStatement.setDouble(2, null);
 preparedStatement.setDouble(3, new Double(100));
 preparedStatement.setDouble(4, new Double(100));
 preparedStatement.setInt(5, 1);
 preparedStatement.addBatch();
 preparedStatement.executeBatch();

 dbConnection.commit(); 
```

# visual-studio-2012 - 最简单的带有visual studio wdk的驱动程序

> ID：12977569
> 
> 赞同：2
> 
> 时间：2012-10-19T15:29:25.050
> 
> 标签：visual-studio-2012, driver, wdk

我正在尝试使用 WDK 在 Visual Studio 2012 中创建一个最简单的“hello world”驱动程序。Device.c 文件的代码是这样的：

`#include <ntddk.h>`

```
NTSTATUS DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath)
{
    DbgPrint("Hello, World");

    return STATUS_SUCCESS;
} 
```

构建时出现错误：

```
1>Driver.c(3): error C2220: warning treated as error - no 'object' file generated
1>Driver.c(3): warning C4100: 'RegistryPath' : unreferenced formal parameter
1>Driver.c(3): warning C4100: 'DriverObject' : unreferenced formal parameter
2>------ Build started: Project: KMDFSmall Package, Configuration: Win7 Debug x64 ------
2>C:\Program Files (x86)\Windows Kits\8.0\build\WindowsDriver8.0.common.targets(1347,5): error MSB3030: Could not copy the file "Path\To\Projects\SimpleDriver\x64\Win7Debug\KMDFSmall.sys" because it was not found. 
```

是什么导致了这些错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-20T04:12:34.597

更推荐的方法是使用`UNREFERENCED_PARAMETER()`宏，因此您的功能可以更改为：

```
NTSTATUS DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath)
{
    UNREFERENCED_PARAMETER(DriverObject);
    UNREFERENCED_PARAMETER(RegistryPath);

    DbgPrint("Hello, World");

    return STATUS_SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-19T17:29:12.197

WDK 已激活“将警告视为错误”，未使用的参数会触发警告。

因此，如果您将代码更改为：

```
NTSTATUS DriverEntry(PDRIVER_OBJECT /*DriverObject*/, PUNICODE_STRING /*RegistryPath*/)
{
    DbgPrint("Hello, World");

    return STATUS_SUCCESS;
} 
```

它应该编译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T19:19:07.457

更短的 t 方法是使用 IN：

```
#include <ntddk.h>

NTSTATUS DriverEntry(IN PDRIVER_OBJECT theDriverObject, IN PUNICODE_STRING theRegistryPath) {
    DbgPrint("Hello World!\n");
    return STATUS_SUCCESS;
} 
```

资料来源：颠覆 Windows 内核：Greg Hoglund 和 James Butler 的 Rootkits

# codeigniter - 从 url 中删除控制器名称

> ID：12977572
> 
> 赞同：0
> 
> 时间：2012-10-19T15:29:32.363
> 
> 标签：codeigniter, routes

我正在尝试以 codeigniter 形式删除控制器名称，

`localhost/teekle/loggedin/info`.

至

`localhost/teekle/info`

我在我的 route.php 文件中尝试了以下代码，但没有发生任何事情。

`$route['info'] = 'loggedin/info';`

但我就是想不出办法，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T21:21:25.907

您的配置基本 url 设置为什么？

从你的例子我猜应该是

`$config['base_url'] = 'http://localhost:8888/teekle/';`

如果设置不正确，可能会导致问题。正如其他一些用户所说，您的 routes.php 文件中的内容应该可以工作。

另外，检查用于删除 index.php 的 .htaccess 文件是否正确，如果 /teekle/ 不存在，请尝试附加。

# android - 在 Android 平板电脑上运行任何 Microsoft 应用程序需要什么？

> ID：12977573
> 
> 赞同：0
> 
> 时间：2012-10-19T15:29:34.000
> 
> 标签：android, emulation, tablet, runtime-environment

完全出于好奇，在 Android 平板电脑上运行任何 Microsoft 应用程序需要什么？我猜只是将一个版本的 Windows 7 加载到平板电脑上是不可能的，因为它无法处理触摸功能。理论上是否有可能编写一个 Windows 模拟器或运行时环境，让您可以在可移动存储设备上下载 Eclipse，插入键盘和鼠标，并直接从平板电脑上编程？我知道微软正在推出他们的 Surface Pro，它将运行具有全触控功能的 Windows 8，并可以进入微软的应用市场，但我更喜欢 Android（我更喜欢 Java 而不是 C++）和 Android 的应用市场。这就是我想知道的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:35:15.720

只是一个想法，但您应该检查是否有任何类似或基于[winehq.org](http://wwwwinehq.org/)库的项目，因为 android 是基于 linux 的类似的东西可能使用额外的层来处理触摸输入，使用整个 SO 的模拟器对于某些表来说，资源可能太昂贵而无法处理。

# python - 如何在 Python 中设置模块的文件名，以便模块中发生的异常使用该文件名？

> ID：12977578
> 
> 赞同：1
> 
> 时间：2012-10-19T15:30:14.143
> 
> 标签：python, string, python-import, python-module

`imp`我正在使用库从字符串中导入模块（不要问） 。这一切都很好而且花花公子，但是当这样的模块出现错误时，我会得到这样的堆栈跟踪：

```
Traceback (most recent call last):
  File "<string>", line 33, in do_something
  File "<string>", line 20, in really_do_something
Exception: STRING FILENAME EXAMPLE 
```

我尝试将模块上的**文件**属性设置为有意义的东西，但`<string>`文件名仍在异常回溯中使用。

关于如何指定异常中使用的文件名的任何想法？

更新：我正在像这样使用imp：[动态模块导入正在尝试在不应该的时候进行相对导入](https://stackoverflow.com/questions/12862562/python-dynamic-module-importing-is-trying-to-do-relative-imports-when-it-shoul)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T15:41:28.043

文件名在由`exec()`. `exec()`您应该使用[`compile()`](http://docs.python.org/py3k/library/functions.html#compile)单独编译代码，而不是使用字符串。这样你就可以设置文件名：

```
code = compile(file_contents, '/your/filename.py', 'exec')
exec(code, mod.__dict__) 
```

# c# - 在线程上启动多个服务

> ID：12977580
> 
> 赞同：5
> 
> 时间：2012-10-19T15:30:16.560
> 
> 标签：c#, multithreading, wcf, socket-timeout-exception

我正在尝试在线程上打开代理（在后台），线程创建代理的新实例，调用服务的方法并立即处理服务。

所有这些都发生在一个线程上：

```
var background = new Thread(() =>
{
    var proxy = new AssignmentSvcProxy(new EndpointAddress(worker.Address));              

    try
    {
        proxy.Channel.StartWork(workload);
        proxy.Dispose();                   
    }
    catch (EndpointNotFoundException ex)
    {
        logService.Error(ex);                        
        proxy.Dispose();
        proxy = null;
    }
    catch (CommunicationException ex)
    {
        logService.Error(ex);
        proxy.Dispose();
        proxy = null;
    }
    catch (TimeoutException ex)
    {
        logService.Error(ex);                    
        proxy.Dispose();
        proxy = null;
    }
    catch (Exception ex)
    {
        logService.Error(ex);                    
        proxy.Dispose();
        proxy = null;
    }                

}) { IsBackground = true };

background.Start(); 
```

即使我已将 CloseTimeout、OpenTimeout、ReceiveTimeout、SendTimeout 的超时设置为最大值，我仍然会看到间歇性超时问题发生。

我只是想确保设计明智这不是问题，即在线程上打开服务并处理它？

编辑 ：

代理在内部为每个线程在不同端点上建立一个自定义绑定的通道。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T19:06:35.973

我认为问题可能在于您没有正确关闭代理。如果您有很多线程访问服务器，并且它们自己并没有全部清理干净，那么您可能会在这些连接上遇到一些超时。

Dispose 不适合关闭连接。更多信息在这里：[处理代理](https://stackoverflow.com/questions/2823695/dispose-a-web-service-proxy-class)

使用的理想模式如下：

```
try
{
    proxy.Close();
}
catch (Exception ex)
{
    proxy.Abort();
}
finally
{
    proxy = null;
} 
```

您尝试关闭连接，如果失败，则中止所有连接。如果出现异常，Dispose 不会中止。

因此，我会这样重构：

```
var background = new Thread(() =>
{
     var proxy = new AssignmentSvcProxy(new EndpointAddress(worker.Address));              

    try
    {
        proxy.Channel.StartWork(workload);
    }
    catch (Exception ex)
    {
        // You aren't doing anything special with your specific exception types
        logService.Error(ex);                    
    }                
    finally
    {
        try
        {
            proxy.Close();
        }
        catch (Exception ex)
        {
            proxy.Abort();
        }
        finally
        {
            proxy = null;
        }
    }

}) { IsBackground = true };

background.Start(); 
```

# c# - 散列对象集 C#

> ID：12977586
> 
> 赞同：2
> 
> 时间：2012-10-19T15:30:35.360
> 
> 标签：c#, hash

我有许多订单，每个订单都包含购买的`Item`物品。

```
1 : {Item1, Item2, Item3, Item4, Item5}  
2 : {Item2, Item8, Item4, Item3, Item11, Item5} 
3 : { ... } 
```

我的目标是确定这些物品中的每一个被一起购买的频率以及能够在 O(1) 中获得结果的频率。

我的想法是基于子集项目迭代订单 - 增加特定数组的元素。这将使我有可能在 O(1) 中提取所需的值。

例如。Item3 和 Item4 被买了 2 次。

`int frequency = myArray[getHash(Item3+Item4)]`

`print frequency;`

`Output : 2`

**问题：**

开发一个`int getHash(...)`函数，它将能够散列项目的子集。

**注意：{Item1, Item2} = {Item2, Item1}**

非常感谢！欢迎任何更好的想法的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:34:31.287

因为`{A,B} = {B,A}`在继续之前，您首先需要对列表进行排序。您按什么排序并不重要，但您确实需要确保没有任何值被认为是相等的，除非它们的排序可以互换。

接下来，任何简单的散列算法都应该起作用。一种常见的技术是使用两个素数，我将它们称为`c`和`p`。

```
int hash = c;
foreach(Item i in items) hash = hash * p + i.GetHashCode()
return hash; 
```

`p`有时选择为 31，因为它不仅是素数，而且编译器将其解析为位移和减法，这比乘法快得多。`x * 31`与`(x << 5) - 1`（假设我使用了正确的班次......我不时搞砸了，哈哈。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:47:16.077

对不起，我没有使用哈希，但我试图以我愿意的方式尝试一下。就像尝试解决那种挑战一样。

```
Dictionary<Item, Dictionary<Item, Count>> combine = new Dictionary<Item, Dictionary<Item, Count>>();

foreach (Item item in Sell)
{
    Dictionary<Item, int> key;
    if (!combine.TryGetValue(item, out key))
    {
        key = new Dictionary<Item, Count>();
        combine.Add(item, key);
    }

    foreach (Item otherItem in Sell)
    {
        if (item == otherItem)
            continue;

        Count count;
        if (key.TryGetValue(otherItem, out count))
            count++;
        else
            key.Add(otherItem, new Count());
    }
} 
```

这可能非常愚蠢，因为对于每件商品，您最终都会得到一本同时在柜台购买的所有其他商品的字典。如果您想知道 Item1 是否与 Item2 AND Item3 vs Item2 OR Item3 同时购买... Bleh。别管我。

# php - 反向输出数据库结果

> ID：12977596
> 
> 赞同：0
> 
> 时间：2012-10-19T15:31:12.973
> 
> 标签：php

这是一种可能有一个简单解决方案的情况，但我就是想不通......

我有一个分析仪表板，它根据年份、季度 (1-4) 在折线图中显示指标

我需要获取数据库中的最后 8 条最新记录..简单，按年排序，季度限制 0,8。但是我需要从左到右显示最旧的年份，第一季度。所以实际上是相反的，而不是最新到最旧的。所以我需要类似的东西：

```
2011 - Quarter 2
2011 - Quarter 3
2011 - Quarter 4
2012 - Quarter 1
2012 - Quarter 2
2012 - Quarter 3
2012 - Quarter 4
2013 - Quarter 1 (Which is the last added record) 
```

我只是要根据年份 DESC、季度 ASC 来查询它，然后只是反转输出。打算使用 for 循环并将其设置`$i`为`8`, `$i > 0`，`$i--`然后从最后一条记录递增到第一条记录。问题是我不知道如何获取行号。

所以简而言之，我需要查询最新到最旧，但输出最旧到最新。所以，这不是一个 SQL 查询问题，而是一个使用 mysql 的输出问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:36:37.560

使用子查询，例如：

```
SELECT * FROM Revenue WHERE id IN 
  (SELECT id FROM Revenue WHERE ... youc criteria ... ORDER BY ... criteria order ...) 
  ORDER BY ... display order ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T12:51:18.000

这是答案：

```
$results = mysql_query($strQuery) or die(mysql_error()); 

while ($row = array_reverse(mysql_fetch_array($results))) { 

echo $row['something']; 

} 
```

# sql - 限制基于组的选择

> ID：12977598
> 
> 赞同：0
> 
> 时间：2012-10-19T15:31:32.113
> 
> 标签：sql, sql-server

我有2张桌子。表 A 看起来像：

```
actID; jobnumber; actTypeID; completeDate
1;    2000;       3;      2012-09-04
2;    2000;       4;      2012-09-05
3;    2001;       2;      2012-09-10
4;    2001;       4;      2012-09-05
5;    2001;       5;      2012-09-05
6;    2002;       1;      2012-09-12 
```

表 B 如下所示：

```
actTypeID;  actType;  projStatus;
1;     Pick;    Build;
2;     Bid;     Estimate;
3;     PMQC;    QC;
4;     Equipment Test;    QC;
5;     Assembly;    Build; 
```

我需要做的是在其中包含`projStatus`and `actType`：

```
SELECT jobnumber,
    max(completedate) completedate
FROM tableA
GROUP BY jobnumber 
```

在不增加返回记录数的情况下，即恢复此设置：

```
jobnumber; actType; projStatus; completedate;
2000;  EquipmentTest; QC;       2012-09-05;
2001;  Bid;           Estimate; 2012-09-10;
2002;  Pick;          Build;    2012-09-12; 
```

我现在在 SQL Server 2005 上，很快就要到 2008 年了。我觉得我错过了这个技巧。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:40:26.373

试试这个，

```
SELECT  x.[jobnumber], x.[actType], x.[projStatus], x.[completeDate]
FROM
(
SELECT a.[actID], a.[jobnumber], b.[actType], b.[projStatus], a.[completeDate],
      ROW_NUMBER() OVER 
     (PARTITiON BY jobnumber ORDER BY [completeDate] DESC ) xx
FROM table1 a
      INNER JOIN table2 b
        on a.[actTypeID]=b.[actTypeID]
) x
WHERE x.xx = 1 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!3/ed47f/3)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:40:34.527

您正在寻找[`ROW_NUMBER()`](http://msdn.microsoft.com/en-us/library/ms186734%28v=sql.90%29.aspx)功能

```
select jobnumber, actType, projStatus, completedate from
(
    select *, 
        ROW_NUMBER() over (partition by jobnumber order by completedate desc) rn 
    from tablea
) v
    left join tableb
        on v.acttypeid = tableb.actTypeID
where rn = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:51:07.760

试试这个：

```
select a.jobnumber, b.actType, b.projStatus, a.completedate
from 
(select jobnumber, 
       max(actTypeId) as actTypeId,
group by jobnumber) groupTableA
inner join tableA a ON a.jobNumber = groupTableA.jobNumber AND a.actTypeId = groupTableA.actTypeId
inner join tableB b ON b.actTypeId = a.actTypeId 
```

# html - 将单行中的表单与文本区域对齐并删除调整大小功能？

> ID：12977602
> 
> 赞同：-2
> 
> 时间：2012-10-19T15:31:44.813
> 
> 标签：html, css

> **可能重复：**
> [一行中有多个选择选项](https://stackoverflow.com/questions/8778836/multiple-select-options-in-one-row)

我有以下代码，但它在单独的行上生成它，我希望它在一行上（仅填充未显示的父级）。

另外，如何删除文本区域的调整大小功能？

```
<div id="search" align="left" style="width:100% height="100%">
<select>
    <option>Beers</option>
    <option>Cigars</option>
    <option>Wines</option>
</select>
    <div align="right">
        <form>
            <textarea style=width:"100%" height="100%" cols="0" "rows="0"></textarea>
        </form>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:36:36.293

给你：http: [//jsfiddle.net/XeVdN/2](http://jsfiddle.net/XeVdN/2)或见下文：

```
<div id="search" style="float:left; width:100%; height=100%;">
<select stryle="float:left;">
    <option>Beers</option>
    <option>Cigars</option>
    <option>Wines</option>
</select>
    <div style="float:right;">
        <form>
            <textarea style="width:100%; height=100%; resize:none;" cols="0" "rows="0"></textarea>
        </form>
    </div>
</div>​ 
```

您的样式（一些流氓“符号）有一些问题，我已经清理了这些问题，并且为了让它们对齐，您只需将第一个元素向左浮动，第二个元素向右浮动。

出于学习目的，无论何时使用 style 属性，都不需要将每个单独的参数括在引号中，只需将整体语句括起来，并在每个样式后面加上 ; 如上面的示例代码所示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:33:08.683

你想用`float`. 删除该`align`属性并使用`style="float:left;`and`style="float:right;`另一个。

您当前的`style`属性也不正确，请参见下面的示例：

HTML：

```
<div id="search">
  <select>
    <option>Beers</option>
    <option>Cigars</option>
    <option>Wines</option>
  </select>
  <div id="other">
   <form>
     <textarea></textarea>
   </form>
  </div>
</div>​ 
```

CSS：

```
#search {
    width:50%;
    float:left;
}
#other {
    width:50%;
    float:right;
}
/*** This is what removes the textarea resize ***/
textarea {
    resize:none;
} 
```

​这里的工作示例：http: [//jsfiddle.net/gN6Fz/](http://jsfiddle.net/gN6Fz/)

# python - 如何在 python 中使用 2-legged oauth2 发送 POST？

> ID：12977604
> 
> 赞同：5
> 
> 时间：2012-10-19T15:31:50.133
> 
> 标签：python, post, oauth-2.0, urllib2

我在 python 中有一个使用 2-legged oauth2 的工作 GET。这是**工作**获取代码：

进口：

```
import oauth2 
import urllib #for url-encode
import urllib2 #for getting and receiving data from server
import time #Unix timestamp import oauth2 
```

电话：

```
resourceUrl = "https://test.mysite:8443/ess/scheduleapi/v1/people"
request = build_request(resourceUrl,'GET')
u = urllib2.urlopen(request.to_url())
people_data = u.read() 
```

构建请求的函数：

```
def build_request(url, method):
    params = {                                            
        'oauth_version': "1.0",
        'oauth_nonce': oauth2.generate_nonce(),
        'oauth_timestamp': int(time.time())
    }
    consumer = oauth2.Consumer(key='mykey',secret='mysecret')
    params['oauth_consumer_key'] = consumer.key
    req = oauth2.Request(method=method, url=url, parameters=params)
    signature_method = oauth2.SignatureMethod_HMAC_SHA1()
    req.sign_request(signature_method, consumer, None)
    return req
#end build_request 
```

所以，我想我可以复制我认为需要的 GET 部分，并将它与我从一些 urllib2 文档中得到的语法结合起来，然后制作一个有效的 POST。不是这样。请记住，我有相同的导入和相同的 build_request 函数。这是**BROKEN** POST 代码。请指教！

电话：

```
myurl =  "https://test.mysite:8443/ess/scheduleapi/v1/people" 
myaction = 'POST'
myxml = somexmlIalreadygenerated
person_added, err = post_or_put_me(myaction,myxml,myurl) 
```

POST的功能：

```
def post_or_put_me(action,xml,url)
    request = build_request(url,action) # use same header-generating code as GET did?
    post_data = urllib.urlencode(xml)
    req = urllib2.Request(request,post_data)
    try:
        u = urllib2.urlopen(req)
        post_or_put_returned_data = u.read()
        print 'LENGTH  :', len(post_or_put_returned_data)
        print 'DATA    :', post_or_put_returned_data
    except urllib2.HTTPError, e:
        server_error = 'HTTPError = ' + str(e.code)
    except urllib2.URLError, e:
        server_error = 'URLError = ' + str(e.reason)
    except httplib.HTTPException, e:
        server_error = 'HTTPException'
    except Exception:
        import traceback
        server_error = 'generic exception: ' + traceback.format_exc()
    #endtry

    if server_error:
        err_msg = server_error
    else:   
        succ_msg = 'you had a successful post or put'
    #endif

    return succ_msg, err_msg
#end post_or_put_me 
```

这是我的第二次尝试：

```
def post_or_put_me(action,xml,url):
    myrequest = build_request(url,'POST')

    CONSUMER_KEY = 'admin_access'
    CONSUMER_SECRET = 'xxxxxxxxxx' 
    consumer = oauth2.Consumer(key=CONSUMER_KEY, secret=CONSUMER_SECRET)
    token = oauth2.Token(key=CONSUMER_KEY, secret=CONSUMER_SECRET)
    client = oauth2.Client(consumer, token)
    resp, content = client.request(
        url,
        method=action,
        body=urllib.urlencode(str(xml)),
        headers= myrequest.headers,
        force_auth_header=True,
    )
    print 'resp, content are', resp, content 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T20:46:22.297

这是我如何让我的 POST 或 PUT 工作的实际工作代码，由 Echo360 Lecture Capture 的 Wes Barnes 提供。我不希望其他人做 2-legged oauth POST/PUT 不得不重新发明轮子。

```
import oauth2 as oauth
import time
import urllib2 as urllib

echo_base_url = 'http://pilot.echo360.com/ess/scheduleapi/v1'

consumer = oauth.Consumer(key ='xxxxx', secret='xxxx')
client = oauth.Client(consumer)
params = "<person><first-name>Jon</first-name><last-name>Doe</last-name><title>Super  Hero</title><email-address>jdoe17@echo360.com</email-address><block-alerts>false</block-alerts><time-zone>US/Eastern</time-zone><locale>en_US</locale><credentials><user-name>jdoe17@echo360.com</user-name><password>password</password></credentials><organization-roles><organization-role><organization-id>b1973c39-dc76-4cab-a4aa-3f9efd628df2</organization-id><role>role-name-admin</role></organization-role></organization-roles></person>"

resp, content = client.request(
                echo_base_url + "/people/",
                method = "PUT",
                body=params,
                headers={'Content-type': 'application/xml'}
                #force_auth_header=True
                )
print resp, content 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T18:44:54.083

这是我一直在使用 oauth2 向 Twitter 发出 POST 请求的代码。希望它可以帮助您弄清楚语法。

```
import oauth2 as oauth, urllib

def oauth_req(url, key, secret, http_method="POST", post_body=None, http_headers=None):
    CONSUMER_KEY = YOUR_KEY
    CONSUMER_SECRET = YOUR_SECRET
    consumer = oauth.Consumer(key=CONSUMER_KEY, secret=CONSUMER_SECRET)
    token = oauth.Token(key=key, secret=secret)
    client = oauth.Client(consumer, token)
    resp, content = client.request(
        url,
        method=http_method,
        body=urllib.urlencode({'status': post_body}),
        headers=http_headers,
        force_auth_header=True,
    )
    return content

oauth_req('http://api.twitter.com/1/statuses/update.json', KEY, SECRET, post_body=MESSAGE) 
```

# php - 使用 file_get_contents() 的 PHP 脚本运行时间过长

> ID：12977605
> 
> 赞同：0
> 
> 时间：2012-10-19T15:31:50.857
> 
> 标签：php, file-get-contents

我有一个 PHP 脚本，通过 cron 运行，它遍历站点列表并使用 file_get_contents() 针对 API URL 为每个站点收集数据，然后将这些数据存储在 MySQL 数据库中。该脚本针对 60 个不同的站点运行，我们看到每个 URL 拉取多达 5MB 的序列化 PHP 数据。

该系统在我的本地 MAMP 服务器上运行良好，但是一旦将其放置在远程服务器上，它就会停止可靠地运行。有时它会提取和存储数据，但存储的记录少于本地服务器。它还以 504 网关错误结束。在另一台服务器上，它根本没有完成。我们提高了 php.ini 中的所有时间限制，并将我在本地的内容与远程服务器进行了比较，但没有看到任何突出的内容。

有什么方法可以让 PHP 脚本以更“分段”的方式运行这些多次重复的操作？每个站点运行后有什么方法可以“重置计时器”吗？它需要自动化，但是为每个站点设置一个 cron（每个站点 3 个 URL，60 个站点）听起来就像是一场噩梦。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:35:38.510

如果运行需要很长时间，请不要通过 Web 服务器运行它。您已经有了一个 cron 作业，所以只需设置 cron 作业以直接运行脚本（*例如*, `/usr/bin/php /home/path/to/cronjob.php`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:41:26.700

该问题可能是由于PHP或Web服务器的线程数达到限制，也可能是由于服务器中关于单位时间连接数的规则。

如果您可以拆分负载并在不同的时刻执行这些 cron 作业，您将获得更好的结果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:38:17.400

您是否尝试过从远程服务器运行网络诊断到您尝试访问的页面（Ping、DNS 检查、Wget）？如果响应不是肯定的（HTTP 200 代码），file_get_contents 可能需要很长时间才能超时，或者被查询的站点可能需要很长时间才能响应。如果您不想等待失败，可以尝试使用适当的超时设置[流上下文。](http://www.php.net/manual/en/function.file-get-contents.php#82527)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T15:39:39.057

检查`php.ini`设置文件中的以下内容以确保服务器之间的一致性；他们中的任何一个都可以解释行为上的差异：

*   超时
*   执行时间津贴
*   内存限制
*   数据包大小
*   启用/禁用扩展/模块（例如 curl、mysql 等）

# symfony - Symfony2 内核与 HttpKernel

> ID：12977607
> 
> 赞同：7
> 
> 时间：2012-10-19T15:31:55.253
> 
> 标签：symfony, symfony-http-kernel

我正在尝试关注这篇文章：

[http://fabien.potencier.org/article/62/create-your-own-framework-on-top-of-the-symfony2-components-part-12](http://fabien.potencier.org/article/62/create-your-own-framework-on-top-of-the-symfony2-components-part-12)

也在看 HttpKernel [https://github.com/symfony/HttpKernel](https://github.com/symfony/HttpKernel)

我很困惑。在我看来，Kernel 确实比这里的 HttpKernel 类要多得多，甚至标准的 Symfony`app.php`也有

```
$kernel = new AppKernel('prod', false);
$kernel->loadClassCache();

//$kernel = new AppCache($kernel);
$request = Request::createFromGlobals();
$response = $kernel->handle($request); 
```

无论如何，内核将依次调用`HttpKernel->handle()`内部；`$kernel->handle($request)`另外，它似乎也在负责加载捆绑包？

但是，当内核通过它`boot()`内部创建服务容器时`handle()`，也会编译容器，因此无法添加更多参数和服务。

所以我想我的问题是：

1.  在教程中框架类扩展 HttpKernel 而不是 Kernel 是否有任何具体原因？
2.  我也应该效仿吗？或者我应该使用内核作为我的核心。如果是这样，我该如何解决这个`compile()`问题？我确实有必须添加的参数和服务，我该如何处理？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-19T16:03:58.693

这`Kernel`是应用程序的最外层。它在 Symfony 全栈中用于配置调试模式并将捆绑包、类映射自动加载、容器创建捆绑在一起。任何对应用程序“全局”的东西都在这里配置。为了方便起见，它还包装了一个`HttpKernel`实例，并将所有调用委托给它。

`HttpKernel`管理请求/响应生命周期。它是一个独立的类，在事件分派器上分派事件。您可以通过添加响应这些事件的侦听器来修改它的行为。因此，它根本不是特定于应用程序的。配置是`HttpKernel`特定于您的应用程序的特定实例。

我们来谈谈容器编译。容器已编译。这个编译过程对其进行了一些优化，并且还添加了一些功能（根据标签修改容器）。一旦它被编译，它就不能被修改（修改会破坏那些优化）。当你有一个已编译的容器时，你可以将它转储到磁盘。通过使用，`PhpDumper`您可以将其转储到生成的 PHP 类中，这比每次都构建它的性能要高得多。

> 在教程中框架类扩展 HttpKernel 而不是 Kernel 是否有任何具体原因？

是的。本教程是关于如何使用 Symfony2 组件构建*自己的框架。*`Kernel`是 Symfony2 全栈框架的外壳。如果你使用它，你就没有使用你自己的框架。您正在使用 Symfony2 全栈。

> 我也应该效仿吗？

这取决于。如果你想要`Kernel`提供的东西，你还不如使用 Symfony 全栈。但是，您并没有创建自己的框架。

> 如果是这样，我该如何解决 compile() 问题？我确实有必须添加的参数和服务，我该如何处理？

If you want a compiled container, you'll need to add those parameters and services as extensions (bundles allow you to tie in extensions), and those extensions register services and parameters. This happens before the compilation step, so that the definitions can then be compiled and dumped to a file.

# sql - 对具有相同名称的列的表进行聚合 SQL 查询

> ID：12977610
> 
> 赞同：0
> 
> 时间：2012-10-19T15:32:03.647
> 
> 标签：sql, aggregate-functions

我有两个表，都有一个名为`transaction_amnt`. 有没有办法可以编写一个 SQL 查询来返回两个表中所有交易金额的总和？我试过

```
select sum(transaction_amnt) from table1 natural join table2; 
```

但是，我认为这`join`并不是我真正想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:33:42.677

我想`union all`最适合您的问题，因为它不会删除记录中的重复项。

```
SELECT SUM(x.transaction_amnt) totalAmount
FROM
(
    SELECT transaction_amnt from table1
    UNION ALL
    SELECT transaction_amnt from table2
) x 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:33:53.207

由于您没有向我们展示您的表定义，因此我不清楚您真正想要什么，但这可能是我认为您正在寻找的：

```
select sum(transaction_amnt) 
from (
  select transaction_amnt
  from table1 
  union 
  select transaction_amnt
  from table2
) t 
```

# diff - 在当前打开的 Visual Studio 2012 实例中打开差异

> ID：12977615
> 
> 赞同：12
> 
> 时间：2012-10-19T15:32:13.177
> 
> 标签：diff, visual-studio-2012

所以我最近一直在使用 VS2012 diff 工具和 git，我敢说真的很喜欢。导致问题的原因是使用命令“devenv.exe -diff $file1 $file2”打开差异在新窗口中打开差异（需要 aaaages）。任何人都知道是否可以在 Visual Studio 的当前实例中打开差异而不是新实例？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-07-15T23:35:59.870

您可能想看看[这个答案](https://stackoverflow.com/a/17664677/2410220)：`Tools.DiffFiles`在命令窗口中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-04T08:06:54.413

我正在使用VS2013。由于我始终以管理员身份运行 devenv.exe，因此我设法通过启动具有管理员权限的 cmd（或调用 -diff 的应用程序）来实现这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:34:46.607

在解决方案资源管理器中右键单击文件，然后选择比较。然后，您可以选择文件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-17T14:23:47.393

这是 vs2017 默认行为

# c - c函数调用错误

> ID：12977620
> 
> 赞同：1
> 
> 时间：2012-10-19T15:32:25.423
> 
> 标签：c, function, loops

今天在用c语言测试，做了两个小c文件

主程序

```
#include<conio.h>
void testing();
int main()
{
    testing();
    getch();
    return 0;
} 
```

测试.c

```
#include <stdio.h>

void testing()
{
    char ch;
    printf("Hello Testing\n");
    do{
        printf("Enter Character : ");
        ch=getchar();
        printf("You Entered : %c\n",ch);
        testing();
        }while(ch!='N');
} 
```

我面临的问题是它从用户那里读取一个字符，然后循环两次，我不知道为什么

```
output
Hello Testing
Enter Character : k //(i entered k)
You Entered : k

Hello Testing// why this is displayed twice??
Enter Character : You Entered :// i don't press any key and it moves to next iteration

Hello Testing
Enter Character : // here i can enter character again and it happens again twice 
```

我已经在 Visual Studio 2012 上编译了它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:34:26.127

因为`getchar()`在输入缓冲区中留下了换行符。您可以使用另一个 getchar() 来吃换行符。

```
ch=getchar();
getchar(); 
```

或者使用 scanf 吃掉前导空格：

```
scanf(" %c", &ch); 
```

这样，前面的所有内容都`\n`将被忽略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:34:00.600

打印字符后，您重新调用`testing()`. 这让你循环测试。删除这条线，你会没事的。

你没有故意是[递归](http://en.wikipedia.org/wiki/Recursion_%28computer_science%29)。这是计算机编程的一个充满激情的方面，但不是您打算做的。

还有一件事，当您按下回车键以验证您的输入时，请考虑再次读取以消耗输入缓冲区中留下的换行符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T15:38:32.037

您的问题可能是由于您在循环中递归调用 testing() 函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T15:34:26.250

它显示两次，因为你在那里有递归，这个函数应该做什么，你有无限递归？

# android - 使用微调器设置另一个微调器的适配器和一个字符串到 setSelection

> ID：12977624
> 
> 赞同：0
> 
> 时间：2012-10-19T15:32:53.350
> 
> 标签：android, sqlite, spinner

> **可能重复：**
> [动态创建微调器并从 SQLite 设置其值](https://stackoverflow.com/questions/12962268/dynamically-creating-a-spinner-and-setting-its-value-from-sqlite)

我正在查看其他帖子并找到与我的问题类似但没有具体的项目，所以简而言之

问题是我从数据库返回两个字符串：

```
 tName, tType using a cursor object (see other post) 
```

然后我使用第一个`tType`设置第一个微调器的位置，我对此没有任何问题，因为我只为这个微调器使用了一个适配器。

基于此字符串项，我想使用 switch 语句从其他三个适配器中进行选择。并将此适配器设置为我的微调器，然后根据字符串设置选择`tName`

请帮忙！我的另一篇文章中的完整问题和代码：

[从 SQLite 动态创建微调器并设置其值](https://stackoverflow.com/questions/12962268/dynamically-creating-a-spinner-and-setting-its-value-from-sqlite)

# python - 使用 argparse 传递给 python 脚本的文件类型检查参数

> ID：12977628
> 
> 赞同：2
> 
> 时间：2012-10-19T15:33:08.417
> 
> 标签：python, file-type, argparse

有没有办法使用文件类型检查文件名参数`argparse`？如果我可以创建正确类型的容器对象，似乎可以通过 type 或 Choices 关键字来完成。

我期待传入的文件类型（例如），如果文件类型不正确（ ） `file.txt`，我想`argparse`给出它的自动消息`.txt`。例如， argparse 可能会输出

```
usage: PROG --foo filename etc... error: argument filename must be of type *.txt. 
```

也许不是检测错误的文件类型，我们可以尝试检测文件名字符串不以“.txt”结尾，但这需要一个复杂的容器对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T15:51:26.217

可以使用`type=`关键字指定自己的类型转换器；如果您的文件名不正确，请抛出`ArgumentTypeError`：

```
import argparse

def textfile(value):
    if not value.endswith('.txt'):
        raise argparse.ArgumentTypeError(
            'argument filename must be of type *.txt')
    return value 
```

类型转换器不必*转换*值..

```
parser.add_argument('filename', ..., type=textfile) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:50:40.960

当然。您可以创建自定义操作：

```
class FileChecker(argparse.Action):
    def __init__(self,parser,namespace,filename,option_string=None):
        #code here to check the file, e.g...
        check_ok = filename.endswith('.txt')
        if not check_ok:
           parser.error("useful message here")
        else:
           setattr(namespace,self.dest,filename) 
```

然后你用它作为`action`：

```
parser.add_argument('foo',action=FileChecker) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:57:12.313

我通常使用 'type' 参数来做这样的检查

```
import argparse

def foo_type(path):
    if not path.endswith(".txt"):
        raise argparse.ArgumentTypeError("Only .txt files allowed")
    return path

parser = argparse.ArgumentParser()
parser.add_argument('--foo', help='foo help', type=foo_type)
args = parser.parse_args() 
```

例子：

```
$ python argp.py --foo not_my_type
usage: argp.py [-h] [--foo FOO]
argp.py: error: argument --foo: Only .txt files allowed 
```

# javascript - Javascript多对象数组问题

> ID：12977630
> 
> 赞同：0
> 
> 时间：2012-10-19T15:33:31.553
> 
> 标签：javascript, arrays, object

我的一些代码有问题。我有以下对象（bookingDetails），它具有一个“类型”属性，该属性是一个数组，它存储对象，而该对象又具有另一个对象数组。例如：

```
bookingDetails (object)
- type(array)
    - id
    - share (array)
        Number (object) 
```

首先有没有更好的方法来做到这一点？（我需要能够针对每种类型的份额存储大量“数字”）

其次，如果有人单击一个大的旧“X”，那么我需要从正确的共享中删除该数字，如果共享为空，则删除该共享所属的整个类型对象。

目前我正试图通过以下方式做到这一点：

```
for(var d in bookingDetails[data[6]]){
    var it = bookingDetails[data[6]][d];
    if(it.ID === data[0]){
        for(var s in it.Sharing){
            var pa = it.Sharing[s];
            for(var p in pa){
                var pax = pa[p];
                for(var pd in paxData){
                    if(pax.PaxNo === paxData[pd]){
                        //what to do here??
                    }   
                }
            }
        }
    }
} 
```

我查看了 splice 以从共享数组中删除对象，但这会改变数组索引，这对于上述循环来说是个问题......这一切看起来都很混乱。

任何帮助将不胜感激，因为我已经尝试这样做一段时间了..

如果这不是最好的方法，我很想知道更好的方法:)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:44:16.350

如果您打算随时修改阵列，请向后走阵列。

```
 var i;
 for( i = myarray.length-1; i >= 0; i-- ){
    // ...something that might remove myarray[i]...
 } 
```

无法真正说出您的数据复杂性问题；您可能只是试图表示复杂的数据。也可能是您应该使用具有命名属性的对象而不是具有未命名索引的数组。无论哪种方式，为了理智，我建议编写实用程序函数甚至对象装饰器来将复杂性与代码的其他部分隔离开来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T11:33:20.390

```
Bookingdetails.types =array with id on the types this bookingdetail belongs to
Bookingdetails.id=Number id of the bookingdetails

Type.id= Number, id of the type
Type.share=Array with bookingdetails id. 
```

这将占用更多空间，但进行查找会更快一些。它将使请求的操作更简单。

PS：如果你使用 Typescript 会更容易 ;-)

# iphone - 在应用启动过渡动画期间，UIView 内容没有动画

> ID：12977641
> 
> 赞同：1
> 
> 时间：2012-10-19T15:34:18.887
> 
> 标签：iphone, objective-c, ios, uiview

我认为我的问题可以最简单地提出： UIView 的内容可以更新/修改/动画......并在视图转换期间显示这些更改吗？如果是这样，如何使它起作用？

我用我的 iOS 应用程序启动时创建的重复 NSTimer 做了一个简单的测试。它大约每 0.05 秒增加一个计数器，并将增加的计数显示到放置在 Interface Builder (IB) 中我的 UIView 上的 UILabel。

除非我在下面提到一种情况，否则 iPhone 屏幕上的内容会以在 NSTimer 精度等可接受的容差范围内不断刷新的速度不断刷新，等等。（嘿，这只是对概念的测试）。

因此问题是：当应用程序启动转换发生时，UILabel 内容没有被刷新。（我的 UIView 出现在屏幕外并放大以填满整个屏幕的初始视图。）

一旦该转换完成，由于 NSTimer 在后台触发，UILabel 内容“跳转”到看起来合理的计数......唯一的事情是，在转换期间内容没有被重绘。我确实尝试了一些类似的东西：[myLabel setNeedsDisplay]; 在每次增量和标签内容更新后，它什么也不做。我猜这个问题更多的是在 UIView 或者 UIViewController 级别？

抱歉，如果我的术语在这里很糟糕，并且希望有一个简单的解决方案，除非我在我正在做的任何搜索中都没有找到它，因为使用了有缺陷或不正确的术语。

另外，我可以发布代码，但很难想象那会是什么。应用程序启动过渡动画不是我们触发或控制的……唯一的其他代码是在过渡期间令人满意地触发的 NSTimer - 它实际上只是 UIView 内容没有重绘或其他什么？

哦，还有一个想法：我不一定希望在过渡期间重绘流畅的 UIView，但我正在考虑一旦我知道这甚至可以工作后我最终想要尝试的东西......即使只是在过渡期间重绘了一些 UIView过渡看起来足够好。当然比过渡结束时看起来像是“流行音乐”要好得多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T17:15:24.833

不知道你说的“应用启动过渡动画不是我们触发或控制的”是什么意思。您是在谈论从 default.png 到您的 rootViewController 的转换吗？

无论哪种方式，我都相信您的标签在动画期间不会更新，因为当动画发生时，它实际上是一个新的“表示层”，而不是您的标签正在更新的实际层。您可能想尝试在您的视图上调用 setNeedsDisplay。除了查看表示层上的文档之外，这可能无济于事，也许您会找到解决方案：[“CALayer，presentationLayer”](http://developer.apple.com/library/ios/#DOCUMENTATION/GraphicsImaging/Reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instm/CALayer/presentationLayer)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:46:26.803

视图出现在屏幕上的初始视图是启动图像。它只是一个png，所以它不能被动画化。除了该图像之外，在应用程序完成加载之前，不会有任何内容更新到屏幕上。

# samsung-smart-tv - 在三星智能电视上托管 HTML/CSS/JS

> ID：12977643
> 
> 赞同：0
> 
> 时间：2012-10-19T15:34:22.723
> 
> 标签：samsung-smart-tv

我想开发一个简单的远程控制 Web 应用程序，我可以从我的智能手机/平板电脑/笔记本电脑访问它来更改我的三星智能电视的频道/音量/来源。

是否可以在三星智能电视上托管一个简单的 web 应用程序 (HTML/CSS/JS) 以供同一子网中的其他设备使用？例如通过访问：

```
http://samsung-smart-tv-ip-address/remote. 
```

非常感谢这方面的任何帮助。

托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T19:43:29.873

对于智能手机，您已经拥有三星提供的远程控制应用程序，它非常好。

只需搜索您的 Play 商店。

# javascript - JavaScript：将结果输出到具有不同名称的多个字段

> ID：12977650
> 
> 赞同：-2
> 
> 时间：2012-10-19T15:34:34.020
> 
> 标签：javascript, html, asp-classic

这是我在 StackOverflow 上的第一篇文章，我已经阅读了很多关于这个网站上的代码片段的页面，并且总是你给出很好的答案和建议..

但是现在我需要一些帮助。我想填充多个输入字段，我尝试在 JavaScript 中添加一个字段 ID，但到目前为止没有运气。

```
<script type="text/javascript">
<!--
function calculateAge(inputFieldId, outputFieldId, alert_18){

var age;

var input = document.getElementById(inputFieldId).value;

// Past date info

var pyear = parseInt(input.substring(6,10));
var pmonth = parseInt(input.substring(0,2)) - 1;
var pday = parseInt(input.substring(3,5));
// Today info
today = new Date();
year = today.getFullYear() ;
month = today.getMonth();
day = today.getDate();

if ( month < pmonth ){
age = year - pyear - 1;
}
else if ( month > pmonth ){
age = year - pyear;
}
else if ( month == pmonth ){
if ( day < pday ){
age = year - pyear - 1;
}
else if ( day > pday ){
age = year - pyear;
}
else if ( day == pday ){
age = year - pyear;
}
}
document.getElementById(outputFieldId).value = age;
document.getElementById(outputFieldId).value = age2;

if(alert_18 == 'true'){
if(age < 18){

//Customize alert message

alert('Attention: under 18!');
}
}
}
//-->
</script> 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T12:43:23.963

我建议使用以下解决方案来处理任意数量的输出字段（并粗略计算年龄 - 不考虑闰年）：

```
<script type="text/javascript">
<!--
function calculateAge(inputFieldId, outputFieldId, alert_18){
  var input = document.getElementById(inputFieldId).value,
      pyear = parseInt(input.substring(6,10)),
      pmonth = parseInt(input.substring(0,2)) - 1,
      pday = parseInt(input.substring(3,5)),
      dt1 = new Date(),
      dt2 = new Date(pyear, pmonth, pday),
      ageMs = dt2.getTime() - dt1.getTime(),
      age = parseInt(ageMs / 1000 / 60 / 60 / 24 / 365);

  if(outputFieldId instanceof Array) {
    for(var i = 0, l = outputFieldId.length; i < l; i++)
      document.getElementById(outputFieldId[i]).value = age;
  }
  else
    document.getElementById(outputFieldId).value = age; 

  if(alert_18 && age < 18) {
    //Customize alert message

    alert('Attention: under 18!');
  }
}
//-->
</script> 
```

然后，当您调用它时，您可以将单个字符串作为 outputfieldid 传递，如下所示：

```
calculateAge("get-age", "calculated-age", true); 
```

或者您可以像这样传递一个 fieldid 数组：

```
calculateAge("get-age", ["calculated-age1", "calculated-age2"], true); 
```

# javascript - 使用 matchSelector js 检查 event.target.parentElement

> ID：12977658
> 
> 赞同：4
> 
> 时间：2012-10-19T15:34:50.337
> 
> 标签：javascript, events, match

不关心旧的浏览器回退。另外，不能使用库。

我有一个事件对象。我正在通过matchesSelector针对css选择器测试event.target：

`event['target'].matchesSelector('css selector here');`

这有效，如下所示：

`event['target']['parentElement'].matchesSelector('css selector here');`

...和：

`event['target']['parentElement']['parentElement'].matchesSelector('css selector here');`

我正在寻找的是一些超出我理解的可能的对象方法，我可以使用它来一直检查每个 parentElement 是否匹配，而无需`for`循环。我的重点是效率。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2019-09-19T02:12:21.940

最近的[（）](https://developer.mozilla.org/en-US/docs/Web/API/Element/closest)函数将满足您的需要。

它从元素本身开始，遍历父元素（朝向文档根），直到找到与提供的选择器字符串匹配的节点。有点类似于jQuery的`parents()`功能。

所以你的代码看起来像这样：

```
event.target.closest(selectorString) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-17T16:17:27.970

To prevent redundant looping through all parent elements of your target element, you can perform quick checking for whether your element is inside of an element that matches your selector by using `matchesSelector()` with selector that is concatenation of your original selector and appended context selector consisting of space and your target-element's tag name:

```
function getAncestorBySelector(elem, selector) {
    if (!elem.matchesSelector(selector + ' ' + elem.tagName)) {
        // If element is not inside needed element, returning immediately.
        return null;
    }

    // Loop for finding an ancestor element that matches your selector.
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-03T22:26:22.647

[**Marat Tanalin**](https://stackoverflow.com/users/1211187/marat-tanalin)的解决方案很好，但标准语法`elem.matchesSelector`是`elem.matches`：

```
function getAncestorBySelector(elem, selector) {
    if (!elem.matches(selector + ' ' + elem.tagName)) {
        // If element is not inside needed element, returning immediately.
        return null;
    }

    // Loop for finding an ancestor element that matches your selector.
} 
```

不幸的是，并非所有浏览器都支持这种语法。一些浏览器仍然实现了前缀版本，`elem.matchesSelector`而 Opera Mini 根本不支持此功能。

为了缓解这个问题，您可以按照 MDN的[**建议**](https://developer.mozilla.org/en-US/docs/Web/API/Element/matches)将描述的方法与以下[**polyfill**](https://remysharp.com/2010/10/08/what-is-a-polyfill)结合起来：[](https://developer.mozilla.org/en-US/docs/Web/API/Element/matches)

 **```
if (!Element.prototype.matches) {
    Element.prototype.matches = 
        Element.prototype.matchesSelector || 
        Element.prototype.mozMatchesSelector ||
        Element.prototype.msMatchesSelector || 
        Element.prototype.oMatchesSelector || 
        Element.prototype.webkitMatchesSelector ||
        function(s) {
            var matches = (this.document || this.ownerDocument).querySelectorAll(s),
                i = matches.length;
            while (--i >= 0 && matches.item(i) !== this) {}
            return i > -1;            
        };
} 
```

或者，您可能要考虑完全抛弃`elem.matchesSelector`并使用以下内容：

```
function getAncestorBySelector(elem, selector) {
    if([].indexOf.call(document.querySelectorAll(selector + ' ' + elem.tagName), elem) === -1) {
        // If element is not inside needed element, returning immediately.
        return null;
    }
    // Loop for finding an ancestor element that matches your selector.
} 
```

两种实现都至少需要支持`querySelectorAll`，这是所有现代浏览器都支持的功能。

### 浏览器支持：

[![在此处输入图像描述](../Images/c09cf596cff5ec974dd9e4ae391d8a0b.png)](https://i.stack.imgur.com/xHeba.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-08T15:45:10.113

大多数要求在 vanilla-js 中重新实现 jQuery`parents()`方法的问题都作为这个问题的重复而关闭，我想提供一个更现代的示例来更好地模拟 jQuery 的行为。

打字稿：

```
function getAllParentElements(child: HTMLElement, selector: string = '*') {
    const parents: HTMLElement[] = [];

    let parent: HTMLElement = child.parentElement?.closest(selector);
    while (parent) {
        parents.push(parent);
        parent = parent.parentElement?.closest(selector);
    }

    return parents;
} 
```

Javascript：

```
function getAllParentElements(child, selector = '*') {
    const parents = [];

    let parent = child.parentElement && child.parentElement.closest(selector);
    while (parent) {
        parents.push(parent);
        parent = parent.parentElement && parent.parentElement.closest(selector);
    }

    return parents;
} 
```

```
getAllParentElements(childEl); // -> return all ancestors including body & html elements
getAllParentElements(childEl, '.foo'); // -> return all ancestors with `.foo` class 
```**

# javascript - 如何通过 Javascript 登录 Liferay 服务器？

> ID：12977659
> 
> 赞同：1
> 
> 时间：2012-10-19T15:34:49.587
> 
> 标签：javascript, login, liferay, external

我在沙盒服务器中安装了 Liferay 6.1，并希望能够从外部网页查看特定组/站点的博客条目。此页面最终将在移动设备上运行，并且可能没有任何关于 Liferay 发条在后台发生的迹象。

我能够弄清楚并使用 Liferay 简洁的 JSONWS 来获取博客条目，但此时登录/身份验证过程对我来说有点模糊。如何计算 p_auth？如何通过 Javascript 将 user/passwd/p_auth 传递给 Liferay？事实上，我什至需要发送 p_auth 才能登录/验证？

总之：我需要一个基于 javascript 的网页，以便能够登录/验证 Liferay 并通过其 JSONWS 提取数据。任何想法和/或示例都将受到*欢迎*。

# jshint - 有没有办法抑制给定行的 JSHint 警告？

> ID：12977661
> 
> 赞同：267
> 
> 时间：2012-10-19T15:34:52.007
> 
> 标签：jshint

我的应用程序中有一个（单个）案例`eval`被使用，我想仅针对这种情况禁止 JSHint 警告。

有没有办法做到这一点？配置，魔术评论，...？

* * *

## 回答 #1

> 赞同：477
> 
> 时间：2013-10-28T12:52:51.383

是的，有办法。实际上是两个。2013年[10 月，](http://www.jshint.com/blog/new-in-jshint-oct-2013/) jshint 添加了一种忽略如下代码块的方法：

```
// Code here will be linted with JSHint.
/* jshint ignore:start */
// Code here will be ignored by JSHint.
/* jshint ignore:end */
// Code here will be linted with JSHint. 
```

您还可以忽略带有尾随注释的单行，如下所示：

```
ignoreThis(); // jshint ignore:line 
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2013-10-22T06:00:10.013

“邪恶”的答案对我不起作用。相反，我使用了 JSHints[文档页面](http://www.jshint.com/docs/)上推荐的内容。如果您知道引发的警告，则可以将其关闭以获取代码块。例如，我正在使用一些不使用驼峰函数的第三方代码，但我的 JSHint 规则需要它，这导致了警告。为了让它沉默，我写道：

```
/*jshint -W106 */
save_state(id);
/*jshint +W106 */ 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2012-10-23T10:31:46.410

正如您在[JSHint 的文档中](http://www.jshint.com/docs/)看到的那样，您可以更改*每个函数*或*每个文件*的选项。在您的情况下，只需在您的文件中添加评论，或者在使用的函数中添加更多本地评论`eval`：

```
/*jshint evil:true */

function helloEval(str) {
    /*jshint evil:true */
    eval(str);
} 
```

# actionscript-3 - AS3 - “调用可能未定义的方法”

> ID：12977664
> 
> 赞同：0
> 
> 时间：2012-10-19T15:35:00.867
> 
> 标签：actionscript-3

我对 ActionScript 3 非常陌生，但我一直在逐步构建一个类似“坦克”的小型射击游戏，现在我正准备添加子弹射击，为此我制作了一个新的 AS3 类和导入它等，但是当我运行游戏时出现错误：

> 调用可能未定义的方法`turretShot`

请帮助我找出为什么会发生这种情况。此错误在我的编译器错误中显示了两次，并且它所针对的行非常相似，以下是受影响的代码部分：

shootTurret.as（类文件）

```
package resources
{
    import flash.display.*;
    import flash.events.*;

    public class turretShot extends MovieClip
    {
        var enemy_mc:MovieClip;
        public function turretShot(enemy_mc:MovieClip)
        {
            var xSpeed:Number;
            var ySpeed:Number;
            var angle:Number;
            public var shotSpeed:Number;
            speed = 30;
            var gravity:Number = 1;
            var thisShot:MovieClip;
            var platform1_mc:MovieClip;
            var platform2_mc:MovieClip;
            var thisParent: *;
            enemy_mc = enemy;
            this.addEventListener(Event.ADDED, initialize);
        }
        function initialize(event:Event):void
        {
            this.addEventListener(Event.ENTER_FRAME, moveShot);
            thisParent = event.currentTarget.parent;
            platform1_mc = thisParent.platform1_mc;
            platform2_mc = thisParent.platform2_mc;
            thisShot = MovieClip(this.parent.getChildByName(this.name));
            angle = this.rotation / 180 * Math.PI;
            xSpeed = Math.cos(angle) * speed;
            ySpeed = Math.sin(angle) * speed;
        }   
        function moveShot(event:Event):void
    }
} 
```

我已经在我的游戏 .FLA 动作脚本中导入了这个必要的框架：

```
import resources.*; 
```

因为我的类文件位于游戏目录的“资源”文件夹中。

现在，抛出这些错误的两段代码......不确定是与它们有关还是与类有关，但它们是：

（第四行）

```
var shot_mc:MovieClip;
if (keyPressed == Keyboard.SPACE && spaceKeyDown == false)
{
    shot_mc = new turretShot(enemy_mc);
    shot_mc.x = user_mc.x + user_mc.turret_mc.x;
    shot_mc.y = user_mc.y + user_mc.turret_mc.y;
    shot_mc.rotation = user_mc.turret_mc.rotation;
    addChild(shot_mc);
    spaceKeyDown = true;
} 
```

和（第一行）：

```
var shot_mc:MovieClip = new turretShot(user_mc);
shot_mc.x = enemy_mc.x + enemy_mc.enemyTurret_mc.x;
shot_mc.y = enemy_mc.y + enemy_mc.enemyTurret_mc.y;
shot_mc.rotation = enemyTargetRotation;
shot_mc.speed = Math.random() * 15 + 15;
addChild(shot_mc); 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:51:14.403

您的 turretShot 类中有几个错误，编译器可能也会报告这些错误。修复它们，此消息应该消失。

您在构造函数内定义的变量应在其外部定义，以及`var enemy_mc:MovieClip;`. 根据您的代码逻辑`public`制作它们`private`也是一种很好的反射。`protected`

我还看到该行`enemy_mc = enemy;`引用了一个`enemy`不存在的变量。您可能意味着您的构造函数是`public function turretShot(enemy:MovieClip)`.

我没有捡到的代码中可能还有其他错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:06:24.783

就像戴夫哈特所说的那样，您有很多错误，但是您要问的具体错误是因为您没有将课程导入您的 FLA。

```
import resources.turretShot; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-21T18:11:25.690

我更正了这个类的语法，所以你可以在评论部分看到我对另一个问题的意思。我给了所有变量`public`范围和方法`private`范围，但可以随意更改它以满足您的需要。

您应该注意，您发布的代码有很多语法错误，并且在尝试编写完整游戏之前，您应该对 ActionScript3 和 OOP 充满信心。请学习本教程（或任何其他）关于 AS3 和类：[关于 ActionScript 3 中的类的 kirupa 教程](http://www.kirupa.com/developer/as3/classes_as3_pg1.htm)

附带说明一下，类名通常用**UpperCamelCase**编写。这是大多数 ActionScript3（和 Java 等）程序员遵循的约定，如果您坚持下去，您的代码将更具可读性，因此下次应该更容易为您提供帮助；）

```
package resources
{
    import flash.display.*;
    import flash.events.*;

    public class TurretShot extends MovieClip
    {
        public var enemy_mc:MovieClip;
        public var xSpeed:Number;
        public var ySpeed:Number;
        public var angle:Number;
        public var shotSpeed:Number;
        public var speed:Number = 30;
        public var gravity:Number = 1;
        public var thisShot:MovieClip;
        public var platform1_mc:MovieClip;
        public var platform2_mc:MovieClip;
        public var thisParent: *;

        public function TurretShot(enemyParam:MovieClip)
        {

            enemy_mc = enemyParam;
            this.addEventListener(Event.ADDED, initialize);
        }

        private function initialize(event:Event):void
        {
            this.addEventListener(Event.ENTER_FRAME, moveShot);
            thisParent = event.currentTarget.parent;
            platform1_mc = thisParent.platform1_mc;
            platform2_mc = thisParent.platform2_mc;
            thisShot = MovieClip(this.parent.getChildByName(this.name));
            angle = this.rotation / 180 * Math.PI;
            xSpeed = Math.cos(angle) * speed;
            ySpeed = Math.sin(angle) * speed;
        }

        private function moveShot(event:Event):void
        {
           //do stuff every frame
           trace("enter frame");
        }

    }
} 
```

希望这可以帮助！

# ios5 - 在 Facebook 页面上发布

> ID：12977665
> 
> 赞同：0
> 
> 时间：2012-10-19T15:35:02.813
> 
> 标签：ios5, xcode4.3

我正在使用此代码在 facebook 页面上发布任何文本，其中页面 id 已在代码中提及。它给出了成功消息，但是当我转到该页面时，什么也没有。请帮助...

提前致谢

```
-(void)facebookPost; 
```

{ NSMutableDictionary *variables = [NSMutableDictionary dictionaryWithCapacity:2]; FbGraphFile *graph_file = [[FbGraphFile alloc]init]; //initWithImage:[UIImage imageNamed:@"gg"]]; //最后，将 FbGraphFile 对象设置到我们的变量字典中.... [variables setObject:graph_file forKey:@"file"];

```
[variables setObject:@"hihihi" forKey:@"message"];
FbGraphResponse *fb_graph_response = [fbGraph doGraphPost:[NSString stringWithFormat:@"%@/167884363345570/feed",FACEBOOK_APP_KEY] withPostVars:variables]; 
```

FbGraphResponse *fb_graph_response = [fbGraph doGraphPost:[NSString stringWithFormat:@"%@/167884363345570/feed",FACEBOOK_APP_KEY] withPostVars:variables];

```
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T09:06:39.357

错误出现在这一行...

**错误的：**

```
FbGraphResponse *fb_graph_response = [fbGraph doGraphPost:[NSString stringWithFormat:@"%@/167884363345570/feed",FACEBOOK_APP_KEY] withPostVars:variables]; 
```

**正确的方法是这样的：**

```
FbGraphResponse *fb_graph_response = [fbGraph doGraphPost:[NSString stringWithFormat:@"167884363345570/feed"] withPostVars:variables]; 
```

我已经解决了这个问题。

# javascript - 在一页上搜索多个谷歌地图和缩放问题

> ID：12977671
> 
> 赞同：0
> 
> 时间：2012-10-19T15:35:20.210
> 
> 标签：javascript, google-maps, google-maps-api-3, geocoding

今天我在谷歌地图问题上得到了很大的帮助，当我处理我的代码时，会弹出更多的东西。所以这是我希望得到帮助的另一个问题。

有2个部分

**1）**我已经调整了我的代码以在同一页面上显示 2 x 谷歌地图。我的谷歌地图是这样工作的

用户搜索地址，结果是

*   地图显示位置图钉
*   长和纬度字段用坐标填充
*   为办公室名称调用的输入字段填充有搜索查询。

当我有 1 张地图时，这一切都有效。但是当我在下面的代码中添加 map2 时，我不确定如何编写代码来拆分 map 和 map2 之间的结果

我的代码尝试如下（头）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?sensor=true">
    </script>
<script type="text/javascript">

var geocoder;
var map,map2;

function initialize(condition) {
    geocoder = new google.maps.Geocoder();
    var latlng = new google.maps.LatLng(53.2948557, -6.139267399999994);
    var mapOptions = {
      zoom: 10,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);

    map2 = new google.maps.Map(document.getElementById('map_canvas2'), mapOptions);  
 }

function codeAddress() {
    var address = document.getElementById('address').value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
        document.getElementById("input_15_169").value = marker.getPosition().lat();
        document.getElementById("input_15_167").value = marker.getPosition().lng();
        document.getElementById("input_15_92").value = address;

      } else {
        alert('Geocode was not successful for the following reason: ' + status);
      }
    });
  }

</script> 
```

我的身体看起来像这样

```
<body onload="initialize()" onunload="GUnload()">
  <p>To Add your Google Map you must first plot your address by searching</p>
  <p>
    <input id="address" type="textbox" value="" placeholder="Search For Your Address">
    <input type="button" value="Plot Your Address" onclick="codeAddress()">
  </p>

  <div id="latlong">
      <p>Office Name: <input size="20" type="text" id="input_15_92" name="ofn" ></p>
      <p>Latitude: <input size="20" type="text" id="input_15_169" name="lat" ></p>
      <p>Longitude: <input size="20" type="text" id="input_15_167" name="lng" ></p>
    </div>

  <div id="map_canvas" style="width: 600px; height: 400px"></div>

  <p>To Add your Google Map you must first plot your address by searching</p>
  <p>
    <input id="address2" type="textbox" value="" placeholder="Search For Your Address">
    <input type="button" value="Plot Your Address" onclick="codeAddress()">
  </p>

  <div id="latlong">
      <p>Office Name: <input size="20" type="text" id="input_16_92" name="ofn" ></p>
      <p>Latitude: <input size="20" type="text" id="input_16_169" name="lat" ></p>
      <p>Longitude: <input size="20" type="text" id="input_16_167" name="lng" ></p>
    </div>

  <div id="map_canvas2" style="width: 600px; height: 400px"></div>

</body>
</html> 
```

我知道在上面我当前的 javascript 中我缺少填充第二张地图的字段的代码，它应该看起来像这样，但我不确定将它们放在哪里

```
document.getElementById("input_16_169").value = marker.getPosition().lat();
document.getElementById("input_16_167").value = marker.getPosition().lng();
document.getElementById("input_16_92").value = address; 
```

////

**2）**第二个问题与缩放有关。我看到我可以`zoom: 10,`在代码的开头设置我的缩放级别，它给出了地图的缩放级别。我想知道是否可以在找到结果时进行不同的缩放，即在用户搜索之后，因为我希望放大一点！

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T01:26:59.573

我会建议一个不同的标记。

将输入和映射包装成一个表单，如下所示：

```
 <form style="width:220px;float:left;">
      <input name="address" value="" placeholder="Search For Your Address"/>
      <input type="button" value="Plot Your Address" onclick="codeAddress(this.form)"/>
      <input size="20" type="text"  name="ofn" />
      <input size="20" type="text" name="lat" />
      <input size="20" type="text"  name="lng" />
      <div class="map_canvas" style="width: 200px; height: 200px"></div>
  </form> 
```

好处：

您现在将能够动态加载地图，而无需知道地图的数量。您可以使用 轻松选择它们`document.querySelectorAll('form>.map_canvas');`，生成的 nodeList 可用于在循环中创建地图：

```
 var maps=document.querySelectorAll('form>.map_canvas');
    for(var i=0;i<maps.length;++i)
    {
        maps[i].parentNode.map=new google.maps.Map(maps[i], mapOptions);
    } 
```

**注意：**地图将存储为表单的属性，而不是创建全局地图变量，因此您可以稍后通过使用访问地图`formElement.map`

还要注意 的调用`codeAddress()`，它现在有一个参数`this.form`，它指的是单击的按钮所属的表单。

通过使用此参数，您可以访问所需表单内的输入和映射：

功能代码地址（表格）{

```
var address=form.address.value
geocoder.geocode( { 'address': address}, function(results, status) {
  if (status == google.maps.GeocoderStatus.OK) {

    form.map.setCenter(results[0].geometry.location);
    var marker = new google.maps.Marker({
        map: form.map,
        position: results[0].geometry.location
    });
    form.map.setZoom(18);
    form.lat.value = marker.getPosition().lat();
    form.lng.value = marker.getPosition().lng();
    form.ofn.value = address;

  } else {
    alert('Geocode was not successful for the following reason: ' + status);
  }
}); 
```

}

可以使用地图的 setZoom 方法设置缩放（它已经在我的建议中实现）

演示：http: [**//jsfiddle.net/doktormolle/Tpgdd/**](http://jsfiddle.net/doktormolle/Tpgdd/)

# c# - Winform 工具提示问题

> ID：12977679
> 
> 赞同：0
> 
> 时间：2012-10-19T15:35:42.630
> 
> 标签：c#, winforms

在我的应用程序中，我想添加工具提示。配置工具提示后，我希望该选项区分激活工具提示的标签以显示适当的文本，因此在工具提示功能中我尝试这样做但出现错误：**“类型'Accessibility.IAccessible ' 在未引用的程序集中定义。您必须添加对程序集的引用 'Accessibility, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"**

```
private void toolTip1_Popup(object sender, PopupEventArgs e)
{
    string st = e.AssociatedControl.AccessibilityObject.Parent.Name;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:43:25.077

[来自 MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.accessibilityobject%28v=vs.100%29.aspx)

```
`To get or set the AccessibilityObject property, you must add a reference to the 
 Accessibility assembly installed with the .NET Framework` 
```

因此，您只需要使用项目引用添加此引用。

当然[PopupEventArgs](http://msdn.microsoft.com/en-us/library/system.windows.forms.popupeventargs.aspx)包含为其绘制工具提示的控件，因此您可以简单地使用`e.AssociatedControl.Name`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T16:08:14.187

您不需要引用 AccessibleObject。您只需要获取 AssociatedControl 的名称，如下所示：

```
private void toolTip1_Popup(object sender, PopupEventArgs e)
{
    string st = e.AssociatedControl.Name;
} 
```

至于您的子问题，要动态设置工具提示文本，您可以尝试以下操作：

```
 private bool recursing;
        private void toolTip1_Popup(object sender, PopupEventArgs e)
        {
            Control c = e.AssociatedControl as Control;
            if (c != null)
            {
                if (!recursing)
                {
                    recursing = true;
                    toolTip1.SetToolTip(c, "totototo");
                    recursing = false;
                }
            }
        } 
```

请注意，我们必须使用一个标志，因为调用 SetToolTip 将导致 PopUp 事件再次被触发

干杯

# c - 数学运算麻烦

> ID：12977680
> 
> 赞同：0
> 
> 时间：2012-10-19T15:35:44.313
> 
> 标签：c, cs50, vigenere

对某些人来说，这似乎是一个非常简单的解决方案，但我一直试图弄清楚它有一段时间了，它困扰着我。

```
int sum = (p[i] - 'A') + (s2[i % keyLen] - 'A');
 char c = 'A' + sum%26; 
```

我很难想出解决方案数学从来都不是我的强项。如果和的值`char c`最后应该等于 79 。`p[i]=72 or 'H'``s2[i]=5`

此操作非常有效，但我试图了解发生了什么，所以我尝试使用普通计算器进行操作并不断得出错误的答案。正确的操作顺序到底是什么？值应该是什么？

这是我到目前为止有效的完整源代码：

```
#include <stdio.h>
#include <cs50.h>
#include <string.h>
#include <ctype.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
    char s2[25];
    strcpy(s2, argv[1]);
    int keyLen = strlen(s2);
    printf("Please enter a string of text to be encrypted!\n");
    string p = GetString();
    for (int i = 0, n = strlen(p); i < n; i++)
    {
        if (isupper(p[i])){
        int sum = (p[i] - 'A') + (s2[i % keyLen] - 'A');
        char c = 'A' + sum%26;
        printf("%c", c);
        }
    }
    printf("\n");
    printf("%d\n", keyLen);

} 
```

我做这个操作的方式是：

```
int sum = (p[i] - 'A') + (s2[i % keyLen] - 'A');
//int sum = (72-65) + (72 % 5) - 65) sum= -56
char c = 'A' + sum%26;
//char c = 65 + -56 %26 char c = -8 
```

我显然知道我的数学是错误的，但我认为当我通过调试器运行操作时我做对了，`sum = 14`并且`char c = 79 or 'O'`应该这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:41:20.360

```
int sum = (p[i] - 'A') + (s2[i % keyLen] - 'A');
//int sum = (72-65) + (72 % 5) - 65) sum= -56 
```

你的误会就在这里。

**代码在做什么**

```
(s2[i % keyLen] - 'A') 
```

方法

```
(char_from_s2 - 'A') 
```

其中`char_from_s2`是 in `s2`at index`i % keyLen`中的字符，即位置处的字符`i`环绕以适合字符串的长度。

**你的计算显示了什么**

您的计算正在做一些不同的事情：

```
(char_from_p % keyLen) - 'A' 
```

您将字符 from`p`而不是 from `s2`，并将`%`运算符应用于字符值而不是索引。

# ruby - 如何在 Ruby 中解析 XML-RPC 格式的 XML？

> ID：12977681
> 
> 赞同：1
> 
> 时间：2012-10-19T15:35:44.080
> 
> 标签：ruby, xml, xml-parsing, xml-rpc

我需要在 Ruby 中解析一些 XML-RPC 格式的 XML。我无权访问 XML-RPC 服务，我只想将从此类服务返回的 XML 字符串转换为相应的 Ruby 对象（散列、数组、字符串等）。

我玩过内置 XMLRPC 的东西（在 Ruby 1.9.3 中），但我没有走得太远：

```
require 'xmlrpc/parser'
parser = XMLRPC::XMLParser::XMLParser.new 
```

这导致了这个异常：

```
LoadError: cannot load such file -- xmltreebuilder
from /Users/johannes/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
from /Users/johannes/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
from /Users/johannes/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/xmlrpc/parser.rb:620:in `initialize'
from (irb):2:in `new'
from (irb):2
from /Users/johannes/.rvm/rubies/ruby-1.9.3-p0/bin/irb:16:in `<main>' 
```

然后我尝试实例化不同的 XMLParser 子类，但都无济于事。

您对如何使其工作有任何指示吗？甚至可以在不使用带有内置库的 XMLRPC::Client 的情况下仅解析 RPC XML 吗？

谢谢！

**更新：**

这行得通，但它太丑了。这不可能是正确的：

```
require 'xmlrpc/client'
require "rexml/document"

xml = %{<answer>
<value>
<struct>
  <member><name>test</name><value><string>hello</string></value></member>
  <member><name>age</name><value><i4>12</i4></value></member>
  <member>
    <name>requirements</name>
    <value>
      <struct>
        <member>
          <name>confirmation</name>
          <value>
            <array>
              <data>
                <value><string>Bread</string></value>
                <value><string>Butter</string></value>
              </data>
            </array>
          </value>
        </member>
        <member>
          <name>document</name>
          <value>
            <array>
              <data>
                <value><string>Tic</string></value>
                <value><string>Tac</string></value>
                <value><string>Toe</string></value>
              </data>
            </array>
          </value>
        </member>
      </struct>
    </value>
  </member>
  <member><name>width</name><value><i4>10</i4></value></member>
  <member><name>height</name><value><i4>2</i4></value></member>
</struct>
</value>
</answer>}

parser = XMLRPC::XMLParser::REXMLStreamParser::StreamListener.new
parser.parse(xml)

puts "Value (accessor): '#{parser.value}'"
puts "Values (accessor): '#{parser.values}'"
puts "Value (instance_variable_get): '#{parser.instance_variable_get('@value')}'" 
```

一定会有更好的办法！

这是输出：

```
Value (accessor): ''
Values (accessor): ''
Value (instance_variable_get): '{"test"=>"hello", "age"=>12, "requirements"=>{"confirmation"=>["Bread", "Butter"], "document"=>["Tic", "Tac", "Toe"]}, "width"=>10, "height"=>2}' 
```

这让我的眼睛很痛。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T14:53:56.097

检查“nokogiri”宝石：

```
irb> require 'nokogiri'
irb> doc = Nokogiri::XML('<root><a>test</a></root>')
irb> puts (doc/'root/a').first.text # => 'test' 
```

或者

```
irb> puts doc.xpath('doc/root/a').first.text 
```

等等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-07T13:10:14.243

这个问题可能已经过时了，但它仍然是谷歌搜索“ruby parse xml rpc”时的热门话题。

使用 ruby​​ XMLRPC 字符串可以更容易地解析`XMLRPC::Marshal`

```
require 'xmlrpc/marshal'

def parse_xml_rpc(xml_string)
  parser = XMLRPC::Marshal.new
  parser.load_call(xml_string)
end 
```

上面的函数返回一个元组，其中首先包含函数的名称，然后是传递的参数数组。

```
str = "<?xml version=\"1.0\" ?><methodCall><methodName>function_name</methodName><params><param><value><string>arg1</string></value></param><param><value><boolean>1</boolean></value></param><param><value><double>27.5</double></value></param></params></methodCall>\n"

parse_xml_rpc(str)
=> ["function_name", ["arg1", true, 27.5]] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T09:11:02.400

这是我能找到的最接近解决方案的事情：

这行得通，但它太丑了。这不可能是正确的：

```
require 'xmlrpc/client'
require "rexml/document"

xml = %{<answer>
<value>
<struct>
  <member><name>test</name><value><string>hello</string></value></member>
  <member><name>age</name><value><i4>12</i4></value></member>
  <member>
    <name>requirements</name>
    <value>
      <struct>
        <member>
          <name>confirmation</name>
          <value>
            <array>
              <data>
                <value><string>Bread</string></value>
                <value><string>Butter</string></value>
              </data>
            </array>
          </value>
        </member>
        <member>
          <name>document</name>
          <value>
            <array>
              <data>
                <value><string>Tic</string></value>
                <value><string>Tac</string></value>
                <value><string>Toe</string></value>
              </data>
            </array>
          </value>
        </member>
      </struct>
    </value>
  </member>
  <member><name>width</name><value><i4>10</i4></value></member>
  <member><name>height</name><value><i4>2</i4></value></member>
</struct>
</value>
</answer>}

parser = XMLRPC::XMLParser::REXMLStreamParser::StreamListener.new
parser.parse(xml)

puts "Value (accessor): '#{parser.value}'"
puts "Values (accessor): '#{parser.values}'"
puts "Value (instance_variable_get): '#{parser.instance_variable_get('@value')}'" 
```

一定会有更好的办法！

这是输出：

```
Value (accessor): ''
Values (accessor): ''
Value (instance_variable_get): '{"test"=>"hello", "age"=>12, "requirements"=>{"confirmation"=>["Bread", "Butter"], "document"=>["Tic", "Tac", "Toe"]}, "width"=>10, "height"=>2}' 
```

这让我的眼睛很痛。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T00:39:57.380

与@mfojtik 一样，我打算推荐Nokogiri，因为它是一个出色的XML 解析器，但我通过谷歌搜索发现了[Rapuncel](https://rubygems.org/gems/rapuncel)。它是一个基于 Nokogiri 的 XML-RPC 客户端，专门用于发送/接收 XML-RPC 并对其进行解析。

不确定它是否已被维护，但可能值得一试。如果不是，您可以随时使用 Nokogiri 作为基础编写自己的代码，因为它看起来不太复杂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-22T14:30:02.280

*xmlrpc*库显然带有多个解析器，并且默认`XMLTreeParser`需要库*xmltreebuilder*（我不知道，它显然不是标准库的一部分）。但也许你可以尝试另一个解析器？使用`XMLRPC::XMLParser.each_installed_parser {|p| puts p.class}`您可以获得所有（可实例化的）解析器的列表。所以你可能会让其他人之一正常工作......

# kml - 本地文件对 KML 意味着什么？

> ID：12977683
> 
> 赞同：1
> 
> 时间：2012-10-19T15:35:57.730
> 
> 标签：kml, google-earth, google-earth-plugin

Google 地球的文档说我应该能够访问本地驱动器上的文件，但我找不到示例，当我尝试在本地驱动器上使用 KML 时，它似乎没有加载。我看到很多答案说它无法完成，但是为什么文档中另有说明呢？

**我的代码**

```
var href = 'http://code.google.com/'
                     + 'D:/visual studio 12/Projects/myMap/myMap/myPoints.Kml'; 
```

*例子*

> **网络链接**
> 
> 网络链接包含一个带有（超文本引用）加载文件的元素。可以是本地文件规范或绝对 URL。尽管名称如此，但 a 不一定从网络加载文件。链接中的 指定以下任何内容的位置： •图标样式、地面覆盖和屏幕覆盖中的图标使用的图像文件 •元素中使用的模型文件 •网络链接加载的 KML 或 KMZ 文件
> 
> 指定的文件可以是本地文件，也可以是远程服务器上的文件。在最简单的形式中，网络链接是一种有用的方法，可以在同一台计算机上将一个大型 KML 文件拆分为更小、更易于管理的文件。
> 
> 到目前为止，我们的所有示例都要求将 KML 代码从本地计算机传送到 Google 地球。网络链接使您能够从远程位置提供内容，并且通常用于将数据分发给大量用户。这样，如果需要修改数据，只需在源位置进行修改，所有用户都会自动收到更新后的数据。

我做了一些更改和测试，发现错误必须在我的 HTML 文件中，而不是在 KML 文件中。如果我单击 HTML 文件，我会得到与运行程序相同的结果。

我认为您运行 HTML 文件并且它应该调用 KML 是否正确？还是我只是调用 KML 来打开 GE？

这是我要运行的示例 HTML。

```
<!DOCTYPE html>
<html>
<head>
    <title>Sample</title>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>  
    <script type="text/javascript">
        var ge;
        google.load("earth", "1.x");

        function init() {
            google.earth.createInstance('map3d', initCB, failureCB);
        };

        function initCB(instance) {
            ge = instance;
            ge.getWindow().setVisibility(true);
            var href = 'https://dl.dropbox.com/u/61240296/myPoints.Kml';
            google.earth.fetchKml(ge, href, kmlFinishedLoading);
        };

        function kmlFinishedLoading(obj) {
            kmlObject = obj;
            if (kmlObject) {
                if ('getFeatures' in kmlObject) {
                    kmlObject.getFeatures().appendChild(placemark);
                }
                ge.getFeatures().appendChild(kmlObject);
                if (kmlObject.getAbstractView()) {
                    ge.getView().setAbstractView(kmlObject.getAbstractView());
                }
            }
        };

        function showHideKml() {
            kmlObject.setVisibility(!kmlObject.getVisibility());
        };

        function failureCB(errorCode){};

        google.setOnLoadCallback(init);
   </script>
</head>
<body>
    <div id="map3d" style="height: 320px; width: 679px;">
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-16T16:18:14.063

你误会了 的意思`local file specification`。如果您阅读文档，它实际上并没有说明“在您的计算机上”的文件。

> (sic) 可以是本地文件规范或绝对 URL

这意味着文件规范可以是相对的或绝对的 - 本地意味着相对于托管页面的域的本地，*而不是*您家庭计算机上的本地！

简单来说，假设我的网站位于（这将是您的示例 HTML）

`http://www.somesite.com/`

我还有一个 kml 文件，其中包含一个网络链接，位于

`http://www.somesite.com/kml/foo.kml`

最后一些图像位于

`http://www.somesite.com/images/`

示例 HTML 中的代码 - 可以使用*本地文件规范或绝对 URL*来引用文件。

即它可以使用

**当地的** `google.earth.fetchKml(ge, '/kml/foo.kml', ...`

**绝对**：`google.earth.fetchKml(ge, 'http://www.somesite.com/kml/foo.kml', ...`

此外，网络链接`foo.kml`也可以使用*本地文件规范或绝对 URL*来引用图像文件。

IE

**当地的** `<href>../images/pic.jpg</href>`

**绝对**：`<href>http://www.somesite.com/images/pic.jpg</href>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T16:22:51.437

你提到了，`Documentation for Google Earth`但你已经标记了谷歌地图、谷歌地图 API v3 的问题。Google Earth 是一个在您的本地计算机上运行的应用程序，可以访问您的本地硬盘驱动器，另外两个是基于 Web 的。

如果您使用的是 Google Maps API v3，则处理 KML 的本机对象是[KmlLayer](https://developers.google.com/maps/documentation/javascript/reference#KmlLayer)，该对象需要公开可用，以便 Google 的服务器可以检索并呈现它以在地图上显示。

# javascript - 以编程方式检索页面上的 javascript 错误计数

> ID：12977684
> 
> 赞同：1
> 
> 时间：2012-10-19T15:36:03.810
> 
> 标签：javascript, unit-testing, testing, selenium

我想编写一个测试用例（使用 Selenium，但不是这个问题的重点）来验证我的 Web 应用程序在某些时间点（例如在初始化主要库之后）没有脚本错误\警告或未处理的异常。

在大多数浏览器的调试控制台中可以很容易地看到这些信息。是否可以执行 javascript 语句以编程方式获取此信息？

如果每个浏览器都不一样也没关系，我可以处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:50:06.043

到目前为止还没有阅读您的问题（据我了解您的问题） [here](http://www.silverwareconsulting.com/index.cfm/2010/6/7/Checking-for-JavaScript-Errors-with-Selenium)

想法如下： *然而，我发现当页面第一次加载时我经常遇到 JavaScript 错误（因为我正在处理 JS 并且正在引入错误），所以我正在寻找一种快速的方法来添加一个断言我的测试检查是否发生任何 JS 错误。经过一番谷歌搜索后，我得出的结论是，Selenium 没有内置任何东西来支持这一点，但有许多黑客可以用来完成它。我将在这里描述其中之一。让我再次声明，为了记录，这很hacky。我很想听听其他可能有更好解决方案的人的意见。我只是在我的页面中添加了一个脚本，该脚本将通过拦截**window.onerror**事件来捕获任何 JS 错误：*

```
<script type="text/javascript">
    window.onerror=function(msg){
        $("body").attr("JSError",msg);
    }
</script> 
```

*如果发生 JavaScript 错误，这将导致一个名为 JSError 的属性与 JavaScript 错误消息对应的值被添加到我的文档的 body 标记中。请注意，我使用 jQuery 来执行此操作，因此如果 jQuery 无法加载，此特定示例将不起作用。然后，在我的 Selenium 测试中，我只使用`assertElementNotPresent`目标为`//body[@JSError]`. 现在，如果页面上出现任何 JavaScript 错误，我的测试将失败，我知道我必须先解决它们。如果出于某种奇怪的原因，我想检查特定的 JavaScript 错误，我可以使用带有目标的 assertElementPresent 命令`//body[@JSError='the error message']`。*

希望这个新鲜的想法可以帮助你:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:41:22.343

```
try {
    //code
} catch(exception) {
    //send ajax request: exception.message, exception.stack, etc.
} 
```

更多信息 - [MDN 文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/try...catch)

# wpf - 在显示 UI 中锁定网格

> ID：12977696
> 
> 赞同：1
> 
> 时间：2012-10-19T15:37:01.147
> 
> 标签：wpf, powershell, codeplex

任何人都可以帮助我如何在powershell的showui模块中锁定网格吗？

我正在创建一个使用网格的应用程序

Grid -ControlName 'Show-Demo' -Columns Auto,* -Rows 9 -MinHeight 500 -MaxHeight 500 -MinWidth 500 -MaxWidth 500 {

} -显示

当我运行这个时，我能够获得一个网格视图，但大小未锁定，我仍然能够用我的鼠标调整网格的大小，我想避免这种情况并将其永久锁定为 500 的 MAX 和 MIN 高度和宽度

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T05:38:27.620

网格已经是固定大小了。尝试`-Background Blue`在网格上设置然后调整大小，你会明白我的意思。

您想要的是使*Window*不可调整大小。为此，您必须实际指定窗口，而不是仅在网格上使用 -Show：

```
Window { 
    Grid -ControlName 'Show-Demo' -Columns Auto,* -Rows 9 {
       ...
    }
}  -MinHeight 500 -MaxHeight 500 -MinWidth 500 -MaxWidth 500 -Show 
```

# android - 前台服务未在引导时启动

> ID：12977699
> 
> 赞同：3
> 
> 时间：2012-10-19T15:37:03.783
> 
> 标签：android, service

我正在尝试在启动时启动前台服务，但它永远不会启动，但是如果我尝试启动正常的后台服务。它开始非常好。

你能告诉我我的代码有什么问题吗？

我的代码是：清单文件：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <receiver android:name="com.test.andsrvfg.AndSrvFgService">
        <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED" />
        </intent-filter>
    </receiver>
    <service android:name="AndSrvFgService">
        <intent-filter>
            <action android:name="com.test.andsrvfg.AndSrvFgService"></action>
        </intent-filter>
    </service>
</application> 
```

BroadcastReceiver 处理 ACTION_BOOT_COMPLETED：

```
public class AndSrvFgStarter extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) 
    {
        if (intent.getAction().equals(Intent.ACTION_BOOT_COMPLETED)) {
            Intent i = new Intent();
            i.setAction("com.test.andsrvfg.AndSrvFgService");
            context.startService(i);
        }
    }
} 
```

实际的服务是这样的：

```
public class AndSrvFgService extends Service {

    private boolean bForeground = false;
    public AndSrvFgService() {
    }

    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        if(!bForeground) {
            bForeground = true;
            Notification note = new Notification( 0, null, System.currentTimeMillis() );
            note.flags |= Notification.FLAG_NO_CLEAR;
            startForeground( 1242, note );      
                }

        return START_STICKY;
    }

    @Override
    public void onDestroy() {
        if(bForeground) {
            stopForeground(true);
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:58:57.093

这段代码对我有用：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.dfsdf"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name="com.google.ads.AdActivity"
              android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"/>

        <service android:name=".MyService"/>

        <receiver android:enabled="true" 
            android:name=".BootUpReceiver"
            android:permission="android.permission.RECEIVE_BOOT_COMPLETED">
            <intent-filter >
                <action android:name="android.intent.action.BOOT_COMPLETED"/>
                <category android:name="android.intent.category.DEFAULT"/>
            </intent-filter>
        </receiver>

    </application>

</manifest> 
```

*   把它放在接收器中：

    android:permission="android.permission.RECEIVE_BOOT_COMPLETED"

*   将启用设置为真：

    安卓：启用=“真”

# java - 如何与java日历同步时间

> ID：12977706
> 
> 赞同：-1
> 
> 时间：2012-10-19T15:37:26.297
> 
> 标签：java, calendar

我怎样才能同步时间（秒，小时）。我有这个

```
 int minuto = cal.get(Calendar.MINUTE);
  int day_Completed = 1440; 
```

但我不知道我该怎么做。

我试着这样做

在循环运行时更改 pc 时间以查看 var minuto 是否更改。但不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:43:42.097

一个日历实例静态地反映*一个*时刻。它不会自动更新，它的行为不像时钟。

如果你想与实际时间“同步”，那么你必须

1.  使用某种计时器，也许基于`Thread.sleep`开始
2.  在每个“计时器事件”上获取当前时间 ( `System.currentTimMillis()`) 和
3.  使用该值更新日历实例。

# .net - 可以覆盖对.Net 程序集的访问限制吗？

> ID：12977710
> 
> 赞同：1
> 
> 时间：2012-10-19T15:37:33.020
> 
> 标签：.net, reflection, assemblies, access-modifiers, il

我需要为 Metro 编译一个程序集，并基本上检查一些编译器生成的代码是否可以在常规控制台程序中运行（这应该很容易）。我的问题是编译器生成的代码将所有感兴趣的东西作为内部和/或私有（类和方法）发出。

有没有指定我的控制台程序就像一个超级朋友之类的？此外，丑陋的 hack 是可以接受的，这仅用于集成测试。这样做的最好方法是什么？我想到的唯一两种方法是大量反射或反汇编为 IL，使用一些非常复杂的正则表达式并用公共替换所有私有/内部成员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:03:57.417

> 有没有指定我的控制台程序就像一个超级朋友之类的？

您可以使用[`InternalsVisibleToAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)- 将其应用于“目标”程序集，引用控制台应用程序。这不会让您访问*私人*成员，但如果`internal`访问足够好应该没问题。

唯一需要立即注意的是，我不确定该属性是否适用于 Metro 程序集……但这当然值得一试。

# php - 数据库包含 #39 而不是 #039

> ID：12977716
> 
> 赞同：1
> 
> 时间：2012-10-19T15:38:02.550
> 
> 标签：php, mysql, codeigniter, invision-power-board

-- 系统是 MySQL、PHP、Apache 并且代码是围绕 Codeigniter 框架构建的

编辑清楚：我不存储数据，我正在尝试检索几年前存储的数据（严重的是作为转义数据）。在数据库中，名称 Fred' 存储为 Fred' 但是当我使用 htmlspecialcahrs 转换 Fred' 时，它会显示为 Fred'。我的问题是我需要做什么才能让 Fred' 转换为 Fred' 和任何其他等价物？

## 原始问题

我从另一个系统（确切地说是 Invision Power Board）继承了一个数据库。该站点现在使用 Codeigniter 进行自定义编码，但使用与旧 Invision Power Board 站点相同的成员数据库。

我现在发现了一个问题，如果用户的名字中有撇号，例如“Fred”，codeigniter 内置的 html_escape 函数（仅使用 htmlspecialchars）会将其转换为 Fred'

然而在数据库中，名称被保存为：Fred'，因此查找失败。

我不确定 Invision Power Board 在将字符串插入数据库之前对字符串做了什么，但有谁知道我如何确保将其转换为 ' 而不是 ' ？

简单地说做 str_replace 或更改数据库中的数据是没有用的，因为用户名中可能存在数百种可能性。快速搜索名称中带有 # 的用户（可能是一个特殊字符）会显示 440 个由于我们网站中的此错误而当前无法登录的用户。

编辑：修复了一些格式以删除“;” 所以它不只是显示一个撇号

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T16:15:27.027

在比较之前，您可以使用 preg_replace() 从 php 生成的字符串中删除 0：

```
$string = 'Fred&#039';

$string = preg_replace('/&#0+([1-9]+)/', '&#$1', $string);

var_dump(str_split($string));
// str_split to show real result 
```

# drupal - 在本地drupal网站上工作

> ID：12977717
> 
> 赞同：1
> 
> 时间：2012-10-19T15:38:15.747
> 
> 标签：drupal, deployment

我在外部服务器和本地 linux 机器上有网站。我更喜欢使用本地版本，因为它更快。

添加新模块并更改数据库内容（例如添加节点）后，我希望将这些更改上传到外部服务器。

但是如何不丢失实时用户添加的数据库更改（和站点/文件）？

我正在使用 drush rsync 和 sql-sync。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T03:38:11.640

使用[功能](http://drupal.org/project/features)模块为外部网站创建新的可导出功能，它们将显示为模块。例如，您可以创建一个包含新内容类型和视图的功能。您还可以导出角色、字段等。

使用[Strongarm](http://drupal.org/project/strongarm)模块导出系统变量和设置。您可以通过将节点和分类术语与[UUID 功能](http://drupal.org/project/uuid_features)模块或[默认内容](http://drupal.org/project/defaultcontent)模块的功能模块集成来导出它们。

# node.js - 我可以通过 socket.emit 发送多少数据？

> ID：12977719
> 
> 赞同：38
> 
> 时间：2012-10-19T15:38:16.327
> 
> 标签：node.js, socket.io

所以我使用的是 node.js 和 socket.io。我有一个小程序，它获取文本框的内容并将其发送到 node.js 服务器。然后，服务器将其转发回其他连接的客户端。有点像聊天服务，但不完全是。

无论如何，如果用户要输入 2-10k 的文本并尝试发送呢？我知道我可以自己尝试一下，但我正在寻找一个实用的最佳实践限制，以限制我可以通过发射处理多少数据。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-10-19T16:38:50.797

从 v3 开始，socket.io 的默认消息限制为 1 MB。如果消息大于该值，则连接将被终止。

您可以通过指定[`maxHttpBufferSize`选项](https://socket.io/docs/v4/server-options/#maxhttpbuffersize)来更改此默认值，但请考虑以下内容（最初是十多年前编写的，但仍然相关）：

Node~~和 socket.io~~没有任何内置限制。您确实需要担心的是消息大小、每秒发送的消息数量、连接的客户端数量以及服务器可用带宽之间的关系——换句话说，没有简单的答案。

让我们考虑一个 10 kB 的消息。当有 10 个客户端连接时，您的服务器必须推送 100 kB 的数据，这是完全合理的。添加更多客户端，要求很快就会变得更高：10 kB * 5,000 个客户端 = 50 MB。

当然，您还必须考虑协议开销的数量：每个数据包，TCP 增加约 20 个字节，IP 增加 20 个字节，以太网增加 14 个字节，总共 54 个字节。假设 MTU 为 1500 字节，您将查看每个客户端 8 个数据包（不考虑重传）。这意味着您将通过网络向每个客户端发送 8*54=432 字节的开销 + 10 kB 有效负载 = 10,672 字节。

10.4 kB * 5000 个客户端 = 50.8 MB。

在 100 Mbps 链路上，*如果*您能够使链路饱和，则*理论上至少*需要 4.3 秒才能将 10 kB 消息传递给 5,000 个客户端。当然，在丢包和损坏数据需要重新传输的现实世界中，这将需要更长的时间。

 *即使非常保守的估计是 8 秒向 5,000 个客户发送 10 kB，这在每 10-20 秒收到一条消息的聊天室中也可能没问题。

所以真的，它归结为几个问题，按重要性排序：

1.  您的服务器将有多少带宽可用？
2.  将同时连接多少用户？
3.  每分钟将发送多少条消息？

回答完这些问题后，您可以确定您的基础架构将支持的最大消息大小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:40:37.070

2-10k 很好，没有任何强制限制或任何东西，它只是归结为带宽和实用性.. 10k 虽然在宏伟的计划中很小，所以如果这对你来说有点上限，你应该没问题.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-01-05T20:11:56.493

**限制 = 1M**（*默认*）

使用此示例配置为**maxHttpBufferSize**指定自定义限制：

```
const io = require("socket.io")(server, {
    maxHttpBufferSize: 1e8, pingTimeout: 60000
}); 
```

*   **1e8** = 100,000,000 ：这对任何大规模响应/发射都有好处
*   **pingTimeout**：当发射很大时，它需要时间，你也需要增加 pingtime

阅读更多来自[Socket.IO 文档](https://socket.io/docs/v4/troubleshooting-connection-issues/#you-are-trying-to-send-a-huge-payload)

> **在**这些设置之后，如果您的问题仍然存在，那么您可以检查相关的**代理 Web 服务器**配置，例如*nginx*中的 *client_max_body_size*（如果您有与 socketIO 应用程序相关的 http 代理）或客户端/服务器**防火墙**规则。*

# sql - 类型转换日期时间差异

> ID：12977720
> 
> 赞同：1
> 
> 时间：2012-10-19T15:38:18.787
> 
> 标签：sql, sql-server, oracle, firebird

我们使用 firebird 作为本地测试数据库，我们的大多数客户使用 SQL Server 或 Oracle。

这适用于 MS SQL Server，但不适用于 Firebird。（还没有在 Oracle 上测试过）

```
CONVERT(char(8),MAX(p.end_Time)-MIN (p.start_Time),8) as duration 
```

有没有办法为（Firebird、Oracle 和 MS Sql Server）完成同样的事情？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:36:45.680

在 Oracle（Oracle 8i、Oracle 9i、Oracle 10g、Oracle 11g）上，您可以使用 to_char 函数：

```
 select to_char( value, [ format_mask ], [ nls_language ] ) .... 
```

例子：

```
 SELECT TO_CHAR ( SYSDATE - TO_DATE ( '18-10-2012', 'dd-mm-yyyy' ), '9,999.99' ) as duration FROM   DUAL; 
```

这是[Oracle/PLSQL 的链接：To_Char 函数](http://www.techonthenet.com/oracle/functions/to_char.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:49:44.267

firebird 上没有 CONVERT。

使用 CAST：

`select cast(MAX(p.end_Time) as varchar(50))`等等...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T16:18:52.350

对于 Firebird，您需要使用[`DATEDIFF`](http://www.firebirdsql.org/file/documentation/reference_manuals/reference_material/html/langrefupd25-intfunc-datediff.html)来获取两个时间戳（日期时间）之间的差异。这个 BTW 类似于[SQL Server`DATEDIFF`](http://msdn.microsoft.com/en-us/library/ms189794.aspx)。如果你想把它转换成char，你可以使用[`CAST`](http://www.firebirdsql.org/file/documentation/reference_manuals/reference_material/html/langrefupd25-intfunc-cast.html)，例如`CAST(DATEDIFF(DAY, MAX(p.end_Time), MIN(p.start_Time)) AS CHAR(8))`应该做的伎俩（或者你可以简单地做`CAST(MAX(p.end_Time) - MIN (p.start_Time) AS CHAR(8))`，因为时间戳是可减去的。

我只是注意到您在您的选项中指定的选项`CONVERT`将转换为`hh:mi:ss`. Firebird 中没有这样的选项。如果您需要专门转换为`hh:mi:ss`，您可能需要查看诸如[FreeAdhocUDF](http://freeadhocudf.org/documentation_english/dok_eng_datum.html#umwandeln)（特别是`F_SECONDS2PERIOD`）或[rFunc UDF 之](http://rfunc.sourceforge.net/rfunc.htm)类的 UDF 库。如果一切都失败了，您可以编写自己的 UDF。

# sql - 来自现有列表的 SQL 查询

> ID：12977728
> 
> 赞同：1
> 
> 时间：2012-10-19T15:38:45.063
> 
> 标签：sql

Sql newb 所以我试图解决这个问题：

我提取购买特定商品的客户名称列表：

```
select r.name
from records r
where r.item_purchased='apple' 
```

现在我想获取客户列表并提取他们购买的所有物品的记录，但我无法克服错误。我试过这样的事情：

```
with customer_list as
(above)
select r.*
from records r
where r.name=customer_list 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:06:09.100

如果您确实想使用 CTE，这应该可以：

```
with customer_list as
(
  select r.name
  from records r
  where r.item_purchased='apple'
)
select r.*
from records r
where r.name in (select name from customer_list) 
```

这与 JOIN（例如 Michael 的解决方案）之间的区别在于，如果同一客户多次购买苹果，则该连接将产生不同的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:41:08.620

我相信自我加入应该可以解决您的问题：

```
select distinct r2.*
from records r
join records r2
    on r2.name = r.name
where r.item_purchased='apple' 
```

编辑：添加了一个`DISTINCT`基于@a_horse_with_no_name 对结果差异的洞察，因为我怀疑由自连接引起的重复是否是预期的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:41:54.963

```
Select * from records where name in (
                       select name
                         from records 
                        where item_purchased='apple'
) 
```

# ios - 当前位置的更新状态-iOS

> ID：12977731
> 
> 赞同：0
> 
> 时间：2012-10-19T15:38:52.317
> 
> 标签：ios, ios5, ios6

如何在图标的右上角获得这个小缩略图状态？

![Fahreneit 应用如下图所示](../Images/c6b8f404ea545b7f79686abd209625bd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:48:20.663

您可以使用该`setApplicationIconBadgeNumber:`方法将徽章设置为您想要的任何数字。此消息应发送到 的实例`UIApplication`。要获取当前应用程序，您只需调用`[UIApplication sharedApplication]`.

您的代码如下所示：

```
int number = 25; //set this to any number you want

[[UIApplication sharedApplication] setApplicationIconBadgeNumber:number]; 
```

或者，您显然可以立即设置它，而无需额外的变量，如下所示：

```
[[UIApplication sharedApplication] setApplicationIconBadgeNumber:25]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:43:29.473

使用应用程序徽章进行设置。

```
[[UIApplication sharedApplication] setApplicationIconBadgeNumber:68]; 
```

如需更多参考，请参阅[此](http://mobiledevelopertips.com/user-interface/using-application-badges.html)

另请参阅[UIApplication 文档](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instp/UIApplication/applicationIconBadgeNumber)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:47:42.627

徽章见

[http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instp/UIApplication/applicationIconBadgeNumber](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instp/UIApplication/applicationIconBadgeNumber)或使用

```
[[UIApplication sharedApplication] setApplicationIconBadgeNumber:68]; 
```

对于**新**图标，当您下载新应用程序并且尚未打开它时，您无法做到这一点。

# macos - FireMonkey/Rad Studio XE2：如何在 OS X 上显示 SaveDialog 过滤器？

> ID：12977734
> 
> 赞同：8
> 
> 时间：2012-10-19T15:39:16.870
> 
> 标签：macos, delphi, delphi-xe2, firemonkey

我创建了一个（Delphi XE2）Firemonkey 示例程序，其中包含一个 TButton 和一个带有两个不同过滤器的 TSavedialog。（TSaveDialog 组件支持 Win32/Win64 和 OS X 平台。）

它在 Win32/Win64 上运行良好，但我现在不明白为什么它在 OS X（VirtualBox/OS X 10.7.x）上不显示 Savedialog 过滤器。

我怎样才能让它在 OS X 上工作？

```
procedure TForm1.Button_SaveClick(Sender: TObject);
begin
  SaveDialog.Filter:='Format_1 (*.fmt1)|*.fmt1|Format_2 (*.fmt2)|*.fmt2';

  If Savedialog.Execute Then ShowMessage(SaveDialog.FileName+#13+'Selected filterindex: '+Inttostr(SaveDialog.FilterIndex));
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T10:35:21.320

保存对话框不是在 Delphi 中构建的，而是调用本机 MAC OSX 对话框（NSSavePanel）。这没有用户可选择的过滤器。

当您执行保存对话框时，Delphi 将过滤器作为数组传递给 NSSavePanel.SetAllowedFileTypes，它决定 OSX 对话框允许用户指定的扩展名 - 但没有可选列表。

要允许用户从列表中进行选择，您需要创建自己的文件类型选择对话框，然后将该选择作为默认文件类型和唯一过滤器项传递给保存对话框。

创建一个全新的 fileSave 对话框的替代方法并不容易，因为 Firemonkey 树组件似乎坚持扩展其所有节点，因此会完整遍历硬盘驱动器上的所有文件。在任何情况下，MAC 用户都会熟悉标准对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-18T23:29:38.620

我在 MAC OSX 中遇到了与 TOpendialog 相同的问题：过滤器不起作用，但在 Windows 中它们起作用。现在我解决了这个问题，也许你可以使用代码来解决你的问题。那些不在 Windows 中显示的文件在 MAC OSX 下被禁用，您无法选择它们。

```
uses
  Macapi.Foundation, Macapi.ObjectiveC, Macapi.AppKit;

 {$IFDEF MACOS}

  function AllocFilterStr(const S: string; var Filter: NSArray): Boolean;
  var
    input, pattern: string;
    FileTypes: array of string;
    outcome, aux: TArray<string>;
    i, j: Integer;
    FileTypesNS: array of Pointer;
    NStr: NSString;
    LocObj: ILocalObject;
  begin
    // First, split the string by using '|' as a separator
    Result := false;
    input := S;
    pattern := '\|';

    outcome := TRegEx.Split(input, pattern);
    pattern := '\*\.';
    SetLength(FileTypes, 0);

    for i := 0 to length(outcome) - 1 do
    begin
      if Odd(i) then
        if outcome[i] <> '*.*' then
          if AnsiLeftStr(outcome[i], 2) = '*.' then
          begin
            aux := TRegEx.Split(outcome[i], pattern);
            for j := 0 to length(aux) - 1 do
            begin
              aux[j] := Trim(aux[j]);
              if aux[j] <> '' then
              begin
                if AnsiEndsStr(';', aux[j]) then
                  aux[j] := AnsiLeftStr(aux[j], length(aux[j]) - 1);
                SetLength(FileTypes, length(FileTypes) + 1);
                FileTypes[length(FileTypes) - 1] := aux[j];
              end;
            end;
          end;
    end;

    // create the NSArray from the FileTypes array
    SetLength(FileTypesNS, length(FileTypes));
    for i := 0 to length(FileTypes) - 1 do
    begin
      NStr := NSSTR(FileTypes[i]);
      if Supports(NStr, ILocalObject, LocObj) then
        FileTypesNS[i] := LocObj.GetObjectID;
    end;
    if length(FileTypes) > 0 then begin
      Filter := TNSArray.Wrap(TNSArray.OCClass.arrayWithObjects(@FileTypesNS[0], length(FileTypes)));
      result := true;
    end;
  end;

function CFToDelphiString(const CFStr: CFStringRef): string;
var
  Range: CFRange;
begin
  Range.location := 0;
  Range.length := CFStringGetLength(CFStr);
  SetLength(Result, Range.length);
  if Range.length = 0 then Exit;
  CFStringGetCharacters(CFStr, Range, PWideChar(Result));
end;

function NSToDelphiString(const NSStr: NSString): string; inline;
begin
  Result := CFToDelphiString((NSStr as ILocalObject).GetObjectID);
end;

  {$ENDIF}

procedure TMainform.LoadClick(Sender: TObject);
 {$IFDEF MACOS}
var
  Filter: NSArray;
  LOpenDir: NSOpenPanel;
  {$ENDIF}
begin

  {$IFDEF MSWINDOWS}
  Opendialog1.Filter:= '*.fcb|*.fcb';
  if Opendialog1.execute then
  begin
    case Opendialog1.Filterindex of
      1:  LoadPlaylist(Opendialog1.filename, false, false);
      2:  LoadPlaylist(Opendialog1.filename, false, true);
    end;
  end;
  {$ENDIF}

 {$IFDEF MACOS}
  LOpenDir := TNSOpenPanel.Wrap(TNSOpenPanel.OCClass.openPanel);
  if AllocFilterStr('*.fcb|*.fcb', Filter) then
  if LOpenDir.runModalForTypes(Filter)=1 then
    LoadPlaylist(NSToDelphiString(LOpenDir.filename), false, false);
  {$ENDIF}
end; 
```

# iphone - 选择器值在部分中所有行的文本字段中重复？

> ID：12977736
> 
> 赞同：0
> 
> 时间：2012-10-19T15:39:36.513
> 
> 标签：iphone, objective-c, ios, xcode, uipickerview

![在此处输入图像描述](../Images/ee6874c8fa84ef1400fddbcb258a06a8.png)

我正在为自定义单元格中的 2 个文本字段使用选择器。在为一个字段选择选择器值时，它会重复一个部分中的所有行。我正在使用以下代码。我正在为该文本字段的自定义按钮操作设置选择器。

```
int pickerMoved=0;

-(IBAction)genderpickerbtnpressed:(id)sender {
    NSLog(@"genderpickerbtnpressed called ");
    UIActionSheet *asheet = [[UIActionSheet alloc] initWithTitle:@"Select your gender"
                                                        delegate:self
                                               cancelButtonTitle:@"Cancel"
                                          destructiveButtonTitle:nil
                                               otherButtonTitles:@"Select", nil];

    [asheet setTag:200];

    UIPickerView *statePicker = [[UIPickerView alloc] initWithFrame:CGRectMake(0, 40, 0, 0)];
    statePicker.delegate=self;

    statePicker.showsSelectionIndicator = YES;
    [statePicker setTag:11];
    [asheet addSubview:statePicker];
    [asheet showInView:[self.view superview]];
    [asheet setBounds:CGRectMake(0,0,320, 700)];
    [asheet setFrame:CGRectMake(0, 117, 320, 383)];
}

- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {

    if (buttonIndex != [actionSheet cancelButtonIndex]) {

        if(actionSheet.tag==200) {

            if(buttonIndex==0) {

                if(pickerMoved>0) {
                    NSLog(@"selected item is %d",pickerMoved);
                    NSLog(@"selected data is %@",[self.genderarray objectAtIndex:pickerMoved] );

                    self.savingsStr=[self.genderarray objectAtIndex:pickerMoved];
                } else {

                    NSLog(@"distanceArray object at index %@",[self.genderarray objectAtIndex:0]);
                    self.savingsStr=[self.genderarray objectAtIndex:0];
                }

            }
        }
        pickerMoved=0;
        [self.tripView reloadData];
    }

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    MyTripViewCell *cell = (MyTripViewCell *) [tableView dequeueReusableCellWithIdentifier:@"acell"];

    if (cell == nil) {
        cell = [[[NSBundle mainBundle] loadNibNamed:@"MyTripViewCell" owner:self options:nil] objectAtIndex:0];

        cell=Tblcell;
    }

    if(indexPath.section == 0) {

        Passenger *temp = [appDelegate.ADULTS objectAtIndex:indexPath.row];

        NSLog(@"adults array count is %d",[appDelegate.ADULTS count]);
        cell.textfield.text = temp.name;

        cell.gendertextfield.text = self.savingsStr;
        cell.dobtextfield.text =self.datepickerstr;
        cell.gendertextfield.tag=indexPath.row;

        [savingsStr release];
        NSLog(@"temp.gender is ----- %@",temp.gender);

    }
    cell.selectionStyle=UITableViewCellSelectionStyleNone;

    return cell;
} 
```

成人部分中性别文本字段的值重复。如何将选取器值复制到单元格。任何想法与我分享。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T17:04:57.613

在你的`cellForRow`方法中，你有

```
if(indexPath.section == 0) 
```

我认为应该是

```
if(indexPath.row == 0) 
```

这样它只填充第一行，如果你想填充第一部分的第一行，你需要同时使用这两个条件。

# c++ - MacOSX 上的 Qt Creator 或 qmake 将库构建为“.so”而不是 dylib

> ID：12977739
> 
> 赞同：3
> 
> 时间：2012-10-19T15:39:40.893
> 
> 标签：c++, macos, qt, qt-creator, qmake

我需要在 Mac 上将我的插件/库构建为 .so。这在 Linux 上不需要额外的技巧就可以发生，并且就像一个魅力。

我需要向我的 .pro 文件添加哪些额外选项？

```
CONFIG += debug
QT += xml
TEMPLATE = lib
TARGET = mylib
DEPENDPATH += .
macx:INCLUDEPATH += ../../../Test \
  /usr/local/include/

macx:LIBS += -L../../../Test/lib

DEFINES += CORE_EXPORT=
DEFINES += GUI_EXPORT=

HEADERS += test.h testGui.h
FORMS += testGui.ui
SOURCES += test.cpp testGui.cpp
RESOURCES += test.qrc 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T17:55:30.807

“.so”后缀在 OS X 上没有任何意义。在像 Linux 这样的 ELF 平台上，“*.so”文件是一个共享库。在 OS X 上，共享库具有“.dylib”扩展名。在 Linux 上，插件被实现为共享库 (*.so)，因为您可以在使用完它们后再次卸载它们。在 OS X 上，无法卸载共享库。这使得它们不适合插件。

在 OS X 上，您使用包而不是共享库来实现插件。上次我看的时候，qmake 不直接支持这个。但是您可以修改链接器标志以构建捆绑包。默认情况下，qmake 使用“-dynamiclib”链接器标志，它构建 *.dylib。相反，您应该使用构建捆绑包的“-bundle”标志。你可以试试这个：

```
CONFIG += plugin
QMAKE_LFLAGS_PLUGIN -= -dynamiclib
QMAKE_LFLAGS_PLUGIN += -bundle 
```

捆绑包的文件扩展名未标准化。你可以使用任何你想要的东西（.so、.dylib、.plugin、.donald_duck，...）Apple 推荐“.bundle”，但不强制执行。要控制创建包的文件名，您可以设置`QMAKE_EXTENSION_SHLIB`和`QMAKE_PREFIX_SHLIB`。例如，要获取`mylib.bundle`，设置：

```
QMAKE_EXTENSION_SHLIB = bundle
QMAKE_PREFIX_SHLIB = 
```

相反，如果您想获取`libmylib.so`，只需设置：

```
QMAKE_PREFIX_SHLIB = so 
```

顾名思义，`QMAKE_EXTENSION_SHLIB`包含文件扩展名（不带`.`），并`QMAKE_PREFIX_SHLIB`包含文件前缀（默认为`lib`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:50:43.530

您可能需要将 -dynamiclibs 行放在 bundle... 之后对我有用。

在这里找到：

[http://jonmacey.blogspot.com/2012/03/using-maya-api-with-qt-creator.html](http://jonmacey.blogspot.com/2012/03/using-maya-api-with-qt-creator.html)

# c# - ASP Web Api - IoC - 解析 HttpRequestMessage

> ID：12977743
> 
> 赞同：10
> 
> 时间：2012-10-19T15:39:52.457
> 
> 标签：c#, asp.net-web-api, inversion-of-control, castle-windsor, hyprlinkr

我正在尝试使用 ASP.NET WebAPI 设置 Castle Windsor。

我也在使用 Hyprlinkr 包（[https://github.com/ploeh/Hyprlinkr](https://github.com/ploeh/Hyprlinkr)），因此需要将一个 HttpRequestMessage 实例注入到我的控制器的依赖项之一中。

我正在关注 Mark Seemann 的这篇文章 - [http://blog.ploeh.dk/2012/04/19/WiringHttpControllerContextWithCastleWindsor.aspx](http://blog.ploeh.dk/2012/04/19/WiringHttpControllerContextWithCastleWindsor.aspx)，但我发现虽然 API 运行，但当我调用它时，请求只是挂起。没有错误信息。就好像它处于一个无限循环中。它挂在我的自定义 ControllerActivator 中对 Resolve 的调用

我在想我的一些城堡注册错误。如果我删除了上面文章中提到的那些，那么我可以成功调用 API（尽管没有我需要解决的依赖关系）

有任何想法吗？

代码如下

```
//Global.asax
public class WebApiApplication : HttpApplication
{
    private readonly IWindsorContainer container;

    public WebApiApplication()
    {
        container = 
            new WindsorContainer(
                new DefaultKernel(
                    new InlineDependenciesPropagatingDependencyResolver(), 
                    new DefaultProxyFactory()), 
                new DefaultComponentInstaller());

        container.Install(new DependencyInstaller());
    }

    protected void Application_Start()
    {        
        GlobalConfiguration.Configuration.Services.Replace(typeof(IHttpControllerActivator), new WindsorCompositionRoot(this.container));
    }

// installer
public class DependencyInstaller : IWindsorInstaller
{
    public void Install(IWindsorContainer container, IConfigurationStore store)
    {
        container.AddFacility<TypedFactoryFacility>();

        container.Register(
            Component.For<ValuesController>()
                .Named("ValuesController")
                .LifeStyle.PerWebRequest,

            Component.For<IResourceLinker>()
                .ImplementedBy<RouteLinker>()
                .LifeStyle.PerWebRequest,

            Component.For<IResourceModelBuilder>()
                .ImplementedBy<ResourceModelBuilder>()
                .LifeStyle.PerWebRequest,

                Component.For<HttpRequestMessage>()
                .Named("HttpRequestMessage")
                .LifeStyle.PerWebRequest
            );
    }
}

//Activator

public class WindsorCompositionRoot : IHttpControllerActivator
{
    private readonly IWindsorContainer container;

    public WindsorCompositionRoot(IWindsorContainer container)
    {
        this.container = container;
    }

    public IHttpController Create(
        HttpRequestMessage request,
        HttpControllerDescriptor controllerDescriptor,
        Type controllerType)
    {
        var controller = (IHttpController)this.container.Resolve(controllerType, new { request = request });

        request.RegisterForDispose(
            new Release(
                () => this.container.Release(controller)));

        return controller;
    }

// DependencyResolver   
public class InlineDependenciesPropagatingDependencyResolver : DefaultDependencyResolver
{
    protected override CreationContext RebuildContextForParameter(CreationContext current, Type parameterType)
    {
        if (parameterType.ContainsGenericParameters)
        {
            return current;
        }

        return new CreationContext(parameterType, current, true);
    }
} 
```

编辑****************附加信息****************

所以我设置了一个场景，控制器只将 HttpRequestMessage 作为 ctor 参数并发现：

这有效：

```
//controller
public class ValuesController : ApiController
    {
        private readonly HttpRequestMessage _httpReq;

        public ValuesController(HttpRequestMessage httpReq)
        {
            _httpReq = httpReq;
        }
//IHttpControllerActivator
public IHttpController Create(
            HttpRequestMessage httpRequest,
            HttpControllerDescriptor controllerDescriptor,
            Type controllerType)
        {

            var controller = (IHttpController)this.container.Resolve(
                controllerType, new { httpReq = httpRequest });

            return controller; 
```

但是，这不是。

```
//controller
public class ValuesController : ApiController
    {
        private readonly HttpRequestMessage _httpReq;

        public ValuesController(HttpRequestMessage request)
        {
            _httpReq = request;
        }

//IHttpControllerActivator
public IHttpController Create(
            HttpRequestMessage request,
            HttpControllerDescriptor controllerDescriptor,
            Type controllerType)
        {

            var controller = (IHttpController)this.container.Resolve(
                controllerType, new { request = request });

            return controller; 
```

即当匿名对象具有称为“请求”的属性并且控制器ctor arg称为“请求”时。它以某种方式使控制器认为它的请求属性为空。这就是导致我看到的错误的原因：

> 无法重用“ApiController”实例。'ApiController' 必须为每个传入消息构建。检查您的自定义“IHttpControllerActivator”并确保它不会制造相同的实例。
> 
> 在 System.Web.Http.ApiController.ExecuteAsync(HttpControllerContext controllerContext, CancellationToken cancelToken) 在 System.Web.Http.Dispatcher.HttpControllerDispatcher.SendAsyncInternal(HttpRequestMessage 请求, CancellationToken cancelToken) 在 System.Web.Http.Dispatcher.HttpControllerDispatcher.SendAsync(HttpRequestMessage请求，CancellationToken 取消令牌）

阅读此内容 [如何在不调用 setter 注入的情况下丰富 StructureMap 中的对象组合？](https://stackoverflow.com/questions/12646657/how-can-i-enrich-object-composition-in-structuremap-without-invoking-setter-inje)

它解释了一个类似的场景。

当然，hyprlinkr 的 HttpRequestMessage 的 ctor arg 称为“request”，所以我确实需要使用该属性名称指定 anon 对象。

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-23T00:06:24.480

这是一个适合我的组合根：

```
public class WindsorCompositionRoot : IHttpControllerActivator
{
    private readonly IWindsorContainer container;

    public WindsorCompositionRoot(IWindsorContainer container)
    {
        this.container = container;
    }

    public IHttpController Create(
        HttpRequestMessage request,
        HttpControllerDescriptor controllerDescriptor,
        Type controllerType)
    {
        var controller = (IHttpController)this.container.Resolve(
            controllerType,
            new
            {
                request = request
            });

        request.RegisterForDispose(
            new Release(
                () => this.container.Release(controller)));
        return controller;
    }

    private class Release : IDisposable
    {
        private readonly Action release;

        public Release(Action release)
        {
            this.release = release;
        }

        public void Dispose()
        {
            this.release();
        }
    }
} 
```

这是我创建容器的方式：

```
this.container =
    new WindsorContainer(
        new DefaultKernel(
            new InlineDependenciesPropagatingDependencyResolver(),
            new DefaultProxyFactory()),
        new DefaultComponentInstaller())
        .Install(new MyWindsorInstaller()); 
```

这是 InlineDependenciesPropagatingDependencyResolver：

```
public class InlineDependenciesPropagatingDependencyResolver : 
    DefaultDependencyResolver
{
    protected override CreationContext RebuildContextForParameter(
        CreationContext current,
        Type parameterType)
    {
        if (parameterType.ContainsGenericParameters)
        {
            return current;
        }

        return new CreationContext(parameterType, current, true);
    }
} 
```

最后，这是我注册 RouteLinker 的方法：

```
container.Register(Component
    .For<RouteLinker, IResourceLinker>()
    .LifestyleTransient()); 
```

* * *

需要注意的一件事是 ApiController 基类有一个名为`Request`HttpRequestMessage 类型的公共属性。正如[我的书](http://affiliate.manning.com/idevaffiliate.php?id=1150_236)Windsor 的第 10.4.3 节中所解释的，如果每个可写属性具有匹配的组件，它将尝试为其分配一个值——并且该匹配不区分大小写。

当您将名为 HttpRequestMessage 的名称传递`request`给 Resolve 方法时，这正是发生的情况，因此您需要告诉 Castle Windsor 它应该放弃对 ApiControllers 的属性注入。以下是我在基于约定的注册中的做法：

```
container.Register(Classes
    .FromThisAssembly()
    .BasedOn<IHttpController>()
    .ConfigureFor<ApiController>(c => c.Properties(pi => false))
    .LifestyleTransient()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T06:05:11.720

为什么不在 ASP.NET Web API 中使用已经内置的机制 - 依赖解析器

[http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver](http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver)

在项目 WebApiContrib 中有 CastleWindsor 解析器实现，但正如我在依赖解析器中看到的那样

[https://github.com/WebApiContrib/WebApiContrib.IoC.CastleWindsor](https://github.com/WebApiContrib/WebApiContrib.IoC.CastleWindsor)

正如马克在评论中所说 - 实现 IHttpControllerActivator 的方法之一

[http://blog.ploeh.dk/2012/10/03/DependencyInjectionInASPNETWebAPIWithCastleWindsor.aspx](http://blog.ploeh.dk/2012/10/03/DependencyInjectionInASPNETWebAPIWithCastleWindsor.aspx)

# c# - Double.ToString() 何时以科学计数法返回值？

> ID：12977746
> 
> 赞同：8
> 
> 时间：2012-10-19T15:40:02.313
> 
> 标签：c#

我认为它与前导零或尾随零的数量有关，但我在 msdn 中找不到任何可以给我具体答案的东西。

什么时候`Double.ToString(CultureInfo.InvariantCulture)`开始以科学计数法返回值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T15:47:56.310

从文档中可以看出，将选择表示数字的最紧凑的形式。

即，当您不指定格式字符串时，[默认为“G”格式字符串](http://msdn.microsoft.com/en-us/library/3hfd35ad.aspx)。从[G 格式字符串的规范](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)如下：

> 结果：最紧凑的定点或科学记数法。

[带有说明符的位数](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx#GFormatString)的默认值是 15。这意味着一个可以*精确*表示为某种二进制表示的数字（如哈里约特示例中的 0.1）将显示为定点，除非指数表示法更紧凑。

当有更多数字时，默认情况下会显示所有这些数字（最多 15 个），并在较短的时候选择指数符号。

把它放在一起：

```
?(1.0/7.0).ToString()
"0,142857142857143"      // 15 digits
?(10000000000.0/7.0).ToString()
"1428571428,57143"       // 15 significant digits, E-notation not shorter
?(100000000000000000.0/7.0).ToString()
"1,42857142857143E+16"   // 15 sign. digits, above range for non-E-notation (15)
?(0.001/7.0).ToString()
"0,000142857142857143"   // non E-notation is shorter
?(0.0001/7.0).ToString()
"1,42857142857143E-05"   // E-notation shorter 
```

而且，有趣的是：

```
?(1.0/2.0).ToString()  
"0,5"                    // exact representation
?(1.0/5.0).ToString()
"0,2"                    // rounded, zeroes removed
?(1.0/2.0).ToString("G20")
"0,5"                    // exact representation
?(1.0/5.0).ToString("G20")
"0,20000000000000001"    // unrounded 
```

这是为了显示幕后发生的事情以及为什么`0.2`写为`0.2`, not `0,20000000000000001`，实际上是。默认情况下，显示 15 位有效数字。当有更多数字时（并且总是有，除了某些特殊数字），这些数字以正常方式四舍五入。舍入后，去除多余的零。

请注意，double 的精度为 15 位或 16 位，具体取决于数字。因此，通过显示 15 位数字，您看到的是正确四舍五入的数字，并且**始终是完整的表示，并且是 double 的最短表示**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-19T15:50:14.827

从文档中[`Double.ToString(IFormatProvider)`](http://msdn.microsoft.com/en-us/library/shxtf045.aspx)：

> 此实例使用通用数字格式说明符 ("G") 进行格式化。

[来自通用数字格式](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx#GFormatString)说明符的文档：

> 如果以科学记数法表示数字所产生的指数大于 -5 且小于精度说明符，则使用定点记数法；否则，使用科学计数法。如果需要，结果包含一个小数点，小数点后的尾随零被省略。如果存在精度说明符并且结果中的有效位数超过指定的精度，则通过舍入去除多余的尾随数字。
> 
> 但是，如果数字是 Decimal 并且省略了精度说明符，则始终使用定点表示法并保留尾随零。

的默认精度说明符`Double`记录为 15。

虽然在表的前面，但措辞略有不同：

> 结果：最紧凑的定点或科学记数法。

我还没有弄清楚这两者是否总是等价的`Double`......

编辑：根据亚伯的评论：

> 此外，它并不总是最紧凑的符号。0.0001 大于 1E-04，但第一个是输出。MS 文档在这里并不完整。

当然，这符合更详细的描述。（因为所需的指数大于 -5 且小于 15。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-19T15:48:00.147

它使用格式化程序“G”（代表“General”），指定使用“最紧凑的定点或科学记数法” [http://msdn.microsoft.com/en-us/library/dwhawy9k。 aspx](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)

因此，由于定点的`0.00001`字符数多于`1E-05`科学计数法。我想如果它们的长度相等，它有利于定点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T15:45:23.417

我刚刚用循环尝试了这个：

```
double a = 1;
for (var i = 1; i < 10; i++)
{
    a = a / 10;
    Console.WriteLine(a.ToString(CultureInfo.InvariantCulture));
} 
```

输出是：

```
0.1
0.01
0.001
0.0001
1E-05
1E-06
1E-07
1E-08
1E-09 
```

# python - Python中层次聚类的凸壳

> ID：12977747
> 
> 赞同：2
> 
> 时间：2012-10-19T15:40:11.927
> 
> 标签：python, cluster-analysis, computational-geometry, convex-hull, hierarchical-clustering

我正在使用层次聚类来尝试可视化已扁平化为二维的大量数据。我想要做的是创建一个可视化，允许我通过将集群渲染为其组成点的凸包来查看层次结构中不同高度的数据。这个问题最难的部分是我需要一种算法，当我向上移动时，它可以有效地合并对集群的凸包。我已经看到了很多用于在 O(n log n) 时间内计算点的凸包的算法，但在这种情况下，利用问题的子结构似乎会更有效，但我不完全确定如何。

**编辑：**

有关更多信息，数据结构是一个数组，它从聚类的原始点开始，然后说明哪些点/聚类被组合以形成下一个聚类。所以它有点像树/指针结构，但包含在一个大数组中。重要的部分是，查看任何超级集群的两个组成集群是有效的，但获取属于集群的所有点的集合并不高效。所以任何合理的算法都必须自下而上地工作。

所以假设我们在某个地方的层次结构的中间，并且预先计算的层次结构表明集群 A 和 B 被合并以产生集群 C。我们是从下往上的，所以我们已经计算了簇 A 和 B 中的点，因此我们只需将它们组合起来即可生成簇 C 的凸包。簇 A 的凸包实际上可以是一个点、一对或一个完整的多边形。集群 B 也是如此。因此，有几种情况应该如何合并这些以形成集群 C 的凸包，但我敢打赌，有一个聪明的解决方案可能会将单例和对以与多边形相同的方式处理。

最明显的解决方案是使用集群 A 和 B 的凸包的组合点集来计算凸包。但我需要在 100k 点的层次结构上执行此操作，所以我想知道是否有更有效的组合 A 和 B 的凸包的方法。

**编辑2：**

```
 /----5
    1---/    / \
   / \      / B 8
  2 A 3  C 6   /
   \ /      \ /
    4--------7 
```

好的，所以我尝试用 ASCII 码来说明我的意思。簇A的凸包是1-2-3-4，B的凸包是5-6-7-8，C的凸包是1-2-4-7-8-5。据推测，集群 A 和 B 在它们的外壳内包含额外的点，但这些显然不可能成为 C 外壳的一部分，因此问题在于确定在何处“拼接”集群 A 和 B 的外壳以形成C 的船体，基于点的坐标。这是整个过程的归纳步骤。（最终 C 将与集群 D 组合，依此类推，直到算法以最顶层的集群结束，该集群将所有点的凸包作为其凸包）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-21T11:21:38.707

There are at least two convex hull merge algorithms that I'm aware of -- [rotating calipers](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.155.5671&rep=rep1&type=pdf) of Toussaint (section 5 of the paper) and the [bridging algorithm](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.110.6690&rep=rep1&type=pdf) of Preparata and Hong (see section 3 of the paper). Both of these algorithms take time linear in *h = h[1] + h[2]*, where *h[1]* and *h[2]* are the number of hull vertices in the first and second convex hulls respectively.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T21:52:30.053

有多种方法可让您在添加新点时“更新”凸包。此外，一些凸包和 Delaunay 三角剖分的方法已经很好地由内而外地工作，这应该很好地发挥作用。看看 s-hull 算法。

但是，由于您在谈论层次聚类，因此在涉及复杂性时，凸包可能是您最不关心的问题。

层次聚类不能很好地扩展到大型数据集，因为算法通常`O(n^3)`是自然的（使它们成为您发现仍在实践中使用的最慢的聚类算法之一）。因此，考虑到您的聚类更昂贵，另外计算多个凸包应该*不会*产生太大的影响。您可能只需要一个快速、增量的`O(n log n)`凸包算法实现。

# delphi - 当子窗体最大化时，WM_SYSCOMMAND 不起作用

> ID：12977750
> 
> 赞同：4
> 
> 时间：2012-10-19T15:40:18.883
> 
> 标签：delphi, delphi-xe2

我有一个 MDI 应用程序和一个窗口过程来处理 formChild 的消息。在这种情况下，捕获 WM_SYSCOMMAND 消息以显示文本。当表单最小化时，显示一条消息。

一切正常，...但是

问题是当子窗体最大化然后我尝试最小化窗体时，WM_SYSCOMMAND 不起作用，`ShowMessage`不显示。

在这种情况下我能捕捉到什么信息？

```
//TCHild Form Child

function MDIChildProc(hwnd: HWND; uMsg: UINT; wParam: WPARAM; lParam: LPARAM): LRESULT; stdcall;
var
  F: TChild;
begin
  F := TChild(FindControl(hwnd));
  begin
    case uMsg of
      WM_SYSCOMMAND:
      begin
        case wParam and $FFF0 of
          SC_MINIMIZE:
          begin
            {First Minimize then show text} 
            CallWindowProc(Pointer(F.Tag), hwnd, uMsg, wParam, lParam);  
            ShowMessage('form minimized');
          end;
        end;
      end;
    end;
    Result := CallWindowProc(Pointer(F.Tag), hwnd, uMsg, wParam, lParam);
  end;
end; 
```

# c++ - 使用boost工厂按需生产产品C++

> ID：12977753
> 
> 赞同：0
> 
> 时间：2012-10-19T15:40:32.067
> 
> 标签：c++, boost, factory

让我感到困惑的是，我不想用像“Product_ptr productA”这样的指针创建一个对象，还有其他方法吗？另一个问题是我所有的产品都使用DoSomething()，但是我也想给不同的产品添加不同的属性，如何实现呢？谢谢你的建议！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:28:43.420

通常，在处理动态创建的对象时，您无法避免 C++ 中的指针。您必须管理和传递此类对象的所有权，这自然是使用指针完成的，当然主要是智能指针。

尽管有一些方法可以隐藏它们，例如在某个中心点（工厂）维护对象的所有权并通过引用将它们传递给消费者。这种方式有几个缺点，例如消费者需要明确释放对象，以便工厂可以销毁它而不浪费资源。但是，如果您的对象是轻量级的，并且它们的生命周期与整个程序或特定工厂的生命周期相同，那么这可能很有用。

**例子：**

```
template <class Product>
class Factory
{
   // List elements are unaffected by insertion/deletion
   // Could be also container of smart pointers if objects need
   // to be created directly on heap
   std:list<Product> m_objects;

public:

   Product& CreateProduct()
   {
      m_objects.push_back(Product());
      return m_objects.back();
   } 

};

// Usage
Factory<MyProduct> factory;
MyProduct& prod = factory.CreateProduct();
... 
```

此解决方案是可能的，但有局限性，不要在没有真正需要的情况下使用它。从工厂返回适当的智能指针`std::shared_ptr`是更可取的，因为它为您提供了对象所有权的明确语义，并使代码更清晰、可维护和防错。

# sql - 如何检测其中具有相同记录数的 ID 范围

> ID：12977754
> 
> 赞同：1
> 
> 时间：2012-10-19T15:40:33.033
> 
> 标签：sql, sql-server-2005

在 SQL SERVER 2005 数据库中，请假设我们有一个名为 RUNNING_COLA_IS_AFRICA 的表。

此表有一个名为 RUNNING_ID 的唯一 varchar(50) 字段。

我们在这个表中有 100 万条记录。

我想编写一个查询，按 RUNNING_ID ASC 排序并声明范围为 50，生成类似于以下内容的输出：

```
RUNNING_ID_START RUNNING_ID_END
000000           000103
000104           000767
000892           001492
001576           011222
012345           013579 
```

这意味着：

```
a) The number of the records between 000000 and 000103 is 50;
b) The number of the records between 000104 and 000767 is 50;
c) The number of the records between 000892 and 001492 is 50;
d) The number of the records between 001576 and 011222 is 50;
e) The number of the records between 012345 and 013579 is <= 50. 
```

当然，min(RUNNING_ID) = 000000 和 max(RUNNING_ID) = 013579 因为它们是按 RUNNING_ID ASC 排序的。

我如何在 SQL SERVER 2005 中实现这一点？

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:44:04.090

```
WITH
  sequenced
AS
(
  SELECT
    ROW_NUMBER() OVER (ORDER BY running_id) - 1 AS sequence_id,
    *
  FROM
    RUNNING_COLA_IS_AFRICA
)
SELECT
  sequence_id / 50     AS group_id,
  MIN(running_id)      AS running_id_first,
  MAX(running_id)      AS running_id_last,
  COUNT(*)             AS size_of_group
FROM
  sequenced
GROUP BY
  sequence_id / 50 
```

# php - 如何将字符串转换为数组，在 PHP 中使用 Preg_match 匹配多个分隔符？

> ID：12977757
> 
> 赞同：1
> 
> 时间：2012-10-19T15:40:37.427
> 
> 标签：php, regex, preg-match-all

我有以下可能的字符串：

```
NL DE 
NL,DE
nl DE
nl de
NL/DE
NL,mismatch,DE 
```

我正在寻找在`preg_match`给定上述输入的情况下产生以下输出的那个。

```
array(
  [0]=>"NL",
  [1]=>"DE"
); 
```

我试过以下代码：

```
preg_match_all('/(\w{2,2})/ui', $info["country"], $m); 
```

但这似乎也切断了这个词`mismatch`，这是不受欢迎的。

正则表达式应该只匹配两个字母的国家代码，其他的都应该被忽略。

如何`preg_match`在 PHP 中使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:48:34.957

下面是你如何分解字符串：

```
$string = 'NL DE 
NL,DE
nl DE
nl de
NL/DE
NL,mismatch,DE'; 
```

使用`explode`和`filter`：

```
$string = explode("\n",str_replace(array(",","/"," ","\r"), "\n", strtoupper($string)));
$string = array_unique(array_filter($string,function($v){$v = trim($v); return strlen($v) === 2;}));
var_dump($string); 
```

如果你想玩这个字符串，试试这个：

```
$s = ",\n\t \r";
$t = strtok(strtoupper($string), $s);
$l = array();
while ( $t !== false ) {
    in_array($t, $l) OR strlen($t) == 2 AND $l[] = $t AND $t = strtok($s);
}
var_dump($l); 
```

输出：

```
array
  0 => string 'NL' (length=2)
  1 => string 'DE' (length=2) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:46:12.620

```
// @claudrian Variant
function SplitCountries($string){
    // Sanity check
    if(!is_string($string)) return false;
    // Split string by non-letters (case insensitive)
    $slices = preg_split('~[^a-z]+~i', trim($string));
    // Keep only 2-letter words
    $slices = preg_grep('~^[a-z]{2}$~i', $slices);
    // Keep uniques
    $slices = array_unique($slices);
    // Done
    return $slices;
}

// @Wiseguy Variant
function SplitCountries($string){
    // Sanity check
    if(!is_string($string)) return false;
    // Capture only two letter packs
    if(!preg_match_all('~\\b[a-z]{2}\\b~i', trim($string), $slices)){
        return false;
    }
    // Keep uniques
    $slices = array_unique($slices[0]);
    // Done
    return $slices;
} 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:49:55.123

这应该工作

```
$result = array();
preg_match_all('/([a-z]{2})(?:.*)?([a-z]{2})/i',$text, $matches);
$result = array( strtolower( $matches[1][0] ), strtolower( $matches[2][0] ) ); 
```

您将在 $result 数组中获得结果

# php - 动态链接到另一个站点上的 PDF 文件

> ID：12977760
> 
> 赞同：1
> 
> 时间：2012-10-19T15:40:41.547
> 
> 标签：php, jquery, wordpress, pdf

寻找有关实现此目的的最佳方法的一些想法：

我正在创建一个 wordpress 网站，其中包含不同品牌的手表说明。我有 12 个品牌，每个品牌都有一个 PDF 说明文件。人们将能够输入品牌或产品编号并能够下载说明（有大量的产品编号，我们希望让他们轻松输入产品编号，然后显示相应的说明，听起来可能有点矫枉过正，但重点是可用性）。该网站做我想要的。

这就是我需要的，我们还有其他销售手表的网站，我们希望产品页面上有一个说明链接，该链接将根据产品编号动态创建一个链接，并链接回 wordpress 上的 PDF 文件。在产品页面上创建了一个带有产品编号的变量，因此我的想法是修改以下代码以及一个 php 文件，该文件将根据在 wordpress 中标记 PDF 文件的产品编号链接到正确的 PDF（代码在这里找到[http://filamentgroup.com/lab/jquery_plugin_for_requesting_ajax_like_file_downloads/](http://filamentgroup.com/lab/jquery_plugin_for_requesting_ajax_like_file_downloads/)）：

```
jQuery.download = function(url, data, method){
//url and data options required
if( url && data ){ 
    //data can be string of parameters or array/object
    data = typeof data == 'string' ? data : jQuery.param(data);
    //split params into form inputs
    var inputs = '';
    jQuery.each(data.split('&'), function(){ 
        var pair = this.split('=');
        inputs+='<input type="hidden" name="'+ pair[0] +'" value="'+ pair[1] +'" />'; 
    });
    //send request
    jQuery('<form action="'+ url +'" method="'+ (method||'post') +'">'+inputs+'</form>')
    .appendTo('body').submit().remove();
  };
}; 
```

我的另一个想法是按品牌名称链接到文件。我会有一个名为 _instructions.pdf 的文件，然后将品牌附加到 _instructions.pdf 的前面，然后链接到 wordpress 网站上的文件。我尽量不要想太多，有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T16:38:15.243

在站点之间进行通信时，我永远不会对实际文件名做出假设。将可能更改的依赖项列表保持在最低限度，这样您将来就不必修改多个代码库。

我的解决方案与您提出的类似，但您不需要使用 jQuery。如果您可以在 wordpress 站点上创建一个简单的 PHP 文件，那么只需从其他站点创建指向该文件的普通超链接。对于超链接href，使用类似的东西`http://wordpresssite.com/directory-that-custom-php-file-is-in/php-file-name.php?prodnum=n`，将“n”替换为正在查看的页面的实际产品编号。然后，在 php 文件中，获取`prodnum`查询字符串参数值，根据带有该产品编号的文件名查找正确的文件名，并将 PDF 文件本身作为响应发回。这将对用户隐藏；她只需单击超链接，文件就会开始下载。

# c++ - 在没有嵌套 for 循环的情况下查找另一个向量中出现的向量条目

> ID：12977765
> 
> 赞同：0
> 
> 时间：2012-10-19T15:40:46.107
> 
> 标签：c++, for-loop, standard-library

我有一段代码要从 Fortran 迁移到 C++，我想避免一些我必须在原始 F77 代码中创建的嵌套 for 循环结构。

问题是这样的：我有一个称为节点的对象向量，每个对象都包含一个向量，其中包含一个向量，其中包含每个连接到的其他节点对象的索引（以及其他重要信息）（连接图）。像这样

```
struct Node {
    vector<int> conNode;
};
vector<Node> listOfNodes;
vector<int> nodeListA;    // a subset of nodes of interest stored as their vector indices 
```

我需要查找 nodeListA 中的节点连接到的节点，但前提是这些节点也在 nodeListA 中。现在，我的代码看起来像这样：

```
// Loop over the subset of node indices
for (int i=0; i<nodeListA.size(); i++) {
    // Loop over the nodes connected to the node i
    for (int j=0; j<listOfNodes[nodeListA[i]].conNode.size(); j++) {
        // Loop over the subset of node indices again
        for (int k=0; k<nodeListA.size(); k++) {
            // and determine if any of node i's connections are in the subset list
            if (nodeListA[k] == listOfNodes[nodeListA[i]].conNode[j]) {
               // do stuff here
            }
        }
    }
} 
```

必须有一种更简单的方法来做到这一点。好像我把这种方式弄得太复杂了。如何简化此代码，可能使用标准算法库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:57:31.073

如果您的变量应该表达一组值，请使用`std::set`而不是`std::vector`. 然后你会有

```
typedef std::set<int> SetOfIndices;
SetOfIndices setOfIndices; // instead of nodeListA
for(SetOfIndices::const_iterator iter = setOfIndices.begin(); iter != setOfIndices.end(); ++iter)
{
    Node const & node = listOfNodes[*iter];
    for (int j = 0; j < node.conNode.size(); ++j)
    {
        if (setOfIndices.find(node.conNode[j]) != setOfIndices.end())
        {
            // do stuff here
        }
    }
} 
```

**编辑** 正如 Jerry Coffin 所建议的，`std::set_intersection`可以在外循环中使用：

```
struct Node {
    SetOfIndices conNode;
}
typedef std::set<int> SetOfIndices;
SetOfIndices setOfIndices; // instead of nodeListA
for(SetOfIndices::const_iterator iter = setOfIndices.begin(); iter != setOfIndices.end(); ++iter)
{
    Node const & node = listOfNodes[*iter];
    std::vector<int> interestingNodes;

    std::set_intersection(setOfIndices.begin(), setOfIndices.end(),
                      node.conNode.begin(), node.conNode.end(),
                      std::back_inserter(interestingNodes));

    for (int j = 0; j < interestingNodes.size(); ++j)
    {
        // do stuff here
    }
} 
```

**另一个编辑**
关于效率 - 这取决于主要操作是什么。被描述为“在这里做事”的部分的执行次数不会改变。不同之处在于遍历您的集合的时间：

1.  您的原始代码 - nodeListA.size()^2 * [平均 conNode 大小]
2.  我的第一个解决方案 - nodeListA.size() * log(nodeListA.size()) * [平均 conNode 大小]
3.  根据 Jerry Coffin 的建议 - nodeListA.size()^2 * [有趣的 conNode 元素的平均数量]

因此，`set_intersection`在这种情况下，使用似乎没有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T16:23:57.040

我`std::set`建议`std::unordered_set`对`nodeListA`. 下面是一个 C++11 代码示例。

```
#include <unordered_set>
#include <vector>

struct Node {
  std::vector<int> conNode;
};

int main()
{
  std::vector<Node>       listOfNodes;
  std::unordered_set<int> nodeListA;

  for (int node_id : nodeListA)
    for (int connected_id : listOfNodes[node_id].conNode)
      if (nodeListA.find(connected_id) != end(nodeListA))
        /* Do stuff here.. */
          ;

  return 0;
} 
```

使用 a 的优点`std::unordered_set`是查找（即搜索给定的节点 ID）非常快。但是，标准库中包含的实现可能不是特别快。谷歌的稀疏散列和密集散列实现是提供相同接口的替代方案，并且已知对大多数用途都非常好：[http ://code.google.com/p/sparsehash/](http://code.google.com/p/sparsehash/)

根据您要对结果节点执行的操作，可以将上述代码的内部循环替换为 STL 算法。例如，如果您想将算法识别的所有节点放入一个向量中，您可以将其编码如下（将其用作两个循环的替换）：

```
std::vector<int> results;
for (int node_id : nodeListA)
  std::copy_if(begin(listOfNodes[node_id].conNode),
               end(listOfNodes[node_id].conNode),
               back_inserter(results),
               [&nodeListA](int id){return nodeListA.find(id) != end(nodeListA);}); 
```

同样，这是 C++11 语法；它使用 lambda 作为函数参数。

# php - 如何在我的表中搜索表单变量并在未找到时添加到表中，但如果找到则将值增加用户指定的数量？

> ID：12977766
> 
> 赞同：1
> 
> 时间：2012-10-19T15:40:49.260
> 
> 标签：php, mysql, database

我的主页中有以下表格：

```
<left><h2><font color="ghostwhite">Enter Part</font></h2></left>
<form action="addpart.php" method="post">
<font color="ghostwhite">Date:&nbsp&nbsp&nbsp& &nbsp&nbsp</font> <input type="text" name="date" /><br>
<font color="ghostwhite">Part Number:&nbsp&nbsp&nbsp&nbsp&nbsp</font> <input type="text" name="partnum" /><br>
<font color="ghostwhite">Location:&nbsp&nbsp&nbsp&nbsp&nbsp</font> <input type="text" name="location" /><br>
<font color="ghostwhite">Quantity:&nbsp&nbsp&nbsp&nbsp&nbsp</font> <input type="text" name="quantity" /><br>
<input type="submit" />
</form> 
```

我有以下要执行以下操作的 php：

1.  将用户输入的 $date 插入到项目数据库的日期列中。
2.  将用户输入的 $partnumber 插入到项目数据库的 part_name 列中。
3.  将用户输入的 $location 插入到项目数据库的 location 列中。
4.  将用户输入的 $quantity 插入到项目数据库的数量列中。

这是我遇到的问题。我不知道如何在 part_name 列中搜索用户输入的内容，如果不存在则以用户指定的数量输入，但如果找到，则按用户指定的数量递增。

我想它会是这样的：

```
$dup = mysql_query("SELECT * FROM parts(part_name) WHERE VALUE($partnumber)

if ($dup)
    {
   mysql_query("UPDATE parts SET part_name = part_name + $quantity");
    }
else
    {
   mysql_query("INSERT INTO parts (time, part_name, location, quantity) VALUES($date,   $partnumber, $location, $quantity)");
    } 
```

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:44:32.510

看一下：

[http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

应该做你的要求

没有对 html 的评论。

# ruby - Ruby：选择性解析 YAML 文档以恢复不同类别的对象

> ID：12977768
> 
> 赞同：1
> 
> 时间：2012-10-19T15:40:56.577
> 
> 标签：ruby, yaml

我正在尝试在我的沙盒应用程序中构建一些基本的对象持久性（保存游戏、加载游戏）。

我正在使用 YAML 将对象转储到文件中，然后我想恢复它们。我有两类不同的实例化对象，它们是这样写的，看起来都很好：

```
---
- !ruby/object:Game::Room
    reference: :largecave
    name: Large cave
    description: a large empty cave
    connections:
    :west: :smallcave
    :south: :waterfall
- !ruby/object:Game::Room
    reference: :smallcave
    name: Small cave
    description: a small cave
    connections:
    :east: :largecave
- !ruby/object:Game::Room
    reference: :waterfall
(... etc)
---
- !ruby/object:Game::GameObject
    reference: :key
    name: Key
    description: A small key
    room: :smallcave
- !ruby/object:Game::GameObject
    reference: :bowl
(....etc) 
```

问题在于试图恢复和填充两个不同的对象数组：

```
YAML.load(datastore.read) 
```

工作正常，但只适用于一类对象，我试过 select 方法，像这样，但没有成功：

```
@rooms = datastore.select("!ruby/object:Game::Room")
@objects = datastore.select("!ruby/object:Game::GameObject") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:28:42.233

作为数据可用性的建议，我建议为您的类创建一些方法来生成对象内容的哈希值。这样，您就可以存储通用的哈希值的 YAML 表示，而不是 Ruby 对象，后者只能在 Ruby 中使用，而不能在其他语言中使用。

我会放弃在您的 YAML 文件中创建多个文档，并会使用以下内容：

```
require 'pp'
require 'yaml'

places =   [
  {
    reference: :largecave,
    name: 'Large cave',
    description: 'a large empty cave',
    connections: {
      west: :smallcave,
      south: :waterfall
    }
  },
  {
    reference: :smallcave,
    name: 'Small cave',
    description: 'a small cave',
    connections: {
      east: :largecave
    }
  },
  {
    reference: :waterfall
  }
]

things = [
  {
    reference: :key,
    name: 'Key',
    description: 'A small key',
    room: :smallcave
  },
  {
    reference: :bowl
  }
]

data = [
  places,
  things
]

puts data.to_yaml 
```

哪个输出：

```
---
- - :reference: :largecave
    :name: Large cave
    :description: a large empty cave
    :connections:
      :west: :smallcave
      :south: :waterfall
  - :reference: :smallcave
    :name: Small cave
    :description: a small cave
    :connections:
      :east: :largecave
  - :reference: :waterfall
- - :reference: :key
    :name: Key
    :description: A small key
    :room: :smallcave
  - :reference: :bowl 
```

通过 YAML-land 来回查看数据：

```
places, things = YAML.load(data.to_yaml)

=> [[{:reference=>:largecave,
  :name=>"Large cave",
  :description=>"a large empty cave",
  :connections=>{:west=>:smallcave, :south=>:waterfall}},
  {:reference=>:smallcave,
  :name=>"Small cave",
  :description=>"a small cave",
  :connections=>{:east=>:largecave}},
  {:reference=>:waterfall}],
[{:reference=>:key,
  :name=>"Key",
  :description=>"A small key",
  :room=>:smallcave},
  {:reference=>:bowl}]]

pp places

[{:reference=>:largecave,
  :name=>"Large cave",
  :description=>"a large empty cave",
  :connections=>{:west=>:smallcave, :south=>:waterfall}},
{:reference=>:smallcave,
  :name=>"Small cave",
  :description=>"a small cave",
  :connections=>{:east=>:largecave}},
{:reference=>:waterfall}]

pp things

[{:reference=>:key,
  :name=>"Key",
  :description=>"A small key",
  :room=>:smallcave},
{:reference=>:bowl}] 
```

您还可以利用[YAML::Store](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/yaml/rdoc/YAML/Store.html)并这样做：

```
require 'yaml/store'
require 'pp'

store = YAML::Store.new('objects.store')
store.transaction do
  store['places'] = places
  store['things'] = things
end

places = things = nil

store.transaction(true) do
  places = store['places']
  things = store['things']
end

pp places
pp things 
```

看起来像：

```
[{:reference=>:largecave,
  :name=>"Large cave",
  :description=>"a large empty cave",
  :connections=>{:west=>:smallcave, :south=>:waterfall}},
{:reference=>:smallcave,
  :name=>"Small cave",
  :description=>"a small cave",
  :connections=>{:east=>:largecave}},
{:reference=>:waterfall}]

[{:reference=>:key,
  :name=>"Key",
  :description=>"A small key",
  :room=>:smallcave},
{:reference=>:bowl}] 
```

YAML::Store 将为您在磁盘上创建 YAML 文件：

```
---
places:
- :reference: :largecave
  :name: Large cave
  :description: a large empty cave
  :connections:
    :west: :smallcave
    :south: :waterfall
- :reference: :smallcave
  :name: Small cave
  :description: a small cave
  :connections:
    :east: :largecave
- :reference: :waterfall
things:
- :reference: :key
  :name: Key
  :description: A small key
  :room: :smallcave
- :reference: :bowl 
```

这基本上是一个哈希，嵌入数据的关键在哪里`places`和是。`things`

将“Adventure”的配置存储在 YAML 文件中可能会变得笨拙，因此您可能希望最终考虑使用类似[Sequel](http://sequel.rubyforge.org/)和 SQLite 数据库的东西。您仍然可以以通用格式存储数据，但它也可以设置为快速随机访问，并且不需要包含在内存中。

# function - 绘制 2 个变量的函数时出错

> ID：12977779
> 
> 赞同：1
> 
> 时间：2012-10-19T15:41:35.747
> 
> 标签：function, matlab

我正在尝试绘制函数

```
f(x, y) = (x – 3).^2 – (y – 2).^2. 
```

x 是从 2 到 4 的向量，y 是从 1 到 3 的向量，两者的增量都是 0.2。但是，我收到错误：

> “下标索引必须是真正的正整数或逻辑”。

我该怎么做才能修复此错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:49:21.690

我（想）我看到了你想要达到的目标。您正在像数学函数定义一样编写语法。Matlab 将其解释`f`为二维数据类型，并尝试将表达式的值分配给索引为 的数据`x,y`。`x`和的值`y`不是整数，所以 Matlab 抱怨。

如果您想将函数的输出（我们称之为`z`）绘制为 and 的函数`x`，`y`您需要以完全不同的方式定义函数。. .

```
f = @(x,y)(x-3).^2 - (y-2).^2;
x=2:.2:4;
y=1:.2:3; 
z = f(  repmat(x(:)',numel(y),1)  , repmat(y(:),1,numel(x) ) );

surf(x,y,z); 
xlabel('X'); ylabel('Y'); zlabel('Z'); 
```

这会给你这样的输出。. . ![在此处输入图像描述](../Images/11b361d25b069484ebd498712e94fb66.png)

第一行的`f = @(x,y)`部分说明您要定义一个名为`f`获取变量`x`和的函数`y`。该行的其余部分是该函数的定义。

如果您想绘制`z`两者的函数`x`和`y`，那么您需要提供范围内所有可能的组合。这就是包含`repmat`命令的行的用途。

**编辑**

正如@bas 所建议的那样，有一个简洁的 Matlab 函数`meshgrid`可以替换脚本的 repmat 版本（欢迎 bas，请滚动到 bas 的答案并 +1！）...

```
f = @(x,y)(x-3).^2 - (y-2).^2;
x=2:.2:4;
y=1:.2:3;
[X,Y] = meshgrid(x,y);
surf(x,y,f(X,Y)); 
xlabel('x'); ylabel('y'); zlabel('z'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-20T00:39:46.677

我通常使用[MESHGRID](http://www.mathworks.com/help/matlab/ref/meshgrid.html)函数。像这样：

```
x = 2:0.2:4;
y = 1:0.2:3;
[X,Y] = meshgrid(x,y);
F = (X-3).^2-(Y-2).^2;
surf(x,y,F);
xlabel('x');ylabel('y');zlabel('f') 
```

这与@learnvst 的答案相同。它只是为你做repmat-ing。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:48:29.953

您的问题是您正在使用的函数使用整数，并且您试图为其分配一个双精度值。整数不能有小数位。要解决此问题，您可以使其以 1 而不是 0.2 为增量增加

# java - 用java获取“ls -la”信息

> ID：12977780
> 
> 赞同：-1
> 
> 时间：2012-10-19T15:41:37.947
> 
> 标签：java, file, posix, ls

我想知道我是否可以使用 Java 获得这样的输出

[![在此处输入图像描述](../Images/f489c9609fbdb9919caa20b7e94c3832.png)](https://i.stack.imgur.com/3LEUp.png)

这必须在 Linux、Windows 和 Mac 下工作；如果可能的话，我不喜欢使用`Runtime.exec()`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:53:34.330

我认为您可以使用`File`对象的元数据来获取所需的任何内容。检查以下链接：

[http://docs.oracle.com/javase/tutorial/essential/io/fileAttr.html](http://docs.oracle.com/javase/tutorial/essential/io/fileAttr.html)

*例子：*

```
Path file = ...;
BasicFileAttributes attr = Files.readAttributes(file, BasicFileAttributes.class);

System.out.println("creationTime: " + attr.creationTime());
System.out.println("lastAccessTime: " + attr.lastAccessTime());
System.out.println("lastModifiedTime: " + attr.lastModifiedTime()); 
```

（这个例子取自我提供的链接）。

希望这可以帮助你

* * *

检查 Java API，我发现您需要的数据（大小、属性等）可以通过`File`类方法访问。检查：[http ://docs.oracle.com/javase/7/docs/api/java/io/File.html](http://docs.oracle.com/javase/7/docs/api/java/io/File.html)

请注意，linux 和 mac 都是类 Unix 系统，而 windows 不是。因此，您将无法获得在 Windows 中可以在 linux 或 mac 上获得的所有文件属性......但您可以获得最重要的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:53:43.643

不，您不能，因为您想要的输出具有 *nix-only 属性“所有者”和“组”，这在 Windows 平台上不存在。java`File`没有这个信息，这将是不使用获取文件信息的唯一方法`Runtime.exec()`

# vb.net - 连接到 Oracle 11g 的 VB.NET 问题

> ID：12977790
> 
> 赞同：0
> 
> 时间：2012-10-19T15:42:10.517
> 
> 标签：vb.net, oracle11g, vb.net-2010, odp.net

```
OS: Windows 7 64bit
VB: Visual Studio 2010
Oracle Client: 11g 
```

我正在开发一个连接到 Oracle 11g 服务器的应用程序。我能够通过 Oracle SQL Developer、ODBC（在 SYSWOW64 中）和 VB Server Explorer 连接到 Oracle 服务器。

我正在使用位于以下位置的 .NET 参考 Oracle.DataAccess：C:\Oracle\product\11.2.0\client_32\ODP.NET\bin\2.x\Oracle.DataAccess.dll

我已尝试按照其他问题的建议将 .DLL 文件添加到我的 bin 文件夹中，但这不起作用。

有没有人有任何其他建议？

当我运行我的应用程序时，我得到以下信息： ![在此处输入图像描述](../Images/76f89b1069445295feb176f32fac40ee.png)

以下是详细信息：

```
System.TypeInitializationException was unhandled
  Message=The type initializer for 'Oracle.DataAccess.Client.OracleConnection' threw an exception.
  Source=Oracle.DataAccess
  TypeName=Oracle.DataAccess.Client.OracleConnection
  StackTrace:
       at Oracle.DataAccess.Client.OracleConnection..ctor(String connectionString)
       at Orc_Test_1.Form1.Button1_Click(Object sender, EventArgs e) in c:\Visual Studio 2010\Projects\Orc_Test_1\Orc_Test_1\Form1.vb:line 9
       at System.Windows.Forms.Control.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)
       at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
       at System.Windows.Forms.Control.WndProc(Message& m)
       at System.Windows.Forms.ButtonBase.WndProc(Message& m)
       at System.Windows.Forms.Button.WndProc(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
       at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
       at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
       at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OnRun()
       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoApplicationModel()
       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Run(String[] commandLine)
       at Orc_Test_1.My.MyApplication.Main(String[] Args) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 81
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: Oracle.DataAccess.Client.OracleException
       DataSource=""
       ErrorCode=-2147467259
       Message=The provider is not compatible with the version of Oracle client
       Number=-11
       Procedure=""
       Source=Oracle Data Provider for .NET
       StackTrace:
            at Oracle.DataAccess.Client.OracleInit.Initialize()
            at Oracle.DataAccess.Client.OracleConnection..cctor()
       InnerException: 
```

VB.NET 代码：

```
Imports System.Data
Imports Oracle.DataAccess.Client ' ODP.NET Oracle managed provider
Imports Oracle.DataAccess.Types

Public Class Form1

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        Dim oradb As String = "Data Source=SERVER1;Persist Security Info=True;User ID=username;Password=password;Unicode=True" 'From Server Explorer
        'Dim oradb As String = "Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=Server1.host.net)(PORT=1522))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=Server1))); USER ID = username;Password = password;" 'From TNSnames.ora
        Dim conn As New OracleConnection(oradb)  '<--- Error happens on this line
        conn.Open()
        Dim cmd As New OracleCommand
        cmd.Connection = conn
        cmd.CommandText = "select system_id from schema1.system_impacted where system_name = AWESOME"
        cmd.CommandType = CommandType.Text
        Dim dr As OracleDataReader = cmd.ExecuteReader()
        dr.Read()
        Label1.Text = dr.Item("system_id")
        conn.Dispose()
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T17:45:27.673

我感觉到你的痛苦，刚刚在部署情况下经历了类似的事情。您可能安装了多个客户端，并且您的环境正在为旧版本提取 dll（即使您的项目中正确引用了最新的 oracle.dataaccess.dll）。在您的开发环境中解决此问题是一回事，而产品部署服务器则是另一回事。不确定您的部署情况是什么，但这对我有用。

在努力尝试在现有的 oracle home 中升级 odp.net、添加新的 oracle home 等之后，我发现解决所有问题的最简单方法是从 Oracle 下载[带有 xcopy 部署的最新 odac](http://www.oracle.com/technetwork/database/windows/downloads/index-101290.html)，然后按照自述文件进行操作（请参阅[此处](http://www.oracle.com/technetwork/issue-archive/2008/08-nov/o68odpnet-101744.html)对于这方面的旧文章也有）。基本上，您将运行一个 install.bat 文件以在本地进行设置（在单独的文件夹中，我的是 c:\oracle_odac），然后将您的项目引用更改为指向这个新文件夹中的 oracle.dataaccess.dll（我使用 4 而不是2.x)，然后将新文件夹的 bin 目录添加到路径的前面（c:\oracle_odac\bin 和 c:\oracle_odac\odp.net\bin\4）。在您的部署服务器上，您只需复制整个 c:\oracle_odac 文件夹（通过 xcopy 或其他方式），并设置路径。

也就是说，我焦急地等待Oracle[完全托管的 o​​dp.net](http://www.oracle.com/technetwork/database/windows/downloads/odpmbetainstall-1696475.html)的生产版本（现在处于测试阶段）。

编辑：只是补充一点，如果您在应用程序或 Web 配置文件中设置 dllpath，则可以避免弄乱 PATH。例如：

```
<configuration>
...
    <configSections>
      <section name="oracle.dataaccess.client" type="System.Data.Common.DbProviderConfigurationHandler, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>  
...

<oracle.dataaccess.client>
    <settings>
      <add name="DllPath" value="c:\oracle_odac\bin"/>
    </settings>
  </oracle.dataaccess.client>
... 
```

这将覆盖其他设置，例如注册表或 machine.config。并且它将允许多个 odp.net 配置和平存在，并允许每个应用程序指向同一服务器上所需的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:48:20.083

通常在您构建 x64 应用程序时发生，该应用程序试图获取实际上不起作用的 x32 驱动程序。

在这种情况下你会做什么（这很痛苦）：

*   将 x32 oracle 客户端安装到 oraclehome1
*   将 x64 oracle 客户端安装到 oraclehome2

确保您的应用程序构建（x64、x32）指向正确的 oraclehome。我手边没有那个代码，但我相信它类似于连接字符串中的“Home=oraclehome2”或类似内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T15:53:58.617

我删除了“控制面板”的“程序”部分中可用的所有 Oracle 客户端。然后我进入注册表搜索“Oracle”并删除了 Oracle 客户端的所有实例/引用。在删除注册表并重新启动 3 小时后，我安装了 11g 客户端，一切都按预期工作。

**注意：**在注册表中搜索“Oracle”时，可能会引用 VB 版本的 Oracle，或者引用“Oracle”的 Crytsal Reports 驱动程序。我没有删除这些。因此，请注意要删除的注册表项的文件位置和/或语法。

/阅读。有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T14:42:52.197

下载 ODAC 32/ ODAC 64 位，取决于 OS、VS 和 oracle 11g 的兼容性。使用 oracle 11g 32、os 32 位、oracle 32 位或 oracle 64 位、os 64 位和 oracle 11g 64 位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-31T20:04:45.657

根据我的经验，在尝试了 tbone 的建议、使用 PATH env 变量和其他不成功的游戏之后，立即起作用的解决方案是将下面列出的 8 个 DLL 文件的副本保存在 vb.net 可执行文件的同一文件夹中，然后在同一文件夹中添加对 Oracle.DataAccess.dll 的引用。

```
C:\Users\Legarcia\Documents\Visual Studio 2010\Projects\LabRetention\LabRetention\bin\Debug>dir *.dll
 Volume in drive C is OS
 Volume Serial Number is 10EC-8C5D

 Directory of C:\Users\Legarcia\Documents\Visual Studio 2010\Projects\LabRetention\LabRetention\bin\Debug

09/30/2008  07:57 PM           348,160 msvcr71.dll
10/01/2008  02:22 AM           520,192 oci.dll
10/01/2008  01:56 AM           352,256 ociw32.dll
08/12/2009  07:13 AM         1,011,712 Oracle.DataAccess.dll
09/18/2008  08:47 PM         1,130,496 orannzsbb11.dll
10/01/2008  01:48 AM           868,352 oraocci11.dll
10/01/2008  02:45 AM       117,604,352 oraociei11.dll
08/12/2009  07:21 AM           413,696 OraOps11w.dll
               8 File(s)    122,249,216 bytes
               0 Dir(s)  238,127,943,680 bytes free 
```

在开发/测试/调试时，DLL 集被复制到 ..\projects\{Your project}\bin\Debug

例如：[C:\Users\Legarcia\Documents\Visual Studio 2010\Projects\LabRetention\LabRetention\bin\Debug]

为用户发布应用程序时，只需将 DLL 复制到 EXE 的相同目录即可

这似乎隔离了所有其他 Ora 客户端安装。

VB.net 应用程序中使用的连接字符串是根据其他客户端目录中的 TNSNAMES.ORA 文件中的信息创建的。

问候。

乐+

# matlab - 在 MATLAB 中计算两个数组的卷积

> ID：12977792
> 
> 赞同：1
> 
> 时间：2012-10-19T15:42:25.120
> 
> 标签：matlab

我正在尝试使用 MATLAB 中的这个公式从一些起始值生成一个数组：

> y [t] = a [0] + ∑<sub>i=1 ^p (a [i] ⋅ y [t-i] ), t ≥ p

****与T** (max t)相比，**p是一个很小的数字。**我已经能够使用两个`for`周期来做到这一点，但它真的很慢。有什么简单的方法吗？**

 ****提供了y**的第一个*p*值，并且还提供了向量**a**（其长度为*p+1*）...

 *****这是我到目前为止所拥有的，但是现在当我尝试它时，它不能 100% 工作（我认为这是因为在 MATLAB 中从 1 开始索引）：

```
y1 = zeros(T+1, 1);
y1(1:p) = y(1:p);

for t = p+1:T+1
    value = a1(1);
    for j = 2:p+1
        value = value + a1(j)*y1(t-j+1);
    end
    y1(t) = value;
end 
```

编辑：我解决了，我只是不习惯从 1 开始的 Matlab 索引...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:06:33.770

这个说法

```
 if(p>=t) 
```

在索引表达式为的循环中看起来很奇怪

```
for t = p+1:T+1 
```

这似乎可以保证`t>p`在整个循环期间。这就是你要写的吗？

**编辑**回应评论

在使用此语句索引的循环内

```
for j = 2:p 
```

你做的参考是如何`a(j)`要求的`a(0)`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T09:16:24.903

```
y1 = zeros(T+1, 1);
y1(1:p) = y(1:p);

for t = p+1:T+1
    value = a1(1);
    for j = 2:p+1
        value = value + a1(j)*y1(t-j+1);
    end
    y1(t) = value;
end 
```*******

# java - 记录 Apache POI 独立应用程序

> ID：12977793
> 
> 赞同：2
> 
> 时间：2012-10-19T15:42:38.837
> 
> 标签：java, logging, log4j, apache-poi, apache-commons-logging

我正在尝试使用 log4j 记录在 Apache POI API 中执行的操作。

我在属性文件中有以下配置：

```
log4j.logger.org.apache.poi=DEBUG, apachepoi
log4j.additivity.apachepoi=false
log4j.appender.apachepoi=org.apache.log4j.DailyRollingFileAppender
log4j.appender.apachepoi.DatePattern='.'yyyy-MM-dd
log4j.appender.apachepoi.File=c:\\logs\\apachepoi.log
log4j.appender.apachepoi.layout=org.apache.log4j.PatternLayout
log4j.appender.apachepoi.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss} %-5p %x: %m%n 
```

而且，对于 NetBeans，我分配了以下 VM 选项：

```
Dorg.apache.poi.util.POILogger=org.apache.poi.util.CommonsLogger -Dorg.apache.commons.logging.Log=org.apache.commons.logging.impl.Log4JLogger -Dorg.apache.commons.logging.LogFactory=org.apache.commons.logging.impl.LogFactoryImpl 
```

“apachepoi.log”文件已创建，但其中没有写入任何行。最奇怪的是：如果我有 JBoss 实例的 VM 选项，它会记录 Apache POI 的操作。问题是我在独立应用程序上需要它

- 编辑

也在 Linux 环境下尝试过，但保持不变：使用 JBoss 写入日志，但不在独立应用程序上

# java - 从 IStructuredSelection 中获取选择顺序

> ID：12977794
> 
> 赞同：-1
> 
> 时间：2012-10-19T15:42:46.320
> 
> 标签：java, eclipse-plugin, jface

我编写了一个 Eclipse 插件，它允许用户比较两个项目之间的 SLOC 计数。只需在 Project Explorer 视图中突出显示两个项目，右键单击并选择插件（通过上下文菜单启动插件），即可启动该插件。无论选择 ProjectA 和 ProjectB 的顺序如何，插件都会将 ProjectA 与 ProjectB 进行比较。我想使用选择顺序来确定用户是否将获得 ProjectA 与 ProjectB 或 ProjectB 与 ProjectA 的比较。

给定一个`IStructuredSelection`，我如何判断哪个项目首先被选中？

顺便说一句 - 似乎`getFirstElement()`没有给你选择的第一个元素，只是列表中的第一个元素（同样，它不一定是第一个元素 [Project in this case] selected）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T16:32:47.133

您无法从 IStructuredSelection 中获取选择顺序，但还有另一种选择。对于菜单/弹出操作，您可以通过 selectionChanged(IAction action, ISelection selection) 方法获得当前选择。This method is called whenever the selection changes. 通常你会丢弃最后一个选择而只保留新的 IStructuredSelection，但是如果你将之前的 IStructuredSelection 与传递给你的那个进行比较，你会看到自上次选择操作以来添加和删除的内容。通过随着时间的推移跟踪这些变化，您应该能够知道选择的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T08:16:56.253

您根本不应该根据选择事件的顺序进行此操作。作为用户，我会很生气，如果我不仅要选择 2 个项目，而且必须按正确的顺序单击它们才能得到我想要的结果。

相反，将按钮或其他 UI 元素放入结果视图以“切换比较顺序”。这对用户来说更容易理解和记住。

# iphone - Restkit 映射错误

> ID：12977796
> 
> 赞同：2
> 
> 时间：2012-10-19T15:42:51.623
> 
> 标签：iphone, ios, core-data, restkit

我是restkit的新手，我在我的应用程序中使用它以及核心数据。我对 restkit 处理核心数据的方式感到非常惊讶。这简直太棒了。但是我在解析我的一个网络服务时面临一个重大问题。该应用程序不断崩溃，并且无法从响应中映射值。以下是我的回应——

[ {“id”：10，“created”：“2012-10-06 13:32:09 +0000”，“createdBy”：null，“functionalCurrency”：null，“imageUrl”：null，“lat”：null ，“lon”：null，“maxOccupancy”：0，“name”：“Patio Dining”，“posX”：0，“posY”：0，“reportingCurrency”：null，“salesTaxRate1”：0，“salesTaxRate2”： 0，“salesTaxRate3”：0，“salesTaxRate4”：0，“timezone”：“-0830”，“transactionalCurrency”：null，“updated”：“2012-10-06 13:32:09 +0000”，“updatedBy “： 无效的}]

我收到以下错误。-

**E restkit.object_mapping:RKObjectMappingOperation.m:262 将键路径“locationId”的属性映射到值 10 时验证失败。错误：操作无法完成。（Cocoa 错误 1610。）-[__NSCFNumber 长度]：无法识别的选择器发送到实例 0x774e020**

我的位置类声明如下 -

```
@interface Location : NSManagedObject

@property (nonatomic,strong)NSNumber *locationId;
@property (strong, nonatomic) NSString *created;
@property (nonatomic,strong)  NSString *createdBy;
@property (nonatomic,strong)  NSString *functionalCurrency;
@property (nonatomic,strong)  NSString *imageUrl;
@property (strong, nonatomic) NSString *lat;
@property (strong, nonatomic) NSString *lon; 
```

我按如下方式初始化管理器-

```
 RKURL *baseURL = [RKURL URLWithBaseURLString:serverUrl];

            objectManager = [RKObjectManager objectManagerWithBaseURL:baseURL];

            objectManager.client.baseURL = baseURL;

            objectManager.client.requestQueue.showsNetworkActivityIndicatorWhenBusy = YES;
[RKObjectManager setSharedManager:objectManager];

[objectManager loadObjectsAtResourcePath:[NSString stringWithFormat:@"%@", [URL resourcePath]] delegate:self]; 
```

当我尝试将 locationId 设置为 NSString 时，RKObjectManager 根本不匹配“9”之后的任何值。当设置为 NSNumber 时，它不匹配“2”之后的任何值。

请帮我。RKManagedObjectMapping 也发生了同样的事情，因此没有数据进入我的核心数据文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T07:14:30.963

嗯，这真的很尴尬，经过大量的头部撞击终于找到了问题所在。核心数据中我的 locationId 的最大值设置为 1。这导致了验证错误。

# mysql - 当特定数字为 x 时 MySQL 选择

> ID：12977797
> 
> 赞同：1
> 
> 时间：2012-10-19T15:42:51.777
> 
> 标签：mysql

我有一列包含 5A898、89KAS、89ASD 等值。

我正在尝试编写一个查询，该查询仅返回列的第三位为“A”的行。例如“89ASD”会被返回，但“89KAS”不会。我不确定这样做的正确方法是什么。常用表达？

所以...

```
SELECT column
FROM table
WHERE column = ? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:45:02.763

```
WHERE column LIKE '__A%'
                   ^^-- 2 underscores 
```

应该做的伎俩。两个“whatever”字符，后跟一个 A，然后是任意数量的任何字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:44:31.457

也许你可以使用 MySQL 的[`SUBSTRING`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substring)

```
SELECT column
FROM table
WHERE SUBSTRING(column,3,1) = 'A' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:46:08.667

```
where right(left(col,3),1) = 'A' 
```

这可以帮助... MarcB 的答案更清晰

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T15:47:19.500

您可以使用正则表达式执行此操作，但我认为在这里处理字符串操作可能更容易：

```
SELECT column
FROM   table
WHERE  SUBSTRING(column,3,1) = 'A'; 
```

# android - 使用 jmdns 中的子类型发现服务

> ID：12977800
> 
> 赞同：2
> 
> 时间：2012-10-19T15:43:06.390
> 
> 标签：android, zeroconf, jmdns

我已经在我的 linux pc 上使用 mdnsreponder(applebonjour) 注册了我的服务子类型
。我正在尝试在我的 Galaxy 手机上使用 jmdns （这里我有 jmdns.jar 文件）浏览服务。

我使用以下命令注册了服务

```
$dns-sd -R SMARTCAM _smartplace._tcp.,**_wcam** local 80  "u=test" 
```

当我浏览 jmdns 的服务类型列表中没有子类型时，我得到了正确的响应。IE

```
ServiceInfo[] https = jmdns.list("_smartplace._tcp.local."); 
```

但如果我尝试使用以下选项，它无法列出任何内容 -> 响应为空 ServiceInfo[] https = jmdns.list("_wcam._sub._smartplace._tcp.local.");

```
$avahi-browse   _wcam._sub._smartplace._tcp. 
```

它与avahi浏览器一起使用..

现在有人可以帮助我如何使用 jmdns 浏览子类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-11T08:50:44.790

JmDNS 目前不支持此功能。有一个开放的错误（[http://sourceforge.net/p/jmdns/bugs/91/](http://sourceforge.net/p/jmdns/bugs/91/)）。

您将需要浏览主要类型（无子类型），然后自己进行过滤（例如，您可以使用自定义键添加 TXT 记录，然后在发现的每个服务上检查该键）。

# javascript - 如何比较输入框变量表中的两个输入框？

> ID：12977803
> 
> 赞同：1
> 
> 时间：2012-10-19T15:43:14.173
> 
> 标签：javascript, jquery

我试图在输入框大于第二个框时发出警报，例如：

```
<td align="center"> <input type='text' name='cantidad{{=i+1}}' id='cantidad' value='{{=(x.cantidad)}}' size='3' readonly="readonly"  /></td>

<td align="center"> <input type='text' name='desp{{=i+1}}' id='desp' value='' size='3' required='required' placeholder='Numero' onBlur="return validar(event)"/></td> 
```

我有 x 组输入框，其中，我需要的最后两个输入框检查第二个不能大于第一个。然后我不知道如何在可以是 x 组的表中捕获这些值

`{{}}`代码是 Python 嵌入式的。

已编辑：每行有 12 个输入框已
编辑：我需要 id='desp' 的输入不能大于每行 id='cantidad' 的输入

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:48:48.060

您可以尝试通过提供这样的 ID 来尝试：-

```
if(document.getElementById("first").value == document.getElementById("second").value){
//they are the same, do stuff for the same
}else if(document.getElementById("first").value >= document.getElementById("second").value
//first is more than second
} 
```

[或者你可以在JSFiddle](http://jsfiddle.net/su__/dtUUJ/)中做这样的事情

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:48:08.290

如果你给最后一个文本框添加一个 css 类，比如我们称之为“textbox-last”，那么你可以使用 jQuery 将一个函数绑定到 blur 事件，如下所示：

```
$('#yourtable').on('blur', '.textbox-last', function() {

    var td = $(this).parent();
    var prevTextboxValue = td.prev().find('input').val();

    ...

}); 
```

这将为您从上一个文本框中获取任何具有该类的文本框的值。然后添加您想要在此之后实现的任何逻辑。

# jquery - 将 DateTimePicker 转换为 Unix，然后再返回

> ID：12977818
> 
> 赞同：2
> 
> 时间：2012-10-19T15:44:14.183
> 
> 标签：jquery, jquery-ui-datepicker, datetimepicker, unix-timestamp

是否有任何简单的解决方案可以像这样翻译 unix 时间戳：

```
1350664800 
```

变成人类可读的日期，例如：

```
10/19/2012 11:40 AM 
```

?

我正在警告 jQuery UI[日期选择器](http://jqueryui.com/datepicker/)（带有[datetimepicker 插件](http://trentrichardson.com/examples/timepicker/)），以便它选择并显示“人类”日期，将 unix 日期发送到服务器，然后在打开时将其转换回“人类日期”。我有这个功能的翻译：

```
 function unixTranslate() {
            $('input[name=valueTextField]').each(function () {
                var unixTimestamp =  ($(this).datetimepicker("getDate").getTime() / 1000) + 3600;
                $(this).attr('title', unixTimestamp);          
             });
    } 
```

它从 datetimepicker 小部件输出正确的数字，但我不确定如何将其翻译回来。

**编辑**

好的，所以我将它转换回 JS 日期对象：

```
 var myDate = new Date(unixTimestamp * 1000);
        alert(myDate); 
```

但是，现在我在解析它以使其看起来像我想要的样子时遇到了问题。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:21:40.263

像这样的东西（有点乱）应该可以完成工作：

```
var date = new Date(unixTimestamp * 1000),
//generate formatted string
formatted = (date.getMonth()+1) + '/' + date.getDate() + '/' + date.getFullYear() + " " + (date.getUTCHours() > 12 ? date.getUTCHours()-12 : date.getUTCHours()) + ":" + date.getUTCMinutes() + " " + (date.getUTCHours() >= 12 ? 'PM' : 'AM'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-13T12:02:59.850

You can also do

```
var date = new Date(unixTimeStamp * 1000);
alert(date.toLocaleString()); 
```

# android - getActionBar() 的 NoSuchMethodError 错误 (API-8)

> ID：12977819
> 
> 赞同：18
> 
> 时间：2012-10-19T15:44:15.623
> 
> 标签：android, android-actionbar

当我运行它安装的应用程序但随后崩溃时，ecplise 没有告诉我的代码有什么问题。我认为这是我的清单有问题...

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.secondapp"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>                
                <meta-data
                    android:name="android.support.PARENT_ACTIVITY"
                    android:value="com.example.secondapp" />
        </activity>
    </application>

</manifest> 
```

你们有什么问题吗？

```
10-19 10:41:25.589: E/AndroidRuntime(10147): FATAL EXCEPTION: main
10-19 10:41:25.589: E/AndroidRuntime(10147): java.lang.NoSuchMethodError: com.example.secondapp.MainActivity.getActionBar
10-19 10:41:25.589: E/AndroidRuntime(10147):    at com.example.secondapp.MainActivity.onCreate(MainActivity.java:15)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1722)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1784)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at android.app.ActivityThread.access$1500(ActivityThread.java:123)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at android.os.Handler.dispatchMessage(Handler.java:99)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at android.os.Looper.loop(Looper.java:130)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at android.app.ActivityThread.main(ActivityThread.java:3835)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at java.lang.reflect.Method.invokeNative(Native Method)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at java.lang.reflect.Method.invoke(Method.java:507)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:864)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:622)
10-19 10:41:25.589: E/AndroidRuntime(10147):    at dalvik.system.NativeStart.main(Native Method) 
```

这是logcat，不确定这是否有帮助

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-10-30T13:41:24.557

与支持库 v7 一起使用[，](http://android-developers.blogspot.co.il/2013/08/actionbarcompat-and-io-2013-app-source.html)`getSupportActionBar`如本节所述`6\. Retrieve the Action Bar`

[getSupportActionBar 文档](https://developer.android.com/reference/android/support/v7/app/ActionBarActivity.html#getSupportActionBar%28%29)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-19T15:47:47.213

> java.lang.NoSuchMethodError: com.example.secondapp.MainActivity.getActionBar

在您的 MainActivity 类上，您调用`getActionBar()`了对您的应用程序不可用的方法。

您`android:minSdkVersion`设置为 8 (API-8)，它不提供`getActionBar()`（仅从 API-11 开始）。

您应该使用[ActionBarSherlock](http://actionbarsherlock.com/)以获得良好的向后兼容性，或者设置`android:minSdkVersion`但所有设备 < API-11 都不会成为目标。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-02T02:15:26.660

这是因为`getActionBar`是 api 11 的一个方法，但是你可以这样做：

```
if (android.os.Build.VERSION.SDK_INT >= 11)
    getActionBar().setDisplayHomeAsUpEnabled(true); //example 
```

并在活动类中添加此抑制 Lint：

```
@SuppressLint("NewApi") 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-03-28T04:43:28.867

我以前也遇到过同样的问题。我只是更换

```
getActionBar() 
```

和

```
getSupportActionBar() 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-19T15:47:39.647

您可能在低于 API 11 的手机上运行，​​这是`getActionBar`引入该方法的时候。如果您需要在低于 API 级别 11 的设备上运行，那么您将需要防止执行那些仅存在于较新 API 级别上的调用，或者使用诸如[ActionBarSherlock](http://actionbarsherlock.com/)或[Action Bar Compatiblity](http://developer.android.com/resources/samples/ActionBarCompat/index.html)之类的兼容性库。（有关这两者之间差异的讨论，请参阅[此线程。）](https://stackoverflow.com/questions/7844517/different-between-actionbarsherlock-and-action-bar-compatibility)

更改`android:minSdkVersion="8"`to`android:minSdkVersion="11"`并且您正在进行的所有较新的 API 调用都将显示为错误。这将使您更容易找到需要注意的代码部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-14T04:49:41.233

对于 api < 11，您必须使用：

```
getSupportActionBar(); 
```

算法确保您使用的是 appcompat，将其添加到 build.gradle，19.+ 应该是您的项目目标版本。

```
compile 'com.android.support:appcompat-v7:19.+' 
```

此外，如果您将 invalidateOptionsMenu() 用于**导航抽屉**，请改用：

```
supportInvalidateOptionsMenu(); 
```

# c++ - 数值配方：如何在 C++ 中将函数作为函数 newt 的参数传递

> ID：12977823
> 
> 赞同：0
> 
> 时间：2012-10-19T15:44:23.487
> 
> 标签：c++, function-pointers, newtons-method

我的问题与数字食谱有关。我有一个全局函数，它计算要最小化的函数向量

```
VecDoub vecfunc(VecDoub_I x) {
  // code is here
} 
```

在类函数*run*中，我尝试调用 Numerical Recipes 函数 newt，它读取我的函数*vecfunc*，如图所示，

```
class A {
    void run() {
        VecDoub_IO pt;
        pt.resize(2);
        pt[0] = 0.5;
        pt[1] = 0.5;
        bool check = false;
        newt<VecDoub>(pt, check, &vecfunc);
    }
} 
```

函数*newt*被声明为

```
template <class T>
void newt(VecDoub_IO &x, Bool &check, T &vecfunc) 
```

为什么会出现以下编译器错误？

```
error C2664: 'newt' : cannot convert parameter 3 from 'VecDoub (__cdecl *)(VecDoub_I)' to 'VecDoub &' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:58:03.193

在调用`newt`时明确指定`T`是`VecDoub`（您指定`newt<VecDoub>`），但您将函数的地址传递给它，因此编译器无法将您的函数转换为`VecDoub&`. 如果你想要一个`VecDoub&`in`newt`然后调用`vectfunc`并将它存储在一个临时变量中，然后将该变量传递给函数（因为`newt`最后一个参数是对 的引用`T`）但是如果你真的需要一个函数，`newt`那么为什么你写的`newt<VecDoub>(pt, check, &vecfunc)`时候你可以写`newt(pt, check, &vecfunc)`并且让C++ 为你推导出类型？除此之外，为了接收函数，`newt`不要通过引用获取它们，而是通过值获取它们，因此`newt`应声明为：

```
template <class T>
void newt(VecDoub_IO &x, Bool &check, T vecfunc) 
```

由于函数通常是小对象或指针，这将起作用并且不会降低性能

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:47:03.160

因为您应该调用函数并将返回值作为参数传递，而不是函数本身。

```
newt<const VecDoub>(pt, check, vecfunc(something) ); 
```

我添加了是`const`因为引用需要是常量，否则 from 的返回值`vecfunc`无法绑定到它，因为它是临时的。

解释：

```
newt<VecDoub>(pt, check, &vecfunc); 
```

尝试调用类似于

```
newt_VecDoub(VecDoub_IO &x, Bool &check, VecDoub &vecfunc); 
```

您尝试传递的第三个参数是`&vecfunc`type `VecDoub (__cdecl *)(VecDoub_I)`，因此它显然无法工作。

# jquery - 如何在 ASP .NET 表单上使用 jQuery UI 对话框作为“提交前确认”对话框

> ID：12977827
> 
> 赞同：6
> 
> 时间：2012-10-19T15:44:36.590
> 
> 标签：jquery, asp.net, jquery-ui

我正在尝试利用 jQuery UI（或任何其他对话框插件）来替换默认的确认对话框。StackOverflow 上有很多类似的问题和答案，例如：

[jquery 对话框：确认单击提交按钮](https://stackoverflow.com/questions/2881706/jquery-dialog-confirm-the-click-on-a-submit-button)

然而，在 ASP .NET 中，我需要更多的东西。

由于**页面上的一个表单**约束，在 ASP .NET 页面上（使用 ASP .NET 3.5）我可以有多个按钮提交相同的表单，并且根据提交的标题信息**页面**知道哪个控件（按钮）触发了表单提交，并且可以在服务器上调用正确的方法（附加到Button的Click事件的方法）。

如果我使用其他 StackOverflow 答案的解决方案，例如：

```
 buttons: {
            'Delete all items': function() {
                $(this).dialog('close');
                currentForm.submit();
            },
            'Cancel': function() {
                $(this).dialog('close');
            }
        } 
```

PostBack 不会调用任何事件处理程序。如果我将其替换为：

```
 buttons: {
            'Delete all items': function() {
                $(this).dialog('close');
                $buttonThatWasConfirmed.click();
            },
            'Cancel': function() {
                $(this).dialog('close');
            }
        } 
```

它将导致无休止的模态对话递归。如何在 ASP .NET 中解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:31:19.377

作为一个选项：`SubmitBehavior="false"`用于 Button 控件并在表单的结束标记之前放置脚本：

```
<script type="text/javascript">
    var originalDoPostBack = __doPostBack;
    __doPostBack = function (sender, args) {
        $("#dialog").dialog({
            modal: true,
            title: "Confirm action",
            buttons: {
                Yes: function () {
                    $(this).dialog("close");
                    originalDoPostBack(sender, args);
                },
                Cancel: function () {
                    $(this).dialog("close");
                }
            }
        });
    };
</script> 
```

如果您只想为特定按钮明确调用确认，您可以使用下面的脚本（可能放在标题中）

```
function confirmPostBack(sender, args) {
    $("#dialog").dialog({
        modal: true,
        title: "Confirm action",
        buttons: {
            Yes: function () {
                $(this).dialog("close");
                __doPostBack(sender.name, args || "");
            },
            Cancel: function () {
                $(this).dialog("close");
            }
        }
    });
    return false;
}

<asp:Button runat="server" Text="Click Me" OnClientClick="return confirmPostBack(this)" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T15:43:47.553

几个月前我不得不解决这个问题。我想在一个表单上有多个按钮，也许在一个取消按钮上加上一个模板化的转发器，并让它们都正确地要求适当的确认，并根据用户操作提交表单或取消。以下控件可以根据需要多次包含在表单中。它继承自`System.Web.UI.WebControls.LinkButton`并使用控件的 PostbackEventReference 来知道如果确认要提交哪个控件。`System.Web.UI.WebControls.Button`如果您愿意，该控件可以轻松继承。我选择使用链接按钮，因为它的操作非常类似于按钮 Web 控件，但不会发出`<input type=submit>`无法在不使用控件适配器的情况下使用 jQuery UI 使用图标设置样式的按钮。

```
/// <summary>
///     A <see cref="T:System.Web.UI.WebControls.LinkButton"/> with added jQuery UI functionality to provide a modal dialog box to cancel the form submit client side.
/// </summary>
/// <remarks>This class requires the inclusion of jQueryUI</remarks>
[DefaultProperty("Text")]
[ToolboxData("<{0}:jQueryUIConfirmedLinkButton runat=\"server\"></{0}:jQueryUIConfirmedLinkButton>")]
public class jQueryUIConfirmedLinkButton : LinkButton
{
    /// <summary>
    ///     Holds the postback event reference data so that the emitted client script can execute the postback if the user confirms the action.
    /// </summary>
    protected string eventReference = null;

    /// <summary>
    ///     Gets or sets the emitted dialog's ID attribute.
    /// </summary>
    /// <value>
    ///     The dialog's ID attribute.
    /// </value>
    [Bindable(true)]
    [Category("Appearance")]
    [DefaultValue("dialog")]
    [Localizable(true)]
    public string DialogCssID
    {
        get
        {
            String s = (String)ViewState["DialogCssID"];
            return ((s == null) ? String.Empty : s);
        }
        set
        {
            ViewState["DialogCssID"] = value;
        }
    }

    internal protected string DialogID
    {
        get
        {
            return String.Format("{0}_{1}", this.ClientID, DialogCssID);
        }
    }

    /// <summary>
    ///     Gets or sets the content of the dialog. This can be plain text or HTML.
    /// </summary>
    /// <value>
    ///     The HTML or plain text content of the dialog.
    /// </value>
    [Bindable(true)]
    [Category("Appearance")]
    [DefaultValue("<p>Are you sure?</p>")]
    [Localizable(true)]
    public string DialogContent
    {
        get
        {
            String s = (String)ViewState["DialogContent"];
            return ((s == null) ? String.Empty : s);
        }
        set
        {
            ViewState["DialogContent"] = value;
        }
    }

    /// <summary>
    ///     Gets or sets the title that will appear on the dialog.
    /// </summary>
    /// <value>
    /// The dialog's title.
    /// </value>
    [Bindable(true)]
    [Category("Appearance")]
    [DefaultValue("Confirm Action")]
    [Localizable(true)]
    public string DialogTitle
    {
        get
        {
            String s = (String)ViewState["DialogTitle"];
            return ((s == null) ? String.Empty : s);
        }
        set
        {
            ViewState["DialogTitle"] = value;
        }
    }

    /// <summary>
    ///     Gets or sets the text that will appear on the confirmation button.
    /// </summary>
    /// <value>
    ///     The text that will appear on dialog's confirmation button.
    /// </value>
    [Bindable(true)]
    [Category("Appearance")]
    [DefaultValue("Yes")]
    [Localizable(true)]
    public string DialogConfirmButtonText
    {
        get
        {
            String s = (String)ViewState["DialogConfirmButtonText"];
            return ((s == null) ? String.Empty : s);
        }
        set
        {
            ViewState["DialogConfirmButtonText"] = value;
        }
    }

    /// <summary>
    ///     Gets or sets the text that will appear on the dialog's rejection button.
    /// </summary>
    /// <value>
    ///     The text that appears on the dialog's rejection button.
    /// </value>
    [Bindable(true)]
    [Category("Appearance")]
    [DefaultValue("No")]
    [Localizable(true)]
    public string DialogRejectButtonText
    {
        get
        {
            String s = (String)ViewState["DialogRejectButtonText"];
            return ((s == null) ? String.Empty : s);
        }
        set
        {
            ViewState["DialogRejectButtonText"] = value;
        }
    }

    /// <summary>
    ///     Raises the <see cref="E:System.Web.UI.Control.Load" /> event. Emits the necessary client script for the control to function.
    /// </summary>
    /// <param name="e">The <see cref="T:System.EventArgs" /> object that contains the event data.</param>
    protected override void OnLoad(EventArgs e)
    {
        base.OnLoad(e);
        this.eventReference = Page.ClientScript.GetPostBackEventReference(this, string.Empty);
        Page.ClientScript.RegisterStartupScript(this.GetType(), string.Format("{0}{1}", this.ClientID, "-DialogScript"), this.GetClientScript(), true);
        Page.ClientScript.RegisterClientScriptBlock(this.GetType(), string.Format("{0}{1}", this.ClientID, "-DialogShowScript"), string.Format("function {0}Confirm() {{$('#{0}').dialog('open');}}", this.DialogID), true);
        this.OnClientClick = String.Format("{0}Confirm();return false;", this.DialogID);
    }

    /// <summary>
    ///     Renders the contents of the control to the specified writer. Adds the dialog HTML container to the output stream.
    /// </summary>
    /// <param name="writer">A <see cref="T:System.Web.UI.HtmlTextWriter" /> object that represents the output stream to render HTML content on the client.</param>
    protected override void RenderContents(HtmlTextWriter writer)
    {
        base.RenderContents(writer);
        writer.AddAttribute("id", this.DialogID);
        writer.RenderBeginTag("div");
        writer.Write(this.DialogContent);
        writer.RenderEndTag();
    }

    public override void RenderEndTag(HtmlTextWriter writer)
    {
        base.RenderEndTag(writer);
    }

    /// <summary>
    ///     Gets the client script.
    /// </summary>
    /// <returns>A string that will be output to the client as script</returns>
    private string GetClientScript()
    {
        return string.Format(@"$(function () {{

                            $('#{0}').dialog({{
                                autoOpen: false,
                                modal: true,
                                resizable: false,
                                buttons: {{
                                    '{1}': function () {{
                                        $(this).dialog('close');
                                        eval({2});
                                    }},
                                    '{3}': function () {{
                                        $(this).dialog('close');
                                    }}
                                }},
                                title: '{4}'
                            }});
                          }});", this.DialogID, this.DialogConfirmButtonText, this.eventReference, this.DialogRejectButtonText, this.DialogTitle);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-20T00:07:33.573

我最近使用过这个，虽然它只适用于链接按钮。如果您愿意，您可以将它们（毕竟它们只是锚）设置为看起来像 html 按钮。

js

```
$(function () {
    $("#confirmMe").click(function (e) {
        e.preventDefault();
        var $anchor = $(this);
        $("<div>Are you sure you want to do that?</div>").dialog({
            title: "Confirm",
            modal: true,
            buttons: {
                "Ok": function () {
                    window.location = $anchor.attr("href");
                },
                "Cancel": function () {
                    $(this).dialog("close");
                }
            }
        });
    });
}); 
```

.net 标记（如果单击确定，将引发确认Me_Click 事件）

```
<asp:LinkButton Text="Open Me" runat="server" ID="confirmMe" 
    ClientIDMode="Static" onclick="confirmMe_Click" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-15T16:37:27.453

这些是我的两分钱，适用于我的项目：

```
 // Initialices the behaviour when the page is ready
    $(function() {
        // Sets the function to be called when the confirmation button is pressed          
        $('.jqConfirmacionBorrar').click(function(e) {
            // Prevents the default behaviour of the button
            e.preventDefault();
            // Gets the name of the button that was clicked
            var ControlClickedName = $(this).attr('name');
            // Sets up the dialog to be called, with some custom parameters.
            // The important one is to do the postback call when the confirmation
            // button ('Aceptar' in spanish) is clicked.
            $("#DivConfirmacion").dialog({
                width: 650,
                modal: true,
                draggable: true,
                autoOpen: false,
                buttons: {
                    'Cancelar': function() {
                        $(this).dialog('close');
                        return false;
                    },
                    'Aceptar': function() {
                        $(this).dialog('close');
                        __doPostBack(ControlClickedName, '');
                        return true;
                    }
                }
            });
            // Opens the dialog to propt the user for confirmation
            $('#DivConfirmacion').dialog('open');
        });
    }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T17:16:44.163

不久前我想出了这项工作，所以不确定它是否仍然与最新的 jquery-ui 对话框插件保持同步，但你明白了。它使（不幸的）用于`eval`执行 javascript asp.net 生成以提交放置在锚的 href 中的表单。你只需要给锚点的 css 类`confirm-required`。

```
<div class="confirm-dialog ui-helper-hidden" title="Confirm">
    <span class="ui-icon ui-icon-alert"></span>
    <p>Are you sure?</p>
</div>

<script language="javascript" type="text/javascript">

$(function(){
    // call confirm dialog boxes from buttons that require it
    $(".confirm-required:isactive").click(function () {
        var callback = $(this).attr("href");
        return showConfirmDialog(callback);
    });
});

this.showConfirmDialog = function (callback) {
    $(".confirm-dialog").dialog("destroy");
    $(".confirm-dialog").dialog({
        autoOpen: true,
        modal: true,
        buttons: {
            "OK": function () {
                $(this).dialog("close");
                eval(callback);
            },
            "Cancel": function () {
                $(this).dialog("close");
            }
        }
    });

    return false;
};

</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-20T16:46:56.863

我承认这有点冗长，但以下适用于我能想到的每种情况：

```
$(document).ready(function () {
    'use strict';
    var getParsedPostback = function getParsedPostback(self) {
        /*
         * self is a jQuery object. The purpose of this function is to extract the
         * __doPostBack function or the WebForm_DoPostBackWithOptions function as a
         * string, parse out the component arguments, and return it as a different
         * function to be used as a callback. If the postback function does not exist
         * as a string (in the case of a submit button, for instance) then the
         * returned callback should unbind any click handlers and then trigger the
         * element's click event.
         */
        var postback = self.data('postback'),
            trimLeft = /^\s+/,
            trimRight = /\s+$/,
            startingQuote = /^['"]/,
            endingQuote = /['"]$/,
            eventTarget,
            eventArgument,
            validation,
            validationGroup,
            actionUrl,
            trackFocus,
            clientSubmit;
        if (postback.substring(postback.length - 1, postback.length) === ';') {
            //remove the trailing ";"
            postback = postback.substring(0, postback.length - 1);
        }
        if (postback.indexOf('javascript:') === 0) {
            //remove the "javascript:"
            postback = postback.substring(('javascript:').length, postback.length - 1);
        }
        //in case postback is in the form __doPostBack(&#39;XXXXXX&#39;,&#39;XXXXXX&#39;)
        postback = decodeURIComponent(postback);
        //parse by case
        if (postback.indexOf('__doPostBack(') === 0) {
            //postback should now be __doPostBack('XXXXXX','XXXXXX')
            postback = postback.substring(('__doPostBack(').length, postback.length - 2);
            postback = postback.split(',');
            eventTarget = encodeURIComponent(postback[0].replace(startingQuote, '').replace(endingQuote, ''));
            eventArgument = encodeURIComponent(postback[1].replace(startingQuote, '').replace(endingQuote, ''));
            postback = function () {
                __doPostBack(eventTarget, eventArgument);
            };
        } else if (postback.indexOf('WebForm_DoPostBackWithOptions(') === 0) {
            //postback should now be WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions('XXXXXX', 'XXXXXX', 'XXXXXX', 'XXXXXX', 'XXXXXX'))
            postback = postback.substring(('WebForm_DoPostBackWithOptions(').length, postback.length - 2);
            postback = postback.split(',');
            eventTarget = encodeURIComponent(postback[0].replace(startingQuote, '').replace(endingQuote, ''));
            eventArgument = encodeURIComponent(postback[1].replace(startingQuote, '').replace(endingQuote, ''));
            validation = !!postback[2].replace(startingQuote, '').replace(endingQuote, '');     //use !! to convert string to boolean
            validationGroup = encodeURIComponent(postback[3].replace(startingQuote, '').replace(endingQuote, ''));
            actionUrl = encodeURIComponent(postback[4].replace(startingQuote, '').replace(endingQuote, ''));
            trackFocus = !!postback[5].replace(startingQuote, '').replace(endingQuote, '');     //use !! to convert string to boolean
            clientSubmit = !!postback[6].replace(startingQuote, '').replace(endingQuote, ''); //use !! to convert string to boolean
            postback = function () {
                __doPostBack(new WebForm_PostBackOptions(eventTarget, eventArgument, validation, validationGroup, actionUrl, trackFocus, clientSubmit));
            };
        } else if (postback === 'submit') {
            //no apparent postback handler, must be a submit or an image
            postback = function () {
                //unbind the assigned click handler
                self.unbind('click');
                //trigger the click event
                self.click();
            };
        }
        return postback;
    };
    var clickHandler = function clickHandler(e) {
        var postback = getParsedPostback($(this)); //get the postback as a callback
        $('div#dialog').dialog('option', {
            "buttons": {
                "Delete all items": function () {
                    $(this).dialog('close');
                    postback(); //call the postback
                },
                "Cancel": function () {
                    $(this).dialog('close');
                }
            }
        }).dialog('open');
        e.preventDefault();
        return false;
    };
    var storePostbacks = function storePostbacks() {
        /*
         * The purpose of this function is to remove any existing __doPostBack functions
         * or WebForm_DoPostBackWithOptions functions and store them in the "data" for
         * the element. The "getParsedPostback" function above wil make extensive use of
         * the element's "data" to parse a usable callback for postback.
         */
        $('input[type="submit"], input[type="button"], input[type="image"], a[href*="__doPostBack"]').each(function (i, elem) {
            var self = $(elem),
            postback = '';
            if (typeof self.attr('onclick') !== 'undefined') {
                //store the postback in data and remove from the element.
                postback = self.attr('onclick');
                self.removeAttr('onclick').data('postback', postback);
            } else if (typeof self.attr('href') !== 'undefined') {
                //store the postback in data and remove from the element.
                postback = self.attr('href');
                self.attr('href', '#').data('postback', postback);
            } else if (self.attr('type') === 'submit' || self.attr('type') === 'image') {
                //flag as a submit.
                self.data('postback', 'submit');
            }
        });
    };
    storePostbacks();
    $('input#<%#aspButton1.ClientID %>').click(clickHandler);
    $('input#<%#aspButton2.ClientID %>').click(clickHandler);
    $('input#<%#aspImageButton.ClientID %>').click(clickHandler);
    $('a#<%#aspLinkButton.ClientID %>').click(clickHandler);
    $('div#dialog').dialog({
        "autoOpen": false
    });
}); 
```

使用带有 jQ​​uery 1.8.2 和 jQueryUI 1.9.0 的 ASP.Net 4.0 框架对以下标记进行了测试：

```
<body>
    <form id="form1" runat="server">
    <div>
        <div id="dialog">
            <p>Test of dialog.</p>
        </div>
        <div id="controls">
            <asp:Button ID="aspButton1" runat="server" Text="aspButton1" />
            <asp:LinkButton ID="aspLinkButton" runat="server">LinkButton</asp:LinkButton>
            <asp:ImageButton ID="aspImageButton" runat="server" />
            <asp:Button ID="aspButton2" runat="server" Text="aspButton2" />
        </div>
    </div>
    </form>
</body> 
```

# java - 缺少资源异常 websphere 门户

> ID：12977831
> 
> 赞同：1
> 
> 时间：2012-10-19T15:45:12.467
> 
> 标签：java, websphere, portal, websphere-portal

`Error 500: java.util.MissingResourceException: Can't find resource for bundle com.ibm.abc.nl.abcdf, key en_US`.

我得到了这个例外。我有包`abcdf_en`下的属性文件`com.ibm.abc.nl`。我不确定是否必须在 Websphere Portal 服务器或 WAS 中设置我的本地语言。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T04:59:19.023

该消息说这`en_US`是在属性文件中找不到的**实际密钥。**换句话说，您的属性文件（包`abcdf_en.properties`内的 , `com.ibm.abc.nl`）应该在那里有一个键值对，键是`en_US`.

如果你有钥匙`en_US`（钥匙的名字很奇怪......），那么这意味着`abcdf_en`没有被拿起。这是因为属性文件不在类路径中，或者 WebSphere Portal 不认为`en`是当前请求的语言环境。您是否尝试打印出 的值`request.getLocale()`？

如果值为 ，`request.getLocale()`则`null`可以解释您遇到的症状。

# jquery - 修改ajax请求的结果

> ID：12977837
> 
> 赞同：0
> 
> 时间：2012-10-19T15:45:38.400
> 
> 标签：jquery, ajax, filecontentresult

是否可以使用 ajax 请求检索一些（在这种情况下）文本并在将其显示在例如 div 之前对其进行修改？

我有以下代码

```
$.ajax({url: "Files/" + par + ".php",
success: function(result){
    $("#box").html(result);
} 
```

其中 par 是一个参数（例如 foo）。这将检索文件 foo.php 并将获得的文件内容放在一个名为 box 的 div 中。

现在我想知道您是否可以执行以下操作：
假设 foo.php 的内容如下：

> # 一些标题
> 
> 这里有一些文字...
> 
> ## 一个副标题
> 
> 更多文字......

是否可以在标题和文本之间放置一些代码或句子？所以结果会是这样的：

> # 一些标题
> 
> *这句话在*
> 这里添加了一些文字...
> 
> ## 一个副标题
> 
> 更多文字...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:50:44.507

是的，一点没错。

```
success: function(result){
    result = result.replace("some text here...", 
        "<i>This sentence was added</i><br />some text here...");
    $("#box").html(result);
} 
```

# c# - 带有委托的 QueueUserWorkItem 不起作用，但 WaitCallBack 确实起作用

> ID：12977838
> 
> 赞同：4
> 
> 时间：2012-10-19T15:45:48.057
> 
> 标签：c#, multithreading, delegates

在下面的问题中，我发现了一个以类型安全的方式调用 QueueUserWorkItem 的巧妙技巧，您可以在其中传递一个委托而不是 WaitCallBack 和一个对象。然而，它并不像人们期望的那样工作。

[QueueUserWorkItem() 和 BeginInvoke() 之间有什么区别，用于执行不需要返回类型的异步活动](https://stackoverflow.com/questions/532791/whats-the-difference-between-queueuserworkitem-and-begininvoke-for-perform)

这是一些演示该问题的示例代码和输出。

```
for (int i = 0; i < 10; ++i)
{
    // doesn't work - somehow DoWork is invoked with i=10 each time!!!
    ThreadPool.QueueUserWorkItem(delegate { DoWork("closure", i); });

    // not type safe, but it works
    ThreadPool.QueueUserWorkItem(new WaitCallback(DoWork), Tuple.Create("    WCB", i));
}

void DoWork(string s, int i)
{
    Console.WriteLine("{0} - i:{1}", s, i);
}

void DoWork(object state)
{
    var t = (Tuple<string, int>)state;
    DoWork(t.Item1, t.Item2);
} 
```

这是输出：

```
closure - i:10
    WCB - i:0
closure - i:10
    WCB - i:2
    WCB - i:3
closure - i:10
    WCB - i:4
closure - i:10
    WCB - i:5
closure - i:10
    WCB - i:6
closure - i:10
    WCB - i:7
closure - i:10
    WCB - i:8
closure - i:10
    WCB - i:9
    WCB - i:1
closure - i:10 
```

请注意，当使用闭包调用 QueueUserWorkitem 时，i=10 永远调用，但是当使用 WaitCallBack 时，您会得到正确的值，0-9。

所以我的问题是：

1.  为什么在使用闭包/委托方式时没有传递正确的 i 值？
2.  我到底是怎么到10岁的？在循环中，它只有值 0-9 对吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T15:51:59.467

您的两个问题的答案都与您创建匿名方法时的闭包范围有关。

当你这样做时：

```
// Closure for anonymous function call begins here.
for (int i = 0; i < 10; ++i)
{
    // i is captured
    ThreadPool.QueueUserWorkItem(delegate { DoWork("closure", i); });
} 
```

您正在捕获`i`整个*循环*。这意味着您*非常*快速地将十个线程排队，当它们开始时，闭包已捕获`i`为 10。

为了解决这个问题，您可以通过*在循环*中引入一个变量来缩小闭包的范围，如下所示：

```
for (int i = 0; i < 10; ++i)
{
    // Closure extends to here.
    var copy = i;

    // **copy** is captured
    ThreadPool.QueueUserWorkItem(delegate { DoWork("closure", copy); });
} 
```

在这里，闭包并没有超出循环，而只是延伸到里面的值。

也就是说，对 的第二次调用会[`QueueUserWorkItem`](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx)产生所需的结果，因为您在[`Tuple<T1, T2>`](http://msdn.microsoft.com/en-us/library/dd268536.aspx)委托排队时创建了 ，该值在该点是固定的。

请注意，[在 C# 5.0 中， for 的行为发生了`foreach`变化，因为它经常发生（闭包关闭循环）并导致许多人非常头疼](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)（但`for`不像你正在使用的那样）。

如果你想利用这个事实，你可以调用[类](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx)上的[`Range`方法](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.range.aspx)来使用：[`Enumerable`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx)`foreach`

```
foreach (int i in Enumerable.Range(0, 10))
{
    // Closure for anonymous function call begins here.
    ThreadPool.QueueUserWorkItem(delegate { DoWork("closure", i); });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:52:11.410

这是因为如何捕获变量：委托将`i`在实际执行时获取值，而不是在声明时，所以到那时它们都是 10。尝试复制到局部变量：

```
for (int i = 0; i < 10; ++i)
{
    int j = i;        
    ThreadPool.QueueUserWorkItem(delegate { DoWork("closure", j); }); 
```

# php - PHPexplode()函数的使用

> ID：12977840
> 
> 赞同：2
> 
> 时间：2012-10-19T15:46:04.097
> 
> 标签：php, explode

我有一个问题，我想使用 explode 函数拆分一个字符串变量，但有一个限制，想象下一个字符串变量具有下一个值：

```
$data = "3, 18, 'My name is john, i like to play piano'"; 
```

使用explode函数：explode(",", $data)，输出将是：

```
array(
       [0] => 3,
       [1] => 18,
       [2] => 'My name is john,
       [3] => i like to play piano'
      ); 
```

我的目标是用逗号分隔变量 $data ，不包括“ ”聊天者之间的变量。

例如`array( [0] => 3, [1] => 18, [2] => 'My name is john, i like to play piano' );`

如果有人能告诉我这样做的方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T15:49:20.770

这看起来很像 CSV 数据。您可以使用[str_getcsv](http://php.net/str_getcsv)来解析它。

```
var_dump(str_getcsv("3, 18, 'My name is john, i like to play piano'", ',', "'")); 
```

应该导致：

```
array(3) {
  [0] =>
  string(1) "3"
  [1] =>
  string(3) " 18"
  [2] =>
  string(12) "My name is john, i like to play piano"
} 
```

您可能还想`trim`通过使用以下方式应用到每个数组元素`array_map`：

```
$string = "3, 18, 'My name is john, i like to play piano'";
var_dump(array_map('trim', str_getcsv($string, ',', "'"))); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-19T15:49:52.710

使用：**[str_getcsv](http://php.net/manual/en/function.str-getcsv.php)**

```
// set the delimiter with ',', and set enclosure with single quote
$arr = str_getcsv ($data, ',', "'"); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-19T15:49:34.160

您可以将[str_getcsv()](http://php.net/manual/en/function.str-getcsv.php)函数用作：

```
$data = "3, 18, 'My name is john, i like to play piano'";
$pieces = str_getcsv($data, ',', "'"); 
```

该函数的第一个参数是要拆分的字符串。

第二个参数是您需要拆分的分隔符。

第三个参数是单个字符，当在第一个参数中用作一对（未转义）时，将被视为一个字段，有效地忽略了这对之间的分隔符。

# c# - Propvariant 到变体 C#

> ID：12977843
> 
> 赞同：1
> 
> 时间：2012-10-19T15:46:12.573
> 
> 标签：c#, variant

我是这方面的新手。我正在尝试将 propvariant 转换为 C# 中的变体

我有这样的代码。

```
 public static object PropValueToVariant(PROPVARIANT Value)
    {
        object result;
        DateTime stTime;
        DateTime ftTime;
        object __Null;
        // Convert the prop variant to variant data type

        switch(Value.vt)
        {
            //@ Undeclared identifier(3): 'VT_I1'
            case VT_I1:
                //@ Unsupported property or method(C): 'bVal'
                result = Value.bVal;
                break;
            //@ Undeclared identifier(3): 'VT_UI1'
            case VT_UI1:
                //@ Unsupported property or method(C): 'bVal'
                result = Value.bVal;
                break;
            //@ Undeclared identifier(3): 'VT_I2'
            case VT_I2:
                //@ Unsupported property or method(C): 'iVal'
                result = Value.iVal;
                break;
            //@ Undeclared identifier(3): 'VT_UI2'
            case VT_UI2:
                //@ Unsupported property or method(C): 'uiVal'
                result = Value.uiVal;
                break;
            //@ Undeclared identifier(3): 'VT_I4'
            case VT_I4:
                //@ Unsupported property or method(C): 'lVal'
                result = Value.lVal;
                break;
            //@ Undeclared identifier(3): 'VT_UI4'
            case VT_UI4:
                //@ Unsupported property or method(C): 'ulVal'
                result = ((int)Value.ulVal);
                break;
            //@ Undeclared identifier(3): 'VT_I8'
            case VT_I8:
                //@ Unsupported property or method(C): 'hVal'
                //@ Unsupported property or method(D): 'LowPart'
                result = ((int)Value.hVal.LowPart);
                break;
            //@ Undeclared identifier(3): 'VT_UI8'
            case VT_UI8:
                //@ Unsupported property or method(C): 'uhVal'
                //@ Unsupported property or method(D): 'LowPart'
                result = ((int)Value.uhVal.LowPart);
                break;
            //@ Undeclared identifier(3): 'VT_BOOL'
            case VT_BOOL:
                //@ Unsupported property or method(C): 'boolVal'
                result = Value.boolVal;
                break;
            //@ Undeclared identifier(3): 'VT_R4'
            case VT_R4:
                //@ Unsupported property or method(C): 'fltVal'
                result = Value.fltVal;
                break;
            //@ Undeclared identifier(3): 'VT_R8'
            case VT_R8:
                //@ Unsupported property or method(C): 'dblVal'
                result = Value.dblVal;
                break;
            //@ Undeclared identifier(3): 'VT_CY'
            case VT_CY:
                //@ Unsupported property or method(C): 'cyVal'
                result = Value.cyVal;
                break;
            //@ Undeclared identifier(3): 'VT_ERROR'
            case VT_ERROR:
                //@ Unsupported property or method(C): 'scode'
                result = Value.scode;
                break;
            //@ Undeclared identifier(3): 'VT_DATE'
            case VT_DATE:
                //@ Unsupported property or method(C): 'date'
                result = Value.date;
                break;
            //@ Undeclared identifier(3): 'VT_FILETIME'
            case VT_FILETIME:
                //@ Unsupported property or method(C): 'filetime'
                //@ Unsupported function or procedure: 'FileTimeToLocalFileTime'
                FileTimeToLocalFileTime(Value.filetime, ftTime);
                //@ Undeclared identifier(3): 'FileTimeToSystemTime'
                FileTimeToSystemTime(ftTime, stTime);
                result = stTime;
                break;
            //@ Undeclared identifier(3): 'VT_CLSID'
            case VT_CLSID:
                //@ Unsupported property or method(C): 'puuid'
                result = Value.puuid.ToString();
                break;
            //@ Undeclared identifier(3): 'VT_BSTR'
            case VT_BSTR:
                //@ Unsupported property or method(C): 'bstrVal'
                result = Value.bstrVal;
                break;
            //@ Undeclared identifier(3): 'VT_LPSTR'
            case VT_LPSTR:
                //@ Unsupported property or method(C): 'pszVal'
                result = (Value.pszVal as string);
                break;
            //@ Undeclared identifier(3): 'VT_LPWSTR'
            case VT_LPWSTR:

                result = WideCharToString(Value.pwszVal);
                break;
            default:
                result = __Null;
                break;
        }
        return result;
    } 
```

为什么我收到案例名称错误？它也不理解 ulval、lval 等....

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-15T14:30:47.533

您应该使用`Marshal`该类和几个 P/Invoke 调用：

*   分配一个 16 字节数组（例如，通过`AllocCoTaskMem`）（**编辑：**为 64 位进程设置 24 字节）
*   通过 P/Invoke 调用将其归零`VariantInit`
*   然后进行实际转换，使用对[PropVariantToVariant](https://msdn.microsoft.com/en-us/library/windows/desktop/bb776577(v=vs.85).aspx)的 P/Invoke 调用来用变体数据填充此缓冲区
*   您现在可以通过`Marshal.GetObjectForNativeVariant`
*   不要忘记清理：
    *   AP/调用呼叫`PropVariantClear`
    *   另一个到`VariantClear`
    *   然后用`Marshal.FreeCoTaskMem`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-19T16:08:40.147

你不需要这个功能，这里是已经在 .net 框架中实现的功能：http: [//msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getobjectfornativevariant.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getobjectfornativevariant.aspx)

# c# - 是否有与 Android 的 runOnUiThread 等效的 C#/Windows 窗体？

> ID：12977844
> 
> 赞同：3
> 
> 时间：2012-10-19T15:46:14.697
> 
> 标签：c#, winforms, multithreading

是否有与 Android 的[runOnUiThread](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)等效的 C#/Windows 窗体？

例如，假设我在工作线程上运行（长时间运行）任务，最后我想将结果发布到 GUI 控件（当然我不能从工作线程中做到这一点）。是否有一个像[runOnUiThread](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)这样简单的函数可以让我发布刷新显示以供 UI 线程处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:50:14.533

WinForms 中的每个控件都继承了`Invoke`和`BeginInvoke`方法。

[Invoke](http://msdn.microsoft.com/en-us/library/zyzhdc6b.aspx)将同步运行委托，而[BeginInvoke](http://msdn.microsoft.com/en-us/library/0b1bf3y3.aspx)将异步运行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:54:11.223

执行此操作的典型方法是使用 System.Windows.Forms.Control：

```
control.BeginInvoke((MethodInvoker)delegate { ... }); 
```

但是，控件的句柄必须已经在 UI 线程上初始化。一个简单的

```
IntPtr ignored = control.Handle; 
```

在 UI 线程上将实现这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:49:50.507

看`Control.Invoke`方法。

来自 MSDN：“在拥有控件的基础窗口句柄的线程上执行指定的委托。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T15:50:00.560

如果您可以访问 winforms 控件或表单，只需在该控件或表单上调用[`Control.Invoke`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invoke.aspx)或[`Control.BeginInvoke`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)。

# javascript - 通过设置文件名的javascript在html页面中上传文件

> ID：12977847
> 
> 赞同：0
> 
> 时间：2012-10-19T15:46:18.353
> 
> 标签：javascript, file-upload

在 html 页面中，我输入了 type='text' 和一个按钮

```
filename: [             ] 

[PUSH] 
```

用户去并用“C：\ test.txt”填充文件名当按下按钮时，（onclick），我想写一些javascript来上传文件

（例如：c:\test.txt）并提交到服务器。

显然，输入类型文件将被隐藏并以编程方式进行编辑。

这是可行的还是有任何限制？

这个想法是用户不必去使用输入类型文件并且总是去打开对话框

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:49:04.577

您运行的 javascript 无法访问客户端的文件系统，这是一件好事。请改用`type="file"`与用户操作系统交互的输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:49:20.293

您不能在上传前操纵文件名。您必须在服务器上执行此操作。这是防止浏览器上传任意文件的安全措施。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:50:06.763

据我了解您的问题，您希望启用从本地磁盘中选择文件名并上传它而无需用户先选择它？

那么答案是**否定**的。出于安全原因，您不能这样做，JS 无法访问您的本地磁盘。

此外，您不能通过 JavaScript 上传文件，您还需要一些服务器端代码来执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-20T15:07:33.470

出于安全原因，您不能使用 JavaScript 执行此操作。但是还有许多其他的上传工具（例如 Java Applets、ActiveX 或 Flash）Web 组件可以“理论上”做到这一点。

我建议您搜索“文件传输 java 小程序”。

有一篇博客文章解释和比较了其中一些网络上传组件。看看[http://www.filecatalyst.com/comparison-of-web-based-file-transfer-methodologies](http://www.filecatalyst.com/comparison-of-web-based-file-transfer-methodologies)

# asp.net - 根据其他列减去表的同一列的值

> ID：12977862
> 
> 赞同：1
> 
> 时间：2012-10-19T15:47:13.360
> 
> 标签：asp.net, sql-server-2008, c#-4.0

我有一个标签`InvoiceOrderDetails`。它具有以下列：

```
InvoiceNumber
RecType
Amount
ProjectCode 
```

同一个发票号码可以有多个`projectCode`。`RecType`表示客户是否已全额付款。

例如：总发票金额为`Project XYZ`9000 美元。客户支付了第一期 3000 美元。现在将发送给客户的下一张发票是 6000 美元。此外，如果`Rectype`为 1 则表示已全额付款，否则仍有未结余额。

现在我必须创建一个计算列并将其显示在我想向客户端显示剩余金额的网格中。这意味着，我必须检查`RECTYPe`所有发票，并从 rectype 2`ProjectCode`的金额中减去1 的金额。`Rectype`

我无法获得如何计算列并在网格中显示。我正在使用 Asp.Net (C# 2010) 和 SQL Server 2008。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:50:45.483

假设您正在绑定到网格，在网格的行数据绑定事件中，您可以计算所有发票的总数并将其存储为全局变量。这将在最后为您提供总发票。

如果您要创建一个运行总计列，那么在同一个数据绑定事件中，您可以将该列中的标签值设置为等于到目前为止的计算值减去项目的总数。

# django-cms - Django-CMS：占位符中的插件位置

> ID：12977863
> 
> 赞同：4
> 
> 时间：2012-10-19T15:47:13.797
> 
> 标签：django-cms

我正在寻找一种方法来检查插件在 Django-CMS 占位符中的位置。我发现这个问题[Detect last plugin in a placeholder](https://stackoverflow.com/questions/5543947/detect-last-plugin-in-a-placeholder)

“插件”是 django cms 关键字吗？我找不到有关它的文档。

我的问题是：如何获取有关占位符中呈现的插件的信息？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-03T12:31:59.277

如果您不覆盖您的插件渲染方法（2.4 及更高版本），您将`instance`在您的上下文中拥有您的插件。使用以下内容，您将获得插件的基于 1 的位置：

`{{ instance.get_position_in_placeholder }}`

也很有趣：`is_first_in_placeholder`和`is_last_in_placeholder`。事实上，@paulo 已经在他的评论中向你展示了方向；）这是代码，带有新的行号：[https ://github.com/divio/django-cms/blob/develop/cms/models/pluginmodel.py #L382](https://github.com/divio/django-cms/blob/develop/cms/models/pluginmodel.py#L382)

# css - 具有不同不透明度的重叠 CSS 元素

> ID：12977866
> 
> 赞同：0
> 
> 时间：2012-10-19T15:47:23.657
> 
> 标签：css, opacity

我试图在也具有透明度的背景上重叠一些具有透明度的文本字段，问题是文本字段看起来不透明，就好像它们没有应用透明度一样，我该如何管理字段和背景都出现一定的透明度？

这是包含所有内容的 div：

```
#wrapper {                                                                                                                                                              
  width: 940px;                                                                                                                                                         
  margin: 0 auto;                                                                                                                                                       
  background: rgba(0, 0, 0, 0.6);                                                                                                                                       
} 
```

这是我的输入字段：

```
input[type=text] {                                                                                                                                                      
  -webkit-border-radius: 5px;                                                                                                                                           
  -moz-border-radius: 5px;                                                                                                                                              
  border-radius: 5px;                                                                                                                                                    
  height: 30px;                                                                                                                                                         
  padding-top: 5px;                                                                                                                                                     
  background: rgba(0, 0, 0, 0.8);                                                                                                                                       
  color: white;                                                                                                                                                         
  border: 1px solid black;                                                                                                                                              
} 
```

这是它的外观：

![在此处输入图像描述](../Images/6f7dca30dc5789b97707f61f626b9470.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:54:01.017

看起来它是透明度堆叠的问题，要在输入框上获得 0.8 的透明度，您只需要向输入添加进一步的 0.2 透明度（因为它有效地继承了您需要的 0.8 中的 0.6 来自其包含元素。 看这里：

[http://jsfiddle.net/e6Z8N/1/](http://jsfiddle.net/e6Z8N/1/)

html:

```
<div id="wrapper">
<input type="text" />
</div>​ 
```

CSS：

```
#wrapper {                                                                                                                                                              
width: 940px;                                                                                                                                                         
  margin: 0 auto;                                                                                                                                                       
  background: rgba(0, 0, 0, 0.6);
padding:50px;    
}  

input[type=text] {                                                                                                                                                      
  -webkit-border-radius: 5px;                                                                                                                                           
  -moz-border-radius: 5px;                                                                                                                                              
  border-radius: 5px;                                                                                                                                                    
  height: 30px;                                                                                                                                                         
  padding-top: 5px;                                                                                                                                                     
  background: rgba(0, 0, 0, 0.2);                                                                                                                                       
color: white;                                                                                                                                                         
  border: 1px solid black;                                                                                                                                              
} ​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T16:05:34.123

您的代码似乎运行良好，只是看起来并不那么透明，因为黑色背景的 0.8 透明度会产生深灰色，您可能无法将其与完全不透明区分开来。如果您想在本地副本上检查这一点，请应用基本背景图像（例如[http://purelycss.com/data-uri-tileable-transparent-patterns/](http://purelycss.com/data-uri-tileable-transparent-patterns/)），您应该能够在包装器下方看到它和输入字段。

![您的代码有效！](../Images/91e2c48d0366d46857d3bedaf8fd5414.png)

编辑：如果您希望减少“黑底黑”效果，您可能只想降低 'rgba' 的不透明度 - 例如，更像 rgba(0, 0, 0, 0.5) 的东西。如果不是这样，更改基本 RBG 颜色的颜色可能会对您有所帮助。这是您可能只想玩和调整的那些东西之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:58:24.080

您可能需要清除应用于输入元素的默认浏览器样式。

```
-webkit-appearance: none;
-moz-appearance: none;
-o-appearance: none; 
```

# java - 模拟是单元测试的重要组成部分吗？

> ID：12977867
> 
> 赞同：2
> 
> 时间：2012-10-19T15:47:26.123
> 
> 标签：java, web-services, unit-testing, jax-ws

我有一个调用第三方 Web 服务的 Web 服务。

现在我想对我的 Web 服务进行单元测试。为此，我应该模拟第三方 Web 服务还是在测试期间调用它？

有没有关于单元测试的标准文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T15:58:57.120

是的，您应该模拟第三方 Web 服务进行*单元测试*。以下是一些优点：

1.  您的单元测试**独立于其他组件**，实际上只测试单元而不测试 Web 服务。如果您在单元测试中包含该服务并且它们失败了，您将不知道问题出在您的代码中还是在外部 Web 服务中。

2.  您的测试**独立于环境**。如果 Internet 连接中断，或者您想在根本无法访问 Internet 的机器上进行测试，您的测试仍然有效。

3.  如果不实际连接到 Web 服务，**您**的测试会*快得多。* 这可能看起来不是一件大事，但如果你有很多测试（你应该这样做），它真的很烦人。

***   您还可以通过模拟发送意想不到的东西来测试您的单元的**稳健性。**这在现实世界中总是会发生，如果真的发生了，您的 Web 服务应该会做出良好的反应，而不仅仅是崩溃。使用真正的 Web 服务时，无法对其进行测试。** 

 **但是，也有*集成测试*。在那里，您测试完整的设置，将所有组件放在一起（*集成*）。这是您将使用真正的 Web 服务而不是模拟的地方。

Both kinds of testing are important, but unit testing is typically done earlier and more frequently. It can (and should) be done before all components of the system are created. Integration testing requires a minimal amount of progress in all of most of the components.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:53:16.013

这取决于您要进行的*单元测试*。

因此，如果您正在测试是否可以成功与第三方 Web 服务通信，您显然不会尝试模拟这一点。但是，如果您正在对属于您的 Web 服务产品的一些业务用例进行单元测试（*与其他模块/Web 服务正在做的事情无关*），那么您可能想要模拟第三方 Web 服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T16:00:34.717

You should test both but both test cases does not fall under Unit testing.

Unit testing is primarily used for testing individual smaller pieces i.e. classes and methods. Unit testing is something that should preferably happen during the build process without any human intervention. So as part of Unit testing you should mock out the third party webservice. The advantage of mocking is that you can make the mocked object behave in many possible ways and test your classes/methods to make sure they handle all possible cases.

When multiple systems are involved, the test case falls under System/Integration/Functional testing. So as part of your System/Integration/Functional testing, you should call the methods in other webservice from your webservice and make sure everything works as expected.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T15:59:59.240

Mocking is an usually essential in *unit testing* components which have dependent components. This is so because in unit testing , you are limited to testing that *your code* works correctly ( does what its contract says it will do ). If this method , in trying to do the part of its contract depends upon other component doing their part correctly , it is perfectly fine to mock that part out ( assuming that they work correctly ).

If you dont mock the other dependent parts , you soon run into problems. First , you cannot be certain what behavior is exhibited by that component. Second , you cannot predict the results of your own test ( because you dont know what was the inputs supplied to your tests )**

# javascript - 放置 .innerHTML = "" 后数组元素丢失

> ID：12977868
> 
> 赞同：2
> 
> 时间：2012-10-19T15:47:28.120
> 
> 标签：javascript, jquery, html, arrays

在我的 HTML 中，我有一个内容 div，其中包含由 php 脚本创建并使用 JQuery 和 Javascript 处理的文章。使用 Javascript，我使用“getElementsByClassName”函数将这些文章收集到一个数组中。我在这里编写的脚本和 HTML 已经过简化。我需要这个数组，因为我试图使如果数组的长度大于 10，则每页仅显示 10 篇文章。所以第 1 页将是数组的索引 0 到 9，第 2 页的索引是 10 到 19，等等。现在，

拿这个 html 代码。

```
<body>
<div id="content">
  <div class="article">
    <p>Article 1</p>
  </div>
  <div class="article">
    <p>Article 2</p>
  </div>
  <div class="article">
    <p>Article 3</p>
  </div>
</content>
</body> 
```

还有这个 Javascript 代码。

```
$.post("getarticles.php",{ page:"home" } ,function(data){
        //place the content
        document.getElementById("content").innerHTML = jQuery.trim(data);

        //put elements in array
        arrArticles = document.getElementsByClassName("article");
        alert(arrArticles.length);

        document.getElementById("content").innerHTML = "";
        alert(arrArticles.length);
}) 
```

第一个警报给我“3”，这是正确的。但第二个警报给我“0”。为什么在将元素放入其中后数组会丢失其元素？

顺便说一句，“数据”变量是一个由 php 脚本传递的 HTML 字符串。例如：在 php 脚本中我有代码

```
echo "<div class="article"><p>Article 1</p></div><div class="article"><p>Article 2</p></div><div class="article"><p>Article 3</p></div>" 
```

&

```
document.getElementById("contentWrap").innerHTML = ""; 
```

我知道这是导致问题的原因，但我不知道为什么。任何人都可以解释或提供替代方案吗？

提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T15:51:40.787

`getElementsByClassName()`返回一个动态数组（实际上是一个 live `NodeList`），如果/当您修改 DOM 时，它将动态更改。因此，如果您使用 innerHTML 更改内容并且该数组中的元素受到影响，则该数组将自动更改。

如果您想保留此元素列表并使其不活动（因此当 DOM 更改时它不会更改），您可以将 NodeList 的副本复制到普通数组（不是动态的）中，一旦它在普通数组中，对 DOM 元素的引用将防止它们被破坏。如果您的代码更改了它们的内容，它不会阻止它们被更改，但即使您的代码导致它们从 DOM 中删除，它也会保留它们。

将动态副本复制`NodeList`到静态数组中的一种方法是：

```
// fetch dynamic NodeList
var items = document.getElementsByClassName("article");
// make static copy of NodeList into normal array
items = Array.prototype.slice.call(items); 
```

或者，由于您的帖子使用 jQuery 标记，您可以首先使用 jQuery，其中包含不受 DOM 中其他更改影响的静态节点数组：

```
var items = $(".article"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:58:22.367

看起来 document.getElementByClassName 正在返回对元素数组的引用，当您更改标记时该元素数组正在更新。不知道为什么；也许比我更了解的人可以回答这个问题。

使用 jQuery 选择数组对我有用：

```
var arrArticles = $(".article") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:57:43.053

```
document.getElementsByClassName("article"); 
```

返回 [NodeList 数组]，该数组包含指向 DOM 元素的指针

```
arrArticles = anotherArray; 
```

此代码不会创建 anotherArray 的副本，而是创建指向 anotherArray 值的指针。

因此，当 anotherArray 中的元素被删除时，arrArticles 中的元素也会消失。

# javascript - Using a config file for JSHint with Rhino

> ID：12977878
> 
> 赞同：3
> 
> 时间：2012-10-19T15:48:10.037
> 
> 标签：javascript, rhino, jshint

I'm attempting to run jsHint from the command line using Rhino. I want to make the check an automatic part of my teams checkin process.

I have the basic configuration working using the command:

```
java -jar .rhino.jar ./jshint.js ./samplefile.js 
```

That outputs the standard jsHint messages for my (intentionally error-ridden) sample file. And adding config comments to the top of the sample file works correctly. However I would like to add a project level config file to specify the options I want for each file without adding comments to each individual file.

I found instructions to do so for the node.js command line based tool, but have been unable to replicate this with the Rhino wrapper.
I attempted various variations on:

```
java -jar .rhino.jar ./jshint.js ./samplefile.js --configure=./config.js 
```

but that didn't seem to work for the rhino version.
Any pointers?

### UPDATE:

Found [this question (Custom Settings with jshint-rhino)](https://stackoverflow.com/questions/12588643/custom-settings-with-jshint-rhino-js) from a few weeks ago.

This pointed out that the following format works:

```
java -jar .rhino.jar ./jshint.js ./samplefile.js option1=true option2=false global global 
```

This worked for me, however I would like to specify a large amount of options and have it be easily configurable, so I would very much prefer to use a json config file as in the node.js distribution.

Could somebody confirm that this is possible/not possible?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:23:11.983

Unfortunately, our Rhino wrapper is pretty basic and doesn't support config files. It would be nice to have that—perhaps you would like to create a ticket?

# configuration - 用于 X11 转发的 SSH 压缩

> ID：12977879
> 
> 赞同：17
> 
> 时间：2012-10-19T15:48:16.420
> 
> 标签：configuration, ssh, x11

我在美国东海岸，通过 SSH 连接到西海岸的服务器。

我已经设法让 X11 转发工作，因此我可以为某些有用的任务启动 GUI 应用程序。然而，对于所有 X11 转发的应用程序（*尤其是* `emacs`！），输入（击键、鼠标点击等）和响应之间存在很大的延迟，以至于有时它会从令人难以置信的令人沮丧变成潜在的有害——当我打算做 A , 但是 B 发生是因为滞后太大了。

SSH 压缩是潜在的罪魁祸首吗？我应该使用哪种压缩方式？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-19T16:08:13.907

X11图形占用大量带宽。如果您的远程主机距离很远（即不在 LAN 上），那么您可能会在导出的 X11 应用程序中遇到迟缓问题。

我不确定 SSH 压缩。性能可能取决于其他因素，例如 CPU 性能。从`ssh`手册页：

> ```
>      -C 请求压缩所有数据（包括标准输入、标准输出、
>              标准错误，以及转发 X11 和 TCP 连接的数据）。这
>              压缩算法与 gzip(1) 使用的相同，并且
>              “level”可以由 pro- 的 CompressionLevel 选项控制。
>              tocol 版本 1\.  压缩在调制解调器线路上是可取的，并且
>              其他慢速连接，但只会减慢速度
>              网络。  可以逐个主机设置默认值
>              在配置文件中；请参阅压缩选项。
> 
> ```

您可以使用以下一些其他解决方法来加快速度：

*   与其使用 X11 转发与 GUI 交互，不如考虑其他具有更好优化/压缩的东西，例如 VNC 或 NX/FreeNX。
*   使用 emacs 的终端版本而不是 GUI 版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-22T17:48:14.907

正如您特别提到`emacs`的：有命令行选项

> ```
>  -nw, --no-window-system
>           Tell Emacs not to create a graphical frame.  If you  use
>           this switch when invoking Emacs from an xterm(1) window,
>           display is done in that window. 
> ```

在 ssh 上工作时这会快得多（因为它只需要传输字符，而不是在 X11 上重绘整个屏幕）。

# web-crawler - 爬取网站返回不良数据

> ID：12977883
> 
> 赞同：0
> 
> 时间：2012-10-19T15:48:29.430
> 
> 标签：web-crawler, rapidminer

我正在使用快速矿工从特定数据中抓取网站。问题是如果我尝试经常抓取网站，它会提供错误的数据。

如果我从其他 IP 地址看到相同的数据，它会显示与我在不同 IP 地址上抓取的数据不同的数据。

有什么办法可以克服这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T17:17:04.210

今天的许多网站，尤其是值得挖掘的网站（即：链接）使用复杂的方法来检测和阻止除少数与他们达成协议的大型搜索引擎之外的所有网站的抓取。

尝试改变您发送的浏览器代码以及在一组机器而不是单台机器之间分配抓取。在 AWS 上运行一堆微型实例比一个大型实例更可取。还要确保在请求之间设置延迟，因为这既考虑周到，又有助于伪装你的爬虫。

# cucumber - save_and_open_page 的奇怪问题

> ID：12977886
> 
> 赞同：1
> 
> 时间：2012-10-19T15:48:37.543
> 
> 标签：cucumber, capybara

我最近读了一篇关于如何使用 capybara 的`save_and_open_page`方法使 Cucumber 中的调试测试变得更加容易的文章。所以我安装了`launchy`gem，在我的步骤定义文件中写了一个“显示页面”步骤，然后尝试在我的一个功能文件中使用该步骤作为测试。这是我用黄瓜运行该功能文件时得到的结果：

```
 Scenario:                                                                                # features\training_records\view_training_records.feature:22
    Given I am signed in as "Ajedi32"                                                      # features/step_definitions/login_system_steps.rb:5
    And I am on the training class page for "Class 1"                                      # features/step_definitions/training_class_steps.rb:13
    And show me the page                                                                   # features/step_definitions/debug_steps.rb:7
Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

C:\Documents and Settings\ajedi32\My Documents\Workspace\rails_app>    And I click "View Training Records"
        # features/step_definitions/navigation_steps.rb:12
    Then show me the page                                                                  # features/step_definitions/debug_steps.rb:7

1 scenario (1 passed)
9 steps (9 passed)
0m7.533s
Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

C:\Documents and Settings\ajedi32\My Documents\Workspace\rails_app> 
```

什么？？？我什至不...

看起来`save_and_open_page`正在将空白命令提示符的输出打印到我的控制台（是的，我正在运行 Windows XP）。它也不会像预期的那样保存和打开页面。你们中有人知道这里发生了什么吗？我当然不...

# grails - Grails URL 映射。将 404 重定向到 URL，例如 http://www.mysite.com/404.html

> ID：12977888
> 
> 赞同：0
> 
> 时间：2012-10-19T15:48:51.537
> 
> 标签：grails, http-status-code-404, url-mapping

在我的 URL 映射中，我想将我的应用程序发送到外部网页 URL 以获取 404 错误。因此，如果我的 404 页面托管在[http://www.myorganisation.com/404.html](http://www.myorganisation.com/404.html)我希望我的 URL 映射为：

```
"404"(uri:"http://www.myorganisation.com/404.html") 
```

但是，这不起作用。我也试过用'url'替换'uri'但没有成功。这甚至可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T16:01:20.277

```
"404"(controller: "watevercontroller", action: "wateveraction") 
```

然后在你的“水上行动”中

```
redirect(url: "http://www.myorganisation.com/404.html") 
```

# xcode - 在 Interface Builder 的 UIViewController 中合并导航栏

> ID：12977890
> 
> 赞同：1
> 
> 时间：2012-10-19T15:49:10.340
> 
> 标签：xcode, interface-builder

我使用的是 Xcode 4，但不是 Storyboard

我们在应用程序委托中实例化了一个导航控制器。

当我们使用 Xibs 创建视图控制器时，xibs 是 iphone 高度的视图（没有导航栏）。将内容放在这个区域是具有欺骗性的，因为实际上只有 44pt 的空间（导航栏的高度）被导航控制器放置在那里。

因此，我们如何在界面构建器中删除导航栏应该位于的房间？

我可以单击视图，然后将“顶部栏”更改为“导航栏”，这将起作用，但我无法将栏按钮项目添加到此导航栏，这让我认为这不是正确的做法。

谁能让我知道最好的方法是什么？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:25:20.440

当您推送控制器或使用它来初始化导航控制器时，导航控制器应负责在运行时调整大小。您在 IB 中设置顶部栏的区域位于标题“模拟指标”下方，旨在让您预览所选界面元素将对可用显示区域执行的操作。“模拟”部分是您不能将项目放入该栏中的原因。

真正的导航栏应该在定义导航控制器的地方配置，无论是在代码中还是在 xib 中。

# list - 在序言中拆分列表

> ID：12977892
> 
> 赞同：4
> 
> 时间：2012-10-19T15:49:12.847
> 
> 标签：list, split, prolog, element

我对 Prolog 很陌生，我需要一些帮助来解决一个小问题：

我正在尝试将情侣列表分成两个列表。第一个列表包含具有给定键的所有对，第二个列表包含所有其他对象。

这是我到目前为止的代码：

```
splitList([],_,[],[]).
splitList([(A,X)|Rest], B, [Elem1|List1], [Elem2|List2]):-
    (
        A == B
    ->
        Elem1 = (A,X),
        splitList(Rest, B, List1, [Elem2|List2])
    ;
        Elem2 = (A,X),
        splitList(Rest, B, [Elem1|List1], List2)
    ). 
```

当我尝试测试它时，这就是我得到的：

```
[trace] [3] 143 ?- splitList([(1,yellow),(1,blue),(2,yellow),(2,blue)],1,X,Y).
   Call: (37) splitList([ (1, yellow), (1, blue), (2, yellow), (2, blue)], 1, _G4821, _G4822) ? creep
   Call: (38) 1==1 ? creep
   Exit: (38) 1==1 ? creep
   Call: (38) _G4928= (1, yellow) ? creep
   Exit: (38) (1, yellow)= (1, yellow) ? creep
   Call: (38) splitList([ (1, blue), (2, yellow), (2, blue)], 1, _G4929, [_G4931|_G4932]) ? creep
   Call: (39) 1==1 ? creep
   Exit: (39) 1==1 ? creep
   Call: (39) _G4940= (1, blue) ? creep
   Exit: (39) (1, blue)= (1, blue) ? creep
   Call: (39) splitList([ (2, yellow), (2, blue)], 1, _G4941, [_G4931|_G4932]) ? creep
   Call: (40) 2==1 ? creep
   Fail: (40) 2==1 ? creep
   Call: (40) _G4931= (2, yellow) ? creep
   Exit: (40) (2, yellow)= (2, yellow) ? creep
   Call: (40) splitList([ (2, blue)], 1, [_G4949|_G4950], _G4932) ? creep
   Call: (41) 2==1 ? creep
   Fail: (41) 2==1 ? creep
   Call: (41) _G4958= (2, blue) ? creep
   Exit: (41) (2, blue)= (2, blue) ? creep
   Call: (41) splitList([], 1, [_G4949|_G4950], _G4959) ? creep
   Fail: (41) splitList([], 1, [_G4949|_G4950], _G4959) ? creep
   Fail: (40) splitList([ (2, blue)], 1, [_G4949|_G4950], _G4932) ? creep
   Fail: (39) splitList([ (2, yellow), (2, blue)], 1, _G4941, [_G4931|_G4932]) ? creep
   Fail: (38) splitList([ (1, blue), (2, yellow), (2, blue)], 1, _G4929, [_G4931|_G4932]) ? creep
   Fail: (37) splitList([ (1, yellow), (1, blue), (2, yellow), (2, blue)], 1, _G4821, _G4822) ? creep
false. 
```

显而易见的解决方案应该是 X = [(1,yellow),(1,blue)] 和 Y = [(2,yellow),(2,blue)]，但我却错了。有人可以告诉我我做错了什么吗？

提前致谢，

瓦勒

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T16:06:49.600

让我们看看倒数第二个递归调用：

```
splitList([(2,blue)], 1, [Elem1|List1], [Elem2|List2])
                          ^^^^^^^^^^^ 
```

在我标记的地方，您希望第一个列表仍然具有至少一个元素。然而最后的递归调用不能满足这个条件。这就是它失败的原因。跟踪的相关部分是：

```
# penultimate call:
Call: (40) splitList([ (2, blue)], 1, [_G4949|_G4950], _G4932) ? creep
[…]
# last call:
Call: (41) splitList([], 1, [_G4949|_G4950], _G4959) ? creep
Fail: (41) splitList([], 1, [_G4949|_G4950], _G4959) ? creep 
```

没有任何替代可以允许 _G4949 变量存在于最后一次调用中。

我会这样写：

```
splitList([], _, [], []).
splitList([(A, X)|Rest], A, [(A, X)|Rest1], Rest2) :-
        splitList(Rest, A, Rest1, Rest2).
splitList([(A, X)|Rest], B, Rest1, [(A, X)|Rest2]) :-
        A =\= B,
        splitList(Rest, B, Rest1, Rest2). 
```

顺便说一句，问得好问题！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T16:05:07.993

问题在于基本情况。采取身体中的两种情况中的任何一种：

```
splitList(Rest, B, List1, [Elem2|List2]) 
```

当你走到最后时，除了最后一个参数之外，所有东西都正确统一，即`Rest=[], B=_, List1=[]`......但`[Elem2|List2]`不与`[]`.

所以程序失败。

尝试这样的事情（我还没有运行它）：

```
splitList([],_,[],[]).
splitList([(A,X)|Rest], A, [(A,X)|List1], List2):- !
        splitList(Rest, A, List1, List2).
splitList([(B,X)|Rest], A, List1, [(B,X) | List2]):- 
        splitList(Rest, A, List1, List2). 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-20T19:44:29.813

无需担心编写递归代码（也无需担心是否正确）！

我们定义`splitList/4`如下（使用[meta-predicate](/questions/tagged/meta-predicate "显示标记为“元谓词”的问题") [`tpartition/4`](https://stackoverflow.com/a/29867514/4609915)、[lambdas](http://www.complang.tuwien.ac.at/ulrich/Prolog-inedit/ISO-Hiord)和[`(=)/3`](https://stackoverflow.com/a/27358600/4609915)）：

```
:- use_module(library(lambda)).

splitList(KVs,K,Hits,Misses) :-
   tpartition(K+\(K0,_)^(K0=K),KVs,Hits,Misses). 
```

示例查询：

```
?- splitList([(1,yellow),(2,green),(1,blue),(2,red)], 1 ,Hits,Misses)。
命中 = [( 1，黄色)，( 1，蓝色)]，未命中 = [(2，绿色)，(2，红色)]。% 确定性

```

更一般*的*东西怎么样？

```
?- splitList([(1,yellow),(2,green),(1,blue),(2,red)], K ,Hits,Misses)。
      K=1，命中 = [（1，黄色），（1，蓝色）]，未命中 = [（2，绿色），（2，红色）]
;               K=2，命中 = [( 2 , green),( 2 , red)], Misses = [(1,yellow),(1,blue)]
; dif(K,1), dif(K,2), Hits = [] , Misses = [(1,yellow),(1,blue),
                                                              （2，绿色），（2，红色）]。

```

# php - codeigniter 在控制器中使用函数

> ID：12977893
> 
> 赞同：0
> 
> 时间：2012-10-19T15:49:15.797
> 
> 标签：php, codeigniter, function, controller

出于某种原因，我无法运行该`change()`功能以及它停止后的所有内容。我尝试了，`$this->change()`但效果是一样的。如果我在 php 文件中运行该函数，它的工作和 num 正在改变。

```
class Test extends CI_Controller {

    function __construct(){
        parent::__construct();
    }

    public function home(){

        $num = 1;

        change($num);

        function change($num,$rand=false){

            echo 'inside function'; // this is not shown

            if($num < 4) {
                $rand = rand(1,9);
                $num = $num.$rand;
                change($num,$rand);
            } else {
                echo $num;
            }
        }
        echo 'done'; // this is not shown

    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:53:24.607

您可能会更好地调用私有或公共函数来处理数据（或者对于更复杂/涉及的过程库）。

IE

```
class Test extends CI_Controller
{
  public function __construct()
  {
      parent::__construct();
  }

  public function home()
  {
    $num = 1;

    echo $this->_change($num);
    echo 'done'; // this is not shown
  }

  // private or public is w/o the underscore
  // its better to use private so that CI doesn't route to this function
  private function _change($num, $rand = FALSE)
  {
        if($num < 4) {
            $rand = rand(1,9);
            $num = $num + $rand;
            $this->_change($num,$rand);
        } else {
            return $num;
        }
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:52:33.203

大声笑，您正在尝试在函数中编写函数。

尝试使用此代码运行您的课程

```
class Test extends CI_Controller {

    function __construct(){
        parent::__construct();
    }

    public function home(){

        $num = 1;

        $this->change($num);
        echo 'done'; // this is not shown

    }

    public function change($num,$rand=false){

            echo 'inside function'; // this is not shown

            if($num < 4) {
                $rand = rand(1,9);
                $num = $num.$rand;
                change($num,$rand);
            } else {
                echo $num;
            }
    }

} 
```

# javascript - angularjs 数据绑定许多输入的方法是什么？

> ID：12977894
> 
> 赞同：31
> 
> 时间：2012-10-19T15:49:19.303
> 
> 标签：javascript, angularjs

我正在学习 angularjs，我希望能够让用户输入许多输入。输入这些输入时，`list`数组元素应相应更改。我想尝试使用 ngRepeat 指令，但我读到了，因为它创建了一个新范围，我无法进行数据绑定：

```
<div ng-repeat="item in list">
    <label>Input {{$index+1}}:</label>
    <input ng-model="item" type="text"/>
</div> 
```

我想知道是否应该使用自定义指令来执行此操作或以不同的方式处理它。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-12-08T22:40:36.207

数据绑定到原始“项目”不起作用的原因是 ng-repeat 为每个项目创建子范围的方式。对于每个项目，ng-repeat 都有新的子范围原型继承自父范围（见下图中的虚线），**然后**它将项目的值分配给子范围上的新属性（下图中的红色项目）。新属性的名称是循环变量的名称。从[ng-repeat 源代码](https://github.com/angular/angular.js/blob/master/src/ng/directive/ngRepeat.js)：

```
childScope = scope.$new();
...
childScope[valueIdent] = value; 
```

如果 item 是原语，则新的子范围属性本质上被分配了原语值的副本。此子范围属性对父范围不可见，您对输入字段所做的更改存储在此子范围属性中。例如，假设我们在父范围内

```
$scope.list = [ 'value 1', 'value 2', 'value 3' ]; 
```

在 HTML 中：

```
<div ng-repeat="item in list"> 
```

然后，第一个子作用域将具有以下`item`属性，具有原始值 ( `value 1`)：

```
item: "value 1" 
```

![使用原语重复 ng-repeat](../Images/a765d1aeab0a7000867c5b2ba67aef53.png)

由于 ng-model 数据绑定，您对表单输入字段所做的更改存储在该子范围属性中。

您可以通过将子范围记录到控制台来验证这一点。在 ng-repeat 中添加到您的 HTML：

```
<a ng-click="showScope($event)">show scope</a> 
```

添加到您的控制器：

```
$scope.showScope = function(e) {
    console.log(angular.element(e.srcElement).scope());
} 
```

* * *

使用@Gloopy 的方法，每个子作用域仍然获得一个新的“item”属性，但是因为 list 现在是一个对象数组，`childScope[valueIdent] = value;`导致 item 属性的值被设置为对其中一个数组对象的引用（而不是副本）。

![ng-repeat 对象](../Images/ce2baa6bdfafc382e04cc79bcc61fd87.png)

使用 showScope() 技术，您将看到子范围`item`属性的值引用了数组对象之一——它不再是原始值。

另请参阅[不要绑定到 ng-repeat 子范围中的原语](https://github.com/angular/angular.js/issues/1267)和
[AngularJS 中范围原型/原型继承的细微差别是什么？](https://stackoverflow.com/questions/14049480/what-are-the-nuances-of-scope-prototypal-prototypical-inheritance-in-angularjs)（其中包含使用 ng-repeat 时范围的图片）。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-10-19T15:57:18.680

如果你`list`是一个对象数组（而不是一个基元数组），你会有更好的运气。即使使用以下命令创建了新范围，这也可以正常工作`ng-repeat`：

```
<div ng-repeat="item in list">
    <label>Input {{$index+1}}:</label>
    <input ng-model="item.value" type="text"/>
</div> 
```

控制器：

```
function TestController($scope) {
    $scope.list = [ { value: 'value 1' }, { value: 'value 2' }, { value: 'value 3' } ];
}​ 
```

以[这个小提琴](http://jsfiddle.net/gHFhk/)为例。

另一方面，如果您尝试绑定到字符串数组，则新范围将导致问题，因为您正在修改的值不会与原始数组字符串原语绑定（如[this fiddle](http://jsfiddle.net/bxD2P/) example）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-09T17:50:24.543

我找到了一种有趣的方法，它允许我处理一组原语。

我正在使用 AngularJS 1.2.1，这是我可以使它工作的唯一版本。

HTML：

```
<div ng-repeat="item in list">
    <label>Input {{$index+1}}:</label>
    <input ng-model="item" type="text" ng-blur="editItem($index, item)"/>
</div> 
```

JavaScript：

```
$scope.editItem = function(idx, eItem) {
    $scope.list[idx] = eItem;
}; 
```

链接： http: [//jsfiddle.net/bxD2P/10/](http://jsfiddle.net/bxD2P/10/)（感谢 Gloopy 提供的初学者 Fiddle）

我确信有一些简单的方法可以在它的工作原理上找到漏洞，我很想听听他们的意见。它可以让我支持我的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-24T11:16:31.240

考虑使用`ngList`指令[https://docs.angularjs.org/api/ng/directive/ngList](https://docs.angularjs.org/api/ng/directive/ngList)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-12T21:22:49.750

这是一种方法。我对我的转发器使用了 textareas 和不同的结构，但主要概念是：

*   根据索引显示一个简单的值。（未绑定）
*   模糊更新模型
*   模型更新重新渲染

它本质上是伪造绑定。

工作小提琴 - [http://jsfiddle.net/VvnWY/4/](http://jsfiddle.net/VvnWY/4/)

的HTML：

```
 <script type="text/ng-template" id="textareas.html">
    <textarea ng-if="strings" ng-repeat="str in strings" ng-blur="blur( $event, $index )">{{strings[$index]}}</textarea>
  </script>

<div ng-controller="MyCtrl">
    Here's a few strings: <br />
    <div ng-repeat="str in strings">{{strings[$index]}}</div>

    Here's the strings as editable (twice so that you can see the updates from a model change): <br />
    <form-textareas strings="strings"></form-textareas>
    <form-textareas strings="strings"></form-textareas>

</div> 
```

JS：

```
var myApp = angular.module('myApp',[]);
angular.module('myApp', [])
  .controller('MyCtrl', ['$scope', function($scope) {
    $scope.strings = [ "foo", "bar", "cow" ];
   }])
  .directive('formTextareas', function() {
    return {
        restrict: "E",
        scope: {
            strings: '='
        },
        templateUrl: "textareas.html",
        link: function( $scope ){
            $scope.blur = function( $event, $index ){
                $scope.strings[ $index ] = $event.currentTarget.value;
            };
        }
    };
  })
; 
```

# python - ndb.get_multi() 返回空实体

> ID：12977899
> 
> 赞同：1
> 
> 时间：2012-10-19T15:49:28.857
> 
> 标签：python, google-app-engine

我想用来`ndb.get_multi(list_of_keys)`避免做更昂贵的查询。如果我的理解是正确的，`ndb.get_multi()`那么每个返回的实体只向您收取 1 次读取费用，因此如果您有 50 个键的列表，并且只找到 20 个，那么您应该只收取 20 次读取的费用。

```
 keys = list()

        keys.append(Key('User', 2)) // this user exists
        keys.append(Key('User', 12)) // this user DOES NOT exist
        keys.append(Key('User', 15)) // this user DOES NOT exist

        users = ndb.get_multi(keys) 
```

我得到的是 3 个项目，1 个有用户，2 个只有空值。当我检查 AppStats 时，我发现它确实对我放入其中的所有密钥收费，即使 2 不存在。

为什么我要返回空实体？不应该跳过未找到的项目吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T21:46:56.543

你希望能够做到

```
obj1, obj2, obj3 = ndb.get_multi([key1, key2, key3]) 
```

如果返回的结果数量是任意长度，则元组解包会中断，您必须获取一个列表并检查和比较键。如果您需要使用[filter](https://docs.python.org/2/library/functions.html#filter)删除 None 也很简单：

```
filter(None, list) 
```

成本是每次获取/读取（操作），与返回结果（数据）不同。GAE 中内部服务和通信的成本无论是否存在都大致相同，但对于不存在的项目，您不必为反序列化支付 cpu 费用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:54:10.013

不，因为现在您可以看到哪些项目没有找到。

# iphone - 运行时 Xcode 错误

> ID：12977900
> 
> 赞同：0
> 
> 时间：2012-10-19T15:49:33.180
> 
> 标签：iphone, ios, xcode

您可以在图像中看到错误。

我什至不知道这些错误是什么意思，在我为 iOS 6 更新更新 Xcode 之前它工作正常。我已经做了一些事情来尝试修复它，例如更改目标操作系统并进行清理，但这并没有奏效。

成功构建应用程序并将其推送到设备后，我收到错误消息。

![在此处输入图像描述](../Images/a341a82d24db509ff4a663e96b97a8a0.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T16:38:04.297

您的应用程序在运行时崩溃了，因为出现了异常。

异常记录在您的控制台日志中。我们可以在您的捕获中看到它：

> `*** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<UIApplication 0x...> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key view.'`

这意味着在您的应用程序的某个地方，您尝试设置 type 对象的“view”属性`UIApplication`，但`UIApplication`没有任何`view`属性，所以这会崩溃。

这很可能是**在您的 MainWindow.xib 文件中，您将`view`IBOutlet 连接到 type 的对象`UIApplication`**，但是您的插座的这种绑定是无效的，因为插座不再存在。

*（也许您在给定时间添加了插座，并在 IB 中绑定/连接它，然后在您的代码中将其删除，或者您绑定了 IBOutlet 然后更改了对象的类，因此新类没有相同的插座无论如何，无论插座现在绑定到您的 XIB 中不存在的属性并导致崩溃）*

**要解决此问题**，请在界面生成器中打开您的 XIB 文件并删除与您现在不存在的插座的无效连接，您的异常应该会消失。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:52:09.280

这意味着你的程序崩溃了。错误出现在右上角的那个框中。我看不到整个错误消息，但它与键值编码有关。

这可能是一个简单的事实，即您正在运行一个稍微过时的程序版本。从模拟器或您的设备中删除它，清理并重新构建您的项目，然后让 Xcode 重新复制它。

# java - 如何实现可以在 Java 中简单部署的 Web 服务（如 Jenkins）

> ID：12977913
> 
> 赞同：1
> 
> 时间：2012-10-19T15:49:54.237
> 
> 标签：java, web-services, jenkins, hudson

我对Java知之甚少。我想知道Java如何实现一个可以简单部署的网络服务。

我发现 Jenkins 可以在没有任何 servlet 容器的情况下进行部署（例如 Tomcat）。它可以使用“ `java -jar jenkins.war --httpPort=xxx`”运行。我想研究Jenkins的源代码。但这很复杂。我找不到詹金斯在哪里解析“ `httpPort`”选项。

谁能帮我分析下Jenkins的实现？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:59:37.213

看看[Jetty](http://jetty.codehaus.org/jetty/)，这是一个可以部署到的轻量级容器。它通常用于需要容器的单元测试——它几乎立即开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T16:00:42.510

您正在寻找的可能是一个可嵌入的 servlet 容器。

很好的例子是：

*   码头：http: [//jetty.codehaus.org/jetty/](http://jetty.codehaus.org/jetty/)
*   灰熊： http: [//grizzly.java.net/](http://grizzly.java.net/)

您可以在此处找到有关 Jetty 的教程： [http ://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty](http://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T16:15:28.503

我相信您想在 java 中创建和部署 Web 服务。如果是这样的话，Apache CXF 将是最好的开始框架。有数百个教程和活跃的论坛可用。

下面的链接将帮助您开始在 CXF 中开发简单的 web 服务（即使没有 Tomcat 容器也可以使用） [http://www.benmccann.com/dev-blog/web-services-tutorial-with-apache-cxf/](http://www.benmccann.com/dev-blog/web-services-tutorial-with-apache-cxf/)

# java - Struts 2 中的切换动作

> ID：12977917
> 
> 赞同：1
> 
> 时间：2012-10-19T15:50:05.533
> 
> 标签：java, jsp, struts2, struts

我正在使用 Struts，在我的项目中，我有 2 个模块（管理员、用户）“管理员”有不同的操作，如添加用户、删除用户、添加项目、删除用户，而“用户”有订购项目、检查他的操作等操作账户余额。

现在我想区分用户页面和管理页面（即如果管理员登录我想为他提供管理模块，如果用户登录我想为他提供用户）

我开始了解在这种情况下可以使用开关动作，但我没有任何关于如何在 Struts 2 中使用开关动作的示例（但我在 Google 的 Struts 1.2 中有开关动作示例）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T17:08:46.350

在 Struts2 中，模块概念与**namespace**相关联。并且它作为任何动作的前缀来区分名称冲突。

有很多通过网络登录的示例。用户登录后，您可以将此信息保留在会话中。可以通过配置结果来完成切换，但在 JSP 中您应该检查此会话信息。

**例如：**

```
<s:if test="#session.loginUser != 'admin'">
  <jsp:forward page="/user/Page.jsp" />  
</s:if> 
```

* * *

# gwt - GWT Requestfactory 性能建议

> ID：12977922
> 
> 赞同：9
> 
> 时间：2012-10-19T15:50:11.987
> 
> 标签：gwt, gwt2, requestfactory

使用 GWT requestfactory 时，我发现性能非常差。例如，一个请求需要我的服务层 2 秒才能完成，而 GWT 需要 20 秒来序列化。我的服务返回约 100 个 EntityProxies。每个对象都有 4 个 ValueProxies 和 2 个 EntityProxies（100 个根级 EntityProxies、400 个 ValueProxies 和 200 个额外的 EntityProxies）。但是，我在更小的数据集上看到同样的 10 倍性能下降。

日志片段示例：

```
D 2012-10-18 22:42:39.546 ServiceLayerDecorator invoke: Inoking service layer took 2265 ms
D 2012-10-18 22:42:58.957 RequestFactoryServlet doPost: Entire request took 22870 ms 
```

我在该`ServiceLayerDecorator#invoke`方法中添加了一些分析代码，并将整个 servlet 包装在一个计时器中。我已经对服务本身进行了分析，它确实在~2s 内返回了结果。

我正在使用 GWT 2.4，但在 GWT 2.5rc1 和 GWT 2.5rc2 上对此进行了测试。我的后端在 GAE 上，但我不认为这在这里发挥了作用。

我发现[这个错误](http://code.google.com/p/google-web-toolkit/issues/detail?id=7231)是针对 2.4 提交的，这似乎非常相关。我已经手动应用了[这个谷歌组](https://groups.google.com/forum/?fromgroups=#!topic/google-web-toolkit/o4qBbwmE7YA)的补丁，没有任何运气。

我的域模型如下所示：

```
class Trip {
  protected Address origin; // becomes ValueProxy
  protected Address destination; becomes ValueProxy
  protected Set<TripPassenger> tripPassengers; // Set of ValueProxies
}

class TripPassenger {
  protected Passenger passenger;
}

class Passenger {
  protected Account account;
} 
```

我的问题是：

*   我是否正确分析了代码并将问题隔离到 GWT 序列化？
*   我做错了什么会导致这种行为吗？
*   如何更好地分析 GWT 序列化代码以尝试找出原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T10:14:23.340

> *   我是否正确分析了代码并将问题隔离到 GWT 序列化？

RequestFactory**大量**使用反射（例如，比 GWT-RPC 多得多），所以在某些情况下它会导致一些性能问题我并不感到惊讶。GAE 可以在这里发挥作用。
我相信 RequestFactory（实际上是 AutoBean 部分）可以极大地受益于构建时的代码生成。

> *   我做错了什么会导致这种行为吗？

检查您的定位器`find`和/或`isLive`方法。

> *   如何更好地分析 GWT 序列化代码以尝试找出原因？

了解反序列化请求、应用更改以及响应序列化所花费的时间也会很有趣。并且不要忘记减去花费在`find`和中的时间`isLive`。

# c# - 如何正确退出 C# 应用程序？

> ID：12977924
> 
> 赞同：233
> 
> 时间：2012-10-19T15:50:10.973
> 
> 标签：c#, winforms, exit

我有一个用 C# 发布的应用程序。这里的问题是每当我通过单击红色退出按钮关闭主表单时，它会关闭表单但不会关闭应用程序。当我尝试关闭计算机时，我发现了这一点，希望我制作的应用程序运行顺利，然后我被许多我放置`MessageBox`警报的子窗口轰炸了。

我试过`Application.Exit`了，但它仍然调用所有子窗口和警报，我不知道如何使用`Environment.Exit`以及放入哪个整数。

顺便说一句，每当我的表单调用`formclosed`或`form closing`事件时，我都会使用函数关闭应用程序`this.Hide()`；这会影响我的应用程序现在的行为吗？

* * *

## 回答 #1

> 赞同：403
> 
> 时间：2012-10-19T15:56:42.830

来自 MSDN：

[**应用程序.退出**](http://msdn.microsoft.com/en-us/library/ms157894.aspx)

> 通知所有消息泵它们必须终止，然后在处理完消息后关闭所有应用程序窗口。如果您已调用 Application.Run（WinForms 应用程序），这是要使用的代码，此方法会停止所有线程上所有正在运行的消息循环并关闭应用程序的所有窗口。

[**环境.退出**](http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx)

> 终止此进程并为底层操作系统提供指定的退出代码。这是您使用控制台应用程序时要调用的代码。

这篇文章[Application.Exit vs. Environment.Exit](http://geekswithblogs.net/mtreadwell/archive/2004/06/06/6123.aspx)指出了一个很好的提示：

您可以通过检查属性来确定是否`System.Windows.Forms.Application.Run`已调用。`System.Windows.Forms.Application.MessageLoop`如果为真，则 Run 已被调用，您可以假设 WinForms 应用程序正在执行，如下所示。

```
if (System.Windows.Forms.Application.MessageLoop) 
{
    // WinForms app
    System.Windows.Forms.Application.Exit();
}
else
{
    // Console app
    System.Environment.Exit(1);
} 
```

参考：[为什么 Application.Exit 不能工作？](https://stackoverflow.com/questions/554408/why-would-application-exit-fail-to-work)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-10-08T21:18:18.397

我知道这不是您遇到的问题，但是可能发生这种情况的另一个原因是您在应用程序中打开了一个非后台线程。

```
using System;
using System.Threading;
using System.Windows.Forms;

namespace Sandbox_Form
{
    static class Program
    {
        private static Thread thread;

        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);

            thread = new Thread(BusyWorkThread);
            thread.IsBackground = false;
            thread.Start();

            Application.Run(new Form());

        }

        public static void BusyWorkThread()
        {
            while (true)
            {
                Thread.Sleep(1000);
            }
        }
    }
} 
```

什么时候`IsBackground`它`false`会保持你的程序打开直到线程完成，如果你设置`IsBackground`线程`true`将不会保持程序打开。像`BackgroundWoker`,`ThreadPool`和`Task`所有内部使用`IsBackground`设置为的线程`true`。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-19T16:51:12.587

> 顺便一提。每当我的表单调用 formclose 或表单关闭事件时，我都会使用 this.Hide() 函数关闭应用程序。这会影响我的应用程序现在的行为吗？

简而言之，是的。当主窗体（通过方法启动的窗体）关闭（不隐藏）时，整个应用程序将`Application.Run`结束`Main`。

如果您的整个应用程序在主窗体关闭时始终完全终止，那么您应该删除该窗体关闭处理程序。通过不取消该事件并在用户关闭它时让它们关闭，您将获得所需的行为。至于所有其他表单，如果您不打算再次显示相同的表单实例，您只需让它们关闭，而不是阻止关闭并隐藏它们。如果您再次显示它们，那么隐藏它们可能没问题。

如果您希望能够让用户为您的主表单单击“x”，但让另一个表单保持打开状态并且实际上成为“新”主表单，那么它会有点复杂。在这种情况下，您只需要隐藏您的主窗体而不是关闭它，但是您需要添加某种机制，当您确实希望您的应用程序结束时，它*实际上会关闭主窗体。*如果这是您所处的情况，那么您需要在问题中添加更多详细信息，描述哪些类型的应用程序应该和不应该实际结束程序。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2018-05-07T15:13:23.513

在这种情况下，退出应用程序的最正确方法是覆盖 App.xaml.cs 中的 onExit() 方法：

```
protected override void OnExit(ExitEventArgs e) {
    base.OnExit(e); 
} 
```

# iphone - 蒙面 UIView 上的 UIGestureRecogniser？

> ID：12977928
> 
> 赞同：3
> 
> 时间：2012-10-19T15:50:16.093
> 
> 标签：iphone, ios, ipad, core-graphics, uigesturerecognizer

有没有办法知道“点击”是在 UIView 的蒙版区域内部还是外部？我正在使用 CoreGraphics 来屏蔽 UIView。

![水龙头位置图](../Images/cfdefcd331addfc469ac316a2a7afe47.png)

到目前为止，我的代码是这样的..

```
- (void)viewDidLoad {

    UIGestureRecogniser *r = [[UIGestureRecogniser alloc] initWithTarget:self action:@selector(gestCall:)];
    [self addGestureRecogniser:r];

}

- (void)gestCall:(UIGestureRecogniser *)gestRec {
     if ("somthing") {
        // outside of mask
     } else {
        // inside of mask
     }
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T15:06:51.383

我终于找到了我正在寻找的解决方案。因此，对于任何试图找到的人来说，CGPoint 都在任何 CGPath 内。

这很简单。

```
UIBezierPath *p = [UIBezierPath bezierPathWithCGPath:anyCGPath];

BOOL isInPath = [p containsPoint:anyCGPoint]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T16:09:15.617

基本上您需要检查触摸坐标并确定是否落入蒙版区域。覆盖[`hitTest:withEvent:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instm/UIView/hitTest:withEvent:)图像蒙版的和帐户。您可以在覆盖的 `-[UIView hitTest:withEvent:]中使用[`[[[self layer] presentationLayer] hitTest:aPoint]`](http://developer.apple.com/library/mac/documentation/GraphicsImaging/Reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instm/CALayer/hitTest:)或。`[[[self layer] mask] hitTest:aPoint]`

[编辑]

[检查用户是否在 CGPath 附近点击](https://stackoverflow.com/questions/1143704/how-can-i-check-if-a-user-tapped-near-a-cgpath)可能有助于找到问题的答案。

[编辑]

在您的手势处理程序中执行以下操作以确定是否处理点击。

1.  指定圆心（这将是 UIView.Center 作为 CGPoint）
2.  指定饼图的半径
3.  当用户点击视图时，将位置作为点 - CGPoint 并计算`point.x*point.x+point.y*point.y`（圆公式），该值必须小于或等于半径的平方，即`radius*radius`。如果满足此条件，则您的点击点在圆圈内，否则在圆圈外。

希望说明清楚。

# asp.net-mvc - MVC 和应用程序请求路由 (ARR) 的 URL 重写问题

> ID：12977929
> 
> 赞同：2
> 
> 时间：2012-10-19T15:50:20.763
> 
> 标签：asp.net-mvc, iis-7, asp.net-mvc-routing, asp.net-4.0

> **可能重复：**
> [对 ASP.NET MVC 使用 IIS 应用程序请求路由 (ARR)](https://stackoverflow.com/questions/2245235/using-iis-application-request-routing-arr-for-asp-net-mvc)

我有一个在 IIS7 中运行的 MVC3 中的应用程序和另一个在不同端口中运行的站点。我的 MVC 应用程序中的某些链接需要显示来自另一个站点的静态内容。由于各种限制，重定向不是一种选择。

我们尝试在 IIS7 中实现 URL 重写。

1.  编写规则以重写模式匹配的 URL
2.  从 ARR > 服务器代理设置安装应用程序请求路由并启用代理
3.  从 ARR > 服务器代理设置中选中“在响应标头中反向重写主机”
4.  应用程序池在 .NET 4.0 上以集成模式运行

不幸的是，ARR 路由不起作用。我检查了失败的请求日志，发现 URL 重写按预期工作，但路由没有发生。

有人遇到过这个问题吗？有什么线索吗？

# jquery-plugins - Roundabout jQuery 插件 keypress 方向键 左右移动

> ID：12977930
> 
> 赞同：0
> 
> 时间：2012-10-19T15:50:29.900
> 
> 标签：jquery-plugins, keypress

我正在使用 Roundabout 插件（[http://fredhq.com/projects/roundabout](http://fredhq.com/projects/roundabout)），但无法弄清楚如何使用预设的可调用方法，例如使用左/右箭头键在按键上动画到下一个/上一个。

我可以在不使用这些预设的情况下让按键正常工作，但我真的想在各种按键上使用预设类。有任何想法吗？

的HTML

```
 <div id="carousel-container">
    <ul class="roundabout-holder">
       <li class="roundabout-moveable-item roundabout-in-focus"></li>
       <li class="roundabout-moveable-item"></li>
       <li class="roundabout-moveable-item"></li>
       <li class="roundabout-moveable-item"></li>
       <li class="roundabout-moveable-item"></li>
    </ul>
    </div> 
```

jQuery 设置

```
 <script> // Calling the Roundabout plugin
       $(document).ready(function() {
          $('ul').roundabout();
       });
    </script>

    $(document.documentElement).keyup(function (event) {
      var direction = null;
      // handle cursor keys
      if (event.keyCode == 37) {
        // go left
        $('#roundabout-container').roundabout("animateToNextChild");
      } else if (event.keyCode == 39) {
        // go right
        $('#roundabout-container').roundabout("animateToPreviousChild");
      }
     if (direction != null) {
        $('ul.roundabout-holder li.roundabout-moveable-item').parent()[direction]().find('a').click();
      }
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T16:31:16.790

这对我有用

**的HTML**

```
 <ul class="pasador">
      <li><img src="fichas/01.jpg" alt="Award" /></li>
      <li><img src="fichas/02.jpg" alt="Backpack" /></li>
      etc ...
   </ul> 
```

**查询设置**

```
<script>
    $(document).ready(function() {
        $('ul.pasador').roundabout();
    });
</script>

$(document.documentElement).keyup(function(event) {
    if (event.keyCode == 37) {
        $('ul.pasador').roundabout("animateToPreviousChild");
    } else if (event.keyCode == 39) {
        $('ul.pasador').roundabout("animateToNextChild");
    }
}); 
```

# oop - 管理文件序列化和反序列化的类的命名约定

> ID：12977931
> 
> 赞同：1
> 
> 时间：2012-10-19T15:50:31.463
> 
> 标签：oop, language-agnostic, naming-conventions

管理数据序列化和反序列化的类是否有命名约定？此类的一个示例是 MFC CDocument 类，它充当文件数据和应用程序数据之间的桥梁。例如，这些类型的类通常称为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:52:32.947

至少在 BCL（.NET 基类库）中，这些被称为序列化程序或格式化程序。

示例包括[`XmlSerializer`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)、[`BinaryFormatter`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter.aspx)和。[`DataContractSerializer`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)[`JavaScriptSerializer`](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)

所有这些类都管理序列化和反序列化。

# node.js - 为什么 redis 命令不能在我的 mocha 咖啡脚本文件测试中工作？

> ID：12977935
> 
> 赞同：0
> 
> 时间：2012-10-19T15:50:45.000
> 
> 标签：node.js, coffeescript, redis, mocha.js

```
class ThingWithRedis
  constructor: (@config) ->
    @redis = require('redis').createClient()

  push: (key, object) ->
    @redis.set(key, object)
  fetch: (key, amount) ->
    @redis.get key, (err, replies) ->
      console.log "|#{replies}|"

module.exports = ThingWithRedis

#if you uncomment these lines and run this file, redis works

#twr = new ThingWithRedis('some config value')
#twr.push('key1', 'hello2')
#twr.fetch('key1', 1)
#twr.redis.quit() 
```

但从测试中：

```
ThingWithRedis = require '../thing_with_redis'

assert = require('assert')

describe 'ThingWithRedis', ->
  it 'should return the state pushed on', ->

    twr = new ThingWithRedis('config')
    twr.push('key1', 'hello1')
    twr.fetch('key1', 1)

    assert.equal(1, 1) 
```

你永远不会看到'hello1'被打印出来。

但是当我直接运行咖啡 thing_with_redis.coffee 并且底线未注释时，您确实看到打印了“hello2”。

这是我跑步的时候：

mocha --compilers 咖啡：咖啡脚本

redis 似乎只是停止工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:05:51.367

Redis 连接可能尚未建立。在运行测试之前尝试等待“就绪”事件。

```
describe 'ThingWithRedis', ->
  it 'should return the state pushed on', ->

    twr = new ThingWithRedis('config')
    twr.redis.on 'ready', ->
      twr.push('key1', 'hello1')
      twr.fetch('key1', 1) 
```

需要注意的是，node_redis 将在 'ready' 事件之前调用的命令添加到队列中，然后在建立连接时处理它们。mocha 可能在 redis “准备好”之前退出。

[https://github.com/mranney/node_redis#ready](https://github.com/mranney/node_redis#ready)

# c# - 在 C++ 和 C# 中使用 try/catch 的正确方法是什么？

> ID：12977938
> 
> 赞同：2
> 
> 时间：2012-10-19T15:51:03.770
> 
> 标签：c#, c++, exception-handling

> **可能重复：**
> [我应该何时以及如何使用异常处理？](https://stackoverflow.com/questions/4506369/when-and-how-should-i-use-exception-handling)

我已经看到程序员在 C# 和 C++的*每个方法中都编写了“try{}catch(){}”块。*在 C# 中，这似乎很常见。但在 C++ 中，它似乎晦涩难懂。使用它们的正确方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T15:53:11.240

实际上只有 3 次你应该使用 try/catch：

1.  在应用程序的顶层，您可以向用户显示友好的错误消息（并希望记录一些有用的信息，以便以后解决问题）。

2.  何时可以从异常中正确恢复（或至少清理不再需要的资源）。

3.  当您要对异常信息执行某些操作时，然后将异常冒泡。

除了这三种情况，没有理由使用 try/catch 块。您应该让异常冒泡到调用者，以便他们可以在需要时处理它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-19T15:54:54.810

异常的*目的*是处理应该推迟到可以做一些有用的事情的时候，无论是通知用户、重试还是其他什么。*因此，在每个*函数中捕获异常通常是糟糕的设计。

正如贾斯汀所说，您可能需要捕获并重新引发异常以进行本地清理 - 这将解释 C# 代码。

在 C++ 中，惯用的方法是 RAII，它使用确定性破坏来执行本地清理，并避免捕获处理程序，这些处理程序不是真正处理但只是重新抛出。

# javascript - javascript消息队列

> ID：12977946
> 
> 赞同：1
> 
> 时间：2012-10-19T15:51:26.950
> 
> 标签：javascript, associative-array

我正在使用 javascript 创建一个消息队列，例如我想将消息“hello”和“word”存储给 id 为“123”的用户，我正在使用以下内容来设置和检索它们。

```
var messages = [];
var userId = 123;

messages[userId].push("hello");
messages[userId].push("word"); 
```

不用说，这是行不通的，该死的数组！我怎样才能使这项工作尽可能简单？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:53:37.230

`messages[userId]`不存在。

您需要在那里放置一个数组：

```
messages[userId] = []; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:59:32.380

`[]`每个用户都需要一个数组 ( )：

```
var messages = {};
var userId = 123; 
messages[userId] = ["hello", "word"]; 
```

你也可以使用`push`：

```
var messages = {};
var userId = 123; 
messages[userId] = [];
messages[userId].push("hello");
messages[userId].push("word"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T16:02:35.437

好吧，从技术上讲，您可以将元素作为您创建的对象的属性推送，然后遍历其属性。

# orm - 即时本机查询映射 openJPA

> ID：12977947
> 
> 赞同：0
> 
> 时间：2012-10-19T15:51:36.977
> 
> 标签：orm, openjpa

我想知道是否可以动态映射命名的本机查询，而不是取回 Object[] 列表，然后循环遍历并以这种方式设置对象。我有一个电话，我知道它会返回大量数据集，我希望能够将其正确映射到我的实体。我可以这样做还是必须继续循环遍历结果集。

这就是我现在正在做的......

```
List<Provider> ObjList = (List<Provider>) emf.createNativeQuery(assembleQuery(organizationIDs, 5)).getResultList(); 
```

那是我的实体，列表（我的实体是提供者）。通常我只会返回 a`List<Object[]>` 然后我会遍历它以取回所有对象并将它们设置为新提供者并将它们添加到列表中......

```
//List<Provider> provList = new ArrayList<Provider>(); 
/*for(Object[] obj: ObjList)
{
    provList.add(this.GetProviderFromObj(obj));
}*/ 
```

如您所见，我将代码的那部分注释掉以尝试此操作。我知道如果您将本机查询放在实体本身中，然后通过 createNamedQuery 调用它，您可以映射命名本机查询。我会这样做，但我需要使用`IN`oracle 关键字，因为我有一个要检查的 ID 列表。它不仅仅是一个需要的。众所周知，原生查询不能`in`很好地处理关键字。有什么建议吗？

叹息，如果 NamedNativeQueries 只支持 IN 关键字就好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T03:43:34.023

假设 Provider 被配置为 JPA 实体，您应该能够将类指定为 createNativeQuery 调用的第二个参数。例如：

```
List<Provider> ObjList = (List<Provider>) emf.createNativeQuery(assembleQuery(organizationIDs, 5), Provider.class).getResultList(); 
```

根据文档，“至少，您的 SQL 必须选择类的主键列、鉴别器列（如果已映射）和版本列（如果已映射）。”

有关更多详细信息，请参阅[OpenJPA 文档](http://openjpa.apache.org/docs/latest/jpa_overview_sqlquery_obj.html)。

# ember.js - Emberjs 计算属性可以依赖于其他模型属性吗？

> ID：12977955
> 
> 赞同：3
> 
> 时间：2012-10-19T15:52:00.367
> 
> 标签：ember.js

我有一个模型：

```
app.ObjectOne = Em.Object.extend({
    id: null,
    count: null
}); 
```

还有另一个模型，它计算了属性“SomeProperty”，我想依赖来自 ObjectOne 的属性“count”

```
app.ObjectTwo = Em.Object.extend({
    id: null,
    someProperty: function(){
      return count+5;
    }.property('app.SomeObjectController.count')

}); 
```

那么，我可以那样做吗？或者有没有其他方法可以做到；

主要思想是ObjectOne模型的数据在ObjectTwo之后，所以我要重新计算属性并重新渲染视图

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T17:41:05.910

如果我理解得很好，你想要的行为正是 Ember.js 能给你带来的。

首先，这是一个非常基本的模板：

```
<script type="text/x-handlebars">
  Here, the template is updated each time this property is updated (equivalent to bound property)
  {{App.objectTwo.someProperty}}
</script>​ 
```

这是javascript。我不知道你是否真的想在这里使用 ObjectController，但你提到它，所以我使用它。ObjectController 充当其`content`属性的代理。这意味着 someObjectController.get('count') 将尝试`count`从控制器本身获取属性，如果它不存在，则控制器`count`从其内容中检索属性。

```
App = Ember.Application.create();
App.someObjectController = Ember.ObjectController.create();

App.ObjectOne = Em.Object.extend({
  id: null,
  count: null
});
App.objectOne = App.ObjectOne.create({
  id: 1,
  count: 42
});
App.someObjectController.set('content', App.objectOne);

App.ObjectTwo = Ember.Object.extend({
  id: null,
  someProperty: function(){
    return App.someObjectController.get('count')+5;
  }.property('App.someObjectController.count')
});
App.objectTwo = App.ObjectTwo.create({
  id: 1
});

//in 3 seconds the count property is set to 0\. You can see the template is updated
Ember.run.later(function(){
   App.objectOne.set('count', 0);
},3000); 
```

这是工作的jsfiddle：http: [//jsfiddle.net/Sly7/M3727/4/](http://jsfiddle.net/Sly7/M3727/4/)

# ipad - 针对活动目录对 ipad 进行身份验证

> ID：12977959
> 
> 赞同：0
> 
> 时间：2012-10-19T15:52:15.490
> 
> 标签：ipad, security

我制作了一个 ipad 应用程序，我想在其中使用活动目录身份验证实现登录。到目前为止，我还没有找到任何关于如何做到这一点的信息。我想使用 ipad 的 mac id 对活动目录进行身份验证。我该如何实现这一点，或者是否有任何其他方式可以实现安全登录到我的应用程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T21:47:54.073

我们刚刚创建了一个免费的 SDK，使您能够将 Active Directory 身份验证添加到您的移动应用程序中。您还可以注册您的后端 Web 服务，并且移动应用程序可以为您的后端请求一个 SAML 令牌，以便在用户首次登录后为其提供单点登录。该解决方案是免费的，即使用户和设备在公共网络上也能正常工作。

如需了解更多信息，[请访问 http://www.centrify.com/mas](http://www.centrify.com/mas)

我们构建了这个服务，因为除了在应用程序中嵌入大量的 ldap 和 kerberos 之外，我们还没有看到任何其他方式来做到这一点，如果用户在公共网络上，这也将无法工作。

-大卫

# c# - System.ApplicationException

> ID：12977961
> 
> 赞同：2
> 
> 时间：2012-10-19T15:52:20.040
> 
> 标签：c#, entity-framework

我试图朗姆酒我的应用程序，我收到以下错误：System.Web.HttpUnhandledException：抛出了“System.Web.HttpUnhandledException”类型的异常。

在 ** 行代码附近抛出异常：

```
public void LoadFromEntity(bool editable, string TabKey)
    {
        //Getting the FormMaster collection
        **FormTemplate formTemplate = PolicyClassCollection.CachedPolicyClasses.FindBy((int)EnumPolicyClasses.PNI).FormTemplateCo**llection.Find(ft => ft.PolicyClassId == Utility.GetCurrentPolicyClassId() && ft.DocumentType.DocumentTypeId == (int)EnumDocumentTypes.Coverage_Summary && ft.PolicyTypeId == Utility.GetCurrentAccount().CurrentRisk.PolicyTypeId);

        if (formTemplate != null)
        {
            //Set context string with current option number
            this._Account.CurrentRisk.FormContextData = this.OptionNum.ToString();

            //getting FormMasterID
            Guid vsDatabaseId = formTemplate.FormFilingHistoryId;
            string accountXmlString = this._Account.ToXML();

            //Setting the parameters in PDFServiceParms class that are to be used in "PDFService.aspx" page.
            PDFServiceParms pdfParams = new PDFServiceParms(FORM_MODE_EDIT, vsDatabaseId.ToString(), Model.AppConstants.FORM_TYPE_SELECTED_FORM, accountXmlString);

            //Saving the parameters in the session. PDFService.aspx page reads the parameters from the session. Session key is passed in the 
            //query string when calling the PDFService.aspx page.
            Session[AppConstants.SK_SUMMARY_PDF_PARAMS] = pdfParams;

            //Setting the iFrame's source to PDFService.aspx page. The PDF document generated in this page is displayed in the iFrame.
            this.iframePdf.Attributes["src"] = ResolveClientUrl(AppConstants.PAGE_NAME_PDFSERVICE) + "?datakey=" + AppConstants.SK_SUMMARY_PDF_PARAMS;
        }
        else
            throw new ApplicationException("FormMaster not found for PolicyClass = " + Utility.GetCurrentPolicyClassId().ToString() + " and DocumentType = " + ((int)EnumDocumentTypes.Coverage_Summary).ToString());
    } 
```

**抛出异常：**

```
System.Web.HttpUnhandledException: Exception of type 'System.Web.HttpUnhandledException' was thrown. ---> System.ApplicationException: FormMaster not found for PolicyClass = 2 and DocumentType = 27
   at PNI_SqbpeCovInfoPNISummary.LoadFromEntity(Boolean editable, String TabKey) in C:\TFS\Navigate Development\NavigateWebApp\PNI\SqbpeCovInfoPNISummary.aspx.cs:line 95
   at SQBPECoverageInformationMasterPNI.LoadFromEntity() in C:\TFS\Navigate Development\NavigateWebApp\PNI\SQBPECoverageInformationMasterPNI.master.cs:line 188
   at SQBPE.Page_Load(Object sender, EventArgs e) in C:\TFS\Navigate Development\NavigateWebApp\SQBPE.master.cs:line 55
   at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e)
   at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e)
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   --- End of inner exception stack trace ---
   at System.Web.UI.Page.HandleError(Exception e)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest()
   at System.Web.UI.Page.ProcessRequest(HttpContext context)
   at ASP.pni_sqbpecovinfopnisummary_aspx.ProcessRequest(HttpContext context) in c:\Windows\Microsoft.NET\Framework64\v2.0.50727\Temporary ASP.NET Files\navigatewebapp\253cae21\57ec5e1d\App_Web_sqbpecovinfopnisummary.aspx.41d7eb59.1z9y4p0a.0.cs:line 0
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

有人可以让我知道为此需要做什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T16:28:13.230

*对不起，整个答案的编辑，以前只对了一半*

父异常是`HttpUnhandledException`. 内部异常似乎很清楚，并说：

> 未找到 PolicyClass = 2 和 DocumentType = 27 的 FormMaster

该错误在您自己的代码中。ApplicationException*没有*发生在您所指的行上。该行的结果`formTemplate`是 null 并且您的代码会引发此异常。

这是引发异常的行：

```
throw new ApplicationException("FormMaster not found for PolicyClass = " 
    + Utility.GetCurrentPolicyClassId().ToString() 
    + " and DocumentType = " 
    + ((int)EnumDocumentTypes.Coverage_Summary).ToString()); 
```

(a friendly tip, use `string.Format` instead)

And this is the line returning null:

```
FormTemplate formTemplate = PolicyClassCollection.CachedPolicyClasses
    .FindBy((int)EnumPolicyClasses.PNI).FormTemplateCollection
    .Find(ft => ft.PolicyClassId == Utility.GetCurrentPolicyClassId() 
    && ft.DocumentType.DocumentTypeId == (int)EnumDocumentTypes.Coverage_Summary
    && ft.PolicyTypeId == Utility.GetCurrentAccount().CurrentRisk.PolicyTypeId); 
```

(a friendly tip: write it out over multiple lines. That helps with setting breakpoints and with readability)

* * *

Your next question should be: why is it returning `null`? The answer, I don't know. In my previous attempt of answering I said something about third party code. And that's exactly what this is, as the class `PolicyClassCollection` is not a well-known class, there's no documentation on the internet on it. So either it is your own, in which case you can try stepping through (set a breakpoint) or it is someone else's in which case you can try calling the vendor or try stepping through after removing the "just my code" setting.

# vb.net - GridView 中数据列表中的链接按钮

> ID：12977966
> 
> 赞同：0
> 
> 时间：2012-10-19T15:52:45.513
> 
> 标签：vb.net, gridview, linkbutton, nested-datalist

我有一个有趣的 ASP/VB.NET 问题。我有一个gridview，其中每一行在模板列中都有自己的数据列表。我想向数据列表中的每个项目添加一个链接按钮，该按钮将根据数据列表中的数据触发事件。但我不知道该怎么做。它在一个项目中，因此它具有设计器文件，该文件确实列出了gridview，但没有列出gridview 内的datalist。当我尝试添加它时，数据列表的列表会在我稍后编译时被删除。

我的问题是现在我是否在 gridview 的数据列表中获取链接按钮来做某事？

```
<asp:GridView ID="gvCmteNom" runat="server" AutoGenerateColumns="False" showheader="true" HeaderStyle-BackColor="Silver" Width="1600px">
<Columns>
<asp:TemplateField HeaderText="CURRENT SERVICE">
        <ItemTemplate>
            <asp:TextBox ID="txtID" runat="server" Text='<%# Bind("NOMINEE_ID") %>' Visible="False" Width="25px" />
            <asp:DataList ID="dlCurrentCmtes" runat="server" DataSourceID="dsCurrentCmte" RepeatLayout="Flow" DataKeyField="ID" RepeatDirection="Horizontal">
                <ItemTemplate>
                    <asp:HiddenField runat="server" ID="hdnUserID" Value='<%# Eval("ID") %>' />
                    <asp:Label ID="lblDescription" runat="server" Text='<%# Eval("Description") %>' />
                    <asp:LinkButton runat="server" ID="lbIncrementYear" CommandName="IncrementYear" CommandArgument='<%# Eval("ProductID") %>' Text="Add Year" />
                </ItemTemplate>
                <SeparatorTemplate><br /><br /></SeparatorTemplate>
            </asp:DataList>
            <asp:SqlDataSource ID="dsCurrentCmte" runat="server" 
                ConnectionString="" 
                ProviderName="System.Data.SqlClient" SelectCommand="spCmteList" SelectCommandType="StoredProcedure">
                <SelectParameters>
                    <asp:ControlParameter ControlID="txtID" Name="ID" PropertyName="Text" Type="String" DefaultValue="" />
                </SelectParameters>
            </asp:SqlDataSource>
        </ItemTemplate>
    </asp:TemplateField>
</Columns> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:05:52.410

两种选择：

**选项 1** 为 DataList 指定 ItemCommand 事件处理程序并使用它来响应事件：

`<asp:DataList OnItemCommand="Item_Command" />`

然后在后面的代码中指定该函数：

```
Sub Item_Command(sender As Object, e As DataListCommandEventArgs) 
     If e.CommandName = "IncrementYear" Then
         ...
     End If
End Sub 
```

**选项 2**为链接按钮指定 OnClick 事件处理程序

`<asp:LinkButton OnClick="LinkButton_Click" runat="server"/>`

然后

```
Sub LinkButton_Click(sender As Object, e As EventArgs) 
      ...
End Sub 
```

# jquery - 动态 html5 音频文件加载不一致

> ID：12977967
> 
> 赞同：0
> 
> 时间：2012-10-19T15:52:54.120
> 
> 标签：jquery, html, audio

背景：我有一个网站根据搜索条件一次加载音频文件（1-50 个）。用户可以随时调整搜索以查看数千个音频文件的库。页面不会刷新，但会通过 AJAX 提供结果。我不能将音频标签设置为 preload="auto" 因为如果同时加载 50 个音轨，并且搜索不断变化并且搜索的人超过一个，那么浏览器将崩溃。这没什么大不了的，因为有一个解决方案。该解决方案虽然不是 100% 防弹的，如果以正确的方式完成，可能会导致音频文件的加载完全不会发生。

代码：要开始在 mouseenter 上加载音频文件，我这样做：

```
$("#mainSelector").on('mouseenter', '.classOfAudioFiles', function() {
            变种音频，
                剥离ID，
                $last_played = $('#last_played').val();
            strippedId = this.id.substring(15);
            音频 = $('#audio_'+strippedId).get(0);
            if($last_played != 'audio_'+strippedId){
                console.log('over');
                音频.play();
                音频.暂停（）；
                audio.addEventListener("canplaythrough", function(){
                    console.log('准备好了');
                    }
                );
            }
        });

```

要通过单击按钮播放音频文件，而不是播放按钮，我这样做：

```
$("#mainSelector").on('click', '.classOfAudioFiles, .classOfAudioFiles2', function(event) {
            //停止所有播放音频
            $.each($('audio'), function () {
                this.pause();
            });
            //变量
            变种音频，
                $last_played = $('#last_played'),
                alreadyPlaying = $('#' + $last_played.val()).get(0),
                $hideLastOpened = $last_played.val().substring(6),
                停止所有动作，
                点击TrackId；
            if(this.id.substring(0,15) == 'classOfAudioFiles2'){
                clickTrackId = this.id.substring(16);
                console.log('title');
            }别的{
                clickTrackId = this.id
                console.log('按钮');
            }

            if($('#last_played').val() != 'audio_'+clickingTrackId){
                //alert($last_played+' --- audio_'+clickingTrackId);
                //隐藏上次打开的
                $('#playTrack'+$hideLastOpened).hide();
                //显示加号
                $('#closePlus'+$hideLastOpened).show();
                //已经播放 = 0;
            }
            //设置最后播放
            $last_played.val('audio_'+clickingTrackId);
            //创建音频
            音频 = $('#audio_'+clickingTrackId).get(0);
            audio.addEventListener("canplaythrough", function(){
                console.log('ready2');
                }
            );

            if($hideLastOpened == $('#last_played').val().substring(6)){
                $('#last_played').val('audio_1000');
                停止所有动作 = 1；
            }别的{
                停止所有动作 = 0；
            }

            if (alreadyPlaying != undefined && stopAllActions == 1){
                已经播放.pause();

            }别的{
                //延迟播放
                设置超时（函数（）{
                    音频.play();

                }, 250);
            }
        });

```

问题：在上述任何一个代码中，我是否遗漏了什么可以确保音频文件在 100% 的时间内播放（延迟略有帮助，但不是 100%）？这更像是服务器问题吗，例如内存？还是它依赖于客户端，因此服务器调整不会做任何事情？

# c# - GridView 升序排序不起作用

> ID：12977968
> 
> 赞同：2
> 
> 时间：2012-10-19T15:52:57.573
> 
> 标签：c#, asp.net, .net, sorting, gridview

我有一个启用排序的 GridView。对于单页结果，升序和降序都可以正常工作。但是当有多个页面时，单独下降效果很好。asceding 也有效，但是当我单击下一页时，它再次变得未排序。我不知道问题是因为排序方向还是分页。请帮助。以下是代码：

```
protected void GridView1_Sorting(object sender, GridViewSortEventArgs e)
{
    GridView grid = sender as GridView;
    //Retrieve the table from the session object.
    DataTable dt = Session["List"] as DataTable;

    if (dt != null)
    {
        //Sort the data.
        dt.DefaultView.Sort = e.SortExpression + " " + GetSortDirection(e.SortExpression);
        grid.DataSource = Session["List"];
        grid.DataBind();
    }
}

private string GetSortDirection(string column)
{
    string sortDirection = "ASC";      
    string sortExpression = ViewState["SortExpression"] as string;
    if (sortExpression != null)
    {
        if (sortExpression == column)
        {
            string lastDirection = ViewState["SortDirection"] as string;
            if ((lastDirection != null) && (lastDirection == "ASC"))
            {
                sortDirection = "DESC";
            }
        }
    }
    // Save new values in ViewState.
    ViewState["SortDirection"] = sortDirection;
    ViewState["SortExpression"] = column;
    return sortDirection;
}

protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    GridView1.PageIndex = e.NewPageIndex;
    GridView1.DataSource = bindGridView();
    GridView1.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-19T08:55:57.640

您可以使用会话变量来存储最新的排序表达式，并在下次对网格进行排序时将网格的排序表达式与存储上次排序表达式的会话变量进行比较。如果列相等，则检查先前排序的方向并按相反方向排序。

```
DataTable sourceTable = GridAttendence.DataSource as DataTable;
DataView view = new DataView(sourceTable);
string[] sortData = Session["sortExpression"].ToString().Trim().Split(' ');
if (e.SortExpression == sortData[0])
 {
if (sortData[1] == "ASC")
{
    view.Sort = e.SortExpression + " " + "DESC";
    this.ViewState["sortExpression"] = e.SortExpression + " " + "DESC";
}
else
{
    view.Sort = e.SortExpression + " " + "ASC";
    this.ViewState["sortExpression"] = e.SortExpression + " " + "ASC";
}
 }
 else
{
view.Sort = e.SortExpression + " " + "ASC";
this.ViewState["sortExpression"] = e.SortExpression + " " + "ASC";
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T14:53:01.103

经过这么多研究，我找到了自己问题的正确答案。这可能会在将来帮助某人。将以下代码添加到 bindGridView()

```
if (ViewState["sortExpr"] != null)
{
     dv = new DataView(ds.Tables[0]);
     dv.Sort = (string)ViewState["sortExpr"];
}
else
    dv = ds.Tables[0].DefaultView; 
```

和

```
#region Sorting
    protected void Gridview1_Sort(object sender, GridViewSortEventArgs e)
    {
        ViewState["sortExpr"] = e.SortExpression + " " + GetSortDirection(e.SortExpression); 
        Gridview1.DataSource = bindGridView();
        Gridview1.DataBind();
    }

    private string GetSortDirection(string column)
    {
        // By default, set the sort direction to ascending.
        string sortDirection = "ASC";

        // Retrieve the last column that was sorted.
        string sortExpression = ViewState["SortExpression"] as string;

        if (sortExpression != null)
        {
            // Check if the same column is being sorted.
            // Otherwise, the default value can be returned.
            if (sortExpression == column)
            {
                string lastDirection = ViewState["SortDirection"] as string;
                if ((lastDirection != null) && (lastDirection == "ASC"))
                {
                    sortDirection = "DESC";
                }
            }
        }
        // Save new values in ViewState.
        ViewState["SortDirection"] = sortDirection;
        ViewState["SortExpression"] = column;

        return sortDirection;
    }
    #endregion 
```

# c - 如何修改Libevent中注册的事件？

> ID：12977978
> 
> 赞同：0
> 
> 时间：2012-10-19T15:53:19.763
> 
> 标签：c, events, epoll, libevent

我像这样使用libevent，

```
client->m_event = event_new(listener->m_server->m_server_base, client->m_sockfd, EV_PERSIST, Client::ClientEventCallback, client);
event_add(client->m_event, NULL); 
```

但是我不知道怎么修改m_event的事件，官方手册好像没有接口可以操作，我试过这样做，但是做核心转储。

```
short event = event_get_events(m_event);
event_del(m_event);
event_assign(m_event, m_server->m_server_base, m_sockfd, event | EV_WRITE, Client::ClientEventCallback, this);
event_add(m_event, NULL); 
```

核心转储发生在 event_assign，请帮助我...如何修改结构事件的注册事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:57:33.593

我在你的代码中看不到任何应该让你核心转储的东西，但我可能会询问你为什么再次进行 event_assign 只是为了添加`EV_WRITE`标志。如果我错了，请纠正我，但由于你`event_new`只是指定`EV_PERSIST`，我认为它不会触发（那么为什么 event_add 那时它？）看起来你应该这样做

```
client->m_event = event_new(listener->m_server->m_server_base, client->m_sockfd, EV_PERSIST | EV_WRITE, Client::ClientEventCallback, client); 
```

在顶部，然后当你准备好写的时候

```
event_add(m_event, NULL); 
```

当你写完

```
event_del(m_event); 
```

无论如何，就像我说的那样，我不认为你正在做的事情应该是一个问题，但是如果当你添加一个仅`EV_PERSIST`作为事件类型的事件然后再删除/分配它时会发生一些时髦的行为，以上可以解决。（无论如何它会更少的代码/更有效的，所以也可以:)）

# javascript - Facebook 的 JavaScript 开发工具包

> ID：12977979
> 
> 赞同：0
> 
> 时间：2012-10-19T15:53:21.323
> 
> 标签：javascript, facebook, facebook-graph-api, facebook-javascript-sdk

我想获得 facebook 的访问令牌，我从 facebook 开发者网站获得了这段代码，但它无法生成或给我任何访问令牌。我在一个简单的文本文件中使用此代码，而不是我的任何网站。

```
<div id="fb-root"></div>
<script>
<div class="fb-login-button" data-show-faces="true" data-width="400" data-max-rows="1"></div>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '377263832388887', // App ID
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });
FB.Event.subscribe('auth.authResponseChange', function(response) {
    if (response.status === 'connected') {
        // the user is logged in and has authenticated your
        // app, and response.authResponse supplies
        // the user's ID, a valid access token, a signed
        // request, and the time the access token 
        // and signed request each expire
        var uid = response.authResponse.userID;
        var accessToken = response.authResponse.accessToken;

        // TODO: Handle the access token

    } else if (response.status === 'not_authorized') {
        // the user is logged in to Facebook, 
        // but has not authenticated your app
    } else {
        // the user isn't logged in to Facebook.
    }
  };

  // Load the SDK Asynchronously
  (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
   }(document));
});
</script> 
```

我想获得访问令牌，以便我可以进一步进行我的工作。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T16:12:07.713

考虑使用[http://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/提供的代码](http://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)

将 FB.Event.subscribe 函数替换为以下内容。

```
FB.getLoginStatus(function(response) {
  if (response.status === 'connected') {
    var uid = response.authResponse.userID;
    var accessToken = response.authResponse.accessToken;

    // dump success data here, and dump response data if needed

  } else if (response.status === 'not_authorized') {

    // dump fail data here

  } else {
    // dump other fail data here
  }
  }); 
```

虽然我在[http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/](http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)上看到FB.Event.subscribe 在其结果数组中也应该有访问代码。您是否尝试将“响应”转储到控制台以查看结果？

# c++ - 在 OpenCV 中，将 2d 图像点转换为 3d 世界单位向量

> ID：12977980
> 
> 赞同：12
> 
> 时间：2012-10-19T15:53:23.237
> 
> 标签：c++, opencv, computer-vision

我已经用 OpenCV（findChessboard 等）校准了我的相机，所以我有： - 相机失真系数和内在矩阵 - 相机姿势信息（平移和旋转，通过其他方式单独计算）作为欧拉角和 4x4 - 相机框架内的 2D 点

如何将这些 2D 点转换为指向世界的 3D 单位向量？我尝试使用 cv::undistortPoints 但这似乎没有做到（仅返回 2D 重新映射的点），而且我不确定使用哪种矩阵数学方法通过我拥有的相机内在函数对相机进行建模。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-19T16:14:43.163

将您的 2d 点转换为同质点（给它一个等于 1 的第三个坐标），然后乘以相机内在矩阵的倒数。例如

```
cv::Matx31f hom_pt(point_in_image.x, point_in_image.y, 1);
hom_pt = camera_intrinsics_mat.inv()*hom_pt; //put in world coordinates

cv::Point3f origin(0,0,0);
cv::Point3f direction(hom_pt(0),hom_pt(1),hom_pt(2));

//To get a unit vector, direction just needs to be normalized
direction *= 1/cv::norm(direction); 
```

原点和方向现在定义了世界空间中与该图像点相对应的射线。请注意，此处原点以相机为中心，您可以使用相机姿势转换到不同的原点。失真系数从您的实际相机映射到针孔相机模型，应该在一开始就用于查找您的实际二维坐标。然后的步骤是

1.  使用失真系数不失真 2d 坐标
2.  转换为射线（如上图）
3.  将该射线移动到您喜欢的任何坐标系。

# java - 如何将 jtextfield 中的输入严格限制为双精度值？

> ID：12977982
> 
> 赞同：0
> 
> 时间：2012-10-19T15:53:32.850
> 
> 标签：java, swing, user-interface, jformattedtextfield

我正在编写一个 gui 代码，我想使用 JFormattedTextField 来验证我的输入是否为双精度值，但是 amountFormatter 并没有给我我输入的正确输入。所以我尝试用 ("##########") 创建一个自己的格式化程序，它给了我一个 10 位数字的数字，但我无法验证双值（因为它们通常有一个 '.' 在里面） ...

所以我的问题是：如何使用 Jformatted TextFields 简单地验证双值，或者是否有更简单的方法使用另一个 Swing 组件？

***更新*** 谢谢你的好答案！！！但是是否有可能使用 JFormatted TextField 的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:08:03.033

*   [这是JFormattedTextField](http://docs.oracle.com/javase/tutorial/uiswing/components/formattedtextfield.html)存在的基本原因，

*   `JFormattedTextField`为, 和/或 with`Locale`设置正确的数字格式化程序

*   [JSpinner](https://stackoverflow.com/a/9779203/714968)和[JFormattedTextField 也](https://stackoverflow.com/a/9366053/714968)可以

编辑

你可以从

```
NumberFormat format = NumberFormat.getNumberInstance();
format.setGroupingUsed(false);
format.setGroupingUsed(true);// or add the group chars to the filter
format.setMaximumIntegerDigits(10);
format.setMaximumFractionDigits(2);
format.setMinimumFractionDigits(5);
format.setRoundingMode(RoundingMode.HALF_UP); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T16:05:42.453

我已经实现了基于 JFormattedTextField 的数字字段。

它们还支持最小值和最大值。

也许您发现它们很有用（该库是开源的）：

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JRealNumberField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JRealNumberField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JDoubleField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JDoubleField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JFloatField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JFloatField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedRealNumberField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedRealNumberField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedDoubleField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedDoubleField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedFloatField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedFloatField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JWholeNumberField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JWholeNumberField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JByteField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JByteField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JIntegerField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JIntegerField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLongField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLongField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JShortField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JShortField.html)

教程：

[http://softsmithy.sourceforge.net/lib/docs/tutorial/swing/number/index.html](http://softsmithy.sourceforge.net/lib/docs/tutorial/swing/number/index.html)

更多信息：

[http://puces-blog.blogspot.ch/2012/07/news-from-software-smithy-version-02.html](http://puces-blog.blogspot.ch/2012/07/news-from-software-smithy-version-02.html)

主页：

[http://www.softsmithy.org](http://www.softsmithy.org)

下载：

[http://sourceforge.net/projects/softsmithy/files/softsmithy/](http://sourceforge.net/projects/softsmithy/files/softsmithy/)

马文：

```
<dependency>  
    <groupId>org.softsmithy.lib</groupId>  
    <artifactId>softsmithy-lib-core</artifactId>  
    <version>0.2</version>   
</dependency> 
```

# android - 在所有活动android中创建粘性页脚

> ID：12977985
> 
> 赞同：1
> 
> 时间：2012-10-19T15:53:39.810
> 
> 标签：android

嗨，我正在尝试创建一个粘性页脚，它将显示在我的应用程序的每个活动中，我已经有了标题，我使用 windows feautre 自定义标题栏来实现这一点，所以我的标题总是显示在我的所有活动中。

我有：

1.  使用lazyadapter从xml文件获取数据的listview活动。
2.  使用基本音频播放器进行的活动。

我想创建一个粘性页脚 si，它不仅在我滚动列表视图底部时总是显示，如下所示：

![在此处输入图像描述](../Images/03d26feccd3a2e4965d9281a798da8ca.png)

我已经有了这个：

**页脚.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
       <TextView
        android:text="Footer"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" 
        android:layout_gravity="bottom"/>

</LinearLayout> 
```

在我的列表视图活动中，我使用了：

```
View footerView = ((LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE)).inflate(R.layout.footer, null, false);
        list.addFooterView(footerView); 
```

页脚显示，但如果我滚动到列表视图的末尾不是粘性的，我可以使用哪种方法来创建粘性页脚？

谢谢。

编辑：

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">

    <ListView
        android:id="@+id/list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:divider="#b5b5b5"
        android:dividerHeight="1dp"
        android:fadingEdge="none"
        android:listSelector="@drawable/list_selector" />  

</LinearLayout> 
```

list_row.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/list_selector"
    android:orientation="horizontal"
    android:padding="5dip" >

    <!--  ListRow Left sied Thumbnail image -->
    <LinearLayout android:id="@+id/thumbnail"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:padding="3dip"
        android:layout_alignParentLeft="true"

        android:layout_marginRight="5dip">
      <!-- android:background="@drawable/image_bg" -->
        <ImageView
            android:id="@+id/miniatura"
            android:layout_width="80dip"
            android:layout_height="50dip"
            android:src="@drawable/rihanna"/>

    </LinearLayout>

    <!-- Title Of Song-->

    <TextView
        android:id="@+id/nombre"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/thumbnail"
        android:layout_marginTop="8dp"
        android:layout_toRightOf="@+id/thumbnail"
        android:text="Rihanna Love the way lie"
        android:textColor="#040404"
        android:textSize="15dip"
        android:textStyle="bold"
        android:typeface="sans" />

    <!-- Artist Name -->
    <TextView
        android:id="@+id/web"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/nombre"
        android:textColor="#343434"
        android:textSize="10dip"
        android:layout_marginTop="1dip"
        android:layout_toRightOf="@+id/thumbnail"
        android:text="Just gona stand there and ..." />

    <!-- Rightend Duration -->

    <TextView
        android:id="@+id/shoutcast"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@id/nombre"
        android:layout_marginRight="5dip"
        android:gravity="right"
        android:text="5:45"
        android:textColor="#10bcc9"
        android:textSize="10dip"
        android:textStyle="bold"
        android:visibility="gone" />
    <TextView
        android:id="@+id/logo"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@id/shoutcast"
        android:layout_marginRight="5dip"
        android:gravity="right"
        android:text="5:45"
        android:textColor="#10bcc9"
        android:textSize="10dip"
        android:textStyle="bold"
        android:visibility="gone" />

     <!-- Rightend Arrow -->
     <ImageView android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/arrow"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"/>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T16:02:33.890

您不希望您的页脚出现在列表中，因为那样它只会显示在列表的底部。相反，您希望它在根元素内部更上一层楼。页眉和页脚高度应设置为包裹内容，以便它们只占用所需的空间，并且列表应设置为 height=0dp weight=1，以便它占用所有剩余的可用空间。看看我为 main.xml 提供的这个替换。您应该在 .xml 布局文件中使用您的页脚（如果可能），并尽量避免在代码中这样做。

主要的：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">

    <ListView
        android:id="@+id/list"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:divider="#b5b5b5"
        android:dividerHeight="1dp"
        android:fadingEdge="none"
        android:listSelector="@drawable/list_selector" />  

    <include layout="footer"/>

</LinearLayout> 
```

页脚：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <TextView
        android:text="Footer"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" 
        android:layout_gravity="bottom"/>

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:58:13.517

在您的 XML 中，将其余的视图（列表视图等）包装在 ScrollView 中

# c - 无法防止链表打印功能崩溃

> ID：12977991
> 
> 赞同：0
> 
> 时间：2012-10-19T15:53:56.543
> 
> 标签：c, linked-list, loops

我有高级语言的经验，但我是 C 的新手。我已经获得了单链表的实现。每次我尝试遍历列表时，我都会内存不足（至少我认为这是正在发生的事情）。这是列表的实现：

```
/*Vertex data type.*/
typedef struct vnode {
   struct vnode *NEXT;
   int DATA;
      } VertexBody;
typedef VertexBody *TypeVertex;

/*List data type (no header, just a pointer to first item).*/
typedef TypeVertex TypeList; 
```

这是我的打印功能：

```
void print_list(TypeList *L) {
    TypeVertex v=*L;
    while(NEXT(v)!=NULL) {
        printf("%d\n", DATA(v));
        v=NEXT(v);
    }
    printf("%d\n", DATA(v));
} 
```

运行 print_list 给出以下输出（假设列表包含 3 个顶点，数据分别设置为 1、2、3）：

```
1
2
3
-94064 
```

然后程序崩溃。有什么问题？

编辑：在第一段中将“遍历”更改为“遍历”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:55:17.447

在遍历链表时，您要确保*当前*项不是`NULL`. 一旦你确认了，你想把它打印出来，然后得到下一个。

因此，这段代码：

```
void print_list(TypeList *L) {
    TypeVertex v=*L;
    while(NEXT(v)!=NULL) {
        printf("%d\n", DATA(v));
        v=NEXT(v);
    }
    printf("%d\n", DATA(v));
} 
```

应该：

```
void print_list(TypeList *L) {
    TypeVertex v=*L;
    while(v!=NULL) {
        printf("%d\n", DATA(v));
        v=NEXT(v);
    }
    printf("%d\n", DATA(v));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T02:12:26.513

看来我错误地识别了这个问题。程序崩溃了，因为我忘记为列表分配内存。我觉得自己像个白痴，但至少我可以继续前进。谢谢您的回答。

# git - git ignore filemode config isn't working

> ID：12977998
> 
> 赞同：3
> 
> 时间：2012-10-19T15:54:18.213
> 
> 标签：git, ubuntu, file-permissions, gitolite, githooks

I am using gitolite git server on a ubuntu linux server. I used a hook that will be called on every push and will update a server's directory(which include live site's source code).

Now, whenever I change something on my local pc and push the changes to server, the hook is being called and the pull request are being executed fine. But, problem is, the files which were updated, are now having changed permission. Like:

```
rwxrwxr_x (before)
rwx_____x (After) 
```

After few searches, I did came up with [this solution](https://stackoverflow.com/questions/1580596/how-do-i-make-git-ignore-mode-changes-chmod) . I did tried it with both my global git config and repository specific config settings. after setting the config, whenever I am trying to push from my local pc, the same issue is happening again like above, thus seems, for some reason, the solution isn't working.

Does anybody have any idea, what can be the reason plz? Do I have to do anything additionally besides the config settings? Any suggestions are welcome. Thanks in advance.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T17:34:04.193

As the [OP Rana](https://stackoverflow.com/users/537500/rana) confirms [in the comments](https://stackoverflow.com/questions/12977998/git-ignore-filemode-config-isnt-working/12979453#comment17602573_12977998), if the hook starts with:

```
umask 002 
```

It will generate files with the right protection.

* * *

[Alan Thompson](https://stackoverflow.com/users/1822379/alan-thompson) mentions:

> `core.filemode` only affects diffs against your working dir, not diffs between 2 commits in the repo.
> So, if you have already committed the different file modes, you'll have to use `filter-branch`, as in "[Can I make git diff ignore permission changes](https://stackoverflow.com/a/16348658/6309)".

```
git filter-branch -f --tree-filter 'find * -type f | xargs chmod 644 ' -- --all 
```

# windows-7 - Python 3：当我输入 y 时，为什么 ['y', 'Y'] 中的 input() 结果为假？

> ID：12977999
> 
> 赞同：1
> 
> 时间：2012-10-19T15:54:18.850
> 
> 标签：windows-7, input, python-3.2

我对 Python 很陌生。我在一个文件中编写了以下脚本：

```
# ...\temp\test.py
x = (input() in ['y', 'Y'])
print(x) 
```

并在命令行中运行它：

```
python test.py

y

False 
```

据我了解，打印结果应该是 True。但实际结果是假的。为什么是这样？

我的环境：操作系统：win7 Python：3.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T12:39:33.490

它在 Ubuntu 中对我来说很好用。我能想到的唯一一件事是 Windows 坚持额外的空白空间。尝试这个：

```
x = (input().strip() in ['y', 'Y']) 
```

如果这不起作用，请执行以下操作：

```
y = input()
x = (y in ['y', 'Y'])
print(y)
print(x) 
```

然后您将能够看到 input() 实际上返回了什么