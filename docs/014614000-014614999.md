# StackOverflow 问答 14614000-14614999

# python - 如何将 Python 的 itertools.product 库从列表理解转换为正常的 for 循环？

> ID：14614004
> 
> 赞同：1
> 
> 时间：2013-01-30T21:19:49.957
> 
> 标签：python, for-loop, list-comprehension, itertools

根据[http://docs.python.org/2/library/itertools.html#itertools.product](http://docs.python.org/2/library/itertools.html#itertools.product)以下功能相当于使用他们的库（我删除了一些我不需要的东西）：

```
def product(*args):
    # product('ABCD', 'xy') --> Ax Ay Bx By Cx Cy Dx Dy
    pools = map(tuple, args)
    result = [[]]
    for pool in pools:
        result = [x+[y] for x in result for y in pool]
    for prod in result:
        yield tuple(prod) 
```

在我的情况下，我正在传递产品功能 3 列表，但我需要添加一些条件检查，因此如果它们不符合要求，它不会将一个列表中的某些项目与另一个列表中的项目混合。所以我认为我需要做的是转换：

```
result = [x+[y] for x in result for y in pool] 
```

进入“正常” FOR 循环（不知道如何引用它们），所以我可以添加几个 IF 检查来验证列表中的项目是否应该混合在一起。

主要让我感到困惑的是“x”正在遍历空的“结果”列表，但是在它迭代时会添加项目，所以我认为这对我来说是使转换为正常循环变得复杂的原因。

这是我的尝试之一：

```
def product(*args):
    pools = map(tuple, args)
    result = [[]]
    for pool in pools:
        for x in result:
            for y in pool:
                result.append(x+[y])
    for prod in result:
        yield tuple(prod) 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T21:49:53.490

您非常接近：嵌套列表推导式的右侧的编写顺序与您编写 for 循环的顺序相同，因此您做对了。但是，在 listcomp 版本中，首先计算分配的 RHS，然后将其绑定到 LHS 上的名称。所以

```
result = [x+[y] for x in result for y in pool] 
```

需要成为

```
new_result = []
for x in result:
    for y in pool:
        new_result.append(x+[y])
result = new_result 
```

这样您就不会`result`在迭代它时进行修改。如果您想禁止某些安排 -*并且您可以编写约束以使其适用于从左到右填充的迭代顺序*- 那么您可以这样做：

```
def filtered_product(args, filter_fn):
    pools = map(tuple, args)
    result = [[]]
    for pool in pools:
        new_result = []
        for x in result:
            for y in pool:
                new_val = x+[y]
                if filter_fn(new_val):
                    new_result.append(x+[y])
        result = new_result
        print 'intermediate result:', result
    for prod in result:
        yield tuple(prod) 
```

这使

```
In [25]: list(filtered_product([[1,2,3], [4,5,6], [7,8,9]], lambda x: sum(x) % 3 != 2))
intermediate result: [[1], [3]]
intermediate result: [[1, 5], [1, 6], [3, 4], [3, 6]]
intermediate result: [[1, 5, 7], [1, 5, 9], [1, 6, 8], [1, 6, 9], [3, 4, 8], [3, 4, 9], [3, 6, 7], [3, 6, 9]]
Out[25]: 
[(1, 5, 7),
 (1, 5, 9),
 (1, 6, 8),
 (1, 6, 9),
 (3, 4, 8),
 (3, 4, 9),
 (3, 6, 7),
 (3, 6, 9)] 
```

与简单地使用相比，这是否会给您带来任何好处`(p for p in itertools.product(whatever) if condition(p))`取决于您可以修剪多少分支，因为您可以看到它在内存中构造了所有中间列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T21:53:32.740

product 函数通常以归约操作的形式将列表相乘，如果您尝试随时过滤结果，这可能对您没有帮助。相反，您应该编写一个带有固定数量列表的产品函数：

```
for x in list1:
    for y in list2:
        for z in list3:
            if condition(x, y, z):
                yield tuple(x, y, z) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-30T21:49:49.463

请注意，在 , 行`result = [x+[y] for x in result for y in pool]`中`result`出现了两次，但不相关。此表达式使用旧的 构建一个列表`result`，然后将这个新列表分配给`result`。

这可能就是让你感到困惑的原因。等效的扩展版本是：

```
def product(*args):
    pools = map(tuple, args)
    result = [[]]
    for pool in pools:
        tmp = []
        for x in result:   # note that it's the old 'result' here
            for y in pool:
                tmp.append(x+[y])
        result = tmp
    for prod in result:
        yield tuple(prod) 
```

# r - 如何生成具有命名因子水平的 block.random 实验设计

> ID：14614006
> 
> 赞同：0
> 
> 时间：2013-01-30T21:19:52.157
> 
> 标签：r

`block.random()`来自`psych`库的工具是创建[块随机](http://en.wikipedia.org/wiki/Randomized_block_design)实验设计的好工具，但是，所编写的函数要求您在开始之前进行一些计算，并生成一个仅包含实验因素水平的数字索引的矩阵。

一个植物生长实验示例，其中包含您在着手进行实验设计时通常知道的信息：

*   两个实验因素，比如肥料和阳光
*   三级肥料（5mL/天、10mL/天、20mL/天）
*   两级阳光（直射阳光，阴影）
*   您的功效分析告诉您每组需要 15 个样本

您可以通过以下方式使用 block.random：

```
> plan=block.random(n=90,c(fertilizer=3,sunlight=2))
> headtail(plan)
    blocks fertilizer sunlight
S1       1          3        2
S2       1          2        1
S3       1          3        1
S4       1          1        1
...    ...        ...      ...
S87     15          3        2
S88     15          2        1
S89     15          1        1
S90     15          1        2 
```

好的很好，但有两个问题：

*   您必须意识到在使用该功能之前您需要总共 90 个样本（每组 15 个，乘以 3 级肥料，乘以 2 级阳光）这是一个很容易解决的问题
*   您不必直接使用输出，因为您必须将因子的数值水平（肥料 1:3，阳光 1:2）与实际水平（5mL/天、10mL/天、20mL /天施肥）和（阳光直射，阳光遮荫）

我宁愿有一些东西，包括我的级别名称，我可以直接打印以供参考或快速格式化为表格以包含在报告中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:19:52.157

使用一个简单的包装函数 for `block.random()`，以上所有操作都是可能的。

```
create.randomization.plan <- function(n.per.group, factors, seed=NULL){
  factor.lengths <- sapply(factors,length)
  if(!is.null(seed)){
    set.seed(seed)
  }
  plan <- as.data.frame(block.random(n.per.group*prod(factor.lengths),
                                     factor.lengths))
  for(i in 1:length(factors)){
    plan[,colnames(plan)==names(factors)[i]] <-
      factor(plan[,colnames(plan)==names(factors)[i]])
    levels(plan[,colnames(plan)==names(factors)[i]]) <- factors[[i]]
  }
  return(plan)
} 
```

用法是这样的：

```
> factors <- list(fertilizer=c("5mL/day", "10mL/day", "20mL/day"),
+                 sunlight=c("direct sun", "shade"))
> 
> plan <- create.randomization.plan(15, factors)
> headtail(plan)
    blocks fertilizer   sunlight
S1       1   10mL/day      shade
S2       1   20mL/day direct sun
S3       1   20mL/day      shade
S4       1    5mL/day direct sun
...    ...       <NA>       <NA>
S87     15   10mL/day      shade
S88     15    5mL/day direct sun
S89     15   10mL/day direct sun
S90     15   20mL/day direct sun 
```

您还可以设置可重复性的种子：`create.randomization.plan(15, factors, seed=123)`

# windows - 自定义 Windows 8 网格应用程序模板中的每个项目

> ID：14614013
> 
> 赞同：3
> 
> 时间：2013-01-30T21:20:08.943
> 
> 标签：windows, grid

我想自定义 Windows 8 Grid App 中的一些项目，与以下默认模板不同：

SampleDataItem(String uniqueId, String title, String subtitle, String imagePath, String description, String content, SampleDataGroup group)

对于某些数据项，我想添加一些 UI 控件，例如 mediaElement 或动画。对于其他人，我没有。

有没有可能的方法来处理这样的问题？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T14:23:04.843

您需要为 Base 创建一个新的构造函数以使用新的自定义构造函数。像这样：

```
public abstract class SampleDataCommon : PrototypeCeA.Common.BindableBase
{
    private static Uri _baseUri = new Uri("ms-appx:///");
//Base constructor

    public SampleDataCommon(String uniqueId, String title, String subtitle, String imagePath, SolidColorBrush Background)
    {
        this._uniqueId = uniqueId;
        this._title = title;
        this._subtitle = subtitle;
        this._imagePath = imagePath;
        this._background = Background;
    }

    // new customized constructor
    public SampleDataCommon(String uniqueId, String title, String subtitle, bitmapImage image, String description, String Author)
    {
        this._uniqueId = uniqueId;
        this._title = title;
        this._subtitle = subtitle;
        this._description = description;
        this._image = image;
        this._author = author;
    }
} 
```

现在，您需要将此新构造函数调用到一个新的自定义类（或现有类）中以填充您的网格项。

*   我的英语很差，对不起！

# zlib - zlib 压缩大缓冲区与许多小缓冲区？

> ID：14614014
> 
> 赞同：0
> 
> 时间：2013-01-30T21:20:24.593
> 
> 标签：zlib

我正在压缩具有许多字段的数据结构。哪个更好的方法是使用 gzwrite 压缩并写入每个字段的文件，或者将所有字段写入缓冲区并压缩？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:26:42.823

单独的调用`gzwrite`不会使字段压缩*分开*：它们将位于单个压缩流中，就好像您已经通过一次调用编写了它们一样。如果您想`gzclose`在两者之间重新打开，那么就会有所不同。

（我认为您知道单独流与单个流的权衡：使用单个流，压缩更好，但您无法仅解压缩您需要的字段。但同样，您的问题中没有这样的权衡：`gzwrite`按原样调用方便你，结果是一样的）。

# php - 回显最后五个 div

> ID：14614030
> 
> 赞同：-2
> 
> 时间：2013-01-30T21:21:32.290
> 
> 标签：php, regex, domparser

我将如何使用 php 到`echo`最后 5 个 div？

例如，这个字符串：

```
<div style='df">cool</div><div>cooletre</div><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div> 
```

我该怎么做？使用 domparser、正则表达式或什么？

可以对此进行修改以实现此目的吗？这里的代码获取前五个，但我想获取*最后*五个。

```
$string = '<div class="div">1</div><div class="div">2</div><div class="div">3</div><div class="div">4</div><div class="div">5</div><div class="div">end!</div>';

$dom = new DOMDocument();
$new_dom = new DOMDocument;
$dom->loadHTML($string);

$count = 0;
foreach ($dom->getElementsByTagName('div') as $node)
{
    $new_dom->appendChild($new_dom->importNode($node, TRUE));
    if (++$count >= 5)
        break;
}

echo $new_dom->saveHTML(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:26:08.993

一个不太聪明的方法是计算所有打开`div`标签。假设你得到 n。现在找到第 n-5 个`div`标签，然后从那里找到第 5 个结束`div`标签。介于两者之间的一切都是您要寻找的。

`div`可以这样获得开始标签的数量：

```
$num_div_tags = count(explode('<div', strtolower($string))) - 1; 
```

从那里开始，找出倒数第五个`div`标签应该相当简单。

这个解决方案的优雅与 PHP 的优雅完美契合。

如果您对这个解决方案不满意，您不妨想出一个简单的有限状态机，它逐个字符地遍历字符串，检测开始和结束`div`标签，将每一对保存在长度为 5 的循环列表中并打印到达字符串末尾后的所有列表元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T02:18:37.413

用 xpath 怎么样？

```
$xpath = new DOMXPath($dom);
foreach($xpath->query('//div[position()>last()-5]') as $div){
  echo $dom->saveHTML($div);
} 
```

# vba - 复制包含合并单元格的表格行

> ID：14614034
> 
> 赞同：4
> 
> 时间：2013-01-30T21:21:53.660
> 
> 标签：vba, ms-word, runtime-error

我需要插入一组行的多个副本，其格式如下所示。

```
+-------------------------------------------------- +
| 1,1 |
+-------------------------------------------------- +
| | 2,2 | | 2,4 | |
| 2,1 +---------+ 2,3 +---------+ 2,5 |
| | 3,2 | | 3,4 | |
+-------------------------------------------------- +
| 4,1 |
+-------------------------------------------------- +
| | 5,2 | | 5,4 | |
| 5,1 +---------+ 5,3 +---------+ 5,5 |
| | 6,2 | | 6,4 | |
+-------------------------------------------------- +

```

在案例 A 中，我需要在第 4 行之前插入第 1-3 行的多个副本。

在案例 B 中，我需要在表格末尾插入第 4-6 行的多个副本。

table.rows(n) 方法不起作用并给出以下错误：

> 运行时错误“5991”：
> 
> 无法访问此集合中的各个行，因为该表具有垂直合并的单元格

但是，可以从用户界面做到这一点，所以它一定是可能的！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T11:43:09.030

这是我克服问题的方法（在 Word 2007 和 Word 2003 中测试）

```
Sub CaseA()

    Dim D As Document, T As Table

    Set D = ActiveDocument

    Set T = D.Tables(1)     '   select the first table in the document
                '   select from the start of row 1 to the start of row 4
    D.Range(T.Cell(2, 1).Range.Start, T.Cell(4, 1).Range.Start).Select

    Selection.Copy          '   copy the rows
                            '   move the insertion point to the start of row 4
    Selection.Collapse wdCollapseEnd 

    Selection.Paste         '   insert a copy
                                    '   (can do this as many times as you want)

End Sub

Sub CaseB()

    Dim D As Document, T As Table

    Set D = ActiveDocument

    Set T = D.Tables(1)
' select from the start of row 5 to the end of the last cell present in row 6
' plus 1 character for column 5 plus 1 character to move outside the table
    D.Range(T.Cell(5, 1).Range.Start, T.Cell(6, 4).Range.End + 2).Select

    Selection.Copy          '   copy the rows
                            '   move the insertion point just outside the table
    Selection.Collapse wdCollapseEnd

    Selection.Paste         '   insert a copy

End Sub 
```

# sql-server - 在 SQL Server 报表生成器中使用分区求和

> ID：14614035
> 
> 赞同：1
> 
> 时间：2013-01-30T21:21:55.933
> 
> 标签：sql-server, reportbuilder

我有一个加入客户及其订单的视图，列如下：

```
CustomerId   Gender    OrderNo    OrderDate   OrderYear   OrderMonth   OrderQuarter
==================================================================================== 
```

当给定日期时，报告应该提取日期部分（年、季度、月）并查询此视图以给出如下所示的矩阵：

```
 NoOfCustomersForTheMonth    NoOfCustomersForTheQuarter    NoOfCustomerForTheYear
===========================================================================================================
New Customers    MALE         20                              100                         400
                 FEMALE       30                              200                         500
TOTAL                         50                              300                         900 
```

在不改变视图的情况下这可能吗？我希望我的解释足够清楚。如果其他人回答了这个问题，我也很抱歉，请指出正确的方向，我将欠你一条命 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:27:24.443

虽然我看不到您的数据是什么样的，但您应该能够使用聚合函数和`CASE`表达式生成此报告：

```
select gender,
  count(case when OrderMonth = 1 then CustomerId end) NoCustomersForMonth,
  count(case when OrderQuarter = 1 then CustomerId end) NoCustomersForQuarter,
  count(case when OrderYear = 2013 then CustomerId end) NoCustomersForYear
from yourview
group by gender 
```

在内部，`CASE`您将替换 , 的值`OrderMonth`，`OrderQuarter`并`OrderYear`使用您需要的值

# python - 如何避免变量在许多请求中保持不变？

> ID：14614038
> 
> 赞同：0
> 
> 时间：2013-01-30T21:22:03.127
> 
> 标签：python, django, django-views

我的视图有装饰器，它创建新实例`SomeClass`并使用此参数调用原始视图函数。

```
def decorator(orig_func):
    def inner_func(request, *args, **kwargs):
        api = SomeClass(request)
        return orig_func(request, api, *args, **kwargs) 
```

问题是内部的属性（变量）`SomeClass`似乎在许多请求中都是持久的——例如，当`view_one`它执行时，它会在 apu (SomeClass) 类中设置一些属性。在对这些属性的第二次请求中，`view_two`仍然使用第一次请求中的值进行设置。我怎样才能避免这种情况？我需要简单的解决方案。

* * *

这是SomeClass：

```
class SomeClass:
    some_variable = None

    def __init__(self,value):
        #self.some_variable = None

    def setVariable(self,value):
        self.some_variable = value

    def getVariable(self):
        return self.some_variable 
```

我的问题是，当请求被执行并且被评论的行被评论时， some_variable 不是必需`None`的——它在之前的请求中设置了值。所以我写了这个注释行来“清除”变量。

现在我有一个问题 - 这安全吗？是否有可能在另一个请求执行期间一个请求将清除此变量，并在另一个请求中将其覆盖为 None？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T12:04:52.917

以下是您想要的正确类定义。

```
class SomeClass:
    def __init__(self,value):
        self.some_variable = value

    def setVariable(self,value):
        self.some_variable = value

    def getVariable(self):
        return self.some_variable 
```

这将在对象上`instance`而不是在`class`对象上设置属性。

```
>>> a = SomeClass(5)
>>> a.some_variable # Just as expected
5
>>> b = SomeClass(10)
>>> b.some_variable # This is its own variable
10
>>> b.some_variable = 20 # This won't change 'a'
>>> a.some_variable # Hasn't changed
5 
```

我可能还想注意这一点，`getters`并且`setters`在编写 python 时通常不想要你想要的，因为你可以`instance.some_variable = 5`在不需要 getter 或 setter 的情况下做到这一点。

# email - Google Apps 脚本的工作流程通过电子邮件批准正确的行

> ID：14614041
> 
> 赞同：0
> 
> 时间：2013-01-30T21:22:13.647
> 
> 标签：email, workflow, google-apps-script, spreadsheet, rows

我正在使用 Google Apps 脚本创建工作流程。我看过[这个视频](http://www.youtube.com/watch?v=96URE_-aj-8)的大部分布局。

我在 Google Apps 脚本中构建了一个表单，该表单从用户那里获取输入数据。然后将数据提交到具有`e.parameter`值的行中。然后将该数据通过电子邮件发送给审批者。审批者有一个批准按钮，他们按下该按钮可将“状态”列更改为已批准。

**问题：** 我无法获取数据来批准正确的行。我正在传递一个`row`应该对应于正确行的参数，但它不起作用。

这是我将数据提交到电子表格的代码，一旦数据通过电子邮件获得批准。该`DoPost`函数运行并批准该行。有人可以请帮忙！我整天都在努力寻找解决方案。

```
function sendEmail_(e) {
  var sheet = SpreadsheetApp.openById("0AuCblud0Ss7BdHA1bXZjYXA0Y0IyekhUQm5vWG02MVE").getActiveSheet();

  var range = sheet.getRange(sheet.getLastRow() + 1, 1, 1, 13);
  range.setValues([
    [e.parameter.LastName, e.parameter.FirstName, e.parameter.DivisionName, e.parameter.EffectiveDate,
    e.parameter.Network, e.parameter.EmployeeNewPosition, e.parameter.DivisionFolder, e.parameter.SpecificIndividual,
    e.parameter.Email, e.parameter.username, e.parameter.who, e.parameter.Banner, "Unapproved"]
  ]);

  var row = sheet.getLastRow() + 1;
  //"https://script.google.com/a/macros/wichitafallstx.gov/s/AKfycbwOgTTGqNsVwnqs-xfqa7TEJWGc_lJZdoyoEoixngKdDemVQuo/exec
  var body = '<form action= <form action = " https://sites.google.com/a/macros/wichitafallstx.gov/s/AKfycbxAOGO6q9ofauf34xlDA9sLG8sUXeZsuvQkDKATOQ/exec" method ="post">' +

    "<b>Last Name:</b>" + e.parameter.LastName + '<br><br>' +
    "<b>First Name:</b>" + e.parameter.FirstName + '<br><br>' +
    "<b>Division Name:</b>" + e.parameter.DivisionName + '<br><br>' +
    "<b>Effective Date:</b>" + e.parameter.EffectiveDate + '<br><br>' +
    "<b>Network:</b>" + e.parameter.Network + '<br><br>' +
    "<b>Employee New Position:</b>" + e.parameter.EmployeeNewPosition + '<br><br>' +
    "<b>Division Folder:</b>" + e.parameter.DivisionFolder + '<br><br>' +
    "<b>Specific Individual:</b>" + e.parameter.SpecificIndividual + '<br><br>' +
    "<b>Email:</b>" + e.parameter.Email + '<br><br>' +
    "<b>Username:</b>" + e.parameter.username + '<br><br>' +
    "<b>who:</b>" + e.parameter.who + '<br><br>' +
    "<b>Banner:</b>" + e.parameter.Banner +

    '<br />' +
    '<br />' +
    '<input type="hidden" name="row" value=" ' + row + ' "/>' +
    '<input type="submit" value="Approve" onclick="approve()" />' +
    '</form>';

  var owners = SitesApp.getSite("wichitafallstx.gov", "information-systems").getOwners();
  var mail = MailApp.sendEmail(owners.join(","), "test", '', {
    htmlBody: body
  });
}

//handles the payload that is posted back to appscript..from the form that is passed from the form created in send email.
function doPost(e) {
  var r = e.parameter["row"];
  var sheet = SpreadsheetApp.openById("0AuCblud0Ss7BdHA1bXZjYXA0Y0IyekhUQm5vWG02MVE").getActiveSheet();
  var values = sheet.getRange(r, 1, 1, 13).getValues();

  sheet.getRange(r, 13).setValue("Approved");

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T02:21:22.297

> 我正在传递一个应该对应于正确行但它不起作用的行参数。

看来您正在传递预期行下方的行。

```
 var range = sheet.getRange(sheet.getLastRow() + 1, 1, 1, 13);
  range.setValues([
    [e.parameter.LastName, e.parameter.FirstName, e.parameter.DivisionName, e.parameter.EffectiveDate,
    e.parameter.Network, e.parameter.EmployeeNewPosition, e.parameter.DivisionFolder, e.parameter.SpecificIndividual,
    e.parameter.Email, e.parameter.username, e.parameter.who, e.parameter.Banner, "Unapproved"]
  ]);

// In assignment below 'new' lastRow is the row you just filled 
// in with above and should not include + 1
  var row = sheet.getLastRow()   // no + 1; 
```

# cocoa - 删除 nstableview 中包含内容的列

> ID：14614042
> 
> 赞同：-1
> 
> 时间：2013-01-30T21:22:20.503
> 
> 标签：cocoa, nstableview

我有一个带有一个文本框列和 7 个复选框列的表格视图。该表最终将充满数据，稍后我必须删除中间某处的一列。与表关联的数组会发生什么？我应该如何正确处理这个？你会怎么做？由于我是初学者，请在您的答案中明确！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T21:42:04.833

您是否学会了如何向表格视图提供数据？我建议在你尝试解决这个问题之前让它工作。

有两种方法可以将数据获取到表视图：表视图数据源和 Cocoa Bindings。

如果您使用数据源，则需要编写`-tableView:objectValueForTableColumn:row:`以便在删除列之前或之后它可以正常工作。一种方法是将该代码基于列的标识符而不是其索引。标识符是您在笔尖的列上设置的值（查找**Identifier**）。这与您可以用来为重新排序的列提供正确数据的技术相同。

```
NSString *identifier = [column identifier];
if ([identifier isEqualToString:@"firstField"]) {
    return ...
} else if ([identifier isEqualToString:@"secondField"]) {
    return ...
} 
```

如果您使用 Cocoa Bindings，您只需删除一列，其他列将继续工作。

如果您使用的是数组或数组控制器，则在任何情况下，当您删除列时，数组都不会自动发生任何事情。

# asp.net-mvc - 避免 CSRF 这样做是一个好习惯吗？(ASP.NET MVC 3)

> ID：14614043
> 
> 赞同：1
> 
> 时间：2013-01-30T21:22:20.620
> 
> 标签：asp.net-mvc, csrf, antiforgerytoken

我有一个关于使用 MVC 3 提供的 AntiForgeryToken 的问题。

我将尝试解释我的想法。

基本思想是一个 Ajax 按钮，用于“标记为收藏”目录中的一个（或多个）项目。所以我有一个包含整个项目列表的网格，每个项目都有一个按钮可以设为收藏夹。

嗯......我的想法实现是这样的：

当用户按下最喜欢的按钮时，这会向服务器发送一个 GET 请求以检索带有 AntiForgeryToken 的 partialView（所有这些对用户都是透明的，因为发生在后台）。

因此，当加载表单时，站点会自动提交（POST）数据（项目的 id 和 antiforgerytoken）以将此项目标记为收藏（再次......这发生在后台，因此用户永远看不到任何东西）。

这是 Firebug 上请求/响应的想法：

```
GET http://localhost/User/Favorite/Mark?url=156

Response from GET:

<form action="/User/Favorite/Mark?url=156" method="post">
<input name="__RequestVerificationToken" type="hidden" value="WVXhVJJ3VNB8HrZQ6CZBPt35z2zvDjaHmlYWrnCvJoDUgeWMEGUGwm3clCD27vFAsxbs0upiRdVdo9Wsus Z7B6SU NQgV3iSYTUtE/EREWqT1Is/kwNZpdNf/3Pi7fD572pO89lTdYEjL0OlzmPJ5tmRQEUq/oMbuj0MnmPZskykGz6HzRmgC4Ez2bBoCp4" />
</form>

-----------------------------

Then Submit the form with the AntiForgeryToken:

POST http://localhost/User/Favorite/Mark?url=156

__RequestVerificationToke...    WVXhVJJ3VNB8HrZQ6CZBPt35z2zvDjaHmlYWrnCvJoDUgeWMEGUGwm3clCD27vFAsxbs0upiRdVdo9Wsus Z7B6SU NQgV3iSYTUtE/EREWqT1Is/kwNZpdNf/3Pi7fD572pO89lTdYEjL0OlzmPJ5tmRQEUq/oMbuj0MnmPZskykGz6HzRmgC4Ez2bBoCp4 
```

我的问题很简单。这是为 Ajax 请求获取 AntiForgeryToken 的好习惯吗？还是一个坏主意？

我有这个问题是因为我不知道这个想法是否可以在我的网站上在这个特定操作中利用漏洞。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:20:09.213

当用户点击“收藏夹”并使用页面中已有的 AntiForgery 令牌时，为什么不直接向服务器发送请求（使用 AJAX）？您的方法不必要地过于复杂。

请参阅[使用 MVC 4 RC 为 Web API 实现 ValidatingAntiForgeryToken 属性的问题](https://stackoverflow.com/questions/11725988/problems-implementing-validatingantiforgerytoken-attribute-for-web-api-with-mvc/11726560#11726560)以及如何将令牌放入 Ajax 请求的相关链接。

# doxygen - 如何在 doxygen 中添加新的警告？

> ID：14614045
> 
> 赞同：2
> 
> 时间：2013-01-30T21:22:27.617
> 
> 标签：doxygen

如果文件缺少 @author 或 @date 标记，我希望 Doxygen 生成警告。是否可以生成新类型的警告，或者是否有另一种方法来完成我想做的事情？

谢谢。

# javascript - 需要帮助将单个数组值传递给动态创建的元素上的附加函数

> ID：14614046
> 
> 赞同：0
> 
> 时间：2013-01-30T21:22:30.890
> 
> 标签：javascript

我无法将数组的值放入动态创建的元素上添加的事件的函数调用中。

所以这里是工作得很好的硬编码版本：

```
var parent_item = document.getElementById("developers_container");

var part = document.createElement('div');
part.id = "developer_A";
part.name = "developer_A";
part.className = "developer_block_un";
part.onmouseover = function() { hilight_dev('A',true)};
part.onmouseout = function() { hilight_dev('A',false)};
parent_item.appendChild(part);

var parent_item = document.getElementById("developer_A");

var part = document.createElement('span');
part.id = "developer_title_A";
part.name = "developer_title_A";
part.className = "developer_un";
part.innerHTML = "John Doe";
part.onclick = function() { select_dev('A')};
parent_item.appendChild(part); 
```

基本上，它的作用是创建一个供选择的用户列表。每个用户的列表都有 mouseover、mouseoff 和 onclick 事件。目前正在为每个用户复制上述代码的内容。

我想用基于数组的函数替换重复项：

```
var dev_id = new Array();
var dev_fn = new Array();
var dev_ln = new Array();

document.getElementById("developers_container").innerHTML = "";

dev_id[0] = "A";
dev_fn[0] = "John";
dev_ln[0] = "Doe";

dev_id[1] = "B";
dev_fn[1] = "John";
dev_ln[1] = "Smith";

dev_id[2] = "C";
dev_fn[2] = "John";
dev_ln[2] = "Jones";

dev_id[3] = "D";
dev_fn[3] = "John";
dev_ln[3] = "Yougetthepoint";

document.getElementById("developers_container").innerHTML = "";

for(var i = 0; i < dev_id.length; i++) 
{
    var parent_item = document.getElementById("developers_container");

    var part = document.createElement('div');
    part.id = "developer_"+dev_id[i];
    part.name = "developer_"+dev_id[i];
    part.className = "developer_block_un";
    part.onmouseover = function() { hilight_dev(dev_id[i],true)};
    part.onmouseout = function() { hilight_dev(dev_id[i],false)};
    parent_item.appendChild(part);

    var parent_item = document.getElementById("developer_"+dev_id[i]);

    var part = document.createElement('span');
    part.id = "developer_title_"+dev_id[i];
    part.name = "developer_title_"+dev_id[i];
    part.className = "developer_un";
    part.innerHTML = dev_fn[i]+"<BR>"+dev_ln[i];
    part.onclick = function() { select_dev(dev_id[i])};
    parent_item.appendChild(part);
} 
```

除了添加的事件之外，每一点都工作得很好。在函数代码中使用“dev_id[i]”的地方（如“part.onmouseover = function() { hilight_dev(dev_id[i],true)};”），它似乎没有做任何事情。事件触发并调用函数，但传递的变量是“未定义”，而不是应有的用户 ID。

我希望这里有人知道如何让它工作。谷歌搜索不是很有帮助，这是我花了半天时间试图弄清楚的那些愚蠢的小问题之一。非常感谢任何和所有帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:31:35.567

```
 part.onmouseover = function(i) { 
  return function() { hilight_dev(dev_id[i],true) }
}(i) 
```

在调用函数时，循环中的变量 i 未定义，您需要在其上形成一个闭包以保持其值。请参阅 Douglas Crockford 的“JavaScript, the Good Parts” 以获得关于此的详细解释

Err.. 在 Neil 的评论之后.. 是的.. i 不是未定义的.. 它始终是 dev_id 的长度.. 无论如何，这不是操作想要的:)

# c# - 如何将文本/XML 文件上传到 Web 服务

> ID：14614052
> 
> 赞同：1
> 
> 时间：2013-01-30T21:22:52.450
> 
> 标签：c#, .net

我有一个具有用户名和密码身份验证模式的 Web 服务 URL。我必须先传递用户名和密码，如果我通过了身份验证，我可以将文本或 XML 文件上传到服务器上。我正在寻找一个 C# 代码来执行相同的过程，但我找不到它。

任何建议将不胜感激。

我正在使用以下代码-

```
 if (!string.IsNullOrEmpty(txtfile))
            {
                HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(url);
                request.KeepAlive = false;
                request.SendChunked = true;
                request.AllowAutoRedirect = true;
                request.Method = "Post";
                request.ContentType = "text/xml";
                request.Credentials = new NetworkCredential(userName, password);
                var encoder = new UTF8Encoding();
                var data = encoder.GetBytes(txtfile);
                request.ContentLength = data.Length;
                var reqStream = request.GetRequestStream();
                reqStream.Write(data, 0, data.Length);
                reqStream.Close();
                WebResponse response = null;
                response = request.GetResponse();
                var reader = new StreamReader(response.GetResponseStream());                   

            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:35:59.760

您可能想尝试使用[WebClient 类](http://msdn.microsoft.com/en-us/library/tt0f69eh.aspx)。有一个关于[WebClient.UploadFile 方法](http://msdn.microsoft.com/en-us/library/esst63h0.aspx)的简单示例可以适合您的场景。

# c - 增量运算符（++）和加法（+）运算符有什么区别？

> ID：14614058
> 
> 赞同：1
> 
> 时间：2013-01-30T21:23:11.267
> 
> 标签：c

`++`增量运算符和加法运算符有什么区别`+`？为什么我们不能使用`+`代替`++`？

`++`/`--`运算符比`+`/有什么优势`-`？它们究竟适用于什么地方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T21:26:50.763

x++;

对比

```
x = x + 1; 
```

主要优势来自前增量与后增量：

例如

```
x = 1;
y = 1;

a = x + 1; // a is 2, x  is 1  - e.g. does not modify x

a = ++x;   // a is 1, x is 2
b = y++;   // b is 2, y is 2 
```

主要的缺点是像

```
a = ++x + x--; 
```

是未定义的行为。完全依赖于编译器，任何试图找出“错误”的人都会陷入困境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T21:33:21.233

C 标准给出的唯一区别是`x`. 对于正常变量，差异通常无关紧要。如果编译器可以证明在`x = x + 1`的两个评估中`x`应该给出相同的值，它可能会优化它。

如果`x`例如声明为 volatile 或涉及对函数的评估，则评估*必须*进行两次。例子：

```
unsigned* f(void); 
```

然后

```
*f() = *f() + 1; 
```

与

```
++(*f()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T02:24:14.373

一元运算符 (++, --) 主要是为了方便 - 例如，它`x++`比编写更容易编写`x = x + 1`。

`++`也可以用来做“前增量”或“后增量”。如果您写入`x++`，则增加 的值并返回`x`原始值。`x`例如：

```
int a = 0;
int x = 0;
a = x++;  //  x is now equal to 1, but a is equal to 0. 
```

如果你写`++x`， x 仍会增加​​，但会返回*新*值：

```
int a = 0;
int x = 0;
a = ++x;  //  Both a and x now equal 1. 
```

编译器的实现通常也存在细微差别。后增量 ( `x++`) 将执行以下操作：

*   创建临时变量
*   复制`x`到临时变量
*   增量`x`
*   返回临时变量

而 pre-increment ( `++x`) 会做这样的事情：

*   增量`x`
*   返回`x`

因此，使用前置增量需要的操作比后置增量要少，但在现代系统中，这通常不会成为优化代码的一种体面的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T21:25:20.683

`++`是一种方便的语法。它并没有真正为语言增加功能，但它增加了一种更简洁地编写一些常见操作的方式。

作为一个独立的语句`a++;`是相同的，`a+=1;`是相同的`a=a+1`；

`a++`在某些需要两个语句的情况下可能很有用：

`while (a < N) doSomethingWith(a++);`

只是一种较短的形式

```
while (a<N) 
{
   doSomethingWith(a); 
   a=a+1;
} 
```

我不认为你可以用 an 写任何你不能用 an`a++`写的东西`a=a+1`，但你不能只做 1 对 1 的替换。有时，第二种形式需要更多代码才能等效，因为第一种形式执行两件事：产生 的值`a`，然后递增`a`。`a=a+1`表格在增量之后产生值，`a`所以如果你需要原始值，你需要一个单独的语句来首先处理它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-30T21:26:00.720

您实际上可以使用加法：

```
a = a + 1 
```

但大多数人更喜欢较短的版本。在某些语言中，它实际上避免了将值复制到新位置的需要，但正如 nneonneo 有帮助地指出的那样，C 编译器可能会为您优化这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-30T21:29:21.560

“++”表示“加一”，例如

```
int x = 5;
x++;  // the same as x = x + 1
cout << x; // will print 6 
```

“+”是已知的加号运算符

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-01T07:48:17.027

使用增量运算符（即 value++）与使用加法运算符（即 value + 1）之间的区别在于，第一个运算符有时会导致突变，尤其是当我们在函数内部访问全局变量时；

使用增量运算符。

```
// The global variable
var fixedValue = 4;

function incrementer () {
  // Only change code below this line

  return fixedValue ++;
  // Only change code above this line
}
var newValue = incrementer(); // Should equal 5
console.log(fixedValue); // Should print 5 
```

使用加法运算符。

```
// The global variable
var fixedValue = 4;

function incrementer () {
  // Only change code below this line

  return fixedValue + 1;
  // Only change code above this line
}
var newValue = incrementer(); // Should equal 5
console.log(fixedValue); // Should print 4 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-01-30T21:25:49.173

在寄存器上进行增量，但通过 ALU 进行加法，我们可以使用 + 而不是增量，但增量更快

# oracle - 读取 CSV Oracle 存储过程 UTL_FILE 时忽略引号之间的逗号

> ID：14614065
> 
> 赞同：0
> 
> 时间：2013-01-30T21:23:32.360
> 
> 标签：oracle

示例数据：

```
1, test, "xy, yz", dog, cat
2, test2, xy, fish, bear 
```

正如您在上面看到的，第二列可能会或可能不会用逗号括在引号中作为字符串的一部分。

我只是想找到一种方法来忽略引号中的逗号（如果有的话）。我正在使用 UTL_FILE 并且不能使用外部表，我知道我知道，但我不是能够做出决定的人。

我还没有真正“尝试”过任何东西，因为在这种特殊情况下我找不到任何可以尝试的东西。我有在每个逗号之间提取子字符串的代码，但显然，会将“xy，yz”拆分为 2 个单独的字符串。通过使用 " 作为该特定列的分隔符，我已经能够让它在 ONE 行上工作，但是当下一行没有第二列的引号时，这会很糟糕。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T09:08:55.793

如果您可以将输入文件的所有字段都用双引号括起来（或者可以在阅读后翻译它；我的正则表达式不够好），您可以使用[`dbms_utility.comma_to_table`](http://docs.oracle.com/cd/E14072_01/appdev.112/e10577/d_util.htm#i1002468); 需要将字段括起来，因为（如此[处](https://stackoverflow.com/a/1524897/266304)所述）标记必须是有效的对象名称，因此`1`会导致错误。例如：

```
declare
    file utl_file.file_type;
    list varchar2(120);
    tablen binary_integer;
    tab dbms_utility.lname_array;
begin
    file := utl_file.fopen('MY_DIR', 'test1.csv', 'R');
    loop
        begin
            utl_file.get_line(file => file, buffer => list);
        exception
            when no_data_found then
                exit;
        end;
        dbms_output.put_line('Raw list: ' || list);

        dbms_utility.comma_to_table(list => list,
            tablen => tablen, tab => tab);

        for i in 1..tablen
        loop
            dbms_output.put_line('Column ' || i || ': '
                || replace(tab(i), '"'));
        end loop;
    end loop;
    utl_file.fclose(file);
end;
/ 
```

给出：

```
Raw list: "1","test","xy, yz","dog","cat"
Column 1: 1
Column 2: test
Column 3: xy, yz
Column 4: dog
Column 5: cat
Raw list: "2","test2","xy","fish","bear"
Column 1: 2
Column 2: test2
Column 3: xy
Column 4: fish
Column 5: bear
Raw list: "3","test3","ab, cd","rabbit, rabbit","duck"
Column 1: 3
Column 2: test3
Column 3: ab, cd
Column 4: rabbit, rabbit
Column 5: duck 
```

如果它们没有被引用，那么您可以使用正则表达式（来自[此处](http://regexadvice.com/forums/permalink/76652/76652/ShowThread.aspx#76652)的模式）：

```
declare
    file utl_file.file_type;
    list varchar2(120);
    pattern varchar2(15) := '("[^"]*"|[^,]+)';
    c sys_refcursor;
    i number;
    f varchar2(20);
begin
    file := utl_file.fopen('MY_DIR', 'test2.csv', 'R');
    loop
        begin
            utl_file.get_line(file => file, buffer => list);
        exception
            when no_data_found then
                exit;
        end;

        dbms_output.put_line('Raw list: ' || list);

        open c for
             select level as col,
                 regexp_substr(list, pattern, 1, rownum) split  
             from dual
             connect by level <= length(regexp_replace(list, pattern))  + 1;

        loop
            fetch c into i, f;
            exit when c%notfound;
            dbms_output.put_line('Column ' || i || ': ' || replace(f, '"'));
        end loop;
        close c;

    end loop;
    utl_file.fclose(file);
end;
/ 
```

这使：

```
Raw list: 1,test,"xy, yz",dog,cat
Column 1: 1
Column 2: test
Column 3: xy, yz
Column 4: dog
Column 5: cat
Raw list: 2,test2,xy,fish,bear
Column 1: 2
Column 2: test2
Column 3: xy
Column 4: fish
Column 5: bear
Raw list: 3,test3,"ab, cd","rabbit, rabbit",duck
Column 1: 3
Column 2: test3
Column 3: ab, cd
Column 4: rabbit, rabbit
Column 5: duck 
```

我不确定您是否真的在问题中显示的字段之间有空格。如果是这样，第一种方法仍然有效，您可以添加一个`trim()`around `tab(i)`。第二种方法失败了，所以需要一些调整......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T05:02:01.953

Oracle SQL Developer 工具附带一个支持 CSV 的数据导入向导。查看[手册的第 5.34 节](http://docs.oracle.com/cd/E35137_01/appdev.32/e35117/dialogs.htm#BACHDEJH)。这可能比手动处理 csv 更容易。如果需要进行任何处理，您可以通过 excel/perl 进行。

# salesforce - Salesforce：尝试从计划的作业交付 CSV

> ID：14614077
> 
> 赞同：2
> 
> 时间：2013-01-30T21:24:30.920
> 
> 标签：salesforce

我读到有人能够做到这一点，但我很难让它发挥作用。

基本上，我正在为一个页面安排一个 HTTP 标注，该页面有一个控制器，该控制器构建一个 CSV 并将其通过电子邮件发送给收件人。

预定班：

```
global class ReportExporter implements System.Schedulable {
global void execute(SchedulableContext sc) {
    getmailReportOutput ex = new getmailReportOutput();
    ex.exportCSV();
    } 
```

}

getEmailReportOutput 类：

```
public class getmailReportOutput{

    public Static String strSessionID;

    public getmailReportOutput() {
        }

   public void exportCSV() {
        makeReportRequest();
       }

@future (callout=true)      
    public Static void makeReportRequest()  {               
        strHost ='c.cs4.visual.force.com';
        strSessionID = UserInfo.getSessionId();
        String requestUrl =  'https://' + strHost + '/apex/TestSendReport#';        
        HttpRequest req = new HttpRequest();
        req.setEndpoint(requestUrl);
        req.setMethod('GET');
        req.setHeader('Cookie','sid=' + strSessionID );
        String output = new Http().send(req).getBody();
        System.debug('HTTP RESPONSE RETURNED: ' + output);
        }
    } 
```

getEmailReportOutput 类对 VF 页面执行 HTTP 标注：我确保将 sessionID 与请求一起发送：并且“TestSendReport”只是对控制器的简单标注：

```
<apex:page controller="Exporter" action="{!runrpt}">
</apex:page> 
```

...并且控制器正在调用报告内容：

```
 public class Exporter {
    public static Boolean isTest;
    public static String strEmailAddr;

    public void runrpt() {
        executeRpt();
        }       
@future          
    public static void executeRpt() {
        System.debug('CALLING REPORT EXPORTER...');        
        String ReportName__c = '00OP0000000Jp3N';
        String strEmailAddr =  'myname@email.com';

        ApexPages.PageReference report = new ApexPages.PageReference( '/' + RptName__c + '?csv=1');

        Messaging.EmailFileAttachment attachment = new Messaging.EmailFileAttachment();
        attachment.setFileName('report.csv');
        attachment.setBody(report.getContent());
        attachment.setContentType('text/csv');
        Messaging.SingleEmailMessage message = new Messaging.SingleEmailMessage();
        message.setFileAttachments(new Messaging.EmailFileAttachment[] { attachment } );
        message.setSubject('Report');
        message.setPlainTextBody('The report is attached.');
        message.setToAddresses( new String[] { strEmailAddr } );
        Messaging.sendEmail( new Messaging.SingleEmailMessage[] { message } );        
    }

} 
```

...有任何想法吗？调试日志显示一切正常，但没有收到任何内容。我知道这是一堵代码墙，但它似乎是人们建议完成任务的方法——我只是看不出有什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T00:01:03.453

我在这里看不到任何明显缺失的东西：/

为了安全起见 - `getEmailReportOutput`&`getmailReportOutput`是同一类（帖子中的错字，而不是您的实际代码）？

这看起来像跳了很多跳，我是否正确地阅读了它的预定课程 -> REST 标注 -> 带有操作的 VF 页面 -> @future -> 发送电子邮件？天啊，这里可能会出错；）[我在某处读到 SF 会保留某种引用计数器](https://salesforce.stackexchange.com/a/7255/799)，并且调用同一实例可能会阻止您使用 page.getContent ...

你能看到报告正文`System.debug(report.getContent().toString());`吗？您可以尝试将此电子邮件保存为您自己用户的任务或在示例帐户下（例如`setSaveAsActivity()`）？

就像公然的插件一样 - 我使用不同的路径来解决类似的要求。查看[https://salesforce.stackexchange.com/questions/4303/scheduled-reports-as-attachment](https://salesforce.stackexchange.com/questions/4303/scheduled-reports-as-attachment)看看你是否可以让它工作？

# delphi - 捕获另一个应用程序屏幕 Delphi 的屏幕截图

> ID：14614084
> 
> 赞同：0
> 
> 时间：2013-01-30T21:24:58.577
> 
> 标签：delphi, winapi, delphi-7

我搜索了 StackOverlow 并用谷歌搜索了自己，但找不到解决此问题的方法。

我想做的是能够预览文件的内容。我目前可以为 BMP、JPEG 等执行此操作，但我希望能够为任何具有默认程序关联的文件执行此操作。最可能的示例是 PDF 文件，但理论上任何文件都可以在此应用程序中使用。

我的想法是：-

1.  打开文件（使用 ShellExecuteEx？）
2.  等待打开完成
3.  复制打开程序显示的第一个窗口的内容
4.  将窗口保存到 TBitMap
5.  关闭文件/程序/窗口
6.  在 TImage 中显示捕获的 BMP 作为我的预览。

我认为我可以执行第 1 步和第 6 步，但中间的部分让我被打败了:-(

我正在使用 Delphi-7

干杯

杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T03:26:04.617

您可以尝试 Windows 预览处理程序，您可以在您的应用程序中托管现有的预览处理程序，也可以创建自己的。

检查这些资源。

# 托管预览处理程序

*   [在 Windows 应用程序中托管预览处理程序](http://www.brad-smith.info/blog/archives/79)

# 使用 Delphi 创建预览处理程序

*   [是否有适用于 Windows 7 的预览处理程序 VCL？](https://stackoverflow.com/questions/5195988/is-there-a-preview-handler-vcl-for-windows-7)
*   [Windows 7 预览版——德尔福之道](http://www.uweraabe.de/Blog/2011/06/01/windows-7-previews-the-delphi-way/)
*   [delphi-preview-handler](http://code.google.com/p/delphi-preview-handler/) (Delphi 开源项目)

# powershell - 如何修改我的 powershell 脚本以搜索机器上的所有 jpg/jpeg

> ID：14614086
> 
> 赞同：1
> 
> 时间：2013-01-30T21:25:16.350
> 
> 标签：powershell, powershell-2.0

我正在构建一个 PowerShell 脚本，它将在机器上找到所有 jpeg/jpg 文件。这是我目前所拥有的——

```
# PowerShell script to list the DLL files under the C drive
$Dir = get-childitem C:\ -recurse
# $Dir |get-member
$List = $Dir | where {$_.extension -eq ".jpg"}
$List |ft fullname |out-file C:\Users\User1\Desktop\dll.txt
# List | format-table name 
```

唯一的问题是我正在寻找的一些文件没有扩展名 jpg/jpeg。我知道您可以查看文件的标题，如果它显示 ÿØÿà 那么它是 jpeg/jpg 但我不知道如何将其合并到脚本中。

任何帮助，将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:05:49.343

我不确定如何使用 powershell 本机命令来查看文件头，我会对其进行一些研究，因为它听起来很有趣。在此之前，我可以建议您的初始命令的更短版本，将其减少为单行。

```
Get-ChildItem -Recurse -include *.jpg | Format-table -Property Fullname | Out-file C:\Users\User1\Desktop\Jpg.txt 
```

或者

```
ls -r -inc *.jpg | ft Fullname 
```

已编辑：删除冗余代码，谢谢@nick。

如果我找到任何东西，我会告诉你我找到了什么。

克里斯

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T23:15:05.130

以下将检索带有`.jpg`/`.jpeg`扩展名或在前四个字节中包含 JPEG 标头的文件：

```
[Byte[]] $jpegHeader = 255, 216, 255, 224;

function IsJpegFile([System.IO.FileSystemInfo] $file)
{
    # Exclude directories
    if ($file -isnot [System.IO.FileInfo])
    {
        return $false;
    }

    # Include files with either a .jpg or .jpeg extension, case insensitive
    if ($file.Extension -match '^\.jpe?g$')
    {
        return $true;
    }

    # Read up to the first $jpegHeader.Length bytes from $file
    [Byte[]] $fileHeader = @(
        Get-Content -Path $file.FullName -Encoding Byte -ReadCount 0 -TotalCount $jpegHeader.Length
    );

    if ($fileHeader.Length -ne $jpegHeader.Length)
    {
        # The length of the file is less than the JPEG header length
        return $false;
    }

    # Compare each byte in the file header to the JPEG header
    for ($i = 0; $i -lt $fileHeader.Length; $i++)
    {
        if ($fileHeader[$i] -ne $jpegHeader[$i])
        {
            return $false;
        }
    }

    return $true;
}

[System.IO.FileInfo[]] $jpegFiles = @(
    Get-ChildItem -Path 'C:\' -Recurse `
        | Where-Object { IsJpegFile $_; }
);

$jpegFiles | Format-Table 'FullName' | Out-File 'C:\Users\User1\Desktop\dll.txt'; 
```

请注意，[cmdlet](http://technet.microsoft.com/library/hh849787.aspx)[`-Encoding`](http://technet.microsoft.com/library/hh847788.aspx)的和`-TotalCount`参数仅用于读取每个文件的前四个字节，而不是整个文件。这是一项重要的优化，因为它基本上避免了读取驱动器上文件数据的每个字节。[`Get-Content`](http://technet.microsoft.com/library/hh849787.aspx)`C:`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-30T22:33:55.907

这应该为您提供以序列“ÿØÿà”开头的所有文件：

```
$ref = [byte[]]@(255, 216, 255, 224)

Get-ChildItem C:\ -Recurse | ? { -not $_.PSIsContainer } | % {
  $header = [System.IO.File]::ReadAllBytes($_.FullName)[0..3]
  if ( (compare $ref $header) -eq $null ) {
    $_.FullName
  }
} | Out-File "C:\Users\User1\Desktop\dll.txt" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-01T22:29:32.833

我建议查询 jpeg 的 Windows 搜索索引，而不是尝试嗅探文件内容。使用文件名搜索系统索引非常快，缺点是您必须搜索索引位置。

我使用 windows sdk \samples\windowssearch\oledb 编写了一个 windows 搜索查询脚本，您可能希望使用成像属性进行查询。但是，我不确定搜索索引是否使用映像 API 来查看未知文件或没有扩展名的文件。Explorer 似乎知道我的 jpeg 缩略图和没有 jpg 扩展名的元数据，所以我猜索引器会像 explorer 一样聪明。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-30T22:27:56.763

要查找标题是否以 ÿØÿà 开头，请使用：

```
[System.String]$imgInfo = get-content $_ # where $_ is a .jpg file such as "pic.jpg"
if($imgInfo.StartsWith("ÿØÿà"))
{
      #It's a jpeg, start processing...
} 
```

希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-08T03:29:28.377

这个怎么样？

`jp*g`用于匹配 jpg 和 jepg 图像。

```
$List = Get-ChildItem "C:\*.jp*g" -Recurse
$List |ft fullname |out-file C:\Users\User1\Desktop\dll.txt 
```

# vb.net - 我需要一种非常简单的方法让我的 VB.NET 程序“打电话回家”（即发送一条简单的消息）

> ID：14614090
> 
> 赞同：0
> 
> 时间：2013-01-30T21:25:45.933
> 
> 标签：vb.net

我曾经用它来发送电子邮件，但这似乎只工作了一半。

我只需要一种相对安全的方式将大约 20KB 的纯文本消息发送到我（开发人员）可以在 Internet 上访问的某个地方。

任何建议将不胜感激。谢谢。

# php - 从数组回显数据

> ID：14614092
> 
> 赞同：-1
> 
> 时间：2013-01-30T21:25:53.367
> 
> 标签：php, html, twitter

我目前正在使用 PHP 调用 Twitter 的“Trending”API，我想返回前 10 个热门话题。目前，它似乎被回显到一个数组中，但我无法弄清楚如何获取一个单独的数据。

我只想返回`name`每个属性。我怎样才能做到这一点？

我现有的代码是：

```
<?

$search=file_get_contents("https://api.twitter.com/1/trends/1.json");
print_r(json_decode($search));

?> 
```

解码数组：

```
Array
(
    [0] => stdClass Object
        (
            [trends] => Array
                (
                    [0] => stdClass Object
                        (
                            [name] => #EuroclubSoloEnEuropaFM
                            [url] => http://twitter.com/search?q=%23EuroclubSoloEnEuropaFM
                            [promoted_content] => 
                            [query] => %23EuroclubSoloEnEuropaFM
                            [events] => 
                        )

                    [1] => stdClass Object
                        (
                            [name] => #NBABands
                            [url] => http://twitter.com/search?q=%23NBABands
                            [promoted_content] => 
                            [query] => %23NBABands
                            [events] => 
                        )
                       //... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:29:44.763

我会假设`json_decode`返回一个关联数组。您可以通过执行以下操作获取名称的值：

```
<?

$search=file_get_contents("https://api.twitter.com/1/trends/1.json");
$trends = json_decode($search);
foreach ($trends[0]->trends as $trend){
    echo $trend->name . "<br/>";
}
?> 
```

# c# - Math.Floor 行为

> ID：14614109
> 
> 赞同：-3
> 
> 时间：2013-01-30T21:26:54.093
> 
> 标签：c#, .net

```
double c, d, e;
double a = (c - d) / e;
double b = Math.Floor(a);
Debug.WriteLine(a.ToString() + " " + b.ToString()); 
```

上面的代码在所有数字都是双倍的一种配置下输出“3 2”。这怎么可能？是因为双重操作导致的小数误差吗？但是我认为`a.ToString()`应该给出整数及其小数部分。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-30T21:32:15.850

这只是做什么的[`double.ToString()`](http://msdn.microsoft.com/en-us/library/3hfd35ad.aspx)问题。这是一个简短但完整的程序，演示了同样的事情：

```
using System;

public class Test
{
    static void Main(string[] args)
    {
        // Find the largest double less than 3
        long bits = BitConverter.DoubleToInt64Bits(3);
        double a = BitConverter.Int64BitsToDouble(bits - 1);
        double b = Math.Floor(a);
        // Print them using the default conversion to string...
        Console.WriteLine(a.ToString() + " " + b.ToString());
        // Now use round-trip formatting...
        Console.WriteLine(a.ToString("r") + " " + b.ToString("r"));
    }
} 
```

输出：

```
3 2
2.9999999999999996 2 
```

现在`double.ToString()`记录在案：

> 此版本的 ToString 方法隐式使用通用数字格式说明符 ("G") 和当前区域性的 NumberFormatInfo。

...和[通用数字格式说明符](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx#GFormatString)文档状态：

> 精度说明符定义可以出现在结果字符串中的有效数字的最大数量。如果精度说明符被省略或为零，则数字的类型确定默认精度，如下表所示。

...其中表格显示默认精度为`double`15。如果您考虑将 2.9999999999999996 四舍五入为 15 位有效数字，则最终为 3。

实际上，这里的*确切*值`a`是：

```
2.999999999999999555910790149937383830547332763671875 
```

...同样，当考虑 15 个有效数字时，它是 3。

# jquery - Jquery deferreds：使用带有承诺数组的过滤器

> ID：14614110
> 
> 赞同：0
> 
> 时间：2013-01-30T21:26:58.300
> 
> 标签：jquery, jquery-deferred

我是一个客户端新手，试图围绕 jQuery Deferred 对象，特别是链接。我有一个 Promise 对象在其过滤工作中替换另一个 Promise 对象的情况：

```
// works great. output: 
//  about to resolve top layer
//  top layer then results: {"id":"top_layer_deferred"}
//  about to resolve second layer item 0
//  top layer done: {"id":"second_layer_deferred"}
var top_layer_deferred = $.Deferred();

setTimeout(function() {
    console.log('about to resolve top layer');
    top_layer_deferred.resolve( { id: 'top_layer_deferred' } )
}, 10000 );

var top_layer_filter = top_layer_deferred.promise().then( function( results ) {

    console.log('top layer then results: ' + JSON.stringify(results) );
    var second_layer_deferred = $.Deferred();

    setTimeout(function() {
        console.log('about to resolve second layer item 0');
        second_layer_deferred.resolve( { id: 'second_layer_deferred' } )
    }, 2000 );

    return second_layer_deferred.promise();         
});

top_layer_filter.done( function(results) {
    console.log('top layer done: ' + JSON.stringify(results) );
}); 
```

现在我想做同样的事情，但在过滤器代码中返回一个 promise 对象数组。（为了简单起见，我只是将一个 promise 对象放在数组上，而不使用任何参数来解析。）但是过滤器代码过早地触发，就好像它没有看到它的参数一样：

```
// doesn't work. output:
//   about to resolve top layer
//   top layer then results: {"id":"top_layer_deferred"}
//   top layer done: 
//   about to resolve second layer item 0
var arr = [];
var top_layer_deferred = $.Deferred();

setTimeout(function() {
    console.log('about to resolve top layer');
    top_layer_deferred.resolve( { id: 'top_layer_deferred' } )
}, 10000 );

var top_layer_filter = top_layer_deferred.promise().then(function( results ) {

    console.log('top layer then results: ' + JSON.stringify(results) );
    var second_layer_deferred = $.Deferred();

    setTimeout(function() {
        console.log('about to resolve second layer item 0');
        second_layer_deferred.resolve()
    }, 2000 );

    arr.push( second_layer_deferred.promise() );
    return arr;             
});

top_layer_filter.done( function() {
    console.log('top layer done: ' );
}); 
```

我试过更换线路

```
top_layer_filter.done( function() { 
```

和

```
$.when.apply(null,top_layer_filter).done( function() { 
```

但这不会改变结果。

关于我所缺少的任何想法？

波莉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:06:33.753

好吧，我对“一系列承诺是一个数组，而不是一个承诺”的解释显然没有理解这一点。这是一个更完整的解释。

jQuery 1.8+ 文档`Deferred.then()`谈到了它的`doneFilter`,`failFilter`和`progressFilter`arguments ：

> 这些过滤器函数可以返回一个新值以传递给Promise`.done()`或`.fail()`回调，或者它们可以返回另一个可观察对象（Deferred、Promise 等），它将其已解决/拒绝状态和值传递给 Promise 的回调。

因此，在 jQuery 1.8+ 中，`.then()`（尤其是链接到它的任何内容）的行为由返回的内容决定。返回可观察对象（Deferred 或 Promise）与返回任何其他类型的对象根本不同。

您的两个代码示例在这方面有所不同：

*   首先，`.then(function(){...})`返回一个 Promise，因此沿链传递的可观察对象就是该 Promise。
*   在第二个中，`.then(function(){...})`返回一个数组，因此沿链传递的可观察对象是一个 Promise，其状态与`.then()`从其左侧馈送的状态相同（即“已解决”），但具有 Array 的已解决值。

如果你能掌握上面的第二点，那么你应该很好地了解为什么你会得到你观察到的行为。

要解决此问题，第二个代码示例需要遵循与第一个相同的整体模式。这条线`return second_layer_deferred.promise();`很关键。`arr`可以`$.when()`完全在内部定义、填充和提交`top_layer_deferred.then(function(){...})`。

```
var top_layer_deferred = $.Deferred();
setTimeout(function() {
    console.log('about to resolve top layer');
    top_layer_deferred.resolve('top_layer_deferred');
}, 5000);
var top_layer_filter = top_layer_deferred.promise().then(function(results) {
    console.log('top layer then results: ' + results);
    var second_layer_deferred = $.Deferred();
    var arr = [];
    for(var i=0; i<5; i++) {
        arr[i] = $.Deferred();
        setTimeout(function(ii) {//Note: double-wrap to form closure, ensuring correct i is reported.
            return function() {
                if(ii == 99) {//Edit here: try if(ii == 3)
                    console.log('about to reject second layer item ' + ii);
                    arr[ii].reject('second layer: ' + ii + ' rejected');
                }
                else {
                    console.log('about to resolve second layer item ' + ii);
                    arr[ii].resolve('second layer: ' + ii + ' resolved');
                }
            };
        }(i), 2000 + i * 2000);
        arr[i].done(function(r) {
            console.log('second layer : ' + r);
        }).fail(function(r) {
            console.log('second layer : ' + r);
        });
    }
    //At this point, arr is fully loaded with all the Deferreds it'll ever get,
    //so it's safe to apply $.when().
    $.when.apply(null, arr).done(function() {
        second_layer_deferred.resolve();
    }).fail(function(){
        second_layer_deferred.reject();
    });
    return second_layer_deferred.promise();
});
top_layer_filter.done(function() {
    console.log('top layer done');
}).fail(function() {
    console.log('top layer failed');
}); 
```

为了更好地衡量，我已经包含了一种机制来导致第二级 Deferreds 失败（在指示的地方编辑代码）。你会看到

*   当所有第二级 Deferred 都成功时，当所有这些 Deferred 都已解决时，将报告“top layer done”。
*   当任何第二级延迟失败时，立即报告“顶层失败”。

# c++ - Opengl - 高斯模糊位移/错位问题

> ID：14614116
> 
> 赞同：1
> 
> 时间：2013-01-30T21:27:23.917
> 
> 标签：c++, opengl, shader, blur, gaussian

我目前已经使用 C++ 在 Opengl 中实现了一个高斯模糊着色器。高斯模糊有效。然而，与原始图像相比，结果似乎有点偏移。生成的模糊图像似乎被放置在更高的位置，并在左侧放置了一些。并且与原版不在同一个地方。

我使用的高斯模糊是两遍计算。我基于我在网上找到的演示代码进行高斯计算。

高斯核计算如下所示：

```
 for(i = 0; i <= center; ++i)
    {
        result            = exp(-(i*i)/(double)(2*_sigma*_sigma));
        _kernel[center+i]  = _kernel[center-i] = (float)result;
        sum              += (float)result;
        if(i != 0) sum   += (float)result;

    }

    // normalize kernel
    for(i = 0; i <= center; ++i)
    {
        _kernel[center+i] = _kernel[center-i] /= sum;
    } 
```

偏移量计算如下所示：

```
_offsets        = new float [_kernelSize * 2 + 1];
_offsetSize     = _kernelSize * 2 + 1;

float xInc      = 0;

if(_shaderType == S2DGaussianComponentBlurShaderHorizontal)
{
    xInc        = 1.0f / (float)_width;
}
else
{
    xInc        = 1.0f / (float)_height;
}

int   index     = 0;
for (int i = -_kernelSize; i < _kernelSize + 1; ++i)
{
    index            = i + _kernelSize;
    _offsets [index] = i * xInc;
} 
```

片段着色器如下所示：

```
#version 120   \n                               \
uniform sampler2D texture;                      \
varying vec4 texcoord;                          \
                                                \
                                                \
uniform int kernelSize;                         \
uniform float weight[50];                       \
uniform float offsets[50];                      \
void main(void)                                 \
{                                               \
vec2 uv  = texcoord.xy;                         \
vec4 sum = vec4(0.0);                           \
for (int i = 0; i< kernelSize; i++)             \
{                                               \
vec4 tmp       = texture2D( texture,  uv + vec2(0.0, offsets[i]) ); \
sum           += tmp * weight[i];               \
}                                               \
                                                \
gl_FragColor = sum;                             \
}" 
```

纹理输入使用这些：

```
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP); 
```

`glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP);`

有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T20:08:50.227

我想到了。

似乎“_offsets”必须与内核大小相同。主要原因是偏移的中心位置必须与内核的中心位置相同。如果你不这样做，那么高斯将无法与纹理正确对齐。

这样做的一种方法是使“_offsets”的大小与内核相同。

几天来我一直在寻找这个解决方案-_-'

# android - 应用内购买问题

> ID：14614123
> 
> 赞同：0
> 
> 时间：2013-01-30T21:27:38.350
> 
> 标签：android, android-service, android-handler, android-billing

在我的最新应用上工作，我正在实施应用内购买。

我在网上寻找了很好的教程，并从 Bundell 找到了一个。

我检查了很多次代码，但我不断收到错误消息。看起来像这样：

```
01-30 21:14:17.415: E/AndroidRuntime(680): FATAL EXCEPTION: main
01-30 21:14:17.415: E/AndroidRuntime(680): java.lang.RuntimeException: Unable to destroy activity {com.crosscommunications.adalert/com.crosscommunications.adalert.inapppurchaseStarter}: java.lang.NullPointerException
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.app.ActivityThread.performDestroyActivity(ActivityThread.java:2672)
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.app.ActivityThread.handleDestroyActivity(ActivityThread.java:2690)
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.app.ActivityThread.access$2100(ActivityThread.java:117)
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:964)
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.os.Handler.dispatchMessage(Handler.java:99)
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.os.Looper.loop(Looper.java:130)
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.app.ActivityThread.main(ActivityThread.java:3683)
01-30 21:14:17.415: E/AndroidRuntime(680):  at java.lang.reflect.Method.invokeNative(Native Method)
01-30 21:14:17.415: E/AndroidRuntime(680):  at java.lang.reflect.Method.invoke(Method.java:507)
01-30 21:14:17.415: E/AndroidRuntime(680):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
01-30 21:14:17.415: E/AndroidRuntime(680):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
01-30 21:14:17.415: E/AndroidRuntime(680):  at dalvik.system.NativeStart.main(Native Method)
01-30 21:14:17.415: E/AndroidRuntime(680): Caused by: java.lang.NullPointerException
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.content.ComponentName.<init>(ComponentName.java:75)
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.content.Intent.<init>(Intent.java:2702)
01-30 21:14:17.415: E/AndroidRuntime(680):  at com.crosscommunications.adalert.BillingHelper.stopService(BillingHelper.java:261)
01-30 21:14:17.415: E/AndroidRuntime(680):  at com.crosscommunications.adalert.inapppurchaseStarter.onDestroy(inapppurchaseStarter.java:129)
01-30 21:14:17.415: E/AndroidRuntime(680):  at android.app.ActivityThread.performDestroyActivity(ActivityThread.java:2659)
01-30 21:14:17.415: E/AndroidRuntime(680):  ... 11 more 
```

这是一个 nullpointerException 但我不知道发生了什么。我使用此代码进行应用内购买：

```
package com.crosscommunications.adalert;

    import java.util.Calendar;
    import java.util.Date;
    import java.util.HashMap;

    import android.app.Activity;
    import android.content.Context;
    import android.content.Intent;
    import android.content.ServiceConnection;
    import android.os.Bundle;
    import android.os.Handler;
    import android.util.Log;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;
    import android.widget.ImageView;
    import android.widget.Toast;

    public class inapppurchaseStarter extends Activity {

        private static final String TAG = "BillingService";

        private Context mContext;
        private ImageView purchaseableItem;
        private Button purchaseButton;
        SessionManager session;

        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            Log.i("BillingService", "Starting");
            setContentView(R.layout.purchasestarter);

            mContext = this;
            Button annuleren = (Button) findViewById(R.id.purchaseAnnuleren);
            Button starter = (Button) findViewById(R.id.koopStarter);
            purchaseableItem = (ImageView) findViewById(R.id.gekocht);

            startService(new Intent(mContext, BillingService.class));
            BillingHelper.setCompletedHandler(mTransactionHandler);

            annuleren.setOnClickListener(new OnClickListener(){

                    @Override
                    public void onClick(View arg0) {
                        finish();

                    }

            });

            starter.setOnClickListener(new OnClickListener(){

                @Override
                public void onClick(View v) {
                    if(BillingHelper.isBillingSupported()){
                        BillingHelper.requestPurchase(mContext, "android.test.purchased"); 
                        // android.test.purchased or android.test.canceled or android.test.refunded or com.blundell.item.passport
                    } else {
                        Log.i(TAG,"Can't purchase on this device");
                        purchaseButton.setEnabled(false); // XXX press button before service started will disable when it shouldnt
                    }
                        Log.i(TAG,"default. ID: "+v.getId());

                }

            });

        }

        public Handler mTransactionHandler = new Handler(){
                public void handleMessage(android.os.Message msg) {
                    Log.i(TAG, "Transaction complete");
                    Log.i(TAG, "Transaction status: "+BillingHelper.latestPurchase.purchaseState);
                    Log.i(TAG, "Item purchased is: "+BillingHelper.latestPurchase.productId);

                    if(BillingHelper.latestPurchase.isPurchased()){
                        showItem();
                        if(BillingHelper.latestPurchase.productId.equals("android.test.purchased")){

                            System.out.println("Starter is vanaf nu aangekocht");

                        }
                    }
                };

        };

        public static Date addMonth(Date date, int i) {
            Calendar cal = Calendar.getInstance();
            cal.setTime(date);
            cal.add(Calendar.MONTH, i);
            return cal.getTime();
        }

        private void showItem() {
            purchaseableItem.setVisibility(View.VISIBLE);
            Toast toast = Toast.makeText(this,
                    "Product gekocht",
                    Toast.LENGTH_LONG);
            toast.show();
        }

        @Override
        protected void onPause() {
            Log.i(TAG, "onPause())");
            super.onPause();
        }

        @Override
        public void onDestroy() {
        super.onDestroy();
        BillingHelper.stopService();
        }

    } 
```

你看我有一个按钮，当点击它会完成活动。每次我完成活动时都会收到此错误....

当 onDestroy 被调用时，事情就变糟了。我认为这与 stopService() 方法有关。

该方法如下所示：

```
public static void stopService(){
    mContext.stopService(new Intent(mContext, BillingService.class));
    mService = null;
    mContext = null;
    mCompletedHandler = null;
    Log.i(TAG, "Stopping Service");
} 
```

拜托你们..你能给我提示/指针或只是一个解释吗？

编辑

好的...完成了...我已删除 onDestroy 并将 stopService 复制到完成方法之前...获取另一个 nullpointerexception ..有点相同：

```
01-30 21:51:07.135: E/AndroidRuntime(741): FATAL EXCEPTION: main
01-30 21:51:07.135: E/AndroidRuntime(741): java.lang.NullPointerException
01-30 21:51:07.135: E/AndroidRuntime(741):  at android.content.ComponentName.<init>(ComponentName.java:75)
01-30 21:51:07.135: E/AndroidRuntime(741):  at android.content.Intent.<init>(Intent.java:2702)
01-30 21:51:07.135: E/AndroidRuntime(741):  at com.crosscommunications.adalert.BillingHelper.stopService(BillingHelper.java:261)
01-30 21:51:07.135: E/AndroidRuntime(741):  at com.crosscommunications.adalert.inapppurchaseStarter$2.onClick(inapppurchaseStarter.java:48)
01-30 21:51:07.135: E/AndroidRuntime(741):  at android.view.View.performClick(View.java:2485)
01-30 21:51:07.135: E/AndroidRuntime(741):  at android.view.View$PerformClick.run(View.java:9080)
01-30 21:51:07.135: E/AndroidRuntime(741):  at android.os.Handler.handleCallback(Handler.java:587)
01-30 21:51:07.135: E/AndroidRuntime(741):  at android.os.Handler.dispatchMessage(Handler.java:92)
01-30 21:51:07.135: E/AndroidRuntime(741):  at android.os.Looper.loop(Looper.java:130)
01-30 21:51:07.135: E/AndroidRuntime(741):  at android.app.ActivityThread.main(ActivityThread.java:3683)
01-30 21:51:07.135: E/AndroidRuntime(741):  at java.lang.reflect.Method.invokeNative(Native Method)
01-30 21:51:07.135: E/AndroidRuntime(741):  at java.lang.reflect.Method.invoke(Method.java:507)
01-30 21:51:07.135: E/AndroidRuntime(741):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
01-30 21:51:07.135: E/AndroidRuntime(741):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
01-30 21:51:07.135: E/AndroidRuntime(741):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:46:25.513

`mContext`是您活动的一部分。由于您已经在 Activity 上调用了 finish()，因此可能会`mContext`被垃圾收集。您可能想在打电话`stopService`之前先打电话`finish`。

# c - 如何使用 PID 控制器？

> ID：14614124
> 
> 赞同：10
> 
> 时间：2013-01-30T21:27:41.160
> 
> 标签：c, pid-controller

我目前正在研究温度控制器。

我有一个 Temperature_PID() 函数，它返回操纵变量（这是 P、I 和 D 项的总和），但我该如何处理这个输出？

温度由 PWM 控制，因此 0% 占空比 = 加热器关闭，100% 占空比 = 加热器开启。

到目前为止我试过

```
Duty_Cycle += Temperature_PID();
if(Duty_Cycle > 100) Duty_Cycle = 100;
else if(Duty_Cycle < 0) Duty_Cycle = 0; 
```

这对我不起作用，因为 I 术语基本上使这个系统非常不稳定。想象一下整合一个区域，添加另一个小数据点，然后再次整合该区域，然后将它们相加。一遍又一遍。这意味着每个数据点都会使这种控制方案成倍恶化。

我想尝试的另一件事是

```
Duty_Cycle = Expected_Duty_Cycle + Temperature_PID(); 
```

其中 Expected_Duty_Cycle 是控制器达到稳定点且 Temperature_PID() 为 0 时应设置的温度。但是，这也不起作用，因为 Expected_Duty_Cycle 将始终根据加热器的条件而变化，例如不同的天气.

所以我的问题是我到底该怎么处理 PID 的输出？我不明白如何根据 PID 输出分配占空比。理想情况下，这将保持 100% 的占空比，直到温度几乎达到设定点并开始下降到较低的占空比。但是使用我的第一种方法（我的增益设置为零）它只是在它已经过冲后才开始降低占空比。

这是我的第一篇文章。希望我能找到我的答案。谢谢你的堆栈溢出。

编辑：这是我的 PID 函数。

```
double TempCtrl_PID(PID_Data *pid)
{
    Thermo_Data tc;
    double error, pTerm, iTerm, dTerm;

    Thermo_Read(CHIP_TC1, &tc);

    pid->last_pv = pid->pv;
    pid->pv = Thermo_Temperature(&tc);
    error = pid->sp - pid->pv;
    if(error/pid->sp < 0.1)
        pid->err_sum += error;

    pTerm = pid->kp * error;
    iTerm = pid->ki * pid->err_sum;
    dTerm = pid->kd * (pid->last_pv - pid->pv);

    return pTerm + iTerm + dTerm;
} 
```

编辑 2：以前从未使用过，所以如果链接损坏，请告诉我。 [https://picasaweb.google.com/113881440334423462633/January302013](https://picasaweb.google.com/113881440334423462633/January302013)

抱歉，当我尝试重命名轴或标题时，Excel 崩溃了。注意：系统中还没有风扇，所以我不能尽可能快地冷却加热器，所以与上面相比，它在设定点以下花费的时间很少。第一张图是一个简单的开关控制器。第二张图是我的 PD 控制器。正如您所看到的，温度降低需要更长的时间，因为它不会在温度过冲之前减去，它会等到温度过冲后再从占空比中减去，而且这样做太慢了。我究竟如何告诉我的控制器在达到最高温度之前降低占空比？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-30T22:13:59.470

PID 的输出*是*占空比。您必须调整`kp`、`ki`和`kd`以将 PID 输出置于 范围内`Duty_Cycle`，例如 0 到 100。在 PID 函数本身中明确限制输出通常是个好主意。

您应该通过简单的步骤“调整”您的 PID。

1.  关闭积分和导数项（设置`ki`和`kd`为零）

2.  慢慢增加`kp`，直到设定点的 10% 阶跃变化使输出振荡

3.  减少`kp`30% 左右，这应该可以消除振荡

4.  设置`ki`为一小部分`kp`并进行调整，以获得所需的过冲与达到设定点的时间之间的折衷

5.  希望你不需要`kd`，但如果你需要，让它更小

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T22:20:10.853

您的 PID 控制器输出应该直接设置占空比的值。

基本上，您将根据实际温度与温度设定点的差异来控制加热器设置。

您将需要调整 PID 参数的值以获得所需的性能。

首先，将 I 和 D 设置为零并为 P 输入一个值，例如 2 开始。

改变设定点，看看你的反应是什么。增加 P 并进行另一个设定值更改，看看会发生什么。最终，您将看到温度持续波动并且永远不会达到任何稳定值。这个值被称为“终极增益”。还要注意振荡的频率。设置 P 等于最终增益的一半。

从 I 的值 1.2（最终增益）/（振荡频率）开始并更改设定点。从这些值调整 P 和 I 的值以到达您想去的地方，跟踪过程并查看增加或减少值是否会改善事情。

一旦你有了 P 和 I，你就可以在 D 上工作，但取决于过程动态，为 D 赋值可能会让你的生活变得更糟。

[Ziegler-Nichols 方法](http://en.wikipedia.org/wiki/Ziegler%E2%80%93Nichols_method)为您提供了一些关于 PID 值的指导方针，这些指导方针应该能让您大致了解。从那里您可以进行调整以获得更好的性能。

您将不得不权衡过冲选项和温度达到新设定点所需的时间。温度调节得越快，您的过冲就越多。没有过冲将大大增加该时间量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-30T22:19:44.613

几点建议：

*   你似乎整合了两次。一次在你的`TempCtrl_PID`函数内部，一次在外部。 `Duty_Cycle +=`. 所以现在你的 P 词真的是我。
*   仅从 P 项开始并不断增加它，直到系统变得不稳定。然后后退（例如，使用不稳定的值的 1/2 到 1/4）并开始添加 I 项。从 I 项的非常低的值开始，然后逐渐增加。这个过程是调整循环的一种方式。因为系统可能会有一个相当长的时间常数，这可能很耗时......
*   您可以按照您的建议添加一些前馈（给定设定点的预期占空比 - 通过设置占空比并让系统稳定来映射它。）。该术语是否不完美并不重要，因为循环将消除剩余的错误。您也可以简单地为占空比添加一些恒定偏差。请记住，常数不会真正产生任何影响，因为积分器会将其取出。它只会影响冷启动。
*   确保您对该循环有某种固定的时基。例如，每 10 毫秒进行一次调整。
*   我暂时不用担心 D 项。对于大多数应用程序来说，PI 控制器应该足够好了。

# hadoop - Hive gzip文件解压

> ID：14614126
> 
> 赞同：4
> 
> 时间：2013-01-30T21:27:49.633
> 
> 标签：hadoop, gzip, hive

我已经将一堆 .gz 文件加载到 HDFS 中，当我在它们之上创建一个原始表时，我在计算行数时看到了奇怪的行为。将 gz 表中的 count(*) 结果与未压缩表的结果进行比较，结果差异约为 85%。压缩文件 gz 的表记录较少。有人见过这个吗？

```
CREATE EXTERNAL TABLE IF NOT EXISTS test_gz(
  col1 string, col2 string, col3 string)
ROW FORMAT DELIMITED
   LINES TERMINATED BY '\n'
LOCATION '/data/raw/test_gz'
;

select count(*) from test_gz;    result 1,123,456
select count(*) from test;  result 7,720,109 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T21:02:06.397

我能够解决这个问题。不知何故，gzip 文件在 map/reduce 作业（hive 或自定义 java map/reduce）中没有完全解压缩。Mapreduce 作业只会读取大约 450 MB 的 gzip 文件并将数据写出到 HDFS，而不会完全读取 3.5GZ 文件。奇怪，完全没有错误！

由于文件是在另一台服务器上压缩的，所以我手动解压缩并在 hadoop 客户端服务器上重新压缩它们。之后，我将新压缩的3.5GZ文件上传到HDFS，然后hive就可以完全统计出读取整个文件的所有记录。

马尔钦

# c++ - libpcap包结果和bsd socket recv数据使用C++的区别

> ID：14614127
> 
> 赞同：0
> 
> 时间：2013-01-30T21:27:53.807
> 
> 标签：c++, recv, tcpdump

我的网络编程经验相对有限，希望有人可以帮助我解决一个可能是 n00bish 的问题，在此先感谢您的帮助！:)

我有两个分别运行的 C++ 程序。一种是使用 libpcap 库编写的简单数据包嗅探器，它进行过滤，使其仅侦听在特定端口上接收到的数据包，然后解析数据包，以便将有效负载长度和有效负载内容写入二进制文件。

另一个程序是一个简单的 bsd 套接字服务器程序，它被设置为使用 recv() 函数在特定端口上接收消息，然后类似地将接收到的消息长度和消息内容写入二进制文件。

一切似乎都运行良好，所以当我检查二进制输出文件时，我希望内容是相同的......但不幸的是，我发现它们只是有点相似。似乎数据包嗅探器正在捕获与服务器正在捕获的相同数据，但它也在记录具有 6 字节长有效负载的额外数据包，这些数据显然没有被服务器程序接收。

因此，数据包嗅探器正在拾取服务器不应该知道的数据包，或者服务器程序丢失了它应该接收的数据包。但是，我对服务器程序运行正常并接收到正确的消息感到有些信心，因此数据包嗅探器检测到的这些额外数据包让我感到困惑。有谁知道这些额外的数据包可能是什么，以及我如何将它们过滤掉？

笔记：

向我正在侦听的端口发送数据的客户端是小型网络中的一台旧 Windows NT 机器，它基本上是将二进制数据传递给服务器程序进行处理。

不幸的是，由于工作场所政策，我无法上传代码。但是，可以在这里找到我的代码的示例： [http :](http://www.tcpdump.org/pcap.html) [//www.tcpdump.org/pcap.html http://beej.us/guide/bgnet/output/html/singlepage/bgnet.html](http://beej.us/guide/bgnet/output/html/singlepage/bgnet.html)

再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T18:19:50.950

> 一种是使用 libpcap 库编写的简单数据包嗅探器，它进行过滤，使其仅侦听在特定端口上接收到的数据包，然后解析数据包，以便将有效负载长度和有效负载内容写入二进制文件。

TCP端口还是UDP端口？

如果它是 TCP 端口，您的程序可能会收到 3 次握手数据包和 ACK-only 数据包。

你是如何计算有效载荷长度的？您应该通过获取 IP 数据包的总长度，从中减去 IP 标头长度（不是 20 个字节，而是版本/标头长度字段的长度，以便您处理 IP 选项；如果该长度小于 5，即< 20 字节，丢弃数据包，这是伪造的），得到 TCP 数据包总长度*，*然后从中减去TCP 标头长度（不是 20 字节，而是“数据偏移”字段，因此您可以处理 TCP 选项；如果该长度< 5，即< 20 字节，只需丢弃数据包，这是伪造的）以获取 TCP 有效负载长度。

这应该处理 mfontanini 所指的选项以及*IP*选项。

如果它是 UDP 端口，您仍应处理 IP 选项并获取总 UDP 数据包长度，然后：

*   如果这小于 UDP 标头中的长度，则丢弃数据包，这是伪造的；
*   如果 UDP 标头中的长度 < 8，则丢弃该数据包，它是伪造的；
*   否则，使用 UDP 标头中的长度减去 8 作为有效负载长度。

> 另一个程序是一个简单的 bsd 套接字服务器程序，它被设置为使用 recv() 函数在特定端口上接收消息，然后类似地将接收到的消息长度和消息内容写入二进制文件。

那将看不到初始握手或仅 ACK 数据包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:42:41.443

我的魔术球表明那些 6 字节长的有效载荷可能只是 TCP 选项。如果您只想使用有效负载，则应该跳过这些选项。请注意，某些数据包可能同时包含有效负载和某些选项。

TCP 数据包中的数据偏移字段指示有效负载从哪个点开始。您可以在第 3.1 节中[查看。](http://www.ietf.org/rfc/rfc793.txt)

无论如何，我建议您使用一些在内部处理这些东西的更高级别的库。使用[libtins](http://libtins.github.io/)，您可以使用一些简短的片段来完成该任务，例如：

```
#include <tins/tins.h>

using namespace Tins;

bool callback(const PDU &pdu) {
    const RawPDU &raw = pdu.rfind_pdu<RawPDU>();
    // raw.payload() returns a std::vector<uint8_t>
    process_payload(raw.payload());
    return true;
}

int main() {
    Sniffer some_sniffer(
        "eth0", 
        Sniffer::NON_PROMISC,
        "some pcap filter"
    );
    some_sniffer.sniff_loop(callback);
} 
```

# django - ImportError：Django 城市

> ID：14614130
> 
> 赞同：1
> 
> 时间：2013-01-30T21:28:01.320
> 
> 标签：django, importerror

我想知道为什么我`ImportError`在使用[django-cities](https://github.com/coderholic/django-cities)时会得到一个。

```
from cities.models import PostalCode 
```

我已经同步`cities`了数据库，并且数据库中存在表。追溯：

```
Traceback (most recent call last):
  File "manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
   File "/lib/python2.7/django/core/management/__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "/lib/python2.7/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/lib/python2.7/django/core/management/__init__.py", line 261, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File "/lib/python2.7/django/core/management/__init__.py", line 69, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "/lib/python2.7/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/lib/python2.7/South-0.7.5-py2.7.egg/south/management/commands/__init__.py", line 10, in <module>
    import django.template.loaders.app_directories
  File "/lib/python2.7/django/template/loaders/app_directories.py", line 23, in <module>
    raise ImproperlyConfigured('ImportError %s: %s' % (app, e.args[0]))
django.core.exceptions.ImproperlyConfigured: ImportError haystack: cannot import name PostalCode 
```

ImportError 表明 python 正在寻找`PostalCode`in `haystack`，但我要求它从 . 导入`cities`。为什么会发生这种情况？谢谢你的想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T01:22:57.307

我解决了这个问题。尽管 github 和 pypi 版本都声称是 0.2，但事实证明它们是不同的。我是通过 pip 安装的，pypi 版本没有`PostalCode`模型类，这是我的`ImportError`. 谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T23:14:37.013

问题更有可能出在您的models.py 中。您可以进行循环导入（换句话说，A 从 B 导入和 B 从 A 导入的情况）。

# mediaelement.js - MediaElement.js - 如何设置显示的默认图像？

> ID：14614133
> 
> 赞同：0
> 
> 时间：2013-01-30T21:28:08.307
> 
> 标签：mediaelement.js

有没有办法将初始播放器设置为以下之一：

1.  到特定的图像文件，然后在选择/触发播放时切换到视频
2.  将初始图像设置为视频中的一帧

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T20:54:00.957

1.  在 video 标签内指定一个属性**poster="path/to/image"**。并为图像赋值。

# javascript - 创建数组并在一行中推入

> ID：14614134
> 
> 赞同：55
> 
> 时间：2013-01-30T21:28:15.793
> 
> 标签：javascript

以下只是一个理论上的 JavaScript 问题。我很好奇以下是否可以转换为单个语句：

```
if(!window.foo){
  window.foo = [];
}
window.foo.push('bar'); 
```

这段代码大家可能以前都写过，但是一行行能搞定吗？
起初我认为这样的事情会起作用：

```
(window.foo || window.foo = []).push('bar'); 
```

但由于分配无效，这不起作用。接下来我尝试在推送上链接一些东西，但这不起作用，因为推送不返回数组。

关于这是否可以用纯 JavaScript 完成的任何想法？
（顺便说一下，结果应该是这样`window.foo = ['bar']`）

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-01-30T21:30:22.877

你的任务倒退了*。它应该是：

```
(window.foo = window.foo || []).push('bar'); 
```

`||`JavaScript中的运算符*不返回布尔值*。如果左侧为真，则返回左侧，否则返回右侧。

```
a = a || []; 
```

相当于

```
a = a ? a : []; 
```

所以写上面的另一种方法是：

```
(window.foo = window.foo ? window.foo : []).push('bar'); 
```

* 详情见评论

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-30T21:36:34.160

如果您添加括号，您的代码就可以正常工作，以便它符合您的预期：

```
(window.foo || (window.foo = [])).push('bar'); 
```

没有括号，它认为它应该`window.foo || window.foo`首先评估，然后将数组分配给结果，这是不可能的。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-01-30T21:30:29.570

这个问题让我玩了不同的选择来娱乐。返回长度而不是原始数组引用太糟糕`push`了，但是对于更短的表达式，拥有可以立即迭代、映射等的东西会很有帮助。

```
window.foo = (window.foo||[]).concat(['bar']); // always returns array, allowing:
(window.foo = (window.foo||[]).concat(['bar'])).forEach( ... )

(window.foo = window.foo||[]).push('bar'); // always returns length

window.foo && window.foo.push('bar') || (window.foo = ['bar']); // playing around 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-11-08T14:44:08.573

## 2021 更新

@zzzzBov 的[有用答案](https://stackoverflow.com/a/14614169/290085)，

```
(window.foo = window.foo || []).push('bar'); 
```

可以使用新`||=`运算符进一步简化[*逻辑 OR 赋值*](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_OR_assignment)¹，

```
(window.foo ||= []).push('bar'); 
```

* * *

¹参见[tcs39/proposal-logical-assignment](https://github.com/tc39/proposal-logical-assignment)，目前处于[第](https://tc39.es/process-document/)4 阶段，[主要浏览器支持](https://caniuse.com/mdn-javascript_operators_logical_or_assignment)。

# c++ - 无法从文件中删除行，使用字符串流作为替代？

> ID：14614136
> 
> 赞同：1
> 
> 时间：2013-01-30T21:28:27.337
> 
> 标签：c++, file, text, vector, edit

我查看了 ostream、istream、iostream 和 fstream，但我仍然无法完全弄清楚如何像任何小丑使用文本编辑器所做的那样简单地从输入或输出文本文件中删除行。

例如，如果我有一个文件读取，

```
box 1\n
socks\n
box 2\n
pajamas\n
box 3\n
textbooks\n\eof 
```

等等，我想完全删除第二个框（第 3 和第 4 行），以便文本文件读取

```
box 1\n
socks\n
box 3\n
textbooks\n\eof 
```

我显然需要创建一个临时文件，并仅将我想要保留的内容放在该临时文件中，删除原始文件，然后用原始文件的名称重命名临时文件。这很好，很花哨，我知道这实际上是所有程序处理文档编辑的方式。但编写代码是一件令人头疼的事情。

我真正想做的就是操纵存在的东西，而不必在每次操纵文本时跳过所有这些圈子，因为我有大量的东西要整理和编辑。

所以这是我的假设，我想要一些建议。在打开文件时将文件的全部内容存储到字符串、向量、动态分配的 char 数组或字符串流中是否更容易，以便我可以轻松地删除其中的一部分并重新排列它？然后我可以将我编辑的文本转储到临时文本中，删除原始文本，并用原始文件的名称重命名临时文件。

这有任何有效性，还是有更简单的方法来做到这一点？我很想使用向量作为我的第一个猜测。

[编辑] 请记住，我正在处理的文件组织得不是很好，不适合使用结构来轻松操作数据块。它可能是一大段散文，也可能是一串毫无意义的数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:35:17.743

如果您有很多行和很多更改，我很想使用 a`std::list`而不是 a `std::vector`。

如果您经常删除或插入，则必须重新排列行。使用 a`std::vector`比使用 a 更昂贵`std::list`。

# objective-c - UI 选择器视图个性化

> ID：14614137
> 
> 赞同：0
> 
> 时间：2013-01-30T21:28:28.393
> 
> 标签：objective-c, xcode, ios5, customization, uipickerview

我正在尝试为 UIPicker 找到一种方法，使其具有 3、6、12、24、36、46、72 选项。这样用户就可以从该集中选择选项。但是 UIPicker 必须带有一个从 1 开始并通过上述设置进行的旋转轮默认值。

因此，选择此选项最终应将所选数量放入购物车。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:49:47.097

这是你需要做的。在具有您需要实现的选择器的文件的 .h`UIPickerViewDataSource`中`UIPickerViewDelegate`：

```
@interface ViewController : UIViewController <UIPickerViewDataSource, UIPickerViewDelegate> 
```

然后，您需要将 UIPicker 的 DataSource 和 Delegate 连接到文件的所有者。然后你需要实现这些方法，我让你开始使用它们。

```
- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component {
     return 1;
}

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView {
     return self.myArray.count;
}

// getting the selected row and therefore the selected value
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {
     self.selectedValue = [self.myArray objectAtIndex:row];
}

// The text displayed in each picker view
- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component {
     return [self.myArray objectAtIndex:row];
}

// Properties used in the above code.

// myArray is the array with the values you want in it, so you could make it a property do lazy loading
@property (strong, nonatomic) NSArray *myArray;

- (NSArray *)myArray {
     if (!_myArray) _myArray = [NSArray arrayWithObjects:@"1", @"3", @"6", ..., nil];
     return myArray;
}

// selectedValue is an NSString of the current number selected
@property (strong, nonatomic) NSString *selectedValue; 
```

我刚刚在 StackOverflow 中对此进行了编码，因此如果有任何语法错误，我深表歉意。

# php - 从缓存中删除图像

> ID：14614138
> 
> 赞同：-4
> 
> 时间：2013-01-30T21:28:36.087
> 
> 标签：php, image, apache, caching, nginx

我需要在上传图像并替换其他图像时将其从缓存中删除。图片在 nginx 服务器上（1h 过期），通过 apache & php 上传

Steve Fenton 我可以为此禁用缓存

如果我用一小时修改创建日期会更新吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:31:31.543

如果您通过 PHP 提供图像，则可以通过调整 URL 将其从用户的缓存中取出。例如，如果你有这个：

```
<img src="a.png" alt="Butterfly"> 
```

以下将确保`a.png`不使用缓存：

```
<img src="a.png?1" alt="Butterfly"> 
```

你可以使用任何东西——版本号、时间戳（尽管它永远不会被缓存）或任何你喜欢的东西。

# matlab - Matlab 中的图像转换

> ID：14614151
> 
> 赞同：0
> 
> 时间：2013-01-30T12:57:54.240
> 
> 标签：matlab, image-processing

`rgb2gray`我使用Matlab将 RGB 图像（双格式）转换为相同格式的灰度图像。现在我想将相同的图像从灰色转换为 RGB。我`gray2rgb`在 Matlab 中使用过，但它给出了一个错误。那么我们如何使用 Matlab 将灰度图像转换为 RGB 图像呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T16:12:49.117

简短的回答：你不能。至少不完美。

正如肖恩所说，这是因为您在转换为灰度时丢失了一些信息。换句话说，从灰度转换回 RGB 是一个*欠定逆问题*，因此没有*简单*的解决方案。

现在这并不意味着你不能尝试。如果您对图像有一些先验，除了您留下的信息之外，您还可以使用它来计算原始 RGB 图像的*估计值。*

例如，如果您知道（或假设）原始图像已经是灰度图像（在 RGB 容器中），那么您可以完全反转该过程。这就是`gray2rgb`肖恩提到的功能正在做的事情。

其中大部分是开放性问题，因此可能超出您的预期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T13:47:02.143

我很抱歉地说这是不可能的。通过将图像转换为灰度，您减少了信息量（每个像素的 3 维降至 1）并且无法恢复。

该`rgb2gray`函数是 Matlab 中包含的函数，并且工作正常。该`gray2rgb`函数不是标准的 Matlab 函数。[如果您在 Matlab central 上](http://www.mathworks.us/matlabcentral/fileexchange/28111-gray2rgb)引用此函数，则文档说明它没有做任何有用的事情，只是从 1d 矩阵创建一个 3d 矩阵；图像仍然是灰度的。

# php - 使用 PHP 将表格提取为文本

> ID：14614156
> 
> 赞同：0
> 
> 时间：2013-01-30T21:29:25.867
> 
> 标签：php, web-scraping, match

我正在寻找一种简单的方法来获取网页的第一个表格并将整个内容放入一个字符串中，仅此而已。

所以我需要知道如何使用 preg_match 或类似方法从 DOM 对象中获取表的第一个实例，并将整个内容放入字符串中：

我有一个类可以将网页下载为 DOM，但我无法根据需要将 html 转换为字符串。

```
$nodes = $this->bot->QuerySelector($this->download['DOM'], "//table[1][@class='tyebfghjftsdf-ccfkk']"); 
```

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T23:20:51.580

我会使用 Tidy 将页面转换为有效的 XHTML，然后使用 XML 阅读器（不构建 DOM）读取它，并在找到标签时开始回显数据并在标签上终止。不涉及正则表达式。

# c++ - 错误：没有名为“current_date”的成员

> ID：14614158
> 
> 赞同：0
> 
> 时间：2013-01-30T21:29:35.150
> 
> 标签：c++

所以我有这个仓库类：

仓库.h：

```
#ifndef WAREHOUSE_H
#define WAREHOUSE_H
#include<string>
#include<map>
#include "dates.h"

namespace a4
{
 class warehouse
 {
    public:
        warehouse(std::string name, std::string start_date);

    private:
        std::string name;
        std::string busiest_day;
        int most_transactions;
        std::map<std::string, a4::food> items;
        dates current_date;
        void next_day();
 };
}
 #endif 
```

仓库.cc：

```
#include "warehouse.h"
#include "dates.h"
namespace a4
{
 //constructor
 warehouse::warehouse(std::string name, std::string start_date)
 {
     this->current_date = new dates(start_date);
 }
 void warehouse::next_day()
 {
     this->current_date.next_day();
 }
} 
```

我得到的编译器错误是：

```
warehouse.cc: In constructor ‘a4::warehouse::warehouse(std::string, std::string)’:
warehouse.cc:8: error: ‘class a4::warehouse’ has no member named ‘current_date’
warehouse.cc: In member function ‘void a4::warehouse::next_day()’:
warehouse.cc:12: error: ‘class a4::warehouse’ has no member named ‘current_date’ 
```

知道为什么它不承认`current_date`为会员吗？这可能很简单，但我只有几周的时间来学习 C++。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:41:19.123

我能看到的唯一可能性是这*不是*你的标题的样子。确保您一直在正确目录中编辑正确的文件。

当你解决了这个问题，你会发现你的下一个错误是“无法转换`dates*`为`date`”。这是因为您在`new`不应该使用的地方使用。

# android - 如何查看手机开机多少次？

> ID：14614174
> 
> 赞同：0
> 
> 时间：2013-01-30T21:30:31.057
> 
> 标签：android

可以查看自上次开机后手机开机了多少时间？

例如，我昨晚关闭了电话，12 小时前我打开了电话，所以...我需要知道如何从电话中获取这 12 小时的开机值。

有可能的？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:37:28.723

```
elapsedRealTime() 
```

将为您提供自设备上次启动以来的时间

[http://developer.android.com/reference/android/os/SystemClock.html#elapsedRealtime()](http://developer.android.com/reference/android/os/SystemClock.html#elapsedRealtime())

# asp.net-mvc-3 - TextboxFor 在只读时发布值

> ID：14614177
> 
> 赞同：1
> 
> 时间：2013-01-30T21:30:41.950
> 
> 标签：asp.net-mvc-3

我正在我的视图中使用 html 帮助器方法创建一个 TextBox。

```
@Html.TextBoxFor(m => m.Address, new { @readonly = "readonly" })
```

我希望这个文本框在发布时保留其值，即使恶意用户试图更改它。

我正在 IE 中测试我的代码，并且可以轻松地使用开发人员工具来删除属性“只读”。

MVC3 中是否有任何实现在发布时保留文本框的值？我试图避免去数据库获取原始值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T21:35:03.913

> MVC3 中是否有任何实现在发布时保留文本框的值？

不，没有。这是不可能的。如果您已将价值发送给客户，您将不再信任它。正如您已经发现的那样，用户更改隐藏和只读字段的值是微不足道的。因此，如果这些值不打算由用户修改，它们甚至不应该是 HTML 的一部分。您应该将它们保存在服务器上。好吧，实际上您可以将它们显示为只读字段，只是为了向用户提供信息，但是当提交表单时，不要使用此值，而是使用存储在服务器上的真实值（可能在数据库或您正在使用的任何持久存储中） .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T02:57:04.593

为什么不尝试序列化您想要保留的所有内容，使用只有服务器知道的密钥对其进行加密，并将加密的值存储到隐藏的输入中。您仍然可以在表单控制器中显示未加密的值，但在服务器端，您将使用通过隐藏输入发送的加密值进行实际处理。这样，如果恶意用户更改了标准输入，那也没关系，因为您将使用加密的副本。我知道这有点绕口，它类似于 Web 表单跨帖子维护视图状态的方式。干杯

# c++ - 使用指针 C++ 进行强制转换

> ID：14614178
> 
> 赞同：0
> 
> 时间：2013-01-30T21:30:46.357
> 
> 标签：c++, pointers, casting

假设我有一个对象：

```
void *tmpValue; 
```

并说我知道 tmpValue 指向双精度值。将其转换为双精度的一种方法是执行以下操作：

```
double* dblPtr = (double*) tmpValue;
double dbl = *dblPtr; 
```

但是为什么从 void* 直接转换为 double 不起作用？

```
double dbl = (double) tmpValue; //error: "cannot convert from 'void*' to 'double' 
```

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T21:33:09.250

将指针（内存地址）解释为浮点值不是一个明智的操作，并且它可能在您的平台上失败，因为它们`void *`的`double`大小甚至不同。

您想要做的是将指针解释为`double *`并取消引用该`double *`指针，就像在您的第二个代码片段中一样。

您可以在一行中执行此操作：

```
double dbl = *(double *)tmpValue; 
```

但是，嘿，这是 C++。最好做

```
double dbl = *static_cast<double *>(tmpValue); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T21:34:18.143

您不能从指针类型转换为双精度。回想一下，指针类型本质上是一个内存地址（通常是 4 个字节，包含内存上数据的位置信息）。因此，您可以将指针类型转换为整数，但转换为 double 是没有意义的。

当您将 void* 指针转换为 double* 指针类型时，您实际上是在说“现在这是一个 double 的地址而不是 void* 的地址”

如果你想在一个班轮中获得双倍的价值，你可以这样做

```
double dbl = *( (double*) tmpValue ); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-30T21:35:28.057

```
double dbl = *(double*)tmpValue 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-01-30T21:33:17.583

取消引用指针和强制转换值

# events - GWT 按住鼠标按钮

> ID：14614179
> 
> 赞同：0
> 
> 时间：2013-01-30T21:30:50.240
> 
> 标签：events, gwt, mouse, mouseevent

我正在使用 GWT，并且想要在用户将鼠标左键按住 GWT 按钮时执行操作。但我找不到合适的事件处理程序或解决该问题的其他解决方案。

GWT 中是否有一种方法可以单击按钮，按住鼠标按钮并一次又一次地执行相同的操作，直到释放鼠标按钮？

```
Button scrollUpBtn = new Button("Top");
    scrollUpBtn.setWidth("66px");
    scrollUpBtn.addMouseDownHandler(new MouseDownHandler() {
        @Override
        public void onMouseDown(MouseDownEvent event) {
            //handCards.setVerticalScrollPosition(handCards.getVerticalScrollPosition() - 10);
            mouseUp = true;
        }
    });

    scrollUpBtn.addMouseUpHandler(new MouseUpHandler() {
        @Override
        public void onMouseUp(MouseUpEvent event) {
            mouseUp = false;
        }
    });

    scrollUpBtn.addKeyDownHandler(new KeyDownHandler() {
        @Override
        public void onKeyDown(KeyDownEvent event) {
            if (mouseUp == true) {
                handCards.setVerticalScrollPosition(handCards.getVerticalScrollPosition() - 10);
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T23:27:10.863

安德烈回答中的第 3 步假设 KeyDownEvent 将继续触发。我不确定是不是这样..

另一种方法是使用 Down & Up 处理程序来启动/停止执行您的操作的重复计时器。然后，您可以根据您希望执行操作的频率设置重复间隔。请记住，这是作为单线程 JavaScript 运行的，因此如果您执行冗长的处理，事情会变慢，并且计划的间隔将不会准时。

```
 Button btn= new Button("Button");
    final Timer actionTimer = new Timer() {
           @Override
           public void run() {
                // Your action here
                System.out.println("Doing something!");
           }
    };
    btn.addMouseDownHandler(new MouseDownHandler() {
        @Override
        public void onMouseDown(MouseDownEvent event) {
             // Choose the appropriate delay
             actionTimer.scheduleRepeating(1000); 
        }
    });

    btn.addMouseUpHandler(new MouseUpHandler() {
        @Override
        public void onMouseUp(MouseUpEvent event) {
            actionTimer.cancel();
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:50:15.760

1.  将[MouseDownHandler](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/event/dom/client/MouseDownHandler.html)添加到您的小部件。当它触发时，它应该设置一个标志为真，例如`mouseDown = true;`

2.  将[MouseUpHandler](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/event/dom/client/MouseUpHandler.html)添加到您的小部件。当它触发时，它应该设置一个标志为假，例如`mouseDown = false;`

3.  将[KeyDownHandler](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/event/dom/client/KeyDownHandler.html)添加到您的小部件。当 if 触发时，检查 flag 是否为真 - 然后做一些事情。如果标志为假，请不要这样做。

# java - 使用扫描仪打印令牌和分隔符值

> ID：14614180
> 
> 赞同：1
> 
> 时间：2013-01-30T21:30:57.583
> 
> 标签：java, regex, string

我有一个这样的字符串 -

```
"fruit=apple man=human abc=123" 
```

我希望将值打印为 -

```
fruit=
apple
man=
human
abc=
123 
```

即我还想查看分隔符值。目前我正在尝试-

```
String status2="fruit=apple man=human abc=123";
Scanner scn = new Scanner(status2).useDelimiter("[a-z]*=+");
while(scn.hasNext())
{
    System.out.println(scn.next());
    System.out.println(scn.delimiter());
} 
```

但我看不到分隔符值

```
apple 
[a-z]*=+
human 
[a-z]*=+
123
[a-z]*=+ 
```

**更新字符串 -**

```
"cobdate=01/28/2013 fundsnotextracted= elapsedtime=00:06:02 user=dataprod starttime=Wed, 30 Jan 2013 11:50:30 periods=DAILY, MTD, YTD knowledgedate=01/30/2013:11:50:10 progress=67 statusstep=Generating Reports ....." 
```

**预期产出 -**

```
cobdate=01/28/2013 
fundsnotextracted= 
elapsedtime=00:06:02 
user=dataprod 
starttime=Wed, 30 Jan 2013 11:50:30 
periods=DAILY, MTD, YTD 
knowledgedate=01/30/2013:11:50:10 
progress=67 
statusstep=Generating Reports ..... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:37:29.383

您的分隔符不正确。您应该在每个`=`符号之后设置分隔符，也应该在每个`whitespace`. 你可以使用这个 insead： -

```
Scanner scn = new Scanner(status2).useDelimiter("(?<==)|[ ]"); 
```

这里的分隔符是： - 后面的空字符串`=`由 表示`(?<==)`或由 表示的空格`[ ]`。

* * *

但是，给定您的输入字符串和所需的输出，我希望`split`字符串与`pattern`我在 中使用的相同`delimiter`，这将为您提供一个数组，您以后也可以在其他地方使用它：-

```
String status2="fruit=apple man=human abc=123";
String[] arr = status2.split("(?<==)|[ ]");
System.out.println(Arrays.toString(arr)); 
```

* * *

**更新： -**

对于您更新的输入，您将不得不做更多的工作。首先，你在`split`这里严格需要一个。另外，您必须进行两次拆分 - 一次在空格上，另一次在`=`.

现在，您的空格后面必须跟一系列以 结尾的字母`=`，这样您就不会错误地拆分值中包含的空格。因此，您的代码应如下所示： -

```
String str = "cobdate=01/28/2013 fundsnotextracted= elapsedtime=00:06:02 user=dataprod starttime=Wed, 30 Jan 2013 11:50:30 periods=DAILY, MTD, YTD knowledgedate=01/30/2013:11:50:10 progress=67 statusstep=Generating Reports .....";

// Split on a whitespace, followed by a sequence of letters ending with =.
// This ensures that you don't split on whitespace, optionally present in some values
String[] arr = str.split("[ ](?=[a-zA-Z]+=)");

for (String eachString : arr) {
    // Split on empty string following the = sign
    String[] tempArr = eachString.split("(?<==)");

    System.out.print(tempArr[0] + " ");

    // To ensure that you don't print a non-existence value.
    if (tempArr.length == 2) {
        System.out.println(tempArr[1]);
    } else {
        System.out.println();
    }
 } 
```

**输出： -**

```
cobdate= 01/28/2013
fundsnotextracted= 
elapsedtime= 00:06:02
user= dataprod
starttime= Wed, 30 Jan 2013 11:50:30
periods= DAILY, MTD, YTD
knowledgedate= 01/30/2013:11:50:10
progress= 67
statusstep= Generating Reports .... 
```

# html - css自定义下拉菜单上的宽度“匹配”

> ID：14614181
> 
> 赞同：0
> 
> 时间：2013-01-30T21:31:01.063
> 
> 标签：html, css

我正在尝试设置[此自定义下拉菜单的样式](http://tympanus.net/codrops/2012/10/04/custom-drop-down-list-styling/)

但是下拉的部分总是比下拉的“标题”部分略窄（每边1px）。

当我在这里改变宽度时，

```
.wrapper-dropdown-1 {
    position: relative;
    width: 200px;
    padding: 10px;
    margin: 0 auto;
} 
```

似乎什么都没有发生。我怎样才能调整它，使下降的部分与顶部的宽度相同？这是在哪里控制的？在[演示](http://tympanus.net/Tutorials/CustomDropDownListStyling/)中，宽度似乎完美对齐，我无法理解我是如何更改样式来影响它的。

[jsbin](http://jsbin.com/uvuwuw/4/edit)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:37:57.440

您是在其中一个元素中添加或删除边框吗？如果每边都有一个像素，这似乎是可能的原因。

您可以/应该匹配边框，或者，如果您可以失去一些跨浏览器兼容性，您可以使用[box-sizing](http://css-tricks.com/box-sizing/)：

`box-sizing: padding-box` （现在使用供应商前缀，例如`-webkit-box-sizing: padding-box`）。

另一种（hacky）方法是将下拉列表设置为，`margin-left`或者，等效地，从您的 JSBin 中，将/更改为：`margin-right``-1px``left``right``-1px`

```
.wrapper-dropdown-1 .dropdown {
     /* Size & position */
     position: absolute;
     top: 100%;
     left: -1px;
     right: -1px;

      /* ... */ 
```

}

# php - 如何为 PHP 函数提供一个可能没有设置在任何深度的多维数组，并检查它是否设置在函数内部。（教程）

> ID：14614182
> 
> 赞同：0
> 
> 时间：2013-01-30T21:31:16.287
> 
> 标签：php, multidimensional-array, user-defined-functions, isset

**问题的解释**

PHP 函数通常以下列方式调用：

```
myFunction($parameter); 
```

如果 $parameter 没有设置，PHP 会抛出一个错误。解决方案如下：

```
if (isset ($parameter))
{
    myFunction($parameter);
} 
```

但是，每次您想调用该函数并且不确定它是否已设置时，都必须使用 if() 检查，这真的很烦人。我想到的第一件事就是像这样声明函数：

```
function myFunction($local)
{
    if(isset($local))
    {
        //Code goes here.
    }
} 
```

但是调用该函数不起作用，因为 PHP 似乎不支持将未设置的变量作为参数提供给函数。为了解决这个问题，我使用了变量：

```
function myFunction($local)
{
    if(isset(${$local})
    {
        //Code goes here.
    }
}

myFunction('parameter'); 
```

要了解变量变量的工作原理，请参阅[PHP 手册](http://php.net/manual/en/language.variables.variable.php)。

这工作正常，直到我需要检查数组索引。为了解决这个问题，我创建了一个不同的函数来处理肯定要设置的数组：

```
myFunctionArray($array,$key)
{
    if(isset($array[$key]))
    {
        //Code goes here.
    }
}
$variable = array();
myFunctionArray($parameter,'key'); 
```

在这种情况下，由于设置了 $variable，并且 'key' 是一个无害的字符串，即使没有设置 $variable[$key] 也不会出错，并且您可以成功地在函数内部进行 isset 检查。但是，这显然不支持多维数组。为了支持多维数组，必须在函数中添加更多参数，以预期数组预期具有的维数。这两个功能中的任何一个都可以工作：

```
myFunctionMultiArray($array,$key1,$key2,$key3)
{
    if(isset($array[$key1][$key2][$key3]))
    {
        //Code goes here.
    }
}
myFunctionMultiArray2($array,$keys)
{
    if(isset($array[$keys[0]][$keys[1]][$keys[2]]))
    {
        //Code goes here.
    }
}
$variable = array();
myFunctionMultiArray($parameter,'key1','key2','key3');
myFunctionMultiArray2($parameter,array('key1','key2','key3'); 
```

另一个问题，现在我们手头有很多函数，每个数组深度都有一个。我们如何做到这一点，以便可以为函数提供任何深度的数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:31:16.287

最终解决方案的工作原理类似于第二个数组：

```
function deepIsset($variable,$keys)
{
    $status = TRUE;
    foreach ($keys as $key)
    {
        if($status)
        {
            if (isset($variable[$key]))
            {
                $variable = $variable[$key];
            }
            else
            {
                $status = FALSE;
            }
        }
    }
    return $status;
} 
```

首先，我们首先创建一个局部变量 $status 假设一切正常。

然后，我们开始遍历一个数组，该数组包含我们正在检查的数组的每个深度的所有键。

如果到目前为止我们还没有出现错误，让我们继续进行检查。变量[$key] 设置了吗？如果是这样，我们通过设置 $variable[$key] 进入那个深度。如果不是，那么我们将 $status 设置为 FALSE，从而有效地阻止我们继续进行检查。

当我们完成循环时，我们返回状态，它可以是 TRUE 或 FALSE。

换句话说，运行这个：

```
deepIsset($parameter,array('foo','bar','baz')); 
```

如果设置了 $parameter['foo']['bar']['baz'] 将返回 TRUE。

等等……所以基本上我们重新发明了 isset() 函数？是的！但有一个关键区别：它现在可以在函数内部使用。让我们回到我们原来的函数：

```
function myFunction($variable,$keys)
{
    if(deepIsset($variable,$keys))
    {
        //Code goes here.
    }
} 
```

我们开始了。现在我们可以将原始函数与多维变量一起使用，同时在函数内部进行 isset() 检查：

```
myFunction($parameter,array('foo','bar','baz')); 
```

这为函数提供了变量 $parameter，并检查 $parameter['foo']['bar']['baz'] 是否设置在内部。

# c - 从 C 中的内存中读取地址

> ID：14614187
> 
> 赞同：2
> 
> 时间：2013-01-30T21:31:29.110
> 
> 标签：c, linux

我试图将字符存储在变量中的地址处，但出现编译错误（一元'*'的无效类型参数（具有'int'））。

```
int address = 4000;
char character = (char) *address 
```

为什么此代码不取消引用将字符存储在内存位置 4000 的指针，我该如何解决？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T21:33:25.257

从语法上讲，您正在寻找

```
char character = *(char*)address; 
```

这是否会做任何有用的事情是另一回事......

需要思考的一些问题：

1.  `int`可能或可能不够宽以表示每个有效地址（在我的系统上，它不是）。
2.  您如何知道进程内存映射中地址 4000 处的内容？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T21:33:54.300

您不能只尝试寻址随机内存地址并期望它起作用。您的程序可能会访问未映射的内存地址，并且稍后会崩溃或导致自己出现许多问题，但要执行您想要的操作。

```
char *address = (char *)4000;
char c = *address; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T21:33:48.077

做这个：

```
#include <stdint.h>
/* ... */
uintptr_t ip = 4000;                 // this is an integer
char character = * (char *)(ip); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T21:35:46.390

```
#include <stdint.h>
intptr_t address = 4000;
char character = *((char*)address); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-30T21:38:11.237

```
char *address=(char*)4000;
char character = *address; 
```

你的责任是什么在“4000”

# c# - INotifyPropertyChanged 和静态属性

> ID：14614190
> 
> 赞同：22
> 
> 时间：2013-01-30T21:31:35.617
> 
> 标签：c#, .net, static, inotifypropertychanged

我正在为一个简单的问题纠结。我有一个实现`INotifyPropertyChanged`. 某些实例属性的 getter 使用静态属性，因此如果静态属性发生变化，它们的值可能会发生变化？这是一个简化的例子。

```
class ExampleClass : INotifyPropertyChanged
{

    private static int _MinimumLength = 5;
    public static int MinimumLength
    {
        get
        {
            return _MinimumLength;
        }
        set
        {
            if (_MinimumLength != value)
            {
                _MinimumLength = value;
                //WHAT GOES HERE
            }
        }
    }

    private int _length = -1;
    public int length
    {
        get
        {
            return (_length > _MinimumLength) ? _length : _MinimumLength;
        }
        set
        {
            var oldValue = (_length > _MinimumLength) ? _length : _MinimumLength;
            if (_length != value)
            {
                _length = value;
                var newValue = (_length > _MinimumLength) ? _length : _MinimumLength;
                if (newValue != oldValue)
                {
                    OnPropertyChanged("length");
                }
            }
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    [NotifyPropertyChangedInvocator]
    protected virtual void OnPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }

} 
```

显然，如果静态属性`MinimumLength`发生变化，那么每个实例的属性`length`也可能发生变化。但是静态属性应该如何指示实例可能发生的变化呢？它不能调用`OnPropertyChanged`，因为那不是静态的。

我可以在所有实例的类级别保留一个列表，并在每个实例上调用一个方法，但不知何故，这感觉有点矫枉过正。或者我可以将静态属性拉到一个单例类中，但从逻辑上讲，它们存在于类级别。是否有一个既定的模式，或者我应该以不同的方式思考这个问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-30T22:01:34.660

如果您倾向于保持该设计，那么我将采用如下解决方案：

```
public static int MinimumLength
{
    get { return _MinimumLength; }
    set
    {
        if (_MinimumLength != value)
        {
            _MinimumLength = value;
            OnGlobalPropertyChanged("MinimumLength");
        }
    }
}
static event PropertyChangedEventHandler GlobalPropertyChanged = delegate { };
static void OnGlobalPropertyChanged(string propertyName)
{
    GlobalPropertyChanged(
        typeof (ExampleClass), 
        new PropertyChangedEventArgs(propertyName));
}
public ExampleClass()
{
    // This should use a weak event handler instead of normal handler
    GlobalPropertyChanged += this.HandleGlobalPropertyChanged;
}
void HandleGlobalPropertyChanged(object sender, PropertyChangedEventArgs e)
{
    switch (e.PropertyName)
    {
        case "MinimumLength":
            if (length > MinimumLength)
                length = MinimumLength;
            break;
    }
} 
```

这几乎等同于维护一个实例列表，但我发现它更易于维护和更清晰。此外，您确实需要使用弱事件处理策略，否则，您的实例将不会被垃圾收集，因为它们将始终与充当 GC 根的静态事件相关联。

您可以在以下博客文章中阅读有关弱事件处理程序的更多信息（由我编写，因此我有偏见）：

[.NET 弱事件处理程序——第一部分](http://exceptionalcode.wordpress.com/2010/05/17/net-weak-event-handlers-part-i/)

[.NET 弱事件处理程序——第一部分](http://exceptionalcode.wordpress.com/2010/05/18/net-weak-event-handlers-part-ii/)

在不相关的注释中，您的代码当前正在触发属性更改，而实际上属性值没有更改。例如：

1.  将最小长度设置为 5；
2.  将长度设置为 10；（由于值从默认值 0 更改为 5，因此触发事件）
3.  将长度设置为 11；（事件触发但它不应该因为长度仍然是 5）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-30T21:55:12.167

[您可以使用绑定静态属性和实现 INotifyPropertyChanged](https://stackoverflow.com/questions/4680244/binding-static-property-and-implementing-inotifypropertychanged)中提到的技术，但也可以针对“长度”发出通知，例如

```
class ExampleClass : INotifyPropertyChanged
{
    private static int _MinimumLength = 5;

    public int MinimumLength
    {
        get
        {
            return _MinimumLength;
        }
        set
        {
            if (_MinimumLength != value)
            {
                _MinimumLength = value;

                OnPropertyChanged("MinimumLength");
                OnPropertyChanged("length");
            }
        }
    }
    ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-27T08:10:09.890

我面临同样的问题。这是我制定的解决方案。

```
public class ZoomDataVm : ModelBase
{
    public ZoomDataVm()
    {
        // initialise the zoom
    }

    private double _zoomLevel;
    public double ZoomLevel
    {
        get { return _zoomLevel; }
        set
        {
            if (_zoomLevel != value)
            {
                _zoomLevel = value;
                RaisePropertyChanged(() => ZoomLevel);
                //
                // persist zoom info
            }
        }
    }
}

public class ZoomVm : ModelBase
{
    public static ZoomDataVm _instance;

    static ZoomVm()
    {
        _instance = new ZoomDataVm();
    }

    public ZoomDataVm Instance
    {
        get { return _instance; }
    }
} 
```

然后我像这样在 XAML 中使用它

```
<StackPanel>
    <StackPanel.Resources>
        <screenControls:ZoomVm x:Key="ZoomVm" />
    </StackPanel.Resources>
    <TextBlock Text="{Binding ElementName=uiScaleSliderContainer, Path=Tag}" Foreground="White" Margin="0,0,20,0" />
    <Control Name="uiScaleSliderContainer"
        Margin="0,0,0,0"
        VerticalAlignment="Center"
        HorizontalAlignment="Left"
        Tag="{Binding Source={StaticResource ZoomVm}, Path=Instance.ZoomLevel}">
        <Control.Template>
            <ControlTemplate>
                <Slider Orientation="Horizontal"
                    Width="400"
                    x:Name="uiScaleSlider"
                    ToolTip="Zoom"
                    Value="{Binding ElementName=uiScaleSliderContainer, Path=Tag}"
                    Minimum="0.1"
                    Maximum="2"
                    TickFrequency="0.1"
                    IsSnapToTickEnabled="True">
                </Slider>
            </ControlTemplate>
        </Control.Template>
    </Control>
</StackPanel> 
```

# python - 如何定期运行python后台进程

> ID：14614196
> 
> 赞同：2
> 
> 时间：2013-01-30T21:32:10.950
> 
> 标签：python, unix, cron

我有一个相当轻量级的脚本，我想每隔 5 小时左右在后台定期运行一次。该脚本通过几个不同的网站运行，扫描它们以寻找新材料，然后从它们中获取 .mp3 文件或根据它们的内容喜欢 youtube 上的歌曲。我想通过这个程序实现一些我不确定如何实现的事情：

*   让程序每 5 小时运行一次——我不熟悉系统级的计时操作。
*   让程序在后台有效运行——我希望这些“更新”在用户不知情的情况下发生。
*   让程序在启动时激活——我知道我将如何将其设置为用户，但我不确定如何将这样的配置添加到 python 文件中，如果可能的话。请记住，这将是一个简单的 .py 脚本——我不会将它编译成可执行文件。

该程序的设计主要考虑了 OSX 和其他基于 Unix 的系统。关于实现其中一些目标的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T21:36:32.360

如果您的脚本不需要经常执行，而且听起来好像不需要，我建议您设置一个 cron 作业。

在典型的 Linux 机器上，您可以`crontab file`通过以下方式编辑：

```
$ crontab -e 
```

这将在您的标准编辑器中打开您的 crontab，并在您完成后为您安装 crontab 文件（即保存它）

一个典型的 crontab 命令如下所示：

```
# m h  dom mon dow   command
 15  0   *   *   *    /bin/bash /home/yourself/bin/dump_my_tables.sh 
```

此行将在`dump_my_tables.sh`每天 00:15 执行。您的脚本将需要类似以下内容：

```
0  */5  *  *  *   /usr/bin/python /home/yourself/bin/scrape_the_web.py 
```

注意：

*   时间是机器的本地时间 (!)
*   某些`cron`版本不接受`*/5`语法，您必须手动指定要安排脚本的时间，即`0,5,10,15,20`
*   您可能想要重定向输出，但它超出了这个答案的范围

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T21:41:10.403

> 让程序每 5 小时运行一次——我不熟悉系统级的计时操作。

对于 nix cron 是完成此任务的默认解决方案

> 让程序在后台有效运行——我希望这些“更新”在用户不知情的情况下发生。

使用 cron 程序将在您的服务器的后台运行。用户不应受到它的不利影响。如果用户加载查看您已抓取的 mp3 的页面。然后在你的脚本运行/保存数据到数据库的过程中，用户点击刷新，新的 mp3 可能会出现，我不知道这是否是你在“用户不知道”的情况下所想到的

> 让程序在启动时激活——我知道我将如何将其设置为用户，但我不确定如何将这样的配置添加到 python 文件中，如果可能的话。请记住，这将是一个简单的 .py 脚本——我不会将它编译成可执行文件。

我很确定 cron 条目将在重新启动时持续存在，（我不是 100%），确保`cron`守护程序在启动时启动

# ruby - Sinatra 中的 Rufus 调度程序

> ID：14614199
> 
> 赞同：3
> 
> 时间：2013-01-30T21:32:22.603
> 
> 标签：ruby, sinatra, scheduled-tasks, rufus-scheduler

我在 Sinatra 应用程序中使用 Rufus 调度程序。我可以从“scheduler do”块中访问辅助方法吗？我没能做到（我得到一个“未定义的方法 `check' for main:Object”错误）所以现在我必须在 helpers 块中定义方法（也可以在“post '/' do”块中使用它) 然后将方法的主体复制到调度程序块。这没有意义：（有没有办法避免重复？我可以在其他地方定义一个方法并在调度程序中调用它吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T16:04:59.157

这取决于您的调度程序在哪里使用。一个块可以访问它本地的上下文，所以如果你在可以访问帮助器的地方使用它，那么它也应该可以访问帮助器。

部分取自[文档](http://www.sinatrarb.com/intro#Scopes%20and%20Binding)

```
class MyApp < Sinatra::Base
  # Hey, I'm in the application scope!

  helpers do
    def my_helper
    end
  end

  configure do
    scheduler.every('20s') do
      # my_helper is ***not*** accessible here
    end
  end

  get '/define_route/:name' do
    # Request scope for '/define_route/:name'
    scheduler.every('20s') do
      my_helper
      # my_helper is accessible here
    end
  end
end 
```

话虽如此，您将无法访问`scheduler`类似的内容，因此：

```
configure do
  set :scheduler, { Rufus::Scheduler.start_new }
end 
```

然后你可以做

```
 get '/define_route/:name' do
    # Request scope for '/define_route/:name'
    settings.scheduler.every('20s') do
      my_helper
      # my_helper is accessible here
    end
  end 
```

或者你可以把它放在一个模块的类实例变量中：

```
module MyScheduler
  def self.scheduler
    @scheduler ||= Rufus::Scheduler.start_new
  end
end 
```

然后您可以通过以下方式访问任何地方的调度程序：

```
MyScheduler.scheduler 
```

但`my_helper`仍然只能在请求范围内访问。如果您想在请求范围之外以帮助程序的形式访问方法*，*则将其提取为 jmettraux 隐含到：

```
module MyHelpers
  def self.my_helper
    # do something
  end
end 
```

在西纳特拉：

```
helpers
  def my_helper
    MyHelpers.my_helper
  end
end 
```

然后可以这样做：

```
configure do
  scheduler = Rufus::Scheduler.start_new
  set :scheduler, scheduler
  scheduler.every('20s') do
    MyHelpers.my_helper
    # my_helper is not accessible here
    # but the MyHelpers.my_helper is, because it's accessible everywhere
  end
end

# and/or

get "another-route" do
  setting.scheduler.every('20s') do
    my_helper
    # my_helper is accessible here
  end
end 
```

一切都非常复杂！您可以混合搭配并找到适合您需求的产品。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T11:02:07.613

我在看[http://japhr.blogspot.jp/2009/03/sinatra-innards-deletgator.html](http://japhr.blogspot.jp/2009/03/sinatra-innards-deletgator.html)

您可能可以执行以下操作：

```
# in a.rb

module A
  class << self; include A; end
  def nada
    puts "nada"
  end
end

# in another file...

require 'sinatra'

helpers do
  include A
end

scheduler.every('20s') do
  A.nada
end 
```

# javascript - javascript读取XML文件返回未定义

> ID：14614211
> 
> 赞同：0
> 
> 时间：2013-01-30T21:33:17.403
> 
> 标签：javascript, html, xml

JavaScript：我在 FireFox 上使用以下代码读取 XML 文件内容： HTML：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>javascript ?? xml??</title>  
<script type="text/javascript" src="readXML.js"></script> 
</head>  
<body>  
</body>  
</html> 
```

的JavaScript：

```
readMyXML={
    init: function(){
        readMyXML.javaScriptReadXML();
    },

    javaScriptReadXML: function(){
        var xmlDoc =document.implementation.createDocument("", "", null);        
        //xmlDoc = new ActiveXObject("MSXML2.DOMDocument.3.0");
        xmlDoc.async= false;                                         
        xmlDoc.load('PAS1.xml');              /* load XML file */
        //xmlDoc.load('myxml.xml');
        var objNodeList = xmlDoc.getElementsByTagName("Slide");
        var Node=objNodeList.item(0);
        var mytext=Node.getElementsByTagName("Context");

         alert("length="+mytext.item(0).Language);
     }  
}

window.addEventListener('load', readMyXML.init,false); 
```

但无论我尝试获取 XML 的任何内容，它都会在警报中显示未定义。如何解决这个问题呢。

XML 是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<Survey SurveyID="PAS1" Description="PAS first part">
<Slide SlideID="S-N1">
<Question>
<Context Language="English">We would like you to fill out a questionnaire </Context>

</Question>
<Input Optional="true">
<Nothing ChoiceID="1" />
</Input>
<Next />
</Slide> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:49:13.177

这是因为您缺少 return 语句并引用声明的 objects 属性而不是使用's body`this`中的关键字`init`，所以将其重写如下：

```
var readMyXML = {
    init: function(){
          this.javaScriptReadXML();
    },

    javaScriptReadXML: function(){
         var xmlDoc =document.implementation.createDocument("", "", null);        

         // xmlDoc = new ActiveXObject("MSXML2.DOMDocument.3.0");
         xmlDoc.async= false;                                         
         xmlDoc.load('PAS1.xml');              /* load XML file */

         // xmlDoc.load('myxml.xml');
         var objNodeList = xmlDoc.getElementsByTagName("Slide");
         var Node=objNodeList.item(0);
         var mytext=Node.getElementsByTagName("Context");
         alert("length="+mytext.item(0).Language);
     }  
} 
```

# javascript - 带参数的 Javascript onClick 函数

> ID：14614217
> 
> 赞同：1
> 
> 时间：2013-01-30T21:33:25.877
> 
> 标签：javascript

我有一个Javascript函数如下：

```
function letMeGo(var1, var2, var3){
    if(var1 == 1 && var2 == 1 && var3 == 1){
        document.getElementById('goOn').href="goOn.php";
    }
} 
```

变量是其他函数的返回。

我需要它被触发：

```
<a id="goOn" onclick="letMeGo(var1, var2, var3)">Go On</a> 
```

除非我删除了链接和函数中的变量，否则它不起作用。我怎样才能让它与他们一起工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:35:40.140

您必须影响其他函数对全局变量的返回（例如：）`window.myvar1`并使用它们而不是您的参数`var1, var2, var3`。

我的意思是不要在你的函数`letMeGo`及其内部使用任何参数，将 var1 替换为其等效的全局变量，等等 var2 和 var3。

# ios - 找不到 Apple 开发推送服务的私钥

> ID：14614219
> 
> 赞同：67
> 
> 时间：2013-01-30T21:33:35.670
> 
> 标签：ios, certificate, apple-push-notifications, keychain

我已经咨询了许多来源，但仍然无法弄清楚。

[http://code.google.com/p/apns-php/wiki/CertificateCreation](http://code.google.com/p/apns-php/wiki/CertificateCreation)

基本上，在我从 iOS 配置门户 > 应用程序 IDS 下载开发推送 SSL 证书（选择启用 Apple 推送通知服务）并双击证书（文件名 aps_development.cer）将其打开后，钥匙串就会打开。然后我在左侧面板上选择“登录”和“证书”。在右侧面板上，我看到“Apple Development IOS Push Services:...”，到目前为止我咨询过的所有说明都告诉我通过单击名称旁边的箭头来“扩展”此选项以显示私钥，但是此证书没有扩展选项。谁能帮我找到这个私钥？我是否下载了错误的证书？

谢谢

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2015-03-06T03:35:48.283

我的问题是，由于**某种**原因，各种证书被添加到“系统”钥匙串而不是“登录”钥匙串中。

通过选择“登录”，然后用小“+”（在 i 旁边）添加它们，它们已被添加到正确的位置。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2013-05-02T16:01:26.953

我注意到在左侧菜单（钥匙串）中单击“我的证书”时，实际上可以看到展开图标。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2015-09-03T05:39:42.247

我所面临的，当我创建 CSR 文件时，我将 Common Name 与空格放在一起。并且此 CSR 文件创建的证书未`expand`在`Keychain Access`

在我用一个简短的通用名称创建了一个新的 CDR 文件并重新创建了证书后，它安装得很好并且有一个私钥。

[![在此处输入图像描述](../Images/0c7124f5e8cf23f60960b7a706ae1254.png)](https://i.stack.imgur.com/vq69d.png)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-01-30T21:40:40.407

在您尝试访问此证书的机器上，您是否拥有用于签署证书签名请求的密钥（基于哪个苹果为您创建了该证书）？

您应该询问创建该证书的人。那可能是您获得私钥的唯一方法。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2015-03-04T07:05:31.070

转到钥匙串访问权限并按照以下步骤操作...

![在此处输入图像描述](../Images/8926a88ead391908c6f7f7b5f609b6b3.png)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2015-02-27T02:36:20.433

我有同样的问题。双击 .cer 文件将证书放入钥匙串中，但没有显示任何私钥（条目也不能展开）。

我通过以下步骤解决了这个问题：

1.  退出钥匙串访问。
2.  右键单击 .cer 文件（例如 aps_production.cer）
3.  选择“打开方式 > 钥匙串访问（默认）”

... 瞧，现在它与私钥一起显示。这很奇怪，因为无论如何它都在打开钥匙串访问。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2016-06-20T08:49:41.830

删除没有私钥的证书。在 Keychain 中打开登录，然后将文件从 Finder 拖到登录，您的证书现在有了一个私钥！

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2017-01-07T11:37:50.373

我的问题是我没有在“证书”下查看，而是在“所有项目”下查看： [![在此处输入图像描述](../Images/8b4f4d5a5b9a77284929307fad43b380.png)](https://i.stack.imgur.com/DlrVz.png)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2016-06-15T07:15:38.097

我只是双击证书。最终帮助我的是将证书**拖到相关部分。**

[![在此处输入图像描述](../Images/b50b19778823ca3847e2a604be74fd5c.png)](https://i.stack.imgur.com/HaNOM.jpg)

可以在此博客中找到更多详细信息：[如何在 p12 文件中导出推送通知证书？](https://www.mobiloud.com/help/knowledge-base/how-to-export-push-notification-certificate-p12/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-01-04T12:08:36.397

将其留在这里，希望对有类似症状的人有所帮助 - 当您单击`aps.cer`以使用钥匙串助手打开它时，它会提示您一个对话框以选择要导入证书的钥匙圈。对我来说，私钥没有出现在任何其他密钥环的可折叠中`login`（即其他密钥环，例如`System`或`System Roots`似乎只显示证书）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-07-02T13:20:11.437

我在这个问题上尝试了各种答案，但没有运气。我认为帮助我的是遵循[添加证书](https://developer.apple.com/account/resources/certificates/add)页面说明的底部： [![中级证书](../Images/780b2cc1467260722362633dd5e3baca.png)](https://i.stack.imgur.com/KtPTp.png)

所以我双击了[AppleWWDRCA](https://developer.apple.com/certificationauthority/AppleWWDRCA.cer)和[AppleWWDRCAG3](https://www.apple.com/certificateauthority/AppleWWDRCAG3.cer)。然后安装生成的证书，“我的证书”部分开始显示带有私钥的证书。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-09-26T06:03:32.310

删除没有私钥的证书。在钥匙串中打开登录

[![在此处输入图像描述](../Images/ffc2fc10beae54da070ebe82ac5c16c4.png)](https://i.stack.imgur.com/BuzHU.png)

将这两个证书拖到钥匙串中

呜你。在您的钥匙串中有私钥。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-06-12T16:40:16.823

.cer 文件不包含私钥，只有公钥。因此，所有这些解决方案仅与颁发原始 CSR 的计算机相关，或者与将原始证书的密钥对导入 Keychain 的计算机相关。

如果您无权访问私钥，您将不得不生成一个新证书。但是 - 您不必从 Apple 的证书门户中使旧证书无效，因为您可以为同一个应用程序 ID 使用多个 APNS 证书。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-05-16T15:51:30.850

这个问题的另一个答案...

创建 CSR 之后，在实际将其上传到 Apple 站点之前，您可以在**登录名**->**​​ 密钥**下的 Keychain Access 中查看，并查看您已经拥有与您在新 CSR 中输入的名称相同的新公钥和私钥**通用名**。

因此，当您将 CSR 上传到 Apple，然后下载证书，然后双击证书时，钥匙串访问只是将下载的证书与您的钥匙串访问列表中已经存在的公钥匹配，并附加私钥。

因此，如果您在所有这些之后无法获得私钥，请尝试重新创建您的 CSR。

对我来说奇怪的是，我读到每次重新创建证书时都可以使用相同的 CSR，但由于某种原因，这对我不起作用。可能是因为我要替换的旧过期证书不再在我的钥匙串访问列表中，因此没有与新生成的证书匹配的公钥/私钥对。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-08-19T11:55:57.647

原因是用于创建此推送证书的 CSR 文件不是来自您的计算机。您可以向创建此证书的人询问私钥。

# google-apps-script - scriptDB 为空，但 results.getsize() 显示数据存在

> ID：14614222
> 
> 赞同：0
> 
> 时间：2013-01-30T21:33:41.087
> 
> 标签：google-apps-script

在过去的 24 小时内，我的应用程序遇到了一些非常奇怪的问题。我想我已经把它缩小到 scriptDB 的一些问题上。

我的数据库是空的，但 results.getsize() 说它不是空的。

这是我在代码中运行的内容：

```
var db = ScriptDb.getMyDb();
var results = db.query({});

Logger.log(results.getSize());

while (results.hasNext()) {
      var result = results.next();
      Logger.log(Utilities.jsonStringify(result));
} 
```

我的日志显示：

> 38.0

但没有其他记录。那么这 38 个结果在哪里呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T23:18:51.713

不确定您是如何进入此状态的，但您的 ScriptDb 似乎已损坏，并且您处于与[Trying to erase a ScriptDb database that is faulty due to my error](https://stackoverflow.com/questions/11300989/trying-to-erase-a-scriptdb-database-that-is-faulty-due-to-my-error)中所述的类似情况。

如果你幸运的话，事情会自行好转，就像他们在其他情况下所做的那样。

如果可以，请将代码复制到新脚本中，然后重新开始。

剩下的唯一选择就是[报告问题](http://code.google.com/p/google-apps-script-issues/issues/entry?template=Defect%20report%20from%20user)。

您需要在问题跟踪器中添加“[功能请求....ScriptDB.removeBatch() 函数](http://code.google.com/p/google-apps-script-issues/issues/detail?id=2290)”。如果它得到实施，你的问题将是一个很好的测试用例。

# phpstorm - PHPStorm 将特定文件名呈现为纯文本

> ID：14614223
> 
> 赞同：37
> 
> 时间：2013-01-30T21:33:45.640
> 
> 标签：phpstorm

出于某种原因，PHPStorm 决定将任何名为 root.js 的文件呈现为纯文本，而无需 JS 着色和调试。有谁知道如何纠正这个问题？？？它快把我逼疯了！！！

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2013-01-30T21:47:15.160

转到`IDE Settings -> File types`并`Text files`在已识别的文件类型中查找。可能有一个名为的添加模式`root.js`

![在此处输入图像描述](../Images/b749746c12728b64e53385f1c5eb844f.png)

* * *

对于较新的版本，此设置位于`Editor -> File types`

![在此处输入图像描述](../Images/96448fb6c9b9f55b396b611666ca8702.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T21:37:54.037

我刚刚在 PHPStorm 5.0.4 中尝试过这个，我没有这个问题 - 所有的 JS 都是彩色编码的。

我使用右键单击 > 新建 > JavaScript 文件来添加文件。

# c# - 使用反射为单元测试进行复杂的对象断言是不好的做法吗？

> ID：14614224
> 
> 赞同：3
> 
> 时间：2013-01-30T21:33:45.677
> 
> 标签：c#, unit-testing, reflection

我正在阅读[这个主题](https://stackoverflow.com/questions/2811141/is-it-bad-practice-to-use-reflection-in-unit-testing)，它是关于使用反射来测试私有变量......

但是我的单元测试中没有这样的问题，而且我的代码是完全可测试的。

唯一的问题是我发现，对具有预期结果的复杂对象的每个属性进行断言时非常耗时；特别是对于复杂对象的列表。

由于它是一个复杂的对象，`Assert.AreEqual`除非我`IEquality`为每个对象实现，否则做一个正常的不会给我一个正确的结果。

但即使我这样做了，这也不会告诉我断言期间哪个属性/字段的名称、预期值和实际值。

正确的是，我们手动将每个属性值放入一个列表并执行单个`CollectionAssertion`，但这仍然很耗时，并且当断言发生时它只会告诉我元素值的索引不相等；它不会告诉我属性名称。这使得调试变得非常困难（我不得不进入调试模式并查看集合中的元素）。

所以我想知道，如果我编写一个递归反射方法，它将对两个复杂对象进行断言，它将告诉我每个属性名称、预期值、实际值。

这是一个好的做法还是坏的做法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T01:40:55.933

我发现很多人甚至不会考虑反射，但它有它的位置。正如其他海报所说，它在性能、类型安全等方面肯定有缺点，但我实际上认为单元测试是使用它的好地方。只要做得恰到好处。

当您不拥有您在属性中使用的所有类型时，试图对所有对象强制执行相等实现会陷入困境。实现一百个小型比较器类与手动写出断言一样耗时。

在过去，我编写了一个扩展方法，可以满足您的描述：

*   比较相同类型的两个对象（或实现公共接口）
*   反射用于查找所有公共属性。
*   如果属性是值类型，则直接 Assert.AreEquals 完成
*   对于引用类型，它进行递归调用

我的测试从不关心属性名称，因此重命名的重构并不重要。事实上，新属性会自动找到，而删除的属性会被遗忘。

我从来没有将它用于真正复杂的对象，但它与我拥有的对象一起工作得很好，而不会减慢我的测试速度。

因此，在我看来，在单元测试中请谨慎使用反射。

编辑：我会尽力为你挖掘我的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:35:25.287

在我看来，使用反射不是一个很好的选择。使用反射意味着我们在编译时失去了类型安全性。而且，在使用反射之后，（可能）通过程序集的元数据进行不区分大小写的字符串搜索。这会导致性能缓慢。考虑到这些方面，我认为拆分原始类型（由 oleksii 推荐）是一种好方法。

另一种方法可能是编写单独的测试，使用纯访问器方法测试单独的一组属性。这可能并不适用于所有情况。但是，在某些情况下确实如此。

例如：如果我有一个 Customer 类，我可以编写一个测试来检查地址类型字段；我可以编写另一个测试来检查订单类型字段等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T00:40:18.130

在*正常*情况下，您不需要反射来做*任何*与单元测试相关的事情。在回答您链接的问题时提到了这一点：

> 反思真的应该只是最后的手段

如果您需要检查复杂对象是否相等，**请在 unit test 中实现此类相等检查**。纯粹出于单元测试目的而拥有额外的代码并没有错：

```
public void ComplexObjectsAreEqual()
{
    var first = // ...
    var second = // ...

    AssertComplexObjectsAreEqual(first, second);
}

private void AssertComplexObjectsAreEqual(ComplexObject first,
    ComplexObject second)
{
    Assert.That(first.Property1, Is.EqualTo(second.Property1),
       "Property1 differs: {0} vs {1}", first.Property1, second.Property1); 
    // ...
} 
```

您不应该真正将单元测试视为*其他代码*。如果需要编写某些内容以使它们更具可读性、简洁性、可维护性——那就写吧。它与其他地方的代码相同。您会通过生产代码中的反射来比较对象吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-07T19:05:39.057

我想说使用反射来进行简单的单元测试有很多正当的理由。引用[https://github.com/kbilsted/StatePrinter](https://github.com/kbilsted/StatePrinter)

手动单元测试的问题

# 这很费力。

当我一遍又一遍地键入和重新键入时：Assert.This、Assert.That、……不禁想知道为什么计算机不能为我自动执行这些操作。所有这些不必要的打字都需要时间并消耗我的精力。

使用 Stateprinter 时，只要预期值和实际值不匹配，就会为您生成断言。

# 代码和测试不同步

当代码发生更改时，例如通过向类添加字段，您需要在某些测试中添加断言。但是，找到位置是一个完全手动的过程。在没有人全面了解所有类的大型项目中，所需的更改并未在所有应有的地方进行。

当将代码从一个分支合并到另一个分支时，也会出现类似的情况。假设您将错误修复或功能从发布分支合并到开发分支，我一遍又一遍地观察到代码被合并，所有测试都运行，然后合并被提交。人们忘记重新访问并仔细检查整个测试套件，以确定开发分支上存在测试，而不是发生合并的分支上存在测试，并相应地调整它们。

使用 Stateprinter 时，比较对象图而不是单个字段。因此，当创建一个新字段时，所有相关测试都会失败。您可以将打印调整到特定字段，但您失去了自动检测图表变化的能力。

# 可读性差我

您在测试类、测试方法的良好命名和测试元素的标准命名方面取得了长足的进步。但是，没有任何命名约定可以弥补断言造成的视觉混乱。当使用索引从列表或字典中挑选元素时，会更加混乱。在将它与 for、foreach 循环或 LINQ 表达式结合使用时，不要让我开始。

使用 StatePrinter 时，比较对象图而不是单个字段。因此，测试中不需要逻辑来挑选数据。

# 可读性差二

当我阅读如下测试时。想想这里真正重要的是什么

```
Assert.IsNotNull(result, "result");
Assert.IsNotNull(result.VersionData, "Version data");
CollectionAssert.IsNotEmpty(result.VersionData)
var adjustmentAccountsInfoData = result.VersionData[0].AdjustmentAccountsInfo;
Assert.IsFalse(adjustmentAccountsInfoData.IsContractAssociatedWithAScheme);
Assert.AreEqual(RiskGroupStatus.High, adjustmentAccountsInfoData.Status);
Assert.That(adjustmentAccountsInfoData.RiskGroupModel, Is.EqualTo(RiskGroupModel.Flexible));
Assert.AreEqual("b", adjustmentAccountsInfoData.PriceModel);
Assert.IsTrue(adjustmentAccountsInfoData.IsManual); 
```

当我们真正想要表达的是

```
adjustmentAccountsInfoData.IsContractAssociatedWithAScheme = false
adjustmentAccountsInfoData.Status = RiskGroupStatus.High
adjustmentAccountsInfoData.RiskGroupModel = RiskGroupModel.Flexible
adjustmentAccountsInfoData.PriceModel = "b"
adjustmentAccountsInfoData.IsManual = true 
```

# 说服力差

当业务对象的字段数量增加时，测试的可信度则相反。是否涵盖所有领域？字段是否被多次错误地比较？还是针对错误的领域？当您必须对一个对象执行 25 次断言时，您就知道痛苦，并且煞费苦心地确保对照正确的字段检查正确的字段。然后审阅者必须进行同样的练习。为什么这不是自动化的？

使用 StatePrinter 时，比较对象图而不是单个字段。您知道所有字段都被覆盖，因为所有字段都已打印。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-30T22:03:53.620

恕我直言，这是一种不好的做法，因为：

*   反射代码慢且难以正确编写
*   它更难维护，而且这样的代码可能对重构不友好
*   反射慢，单元测试要快
*   [也*感觉*不对劲]

对我来说，这看起来好像你是在试图堵住一个洞，而不是解决一个问题。为了解决这个问题，我可以建议将一个大而复杂的类分成一组较小的类。如果您有许多属性 - 将它们分组为单独的类

* * *

所以这样的课

```
class Foo
{
    T1 Prop1 {get; set;}
    T2 Prop2 {get; set;}
    T3 Prop3 {get; set;}
    T4 Prop4 {get; set;}
} 
```

会成为

```
class Foo
{
    T12 Prop12 {get; set;}  
    T34 Prop34 {get; set;}  
}
class T12
{
    T1 Prop1 {get; set;}
    T2 Prop2 {get; set;}
}
class T34
{
    T3 Prop3 {get; set;}
    T4 Prop4 {get; set;}
} 
```

请注意，`Foo`现在只有一个属性（即“分组”表示）。如果您可以以某种方式对属性进行分组，以便将任何状态更改本地化到特定组 - 您的任务将变得更加简化。然后，您可以断言“分组”属性等于预期状态。

# jquery - Flexslider 在图像之后加载，并导致 smoothHeight 属性再次为图像设置动画

> ID：14614226
> 
> 赞同：0
> 
> 时间：2013-01-30T21:33:49.553
> 
> 标签：jquery, slider, jquery-animate, flexslider

实际上有两个问题，都与 flexslider 相关，甚至可能彼此相关。

1.  我在我的网站[http://grrr.dontmeshwithus.com/中使用 Flexslider (](http://grrr.dontmeshwithus.com/) [http://www.woothemes.com/flexslider/](http://grrr.dontmeshwithus.com/) ) 。我将 Flexslider 属性 smoothHeight 设置为 true，因此它允许滑块的高度在水平模式下平滑地设置动画。我有问题，当我重新加载页面时，它首先加载第一个图像，然后它从 0 动画到图像高度。你可以看到这是多么令人讨厌和不想要的。任何想法如何防止这种情况，以便a）它不会为第一个图像设置动画或b）它在第一个图像加载之前加载flexslider？

2.  如果您转到单个帖子（例如[http://grrr.dontmeshwithus.com/ismo-alanko/ssdfs/](http://grrr.dontmeshwithus.com/ismo-alanko/ssdfs/)），它会显示当前幻灯片编号和总幻灯片编号（例如 3/5）。但是当我第一次进入页面时，或者刷新页面时，它会重置滑块并且不显示当前的幻灯片编号。它只是空的。如何让它正确显示它的当前幻灯片编号 (1)。如果我先转到第二张幻灯片然后返回到第一张幻灯片，它会显示第一张幻灯片的幻灯片编号。

这是我的 flexslider JS：

```
$(window).load(function() {
$('.flexslider').flexslider({
    animation: "slide",
    controlNav: false,
    keyboard: true,
    initDelay: 1000,
    useCSS: false,
    video: false,
    animationLoop: true,
    slideshow: false,
    smoothHeight: true,
    controlsContainer: ".flexslider-control",
    nextText: ">",
    prevText: "<",
    after: function(slider) {
        $('.current-slide').text(slider.currentSlide+1);
    },
    start: function(slider) {
        $('.total-slides').text(slider.count);
    }
    });
}); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:45:01.913

好的，这些实际上非常简单，我应该在问这里之前多考虑一下。

1.  我只是将脚本移到头部，因此它们首先加载。呃。

2.  代替

    ```
    after: function(slider) {
        $('.current-slide').text(slider.currentSlide+1);
    },
    start: function(slider) {
        $('.total-slides').text(slider.count);
    } 
    ```

我做了

```
after: function(slider) {
    $('.current-slide').text(slider.currentSlide+1);
},
start: function(slider) {
    $('.current-slide').text(slider.currentSlide+1);
    $('.total-slides').text(slider.count);
} 
```

# ruby - Sencha Touch 的 config.rb 中加载 File.Join 行的目的是什么？

> ID：14614230
> 
> 赞同：1
> 
> 时间：2013-01-30T21:34:17.843
> 
> 标签：ruby, sencha-touch, sencha-touch-2, sass, compass-sass

主题演示中使用的 config.rb 如下所示：

```
# Get the directory that this configuration file exists in
dir = File.dirname(__FILE__)

# Load the sencha-touch framework
load File.join(dir, '..', 'touch', 'resources', 'themes')

# Look for any *.scss files in same directory as this file
# Place compiled *.css files in the parent directory
sass_path    = dir
css_path     = File.join(dir, "..")
output_style = :expanded
environment  = :development 
```

File.join 行的目的是什么？与我从 github 下载的主题演示相关的路径似乎不正确：

[https://github.com/senchalearn/Touch-Theming](https://github.com/senchalearn/Touch-Theming)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T00:10:53.753

根据`Ruby`文档：

返回通过使用 File::SEPARATOR 连接字符串形成的新字符串。

这是文档的链接：

[http://www.ruby-doc.org/core-1.9.3/File.html](http://www.ruby-doc.org/core-1.9.3/File.html)

基本上，`File.join`将字符串连接在一起，返回文件路径中使用的新字符串。

# android - Android：如何用图形覆盖 ImageView？

> ID：14614243
> 
> 赞同：1
> 
> 时间：2013-01-30T21:35:04.740
> 
> 标签：android

为初学者的问题道歉，但我在这里扯头发......我有一个简单的视图，在 ImageView 背景上有几个小部件。覆盖一切的是一个透明的 ImageView，我想在上面绘制各种文本和图形。目的是在透明的 ImageView2 上绘制图形。

主要的.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:scaleType="fitXY"
        android:src="@drawable/background" />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="18dp"
        android:ems="10"
        android:inputType="numberDecimal" />

    <Button
        android:id="@+id/button1"
        android:layout_width="80dp"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="19dp"
        android:text="Button" />

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:scaleType="fitXY"
        android:scrollbarAlwaysDrawVerticalTrack="false"
        android:src="@drawable/transparent" />

</RelativeLayout> 
```

MainActivity.java

```
package com.example.overlay;

import android.os.Bundle;
import android.app.Activity;

public class MainActivity extends Activity {
    DrawView drawView;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
            drawView = new DrawView(this);
//              setContentView(drawView);
        setContentView(R.layout.main);
    }
} 
```

绘图视图.java：

```
package com.example.overlay;

import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.view.View;

public class DrawView extends View {
    Paint paint = new Paint();

    public DrawView(Context context) {
        super(context);
    }

    @Override
    public void onDraw(Canvas canvas) {
        int w = getWidth(), h=getHeight();
        paint.setColor(Color.GREEN);
        paint.setTextSize(20);
        canvas.drawText("Android", w/3, h/2, paint);
    }

} 
```

对我来说很明显这不起作用，因为我没有将 onDraw() 方法与透明覆盖 imageView2 相关联。如果我使用 'setContentView(drawView);' 然后我会在白色背景下松开背景等...如果我使用 'setContentView(R.layout.main);' 然后我不会得到文本. 所以问题是，如何将透明的 ImageView 与 onDraw() 方法相关联？这甚至是最好的方法吗？我已经在谷歌上搜索了好几天；也许我只是不明白要问什么问题:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T23:27:17.420

我认为内森在他的评论中提到了这一点......

您需要将自定义添加`DrawView`到您的 xml 布局中，因此您将拥有：

```
<com.example.overlay.DrawView
    android:id="@+id/overlay"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:scaleType="fitXY"/> 
```

然后，在您的`DrawView`类中，您需要一个构造函数来获取您在 xml 布局中添加的这些属性。您将需要的标准构造函数将采用`Context`和`AttributeSet`如下：

```
public DrawView(Context context, AttributeSet attrs) {
    super(context, attrs);
} 
```

`onDraw`然后，您可以像已经做的那样覆盖该方法，然后您可以操作`Canvas`.

确保当你`Canvas`被传递给方法时，它是使用and方法`onDraw`的屏幕的宽度和高度。如果不是，那么您可以从新设置画布，然后按照您的操作在画布上绘制。`getWidth()``getHeight()``Bitmap`

在 Android 开发者网站上有一篇关于创建自定义的有用文章，值得一`View`读。你可以在[这里](http://developer.android.com/training/custom-views/create-view.html)找到它。

# asp.net - 覆盖 ASP .NET 自定义主体

> ID：14614250
> 
> 赞同：1
> 
> 时间：2013-01-30T21:35:37.313
> 
> 标签：asp.net, wcf, iprincipal

我有一些代码在 Application.AuthenticateRequest 处理程序中使用自定义 IPrincipal 设置 HttpContext.Current.User。

这工作正常，我已经验证它在调试器中设置正确......但是，稍后在调用我的 WCF 操作时，HttpContext.Current.User 已被 System.Web.Security.RolePrincipal 覆盖。

我觉得我以前遇到过并解决了这个问题，但不记得它是如何发生的或为什么发生的。

谢谢。

# javascript - 如何使相机适合对象

> ID：14614252
> 
> 赞同：44
> 
> 时间：2013-01-30T21:35:43.517
> 
> 标签：javascript, three.js

使用 three.js 我有以下内容。

*   包含多个 Object3D 实例的场景
*   几个预定义的相机 Vector3 位置
*   如果屏幕调整大小，画布的动态宽度/高度
*   用户可以选择一个对象（从上方）
*   用户可以选择相机位置（从上方）

给定正在查看的对象和他们选择的相机位置，我如何计算最终的相机位置以“最适合”屏幕上的对象？

如果在某些屏幕上“按原样”使用相机位置，则对象会在我的视口边缘溢出，而其他对象则显得更小。我相信可以将物体安装到相机平截头体上，但找不到合适的东西。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-01-30T22:06:48.777

我假设您使用的是透视相机。

您可以设置相机的位置、视野或两者。

以下计算对于立方体对象是精确的，因此请考虑对象的边界框，对齐以面向相机。

如果相机居中并正面观察立方体，则定义

```
dist = distance from the camera to the _closest face_ of the cube 
```

和

```
height = height of the cube. 
```

如果您将相机视野设置如下

```
fov = 2 * Math.atan( height / ( 2 * dist ) ) * ( 180 / Math.PI ); // in degrees 
```

那么立方体高度将匹配可见高度。

在这一点上，您可以将相机稍微倒退一点，或者将视野扩大一点。

如果视野是固定的，那么使用上面的方程来求解距离。

* * *

编辑：如果你想让立方体`width`匹配可见*宽度*，让`aspect`画布的纵横比（画布宽度除以画布高度），并像这样设置相机视野

```
fov = 2 * Math.atan( ( width / aspect ) / ( 2 * dist ) ) * ( 180 / Math.PI ); // in degrees 
```

三.js r.69

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-04-29T09:46:10.097

Based on WestLangleys answer here is how you calculate the distance with a fixed camera field-of-view:

```
dist = height / 2 / Math.tan(Math.PI * fov / 360); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-01-06T00:34:08.170

To calculate how far away to place your camera to fit an object to the screen, you can use this formula (in Javascript):

```
// Convert camera fov degrees to radians
var fov = camera.fov * ( Math.PI / 180 ); 

// Calculate the camera distance
var distance = Math.abs( objectSize / Math.sin( fov / 2 ) ); 
```

Where `objectSize` is the height or width of the object. For cube/sphere objects you can use either the height or width. For a non-cube/non-sphere object, where length or width is greater, use `var objectSize = Math.max( width, height )` to get the larger value.

Note that if your object position isn't at `0, 0, 0`, you need to adjust your camera position to include the offset.

[Here's a CodePen](http://codepen.io/andrewray/pen/obZWvK?editors=001) showing this in action. The relevant lines:

```
var fov = cameraFov * ( Math.PI / 180 );
var objectSize = 0.6 + ( 0.5 * Math.sin( Date.now() * 0.001 ) );

var cameraPosition = new THREE.Vector3(
    0,
    sphereMesh.position.y + Math.abs( objectSize / Math.sin( fov / 2 ) ),
    0
); 
```

You can see that if you grab the window handle and resize it, the sphere still takes up 100% of the screen height. Additionally, the object is scaling up and down in a sine wave fashion (`0.6 + ( 0.5 * Math.sin( Date.now() * 0.001 ) )`), to show the camera position takes into account scale of the object.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-10-28T11:23:41.463

Assuming that object fits into screen if it's bounding sphere fits, we reduce the task to fitting sphere into camera view.

In given example we keep [PerspectiveCamera.fov](https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera.fov) constant while changing camera rotation to achieve best point of view for the object. Zoom effect is achieved by moving camera along .lookAt direction vector.

[![three.js zoom extents demo](../Images/e94f8b3ff1034a8df8b9e57f9ce9f22e.png)](https://i.stack.imgur.com/fH6G6.gif)

On the picture you can see problem definition: ***given bounding sphere and camera.fov, find L, so that bounding sphere touches camera's frustum planes.***

[![three.js zoom all camera](../Images/1cb36ffcce4889d7ea45fb9468db91dd.png)](https://i.stack.imgur.com/47oev.png)

Here's how you calculate desired distance from sphere to camera:

[![three.js zoom all camera](../Images/402876e378cc7bb00b2316dcde121e81.png)](https://i.stack.imgur.com/EIGJ3.png)

Complete solution: [https://jsfiddle.net/mmalex/h7wzvbkt/](https://jsfiddle.net/mmalex/h7wzvbkt/)

```
var renderer;
var camera;
var scene;
var orbit;
var object1;

function zoomExtents() {
  let vFoV = camera.getEffectiveFOV();
  let hFoV = camera.fov * camera.aspect;

  let FoV = Math.min(vFoV, hFoV);
  let FoV2 = FoV / 2;

  let dir = new THREE.Vector3();
  camera.getWorldDirection(dir);

  let bb = object1.geometry.boundingBox;
  let bs = object1.geometry.boundingSphere;
  let bsWorld = bs.center.clone();
  object1.localToWorld(bsWorld);

  let th = FoV2 * Math.PI / 180.0;
  let sina = Math.sin(th);
  let R = bs.radius;
  let FL = R / sina;

  let cameraDir = new THREE.Vector3();
  camera.getWorldDirection(cameraDir);

  let cameraOffs = cameraDir.clone();
  cameraOffs.multiplyScalar(-FL);
  let newCameraPos = bsWorld.clone().add(cameraOffs);

  camera.position.copy(newCameraPos);
  camera.lookAt(bsWorld);
  orbit.target.copy(bsWorld);

  orbit.update();
}

scene = new THREE.Scene();
camera = new THREE.PerspectiveCamera(54, window.innerWidth / window.innerHeight, 0.1, 1000);
camera.position.x = 15;
camera.position.y = 15;
camera.position.z = 15;
camera.lookAt(0, 0, 0);

renderer = new THREE.WebGLRenderer({
  antialias: true
});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setClearColor(new THREE.Color(0xfefefe));
document.body.appendChild(renderer.domElement);

orbit = new THREE.OrbitControls(camera, renderer.domElement);

// create light
{
  var spotLight = new THREE.SpotLight(0xffffff);
  spotLight.position.set(0, 100, 50);
  spotLight.castShadow = true;
  spotLight.shadow.mapSize.width = 1024;
  spotLight.shadow.mapSize.height = 1024;
  spotLight.shadow.camera.near = 500;
  spotLight.shadow.camera.far = 4000;
  spotLight.shadow.camera.fov = 30;
  scene.add(spotLight);
}

var root = new THREE.Object3D();
scene.add(root);

function CustomSinCurve(scale) {
  THREE.Curve.call(this);
  this.scale = (scale === undefined) ? 1 : scale;
}

CustomSinCurve.prototype = Object.create(THREE.Curve.prototype);
CustomSinCurve.prototype.constructor = CustomSinCurve;

CustomSinCurve.prototype.getPoint = function(t) {
  var tx = t * 3 - 1.5;
  var ty = Math.sin(2 * Math.PI * t);
  var tz = 0;

  return new THREE.Vector3(tx, ty, tz).multiplyScalar(this.scale);
};

var path = new CustomSinCurve(10);
var geometry = new THREE.TubeGeometry(path, 20, 2, 8, false);

var material = new THREE.MeshPhongMaterial({
  color: 0x20f910,
  transparent: true,
  opacity: 0.75
});

object1 = new THREE.Mesh(geometry, material);
object1.geometry.computeBoundingBox();
object1.position.x = 22.3;
object1.position.y = 0.2;
object1.position.z = -1.1;
object1.rotation.x = Math.PI / 3;
object1.rotation.z = Math.PI / 4;

root.add(object1);

object1.geometry.computeBoundingSphere();

var geometry = new THREE.SphereGeometry(object1.geometry.boundingSphere.radius, 32, 32);
var material = new THREE.MeshBasicMaterial({
  color: 0xffff00
});
material.transparent = true;
material.opacity = 0.35;
var sphere = new THREE.Mesh(geometry, material);
object1.add(sphere);

var size = 10;
var divisions = 10;
var gridHelper = new THREE.GridHelper(size, divisions);
scene.add(gridHelper);

var animate = function() {
  requestAnimationFrame(animate);
  renderer.render(scene, camera);
};

animate(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-05-03T19:34:15.553

try this for OrbitControls

```
 let padding = 48;
    let w = Math.max(objectLength, objectWidth) + padding;
    let h = objectHeight + padding;

    let fovX = camera.fov * (aspectX / aspectY);
    let fovY = camera.fov;

    let distanceX = (w / 2) / Math.tan(Math.PI * fovX / 360) + (w / 2);
    let distanceY = (h / 2) / Math.tan(Math.PI * fovY / 360) + (w / 2);

    let distance = Math.max(distanceX, distanceY); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-01-17T20:51:20.803

From user151496's suggestion about using the aspect ratio, this seems to work, although I've only tested with a few different parameter sets.

```
var maxDim = Math.max(w, h);
var aspectRatio = w / h;        
var distance = maxDim/ 2 /  aspectRatio / Math.tan(Math.PI * fov / 360); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-03-08T08:06:49.660

I had the same question but I expected the object(s) (represented by a `Box3` as a whole) could rotate on my phone if the whole was wider than my screen so I could view it by zooming in as near as possible.

```
const objectSizes = bboxMap.getSize();
console.log('centerPoint', centerPoint, bboxMap, objectSizes, tileMap);

//setupIsometricOrthographicCamera(bboxMap);
//https://gamedev.stackexchange.com/questions/43588/how-to-rotate-camera-centered-around-the-cameras-position
//https://threejs.org/docs/#api/en/cameras/PerspectiveCamera
//https://stackoverflow.com/questions/14614252/how-to-fit-camera-to-object
//          Top
//      +--------+
// Left | Camera | Right
//      +--------+
//         Bottom
// canvas.height/2 / disance = tan(fov); canvas.width/2 / disance = tan(fovLR);
// => canvas.width / canvas.height = tan(fovLR)/tan(fov);
// => tan(fovLR) = tan(fov) * aspectRatio;
//If rotating the camera around z-axis in local space by 90 degrees.
//        Left
//        +---+
// Bottom |   | Top
//        |   |
//        +---+
//        Right
// => tan(fovLR) = tan(fov) / aspectRatio;
const padding = 0, fov = 50;
let aspectRatio = canvas.width / canvas.height;
let tanFOV = Math.tan(Math.PI * fov / 360);
let viewWidth = padding + objectSizes.x, viewHeight = padding + objectSizes.y;
//The distances are proportional to the view's with or height
let distanceH = viewWidth / 2 / (tanFOV * aspectRatio);
let distanceV = viewHeight / 2 / tanFOV;
const camera = this.camera = new THREE.PerspectiveCamera(fov, aspectRatio, 0.1, 10000); //VIEW_ANGLE, ASPECT, NEAR, FAR
if (aspectRatio > 1 != viewWidth > viewHeight) {
    console.log('screen is more narrow than the objects to be viewed');
    // viewWidth / canvas.width => viewHeight / canvas.width
    // viewHeight / canvas.height => viewWidth / canvas.height;
    distanceH *= viewHeight / viewWidth;
    distanceV *= viewWidth / viewHeight;
    camera.rotateZ(Math.PI / 2);
}
camera.position.z = Math.max(distanceH, distanceV) + bboxMap.max.z;
//camera.lookAt(tileMap.position); 
```

I had tested two different aspect of `Box3` on tow different orientations (landscape and portrait) using my phone, it worked well.

References

*   [Box3.getSize ( target : Vector3 ) : Vector3](https://threejs.org/docs/#api/en/math/Box3.getSize)

    > `target` — the result will be copied into this `Vector3`. Returns the width, height and depth of this box.

*   [Object3D.rotateZ ( rad : Float ) : this](https://threejs.org/docs/#api/en/core/Object3D.rotateZ) (PerspectiveCamera)

    > `rad` - the angle to rotate in radians. Rotates the object around z axis in local space.

*   Other answers

# smalltalk - 创建一个 Message 对象，该对象将接受来自方法的值并不断添加它们

> ID：14614259
> 
> 赞同：1
> 
> 时间：2013-01-30T21:35:59.980
> 
> 标签：smalltalk, pharo

尝试通过方法发送电子邮件。我有一个方法

```
addHeader: headername with: aString 
|email|
email:= aString.
'To'= headername ifTrue[ self message: 'To:', with ].    
 'From'= headername ifTrue[ self message: 'From:', with].
 'Subject'= headername ifTrue[  self message:'Subject', with]. 
```

我的问题是工作区

```
addHeader:'To' with:'abcde@gmail.com'. 

addHeader:'From' with:'efg@gmail.com' 
```

当我一一执行上面的代码时。所有这些值都应添加到此方法中。

```
 message: aString 
 "Recieves To: abcde@gmail.com"
  ^ message
 "next time when it recieves From: efg@gmail.com. How can i concatenate 
   both earlier String and current String" 
```

如何得到这个结果

```
'To: abcde@gmail.com
From: efg@gmail.com' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T12:21:50.207

我不确定我是否得到了你想要做的事情。无论如何，假设您要发送一封指定发件人、主题等的邮件。有不同的方法可以做到这一点，但在每种情况下，您都必须在方法的不同调用之间保持状态，这是通过定义一个实例变量（或更多变量，取决于您选择遵循的方式）来完成的。如果要保留方法的签名，即继续使用单一方法来添加标题的不同部分，则可以使用包含 Dictionary 的单个 var。

这可以通过定义一个包含单个实例变量的 Header 类来完成，该实例变量将包含一个 Dictionary，例如`headerDictionary`。这个 var 必须在类方法中初始化，`new`如下所示：

```
new

    headerDictionary := Dictionary new. 
```

此时，您的`addHeader:email:`方法可以简单地将值放入字典中，如下所示，无需 if 或外部方法（顺便说一句，我不会调用它`addHeader:email:`，因为例如 Subject 的值不是电子邮件，但这些只是花里胡哨）：

```
addHeader: headerName email: aString

    headerDictionary at: headerName put: aString. 
```

通过这种方式，在您的工作区中，您可以执行以下几行并最终得到包含在 hdr 中的字典，其中包含您想要的值：

```
hdr := Header new.
hdr addHeader:'To' email:'abcde@gmail.com'.
hdr addHeader:'From' email:'efg@gmail.com'. 
```

# html - 固定菜单栏与同一页面上的链接内容重叠

> ID：14614262
> 
> 赞同：1
> 
> 时间：2013-01-30T21:36:11.567
> 
> 标签：html, css, anchor, css-position

我有一个新闻页面，我在其中回显来自我的 MYSQL 数据库的新闻，并在页面的正确站点上回显标题，这是指向页面该部分的锚链接。

就像有一个新闻叫“嘿”。然后，如果您按“嘿”，您将被移动到那里。. 这工作得很好。问题是该页面有一个位置固定的菜单。当我按“嘿”时它工作正常，只是固定菜单与某些内容重叠。

所以我想去那个锚标签，但减去菜单的大小。

没有真正的理由发布代码，因为这真的不会解释它，但问题是你链接到锚标签，只是固定菜单与它重叠。我看到了一些关于向标签添加类的内容，并将其定位为相对和边距顶部减去菜单的高度。但这只是移动链接。

有什么建议么？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:41:15.903

任何带有 position: fixed 的内容都会从正常的内容流中取出，因此不会占用页面空间。如果我理解正确，您希望您的菜单（位置：固定）占用页面空间但保持浮动。为了适应这种情况，您需要做以下两件事之一：

1.  如果您可以在页面的整个垂直长度上为菜单腾出空间，只需在整个页面上添加一个比菜单宽度（或略宽）的边距。
2.  如果你想让每篇文章在其内容的右上角有一个足够大的空间以供菜单和内容围绕它流动，请创建一个与每篇文章之前的菜单大小相同的 div 并给它浮动：对。

您的问题对于您正在寻找的结果有些模糊，并且没有代码，我无法提供具体信息。我希望这能提供一个关于去哪里的一般指南。

# css - 如何消除触发滚动条的div？

> ID：14614263
> 
> 赞同：0
> 
> 时间：2013-01-30T21:36:20.177
> 
> 标签：css, scrollbar

我有一种情况，我有一个宽度为 840 像素的包装 div。
现在，在该 div 中，我放置了一个不那么重要的装饰元素 (#dekoschrift)，它与包装 div 重叠。我不希望从该元素触发水平滚动条。

大致情况如下：

```
<div class="centerer">
    <div id="wrapper">
          <div id="dekoschrift"></div>
    </div>
</div> 
```

的CSS：

```
.centerer { position: relative; width: 830px; margin: 0 auto; height: 100%; }
#wrapper { position: relative; float: left; width: 100%; height: 100%; }
#dekoschrift { 
      background:  url(/images/layout/Variaton_Typogrund.png) no-repeat 0 0 transparent; 
      width: 238px; height: 524px; 
      position: absolute; top: 280px; left: 845px; z-index: 0; 
    } 
```

这有可能吗？

我试图将“溢出：隐藏”设置为包装器 div，但这显然是图形。而且我不能在 body 上使用“overflow-x：hidden”，因为这会导致无法在小屏幕上滚动。

这是实际页面的链接：www.variaton.ch

任何帮助表示赞赏！
也许有一些我不知道的秘密“显示：秘密”参数？！

干杯
斯特凡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:44:57.710

使用媒体查询。您可以禁用*不需要*滚动的显示的滚动，然后在强制时弹出滚动条。

```
body {
    overflow-x : hidden;
}

@media all and (max-width: 1024px) {
    body {
        overflow-x : auto;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:48:26.563

尝试

```
.dekoschrift
{
visibility:hidden;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T10:35:21.007

所以最终的代码是这样的：

```
 @media all and (min-width: 840px) {
        body {
            overflow-x : hidden;
        }
    }

    @media all and (max-width: 840px) {
        body {
            overflow-x : auto;
        }
    } 
```

谢谢 Alienwebguy

# html - HTML5 中文本样式的良好实践

> ID：14614265
> 
> 赞同：-1
> 
> 时间：2013-01-30T21:36:24.883
> 
> 标签：html, css, semantic-markup

我正在创建一个包含不同类型文本混合的网页——粗体、下划线、小、左对齐、居中对齐、右对齐等，并且在尝试从 HTML 中抽象样式时，我'正在尝试取消`<b>`和`<u>`标签。结果是定义类（例如“粗体”、“下划线”、“小”等）并使用 CSS 来提供样式。但是，这使得 HTML 更加冗长，其中包含`class="rightAlign small bold underline"`. 有一个更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T21:51:32.290

你有点错过了 CSS 的重点。

您想将标记与样式分开，而不是将两者结合起来。

有`<div class="bold">`什么比这更好的`<div style="font-weight: bold;">`？

也许少打字，但它具有相同的效果。如果你想稍后改变你的布局，你已经做到了，所以你需要去修改 CSS 和标记。

最好将属性分组。

因此，例如，而不是拥有

```
<div class="rightAlign small bold underline"> 
```

有

```
<div class="title">

.title {
   text-align: right;
   font-weight: bold;
   text-decoration: underline;
   font-size: small;
 } 
```

这样，您`title`以后可以根据需要进行更改，而无需浏览页面并修改标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:43:52.233

您可以分别使用和表示粗体和斜体，但前提是加粗/斜体的信息确实很重要。

如果您有一个小、粗体和下划线的区域，并且该区域在整个站点中重复多次，则使用它自己的类定义该区域并一次应用所有这些样式会更有意义。例如，wordpress 中的元区域，其中包含按日期发布的帖子和作者姓名。这种“元”类型的区域通常是斜体、较小的字体、不同的颜色，有时甚至是不同的字体。给那个区域`class="meta"`而不是给它`class="small italics geneva blue"`

# asp-classic - HasNext 是否存在于 ASP 中？

> ID：14614270
> 
> 赞同：0
> 
> 时间：2013-01-30T21:36:35.590
> 
> 标签：asp-classic, arraylist

如果列表中有下一个元素，我如何在 ASP 中测试？我正在尝试做这样的事情：

```
a=Split("foo, boo, luu, bar", ",")
for each x in a
    response.write("'" & x & "'")       
    if a.HasNext then
        response.write(",")
    end if
next 
```

它是如何工作的？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:40:10.110

没有 HasNext 但您可以测试数组的大小

```
a=Split("foo, boo, luu, bar", ",")
i = 0
for each x in a
    response.write("'" & x & "'")       
    if i < Ubound(a) then
        response.write(",")
    end if
    i = i + 1
next 
```

# scala - 在heroku上部署liftweb项目时无法访问css和js文件夹

> ID：14614271
> 
> 赞同：1
> 
> 时间：2013-01-30T21:36:36.277
> 
> 标签：scala, heroku, jetty, lift

我有一个 liftweb 应用程序，我可以使用 sbt ( `container:start`) 在 localhost 的码头上正确运行，我可以获得我所有的 CSS 和 JS 行为，我可以通过 URL 访问我的 CSS 文件`localhost:8080/css/style.css`。

但是在 Heroku 上部署它之后，我无法在我的页面上获取 CSS 样式，当我尝试从 URL 获取我的 CSS 文件时，我得到 404 页面。

这是我在 Procfile 中声明的 Go.scala 类：

```
object Go extends App {
  val port =
    if(System.getenv("PORT") != null) System.getenv("PORT").toInt
    else 8080

  val server = new Server
  val scc = new SelectChannelConnector
  scc.setPort(port)
  server.setConnectors(Array(scc))

  //val context = new ServletContextHandler(server, "/", ServletContextHandler.SESSIONS)
  val context = new WebAppContext()
  context.setContextPath("/")
  context.addServlet(classOf[DefaultServlet], "/");
  context.addFilter(classOf[LiftFilter], "/*", EnumSet.of(DispatcherType.REQUEST))
  context.setResourceBase("src/main/webapp")

  server.setHandler(context);

  server.start()
  server.join()

} 
```

我试图在我的 Boot.scala 中添加这部分代码，但它不起作用：

```
ResourceServer.allow {
  case "css" :: _ => true
  case "js"  :: _ => true
} 
```

# android - 启用/禁用接收器 (CONNECTIVITY_CHANGE) 会导致 APPWIDGET_UPDATE 广播

> ID：14614284
> 
> 赞同：3
> 
> 时间：2013-01-30T21:37:35.680
> 
> 标签：android, broadcastreceiver, android-appwidget

我有一个接收器正在监听，`android.net.conn.CONNECTIVITY_CHANGE`以便在连接恢复时更新我的​​ appwidget。这很好用，除非我通过以下方式启用或禁用接收器时出现一些奇怪的行为：

```
ComponentName receiver = new ComponentName(this, NetworkStateReceiver.class);
PackageManager pm = getPackageManager();
pm.setComponentEnabledSetting(receiver, PackageManager.COMPONENT_ENABLED_STATE_ENABLED,
        PackageManager.DONT_KILL_APP); 
```

当状态改变时，我还会收到一个`android.appwidget.action.APPWIDGET_UPDATE`广播到我的 appwidget 的接收器，导致我的 appwidget 在检测到连接丢失后再次更新，然后在返回连接时两次（一次是有意地从我的 NetworkStateReceiver，然后再次从`APPWIDGET_UPDATE`广播）。

此外，这似乎只发生在我的 4.04 设备上，而不是我的 2.1 设备上。

NetworkStateReceiver 和 AppWidgetProvider 的清单

```
 <receiver
        android:name=".AppWidgetProvider"
        android:label="@string/widget_name" >
        <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
        </intent-filter>

        <meta-data
            android:name="android.appwidget.provider"
            android:resource="@xml/appwidget" />
    </receiver>
    <receiver 
        android:name=".NetworkStateReceiver" 
        android:enabled="false">
        <intent-filter>
            <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />
        </intent-filter>
    </receiver> 
```

我尝试了几种方法来解决这个问题，但没有一个是非常好的解决方案。

`APPWIDGET_UPDATE`我可以忽略广播中的任何更新。实际上，我已经这样做了，因为我的所有 appwidget 更新都是在首次创建时通过警报管理器或配置活动通过服务进行的。尽管出于某些原因（并且可能表明正在发生的事情），`APPWIDGET_UPDATE`广播还导致我的远程视图恢复到其 XML 状态，就像它第一次添加一样。我也可以通过保存额外的状态（包括位图）来解决这个问题。不理想。

我可以让 NetworkStateReceiver 一直收听而不是启用/禁用，但这违背了 Android 的建议，并且有充分的理由，因为这意味着不必要的广播。

其他想法？

**编辑**：进一步解释我当前的解决方法。

`APPWIDGET_UPDATE`即使我使用警报来触发我的更新，我也不能忽略广播。这是因为它`APPWIDGET_UPDATE`还将我的小部件重置为其初始状态，就像它第一次添加到主屏幕一样。在我有连接的情况下，我可以进行双重更新，因为所有信息都可以重新填充。我还必须自己进行更新，因为该错误似乎特定于设备且未受影响的设备仍需要更新。

在我没有连接的情况下，我会从之前保存的状态恢复小部件。这意味着每次我进行成功更新时，我也会将所有内容保存到 SharedPreferences 中，以便当互联网无法正确重新填充数据时，它可以在这些“强制更新”之一下恢复。

在我的`AppWidgetProvider`我做（简化）：

```
Intent intent = new Intent(context, WidgetUpdateService.class);
intent.putExtra("loadFromSaved", true);   // this will be false when coming from AlarmManager
context.startService(intent); 
```

WidgetUpdateService.onStartCommand() （也简化了）：

```
if (intent.getExtras().getBoolean("loadFromSaved") {
    widgetLoader.loadFromSavedData();
} else {
    widgetLoader.load()
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:07:48.473

所以，如果我理解正确的话，有两件不同的事情正在发生：

1.  启用网络状态更改通知`ACTION_APPWIDGET_UPDATE`后，您的`AppWidgetProvider`.

    虽然这并不像人们所期望的那样（尽管我可以想象一种编码思想，即当网络状态发生变化时，小部件会想要更新自己），但它并不超出 android 系统的定义行为，因此我们的代码需要对任意`ACTION_WIDGET_UPDATE`调用具有鲁棒性。跟踪 appWidgetId 列表和该列表中每个小部件的最新状态是识别新小部件和立即需要更新的常用方法，同时将其他更新留给计时器机制。

2.  正如你所说：即使更新什么也没做，问题仍然存在。

    如果您`onUpdate`什么都不做，那么这意味着重新初始化与`ACTION_WIDGET_UPDATE`. 不知何故，当您不希望它调用时，您的初始化代码会被调用。现在，这很痛苦，特别是如果没有代码原因应该如此。但是，我和其他人都经历过这种情况，所以我指出你两个：

    *   我的帮助清单：[AlarmManager 重新创建的服务](https://stackoverflow.com/questions/15435117/service-being-re-created-by-alarmmanager)
    *   关于服务意外启动的简短讨论和解决方案（在服务管理小部件的情况下，这通常意味着它们被重新初始化）：[Android 服务 onCreate 被多次调用而不调用 onDestroy](https://stackoverflow.com/questions/7211066/android-service-oncreate-is-called-multiple-times-without-calling-ondestroy)

当我自己遇到这个问题时，我花了很多时间将 Log 语句放入我的代码中，以查看我的代码的哪些部分何时被调用，并且很明显系统正在重新启动我的服务，但没有明确的原因，但这是如这两个链接中所述解决。如果我必须选择一件我认为是关键的事情，那就是在与其他活动（包括`AppWidgetProvider`）分开的进程中运行服务。

# java - 使用 java.arraycopy 时遇到问题。(ArrayIndexOutofBounds)

> ID：14614285
> 
> 赞同：1
> 
> 时间：2013-01-30T21:37:44.383
> 
> 标签：java, exception, arrays

我正在尝试读取一个 csv 文件并将其数据复制到一个数组中。我似乎无法让它以这种方式工作，我不知道为什么。

```
String[] row = new String[0];
ArrayList<String[]> csv = new ArrayList<>();

String parser = "SPImages";
CSVReader reader = new CSVReader(new FileReader("C://data.csv"));
String[] nextLine;

while ((nextLine = reader.readNext()) != null){
    System.arraycopy(nextLine, 0, row, 0, nextLine.length);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T21:42:45.343

很可能目标数组（在本例中为“行”）没有源数组（在本例中为“nextLine”）那么大。与列表不同，数组不会自动调整大小。

# java - 获取 OpenGL 对象旋转

> ID：14614287
> 
> 赞同：-1
> 
> 时间：2013-01-30T21:37:53.647
> 
> 标签：java, android, opengl-es, matrix, rotation

我不会在这里发布我的整个程序，因为它有点太长了。但我有这个渲染器（缩短）：

```
 class OpenGLRenderer implements Renderer {

    private CubicPolygon cube;

    public OpenGLRenderer(Context context) {

        this.context = context;
        cube = new CubicPolygon();
    }

public void onDrawFrame(GL10 gl) {

    gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
    gl.glLoadIdentity();

    gl.glTranslatef(0.0f, 0.0f, -9.0f);
    gl.glScalef(0.8f, 0.8f, 0.8f);

    // If it's just a regular rotation
    if (!numberHasBeenDrawn) {
      gl.glRotatef(getXRotation(rotatingOfDOOMFire), 1, 0, 0);
      gl.glRotatef(getYRotation(rotatingOfDOOMFire), 0, 1, 0);
      gl.glRotatef(getZRotation(rotatingOfDOOMFire), 0, 0, 1);
    }

    // If there is a chosen one (number that is)
    if (numberHasBeenDrawn) {

      gl.glRotatef(xAnimation(number), 1, 0, 0);
      gl.glRotatef(yAnimation(number), 0, 1, 0);

    }
    gl.glFinish();
    cube.draw(gl);

  } 
```

现在我想做的是在“numberHasBeenDrawn”if 语句中获取该立方体对象的当前旋转值，这样我就可以创建一个平滑的结束动画来旋转立方体。OpenGL 可能将所有旋转值保存在一个方便（几乎不可读）的矩阵中，但经过一番谷歌搜索后，我真的找不到关于 WHERE 的任何信息（只是如何最初旋转一个对象，我已经这样做了）。

// 编辑：如果您想查看更多代码以帮助我，请继续询问，这并不是什么秘密，我也可以发布它；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:41:12.303

您应该自己在程序中的某个地方缓存旋转值。通常不鼓励从 OpenGL API 读取状态和值，并且可能会很慢，因为它破坏了 API 允许的流水线（出于性能原因，将 GPU 与 CPU 分离）。

# java - Android 使用来自数据库的所需数据填充 ListView

> ID：14614290
> 
> 赞同：0
> 
> 时间：2013-01-30T21:38:02.153
> 
> 标签：java, android, database, simplecursoradapter

我有一个警报应用程序，它将其警报存储到数据库中以便它可以检索它`ON_BOOT`，现在我正在考虑实现所有警报的显示，具体取决于您选择的日期。我一直在考虑使用 a`ListView`并用警报填充它。我已经读过这`SimpleCursorAdapter`是一种方法，但我想知道我将如何填充，以便它只显示星期一设置的警报，例如？看来我需要在某处运行查询，但我不确定在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:46:06.923

您可以运行仅在给定日期返回警报的 SQL 查询：

```
SELECT * FROM alarms WHERE strftime( '%w', date_column ) = day 
```

其中“day”是对应于星期几的数字（0=星期日，1=星期一等）。

如果您将日期存储为一周中的某一天，则更容易：

```
SELECT * FROM alarms WHERE day_column = day 
```

# c++ - 编写一个函数，生成将 n 写为素数和的所有可能性

> ID：14614294
> 
> 赞同：1
> 
> 时间：2013-01-30T21:38:20.827
> 
> 标签：c++, c

基本上，当我运行代码时，如果我给它一个大数字它就可以工作（将它分成素数，但是当我想为低数字运行它时它不起作用）我看到的问题是，如果我给程序编号 8 它不会在屏幕上打印任何内容。（我认为它与 2+2+2+2 有关）如果我写 50 它显示所有可能性，而无需在一行上重复 1 个素数

```
#include <math.h>
#include <stdio.h>
#include <stdlib.h>

#define is_sol  2
#define is_pos  4
#define impos  0

int n, *st;

int prim (int n)
{ 
    if ( n < 2 ) 
        return impos;
    else
        if ( n != 2 && (n % 2) == 0)
            return impos;
        else 
        { long i;
    for(i = 3; i <=sqrt(1.0*n); i +=2)
        if ( n % i == 0)
            return impos;
    }
    return is_pos;                   
}

int test(int h)
{  
    int i;
    if(!h) 
        return (st[h] < 2 ? impos : prim(st[h]));
    if(st[h] <= st[h-1]) 
        return impos;
    int p = st[h];
    if(!prim(p)) 
        return impos;
    int S = 0;
    for(i = 0 ; i <= h ; i++)
        S += st[i];
    if(S == n) 
        return is_sol;
    return (S < n ? is_pos : impos);
}

void print (int h)
{    
    int i;
    for(i = 0 ; i <= h; i++)
        printf("%d ", st[i]);
    printf("\n");
}

void back(int h) 
{ 
    int k;
    for(k = 2; k <= n/2; k++) 
    { 
        st[h] = k;
        int rez = test(h);
        if(rez == is_sol)
            print(h);
        else 
        { 
            if(rez == is_pos)
                back(h+1);
        }
    }
}

int main()
{ 
    printf( "Your number: ");
    scanf("%d",&n);
    st = (int*)malloc(sizeof(int)*(n/2));
    back(0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:01:51.640

条件

```
for(k = 2; k <= n/2; k++) 
```

负责。如果您想将一个数字写为不同素数之和，对于小数，唯一的方法通常包括一个大于的素数`n/2`- 例如，将 8 写为不同素数之和的唯一方法是`8 = 3 + 5`。

如果你做到了`k <= n-2`，它会起作用的。

如果您想允许多次使用相同的素数，例如`8 = 2+2+2+2`or `8 = 2+3+3`，您需要更改

```
if(st[h] <= st[h-1]) 
```

到

```
if(st[h] < st[h-1]) 
```

在`test`.

而且您应该跟踪到目前为止的总和，以避免最明显的低效率。（并存储一个素数列表，而不是每次都检查每个数字。）

# java - 解组 Web 服务响应时出错

> ID：14614295
> 
> 赞同：1
> 
> 时间：2013-01-30T21:38:28.657
> 
> 标签：java, xml, web-services, jaxb, jax-ws

我正在使用 JAX-WS 调用 Web 服务。我想将内容转换为 Java 对象。

这是 Web 服务响应的内容部分。

```
<header xmlns="">
  <store>
    <store_id>1</store_id>
    <store_name>ACME</store_name>
  </store>
</header> 
```

然后我创建了一个类，如下所示：

```
@XmlAccessorType(XmlAccessType.FIELD) 
@XmlType(name = "", propOrder = {
        "store_id",
        "store_name" }) 
@XmlRootElement(name = "store") 
static public class store { 
   @XmlElement(name = "store_id", required = true)
   protected String store_id;

   @XmlElement(name = "store_name", required = true)
   protected String store_name;
} 
```

我的 JAXB 代码：

```
List result = service.getService1Soap12().getDivisions().getContent();
ElementNSImpl e =(ElementNSImpl)result.get(0);
JAXBContext context = JAXBContext.newInstance(store.class);
Unmarshaller um = context.createUnmarshaller();

JAXBElement element = (JAXBElement) um.unmarshal(e);
store customer = (store) element.getValue(); 
```

我收到以下错误：

```
Exception in thread "main" javax.xml.bind.UnmarshalException: unexpected element (uri:"", local:"store"). Expected elements are <{http://tempuri.org/}header> 
```

我已经尝试了无数的方法来解决这个问题。任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:54:34.850

尝试将 DOM 元素包装在一个实例中`DOMSource`并执行以下操作：

```
DOMSource domSource = new DOMSource(e);
JAXBElement<store> element =
    unmarshaller.unmarshal(domSource, store.class); 
```

通过提供您希望解组的类，JAXB impl 不需要根据根元素确定解组类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T20:22:52.203

您的根元素`<header ...>`与`<store>`StackTrace 所说的不同。

尝试创建带有`@XmlRootElement(name="header")`注释和`Store`类的新类 Header（不是带有小“s”的“存储”），因为它是带有注释的属性（<- 如果您在 Store 类`@XmlElement(name="store")`中定义，则不确定是否真的需要 XmlElement 注释）。`@XmlRootElement`

# javascript - 如何更改水平滚动上的活动菜单项？

> ID：14614299
> 
> 赞同：1
> 
> 时间：2013-01-30T21:38:34.770
> 
> 标签：javascript, jquery

我正在尝试构建一个顶部带有固定菜单的单个页面，其中活动选项卡将根据水平滚动位置而变化。作为初学者，我想弄清楚**我的代码出了什么问题，**而不是使用 jQuery 插件。任何帮助纠正我的 JavaScript 代码将不胜感激。

HTML

```
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Test scrollLeft</title>
<link rel="stylesheet" href="style.css" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1 /jquery.min.js"></script>
<script type="text/javascript" src="js/script.js"></script>
</head>

<body>

<nav>
      <ul id="menu">
        <li><a id="one" class="active" href="#foo">Accueil</a></li>
        <li><a id="two" href="#bar">Infos</a></li>
        <li><a id="three" href="#baz">Contact</a></li>
      </ul>
    </nav>

<section class="page" id="foo">
      <h2>Accueil</h2>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
</section> 

<section class="page" id="bar">
  <h2>Infos</h2>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
</section>

<section class="page" id="baz">
      <h2>Contact</h2>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
</section>

<div class="result"><span id="result"></span></div>

</body>
</html> 
```

CSS

```
html, body {
height: 100%; 
overflow-y: hidden; 
margin:0px; padding: 0 0 0 0;
} 
body {
  width:4500px; 
  font-family: Helvetica, Arial;
}
.page {
  height:100%; 
  float: left; 
  width: 1500px;
} 
.page h2 {
  padding: 50px 0 0 20px;
}
.page p {
  width: 500px; 
  padding: 0 0 0 20px;
}
div.page p {
      height: 900px; 
      margin-top: 50px;
}
div.result {
      margin: 10px; 
      width: 100px; 
      height: 100px; 
      margin: 5px; 
      float: left; 
      color: white;
      background-color: blue;
      position: fixed;
      right: 0;
      bottom: 0;
} 
#foo {
  background-color: #e4e4e4;
}   
#bar {
  background-color: #c4c4c4;
}
#baz {
  background-color: #a9a9a9;
}
#menu {
    position: fixed;
    z-index: 1;
    background: #d68aa5;
    left: 0;
    right: 0;
    top: 0;
}
#menu li {
    float: left;
    display: block; 
}
#menu a {
    display: block; 
    padding: 5px 25px 7px 25px;
    transition: 1s all ease;
    color: #fff;
    text-decoration: none; 
}   
#menu a:hover {
    color: #000;
}
.active {background-color: #000; color: #fff!important;} 
```

JAVASCRIPT

```
$(document).ready(function(){ 

  $(window).mousemove(function () {

 var currentScrollLeft = $(window).scrollLeft();
 $("#result").html(currentScrollLeft);     

     switch(currentScrollLeft) {
    case (($currentScrollLeft >= 0) && ($currentScrollLeft <= 1499)):
        $('#one').addClass('active');
        break;

     case (($currentScrollLeft >= 1500) && ($currentScrollLeft <= 2999)):
        $('#two').addClass('active');
        break;

     case (($currentScrollLeft >= 3000) && ($currentScrollLeft <= 4500)):
        $('#three').addClass('active');
        break;
  }
   });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T11:40:46.710

看看这个[小提琴](http://jsfiddle.net/sHKsL/3/)链接，在这里我更新了你的源来解决这个问题。我希望这可以帮助你。

而不是 switch 语句

```
switch(cond){} 
```

你可以使用 if 语句

```
if(cond){} 
```

if 语句可以减少更多问题，因为 switch 不能对动态变量值进行操作，这意味着您只能在 switch 中使用常量值。

# java - 在 JSTL 中打印新行

> ID：14614300
> 
> 赞同：2
> 
> 时间：2013-01-30T21:38:36.300
> 
> 标签：java, jsp, jstl

如何在我的 JSTL 中添加新行。我尝试使用`<br/>`，它不适合我。我在我的 JSP 页面中添加了 JSTL 标记。

```
<fieldset>
      <legend>Performance Testing:</legend>
        <c:forEach items="${histogram}" var="entry">
          Key = ${entry.key}, Value = ${entry.value}<br/>
         </c:forEach>

</fieldset> 
```

目前它正在像这样打印

```
Key = 83, Value = 1 Key = 37, Value = 25 
```

我需要这样的东西-

```
Key = 83, Value = 1
Key = 37, Value = 25 
```

**更新：-**

我尝试使用 Firebug 进行调试，发现生成了这个源代码-

```
<fieldset>
<legend>Performance Testing:</legend>
Key = 38, Value = 2
<br>
Key = 39, Value = 3
<br>
Key = 40, Value = 1
<br>
Key = 88, Value = 1
<br>
Key = 41, Value = 1
<br>
Key = 42, Value = 2
<br>
</fieldset> 
```

这也有换行符，但它仍然像下面的屏幕截图一样显示在一行中 - 不是我上面提到的逐行显示的方式。

![在此处输入图像描述](../Images/dc3ea811202c9f914d43dd08b3facdaa.png)

我目前拥有的 CSS -

```
fieldset {
    margin: 0 0 22px 0;
    border: 1px solid #095D92;
    padding: 12px 17px;
    background-color: #DFF3FF;
}

legend {
    font-size: 1.1em;
    background-color: #095D92;
    color: #FFFFFF;
    font-weight: bold;
    padding: 4px 8px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T21:43:35.800

除非从未部署更改，否则没有任何方法无法工作！尝试清除服务器缓存。如果使用 tomcat，请清除 tmp 和 work 目录。

如果 JSP 包含在另一个 JSP 中，请尝试触摸这两个 JSP，然后查看。

另外，我不确定 HTML 是否允许您在`<fieldset/>`标签中使用换行符。我可能完全错了，但只是为了确保将这段代码放在常规`<div/>`标签中并尝试。

# java - 在java中暂停GIF播放

> ID：14614303
> 
> 赞同：1
> 
> 时间：2013-01-30T21:38:51.283
> 
> 标签：java, swing, awt, gif

我正在尝试用 Java 控制 GIF 的播放。GIF 是一个 Image 对象，由于似乎没有内置的暂停方法，我目前正在尝试做的是在 Image 对象上运行 wait() 命令。但是，这样做的唯一方法是使用同步，这会导致整个程序挂起。

解决此问题的最明显方法是将 GIF 分成单独的帧，并仅在未暂停时按顺序显示它们。然而，这似乎相当 arduos，所以我问，有没有更简单的方法来暂停我缺少的 java 中的 gif？

非常感谢。

# powershell - PowerShell 模块和管理单元

> ID：14614305
> 
> 赞同：0
> 
> 时间：2013-01-30T21:38:55.923
> 
> 标签：powershell, module, pssnapin

我创建了几个都依赖于 Microsoft.SharePoint.PowerShell 管理单元的实用程序模块。

当在我的机器上运行时，脚本都正确运行，我的配置文件中没有任何模块或管理单元用于 powershell “默认加载”，但是在其他机器上，它们的配置文件不能保证是干净的。

在我的模块加载器 .psd1 文件中，我使用以下

```
NestedModules = @( 'Microsoft.SharePoint.PowerShell',
        '.\Modules\CustomModule.psd1') 
```

我使用 ps1 文件来触发这些模块导入，其中包含以下 Import Module 命令

```
Import-Module -Name "$dir\.\CustomModules.psd1" -Global -Force -PassThru 
```

如果我以这种方式运行，我会在配置文件包含 Microsoft.SharePoint.PowerShell 管理单元的计算机上出现名称冲突错误，因为该管理单元已被加载。

我知道我们可以使用 -NoProfile 参数执行 PowerShell 命令，但这在我们的场景中不是一个有效的解决方案。

我还尝试从 NestedModules 部分删除管理单元并在导入模块之前在 .ps1 文件中运行以下命令，但管理单元未显示为已加载，因此模块导入失败。

```
if ((Get-PSSnapin | ? {$_.Name -eq 'Microsoft.SharePoint.PowerShell'}) -eq $null)
{
    Write-Host "Adding PSSnapin 'Microsoft.SharePoint.PowerShell'"
    Add-PSSnapin 'Microsoft.SharePoint.PowerShell'  } 
```

如何重新设计此解决方案以确保管理单元将正确加载并且模块将成功导入而不管用户配置文件如何？

我的理想情况如下：

```
Task.ps1   (The custom task me or other devs are trying to achieve)
     > Calls ImportModules.ps1   (Hides the importing logic of modules and snap-ins)
           > Imports CustomModules.psd1  (Imports all modules, functions, global vars into the runspace) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T22:47:00.627

我会放弃让 PSD1 文件通过 NestedModules 加载 snappin。创建一个 CustomModules.psm1 文件并将 ModuleToProcess（或 v3 中的 RootModule）设置为“CustomModules.psm1”。从 NestedModules 中删除 SharePoint dll。然后将类似这样的内容添加到您的 CustomModules.psm1 文件中：

```
function AddSnapin
{
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [ValidateNotNullOrEmpty()]
        [string[]]
        $Name
    )

    Process {
        foreach ($n in $name)
        {
            if (!(Get-PSSnapin $n -ErrorAction SilentlyContinue)) {
                Add-PSSnapin $n
            }
            else {
                Write-Verbose "Skipping $n, already loaded."
            }
        }
    }
}

AddSnapin Microsoft.SharePoint.PowerShell -Verbose 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T20:15:49.933

您可以测试程序集名称的存在

```
$assemblyname = "Microsoft.SharePoint.PowerShell"
if (([appdomain]::currentdomain.getassemblies() | 
      Where {$_ -match $AssemblyName}) -eq $null )
{
  add-pssnapin Add-PSSnapin 'Microsoft.SharePoint.PowerShell'
} 
```

或者只是加载它，如果它已经加载，则忽略错误：

```
Add-PSSnapin -Name "Microsoft.SharePoint.PowerShell" -ErrorAction SilentlyContinue 
```

# r - 为什么并行包比只使用 apply 慢？

> ID：14614306
> 
> 赞同：42
> 
> 时间：2013-01-30T21:38:57.063
> 
> 标签：r, parallel-processing

我正在尝试确定何时使用该`parallel`软件包来加快运行某些分析所需的时间。我需要做的一件事是创建矩阵来比较具有不同行数的两个数据帧中的变量。我问了一个关于在[StackOverflow上做事的有效方法的问题，并在我的](https://stackoverflow.com/questions/14485040/is-there-an-efficient-way-of-comparing-two-data-frames)[博客](https://web.archive.org/web/20171209073305/http://jason.bryer.org:80/posts/2013-01-24/Comparing_Two_Data_Frames.html)上写了关于测试的文章。因为我对最好的方法感到满意，所以我想通过并行运行来加速这个过程。以下结果基于具有 8GB RAM 的 2ghz i7 Mac。我很惊讶这个`parallel`包，`parSapply`特别是函数，比仅仅使用`apply`函数更糟糕。复制它的代码如下。请注意，我目前只使用我创建的两列之一，但最终想同时使用两者。

[![执行时间处理时间](../Images/5f10e62c2fcbaa488db7140f34b1cb12.png)](https://i.stack.imgur.com/xhz6n.png)
[（来源：[bryer.org](http://jason.bryer.org/images/ParalleVsApplyTiming.png)）]

```
require(parallel)
require(ggplot2)
require(reshape2)
set.seed(2112)
results <- list()
sizes <- seq(1000, 30000, by=5000)
pb <- txtProgressBar(min=0, max=length(sizes), style=3)
for(cnt in 1:length(sizes)) {
    i <- sizes[cnt]
    df1 <- data.frame(row.names=1:i, 
                      var1=sample(c(TRUE,FALSE), i, replace=TRUE), 
                      var2=sample(1:10, i, replace=TRUE) )
    df2 <- data.frame(row.names=(i + 1):(i + i), 
                      var1=sample(c(TRUE,FALSE), i, replace=TRUE),
                      var2=sample(1:10, i, replace=TRUE))
    tm1 <- system.time({
        df6 <- sapply(df2$var1, FUN=function(x) { x == df1$var1 })
        dimnames(df6) <- list(row.names(df1), row.names(df2))
    })
    rm(df6)
    tm2 <- system.time({
        cl <- makeCluster(getOption('cl.cores', detectCores()))
        tm3 <- system.time({
            df7 <- parSapply(cl, df1$var1, FUN=function(x, df2) { x == df2$var1 }, df2=df2)
            dimnames(df7) <- list(row.names(df1), row.names(df2))
        })
        stopCluster(cl)
    })
    rm(df7)
    results[[cnt]] <- c(apply=tm1, parallel.total=tm2, parallel.exec=tm3)
    setTxtProgressBar(pb, cnt)
}

toplot <- as.data.frame(results)[,c('apply.user.self','parallel.total.user.self',
                          'parallel.exec.user.self')]
toplot$size <- sizes
toplot <- melt(toplot, id='size')

ggplot(toplot, aes(x=size, y=value, colour=variable)) + geom_line() + 
    xlab('Vector Size') + ylab('Time (seconds)') 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-30T22:03:17.513

并行运行作业会产生开销。只有当您在工作节点上触发的作业需要大量时间时，并行化才能提高整体性能。当单个作业只需要几毫秒时，不断解雇作业的开销会降低整体性能。诀窍是在节点上划分工作，使工作足够长，比如至少几秒钟。我用它来同时运行六个 Fortran 模型效果很好，但是这些单独的模型运行需要几个小时，几乎抵消了开销的影响。

请注意，我没有运行您的示例，但我上面描述的情况通常是并行化花费的时间比顺序运行更长的问题。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-01-30T22:06:29.793

这些差异可归因于 1) 通信开销（尤其是跨节点运行时）和 2) 性能开销（例如，如果与启动并行化相比，您的工作不是那么密集）。通常，如果您要并行化的任务不是那么耗时，那么您通常会发现并行化并没有太大的影响（这在大型数据集上非常明显。

尽管这可能不会直接回答您的基准测试，但我希望这应该相当简单并且可以与之相关。例如，在这里，我构造了一个`data.frame`具有唯一列条目的行和 column 中的一些`1e6`值。然后我在使用和不使用并行化的情况下运行。`1e4``group``val``plyr``parallel``doMC`

```
df <- data.frame(group = as.factor(sample(1:1e4, 1e6, replace = T)), 
                 val = sample(1:10, 1e6, replace = T))
> head(df)
  group val
# 1  8498   8
# 2  5253   6
# 3  1495   1
# 4  7362   9
# 5  2344   6
# 6  5602   9

> dim(df)
# [1] 1000000       2

require(plyr)
require(doMC)
registerDoMC(20) # 20 processors

# parallelisation using doMC + plyr 
P.PLYR <- function() {
    o1 <- ddply(df, .(group), function(x) sum(x$val), .parallel = TRUE)
}

# no parallelisation
PLYR <- function() {
    o2 <- ddply(df, .(group), function(x) sum(x$val), .parallel = FALSE)
}

require(rbenchmark)
benchmark(P.PLYR(), PLYR(), replications = 2, order = "elapsed")

      test replications elapsed relative user.self sys.self user.child sys.child
2   PLYR()            2   8.925    1.000     8.865    0.068      0.000     0.000
1 P.PLYR()            2  30.637    3.433    15.841   13.945      8.944    38.858 
```

如您所见，**并行**版本的`plyr`运行**速度慢了 3.5 倍**

现在，让我使用相同的`data.frame`，但不是计算`sum`，而是让我构造一个要求更高的函数，例如`median(.) * median(rnorm(1e4)`(( 毫无意义，是的)：

你会看到潮流开始转变：

```
# parallelisation using doMC + plyr 
P.PLYR <- function() {
    o1 <- ddply(df, .(group), function(x) 
      median(x$val) * median(rnorm(1e4)), .parallel = TRUE)
}

# no parallelisation
PLYR <- function() {
    o2 <- ddply(df, .(group), function(x) 
         median(x$val) * median(rnorm(1e4)), .parallel = FALSE)
}

> benchmark(P.PLYR(), PLYR(), replications = 2, order = "elapsed")
      test replications elapsed relative user.self sys.self user.child sys.child
1 P.PLYR()            2  41.911    1.000    15.265   15.369    141.585    34.254
2   PLYR()            2  73.417    1.752    73.372    0.052      0.000     0.000 
```

在这里，**并行**版本比非并行版本`1.752 times` **快。**

**编辑：**根据@Paul 的评论，我刚刚使用`Sys.sleep()`. 结果当然是显而易见的。但为了完整起见，这里是 20*2 数据帧的结果：

```
df <- data.frame(group=sample(letters[1:5], 20, replace=T), val=sample(20))

# parallelisation using doMC + plyr 
P.PLYR <- function() {
    o1 <- ddply(df, .(group), function(x) {
    Sys.sleep(2)
    median(x$val)
    }, .parallel = TRUE)
}

# no parallelisation
PLYR <- function() {
    o2 <- ddply(df, .(group), function(x) {
        Sys.sleep(2)
        median(x$val)
    }, .parallel = FALSE)
}

> benchmark(P.PLYR(), PLYR(), replications = 2, order = "elapsed")

#       test replications elapsed relative user.self sys.self user.child sys.child
# 1 P.PLYR()            2   4.116    1.000     0.056    0.056      0.024      0.04
# 2   PLYR()            2  20.050    4.871     0.028    0.000      0.000      0.00 
```

这里的差异并不奇怪。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-31T01:36:19.037

完全同意@Arun 和@PaulHiemestra 关于*为什么...的论点？*你问题的一部分。

但是，在您的情况下，您似乎可以从`parallel`包中获得一些好处（至少如果您不使用 Windows）。可能的解决方案是使用`mclapply`而不是`parSapply`，它依赖于快速分叉和共享内存。

```
 tm2 <- system.time({
    tm3 <- system.time({
     df7 <- matrix(unlist(mclapply(df2$var1, FUN=function(x) {x==df1$var1}, mc.cores=8)), nrow=i)
     dimnames(df7) <- list(row.names(df1), row.names(df2))
    })
  }) 
```

当然，`system.time`这里不需要嵌套。用我的 2 个核心，我得到了：

![在此处输入图像描述](../Images/95f08517a9821530c4b81842a936d022.png)

# php - 创建表之间的关系 PHPMYADMIN

> ID：14614309
> 
> 赞同：-1
> 
> 时间：2013-01-30T21:39:09.610
> 
> 标签：php, mysql, phpmyadmin, table-relationships

请帮我！我正在创建一个数据库来存储有关 A&E 部门患者的数据。但是，我不确定如何关联这些表。

表结构：

患者（PatientID(PK)、名字、姓氏、性别、出生日期、地址、历史、疾病、优先级）

A&E（ID（PK）、PatientID（FK）、地址、城市、邮政编码、电话号码）

NURSE（护士ID（PK），名字，姓氏）

CONDITION (ID(PK), PatientID(FK) 症状, 诊断, 治疗)

基本上它们之间的关系是：

患者参加 A&E

PATIENT see_by NURSE

护士评估患者的状况

以下是需要添加的关系：

1.  时间应与患者和护士联系起来
2.  优先级应与患者和护士联系起来
3.  医生应与时间和优先级挂钩（医生将根据等待时间和患者的优先级做出决定）。医生和病人之间没有直接的联系。

我必须使这些关系正确，因此将不胜感激任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T00:05:22.773

你的问题我一点都不清楚。例如，您谈到患者和护士与“优先级”相关联，而医生与“时间”和“优先级”相关联——你写得好像这些是其他表格——但你没有描述它们。

根据我对您的问题的模糊理解，以下是我将如何解决您的问题。

我不知道 A&E 是什么意思。我假设它是诊所、医院或其他设施。

```
aes
    id                  unsigned int(P)
    street_address      varchar(75)
    city_id             unsigned int(F cities.id)
    postcode            varchar(10) // Whatever the size of your postal code.
    telenumber          varchar(10) // Whatever the size of your telenumber. 
```

显然，您的“状态”可能会有所不同。在美国，我们的州都有一个唯一的 2 字符代码。

```
cities
    id                      unsigned int(P)
    name                    varchar(50)
    state_id                char(2)(F states.id) 
```

您没有描述您需要了解的有关医生的信息，因此我假设这与您需要了解的有关护士的信息相同。

```
doctors
    id                  unsigned int(P)
    forename            varchar(50)
    surname             varchar(50) 
```

诸如：流感、支气管炎、鼻窦感染等。

```
illnesses
    id                  unsigned int(P)
    description         varchar(75)

nurses
    id                  unsigned int(P)
    forename            varchar(50)
    surname             varchar(50) 
```

我将患者病史放入它自己的表格中，这样我们就可以将每位患者的多种疾病以及患者患每种疾病的日期联系起来。

```
patient_history
    id                  unsigned int(P)
    patient_id          unsigned int(F patients.id)
    illness_id          unsigned int(F illnesses.id)
    qwhen               date

patients
    id                  unsigned int(P)
    forename            varchar(50)
    surname             varchar(50)
    gender              enum('f','m')
    dob                 date
    street_address      varchar(75)
    city_id             unsigned int(F cities.id)
    postcode            varchar(10) // Whatever the size of your postal code.
    telenumber          varchar(10) // Whatever the size of your telenumber. 
```

同样，您的“状态”可能有不同的大小 ID 或名称。

```
states
    id                      char(2)(P)
    name                    varchar(50) 
```

诸如：头晕、乏力、鼻窦充血、呼吸急促等。

```
symptoms
    id                  unsigned int(P)
    description         varchar(50) 
```

此表包含有关患者每次就诊 A&E 的信息。任何没有 end_time 的记录都代表当前在 A&E 等待医生/护士就诊的患者。您可以通过将当前时间与 beg_time 进行比较来确定患者等待的时间。当然，录取文员、护士、医生等会输入/更新优先级。

```
visits
    id                  unsigned int(P)
    patient_id          unsigned int(F patients.id)
    nurse_id            unsigned int(F nurses.id)
    ae_id               unsigned int(F aes.id)
    priority            unsigned tinyint // 1 = Critical, 2 = Urgent, 3 = whatever...
    beg_time            datetime
    end_time            datetime 
```

多个医生可能会看到一个病人...

```
visits_doctors
    id                  unsigned int(P)
    visit_id            unsigned int(F visits.id)
    doctor_id           unsigned int(F doctors.id) 
```

多个护士可能会看到一个病人......

```
visits_nurses
    id                      unsigned int(P)
    visit_id                unsigned int(F visits.id)
    nurse_id                unsigned int(F nurses.id) 
```

患者来访时通常会出现多种症状...

```
visits_symptoms
    id                  unsigned int(P)
    visit_id            unsigned int(F visits.id)
    symptom_id          unsigned int(F symptoms.id) 
```

# c# - ASP.NET MVC4 如何跨系统存储变量？

> ID：14614311
> 
> 赞同：2
> 
> 时间：2013-01-30T21:39:18.437
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, asp.net-mvc-4

所以我对 asp.net mvc 有点陌生，我正在构建一个多语言的网站，但我不想一直将 LanguageId 传递给每个特定于语言的对象的每个构造函数。在整个系统中将此 ID 存储在 asp.net mvc 中的最佳方法是什么？我相信对于用户来说，它被存储在一个 cookie 中，但这是正确的方法吗？

此外 languageId 来自数据库，所有语言特定标签也存储在数据库中而不是资源文件中

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T21:47:31.110

老实说，我不得不不同意 Darin（在多线程多服务器环境中，这可能会造成问题）。

我会为此推荐一个 cookie，当用户在上次访问后再次进入您的网站时，它很容易被拾取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T01:04:20.557

如果您的登录是会话驱动的，您可以将您的登录存储`language-id`在会话对象中。每次用户登录时都可以填充此对象。如果会话丢失，登录也会丢失。

如果您使用 Cookie 登录，请将其存储`language-id`在 cookie 中。

或者，考虑将 LanguageID 作为路线的一部分。

```
routes.MapRoute(
    "New",
    "{lang}/{controller}/{action}/{id}",
    new { lang = "en", controller = "Home", action = "Index", id = UrlParameter.Optional },
    new { lang = "en|de|it|es|fr" }
); 
```

用户登录后，立即重定向到包含语言作为路由一部分的路由。用于`@Url.actionlink`呈现您的链接。它们将始终包含语言 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T02:01:37.787

对于您的特定问题采取稍微不同的方法，并使用可通过[HttpRequest.UserLanguages](http://msdn.microsoft.com/en-us/library/system.web.httprequest.userlanguages.aspx)获得的浏览器语言怎么样？

那么就不需要传递任何东西，因为你可以在任何你可以得到`Request`对象的地方得到这个，例如在你的控制器中，它会是`Request.UserLanguages`

# xpath - XPath - 选择选定子节点的文本

> ID：14614318
> 
> 赞同：0
> 
> 时间：2013-01-30T21:39:55.197
> 
> 标签：xpath, html-agility-pack

鉴于我有以下 xml：

```
<div id="Main">
    <div class="quote">
        This is a quote and I don't want this text
    </div> 
    <p>
        This is content.
    </p>
    <p>  
        This is also content and I want both of them
    </p>
</div> 
```

是否有**“XPath”**可以帮助我选择**div#Main**的内部文本作为**单个节点**，但必须排除任何**div.quote**的文本。

我只想要文字：*“这是内容。这也是内容，我想要它们两个”*

提前致谢

这是测试 XPath 的代码，我使用 .NET 和 HtmlAgilityPack 但我相信 xPath 应该适用于任何语言

```
[Test]
public void TestSelectNode()
{
    // Arrange 
    var html = "<div id=\"Main\"><div class=\"quote\">This is a quote and I don't want this text</div><p>This is content.</p><p>This is also content and I want both of them</p></div>";
    var xPath = "//div/*[not(self::div and @class=\"quote\")]/text()";

    var doc = new HtmlDocument();
    doc.LoadHtml(html);

    // Action
    var node = doc.DocumentNode.SelectSingleNode(xPath);

    // Assert
    Assert.AreEqual("This is content.This is also content and I want both of them", node.InnerText);
} 
```

测试显然失败了，因为 xPath 仍然不正确。

```
Test 'XPathExperiments/TestSelectNode' failed:
    Expected values to be equal.

    Expected Value : "This is content.This is also content and I want both of them"
    Actual Value   : "This is content." 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T10:55:29.047

我认为没有 XPath 可以将其作为单个节点提供，因为您尝试获取的值*不是*单个节点。你有理由不能这样做吗？

```
StringBuilder sb = new StringBuilder();
// Action
var nodes = doc.DocumentNode.SelectNodes(xPath);
foreach(var node in nodes)
{
   sb.Append(node.InnerText);
}

// Assert
Assert.AreEqual("This is content.This is also content and I want both of them", 
                sb.ToString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:46:16.773

您想要 div 的任何子项的文本，这些子项不是带有类引号的 div：

```
div/*[not(self::div and @class="quote")]/text() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-27T18:42:10.183

没有 XPath 可以为您提供组合字符串值，因为 XPath 选择节点对象并且仅选择节点对象，即使它们是文本节点也是如此。

看到有问题`<p>`的节点`<div>`，我会使用

```
div[@id='Main']/p/text() 
```

`<p>`它会在 a 中的元素中生成文本节点列表`<div id="Main">`。遍历这些并连接文本内容应该很简单。

# css - 为什么要改变图像对齐方式

> ID：14614319
> 
> 赞同：-1
> 
> 时间：2013-01-30T21:39:56.430
> 
> 标签：css

 您能否通过以下链接查看我的网站，让我知道为什么链接标签会更改对齐方式？在添加链接标签之前，所有图像都水平和垂直对齐，但现在第二个图像看起来对齐更低！ 

[链接在这里](http://ghazalphoto.com/?page_id=248)

这是代码：

```
enter code here
<!-- wrapper -->
<div class="wrapper">
<!-- content -->
<div class="clearfix" id="items">
<a href="http://ghazalphoto.com/?page_id=285">
<div class="boxlist">
<img class="aligncenter size-full wp-image-253" alt="imgPortf_1" src="http://ghazalphoto.com/wp-content/uploads/2013/01/imgWedd_1.jpg" />
<h2>Love</h2>
</div>
</a>
<a href="http://ghazalphoto.com/?page_id=285">
<div class="boxlist">
<img class="aligncenter size-full wp-image-258" alt="imgPortf_2"    src="http://ghazalphoto.com/wp-content/uploads/2013/01/imgWedd_2.jpg" />
<h2>Beauty</h2>
</div>
</a>
<a href="http://ghazalphoto.com/?page_id=186">
<div class="boxlist">
<img class="aligncenter size-full wp-image-259" alt="imgPortf_3"  src="http://ghazalphoto.com/wp-content/uploads/2013/01/imgWedd_4.jpg" />
<h2>Fun</h2>
</div>
</a>
<a href="http://ghazalphoto.com/?page_id=290">
<div class="boxlist">
<img class="aligncenter size-full wp-image-259" alt="imgPortf_3" src="http://ghazalphoto.com/wp-content/uploads/2013/01/imgWedd_3.jpg" />
<h2>Favorite</h2>
</div>
</a>
</div>
<!-- End of content -->
</div>
<!-- End of wrapper --> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T21:44:49.140

问题是由`p`标签的放置引起的。

```
<p><a href="http://ghazalphoto.com/?page_id=276"></a><br>
<a href="http://ghazalphoto.com/?page_id=292"></a></p> 
```

如果删除它，则对齐是正确的。您也可以将其移动到包装器 div 之后以解决问题...

```
<div class="wrapper">
    <p><a href="http://ghazalphoto.com/?page_id=276"></a><br>
    <a href="http://ghazalphoto.com/?page_id=292"></a></p>
    ... 
```

**更新**

从技术上讲，您确实有`p`标签，因为您在 HTML 中犯了一个小错误......

```
<a href="http://ghazalphoto.com/?page_id=276"></p> 
```

在这一行，您关闭了一个`p`标签，即使您从未打开过标签，所以浏览器试图猜测您的意思。

如果您在 Firebug 中检查（在 Firefox 中），您会看到这将链接包装在一个段落中 - 因此您可以看到拼写错误的效果。

# git - Git bash说分支是（（未知））

> ID：14614320
> 
> 赞同：1
> 
> 时间：2013-01-30T21:40:01.620
> 
> 标签：git, repository, recover

我只是使用 Drupal 的命令行工具 Drush 在我的站点的本地副本上测试核心更新。目前尚不清楚更新是否成功，但它看起来确实破坏了我的 git 存储库。我在 WAMP 堆栈上使用 GitBash，它看起来像这样：

```
myuser@my-computer /c/wamp/www (d7upgrade)
$ drush pm-upgrade drupal
<.. whole bunch of drush output ..>

myuser@my-computer /c/wamp/www ((unknown))
$ git status
fatal: Not a git repository (or any of the parent directories): .git 
```

`.git`但是，我可以在 /c/wamp/www 中看到目录。它不是空的，实际上`.git\refs\heads`包含名为`master`and的文件`d7upgrade`（我的最新分支）。

我可以恢复我的 Git 存储库吗？

# ios - 显示随机类别的排行榜

> ID：14614321
> 
> 赞同：1
> 
> 时间：2013-01-30T21:40:06.773
> 
> 标签：ios, center, leaderboard

我在游戏中心的沙盒排行榜上有一个奇怪的问题。我有两个排行榜，有两个单独的 ID 又名类别。出于某种原因，我的第一个排行榜按钮每次都显示正确的排行榜，但第二个排行榜按钮在两个排行榜之间随机选择。我确定我的排行榜类别是正确的名称。我使用 leaderboardCategory 和 category 来确保 ios5 和 ios6 得到正确处理。这几乎就像我打开一个排行榜而不是关闭它并快速打开另一个它不会加载正确的排行榜。***此外，当此问题发生时，排行榜标题显示“排行榜”***

PS。有谁知道是否有可能有一个 GKLeaderBoardViewController 将您带到排行榜菜单，该菜单显示所有排行榜与特定排行榜并列？

谢谢大家。

例子：

```
GKLeaderboardViewController *leaderboardController = [[GKLeaderboardViewController alloc] init];
if (leaderboardController != NULL)
{
    leaderboardController.leaderboardCategory = @"Bounce_2";
    leaderboardController.category = @"Bounce_2";
    leaderboardController.timeScope = GKLeaderboardTimeScopeAllTime;
    leaderboardController.leaderboardDelegate = self;
    [self presentModalViewController: leaderboardController animated: YES];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-11T21:13:02.573

根据向Apple（ID：14206005）报告该错误的[Erik Asmussen](https://devforums.apple.com/message/847879#847879)所说，它已在 iOS 7（11A4400f）中得到修复。

当您使用排行榜组时会出现该错误，因此您可能暂时不想使用一个。

# jquery - 内部HTML jquery

> ID：14614325
> 
> 赞同：-1
> 
> 时间：2013-01-30T21:40:29.263
> 
> 标签：jquery

我正在尝试向任何具有 [RW] 文本但做错事的 TD 单元格添加一类红色。Firebug 给出了 typeFunction 的错误。

```
$("td").innerHtml("RW").addClass("red") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T21:43:58.760

在 jQuery 中，`.innerHTML()`不是方法。您应该改用过滤器：

```
$("td:contains('RW')").addClass("red"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T21:43:07.827

像这样的东西应该工作

```
$('td').each(function() {
  if ($(this).text() == 'RW') {
    $(this).addClass('red')
  }
}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T21:45:39.040

```
$('td').filter(function(index){return $(this).html() == 'RW';}).addClass('red'); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-30T21:48:36.003

a) 使用 html()，而不是 innerHtml()。innerHtml() 不是 JQuery 方法。b) 不带参数的 innerHtml 函数将返回元素的当前内容。使用字符串参数，它将设置内容。所以即使有

```
$('td').html('RW').addClass('red') 
```

您要将每个 td 元素的内容更改为“RW”，然后将红色类添加到所有元素中。

您需要优化选择器或使用条件。

# c# - 是否已知代码优先 EF 无法与包含大量 DbSet 的 DbContext 一起使用？

> ID：14614332
> 
> 赞同：3
> 
> 时间：2013-01-30T21:41:18.373
> 
> 标签：c#, entity-framework, ef-code-first

我希望得到一些快速的建议，只是为了告诉我我应该怀疑的天气（a）我做错了什么或（b）我正在尝试做一些不受支持的事情。

`DbContext`我从 QuickBooks生成了带有表格的代码。它有很多我永远不会使用的桌子，但我认为它不会受到伤害。

一切都很顺利，直到我尝试`SaveChanges()`在 Customer 表上进行一次插入后调用。我的测试用例成功了，但他的运行时间在 1 到 2 分钟之间。

然后我删除了除客户表和两个相关表之外的所有表，并且相同的测试在 2 毫秒内成功。

我很惊讶实体框架无法在一个上下文中处理数百个表的黄金时间，所以我认为我可能做错了什么。如果不是这种情况，我只想知道它。我不是在抱怨——我实际上并不需要那么多。

一个想法可能会使我在正常情况下所做的事情是我在一次巨大的迁移中添加了所有表。这些二进制迁移对象可能在运行时被引用吗？

这是我所指的 DbContext 的完整代码：[https ://gist.github.com/4677208](https://gist.github.com/4677208)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T07:50:14.160

第一次运行之前是否有任何数据库？

我假设，第一次生成数据库时调用 SaveChanges()，如果在 Seed 方法或其他地方初始化时有很多表和/或一些复杂的逻辑或大量数据传输，则可能需要一些时间。

因此，很可能不仅要插入单个客户，而且要生成整个东西需要很多时间。

在您提交第一个客户后尝试添加另一个客户，看看需要多长时间。

# php - 一个表单，一个提交按钮，但有两个操作

> ID：14614334
> 
> 赞同：7
> 
> 时间：2013-01-30T21:41:19.000
> 
> 标签：php, javascript, html, forms, action

我有一个收集客户信息的表格，然后它

*   将它们保存在数据库中
*   发出几封电子邮件
*   将信息发送到 SalesForce (SF) 部门

现在，前两个两个任务很容易，但第三个给我带来了麻烦。对于 SF，我没有做任何特别的事情，只需添加他们的 url，他们就会从表单中提取他们需要的所有必要信息。在我看来，为了做到这些，我需要表单具有与一个提交按钮关联的 2 个操作（不能有 2 个表单或 2 个按钮）。

所以在我的`raf.php`文件中我有这个表单，提交后我必须将它们重定向到`raf-submitted.php`显示成功/错误消息和其他必要信息的页面。

**表格** （从[这里](http://forums.htmlhelp.com/index.php?showtopic=560)得到想法）

```
 <form id="referralForm" name="referralForm" autocomplete="off" enctype="multipart/form-data" method="POST">

 <input id="saveForm" name="saveForm" class="field-submit" type="button" value="Submit" style="padding-left:20px" width="100" tabindex="23" onclick="FormSubmission(); SalesForceSubmission();" />

 </form> 
```

**JavaScript：**

```
 $(document).ready(function()
 { 
    function SalesForceSubmission()
    {
       document.referralForm.action = "https://someAddress.salesforce.com/";
       document.referralForm.submit();          
       return true;
    }

    function FormSubmission()
    {
       document.referralForm.action = "raf-submitted.php";
       document.referralForm.submit();          
       return true;
    }
  }); 
```

该`raf-submitted.php`文件负责表单验证、数据库插入和电子邮件问题。

它不工作。我也试过这些没有运气：

*   [两个 onClick 动作一个按钮](https://stackoverflow.com/questions/10544520/two-onclick-actions-one-button)
*   [在一个提交按钮的新窗口中打开 URL 的两个表单操作？](https://stackoverflow.com/questions/14018180/two-form-action-that-opens-url-in-a-new-window-in-one-submit-button)

有人可以帮帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:44:07.360

提交表单后，您将不再位于该页面上。你已经离开了。

另一种方法是通过 AJAX 提交第一个操作，然后自然地将表单提交到第二个目的地。我建议使用 jQuery 来进行 AJAX 调用，因为大多数 AJAX 代码已经在那里供您使用。

另一种选择是在`raf-submitted.php`收到表单数据后从您的服务器执行 POST 到 salesforce 服务器。请参阅：[在 PHP 脚本中发布到另一个页面](https://stackoverflow.com/questions/1217824/post-to-another-page-within-a-php-script)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T21:49:38.517

在客户端执行此操作的唯一方法是使用 AJAX。
最好在服务器端做 SF 的东西（如果你有访问权限，则通过 DB 或 Web 服务，如果他们有一个或至少在服务器端通过 CURL 发送数据）。
可能有一个提交在客户端失败（如果第二个失败似乎很糟糕 - 第一个请求不知道第二个没有正确完成）。

* * *

**编辑：**
使用 CURL 发布的示例代码：
假设您有一个带有 a`text`和一个`hidden`输入的表单：

```
<form method='post' action='http://your.sf.site/your_sf_submit_page.php'>
<input type='text' name='field1'/>
<input type='hidden' name='field2'/>
</form> 
```

你可以像这样使用 CURL 提交它：

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,"http://your.sf.site/your_sf_submit_page.php");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS,"field1=value1&field2=value2");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$server_output = curl_exec ($ch);
curl_close ($ch); 
```

然后您可以检查`$server_output`是否正确提交了表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T21:49:21.137

如果您可以控制 raf-submitted.php 页面，我建议您对表单进行 onclick 操作（在本地验证之后）使用 jQuery.ajax 调用您的页面，在查询中提供字段值作为参数字符串（如果使用 GET）然后简单地允许提交过程继续将数据传递给 SalesForce。

但是，如果您需要使 Salesforce 活动不可见，那么您可以使用 type=POST 以相同的方式调用它们，并在完成后移交给您的表单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-12T13:01:23.030

```
function fun_atualizar() {
    document.orcamento.action = "atualizar_orcamento.php";
    document.orcamento.submit();
    return true;
}

function fun_evento() {
    document.orcamento.action = "Evento_orc.php";
    document.orcamento.submit();
    return true;
}

<input  type="button" value="Atualizar" style="padding-left:20px" width="100" tabindex="23" onclick="javascript:fun_atualizar();" />

<input  type="button" value="Evento" style="padding-left:20px" width="100" tabindex="23" onclick="javascript:fun_evento();" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-07T05:55:10.570

这看起来很像我试图做的事情。您已经标记了一个答案，但我认为这不是您要寻找的简单答案。

假设上面的任务 3 可以通过 POST 到某个 SalesForce .PHP 位置来完成，并且前两个任务可以在 JavaScript 函数中完成，我认为这会起作用：

```
<form method="post" action="SubmitToSalesForce.php">
  <button type="submit" name="doThreeThings" onclick="doTheFirstTwoTasks();" >
</form

<script type="text/javascript">
  function doTheFirstTwoTasks() {
    // Task 1
    // Task 2
  }
</script> 
```

它首先调用`doTheFirstTwoTasks()`函数 via`onclick=`来执行任务 1 和 2，然后通过正常的表单提交将表单提交到`action=`第三个任务的位置。

没什么特别的，但我不知道有多少人知道您可以在一个表单中通过一个提交按钮使用`onclick=` *and* `type=submit` (with ) 来执行两个不同的操作。`action=`

在上面的代码中，似乎调用了`onclick=`before `action=`（或者可能只是因为 POST 提交比调用 JavaScript 函数慢......）

# c# - Twilio 的 TwilioRestClient SendSmsMessage 返回 null

> ID：14614335
> 
> 赞同：5
> 
> 时间：2013-01-30T21:41:19.577
> 
> 标签：c#, mono, amazon-ec2, twilio, restsharp

我的一切都在本地工作，但是当我在运行 Mono 2.10.9 的 Amazon EC2 Debian 6.0.6 服务器上测试 Twilio 的服务时，我发现发送 SMS 消息不再有效。我相信问题出在服务器配置的某个地方，因为我使用的是最新的 Twilio (3.5.6)、RestSharp (104.1) 和 JSON.NET (4.5.11) 库，并且我可以保证以下使用的变量方法调用在运行时不为空。

```
var client = new Twilio.TwilioRestClient("{my account number}", "{my account token}");
var smsMessage = client.SendSmsMessage("{my account phone number}", "{my mobile phone number}", "Hello World!"); 
```

使用 ntop，我看到有字节被发送/接收到/形成这个请求，但 smsMessage 结果仍然为空。SendSMSMessage 函数利用 RestSharp 库，特别是 RestClient 的 Execute 函数，它调用 Deserialize 方法并返回一个 IRestResponse，在这种情况下 Data 字段为空。

我在网上看到一些迹象表明问题可能出在反序列化过程中，但是，由于我已确保我使用的是最新版本的 JSON.NET，因此我不确定在此采取哪些其他步骤。

您对解决问题有什么建议吗？您是否怀疑这是代码或服务器问题？您还有什么建议，使用 Debian，我如何进一步调试这种交互，甚至从应用程序外部获取完整的字节响应？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T03:24:31.827

在调试 RestSharp 库时，我发现异常与 SSL 和 Mono 的受信任证书有关。我收到的异常消息如下：

```
Error getting response stream (Write: The authentication or decryption has failed.): SendFailure 
```

按照下面链接中的说明帮助我解决了这个问题，特别是通过执行以下操作并重新启动单声道。

```
certmgr -ssl https://api.twilio.com 
```

[http://www.mono-project.com/FAQ:_Security](http://www.mono-project.com/FAQ:_Security)

# svg - 绘制 SVG 后画布“被污染”

> ID：14614336
> 
> 赞同：3
> 
> 时间：2013-01-30T21:41:20.913
> 
> 标签：svg, cross-browser, html5-canvas, rasterizing, taint

已经提出了类似的问题，并且问题的原因很好理解，我要求的是替代方案或解决方法：

我想做的是从画布上获取一个数据 URL，该画布上绘制了一个 SVG 文档。我已经尝试了各种方法，但只要 SVG 靠近画布，IE9 和 Chrome 就不会让我拥有那个 URL。

我试过了：

*   Canvg（不支持我需要的一切）
*   将 svg 文件直接绘制到画布上 (content.drawImage(svg, 0 0))
*   创建整个 svg 文档的 base64 字符串，使其成为 an 的源，然后将该图像绘制到画布上。
*   将 svg 保存到文件，设置 src 属性以指向文件（在同一域上），然后将其绘制到画布上

我的想法不多了。

是否有类似的库可以尝试将 svg 栅格化？在绘制之前我是否可以将 SVG 转换为其他东西，这样画布就永远不会知道 SVG 参与其中？是否有一种非常简单的方法可以使用 PHP 或类似的东西在服务器端进行转换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T23:49:18.553

如果你想光栅化 SVG，这里有几个项目：

*   [SVG BTOA 序列化器](http://getcontext.net/read/svg-images-on-a-html5-canvas)
*   [来自序列化 SVG 的服务器端光栅化](http://www.cs.helsinki.fi/group/kuje/svg_open_2009_presentation/)

这是一个浏览器兼容性表：

*   [从 SVG 到 Canvas 并返回](http://www.svgopen.org/2010/papers/62-From_SVG_to_Canvas_and_Back/index.html#browser_compatibility)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-27T12:34:45.990

做三件事，

1.  获取 SVG 并使用 XMLSerializer 解析它
2.  在绘制 SVG 之前更改画布的高度和宽度
3.  使用“canvg”库来解析 SVG，而不是在浏览器上使用带有本机画布方法的画布。

> ```
> //Get SVG element and then serialize it to convert to a stream of String
> var svg = document.querySelectorAll('svg');
> var base64 = [];
> for(i=0; i < svg.length; i++){
> var serializer = new XMLSerializer();
> var svgString = serializer.serializeToString(svg[i]);
> var canvas = document.querySelectorAll('canvas');
> var render_width = 1000;
> var render_height = 600;
> 
> //CHange/Set Canvas width/height attributes to reset origin-clean flag
> canvas[i].height = render_height;
> canvas[i].width = render_width;
> 
> //Use canvg library to parse SVG and draw the image on given canvas
> canvg(canvas[i], svgString, {
> useCORS: true,
> scaleWidth: render_width,
> scaleHeight: render_height,
> ignoreDimensions: true,
> log: true
> });
> 
> //Convert canvas to png formated dataURL and save the body of it
> var rawImage = canvas[i].toDataURL("image/png");
> 
> //Array containing all the images in the form of base64 data URLs.
> base64ImageArray.push(rawImage);
> } 
> ```

希望这可以帮助。

# twitter-bootstrap - 使用引导程序垂直对齐文本/图像

> ID：14614338
> 
> 赞同：1
> 
> 时间：2013-01-30T21:41:35.003
> 
> 标签：twitter-bootstrap, vertical-alignment

使用 Bootstrap，我试图将两个跨度（跨度 4 和 span8）中的文本和图像与同一跨度（span8）中的一个图像和文本垂直对齐。图像当前向左浮动。图像将根据浏览器窗口的宽度隐藏/取消隐藏，因此文本将占据隐藏图像的空间。那部分有效。

但是将文本与图像垂直对齐并没有，我已经查看并尝试了我能找到的每一个“解决方案”，但没有一个对我有用。文本的总高度小于图像的高度。

代码...

```
<div class="outer">
<div class="row">
<div class="span4">Line 1<br/>Line 2</div>
<div class="span8"><img src="http://lorempixel.com/90/90/abstract/" alt="" />This is a line of text. <br /> This is another line of text.<br /> This is a third line of text.</div>
</div>
</div>

.outer img {display:block;}
.outer .row {padding:4px; background-color:#CC9966}
.span4 {background-color:#555; width:100px; text-align:right}
.span8 {background-color:#777; width:400px}
.row img {float:left; padding-right:5px; width:90px; height:90px;}

/* styles from bootstrap */
.row {margin-left: 0px; *zoom: 1;}
.row:before,.row:after {display: table; content: ""; line-height: 0;}
.row:after {clear: both;}
[class*="span"] {float: left; min-height:1px; margin-left:12px;} 
```

见[http://jsfiddle.net/profweather/sN9rU/](http://jsfiddle.net/profweather/sN9rU/)

我的项目中有二十四行，所以这种垂直对齐会重复很多次。

我最接近的是使用在[http://phrogz.net/css/vertical-align/index.html](http://phrogz.net/css/vertical-align/index.html)上看到的相对和绝对定位的外部 div/内部 div但图像右侧的文本仍然对齐到图像的顶部，未垂直对齐到图像的 90 像素高度。

我什至尝试了表格布局，但无济于事。非常感谢任何帮助/指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:42:31.970

对您的 HTML 进行轻微更改，就好像您有几十行，那么每一行都是外部的（假设您想在每一行上居中文本。

```
<div class="row outer">
    <div class="span4 inner2">Line 1<br/>Line 2</div>
    <div class="span8">
        <img src="http://lorempixel.com/90/90/abstract/" alt="" />
        <div class="inner3">This is a line of text.
            <br />This is another line of text.
            <br />This is a third line of text.</div>
    </div> 
</div> 
```

还有一个CSS上的frig - 只需根据行数选择每一行，例如将2行居中的文本使用类inner2和3行使用类inner3。这将为您节省一些集中注意力的痛苦。

```
/* .inner working but positioned relative
    use .inner3 where you have 3 lines of text and
    .inner2 where you have 2 lines, and adjust to suit 

     You will need @media queries if the layout is to be responsive...
*/

.inner3 {
    position:relative;
    top:12px;
}
.inner2 {
    position:relative;
    top:20px;
}

/* Mostly your stuff... */
.outer {
    border:2px solid red
}
.outer img {
    display:block;
}
.outer .row {
    padding:4px;
    background-color:#CC9966
}
.span4 {
    background-color:#555;
    width:100px;
    text-align:right
}
.span8 {
    background-color:#777;
    width:400px
}
.row img {
    float:left;
    padding-right:5px;
    width:90px;
    height:90px;
}

/* styles from bootstrap */
 .row {
    margin-left: 0px;
    *zoom: 1;
}
.row:before, .row:after {
    display: table;
    content:"";
    line-height: 0;
}
.row:after {
    clear: both;
}
[class*="span"] {
    float: left;
    min-height:1px;
    margin-left:12px;
} 
```

ps - 谢谢你的问题，因为我需要自己解决这个问题，并决定继续进行更容易。当然，任何更好的答案都非常感谢......

# opengl - 将 RGBA32F 纹理作为 R32F 传递给着色器，用于 imageAtomic 操作和访问组件

> ID：14614339
> 
> 赞同：3
> 
> 时间：2013-01-30T21:41:36.113
> 
> 标签：opengl, glsl, opengl-4

是否可以将 3D RGBA32F 纹理作为与 imageAtomic 操作（即 R32F）兼容的类型传递给着色器，然后以某种方式修改 ivec3 索引，以便确定性地访问 RGBA32F 纹理的适当组件？

我知道这对于索引更直接的缓冲区是可能的，但 ivec3 似乎会阻止巧妙的索引操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T23:01:32.810

首先，[*不*](http://www.opengl.org/wiki/Image_Load_Store#Atomic_limitations)`R32F`兼容[原子图像操作](http://www.opengl.org/wiki/Image_Load_Store#Atomic_limitations)。只有整数格式。除非您使用[的是 NVIDIA 扩展](http://www.opengl.org/registry/specs/NV/shader_atomic_float.txt)。[](http://www.opengl.org/wiki/Image_Load_Store#Atomic_limitations)

 *其次，[图像格式兼容性规则](http://www.opengl.org/wiki/Image_Load_Store#Format_compatibility)不允许您假装 RGBA32F 纹理是 R32UI 纹理。它们基于兼容的纹素大小工作，RGBA32F 大小为 128 位，而 R32UI 大小为 32 位。*

# java - 在 Ubuntu 11.10 上使用 Eclipse 的 JNI（Java 和 C++）

> ID：14614349
> 
> 赞同：1
> 
> 时间：2013-01-30T21:41:56.403
> 
> 标签：java, c++, java-native-interface

嗨，我是 JNI 的新手，我只是想用一个简单的 JNI 示例来使用 Eclipse。我按照以下教程中的步骤操作： http: [//codeandme.blogspot.com/2011/09/jni-made-easy.html](http://codeandme.blogspot.com/2011/09/jni-made-easy.html) 我的 Java 代码如下：

```
public class Main 
{
    private native int getDouble(int n);
    public static void main(String[] args)
    {
        System.load("/home/ryan/Desktop/libJNILibrary3.so");
        Main m = new Main();
        System.out.println(m.getDouble(3));
    }
 } 
```

然后我使用 jdk1.7.0_11/bin 中包含的 javah 工具生成头文件。

```
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class Main */

#ifndef _Included_Main
#define _Included_Main
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     Main
 * Method:    getDouble
 * Signature: (I)I
 */
JNIEXPORT jint JNICALL Java_Main_getDouble
  (JNIEnv *, jobject, jint);

#ifdef __cplusplus
}
#endif
#endif 
```

然后我在 Eclipse 中创建了一个 C++ 项目并创建了一个 Main.cpp 源文件。我将 Main.h 文件放在与 Main.cpp 相同的文件夹中。Main.cpp 的代码如下：

```
#include "Main.h"

JNIEXPORT jint JNICALL Java_Main_getDouble
  (JNIEnv *env, jobject obj, jint n)
{
    return n*2;
} 
```

然后我按照教程中的说明配置项目构建设置。当我构建项目时，它创建了“.so”文件“libJNILibrary3.so”。然后我运行我的 Java 类“Main”并收到以下错误：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: Main.getDouble(I)I
    at Main.getDouble(Native Method)
    at Main.main(Main.java:9) 
```

奇怪的是，如果我重做这个例子，并且让 getDouble 方法不接受任何参数，而只返回值 2，那么一切都会按应有的方式运行。让方法接受参数会以某种方式搞砸一切。我在这个错误上花了十多个小时，并搜索了很多论坛，但没有找到解决这个问题的方法。任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:57:36.467

您将函数的主体放置在 cpp 文件中，并且 JNI 回调必须遵循 C 样式名称修改。

在你的 cpp 文件中试试这个：

```
extern "C"
{

JNIEXPORT jint JNICALL Java_Main_getDouble
  (JNIEnv *env, jobject obj, jint n)
{
    return n*2;
}

} 
```

# sql - Firebird'更新或插入'与值中的字段引用？

> ID：14614352
> 
> 赞同：6
> 
> 时间：2013-01-30T21:42:14.460
> 
> 标签：sql, merge, firebird

我想在 Firebird 2.5 表中更新或插入一行，但如果我插入的值为 null，我希望它们被忽略。

我希望这样的事情会做到这一点：

```
update or insert into TargetTable
  ( FieldA, FieldB )
values
  ( :fielda, coalesce(:fieldb, FieldB )) 
```

但是，Firebird 不允许在“值”列表中引用 FieldB。

它确实允许这种更新语法：

```
update TargetTable
  set FieldB = coalesce( :fieldb, FieldB )
where
  FieldA = :fielda 
```

但这需要我单独处理插入。

有没有办法同时更新/插入和合并字段值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-30T22:01:58.013

看看这里：[http ://tracker.firebirdsql.org/browse/CORE-3456](http://tracker.firebirdsql.org/browse/CORE-3456)

您可能会查看 MERGE 语句：[http ://www.firebirdsql.org/refdocs/langrefupd21-merge.html](http://www.firebirdsql.org/refdocs/langrefupd21-merge.html)

```
merge into TargetTable e
using (select :fielda FieldA, :fieldb FieldB from RDB$DATABASE ) n
on e.FieldA = n.FieldA
when matched then
  update set e.FieldB = coalesce( n.FieldB, e.FieldB )
when not matched then
  insert (FieldA, FieldB) values ( n.FieldA, n.FieldB ) 
```

# css - 将噪声图像混合到 CSS 按钮中的目的是什么？

> ID：14614361
> 
> 赞同：0
> 
> 时间：2013-01-30T21:42:54.233
> 
> 标签：css, cross-browser, noise

我注意到 unfuddle.com 上的按钮使用了一层噪音，我只是想知道这样做的目的是什么，我看不出有什么区别，但也许这是一些跨浏​​览器的黑客攻击？

构建一个如此出色的 CSS3 按钮似乎很愚蠢，它不使用任何图像只是仍然加载噪声图像。

这是他们与相关按钮一起使用的 CSS，请注意 gnoise.png?cbv-1346878364

```
.gp_button, a.gp_button, input.gp_button:not([type="radio"]) {
    background-color: #C0EB00;
    background-image: radial-gradient(at center center , #7EBD00 20%, #77B300 80%), url("/images/gnoise.png?cbv=1346878364");
    border-color: #7FBF00;
    border-radius: 4px 4px 4px 4px;
    border-style: solid;
    border-width: 1px;
    box-shadow: 0 2px 0 rgba(0, 0, 0, 0.1);
    color: #FFFFFF;
    display: inline-block;
    font-family: "Lato","Arial",sans-serif;
    font-size: 20px;
    font-weight: 700;
    letter-spacing: 1px;
    line-height: 34px;
    margin-right: 1px;
    padding: 0 1em;
    text-decoration: none;
    text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
}
.gp_button:hover, a.gp_button:hover, input.gp_button:hover:not([type="radio"]) {
    background-color: #A5C416;
    background-image: radial-gradient(at center center , #85C700 20%, #7EBD00 80%), url("/images/gnoise.png?cbv=1346878364");
    border-color: #7FBF00;
}
.gp_button:visited, a.gp_button:visited, input.gp_button:visited:not([type="radio"]) {
    background-color: #C0EB00;
    background-image: radial-gradient(at center center , #7EBD00 20%, #77B300 80%), url("/images/gnoise.png?cbv=1346878364");
    border-color: #7FBF00;
}
.gp_button:active, a.gp_button:active, input.gp_button:active:not([type="radio"]) {
    background-color: #C0EB00;
    background-image: radial-gradient(at center center , #7EBD00 20%, #77B300 80%), url("/images/gnoise.png?cbv=1346878364");
    border-color: #90D900;
    box-shadow: 0 0 0 rgba(0, 0, 0, 0.1);
}
.oldie .gp_button, .oldie a.gp_button, .oldie input.gp_button:not([type="radio"]) {
    background-color: #7EBD00;
    border-color: #7FBF00;
    border-radius: 4px 4px 4px 4px;
    border-style: solid;
    border-width: 1px;
    box-shadow: 0 2px 0 rgba(0, 0, 0, 0.1);
    color: #FFFFFF;
    display: inline-block;
    font-family: "Lato","Arial",sans-serif;
    font-size: 20px;
    font-weight: 700;
    letter-spacing: 1px;
    line-height: 34px;
    margin-right: 1px;
    padding: 0 1em;
    text-decoration: none;
    text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
}
.oldie .gp_button:hover, .oldie a.gp_button:hover, .oldie input.gp_button:hover:not([type="radio"]) {
    background-color: #85C700;
}
.oldie .gp_button:visited, .oldie a.gp_button:visited, .oldie input.gp_button:visited:not([type="radio"]) {
    background-color: #7EBD00;
}
.oldie .gp_button:active, .oldie a.gp_button:active, .oldie input.gp_button:active:not([type="radio"]) {
    background-color: #7EBD00;
    border-color: #90D900;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:04:07.453

我的猜测是它可能存在于不支持 CSS3 的浏览器中。但是，当我检查 chrome 中的按钮时，它会被另一个图像覆盖，这让我相信情况并非如此。

如果旧浏览器不存在，那么很可能只是编码错误。也许他们在某个时候使用它并忘记将其取出。

但是要回答你的问题。它不用于任何事情，因为它已被此图像覆盖。如果你想复制他们正在做的事情，那么我会删除它。

```
background-image: -webkit-radial-gradient(center center, #7ebd00 20%,#77b300 80%),url('/images/gnoise.png?cbv=1346878364'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:13:23.557

`gnoise.png`在背景颜色（以及径向渐变）之上，为原本平坦的图像添加一些视觉复杂性。该效果在 上几乎看不到`a.gp_button`，但如果您使用 Photoshop 放大屏幕截图或使用吸管比较像素颜色，您可以看到它。`<footer>`由于其背景颜色较深，该效果在元素上更加明显。

通过在纯色之上重新使用一个图像，它们可以获得多种颜色，同时避免可能会减慢页面加载速度的多个 HTTP 请求。

这只是一个猜测，但 get 参数 ( `?cbv=1346878364`) 可用于确保在更新图像文件后，实际上从服务器中提取了一个新的图像文件，而不是使用浏览器缓存的版本。

# scala - 向 Map 添加 getAs[T] 方法

> ID：14614363
> 
> 赞同：3
> 
> 时间：2013-01-30T21:43:01.883
> 
> 标签：scala

我想向 中添加一个`getAs[T](key)`方法`Map`，该方法将返回值`asInstanceOf[T]`，当值类型为 时，我发现它很有用`Any`。这是我使用 trait 的尝试。

```
trait MapT extends Map[Any, Any] {
  def getAs[T](key: Any): T = super.apply(key).asInstanceOf[T]
}
val map = new Map[Any,Any] with MapT 
```

但是，编译器不允许我这样做，因为,`+`和方法没有定义，我真的不想定义。`-``iterator``get`

我该怎么做呢？有更好的方法`getAs[T]`吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-30T21:46:39.107

您可以使用丰富我的图书馆模式（前皮条客我的图书馆）：

```
class MapT(underlying: Map[Any,Any]) {
  def getAs[T](key: Any): T = underlying.apply(key).asInstanceOf[T]
}

implicit def map2MapT(m: Map[Any,Any]) = new MapT(m) 
```

现在您需要的只是将 map2MapT 导入您希望使用 getAs 的位置。

在 scala 2.10 中，您可以使用所谓的*隐式类*并将其编写为：

```
implicit class MapT(underlying: Map[Any,Any]) {
      def getAs[T](key: Any): T = underlying.apply(key).asInstanceOf[T]
} 
```

如果你不想生成包装器，你可以使用另一个 2.10 特性——*值类*：

```
implicit class MapT(val underlying: Map[Any,Any]) extends AnyVal {
      def getAs[T](key: Any): T = underlying.apply(key).asInstanceOf[T]
} 
```

因此编译器将剪切 MapT 类并在每个调用站点内联 getAs[T] 方法。

# javascript - jqMath中运算符的强制上标

> ID：14614367
> 
> 赞同：1
> 
> 时间：2013-01-30T21:43:10.700
> 
> 标签：javascript, mathml, jqmath

我正在使用`jqMath`在网站上显示化学公式。我需要能够将电荷显示为上标（即正电荷和负电荷 -）。似乎`jqMath`（或者可能`MathML`）硬编码所有数学运算符以显示为正常大小。我已经用`+`、`-`、`=`和`%`符号对此进行了测试，但没有一个会显示为上标（在此处测试：http: [//mathscribe.com/author/jqmath.html](http://mathscribe.com/author/jqmath.html)）。注意

```
<sup></sup> 
```

使用时不是有效的标记`jqMath`；^ 在任何要上标的字符之前。

有没有人找到解决这个问题的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T23:40:00.933

将上标括在`{}`:中`$H^{+}$`（或`$\H^{+}$`避免使用斜体）。

# sas - 将 CSV 中的所有列作为字符导入？

> ID：14614369
> 
> 赞同：4
> 
> 时间：2013-01-30T21:43:14.413
> 
> 标签：sas

简单的问题。

```
PROC IMPORT OUT= braw.address
DATAFILE= "&path.\address_data.csv"
DBMS=csv REPLACE;
GETNAMES=YES;

RUN; 
```

此语句将根据值将数据集列创建为字符*或*数字，这很聪明，但不是我想要的。

我想将它们全部作为字符导入，以便更轻松地进行正则表达式评估。

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:29:51.817

我通常只会为 CSV 编写自己的输入语句，然后您可以随意制作它们。

IE：

```
data braw.address;
infile "&path.\address_data.csv" dlm=',' dsd missover;
input
 field1 $
 field2 $
....
;
run; 
```

您可以使用 PROC IMPORT 中的日志第一次生成此日志，然后对其进行编辑以包含每个变量的 $。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T00:00:34.837

如果您不想编写 SAS 宏来将所有列作为字符读取，则可以尝试“作弊”。手动编辑文件并复制第一行（包含列标题的行。由于这些很可能都是字符串，SAS 应该将所有列作为字符导入。

当然，一个宏来做到这一点不会那么困难。你可以尝试这样的事情：

```
%macro readme(dsn,fn);
/* Macro to read all columns of a CSV as character */
/* Parameters:                                     */
/*   DSN - The name of the SAS data set to create  */
/*   FN  - The external file to read (quoted)      */
/* Example:                                        */
/*    %readme(want, 'c:\temp\tempfile.csv');       */
data _null_;
  infile &fn;
  input;
  i = 1;
  length headers inputstr $200;
  headers = compress(_infile_,"'");
  newvar = scan(headers,1,',');
  do until (newvar = ' ');
     inputstr = trim(inputstr) || ' ' || trim(newvar) || ' $';
     i + 1;
     newvar = scan(headers,i,',');
     end;
  call symput('inputstr',inputstr);
  stop;
run;

data &dsn;
  infile &fn firstobs=2 dsd dlm=',' truncover;
  input &inputstr.;
run;
%mend;
%readme(want, 'c:\temp\tempfile.csv'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-27T05:11:49.660

这是我读取 dlm 文件的宏，其中所有 vars 为 char：

```
%MACRO ImportText(file,dsn,dlm);

* Read data use proc import to get variable name and length;
PROC IMPORT DATAFILE="&file" OUT=temp DBMS=dlm REPLACE;
     DELIMITER = &dlm;
     GETNAMES = YES;
     GUESSINGROWS = 32767;
RUN;

* Put variable names into macro variable;
PROC CONTENTS DATA=temp out=vars NOPRINT; RUN;
PROC SQL NOPRINT;
    SELECT CATT(name,' : $',length,'.') INTO :vars SEPARATED BY ' ' FROM vars ORDER BY varnum;
QUIT; 

* Read real data;
DATA &dsn;
    INFILE "&file" DELIMITER=&dlm MISSOVER DSD FIRSTOBS=2 LRECL=32767;
    INPUT &vars;
RUN;

%MEND; 
```

# ruby - 带有 Postgresql 适配器的 Ruby activerecord 无法选择 OID

> ID：14614370
> 
> 赞同：3
> 
> 时间：2013-01-30T21:43:15.420
> 
> 标签：ruby, postgresql, activerecord

我是 Ruby 和 ActiveRecord 的新手，所以如果这是一个愚蠢的问题......对不起。

我有一个 Postgres 数据库表，其中包含路径名。我需要在特定路径上进行查找并获取 OID（该表定义为：set_default_oids = true）。问题是我可以添加一个 select("oid,path") 但我从来没有得到 OID。我确实得到了路径，但我需要 OID。

我假设有一些适配器选项或表类选项说：使用 OID，但我找不到它。

当我查看查找的结果时，我可以查看 object_id，但这似乎是 ActiveRecord 的内部内容，与 OID 无关。使用 psql 时，我可以这样做：

```
db=# SELECT oid,path FROM path_table; 
```

我看到了正确的 OID。所以我知道他们在那里...

有什么建议么？

抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T06:02:55.207

我将改用 PG 接口，因为使用 ActiveRecord 似乎不容易让我看到 OID。

# maven - Failsafe 集成测试期间的错误不会导致 Maven 构建失败

> ID：14614374
> 
> 赞同：5
> 
> 时间：2013-01-30T21:43:45.500
> 
> 标签：maven, selenium, integration-testing, maven-failsafe-plugin

我有 Failsafe 运行 Selenium 集成测试。如果我在测试中的一个断言没有通过并且测试失败，那么 Maven 构建将按预期失败。但是，如果测试出错，构建会意外成功完成（下面的输出）

```
Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 14.075 sec <<< FAILURE!

Results :

Tests in error:
  test(uk.co.ned24.ExpandedIT)

Tests run: 1, Failures: 0, Errors: 1, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 7 minutes 40 seconds
[INFO] Finished at: Wed Jan 30 16:58:28 GMT 2013
[INFO] Final Memory: 78M/209M
[INFO] ------------------------------------------------------------------------ 
```

我不确定这是否会发生，以及 Selenium 是否会导致意外行为？我查看了插件 doco，找不到任何可以设置为在测试错误后使构建失败的标志。

理想情况下，我想让构建因测试错误而失败，因此不胜感激！我已经附上了从我的 POM 中截取的故障安全，以防万一。

谢谢，尼克

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-failsafe-plugin</artifactId>
    <executions>
        <execution>
            <id>integration-test</id>
            <goals>
                <goal>integration-test</goal>
            </goals>
        </execution>
        <execution>
            <id>verify</id>
            <goals>
                <goal>verify</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <systemPropertyVariables>
            <configDir>${basedir}/local/integration-test</configDir>
        </systemPropertyVariables>
    </configuration>
</plugin> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-09-25T09:03:42.370

你应该打电话`mvn verify`而不是`mvn integration-test`.

引用[故障安全插件页面](http://maven.apache.org/surefire/maven-failsafe-plugin/)（强调我的）：

> Failsafe 插件用于构建生命周期的集成测试和验证阶段，以执行应用程序的集成测试。Failsafe 插件**在集成测试阶段不会使构建失败，**从而使集成测试后阶段能够执行。
> 
> 注意：在运行集成测试时，**您应该使用（也更短的类型）调用**maven
> 
> **mvn 验证**
> 
> 而不是尝试直接调用集成测试阶段，否则将不会执行集成测试后阶段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-28T13:35:44.277

您应该设置 maven-failsafe-plugin 的版本。例如到 2.14.1。

并且您的集成测试类必须以“IntegrationTest”结尾，例如：CustomDaoIntegrationTest

# python - 如何对列表中的某些项目执行操作

> ID：14614377
> 
> 赞同：1
> 
> 时间：2013-01-30T21:43:52.283
> 
> 标签：python, python-2.7

我有一些代码可以生成一定范围内的随机数列表（我们会说 0-100），但我希望不出现在范围（45-55）内的数字。

**出于我的特定目的**，我想知道如何在该范围内出现的数字中添加/减去 11。我写了一行：

```
desired_list = [integer_list[i] - 11 for i in range(len(integer_list)) if integer_list[i] in list_of_consecutive_unwanted_integers] 
```

但是现在当我打印desired_list 时，它显示空括号大约有4/5 次我检索随机数。无需解释这种奇怪的现象，但解释我做错了什么以及我需要什么会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:50:31.947

```
integer_list[i] in list_of_consecutive_unwanted_integers 
```

检查整数是否不需要，**丢弃**不在“不需要的列表”中的整数并保留不需要的整数。

这是我解决这个问题的方法：

```
>>> # let's get 20 random integers in [0, 100]
>>> random_integers = (randint(0, 100) for _ in xrange(20))
>>> [x - 11 if 45 <= x <= 55 else x for x in random_integers]
[62, 0, 28, 34, 36, 96, 20, 19, 84, 17, 85, 83, 17, 91, 98, 33, 5, 100, 94, 97] 
```

`x - 11 if 45 <= x <= 55 else x`是一个[条件表达式](http://docs.python.org/2.5/whatsnew/pep-308.html)，如果整数在 [45, 55] 范围内，则减去 11。你也可以这样写

```
x - 11 * (45 <= x <= 55) 
```

由于`True`和`False`具有数值 1 和 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:36:48.357

```
    >>> l = range(100)
    >>> [item for item in l if item <45 or item>55]
    [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:27:46.723

```
>>> l    # Let l be the list of numbers in the range(0, 100) with some elements
[3, 4, 5, 45, 48, 6, 55, 56, 60]
>>> filter(lambda x: x < 45 or x > 55, l) # Remove elements in the range [45, 55]
[3, 4, 5, 6, 56, 60] 
```

`filter`将函数应用于`f`输入序列并返回 f(item) 返回的序列中的项目`True`。

> **filter(...)**
> filter(function or None, sequence) -> list, tuple, or string
> 
> ```
> Return those items of sequence for which function(item) is true. If
> function is None, return the items that are true.  If sequence is a tuple
> or string, return the same type, else return a list. 
> ```

# c# - 获取 SortedDictionary 的倒数第二个元素

> ID：14614378
> 
> 赞同：3
> 
> 时间：2013-01-30T21:43:52.943
> 
> 标签：c#, collections, dictionary

我有一个看起来像这样的排序字典：

```
SortedDictionary<DateTime, string> mySortedDictionary = GetDataSource(); 
```

为了获得最后一个元素，我注意到我能够做到这一点：

```
DateTime last = Convert.ToDateTime(mySortedDictionary.Keys.Last()); 
```

有没有办法获得倒数第二个项目？我目前正在考虑的方式涉及获取最后一个项目，然后计算倒数第二个项目是什么。我的 DateTime 键都有一个固定的模式，但是，不能保证我完全知道它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T21:54:50.253

```
dictionary.Keys.Reverse().Skip(1).FirstOrDefault() 
```

这需要`O(n)`时间，但据我所知，似乎没有快速的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T21:55:05.917

使用 linq，您可以跳过所有项目，直到倒数第二个并取第一个（但首先检查字典是否至少有 2 个元素）：

```
var secondToLast = mySortedDictionary.Skip(mySortedDictionary.Count - 2).First(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T21:52:57.257

您可以使用此方法获取倒数第二个项目。请注意，它需要迭代*整个*键序列才能获得它，因此效率不高。另请注意，我大多忽略了 0 或 1 项序列的情况；如果您不想获得默认值，您可以检查它并抛出，或做其他事情。

```
public static T SecondToLast<T>(this IEnumerable<T> source)
{
    T previous = default(T);
    T current = default(T);
    foreach (var item in source)
    {
        previous = current;
        current = item;
    }

    return previous;
} 
```

要使用它：

```
DateTime secondToLast = mySortedDictionary.Keys.SecondToLast(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T22:10:01.807

您可以存储反转的密钥吗？在这种情况下，您可以使用`mySortedDictionary.Skip(1).FirstOrDefault()`.

`IComparer`您可以通过在构造函数中指定（简单）自定义来反转键排序顺序。

# ruby - 如何使用 Mechanize 登录和抓取网站

> ID：14614379
> 
> 赞同：0
> 
> 时间：2013-01-30T21:43:53.113
> 
> 标签：ruby, authentication, mechanize

我正在尝试使用 Mechanize 登录和抓取网站。

出于某种原因，我似乎无法让登录功能正常工作。有任何想法吗？

这是我的代码：

```
require 'nokogiri'
require 'open-uri'
require 'mechanize'

a = Mechanize.new
a.get('https://jackthreads.com/')

form = a.page.form_with(:class => 'jt-form')
form.field_with(:name => "email").value = "email"
form.field_with(:name => "password21").value = "password"
page = a.submit(form, form.buttons.first) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T21:55:53.433

表单上的操作设置为“ `#`”，因此您的提交将被忽略。POST 调用实际上是`https://www.jackthreads.com/login?method=ajax`通过 AJAX 进行的。也许如果您在提交之前使用 Mechanize 更新表单的 action 属性，它就可以解决问题。

对于它的价值，我用 Chrome Web Inspector 解决了这个问题。看到值设置为“ `#`”后，我转到网络选项卡，通过 XHR 过滤，然后尝试提交一些东西。

# javascript - 使用数组中的事件处理程序创建可观察对象

> ID：14614385
> 
> 赞同：0
> 
> 时间：2013-01-30T21:44:19.410
> 
> 标签：javascript, knockout.js

我有一个项目列表，每个项目都包含许多文本字段。文本字段需要是带有事件处理程序的可观察的，这样如果用户更改条目，事件处理程序就会被调用并相应地采取行动。

这是数组声明：

```
self.items = ko.observableArray(ko.utils.arrayMap(items, function(item) {
    return { quantity: item.quantity, size: item.size };
})); 
```

...总数量有一个文本框。基本上，在编辑数组行中的数量时，我需要文本框来显示运行总计：

总计：输入数据绑定='值：总计'

我在这里创建了一个 JSFiddle：

[http://jsfiddle.net/phykell/HyYFq/](http://jsfiddle.net/phykell/HyYFq/)

这个想法是，如果用户在其中一个项目中输入/更改数量，则针对给定大小更新总和，并更新生成的 TOTAL 值。

欢迎任何建议 - 我是否应该尝试使用此处描述的方法：

[http://knockoutjs.com/documentation/unobtrusive-event-handling.html](http://knockoutjs.com/documentation/unobtrusive-event-handling.html)

谢谢你看:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:14:26.493

你应该使用`ko.computed`函数。数量和大小需要可观察以更新总计。所以需要像面向对象一样思考**，**需要像Item一样成为模型。

```
var initialData = [
    { quantity: "100", size: "8" },
    { quantity: "200", size: "10" }
];
var Item = function (q, s) {
    this.quantity = ko.observable(q),
    this.size = ko.observable(s)
}
var ItemsModel = function(items) {
    var self = this;
    self.items = ko.observableArray(ko.utils.arrayMap(items, function(item) {
        return new Item(item.quantity, item.size);
    }));
    self.addItem = function() {
        self.items.push(new Item(1,1));
    };
    self.removeItem = function(item) {
        self.items.remove(item);
    };
    self.total = ko.computed(function() {
        var total = 0;
        ko.utils.arrayForEach(this.items(), function(item) {
            total += item.quantity() * item.size();
        });
        return total;
    }, self);
};

ko.applyBindings(new ItemsModel(initialData)); 
```

直播：http: [//jsfiddle.net/HyYFq/1/](http://jsfiddle.net/HyYFq/1/)

# encoding - Outlook 2003/2010 主题编码

> ID：14614392
> 
> 赞同：2
> 
> 时间：2013-01-30T21:44:49.457
> 
> 标签：encoding, outlook, subject

'收到的电子邮件信息和主题包含德语符号，包括**变音符号**（如 'ä' 或 'ö'）。邮件正文显示正确，变音符号没有问题**，**但邮件主题有问题：

*   Outlook 2003：“Bestätigung”显示为“Besttigung”
*   Outlook 2010：'Bestätigung' -> 'ä' 显示为一些不可读的符号

如何让它正确显示？PS Thunderbird 正确显示带有变音符号的主题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:50:49.737

如果 Outlook 以这种方式显示它，您将无法解决该问题 - 但问题不在于发件人发送的邮件编码错误吗？还是您的意思是它仅在您自己的 UI 中显示不正确？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:20:19.980

下一个问题是：创建邮件时，邮件正文设置为编码“UTF-8”，而主题没有。

# c# - DisplayMessage 错误“不存在”

> ID：14614394
> 
> 赞同：0
> 
> 时间：2013-01-30T21:44:51.530
> 
> 标签：c#, asp.net, web-applications, web

下面是代码。它说“DisplayMessage”的地方是我有问题的地方。

```
protected void btnSend_Click(object sender, EventArgs e)
    {
        SendMail();
        DisplayMessage.Text = "Thank you for the comment! Please hit the 'Return to Main Page' to return to the Main Page!";
        DisplayMessage.Visible = true;
        txtPhone.Text = "";
        txtEmail.Text = "";
        txtName.Text = "";
        txtComment.Text = "";
    } 
```

我是否缺少某种资源？这是我目前正在使用的。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Net; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:54:16.943

看起来您从[codeproject](http://www.codeproject.com/Tips/371417/Send-Mail-Contact-Form-using-ASP-NET-and-Csharp)下载了此代码。主页上的示例似乎与实际解决方案中的代码不一致。尝试更改`DisplayMessage`为`lblMsgSend`，看看是否可以解决它。

更好的是，查看`ContactControl.ascx`文件并查找标签 ID：

```
<p>
    <asp:Label ID="lblMsgSend" runat="server" Visible="false" />
</p> 
```

# xna - 确定鼠标在哪个精灵上

> ID：14614398
> 
> 赞同：1
> 
> 时间：2013-01-30T21:45:01.917
> 
> 标签：xna, mouseover, isometric

我正在尝试确定鼠标在等距 2D 游戏中位于哪个精灵上。我认为我最好的选择是将每个精灵绘制成一个单独的颜色`renderTarget2D`并将其转换为一个`Texture2D`，此时我可以从鼠标点获取颜色数据并与绘制的精灵进行检查。

我使用该方法遇到的问题是我无法将单个精灵的颜色更改为纯色。如果我在调用中更改颜色`spriteBatch.Draw`，它只会对精灵的颜色进行着色，而不是将其绘制为纯色，因此我从纹理中检索到的数据没有帮助。

有什么建议或帮助以纯色绘制这些精灵吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T23:33:05.183

不要那样做。创建一个新的渲染目标并将数据复制到内存中，即使是每秒 60 次的一百个精灵，也*远远超出*了当前系统的处理能力。

简单使用[`Contains`](http://msdn.microsoft.com/en-us/library/bb447714.aspx)Rectangle 结构的方法：

```
var destination = new Rectangle(100, 100, 50, 50);
bool mouseOver = destination.Contains(mouseX, mouseY); 
```

# java - ExpandableListview 中 Childview 中的进度条

> ID：14614399
> 
> 赞同：0
> 
> 时间：2013-01-30T21:45:08.283
> 
> 标签：java, android-layout, expandablelistview

我正在尝试构建一个应用程序。

我想要的是一个`expandable List`. an 的每个元素`ArrayList<Object>`也应该是 List 的一个元素。Parenttitle 应该是对象的标题。此对象还包含一个`ArrayList<Double>`具有四个元素的。

每个父母都应该有一个孩子。父母的孩子应该显示四个进度条。的第一个元素`ArrayList<Double>`应该设置第一个progressBar的进度等等。

这就是我现在所拥有的：

```
public class Lernen extends Activity {

private ExpandableListView mExpandableList;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_lernen);

    mExpandableList = (ExpandableListView) findViewById(R.id.expandable_list);

    ArrayList<Parent> arrayParents = new ArrayList<Parent>();
    ArrayList<String> arrayChildren = new ArrayList<String>();
    // MUSS GEÄNDERT WERDEN WENN DIE METHODE GETALLCARDS FERTIG IST!!!
    ArrayList<Karteikasten> kasten = new ArrayList<Karteikasten>();

    // teststub:
    Karteikasten foo = new Karteikasten("Kasten 1");
    Karteikasten bar = new Karteikasten("Kasten 2");
    kasten.add(bar);
    kasten.add(foo);
    System.out.println(kasten.size());
    try{
        // here we set the parents and the children
        for (int i = 0; i < kasten.size(); i++) {
            System.out.println("Durchlauf: " + i);
            System.out.println(kasten.get(0).getProgress().get(0).intValue());
            // for each "i" create a new Parent object to set the title and the
            // children
            Parent parent = new Parent();
            parent.setmTitle(kasten.get(i).getName());
            arrayChildren.add("Child " + i);
            parent.setmArrayChildren(arrayChildren);

            ProgressBar pb1 = (ProgressBar) findViewById(R.id.progressBar1);
            pb1.setProgress(kasten.get(i).getProgress().get(0).intValue());

            ProgressBar pb2 = (ProgressBar) findViewById(R.id.progressBar2);
            pb2.setProgress(kasten.get(i).getProgress().get(1).intValue());

            ProgressBar pb3 = (ProgressBar) findViewById(R.id.progressBar3);
            pb3.setProgress(kasten.get(i).getProgress().get(2).intValue());

            ProgressBar pb4 = (ProgressBar) findViewById(R.id.progressBar4);
            pb4.setProgress(kasten.get(i).getProgress().get(3).intValue());

            System.out.println("Kasten: " + kasten.get(i).getName());

            // in this array we add the Parent object. We will use the
            // arrayParents at the setAdapter
            arrayParents.add(parent);
        }
    } catch (Exception e){
        String stackTrace = Log.getStackTraceString(e);
        System.out.println("Fehlermeldung:");
        System.out.println(stackTrace);
    }

    // sets the adapter that provides data to the list.
    mExpandableList.setAdapter(new MyExpandableListAdapter(Lernen.this,
            arrayParents));

}
} 
```

我在该行收到 NullPointerException

```
pb1.setProgress(kasten.get(i).getProgress().get(0).intValue()); 
```

问题可能是，progressBar 位于 layout`list_item_child.xml`中，但该布局不适用于 Activity。

有谁知道如何修理它？

非常感谢！

（抱歉语言不好；））

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:58:37.273

您可以通过定义自己的适配器（从 BaseAdapter 扩展）来设置每一行中的项目，并在那里定义所有样式参数。你可以在这里找到关于这个主题的一个很好的教程：http: [//techdroid.kbeanie.com/2009/07/custom-listview-for-android.html](http://techdroid.kbeanie.com/2009/07/custom-listview-for-android.html)

# ruby - 从字符串的特定部分删除特定字符

> ID：14614401
> 
> 赞同：0
> 
> 时间：2013-01-30T21:45:19.310
> 
> 标签：ruby, string

我将如何从字符串的特定部分删除字符，比如从该字符串的前 200 个字符中`<`删除？`>`如果这些字符出现在 200 个字符标记之后，它们应该保持不变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:01:50.300

非描述性的：

```
text = "foo < bar > baz" * 20
"#{text[0...200].tr("<>", "")}#{text[200..-1]}" 
```

或者，破坏性地：

```
text = "foo < bar > baz" * 20
text[0...200] = text[0...200].tr("<>", "") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:01:34.640

假设您想要做的是用占位符替换`<`and`>`字符，您可以这样做：

```
if original_string.length >= 200
  original_string = original_string[0..199].gsub(/</,"&lt;").gsub(/>/,"&gt;") + original_string[200..-1]
else
  original_string = original_string.gsub(/</,"&lt;").gsub(/>/,"&gt;")
end 
```

您也可以`""`用作替换字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:04:39.883

```
str = "<aaa><bbbbb>ccccccccc<>"
str.prepend(str.slice!(0..10).delete('<>')) 
```

切掉 n 个字符的子串，从不需要的字符中清除它并将其粘回去。

# sql - 如果没有返回数据，如何返回 0 的行？

> ID：14614402
> 
> 赞同：3
> 
> 时间：2013-01-30T21:45:19.717
> 
> 标签：sql, tsql, sql-server-2005

我有一个查询，无论如何我都想显示行。如果返回了一些数据，查询会返回我需要的正确信息，但是在所有行都为空的情况下，我什么也得不到，显然，如果没有，我需要一行返回全 0，而不是什么都没有。

我曾尝试使用`isnull()`and`coalesce()`来解释这一点，但显然我做得不对。以下是我需要为此目的调整的基本查询。

```
SELECT
    Vendor
    ,SUM(TotalAssigned) as 'Total Production Assigned Not Completed'
    ,SUM(AssignedFees) as 'Work in process Fees'
    ,SUM(TotalSubmitted) as 'Total Production Submitted'
    ,SUM(SubmittedFees) as 'Submitted Production Fees'
FROM(
    SELECT
        distinct 
        v.ContactFirstName+' '+v.ContactLastName AS Vendor
        ,oi.orderid, oi.orderitemid
        ,CASE WHEN  oi.QueueID > 0 and oi.lastmilestoneid < 70 THEN 1 ELSE 0 END AS TotalAssigned
        ,CASE WHEN  oi.QueueID > 0 and oi.lastmilestoneid < 70 THEN dbo.GetAdjustedVendorFee(oi.OrderID, oi.OrderItemID) END AS AssignedFees
        ,CASE WHEN oim.MilestoneID = 70 THEN 1 ELSE 0 END AS TotalSubmitted
        ,CASE WHEN oim.MilestoneID = 70 THEN dbo.GetAdjustedVendorFee(oi.OrderID, oi.OrderItemID) END AS SubmittedFees

    FROM
    OrderItems oi
    LEFT JOIN OrderItemMilestones oim ON oim.OrderID = oi.OrderID and oim.OrderItemID = oi.OrderItemID
    LEFT JOIN Vendors v ON v.VendorID = oi.VendorID
    WHERE
    oim.MilestoneDate BETWEEN dbo.TruncateDate(dateadd(dd, -1, Current_Timestamp)) and dbo.TruncateDate(Current_Timestamp)
    and oi.VendorID in (105144) 
    and oi.productid not in (105)
)x

GROUP BY Vendor 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-30T21:59:44.280

一种方法是将表达式包装在 CTE 中，然后`UNION ALL`使用

`UNION ALL SELECT NULL, 0,0,0,0 WHERE NOT EXISTS(SELECT * FROM CTE)`

例如

```
WITH CTE AS 
(SELECT
    Vendor
    ,SUM(TotalAssigned) as 'Total Production Assigned Not Completed'
    ,SUM(AssignedFees) as 'Work in process Fees'
    ,SUM(TotalSubmitted) as 'Total Production Submitted'
    ,SUM(SubmittedFees) as 'Submitted Production Fees'
FROM(
    SELECT
        distinct 
        v.ContactFirstName+' '+v.ContactLastName AS Vendor
        ,oi.orderid, oi.orderitemid
        ,CASE WHEN  oi.QueueID > 0 and oi.lastmilestoneid < 70 THEN 1 ELSE 0 END AS TotalAssigned
        ,CASE WHEN  oi.QueueID > 0 and oi.lastmilestoneid < 70 THEN dbo.GetAdjustedVendorFee(oi.OrderID, oi.OrderItemID) END AS AssignedFees
        ,CASE WHEN oim.MilestoneID = 70 THEN 1 ELSE 0 END AS TotalSubmitted
        ,CASE WHEN oim.MilestoneID = 70 THEN dbo.GetAdjustedVendorFee(oi.OrderID, oi.OrderItemID) END AS SubmittedFees

    FROM
    OrderItems oi
    LEFT JOIN OrderItemMilestones oim ON oim.OrderID = oi.OrderID and oim.OrderItemID = oi.OrderItemID
    LEFT JOIN Vendors v ON v.VendorID = oi.VendorID
    WHERE
    oim.MilestoneDate BETWEEN dbo.TruncateDate(dateadd(dd, -1, Current_Timestamp)) and dbo.TruncateDate(Current_Timestamp)
    and oi.VendorID in (105144) 
    and oi.productid not in (105)
)x

GROUP BY Vendor)
SELECT * FROM CTE
UNION ALL SELECT NULL, 0,0,0,0  WHERE NOT EXISTS(SELECT * FROM CTE) 
```

这是一个使用不太复杂的语句[的演示](http://sqlfiddle.com/#!6/189a3/1000)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:30:57.973

另一种方法可能是将查询作为派生表无条件地连接到一行默认值，并使用 ISNULL 或 COALESCE 从子查询返回数据或回退到默认值：

```
SELECT
     ISNULL(sub.Vendor                                   , def.Vendor                                   ) AS Vendor
    ,ISNULL(sub.[Total Production Assigned Not Completed], def.[Total Production Assigned Not Completed]) AS 'Total Production Assigned Not Completed'
    ,ISNULL(sub.[Work in process Fees]                   , def.[Work in process Fees]                   ) AS 'Work in process Fees'
    ,ISNULL(sub.[Total Production Submitted]             , def.[Total Production Submitted]             ) AS 'Total Production Submitted'
    ,ISNULL(sub.[Submitted Production Fees]              , def.[Submitted Production Fees]              ) AS 'Submitted Production Fees'
FROM (
    SELECT
        '' AS Vendor
        ,0 AS 'Total Production Assigned Not Completed'
        ,0 AS 'Work in process Fees'
        ,0 AS 'Total Production Submitted'
        ,0 AS 'Submitted Production Fees'
) def
LEFT JOIN (
    *your query*
) sub
ON 1=1  -- unconditionally; almost the same as CROSS JOIN
; 
```

这几乎就像一个交叉连接，但与后者不同的是，它保证返回一个非空数据集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T09:27:07.277

这可能是一个更简单的解决方案（@AndriyM 的混音）：

```
SELECT
    Vendor
    ,SUM(TotalAssigned) as 'Total Production Assigned Not Completed'
    ,SUM(AssignedFees) as 'Work in process Fees'
    ,SUM(TotalSubmitted) as 'Total Production Submitted'
    ,SUM(SubmittedFees) as 'Submitted Production Fees'
FROM (
    SELECT
        distinct 
        v.ContactFirstName+' '+v.ContactLastName AS Vendor
        ,oi.orderid, oi.orderitemid
        ,CASE WHEN  oi.QueueID > 0 and oi.lastmilestoneid < 70 THEN 1 ELSE 0 END AS TotalAssigned
        ,CASE WHEN  oi.QueueID > 0 and oi.lastmilestoneid < 70 THEN dbo.GetAdjustedVendorFee(oi.OrderID, oi.OrderItemID) END AS AssignedFees
        ,CASE WHEN oim.MilestoneID = 70 THEN 1 ELSE 0 END AS TotalSubmitted
        ,CASE WHEN oim.MilestoneID = 70 THEN dbo.GetAdjustedVendorFee(oi.OrderID, oi.OrderItemID) END AS SubmittedFees

    FROM
    OrderItems oi
    LEFT JOIN OrderItemMilestones oim ON oim.OrderID = oi.OrderID and oim.OrderItemID = oi.OrderItemID
    LEFT JOIN Vendors v ON v.VendorID = oi.VendorID
    WHERE
    oim.MilestoneDate BETWEEN dbo.TruncateDate(dateadd(dd, -1, Current_Timestamp)) and dbo.TruncateDate(Current_Timestamp)
    and oi.VendorID in (105144) 
    and oi.productid not in (105)
) x RIGHT JOIN (SELECT 1 as ONE) T ON 1=1
GROUP BY Vendor 
```

**sqlfiddle**：[http ://sqlfiddle.com/#!6/189a3/1024](http://sqlfiddle.com/#!6/189a3/1024)

# node.js - NodeJS 连接到 paradox 数据库

> ID：14614403
> 
> 赞同：1
> 
> 时间：2013-01-30T21:45:28.727
> 
> 标签：node.js, paradox

有谁知道是否有任何方法可以在 windows 上使用 node.js 连接到 paradox 数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T01:15:48.563

对于在 Windows 上运行的节点，您需要一个 ODBC 驱动程序。[这个问题](https://stackoverflow.com/questions/13017024/libraries-for-connecting-node-js-to-odbc-on-windows?rq=1)可能会有所帮助。

# grails - 如何将 Spring Security Core 插件与 Neo4j GORM 插件一起使用

> ID：14614408
> 
> 赞同：0
> 
> 时间：2013-01-30T21:45:48.280
> 
> 标签：grails, spring-security, neo4j

我正在尝试使用 Neo4j GORM 插件在 Grails 项目中使用 Spring Security Core 插件。

据我所知，我有两个选择：

1.  按原样使用 Spring Security Core 插件并将其数据持久化为 MySQL，同时将 Neo4j 用于其余应用程序数据。

2.  使用自定义 UserDetailsS​​ervice。

有人有后者的例子吗？

pjdv

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T09:19:48.350

由于 Neo4j 插件与 GORM 兼容，因此 spring-security-core 的 GormUserDetailsS​​ervice 应该可以开箱即用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:33:54.417

你的意思是像文档中的那个？[http://grails-plugins.github.com/grails-spring-security-core/docs/manual/guide/11%20Custom%20UserDetailsS​​ervice.html](http://grails-plugins.github.com/grails-spring-security-core/docs/manual/guide/11%20Custom%20UserDetailsService.html)

# java - java中的静态概念

> ID：14614409
> 
> 赞同：2
> 
> 时间：2013-01-30T21:46:01.540
> 
> 标签：java, variables, object, interface, static

我似乎无法理解**静态**关键字（java）所以我用谷歌搜索并查看了这个网站上的一个[帖子](https://stackoverflow.com/questions/413898/what-does-the-static-keyword-do-in-java)，虽然我确信答案是决定性和明确的 - 它总是在这里 - 我似乎没有理解它有两个原因；我不是以英语为母语的人，这门语言对我来说有点模糊，而且它缺乏在类、类实例、接口（如果可能）、接口和变量实例、列表和数组等方面的使用示例。我真的很感激任何帮助，请让英语尽可能简单；）谢谢 Aditsan

**编者注：**请注意，原始发帖人是在询问示例，并且在您提供答案时不是以英语为母语的人。从评论来看，OP 似乎对这个概念的理解还不够好，无法询问那些还没有意义的部分，所以例子会很棒！可能需要额外的细节和多种*不同*的解释才能找到最有效的答案组合。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T22:12:20.267

我认为这有助于理解*非静态的*含义，即没有关键字声明的字段/方法/ `static`...。

没有关键字 static 声明的每个字段都*作为对象的一部分*存在。如果您有两个对象，则这两个对象中的每一个都有一个内容可能不同的字段：

```
class X {
 int f;
}

X x1 = new X();
X x2 = new X();
x1.f = 5;
x2.f = 10;
// x1.f still is 5 
```

但是，静态字段不是每个对象存在的，而是每个类存在的。`g`因此，在以下示例中，无论您拥有多少（如果有！）类对象，都只有一个字段`Y`：

```
class Y {
  static int g;
}

Y y1 = new Y();
Y y2 = new Y();
y1.g = 5;
y2.g = 10;
// y1.g is 10, because y1.g and y2.g mean the exact same thing 
```

我个人认为对静态字段的访问应该使用类（`Y.g`）而不是提及对象实例（`y1.g`），这样没有任何对象实例的存在就更明确了。

对于方法，不同之处在于非静态方法与对象实例相关联，可以`this`在方法内部进行访问。调用声明的方法时，`void m()`您可以访问调用它的对象的非静态（和静态）字段（因此，`x1.m()`从上面的示例中，您可以访问包含 5 的字段，因为`x2.m()`您可以访问包含 10 的字段。

然而，静态方法可以在没有（相应的？）对象的情况下被调用。如果声明`static void n()`在 class 内部，您可以使用or`Y`调用此方法（如果是 instanceof ，如上）。在这里，我也更喜欢第一种写下来的方式。因为在静态方法中您没有对*对象*实例的引用（在非静态方法中命名），所以您无法从静态方法内部访问特定的非静态字段 - 仅仅是因为与特定对象没有明确的关联.`Y.n()``y1.n()``y1``Y`*`this`*

 *关于`static`和类定义：这是相当先进的。您可以在另一个类中声明一个类。如果内部类不是静态的，则内部类的每个对象实例也都有对外部类实例的引用（这也意味着只有在有外部类的实例时才能创建内部类的实例）。这并不总是你想要的。通过声明内部类`static`，它只是存在并且可以或多或少地像在自己的文件中定义的类一样使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:55:40.220

基本上，静态暗示/提供两件事：

1）整个系统（JVM）中只存在一个“项目”的实例 2）静态“项目”也是上下文/状态无关的

解释上面的（1）：假设你有一个 Meal Token 发行者。无论系统中有多少用户/进程，所有令牌都必须由单个“事物”发行。你会把那个“东西”发展成静态的。然后你会决定那个“东西”是什么。它可能是一个执行复杂操作并实现复杂业务规则的类。然后，您将有一个静态类以“单一统一的方式”为整个系统发布令牌。有时，重要的是令牌应该是“静态的”，但它的发行方式可能是非静态的。然后，您只需实现一个“静态”令牌计数器。

解释（2）：按照上面（1）的说法，您可以很容易地看到为什么静态“事物”以与上下文无关的方式运行很重要。也就是说，他们不知道是谁打电话给他们或出于什么目的。当他们被调用时，他们不会从过去借任何东西，他们需要当前调用者的所有输入，他们只是做他们的工作，对未来什么都不记得。*

# xml - 将字符串转换为节点集

> ID：14614410
> 
> 赞同：1
> 
> 时间：2013-01-30T21:46:03.820
> 
> 标签：xml, xslt, jstl

在我的 xsl 文件中，我收到一个单独的 xml 文档（在我正在转换的主 xml 文档旁边）作为字符串参数（param）

说我的参数名称是 seconddoc

```
<xsl:param name="seconddoc"></xsl:param> 
```

并且参数值如下（再次，我将整个内容作为字符串）

```
<products>
    <product>
        <id>1</id>
        <name>pro-1</name>
    </product>
    <product>
        <id>2</id>
        <name>pro-2</name>
    </product>
    <product>
        <id>3</id>
        <name>pro-3</name>
    </product>
</products> 
```

我可以打印整个字符串如下

```
<xsl:value-of select="$seconddoc" /> 
```

但我想迭代数据（字符串）而不是一次获取整个值。我的最终目标是将此数据加载到选择选项中。

我是这样累的：

```
<select>
    <xsl:for-each select="$seconddoc/products/product">
        <option value="{id}">
            <xsl:value-of select="name" /></option>
    </xsl:for-each>
</select> 
```

但我得到了 TransformerException。“从 'java.lang.String' 到 'node-set' 的无效转换。

更新：

这就是我在我的jsp页面中的内容

```
<x:transform xml="${mainxmldoc}" xslt="${xslt}">
<x:param name="seconddoc" value="<%=xmlString %>"/>
</x:transform> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T06:25:51.293

您可能正在使用 JDK 附带的内置 XSLT 1.0 处理器，它是 Xalan 的一个版本。在 XSLT 1.0 或 2.0 中都没有调用 XML 解析器的标准方法（这是将字符串转换为节点所需的操作）。您要么需要在转换之外进行转换（将节点作为参数传递），要么使用完成这项工作的扩展。我似乎记得 Xalan 的 exslt:node-set() 实现可能会这样做；一探究竟。或者，由于您身处 Java 世界，如果您升级到 XSLT 2.0（意思是 Saxon），很多事情都会变得容易得多。不过，我不确定 Saxon 与 JSP 的配合如何（当然可以，但我不知道您是否可以使用 x:transform 标记库）。Saxon 有一个 saxon:parse 扩展功能，在草案 3.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T17:39:31.540

看起来参数无法转换为节点集。但变量可以！所以我解决它的方式。

首先，声明一个变量，并将参数值放入变量中。然后将变量转换为节点集。现在我们可以迭代节点集

这是完整的代码

```
<xsl:variable name="stringVar">
        <xsl:value-of select="$seconddoc" />
    </xsl:variable>

    <xsl:template match="/">
        <xsl:for-each select="exslt:node-set($stringVar)/node()">
            <select>
                <xsl:for-each select="/products/product">
                    <option value="{id}">
                        <xsl:value-of select="name" />
                    </option>

                </xsl:for-each>
            </select>
        </xsl:for-each>
    </xsl:template> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T03:24:19.920

使用`<x:parse>`标签，您可以通过以下方式处理您的内容：

```
<x:parse var="doc">
    <products>
        <product>
            <id>1</id>
            <name>pro-1</name>
        </product>
        <product>
            <id>2</id>
            <name>pro-2</name>
        </product>
        <product>
            <id>3</id>
            <name>pro-3</name>
        </product>
    </products>
</x:parse> 
```

然后使用 XPath 定位所需的节点：

```
<x:out select="$doc/products/product/..." /> 
```

# javascript - 在构建过程中将代码包装在自定义闭包中

> ID：14614413
> 
> 赞同：9
> 
> 时间：2013-01-30T21:46:17.033
> 
> 标签：javascript, build, gruntjs

我想在使用 Grunt（和 uglify）的构建过程中将我的代码包装在自定义类型的 Closure 中。这种操作必须保持 sourceMap 正常工作。

我的用例是将我的所有代码包装在一个`try/catch`块中，以允许记录生产中的错误 - 而不会失去对堆栈跟踪的访问（与 不同`window.onerror`）。我可能会使用 Raven-js 1.0 来解决这个问题。

任何人都知道我可以如何轻松地管理这个？

*如果您只是有可能带来完整答案的提示，那也将被接受*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T20:30:12.807

最后，我找到了一个 grunt 插件 ( [grunt-wrap](https://github.com/chrissrogers/grunt-wrap) ) 正是这样做的：

```
 wrap: {
    modules: {
      src: ['assets/*.js'],
      dest: 'dist/',
      wrapper: ['try {', '} catch(e) { Raven.captureException(e); }']
    }
  } 
```

如果您对`raven-js`. 我已经`try/catch`结束了，`Raven.context`因为这不会围绕代码创建一个新的全局闭包。

# ssh - 通过 SSH 传输文件，然后附加到另一个文件

> ID：14614415
> 
> 赞同：0
> 
> 时间：2013-01-30T21:46:19.817
> 
> 标签：ssh, scp

我正在尝试自动化一个脚本，该脚本将文件从我的本地服务器复制到命令行上的远程服务器。我已经对 scp 进行了研究，并且知道如何将文件复制到远程服务器，但是我想将该文件附加到另一个文件。

这是我的代码：

```
scp ~/file.txt user@host:
ssh user@host cat file.txt >> other_file.txt 
```

当我手动将所有内容输入命令行时，一切正常：

```
scp ~/file.txt user@host:
ssh user@host
cat file.txt >> other_file.txt 
```

但是当我运行脚本时，只有文件被复制，而不是附加到 other_file.txt 的末尾。帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:54:10.130

您的代码的第二行应该是

```
ssh user@host "cat file.txt >> other_file.txt" 
```

三个重点：

1.  你不希望你的*本地*shell 以`>>`任何方式解释（如果它没有被引用，它会这样做）
2.  有*一个*远程 shell 可以`>>`正确解释命令。
3.  的最终参数`ssh`“加入”以形成命令，而不是按原样携带到`argv`数组中。这可能很方便，但也可能导致混淆或错误：`ssh cat "$MYFILE"`两者`ssh "cat '$MYFILE'"`都在一个常见*的*用例中*工作*，但它们*都*因.*`$MYFILE`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T21:54:20.567

您需要将要在远程主机上运行的命令括在引号中。否则，重定向是在本地而不是远程完成的。试试这个：

```
scp ~/file.txt user@host:
ssh user@host 'cat file.txt >> other_file.txt' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T21:54:50.790

尝试这个：

```
 $ cat file.txt| ssh hostname 'cat >> other_file.txt' 
```*

# javascript - 如何发现触发事件的 DOM 元素并做出相应的行为

> ID：14614416
> 
> 赞同：1
> 
> 时间：2013-01-30T21:46:23.630
> 
> 标签：javascript, jquery, dom, javascript-events

我正在尝试将多个标签（或任何其他标签）绑定到同一个处理程序。我希望处理程序发现单击了哪个标签并做出相应的行为。

例子：

```
<a class="menu">Item1<a>
<a class="menu">Item2<a>
<a class="menu">Item3<a>

$(".menu").click(function(){
    //...Find out which a was clicked...
    ($(a .menu).html()=='Item1)

} 
```

这样做的最佳方法是什么？我希望它的行为类似于 Apache 的 VirtualHosts 部分。甚至有可能做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T21:47:55.740

使用 jQuery `$(this)`：

```
$(".menu").click(function(){
    $(this).html('Item1');
} 
```

这是与[jQuery 的区别：'$(this)' 和 'this' 之间有什么区别？](https://stackoverflow.com/questions/1051782/jquery-this-vs-this)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T21:47:44.740

关键字将`this`是触发事件的元素：

```
$(".menu").click(function(){
    var clickedItem = this;
    alert(clickedItem.innerHTML);
} 
```

如果您愿意，可以将其包装在 jQuery 对象中：

```
$(".menu").click(function(){
    var clickedItem = $(this);
    if (clickedItem.text() === 'Item1') {
        alert('It was item 1');
    }
} 
```

# jira - 显示问题在 JIRA 中重新打开的频率

> ID：14614426
> 
> 赞同：4
> 
> 时间：2013-01-30T21:46:52.213
> 
> 标签：jira, jira-plugin

我目前正在运行一个相当开箱即用的 JIRA 设置，它是实时的并且正在使用。

现在，我希望在每个错误中都有一个自定义字段，该字段将显示总次数和问题/错误已重新打开。

有一个插件（[https://answers.atlassian.com/questions/19665/how-to-count-based-on-status-jira](https://answers.atlassian.com/questions/19665/how-to-count-based-on-status-jira)）可以做类似的事情，但是，我正在寻找一个不需要购买第三方插件（OPS 不喜欢插件）。

我搜索了高低的论坛，甚至找不到一个好的起点。您的帮助总是值得赞赏的。提前致谢！

编辑：当前 JIRA 版本：5.2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T17:23:24.420

创建一个自定义字段来计算问题打开的次数，并将其默认值设置为 1。然后使用[行为插件](https://marketplace.atlassian.com/plugins/com.onresolve.jira.plugin.Behaviours/version/333)将验证脚本添加到您希望计算的转换中。在验证脚本中，增加自定义字段并返回 true。应该是这样的：

```
FormField formComponent = getFieldById(fieldChanged)
FormField formUserField = getFieldByName("UserFieldA"
formUserField.setFormValue(Integer.valueOf(formUserField.getFormValue()) + 1) 
```

如果您在编码时遇到问题，请查看[此处](https://studio.plugins.atlassian.com/wiki/display/JBHV/JIRA+Behaviours+Plugin)或询问此处。

[一种更简单的方法是使用Jira Scripting Suite](https://marketplace.atlassian.com/plugins/com.quisapps.jira.jss)攻击重新打开转换的后功能， 并使用它来增加字段，但它还不支持 Jira 5.2。

如果您不想使用任何插件，则可以使用附加到重新打开工作流转换的[Webhooks](https://developer.atlassian.com/display/JIRADEV/JIRA+Webhooks+Overview)，该转换将发布到 URL，而 URL 又将使用[REST API](https://www.google.co.il/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CC0QFjAA&url=http://docs.atlassian.com/jira/REST/latest/&ei=6_kLUf-SLPSr0AXArYDgBg&usg=AFQjCNFO9TLzBRkYaY5zpUnl07QPjFgC7w&sig2=2ih3QFMKE5glpq5HZ20TXA&bvm=bv.41867550,d.d2k)连接回来并增加该字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T10:27:46.303

自[定义字段](https://confluence.atlassian.com/display/JIRA/Configuring+Fields+and+Screens)包含一些信息（指标、计数器、杂项信息等），但它本身不是逻辑。所以这里的问题是，为了增加一个（自定义）字段，你必须有一些逻辑来做这件事。所以你有三个选择：

1.  使用您正在谈论的插件
2.  为此定制一个插件
3.  使用自定义构建的外部应用程序，该应用程序利用[REST API](http://docs.atlassian.com/jira/REST/latest/)轮询有关问题的更改以及何时检测到“重新打开”并增加自定义字段的值。
4.  手动分配此字段（不是真正的选项）

所以最后没有那么多不需要资源的选项 - 开发或购买一些插件。通常最好购买插件，因为您还购买了支持。但是请注意，如果该插件不是由 Atlassian 开发的，则它可能不支持未来的 JIRA 版本，或者在新的 JIRA 版本发布后可能不兼容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-31T10:16:33.573

我的解决方案是使用以下代码将后功能添加到“重新打开”转换（假设您已安装并启用了[Script Runner](https://marketplace.atlassian.com/plugins/com.onresolve.jira.groovy.groovyrunner/)插件；您还必须将自定义字段“重新打开计数”添加到相应的视图屏幕）：

```
import com.atlassian.jira.ComponentManager
import com.atlassian.jira.issue.CustomFieldManager
import com.atlassian.jira.issue.util.DefaultIssueChangeHolder
import com.atlassian.jira.issue.ModifiedValue

def componentManager = ComponentManager.getInstance()
def customFieldManager = componentManager.getCustomFieldManager() 
def reopenCount = customFieldManager.getCustomFieldObjects(issue).find {it.name == 'Reopen count'}
def changeHolder = new DefaultIssueChangeHolder();
def reopenCountValue = issue.getCustomFieldValue(reopenCount)
if(reopenCountValue == null) reopenCountValue = 0.0d
reopenCount.updateValue(
    null, 
    issue, 
    new ModifiedValue(
        reopenCountValue, 
        ++reopenCountValue
    ), 
    changeHolder
); 
```

# iphone - UIImagePickerControllerCameraDeviceFront 每隔一段时间工作一次

> ID：14614428
> 
> 赞同：1
> 
> 时间：2013-01-30T21:46:58.737
> 
> 标签：iphone, ios, uiimagepickercontroller

这个问题与此处提出的现有问题非常相似[UIImagePickerControllerCameraDeviceFront 仅在我尝试提出的解决方案时每隔一次才有效](https://stackoverflow.com/questions/10967139/uiimagepickercontrollercameradevicefront-only-works-every-other-time)，但它对我不起作用

我有一个最简单的项目，有两个视图控制器。在蓝色中，我正在显示一个带有 UIImagePickerController 的小型 UIView。注意：启动应用程序时，我正在显示前置摄像头。

我点击下一个按钮并转到橙色视图控制器，当我点击后退按钮并返回蓝色视图控制器时，UIImagePickerController 从前翻转到后。我想原因是它认为它很忙并移动到后凸轮。如果我继续在视图控制器之间来回移动，相机会不断地前后翻转……

这是我的代码和屏幕截图，我做错了什么？

在我的 *.h

```
#import <UIKit/UIKit.h>

@interface v1ViewController : UIViewController <UIImagePickerControllerDelegate>
{
    UIImagePickerController *picpicker;
    UIView *controllerView;

}

@property (nonatomic, retain) UIImagePickerController *picpicker;
@property (nonatomic, retain) UIView *controllerView;

@end 
```

在我的 *.m 文件中（此代码仅在显示蓝色视图控制器时使用）

```
#import "v1ViewController.h"
#import <MobileCoreServices/UTCoreTypes.h>

@implementation v1ViewController

@synthesize picpicker;
@synthesize controllerView;

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];

    picpicker = [[UIImagePickerController alloc] init];

    picpicker.delegate = self;
    picpicker.mediaTypes = [NSArray arrayWithObjects:(NSString *)kUTTypeImage, nil];
    picpicker.sourceType = UIImagePickerControllerSourceTypeCamera;
    picpicker.cameraDevice = UIImagePickerControllerCameraDeviceFront;
    picpicker.cameraCaptureMode = UIImagePickerControllerCameraCaptureModePhoto;
    picpicker.showsCameraControls = NO;
    picpicker.navigationBarHidden = NO;
    picpicker.wantsFullScreenLayout = NO;

    controllerView = picpicker.view;
    [controllerView setFrame:CGRectMake(35, 31, 250, 250)];

    controllerView.alpha = 0.0;
    controllerView.transform = CGAffineTransformMakeScale(1.0, 1.0);

    [self.view addSubview:controllerView];

    [UIView animateWithDuration:0.3
                          delay:0.0
                        options:UIViewAnimationOptionCurveLinear
                     animations:^{
                         controllerView.alpha = 1.0;
                     }
                     completion:nil
     ];

}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];

    [picpicker dismissModalViewControllerAnimated:YES];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];

    [picpicker dismissModalViewControllerAnimated:YES];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
    } else {
        return YES;
    }
}

@end 
```

![在此处输入图像描述](../Images/d7629e2ef78289a8d833ad9093cd050a.png)

![在此处输入图像描述](../Images/cafb1e7c2f9a72491b12f26280c08300.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T09:02:23.747

尽管我现在没有可用的带摄像头的设备来验证这一点，但您似乎没有正确关闭pickerview 控制器。该文档指出，您应该调用`dismissModalViewControllerAnimated:`父**控制器**以关闭选择器（尽管，对呈现控制器的调用将传播给演示者 - 所以这不是问题），**但**在您的情况下，您没有以模态方式显示控制器第一个地方，所以它不会工作。

在这种情况下，我会尝试`release`使用选择器（如果不在 ARC 下）并将其设置为`nil`（而不是调用`[picpicker dismissModalViewControllerAnimated:YES];`）。

**PS。**实际上，您的设计似乎存在更大的问题。由于每个按钮都设置为以模态方式呈现另一方，因此**您永远不会关闭任何控制器**。控制器只是相互堆叠。您应该考虑将它们嵌入导航控制器并让它处理层次结构，或者只是将`dismissModalViewControllerAnimated:`（`dismissViewControllerAnimated:completion:`在 iOS5+ 上）设置为第二个控制器按钮的操作，而不是模态 segue。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T23:31:58.720

您正在 viewDidDisappear 和 viewWillDisappear 方法中关闭控制器。这可能是您的问题的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T11:59:33.767

这是一个非常简单的问题。我不知道为什么会发生这种情况，但似乎 UIImagePickerController 被设计为在每次需要时重新创建，而不是保留对它的任何引用，如果你仔细想想，这似乎是合乎逻辑的。基本上，您每次都需要重新创建和重新配置您的选择器。下面我粘贴了一些代码来说明我的意思。

简单的解决方案：

```
- (UIImagePickerController *)loadImagePicker {
    UIImagePickerController *picpicker = [[UIImagePickerController alloc] init];
    picpicker.delegate = self;
    picpicker.mediaTypes = [NSArray arrayWithObjects:(NSString *)kUTTypeImage, nil];
    picpicker.sourceType = UIImagePickerControllerSourceTypeCamera;
    picpicker.cameraDevice = UIImagePickerControllerCameraDeviceFront;
    picpicker.cameraCaptureMode = UIImagePickerControllerCameraCaptureModePhoto;
    picpicker.showsCameraControls = NO;
    picpicker.navigationBarHidden = NO;
    picpicker.wantsFullScreenLayout = NO;
    return picpicker;
} 
```

并在：

```
-(void)viewWillAppear:(BOOL)animated{
    if(!self.picpicker){
        self.picpicker = [self loadImagePicker];
        [self.view addSubview: self.picpicker];
    }
}

-(void)viewWillDisappear:(BOOL)animated {
     [super viewWillDisappear:animated];
     [self.picpicker removeFromSuperview];
     self.picpicker = nil;
} 
```

# r - 子集列表（为所有组件选择匹配值）

> ID：14614434
> 
> 赞同：2
> 
> 时间：2013-01-30T21:47:19.843
> 
> 标签：r, list

我尝试以某种方式从列表中读出某些元素，这相当于`df[, c(1,4,5)]`在`data.frame`.

```
> obj <- list(c(1:5), c(1:5))
> obj
[[1]]
[1] 1 2 3 4 5

[[2]]
[1] 1 2 3 4 5 
```

我正在寻找这样的结果

```
[[1]]
[1] 1 4 5

[[2]]
[1] 1 4 5 
```

我一直在尝试`[]`，`[[]]`但那`[[]][]`是在评估列表组件。我也一直在尝试`lapply(obj, c(1,4,5))`和查看`match()`。

我还没有到那里，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:56:54.893

您应该使用在每个列表条目上运行的函数调用 lapply：

```
obj <- list(c(1:5), c(1:5))
lapply(obj, function(x) x[c(1, 4, 5)])
#[[1]]
[1] 1 4 5

[[2]]
[1] 1 4 5 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:17:56.003

EDi 有一个很好的答案，但是您可以通过将`[`函数传递给`lapply`plus 其他参数来做到这一点：

```
lapply(obj, '[', c(1, 4, 5)) 
```

您可以通过引用它们来访问 R 中的这个和其他“奇怪”函数：

```
?"[" 
```

# eclipse - 带面板的双显示器上的 Aptana

> ID：14614440
> 
> 赞同：1
> 
> 时间：2013-01-30T21:47:38.817
> 
> 标签：eclipse, ide, aptana, panels

在 Eclipse 中，我可以取消停靠面板并将其移动到我的另一台显示器（便于同时比较两个页面。但是，在 Aptana 中，我可以拆分窗口，但它不会让我拉出面板到我的另一台显示器。我可以安装一个插件来允许我这样做吗？

**更新**

我有 Aptana 3.3.1，我可以很好地分离面板（例如控制台面板），但我希望能够获取编辑器中的文件，并将其移动到我的另一个屏幕。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T06:41:48.097

单击*窗口-> 新窗口*。然后，您可以关闭新窗口中所有不需要的面板，将其拖到第二个屏幕上，然后将编辑器放在那里。希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T23:46:14.567

您使用的是什么版本的 Aptana？在我的 3.3.1 中，我可以通过右键单击面板名称并选择“已分离”或将其拖离主窗口来分离面板并将其拖到第二个屏幕。

# python - 在 Celery 任务队列中，组中运行的任务与循环中的多个异步有什么不同？

> ID：14614441
> 
> 赞同：3
> 
> 时间：2013-01-30T21:47:41.310
> 
> 标签：python, celery, task-queue

假设我有一个非常简单的任务，如下所示：

```
@celery.task(ignore_result=True)
def print_page(page):
    with open('path/to/page','w') as f:
        f.write(page) 
```

（请忽略上述代码中潜在的竞争条件......这是一个简化的例子）

我的问题是以下两个代码示例是否会产生相同的结果，或者一个是否比另一个更好：

选项A：

```
@celery.task(ignore_result=True)
def print_pages(page_generator):
    for page in page_generator:
        print_page.s(page).apply_async() 
```

选项 B：

```
@celery.task(ignore_result=True)
def print_pages(page_generator):
    g = group(print_page.s(page) for page in page_generator)
    g.apply_async() 
```

总的来说，我很好奇以上是否是做我正在做的事情的正确方法。本质上，我还有另一个任务是解析一些数据并返回一个生成器，该生成器将发出文档的所有页面。对于每一页，我想分别输出。

所以，我的链看起来像这样（也简化了）：

```
chain = fetch.s(url) | parse.s() | print_pages.s()
chain() 
```

我认为如果我能以某种方式在该链内和那里的组（在实际任务之外）发出生成器，那将更有意义。但我不确定这是否实用或理想。我真的很感激任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T23:36:55.530

您的第一个选择似乎更好。您不想加入扇出 print_pages 任务的结果（假设 ignore_result=True），因此组会增加不必要的开销/复杂性。只需像选项 A 中那样单独调用任务，就可以了。

此外，我想指出 Python 生成器不会腌制，因此您不能将它们异步传递给 Celery 任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:00:37.307

在您的情况下，这两种解决方案都是正确的，没有依赖于页面任务，但是假设您有一个任务分为子任务，并且所有这些子任务都是按顺序排列的，在这种情况下，您应该通过选择 B 对其进行分组

# c# - 是否可以在类成员函数中使用 switch 语句并获取访问器？

> ID：14614442
> 
> 赞同：1
> 
> 时间：2013-01-30T21:47:41.370
> 
> 标签：c#, class, function, get, switch-statement

这是类（放松，这只是一个示例，不用于具体使用）：

```
public class Sample
{
    public Sample()
    {
    }

    public string Size
    {
        get
        {
            switch (index)
            {
                case 0: return 100;
                        break;
                case 1: return 500;
                        break;
                case 2: return 1000;
                        break;
                ...
            }
        }
    }
} 
```

我在 break 关键字上收到“检测到无法访问的代码”错误。甚至可以在类或类成员函数中编写 switch 语句吗？或者，我是否坚持使用 if-else 块？

**根据下面的反馈，我发现我犯了一个愚蠢的错误，在休息之前返回**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-30T21:49:19.080

“无法访问的代码”警告是因为您的`break`语句紧跟在`return`语句之后。因此，`break`永远不会执行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T21:52:46.153

您在 上获得了无法访问的代码，`break`因为该代码无法访问。`return`确保了这一点。您可以删除这些`break`语句，一切都应该正常。

您可以通过以下两种方式之一重写开关：

```
switch(index)
{
  case 0: return 100;
  case 1: return 500;
  case 2: return 1000;
} 
```

或者

```
int value = 0;
switch(index)
{
   case 0:
     value = 100;
     break;
   case 1:
     value = 500;
     break;
   case 2:
     value = 1000;
     break;
}
return value; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T21:50:45.953

您可以使用变量来保存您的号码，切换后，您返回变量。

```
public class Sample
{
    public Sample()
    {

    }

    public string Size
    {
        get
        {
            int num=0;
            switch (index)
            {
                case 0: num= 100;
                    break;
                case 1: num= 500;
                    break;
                case 2: num= 1000;
                    break;
            }
            return num;
        }
    }
} 
```

# javascript - 原型继承，setTimeout 和 clearTimeout

> ID：14614443
> 
> 赞同：3
> 
> 时间：2013-01-30T21:47:42.210
> 
> 标签：javascript

我很困惑。

我正在创建 2 个共享相同原型的对象，但是当第二个对象触发该`run()`方法时，我希望它停止在共享继承对象`timer`( `Foo.prototype.timer`) 上设置的超时。

如果我将所有内容更改为使用全局变量而不是`Foo.prototype.timer`，则此方法有效..

如果两个对象共享相同，为什么不清除`Foo.prototype.timer`？

```
function Foo(){
    // generate a random ID to show which object we're on
    this.id = Math.floor(Math.random() * 1000) + 2;
}

Foo.prototype = {
    run : function(){
        var that = this,
            count = 0;

        this.stop();
        function calc(){
            console.log(that.id);
            if( count++ < 20 )
                that.timer = setTimeout( calc, 100 );
        }

        that.timer = setTimeout( calc, 200 );
    },
    stop : function(){
       clearTimeout(this.timer);
    }
}

// initiating

var foo = new Foo();
foo.run();

var bar = new Foo();
bar.run(); 
```

*（请在控制台中复制并运行此代码以查看此问题。）*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:59:05.237

> 我如何不让它独一无二？我认为独特的东西只位于 Foo() 本身

你声明的任何东西`this`对于实例都是唯一的，即使是在原型中声明的。共享的是原型*而不是*每个对象的属性。

尝试使用模块而不是全局变量，这样您仍然可以将变量设为私有但共享：

```
var Foo = (function FooClass() {

  var timer;

  function Foo() {
    ...
  }

  Foo.prototype = {
    ...
  };

  return Foo;

}()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:10:04.537

使用`that.timer`，您不会分配给原型 -`that`是实例，因此将在那里创建一个新属性。要在原型上设置属性，您需要明确地进行：

```
Foo.prototype.timer = setTimeout( calc, 200 ); // or, more verbose:
Object.getPrototypeOf(that).timer = setTimeout( calc, 200 ); 
```

# .net - 如何正则表达式过滤子字符串阈值上的字符串？

> ID：14614445
> 
> 赞同：1
> 
> 时间：2013-01-30T21:47:44.753
> 
> 标签：.net, regex

我想知道如何根据不匹配超过 2 个预定义子字符串来过滤文本字段。例如，如果一个字符串包含与两个以上子字符串的匹配项：tion sia ier iest ent 然后拒绝它。

但如果我尝试

```
(tion|exal|ta|iest|ent){,2} 
```

那么它似乎不匹配应该像'exalt'或'cow'这样的东西，它应该匹配这些而不是'exaltation'。大小写并不重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:56:50.823

这将匹配您要拒绝的字符串（而不是您不匹配的字符串）：

`.*((tion|exal|ta|iest|ent).*){3}`

它在 Java 和 Ruby 中对我有用。您的结果可能会有所不同。

# maven - 如何禁用 maven-compiler-plugin？

> ID：14614446
> 
> 赞同：28
> 
> 时间：2013-01-30T21:47:46.430
> 
> 标签：maven, maven-compiler-plugin

我有一个使用 aspectj-compiler-plugin 的 maven 项目。我使用类型间声明，因此在我的 Java 代码中有对 Aspect 代码的引用。因此，maven-compiler-plugin 无法编译，因为它不编译方面代码。

我的问题是：如何禁用 maven-compiler-plugin 运行，因为它没有做任何有用的事情？

有几种方法可以编译这个项目，但它们不是最理想的：

1.  将排除过滤器添加到 maven-compiler-plugin。该插件仍将运行，但不会尝试编译任何内容。问题是这会破坏 Eclipse 中的 ajdt 项目配置器
2.  将所有 java 代码移动到 aspectj 文件夹。这也感觉不对。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-31T01:54:33.263

您可以通过将插件的阶段设置为无来禁用插件。

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <executions>
                <execution>
                    <id>default-compile</id>
                    <phase>none</phase>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-05-02T01:32:00.060

在 Maven 3 中，以下将执行此操作，例如禁用 clean 插件：

```
 <build>
      <plugins>
         <plugin>
            <artifactId>maven-clean-plugin</artifactId>
            <version>2.4.1</version>
            <executions>
               <execution>
                  <id>default-clean</id>
                  <phase>none</phase>
               </execution>
            </executions>
         </plugin>
      </plugins>
   </build> 
```

相同的技术可用于在 super-POM、包装类型或父 POM 中定义的任何其他插件。关键是您必须复制`<id>`显示的`help:effective-pom`，并将 更改`<phase>`为无效值（例如“none”）。如果您没有`<id>`（例如在 Jintian DENG 的原始答案中 - 它已被编辑添加一个），它将无法正常工作，正如您所发现的那样。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-09-27T12:08:29.880

要么配置`skipMain`参数：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <skipMain>true</skipMain>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

或者传递`maven.main.skip`属性：

```
mvn install -Dmaven.main.skip=true 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-30T21:59:00.370

首先执行 maven-compiler-plugin 的原因是因为您触发了一个默认的生命周期绑定。例如，如果您使用**mvn package**打包 jar ，它将在编译阶段触发 compile:compile。

也许尽量不要使用默认的生命周期，而是使用**mvn aspectj:compile**代替。

[http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html](http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html)有更多关于 maven 默认生命周期绑定的信息

# perl - 从 Perl 中的文件句柄向 zip 文件添加成员

> ID：14614447
> 
> 赞同：1
> 
> 时间：2013-01-30T21:47:49.027
> 
> 标签：perl, compression, zlib

我正在尝试将远程文件添加到本地 zip 存档中。目前，我正在做这样的事情。

```
use Modern::Perl;
use Archive::Zip;
use File::Remote;

my $remote = File::Remote->new(rsh => "/usr/bin/ssh", rcp => "/usr/bin/scp");
my $zip = Archive::Zip->new();

$remote->open(*FH,'host2:/file/to/add.txt');
my $fh = IO::File->new_from_fd(*FH,'r');

#this is what I want to do.
$zip->addFileHandle($fh,'add.txt');

... 
```

不幸的是，Archive::Zip 没有 addFileHandle 方法。

还有其他方法可以做到吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:55:43.693

做这样的事情（复制到本地路径）：

```
$remote->copy("host:/remote/file", "/local/file"); 
```

并将 Archive::Zip 提供的 addFile 方法与本地文件一起使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:06:36.393

Archive::Zip 可能不支持写入 zip 文件的文件句柄，但 Archive::Zip::SimpleZip 支持。

这是一个独立的示例，展示了如何从文件句柄读取并直接写入 zip 文件，而不需要任何临时文件。

```
use warnings;
use strict;

use Archive::Zip::SimpleZip;
use File::Remote;

# create a file to add to the zip archive
system "echo hello world >/tmp/hello" ;

my $remote = File::Remote->new(rsh => "/usr/bin/ssh", rcp => "/usr/bin/scp");
my $zip = Archive::Zip::SimpleZip->new("/tmp/r.zip");

$remote->open(*FH,'/tmp/hello');

# Create a filehandle to write to the zip fiule.
my $member = $zip->openMember(Name => 'add.txt');

my $buffer;
while (read(FH, $buffer, 1024*16))
{
    print $member $buffer ;
}

$member->close();
$zip->close();

# dump the contents of the zipo file to stdout
system "unzip -p /tmp/r.zip" ; 
```

# php - 从 MySQL 中获取随机行并用 PHP 显示

> ID：14614453
> 
> 赞同：2
> 
> 时间：2013-01-30T21:48:03.867
> 
> 标签：php, mysql, sql

我试图从我的表中选择行引用和作者并回显它

我的目标是创建一个随机报价生成器并显示实际报价和作者。

我在表中输入了 25 个引号，共 3 行（ID、引号、作者）

我的代码如下，我不断收到资源 id #9 错误

```
<?php

mysql_select_db(name of database);

$quotes = "SELECT author AND quote FROM inspirational_quotes ORDER BY RAND() LIMIT 1";

$result = mysql_query($quotes);

WHILE ($row = mysql_fetch_array($result)):
ENDWHILE; 

echo "$result";
?> 
```

请帮忙

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T21:50:38.697

首先，我想你想要

```
<?php

mysql_select_db(name of database);
$quotes = "SELECT author,quote FROM inspirational_quotes ORDER BY RAND() LIMIT 1";
$result = mysql_query($quotes);

WHILE ($row = mysql_fetch_array($result)):
ENDWHILE; 

echo "$result";
?> 
```

但我还有一个建议

预加载所有报价 ID

```
CREATE TABLE quoteID
(
    ndx int not null auto_increment,
    id int not null,
    PRIMARY KEY (ndx)
);
INSERT INTO quoteID (id) SELECT id FROM inspirational_quotes; 
```

现在根据 quoteID 表中的 id 进行选择

```
SELECT B.author,B.quote FROM quoteID A INNER JOIN inspirational_quotes B
USING (id) WHERE A.ndx = (SELECT CEILING(MAX(ndx) * RAND()) FROM quoteID); 
```

这应该可以很好地扩展，因为 @rnd_id 的返回值来自 id 列表，quoteID 表中没有间隙。

```
<?php

mysql_select_db(name of database);
$quotes = "SELECT B.author,B.quote FROM quoteID A INNER JOIN "
. "inspirational_quotes B USING (id) "
. "WHERE A.ndx = (SELECT CEILING(MAX(ndx) * RAND()) FROM quoteID)";

$result = mysql_query($quotes);

$row = mysql_fetch_array($result);

echo "$result";
?> 
```

试试看 ！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T21:50:26.747

您不能将 $result 回显为字符串

做

```
 WHILE ($row = mysql_fetch_array($result)):
     echo $row['author'] . " " . $row['quote'];
ENDWHILE; 

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T21:50:28.733

您没有呼应正确的变量。

```
echo $row['author'] . ": " . $row['quote']; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T21:50:49.433

为什么`AND`只是逗号。

```
SELECT author, quote FROM inspirational_quotes ORDER BY RAND() LIMIT 1 
```

**[MySQL 选择语法](http://dev.mysql.com/doc/refman/5.0/en/select.html)**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-30T21:53:53.297

我建议您通过 PHP 随机化结果以提高性能。例如。：

```
$r = mysql_query("SELECT count(*) FROM inspirational_quotes");
$d = mysql_fetch_row($r);
$rand = mt_rand(0,$d[0] - 1); 
$r = mysql_query("SELECT author,quote FROM inspirational_quotes LIMIT $rand, 1"); 
```

# html - 如何显示 2 列下拉列表 ASP 经典

> ID：14614455
> 
> 赞同：0
> 
> 时间：2013-01-30T21:48:11.917
> 
> 标签：html, sql-server, asp-classic, dhtml, html-select

我目前正在转换在 MS Access 中制作的系统，并且正在使用 ASP 经典重新编程所有基于 Web 的系统。我遇到了一点麻烦，在过去的 2 天里，我真的在网上到处寻找这个，但没有运气。

我想要完成的是一个下拉列表，它是 3 个简单的列，就像 Access 中的当前系统一样，所以说我正在 HTML 选择列表中寻找以下输出。

选择公司

```
walmart         25 street Montreal 
crazy man       36 bad street Laval
bad company     36 ethos street app 32 Quebec 
hello world     36 apples Toronto 
```

此输出来自 SQL Server 数据库。

我尝试了以下操作：计算公司名称中有多少字符（例如..20 个字符），然后我想在公司名称中添加相等的空格，例如（100 个字符）。

在这种情况下，我将取金额（100-20）并将其添加到公司名称，然后取公司名称并将其加入地址和城镇。

每次我通过循环时，我都会重做计算。

这都是在 asp classic 中完成的，这里是代码

```
<select id="search_Comp" name="search_Comp">
<option value="0">---</option>
<%
'loop
while not RS.EOF

'check if the company name is smaller than 100 characters
if len(RS("Comp_Name")) < 100 then

 'calculation of the padding
  whiteSpaceSize = 100 - len(RS("Comp_Name"))

end if 

'create the spaces need
nameCompSP = space(whiteSpaceSize)

'add the spaces to the company name  
nameComp = trim(RS("Comp_Name")) & nameCompSP

'replace for spaces for html output
NnameComp = replace(nameComp," ","&nbsp;")

%>
<option value="<%= trim(RS("Comp_ID"))%>"><%=NnameComp %><%= trim(RS("Comp_CAdd1"))%></option>
<%
RS.MOVENEXT
wend 
%>
</select> 
```

这会输出空格，但它们仍然没有对齐！

我也尝试过使用 SQL 但没有用

```
-- here is the query example --
SELECT 
    Comp_Name + SPACE (100 – len(Comp_Name)) + Comp_CAdd1 AS Comp_Name 
FROM 
    company
/****address will always be 100 char way from the first char of Company, the space in between padded with spaces ***/ 
```

但仍然输出带有空格但不排队的列...

有人可以帮我弄这个吗？我在谷歌和论坛中没有找到任何信息，也没有任何信息 - 请告诉我，非常感谢......

K3v_n

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:04:11.887

因为使用的默认字体是成比例的，所以它们永远不会对齐。您需要使用等宽字体。

在您的样式表中，使用：

```
select {
    font-family:courier;
    font-size:14px;
} 
```

# vb.net - 使用流阅读器读取文本文件

> ID：14614457
> 
> 赞同：1
> 
> 时间：2013-01-30T21:48:24.007
> 
> 标签：vb.net, streamreader

我想读取一个包含 3 行数据的文本文件，其中一行包含“Server = ...”，下一行是“Username = ..”，最后一行是“Password = ...”所以我想阅读此文件并将每一行放入一个单独的标签中.. (label1,label2,label3)

OFDSet 是我的 openfiledialog

全部在 Visual Basic..

有人帮忙吗？

这是我尝试过的代码，但出现错误：

```
Dim oReader As StreamReader

        If OFDSet.ShowDialog = Windows.Forms.DialogResult.OK Then
            oReader = New StreamReader(OFDSet.FileName, True)
            ServLabel.Text = oReader.ReadLine(1)
            UserLabel.Text = oReader.ReadLine(2)
            PassLabel.Text = oReader.ReadLine(3)

        End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:09:02.317

一个更简单的解决方案是通过 File.ReadAllLines 方法，该方法只需一次调用即可返回一组字符串。

```
If OFDSet.ShowDialog = Windows.Forms.DialogResult.OK Then
    Dim lines = File.ReadAllLines(OFDSet.FileName)
    ServLabel.Text = lines(0)
    UserLabel.Text = lines(1)
    PassLabel.Text = lines(2)
End If 
```

[请参阅此处的 MSDN 参考](http://msdn.microsoft.com/en-us/library/vstudio/s2tte0y1%28v=vs.100%29.aspx)

（文件类需要 System.IO 的导入）

另外，如果您的第一行是这样的

```
Server=MyServerPC 
```

并且您只`MyServerPC`需要 ServLabel 中需要在`=`符号处拆分输入的部分

```
ServLabel.Text = lines(0).Split("="c)(1) 
```

当然这只是一个例子。需要更强大的错误处理。您应该检查您是否至少有 3 行，以及每行是否由`=`符号正确分隔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:00:58.163

`StreamReader.ReadLine()`没有带参数的重载。Intellisense 将显示两个重载，因为返回类型`String`, 有一个索引器。

# json - 如何在 play2 中为所有 JSON 响应添加前缀，以防止 JSONP 通过易受攻击的请求升级

> ID：14614458
> 
> 赞同：3
> 
> 时间：2013-01-30T21:48:25.770
> 
> 标签：json, security, playframework-2.0, prefix

我想在我的所有 JSON 响应前面加上一系列引号，例如 ")]}',\n"，以防止 JSONP 升级漏洞。

如何在 play2 框架中完成？我已将我的 bodyparsers 设置为 JSON 并手动为所有响应添加前缀，但我正在寻找一种更优雅的方式来通过本机框架功能完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T00:29:56.070

我认为在这种情况下，理想的做法是解决自定义隐式 play.api.http.Writable。您可以通过向控制器扩展的特征添加隐式定义来做到这一点：

```
import play.api.http.Writeable

trait SecuredJsonController {
  implicit def writeableOf_JsValue(implicit codec: Codec): Writeable[JsValue] = {
    Writeable(jsval => codec.encode(")]}',\n" + jsval.toString))
  }
} 
```

这对我很有效。我不确定您对 Zed 的回复是什么意思，但是尝试通过填充您的响应正文来破坏 JSON 漏洞利用是很常见的，就像您最初询问的那样。谷歌用“while(1);”来做到这一点 和 facebook 用 "for(;;);" 所以这是一个很好的保障。[您可以在此处](http://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx)查看有关此类漏洞的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T10:12:53.267

“JSONP 升级漏洞”是什么意思？（[谷歌搜索它](https://www.google.com/search?q=JSONP+escalation+vulnerabilities)返回这个问题作为第一个结果，几乎没有别的）。

您想阻止人们将您的 JSON 用作 JSONP 吗？然后不包括[JSONP padding](http://en.wikipedia.org/wiki/JSONP#Padding)。

您是否想阻止人们在没有相同来源策略问题的其他程序中使用您的 JSON，在浏览器之外或使用他们自己的服务器代理它以服务于他们自己域中的客户端等？那么这是不可能的。即使你提供了一些残缺的 JSON，他们无论如何都会弄清楚。你唯一能做的就是写下禁止这样做的条款和条件并起诉他们（祝你好运）。

# c++ - OpenCv：如何转换矢量 到垫子 (CV_8U)

> ID：14614460
> 
> 赞同：2
> 
> 时间：2013-01-30T21:48:31.070
> 
> 标签：c++, opencv, vector, matrix

大家好，感谢您的关注，我有以下问题：

我有一个在图像上`vector<Point>`存储**多个坐标**的。我想要：

1.  创建一个 CV_8U 类型的空白白色垫子
2.  对于坐标向量中的每个点，我想在白色图像上用黑色标记那个点，
3.  打印图像。

这是**迭代向量的函数：**

```
void Frag::updateImage(vector<Point> points){

    ...

    if(NewHeight > 0 && NewWidth > 0){

        cv::Mat NewImage = cv::Mat(NewHeight, NewWidth, CV_8U, Scalar(255));
        // Is this the correct way to initialize a blank Mat of type CV_8U???

        for (unsigned int i = 0; i < points.size(); i++) {

            uchar* PointPtr = NewImage.ptr<uchar> (points[i].x, points[i].y);
            *PointPtr = 0;
        }

        Utility::DisplayImage(NewImage);

    }

    ...

 } 
```

这是我的**打印功能**：

```
void Utility::DisplayImage(Mat& tgtImage) {

    namedWindow("Draw Image", (CV_WINDOW_NORMAL | CV_WINDOW_KEEPRATIO));
    imshow("Draw Image", tgtImage);
    waitKey(0);

} 
```

我的问题如下：看起来这些值存储在矩阵中（我尝试打印它们），但是 DisplayImage 函数（在所有其他情况下都可以正常工作）一直向我显示空白图像。

我错过了什么？指针相关的问题？垫初始化问题？

**<--- --- --- 更新 --- --- --->**

在第一个答案之后，我发现实际问题是我无法在垫子中设置值。我发现这是因为我添加了一个简单的循环来打印 Mat 中的所有值（因为我的 Mats 通常非常小）。循环如下（我把它放在对坐标向量的迭代之后：

```
for(int j = 0; j< NewHeight; j++){
    for(int i = 0; i< NewWidth; i++){
        Logger << (int)NewImage.at<uchar> (i, j) << " ";
    }
    Logger << endl;
} 
```

它的结果总是这样：

```
Creating image with W=2, H=7.
255 255 
255 255 
255 255 
255 255 
255 255 
255 255 
255 255 
```

所以值只是没有设置，知道吗？

**它可能与图像类型（CV_8U）有关吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:01:27.660

我希望这会有所帮助，尚未测试。

```
Mat NewImage = Mat(NewHeight, NewWidth, CV_8U, Scalar(255));

for(int j = 0; j< NewHeight; j++){
for(int i = 0; i< NewWidth; i++){

for (int k = 0; k < points.size(); k++) {

            if(i==points[k].x && j ==points[k].y)
               NewImage.at<uchar>(j,i) = 0;
        }

}        
}
imshow(NewImage); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T10:11:16.530

在对我的代码进行彻底分析后，我检测到**存储在向量中的坐标是相对于更大的 Mat 而言的，比如 Mat `OldImage`。** 垫子`NewImage`旨在存储垫子点的一个子集`OldImage`（`NewImage`比 OldImage 小得多），但是没有从一个坐标系到另一个坐标系的坐标转换，我总是写在错误的位置。

我通过使用简单的减法将点转换为正确的坐标系解决了这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T22:51:55.473

你可以改为：

```
for (int i =0; i < points.size(); i++)
{
    cv::circle(NewImage, points.at(i), 0, cv::Scalar(0));    //The radius of 0 indicates a single pixel
} 
```

这省去了直接的数据访问和指针操作，并且更具可读性。

# php - 不包括超链接的子字符串

> ID：14614461
> 
> 赞同：0
> 
> 时间：2013-01-30T21:48:33.350
> 
> 标签：php, substr

这很明显，但是如果您对 $content 字段执行 substr，则字符的输出将取决于内容中的任何 href 属性。是否有一种简单的方法可以在排除 href 标记的同时执行 substr？

```
$excerpt = substr( $content, 0, 155 ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:51:15.923

在执行 substr 之前使用[http://php.net/strip_tags 。](http://php.net/strip_tags)

或者，如果您需要更多控制从 $content 中删除的内容，请使用[http://php.net/manual/en/function.preg-replace.php](http://php.net/manual/en/function.preg-replace.php)。

# jquery - JQuery POST 在同一台服务器上使用 HTTPS 失败

> ID：14614463
> 
> 赞同：0
> 
> 时间：2013-01-30T21:48:39.000
> 
> 标签：jquery, html, facebook, post

我对 JQuery 1.6.2 和 POST 到同一服务器上的页面有一个奇怪的问题。

错误：

```
POST https://[phpfile].php 500 (Internal Server Error) jquery-1.6.2.min.js:18
send jquery-1.6.2.min.js:18
f.extend.ajax jquery-1.6.2.min.js:18
f.(anonymous function) jquery-1.6.2.min.js:18
populateList main.js:1112
(anonymous function) main.js:211
e.resolveWith jquery-1.6.2.min.js:16
w jquery-1.6.2.min.js:18
send.d 
```

情况：

这是一个 Facebook 应用程序，可以做一些常见的事情（注意，昨天之前的每个版本都可以，关于受影响的文件，没有任何代码更改）。当应用程序加载时，它将根据用户请求朋友和礼物的列表。

起初 JQuery 在直接链接到 Google 的 api 页面时会导致错误，因此将 JQuery 文件移动到本地文件夹。现在，当我们尝试在代码中的任何位置使用 POST 时，我们会收到此错误。

**有人可以阐明一下吗？**

注意：因为报错是500，我一开始以为可能是php脚本有问题。所以脚本被验证是完整的，我们直接对脚本进行了示例 POST 消息，**没有**失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:43:31.800

AJAX 请求受制于几个旨在帮助安全的规则。

要向您的`https`页面发出 AJAX 请求，AJAX 所在的页面也必须通过`https`.

标准 AJAX 请求的协议 (http/https) 和域（包括子域）必须相同。

# windows - 在cmd中建立VPN连接

> ID：14614465
> 
> 赞同：43
> 
> 时间：2013-01-30T21:48:56.750
> 
> 标签：windows, cmd, vpn

如何在 Windows 中使用任意协议创建与任意服务器的 VPN 连接`cmd`？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2014-02-18T04:08:14.707

我知道这是一个非常古老的线程，但我一直在寻找解决同一问题的方法，在最终找到答案之前我遇到了这个问题，我想把它贴在这里，这样我鞋子里的其他人就会有更短的路程穿越互联网。

****请注意，您可能必须以管理员身份运行 cmd.exe 才能正常工作**

所以我们开始吧，打开提示符（作为管理员）并转到您的**System32**目录。然后运行

> C:\Windows\System32>cd ras

现在您将位于 ras 目录中。现在是时候使用我们的连接信息创建一个临时文件，然后我们将其附加到**rasphone.pbk**文件中，这将允许我们使用 rasdial 命令。

所以要创建我们的临时文件运行：

> C:\Windows\System32\ras>复制 con **temp.txt**

现在它可以让你输入文件的内容，应该是这样的：

```
[CONNECTION NAME]
MEDIA=rastapi
Port=VPN2-0
Device=WAN Miniport (IKEv2)
DEVICE=vpn
PhoneNumber=vpn.server.address.com 
```

因此，将 CONNECTION NAME 和 vpn.server.address.com 替换为所需的连接名称和所需的 vpn 服务器地址。

**新建一行，然后按 Ctrl+Z 完成并保存。**

现在我们将其附加到 rasphone.pbk 文件中，该文件可能存在也可能不存在，具体取决于您是否已经配置了网络连接。为此，我们将运行以下命令：

> C:\Windows\System32\ras>类型 temp.txt >> rasphone.pbk

这会将 temp.txt 的内容附加到 rasphone.pbk 的末尾，或者如果 rasphone.pbk 不存在，它将被创建。现在我们不妨删除我们的临时文件：

> C:\Windows\System32\ras>del temp.txt

现在我们可以使用以下命令连接到我们新配置的 VPN 服务器：

> C:\Windows\System32\ras>rasdial "CONNECTION NAME" myUsername myPassword

当我们想断开连接时，我们可以运行：

> C:\Windows\System32\ras>rasdial /DISCONNECT

那应该覆盖它！**我已经包含了一个直接副本，并从我的命令行设置了一个连接并使用此方法连接到加拿大 vpn 服务器：**

```
Microsoft Windows [Version 6.2.9200]
(c) 2012 Microsoft Corporation. All rights reserved.

C:\Windows\system32>cd ras

C:\Windows\System32\ras>copy con temp.txt
[Canada VPN Connection]
MEDIA=rastapi
Port=VPN2-0
Device=WAN Miniport (IKEv2)
DEVICE=vpn
PhoneNumber=ca.justfreevpn.com
^Z
        1 file(s) copied.

C:\Windows\System32\ras>type temp.txt >> rasphone.pbk

C:\Windows\System32\ras>del temp.txt

C:\Windows\System32\ras>rasdial "Canada VPN Connection" justfreevpn 2932
Connecting to Canada VPN Connection...
Verifying username and password...
Connecting to Canada VPN Connection...
Connecting to Canada VPN Connection...
Verifying username and password...
Registering your computer on the network...
Successfully connected to Canada VPN Connection.
Command completed successfully.

C:\Windows\System32\ras>rasdial /DISCONNECT
Command completed successfully.

C:\Windows\System32\ras> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-01-30T22:28:26.200

你调查过rasdial吗？

> 万一有人想这样做并在将来发现它，您可以从命令提示符使用 rasdial.exe 连接到 VPN 网络
> 
> IE`rasdial "VPN NETWORK NAME" "Username" *`
> 
> 然后它会提示输入密码，否则您可以使用“用户名”“密码”，但这不太安全

[[http://www.msfn.org/board/topic/113128-connect-to-vpn-from-cmdexe-vista/?p=747265](http://www.msfn.org/board/topic/113128-connect-to-vpn-from-cmdexe-vista/?p=747265)]

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-05-30T12:21:30.367

Powershell 是一种选择吗？

启动 Powershell：

```
powershell 
```

创建 VPN 连接：[`Add-VpnConnection`](https://docs.microsoft.com/en-us/powershell/module/vpnclient/add-vpnconnection)

```
Add-VpnConnection [-Name] <string> [-ServerAddress] <string> [-TunnelType <string> {Pptp | L2tp | Sstp | Ikev2 | Automatic}] [-EncryptionLevel <string> {NoEncryption | Optional | Required | Maximum}] [-AuthenticationMethod <string[]> {Pap | Chap | MSChapv2 | Eap}] [-SplitTunneling] [-AllUserConnection] [-L2tpPsk <string>] [-RememberCredential] [-UseWinlogonCredential] [-EapConfigXmlStream <xml>] [-Force] [-PassThru] [-WhatIf] [-Confirm] 
```

编辑 VPN 连接：[`Set-VpnConnection`](https://docs.microsoft.com/en-us/powershell/module/vpnclient/set-vpnconnection)

```
Set-VpnConnection [-Name] <string> [[-ServerAddress] <string>] [-TunnelType <string> {Pptp | L2tp | Sstp | Ikev2 | Automatic}] [-EncryptionLevel <string> {NoEncryption | Optional | Required | Maximum}] [-AuthenticationMethod <string[]> {Pap | Chap | MSChapv2 | Eap}] [-SplitTunneling <bool>] [-AllUserConnection] [-L2tpPsk <string>] [-RememberCredential <bool>] [-UseWinlogonCredential <bool>] [-EapConfigXmlStream <xml>] [-PassThru] [-Force] [-WhatIf] [-Confirm] 
```

查找 VPN 连接：[`Get-VpnConnection`](https://docs.microsoft.com/en-us/powershell/module/vpnclient/get-vpnconnection)

```
Get-VpnConnection [[-Name] <string[]>] [-AllUserConnection] 
```

连接：`rasdial [connectionName]`

```
rasdial connectionname [username [password | \]] [/domain:domain*] [/phone:phonenumber] [/callback:callbacknumber] [/phonebook:phonebookpath] [/prefixsuffix**] 
```

* * *

您可以使用上面的 powershell 命令管理您的 VPN 连接，只需使用连接名称通过`rasdial`.

的结果`Get-VpnConnection`可能有点冗长。这可以通过一个简单的`Select-Object`过滤器来简化：

```
Get-VpnConnection | Select-Object -Property Name 
```

* * *

更多信息可以在这里找到：

*   [使用 Windows PowerShell 在 Windows 8 中管理 VPN 连接](https://technet.microsoft.com/en-us/library/jj613766.aspx)
*   [拉斯迪亚](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-xp/bb490979(v=technet.10))
*   [选择对象](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/select-object)

# java - 将用户定义的包放入 tomcat 7 的目录文件夹名称

> ID：14614466
> 
> 赞同：0
> 
> 时间：2013-01-30T21:48:58.137
> 
> 标签：java

我是java和jsp的新手。我刚刚创建了一个小包，该包包含一个简单的 java 类。让我展示我真正想做的事情。我没有使用 servlet，所以请告诉我这个简单的例子，以便我可以继续我的工作。下面是我的代码或一个包类和一个jsp页面。

**我的java包**

```
package mypack;  //this is my package

public class Abc{
   public Abc(){
   }
   public void message(){
        System.out.println("My first java package");
   }
} 
```

**index.jsp** 这是我需要使用这个包的jsp页面

```
<%@ page import="java.sql.*"%>
<%@ page import="mypack.*"%>
<%
 Abc a = new Abc();
 a.messsage();
%> 
```

我使用的是 JDK1.5 和 tomcat 3。但我想更新我的系统。现在我有 JDK1.7.0_11 和 tomcat 7。我知道 tomcat 3 放置我的包的路径，但我不知道将这些包放在 tomcat 7 中的哪个位置。

**tomcat 3 放置包的目录路径：**

```
D:\Java\tomcat\examples\WEB-INF\classes   //i put my package at this path in tomcat3 
```

**tomcat 7 放置包的目录路径：**

```
D:\web\Tomcat 7.0\webapps\ROOT\WEB-INF   //trying to put my package in here but no use. 
```

我在 tomcat 7 的直接 WEB-INF 下找不到 classes 文件夹。我在 WEB-INF 中创建了一个名为 classes 的文件夹，但它不起作用。即使我已经删除了我的“类文件夹”并将我的包放在 WEB-INF 中，但它不起作用。请告诉我可以将 java 包放入 tomcat server 7 的路径。

我把我的jsp页面放在这里：

```
D:\web\Tomcat 7.0\webapps\ROOT\a    //folder "a" contains my jsp file. index.jsp and  
                                      its working 
```

问题是，jsp页面找不到包。这个你能帮我吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T09:00:46.527

包总是位于 WEB-INF/classes 中，而不是直接位于 WEB-INF 中。试着把它们放在这里：

```
D:\web\Tomcat 7.0\webapps\ROOT\WEB-INF\classes 
```

# c - 冒泡排序和计数字符数组

> ID：14614467
> 
> 赞同：0
> 
> 时间：2013-01-30T21:48:59.853
> 
> 标签：c

我为我的 C 课编写了这个程序。它基本上将用户带到马场，显示不同马匹的赔率并允许用户下注。最初，我的导师只希望我们将结果写入文本或二进制文件，以便用户可以随时查看过去的结果。

他最近告诉我们，他希望我们包含冒泡排序来按顺序对马进行分组，即马 1、马 1、马 1、马 1、马 2、马 2 ......等。

我确信我可以使用 strcmp() 计算出冒泡排序，但他还希望我们显示这匹马过去赢得比赛的次数。

我的问题是：我能做这样一个只处理字符/字符串数组的显示吗？我不想花我接下来的四个小时来构建一个行不通的解决方案。

提前致谢，

ps 这是程序那部分的函数。

```
void viewWinners() {
    FILE *zacksTrackStats;

    char horses[MAX_SIZE] = {0};        

    if ((zacksTrackStats = fopen("zacksTrackStats.txt", "r")) == NULL)
    {
        perror ("error");
        exit (0);
    }

    while (fgets(horses, sizeof(horses), zacksTrackStats) != NULL)
    {
        printf ("%s", horses);
    }

    fclose(zacksTrackStats);
    pause;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:09:06.223

当然可以。实际名称是“horse 1”和“horse 2”吗？如果是这样，您可以将每匹马的数据存储在一个整数数组中。如果没有，那么您必须制作一个查找表。存储每匹马获胜次数的信息并打印结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:12:48.877

将 txt 转换为数字是完全可能的，反之亦然。

查看这篇较早的帖子： [将字符串转换为整数 C](https://stackoverflow.com/questions/7021725/converting-string-to-integer-c)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T23:31:11.920

是的你可以。要操作文件中的数据，您可以使用`fscanf`（或`sscanf`）。

`sscanf(char *source, format, &dest, ...)`

例如 ：

```
int occurences[NUMBER_OF_HORSES_MAX];
int count = 0;
int temp = 0;
int i;

for(i = 0; i < NUMBER_OF_HORSES_MAX; ++i)
{
    occurences[i] = 0;
}

while (fgets(horses, sizeof(horses), zacksTrackStats) != NULL)
{
    sscanf(horses, "%d", &temp);
    occurences[temp] += 1;

    printf ("Current horse : %s", horses);

    count++;
}

for(i = 0; i < count; ++i)
{
    printf("Horse %d has won %d times\n", i, occurences[i]);
} 
```

# linux - Amazon EC2：无法卸载和删除 EBS 驱动器文件系统

> ID：14614472
> 
> 赞同：2
> 
> 时间：2013-01-30T21:49:17.267
> 
> 标签：linux, amazon-ec2, filesystems, amazon

我创建了一个 EBS 驱动器，将其附加到实例并使用**mkfs.ext3**创建了文件系统。现在我想卸载并删除驱动器，我尝试了很多东西，但似乎没有任何效果。虽然我能够从实例中分离驱动器并使用 EC-2 控制台删除，但是当我使用**df -hk**检查分区时，它仍然显示驱动器。

```
[ec2-user@XXXXXXXXXXXXXX ~]$ df -hk
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/xvda1             8256952   1075740   7097356  14% /
tmpfs                   304368         0    304368   0% /dev/shm
/dev/xvdf             30963708    176196  29214648   1% /media/newdrive 
```

**而且，当我尝试使用任何其他命令（如“fdisk -l”或 and all 或尝试浏览驱动器的文件夹时，腻子会话挂起。** 我是 EC2 云和 Linux 的新手。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T21:52:05.627

这个怎么样？
您需要运行为：
`sudo umount /dev/xvdf`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-18T19:02:20.077

卸载 -dRf /media/newdrive

umount 需要挂载点而不是像 /dev/xvdf 这样的设备类型

# java - 如何在目的地中使用字符串？

> ID：14614475
> 
> 赞同：0
> 
> 时间：2013-01-30T21:49:22.523
> 
> 标签：java, jsf

希望是一个简单的问题：

我创建了从登录页面获取用户名的代码：

```
private String username;

@PostConstruct
public void init() {
    username = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
} 
```

但我想要做的是将用户名添加到此目的地的末尾：

```
private String destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; 
```

我该怎么做才能让目的地调用用户名将文档放在特定于该用户的文件中？这都在同一个豆子里

这是我目前的豆

```
@ManagedBean(name = "fileUploadController")
public class FileUploadController {

    private String username;

    @PostConstruct
    public void init() {
        username = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
    }
    private String destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; // main location for uploads
    File theFile = new File(destination + username); // will create a sub folder for each user 

    public void handleFileUpload(FileUploadEvent event) {
        FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded.");
        FacesContext.getCurrentInstance().addMessage(null, msg);
        try {
            copyFile(event.getFile().getFileName(), event.getFile().getInputstream());
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public void copyFile(String fileName, InputStream in) {
        try {

            // write the inputStream to a FileOutputStream
            OutputStream out = new FileOutputStream(new File(theFile + "/" + fileName)); // cannot find path when adding username atm
            System.out.println(theFile); //testing 

            int read = 0;
            byte[] bytes = new byte[1024];

            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }

            in.close();
            out.flush();
            out.close();
//make sure new file is created, (displays in glassfish server console not to end user)
            System.out.println("New file created!");
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }
} 
```

当前编辑：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package richard.fileupload;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import javax.annotation.PostConstruct;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.context.FacesContext;

import org.primefaces.event.FileUploadEvent;

@ManagedBean(name = "fileUploadController")
public class FileUploadController {

    private String username;

    @PostConstruct
    public void init() {
        username = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
    }
    private String destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; // main location for uploads
    File theFile = new File(destination + username); // will create a sub folder for each user 

    public void handleFileUpload(FileUploadEvent event) {
        FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded.");
        FacesContext.getCurrentInstance().addMessage(null, msg);
        try {
            copyFile(event.getFile().getFileName(), event.getFile().getInputstream());
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public File getDirectory(String destination, String username) {
        //set the user directory from the destinarion and the logged user name
        File directory = new File(destination, username);
        //check if the location exists
        if (!directory.exists()) {
            //let's try to create it
            try {
                directory.mkdir();
            } catch (SecurityException secEx) {
                //handle the exception
                secEx.printStackTrace(System.out);
                directory = null;
            }
        }
        return directory;
    }

    public void copyFile(String fileName, InputStream in) {
        try {

            // write the inputStream to a FileOutputStream
            OutputStream out = new FileOutputStream(new File(directory)); // cannot find path when adding username atm
            System.out.println(directory); //testing 

            int read = 0;
            byte[] bytes = new byte[1024];

            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }

            in.close();
            out.flush();
            out.close();
//make sure new file is created, (displays in glassfish server console not to end user)
            System.out.println("New file created!");
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }
} 
```

编辑 ：：：：

现在说目录，在`out = new FileOutputStream(new File(directory));`找不到符号我`realFile`也不习惯

当前代码：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package richard.fileupload;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import javax.annotation.PostConstruct;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.context.FacesContext;

import org.primefaces.event.FileUploadEvent;

@ManagedBean(name = "fileUploadController")
public class FileUploadController {

    private String username;

    @PostConstruct
    public void init() {
        username = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
    }
    private String destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; // main location for uploads
    File theFile = new File(destination + username); // will create a sub folder for each user (currently does not work, below hopefully is a solution) 

    public File getDirectory(String destination, String username) { // currently not working, is not calling the username or directory 
        //set the user directory from the destinarion and the logged user name
        File directory = new File(destination, username);
        //check if the location exists
        if (!directory.exists()) {
            //let's try to create it
            try {
                directory.mkdir();
            } catch (SecurityException secEx) {
                //handle the exception
                secEx.printStackTrace(System.out);
                directory = null;
            }
        }
        return directory;
    }

    public void handleFileUpload(FileUploadEvent event) {
        FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded.");
        FacesContext.getCurrentInstance().addMessage(null, msg);
        try {
            copyFile(event.getFile().getFileName(), event.getFile().getInputstream());
        } catch (IOException e) {
            //handle the exception
            e.printStackTrace();
        }
    }

 public void copyFile(String fileName, InputStream in) {
    //get the directory assigned to the current user
    File userDirectory = getDirectory(destination, username);
    if (userDirectory != null) {
        OutputStream out = null;
        try {
            File realFile = new File(userDirectory, fileName);
            out = new FileOutputStream(new File(directory));
            int read = 0;
            //1024 must be a constant
            //also, it must be 4098 (4 KBs) for better performance
            byte[] bytes = new byte[1024];
            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }
            in.close();
            out.flush();
        } catch (IOException e) {
            System.out.println(e.getMessage());
        } finally {
            out.close();
        }
    }
} 
```

再次编辑大声笑：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package richard.fileupload;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import javax.annotation.PostConstruct;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.context.FacesContext;

import org.primefaces.event.FileUploadEvent;

@ManagedBean(name = "fileUploadController")
public class FileUploadController {

    private String username;

    @PostConstruct
    public void init() {
        username = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
    }
    private String destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; // main location for uploads (will change this thanks to adivce )
    File theFile = new File(destination + username); // will create a sub folder for each user (currently does not work, below hopefully is a solution) 

    public File getDirectory(String destination, String username) { 
        // currently not working, is not calling the username or destination 
        //set the user directory from the destinarion and the logged user name
        File directory = new File(destination, username);
        //check if the location exists
        if (!directory.exists()) {
            //let's try to create it
            try {
                directory.mkdir();
            } catch (SecurityException secEx) {
                //handle the exception
                secEx.printStackTrace(System.out);
                directory = null;
            }
        }
        return directory;
    }

    public void handleFileUpload(FileUploadEvent event) {
        FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded.");
        FacesContext.getCurrentInstance().addMessage(null, msg);
        try {
            copyFile(event.getFile().getFileName(), event.getFile().getInputstream());
        } catch (IOException e) {
            //handle the exception
            e.printStackTrace();
        }
    }

    public void copyFile(String fileName, InputStream in) {
    //get the directory assigned to the current user
    File userDirectory = getDirectory(destination, username);
    if (userDirectory != null) {
        OutputStream out;
        try {
            File realFile = new File(userDirectory, fileName);//realFile variable not used
            out = new FileOutputStream(new File(userDirectory));// no suitable constructor found for File(File)
            int read = 0;
            byte[] bytes = new byte[1024];
            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }
            in.close();
            out.flush();
            out.close();
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }
}
}

    /**
    public void copyFile(String fileName, InputStream in) {
        try {

            // write the inputStream to a FileOutputStream
            OutputStream out = new FileOutputStream(new File(directory)); // cannot find path when adding username atm
            System.out.println(directory); //testing 

            int read = 0;
            byte[] bytes = new byte[1024];

            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }

            in.close();
            out.flush();
            out.close();
//make sure new file is created, (displays in glassfish server console not to end user)
            System.out.println("New file created!");
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }
}
*/ 
```

这是我最新版本的代码，我试图修改它，但它当前抛出一些错误，我在代码的注释中添加了错误，公共文件是否`getDirectory(String destination, String username)`在正确的位置？谢谢，我从没想过我必须做这么多工作才能做一些简单的事情！:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:55:57.797

您的问题与[`File`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)类使用有关，而不是 JSF 问题。

您可以使用此类来处理文件或目录。首先，您可以有两种方法：

*   将检索用户目录的方法

*   一种将文件保存在用户目录中的方法

基本示例：

```
//note: this must be moved to an utility class
public File getDirectory(String destination, String username) {
    //set the user directory from the destinarion and the logged user name
    File directory = new File(destination, username);
    //check if the location exists
    if (!directory.exists()) {
        //let's try to create it
        try {
            directory.mkdir();
        } catch (SecurityException secEx) {
            //handle the exception
            //this is a naive way to do it
            secEx.printStackTrace(System.out);
            directory = null;
        }
    }
    return directory;
}

public void saveFile(String fileName, byte[] data) {
    //get the directory assigned to the current user
    File userDirectory = getDirectory(destination, username);
    if (userDirectory != null) {
        //create the real file using the directory as parent directory
        //we'll give the file name too
        //check the different constructors for File class
        File realFile = new File(userDirectory, fileName);
        //save the file the way you want/need...
        //this should be also in an utility class
        FileOutputStream fos;
        try {
            fos = new FileOutputStream(realFile);
            fos.write(myByteArray);
        } catch (Exception ex) {
            //handle the exception
            ex.printStackTrace(System.out);
        } finally {
            if (fos != null)
                fos.close();
        }
    }
} 
```

参考：

*   [byte[] 到 Java 中的文件](https://stackoverflow.com/q/4350084/1065197)
*   [FileOutputStream（文件文件）构造函数](http://goo.gl/FdFcc)

* * *

根据您的问题编辑，您必须修改`copyFile`才能看起来像`saveFile`我提出的方法。我将更改实现以使用`InputStream`.

```
public void copyFile(String fileName, InputStream in) {
    //get the directory assigned to the current user
    File userDirectory = getDirectory(destination, username);
    if (userDirectory != null) {
        OutputStream out;
        try {
            File realFile = new File(userDirectory, fileName);
            out = new FileOutputStream(new File(userDirectory));
            int read = 0;
            //1024 must be a constant
            //also, it must be 4098 (4 KBs) for better performance
            byte[] bytes = new byte[1024];
            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }
            in.close();
            out.flush();
        } catch (IOException e) {
            System.out.println(e.getMessage());
        } finally {
            out.close();
        }
    }
} 
```

# git - github工作副本的简单副本

> ID：14614477
> 
> 赞同：1
> 
> 时间：2013-01-30T21:49:30.013
> 
> 标签：git, github, repository

我想复制 github 存储库的当前工作副本。

澄清一下：我不想复制一个项目的整个存储库和整个历史。我不关心历史。

我只是想“签出”当前状态的工作副本以在本地编译。

尽管这看起来应该很简单，但我还没有找到任何关于此的内容。一切似乎都是为了获得所有数据的完整历史副本，而这不是我感兴趣的。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-30T15:23:28.570

`--depth`您可以使用to 选项做您想做的事情`git clone`。

> `--depth <depth>`
> 
> 创建一个浅克隆，其历史被截断为指定的修订数。浅层存储库有许多限制（您不能克隆或从中获取，也不能从中推送或进入），但如果您只对历史悠久的大型项目的近期历史感兴趣，并且想要作为补丁发送修复。

请注意限制，这对于一次性构建可能没有问题。

例如

```
$ git clone --depth=1 https://github.com/libgit2/libgit2.git

$ 混帐日志
提交 97d32abb492f7830f6e26719ce558429f6377b73
作者：卡洛斯·马丁·涅托
日期：2013 年 10 月 30 日星期三 15:09:32 +0100

    删除剩余的函数声明

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:49:51.040

“当前工作副本”已签出目录，可能包含本地更改。您可以像任何其他目录一样压缩它。要删除历史记录，请跳过 .git 目录。

如果你想从某个提交创建快照，git archive 是正确的工具。您还可以使用 --depth 选项进行克隆以跳过整个历史记录的下载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T21:53:51.157

单击`zip`存储库页面上的按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T21:54:55.887

为什么不直接压缩文件？

尝试这个：

https://github.com/[user-name]/[repo-name]/archive/master.zip

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-30T22:44:23.850

我认为 git archive 是您需要的命令。它将创建一个包含您指定的版本的 zip 或 tar 文件！它也有许多不同的有趣选项，可以在本地或远程存储库上工作。

# java - 从方法返回双精度

> ID：14614479
> 
> 赞同：1
> 
> 时间：2013-01-30T21:49:48.010
> 
> 标签：java, double, return

我目前正在编写一个程序，该程序将读取指定的文本文件，该文件检查每个买入/​​卖出/摘要的交易价值并检查算法，如果买卖语句中的交易不等于总交易金额在摘要中给出然后它输出一个错误并关闭程序。但是目前我的方法`scanMoneyValue`有一个错误，说它没有返回双精度，而实际上它是。我应该以不同的方式从我的方法中返回值吗？这是我的参考代码：

```
 import java.io.File;
    import java.io.IOException;
    import java.util.Scanner;

    import javax.swing.JFileChooser;
    import javax.swing.JOptionPane;

    public class RecurrsionFileChecker {

public static void main(String[] args) {
    int result;

    //File Chooser Window
    JFileChooser chooser = new JFileChooser("/home/nick/workspace/CS 1410-001/src/assignment03");
    chooser.setDialogTitle("Please choose a file to be checked");
    result = chooser.showOpenDialog(null);
    //User Cancelled the chooser
    if (result == JFileChooser.CANCEL_OPTION)
        return;
    File inputfile = chooser.getSelectedFile();

    try
    {   
        Scanner in = new Scanner(inputfile);
        //Call Method to look at next transaction
        scanNextTransaction(in);

    }
    catch (IOException e)
    {   
        System.out.println("Could not read file: " + inputfile);
    }

}

 /**
 * Returns double if the parameter Scanner has an error that does,
 * not match the summary before it.
 *   
 * @param s Any scanner
 * @return double if Summaries don't match.
 */
    public static double scanNextTransaction(Scanner s)
    {   
        String buy, sell, summary, date;
        double amount = 0, referenceValue, total = 0;
        summary = s.next();
        date = s.next();
        referenceValue = scanMoneyValue(s);

        while (s.hasNext())
        {   
            if (s.next() == "Buy")
            {
                date = s.next();
                amount = scanMoneyValue(s);
            }

            if(s.next() == "Sell")
            {
                date = s.next();
                amount = scanMoneyValue(s);
            }

            if(s.next() == "Summary")
            {
                amount = scanSubSummary(s);
            }
            //add the transactions
            total = total + amount;
        }
    return total;

    }

    public static double scanMoneyValue(Scanner in)
    {   
        String dollar = in.next();
        if(dollar.charAt(0) == '$')
        {   //convert string to a double
            String amount = dollar.substring(1);
            double complete = Double.parseDouble(amount);
            complete = complete * 100;
            return complete;
        }
    }

    public static double scanSubSummary(Scanner sub)
    {   
        String summaryDate, transDate, transType;
        int summarySubEntries, count = 0;
        double transValue, summaryValue = 0, totalValue = 0,  summaryAmount;

        summaryDate = sub.next();
        summaryAmount = scanMoneyValue(sub);
        summarySubEntries = sub.nextInt();

        while (count != summarySubEntries)
        {
            transType = sub.next();
            if (transType == "Summary")
            {
                summaryValue = scanSubSummary(sub);
            }
            transValue = scanMoneyValue(sub);   
            totalValue = transValue + totalValue + summaryValue;
            count++;            
        }
        if (totalValue != summaryAmount)
        {
            System.out.print("Summary error on " + summaryDate + ".");
            System.out.println("Amount is $" + summaryAmount + ", " + "should be $" + totalValue + ".");
        }
        return totalValue;

    } 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T21:53:05.753

好的，查看代码中唯一相关的部分：

```
public static double scanMoneyValue(Scanner in)
{   
    String dollar = in.next();
    if(dollar.charAt(0) == '$')
    {   //convert string to a double
        String amount = dollar.substring(1);
        double complete = Double.parseDouble(amount);
        complete = complete * 100;
        return complete;
    }
} 
```

如果以 ... 开头，您*确实会*返回一个值，但是如果它*不*以开头，您期望会发生什么？当前，您到达方法的末尾而不返回任何内容，这是无效的。`dollar``$`*`$`*

 *如果这是您实际上无法处理的意外数据，您可能应该抛出异常。

`double`此外，由于二进制浮点类型的性质，无论如何您都不应该真正使用货币值。考虑`BigDecimal`改用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-30T21:52:42.443

```
public static double scanMoneyValue(Scanner in)
{   
    String dollar = in.next();
    if(dollar.charAt(0) == '$')
    {   //convert string to a double
        String amount = dollar.substring(1);
        double complete = Double.parseDouble(amount);
        complete = complete * 100;
        return complete;
    }
} 
```

如果`if`条件失败，则没有`return`语句。你有一个`return`内部条件，但没有外部条件。您需要`return`在末尾添加一条语句，或者如果没有美元符号是错误的，则抛出异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T21:59:00.337

最好改一下

```
public static double scanMoneyValue(Scanner in)
{   
    String dollar = in.next();
    String amount = dollar.replaceAll("[^\\d.]+", "")
    double complete = Double.parseDouble(amount);
    complete = complete * 100;
    return complete;
} 
```

解释链接 -[在 java 中解析货币字符串](https://stackoverflow.com/questions/6016501/parsing-a-currency-string-in-java)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T21:53:59.347

```
public static double scanMoneyValue(Scanner in)
{   
    String dollar = in.next();
    if(dollar.charAt(0) == '$')
    {   //convert string to a double
        String amount = dollar.substring(1);
        double complete = Double.parseDouble(amount);
        complete = complete * 100;
        return complete;
    }
    //NEED RETURN STATEMENT HERE
} 
```

您得到的错误是因为当您编写函数时，该函数的所有分支都必须返回正确类型的值。在您的情况下，如果 if 语句失败，它会到达函数的末尾而不返回任何内容。*

# c - 正态分布函数

> ID：14614482
> 
> 赞同：0
> 
> 时间：2013-01-30T21:49:51.587
> 
> 标签：c

这是编写正态分布函数[http://en.wikipedia.org/wiki/Normal_distribution](http://en.wikipedia.org/wiki/Normal_distribution)的正确方法 还是应该使用 pow 函数？我真的很困惑，所以非常感谢您的帮助:)

```
#include <stdio.h>
#define _USE_MATH_DEFINES 
#include <math.h>
#include <stdlib.h>
int main()
{
double u,s, N, x1,math1, math2, math3,n, v, x;

printf("Enter Mean: ");
scanf("%lf", &u);
printf("Enter Standard Deviation: ");
scanf("%lf", &s);
printf("Enter Number Of Inputs: ");
scanf("%lf", &N);

    for (v=1; v<=N; v++)
    {
    printf("Enter Value: ");
    scanf("%lf", &x);
    n=(-1/2);
    printf("f(x)= ");
    math1 =1/(s*sqrt(2*M_PI));
    math2= (x-u)/s * (x-u)/s;
    math3= M_E * exp(n);
    x1 = math1 * exp(math3)*exp(math2);
    printf("%lf  \n", x1);
    }
system("Pause");
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T21:54:09.613

阅读您的代码太难了，但我可以说它是错误的。这是一个简短的版本：

```
double twopi = 8.0 * atan(1.0); // preferable to using M_PI
double x = ..., sigma = ..., mu = ...;
double y = (1.0 / (sigma * sqrt(twopi))) *
    exp(-(x - mu)*(x - mu) / (2.0 * sigma * sigma)); 
```

请注意我如何将数学公式直接转换为 C 中的表达式......这使得验证代码是否正确变得容易。当您使用一堆临时变量时，这有点`math1`困难`math2`，`math3`...

请记住：`exp()`与数学中的对应物相同，`exp`. `exp(x)`e ^x也是如此。一旦意识到这一点，您将在代码中看到错误。

# javascript - jQuery插件的方法

> ID：14614484
> 
> 赞同：0
> 
> 时间：2013-01-30T21:49:54.040
> 
> 标签：javascript, jquery, html, checkbox

我正在尝试为自定义复选框和单选按钮制作一个 jQuery 插件。

```
(function($)
{
    $.fn.checkboxRadio = function(options)
    {
        var defaults = some;
        ...

        return this.each(function()
        {
            var button = $(this);
            ...
        });
    }
})(jQuery); 
```

现在可以使用`$('input').checkboxRadio(options);`

如何在`check`不更改当前范围的情况下添加方法，以便可能使用类似的东西`$('input').checkboxRadio('check')`？

如何处理自定义方法并在我的插件中获取其名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:12:15.120

这是官方的[jquery 插件指南](http://docs.jquery.com/Plugins/Authoring)。

关于包装函数的部分可以在[这里找到（“插件方法”）](http://docs.jquery.com/Plugins/Authoring#Plugin_Methods)（这个例子是一个可能的工具提示插件）：

```
(function( $ ){
  var methods = {
    init : function(options) { ... },
    show : function() { ... },
    hide : function() { ... },
    update : function(content) { ... }
  };

  $.fn.tooltip = function( method ) {

    // Method calling logic
    if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
      return methods.init.apply( this, arguments );
    } else {
      $.error( 'Method ' +  method + ' does not exist on jQuery.tooltip' );
    }    
  };
})(jQuery); 
```

* * *

**[更新]**解释`methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ))`指南中的行：

如果您`$(selector).tooltip('update', 'hello')`从您的 javascript 代码中调用，您希望最终调用该`update`方法，`'hello'`作为`content`参数传递，并在调用期间`this`设置`$(selector)`为。

这就是这条线所关心的：

*   如果`method == 'update'`，`methods[method]`是`update`方法，
*   `arguments`将等于`['update', 'hello']`，您必须删除第一个元素才能获取要传递给方法的参数；这正是这样`Array.prototype.slice.call(arguments, 1)`做的，
*   `myFunc.apply(obj, argsArray)`调用函数，作为参数`myFunc`传递，并在调用期间设置为。`argsArray``this``obj`

因此，在您的方法中，您可以调用`this.each(...)`以迭代所有选择器的项目，例如：

```
update: function(content) {
  this.each(function(){ $(this).data('tooltip.content', content); });
  return this;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:09:04.170

您可以像这样连接插件方法：

```
(function($) {
    $.fn.checkboxRadio = function(options) {
        var defaults = {
            check: 'check'
    }

        return this.each(function() {
            var o = options;
            var _this = $(this);

            if( o.check === 'check' ) {
                 _this.attr('checked','checked');
            }else if ( o.check === 'uncheck' ) {
                 _this.removeAttr('checked');
            }
        });
    }
})(jQuery); 
```

和用户文档应该像你想要的：`$('input').checkboxRadio({check:'check'});`

# jstl - 修复了错误 27717 的 Apache JSTL

> ID：14614485
> 
> 赞同：2
> 
> 时间：2013-01-30T21:49:52.463
> 
> 标签：jstl

无法通过此更正找到 Apache JSTL 1.1 的下载....

[https://issues.apache.org/bugzilla/show_bug.cgi?id=27717](https://issues.apache.org/bugzilla/show_bug.cgi?id=27717)

任何人都可以指向我下载包含此修复程序的 Apache JSTL jar。在此修复之前，我的搜索不断出现 1.1 的下载。

谢谢

戴夫

# ios - 更新到 iOS 6.1 后无法在设备上测试

> ID：14614486
> 
> 赞同：2
> 
> 时间：2013-01-30T21:49:58.577
> 
> 标签：ios, xcode

我可以在我的 iPhone 4s 设备上测试我的应用程序，直到昨天。

今天早上将 iOS 更新到 6.1 版并尝试在同一设备上测试我的应用程序后，Xcode 开始抱怨“没有可用的兼容 iOS 版本的预置 iOS 设备。将 iOS 设备与最新版本的 iOS 连接以运行您的应用程序或者选择一个 iOS 模拟器作为目的地。”

但是，所有配置的东西似乎都很好：/

有没有人遇到过同样的问题？任何人都知道如何让它工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-30T21:51:46.127

您需要更新到最新版本的 XCode。4.6 版包括对 iOS 6.1 的支持（[这里是变更日志](https://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/WhatsNewXcode/Articles/xcode_4_6.html#//apple_ref/doc/uid/TP40012895-SW1)）。根据[维基百科](http://en.wikipedia.org/wiki/Xcode#4.6)，4.6 于 28 日上线。

# nginx - 使用更新的 openssl 获取 Nginx 工作

> ID：14614491
> 
> 赞同：2
> 
> 时间：2013-01-30T21:50:26.680
> 
> 标签：nginx, openssl

我在 Linux Ubuntu 服务器上将 openssl 从 0.9.8 升级到 1.0.0。它安装在 /usr/local/ssl 中。Nginx 使用 openssl 0.9.8 编译。如何让 Nginx 链接到 openssl 的更新版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T09:08:27.813

您可以重新编译 nginx，通过 --with-openssl=/usr/local/ssl 选项进行配置，或者您可以在启动 nginx 时使用 LD_LIBRARY_PATH，执行类似“LD_LIBRARY_PATH=/usr/local/ssl:$LD_LIBRARY_PATH /usr /sbin/nginx”。

# asp.net - 从 FormsAuthentication 重定向到登录页面时，在 Post 中维护变量

> ID：14614495
> 
> 赞同：3
> 
> 时间：2013-01-30T21:50:32.067
> 
> 标签：asp.net, post, forms-authentication

这是我们的场景：

1.  用户登录网站#1。一旦通过身份验证，该站点将收集有关用户的一些凭据（与此问题无关的单独过程）并将此信息发布到网站 #2 上的页面
2.  网站 #2 受 FormsAuthentication 保护，并将用户重定向到登录页面。
3.  此时，网站#1 发布的值将丢失。

问题：

我们如何在网站#2 的身份验证/登录过程中保留网站#1 的发布值。

我们尝试过的事情：

1.  我们试图将代码放入 Global.asmx 中的 Session_Start 方法中。我们想将值保存在会话中，但会话仅在用户被重定向到登录页面时才开始（断点被命中）。到这个时候，我们已经失去了价值观。
2.  我们尝试将一些代码放入 Application_BeginRequest，但无法从该方法访问会话。

我们需要使用 POST 而不是 GET，因为数据的长度太长而无法放入查询字符串中。我们无法在 cookie 中保留值的原因相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T23:33:22.927

您可以在整个步骤中跟踪任何内容（某种任意会话标识符，例如 guid）吗？我会考虑将收集的凭据存储在数据库中，直到达到第 3 步，然后在登录时销毁记录。

# ember.js - 从视图访问模型关联

> ID：14614501
> 
> 赞同：4
> 
> 时间：2013-01-30T21:50:46.477
> 
> 标签：ember.js

我的用户和工作区模型具有 belongsTo / hasMany 关系：

```
App.User = DS.Model.extend({
  name: DS.attr('string'),
  workspace: DS.belongsTo('App.Workspace')
});

App.Workspace = DS.Model.extend({
  name: DS.attr('string'),
  users: DS.hasMany('App.User')
}); 
```

我有一个控制器和视图设置，控制器的模型属性设置为有效用户。

```
App.ApplicationRoute = Ember.Route.extend({
  setupController: function() {
    this.controllerFor('test').set('model', App.User.find(1));
  }
}); 
```

下面的代码和输出表明，在代码执行时，belongsTo 关联尚未加载。从视图类访问工作区（通过用户）的正确方法是什么？

```
App.TestView = Ember.View.extend({

  didInsertElement: function() {
    var self = this;

    console.log('first try: ');
    console.log(this.get('controller.model.workspace'));

    setTimeout(function() {
      console.log('second try: ');
      console.log(self.get('controller.model.workspace'));
    }, 1000);
  }
}); 
```

输出；

```
// first try: 
// null 
// second try: 
// Class { ... } 
```

我可以通过 {{model.workspace}} 访问模板中的工作区——如何在视图类中做同样的事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-30T22:36:25.580

> 从视图类访问工作区（通过用户）的正确方法是什么？

您的方法`this.get('controller.model.workspace')`是从您的视图访问工作区的正确方法。但是正如您的示例所示， didInsertElement() 钩子是错误的地方。由于`App.User.find(1)`是异步的，因此在渲染模板时，您不能指望`model.workspace`（甚至`model`它本身）可用。这就是你的 console.log 第一次返回 null 的原因。

这可能并不明显，因为 Ember 非常努力地消除显式形式的异步行为。由于它会立即返回一个模型引用，我们可能希望`App.User.find()`它是同步的，但事实并非如此。查看[管理异步](http://emberjs.com/guides/understanding-ember/managing-asynchrony/)以更详细地了解细节。

> 我可以通过 {{model.workspace}} 访问模板中的工作区——如何在视图类中做同样的事情？

在幕后，handlebars 绑定`{{model.workspace}}`到您的模型并在值更改时重新渲染模板。您应该在视图类中使用类似的技术。根据您要完成的任务，您可能希望使用绑定、计算属性或观察者。例如：

```
App.TestView = Ember.View.extend({

  workspaceChanged: function() {
    console.log('workspaceChanged to: ');
    console.log(this.get('controller.model.workspace'));        
  }.observes('controller.model.workspace')

}); 
```

另请参阅[绑定。观察者，计算属性：我什么时候使用？](http://emberjs.com/guides/object-model/what-do-i-use-when/)

# php - php curl 发布到 PHPBB

> ID：14614504
> 
> 赞同：8
> 
> 时间：2013-01-30T21:50:56.673
> 
> 标签：php, curl

我曾经通过我的帐户通过 PHP 脚本向论坛发布更新，最近它已经停止工作，我不能 100% 确定原因 - curl 没有返回错误，除了出现的消息之外，一切*似乎都很好。*

我发布到的董事会已为我的用户设置了禁用洪水限制，我有权发布所需的任何类型的主题

发布即时消息的代码如下（不久前在网上找到 - 稍作修改）

```
$url = "http://url.co.uk/board/";

$post_fields = 'username=user&password=pass&redirect=&login=Log+in';
$lurl = $url."ucp.php";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$lurl);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_fields);
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch,CURLOPT_COOKIEJAR,"cookie.txt");
$result= curl_exec ($ch);
curl_close ($ch);
$sid1 = explode("sid=",$result);
$sid2 = explode('&',$sid1[1]);
$sid = rtrim(substr($sid2[0], 0, -29),'"');

$purl = url&"posting.php?mode=post&f=20&sid=$sid";
var_dump($purl);
$ch1 = curl_init();
curl_setopt($ch1, CURLOPT_URL,$purl);
curl_setopt($ch1,CURLOPT_RETURNTRANSFER,1);
curl_setopt ($ch1, CURLOPT_HEADER, false );
curl_setopt($ch1, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch1,CURLOPT_COOKIEFILE,"cookie.txt");
$result1= curl_exec ($ch1);
curl_close ($ch1);

preg_match('%name="form_token" value="(.*)"\ /\>%',$result1,$security123);
preg_match('%name="lastclick" value="(.*)"\ /\>%',$result1,$lastclick);
preg_match('%name="creation_time" value="(.*)"\ /\>%',$result1,$ctime1);
$lclick = explode('" />',$lastclick[1]);

$title = "标题";
$subject = "待发帖";
$post_fields = 数组（
            '主题' => $标题，
         '消息' => htmlspecialchars_decode($subject),
            '图标' => 0,
'poll_title' => "投票名称",
'poll_option_text' => "投票 1\r\n投票 2",
'poll_max_options' => 1,
'poll_length' => 0,
'poll_vote_change' => "开",

            'disable_smilies' => 0,
            'attach_sig' => 1,
            '通知' => 0,
         'topic_type' => 2,
            'topic_time_limit' => "",
           'creation_time' => $ctime1[1],
         'lastclick' => $lclick[0],
          'form_token' => $security123[1],
              'sid' => $sid,
         '发布' => '提交',

         );
print_r($post_fields);
$ch1 = curl_init();
curl_setopt($ch1, CURLOPT_URL,$purl);
curl_setopt($ch1, CURLOPT_POST, 1);
curl_setopt($ch1, CURLOPT_POSTFIELDS, $post_fields);
curl_setopt($ch1,CURLOPT_RETURNTRANSFER,1);
curl_setopt ($ch1, CURLOPT_HEADER, false );
curl_setopt($ch1, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch1,CURLOPT_COOKIEFILE,"cookie.txt");
$result2= curl_exec ($ch1);
如果（curl_errno（$ch1））
{
    echo '卷曲错误：' . curl_error($ch1);
}
curl_close ($ch1);
回声 $result2;

```

从这里`$result2`有论坛的输出线程，但提交的消息尚未发布。

我在 $result2 中正常登录，没有可见的错误消息。

有什么建议么 ？我检查了 sid、form_token、lclick 和 creation_time，它们*似乎*都是相同且正确的。

卷曲详细输出

```
* About to connect() to site.co.uk port 80
*   Trying 78.xxx.yyy.zzz... * connected
* Connected to site.co.uk (78.xxx.yyy.zzz) port 80
> POST /board/posting.php?mode=post&f=20 HTTP/1.1

Host: site.co.uk

Accept: */*

Cookie: phpbb3_9g61k_sid=693813912f38db33091212ee14102026; phpbb3_9g61k_k=; phpbb3_9g61k_u=57

Content-Length: 1914

Expect: 100-continue

Content-Type: multipart/form-data; boundary=----------------------------2fb596b13df0

< HTTP/1.1 100 Continue

< HTTP/1.1 302 Found

< Date: Wed, 30 Jan 2013 23:21:39 GMT

< Server: Apache/2.2.22 (CentOS)

< Location: http://site.co.uk/board/viewforum.php?f=20

< Content-Length: 0

< Content-Type: text/html; charset=UTF-8

* Connection #0 to host site.co.uk left intact
* Issue another request to this URL: 'http://site.co.uk/board/viewforum.php?f=20'
* Disables POST, goes with GET
* Re-using existing connection! (#0) with host site.co.uk
* Connected to site.co.uk (78.xxx.yyy.zzz) port 80
> GET /board/viewforum.php?f=20 HTTP/1.1

Host: site.co.uk

Accept: */*

Cookie: phpbb3_9g61k_sid=693813912f38db33091212ee14102026; phpbb3_9g61k_k=; phpbb3_9g61k_u=57

< HTTP/1.1 200 OK

< Date: Wed, 30 Jan 2013 23:21:39 GMT

< Server: Apache/2.2.22 (CentOS)

< Cache-Control: private, no-cache="set-cookie"

< Expires: 0

< Pragma: no-cache

< Transfer-Encoding: chunked

< Content-Type: text/html; charset=UTF-8

* Connection #0 to host site.co.uk left intact
* Closing connection #0 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T08:06:10.580

解决了

post.php 第 49 行

```
if ($cancel || ($current_time - $lastclick < 2 && $submit)) 
```

尽管对我的用户禁用了洪水，但我仍然必须坚持 2 秒的硬编码延迟。

# php - 将所有“error_log”文件添加到 .gitignore

> ID：14614511
> 
> 赞同：9
> 
> 时间：2013-01-30T21:51:55.357
> 
> 标签：php, git, gitignore, error-log

我对我所有的 PHP error_log 文件感到沮丧，导致我的生产和开发服务器与 git 发生合并冲突。解决方案很简单——将所有名为“error_log”的文件添加到.gitignore——但我不知道该怎么做。这就是我在 .gitignore 中尝试的内容：

```
error_log 
```

仅排除根目录中的 error_log 文件（而不是我运行 PHP 的所有其他目录）。

*error_log 会起作用吗？

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-31T01:06:30.783

你`.gitignore`是绝对正确的，但`.gitignore`只会阻止文件被**添加**到存储库中——已经跟踪的文件与此无关。因此，首先您需要`error_log`通过运行以下命令从索引中删除所有文件：

```
git rm --cached '*/error_log' error_log 
```

现在，当您运行时，您的`git status`一些 error_log 文件应该被列为“已删除”，但它们都不应该显示为未跟踪的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:56:41.593

您需要删除所有已添加的 error_log 文件（使用 git rm --cached *error_log），但是，是的，添加“error_log”行应该可以解决问题。或者，如果“error_log”只是文件后缀，那么按照您的建议添加“*error_log”应该没问题。

# python - 在 Python 中合并具有数百万行的两个表

> ID：14614512
> 
> 赞同：13
> 
> 时间：2013-01-30T21:51:56.040
> 
> 标签：python, join, merge, pandas, pytables

我正在使用 Python 进行一些数据分析。我有两个表，第一个（我们称之为'A'）有 1000 万行和 10 列，第二个（'B'）有 7300 万行和 2 列。他们有 1 列具有共同的 id，我想根据该列将两个表相交。特别是我想要表的内部连接。

我无法将表 B 作为 pandas 数据框加载到内存中，以在 pandas 上使用正常的合并功能。我尝试通过读取块上的表 B 的文件，将每个块与 A 相交并连接这些交叉点（内部连接的输出）。这在速度上是可以的，但时不时地给我带来问题并吐出分段错误......没有那么好。这个错误很难重现，但它发生在两台不同的机器上（Mac OS X v10.6 (Snow Leopard) 和 UNIX、Red Hat Linux）。

我终于尝试了 Pandas 和 PyTables 的组合，方法是将表 B 写入磁盘，然后遍历表 A 并从表 B 中选择匹配的行。最后一个选项有效，但速度很慢。默认情况下，pytables 上的表 B 已经被索引。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-31T03:24:35.147

这有点伪 codish，但我认为应该很快。

简单的基于磁盘的合并，所有表都在磁盘上。关键是您本身并没有进行选择，只是通过启动/停止索引到表中，这非常快。

在 B 中选择符合条件的行（使用 A 的 id）不会很快，因为我认为它可能会将数据带入 Python 空间而不是内核搜索（我不确定，但您可能想要在内核优化部分对 pytables.org 进行更多调查。有一种方法可以判断它是否会在内核中）。

此外，如果你能做到，这是一个非常并行的问题（只是不要将结果从多个进程写入同一个文件。pytables 对此不是写安全的）。

有关如何执行联接操作实际上是“内部”联接的评论，请参阅[此答案。](https://stackoverflow.com/questions/20217417/what-are-some-alternatives-for-overcoming-a-merge-fail-in-pandas-that-is-to-big)

对于您的 merge_a_b 操作，我认为您可以使用非常有效的标准 pandas 连接（在内存中时）。

另一个选项（取决于 A 的“大”程度）可能是将 A 分成两部分（索引相同），在第一个表中使用较小的（可能使用单列）；与其存储合并结果本身，不如存储行索引；稍后您可以提取所需的数据（有点像使用索引器并获取）。见[http://pandas.pydata.org/pandas-docs/stable/io.html#multiple-table-queries](http://pandas.pydata.org/pandas-docs/stable/io.html#multiple-table-queries)

```
A = HDFStore('A.h5')
B = HDFStore('B.h5')

nrows_a = A.get_storer('df').nrows
nrows_b = B.get_storer('df').nrows
a_chunk_size = 1000000
b_chunk_size = 1000000

def merge_a_b(a,b):
    # Function that returns an operation on passed
    # frames, a and b.
    # It could be a merge, join, concat, or other operation that
    # results in a single frame.

for a in xrange(int(nrows_a / a_chunk_size) + 1):

    a_start_i = a * a_chunk_size
    a_stop_i  = min((a + 1) * a_chunk_size, nrows_a)

    a = A.select('df', start = a_start_i, stop = a_stop_i)

    for b in xrange(int(nrows_b / b_chunk_size) + 1):

        b_start_i = b * b_chunk_size
        b_stop_i = min((b + 1) * b_chunk_size, nrows_b)

        b = B.select('df', start = b_start_i, stop = b_stop_i)

        # This is your result store
        m = merge_a_b(a, b)

        if len(m):
            store.append('df_result', m) 
```

# android - 通过 adb shell 激活/解锁手机

> ID：14614513
> 
> 赞同：2
> 
> 时间：2013-01-30T21:51:57.853
> 
> 标签：android, shell, adb

使用 adb shell 我可以在手机上输入文本。但这不起作用，如果手机的显示屏关闭。我必须先按下主页按钮并解锁屏幕才能正常工作。如何在不在设备上添加额外代码的情况下使用 adb shell 自动执行此操作？

```
adb shell input keyevent KEYCODE_HOME 
```

不幸的是，这根本行不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:53:50.383

您可以检查显示器电源状态，`dumpsys power`然后在需要时模拟电源键按下以将其唤醒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-14T19:53:45.940

用于`adb shell input keyevent 26`唤醒设备。( [Source](https://stackoverflow.com/questions/7789826/adb-shell-input-events) ) 现在进行文本输入或任何您想做的事情。而且，解锁也可以使用`input`命令完成，但不同的锁需要不同的技术，所以你必须谷歌一下，或者在这里提供信息，以便我/其他人可以回答。

相同的命令也可以使设备进入睡眠状态。

# asp.net-mvc - 我的 web api 路线图正在返回多个操作

> ID：14614516
> 
> 赞同：1
> 
> 时间：2013-01-30T21:52:10.963
> 
> 标签：asp.net-mvc, asp.net-web-api

请求的网址：`http://localhost/api/access/blob`

路线：

```
config.Routes.MapHttpRoute(
    name: "AccessApi",
    routeTemplate: "api/{controller}/{action}"
); 
```

定义的动作：

```
public class AccessController : ApiController
{
    // GET api/access/blob
    [HttpGet]
    public string Blob()
    {
        return "blob shared access signature";
    }

    // GET api/access/queue
    [HttpGet]
    public string Queue()
    {
        return "queue shared access signature";
    }
} 
```

结果：

```
Multiple actions were found that match the request: 
    System.String Blob() on type Project.Controllers.AccessController 
    System.String Queue() on type Project.Controllers.AccessController 
```

为什么它没有找到合适的行动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T23:19:47.630

您必须删除`DefaultApi`WebApiConfig.cs 文件中的路由配置。仅添加您的配置：

```
public static class WebApiConfig
{
    public static void Register(HttpConfiguration config)
    {
        config.Routes.MapHttpRoute(
            name: "AccessApi",
            routeTemplate: "api/{controller}/{action}"
            );
    }
} 
```

它将与 url 一起使用：

`http://localhost/api/access/blob`

`http://localhost/api/access/queue`

# php - 如何在php中的zip中“规范化”文件名中的重音字符？

> ID：14614517
> 
> 赞同：1
> 
> 时间：2013-01-30T21:52:12.677
> 
> 标签：php, encoding

我的 linux 服务器上已经保存了许多 zip，管理它们的应用程序必须提取包含的文件。

但是，zip 的上传者有时会在文件名中添加重音字符，因此当 php 提取文件名时，我可能会得到一些编码混乱的名称，特别是在 windows 中创建 zip 时。

从 zip 中提取文件名的代码是：

> $zip = zip_open ( $zipFile ) ;
> 
> 而 ($zip_entry = zip_read($zip))
> $ArrayInternalFileNames[] = zip_entry_name ($zip_entry);

我应该如何处理 $ArrayInternalFileNames 内容，以免出现“乱码”字符？问题是由于编码混乱，php 字符串函数不能很好地处理这些文件名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:18:20.250

您可以尝试使用以下命令将文件名音译为 ASCII [`iconv()`](http://ca1.php.net/manual/en/function.iconv.php)：

```
$filename = iconv('UTF-8', 'ASCII//TRANSLIT', $string); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-15T21:33:25.023

除了萨米奇的回答。

另一种音译选择：

```
$file_name=iconv("UTF-8", "ISO-8859-1//TRANSLIT", $file_name); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-19T13:22:11.487

确保您的源名称为 UTF-8。然后：

```
$file_name=iconv("UTF-8", "IBM850", $file_name); 
```

zip 中的文件名必须经过`IBM850`编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T21:56:57.397

你可以试试：

```
mb_convert_encoding($zip_entry, 'UTF-8'); 
```

这将删除任何不需要的字符。否则，请查看[strtr()](http://php.net/strtr)它将允许您将一组字符转换为另一组字符。

# mysql - MySQL LOAD DATA LOCAL INFILE 只导入单行

> ID：14614519
> 
> 赞同：8
> 
> 时间：2013-01-30T21:52:15.913
> 
> 标签：mysql, sql, csv, import, phpmyadmin

我们有一个包含数千条记录的 CSV 文件。我想通过 phpmyadmin 将这些行导入 MySQL 表。这是使用的命令：

```
load data local infile '/var/www/html/deansgrads_201280.csv' 
into table ttu_nameslist
fields terminated by ','
enclosed by '"'
lines terminated by '\r\n'
(firstname, middlename, lastname, city, county, state, termcode, category) 
```

表中有一个 ID 字段设置为自动递增。当我们执行这个 SQL 时，只有第一行被导入到表中。

**输入数据文件行：**

```
"Aaron","Al","Brockery","Cookeville","Putnam","TN","201280","deanslist"
"Aaron","Dan","Mickel","Lebanon","Wilson","TN","201280","deanslist" 
```

**表结构：**

```
CREATE TABLE `ttu_nameslist` (
  `id` int(11) NOT NULL,
  `firstname` varchar(50) NOT NULL,
  `middlename` varchar(50) NOT NULL,
  `lastname` varchar(50) NOT NULL,
  `city` varchar(50) NOT NULL,
  `county` varchar(50) NOT NULL,
  `state` varchar(2) NOT NULL,
  `termcode` varchar(6) NOT NULL,
  `category` varchar(10) NOT NULL,
  PRIMARY KEY (`id`)
 ) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

我做错了什么为什么添加一行后退出？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T14:51:54.707

您说 ID 字段具有`AUTO_INCREMENT`属性，但`CREATE TABLE`声明中没有提及。这是问题的一部分。

另一部分是那些截断警告。CSV 文件中的某些行可能包含太长而无法容纳在列中的数据。将这些文本列的大小增加到更大的值（比如 200），然后重试。

您绝对确定 CSV 文件有效吗？（又名每一行都有相同数量的值等）。您可能应该检查这些字符串是否包含逗号 ( `,`)，尽管这应该不是问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-01-03T22:29:53.523

**为什么 MySQL LOAD DATA INFILE 命令只加载一行？**

发生的事情是你加载第一列很好，然后当你加载第二列时它失败了，因为它违反了唯一索引约束。

MySQL`LOAD DATA LOCAL INFILE`将在列上强制执行您的唯一索引，然后跳过任何有问题的重复行而不做任何事情，甚至不记录警告！

**如何重现这种现象：**

1.  创建一个包含 int 和 varchar 列的表：

    ```
    mysql> create table foo(id INT, mytext VARCHAR(255));
    Query OK, 0 rows affected (0.02 sec) 
    ```

2.  在 varchar 列上添加唯一约束：

    ```
    mysql> alter table foo add constraint my_epic_constraint unique(mytext);
    Query OK, 0 rows affected (0.02 sec)
    Records: 0  Duplicates: 0  Warnings: 0 
    ```

3.  创建输入文本文件 /tmp/foo.txt，由制表符分隔，这违反了唯一约束：

    ```
    1   fred
    2   fred 
    ```

4.  尝试导入它：

    ```
    mysql> load data local infile '/tmp/foo.txt' into table foo fields 
           terminated by '\t' lines terminated by '\n' (@col1,@col2) 
           set id=@col1, mytext=@col2;

    Query OK, 1 row affected (0.01 sec)
    Records: 2  Deleted: 0  Skipped: 1  Warnings: 0 
    ```

砰！你的问题是：为什么它只导入一行？因为你有一个唯一的键约束，数据文件中的行违反了它。

**解决方案：**

1.  删除表上的唯一键约束，然后重试。

2.  进入文本文件并删除违反唯一约束的重复行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-23T02:42:02.587

我遇到了同样的问题，我使用双引号 "\r\n" 而不是 '\r\n' 解决了

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-23T19:30:55.070

对于那些感兴趣的人，我遇到了与上述相同的问题，但它与 LINES TERMINATED BY assignment、主键违规或错误字符集无关。

升级到 MySQL 8 后我开始收到此错误，我的问题最终是我通过*col_name_or_user_var*选项发送的列名。最初我在导入文件中有额外的列，我没有使用，这不会导致原始实现出现问题。但是，升级后，我必须为这些列添加变量条目以使其正常工作并导入多行（我无权更改 import.csv 中的这些列）。使用这样的导入文件：

```
FIELD_1, FIELD_2, FIELD_3, FIELD_4, FIELD_5 
```

我不得不从：

```
LOAD DATA INFILE 'import.csv'
INTO TABLE tableName
FIELDS TERMINATED BY ','
OPTIONALLY ENCLOSED BY '\"'
LINES TERMINATED BY '\n'
(FIELD_1, FIELD_2, FIELD_3) 
```

至：

```
LOAD DATA INFILE 'import.csv'
INTO TABLE tableName
FIELDS TERMINATED BY ','
OPTIONALLY ENCLOSED BY '\"'
LINES TERMINATED BY '\n'
(FIELD_1, FIELD_2, FIELD_3, @FIELD_4, @FIELD_5) 
```

# mutex - 可以在内存中移动 pthread_mutex_t 吗？

> ID：14614523
> 
> 赞同：7
> 
> 时间：2013-01-30T21:52:34.767
> 
> 标签：mutex, realloc

我想构建一个动态分配的 pthread_mutex 数组，该数组会随着时间的推移而增长（添加更多互斥体）。我的问题是，如果使用 realloc() 移动数组，它们是否仍然有效。我担心的是 pthread_mutex_init() 可能会以某种方式设置内部信息，该信息取决于当时互斥体的地址。

更具体地说，这是一个显示问题的玩具片段：

```
pthread_mutex_t *my_mutexes = (pthread_mutex_t *) malloc (sizeof(pthread_mutex_t));
pthread_mutex_init (my_mutexes, NULL);
my_mutexes = (pthread_mutex_t *) realloc (my_mutexes, 2*sizeof(pthread_mutex_t));
/* does my_mutexes[0] still work at this point? */ 
```

我想在所有这些情况下的答案都是“如果没有明确允许，就假设不是”，但我想在这里得到明智的建议。如果结论不是这样做，那么我想知道一般来说，我如何创建一个不断增长的互斥体列表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T22:30:29.727

移动互斥锁是不安全的。例如，Linux 上的一些互斥锁实现使用`futex`专门等待互斥锁地址的系统调用。

如果它需要动态增长，我建议`pthread_mutex_t`为该主列表使用一个主指针数组和一个互斥锁。当您增加数组时，您将只是移动指针列表而不是互斥锁本身。可以使用 plain 分配互斥锁`malloc`。

# javascript - 将图像可见性设置为 false

> ID：14614527
> 
> 赞同：1
> 
> 时间：2013-01-30T21:52:47.040
> 
> 标签：javascript, jquery, html, image, invisible

我有很多图像都是一个类的一部分，这里是代码：

```
class='button_cell' 
```

我可以帮忙将所有这些图像设置为通过 Javascript 不可见吗？

我使用以下代码将 DIV 中的所有项目设置为禁用：

```
$('#incident_div').find('input, textarea, button, select').attr('disabled',true); 
```

我猜代码应该是相似的，但我被卡住了。

我可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T21:56:19.083

您可以`button_cell`使用 选择类中的所有图像`$('.button_cell')`，然后使用该`hide()`功能将它们全部隐藏，如下所示：

```
$('.button_cell').hide(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T21:54:04.850

我不确定您到底想要什么，如果您想隐藏它们，请使用：

```
$('#incident_div').find('input, textarea, button, select').hide(); 
```

如果你想用类隐藏元素，`'button_cell'`你可以使用

```
 ('button_cell').hide() 
```

如果您只想将它​​们禁用为灰色，请尝试：

```
$('#incident_div').find('input, textarea, button, select').each(function(){
    $(this).attr("disabled",true);
}); 
```

这是一个工作小提琴：http: [//jsfiddle.net/XfVvf/](http://jsfiddle.net/XfVvf/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T21:56:18.827

按类别隐藏：

```
$('.button_cell').hide(); 
```

这将选择“button_cell”类的所有元素并隐藏它们。

同样，向他们展示：

```
$('.button_cell').show(); 
```

阅读：[jQuery 选择器](http://api.jquery.com/category/selectors/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T21:56:40.463

这是一个好的开始，但没有看到更多就很难知道......

```
$('.button_cell').show(); 
```

我确实显示而不是隐藏，因为您说您希望它们不可见……这意味着可见。

如果实际上您希望它们不可见，请使用：

```
$('.button_cell').hide(); 
```

# python - Python - 找不到文件

> ID：14614532
> 
> 赞同：0
> 
> 时间：2013-01-30T21:52:57.950
> 
> 标签：python

我的项目中有名为 fileimporter.py 的文件，当运行项目时，它会引发以下错误：

```
Traceback (most recent call last):
  File "C:\Users\myuser\Desktop\python\project\samples\clientlogin_example.py", line 54, in <module>
    CSVImporter(ft_client).importFile("data.csv")
  File "build\bdist.win-amd64\egg\fusiontables\fileimport\fileimporter.py", line 39, in importFile
ValueError: invalid literal for int() with base 10: '1S762e1A1XD1R97hy2LDgokzWo4fw_YWgUPbptlc' 
```

在我班级的顶部，我有下面与项目结构相对应的行：

```
from project.fileimport.fileimporter import CSVImporter 
```

问题是，我找不到路径“build\bdist.win-amd64\egg\”，即使我删除该文件或尝试修复它或清理并重建项目，同样的错误仍会继续出现。

它似乎是一个缓存文件，因为我已经删除了发生错误的行，但控制台中没有任何改变......

有人知道我怎么能找到那条路吗？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:12:54.003

这听起来很像一个遗留`pyc`文件。例如：

```
$ echo "def f(): raise Exception('footastic')" > foo.py
$ python -c "import foo"
$ python -c "import foo; foo.f()"
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "foo.py", line 1, in f
    def f(): raise Exception('footastic')
Exception: footastic 
```

现在让我们删除`foo.py`并再试一次：

```
$ rm foo.py
$ python -c "import foo"
$ python -c "import foo; foo.f()"
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "foo.py", line 1, in f
Exception: footastic 
```

移除剩余部分`foo.pyc`使其恢复正常：

```
$ rm foo.pyc
$ python -c "import foo"
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named foo 
```

# java - Scriptella：将数据从 sql 传输到 java

> ID：14614533
> 
> 赞同：0
> 
> 时间：2013-01-30T21:53:03.193
> 
> 标签：java, sql, scriptella

是否可以在 scriptella 中使用 sql 请求获取数据并将其访问到 java 代码中？如下所示：

```
 <connection id="metadata" url="jdbc:postgresql://localhost:5432/testDB" driver="scriptella.driver.postgresql.Driver" user="user" password="password" classpath="postgresql.jar"/>

    <connection id="java" driver="scriptella.driver.janino.Driver"/>

    <query connection-id="metadata">
        SELECT dataid FROM header_table;
        <query connection-id="java">
            System.out.println(?{dataid});
        </query>
    </query> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T08:43:24.593

当然，在 Janino 或其他脚本语言（如 JEXL 或 JS）中是可能的。由于 Java 是静态类型的，因此您必须使用 get('name') 方法来访问变量：

```
<connection id="metadata" url="jdbc:postgresql://localhost:5432/testDB" user="user" password="password" classpath="postgresql.jar"/>

<connection id="java" driver="janino"/>

<query connection-id="metadata">
    SELECT dataid FROM header_table;
    <script connection-id="java">
       Object dataId = get("dataid"); 
       System.out.println(dataId);
    </script>
</query> 
```

[Janino 驱动程序 JavaDoc](http://scriptella.javaforge.com/docs/api/scriptella/driver/janino/package-summary.html.)提供了更多详细信息。

# javascript - onclick：浏览单选按钮并查找选中的单选按钮

> ID：14614534
> 
> 赞同：0
> 
> 时间：2013-01-30T21:53:05.077
> 
> 标签：javascript, html

我希望我的代码在用户单击保存按钮时获得选中的单选按钮值。我已经列出了代码，但我不确定如何循环通过单选按钮，因为它们没有类 ID？这是我所拥有的：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
<script>
saveButton.onclick = function() {       
    // Go through shirtColor rabio buttons to see which one is ticked
    for (var i = 0; i < shirtColor.length; i++) {
        if (.checked = true) {
            // Set shirtColor variable to selected color
            var shirtColor = .checked;

            // Only one value can be selected so we're done
            return;
        }
    }
};
</script>
</head>

<body>
<p>Shirt Color:
<input type="radio" name="shirtColor" id="red" value="red" />
Red
<input type="radio" name="shirtColor" id="green" value="green" />
Green
<input type="radio" name="shirtColor" id="blue" value="blue" /> 
Blue</p>
<p>
<input type="button" id="saveButton" value="Save">
</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:06:19.267

使用**纯 Javascript**，您可以执行以下操作：

```
saveButton.onclick = function() {       
    // Go through shirtColor rabio buttons to see which one is ticked
    var shirtColors = document.getElementsByName("shirtColor");
    for (var i = 0; i < shirtColors.length; i++) {
        var shirtColor = shirtColors[i];
        if (shirtColor.checked) {
            // Set shirtColor variable to selected color
            alert(shirtColor.value);

            // Only one value can be selected so we're done
            return;
        }
    }
}; 
```

看到[这个小提琴](http://jsfiddle.net/MjsDX/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:57:20.657

你很近。您需要将其包装在 a`<form>`中，以便为脚本提供一些上下文。在这种情况下，您不需要 ID。

```
saveButton.onclick = function() {       
    var shirtColor = document.forms[0].shirtColor;
    for (var i = 0; i < shirtColor.length; i++) {
        if (shirtColor[i].checked == true) {
             return shirtColor[i].value;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:00:15.827

您需要将 for 循环更改为

```
var cboxes = document.getElementsByName('shirtColor');
for(var i = 0; i < cboxes.length ; i++
{
    if(cboxes[i].checked)
        shirtColor = cboxes[i];
} 
```

但是，如果您使用 jquery，它会简单得多：

```
var shirtColor = $("input[name='shirtColor']:checked").val(); 
```

# android - Android中的View和ViewLayout

> ID：14614535
> 
> 赞同：1
> 
> 时间：2013-01-30T21:53:05.257
> 
> 标签：android, android-layout

我需要在屏幕上有很多卡片（Rect 类 + ShapeDrawable 用于添加颜色），并且希望在用户触摸它时移动屏幕上的每张卡片。屏幕上可能有很多卡片，每个卡片都可能堆叠.我的意思是一个在另一个之下，例如部分重叠，完全隐藏等。

那么有没有一种方法可以将每张卡片（矩形类+ShapeDrawable）与其相应的触摸事件连接起来，这样我就不需要手动遍历所有卡片列表并查看用户触摸了哪个卡片。

我应该扩大视野并做吗？有没有更好的管理方法？

谢谢

# hadoop - AWS EMR CLI - 将参数传递给 HIVE

> ID：14614537
> 
> 赞同：0
> 
> 时间：2013-01-30T21:53:05.993
> 
> 标签：hadoop, amazon-web-services, arguments, hive, elastic-map-reduce

我正在使用 aws 的 emr ruby​​ cli 生成 Hadoop 集群，并且我试图在托管在其他地方的 HIVE 脚本中包含要使用的参数，如下所示：

```
./elastic-mapreduce --create ... --args -d,DT=2013-01-26 
```

'DT' 令人满意地显示在我的 HadoopJarStep.Args 数组中，因此我尝试将其包含在 HIVE 脚本中，如下所示：

```
...

tblproperties(
  'dynamodb.table.name' = ${DT},
  ... 
```

但我很快就明白了：

```
Parse Error: line 8:28 mismatched input '$' expecting StringLiteral near '=' in specifying key/value property 
```

我应该如何在我的 HIVE 脚本中正确包含参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:07:08.037

我不确定为什么您当前的方法不起作用，但我已经成功：

```
./elastic-mapreduce --create ... --args "-hiveconf,DT=2013-01-26" 
```

并在配置单元脚本中：

```
tblproperties(
    "dynamodb.table.name" = "${hiveconf:DT}",
    ...
) 
```

希望这可以帮助。

# c# - C#正则表达式不匹配字符串中的某些单词

> ID：14614538
> 
> 赞同：0
> 
> 时间：2013-01-30T21:53:11.720
> 
> 标签：c#, regex, regex-lookarounds

我已经尝试了几个小时来解决这个问题。假设有一个字符串

```
"hello Exclude1 4:32  test test Exclude2 5:23 hello 2:19 some more text 42:3 more text" 
```

我正在尝试创建一个仅匹配但 忽略`2:19`和`42:3``Exclude1 4:32``Exclude2 5:23`

即如果 4:32 或 n:nn 前面有 Exclude1 或 Exclude2，则不匹配。谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-30T21:58:07.810

您可以使用[**否定的lookbehind**](http://www.regular-expressions.info/lookaround.html#lookbehind)来忽略某个其他表达式之前的表达式：

```
(?<!Exclude1 )(?<!Exclude2 )\d+:\d+ 
```

这将匹配`##:##`没有立即出现在`Exclude1 `或之前的那个`Exclude2 `。

演示：[**正则表达式**](http://www.rubular.com/r/yCfI8MUvSA)| [**C# 代码示例**](http://ideone.com/JPfREU)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:58:31.013

```
 (?<!a)b for example matches b which is not preceded by a, you can
 easily adapt it to your needs. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T21:58:54.333

您是否尝试过类似的方法：

`(?<!Exclude\d )\d+:\d+`

# java - Restlet 客户端冻结 HTTPS 请求

> ID：14614540
> 
> 赞同：1
> 
> 时间：2013-01-30T21:53:19.007
> 
> 标签：java, rest, https, restlet, restlet-2.0

我正在尝试使用带有 Restlet 的 HTTPS 和 XML 帖子在 Java 中创建客户端-服务器应用程序。

我遵循了各种教程，并设法毫无问题地运行服务器端（如果我用浏览器连接到它，它会正确响应），但是一旦我启动客户端，它们都会冻结：客户端没有完成它的请求并且服务器不再响应浏览器请求。

现在我正在使用版本 2.2 Milestone 1，但我也尝试使用版本 2.1.1，但没有成功。我在 MacOSX 10.7.5 上使用 Eclipse Juno。这两个商店是使用 keytool 命令创建的（我创建了 serverKey.jks，导出了自签名证书并将其添加到 clientTrust.jks）。
我最初包含的罐子是：

*   org.restlet
*   org.jssl.utils
*   org.restlet.ext.ssl

但我也尝试添加特定的连接器（另外，在 libs readme.txt 中列出了依赖项）：

*   org.restlet.ext.httpclient.jar
*   org.restlet.ext.jetty.jar
*   org.restlet.ext.net.jar
*   org.restlet.ext.simple.jar

### 测试HTTPS类

```
public class TestHTTPS extends Application{

    public static void main(String[] args) throws Exception{
        TestHTTPS t = new TestHTTPS();
        t.testhttps();
    }

    public void testhttps() throws Exception{
        Component comp = new Component();

        Server server = comp.getServers().add(Protocol.HTTPS, 8183);

        Series<Parameter> servParameters = server.getContext().getParameters();
        servParameters.add("keystorePath", "serverKey.jks");
        servParameters.add("keystorePassword", "password");
        servParameters.add("keystoreType", "JKS");
        servParameters.add("keyPassword", "password");
        servParameters.add("tracing", "true");

        comp.getDefaultHost().attach(new TestHTTPS());      
        server.start();

        Context con = new Context();
        Series<Parameter> clParameters = con.getParameters();

        clParameters.add("truststorePath", "clientTrust.jks");
        clParameters.add("truststoreType", "JKS");
        clParameters.add("truststorePassword", "password");

        Client restletClient = new Client(con, Protocol.HTTPS);
        Reference resourceRef = new Reference("https://localhost:8183/user/myself");

        Request request = new Request(Method.POST, resourceRef);
        request.getClientInfo().getAcceptedMediaTypes().add(new Preference<MediaType>(MediaType.TEXT_XML));

        Response response = restletClient.handle(request);
        System.out.println(response.getEntityAsText());

        restletClient.stop();
        server.stop();
    }

    @Override
    public Restlet createInboundRoot() {
        Router router = new Router(getContext());
        router.attach("/user/{id}", UserResource.class);
        return router;
    }
} 
```

### 用户资源类

```
public class UserResource extends ServerResource {
    @Post("xml")
    public Representation sendPostResponse(){
        return new StringRepresentation("<Document>content</Document>", MediaType.APPLICATION_XML);
    }

    @Get("xml")
    public Representation sendGetResponse(){
        return new StringRepresentation("<Document>content</Document>", MediaType.APPLICATION_XML);
    }
} 
```

控制台的唯一输出是：

```
Starting the internal [HTTPS/1.1] server on port 8183
Starting the internal [HTTPS/1.1] client 
```

难道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-23T20:30:33.953

经过一番调查，我发现以下解决了“启动内部 [HTTPS/1.1] 客户端”进程停滞的问题：

确保以下三个 JAR 在您的构建路径中：

```
org.restlet.ext.net.jar
org.restlet.ext.ssl.jar
org.restlet.jar 
```

# forms - Primefaces 为什么在关闭对话框时调用 setXXXX 方法

> ID：14614541
> 
> 赞同：0
> 
> 时间：2013-01-30T21:53:31.230
> 
> 标签：forms, jsf-2, dialog, primefaces

关闭对话框时为什么调用 setDataTransferRangeInSeconds() 方法？通常关闭对话框时我可能不会被调用？

```
 <h:form>
        <p:dialog header="Service Alarm Options" 
                widgetVar="updatedlg"
                closable="true" 
                minWidth="500"
                 minHeight="1000"
                resizable="false"
                dynamic="false" 
                >
            <h:panelGrid id="servicedetails">
                <p:commandButton value="Save"
                    action="#{alarmBean.updateServiceOptions}" />
                <p:commandButton value="#{messages.exit}" icon="ui-icon-close"
                    style="valign:bottom;float:right;padding-right:20px"
                    oncomplete="updatedlg.hide();">
                </p:commandButton>
                <p:inputText
                    value="#{alarmBean.selectedDocument.dataTransferRangeInSeconds}"></p:inputText>
            </h:panelGrid>

        </p:dialog>
    </h:form> 
```

更新。

```
 <p:dialog header="Service Alarm Options" widgetVar="updatedlg"
        closable="true" minWidth="500" minHeight="1000" resizable="false"
        dynamic="false">
        <h:form>
            <h:panelGrid id="servicedetails">
                <p:commandButton value="Save"
                    action="#{alarmBean.selectedDocument.saveNewFeatures}" />
                <p:commandButton value="#{messages.exit}" icon="ui-icon-close"
                    style="valign:bottom;float:right;padding-right:20px"
                    onclick="updatedlg.hide();" type="button" />
                <p:inputText
                    value="#{alarmBean.selectedDocument.dataTransferRangeInSeconds}"></p:inputText>
            </h:panelGrid>
        </h:form>
    </p:dialog> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:02:48.880

通常不会，但将对话框放在表单中是不正确的。重新排序您的代码并让您的表单位于对话框中：

```
<p:dialog>
  <h:form>
      <!-- your form -->
  </h:form>
</p:dialog> 
```

此外，您的退出按钮是 AJAX 按钮（Primefaces 中的默认设置），它发送 AJAX 请求并在该请求之后隐藏对话框。在该请求期间，来自输入的请求值被发送并在 bean 中设置。将按钮更改为此：

```
<p:commandButton value="#{messages.exit}" icon="ui-icon-close"
                style="valign:bottom;float:right;padding-right:20px"
                onclick="updatedlg.hide();" type="button"/> 
```

这将创建一个按钮，它只调用一个 javascript 来关闭对话框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:41:25.493

```
<p:dialog header="Service Alarm Options" widgetVar="updatedlg"
        closable="false" minWidth="500" minHeight="1000" resizable="false"
        dynamic="false">
        <h:form>
            <h:panelGrid id="servicedetails">
                <p:commandButton value="Save"
                    action="#{alarmBean.selectedDocument.saveNewFeatures}" />
                <p:commandButton value="#{messages.exit}" icon="ui-icon-close"
                    style="valign:bottom;float:right;padding-right:20px"
                    update="@form"
                    actionListener="#{alarmBean.selectedDocument.resetFeatures}"
                    oncomplete="updatedlg.hide();">                     
                </p:commandButton>              
                <p:inputText
                    value="#{alarmBean.selectedDocument.dataTransferRangeInSeconds}"></p:inputText>
            </h:panelGrid>
        </h:form>
    </p:dialog> 
```

# java - 在Java中为返回变量赋值

> ID：14614550
> 
> 赞同：2
> 
> 时间：2013-01-30T21:54:02.097
> 
> 标签：java, reference

这可能是一个基本问题，但我不确定使用什么关键字来搜索它。

是否可以为 Java 中的返回变量赋值，例如：

```
static int a[] = new int[2];

static int f(int i) {
    return a[i];
}

static void main() {
    f(1) = 0; // <-- this
} 
```

在 C/C++ 中，我可以返回一个指针并稍后为其赋值。由于 Java 与引用一起工作，我希望上面的代码可以工作。我在这里错过了一些重要的 Java 概念吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T21:58:56.163

即使是引用类型，方法调用***也不*是变量**。

但是，这样的事情就可以了：

```
static MyClass func() {
   return new MyClass();
}

public static void main(String[] args) {
   func().setAttr(null); // change attributes
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:59:38.710

这是不可能的（参见其他评论），但您可以创建自己的 MutableInteger 类，该类允许修改其值：

```
public class MutableInteger {
    public int value;
    public MutableInteger(int value) {
        this.value = value;
    }
    public MutableInteger() {
        this(0);
    }
}

static MutableInteger a[] = new MutableInteger[2];
static {
    for (int i=0; i<a.length; i++) {
        a[i] = new MutableInteger();
    }
}

static MutableInteger f(int i) {
    return a[i];
}

static void main() {
    f(1).value = 0; // <-- this
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:00:34.857

不，在 Java 中，只有原始类型（其行为与 C++ 中的行为基本相同）和引用类型。引用类型的行为类似于 C++ 指针和 C++ 引用之间的混合——当您使用 时，它们会自动取消引用`.`，但`=`始终会更改引用指向的内容，而不是被引用对象的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T22:00:53.447

这行不通。也许它有助于理解“机器”级别发生的事情。在方法内部`f`，表达式`a[i]`被评估为一个`int`值。返回此 int 值，与与该值关联的数组没有任何连接。从方法返回后，您`int`在 Java 虚拟机的操作数堆栈上获得了值（将其视为中间值）并且可以用它做一些事情。你可以删除它（如果你写`f(1);`在一行中会发生这种情况），你可以将它分配给一个变量（`int x = f(1)`），就是这样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-30T22:01:01.677

一种方法是将数组转换为[`MutableInt`](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/mutable/MutableInt.html)s（或`AtomicInteger`s）的数组，并返回`i`对该数组的第 -th 元素的引用：

```
static AtomicInteger a[] = new AtomicInteger[2];
static {
    for (int i = 0; i < a.length; ++i) {
        a[i] = new AtomicInteger(0);
    }
}

static AtomicInteger f(int i) {
    return a[i];
}

public static void main(String[] args) {
    f(1).set(0);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-30T22:15:13.437

这将是一个编译错误，因为[赋值运算符](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.26)要求左侧是[Expression Name](http://docs.oracle.com/javase/specs/jls/se7/html/jls-6.html#jls-6.5.6)、[Field Access Expression](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.11)或[Array Access Expression](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.13)，而是`f(1)`Method [Invocation Expression](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12)。

抛开编译错误不谈，这不是 Java 的工作方式。在 Java 中，一切都是按值传递的——尤其是在这个特定的示例中，因为您的返回类型是`int`.

```
static /*RETURN TYPE IS PRIMITIVE VALUE:*/ int f(int i) {
    return a[i];
} 
```

如果我们添加一个中间变量，它会变得更清晰：

```
static /*RETURN TYPE IS PRIMITIVE VALUE:*/ int f(int i) {
    int ret = a[i]; // ret is an independent value from a[i]
                    // it and a[i] can be changed without affecting each other
    return return ret;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-30T23:21:06.513

OP的问题是

> 是否可以为Java中的返回变量赋值

非常简单...（注意我分配 10 以显示证明，因为在初始化的 int 数组中所有值都是 0）...

```
static int a[] = new int[2];

static int f(int[] p, int index, int val) {
    return p[index] = val;
}

static void main() {        
    // f(a, 1, 0); use 10 (below) so we can show proof
    f(a, 1, 10);
    // proof
    System.out.println(a[1]);
} 
```

另一个例子......很傻，但有效......

```
static int a[] = new int[2];

static int[] f(int[] p) {
    return p;
}

static void main() {
    f(a)[1] = 10;
} 
```

完后还有 ...

```
static int a[] = new int[2];

static void f(int i, int val) {
    a[i] = val;
    return;
}

static void main() {
    f(1, 10);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-30T23:34:14.717

您可能对如何将 lambdas 应用于此问题感兴趣，尽管这只适用于 Java 8 预览版。

假设在标准库中有这样定义的接口：

```
interface Block<T> {
    void accept(T v);
} 
```

（有一个建议把它放进去`java.util.functions`，只是增加了一点复杂性......）

现在我们可以这样写你的例子：

```
// Declare an array
int[] a = new int[5];

// Capture an "assignment reference" to element 2 
Block<Integer> elem2 = v -> a[2] = v;

// Some time later, we want to store a new value in that element:
elem2.accept(360); 
```

所以你的函数会返回`Block<Integer>`，你以后可以调用`accept`它来给它一个要存储的值。

# actionscript-3 - 客户端与服务器的通信与动作脚本

> ID：14614560
> 
> 赞同：0
> 
> 时间：2013-01-30T21:54:31.940
> 
> 标签：actionscript-3, flash, client-server

我正在寻找一个小建议。我想构建一个实时视频聊天应用程序。我真的不确定用户发送文本数据消息的最佳选择是什么。

我已阅读有关 SharedObject.send 方法和 NetConnection.call() 的教程，以便客户端与服务器对话。但是，我仍然不清楚有什么区别？请原谅我这个问题的简单性，但我是一个新手，如果用户不断地来回发送消息，这两种选择可以在聊天应用程序中工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T07:00:19.100

你必须在 Google 中输入**AS3 视频聊天**，你会得到你想要的一切

我发现

1.  [使用 as3 进行简单的视频聊天](https://stackoverflow.com/questions/9869007/simple-video-chat-using-as3)
2.  [http://www.ironcoding.com/2011/02/flash-as3-video-chat-using-adobe-lccs/](http://www.ironcoding.com/2011/02/flash-as3-video-chat-using-adobe-lccs/)

来自 red5.org

> Red5 Media Server 1.0 为 ©Adobe ©Flash Player 和其他令人兴奋的客户端技术提供了强大的视频流和多用户解决方案。

你当然会发现更多的选择。我的意思是，如果我想构建一个视频聊天应用程序，我会这样开始 :-)

# php - 是否可以为派生类创建静态属性，而不是为派生自它的所有类创建静态属性？

> ID：14614563
> 
> 赞同：1
> 
> 时间：2013-01-30T21:54:40.457
> 
> 标签：php, inheritance, static, dynamic-binding

我正在尝试实现这样的事情：

```
$child1_instance1 =  new \aae\web\ChildOne();
$child1_instance2 =  new \aae\web\ChildOne();
$child2_instance1 =  new \aae\web\ChildTwo();
$child2_instance2 =  new \aae\web\ChildTwo();

// setting the static variable for the first instance of each derived class
$child1_instance1->set('this should only be displayed by instances of Child 1');
$child2_instance1->set('this should only be displayed by instances of Child 2');

// echoing the static variable through the second instance of each drived class
echo $child1_instance2->get();
echo $child2_instance2->get();

//desired output:
this should only be displayed by instances of Child 1
this should only be displayed by instances of Child 2

// actual output:
this should only be displayed by instances of Child 2
this should only be displayed by instances of Child 2 
```

具有与此类似的类结构：（我知道这不起作用。）

```
abstract class ParentClass {
    protected static $_magical_static_propperty;

    public function set($value) {
        static::$_magical_static_propperty = $value;
    }
    public function get() {
        return static::$_magical_static_propperty;
    }
}

class ChildOne extends ParentClass { }

class ChildTwo extends ParentClass { } 
```

如何为每个子类创建不跨兄弟共享的静态变量？

我希望能够这样做的原因是能够跟踪每个派生类应该只发生一次的事件，而不必让从我的父类派生的客户端担心所说的实现跟踪功能。但是，如果所述事件发生，客户应该能够检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:15:16.860

`$_magical_static_propperty`在and之间**共享**，因此第二个输入将胜过第一个输入，并且两者都将显示相同的内容。`ChildOne``ChildTwo`

演示：[http ://codepad.viper-7.com/8BIsxf](http://codepad.viper-7.com/8BIsxf)

* * *

解决它的唯一方法是给每个孩子一个受保护的静态变量：

```
class ChildOne extends ParentClass { 
    protected static $_magical_static_propperty;
}

class ChildTwo extends ParentClass { 
    protected static $_magical_static_propperty;
} 
```

演示：[http ://codepad.viper-7.com/JobsWR](http://codepad.viper-7.com/JobsWR)

# base64 - 如何将 turbogears 中的原始图像数据传递给 scr=data:image/jpg 的 mako 模板

> ID：14614565
> 
> 赞同：0
> 
> 时间：2013-01-30T21:54:48.670
> 
> 标签：base64, mako, turbogears, turbogears2

我想将 TurboGears2 中的原始图像数据传递给 mako 模板以在 img 标签中使用

（即，scr=data:image/jpg,base64,${imagedata}）。

图片是从sql server图片格式中获取的

我一直在努力做到这一点，因为传递给模板的所有内容都是 unicode，当模板尝试打开它时，我得到“UnicodeDecodeError:'ascii' codec can't decode byte...”。

这将在多次调用 /image?image#x.jpg 时节省大量时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T00:18:40.483

以下在修改`quickstart`基于 TurboGears 2.2.2 的项目时有效，配置为使用 Mako 模板系统。首先，我对以下内容进行了一些更改`example/controllers/root.py`：

```
# …
from tg import config
import os
import base64

class RootController(BaseController):
    # …
    def _file_to_base64(self, path):
        with open(path, 'r') as stream:
            image_data = base64.b64encode(stream.read())

        return 'data:image/{0};base64,{1}' \
               .format(path.rsplit('.', 1)[-1].lower(), image_data)

    @expose('example.templates.index')
    def index(self):
        """Handle the front-page."""

        filename = os.path.join(config['paths']['static_files'],
                                'images', 'turbogears_logo.png')

        return dict(page='index', image_data=self._file_to_base64(filename)) 
```

那么make模板中的代码就变成了：

```
<img src="${image_data}" /> 
```

上面的代码是使用 Python 2.7.3 测试的。我不知道您的数据库图像格式或编码与从普通图像文件加载的数据有何不同。

# mysql - 在 WHERE 子句中使用 CASE

> ID：14614573
> 
> 赞同：47
> 
> 时间：2013-01-30T21:54:59.380
> 
> 标签：mysql, sql

我的查询的简化版本

```
SELECT *
FROM logs 
WHERE pw='correct' AND CASE WHEN id<800 THEN success=1 ELSE END 
AND YEAR(timestamp)=2011 
```

这不起作用。我要做的是`success=1`仅添加带有 的行`id<800`，否则忽略此检查。

我怎么写这个？谢谢！

编辑：澄清一下，这就是表格的样子

```
|id  | pw      | success |
--------------------------
|700 | correct | 1       |
|710 | correct | 1       |
|900 | correct | NULL    |
|999 | correct | 0       | 
```

我正在尝试返回所有行，`pw`不能忽略该列。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2013-01-30T21:57:53.673

您不必使用 CASE...WHEN，您可以使用 OR 条件，如下所示：

```
WHERE
  pw='correct'
  AND (id>=800 OR success=1) 
  AND YEAR(timestamp)=2011 
```

这意味着如果 id<800，成功必须为 1 才能将条件评估为真。否则，无论如何它都会是真的。

它不太常见，但是您仍然可以使用 CASE WHEN，如下所示：

```
WHERE
  pw='correct'
  AND CASE WHEN id<800 THEN success=1 ELSE TRUE END 
  AND YEAR(timestamp)=2011 
```

这意味着：`success=1`在 id<800 的情况下返回（可以是 TRUE 或 FALSE），否则总是返回 TRUE。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-03-25T10:18:08.487

```
SELECT *
FROM logs
WHERE pw='correct'
  AND CASE
          WHEN id<800 THEN success=1
          ELSE 1=1
      END
  AND YEAR(TIMESTAMP)=2011 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-01-30T22:05:07.640

这是工作的 Oracle 示例，但它也应该在 MySQL 中工作。

您缺少 smth - 请参阅 END 后的 IN 将 'IN' 替换为 '=' 符号以获得单个值。

```
SELECT empno, ename, job
  FROM scott.emp
 WHERE (CASE WHEN job = 'MANAGER' THEN '1'  
         WHEN job = 'CLERK'   THEN '2' 
         ELSE '0'  END) IN (1, 2) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-30T21:58:25.363

您可以将逻辑含义转换`A => B`为`NOT A or B`. 这是最基本的逻辑规律之一。在您的情况下，它是这样的：

```
SELECT *
FROM logs 
WHERE pw='correct' AND (id>=800 OR success=1)  
AND YEAR(timestamp)=2011 
```

我也转换`NOT id<800`为`id>=800`，这也很基本。

# python - Django：扩展 url 路径时 {{STATIC_URL}} 标签不起作用

> ID：14614577
> 
> 赞同：0
> 
> 时间：2013-01-30T21:55:26.547
> 
> 标签：python, django, url, django-templates

我`{{STATIC_URL}}`在我的模板中到处使用（为了简单起见，我们将使用主页作为示例）。因此，我有一个名为“home_base.html”的父模板，它在以下情况下使用该标签：

```
<script src="{{STATIC_URL}}js/plugins.js">
<img src={{STATIC_URL}}img/blah.jpg> 
```

在我的 urls.py 文件中，我有两个*指向同一个视图的*url ：

```
url(r'^home/$', 'homepage.views.HomeView'),
url(r'^home/x/$', 'homepage.views.HomeView', {'x': '3'}), 
```

当我访问 mysite.com/home 时，一切正常。但是，当我访问 mysite.com/home/x 时，找不到应用程序的静态文件夹中的文件。对于模板中的每个静态文件，我得到如下所示的错误：

```
[30/Jan/2013 13:04:20] "GET /homepage/static/js/plugins_functions.js HTTP/1.1" 404 7325
[30/Jan/2013 13:04:20] "GET /homepage/static/js/backb_global.js HTTP/1.1" 404 7310 
```

似乎它`/homepage/`在开始......通常它会得到`/static/js...`

**我发现它与向 url path 添加东西有关**，因为如果我将 url 更改为如下所示，一切都会完美运行：

```
url(r'^home/$', 'homepage.views.HomeView'),
url(r'^x/$', 'homepage.views.HomeView', {'x': '3'}), 
```

* * *

为什么当我在 url 中添加斜杠时一切都搞砸了？我该如何解决？我真的很想像这样将东西添加到家中：`url(r'^home/add/stuff/to/address/$'`，并且所有`{{STATIC_URL}}`标签仍然有效。

请记住，我将此父模板用作许多其他模板的基础，因此我可以添加到 url 的路径并将`{{STATIC_URL}}`标签保留在 home_base.html 文件中，这对我来说很重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:28:11.193

尝试转义字符串变量

```
{{STATIC_URL|safe}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:29:40.620

你检查了[https://docs.djangoproject.com/en/dev/howto/static-files/](https://docs.djangoproject.com/en/dev/howto/static-files/)它说：

> 如果 {{ STATIC_URL }} 在您的模板中不起作用，您可能在渲染模板时没有使用 RequestContext。

和：

> 确保 'django.core.context_processors.static' 在您的 TEMPLATE_CONTEXT_PROCESSORS 中。

# c# - C# - 在程序控制台中创建一个列表，它引用一个类

> ID：14614580
> 
> 赞同：0
> 
> 时间：2013-01-30T21:55:39.467
> 
> 标签：c#, list, class, types

我必须创建一个`list`25 名员工。每一个都可能有不同的属性，例如薪水、佣金、基本工资、每小时等。现在我必须`list`在程序控制台中创建并将其引用回员工类型。问题是员工`class`需要`abstract`，我不知道该怎么做。所以我做了以下事情：

```
List<string> empList = new List<string>(); 
```

现在这种语法可能有效，但我不认为这正是我的教授正在寻找的。任何帮助都会非常棒。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T21:59:08.403

```
namespace EmployeeExample
{
    public abstract class Employee
    {
        public abstract double Earnings { get; }

        public string Name { get; set; }
        public double Sin { get; set; }
        //public string Earnings { get; }

        public Employee(string name, double sin, double earnings)
        {
            Name = name;
            Sin = sin;
            Earnings = earnings;
        }
    }
} 
```

# inheritance - 骨干.js 模型继承

> ID：14614582
> 
> 赞同：3
> 
> 时间：2013-01-30T21:55:42.193
> 
> 标签：inheritance, backbone.js, backbone-model

我有一个骨干模型

```
var app = app || {};

app.Era = Backbone.Model.extend({

    defaults: {
        from: Number.NEGATIVE_INFINITY,
        until: Number.POSITIVE_INFINITY,
        stash: {
            from: null,
            until: null
        },
        _enabled: true
    },

    toggle: function(){
        if(this.get('_enabled')){
            this.disable();
        }else{
            this.enable();
        }

        this.save();
    },

    enable: function(){
        this.from = this.stash.from;
        this.until = this.stash.until;

        this.stash.from = null; // strictly speaking unnecssary
        this.stash.until = null;

        this._enabled = true;
    },

    disable: function(){
        this.stash.from = this.from;
        this.stash.until = this.until;

        this.from = null;
        this.until = null;

        this._enabled = false;
    },

    enabled: function(){
        return this._enabled;
    },

}); 
```

我试图像这样扩展

```
Name = app.Era.extend({ defaults: { value: '' } }); 
```

这似乎有效，我在控制台中没有错误。我什至可以实例化一个新名称，但是当我尝试实例化一个新名称时，我收到一条错误消息：

```
> era = new app.Era()
child
> era.get('from')
-Infinity
> Name = app.Era.extend({ defaults: { value: '' } })
function (){ return parent.apply(this, arguments); }
> name = new Name()
child
> name.get('value')
TypeError: Object [object Object] has no method 'get' 
```

我将不胜感激一些反馈！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-30T22:15:23.850

***编辑：****这很可能是一个不错的答案，但不是针对这个特定问题...正确答案由 Bryan Clark 提供。无论如何，我都会把它留在这里，因为虽然我误解了你的问题，但它描述了一个常见问题的解决方案，无论如何可能会对你有所帮助。*

骨干继承通过修改构造函数的原型来工作。当您扩展模型并重新定义`defaults`属性时，它不会将`Name.defaults`属性合并到`Era.defaults`，而只是将其隐藏。

考虑一个简化的例子：

```
var Era = Backbone.Model.extend({ name: "Era" });
var Name = Era.extend({ name: "Name" });
console.log(new Name().name); //-> "name", makes sense, right? 
```

要将派生类合并`defaults`到超类，您可以利用[`Model.defaults`可以定义为函数](http://backbonejs.org/#Model-defaults)和对象字面量的事实。

```
var Era = Backbone.Model.extend({ 
  defaults: {
    //..
  } 
});

var Name = Era.extend({ 
  //define defaults as a function
  defaults: function() {
    //copy the superclass defaults into a new object, and
    //then extend that with the new defaults
    return _.extend({}, Era.prototype.defaults, {
      value:''
    });
  }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T22:26:32.153

你不能`name`在那种情况下使用，你会遇到`window.name`. 如果您从头开始没有小写名称变量，您应该运行得很好。此外，fencliff 在如何使用默认继承方面提出了很好的观点。

# java - 是否可以从参数中的对象启动 Java 中的线程？

> ID：14614585
> 
> 赞同：0
> 
> 时间：2013-01-30T21:55:47.313
> 
> 标签：java, multithreading

有可能在Java中做这样的事情吗？我是在想。

首先，我只是创建一个具有一个参数的新线程。

```
Thread thread = new Thread(new Person()); 
```

然后，在 Person() 的构造函数中，我想启动该线程。那么这样的事情可能吗？

```
public Person() {
    // Here belongs some code for the constructor and then
    // I would like to start the thread
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T21:58:52.373

不，你不能。在 Java 可以调用`Thread()`构造函数之前，它首先必须急切地评估所有参数，包括对`Person()`构造函数的调用。这意味着在`Person`调用构造函数时，外部`Thread`对象甚至不存在或尚未初始化，因此您无法真正使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:00:09.097

不。

您没有对`Person`构造函数内部线程的引用。所以，线程仍然不存在。

即使你有它，做类似的事情

```
 public Person() {
   Thread a = new MyThread(this);
 } 
```

是不好的做法，因为您传递的实例 ( `this`) 可能尚未完全初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:11:10.410

这是你想要的？请注意使用`{start()}`which 避免了`start`在构造函数中调用的所有问题。

```
 new Thread() {
    { start(); }
    public void run() {
     ...
    }
  }; 
```

[你可以在这里](http://www.javaspecialists.eu/archive/Issue149.html)看到原文。

# php - 不断收到数组到字符串的转换通知，但看不到原因

> ID：14614586
> 
> 赞同：0
> 
> 时间：2013-01-30T21:55:52.080
> 
> 标签：php, mysql

我不断收到一个数组到字符串转换的通知，这似乎是我已经转义（或没有转义）MySQL 语句的方式。如果我不使用 PHP 变量并将数据作为文本放入它可以工作，但使用变量它会显示错误。帮助！:)

```
function lastBackupStatus($server,$node){
  $serverstatus = "";
  $i=1;
  $result = mysql_query("select
    max(case when status LIKE '%Failed%' then scheduled_start end) Last_Failed,
    max(case when status LIKE '%Missed%' then scheduled_start end) Last_Missed,
    max(case when status LIKE '%Completed%' then scheduled_start end) Last_Completed,
    node_name,
    schedule_name
    from `events_".$server."`
    where node_name='".$node."'
    group by node_name, schedule_name
    ORDER BY last_failed");
  $count=mysql_num_rows($result);
  if ($count!== 0){
    while ($info = mysql_fetch_assoc( $result )){
      if($i < $count){
        $serverstatus .="";//do nothing
      }else{
        if($info['Last_Failed']  > $info['Last_Completed']){
          if($info['Last_Failed'] > $info['Last_Missed']){
            $serverstatus .="Failed:". $info['Last_Failed'].
              $info['node_name'].$info['schedule_name']."</br>";
          }
        }
        if($info['Last_Missed'] > $info['Last_Completed']){
          if ($info['Last_Missed'] > $info['Last_Failed']){
            $serverstatus .=" Missed: ". $info['Last_Failed'].
              $info['node_name'].$info['schedule_name']."</br>";
          }
        }
      }
      $i++;
    }
  } else {
    $serverstatus .= "count is 0";
  }
  return $serverstatus;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:58:01.973

您忘记了`AS`关键字：

```
max(case when status LIKE '%Failed%' then scheduled_start end) Last_Failed, 
max(case when status LIKE '%Missed%' then scheduled_start end) Last_Missed,
max(case when status LIKE '%Completed%' then scheduled_start end) Last_Completed, 
```

应该

```
max(case when status LIKE '%Failed%' then scheduled_start end) AS Last_Failed, 
max(case when status LIKE '%Missed%' then scheduled_start end) AS Last_Missed,
max(case when status LIKE '%Completed%' then scheduled_start end) AS Last_Completed, 
```

因此`$info['Last_Failed']`没有关联索引等。

根据您的评论，它`$node`毕竟是一个数组，您需要替换它：

```
where node_name='".$node."' 
```

有了这个：

```
where node_name='".$node['node_name']."' 
```

# .net - 在 .NET 中以编程方式添加 Xaml 形状/路径

> ID：14614590
> 
> 赞同：1
> 
> 时间：2013-01-30T21:56:00.000
> 
> 标签：.net, wpf, silverlight, xaml, windows-store-apps

我正在使用 XAML 和 VB 为 Windows 8 设计一个应用程序，但我认为这个问题也可能适用于 Silverlight 和 WPF。

我可以在绘图应用程序中创建一个形状，然后另存为 XAML 以获得必要的代码，以便在 Visual Studio 2012 的 XAML 代码编辑器中重新创建此形状。

例如以下产生一个测试形状：

```
 <Path Stroke="Black" Fill="Gray"
    Data="M 10,100 C 10,300 300,-200 300,100"  Grid.Row="1"/> 
```

我希望能够使用来自 Data 属性的信息以编程方式创建此形状。

到目前为止，我已经研究了这个[LINK](http://msdn.microsoft.com/en-us/library/system.windows.media.pathgeometry.aspx)，它解释了 PathGeometry 类。但是，它似乎使用了不同的方法。

我要问的是是否有办法获取 Data 属性并将其粘贴到属性中以在 VB 中创建形状。或者，如果有另一种方法可以做到这一点，我会错过。

非常感谢帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T05:58:27.473

您可以使用[`XamlReader`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.markup.xamlreader.aspx)该类：

```
var path = XamlReader.Load("<Path Stroke=\"Black\" Fill=\"Gray\" Data=\"M 10,100 C 10,300 300,-200 300,100\" Grid.Row=\"1\" xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" />");
Canvas.Children.Add(path as UIElement); 
```

只需确保在要加载的 XAML 代码段中包含默认命名空间。`Canvas`是`Grid`我要添加的页面中的一个`Path`。

# regex - 从文本文件中删除长行 (Notepad++/EditPlus)

> ID：14614591
> 
> 赞同：4
> 
> 时间：2013-01-30T21:56:05.553
> 
> 标签：regex, file, text, notepad++, editplus

我有一个非常大的文本文件。此文本文件中的每一行都有一个完整的句子。现在我必须删除其中超过 x 个字符的每一行/句子，只保留带有 <=x 个字符的行。

这甚至可能吗？我可以用 Notepad++/EditPlus 或正则表达式来做到这一点吗？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-30T22:00:38.597

**这是记事本++的解决方案**

在搜索模式中选择“正则表达式”。确保“。匹配换行符”复选框**未选中**。

找什么：`.{x}.+`

替换为：（空）

如果您不想在替换后留下空行：

找什么：`.{x}.+(\r?\n|\n|$)`

替换`x`为您选择的数字。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-30T22:02:13.247

使用 bash：

```
$ awk '{if (length($0) <= x) print $0; }'  myfyle.txt 
```

长在哪里`x`。它将打印小于`x`.

请参阅[awk 教程和介绍](http://www.grymoire.com/Unix/Awk.html)了解更多 awk 好东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-09T09:41:29.840

这是 Editplus 3.70 版的解决方案。

如果要保留 <= 200 的行，以下将删除任何 201 个字符或更多字符的行。

*   查找内容：**^.{201,}.*\n**
*   留空替换
*   检查正则表达式

注意 201 后面的逗号。

# mysql - 安装后mysql登录[错误1045（28000）：用户'mike'@'localhost'的访问被拒绝（使用密码：YES）]

> ID：14614593
> 
> 赞同：0
> 
> 时间：2013-01-30T21:56:13.933
> 
> 标签：mysql, login, installation

使用带有山狮的mac，我刚刚安装了mysql。我现在正在尝试使用以下命令登录

```
mysql -u mike -p 
```

但得到以下错误：

```
ERROR 1045 (28000): Access denied for user 'mike'@'localhost' (using password: YES) 
```

我参考了以下 SO 问题和答案：[MySQL ERROR 1045 (28000): Access denied for user 'bill'@'localhost' (using password: YES)](https://stackoverflow.com/questions/10299148/mysql-error-1045-28000-access-denied-for-user-billlocalhost-using-passw)

基于所有这些答案，我需要在 mysql 命令行中创建一个新的本地用户，但是如果我无法访问`mysql>`（命令行），我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:00:11.360

默认情况下，`root`用户在 MySQL 中没有密码（除非您在安装期间在 mysql 中设置了 root 密码）。尝试像这样登录：

```
mysql -u root 
```

`-p`注意论点的排除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:16:26.413

尝试使用：

```
$ mysql -u root -e "CREATE USER 'mike'@'localhost' IDENTIFIED BY PASSWORD 'secret';"; 
```

然后查看[授予语法](http://dev.mysql.com/doc/refman/5.5/en/grant.html)以设置适当的权限。

# matlab - 具有可变长度参数列表的匿名函数

> ID：14614600
> 
> 赞同：12
> 
> 时间：2013-01-30T21:56:42.693
> 
> 标签：matlab, anonymous-function

我可以创建一个接受可变数量参数的匿名函数吗？

我有一个`S`带有特定字段的结构数组，比如说，`bar`我想将所有`bar`值传递给我的匿名函数`foo`。由于 struct 中的元素数量`S`未知，`foo`因此必须能够接受可变数量的参数。

我能想到的最接近的事情是将单元数组作为输入参数列表传递：

```
foo({arg1, arg2, arg3, ...}) 
```

我正在调用它`foo({S.bar})`，但它看起来很尴尬。

为此创建一个特殊的 m 文件似乎有点过头了。还有其他想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-30T21:59:49.257

使用`varargin`匿名函数的参数，您可以传递可变数量的输入。

例如：

```
foo = @(varargin)fprintf('you provided %i arguments\n',length(varargin)) 
```

用法

```
s(1:4) = struct('bar',1);
foo(s.bar)

you provided 4 arguments 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T21:59:34.090

*   matlab 中称为[varargin](http://www.mathworks.com/help/matlab/ref/varargin.html)的 va_arg是链接的内容：

> varargin 是函数定义语句中的输入变量，它允许函数接受任意数量的输入参数。

```
function varlist(varargin)
   fprintf('Number of arguments: %d\n',nargin);
   celldisp(varargin)

varlist(ones(3),'some text',pi)

Number of arguments: 3

varargin{1} =
     1     1     1
     1     1     1
     1     1     1

varargin{2} =
some text

varargin{3} =
    3.1416 
```

*   [将匿名函数定义为 m 文件函数的 4 个输出中的 2 个](https://stackoverflow.com/questions/3673392/define-anonymous-function-as-2-of-4-outputs-of-m-file-function)

# java - 在 Button 上添加 TextView？

> ID：14614611
> 
> 赞同：1
> 
> 时间：2013-01-30T21:57:35.457
> 
> 标签：java, android

我正在构建一个显示大联系人照片的联系人应用程序。我需要在按钮顶部（靠近底部）添加一个带有每个联系人姓名的标签，但是我不知道如何让两个视图相互叠加。我不能简单地使用 settext，因为我需要为标签添加半透明背景。

* * *

编辑：我设法把它放在顶部，但我不知道如何把它放在按钮的底部。

```
RelativeLayout icon = new RelativeLayout(context);
// Create button
Button button = new Button(context);
button.setLayoutParams(new    LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.MATCH_PARENT));
layout.addView(button);
// Create label
TextView label = new TextView(context);
label.setText(name);
label.setBackgroundColor(Color.argb(120, 0, 0, 0));
label.setLayoutParams(new      LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.WRAP_CONTENT));
icon.addView(button);
icon.addView(label); 
```

但是文本出现在图像的顶部，我希望它像这样在底部：

![在此处输入图像描述](../Images/aa2fb55287ccc66bb9e61b229420282d.png)

使用 xml 这将类似于：`android:layout_alignBottom="@+id/myButton"`但我正在以编程方式执行此操作，但我还没有找到一种方法来做到这一点。如何将标签放在按钮附近？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:12:28.827

试试这个

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center" >

        <Button
            android:id="@+id/button1"
            android:layout_width="200dp"
            android:layout_height="wrap_content"
            android:gravity="right"
            android:text="John"
            android:background="@drawable/button_action_active" />

        <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center"
            android:text="test textView" />

    </FrameLayout>

</LinearLayout> 
```

![上述代码的示例屏幕截图](../Images/d0f749600524d275990fbbefde33d468.png)

**动态地，您可以通过**

```
 TextView lable = new TextView(this);  
        lable.setLayoutParams(new LayoutParams(android.widget.LinearLayout.LayoutParams.WRAP_CONTENT, android.widget.LinearLayout.LayoutParams.WRAP_CONTENT));  
        lable.setTextSize(25);  
        lable.setGravity(Gravity.CENTER);  
        lable.setText("John");  

        Button button = new Button(this);  
        button.setBackgroundResource(R.drawable.button_action_active);  
        button.setLayoutParams(new LayoutParams(android.widget.LinearLayout.LayoutParams.MATCH_PARENT, android.widget.LinearLayout.LayoutParams.WRAP_CONTENT));  

        FrameLayout fl = new FrameLayout(this);  
        fl.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));  
        fl.addView(button);  
        fl.addView(lable);  

        setContentView(fl); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-30T22:15:46.027

为此，您可以使用框架布局。框架布局的文档可以在这里找到 - [http://developer.android.com/reference/android/widget/FrameLayout.html](http://developer.android.com/reference/android/widget/FrameLayout.html)

但是，框架布局已贬值（如果我没记错的话）。因此，我建议使用相对布局。在您的相对布局中，您可以设置按钮的位置，然后为 textview 提供属性`android:layout_alignLeft=@id/something`和`android:layout_alignRight="@id/Something"`

# windows - 递归显示最近 45 天内修改的所有文件的频率分布

> ID：14614614
> 
> 赞同：1
> 
> 时间：2013-01-30T21:57:39.723
> 
> 标签：windows, powershell, batch-file

我正在尝试将这两个脚本放在一起：

这一个列出了所有目录中的所有文件：

```
dir -recurse | group-object Extension -noelement 
```

这个列出了在某个日期之后修改的所有文件：

```
get-childitem –recurse | where-object {$_.lastwritetime -gt “1/13/2008”} 
```

我的问题是第二个脚本为每个目录输出一个标题：

```
Mode                LastWriteTime     Length Name                                                                      
----                -------------     ------ ----                                                                      
d----        12/10/2012  11:21 AM            BUDGET                                                                    
d----        12/21/2012  12:38 PM            SPEND DOWN                                                                

    Directory: \\file\property\vt\Environmental Services\BUDGET\SPEND DOWN

Mode                LastWriteTime     Length Name                                                                      
----                -------------     ------ ----                                                                      
d----        12/13/2012  12:32 PM            2012                                                                      
d----         1/29/2013   9:50 AM            2013                                                                      

    Directory: \\le\property\vt\Environmental Services\BUDGET\SPEND DOWN\2012 
```

我试着像这样把它们放在一起：

```
dir -recurse | group-object Extension -noelement | where-object {$_.lastwritetime -gt (Get-date).AddDays($somenumber)} 
```

但这并没有产生任何结果。

如何在所有目录中递归地列出自某一天以来所有不同类型文件的计数？

这是我的预期输出：

```
4352    .JPG
2352    .doc
2135    .pdf
1811    .xls
1472    
857 .pub
732 .xlsx
565 .docx
66  .rtf
64  .lnk
63  .ppt
61  .url
41  .png
38  .xml
28  .htm
27  .msg 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:04:39.370

`dir`并且`gci`都是`Get-ChildItem`cmdLet 的别名。分组前过滤：

```
gci -Recurse| where {$_.LastWriteTime -gt (Get-Date).AddDays(-45)}| group Extension -NoElement 
```

# android - 正在调用 Textview onClick 而不是 Listview onItemClick。

> ID：14614621
> 
> 赞同：4
> 
> 时间：2013-01-30T21:57:56.750
> 
> 标签：android, events, android-listview, listener

好的，我已经搜索并看到了类似的问题，尝试了它们但无济于事。我有一个包含一些元素的 listView，我想单击一个元素并在其他地方显示详细信息。

这是我的列表视图

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_pedidos);

    ListView listView = (ListView) findViewById(R.id.actualStoresList);

    Model.initialize();
    Vector<String> values = Model.stores;

       listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> adapter, View view, int position,
                    long id) {
                Object o = adapter.getItemAtPosition(position);
                String str_text = o.toString();
                Log.i("", "I have selected this: " + str_text);
            }

        });

    CustomStringAdapter adapter = new CustomStringAdapter(this, R.layout.my_list_layout, R.id.list_content, values);
    listView.setAdapter(adapter);
} 
```

这是 my_list_layout.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:gravity="center_vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

<TextView
    android:id="@+id/list_content"
    android:textColor="#000000"
    android:gravity="center"
    android:layout_margin="4dip"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:textSize="20dp"/>

</LinearLayout> 
```

列表会正确显示。当我单击列表的一个元素（A textView）时，它“窃取”了单击事件，因此什么也没有发生（onItemClickListener 附加到 listView，而不是 TextView）。

textView 有一个小边距，如果小心的话，我可以在它后面单击，实际上是在触摸 listView。在这种情况下，事件被触发，我看到了日志。

我尝试将 TextView 设置为 android:focusable="false" 但仍然，TextView 位于 listView 的“上方”，并且始终获取点击事件。

如何使 TextView “透明”以便它实际单击 listView，或者向 TextView 添加一个 onclickListener 以便我可以处理它的事件？

谢谢！

亚历杭德罗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:14:10.387

将`clickable`属性设置`TextView`为 false 应该可以解决这个问题。尝试这个：

```
<TextView
    android:id="@+id/list_content"
    android:textColor="#000000"
    android:gravity="center"
    android:layout_margin="4dip"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:textSize="20dp"
    android:clickable="false" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:09:26.807

要使项目不可聚焦，请执行以下操作：

```
listView.setItemsCanFocus(false); 
```

[资源](http://developer.android.com/reference/android/widget/ListView.html#setItemsCanFocus%28boolean%29)

我认为这将解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-09T20:24:19.170

还要确保

```
android:textIsSelectable 
```

属性未设置为 true。

# ios - iOS 6 NavigationController 未加载

> ID：14614625
> 
> 赞同：0
> 
> 时间：2013-01-30T21:58:10.440
> 
> 标签：ios, uinavigationcontroller

我有一个从 iOS 5 迁移到 iOS 6 的应用程序，但遇到 UINavigationController 无法正确显示的问题。

在我的应用程序中，用户必须登录，并且在按下按钮后会在模式视图中显示登录屏幕。

```
WelcomeViewController.m
- (IBAction)signInButtonSelected:(id)sender
{
LoginViewController *loginViewController = [[LoginViewController alloc] initWithNibName:nil bundle:nil];
[self.navigationController presentViewController:loginViewController animated:YES completion:^{}];
} 
```

视图正确加载并允许用户输入他们的登录凭据。但是，当他们按下登录按钮时，会显示下一个视图，并且它应该在顶部有一个 UINavigationBar，除非它没有。如果我退出应用程序并重新启动它，UINavigationBar 会正确显示在该视图中。我不知道为什么从登录视图到登录屏幕会隐藏导航控制器。

这是按下登录按钮时执行的代码，用于加载下一个视图：

```
LoginViewController.m
WallViewController *wallViewController = [[WallViewController alloc] initWithNibName:nil bundle:nil];
         [(UINavigationController *)self.presentingViewController pushViewController:wallViewController animated:YES];
         [self.presentingViewController dismissViewControllerAnimated:YES completion:nil]; 
```

如果有人可以解释为什么会发生这种情况，那就太好了！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:52:24.153

弄清楚了。在我的 App Delegate 中，我放置了：

```
navController.navigationBar.hidden = YES; 
```

它会在用户登录后隐藏导航栏。不完全确定为什么应用程序委托中的这会影响以后的视图。但是一旦它被删除，它就可以完美地工作！

谢谢您的帮助！

# ios - ios - 带有 sortDescriptors 的 NSFetchResultsController 错误

> ID：14614627
> 
> 赞同：0
> 
> 时间：2013-01-30T21:58:27.527
> 
> 标签：ios, exception, core-data, nsfetchedresultscontroller, nssortdescriptor

我有一个表视图控制器，其中包含由 fetchResultsController 处理的 Formations 列表。

这是我的核心数据实体的样子：

![在此处输入图像描述](../Images/f708f5880887eae5dadd0903f885a11d.png)

我尝试`dateRange`像这样对我的 fetchResultsController 进行排序：

```
// |fetchedResultsController| custom setter
- (NSFetchedResultsController *)fetchedResultsController {
    if (_fetchedResultsController != nil) {
        return _fetchedResultsController;
    }

    _fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:self.fetchRequest managedObjectContext:self.mainManagedObjectContext sectionNameKeyPath:@"dateRange" cacheName:kFormationsFetchedCacheName];
    _fetchedResultsController.delegate = self;

    return _fetchedResultsController;
}

// |fetchRequest| custom setter
- (NSFetchRequest *)fetchRequest {
    if (_fetchRequest != nil) {
        return _fetchRequest;
    }

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"student == %@", self.currentStudent];
    NSSortDescriptor *dateDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"dateRange" ascending:NO];
    NSSortDescriptor *nameDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"name" ascending:NO];

    _fetchRequest = [[NSFetchRequest alloc] initWithEntityName:kBSFormation];
    _fetchRequest.predicate = predicate;
    _fetchRequest.sortDescriptors = [NSArray arrayWithObjects: dateDescriptor, nameDescriptor, nil];

    return _fetchRequest;
} 
```

当我尝试添加第一个时一切都很好`Formation`，但是对于接下来的，我有这些错误：

```
2013-01-30 22:43:08.370 [7202:c07] -[BSDateRange compare:]: unrecognized selector sent to instance 0x81781a0

2013-01-30 22:43:08.371 [7202:c07] CoreData: error: Serious application error.  Exception was caught during Core Data change processing.  This is usually a bug within an observer of NSManagedObjectContextObjectsDidChangeNotification.  -[BSDateRange compare:]: unrecognized selector sent to instance 0x81781a0 with userInfo (null)

2013-01-30 22:43:08.372 [7202:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[BSDateRange compare:]: unrecognized selector sent to instance 0x81781a0' 
```

如果我评论这一行：`NSSortDescriptor *dateDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"dateRange" ascending:NO];`，它正在工作，但我的表格视图很乱，因为`sectionNameKeyPath`设置为`dateRange`

有人在弄清楚这里有什么问题吗？：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:58:15.360

您是在告诉它根据`dateRange`关系进行排序。但是`dateRange`与 有关系`BSDateRange`吗，Core Data 如何比较它们？它应该使用`from`，或者也许`to`，或者它们的某种组合？您不能只告诉它对这样的对象进行排序，因为排序应该如何工作并不明显。

相反，**首先**要弄清楚排序甚至意味着什么。然后适当地修改您的排序描述符。例如，如果您决定排序取决于`from`值，请将排序描述符更改为使用键路径`from`：

```
NSSortDescriptor *dateDescriptor = [NSSortDescriptor
    sortDescriptorWithKey:@"dateRange.from"
    ascending:NO]; 
```

如果您需要同时基于`from`和进行排序`to`，请使用多个排序描述符。

# c++ - k路三角形集交点和三角剖分

> ID：14614640
> 
> 赞同：15
> 
> 时间：2013-01-30T21:59:32.533
> 
> 标签：c++, performance, algorithm, graphics, computational-geometry

如果我们有 K 组可能重叠的三角形，那么计算一组新的、不重叠的三角形的高效计算方法是什么？

例如，考虑这个问题：

![镶嵌](../Images/9e0d04c3f44fdeabd250e648f4c4ec5c.png)

这里我们有 3 个三角形集合 A、B、C，有一些相互重叠，并希望获得不重叠的集合 A'、B'、C'、AB、AC、BC、ABC，例如 AC 中的三角形将包含 A 和 C 之间完全重叠的表面；和 A' 将包含不与任何其他集合重叠的 A 的表面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T16:05:51.110

我（也）提出了一个两步法。

**1\. 找出所有三角形边的交点。**

正如评论中所指出的，这是一个经过充分研究的问题，通常使用线扫描方法来解决。这是一个[非常好的概述](http://geomalgorithms.com/a09-_intersect-3.html)，特别是 Bentley-Ottmann 算法。

**2\. 使用受约束的 Delaunay 进行三角剖分。**

我认为@Claudiu 建议的多边形三角无法解决您的问题，因为它不能保证包含所有原始边缘。因此，我建议您查看[Constrained Delaunay triangulations](http://en.wikipedia.org/wiki/Constrained_Delaunay_triangulation)。这些允许您指定*必须*包含在三角剖分中的边，即使它们不会包含在无约束的 Delaunay 或多边形三角剖分中。此外，还有一些实现允许您指定三角剖分的非凸边界，在该边界之外不会生成三角形。在您的情况下，这似乎也是一个要求。

实现受约束的 Delaunay 并非易事。然而，CMU 研究人员提供了一个有点过时但[非常好的 C 实现](http://www.cs.cmu.edu/~quake/triangle.html)（包括命令行工具）。有关此特定算法的理论，请参见[此处](http://www.cs.cmu.edu/~quake/triangle.research.html)。该算法还支持边界的指定。请注意，链接算法可以做的不仅仅是Constrained Delaunay（即质量网格生成），但它可以配置为不添加新点，这相当于Constrained Delaunay。

**编辑**查看其他实现的注释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-05T05:47:26.717

如果你想要一些更直接、更快的实现和更少的代码......我建议只做一些简单的[多边形剪辑](http://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman)，就像过去的旧软件渲染算法一样（特别是因为你只处理三角形作为您的输入）。正如其他几个人简要提到的那样，它涉及在每个其他***线段***相交的点处拆分每个三角形。

三角形很容易，因为在给定平面上拆分三角形总是会产生 1 或 2 个新三角形（总共 2 或 3 个）。如果您的数据集相当大，您可以引入四叉树或其他形式的空间组织，以便在添加新三角形时更快地找到相交三角形。

![在此处输入图像描述](../Images/ccb16af6b4be0bdb3534af7d8672c077.png)

当然，这将生成比建议的[约束 Delaunay](http://en.wikipedia.org/wiki/Constrained_Delaunay_triangulation)算法更多的多边形。但是其中许多算法在重叠形状方面表现不佳，并且需要您了解轮廓段，因此无论如何您都会做很多相同的工作。

如果需要更少的结果三角形，您总是可以在最后进行合并传递（在剪辑期间添加相邻信息以加快该部分的速度）。

无论如何，祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T00:35:57.717

您的示例是计算几何学所说的“排列”的一个特例。[CGAL 库](http://cgal.org)具有广泛而有效的安排处理例程。如果您查看[文档的这一部分](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Arrangement_on_surface_2/Chapter_main.html#Section_32.8)，您会看到您可以声明一个空排列，然后插入三角形以将 2d 平面划分为不相交的面。正如其他人所说，然后您需要对还不是三角形的面进行三角剖分。令人高兴的是，CGAL 还提供了执行此操作的例程。 [这个受约束的 Delaunay 三角剖分示例](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Triangulation_2/Chapter_main.html#Subsection_37.8.2)是一个很好的起点。

CGAL 尝试使用可实现的最有效的算法。在这种情况下，对于具有 n 个边（在您的情况下是三角形数量的 3 倍）与 k 个相交的排列，您似乎可以实现 O((n + k) log n)。该算法使用一种称为“扫描线”的通用技术。一条垂直线从左到右扫过，沿途计算和处理“事件”。事件是边缘端点和交叉点。随着每个事件的处理，排列的一个单元格被更新。

对于 n 个顶点，Delaunay 算法通常是 O(n log n)。有几种常见的算法，很容易在 CGAL 参考资料中查找或找到。

即使您不能在您的工作中使用 CGAL（例如，出于许可原因），文档中也充满了底层算法的资源：安排和受约束的 Delaunay 算法。

但是请注意，由于浮点错误，排列和三角测量都很难正确实现。健壮的版本通常依赖于有理算术（在 CGAL 中可用）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T15:57:02.887

我可以想到两种方法。

一种更通用的方法是将您的输入视为一组行并将问题分成两部分：

1.  多边形检测。取一组你的初始三角形制作的线，得到一组不重叠的多边形。[本文](https://docs.google.com/viewer?a=v&q=cache%3aKXjmUkopCAoJ%3awww.researchgate.net/publication/2933997_Polygon_Detection_from_a_Set_of_Lines/file/79e41507ddec7cc0ae.pdf+&hl=en&gl=us&pid=bl&srcid=ADGEESgY81w6Gsi8X6NnMT2PH0IubL8fyY4rn5w5sPd5efuwqsfkdXxFhpKuese17ojwK9Kx9QLF5xkQCjJF_Zh5v89chm-Efw9bpe7fl1RwDwQ-efndPk4BEMK3Cj8vxWS0catetglM&sig=AHIEtbRYDap4Ud9a7OPfjbJ6F0Az8cpWnw)提供了一种 O((N + M)^4) 方法，如果 N 是线段的数量，M 是交叉点的数量，不幸的是这似乎有点慢......
2.  [多边形三角剖分](http://en.wikipedia.org/wiki/Polygon_triangulation)。从步骤 1 中取出每个多边形并对其进行三角剖分。这需要 O(n log* n)，实际上是 O(n)。

另一种方法是做一个自定义算法。解决两个三角形相交的问题，将其应用于前两个输入三角形，然后对于每个新三角形，将算法应用于所有当前三角形和新三角形。但是，即使对于两个三角形，这似乎也不是那么简单，因为有几种情况（可能并不详尽）：

1.  三角形的任何点都不在任何其他三角形中。
    1.  没有交叉路口
    2.  犹太明星
    3.  两个垂直尖刺
2.  一个三角形的一个点包含在另一个三角形中
3.  每个三角形包含另一个点
4.  一个三角形的两个点在另一个
5.  一的三点在另一个中——一个被完全包含

等等......不，这似乎不是正确的方法。无论如何都要留在这里给后代。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T16:11:54.940

为了扩展 Ted Hopp 的评论，这应该可以通过首先计算一个平面细分来实现，其中输出的每个有界面都与集合 A'、B'、C'、AB、AC、BC 中的一个相关联、ABC 或“无”。然后第二阶段是对每组中的（可能是非凸的）面进行三角剖分。

步骤 1 可以使用[Bentley-Ottmann](http://en.wikipedia.org/wiki/Bentley%E2%80%93Ottmann_algorithm)扫描线算法的变体在 O((N + K) log N) 时间内执行，其中将当前集合作为算法状态的一部分进行维护。这可以从已经穿过的线段及其方向来确定。

一旦完成，每个集合的不相交多边形就可以在 O(N log N) 时间内分解成单调片段，而这些片段又可以在 O(N) 时间内进行三角剖分。

如果您还没有，请阅读 de Berg 等人的“计算几何：算法和应用”。

# knockout.js - 淘汰赛验证视图模型绑定未显示正确错误

> ID：14614642
> 
> 赞同：0
> 
> 时间：2013-01-30T21:59:35.873
> 
> 标签：knockout.js, knockout-mapping-plugin, knockout-validation

更新以显示带有建议更改的工作示例，该更改将我的 viewModel 更改为根据 Thewads 建议验证的Observable。花了很长时间才让事情顺利进行，但它现在显示了正确的错误计数！

```
<fieldset>
    <legend>Test</legend>
     <label>First name: <input data-bind='value: model.Employee.FirstName'/></label>
     <label>Last name: <input data-bind='value: model.Employee.LastName'/></label>
    <button type="button" data-bind='click: buttons.submit'>Submit</button>
</fieldset>

<script>

my = {namespace: { }}
my.namespace.obj = function () {
    var bindingHandler = function (data) {

        initializeValidation = (function () {
            ko.validation.configure({
                registerExtenders: true,
                decorateElement: true,
                messagesOnModified: true,
                insertMessages: true,
                parseInputAttributes: true,
                messageTemplate: null,
                grouping: { deep: true }
            });
        })();

         viewModel = ko.validatedObservable({
             model: ko.mapping.fromJS(data),
             buttons: {
                 submit: function () {
                     if (viewModel.isValid()) {
                         alert('VM clean');
                     } else {
                         alert('Errors found');
                         viewModel.errors.showAllMessages();
                     }
                 }
             }

        });

         extendedValidators = (function () {
             viewModel().model.Employee.FirstName.extend({ minLength: 20, required: true });
             viewModel().model.Employee.LastName.extend({ minLength: 30, required: true });
         })();

         applyBindings = (function () {
             ko.applyBindings(viewModel);
         })();
    }
    return {
        fn: {
            Initialize: function (model) {
                bindingHandler(model);
            }
        }
    };
};

$(document).ready(function () {
    model = { "Employee": { "FirstName": "Joe", "LastName": "Shmoe" } };
    my.namespace.obj().fn.Initialize(model);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T09:25:44.797

您必须使用 validObservable 来正确验证，而不仅仅是普通的 observable。

会是这样的：

```
validationCheck = ko.validatedObservable( whatYouAreValidating() ) )
if (validationCheck.isValid() )
     //do your logic 
```

或者通过使用验证组：

```
validationGroupCheck = ko.validation.group( whatYouAreValidating())

if ( validationGroupCheck().length <= 0 )
    return true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T08:56:50.813

我根本无法让它运行。你能让它在 jsFiddle 中运行吗？

但是，看起来很奇怪的一件事是，您的代码中没有任何内容调用您的`extendedValidators`方法，因此我猜想验证器尚未初始化。除非它只是从您的帖子中丢失？

# javascript - 根据多个变量进行点击

> ID：14614643
> 
> 赞同：0
> 
> 时间：2013-01-30T21:59:37.070
> 
> 标签：javascript, jquery

通常，当我使用 javascript 进行点击时，它会如下所示：

```
$(document.elementFromPoint(x, y)).click(); 
$(document.getElementById('ID_HERE')).click(); 
```

现在，我遇到了一个问题，这些方法都不起作用。我有一个需要按下的按钮，它没有 ID，并且单击元素坐标似乎不起作用。这就是按钮的样子。

```
<input type="submit" value="I accept" onclick="SignUp.DoPost();return false;" title="I accept" class="default"> 
```

现在，HTML 中还有其他标题为“我接受”的元素。如果输入元素同时具有值​​和标题“我接受”，我如何让 javascript 单击？甚至可能在其中添加 onclick 以真正确保它选择正确的元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:03:33.147

```
document.querySelector('input.default[type="submit"][value="I accept"][title="I accept"]').click(); 
```

# c# - 为 string.Contains 构建表达式树

> ID：14614645
> 
> 赞同：7
> 
> 时间：2013-01-30T21:59:39.413
> 
> 标签：c#, .net-4.0, expression-trees

我正在努力构建表达式树，以便可以动态地对某些数据进行过滤。

我想出了这个，但它失败`var lambda =`了

```
foreach (var rule in request.Where.Rules)
{
    var parameterExpression = Expression.Parameter(typeof(string), rule.Field);
    var left = Expression.Call(parameterExpression, typeof(string).GetMethod("ToLower", Type.EmptyTypes));
    var right = Expression.Constant(rule.Data.ToLower());
    var method = typeof(string).GetMethod("Contains", new [] { typeof(string) });
    var call = Expression.Call(left, method, right);
    var lambda = Expression.Lambda<Func<T, bool>>(call, parameterExpression);
    query = query.Where(lambda);
} 
```

var`rule`有一个字段（例如“名称”），我想将其与`rule.Data`（例如“tom”）中的文本进行比较。因此，如果`T.Name.Contains("tom");`我希望查询包含记录，否则不会。

var`query`是类型`IQueryable<T>`

**编辑**：终于让它使用这个代码：

```
foreach (var rule in request.Where.Rules)
{
    var parameter = Expression.Parameter(typeof(T), "x");
    var property = Expression.Property(parameter, rule.Field);
    var value = Expression.Constant(rule.Data);
    var type = value.Type; 
    var containsmethod = type.GetMethod("Contains", new[] { typeof(string) });
    var call = Expression.Call(property, containsmethod, value);
    var lambda = Expression.Lambda<Func<T, bool>>(call, parameter);
    query = query.Where(lambda);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:09:59.793

您快到了，但是您的参数表达式应该是 type `T`，而不是`String`，您还缺少从`T`name 之类的类型获取属性的表达式。

你应该大致拥有的是这个

```
val -> Expression.Constant(typeof(string), rule.Field)
parameter -> Expression.Parameter(typeof(T), "p")
property -> Expression.Property(parameter, "PropertyName")
contains -> Expression.Call(property, containsmethod, val)
equals true -> Expression.True or equals, something like that 
```

我对所有这些都是徒手的，因此有效可能会有所不同。结果表达式应该是这样的

```
p => p.Name.Contains(val) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T10:53:16.667

如果要创建`Where`查询，则必须先创建`lambda`然后调用`Where`查询并传递`lambda`。尝试这个：

```
Expression<Func<T, bool>> lambda = Expression.Lambda<Func<T, bool>>(call, parameter);
MethodCallExpression expression = Expression.Call(typeof(Queryable), "Where",
                                    new[] { typeof(T) }, query.Expression, lambda);
query = query.Provider.CreateQuery<T>(expression); 
```

代替

```
var result = Expression.IsTrue(call);
query = query.Provider.CreateQuery<T>(result); 
```

# heroku - How can I install sendgrid app in Heroku using git (PHP)?

> ID：14614654
> 
> 赞同：2
> 
> 时间：2013-01-30T22:00:19.307
> 
> 标签：heroku, sendgrid

At the top of my index.php file I have:

```
require('sendgrid-php/SendGrid_loader.php'); 
```

And at the bottom I use this code to send the email:

```
 <?php
       if(isset($_POST['submit']))
          {

          $sendgrid = new SendGrid('app11445063@heroku.com', 'password');

         $mail = new SendGrid\Mail();
          $mail->
             addTo('email@gmail.com')->
             setFrom('app11445063@heroku.com')->
             setSubject('Subject goes here')->
             setText('Hello World!')->
             setHtml('<strong>Hello World!</strong>');

          $sendgrid->
            smtp->
             send($mail);
    }
 ?> 
```

I can't get the code to send an email out. I have the proper account from SendGrid and Heroku. The required files are in my directory. Do I have the wrong path to the required file?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T15:59:06.053

The issue was that the SendGrid library was not in the repository in Heroku. Just do a "git status" and add the directory to the commit and then push the directory to Heroku. Make sure you also have the correct path in the "include" in your PHP code.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T01:29:15.197

I believe this has to do with [Sendgrid's PHP lib](https://github.com/sendgrid/sendgrid-php). If you are using SMTP (you must if using heroku) you must also have swiftmailer installed. Otherwise the line 25 won't work in sendgrid-php/SendGrid/Smtp.php

```
public function __construct($username, $password){
/* check for SwiftMailer,
 * if it doesn't exist, try loading
 * it from Pear
 */
if (!class_exists('Swift')) {
  require_once 'swift_required.php';
} 
```

# javascript - 将 Javascript 字符串转换为日期时间

> ID：14614655
> 
> 赞同：1
> 
> 时间：2013-01-30T22:00:23.687
> 
> 标签：javascript

我有一个从 Javascript 中的日期选择器填充的文本框。日期存储为`30-Jan-2013`。我想将其转换为日期，以便可以在其他计算中使用它。

我试过了

```
var date1 = new Date(document.getElementById('textbox').value) 
```

但这会返回`Nan`

如果我放下`new Date`零件，例如

```
var date1 = (document.getElementById('textbox').value 
```

我得到了`30-Jan-2013`我似乎无法转换的日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:04:39.450

看起来`Date.parse`不起作用，因为日期选择器正在返回的格式。

您可能希望查看以下线程以解析解决方案或将 datepicker 输出的格式更改为受支持的格式之一。

[如何使用 JavaScript 中的格式规范将字符串转换为日期时间？](https://stackoverflow.com/questions/476105/how-can-i-convert-string-to-datetime-with-format-specification-in-javascript)

[http://blog.dygraphs.com/2012/03/javascript-and-dates-what-mess.html](http://blog.dygraphs.com/2012/03/javascript-and-dates-what-mess.html)

有用的解析信息：

[http://msdn.microsoft.com/en-us/library/ie/ff743760(v=vs.94).aspx](http://msdn.microsoft.com/en-us/library/ie/ff743760(v=vs.94).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:27:29.837

我想向您推荐一个简单，易于使用且快速的库`[moment.js][1]`

```
moment("30-Jan-2013").format('MMMM Do YYYY, h:mm:ss a'); 
```

将返回“2013 年 1 月 30 日，上午 12:00:00”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-15T09:03:23.303

**希望这对您的问题有用**

```
 var date= document.getElementById('textbox').value.split("-");;
  var date1 = new Date(date[2] + " " + date[1]  + " " + date[0]);
  date1 .toLocaleDateString("en-GB"); 
```

# google-maps - 未达到谷歌地图图层的 Vaadin Openlayers Wrapper 最大缩放级别

> ID：14614663
> 
> 赞同：1
> 
> 时间：2013-01-30T22:00:56.933
> 
> 标签：google-maps, zooming, openlayers, vaadin

我希望有人已经（并解决了）这个问题，因为我搜索了很多没有成功的解决方案。

问题是我有一个 GoogleHybridMapLayer 和一个 OpenStreetMapLayer，使用谷歌混合我只能达到比使用 OSM 或直接访问其他应用程序上的谷歌地图 api 少 2 或 3 级的缩放。我什至在 openlayers 谷歌地图演示中对其进行了测试，它们完全放大了，所以我认为这是 vaadin 插件的问题。

我尝试了所有我能想到并在网上找到的东西，包括在 OpenLayersMap 上设置 setJsMapOptions 参数，如下所示：

```
map.setJsMapOptions("{projection: "
                + "new OpenLayers.Projection(\"EPSG:102113\"),"
                + "units: \"m\","
                + "numZoomLevels: 20,"
                + "maxResolution: 156543.0339, "
                + "maxExtent: new OpenLayers.Bounds(-20037508, -20037508,20037508, 20037508.34)}"); 
```

这对我们的应用程序至关重要，因为用户需要设置彼此非常接近的点。

那么，如何在 openlayers 包装插件上实现与常规 openlayer 谷歌地图相同的缩放级别？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T14:32:14.627

[Matti Tahvonen](https://vaadin.com/forum/-/message_boards/view_message/2461489#_19_message_2463643)通过增加我没有看到的本机客户端方法中的缩放级别来帮助我解决这个问题。

[svn repo](http://code.google.com/p/vopenlayers/source/detail?r=212)中的最新版本提供了此修复程序

不要忘记重新编译小部件。

# android - Android：在 ActionBar 中隐藏导航微调器的安全方法？

> ID：14614666
> 
> 赞同：3
> 
> 时间：2013-01-30T22:01:02.677
> 
> 标签：android

我想在我的 ActionBar 中显示一个微调器，使用`ActionBar.NAVIGATION_MODE_LIST`，但我希望它根据某些应用程序上下文隐藏/显示。我发现我可以使用 将它从 ActionBar 中删除`getActionBar().setNavigationMode(-1)`，但是我不知道这是否是个好主意。

关于这是否安全或是否有更安全的替代方案的任何反馈？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-30T22:05:11.537

也许这更被接受：

```
ActionBar actionBar = getActionBar();
actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);
actionBar.setDisplayShowTitleEnabled(false); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-28T15:32:02.147

如果您坚持使用`ActionBar.NAVIGATION_MODE_LIST`，则每次要显示微调器时都必须设置导航侦听器。这显然不是最好的解决方案。

相反，您可能希望使用`ActionBar.setCustomView()`设置微调器导航（[参考](https://developer.android.com/reference/android/app/ActionBar.html#setCustomView%28android.view.View%29)）。

这是一些设置微调器的示例代码：

```
Spinner navigationSpinner = new Spinner(this);
navigationSpinner.setAdapter(yourSpinnerAdapter);
// Here you set navigation listener
navigationSpinner.setOnItemSelectedListener(yourSpinnerNavigationListener); 
getActionBar().setCustomView(navigationSpinner);
getActionBar().setDisplayShowCustomEnabled(true); 
```

然后，当您想要显示/隐藏它时，您只需更改它的可见性：

```
getActionBar().getCustomView().setVisibility(View.INVISIBLE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-22T13:24:39.110

只需像这样修改您的实现`ActionBarDrawerToggle`：

```
public void onDrawerSlide(View drawerView, float slideOffset) {
        super.onDrawerSlide(drawerView, slideOffset);
        if (slideOffset == 0) { // 0 = drawer is closed             
            setActionBarNavigationVisibility(activity, true); //show Tabs when Drawer is closed             
        }
    }

public void onDrawerStateChanged(int newState) {
        super.onDrawerStateChanged(newState);
        //hides Tabs right after Drawer starts opening
        if (DrawerLayout.STATE_DRAGGING == newState || DrawerLayout.STATE_SETTLING == newState) {
            setActionBarNavigationVisibility(activity, false);
        }
    } 
```

where 方法`setActionBarNavigationVisibility`正在考虑所有导航模式（您可以删除不必要的导航模式的代码）：

```
public static void setActionBarNavigationVisibility(Activity activity, boolean visible) {
    try {
        /* 1\. --- If the navigation items are showing in ActionBar directly. We have 3 options Spinner, Tabs, and CustomNav ---
         (When Tabs are showing BELOW ActionBar, is handled at the end) */
        int actionViewResId = Resources.getSystem().getIdentifier("action_bar", "id", "android"); // @see http://stackoverflow.com/questions/20023483/how-to-get-actionbar-view
        View actionBarView = activity.findViewById(actionViewResId); // returns instance of com.android.internal.widget.ActionBarView (inaccessible)
        if (actionBarView != null) {
            int visibility = visible ? View.VISIBLE : View.INVISIBLE; // not GONE, so it still takes space in ActionBar layout

            // handle tabs navigation
            Field mTabScrollViewField = actionBarView.getClass().getDeclaredField("mTabScrollView");
            if (mTabScrollViewField != null) {
                mTabScrollViewField.setAccessible(true);
                View mTabScrollView = (View) mTabScrollViewField.get(actionBarView); // instance of com.android.internal.widget.ScrollingTabContainerView (inaccessible)
                if (mTabScrollView != null)
                    mTabScrollView.setVisibility(visibility);
            }

            // handle Spinner navigation
            Field mSpinnerField = actionBarView.getClass().getDeclaredField("mSpinner"); // resp. mListNavLayout
            if (mSpinnerField != null) {
                mSpinnerField.setAccessible(true);
                View mSpinner = (View) mSpinnerField.get(actionBarView); // instance of android.widget.Spinner
                if (mSpinner != null)
                    mSpinner.setVisibility(visibility);
            }

            // handle Custom navigation
            Field mCustomNavViewField = actionBarView.getClass().getDeclaredField("mCustomNavView"); // resp. mListNavLayout
            if (mCustomNavViewField != null) {
                mCustomNavViewField.setAccessible(true);
                View mCustomNavView = (View) mCustomNavViewField.get(actionBarView);
                if (mCustomNavView != null)
                    mCustomNavView.setVisibility(visibility);
            }
        }
        // 2\. --- If the Tabs are BELOW ActionBar (narrow screens) ---          
        ViewParent actionBarContainer = actionBarView.getParent(); // parent of ActionBarView is com.android.internal.widget.ActionBarContainer (inaccessible)
        Field mTabContainerField = actionBarContainer.getClass().getDeclaredField("mTabContainer");
        if (mTabContainerField != null) {
            mTabContainerField.setAccessible(true);
            View mmTabContainer = (View) mTabContainerField.get(actionBarContainer);
            if (mmTabContainer != null)
                mmTabContainer.setVisibility(visible ? View.VISIBLE : View.GONE); // now use GONE, so the mTabContainer below Actionbar does not take space in layout
        }

    } catch (Exception ex) {
        // TODO Handle exception...         
    }
} 
```

# css - 三角形 css 按钮图像

> ID：14614668
> 
> 赞同：5
> 
> 时间：2013-01-30T22:01:10.840
> 
> 标签：css, button, geometry, css-shapes

我正在尝试在我的网站上制作一个带有 2 个大按钮的启动页面，每个按钮都是直角三角形，并且都通过最长边连接以创建一个正方形。基本上我正在寻找如何在css中制作非矩形按钮。

我不知道这是否可能，并且在网上找不到任何解释非矩形按钮的类似技术的东西，而且我对 css 并不是特别熟练。朝着正确的方向推动将非常有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-30T11:04:31.467

一个非常古老的（未回答的问题）值得回答。

您可以使用嵌套的 div 元素，其中父元素的溢出设置为隐藏，子元素旋转。

这是一个基本示例：（**请注意：** jQuery 仅用于演示）

```
$('.tri').click(function() {
  alert("triangle clicked!");
});
```

```
.wrap {
  height: 200px;
  width: 200px;
  position: relative;
  overflow: hidden;
  margin: 2px auto;
}
.wrap .tri {
  position: absolute;
  height: 70%;
  width: 70%;
  background: tomato;
  transform-origin: bottom left;
  bottom: 0;
  transition: all 0.6s;
  left: 0;
  cursor: pointer;
  transform: rotate(45deg);
}
.wrap2 {
  transform: rotate(180deg);
}
.wrap .tri:hover {
  background: black;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class="wrap">
  <div class="tri"></div>
</div>
<div class="wrap wrap2">
  <div class="tri"></div>
</div>
```

# hbase - HBASE Rest API (Stargate) 发布多个单元格/行

> ID：14614669
> 
> 赞同：2
> 
> 时间：2013-01-30T22:01:11.327
> 
> 标签：hbase, stargate

我正在尝试使用其余 api 将多个列/行发布到我的 hbase 集群。我可以一次发布 1 列而不会遇到麻烦，但似乎无法让它接受多列/多行。

这工作得很好

数据：

```
{
   "Row":{
      "@key":"www.somesite.com",
      "Cell":{
         "@column":"ColFam:Col1",
         "$":"someData"
      }
   }
} 
```

称呼：

```
curl -v -X PUT -H "Content-Type: application/json" --data '{"Row": { "@key":"www.somesite.com", "Cell": { "@column":"ColFam:Col1", "$":"someData" } } }' http://somesite.com:8080/TestTable/www.somesite.com/ColFam:Col1 
```

根据[api](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/rest/package-summary.html#operation_cell_store_multiple)，我应该能够同时发布多行/多列。

多列数据：

```
{
   "Row":
      {
         "key":"www.somesite.com",
         "Cell":[
            {
               "column":"ColFam:Col1",
               "$":"someData"
            },
            {
               "column":"ColFam:Col2",
               "$":"moreData"
            }
         ]
      }
} 
```

多行数据：

```
{
   "Row":[
      {
         "key":"www.somesite.com",
         "Cell":[
            {
               "column":"ColFam:Col1",
               "$":"someData"
            }
         ]
      },
      {
         "key":"www.someothersite.com",
         "Cell":[
            {
               "column":"ColFam:Col1",
               "$":"moreData"
            }
         ]
      }

   ]
} 
```

我尝试使用以下网址：

```
http://somesite.com:8080/TestTable/www.somesite.com/ColFam:Col1
http://somesite.com:8080/TestTable/www.somesite.com/ColFam
http://somesite.com:8080/TestTable/www.somesite.com 
```

无济于事。文档说要使用 false-row-key 所以我也试过：

```
http://somesite.com:8080/TestTable/false-row-key 
```

仍然没有运气。

我每次都得到同样的错误：

```
upload completely sent off: 124 out of 124 bytes
HTTP/1.1 503 Service Unavailable 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T22:44:04.767

因此，您所要做的就是对所有 json 值进行 base64 编码。

```
{
   "Row":[
      {
         "key":"d3d3LnNvbWVzaXRlLmNvbQ==",
         "Cell":[
            {
               "column":"QXV0aG9yczp0ZXN0MQ==",
               "$":"c29tZURhdGE="
            },
            {
               "column":"QXV0aG9yczp0ZXN0Mg==",
               "$":"bW9yZURhdGE="
            }
         ]
      }
   ]
} 
```

这对我来说应该很明显，因为其余 api 的返回值都是 base64 编码的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-01T07:19:14.970

JIRA [HBASE-9435](https://issues.apache.org/jira/browse/HBASE-9435)给出了这个答案。需要删除'@'并添加'[]'，命令如下：

```
curl -v -X PUT -H "Content-Type: application/json" --data '{"Row":[{"key":"www.somesite.com", "Cell": [{"column":"ColFam:Col1", "$":"someData"}]}]}' http://somesite.com:8080/TestTable/www.somesite.com/ColFam:Col1 
```

此外，“www.somesite.com”、“ColFam:Col1”、“someData”的值需要是 base64 编码。

# javascript - 显示打印对话框后，jQuery 模态窗口卡在打开状态

> ID：14614670
> 
> 赞同：2
> 
> 时间：2013-01-30T22:01:14.450
> 
> 标签：javascript, jquery

我在这里做了一个例子，我的网站上有同样的问题。
[http://jsfiddle.net/WnsfD/](http://jsfiddle.net/WnsfD/)

```
<a href="#" data-dismiss="modal" class="btn btn-inverse btn-small" aria-hidden="true" onclick="printDiv('print')"><i class="icon-white icon-print"></i> Print</a> 
```

这是我遇到麻烦的领域。（只是因为它不会让我在没有一些代码的情况下发布）

我认为这在这里很简单。javascript 会从模态窗口弹出打开打印对话框，但是一旦您打印或取消，模态窗口就会卡在打开状态。我将它设置为关闭，就像关闭按钮一样，因为我注意到您之后无法关闭它，但效果相同。我讨厌必须刷新页面才能关闭模式。

注意：感谢用户[Kevin](https://stackoverflow.com/users/362043/kevin)提供的打印脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T00:52:30.923

我认为这里的问题是，将元素的 HTML 复制到变量只会保留原始 HTML，而不是 JS 事件等。因此，当你把它放回去时，你就没有 JS 事件了。

使用打印样式区域可能是要走的路。您不理会当前元素，以免它们丢失处理程序。

我已经修改了你的小提琴，它似乎可以工作，尽管你可以做更多的 CSS 工作来使它更好（比如文本是浅灰色的，你可以强制它变黑）

[http://jsfiddle.net/gAtMs/2/](http://jsfiddle.net/gAtMs/2/)

基本上我为空的打印区域创建了一个新的 div (id="printme")。在 printDiv 函数中，我们将 html 复制到 printme div 中，然后在打印后将其删除。

在用于打印的 CSS 中，我们将所有内容隐藏在 div 容器下，而模态页脚只是因为我们不需要打印输出上的按钮。

我们还将 printme 隐藏在 css 中以进行常规屏幕显示，因此当您点击打印时屏幕甚至不会改变。

将 HTML 复制到 printme div 的唯一原因是更容易一次隐藏所有其他内容。

这是css...

```
#printme {
  display: none;
}

@media print {
  .container {
    display: none;
  }
  .modal-footer {
    display: none;
  }

  #printme {
    display: block;
  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-01T12:01:19.970

我通过切换模式解决了同样的问题，例如这是

```
$(document).on('click', '#buttonID', function(e){
     var printContents = document.getElementById("DivToPrintID").innerHTML;
     var originalContents = document.body.innerHTML;
     document.body.innerHTML = printContents;
     window.print();
     document.body.innerHTML = originalContents;
     $('#ModalID').modal('toggle');
}); 
```

# php - 使用 XPath 选择/过滤 XML 元素

> ID：14614671
> 
> 赞同：0
> 
> 时间：2013-01-30T22:01:24.523
> 
> 标签：php, dom, xpath, namespaces, xml-namespaces

这是我的亚马逊 mws api 响应

```
<?xml version="1.0"?>
<GetMyPriceForSKUResponse xmlns="http://mws.amazonservices.com/schema/Products/2011-10-01">
<GetMyPriceForSKUResult SellerSKU="ds-tru-6sss" status="Success">
  <Product xmlns="http://mws.amazonservices.com/schema/Products/2011-10-01" xmlns:ns2="http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd">
    <Identifiers>
      <MarketplaceASIN>
        <MarketplaceId>Assssssss</MarketplaceId>
        <ASIN>sss</ASIN>
      </MarketplaceASIN>
      <SKUIdentifier>
        <MarketplaceId>Afasrfd</MarketplaceId>
        <SellerId>ssssss</SellerId>
        <SellerSKU>dssss</SellerSKU>
      </SKUIdentifier>
    </Identifiers>
    <Offers>
      <Offer>
        <BuyingPrice>
          <LandedPrice>
            <CurrencyCode>USD</CurrencyCode>
            <Amount>12.49</Amount>
          </LandedPrice>
          <ListingPrice>
            <CurrencyCode>USD</CurrencyCode>
            <Amount>12.49</Amount>
          </ListingPrice>
          <Shipping>
            <CurrencyCode>USD</CurrencyCode>
            <Amount>0.00</Amount>
          </Shipping>
        </BuyingPrice>
        <RegularPrice>
          <CurrencyCode>USD</CurrencyCode>
          <Amount>12.49</Amount>
        </RegularPrice>
        <FulfillmentChannel>MERCHANT</FulfillmentChannel>
        <ItemCondition>New</ItemCondition>
        <ItemSubCondition>New</ItemSubCondition>
        <SellerId>Aadada</SellerId>
        <SellerSKU>ssss</SellerSKU>
      </Offer>
      <Offer>
        <BuyingPrice>
          <LandedPrice>
            <CurrencyCode>USD</CurrencyCode>
            <Amount>1000.00</Amount>
          </LandedPrice>
          <ListingPrice>
            <CurrencyCode>USD</CurrencyCode>
            <Amount>1000.00</Amount>
          </ListingPrice>
          <Shipping>
            <CurrencyCode>USD</CurrencyCode>
            <Amount>0.00</Amount>
          </Shipping>
        </BuyingPrice>
        <RegularPrice>
          <CurrencyCode>USD</CurrencyCode>
          <Amount>1000.00</Amount>
        </RegularPrice>
        <FulfillmentChannel>MERCHANT</FulfillmentChannel>
        <ItemCondition>New</ItemCondition>
        <ItemSubCondition>New</ItemSubCondition>
        <SellerId>ssss</SellerId>
        <SellerSKU>sss</SellerSKU>
      </Offer>
    </Offers>
  </Product>
</GetMyPriceForSKUResult>
<ResponseMetadata>
  <RequestId>e0ef1c2c-4f35-4316-8629-faadadd</RequestId>
</ResponseMetadata>
</GetMyPriceForSKUResponse> 
```

`amount (12.49)`并从中选择

```
<ListingPrice>
    <CurrencyCode>USD</CurrencyCode>
    <Amount>12.49</Amount>
</ListingPrice> 
```

我在尝试 ，

```
// from curl
$result = curl_exec ($ch);
$xmldoc = new DOMDocument();
$xmldoc->load($result);
$xpathvar = new Domxpath($xmldoc);

$queryResult = $xpathvar->query('/Amount');
foreach($queryResult as $result){
    echo $result;
} 
```

我期待超过一个价值，但我根本没有得到。

抱歉，我不擅长 XPath，有人可以指导我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:05:20.727

目前我在您的代码中发现了错误：

* * *

第一：使用两个`//`来选择一个元素，无论它位于 xml 树中的什么位置。

```
 $queryResult = $xpathvar->query('//Amount'); 
```

* * *

第二：感谢@Ranon。您将处理文档 xml 命名空间：

```
// Register Namespace mws
$xpathvar->registerNamespace("mws", 'http://mws.amazonservices.com/schema/Products/2011-10-01'); 
```

...并使用它，意味着：

```
 $queryResult = $xpathvar->query('//mws:Amount'); 
```

* * *

第三：如果要选择文本节点（`<amount>`节点之间），您应该使用：

```
$queryResult = $xpathvar->query('//mws:Amount/text()'); 
```

否则，您可以选择父元素`<Amount>`（就像您已经做的那样）并使用 PHP 检索值。然后，您必须将代码更改为：

```
$queryResult = $xpathvar->query('//mws:Amount');
foreach($queryResult as $result){
   echo $result->nodeValue; // echo the node value, not the node 'itself'
} 
```

* * *

第四：还要注意代码中的另一个错误。当您从 xml 字符串创建 DOMDocument 时，您必须使用：

```
$document->loadXML($result); 
```

* * *

第五：您告诉您要检索`<Amount>`元素内部的`<ListingPrice>`元素。`<Amount>`请注意，元素中也有`<RegularPrice>`元素。因此，元素在树中的位置**确实很重要。**`<Amount>`使用以下查询仅获取标价金额：

```
$queryResult = $xpathvar->query('//mws:ListingPrice/mws:Amount'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:27:05.310

Amazon 使用您必须声明和使用的命名空间返回 XML。

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
// from curl
$result = curl_exec($ch);
$xmldoc = new DOMDocument();
$xmldoc->loadXML($result);
$xpathvar = new Domxpath($xmldoc);
// Register Namespace mws
$xpathvar->registerNamespace("mws", 'http://mws.amazonservices.com/schema/Products/2011-10-01');

// Query using namespace mws
$queryResult = $xpathvar->query('//mws:Amount');
foreach($queryResult as $result){
    echo $result->nodeValue;
} 
```

我从子域中任意选择了命名空间标识符`mws`，您可以根据需要选择另一个。

*我更正了@hek2mgl 发现的代码中的一些其他错误。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:05:12.723

XPath 表达式错误。您需要`'//Amount'`选择所有“金额”元素

# javascript - 使用jQuery Tokeninput时如何使匹配的字符变为粗体+红色

> ID：14614675
> 
> 赞同：0
> 
> 时间：2013-01-30T22:01:32.433
> 
> 标签：javascript, jquery, html, css, jquery-tokeninput

我正在使用[http://loopj.com/jquery-tokeninput/demo.html#formatting](http://loopj.com/jquery-tokeninput/demo.html#formatting)

我想让匹配的字符也变成红色，但找不到他们拥有的 CSS 或 Javascript。

![在此处输入图像描述](../Images/eb2f255f82aa7bbb5c13c32b687d6275.png)

他们的项目在[GitHub 上](https://github.com/loopj/jquery-tokeninput)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:16:33.353

使用 chrome 开发人员工具，我发现**jquery-tokeninput**正在格式化搜索结果，如下所示：

```
<ul style="display: block; overflow: hidden;">
    <li class="token-input-dropdown-item2-facebook">Trad<b>in</b>g Spouses</li>
    <li class="token-input-dropdown-item-facebook">T<b>in</b> Man</li>
</ul> 
```

因此，它没有使用 css 类来突出显示匹配的字符，而是手动将这些字符放入`<b>`标签中。在 javascript 源文件中快速搜索后，我能够找到这个函数：

```
// Highlight the query part of the search term
function highlight_term(value, term) {
    return value.replace(
      new RegExp(
        "(?![^&;]+;)(?!<[^<>]*)(" + regexp_escape(term) + ")(?![^<>]*>)(?![^&;]+;)",
        "gi"
      ), function(match, p1) {
        return "<b>" + escapeHTML(p1) + "</b>";
      }
    );
} 
```

因此，我想这只是修改它以便能够自定义匹配的字符样式的问题。例如，您可以将返回字符串更改为：

```
return '<b class="match">' + escapeHTML(p1) + '</b>'; 
```

并将您的样式应用于**b.match** css 类。

# python - 设置循环条件

> ID：14614678
> 
> 赞同：1
> 
> 时间：2013-01-30T22:01:35.567
> 
> 标签：python, loops

编程新手，为了练习，我正在尝试编写易经预言机。我得到了我想要的输出，但只能将此代码块复制到我的程序中 6 次。

我可以设置一个循环条件以使其更简洁吗？

我已经阅读了有关循环的文档和 tuts，但还没有看到如何在这种情况下应用它。

```
import random 

oracle = random.randint(6,9)

if oracle == 6:
   print "__ __~"
elif oracle == 7:
 print "_____"
elif oracle == 8:
 print "__ __"
elif oracle == 9:
 print "_____~"   (X6) 
```

=> 这是我得到的输出：

```
_____
__ __
__ __~
_____
_____~
__ __ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T02:34:27.127

请注意，您的概率分布是错误的。

要读易经，你应该掷 3 个公平的硬币，每条尾巴 2 分，每头 3 分：

```
Coin1  Coin2  Coin3  Points
t      t      t      6
t      t      h      7
t      h      t      7
t      h      h      8
h      t      t      7
h      t      h      8
h      h      t      8
h      h      h      9 
```

您可以看到有 3 种方法可以求和为 7 或 8，但只有一种方法可以求和为 6 或 9；因此分布应该是 6: 12.5%, 7: 37.5%, 8: 37.5%, 9: 12.5%。`randint`给出均匀分布，即每个 25%。

我建议如下：

```
from random import randint

xyin  = "__ __~"
yang  = "_____"
yin   = "__ __"
xyang = "_____~"

three_coins = [ xyin, yang, yang, yin, yang, yin, yin, xyang ]

def cast():
    return three_coins[randint(0, 7)]

def hexagram():
    return '\n'.join(cast() for i in range(6))

print hexagram() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:04:13.777

使用这样的 for 循环结构：

```
import random 

for x in range(6):  # Loop 6 times
    oracle = random.randint(6,9)
    if oracle == 6:
       print "__ __~"
    elif oracle == 7:
       print "_____"
    elif oracle == 8:
       print "__ __"
    elif oracle == 9:
       print "_____~"   (X6) 
```

更多关于范围函数的信息`help(range)`：

> range(...) range([start,] stop[, step]) -> 整数列表
> 
> ```
> Return a list containing an arithmetic progression of integers.
> range(i, j) returns [i, i+1, i+2, ..., j-1]; start (!) defaults to 0. 
> ```

* * *

您也可以使用`while`构造来实现相同的效果。

```
start = 0
stop = 6
while start < stop:
    #Your code-block here
    start = start+1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T22:09:15.700

像这样的东西？

```
import random 

for n in range(6):
  oracle = random.randint(6,9)
  if oracle == 6:
    print "__ __~"
  elif oracle == 7:
    print "_____"
  elif oracle == 8:
    print "__ __"
  elif oracle == 9:
    print "_____~" 
```

输出：

```
__ __
__ __~
_____~
__ __~
_____~ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T22:12:40.587

你可以使用这样的while循环：

```
import random 

counter = 0

while counter < 6:
    oracle = random.randint(6,9)

    if oracle == 6:
       print "__ __~"
    elif oracle == 7:
       print "_____"
    elif oracle == 8:
       print "__ __"
    elif oracle == 9:
       print "_____~"

    counter += 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-30T22:21:02.880

您还可以用字典替换 and 的堆栈，`if`用`elif`列表理解替换循环，并将其减少到只有几行

```
d = {6: "__ __~", 7: "_____" , 8: "__ __" , 9: "_____~",}
print '\n'.join([d[random.randint(6, 9)] for j in range(6)]) 
```

# hibernate - 使用 Hibernate SessionFactory 获取列大小

> ID：14614683
> 
> 赞同：0
> 
> 时间：2013-01-30T22:01:52.117
> 
> 标签：hibernate

我正在尝试检索表的元数据信息；我成功检索了表中的列和列类型。我也想检索每个列的大小。我对 Hibernate 还很陌生，并且一直坚持这一点。这就是我检索列名和类型的方式：

```
String[] columns = HibernateUtil.getSessionFactory()
            .getClassMetadata(Java.class).getPropertyNames();
Type[] columnsType = HibernateUtil.getSessionFactory()
            .getClassMetadata(Java.class).getPropertyTypes(); 
```

实体类：

```
@Entity
    @Table(name="Box")
    public class Box implements Serializable {
        private int dimHeight;
        private int dimLen;
        private int dimWidth;
        private double weight;

        public Box() {
        }

        public int getDimHeight() {
            return this.dimHeight;
        }

        public void setDimHeight(int dimHeight) {
            this.dimHeight = dimHeight;
        }

        public int getDimLen() {
            return this.dimLen;
        }

        public void setDimLen(int dimLen) {
            this.dimLen = dimLen;
        }

        public int getDimWidth() {
            return this.dimWidth;
        }

        public void setDimWidth(int dimWidth) {
            this.dimWidth = dimWidth;
        }

        public double getWeight() {
            return this.weight;
        }

        public void setWeight(double weight) {
            this.weight = weight;
        }
    } 
```

代码和异常是：

```
Field foo = Box.class.getField("dimWidth");
foo.setAccessible(true);

java.lang.NoSuchFieldException: dimWidth
    at java.lang.Class.getField(Class.java:1520) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T23:31:20.787

`HibernateUtil`没有暴露这一点。但是，您可以简单地使用 Java 反射：

```
Field foo = Java.class.getField("foo");
Column column = foo.getAnnotation(Column.class);
column.length(); 
```

**更新**

Grrrhh，犯了一个愚蠢的错误……`getField()`仅供公众使用。您需要`getDeclaredField()`像这样用于私有字段：

```
Field dimWidthField = Box.class.getDeclaredField("dimWidth");
Column columnAnnotation = dimWidthField.getAnnotation(Column.class);
System.out.println(columnAnnotation.length()); // 5
System.out.println(columnAnnotation.precision()); // 0

private class Box implements Serializable {
  @Column(length = 5, precision = 0)
  private int dimWidth; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T23:25:44.427

You're looking at the wrong place. As its name indicates, ClassMetadata contains metadata about a class, and not about a database table and its columns.

To get information about the columns of a table, use [JDBC's DatabaseMetaData](http://docs.oracle.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getColumns%28java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%29).

# memory-management - 1亿条记录需要多少内存

> ID：14614689
> 
> 赞同：1
> 
> 时间：2013-01-30T22:02:25.303
> 
> 标签：memory-management, byte

我需要多少内存才能将 1 亿条记录加载到内存中。假设每条记录需要 7 个字节。这是我的计算

```
each record = <int> <short> <byte>
4  +  2  + 1 = 7 bytes 
```

`needed memory in GB = 7 * 100 * 1,000,000 / 1000,000,000 = 0.7 GB`

你觉得这个计算有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:05:30.197

如果你真的每个结构只需要 7 个字节，那么你*几乎*是对的。

对于内存测量，我们通常使用 1024 因子，因此您需要

```
700 000 000 / 1024³ = 667,57 MiB = 0,652 GiB 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:12:40.430

对于 100,000,000 条记录，您需要考虑开销。确切的开销和开销取决于语言。

例如，在 C/C++ 中，结构或类中的字段对齐到特定的边界。细节可能因编译器而异，但通常 int 必须从 4 的倍数开始，short 必须从 2 的倍数开始，char 可以从任何地方开始。

因此，假设您的 4+2+1 表示一个 int、一个 short 和一个 char，那么如果您按该顺序排列它们，该结构将占用 7 个字节，但至少该结构的下一个实例必须从一个 4 字节的边界，所以中间有 1 个填充字节。我认为，事实上，大多数 C 编译器要求结构作为一个整体从 8 字节边界开始，尽管在这种情况下这并不重要。

每次分配内存时，分配块都会产生一些开销。编译器必须能够跟踪分配了多少内存以及有时下一个块在哪里。如果您将 100,000,000 条记录分配为一个大的“新”或“malloc”，那么这个开销应该是微不足道的。但是，如果您单独分配每个记录，那么每个记录都会产生开销。究竟有多少取决于编译器，但是，让我们看看，我使用的一个系统我认为每个分配是 8 个字节。如果是这种情况，那么每条记录需要 16 个字节：8 个字节用于块头，7 个用于数据，1 个用于填充。所以它很容易达到你期望的两倍。

其他语言会有不同的开销。最简单的做法可能是凭经验找出：查看系统调用是什么，以了解您正在使用多少内存，然后检查该值，分配一百万个实例，再次检查并查看差异。

# c# - 使用 C# 从 SQL Server 创建 .BAK 文件

> ID：14614691
> 
> 赞同：1
> 
> 时间：2013-01-30T22:02:38.263
> 
> 标签：c#, winforms, sql-server-2008, database-backups, database-restore

> **可能重复：**
> [通过 C# 备份 SQL Server](https://stackoverflow.com/questions/664869/backup-sql-server-via-c-sharp)

我有一个 Windows Forms 项目，它在 SQL Server 2008 R2 中存储了一些值，其中有许多处理我的应用程序的表。

我想进行数据库备份，这样如果用户要松开操作系统并重新安装，他们可以使用备份（.BAK 文件）恢复数据库。

我想知道如何使用 C# 从 SQL Server 2008 R2 进行备份，以及在进行备份时是否必须在客户端计算机中安装 SQL Server。

另外，我怎样才能恢复它？任何例子都可能有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:10:58.077

您需要安装客户端工具。

您需要的是 SMO（Sql Server 管理对象）

这提供了一个 api 来执行某些 Sql Server 任务，包括备份

# git - 如何在多个文件上并行运行递归查找和替换操作？

> ID：14614692
> 
> 赞同：5
> 
> 时间：2013-01-30T22:02:47.253
> 
> 标签：git, bash, sed, parallel-processing, find

我正在尝试使用 git filter-branch 功能替换 git 存储库中的文本数据。

我编写了一个简单的脚本来搜索各种术语并替换它们。它运行得非常缓慢。我执行了多行 BASH 代码来自定义我的搜索结果和替换操作。我知道我的代码效率不高。我决定继续尝试我的第一条线路，这应该是半有效的。浏览代码库仍然需要很长时间。

**是否可以使用 BASH 或其他简单方法来搜索我的文件并并行执行查找和替换操作以加快速度？**

如果没有，关于如何更好地处理这个问题还有其他建议吗？

这是我正在执行的 Git 命令：

```
git filter-branch --tree-filter "sh /home/kurtis/.bin/redact.sh || true" \
    -- --all 
```

这是我的命令实际上正在执行的代码：

```
find . -not -name "*.sql" -not -name "*.tsv" -not -name "*.class" \
    -type f -exec sed -i 's/01dPassw0rd\!/HIDDENPASSWORD/g' {} \; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T22:24:45.400

git filter-branch 不能并行处理提交，因为它需要知道父提交的哈希（id）来计算当前哈希。

但是您可以加快每个提交的处理速度：

您的代码对每个文件执行 sed。那很慢。改用这个：

```
find . -not -name "*.sql" -not -name "*.tsv" -not -name "*.class" \
       -type f -print0 \
  | xargs -0 sed -i 's/01dPassw0rd\!/HIDDENPASSWORD/g' 
```

此版本与您的版本完全相同，但 sed 使用尽可能多的文件（参数）执行。Find 的“-print0”和 xargs 的“-0”表示“用零字节分隔文件名”。所以当文件名包含空格、换行、二进制垃圾等时没有问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T15:18:46.670

使用 GNU Parallel，您可以在每个 CPU 上并行化：

```
find . -not -name "*.sql" -not -name "*.tsv" -not -name "*.class" \
   -type f -print0 |
parallel -q -0 sed -i 's/01dPassw0rd\!/HIDDENPASSWORD/g' 
```

了解更多：[https ://www.youtube.com/playlist?list=PL284C9FF2488BC6D1](https://www.youtube.com/playlist?list=PL284C9FF2488BC6D1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T19:22:17.740

我发现这个问题很有趣，所以我玩了一下，并分享了这个部分工作的脚本。我最初的方法有点错误，但它可能会更快（呃）。

我试图通过在每次提交中搜索修改后的文件来提高性能，其中修改包含要替换为的字符串`git log -Sstring`。但是我忘记了如果我只更改那些，那么修改将出现在下一次提交中，所以我不得不多次运行脚本，但它不会检查所有文件只是修改，因此多次运行可能会更快你的版本，但我不确定如果什么都不做，过滤器分支需要多少时间。

您也许可以使用它的一部分，也许首先使用`git log -S...`. 你可以通过使用`xargs`before`sed`而不是`for`循环来改进它，但是在开发时我更喜欢这种形式。我不知道如何正确地发现父母，这就是为什么我这样做并且必须单独处理初始提交案例。

无论如何，我也是在这里学习的，所以如果您找到解决此问题的好方法，请分享:)

```
#!/bin/bash

commit=$1
pattern=$2
replace=$3

function replaceall() {
  for f in `git log -S$pattern --pretty="format:" --name-only $1 | egrep -v '.sql$|.class$|.tsv$'`; do
    echo "FILE $f"
    sed -i "s/$pattern/$replace/g" $f
  done
}

parents=`git log --pretty=%P -n 1 $commit`
if test -z "$parents"; then
  echo "ROOT"
  replaceall $commit
else
  for p in $parents; do
    echo "PARENT $p"
    replaceall $p..$commit
  done
fi 
```

用法：`git filter-branch -f --tree-filter '/path/to/script.sh $commit 01dPassw0rd\! HIDDENPASSWORD' -- --all`

*我认为脚本不应该在你的 git 工作目录中，因为树过滤器会添加它在重写时找到的所有内容，但我不确定这一点。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T23:17:41.007

您需要[BFG Repo-Cleaner](http://rtyley.github.com/bfg-repo-cleaner/)，它是在 JVM 中运行的更快、更简单的替代方案，`git-filter-branch`并且明确设计用于从 Git 存储库中删除私有数据。它是多线程的，并针对您所描述的任务进行了优化。它通常比你快 10-50 倍`git-filter-branch`- 你的 repo 越大，它就越快。

下载 Java jar，创建一个`private.txt`列出要删除的密码等的文件（每行一个条目），然后运行以下命令：

```
$ java -jar bfg.jar  --replace-text private.txt  my-repo.git 
```

将扫描您的存储库历史中阈值大小（默认为 1MB）的所有文件，并且任何匹配的字符串（不在您*最近*的提交中）将被替换为字符串“***REMOVED***”。然后，您可以使用`git gc`清除死数据：

```
$ git gc --prune=now --aggressive 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-10T15:27:52.353

递归文本替换的一些基准（[来源](https://github.com/milahu/sed-recursive-benchmark)）

```
0.131411 sec  find-xargs-sd.sh

0.323906 sec  find-xargsparallel-sed.sh
0.326623 sec  find-xargs-sed.sh
0.397934 sec  find-xargs-perl.sh

4.53739 sec  find-exec-sed.sh

10.3247 sec  parallel-sed.sh 
```

# c++ - C++ 中长短函数名的宏

> ID：14614696
> 
> 赞同：1
> 
> 时间：2013-01-30T22:03:09.667
> 
> 标签：c++, macros, alias, naming

我目前正在开发一个通用 C++ 库。好吧，我喜欢使用真实的函数名称，实际上我的项目有一个一致的函数命名系统。如果函数（或方法）不返回 bool，则函数（或方法）以*动词*
开头（在这种情况下，它们以 is_ 开头） 问题是这对某些程序员来说可能有些问题。考虑这个函数：

```
#include "something.h"
int calculate_geometric_mean(int* values)
{
//insert code here
} 
```

我认为这样的函数似乎是正式的，所以我这样命名我的函数。但是我设计了一个简单的宏系统供用户切换函数名称。

```
#define SHORT_NAMES
#include "something.h"
#ifdef SHORT_NAMES
int calc_geometric_mean(int* values)
#else
int calculate_geometric_mean(int* values)
#endif
{
//some code
} 
```

这比使用别名更明智（因为函数的每个别名都将在内存中分配），还是这个解决方案纯粹是邪恶的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T22:07:43.910

FWIW，我不认为这种双重命名系统增加了很多价值。但是，它确实有可能引起很多混乱（委婉地说）。

无论如何，如果您确信这是一个好主意，我会通过内联函数而不是宏来实现它。

```
// something.h

int calculate_geometric_mean(int* values); // defined in the .cpp file

inline int calc_geo_mean(int* values) {
   return calculate_geometric_mean(values);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:07:33.343

哪些符号将被导出到目标文件/库？如果您尝试使用其他版本怎么办？你会分发两个带有自己符号的二进制文件吗？

所以 - 不，坏主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:24:18.767

通常，命名系统背后的目的是帮助代码的可读性和理解。

现在，您实际上有 2 个系统，每个系统都有一个基本原理。您已经迫使读者/维护者记住两种命名方法，这会削弱可读性的最终目标。不要介意最终污染代码库的丑陋#defines。

我会说选择一个系统并坚持下去，因为一致性是关键。我不会说这个解决方案本身就是纯粹的邪恶——我会说这不是一个开始的解决方案。

# android - Android模拟器太慢了，我无法使用它

> ID：14614701
> 
> 赞同：4
> 
> 时间：2013-01-30T22:03:41.523
> 
> 标签：android, performance, android-emulator, slowdown

Android Emulator 需要 15 到 20 分钟才能启动，然后在我的笔记本电脑上大多崩溃，无论我使用哪种 Android 手机或设置。我完全失去了我可以做些什么来使它在可用水平上运行。

我在我的 labtop 上的 windows 8 中运行它，带有 8 gb ram 和 1.6 GH 上的 AMD 四核。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:07:05.507

确保您已为您正在使用的 API 级别平台安装“Intel x86”系统映像，然后确保您的模拟器在其配置的 CPU/ABI 下拉列表中使用该系统映像。

与使用 ARM 映像相比，这将大大加快速度。

您可以尝试的唯一另一件事是使用快照，然后您只需经历一次长时间的启动。快照对我来说总是有点小故障，我已经停止尝试使用它们，这提醒我，如果您正在使用快照，请尝试关闭它们，这也可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:13:53.907

我在尝试运行全规格设备时也会发生这种情况。我降低了规格和分辨率，因为我什至没有足够的内存来分配 1GB ram 虚拟设备。

第一次启动需要一些时间。您可以将模拟器配置为使用快照，这将大大加快启动时间。研究运行 x86 映像，这将提高您的模拟器的性能。请记住，如果您有任何针对 armeabi 的二进制文件，它们将不起作用（对大多数人来说不是问题）。

# html - 带有输入条目选项的 HTML 组合框

> ID：14614702
> 
> 赞同：92
> 
> 时间：2013-01-30T22:03:46.770
> 
> 标签：html, combobox

我的印象是除了选择列表中已有的任何值之外，您还可以在组合框中键入内容。但是，我似乎找不到有关如何执行此操作的信息。我需要添加一个属性以允许输入文本吗？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2013-01-30T22:07:56.150

之前`datalist`（见下面的注释），您将提供一个额外的`input`元素供人们输入他们自己的选项。

```
<select name="example">
  <option value="A">A</option>
  <option value="B">B</option>
  <option value="-">Other</option>
</select>

<input type="text" name="other">
```

这种机制**适用于所有浏览器，不需要 JavaScript**。

您可以使用一点 JavaScript 来巧妙地仅显示`input`“其他”选项是否被选中。

# 数据列表元素

该`datalist`元素旨在为此概念提供更好的机制。在某些浏览器中，例如 iOS Safari < 12.2，不支持此功能或实现存在问题。[检查 Can I Use 页面以查看当前的 datalist 支持](http://caniuse.com/#search=datalist)。

```
<input type="text" name="example" list="exampleList">
<datalist id="exampleList">
  <option value="A">  
  <option value="B">
</datalist>
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2014-04-02T08:27:55.540

在 HTML 中，你倒着做：你定义一个文本输入：

```
<input type="text" list="browsers" /> 
```

并附加一个数据列表。（注意输入的列表属性）。

```
<datalist id="browsers">
  <option value="Internet Explorer">
  <option value="Firefox">
  <option value="Chrome">
  <option value="Opera">
  <option value="Safari">
</datalist> 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-11-21T17:20:36.707

此链接可以帮助您： [http ://www.scriptol.com/html5/combobox.php](http://www.scriptol.com/html5/combobox.php)

你有两个例子。一个在html4中，另一个在html5中

HTML5

```
<input type="text" list="browsers"/>
 <datalist id="browsers">
    <option>Google</option>
    <option>IE9</option>
 </datalist> 
```

HTML4

```
 <input type="text" id="theinput" name="theinput" />
 <select name="thelist" onChange="combo(this, 'theinput')">
   <option>one</option>
   <option>two</option>
   <option>three</option>
 </select> 
```

```
 function combo(thelist, theinput) {
     theinput = document.getElementById(theinput);
     var idx = thelist.selectedIndex;
     var content = thelist.options[idx].innerHTML;
     theinput.value = content;
 } 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-09-20T04:52:45.207

在大多数情况下，此处的`dojo`示例在应用于现有代码时不起作用。因此我不得不找到一个替代品，在这里找到 - hxxp://technologymantrablog.com/how-to-create-a-combo-box-with-text-input-jquery-autocomplete/ （现在指向垃圾邮件站点或更糟)

[archive.org](https://web.archive.org/web/20161206094457/http://technologymantrablog.com/how-to-create-a-combo-box-with-text-input-jquery-autocomplete/)（不是很有用）

这是 jsfiddle - [https://jsfiddle.net/ze7fgby7/](https://jsfiddle.net/ze7fgby7/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-08-19T10:34:07.560

好吧，现在是 2016 年，仍然没有简单的方法来进行组合……当然我们有数据列表，但没有 safari/ios 支持，它并不是真正可用的。至少我们有 ES6 .. 下面是对包装 div 或 span 的组合类的尝试，通过在 select 顶部放置一个输入框并绑定相关事件将其变成一个组合。

参见代码：[https ://github.com/kofifus/Combo](https://github.com/kofifus/Combo)

（代码依赖于[https://github.com/kofifus/New](https://github.com/kofifus/New)的类模式）

创建组合很容易！只需将 div 传递给它的构造函数：

```
let mycombo=Combo.New(document.getElementById('myCombo'));
mycombo.options(['first', 'second', 'third']);

mycombo.onchange=function(e, combo) {
  let val=combo.value;
  // let val=this.value; // same as above
  alert(val);
 }
```

```
<script src="https://rawgit.com/kofifus/New/master/new.min.js"></script>
<script src="https://rawgit.com/kofifus/Combo/master/combo.min.js"></script>

<div id="myCombo" style="width:100px;height:20px;"></div>
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-01-11T00:29:53.197

这个要小得多，不需要 jquery 并且在 safari 中效果更好。 [https://github.com/Fyrd/purejs-datalist-polyfill/](https://github.com/Fyrd/purejs-datalist-polyfill/)

检查修改问题以添加向下箭头。 [https://github.com/Fyrd/purejs-datalist-polyfill/issues](https://github.com/Fyrd/purejs-datalist-polyfill/issues)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-04-07T12:54:45.777

我的解决方案非常简单，看起来就像一个原生的可编辑组合框，但即使在 IE6 中也可以工作（这里的一些答案需要大量代码或外部库，结果就是这样，例如文本框中的文本位于下拉图标的后面组合框的部分，或者它看起来根本不像一个可编辑的组合框）。

关键是仅将组合框剪辑为在文本框上方可见的下拉图标。并且文本框在组合框部分下方有点宽，所以你看不到它的右端 - 组合框在视觉上继续：[https ://jsfiddle.net/dLsx0c5y/2/](https://jsfiddle.net/dLsx0c5y/2/)

```
select#programmoduleselect
{
    clip: rect(auto auto auto 331px);
    width: 351px;
    height: 23px;
    z-index: 101; 
    position: absolute;
}

input#programmodule
{
    width: 328px;
    height: 17px;
}

<table><tr>
<th>Programm / Modul:</th>
<td>
    <select id="programmoduleselect"
        onchange="var textbox = document.getElementById('programmodule'); textbox.value = (this.selectedIndex == -1 ? '' : this.options[this.selectedIndex].value); textbox.select(); fireEvent2(textbox, 'change');"
        onclick="this.selectedIndex = -1;">
        <option value=RFEM>RFEM</option>
        <option value=RSTAB>RSTAB</option>
        <option value=STAHL>STAHL</option>
        <option value=BETON>BETON</option>
        <option value=BGDK>BGDK</option>
    </select>
    <input name="programmodule" id="programmodule" value="" autocomplete="off"
        onkeypress="if (event.keyCode == 13) return false;" />
</td>
</tr></table> 
```

（最初在这里使用，但不要发送表格：old.dlubal.com/WishedFeatures.aspx）

编辑：macOS 的样式需要有所不同：Ch 没问题，对于 FF 增加组合框的高度，Safari 和 Opera 忽略组合框的高度，因此增加它们的字体大小（有上限，然后减少文本框）高一点）：[https ://i.stack.imgur.com/efQ9i.png](https://i.stack.imgur.com/efQ9i.png)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-14T07:26:18.093

鉴于仍未完全支持 HTML datalist 标记，我使用的另一种方法是[Dojo Toolkit ComboBox](http://dojotoolkit.org/reference-guide/1.10/dijit/form/ComboBox.html)。与我探索过的其他选项相比，它更容易实现并且记录得更好。它还可以很好地与现有框架配合使用。就我而言，我将此组合框添加到基于 Codeigniter 和 Bootstrap 的现有网站中，没有任何问题您只需要确保将 Dojo 主题（例如 class="claro"）应用于组合的父元素而不是 body 标签以避免样式冲突。

首先，包含一个 Dojo 主题（例如“Claro”）的 CSS。在下面的 JS 文件之前包含 CSS 文件很重要。

```
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/dojo/1.9.6/dijit/themes/claro/claro.css" /> 
```

接下来，通过 CDN 包含 jQuery 和 Dojo Toolkit

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/dojo/1.10.3/dojo/dojo.js"></script> 
```

接下来，您可以按照[Dojo 的示例代码](http://dojotoolkit.org/reference-guide/1.10/dijit/form/ComboBox.html)或使用下面的示例来获得一个有效的组合框。

```
<body>
    <!-- Dojo Dijit ComboBox with 'Claro' theme -->
    <div class="claro"><input id="item_name_1" class=""/></div>

    <script type="text/javascript">
        $(document).ready(function () {
            //In this example, dataStore is simply an array of JSON-encoded id/name pairs
            dataStore = [{"id":"43","name":"Domain Name Renewal"},{"id":"42","name":"Hosting Renewal"}];

            require(
                [ "dojo/store/Memory", "dijit/form/ComboBox", "dojo/domReady!"], 
                function (Memory, ComboBox) {
                    var stateStore = new Memory({
                        data: dataStore
                    });

                    var combo = new ComboBox({
                        id: "item_name_1",
                        name: "desc_1",
                        store: stateStore,
                        searchAttr: "name"},                        
                        "item_name_1"
                        ).startup();

                });

        });

    </script>
</body> 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-01-30T22:09:50.193

在这个网站上查看 ComboBox 或 Combo：http: [//www.jeasyui.com/documentation/index.php#](http://www.jeasyui.com/documentation/index.php#)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2019-09-19T15:30:58.233

其他答案都不令人满意，主要是因为 UI 看起来仍然很糟糕。我发现[了这个](https://github.com/indrimuska/jquery-editable-select)，它看起来不错，非常接近完美和可定制。

可以在[此处](http://indrimuska.github.io/jquery-editable-select)找到示例和选项等的完整列表，但这是一个基本演示：

```
$('#editable-select').editableSelect();
```

```
<link href="https://cdn.jsdelivr.net/npm/jquery-editable-select@2.2.5/dist/jquery-editable-select.min.css" rel="stylesheet"/>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-editable-select@2.2.5/dist/jquery-editable-select.min.js"></script>

<select id="editable-select">
	<option>Alfa Romeo</option>
	<option>Audi</option>
	<option>BMW</option>
	<option>Citroen</option>
</select>
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2016-08-09T17:18:14.380

```
 <html>
<head>
    <title></title>
    <script src="jquery-3.1.0.js"></script>
    <script>
        $(function () {
            $('#selectnumber').change(function(){
                alert('.val() = ' + $('#selectnumber').val() + '  AND  html() = ' + $('#selectnumber option:selected').html() + '  AND .text() = ' + $('#selectnumber option:selected').text());
            })
        });
    </script>
</head>
<body>
       <div>
        <select id="selectnumber">
            <option value="1">one</option>
            <option value="2">two</option>
            <option value="3">three</option>
            <option value="4">four</option>
        </select>

    </div>
   </body>
</html> 
```

[![点击查看输出屏幕](../Images/7fd932f2a4f170d863d8f9ddff77419b.png)](https://i.stack.imgur.com/zLlg5.png)

谢谢...：）

# r - 计算 R 数据框中的百分比变化

> ID：14614710
> 
> 赞同：31
> 
> 时间：2013-01-30T22:04:18.470
> 
> 标签：r, time-series

我在 R 中有一个带有多个向量的时间序列对象。我想计算每个向量在每个时间点的周期百分比变化（保存 t = 1，这显然是 NA）。

```
> data <- ts(data.frame(x1=c(1:10), x2=c(11:20), x3=c(21:30)), start = c(2010,3), frequency = 4)
> data
        x1 x2 x3
2010 Q3  1 11 21
2010 Q4  2 12 22
2011 Q1  3 13 23
2011 Q2  4 14 24
2011 Q3  5 15 25
2011 Q4  6 16 26
2012 Q1  7 17 27
2012 Q2  8 18 28
2012 Q3  9 19 29
2012 Q4 10 20 30 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-01-30T22:07:12.657

试试这个：

```
R> data/stats::lag(data,-1) - 1
         data.x1   data.x2   data.x3
2010 Q4 1.000000 0.0909091 0.0476190
2011 Q1 0.500000 0.0833333 0.0454545
2011 Q2 0.333333 0.0769231 0.0434783
2011 Q3 0.250000 0.0714286 0.0416667
2011 Q4 0.200000 0.0666667 0.0400000
2012 Q1 0.166667 0.0625000 0.0384615
2012 Q2 0.142857 0.0588235 0.0370370
2012 Q3 0.125000 0.0555556 0.0357143
2012 Q4 0.111111 0.0526316 0.0344828
R> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-01-30T22:08:45.923

像这样的东西？

```
> diff(data)/data[-nrow(data),] * 100
               x1       x2       x3
2010 Q4 100.00000 9.090909 4.761905
2011 Q1  50.00000 8.333333 4.545455
2011 Q2  33.33333 7.692308 4.347826
2011 Q3  25.00000 7.142857 4.166667
2011 Q4  20.00000 6.666667 4.000000
2012 Q1  16.66667 6.250000 3.846154
2012 Q2  14.28571 5.882353 3.703704
2012 Q3  12.50000 5.555556 3.571429
2012 Q4  11.11111 5.263158 3.448276 
```

# date - 仅选择最近日期的项目

> ID：14614717
> 
> 赞同：0
> 
> 时间：2013-01-30T22:04:44.837
> 
> 标签：date, select, plsql

我有下表：

```
create table weights (
   ident int references users,
   dateW date,
   weight float,
   primary key(ident,dateW)
); 
```

我只想从最近日期的给定用户（ident）中选择重量。我有：

```
SELECT WEIGHT
FROM WEIGHTS
WHERE WEIGHTS.IDENT = 22 AND WEIGHTS.DATEW = (SELECT MAX(WEIGHTS.DATEW)
                                              FROM WEIGHTS); 
```

但它没有做我想要的。建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:09:02.260

您可以使用子查询：

```
SELECT w.WEIGHT
FROM WEIGHTS w
INNER JOIN
(
    SELECT MAX(DATEW) MaxDATEW
    FROM WEIGHTS 
) w1
    on w.DATEW= w1.MaxDATEW
WHERE w.IDENT = 22 
```

或者你可以申请`row_number()`

```
select *
from
(
    SELECT w.WEIGHT, row_number() over(order by w.DATEWdesc) rn
    FROM WEIGHTS w
    WHERE w.IDENT = 22 
) s
where rn = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:12:22.367

您的查询可能遇到的问题是最大日期可能是从其他用户那里获取的，在这种情况下您不会得到结果。子查询应该只获取同一用户的最大日期。

```
SELECT WEIGHT
FROM WEIGHTS
WHERE WEIGHTS.IDENT = 22 
AND WEIGHTS.DATEW = (
    SELECT MAX(WEIGHTS.DATEW)
    FROM WEIGHTS
    WHERE WEIGHTS.IDENT = 22
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:28:55.803

```
SELECT 
  max(WEIGHT) keep (dense_rank first order by datew desc) as latest_weight
FROM WEIGHTS
WHERE WEIGHTS.IDENT = 22; 
```

# ruby - Watir Crawler 在 Goto 之后被卡住了

> ID：14614720
> 
> 赞同：2
> 
> 时间：2013-01-30T22:05:05.143
> 
> 标签：ruby, selenium, watir, watir-webdriver, web-crawler

第一次和Watir搞混。

```
browser = Watir::Browser.new

browser.goto 'google.com' 
```

我的 Firefox 窗口弹出并停留在空白页面上。当我在命令行中结束脚本时，我得到：

`...ruby-1.9.3-p194/gems/selenium-webdriver-2.29.0/lib/selenium/webdriver/common/socket_poller.rb:95:in`睡眠'：中断`

我确实安装了`selenium-webdriver`gem (2.29)。我的火狐版本是19。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T22:22:42.893

我认为 selenium-webdriver 不支持 Firefox 19。尝试使用 Firefox 18。

# python - Python从列表中获取所有正则表达式匹配组

> ID：14614737
> 
> 赞同：2
> 
> 时间：2013-01-30T22:06:51.537
> 
> 标签：python, regex

假设我已经阅读了文本文件的所有行，如下所示：

```
ifile = open('myfile.txt')
lines = ifile.readlines() 
```

现在，假设我有以下正则表达式：

```
rgx = re.compile(r'Found ([0-9]+) solutions') 
```

我可以用

```
result = filter(rgx.match,lines)
print result 
```

获取匹配列表，但我想要的是匹配组列表。例如，而不是像这样的输出：

```
Found 3 solutions
Found 35 solutions
Found 0 solutions 
```

我想要像这样的输出：

```
3
35
0 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:32:45.060

```
import re

rgx = re.compile(r'Found ([0-9]+) solutions')

with open('myfile.txt') as f:
    result = [m.group(1) for m in (rgx.match(line) for line in f) if m] 
```

内部循环`(rgx.match(line) for line in f)`是一个生成器表达式，其行为类似于`apply()`. 对于文件中的每一行，它调用`rgx.match()`并产生结果，一个`SRE_Match`对象（我通常称之为“匹配对象”）。

外部循环`if m`丢弃任何不评估为真的结果（当模式不匹配时`re.match()`返回）。`None`然后`m.group(1)`使用匹配对象从括号内获取文本。有关详细信息，请参阅`re`模块的文档。由于外循环是列表推导的一部分，因此会构建并返回结果列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:13:24.757

由于前缀和后缀是固定字符串，您可以使用环视：

```
r'(?<=Found )\d+(?= solutions)' 
```

不过，我认为应该有某种方法可以使用您的正则表达式来完成这项工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T22:23:08.090

您可以从 match 命令返回“匹配”对象（除非您使用过滤器将其隐式转换为字符串），唉。没有像样的文档可通过。ipython 帮助，但它在线：[http ://docs.python.org/3/library/re.html#match-objects](http://docs.python.org/3/library/re.html#match-objects)

例如。

```
for line in lines:
  result = rgx.match(line)
  if not result: continue
  print result.group(1) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T22:25:34.820

```
print '\n'.join([m.group(1) for l in lines for m in [rgx.search(l)] if m]) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-05T21:44:27.423

所以这里提供的其他解决方案很好，可能是最易读的，但在你需要的具体例子中，我建议有几个单行替代方案（当然要记住你的问题是从 2013 年开始的，你可能不要在同一家公司工作，更不用说在同一个项目上工作了）。如果有人发现自己在这里，我也认为这是有一些普遍意义的。因为你的前提很简单（每行一个有趣的数据），你可以做以下事情：

```
>>> # simulate reading the (hopefully not ginormous) file into a single string
>>> lines = "Found 3 solutions\nFound 35 solutions\nFound 0 solutions\n"
>>> # we're now in the state we would be after "lines = file.readlines()"
>>> print(lines)
Found 3 solutions
Found 35 solutions
Found 0 solutions

>>> # we're so constrained, we can get away with murder in a single line
>>> solution_counts = re.findall(r'\d+', file_contents)
>>> solution_counts
['3', '35', '0']
>>> # bazinga! 
```

这是一个令人惊讶的强大解决方案。如果您的文件的本地化方式将“找到”和“解决方案”这两个词更改为已翻译的等价词，那么只要格式保持不变，此解决方案就不会在意。不包含十进制整数的页眉和页脚？不在乎。它可以在单个字符串上工作，例如`"Found solution sets of count 3, 35, and 0"`完全相同的代码将提取您想要的答案。但是，更常见的是您知道格式但无法控制它，并且每行/记录都充满了异构数据，并且您关心的部分被您可能关心或可能不关心的其他部分包围。所以考虑下面的古怪变体：

```
file_contents = "99 bottles of beer on the wall\n" \
                "50 ways to leave your lover\n" \
                "6 kinds of scary\n" \
                "Found 3 solutions of type A\n" \
                "Found 35 solutions of type C\n" \
                "Found 4 solutions of unknown type\n" \
                "2 heads are better than 1\n" \
                "etc, ...\n" 
```

我们幼稚的解决方案将返回`['99', '50', '6', '3', '35', '4', '2', '1']`，除非您知道如何过滤掉无关数据，否则这并不是那么有趣，这些数据如此令人困惑、容易出错和脆弱 - 满分 1 星。这将是简单的，并且可能是不错的干净解决方案，涉及迭代行而不是将整个字节流摄取到内存中，但让我们坚持假设我们必须出于某种原因。也许它不是来自文件（从 TCPIP 流或其他任何东西中捕获。使用另一个单行，`lines.split('\n')`我们再次分隔行（没有换行符），并且可以迭代并进行理解等，但我们也可以直接跳到它使用`finditer`

```
>>> [ m.group(1) for m in re.finditer(r'Found (\d+)', file_contents) ]
>>> ['3', '35', '4'] 
```

相当健壮。除非您正在处理大量噩梦文件，否则我什至不确定预编译是否会更快。

# javascript - 主干子视图和事件解除绑定

> ID：14614744
> 
> 赞同：5
> 
> 时间：2013-01-30T22:07:29.073
> 
> 标签：javascript, performance, backbone.js, event-handling, subview

几天以来，我一直在使用 Backbone，阅读设计模式以及你有什么。在阅读了一堆资源之后，今天我正在搞乱子视图。主要是这两个帖子——

Derrick Bailey
[http://lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/](http://lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/)

Ian Storm Taylor
[http://ianstormtaylor.com/assigning-backbone-subviews -制作更清洁/](http://ianstormtaylor.com/assigning-backbone-subviews-made-even-cleaner/)

这些和其他对于帮助我设置一些子视图并以我认为正确的模式处理它们的关闭非常有用：

```
Backbone.View.prototype.close = function(){
    var ctx = this;
    _.each(ctx.subViews(), function(view) {
        view.close();
    });
    this.remove();
    this.unbind();
} 
```

这里没有问题，似乎符合我的预期。但我想测试一下，看看发生了什么。所以我停止在 subViews 上调用 close 并将我的渲染循环 20,000 次：

```
Backbone.View.prototype.close = function(){
    var ctx = this;
    _.each(ctx.subViews(), function(view) {
        //view.close();
    });
    this.remove();
    this.unbind();
} 
```

这里没有僵尸事件处理程序或 DOM 节点。这对我来说有点令人惊讶——我不是 jQuery 内部的专家，我希望至少仍然有来自子节点的事件处理程序。但我想因为我的子视图都包含在父视图中，父视图仍然被删除和解除绑定，jQuery 清除了所有子视图。所以我停止解除绑定父元素：

```
Backbone.View.prototype.close = function(){
    var ctx = this;
    _.each(ctx.subViews(), function(view) {
        //view.close();
    });
    this.remove();
    //this.unbind();
} 
```

我在 Chrome 检查器中的事件处理程序计数仍然没有增加。

所以我的问题是：

当您需要以这种方式巧妙地处理事件解除绑定和子视图时，什么是“真实”示例？它是您的视图直接范围之外的任何对象引用吗？仅当您的子视图不包含在父视图的 $el 中时？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T23:50:18.710

当你从 DOM 中移除一个父视图时，jQuery 确实会清理所有连接在子视图中的 DOM 事件。 `unbind()`是 Backbone's 的别名`Events.off`，它会删除您可能使用`myChildView.on('someEvent', ...)`. 例如，父视图可能会监听您在子视图中触发的事件。如果你这样做了，你需要调用`this.unbind()`or `this.off()`。

现在 Backbone.Events（从 0.9.9 开始）有`listenTo()`and `stopListening()`，你可以考虑添加`this.stopListening()`到你的`close()`. 然后，如果在您看来，您使用了类似的东西，`this.listenTo(this.model, ...)`它们也将被正确清理。

# symfony - 从 FOS 用户包断开 Fr3d LDAP 包

> ID：14614748
> 
> 赞同：1
> 
> 时间：2013-01-30T22:07:44.863
> 
> 标签：symfony, fosuserbundle, fr3dldapbundle

我正在尝试使用 Fr3d LDAP 包和 Symfony2 在进入我的站点之前对用户进行身份验证。

不幸的是，我无法修改架构以形成 FOS 用户包所需的必要用户表。这导致我试图绕过 FOS 用户包，只使用 Fr3d LDAP 包中的功能。

有没有人有关于如何做到这一点的任何信息？我已经找遍了，没有发现任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T14:30:46.970

是的，可以在没有 FOSUserBundle 的情况下使用 FR3DLdapBundle。

只需使用您自己的用户管理器更改 service.user_manager ( [https://github.com/Maks3w/FR3DLdapBundle/blob/2.0.x/Resources/doc/index.md](https://github.com/Maks3w/FR3DLdapBundle/blob/2.0.x/Resources/doc/index.md) )

这是您应该实现的接口[https://github.com/Maks3w/FR3DLdapBundle/blob/2.0.x/Model/UserManagerInterface.php](https://github.com/Maks3w/FR3DLdapBundle/blob/2.0.x/Model/UserManagerInterface.php)

*这是评论[从 FOS 用户包断开 Fr3d LDAP 包](https://stackoverflow.com/questions/14614748/disconnect-fr3d-ldap-bundle-from-fos-user-bundle#comment20476988_14614748)的副本*

# php - 在 URL 字符串中传递 OR

> ID：14614751
> 
> 赞同：-6
> 
> 时间：2013-01-30T22:08:01.863
> 
> 标签：php

如果有办法在查询语句中使用 OR？

我正在寻找的是：

....?var1='ID'&var2='US' **OR** $var2='USA' **OR** $var2='United%20States'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T22:10:42.073

只需在您的 php 文件中执行此操作即可。

例子 ：

```
$var2 = $_GET['var2'];
if($var2 == 'US' || $var2 == 'USA' || $var2 =='United States') {
    //Do your work here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:11:10.683

你可以把它做成一个数组。

```
?var1=ID&var2[]=US&var2[]=USA&var2=United%20States 
```

然后你的`$_GET`会是这样的：

```
array(2) {
  ["var1"]=>
  string(2) "ID"
  ["var2"]=>
  array(3) {
    [0]=>
    string(2) "US"
    [1]=>
    string(3) "USA"
    [2]=>
    string(13) "United States"
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T22:10:34.440

如果“查询语句”是指浏览器的查询字符串，则可以用它构建一个数组，如下所示：

```
var2[]=US&var2[]=USA&var2=United%20States 
```

结果将是一个`$_GET['var2']`包含元素“US”、“USA”和“United States”的数组。

但是，在这种特定情况下，您的应用程序在服务器端知道同义词可能是有意义的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T22:09:58.647

不。

为什么不在处理请求的脚本中应用该逻辑？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-30T22:10:11.320

您可以尝试这样做：

```
?var1='ID'&var2='US'&var2='USA'&var2='United%20States' 
```

这将导致：

```
$_GET = array(
   'var1' => 'ID',
   'var2' => 'United States'
); 
```

所以没有**OR**本身，但最后提交的值获胜。

# c# - 如何使用 textfieldParser 编辑 CSV 文件？

> ID：14614754
> 
> 赞同：3
> 
> 时间：2013-01-30T22:08:19.023
> 
> 标签：c#, parsing, csv, textfield

我编写了一个小函数，它使用 textField 逐行读取 csv 文件，将其编辑为特定字段，然后将其写回 CSV 文件。

这是代码：

```
private void button2_Click(object sender, EventArgs e)
    {
        String path = @"C:\file.csv";
        String dpath = @"C:\file_processed.csv";
        List<String> lines = new List<String>();

        if (File.Exists(path))
        {
            using (TextFieldParser parser = new TextFieldParser(path))
            {
                String line;

                parser.HasFieldsEnclosedInQuotes = true;
                parser.Delimiters = new string[] { "," };

                while ((line = parser.ReadLine()) != null)
                {
                      string[] parts = parser.ReadFields();

                     if (parts == null)
                     {
                         break;
                     }                   

                          if ((parts[12] != "") && (parts[12] != "0"))
                          {

                              parts[12] = parts[12].Substring(0, 3);
                              //MessageBox.Show(parts[12]);
                          }

                    lines.Add(line);
                }
            }
            using (StreamWriter writer = new StreamWriter(dpath, false))
            {
                foreach (String line in lines)
                    writer.WriteLine(line);
            }
            MessageBox.Show("CSV file successfully processed ! ");
        }
    } 
```

我要编辑的字段是第 12 个（部分 [12]）：

```
for example : if parts[12] = 000,000,234 then change to 000 
```

创建文件的问题是它不编辑文件并且一半的记录丢失。我希望有人能指出错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T22:16:59.850

您同时调用`parser.ReadFields()`和`parser.ReadLine()`。 *它们中的每一个*都将光标前进一格。这就是为什么你错过了一半的行。更改`while`为：

```
while(!parser.EndOfData) 
```

然后添加`parts = parser.ReadFields();`到循环的末尾。没有这就是您正在编辑的原因没有被看到。

您还可以删除：

```
if (parts == null)
{
    break;
} 
```

由于您不再拥有`line`，因此您需要使用这些字段来跟踪您的结果：

```
lines.Add(string.Join(",", parts));//handle string escaping fields if needed. 
```

# python - 如何即时生成文件并在下载后将其删除？

> ID：14614756
> 
> 赞同：7
> 
> 时间：2013-01-30T22:08:25.900
> 
> 标签：python, flask

这是我动态创建文件的函数（当用户单击正确的链接时）

```
@app.route('/survey/<survey_id>/report')
def survey_downloadreport(survey_id):
    survey, bsonobj = survey_get(survey_id) #get object
    resps = response_get_multi(survey_id) #get responses to the object

    fields = ["_id", "sid", "date", "user_ip"] #meta-fields
    fields.extend(survey.formfields) #survey-specific fields

    randname = "".join(random.sample(string.letters + string.digits, 15)) + ".csv" #some random file name

    with open("static//" + randname, "wb") as csvf:
        wr = csv.DictWriter(csvf, fields, encoding = 'cp949')
        wr.writerow(dict(zip(fields, fields))) #dummy, to explain what each column means
        for resp in resps :
            wr.writerow(resp)

    return send_from_directory("static", randname, as_attachment = True) 
```

我想在下载完成后删除文件。我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-30T22:17:57.380

在 Linux 上，如果您有一个打开的文件，即使被删除，您仍然可以读取它。做这个：

```
import tempfile
from flask import send_file

csvf = tempfile.TemporaryFile()
wr = csv.DictWriter(csvf, fields, encoding = 'cp949')
wr.writerow(dict(zip(fields, fields))) #dummy, to explain what each column means
for resp in resps :
    wr.writerow(resp)
wr.close()
csvf.seek(0)  # rewind to the start

send_file(csvf, as_attachment=True, attachment_filename='survey.csv') 
```

该`csvf`文件一经创建即被删除；一旦文件关闭，操作系统将回收空间（一旦请求完成并且对文件对象的最后引用被删除，cpython 将为您执行此操作）。或者，您可以使用[`after_this_request`挂钩](https://stackoverflow.com/a/13345241)显式关闭文件对象。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-30T22:19:21.780

我已经成功使用了 os.unlink 一段时间：

```
import os

os.unlink(os.path.join('/path/files/csv/', '%s' % file)) 
```

希望能帮助到你。

# tomcat - Grails分叉的tomcat执行不起作用

> ID：14614758
> 
> 赞同：2
> 
> 时间：2013-01-30T22:08:30.937
> 
> 标签：tomcat, grails, fork

圣杯 2.2.0

我添加了

```
grails.project.fork.run=true 
```

到 Config.groovy 文件。在命令行上，发出：

```
grails run-app 
```

我对 fork 能力的理解是 grails 系统会退出，让 tomcat 继续运行。但它永远不会退出。我必须 control+c 才能离开它，这也会杀死 tomcat。所以我不相信tomcat被分叉了。我错过了什么吗？

在执行运行应用程序时，我在顶部和活动监视器中都看到了一个 Java 进程。我在执行时也只看到一个进程：

```
ps aux | grep java 
```

根据伊恩回答中的评论，我应该看到 2 个进程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T16:24:01.653

文档具有误导性，您必须将该配置行放入`BuildConfig.groovy`，而不是`Config.groovy`（尝试使用 2.2.1 版）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:22:02.903

即使在“分叉”模式下，应用程序仍将在前台运行。分叉的目的是在与 run-app*脚本不同的进程中运行 Grails**应用程序*，以便将应用程序的类路径与运行程序的类路径隔离开（例如，如果它需要依赖某些核心库的不同版本）。

# jquery - 灰色提交按钮，直到填写表格

> ID：14614761
> 
> 赞同：8
> 
> 时间：2013-01-30T22:08:55.257
> 
> 标签：jquery, html, forms, button

我有以下表格：

```
 <form action="http://www.tahara.es/contact/subscribe.php" method="post" id="subscribe" name="subscribe">
      <input type="hidden" name="action" value="subscribe">
      <label>NAME:</label>
      <input type="text" name="name" class="Textbox" id="sub_first_name">
      <label>EMAIL:</label>
      <input type="text" name="email" class="Textbox" id="sub_email">
      <input type="submit" name="button" id="button" value="Subscribe" /> 
```

我想使`submit`按钮变灰，直到表格中的两个字段都填写完毕。我猜jquery会做的伎俩？

我该怎么做，我应该把脚本放在哪里？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-30T22:14:52.320

Jquery 会这样做。在 .keyup 事件上，让 jquery 检查两个字段的长度是否 > 0 并将按钮更改为禁用或不禁用。

```
$('#yourButton').button("disable");​​​​​​​​​​​​​

$('.fields').bind('keyup', function() { 
var nameLength = $("#sub_first_name").length;
var emailLength = $("#sub_email").length;

if (nameLength > 0 && emailLength > 0)
{
   $('#yourButton').button("enable");​​​​​​​​​​​​​
}

} ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:20:11.587

该脚本将进入`<head></head>`您的文档。像这样。

```
<script type="text/javascript" src="yourpath"></script> 
```

一种方法是匹配输入的值，然后如果值与默认值不同，则从按钮中删除灰显的类。这是一个演示。

**HTML**

```
<input type="text" value="some text" class="text-input">
<input attr="" type="submit" value="submit" class="submit"> 
```

**CSS**

```
.disabled {opacity:.2;} 
```

**jQuery**

```
if ($('.text-input').val() == "some text" ) {
    $('.submit').addClass('disabled');    
} 
```

[http://jsfiddle.net/APGmy/11/](http://jsfiddle.net/APGmy/11/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:25:34.257

如果您是 javascript 的初学者，更好的选择是

添加**HTML**如下

```
<form name="myForm" action="demo_form.asp" onsubmit="return validateForm()" method="post">
   First name: <input type="text" name="fname">
   <input type="submit" value="Submit">
</form> 
```

现在添加`validateForm()`为

```
function validateForm() {
   // Validate all fields in the form
   return true; // if all form entries are valid. else return false
} 
```

**注意：**这不会使提交按钮变灰。但在这种情况下，仅当所有条目都有效时，提交才会起作用。

# android - 公共类和全局变量

> ID：14614762
> 
> 赞同：-1
> 
> 时间：2013-01-30T22:08:56.170
> 
> 标签：android, class, global

如何访问变量内容

```
 public class Global extends Application {
    String gotUsername;
    String gotPassword;
    String gotIPAddress;

    void onStartCommand(Intent intent){
        Bundle gotAuthen = intent.getExtras();
        gotUsername = gotAuthen.getString("key1");
        gotPassword = gotAuthen.getString("key2");
        gotIPAddress = gotAuthen.getString("key3"); 
    }

    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate();
    }

} 
```

像这样的公共课？

```
Public Class MyApp {

} 
```

我试过了

```
Global Username = (Global) getApplicationContext(); 
```

但我发现`getApplicationContext();`仅用于活动。

那我该怎么做呢？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:14:00.453

将类中的变量设为`Global`静态。

```
static String variable; 
```

然后您可以通过执行访问它们`String stuff = Global.variable;`

# javascript - 在条件语句中检查多个变量为真的有效方法

> ID：14614765
> 
> 赞同：1
> 
> 时间：2013-01-30T22:09:03.233
> 
> 标签：javascript

在条件语句中检查多个变量是否为真的最有效方法是什么？请看我下面的例子

```
var a = "Complete";
var b = "Complete";
var c = "Complete";
var d = "Complete";
var e = "Complete";

//make this more efficient
if (a == "Complete" && b == "Complete" && c == "Complete" && d == "Complete" && e == "Complete") { 
    //do something
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T22:15:58.633

只有 5 个 vars 你所拥有的可能就可以了，但你可以做这样的事情：

```
var isValid = [a,b,c,d,e].every(function(v) {
  return v == 'Complete';
});

if (isValid) {
  ...
} 
```

如果*所有*项目都满足条件，则该`every`方法返回，否则返回。`true`*`false`*

# javascript - 单击另一个 DIV 时如何让 DIV 消失？

> ID：14614771
> 
> 赞同：0
> 
> 时间：2013-01-30T22:09:13.443
> 
> 标签：javascript, html

我有以下代码，效果很好！当我单击链接 1 时，会出现 DIV 内容。当我再次单击它时，它消失了。如果我再次单击 Link 1，则 DIV 内容会再次出现。如果我这次单击链接 2，内容将与链接 1 内容一起出现。如果单击另一个 DIV 链接，我希望链接 1 消失。我不想在打开另一个内容之前关闭该内容。单击另一个DIV后如何使DIV消失？

Javascript：

```
function show(ele)    {      
    var srcElement = document.getElementById(ele);      
    if(srcElement != null)      {         
      if(srcElement.style.display == "block")         {      
        srcElement.style.display= 'none';       
      }         
      else         { 
        srcElement.style.display='block';         
      }      
    }   
    return false;
  } 
```

分区：

```
<a href="#" onclick="show('link1')">FIRST LINK</a> 
<a href="#" onclick="show('link2')">SECOND LINK</a>

<div id="link1" style="display:none">
   <p>Link 1 Content Displayed</p>
</div>

<div id="link2" style="display:none">
   <p>Link 2 Content Displayed</p>
</div> 
```

我不想改变我这样做的方式，我觉得有一个简单的解决方案，我就是想不通！任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:40:35.433

另一个更好的答案是使用 jQuery，因为它可以让您编写更好的 javascript，而不必担心 IE 是否会崩溃。

在头部包含这个标签：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script> 
```

Javascript：

```
function show( elem )
{
    $('.dynamic_link').hide();
    $('#'+elem).show();
} 
```

HTML：

```
<a href="#" onclick="show('link1')">FIRST LINK</a> 
<a href="#" onclick="show('link2')">SECOND LINK</a>

<div id="link1" class="dynamic_link" style="display:none">
   <p>Link 1 Content Displayed</p>
</div>

<div id="link2" class="dynamic_link" style="display:none">
   <p>Link 2 Content Displayed</p>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:22:59.823

Javascript（修改）：

```
 function show(ele)    {      
    var links = ['link1','link2'];
    var srcElement = document.getElementById(ele);      
    var doShow = true;
    if(srcElement != null && srcElement.style.display == "block")
        doShow = false;
    for( var i = 0; i < links.length; ++i )    {
        var otherElement = document.getElementById(links[i]);      
        if( otherElement != null )
            otherElement.style.display = 'none';
    }
    if( doShow )
        srcElement.style.display='block';         
    return false;
  } 
```

工作示例：http: [//jsfiddle.net/vDKmA/](http://jsfiddle.net/vDKmA/)

# javascript - 自定义谷歌地图 V.3 街景控件

> ID：14614781
> 
> 赞同：1
> 
> 时间：2013-01-30T22:10:00.497
> 
> 标签：javascript, google-maps, google-street-view

我的应用程序中有一个带有完全自定义选项的谷歌地图实例。用户可以切换到街景视图，如果他们愿意，可以使用相同的地图实例返回。

在创建地图实例时，是否可以自定义街景控件以及其他地图选项？

我在主地图上看不到有关如何执行此操作的任何文档，而如果您直接在单独的 dom 元素上实例化街景，则可以这样做：

```
var panoramaOptions = {
    zoomControl: false,
    linksControl: false,
    panControl: false
}
var panorama = new google.maps.StreetViewPanorama(document.getElementById("map_streetview"), panoramaOptions)
mymap.setStreetView(panorama) 
```

有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T00:17:59.810

您可以使用地图的 - 方法访问地图的街景属性（无论是自定义的还是默认的）`getStreetView()`。

使用`setOptions()`streetView 的 -method 设置选项：

```
mymap.getStreetView().setOptions(panoramaOptions); 
```

# math - 模行为背后的数学

> ID：14614787
> 
> 赞同：0
> 
> 时间：2013-01-30T22:10:13.003
> 
> 标签：math, random, statistics, probability, modulo

**前言**

这个问题与 (P)RNG 和 的行为无关`rand()`。这是关于使用对模均匀分布的两个值的幂。

**介绍**

我知道不应该使用模数`%`将一个值从一个范围转换为另一个，例如从`rand()`函数中获取 0 到 5 之间的值：会有偏差。这里解释了[https://bitbucket.org/haypo/hasard/src/ebf5870a1a54/doc/common_errors.rst?at=default](https://bitbucket.org/haypo/hasard/src/ebf5870a1a54/doc/common_errors.rst?at=default)和这个答案[为什么人们说使用随机数生成器时存在模偏差？](https://stackoverflow.com/questions/10984974/why-do-people-say-there-is-modulo-bias-when-using-a-random-number-generator/611560)

但是今天在调查了一些看起来错误的代码之后，我制作了一个工具来演示模数的行为：[https](https://gitorious.org/modulo-test/modulo-test/trees/master) ://gitorious.org/modulo-test/modulo-test/trees/master并发现这还不够清楚。

**一个骰子只有 3 位**

我检查了 0..5 范围内的 6 个值。对这些值进行编码只需要 3 位。

```
$ ./modulo-test 10000 6 3
interations = 10000, range = 6, bits = 3 (0x00000007)
  [0..7] => [0..5]

theorical occurences    1666.67 probability 0.16666667

   [   0] occurences    2446    probability 0.24460000 ( +46.76%)
   [   1] occurences    2535    probability 0.25350000 ( +52.10%)
   [   2] occurences    1275    probability 0.12750000 ( -23.50%)
   [   3] occurences    1297    probability 0.12970000 ( -22.18%)
   [   4] occurences    1216    probability 0.12160000 ( -27.04%)
   [   5] occurences    1231    probability 0.12310000 ( -26.14%)

  minimum occurences    1216.00 probability 0.12160000 ( -27.04%)
  maximum occurences    2535.00 probability 0.25350000 ( +52.10%)
     mean occurences    1666.67 probability 0.16666667 (  +0.00%)
   stddev occurences     639.43 probability 0.06394256 (  38.37%) 
```

使用 3 位输入，结果确实很糟糕，但表现符合预期。见答案[https://stackoverflow.com/a/14614899/611560](https://stackoverflow.com/a/14614899/611560)

**增加输入位数**

令我困惑的是，增加输入位数会使结果有所不同。您不应忘记增加迭代次数，例如样本数，否则结果可能是错误的（请参阅**错误统计**）。

让我们尝试 4 位：

```
$ ./modulo-test 20000 6 4
interations = 20000, range = 6, bits = 4 (0x0000000f)
  [0..15] => [0..5]

theorical occurences    3333.33 probability 0.16666667

   [   0] occurences    3728    probability 0.18640000 ( +11.84%)
   [   1] occurences    3763    probability 0.18815000 ( +12.89%)
   [   2] occurences    3675    probability 0.18375000 ( +10.25%)
   [   3] occurences    3721    probability 0.18605000 ( +11.63%)
   [   4] occurences    2573    probability 0.12865000 ( -22.81%)
   [   5] occurences    2540    probability 0.12700000 ( -23.80%)

  minimum occurences    2540.00 probability 0.12700000 ( -23.80%)
  maximum occurences    3763.00 probability 0.18815000 ( +12.89%)
     mean occurences    3333.33 probability 0.16666667 (  +0.00%)
   stddev occurences     602.48 probability 0.03012376 (  18.07%) 
```

让我们尝试 5 位：

```
$ ./modulo-test 40000 6 5
interations = 40000, range = 6, bits = 5 (0x0000001f)
  [0..31] => [0..5]

theorical occurences    6666.67 probability 0.16666667

   [   0] occurences    7462    probability 0.18655000 ( +11.93%)
   [   1] occurences    7444    probability 0.18610000 ( +11.66%)
   [   2] occurences    6318    probability 0.15795000 (  -5.23%)
   [   3] occurences    6265    probability 0.15662500 (  -6.03%)
   [   4] occurences    6334    probability 0.15835000 (  -4.99%)
   [   5] occurences    6177    probability 0.15442500 (  -7.34%)

  minimum occurences    6177.00 probability 0.15442500 (  -7.34%)
  maximum occurences    7462.00 probability 0.18655000 ( +11.93%)
     mean occurences    6666.67 probability 0.16666667 (  +0.00%)
   stddev occurences     611.58 probability 0.01528949 (   9.17%) 
```

让我们尝试 6 位：

```
$ ./modulo-test 80000 6 6
interations = 80000, range = 6, bits = 6 (0x0000003f)
  [0..63] => [0..5]

theorical occurences   13333.33 probability 0.16666667

   [   0] occurences   13741    probability 0.17176250 (  +3.06%)
   [   1] occurences   13610    probability 0.17012500 (  +2.08%)
   [   2] occurences   13890    probability 0.17362500 (  +4.18%)
   [   3] occurences   13702    probability 0.17127500 (  +2.77%)
   [   4] occurences   12492    probability 0.15615000 (  -6.31%)
   [   5] occurences   12565    probability 0.15706250 (  -5.76%)

  minimum occurences   12492.00 probability 0.15615000 (  -6.31%)
  maximum occurences   13890.00 probability 0.17362500 (  +4.18%)
     mean occurences   13333.33 probability 0.16666667 (  +0.00%)
   stddev occurences     630.35 probability 0.00787938 (   4.73%) 
```

**问题**

请解释一下为什么在更改输入位（并相应地增加样本数）时结果会有所不同？这些背后的数学推理是什么？

**错误的统计**

在以前版本的问题中，我展示了一个 32 位输入和只有 1000000 次迭代的测试，例如 10^6 个样本，并说我很惊讶得到正确的结果。太错误了，我很惭愧：必须有 N 倍以上的样本才能有信心获得生成器的所有 2^32 值。这里 10^6 与 2^32 相比要小得多。 **能够用数学/统计语言解释这一点的人的奖励。**.

这里错误的结果：

```
$ ./modulo-test 1000000 6 32
interations = 1000000, range = 6, bits = 32 (0xffffffff)
  [0..4294967295] => [0..5]

theorical occurences  166666.67 probability 0.16666667

   [   0] occurences  166881    probability 0.16688100 (  +0.13%)
   [   1] occurences  166881    probability 0.16688100 (  +0.13%)
   [   2] occurences  166487    probability 0.16648700 (  -0.11%)
   [   3] occurences  166484    probability 0.16648400 (  -0.11%)
   [   4] occurences  166750    probability 0.16675000 (  +0.05%)
   [   5] occurences  166517    probability 0.16651700 (  -0.09%)

  minimum occurences  166484.00 probability 0.16648400 (  -0.11%)
  maximum occurences  166881.00 probability 0.16688100 (  +0.13%)
     mean occurences  166666.67 probability 0.16666667 (  +0.00%)
   stddev occurences     193.32 probability 0.00019332 (   0.12%) 
```

我仍然需要阅读和重新阅读[Zed Shaw的优秀文章](http://en.wikipedia.org/wiki/Zed_Shaw "劫肖") [“程序员需要学习统计，否则我将杀死他们”](http://zedshaw.com/essays/programmer_stats.html "程序员需要学习统计，否则我会杀了他们")。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-30T22:16:54.327

本质上，你正在做：

```
(rand() & 7) % 6 
```

让我们假设`rand()`均匀分布在 上`[0; RAND_MAX]`，这`RAND_MAX+1`是 2 的幂。很明显，`rand() & 7`可以评估为`0`, `1`, ..., `7`，并且结果是等概率的。

现在让我们看看当你对结果取模时会发生什么`6`。

*   0 和 6 映射到 0；
*   1 和 7 映射到 1；
*   2 映射到 2；
*   3 映射到 3；
*   4映射到4；
*   5 映射到 5。

这就解释了为什么你得到的零和一是其他数字的两倍。

第二种情况也发生了同样的事情。然而，“额外”数字的值要小得多，使得它们的贡献与噪声无法区分。

总而言之，如果你有一个整数均匀分布在 [ `0`; `M-1`]，然后取模`N`，结果将偏向零，除非能被`M`整除`N`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:17:13.430

`rand()`（或其他一些 PRNG）在区间产生值`[0 .. RAND_MAX]`。您想`[0 .. N-1]`使用余数运算符将这些映射到区间。

写

```
(RAND_MAX+1) = q*N + r 
```

与`0 <= r < N`.

然后对于区间中的每个值`[0 .. N-1]`都有

*   `q+1``rand()`如果该值小于该值，则该值将映射到该值`r`
*   `q`如果值为`rand()`，则将其值映射到它`>= r`。

现在，如果是小，则和`q`之间的相对差异很大，但如果是大 -例如 - 差异不容易测量。`q``q+1``q``2^32 / 6`

# php - MySQL 安全问题

> ID：14614797
> 
> 赞同：-5
> 
> 时间：2013-01-30T22:10:55.707
> 
> 标签：php, mysql, sql

哦哦。我刚刚意识到，我认为进入我的 MySQL 数据库非常容易。我的网络服务器使用单独的 PHP 脚本连接到服务器，其中包括用户名和密码。如果我错了，请纠正我，但是有人不能在他们的脚本中轻松地要求这个文件，然后就可以完全访问我的数据库吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T22:12:24.497

不。

只要您的网络服务器将文件解释为 PHP 脚本，您的 PHP 脚本的源代码就永远不会显示给最终用户。

在 PHP 文件中以纯文本形式拥有 db 凭据是很常见的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:25:23.657

正如其他人所提到的，当另一台服务器包含您的文件时，服务器将对其进行解析，因此除非配置不正确，否则他们将得到的只是解析后的文件。

但是，出于这个原因，您不应该将数据库登录凭据存储在您的 Web 根目录中。例如，如果您的 Web 根目录是

```
/home/username/public_html/ 
```

然后将文件存储在：

```
/home/username/db.inc.php // change file name accordingly 
```

然后在你的脚本中，做

```
require_once('/home/username/db.inc.php'); 
```

有人甚至无法从 HTTP 访问该文件，因为它位于您的 Web 根目录之外。

# java - JUnit 断言，值在两个整数之间

> ID：14614799
> 
> 赞同：15
> 
> 时间：2013-01-30T22:10:58.730
> 
> 标签：java, random, junit

我需要为我编写的算法编写一个 JUnit 测试，该算法输出两个已知值之间的随机整数。

我需要一个 JUnit 测试（即一个类似 assertEquals 的测试），它断言输出的值在这两个整数之间（或不在这两个整数之间）。

即我有值 5 和 10，输出将是 5 到 10 之间的随机值。如果测试是正数，则数字在两个值之间，否则不是。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-30T22:21:27.537

```
@Test
public void randomTest(){
  int random = randomFunction();
  int high = 10;
  int low = 5;
  assertTrue("Error, random is too high", high >= random);
  assertTrue("Error, random is too low",  low  <= random);
  //System.out.println("Test passed: " + random + " is within " + high + " and + low);
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2016-07-16T16:09:33.097

你可以使用junit`assertThat`方法（因为`JUnit 4.4`）

见[http://www.vogella.com/tutorials/Hamcrest/article.html](http://www.vogella.com/tutorials/Hamcrest/article.html)

```
import static org.hamcrest.CoreMatchers.allOf;
import static org.hamcrest.Matchers.greaterThan;
import static org.hamcrest.Matchers.lessThan;
import static org.junit.Assert.assertThat; 
```

……

```
@Test
public void randomTest(){
    int random = 8;
    int high = 10;
    int low = 5;
    assertThat(random, allOf(greaterThan(low), lessThan(high)));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-27T06:35:09.793

您可能还会遇到一个情况，例如一个参数是对象，另一个是原始参数，这也不起作用，只需将原始参数更改为对象即可。

例如：

```
Request.setSomething(2);// which is integer field
Integer num = Request.getSomething();

//while testing give the object i.e num 
assertEquals(Request.getSomething(),num); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-21T11:32:58.183

您可以使用支持参数`double`的版本：`assertEquals``delta`

```
assertEquals(double expected, double actual, double delta) 
```

例子：

```
int random = 8;
int high = 10;
int low = 5;

assertEquals((high + low) / 2.0, random, (high - low) / 2.0); 
```

# wireshark - 如何使用 tcpdump 捕获特定数据包的计数？

> ID：14614803
> 
> 赞同：2
> 
> 时间：2013-01-30T22:11:18.687
> 
> 标签：wireshark, tcpdump

我有兴趣计算所有 LDAP/Kerberos/DNS 数据包。

我尝试了以下方法，但这会捕获完整的数据包。

> tcpdump -i any -Z root "tcp 端口 389 或 tcp 端口 88 或 udp 端口​​ 53" -w ~/ldap_kerberos_dns.cap

有没有一种方法可以捕获交换了多少个 ldap/Kerberos/DNS 数据包
而不实际捕获完整数据包。

预期的输出应该是这样的：

```
LDAP:     100  
Kerberos: 200  
UDP:      300 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T05:27:15.683

看一下 tshark 统计数据：

```
$ tshark -r 04.pcap -q -z io,phs
==================================================== ==================
协议层次统计
筛选：

eth 帧：649 字节：124780
  ipv6 帧：605 字节：116558
    udp 帧：212 字节：33686
      dhcpv6 帧：171 字节：28044
      dns 帧：25 字节：2914
      ntp 帧：10 字节：1300
      cldap 帧：6 字节：1428
    icmpv6 帧：80 字节：7008
    tcp 帧：313 字节：75864
      nbss 帧数：108 字节：24063
        smb 帧：7 字节：1554
        smb2 帧：101 字节：22509
          tcp.segments 帧：1 字节：103
      dcerpc 帧：16 字节：4264
        epm 帧数：2 字节：544
        tcp.segments 帧：1 字节：214
        drsuapi 帧：8 字节：2352
      kerberos 帧：16 字节：9358
        tcp.segments 帧：8 字节：2130
      dcerpc.cn_deseg_req 帧数：1 字节：1514
      ldap 帧：16 字节：5945
        tcp.segments 帧：3 字节：1101
          ldap 帧：1 字节：803
  ip 帧：40 字节：8018
    udp 帧：40 字节：8018
      nbdgm 帧：30 字节：7300
        smb 帧：30 字节：7300
          邮槽帧：30 字节：7300
            浏览器框架：30 字节：7300
      dns 帧：10 字节：718
  arp 帧：4 字节：204
==================================================== ==================

```

有关更多信息，请参见[手册页](http://www.wireshark.org/docs/man-pages/tshark.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T22:58:22.677

## tshark方法

如果您有*Wireshark*（基于问题标签，而不是实际问题）`tshark`，那么如果您不介意其详细的统计信息输出，那么按照 @joke 的评论是一种方法：

```
tshark -i any -n -q -z 'io,stat,0,FRAMES()tcp.port==389,FRAMES()tcp.port==88,FRAMES()udp.port==53'
Capturing on Pseudo-device that captures on all interfaces
^C142 packets captured

=============================================
| IO Statistics                             |
|                                           |
| Interval size: 4.319 secs (dur)           |
| Col 1: FRAMES()tcp.port==389              |
|     2: FRAMES()tcp.port==88               |
|     3: FRAMES()udp.port==53               |
|-------------------------------------------|
|                |1       |2       |3       |
| Interval
| Interval       | FRAMES | FRAMES | FRAMES |
|-------------------------------------------|
| 0.000 <> 4.319 |    100 |    200 |    300 |
============================================= 
```

尽管它的输出很冗长，但我认为您无法`tshark`单独接近。另一种更为冗长的方法是：

```
tshark -q -z io,phs "tcp port 389 or tcp port 88 or udp port 53" 
```

这两个命令不写入捕获文件。当您准备好退出时使用`Ctrl`+ ，或查看下面关于自动停止条件的评论。需要注意的是，这些统计数据依赖于*协议解析器*，而不是源/目标端口，因此可能存在差异（例如，没有数据的连接，或内容不符合协议），将报告“格式错误”的数据包。这也意味着如果您优化并且每个数据包仅捕获 40 个字节（将报告“短”TCP 或 UDP 数据包），您将无法获得可靠的结果。`C``-a`

 *## tcpdump 方法

一个简单但不优雅的方法是运行多个`tcpdump`实例（假设 bash 作为一个 shell）——

```
for pp in "tcp port 88" "tcp port 389" "udp port 53"; do
    tcpdump -i any -Z root $pp -w /dev/null  2> ${pp// /-}.stats &
done 
```

数据包不会写入捕获文件（通过 丢弃`/dev/null`）。然后根据需要等待，终止`tcpdump`进程（按列出的 PID，或者`kill %1 %2 %3`如果没有其他后台作业），并检查`.stats`文件：

```
grep captured *.stats
tcp-port-389.stats:0 packets captured
tcp-port-88.stats:0 packets captured
udp-port-53.stats:4 packets captured 
```

## perl 方法

由于这是*stackoverflow*，这是一个快速而肮脏的 perl/libpcap 解决方案（只需添加错误处理）：

```
#!/usr/bin/perl

use Net::Pcap;
use NetPacket::Ethernet;
use NetPacket::IP;
use NetPacket::TCP;
use strict;
use warnings;

my ($dev,$err,$address, $netmask,$pcap,$filter,$cfilter,$fd,%stats);
my $bail=0;
my ($rin,$rout)=('','');

$SIG{INT} = sub { print "quit...\n"; $bail=1; };

$filter='(tcp port 88 or tcp port 389 or udp port 53)';

$dev=Net::Pcap::lookupdev(\$err);
Net::Pcap::lookupnet($dev, \$address, \$netmask, \$err);
$pcap = Net::Pcap::open_live($dev, 60, 1, 0, \$err);
Net::Pcap::pcap_setnonblock($pcap, 1, \$err);
$fd=Net::Pcap::pcap_get_selectable_fd($pcap);
vec($rin,$fd,1)=1;

Net::Pcap::compile( $pcap, \$cfilter, $filter, 0, $netmask);
Net::Pcap::setfilter($pcap, $cfilter);

while (Net::Pcap::dispatch($pcap,0, \&handlepackets, '')>=0) { 
    select($rout=$rin,undef,undef,0.250);
    printf("."); $|=1;
    $bail && last;
};
Net::Pcap::freecode($cfilter);
Net::Pcap::close($pcap);

sub handlepackets() {
    my ($user_data, $header, $packet) = @_;

    my $ether = NetPacket::Ethernet::strip($packet);
    my $ip    = NetPacket::IP->decode($ether);
    my $tcp   = NetPacket::TCP->decode($ip->{'data'});

    if      ($tcp->{'src_port'} < 1024)  {
        $stats{$tcp->{'src_port'}}++;
    } elsif ($tcp->{'dest_port'} < 1024) {
        $stats{$tcp->{'dest_port'}}++;
    }
}

END {
    if (keys %stats) {
        for my $kk (sort keys %stats) {
            my ($name, $aliases, $port, $prot)=getservbyport($kk,"tcp");
            printf("%12s %4i\n",$name,$stats{$kk});
        }
    } else { printf("No stats...\n"); } 
} 
```*

# django - 新贵挂在停止

> ID：14614804
> 
> 赞同：1
> 
> 时间：2013-01-30T22:11:18.917
> 
> 标签：django, linux, gunicorn, upstart

新贵有问题，我可以在哪里启动它，但是当我运行时

```
sudo stop up 
```

它挂了

这是 .conf 文件

```
# my upstart django script
# this script will start/stop my django development server
# optional stuff
description "start and stop the django development server"
version "1.0"
author "Calum"

console log

# configuration variables.
# You'll want to change thse as needed
env DJANGO_HOME=/home/calum/django/django-nexus7/nexus7
env DJANGO_PORT=8000
env DJANGO_HOST=0.0.0.0 # bind to all interfaces

# tell upstart we're creating a daemon
# upstart manages PID creation for you.
expect fork

script
# My startup script, plain old shell scripting here.
chdir $DJANGO_HOME
pwd
exec /usr/bin/python manage.py run_gunicorn -c config/gunicorn
#exec /usr/bin/python manage.py runserver $DJANGO_HOST:$DJANGO_PORT &
# create a custom event in case we want to chain later
emit django_running
end script 
```

如果有人能给我一个关于它为什么挂起的想法，我会非常感激？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T01:02:20.127

想我已经想通了，或者至少得到了一些有用的东西。

```
# my upstart django script
# this script will start/stop my django development server
# optional stuff
description "start and stop the django development server"
version "1.0"
author "Calum"

console log

# configuration variables.
# You'll want to change thse as needed
env DJANGO_HOME=/home/calum/django/django-nexus7/nexus7
env DJANGO_PORT=8000
env DJANGO_HOST=0.0.0.0 # bind to all interfaces

# tell upstart we're creating a daemon
# upstart manages PID creation for you.
#expect fork

script
# My startup script, plain old shell scripting here.
chdir $DJANGO_HOME
/usr/bin/python manage.py run_gunicorn -c config/gunicorn
end script 
```

我学到的可能对其他人有帮助的东西：

*   不要在脚本标签中使用 exec，只需像在 shell 中一样对其进行编码
*   如果你分叉一次，请使用期望叉子
*   如果您分叉两次，请使用期望守护程序

# c# - 通用和数据库

> ID：14614805
> 
> 赞同：-1
> 
> 时间：2013-01-30T22:11:20.357
> 
> 标签：c#, sql, database, generics, stored-procedures

我确定有人问过这个问题；但我找不到确切的上下文。这是新手还是不明智的方法？或者这是一种可以接受的方法。

我有一个正在处理的项目。我有这四个表：

*   顾客
*   地址
*   地点
*   登录

所以数据库是基本的，没什么太疯狂的。

但是我创建了一个`Restful Service`将我的客户端链接到我的服务器。执行我的 Crud 操作需要一个简单的`Insert Command`.

像：

```
 string sqlInsertStr = "INSERT INTO Customer (First, Last, Phone, Email) 
         VALUES (@first, @last, @phone, @email)"; 
```

这样就可以处理我的四张桌子之一；我的想法是这两种方法之一：

1.  使用 a`Generic`来存储每个单独的 Query；然后循环迭代每个查询。
2.  使用`Generic`包含一系列的 a`Stored Procedures`进行迭代。

我的目标是避免多次`strings`迭代并写入数据库。

我的理由是，当客户修改单个字段或整个配置文件时；它将一致地处理所有表格。我知道在`SQL`尝试跨多个表插入数据时它有局限性。

这是一个坏方法吗？这个特别小而且简单。所以我不想发疯；但它是为了学校。所以我试图了解我是否提出了一个有效的解决方案，如果我被认为是一个正确的解决方案？

任何关于此事和解释的意见都会很棒。

* * *

**更新：**

对于造成的混乱，我深表歉意；是的，我有一个对象模型——它包含每个表的每一列的所有信息。我的问题是这样的：

`SQL`不喜欢`Inserting`跨多个表。所以这适用于一张桌子：

```
using (connection)
{
      string sqlInsertStr = "INSERT INTO Customer (First, Last, Phone, Email) 
             VALUES (@first, @last, @phone, @email)";
      connection = new SqlConnection(connectionStr);
      command = new SqlCommand();
      command.Connection = connection;
      command.Connection.Open();
      command.CommandText = sqlInsertStr;

      SqlParameter firstParam = new SqlParameter(@"first", cust.First);
      SqlParameter lastParam = new SqlParameter(@"last", cust.Last);
      SqlParameter phoneParam = new SqlParameter(@"phone", cust.Phone);
      SqlParameter emailParam = new SqlParameter(@"email", cust.Email);

      command.Parameters.AddRange(new SqlParameter[] 
              { firstParam, lastParam, phoneParam, emailParam});
      command.ExecuteNonQuery();
      command.Connection.Close();
} 
```

这将很容易写入一张表；但是需要插入到其他表中的所有其他数据呢？我需要`sqlInsertStr`为每个表创建一个吗？或者我不能简单地做这样的事情：

```
using(connection)
{
     list<string> sqlInsertStr = new list<string>();
     sqlInsertStr.Add("INSERT INTO Customer (First, Last, Phone, Email) 
              VALUES (@first, @last, @phone, @email)"l
     sqlInsertStr.Add("INSERT INTO Address (Street, City, State, Zip, Country)
               VALUES (@Street, @City, @State, @Zip, @Country)";

     connection = new SqlConnection(connectionStr);
     command = new SqlCommand();
     command.Connection = connection;
     command.CommandText = sqlInsertStr;

     // Repeat with Parameters and etc.
} 
```

所以本质上不会使用`Generic`或`StringBuilder`允许我只包含一个字符串来处理所有带有正确数据的插入吗？还是我完全过度思考/困惑自己。我还在学习，所以解释会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:23:58.820

基于这里关于使其工作的[众多问题，我建议不要通过过多泛化来试图变得聪明。](https://stackoverflow.com/search?q=generic+repository)对于任何问题，我推荐的方法是：

1.  让它发挥作用 - 以任何必要的方式（甚至 {gasp} 复制和粘贴）
2.  让它变得更好——重构、泛化等。
3.  让它更快——首先分析和查看最慢的部分

太多的人试图在 2) 和 3)*工作*之前做，最终花费更多的时间进行黑客攻击或微优化只是为了让它工作。如果你先让它工作，你总是可以扔掉你的优化并重新开始，你仍然有一个工作的产品！

说了这么多，不用担心泛型 - 创建四个存储库（每个表一个），然后分析并查看泛型是否可以更清洁。

**评论你的更新**

> 我是否完全过度思考/困惑自己

听起来像。不要试图让一个类处理所有类型的 CRUD 操作，以避免在多个地方使用相同的连接/命令代码。每个存储库（我粗略地使用该术语，意思是处理 CRUD 操作的某个类）都应该有自己的连接/命令代码。如果稍后您决定创建一个处理垃圾工作的基类，那很好 - 或者您可以使用像实体框架或 NHibernate 这样的 ORM 层来为您处理。或者你可以有一个混合物。在你开始工作之后，无论什么效果最好。:)

# html - Html分页符不起作用

> ID：14614808
> 
> 赞同：0
> 
> 时间：2013-01-30T22:11:29.260
> 
> 标签：html, css, printing

尝试在我正在处理的页面中设置分页符，但在打印预览中，我仍然在页面上看到不应该存在的内容。无法弄清楚为什么这不起作用。

在我的 CSS 风格中：

```
.applicant-break hr {page-break-after:always;} 
```

在我的 ASP.NET 代码中......代码的部分视图中，开始标记在那里：

```
<b>Resume</b>
<br />
<asp:Literal runat="server" ID="litResume"></asp:Literal>
<br />
<br />             
<hr class="applicant-break" />
</ItemTemplate>
</asp:Repeater>  
</asp:Panel> 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T22:14:42.070

你的CSS需要

```
hr.applicant-break {page-break-after:always;} 
```

编辑：

[在W3Schools 网站](http://www.w3schools.com/cssref/pr_print_pageba.asp "W3Schools 网站")上做一些阅读，似乎这个 css 属性适用于表格元素

> “将分页行为设置为始终在表格元素后中断”

编辑：

做更多的阅读，似乎浏览器确实支持的不仅仅是表格元素，但是有些浏览器在 HR 和 BR 标签上遇到了问题（[阅读这里](http://www.javascriptkit.com/dhtmltutors/pagebreak.shtml)）

尝试像这样在 hr 之后放置一个 div

```
<hr />
<div class="applicant-break"></div> 
```

并将您的 CSS 更改为

```
div.applicant-break {page-break-after:always;} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T22:54:25.890

所以显然我很傻，我试图相信 Chrome 的打印预览，而不是自己实际打印，在打印时我看到分页符确实有效，感谢您的帮助 mt！:)

对阅读本文的其他人发出如此公平的警告，虽然它很有用，但它并不总是让您始终准确地了解您的打印工作。

# c# - 在 WPF ListView 中刷新转换后的绑定

> ID：14614809
> 
> 赞同：1
> 
> 时间：2013-01-30T22:11:36.307
> 
> 标签：c#, wpf, binding

我有一个带有 GridView（多列）布局的 ListView。有些列有转换器，它使用当前语言环境来美化数字，将 unix 时间戳转换为日期时间字符串，或者只是将枚举转换为它的本地化描述。

语言环境可以在运行时更改，因此我需要一种方法来重新运行这些转换器。请注意，绑定的值本身并没有改变，但是转换器的输出可能会因不同的语言环境而不同。

最好的方法是什么？我不想迭代每个受影响列表的整个集合并调用 OnPropertyChanged。有没有办法强制 ListView 刷新每个绑定，或者只是某些列的绑定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T09:03:59.310

我找到了答案：

```
ICollectionView view = CollectionViewSource.GetDefaultView(MyListView.ItemsSource);
view.Refresh(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:30:01.050

您可以强制 ListView 使用以下内容更新 ItemsSource 绑定：

```
lview.GetBindingExpression(ListView.ItemsSourceProperty).UpdateTarget(); 
```

使用相同的语法，您当然可以变得更具体，并且仅对特定列的绑定强制更新，但根据 ListView 中的行数，您可能看不到性能差异。

# api - 使用 joomla 的 Google 搜索 API

> ID：14614810
> 
> 赞同：0
> 
> 时间：2013-01-30T22:11:48.833
> 
> 标签：api, search, joomla

我想在 joomla 网站中实现谷歌搜索 API。传递搜索查询并在我的模板内容区域内显示结果的最佳方式是什么。制作自定义组件还是有更轻松的解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T14:28:40.950

您可以随时尝试[RokAjaxSearch](http://www.rockettheme.com/extensions-joomla/rokajaxsearch)，因为我相信它能够显示来自 Google 的结果。最重要的是，它是 Ajax，因此不会刷新页面。

希望这可以帮助

# debugging - 用于调试目的的 WSO2 工作流执行跟踪

> ID：14614811
> 
> 赞同：4
> 
> 时间：2013-01-30T22:11:50.690
> 
> 标签：debugging, workflow, wso2, bpel

我们目前正在评估最新的**WSO2 BPS 3.0**作为 Oracle BPEL 的开源替代品。到目前为止，我能够在 BPS 服务器上创建和部署工作流。我也能够对其进行测试，并且一切似乎都运行良好。

然而，问题在于我们可以在 Oracle BPEL 控制台上查看**EXECUTION TRACE 。**我成功地启用了 SOAP TRACING 以查看从 BPEL 流程传入和传出的 SOAP 消息。但是，我希望在工作流的每个中间步骤中看到输出。Oracle 做得很好，我只需单击执行跟踪中的各个步骤并在每个步骤之后查看输出。这是一个非常重要的功能，我很惊讶没有开箱即用。

我还尝试了[BPEL Designer for Eclipse 中的步骤：如何调试 BPEL 流程](https://stackoverflow.com/questions/10103198/bpel-designer-for-eclipse-how-to-debug-a-bpel-process/10222012#10222012)但仍然无法使其工作。

有人可以列出确切的步骤，以便我可以可视化工作流程中每个步骤的输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T05:15:41.423

您可以从实例视图中找到与每个活动对应的输入和输出消息。从管理控制台，转到实例视图并单击给定的流程实例 ID。然后您将进入实例视图。

此外，通过从管理控制台启用soap 跟踪器，您可以查看传入和传出的soap 消息。

此外，您可以在日志级别启用消息跟踪以记录所有进出的消息。

# asp.net-mvc-4 - MVC 4 - 选择一个正确的 ASP.NET MVC 4 项目

> ID：14614812
> 
> 赞同：2
> 
> 时间：2013-01-30T22:11:59.970
> 
> 标签：asp.net-mvc-4

我有一个现有的 MVC 3 Web 应用程序，它只包含网页，并且是使用 Visual Studio 2010 开发的。

现在，我有一个新的需求来开发 REST Web 服务：

使用 MVC 4 和 Visual Studio 2012，我想我会`ASP.NET MVC 4 Project dialog`在 VS 2012 下选择“Web API”项目模板。

通过“Web API”项目模板，我可以将现有的 MVC 3 Web 应用程序合并到新的“Web API”项目中，以继续开发现有的 MVC 3 项目。同时，我也可以在那个“Web API”项目中开发 REST Web 服务。

我的想法是正确的方法吗？如果是这样，我如何将现有的 MVC 3 Web 应用程序合并或转换为 MVC 4“Web API”项目，这样就没有什么可破坏的了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:20:15.377

我会将[MVC3 项目升级到 MVC4](http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253806)。您可以将 Web API 控制器添加到 MVC4 项目。

您可能需要为 API 添加路由：

```
 routes.MapHttpRoute(
      name: "DefaultApi",
      routeTemplate: "api/{controller}/{id}",
      defaults: new { id = RouteParameter.Optional }
  ); 
```

# cmake - 如何让 cmake 解压我的编译器

> ID：14614813
> 
> 赞同：5
> 
> 时间：2013-01-30T22:12:03.403
> 
> 标签：cmake

为了确保无论构建主机使用何种发行版，我的 Linux 构建都是相同的，我已将我的编译器和 sysroot 文件打包到一个可重定位的 tar 文件中，并将其签入源代码控制。

因此，任何构建的第一步（或至少必须在任何编译步骤之前调用的步骤）都必须提取此 tar 文件。

如果我使用的是 makefile，这将很简单。但是，该项目正在使用 cmake，我想不出任何方法来使用 cmake。甚至可能我需要在 cmake 开始检测编译器之前调用此提取步骤：我可以对编译器名称进行硬编码，但是如果 cmake 在找不到编译器的情况下失败，那么我需要在该测试之前进行解包。

这可以用cmake吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-30T22:30:08.693

可以[`execute_process`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3aexecute_process)用来调用 cmake 的跨平台命令模式（[`cmake -E tar`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#opt%3a-E)）。该命令将类似于：

```
execute_process(COMMAND ${CMAKE_COMMAND} -E tar xvf MyCompiler.bz2) 
```

导致 CMake 检查有效编译器的命令是[`project`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3aproject)，因此只要您在`execute_process`调用之前进行`project`调用，解包将在编译器检查之前完成。

# c# - 使用 Ninject 传递构造函数

> ID：14614814
> 
> 赞同：1
> 
> 时间：2013-01-30T22:12:04.473
> 
> 标签：c#, asp.net-mvc, ninject

我有一个基本通用存储库和许多从基本存储库继承的类存储库。我也需要将字符串值传递给通用存储库。

这是我的通用存储库

```
public class Repository<T> where T : EntityBase
    {
        private string SessionId;

        public Repository(string sessionId)
        {
            this.SessionId = sessionId;
        }

        protected virtual IDbConnection GetCn()
        {
            return new SqlConnection(ConfigurationManager.ConnectionStrings["SalesDb"].ConnectionString);
        }

        public virtual int Insert(T entity)
        {
            entity.ChUser = "anders.persson";
            entity.ChTime = DateTime.Now;

            using (IDbConnection cn = GetCn())
            {
                cn.Open();

                return cn.Insert(entity);
            }
        }

        // MORE CODE
        }
    } 
```

还有界面

```
public interface IRepository<T>
{
    int Insert(T entity);

} 
```

我的班级资料库

```
public class MarketRepository : Repository<Market>, IMarketRepository
    {

    } 
```

还有界面

```
public interface IMarketRepository : IRepository<Market>
{

} 
```

现在我想将 sessionId 传递给 Generic Repositories 构造函数。我怎样才能做到这一点。在这种情况下，我必须在每个类存储库中实现一个构造函数并将其传递给基础存储库。而且接口甚至不知道那个构造函数。

这是 Ninject 绑定

```
private static void RegisterServices(IKernel kernel)
{
    kernel.Bind(typeof(IRepository<>)).To(typeof(Repository<>));
    kernel.Bind<ILeadRepository>().To<LeadRepository>();
    kernel.Bind<IPricelistRepository>().To<PricelistRepository>();
    kernel.Bind<IOptionalGroupRepository>().To<OptionalGroupRepository>();
    kernel.Bind<IProductGroupRepository>().To<ProductGroupRepository>();
    kernel.Bind<IProductRepository>().To<ProductRepository>();
    kernel.Bind<IMarketRepository>().To<MarketRepository>();
    kernel.Bind<IModelRepository>().To<ModelRepository>();
    kernel.Bind<IOrderRepository>().To<OrderRepository>();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:28:29.063

这`sessionId`将是一个运行时值，因此您需要在解析时将其传递给 ctor。
这样做的语法是：

```
var reposetory 
    = kernel.Get<IMarketRepository>(new ConstructorArgument("sessionId", sessionId)); 
```

鉴于您不想使用[Service Locator](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)，直接调用`Get`，而是使用 ctor 注入，您可以将其封装在工厂中。

配置：

```
kernel.Bind<IRepositoryFactory>().To<RepositoryFactory>()
      .WithConstructorArgument("kernel", kernel); 
```

工厂：

```
public class RepositoryFactory : IRepositoryFactory
{
    private IKernel _kernel;

    public RepositoryFactory(IKernel kernel)
    {
        _kernel = kernel;
    }

    public T CreateNew<T>(string sessionId)
    {
        return
            _kernel.Get<T>(new ConstructorArgument("sessionId", sessionId));
    }
} 
```

用法：

```
var repository = _repositoryFactory.CreateNew<IMarketRepository>(sessionId); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:31:43.713

您可以将其添加到绑定中：

```
Bind<IMarketRepository>().To<MarketRepository>().WithConstructorArgument("sessionId", "Session ID here"); 
```

# java - add 无法解析为变量

> ID：14614815
> 
> 赞同：-5
> 
> 时间：2013-01-30T22:12:13.897
> 
> 标签：java

请让我声明这是一个家庭作业，任何帮助将不胜感激。

我正在使用 Eclipse (Juno) 编写一个程序，该程序创建一个框架，将一个球放在框架的顶部，并在边框的“南”放置一排按钮。我遇到的问题是在添加按钮的类中，称为 Btns.java，我收到了一些错误。

错误 1：无法将 add 解析为变量 错误 2：构造函数调用必须是构造函数中的第一条语句 错误 3：标记“.”上的语法错误，此标记之后的超预期

代码在我看来是正确的。

Btns 类的代码如下。

```
import java.awt.BorderLayout;
import java.awt.FlowLayout;
import java.awt.*;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class  Btns extends JFrame
{
    public Btns()
    {
        JButton jbtL = new JButton("Left");
        JButton jbtR = new JButton("Right");
        JButton jbtU = new JButton("Up");
        JButton jbtD = new JButton("Down");
        JButton jbtRd = new JButton("Red");
        JButton jbtG = new JButton("Green");
        add.(jbtL);
        add.(jbtR);
        add.(jbtU);
        add.(jbtD);
        add.(jbtRd);
        add.(jbtG);

    }

 } 
```

Lab2.java 代码：

```
import javax.swing.*; 
import java.awt.*;
import java.awt.event.*;

public class Lab2 extends JFrame { 

        public Lab2()
        {
        setLayout(new BorderLayout());

        add(new Ball(), BorderLayout.CENTER);
        add(new Btns(), BorderLayout.SOUTH);
        }

public static void main (String[] args) { 

    Lab2 frame = new Lab2();
    frame.setTitle("Move The Ball");
    frame.setSize(450, 700);
    frame.setLocationRelativeTo(null);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);

    }   
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T22:13:20.800

在方法括号之前你有额外的点：

代替：

```
add.(jbtL);
add.(jbtR);
add.(jbtU);
 ... 
```

和

```
add(jbtL);
add(jbtR);
add(jbtU);
... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-30T22:14:33.487

```
add() 
```

是从`Component`&`Container`类继承的方法，因此您删除点并为您的案例选择正确的实现，请参阅[javadocs](http://docs.oracle.com/javase/6/docs/api/javax/swing/JFrame.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:18:38.467

你甚至写过Java代码吗？

```
 public Btns()
    {
        JButton jbtL = new JButton("Left");
        JButton jbtR = new JButton("Right");
        JButton jbtU = new JButton("Up");
        JButton jbtD = new JButton("Down");
        JButton jbtRd = new JButton("Red");
        JButton jbtG = new JButton("Green");
        super.add(jbtL);
        super.add(jbtR);
        this.add(jbtU);
        super.add(jbtD);
        add(jbtRd);
        add(jbtG);
    } 
```

点用作解析范围运算符以指示某物是类的成员。`super`上面表示超类`JFrame`，其方法`add`派生自`Component`. `this`表示当前对象，它的类型是`Btns`，它也有从 .`add`派生的方法`JFrame`。

`this`并且`super`在大多数情况下不是必需的限定符，因此最后两个调用不使用`super.`

此外，如果您将类型的对象添加`Btns`到主框架，那么您应该扩展`JInternalFrame`而不是`JFrame`.

```
public class Btns extends javax.swing.JInternalFrame { 
```

然后是构造函数：

```
public Lab2() {
   JDesktopPane p = new JDesktopPane();
   add(p);
   p.add(new Btns());
} 
```

# ios - 在 iPhone 上使用通讯录的默认语言

> ID：14614818
> 
> 赞同：0
> 
> 时间：2013-01-30T22:12:15.180
> 
> 标签：ios

我正在使用`peoplePickerNavigationController`让人们浏览 iPhone 的通讯录并获取联系电话。

但是在我的法国 iPhone 上，当我使用它时，它会向我显示菜单，如“所有联系人”或“家”之类的英文菜单。

如何告诉我`peoplePickerNavigationController`使用 iPhone 的默认语言？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T23:26:59.200

听起来您的应用程序不会说法语。您需要在 info.plist中设置[CFBundleLocalizations 。](https://developer.apple.com/library/mac/#documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html)现在，默认语言是英语。如果您设置了英语和法语，`peoplePickerNavigationController`将根据手机设置 --> 常规 --> 国际 --> 语言显示正确的语言。

# c++ - 如何在 C++ Builder 中创建 ITaskbarList3？

> ID：14614823
> 
> 赞同：2
> 
> 时间：2013-01-30T22:12:26.033
> 
> 标签：c++, winapi, windows-7, taskbar, c++builder-2010

我正在尝试使用 Windows 7 引入的[ITaskbarList3](http://msdn.microsoft.com/en-us/library/windows/desktop/dd391692%28v=vs.85%29.aspx)界面，以便可以在任务栏图标中显示冗长任务的任务进度。文档指出，在尝试初始化 ITaskbarList3 组件之前，我应该等待 TaskbarButtonCreated 消息，但我似乎没有收到任何 TaskbarButtonCreated 消息。

这是我到目前为止所拥有的：

我的 .cpp 文件中有一个全局变量来存储 TaskbarButtonCreated 的自定义消息 ID。

```
static const UINT m_uTaskbarBtnCreatedMsg = 
    RegisterWindowMessage( _T("TaskbarButtonCreated") ); 
```

我创建了一个单独的 WndProc 函数来处理新消息。

```
void __fastcall TForm1::WndProcExt(TMessage &Message)
{
    if(Message.Msg == uTaskbarBtnCreatedMsg && uTaskbarBtnCreatedMsg != 0) {
        OnTaskbarBtnCreated();
    }
    else {
        WndProc(Message);
    }
} 
```

在我的表单构造函数中，第一行将 WindowProc 属性设置为 WndProcExt 以路由消息。我还尝试在 ChangeWindowMessageFilter 中折腾，以查看 TaskbarButtonCreated 消息是否因某种原因被过滤。

```
__fastcall TForm1::TForm1(TComponent* Owner) : TForm(Owner)
{
    WindowProc = WndProcExt;
    ChangeWindowMessageFilterEx(Handle, uTaskbarBtnCreatedMsg, MSGFLT_ALLOW, NULL);

    ...
} 
```

在调试器中，ChangeWindowMessageFilterEx 的返回值始终为 true。我还确认我的 WndProcExt 函数接收到各种 Windows 消息，但不是我要查找的消息。OnTaskbarBtnCreated 函数永远不会被调用。

我错过了一步吗？在我的消息处理程序准备好之前，消息是否被过滤或发送？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T04:38:26.003

让 TForm 为其自己的属性赋值并不是一个好主意`WindowProc`。对于初学者来说`Handle`，由于 DFM 流的原因，甚至在进入构造函数之前，窗口可能已经被分配，因此在构造函数开始运行之前，您会错过所有窗口的初始消息（可能有多个消息）。您需要改写虚拟`WndProc()`方法，并将 TaskbarButtonCreated 消息传递给默认处理程序，不要阻止它：

```
static const UINT m_uTaskbarBtnCreatedMsg = RegisterWindowMessage( _T("TaskbarButtonCreated") );

void __fastcall TForm1::WndProc(TMessage &Message)
{
    TForm::WndProc(Message);
    if ((Message.Msg == uTaskbarBtnCreatedMsg) && (uTaskbarBtnCreatedMsg != 0))
        OnTaskbarBtnCreated();
} 
```

至于`ChangeWindowMessageFilterEx()`，您需要在每次 TForm 的`Handle`窗口获得（重新）分配时调用它（这可能在 Form 的生命周期内发生多次），因此您需要重写虚拟`CreateWnd()`方法：

```
void __fastcall TForm1::CreateWnd()
{
    TForm::CreateWnd();
    if (CheckWin32Version(6, 1) && (uTaskbarBtnCreatedMsg != 0))
        ChangeWindowMessageFilterEx(Handle, uTaskbarBtnCreatedMsg, MSGFLT_ALLOW, NULL);
    // any other Handle-specific registrations, etc...
}

void __fastcall TForm1::DestroyWindowHandle()
{
    // any Handle-specific de-registrations, etc...
    TForm::DestroyWindowHandle();
} 
```

最后，在创建之前将`TApplication::ShowMainFormOnTaskbar`属性设置`true`为项目的`WinMain()`功能，`MainForm`以便其窗口而不是`TApplication`窗口管理任务栏按钮（并启用其他 Vista+ 相关功能，如翻转 3D 和任务栏预览）。否则，您将不得不使用该`TApplication::HookMainWindow()`方法拦截可能发送到`TApplication`窗口的任何“TaskbarButtonCreated”消息。

# javascript - 使用纯 Javascript 和无服务器端技术在客户端安全地将表单值从一个页面发布到另一个页面

> ID：14614838
> 
> 赞同：0
> 
> 时间：2013-01-30T22:13:20.863
> 
> 标签：javascript, post

我需要使用 Javascript 将表单值从一个页面发布到另一个页面。

现在，我知道我可以使用像 ASP.Net 或 PHP 这样的服务器端技术来发布值，但我不能使用任何服务器端脚本。我知道使用 GET 方法，我可以将表单值作为查询字符串传递，但这些值不会安全地传递（这是一个重要的要求！）

下列条件：

1.  此代码应采用发布到页面的值并重新发布到目标页面。仅 HTTP POST（不获取）。
2.  在任何情况下，即使是错误，请求也不应该在此桥接页面上停止。
3.  该脚本需要处理多个发布的值。
4.  尝试使用标准 javascript（没有 3rd 方库）
5.  脚本需要在 IE、FF、Safari、大多数标准浏览器中工作

任何人都可以帮我找到解决方案或向我指出一些可以帮助我找到解决方案的资源吗？提前致谢。下面是将值作为查询字符串传递的代码。我可以修改它以满足我的上述要求吗？

形式

```
<html>
<head>
<title>Test</title>
<script type="text/javascript">

function goto_page(page) {
    var usbnum = document.getElementById('usbnum').value;
    var usbcode = document.getElementById('usbcode').value;
    var q_str = '?usbnum=' + usbnum + '&usbcode=' + usbcode;

    var url = page + q_str;

    window.location = url;
}

</script>
</head>
<form id="form1" method="post">
<div>
    USB No: <input name="usbnum" id="usbnum" type="text" size="80" /><br />
    USB Code: <input name="usbcode" id="usbcode" type="text" size="80"/>
</div>
<a href="#" onclick="goto_page('bridgepage.html');">Next</a>
</form>

</body>
</html> 
```

桥页

```
<html>
<head>
<title>Bridge Page</title>

<script type="text/javascript">
function get_params() {
    var url = window.location.href;
    var q_str_part = url.match(/\?(.+)$/)[1];

    var val_pairs = q_str_part.split('&');
    var params = {};

    for (var i = 0; i < val_pairs.length; i++) {
        var tmp = val_pairs[i].split('=');
        params[tmp[0]] = typeof tmp[1] != 'undefined' ? tmp[1] : '';
    }

    return params;
}

function write_params() {
    var params = get_params();

    var txt = 'Hello ';

    for (var i in params) {
        txt += params[i] + ' ';
    }

    var body = document.getElementsByTagName('body')[0];
    body.innerHTML += txt;
}

function write_params() {
  var params = get_params();

  var num_container = document.getElementById('usbnum');
  var code_container = document.getElementById('usbcode');

  num_container.innerHTML = params.usbnum;
  code_container.innerHTML = params.usbcode;
}
</script>
</head>

<body onLoad="write_params()">

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:21:38.690

**POST 数据只能由服务器端代码处理。**如果**没有****服务器端代码的帮助，**您将无法在 javascript 中使用它们。

您只能使用**GET**或者您可以考虑使用**cookie**。但是另一方面，为什么要更改当前页面？！您可以使用 AJAX 加载更多数据而无需刷新，也无需发布或获取变量。

# visual-studio-2012 - MASM 不会在 Visual Studio 2012 中编译

> ID：14614839
> 
> 赞同：0
> 
> 时间：2013-01-30T22:13:20.933
> 
> 标签：visual-studio-2012, assembly, masm, irvine32

最近我开始阅读*“x86 处理器的汇编语言”*，并且我已经了解了我需要编译我的代码的部分。所以我去谷歌搜索了如何正确设置 VS12 的 masm。有一段时间，它工作得很好，但我决定从 MASM 休息一下，现在当我突然回来时，这开始发生了。我收到随机错误，例如，编译器无法区分注释并将它们视为错误，我也收到 LNK1104 错误，说我的文件不存在。

这些是我使用的设置：http: [//kipirvine.com/asm/gettingStartedVS2012/index.htm#ProjectProperties](http://kipirvine.com/asm/gettingStartedVS2012/index.htm#ProjectProperties)

如果有人知道我如何解决这个问题，哦，代码真的很简单。这里：

```
.386
.model flat
.stack 4096

INCLUDE Irvine32.inc
.data

.code
main PROC
    mov eax, 1337
    exit
main ENDP
END main 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T03:19:51.687

通过从 Irvine32.inc 中删除包含，我能够编译您的代码

在这种情况下，您还必须移除出口。

我尝试使用 Visual Studio 提示符中的 ML 和 Link 命令...此处描述的过程：[在 Visual Studio 中编译程序集](https://stackoverflow.com/questions/4548763/compiling-assembly-in-visual-studio)

```
ml /c /Cx /coff code.asm 
```

你得到 code.obj 作为输出。

链接：

```
link code.obj /SUBSYSTEM:console /out:go.exe /entry:main 
```

现在试试他的包含文件和他的库。

# jquery - jquery - 背景图像 - 资源解释为图像，但使用 MIME 类型 text/html 传输

> ID：14614844
> 
> 赞同：1
> 
> 时间：2013-01-30T22:13:29.413
> 
> 标签：jquery, css, background-image, mime

我在 jquery 中使用以下方法为一组 div 加载背景图像（在 $(document).ready(function(){} 中）：

```
$('.outD').each(function(){
    var inD = $(this).children().eq(0);
    /* EACH INNER DIV HAS AN INPUT ELEMENT WHOSE NAME MATCHES THE 
    BACKGROUND-IMAGE's NAME */
    /* SO I GATHER THE PORTION OF THE INPUT NAME TO BE USED IN THE 
    BACKGROUND-IMAGE URL */
    var imgName = inD.find('input[name="usr_min"]').next().attr('name').split('_');
    /* THEN I CREATE THE URL STRING TO BE INSERTED INTO THE CSS LINE BELOW */
    var backImg = "url('imgs/" + imgName[0] + ".png')";
    /* ALL THE ABOVE IS WORKING FINE AS I GET THE PROPER URL STRING ALERTED BELOW */ 
    alert(backImg);
    /* BUT WHEN I CALL THE FOLLOWING LINE TO ACTUALLY APPLY THE BACKGROUND IMAGE
    TO EACH OF THE $('.outD') DIVS LISTED, ONLY THE FIRST DIV GETS THE PROPER
    BACKGROUND IMAGE APPLIED */
    $(this).css("background-image",  backImg);
}); 
```

对于 $('.outD') div 的其余部分，我收到“资源解释为图像，但在 chrome 调试中使用 MIME 类型 text/html 传输，并且由于背景保持白色，因此似乎没有加载图像。

关于为什么设置背景图像仅适用于第一个 div 但返回上面列出的所有剩余 div 的错误的任何想法？

这是受影响的 div 的 html：

```
<div class="outD">
    <div class="inD1">
        <img src="./sHandle.png" style="width: 16px; height: 24px;" alt="">
        <img src="../sBack.png" alt="">
        <input type="hidden" name="usr_min" value="<?php echo minVal ?>">
        <input type="hidden" name="pChange_Min" value="">
        <input type="hidden" name="pChange_index" value="">
        <input type="hidden" name="isPercent" value="true">
    </div>
    <div class="inD2">
        <img src="./sHandle.png" style="width: 16px; height: 24px;" alt="">
        <img src="../sBack.png" alt="">
        <input type="hidden" name="usr_max" value="<?php echo maxVal; ?>">
        <input type="hidden" name="pChange_Max" value="">
    </div>
</div> 
```

同样，上述每个 div 对于紧跟在“usr_min”输入元素之后的输入元素都有不同的输入名称。在 outD div 中作为背景加载的每个图像都以该输入元素的名称命名。即在这种情况下，图像 url 被调用，并在 alert(imgName); 上面的声明是：

```
imgs/pChange.png 
```

正如我之前所说，这适用于第一个 div，但不适用于布局相同的其余 div。

# php - preg_replace 异常对我不起作用

> ID：14614851
> 
> 赞同：0
> 
> 时间：2013-01-30T22:14:10.403
> 
> 标签：php, regex, preg-replace

我已经遇到了一个“小”问题......我只想用其他名称或其他名称替换一些名称。到目前为止它工作正常，但有些名字我遇到了问题。

例如我想替换`"Cho"`为`"Cho'Gath"`，但我当然不想替换`"Cho'Gath"`为`"Cho'Gath'Gath"`。

因此，我创建了这个正则表达式，并替换了所有`"Cho"`的除了`"Cho'Gath"`：

```
/\bCho(?!.+Gath)\b/i 
```

这有效，它不能取代`"Cho'Gath"`，但它也不能取代`"Cho Hello World Gath"`......这是我的第一个问题！

第二个是以下：我也想替换 all `"Yi"`，但不是`"Master Yi"`，所以我尝试了以下正则表达式：

```
/\b(?!Master.+)Yi\b/i 
```

这不能代替`"Master Yi"`，好吧。但它也不能取代`"Yi"`，但它应该做！（我也试过`/\b(?!Master(**\s**))Yi\b/i`，但这也不起作用）

到目前为止，我不知道该怎么做……有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:19:01.633

对于第一个正则表达式：

```
\bCho(?!.Gath)\b 
```

对于第二个：

```
(?<!\bMaster )Yi\b 
```

您的第一个正则表达式`.+`包含在其中，即一个字符，一次或多次；并且由于量词默认是贪婪的，这会在不情愿地回馈匹配下一个标记（`G`）之前吞下整个输入。

您的第二个正则表达式使用了否定的lookahead，而您想要的是否定的*lookbehind*。即，该位置*之前*的文本不匹配的位置。

请注意，lookbehinds 中的正则表达式必须是有限长度的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:37:26.977

如果您替换`.+`为您想要匹配（或不匹配）的实际字符，您的第一个问题很容易解决：`'`但是让我们看看第二个，这很有趣：

> 我也想替换所有的“易”，而不是“易大师”，所以我用下面的正则表达式尝试了同样的方法：
> 
> ```
> /\b(?!Master.+)Yi\b/i 
> ```

这是对 的负面展望`\b`。该表达式**确实**匹配单个“Yi”，但看看它与“Master Yi”的作用：

```
Hello I am Master Yi
                 ^
                 \b 
```

此界不是“师”，而是“义”。所以你的表达式也匹配这个字符串中的“Yi”。

否定的前瞻是毫无意义的，因为它检查“Yi”直接跟随的边界（请记住，前瞻断言只是“向前看”而不向前移动指针）不是直接跟随“Master”。情况总是如此。

您可以改用后向断言，但只能不使用 (反正不必要) `.+`，因为后向断言必须具有固定长度：

```
/\b(?<!Master )Yi\b/i 
```

匹配前面没有“Master”的每个“Yi”。

# javascript - Jquery 脚本不适用于 IE

> ID：14614852
> 
> 赞同：0
> 
> 时间：2013-01-30T22:14:12.563
> 
> 标签：javascript, jquery

我编写了这个脚本，将 JavaScript 功能添加到我的网上商店，该脚本在 Firefox 和 Chrome 上运行良好，但不能在 ie 上运行，我不知道为什么？

我正在使用`jQuery(function( $ ){`而不是`.ready`由于脚本冲突，我已经测试了使用的脚本`.ready`，但它仍然不适用于 ie。

如果有人有想法，他们将不胜感激。

```
jQuery(function( $ ){

setInterval(function(){ updatecart();  },8000);

   $('.addtobag').on('click', function(){
       event.preventDefault();
       var postdata = new Object();

       var action = $(this).closest('form').attr('action');

      $(':input',$(this).closest('form')).each(function(evt){

        var L = $(this).attr('name')
        postdata[L] = $(this).val();

      });

       $.post(action, postdata);

       generate('success'); //display banner
        updatecart();   //update cart

            });

    var postdata = new Object();

    postdata['basket'] = phpbasket;

     function updatecart() {

      $.post("/get_cart_details.php", postdata, function (data) {
                      var obj = $.parseJSON(data);
                           $('#qty_js').text(obj.items_qty);
                           $('#amt_js').text(obj.items_value);
                           });

     }

  function generate(type) {
    var n = noty({
        text: 'The item(s) have been added to your basket.',
        type: type,
      dismissQueue: true,
        layout: 'topCenter',
        theme: 'defaultTheme'
    });
    console.log('html: '+n.options.id);

         setTimeout(function() {
      $.noty.closeAll();
    }, 5000);
  }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:20:20.863

摆脱`console.log()`声明。IE < 9 会阻塞它，而 9 仅在控制台打开时才有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:23:11.207

在某些浏览器而不是 IE 中可以容忍的几件事是第 12 行末尾缺少分号，并且变量 phpbasket 没有定义（尽管如果你在闭包之外用 'var phpbasket' 定义它，那么你应该没关系。如果你在 IE 9 或更高版本中调试它，你应该能够在控制台中看到错误的行号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:16:36.263

`event`尝试在点击回调中添加参数

```
$('.addtobag').on('click', function(event){ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-05T15:12:09.003

不是一个完整的答案，但它可能会为您指明正确的方向。我实际上正要问一个类似的问题——我找到了如何让 IE 11 加载 jquery，但它需要用户点击“f12”然后“运行 activex”，因为显然 IE 认为我的代码可能不安全。但是当用户告诉 activex 运行时，它工作正常。

我正在尝试学习如何使用 jquery 来制作对触摸屏友好的下拉菜单，所以我的代码是基本的 - 没有 css，没有 doctype，只有基本的 html 和 js。如果其他人可以对此有所了解，那就太好了。

# symfony - 如何在 Symfony2 的 APYDataGridBundle 中过滤结果？

> ID：14614856
> 
> 赞同：2
> 
> 时间：2013-01-30T22:14:41.010
> 
> 标签：symfony, grid, bundle

我一直在寻找一种在 APYDataGridBundle 网格应该返回但找不到答案的项目列表上设置条件的方法。

有没有办法设置 DQL 查询并将其传递给网格以显示我想要获取的确切查询结果？

这是代码：

```
public function filteredlistAction(){
    // Create simple grid based on the entity
    $source = new Entity('ACMEBundle:MyEntity');
    // Get a grid instance
    $grid = $this->get('grid');

    // Attach the source to the grid
    $grid->setSource($source);
    ...
    ...

    **$grid->getColumns()->getColumnById('myentity_filter_column')->setData('the exact value I tried to match');**

    // Manage the grid redirection, exports and the response of the controller
    return $grid->getGridResponse('ACMEBundle:MyEntity:index_filteredlist.html.twig');
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T11:40:26.533

您可以在执行之前添加一个回调（闭包或可调用）以运行`QueryBuilder`- 它的完成方式如下：

```
$source->manipulateQuery(
    function ($query)
    {
        $query->resetDQLPart('orderBy');
    }
);

$grid->setSource($source); 
```

`$query`是一个实例，`QueryBuilder`因此您可以更改所需的任何内容

[示例取自此处的文档](https://github.com/Abhoryo/APYDataGridBundle/blob/master/Resources/doc/grid_configuration/manipulate_query.md)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-04T06:35:15.200

一个更“复杂”的查询。

```
$estaActivo = 'ACTIVO';
$tableAlias = $source->getTableAlias();
$source->manipulateQuery(
                            function ($query) use ($tableAlias, $estaActivo)
                            {
                                $query->andWhere($tableAlias . '.estado = :estaActivo')
                                      ->andWhere($tableAlias . '.tipoUsuario IN (:rol)')
                                      ->setParameter('estaActivo', $estaActivo)
                                      ->setParameter('rol', array('VENDEDOR','SUPERVISOR'), \Doctrine\DBAL\Connection::PARAM_STR_ARRAY);
                            }
                        ); 
```

干杯!

# screen - JIRA 在数据库导入后单击“创建问题”按钮时挂起

> ID：14614858
> 
> 赞同：0
> 
> 时间：2013-01-30T22:14:43.287
> 
> 标签：screen, jira, freeze

这很奇怪，但我想知道是否有人可能对此有所了解。

我正在通过使用屏幕方案自动创建有关创建某个问题类型的几个子任务。这在已部署的 JIRA 实例上运行良好，但为了测试它，我转储了数据库并将其导入到开发实例中。

因此，一切都显示得很好（屏幕方案、字段、分配给正确的项目等），但是当我在问题创建屏幕中点击“创建问题”按钮时，JIRA 挂断了。最终它可能会完成，但即使完成，也不会创建任何子任务。

此外，不仅新的问题类型受到影响，而且如果没有 JIRA 挂起，我将无法再创建*任何问题。*同样，有时会在几分钟后创建问题，有时会超出我的耐心。

这是一些日志：

```
[INFO] [talledLocalContainer] Exception in thread "QuartzWorker-1" Exception in thread "QuartzWorker-0" java.lang.OutOfMemoryError: Java heap space
[INFO] [talledLocalContainer]   at java.util.HashMap.addEntry(HashMap.java:753)
[INFO] [talledLocalContainer]   at java.util.HashMap.put(HashMap.java:385)
[INFO] [talledLocalContainer]   at java.util.HashSet.add(HashSet.java:200)
[INFO] [talledLocalContainer]   at java.util.AbstractCollection.addAll(AbstractCollection.java:305)
[INFO] [talledLocalContainer]   at com.atlassian.crowd.model.application.DirectoryMapping.<init>(DirectoryMapping.java:69)
[INFO] [talledLocalContainer] Jan 30, 2013 9:37:05 AM org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor processChildren
[INFO] [talledLocalContainer]   at com.atlassian.crowd.embedded.ofbiz.OfBizApplication$1.apply(OfBizApplication.java:70)
[INFO] [talledLocalContainer] SEVERE: Exception invoking periodic operation: 
[INFO] [talledLocalContainer]   at com.atlassian.crowd.embedded.ofbiz.OfBizApplication$1.apply(OfBizApplication.java:67)
[INFO] [talledLocalContainer] java.lang.OutOfMemoryError: Java heap space
[INFO] [talledLocalContainer]   at com.google.common.collect.Lists$TransformingRandomAccessList.get(Lists.java:431)
[INFO] [talledLocalContainer]   at java.nio.ByteBuffer.wrap(ByteBuffer.java:350)
[INFO] [talledLocalContainer]   at java.util.AbstractList$Itr.next(AbstractList.java:345)
[INFO] [talledLocalContainer]   at java.nio.ByteBuffer.wrap(ByteBuffer.java:373)
[INFO] [talledLocalContainer]   at com.google.common.collect.Iterators$8.next(Iterators.java:696)
[INFO] [talledLocalContainer]   at java.lang.StringCoding$StringEncoder.encode(StringCoding.java:237)
[INFO] [talledLocalContainer]   at com.google.common.collect.Iterators$7.computeNext(Iterators.java:602)
[INFO] [talledLocalContainer]   at java.lang.StringCoding.encode(StringCoding.java:272)
[INFO] [talledLocalContainer]   at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:135)
[INFO] [talledLocalContainer]   at java.lang.String.getBytes(String.java:946)
[INFO] [talledLocalContainer]   at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:130)
[INFO] [talledLocalContainer]   at java.io.UnixFileSystem.getLastModifiedTime(Native Method)
[INFO] [talledLocalContainer]   at com.atlassian.crowd.manager.application.ApplicationServiceGeneric.findUserByName(ApplicationServiceGeneric.java:242)
[INFO] [talledLocalContainer]   at java.io.File.lastModified(File.java:826)
[INFO] [talledLocalContainer]   at com.atlassian.crowd.manager.application.ApplicationServiceGeneric.isUserNestedGroupMember(ApplicationServiceGeneric.java:1413)
[INFO] [talledLocalContainer]   at org.apache.catalina.startup.HostConfig.checkResources(HostConfig.java:1158)
[INFO] [talledLocalContainer]   at com.atlassian.crowd.embedded.core.CrowdServiceImpl.isUserMemberOfGroup(CrowdServiceImpl.java:261)
[INFO] [talledLocalContainer]   at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1271)
[INFO] [talledLocalContainer]   at com.atlassian.crowd.embedded.core.CrowdServiceImpl.isUserMemberOfGroup(CrowdServiceImpl.java:266)
[INFO] [talledLocalContainer]   at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:296)
[INFO] [talledLocalContainer]   at com.atlassian.crowd.embedded.core.DelegatingCrowdService.isUserMemberOfGroup(DelegatingCrowdService.java:70)
[INFO] [talledLocalContainer]   at com.atlassian.crowd.embedded.core.FilteredCrowdServiceImpl.isUserMemberOfGroup(FilteredCrowdServiceImpl.java:194)
[INFO] [talledLocalContainer]   at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.roles.actor.GroupRoleActorFactory$GroupRoleActor.contains(GroupRoleActorFactory.java:93)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1337)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.roles.actor.GroupRoleActorFactory$GroupRoleActor.contains(GroupRoleActorFactory.java:84)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1601)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.roles.CachingProjectRoleAndActorStore$CachedDefaultRoleActors.contains(CachingProjectRoleAndActorStore.java:499)
[INFO] [talledLocalContainer]   at com.atlassian.jira.notification.type.ProjectRoleSecurityAndNotificationType.hasPermission(ProjectRoleSecurityAndNotificationType.java:159)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1610)
[INFO] [talledLocalContainer]   at com.atlassian.jira.permission.DefaultPermissionSchemeManager.hasSchemePermission(DefaultPermissionSchemeManager.java:415)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1590)
[INFO] [talledLocalContainer]   at com.atlassian.jira.permission.DefaultPermissionSchemeManager.hasPermission(DefaultPermissionSchemeManager.java:380)
[INFO] [talledLocalContainer]   at java.lang.Thread.run(Thread.java:680)
[INFO] [talledLocalContainer]   at com.atlassian.jira.permission.DefaultPermissionSchemeManager.hasSchemeAuthority(DefaultPermissionSchemeManager.java:323)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.AbstractPermissionManager.hasProjectPermission(AbstractPermissionManager.java:228)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.AbstractPermissionManager.hasPermission(AbstractPermissionManager.java:155)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.AbstractPermissionManager.hasPermission(AbstractPermissionManager.java:140)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.AbstractPermissionManager.getProjectObjectsWithPermission(AbstractPermissionManager.java:360)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.AbstractPermissionManager.getProjectObjects(AbstractPermissionManager.java:319)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.ThreadLocalCachingPermissionManager.getProjectObjects(ThreadLocalCachingPermissionManager.java:36)
[INFO] [talledLocalContainer] java.lang.OutOfMemoryError: Java heap space
[INFO] [talledLocalContainer]   at org.apache.lucene.store.IndexInput.clone(IndexInput.java:218)
[INFO] [talledLocalContainer]   at org.apache.lucene.store.BufferedIndexInput.clone(BufferedIndexInput.java:192)
[INFO] [talledLocalContainer]   at org.apache.lucene.index.CompoundFileReader$CSIndexInput.clone(CompoundFileReader.java:227)
[INFO] [talledLocalContainer]   at org.apache.lucene.index.SegmentTermDocs.<init>(SegmentTermDocs.java:48)
[INFO] [talledLocalContainer]   at org.apache.lucene.index.SegmentReader.termDocs(SegmentReader.java:1030)
[INFO] [talledLocalContainer]   at org.apache.lucene.index.DirectoryReader$MultiTermDocs.termDocs(DirectoryReader.java:1200)
[INFO] [talledLocalContainer]   at org.apache.lucene.index.DirectoryReader$MultiTermDocs.termDocs(DirectoryReader.java:1187)
[INFO] [talledLocalContainer]   at org.apache.lucene.index.DirectoryReader$MultiTermDocs.read(DirectoryReader.java:1146)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.TermScorer.nextDoc(TermScorer.java:130)
[INFO] [talledLocalContainer]   at org.apache.lucene.util.ScorerDocQueue.topNextAndAdjustElsePop(ScorerDocQueue.java:118)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.DisjunctionSumScorer.advanceAfterCurrent(DisjunctionSumScorer.java:200)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.DisjunctionSumScorer.nextDoc(DisjunctionSumScorer.java:170)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.BooleanScorer2.nextDoc(BooleanScorer2.java:332)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.ConjunctionScorer.nextDoc(ConjunctionScorer.java:134)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.BooleanScorer2.nextDoc(BooleanScorer2.java:332)
[INFO] [talledLocalContainer]   at org.apache.lucene.util.OpenBitSetDISI.inPlaceOr(OpenBitSetDISI.java:52)
[INFO] [talledLocalContainer]   at org.apache.lucene.util.OpenBitSetDISI.<init>(OpenBitSetDISI.java:32)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.CachingWrapperFilter.docIdSetToCache(CachingWrapperFilter.java:210)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.CachingWrapperFilter.getDocIdSet(CachingWrapperFilter.java:234)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.IndexSearcher.searchWithFilter(IndexSearcher.java:277)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:233)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:181)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:113)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.Hits.<init>(Hits.java:90)
[INFO] [talledLocalContainer]   at org.apache.lucene.search.Searcher.search(Searcher.java:74)
[INFO] [talledLocalContainer]   at com.atlassian.jira.index.DelegateSearcher.search(DelegateSearcher.java:153)
[INFO] [talledLocalContainer]   at com.atlassian.jira.issue.search.providers.LuceneSearchProvider.runSearch(LuceneSearchProvider.java:441)
[INFO] [talledLocalContainer]   at com.atlassian.jira.issue.search.providers.LuceneSearchProvider.getHits(LuceneSearchProvider.java:252)
[INFO] [talledLocalContainer]   at com.atlassian.jira.issue.search.providers.LuceneSearchProvider.search(LuceneSearchProvider.java:316)
[INFO] [talledLocalContainer]   at com.atlassian.jira.issue.search.providers.LuceneSearchProvider.search(LuceneSearchProvider.java:87)
[INFO] [talledLocalContainer]   at com.atlassian.jira.issue.search.providers.LuceneSearchProvider.search(LuceneSearchProvider.java:76)
[INFO] [talledLocalContainer]   at com.my-corp.jira.plugin.JQL.searchForResults(JQL.java:54)
[INFO] [talledLocalContainer] 2013-01-30 09:37:06,887 http-2990-6 ERROR jbeck 569x2541x1 170hluk 0:0:0:0:0:0:0:1%0 /secure/CreateIssueDetails.jspa [atlassian.event.internal.EventPublisherImpl] There was an exception thrown trying to dispatch event 'com.atlassian.jira.event.issue.IssueEvent@59a1f1dd[issue=JBT-2,comment=<null>,worklog=<null>,changelog=<null>,eventTypeId=1,sendMail=true,params={eventsource=workflow, baseurl=http://jira.my-corp.com},subtasksUpdated=false]' from the invoker 'com.atlassian.event.internal.SingleParameterMethodListenerInvoker@67d8ef2f'.
[INFO] [talledLocalContainer] java.lang.RuntimeException: java.lang.reflect.InvocationTargetException
[INFO] [talledLocalContainer]   at com.atlassian.event.internal.SingleParameterMethodListenerInvoker.invoke(SingleParameterMethodListenerInvoker.java:54)
[INFO] [talledLocalContainer]   at com.atlassian.event.internal.AsynchronousAbleEventDispatcher$2.run(AsynchronousAbleEventDispatcher.java:60)
[INFO] [talledLocalContainer]   at com.atlassian.event.internal.AsynchronousAbleEventDispatcher$1.execute(AsynchronousAbleEventDispatcher.java:28)
[INFO] [talledLocalContainer]   at com.atlassian.event.internal.AsynchronousAbleEventDispatcher.dispatch(AsynchronousAbleEventDispatcher.java:56)
[INFO] [talledLocalContainer]   at com.atlassian.event.internal.EventPublisherImpl.invokeListeners(EventPublisherImpl.java:151)
[INFO] [talledLocalContainer]   at com.atlassian.event.internal.EventPublisherImpl.publish(EventPublisherImpl.java:70)
[INFO] [talledLocalContainer]   at com.atlassian.multitenant.event.DefaultPeeringEventPublisherManager.publish(DefaultPeeringEventPublisherManager.java:17)
[INFO] [talledLocalContainer]   at com.atlassian.multitenant.event.PeeringEventPublisher.publish(PeeringEventPublisher.java:23)
[INFO] [talledLocalContainer]   at com.atlassian.jira.event.issue.IssueEventDispatcher.dispatchEvent(IssueEventDispatcher.java:254)
[INFO] [talledLocalContainer]   at com.atlassian.jira.event.issue.IssueEventDispatcher.dispatchEvent(IssueEventDispatcher.java:183)
[INFO] [talledLocalContainer]   at com.atlassian.jira.workflow.function.event.FireIssueEventFunction.execute(FireIssueEventFunction.java:57)
[INFO] [talledLocalContainer]   at com.opensymphony.workflow.AbstractWorkflow.executeFunction(AbstractWorkflow.java:869)
[INFO] [talledLocalContainer]   at com.opensymphony.workflow.AbstractWorkflow.transitionWorkflow(AbstractWorkflow.java:1265)
[INFO] [talledLocalContainer]   at com.opensymphony.workflow.AbstractWorkflow.initialize(AbstractWorkflow.java:618)
[INFO] [talledLocalContainer]   at com.atlassian.jira.workflow.OSWorkflowManager.createIssue(OSWorkflowManager.java:815)
[INFO] [talledLocalContainer]   at com.atlassian.jira.issue.managers.DefaultIssueManager.createIssue(DefaultIssueManager.java:461)
[INFO] [talledLocalContainer]   at com.atlassian.jira.issue.managers.DefaultIssueManager.createIssue(DefaultIssueManager.java:383)
[INFO] [talledLocalContainer]   at com.atlassian.jira.bc.issue.DefaultIssueService.create(DefaultIssueService.java:193)
[INFO] [talledLocalContainer]   at com.atlassian.jira.bc.issue.DefaultIssueService.create(DefaultIssueService.java:207)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.action.issue.CreateIssueDetails.createIssue(CreateIssueDetails.java:95)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.action.issue.CreateIssueDetails.doExecute(CreateIssueDetails.java:71)
[INFO] [talledLocalContainer]   at webwork.action.ActionSupport.execute(ActionSupport.java:165)
[INFO] [talledLocalContainer]   at com.atlassian.jira.action.JiraActionSupport.execute(JiraActionSupport.java:76)
[INFO] [talledLocalContainer]   at webwork.interceptor.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:39)
[INFO] [talledLocalContainer]   at webwork.interceptor.NestedInterceptorChain.proceed(NestedInterceptorChain.java:31)
[INFO] [talledLocalContainer]   at webwork.interceptor.ChainedInterceptor.intercept(ChainedInterceptor.java:16)
[INFO] [talledLocalContainer]   at webwork.interceptor.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:35)
[INFO] [talledLocalContainer]   at webwork.dispatcher.GenericDispatcher.executeAction(GenericDispatcher.java:205)
[INFO] [talledLocalContainer]   at webwork.dispatcher.GenericDispatcher.executeAction(GenericDispatcher.java:143)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.dispatcher.JiraWebworkActionDispatcher.service(JiraWebworkActionDispatcher.java:152)
[INFO] [talledLocalContainer]   at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.filters.steps.ChainedFilterStepRunner.doFilter(ChainedFilterStepRunner.java:74)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.core.filters.HeaderSanitisingFilter.doFilter(HeaderSanitisingFilter.java:44)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)
[INFO] [talledLocalContainer]   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:25)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)
[INFO] [talledLocalContainer]   at com.atlassian.labs.httpservice.resource.ResourceFilter.doFilter(ResourceFilter.java:59)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.filters.accesslog.AccessLogFilter.executeRequest(AccessLogFilter.java:103)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.filters.accesslog.AccessLogFilter.doFilter(AccessLogFilter.java:87)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.jira.security.xsrf.XsrfTokenAdditionRequestFilter.doFilter(XsrfTokenAdditionRequestFilter.java:54)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)
[INFO] [talledLocalContainer]   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.filters.PathExclusionFilter.doFilter(PathExclusionFilter.java:118)
[INFO] [talledLocalContainer]   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.seraph.filter.SecurityFilter.doFilter(SecurityFilter.java:211)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.security.auth.trustedapps.filter.TrustedApplicationsFilter.doFilter(TrustedApplicationsFilter.java:98)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.seraph.filter.BaseLoginFilter.doFilter(BaseLoginFilter.java:150)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.filters.JiraLoginFilter.doFilter(JiraLoginFilter.java:70)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)
[INFO] [talledLocalContainer]   at com.atlassian.oauth.serviceprovider.internal.servlet.OAuthFilter.doFilter(OAuthFilter.java:71)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.util.profiling.filters.ProfilingFilter.doFilter(ProfilingFilter.java:99)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.filters.JIRAProfilingFilter.doFilter(JIRAProfilingFilter.java:19)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.johnson.filters.AbstractJohnsonFilter.doFilter(AbstractJohnsonFilter.java:71)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at org.tuckey.web.filters.urlrewrite.UrlRewriteFilter.doFilter(UrlRewriteFilter.java:350)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.gzipfilter.GzipFilter.doFilterInternal(GzipFilter.java:81)
[INFO] [talledLocalContainer]   at com.atlassian.gzipfilter.GzipFilter.doFilter(GzipFilter.java:51)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)
[INFO] [talledLocalContainer]   at com.atlassian.fastdev.AutoReloadFilter.doFilter(AutoReloadFilter.java:63)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)
[INFO] [talledLocalContainer]   at com.sysbliss.jira.plugins.workflow.servlet.JWDSendRedirectFilter.doFilter(JWDSendRedirectFilter.java:25)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)
[INFO] [talledLocalContainer]   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.filters.steps.ChainedFilterStepRunner.doFilter(ChainedFilterStepRunner.java:74)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.core.filters.cache.AbstractCachingFilter.doFilter(AbstractCachingFilter.java:33)
[INFO] [talledLocalContainer]   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.core.filters.encoding.AbstractEncodingFilter.doFilter(AbstractEncodingFilter.java:41)
[INFO] [talledLocalContainer]   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.filters.PathMatchingEncodingFilter.doFilter(PathMatchingEncodingFilter.java:49)
[INFO] [talledLocalContainer]   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
[INFO] [talledLocalContainer]   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.monitor.ActiveRequestsFilter$PassToChainFilterFunc.doFilter(ActiveRequestsFilter.java:346)
[INFO] [talledLocalContainer]   at com.atlassian.jira.web.monitor.ActiveRequestsFilter$DebugLogFilterFunc.doFilter(ActiveRequestsFilter.java:463) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T14:50:42.693

错误指出：

```
java.lang.OutOfMemoryError: Java heap space 
```

所以，首先尝试[增加 Jira 内存](https://confluence.atlassian.com/display/JIRA/Increasing+JIRA+Memory)：

*   在您的`<JIRA Installation Directory>/bin`（或`<Tomcat Installation Directory>/bin`对于 JIRA WAR 安装）中，打开该`setenv.sh`文件。
*   查找部分`JVM_MINIMUM_MEMORY=`和`JVM_MAXIMUM_MEMORY=`
*   请参阅上面的[诊断](https://confluence.atlassian.com/display/JIRA/Increasing+JIRA+Memory#IncreasingJIRAMemory-guidance)并输入适当的值。

有关更多信息，请查看[“OutOfMemoryError Java heap space”](https://confluence.atlassian.com/pages/viewpage.action?pageId=191069)页面导致的 JIRA 崩溃

如果一切都失败了，我建议您尝试在[answers.atlassian.com](https://answers.atlassian.com)上询问，在那里您可以询问 Jira 的支持人员。

# java - 为 WAS 7 运行独立客户端的要求

> ID：14614861
> 
> 赞同：1
> 
> 时间：2013-01-30T22:15:04.543
> 
> 标签：java, websphere

与 Websphere v7.0 建立数据库连接时运行独立 Java 客户端所需的所有 Jars

代码

```
Hashtable parms = new Hashtable();
parms.put(Context.INITIAL_CONTEXT_FACTORY, Database.DB_CONTEXT_FACTORY);
parms.put(Context.PROVIDER_URL, Database.DB_PROVIDER_URL);
logger.debug("Using context of database with parameter "+parms);
context = new InitialContext(parms);
dataSource = (DataSource) context.lookup(getName());
logger.debug("Using context of database with and the context is "+dataSource);
Connection conn = dataSource.getConnection(); 
```

错误

```
ERROR com.ibm.nzna.shared.util.LogSystem  - javax.naming.NoInitialContextException: Cannot instantiate class: com.ibm.websphere.naming.WsnInitialContextFactory [Root exception is java.lang.ClassNotFoundException: com.ibm.websphere.naming.WsnInitialContextFactory]
at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:685)
at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:318)
at javax.naming.InitialContext.init(InitialContext.java:253)
at javax.naming.InitialContext.<init>(InitialContext.java:227)
at com.ibm.nzna.shared.db.Database.connect(Database.java:140)
at com.ibm.nzna.shared.db.DatabaseSystem.createConnection(DatabaseSystem.java:243)
at com.ibm.nzna.projects.qit.app.PCDInitializeThread.run(PCDInitializeThread.java:180)
at java.lang.Thread.run(Thread.java:780)
Caused by: java.lang.ClassNotFoundException: com.ibm.websphere.naming.WsnInitialContextFactory
at java.lang.Class.forName(Class.java:176)
at com.sun.naming.internal.VersionHelper12.loadClass(VersionHelper12.java:75)
at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:682)
    ... 7 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:16:20.817

您似乎在类路径中缺少 WAS 7 客户端文件。从您的 WAS 安装中获取它们并将其添加到类路径中。您可能会在安装 ---> 运行时文件夹中找到这些 jar。

# php - ini 文件中的嵌套数组

> ID：14614866
> 
> 赞同：13
> 
> 时间：2013-01-30T22:15:10.987
> 
> 标签：php

我试图在 ini 设置文件中有一个嵌套的数组结构。我的结构是：

```
stuct1[123][a] = "1"
stuct1[123][b] = "2"
stuct1[123][c] = "3"
stuct1[123][d] = "4" 
```

但这不起作用。谁能解释这种类型的结构是否可行`parse_ini_file`

如果可能的话，我做错了什么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-30T22:19:04.697

您可以使用该任务的[部分功能](http://php.net/manual/en/function.parse-ini-file.php#example-2355)`parse_ini_file`。

请务必将第二个参数设置为`true`：

```
parse_ini_file("sample.ini", true); 
```

创建子部分并不完全可能，但您可以像这样创建索引子数组：

```
[123]
setting[] = "1"
setting[] = "2"
setting[] = "3"
setting[] = "4" 
```

解析它看起来像thos

```
[123][setting][0] => "1"
[123][setting][1] => "2"
[123][setting][2] => "3"
[123][setting][3] => "4" 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-12-28T16:15:59.723

您最多可以创建三个级别。

```
<?php

define('BIRD', 'Dodo bird');

$ini_array = parse_ini_file("sample.ini", true);
echo '<pre>'.print_r($ini_array,true).'</pre>';

?> 
```

parse_ini_file.ini

```
; This is a sample configuration file
; Comments start with ';', as in php.ini

[first_section]
one = 1
five = 5
animal = BIRD

[second_section]
path = "/usr/local/bin"
URL = "http://www.example.com/~username"
second_section[one] = "1 associated"
second_section[two] = "2 associated"
second_section[] = "1 unassociated"
second_section[] = "2 unassociated"

[third_section]
phpversion[] = "5.0"
phpversion[] = "5.1"
phpversion[] = "5.2"
phpversion[] = "5.3" 
```

输出

```
Array (

    [first_section] => Array (
        [one] => 1
        [five] => 5
        [animal] => Dodo bird
    )

    [second_section] => Array (
        [path] => /usr/local/bin
        [URL] => http://www.example.com/~username
        [second_section] => Array (
            [one] => 1 associated
            [two] => 2 associated
            [0] => 1 unassociated
            [1] => 2 unassociated
        )
    )

    [third_section] => Array (
        [phpversion] => Array (
            [0] => 5.0
            [1] => 5.1
            [2] => 5.2
            [3] => 5.3
        )
    )

) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-31T00:03:26.130

INI 文件非常有限，并且 parse_ini_file 远非完美。如果你有这样的要求，你最好寻找一些其他的语法。

那么[JSON](http://json.org/)呢？它[在 PHP 中的支持](http://php.net/manual/en/book.json.php)带来了几乎相同的舒适度：

```
$data = json_decode(file_get_contents($filename), TRUE);
file_put_contents($filename, json_encode($data)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T22:28:33.797

> 这是在 ini 中对值进行分组的另一种方法：
> 
> 我的.ini：
> 
> ```
> [singles] 
> test = a test 
> test2 = another test 
> test3 = this is a test too
> 
> [multiples] 
> tests[] = a test 
> tests[] = another 
> test tests[] = this is a test too 
> ```
> 
> 我的.php：
> 
> 与以下相同：
> 
> ```
> <?php 
> $init['test'] = 'a test';
> $init['test2'] = 'another test';
> $init['test3'] = 'this is a test too';
> $init['tests'][0] = 'a test';
> $init['tests'][1] = 'another test';
> $init['tests'][2] = 'this is a
> test too'; ?> 
> ```
> 
> 这也适用于 bool 设置为 true ，可用于循环。也适用于设置为 true 的 bool。

[http://php.net/manual/en/function.parse-ini-file.php](http://php.net/manual/en/function.parse-ini-file.php)

张贴者大卫点染料在 gmail dot com 4 年前

# actionscript-3 - 事件监听器闪存

> ID：14614867
> 
> 赞同：0
> 
> 时间：2013-01-30T22:15:12.773
> 
> 标签：actionscript-3, flash

我正在使用 AS3。

如果我希望它自己启动我的功能，我根本不记得使用什么 eventListener（如不是 mouseevent.CLICK）

它用于一个快速的 Flash 横幅，当用户进入它所在的站点时，它应该只是启动。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T22:20:52.933

您不需要为此挂钩事件。加载网站后，swf 将加载并播放。如果站点被刷新，那么 swf 将被重新加载（从缓存中）并被重放所以任何实例化您的应用程序的代码都将被执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T06:49:28.640

loaderInfo.addEventListener(Event.COMPLETE, _YourFunctionToBeExecuted) 如果你想在你的 swf 文件完全加载后做一些事情

或者

addEventListener(Event.ADDED_TO_STAGE, _YourFunctionToBeExecuted) 如果您想在显示对象添加到舞台后运行代码

# php - PHP Mysqli在记录不存在时处理函数中的准备语句

> ID：14614869
> 
> 赞同：1
> 
> 时间：2013-01-30T22:15:14.707
> 
> 标签：php, mysqli, prepared-statement

我在 SO 上找到了很多地方，其中提到了我想做的事情，但是当我结合起来时，我很难让它发挥作用。这就是我想要做的我有一个查询我的数据库并显示结果的函数。我想检查是否不存在记录以显示消息“未找到记录”。

```
public function testFun(){

        $stmt = $this->dbconn->prepare('SELECT FirstName FROM users u JOIN usersandroles ur ON ur.UserId = u.id');
        $stmt->execute();
        $result = $stmt->get_result();
        $stmt->store_result();
        $rowCount = $stmt->num_rows;
        $stmt->free_result();
        $stmt->close();                
        if($rowCount === 0){
            return FALSE;
        }else{
            return $result;
        }
    } 
```

我的 PHP 页面

```
$db = generaldb::getInstance();
$user = new User($db);
$result = $user->testFun();
if($result === FALSE){
    echo 'No rows';
}  else {
    while($rows = $result->fetch_assoc()){
        echo $rows['FirstName'],'</br>';
    }
} 
```

即使有 5 条记录，我也会不断收到“无行”。请帮忙。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:24:05.777

尝试： `$rowCount = count($result);`

# php - 从 laravel 控制器访问 wpdb（wordpress 数据库）

> ID：14614872
> 
> 赞同：0
> 
> 时间：2013-01-30T22:15:22.160
> 
> 标签：php, wordpress, laravel

我正在开发的应用程序由 Laravel 和 Wordpress 组成。我拥有 wordpress 数据库中所需的所有数据（如果需要，作为附加插件）。我需要能够从 laravel 控制器连接到 wordpress 的 wpdb 才能返回正确的视图。

但是，当我包含 wordpress 的 load.php

```
(require_once(<wp root>/wp-load.php) 
```

访问 laravel 页面时出现以下错误：

```
Cannot redeclare __() (previously declared in  /www/laravel/helpers.php:24) 
```

这是因为我正在尝试使用 $wpdb 来访问数据库以获取内容。

关于解决方法的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T00:58:10.230

问题是`wp-load.php`启动了大部分 WordPress 框架，而 WordPress 有一个名为[`__()`](http://codex.wordpress.org/Function_Reference/_2). 显然，Laravel 也是如此。我尝试`wpdb`像这样自行启动：

```
include('/path/to/wordpress/wp-includes/wp-db.php');
$mydb = New wpdb('user', 'pass', 'dummydb', 'localhost');
$test = $mydb->get_results("SELECT * FROM {$mydb->posts} LIMIT 5"); 
```

但是它会抛出未定义的函数错误，因为它使用了 WordPress 代码库的其余部分中的函数，这些函数没有被加载。`$wpdb`这意味着如果没有函数名冲突，您将无法使用Laravel。

不过你真的不需要`$wpdb`，至少我不知道你为什么会。它只不过是一个[相当有限的 PHP`mysql_*`函数](http://core.trac.wordpress.org/browser/trunk/wp-includes/wp-db.php)包装器。这是一个（次要的）方便，但仅此而已。如果你有数据库连接信息，你可以用直接的 PHP 做同样的事情。

如果你需要使用[`WP_Query`](http://codex.wordpress.org/Class_Reference/WP_Query)我会理解的。手写的一些东西会非常痛苦。

# c++ - 如果“new”用于实例化对象而不将其分配给变量会发生什么？

> ID：14614875
> 
> 赞同：4
> 
> 时间：2013-01-30T22:15:35.377
> 
> 标签：c++, new-operator

想问如果我写下面的代码并运行程序会发生什么。

```
new int[5]; // without assigning it to a pointer. 
```

编译通过。

但是会`5 * sizeof(int)`分配一大块内存吗？

如果它是一个对象呢？

```
new some_obj_[5]; // without assigning it to a pointer. 
```

的构造函数会`some_obj_`被调用吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-30T22:18:00.387

```
new int[5];//without assigning it to a pointer. 
```

是的，将`5*sizeof(int)`分配一块内存，但您无法访问，因为您没有保存指针。您将有内存泄漏。

```
new some_obj_[5];//without assigning it to a pointer. 
```

是的，将`5*sizeof(some_obj_)`分配大量内存但您无法访问，因为您没有保存指针。的默认构造函数`some_obj_`将被调用 5 次。这应该很容易验证。根据`some_obj_`编码方式，您可能会发生内存泄漏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T22:17:43.167

是的，对象数组将被动态分配，在第二种情况下，`some_obj_`将调用默认构造函数。由于您不存储指针，因此您失去了访问对象或`delete[]`数组的任何方式，因此存在内存泄漏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T22:37:20.600

```
new int[5];//without assigning it to a pointer. 
```

> 但是会分配 5-sizeof(int) 的内存块吗？

**YES** , 5-sizeof(int) 分配的内存块和 5 个 int 未初始化为 0

> 如果它是一个对象呢？

```
new some_obj_[5];//without assigning it to a pointer.
Will the constructor of 'some_obj_' be invoked? 
```

**是**的，`sizeof(some_obj_) * 5`将分配内存块，并且 some_obj_ 的默认构造函数将被调用 5 次以初始化每个元素。

您正在泄漏这些内存，因为您没有指向它们的指针，您不能不调用`delete []`以释放内存块。

参见[新的 []](http://en.wikipedia.org/wiki/New_%28C++%29) wiki 页面

# c++ - 用 64 位整数移位

> ID：14614877
> 
> 赞同：1
> 
> 时间：2013-01-30T22:15:45.713
> 
> 标签：c++, c, visual-studio-2010, 64-bit, shift

我有一个 __int64 变量`x = 0x8000000000000000`。

我尝试按字节右移：`x >> 4`

我认为结果应该是`0x0800000000000000`，但不幸的是我得到了`0xf800000000000000`。

我用VS10。为什么会这样？我该如何解决呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T22:17:47.083

尝试使用`__uint64 variable x = 0x8000000000000000`

我认为您也可以这样声明：

```
u64 x = 0x8000000000000000; 
```

`x >> 4`你会给你：

```
0x0800000000000000 
```

有关更多信息，请参阅`F`MSB[中](http://en.wikipedia.org/wiki/Two%27s_complement)的来源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:18:28.177

嗯，这很容易。:)

您的号码已签名。设置第一位后，它是负数。因此，为了保持负数，它被填充为 1。

我认为将其转换为未签名然后将其转换应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-30T23:52:24.617

原因是因为移位有符号数字仅在左操作数至少为 0 时由语言定义。在您的情况下，我假设它是二进制补码表示，并且您的数字为负数，因此结果未指定（或实现定义，我不'现在手头没有参考）。通常，您将获得逻辑移位或算术移位。

如果您可以摆脱使变量无符号的情况，那将解决您的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T22:17:44.663

这是因为你有一个负数。在班次之前使用（或转换为）无符号。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-30T22:44:33.540

有符号值右移符号位，无符号零：

```
int _tmain(int argc, _TCHAR* argv[])
{
    __int64  signedval;
    unsigned __int64  unsignedval;

    signedval=0x8000000000000000 >> 4;
    unsignedval=0x8000000000000000 >> 4;

        printf(" Signed %x  , unsigned %x   \n", signedval, unsignedval);

        getchar();

    return 0;
} 
```

输出是：

```
Signed 0  , unsigned 8000000 
```

# c# - 类未按预期序列化

> ID：14614879
> 
> 赞同：2
> 
> 时间：2013-01-30T22:15:48.453
> 
> 标签：c#, serialization

我整天都在为此苦苦挣扎。我做了很多研究，但我似乎无法将它们放在一起。

我有来自服务器的 XML 响应，如下所示：

```
<?xml version="1.0" ?>
<inboxRecords>
    <inboxRecord>
        <field1 />
        <field2 />
        <field3 />
    </inboxRecord>
    <inboxRecord>
        <field1 />
        <field2 />
        <field3 />
    </inboxRecord>
</inboxRecords> 
```

我创建了以下代码来表示响应。目的是我将使用以下内容对响应进行反序列化：

```
[XmlRoot("inboxRecords")]
public sealed class QueueQueryResult
{
    public InboxRecord[] InboxRecords;

    public QueueQueryResult()
    {
        InboxRecords = null;
    }

    public sealed class InboxRecord
    {
        public string field1 { get; set; }
        public string field2 { get; set; }
        public string field3 { get; set; }
    }
} 
```

上面的课程基于我在网上找到的众多示例之一。问题是，当我序列化上面的类（以确认它是正确的）时，它是这样的：

```
<?xml version="1.0" encoding="utf-16"?>
<inboxRecords>
  <InboxRecords>
    <InboxRecord>
      <field1>some value</field1>
    </InboxRecord>
    <InboxRecord>
      <field1>some value</field1>
    </InboxRecord>
  </InboxRecords>
</inboxRecords> 
```

那么，第一个问题，我如何摆脱多余的 InboxRecords 元素？我只想让根说（用一个小“我”）。其次，为了快速测试，我只在第一个字段中输入了一个值。为什么其他字段没有作为空元素出现？我需要另一个装饰器吗？

谢谢！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:22:17.630

使用`XmlElement`属性：

```
[XmlRoot("inboxRecords")]
public sealed class QueueQueryResult
{
    [XmlElement("inboxRecord")]
    public InboxRecord[] InboxRecords;

    public QueueQueryResult()
    {
        InboxRecords = null;
    }

    public sealed class InboxRecord
    {
        public string field1 { get; set; }
        public string field2 { get; set; }
        public string field3 { get; set; }
    }
} 
```

这将删除 Array 包装器元素并允许您控制每个 xml 元素的名称，以便您可以使用小写名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:23:58.427

未经测试，但我认为你可能会做这样的事情：

```
[XmlRoot("inboxRecords")]
public sealed class QueueQueryResult : Collection<QueueQueryResult.InboxRecord>
{
    public QueueQueryResult()
    {
        InboxRecords = null;
    }

    public sealed class InboxRecord
    {
        public string field1 { get; set; }
        public string field2 { get; set; }
        public string field3 { get; set; }
    }
} 
```

您的代码的问题是您在`InboxRecords`序列化为`inboxRecords`. 通过使类继承自`Collection`，您可以为它提供处理一组`InboxRecords`不带额外内部元素的能力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:33:14.433

使用 从您的第一个示例 XML（然后是 .cs）生成 XSD 后`xsd.exe`，我可以从您的第二个示例创建并序列化一个实例：

```
<?xml version="1.0" encoding="utf-16"?>
<inboxRecords xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <inboxRecord>
    <field1>some value</field1>
  </inboxRecord>
  <inboxRecord>
    <field1>some value</field1>
  </inboxRecord>
</inboxRecords> 
```

除了编码属性和模式命名空间之外，这看起来与第一个示例非常相似。

# iphone - 访问用户书签 iPhone？

> ID：14614881
> 
> 赞同：0
> 
> 时间：2013-01-30T22:15:53.827
> 
> 标签：iphone, ios, objective-c, ipad, bookmarks

从 iOS 6 及更高版本，是否可以访问用户书签？还是我必须创建自己的实现？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:19:55.813

我不认为这是可能的。这里有一个老问题：[在安装应用程序时将书签添加到 iPhone 上的 Safari？](https://stackoverflow.com/questions/439213/add-bookmark-to-safari-on-iphone-when-an-application-is-installed/439231#439231)

# .net - 如何规范化 .NET 和 Mono OSX 之间的变音符号字符串表示？

> ID：14614884
> 
> 赞同：2
> 
> 时间：2013-01-30T22:16:13.137
> 
> 标签：.net, macos, unicode, mono, diacritics

我有一个使用 .NET for Windows 和 Mono for Mac / OSX 的跨平台应用程序。

我的应用程序处理文件名并将序列化的数据结构写入磁盘，其中包含文件名作为字符串。其中一些文件名具有国际字符，如重音符号。

当我将在 Windows (NTFS) 上创建的数据文件复制到 Mac 时，我遇到了名称中包含这些国际重音字符的文件的一些问题。

从 NTFS 读取并由 .NET 序列化的文件名包含重音字母的单个字符，但是当我在 OSX 上使用 Mono 从文件系统读取文件名时，我得到与序列化表示不匹配的两个字符表示。我需要在 Windows 和 Mac 上保持序列化文件名和实际文件系统之间的一致性。

例如，字母 é 是在 Windows 上使用 .NET 从文件名中获取的，并被序列化为整数值为 233 的单个字符。在 OSX 上，我使用 Mono 读取复制文件的文件名，该字母用两个字符表示整数值 101 和 769，将字母和重音表示为不同的字符。问题是这种表示与在 Windows 上编写的序列化表示不匹配。

我需要找到某种方法来强制保持一致性 - 无论是在包含文件名的序列化数据结构中，还是在文件名本身中。

.NET/Mono 中是否有某种方法可以规范化这些不同的字符串表示形式？我查看了 Normalize() 方法，但我认为它没有达到我想要的效果。要么，要么我不理解文档。

NTFS 还可以存储带有重音字母的两个字符表示的文件名吗？如果是这样，它会将这两种表示视为不同的吗？我可能更喜欢对实际文件名本身进行规范化。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T23:37:34.093

我认为问题在于 Windows 和 Mac OS X 使用不同的系统对文件名中的字符进行编码。

根据[这个 SO question 的第一个答案](https://stackoverflow.com/questions/2050973/what-encoding-are-filenames-in-ntfs-stored-as)，NTFS 使用 UTF-16 存储文件名。但是，根据[这个 SO question 的第二个答案](https://stackoverflow.com/questions/9757843/unicode-encoding-for-filesystem-in-mac-os-x-not-correct-in-python)，Mac OS X 通过规范化形式 D 使用 UTF-8 存储文件名，其中字形“é”被“规范地分解”为“e”（101），并结合了锐音标记“´”（769）。

所以我担心除非你将文件名限制为纯 ASCII，否则它们在两个操作系统上只会有不同的表示。

# excel - Excel VBA添加整行和平均值

> ID：14614885
> 
> 赞同：-1
> 
> 时间：2013-01-30T22:16:16.290
> 
> 标签：excel, average, vba

假设我想平均工作表 1 列 j 上的每个非空单元格，我将如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:20:30.057

`=AVERAGE(Sheet1!$J:$J)`应该是你所需要的！:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T02:06:05.863

让我们只为**非零**数字做一个`SumProduct`和。在此解决方案中，它还考虑了负数（SumProduct 公式）。然后使用这两个结果进行计数，因为这很好，但需要考虑零。如果你没有零，只有文本和数字，你最好使用，否则试试这个并相应地调整逻辑（考虑或不考虑负数）：`Count -IF`**`AVERAGE``AVERAGE`**

 **![在此处输入图像描述](../Images/2a149bd1a61141e6f8646c78f171544d.png)

*   根据您使用的版本，您也可以试用[`AVERAGEIF`](http://office.microsoft.com/en-sg/excel-help/averageif-function-HA010047433.aspx)。**

# ruby-on-rails - Rails - 一种模型，两种验证规则

> ID：14614886
> 
> 赞同：0
> 
> 时间：2013-01-30T22:16:19.540
> 
> 标签：ruby-on-rails, ruby, validation, attributes

在一个应用程序中，我有 3 种联系表格 - 在模型中 - 属性`:aaa, :bbb, :ccc`属于第二个联系表格，之前的属性属于第一个联系表格。

```
class Message

  include ActiveModel::Validations
  include ActiveModel::Conversion
  extend ActiveModel::Naming

  attr_accessor :name, :email, :body, :aaa, :bbb, :ccc

  validates :name, :email, :body, :aaa, :bbb, :ccc, :presence => true
  validates :email, :format => { :with => %r{.+@.+\..+} }, :allow_blank => true

  def initialize(attributes = {})
    attributes.each do |name, value|
      send("#{name}=", value)
    end
  end

  def persisted?
    false
  end

end 
```

我正在尝试做的事情：我正在寻找一种方法，如何验证相应联系表单的属性，特别是：

*   第一个联系表单包含属性：`:name, :email, :body`，我需要验证
*   第二个合同表单包含属性：`:aaa, :bbb, :ccc, :email`，我需要验证

怎么做？如何区分，哪些属性属于哪个表单并验证它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:29:15.860

如果有 3 种类型的合同表格，为什么不将它们分成 3 个单独的类别？如果您仍然想将其保留在一个班级中，则可以使用“with_options”魔术来做到这一点：

```
with_options :if => :is_form_1? do |p|
  p.validates_presence_of :attr1
  p.validates_presence_of :attr2
  p.validates_presence_of :attr3
end

with_options :if => :is_form_2? do |p|
  p.validates_presence_of :attr4
  p.validates_presence_of :attr5
  p.validates_presence_of :attr6
end

def is_form_1?
  #some logic
end

def is_form_2?
  #some logic
end 
```

不过，我不喜欢把它放在一个班级里的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:39:41.863

我建议您从行为而不是实施方面考虑这一点。您提到有三种联系表格，但是您将每张表格用于的潜在用途是什么？在设置模型时，您不应该考虑*表单。*

[话虽如此，您可以使用validation_scopes gem](https://github.com/gtd/validation_scopes)实现您想要的。使用validation_scopes，您可以定义可以独立处理的验证规则集。然后，在您的控制器中，您可以检查适用于上下文的任何一组验证规则（即用户填写的表单）。

在您的模型中，您可以设置为每个表单命名的验证范围（或者更好的是，以具有语义价值的方式为上下文命名，但我对您的应用程序了解不足，无法知道上下文是什么），如下所示：

```
validation_scope :form_one_errors do |vs|
  validates :name, :body, :presence => true
end

validation_scope :form_two_errors do |vs|
  validates :aaa, :bbb, :ccc, :presence => true
end 
```

由于电子邮件需要在两种情况下进行验证，您可以将其设置为正常验证（根据您在问题中的代码）。

然后在控制器中，比如说，表格一，您可以检查范围以查看该上下文是否有任何错误。请注意，对于常规验证错误，您必须单独检查验证范围的错误。

```
if !message.valid?
  # Do something with message.errors
elsif message.has_form_one_errors?
  # Do something with message.form_one_errors
else 
  # All good
end 
```

# c# - C# 和 WPF - DataGridComboBoxColumn 上 ItemsSource 上的绑定列表

> ID：14614894
> 
> 赞同：0
> 
> 时间：2013-01-30T22:16:35.823
> 
> 标签：c#, wpf, list, datagrid, datagridcomboboxcolumn

我想将`List`（包含来自 LINQ 查询的数据）与`DataGridComboBoxColumn`as绑定`ItemsSource`。`SelectedValue`属性是从其他`List`数据中获取的整体`DataGrid`。

XAML：

```
<DataGrid x:Name="DG1" x:Uid="DG1" AutoGenerateColumns="False" AlternationCount="2" SelectionMode="Single" Margin="0,5,0,0" HorizontalAlignment="Stretch">
<DataGrid.Columns>
//...
<DataGridComboBoxColumn ItemsSource="{Binding MyValueItem}" SelectedItemBinding="{Binding Source="{StaticResource myvalue}" Header="Values" Width="Auto"/> 
```

C＃：

```
public class ValuesInfo
{
    public int id { get; set; }
    public string number { get; set; }
    public string myvalue { get; set; }
}

public class MyValueItems : List<string>
{
}

public partial class MyWindow : Window
{
    public MyValueItems MyValueItem { get; set; }

    public MyWindow()
    {
        InitializeComponent();  
    }

    private void MyWindow_Load(object sender, RoutedEventArgs e)
    {
        MyValueItem = new MyValueItems();
        sqlDataContext dc = new sqlDataContext();
        var allValueNames = (from p in dc.Names
                               orderby p.id ascending
                               select p.name);

        MyValueItem.AddRange(allValueNames);
        DG1.DataContext = MyValueItem;
    }

    public void LoadValues()
    {
        List<ValuesInfo> ValueList = new List<ValuesInfo> { };
        //...

        for (int i = 1; i <= (int)rdr[0]; i++)
        {
            var dbset = (from p in dc.Values
                         where p.id == i
                         orderby p.id ascending
                         select p).Single();

            var ValueName = (from p in dc.Names
                             where p.id == dbset.valueId
                             select p.name).Single();

            ValuesInfo valueItem = new ValuesInfo
            {
                id = dbset.id,
                number = dbset.number,
                myvalue = valueName
            };
            ValueList.Add(valueItem);
        }

        DG1.ItemsSource = ValueList;
    }
} 
```

这里有很多`DataGridComboBoxColumn`Binding 的例子，但这些都不能帮助解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T23:37:26.660

看起来您要在 DataContext 上请求一个名为 MyValueItem 的属性。

```
<DataGridComboBoxColumn ItemsSource="{Binding MyValueItem}" SelectedItemBinding="{Binding Source="{StaticResource myvalue}" Header="Values" Width="Auto"/> 
```

但是您将 MyValueItem 的值作为 DataContext 传递。

```
DG1.DataContext = MyValueItem; 
```

您需要将 DataContext 设置为具有“MyValueItem”属性的项目。将上面的行替换为下面的行。

```
DG1.DataContext = this; 
```

其中“this”是具有 MyValueItem 属性的 MyWindow。

...

或者，您可以将绑定更改为以下内容，这会将您传递给它的任何项目作为绑定源。

```
<DataGridComboBoxColumn ItemsSource="{Binding}" SelectedItemBinding="{Binding Source="{StaticResource myvalue}" Header="Values" Width="Auto"/> 
```

# sql-server - SQL Server 的引擎在特定版本中的所有版本中是否相同？

> ID：14614895
> 
> 赞同：1
> 
> 时间：2013-01-30T22:16:36.663
> 
> 标签：sql-server

承包商试图告诉我们企业查询优化器比标准优化器更好/更快。我一直在搜索/谷歌搜索这个问题，并没有看到任何明确的说法。

那么，各种引擎（例如查询优化器、存储引擎等）是否在所有版本（例如 Standard、Enterprise）中都相同，并且只是启用或禁用了某些功能？这是我的理解。希望有人可以澄清，甚至可能指向参考链接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T22:30:27.557

SQL Enterprise 可以使用更多的硬件，即每个版本可以使用的 CPU/处理器数量和内存。

也可以

*   查询优化器自动使用索引视图
*   星型连接查询优化，
*   ETC

请参阅 [http://msdn.microsoft.com/en-us/library/cc645993.aspx](http://msdn.microsoft.com/en-us/library/cc645993.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T23:50:38.480

引擎是相同的，但是有一些（我们称它们为标志）是基于 SKU 设置的。这些可以带来更好的性能；不一定是引擎本身的差异，但在很多情况下，只是由于功能（和“标志”）的存在，引擎利用某些东西的能力。

一些例子：

*   Enterprise Edition 将自动将查询与索引视图匹配。要在较低版本上获得此行为，您需要使用`NOEXPAND`提示。这可能是最著名的一个，因为它是唯一可以在较低版本中免费使用的（除了代码维护时间）。
*   硬件使用限制 - 根据底层操作系统，较低版本可能限制为 64GB RAM、1GB RAM、4 个插槽/16 个内核等。
*   其余版本在其他版本中不可用：
    *   表分区
    *   数据压缩
    *   备份压缩。2008年仅在企业；从那以后也添加到标准中。
    *   在线索引操作
    *   高性能镜像
    *   数据库快照
    *   并行索引操作
    *   星型连接优化
    *   分区表并行度
    *   资源调控器（在较低版本上无法控制工作负载）
    *   可更新的分布式分区视图
    *   更改数据捕获（可能必须使用更具侵入性的方法）

我可能会遗漏一些，但重要的是要认识到引擎本身并没有什么不同，但性能差异将很大，具体取决于您可能使用的这些功能中的哪些以及它们对您的特定工作负载的影响。

# lua - 在 Lua 中判断一个数是奇数还是偶数

> ID：14614898
> 
> 赞同：11
> 
> 时间：2013-01-30T22:16:45.493
> 
> 标签：lua

我需要比较用户输入的数字以确定它是奇数还是偶数。我正在使用 Lua，到目前为止我还没有代码......我所知道的是我想在这样格式化的 if else 语句中使用它......

```
 if (number is even) then
        -block of code
    else
        -block of code
    end 
```

任何人都可以提供的任何帮助或建议都会很棒！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-30T22:19:58.757

```
if (number % 2 == 0) then
    .....it is even
else
    .....it is odd
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T22:19:56.207

您可以使用`math.mod(number, 2) == 0`

# laravel - Laravel 4 自然语言全文搜索 MATCH (title,body) AGAINST ('word')

> ID：14614901
> 
> 赞同：2
> 
> 时间：2013-01-30T22:16:57.817
> 
> 标签：laravel, laravel-4

在 laravel 4 中使用 MYSQL LIKE 搜索非常容易。

```
Article::where('title', 'like', '%first%'); 
```

但是，使用 MYSQL 自然语言全文搜索的最佳方式是什么？

```
SELECT * FROM articles WHERE MATCH (title,body) AGAINST ('first'); 
```

有人尝试在laravel中这样做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:51:24.287

你应该试试：

```
Article::whereRaw("MATCH(title,body) AGAINST(?)", array('first')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-30T17:33:57.797

此功能已从 Laravel 4 中删除（它在 Laravel 3 中存在）。

但是，您可以按照此处所述轻松重新实现它：[http ://creative-punch.net/implementing-laravel-4-full-text-search/](http://creative-punch.net/implementing-laravel-4-full-text-search/)

# c++ - 从非本地返回右值引用

> ID：14614903
> 
> 赞同：2
> 
> 时间：2013-01-30T22:17:11.303
> 
> 标签：c++, c++11, move-semantics, unique-ptr, rvalue-reference

我有一个查询内部状态对象的类：

```
class State {...}; //Has a copy and move constructor
class Processor
{
private:
    std::unique_ptr<State> state;

public:
    void process(...)
    {
        State newState;
        ... //create this new state
        state.reset(new State(newState));
    }

    State getState()
    {
        return std::move(*state.release());
    }
}; 
```

这是适当的使用`std::move`吗？我可以保证`getState`每次调用只会调用一次`process`，但由于这个特定系统的设计，我不能只`newState`从`process`. Stack Overflow 和其他地方的许多其他答案都说最好只返回对象，因为编译器无论如何都会移动它或 RVO 它，但这些都是在返回的对象是函数本地的情况下.

我不一定需要将状态对象放在 unique_ptr 后面，但这似乎是管理新状态对象的最简单方法。我的实际实现最后有一个指针直接转移到 unique_ptr 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:36:57.860

It turns out that the original demo code is buggy- the unique_ptr never frees the pointer. The answer involves moving *onto* the local function space and then returning normally.

```
class State {...}; //Has a copy and move constructor
class Processor
{
private:
    std::unique_ptr<State> state;

public:
    void process(...)
    {
        State* newState;
        ... //newState is allocated on the heap somehow
        state.reset(newState);
    }

    State getState()
    {
        State _state(std::move(*state));
        //Optionally: state.reset();
        return _state;
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T23:15:10.803

您可以只返回`state`类型为 的`std::unique_ptr<State>`，它会完美地与 一起移动`std::move(state)`。`state`在这种情况下，当它按值返回时，您无需复制整个对象。`state`如果调用者未捕获该对象，则该对象将被自动销毁。对于复杂的堆分配对象，这是一种非常有效的方法。但要小心，通过移动，`state`您正在清除`Processor`对象的状态。所以，`getState`在这种情况下，这不是一个最好的名字，它应该像`fetchState`or `popState`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T22:30:04.123

只返回状态有什么问题

```
struct state {};
class processor {
public:
  void process() {
    state_ = State();
  }

  state get_state() {
    return std::move(state_);
  }

private:
  state state_;
}; 
```

这将在构造处理器时默认构造 state_，但您可以使用`optional`包装器来防止这种情况。您仍然必须保证`get_state`仅在 after 调用`process`，这完全糟透了。

# multithreading - -pthreads (gcc) 或 -mt (sun studio) 或类似选项会导致问题吗？

> ID：14614907
> 
> 赞同：0
> 
> 时间：2013-01-30T22:17:17.073
> 
> 标签：multithreading, thread-safety, pthreads

我正在为一个根本维护得不好的旧项目进行构建；它或多或少是由数百个独立项目拼凑而成的大杂烩。当然，这意味着发生了很多不恰当的事情。

可能有 50-100 个可执行文件，以及大约 300 个共享/静态库。一些库是使用**-mt**标志构建的（sun studio；**-pthreads**似乎是 gcc 等效项），而其他库则不是。

这对我来说似乎有潜在的问题。假设我有`libA.so`- `libB.so`A**是**用**-mt**构建的，但不是**B**。我希望与**A** & **B**链接的应用程序是单线程的，不会有任何问题（请随时纠正我）。但是，如果应用程序是线程化的，那么这种情况会带来一堆有趣的蠕虫。

我倾向于使用**-mt**构建所有内容并完成它。办公室的大多数人都同意这个计划，但有一个反对者。我的期望是，这只会造成性能的潜在下降，但由于该项目的糟糕状态，目前性能已经很糟糕了；所以我对此并不担心。

简而言之：这样做有什么潜在的陷阱吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:43:25.133

我希望那些积极*关心*用线程编译的库会出现问题（这是`#ifdef _REENTRANT`它的一个标志）。当一些代码长时间没有编译，突然变得活跃时，它的问题可能会变得明显。（它甚至与线程无关，只是很长一段时间内被排除在外的任何代码）。

上面的一个特例是一个库，它试图以[这里](http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_atfork.html)`pthread_atfork`的 RATIONALE 部分中描述的方式使用：这些事情远没有很好地定义，正因为创建线程、释放锁等不是异步信号安全的。您的平台可能会为实际发生的情况提供一些保证（例如，它甚至可能*指定*是否为信号处理程序中的发生调用 atfork 处理程序）。这个东西如果没有实际使用应该无关紧要，否则它有一个真正的行为不端的机会。*`fork``fork`*

 *总结：不要指望那些不关心线程的库会出现很多问题。期望它们来自*关心*并且（可能在某些情况下）做错了的图书馆。*

# html - 想要限制 html/css 中选择框的深度

> ID：14614909
> 
> 赞同：0
> 
> 时间：2013-01-30T22:17:35.960
> 
> 标签：html, css

我在[http://buyitnaija.com/post_ad2.php](http://buyitnaija.com/post_ad2.php)上有这个选择框我在这个选择框下有大约 24 个选项，但它会一直到页面末尾我想在选择菜单中添加一个滚动条，以便最多 10一次可见，而休息可以在滚动时可见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:22:43.187

当然，只需将高度和溢出属性设置为`<ul>`：

```
height     : 200px;
overflow-y : scroll; 
```

然后您需要稍微增加宽度以适应滚动条。

# javascript - 如何防止此 jquery 文本面板在第一次悬停时从上到下滑动？

> ID：14614917
> 
> 赞同：0
> 
> 时间：2013-01-30T22:17:51.327
> 
> 标签：javascript, jquery

首次加载页面时，第一次将图像悬停在上方时，滑动面板从顶部向下滑动到底部。但是之后每次你将鼠标悬停在它上面时，它都会从底部向上滑动——这就是我想要的。我不希望它在第一次悬停时从顶部滑落。有没有办法让它每次悬停时都向上滑动？我确信有一些简单的解决方案，但我对 javascript 不是很熟悉。

```
<div class="boxgrid captionfull">  
<img src="http://s17.postimage.org/arxuilf9r/jareck.jpg"/>  
<div class="cover boxcaption">  
    <h3>Jarek Kubicki</h3>  
    <p>Artist<br/><a href="<a class="linkification-ext" title="Linkification: http://www.nonsensesociety.com/2009/03/art-by-jarek-kubicki/" href="http://www.nonsensesociety.com/2009/03/art-by-jarek-kubicki/">http://www.nonsensesociety.com/2009/03/art-by-jarek-kubicki/</a>" target="_BLANK">More Work</a></p>  
</div> 
```

```
 .boxgrid{  
  width: 325px;  
  height: 260px;  
  margin:10px;  
  float:left;  
  background:#161613;  
  border: solid 2px #8399AF;  
  overflow: hidden;  
  position: relative;  
}  

  .boxgrid img{  
  position: absolute;  
  top: 0;  
  left: 0;  
  border: 0;  
}
  .boxcaption{  
  float: left;  
  position: absolute;  
  background: #000;  
  height: 100px;  
  width: 100%;  
  opacity: .8;  
  /* For IE 5-7 */  
  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=80);  
  /* For IE 8 */  
  -MS-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=80)";  
}
  .captionfull .boxcaption {  
  top: 260;  
  left: 0;  
}

 $(document).ready(function(){  
    $('.cover').hide();
    $('.boxgrid.captionfull').hover(function(){  
        $(".cover", this).stop().animate({top:'160px'},{queue:false,duration:160}).show();  
    }, function() {  
        $(".cover", this).stop().animate({top:'260px'},{queue:false,duration:160});  
    });  
}); 
```

[http://jsfiddle.net/scottm29/NUpfz/1/](http://jsfiddle.net/scottm29/NUpfz/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:20:24.963

为您的元素定义一个启动 css：

[这是jsFiddle。](http://jsfiddle.net/NUpfz/3/)

```
.boxcaption{ 
    ...
    top:260px; 
} 
```

# css - 浏览器如何在 CSS 中定位背景图片？

> ID：14614921
> 
> 赞同：0
> 
> 时间：2013-01-30T22:17:58.380
> 
> 标签：css, background-image

我试图找出为什么没有出现背景图像。

默认情况下，浏览器是否在与样式表或调用样式表的脚本相同的文件夹中查找引用的图像？

前任。
脚本是 /foo/bar.html 样式表是 /css/site.css

site.css 包含：

```
.header {background-image: url(beautiful.png);} 
```

浏览器是否需要 /foo 或 /css 中的文件 beautiful.png？

另外，是否可以使用 webroot 引用此图像？前任：

```
(file in /images/styles/)
.header {background-image: url(/images/styles/beautiful.png);} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:30:05.370

它[与样式表相关，而不是文档](http://www.w3.org/TR/CSS21/syndata.html#value-def-uri)：

> 为了创建不依赖于资源绝对位置的模块化样式表，作者可以使用相对 URI。相对 URI（如 [RFC3986] 中定义）使用基本 URI 解析为完整 URI。RFC 3986 第 5 节定义了此过程的规范算法。对于 CSS 样式表，基本 URI 是样式表的，而不是源文档的。

根相对路径（前导斜杠）很好，我通常使用。

# excel-formula - Excel公式识别范围内的日期范围数

> ID：14614923
> 
> 赞同：1
> 
> 时间：2013-01-30T22:17:58.937
> 
> 标签：excel-formula

我有一个复杂的场景，我试图用 Excel 公式编写而不进入宏。

场景是我看到了一个日期范围，称为范围 A。即 2011 年 10 月 1 日 - 2011 年 5 月 4 日

我有一个包含 3 列的查找表；从日期，到日期，费率。该表包含大约 50 行，每行代表一个唯一的 3 个月期间（每年季度）和相应的费率。

我需要能够获取范围 A，找出每个季度有多少天，然后将这些天数乘以季度比率。

在示例 10/1/2011 - 5/4/2011 我应该以 81*2011_Q1_rate + 5*2011_Q2_rate 结束。

这很简单，有几个 for 循环和 VLOOKUP，但我需要避免使用宏。有没有人有任何其他建议？

谢谢，

斯科特。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T00:52:18.987

我将把这个分解成几部分，因为最后的方程很长。

我们必须做两件事，首先分开你的日期范围。我的范围在单元格`F16`中进行测试。这是通过使用你的to`=MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1)`数组来完成的。这两个匹配语句将为我们提供您的范围所在的第一季度和最后一个季度的行。使用这些行号，我们使用诸如创建引用。前面的公式将在我的测试用例中吐出。`=MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1)``A1``C12``From Date``Rate``address()``=ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),2)&":"&ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),2)``$B$1:$B$9`

第二部分是查找总数。我们将利用`sumproduct()`. 这是一个简单的`sumproduct()`公式：`=SUMPRODUCT((B1:B7-A1:A7+1),C1:C7)`。该范围现在只是静态的用于测试。它将以数组格式将季度结束减去季度开始，然后每个都加 1。这是因为`1/31/13 - 1/1/13 = 30 days`我们希望它是 31 天。然后将该数组乘以每个月的费率。

现在，当我们将它们拼凑在一起时，我们采用我们的第一个范围，使用`indirect()`并将我们的动态范围替换为简单的`sumproduct()`公式，最后以`=SUMPRODUCT((INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),2)&":"&ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),2))-INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),1)&":"&ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),1))+1),INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),3)&":"&ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),3)))`.

现在该公式没有考虑部分月份。`=((DATEVALUE(LEFT(F16,FIND(" - ",F16)))-INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),1)))*INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),3)))`我们用and减去部分月份（从我们之前的方程中窃取），`=((INDIRECT(ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),2))-DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))))*INDIRECT(ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),3)))`我们就完成了。

最终方程： `=SUMPRODUCT((INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),2)&":"&ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),2))-INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),1)&":"&ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),1))+1),INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),3)&":"&ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),3)))-((DATEVALUE(LEFT(F16,FIND(" - ",F16)))-INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),1)))*INDIRECT(ADDRESS(MATCH(DATEVALUE(LEFT(F16,FIND(" - ",F16))),A1:A12,1),3)))-((INDIRECT(ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),2))-DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))))*INDIRECT(ADDRESS(MATCH(DATEVALUE(RIGHT(F16,LEN(F16)-2-FIND(" - ",F16))),A1:A12,1),3)))`

If you split the data range into two separate cells, it will make the equation much smaller and have a higher likelihood of working correctly since there is less room for error.

# image - 匹配两个不同格式的图像

> ID：14614925
> 
> 赞同：1
> 
> 时间：2013-01-30T22:18:08.770
> 
> 标签：image, algorithm, image-processing, imagemagick, sift

我正在开发一个软件项目，我必须将一组“输入”图像与另一组“源”图像进行比较，并找出它们之间是否存在匹配。不能以任何方式编辑/修改源图像；可以缩放/裁剪输入图像以找到匹配项。图像可以是任何尺寸的 BMP、JPEG、GIF、PNG、TIFF。

**一个限制：我不允许使用任何外部库。ImageMagick 是一个例外，可以使用。**

我打算使用 Java/Python。该软件纯粹基于命令行。

我正在阅读 SO 和一些常见的图像比较算法。我打算采取两种方法。1\. 我可以使用直方图/桶来找出被比较的 2 个图像的 RGB 值。
2\. 使用 SIFT/SURF 找到关键点描述符，并找到它们之间的欧式距离，并根据结果距离输出结果。

比较的 2 个图像可以是不同的格式。一个直观的想法是，在分析/比较之前，必须将 2 个图像转换为通用格式。我认为应该将图像转换为质量较低的图像，例如，如果 2 个输入图像是 BMP 和 JPEG，则将 BMP 转换为JPEG。这可以被认为是一个预处理步骤。

我的问题：是否需要将图像转换为通用格式？可以比较两张不同格式的图像吗？如果它们必须在比较之前进行转换，我假设从较高质量（BMP）到较低质量（JPEG）的比较是否正确？如果有人可以建议一些图像转换算法，那也会很有帮助。

**编辑**
如果在源图像中找到图案图像，则称找到匹配。例如，源图像由一个足球场和一名球员组成。如果图案图像包含的玩家与源图像中的玩家完全一样，那么它是匹配的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:32:06.457

不，不需要转换为磁盘上的通用格式，而且可能没有帮助。如果您从图像中提取特征描述符（例如 SIFT/SURF），那么原始图像如何存储在磁盘上就无关紧要了。特征描述符对于小的压缩伪影应该是不变的。

* * *

多一点...

假设您有一个 BMP，它是源数据集中对象 X 的图像。

然后，在您的输入/查询数据集中，您有另一个对象 X 的图像，但它已保存为 JPEG。

您不知道在产生这些图像的编码过程中是如何引入什么噪声的。有光照差异、大气效果、镜头效果、传感器噪声、色调映射、色域映射。其中一些因图像而异，另一些因相机而异。所有这些都是在图像保存到相机存储之前完成的。是的，也存在 JPEG 压缩伪影，但假设 BMP 的质量“更高”，然后通过 JPEG 压缩对其进行降级将无济于事。也许 BMP 在保存为 BMP 之前甚至已经经过 JPEG 压缩。

# c# - EF 代码优先，在同一个表中有 2 个非空外键

> ID：14614926
> 
> 赞同：2
> 
> 时间：2013-01-30T22:18:08.910
> 
> 标签：c#, entity-framework, ef-code-first

我首先使用实体​​框架代码。

我试图将 2 个外键放在同一张桌子上，但我不被允许这样做。

就是这样（编辑）：

该表称为`Avaliacao`：

```
[Required]
public int AvaliacaoId { get; set; }

[Required]
public int LivroId { get; set; }
public int? AutorId { get; set; } 

public virtual Livro Livro { get; set; }
public virtual Autor Autor { get; set; } 
```

我不想`AutorId` *为空*，但它只能这样工作。

我希望我可以有*2 个不可为空的 FK*，但只有一个`Delete on Cascade`.

如何使用实体框架代码优先实现这一目标？

请有人帮助我

提前谢谢

泽卡里奥卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:27:50.437

编辑：

我没有对此进行测试，但如果您使用的是 EF5，则可以通过在 DbContext 中覆盖它来使用 OnModelCreating 方法。您可以多次调用同一个实体来添加配置，这样您就可以指定第二个外键，设置其 HasRequired 属性并将其 WillCascadeOnDelete 属性设置为 true。

第一个外键是这样的。

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Avaliacao>()
                .HasRequired(a => a.LivroId)
                .HasForeignKey(m => a.LivroId)
                .WillCascadeOnDelete(false);

    modelBuilder.Entity<Avaliacao>()
                .HasRequired(a => a.AutorId)
                .HasForeignKey(m => a.AutorId)
                .WillCascadeOnDelete(false);

} 
```

有关该方法的更多参考，您可以查看 MSDN 文档：[DbModelBuilder](http://msdn.microsoft.com/en-us/library/system.data.entity.dbmodelbuilder%28v=vs.103%29.aspx)

如前所述，我自己没有对此进行测试，因此您可能需要更改一些属性。

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T23:21:33.427

您可以通过 fluent API 执行此操作，例如：

```
modelBuilder.Entity<MyEntity>().HasRequired(t => t.Livro);
modelBuilder.Entity<MyEntity>().HasRequired(t => t.Autor); 
```

# java - 比较 Java 中的整数数组。为什么 == 不起作用？

> ID：14614928
> 
> 赞同：8
> 
> 时间：2013-01-30T22:18:14.947
> 
> 标签：java, comparison, compare

我正在学习 Java，只是想出了一个关于该语言的微妙事实：如果我声明两个具有相同元素的整数数组并使用`==`结果比较它们是`false`. 为什么会这样？比较不应该评估为`true`吗？

```
public class Why {

    public static void main(String[] args) {
        int[] a = {1, 2, 3};
        int[] b = {1, 2, 3};

        System.out.println(a == b);
    }

} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-30T22:19:54.533

使用[**Arrays.equals(arr1, arr2**](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#equals%28int%5B%5D,%20int%5B%5D%29) ) 方法。

`==` *运算符*只检查两个引用是否指向同一个对象。

**测试：**

```
int[] a = {1, 2, 3};
int[] b = a;    
System.out.println(a == b);   // returns true as b and a refer to the same array  

int[] a = {1, 2, 3};
int[] b = {1, 2, 3};
System.out.println(Arrays.equals(a, b));   //returns true as a and b are meaningfully equal 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:24:17.183

No.`==`仅比较数字（或布尔）值或引用。

[http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.21](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.21)

您可能正在寻找`Arrays.equals (a,b)`方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T00:07:33.873

如果您使用`==`运算符与`Object`您比较**引用**，而不是**值**。
如果您将`==`运算符与原始类型 ( `int`, `long`, `boolean`...) 一起使用，则您正在检查它们是否具有相同的值。

```
int[] a = {1, 2, 3};
int[] b = {1, 2, 3};

System.out.println(a == b); //return false;

System.out.println(a[0] == b[0]); //return true;

String[] a1 = {"Cat", "Dog", "Mouse"};
String[] b2 = {"Cat", "Dog", "Mouse"};

System.out.println(a1 == b1); //return false;

System.out.println(a1[0] == b1[0]); //return false; Because String are Object 
```

您可以使用该**`Arrays.equals(array1, array2)`**方法。

# ios - CBPeripheralManager 限制

> ID：14614935
> 
> 赞同：2
> 
> 时间：2013-01-30T22:18:34.160
> 
> 标签：ios, ios6, core-bluetooth, bluetooth-lowenergy

iOS 6 中新的 CBPeripheralManager 有哪些限制？如果我足够疯狂地实现 FTP（服务标识符 0x1106）配置文件，我能做到吗？或者 Apple 是否限制应用程序可以公开的蓝牙服务？

[https://github.com/KhaosT/CBPeripheralManager-Demo](https://github.com/KhaosT/CBPeripheralManager-Demo)似乎是新类型的一个很好的例子，但我不清楚目前支持多少，特别是因为公共文档中甚至没有 CBPeripheralManager .

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T19:32:43.173

@BradLarson 是解决这个问题的关键。感谢他在评论中提供的所有帮助。我回答这个问题只是为了记录对后代所说的话，我认为这是对我可能措辞不当的问题的回答。

CoreBluetooth iOS 框架允许应用程序开发人员使用[蓝牙 LE](http://en.wikipedia.org/wiki/Bluetooth_low_energy)，蓝牙的低功耗版本。BLE 包含一组不同的配置文件，因此 FTP 等服务不可用，尽管其他一些服务可用。该库应该足以实现这些配置文件。例如，应该可以[通过 GATT 实现 HID](http://developer.bluetooth.org/gatt/profiles/Pages/ProfileViewer.aspx?u=org.bluetooth.profile.hid_over_gatt.xml)。

对于越狱设备，[BTStack](http://code.google.com/p/btstack/)库可用于与蓝牙接口。

我发现对学习蓝牙非常有用的参考是[蓝牙编程简介](http://people.csail.mit.edu/albert/bluez-intro/index.html)。

# shell - 从 shell 脚本中的函数多次返回

> ID：14614937
> 
> 赞同：1
> 
> 时间：2013-01-30T22:18:45.520
> 
> 标签：shell, unix

```
function get_arguments()
{
    read -p 'data : ' data
    read -p 'lambda: ' lambda
    echo $data $lambda 

}

 data,lambda=$(get_arguments) 
```

但我收到一个错误

```
data :  /home/wolfman/Downloads/data
lambda value: 2
./shell_script.sh: line 25: data,lambda,= /home/wolfman/Downloads/data: No such file or directory 
```

但

1）为什么它甚至评估该文件是否存在..它只是一个字符串？

2）我做错了什么:(

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:21:52.623

`sh`语法不允许这样做。但是，函数中的变量是全局的，所以你可以只调用函数，`data`并且`lambda`将在调用者中设置。

函数返回一个整数值，但它们可以打印调用者可以读取的任意数据。例如，您可以这样做：

```
get_arguments | { read data lambda; echo $data $lambda; } 
```

缺点是这些值仅在该块中可用。（管道创建一个子shell，读取的值`read`仅在该子shell中有效。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:23:35.093

shell 不允许直接分配给变量列表，您可以通过 shell 字符串解析（或可能的其他方法）来管理它。尝试

```
data_lambda=$(get_arguments)
data=${data_lambda% *}
#-----------------^^space char
lambda=${data_lambda#* }
#------------------^^space char

$d=123 l=345
$data_lambda=$(echo $d $l)
$echo $data_lambda
123 345
$data=${data_lambda% *}
$lambda=${data_lambda#* }
$echo $data
123
$echo $lambda
345 
```

替换`$(echo $d $l)`data_lambda=$(get_arguments)`。

请参阅我关于[shell 参数修饰符的文章](https://stackoverflow.com/questions/13337953/how-can-i-automatically-remove-the-file-extension-in-a-file-name/13337988#13337988)

IHTH

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T23:13:43.870

只是为了好玩，这里还有其他几种可能的方法。

```
read -r data lambda <<< $(get_arguments) 
```

或者

```
set -- $(get_arguments)
data=$1
lambda=$2 
```

# php - 如何为我的网站首先加载 index.php 以外的页面？

> ID：14614939
> 
> 赞同：-1
> 
> 时间：2013-01-30T22:18:51.947
> 
> 标签：php, html, web

标题基本概括了所有内容。这个想法是，用户将看到的第一页将是一个搜索字段，然后将信息发送到站点的主页，在他们输入要搜索的术语后，他们将被重定向到该主页。

更新：好吧，我想我知道我想做什么了。看来我想要的是 index.php 中的一个简单重定向，它将用户推送到我提到的那个搜索页面。

该站点的主要部分都在 index.php 上，search.php 中唯一的内容是一个提供 index.php 信息的简单搜索字段。所以我只是在用户第一次访问该站点时将用户从 index.php 重定向到 search.php，然后在他们进入搜索后将它们发送到 index.php。

希望这是有道理的，甚至可能对某人有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:24:27.480

如果您使用的是 Apache，您可以`.htaccess`在 with 上添加一个文件`DirectoryIndex file_name`

**对于前**

```
DirectoryIndex search.php 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:39:14.153

假设您的`index.php`页面需要一个查询字符串参数`search`，您可以使用：

```
if (!isset($_REQUEST['search']) {
    header('Location: http://www.yoursite.com/search.php');
} 
```

您只能在写入输出流之前设置标头，因此这必须在任何纯文本、回显语句等之前。

# vb.net - datagridview - 不能在特定数据列上设置可见/只读属性

> ID：14614940
> 
> 赞同：0
> 
> 时间：2013-01-30T22:18:55.257
> 
> 标签：vb.net, datagridview, datasource, readonly, visible

我在应用程序中有一个 datagridview。datagridview 有一个数据表作为它的数据源。

填充数据网格视图后，我有一个设置列属性（宽度、可见、只读）的过程。

此过程适用于我的开发环境。但是，在我的生产环境中，我收到以下消息：

**操作无效，因为它会导致对 SetCurrentCellAddressCore 函数的可重入调用。**

我在 Visible = False 处将问题缩小到此代码：

```
 For i As Integer = 0 To D.Columns.Count - 1
            D.Columns(i).Width = 50
            D.Columns(i).DefaultCellStyle.Alignment=DataGridViewContentAlignment.MiddleLeft
            D.Columns(i).Visible = False
        Next 
```

该错误仅发生在第 1 列。但是，如果我将第 1 列排除为不可见，则当我将第 1 列设置为只读时，应用程序将失败。

我知道重入调用错误是由于无限循环，因为正在使用 datagridview 单元格。但是，该代码在 dev 中有效。我在生产测试中使用了开发数据库的副本，因此问题不应该与数据相关。

当列不可见或只读时，什么会导致重入调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T23:49:31.680

我要做的是，不是循环遍历datagridview中的每一列，而是遍历源数据表中的列，并使源列的datagridview列不可见，使用列名而不是索引。索引可以洗牌（在摆弄属性时），名称保持不变，除非您更改它们。

我以前遇到过类似的路障。

# r - 如何将向量转换为R中的矩阵？

> ID：14614946
> 
> 赞同：75
> 
> 时间：2013-01-30T22:19:48.137
> 
> 标签：r, vector, matrix

我有一个包含 49 个数值的向量。我想要一个 7x7 数字矩阵。

我可以使用某种方便的自动转换语句，还是我必须将正确的向量子集的 7 个单独的列分配给一个新矩阵？我希望有类似的东西，当然`c(myMatrix)`可以选择给出我想要的行数和/或列数。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-01-30T22:20:41.920

只需使用`matrix`：

```
matrix(vec,nrow = 7,ncol = 7) 
```

正如 Gavin 指出的那样，使用而不是简单地更改维度属性的一个优点是，您可以使用in 中的参数`matrix`指定矩阵是按行还是按列填充。`byrow``matrix`

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-01-30T22:24:12.503

矩阵实际上只是一个具有`dim`属性的向量（对于维度）。因此，您可以`vec`使用该`dim()`函数添加维度，`vec`然后将成为一个矩阵：

```
vec <- 1:49
dim(vec) <- c(7, 7)  ## (rows, cols)
vec

> vec <- 1:49
> dim(vec) <- c(7, 7)  ## (rows, cols)
> vec
     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]    1    8   15   22   29   36   43
[2,]    2    9   16   23   30   37   44
[3,]    3   10   17   24   31   38   45
[4,]    4   11   18   25   32   39   46
[5,]    5   12   19   26   33   40   47
[6,]    6   13   20   27   34   41   48
[7,]    7   14   21   28   35   42   49 
```

# c# - 为 sql 命令准备字符串的方法

> ID：14614947
> 
> 赞同：0
> 
> 时间：2013-01-30T22:19:50.837
> 
> 标签：c#, sql

我需要创建一个字符串方法，它接受一个字符串并将其转义，以便它可以在数据库 SQL 查询中使用，例如：

```
"This is john's dog" ==> "This is john''s dog"
"This is a 'quoted' string" ==> "This is a ''quoted'' string" 
```

我希望我的方法看起来像这样：

```
string PrepareForSQLCommand(string text)
{
    ...
} 
```

无论如何，我不知道 SQL 查询中需要转义的所有字符。我不确定执行此操作的最佳方法是什么，或者是否有一些现有的强大的内置东西可以在 C# 中执行此操作。

很抱歉之前没有提到这一点：我没有使用参数化查询的选项。

泰德

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-30T22:23:06.623

执行此操作的常用方法是使用参数化查询作为 SqlCommand 的一部分。

```
SqlCommand command = new SqlCommand("SELECT * FROM MyTable WHERE MyCol = @param", connection);
command.Parameters.AddWithValue("@param", "This is john's dog"); 
```

然后，该框架为您确保安全，这比尝试自己解决所有可能的注入攻击更不容易出错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-30T23:13:48.330

触发警告。此答案是对以下声明的回应：

> 我没有使用参数化查询的选项。

请不要对此答案投票，也请不要接受这是正确的做事方式。我不知道为什么 OP 不能使用参数化查询，所以我正在回答那个特定的问题，而不是建议你应该这样做。如果您不是 OP，请阅读我给出的其他答案。另外，在否决投票之前，请记住上述限制。谢谢。

触发警告结束！

对于 Microsoft SQL Server（答案因服务器而异），您需要转义单引号字符。

```
' 
```

但在您转义这些字符之前，您应该拒绝任何不在您的白名单上的字符。这是因为那里有很多非常聪明的技巧，而且白名单验证比简单地转义你知道不好的字符更安全。

```
Regex whiteList = new Regex("[^'a-zA-Z0-9 -]");
query = whiteList.Replace(query, ""); 
```

例如，这将删除`[`和`]`字符，以及 ';' 人物。您可能需要调整正则表达式以符合您的期望，因为这是一个非常严格的白名单 - 但您知道您希望在应用程序中看到什么样的数据。

我希望这有帮助。随时查看 OWASP 网站以获取有关安全性的更多详细信息，如果您能找到一种使用参数化查询的方法，您会睡得更好。

# php - CakePHP 从远程目录扩展模型

> ID：14614953
> 
> 赞同：0
> 
> 时间：2013-01-30T22:20:02.897
> 
> 标签：php, cakephp, model

我正在尝试做一些非正统的事情。我在一个目录中有 2 个 cakePHP 安装。是否可以将模型从我的一个应用程序安装扩展到另一个？

这是我的目录结构的样子：

```
app1
  app
    model
      * app1Model
    view
    controller
  libs
  plugins
  ventors

app2
  app
    model
      * app2Model (I want to extent this model with app1Model)
    view
    controller
  libs
  plugins
  ventors 
```

我希望我的 app2Model 扩展 app1Model。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T00:48:45.157

你一定可以！您正在寻找的是[`App::build()`](http://book.cakephp.org/2.0/en/core-utility-libraries/app.html#App%3a%3abuild). 它允许您在使用`App::uses()`. 例如，您可以向模型添加附加路径，如下所示：

```
// assuming your app is under `/var/www`
App::build(array(
  'Model' => array(
    '/var/www/app1/app/model'
  )
)); 
```

你`App::build()`曾经告诉 Cake“当我使用 时`App::uses()`，也在这里寻找课程”。您可以将上面的代码放在 app2 中的引导文件中，以告诉 cake“也在`/var/www/app1/app/model`.

现在在 app2 中，当您使用时：

```
App::uses('app1Model', 'Model'); 
```

它将在名为 的模型中查找`app2/app/model`和查找。如文档中所示，您也可以使用指向控制器和插件等其他内容。`/var/www/app1/app/model``app1Model``App::build()`

谨防名称冲突。从外观上看，您可能需要考虑[构建一个插件](http://book.cakephp.org/2.0/en/plugins.html#creating-your-own-plugins)。

# php - 使用 AJAX 和 JSON 从 PHP 显示 HTML 内容

> ID：14614957
> 
> 赞同：2
> 
> 时间：2013-01-30T22:20:11.790
> 
> 标签：php, javascript, jquery, ajax, json

我正在尝试从包含以下代码的 php 文件中检索信息。我的代码包含列 Email、FirstName、LastName 和 State。

```
$query = 'SELECT * FROM users WHERE LOWER(Email) = :email';
$stmt = $dbh->prepare($query);
$stmt->bindValue(':email', $email);
$stmt->execute();

if ($stmt->rowCount() == 1) {
    $row = $stmt->fetch(PDO::FETCH_ASSOC);
    $firstName = $row['FirstName'];
    $lastName = $row['LastName'];
    $state = $row['State'];     
} echo json_encode($row); 
```

我的 Ajax 代码是：

```
$.ajax({
    datatype: 'json',
    type: "POST",
    url: 'json-data.php',         
      success: function(data) {
        //called when successful
        $('#firstname').append(data.FirstName);     
      },
      error: function(e) {
        //called when there is an error
        //console.log(e.message);
      } 
```

});

当我输入`$('#firstname').append(data);`时，它会显示以下输出：

```
{"FirstName":"Foo","LastName":"Bar","State":"Florida","Email":"foo@bar.com"} 
```

我该如何做才能只获取名字并将其附加到 div 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:29:26.880

尝试：

```
var obj = jQuery.parseJSON(data);
$('#firstname').append(OBJ.FirstName); 
```

# jquery - 如何使用jQuery在数组中查找重复值？

> ID：14614958
> 
> 赞同：4
> 
> 时间：2013-01-30T22:20:12.287
> 
> 标签：jquery

我有一些输入，它们的名称是一种形式的数组：

```
<input type="text" name="email[]" id="email" />
<input type="text" name="email[]" id="email" />
<input type="text" name="email[]" id="email" /> 
```

等等

当我提交表单时，如果在此输入中有重复值，我需要检查 jQuery，任何人都可以帮助我吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-30T22:29:36.347

我会这样做：

```
var values = $('input[name="email[]"]').map(function() {
  return this.value;
}).toArray();

var hasDups = !values.every(function(v,i) {
  return values.indexOf(v) == i;
});

$('form').submit(function(e) {
   if (hasDups) e.preventDefault();
}); 
```

此外，ID 应该是唯一的，就像人们在评论中所说的那样。

# zend-framework2 - 安装 Libra CMS 时出错

> ID：14614962
> 
> 赞同：1
> 
> 时间：2013-01-30T22:20:24.660
> 
> 标签：zend-framework2, symlink, composer-php

我正在按照此处列出的安装步骤进行操作：

[https://bitbucket.org/libracms/libra-cms](https://bitbucket.org/libracms/libra-cms)

但我在第 3 步得到以下错误：

```
symlink(): Could not fetch file information(error 3) 
```

关于如何解决它的任何想法？

我在 Windows 7 上。

这是第 3 步

```
php composer.phar update 
```

这是它生成的输出：

```
Loading composer repositories with package information
Updating dependencies
  - Installing libra/jquery-assets (dev-default tip)
    Cloning tip

Script LibraAssetsInstaller\Installer::postPackageInstall handling the post-pack
age-install event terminated with an exception

  [ErrorException]
  symlink(): Could not fetch file information(error 3)

update [--prefer-source] [--prefer-dist] [--dry-run] [--dev] [--no-custom-instal
lers] [--no-scripts] [--no-progress] [-v|--verbose] [-o|--optimize-autoloader] [
packages1] ... [packagesN] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:40:31.137

调用`LibraAssetsInstaller\Installer::postPackageInstall`失败是因为`postPackageInstall`包含的[函数调用](https://bitbucket.org/vnagara/libra-assets-installer/src/f312f66a308e3543ef9e4ab9d46ad52bf54cc242/src/LibraAssetsInstaller/Installer.php?at=default#cl-32)可能由于多种原因在 Windows 上不起作用：[这里](http://www.php.net/manual/en/function.mkdir.php#101213)有[两个](http://www.php.net/manual/en/function.mkdir.php#71880).

也就是说，[这里特别](https://bitbucket.org/vnagara/libra-assets-installer/src/f312f66a308e3543ef9e4ab9d46ad52bf54cc242/src/LibraAssetsInstaller/Installer.php?at=default#cl-33)`postPackageInstall`失败，可能是因为调用中的路径与Windows 不兼容。`symlink`

为了使调用与 Windows 互操作，路径字符串需要修改为至少使用类似于[此处提到](http://www.php.net/manual/en/function.mkdir.php#53075)`DIRECTORY_SEPARATOR`的系统常量的内容，但也可能需要进行其他修改。

# wxpython - Wxpython Listctrl

> ID：14614964
> 
> 赞同：1
> 
> 时间：2013-01-30T22:20:25.300
> 
> 标签：wxpython

请运行下面的代码，这里我在一帧中有一个按钮添加脚本，onbutton单击打开另一个由显示的数据组合框组成的帧。选择适当的选项并单击更新和关闭按钮后，组合框中的那些值应该打印在listctrl上在其他框架上

谁能帮我解决这个问题

提前致谢

```
import wx

########################################################################
class MyForm(wx.Frame):

    #----------------------------------------------------------------------
    def __init__(self):
        wx.Frame.__init__(self, None, wx.ID_ANY, "List Control Tutorial",size=(700, 400))

        # Add a panel so it looks the correct on all platforms
        panel = wx.Panel(self, wx.ID_ANY)
        self.index = 0

        self.list_ctrl = wx.ListCtrl(panel, size=(-1,200),
                         style=wx.LC_REPORT
                         |wx.BORDER_SUNKEN
                         )
        self.list_ctrl.InsertColumn(0, 'Machine Name')
        self.list_ctrl.InsertColumn(1, 'Sim Port')
        self.list_ctrl.InsertColumn(2, 'Sim Script', width=125)
        self.list_ctrl.InsertColumn(3, 'Status', width=150)
        self.list_ctrl.InsertColumn(4, 'Status Detail', width=300)

        btn = wx.Button(panel, label="Add Line")
        btn.Bind(wx.EVT_BUTTON, self.add_line)

        btn2 = wx.Button(panel,label = "Add Script")
        btn2.Bind(wx.EVT_BUTTON, self.add_script)

        sizer = wx.BoxSizer(wx.VERTICAL)
        sizer.Add(self.list_ctrl, 0, wx.ALL|wx.EXPAND, 5)
        sizer.Add(btn, 0, wx.ALL|wx.CENTER, 5)
        sizer.Add(btn2,0,wx.ALL|wx.CENTER, 5)
        panel.SetSizer(sizer)

        menu = wx.Menu()
        #exit = menu.Append(-1, "Exit")
        #self.Bind(wx.EVT_MENU, self.OnExit, exit)
        menuBar = wx.MenuBar()
        self.SetMenuBar(menuBar)
        #wx.StaticText(self.m_panel1, -1,(25,25))
        self.popupmenu = wx.Menu()
        for text in "Start Stop Remove".split():
            item = self.popupmenu.Append(-1, text)
            self.Bind(wx.EVT_MENU, self.OnPopupItemSelected, item)
            self.list_ctrl.Bind(wx.EVT_CONTEXT_MENU, self.ShowPopUp)

        #self.list_ctrl.Bind(wx.EVT_LIST_ITEM_RIGHT_CLICK, self.ShowPopUp)
    #----------------------------------------------------------------------

    def add_script(self, event):
        # mp is item 2
        self.new = NewWindow(parent=None, id=-1)
        self.new.Show()

    def add_line(self, event):
        #line = "Line %s" % self.index
        line = 'LDR2'
        self.list_ctrl.InsertStringItem(self.index,line)
        self.list_ctrl.SetStringItem(self.index, 1, "22000")
        self.list_ctrl.SetStringItem(self.index, 2, "LF1-trk")
        self.list_ctrl.SetStringItem(self.index, 3, "running")
        self.list_ctrl.SetStringItem(self.index, 4, "last Status info received")
        self.index += 1

    def OnPopupItemSelected(self, event):
        item = self.popupmenu.FindItemById(event.GetId())
        text = item.GetText()
        wx.MessageBox("You selected item '%s'" % text)

    def ShowPopUp( self, event ):
        #pos = self.list_ctrl.GetPosition()
        pos = event.GetPosition()
        pos = self.list_ctrl.ScreenToClient(pos)
        self.list_ctrl.PopupMenu(self.popupmenu,pos)
        event.Skip()

class NewWindow(wx.Frame):

    def __init__(self,parent,id):
        wx.Frame.__init__(self, parent, id, 'New Window', size=(400,300))
        #self.frame1 = MainWindow;

        wx.Frame.CenterOnScreen(self)
        panel = wx.Panel(self)

        sizer = wx.GridBagSizer(5, 5)

        text1 = wx.StaticText(panel, label="Machine")
        sizer.Add(text1, pos=(2, 0), flag=wx.LEFT, border=10)

        comboBox1Choices = [ u"LDR2", u"AT02" ]
       # self.m_comboBox4 = wx.ComboBox( panel, wx.ID_ANY, u"Running", wx.DefaultPosition, wx.DefaultSize, m_comboBoxChoices, 0 )
        self.comboBox1 = wx.ComboBox(panel,wx.ID_ANY,u"", wx.DefaultPosition, wx.DefaultSize, comboBox1Choices, 0 )
        #comboBox1.SetSelection(1)
        sizer.Add( self.comboBox1, pos=(2, 1), span=(1, 3), flag=wx.TOP|wx.EXPAND )

        text2 = wx.StaticText(panel, label="Sim Port")
        sizer.Add(text2, pos=(3, 0), flag=wx.LEFT|wx.TOP, border=10)

        comboBox2Choices = [ u"22000", u"23000" ]
        self.comboBox2 = wx.ComboBox(panel,wx.ID_ANY,u"", wx.DefaultPosition, wx.DefaultSize, comboBox2Choices, 0 )
        sizer.Add( self.comboBox2, pos=(3, 1), span=(1, 3), flag=wx.TOP|wx.EXPAND )

        text3 = wx.StaticText(panel, label="Sim Scripts")
        sizer.Add(text3, pos=(4, 0), flag=wx.TOP|wx.LEFT, border=10)

        comboBox3Choices = [ u"LF12-Ldr", u"LF1-Trk",u"CN1-Trk" ]
        self.comboBox3 = wx.ComboBox(panel,wx.ID_ANY,u"", wx.DefaultPosition, wx.DefaultSize, comboBox3Choices, 0 )
        sizer.Add( self.comboBox3, pos=(4, 1), span=(1, 3), flag=wx.TOP|wx.EXPAND )

        text4 = wx.StaticText(panel, label="Status")
        sizer.Add(text4, pos=(5, 0), flag=wx.TOP|wx.LEFT, border=10)

        comboBox4Choices = [ u"Not Started", u"Running" ]
        self.comboBox4 = wx.ComboBox(panel,wx.ID_ANY,u"", wx.DefaultPosition, wx.DefaultSize, comboBox4Choices, 0 )
        sizer.Add( self.comboBox4, pos=(5, 1), span=(1, 3), flag=wx.TOP|wx.EXPAND )

        self.button4 = wx.Button(panel, label="Update and Close")
        sizer.Add(self.button4, pos=(7, 3))

        sizer.AddGrowableCol(2)

        panel.SetSizer(sizer)

        self.button4.Bind(wx.EVT_BUTTON,self.onupdateandClose)

    def onupdateandClose(self,event):

       # self.index = 0
        self.main = MyForm()
        sc = self.comboBox1.GetSelection()
        print sc
        sd = self.comboBox1.GetString(sc)
        print sd
        #sa = self.main.m_staticText5.SetLabel(self.comboBox1.GetString(sc))
        #sa = self.frame1.m_staticText4.SetLabel(self.comboBox1.GetString(sc))
        #print sa
        cb1 = self.comboBox1.GetValue()
        #print sc
        cb2 = self.comboBox2.GetValue()
        cb3 = self.comboBox3.GetValue()
        cb4 = self.comboBox4.GetValue()
        #num_items = self.main.list_ctrl.GetItemCount()
        #print num_items
        num_items = 0

        #line = "Line %s" % self.index
        #print line
        line = 'LDR2'

        self.main.list_ctrl.InsertStringItem(num_items,line)
        self.main.list_ctrl.SetStringItem(num_items, 1, 'gjg')
        self.main.list_ctrl.SetStringItem(num_items, 2, str(cb2))
        num_items += 1
        self.Close()

    def test(self, event):
        self.new = NewWindow(parent=None, id=-1)
        self.new.Show()
#----------------------------------------------------------------------
# Run the program
if __name__ == "__main__":
    app = wx.App(False)
    frame = MyForm()
    frame.Show()
    app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:31:28.307

我不想更改您的代码。我只添加了代码。

```
import wx

########################################################################
class MyForm(wx.Frame):

    #----------------------------------------------------------------------
    def __init__(self):
        wx.Frame.__init__(self, None, wx.ID_ANY, "List Control Tutorial",size=(700, 400))

        # Add a panel so it looks the correct on all platforms
        panel = wx.Panel(self, wx.ID_ANY)
        self.index = 0

        self.list_ctrl = wx.ListCtrl(panel, size=(-1,200),
                         style=wx.LC_REPORT
                         |wx.BORDER_SUNKEN
                         )
        self.list_ctrl.InsertColumn(0, 'Machine Name')
        self.list_ctrl.InsertColumn(1, 'Sim Port')
        self.list_ctrl.InsertColumn(2, 'Sim Script', width=125)
        self.list_ctrl.InsertColumn(3, 'Status', width=150)
        self.list_ctrl.InsertColumn(4, 'Status Detail', width=300)

        btn = wx.Button(panel, label="Add Line")
        btn.Bind(wx.EVT_BUTTON, self.add_line)

        btn2 = wx.Button(panel,label = "Add Script")
        btn2.Bind(wx.EVT_BUTTON, self.add_script)

        sizer = wx.BoxSizer(wx.VERTICAL)
        sizer.Add(self.list_ctrl, 0, wx.ALL|wx.EXPAND, 5)
        sizer.Add(btn, 0, wx.ALL|wx.CENTER, 5)
        sizer.Add(btn2,0,wx.ALL|wx.CENTER, 5)
        panel.SetSizer(sizer)

        menu = wx.Menu()
        #exit = menu.Append(-1, "Exit")
        #self.Bind(wx.EVT_MENU, self.OnExit, exit)
        menuBar = wx.MenuBar()
        self.SetMenuBar(menuBar)
        #wx.StaticText(self.m_panel1, -1,(25,25))
        self.popupmenu = wx.Menu()
        for text in "Start Stop Remove".split():
            item = self.popupmenu.Append(-1, text)
            self.Bind(wx.EVT_MENU, self.OnPopupItemSelected, item)
            self.list_ctrl.Bind(wx.EVT_CONTEXT_MENU, self.ShowPopUp)

        #self.list_ctrl.Bind(wx.EVT_LIST_ITEM_RIGHT_CLICK, self.ShowPopUp)
    #----------------------------------------------------------------------

    def add_script(self, event):
        # mp is item 2
        self.new = NewWindow(self, id=-1)
        self.new.Show()

    def add_line(self, event):
        #line = "Line %s" % self.index
        line = 'LDR2'
        self.list_ctrl.InsertStringItem(self.index,line)
        self.list_ctrl.SetStringItem(self.index, 1, "22000")
        self.list_ctrl.SetStringItem(self.index, 2, "LF1-trk")
        self.list_ctrl.SetStringItem(self.index, 3, "running")
        self.list_ctrl.SetStringItem(self.index, 4, "last Status info received")
        self.index += 1

    def add_line_dynamic(self, machine_name, sim_port, sim_script, status):
        print machine_name, sim_port, sim_script, status
        self.list_ctrl.InsertStringItem(self.index, machine_name)
        self.list_ctrl.SetStringItem(self.index, 1, sim_port)
        self.list_ctrl.SetStringItem(self.index, 2, sim_script)
        self.list_ctrl.SetStringItem(self.index, 3, status)
        self.list_ctrl.SetStringItem(self.index, 4, "none")
        self.index += 1

    def OnPopupItemSelected(self, event):
        item = self.popupmenu.FindItemById(event.GetId())
        text = item.GetText()
        wx.MessageBox("You selected item '%s'" % text)

    def ShowPopUp( self, event ):
        #pos = self.list_ctrl.GetPosition()
        pos = event.GetPosition()
        pos = self.list_ctrl.ScreenToClient(pos)
        self.list_ctrl.PopupMenu(self.popupmenu,pos)
        event.Skip()

class NewWindow(wx.Frame):

    def __init__(self, parent, id):
        wx.Frame.__init__(self, parent, id, 'New Window', size=(400,300))
        #self.frame1 = MainWindow;
        self.parent = parent

        wx.Frame.CenterOnScreen(self)
        panel = wx.Panel(self)

        sizer = wx.GridBagSizer(5, 5)

        text1 = wx.StaticText(panel, label="Machine")
        sizer.Add(text1, pos=(2, 0), flag=wx.LEFT, border=10)

        comboBox1Choices = [ u"LDR2", u"AT02" ]
       # self.m_comboBox4 = wx.ComboBox( panel, wx.ID_ANY, u"Running", wx.DefaultPosition, wx.DefaultSize, m_comboBoxChoices, 0 )
        self.comboBox1 = wx.ComboBox(panel,wx.ID_ANY,u"", wx.DefaultPosition, wx.DefaultSize, comboBox1Choices, 0 )
        #comboBox1.SetSelection(1)
        sizer.Add( self.comboBox1, pos=(2, 1), span=(1, 3), flag=wx.TOP|wx.EXPAND )

        text2 = wx.StaticText(panel, label="Sim Port")
        sizer.Add(text2, pos=(3, 0), flag=wx.LEFT|wx.TOP, border=10)

        comboBox2Choices = [ u"22000", u"23000" ]
        self.comboBox2 = wx.ComboBox(panel,wx.ID_ANY,u"", wx.DefaultPosition, wx.DefaultSize, comboBox2Choices, 0 )
        sizer.Add( self.comboBox2, pos=(3, 1), span=(1, 3), flag=wx.TOP|wx.EXPAND )

        text3 = wx.StaticText(panel, label="Sim Scripts")
        sizer.Add(text3, pos=(4, 0), flag=wx.TOP|wx.LEFT, border=10)

        comboBox3Choices = [ u"LF12-Ldr", u"LF1-Trk",u"CN1-Trk" ]
        self.comboBox3 = wx.ComboBox(panel,wx.ID_ANY,u"", wx.DefaultPosition, wx.DefaultSize, comboBox3Choices, 0 )
        sizer.Add( self.comboBox3, pos=(4, 1), span=(1, 3), flag=wx.TOP|wx.EXPAND )

        text4 = wx.StaticText(panel, label="Status")
        sizer.Add(text4, pos=(5, 0), flag=wx.TOP|wx.LEFT, border=10)

        comboBox4Choices = [ u"Not Started", u"Running" ]
        self.comboBox4 = wx.ComboBox(panel,wx.ID_ANY,u"", wx.DefaultPosition, wx.DefaultSize, comboBox4Choices, 0 )
        sizer.Add( self.comboBox4, pos=(5, 1), span=(1, 3), flag=wx.TOP|wx.EXPAND )

        self.button4 = wx.Button(panel, label="Update and Close")
        sizer.Add(self.button4, pos=(7, 3))

        sizer.AddGrowableCol(2)

        panel.SetSizer(sizer)

        self.button4.Bind(wx.EVT_BUTTON,self.onupdateandClose)

    def onupdateandClose(self,event):

       # self.index = 0
        self.main = MyForm()
        sc = self.comboBox1.GetSelection()
        machine_name = self.comboBox1.GetString(sc)
        #sa = self.main.m_staticText5.SetLabel(self.comboBox1.GetString(sc))
        #sa = self.frame1.m_staticText4.SetLabel(self.comboBox1.GetString(sc))
        #print sa
        machine_name = self.comboBox1.GetValue()
        #print sc
        sim_port = self.comboBox2.GetValue()
        sim_script = self.comboBox3.GetValue()
        status = self.comboBox4.GetValue()
        #num_items = self.main.list_ctrl.GetItemCount()
        #print num_items
        num_items = 0

        #line = "Line %s" % self.index
        #print line
        # line = 'LDR2'

        # self.main.list_ctrl.InsertStringItem(num_items,line)
        # self.main.list_ctrl.SetStringItem(num_items, 1, 'gjg')
        # self.main.list_ctrl.SetStringItem(num_items, 2, str(cb2))
        # num_items += 1

        self.parent.add_line_dynamic(machine_name, sim_port, sim_script, status)
        self.Close()

    # def test(self, event):
    #     self.new = NewWindow(parent=None, id=-1)
    #     self.new.Show()
#----------------------------------------------------------------------
# Run the program
if __name__ == "__main__":
    app = wx.App(False)
    frame = MyForm()
    frame.Show()
    app.MainLoop() 
```

我在 MyForm 类中添加了一个函数，*名为 add_line_dynamic(machine_name, sim_port, sim_script, status)*。

```
def add_line_dynamic(self, machine_name, sim_port, sim_script, status):
        print machine_name, sim_port, sim_script, status
        self.list_ctrl.InsertStringItem(self.index, machine_name)
        self.list_ctrl.SetStringItem(self.index, 1, sim_port)
        self.list_ctrl.SetStringItem(self.index, 2, sim_script)
        self.list_ctrl.SetStringItem(self.index, 3, status)
        self.list_ctrl.SetStringItem(self.index, 4, "none")
        self.index += 1 
```

该函数将从另一个类 NewWindow() 中调用。通话是与父母联系的。*self.parent.add_line_dynamic(machine_name, sim_port, sim_script, status).*

```
self.parent.add_line_dynamic(machine_name, sim_port, sim_script, status) 
```

从 MyForm 调用 NewWindow。而NewWindow 知道他的父母Myform。您可以从他的父级调用另一个函数并将参数传递给该类。我希望你明白其中的逻辑。

ps对不起我的英语:)

# python - 使用 Python 和 Numpy 实现根升余弦 (RRC) 过滤器的简单方法

> ID：14614966
> 
> 赞同：7
> 
> 时间：2013-01-30T22:20:28.410
> 
> 标签：python, numpy, scipy, signal-processing

SciPy/Numpy 似乎支持许多过滤器，但不支持根升余弦过滤器。是否有一种技巧可以轻松创建而不是计算传递函数？一个近似值也可以。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-09-15T22:44:26.280

该`commpy`软件包包含几个过滤器。返回变量的顺序在早期版本中已切换（截至本次编辑，当前版本为 0.7.0）。要安装，请[在此处](https://pypi.org/project/scikit-commpy/)或[此处](https://github.com/veeresht/CommPy)*强调文字*说明。

这是 QAM16 的 1024 个符号的使用示例：

```
import numpy as np
from commpy.modulation import QAMModem
from commpy.filters import rrcosfilter
N = 1024  # Number of symbols
os = 8 #over sampling factor
# Create modulation. QAM16 makes 4 bits/symbol
mod1 = QAMModem(16)
# Generate the bit stream for N symbols
sB = np.random.randint(0, 2, N*mod1.num_bits_symbol)
# Generate N complex-integer valued symbols
sQ = mod1.modulate(sB)
sQ_upsampled = np.zeros(os*(len(sQ)-1)+1,dtype = np.complex64) 
sQ_upsampled[::os] = sQ
# Create a filter with limited bandwidth. Parameters:
#      N: Filter length in samples
#    0.8: Roll off factor alpha
#      1: Symbol period in time-units
#     24: Sample rate in 1/time-units
sPSF = rrcosfilter(N, alpha=0.8, Ts=1, Fs=over_sample)[1]
# Analog signal has N/2 leading and trailing near-zero samples
qW = np.convolve(sPSF, sQ_upsampled) 
```

下面是对参数的一些解释。`N`是波特率样本数。您需要的位数是样本的 4 倍（在 QAM 的情况下）。我让`sPSF`数组返回`N`元素，这样我们就可以看到带有前导和尾随样本的信号。有关参数的解释，请参见[Wikipedia Root-raised-cosine filter page](https://en.wikipedia.org/wiki/Root-raised-cosine_filter)`alpha`。`Ts`是以秒为单位的符号周期，`Fs`是每个 的滤波器样本数`Ts`。我喜欢假装`Ts=1`让事情变得简单（单位符号率）。然后`Fs`是每个波特点的复杂波形样本数。

如果使用 return element 0 from`rrcosfilter`来获取采样时间索引，则需要插入正确的符号周期和过滤采样率，`Ts`以便`Fs`正确缩放索引值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-05-26T21:09:07.250

将根升余弦滤波器标准化在一个通用包中会很好。这是我同时基于 commpy 的实现。它使用 numpy 进行矢量化，并在不考虑符号率的情况下进行归一化。

```
def raised_root_cosine(upsample, num_positive_lobes, alpha):
    """
    Root raised cosine (RRC) filter (FIR) impulse response.

    upsample: number of samples per symbol

    num_positive_lobes: number of positive overlaping symbols
    length of filter is 2 * num_positive_lobes + 1 samples

    alpha: roll-off factor
    """

    N = upsample * (num_positive_lobes * 2 + 1)
    t = (np.arange(N) - N / 2) / upsample

    # result vector
    h_rrc = np.zeros(t.size, dtype=np.float)

    # index for special cases
    sample_i = np.zeros(t.size, dtype=np.bool)

    # deal with special cases
    subi = t == 0
    sample_i = np.bitwise_or(sample_i, subi)
    h_rrc[subi] = 1.0 - alpha + (4 * alpha / np.pi)

    subi = np.abs(t) == 1 / (4 * alpha)
    sample_i = np.bitwise_or(sample_i, subi)
    h_rrc[subi] = (alpha / np.sqrt(2)) \
                * (((1 + 2 / np.pi) * (np.sin(np.pi / (4 * alpha))))
                + ((1 - 2 / np.pi) * (np.cos(np.pi / (4 * alpha)))))

    # base case
    sample_i = np.bitwise_not(sample_i)
    ti = t[sample_i]
    h_rrc[sample_i] = np.sin(np.pi * ti * (1 - alpha)) \
                    + 4 * alpha * ti * np.cos(np.pi * ti * (1 + alpha))
    h_rrc[sample_i] /= (np.pi * ti * (1 - (4 * alpha * ti) ** 2))

    return h_rrc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-09T20:34:20.513

commpy 似乎还没有发布。但这是我的知识点。

```
beta = 0.20 # roll off factor

Tsample = 1.0 # sampling period, should at least twice the rate of the symbol

oversampling_rate = 8 # oversampling of the bit stream, this gives samples per symbol
# must be at least 2X the bit rate

Tsymbol = oversampling_rate * Tsample # pulse duration should be at least 2 * Ts
span = 50 # number of symbols to span, must be even
n = span*oversampling_rate # length of the filter = samples per symbol * symbol span

# t_step must be from -span/2 to +span/2 symbols.
# each symbol has 'sps' number of samples per second.
t_step = Tsample * np.linspace(-n/2,n/2,n+1) # n+1 to include 0 time

BW = (1 + beta) / Tsymbol
a = np.zeros_like(t_step)

for item in list(enumerate(t_step)):
    i,t = item 
    # t is n*Ts
    if (1-(2.0*beta*t/Tsymbol)**2) == 0:
        a[i] = np.pi/4 * np.sinc(t/Tsymbol)
        print 'i = %d' % i
    elif t == 0:
        a[i] = np.cos(beta * np.pi * t / Tsymbol)/ (1-(2.0*beta*t/Tsymbol)**2)
        print 't = 0 captured'
        print 'i = %d' % i 

    else:
        numerator = np.sinc( np.pi * t/Tsymbol )*np.cos( np.pi*beta*t/Tsymbol )
        denominator = (1.0 - (2.0*beta*t/Tsymbol)**2)
        a[i] =  numerator / denominator

#a = a/sum(a) # normalize total power

plot_filter = 0
if plot_filter == 1:

    w,h = signal.freqz(a)
    fig = plt.figure()
    plt.subplot(2,1,1)
    plt.title('Digital filter (raised cosine) frequency response')
    ax1 = fig.add_subplot(211)
    plt.plot(w/np.pi, 20*np.log10(abs(h)),'b')
    #plt.plot(w/np.pi, abs(h),'b')
    plt.ylabel('Amplitude (dB)', color = 'b')
    plt.xlabel(r'Normalized Frequency ($\pi$ rad/sample)')

    ax2 = ax1.twinx()
    angles = np.unwrap(np.angle(h))
    plt.plot(w/np.pi, angles, 'g')
    plt.ylabel('Angle (radians)', color = 'g')
    plt.grid()
    plt.axis('tight')
    plt.show()

    plt.subplot(2,1,2)
    plt.stem(a)
    plt.show() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-03T22:21:34.897

I think the correct response is to generate the desire impulse response. For a raised cosine filter the function is

```
h(n) = (sinc(n/T)*cos(pi * alpha* n /T)) / (1-4*(alpha*n/T)**2) 
```

Select the number of points for your filter and generate the weights.

```
output = scipy.signal.convolve(signal_in, h) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-10T17:13:38.150

这与 CommPy 中的函数基本相同，但代码要小得多：

```
def rcosfilter(N, beta, Ts, Fs):
    t = (np.arange(N) - N / 2) / Fs
    return np.where(np.abs(2*t) == Ts / beta,
        np.pi / 4 * np.sinc(t/Ts),
        np.sinc(t/Ts) * np.cos(np.pi*beta*t/Ts) / (1 - (2*beta*t/Ts) ** 2)) 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-04-03T09:26:55.337

SciPy 将支持任何过滤器。只需计算脉冲响应并使用任何适当的 scipy.signal 滤波器/卷积函数。

# python - Django on vagrant, psycopg2 OperationalError: could not connect to server: No such file or directory

> ID：14614975
> 
> 赞同：0
> 
> 时间：2013-01-30T22:21:08.867
> 
> 标签：python, django, postgresql, vagrant

在 vagrant box 上，通过`apt-get install python-psycopg2`. 测试导入成功。

```
$ python
Python 2.6.5 (r265:79063, Oct  1 2012, 22:04:36) 
[GCC 4.4.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import psycopg2
>>> exit() 
```

Django 设置文件：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': '/vagrant/v-root/projects/tdg/tdg/mydata.db',                      # Or path to database file if using sqlite3.
        'USER': 'username',                      # Not used with sqlite3.
        'PASSWORD': 'password',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
} 
```

在新的 vagrant box 上找不到 postgres_psycopg2 的问题。

```
$ python manage.py shell
Python 2.6.5 (r265:79063, Oct  1 2012, 22:04:36) 
[GCC 4.4.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole)
>>> from django.db import connection
>>> cursor = connection.cursor()
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "/usr/local/lib/python2.6/dist-packages/django/db/backends/__init__.py", line 306, in cursor
    cursor = self.make_debug_cursor(self._cursor())
  File "/usr/local/lib/python2.6/dist-packages/django/db/backends/postgresql_psycopg2/base.py", line 177, in _cursor
    self.connection = Database.connect(**conn_params)
OperationalError: could not connect to server: No such file or directory
    Is the server running locally and accepting
    connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?

>>> 
```

我跑了一个`netstat —listen`，我没有看到端口 5432 正在监听。只有 22 个（SSH）和 8000 个（Django 应用程序）在监听。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:31:24.980

您没有完全安装 postgres - 您只是安装了 psycopg2，它是 postgres 的 python 客户端。您需要像这样安装和运行 postgres：

```
apt-get install postgresql
/etc/init.d/postgresql start 
```

（您可能还需要登录并为自己创建一个数据库供您的项目与之交谈）

# ios - 在 UIPopoverController 中以可变宽度显示 UITableViewController

> ID：14614978
> 
> 赞同：0
> 
> 时间：2013-01-30T22:21:22.187
> 
> 标签：ios, objective-c, uitableview, uipopovercontroller

我将使用 UIPopoverController 来显示 UITableViewController。表格视图将显示长度未知的名称列表（可能是 Bob 或可能是 Alexander）。

我知道如何改变弹出框的高度，但我似乎不知道如何改变它的宽度，因此名称不会被截断。

需要弄清楚名称的宽度，以便我可以将弹出框设置为该宽度，这样名称就不会从弹出框中溢出：

![在此处输入图像描述](../Images/76999443324bccebf0aebde6bc7198e7.png)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T22:29:25.403

获取字符串的宽度，然后将 UITable 设置为该宽度。这是您可以添加以获取宽度的方法。您可以将其添加到类别或您的班级。[我从这里](https://stackoverflow.com/questions/3429671/how-to-get-the-width-of-an-nsstring)拿了代码。

```
- (CGFloat)widthOfString:(NSString *)string withFont:(NSFont *)font {
     NSDictionary *attributes = [NSDictionary dictionaryWithObjectsAndKeys:font, NSFontAttributeName, nil];
     return [[[NSAttributedString alloc] initWithString:string attributes:attributes] size].width;
 } 
```

通过这种方式，您可以指定您正在使用的字体，以防您将来最终更改它。（不同的字体显然会导致不同的宽度）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:39:35.757

大概你有任何名称数组。您要做的是枚举名称列表，确定每个名称所需的长度，然后存储最大的名称并将其应用为所需的宽度。您将需要定义一个不应超过的“最大尺寸”。沿着这些思路的方法应该返回合适的东西：

```
- (CGFloat)suitableWidthForLabel:(UILabel *)nameLabel withNames:(NSArray *)arrayOfNames
{

    CGFloat suitableWidth = 100.0f; // A reasonable starting point
    CGSize maximumSize = CGSizeMake(600.0f, nameLabel.frame.size.height);
    UIFont *labelFont = [nameLabel font];

    for (NSString *aName in arrayOfNames)
    {

        CGSize expectedLabelSize = [aName sizeWithFont:labelFont
                                        constrainedToSize:maximumSize
                                            lineBreakMode:nameLabel.lineBreakMode];

        suitableWidth = MAX(suitableWidth, expectedLabelSize.width);
    }

    return suitableWidth; // This will be the largest size you may need to accommodate
} 
```

# excel - 在 Excel VBA 2010 中：如何销毁 excel vba.application 对象

> ID：14614984
> 
> 赞同：0
> 
> 时间：2013-01-30T22:21:41.190
> 
> 标签：excel, vba

我有一个 Excel.Application 对象，在我的 VBA 代码执行并且 Excel 2010 完全关闭之后，它似乎作为 Windows 进程存在。即 Windows 任务管理器将进程显示为“EXCEL.EXE *32”，即使在我关闭 Excel 之后也是如此。

下面是一些代码：

公共子测试 Dim xls 作为对象

```
Set xls = CreateObject("Excel.Application")
Set wb = xls.Workbooks.Add

fullFilePath = importFolderPath & "\" & "A1"
wb.SaveAs fullFilePath, AccessMode:=xlExclusive    ' SAVE WORKBOOK AND CLOSE !
wb.Close (True)

' question: How can I destroy the xls object ???? 
```

结束子

基本上我不知道如何销毁我在代码中创建的“xls”。正如我上面所说，它会导致 EXCEL.EXE *32 作为 Windows 进程继续存在。

提前谢谢....鲍勃

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T22:27:12.640

`xls.Quit`关闭工作簿后使用

# php - php - 使用类型提示和依赖注入

> ID：14614991
> 
> 赞同：2
> 
> 时间：2013-01-30T22:21:58.597
> 
> 标签：php, testing, object, types

我在将对象传递给其构造函数的类上使用[类型提示。](http://php.net/manual/en/language.oop5.typehinting.php)传递的对象（Bar）存在于它自己的命名空间中。这一切都很好，直到我将传递的对象换成一个假的（用于单元测试目的）。我的测试 Bar 对象位于它自己的命名空间中，现在（非常正确地）抛出了一个错误。

```
use Some\Place\Bar
class Foo {
    // Passing a test Bar into here now throws error.
    public function __construct(Bar $bar) {
        $this->bar = $bar;
    }

} 
```

我是 PHP 新手，所以不确定什么是可能的。有没有办法解决这个问题，还是我只需要从课程中删除类型提示（这是我目前的解决方案）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T22:28:38.503

几个选项中的 2 个：

在实现接口 IBar 的构造函数中传递一个对象：

```
 interface IBar{
  function baz();
 }

 class Bar implements IBar{
    function baz(){ return $this->getSomethingExpensiveFromDatabase();}
 }

 class FakeBar implements IBar{
    function baz(){ return "baz";}
 }

 class Foo {
 function __construct(IBar $bar) ... 
```

或不使用类型提示

```
function __construct($bar) 
```

关键是，方法的签名永远不应该依赖于实现，总是依赖于接口。

编辑：所以你只需要导入接口，然后导入假类，无论它来自哪里。FakeBar 然后可以模拟 Bar。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T22:35:07.317

类型杂耍是完全不同的事情，您在这里展示的是[类型提示](http://php.net/manual/en/language.oop5.typehinting.php)。您不能传入具有相同类名但位于不同命名空间中的对象，但您可以从一个类中传入一个对象，该类继承自您的方法所期望的类：

```
namespace Testing;
use Some\Place\Bar;
class TestingBar extends Bar {
} 
```

然后，您可以将 TestingBar 的实例传递给您的方法。

如果您想对原始 Bar 类和测试 Bar 类使用相同的名称，则需要将其中一个别名化（但我建议不要这样做）：

```
namespace Testing;
use Some\Place\Bar as OriginalBar;

class Bar extends OriginalBar {
} 
```

# android - SQLite 错误 21。“误用在线……”

> ID：14614994
> 
> 赞同：0
> 
> 时间：2013-01-30T22:22:05.830
> 
> 标签：android, sqlite, mono

我正在使用此代码将 SQLite DB 存储到 sdcard 位置（设备 /mnt/sdcard/MiniMate 上的位置）：

```
string libraryPath = Android.OS.Environment.ExternalStorageDirectory.AbsolutePath;            
libraryPath = System.IO.Path.Combine(libraryPath, "MiniMate");
if (!System.IO.Directory.Exists(libraryPath)) System.IO.Directory.CreateDirectory(libraryPath);
            string path = System.IO.Path.Combine(libraryPath, sqliteFilename); 
```

当我使用从 Visual Studio 部署到设备时，它工作得很好；但是，如果我创建 .apk 并将其安装在设备上，则会出现错误“21”。看起来它没有权限对 DB 执行某些操作，当我尝试在 DB 中插入某些内容时出现“约束”错误。

有人知道这个问题吗？我不想将数据库移动到不同的默认位置，谢谢！

我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" android:installLocation="internalOnly" package="com.prismvs.minimate" android:versionCode="14" android:versionName="14">
  <uses-sdk android:targetSdkVersion="12" android:minSdkVersion="12" />
  <application android:icon="@drawable/icon" android:label="MiniMate">
  </application>
  <uses-permission android:name="android.permission.INTERNET" />
  <uses-permission android:name="android.permission.CAMERA" />
  <uses-permission android:name="android.permission.BLUETOOTH" />
  <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
  <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
  <uses-permission android:name="android.permission.SET_ORIENTATION" />
  <uses-permission android:name="android.permission.WRITE_OWNER_DATA" />
  <uses-permission android:name="android.permission.READ_OWNER_DATA" />
</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T14:48:06.013

几天前我发布了这篇文章，花了很多时间来寻找问题，因为我走错了方向，所以我想分享这个经验，也许它会帮助某人解决他们使用 SQLite + Mono for Android 的问题：

1.  我有项目在不同的项目（常见的跨平台项目）中主要应用程序和用户库
2.  SQLite 在用户库中使用，而不是在主应用程序项目中
3.  当我为 Google Play 构建 Release (apk) 并将其安装在 Android 设备上时，出现错误日志：E/SQLiteLog(32375): (1) near ")": syntax error E/SQLiteLog(32375): (21) API called使用 NULL 准备语句 E/SQLiteLog(32375): (21) misuse at line 63243 of [00bb9c9ce4] 调试版本没有发生，所以我为解决这个问题做了什么：在 Visual studion 项目属性 - > Mono Android 选项 - > 链接：我设置“仅 SDK 程序集”而不是“SDK 和用户程序集”此错误消失。

# php - jQuery ajax 只更新 div 一次

> ID：14614996
> 
> 赞同：1
> 
> 时间：2013-01-30T22:22:10.623
> 
> 标签：php, jquery, ajax

我目前正在使用 ajax 尝试创建一个脚本，该脚本从实时更新的数据库中返回一个值。

**HTML**

```
<!doctype html>
<html lang="en-gb">
<head>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script type="text/javascript" src="ajax.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            liveReload('#ajax');
        });
    </script>
    <meta charset="utf-8">
</head>
<body>
    <section id="ajax">0</section>
</body>
</html> 
```

**PHP**

```
<?php

class Ajax
{
    public static function grab()
    {
        try
        {
            $db = new PDO('mysql:host=localhost;dbname=ajax', 'root', null);
            $rq = $db->query('select setting, value from test');
            return $rq->fetchAll(PDO::FETCH_ASSOC)[0];
        }
        catch (PDOException $e)
        {
            echo $e->getMessage();
        }
    }
}

echo json_encode(Ajax::grab()); 
```

**查询**

```
(function() {

liveReload = function(element) {
    $.ajax({
        url: 'ajax.php',
        dataType: 'json',
        cache: false,
        success: function(data)
        {
            $(element).html(data['value']);
            setTimeout(liveReload, 1000);
        }
    })
}

})(jQuery); 
```

问题是该值仅在页面中更新一次，尽管函数在更新时返回新值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T22:28:53.367

正如我在评论中所说：您不会将元素传递给 setTimeout，因此它会丢失对元素的引用并且实际上什么也不显示

```
setTimeout(function() {liveReload(element);}, 1000); 
```