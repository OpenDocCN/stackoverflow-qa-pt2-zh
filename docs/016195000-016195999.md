# StackOverflow 问答 16195000-16195999

# java - java.io 的 Google App Engine 限制？

> ID：16195000
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:44:37.413
> 
> 标签：java, google-app-engine, gwt

我有一个 GWT 应用程序，它可以在 GAE Google App Engine 本地运行良好。

在服务器端 RPC 服务中，我使用以下 json 类： [http ://code.google.com/p/json-io/source/browse/src/main/java/com/cedarsoftware/util/io/JsonWriter.java](http://code.google.com/p/json-io/source/browse/src/main/java/com/cedarsoftware/util/io/JsonWriter.java)

我在本地工作没有问题，但是在云中部署到 Google App Engine 时，我在这门课上得到了 Stackoverflow。

云中可能有任何本地没有发生的限制，因此它失败了？或者云中的谷歌应用引擎不支持以下任何类？

```
import java.io.BufferedWriter;
import java.io.ByteArrayOutputStream;
import java.io.Closeable;
import java.io.Flushable;
import java.io.IOException;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.UnsupportedEncodingException;
import java.io.Writer; 
```

这是我在 appengine 日志中得到的堆栈跟踪：

```
javax.servlet.ServletContext log: Exception while dispatching incoming RPC call

java.lang.StackOverflowError
    at com.google.gwt.user.server.rpc.RPC.encodeResponseForFailure(RPC.java:389)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:579)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
    at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.apphosting.utils.servlet.ParseBlobUploadFilter.doFilter(ParseBlobUploadFilter.java:125)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.runtime.jetty.SaveSessionFilter.doFilter(SaveSessionFilter.java:35)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.JdbcMySqlConnectionCleanupFilter.doFilter(JdbcMySqlConnectionCleanupFilter.java:57)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.handle(AppVersionHandlerMap.java:266)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
    at com.google.apphosting.runtime.jetty.RpcRequestParser.parseAvailable(RpcRequestParser.java:76)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at com.google.apphosting.runtime.jetty.JettyServletEngineAdapter.serviceRequest(JettyServletEngineAdapter.java:146)
    at com.google.apphosting.runtime.JavaRuntime$RequestRunnable.run(JavaRuntime.java:438)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:480)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:487)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:774)
    at com.google.tracing.TraceContext$DoInTraceContext.runInContext(TraceContext.java:751)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:342)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:334)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:484)
    at com.google.apphosting.runtime.ThreadGroupPool$PoolEntry.run(ThreadGroupPool.java:251)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.StackOverflowError
    at java.security.AccessController.doPrivileged(Native Method)
    at java.io.PrintWriter.<init>(PrintWriter.java:116)
    at java.io.PrintWriter.<init>(PrintWriter.java:100)
    at java.util.logging.SimpleFormatter.format(SimpleFormatter.java:155)
    at java.util.logging.StreamHandler.publish(StreamHandler.java:196)
    at java.util.logging.ConsoleHandler.publish(ConsoleHandler.java:105)
    at java.util.logging.Logger.log(Logger.java:530)
    at java.util.logging.Logger.doLog(Logger.java:551)
    at java.util.logging.Logger.log(Logger.java:640)
    at java.lang.reflect.Field.get(Field.java:30)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeObject(JsonWriter.java:1508)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeImpl(JsonWriter.java:636)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeObject(JsonWriter.java:1531)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeImpl(JsonWriter.java:636)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeCollectionElement(JsonWriter.java:1441)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeCollection(JsonWriter.java:980)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeImpl(JsonWriter.java:608)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeObject(JsonWriter.java:1531)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeObject(JsonWriter.java:1531)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeImpl(JsonWriter.java:636)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeObject(JsonWriter.java:1531)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeImpl(JsonWriter.java:636)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeCollectionElement(JsonWriter.java:1441)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeCollection(JsonWriter.java:980)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeImpl(JsonWriter.java:608)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeObject(JsonWriter.java:1531)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeImpl(JsonWriter.java:636)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeObject(JsonWriter.java:1531)
    at com.google.gwt.user.server.rpc.util.io.JsonWriter.writeImpl(JsonWriter.java:636)
[and so on...] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:38:25.067

似乎本地的递归循环结束了，因为堆栈大小足以解决操作，但在 gae 中它们更具限制性。

一个解决方案是改变你的对象复杂性，你可以把它贴在这里吗？

# c# - EF 实体结果为 db 中非空的列返回空

> ID：16195001
> 
> 赞同：3
> 
> 时间：2013-04-24T14:44:42.987
> 
> 标签：c#, asp.net-mvc, entity-framework

从我的数据库中提取数据时得到一个奇怪的结果。在一种情况下，我有一个在数据库中不为空且具有有效日期的日期时间字段。但是当 EF 返回记录时，它返回 null。

如果我使用 EF 正在使用的相同 sql 语句并在 SSMS 中运行它，它将返回正确的值。

我认为这是因为它已经缓存了该记录并正在返回缓存的版本……这可能吗？你怎么能强制它从数据库中刷新？

这是我提取记录的代码：

```
 public override IQueryable<TimeDetail> SearchFor(Expression<Func<TimeDetail, bool>> predicate, Expression<Func<TimeDetail, bool>> orderbylinq = null, Expression<Func<TimeDetail, object>>[] includes = null)
        {
            var result = DbSet
                .Include("Customer")
                .Include("OrderHeader")
                .Include("TimeDetailStatus")
                .Include("TimeDetailTask.TimeDetailTaskType")
                .Where(predicate);

            if (orderbylinq != null)
            {
                result = result.OrderBy(orderbylinq);
            }

            return result;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:54:20.713

我假设`DbSet`是你的`DbContext`. 为了*刷新*它，您需要重新创建它。

就像是：

```
DbSet = new DbSet(); 
```

# php - 将对象保存为 JSON，然后稍后加载？

> ID：16195005
> 
> 赞同：2
> 
> 时间：2013-04-24T14:44:47.830
> 
> 标签：php

我知道如何对对象进行 JSON 编码和解码。这没什么大不了的。但是，我遇到了需要保存`$this`为 JSON 字符串的情况，然后再`$this`从该 JSON 字符串中填充 的属性。

换句话说，我不想使用 JSON 字符串中的数据获取对象的新实例，我想将其应用于现有对象。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:55:32.707

[您可以使用http://php.net/manual/en/function.get-object-vars.php](http://php.net/manual/en/function.get-object-vars.php)获取对象的定义属性`get_object_vars()`

```
class MyClass
{
    function populateFromJSON($data)
    {
        $o = json_decode($data);
        $attributes = get_object_vars($o);
        if (is_array($attributes)) {
            foreach ($attributes as $name => $val) {
                $this->$name = $val;
            }
        }
    }
} 
```

# c# - WSCF.Blue DataContract 生成功能如何工作？

> ID：16195006
> 
> 赞同：1
> 
> 时间：2013-04-24T14:44:54.883
> 
> 标签：c#, wcf, datacontractserializer, xmlserializer, wscf.blue

我试图弄清楚 WSCF Blue DataContract 生成功能是如何工作的。

它记录在这里：[http ://alexmg.com/post/2009/09/01/Data-contract-generation-is-now-available-in-WSCFblue.aspx](http://alexmg.com/post/2009/09/01/Data-contract-generation-is-now-available-in-WSCFblue.aspx)

我有一组 WSDL 和 XSD 文件，我们可以从中使用“常规”方法创建 Web 服务代码。

生成的服务不允许您在客户端使用数据合约，这意味着我们得到了很多 Array 类型而不是 List 类型。

或者更准确地说，我们不能得到列表，只有数组，所以这意味着它没有使用 DataContracts。

因此，在服务器端生成服务代码时，我有两个选项。

1.  使用常规选项，生成一个抽象类，我们从中创建一个具体的服务类
2.  使用“生成数据合同”选项。这将创建一个 .cs 文件，其中仅包含表示 Xsd 类型的类，没有服务的抽象类。

因此，如果我尝试使用常规选项生成服务类，我现在有很多代表 Xsd 类型的重复类。

我显然有错误的一端。

有没有人设法让 WSC​​F.blue 使用 DataContracts 而不是 XmlSerializer？

# php - 将多个匹配正则表达式合二为一，得到匹配的正则表达式

> ID：16195011
> 
> 赞同：4
> 
> 时间：2013-04-24T14:45:11.883
> 
> 标签：php, regex, preg-match

我有一个正则表达式列表：

```
suresnes|suresne|surenes|surene
pommier|pommiers
^musique$
^(faq|aide)$
^(file )?loss( )?less$
paris
faq                              <<< this match twice 
```

我的用例是每个匹配的模式都显示一个指向我的用户的链接，所以我可以有多个模式匹配。

我用一个简单的文本字符串“live in paris”/“faq”/“pom”来测试这些模式......

最简单的方法是用 a 遍历所有模式`preg_match`，但我会在**性能关键页面**上做很多事情，所以**这对我来说看起来很糟糕**。

这是我尝试过的：将所有这些表达式与组名组合成一个：

```
preg_match("@(?P<group1>^(faq|aide|todo|paris)$)|(?P<group2>(paris)$)@im", "paris", $groups); 
```

正如你所看到的，每个模式都是分组的：`(?P<GROUPNAME>PATTERN)`它们都由一个管道分隔`|`。

结果不是我所期望的，因为只返回了第一个组匹配。看起来当匹配发生时解析停止。

我想要的是所有匹配组的列表。`preg_match_all`也无济于事。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T11:26:22.827

怎么样：

```
preg_match("@(?=(?P<group1>^(faq|aide|todo|paris)$))(?=(?P<group2>(paris)$))@im", "paris", $groups);
print_r($groups); 
```

**输出：**

```
Array
(
    [0] => 
    [group1] => paris
    [1] => paris
    [2] => paris
    [group2] => paris
    [3] => paris
    [4] => paris
) 
```

这`(?= )`被称为[前瞻](http://www.regular-expressions.info/lookaround.html)

**正则表达式的解释：**

```
(?=                                     # start lookahead
    (?P<group1>                         # start named group group1
        ^                               # start of string
            (                           # start catpure group #1
                faq|aide|todo|paris     # match any of faq, aide, todo or paris
            )                           # end capture group #1
        $                               # end of string
    )                                   # end of named group group1
)                                       # end of lookahead
(?=                                     # start lookahead
    (?P<group2>                         # start named group group2
            (                           # start catpure group #2
            paris                       # paris
        )                               # end capture group #2
        $                               # end of string
    )                                   # end of named group group2
)                                       # end of lookahead 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T20:58:56.397

试试这个方法：

```
#/ define input string
$str_1 = "{STRING HERE}";

#/ Define regex array
$reg_arr = array(
'suresnes|suresne|surenes|surene',
'pommier|pommiers',
'^musique$',
'^(faq|aide)$',
'^(file )?loss( )?less$',
'paris',
'faq'
);

#/ define a callback function to process Regex array
function cb_reg($reg_t)
{
    global $str_1;
    if(preg_match("/{$reg_t}/ims", $str_1, $matches)){
    return $matches[1]; //replace regex pattern with the result of matching is the key trick here
    //or return $matches[0]; if you dont want to get captured parenthesized subpatterns
    //or you could return an array of both. its up to you how to do it.
    }else{
    return '';
    }
}

#/ Apply array Regex via much faster function (instead of a loop)
$results = array_map('cb_reg', $reg_arr); //returns regex results
$results = array_diff($results, array('')); //remove empty values returned 
```

基本上，这是我能想到的最快的方法。

1.  您不能将 100 多个正则表达式组合到一个调用中，因为它会是非常复杂的正则表达式，并且有几次匹配失败的机会。这是最好的方法之一。

2.  在我看来，与on`preg_match`的这种方法相比，将大量正则表达式组合成 1 个正则表达式（如果可能实现）会更慢执行。请记住，这里的关键是，这是为您和类似情况处理数组的最快方法。`Callback``Arrays``Callback function on array member values``php`

另请注意， The`callback on Array`不等于`looping the Array`。循环速度较慢，并且从算法分析中得到一个**n 。**但是数组元素的回调是内部的，相比之下非常快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-23T21:51:58.613

您可以将所有正则表达式与“|”结合起来 在他们之间。然后应用这个：[http://www.rexegg.com/regex-optimizations.html](http://www.rexegg.com/regex-optimizations.html)，它将优化它，折叠常用表达式等。

# php - PDO 和 MariaDB

> ID：16195013
> 
> 赞同：36
> 
> 时间：2013-04-24T14:45:21.040
> 
> 标签：php, pdo, mariadb

我在 PHP 中使用 PDO 已经有一段时间了，现在正在使用 MySQL。

然而，最近的发展让我认为 MySQL 将开始逐渐淡出以取代 MariaDB，尤其是在 MariaDB 之后：

*   认为自己比 MySQL 早了许多开发人员年，而没有将新的开发投入付费领域（例如集群）。
*   在甲骨文接管之后，大多数主要的 MySQL 开发人员都转向了 MariaDB。
*   正在成为在各种 Linux 发行版上取代 MySQL 的默认数据库。
*   是 MySQL 替代品的下降，大公司开始采用 MariaDB，例如 Wikipedia（[在此处阅读博客文章](http://blog.wikimedia.org/2013/04/22/wikipedia-adopts-mariadb/)）。

所以我的问题是，因为 MariaDB 似乎没有在 PDO 驱动程序中列出，并且认为 MariaDB 被设计为“替代品”，并且可能在未来逐步淘汰 MySQL。

**我是否可以将 MySQL PDO 驱动程序与 MariaDB 数据库一起使用，至少在官方 MariaDB 驱动程序可用之前？**

*链接*

*   [PDO](http://php.net/manual/en/book.pdo.php)
*   [MySQL](http://www.mysql.com/)
*   [玛丽亚数据库](https://mariadb.org/)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-24T14:47:33.673

MariaDB 和 MySQL ~~100%~~ 99% 兼容。这包括连接器兼容性。

编辑：直到 MariaDB 工具作为 MySQL 工具（例如 mysqldump）提供，并且数据文件也是二进制兼容的

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T14:48:35.077

> 我是否可以将 MySQL PDO 驱动程序与 MariaDB 数据库一起使用，至少在官方 MariaDB 驱动程序可用之前？

是的。

以及 Percona 或任何其他在其核心中都是旧的好 mysql 的分支。

# sparql - Jena OWL 推理器的问题

> ID：16195014
> 
> 赞同：2
> 
> 时间：2013-04-24T14:45:22.587
> 
> 标签：sparql, jena, owl, reasoning

我是耶拿的新手，但现在遇到了一些问题。我有一个超类*查询处理*及其四个子类：

*   查询处理
*   — 查询意图
*   — 查询重构
*   — 查询表示
*   — 查询建议

当我使用：

```
PREFIX Article: <http://www.semanticweb.org/aero/ontologies/computer-science#>
SELECT ?paper ?category 
WHERE 
{
  ?paper Article:inQueryIntent ?category .
} 
```

或者用任何其他 3 个子类作为谓词，`inQueryReformulation`我可以得到正确的答案。

但是，当我使用`?article Article:inQueryProcessing ?category`which 应该返回与子类 QueryProcessing 相关的所有个人时，我什么也没得到。`inQueryIntent`（和其他 3 个）并且`inQueryProcessing`是对象属性。

这是我的代码：

```
Dataset dataset = TDBFactory.createDataset(directory);
Model model = dataset.getNamedModel(modelName);
OntModel ontModel = ModelFactory.createOntologyModel(OntModelSpec.OWL_MEM_MICRO_RULE_INF, model);
Reasoner reasoner = ReasonerRegistry.getOWLReasoner();
InfModel infModel = ModelFactory.createInfModel(reasoner, ontModel);
Query query = QueryFactory.create(queryString);
QueryExecution queryExe = QueryExecutionFactory.create(query, infModel); 
```

这是本体片段：

对象属性：

```
<!-- http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#inQueryIntent -->

<owl:ObjectProperty rdf:about="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#inQueryIntent">
    <rdf:type rdf:resource="&owl;FunctionalProperty"/>
    <rdfs:range rdf:resource="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#Query_intent"/>
    <rdfs:domain rdf:resource="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#article"/>
    <rdfs:subPropertyOf rdf:resource="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#inInformationRetrievalQueryProcessing"/>
</owl:ObjectProperty> 
```

班级：

```
<owl:Class rdf:about="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#Query_intent">
    <rdfs:subClassOf rdf:resource="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#Information_retrieval_query_processing"/>
</owl:Class> 
```

个人：

```
<owl:NamedIndividual rdf:about="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#Classifying_Web_Queries_by_Topic_and_User_Intent">
    <rdf:type rdf:resource="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#article"/>
    <hasAuthor rdf:resource="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#Bernard_J._Jansen"/>
    <inQueryIntent rdf:resource="http://www.semanticweb.org/aero/ontologies/2013/1/computer-science#Query_intent"/>
</owl:NamedIndividual> 
```

我只是在计算机科学中建立了一个领域本体，所有的类都是层次结构中的概念（比如查询处理是一个超类，查询意图/重构/......是子类），所有的论文及其通讯作者都是个人

# mysql - MySQL 可用性日历

> ID：16195019
> 
> 赞同：1
> 
> 时间：2013-04-24T14:45:41.923
> 
> 标签：mysql, sql, calendar

我有一个预订系统，我想显示列表的**月历**视图。我有以下表结构（还有很多其他列）；

```
CREATE TABLE `sys_calendar` (
    `dt` date NOT NULL,
    PRIMARY KEY (`dt`)
);

CREATE TABLE `listings` (
    `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
    `title` varchar(255) NOT NULL,
    PRIMARY KEY (`id`),
);

CREATE TABLE `bookings` (
    `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
    `listing_id` int(10) unsigned NOT NULL,
    `start_date` date NOT NULL,
    `end_date` date NOT NULL,
    PRIMARY KEY (`id`)
); 
```

`sys_calendar`**保存从2000-01-01**到**2040-12-31**的所有日期；

```
dt
------------
2000-01-01
2000-01-02
2000-01-03
....
2040-12-30
2040-12-31 
```

我想要做的是显示特定列表的月历。例如; 我想`listing_id`在 2013 年 4 月（在 2013-04-01 和 2013-04-30 之间`bookings`）显示一个日历 = 10。

```
dt         | Availability
-------------------------
2013-04-01 | No
2013-04-02 | No
2013-04-03 | Yes
2013-04-04 | Yes
2013-04-05 | Yes
2013-04-06 | Yes
....
2013-04-29 | No
2013-04-30 | Yes 
```

我知道我必须加入`sys_calendar`和`bookings`表格，但不知道如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T18:23:15.280

我认为这对你有用：

```
SELECT  c.dt,
        CASE WHEN COUNT(b.id) > 0 THEN 'No' ELSE 'Yes' END AS Availability
FROM    sys_calendar c
        LEFT JOIN bookings b
            ON b.Listing_id = 10
            AND c.dt BETWEEN b.Start_Date AND b.End_Date
GROUP BY c.dt; 
```

**[SQL Fiddle 示例](http://sqlfiddle.com/#!9/15f5e/1)**

此外，如果您想显示多个可用性，您可以使用：

```
SELECT  c.dt,
        CASE WHEN COUNT(CASE WHEN b.Listing_id = 1 THEN 1 END) > 0 THEN 'No' ELSE 'Yes' END AS Availability1,
        CASE WHEN COUNT(CASE WHEN b.Listing_id = 2 THEN 1 END) > 0 THEN 'No' ELSE 'Yes' END AS Availability2,
        CASE WHEN COUNT(CASE WHEN b.Listing_id = 3 THEN 1 END) > 0 THEN 'No' ELSE 'Yes' END AS Availability3,
        CASE WHEN COUNT(CASE WHEN b.Listing_id = 4 THEN 1 END) > 0 THEN 'No' ELSE 'Yes' END AS Availability4
FROM    sys_calendar c
        LEFT JOIN bookings b
            ON c.dt BETWEEN b.Start_Date AND b.End_Date
WHERE   c.dt BETWEEN '20130401' AND '20130430'
GROUP BY c.dt; 
```

**[SQL Fiddle 示例](http://sqlfiddle.com/#!9/15f5e/3)**

# jquery - 在 Jquery 中使用 JSON 数据填充文本框

> ID：16195020
> 
> 赞同：0
> 
> 时间：2013-04-24T14:45:44.663
> 
> 标签：jquery, ajax, json, cakephp, cakephp-1.2

好的，所以我将 cakephp 1.2、jquery 和 ajax 与 JSON 结合使用。这是我正在做的事情：

当一个人输入员工 id 时，我会得到该员工 id 的结果，如果有的话，我会将其作为`$javascript->object(empInfo)`. 这工作正常。我将信息返回给函数，但我似乎无法处理它。我读过的所有内容都说将其用作`$.each(empInfo, function()`. 这是我的代码：

COMMON.JS

```
$(document).ready(function() {
$('#emp_num').blur(function() {
        if($(this).val().length != 0) {
            $.ajax({
                type: "POST",
                datatype: "json",
                url: '/ir_employees/getdetails/empId:' + $(this).val(),
                success: function(empInfo) {
                    populateEmployeeInformation(empInfo);
                }
            });
        }
    });
});

function populateEmployeeInformation(empInfo) {
    $.each(empInfo, function() {
        console.log(this);
    });
} 
```

EMPLOYEES_CONTROLLER.PHP

```
function getdetails() {
    $empId = $this->passedArgs['empId'];
    $this->layout = 'ajax';
    $this->set('empInfo', $this->IrEmployee->find('all', 
                        array('conditions' =>
                                array('IrEmployee.employee_number' => $empId))));

} 
```

获取详细信息.CTP

```
<?php
    if((isset($empInfo))){
        echo $javascript->object($empInfo);
    }

?> 
```

当我记录它时，我得到以下（截图）：

![JSON 屏幕截图](https://i.stack.imgur.com/wpbb5.png)

如何正确使用以下信息（这是 Firebug 的“响应”）：

```
[{"IrEmployee":{"id":"1","employee_number":"xxxxx","last_name":"Doe","first_name":"John","gender":"M","date_hired":"2013-04-09","date_of_birth":"1950-01-01","plant_id":"0"}}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:51:59.180

您的响应将作为字符串返回（console.log 显示您正在循环遍历字符串的每个字符），并且不会被解析为 JSON。

我认为这是因为您在 jQuery AJAX 选项中有`datatype`代替`dataType`（注意大写 T）。如果你解决了这个问题，jQuery 应该会自动为你解析 JSON。

或者，您可以将字符串传递给[JSON.parse](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse)（如果存在，如果不存在，则应该[polyfill](https://github.com/douglascrockford/JSON-js)）

# javascript - Google Plus 登录：如何捕获授权事件？

> ID：16195021
> 
> 赞同：1
> 
> 时间：2013-04-24T14:45:44.887
> 
> 标签：javascript, client, google-plus

我正在尝试实现 Google Plus 登录，并且我已经从[https://developers.google.com/+/quickstart/javascript](https://developers.google.com/+/quickstart/javascript)下载了一个示例 javascript 登录示例。

没有对代码进行任何更改。当我在 Firefox 或 Chrome 中打开页面并单击登录按钮时，会显示一个带有授权请求的弹出窗口。我单击“接受”按钮，弹出窗口被关闭，但页面上没有任何变化（登录按钮仍然存在）。之后只刷新页面显示我已经登录。但在 IE 中不会发生。

chrome控制台给了我以下错误：

> 不安全的 JavaScript 尝试 从带有 URL `https://plusone.google.com/_/widget/render/signin`...的框架访问带有 URL ...的框架。`https://accounts.google.com/o/oauth2/approval`域、协议和端口必须匹配。

据我所见，浏览器正在阻止不安全的调用（对吗？）。

有什么我做错了吗？

有没有办法将事件侦听器附加到谷歌的登录代码？

是否可以强制登录按钮在选项卡/窗口中而不是在弹出窗口中打开授权页面（G+ 登录似乎没有 redirect_url 选项）？

# macruby - 如何使用 MacRuby 实现 NSTabView 委托？

> ID：16195026
> 
> 赞同：0
> 
> 时间：2013-04-24T14:46:08.807
> 
> 标签：macruby

我尝试使用 MacRuby 和 XCode 设置 NSTabView 委托，但我不知道如何编写委托。我用：

```
def intialize
@tab_changed.delegate = self
end

def tabViewdidSelectTabViewItem(a_notification)
puts "tab has changed"
end 
```

然后在 .xib 中，我将 NSTab 视图元素与类挂钩，但是当我选择一些选项卡时没有任何反应。通常委托很容易使用，但是这个有这样的语法：tabView:didSelectTabViewItem:

而且我不知道如何在 MacRuby 中编写它。我应该使用 tabViewdidSelectTabViewItem 还是 tabView_didSelectTabViewItem （它们都不起作用）。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-21T20:43:02.320

假设这是在 ViewController 中完成的，而不是使用`initialize`，最好使用 Cocoa 方式并使用类似`viewDidLoad`.

```
def viewDidLoad
   @tab_changed.delegate = self
end 
```

您想要的委托方法的签名是`-(void)tabView:(NSTabView *)tabView didSelectTabViewItem:(NSTabViewItem *)tabViewItem`. 在 MacRuby 中，这将被表示为：

```
def tabView(tabView, didSelectTabViewItem: tabViewItem)
   puts "tab has changed"
end 
```

# c++ - addressof的实现

> ID：16195032
> 
> 赞同：32
> 
> 时间：2013-04-24T14:46:25.983
> 
> 标签：c++, c++11

以前不知道 的存在`std::addressof`，为什么它存在对我来说是有意义的：作为在重载的情况下获取地址的一种方式`operator&`。然而，实现稍微不透明。来自`gcc 4.7.1`：

```
template<typename _Tp>
inline _Tp*
__addressof(_Tp& __r) _GLIBCXX_NOEXCEPT
{
  return reinterpret_cast<_Tp*>
(&const_cast<char&>(reinterpret_cast<const volatile char&>(__r)));
} 
```

`reinterpret_cast<_Tp*>`很明显。剩下的就是黑魔法了。有人可以分解这实际上是如何工作的吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-24T14:54:45.030

*   首先你有`__r`哪个类型`_Tp&`
*   它被`reinterpret_cast`'ed 到 a`char&`以确保以后能够获取其地址而不必担心`operator&`原始类型中的重载；实际上它被强制转换为，`const volatile char&`因为即使它们不存在`reinterpret_cast`也总是可以合法地添加`const`和`volatile`限定符，但如果它们存在，它不能删除它们（这确保了任何限定符`_Tp`最初具有，它们不会干扰强制转换）。
*   这是`const_cast`'ed to just `char&`，删除限定符（现在合法！`const_cast`可以做`reinterpret_cast`关于限定符不能做的事情）。
*   地址被占用`&`（现在我们有一个 plain `char*`）
*   它被`reinterpret_cast`'ed back to `_Tp*`（包括原始`const`和`volatile`限定符，如果有的话）。

**编辑：**由于我的回答已被接受，我将彻底补充并补充说，选择`char`作为中间类型是由于对齐问题，以避免触发未定义的行为。有关完整解释，请参阅@JamesKanze 的评论（在问题下）。感谢詹姆斯解释得这么清楚。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-24T15:04:20.403

当您考虑它时，实际上非常简单，要在重载之前获取对象/函数的真实地址，`operator&`您需要将对象视为不同于它的真实存在的东西，某种不能具有重载运算符的类型。 . 一种*内在类型*（例如`char`）。

A`char`没有对齐，可以驻留在任何其他对象可以驻留的任何地方，话虽如此；将对象转换为对 char 的引用是一个很好的开始。

* * *

但是在做的时候涉及到的*黑魔法*`reinterpret_cast<const volatile char&>`呢？

为了*重新解释*从实现中返回的指针，`addressof`我们最终将要丢弃限定符，例如`const`and `volatile`（最终得到一个普通的引用`char`）。这两个可以很容易地添加`reinterpret_cast`，但要求它删除它们是非法的。

```
T1 const a; reinterpret_cast<T2&> (a);

/* error: reinterpret_cast from type ‘...’ to type ‘...’ casts away qualifiers */ 
```

^(这有点像*“比抱歉更安全”*的把戏。*“让我们添加它们，以防万一，我们稍后会删除它们。”*)

* * *

后来我们抛弃了限定符（*const*和*volatile*），`const_cast<char&>`最终得到一个对 的简单引用`char`，作为最后一步，这个结果变成了一个指向我们传递给实现的任何类型的指针。

这个阶段的一个相关问题是为什么我们没有跳过使用`reinterpret_cast`而直接进入`const_cast`? 这也有一个简单的答案：*`const_cast`可以添加/删除限定符，但不能更改基础类型。*

```
T1 a; const_cast<T2&> (a);

/* error: invalid const_cast from type ‘T1*’ to type ‘T2*’ */ 
```

* * *

^(*它可能不像馅饼那么容易，但是当你得到它时它的味道肯定很好......*)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-04-24T14:56:01.697

**简短版本：**

`operator&`不能为`char`. 因此，该类型被强制转换为`char`引用以获取保证为真实地址的内容。

`const_cast`由于 和 的限制，这种转换是在两次转换中完成的`reinterpret_cast`。

**更长的版本：**

它正在执行三个连续的演员表。

```
reinterpret_cast<const volatile char&> 
```

这实际上是强制转换为`char&`. `const`and`volatile`仅存在因为`_Tp`可能是`const`or , `volatile`and`reinterpret_cast`可以*添加*它们，但无法*删除*它们。

```
const_cast<char&> 
```

现在`const`and`volatile`已被删除。 `const_cast`可以这样做。

```
reinterpret_cast<_Tp*>(&result) 
```

现在获取地址并将类型转换回指向原始类型的指针。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-04-24T14:56:31.017

由内而外：

*   首先，它将`__r`type 强制转换为 a `const volatile char&`：它强制转换为 a`char&`只是因为它肯定没有重载的类型`operator&`来做一些时髦的事情。之所以`const volatile`存在，是因为这些是限制，可以添加但不能删除`reinterpret_cast`。`_Tp`可能已经是`const`和/或`volatile`，在这种情况下，这个演员阵容中需要一个或两个。如果没有，演员只是不必要地添加了它们，但它是为最严格的演员而写的。

*   接下来，要带走`const volatile`你需要一个`const_cast`，这会导致下一部分`const_cast<char&>`......

*   从那里他们只需获取地址并将其转换为您想要的类型，a `_Tp*`。请注意，`_Tp`可能是`const`和/或`volatile`，这意味着这些东西可以在此时添加回来。

# android - Toast 中的错误为 null

> ID：16195033
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:46:26.077
> 
> 标签：android, toast

我的代码是这样的

```
public Database(Context context) {
    super(context, dbname, null, dbversion);
    try{
      db=getWritableDatabase();
      // TODO Auto-generated constructor stub
      if (db.isOpen()){
        Toast.makeText(null, "Database is open", Toast.LENGTH_LONG).show();
      } else {      
        Toast.makeText(null, "Database is Closed", Toast.LENGTH_LONG).show();
      }
    } catch(Exception e) {
      Log.e(dbname, e.getMessage());        
    }
} 
```

我收到异常祝酒和日志猫节目

```
java.lang.RuntimeException: Unable to start activity
ComponentInfo{com.example.manager/com.example.manager.MainActivity}:
java.lang.NullPointerException: println needs a message 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:48:30.240

代替

```
Toast.makeText(null, "Database is open", Toast.LENGTH_LONG).show(); 
```

放 ：

```
Toast.makeText(context, "Database is open", Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:49:28.697

替换这个

```
 Toast.makeText(null, "Database is open", Toast.LENGTH_LONG).show(); 
```

对此

```
 Toast toast = Toast.makeText(context, "Database is open", Toast.LENGTH_LONG);
 toast.show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:59:50.807

@siva Toast.makeText 具有 Contex(android.content) 的第一个参数，它可以是您在应用程序中创建的上下文。有时getApplicationContext()，getBasecontext()也一般用，第二个参数是String，第三个参数是duration

[http://developer.android.com/guide/topics/ui/notifiers/toasts.html](http://developer.android.com/guide/topics/ui/notifiers/toasts.html)

ZouZou 发布的 stackoverflow.com/questions/3572463/what-is-context-in-android

# ruby-on-rails - 使用 devise gem rails 注销用户

> ID：16195036
> 
> 赞同：2
> 
> 时间：2013-04-24T14:46:36.067
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

在管理部分，我显示了当前登录用户的列表。现在管理员可以选择一个或多个用户/用户并销毁他们的会话（注销他们）。我不知道从哪里开始，请帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T14:56:30.263

您可以`sign_out`通过传入用户对象在控制器操作中使用该方法：

```
# Make sure only admins can do this
def sign_out_user
    @user = User.find(params[:id])    
    sign_out @user  
end 
```

更多信息在这里：

[http://rubydoc.info/github/plataformatec/devise/master/Devise/TestHelpers%3asign_out](http://rubydoc.info/github/plataformatec/devise/master/Devise/TestHelpers%3asign_out)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:57:07.733

考虑**用户**是您所需用户的集合，

```
for user in users
  sign_out user
end 
```

它应该可以解决您的问题。

希望能帮助到你 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-06T22:12:12.833

Devise提供的`sign_out`方法无济于事。我知道文档说它会注销您请求的“资源”，但是如果您自己深入研究宝石（设计和管理员），您会发现当您给它一个对象时，就像用户一样，它只会弄清楚什么对象所属的范围（即：user），并注销整个范围。

Devise 中的范围是登录的命名空间。您可能有一个需要登录的 Customer 模型，还有一个也需要登录的 Vendor 模型，并且您会为这些模型使用不同的范围。大多数应用程序只使用一个单一的范围，绑定到用户模型。

您可能正在使用`:cookie_store`您的会话存储，这是 Rails 的默认设置。在这种情况下，除了您自己之外，不可能注销任何单个用户。Devise 将您的登录信息存储在会话中，该会话存储在 cookie 中，而不是在您的数据库中。他们的浏览器具有凭据，因此您无法直接将其删除。

# c++ - 使用 MinGW 64 安装 boost - (Cygwin)

> ID：16195039
> 
> 赞同：2
> 
> 时间：2013-04-24T14:46:45.867
> 
> 标签：c++, cygwin, mingw-w64

我正在尝试安装 boost 库（1.53）以在 Windows 下的 64 位应用程序中使用它。但是，在尝试以与 MinGW32 和较旧的 bo​​ost 版本相同的方式进行设置时，我遇到了一系列错误...

现在，我在第一步一直失败 - 执行 ./bootstrap.sh。返回以下错误：

```
mkdir bootstrap
gcc -o bootstrap/jam0 command.c compile.c constants.c debug.c function.c glob.c hash.c hdrmacro.c headers.c jam.c jambase.c jamgram.c lists.c make.c make1.c object.c option.c output.c parse.c pathunix.c regexp.c rules.c scan.c search.c subst.c timestamp.c variable.c modules.c strings.c filesys.c builtins.c pwd.c class.c native.c md5.c w32_getreg.c modules/set.c modules/path.c modules/regex.c modules/property-set.c modules/sequence.c modules/order.c execunix.c fileunix.c
function.c: In function ÔÇścheck_alignmentÔÇÖ:
function.c:222:5: warning: cast from pointer to integer of different size
builtins.c:33:23: fatal error: sys/wait.h: No such file or directory
compilation terminated.
execunix.c:17:26: fatal error: sys/resource.h: No such file or directory
compilation terminated.
fileunix.c:98:17: fatal error: ar.h: No such file or directory
compilation terminated. 
```

当我改为运行 bootstrap.bat 时，Boost.Build 会自行构建，但是稍后我会遇到奇怪的错误。起初，我尝试将 x86_64-w64-mingw32-gcc 等可执行文件符号链接到 gcc，但最终出现许多“拒绝访问”错误，所以我只是将 x86_64-w64-mingw32-XX 文件复制粘贴到简单的 XX 中.exe 的。现在我可以开始正确的构建，但最终得到：

```
...failed gcc.archive bin.v2\libs\thread\build\gcc-mingw-4.5.3\debug\address-model-64\link-static\threading-multi\libboost_thread-mgw45-mt-d-1_53.a...
gcc.archive bin.v2\libs\thread\build\gcc-mingw-4.5.3\release\address-model-64\link-static\threading-multi\libboost_thread-mgw45-mt-1_53.a
System cannot find the path specified.
System cannot find the path specified. 
```

我发现它正在尝试使用类似 Win 的路径斜杠 (/vs\)，并且可能因此而失败。

我不想使用 MSVC，因为我试图让我的代码尽可能地可移植，而且它是 64 位的也很重要。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T15:30:57.123

这看起来像是 Cygwin 安装中缺少文件。尝试再次运行设置并确保为 gcc 编译器（Cygwin，而不是 MinGW64）安装了所有内容。我成功运行了 bootstrap.sh，bjam 使用默认的 Cygwin gcc 编译器编译得很好。之后，我遇到了一些减速带，但使用 MinGW64 编译一切正常。我在 tools\build\v2\user-config.jam 中添加了编译器可执行文件，如下所示：

```
using gcc : 4.5.3 : x86_64-w64-mingw32-gcc.exe ; 
```

我最终得到了以下命令行：

```
./b2 --toolset=gcc target-os=windows --build-dir=/cygdrive/c/whatever/boost_build variant=debug,release link=static runtime-link=static architecture=x86 address-model=64 threadapi=win32 --layout=tagged --without-mpi --stagedir=lib/win64gcc -j4 stage 
```

...然后我尝试了同样的`link=shared runtime-link=shared`方法，但是我有很多我还没有弄清楚的编译错误。

一些可能对您有所帮助的链接：

*   [交叉编译](http://www.boost.org/boost-build2/doc/html/bbv2/tasks/crosscompile.html)
*   [交叉编译提升](http://goodliffe.blogspot.ch/2008/05/cross-compiling-boost.html)
*   [使用 Cygwin/GCC 构建 Boost 库时的名称冲突](https://stackoverflow.com/questions/12160985/name-conflict-when-building-boost-libraries-with-cygwin-gcc)
*   [无法使用 MinGW 4.5.2 链接 Boost.Thread 1.46.1](https://stackoverflow.com/questions/5474475/cant-link-against-boost-thread-1-46-1-with-mingw-4-5-2)

编辑：我最终使用了 MinGW64 TDM，它比 Cygwin MinGW64 容易得多，因为它不是交叉编译器。只需安装 MinGW64 TDM，添加 MSYS，完成！Boost 编译没有任何问题。

# r - 在 r 中使用 read.table 时，r 会给出一些空白单元格的 NA 值，而将其他单元格留空。有什么问题吗？

> ID：16195040
> 
> 赞同：0
> 
> 时间：2013-04-24T14:46:47.923
> 
> 标签：r, read.table

我正在将 csv 文件读入 r（带有`blank.lines.skip=T`选项）。它有一些字符、数字和因子变量。当 r 读入文件时，一些单元格被赋予 NA，而另一些则留空。似乎只有包含所有数字数据的列被赋予 NA 而包含其他类型数据的列被留空。我的数据集太大，无法手动检查所有这些。我的数据中有很多列和行，并且不确定为什么某些单元格获得 NA 而其他单元格没有，除非它是设计使然。任何建议表示赞赏。干杯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T14:51:50.307

当期望单元格中有一个数字但没有找到它时`read`，将为该单元格分配一个适合的类型`NA`。如果改为期待字符串（或因子），则空单元格是有效条目，因此没有 NA。

所以`NA`'s 只会在数字类列中，而不是在字符或因子类列中。

# node.js - 节点电子邮件模板 - 了解文件结构

> ID：16195049
> 
> 赞同：2
> 
> 时间：2013-04-24T14:47:21.917
> 
> 标签：node.js, directory

我把我的目录和路径弄得乱七八糟，以至于我刚刚从 github 发布了原件

```
 var path           = require('path')
     , templatesDir   = path.resolve(__dirname, '..', 'templates')
     , emailTemplates = require('../../')
     , nodemailer     = require('nodemailer'); 
```

如果这是我寻找他们的地方。有人可以解释我保存电子邮件模板的位置吗？我正在使用基本的 express 文件结构，所以在我的应用程序文件中我有 app.js，其中包含此代码。感谢任何知道的人。我已经没有东西可以尝试了。

# javascript - 在没有流星启动的情况下使集合在客户端上可用

> ID：16195052
> 
> 赞同：4
> 
> 时间：2013-04-24T14:47:27.307
> 
> 标签：javascript, meteor

当我在服务器上定义我的流星集合并尝试在客户端访问它们而不是在任何流星提供的方法中时，`rendered, events, created, helpers ...`我总是收到一个错误，`Meteor collection not defined`如果我尝试在客户端中重新定义方法，我会得到`Meteor collection already exists`. 我可以通过在`Meteor.startup()`函数中引用我的定制集合来解决这个问题。我如何引用我在客户端的服务器上定义的集合。在流星文档中`Meteor.Collection()`，甚至可以在声明之前创建两个实例并进行订阅。

```
// okay to subscribe (and possibly receive data) before declaring
// the client collection that will hold it.  assume "allplayers"
// publishes data from **server's "players" collection.**
Meteor.subscribe("allplayers");
...
// client queues incoming players records until ...
...
Players = new Meteor.Collection("players"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T16:14:45.577

您可以将其放置`Players = new Meteor.Collection("players");`在文件的顶部，而无需将其放在`Meteor.startup`. 在启动之前确保它已定义`Meteor.subscribe`

例如，您的文件可能是：

```
Players = new Meteor.Collection("players");
MyCollection2 = new Meteor.Collection("MyCollection2");

Meteor.subscribe("allplayers");
Meteor.subscribe("mycollection2");

..rest of stuff 
```

更简洁的方法可能是在项目的根目录中创建一个包含此文件的文件，以便在客户端和服务器上都使用它，而无需为每个文件重新定义它们，例如`collection.js`项目根目录中的 a 可能包含

```
Players = new Meteor.Collection("players");
MyCollection2 = new Meteor.Collection("MyCollection2");

if(Meteor.isClient) {
    Meteor.subscribe("allplayers");
    Meteor.subscribe("mycollection2");   
} 
```

所以现在你不必在你的 or 上定义 or`Players`了。流星加载文件的方式将确保在您的其他常规文件之前定义它。如果您按照其他流星示例（派对和待办事项）中使用的,和格式排列文件，这可能效果最好`MyCollection2``/server``/client``/client``/server``/public`

编辑：正如 BenjaminRH 建议的那样，将您的文件放入`/lib/collections.js`确保它甚至会在您的根项目目录中的其他文件之前加载。

# java - 将文本放入 Primefaces 扩展时间轴的事件中

> ID：16195055
> 
> 赞同：3
> 
> 时间：2013-04-24T14:47:47.330
> 
> 标签：java, html, jsf, primefaces, primefaces-extensions

问题是，我想将文本放入时间线的框事件中。我该如何设置？

```
<p:layoutUnit id="center" position="center">
    <pe:timeline id="timeline" value="#{pageController.tt.timelines}" eventStyle="box"
                         height="600px" width="100%" axisPosition="top"  widgetVar="timelineWidget">                            
    <p:ajax listener="#{pageController.tt.onEventSelect}"  event="eventSelect" 
                        update="mainpanel, locations, rooms, timeFrom, timeTo, colorpicker"/>
    </pe:timeline>
</p:layoutUnit> 
```

如何实现根据文本量减小文本字体大小或自动完成换行符的行为？

# python - 使用 Python 写入文本文件时的编码问题

> ID：16195063
> 
> 赞同：3
> 
> 时间：2013-04-24T14:47:59.113
> 
> 标签：python, encoding

我正在编写一个程序来“手动”将 csv 文件排列为正确的 JSON 语法，使用一个简短的 Python 脚本。从我用来`readlines()`将文件格式化为行列表的输入文件中，我对其进行操作并将其合并为单个字符串，然后将其输出到单独的 .txt 文件中。但是，输出包含乱码，而不是输入文件中存在的希伯来语字符，并且输出是水平双倍行距的（在每个字符之间添加一个空白字符）。据我所知，问题与编码有关，但我无法弄清楚是什么。当我检测到输入和输出文件的编码（使用`.encoding`属性）时，它们都返回`None`，这意味着它们使用系统默认值。技术细节：Python 2.7、Windows 7。

虽然关于这个主题有很多问题，但我没有找到我的问题的直接答案。在这种情况下，检测系统默认值对我没有帮助，因为我需要程序是可移植的。

这是代码：

```
def txt_to_JSON(csv_list):
    ...some manipulation of the list...
    return JSON_string
file_name = "input_file.txt"
my_file = open(file_name)
# make each line of input file a value in a list
lines = my_file.readlines()
# break up each line into a list such that each 'column' is a value in that list 
for i in range(0,len(lines)):
    lines[i] = lines[i].split("\t")
J_string = txt_to_JSON(lines)
json_file = open("output_file.txt", "w+")
json_file.write(jstring)
json_file.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T18:34:55.040

所有数据都需要编码才能存储在磁盘上。如果你不知道编码，你能做的最好的就是猜测。有一个图书馆：[https ://pypi.python.org/pypi/chardet](https://pypi.python.org/pypi/chardet)

我强烈推荐 Ned Batchelder 的演讲 [http://nedbatchelder.com/text/unipain.html](http://nedbatchelder.com/text/unipain.html) 了解详情。

有一个关于在 Windows 上使用“unicode”作为编码的解释：[Unicode 和 UTF-8 有什么区别？](https://stackoverflow.com/questions/3951722/whats-the-difference-between-unicode-and-utf8)

TLDR：Microsoft 使用 UTF16 作为 unicode 字符串的编码，但决定将其称为“unicode”，因为他们也在内部使用它。

即使 Python2 在字符串/unicode 转换方面有点宽松，您也应该习惯于始终在输入上解码并在输出上编码。

在你的情况下

```
filename = 'where your data lives'
with open(filename, 'rb') as f:
   encoded_data = f.read()
decoded_data = encoded_data.decode("UTF16")

# do stuff, resulting in result (all on unicode strings)
result = text_to_json(decoded_data)

encoded_result = result.encode("UTF-16")  #really, just using UTF8 for everything makes things a lot easier
outfile = 'where your data goes'
with open(outfile, 'wb') as f:
    f.write(encoded_result) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:18:07.553

您需要告诉 Python 使用 Unicode 字符编码来解码希伯来字符。以下是如何在 Python 中读取 Unicode 字符的链接：[Character reading from file in Python](https://stackoverflow.com/questions/147741/character-reading-from-file-in-python)

# php - 如何将 FQL 的值存储在变量中

> ID：16195065
> 
> 赞同：0
> 
> 时间：2013-04-24T14:48:03.643
> 
> 标签：php, facebook-fql

我试图从用户那里提取用户信息。我能够使用 fql 得到它。但主要问题是我无法将特定数据（例如名称）存储在单独的变量中，我想在网页的文本框中显示该值。任何人都可以告诉我有什么问题吗？

```
<?php
$app_id = '237773783026***';
$app_secret = '90a6514ebed8***f47a3d9a695608315';
$my_url = 'http://apps.facebook.com/anubhawfirst';

$code = $_REQUEST["code"];

// auth user
if(empty($code)) {
$dialog_url = 'https://www.facebook.com/dialog/oauth?client_id=' 
$app_id . '&redirect_uri=' . urlencode($my_url) ;
echo("<script>top.location.href='" . $dialog_url . "'</script>");
}

// get user access_token
$token_url = 'https://graph.facebook.com/oauth/access_token?client_id='
$app_id . '&redirect_uri=' . urlencode($my_url) 
. '&client_secret=' . $app_secret 
. '&code=' . $code;

// response is of the format "access_token=AAAC..."
$access_token = substr(file_get_contents($token_url), 13);

// run fql query
$fql_query_url = 'https://graph.facebook.com/'
. 'fql?q=SELECT+name+,+uid+FROM+user+WHERE+uid=me()'
. '&access_token=' . $access_token;
$fql_query_result = file_get_contents($fql_query_url);
$fql_query_obj = array(json_decode($fql_query_result, true));

//this is the part where am trying to extract using array.
foreach ($fql_query_obj as $item)
{ 

print $fql_query_obj[0];
;
}

// display results of fql query

echo '<pre>';
print_r("query results:");
print_r($fql_query_obj);
echo '</pre>';

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:06:21.143

您有一个包含查询结果的多维数组。uid 和 name 列中的值有四级深。像这样访问它们：

```
$uid = $fql_query_obj[0]['data'][0]['uid'];
$name = $fql_query_obj[0]['data'][0]['name']; 
```

# ruby-on-rails - 在 Torquebox 下为 Rails 应用程序配置 Apache

> ID：16195066
> 
> 赞同：0
> 
> 时间：2013-04-24T14:48:09.420
> 
> 标签：ruby-on-rails, apache, jboss, torquebox

我无法让 Apache 和 Torquebox/JBoss 一起工作。

版本：

*   阿帕奇 2.2.15
*   扭矩箱 2.3.0
*   导轨 2.3.18 和 3.2.13

所有应用程序都直接通过 Torquebox 部署并正常工作。我在 Torquebox 中使用默认端口的 100 端口偏移，这意味着应用程序在 myserver:8180/my-app 上可用。

这是我的默认站点的配置：

```
<VirtualHost *:80>
  ServerAdmin myemail@my.domain

  DocumentRoot /var/www/html
  <Directory />
    Options FollowSymLinks
    AllowOverride None
  </Directory>
  <Directory /var/www/html/>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride All
    Order allow,deny
    allow from all
  </Directory>

  ErrorLog /var/log/httpd/error.log

  # Possible values include: debug, info, notice, warn, error, crit,
  # alert, emerg.
  LogLevel warn

  CustomLog /var/log/httpd/access.log combined
  ServerSignature On
</VirtualHost> 
```

每个应用程序都有自己的 Apache 配置文件，其中包含如下行：

```
ProxyPass /my-app ajp://localhost:8109/my-app 
```

但是，当我尝试访问应用程序时，我收到一条 Forbidden (403) 错误消息：

```
You don't have permission to access /my-app/ on this server. 
```

Apache 在其 error.log 中为每个失败的请求生成以下内容：

```
[Wed Apr 24 07:37:03 2013] [error] [client #{ip address}] client denied by server configuration: proxy:ajp://localhost:8109/my-app/ 
```

Torquebox 日志没有相应的条目，所以我相信请求永远不会发送到 Torquebox。

我通过管理控制台验证了 Torquebox/JBoss 确实启用了 AJP。我还检查了系统上的文件权限 - Apache 用户对其所有配置文件和所有应用程序文件夹具有读取权限。据我所知，Apache 配置本身与另一台服务器上的正常工作相匹配。

有什么我想念的想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T19:15:08.367

代理配置不正确。添加这个 .conf 文件解决了这个问题：

```
<IfModule mod_proxy.c>

  ProxyRequests Off

  <Proxy *>
    AddDefaultCharset off
    Order allow,deny
    Allow from all
  </Proxy>

  ProxyVia On

  ProxyPreserveHost On

</IfModule> 
```

# jquery - 循环和淡出的jQuery问题

> ID：16195069
> 
> 赞同：1
> 
> 时间：2013-04-24T14:48:15.640
> 
> 标签：jquery, fadeout, jquery-cycle

好的，所以我遇到了一些问题。我有一个调整大小以适应浏览器窗口大小的 div，并且在该 div 中我使用循环插件来淡入一些文本。这一切都有效，但我想要发生的是，一旦循环插件完成，我想让输入包装器`div (#bigshot)`淡出，然后让另一个 div 从底部向上滑动。不管出于什么原因，我什么都做不了。我试过设置超时功能，我试过使用延迟功能，工作正常。我完全不知所措。下面的代码是我目前拥有的。

```
 $(document).ready(function() {
    $('#bigshot').cycle({ 
            fx:      'fade', 
            speed:    1000, 
            timeout:  1500,
            nowrap: 1 
    });
});

function theheight() {
    var height = $(window).height();
    $("#bigshot").css('height', height);
}

$(document).ready(function() {
    theheight();
    $(window).bind('resize', height); 
}); 
```

所以本质上，一旦完成（这应该需要 7500 毫秒），我会淡出`div (#bigshot)`然后从屏幕底部向上滑动一个新的`div`名为`#main-content`.

就像我说的，我已经尝试了我能想到的一切，但无法让它发挥作用。我的猜测是上面的代码需要以某种方式进行更改，以使一切正常工作，但我不是 jQuery 策划者。我知道足以完成工作，但在一天结束时，我通常最终需要帮助，所以我在这里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-20T00:53:25.663

**你试过了`end`吗？**

```
$('#bigshot').cycle({ 
  fx:      'fade', 
  speed:    1000, 
  timeout:  1500,
  nowrap:   1,
  end:      function() {
    //animations here, something like... 
    $('#bigshot').fadeOut('fast');
    $('#main-content').css({top: '100%'}).animate({top: '0'},'fast');  
  }
}); 
```

`end` [您可以在此处](http://jquery.malsup.com/cycle/end.html)查看使用演示，并在[此处](http://jquery.malsup.com/cycle/options.html)阅读有关 api 的更多信息。

# c# - 为什么 this.close() 关闭应用程序

> ID：16195070
> 
> 赞同：2
> 
> 时间：2013-04-24T14:48:19.080
> 
> 标签：c#, .net, wpf, winforms

我在 wpf 中有一个窗口，我想在退出按钮上关闭窗口。所以我在 PreviewKeyDown 事件上写了这段代码，但它关闭了整个应用程序，包括主窗口和当前窗口。我只想关闭当前窗口。

```
 //this code for open second window
 private void M_Mahale_Click(object sender, RoutedEventArgs e)
    {
        Tanzimat.MahaleWin Mahale = new Tanzimat.MahaleWin();
        Mahale.ShowDialog();
    }
  //this code for PreviewKeyDown event on second window and current window
 private void Window_PreviewKeyDown(object sender, KeyEventArgs e)
    {
        if (e.Key == Key.Escape)
        {
            this.Close();
        }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T14:54:04.010

好的，根据此评论`//this code for PreviewKeyDown event on second window and current window`，您在两个窗口中都有相同的代码 - 所以在`PreviewKeyDown`两个窗口中将代码更改为：

```
private void Window_PreviewKeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Escape)
    {
        e.Handled = true;
        this.Close();
    }
} 
```

这将阻止其他窗口在已经处理事件时获得该事件。看，发生的事情是当按下转义键时，两个窗口都收到了消息，而你没有告诉主窗口（即当前窗口后面的那个）**不要处理它。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:33:36.143

您的窗口有一个名称`Mahale`和/或从主窗口关闭它的命令，您应该调用：

```
 Mahale.Close(); 
```

如果您`this.Close();`以 main 形式调用程序退出是很自然的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:50:08.897

您可以使用 this.Hide() 隐藏该窗口，但该窗口仍然存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:29:17.970

我认为实现目标的最佳方法是使用 Button 的 IsCancel 属性。

> 您可以将 Cancel 按钮上的 IsCancel 属性设置为 true，从而使 Cancel 按钮自动关闭对话框而不处理 Click 事件。

有关示例，请参见[此处](http://wpf.2000things.com/tag/iscancel/)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-24T14:50:22.937

做 ：

```
private void Window_PreviewKeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Escape)
    {
        this.Hide();
    }
} 
```

反而。

Close() 关闭每一帧。使用隐藏（）。

# xml - 匹配日期的正则表达式

> ID：16195085
> 
> 赞同：0
> 
> 时间：2013-04-24T14:48:41.263
> 
> 标签：xml, regex

如何使用这段 xml 中的正则表达式找到有效的开始日期和结束日期？

```
<Response>
  <Identification v="XXXXX"/>
  <Type v="YYY"/>
  <CreationDateTime v="2013-01-18T10:00:00Z"/>
  <ValidityPeriod v="2013-01-21T05:00Z/2013-01-22T05:00Z"/>
 <The rest of the file i'm not iterested in..../> 
```

到目前为止，我找到了 **[1-9][0-9]{3}-.+?T.+?Z/.+?Z** 来查找属性的值并将字符串拆分为两个日期字符串。或者使用**[1-9][0-9]{3}-.+?T[^.]+?(Z|[+-].+)**并找到三个日期，只使用最后两个

但是我如何找到两个不同日期的确切两个匹配项。

我必须从存档中提取一些 xml 文件（包含大量大型 XML 文件），并且出于性能原因，我无法反序列化所有文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:55:00.887

使用[JDOM](http://www.jdom.org/)或其他 XML 解析语言而不是正则表达式。它将简化解析此文本。或者，您知道该元素名为“CreationDateTime”，您知道该属性名为“v”，并且您知道该值包含在双引号中。您可以利用所有这些信息来利用字符串拆分对其进行解析，从而更轻松地获取您感兴趣的行和值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:02:44.517

尝试：

```
my $d = qr([1-9][0-9]{3}-.+?T.+?Z);
my ($d1, $d2) = ($xml =~ /ValidityPeriod v=\"($d)\/($d)\"/);
print "$d1 $d2\n" if $d1; 
```

$d 正则表达式可以任意复杂。“。*”就足够了:-)

# sql-server - 哈希和比较密码，在sql server中使用SHA1保存为哈希

> ID：16195087
> 
> 赞同：1
> 
> 时间：2013-04-24T14:48:45.920
> 
> 标签：sql-server, stored-procedures

我有一列 varbinary(max) 类型的列，并使用了随机生成的 nvarchar(60) 类型的盐。我将盐保存在数据库中并使用哈希字节（密码+盐）保存了密码。

现在我想比较用户密码并对他进行身份验证。

我尝试获取他的密码并运行此查询——

```
SELECT [email] from admin where 
[password]=HashBytes('SHA1','xxxxxx' +'/KsDnXdU+_a<t19wYCnEi/lxmXmAutR3DVA$#]~dSBskRMB?sb#41+=MFRpE') 
```

它没有给我回电子邮件。我直接在sql server management studio上运行。但它给了我空白。为什么会这样？

当我通过电子邮件选择我正在获得角色时，这意味着电子邮件已注册。我的盐或查询有问题吗？

我修好了它。实际上直接添加盐给我带来了一个错误，尽管它是直接添加的并且计算了哈希并且没有从 sql server 返回错误。

当我运行此查询时

```
Select role from admin where salt='/KsDnXdU+_a<t19wYCnEi/lxmXmAutR3DVA$#]~dSBskRMB?sb#41+=MFRpE' 
```

我没有结果。我意识到，这是一些转换问题。我当时用`Convert(nvarchar(60),'%?r>%Vb+$hUZO8}=38/_J[@q@1mf^rz!V&q~\dLH5nQ&/edR\c[6ya|q$e%r')`

并将我的查询作为

```
SELECT [email] from admin where 
[password]=HashBytes('SHA1', 'xxxxxx'+Convert(nvarchar(60),'%?r>%Vb+$hUZO8}=38/_J[@q@1mf^rz!V&q~\dLH5nQ&/edR\c[6ya|q$e%r')) 
```

这给我回了电子邮件。我真的不确定为什么会发生这种情况，但是使用 sqlserver 2005 和上面的查询我修复了它。我请求版主，如果它是 sql server 2005 中的任何错误，请让其他人知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:11:21.240

阅读和写作时需要使用相同的代码：

```
INSERT INTO dbo.admin (email, password, salt)
VALUES(@email,HashBytes('SHA2_512',@password+@salt),@salt); 
```

和

```
SELECT email FROM dbo.admin
 WHERE password = HashBytes('SHA2_512',@password+salt); 
```

唯一的区别是选择引用存储的盐而不是传入的盐。您还应该使用 SHA2 算法，因为 SHA1 不再安全（[http://www.md5decrypter.co.uk/sha1-decrypt.aspx](http://www.md5decrypter.co.uk/sha1-decrypt.aspx)）。对于 SHA2_512，您的列需要为 64 个字节（[http://msdn.microsoft.com/en-us/library/ms174415.aspx](http://msdn.microsoft.com/en-us/library/ms174415.aspx)）。如果可能，您应该使用特定长度而不是 (MAX)。

正如 Aaron 指出的，在 SQL 2012 之前不支持 SHA2。您可以改用 CLR 实现。这可以帮助您入门： http: [//geekswithblogs.net/hroggero/archive/2009/09/19/strong-password-hashing-with-sql-server.aspx](http://geekswithblogs.net/hroggero/archive/2009/09/19/strong-password-hashing-with-sql-server.aspx)但是，它仅使用 256 位。

# r - 将来自不同级别的最大值添加到 data.frame 中的新列

> ID：16195091
> 
> 赞同：2
> 
> 时间：2013-04-24T14:48:59.347
> 
> 标签：r, matrix, dataframe, apply

我有以下 R 问题。我做了一个实验，观察了一些汽车的速度。我有一张桌子，上面有汽车（其中数字 1 表示例如保时捷、2 沃尔沃等）和它们的速度。一辆车可以被带入观察不止一次。因此，例如，Porche 被观察树次，Volvo 被观察两次。

`exp<-data.frame(car=c(1,1,1,2,2,3),speed=c(10,20,30,40,50,60))`

我想添加第三列，其中计算每一行/每辆车的最大速度。所以它看起来像这样：

`exp<-data.frame(car=c(1,1,1,2,2,3),speed=c(10,20,30,40,50,60), maxSpeed=c(30,30,30,50,50,60))`

Porsche 观察到的最大速度为 30，因此保时捷的每一行都会得到 maxSpeed = 30。

我知道它应该是应用/应用功能，但不知道如何实现它。任何人？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T17:03:04.317

@Arun 这是我在更大样本（1000 条记录）中的结果。中位数的比率现在（实际上）是 0.82：

```
exp <- data.frame(car=sample(1:10, 1000, T),speed=rnorm(1000, 20, 5))

f1 <- function() mutate(exp, maxSpeed = ave(speed, car, FUN=max))
f2 <- function() transform(exp, maxSpeed = ave(speed, car, FUN=max))

library(microbenchmark)
library(plyr)
> microbenchmark(f1(), f2(), times=1000)
Unit: microseconds
 expr     min      lq  median       uq      max neval
 f1() 551.321 565.112 570.565 589.9680 27866.23  1000
 f2() 662.933 683.138 689.552 713.7665 28510.24  1000 
```

`plyr`文档本身说`Mutate seems to be considerably faster than transform for large data frames.`

但是，对于这种情况，您可能是对的。如果我放大样本：

```
> exp <- data.frame(car=sample(1:1000, 100000, T),speed=rnorm(100000, 20, 5))
> microbenchmark(f1(), f2(), times=100)
Unit: milliseconds
 expr      min       lq   median       uq      max neval
 f1() 37.92438 39.00056 40.66607 41.18115 77.41645   100
 f2() 39.47731 40.28650 43.11927 43.70779 78.34878   100 
```

比率接近一。老实说，我对`plyr`性能非常确定（在我的代码中总是依赖它），这就是我在评论中“声明”的原因。可能在不同的情况下它表现更好..

编辑：

使用`f3()`来自@Arun 评论

```
> microbenchmark(f1(), f2(), f3(), times=100)
Unit: milliseconds
 expr      min       lq   median       uq      max neval
 f1() 38.76050 39.57129 41.48728 42.14812 76.94338   100
 f2() 40.38913 41.19767 44.12329 44.78782 79.94021   100
 f3() 38.63606 39.58700 40.24272 42.04902 76.07551   100 
```

是的！稍微快一点...移动更少的数据？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T17:15:41.913

非常直截了当`data.table`

```
library(data.table)

exp <- data.table(exp)
exp[, maxSpeed := max(speed), by=car] 
```

这使：

```
exp
   car speed maxSpeed
1:   1    10       30
2:   1    20       30
3:   1    30       30
4:   2    40       50
5:   2    50       50
6:   3    60       60 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T14:51:05.487

```
transform(exp, maxSpeed = ave(speed, car, FUN=max)) 
```

* * *

另一种使用方式`split`：

```
exp$maxSpeed <- exp$speed
split(exp$maxSpeed, exp$car) <- lapply(split(exp$maxSpeed, exp$car), max)
exp 
```

# java - 优化冒泡排序

> ID：16195092
> 
> 赞同：16
> 
> 时间：2013-04-24T14:48:59.783
> 
> 标签：java, optimization, recursion, bubble-sort

我想知道我还能如何优化冒泡排序，以便它忽略已经排序的元素，即使在第一遍之后也是如此。

```
Eg. [4, 2, 3, 1, 5, 6] --> [2, 3, 1, **4, 5, 6**] 
```

我们观察到`[4,5,6]`已经排序，我该如何修改我的代码以便它在下一次传递中忽略这 3 个元素？这意味着排序会更有效？您建议使用递归方法吗？

```
public static void bubbleSort(int[] a) {
    for (int i = 1; i < a.length; i++) {
        boolean is_sorted = true;
        for (int j = 0; j < a.length; j++) {
            if (a[j] > a[j + 1]) {
                int temp = a[j];
                a[j] = a[j + 1];
                a[j + 1] = temp;
                is_sorted = false;
            }
        }
        if (is_sorted) return;
    }
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-24T15:31:25.307

首先，您有一个越界访问：

```
for (int j = 0; j < a.length; j++) {
    if (a[j] > a[j + 1]) { 
```

for `j == a.length-1`，所以循环条件应该是`j < a.length-1`。

但是，在冒泡排序中，你知道在遍历之后`k`，最大的`k`元素被排序到`k`数组的最后一个条目，所以传统的冒泡排序使用

```
public static void bubbleSort(int[] a) {
    for (int i = 1; i < a.length; i++) {
        boolean is_sorted = true;
        // skip the already sorted largest elements
        for (int j = 0; j < a.length - i; j++) {
            if (a[j] > a[j + 1]) {
                int temp = a[j];
                a[j] = a[j + 1];
                a[j + 1] = temp;
                is_sorted = false;
            }
        }
        if (is_sorted) return;
    }
} 
```

现在，当数组有一个最大元素的长尾排序时，这仍然会做很多不必要的迭代，比如你有`k,k-1,...,1`第一个`k`元素，然后`k+1`按`100000000`顺序排列。标准冒泡排序将`k`通过（几乎）整个数组传递时间。

但是如果你记得你上次交换的位置，你就会知道在那个索引之后，有顺序最大的元素，所以

```
public static void bubbleSort(int[] a) {
    int lastSwap = a.length - 1;
    for (int i = 1; i < a.length; i++) {
        boolean is_sorted = true;
        int currentSwap = -1;
        for (int j = 0; j < lastSwap; j++) {
            if (a[j] > a[j + 1]) {
                int temp = a[j];
                a[j] = a[j + 1];
                a[j + 1] = temp;
                is_sorted = false;
                currentSwap = j;
            }
        }
        if (is_sorted) return;
        lastSwap = currentSwap;
    }
} 
```

将对上面的示例进行排序，其中只有一次通过整个数组，其余的仅通过（短）前缀。

当然，一般来说，这不会给你带来太多好处，但是优化冒泡排序无论如何都是徒劳的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-19T14:19:02.563

您应该为内部循环使用变量“大小”并将其更改为每个循环中最新的交换元素。这样，您的内部循环将上升到最新的“交换”元素并传递其余未交换的元素（也就是在它们的正确位置）。IE

```
do {
    int newsize = 0;
    for (int i = 1; i < size; i++) {
        if (a[i - 1] > a[i]) {
            int temp;
            temp = a[i - 1];
            a[i - 1] = a[i];
            a[i] = temp;
            newsize = i;
        }
    }
    size = newsize;
} while (size > 0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-11T04:04:30.973

```
public static Integer[] optimizedBubbleSort(Integer[] input) {
    long startTime = System.nanoTime();
    boolean swapped = true;
    for (int pass = input.length - 1; pass >= 0 && swapped; pass--) {
        swapped = false;
        for (int i = 0; i < pass; i++) {
            if (input[i] > input[i + 1]) {
                int temp = input[i];
                input[i] = input[i + 1];
                input[i + 1] = temp;
                swapped = true;
            }
        }
    }
    System.out.println("Time taken for OPTIMIZED bubbleSort: "
            + (System.nanoTime() - startTime));
    return input;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-01T05:10:35.847

```
public static void BubbleSorter(params int[] input) {
    int newSize = input.Length - 1, size = 0;
    bool swap;
    do {
        swap = false;
        for (int j = 0; j < newSize; j++) {
            if (input[j] > input[j + 1]) {
                int temp = input[j + 1];
                input[j + 1] = input[j];
                input[j] = temp;
                swap = true;
                size = j;
            }
        }
        newSize = size;
    } while (swap);
    DisplayArrayElements(input);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-27T10:40:00.500

我设计了一种方法，通过排除在先前循环中已排序的数组开头和结尾的部分来减少迭代次数。

```
static int[] bubbleSortOptimized(int arr[]) {
    int start = 0, stop = arr.length - 1, control = 0;
    boolean ordered, nsCaught;
    while (true) {
        ordered = true;
        nsCaught = false;
        for (int i = start; i < stop; i++) {
            if (i > 1) {
                if (!nsCaught && arr[i - 2] > arr[i - 1]) {
                    ordered = false;
                    start = i - 2;
                    nsCaught = true;
                }
            }
            if (arr[i] > arr[i + 1]) {
                int hold = arr[i];
                arr[i] = arr[i + 1];
                arr[i + 1] = hold;
                control = i;
            }
        }
        System.out.println(Arrays.toString(arr));
        if (ordered) return arr;
        stop = control;
    }
} 
```

但正如[@Daniel Fischer](https://stackoverflow.com/a/16196115/3577705)在之前的回答中所说，[它对较大的数组没有多大作用](https://www.hackerrank.com/challenges/ctci-merge-sort/problem)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-20T18:35:33.453

在上面的示例中，数组在第 3 遍后排序，但我们仍将继续第 4、第 5 遍。假设如果数组已经排序，那么就不会发生交换（因为相邻的元素总是按顺序排列的），但我们仍然会继续遍历，仍然会有 (n-1) 次遍历。

如果我们可以确定数组已排序，那么我们应该停止执行进一步的遍历。这是对原始冒泡排序算法的优化。

如果在特定传递中没有交换，则意味着数组已排序，因此我们不应该执行进一步的传递。为此，我们可以有一个标志变量，在每次传递之前设置为真，并在执行交换时设置为假。

```
void bubbleSort(int *arr, int n) {
    for (int i = 0; i < n; i++) {
        bool flag = false;
        for (int j = 0; j < n - i - 1; j++) {
            if (array[j] > array[j + 1]) {
                flag = true;
                int temp = array[j + 1];
                array[j + 1] = array[j];
                array[j] = temp;
            }
        }
        // No Swapping happened, array is sorted
        if (!flag) {
            return;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-26T07:24:32.683

```
public class Tester {
    static boolean bubbleFlag = true;

    public static void main(String[] args) {
        int array[] = new int[]{1, 9, 2, 3, 4, 5, 6};
        bubbleSort(array);
    }

    private static void bubbleSort(int... array) {
        System.out.println("Before Sorting: " + Arrays.toString(array));

        for (int i = 0; i < array.length - 1; i++) {
            if (i > 0) if (bubbleFlag) break;

            for (int j = 0; j < array.length - i - 1; j++) {
                if (array[j] > array[j + 1]) array = swap(j, j + 1, array);
                System.out.println("Iteration "+j+" :"+Arrays.toString(array));
            }
            bubbleFlag = true;
        }
    }

    private static int[] swap(int i1, int i2, int... is) {
        bubbleFlag = false;
        is[i1] = is[i1] + is[i2];
        is[i2] = is[i1] - is[i2];
        is[i1] = is[i1] - is[i2];
        return is;
    }
} 
```

输出：

```
Before Sorting: [1, 9, 2, 3, 4, 5, 6]
Iteration 0 :[1, 9, 2, 3, 4, 5, 6]
Iteration 1 :[1, 2, 9, 3, 4, 5, 6]
Iteration 2 :[1, 2, 3, 9, 4, 5, 6]
Iteration 3 :[1, 2, 3, 4, 9, 5, 6]
Iteration 4 :[1, 2, 3, 4, 5, 9, 6]
Iteration 5 :[1, 2, 3, 4, 5, 6, 9] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-06-30T19:59:15.377

我认为这就是你所需要的。关键是只考虑数组，直到最后一次交换发生的索引（新）。

```
public static void bubbleSort(int[] a) {
    int i, n, newn;
    n = a.length;
    while (n > 0) {
        newn = 0;
        for (i = 1; i < n; i++) {
            if (a[i - 1] > a[i]) {
                temp = a[i];
                a[i] = a[i - 1];
                a[i - 1] = temp;
                newn = i;
            }
        }
        n = newn;
    }
    return a;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-07-23T10:58:56.720

这是使用 while 循环的最简单、最佳和最优的冒泡排序算法。它按升序从左到右对给定数组形式中的数字进行排序。它非常易于理解且易于实施。

```
private static int[] bubbleSort(int[] array) {
    int length = array.length - 1;
    int index = 0;

    while (index < length) {
        if (array[index] > array[index + 1]) {
            swap(array, index, index + 1);
        }
        index++;

        if (index == length) {
            index = 0;
            length--;
        }
    }
    return array;
}

private static void swap(int[] array, int index1, int index2) {
    int temp = array[index1];
    array[index1] = array[index2];
    array[index2] = temp;
} 
```

```
public static void main(String[] args) {
    int[] arr = {4, 2, 3, 1, 5, 6};
    System.out.println(Arrays.toString(arr));
    bubbleSort(arr);
    System.out.println(Arrays.toString(arr));
} 
```

输出：

```
[4, 2, 3, 1, 5, 6]
[1, 2, 3, 4, 5, 6] 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-06T16:08:23.373

您可以使用单个*do-while-loop*而不是两个嵌套*的 for-loop*并将逻辑移动到内部*if-statement 中*。通过通过索引，后续通过更短。

```
public static void bubbleSort(int[] arr) {
    boolean swapped = false;
    int i = 0, pass = 0;
    do {
        if (i < arr.length - 1 - pass) {
            if (arr[i] > arr[i + 1]) {
                int temp = arr[i];
                arr[i] = arr[i + 1];
                arr[i + 1] = temp;
                swapped = true;
            }
            i++;
        } else {
            i = 0;
            pass++;
            swapped = false;
        }
    } while (i < arr.length - 1 - pass || swapped);
} 
```

```
public static void main(String[] args) {
    int[] arr = {6, 1, 5, 8, 4, 3, 9, 2, 0, 7};
    System.out.println(Arrays.toString(arr));
    bubbleSort(arr);
    System.out.println(Arrays.toString(arr));
} 
```

输出：

```
[6, 1, 5, 8, 4, 3, 9, 2, 0, 7]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

* * *

^(另请参阅：[冒泡排序输出不正确](https://stackoverflow.com/a/66970037/15553668))

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-06T20:02:00.453

我没有代码，但您可以使用 n 位来跟踪在最后一次传递中执行交换的位置。或者，效率较低，使用单个变量来跟踪执行第一次交换的位置。我们不需要重新比较未交换的元素——它们是相同顺序的相同元素，所以我们知道比较将是相同的，我们可以安全地跳过它们。

直觉上我觉得，即使进行了上述优化，冒泡排序仍然无法击败二进制插入排序的比较，并且会引入更多的分支逻辑（在辅助空间之上）来跟踪交换。所以这可能不值得研究，除非有人好奇。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-08-17T15:01:37.937

优化的冒泡排序，只有 1 个 for 循环

```
/*Advanced BUBBLE SORT with ONE PASS*/
/*Authored by :: Brooks Tare  AAU*/
public class Bubble {
    public int[] bubble(int b[]) {
        int temp, temp1;
        for (int i = 0; i < b.length - 1; i++) {
            if (b[i] > b[i + 1]) {
                ///swap(b[i],b[i+1]);
                temp = b[i];
                b[i] = b[i + 1];
                b[i + 1] = temp;

                // Checking if there is any number(s) greater
                // than the current number. If there is swap them.
                while (i > 0) {
                    if (b[i] < b[i - 1]) {
                        ///swap(b[i]<b[i-1])
                        temp1 = b[i];
                        b[i] = b[i - 1];
                        b[i - 1] = temp1;
                        i--;
                    } else if (b[i] > b[i - 1]) {
                        i--;
                    }
                }
            } else {
                continue;
            }
        }
        return b;
    }

    ///the following is a function to display the Array 
    public void see(int[] a) {
        for (int j = 0; j < a.length; j++) {
            System.out.print(a[j] + ",");
        }
    }

    public static void main(String[] args) {
        ///You can change the Array to your preference..
        // u can even make it dynamic
        int b[] = {5, 1, 4, 2, 0, 3};
        int v[] = new int[100];
        Bubble br = new Bubble();
        v = br.bubble(b);
        br.see(v);
    }
} 
```

# java - 冻结的安全警告对话框

> ID：16195097
> 
> 赞同：2
> 
> 时间：2013-04-24T14:49:06.223
> 
> 标签：java, applet

我在客户端`applet`部署了哪个。`html`更新到最新版本后`jdk`-`jre`我`1.6.0_45`遇到了冻结安全警告对话框的问题。加载小程序时，会出现对话框，并且对话框上的所有按钮（是、否、更多信息）都不会响应点击。

我确实尝试研究哪些代码是未签名的，但没有找到如何去做的信息。我发现我唯一可以`5`在 java 控制台中按下但它不输出我需要的信息

我发现我可以在`java control panel`-> `security`->中设置`hide warnings and run with protection`，然后对话框不出现，小程序运行正常。

# javascript - 单击 Three.js 后重置 SELECTED 对象的位置

> ID：16195100
> 
> 赞同：0
> 
> 时间：2013-04-24T14:49:08.163
> 
> 标签：javascript, three.js, drag, event-listener

我正在尝试在three.js 中重置我的最新对象的位置。

首先我有这个：

```
function onDocumentMouseDown( event ) {

            event.preventDefault();
            var vector = new THREE.Vector3( mouse.x, mouse.y, 0.5 );
            projector.unprojectVector( vector, camera );

            var raycaster = new THREE.Raycaster( camera.position, vector.sub( camera.position ).normalize() );

            var intersects = raycaster.intersectObjects( objects );

            if ( intersects.length > 0 ) {

                controls.enabled = false;

                SELECTED = intersects[ 0 ].object;

                container.style.cursor = 'move';

                //mouse Click goes here
                buildMenu();

            }

        } 
```

在我的 buildMenu 函数中，我像这样定位我的对象：

```
function buildMenu(){
                camera.position.set(0,60,250);                  

                //HERE I POSITION MY SELECTED OBJECT

                SELECTED.position.x = 0;
                SELECTED.position.y = 50;
                SELECTED.position.z = 200;

                $(document).bind('click',function(){
                    $(document).click(function(){
                        scene.remove(overlayBG);

                     **//HERE I TRY TO RESET EVERYTHING BUT NOTHING WORKS : (**

                        });
                });

                //$('#bg, #menu').fadeIn(100)

            } 
```

我以为我可以通过 $(document).click 函数中的 mesh.position.set(0,0,0) 轻松重置我的对象，但这不起作用。如何检测最新的（重新定位的）对象以及如何重新定位它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:06:47.080

我不确定我是否理解正确。

做了一个简单的例子，你不需要为此绑定任何点击事件。[例子在这里](http://jsfiddle.net/YFkMy/26/)

```
//last selected object
 if ( SELECTED ){
    SELECTED.position.set(0,0,0);
} 
//new selected object
SELECTED = intersects[ 0 ].object; 
```

# r - 在 R 中结合 OpenStreetMap 和几何绘图

> ID：16195103
> 
> 赞同：2
> 
> 时间：2013-04-24T14:49:14.907
> 
> 标签：r, ggplot2

我正在尝试将 {OpenStreetMap} 瓦片与来自其他数据的几何图形结合起来，但这在基础 R 和 ggplot 中都被证明是困难的。目标是简单地在地图上绘制一些点。感谢您知道我缺少什么，或者哪些替代方法（可能与其他库）会产生相同的结果。

提前致谢。

```
require(OpenStreetMap)
require(ggplot2)

lat <- c(63, 48); lon <- c(-20, 8)
map <- openmap(c(lat[1],lon[1]),c(lat[2],lon[2]),4,'osm')
d <- data.frame(x = sample((lon[1]:lon[2]), 10, replace=T), 
                y = sample((lat[1]:lat[2]), 10, replace=T))

# base R plot method
plot(map)
points(d)

# ggplot method
ggplot() + autoplot(map)
ggplot() + autoplot(map) + geom_point(aes(x=d$x, y=d$y)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T18:18:23.247

您正在绘制的栅格地图位于墨卡托投影中。您可以将图像转换为 long-lat，也可以将数据转换为墨卡托投影。见：`help("openproj")`。这是前者：

```
# base R plot method
mapLL <- openproj(map)
plot(mapLL)
points(d) 
```

# linux - 从 Linux 中的 OpenCL 冻结中恢复

> ID：16195105
> 
> 赞同：4
> 
> 时间：2013-04-24T14:49:22.647
> 
> 标签：linux, graphics, opencl, recovery

我正在使用 NVIDIA 卡的 Ubuntu 机器上编写我的第一个 OpenCL 内核。有时，该应用程序会完全冻结整个计算机。鼠标不动，重启的唯一方法是强按电源按钮。

我意识到冻结的原因是我不小心读取了全局只读浮点数组的最后一个索引。虽然这是我不打算经常做的事情，但将来可能仍然会发生。

我的问题是 - 如果再次发生这种情况，是否有任何方法可以防止计算机**完全**关闭？我知道，例如，Windows 可以关闭坏的 GLSL 内核并通过重新启动图形驱动程序来恢复。这里有类似的可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-11T16:41:55.557

您可能无法完全恢复，但您可以使用 SysRq（有时称为 System Request 或 Magic SysRq）更好地恢复。通过执行特定的组合键，您可以让 Linux 以某种理智的方式重新启动（杀死进程和卸载文件系统）。这个键序列在[http://en.wikipedia.org/wiki/Magic_SysRq_key](http://en.wikipedia.org/wiki/Magic_SysRq_key)中有详细描述，所以我不会在这里重复。

在某些情况下，您可能仍然可以通过 SSH 连接到设备。如果这是你的情况，你可能会更幸运。如果您可以使用 SSH，则可以尝试许多其他选项，例如：卸载/重新加载崩溃的模块，重新启动 xserver，或者至少以正常方式重新启动。

虽然我不是“HURD”方面的专家，但我相信它旨在更好地处理这种情况。我能想到的唯一其他解决方案是使用两张显卡，一张用于 X，一张用于 OpenCL。取决于您在做什么，您可能必须通过 NVIDIA 到 VM 才能将其与主机完全隔离。

# xml - 使用 XSLT 组合两个 XML 文件

> ID：16195112
> 
> 赞同：1
> 
> 时间：2013-04-24T14:49:38.587
> 
> 标签：xml, xslt

我需要将两个 XML 文件与 XSLT 合并。它们看起来像这样：

```
<xml xmlns:s='uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882'
    xmlns:dt='uuid:C2F41010-65B3-11d1-A29F-00AA00C14882'
xmlns:rs='urn:schemas-microsoft-com:rowset'
xmlns:z='#RowsetSchema'>
<s:Schema id='RowsetSchema'>
    ... Some stuff
</s:Schema>
<rs:data>
  <z:row Initialer='HBL' personaleGrupper='FF' Fornavn='Harald' Efternavn='Blåtand'     personnummer='123459'/>
</rs:data>
</xml> 
```

另一个文件看起来像：

```
<rs:data>
  <z:row Initialer='KT' personaleGrupper='FF' Fornavn='Kristian' Efternavn='Tyrann' personnummer='546578'/>
</rs:data> 
```

我的尝试是：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
            xmlns:rs="urn:schemas-microsoft-com:rowset"
            xmlns:z="#RowsetSchema">

<xsl:template match="rs:data">
<xsl:copy>
    <xsl:apply-templates select="@* | node() | document('doc2.xml')/rs:data/z:row/node()" />
</xsl:copy>
</xsl:template>

<xsl:template match="node() | @*">
    <xsl:copy-of select="." />
</xsl:template>

</xsl:stylesheet> 
```

但是，我几乎得到了源文件 (doc1.xml) 的副本。换句话说，模式部分就在那里，Harald Blåtand 的一个 rs:data 行就在那里。但不是克里斯蒂安·泰伦系列。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:43:50.493

我不完全确定您的输出应该是什么样子。

以下 xslt 将从第一个文档的 rs:data 条目后面复制来自 doc2.xml 的 rs:data 条目。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
            xmlns:rs="urn:schemas-microsoft-com:rowset"
            xmlns:z="#RowsetSchema">

    <xsl:template match="xml">
        <xsl:copy>
            <xsl:apply-templates select="@* | node() " />
            <xsl:apply-templates select="rs:data"  mode="copy" />
            <xsl:apply-templates select="document('doc2.xml')//rs:data" mode="copy" />
        </xsl:copy>
    </xsl:template>

    <xsl:template match="rs:data" />

    <xsl:template match="*" mode ="copy">
        <xsl:copy>
            <xsl:apply-templates select="@* | node() " />
        </xsl:copy>
    </xsl:template>

    <xsl:template match="node() | @*">
        <xsl:copy>
            <xsl:apply-templates select="@* | node() " />
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

并生成以下输出：

```
?xml version="1.0"?>
<xml xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema">
    <s:Schema id="RowsetSchema">
        ... Some stuff
    </s:Schema>

    <rs:data>
        <z:row Initialer="HBL" personaleGrupper="FF" Fornavn="Harald" Efternavn="Bl&#xE5;tand" personnummer="123459"/>
    </rs:data>
    <rs:data>
        <z:row Initialer="KT" personaleGrupper="FF" Fornavn="Kristian" Efternavn="Tyrann" personnummer="546578"/>
    </rs:data>
</xml> 
```

**更新：** 似乎输出中应该只有一个 rs:data 并且只合并 z:row。试试这个：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
            xmlns:rs="urn:schemas-microsoft-com:rowset"
            xmlns:z="#RowsetSchema">

    <xsl:template match="xml">
        <xsl:copy>
            <xsl:apply-templates select="@* | node() " />
        </xsl:copy>
    </xsl:template>

    <xsl:template match="rs:data" >
        <xsl:copy>
            <xsl:apply-templates select="@* | node() " />
            <xsl:apply-templates select="document('doc2.xml')//rs:data/*" />
        </xsl:copy>
    </xsl:template>

    <xsl:template match="node() | @*">
        <xsl:copy>
            <xsl:apply-templates select="@* | node() " />
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

生成：

```
<xml xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:z="#RowsetSchema">
    <s:Schema id="RowsetSchema">
        ... Some stuff
    </s:Schema>
    <rs:data>
        <z:row Initialer="HBL" personaleGrupper="FF" Fornavn="Harald" Efternavn="Bl&#xE5;tand" personnummer="123459"/>
        <z:row Initialer="KT" personaleGrupper="FF" Fornavn="Kristian" Efternavn="Tyrann" personnummer="546578"/>
    </rs:data>
</xml> 
```

# sharepoint - Sharepoint 2010 OfficialFileUrl 始终为 NULL

> ID：16195114
> 
> 赞同：0
> 
> 时间：2013-04-24T14:49:49.450
> 
> 标签：sharepoint, sharepoint-2010, shared-libraries

我正在尝试从**Sharepoint2010获取****RecordCenterURL**，

 **我已创建连接到连接 RecordCenter 或 DocumentRepository。我用了这个链接

当我尝试从应用程序中检索 OfficialFileUrl 时，它总是返回 NULL 值。

我已经使用了这个示例代码，请帮助我解决这个问题。

```
string URL = "http://inblr-iifw8sv03:31521";

                SPSite site = new SPSite(URL);
                string recordCenterUrl = string.Empty;

                if (site.WebApplication.OfficialFileUrl != null)// This is Always NULL
                {
                    recordCenterUrl = site.WebApplication.OfficialFileUrl.ToString().
                        Replace("_vti_bin/officialfile.asmx", string.Empty);
                }

                Console.WriteLine("URL Found " + recordCenterUrl);
                Console.ReadLine(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T11:55:13.483

当您在例如文档上选择“发送到”上下文菜单时，发送到记录中心是否显示在网站集中？请仔细检查常规设置-> 配置发送到连接（在中央管理中），也许您为错误的 web 应用程序配置了它？**

# php - RegExp 匹配 balise [] 与 AZ 0-9 里面

> ID：16195115
> 
> 赞同：0
> 
> 时间：2013-04-24T14:49:53.980
> 
> 标签：php, regex

说我有类似的东西：

```
$content = " some text [TAG_123] and other text"; 
```

我想匹配`[TAG_123]`。

更准确地说：`[`后跟一个大写字母`A-Z`，然后是零或几个`0-9A-Z_`，然后是`]`.

我试过了 ：

```
$reg = "/\[[A-Z]+[0-9A-Z_]*/"; // => this match [TAG_123

$reg = "/\[[A-Z]+[0-9A-Z_]*\]/"; // => this doesn't work ??? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:56:17.007

*   `[A-Z]`: 1 个字母，`A-Z`
*   `[A-Z0-9_]*`: 0 或更多, `A-Z`,`0-9`或`_`
*   `\[`and `\]`: 字面上匹配`[`and`]`

* * *

```
$content = " some text [TAG_123] and other text";
if (preg_match('/\[[A-Z][0-9A-Z_]*\]/', $content, $matches)) {
    print_r($matches); // $matches[0] includes [TAG_123]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:58:45.677

您忘记在正则表达式中包含下划线：

```
$reg = "/\[[A-Z]+[0-9A-Z]*/"; // => this matches [TAG and not [TAG_123 
```

此外，您需要删除`+`from `[A-Z]`，因为它只需要一次。

```
<?php
$content = " some text [TAG_123] and other text";

$regs="/\[[A-Z][0-9A-Z]*/";
preg_match($regs, $content, $matches);
print_r($matches);

$regs="/\[[A-Z][0-9A-Z_]*/";
preg_match($regs, $content, $matches);
print_r($matches);

$regs="/\[[A-Z][0-9A-Z_]*\]/";
preg_match($regs, $content, $matches);
print_r($matches); 
```

结果

```
 Array ( [0] => [TAG )
    Array ( [0] => [TAG_123 )
    Array ( [0] => [TAG_123] ) 
```

# python - Python：MySQL 连接已打开，但无法创建游标

> ID：16195118
> 
> 赞同：2
> 
> 时间：2013-04-24T14:49:58.997
> 
> 标签：python, mysql, mysql-python

我正在尝试打开一个指向 MySQL-DB 的游标。但我收到了这个错误：

```
'NoneType' object has no attribute 'cursor' 
```

这是一个小源代码：

```
class Sample:
  def __init__(self):
    self.conn = None
    self.value = self.setValue()

  def connect(self):
    self.conn = MySQLdb.connect(...)
    #cursor = self.conn.cursor()
    #cursor.execute("SELECT ...")
    #value = str(cursor.fetchone()[0])
    #raise Exception(value)
    #cursor.close() <- here everything is working fine

  def setValue(self):
    if (self.conn == None):
    self.connect()      
    #raise Exception(self.conn.open)
    cursor = self.conn.cursor() # ERROR: 'NoneType' object has no attribute 'cursor'
    ... 
```

如果我使用异常，我会得到一个 1 ... 连接已打开。

如果我在“连接”函数中创建游标和 SQL 语句，一切都运行良好。

奇怪的是，一切看起来都是正确的，对于具有相同功能的其他一些连接，一切都运行良好，也是。我不知道如何解决这个错误。我希望有人能指出我正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:51:22.347

我会将检查连接是否打开的语句更改为检查 conn 是否为空以及连接是否打开。而且因为您总是执行该`setValue`函数，我建议您在`__init__`函数内部调用连接。

```
class Sample:
  conn = None

  def __init__(self):
    self.connect()
    self.value = self.setValue()
    self.close()

  def connect(self):
    self.conn = MySQLdb.connect(...)

  def close(self):
    if self.conn:
       self.conn.close()

  def setValue(self):
    if not self.conn and not self.conn.open:
       self.connect()
    cursor = self.conn.cursor() 
```

另外，请记住，使用 Python MySQL 连接器时，您需要在执行插入或更新语句后调用 commit。

```
cur =  self.conn.cursor()
cur.execute("...")
self.conn.commit() 
```

# c# - 声明一个标量变量@@SA_CONSOLE_HOSTNAME

> ID：16195119
> 
> 赞同：0
> 
> 时间：2013-04-24T14:50:08.943
> 
> 标签：c#

//我给出的查询看起来像

//插入表名（主机，实例）值（@SA_CONSOLE_HOSTNAME，值），在表名中我创建了列主机和实例，其中主机将是我的本地机器名称。我不想每次代码在不同的系统中运行时都输入机器名称，因此创建了一个变量并为其分配了机器名称，

//我创建了一个存根并将机器名传递给它

```
String scriptAndStub;

scriptAndStub =
    "DECLARE @SA_CONSOLE_HOSTNAME VARCHAR(256)\n" + \\ creating a variable 
    "SET @SA_CONSOLE_HOSTNAME = @HOSTNAME@\n";
scriptAndStub += script;

executeScript.CommandText = scriptAndStub;
executeScript.Parameters.AddWithValue("@HOSTNAME@", Environment.MachineName); \\passing machine name 
```

//当我单击文本框上的检查语法按钮时，它会产生错误

```
private void btnSyntaxCheck_Click(object sender, EventArgs e)
        {
            try
            {
                tsStatus.Text = "Checking Syntax...";
                LogMessage(DA_Base.Constants.ERROR_LEVEL_DEBUG, "SQLScripting::SyntaxCheck", "Query: " + rtbScript.Text);
                using (SqlCommand myCommand = new SqlCommand(string.Empty, Connection))
                {
                   foreach (string script in Regex.Split(rtbScript.Text, "^GO\r?$", RegexOptions.Multiline | RegexOptions.IgnoreCase))
                      {
                           if (!String.IsNullOrEmpty(script))
                           {
                             myCommand.CommandText = "SET PARSEONLY ON\n" + script;
                             myCommand.ExecuteNonQuery();
                            }
                       }
                 }
                 tsStatus.Text = "Checking Syntax Complete. No errors reported.";
             }
             catch (Exception exc)  \\error has been caught here....
             {
                tsStatus.Text = exc.Message;
                MessageBox.Show(exc.Message, "SQL Syntax Check");
             }
         }
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T18:48:43.237

```
FIXED IT BY DECLARING IT IN THE MAIN FUNCTION AND CLEARING THE @HOSTNAME@..WORKS FINE..

String scriptAndStub;

scriptAndStub =
    "DECLARE @SA_CONSOLE_HOSTNAME VARCHAR(256)\n" + \\ creating a variable 
    "SET @SA_CONSOLE_HOSTNAME = @HOSTNAME@\n";
     executescript.parameters.clear();
scriptAndStub += script;

executeScript.CommandText = scriptAndStub;
executeScript.Parameters.AddWithValue("@HOSTNAME@", Environment.MachineName); \\passing machine name 
```

//当我单击文本框上的检查语法按钮时，它会产生错误

```
private void btnSyntaxCheck_Click(object sender, EventArgs e)
        {
            try
            {
                tsStatus.Text = "Checking Syntax...";
                LogMessage(DA_Base.Constants.ERROR_LEVEL_DEBUG, "SQLScripting::SyntaxCheck", "Query: " + rtbScript.Text);

                 String scriptAndStub; 
                 scriptAndStub = "DECLARE @SA_CONSOLE_HOSTNAME VARCHAR(256)\n";

                using (SqlCommand myCommand = new SqlCommand(string.Empty, Connection))
                {
                   foreach (string script in Regex.Split(rtbScript.Text, "^GO\r?$", RegexOptions.Multiline | RegexOptions.IgnoreCase))
                      {
                           if (!String.IsNullOrEmpty(script))
                           {
                             myCommand.CommandText = "SET PARSEONLY ON\n" + script;
                             myCommand.ExecuteNonQuery();
                            }
                       }
                 }
                 tsStatus.Text = "Checking Syntax Complete. No errors reported.";
             }
             catch (Exception exc)  \\error has been caught here....
             {
                tsStatus.Text = exc.Message;
                MessageBox.Show(exc.Message, "SQL Syntax Check");
             }
         }
   }
} 
```

# sql - 查询空白答案 - 表中缺少一行

> ID：16195121
> 
> 赞同：2
> 
> 时间：2013-04-24T14:50:09.430
> 
> 标签：sql, sql-server, sql-server-2005

我有一个表格，当患者被转移到另一个位置时，用户会填写该表格。

表单的相关部分如下所示： ![在此处输入图像描述](https://i.stack.imgur.com/e0iWp.png)

我想计算没有的患者人数`Date of Return`。

相关表格 -

form_names - 表单列表

```
select id, name from form_names where id = 47

id    name
----- ----------------------
47    Transfer of Health Information 
```

form_items - 每个表单 ( `form_name`) 的问题列表。

```
select id, form_name, text from form_items where form_name = 47

id          form_name   text
----------- ----------- ------------------------------------
1147        47          Date of Transfer:
1148        47          Sending Facility:
1155        47          Date of Return: 
```

form_records - 说明特定患者 ( `pid`) 填写表格 ( `form_name`) 的记录。

```
select id, pid, date, form_name From form_records where pid = 260 and form_name = 47

id          pid         date                    form_name
----------- ----------- ----------------------- -----------
16409       260         2013-04-24 09:33:29.000 47 
```

现在，最后一个相关表是 form_answers 表。**此表中只会填充已完成的答案。**

如您所见，由于该`Date of Return`值从未在表单中填写，因此它永远不会出现在此表中：

```
select id, form_record, form_item, text from form_answers where form_record = 16409

id                   form_record form_item   text
-------------------- ----------- ----------- -----------------------------------------
354535               16409       1147        04-24-2013
354536               16409       1148        Lawrence Jail
354537               16409       1149        Lawrence County Hospital
354538               16409       1151        NKMA 
```

我已经尝试过这样的事情，但它不起作用：

```
select
        count(*)
from
        form_names fn
                inner join form_items fi on fn.id = fi.form_name
                inner join form_records fr on fn.id = fr.form_name             
                left outer join form_answers fa on fr.id = fa.form_record and fi.id = fa.form_item
where
        fn.name like '%Transfer of Health Information%'
        and dateadd(dd, 0, datediff(dd, 0, fr.date)) = dateadd(dd, 0, datediff(dd, 0, getdate()))
        and fi.text like '%receiving facility%'
        and fa.id is NULL 
```

**如何查找没有返回日期字段的患者数量**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:02:16.367

我认为答案的加入是不正确的。您需要同时加入项目和 fr.id：

```
select count(*)  -- should this be "count(distinct pid)"?
from form_names fn inner join
     form_items fi
     on fn.id = fi.form_name inner join
     form_records fr
     on fn.id = fr.form_name left outer join          
     form_answers fa
     on fn.id = fa.form_item and fa.form_record = fr.id
where fn.name like '%Transfer of Health Information%'
      fn.text like '%Date of Return%' and
      dateadd(dd, 0, datediff(dd, 0, fr.date)) = dateadd(dd, 0, datediff(dd, 0, getdate())) and
      fi.text like '%receiving facility%' and
      fa.id is NULL; 
```

您查询失败，因为*其他*某种形式满足条件。

顺便说一句，我发现让外键与主键的名称匹配要容易得多。除此之外，外键应该是表的名称，后跟`_id`or `Id`。

# php - str_getcsv 未正确解析数据

> ID：16195128
> 
> 赞同：2
> 
> 时间：2013-04-24T14:50:23.057
> 
> 标签：php, string, csv, explode, fgetcsv

我对 PHP 的 str_getcsv 函数有疑问。

我有这个代码：

```
<?php
$string = '#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=714000,RESOLUTION=640x480,CODECS="avc1.77.30, mp4a.40.34"';

$array = str_getcsv($string, ",", '"');

print_r($array); 
```

哪个应该返回：

```
Array
(
    [0] => #EXT-X-STREAM-INF:PROGRAM-ID=1
    [1] => BANDWIDTH=714000
    [2] => RESOLUTION=640x480
    [3] => CODECS=avc1.77.30, mp4a.40.34
) 
```

但相反，它正在返回：

```
Array
(
    [0] => #EXT-X-STREAM-INF:PROGRAM-ID=1
    [1] => BANDWIDTH=714000
    [2] => RESOLUTION=640x480
    [3] => CODECS="avc1.77.30
    [4] =>  mp4a.40.34"
) 
```

因为它忽略了最后一个参数的附件：CODECS，并且也在拆分该信息。我正在使用 str_getcsv 而不是仅仅因为这个原因做 explode(",", $string) （该函数应该尊重外壳），但它的工作方式与 explode 将做的一样。

正在执行的代码： http: [//eval.in/17471](http://eval.in/17471)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:52:51.553

*外壳*（第三个）参数没有那么大的效果。仅当它出现在分隔符旁边时，才会这样处理包围字符。

要获得所需的输出，输入需要是

```
#EXT-X-STREAM-INF:PROGRAM-ID=1,...,"CODECS=avc1.77.30, mp4a.40.34" 
```

**[看到它在行动](http://eval.in/17472)**。

# jquery - jQuery，滑动垂直文本刚刚离开屏幕而没有回旋

> ID：16195129
> 
> 赞同：0
> 
> 时间：2013-04-24T14:50:23.617
> 
> 标签：jquery

到目前为止，这是我的代码，

```
 function richardsSuperAmazingVerticalTextScroller(){

        $('#honor-roll ul').animate(
        { 
            top: '-=' + $('#honor-roll ul li:last').height()
        },
        1000,
        'linear',
        function(){
            var offset = $('#honor-roll ul li:last').offset().top;                
            console.log(offset);
            if( offset <= 640){
                 $('#honor-roll ul li').css("margin", 0);
                 $('#honor-roll ul li:last').after($('#honor-roll ul li:first').detach());
            }
        }
    );
    }
    $(document).ready(function(){
        setInterval('richardsSuperAmazingVerticalTextScroller()',1000)
    }); 
```

在 jsFiddle 上它工作得很好，但在这个版本中它失败了，[http: //barkins.com/test.html](http://barkins.com/test.html)

这是 Fiddle 上的相同代码，[http://jsfiddle.net/qmFD3/6/](http://jsfiddle.net/qmFD3/6/)

谁能发现问题？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:56:41.710

因此，它不是相同的代码。特别是，你的 jsFiddle 有

```
if( offset <= 640){
    $('#honor-roll ul').css("top", 0);
    $('#honor-roll ul li:last').after($('#honor-roll ul li:first').detach());
} 
```

虽然您网站上的代码有

```
if( offset <= 640){
    $('#honor-roll ul li').css("margin", 0);
    $('#honor-roll ul li:last').after($('#honor-roll ul li:first').detach());
} 
```

改变它可以解决问题。

作为旁注，您不应该在`setTimeout`. 您可以将其更改为：

```
setInterval(richardsSuperAmazingVerticalTextScroller,1000) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:12:44.957

你需要改变：

```
$('#honor-roll ul li').css("top", 0); 
```

至：

```
$('#honor-roll ul').css("top", 0); // Note the li 
```

以及将所有 jQuery 代码包装在里面`$(document).ready(function() { });`

```
$(document).ready(function(){
    $('#honor-roll ul').css({display:"none"});
    $('#honor-roll ul').fadeIn('slow');
    setInterval(richardsSuperAmazingVerticalTextScroller,1000)
}); 
```

* * *

编辑：

我想我知道你的代码不起作用的原因，这是因为你的 jQuery 版本

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type="text/javascript"></script> 
```

这是与您的网站存在完全相同问题的**[FIDDLE](http://jsfiddle.net/qmFD3/7/)**

所以你只需要在你的网站上使用另一个 jQuery 版本，它应该可以工作。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:56:58.793

也许这一切都是为了把

```
 <script> 
```

身体元素内部

# macos - 如何使用 libvlc 在 OS X 上输出 5.1 环绕声？

> ID：16195131
> 
> 赞同：1
> 
> 时间：2013-04-24T14:50:42.777
> 
> 标签：macos, core-audio, vlc, libvlc

我正在尝试编写我的应用程序以使用 libvlc 通过 HDMI 声音设备输出环绕声 (AC3 5.1)。

HDMI 设备在 OSX 的音频设备中称为“HDMI”。

我尝试过使用`libvlc_audio_output_device_set`，我尝试使用“coreaudio”、“auhal”和“HDMI”作为名称，并将 ID 号作为 id。我不确定这是否正确，文件谈到了这个电话的不可移植性和特异性。

我也尝试在初始化 libvlc 时传递参数：

*   “--aout=auhal”
*   “核心音频开发 40”

40 是 HDMI 设备的 ID（由我拥有的动态库确定，该库获取特定音频设备的设备 ID 号），但在这种情况下我收到错误：

```
vlc: unknown option or missing mandatory argument `--coreaudio-dev 40' 
```

VLC 文档说这是 OSX 上的一个选项，但它似乎不起作用。

在独立的 VLC 应用程序中选择音频设备可以正常工作（选择 HDMI）。

我在 OS X 10.8.3 上使用夜间 VLC。

任何人都可以帮忙吗？

# javascript - 不匹配正则表达式

> ID：16195132
> 
> 赞同：3
> 
> 时间：2013-04-24T14:50:45.080
> 
> 标签：javascript, regex

我正在使用这个正则表达式`/\s*?left:\s*?-?\d+\.?\d*px;/im`来查找例如：`left: 100.5px;`.

问题是它也找到`margin-left: 100px;`或者`padding-left...`我希望它不匹配诸如`-left`但匹配的单词`left`。

有任何想法吗？

编辑：我将它与 javascript 一起使用。我为此做了一个简单的jsfiddle。[http://jsfiddle.net/WU7GV/3/](http://jsfiddle.net/WU7GV/3/)目标是让“jupp”出现，但不是“nope”在两个 if 句中使用相同的正则表达式

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:57:44.437

**选项 1：**使用起始锚点：

```
/^left:\s*-?\d+\.?\d*px;/im 
```

**选项 2：**如果您不能使用起始锚点，因为这可能不是输入文本的实际开始，那么您可以使用带有否定后视的单词边界，如下所示：

```
/(?<!-)\bleft:\s*-?\d+\.?\d*px;/im 
```

### 现场演示：[http ://www.rubular.com/r/o1lsRU9mmE](http://www.rubular.com/r/o1lsRU9mmE)

### 更新：没有负前瞻的 Javascript 解决方法：

```
var re=/\b.*?(left:\s*-?\d+\.?\d*px;)/igm;

function matchIt(str) {
   repl = str.replace(re, function($0, $1) {
      return $0 == $1? $0 : '';
   });
   return repl != ""? true : false;
}

console.log(matchIt('margin-left:100px;')); // false
console.log(matchIt('left:100px;')); // true 
```

### 现场演示：http: [//ideone.com/xt1kPH](http://ideone.com/xt1kPH)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T14:52:57.180

使用表达式开始锚

```
/^\s*?left:\s*?-?\d+\.?\d*px;/im 
```

除了 之外，还可以有其他指标`px`，但我相信您知道这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:54:10.003

使用字符串的开头（和结尾）[anchor](http://www.regular-expressions.info/anchors.html)，如下所示：

`/^\s*?left:\s*?-?\d+\.?\d*px;$/im`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:07:08.303

使用[单词边界](http://www.regular-expressions.info/wordboundaries.html)：

```
[^(left)]*\b\s*?(left:\s*?-?\d+\.?\d*px;) 
```

所以它会寻找任何不是“左”的东西，一个词边界，如上面的链接中所述。然后你的 ( [`group`](http://www.regular-expressions.info/brackets.html)) 返回你想要的。

如果您指定此正则表达式使用的语言，它将帮助我们回答您的问题。否则，试试 www.debuggex.com 的交互式正则表达式调试器！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-24T19:01:40.830

尝试使用这个正则表达式：

```
/([^-]left|^left):.*?;/im 
```

如果您的字符串以“left”开头或包含“left”但不包含“-left”的字符串，这将匹配。

如果你不关心你的风格单位，.*?; 是匹配从 : 到最近的所有内容的好速记；.

如果您只需要匹配 px 而不是 %;、pt;、em !important; 等...，请在 : 之后保留相同的正则表达式，尽管我认为非贪婪空间：

```
\s*? 
```

是不必要的，即，您可以只使用：

```
/([^-]left|^left):\s*-?\d+\.?\d*px;/im 
```

# java - 在 for 循环中实例化数组以创建 JTextFields

> ID：16195134
> 
> 赞同：1
> 
> 时间：2013-04-24T14:50:51.153
> 
> 标签：java, arrays, applet, jtextfield

我需要使用 forloop 和 text_fields 实例变量来实例化每个文本字段，使其成为侦听器，并将其添加到小程序中。text_fields 变量是一个数组，其最大数组数为 2。

```
Container c = getContentPane();

c.setLayout(new FlowLayout());

 int i = 0;
 for (i = 0; i < FIELDS; i++)
 {
   THIS IS WHERE I DON'T KNOW WHAT TO WRITE.
       i need to instantiate the arrays, make them listeners and 
       add them to the applet.

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:02:31.757

这可能会有所帮助。

```
Container c = getContentPane();

c.setLayout(new FlowLayout());
JTextField[] txt = new JTextField[FIELDS]; // FIELDS is an int, representing the max number of JTextFields

 int i = 0;
 for (i = 0; i < FIELDS; i++)
 {
   txt[i] = new JTextField();
   // add any listener you want to txt[i]
   c.add(txt[i]);
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:03:30.237

目前还不清楚是`FIELDS`你的`JTextField`aray 还是常数。如果是组件数组本身，`.length`在迭代时考虑使用数组字段。这减少了代码维护：

```
JTextField[] fields = new JTextField[SIZE];
for (int i = 0; i < fields.length; i++) {
   fields[i] = new JTextField("Field " + i);
   fields[i].addActionListener(myActionListener);
   c.add(fields[i]);
} 
```

请注意，大写变量用于 Java 命名约定下的常量。

# dart - google_oauth2_client 如何处理“拒绝访问”

> ID：16195136
> 
> 赞同：2
> 
> 时间：2013-04-24T14:50:57.440
> 
> 标签：dart

按照[DartWatch 博客](http://blog.dartwatch.com/2013/04/sign-in-with-google-using-google-oauth2.html)上关于使用 Google OAuth 库的教程进行操作。问题是如何处理：来自 Google 的“访问被拒绝”错误？

这是我的代码示例：

```
class Client
{

   GoogleOAuth2 _auth;

   Client()
   {
      _auth = new GoogleOAuth2(
                        '5xxxxxxxxxxxxxx.apps.googleusercontent.com', // Client ID
                        ['openid', 'email', 'profile'],
                        tokenLoaded:oauthReady);
   }

   void doLogin()
   {
       //    _auth.logout();
       //    _auth.token = null;
       try
       {
           _auth.login();
       }
       on AuthException {
           print('Access denied');
       }
       on Exception catch(exp)
       {
           print('Exception $exp occurred');
       }
   }

   void oauthReady(Token token)
   {
      print('Token is: $token');
   }          
} 
```

但我从不`catch`阻止任何（！）异常。我做错了什么？

我正在使用：
**Dart Editor 版本 0.5.0_r21823**
**Dart SDK 版本 0.5.0.1_r21823**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T17:30:33.073

你永远不会碰到 catch 块，因为`auth.login`它是一个返回 Future 的异步操作。

[网站](http://www.dartlang.org/articles/futures-and-error-handling/)上有[一篇关于未来错误处理的精彩文章`dartlang.org`](http://www.dartlang.org/articles/futures-and-error-handling/)。

`auth.login` [立即返回一个 Future](https://github.com/dart-gde/dart-google-oauth2-library/blob/master/lib/src/browser/googleoauth2.dart#L98)，但它所做的工作是在控制返回事件循环后发生的（有关事件循环的更多信息，请参阅[我对另一个问题的回答](https://stackoverflow.com/questions/16115298/launching-multiple-async-futures-in-response-to-events/16117949#16117949)。）

您的代码应该看起来更像：

```
/// Returns a Future that completes to whether the login was successful.
Future<boolean> doLogin()
{
    _auth.login()
    .then((_) {
       print("Success!");
       return true;
    }.catchError((e) {
       print('Exception $e occurred.');
       return false; // or throw the exception again.
    }
} 
```

# c++ - 当用户按下某些键时，如何制作一个改变颜色的正方形？

> ID：16195138
> 
> 赞同：0
> 
> 时间：2013-04-24T14:51:03.227
> 
> 标签：c++, opengl

我写了一个代码，但我不知道它哪里出错了。有人可以帮我吗？

我在我的代码中写了一些注释。如果有人可以帮助我，我会很高兴。因为我自己找不到错误。:(

```
#include <windows.h>
#include <gl/glut.h>

// Function callback that is called to draw
void Desenha(void)
{
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    // Clean the window
    glClear(GL_COLOR_BUFFER_BIT);

    // Shows that the color is red
    //         R     G     B
    glColor3f(1.0f, 0.0f, 0.0f);

    // Draw a square
    glBegin(GL_QUADS);
    glVertex2i(30,226);
    glVertex2i(226,30);
    // Shows that the color is blue
    glColor3f(0.0f, 0.0f, 1.0f);
    glVertex2i(30,226);
    glVertex2i(226,30);
    glEnd();

    // Executes the OpenGL's commands
    glFlush();
}

// rendering
void Inicializa (void)
{
    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);
}

void AlteraTamanhoJanela(GLsizei w, GLsizei h)
{
    // Evita a divisao por zero
    if(h == 0) h = 1;

    // Especifica as dimensões da Viewport
    glViewport(0, 0, w, h);

    // Inicializa o sistema de coordenadas
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    // (left, right, bottom, top)
    if (w <= h)
        gluOrtho2D (0.0f, 250.0f, 0.0f, 250.0f*h/w);
    else
        gluOrtho2D (0.0f, 250.0f*w/h, 0.0f, 250.0f);
}

// Function callback that is called to manage the keyboard tasks
void GerenciaTeclado(unsigned char key, int x, int y)
{
    switch (key) {
    case 97:
    case 'a':// change the actual color to red
        glColor3f(1.0f, 0.0f, 0.0f);
        break;
    case 118:
    case 'v':// change de color do blue
        glColor3f(0.0f, 0.0f, 1.0f);
        break;
    case 27:
    case 'esc':// close the screen
        exit(0);
        break;
    }
    glutPostRedisplay();
}

// Main Program
int main(void)
{
    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);
    glutInitWindowSize(256,256);
    glutInitWindowPosition(10,10);
    glutCreateWindow("Quadrado");
    glutDisplayFunc(Desenha);
    glutReshapeFunc(AlteraTamanhoJanela);
    Inicializa();
    glutMainLoop();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:03:19.607

除其他外，您`switch()`没有编译，您错过了一个`glutInit()`电话，并且您从未`GerenciaTeclado()`通过`glutKeyboardFunc()`.

尝试这个：

```
#include <GL/glut.h>

// Function callback that is called to manage the keyboard taks
float r = 0.0f;
float g = 0.0f;
float b = 0.0f;
void GerenciaTeclado(unsigned char key, int x, int y)
{
    switch (key) {
    case 'a':// change the actual color to red
        r = 1.0f;
        g = 0.0f;
        b = 0.0f;
        break;
    case 'v':// change de color do blue
        r = 0.0f;
        g = 0.0f;
        b = 1.0f;
        break;
    case 27:// close the screen
        exit(0);
        break;
    }
    glutPostRedisplay();
}

// Function callback that is called to draw
void Desenha(void)
{
    // Clean the window
    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT);

    // Inicializa o sistema de coordenadas
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    double w = glutGet( GLUT_WINDOW_WIDTH );
    double h = glutGet( GLUT_WINDOW_HEIGHT );
    double ar = w / h;
    glOrtho( -2 * ar, 2 * ar, -2, 2, -1, 1);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    // Draw a square
    glBegin(GL_QUADS);
    // Shows that the color is red
    //        R  G  B
    glColor3f(r, g, b);
    glVertex2f(-1, -1);
    glVertex2f( 1, -1);
    // Shows that the color is blue
    glColor3f(0.0f, 0.0f, 1.0f);
    glVertex2f( 1, 1);
    glVertex2f(-1, 1);
    glEnd();

    glutSwapBuffers();
}

// Main Program
int main( int argc, char** argv )
{
    glutInit( &argc, argv );
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB);
    glutInitWindowSize(256,256);
    glutInitWindowPosition(10,10);
    glutCreateWindow("Quadrado");
    glutDisplayFunc(Desenha);
    glutKeyboardFunc(GerenciaTeclado);
    glutMainLoop();
} 
```

# java - 在 JExcel 中编写超链接后，如何在 excel 中“激活”超链接？

> ID：16195140
> 
> 赞同：0
> 
> 时间：2013-04-24T14:51:03.420
> 
> 标签：java, excel, jexcelapi

我的电子表格中的某些列是使用 JExcel 创建的，是使用相邻单元格的超链接。举个例子：

```
|A         |B           |C         |D
|RowNumber |Unicorn Name|Unicorn ID|Link to Unicorn Profile
|000000001 |Jefficorn   |001       |=hyperlink(concatenate("www.stackoverflow.com/unicornfinder/",C1,"/profile.html"),"Unicorn Profile") 
```

但是，当 JExcel 将其输出到电子表格中时，用户看到的是公式的纯文本（如上所示），而不是带有文本*Unicorn Profile*的超链接。

如何以编程方式激活它？我无法更改条目，因此我无法遵循制作超链接的标准方式，如下所示（以半伪代码形式）：

```
sheet.addHyperlink("www.stackoverflow.com/unicornfinder/"+cell.getNeighbourCell.getContent()+"/profile.html);
sheet.addLabel("Unicorn Profile"); 
```

有没有一种简单的方法来“激活”我的超链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:48:04.380

[注释](https://stackoverflow.com/questions/16195140/how-do-i-activate-a-hyperlink-in-excel-after-writing-it-in-jexcel/16196500#comment23155335_16195140)中建议的以下代码似乎有效，但在单元格中给出了一个奇怪的值，尽管我不知道为什么。

```
import java.io.File;
import java.io.IOException;
import java.util.ArrayList;

import jxl.CellFormat;
import jxl.Workbook;
import jxl.biff.CellReferenceHelper;
import jxl.biff.DisplayFormat;
import jxl.read.biff.BiffException;
import jxl.write.Formula;
import jxl.write.Label;
import jxl.write.Number;
import jxl.write.WritableCellFormat;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;
import jxl.write.WriteException;

public class Launcher {

  /**
   * @param args
   * @throws IOException 
   * @throws IOException 
   * @throws WriteException 
   * @throws BiffException 
   */
  public static void main(String[] args) throws IOException, WriteException {
    //Creates a writable workbook with the given file name
    WritableWorkbook workbook = Workbook.createWorkbook(new File("D:\\Documents and Settings\\castone\\My Documents\\Formula.xls"));

    WritableSheet sheet = workbook.createSheet("My Sheet", 0);

    ArrayList<Label> labelList = new ArrayList<Label>();
    //create the filler text
    labelList.add(new Label(0, 0, "UnicornName"));
    labelList.add(new Label(0, 1, "Pureferret"));
    labelList.add(new Label(2, 0, "Unicorn ID"));
    labelList.add(new Label(2, 1, "1075247"));
    labelList.add(new Label(1, 0, "Hyperlink"));
    for(Label label:labelList){
        sheet.addCell(label);
    }    
    //Create a formula for adding cells
    String formulaText ="HYPERLINK(CONCATENATE(\"https://stackoverflow.com/users/\","+
            CellReferenceHelper.getCellReference(2, 1).toString()+"),\"Link\"";
    Formula link = new Formula(1, 1,formulaText);
    sheet.addCell(link);

    //Writes out the data held in this workbook in Excel format
    workbook.write(); 

    //Close and free allocated memory 
    workbook.close(); 
  }

} 
```

这就是单元格中出现的内容`=CONCATENATE("https://stackoverflow.com/users/",C2) HYPERLINK("Link")`。

* * *

或者，我使用这种设置来获取地址的相关部分，并从中形成一个新的超链接：

```
import java.io.File;
import java.io.IOException;
import java.net.URL;
import java.util.ArrayList;

import jxl.Workbook;
import jxl.read.biff.BiffException;
import jxl.write.Label;
import jxl.write.WritableHyperlink;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;
import jxl.write.WriteException;

public class Launcher {

  /**
   * @param args
   * @throws IOException 
   * @throws IOException 
   * @throws WriteException 
   * @throws BiffException 
   */
  public static void main(String[] args) throws IOException, WriteException {
    //Creates a writable workbook with the given file name
    WritableWorkbook workbook = Workbook.createWorkbook(new File("D:\\Documents and Settings\\castone\\My Documents\\Formula.xls"));

    WritableSheet sheet = workbook.createSheet("My Sheet", 0);

    ArrayList<Label> labelList = new ArrayList<Label>();
    //create the filler text
    labelList.add(new Label(0, 0, "UnicornName"));
    labelList.add(new Label(0, 1, "Pureferret"));
    labelList.add(new Label(2, 0, "Unicorn ID"));
    labelList.add(new Label(2, 1, "1075247"));
    labelList.add(new Label(1, 0, "Hyperlink"));
    for(Label label:labelList){
        sheet.addCell(label);
    }    
    //Create a formula for adding cells
    String formulaText ="HYPERLINK(CONCATENATE(Overview$B$15,\"users\",C2),\"Link\")";
    String[] linkBits = formulaText.substring(formulaText.lastIndexOf("(")+1,formulaText.indexOf(")")).split(",");
    String baseURL = "http://www.stackoverflow.com/";
    String linkURL = baseURL+linkBits[1].replace("\"","")+"/"+sheet.getCell(linkBits[2]).getContents();
    String linkDesc = "Profile";
    WritableHyperlink link = new WritableHyperlink(1, 1, new URL(linkURL));
    link.setDescription(linkDesc);
    sheet.addHyperlink(link);

    //Writes out the data held in this workbook in Excel format
    workbook.write(); 

    //Close and free allocated memory 
    workbook.close(); 
  }

} 
```

# python - 为什么 python 和 bpython 之间的 string.letters 不同？

> ID：16195144
> 
> 赞同：6
> 
> 时间：2013-04-24T14:51:08.223
> 
> 标签：python, bpython

我今天遇到了一个奇怪的问题。我正在使用 Python 标准库的`string`模块`letters`变量，并注意到 bpython 中的结果与 vanilla python 中的结果不同。

我正在使用 Python 2.7.3 和 bpython 0.10.1 和 virtualenv 1.8.4。这就是我所看到的。

```
$ bpython
>>> import string
>>> string.letters
'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'

$ python
>>> import string
>>> string.letters
'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' 
```

我不确定这是否重要，但我在 xubuntu 12.10 上运行它。

有人可以解释一下这里发生了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:55:00.487

从[docs](http://docs.python.org/2/library/string.html#string.letters)， string.letters 被定义为

> 字符串小写和大写的连接如下所述。具体值取决于语言环境，将在调用 locale.setlocale() 时更新。

所以可能是你的语言环境不同。

# c# - 在控制台应用程序中使用 System.Web.Routing

> ID：16195145
> 
> 赞同：1
> 
> 时间：2013-04-24T14:51:10.763
> 
> 标签：c#, routes, asp.net-mvc-routing

我想在控制台应用程序中使用路由基础设施。理想情况下，使用自定义 Hanlder（而不是 IHttpHandler（这是一个控制台应用程序，因此没有可用的 HttpContext）重用 .NET 4.5 中提供的路由器。主要思想是对事件做出反应并将事件/消息分派给正确的处理程序。它在我看来非常接近 MVC 并想用这个框架“启发”我。有没有人已经在这种情况下使用过路由器？

# c# - 如何在 Silverlight XAML 页面中为外部网页创建框架？

> ID：16195148
> 
> 赞同：0
> 
> 时间：2013-04-24T14:51:19.950
> 
> 标签：c#, silverlight, xaml, frame

我对 .NET 很陌生，试图做一个简单的 XAML 网页，里面有一个 200x200 的框架，里面有谷歌。我有一个 XAML 页面，如下所示：

```
 <UserControl x:Class="Oleo.CI.Content.IU.Form.Test"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:telerik="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls"
    xmlns:telerikInput="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.Input"
    xmlns:telerikNavigation="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.Navigation"
    xmlns:telerikGrid="clr-namespace:Telerik.Windows.Controls;assembly=Telerik.Windows.Controls.GridView"
    xmlns:navigation="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Navigation"
    xmlns:uiControl="clr-namespace:Oleo.CI.Contenidos.IU.Control;assembly=Oleo.CI.Contenidos.IU.Control"
    mc:Ignorable="d" d:DesignHeight="500" d:DesignWidth="1002" Width="1002" Height="812" xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk">

    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 10 18 -10">
          <navigation:Frame x:Name="Cont" Source="http://www.google.com" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" Width="200" Height="200"/>
          <TextBlock Text="Oferta" Grid.Column="3" Grid.Row="2"  HorizontalAlignment="Right" />
    </StackPanel>
 </UserControl> 
```

我已经尝试过使用 navigation:Frame 和 sdk:Frame 但该框架没有显示在页面上与该代码（其他控件，如 TextBlocks 的 RadGrids 工作完美）。我不确定我做错了什么，任何人都可以对我有所启发吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:01:39.950

您无法在 Silverlight 框架内打开网页。Frame 类表示一个控件，该控件支持在**Silverlight 页面**之间进行导航。通过处理Frame的NavigationFailed事件可以看到导航失败。

```
<navigation:Frame x:Name="Cont" Source="http://www.google.com" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" Width="200" Height="200"
            NavigationFailed="Cont_NavigationFailed"/> 
```

它将抛出异常消息： **无法加载 URI 的内容。URI 可能无效。**

**更新**：您可以使用 Html 中的 iframe 标签来实现您的目标。

这就是你要做的事情：在创建 Silverlight 应用程序时，Visual Studio 在你的解决方案中创建两个项目。一个用于 Silverlight 应用程序，它生成 .xap 文件和一个简单的 Asp.Net 网站，默认情况下包含 TestPage.aspx。您的 .xap 文件包含在此网页中，并且 .xap 的高度和宽度设置为 100%。当然，您可以根据需要更改它。目前，我已将高度和宽度都设置为 50%。如果您要在浏览器中的此部分上单击鼠标右键，您将看到 Silverlight 上下文菜单。但是在您的 Web 应用程序的其他部分，您将看到 Html 网页的默认上下文菜单。因此，您必须将 iframe 标记添加到该页面。

```
 <iframe src="http://www.msdn.com" height="700px" width="700px"></iframe>
    <div id="silverlightControlHost">
        <object data="data:application/x-silverlight-2," type="application/x-silverlight-2"
            width="50%" height="50%">
            <param name="source" value="ClientBin/SilverlightApplication1.xap" />
            <param name="onError" value="onSilverlightError" />
            <param name="background" value="white" />
            <param name="minRuntimeVersion" value="5.0.61118.0" />
            <param name="autoUpgrade" value="true" />
            <a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=5.0.61118.0" style="text-decoration: none">
                <img src="http://go.microsoft.com/fwlink/?LinkId=161376" alt="Get Microsoft Silverlight"
                    style="border-style: none" />
            </a>
        </object>
        <iframe id="_sl_historyFrame" style="visibility: hidden; height: 0px; width: 0px;
            border: 0px"></iframe>
    </div> 
```

但是，我必须说你不能在 iframe 中打开谷歌网站。因为谷歌正在阻止 iframe。

# google-apps-script - urlFetchApp 配额和重定向

> ID：16195150
> 
> 赞同：3
> 
> 时间：2013-04-24T14:51:26.207
> 
> 标签：google-apps-script

我的问题是关于在 Google Apps 脚本中使用 urlFetchApp 每天获取的 URL 配额。

当一个获取的 URL 使用“位置”HTTP 参数自动重定向到另一个 URL 时，这算作 2 次获取还是仅 1 次？

谢谢

蒂埃里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-02T15:42:36.890

公平的问题。重定向不会计入您每天的 UrlFetch 调用总数。

# c# - 如何绑定嵌套中继器？

> ID：16195153
> 
> 赞同：0
> 
> 时间：2013-04-24T14:51:48.023
> 
> 标签：c#, asp.net, ado.net

我有一个服务页面，它显示服务详细信息，并有一个像服务功能和费用这样的子部分。我为功能和费用创建了两个中继器。有关详细信息，请参阅以下 sql 表图像：

![在此处输入图像描述](https://i.stack.imgur.com/o5sSV.png)

但我不知道如何将此分层数据绑定到嵌套中继器。这是我的代码：

```
 <!--Nested Repeater Section-->
    <asp:Repeater ID="ServiceDetailsRepeater" runat="server" 
        onitemdatabound="ServiceDetailsRepeater_ItemDataBound">
    <ItemTemplate>
        <asp:HiddenField ID="service_id" runat="server" Value='<%#Eval("Id")%>'/>
    <h3><a name='<%#Eval("Id")%>'></a><%#Eval("Service_name")%></h3>
    <img src='<%# "images/"+ Eval("ImageName")%>' alt="picture" width="48" height="48" class="img" />
    <p><%#Eval("Service_desc")%></p>
    <div id="Div1" class="clr" runat="server">&nbsp;</div>
     <div id="Div2" class="box" runat="server">
        <div id="Div3" class="box_t" runat="server">
            <asp:Panel ID="Panel_ServiceFeature" runat="server" class="box_b">
        <h2>Features</h2>
        <ul style="font-family:Arial, Helvetica, sans-serif;font-size:11px;color:#5f5f5f">
            <asp:Repeater ID="ServiceFeatureRepeater" runat="server">
            <ItemTemplate>
            <li><%#Eval("Feature_Text")%></li>
            </ItemTemplate>
            </asp:Repeater>
            </ul>
            </asp:Panel>
    </div>
  </div>
   <div id="Div5" class="clr" runat="server">&nbsp;</div>
   <div id="Div6" class="box" runat="server">
        <div id="Div7" class="box_t" runat="server">
            <asp:Panel ID="Panel_ServiceCharge" runat="server" class="box_b">
        <h2>Charges</h2>
        <table style="font-family:Arial, Helvetica, sans-serif;font-size:11px;color:#5f5f5f">
        <tr><td></td>
        <td>Rs.</td><td>&nbsp;</td><td align="left">Months</td></tr>
        <asp:Repeater ID="ServiceChargeRepeater" runat="server">
        <ItemTemplate>
        <tr>
        <td><img src="images/sub_nav.gif" width="18px" height="14px" alt=""/></td>
        <td>Rs. <%#String.Format("{0:#,###}", Eval("Charges_Per_Month"))%></td>
        <td>&nbsp;</td>
        <td><%#Eval("No_Of_Month")%> Months</td>
        </tr>
            </ItemTemplate>
            </asp:Repeater>
        </table>
            </asp:Panel>
  </div>
 </div>
 <div id="Div9" class="clr" runat="server"></div>
    </ItemTemplate>
    </asp:Repeater>
  <!--End Section--> 
```

最后，[我的网站页面](http://ominvestment.co.in/services.aspx)，这是我的实时网站服务页面视图。此页面是静态的，但现在我想将此服务详细信息与数据库绑定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-29T14:47:15.650

一种方法是简单地将`DataSource`内部的属性绑定`Repeater`到合适的集合。例如：

```
 <asp:Repeater ID="ServiceDetailsRepeater" runat="server" 
        DataSourceID="SqlDataSource1">

     <asp:Repeater ID="ServiceFeatureRepeater" runat="server" 
        DataSource="<%# DatabaseHelper.GetFeatures(Eval("Id")) %>">
        ...
     </asp:Repeater>

     <asp:Repeater ID="ChargesRepeater" runat="server" 
        DataSource="<%# DatabaseHelper.GetCharges(Eval("Id")) %>">
        ...
     </asp:Repeater>

</asp:Repeater> 
```

> 我还检查了是否没有发现特定服务的功能或费用，然后面板必须关闭。所以我直接从后面的代码做

**更新**

如果您更愿意从代码隐藏中执行此操作，请继续，但您也可以通过数据绑定 Repeater 的`Visible`属性以声明方式执行此操作，例如：

```
 ...
     <asp:Repeater ID="ServiceFeatureRepeater" runat="server" 
        DataSource="<%# DatabaseHelper.GetFeatures(Eval("Id")) %>"
        Visible="<%# DatabaseHelper.HasFeatures(Eval("Id")) %>"
        >
        ...
     </asp:Repeater>
    .... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T22:27:50.617

```
if (!Page.IsPostBack)
            {
                ServiceListRepeater.DataSource = DatabaseHelper.GetSummaryOfActiveServices();
                ServiceListRepeater.DataBind();
                ServiceDetailsRepeater.DataSource = DatabaseHelper.GetSummaryOfActiveServices();
                ServiceDetailsRepeater.DataBind();
            }

protected void ServiceDetailsRepeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
    {
        RepeaterItem item = e.Item;
        if ((item.ItemType == ListItemType.Item) ||(item.ItemType == ListItemType.AlternatingItem))
        {
            HiddenField service_id = (HiddenField)item.FindControl("service_id");
            Repeater service_features = (Repeater)item.FindControl("ServiceFeatureRepeater");
            service_features.DataSource = DatabaseHelper.GetFeatureSummary(int.Parse(service_id.Value.ToString()));
            service_features.DataBind();
            if (service_features.Items.Count == 0)
            { 
                Panel Panel_ServiceFeature = (Panel)item.FindControl("Panel_ServiceFeature");
                Panel_ServiceFeature.Visible = false;
            }
            Repeater service_charges =(Repeater)item.FindControl("ServiceChargeRepeater");
            service_charges.DataSource = DatabaseHelper.GetChargeSummary(int.Parse(service_id.Value.ToString()));
            service_charges.DataBind();
            if (service_charges.Items.Count == 0)
            {
                Panel Panel_ServiceCharge = (Panel)item.FindControl("Panel_ServiceCharge");
                Panel_ServiceCharge.Visible = false;
            }
        }
    } 
```

# php - PHP（或者 MySQL）锁

> ID：16195155
> 
> 赞同：0
> 
> 时间：2013-04-24T14:51:49.693
> 
> 标签：php, mysql, synchronization, locking

我有一个应用程序：

*   在服务器上调用 PHP 脚本。
*   如果行中的特定值设置为 false，PHP 脚本会发出 MySQL 请求，返回 MySQL 表中的一行。
*   PHP 脚本修改该行并将值设置为 true。

但是，我想象在多处理器服务器中，脚本可能会在两个内核上同时执行；因此，两个脚本尝试访问表中的同一行可能会出现问题，即使理想情况下它应该仅可用于其中一个脚本。

我想我的问题是，有什么方法可以在特定行上创建一个锁，以便一次只能由 PHP 脚本的一个实例访问？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:59:22.647

MySQL 的默认行为可能足以解决您的问题： [http ://dev.mysql.com/doc/refman/5.0/en/internal-locking.html](http://dev.mysql.com/doc/refman/5.0/en/internal-locking.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:45:58.533

只需使用事务。

```
BEGIN WORK;
...sql statements...
COMMIT; 
```

如果您使用的是 MyISAM，则可以使用`LOCK TABLES`，但它效率低下，因为它锁定了整个表，而不仅仅是一组行。

# android - 我在这个 Parcelable 类中做错了什么？

> ID：16195163
> 
> 赞同：2
> 
> 时间：2013-04-24T14:52:09.733
> 
> 标签：android, parcelable

我正在尝试启动一个新的 Activity 并向 Intent 添加一个自定义 Parcelable 对象。显然这不起作用：

班级：

```
public class TestObject implements Parcelable{

private String mString;
private int mInt;
private List<String> mList;

public TestObject() {
    this.mString = "This is a String";
    this.mInt = 777;
    mList = new ArrayList<String>();
    for(int i=0; i<100; i++){
        mList.add(String.valueOf(i));
    }
}

public TestObject(Parcel in) {
    setmInt(in.readInt());
    setmString(in.readString());
    mList = new ArrayList<String>();
    in.readStringList(mList);

}

public void setmString(String mString) {
    this.mString = mString;
}

public void setmInt(int mInt) {
    this.mInt = mInt;
}

public String getmString() {
    return mString;
}

public int getmInt() {
    return mInt;
}

@Override
public int describeContents() {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public void writeToParcel(Parcel dest, int flags) {
    dest.writeString(mString);
    dest.writeInt(mInt);
    dest.writeStringList(mList);

}

public static final Parcelable.Creator CREATOR = new Parcelable.Creator() {
    public TestObject createFromParcel(Parcel in) {
        return new TestObject(in); 
    }

    public TestObject[] newArray(int size) {
        return new TestObject[size];
    }
}; 
```

}

第一活动：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    TestObject object = new TestObject();
    Intent i = new Intent(this, SecondActivity.class);
    Debug.startMethodTracing("parcelable");
    i.putExtra("object", object);
    startActivity(i);
} 
```

第二个活动：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Intent i = getIntent();
    TestObject ob = (TestObject) i.getParcelableExtra("object");
    Debug.stopMethodTracing();
    Log.d("object string", "string: " + ob.getmString());

} 
```

问题在于`List<String>`...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T16:15:31.140

问题是您将变量写入 Parcel 的顺序与读取它们的顺序不同。你先写 mString 但先读 mInt 。这将起作用：

```
@Override
public void writeToParcel(Parcel dest, int flags) {
    dest.writeString(mString);
    dest.writeInt(mInt);
    dest.writeStringList(mList);
}

public TestObject(Parcel in) {
    setmString(in.readString());
    setmInt(in.readInt());
    mList = new ArrayList<String>();
    in.readStringList(mList);
} 
```

顺便说一句，不要为 CREATOR 使用原始类型，而是使用它：

```
public static final Parcelable.Creator<TestObject> CREATOR = new Parcelable.Creator<TestObject>() {
        public TestObject createFromParcel(Parcel in) {
            return new TestObject(in); 
        }

        public TestObject[] newArray(int size) {
            return new TestObject[size];
        }
    }; 
```

# knockout.js - 淘汰赛使用 2 个组合框

> ID：16195165
> 
> 赞同：0
> 
> 时间：2013-04-24T14:52:11.490
> 
> 标签：knockout.js

我正在使用 2 个实体 -> Type 和 Domaine 希望两者都有一个 NumeroType。

```
// MODEL TYPE
var TypeModel = function(data) {
    var self = this;
    this.Id = ko.observable();
    this.NumeroType = ko.observable();
    this.NomType = ko.observable();
    ko.mapping.fromJS(data, {}, self);
};

// MODEL DOMAINE 
var DomaineModel = function(data) {
    var self = this;
    this.Id = ko.observable();
    this.NumeroType = ko.observable();
    this.NumeroDomaine = ko.observable();
    this.NomType = ko.observable();
    ko.mapping.fromJS(data, {}, self);
}; 
```

我想在我的选择框中将所有 Domaine 希望显示为相同的 NumeroType，并在更改时剔除。尝试了很多东西，但它不起作用......我是淘汰赛的新手......

```
<select name="NumeroType" id="NumeroType" data-bind="options: Type, 
                            optionsText: 'NomType',
                            optionsValue: 'NumeroType',
                            value: NumeroType,
                            optionsCaption: '---- Type ----'">                  
                    </select>
                    <select name="NumeroDomaine" id="NumeroDomaine" data-bind="options: Domaine, 
                            optionsText: 'NomType',
                            optionsValue: 'NumeroDomaine',
                            value: NumeroDomaine,
                            optionsCaption: '---- Domaine ----'">
                    </select> 
```

# asp.net - 使用带有实体框架的存储过程来选择父实体中的子对象

> ID：16195170
> 
> 赞同：0
> 
> 时间：2013-04-24T14:52:21.377
> 
> 标签：asp.net, entity-framework, stored-procedures, ado.net

如果我正在使用实体框架并且我有一个与子表具有一对多关系的父表，并且我想使用存储过程来返回父级的子级，我是否会向我的父模型添加一个新属性（例如GetChildren）并使用函数导入，然后调用该属性而不是默认的“子”实体来使用我的存储过程？

这是否可能，如果可以，是否有任何教程的好链接？不知道我应该搜索什么以及如何完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:10:50.350

It seems that you don't want to use a navigation **property** but a loading **method**.

If yes, imho, such a method should be at DAL or repository level not at business level. So, as a pseudo implementation, your implementation should look like this:

```
public class MasterBC {
    public int Id {get; set;}
    //...
}

public class ChildBC {
    public int Id {get; set;}
    //...
}

public class DALContext : DbContext() {
    IDbSet<MasterBC> Masters {get; set;}

    IEnumerable<ChildBC> GetChildren(Int32 id) {
        return this.Database.SqlQuery<ChildBC>("exec usp_name {0}", id);
    }
} 
```

But, why not use a navigation property ?

# c# - SpecFlow 步骤的布尔参数

> ID：16195172
> 
> 赞同：8
> 
> 时间：2013-04-24T14:52:27.643
> 
> 标签：c#, specflow

在 SpecFlow 中，我想检查步骤定义中是否存在字符串，目前我正在做一些笨拙的事情，比如这个人为的例子：

```
[Given(@"Foo ( bar)?")]
public void GivenFoo(string bar)
{
    if (bar == " bar")
    {
        // do bar
    }
} 
```

但是，我想做这样的事情：

```
[Given(@"Foo ( bar)?")]
public void GivenFoo(bool bar)
{
    if (bar)
    {
        // do bar
    }
} 
```

但我不知道怎么做，这可能吗？如果可以，怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-02-02T23:35:01.550

你绝对可以做那种事情，使用一种`StepArgumentTransformation`方法。您仍然必须编写解析器逻辑，但您可以将其隔离到一个唯一目的是执行该解析的方法中。

示例功能文件：

```
Feature: I win if I am Batman

Scenario: Happy
    Given I am the Batman
    Then I defeat the Joker

Scenario: Sad
    Given I am not the Batman
    Then I am defeated by the Joker 
```

Specflow 绑定 (C#)：

```
[Binding]
public class IWinIfIAmBatmanFeature
{
    private bool iAmBatman;

    [StepArgumentTransformation(@"(am ?.*)")]
    public bool AmToBool(string value)
    {
        return value == "am";
    }

    [Given(@"I (.*) the Batman")]
    public void WhoAmI(bool amIBatman)
    {
        iAmBatman = amIBatman;
    }

    [StepArgumentTransformation(@"(defeat|am defeated by)")]
    public bool WinLoseToBool(string value)
    {
        return value == "defeat";
    }

    [Then(@"I (.*) the Joker")]
    public void SuccessCondition(bool value)
    {
        Assert.AreEqual(iAmBatman, value);
    }
} 
```

关键因素是您的`Given`子句中的正则表达式匹配由 step 参数转换匹配。因此`I (.*) the Batman`，如果捕获匹配 StepArgumentTransformation 的参数中的正则表达式，就像它在属性中所做的那样，`AmToBool`那么这就是使用的转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T06:07:54.757

根据您的问题和对 Jakub 答案的评论，您似乎正在尝试编写一个可以涵盖通过您的网站的多个用户旅程的单个步骤。SpecFlow 并不是真正为此而设计的，它可能表明您应该尝试改进场景/功能的结构。

要直接回答您的问题，我不相信有一种方法可以根据您的步骤定义中某些字符串的存在来推断布尔值。

如果您想坚持这条路线，那么您最初的示例可能是您最好的选择。

但是，我建议您**不要**采用这种方法，而是考虑重组您的步骤定义，以便您可以将它们链接在一起，并在不同场景中重复使用它们。我实际上正在努力想一个适合您的解决方案的示例步骤定义。

多步骤方法的示例可能如下所示：

```
Given I have logged in as an existing user //1
And I have started my 6-step registration process //2
And I have filled in valid address values on step 1 //3
And I have left the fields blank on step 2 //4
... etc
When I save my registration 
```

你的步骤是：

1.  导航到登录页面，以有效用户身份登录
2.  导航到第 1 步
3.  使用有效输入填写字段，单击“下一步”
4.  点击下一步'

您只需要确保每个步骤尽可能独立于其他步骤，这样您就可以用一个略有不同的步骤（对于新场景）替换一个步骤，而不会影响其他步骤。

使用这种方法，您仍然可能会遇到复杂（并且可能非常冗长）的场景，但我认为这比试图变得聪明并将尽可能多的内容打包到单个步骤定义中是更好的解决方案。您可能最终会遇到不可读的场景，并且代码可能也很难阅读/维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:56:44.250

您是否在寻找：

```
[Given(@"I do something (times) times")]
public void GivenIDoSomething(int times)
{
} 
```

否则这似乎就足够了

```
[Given(@"I do something twice")]
public void GivenIDoSomethingTwice()
{
} 
```

编辑

我认为`if`您实际上想要分离步骤，而不是在步骤中声明。

# visualization - 空间数据可视化详细程度

> ID：16195174
> 
> 赞同：4
> 
> 时间：2013-04-24T07:14:55.850
> 
> 标签：visualization

我有一个具有不同属性的 3D 点云数据集，到目前为止我将其可视化为点，并且我希望根据与集合的距离来获得 LOD。我希望能够从远处以更少和更大的点获得广义视图，并且当我放大时，我希望自动出现更多正确间隔的点。

有点像下面这个视频，行为明智：http: [//vimeo.com/61148577](http://vimeo.com/61148577)

我认为一种解决方案是使用自适应八叉树，但我不确定这是否是一个好的解决方案。我一直在研究具有无缝转换的层次聚类，但我不确定我应该采用哪种解决方案来满足我的目标。

关于从哪里开始的任何想法和提示？还是一些具体的方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:31:19.863

您链接的视频使用 2D 元球。当元球聚集在一起时，它们会形成斑点，而不是更大的圆圈。你同意吗？

在继续之前，您应该阅读元球介绍。只需谷歌 2D 元球。

所以，希望您已经阅读了元球阈值和衰减函数。你的衰减函数应该有一个*半径*——函数下降到零的距离。

我们可以通过调整阈值和半径来实现 LOD 效果。基本上，当你缩小时，增加半径，以便点对更大的区域产生影响并开始聚集在一起。此外，调整阈值，使点密度不足的区域开始消失。

我找到了这个现有的 jsfiddle 2D metaballs 演示，并对其进行了修改以展示 LOD：

*   LOD 0：单个点为圆形。( [http://jsfiddle.net/TscNZ/370/](http://jsfiddle.net/TscNZ/370/) )
*   LOD 1：孤立点开始缩小，但点簇开始形成斑点。( [http://jsfiddle.net/TscNZ/374/](http://jsfiddle.net/TscNZ/374/) )
*   LOD 2：孤立点已消失。斑点越来越少。（将上面的 URL 更改为 jsfiddle 修订版 377）
*   LOD 3：斑点更少甚至更大。（将上面的 URL 更改为 jsfiddle 修订版 380）

正如您在不同的 jsfiddle 版本中所见，更改 LOD 只需要调整几个变量：

```
threshold = 1,
max_alpha = 1,
point_radius = 10, 
```

许多元球文章没有涉及的关键点：您需要使用一个约定，其中只有*高于*阈值的值才被视为元球“内部”。然后，当远远缩小时，您需要将阈值设置为*高于*衰减函数的峰值。这将导致孤立点完全消失，只留下可见的团块。

渲染元球本身就是一个完整的话题。这个 jsfiddle 演示采用了一种非常低效的蛮力方法，但也有更有效的“行进广场”。

# java - 为什么投射会在本地工作而不是在服务器上工作？

> ID：16195180
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:52:57.517
> 
> 标签：java, tomcat, imap, jakarta-mail

这是一个特定的问题，但我使用 javamail 连接到 IMAP 服务器以提取一些消息，当我在命令行中本地运行我的程序时，它运行得很好，但是当它上传到 tomcat 运行时，我得到这个转换错误：

```
java.lang.ClassCastException: javax.mail.internet.MimeMultipart cannot be cast to javax.mail.internet.MimeMultipart 
```

代码行是：

```
MimeMultipart mp;
mp = ((MimeMultipart)message.getContent()); 
```

消息定义为：

```
Message message = null;
message = folder.getMessageByUID(14299); 
```

我不知道为什么我可以在本地运行它时投射它，但它在服务器上崩溃。我两次都使用相同的消息，它是硬编码的，所以我不可能提取不是 MimeMultipart 的消息。有任何想法吗？如果您需要我发布其他内容，我会的，只是问。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:02:19.097

这可能是一个 Classloader 问题，请参阅[此问题](https://stackoverflow.com/questions/826319/classcastexception-when-casting-to-the-same-class)以了解几种可能的解决方案：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:02:46.837

根据我们在当前问题状态下可用的信息，获得解决方案的最佳方法是验证加载 MimeMultipart 的 ClassLoader：

```
ClassLoader myClassLoader = new MyClass().getClass().getClassLoader(); 
```

但是，沿着这条路走下去可能会比预期花费更长的时间。

这很有可能是您的 Tomcat 安装中的本地化错误。如果您能够在**GlassFish**等不同的服务器上试用它，或者**全新安装 Tomcat**，您可能会发现问题已解决。您已经通过命令行确认您的程序没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:03:23.943

类型的错误消息：

```
java.lang.ClassCastException: CLASS cannot be cast to CLASS 
```

通常表示类加载器问题。您正在尝试从一个 ClassLoader 转换为驻留在另一个 ClassLoader 中的实例。

我猜 javamail jar 在你的 webapp 的 /WEB-INF/lib 文件夹中。在这种情况下，如果它们也在 tomcat 的 lib 文件夹中，您将收到该确切消息。

[有关 tomcat 类加载的更多信息，请参阅此链接。](https://tomcat.apache.org/tomcat-7.0-doc/class-loader-howto.html)

解决此问题的一种方法是从您的 tomcat 安装中删除 javamail 库并将它们保留在 webapp 中，或者不将它们包含在战争中。

# delphi - Delphi XE4 iOS可以在Delphi中构建后台应用吗

> ID：16195184
> 
> 赞同：0
> 
> 时间：2013-04-24T14:53:07.463
> 
> 标签：delphi, firemonkey, firemonkey-fm2, delphi-xe4

我需要为iOS构建一个必须在后台运行的项目，理想情况下在手机开机或重新启动时自动启动，这在Delphi XE4中是否可行，还是我必须使用xcode？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:44:07.153

我不确定您可以在 XE4 中具体实现什么，但 iOS 中的后台应用程序有一些限制。你不能在开机或重启时自动启动某些东西，大多数应用程序只允许在关闭后运行一个简短的任务。

唯一的例外是以下类别的应用程序：

*   在后台向用户播放有声内容的应用程序，例如音乐播放器应用程序
*   让用户随时了解其位置的应用程序，例如导航应用程序
*   支持互联网协议语音 (VoIP) 的应用程序
*   需要下载和处理新内容的报亭应用
*   从外部配件接收定期更新的应用程序

# python - Python & CV2：我如何用鼠标在图像上画一条线然后返回线坐标？

> ID：16195190
> 
> 赞同：3
> 
> 时间：2013-04-24T14:53:18.897
> 
> 标签：python, opencv

我希望在逐帧浏览的视频上画一条线，以便计算线的角度。我制作了一个非常简单的脚本，它逐步浏览视频并尝试收集数组中每个图像中单击的点，但即使这似乎也不起作用......这是代码：

```
import cv2, cv

cap = cv2.VideoCapture('video.avi')

box = []
def on_mouse(event, x, y, flags):
    if event == cv.CV_EVENT_LBUTTONDOWN:
        print 'Mouse Position: '+x+', '+y
        box.append(x, y)

#cv2.rectangle(img, pt1, pt2, color)
#cv2.line(img, pt1, pt2, color) 
drawing_box = False

cv.SetMouseCallback('real image', on_mouse, 0)
count = 0
while(1):
    _,img = cap.read()
    img = cv2.blur(img, (3,3))

    cv2.namedWindow('real image')
    cv2.imshow('real image', img)

    if cv2.waitKey(0) == 27:
        cv2.destroyAllWindows()
        break
print box 
```

任何帮助表示赞赏！

非常感谢

约翰

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T08:12:32.863

这是我找到的修复：

```
def on_mouse(event, x, y, flags, params):
    if event == cv.CV_EVENT_LBUTTONDOWN:
        print 'Start Mouse Position: '+str(x)+', '+str(y)
        sbox = [x, y]
        boxes.append(sbox)
    elif event == cv.CV_EVENT_LBUTTONUP:
        print 'End Mouse Position: '+str(x)+', '+str(y)
        ebox = [x, y]
        boxes.append(ebox)

count = 0
while(1):
    count += 1
    _,img = cap.read()
    img = cv2.blur(img, (3,3))

    cv2.namedWindow('real image')
    cv.SetMouseCallback('real image', on_mouse, 0)
    cv2.imshow('real image', img)

    if count < 50:
        if cv2.waitKey(33) == 27:
            cv2.destroyAllWindows()
            break
    elif count >= 50:
        if cv2.waitKey(0) == 27:
            cv2.destroyAllWindows()
            break
        count = 0 
```

# r - 使用参考类作为因子的水平

> ID：16195194
> 
> 赞同：2
> 
> 时间：2013-04-24T14:53:24.390
> 
> 标签：r, reference-class

有没有人有使用参考类作为因素水平的经验？这是我在我的一个`data.frame`包中添加“类外键”支持的目标的一步。

我最终希望创建一个`data.frame`可以将与因子关联的代码作为整数存储的方法，但该因子的级别实际上是参考类对象，而不是通常使用的字符向量因子。我已经能够找到一些关于使用 S4 对象作为因子级别的信息，但这些技术似乎不适用于参考类。

例如，一个简单的：

```
> myClass <- setRefClass("MyClass", fields=list(a="numeric", b="character"))
> myObj <- myClass$new(a=1, b="test")
> factor(myObj)
Error in unique.default(x) : unique() applies only to vectors
> as.character(myObj)
Error in as.vector(x, "character") : 
  cannot coerce type 'environment' to vector of type 'character'
> as.character.MyClass <- function(x){ x$b }
> as.character(myObj)
[1] "test"
> factor(myObj)
Error in unique.default(x) : unique() applies only to vectors
>
> unique.MyClass <- function (x, incomparables = FALSE, ...) { unique(as.character(x)) }
> factor(myObj)
Error in as.vector(x, mode) : invalid 'mode' argument
> traceback()
2: as.vector(exclude, typeof(x))
1: factor(myObj) 
```

似乎没有任何工作。看起来，在我最好的情况下，我可以到达`factor()`分析`exclude`参数的行：

```
exclude <- as.vector(exclude, typeof(x)) 
```

此时一切都崩溃了，因为我不允许创建“S4”类型的向量。

任何关于如何解决这个问题的想法，或者 - 甚至更好 - 以`data.frame`友好的方式将整数映射到引用类对象的替代方法将不胜感激！

* * *

**编辑：**针对@Aaron 的以下问题：

这里的简单解决方案是将整数存储在中`data.frame`，然后维护一个单独的列表/`data.frame`负责将这些 ID 映射到其他一些数据（例如引用类对象）。这将保留完成我需要的所有必要数据，但对我来说不太优雅，原因如下：

1.  我正在设想一种解决方案，它允许我打印出引用类对象本身的某些部分，而不是 ID。例如，如果我将员工 ID（整数）映射到“员工”类，我希望`data.frame`打印员工的姓名，而不是他们的 ID。
2.  我希望能够直接从`data.frame`. 以同样的方式，`as.character(myDataFrame$someColumn)`这会给我该列的*标签*（假设它是一个因素），而不是实际存储在`data.frame`.

同样，如果有更好的方法来解决这个问题，我非常愿意接受这个问题的替代解决方案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:48:06.190

我认为这可以通过`myFactor`使用必要的方法创建一个新类来完成。`format`似乎是您在数据框中打印所需的；您可以轻松添加`print`或选择其他方法。我对 S3 方法最满意，所以这就是我在这里所做的。

在这里，我设置了您的参考类和该类的`format`功能`myFactor`。

```
myClass <- setRefClass("MyClass", fields=list(a="numeric", b="character"))
format.myFactor <- function(obj, ...) {
  n <- sapply(levels(obj), function(x) x[["b"]])
  n[obj]
} 
```

在这里，我制作了两个新的参考对象，并将它们用作我的新`myFactor`对象的关卡。

```
myObj <- myClass$new(a=1, b="test")
myObj2 <- myClass$new(a=4, b="testagain")
foo <- structure(c(2,1,2), levels=c(myObj, myObj2), class=c("myFactor","numeric"))
d <- data.frame(x=foo) 
```

然后打印得很好。

```
> d
          x
1 testagain
2      test
3 testagain 
```

# jquery - 在 AngularJS 中创建 JSONP API 并使用 jQuery

> ID：16195199
> 
> 赞同：3
> 
> 时间：2013-04-24T14:53:34.863
> 
> 标签：jquery, api, angularjs, jsonp, angularjs-scope

现在我已经用 JQuery 创建了一个 JS API，但我想知道它是否可以用 AngularJs 来完成。

例如，想象一个像下面这样的小 API：

```
var $myapi= $myapi|| {};
;(function($, window, document, undefined){
    _call_myapi_jsonp: function(params,controller,action,eventName){
    if (!params) params = {};

    var url = this.urls.base+"/"+controller+"/"+action+"?callback=?";
    if (params.callback)
        url = this.urls.base+"/"+controller+"/"+action+"?callback="+params.callback;
    url = url + "&_"+new Date();
    delete params.callback;
    $.ajax({
        url: url,
        data: params,
        crossDomain:true,
        dataType:'jsonp',
        cache:false,
        ajaxOptions: {cache: false},
        jsonp: params.callback?false:true,
        success:function(data,status){
            if (eventName && eventName!=""){
                $($myapi).trigger(eventName,data);
            }
        }
    });
},
    level: {
    list: function(params){
        params = params || {};
        params.max = params.max!=undefined?parseInt(params.max):$myapi.defaults.levels.max;
        params.page = params.page!=undefined?parseInt(params.page):$myapi.defaults.levels.page;
        params.showActives = params.showActives!=undefined?params.showActives:$myapi.defaults.levels.showActives;
            $myapi._call_myapi_jsonp(params,"level","listJSONP","myapi.level.list");
        },
        info: function(params){
            $myapi._call_myapi_jsonp(params,"level","showJSONP","myapi.level.info");
        }
    }
} 
```

我一直在搜索 AngularJs 文档并在 Google 中搜索，但我还没有找到一种方法可以在 AngularJS 中编写 Jquery 中的代码。我想也许可以使用 $routeProvider 来完成，但是我没有找到任何示例或文档说明如何使用 $routeProvider 在不显示模板或重定向到某个地方的情况下进行 jsonp 调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-28T04:16:02.037

听起来您需要的是一项服务，类似于这里正在做的事情：

[从服务器获取数据的推荐方式](https://stackoverflow.com/questions/11850025/recommended-way-of-getting-data-from-the-server/11850027#11850027)

[http://jsfiddle.net/wpPhY/](http://jsfiddle.net/wpPhY/)

但包括`$resource`：

[http://docs.angularjs.org/api/ngResource.$resource](http://docs.angularjs.org/api/ngResource.$resource)

这是查询 Twitter 的 JSONP 服务的基本示例（取自[http://egghead.io](http://egghead.io)）：

**JSFiddle 演示：http:** [//jsfiddle.net/gavinfoley/DJ6da/](http://jsfiddle.net/gavinfoley/DJ6da/)

```
angular.module('Twitter', ['ngResource']);

angular.module('Twitter')
.controller('TwitterCtrl', ['$scope', '$resource', function ($scope, $resource) {
    $scope.twitter = $resource('http://search.twitter.com/:action',
        {action:'search.json', q:'angularjs', callback:'JSON_CALLBACK'},
        {get:{method:'JSONP'}});

    $scope.doSearch = function () {
        $scope.twitterResult = $scope.twitter.get({q:$scope.searchTerm});
    };
}]); 
```

此外，将 Breeze 与 Angular 结合使用也值得一看。我自己没有使用过它，但你可以用它创建一些非常酷的 CRUD 应用程序：

[http://www.breezejs.com/samples/todo-angular](http://www.breezejs.com/samples/todo-angular)

但是，如果您希望从 jQuery 访问在特定 Angular 控制器（或范围）内定义的函数或属性，请查看 Plnkr 和下面的代码。

老实说，如果可能的话，我真的不会走这条路。最好从您的解决方案中完全删除 jQuery 并坚持使用 Angular。这意味着编写您的 Angular API 或服务并使用 Angular 控制器/指令等使用它。

换句话说，如果你打算在你的应用程序中使用 Angular，那么就选择“all Angular”。不要试图与 jQuery 混搭。它只会减慢您的速度并使您的代码更难维护。

**完整的 Plnkr 演示：** [http ://plnkr.co/edit/X5SfKD?p=preview](http://plnkr.co/edit/X5SfKD?p=preview)

**HTML**

```
<!DOCTYPE html>
<html data-ng-app="myApp">
  <head>
    <link rel="stylesheet" href="style.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.6/angular.min.js"></script>
    <script src="myApp.js"></script>
    <script src="script.js"></script>
  </head>
  <body>    
    <div id="parent" data-ng-controller="ParentCtrl">     
        <span id="someSpan">This is {{name}}.</span>    
        <div id="child" data-ng-controller="ChildCtrl">This is {{name}}.</div>    

        Get latest tweet for: <input type="text" data-ng-model="twitterUser" />

        <button data-ng-click="getLatestAngularTwitterPost()">Get Tweet</button><br/><br/>

        Latest {{searchTerm}} Twitter post:
        <div>        
            <img id="twitterProfileImage" data-ng-src="{{profileImage}}" />
            <span data-ng-bind-html-unsafe="tweet" id="tweet"></span>
        </div>    
    </div>    
  </body>
</html> 
```

**Angular 应用程序 - myApp.js**

```
angular.module('myApp', []);

angular.module('myApp')
.controller('ParentCtrl', function ($scope,  $http) {
    $scope.name = "parent";    
    $scope.testFunc = function () {
        return "Test is working."
    };
    $scope.twitterUser = "AngularJS";
    $scope.tweet;
    $scope.profileImage;
    $scope.searchTerm;

    // Returns latest post on Twitter from AngularJS
    $scope.getLatestAngularTwitterPost = function (callbackFunc) {        
        $scope.searchTerm = $scope.twitterUser;        
        var url = "http://api.twitter.com/1/users/show.json";

        $http.jsonp(url, {
          params: {
            callback: 'JSON_CALLBACK',
            screen_name: $scope.twitterUser
          }
        })
        .success(function(data){
            if(callbackFunc){
                console.log("Passing twitter results to callback: " + callbackFunc.name);
                return callbackFunc(data);
            }

            $scope.tweet = data.status.text;
            $scope.profileImage = data.profile_image_url;          
        })
        .error(function() {
            $scope.tweet = "<strong>Error: could not make JSONP request to Twitter.</strong>"; 
        });
    };
});

angular.module('myApp')
.controller('ChildCtrl', function ($scope) {
    $scope.name = "child";
}); 
```

**jQuery - script.js**

```
// Ex. of how to call methods and update properties 
// in Angular controllers, from jQuery
$(function () {
    // Get Angular controller "ParentCtrl".
    // Could also use $('#someSpan').scope(); to get "ParentCntl" scope
    var $scopeParentCtrl = $('#parent').scope();
    // Get Angular controller "ChildCtrl".
    var $scopeChildCtrl = $('#child').scope();

    // Update the "name" property in Angular controller "ParentCtrl"
    $scopeParentCtrl.$apply(function(){
      $scopeParentCtrl.name = "Joe";
      console.log("Parent name changed to " + $scopeParentCtrl.name);
    });

    // Update the "name" property in Angular controller "ChildCtrl"
    $scopeChildCtrl.$apply(function(){
      $scopeChildCtrl.name = "Gavin";
      console.log("Child name changed to "+ $scopeChildCtrl.name);
    });

    // Call the "testFunc" function in Angular conroller "ParentCtrl"
    console.log($scopeParentCtrl.testFunc());

     // Call the JSONP function in Angular controller "ParentCtrl"
    $scopeParentCtrl.getLatestAngularTwitterPost(jsonpCallback);      
});

function jsonpCallback(data) {
    var $scopeParentCtrl = $('#parent').scope();
    $scopeParentCtrl.tweet = data.status.text;
    $scopeParentCtrl.profileImage = data.profile_image_url;
} 
```

# javascript - 在 Durandal 框架中使用 Typeahead 创建自动完成字段

> ID：16195200
> 
> 赞同：1
> 
> 时间：2013-04-24T14:53:36.370
> 
> 标签：javascript, twitter-bootstrap, knockout.js, durandal

我正在尝试使用预先输入（twitter bootstrap）实现自动完成输入字段。这个自动完成字段应该是模态的，但我似乎无法让它工作！它还必须是可通过剔除观察到的，因为当您选择一个值时，其他字段应该更新为。

所以我有点想在模态中做到这一点！

HTML

```
<div class="messageBox">
    <div class="modal-header">
        <h2>Adding a repairline</h2>
    </div>
    <div class="modal-body" style="width: 35em;">
        <form data-bind="submit: ok">
            <fieldset>
                <!--<legend></legend> Deze niet toevoegen uitlijning is dan niet goed!-->
                <div class="row-fluid">
                    <div class="span6">
                        <div>   
                            <label>
                                Description:
                                <input type="text" id="testen" data-provide="typeahead" />

                            </label>
                        </div>
                        <div>
                            <label>
                                Code:
                                <input data-bind="value: Code" required />
                            </label>
                        </div>          
                <div>
                    <input class="btn btn-primary" type="submit" value="Add" />
                </div>
            </fieldset>
        </form>
    </div>
    <div class="modal-footer">
        <button class="btn" data-bind="click: closeModal">Cancel</button>    
    </div>
</div> 
```

JS

```
define(function (require) {
    var dataservice = require('services/dataservice'),
        allCustomers = ko.observableArray([]),
        repairlines = ko.observableArray([]);

    function init() {
        dataservice = new dataservice('api/data');
        dataservice.getAllRows('AllCustomers').then(function (data) {
            data.results.forEach(function (item) {
                allCustomers.push(item);
            });
        }).fail(function () {   
        });

        dataservice.getAllRows('EntireRepairLineLib').then(function (data) {
            data.results.forEach(function (item) {
                repairlines.push(item);
            });
        }).fail(function () {
        });

        $('.testen .typeahead').typeahead({
            name: 'countries',
            prefetch: 'http://twitter.github.io/typeahead.js/data/countries.json',
            limit: 10
        });
    }

    init();

    AddRepairOrderLineModal = function (loggedInEmployee) {
        //later ook customer en repairorder meegeven!
        this.allCustomers = allCustomers;
        this.choosenCustomerId = ko.observable(); //holds the Id of the chosen customer
        this.Description = ko.observable();
        this.Code = ko.observable();
        this.Mat = ko.observable();
        this.Location = ko.observable();
        this.Rep = ko.observable();
        this.Dum = ko.observable();
        this.Dam = ko.observable();
        this.Qty = ko.observable();
        this.Hours = ko.observable();
        this.Tariff = ko.observable();
        this.Costs = ko.observable();
        this.CreationDate = (new Date().getMonth() + 1) + "-" + new Date().getDate() + "-" + new Date().getFullYear();

        this.IsAgreement = ko.observable(true);
        this.IsAuthorized = ko.observable(true);
        this.DoRepair = ko.observable(true);
        this.selectedEmployee = loggedInEmployee;

       /* $(".repairlinename").autocomplete({
           source: repairlines 
        });*/

        $(document).ready(function() {
            alert('done');
            $('#testen').append(' Leroy');
        }); 
    };
    AddRepairOrderLineModal.prototype.ok = function () {
        var jsonObj = [];
        jsonObj.push({
            Description: this.Description(), Code: this.Code(),
            Mat: this.Mat(), Location: this.Location(),
            Rep: this.Rep(), Dum: this.Dum(), Dam: this.Dam(),
            CustomerId: this.choosenCustomerId(), Qty: this.Qty(), Hours: this.Hours(),
            Tariff: this.Tariff(), Costs: this.Costs(), CreationDate: this.CreationDate,
            IsAgreement: this.IsAgreement(), IsAuthorized: this.IsAuthorized(), DoRepair: this.DoRepair(),
        });
        this.modal.close(jsonObj);
    };

    AddRepairOrderLineModal.prototype.closeModal = function () {
        return this.modal.close();
    };
    return AddRepairOrderLineModal;
});

    /*define(['durandal/app','services/dataservice'], function(app,dataservice) {
        AddRepairOrderLineModal = function (loggedInEmployee) {
            //later ook customer en repairorder meegeven!

            this.Description = ko.observable();
            this.Code = ko.observable();
            this.Mat = ko.observable();
            this.Location = ko.observable();
            this.Rep = ko.observable();
            this.Dum = ko.observable();
            this.Dam = ko.observable();
            this.Customer = ko.observable();
            this.Qty = ko.observable();
            this.Hours = ko.observable();
            this.Tariff = ko.observable();
            this.Costs = ko.observable();
            this.CreationDate = (new Date().getMonth() + 1) + "-" + new Date().getDate() + "-" + new Date().getFullYear();

            this.IsAgreement = ko.observable(true);
            this.IsAuthorized = ko.observable(true);
            this.DoRepair = ko.observable(true);
            this.selectedEmployee = loggedInEmployee;
        };

        AddRepairOrderLineModal.prototype.ok = function () {
            var jsonObj = [];
            jsonObj.push({
                Description: this.Description(), Code: this.Code(),
                Mat: this.Mat(), Location: this.Location(),
                Rep: this.Rep(), Dum: this.Dum(), Dam: this.Dam(),
                Customer: this.Customer(), Qty: this.Qty(), Hours: this.Hours(),
                Tariff: this.Tariff(), Costs: this.Costs(), CreationDate: this.CreationDate,
                IsAgreement: this.IsAgreement(), IsAuthorized: this.IsAuthorized(), DoRepair: this.DoRepair()
            });
            this.modal.close(jsonObj);
        };

        AddRepairOrderLineModal.prototype.closeModal = function() {
            return this.modal.close();
        };
        return AddRepairOrderLineModal;
        /*
        http://stackoverflow.com/questions/7537002/autocomplete-combobox-with-knockout-js-template-jquery
        http://jsfiddle.net/rniemeyer/PPsRC/
        *//*
    });

    */ 
```

我希望有人可以帮助我如何做到这一点！来源是repairlines，这些都填写正确

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T17:32:40.603

您需要将 typeahead 输入绑定到视图模型上公开的数组。我不认为你现在正在这样做。

要进行绑定，您应该使用此处找到的敲除引导绑定：http: [//billpull.github.io/knockout-bootstrap/](http://billpull.github.io/knockout-bootstrap/)

包含上述淘汰引导绑定后，您可以在视图中执行此操作：

```
<input type="text" data-bind="typeahead: repairlines" /> 
```

然后确保将修复线添加到 VM 实例。将它添加到您的此参考应该可以解决问题。

```
// this will add the repairlines observable array to your VM instance
this.repairlines = repairlines; 
```

希望这会有所帮助，祝你好运:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T17:29:43.950

我会发表评论，但不能，所以这是我的笔记。在您的示例中，您有同源策略 (SOP) 问题。所以来自推特页面的数据不会被拉进来。这几乎会扼杀这个过程，所以你不会得到任何东西。

我发现如果我包含适当的样式（例如 tt-dropdown-menu 的样式）：

```
<span class="tt-dropdown-menu" style="position: absolute; top: 100%; left: 0px; z-index: 100; display: block; right: auto;"></span> 
```

并有一个功能正常的数据集，它工作正常。这是我的尝试[http://jsfiddle.net/rUdXt/](http://jsfiddle.net/rUdXt/)的一个小技巧，这是一个帮助我的很棒的页面（尤其是样式[http://twitter.github.io/typeahead.js/examples/](http://twitter.github.io/typeahead.js/examples/)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T08:58:36.093

我通过在库中添加一些额外的代码来解决这个问题：[https ://github.com/billpull/knockout-bootstrap](https://github.com/billpull/knockout-bootstrap)

这是 knockout-bootstrap.js，其中 ko.bindingHandlers.typeahead 被重写，因此它接受更新，minLength en 项目。只需加载此脚本。

```
//UUID
function s4() {
    return Math.floor((1 + Math.random()) * 0x10000)
        .toString(16)
        .substring(1);
}

function guid() {
    return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
}

// Outer HTML
(function($){
  $.fn.outerHtml = function() {
    if (this.length == 0) return false;
    var elem = this[0], name = elem.tagName.toLowerCase();
    if (elem.outerHTML) return elem.outerHTML;
    var attrs = $.map(elem.attributes, function(i) { return i.name+'="'+i.value+'"'; }); 
    return "<"+name+(attrs.length > 0 ? " "+attrs.join(" ") : "")+">"+elem.innerHTML+"</"+name+">";
  };
})(jQuery);

// Bind twitter typeahead
ko.bindingHandlers.typeahead = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $element = $(element);
        var allBindings = allBindingsAccessor();
        var typeaheadArr = ko.utils.unwrapObservable(valueAccessor());

        $element.attr("autocomplete", "off")
                .typeahead({
                    'source': typeaheadArr,
                    'minLength': allBindings.minLength,
                    'items': allBindings.items,
                    'updater': allBindings.updater
                });
    }
};

/*
ko.bindingHandlers.typeahead = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {

        var $element = $(element);
        var t = valueAccessor();
        var typeaheadArr = ko.utils.unwrapObservable(valueAccessor());
        var k = allBindingsAccessor().v1;

        $element.attr("autocomplete", "off")
                .typeahead({
                    'source' : typeaheadArr
                });
    }
};
*/

// Bind Twitter Progress
ko.bindingHandlers.progress = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $element = $(element);

        var bar = $('<div/>', {
            'class':'bar',
            'data-bind':'style: { width:' + valueAccessor() + ' }'
        });

        $element.attr('id', guid())
            .addClass('progress progress-info')
            .append(bar);

        ko.applyBindingsToDescendants(viewModel, $element[0]);
    }
}

// Bind Twitter Alert
ko.bindingHandlers.alert = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $element = $(element);
        var alertInfo = ko.utils.unwrapObservable(valueAccessor());

        var dismissBtn = $('<button/>', {
            'type':'button',
            'class':'close',
            'data-dismiss':'alert'
        }).html('&times;');

        var alertMessage = $('<p/>').html(alertInfo.message);

        $element.addClass('alert alert-'+alertInfo.priority)
                .append(dismissBtn)
                .append(alertMessage);
    }
};

// Bind Twitter Tooltip
ko.bindingHandlers.tooltip = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        // read tooltip options
        var tooltipBindingValues = ko.utils.unwrapObservable(valueAccessor());

        // set tooltip title
        var tooltipTitle = tooltipBindingValues.title;

        // set tooltip placement
        var tooltipPlacement = tooltipBindingValues.placement;

        // set tooltip trigger
        var tooltipTrigger = tooltipBindingValues.trigger;

        var options = {
            title: tooltipTitle
        };

        ko.utils.extend(options, ko.bindingHandlers.tooltip.options);

        if (tooltipPlacement) {
            options.placement = tooltipPlacement;
        }

        if (tooltipTrigger) {
            options.trigger = tooltipTrigger;
        }

        $(element).tooltip(options);
    },
    options: {
        placement: "top",
        trigger: "hover"
    }
};

// Bind Twitter Popover
ko.bindingHandlers.popover = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        // read popover options 
        var popoverBindingValues = ko.utils.unwrapObservable(valueAccessor());

        // set popover title 
        var popoverTitle = popoverBindingValues.title;

        // set popover template id
        var tmplId = popoverBindingValues.template;

        // set popover trigger
        var trigger = 'click';

        if (popoverBindingValues.trigger) {
            trigger = popoverBindingValues.trigger;
        }

        // update triggers
        if (trigger === 'hover') {
            trigger = 'mouseenter mouseleave';
        } else if (trigger === 'focus') {
            trigger = 'focus blur';
        }

        // set popover placement
        var placement = popoverBindingValues.placement;

        // get template html
        var tmplHtml = $('#' + tmplId).html();

        // create unique identifier to bind to
        var uuid = guid();
        var domId = "ko-bs-popover-" + uuid;

        // create correct binding context
        var childBindingContext = bindingContext.createChildContext(viewModel);

        // create DOM object to use for popover content
        var tmplDom = $('<div/>', {
            "class" : "ko-popover",
            "id" : domId
        }).html(tmplHtml);

        // set content options
        options = {
            content: $(tmplDom[0]).outerHtml(),
            title: popoverTitle
        };

        if (placement) {
            options.placement = placement;
        }

        // Need to copy this, otherwise all the popups end up with the value of the last item
        var popoverOptions = $.extend({}, ko.bindingHandlers.popover.options, options);

        // bind popover to element click
        $(element).bind(trigger, function () {
            var popoverAction = 'show';
            var popoverTriggerEl = $(this);

            // popovers that hover should be toggled on hover
            // not stay there on mouseout
            if (trigger !== 'click') {
                popoverAction = 'toggle';
            }

            // show/toggle popover
            popoverTriggerEl.popover(popoverOptions).popover(popoverAction);

            // hide other popovers and bind knockout to the popover elements
            var popoverInnerEl = $('#' + domId);
            $('.ko-popover').not(popoverInnerEl).parents('.popover').remove();

            // if the popover is visible bind the view model to our dom ID
            if($('#' + domId).is(':visible')){
                ko.applyBindingsToDescendants(childBindingContext, $('#' + domId)[0]);
            }

            // bind close button to remove popover
            $(document).on('click', '[data-dismiss="popover"]', function (e) {
                popoverTriggerEl.popover('hide');
            });
        });

        // Also tell KO *not* to bind the descendants itself, otherwise they will be bound twice
        return { controlsDescendantBindings: true };
    },
    options: {
        placement: "right",
        title: "",
        html: true,
        content: "",
        trigger: "manual"
    }
}; 
```

在您的 HTML 中执行此操作。

```
<input type="text" data-bind="typeahead: repairlines(), minLength: 2, updater: updateViewAfterSelection, value: Description" required/> 
```

这是我的视图模型：

```
define(function (require) {
    var dataservice = require('services/dataservice'),
        allCustomers = ko.observableArray([]),
        repairlinesRaw = ko.observableArray([]),
        Description = ko.observable(),
        InternalCode = ko.observable(),
        Mat = ko.observable(),
        Location = ko.observable(),
        Rep = ko.observable(),
        Dum = ko.observable(),
        Dam = ko.observable(),
        Qty = ko.observable(0).extend({ numeric: 2 }),
        Hours = ko.observable(0).extend({ numeric: 2 }),
        Tariff = ko.observable(0).extend({ numeric: 2 }),
        Costs = ko.observable(0).extend({ numeric: 2 });

    function init() {
        dataservice = new dataservice('api/data');
        dataservice.getAllRows('AllCustomers').then(function (data) {
            data.results.forEach(function (item) {
                allCustomers.push(item);
            });
        }).fail(function () {
        });

        dataservice.getAllRows('EntireRepairLineLib').then(function (data) {
            data.results.forEach(function (item) {
                repairlinesRaw.push(item);
            });
        }).fail(function () {
        });
    }

    init();

    AddRepairOrderLineModal = function (loggedInEmployee) {
        //later ook customer en repairorder meegeven!
        this.allCustomers = allCustomers;
        this.choosenCustomerId = ko.observable(); //holds the Id of the chosen customer
        this.Description = Description;
        this.InternalCode = InternalCode;
        this.Mat = Mat;
        this.Location = Location;
        this.Rep = Rep;
        this.Dam = Dam;
        this.Qty = Qty;
        this.Hours = Hours;
        this.Tariff = Tariff;
        this.Costs = Costs;
        //this.CreationDate = (new Date().getMonth() + 1) + "-" + new Date().getDate() + "-" + new Date().getFullYear();
        this.repairlines = function () {
            var repairlinesName = [];
            map = {};
            var data = repairlinesRaw();
            $.each(data, function (i, repairline) {
                map[repairline.Description()] = repairline;
                repairlinesName.push(repairline.Description());
            });
            return repairlinesName;
        };

        this.IsAgreement = ko.observable(true);
        this.IsAuthorized = ko.observable(true);
        this.DoRepair = ko.observable(true);
        this.selectedEmployee = loggedInEmployee;
    };

    AddRepairOrderLineModal.prototype.updateViewAfterSelection = function(item) {
        //map can be found in the repairlines function
        Description(map[item].Description());
        InternalCode(map[item].InternalCode());
        Mat(map[item].MaterialCode());
        Location(map[item].LocationCode());
        Rep(map[item].RepairCode());
        Dam(map[item].DamageCode());
        Qty(map[item].Quantity());
        Hours(map[item].Hours());
        Costs(map[item].Costs());
        return item;
    };

    AddRepairOrderLineModal.prototype.ok = function () {
        var jsonObj = [];
        jsonObj.push({
            Description: this.Description(), InternalCode: this.InternalCode(),
            Mat: this.Mat(), Location: this.Location(),
            Rep: this.Rep(), Dam: this.Dam(),
            CustomerId: this.choosenCustomerId(), Qty: this.Qty(), Hours: this.Hours(),
            Tariff: this.Tariff(), Costs: this.Costs(),
            IsAgreement: this.IsAgreement(), IsAuthorized: this.IsAuthorized(), DoRepair: this.DoRepair(),
        });

        //empty all fields after JSON 
        //Otherwise the values would still be there when a new modal is opened again.
        Description(null);
        InternalCode(null);
        Mat(null);
        Location(null);
        Rep(null);
        Dum(null);
        Dam(null);
        Qty(0);
        Hours(0);
        Tariff(0);
        Costs(0);

        this.modal.close(jsonObj);
    };

    AddRepairOrderLineModal.prototype.closeModal = function () {
        return this.modal.close();
    };
    return AddRepairOrderLineModal;
}); 
```

希望人们会理解这一点；），希望它有所帮助，很多功劳归于比尔·拉；）和亚历克斯·普雷斯顿

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-23T00:35:14.647

无法理解这一点，因为它太混乱了。也就是说，预输入位与所有其他内容混合在一起。一个简单的例子怎么样，它只有预先输入的东西，并且可能像小部件一样组合成一个视图/视图模型，所以它可以被重用。

那么我们就有机会了解它

# jquery - 悬停处理程序检查是否在做某事之前悬停某事

> ID：16195201
> 
> 赞同：1
> 
> 时间：2013-04-24T14:53:37.157
> 
> 标签：jquery, hover, mouseenter, mouseleave

当我鼠标离开时，我想更改`li_lancamentos`a. 但是，我只想这样做，如果当我鼠标离开时我不再悬停`li_lancamentos`。当我从`#li_novo_lancamento`背到背鼠标离开`#li_lancamentos`时，`#li_lancamentos`由于 mouseleave 事件，仍然是白色的。我必须对 mouseleave 进行一些检查，看看当我 mouseleave 时`m not hovering`是否再次 #li_lancamentos`。

但是，我该怎么做呢？

这是带有更详细解释的小提琴：http: [//jsfiddle.net/tehfo/VNmAU/5/](http://jsfiddle.net/tehfo/VNmAU/5/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T17:32:59.030

也许你想要这个：

```
$('#li_lancamentos').css({"background-color":"white","border":"1px solid white","border-collapse":"collapse","color":"#616161"});
    $('#li_lancamentos a').css({"color":"#616161"});

$(document).ready(function(){
   $("#li_lancamentos ul a").css("display", "none");
});
$("#menu").hover(function(){
   $("#li_lancamentos ul a").css("display", "block");
}); 
```

这将使您的菜单链接在悬停在菜单上时出现和消失。这是小提琴的链接：jsfiddle.net/VNmAU/11 这是你想要的吗？

# php - Wordpress php回显链接不起作用

> ID：16195204
> 
> 赞同：0
> 
> 时间：2013-04-24T14:53:48.137
> 
> 标签：php, wordpress

我只是想用一个简单的回声在页脚信用中添加链接。链接显示在页脚中，但是当您单击它们时，您会看到一个 404 页面。这些页面确实存在，如果您手动输入它们或使用 html 链接，页面就会出现。我究竟做错了什么？？

```
add_filter( 'genesis_footer_creds_text', 'custom_footer_creds_text' );
        function custom_footer_creds_text() {
            echo '<div class="creds"><p>';
            echo 'Copyright &copy; ';
            echo date('Y');
            echo ' &middot; <a href="/privacy-policy/‎">Privacy Policy</a> &middot; <a href="/about-us/‎">Terms of Use</a>';
            echo '</p></div>';
        } 
```

输出：

```
 <div class="creds">
    <p>Copyright © 2013 · <a href="http://speakeasy.stagetheweb.com/privacy-policy/‎">Privacy Policy</a> · <a href="http://speakeasy.stagetheweb.com/terms-of-use/‎">Terms of Use</a>
    </p></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T05:25:20.800

It's very likely that you copy-pasted the url from somewhere, right?

Try rewriting the whole line by hand, as you may have copied some invisible characters without your knowledge.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:17:56.460

尝试更换：

```
echo ' &middot; <a href="/privacy-policy/‎">Privacy Policy</a> &middot; <a href="/about-us/‎">Terms of Use</a>'; 
```

和：

```
echo ' &middot; <a href="' . get_site_url() . '/privacy-policy/‎">Privacy Policy</a> &middot; <a href="' . get_site_url() . '/about-us/‎">Terms of Use</a>'; 
```

您也可以尝试`home_url()`代替`get_site_url()`. 如果这不能解决问题，那么还有一些我们不知道的其他因素会影响事情。如果这没有帮助，请发布在实时站点上看到的页脚的 HTML 输出（例如查看源代码），以便我们可以看到正在生成的 URL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T05:39:29.177

请看，您的代码中有一个无效字符。

![在此处输入图像描述](https://i.stack.imgur.com/gch3E.png)

这可能有效。我刚刚删除了您代码中的无效字符。用这个替换块。

```
add_filter( 'genesis_footer_creds_text', 'custom_footer_creds_text' );
        function custom_footer_creds_text() {
            echo '<div class="creds"><p>';
            echo 'Copyright &copy; ';
            echo date('Y');
            echo ' &middot; <a href="/privacy-policy/">Privacy Policy</a> &middot; <a href="/about-us/">Terms of Use</a>';
            echo '</p></div>';
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T17:53:12.113

看起来网址中有一个空格。我点击了链接[http://speakeasy.stagetheweb.com/privacy-policy/](http://speakeasy.stagetheweb.com/privacy-policy/)并且您的页面正确出现。但是当我点击链接时，地址栏中似乎有一个标签`&nbsp;`或其他东西。

所以也许尝试：

```
$privacylink = rtrim("/privacy-policy/");

echo ' &middot; <a href="' .$privacylink. '‎">Privacy Policy</a> &middot;'; 
```

如果这不起作用，则可能是您的`.htaccess`文件中的某些内容

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T15:01:57.207

如果是过滤器，则应返回该值。尝试：

```
add_filter( 'genesis_footer_creds_text', 'custom_footer_creds_text' );
function custom_footer_creds_text( $creds )
{
    $creds = '';
    $creds .= '<div class="creds"><p>';
    $creds .= 'Copyright &copy; ';
    $creds .= date( 'Y' );
    $creds .= ' &middot; <a href="' . home_url( '/privacy-policy/' ) . '‎">Privacy Policy</a> &middot; <a href="' . home_url( '/about-us/‎' ) . '">Terms of Use</a>';
    $creds .= '</p></div>';

    return $creds;
} 
```

# android - 广播广播记录超时只是调用服务

> ID：16195206
> 
> 赞同：2
> 
> 时间：2013-04-24T14:53:55.857
> 
> 标签：android, broadcastreceiver, alarmmanager

我知道当您`onReceive()`在`BroadcastReceiver`.

但是，这是 my 的代码`onReceive()`，建议：

```
@Override
public void onReceive(Context context, Intent intent) {
    // TODO Iniciando classes   
    Intent iLocator = new Intent(context, LocatorService.class);
    context.startService(iLocator);
} 
```

Intent 是通过这个方法发送的：

```
public void agendarPing() {
    Intent it = new Intent("EXECUTA");
    PendingIntent p = PendingIntent.getBroadcast(LocatorService.this, 0,
            it, 0);

    Calendar c = Calendar.getInstance();
    c.setTimeInMillis(System.currentTimeMillis());
    c.add(Calendar.SECOND, 360);

    long tempoReabrir = c.getTimeInMillis();
    AlarmManager reabrir = (AlarmManager) getSystemService(ALARM_SERVICE);
    reabrir.set(AlarmManager.RTC_WAKEUP, tempoReabrir, p);
    Log.d(TAG, "Alarme agendado com sucesso!");
    stopSelf();
} 
```

为什么我要有这个日志？

```
04-24 08:41:40.742: W/ActivityManager(1483): Timeout of broadcast BroadcastRecord{40b3f1c0 EXECUTA} - receiver=android.os.BinderProxy@40bcfef0, started 20008ms ago

04-24 08:41:40.742: W/ActivityManager(1483): Receiver during timeout: ResolveInfo{40b78208 br.com.contele.locator.LocatorReceiver p=0 o=0 m=0x108000} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:42:38.360

`Intent.FLAG_ACTIVITY_NEW_TASK`在这里没用，你开始一个`Service`不是`Activity`.

另外，为什么要间接启动服务？单独的 Pending Intent 可以代表您启动服务：

```
PendingIntent pi = PendingIntent.getService(mContext,1001,new Intent(LocatorService.class),PendingIntent.FLAG_CANCEL_CURRENT); 
```

将此挂起的缩进传递给`AlarmManager`.

# javascript - chrome.alarms api 不能与 angularJS 一起正常工作

> ID：16195207
> 
> 赞同：1
> 
> 时间：2013-04-24T14:53:56.077
> 
> 标签：javascript, html, google-chrome-extension, angularjs

我正在使用 angluarJS 开发 chrome 扩展，现在我遇到了一个完全烧毁我大脑的问题。
我想抓取数据，解析该数据并将解析后的数据存储在后台页面的 localStorage 中，并在浏览器操作中获取该数据并在弹出 html 中显示该数据。现在我想
反复抓取、解析和存储数据，如[http://developer.chrome.com/extensions/alarms.html](http://developer.chrome.com/extensions/alarms.html)所述，我使用 chrome.alarms api 来执行此操作，但它无法正常工作。

这是我在后台控制器中的代码：

```
app.controller('bgCtrl', function AlfredCtrl($scope, courseService) {
  var setLocal = function(){
      console.log("fired inside setLocal(), but out of getCourses()");
      courseService.getCourses().then(function (events){
          console.log("fired inside of getCourses()");
          localStorage.setItem("deadlines", JSON.stringify(events.deadlines));
      })
  };

  var delay = 1 ;
  chrome.alarms.create("scheduleRequest", {periodInMinutes: delay});

  chrome.alarms.onAlarm.addListener(function(alarm){
      if(alarm.name == "scheduleRequest"){
          console.log("fired out of setLocal()");
          setLocal();
      }
  });
}); 
```

函数 getCourses() 从 bg 中的服务返回。当它被调用时，它会返回解析后的数据。

当我在 chrome 开发工具中检查时，它会反复显示：

```
fired out of setLocal().                           bgCtrl.js:32
fired inside setLocal(), but out of getCourses().  bgCtrl.js:7 
```

也就是说函数 courseService.getCourses() 根本没有被调用。这就是我遇到的问题。

请帮我！！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-03-12T11:19:27.083

您可以在 manifest.json 中添加“警报”权限

这样，您的应用就可以访问 Chrome api 的警报功能

“权限”：[“警报”，... ... ]，

# ruby-on-rails - rails 祖先协会集合排序顺序

> ID：16195212
> 
> 赞同：0
> 
> 时间：2013-04-24T14:54:12.157
> 
> 标签：ruby-on-rails, ancestry

我有一个使用 Ancestry gem 的 Locations 表。当我使用“子树”选择时，我想对条目进行排序。

这在没有子树的情况下有效：

```
<%= f.association :location, :label_method => :name_desc, :collection => Location.all(:order => :name) %> 
```

但是，这不起作用：

```
<%= f.association :location, :label_method => :name_desc, :collection => Location.find(locationid).subtree(:order => :name) %> 
```

我收到此错误：

```
Unknown depth option: order. 
```

谢谢您的帮助！

# mysql - cPanel mysql错误0

> ID：16195216
> 
> 赞同：0
> 
> 时间：2013-04-24T14:54:23.723
> 
> 标签：mysql, database, connection, cpanel

我试图通过 PHP 网页连接到我的 mysql 服务器，一段时间后，我发现它返回错误 0。

一些细节：我正在使用 cPanel 运行一个网络服务器，它还包括 mysql 服务。现在我制作了一个简单的网页，连接到我的数据库：

```
mysql_connect($mysql_hostname, $mysql_user, $mysql_password) or die ('cannot connect to sql server: '.  mysql_errno()); 
```

运行它时，我得到了输出：

```
cannot connect to sql server: 0 
```

我已经想通了，肯定是和mysql服务的bug有关，也有人（网上）建议重新安装mysql，虽然我不相信这样的错误需要这么激进“改变”。另外，另一方面，要通过 SSH 访问 cpanel（用于重新安装或系统重启），我需要访问我目前没有的 cPanel WHM。

你对我应该做什么有什么建议吗？如有必要，我可以尝试访问 WHM。

整个代码：

```
<?php

ini_set('display_errors',1);
$mysql_hostname = "****";
$mysql_user =  "****";
$mysql_password =  "****";
$mysql_database = "****";

// Make a MySQL Connection
mysql_connect($mysql_hostname, $mysql_user, $mysql_password) or die ('cannot connect to sql server: '.  mysql_errno().  mysql_error());
mysql_select_db($mysql_database) or die('cannot select db: '.mysql_error());

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:27:55.907

ERROR 0 表示 MySQL 向导无法安装、启动或配置新服务器。通常删除已安装的实例并重新设置将有助于解决此问题。

尝试

1.在资源管理器中打开mysql

2 运行 mysql_uninstallservice

3.运行mysql_installservice

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T13:53:31.100

谢谢大家的帮助。看来我现在已经解决了这个问题，虽然我不确定这个错误是什么。我采取了几个行动：

*   重置mysql用户的密码
*   使用 mysqli* 方法
*   在 php 脚本中使用了 try-catch 方法。

# java - JGoodies JTextfield 强制光标到 jtextfield 的开头

> ID：16195218
> 
> 赞同：0
> 
> 时间：2013-04-24T14:54:35.397
> 
> 标签：java, swing, mouseevent, jtextfield, jgoodies

我通过简单地绑定我的 JTextfield

```
ValueModel valueModel = adapter.getBuferedModel(propertyName);
JTextField textField = BasicComponentFactory.createLongField(valueModel, numberFormat); 
```

每当我在 JTextfield 中单击鼠标时，它都会将光标强制到 JTextfield 的开头。我希望能够编辑我单击的 JTextfield，以便如果我想将文本附加到该字段，我可以单击一次并让光标在那里。现在我必须单击一次，然后再次单击以将光标移到我想要的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:34:15.017

事实证明，它与 JGoodies 无关，它与格式化的文本字段有关。

这个链接救了我！[关联](https://stackoverflow.com/questions/2201873/jformattedtextfield-caret-position-on-focus)

# android - Android 使用线程更新列表

> ID：16195221
> 
> 赞同：0
> 
> 时间：2013-04-24T14:54:39.210
> 
> 标签：android, multithreading, list

我正在创建一个需要每 x 秒更新一次列表的程序，所以我创建了一个 ListActivity 和一个线程。ListActivity 调用线程，并发送信息，但列表不会更新，直到所有线程完成。

示例：如果我在线程中放置了 5 次 for，则在 5 次结束之前您无法看到列表。

代码在这里：

列表活动：

```
public class ValuesActivity extends ListActivity {
ArrayList<Values> valueList;
ListView list;
ValuesAdapter adapter;
Request request;
String name;
NewValuesListener newValues;

@Override
protected void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);     
    setContentView(R.layout.values);        

    list=(ListView)findViewById(android.R.id.list);
    Bundle bundle=this.getIntent().getExtras();
    name =bundle.getString("name");

    newValues=new NewValuesListener(){
        @Override
        public void onNewValues(ArrayList<Values> val) {

            valueList = val;
            adapter=new ValuesAdapter(ValuesActivity.this,valueList);
            adapter.notifyDataSetChanged();
            list.setAdapter(adapter);

        }
    };

}

 public void onResume(){
    super.onResume();
    valueList=new ArrayList<Values>();
    request=new Request("XXXXXXXX",name,newValues);
    adapter=new ValuesAdapter(this,valueList);
    list.setAdapter(adapter);       
    request.run();

 }

} 
```

线：

```
public class Request extends Thread  {
private String values;
private String server;
private NewValuesListener vActivity;

public Request(String values,String server,NewValuesListener activity){
    this.values=values;
    this.server=server;
    this.vActivity=activity;
}

@Override
public void run() {

    ConnectToServer con=new ConnectToServer(server);

    int cd=5;
    while (cd>0){

        String response=con.read(values);
        String[] channelValues=new String[2];
        ArrayList<Values> arrValues=new ArrayList<Values>();
        channelValues=LoadData.stringToArray(response);
        for (int i=1;i<3;i++){
            Values val=new Values("000"+i,channelValues[i]);
            arrValues.add(val);

        }

        vActivity.onNewValues(arrValues);
        try {
            yield();
            sleep(10000);

        } catch (Exception e) {

            e.printStackTrace();
        }

        cd--;
    }       
}
} 
```

适配器：

```
public class ValuesAdapter extends BaseAdapter {
private ArrayList<Values> values;
private LayoutInflater lInflater;

public ValuesAdapter(Context context, ArrayList<Values> val) {
    this.lInflater = LayoutInflater.from(context);
    this.values = val;
}

@Override
public int getCount() {return values.size();}

@Override
public Object getItem(int arg0) {return values.get(arg0);}

@Override
public long getItemId(int arg0) {return arg0;}

@Override
public View getView(int arg0, View arg1, ViewGroup arg2) {
    ValuesView list = null;

    if (arg1 == null){
        arg1 = lInflater.inflate(R.layout.values_adapter, null);

        list = new ValuesView();
        list.channelName = (TextView) arg1.findViewById(R.id.lblValueName);
        list.value = (EditText) arg1.findViewById(R.id.txtValue);

        arg1.setTag(list);
    } else
        list = (ValuesView) arg1.getTag();

    Values val = (Values) getItem(arg0);
    list.channelName.setText(val.getName());
    list.value.setText(val.getValue());
    return arg1;
}

class ValuesView
{
    TextView channelName;
    EditText value;
}
} 
```

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:02:28.373

您不应该从 GUI 以外的线程更新您的列表，并且从您的示例中我想这就是您正在做的事情。最好的方法是使用 AsyncTask 并使用处理程序将更新信息传达给 GUI 线程或在 onPostExecute 中处理更新，您可以将下一个 AsyncTask 安排为下一个 for-iteration。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:11:39.903

如果在数据更改后在线程内执行此操作会发生什么：

```
Activity_Name.this.runOnUiThread(new Runnable() {

            @Override
            public void run() {
               adapter.notifyDataSetChanged();

            }
        }); 
```

# javascript - 使用javascript在单击按钮时创建一个文本框

> ID：16195224
> 
> 赞同：-4
> 
> 时间：2013-04-24T14:54:45.647
> 
> 标签：javascript

我有一个添加按钮，我想将按钮设置为在单击时打开一个文本框而不刷新页面我认为解决方案是 javascript 所以请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:09:15.423

`jQuery`如果可以，请使用。简单地：

html:

```
<button id="createInput">Create</button>

<div id="textarea"></div> 
```

和 jQuery：

```
$('#createInput').click(function(){
    $('#textarea').html('<input type="text" />');
    return false;
}); 
```

**注意：**如果要在每次单击按钮时创建新元素，请替换`html`为`append`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:59:10.073

首先在css中设置文本框display:none，然后用jquery

`$('#id-Of-your-button').on('click', function(){ $('Your-text-box').show(); })`

如果你想切换可见性使用

`$('Your-text-box').toggle();`

# ios - 自定义 UISLider 拖动拇指后改变颜色

> ID：16195225
> 
> 赞同：1
> 
> 时间：2013-04-24T14:54:58.927
> 
> 标签：ios, cocoa-touch, uislider

我已经实现了这种类型的自定义`UISlider`，如下所示： ![在此处输入图像描述](https://i.stack.imgur.com/PRGJa.png)

它的特点是你不能将它拖到它的初始拇指位置的左边。

但是当你把它拖到右边时，它应该像这样改变路径的颜色，让左边的颜色保持原样，并为它走过的路径着色：

![在此处输入图像描述](https://i.stack.imgur.com/eh5Ry.png)

我只知道 - 的两个属性`UISlider`，`MinimumTrackImage`它们`MaximumTrackImage`负责手柄的右侧和左侧。

我该如何实现这种奇怪的行为？有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:27:09.700

我能够使用以下代码实现这一点。要弄清楚的棘手部分是如何根据滑块的起始值设置初始图像。我通过创建一个 4 像素宽的图像来做到这一点，其中左侧 2 像素是您的起始左侧颜色，右侧 2 像素是您在拖动后想要的颜色。基本上，我拉伸了该图像（仅在左侧）以填充图像视图，然后使用 UIGraphicsGetImageFromCurrentImageContext() 获取该图像。然后，我使用该图像创建另一个可拉伸图像，仅在右侧进行拉伸。

```
#import "ViewController.h"
#import <QuartzCore/QuartzCore.h>

@interface ViewController ()
@property (weak,nonatomic) IBOutlet UISlider *slider;
@property (nonatomic) CGFloat previousValue;
@end

@implementation ViewController

- (void)viewDidAppear:(BOOL)animated {

    [super viewDidAppear:animated];
    self.previousValue = self.slider.value;
    if (self.slider.value > .01) {
        UIImage *newImage = [self imageStretchedOnLeft];
        UIImage *rightStretchImage = [newImage resizableImageWithCapInsets:UIEdgeInsetsMake(0, newImage.size.width -2, 0, 0) resizingMode:UIImageResizingModeStretch];
        [self.slider setMinimumTrackImage:rightStretchImage forState:UIControlStateNormal];
    }else{
        [self.slider setMinimumTrackImage:[UIImage imageNamed:@"OneColor.png"] forState:UIControlStateNormal];
    }

}

-(IBAction)sliderMoved:(UISlider *)slider {
    if (slider.value < self.previousValue) {
        slider.value = self.previousValue;
    }
    self.previousValue = slider.value;
}

- (UIImage *)imageStretchedOnLeft {
    UIImage *image = [UIImage imageNamed:@"TwoColor.png"]; // 4 pixel wide 1 pixel high image. Left 2 pixels are original track color, right two are new drag color
    UIImage *cappedImage = [image resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 2)];

    UIImageView *iv = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, self.slider.frame.size.width * (self.slider.value/self.slider.maximumValue), self.slider.frame.size.height)];
    iv.image = cappedImage;
    [self.view insertSubview:iv belowSubview:self.view];

    UIGraphicsBeginImageContextWithOptions(iv.frame.size, YES, [[UIScreen mainScreen] scale]);
    [iv.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage * img = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    [iv removeFromSuperview];

    return img;
} 
```

如果滑块的值为 0，则会出现图形上下文错误，因此如果该值小于 0.01，viewDidAppear 方法中的 if 语句将使用不同的单色图像。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-24T15:09:11.307

你可以用这个

```
//code for slider
UIImage *minImage = [[UIImage imageNamed:@"slider_minimum.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 5, 0, 0)];
UIImage *maxImage = [[UIImage imageNamed:@"slider_maximum.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 5, 0, 0)];
UIImage *thumbImage = [UIImage imageNamed:@"thumb.png"];

[[UISlider appearance] setMaximumTrackImage:maxImage forState:UIControlStateNormal];
[[UISlider appearance] setMinimumTrackImage:minImage forState:UIControlStateNormal];
[[UISlider appearance] setThumbImage:thumbImage forState:UIControlStateNormal]; 
```

这是raywenderlich的好[教程](http://www.raywenderlich.com/4344/user-interface-customization-in-ios-5)

# c# - 用逗号分割字符串

> ID：16195226
> 
> 赞同：-8
> 
> 时间：2013-04-24T14:54:59.460
> 
> 标签：c#

我有一个获取字符串的代码，该字符串包含颜色名称。我想拆分用逗号分隔的字符串。这是我的代码。

```
public static string getcolours()
{
    string str = null;
    DBClass db = new DBClass();
    DataTable allcolours = new DataTable();
    allcolours = db.GetTableSP("kt_getcolors");
    for (int i = 0; i < allcolours.Rows.Count; i++)
    {
        string s = allcolours.Rows[i].ItemArray[0].ToString();
        string missingpath = "images/color/" + s + ".jpg";
        if (FileExists(missingpath))
        {

        }
        else
        {
             str = str + missingpath;

        }

    }
    return str;

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:56:16.250

只需使用[`Split`](http://msdn.microsoft.com/en-us/library/tabh47cf.aspx)：

```
string[] yourStrings = s.Split(','); 
```

**实际上，我认为您要的是这样的返回字符串：**

```
"red, blue, green, yellow" 
```

为此，您需要使用[`string.Join`](http://msdn.microsoft.com/en-gb/library/57a79xd0.aspx). 尝试这个：

```
public static string getcolours()
{
    List<string> colours = new List<string>();
    DBClass db = new DBClass();
    DataTable allcolours = new DataTable();
    allcolours = db.GetTableSP("kt_getcolors");
    for (int i = 0; i < allcolours.Rows.Count; i++)
    {
        string s = allcolours.Rows[i].ItemArray[0].ToString();
        string missingpath = "images/color/" + s + ".jpg";
        if (!FileExists(missingpath))
        {
            colours.Add(missingpath);
        }
    }

    return string.Join(", ", colours);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T14:56:50.907

```
string[] words = s.Split(','); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T14:59:33.250

如果您不想有空值，请使用 StringSplitOptions。

```
var colours = str.Split(",", StringSplitOptions.RemoveEmptyEntries); 
```

# objective-c - OS X 上 CPDistributedMessagingCenter 的任何替代方案？

> ID：16195230
> 
> 赞同：0
> 
> 时间：2013-04-24T14:55:02.320
> 
> 标签：objective-c, macos, interprocess

我想要这样的东西：http: [//iphonedevwiki.net/index.php/CPDistributedMessagingCenter](http://iphonedevwiki.net/index.php/CPDistributedMessagingCenter)

在进程之间同步发送和接收一些 NSString

但 CPDistributedMessagingCenter 仅在 iOS 上可用。

有人可以给我建议如何做到这一点吗？谢谢！;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:20:01.247

您是否考虑[过 NSDistributedNotificationCenter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDistributedNotificationCenter_Class/Reference/Reference.html)？

我建议创建一个`DistributedNotificationCenter`（服务器）来监听从`NotificationCenter`. 它应该简单地将任何接收到的消息（或任何注册的兴趣）中继到对等点`DistributedNotificationCenters`（在其他进程中运行）。

问题是这些如何`DistributedNotificationCenters`“找到”彼此。好吧，有很多选择：

1.  一个众所周知的`DistributedNotificationCenterLocator`服务（服务器）将它们连接起来，甚至可能是所有消息传递的中央中继点（但存在可扩展性问题）。
2.  与 (1) 一样，但您使用 server:port 的`DistributedNotificationCenterLocator`.
3.  `DistributedNotificationCenter`如果特定于应用程序，s 可以在数据库中注册 - 即我在“服务器：端口”上。即众所周知的查找。
4.  我对此一无所知，但看到这个关于使用 Bonjour 进行服务器发现的[答案。](https://stackoverflow.com/a/7047980/758831)听起来不错？

我没有在这里提供任何代码，但如果您需要任何指针，请告诉我...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T16:03:46.293

我找到了一个很好的指南。 [http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DistrObjects/DistrObjects.html#//apple_ref/doc/uid/10000102-SW1](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DistrObjects/DistrObjects.html#//apple_ref/doc/uid/10000102-SW1)

在这里我分享我的片段：

服务器：

```
[NSConnection serviceConnectionWithName:@"your.connection.name" rootObject:self]; 
```

客户：

```
[[NSConnection rootProxyForConnectionWithRegisteredName:@"your.connection.name" host:nil]performSelector:@selector(a_selector_that_server_object_respond_and_return_value)]; 
```

# android - Android View：如果 layout_height 太小则隐藏

> ID：16195231
> 
> 赞同：6
> 
> 时间：2013-04-24T14:55:03.133
> 
> 标签：android, android-layout, android-linearlayout, android-layout-weight

我只想在屏幕上显示两个 TextView，一个在另一个之上。

TextView B：400dp 高，在底部，TextView A：填满屏幕的其余部分。

但是，如果 TextView A 的高度小于 100dp，则不应显示（只有 TextView A 可见，其余只是空白）。

这可以仅通过 XML 实现吗？

目前我正在使用这样的东西：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:gravity="center"
    android:orientation="vertical" >

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:background="@color/blue"
        android:text="Image A"
        android:gravity="center"
        android:textSize="40sp" />

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="400dp"
        android:background="@color/green"
        android:text="Image B: 400dp"
        android:gravity="center"        
        android:textSize="40sp" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T18:25:17.490

如果您打算在其他几个布局中使用此功能，我会考虑将其构建到自定义视图中，您可以在其中添加额外的属性 customer:minSize=100dp。在该自定义视图中，您可能会添加 Marko 的建议（即 textview.getHeight > customer:minSize 然后 textview.setVisibility(View.Gone/Invisible)

[http://developer.android.com/training/custom-views/index.html](http://developer.android.com/training/custom-views/index.html) [http://developer.android.com/guide/topics/ui/custom-components.html](http://developer.android.com/guide/topics/ui/custom-components.html) ... [http://mobile.tutsplus .com/tutorials/android/android-sdk-creating-custom-views-2/](http://mobile.tutsplus.com/tutorials/android/android-sdk-creating-custom-views-2/)

否则，我只会在您的活动中实施它。

# servicestack - HttpListenerResponseWrapper 中的错误：写入失败

> ID：16195232
> 
> 赞同：3
> 
> 时间：2013-04-24T14:55:04.087
> 
> 标签：servicestack

我有一个使用单声道 2.10.8 在 Linux (Centos 6.4) 中运行的自托管 ServiceStack 应用程序。

我在日志中间歇性地看到以下错误 - 这是相当随机的。有时一分钟或更长时间没有错误，有时很快连续出现几个错误。它似乎不会影响我的应用程序的运行。

```
ERROR2013-04-24 05:40:23 – Error in HttpListenerResponseWrapper: Write failure
System.IO.IOException: Write failure ---> System.Net.Sockets.SocketException: The socket        has been shut down
at System.Net.Sockets.Socket.Send (System.Byte[] buf, Int32 offset, Int32 size, SocketFlags flags) [0x00000] in <filename unknown>:0 
at System.Net.Sockets.NetworkStream.Write (System.Byte[] buffer, Int32 offset, Int32 size)     [0x00000] in <filename unknown>:0 
--- End of inner exception stack trace ---
at System.Net.Sockets.NetworkStream.Write (System.Byte[] buffer, Int32 offset, Int32 size)  [0x00000] in <filename unknown>:0 
at System.Net.ResponseStream.InternalWrite (System.Byte[] buffer, Int32 offset, Int32     count) [0x00000] in <filename unknown>:0 
at System.Net.ResponseStream.Close () [0x00000] in <filename unknown>:0 
at   ServiceStack.WebHost.Endpoints.Extensions.HttpResponseStreamExtensions.CloseOutputStream (System.Net.HttpListenerResponse response) [0x00000] in <filename unknown>:0 
```

我注意到：

[https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/WebHost.Endpoints/Extensions/HttpResponseStreamExtensions.cs](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/WebHost.Endpoints/Extensions/HttpResponseStreamExtensions.cs)

有一些在 mono/Fastcgi 下运行的测试，看起来有问题。这可能有关系吗？有什么解决方法吗？

# oauth-2.0 - 谷歌云存储服务帐户的 Invalid_grant 错误

> ID：16195234
> 
> 赞同：1
> 
> 时间：2013-04-24T14:55:10.057
> 
> 标签：oauth-2.0, google-cloud-storage

我正在尝试获取 OAuth2 令牌，以便我可以在 Authorization Header 的 GET BUCKET 方法中使用它。

我正在通过以下链接中提到的 grant_type 和断言来获取令牌： [https ://developers.google.com/accounts/docs/OAuth2ServiceAccount#libraries](https://developers.google.com/accounts/docs/OAuth2ServiceAccount#libraries)

是什么导致 invalid_grant 响应？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T14:22:53.180

解决了这个问题。我为内容中需要的“过期”分配了一些不同的值。现在它适用于

```
long currenttime = System.currentTimeMillis();
long now = currenttime / 1000;
long expiration = currenttime / 1000 + 3600; 
```

并有以下

```
String temp = JWTBase64Header + "." + JWTBase64Content;
byte[] JWTSignatureInput = temp.getBytes("UTF8");

final String keyFile = "xx9d9xxxxxx12cd99fxxxx60bxxxxx1-privatekey.p12";
final String keyPassword = "notasecret";
PrivateKey pkcsKey = loadKeyFromPkcs12(keyFile, keyPassword.toCharArray());
String JWTBase64Signature = signData(pkcsKey, new String(JWTSignatureInput, "UTF8"));

String params = "grant_type=urn:ietf:params:oauth:grant-type:jwt-bearer&assertion="+JWTBase64Header + "." + JWTBase64Content + "."
        + JWTBase64Signature;

URL url = new URL("https://accounts.google.com/o/oauth2/token");
HttpURLConnection conn = (HttpURLConnection) url.openConnection();
conn.setDoOutput(true);
conn.setRequestMethod("POST");
conn.setRequestProperty("Accept", "application/x-www-form-urlencoded");
conn.setRequestProperty("Content-Length", Integer.toString(params.getBytes().length));

//Send request

  DataOutputStream wr = new DataOutputStream (
              conn.getOutputStream ());
  wr.writeBytes (params.toString());
  wr.flush ();
  wr.close (); 
```

现在只需从连接中获取输入流并解析它以获取 access_token。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T20:25:48.713

```
private static PrivateKey loadKeyFromPkcs12(String filename, char[] password)
        throws Exception {
    FileInputStream fis = new FileInputStream(
            "NewFolder/" + filename);

    KeyStore ks = KeyStore.getInstance("PKCS12");
    try {
        ks.load(fis, password);
    } catch (IOException e) {
        if (e.getCause() != null
                && e.getCause() instanceof UnrecoverableKeyException) {
            System.err.println("Incorrect password");
        }
        throw e;
    }
    return (PrivateKey) ks.getKey("privatekey", password);
}

private static String signData(PrivateKey key, String data)
        throws Exception {
    Signature signer = Signature.getInstance("SHA256withRSA");
    signer.initSign(key);
    signer.update(data.getBytes("UTF8"));
    byte[] rawSignature = signer.sign();
    String encodedSignature = new String(Base64.encodeBase64URLSafe(rawSignature));
    return encodedSignature;
} 
```

# javascript - AJAX jQuery PHP 获取 JSON

> ID：16195235
> 
> 赞同：0
> 
> 时间：2013-04-24T14:55:10.563
> 
> 标签：javascript, jquery, ajax

我从服务器获取 JSON 对象时遇到问题。PHP 返回一个 JSON 文件。

脚本总是失败，我不知道为什么。PHP 在浏览器中运行时会返回这个；

```
{"accountDetails":[{"account_name":"SOMEACCOUNT","auto_id":"1"} 
```

我的代码：

```
 <div id="output"> This should change </div>

    <script>

        $(document).ready(function () {

            $.ajax({
                type: 'GET',
                url: 'selectAccounts.php',
                data: "",
                dataType: 'json',

                success: function ()
                {
                    $("#output").text("SUCEEDED");
                },

                error: function () {
                    $("#output").text("UNSUCEEDED");
                }
            });
        });

    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:01:40.580

您可以解析错误，例如

```
error:function(XMLHttpRequest,textStatus,errorThrown){ /* render that stuff */} 
```

# perl - 如何在 Perl 中处理文件路径？

> ID：16195236
> 
> 赞同：-2
> 
> 时间：2013-04-24T14:55:12.910
> 
> 标签：perl, filepath

我有以下脚本，用于读取给定路径中的文件！在这个脚本中，让我们假设路径如下

```
chdir("/usr/test1/street/accounts/goal/routecab/Prpbict") 
```

工作得很好但是

```
chdir("/usr/test1/street/accounts/goal/routecab/EventDir") 
```

目录没变！谁能告诉我原因！

**运行**

```
dir_name=Event\ Based\Mailers_Registration_Welcome.htm 
```

在将 dir_name 附加到工作目录之后，它似乎：`$main_dir=/usr/test1/site/accounts/coach/rulecab/Event\ Based\ Mailers_Registration_Welcome.htm` 运行后：- `chdir($main_dir);print`pwd`;`它会单独打印这个剩余路径我的意思是 dir_name /usr/test1/site/accounts/coach/rulecab

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:08:15.340

我假设您的路径周围有引号？

要找出`chdir`失败的原因，您应该写

```
chdir '/usr/test1/street/accounts/goal/routecab/EventDir'
        or die "Unable to chdir: $!"; 
```

perl 会告诉你原因。

# c#-4.0 - 需要帮助/建议开发发布者订阅模型。

> ID：16195237
> 
> 赞同：0
> 
> 时间：2013-04-24T14:55:13.347
> 
> 标签：c#-4.0, design-patterns

如果任何客户端发布消息，我有 n 个客户端（例如典型的浏览器）连接到服务器，所有其他客户端都应该能够查看它 IE 阅读/回复消息。因此，任何客户端都可以是发布者和订阅者。经过一番调查，我发现**观察者**设计模式可能是一种可能的解决方案（可能是错误的）。有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:17:48.270

您可以为此使用开箱即用的解决方案。它将为您节省大量工作和可扩展性、安全性等问题。而且，相信我，这需要解决很多问题。

我为 Realtime.co 工作，我们正是这样做的。在此处查看示例：[https ://github.com/RTWWorld/pubsub-examples/tree/master/Javascript](https://github.com/RTWWorld/pubsub-examples/tree/master/Javascript)

[您可以在http://www.realtime.co](http://www.realtime.co)获得一个免费帐户。

我们使用发布/订阅模式，您可以在其中订阅或发布到频道。订阅频道的人将收到在那里发布的数据。

下面以一段代码为例：

```
<input type="text" id="mensagem" />
<input type="button" onclick="sendMessage();" value="Send" />
<div id="log"></div>

<script src="http://code.xrtml.org/xrtml-3.0.0.js"></script>
<script>
    var appkey = 'YOUR_APP_KEY';
    var url = 'http://ortc-developers.realtime.co/server/2.1';
    var shoutbox;

    xRTML.load(function(){

        xRTML.Config.debug = true;

        xRTML.ConnectionManager.create(
        {
            id: 'myConn',
            appkey: appkey,
            authToken: 'anything',
            url: url,
            channels: [
                {name: 'user:channel_2'},
                {name: 'user:channel_1'}
            ]
        }).bind(
        {
            message: function(e) {
                var log = document.getElementById('log');
                log.innerHTML = log.innerHTML + '<br />' + e.message;
            }
        });

    });

    function sendMessage(){
        var msg = document.getElementById('mensagem').value;

        xRTML.ConnectionManager.sendMessage({
            connections: ['myConn'],
            channel: 'user:channel_2',
            content: msg
        });
    }

</script> 
```

当您单击“发送”按钮时，您将向频道“user:channel_2”发布一条消息。由于我们的代码同时订阅了“user:channel_1”和“user:channel_2”，您也会收到该消息。如果您在多个浏览器上打开此示例，所有浏览器都会收到该消息。

希望这可以帮助。

# paypal - PayPal DoCapture - 返回 10004 无效交易 ID

> ID：16195241
> 
> 赞同：1
> 
> 时间：2013-04-24T14:55:24.833
> 
> 标签：paypal

我正在尝试测试授权/捕获过程，并且我正在使用 PayPal 示例站点来设置授权。我已将其设置为使用我的沙盒凭据，并且一切都声称成功。但是，当我尝试执行捕获 (DoCapture) 时，我收到一个无效的事务 ID 错误。我已尝试查看测试帐户中的待处理授权，但无法加载页面的“我的资金”部分。

请求字符串：

```
METHOD=DoCapture
&USER=MyAPIUser
&PWD=MyAPIPass
&SIGNATURE=MyAPISig
&VERSION=86
TRXTYPE=D
&AUTHORIZATIONID=TransactionIdFromSetExpressCheckoutReturn
&COMPLETETYPE=NotComplete
&AMT=1.99
&NOTE=NewspaperSubscription 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T17:14:45.260

我看到您有 AUTHORIZATION=TransactionIdFromSetExpressCheckoutReturn，这应该是从 DoExpressCheckoutPayment API 响应返回的授权 ID，而不是 SetExpressCheckout API 调用。需要调用 DoExpressCheckoutPayment API 来完成您对资金的授权。然后 DoCapture 将是您调用来捕获资金的方法。

# c - 如何在给定范围内生成 N 个具有预定义均值和标准差的数字

> ID：16195246
> 
> 赞同：-2
> 
> 时间：2013-04-24T14:55:33.187
> 
> 标签：c, algorithm

我想生成 30 到 88 之间的 100 个数字，使得平均值为 50，标准偏差为 16。是否存在任何算法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:40:48.937

I assume that you don't really want to generate 100 numbers; i assume you want an algorithm that generates random numbers between the given bounds, with a given mean and standard deviation.

You can try generating numbers that have normal distribution (suggested by @Robert Harvey), and discard those that are outside your range. In pseudo-code:

```
do {
    x = Generate_Random_Number_Normal_Distribution(mean = 50, STD = y);
} while (!(x >= 30 && x <= 88)); 
```

If `y` = 16, the result will have slightly smaller standard deviation than what you wanted. In order to get the standard deviation you want, you have to increase the `y` parameter.

But by how much to increase? You can decide this by trial and error: testing different values of `y`, generating e.g. 1000000 numbers, calculating their standard deviation, and looking whether it's close enough to what you want.

After you find out what `y` is, make it a constant, and you will get an algorithm for generating your 50 numbers.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-24T15:04:33.557

[我在这个](http://www.perlmonks.org/bare/?node_id=286083)论坛中找到了以下算法。

我知道它是用 Perl 编写的，并且您用 C 标记了您的问题，但是该算法非常清晰，并且完全符合您的要求。

```
#!/usr/bin/perl -w
use strict;

my $desired_mean = 250;
my $desired_deviation = 20;
my $total = 1000;

my @numbers;

gen_numbers(\@numbers, $desired_mean, $desired_deviation, $total);

sub gen_numbers {
   my ($array_ref, $mean, $deviation, $total) = @_;
   my $offset = $deviation * 1.75;
   my $low = $mean - $offset;
   my $high = $mean + $offset;
   for (0 .. $total) {
       my $number;
       while (1) {
            $number = int(rand($high)) + 1;
            last if ($number >= $low && $number <= $high);
       }

       push @{$array_ref} , $number
   }
}

my $sum;
$sum += $_ for @numbers;

my $mean = $sum / $total;

my $scratch;
for (@numbers) {
   $scratch += (($_ - $mean) * ($_ - $mean));
}

my $standard_deviation = sqrt($scratch / ($total - 1));

print "Desired Mean:  $desired_mean\n";
print "Mean:  $mean\n";
print "\n";
print "Desired Standard Deviation:  $desired_deviation\n";
print "Standard Deviation:  $standard_deviation\n";
__END__
Desired Mean:  250
Mean:  250.06707

Desired Standard Deviation:  20
Standard Deviation:  19.9571308028178 
```

如果您不理解代码或算法，请告诉我。祝你好运！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-24T15:23:37.430

The 100 numbers 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, and 34 are between 30 and 88 and have a mean of 50 and a standard deviation of 16.

The method of generating them is obvious. I suspect your actual problem has other criteria that you have not stated.

# silverlight - Silverlight Datagrid 始终使用 null 调用 ICollectionView.MoveCurrentTo

> ID：16195253
> 
> 赞同：0
> 
> 时间：2013-04-24T14:55:55.727
> 
> 标签：silverlight, datagrid, virtualization, icollectionview

我使用[https://github.com/jogibear9988/VirtualCollection](https://github.com/jogibear9988/VirtualCollection)来自项目[https://github.com/samueldjack/VirtualCollection的一个分支](https://github.com/samueldjack/VirtualCollection)

现在我遇到了问题，每次我单击 Datagrid 中的一个项目时，所选项目都会正确设置为我的对象！但是它也调用了我的VirtualCollection的MoveCurrentTo，而且这个调用的参数总是null而不是当前对象！

有谁知道这可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:23:29.353

我修好了它。问题是 IList.IndexOf 没有正确实现！

# c# - 如何使用 元素来重用另一个模式中定义的模式？

> ID：16195256
> 
> 赞同：0
> 
> 时间：2013-04-24T14:55:58.363
> 
> 标签：c#, asp.net, xml, xsd, include

我有一个包含 UserDetails (UserDetails.xsd) 的 xsd。

我有另一个 Xsd，其中包含 UserDetails (UserDetailsList.xsd) 列表。

如何使用元素（或类似的东西）来重用 UserDetails.xsd 中定义的模式？

我已经尝试了以下但它没有编译：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="userDetailsList">
    <xs:complexType>
      <xs:sequence>
        <xs:include schemaLocation="UserDetails.xsd"/>     
      </xs:sequence>     
    </xs:complexType>
  </xs:element>  
</xs:schema> 
```

更新：

抱歉，我自己找到了 - 将关闭它！

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:include schemaLocation="UserDetails.xsd"/>
  <xs:element name="userDetailsList">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="userDetails" minOccurs="1" maxOccurs="unbounded" type="userDetailsType" />
      </xs:sequence>
    </xs:complexType>
  </xs:element>  
</xs:schema> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T05:49:08.790

由OP自己解决：

将其标记为社区 wiki 以避免受到赞誉（仅以防万一）..

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:include schemaLocation="UserDetails.xsd"/>
  <xs:element name="userDetailsList">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="userDetails" minOccurs="1" maxOccurs="unbounded" type="userDetailsType" />
      </xs:sequence>
    </xs:complexType>
  </xs:element>  
</xs:schema> 
```

# ember.js - 在 ember 中保存模型时尝试调用 loadedData

> ID：16195259
> 
> 赞同：2
> 
> 时间：2013-04-24T14:56:06.147
> 
> 标签：ember.js, ember-data

我在我的应用程序中不断收到此错误，但不知道是什么原因造成的。

每当我提交数据存储时都会发生这种情况：

尝试`loadedData`在 rootState.loaded.updated.inFlight 状态下处理事件。未定义调用

任何人？

这是导致它的代码：

```
var ts_setting;

ts_setting = Cluey.Setting.find(Cluey.SettingsKeyIDs.API_TIMESTAMP);

if (ts_setting.get('value') != null) {
  console.log("Found Timestamp");
} else {
  console.log("Creating Initial Timestamp...");
  ts_setting.set("id", Cluey.SettingsKeyIDs.API_TIMESTAMP);
  ts_setting.set("value", 0);
  Cluey.store.commit();
} 
```

**编辑**

我已将其归结为导致错误的以下代码（用咖啡脚本编写）。问题是，我第一次运行代码时，当对象第一次不存在于数据存储中时，它运行良好。当我在已经包含具有指定 ID 的记录的数据存储上运行代码时，就会发生错误。这可能会帮助您破译正在发生的事情。

```
ts_setting = Cluey.Setting.find(Cluey.SettingsKeyIDs.API_TIMESTAMP)
ts_setting.get('value')
ts_setting.set("id", Cluey.SettingsKeyIDs.API_TIMESTAMP)
ts_setting.set("value", 0)
Cluey.store.commit() 
```

**编辑 2**

我在创建记录时遇到了类似的问题：

```
ts_setting = Cluey.Setting.createRecord
    id: Cluey.SettingsKeyIDs.API_TIMESTAMP,
    value: 0

Cluey.store.commit() 
```

上面的代码给了我这个错误：

```
Uncaught Error: Attempted to handle event `loadedData` on <Cluey.Setting:ember327:1> while in state rootState.loaded.created.inFlight. Called with undefined 
```

**编辑 3**

所以事实证明，我是`@timestamp = ts_setting.get('value')`在提交我认为导致问题的存储之后才调用的，因为我试图从尚未保存的对象中获取一些数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-03T17:33:15.763

加载数据是异步的。`Cluey.Setting.find`向您返回一个承诺，一旦 XHR 请求成功，该承诺将被解决/更新。

所以你在调用时得到你的承诺`Cluey.Setting.find`，修改它（`ts_setting.set("value", 0)`）然后在某个时间点，你从你的服务器得到结果（来自的响应`find`）。

此时，ember 数据引发错误，因为它无法更新正在修改的记录。

您要做的是等待您的记录在修改和保存之前完全加载。

```
ts_setting = Cluey.Setting.find(Cluey.SettingsKeyIDs.API_TIMESTAMP);
ts_setting.one('didLoad', function() {
  ts_setting.set("value", 0);
  Cluey.store.commit();
}); 
```

# sql - 只运行一次 SQL 更新查询

> ID：16195261
> 
> 赞同：3
> 
> 时间：2013-04-24T14:56:15.820
> 
> 标签：sql, ms-access

我希望有人可以帮助解决我在 Microsoft Access 中遇到的一些 SQL 更新查询的以下问题。

我运行以下代码

```
UPDATE [Master Record] INNER JOIN [Family Members] ON [Master Record].[Family ID] = [Family Members].[Family ID] 
SET [Master Record].[Years Attendance] = ([Years Attendance]+1)
WHERE ((([Family Members].Attending)=True)); 
```

除了我只想将出勤年数增加 1 次之外，即使有多个家庭成员参加，这也是可行的。因此，目前当我运行此程序时，如果有 4 个家庭成员参加，当我只想要 1 时，我会得到 4 的增量。

即使有多个家庭成员参加，我也需要一些方法来将年数增加 1。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:58:53.190

有几种方法可以做到这一点，但我可能只是使用`IN`而不是`JOIN`：

```
UPDATE [Master Record] 
SET [Years Attendance] = [Years Attendance]+1
WHERE [Family ID] IN (
    SELECT [Family ID] 
    FROM [Family Members] 
    WHERE Attending=True
) 
```

# c# - C#如何用鼠标画线

> ID：16195266
> 
> 赞同：1
> 
> 时间：2013-04-24T14:56:25.163
> 
> 标签：c#, wpf, mouse, lines

我目前正在尝试以 Visual Studio WPF 形式制作一个程序，该程序使用鼠标绘制线条，就像在油漆中一样。目前它正在绘制相同的旧线并继续绘制它，但我想在每次按下鼠标左键时画一条新线。这是**MainWindows.xaml.cs**代码及其外观：

```
namespace DrawingLines
{

public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private PathFigure _pathFigure = new PathFigure();
    PathFigureCollection _pathCollection = new PathFigureCollection();
    PathSegmentCollection _segments = new PathSegmentCollection();
    private PathGeometry _pathGeometry = new PathGeometry();

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        _pathFigure.Segments = _segments;
        _pathCollection.Add(_pathFigure);
        _pathGeometry.Figures = _pathCollection;
        myPath.Data = _pathGeometry;
    }

    private void Window_MouseMove(object sender, MouseEventArgs e)
    {
        if (e.LeftButton == MouseButtonState.Pressed)
        {
            LineSegment segment = new LineSegment();
            segment.Point = e.GetPosition(this);
            _pathFigure.Segments.Add(segment);
        }

    }

    private void Window_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
    {
        _pathFigure.StartPoint = e.GetPosition(this);
    }

    //private void Window_MouseRightButtonDown(object sender, MouseButtonEventArgs e)
    //{

    //}

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        this.Close();

    }
} 
```

}

这是**MainWindow.xmal**代码：

```
<Window x:Class="DrawingLines.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Joonistamine" Height="350" Width="525" Loaded="Window_Loaded" MouseMove="Window_MouseMove" MouseLeftButtonDown="Window_MouseLeftButtonDown" MouseRightButtonDown="Window_MouseRightButtonDown">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="53*" />
        <RowDefinition Height="258*" />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="124*" />
        <ColumnDefinition Width="379*" />
    </Grid.ColumnDefinitions>
    <Path Stroke="Black" StrokeThickness="1" Name="myPath" Grid.ColumnSpan="2" Grid.RowSpan="2" />
    <Button Content="Exit" Height="25" HorizontalAlignment="Left" Name="button1" VerticalAlignment="Top" Width="46" Click="button1_Click" BorderBrush="Red" Foreground="#FFFF1A1A" />
</Grid> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:12:16.370

在我看来，您不断地添加到 PathSegment 中，而不是在开始新行时清除它（通过单击鼠标左键）。因此，我会尝试这个：

```
private void Window_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    _pathFigure.Segments.Clear();
    _pathFigure.StartPoint = e.GetPosition(this);
} 
```

编辑：...如果您希望它保留线条并且它们不一定连接，则每条线都需要一个单独的路径，因为每个路径代表一个单一的连接形状。

为此，您需要以这种方式修改代码：

*   从 XAML 中删除路径
*   对于每一次鼠标左键单击，创建一个新路径并将其添加到网格（myGrid.Children.Add(myPath)
*   从鼠标移动到当前活动路径添加新点

# device-detection - 检测网站上的移动流量

> ID：16195271
> 
> 赞同：0
> 
> 时间：2013-04-24T14:56:31.593
> 
> 标签：device-detection

好的，我们开始吧，我会尽量把它说清楚。

我制作了一个可以用任何手机、平板电脑和电脑都可以非常清晰地查看的网站；我即将拥有一个应用程序。我一直在寻找没有运气的是如何提示移动设备关于我的应用程序？我希望可能会出现一个窗口，说我们有一个应用程序现在获取它按钮或一个继续按钮，这导致我们的完整站点，我遇到的问题是我发现的每个移动检测脚本只能检测到我可以告诉我，我似乎无法让它以一种方式向移动用户发送，而以另一种方式向计算机发送（脚本是 php），另一种是 jquery，但是当我用移动浏览器查看该网站时，看起来都很疯狂，因为我必须得到jquery 作为重定向工作。

下一个问题是我完全不知道如何或曾经为该应用程序发送用户。我想做的一个完美的例子是[http://www.bankofamerica.com](http://www.bankofamerica.com)但我想继续按钮去完整的网站。

希望这不是冗长的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T18:25:29.693

好的，对于任何想知道这是我能找到的最佳选择，也是迄今为止对用户来说最不烦人的选择。

下载：[https ://code.google.com/p/php-mobile-detect/](https://code.google.com/p/php-mobile-detect/)

并将其写在您的页面中，或者您希望这样做。我在课程的网页上混合使用了我自己的样式和引导样式。

`<?php if($detect->isIOS()) : ?>`

`<div class="alert alert-block alert-success" id="mobileApp" style="position:absolute; left:10px; top:15px; z-index:1003; width:910px; text-align:center;"> <button type="button" class="close" data-dismiss="alert">Close</button> <div class="span3"><img src="imgs/if.png" width="125" height="125"></div> <div class="span5"><h3>we are on the go!</h3></div>`

`<div class="row"> <div class="span4"><h4>Download our app TODAY!</h4>` `<a href="#" class="btn btn-success btn-large " style="color:#fff;">`下载 iPhone 应用程序 `</a>` `</div>`

`</div>` `</div>`

`<?php endif; ?>`

你可以对 android 重复这个

```
<?php if($detect->isAndroidOS()) : ?> 
```

# three.js - Three.js 视频纹理和 GPU

> ID：16195272
> 
> 赞同：0
> 
> 时间：2013-04-24T14:56:32.443
> 
> 标签：three.js, html5-video, gpu

我可以在页面上加载 HTML 5 视频元素，将它们映射到 THREE.Texture，并在 3d 中使用 MeshBasicMaterial 在立方体上显示视频纹理。（所有视频都设置为自动播放和循环播放。）每个动画/渲染周期，对于我检查的每个纹理：

```
if (video.HAVE_ENOUGH_DATA)
   texture.needsUpdate = true 
```

随着我加载越来越多的视频以这种方式播放，帧率继续下降。如果我能做些什么来提高性能怎么办？我需要将视频作为 DOM 元素加载吗？无论如何我可以利用片段着色器/GPU进行并行化吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T17:17:28.400

这里有几件事我会尝试......

1.  以 Javascript 加载视频元素，不附加到 DOM。如果视频是 ，它可能不会有太大的不同`display: none`，但它不会受到伤害。

2.  使视频更小。在这种情况下，只有良好的压缩是不够的，因为瓶颈很可能是将未压缩的视频帧复制到 GPU 内存。

3.  在每一帧上，检查`.currentTime`每个视频是否发生了变化。如果您在帧之间，则可能不需要更新纹理。您最终可能会偏离一帧，因为即使在更新后有时也需要几毫秒来更新视频帧`currentTime`。但这通常只有在视频暂停时才会注意到。通常，我有一个特殊情况，如果视频暂停，我会在每一帧再更新半秒左右。

4.  您可以尝试将视频尺寸设置为 2 的幂。这可能取决于 GPU 硬件，但测试它并没有什么坏处。

5.  如果视频长度相同并在同一时间轴上播放，则将它们合并为一个，将它们全部加载到单个纹理中并相应地设置 UV 坐标可能会有所帮助。

更一般地说，您可能应该关注：

*   将视频帧复制到 GPU 内存中。不经常，也不比必要的大。
*   减少浏览器管理视频文件的开销

# c++ - 获取地址时函数模板的隐式实例化

> ID：16195273
> 
> 赞同：7
> 
> 时间：2013-04-24T14:56:32.710
> 
> 标签：c++, templates, language-lawyer

注意：我已经看过[这里](https://stackoverflow.com/questions/6735720/what-are-the-rules-around-instantiation-of-template-types-class-function-when)，我认为答案不正确。

获取地址时，管理函数隐式实例化的规则是什么？n3242 的 14.7.1/9 说：

> 实现不应隐式实例化不需要实例化的类模板的函数模板、成员模板、非虚拟成员函数、成员类或静态数据成员。

现在，当然不需要有一个函数定义来获取它的地址。我们可以获取前向声明函数的地址，并将它们定义在不同的翻译单元中。

既然如此，我不知道什么时候需要。然而，编译器似乎有自己的想法。在 GCC 和 VC 上进行测试，这里有几个例子：

```
template <typename T> void CallBanana() { T::Banana(); }
template <typename T> void CallUnimpl();

template <typename T>
struct S {
    static void CallBanana() { T::Banana(); }
    static void CallOrange() { T::Orange(); }
    static void CallUnimpl();
};

struct B { static void Banana() {} };

int main() {
    (void)(&CallBanana<void>); // 1
    (void)(&CallUnimpl<void>); // 2
    (void)(&S<void>::CallBanana); // 3
    (void)(&S<void>::CallOrange); // 4
    (void)(&S<void>::CallUnimpl); // 5
    (void)(&S<B>::CallBanana); // 6
} 
```

这些应该一次注释一个以查看效果。

[此处测试的](http://ideone.com/rCy47p)GCC 4.7会抱怨 1、3 和 4。因此，如果存在，它会实例化所有定义。

VC 2010（没有在线测试，抱歉）实例化 3 和 4，但不实例化 1。

[此处测试](http://tinyurl.com/cwjzdls)的Clang 3.0与 VC 2010 具有相同的行为。

没有编译器会抱怨 2 或 5，这是我所期望的。如果我实际使用这些指针，我希望它无法链接。

在所有编译器上，6 次编译。我期待这一点，但它旨在表明整个类模板没有被实例化（如另一个问题的答案中所述），只是因为我获取了单个函数的地址。如果整个模板被实例化，那么 S::CallOrange 不应该编译，因为 B 不包含 Orange 函数。

所以我想知道是否有人对正确的行为应该是什么有明确的答案。该标准似乎声称不应实例化任何函数，但三个流行的编译器在某些情况下会实例化，但也彼此不同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T16:28:03.167

如果您获取其地址（在评估的上下文中），则需要定义函数。

当然，定义可以在单独的翻译单元中给出，但这不会改变需要定义的事实。

如果只需要一个成员函数，这并不意味着其他成员函数也会被实例化。

如果函数模板未定义，则不能隐式实例化。然后必须在另一个翻译单元中显式实例化它。不允许依赖另一个翻译单元中的隐式实例化（但不需要诊断）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:05:13.220

需要进行实例化，因为模板的扩展可能不会产生格式良好的代码。

事实上，实例化甚至可能不会产生有效的原型（这种失败将被视为“非失败”）。

（当涉及 SFINAE 时，在选择实际候选地址之前，所采用的有效地址可能会忽略部分排序中的几个较早的候选者（因为替换失败不是错误）。）

# ruby-on-rails - Rails RABL 助手从索引视图发送对象

> ID：16195281
> 
> 赞同：0
> 
> 时间：2013-04-24T14:56:53.643
> 
> 标签：ruby-on-rails, ruby, rabl

我有这样的 index.rabl：

```
collection @exchangers, :root => "bank", :object_root => false

extends "exchanger_lists/show" 
```

和这样的show.rabl：

```
object @exchanger
attributes :id, :name, :address, :location_id, :latitude, :longitude, :exchanger_type_id
node(:location_name) {|exchanger_list| exchanger_list.location.name }
node(:exchanger_type_name) {"normal" }
child currencies(@exchanger)  do
  attribute :value, :direction_of_exchange_id, :exchanger_list_id
end 
```

我的控制器是这样的：

```
 def index
    @exchangers = ExchangerList.all
  end
  def show
    @exchanger = ExchangerList.find(params[:id])
  end 
```

当我在浏览器中打开我的显示操作时，一切正常，向我的助手发送@exchanger 对象，一切正常。但！当我调用索引操作时，我得到：

```
Called id for nil, which would mistakenly be 4 -- if you really wanted the id of nil, use object_id 
```

有数据一切正常...

当我使用索引 rabl 视图来帮助 @exchanger 对象时如何发送？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:16:51.243

呵呵）自己找，会分享：

我必须写的是：root_object

```
object @exchanger
attributes :id, :name, :address, :location_id, :latitude, :longitude, :exchanger_type_id
node(:location_name) {|exchanger_list| exchanger_list.location.name }
node(:exchanger_type_name) {"normal" }
child currencies(root_object)  do
  attribute :value, :direction_of_exchange_id, :exchanger_list_id
end 
```

# wpf - 从 RDP 会话访问时 wpf 应用程序崩溃而不显示任何错误消息

> ID：16195283
> 
> 赞同：1
> 
> 时间：2013-04-24T14:56:56.850
> 
> 标签：wpf, wpf-4.0

从过去 7 天开始，我一直在研究这个问题，但无法弄清楚实际原因。我为 WPF 应用程序创建了一个 MSI 并将其安装在 Windows 7 机器上。如果我以物理方式登录该机器并访问应用程序，一切正常。

但是当我使用远程桌面会话访问应用程序时，应用程序崩溃而没有显示任何错误。我在事件查看器中检查了应用程序日志，发现以下错误

**1\. .Net 运行时错误：**

**应用程序：Myapplication.exe**

**框架版本：v4.0.30319**

**说明：由于 IP732E1F88 (732B0000) 的 .NET 运行时出现内部错误，退出代码为 80131506，进程已终止**

**2\. 应用错误：**

说明：错误应用程序名称：，版本：，时间戳：0x4e11b8da

错误模块名称：KERNELBASE.dll，版本：6.1.7601.17651，时间戳：0x4e211319

异常代码：0xc0000005

故障偏移：0x0000b9bc

错误进程ID：0xd44

错误的应用程序启动时间：0x01ce40fa0f61d32c

错误的应用程序路径：

错误模块路径：C:\Windows\syswow64\KERNELBASE.dll

报告编号：

有人可以帮我解决我哪里出错了还是我需要更改任何设置

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:14:52.843

您是否阅读过：[WPF 全局异常处理程序](https://stackoverflow.com/questions/1472498/wpf-global-exception-handler)，以便您可以获取有关异常的更多信息？

把这样的东西放在你的 App.xaml.cs

```
protected override void OnStartup(StartupEventArgs e)
{
    AppDomain.CurrentDomain.UnhandledException += CurrentDomain_UnhandledException;
    base.OnStartup(e);
}

static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
{
   MessageBox.Show(String.Format("Error: {0} ", e.ExceptionObject));
} 
```

# html - 如何在 Outlook 2007 中制作响应式网格？

> ID：16195284
> 
> 赞同：1
> 
> 时间：2013-04-24T14:56:57.377
> 
> 标签：html, email, responsive-design, html-email, outlook-2010

我正在电子邮件中创建一个 3x3 网格布局，我已经用表格完成了。我还让它具有移动响应性，以便在移动设备上查看时，网格会调整为 2x2。这一切都很好，但出于某种原因，在 Outlook 2007 及更高版本中，它显示了网格，因此将它们一个接一个地显示。我知道 Outlook 有其限制，但有人知道解决这个问题的方法吗？我已经盯着我的代码很久了。

这是我的代码（抱歉，我的代码不能超过 30000 个字符）

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>

</head>
<body style="background:#ffffff">
<table cellpadding="0" cellspacing="0" border="0" width="100%" id="background_table" style="background:#ffffff">

    <tr>
        <td align="center">
            <table width="615" border="0" cellpadding="0" cellspacing="0" id="main_content" style="background:#ffffff">
              <tr>
                <td align="center">
                    <table border="0" cellspacing="0" cellpadding="0" id="inner_content">
                      <tr>
                        <td align="center"><a href="http://www.emailtest.net/?utm_source=email&utm_medium=email&utm_campaign=13_03_CG_EmailTemplate"><img src="http://www.emailtest.net/EmailTemplate/images/Top.jpg" alt="" width="602" height="89" border="0" class="width320 top" style="display:block"/></a></td>
                      </tr>
                      <tr>
                        <td align="center"><img src="http://www.emailtest.net/EmailTemplate/images/Banner.png" width="602" height="321" border="0"  style="display:block" class="width320 banner"/></td>
                      </tr>
                      <tr class="hide">
                        <td align="center" class="hide">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="center"><!-- End of #content_rows -->
                        </td>
                      </tr>
                      <tr>
                        <td align="center"><table width="566" border="0" cellspacing="0" cellpadding="0" class="width280">
                          <tr>
                            <td align="center">

                             <table width="276" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left;" class="width320">
                                          <tr >
                                            <td width="361" ><table width="156" border="0" cellspacing="0" cellpadding="0" >
                                              <tr >
                                                <td align="center"><table width="100%" height="19" border="0" cellpadding="0" cellspacing="0" class="width320">
                                                  <tr bgcolor="#e4e4e4">
                                                    <td width="10"></td>
                                                    <td><table width="100%" border="0" cellspacing="0" cellpadding="0">
                                                      <tr>
                                                        <td height="10"></td>
                                                      </tr>
                                                      <tr>
                                                        <td align="left"><span style="font-family:Arial, Helvetica, sans-serif; font-size:14px; color:#33363e; line-height:16px !important;">Welcome to the latest  enewsletter. <Strong>Click to download pictures</Strong> or <strong>click on the link above to view it in your browser</strong> and view such offers as <strong>plus much more...</strong></span></td>
                                                      </tr>
                                                      <tr>
                                                        <td height="10"></td>
                                                      </tr>
                                                    </table></td>
                                                    <td width="10"></td>
                                                  </tr>
                                                </table></td>
                                              </tr>
                                              <tr class="width280">
                                                <td align="center"  height="10"></td>
                                              </tr>
                                              <tr class="width280">
                                                <td align="center" ><table width="276" border="0" cellspacing="0" cellpadding="0" class="width280" style="margin-bottom:20px">
                                                  <tr>
                                                    <td width="134"><a href="http://www.emailtest.net/"><img src="http://www.emailtest.net/EmailTemplate/images/freedel.jpg" width="134" height="131" border="0" style="display:block"/></a></td>
                                                    <td width="8">&nbsp;</td>
                                                    <td width="134"><a href="http://www.emailtest.net/"><img src="http://www.emailtest.net/EmailTemplate/images/tiger.jpg" width="135" height="133" border="0" style="display:block"/></a></td>
                                                  </tr>
                                                </table></td>
                                              </tr>
                                            </table>
                                            </td>
                                          </tr>

                                        </table>
                             <table width="277" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:right;" class="width280 mobfloat" >
                                         <tr>
                                            <td width="277" valign="top" align="right" class="mobalign">
                                            <a href="http://www.emailtest.net/special-offers/?utm_source=email&utm_medium=email&utm_campaign=13_03_CG_EmailTemplate"><img src="http://www.emailtest.net/EmailTemplate/images/bargain.jpg" width="267" height="280" border="0" style="display:block; float:right;" class="bargain" align="top"/></a>

                                            </td>
                               </tr>

                              </table></td>

                          </tr>
                        </table></td>
                      </tr>

                      <tr><td height="20"></td></tr>

                      <tr>
                        <td align="center">
                      <table width="560" border="0" cellspacing="0" cellpadding="0" class="width280" align="center">
                                      <tr>
                                        <td align="center" >
                                        <table width="178" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left;" class=" products">
                                          <tr class="products">
                                            <td width="178" style="padding:10px; border:1px solid #cccccc;" class=" products"><table width="156" border="0" cellspacing="0" cellpadding="0" class="products">
                                              <tr class=" products">
                                                <td style="border-bottom:1px solid #cccccc;" class="products" align="center"><img src="http://www.emailtest.net/uploads/images/m/fm_2011_11_16_12_56_24_45772.jpg" width="156" height="217" border="0"  class="productimage" style="display:block"/></td>
                                              </tr>
                                              <tr class="products">
                                                <td align="center" class="products"><span style="font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#666666"><br />
                                                Product
<br />
<strong><span style="font-size:14px; color:#000000;">&pound;14.00</span></strong><br />
<strong><span style="font-size:10px; color:#ff0000;">WAS &pound;50 SAVE £36</span></strong></span></td>
                                              </tr>
                                            </table>
                                            </td>
                                          </tr>
                                          <tr class="products">
                                            <td height="50"><img src="http://www.emailtest.net/EmailTemplate/images/BuyNow.jpg" alt="Buy Now" width="178" height="33" border="0" class="buynow" style="display:block" /></td>
                                          </tr>
                                        </table>
                                        <table width="178" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left; margin-left:4px;" class="products">
                                          <tr>
                                            <td width="178" style="padding:10px; border:1px solid #cccccc;" class="products" align="center">
                                            <table width="156" border="0" cellspacing="0" cellpadding="0" class="products">
                                              <tr>
                                                <td style="border-bottom:1px solid #cccccc;" class="products" align="center" ><img src="http://www.emailtest.net/uploads/images/m/fm_2013_02_21_09_49_58_44302.jpg" width="156" height="217" border="0"  class="productimage" style="display:block"/></td>
                                              </tr>
                                              <tr>
                                                <td align="center" class="producttext">
                                                  <span style="font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#666666"><br />
                                                  Product<br />
                                                  <strong><span style="font-size:14px; color:#000000;">&pound;14.00</span></strong><br />
                                                  <strong><span style="font-size:10px; color:#ff0000;">WAS &pound;50 SAVE £36</span></strong></span></td>
                                              </tr>
                                            </table>
                                            </td>
                                          </tr>
                                          <tr>
                                            <td height="50"><img src="http://www.emailtest.net/EmailTemplate/images/BuyNow.jpg" alt="Buy Now" width="178" height="33" border="0" class="buynow" style="display:block" /></td>
                                          </tr>
                                        </table>
                                        <table width="178" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left; margin-left:4px" class="products">
                                          <tr>
                                            <td width="178" style="padding:10px; border:1px solid #cccccc;" class="products">
                                            <table width="156" border="0" cellspacing="0" cellpadding="0" class="products">
                                              <tr>
                                                <td style="border-bottom:1px solid #cccccc;" class="products" align="center" ><img src="http://www.emailtest.net/uploads/images/m/fm_2013_02_21_09_38_07_98337.jpg" width="156" height="217" border="0"  class="productimage" style="display:block"/></td>
                                              </tr>
                                              <tr>
                                                <td align="center" class="producttext">
                                                  <span style="font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#666666"><br />
                                                  Product<br />
                                                  <strong><span style="font-size:14px; color:#000000;">&pound;12.50</span></strong><br />
                                                  <strong><span style="font-size:10px; color:#ff0000;">WAS &pound;49.99 SAVE £32.49</span></strong></span></td>
                                              </tr>
                                            </table>
                                            </td>
                                          </tr>
                                          <tr>
                                            <td height="50"><img src="http://www.emailtest.net/EmailTemplate/images/BuyNow.jpg" alt="Buy Now" width="178" height="33" border="0" class="buynow" style="display:block" /></td>
                                          </tr>
                                        </table>
                                        <div style="height:230px; float:left;" class="mobile-gap"></div>
                                        <table width="178" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left;" class="products">
                                          <tr class="products">
                                            <td width="178" style="padding:10px; border:1px solid #cccccc;" class="products"><table width="156" border="0" cellspacing="0" cellpadding="0" class="products">
                                              <tr class="products">
                                                <td style="border-bottom:1px solid #cccccc;" class="products" align="center" ><img src="http://www.emailtest.net/uploads/images/m/fm_2011_12_01_08_21_33_85391.jpg" width="156" height="217" border="0"  class="productimage" style="display:block"/></td>
                                              </tr>
                                              <tr class="products">
                                                <td align="center" class="products"><br /><span style="font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#666666">Product<br />
                                                  <strong><span style="font-size:14px; color:#000000;">&pound;7.50</span></strong><br />
                                                <strong><span style="font-size:10px; color:#ff0000;">WAS &pound;39.99 SAVE £32.49</span></strong></span></td>
                                              </tr>
                                            </table>
                                            </td>

                                          </tr>

                                          <tr class="products">
                                            <td class="products" height="50"><img src="http://www.emailtest.net/EmailTemplate/images/BuyNow.jpg" alt="Buy Now" width="178" height="33" border="0" class="buynow" style="display:block" /></td>
                                          </tr>
                                        </table>
                                        <table width="178" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left; margin-left:4px" class="products">
                                          <tr>
                                            <td width="178" style="padding:10px; border:1px solid #cccccc;" class="products" align="center">
                                            <table width="156" border="0" cellspacing="0" cellpadding="0" class="products">
                                              <tr>
                                                <td style="border-bottom:1px solid #cccccc;" class="products" align="center" ><img src="http://www.emailtest.net/uploads/images/m/fm_2011_12_01_08_20_51_63544.jpg" width="156" height="217" border="0"  class="productimage" style="display:block"/></td>
                                              </tr>
                                              <tr>
                                                <td align="center" class="producttext"><br />
                                                  <span style="font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#666666">Product<br />
                                                  <strong><span style="font-size:14px; color:#000000;">&pound;7.50</span></strong><br />
                                                <strong><span style="font-size:10px; color:#ff0000;">WAS &pound;39.99 SAVE £32.49</span></strong></span></td>
                                              </tr>
                                            </table>
                                            </td>
                                          </tr>
                                          <tr>
                                            <td height="50"><img src="http://www.emailtest.net/EmailTemplate/images/BuyNow.jpg" alt="Buy Now" width="178" height="33" border="0" class="buynow" style="display:block" /></td>
                                          </tr>
                                        </table>
                                        <table width="178" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left; margin-left:4px" class="products">
                                          <tr>
                                            <td width="178" style="padding:10px; border:1px solid #cccccc;" class="products"><table width="156" border="0" cellspacing="0" cellpadding="0" class="products">
                                              <tr>
                                                <td style="border-bottom:1px solid #cccccc;" class="products" align="center" ><img src="http://www.emailtest.net/uploads/images/m/fm_2011_12_01_08_22_08_25416.jpg" width="156" height="217" border="0"  class="productimage" style="display:block"/></td>
                                              </tr>
                                              <tr>
                                                <td align="center" class="producttext"><br />
                                                  <span style="font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#666666">Product<br />
                                                  <strong><span style="font-size:14px; color:#000000;">&pound;7.50</span></strong><br />
                                                <strong><span style="font-size:10px; color:#ff0000;">WAS &pound;39.99 SAVE £32.49</span></strong></span></td>
                                              </tr>
                                            </table>
                                            </td>
                                          </tr>
                                          <tr>
                                            <td height="50"><img src="http://www.emailtest.net/EmailTemplate/images/BuyNow.jpg" alt="Buy Now" width="178" height="33" border="0" class="buynow" style="display:block" /></td>
                                          </tr>

                                        </table>

                                        <table width="178" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left;" class="products">
                                          <tr class="products">
                                            <td width="178" style="padding:10px; border:1px solid #cccccc;" class="products"><table width="156" border="0" cellspacing="0" cellpadding="0" class="products">
                                              <tr class="products">
                                                <td style="border-bottom:1px solid #cccccc;" class="products" align="center" ><img src="http://www.emailtest.net/uploads/images/m/fm_2011_06_29_03_03_13_62953.jpg" width="156" height="217" border="0"  class="productimage" style="display:block"/></td>
                                              </tr>
                                              <tr class="products">
                                                <td align="center" class="products"><br />
                                                <span style="font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#666666">Product<br />
                                                <strong><span style="font-size:14px; color:#000000;">&pound;9.99</span></strong><br />
                                                <strong><span style="font-size:10px; color:#ff0000;">WAS &pound;44.99 SAVE £35</span></strong></span></td>
                                              </tr>
                                            </table>
                                            </td>
                                          </tr>
                                          <tr class="products">
                                            <td class="products" height="50"><img src="http://www.emailtest.net/EmailTemplate/images/BuyNow.jpg" alt="Buy Now" width="178" height="33" border="0" class="buynow" style="display:block" /></td>
                                          </tr>
                                        </table>
                                        <table width="178" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left; margin-left:4px" class="products">
                                          <tr>
                                            <td width="178" style="padding:10px; border:1px solid #cccccc;" class="products" align="center">
                                            <table width="156" border="0" cellspacing="0" cellpadding="0" class="products">
                                              <tr>
                                                <td style="border-bottom:1px solid #cccccc;" class="products" align="center" ><img src="http://www.emailtest.net/uploads/images/m/fm_2011_06_29_03_03_58_76474.jpg" width="156" height="217" border="0"  class="productimage" style="display:block"/></td>
                                              </tr>
                                              <tr>
                                                <td align="center" class="producttext"><br />
                                                  <span style="font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#666666">products<br />
                                                  <strong><span style="font-size:14px; color:#000000;">&pound;9.99</span></strong><br />
                                                <strong><span style="font-size:10px; color:#ff0000;">WAS &pound;44.99 SAVE £35</span></strong></span></td>
                                              </tr>
                                            </table>
                                            </td>
                                          </tr>
                                          <tr>
                                            <td height="50"><img src="http://www.emailtest.net/EmailTemplate/images/BuyNow.jpg" alt="Buy Now" width="178" height="33" border="0" class="buynow" style="display:block" /></td>
                                          </tr>
                                        </table>
                                        <table width="178" border="0" cellspacing="0" cellpadding="0" style="display:inline-block; float:left; margin-left:4px" class="products">
                                          <tr>
                                            <td width="178" style="padding:10px; border:1px solid #cccccc;" class="products"><table width="156" border="0" cellspacing="0" cellpadding="0" class="products">
                                              <tr>
                                                <td style="border-bottom:1px solid #cccccc;" class="products" align="center" ><img src="http://www.emailtest.net/uploads/images/m/fm_2011_06_29_03_05_17_24091.jpg" width="156" height="217" border="0"  class="productimage" style="display:block"/></td>
                                              </tr>
                                              <tr>
                                                <td align="center" class="producttext"><br />
                                                  <span style="font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#666666">products<br />
                                                  <strong><span style="font-size:14px; color:#000000;">&pound;9.99</span></strong><br />
                                                <strong><span style="font-size:10px; color:#ff0000;">WAS &pound;44.99 SAVE £35</span></strong></span></td>
                                              </tr>
                                            </table>
                                            </td>
                                          </tr>
                                          <tr>
                                            <td height="50"><img src="http://www.emailtest.net/EmailTemplate/images/BuyNow.jpg" alt="Buy Now" width="178" height="33" border="0" class="buynow" style="display:block" /></td>
                                          </tr>

                                        </table>

                                        </td>
                                      </tr>
                          </table>
                        </td>
                      </tr>
                      <tr>

                        <td>&nbsp;</td>
                      </tr>

                       <tr>

                            <td><img src="http://www.emailtest.net/EmailTemplate/images/search_banner.jpg" alt="How to search" width="602" height="182" border="0" class="width320 search" style="display:block"/></td>
                      </tr>

                       <tr>

                            <td><img src="http://www.emailtest.net/EmailTemplate/images/footer.jpg" alt="" width="602" height="190" border="0" class="width320 footer" style="display:block" /></td>
                      </tr>

                      <tr>
                        <td align="center">
                        <table width="560" border="0" cellpadding="0" cellspacing="0" id="content_rows">
                              <tr>
                                <td align="left">
                               <p><br />
                                 <br />
                                 <br /><br />
                                 </p>
                                </td>
                              </tr>
                            </table><!-- End of #content_rows -->
                        </td>
                      </tr>
                    </table><!-- End of #inner_content -->
                </td>
              </tr>
            </table><!-- End of #main_content --> 
        </td>
    </tr>
</table> <!-- End of #background_table --> 

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T19:07:53.760

## Outlook 2007+ 不支持浮动元素

在上面的代码中，每个网格元素都是一个具有以下内联样式的 HTML 表格：

```
float:left;
display:inline-block; 
```

**电子邮件阅读器支持**

*   `float`Outlook 2007+、Gmail 不支持
*   `display`Outlook 2007+ 不支持

## 布局选项

*非响应式布局*

*   将每个网格元素放在单独的表格单元格中。

*响应式布局*

*   将每个网格元素放在同一个表格单元格（它们当前是）中，然后添加`align="left"`到每个网格元素。

**HTML**

```
<table width="560" align="center">
    <tr>
        <td align="center">

            <!-- Each grid element -->
            <table width="178" align="left">...</table>
            <table width="178" align="left">...</table>
            <table width="178" align="left">...</table>
        </td>
    </tr>
</table> 
```

我使用 Litmus 在 Outlook 2007/2010/2013 中对此进行了测试，并取得了一些成功。

# java - Java - 什么是负债信号量

> ID：16195285
> 
> 赞同：0
> 
> 时间：2013-04-24T14:56:57.930
> 
> 标签：java, multithreading, semaphore

在一个代码示例中，据说线程重新同步是基于信令，使用负债信号量。

```
final Semaphore indebtedSemaphore = new Semaphore(1 - PROCESSOR_COUNT); 
```

这个负信号量的目的是什么，我的笔记本用-3初始化

```
/**
 * Sums two vectors, distributing the work load into as many new child threads as there
 * are processor cores within a given system. Note that the added cost of thread
 * construction and destruction is higher than the gain of distributing the work for
 * practically any vector size.
 * @param leftOperand the first operand
 * @param rightOperand the second operand
 * @return the resulting vector
 * @throws NullPointerException if one of the given parameters is null
 * @throws IllegalArgumentException if the given parameters do not share the same length
 */
public static double[] add(final double[] leftOperand, final double[] rightOperand) {
    if (leftOperand.length != rightOperand.length) throw new IllegalArgumentException();
    final double[] result = new double[leftOperand.length];

    final int sectorWidth = leftOperand.length / PROCESSOR_COUNT;
    final int sectorThreshold = leftOperand.length % PROCESSOR_COUNT;
    final Semaphore indebtedSemaphore = new Semaphore(1 - PROCESSOR_COUNT);

    for (int threadIndex = 0; threadIndex < PROCESSOR_COUNT; ++threadIndex) {
        final int startIndex = threadIndex * sectorWidth + (threadIndex < sectorThreshold ? threadIndex : sectorThreshold);
        final int stopIndex  = startIndex  + sectorWidth + (threadIndex < sectorThreshold ? 1 : 0);
        final Runnable runnable = new Runnable() {
            public void run() {
                try {
                    for (int index = startIndex; index < stopIndex; ++index) {
                        result[index] = leftOperand[index] + rightOperand[index];
                    }
                } finally {
                    indebtedSemaphore.release();
                }
            }
        };
        // EXECUTOR_SERVICE.execute(runnable);                          // uncomment for managed thread alternative!
        new Thread(runnable).start();                                   // comment for managed thread alternative!
    }

    indebtedSemaphore.acquireUninterruptibly();
    return result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T13:56:41.097

源代码中的注释->

```
public static double[] add (final double[] leftOperand, final double[] rightOperand) {
        if (leftOperand.length != rightOperand.length) throw new IllegalArgumentException();
        final double[] result = new double[leftOperand.length];
    //--------------------------------------------------------------
    //EXAMPLE: 3 Cores, vector length 10 
    //--------------------------------------------------------------

    final int sectorWidth = leftOperand.length / PROCESSOR_COUNT;
    final int sectorThreshold = leftOperand.length % PROCESSOR_COUNT;
    //indebtedSemaphore (-2) ..  to wait for a unindebted semaphore
    final Semaphore indebtedSemaphore = new Semaphore(1 - PROCESSOR_COUNT);

    //for each core a thread
    for (int threadIndex = 0; threadIndex < PROCESSOR_COUNT; ++threadIndex) {
        //ranges 0-4 , 4-7, 7-10  
        final int startIndex = threadIndex * sectorWidth + (threadIndex < sectorThreshold ? threadIndex : sectorThreshold);
        final int stopIndex = startIndex + sectorWidth + (threadIndex < sectorThreshold ? 1 : 0);
        final Runnable runnable = new Runnable() {
            public void run () {
                try {
                    for (int index = startIndex; index < stopIndex; ++index) {
                        result[index] = leftOperand[index] + rightOperand[index];
                    }
                } finally {
                    //semaphore dept:-2,-1,0,
                    indebtedSemaphore.release();
                }
            }
        };
        // EXECUTOR_SERVICE.execute(runnable);                          // uncomment for managed thread alternative!
        new Thread(runnable).start();                                   // comment for managed thread alternative!
    }

    //wait for unindebted semaphore 
    indebtedSemaphore.acquireUninterruptibly();
    return result;
} 
```

# fitbit - Fitbit 订阅 API

> ID：16195289
> 
> 赞同：5
> 
> 时间：2013-04-24T14:57:01.043
> 
> 标签：fitbit

我已经使用 Fitbit 的 PHP 库 (www.disciplinexgames.com/fitbit) 在我的网站中成功集成了 FitBit api。它工作正常，但我现在想使用订阅 API，以便我们可以在新数据可用时立即更新数据库中的数据。我已经浏览了订阅 API 文档并使用订阅者端点注册了应用程序，但是在获取更新通知时我迷路了。在我应该在我的代码中添加或更改什么等方面，文档并没有真正得到太多帮助。是否有任何与订阅 API 相关的 PHP 示例代码或我应该做什么的建议。

工作网址：[http ://www.disciplinexgames.com/fitbit/](http://www.disciplinexgames.com/fitbit/)

任何帮助将不胜感激。有点沮丧，因为我没有收到任何错误，但同时也没有更新通知。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-07-06T13:17:43.150

很抱歉这个答案迟到了两年，但也许它会对某人有所帮助。

一旦您知道用户的令牌和令牌秘密，您就可以使用以下 OAUTH POST 请求订阅他们的提要。此 URL 用于他们的活动提要。

```
<?php
$consumerKey = "lajsdf23l4l8asdfn238ladf8xjk92oi"; //From Fitbit's website when you sign up for an app
$consumerSecret = "l8adl3halsdf82p9adfads2gjadsf"; //From Fitbit's website when you sign up for an app
$oauth = new OAuth($consumerKey,$consumerSecret,OAUTH_SIG_METHOD_HMACSHA1,OAUTH_AUTH_TYPE_AUTHORIZATION);

$usersToken = "k28a9wifvnc89w2o8oigaad8e23r23jf";
$usersSecret = "234o8fdofsy8df89aydfoyo84e2902af";
$oauth->setToken($usersToken,$usersSecret);

$subscriptionURL = "https://api.fitbit.com/1/user/-/activities/apiSubscriptions.json";

try{
    //Send a POST to subscribe as stated on https://wiki.fitbit.com/display/API/Fitbit+Subscriptions+API
    $oauth->fetch($subscriptionURL, null, OAUTH_HTTP_METHOD_POST); 
    print_r(json_decode($oauth->getLastResponse())); // Make sure the request was successful 
}
catch(Exception $e){
    echo 'ERROR:';
    print_r($e);
    print_r($oauth->getRequestHeader('POST', $url));
} 
```

您的订阅者 URL 端点应该是一个网页，您可以在其中有一些代码可以接收 Fitbit 数据并执行您需要使用它完成的任何操作。下面是一些可以帮助您入门的 PHP 代码。

```
<?php   
// Get the input data and create a PHP object to use.
$fitbitPushData = file_get_contents("php://input");
$fitbitData = json_decode($fitbitPushData); 
```

[出于测试目的，我建议首先在http://requestb.in/](http://requestb.in/)创建一个 RequestBin并将其用作您的订阅者端点 URL。通过这种方式，您可以轻松查看有人同步时 Fitbit 发送的数据。您可以将该 JSON 字符串复制到您的订阅者 URL 端点代码，并在将您的站点设置为订阅端点 URL 之前测试您希望如何处理数据。

我学到的其他一些经验教训：

根据您拥有的用户数量，您可能希望您的订阅者 URL 位于不同的服务器上。每次用户同步他们的 Fitbit 时，都会点击此 URL，这可能会导致大量流量。如果 Fitbit 有 10% 或更多的时间失败或无法在 3 秒内响应，Fitbit 将禁用您的订阅者 URL。

另一个重要部分是这不会向您发送用户的最新数据。它只会让您知道他们已经更新了他们的数据。您仍然需要发出 API 请求才能获取他们的最新数据。每个用户每小时只能发出 150 个 API 请求，因此最好限制检查每个用户的频率。我有一些用户经常同步，导致每小时都会收到来自 Fitbit 的电子邮件，说明我的应用程序超出了这些用户的速率限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-11T22:11:37.613

使用 Fitbit Web API 时需要注意的事项很少。这是我在整合过程中发现的。

*   订阅 URL 需要接受机器人 POST 和 GET 请求。验证 URL 时使用 GET 请求部分。**Fitbit 使用verify**作为查询参数向订阅 URL 发出请求。

    [https://test.demo.com/subscribe?verify=0fcf8334068f84392c2d248060555645b273ef1ada782b25d0ddcb9db32f57a6](https://test.demo.com/subscribe?verify=0fcf8334068f84392c2d248060555645b273ef1ada782b25d0ddcb9db32f57a6)

    在服务器端，需要在验证成功时发送 204 响应状态，在失败时发送 404 响应状态。

    该路由通过 POST 请求接受通知及其 JSON 正文中的数据，您可以根据需要进行处理。响应状态应始终为 204。

*   注册并验证您的订阅回调 URL 后，您需要通过 Fitbit 的订阅 API 添加订阅。

    [https://api.fitbit.com/1/user/-/apiSubscriptions/someName.json](https://api.fitbit.com/1/user/-/apiSubscriptions/someName.json)

    如您所见，我没有传递任何导致所有类别都被订阅的类别。

    此请求必须使用授权承载方案发出，该方案利用您从服务器授权代码中获取的访问令牌。

    该请求是没有正文的 POST 请求。

*   获取访问令牌的 API 需要 x-www-form-urlencoded 方法。

*   确保您继续从仪表板检查成功率。

    [![在此处输入图像描述](https://i.stack.imgur.com/hPtfV.png)](https://i.stack.imgur.com/hPtfV.png)

# c++ - 计算点云中每个点的法线？

> ID：16195297
> 
> 赞同：1
> 
> 时间：2013-04-24T14:57:17.560
> 
> 标签：c++, math, normals, point-clouds

我有一系列形成点云​​的点。我需要计算每个点的法线向量，并从该点向法线向量的方向投射一条光线。在这种情况下，我需要使用什么类型的公式来计算法线向量？

编辑* 我有一系列点（x，y，z）形成一个点云（称为 A），形成一个半球的形状。我还有另一个点云（称为 B），我将其拟合到一个表面，形成另一个半球体，该半球适合 A 内部。我想测量这些表面彼此相距多远的长度，所以我的计划就是从 A 中的每个点投射一条射线到曲面 B 并测量到该点的交点。我希望这个解释能让我的问题更清楚。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:09:54.333

您是否有一个网格，以便您知道一个点连接到哪些其他本地点？

在这种情况下，该点的法线是在该点相遇的每对线之间的叉积的平均值（即归一化为一个单位向量）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T16:38:55.030

1.  你能建立两个网格之间的对应关系吗？也就是说，对于网格 A 中的每个点，由于平移/缩放/旋转，网格 B 中的对应点位于不同的位置。如果是这样，那么您可以使用[Procustes 分析](http://en.wikipedia.org/wiki/Orthogonal_Procrustes_problem)来找到两个云之间的最佳平移/缩放/旋转变换矩阵。在 OP 中提供的示例中，缩放矩阵可以揭示两个网格之间的距离。

2.  如果两个网格是任意的，那么我能想到的最好的算法是首先将两个点云放在同一个八叉树中。从这里，您可以遍历网格 A 中的每个点并找到网格 B 中的最近点。“两个网格之间的最小距离”是迭代后找到的 2 个点之间的最小距离。

2 的替代方案只是蛮力遍历所有点：

```
double min=BIG_NUMBER;
for(Point a : meshA)
   for(Point b : meshB)
       if(dist(a,b)<min) min=dist(a,b); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-23T09:03:46.620

我用 Python 开发了一个[代码](https://github.com/pedrogalher/Normals_Computation)，它将计算点云每个点的法线。您可以将其调整为 C++。

- 基本上你从你的点附近的 k 个点计算单值分解。

它将为您提供有关差异较大和较小位置的信息。

- 然后你选择方差较小的方向（与最小特征值相关的特征向量）。该特征向量是通过您的 k 点（包括您的点 P）的平面的法线。最后，对点云的每个点重复此操作。

# javascript - HighCharts 饼图工具提示未在悬停时显示

> ID：16195299
> 
> 赞同：1
> 
> 时间：2013-04-24T14:57:17.860
> 
> 标签：javascript, asp-classic, highcharts, highstock

我有一个 highCharts 饼图，当使用小提琴时，它会在 mouseOver 上显示数据点的工具提示，以及单击 LegendItem 时的单击事件或饼图的弹出效果，但是当我插入我的代码时进入我的网站，它不适用于任何版本的 IE 或谷歌浏览器。我不知道交易是什么。这是工具提示以及点击事件，但它们在我的代码中都不起作用。

[http://jsfiddle.net/hAnCr/](http://jsfiddle.net/hAnCr/)

```
$("document").ready(
function(){
$('#container').highcharts({
        chart:{
            type:'pie',
            height: 250,
            width: 350
              },
        colors:[
            '#5485BC', '#AA8C30', '#5C9384', '#981A37', '#FCB319',     '#86A033', '#614931', '#00526F', '#594266', '#cb6828', '#aaaaab', '#a89375'
            ],
        title:{text: null},
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                showInLegend: true,
                dataLabels: {
                    enabled: false,                        
                    formatter: function() {
                        return this.percentage.toFixed(2) + '%';
                    }
                },                                  
            }
        },
        legend: {
            enabled: true,
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle'
        },
        series: [{
            type: 'pie',
            dataLabels: {

                    },
            data: [
                ['Domestic Equity', 38.5],
                ['International Equity', 26.85],
                ['Other', 15.70],
                ['Cash and Equivalents', 10.48],
                ['Fixed Income', 8.48]
            ]
        }]
    });
}); 
```

我遇到的第二个问题是我是否可以在数据中执行 switch 语句，基本上创建一个传入 1 个参数并根据参数值更改我的 data[] 值的函数？

谢谢你的帮助，尼克

# c# - EF5 代码优先：IsLoaded 和 .AsNoTracking()

> ID：16195300
> 
> 赞同：4
> 
> 时间：2013-04-24T14:57:19.753
> 
> 标签：c#, .net, entity-framework

我有一个从大部分只读数据库中提取的 EF5 Code First 项目，因此我使用`.AsNoTracking()`绝大多数查询来提高性能。

不过，我很好奇：我有许多导航属性，有时了解它们是否已经加载会很有用，无论是`.Include()`在源查询之后还是由于正在访问的属性（如果已配置用于延迟加载）。

通常我可以这样做：

```
context.Entry(myEntity).Reference(e => e.MyNavigationProperty).IsLoaded; 
```

但自然这不适用于未跟踪的实体，因为它们是未跟踪的。我感觉答案是“否”，但是有没有办法确定导航属性是否已加载到未跟踪的实体上（而不诉诸任何混乱的东西，例如对动态代理的反射）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:36:52.847

下面的解决方案不适用于通过访问未跟踪的实体从 db 加载的实体。尽管对该导航属性的后续引用不会创建数据库命中，但实体框架不会跟踪导航属性。我将此作为如何不这样做的示例；）

如何使用本地？所以假设你有

```
public class MyEntity
{
    public int MyEntityId { get; set;}
    public int MyNavigationPropertyID { get; set;}
    public MNP MyNavigationProperty { get; set; }
}

public class MNP
{
    public int MNPID { get; set;}
} 
```

你可以这样做：

```
context.MyNavigationProperties.Local.Where(e => e.MNPID == MyNavigationProperty); 
```

本地存储当前正在跟踪且未标记为已删除的实体。我还没有测试过，但它应该可以工作。

# c# - XAML，显示没有 URI 的 HTML

> ID：16195305
> 
> 赞同：0
> 
> 时间：2013-04-24T14:57:34.890
> 
> 标签：c#, xaml, webview, windows-store-apps

我正在从 Web 服务中检索大量电子邮件，这些电子邮件将显示在 Windows Store 应用程序中。电子邮件数据当然是 HTML，所以我希望能够在 HT 之后显示没有 ML 的电子邮件。

我面临的问题是用 content 属性填充 WebView，而不是需要 WebView 检索的 URI。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T07:52:58.480

[http://code.msdn.microsoft.com/windowsapps/XAML-WebView-control-sample-58ad63f7](http://code.msdn.microsoft.com/windowsapps/XAML-WebView-control-sample-58ad63f7)

方案 2

看法：

```
<WebView x:Name="WebView"/> 
```

后面的代码：

```
WebView.NavigateToString("<html><body>Goes Here</body></html>"); 
```

# java - 设置 JTextField 的对齐方式

> ID：16195307
> 
> 赞同：2
> 
> 时间：2013-04-24T14:57:39.090
> 
> 标签：java, swing, alignment, jtextfield

我的问题是参考这篇文章[JTextField ：How to set text on the left of JTextField when text too long](https://stackoverflow.com/questions/10309235/jtextfield-how-to-set-text-on-the-left-of-jtextfield-when-text-too-long)

如果字符串太长，有没有办法在下一行而不是单行中显示文本？

现在，它将字符串显示为

```
|----------------------|
| JTextField example ..|
|----------------------| 
```

有什么办法可以做到这样吗？

```
|----------------------|
| JTextField example ..|
|..continue string.....|
|.........end of string|
|----------------------| 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:03:00.647

如果您想要一个包含多行的字段，您应该使用

```
JTextArea textArea = new JTextArea() 
```

相反，因为`JTextField`不支持它（afaik）。

**编辑**
要`JTextArea`滚动你需要把它放在`JScrollPane`这样的地方：

```
JFrame frame = new JFrame();
JTextArea textArea = new JTextArea("Test");
textArea.setLineWrap(true);
//textArea.setWrapStyleWord(true);
JScrollPane scrollPane = new JScrollPane(textArea);
frame.add(scrollPane); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:34:27.267

您的链接帖子表明您只是希望显示一个长字符串。如果您不需要编辑，我建议使用 JLabel 并使用 HTML 标签。

```
JLabel myLabel = new JLabel("<html>I will wrap.</html>"); 
```

# c# - 是否可以使用 StreamWriter c# 水平附加文本？

> ID：16195312
> 
> 赞同：3
> 
> 时间：2013-04-24T14:57:56.523
> 
> 标签：c#, wpf, kinect

我正在使用`Kinect`and 可以将跟踪坐标保存到文本文件中，但我需要为每个 X 和 Y 坐标添加水平（从左到右）的文本，以便绘制图形。目前，文本如下所示：

```
2:58:22 PM

Head X      314

Head Y      250

2:58:22 PM

Head X      314

Head Y      251 
```

但我试图这样得到它：

```
2:58:22 PM               2:58:23 PM

Head X  1   2   3   4  5   6   7  8  9 

Head Y  1   2   3   4  5   6   7  8  9 
```

这是我保存到文本文件的代码：

```
StreamWriter sw = File.AppendText("Text.txt");
sw.WriteLine(DateTime.Now.ToLongTimeString());

sw.WriteLine("Head X   " + "\t" + TextBox21.Text);
sw.WriteLine("Head Y   " + "\t" + TextBox41.Text);

sw.WriteLine("Shoulder X" + "\t" + TextBox22.Text);
sw.WriteLine("Shoulder Y" + "\t" + TextBox42.Text);

sw.WriteLine("ShoulderLeft X" + "\t" + TextBox23.Text);
sw.WriteLine("ShoulderLeft Y" + "\t" + TextBox43.Text);

sw.WriteLine("ShoulderRight X" + "\t" + TextBox24.Text);
sw.WriteLine("ShoulderRight Y" + "\t" + TextBox44.Text);

sw.WriteLine("ElbowLeft X" + "\t" + TextBox25.Text);
sw.WriteLine("ElbowLeft Y" + "\t" + TextBox45.Text);

sw.WriteLine("ElbowRight X" + "\t" + TextBox26.Text);
sw.WriteLine("ElbowRight Y" + "\t" + TextBox46.Text);

sw.WriteLine("WristLeft X" + "\t" + TextBox27.Text);
sw.WriteLine("WristLeft Y" + "\t" + TextBox47.Text);

sw.WriteLine("WristRight X" + "\t" + TextBox28.Text);
sw.WriteLine("WristRight Y" + "\t" + TextBox48.Text);

sw.WriteLine("HandLeft X" + "\t" + TextBox29.Text);
sw.WriteLine("HandLeft Y" + "\t" + TextBox49.Text);

sw.WriteLine("HandRight X" + "\t" + TextBox30.Text);
sw.WriteLine("HandRight Y" + "\t" + TextBox50.Text);

sw.WriteLine("Spine X   " + "\t" + TextBox31.Text);
sw.WriteLine("Spine Y   " + "\t" + TextBox51.Text);

sw.WriteLine("HipCenter X" + "\t" + TextBox32.Text);
sw.WriteLine("HipCenter Y" + "\t" + TextBox52.Text);

sw.WriteLine("HipLeft X" + "\t" + TextBox33.Text);
sw.WriteLine("HipLeft Y" + "\t" + TextBox53.Text);

sw.WriteLine("HipRight X" + "\t" + TextBox34.Text);
sw.WriteLine("HipRight Y" + "\t" + TextBox54.Text);

sw.WriteLine("KneeLeft X" + "\t" + TextBox35.Text);
sw.WriteLine("KneeLeft Y" + "\t" + TextBox55.Text);

sw.WriteLine("KneeRight X" + "\t" + TextBox36.Text);
sw.WriteLine("KneeRight Y" + "\t" + TextBox56.Text);

sw.WriteLine("AnkleLeft X" + "\t" + TextBox37.Text);
sw.WriteLine("AnkleLeft Y" + "\t" + TextBox57.Text);

sw.WriteLine("AnkleRight X" + "\t" + TextBox38.Text);
sw.WriteLine("AnkleRight Y" + "\t" + TextBox58.Text);

sw.WriteLine("FootLeft X" + "\t" + TextBox39.Text);
sw.WriteLine("FootLeft Y" + "\t" + TextBox59.Text);

sw.WriteLine("FootRight X" + "\t" + TextBox40.Text);
sw.WriteLine("FootRight Y" + "\t" + TextBox60.Text);

sw.Close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:00:23.853

`sw.Write`将允许您编写内联文本。

`WriteLine`创建一个换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:00:28.500

跳过 WriteLine 的“Line”部分，直接使用 Write？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:00:32.607

我在这里可能错了，但我想也许你只是想使用`Write()`而不是`WriteLine()`

`WriteLine()`将在末尾添加换行符。所以你想要的是如下：

```
sw.Write("Head X   " + "\t" + TextBox21.Text); 
```

您可能还需要考虑添加一个额外的分隔符，但这取决于您需要什么作为输出。

# security - Joomla Bug - 可能的安全性 - 我不能确定

> ID：16195315
> 
> 赞同：-3
> 
> 时间：2013-04-24T14:57:59.927
> 
> 标签：security, joomla, captcha, joomla3.0

我相当精通 Joomla，并且在我为客户管理的十个不同站点上运行 3.0.3。我经常登录这些网站以检查一切是否正常。今天第一次，当我进入登录页面时，我遇到了一个带有验证码的页面，上面写着“你是人类”。我查看了源代码，我可以说没有 Joomla 的迹象，所有的 CSS 都包含在文件中。输入验证码后，它会将您带到索引页面。然后奇怪的是，我还查看了另一个站点（不同的服务器一起）并看到了同样的事情。没有明显的黑客尝试（例如内容更改），但奇怪的是，这在一天内第一次发生了两次，看起来很不像 Joomla？

截屏： ![在此处输入图像描述](https://i.stack.imgur.com/fCxXX.png)

有没有其他人经历过这个？我已经搜索过它，但在 Google 等上找不到任何关于它的信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:19:32.383

去问问你的主人，他可能是自己设置的。

# scala - Scala 泛型 - T 有方法限制

> ID：16195318
> 
> 赞同：0
> 
> 时间：2013-04-24T14:58:10.867
> 
> 标签：scala

我是 scala 泛型的新手，我已经阅读了多篇关于视图、类型绑定/上下文绑定的文章。当我试图实现我的课程时，我真的很困惑。

我的问题是，假设我有一个模板类**MyClass[T]{}**。我希望**T**必须有一些方法，例如：

```
def func1(t:T):T
def func2(t:T):Boolean
def func3(t:T):Unit 
```

注意：将使用**MyClass**的类不是**T**因此我不能使用 :< 或 :>

我已经阅读了有关具有隐式功能的 Ordered 和 Ordering 的信息，但我仍然无法弄清楚如何实现它。

感谢帮助者

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:19:57.477

您可以使用类型类来做到这一点。创建一个`trait`，其中包含您需要的方法，并为应支持的每种类型创建一个隐式实例：

```
trait MyTypeClass[T] {
  def func1(t:T):T
  def func2(t:T):Boolean
  def func3(t:T):Unit
}

implicit object MyTypeClassInt extends MyTypeClass[Int] {
  def func1(t:Int) = t + 2
  def func2(t:Int) = t > 4
  def func3(t:Int) = println(s"t is: $t")
} 
```

现在，如果您在类中添加绑定到类型参数的上下文，则只能在给定类型的实例在范围内时实例化它。

```
class MyClass[A : MyTypeClass](a: A)

scala> new MyClass(2)
res0: MyClass[Int] = MyClass@47825164

scala> new MyClass("")
<console>:11: error: could not find implicit value for evidence parameter of type MyTypeClass[String]
              new MyClass("")** 
```

您可以通过调用访问类中的实例`implicitly[MyTypeClass[A]]`。或者，您可以执行以下操作之一：

1.）不要使用上下文绑定，而是向您的类添加一个隐式参数：

```
class MyClass[A](a: A)(implicit ev: MyTypeClass[A]) 
```

2.) 为你的 typeclass 添加一个伴生对象，它有一个 apply 方法，隐式检索实例并返回它：

```
object MyTypeClass {
  def apply[A](implicit ev: MyTypeClass[A]) = ev
} 
```

并像这样在你的课堂上使用它：

```
MyTypeClass[A].func1(a) 
```

# c++ - 无法将 FindFileData.cFileName 转换为字符串

> ID：16195321
> 
> 赞同：5
> 
> 时间：2013-04-24T14:58:22.457
> 
> 标签：c++, winapi

我取得了很大的进展，但我有两个问题已经让我放慢了好几天。最大的是我想保存`FindFileData.cFileName`为字符串，但我不能！有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T11:40:41.660

我从这里复制了这个：[如何将 wstring 转换为字符串？](https://stackoverflow.com/questions/4804298/how-to-convert-wstring-into-string/4804506#4804506) 它将 wstring 直接转换为字符串（包括 FindFileData.cFileName）。有更好的建议或有用的评论吗？

```
#include <clocale>
#include <locale>
#include <string>
#include <vector>

inline std::string narrow(std::wstring const& text)
{
    std::locale const loc("");
    wchar_t const* from = text.c_str();
    std::size_t const len = text.size();
    std::vector<char> buffer(len + 1);
    std::use_facet<std::ctype<wchar_t> >(loc).narrow(from, from + len, '_', &buffer[0]);
    return std::string(&buffer[0], &buffer[len]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:01:59.657

从[`WIN32_FIND_DATA`](http://msdn.microsoft.com/en-gb/library/windows/desktop/aa365740%28v=vs.85%29.aspx)参考页`cFileName`是类型[`TCHAR[]`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383751%28v=vs.85%29.aspx#TCHAR)。如果启用 UNICODE（`TCHAR`是`wchar_t`）使用`std::wstring`：

```
#include <string>
std::wstring ws(FindFileData.cFileName); 
```

否则使用`std::string`（原样`TCHAR`）`char`：

```
std::string ws(FindFileData.cFileName); 
```

或者，为了满足两者：

```
std::basic_string<TCHAR> s(FindFileData.cFileName);
// std::string is a typedef for std::basic_string<char>
// std::wstring is a typedef for std::basic_string<wchar_t> 
```

# c# - 从 xml 文件填充 ViewList

> ID：16195322
> 
> 赞同：-7
> 
> 时间：2013-04-24T14:58:22.563
> 
> 标签：c#, xml, parameters, linq-to-xml

请有人向我解释如何使用 C# 创建以下程序？或者，将不胜感激提供有关执行此操作的说明的链接。我有这个 xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<documents>
  <document id="konsoliduota-saskaita">
    <header>
      <parameter id="kliento-pavadinimas">UAB "ALVORA"</parameter>
      <parameter id="adresas1">VISORIŲ 33</parameter>
      <parameter id="adresas2">VILNIUS</parameter>
      <parameter id="adresas3">08300</parameter>
      <parameter id="adresas4"/>
      <parameter id="kliento-numeris">047539</parameter>
      <parameter id="dokumento-numeris">20077</parameter>
      <parameter id="dokumento-data">2013 04 01</parameter>
      <parameter id="mokejimo-terminas">2013 05 01</parameter>
      <parameter id="imones-kodas">1220</parameter>
      <parameter id="pvm-moketojo-kodas">LT220</parameter>
      <parameter id="viso-uz-paslaugas-be-pvm">10.00</parameter>
      <parameter id="viso-suma-be-pvm">194.36</parameter>
      <parameter id="viso-suma-su-pvm">192.11</parameter>
      <parameter id="periodas">2013 03 01-2013 03 31</parameter>
    </header>
  </document>
</documents> 
```

我的目标是这样做：

* * *

在 ViewList 中`UAB "ALVORA"`，从 ID 的参数中添加一个项目（文本：） `kliento-pavadinimas`。所有其他参数的文本应转到 ViewList 项的子项。

* * *

下图显示了我的目标： [http ://s10.postimg.org/ofgrtgnbt/form.jpg](http://s10.postimg.org/ofgrtgnbt/form.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:09:01.517

您是否看过[如何解析 XML 文件？](https://stackoverflow.com/questions/55828/how-does-one-parse-xml-files), [http://msdn.microsoft.com/en-us/library/cc189056%28v=vs.95%29.aspx](http://msdn.microsoft.com/en-us/library/cc189056%28v=vs.95%29.aspx) , [http://social.msdn.microsoft.com/Forums/en-US/xmlandnetfx/thread /efcb9fe3-8d1a-47b0-a35e-8415ac1a93bd/](http://social.msdn.microsoft.com/Forums/en-US/xmlandnetfx/thread/efcb9fe3-8d1a-47b0-a35e-8415ac1a93bd/)或[http://www.codeproject.com/Articles/7718/Using-XML-in-C-in-the-simplest-way](http://www.codeproject.com/Articles/7718/Using-XML-in-C-in-the-simplest-way)？至少其中一个应该被证明是有用的。

# java - Java socket objectoutputstream 多线程

> ID：16195325
> 
> 赞同：0
> 
> 时间：2013-04-24T14:58:27.797
> 
> 标签：java, sockets, serversocket, objectoutputstream

我有使用多线程将对象发送到 ServerSocket 的代码（当前在本地，但将来在本地网络中）

用于发送对象：

```
public class SocketToAdapter {

public static void writeObject(Object object) {
    try {

        give().writeUnshared(object);

    } catch (IOException e) {
        System.out.println(e.getMessage());
    }
}

static ObjectOutputStream give() {
    Socket s = null;
    try {
        s = new Socket("localhost", 9990);
        s.setTcpNoDelay(true);
        return new ObjectOutputStream(s.getOutputStream());

    } catch (UnknownHostException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return null;
} 
```

主要方法：

```
SocketToAdapter soc = new SocketToAdapter();

    thread1.setSocket(soc);
    thread2.setSocket(soc);
    thread3.setSocket(soc);
    thread4.setSocket(soc);
    thread5.setSocket(soc);

    synchronized (valueExchanging) {
        synchronized (soc) {
            thread1.start();
            thread2.start();
            thread3.start();
            thread4.start();
            thread5.start();
        } 
```

valueExchang 是一个对象，用于在线程之间交换数据。

从线程运行方法：

```
public void run() {
    try {
        while (true) {
            curr = new Object(pair, RandomUtil.getRandomExchange(),
                    RandomUtil.getRandomTurn());
            //not important Business Logic.
                            int v1 = valueExchanger.getExchangeInTread()+1;
            int v2 = valueExchanger.getExchangeInTread()-100;
            curr = new Object(pair, BigInteger.valueOf(v1),
                    BigInteger.valueOf(v2));
                            //
            SocketToAdapter.writeObject(curr);
            valueExchanger.setExchangeInTread(v1);
            Thread.sleep(0, 1);
        }
    } catch (InterruptedException iex) {
    }
} 
```

这有效，但非常缓慢。可能是因为我每次需要时都会创建 Socket 和 ObjectOutputStream 。我尝试创建一个 Socket 和一个 OOS 并像这样使用它：

```
 {
        Socket s = new Socket("localhost", 9990);
        ObjectOutputStream oos = new ObjectOutputStream(s.getOutputStream()); } 
```

接着

```
oos.writeUnshared(object); 
oos.flush(); 
oos.writeUnshared(object); 
```

但是如果我第二次尝试重用oos，我会得到软件导致连接中止：套接字写入错误。不管我使用多少线程。

我需要的是每秒发送许多（例如100k）对象的可能性，有什么建议吗？

在服务器端我做：

服务器.java：

```
 ServerSocket ss;
public static void pre()throws IOException, ClassNotFoundException {
    ss = new ServerSocket(9990);
    }

public static Object start() throws IOException, ClassNotFoundException {
    Object o = null;
    Socket s = ss.accept(); 
    while (!s.isClosed()) {
        ObjectInputStream ois = new ObjectInputStream(s.getInputStream());
        o = (Object) ois.readObject();
        ois.close();
        s.close(); 
    }
    ss.close();
    return o;

} 
```

“主要方法”

```
 while (true) { 

            try {
                Serwer.pre();
                Object o = Serwer.start();
                                    //im do somethink with that object o.
            } catch (IOException e1) {
                e1.printStackTrace();
            } catch (ClassNotFoundException e) {
                e.printStackTrace();
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-02T16:41:07.080

我遇到了同样的问题，并通过对我的套接字使用简单的 Wrapper-Class 来解决它。此类的对象必须出现在需要读/写操作的任何地方。

```
public class Sender implements Closeable 
{
  private final Socket sock;
  private final ObjectOutputStream out;
  private ObjectInputStream in = null;

  private final Object oLock = new Object();
  private final Object iLock = new Object();

  //optional
  public boolean isClosed(){
    return sock.isClosed();
  }

  //there is a better way to do this
  public Socket getSocket(){

    return sock;
  }

  //use this to send data
  public void send(Object o) throws IOException {
    synchronized (oLock){
        getOOS().writeObject(o);
    }
  }

  //use this to read data
  public Object get() throws IOException {
    synchronized (iLock){
        return getOIS().readObject();
    }
  }

  private ObjectOutputStream getOOS() {
    return out;
  }

  //not the best way... but wouldn't work otherwise
  private ObjectInputStream getOIS() throws IOException {
    if(in == null)
        in = new ObjectInputStream(sock.getInputStream());
    return in;
  }

  public Sender(Socket s) throws IOException {
    sock = s;
    out = new ObjectOutputStream(s.getOutputStream());
    //in = new ObjectInputStream(s.getInputStream());
    //getting the input and output stream gave me some weird deadlock
  }

  //optional
  @Override
  public String toString() {
    return sock.toString();
  }

  //flush and close if sock is not yet closed
  @Override
  public void close() throws IOException {
    if(!sock.isClosed()){
        if(out != null)
            out.flush();

        sock.close();
    }
  }
} 
```

这在客户端（Sender 是连接到服务器的 Socket）和服务器（Sender 是连接到客户端的 Socket）中运行良好且快速。

希望这可以帮助。

问候圈

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T16:19:45.293

在客户端，它为每个发送的对象打开一个新的 TCP 连接。这会降低性能，因为建立 TCP 连接需要大量开销。

从您的代码看来，服务器在处理单个对象后似乎正在关闭连接。它还会在处理单个连接后关闭，`ServerSocket`这似乎根本不起作用。提供的服务器代码是否正确？服务器代码中是否存在另一个循环将启动另一个循环`ServerSocket`？

最好的方法可能是让每个客户端线程创建自己的线程`Socket`，每个线程都与服务器有单独的连接。如果您尝试推送大量数据并使用多个线程来实现，那么服务器很可能需要多个线程来处理数据。这些套接字应该被创建一次并被重用于发送所有的对象。

在服务器端，您需要创建一个适当的多线程 TCP 服务器。这里的总体思路是创建一个单一的并在循环中`SocketServer`调用它的`accept()`方法。`while`对于`Socket`从`accept()`您返回的每一个，都将启动一个新线程来处理请求。可以在此处找到示例： [Java 中使用 TCP 的多线程服务器](https://stackoverflow.com/questions/6784280/multithreaded-server-using-tcp-in-java)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T16:34:28.017

我没有 java 套接字方面的经验，但是 s.setTcpNoDelay(true); 我假设您的程序正在使用 tcp 发送数据包，请尝试使用 udp。tcp 协议旨在保证数据包到达目的地，为此它必须在它们到达后验证完整性。另一方面，udp 不这样做，它只发送数据包而不关心完整性，这就是在线多人游戏使用它的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:27:31.163

您在 9990 的服务器是否在读取对象后关闭连接，或者它是否失败？

整理好之后，可以看看使用快速对象序列化器（如[kryo ）优化速度序列化](https://code.google.com/p/kryo/)

# asp.net - 错误 此请求的查询字符串长度超过配置的 maxQueryStringLength 值

> ID：16195326
> 
> 赞同：2
> 
> 时间：2013-04-24T14:58:33.143
> 
> 标签：asp.net, c#-4.0, updatepanel, querystringparameter

嗨，我正在开发一个 Web 应用程序，它工作正常，但昨天我点击一个链接时遇到问题，它给出了错误

```
 The length of the query string for this request exceeds the configured maxQueryStringLength value.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.Web.HttpException: The length of the query string for this request exceeds the configured maxQueryStringLength value.

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.
Stack Trace:

[HttpException (0x80004005): The length of the query string for this request exceeds the configured maxQueryStringLength value.]
   System.Web.HttpRequest.ValidateInputIfRequiredByConfig() +9672501
   System.Web.PipelineStepManager.ValidateHelper(HttpContext context) +53 
```

当我看到它给出的网址时

```
http://www.mysitename.com/Teams/Gallery.aspx**?__EVENTTARGET=ctl00%24ContentPlaceHolder1%24rptWeeks%24ctl04%24lnk&__EVENTARGUMENT=&tbcGallery_ClientState={%22ActiveTabIndex%22%3A2%2C%22TabState%22%3A[true%2Ctrue%2Ctrue]}&__VIEWSTATE=%2FwEPDwUJNDYyMTAzODEzD2QWAmYPZBYCAgMPFgIeBVN0eWxlBRZiYWNrZ3JvdW5kLWNvbG9yOmdyYXk7FgICAQ9kFgICBQ9kFgICAQ9kFgJmD2QWCAIBD2QWAgICD2QWAgIFDxYCHgVjbGFzcwUGYWN0aXZlZAIHDxYCHgtfIUl0ZW1Db3VudAIHFg5mD2QWAgIBDw8WBB4PQ29tbWFuZEFyZ3VtZW50BQIxNR4EVGV4dAUYTWFsYTNpYm5hIFByZW1pZXIgTGVhZ3VlZGQCAQ9kFgICAQ8PFgQfAwUCMjcfBAUTTWFsYTNpYm5hIExlYWd1ZSBJSWRkAgIPZBYCAgEPDxYEHwMFAjMyHwQFEFphaW4gT3BlbiBMZWFndWVkZAIDD2QWAgIBDw8WBB8DBQI0Mh8EBRRaYWluIFVuZGVyIDE4IExlYWd1ZWRkAgQPZBYCAgEPDxYEHwMFAjQzHwQFE1phaW4gT3ZlciAzNSBMZWFndWVkZAIFD2QWAgIBDw8WBB8DBQMxMDYfBAUUWmFpbiBLbm9ja291dCBMZWFndWVkZAIGD2QWAgIBDw8WBB8DBQMxMDgfBAUEdGVzdGRkAgkPFgIfAgIDFgZmD2QWAgIBDw8WBB8DBQIzMx8EBQxCbmVpZCBBbC1RYXJkZAIBD2QWAgIBDw8WBB8DBQIzNB8EBQlBbC1GaW50YXNkZAICD2QWAgIBDw8WBB8DBQIzNR8EBQxBbC1GYXJ3YW5peWFkZAILDxYCHwICCBYQZg9kFgICAQ8PFgQfAwUCMzYfBAUITW9uZGF5IEFkZAIBD2QWAgIBDw8WBB8DBQIzNx8EBQhNb25kYXkgQmRkAgIPZBYCAgEPDxYEHwMFAjM4HwQFCVR1ZXNkYXkgQWRkAgMPZBYCAgEPDxYEHwMFAjM5HwQFCVR1ZXNkYXkgQmRkAgQPZBYCAgEPDxYEHwMFAjQwHwQFC1dlZG5lc2RheSBBZGQCBQ9kFgICAQ8PFgQfAwUCNDEfBAULV2VkbmVzZGF5IEJkZAIGD2QWAgIBDw8WBB8DBQMxMDEfBAUJVHVlc2RheSBDZGQCBw9kFgICAQ8PFgQfAwUDMTAyHwQFCVR1ZXNkYXkgRGRkGAIFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBSRjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHRiY0dhbGxlcnkFL2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkTWVzc2FnZWJveCRidG5Qb3B1cE9rBSRjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHRiY0dhbGxlcnkPD2QCAmQ%3D&__SCROLLPOSITIONX=0&__SCROLLPOSITIONY=419&__EVENTVALIDATION=%2FwEdABUlpJrL8jKWTwYLqexePLp9LD5zq8svXha6XRzxE%2FCA6isfdeVZNI7ASIt6PIaNSDwYlmNi0mpPi0I865O2LxAkzBhdFYaprmaiJymxLDcxE8lkCGq8O%2FK9O%2Bxvyvd6m1rEnMKWo8zEV33E9GFKXkFjcWaCqaAgW2qiov5SRArqihOrSxEYbyJa3g5qQ2Jam7H6jdg0mtjuPgJaWULMB%2FbpCAdf7ktVQXjmrf1y9oq2oWS9acNO9Yc1W5i938A6IkJSOiBwkBn1OwaXcQXjo9pmSp7Z9xBfTzCWOjndtxqVe7P1g60B6H8GaVHt8JQ0P9q28BwvC9cHdFGTamhPR6aaQPzluOZwy2nH0kxwu%2FoUc0j2Hci7AEQbcGPc9OqBo573zFB6oeD6YmSEm3FzZAMGiuKPtJYMLpVWASUEThx6G7J4u8p1gB6XIwUD8ik6AU4%3D** 
```

我没有给出任何查询字符串，发生错误的代码是

```
<div class="row-fluid">
                        <div class="span4" style="margin-top: 40px;">
                            <div class="header">
                                <span style="padding-top: 10px; padding-left: 10px;">Leagues</span>
                            </div>
                            <div class="mainbody">
                                <asp:Repeater runat="server" ID="rptLeagues" ClientIDMode="Static" OnItemCommand="rptLeagues_ItemCommand">
                                    <ItemTemplate>
                                        <p>
                                            <asp:LinkButton ID="lnk" runat="server" CommandName="select" CommandArgument='<%# Eval("LeagueId") %>'
                                                Text='<%# Eval("LeagueName") %>'>  
                                            </asp:LinkButton><i class="pull-right" style="font-size: 15pt;">»</i></p>
                                    </ItemTemplate>
                                </asp:Repeater>
                            </div>
                        </div>
                        <div class="span4" style="margin-top: 40px;">
                            <div class="header">
                                <span style="padding-top: 10px; padding-left: 10px;">Stages</span>
                            </div>
                            <div class="mainbody">
                                <asp:Repeater runat="server" ID="rptStages" ClientIDMode="Static" OnItemCommand="rptStages_ItemCommand">
                                    <ItemTemplate>
                                        <p>
                                            <asp:LinkButton ID="lnk" runat="server" CommandName="select" CommandArgument='<%# Eval("LeagueId") %>'
                                                Text='<%# Eval("LeagueName") %>'>  
                                            </asp:LinkButton><i class="pull-right" style="font-size: 15pt;">»</i></p>
                                    </ItemTemplate>
                                </asp:Repeater>
                            </div>
                        </div>
                        <div class="span4" style="margin-top: 40px;">
                            <div class="header">
                                <span style="padding-top: 10px; padding-left: 10px;">Weeks</span>
                            </div>
                            <div class="mainbody">
                                <asp:Repeater runat="server" ID="rptWeeks" OnItemCommand="rptWeeks_ItemCommand">
                                    <ItemTemplate>
                                        <p>
                                            <asp:LinkButton ID="lnk" runat="server" CommandName="select" CommandArgument='<%# Eval("LeagueId") %>'
                                                Text='<%# Eval("LeagueName") %>'>  
                                            </asp:LinkButton><i class="pull-right" style="font-size: 15pt;">»</i></p>
                                    </ItemTemplate>
                                </asp:Repeater>
                            </div>
                        </div>
                    </div> 
```

cs代码

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            FillLeagues();
        }
    }
    protected void rptLeagues_ItemCommand(object source, RepeaterCommandEventArgs e)
    {
        try
        {
            if (e.CommandName == "select")
            {
                FillStages();
                rptWeeks.DataSource = null;
                rptWeeks.DataBind();
                tbcGallery.Visible = true;
            }
        }
        catch (Exception ex)
        {
            Messagebox.SetPopup("Error Found", ex.Message);
        }
    }
    protected void rptStages_ItemCommand(object source, RepeaterCommandEventArgs e)
    {
        try
        {
            if (e.CommandName == "select")
            {
                FillWeeks(e.CommandArgument.ToInt32());
                tbcGallery.Visible = true;

            }
        }
        catch (Exception ex)
        {
            Messagebox.SetPopup("Error Found", ex.Message);
        }
    }
    protected void rptWeeks_ItemCommand(object source, RepeaterCommandEventArgs e)
    {
        try
        {
            if (e.CommandName == "select")
            {
                //FillMatches(e.CommandArgument.ToInt32());
                tbcGallery.Visible = true;
                LoadVideos();
                LoadPictures();

            }
        }
        catch (Exception ex)
        {
            Messagebox.SetPopup("Error Found", ex.Message);
        }
    } 
```

**正如你所看到的，我没有给出任何查询字符串，以及我如何
使用 asp dotnet4 Ajaxcontroltoolkit 和使用 updatepanel 来防止查询字符串自动生成我。有什么建议么？？？？？**

```
<asp:UpdatePanel ID="AjaxPanel" UpdateMode="Conditional" ChildrenAsTriggers="true"
        runat="server"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-22T10:27:44.290

您在 url 中传递的查询字符串长于 2048，这是 maxQueryStringLength 的默认值。例如，您必须在 Web.config 文件 (maxQueryStringLength) 中设置一个更大的值：`"<httpRuntime maxQueryStringLength="16384" />"` 这是获取更多信息的[链接](http://www.asp.net/whitepapers/aspnet4#0.2__Toc253429244)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T16:07:05.107

经过一整天的战斗，我随机找到了一个我改变的解决方案

```
 <form id="form1" method="GET" runat="server"> 
```

到

```
<form id="form1"  runat="server"> <!--(this solved my problem.) --> 
```

我不知道为什么 method="Get" 生成长查询字符串（**当我单击页面中的任何链接时**）这会给出错误此请求的查询字符串的长度超过配置的 maxQueryStringLength 值

# asp.net - Asp.net 4.5 WebForms ModelBinding 不允许在下拉列表中设置 selectedvalue

> ID：16195329
> 
> 赞同：2
> 
> 时间：2013-04-24T14:58:49.100
> 
> 标签：asp.net, binding, model, selectedvalue, selectmethod

我正在使用 Asp.net 4.5 模型绑定。我有一个下拉列表，它有一个返回 IEnumerable 产品列表的选择方法。一切都按预期工作。但是，当我登陆页面时，我需要检查查询字符串并更改下拉列表的选定值（使用 SelectMethod.

通常我会简单地使用...

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            ddlProducts.SelectedValue = Request.QueryString["productid"];
        }
    } 
```

但是，当下拉列表绑定到 SelectMethod（新的 asp.net 4.5 模型绑定）时，这不起作用。那么，当我登陆页面时，如何通过查询字符串设置下拉列表的选定值？

ASPX（使用普通下拉列表，但带有 SelectMethod）：

```
<asp:DropDownList ID="ddlProducts" runat="server" DataTextField="Description" DataValueField="ProductId" AppendDataBoundItems="True" SelectMethod="GetProducts"></asp:DropDownList> 
```

CS

```
public static IEnumerable<Product> GetProducts()
{
    using (var db = new AppDb())
    {
        return db.Products.OrderBy(x => x.Description).ToList().AsEnumerable();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-29T04:43:21.007

我不是专家，所以你的里程可能会有所不同。但我认为你所要做的就是改变你对 getProducts 的定义：从

```
public static IEnumerable<Product> GetProducts() 
```

至

```
public static IEnumerable<Product> GetProducts([QueryString("somequerystringvariablename")] string param) 
```

然后使用“参数”过滤您的查询

# javascript - Video.js - 加载数据事件永远不会触发

> ID：16195331
> 
> 赞同：4
> 
> 时间：2013-04-24T14:58:52.527
> 
> 标签：javascript, video, video.js

我正在将 Video.js 集成到一个项目中并遇到一些问题。

我在我的 HTML 中有它：

```
<video id="vidView" class="video-js vjs-default-skin" width="320" height="320" 
   poster="/siteImages/Dummy.png" preload="auto">
   <source type="video/mp4" src="" \>
</video> 
```

在我的javascript中，我加载了一个源并设法播放它。

```
var vidPlayer = _V_("vidView");
vidPlayer.src({ type: "video/mp4", src: vidlink });

vidPlayer.play(); 
```

只有以编程方式执行此操作才会出现问题 - 源和播放的每一秒加载都会起作用。我想我是在 video.js 准备好之前尝试播放的，所以试图在适当的时间使用监听器来启动播放。

我发现某些事件根本不会触发。我无法从“loadedalldata”事件或“loadeddata”中得到任何东西。“loadstart”事件至少会触发，所以我把我的 .play() 命令放在那里。

```
vidPlayer.addEvent("loadstart", function(){ console.log("LOAD START Fired" );
  var myPlayer = this;
  myPlayer.play(); 
} ); 
```

但这仍然不可靠。我在控制台上看到“正在尝试恢复！”的消息。几次。它播放一些视频，但有时会陷入困境。

在发生“loadeddata”事件时我是否遗漏了什么？

此外，相关的 Q - 我注意到文档说删除事件侦听器的语法是：

myPlayer.removeEvent("eventName", myFunc);

那正确吗？似乎“myFunc”部分是多余的，我想知道这是否是[文档](https://github.com/zencoder/video-js/blob/master/docs/api.md)中的复制/粘贴错误， 或者这是否是正确的语法。

提前谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-03T00:30:40.937

我怀疑你遇到了和我一样的问题。如果您的浏览器正在使用 HTML5 视频（而不是 Flash 后备），则某些事件（例如`loadedmetadata`和`loadeddata`）可能会在 Video.js 绑定事件侦听器之前触发。

如果您正在进行一些预加载，则尤其如此，并且在视频开始加载和初始化 Video.js 之间存在延迟。当有缓存副本时似乎也会发生这种情况，这就是为什么它在每次刷新时都起作用（使缓存无效）。

解决方案是将您的视频初始化内容放在`<head>`文档底部而不是底部。如果这不理想（它不适合我们），我们添加一个事件监听器`<head>`，然后在初始化播放器后检查它。例如

在`<head>`：

```
<script>
var loadedmetadata = false;
if (window.addEventListener) {
    window.addEventListener('loadedmetadata', function(ev) {
            loadedmetadata = true;
    }, true);
}
</script> 
```

然后在你的脚本中：

```
if (loadedmetadata === true && videoPlayer.techName === 'html5') {
    // call the callback you would have attached to
    // the event listener.
} else {
    // add event listener here
] 
```

`window.addEventListener`IE7/8 不支持，但没关系，因为它们不支持 HTML5 视频，所以它永远不会触发。IE9 支持`window.addEventListener`和 HTML5 视频，所以它会按预期工作。

我们还检查了`techName`is `html5`，因为 Flash 播放器是在我们初始化 Video.js 对象时创建的，所以之前不应该触发该事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T13:06:38.830

`loadeddata`在播放开始之前不一定会触发。在 Flash 中它永远不会这样做，在 HTML5 中，事件是从视频元素中继的，因此它取决于浏览器的行为。

`loadedalldata`是下载整个视频时，因此不太可能在播放开始之前发生。

您指定要从事件中删除的函数，因为您可以将多个函数绑定到事件，例如

```
vidPlayer.addEvent("play", onPlay1 );
vidPlayer.addEvent("play", onPlay2 );
vidPlayer.removeEvent("play", onPlay1 ); // onPlay2() would still be executed 
```

# qt - Qt QPixmap 大小

> ID：16195335
> 
> 赞同：4
> 
> 时间：2013-04-24T14:58:57.337
> 
> 标签：qt, qpixmap

我想要一个`QPixmap`尺寸为 50 x 50 的。我试过了：

```
QPixmap watermark(QSize(50,50)); 
watermark.load(":/icoMenu/preparation"); 
```

但 QPixmap 采用图像大小。

我也试过：

```
QPixmap watermark(":/icoMenu/preparation");
watermark.scaled(QSize(50,50),  Qt::KeepAspectRatio); 
```

但同样的结果。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T15:12:04.010

你几乎成功了

```
QPixmap watermark(":/icoMenu/preparation");

QPixmap newPixmap = watermark.scaled(QSize(50,50),  Qt::KeepAspectRatio); 
```

# c++ - 从地图访问几个参数

> ID：16195337
> 
> 赞同：1
> 
> 时间：2013-04-24T14:59:08.260
> 
> 标签：c++, stdmap, const-iterator

我定义了一张地图，

```
static std::map<std::string, std::string> myentries; 
```

条目通过键和值字符串动态填充，元素和序列的数量是动态的..

```
myentries[key] = value; 
```

现在我必须从我知道键的地图中检索 7 个参数，例如, `hostName`, `port`, `user1`,`user2``user3`

一种方法是访问所有 5 个参数并拥有 5 个语句，例如 ..

```
std::map<std::string, std::string>::iterator iterparam1 = entries_.find("hostName"); 
```

和访问`iterparam1->second.data()`，`iterparam2->second.data()`..

这种简单的方法可以完成它的工作，因为我知道地图中的子集，但是我想讨论一下这种方法是否有任何替代方法，以及当前经文与建议/替代方法的优缺点。

谢谢你的时间 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:13:18.890

我认为您的方法的错误之处在于您决定保存主机参数的方式。比一组键值对更好地存储 Host 类型的结构（自定义结构）。否则，在您的代码中的某个时刻，您将不得不以某种方式将键名映射到结构中的实际字段，这将使代码难以维护并且更不安全。不要试图在课堂上工作。

# python - SQLIte3 查询数据库

> ID：16195342
> 
> 赞同：0
> 
> 时间：2013-04-24T14:59:23.247
> 
> 标签：python, database, sqlite

我正在尝试编写一个程序来查询数据库。数据库是 golfDB，它由一个名为`players`5 个字段的表组成：

*   `name`（球员姓名）
*   `totalGross`（每轮总分的总和）
*   `totalRounds`（比赛轮数）
*   `pars`（制作的总杆数）
*   `birdies`（小鸟总数）

我的程序需要输出得分最多的球员，输入球员的平均得分（totalGross/totalRounds），并按照总得分从低到高的顺序列出球员。

我真的不知道如何输出具有最多标准杆的球员。现在我的代码正在输出一个列表列表，每个列表都有一个玩家和他们的标准杆。我不知道如何按照他们的标准来排序，然后选择最高的，因为我所做的一切都只是选择数字，然后我无法回到他们属于哪个球员。

有谁知道如何仅按标准杆数对列表列表进行排序，然后它就可以打印播放器？

```
import sqlite3

def getDBCursor(DB):
    """obtain and return a cursor for the database DB"""
    conn= sqlite3.connect('/Users/tinydancer9454/Documents/python/golfDB')
    cursor= conn.cursor()
    return cursor

def queryDBpars(cursor):
    """find out which player had the most pars"""
    cursor.execute('select name, pars from players where pars >= 0')
    playerPars= cursor.fetchall()

def queryDBavgScore(cursor):
    """find the average score of inputed player"""
    player= input("Please enter the player's name: ")
    cursor.execute('select totalGross from players where name = ?', (player,))
    totalGrossScore = cursor.fetchone()
    cursor.execute('select totalRounds from players where name = ?', (player,))
    totalRoundsScore = cursor.fetchone()
    answer = totalGrossScore[0]/ totalRoundsScore[0]
    print('The average score for', player, 'is', answer,)

def queryDBplayers(cursor):
    """lists the players in order of their total gross score"""

def main():
    """obtain cursor and query the database: golfDB"""
    cursor= getDBCursor('golfDB')
    queryDBpars(cursor)
    queryDBavgScore(cursor)
    queryDBplayers(cursor)
    cursor.close() 
```

这是输出：

```
[('Ruth', 16), ('Elena', 12), ('Jane', 12), ('Ezgi', 13), ('Ricki', 9), ('Margaret', 10), ('Rosalia', 16), ('Betty', 14)] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:24:50.327

这是一个简单的 SQL 问题。要直接回答您的问题，您只需要：

```
SELECT name, pars FROM players WHERE pars >= 0 ORDER BY pars DESC 
```

但这仍然会让您选择所有不需要的玩家。为了防止这种情况，只需添加一个 LIMIT 子句：

```
SELECT name, pars FROM players WHERE pars >= 0 ORDER BY pars DESC LIMIT 1 
```

然后你会用它`cursor.fetchone()`来获得那一行。

**编辑**

你说可能有不止一个人拥有最多的par。这使查询变得更加复杂：现在我们进入子查询：

```
SELECT name, pars FROM players WHERE pars >= 0 WHERE pars = (
    SELECT MAX(pars) FROM players) 
```

所以这样做是找到“pars”的最大值，然后选择具有该值的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:29:30.323

您可以在查询中使用[ORDER BY](http://www.w3schools.com/sql/sql_orderby.asp) SQL 关键字，或者如果您想在 python 中执行此操作，您可以通过以下几种方式执行此操作：

```
def queryPars(cursor):
    """find out which player had the most pars"""
    cursor.execute('select pars, name from players where pars >= 0')
    ## Note flipped order ^^^^^^^^^^^^
    playerPars = cursor.fetchall()
    pars, player_most_pars = max(playerPars)
    # Now do something useful with it ;-) 
```

[文档](http://docs.python.org/2/library/stdtypes.html)描述了如何比较元组。（基本上，逐个条目）。如果您无法更改查询的顺序，您还可以执行类似的操作`player, pars = max(playerPars, key=lambda p: p[1])`

# amazon-ec2 - 如何使用 Windows 将文件另存为 .pig？

> ID：16195350
> 
> 赞同：0
> 
> 时间：2013-04-24T14:59:50.493
> 
> 标签：amazon-ec2, apache-pig, elastic-map-reduce

我刚刚尝试使用 Pig 脚本运行 Elastic MapReduce 作业。我在记事本中创建了 Pig 脚本，最初将其保存为 .txt 文件，然后手动将扩展名更改为 .pig 并上传。这是我得到的错误：

运行 Pig 脚本失败 2013-04-24 08:58 CDT 2013-04-24 08:59 CDT s3://elasticmapreduce/libs/script-runner/script-runner.jar - s3://elasticmapreduce/libs/pig/ pig-script --run-pig-script --pig-versions latest --args -p INPUT=s3n://cse6242-?gtcse-?data/gb-?bigrams/ -p OUTPUT=s3n://cse02- bone6/pigoutput/s3n://cse02-bones6/pigsample/pigscript.pig

INPUT 中的那些？对我来说看起来很可疑。这里有什么问题，我创建 .pig 文件的方式有问题吗？

# asp.net - Kentico：如何创建自己的模板

> ID：16195358
> 
> 赞同：0
> 
> 时间：2013-04-24T15:00:05.243
> 
> 标签：asp.net, kentico

如何在 kentico 7 中创建自己的主模板页面？我必须使用门户引擎吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T19:50:08.190

您可以使用门户引擎或 ASPX 或混合模板 - 对您来说更方便。在这里您可以找到更多信息：

门户模板：[http](http://devnet.kentico.com/docs/devguide/creating_a_new_page_template.htm) ://devnet.kentico.com/docs/devguide/creating_a_new_page_template.htm ASPX：[http](http://devnet.kentico.com/docs/devguide/creating_a_new_aspx_page_template.htm) ://devnet.kentico.com/docs/devguide/creating_a_new_aspx_page_template.htm （下面两章是混合模式介绍） .

# django - 如何在 Django 中加载自举模型的骨干网

> ID：16195361
> 
> 赞同：3
> 
> 时间：2013-04-24T15:00:12.310
> 
> 标签：django, backbone.js, collections

加载主干应用程序时（对于我的应用程序，这意味着页面已加载），我需要初始收集数据，并且主干文档说：

```
<script>
  var accounts = new Backbone.Collection;
  accounts.reset(<%= @accounts.to_json %>);
  var projects = new Backbone.Collection;
  projects.reset(<%= @projects.to_json(:collaborators => true) %>);
</script> 
```

我不明白这一点。剂量这意味着我应该使用初始数据呈现页面，例如

```
{{collection_initial_data}} 
```

我在后端使用 django，那么如何将上面的代码翻译成 django 模板，比如

```
 <script>
  var accounts = new Backbone.Collection;
  accounts.reset({{ @accounts.to_json }});
  var projects = new Backbone.Collection;
  projects.reset({{ @projects.to_json(:collaborators => true) }});
</script> 
```

无论如何，我对获取骨干收集的初始数据感到非常困惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T23:03:44.487

当 Backbone 谈论引导时，他们在谈论这个：

[http://documentcloud.github.io/backbone/#FAQ-bootstrap](http://documentcloud.github.io/backbone/#FAQ-bootstrap)

换句话说，他们说你应该在你的 Django HTML 模板中的脚本标签中写出你的模型的内容。

例如，假设您的 Django 上下文有一个名为“foo_models”的变量，其中包含所有 foo 模型的 JSON 表示。您想编辑您的 Django 模板以执行以下操作：

```
<script>
var foo_models = new FooCollection({{foo_models}});
</script> 
```

通过这种方式，您可以保证您的数据在页面加载时已准备就绪，并且您的 JS 代码可以使用 JS`foo_models`访问该数据。

现在，您的困惑似乎在于如何首先制作`foo_models`Python/Django 变量。我建议在您的视图逻辑中执行此操作，而不是在模板中，因为在那里您可以使用 Python 及其库的全部功能来序列化 JSON。但是，如果您确实想在视图中执行此操作，则可以使用与您指定的语法非常相似的语法来执行此操作；查看此 SO 问题的第二个答案：

[Django：使用 Javascript 在我的模板中解析 JSON](https://stackoverflow.com/questions/3345076/django-parse-json-in-my-template-using-javascript)

# jquery - 通过属性名称设置选择的选项（选择标签）

> ID：16195363
> 
> 赞同：0
> 
> 时间：2013-04-24T15:00:17.247
> 
> 标签：jquery, html, select

我正在为我的应用程序做一些 javascript/jquery，我需要一些帮助。

我有很多选择。我想选择属性 name='myName' 的选项。

我知道按值设置它非常简单。

```
$("#my-select").val(myVal); 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T15:03:13.583

你可以这样做：

```
$("#my-select option[name='myName']").prop('selected', true); 
```

查看[**工作演示**](http://tinker.io/349e1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:04:24.933

```
$("option[name='myName']").prop('selected',true); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/Za38H/)**

但是，如评论中所述，选项元素的 name 属性已过时。

# javascript - 指令中的AngularJS ngModel

> ID：16195369
> 
> 赞同：1
> 
> 时间：2013-04-24T15:00:30.903
> 
> 标签：javascript, angularjs, bind, directive

我编写了自己的指令来通过 ajax 解析带有 select2 和 gat 数据的输入。

HTML：

```
<input type="text"
       ng-model="name"
       data-ui-event="{keyup: 'searchByName($event)',change: 'searchByName($event)'}"
       ajax-select2="single" data-url="/ajax/name/"
/> 
```

JS：

```
.directive('ajaxSelect2', ['$timeout', function ($timeout) {
return {
    restrict: 'A',
    link: function (scope, element, attrs) {
        var reqParams = {},
            multiple = attrs.ajaxSelect2 === "multi" ||
                       attrs.ajaxSelect2 === "multiple" ? true : false;

        switch(element.prop("tagName")) {
            case 'INPUT':
                element.select2({
                    multiple: multiple,
                    ajax: {
                        quietMillis: 200,
                        url: attrs.url,
                        dataType: 'json',
                        type: 'POST',
                        data: function (term, page) {
                            var req = {
                                "val": term,
                            };
                            return JSON.stringify(req);
                        },
                        results: function (data, page) {
                            return { results: data };
                        }
                    }
                });
            break;

            default:
                alert('ajax-select2 works only with input fields!');
            break;
        }

        element.bind("change", function () {
            element.show(); //shows the input
            $timeout(function () {
                element.trigger('keyup'); //doesn't work
            });
        });
    }
}}]) 
```

我的问题：所选值设置为输入并调用了 searchByName 函数，但它不适用于我的 ng-model。如果我使用 ng-model="name" 添加另一个输入，则该值也应写入此输入。但事实并非如此。

**编辑**：这是一个[jsFiddle](http://jsfiddle.net/StinsonMaster/n87MG/12/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-12T08:10:22.643

知道了！
我不得不手动更新范围内的 ng-model。

```
element.bind("change", function(e) {
    scope.$apply(function() {
        scope[attrs.ngModel] = e.val;
    });
}); 
```

完整的代码示例[在这里](http://jsfiddle.net/n87MG/14/)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-05-07T06:36:08.610

将您的代码更正为：

```
$timeout(function () {
   element.trigger('keyup'); //doesn't work
}, **Interval**); 
```

# c++ - ListView 在 mfc 中杀死焦点

> ID：16195371
> 
> 赞同：0
> 
> 时间：2013-04-24T15:00:32.333
> 
> 标签：c++, listview, mfc

我在对话框中有一个列表视图。当我选择列表中的某个项目时，它已被选中。当我从列表中删除焦点（例如，单击另一个窗口）时，选择消失了。如何使其变灰（非活动）但留在列表中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:03:03.807

有一种风格叫`LVS_SHOWSELALWAYS`。在运行时使用：

```
DWORD dwStyle = m_list.GetExtendedStyle();
dwStyle |= LVS_SHOWSELALWAYS;
m_list.SetExtendedStyle(dwStyle); 
```

# javascript - JavaScript 中的条件表达式受括号影响

> ID：16195375
> 
> 赞同：2
> 
> 时间：2013-04-24T15:00:48.623
> 
> 标签：javascript

我在一本书中看到了这个说法，但我还没有找到解释。

```
function foo() { return false }

alert(foo() == !foo); //message box says TRUE
alert(foo() == !foo()); //message box says FALSE 
```

我一直在想第一个警报会说 FALSE。但它说的是真的（？）

您可以看到最后一条语句中的括号使表达式返回 FALSE。请告诉我我在这里缺少什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:02:44.040

`foo`是一个函数，因此它不是`false`

```
function foo() { return false; };
alert(typeof foo); // function
alert(typeof foo()); // boolean
alert(!function (){}); // false 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:04:24.297

**在第一种情况下：**

```
foo() == !foo 
```

LHS 是`foo()`- 返回`false`

RHS 是`!foo`- 并且因为`foo`存在（并且不是假的），`!foo`所以就像`!true`并且评估为`false`

因此`foo() == !foo`是`true`

* * *

**在第二种情况下：**

```
foo() == !foo() 
```

LHS 是`foo()`我们`false`所知道的

RHS is `!foo()`- 这与说`!false`，即`true`

因此`foo() == !foo()`是`false`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T15:03:48.403

运算符将`!`值转换为布尔值，然后将其反转。函数变量`TRUE`在转换为布尔值时。

所以，`!foo`是`!TRUE`，这是`FALSE`。 `foo()`回报`FALSE`，所以`foo() == !foo`。

`foo()``FALSE`return和`!foo()`is `TRUE`，因为它否定了返回值。所以，`foo()`不等于`!foo()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:09:59.177

对于第一个，`foo`不是函数的调用`foo`，而是函数本身，并且由于定义了函数，因此它是等效的`true`（但不是真的`true`）。当你反转 ( `!`) 时，它变为`false`。将其与`foo()`(which 返回`false`) 进行比较，得到`true`since `false == false`is `true`。

对于第二个，`foo()`现在是 function 的函数调用`foo`，而后者又返回`false`。将其反转为`true`，并将其与另一个`foo()`调用（即 is `false`）进行比较产生`false`，因为`false == true`is `false`。

# java - 如何从 Java 文件中获取值并计算它们？

> ID：16195376
> 
> 赞同：0
> 
> 时间：2013-04-24T15:00:52.473
> 
> 标签：java, string, file, csv, io

好的，所以我有这段代码来获取我的 .csv 文件，其中包含这些值。

```
Alice Jones,80,90,100,95,75,85,90,100,90,92
Bob Manfred,98,89,87,89,9,98,7,89,98,78 
```

我想取名字，然后取相应的成绩并计算他们的平均值。我坚持的部分实际上是在文件中检索这些值，以便我可以实际使用它们。我会用什么来读取字符串，以便将整数拉出来？

```
import java.io.*;
import java.util.*;

public class Grades {
public static void main(String args[]) throws IOException
{
try{
// Open the file that is the first 
// command line parameter
FileInputStream fstream = new FileInputStream("filescores.csv");

BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
String strLine;
//Read File Line By Line
while ((strLine = br.readLine()) != null)   {
// Print the content on the console
System.out.println (strLine);
}
//Close the input stream
in.close();
}catch (Exception e){//Catch exception if any
System.err.println("Error: " + e.getMessage());

}
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:05:11.983

这是可以帮助您开始的代码片段。

```
String[] parts = strLine.split(",");
String name = parts[0];
int[] numbers = new int[parts.length - 1];
for (int i = 0; i < parts.length; i++) {
    numbers[i] = Integer.parseInt(parts[i+1]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:03:59.030

我建议`String#split`将一行的值读入数组：

```
String[] values = strLine(",");

// debug
for (String value:values) {
   System.out.println(value);
} 
```

索引 0 处的值是名称，其他数组字段包含字符串形式的数字，您可以使用`Integer#parseInt`它们将它们转换为整数值。

# git - Gitlab 不加载资产

> ID：16195378
> 
> 赞同：2
> 
> 时间：2013-04-24T15:00:53.283
> 
> 标签：git, apache, gitlab

Gitlab 不加载资产。我正在使用带有 Apache 服务器的 Gitlab 5.0。

有人能帮我吗？提前致谢！

![在此处输入图像描述](https://i.stack.imgur.com/CBlos.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T14:53:11.183

我假设您使用 ProxyPass 和相对路径。

1.  停止 GitLab 服务
2.  在您的 /home/git/gitlab 文件夹中运行它：（
    `bundle exec rake assets:precompile RAILS_ENV=production RAILS_RELATIVE_URL_ROOT=/gitlab` 确保将 /gitlab 替换为您在 unicorn.rb 中提供的任何内容）
3.  启动服务

您可以参考的线程：[https ://groups.google.com/forum/?fromgroups=#!topic/gitlabhq/BuaaCHoYoPo](https://groups.google.com/forum/?fromgroups=#!topic/gitlabhq/BuaaCHoYoPo)

# javascript - JavaScript，测试单选按钮

> ID：16195385
> 
> 赞同：0
> 
> 时间：2013-04-24T15:01:06.417
> 
> 标签：javascript, html, radio-button

我有以下代码，我想在其中检查 3 组单选按钮的值，更改系数，然后进行一些计算。它似乎没有识别循环的组，并告诉我没有选择按钮。我没有正确测试这个吗？

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML meta http-equiv="content-type" content="text/html; charset=UTF-8">
 <HEAD>
 <TITLE>Couch Shifts</TITLE>
<script type="text/javascript">     
    function tableShifts()
    {
        var curVert = Number(document.getElementById("curVert").value);
        var curLat = Number(document.getElementById("curLat").value);
        var curLong = Number(document.getElementById("curLong").value);
        var pinVert = Number(document.getElementById("pinVert").value);
        var pinLat = Number(document.getElementById("pinLat").value);
        var pinLong = Number(document.getElementById("pinLong").value);

        var coVert = 1;
        var coLat = 1;
        var coLong = 1;

        var group1Array = document.getElementsByName("group1");
        for (i=0; i<group1Array.length; i++)
        {
            if (group1Array[i].checked)
            {
                group1Array = group1Array[i].Value;
                break;
            }
            else
            {
                alert("Button Not Selected")
            }
        }           
        var group2Array = document.getElementsByName("group2");
        for (i=0; i<group2Array.length; i++)
        {
            if (group2Array[i].checked)
            {
                group2Array = group2Array[i].Value;
                break;
                alert(group2Array[i].Value);
            }
            else
            {
                alert("Button Not Selected")
            }
        }
        var group3Array = document.getElementsByName("group3");
        for (i=0; i<group3Array.length; i++)
        {
            if (group3Array[i].checked)
            {
                group3Array = group3Array[i].Value;
                break;
            }
            else
            {
                alert("Button Not Selected")
            }
        }           

        switch(group1Array)
        {
            case "Up":
                coVert = 1;
                break;
            case "Down":
                coVert = -1;
                break;                  
        }
        switch(group2Array)
        {
            case "Lt":
                coLat = 1;
                break;
            case "Rt":
                coLat = -1;
                break;                  
        }
        switch(group3Array)
        {
            case "In":
                coLong = 1;
                break;
            case "Out":
                coLong = -1;
                break;                  
        }

            document.getElementById("gotoVert").value = curVert + pinVert*coVert;
            document.getElementById("gotoLat").value  = curLat + pinLat*coLat;
            document.getElementById("gotoLong").value = curLong + pinLong*coLong;
        }

</script>
  </HEAD>
  <BODY>    
<div id = "Calcs" style="margin-bottom: 160px;">
<style>
    label { float: left; width: 35px; font-size:17px; color:#0000FF}
    #column1{ float: left; position: relative; z-index: 0; width: 150px; font-size:20px;}
    #column2{ float: left; position: relative; z-index: 1; width: 160px; font-size:20px;}
    #column3{ float: left; position: relative; z-index: 2; width: 160px; font-size:20px;}
    #button { position: absolute; }
    #input.radio{ margin-left: 1px; }
</style>
<div id="column1">Current Position</br></br>        
    <label for="Vert">Vert</label></br>
    <input type="text", id="curVert" size="10" value="" /></br>             
    <label for="Lat">Lat</label></br>
    <input type="text" size="10", id="curLat" value="" /></br>
    <label for="Long">Long</label></br>
    <input type="text" size="10", id="curLong" value="" /></br>
</div>

<div id="column2">Pinnacle Shifts<br><br>           
    <label for="Vert">Vert</label>
        <input type="radio" name="group1" value="Up"/><font size="2">Up</font>  
        <input type="radio" name="group1" value="Down"/><font size="2">Down</font>
    <input type="text", id="pinVert" size="10" value="" /></br>         
    <label for="Lat">Lat</label>
        <input type="radio" name="group2" value="Lt"/><font size="2">Lt</font>  
        <input type="radio" name="group2" value="Rt"/><font size="2">Rt</font>
    <input type="text", id="pinLat" size="10" value="" /></br>                      
    <label for="Long">Long</label>
        <input type="radio" name="group3" value="In"/><font size="2">In</font>  
        <input type="radio" name="group3" value="Out"/><font size="2">Out</font>
    <input type="text", id="pinLong" size="10" value="" />                  
</div>

<div id="column3">Calculated Shifts</br></br>
    <label for="Vert">Vert</label></br>
    <input type="text", id="gotoVert" size="10" value="" readonly="readonly" style="background-color:#D8D8D8 ;"/></br>
    <label for="Lat">Lat</label></br>
    <input type="text", id="gotoLat" size="10" value="" readonly="readonly" style="background-color:#D8D8D8 ;"/></br>
    <label for="Long">Long</label></br>
    <input type="text", id="gotoLong" size="10" value="" readonly="readonly" style="background-color:#D8D8D8 ;"/>       
</div><br />
</div>

<div id="button">
    <input type = "button" style="margin-top: 10px;" value="Calculate Shifts" onclick="tableShifts();" />
    <input type = "button" style="margin-top: 10px;" value="Reset" onclick="clear();" />
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:37:20.907

如果您实现 JQuery（javascript 库），您可以轻松检查选中的单选按钮。

```
if( $("#someRadioButton").is(":checked") )
{ 
     // doSomething 
} 
```

或者，你可以...

```
// Get the ID of the radio button checked
var id = $("input[@name=radioGroup]:checked").attr('id');

// Get the value of the radio button checked
var value = $("input[@name=radioGroup]:checked").val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T19:50:04.183

将您的代码更改为：

```
var group1Array = document.getElementsByName("group1");
var gr1 = 0;
for (i = 0; i < group1Array.length; i++) {
    if (group1Array[i].checked) {
        group1Array = group1Array[i].value;
        break;
    }
    else gr1++;
}
if (gr1 == group1Array.length) {
    alert("Button Not Selected");
} 
```

[http://jsfiddle.net/vMHMR/](http://jsfiddle.net/vMHMR/)

因此，`alert`只有在*未*选中组中的单选按钮时才显示。

# java - Java中euler项目#14的运行时间太长

> ID：16195400
> 
> 赞同：3
> 
> 时间：2013-04-24T15:01:39.097
> 
> 标签：java, algorithm, collatz

我的 Euler Project 14 代码如下。我已经运行此代码超过 3 小时，输出结果似乎是无限的。当我测试单个数字如 11、27 时，它会快速输出 collat​​z 链号：14 和 111。但我不知道为什么它不能输出 1000000 个数的最大链数。

```
/*Problem 14
 * The following iterative sequence is defined for the set of positive integers:
 *          n -> n/2 (n is even)
 *          n -> 3n + 1 (n is odd) 
 * Using the rule above and starting with 13, we generate the following sequence:
 *               13 -> 40 -> 20 -> 10 -> 5 -> 16 -> 8 -> 4 -> 2 -> 1
 * It can be seen that this sequence (starting at 13 and finishing at 1) contains 
 * 10 terms. Although it has not been proved yet (Collatz Problem), it is thought 
 * that all starting numbers finish at 1.
 * 
 * Which starting number, under one million, produces the longest chain?
 * 
 * NOTE: Once the chain starts the terms are allowed to go above one million.
 */
package number;  
public class LongestCollatzSequence {
    public static int collatzNum(int n){
        int count = 0;
        while(n != 1){
            if(n%2 == 0)
                n = n/2;
            else 
                n = 3*n + 1;
            count++;
        }
        return count;
    }
    public static void main(String[] args) {
        int max = 0;
        for(int i = 10; i <= 1000000; i++){
            if(collatzNum(i) > collatzNum(max))
                max = i;
        }
        System.out.println(max);
    }
} 
```

此外，我转向`for(int i = 10; i <= 1000000; i++)`，`for(int i = 10; i <= 10; i++)`这么短的数字列表，它仍然一直在运行而没有输出。我的代码有什么问题？

这是另一个人的解决方案，[rianjs.net](http://rianjs.net/2011/05/java-solution-to-project-euler-problem-14)代码是：

```
public class Problem014
{
    public static void main(String[] args)
    {
        long begin = System.currentTimeMillis();
        LinkedList<Long> list = new LinkedList<Long>();
        long length = 0;
        int res = 0;
        for(int j = 10; j < 1000000; j++){
            long i = j;
            while (i != 1){
                if (i % 2 == 0){
                    i /= 2;
                    list.add(i);
                }
                else{
                    i = (3 * i) + 1;
                    list.add(i);
                }
            }
            if(list.size() > length){
                length = list.size();
                res = j;
            }
            list.clear();
        }
        long end = System.currentTimeMillis();
        System.out.println(res+" with chain size: "+ length);
        System.out.println(end-begin + "ms");
    }
} 
```

他的代码运行良好，我想知道为什么我的代码不能得到输出，这两种分辨率有什么区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T15:13:15.690

`int n`您的函数的参数`collatzNum`将溢出值 113383。如您所见，另一个实现使用 long 变量作为临时值。

除此之外，您可以通过不计算`collatzNum(max)`每次循环迭代来优化您的代码，但只有当 max 实际发生变化时，在这种情况下，您已经将 new`collatzNum(max)`作为返回值从`collatzNum(i)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T15:41:03.390

您每次都在重新计算迄今为止发现的最长数字的长度。如果你只记得到目前为止你见过的最长的一个，它会减少到几秒钟。

顺便说一句，如果你想走得更快，你可以使用所有以前值的记忆。

```
static final short[] cache = new short[1000000];

public static int collatzNum(long n) {
    if (n == 1) return 1;
    if (n < cache.length) {
        int count = cache[((int) n)];
        if (count > 0)
            return count;
    }
    int next = (n & 1) == 0
            ? 1 + collatzNum(n >> 1)
            : 2 + collatzNum((n * 3 + 1) >> 1);
    if (n < cache.length)
        cache[((int) n)] = (short) next;
    return next;
}

static {
    for (int i = 10; i < cache.length; i *= 2)
        collatzNum(i - 1);
}

public static void main(String... ignored) {
    long start = System.nanoTime();
    int maxCount = 0, max = 0;
    for (int i = 1; i < 1000000; i++) {
        int count = collatzNum(i);
        if (count > maxCount) {
            maxCount = count;
            max = i;
        }
    }
    long time = System.nanoTime() - start;
    System.out.println("count=" + maxCount + ", value=" + max + ", took=" + time / 1000 / 1000.0 + " ms.");
} 
```

在我的笔记本电脑上大约需要 19 毫秒。

注意：结果`odd * 3 + 1`总是偶数，所以你知道你可以将它除以 2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-16T02:01:39.943

这是另一个解决方案。它没有彼得的答案那么有效，但更容易理解：

```
public class P14 {

    public static void main(String[] args) {
        getMaxLength(1000000);
    }

    private static void getMaxLength(int threshold) {
        long maxLength = 1;
        int nr = -1;
        for (int i = 3; i < threshold; i++) {
            long sequenceSize = getSequenceSize(i);
            if (sequenceSize > maxLength) {
                maxLength = sequenceSize;
                nr = i;
            }
        }
        System.out.println(nr);
    }

    private static long getSequenceSize(int n) {
        long x = n;
        long count = 1;
        while (x > 1) {
            if ((x & 1) == 0) {        // x%2==0
                x = x >> 1;            // x=x/2
                count++;               // count=count+1
            } else {
                x = x + x + x + 1;     // x=3*x+1
                x = x >> 1;            // x=x/2
                count+=2;               
            }
        }
        return count;
    }

} 
```

**时间：1.5 秒**（Peter 的解决方案在我的机器上需要 0.142 秒）

使用以下观察可以大大**改善**`x`它：如果我们有，`2*x`将在序列中多走一步（因为`2*x`是偶数）。这就是为什么我们可以忽略小于二分之一的数字。因此，使用以下`getMaxLength`方法：

```
 private static void getMaxLength(int threshold) {
        long maxLength = 1;
        int nr = -1;
        int start = (threshold>>1) - 1;      // start = threshold/2 - 1
        for (int i = start ; i < threshold; i++) {
            long sequenceSize = getSequenceSize(i);
            if (sequenceSize > maxLength) {
                maxLength = sequenceSize;
                nr = i;
            }
        }
        System.out.println(nr);
    } 
```

计算大约需要**0.8 秒**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-06T00:01:41.477

这是使用迭代和递归混合的问题的另一种解决方案。我希望它有所帮助，我还在代码中提供了一些注释以帮助更好地理解它。

```
private static int currentLongestChain = 1;

private static long number = 0;

public static void main(String[] args) {
    //TimeTable();
    PE_Problem_14();
}

private static void PE_Problem_14(){
    int longestChain = 1; // store longest chain
    for(long currentNumber = 1; currentNumber < 1000000; currentNumber++){
         if(currentNumber % 2 == 0){
            PE_Problem_14_even(currentNumber); // if currentNumber is even then invoke even helper method
         }else{
            PE_Problem_14_odd(currentNumber); // if currentNumber is odd then invoke odd helper method
         }

         if(currentLongestChain > longestChain){
            longestChain = currentLongestChain;  // update longestChain
            number = currentNumber;
            currentLongestChain = 0;
         }else{
            currentLongestChain = 0;
        }
    }
    System.out.println("longest chain: " + longestChain + " number: " + number); // print the result to the console screen
}

private static void PE_Problem_14_even(long evenNumber) {  // recursive method
    if(evenNumber <= 1) return;
    long localResult = (evenNumber/2);
    if(localResult % 2 != 0){
        ++currentLongestChain;
        PE_Problem_14_odd(localResult);
    }else {
        ++currentLongestChain;
        PE_Problem_14_even(localResult);
    }
}

private static void PE_Problem_14_odd(long oddNumber){  // recursive method
    if(oddNumber <= 1) return;
    long localResult = (3*oddNumber)+1;
    if(localResult % 2 == 0){
        ++currentLongestChain;
        PE_Problem_14_even(localResult);
    }else{
        ++currentLongestChain;
        PE_Problem_14_odd(localResult);
    }
} 
```

# java - 为玩家设置无敌帧

> ID：16195406
> 
> 赞同：0
> 
> 时间：2013-04-24T15:01:52.347
> 
> 标签：java, if-statement, for-loop

在我正在创建的游戏中，我只希望僵尸能够每分钟击中玩家 2 次，而不是拿走洞的健康栏，因为它会损害玩家的速度。

```
public void checkCollision(){
    Rectangle r3 = player.getBounds();
    for(int i = 0; i < zombie.size(); i++){
        Zombie z = (Zombie) zombie.get(i);
        Rectangle r2 = z.getBounds();
        if(r3.intersects(r2)){
            if(!player.getInvincibility()){
                player.setHealth(player.getHealth() - 10);
                player.setInvincibility(true);
            }  
        }
    }
} 
```

这是检查玩家和僵尸碰撞的代码。我已经做到了，玩家只受到 10 点伤害，但玩家将永远无法再次受到伤害。我尝试使用 if 语句来检查玩家是否无敌，并且 if 语句中有一个 for 循环，当 int 达到 30 000 时会使玩家死亡，但僵尸仍然会如此快速地伤害玩家，以至于洞健康酒吧盖茨被带走。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:05:55.223

为你的僵尸使用攻击冷却时间。

在我的游戏中，我有类似的东西

```
public boolean isReadyToAttack() {
    boolean ret;
    long delta = System.currentTimeMillis() - t0;
    timer += delta;
    if (timer > attackCooldown) {
        timer = 0;
        ret = true;
    } else {
        ret = false;
    }
    t0 = System.currentTimeMillis();
    return ret;
} 
```

然后你只需在你的循环中检查这个，如果僵尸还没有准备好攻击，即使他很近也不会攻击（实际上最好在碰撞前检查冷却时间，这样更便宜）ø

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:04:15.453

有一个每帧都调用的方法 - 称之为 updateTimers 或其他。此方法应将玩家的 invincibilityTimer 递减一定数量。然后，如果玩家有非零的 invincibilityTimer，他们很容易在 checkCollission 中受到伤害，这也会将 invincibilityTimer 设置为一个设定的数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-26T16:23:28.187

我喜欢制作一个警报类来处理诸如“等待 10 帧，然后打印‘Hello world!’之类的事情。到控制台”：

```
public class Alarm {
    //'timer' holds the frames left until the alarm goes off.
    int timer;
    //'is_started' is true if the alarm has ben set, false if not.
    boolean is_started;
    public Alarm() {
        timer = 0;
        is_started = false;
    }
    public void set(int frames) {
        //sets the alarm to go off after the number of frames specified.
        timer = frames;
        is_started = true;
    }
    public void tick() {
        //CALL THIS EVERY FRAME OR ELSE THE ALARM WILL NOT WORK! Decrements the timer by one if the alarm has started.
        if (is_started) {
            timer -= 1;
        }
    }
    public void cancel() {
        //Resets the frames until the alarm goes off to zero and turns is_started off
        timer = 0;
        is_started = false;
    }
    public boolean isGoingOff() {
        //Call this to check if the alarm is going off.
        if (timer == 0 && is_started == true) {
            return true;
        }
        else {
            return false;
        }
    }
} 
```

你可以这样制作一个无敌帧（假设玩家有一个名为 invincibility_alarm 的警报，并且当僵尸击中玩家时它设置为 30 帧。）：

```
//Pretend this is your gameloop:
while (true) {
    if (player.invincibility_alarm.isGoingOff()) {
        player.setInvincibility(false);
        player.invincibility_alarm.cancel();
    }
    player.invincibility_alarm.tick();
    Thread.sleep(10);
} 
```

# css - 如何调整输入字段的大小

> ID：16195407
> 
> 赞同：0
> 
> 时间：2013-04-24T15:01:52.750
> 
> 标签：css, input, resize, field

我正在尝试使我的输入字段可调整大小，但我发现的代码不再起作用。

```
#mededeling 
{
resize: both;
} 
```

有人知道最新的工作代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:59:45.600

使用 textarea 代替 input 怎么样？1row height textarea 看起来就像 input type[text] 并且可以以表单形式提交：

```
textarea name="" id="" cols="30" rows="1" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-02T20:17:59.140

```
<style>
    input {
        resize: horizontal;
        width: 200px;
    }

    input:active {
        width: auto;   
    }

    input:focus {
        min-width: 200px;
    }
</style> 
```

# r - 如何在 R 中使用每周数字创建适当的时间序列`ts()` 对象

> ID：16195408
> 
> 赞同：0
> 
> 时间：2013-04-24T15:01:53.437
> 
> 标签：r, time-series

我经常将这些`ts()`对象用于每年、每季度或每月的时间序列，但现在我想将它用于每周。现在的挑战是，并非每年都有相同的周数（52 周或 53 周）。如何处理？

我通常将一周的第一天作为一周的标识符（例如 2013-05-20 或 2013-05-27）。

任何人都可以建议我如何为以下数据集（x）创建一个适当的每周时间序列。

```
Date            Qty
2013-05-20      25
2013-05-27      60
.... 
```

类似于以下内容：

```
ts <- ts(x$Qty, start=as.Date(x$Date), frequency=????) 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:18:08.767

```
DF <- read.table(text="Date            Qty
2013-05-20      25
2013-05-27      60",header=TRUE)

DF$Date <- as.Date(DF$Date)

library(xts)
my.xts <- as.xts(DF[,-1,drop=FALSE],order.by=DF$Date)
as.ts(my.xts)
# Time Series:
# Start = 1 
# End = 8 
# Frequency = 0.142857142857143 
# [1] 25 60 
```

# android - Listview 在单击时更改行中文本的颜色

> ID：16195413
> 
> 赞同：0
> 
> 时间：2013-04-24T15:02:03.027
> 
> 标签：android, listview, selector

我有一个列表视图：

```
<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:visibility="visible"
    android:choiceMode="singleChoice"
    android:listSelector="@android:color/transparent"
    /> 
```

当我单击一行时，该行内的文本视图将其颜色更改为黑色。当我使用键而不是点击选择一行时，不会发生这种情况。奇怪的是，即使当我使用键（而不是点击）选择另一行时，点击时改变它的文本颜色的行仍然保持黑色文本颜色。

我不想让 textview 改变它的颜色。我如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-18T14:06:15.130

删除 android:choiceMode="singleChoice" 做到了。当然，我必须覆盖选择/取消选择列表项的方法，但至少 textview 没有改变它的文本颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T14:09:03.487

将 android:cacheColorHint="@android:color/transparent" 添加到您的列表中。并查看“行项目布局”是否使用具有不同选择颜色状态的背景。

# ruby-on-rails-3 - rails: resque worker 日志不尊重 log_tags

> ID：16195415
> 
> 赞同：1
> 
> 时间：2013-04-24T15:02:04.140
> 
> 标签：ruby-on-rails-3, logging, resque

我的 config/environments/development.rb 中有以下行：

```
 config.log_tags = [lambda { |req| Time.now }] 
```

这非常适用于 rails 日志（它在每个条目前面加上时间戳）。

我希望我的 resque 工人也有同样的行为。的输出

```
p Rails.application.config.log_tags 
```

在 resque 工作的 perform 方法中向我展示了其中有一个 proc：

```
[#<Proc:0x007ffb36c14920@/.../config/environments/development.rb:49 (lambda)>] 
```

但是，日志条目仍然没有时间戳。我对为什么会发生这种情况没有任何想法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-25T21:04:22.273

在 Rack 中间件 ( )中[，每个请求](https://github.com/rails/rails/blob/ffa9540fd361eb34c445568b66abf283b9e658f8/railties/lib/rails/rack/logger.rb#L21)都会评估一次日志标签。`Rails::Rack::Logger#call`Resque 运行时没有 Web 请求，因此您什么也看不到。

为了得到你想要的，你应该添加类似于`Rails::Rack::Logger#compute_tags`Resque 的代码作为[作业钩子](https://github.com/resque/resque/blob/master/docs/HOOKS.md#job-hooks)，例如，在`before_perform`.

# javascript - 为什么这个“加载消息”脚本在 FF 中不起作用？（javascript）

> ID：16195417
> 
> 赞同：0
> 
> 时间：2013-04-24T15:02:13.507
> 
> 标签：javascript, jquery, image, loading

我有这个脚本，它应该在加载图像时显示文本“正在加载...”，然后在加载所有图像时将文本更改为“已加载”。我添加了一个按钮来加载新图像，以确保它也适用于动态加载的图像。

这在 Chrome 中完美运行，但在 Firefox 中，“正在加载...”文本永远不会出现。我不知道为什么会这样。页面开始加载，但并非所有图像都已加载，因此它应该创建文本“正在加载..”，但事实并非如此。然后，当所有图像加载完成后，会出现“正在加载”文本。

我只是不明白为什么会出现一条消息而另一条则不会。特别是因为在创建“正在加载...”文本之前不需要满足任何条件，它应该会自动触发。

[jsfiddle 示例](http://jsfiddle.net/2JrTc/2/)| [整页示例](http://jsfiddle.net/2JrTc/2/embedded/result/)

```
$(document).ready(function() {

    var checkComplete = function() {
        if($('img').filter(function() {return $('img').prop('complete');}).length == $('img').length) {
            $('.status').text('Loaded');
        } else {
            $('.status').text('Loading...');
        }
    };

    $('img').on('load',function() {
        checkComplete();
    });

    $('#button').click(function() {
        $('img.a').attr('src' , 'http://farm9.staticflickr.com/8545/8675107979_ee12611e6e_o.jpg');
        $('img.b').attr( 'src' , 'http://farm9.staticflickr.com/8382/8677371836_651f586c99_o.jpg');
        checkComplete();
    });

    checkComplete();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T16:06:39.620

您在代码中有几个问题。

首先，`checkComplete()`函数编写不正确。应该是这样的：

```
var checkComplete = function() {
    var imgs = $('img');
    if(imgs.filter(function() {return this.complete;}).length == imgs.length) {
        $('.status').text('Loaded');
    } else {
        $('.status').text('Loading...');
    }
}; 
```

这里的主要修复是过滤器回调需要引用`this.complete`，而不是`$('img').prop('complete')`因为您试图一次过滤单个项目。

其次，您在更改值后依赖两者`.complete`并`.load`正常工作。`.src`这显然是它们不能在所有浏览器中正常工作的情况之一。

解决此问题的防弹方法是为新图像创建一个新图像对象，在设置值之前设置 onload 处理程序`.src`，当两个 onload 处理程序都被触发时，您将知道两个新图像都已加载，您可以替换一旦你在 DOM 中有了新的。

这是一个适用于 FF 的版本：

```
$(document).ready(function() {

    $('#button').click(function() {
        var imgA = new Image();
        var imgB = new Image();
        imgA.className = "a";
        imgB.className = "b";
        var loaded = 0;
        imgA.onload = imgB.onload = function() {
            ++loaded;
            if (loaded == 2) {
                $("img.a").replaceWith(imgA);
                $("img.b").replaceWith(imgB);
                $('.status').text('Loaded');
            }
        }
        // the part with adding now to the end of the URL here is just for testing purposes to break the cache
        // remove that part for deployment
        var now = new Date().getTime();
        imgA.src = 'http://farm9.staticflickr.com/8545/8675107979_ee12611e6e_o.jpg?' + now;
        imgB.src = 'http://farm9.staticflickr.com/8382/8677371836_651f586c99_o.jpg?' + now;
        $('.status').text('Loading...');
    });
}); 
```

工作演示：http: [//jsfiddle.net/jfriend00/yy7GX/](http://jsfiddle.net/jfriend00/yy7GX/)

* * *

如果要保留原始对象，可以仅将新创建的对象用于预加载新图像，然后在预加载后更改 .src，如下所示：

```
$(document).ready(function() {

    $('#button').click(function() {
        var imgA = new Image();
        var imgB = new Image();
        var loaded = 0;
        imgA.onload = imgB.onload = function() {
            ++loaded;
            if (loaded == 2) {
                $("img.a")[0].src = imgA.src;
                $("img.b")[0].src = imgB.src;
                $('.status').text('Loaded');
            }
        }
        // the part with adding now to the end of the URL here is just for testing purposes to break the cache
        // remove that part for deployment
        var now = new Date().getTime();
        imgA.src = 'http://farm9.staticflickr.com/8545/8675107979_ee12611e6e_o.jpg?' + now;
        imgB.src = 'http://farm9.staticflickr.com/8382/8677371836_651f586c99_o.jpg?' + now;
        $('.status').text('Loading...');
    });
}); 
```

此版本的工作演示：http: [//jsfiddle.net/jfriend00/ChSQ5/](http://jsfiddle.net/jfriend00/ChSQ5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:14:51.087

来自[jQuery API`.load`方法](http://api.jquery.com/load-event/)

> ### 与图像一起使用时加载事件的注意事项
> 
> 开发人员尝试使用 `.load()` 快捷方式解决的一个常见挑战是在图像（或图像集合）完全加载时执行一个函数。应该注意几个已知的警告。这些都是：
> 
> *   它不能始终如一地工作，也不能可靠地跨浏览器
> *   如果图像 src 设置为与以前相同的 src，它不会在 WebKit 中正确触发
> *   它没有正确地冒泡 DOM 树
> *   可以停止对已经存在于浏览器缓存中的图像进行触发

# r - Apply() 函数到数据框

> ID：16195419
> 
> 赞同：0
> 
> 时间：2013-04-24T15:02:15.397
> 
> 标签：r

我有一个数据框对象，它有 24 列，每一列都有不同的长度。我想将每一列乘以 24 个值的向量。我正在考虑使用 apply 函数，因为我没有任何矩阵。我的猜测是：

```
trans_temp:
                    Ta.f Ta.f Ta.f Ta.f
1995-10-13 04:00:00 13.6 13.6 13.6 13.6
1995-10-13 05:00:00 13.6 13.6 13.6 13.6
1995-10-13 06:00:00 13.6 13.6 13.6 13.6
1995-10-13 07:00:00 13.5 13.5 13.5 13.5
1995-10-13 08:00:00 13.5 13.5 13.5 13.5 
```

我的向量是

```
 x <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24) 
```

所以我想要第一列乘以 1，第二列乘以 2，第三列乘以 3，依此类推。我不能直接相乘，因为它是一个 data.frame 对象。

应用（trans_temp，x，MARGIN=2，有趣）

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:07:17.947

您可以直接创建一个矩阵，然后将数据与它相乘：

```
as.matrix(trans_temp) * col(trans_temp) 
```

* * *

### 与 eddi's 进行基准测试

```
m <- as.data.frame(matrix(runif(1e7), ncol=1000))
x <- seq_len(1000)
system.time(tt1 <- as.matrix(m) * col(m)) # 0.335 seconds
system.time(tt2 <- t(x*t(m))) # 0.505 seconds
identical(tt1, tt2) # TRUE 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:18:07.787

这是另一种不使用的方法`apply`，它依赖于 R 回收行为：

```
t(x*t(trans_temp)) 
```

这可能会比其他两种方法快得多。

^^^ 在 Arun 的编辑之后不再存在 :) 现在的情况是你可以有一个任意的`x`（如果你想要一个任意的*操作*除了任意的`x`，那么你会选择西蒙的答案）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T15:06:13.630

你在正确的轨道上，但我不明白你的列有不同的长度，除非你的意思是一些包含，例如它们中的 NA。用于`MARGIN = 1`跨行应用。

```
x <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24)
t( apply(trans_temp , MARGIN = 1 , function(y) x * y ) ) 
```

你甚至可以像这样缩短通话时间：

```
 t( apply(trans_temp , 1 , `*` , x ) ) 
```

# java - 等效于 Ceylon 中的 Java“静态”关键字

> ID：16195431
> 
> 赞同：1
> 
> 时间：2013-04-24T15:02:36.460
> 
> 标签：java, static, ceylon

我想知道 Ceylon 编程语言是否具有与 Java 中的“静态”关键字等效的功能，或者是否有一些常见的习语可以代替它。

编辑：详细说明答案，这是一个作用域“函数”的示例（其语法与方法相同），可以在没有类实例的情况下调用，换句话说，它就像一个静态 Java 方法。请注意，关键区别在于它是在“对象”而不是“类”中定义的，这有效地使单例无需实例化：

```
object mystaticstuff {
    shared void introduceYourself() {
        print "madam, im adam";
    }
} 
```

请注意，您还可以在任何类或对象之外声明方法/函数，在这种情况下，它只是在您的“全局”（仍然限于您的包）命名空间中自由浮动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-09-26T21:09:11.923

我们将`static`在 Ceylon 1.3.1 中引入成员。

有一些关于[这个问题](https://github.com/ceylon/ceylon/issues/6515)的更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T15:07:43.103

Ceylon 中没有静态成员。而是在包中声明了顶级函数。

更多信息在这里：[锡兰文档](http://www.ceylon-lang.org/documentation/1.0/spec/html_single/#topleveldeclarations)

# android - 如果我在我的自定义适配器内而不是在主要活动中单击列表视图中的图像视图，则它可以工作

> ID：16195432
> 
> 赞同：0
> 
> 时间：2013-04-24T15:02:37.897
> 
> 标签：android

我有一个包含图像的列表视图。我想在单击图像时进行操作。从我的适配器执行此操作，但我想从列表视图所在的主要活动中执行此操作。

我有我的自定义适配器：

```
ImageView myImage=(ImageView) convertView.findViewById(R.id.myimage);
            byte []temp = theItems.getImagemyItems();
            Bitmap image = BitmapFactory.decodeByteArray(temp, 0, temp.length);
            myImage.setImageBitmap(image);

            myImage.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {
                    Toast.makeText(context, "CLICKED!", Toast.LENGTH_SHORT).show();      

                }
            }); 
```

以上工作正常。如果我从 mainactivity 尝试：

```
View inflatedView = getLayoutInflater().inflate(R.layout.showadapterlist, null);
this.imageView = (ImageView) inflatedView.findViewById(R.id.myimage);   

 imageView.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {
                    Toast.makeText(getBaseContext(), "CLICKED!", Toast.LENGTH_SHORT).show();      

                }

            }); 
```

它不起作用。没有任何反应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:26:29.603

您不必为 ListView 对象设置 OnClickListener。您可以在创建时将点击侦听器传递给您的适配器。尝试这样的事情：

```
class YourActivity extends Activity {
    protected onCreate(Bundle saveInstaceState) {
       super.onCreate(saveInstaceState);
       // some code here
       YourAdapter adapter = new Adapter(this, clickListener);
       listview.setAdapter(adapter);
       // more code here
   }
} 
```

并且你的类适配器应该有一个构造函数来保存这个监听器：

```
public YourAdapter {
    public YourAdapter(Context context, OnClickListener listener) {
      // set everithing you need
      this.listener = listener;
    }

    public View getView (...) {
    // do everithig you need
    myImage.setOnClickListener(listener);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:26:33.320

尝试使用 onTouch 事件，或更改图像按钮的图像...

但是最好使用主要的 onClick 方法（）

```
@Override
public void onClick(final View v) {
         switch(v.getId()){
             case R.id.myimage:
                  //Do it when myimage is clicked
                  Toast.makeText(class.this, "CLICKED!",Toast.LENGTH_SHORT).show();                   
             break;
             case R.id.otherID:
                  //Do something when other item is clicked
             break;
          }

} 
```

和 onClick 听众说再见......

其他选项是在布局中设置属性 onclick ... 一个例子：

```
 <ImageView
      android:id="@+id/myimage"
      android:layout_width="170dp"
      android:layout_height="115dp"
      android:onClick="yourmethodname"
      android:scaleType="centerCrop"
      android:src="@drawable/iconcamera3" /> 
```

并在 java 类中添加：

```
public void yourmethodname(final View v) {
     Toast.makeText(class.this, "CLICKED!",Toast.LENGTH_SHORT).show();   
     //Do anything what you want to do on the onClick event

} 
```

我不喜欢使用 onclick 侦听器，所以我使用这些方法并且从未失败过.. 尝试一下...

编辑：为了使用第一种方法，覆盖 onClick 方法，首先我们必须实现 onClickListener：

```
import android.view.View.OnClickListener;
public class AnyClass extends Activity implements OnClickListener{
@Override
public void onClick(final View v) {
         switch(v.getId()){
             case R.id.myimage:
                  //Do it when myimage is clicked
                  Toast.makeText(class.this, "CLICKED!",Toast.LENGTH_SHORT).show();                   
             break;
             case R.id.otherID:
                  //Do something when other item is clicked
             break;
          }

}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:09:24.080

尝试将此属性添加到您的图像视图：

安卓：可聚焦=“假”

安卓：focusableInTouchMode="假"

机器人：可点击=“假”

# ios - 作为颜色附件的深度纹理

> ID：16195447
> 
> 赞同：1
> 
> 时间：2013-04-24T15:03:03.350
> 
> 标签：ios, c, opengl-es, opengl-es-2.0, framebuffer

我想将深度纹理作为颜色附件附加到帧缓冲区。（我在 iOS 上，支持 GL_OES_depth_texture）

所以我设置了这样的纹理：

```
glGenTextures(1, &TextureName);
glBindTexture(GL_TEXTURE_2D, TextureName);

glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);

glTexImage2D(GL_TEXTURE_2D, 0, GL_DEPTH_COMPONENT, ImageSize.Width, ImageSize.Height, 0, GL_DEPTH_COMPONENT, GL_UNSIGNED_SHORT, 0);

glGenFramebuffers(1, &ColorFrameBuffer);
glBindFramebuffer(GL_FRAMEBUFFER, ColorFrameBuffer);

glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, TextureName, 0); 
```

但是现在如果我检查帧缓冲区状态，我会得到一个`GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT`

我在这里做错了什么？

我也尝试了一些与`GL_DEPTH_COMPONENT16`,的组合`GL_DEPTH_COMPONENT24_OES`，`GL_DEPTH_COMPONENT32_OES`但这些都不起作用（也支持 GL_OES_depth24）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:24:15.093

你不能。具有深度内部格式的纹理只能附加到深度附件。具有颜色内部格式的纹理只能附加到颜色附件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-18T02:17:12.020

正如前面提到的答案，您不能将具有深度格式的纹理附加为颜色表面。现在看看您的评论，您真的是在渲染为 1 通道浮点格式之后。

您可以查看[http://www.khronos.org/registry/gles/extensions/OES/OES_texture_float.txt](http://www.khronos.org/registry/gles/extensions/OES/OES_texture_float.txt)，它允许您拥有浮点格式的纹理格式。

然后，您可以将纹理初始化为仅包含 1 个通道的 Alpha 贴图。

glTexImage2D(GL_TEXTURE_2D, 0, GL_ALPHA, ImageSize.Width, ImageSize.Height, 0, GL_ALPHA, GL_FLOAT, 0);

这可能会也可能不会起作用，具体取决于您的设备支持的扩展。

# mysql - 在 MySQL 中，这可以使用 SQL 语句在指定时间查询数据库吗？

> ID：16195452
> 
> 赞同：1
> 
> 时间：2013-04-24T15:03:21.000
> 
> 标签：mysql, sql, database

例如，数据是这样的：

`[id][name]`

10:00，数据是这样的：

`[1][John]`

在 11:00，用户将数据更改为：

`[1][Johnson]`

那么，用户使用alter命令更改数据，但是数据库有可能在MySQL中10:00查询回数据吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:10:46.410

What you are talking about is versioning. Having time stamp and version number would help but storing multiple records in same table with same id would cause a decrease in data integrity - what about a trigger on the table and insert into some form of audit table?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:16:53.013

一般来说，您有两种选择：

1.  添加带有时间戳的列版本，并将主键扩展为您当前的 PK 和版本。要 grep 数据，您只需要选择最低版本，例如 max。或者为最新版本添加另一个具有位值的列。这应该更快选择。

2.  创建一个包含历史值的表。要实现这一点，您需要在更新时将触发器添加到原始表并复制历史表中的旧值。所以你可以看到所有的变化。

# java - 在没有空值的数组中查找索引

> ID：16195453
> 
> 赞同：0
> 
> 时间：2013-04-24T15:03:21.917
> 
> 标签：java

我有一个名为 e 的数组，这个数组包含对象，但不是在每个索引上。所以我使用 for 循环来查找数组中包含对象的第一个索引。我通过查找不为空的值来做到这一点。如果我找到它，我将索引保存在一个名为 index 的变量中并跳出循环。如果没有找到没有空值的索引，我想从该方法返回。否则，我想继续并使用包含数组索引的变量索引。

```
int index;

for (int i = 0; i < e.length; i++) {
    if (e[i] != null) {
        index = i;
        break;
    }
}

// if index did not get any value inside the for-loop, return

// And here I use the index that was found using the for-loop 
```

如何检查变量索引是否从 for 循环中获得了新索引？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T15:05:36.110

这是始终初始化变量的原因之一。如果你初始化，你可以用这个值做事（并避免不必要的布尔标志）

```
int index = -1;

for (int i = 0; i < e.length; i++) {
    if (e[i] != null) {
        index = i;
        break;
    }
}

if (index == -1) return; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:05:26.470

添加一个布尔标志，在循环之前将其初始化为 false，并且仅在 if 块中使用 break 语句将其设置为 true。循环后检查标志的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:07:30.710

默认索引为 -1 然后检查它是否 > -1

```
int index = -1;

for (int i = 0; i < e.length; i++) {
    if (e[i] != null) {
        index = i;
        break;
    }
}

if (index >= 0) {

} 
```

# jquery - 防止 datepicker 触发父 mouseleave

> ID：16195454
> 
> 赞同：2
> 
> 时间：2013-04-24T15:03:23.520
> 
> 标签：jquery, jquery-ui, hover, jquery-ui-datepicker, jquery-events

`div`我在 jQuery`$.animate({height: 'toggle', opacity: 'toggle'})`上用 jQuery显示绝对值`$.hover()`。

我有一个 jQuery UI datepicker 附加到上述绝对值中的`div`div`changeMonth: true`和`changeYear: true`.

当更改月份或年份或选择日期时，动画会触发。

如何防止月/年更改和日期选择触发`$.hover()`？

[http://jsfiddle.net/e3zP2/](http://jsfiddle.net/e3zP2/)

**html**

```
<div id="hoverAnchor">hover me</div>
<div id="hoverMe" style="display:none">
    arbitrary text
    <div id="dateSelector"></div>
</div> 
```

**js**

```
$(document).ready(function () {

    $("#dateSelector").datepicker({
        changeMonth: true,
        changeYear: true
    });

    $("#hoverAnchor").add($("#hoverMe")).hover(function(){
        $("#hoverMe").stop(true,false).animate({
            height: 'toggle',
            opacity: 'toggle'
        }, 200);
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:30:50.183

您需要做几件事才能使其正常工作。

首先，您需要将 HTML 包装在 a`div`中以充当容器：

HTML：

```
<div id="container">
    <div id="hoverAnchor">hover me</div>
    <div id="hoverMe" style="display:none">arbitrary text
        <div id="dateSelector"></div>
    </div>
</div> 
```

接下来，我建议不要使用[`.hover()`](http://api.jquery.com/hover/)（有时可能不可靠），而是[`.mouseenter()`](http://api.jquery.com/mouseenter/)与[`.mouseleave()`](http://api.jquery.com/mouseleave/). 还使用 a`var`来保存日期选择器是否打开/关闭的布尔值。这个布尔值的原因是由于`input`. 单击时，`.mouseenter()`将调用第二个事件，因此如果没有它，`#hoverme`将再次切换。

```
$(document).ready(function () {
    $("#dateSelector").datepicker({
        changeMonth: true,
        changeYear: true
    });
    var _enter = false;
    $("#container").add(
    $("#container")).mouseenter(function () {
        if (!_enter) {
            $("#hoverMe").stop(true, false).animate({
                height: 'toggle',
                opacity: 'toggle'
            }, 200);
        }
        _enter = true;
    }).mouseleave(function () {
        _enter = false;
        $("#hoverMe").stop(true, false).animate({
            height: 'toggle',
            opacity: 'toggle'
        }, 200);
    });
}); 
```

演示：http: [//jsfiddle.net/dirtyd77/e3zP2/18/](http://jsfiddle.net/dirtyd77/e3zP2/18/)

希望这可以帮助！

# java - 带有 SimpleDateFormat 的 Java 解析日期

> ID：16195459
> 
> 赞同：2
> 
> 时间：2013-04-24T15:03:30.367
> 
> 标签：java, date, jakarta-mail, simpledateformat

我敢肯定这是一个简单的！我有这个字符串`String date = "Wed, 2 Jan 2013 12:17:15 +0000 (GMT)"`，我想将它解析为一个日期，以便能够设置 JavaMail 的发送日期。

这是我的完整代码

```
String dateString = "Wed, 2 Jan 2013 12:17:15 +0000 (GMT)";
SimpleDateFormat sdf = new SimpleDateFormat("EEE, d MMM yyyy HH:mm:ss Z");
Date date = sdf.parse(dateString);
System.out.println("Date: " + date.toString());
email.setSentDate(oDate); // Assume email is initialised correctly 
```

预期产出

```
Date: Wed, 2 Jan 2013 12:17:15 +0000 (GMT) 
```

实际输出

```
Date: Wed Jan 02 12:17:15 GMT 2013 
```

只要我的电子邮件似乎来自正确的日期，我什至不关心时间部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:31:43.283

[Date.toString()](http://docs.oracle.com/javase/6/docs/api/java/util/Date.html#toString%28%29)转换为字符串时应用自己的格式：

```
Converts this Date object to a String of the form:

     dow mon dd hh:mm:ss zzz yyyy 
```

您应该使用`DateFormat`来获取所需的字符串，即发布的代码示例：

```
System.out.println(sdf.format(date)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:24:40.907

尝试这个：

```
String reformattedStr = sdf.format(sdf.parse(dateString)); 
```

或这个

```
String reformattedStr = sdf.format(sdf.parse(date.toString())); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:02:34.557

setSentDate 方法将在电子邮件中设置日期之前为电子邮件正确格式化日期。这与 Date.toString() 所做的不同。另请参见[MailDateFormat](https://javamail.java.net/nonav/docs/api/javax/mail/internet/MailDateFormat.html)类。

# iphone - 如何使用 MPMediaPickerController 获取 mp3 的 NSData？

> ID：16195460
> 
> 赞同：2
> 
> 时间：2013-04-24T15:03:40.983
> 
> 标签：iphone, ios, objective-c, alassetslibrary, mpmediapickercontroller

我想将 mp3 从我的手机上传到服务器，为此我正在使用`MPMediaPickerController`.

获取 URL 后`MPMediaItem`，我想获取此 url 的 NSData，但我在 NSData 中得到空值。

```
- (void) mediaPicker: (MPMediaPickerController *) mediaPicker didPickMediaItems: (MPMediaItemCollection *) mediaItemCollection
{
    [self dismissViewControllerAnimated:YES completion:nil];

    MPMediaItem *item=[[mediaItemCollection items] objectAtIndex:0];
    NSURL *url = [item valueForProperty: MPMediaItemPropertyAssetURL];
    NSString *path = [NSString stringWithFormat:@"%@",url];
    NSData *data = [[NSFileManager defaultManager] contentsAtPath:path];
} 
```

我也试过

```
NSData *data = [NSData dataWithContentsOfURL:url]; 
```

但是数据是空的，为什么？

我也试过[不能从 MPMediaItem(mp3 song) 转换为 NSData](https://stackoverflow.com/questions/15039578/not-able-to-convert-from-mpmediaitemmp3-song-to-nsdata)但没有得到结果。

任何人都可以指导我获取 mp3 的 NSData。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T19:40:49.297

看看这个库：[https](https://github.com/tapsquare/TSLibraryImport) ://github.com/tapsquare/TSLibraryImport它可以将非 DRM 项目从 iPod 音乐库转换为 mp3 文件，然后您可以将它们保存或用作 NSData 进行进一步处理。

# math - 数学中的求和问题

> ID：16195461
> 
> 赞同：0
> 
> 时间：2013-04-24T15:03:48.107
> 
> 标签：math, wolfram-mathematica, series

我对mathematica的这种行为感到困惑。以下两个表达式应返回相同的结果：

```
Simplify[(1 - w)^2 Sum[w^(k+kp) Sum[If[l == lp, 1, 0], {l, 0, k}, {lp, 0, kp}],
{k,0, \[Infinity]}, {kp, 0, \[Infinity]}]] 
```

返回：

```
(-1 - w + w^3)/(-1 + w^2) 
```

而严格等价的：

```
Simplify[(1 - w)^2 Sum[w^(k+kp) Min[k, kp],{k,0,\[Infinity]},{kp,0,\[Infinity]}]
       + (1 - w)^2 Sum[w^(k+kp)           ,{k,0,\[Infinity]},{kp,0,\[Infinity]}]] 
```

返回：

```
1/(1 - w^2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:54:23.343

不是答案，但如果你使用

$$\sum_{k=0}^{\infty} \sum_{l=0}^{k} = \sum_{l=0}^{\infty} \sum_{k=l}^{\infty} $$

然后 ：

```
sum1 = Simplify[(1 - w)^2 
         Sum[w^(k + kp) Sum[KroneckerDelta[l, lp] , {l, 0, k}, {lp, 0, kp}], 
             {k, 0, Infinity}, {kp, 0, Infinity}]]
(* (-2 + w + w^2 - w^3)/(-1 + w^2) *) 
```

但

```
sum2 = Simplify[(1 - w)^2 
         Sum[KroneckerDelta[l, lp] 
             Sum[w^(k + kp), {k, l, Infinity}, {kp, lp, Infinity}] , 
         {l, 0, Infinity}, {lp, 0, Infinity}]]
(* 1/(1 - w^2) *) 
```

# visual-studio-2010 - 如何拉皮条我的（VS2010）编辑器？

> ID：16195465
> 
> 赞同：0
> 
> 时间：2013-04-24T15:03:54.340
> 
> 标签：visual-studio-2010, visual-studio-2012, color-scheme, vssettings

在研究另一个问题时，我遇到了这个：http: [//james.padolsey.com/javascript/sorting-elements-with-jquery/](http://james.padolsey.com/javascript/sorting-elements-with-jquery/)这让我对那个配色方案感到嫉妒（嘿，我是葡萄牙人）。

于是在网上找了一个喜欢的.vssettings文件，尝试通过“导入导出设置”安装——没有效果；我的“blah”配色方案保持不变（即使在重新启动 VS2010 之后）。这不是我的过程有问题，因为我可以在家里做，唯一的区别是我在那里有 VS2012。

那么为什么没有设置 vs-settings 设置呢？更具体地说，我从[http://studiostyl.es/schemes/wekeroad-ink下载了 wekeroad-ink.vs-settings（从](http://studiostyl.es/schemes/wekeroad-ink)[http://weblogs.asp.net/scottgu/archive/2010/04](http://weblogs.asp.net/scottgu/archive/2010/04/29/download-and-share-visual-studio-color-schemes.aspx)链接到它[/29/download-and-share-visual-studio-color-schemes.aspx](http://weblogs.asp.net/scottgu/archive/2010/04/29/download-and-share-visual-studio-color-schemes.aspx)）。

我选择工具 | 导入和导出设置... | 导入选定的环境设置 | 下一个 | 是的，保存我当前的设置 | 下一个 | 选择我的设置 | wekeroad-ink.vssettings | 下一个 | 选择“所有设置”| 完成 | 请参阅“您的设置已成功从 wekeroad-ink.vssettings 导入。” 和“要完成向导，请单击关闭。” | 关闭，...我的编辑器颜色没有变化。重启VS2010；仍然没有喜悦。

在VS2010中让它“接受”的诀窍是什么？

# google-analytics - 使用高级过滤器 - Google Analytics

> ID：16195466
> 
> 赞同：2
> 
> 时间：2013-04-24T15:03:54.827
> 
> 标签：google-analytics

我工作的客户要求使用 Google Analytics 中的历史数据来提供一份报告，向他们显示特定页面上的页面浏览量，但仅在从主页引用到所述页面时，基本上就像站内广告跟踪一样。我发现我可以创建按用户定义变量分组的报告，但是我需要以前的数据也包含在此报告中，因此不能简单地在我的 Google Analytics 调用中定义它。

因此，我一直在尝试使用高级过滤器，试图用查询字符串变量填充用户定义的字段。我附上了一张图片，说明了我当前的配置：

![谷歌分析配置](https://i.stack.imgur.com/IjX4s.png)

此配置未填充“用户定义”字段，因此不会产生所需的结果。

任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:40:32.260

您设置的任何过滤器都只会应用于新数据，而不是历史数据。可能您所追求的可以通过分析 API 检索（您可以使用[查询资源](http://ga-dev-tools.appspot.com/explorer/?csw=1)管理器）。

尝试以下操作：

```
dimensions: ga:nextPagePath
metrics: ga:uniquePageviews
filters: ga:previousPagePath=~<YOUR STARTING PAGE>;ga:nextPagePath=~page\=
sort: -ga:uniquePageviews 
```

查询要问的是“用户从您的起始页点击了哪些包含 'page=' 的首页？”

# java - 交替的字符串和数字

> ID：16195467
> 
> 赞同：1
> 
> 时间：2013-04-24T15:03:55.713
> 
> 标签：java, string, queue, character, alternating

我被赋予了这个问题来解决。我对它应该如何实现只有一点点想法，而且我对编程和东西都太陌生了，很想听听你对此的评论。

假设给定一个“abc1234defgh567jk89”形式的字符串，我必须创建一个新字符串“a1b2c3d5e6f7j8k9”。

请注意，有相应的 [digits] & [characters] 组，并且由于一种类型可能比另一种类型更多，因此输出只有匹配序列，在这种情况下忽略额外的数字或字符 '4' & 'g' & ' H'。

我知道我将不得不使用 2 组**队列**来存储这两种类型的元素，但我不知道如何从这里开始。

如果您能分享一个伪代码或 Java（最好）版本，我将不胜感激，因为我现在正在通过这种语言学习。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:12:23.727

## 伪代码：

```
Queue letterQueue;
Queue numberQueue;

for (every character in the string) {
    if (it's a letter) {
        if (numberQueue is not empty) {
            add the letters alternating into the buffer (stringbuilder), and purge buffers
        }
        add newest letter to letterqueue
    }
    if (it's a number) {
        add newest letter to numberqueue
    }
}
add any remaining unprocessed letters to the queue (this will happen most of the time)

return contents of string buffer 
```

你会需要：

*   [Queue](http://docs.oracle.com/javase/7/docs/api/java/util/Queue.html)，可能是[LinkedList](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedList.html)
*   [字符串生成器](http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html)
*   [String.toCharArray](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#toCharArray%28%29)
*   [特点](http://docs.oracle.com/javase/6/docs/api/java/lang/Character.html)

## 代码：

```
import java.util.LinkedList;
import java.util.Queue;

public class StringTest {
    private static String str ="abc1234defgh567jk89";

    private static String reorganize(String str) {
        Queue<Character> letterQueue = new LinkedList<>();
        Queue<Character> numberQueue = new LinkedList<>();

        StringBuilder s = new StringBuilder();

        for (char c : str.toCharArray()) {
            if(Character.isLetter(c)) {
                if (!numberQueue.isEmpty()) processQueues(letterQueue, numberQueue, s);
                letterQueue.offer(c);
            } else if(Character.isDigit(c)) {
                numberQueue.offer(c);
            }
        }

        processQueues(letterQueue, numberQueue, s);

        return s.toString();
    }

    private static void processQueues(Queue<Character> letterQueue, Queue<Character> numberQueue, StringBuilder s) {
        while(!letterQueue.isEmpty() && !numberQueue.isEmpty()) {
            s.append(letterQueue.poll());
            s.append(numberQueue.poll());
        }
        letterQueue.clear();
        numberQueue.clear();
    }

    public static void main(String... args) {
        System.out.println(reorganize(str));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:08:20.090

看到这个提示：

```
String str = "abc1234defgh567jk89";
String c = str.replaceAll("\\d", "");  // to store characters
String d = str.replaceAll("\\D", ""); // to store digits 
```

尝试这个：

```
public static void main(String[] args) {
    String str = "abc1234defgh567jk89";
    String c = str.replaceAll("\\d", "");
    String d = str.replaceAll("\\D", "");
    String result = "";
    int j = 0, k = 0;
    int max = Math.max(c.length(), d.length());
    for (int i = 0; i < max; i++) {
        if (j++ < c.length())
            result = result + c.charAt(i);
        if (k++ < d.length())
            result = result + d.charAt(i);
    }
    System.out.println(result);
} 
```

输出：

```
a1b2c3d4e5f6g7h8j9k 
```

# google-chrome - Chrome 不信任 Fiddler 根证书

> ID：16195469
> 
> 赞同：76
> 
> 时间：2013-04-24T15:03:57.697
> 
> 标签：google-chrome, ssl, fiddler

我的机器上安装了 Fiddler。我已经安装了 Fiddler 根证书来解密 HTTPS 流量，但它只适用于 FF 和 IE，不适用于 chrome。Chrome 不信任 Fiddler 的证书，并且不允许我连接到任何隧道连接。

我尝试在 Fiddler2.com 的页面上查找插件，但没有看到任何内容。

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2015-11-20T03:49:38.167

我更新了 Fiddler 并遇到了类似的问题。这为我修复了它：http: [//textslashplain.com/2015/10/30/reset-fiddlers-https-certificates/](http://textslashplain.com/2015/10/30/reset-fiddlers-https-certificates/)

**Fiddler 1.3.0+ *（这是新版本，在 4.6.1.5+ 之后出现）***

> *   单击*设置（右上角的齿轮）*。
> *   从左侧面板中选择*HTTPS选项卡*
> *   单击*信任根证书*
> *   接受所有提示
> *   您可能需要重新启动 Fiddler

**提琴手 4.6.1.5+**

> *   单击*工具*>*选项*。
>     
>     
> *   单击*HTTPS*选项卡。
>     
>     
> *   确保文本显示*Certificates generated by CertEnroll engine*。
>     
>     
>     
>     （**注意：**您可能会注意到无法将引擎从*MakeCert*更改为*CertEnroll*，在这种情况下重新启动 Fiddler 并从头开始，它应该会显示*CertEnroll*。）
>     
>     
> *   单击*操作*>*重置所有证书*。这可能需要一分钟。
>     
>     
> *   接受所有提示（删除和重新添加证书）

**Fiddler 4.6.1.4 及更早版本**

> *   单击*工具*>*选项*。
> *   单击*HTTPS*选项卡。
> *   取消选中*解密 HTTPS 流量*复选框。
> *   单击*删除拦截证书*按钮。这可能需要一分钟。
> *   接受出现的所有提示（例如，是否要删除这些证书等）
> *   （可选）单击*Fiddler.DefaultCertificateProvider*链接并验证下拉菜单是否设置为*CertEnroll*。
> *   退出并重新启动 Fiddler。
> *   单击*工具*>*选项*。
> *   单击*HTTPS*选项卡。
> *   重新选中*解密 HTTPS 流量*复选框。
> *   接受所有出现的提示（例如，你想信任这个根证书吗）

我认为这可能只是众多潜在解决方案之一，但它正在成为“您的连接不是私人提琴手”的热门搜索结果之一，所以我会添加它。希望它会帮助遇到它的其他人。

注意：一些人评论说他们需要在运行上述内容后重新启动 Fiddler。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-05-28T16:45:48.203

还值得检查证书生成器插件是否应该受到指责。

就我而言，Fiddler 使用的是`CertMaker.BCCertMaker`. 卸载、重新安装并恢复到 后`CertEnroll engine`，SSL 再次工作。

1.  卸载 Fiddler 及其所有设置。
2.  安装最新版本。
3.  在 Confirm *Tools -> Telerik Fiddler Options... -> HTTPS*中，确认`CertEnroll engine`执行证书生成。
4.  在同一个对话框中，按Chris 的回答中的*Actions -> Reset All Certificates*，接受所有提示。
5.  重启提琴手。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-05-26T23:10:21.443

我在 ubuntu 20.04 上遇到了与 chrome / fiddler 相同的问题，不信任根证书。我使用以下步骤安装 fiddler - 它是一个 beta 版“fiddler 无处不在”，看起来它缺少 Windows 版本中的一些东西，但它确实有效。我不确定这是否取决于（sudo apt install mono-complete）。我尝试了需要单声道的完整版本，所以我的系统上肯定有它，但认为单声道坏了。认为无处不在的提琴手在某种程度上是自给自足的。

*   下载[https://www.telerik.com/fiddler-everywhere/insiders](https://www.telerik.com/fiddler-everywhere/insiders)

*   chmod a+x fiddler-everywhere-insiders.AppImage

*   ./fiddler-everywhere-insiders.AppImage

我从 fiddler options/https 将证书导出为 crt（证书的扩展令人困惑，但我认为这确实是 x509 ssl 证书）。要导入到 chrome，我搜索了“管理证书”的设置。该部分中有很多选项卡，您必须选择权限选项卡。我实际上浪费了一个小时或更长时间，因为我没有看到这些选项卡，而是试图通过默认的“您的证书”选项卡导入。一旦我在正确的位置导入，我就可以浏览 https 流量，并且任何地方的提琴手都可以解密它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-23T03:36:51.990

添加@chris的答案，确保您在清除证书后将您的设备（我的手机）连接到提琴手。否则，它仍然有旧的证书，不会得到新的证书。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-19T20:06:46.423

对于“无处不在的提琴手

*   [从http://127.0.0.1:8866/](http://127.0.0.1:8866/)下载 fiddler 证书（当 fiddler 运行时）
*   转到 chrome 设置，键入“https”以快速导航到“管理证书”
*   转到“权限”选项卡，单击“导入”按钮

# regex - 使用正则表达式查找“ -<”子字符串失败

> ID：16195474
> 
> 赞同：0
> 
> 时间：2013-04-24T15:04:12.513
> 
> 标签：regex, python-3.x

以下是目标字符串。

```
July 17, 2007 –&lt;br> September 25, 2009 <br> June 2007 - July 2010 
```

我正在尝试在`<br>`不跟随的标签之前添加换行符`-`。因此，生成的字符串应该是：

```
July 17, 2007 –&lt;br> September 25, 2009 \n<br> June 2007 - July 2010 
```

我尝试了以下正则表达式无济于事。

```
re.sub(r'([^-])(\s*<br)',r'\1\n\2', astring) 
```

给我

```
July 17, 2007 –\n<br> September 25, 2009\n <br> June 2007 - July 2010 
```

解决办法是什么？

更新：

我实际上并没有用正则表达式解析 HTML。我知道 HTML + RegEx 组合会让我发疯。我已经在使用 lxml 来解析 HTML。但是，我无法理解的是为什么正则表达式无法捕捉到这种`-\s*<`模式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:13:45.923

文本中的破折号是[`EN DASH U+2013`](http://www.fileformat.info/info/unicode/char/2013/index.htm)，这就是`([^-])`匹配`EN DASH`并且发生替换的原因。

您需要将角色添加到您的角色类中，并将其转移`\s*`到第一个捕获组，然后添加`\s`到否定的角色类中以使其按您的意愿工作：

```
re.sub(r'([^\s–-]\s*)(<br)',r'\1\n\2', astring) 
```

请注意，虽然上面的代码有效，但它是不可维护的——因为很难注意到`EN DASH`字符类中的 。

从[Python 3.3](http://docs.python.org/3.3/library/re.html)及更高版本开始，`\u`或`\U`已添加 Unicode 转义序列。您可以这样指定您的正则表达式：

```
re.sub(r'([^\s\u2013-]\s*)(<br)',r'\1\n\2', astring) 
```

可以说是不太清楚是什么`\u2013`，但至少，代码的读者不会被绊倒。

对于 Python 3.2 及更低版本，您可以使用普通文字字符串而不是原始文字字符串语法来实现正则表达式的相同效果。

```
re.sub('([^\\s\u2013-]\\s*)(<br)',r'\1\n\2', astring) 
```

从技术上讲，由于 Python 解析文字字符串的方式（保留`\`if 它不形成有效的转义序列），`'([^\s\u2013-]\s*)(<br)'`也可以工作（比较`\\s`和`\s`），但为了安全起见，我将转义加倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:10:31.647

# sql - Cognos SQL 函数/表达式“ascii”的用途是什么？

> ID：16195478
> 
> 赞同：0
> 
> 时间：2013-04-24T15:04:15.907
> 
> 标签：sql, cognos-bi, impromptu

我必须将 Cognos Impromptu 7 查询转换为 TSQL。部分查询包括以下内容：

```
nconvert((SUBSTRING((ascii(t1.TargetDate)) from 1 for 4)))

/* 
where: 
    t1 is a table alias
    TargetDate is a BIGINT contains the value 200501
*/ 
```

有人可以解释函数/表达式“ascii”的目的吗？

（仅供参考：SQL Server ASCII 函数产生 ascii(200501) ==> ascii(2) ==> 50 ）

奖励：如果有人可以将我指向包含 ascii 定义的在线资源，那将不胜感激。我的搜索没有结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T18:17:08.447

官方 Impromptu 7.5 管理员指南在这里：
[Impromptu Administration Guide 7.5.0](http://pic.dhe.ibm.com/infocenter/c7bi/v7r5m0/topic/com.ibm.swg.im.cognos.impadmin.7.5.0.doc/impadmin.html)
所有功能（包括文本、数字和日期/时间功能）都记录在这里
但是，我没有在那里找到任何 ascii 功能。
所以，第二个选项是创建一个 IQD 文件：
[查看 Impromptu 生成的 SQL](http://www-01.ibm.com/support/docview.wss?uid=swg21348634)
如果这没有帮助。使用 SQL Server Profiler 查看即兴发送的真实 SQL 语句：
[SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms181091.aspx)

# makefile - 在 makefile 中设置标志的条件

> ID：16195479
> 
> 赞同：1
> 
> 时间：2013-04-24T15:04:16.600
> 
> 标签：makefile

我有 Makefile，其中为 IPv6 编译设置了标志。

```
IPV6 = 1

ifeq ($(IPV6), 1) 
```

然后 ipv6 目标包含在编译中。

要求：我想根据功能启用此标志，并且此功能是 CFLAG 的一部分。

```
ifdef IPV6_FEATURE
  IPV6=1
else
  IPV6=0
endif 
```

但是由于 IPV6_FEATURE 在 Makefile 中不可用，因为它是一个全局包含，它总是会去其他地方。

请让我知道是否有任何替代方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T19:04:58.267

如果我理解您的问题，在定义的情况下`IPV6_FEATURE`，它会包含在您测试它的部分之后。这不起作用，因为 make 在读取 makefile 时会评估条件。

解决方案是不使用`ifdef`to set `IPV6`，而是使用条件函数。

```
IPV6 = $(if $(IPV6_FEATURE), 1, 0) 
```

这将设置`IPV6=1`if`IPV6_FEATURE`定义为某个非空值。

您可能还需要更改您的使用方式`$(IPV6)`，以便您没有`ifeq`条件。

# php - PHP MYSQL 错误处理 - 准备好的语句

> ID：16195482
> 
> 赞同：0
> 
> 时间：2013-04-24T15:04:20.587
> 
> 标签：php, mysql, error-handling

我正在尝试使用准备好的语句来实现安全查询：

```
if (!($stmt = $db->prepare($q['query1']))) {
    myException("Prepare failed: (" . $db->errno . ") " . $db->error);
} else if (!$stmt->bind_param("si", $variable1, $variable2)) {
    myException("Binding parameters failed: (" . $stmt->errno . ") " . $stmt->error);
} else if (!$stmt->execute() || !$stmt->store_result()) {
    myException("Execute failed: (" . $stmt->errno . ") " . $stmt->error);
} else {
 (...) 
```

这是最好的方法吗？此代码不可读。我可以使用**try catch**块而不是**if/else if**吗？它会运作良好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:13:25.040

如您所想，这会更清楚：

```
try {
    $stmt = $db->prepare($q['query1']);

    $stmt->bind_param("si", $variable1, $variable2);
    $stmt->bind_param("is", $variable3, $variable4);

    if($stmt->execute()) {
        $stmt->store_result();
        $stmt->bind_result($result);
        $stmt->close();
    } else {
        throw new Exception("error");
    }
} catch (\Exception $e) {
    echo $e->getMessage();
} 
```

[由于 OP 请求，代码已被编辑]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T19:28:58.170

```
try {
    $stmt = $db->prepare($q['query']);
    $stmt->bind_param("s", $s);
    $stmt->execute();
    $stmt->store_result();
    $stmt->bind_result($result);

    if ($stmt->fetch()) {
        $stmt->close();
        return $result;
    }
    else
        throw new Exception("error");
} catch (Exception $e) {
    myExceptionHandler($e);
} 
```

你会接受那个代码吗？:)

# c - 只读取一个字符（避免换行），然后是一个字符串（用于实现简单的 CLI

> ID：16195489
> 
> 赞同：0
> 
> 时间：2013-04-24T15:04:25.793
> 
> 标签：c, character, user-input

我需要实现一个简单的 CLI，它最初会读取一个字符，然后会读取字符指定的命令的第二部分，甚至第三部分。

例如，这些将是命令：

```
1\. p all
2\. r code
3\. h
4\. q 
```

如您所见，有些命令只需要一个字符，而另一些则需要一个字符和一个字符串。

到目前为止我所做的是：
//for the character

```
char init_command;
char command[30];
while(flag) {
    read(STDIN_FILENO, &init_command, 1)
    switch(init_command)
    {
       case ('p'):
            if (fgets(command, sizeof(command), stdin) == NULL)
            {
                perror("fgets print");
                exit(EXIT_FAILURE);
            }
            else
                sscanf(command, "%s", command);
            break;
       case ('h'):
           printfhelp();
           break;
       default:
           printf("Undefined command\n");
           break;
   }
} 
```

我省略了`r code`和`q`命令的部分，因为它是相同的。

所以，这里发生的是，如果我输入这个：

> 全部

一切都好。但是当我输入这个时：

> H

它打印 printhelp() 的输出并立即打印未定义的命令消息。
现在，这必须与 \n 字符有关，但我很难纠正它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:09:58.263

如果`\n`被视为“有效输入”，只需将其添加到案例结构中：

```
case '\n':
  break; 
```

这将允许其他输入作为错误传递，但忽略换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:24:36.487

```
read(STDIN_FILENO, &init_command, 1);
fgets(command, sizeof(command), stdin);
switch(init_command)
{
   case ('p'):
            sscanf(command, "%s", command);
        break;
   case ('h'):
       printfhelp();
       break;
   default:
       printf("Undefined command\n");
       break;
} 
```

# clojure - 惯用的使用方式，同时仍然保持高性能

> ID：16195490
> 
> 赞同：4
> 
> 时间：2013-04-24T15:04:30.823
> 
> 标签：clojure, functional-programming, lisp

我有一个按其键排序的地图，其中包含如下数据：

```
 (def h {50 Text1
    70 Text2
    372 Text1
    391 Text2
    759 Text1
    778 Text2
    }) 
```

地图按键排序。键（数字）可以解释为在大文本块中找到相应值的位置。在上面的示例中，“Text1”位于文本的第 50 位。

现在，我想查找在彼此的 k 个位置内找到的所有文本。我定义了一个这样的函数：

```
 (defn nearest [m k]
         (for [m1 (keys m) m2 (keys m)
              :when (and (> m2 m1) (not= (m m1) (m m2)) (< (- m2 m1) k))]
              [m1 (get m m1)  m2 (get m m2)]))

     (nearest h 50)
     ; [[50 "Text1" 70 "Text2"] [372 "Text1" 391 "Text2"] [759 "Text1" 778 "Text2"]] 
```

这行得通，但是当地图 m 有成千上万个元素时太慢了。因为 for 循环实际上会查看地图中的所有元素对。由于地图是排序的，对于地图中的每个元素，一旦下一个元素已经超过 k 个字符，就不需要检查更多元素。我能够使用循环和递归编写一个版本。但这有点不可读。有没有更自然的方法来做到这一点？我假设 for (:while ) 应该可以解决问题，但无法找到方法。

```
(defn nearest-quick [m k]
      (let [m1 (keys m) m2 (keys m)]
        (loop [inp m res []  i (first m1) m1 (rest m1) j (first m2) m2 (rest m2)]
          (cond
            (nil? i) res
            (nil? j)(recur inp res (first m1) (rest m1) j m2)
            (= i j) (recur inp res i m1 (first m2) (rest m2))
            (< j i) (recur inp res i m1 (first m2) (rest m2))
            (= (inp i) (inp j)) (recur inp res i m1 (first m2) (rest m2))
            (< (- j i) k) (recur inp (conj res [i (inp i) j (inp j)]) i m1 (first m2) (rest m2))
            (>= (- j i) k) (recur inp res (first m1) (rest m1) (first (rest m1)) (rest (rest m1))))))) 
```

注意：对于 42K 元素的地图，第一个版本需要 90 分钟，第二个版本需要 3 分钟。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T15:26:45.503

`subseq`当地图是排序地图时，可能会利用这一点。

```
(defn nearest
  [m n]
  (for [[k v]   m
        [nk nv] (subseq m < k < (+ k n))
        :when (not= v nv)]
    [k v nk nv])) 
```

代码未进行基准测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:51:50.747

Clojure`for`也有一个`:while`修饰符，因此您可以使用条件停止迭代。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:43:18.520

从我从你那里了解到的任何例子：

```
(def h (sorted-map 50 "Text1"
                   70 "Text2"
                   372 "Text1"
                   391 "Text2"
                   759 "Text1"
                   778 "Text2"))

(->> (map #(-> [%1 %2]) h (rest h))
     (filter (fn [[[a b] [x y]]] (< (- x a) 50)))
     (map flatten)) 
```

# c++ - 特定子类的装饰器

> ID：16195493
> 
> 赞同：0
> 
> 时间：2013-04-24T15:04:35.120
> 
> 标签：c++, design-patterns

我有以下课程：

```
class Stream {};

class FileStream : public Stream {};

class NetworkStream : public Stream {}; 
```

每个类都有一个`write()`方法（虚拟）。

我可以在两种类型的媒体上使用 FileStream：HDD 和 SSD。如果我正在写入 HDD，我不会对`FileStream`已经提供的内容做任何特别的事情。但是，如果我正在编写 SSD，则在调用之前需要执行一些逻辑`write()`。从内部`FileStream`，我不知道我正在写信给什么媒体。只有呼叫站点知道。我想在这里使用装饰器，但装饰器旨在用于所有流。我只想`NetworkStream`在某些情况下扩展 的功能。某种形式的装饰器在这里合适吗？如果不是，我应该使用什么设计模式？如果我们假设`FileStream::write()`简单地将整个内部缓冲区刷新到文件并将其保存到磁盘，那么装饰器将需要在写入之前将一些元数据写入流。

我想创建一个不使用继承的简单装饰器类，如下所示：

```
class FileStreamDecorator
{
public:
  FileStreamDecorator( FileStream& stream ) : m_stream( stream )  {}

  void write() {
    m_stream << "Some Metadata";
    m_stream.write();
  }

private:
  FileStream& m_stream;
}; 
```

它会像这样使用：

```
FileStream stream;
stream << "Complete file data";

// At this point we know we are writing to SSD, so we must use the decorator
FileStreamDecorator decorator( stream );
decorator.write(); 
```

这会是一个合适的解决方案吗？谁能想到更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:22:54.493

> 这会是一个合适的解决方案吗？谁能想到更好的方法？

不，您正在创建一个装饰器类并依赖客户端代码在需要时不要忘记使用它。

如果客户端代码忘记执行额外的步骤，代码看起来没问题（客户端代码中没有任何内容表明应该在那里初始化装饰器）。

在一个月（或五年）内，您将忘记这一点，或者转移到其他项目，并且维护该项目的人将不得不意识到需要在客户端中初始化一个新对象。

最好使用 SSDFileStream 特化，它覆盖基类中的 write()（默认行为），在内部调用基类版本，然后执行任何额外的步骤。

我能想到的最佳实现：

```
class FileStream {
    virtual void write();
};

class SSDFileStream: public FileStream {
    virtual void write() {
        FileStream::write();
        write_ssd();
    }
protected:
    void write_ssd();
}; 
```

此外，您可以使 FileStream 抽象，并添加 HDDFileStream 专业化。如果 HDDFileStream 检测到它正在写入 SSD，它可能会引发异常。如果您要求 SSDFileStream 在 HDD 路径上写入，它可能也可以这样做。

这将使客户端代码易于正确编写，并且不可能'*编写不正确。

* * *

'* 编写错误/不稳定/脆弱/丑陋的代码从来都不是不可能的，但你仍然可以让它难以实现。

# c# - C# CSV 文件到数组/列表

> ID：16195497
> 
> 赞同：-5
> 
> 时间：2013-04-24T15:04:44.640
> 
> 标签：c#, .net, csv, csv-import

我想在 C# 的某个数组中读取 4-5 个 CSV 文件

我知道有人问过这个问题，并且我已经完成了这些问题……但是我对 CSV 的使用太简单了……

我有 csv 字段，其中包含以下数据类型的列....

`string , string`

这些字符串没有'，'所以没有张力......就是这样。而且它们并不大。每个只有大约 20 条记录。

我**只想**将它们**读**入 C# 数组中......

有没有*非常非常简单*直接的方法来做到这一点*？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-15T15:42:10.243

这包括字段中的引号和逗号。（假设你一次做一条线）

```
using Microsoft.VisualBasic.FileIO;   //For TextFieldParser

// blah blah blah

StringReader csv_reader = new StringReader(csv_line);

TextFieldParser csv_parser = new TextFieldParser(csv_reader);
csv_parser.SetDelimiters(",");
csv_parser.HasFieldsEnclosedInQuotes = true;
string[] csv_array = csv_parser.ReadFields(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T15:07:39.977

要读取文件，请使用

```
TextReader reader = File.OpenText(filename); 
```

读取一行：

```
string line = reader.ReadLine() 
```

然后

```
string[] tokens = line.Split(','); 
```

将它们分开。

通过在最后两个示例行周围使用循环，您可以将每个标记数组添加到列表中，如果这是您需要的话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-02T16:11:39.753

这是将 CSV 内容获取到字符串数组的简单方法。CSV 文件可以有双引号、回车换行和分隔符是逗号。以下是您需要的库：

`System.IO;` `System.Collection.Generic;`

`System.IO`是为了`FileStream`和`StreamReader`类来访问你的文件。这两个类都实现了`IDisposable`接口，因此您可以使用这些`using`语句来关闭您的流。（下面的例子）

`System.Collection.Generic`命名空间用于集合，例如`IList`、`List`和`ArrayList`等。在这个例子中，我们将使用`List`该类，因为在我看来，列表比数组更好。但是，在返回出站变量之前，我将调用`.ToArray()`成员方法来返回数组。

有很多方法可以从文件中获取内容，我个人更喜欢使用`while(condition)`循环来迭代内容。在`condition`子句中，使用`!lReader.EndOfStream`. 虽然**不是**流结束，但继续迭代文件。

```
public string[] GetCsvContent(string iFileName)
{
    List<string> oCsvContent = new List<string>();
    using (FileStream lFileStream = 
                  new FileStream(iFilename, FileMode.Open, FileAccess.Read))
    {
        StringBuilder lFileContent = new StringBuilder();
        using (StreamReader lReader = new StreamReader(lFileStream))
        {
            // flag if a double quote is found
            bool lContainsDoubleQuotes = false; 
            // a string for the csv value
            string lCsvValue = "";
            // loop through the file until you read the end
            while (!lReader.EndOfStream)
            {
                // stores each line in a variable
                string lCsvLine = lReader.ReadLine();
                // for each character in the line...
                foreach (char lLetter in lCsvLine)
                {
                    // check if the character is a double quote
                    if (lLetter == '"')
                    {
                        if (!lContainsDoubleQuotes)
                        {
                            lContainsDoubleQuotes = true;
                        }
                        else
                        {
                            lContainsDoubleQuotes = false;
                        }
                    }
                    // if we come across a comma 
                    // AND it's not within a double quote..
                    if (lLetter == ',' && !lContainsDoubleQuotes)
                    {
                        // add our string to the array
                        oCsvContent.Add(lCsvValue);
                        // null out our string
                        lCsvValue = "";
                    }
                    else
                    {
                        // add the character to our string
                        lCsvValue += lLetter;
                    }
                }
            }
        }
    }
    return oCsvContent.ToArray();
} 
```

希望这可以帮助！非常容易而且非常快速。干杯!

# javascript - JS 事件触发状态机（rails）中的后端状态更改？

> ID：16195499
> 
> 赞同：0
> 
> 时间：2013-04-24T15:04:48.073
> 
> 标签：javascript, ruby-on-rails, ruby, ajax, state-machine

我正在开发一个新项目：后端有用户，其中有_many“课程”，也有_many“步骤”。

我希望 javascript 验证用户的答案 - 即假设用户输入“6”，这是正确的答案。我想检查的功能看起来像这样。

```
function match_answer(course, answer){
} 
```

如果 JS 事件被证明是真的，我希望它改变后端的 state_machine。state_machine 如下：

```
class Step < ActiveRecord::Base
...

  state_machine initial: :pending do
    state :pending, value: 0
    state :finished, value: 1

    event :finish do
      transition :pending => :finished
    end

    event :restart do
      transition :finished => :pending
    end
  end
end 
```

我想要一个 javascript 事件来更改状态机状态的原因是因为当用户重新登录时，我希望他们去课程中的适当位置。

1) 如何使用 javascript 事件更改 state_machine 的状态？更具体地说，如果 match_answer 函数证明为真，我如何将状态从 :pending 更改为 :finished。

2）假设正确的答案（将检查用户的答案）存储在数据库中，我该如何从数据库中获取正确的答案以便在 match_answer javascript函数中实现它以检查用户的答案？

您可以指出我的任何帮助或资源将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:53:48.917

1) 在您的 match_answer javascript 函数中，使用 AJAX 发布到您的服务器应用程序以更新他们正在执行的步骤。

2) 在您的 javascript 中，您需要知道正确答案，或者可能是问题列表和正确答案。获取此信息的一种方法是使用 gon gem，它基本上可以让您在控制器中设置数据，就像 @instance 变量一样，只是它在您的 javascript 中可用。一个缺点是，如果用户曾经在页面上查看源代码并且看起来足够努力，那么答案将是可见的。另一种方法是通过 AJAX 获取请求从服务器中单独获取它们，但如果这看起来很可能的话，用户可能再次能够窥探流量并找到它们。

也许更好的方法是使用 AJAX 将用户的答案发布到服务器，因为无论如何您都会为每个答案访问服务器。如果正确，服务器可以更新用户所在的步骤并返回 200 状态码。如果回答错误，服务器会返回 422 状态码。您的 ajax 可以使用来自 ajax 请求的成功回调或错误回调来适当地响应。

# asp.net-mvc - visual studio 2012，tfs项目加载失败

> ID：16195500
> 
> 赞同：0
> 
> 时间：2013-04-24T15:04:49.623
> 
> 标签：asp.net-mvc

我的 TFS 管理员重命名了项目名称，当我获得最新版本时，所有其他项目都加载到我的本地视觉工作室，但已重命名的项目未加载。我试图从本地映射路径中删除解决方案，然后再次获得最新版本，但问题仍然相同，它给我一条消息，告诉我项目文件 .csproj 已被移动，重命名或不在您的计算机中。我还尝试删除 .SUO 文件并获取特定和最新版本重新启动 Visual Studio 将现有项目添加到解决方案。我花了很多天来解决这个问题，但我无法这样做，任何人都可以帮助我解决这个问题，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T17:32:58.823

当涉及到我们的 TFS 时，请检查解决方案文件。我遇到了类似的问题，我可以看到正确的文件从 TFS 进入我的本地工作区，但是当我将它加载 VS 时，所有旧代码都回来了。最终我发现解决方案文件仍然引用了我的旧代码，这导致它从 TFS 配置文件中加载。查看管理员是否对 TFS 中的文件进行了物理重命名，但没有更改解决方案和项目文件中的详细信息。

# c# - 如何避免函数中出现过多的向下转换

> ID：16195503
> 
> 赞同：1
> 
> 时间：2013-04-24T15:05:00.610
> 
> 标签：c#, templates, downcast

我的代码中有太多的失望。在 c++ 中，我可以使用模板来避免向下转换。但是以下示例在 c# 中的最佳实现是什么？

```
class Pet { bool mIsDog; }
class Dog : Pet // mIsDog = true
class Cat : Pet // mIsDog = false

class Owner //There are many different owner classes, may come from different dlls
{
    private List<Food> mFoods;

    private void FeedDog(Dog dog)
    {
        ... //Use mFoods, which is invisible to dog
    }

    void HandlePet(Pet pet)
    {
        if(pet.mIsDog) //In c++ I can use templates to avoid downcasting
            FeedDog((Dog)pet);
        else
            FeedCat((Cat)pet);

        ... //code handling general pet

        while(pet.IsUnhappy())
        {
            if(pet.mIsDog) //In c++ I can use templates to avoid downcasting
                PlayWithDog((Dog)pet);
            else
                PlayWithCat((Cat)pet);
        }

        ... //a lot of code handling general pet or specific pet (cat or dog)
    }
} 
```

请注意，函数 HandlePet 具有非常复杂的逻辑，具有许多级别的缩进，因此很难将其分解为多个单独的函数。

* * *

我没有在 Pet 类中创建 BeFedWith 或 BePlayedWith 虚函数的原因是我可能有许多不同的 Owner 类，例如 BoyOwner、GirlOwner、WomanOwner、ManOwner，每个都有自己喂养宠物的方式。Pet 是一个通用类，被许多其他类使用，但 Owner 类只与 Pet 交互。此外，FeedDog 等函数需要访问 Owner 类的私有成员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:23:24.477

您尝试解决的问题是如何根据对象类型进行分派，当您在设计对象时不知道可能需要的所有不同操作时。（其他答案建议将所有必需的操作放在基类中；这有时是不可能的，并且会导致过度耦合）。

答案不是测试对象的类型和类型；如果有的话，你应该很少这样做。一个好的解决方案是使用[访问者模式](http://www.remondo.net/visitor-pattern-example-csharp/)：当您使对象可访问时，您可以通过实现操作而不是更改对象本身来添加在对象类型上调度的新操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:11:59.470

好吧，向下转换被认为是糟糕的设计……您应该将通用方法移至基类并使它们抽象或具有一个接口来做到这一点。

如果你有：

```
public interface Pet{
    void Feed();
    void Play();
}

public class Dog:Pet{
    public void Feed(){
        ...dog feeding code...
    }
    public void Play(){
        ...dog playing code...
    }
}
public class Cat:Pet{
    public void Feed(){
        ...cat feeding code...
    }
    public void Play(){
        ...cat playing code...
    }
} 
```

那么你的handlePet函数就变成了：

```
void HandlePet(Pet pet){
    pet.Feed();
    while(pet.isUnhappy())
        pet.Play();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:15:27.150

如果您必须按照您的建议进行操作，将 Feed 等方法保留为所有者而不是宠物的一部分，那么您可以利用动态绑定来调用正确的所有者方法：

```
using System;

class Pet { }
class Dog : Pet { }
class Cat : Pet { }

class Owner
{
    public void HandlePet(Pet pet)
    {
        HandlePet((dynamic)pet);
    }

    private void HandlePet(Cat pet)
    {
        Console.WriteLine("Stroke the cat softly whispering Please don't scratch me.");
    }

    private void HandlePet(Dog pet)
    {
        Console.WriteLine("Stroke the dog firmly saying Who's a good boy?");
    }
}

class Program
{
    static void Main(string[] args)
    {
        var owner = new Owner();

        Console.WriteLine("Handle dog first");
        owner.HandlePet(new Dog());

        Console.WriteLine("Handle cat second");
        owner.HandlePet(new Cat());

        Console.ReadKey();
    }
} 
```

输出：

> 先处理
> 狗 坚定地抚摸狗说谁是好孩子？
> 处理猫第二次
> 抚摸猫轻声耳语请不要抓我。

* * *

**如果你可以避免它，那么我会将方法放在 Pet 类上**，如下所示：
一种方法是让 Pet 成为一个抽象类，它具有`EatFood`抽象`Play`方法。`Dog`和类将`Cat`实现这些方法：

```
using System;

abstract class Pet
{
    public abstract void EatFood();
    public abstract void Play();

    public void BrushHair()
    {
        Console.WriteLine("Hair brushed!");
    }
}
class Dog : Pet
{
    public override void EatFood()
    {
        Console.WriteLine("Eating dog food...");
    }

    public override void Play()
    {
        Console.WriteLine("Run around manically barking at everything.");
    }
}
class Cat : Pet
{
    public override void EatFood()
    {
        Console.WriteLine("Eating cat food...");
    }

    public override void Play()
    {
        Console.WriteLine("Randomly choose something breakable to knock over.");
    }
}

class Owner
{
    public void HandlePet(Pet pet)
    {
        pet.EatFood();
        pet.Play();
        pet.BrushHair();
    }
}

class Program
{
    static void Main(string[] args)
    {
        var owner = new Owner();

        Console.WriteLine("Handle dog first");
        owner.HandlePet(new Dog());

        Console.WriteLine("Handle cat second");
        owner.HandlePet(new Cat());

        Console.ReadKey();
    }
} 
```

输出：

> 先处理狗
> 吃狗粮...
> 到处乱跑，到处乱叫。
> 头发刷了！
> 处理猫秒
> 吃猫粮...
> 随机选择易碎的东西打翻。
> 头发刷了！

* * *

如果您想使用访问者模式，请尝试以下代码：

```
using System;

public interface IPetVisitor
{
    void Visit(Dog dog);
    void Visit(Cat cat);
}

public interface IPetAcceptor<T>
{
    void Accept(T visitor);
}

public abstract class Pet : IPetAcceptor<IPetVisitor>
{
    public abstract void Accept(IPetVisitor visitor);
}
public class Dog : Pet
{
    public override void Accept(IPetVisitor visitor)
    {
        visitor.Visit(this);
    }
}
public class Cat : Pet
{
    public override void Accept(IPetVisitor visitor)
    {
        visitor.Visit(this);
    }
}

class Owner
{
    // Private variable on owner class
    private int HandCount = 2;

    // Pet handler is an inner class so we can access the enclosing class' private member.
    public class PetHandler : IPetVisitor
    {
        private Owner Owner;

        public PetHandler(Owner owner)
        { Owner = owner; }

        public void Visit(Dog dog)
        {
            Console.WriteLine("Pet the dog with {0} hands", Owner.HandCount);
        }

        public void Visit(Cat cat)
        {
            Console.WriteLine("Pet the cat with {0} hands", Owner.HandCount);
        }
    }
    private PetHandler PetHandlerInstance;

    public Owner()
    {
        PetHandlerInstance = new PetHandler(this);
    }

    public void HandlePet(IPetAcceptor<IPetVisitor> pet)
    {
        pet.Accept(PetHandlerInstance);
    }
}

class Program
{
    static void Main(string[] args)
    {
        var owner = new Owner();

        Console.WriteLine("Handle dog first");
        owner.HandlePet(new Dog());

        Console.WriteLine("Handle cat second");
        owner.HandlePet(new Cat());

        Console.ReadKey();
    }
} 
```

# ios - 使用 IBAction 选择并按下表格单元格行

> ID：16195505
> 
> 赞同：1
> 
> 时间：2013-04-24T15:05:04.183
> 
> 标签：ios, xcode, uitableview, ibaction

我正在拼命地让这个 IBAction 有效地按下选定行的一个单元格。我已经设法让它选择一行，但我不知道如何有效地点击这个单元格！我只是在制作我的第一个应用程序，但我已经设法自己解决了大部分问题，但似乎无法找到如何做到这一点，我希望这是一个简单的解决方案（或者有更好的方法做它比我有）。

无论如何，这是我的 IBAction 的代码：

```
- (IBAction)myButton:(id)sender {

// Specify which cell I wan't to select

NSIndexPath *myIP = [NSIndexPath indexPathForRow:0 inSection:0];

// Select it

[self.tableView selectRowAtIndexPath:myIP animated:NO scrollPosition:UITableViewScrollPositionTop];  

// Click this cell??

} 
```

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:07:17.397

只需告诉代表您已选择它

```
 [self tableView:self.tableView didSelectRowAtIndexPath:myIP]; 
```

假设那`self`是你的控制表的 VC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:23:54.970

下面的stackoverflow答案看起来正是您所需要的......

[自动选择单元格 UITableView](https://stackoverflow.com/questions/7667151/automatically-cell-selected-tableview/7667594#7667594)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:43:34.670

如果您的视图控制器`UITableView`没有子类`UITableViewController`化，您需要创建一个`UITableView`调用它的 IBOutlet`myTableView`或任何您想要的，那么`IBAction`您可以像这样引用它：

```
- (IBAction)myButton:(id)sender {

    // Specify which cell I wan't to select
    NSIndexPath *myIP = [NSIndexPath indexPathForRow:0 inSection:0];

    // Select it
    [self.myTableView selectRowAtIndexPath:myIP animated:NO scrollPosition:UITableViewScrollPositionTop];  

    // (Per Dmitry's answer)
    [self.myTableView didSelectRowAtIndexPath:myIP];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:10:53.430

Not a clean way to achieve but as per my understanding, You can add custom UIButton (transparent) on each cell such a way it covers almost complete cell in `cellForRowAtIndexPath:`, disable row selection. On these button you can use `addTarget:action:`

# java - 在这种情况下，最好使用数据库或读取文件来提高性能？

> ID：16195506
> 
> 赞同：1
> 
> 时间：2013-04-24T15:05:04.470
> 
> 标签：java, database, performance, file

我的这个类 TagVertex 包含一种从文本文件中读取标签 value=string 的方法

并返回

```
 public class TagVertex extends Vertex<String> {

    @Override
    public String computeVertexValue() {
    String s = null;
    try {
        BufferedReader bf = new BufferedReader(new FileReader(MyDataSource.TagList1K));

      for(int i = 1; i < Integer.parseInt(this.getVertexId().substring(this.getVertexId().indexOf("g")+1)); i++){
          bf.readLine();
      }
      s= bf.readLine();
      bf.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
            this.setVertexValue(s);

    return  s;
        } 
```

该方法被调用 1000 次 ==> 文件也被读取 1000 次

最好使用数据库而不是文本文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:20:23.497

访问硬盘驱动器始终是一个非常缓慢的操作。数据库通常也访问硬盘驱动器，因此它们不一定更快。它们甚至可能更慢，因为当数据库不在同一个系统上运行时，会增加网络延迟（即使它在 localhost 上运行，由于进程间通信，您也会有延迟）。

我建议您读取一次文件并缓存该值。当您需要立即知道文件何时更改时，您可以使用新的 WatchService API 在文件更改时重新加载文件。[这是一个教程](http://docs.oracle.com/javase/tutorial/essential/io/notification.html#overview)。当立即注册文件系统级别的更改并不那么重要时，您还可以节省从硬盘驱动器读取顶点信息的时间，并且仅在超过几秒钟时重新读取该值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T16:03:15.263

您可以像这样创建自己的内存数据库。

```
private static final List<String> lines = new ArrayList<>();

@Override
public String computeVertexValue() {
    if (lines.isEmpty())
        try {
            BufferedReader br = new BufferedReader(new FileReader(MyDataSource.TagList1K));
            for (String line; (line = br.readLine()) != null; )
                lines.add(line);
            br.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    return lines.get(Integer.parseInt(this.getVertexId().substring(this.getVertexId().indexOf("g") + 1)));
} 
```

# c++ - boost::iostreams 从源设备读取

> ID：16195510
> 
> 赞同：0
> 
> 时间：2013-04-24T15:05:14.557
> 
> 标签：c++, boost, boost-iostreams

我一直在尝试通过 boost 来了解 iostreams 库。

但我不能真正完全掌握这些概念。

假设我有以下课程：

**伪代码**：以下代码仅用于说明问题。

**编辑：**删除了读取的代码，因为它消除了对真正问题的关注。

```
class my_source {
public:
    my_source():value(0x1234) {}
    typedef char        char_type;
    typedef source_tag  category;

    std::streamsize read(char* s, std::streamsize n)
    {
      ... read into "s" ...
    }
private:
    /* Other members */
}; 
```

现在说我想将 this 流式传输到 int。

我需要做什么 ？我试过以下

```
boost::iostreams::stream<my_source> stream;
stream.open(my_source());

int i = 0;
stream >> i;
// stream.fail() == true; <-- ?? 
```

这导致失败，（设置了失败位）

虽然以下工作正常。

```
boost::iostreams::stream<my_source> stream;
stream.open(my_source());

char i[4];
stream >> i;    
// stream.fail() == false; 
```

有人可以向我解释为什么会这样吗？这是因为我设置了**char_type** char 吗？

我真的无法在任何地方找到一个好的解释。我一直在尝试阅读文档，但如果这是问题，我找不到 char_type 的定义行为。当我使用字符串流时，我可以读入一个 int 而无需做任何特别的事情。

所以如果有人有任何见解，请赐教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T16:28:55.137

所有 iostream 都是文本流，因此这将采用 0x1234 的字节表示，将其解释为文本并尝试将其解析为整数。

顺便一提

```
std::streamsize read(char* s, std::streamsize n)
{
  int size = sizeof(int);
  memcpy(s, &value, 4);
  return size;
} 
```

如果`n < 4`. 此外，您写入四个字节，然后返回一个 int 的大小。`memcpy(s, &value, sizeof value);`将完成这项工作，一个简单的`return sizeof value;`将完成其余的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-20T22:52:30.360

boost::iostreams::stream 没有参数的构造函数什么都不做，结果流没有打开。您需要向 my_source 构造函数添加假参数。

```
class my_source {
public:
    my_source(int fake) : value(0x1234) {}
...

boost::iostreams::stream<my_source> stream(0); 
```

# etl - 处理一行中具有多个名称值对的输入文件

> ID：16195511
> 
> 赞同：1
> 
> 时间：2013-04-24T15:05:20.997
> 
> 标签：etl, pentaho, kettle

我正在写水壶转换。

我的输入文件如下所示

```
sessionId=40936a7c-8af9|txId=40936a7d-8af9-11e|field3=val3|field4=val4|field5=myapp|field6=03/12/13 15:13:34| 
```

现在，我如何处理这个文件？我完全不知所措。

第一步是带有`|`分隔符的 CSV 文件输入

我的分析将基于名称值对的“值”部分。

有没有人处理过这样的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:02:23.840

由于您已经将记录拆分为 'key=value' 的字段，您可以使用表达式转换通过定位 = 字符的位置将字符串一分为二，并创建两个输出端口，其中一个保存键，另一个保存值.
从那里开始，这取决于您想对信息做什么，如果您想将它们存储为键/值，通过联合路由它们，或者使用路由器转换将它们发送到不同的目标。

Her 是拆分对的表达式示例： ![在此处输入图像描述](https://i.stack.imgur.com/C5biC.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T10:18:46.357

您可以使用**Modified Javascript Value Step**，在此分组后添加此步骤与管道。

现在像这样解析javascript：

```
var mainArr = new Array();
var sessionIdSplit = sessionId.toString().split("|");

for(y = 0; y < sessionIdSplit.length; y++){ 
mainArr[y] = sessionIdSplit[y].toString();

    //here you can add another loop to parse again and split the key=value

}

Alert("mainArr: "+ mainArr); 
```

# ios - Phonegap + Wordpress + 应用内购买

> ID：16195518
> 
> 赞同：0
> 
> 时间：2013-04-24T15:05:37.780
> 
> 标签：ios, wordpress, cordova, in-app-purchase

我想创建一个跨平台应用程序，它将从 wordpress 中提取内容并显示帖子列表。从列表中选择一个帖子后，它将显示完整的帖子。问题是这些帖子中很少有付费的，这意味着只有在付费后才能阅读完整的帖子。根据 Apple 政策，我必须实施应用内购买，否则我的应用将被拒绝。我的理解是我可以将自己的支付网关用于其他平台。我请求建议以正确实施这一点。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T11:49:38.880

我不确定你在问什么？最好的方法是让 Wordpress 输出 xml 或 JSON 数据并在您的应用程序中创建自己的 UI 来显示这一点。然后为付费内容提供单独的 XML 提要，只能使用应用内购买来解锁。

要使用 Phonegap 进行应用内购买，您将需要应用内购买插件。 [https://github.com/phonegap/phonegap-plugins](https://github.com/phonegap/phonegap-plugins)

# google-drive-api - 如何获取文件所有者的电子邮件地址 Google Drive API

> ID：16195523
> 
> 赞同：3
> 
> 时间：2013-04-24T15:05:49.457
> 
> 标签：google-drive-api, google-drive-realtime-api

因此，当我通过 Google Drive API 检索文件时，我看到有一个名为“所有者”的属性。这是一个所有者数组，具有 kind、displayName、picture、isAuthenticatedUser 和 permissionId 的值。

从这些信息中，是否有可能找出用户的电子邮件地址/用户名是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-21T11:16:48.740

截至 2015 年 8 月，该方法适用于我：

```
file_ref.getOwner().getEmail() 
```

它使我能够确定谁是曾经与我共享的文件的所有者，并要求他将其从垃圾箱中取出 :) 这是整个脚本（在 Win `ctrl`+上`Enter`显示控制台）：

```
function checkTheFile() {
  /*  paste file id, FILE_ID obtained from its URL  */
  var fileID = "FILE_ID";
  getFileInfo(fileID);  
}

function getFileInfo(fileID) {
  /*  get the file's handle  */
  var file_ref = DriveApp.getFileById(fileID);

  /*  output various file info  */
  Logger.log("Document's title: " + file_ref.getName());
  Logger.log("Document's viewers: " + file_ref.getViewers());
  Logger.log("Document's owner: " + file_ref.getOwner());
  /*  email address:  */
  Logger.log("Document owner's email address: " + file_ref.getOwner().getEmail());
  Logger.log("Sharing Permission: " + file_ref.getSharingPermission());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T09:14:39.450

不，目前无法从权限实体获取所有者的电子邮件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-21T15:49:18.973

您可以使用[Google 文档 API](https://developers.google.com/google-apps/documents-list/#overview_of_sharing_with_acls)。

不幸的是，它已被弃用......希望他们可以将电子邮件添加到 Google Drive API。

# php - 如何将 MySQL 定义的名称输入 php？

> ID：16195524
> 
> 赞同：0
> 
> 时间：2013-04-24T15:05:54.413
> 
> 标签：php, mysql

如果我有一个类似的 mysql 查询

```
(SELECT COUNT(*) FROM data AS amount)
UNION
(SELECT COUNT(*) FROM data WHERE some < 50 AS something) 
```

然后像这样用php创建一个数组`$row = mysqli_fetch_array($sql, MYSQLI_ASSOC);`。

我现在如何处理每个 AS 名称。这不起作用：`echo $row["amount"];`. 我的第二个问题是为什么我不能`AS something`在有 WHERE 子句时使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:09:29.577

尝试这个：

```
(
  SELECT 
    'amount1' as za_name, 
    COUNT(*) as za_count 
  FROM 
    data
) 
UNION 
(
  SELECT 
    'amount2' as za_name, 
    COUNT(*) as za_count 
  FROM 
    data 
  WHERE some < 50 
) 
```

然后你可以区分`$row[za_name]`并得到金额`$row[za_count]`

对于第二个问题：如果您制作临时表，则可以使用它：

```
SELECT
  tmp.za_name,
  tmp.za_count
FROM (
  SELECT 
    'amount2' as za_name, 
    COUNT(*) as za_count 
  FROM 
    data 
  WHERE some < 50 
) as tmp 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:11:40.463

在`UNION`整个查询的行名称/别名中，无论它们在第一个查询中是什么。

所以如果你有

```
SELECT field1 AS A
UNION
SELECT field2 AS B 
```

您的最终结果将只有一个`A`字段，该字段将同时包含`field1`和`field2`。

在您的查询中，您希望为 而`COUNT(*)`不是表起别名。

```
(SELECT COUNT(*) AS amount FROM data)
UNION
(SELECT COUNT(*) FROM data WHERE some < 50) 
```

*整个*查询中的所有行也`$row['amount']`不会。`COUNT(*)`

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:08:18.060

在您的查询中

```
(SELECT COUNT(*) FROM data AS amount) UNION (SELECT COUNT(*) FROM data WHERE some < 50 AS something) 
```

您将表别名为`data`名称`amount`而不是子查询

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:09:57.317

您必须以这种方式编辑查询（列上也有别名）

```
(SELECT COUNT(*) as amount FROM data)
UNION
(SELECT COUNT(*) as amount FROM data WHERE some < 50 AS something) 
```

这样，您就可以`$result['amount']`通过 fetch assoc 方法进行寻址。*

# google-visualization - 更改 Google Chart 中 3D 列的颜色

> ID：16195526
> 
> 赞同：1
> 
> 时间：2013-04-24T15:05:55.363
> 
> 标签：google-visualization

我正在使用 Google Chart 来绘制一些数据，并且我想自定义颜色。我也想使用 3D 条（这意味着我不能使用核心库 BTW）。

这是我得到的结果的屏幕截图：

![在此处输入图像描述](https://i.stack.imgur.com/hfiqI.png)

左边是原始的3D图表，右边是定制的。如您所见，我为 3D 效果定义的颜色没有应用阴影，而是为整个列使用纯色。

有没有什么办法解决这一问题？

PS。这是我用来生成图表的代码：

```
function drawChartCoste(){
        // Create the data table.
          var data = new google.visualization.DataTable();
          data.addColumn('string', 'Valor');
          data.addColumn('number', 'Grupo1');
          data.addColumn('number', 'Grupo2');
          data.addRow(['Consumo', 2.5, -17.860);

          // Set chart options
          var options = {'title':'Comparativa de coste',
                         'width':400,
                         'height':300,
                         'is3D':true,
                         'colors':['#C26900','#165C04']};

          // Instantiate and draw our chart, passing in some options.
          var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
          chart.draw(data, options);
      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T07:17:20.793

[虽然我坚决重申我对 3d 图表的反对意见，但从 Docs 中的这一行](https://developers.google.com/chart/interactive/docs/gallery/columnchart_old)看来这是可行的：

> 如果 is3D=true，这是一个 HTML 颜色数组，或者这个类型的对象：`{color:face_color, darker:shade_color}`其中 color 是元素的表面颜色，而 darker 是阴影颜色。但是，如果您为 3D 对象指定 HTML 颜色，则面和阴影将是相同的颜色，并且 3D 效果会降低。例子：`{is3D:true, colors:[{color:'#FF0000', darker:'#680000'}, {color:'cyan', darker:'deepskyblue'}]}`

这是一个示例：

```
 // Set chart options
    var options = {'title':'Comparativa de coste',
                   'width':400,
                   'height':300,
                   is3D:true,
                   colors:[{color:'#C26900', darker:'#B15800'}, {color:'#165C04', darker:'#054B00'}]
                  }; 
```

# jsp - JSP、JSTL、检查 NaN

> ID：16195528
> 
> 赞同：0
> 
> 时间：2013-04-24T15:06:08.330
> 
> 标签：jsp, jstl

我有一个正在使用的 JSP `<fmt:formatNumber>`。问题是我们不知道传入 JSP 的值是数字还是字符串。如果一个字符串来了，它会抛出 NumberFormatException。

我试图查看 JSTL，但没有成功，如果我检查 value == value 它在某个地方提到它返回 false 如果 String 但没有成功。请看下面的代码。

```
<fmt:formatNumber type="currency" currencySymbol="$" maxFractionDigits="2" minFractionDigits="2" >${primary.value}</fmt:formatNumber> 
```

任何帮助，将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:24:24.623

这可能是您的问题的解决方案。当您尝试将字符串添加到 0 时，您会遇到异常。

```
<c:catch var="catchString">
  <c:set value="${0 + primary.value}" />
</c:catch>
<c:choose>
<c:when test="${not empty catchString}">
  ${primary.value}
</c:when>
<c:otherwise>
  <fmt:formatNumber type="currency" currencySymbol="$" maxFractionDigits="2" minFractionDigits="2" >${primary.value}</fmt:formatNumber>
</c:otherwise>
</c:choose> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T16:50:00.440

另一种解决方案是创建一个自定义标签库来检查您是在处理字符串还是数字，甚至手动格式化您的数字（您的选择）。

我没有时间为您制定示例，但我找到了本 [教程](http://www.codeproject.com/Articles/31614/JSP-JSTL-Custom-Tag-Library) ，他们在其中逐步解释了如何实现所有内容。

**编辑：**更多信息@[甲骨文](http://docs.oracle.com/javaee/5/tutorial/doc/bnahq.html#bnaio)

我希望你能让它工作，如果不让我知道，我明天会尽力帮助你。

# c# - 从 DataSource 的索引中选择 DataGridView 中的一行

> ID：16195535
> 
> 赞同：1
> 
> 时间：2013-04-24T15:06:27.107
> 
> 标签：c#, datagridview

我有一个`DataGridView`从 PostgreSQL 中的视图填充的：

```
dataSource = new BindingSource();
dgData.DataSource = dataSource;
dataSource.DataSource = Program.DB.GetView(dbView, filter); 
```

（`Program.DB.GetView`返回一个`DataTable`）

当我选择了一行并对 进行排序时`DataGridView`，我的选择停留在同一个索引处。我希望选择保留在选定的记录中。

我试图获取第一列（这是数据库的主键）并使用它来引用视图中的一行，但我不知道如何正确执行。

```
if (dgData.SelectedRows.Count == 1) {
     rowIdx = (int)dgData.SelectedRows[0].Cells[0].Value;
     colName = dgData.Columns[0].Name;
} 
```

现在，如何使用 to 在to`rowIdx`中设置行的`Selected`属性？`DataGridView``true`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:12:13.807

我建议 LinQ 获取您的行，然后设置选定的属性：

```
DataGridViewRow searchedRow = (from row in dgData.rows
                               where row.Cells[0].value == rowIdx
                               select row).FirstOrDefault();
if(searchedRow != null)
    searchedRow.Selected = true; 
```

检索行的另一种解决方案（使用 Lambda）：

```
searchedRow = dgData.rows.Cast<DataGridViewRow>()
                         .FirstOrDefault(row => row.Cells[0].value == rowIdx); 
```

或者，如果您不必对 执行任何其他操作，则`Row`可以使用：

```
dgData.rows.Cast<DataGridViewRow>()
           .FirstOrDefault(row => row.Cells[0].value == rowIdx)
           .Selected = true 
```

# java - 如何在数组中移动块

> ID：16195537
> 
> 赞同：0
> 
> 时间：2013-04-24T15:06:31.333
> 
> 标签：java, android, arrays, paint

嘿，我试图让我的块根据它在数组中的位置移动，所以如果它在数组 [0] [0] 中并且我在屏幕上绘制它，我希望它在我将新块放入 [0 时移动][1] 并删除 [0][0] 中的内容，但我遇到问题可以帮忙吗？

```
package com.example.coloroblind;

import java.util.ArrayList;
import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.RectF;
import android.util.Log;
import android.view.View;

public class GameView extends View
{

    block array[][];
    int bottom, top;
    private float rectY = 10;
    private float rectX = 10;
    boolean start = false;
    boolean move = false;
    int w;// The width
    int h;// The hieght
    int x, y;
    // the x and y location of the block& index of the array

    // Needed for the block color
    private Paint paint;

    // Constructor
    public GameView(Context context)
    {
        super(context);
        paint = new Paint();
    }

    // Called back to draw the view. Also called by invalidate().
    @Override
    protected void onDraw(Canvas canvas)
    {
        // starts and initializes the array with the one block before going into the main program
        // sets the hight and width the size of the screen
        if (start == false) {
            w = this.getWidth() - 55;
            h = this.getHeight() - 55;
            bottom = h;
            top = 0;
            firstCreateBlockArray();// creates the first block
            start = true;
        }

        paint.setColor(Color.BLUE);

        for (int x = 0; x < w; x++) {
            for (int y = 0; y < h; y++) {
                if (array[x][y] != null)
                    canvas.drawRoundRect(array[x][y], 6, 6, paint);
                update(x, y);// this is suppose to move the array block
            }
        }

        // Delay
        try {
            Thread.sleep(300);
        } catch (InterruptedException e) {
        }

        invalidate(); // Force a re-draw
    }

    private void firstCreateBlockArray()
    {
        // Creates the array2d of blocks and sets to null
        array = new block[w][h];
        for (int x = 0; x < w; x++) {
            for (int y = 0; y < h; y++) {
                array[x][y] = null;
            }
        }
        int hori = (int) (Math.random() * w) + 1;
        array[hori][0] = new block(hori, 0);// sets the horizonatall of the block randomly

    }

    // suppose ot change position of the block in the array
    private void update(int x, int y)
    {
        // Detect collision and react

        if (y < bottom - 1) {
            array[x][y + 1] = array[x][y];
            // array[x][y]=null;
        }
    }
} 
```

# java - 回车后检票调用方法

> ID：16195541
> 
> 赞同：0
> 
> 时间：2013-04-24T15:06:47.357
> 
> 标签：java, javascript, wicket, panel, keylistener

在我的 Wicket 应用程序中，我想通过单击一个按钮来调用一个方法。我用谷歌搜索并找到了一些用于检票口表格的解决方案，但对于没有表格的面板没有简单的解决方案。有没有一种简单的方法可以在 Wicket 中实现一个键监听器，它有点像 Java Swing mouselistener 接口？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:53:59.547

您可以使用以下代码捕获此事件：

```
$(document).keypress(function(e){
    if(e.which == 13) {
        //call server-side function here
        console.log('You pressed enter!');
    }
}) 
```

[在这里](https://cwiki.apache.org/WICKET/calling-wicket-from-javascript.html)您可以阅读如何从 JS 调用 wicket。

# excel - 从 Excel 文档中删除密码

> ID：16195543
> 
> 赞同：0
> 
> 时间：2013-04-24T15:06:52.333
> 
> 标签：excel, ms-office, password-protection

抱歉，如果这是在错误的站点。

前段时间我在我的 Excel 文档上设置了密码，直到最近我才再次查看它，发现我不再记得密码了。我尝试了以下方法：

1.  输入 VB 代码 - 但是为了能够输入 VB 代码，您必须输入密码。这证明没有这样的运气。

2.  压缩文件，然后解压缩以访问 .xml 文件以编辑保护，该文件似乎只是损坏并在 xml 中包含错误/在 XML 编辑器中打开时 xml 未显示。

我完全不知道我能做什么，这个文件很重要，我需要编辑它。有没有人对我可以尝试解决这个问题有什么建议？

# javascript - 获取鼠标位置或元素位置

> ID：16195544
> 
> 赞同：0
> 
> 时间：2013-04-24T15:06:52.540
> 
> 标签：javascript, jquery

我正在开发具有以下选项的工具提示插件：

1.  鼠标 = 真|假。相对于鼠标或元素的工具提示位置；

2.  静态 = 真|假。Follow mouse when option Mouse = true.

我有一个 JSFiddle 示例：http: [//jsfiddle.net/mdmoura/RPUX6/](http://jsfiddle.net/mdmoura/RPUX6/)

问题：

当我将鼠标放在列表的最后一个工具提示上时，位置是错误的。

每次我滚动页面时都会发生这种情况......我不知道为什么。

设置位置的代码部分是：

```
$(this).each(function (e) {
  // SOME CODE  

  $this.mouseenter(function (e) {

    var $tooltip =
      $("<div>")
      .attr("class", options.class)
      .html(options.content !== '' ? (typeof options.content === 'string' ? options.content : options.content($this, $tooltip)) : tooltip.title)
      .appendTo('body');

    $this.attr('title', '');

    var position = [0, 0];

    if (options.mouse) {
      position = [e.clientX + options.offset[0], e.clientY + options.offset[1]];
    } else {
      var coordinates = $this[0].getBoundingClientRect();       
      position = [
        (function () {
          if (options.offset[0] < 0)
            return coordinates.left - Math.abs(options.offset[0]) - $tooltip.outerWidth();
          else if (options.offset[0] === 0)
            return coordinates.left - (($tooltip.outerWidth() - $this.outerWidth()) / 2);
          else
            return coordinates.left + $this.outerWidth() + options.offset[0];

        })(),
        (function () {
          if (options.offset[1] < 0)
            return coordinates.top - Math.abs(options.offset[1]) - $tooltip.outerHeight();
          else if (options.offset[1] === 0)
            return coordinates.top - (($tooltip.outerHeight() - $this.outerHeight()) / 2);
          else
            return coordinates.top + $this.outerHeight() + options.offset[1];

        })()
      ];
    }

    $tooltip.css({ left: position[0] + 'px', top: position[1] + 'px' }); 
```

您还可以在[http://jsfiddle.net/mdmoura/RPUX6/](http://jsfiddle.net/mdmoura/RPUX6/)中查看代码和演示。

谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:11:21.443

您需要考虑窗口的[scrollTop](http://api.jquery.com/scrollTop/)和[scrollLeft](http://api.jquery.com/scrollLeft/)。

基本思路：

```
var win = $(window);
$tooltip.css( {
    left: position[0] + win.scrollLeft() + 'px', 
    top: position[1] + win.scrollTop() + 'px' 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:18:14.130

添加滚动顶部

```
document.body.scrollTop 
```

你会很高兴去的..

在您的代码中进行这些更改

> function () { if (options.offset[1] < 0) return coordinates.top - Math.abs(options.offset[1]) - $tooltip.outerHeight() **+document.body.scrollTop** ; else if (options.offset[1] === 0) 返回坐标.top - (($tooltip.outerHeight() - $this.outerHeight()) / 2) **+document.body.scrollTop** ; 否则返回坐标.top + $this.outerHeight() + options.offset[1] **+document.body.scrollTop** ;
> 
> })

# xml - 使用 E4X 过滤 XML

> ID：16195545
> 
> 赞同：0
> 
> 时间：2013-04-24T15:07:00.023
> 
> 标签：xml, actionscript-3, e4x

我有这个 XML：

```
public var translations:XML = 
                <translations>
                    <firstName>
                        <en>first name</en>
                        <fr>prénom</fr>
                    </firstName>
                    <lastName>
                        <en>last name</en>
                        <fr>nom de famille</fr>
                    </lastName>
                </translations> 
```

我想将其减少到以下内容：

```
<translations>
    <firstName>first name</firstName>
    <lastName>last name</lastName>
</translations> 
```

在上面我删除了`en`&`fr`节点，我已经将字符串合并`en`到它们的位置。我知道我可以使用 for 循环来做到这一点，但如果可能的话，我更喜欢 E4X 查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T19:28:13.353

我认为能够迭代 E4X Xml 的整个想法是能够让 AS 运算符对 Xml 有用。甚至 Adob​​e 自己的页面（[http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7e72.html](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7e72.html)）也建议使用循环。实际上，我认为您无法通过 '..'、'@'、'[]' 运算符来完成此操作。

# html - 在 HTML CSS 中对齐联系信息

> ID：16195546
> 
> 赞同：-2
> 
> 时间：2013-04-24T15:07:00.883
> 
> 标签：html, css

这就是我需要构建的：[样机](http://s1.directupload.net/file/d/3229/dcj752ty_jpg.htm)

此刻我停留在侧边栏。我需要对齐电话号码的联系信息，以便它们垂直对齐。

在这里，您可以看到我所知道的，文字与电话号码的高度不一致：[Site Link](http://dh-creative-webdesign.de/rw-fliesen.html)

CSS：

```
@charset "utf-8";
/* CSS Document */

body { background: #1c1b17 url(bg.jpg) repeat-x; margin: 0; padding: 0; height: 1800px;         font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px;}

p {
color: #22222b;
line-height: 16px;
padding: 0;
font-size: 12px;
font-weight: 600;
}

#wrapper { width: 1000px; margin: 0 auto; }
#header { height: 400px; width: 1000px; display: block; position: relative; }
#header .logo { position: absolute; width: 374px; height: 221px; display: block; float:     left; cursor: pointer; background: url(logo.png) 0 0 no-repeat transparent; top: 55px;     left: 10px; }
#header .contact-info { position: absolute; width: 293px; height: 133px; display:     block; float: left; cursor: pointer; background: url(contact-info.png) 0 0 no-repeat     transparent; top: 100px; left: 700px; }

ul.mn { position: absolute; float: left; top: 316px; width: 978px; margin: 0; padding:     0; list-style-type: none; }
ul.mn li { float: left; }
ul.mn li a { display: block; float: left; height: 73px; }
ul.mn li a.mn1 { width: 104px; background-image: url('mn1.png'); background-position: 0     0; }
ul.mn li a.mn2 { width: 212px; background-image: url('mn2.png'); }
ul.mn li a.mn3 { width: 142px; background-image: url('mn3.png'); }
ul.mn li a.mn4 { width: 128px; background-image: url('mn4.png'); }
ul.mn li a.mn5 { width: 117px; background-image: url('mn5.png'); }
ul.mn li a.mn6 { width: 147px; background-image: url('mn6.png'); }
ul.mn li a.active, ul.mn li a:hover { background-position: 0 73px; }

#content { height: 1100px; width: 1000px; display: block; position: relative; }

#top { height: 300px; width: 1000px; display: block; position: relative; margin-bottom:     100px;}
#top .foto1 { width: 452px; height: 339px; float: left; margin-top: 30px; }
#top .foto2 { width: 253px; height: 338px; float: left; margin-top: 30px; margin-left:     100px; }

#leftcolumn { height: 200px; width: 300px; display: block; position: relative; }
#leftcolumn .text { height: 10px; width: 300px; display: block; position: relative;     margin-bottom: 200px; }
#leftcolumn .text2 { height: 10px; width: 50px; display: block; position: relative; }
#leftcolumn .text3 { height: 10px; width: 130px; display: block; position: relative;      padding-left: 80px; }
#leftcolumn .face { height: 300px; width: 300px; display: block; position: relative; }

#rightcolumn

#footer 
```

HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html> 
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>RW-Fliesen</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
    <div id="wrapper">
        <div id="header"> <a href="index.html" class="logo" title="Logo"></a>

            <div class="contact-info" title="contact-    info"></div>
            <ul class="mn">
                <li><a href=" " title="" class="mn1 "></a></li>
                <li><a href=" " title="" class="mn2 "></a></li>
                <li><a href=" " title="" class="mn3 "></a></li>
                <li><a href=" " title="" class="mn4 "></a></li>
                <li><a href=" " title="" class="mn5 "></a></li>
                <li><a href=" " title="" class="mn6 "></a></li>
            </ul>
        </div>
        <div id="content">
            <div id="top">
                <div class="foto1" title="Fliesen">
                    <img src="foto1.png" alt="Fliesen1" />
                </div>
                <div class="foto2" title="Fliesen">
                    <img src="foto2.png" alt="Fliesen2" />
                </div>
            </div>
            <div id="leftcolumn">
                <div class="text" title="text">
                    <p>RW-Fliesen
                        <br />Ludwig-Thoma-Str. 36
                        <br />82008 Unterhaching</p>
                    <div class="text2" title="text">
                        <p>Telefon:
                            <br />Fax:
                            <br />Mobil:
                            <br />
                        </p>
                    </div>
                    <div class="text3" title="text">
                        <p>089 - 358 557 88
                            <br />089 - 358 557 89
                            <br />0179 - 673 77 41
                            <br />
                        </p>
                    </div>
                </div>
                <div class="face" title="face">
                    <iframe id="f580fdad4" name="f83387924" scrolling="no" style="border: none; overflow: hidden; height: 690px;     width: 262px;" class="fb_ltr" src="http://www.facebook.com/plugins/likebox.php?api_key=&amp;locale=de_DE&amp;sdk=joey&amp;channel=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D18%23cb%3Dfe1e61258%26origin%3Dhttp%253A%252F%252Fwww.rw-fliesen.com%252Ff21318bbdc%26domain%3Dwww.rw-    fliesen.com%26relation%3Dparent.parent&amp;height=290&amp;header=true&amp;show_faces=true&amp;stream=false&amp;width=262&amp;href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FRW-Fliesen%2F115860578491339&amp;colorscheme=light"></iframe>
                </div>
            </div>
            <div id="rightcolumn"></div>
            <div id="footer"></div>
        </div>
    </div>
</body>
</html> 
```

我们该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:11:22.800

`display: inline-block;`与`text2`和`text3`类一起使用。

```
#leftcolumn .text2 {
height: 10px;
width: 50px;
display: inline-block;
position: relative;
}

#leftcolumn .text3 {
height: 10px;
width: 130px;
display: inline-block;
position: relative;
padding-left: 80px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:13:40.953

在 #leftcolumn .text3 添加此样式规则：

```
top:-22px; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:14:50.973

您可以像这样修改该块 HTML：

```
<style type="text/css">
.title{ display:inline-block; width:80px; }
</style>

<p><span class="title">Telefon</span> 089 - 358 557 88</p>
<p><span class="title">Fax</span> 089 - 358 557 88</p>
<p><span class="title">Mobil</span> 0179 - 673 77 41</p> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:23:28.700

通过将 display:block 更改为 display:inline-block 来修复显示 css。这应该可以解决您的问题。

# apache - 当 URL 包含括号或连字符等字符时，Apache 上出现错误 404

> ID：16195558
> 
> 赞同：0
> 
> 时间：2013-04-24T15:07:35.933
> 
> 标签：apache, url, http-status-code-404, zend-framework2, url-routing

在我的 Zend Framework 2 应用程序中，我有一个带有体育页面链接的城市目录：

“城市”页面 ( `/catalog`)

> 马德里**链接**：`website.tld/catalog/Madrid`
> 
> 柏林**链接**：`website.tld/catalog/Berlin`
> 
> 伦敦**链接**：`website.tld/catalog/London`

“伦敦体育”页面 ( `/catalog/London`)

> 富**链接**：`website.tld/catalog/London/Foo`
> 
> 酒吧（Bar）**链接**：`website.tld/catalog/London/Bar (Bar)`
> 
> Baz - Baz**链接**：`website.tld/catalog/London/Baz - Baz`

这些 URL 被转义并在我的虚拟机 (nginx) 上运行良好。但不在（Apache）服务器上。`404 Error`当 URL 包含方括号（例如`Bar (Bar)`）或连字符（例如）时，我得到一个, `Baz - Baz`。

如何解决？

（我认为，这不是 ZF2 问题。但由于我不能确定，我也用标签标记`zend-framework2`了这个问题。）

* * *

编辑：

我发现了这个错误。这与 Apache 无关，而是我自己的坏事。我在 ZF2 模块配置中错误地定义了路线：

```
'regex' => '/catalog/(?<city>[\p{L}\p{Zs}]*)/(?<sport>[\p{L}\p{Zs}]*)'` 
```

而不是这样的

```
'regex' => '/catalog/(?<city>[\p{L}\p{Zs}]*)/(?<sport>[\p{L}\p{Zs}\p{P}]*)'` 
```

（另见[PCRE](http://regexkit.sourceforge.net/Documentation/pcre/index.html)支持的“[通用类别属性代码](http://regexkit.sourceforge.net/Documentation/pcre/pcrepattern.html#SEC4)列表” ）

# c++ - 为什么 MB_CUR_MAX 未定义？

> ID：16195559
> 
> 赞同：0
> 
> 时间：2013-04-24T15:07:39.543
> 
> 标签：c++

我只是从[cplusplus](http://www.cplusplus.com/reference/cstdlib/wctomb/)复制一些代码，然后运行测试程序`wctomb`：

```
/* wctomb example */
#include <stdio.h>      /* printf */
#include <stdlib.h>     /* wctomb, wchar_t(C) */

int main() {
  const wchar_t str[] = L"wctomb example";
  const wchar_t* pt;
  char buffer [MB_CUR_MAX];
  int i,length;

  pt = str;
  while (*pt) {
    length = wctomb(buffer,*pt);
    if (length<1) break;
    for (i=0;i<length;++i) printf ("[%c]",buffer[i]);
    ++pt;
  }

  return 0;
} 
```

但是，无法编译该程序，因为就我的编译器（VC 2010）而言，MB_CUR_MAX 是未定义的。我在想我应该怎么做。谢谢！

```
error C2057: expected constant expression
error C2466: cannot allocate an array of constant size 0
error C2133: 'buffer' : unknown size 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:18:58.367

`MB_CUR_MAX`被定义为函数调用`#define MB_CUR_MAX ___mb_cur_max_func()`，因此您必须在运行时计算它并动态分配数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T15:20:19.513

与许多预处理器定义的数字不同，MB_CUR_MAX*不需要*是常数。事实上，由于它依赖于语言环境，我不确定它是否可以是编译时常量。

MS将其定义为：

```
#ifndef MB_CUR_MAX
#define MB_CUR_MAX ___mb_cur_max_func() 
```

您在上面提供的代码在 C99 或 C11 中是合法的，其中*将*`char buffer [MB_CUR_MAX];`是一个可变长度数组 - 但基于标签，您正在尝试将其编译为 C++，它不包括 VLA（微软不无论如何都要实现 C99，因此在其 C 模式下也没有 VLA）。

如果您要编译为 C++，您可能希望将其从数组更改为 a `std::vector`，因此指定不是编译时常量的大小不再是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:22:26.523

如果您想继续使用静态缓冲区（这更好，尽管我同意 Jerry 的观点，a`std::vector`是要走的路），请`MB_LEN_MAX`改用。

# c# - 更新 DataTable 中的值不起作用

> ID：16195567
> 
> 赞同：1
> 
> 时间：2013-04-24T15:08:00.493
> 
> 标签：c#, datatable

我有这样的代码：

```
DataTable dt = new DataTable();
// (...) getting data, displaying on DataGridView - all works fine

int columns = dt.Columns.Count; // getting column count

foreach (DataRow row in dt.Rows)
{
    for (int c = 0; c < columns; c++) // c is column index
    {
        // all old values are positive for debugging
        double oldVal = Convert.ToDouble(row.ItemArray[c]);

        // new values should become negative
        double newVal =  oldVal * -1;

        row.ItemArray[c] = newVal; // im trying to update value like this

        // THIS SHOWS POSITIVE NUMBERS (NOT UPDATED)
        this.Text = row.ItemArray[c].ToString(); // this is simple debug

    }
} 
```

这有点复杂，我简化了代码。

为什么我的价值观没有更新？

后来补充：

还有一件事很重要。此数据来自数据库视图，而不是表。当然，我想更改我的 DataTable 对象中的数据，而不是数据库中的数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:08:43.000

最后这样做

```
dt.AcceptChanges(); 
```

这提交自上次`AcceptChanges()`调用以来对该表所做的所有更改。

```
 DataTable dt = new DataTable();
        // (...) getting data, displaying on DataGridView - all works fine

        int columns = dt.Columns.Count; // getting column count

        foreach (DataRow row in dt.Rows)
        {
            foreach (DataColumn c in dt.Columns)
            {
                // all old values are positive for debugging
                double oldVal = Convert.ToDouble(row[c]);

                // new values should become negative
                double newVal = oldVal * -1;

                row[c] = newVal; // im trying to update value like this

                // THIS SHOWS POSITIVE NUMBERS (NOT UPDATED)
                this.Text = row[c].ToString(); // this is simple debug
            }
        }

        dt.AcceptChanges(); 
```

编辑（添加说明）：

不跟踪对 ItemArray 元素的更改，因此数据表值中不会反映任何更改

但是，您可以使用 ItemArray 一次更改所有行，如下所示：

```
dt.Rows[0].ItemArray = new object[] {"new value"}; 
```

在这种情况下，更改会被跟踪，并反映在数据表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:14:23.207

将您的`foreach`循环更新为

```
foreach (DataRow row in dt.Rows)
    {
        for (int c = 0; c < columns; c++) // c is column index
        {       
          double oldVal = Convert.ToDouble(row[c]);    

          double newVal = -oldVal;

          row[c] = newVal;    

          this.Text = row[c].ToString();     
       }
    } 
```

或者您可以使用`foreach`而不是`for`循环：

```
foreach (DataRow row in dt.Rows)
{
    foreach (DataColumn c in dt.Columns)
        {           
        double oldVal = Convert.ToDouble(row[c]);
        double newVal = -oldVal;
        row[c] = newVal;
        this.Text = row[c].ToString();   
       }
} 
```

# networking - tcp 程序无法监听 80 端口

> ID：16195570
> 
> 赞同：1
> 
> 时间：2013-04-24T15:08:06.730
> 
> 标签：networking, tcp, network-programming

我写了一个简单的 tcp 服务器程序并让它监听 80 端口然后我注意到

```
netstat -tulpn|grep "tcp" 
```

tcp服务器监听端口改为随机端口，但不是80

我尝试了其他端口，例如`2000`，tcp 服务器程序运行良好并且可以在该端口上侦听，但`80`不可能

我检查了是否有其他进程在监听 80 端口，原来有一个`httpd`，但我杀了它，我的 tcp 服务器仍然无法监听 80 端口

我试了好几台机器，现象都是一样的请问是什么原因造成的？以及如何让我的程序监听 80 端口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:32:09.080

1024 以下的端口受到限制。如果您只是在玩，那么以 root 身份运行程序很容易，但如果您想编写一个出于安全原因不想以 root 身份运行但仍能够绑定到受限端口的应用程序，您可能想要查看[Linux 功能系统](http://man7.org/linux/man-pages/man7/capabilities.7.html)。

这是有关如何[`setcap`在 Linux 上使用该实用程序的答案的链接。](https://stackoverflow.com/a/414258/2167797).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:11:11.353

你需要root才能监听1024以下的端口。

# solr - solr 多面搜索 UI 开发

> ID：16195571
> 
> 赞同：-2
> 
> 时间：2013-04-24T15:08:14.280
> 
> 标签：solr

我正在研究 POC，我必须在网页上显示多面搜索结果。谁能帮我建议我需要配置显示的所有设置。我更喜欢java技术。顺便提一下，我在远程服务器上运行了 solr 云。我想知道：1.我应该使用MVC框架吗？2\. 我的本地如何与远程 solr 服务器交互？3.我将如何通过java代码发送查询以及我应该使用什么技术来显示分面搜索结果？

或任何某人如何做的例子都会非常有帮助。

请帮助我。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:33:34.047

创建 POC 的最快方法之一是使用[VelocityResponseWriter](http://wiki.apache.org/solr/VelocityResponseWriter)，这个响应写入器捆绑在 Solr 发行版中，它基本上是一系列非常容易定制的 Apache Velocity 模板。

# mysql - 收到错误“不再支持使用旧密码进行身份验证，请使用 4.1 样式密码。” 在创建托管 MySQL 数据库的 WCF 服务时

> ID：16195572
> 
> 赞同：0
> 
> 时间：2013-04-24T15:08:14.583
> 
> 标签：mysql, wcf, entity-framework

我在服务器上托管了 MySQL 数据库。我想创建该数据库的 WCF Web 服务。实际上我想在 Windows Store App 中使用 WCF 服务。我正在关注这些文章。

[使用 Entity Framework 实体作为 Windows 窗体数据源](http://dev.mysql.com/doc/refman/5.1/en/connector-net-tutorials-entity-framework-winform-data-source.html)

[建立连接](http://dev.mysql.com/doc/refman/5.1/en/connector-net-visual-studio-making-a-connection.html)

但我收到错误`Authentication with old password no longer supported, use 4.1 style passwords.`然后搜索 Stack Overflow 并得到了[这个](https://stackoverflow.com/questions/15772479/authentication-with-old-password-no-longer-supported-use-4-1-style-passwords/15989284#15989284)解决方案，但它也不适合我。

请指导我解决这个问题。

PS：请不要对这个问题投反对票，我已经在 Stack Overflow 中搜索并搜索过，但没有得到解决方案 :(

**更新 1**

我在 SQL 查询文本框中通过 phpMyAdmin 应用了命令。我也遵循了这个[Mysql 密码哈希方法 old vs new](https://stackoverflow.com/questions/1892607/mysql-password-hashing-method-old-vs-new)，但是得到了同样的错误`"you have no SUPER privilege."`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-04T13:44:51.733

尽管我尝试了所有提出的建议，但我并没有像其他回应的人那样设法解决问题。最后事实证明，我的数据库所在的服务器自 3.5.5 版以来没有更新 phpMyAdmin，并且目前在 4.1.14 版中到处使用，这是一个问题。解决方案是将您的主机 phpMyAdmin 或您自己的 mySQL 更新回早期版本，以便继续在远程数据库上工作。您可能需要这些知识来解决出现的一些疑问。:)

# email - 如果可以，我可以从本地计算机（IIS 或 Apache）向朋友（比如 gmail）发送电子邮件吗？

> ID：16195573
> 
> 赞同：0
> 
> 时间：2013-04-24T15:08:15.320
> 
> 标签：email, iis, localhost, mail-server

我正计划从我在家中使用的本地 PC（在动态 IP 中）向我的朋友（他们在 gmail 和 hotmail 中）发送电子邮件。是否可以在我的本地 PC 中配置 IIS 或 Apache 并连接到家庭宽带并可以发送电子邮件？

我不想从任何其他托管公司获得任何帮助（通常我们通过使用 .Net 或 Php 使用 SMTP 地址）所以如果需要我可以尝试为我的 PC 配置一些网站名称（如果可能的话）。

我不需要从他们那里得到任何回复，他们会再次发送到我的 gmail 地址。

我的计划有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-22T23:42:33.240

你想要的是建立一个 SMTP 服务器！

你需要的东西

*   静态IP。
*   将 DNS 从您的 ip 反向到您的主机名（在 cmd.exe 上键入 nslookup yourip 结果必须是您的主机名）
*   您的 DNS ZONE 上的 DNS MX 条目，例如 0 your.host.name.com

将实现 RFC2821 [http://www.ietf.org/rfc/rfc2821.txt的程序/代码](http://www.ietf.org/rfc/rfc2821.txt)

我已经建立了一个只接收电子邮件的 SMTP 服务器......也许你可以从那里开始......

[https://stackoverflow.com/questions/24834765/how-receive-emails-in-net-listening-connection-from-gmail-yahooo-not-a-pop](https://stackoverflow.com/questions/24834765/how-receive-emails-in-net-listening-connection-from-gmail-yahooo-not-a-pop)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:13:50.177

这个问题可能对您有所帮助：[如何将电子邮件从本地机器发送到 gmail？](https://stackoverflow.com/questions/4194040/how-to-send-email-from-local-machine-to-gmail?rq=1)

您应该能够在您的家庭计算机上运行 .NET、PHP 或其他本地 Web 服务，并使用上面链接中包含的库之一来发送电子邮件，而无需第三方 Web 主机。出于好奇，您到底想完成什么？gmail 的 API 中可能有一个更简单的解决方案。

# facebook - GraphMethodException - 不支持的获取请求

> ID：16195580
> 
> 赞同：1
> 
> 时间：2013-04-24T15:08:24.947
> 
> 标签：facebook, facebook-graph-api, ssl

我有两个 Debian 系统。我通过 Perl(Facebook::Graph) 访问 Facebook-API。在第一个系统上，这完美地工作，在另一个系统上我遇到了以下问题。

> 无法执行请求（[https://graph.facebook.com](https://graph.facebook.com)）：GraphMethodException - /usr/local/share/perl/5.10.1/Facebook/Graph/Response.pm 第 40 行不支持获取请求

回复.pm：

```
[...]
has response => (
    is      => 'rw',
    isa     => 'HTTP::Response',
    required=> 1,
);
[...]
ouch $response->code, 'Could not execute request ('.$response->request->uri->as_string.'): '.$message, $response->request->uri->as_string;
[...] 
```

我知道这与我的 ssl-libs 有关，但我无法弄清楚问题出在哪里。我多次重新安装了 IO:Socket:SSL 和 SSLeay。

欢迎任何帮助，恩佐

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-23T09:10:23.200

不知道这是否有帮助，但是在尝试访问此页面时来到这里寻求“graphMethodException”的帮助：http://graph.facebook.com/doodleembroidery [（](http://graph.facebook.com/doodleembroidery)现在工作正常）。

刚刚追踪到页面的国家权限。她没有意识到她在创建页面时设置了限制，现在她删除了它们，链接可以正常工作！

# java - java - 如何从java中的url数组列表中获取主机站点列表和该主机的每个实例？

> ID：16195582
> 
> 赞同：1
> 
> 时间：2013-04-24T15:08:29.913
> 
> 标签：java, url, arraylist

我有一个 ArrayList，其中包含 URL 作为字符串。我想找到不同主机站点的列表及其出现的次数。例如，如果在我的列表中有 5 个指向 google 的链接，我想将它们全部计算在内。我从一个遍历列表中每个 URL 的 for 循环开始：

```
for(int i = 0;i<list.size(); i++){

    //for every url at i identify the host site and put in hashmap where the key is the  
    //host site and the variable is the number of URL's from that host
    } 
```

如何从 url 字符串中指定 url 的主机（例如 google.com）。我不知道如何编码那部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:17:00.930

类似的东西（未经测试，但原理是有效的）？

```
 Map<String, Integer> map = new HashMap<String, Integer>();
    for(int i = 0;i<list.size(); i++)
    {
        URL url = new URL(list[i]);
        if (map.containsKey(url.getHost()))
        {
            map.put(url.getHost(), map.get(url.getHost()) + 1);
        }
        else
        {
            map.put(url.getHost(), 1);
        }
    } 
```

如果要打印哈希图：

```
 for (Map.Entry entry : map.entrySet()) 
    {
        System.out.println(entry.getKey() + " " + entry.getValue());
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:10:28.257

我建议您使用`URL.getHost()`来检索主机名，并使用 a`Map<String,Integer>`来存储您看到的每个主机的计数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T15:10:59.693

Create URL object (it has a constructor that recieves a String) and use it's getHost() method

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:14:33.490

如果您查看 URL 的 javadocs，您将看到有一个 getHost 方法： [http ://docs.oracle.com/javase/6/docs/api/java/net/URL.html](http://docs.oracle.com/javase/6/docs/api/java/net/URL.html)

# c# - C#表单间公共方法的访问

> ID：16195586
> 
> 赞同：0
> 
> 时间：2013-04-24T15:08:36.930
> 
> 标签：c#, forms, methods, public

我正在尝试为我的模块做一个简单的项目。我为我的程序制作了一个登录系统，其想法是在用户输入正确的详细信息并提交之前禁用菜单栏控件。到目前为止，这是我想出的主要形式：

```
 public void setControlDisabled()
    {
        fileToolStripMenuItem.Enabled = false;
        clientsToolStripMenuItem.Enabled = false;
        dVDsToolStripMenuItem.Enabled = false;
        windowsToolStripMenuItem.Enabled = false;
    }

    public void setControlEnabled()
    {
        this.fileToolStripMenuItem.Enabled = true;
        this.clientsToolStripMenuItem.Enabled = true;
        this.dVDsToolStripMenuItem.Enabled = true;
        this.windowsToolStripMenuItem.Enabled = true;
    } 
```

以下代码在我的登录表单中以及其他代码中：

```
private void btnLogin_Click(object sender, EventArgs e)
{
            //other code
            Form1 form = new Form1();
            form.setControlEnabled();
} 
```

禁用部分工作正常，即使我在它显示的 setControlEnabled 方法中放了一个小 MessageBox，但它没有启用菜单条。

PS。菜单条上的登录仍然启用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:18:22.193

看起来好像您的 Form1 实例在本地范围内限定为您的 btnLogin_Click 方法，而不是全局实例。在 Class 声明中声明您的 Form1 实例，即：

```
public class Form2
    private Form1 form = new Form1();

    public Form2()
    {
        form.Show();
    }

    private void btnLogin_Click(object sender, EventArgs e)
    {
        form.setControlEnabled();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:14:20.833

这可能是因为您需要存储对表单的引用并使用它。不要重新创建表单，否则您正在与另一个实例交谈，该实例将启用其项目。如果你调用`form.Show()`你当前的代码，你会看到这个

以下是您可以如何处理此问题：

```
Form1 otherForm;
Form1 OtherForm
{
    get
    { 
         //If the form is requested but not created yet, create it
         if(otherForm == null) 
             otherForm = new Form1();
         return otherForm;
    }
}

private void btnLogin_Click(object sender, EventArgs e)
{
            //other code
            OtherForm.setControlEnabled();
} 
```

该属性懒惰地处理表单的创建。如果它已经被创建，那么它只返回那个实例，否则它创建一个新实例并返回它。不过，它将保留此参考。因此，您将需要一个 clear 方法或一个 setter，以便您可以将其设置为 null 如果它已关闭并且您希望它完全删除。

# excel - Excel：运行时错误“1004”将 VBA 数组分配给范围，而无需事先调用 Worksheet.Activate

> ID：16195589
> 
> 赞同：1
> 
> 时间：2013-04-24T15:08:48.110
> 
> 标签：excel, excel-2010, dynamic-arrays, vba

我在 2d VBA 动态数组中生成了一个大的双精度矩阵。当我尝试将 Array 分配给 Excel Range 对象时，我收到以下错误：

```
Runtime Error '1004':

Application-defined or Object-defined Error 
```

除非，也就是说，我在分配之前调用 Worksheet.Activate。（数组的大小约为 88 x 1150）这是代码片段：

```
Dim lIndxRow As Long, lIndxRowBase As Long, lIndxRowLast As Long, lIndxCol As Long, lIndxColBase As Long, lIndxColLast As Long
lIndxRow = [Close_FirstRow]
lIndxRowBase = [Close_FirstRow]
lIndxRowLast = [Close_LastRow]
lIndxColBase = [Close_FirstCol]
lIndxColLast = [Close_LastCol]

Dim Mat() As Double
ReDim Mat(lIndxRowBase To lIndxRowLast, lIndxColBase To lIndxColLast + 1)

While lIndxRow <= lIndxRowLast
    nSharesTotal = 0#
    While lIndxCol <= lIndxColLast
        Dim nShares As Double
        '
        ' Calculate value for nShares
        '
        Mat(lIndxRow, lIndxCol) = nShares
        nSharesTotal = nSharesTotal + nShares
        lIndxCol = lIndxCol + 1
    Wend
    Mat(lIndxRow, lIndxCol) = nSharesTotal
    lIndxRowPrev = lIndxRow
    lIndxRow = lIndxRow + 1
Wend
' no error when next line uncommented
'Worksheets("Share Pos").Activate
Worksheets("Share Pos").Range(Cells(lIndxRowBase, lIndxColBase), Cells(lIndxRowLast, lIndxColLast + 1)).Value2 = Mat 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:25:31.747

问题是单元格对象不是完全限定的。你必须完全符合他们的要求。试试这个（注意 CELLS 之前的 DOT？

```
With Worksheets("Share Pos")
    .Range(.Cells(lIndxRowBase, lIndxColBase), .Cells(lIndxRowLast, _
    lIndxColLast + 1)).Value2 = Mat
End With 
```

# php - 通过二维数组从指定行中动态选择指定列

> ID：16195592
> 
> 赞同：0
> 
> 时间：2013-04-24T15:08:53.000
> 
> 标签：php, sql

我对 PHP 和 MySQL 比较陌生。

我有一张这样的桌子......

```
id      name       username      app      sdate    edate   
===    =======     ========    ===      =====    ======  
 1      tanvir      tanvir      1       2012     2012       
 2      Ranvir      Ranvir      1       2011     2013      
 3      john        john        2       2011     2012     
 4      Rakib       Rakib       1       2011     2012 
```

现在我想一次获取多行并将它们动态放入一个二维数组变量中，这样我就可以创建一个条件......

```
if(array[variable containing all the value of sdate of each row] == '' 
  &&  
array[variable containing all the value of username of each row] == '') 
{
  \*then some code *\
} 
```

这里`sdate`不应该`sdate` 也不`username`应该`username`。而不是`sdate`and`username`应该有一个更像二维变量的变量，它将指示特定的行和特定的列......通过给出一个例子再次明确......如果我**动态地**想要选择第 3 行的`sdate`和`username`和把它放在前面的`if`条件（提到），那么我该怎么做......我动态地提到，因为每一行的`sdate`和`username`应该像`if`条件一样检查。可能吗？

如果可能，比什么方法？

# php - 具有 at() 功能的 PHPUNIT 模拟工作很奇怪

> ID：16195594
> 
> 赞同：2
> 
> 时间：2013-04-24T15:08:56.687
> 
> 标签：php, mocking, phpunit, indexing

这是以下代码示例

```
<?php

interface iFS
{
    public function read();
    public function write($data);
}

class MyClass
{
    protected $_fs = null;

    public function __construct(iFS $fs)
    {
        $this->_fs = $fs;
    }

    public function run(array $list)
    {
        foreach ($list as $elm)
        {
            $this->_fs->write($elm);
        }

        return $this->_fs->read();
    }
}

class MyTests extends PHPUnit_Framework_TestCase
{
    public function testFS()
    {
        $mock = $this->getMock('iFS');
        $mock->expects($this->at(0))
                ->method('read')
                ->will($this->returnValue('tototatatiti'));

        $c = new MyClass($mock);
        $result = $c->run(array('toto', 'tata', 'titi'));

        $this->assertEquals('tototatatiti', $result);
    }
} 
```

这绝对不是一个真实的案例，但它使 phpunit 和 at($index) 功能发生了一些奇怪的事情。

我的问题很简单，测试失败正常吗？

我明确要求返回“tototatatiti”，但它从未发生过......

什么时候

*   我删除了 $this->_fs->write($elm); 行 或者
*   我将 $mock->expects($this->at(0)) 替换为 $mock->expects($this->once())

测试通过绿色

有什么我不明白的吗？

编辑：

$mock->expects($this->at(3)) ->method('read') ->will($this->returnValue('tototatatiti'));

=> 将使测试通过绿色...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T16:13:05.250

根据[PHPUnit 源代码](https://github.com/sebastianbergmann/phpunit-mock-objects/blob/master/PHPUnit/Framework/MockObject/Matcher/InvokedAtIndex.php#L95)，我们有：

```
public function matches(PHPUnit_Framework_MockObject_Invocation $invocation)
{
    $this->currentIndex++;

    return $this->currentIndex == $this->sequenceIndex;
} 
```

每次`PHPUnit_Framework_MockObject_Matcher_InvokedAtIndex`尝试匹配调用时，受保护的变量`$currentIndex`都会递增，因此您首先调用 write 会导致它变为 0，然后它不匹配`read`。

第二次调用 to`read`导致值变为 1，因此它也不匹配。

看起来它确实适用于整个对象，如果您需要确保一系列调用以特定顺序发生，这很有用。

例如，假设该`write`方法只被调用一次，你可以有类似的东西：

```
$mock->expects($this->at(0))
            ->method('write');

$mock->expects($this->at(1))
            ->method('read')
            ->will($this->returnValue('tototatatiti')); 
```

这确保了该`write`方法确实在该`read`方法之前被调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T08:43:04.670

我认为如果模拟对象包含一些其他方法也被调用，那么 phpunit at() 功能对于模拟方法的不同返回结果存根是没有用的......

如果你想测试类似的东西：

```
$stub->expects($this->at(0))
                ->method('read')
                ->will($this->returnValue("toto"));

$stub->expects($this->at(1))
                ->method('read')
                ->will($this->returnValue("tata")); 
```

你最好使用类似的东西

```
$stub->expects($this->exactly(2))
                ->method('read')
                ->will($this->onConsecutiveCalls("toto", "tata)); 
```

# asp.net - asp:repeater w/ asp:image 和 generic-handler - SQLConnection 崩溃

> ID：16195597
> 
> 赞同：1
> 
> 时间：2013-04-24T15:09:08.423
> 
> 标签：asp.net, sql, image, repeater, generic-handler

我有一个 asp 中继器，它为每个条目设置不同的 generichandler (.ashx) 参数。这用于创建用户发布的评论，并通过从数据库中获取用户发布的头像来显示该用户的头像。如果只有一个帖子，它可以正常工作，但是一旦有两个或更多帖子，我就会在“connection.Open()”行（下面提供的代码）上的“GetIdFromUserName”方法中崩溃，说“连接未关闭，连接当前状态为打开”。请记住，这只发生在存在多个评论时，我不知道是什么原因造成的。

不过，我发现了一件事：如果我让 asp:image 对象不使用“Eval”（因此它只为每个帖子显示相同的图像，而不管 ）它可以工作，但除此之外我不知道。不过，如前所述，如果只有一篇文章要显示，Eval 确实可以正常工作。

如果有人知道如何解决这个问题，我将非常感激。

ASP 代码：

```
 <asp:Repeater ID="CommentsRepeater" runat="server" OnItemDataBound="CommentsRepeater_ItemDataBound">
            <ItemTemplate>
                <div class="comment">
                    <div class="commentInfo">
                        <strong>
                            <asp:Image ID="Avatar" ImageUrl='<%# "CommentsAvatarHandler.ashx?id=" + Eval("UserName") %>' runat="server" Height="100px" Width="100" />
                            <asp:LinkButton ID="CommentName" Text='<%# Eval("UserName") %>' CommandArgument='<%# Eval("UserId") %>' CausesValidation="false" runat="server"></asp:LinkButton></strong> @ 
                        <asp:Label ID="CommentDate" Text='<%# Eval("PostedDate") %>' runat="server"></asp:Label>
                        <div class="commentVote">
                            <asp:LinkButton ID="VoteUp" CommandArgument='<%# Eval("CommentId") %>' OnClick="VoteUpClick" CausesValidation="false" runat="server"><img src="images/pluss2.png" /></asp:LinkButton>
                            <asp:LinkButton ID="VoteDown" CommandArgument='<%# Eval("CommentId") %>' OnClick="VoteDownClick" CausesValidation="false" runat="server"><img src="images/minus2.png" /></asp:LinkButton>
                            <strong>(<asp:Label ID="CommentVote" Text='<%# Eval("Vote") %>' runat="server"></asp:Label>)</strong>
                        </div>
                    </div>
                    <div class="commentText">
                        <asp:Label ID="CommentText" Text='<%# Eval("Comment") %>' runat="server"></asp:Label>
                    </div>
                </div>
            </ItemTemplate>
            <SeparatorTemplate>
                <br />
            </SeparatorTemplate>
        </asp:Repeater> 
```

相关位：

```
 <asp:Image ID="Avatar" ImageUrl='<%# "CommentsAvatarHandler.ashx?id=" + Eval("UserName") %>' runat="server" Height="100px" Width="100" /> 
```

这是处理程序：

```
public class CommentsAvatarHandler : IHttpHandler
{

    public void ProcessRequest(HttpContext context)
    {
        String userName = context.Request.QueryString["id"];
        Gamez.Sql.GetAvatarOfUser(context, userName);
    }

    public bool IsReusable
    {
        get
        {
            return false;
        }
    }
} 
```

处理程序使用的方法：

```
 public static void GetAvatarOfUser(HttpContext context, String userName)
    {
        SqlDataReader reader;

        try
        {
            Guid id = GetIdFromUserName(userName);
            command.CommandText = "SELECT Avatar FROM UserAttributes WHERE UserId = @id";
            command.Parameters.AddWithValue("@id", id);

            connection.Open();
            reader = command.ExecuteReader();
            while (reader.Read())
            {
                try
                {
                    context.Response.ContentType = "image/jpg";
                    context.Response.BinaryWrite((byte[])reader["Avatar"]);
                }
                catch { }
            }
            if (reader != null)
                reader.Close();

        }
        finally
        {
            if (connection != null)
            {
                connection.Close();
            }
        }

    } 
```

GetIdFromUserName 方法：

```
 public static Guid GetIdFromUserName(String name)
    {
        command.Parameters.Clear();
        command.CommandText = "SELECT UserId FROM aspnet_Users WHERE UserName = @UserName";
        command.Parameters.AddWithValue("@UserName", name);
        connection.Open();  // <---- DESCRIBED CRASH HAPPENS HERE
        Guid id = (Guid)command.ExecuteScalar();
        connection.Close();
        return id;
    } 
```

GetAvatarFromUser 和 GetIdFromUserName 位于同一个库中，并且可以访问相同的 SQLCommand（命令）和 SQLConnection（连接）对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T17:31:09.923

从您的代码看来，您对每个请求都使用了相同的`connection`实例`command`。我假设这两个都是页面级变量？

***为每个***sql 请求创建这两个变量的单独实例。

此外，您应该将 Connection 和 Command 初始化包装在 using 块中。这将负责正确关闭和处置这两种资源并使用最佳实践。像这样的东西：

```
using (SqlConnection conn = [CONNECTION INITIALIZATION])
   {
   using (SqlCommand command = new SqlCommand(conn))
      {
      ...
         using (SqlDataReader reader = command.ExecuteReader())
         {
            .....
         }
      }
   } 
```

目前，按照您的设置方式，您正在自找麻烦。

**编辑**

当有第二个帖子时，您的代码将失败，因为您在多个请求中共享您的连接对象。因此，当第一个帖子的信息被检索（打开连接）时，您正在尝试检索*另一个*帖子（再次尝试打开***相同***的连接）。

那有意义吗？

# jquery - 将 html 输入值传递给 jquery ui 对话框 ass 变量

> ID：16195598
> 
> 赞同：-2
> 
> 时间：2013-04-24T15:09:08.573
> 
> 标签：jquery, forms, variables, input, dialog

我有一个带有自动完成输入字段的 html 表单，可以打开一个 jquery 对话框。在这个对话框中，我有一个 sql 搜索，需要输入框中的值。如何在对话框中获取 ass 变量的输入？

```
<!--autocomplete script -->
 <script>
    $(function() {
    $( "#searchImage" ).autocomplete({
        source: "search.php",
        minLength: 1 
      });
   });
</script>

<!-- Dialog Script -->
          <script>    $(function(){       
     $('#imageDialog').dialog({
       autoOpen: false,
       bgiframe: true,
       height: "auto",
       width: 900,
       modal: true,
       position: [ "center" , 150],
       show: {
          effect: "clip",
          duration: 1000
       },
       hide: {
          effect: "clip",
          duration: 1000
       },
       buttons: {
          OK: function() { 
              $(this).dialog( "close" ); 
          }
       }
     });

     $('form#imageForm').submit(function(e){
     e.preventDefault();
     $('#imageDialog').dialog('open');
     });
    });
  </script>

<!-- Search Box -->
   <div class="partSearch">
   <form id="imageForm" name="imageForm" method="get">
   <label for="image"><b>Image: </b></label>
   <input id="searchImage" name="searchImage" type="text" value="" />
   <input type="submit" value="Search" />
   </form>

<!-- Dialog Content -->
   <div id="imageDialog" title="Image">
     <?php
     <Code to get the Image name from input>;
     //DB query
     $query="select image, ssid, to_char(savetime,'DD-MM-YYYY HH24:MI') savetime, path
             from table
             where image like upper('%$IMAGE%')
             order by image asc, savetime desc";    
     ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:46:32.150

在您的“search.php”中，您执行一个方法，在该方法中，您必须搜索数据库并将结果作为 JSON 数组发送给 ajax 调用。

```
function searchInDB($param) {

    // php code

    return json_encode($sql_result_from_search);
}

<?php
    echo json_encode(array("test","test","test"));
    echo json_encode(array(0=>"test",3=>"test",7=>"test"));
?>

Will give :

["test","test","test"]
{"0":"test","3":"test","7":"test"} 
```

您必须阅读有关 AJAX 的更多信息。看看[这里](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:21:11.977

尝试查看[jQuery UI autoComplete](http://jqueryui.com/autocomplete/)，而不是直接使用 php，而是使用 AJAX 调用来填充自动完成插件中使用的数组

```
 <script>
$(function() {

   $( "#tags" ).autocomplete({
      source:  myarray ;  // here put your values from ajax call 
   });
});
</script> 
```

因此，您将使用 jQuery 从输入中获取值。

# python - 烧瓶错误：typeerror run() 得到了一个意外的关键字参数“主机”

> ID：16195601
> 
> 赞同：8
> 
> 时间：2013-04-24T15:09:21.100
> 
> 标签：python, frameworks, flask

我用 Flask 在 vi​​rtualbox 上建立了一个网站。该网站可以在本地主机上打开，但我无法通过端口转发打开它，所以我将代码从 更改`manage.run()`为`manage.run(host='0.0.0.0')`.

问题是我收到此错误：

```
typeerror run() got an unexpected keyword argument 'host'. 
```

`manage.run()`更改为时会发生类似的错误`manage.run(debug=True)`。我只是遵循了 Flask 文档。[http://flask.pocoo.org/docs/quickstart/#a-minimal-application](http://flask.pocoo.org/docs/quickstart/#a-minimal-application)谁能告诉我为什么我会收到这个错误？

```
#!/usr/bin/env python
#-*- coding:utf-8 -*-

"""Manage Script."""

from sys import stderr, exit

from flask.ext.script import Manager, prompt_bool

from szupa import create_app
from szupa.extensions import db
from szupa.account.models import User
from szupa.context import create_category_db

app = create_app()
manager = Manager(app)

@manager.command
def initdb():
    """Initialize database."""
    db.create_all()
    create_category_db()

@manager.command
def migrate(created, action="up"):
    module_name = "migrates.migrate%s" % created
    try:
        module = __import__(module_name, fromlist=["migrates"])
    except ImportError:
        print >> stderr, "The migrate script '%s' is not found." % module_name
        exit(-1)
    if prompt_bool("Confirm to execute migrate script '%s'" % module_name):
        try:
            action = getattr(module, action)
        except AttributeError:
            print >> stderr, "The given action '%s' is invalid." % action
            exit(-1)
        action(db)
        print >> stderr, "Finished."

@manager.command
def dropdb():
    """Drop database."""
    if prompt_bool("Confirm to drop all table from database"):
        db.drop_all()

@manager.command
def setadmin(email):
    """Promote a user to administrator."""
    user = User.query.filter_by(email=email).first()
    if not user:
        print >> stderr, "The user with email '%s' could not be found." % email
        exit(-1)
    else:
        user.is_admin = True
        db.session.commit()

if __name__ == "__main__":
    manager.run() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-12-18T12:25:50.187

正如@fangwz0577 在评论中所说，他们使用`manager.add_command`. 他们的链接的存档版本在[这里](https://web.archive.org/web/20130218044123/http://docs.mongodb.org/manual/tutorial/write-a-tumblelog-application-with-flask-mongoengine/)。

> 接下来，创建 manage.py 文件。将来使用此文件加载其他 Flask 脚本。Flask-scripts 提供了一个开发服务器和外壳：
> 
> ```
> from flask.ext.script 导入管理器，服务器
> 从 tumblelog 导入应用程序
> 
> 经理=经理（应用程序）
> 
>  # 默认开启调试器并重新加载
> manager.add_command（“运行服务器”，服务器（
>     use_debugger = 真，
>     use_reloader = 真，
>     主机 = '0.0.0.0') )
> 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2022-02-22T18:30:28.787

@SuperBiasedMan 的答案是为我工作的人，除了导入`from flask.ext.script import Manager, Server`不起作用，因为它已被弃用（作为烧瓶 github 上的一个问题显示：[https ://github.com/pallets/flask/issues/1135#问题评论-61860862](https://github.com/pallets/flask/issues/1135#issuecomment-61860862)）

因此，如果您仍在苦苦挣扎，请尝试`from flask_script import Manager, Server`改用。

此外，在 Linux 上，不需要创建“基本”应用程序，只需创建`__init__.py`文件并制作`manage.py`文件即可。

# c# - 从变量中添加文本的多行字符串

> ID：16195603
> 
> 赞同：37
> 
> 时间：2013-04-24T15:09:25.733
> 
> 标签：c#

我知道这会起作用：

```
string multiline_text = @"this is a multiline text
this is line 1
this is line 2
this is line 3"; 
```

我怎样才能使以下工作：

```
string a1 = " line number one";
string a2 = " line number two";
string a3 = " line number three";

string multiline_text = @"this is a multiline text
this is " + a1 + " 
this is " + a2 + " 
this is " + a3 + "; 
```

是否可以不将字符串拆分为多个子字符串，每行一个？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2013-04-24T15:10:36.850

One option is to use string formatting instead. Before C# 6:

```
string pattern = @"this is a multiline text
this is {0}
this is {1}
this is {2}";

string result = string.Format(pattern, a1, a2, a3); 
```

With C# 6, you can use an interpolated verbatim string literal:

```
string pattern = $@"this is a multiline text
this is {a1}
this is {a2}
this is {a3}"; 
```

Note that `$@` has to be exactly that - if you try to use `@$`, it won't compile.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-24T15:12:12.960

虽然`string.Format`是更好的做法，但要完成您想要实现的目标，只需`@`在每行末尾添加额外的 s ：

```
string multiline_text = @"this is a multiline text
this is " + a1 + @" 
this is " + a2 + @" 
this is " + a3 + @""; 
```

您还缺少`"`结束分号之前的最后一个。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-24T15:11:11.853

您可以从`StringBuilder`课程中获得这样的可读性：

```
StringBuilder sb = new StringBuilder();
sb.AppendLine("this is a multiline");
sb.AppendLine("this is " + a1); // etc

var result = sb.ToString(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-12-09T23:43:19.670

使用 Visual Studio 2015，您可以编写：

```
string multiline_text = $@"this is a multiline text
this is {a1}
this is {a2}
this is {a3}"; 
```

String.Format 将被编译器使用（如 Jons 的回答），但它更容易阅读。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-24T15:11:48.953

由于某种原因，c# 不支持这样的多行文本。你会得到最接近的是：

```
string a1 = " line number one";
string a2 = " line number two";
string a3 = " line number three";

string multiline_text = @"this is a multiline text" +
"this is " + a1 +
"this is " + a2 +
"this is " + a3; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T15:12:43.403

按照 Jon Skeet 的回答，另一个可能的解决方案是：

```
string result = string.Format(
    "this is a multiline text{0}this is {1}{0}this is {2}{0}this is {3}",
    Environment.NewLine, a1, a2, a3); 
```

所以基本上你是在你想要的地方插入一个新行`{0}`。因此，它使字符串更加抽象，但这种解决方案的好处是它完全封装在`string.Format`方法中。这可能不是那么相关——但值得一提。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-27T22:41:45.310

为了好玩，您还可以使用数组连接技术来获得可读性和控制缩进。有时，强制您完全左对齐的多行模板是难看的......

```
string a1 = "London", a2 = "France", a3 = "someone's underpants";

string result = string.Join(Environment.NewLine, new[] {
    $"this is {a1}", // interpolated strings look nice
    "this is " + a2, // you can concat if you can't interpolate
    $"this is {a3}"  // these in-line comments can be nice too
}); 
```

如果您必须格式化，请包装连接以获得整洁的结果，而不是单独的行。

# asynchronous - 在 LibGDX 中对 `Gdx.net.sendHttpRequest` 的同步响应

> ID：16195608
> 
> 赞同：6
> 
> 时间：2013-04-24T15:09:37.720
> 
> 标签：asynchronous, libgdx

我正在用 LibGDX 制作一个小游戏。我将玩家的用户名保存在本地以及服务器上。问题是应用程序没有等待调用结果，因此在线数据库的 ID 没有保存在本地。这是代码的整体流程：

```
//Create a new user object
User user = new User(name);

//Store the user in the online database
NetworkService networkService = new NetworkService();
String id = networkService.saveUser(user);

//Set the newly generated dbase ID on the local object
user.setId(id);

//Store the user locally
game.getUserService().persist(user); 
```

在这段代码中，`id`变量没有被设置，因为`saveUser`函数立即返回。如何让应用程序等待网络请求的结果，以便我可以处理服务器通信的结果？

这是代码`saveUser`：

```
public String saveUser(User user) {
    Map<String, String> parameters = new HashMap<String, String>();
    parameters.put("action", "save_user");
    parameters.put("json", user.toJSON());

    HttpRequest httpGet = new HttpRequest(HttpMethods.POST);
    httpGet.setUrl("http://localhost:8080/provisioner");
    httpGet.setContent(HttpParametersUtils.convertHttpParameters(parameters));

    WerewolfsResponseListener responseListener = new WerewolfsResponseListener();
    Gdx.net.sendHttpRequest (httpGet, responseListener);
    return responseListener.getLastResponse();
} 
```

这是`WerewolfsResponseListener`课程：

```
class WerewolfsResponseListener implements HttpResponseListener {
    private String lastResponse = "";
    public void handleHttpResponse(HttpResponse httpResponse) {
        System.out.println(httpResponse.getResultAsString());
        this.lastResponse = httpResponse.getResultAsString();    
    }

    public void failed(Throwable t) {
       System.out.println("Saving user failed: "+t.getMessage());
       this.lastResponse = null;
    }

    public String getLastResponse() {
        return lastResponse;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T23:46:25.033

您看到的异步来自`Gdx.net.sendHttpRequest`. `WerewolfsResponseListener`每当请求返回时，都会调用第二个参数 (your ) 上的方法。成功/失败方法*不会*被“内联”调用。

有两种基本方法可以处理这样的回调结构：“轮询”或“事件”。

通过轮询，您的主游戏循环可以“检查”`responseListener`它是否成功或失败。（您需要稍微修改您当前的侦听器以消除成功案例和空字符串的歧义。）一旦您看到有效的响应，您就可以这样做`user.setId()`。

使用“事件”，您可以将`user.setId()`调用放在`responseListener`回调中，这样只要网络响应，它就会执行。这更适合 Libgdx 网络 API。（这确实意味着您的响应侦听器将需要对该`user`对象的引用。）

无法在线“等待”网络调用返回。Libgdx 网络 API（正确）假设您不想在渲染线程中无限期地阻塞，因此它不是为此而结构化的（侦听器将作为 Runnable 排队，因此它最早可以运行在下一次渲染调用时） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-23T08:24:00.597

我不会向任何人推荐这个，但如果你需要以一种快速而肮脏的方式测试某些东西并且绝对*必须*阻止，这将起作用。没有超时，所以再次为绝对的污秽做好准备：

```
long wait = 10;
while(!listener.isDone())
{
    Gdx.app.log("Net", "Waiting for response");
    try
    {
        Thread.sleep(wait *= 2);
    }
    catch (InterruptedException e)
    {
        e.printStackTrace();
    }
}

public static class BlockingResponseListener implements HttpResponseListener
{
    private String data;
    private boolean done = false;
    private boolean succeeded = false;

    @Override
    public void handleHttpResponse(HttpResponse httpResponse)
    {
        Gdx.app.log("Net", "response code was "+httpResponse.getStatus().getStatusCode());
        data = httpResponse.getResultAsString();
        succeeded = true;
        done = true;
    }

    @Override
    public void failed(Throwable t)
    {
        done = true;
        succeeded = false;
        Gdx.app.log("Net", "Failed due to exception ["+t.getMessage()+"]");
    }

    public boolean succeeded()
    {
        return succeeded;
    }

    public boolean isDone()
    {
        return done;
    }

    public String getData()
    {
        return data;
    }

} 
```

# php - 请求被发送直到超时

> ID：16195609
> 
> 赞同：0
> 
> 时间：2013-04-24T15:09:38.783
> 
> 标签：php, arrays, file, function, request

我正在开发一个 facebook 应用程序，我正在尝试发送一些请求，但其中一个似乎特别会产生问题：在 FireBug 的 NET 面板下，我可以看到请求被一次又一次地发送，直到超时。我想做的是：当用户单击一个按钮时，`function`应该调用 PHP 文件中的一个。
**save.php**（从那里发出调用函数的请求）

```
<a id="done" href="savefunctions.php?runFunction=writeJSON">Done!</a> 
```

请求已正确发送，`http://localhost:8080/savefunctions.php?runFunction=writeJSON` 但似乎从未完成。

**savefunctions.php** (`$arrayForJSON 是一些保存数据的数组，应该写入 JSON 文件。

```
function writeJSON()
{
$myfile="testson.json";
$fileout=fopen($myfile,'w') or die("Fatal: Can't open JSON file for writing");
global $arrayForJSON;
if(isset($arrayForJSON))
{fwrite($fileout,json_encode($arrayForJSON));
echo "done";
fclose($fileout);}
else echo "Error: could not write to JSON file";

}

//Global:

if(!empty($_GET["runFunction"])){
        if($_GET["runFunction"] == "writeJSON"){
            writeJSON();
        }
    } 
```

请求的状态是“302 Found”

* * *

编辑：看起来数组是空的，并且请求（我仍然不明白为什么）一遍又一遍地发送，直到超时。现在有时（看起来它是随机执行的）函数运行，但没有完成它的工作，其他时候它进入无限循环。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:12:54.230

在您的 PHP 代码中，您有一个条件`runFunction`to be `writeJSON`。你正在路过`getAll`。 `writeJSON()`永远不会被调用。

尝试

```
<a id="done" href="savefunctions.php?runFunction=writeJSON">Done!</a> 
```

# css - 在 Polymaps 中处理类属性分配

> ID：16195611
> 
> 赞同：0
> 
> 时间：2013-04-24T15:09:41.613
> 
> 标签：css, d3.js, javascript-objects, geojson

我是一名社会科学人士，越来越多地从事数据可视化的网络编程，如果这个问题很愚蠢，我深表歉意。我正在研究一个 polymaps 实现，以随着时间的推移可视化国家级数据。我读入 json 时态数据和 geojson 世界地图，并吐出一个分位数的叶绿素地图，该地图在每月的条目上进行迭代。其核心是一个国家格式化函数，它将一个 colorbrewer 类绑定到国家 geojson 对象（见下文）。这适用于动画部分。问题是我正在使用自定义 d3 图层，该图层显示当前显示的数据的日期*和*充当鼠标悬停控件以停止动画并选择日期或在动画结束后选择日期。它通过创建一个空白 svg 元素来实现这一点，该元素使用 d3.scale() 函数将鼠标输入四舍五入为与所需月份索引匹配的整数。我已经在加载时预先加载了所有其他计算，因此鼠标悬停时唯一发生的事情是 svg 类的更改（这与 Tom Carden 在 Bostock 的 d3 页面上的丰富国家实现基本相同[）](http://bost.ocks.org/mike/nations/)。不幸的是，这仍然会很快使浏览器过载。还有另一种我完全想念的方法吗？我承认我是geojson的新手，所以也许有办法在geojson对象的类属性中构造一个类数组？非常感谢您的帮助。

```
 function foo(local, geojson){
                for(var x=0;x<geojson.length;x++){
                    var n = geojson[x].data.properties.name;
                    n$(geojson[x].element)
                        .attr("class", geojson[x].data.formats[local])
                        .add("svg:title");
                }
            } 
```

编辑：我在下面添加完整的脚本。

```
<meta charset="utf-8">
<script src="scripts/d3.v3.js"></script>
<script src="scripts/polymaps.js"></script>
<script src="scripts/nns.js"></script>

<script>
    //Polymaps namespace
    var po = org.polymaps;

    //Chart dimensions
    var margin = {top: 20, right: 20, bottom: 20, left: 20};
    var w = 960 - margin.right;
    var h = 500 - margin.top - margin.bottom;

    // Create the map object, add it to #map div
    var map = po.map()
        .container(d3.select("#map").append("svg:svg").attr("width", w + margin.left + margin.right).attr("height",h +margin.top + margin.bottom).node())
        .center({lat: 28, lon: 0})
        .zoom(1.85)
        .zoomRange([1.5, 4.5])
        .add(po.interact());

    // Add the CloudMade image tiles as a base layer…
    map.add(po.image()
        .url(po.url("http://{S}tile.cloudmade.com"
        + "/1a1b06b230af4efdbb989ea99e9841af" // http://cloudmade.com/register
        + "/20760/256/{Z}/{X}/{Y}.png")
        .hosts(["a.", "b.", "c.", ""])));

    //Import contribution data
    d3.json("assets/contributionsTCC1990-1991.json", function(data){
        //find length of json data object and loop over it at interval
        var dataLength = Object.keys(data).length;

        //Create date  key/value array using construtor
        function date_array_constructor() {
            var dateArray = {};
                for(var i = 0; i < dataLength; i++) {
                    var d = i + 1;
                    dateArray[d] =  data[i].date;
                }
            return dateArray;
        }
        var dateArray = date_array_constructor();

        // Insert  date label/control layer and add SVG elements that take on attributes determined by load function
        var labelLayer = d3.select("#map svg").insert("svg:g");
        map.add(po.geoJson()
            .url("assets/world.json")
            .tile(false)
            .zoom(3)
            .on("load", load));
        map.container().setAttribute("class", "Blues");
        map.add(po.compass()
            .pan("none"));

        function find_max(data, dataLength) {
            var max = 0;
            for(var i in data) {
                if(data[i] > max) {
                    max = data[i] + 1;
                }
            }
            return max;
        }

        function max_array_constructor(data, dataLength) {
            var maxArray = {};
            for(var i=0;i<dataLength;i++) {
                var d = i+1;
                maxArray[d] = find_max(data[i].contributions);
            }
            return maxArray;
        }
        var maxArray = max_array_constructor(data, dataLength);

        function contribution_array_constructor(data, dataLength, tccName, feature) {
            var contributions = {};
            //iterate over date entries
            for(var i=0;i<dataLength;i++) {
                //contribution iterator
                contributions[i+1] = 0;
                for(x in data[i].contributions){
                    if(x == tccName) {
                        contributions[i+1] = data[i].contributions[x];
                    }
                }
            }
            return contributions;
        }

        function format_array_constructor(data, dataLength, maxArray, feature) {
            var formats = {};
            // console.log(feature.data.contributions);
            //iterate over date entries
            for(var i=0;i<dataLength;i++) {
                var percentile = feature.data.contributions[i+1] / maxArray[i+1];
                if(percentile != 0){
                    var v = "q" + ((~~(percentile*7)) + 2) + "-" + 9;
                }else{
                    var v = "countries";
                }
                formats[i+1] = v;
            }
            return formats;
        }

        ///////////////////////////////
        //load function
        ///////////////////////////////
        function load(e) {
            //Bind geojson and json
            var geojson = e.features;
            console.log(geojson);
            geojson.dates = dateArray;
            for(var x = 0; x < geojson.length; x++) {
                // var tccID = geojson[x].data.id;
                var tccName = geojson[x].data.properties.name;
                geojson[x].data.contributions = contribution_array_constructor(data, dataLength, tccName, geojson[x]);
                geojson[x].data.formats = format_array_constructor(data, dataLength, maxArray, geojson[x]);
            }

            //Insert date label
            var dateLabel = labelLayer.append("text")
                .attr("class", "date label")
                .attr("text-anchor", "end")
                .attr("x", w-670)
                .attr("y", h )
                .text(dateArray[1]);

            //Add interactive overlay for date label
            var box = dateLabel.node().getBBox();

            var overlay = labelLayer.append("rect")
                .attr("class", "overlay")
                .attr("x", box.x)
                .attr("y", box.y)
                .attr("opacity",0)
                .attr("width", box.width)
                .attr("height", box.height)
                .on("mouseover",enable_interaction);

            function country_class_constructor(local, geojson){
                for(var x=0;x<geojson.length;x++){
                    var n = geojson[x].data.properties.name;
                    n$(geojson[x].element)
                        .attr("class", geojson[x].data.formats[local])
                        .add("svg:title");
                }
            }

            function foo(local, geojson){
                for(var x=0;x<geojson.length;x++){
                    var n = geojson[x].data.properties.name;
                    n$(geojson[x].element)
                        .attr("class", geojson[x].data.formats[local])
                        .add("svg:title");
                }
            }

            //incrementor function
            function incrementor(local, geojson, dateArray) {
                setTimeout(function() {
                    //set date label to current iteration
                    d3.transition(dateLabel).text(dateArray[local]);
                    //construct country classes
                    country_class_constructor(local, geojson);
                    // console.log(geojson);
                }, 500*local);
            }

            ///////////////////////////////
            //Increment on load
            ///////////////////////////////
            country_class_constructor(1, geojson)
            for(var i=1; i< dataLength; i++) {
                //Set incrementer as local variable
                var local = i+1;
                var timer = incrementor(local, geojson, dateArray);
            }

            ///////////////////////////////
            //interaction element
            ///////////////////////////////
            function enable_interaction(){
                var dateScale = d3.scale.linear()
                    .domain([1,Object.keys(dateArray).length])
                    .range([box.x + 10, box.x + box.width - 10])
                    .clamp(true);

            timer = null;

                overlay
                    .on("mouseover", mouse_over)
                    .on("mouseout",mouse_out)
                    .on("mousemove",mouse_move)
                    .on("touchmove",mouse_move);

                function mouse_over() {
                    dateLabel.classed("active", true);
                }

                function mouse_out() {
                    dateLabel.classed("active", false);
                }

                function mouse_move() {
                    update_map(dateScale.invert(d3.mouse(this)[0]),data);
                    // displayYear(dateScale.invert(d3.mouse(this)[0]));
                }

                function update_map(userInput) {
                    var date = Math.floor(userInput);
                    d3.transition(dateLabel).text(dateArray[date]);
                    // console.log(date);
                    // country_class_constructor(date, geojson);
                    foo(date, geojson);
                }
            }
        }
    });
</script> 
```

编辑 2：我忘了添加 JSON 格式。两个月的数据见下图：

```
[
{"date":"11/90",
 "contributions":{
    "Algeria":7,
    "Argentina":39,
    "Australia":41,
    "Austria":967,
    "Bangladesh":5,
    "Belgium":4,
    "Brazil":27,
    "Canada":1002,
    "Chile":7,
    "China":5,
    "Colombia":12,
    "Czech Republic":6,
    "Denmark":374,
    "Ecuador":21,
    "Fiji":719,
    "Finland":992,
    "France":525,
    "Germany":13,
    "Ghana":892,
    "Hungary":15,
    "India":40,
    "Indonesia":5,
    "Ireland":814,
    "Italy":79,
    "Jordan":6,
    "Kenya":7,
    "Malaysia":15,
    "Nepal":851,
    "Netherlands":15,
    "New Zealand":22,
    "Nigeria":2,
    "Norway":924,
    "Poland":165,
    "Republic of the Congo":6,
    "Russia":35,
    "Senegal":4,
    "Serbia":17,
    "Spain":63,
    "Sweden":738,
    "Switzerland":5,
    "Turkey":2,
    "United Kingdom":769,
    "United States":33,
    "Uruguay":10,
    "Venezuela":23,
    "Zambia":6
 }
},
{"date":"12/90",
 "contributions":{
    "Algeria":7,
    "Argentina":39,
    "Australia":41,
    "Austria":967,
    "Bangladesh":5,
    "Belgium":4,
    "Brazil":27,
    "Canada":1002,
    "Chile":7,
    "China":5,
    "Colombia":12,
    "Czech Republic":6,
    "Denmark":374,
    "Ecuador":21,
    "Fiji":719,
    "Finland":992,
    "France":525,
    "Germany":13,
    "Ghana":892,
    "Hungary":15,
    "India":40,
    "Indonesia":5,
    "Ireland":814,
    "Italy":79,
    "Jordan":6,
    "Kenya":7,
    "Malaysia":15,
    "Nepal":851,
    "Netherlands":15,
    "New Zealand":22,
    "Nigeria":2,
    "Norway":924,
    "Poland":165,
    "Republic of the Congo":6,
    "Russia":35,
    "Senegal":4,
    "Serbia":17,
    "Spain":63,
    "Sweden":738,
    "Switzerland":5,
    "Turkey":2,
    "United Kingdom":769,
    "United States":33,
    "Uruguay":10,
    "Venezuela":23,
    "Zambia":6
 }
} 
```

]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T20:44:43.533

经过数小时的调试，结果是 nns.js 库给我带来了问题。动画的每次迭代都在创建一组新的 DOM 对象，这些对象开始在 25,000 处最大化浏览器。解决方案是使用 nss 创建初始状态，然后使用以下函数更改每个 svg 元素的类。

```
function country_class_constructor(local, geojson){
                for(var x=0;x<geojson.length;x++){
                    var n = geojson[x].data.properties.name;
                    element = document.getElementById(n);
                    element.className["animVal"] = geojson[x].data.formats[local];
                    element.className["baseVal"] = geojson[x].data.formats[local];
} 
```

# jquery - Knockoutjs：在文档准备就绪时使用 jQuery 填充模型中的数组属性

> ID：16195615
> 
> 赞同：1
> 
> 时间：2013-04-24T15:09:54.897
> 
> 标签：jquery, knockout.js

我在 jsFiddel 上有以下代码，这是我在项目中使用的代码的简化版本。

[http://jsfiddle.net/wUp24/2/](http://jsfiddle.net/wUp24/2/)

我正在尝试从服务器预加载我的类别，如下所示：

```
$(document).ready(function(){
  var mv = new configuratorPublicModelView();
  ko.applyBindings(mv);
  mv.loadFunctions("", 1);
}); 
```

当我遍历类别时，您可以看到它们已加载，但淘汰赛没有做任何事情。

怎么了？

**编辑** 我认为这与我应用绑定的方式有关。当我执行以下操作时：

```
 ko.applyBindings(new configuratorPublicModelView()); 
```

我可以显示一个可观察的测试，否则它不会显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:45:19.703

您需要像这样将新项目添加到可观察数组中：

```
self.configuratorPublic().searchCategories.push("cat1"); 
```

代替：

```
self.configuratorPublic().searchCategories().push("cat1"); 
```

见这里的例子：http: [//jsfiddle.net/badsyntax/wUp24/3/](http://jsfiddle.net/badsyntax/wUp24/3/)

# replace - 排除注释的正则表达式

> ID：16195622
> 
> 赞同：1
> 
> 时间：2013-04-24T15:10:11.907
> 
> 标签：replace, unix

我正在尝试使用 grep -v -e '' 从文件中排除注释（以 # 作为第一个非空白字符的行）。# 可以出现在行首，也可以在遇到第一个 # 之前以任意组合的形式出现多个空格和制表符的组合。

假设文件 np4 包含以下内容：

```
# hash at the begining of the line
## two hashes at the begining of the line
#### four hashes at the begining of the line
  # two white spaces then a hash
a good line
    another good line starting with a few spaces
                         a good line starting with a combination of spaces and tabs
                # two white spaces, two tabes and then a hash
                  ## two tabs, two white spaces and then two hashes
            # tab, ws, tab, ws, tab then hash 
```

我尝试使用下面的命令，但它并没有像我想象的那样工作。我应该只得到三行作为输出。

grep -v -e '^\s*#.*$' np4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T02:28:33.837

不确定 \s 是否适用于 grep。你可以试试 "^[ ] *#.* " 吗？在 [] 中有一个空格和一个制表符，两个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-09T14:08:09.523

我相信您缺少的是与一个或多个英镑符号匹配的加号。我在测试时没有 grep，但这看起来不错。我已经为我的测试提供了一个永久链接。

^\s*#+.*$

[这是 regexpal.com 上测试的永久链接。](http://regexpal.com/?flags=gm&regex=%5E%5Cs%2a%23%2B.%2a%24&input=%23%20hash%20at%20the%20begining%20of%20the%20line%0A%23%23%20two%20hashes%20at%20the%20begining%20of%20the%20line%0A%23%23%23%23%20four%20hashes%20at%20the%20begining%20of%20the%20line%0A%20%20%23%20two%20white%20spaces%20then%20a%20hash%0Aa%20good%20line%0A%20%20%20%20another%20good%20line%20starting%20with%20a%20few%20spaces%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20a%20good%20line%20starting%20with%20a%20combination%20of%20spaces%20and%20tabs%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20two%20white%20spaces%2C%20two%20tabes%20and%20then%20a%20hash%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%20two%20tabs%2C%20two%20white%20spaces%20and%20then%20two%20hashes%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20tab%2C%20ws%2C%20tab%2C%20ws%2C%20tab%20then%20hash)

# python - 后重定向获取后未显示 Django 1.5 会话变量

> ID：16195624
> 
> 赞同：1
> 
> 时间：2013-04-24T15:10:18.490
> 
> 标签：python, django, session

使用 Django 1.5.1，我启用了会话`INSTALLED_APPS`以及`MIDDLEWARE_CLASSES`

我有一个`django.views.generic.edit.CreateView`负责在注册时创建新用户。那部分工作得很好。它还会向新用户发送一封电子邮件以激活他们的帐户。这也很好用。

提交表单并确定表单有效后，将用户重定向到成功 url。在该成功 url 页面上，我想通知他们一封电子邮件已发送到他们的电子邮件地址，例如“一封电子邮件已发送到 foo@bar.com”

`self.request.session['email'] = user.email`在重定向生成之前，我一直在表单视图中使用。在本地（使用 sqlite DB 后端），这非常有效。当重定向加载时，我看到“一封电子邮件已发送到 foo@bar.com”。

但是，当我将它部署到我的登台服务器时，我看到“一封电子邮件已发送到 ”。如果我手动刷新该页面，则它会正确显示电子邮件。我的登台服务器上的数据库后端是 MySQL。

```
def form_valid(self, form):
    user = form.save()
    self.request.session['email'] = user.email
    self.send_notification(user)
    return super(AccountCreateFormView, self).form_valid(form) 
```

编辑：

在模板中，我有以下内容：

```
An email has been sent to {{ request.session.email }}. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T04:38:36.567

在这个问题上花了一天时间后，我发现了解决方案：

我从 uWSGI **1.0.2.1**升级到**1.9.8**。

我证实回到 1.0.2.1 会导致问题重新出现。我没有解释为什么会这样，但是无论如何，使用最新的 uWSGI 可能不是一个坏主意。

* * *

进一步调查显示，我遇到的问题发生在其他领域。例如：

在管理区域，我会将用户从活动更改为非活动，然后保存表单，将我重定向回用户列表。单击我刚刚停用的同一用户后，该复选框将显示为选中状态。刷新页面将显示不再选中“活动”。

这是您可能没想到的部分：**页面的第二次刷新会导致 Active 显示为选中状态！**

我在自己的表单中也看到了同样的行为。所以我创建了一个简单的模板，它只包含`request.user.first_name`和`{% now "U u" %}`. 时间戳的目的是确定渲染的模板是否被缓存。

在一个选项卡中，我更新了用户的名字。在另一个选项卡中，我快速刷新了新模板。这导致它在**新**值和**旧**值之间**交替**。时间戳正确递增，没有缓存。

 ****我想也许是我的浏览器（firefox）。我在隐身模式下打开了 chrome。在 chrome 中，我打开了新模板。在 Firefox 中，我提交了更改用户名的表单。回到chrome，我开始快速刷新。完全相同的行为。

跳入 dbshel​​l 并直接点击 mysql db 总是给我正确的值，没有交替。

为了排除某些事情，我尝试了以下方法：

*   将默认`CACHES`后端设置为 DummyCache（不起作用）
*   设置`CACHE_MIDDLEWARE_ANONYMOUS_ONLY`为真
*   安装`django-debug-toolbar`了直接看SQL。快速刷新工具栏的 sql 也会导致它交替值！

我升级到 django 1.5.1 后才开始观察到这个问题。以前我在 django 1.4.2 上。

总之，我建议将其称为**django/uwsgi 不确定性原理**。****

# php - php查找数组并转换为变量

> ID：16195625
> 
> 赞同：0
> 
> 时间：2013-04-24T15:10:20.110
> 
> 标签：php, arrays, facebook, sorting

我有一个连接到 facebook sdk 的功能。

此函数返回下面发布的数组。

我想在该数组和子数组中找到一个特定的变量并将其存储到 MySQL。

我需要搜索这个索引：`[name] => Riad Flam and all sub ( ex toke,id,...)`并将其存储到 MySQL 中。

这是返回的数组：

```
Array
(
    [data] => Array
        (
            [0] => Array
                (
                    [category] => Local business
                    [category_list] => Array
                        (
                            [0] => Array
                                (
                                    [id] => 164243073639257
                                    [name] => Hotel
                                )
                        )
                    [name] => Riad Flam
                    [access_token] => BAAGeBYlwA38BALZAddqsUR2na13zh40E1F7YQMKGiga6fVIzkqBt3RW5r5vTIl3Qnb8lLhZBMk8yNAcRZCp8FDpgGr4ZCagHU1yqJ1w2oUklgAwlZAgJotHYZCJQcw2g1H5uZCdtdhcLwGwLZA2FfEFRGBUgUKvs2a1LJIDFab3vXoS1srbqnZA1cztIH5iyqZB7dEGEXxNEPzMdcvGZCZAw8nuWZCECwkE2WAy0ZD
                    [id] => 124602074303943
                    [perms] => Array
                        (
                            [0] => ADMINISTER
                            [1] => EDIT_PROFILE
                            [2] => CREATE_CONTENT
                            [3] => MODERATE_CONTENT
                            [4] => CREATE_ADS
                            [5] => BASIC_ADMIN
                        )
                )
            [1] => Array
                (
                    [category] => Energy/utility
                    [name] => Ewaa
                    [access_token] => BAAGeBYlwA38BAFWlnftqfUpM0nT3i9OG6BxDHhcoVQEZAsPciUce4zZA2ywWX6LrzlLMXZA24wBRHmG60wZCYSEG0J9kdPTAUnQD9kLMgdDYup1ZBJcji4mzCS2ltJmpGbBCsglcZBwjix8Vl5bhUrOu3o1hZBA6SBsOE9ZC1SZAeJZANdvA0OV2myj4yYEcVvZBinyyzGUhRH3TtYWEb4zfmFfaZAyau9Np2agZD
                    [id] => 239767479474629
                    [perms] => Array
                        (
                            [0] => ADMINISTER
                            [1] => EDIT_PROFILE
                            [2] => CREATE_CONTENT
                            [3] => MODERATE_CONTENT
                            [4] => CREATE_ADS
                            [5] => BASIC_ADMIN
                        )
                ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:22:20.907

我想你需要这样的东西：

```
foreach($return['data'] as $item) {
    /* PSEUDO CODE: */
    $db->insert($item['name']); // just write the insert into function here using $item['name'] as the value to insert
} 
```

**编辑：**

```
foreach($return['data'] as $item) {
    /* PSEUDO CODE: */
    if($item['name'] == 'insert only this item') {
        $db->insert($item);
    }
} 
```

# python - Django：django-registration 反向查找失败

> ID：16195628
> 
> 赞同：1
> 
> 时间：2013-04-24T15:10:28.867
> 
> 标签：python, django, django-registration

我正在使用 django-registration 并在我的 settings.py 中将登录和注销 url 设置为

```
LOGIN_URL = '/users/login/'
LOGOUT_URL = '/users/logout/' 
```

在我设置的 urls.py 中

```
url(r'^users/', include('registration.backends.default.urls', namespace='users')), 
```

一切正常，除非我尝试访问 localhost:8000/users/passwords/reset 出现错误

```
NoReverseMatch at /users/password/reset/
Reverse for 'django.contrib.auth.views.password_reset_done' with arguments '()' and keyword arguments '{}' not found. 
```

但是，当我将此行添加到 urls.py 文件时，一切正常

```
(r'^users/', include('registration.auth_urls')), 
```

这个解决方案让我感到困惑，因为registration.backends.default.urls 包含该行

```
(r'', include('registration.auth_urls')), 
```

这应该与添加到我的项目的 urls.py 文件中的行相同。为什么将行添加到项目的 urls.py 文件中可以修复错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:18:21.783

您正在为您的包含提供一个`namespace`参数。这导致，除其他外，您在使用`reverse()`函数或`{% url %}`模板时也必须提供命名空间。

有关详细信息，请参阅[https://docs.djangoproject.com/en/dev/topics/http/urls/#url-namespaces](https://docs.djangoproject.com/en/dev/topics/http/urls/#url-namespaces)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:13:38.503

因为第一个包含`users/`在 url 正则表达式中，这是您想要达到的。

# android - 谷歌在 minSDK 低于 11 的 Android 设备上映射 v2

> ID：16195631
> 
> 赞同：1
> 
> 时间：2013-04-24T15:10:32.007
> 
> 标签：android, sdk, maps, android-maps-v2

当我创建使用 Google 地图 API v2 的项目时，我遇到了这条线的问题。

GoogleMap 地图 = ((MapFragment) getFragmentManager().findFragmentById(R.id.map)) .getMap();

据说我需要将 minSDK 设置为最小 11，但我也想在具有 android minSDK 8 (2.3.3) 的设备上使用此应用程序。有任何想法吗？或者简单地说：我如何将谷歌地图 API v2 设置为与具有 minSDK 8 的设备兼容。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T15:11:45.760

使用`SupportMapFragment`from a `FragmentActivity`，而不是`MapFragment`from an `Activity`。要在 API 级别 11 之前的设备上使用 Fragment，您需要使用 Android Support 包的 Fragment 的反向端口（`FragmentActivity`来自哪里）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-25T15:36:18.903

```
 Fragment fragment = getSupportFragmentManager().findFragmentById(
            R.id.map);
    SupportMapFragment mapFragment = (SupportMapFragment) fragment;
    GoogleMap mMap = mapFragment.getMap(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T15:34:32.147

[http://android-er.blogspot.de/2012/12/using-supportmapfragment.html](http://android-er.blogspot.de/2012/12/using-supportmapfragment.html) - 小例子

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world" />
    <fragment
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment"/>

</RelativeLayout> 
```

和：

```
package de.meinprospekt.android.ui;

import java.text.SimpleDateFormat;

public class MainActivity extends FragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

} 
```

# vb.net - UltraWinGrid enter edit mode issue

> ID：16195640
> 
> 赞同：1
> 
> 时间：2013-04-24T15:10:55.837
> 
> 标签：vb.net, focus, row, ultrawingrid

I have an UltraWinGrid and I want to give the focus to a specific cell and make it enter edit mode programmatically (*no click*). So I did this :

```
If myUltraWinGrid.ActiveRow IsNot Nothing Then
myUltraWinGrid.ActiveCell = myUltraWinGrid.ActiveRow.Cells("foo")
myUltraWinGrid.PerformAction(Infragistics.Win.UltraWinGrid.UltraGridAction.EnterEditMode)
Else
myUltraWinGrid.ActiveCell = myUltraWinGrid.Rows(0).Cells("foo")
myUltraWinGrid.PerformAction(Infragistics.Win.UltraWinGrid.UltraGridAction.EnterEditMode)
EndIf 
```

Which should work but it only gives focus to the row (no edit mode).

```
fooColumn   
   |
  \_/ 
```

![enter image description here](https://i.stack.imgur.com/57s2K.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T17:54:21.703

我不知道为什么，但调用它`BeginInvoke`解决了这个问题。

```
BeginInvoke(New MethodInvoker(AdressOf SetFocusToRow))

Private sub SetFocusToRow()
{
  myUltraWinGrid.ActiveCell = myUltraWinGrid.ActiveRow.Cells("foo")
  myUltraWinGrid.PerformAction(Infragistics.Win.UltraWinGrid.UltraGridAction.EnterEditMode)
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-07-30T20:58:06.360

因为由于某种原因它被另一个线程执行

myUltraWinGrid.BeginInvoke(new MethodInvoker(()=> myUltraWinGrid.PerformAction(UltraGridAction.EnterEditMode)));

# google-chrome - In Chrome undo does not work properly for input element after contents changed programmatically

> ID：16195644
> 
> 赞同：6
> 
> 时间：2013-04-24T15:11:02.800
> 
> 标签：google-chrome, input, undo, undo-redo

In Chrome, I noticed that undo does not work properly for input element after the contents of the element has been changed programmatically. Although I get different behaviours for different browsers, they're not as bad as Chrome.

```
FF20      good
IE9       some support (undo stack cleared when input loses focus)
Safari5   some support (undo stack cleared when input loses focus)
Chrome26  unreliable 
```

For example, a script that trims spaces (see also jsfiddle below)

*   type some spaces before "hello!",
*   click outside the input element
*   click on the input element and press Ctrl-Z

now the text is gone (in Chome)

[jsfiddle here](http://jsfiddle.net/K75t7/)

```
<input type="text" id="input1" value="hello!">

document.getElementById("input1").addEventListener('blur', function(evt){elementLosesFocus(evt, this);}, false);

function elementLosesFocus(evt, caller)
{
    caller.value = caller.value.trim();
} 
```

I think the best thing I can hope for is a method to somehow clear the undo history of the input when it loses focus (as is the case with IE and Safari).

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-19T22:33:18.070

Chrome doesn't store the field's states, but rather a diff or set of deltas for each undo/redo. It takes less memory, but causes the bug you're dealing with.

You can effectively simulate the user pasting a value into the field by using `document.execCommand("insertText", false, "text to insert");`.

For your particular case:

1.  First, save the field's value to a variable. `var temp = caller.value;`
2.  Next, clear the field's value or set its selectionStart to 0 and selectionEnd to the field's length. This way a simulated paste replaces the field's contents.
3.  Next, make sure the field has the focus. `caller.focus();`
4.  Finally, simulate the user pasting in the modified value. `document.execCommand("insertText", false, temp.trim());`

I found this solution in another SO question, [https://stackoverflow.com/a/10345596/1021426](https://stackoverflow.com/a/10345596/1021426)

# javascript - 缺失：在属性 id Ext.ux.grid.RowExpander = function() {

> ID：16195647
> 
> 赞同：0
> 
> 时间：2013-04-24T15:11:13.663
> 
> 标签：javascript, extjs

好的，所以我花了几个小时梳理这段代码，但仍然找不到这个错误是从哪里产生的。Firefox 控制台向我显示的错误是在第 5 列的第 7 行找到了这个丢失的冒号。有人可以帮帮一个女孩吗？先感谢您。

```
Ext.Loader.setConfig({
enabled: true
});

Ext.application( {
controllers: [ "Links" ],
    Ext.ux.grid.RowExpander: function() {
        var expanderVariableScopes = new Ext.ux.grid.RowExpander({
                tpl: new Ext.XTemplate(
'<p><span class="boldText" style="text-decoration: underline;">Form Scope</span><ul style="padding:0 0 0 5px;">',
'<tpl for="form_scope"><li><span class="boldText">{key}:</span> {value}</li></tpl>',
'</ul></p><br />',
'<p><span class="boldText" style="text-decoration: underline;">URL Scope</span><ul style="padding:0 0 0 5px;">',
'<tpl for="url_scope"><li><span class="boldText">{key}:</span> {value}</li></tpl>',
'</ul></p>'
                )
 }),
paginator: new YAHOO.widget.Paginator({
     containers: [ 'sessionPaginator' ],
     initialPage: $('#session-initial-page').val(),
     rowsPerPage: $('#session-rows-per-page').val(),
     totalRecords: $('#session-total-records').val()
});
storeAccessLog: new Ext.data.Store({
    baseParams: { limit: 25, method: 'account_session_access_log' },
    proxy: new Ext.data.HttpProxy({
        disableCaching: true,
        method: "GET",
        url: "ajax/account.cfc"
    }),
    reader: new Ext.data.JsonReader({
        root: "DATA",
        totalProperty: "META.totalRecords",
        fields: [ 'log_id', 'cdate', 'session_id', 'request_type', 'filename', 'user_agent', 'form_scope', 'url_scope', 'account_id', 'accountholder' ]
    }),
    remoteSort: true,
    sortInfo: {
        field: 'cdate',
        direction: 'DESC'
    }
}),
storeAuditEntries: new Ext.data.Store({
    baseParams: { method: 'session_audit_entries' },
    proxy: new Ext.data.HttpProxy({
        disableCaching: true,
        method: "GET",
        url: "ajax/account.cfc"
    }),
    reader: new Ext.data.JsonReader({
        root: "DATA",
        totalProperty: "META.totalRecords",
        fields: [ 'AUDIT_TEXT', 'AUDIT_DATETIME' ]
    })
}),

$(window).resize(function() {
oWindow.center();   
});

 paginator.subscribe("changeRequest", function (newState) {
            window.location.href = "accounts-view-activity.cfm?#request.qString#&sort=#url.sort#&dir=#url.dir#&initialPage=" + newState.page;
        });

paginator.render();

$('.detailslink')
.button({
    icons: { primary: 'ui-icon-plusthick' },
    text: false
 })
.click(function (e) {
    var $this = $(this);

    storeAccessLog.extraParams("session_id", $this.val());
    storeAccessLog.load({ params: { start: 0 } });

    storeAuditEntries.extraParams("session_id", $this.val());
    storeAuditEntries.load();

    oWindow.show()
});

$('#accountForm').submit(function(e) {
    e.preventDefault();
});
name: "SPOT"
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:12:42.017

问题是您`=`在应该使用运算符的地方使用`:`运算符。

当您按照上面的方式定义对象时，预期的语法是：

```
var obj = {
    prop1: value1,
    prop2: value2
    ...
}; 
```

在你的情况下，

`Ext.ux.grid.RowExpander = function() {`应该改为`Ext.ux.grid.RowExpander: function() {`

`paginator = new YAHOO.widget.Paginator({`应该改为`paginator: new YAHOO.widget.Paginator({`

等等..

# parallel-processing - MPI虚拟图拓扑广播

> ID：16195654
> 
> 赞同：5
> 
> 时间：2013-04-24T15:11:33.617
> 
> 标签：parallel-processing, mpi

我有以下问题：

我想创建一个基于树形图的虚拟拓扑，例如：

```
 0
 /   \
1    5
| \  | 
2  4 3 
```

顶点的数量是进程的等级。

我设法做到了，我掌握了我的新通讯器：

```
MPI_Comm graph_comm;
MPI_Graph_create(MPI_COMM_WORLD, nnodes, indexes, edges, 0, &graph_comm); 
```

现在我的问题是：是否有可能从每个只有子节点的父节点发送广播（MPI_Bcast）（在此示例中，等级为 0 的进程将 bcast 发送到进程 1、5；等级为 1 的进程发送 bcast到进程 2、4；等级为 5 的进程发送 bcast 到进程 3)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-01T22:03:08.653

这似乎是不可能的，必须为广播创建单独的通信器。虽然两者都`MPI_Graph_neighbors_count`应该`MPI_Graph_neighbors`足以创建新组，但人们可能想知道，如果可以使用与图拓扑完全相同的数据创建这些组，为什么我们首先需要图拓扑？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-04T21:31:16.313

是的，您必须在每个进程中创建组，然后您可以调用`MPI_Bcast`每个组，其中 root 是节点的父级（在您的示例中，0 是 1 和 5 的父级，但您应该记住，根级别分配给本地通信器，所以 0在本地组中不必为 0，这取决于您如何创建它）。这可以提供帮助：[组和通信器管理例程](https://computing.llnl.gov/tutorials/mpi/#Group_Management_Routines)

# ios - 单个 Viewcontroller 中的多个 UITableview

> ID：16195660
> 
> 赞同：16
> 
> 时间：2013-04-24T15:11:48.983
> 
> 标签：ios, objective-c, uitableview, uiview, uiviewcontroller

我有一个`viewcontroller`我想显示 3`tableviews`的内容（因为内容和表格属性不同）。如何将这些委托方法添加到 3 个表中`viewcontroller`？

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [array1 count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {} 
```

**编辑**

那么，如果我想`uislider`使用自定义添加到一个表格行`cell`并且当我滑动值时我想更改显示亮度，我会怎么做？

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    if (tableView == _displayThemes) {
        return 1;
    } else {
        return 1; 
    }
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    if(tableView==_displayThemes) {
        return 1;
    } else {
        return 5;
    }
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    if (tableView == _displayThemes) {
        cell.textLabel.text = [displaytheme objectAtIndex:indexPath.row];
        return cell;
    } else {
        cell.textLabel.text = [fontlist objectAtIndex:indexPath.row];
        return cell;
    }
}

- (IBAction)fontButton:(id)sender {
    _fontList = [[UITableView alloc]init];
    [self.view addSubview:_fontList];
    [UIView animateWithDuration:1.5
            delay:0
            options: UIViewAnimationOptionTransitionCurlUp
            animations:^{
                _fontList.fram e= CGRectMake(0,800,320,200);
            }
            completion:^(BOOL finished){
                _fontList.frame = CGRectMake(0,280,320,200);     
    }];

    [_fontList reloadData];
}

- (IBAction)button:(id)sender {
    _displayThemes = [[UITableView alloc]init];
    [self.view addSubview:_displayThemes];
    [UIView animateWithDuration:1.5
            delay:0
            options: UIViewAnimationOptionTransitionCurlUp
            animations:^{
                _displayThemes.frame=CGRectMake(0,800,320,200);
            }
            completion:^(BOOL finished){
                _displayThemes.frame=CGRectMake(0,280,320,200);
    }];
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-24T15:15:29.603

这与使用一个表格视图执行此操作相同，但您应该检查当前使用的是哪个表格视图。

```
myTableView1.dataSource = self;
...

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
  if (tableView == myTableView1) {
    // your code 1
  }
  else 
  if (tableView == myTableView2) {
      // your code 2
  }
  else 
  if (tableView == myTableView3) {
      // your code 3
  }
} 
```

## 编辑：

关于亮度：

[如何在 iOS 5 应用程序中更改亮度？](https://stackoverflow.com/questions/8207305/how-to-change-brightness-in-ios-5-app)

并且关于`UISlider`它有`minimunValue`和`maximumValue`属性。

```
- (void) sliderChanged:(UISlider*)sender{
    UISlider *slider = (UISlider*)sender;
    [[UIScreen mainScreen] setBrightness:slider.value];
} 
```

## 编辑：

```
slider.tag = 1;
[cell addSubview:slider];

...
// when you need..
indexPath = [NSIndexPath indexPathForRow:myRow inSection:mySecion];
UISlider* slider = (UISlider*) [[self.tableView cellForRowAtIndexPath:indexPath] viewWithTag:1]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-24T15:13:47.590

你总能得到一个引用，并且总能检查调用了哪个 tableView 委托或 dataSource 方法。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    if (tableView == self.tableView1)
    {
        return 1;
    }

    if (tableView == self.tableView2)
    {
        return 1;
    }

    if (tableView == self.tableView3)
    {
        return 1;
    }
} 
```

通过对所有表使用相同的标识符，您不会获得任何东西。使用类似的东西：

```
-(UITableViewCell*)tableView:(UITableView*)tableView cellForRowAtIndexPath:(NSIndexPath*)indexPath
{    
    if (tableView == self.tableView1)
    {
        static NSString *CellIdentifier1 = @"cellForTable1";

        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier1];

        if (!cell)
        {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier1];
        }

        cell.textLabel.text = [NSString stringWithFormat: @"table1: %d.%d", indexPath.section, indexPath.row];

        return cell;
    }

    if (tableView == self.tableView2)
    {
        static NSString *CellIdentifier2 = @"cellForTable2";

        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier2];

        if (!cell)
        {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier2];
        }

        cell.textLabel.text = [NSString stringWithFormat: @"table2: %d.%d", indexPath.section, indexPath.row];

        return cell;
    }

   if (tableView == self.tableView1)
    {
        static NSString *CellIdentifier3 = @"cellForTable3";

        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier3];

        if (!cell)
        {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier3];
        }

        cell.textLabel.text = [NSString stringWithFormat: @"table3: %d.%d", indexPath.section, indexPath.row];

        return cell;
    }   
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-21T05:50:07.330

```
//add tag in tableView .
myTable1.tag = 200;
myTable2.tag = 201;
myTable3.tag = 202;
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
if (tableView.tag == 200)
{
    return 1;
}
if (tableView.tag == 201)
{
    return 1;
}
if (tableView.tag == 202)
{
    return 1;
}

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-06-22T06:59:33.987

**您可以通过在UItableViewDelegate**和**UItableViewDatasource**中编写以下代码来在单个**ViewController**中管理多个**tableView**。

 ******```
public func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
    if tableView  == tableView1
    {
        // place your code here
    }
    else if tableView  == tableView2 {
        // place your code here
    }
    else {
      return 0
    }
}
func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    if tableView  == tableView1
    {
        // place your code here
    }
    else if tableView  == tableView2 {
        // place your code here
    } 
    else {
        return 0
    }
}
// You can set a different size of your tableView using below lines of code 
if tableView  == tableView1{
    return 50
}
else{
    return 40
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-12T16:52:24.540

以前没有一个对我有用，我想出了以下解决方案：

```
 public func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
  if((tableView1 != nil) && (tableView  == tableView1)) {
   return Items1.count
  }
  else if((tableView2 != nil) && (tableView  == tableView2)) {
   return Items2.count
  }
  else if((tableView3 != nil) && (tableView  == tableView3)) {
   return Items3.count
  }
  else {
   return 0
  }
} 
```******

# javascript - 无法使用innerHTML

> ID：16195661
> 
> 赞同：1
> 
> 时间：2013-04-24T15:11:56.007
> 
> 标签：javascript, innerhtml

我是 Stack Overflow 和 JavaScript 的新手。所以，首先，向大家问好，并提前感谢您的帮助。

我正在使用 Incomedia Website X5 Evolution 创建一个网站。在其中一个页面上，我想用来自服务器的数据填充一个表。所以，我创建了一个表格，并在每个单元格中插入了这个 HTML 代码：

```
<!--#0000,0000--> 
```

值代表行和列。我设法编写了一个 javascript 来更改每个单元格的值。但是当我想用 innerHTML 替换 HTML pahe 的内容时，它不起作用。尽管如此，一切似乎都是正确的，因为旧的和新的 html 内容是一样的。即使我再次使用原始变量，它仍然不起作用。

你能告诉我问题出在哪里吗？

这里的javascript代码：

```
<script>

var i;
var div = document.getElementById('imTableObject_1');
div = document.getElementsByTagName('table');
var htmlContent = div[0].innerHTML;
var newHtmlContent = div[0].innerHTML;
var test = div[0].innerHTML;
var row,col;

//I can't understand why the scrip stop running at this line. I didn't change anything...
div[0].innerHTML = newHtmlContent ;

for (i=htmlContent.length - 5; i > -1; i--) {

if(htmlContent.charAt(i)=='#') {

    //alert(i);
    //alert(htmlContent.substring(i+6,i+10));
    row = parseInt(htmlContent.substring(i+1,i+5));     
    col = parseInt(htmlContent.substring(i+6,i+10));

    newHtmlContent = insertText(row,col,newHtmlContent,i);
};
};

alert(div[0].innerHTML);
alert(newHtmlContent );

//This does not work
div[0].innerHTML = newHtmlContent ;

alert("Done !");

function insertText (row, col, text, index) {

var length;
var newText;

length = getTextLength (text,index + 13);

//alert(htmlContent.substring(index+13,index+13+length));

newText = text.substring(0,index+13);
newText += "Titi too !";
newText += text.substring(index+13+length,text.length);

//alert(newText);

return newText ;

}

function getTextLength (text,startIndex) {

var i = 0;

for(i = startIndex ; i < text.length ; i++) {

    //alert(text.substring(i,i+7));

    if(text.substring(i,i+7) == "</span>") {

        return i - startIndex ;
    };
};

return -1;
}

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:32:29.563

将第三行更改为

```
div = document.getElementsByTagName('td'); 
```

寻找`<td>`标签而不是`<table>`标签。`<table>`s 不能直接存储文本数据，所以我猜它们`innerHTML`也不能按预期工作。

我设法让它在这里工作：http: [//jsfiddle.net/mgabor/ZMaW6/1/](http://jsfiddle.net/mgabor/ZMaW6/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:15:41.543

你设置：

```
var newHtmlContent = div[0].innerHTML; 
```

接着：

```
div[0].innerHTML = newHtmlContent ; 
```

您正在将其内容设置为其内容已经是什么。因此，不会发生任何变化。

# ruby-on-rails - 开始和救援块异常处理

> ID：16195663
> 
> 赞同：2
> 
> 时间：2013-04-24T15:12:03.133
> 
> 标签：ruby-on-rails, ruby, exception-handling

我在 Rails 异常处理方面几乎没有经验。我有这个片段

```
def update
  @game = Game.find(params[:id])
  begin
    params[:game][:tier] = eval(params[:game][:tier]) 
  rescue 
    @game.errors.add(:tier, "Please make sure the correct format for tier, example [100, 1000, 10000]")
  end
#.... more code
end 
```

如果 params[:game][:tier] = "[100,200]" 一切都很完美。如果出现像 params[:game][:tier] = "[100,200] abc" 这样的 ruby​​ 语法错误情况，它会捕获错误，但是应用程序会崩溃。

如何使用“eval()”处理异常，以免破坏应用程序？为什么在这种情况下开始和救援不起作用？感谢对红宝石启蒙的任何帮助谢谢:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:19:59.450

如果`params[:game][:tier]`是`"[100,200]; system('rm -rf /')"`呢？

由于传入的数据预计是一个数组，我不会使用`eval`，而是`JSON.parse`：

```
> JSON.parse("[100,200]")
 => [100, 200]
> JSON.parse("[100,200] abc")
JSON::ParserError: 746: unexpected token at 'abc'... 
```

`JSON::ParserError`然后从一个例外中拯救

```
rescue JSON::ParserError => e 
```

这也将解决您遇到的异常问题的救援。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:19:30.937

[这个](https://stackoverflow.com/questions/542845/how-to-rescue-an-eval-in-ruby/542857#542857)的副本

但是你应该以这种方式救援

```
def update
  @game = Game.find(params[:id])
  begin
    params[:game][:tier] = eval(params[:game][:tier]) 
  rescue Exception => e
    @game.errors.add(:tier, "Please make sure the correct format for tier, example [100, 1000, 10000]")
  end
#.... more code 
```

结尾

为了使它工作

# java - 输入 R 后，R.array 未显示在列表中

> ID：16195665
> 
> 赞同：-1
> 
> 时间：2013-04-24T15:12:04.807
> 
> 标签：java, android, arrays

我收到此 R.array 错误。我输入 R 后它没有显示在列表中。我尝试删除`R.java`但仍然无法正常工作

```
private void openNewGameDialog() 
    {
         new AlertDialog.Builder(this).setTitle("Choose a Category").setItems(R.array.category, new DialogInterface.OnClickListener() //alert dialog which will show list of categories to select
              { 
                 public void onClick(DialogInterface dialoginterface, int i) 
                   {
                      startGame(i);
                   }
              }).show();
     } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:25:29.847

如果 android 项目中的任何 xml 文件有任何错误，R 文件将不会自行生成。这可能是您问题的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:16:30.163

`R.array.category`这只是一个常量，代表 Strings.xml 中的类别数组，

您需要将 Array 传递给 SetItems。

所以你需要做的是获取 String 数组。

`getResources().getStringArray(R.array.category);`作为 setItems 的参数。

IE

```
setItems(`getResources().getStringArray(R.array.category)`, new DialogInterface.OnClickListener() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:21:50.410

请务必构建您的项目，以便生成 R.java 并将其编译为 bin 目录下的 R.class。即使它没有出现在您的自动完成建议中，您仍然可以手动输入它。如果您保存项目但仍然遇到编译器错误（红色下划线），请返回并告诉我们错误内容，我们可以从那里为您提供帮助。

# java - 我无法设置通过代码添加到 jar 中的类文件的路径

> ID：16195673
> 
> 赞同：0
> 
> 时间：2013-04-24T15:12:27.530
> 
> 标签：java, executable-jar

```
public static int compileModifiedClass(String ModifiedFile)
{
    JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
    int result = compiler.run(null, null, null, ModifiedFile);
    System.out.println("Compile result code = " + result);
    return result;
} 
```

ModifiedFile 的路径：D:\ModifiedJavaFiles\com\example\tests\

所以，类是在这个文件夹中生成的，Jar 路径是 :D:\test.jar

我想将 jar 中这些类的路径设置为 com/example/tests。

任何帮助将不胜感激。

要添加信息，在编译类之后，我从路径中获取类并调用 updateZipFile 方法来更新 jar。

```
classes = getClassesFromPath(ModifiedFilesPath, JarPath);
                        File jarFile = new File(JarPath);
                        JarUpdater jarUpdater = new JarUpdater();
                        try 
                        {
                            jarUpdater.updateZipFile(jarFile, classes);
                        }
                        catch (IOException e) 
                        {
                            e.printStackTrace();
                        }

public void updateZipFile(File zipFile,
             File[] files) throws IOException {
               // get a temp file
        File tempFile = File.createTempFile(zipFile.getName(), null);
               // delete it, otherwise you cannot rename your existing zip to it.
        tempFile.delete();

        boolean renameOk=zipFile.renameTo(tempFile);
        if (!renameOk)
        {
            throw new RuntimeException("could not rename the file "+zipFile.getAbsolutePath()+" to "+tempFile.getAbsolutePath());
        }
        byte[] buf = new byte[1024];

        ZipInputStream zin = new ZipInputStream(new FileInputStream(tempFile));
        ZipOutputStream out = new ZipOutputStream(new FileOutputStream(zipFile));

        ZipEntry entry = zin.getNextEntry();
        while (entry != null) {
            String name = entry.getName();
            boolean notInFiles = true;
            for (File f : files) {
                if (f.getName().equals(name)) {
                    notInFiles = false;
                    break;
                }
            }
            if (notInFiles) {
                // Add ZIP entry to output stream.
                out.putNextEntry(new ZipEntry(name));
                // Transfer bytes from the ZIP file to the output file
                int len;
                while ((len = zin.read(buf)) > 0) {
                    out.write(buf, 0, len);
                }
            }
            entry = zin.getNextEntry();
        }
        // Close the streams        
        zin.close();
        // Compress the files
        for (int i = 0; i < files.length; i++) {
            InputStream in = new FileInputStream(files[i]);
            // Add ZIP entry to output stream.
            out.putNextEntry(new ZipEntry(files[i].getName()));
            // Transfer bytes from the file to the ZIP file
            int len;
            while ((len = in.read(buf)) > 0) {
                out.write(buf, 0, len);
            }
            // Complete the entry
            out.closeEntry();
            in.close();
        }
        // Complete the ZIP file
        out.close();
        tempFile.delete();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:37:56.910

```
URL jar = jarFile.toURI().toURL();
URL dir = new URL("file:/D:/ModifiedJavaFiles/");
URL[] urls = { jar, dir };
URLClassLoader loader = new URLClassLoader(urls);
Class<?> klazz = loader.loadClass("com.example.tests.MyTest");
loader.close(); 
```

# c# - 即使我只想添加/替换值，我是否应该始终使用 Dictionary.TryGetValue ？

> ID：16195674
> 
> 赞同：0
> 
> 时间：2013-04-24T15:12:29.330
> 
> 标签：c#, dictionary, trygetvalue

我一直在使用 TryGetValue 在我的字典中添加/替换数据。只是为了区分添加新的和替换旧的，我同时使用 [] 和 .Add()。如果我实际上没有对检索到的值做任何事情，这会导致这样的代码：

```
private Dictionary<Foo, Bar> dictionary = new Dictionary<Foo, Bar>();

public void Update(Foo foo)
{
    Bar bar;
    if (dictionary.TryGetValue(foo, out bar)
    {
        dictionary [foo] = bar;
    }
    else
    {
        dictionary .Add(foo, bar);
    }
} 
```

如果我实际上没有对检索到的值做任何事情，是否有理由不应该用这个替换上面的代码？：

```
public void Update(Foo foo)
{
    dictionary[foo] = bar;
} 
```

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T15:13:30.423

您应该使用更简单的代码。
在所有情况下都会更快。（一个哈希查找与两个）

更重要的是，它更简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T15:13:35.983

不，没有理由不使用较短的代码。
事实上，你真的应该使用它，因为它更简单而且我们都知道：
更简单的代码意味着更少的错误。

# java - 如果我在 Weblogic 10.x 上开发并部署到 Weblogic9.2.x，风险有多大？

> ID：16195676
> 
> 赞同：4
> 
> 时间：2013-04-24T15:12:29.857
> 
> 标签：java, jakarta-ee, weblogic, weblogic9.x

最近我接手了一个比较老的项目，它在 weblogic 9.2 上运行。我需要处理一些变更请求。我对 weblogic 产品不太了解。

旧的 DEV-Env 是基于 windows 的，但是我没有 windows 机器。我尝试下载适用于 linux（32 位）的 Weblogic9.2，但是我在 Oracle 网站上找不到链接，经过相当多的 google，仍然找不到工作链接。

所以我的选择：

1.  找到一个工作链接，下载 weblogic9.2 并使用它
2.  从 oracle 下载并使用 10.x 版本
3.  设置一个windows盒子（我们有weblogic9.2 for win的安装程序）

3是我想做的最后一件事。如果有人知道我在哪里可以获得 9.2 版本，那就太好了。如果没有可用的 weblogic9.2，我可以在 weblogic10.x 上工作并在生产中发布到 9.2 吗？有多大风险？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:18:36.757

在 WLS 10.x 中开发并在 9.2 中部署可能会带来一些麻烦。

在 10.x 中升级的特性相当多，例如 Java 5 到 6，J2EE 1.4 到 5，Servlet 2.4 到 2.5，JSP 2.0 到 2.1，EJB 2.1 到 3.0。

虽然这里的大多数功能确实具有向后兼容性，但您在开发时必须格外小心。

我建议仅基于最低公分母功能进行开发，并在您将其部署到的同一台服务器上构建。（即 10.x 有一个差异版本，而 9.2.x 有不同的版本。）

[编辑： PeopleSoft 的 FTP 站点](ftp://ftp.peoplesoft.com/outgoing/ptools/weblogic/9.20)上似乎有一个正宗的二进制文件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-24T15:18:44.210

这绝对是一个风险。不同版本的 Weblogic 使用不同的 jar，所以在 10.x 上有效的可能在 9.x 上无效。让您的 QA 和 PROD 环境（包括节点设置和启动变量）尽可能相似是一个很好的做法。

如果您当前的 PROD 部署代码可以在 10.x 上运行，那么我会将您的 PROD 环境升级到 10.x 并继续在 10.x 上进行开发。如果没有，那么尽你所能在你的 DEV 环境中安装 9.x。

# ruby-on-rails - 我可以用 XML 响应 Rails 中的 HTML 请求吗？

> ID：16195677
> 
> 赞同：0
> 
> 时间：2013-04-24T15:12:35.637
> 
> 标签：ruby-on-rails, xml, rendering

我想放入一个简单的 API 来响应带有查询字符串的 GET 请求。但我想返回 XML，而不是 HTML。

我什至想在浏览器中对此进行测试，以便如果我键入 URL 和查询字符串，然后在响应中看到 XML。

我只是通过渲染来获得它`:text`，但我的 xml 正在做两件事：

```
1\. All tag names are being downcased.

2\. My xml is being wrapped in an HTML container (HTML, HEAD, BODY, etc.) 
```

我只需要摆脱那个 HTML 包装器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:30:53.320

这个对我有用：

```
respond_to do |format|
  format.xml do
    headers['Content-Disposition'] = 'attachment;filename="katalog.xml"'
    render :xml => xml_array.to_xml(:skip_types => true, :root => "Items"),
           :layout => false,
           :content_type => Mime::XML
  end
end 
```

您应该能够`xml_array.to_xml(:skip_types => true, :root => "Items")`用您的字符串替换，因为 .to_xml 除了生成字符串（并确保它是正确的 XML）之外什么都不做

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:15:53.903

您可以简单地呈现为 xml（在您的控制器中）：

```
render xml: @your_object 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-05T21:10:13.340

在 Rails 5.2.x 上，这就是你的做法

```
class UserController < ApplicationController
  def view
    @user = User.find(params[:id])
    render formats: [:xml]
  end
end 
```

在 app/views/user/view.xml 上有相应的视图

```
xml.User do
  xml.name @user.name
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-21T20:34:39.897

布局错误，仅：[:action]

这将删除所有与布局相关的代码。

# android - 将 Facebook 集成到 Android 应用程序中以通过 Facebook 投放广告

> ID：16195685
> 
> 赞同：1
> 
> 时间：2013-04-24T15:12:48.870
> 
> 标签：android, facebook, facebook-android-sdk

我有一个现有的 Android 应用程序，我正在尝试通过 Facebook 广告做广告。Facebook 说我必须将他们的库集成到我的应用程序中，从下载他们的 SDK 开始。

当我从这里下载他们的 SDK 时：http: [//developers.facebook.com/android/](http://developers.facebook.com/android/)里面没有 .jar 文件，而是使用他们的类的应用程序示例。

我认为出于我的目的，我只需要在我的应用程序启动时拨打 Facebook 电话，对吗？因为我不想要任何 Facebook 功能。我只是希望能够整合到足以在他们的系统中做广告的能力。

谁能帮我理解我需要做什么？

我应该将他们 Facebook/com/src 文件夹中的所有类复制到我自己的项目中吗？如果是这样，我在哪里将我的 Facebook 应用程序的访问密钥和密钥添加到我的 Android 应用程序中？

谢谢！- 亚历克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T17:46:31.297

Facebook SDK 不是一个简单的 jar 文件，而是一个 Android 库。如果您使用的是 eclipse，则需要将 SDK 导入您的工作区，并将其作为库添加到您的项目中。

请参阅有关如何添加库的 google 文档[http://developer.android.com/tools/projects/projects-eclipse.html](http://developer.android.com/tools/projects/projects-eclipse.html)

还有 Facebook SDK 入门指南[https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/)

# ruby - 在 ruby DSL 实现中捕获规范文件名？

> ID：16195686
> 
> 赞同：1
> 
> 时间：2013-04-24T15:12:53.080
> 
> 标签：ruby, dsl, objective-c++, vmat

我正在编写一个**ruby**​​ DSL，它将用于代码生成许多**Objective-C++**函数。我希望每个函数的名称都源自其**ruby**​​ DSL 源文件的名称。

例如，给定这个源文件`clusterOptions.rb`：

```
require './vMATCodeMonkey'

VMATCodeMonkey.new(:print).options_processor <<EOS
  -cutoff:    flag: set('useCutoff', true), arg: vector('double')
  -depth:     flag: set('useInconsistent', true), arg: scalar('double', default: 2.0)
  -maxclust:  flag: set('useCutoff', false), arg: vector('index')
EOS 
```

当`VMATCodeMonkey.new(:print)`表达式被评估时，*理想情况下*，我希望新对象以某种方式捕获`clusterOptions.rb`源文件名。那可能吗？

如果（我怀疑）它不是，在**ruby**​​ 中是否有一个很好的习惯用法来完成此功能[例如，使源文件名有效地成为 DSL 捕获的规范的一部分] ？

[虽然我*怀疑*不可能完全按照我所描述的那样做，但我*还是问了*，因为我不止一次对**ruby**​​ 的晦涩功能感到惊讶。]

**编辑：**我知道`__FILE__`；我正在寻找的是一些以 DSL 为中心的方式来捕获 DSL 源文件的名称，*而无需*`__FILE__` *在 DSL 源中*明确提及。嗯，现在我正在尝试解释它，也许是从类`initialize`方法中爬取堆栈跟踪？

## 解决方案

感谢 tadman，这是我的`VMATCodeMonkey#initialize`方法：

```
def initialize(out_opt = :print)
    @caller_file = caller(1)[0].split(':')[0]
    case out_opt
      when :pbcopy
        @out = IO.popen('pbcopy', 'w')
      when :print
        @out = $stdout
      else
        raise ArgumentError, "#{out_opt} is not an option!"
    end
    @out.puts "// vMATCodeMonkey's work; do not edit by hand!\n\n"
    initialize_options_processor
  end 
```

这就是它捕获的内容：

```
@caller_file = "/Users/Shared/Source/vMAT/ruby/clusterOptions.rb" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:50:05.583

正在评估的源文件的完整路径存储在`__FILE__`. 如果你只想要文件名，你会使用：

```
File.basename(__FILE__) 
```

该`__FILE__`常量对于 C、C++、Perl 和 Python 等是通用的。

如果您需要知道哪个文件调用了当前正在运行的例程，这可能会起作用：

```
caller(1)[0].split(':')[0] 
```

这假定您的文件名中没有`:`，但在大多数情况下，这应该是一个相当安全的假设。您还需要在库的入口点调用它。如果它是堆栈中更深的方法，请测试`caller(2)`等等。

# linux - 通过 elinks 进行管道尾部输出

> ID：16195691
> 
> 赞同：0
> 
> 时间：2013-04-24T15:13:02.343
> 
> 标签：linux, bash

考虑以下命令：

```
elinks -dump file.html 
```

它将打印文件，格式为纯文本（没有 HTML 标签）。

file.html 会不断更新，我想像这样通过“tail -f”运行它：

```
tail -f file.html | elinks -dump 
```

但是它不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:21:32.390

`tail -f`仅打印新添加到文件末尾的行。

如果您想在某些间隔检查命令的输出，`watch`可以这样做：

```
watch elinks -dump file.html 
```

# c# - 如何取消异步下载？

> ID：16195694
> 
> 赞同：5
> 
> 时间：2013-04-24T15:13:14.890
> 
> 标签：c#, asynchronous, download

我有问题。如何取消下载？

```
 client.CancelAsync(); 
```

对我不起作用，因为如果我取消下载并开始新的下载，代码仍会尝试访问旧的下载文件。您必须知道在我的代码中是下载完成后的一部分，它应该解压缩已下载的文件。Example.zip 像这样 :) 所以，当我取消下载并开始一个新的下载时，你知道我的脚本试图解压缩我的旧 Example.zip，但它应该踢这个....

对于解压缩，我使用 Iconic.Zip.dll ( [http://dotnetzip.codeplex.com/](http://dotnetzip.codeplex.com/) )

如何让它工作？

* * *

更新：

这是我的下载表格

```
 private void button3_Click_1(object sender, EventArgs e)
    {

        DialogResult dialogResult = MessageBox.Show("This will cancel your current download ! Continue ?", "Warning !", MessageBoxButtons.YesNo);
        if (dialogResult == DialogResult.Yes)
        {

            cancelDownload = true;
            URageMainWindow.isDownloading = false;
            this.Close();

        }
        else if (dialogResult == DialogResult.No)
        {

        } 
    } 
```

这是我的主要形式，当您开始下载某些内容时会发生这种情况

```
 private void checkInstall(object sender, WebBrowserDocumentCompletedEventArgs e)
    {

            string input = storeBrowser.Url.ToString();

            // Test these endings
            string[] arr = new string[]
           {"_install.html"};

            // Loop through and test each string
            foreach (string s in arr)
            {
                if (input.EndsWith(s) && isDownloading == false)
                {

                   // MessageBox.Show("U.Rage is downloading your game");
                    Assembly asm = Assembly.GetCallingAssembly();
                    installID = storeBrowser.Document.GetElementById("installid").GetAttribute("value");
                   // MessageBox.Show("Name: " + installname + " ID " + installID);
                    installname = storeBrowser.Document.GetElementById("name").GetAttribute("value");
                    installurl = storeBrowser.Document.GetElementById("link").GetAttribute("value");

                    isDownloading = true;
                    string install_ID = installID;
                    string Install_Name = installname;

                    // MessageBox.Show("New Update available ! " + " - Latest version: " + updateversion + "  - Your version: " + gameVersion);
                    string url = installurl;
                    WebClient client = new WebClient();
                    client.DownloadProgressChanged += new DownloadProgressChangedEventHandler(client_InstallProgressChanged);
                    client.DownloadFileCompleted += new AsyncCompletedEventHandler(client_InstallFileCompleted);
                    client.DownloadFileAsync(new Uri(url), @"C:\U.Rage\Downloads\" + installID + "Install.zip");
                    if (Downloader.cancelDownload == true)
                    {
                        //MessageBox.Show("Downloader has been cancelled");
                        client.CancelAsync();
                        Downloader.cancelDownload = false;
                    }
                    notifyIcon1.Visible = true;
                    notifyIcon1.ShowBalloonTip(2, "Downloading !", "U.Rage is downloading " + installname, ToolTipIcon.Info);
                    System.Media.SoundPlayer player = new System.Media.SoundPlayer(@"c:/U.Rage/Sounds/notify.wav");
                    player.Play();

                    storeBrowser.GoBack();
                    igm = new Downloader();
                    igm.labelDWGame.Text = installname;
                    // this.Hide();
                    igm.Show();
                    return;
                }

                  if (input.EndsWith(s) && isDownloading == true)
                {
                  System.Media.SoundPlayer player = new System.Media.SoundPlayer(@"c:/U.Rage/Sounds/notify.wav");
                  player.Play();
                  MessageBox.Show("Please wait until your download has been finished", "Warning");
                  storeBrowser.GoBack();
                }
            }
        } 
```

下载完成后会发生这种情况

```
 void client_InstallFileCompleted(object sender, AsyncCompletedEventArgs e)
    {
        if(Downloader.cancelDownload == false)
        {
            using (ZipFile zip = ZipFile.Read(@"C:\U.Rage\Downloads\" + installID + "Install.zip"))
            {
                //zip.Password = "iliketrains123";
                zip.ExtractAll("C:/U.Rage/Games/", ExtractExistingFileAction.OverwriteSilently);
            }
            System.IO.File.Delete(@"C:/U.Rage/Downloads/" + installID + "Install.zip");
            notifyIcon1.Visible = true;
            notifyIcon1.ShowBalloonTip(2, "Download Completed !", "Installing was succesful !", ToolTipIcon.Info);
            System.Media.SoundPlayer player = new System.Media.SoundPlayer(@"c:/U.Rage/Sounds/notify.wav");
            player.Play();
            this.Show();
            igm.Close();
            isDownloading = false;
            listView.Items.Clear();
            var files = Directory.GetFiles(@"C:\U.Rage\Games\", "*.ugi").Select(f => new ListViewItem(f)).ToArray();
            foreach (ListViewItem f in files)
            {
                this.LoadDataFromXml(f);
            }

      }
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2016-09-18T15:18:59.757

以下是支持取消的异步数据下载方法：

```
private static async Task<byte[]> downloadDataAsync(Uri uri, CancellationToken cancellationToken)
{
    if (String.IsNullOrWhiteSpace(uri.ToString()))
        throw new ArgumentNullException(nameof(uri), "Uri can not be null or empty.");

    if (!Uri.IsWellFormedUriString(uri.ToString(), UriKind.Absolute))
        return null;

    byte[] dataArr = null;
    try
    {
        using (var webClient = new WebClient())
        using (var registration = cancellationToken.Register(() => webClient.CancelAsync()))
        {
            dataArr = await webClient.DownloadDataTaskAsync(uri);
        }
    }
    catch (WebException ex) when (ex.Status == WebExceptionStatus.RequestCanceled)
    {
        // ignore this exception
    }

    return dataArr;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-24T15:36:43.967

当您调用`CancelAsync`时，`AsyncCompletedEventArgs`传递给完成回调的对象将`Cancelled`属性设置为 true。所以你可以写：

```
void client_InstallFileCompleted(object sender, AsyncCompletedEventArgs e)
{
    if(e.Cancelled)
    {
        // delete the partially-downloaded file
        return;
    }
    // unzip and do whatever...
    using (ZipFile zip = ZipFile.Read(@"C:\U.Rage\Downloads\" + installID + "Install.zip")) 
```

有关更多信息，请参阅[文档](http://msdn.microsoft.com/en-us/library/system.net.webclient.cancelasync.aspx)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-24T18:37:36.220

选择的答案对我不起作用。这是我所做的：

当他们单击取消按钮时，我调用

```
Client.CancelAsync(); 
```

然后在Web.Client DownloadFileCompleted：

```
Client.DownloadFileCompleted += (s, e) =>
{
      if (e.Cancelled)
      {
          //cleanup delete partial file
          Client.Dispose();                    
          return;
      }
 } 
```

然后当您尝试重新下载时，只需实例化一个新客户端：

```
Client = WebClient(); 
```

这样就不会维护旧的异步参数。

# sql - SQL，根据变量从单个表中多次返回一行

> ID：16195700
> 
> 赞同：0
> 
> 时间：2013-04-24T15:13:22.380
> 
> 标签：sql, jasper-reports

我正在使用*iReport*创建一些框标签，并且需要将每个框标签的数据相乘。

我有 2 个参数，@id 用于记录 ID，@typ 用于所需的包类型

```
SELECT
     dr_id,
     dr_to_customer,
     dr_company_name,
     dr_address_0,
     dr_address_1,
     dr_address_2,
     dr_address_3,
     dr_postcode,
     dr_contact,
     dr_per_packs,
     dr_per_boxes,
     dr_per_pallets
FROM delreq
WHERE dr_id = @id AND ??timesTOrepeat?? = @typ (a string) 
```

我需要根据包装、盒子或托盘中的数量将每一行退回*x次。*

所以，我需要先根据@typ 选择数量，然后计算出如何将行相乘。

帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:23:24.520

您可以尝试使用外连接来实现这一点。尝试这个：

```
SELECT
     dr_id,
     dr_to_customer,
     dr_company_name,
     dr_address_0,
     dr_address_1,
     dr_address_2,
     dr_address_3,
     dr_postcode,
     dr_contact,
     dr_per_packs,
     dr_per_boxes,
     dr_per_pallets
FROM delreq a, (select -1 id from all_objects where rownum < @typ) b
WHERE dr_id = @id AND a.dr_id(+) = b.id; 
```

我在这里假设 dr_id 不会有值 -1 也假设 db 是 oracle [不确定邻接其他数据库。

# python-3.x - 堆栈图图例的空方块

> ID：16195703
> 
> 赞同：0
> 
> 时间：2013-04-24T15:13:24.797
> 
> 标签：python-3.x, matplotlib, plot, legend

我正在尝试使用 matplotlib 生成版本数据的堆栈图。我的那部分工作和显示正常，但我无法让图例显示角落里的空方块以外的任何东西。

```
ra_ys = np.asarray(ra_ys)

# Going to generate a stack plot of the version stats
fig = plt.figure()

ra_plot = fig.add_subplot(111)

# Our x axis is going to be the dates, but we need them as numbers
x = [date2num(date) for date in dates]

# Plot the data
ra_plot.stackplot(x, ra_ys)

# Setup our legends
ra_plot.legend(ra_versions) #Also tried converting to a tuple
ra_plot.set_title("blah blah words")
print(ra_versions)

# Only want x ticks on the dates we supplied, and want them to display AS dates
ra_plot.set_xticks(x)
ra_plot.set_xticklabels([date.strftime("%m-%d") for date in dates])

plt.show() 
```

`ra_ys`是一个多维数组：

```
[[ 2  2  2  2  2  2  2  2  2  2  1]
 [ 1  1  1  1  1  1  1  1  1  1  1]
 [ 1  1  1  1  1  1  1  1  1  1  1]
 [53 52 51 50 50 49 48 48 48 48 47]
 [18 19 20 20 20 20 21 21 21 21 21]
 [ 0  0 12 15 17 18 19 19 19 19 22]
 [ 5  5  3  3  3  3  3  3  3  3  3]
 [ 4  4  3  3  2  2  2  2  2  2  2]
 [14 14  6  4  3  3  2  2  2  2  2]
 [ 1  1  1  1  1  1  1  1  1  1  1] 
 [ 1  1  1  1  1  1  1  1  1  1  1]
 [ 1  1  1  1  1  1  1  1  1  1  1]
 [ 2  2  2  2  2  2  2  2  2  2  2]
 [ 1  1  1  1  1  1  1  1  1  1  1]
 [ 1  1  1  1  1  1  1  1  1  1  1]
 [ 3  3  2  2  2  2  2  2  2  2  2]] 
```

`x`是一些日期：`[734969.0, 734970.0, 734973.0, 734974.0, 734975.0, 734976.0, 734977.0, 734978.0, 734979.0, 734980.0, 734981.0]`

`ra_versions`是一个列表：`['4.5.2', '4.5.7', '4.5.8', '5.0.0', '5.0.1', '5.0.10', '5.0.7', '5.0.8', '5.0.9', '5.9.105', '5.9.26', '5.9.27', '5.9.29', '5.9.31', '5.9.32', '5.9.34']`

难道我做错了什么？堆栈图可以没有图例吗？

编辑：我尝试打印绘图的句柄和标签，并得到两个空列表（`[] []`）：

```
handles, labels = theplot.get_legend_handles_labels()
print(handles,labels) 
```

然后，我使用以下代码对代理句柄进行了测试，它工作正常。所以看起来缺少手柄是问题所在。

```
p = plt.Rectangle((0, 0), 1, 1, fc="r")
theplot.legend([p], ['test']) 
```

所以现在的问题是，如何生成与堆栈图颜色匹配的可变数量的代理句柄？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T19:31:05.887

这是获得图例的最终（更清洁）方法。由于没有句柄，我为每一行生成代理艺术家。它理论上能够处理重复使用颜色的情况，但它会令人困惑。

```
def plot_version_data(title, dates, versions, version_ys, savename=None):
    print("Prepping plot for \"{0}\"".format(title))
    fig = plt.figure()    
    theplot = fig.add_subplot(111)

    # Our x axis is going to be the dates, but we need them as numbers
    x = [date2num(date) for date in dates]

    # Use these colors
    colormap = "bgrcmy"
    theplot.stackplot(x, version_ys, colors=colormap)

    # Make some proxy artists for the legend
    p = []
    i = 0
    for _ in versions:
        p.append(plt.Rectangle((0, 0), 1, 1, fc=colormap[i]))
        i = (i + 1) % len(colormap)

    theplot.legend(p, versions)
    theplot.set_ylabel(versions) # Cheating way to handle the legend

    theplot.set_title(title)

    # Setup the X axis - rotate to keep from overlapping, display like Oct-16,
    # make sure there's no random whitespace on either end
    plt.xticks(rotation=315)
    theplot.set_xticks(x)
    theplot.set_xticklabels([date.strftime("%b-%d") for date in dates])
    plt.xlim(x[0],x[-1])

    if savename:
        print("Saving output as \"{0}\"".format(savename))
        fig.savefig(os.path.join(sys.path[0], savename))
    else:
        plt.show() 
```

# html - 移动链接的标题

> ID：16195704
> 
> 赞同：0
> 
> 时间：2013-04-23T16:12:15.570
> 
> 标签：html, css, hyperlink

我不是 HTML/CSS 专家，但我负责为我的雇主开发和维护一个网站。

我在我的网页中间有一组链接，我想在不影响任何其他链接的情况下应用特定的 CSS，实际上我想要做的唯一更改是将标题弹出窗口向右移动。基本上，*指向手*悬停鼠标图标会阻止标题中的文本，所以我想将弹出窗口移动到指针的右侧，以便在悬停期间可以完全阅读。

我已经看到了几种不同的方法来操作标题弹出窗口，但是它们对于我需要的东西来说太复杂了，太简单了，因为它们会影响`<a>`页面上的所有标签，或者不解释如何做我想要的只需将弹出窗口向右移动一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:44:47.183

您可以使用不会影响页面上任何其他元素的“内联样式”手动设置页面的任何元素的样式。

您在 HTML 而不是样式表中执行此操作，例如说您的样式表具有：

```
.tinybutton {margin:0;padding;0:} 
```

它将使用 HTML 中的元素作为：

```
<a class="tinybutton" href="#"> </a> 
```

现在让我们假设您想在不编辑 CSS 的情况下稍微向右移动按钮，然后使用内联样式，如下所示：

```
<a class="tinybutton" style="margin-left:10px" href="#"> </a> 
```

因此，换句话说，只需在`style=" "`不影响 CSS 的情况下将所需的样式选项添加到要编辑的元素中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T13:43:04.403

*现在您已经回答了自己的问题，我知道您尝试移动的标题是浏览器生成的工具提示。*

这些工具提示不仅不能被移动，**而且这些工具提示依赖于浏览器，并且在每个浏览器上看起来都不同**。我不知道您使用的是哪一个，但它*不是*Chrome，因为我们确保工具提示不会与鼠标光标重叠。

另一种可能性，如您提到的 jQuery 插件，是编写 Javascript，将每个标题呈现在其自己的不可见 HTML 元素中。然后它通过添加一个 :hover 样式或鼠标事件处理程序使这些工具提示出现。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-24T13:25:55.427

在对此进行了进一步研究后，我在 StackExchange 中发现了几个问题，表明无法修改标题。所以鉴于此：

```
<a title='stuff here' href='#'>Click me!</a> 
```

使用 jscript、css 等操作“这里的东西”部分是不可能的。唯一的选择是使用 jQuery 插件或类似的东西，事实证明这超出了我的故障排除能力。

暂时，我只是在标题前面添加空格来推出文本，如下所示：

```
<a title='     stuff here' href='#'>Click me!</a> 
```

# algorithm - 给定许多水平和垂直线，如何找到其中包含任何子矩形的所有矩形？

> ID：16195714
> 
> 赞同：8
> 
> 时间：2013-04-24T15:13:38.510
> 
> 标签：algorithm, rectangles

我有许多水平和垂直线组成矩形，例如在这个例子中。

![横竖线图片](https://i.stack.imgur.com/WHbBe.png)

是否有一种算法或代码可以定位每个不包含另一个矩形的矩形。我的意思是，这张图片中最大的矩形不是我要找的矩形，因为它里面包含其他矩形。

我正在寻找的矩形必须是空的。我有每条线的起点和终点的列表，例如（a，b）到（c，d）。因此，我想要一个矩形列表 (x,y,w,h) 或等效项。

请注意，有些线的线与它们成直角相交，例如，此图像中最宽矩形的顶线是一条线，它有一条向下相交的垂直线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T17:36:08.713

我认为不同的表示将帮助您解决问题。例如，考虑大矩形（末端没有块）。有四个唯一的 x 和 y 坐标，对它们进行排序和索引。从图形上看，它看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/CDJcF.png)

如果坐标上有一个矩形的角，`(x_i, y_j)`则将其放入矩阵中，如下所示：

```
__|_1__2__3__4_
1 | x  x  0  x
2 | x  x  0  0
3 | 0  x  x  x
4 | x  x  x  x 
```

现在根据定义，真实空间中的矩形是矩阵坐标上的矩形。例如，有一个矩形，`(3,2) (3,4) (4,4), (4,3)`但它不是“基本”矩形，因为它包含一个子矩形`(3,3) (3,4), (4,4), (4,3)`。这里很容易看到递归算法，为了提高速度，请使用记忆化来防止重复计算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T18:04:13.773

[扫线算法](http://en.wikipedia.org/wiki/Sweep_line_algorithm)...

**所需结构：**

*   V = 一组垂直线，按 x 坐标排序。

*   H = 一组水平线的所有起点和终点（并让每个点保持对线的引用）并按 x 坐标排序。

*   *CH =当前*水平线的一组（最初为空）排序（按 y 坐标） 。

*   CR = 一组已排序（按 y 坐标）的*当前*矩形。这些矩形将具有左、上和下坐标，但还没有右坐标。请注意，此集合中不会有重叠。

**算法：**

从左到右同时处理 V 和 H。

每当遇到水平线的起点时，将该线添加到 CH。

每当遇到水平线的末端时，将其从 CH 中删除。

每当遇到垂直线时：

*   从 CR 中删除与该线重叠的所有矩形。对于所有移除的矩形，如果它完全包含在该行内，则将其大小与迄今为止最好的矩形进行比较，如果更好则将其存储。

*   在行的底点和顶点之间迭代地处理 CH 中的每个元素，如下所示：

    *   向 CR 添加一个矩形，最后处理的点为底部，当前点为顶部，垂直线的 y 坐标为左侧。

完毕。

**笔记：**

当水平起点或终点或垂直线的 x 坐标相等时，*必须*保持以下顺序：

```
x of horizontal start < x of vertical line < x of horizontal finish 
```

否则你会错过矩形。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T18:19:08.940

`Computational Geometry`一些标准算法在很大程度上回答了这类问题。我可以`vertical sweep line`为这个特定问题想出一个算法。

假设一个矩形由一对点表示`(p1, p2)`，其中`p1`是左上角，`p2`是右下角。一个点有两个属性（可以访问为`p.x`和`p.y`）。

这是算法。

1.  对所有点对进行排序 -`O(n log n)`
2.  初始化一个名为 的列表`sweep line status`。这将保存到目前为止遇到的所有矩形，即`alive`. 还要初始化另一个名为的列表`event queue`，该列表包含即将发生的事件。这`event queue`目前包含所有矩形的起点。
3.  处理事件，从`event queue`.
    *   如果事件是 a `start point`，则将该矩形添加到`sweep line status`（按 y 坐标排序）（`O(log n)`及时），并将其右下角添加到`event queue`适当位置的 （按点排序）（再次`O(log n)`及时）。当您将它添加到 时`sweep line status`，您只需要检查该点是否位于`sweep line status`. 如果它确实位于内部，则这不是您的矩形，否则，请将其添加到所需矩形列表中。
    *   如果事件是一个端点，只需从`sweep line status`.

运行时间（对于 n 个矩形）：

*   排序需要`O(n log n)`.
*   事件数 = 2*n =`O(n)`
*   每个事件都需要`O(log n)`时间（对于插入`event queue`以及`sweep line status`. 所以总数是`O(n log n)`.

因此，`O(n log n)`。

更多细节请参考[Bentley-Ottmann 算法](http://en.wikipedia.org/wiki/Bentley%E2%80%93Ottmann_algorithm)。以上只是对此的简单修改。

编辑：

刚刚意识到输入是线段，但由于它们总是形成矩形（根据问题），预处理的线性遍历可以将它们转换为矩形（点对）形式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T17:29:17.310

你所有的线都平行于 x 轴还是 y 轴？或者，你所有的线都是平行的还是垂直的？

从您给出的示例中，我假设您的所有线都平行于 x 或 y 轴。在这种情况下，您的行将是 [(a,b), (a,d)] 或 [(a,b), (c,b)]。

无论如何，首要任务是找到角落。那是两条垂直线相交的点的集合。

第二个任务是检测矩形。对于每一对角，您可以检查它们是否形成矩形。

第三个任务是查找矩形内部是否有任何矩形。

对于第一个任务，您需要将线条分成两组：垂直和水平。在那之后排序一组。前任。根据 x 轴坐标对垂直线进行排序。然后你可以取所有水平线并进行二进制搜索以找到所有相交点。

对于第二个任务，考虑每一对角并查看其他两个角是否存在。如果是，则查看是否有连接所有这四个角的线。如果是，你有一个矩形。

对于第三个任务，将所有矩形放在一个区间树中。之后，您可以检查两个矩形是否重叠。

# c - Codechef：反向波兰表示法

> ID：16195721
> 
> 赞同：0
> 
> 时间：2013-04-24T15:13:46.343
> 
> 标签：c, postfix-notation

这是反向波兰符号的代码。当我在 unix 上运行它时，它工作正常，但 codechef 说错误的答案。请帮忙。

```
#include<stdio.h>
#include<string.h>

void push(char);
void pop();

char stack[400];
unsigned long top=0;

int main()
{
    unsigned long len, test_case,i=0,j=0;
    char expr[400];

    scanf("%u\n",&test_case);

    for(;j<test_case;j++)
    {
        scanf("%s\n",expr);
        len=strlen(expr);

        for(;i<len;i++)
        {
            if(expr[i]=='+'||expr[i]=='-'||expr[i]=='*'||expr[i]=='/'||expr[i]=='^')
                push(expr[i]);

            else if(expr[i]==')')
            {
                pop();
            }

            else if(expr[i]=='(')
                continue;

            else
                printf("%c",expr[i]);
        }
    }

    return 0;
}

void pop()
{
    if(top==-1)
        return;
    else
    {
        printf("%c",stack[top]);
        top=top-1; 
    }
}

void push(char x)
{
    if(top==400)
        return;
    else
    {
        stack[++top]=x;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-07T07:55:19.373

更改此行

```
 for(;i<len;i++) 
```

至

```
for(i=0;i<len;i++) 
```

然后它会正常工作。在 codechef 中有很多测试用例，所以在你的程序中，它对于第一个测试用例可以正常工作，但在那之后它会失败，因为第二个测试用例中的 'i' 的值将从它在第一个用例结束的地方开始。因此，您必须在每个测试用例中初始化 i 的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-12T17:08:37.130

我经历了同样的情况，这是我解决这个问题的方法：

```
#include<stdio.h>
#include<string.h>

char stack[400];
unsigned long top = 0;

void pop() {
    if (top == -1) {
        return;
    } else {
        printf("%c",stack[top]);
        top = top - 1;
    }
}

void push(char x) {
    if (top == 400) {
        return;
    } else {
        stack[++top] = x;
    }
}

int main() {

    unsigned long t, n, i = 0, j = 0;
    char a[400];
    scanf("%lu", &t);

    while(t--) {
        scanf("%s", &a);
        n = strlen(a);
        for (i = 0; i < n; i++) {
            if (a[i] == '+' || a[i] == '-' || a[i] == '*' || a[i] == '/' || a[i] == '^') {
                push(a[i]);
            } else if (a[i] == ')') {
                pop();
            } else if (a[i] == '(') {
                continue;
            } else {
                printf("%c", a[i]);
            }
        }
        printf("\n");
    }

    return 0;
} 
```

你错过了写一些部分，还有另一个符号以及 +、-、* 和 / 即 ^，这也是评估答案所必需的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-07T06:41:00.380

你必须初始化 unsigned long i = 0 ；在 for 循环中，就好像您采用两个或多个测试用例一样，我将从上一个案例中的每个下一个案例的位置开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T16:01:16.700

暂时唯一注意到的地方

```
`scanf("%u\n",&test_case);` //"%u" for unsigned not unsigned long

`scanf("%s\n",expr);` //%s : newline to not input are separated by white space 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-20T13:52:40.347

添加

```
top=0;
stack[0]=0; 
```

**`for`**在函数中**结束****循环**`main`并更改
`for(;i<len;i++)`为`for(i=0;i<len;i++)`.

# ajax - 在发布方法期间防止 IE 中的 ajax 请求缓存

> ID：16195726
> 
> 赞同：2
> 
> 时间：2013-04-24T15:14:07.537
> 
> 标签：ajax, caching, request

如何防止IE缓存发送到服务器的请求？

我尝试在 https 响应对象中设置 ("Cache-Control: no-cache)，但 IE 仍在缓存我的请求数据。

请在下面找到 tmy 项目详细信息：

在我的应用程序中，我正在向服务器发送登录请求。因此，在我登录后，如果我使用 winHex 工具进行内存转储，我就可以在内存中获取密码详细信息。

1.  我也在清除对话框刷新，但请求数据仍然被缓存。

请为此建议我一些工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:18:57.927

您可以尝试使用随机值向您的 URL 添加参数，这将防止 URL 始终相同。

例子：

*普通网址：*

```
www.test.com/test.php 
```

*伪造不同的网址：*

```
www.test.com/test.php?_dc=12353somerandomval 
```

确保`_dc`参数始终具有不同的值，您可以（例如）为此使用 JavaScript 日期对象（它以毫秒为单位返回当前时间，实际上总是不同的）：

```
params: {
    _dc : new Date().getTime()
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:18:33.917

在我不久前做的一个项目中，我遇到了完全相同的问题，我四处搜索并看到一些建议在请求中添加时间戳的东西，这也确实有效，但这是最适合我的优雅方式。

```
$('document').ready(function () {            
    $.ajaxSetup({
        cache: false
    });
}); 
```

# android - CursorAdapter：getCount() == 0，mCu rsor.getCount() == 6

> ID：16195728
> 
> 赞同：0
> 
> 时间：2013-04-24T15:14:12.863
> 
> 标签：android, android-cursoradapter

我有一个包装 a 的适配器，`CursorAdapter`原因是我需要在行中显示项目（如在 a 中`GridView`），但如果在下面的面板中单击（需要 a `ListView`），还需要显示每个项目的详细信息。因此，我没有`CursorAdapter`直接填充`ListView`，而是有一个内部适配器：

```
public class ChallengeAdapter extends BaseAdapter {

    class ChallengeDataAdapter extends CursorAdapter {

        private BaseAdapter mChallengeAdapter;

        public ChallengeDataAdapter(Context context, Cursor cursor, BaseAdapter a) {
            super(context, cursor, CursorAdapter.FLAG_REGISTER_CONTENT_OBSERVER);
            mChallengeAdapter = a;
        }

        @Override
        public void bindView(View arg0, Context arg1, Cursor arg2) {
            // TODO Auto-generated method stub

        }

        @Override
        public View newView(Context arg0, Cursor arg1, ViewGroup arg2) {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        protected void onContentChanged() {
            super.onContentChanged();
            mChallengeAdapter.notifyDataSetChanged();
        }

    }

    private ChallengeDataAdapter mDataAdapter;

    public ChallengeAdapter(Context context, Cursor cursor) {
        mDataAdapter = new ChallengeDataAdapter(context, cursor, this);
    }

    @Override
    public int getCount() {
        return (mDataAdapter.getCount() + ChallengeMultiTile.ROW_SIZE - 1) / ChallengeMultiTile.ROW_SIZE; //integer divide rounds down
    }

    @Override
    public Object getItem(int position) {
        Challenge[] output = new Challenge[ChallengeMultiTile.ROW_SIZE];
        int min = position * ChallengeMultiTile.ROW_SIZE;
        int max = Math.min(position * ChallengeMultiTile.ROW_SIZE + ChallengeMultiTile.ROW_SIZE, mDataAdapter.getCount());
        for(int i=min; i<max; ++i) {
            output[i-min] = Challenge.get((Cursor) mDataAdapter.getItem(i));
        }
        return output;
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        if(convertView==null) {
            convertView = new ChallengeMultiTile(parent.getContext());
        }
        ((ChallengeMultiTile) convertView).populate((Challenge[]) getItem(position));
        convertView.setBackgroundColor(0xfffffff);
        return convertView;
    }

    public void swapCursor(Cursor cursor) {
        mDataAdapter.swapCursor(cursor);
        notifyDataSetChanged();
    }

} 
```

这短暂地起作用，但随后`ChallengeDataAdapter`开始具有`getCount()`零。但是，我在那里放了一个断点，并且`ChallengeDataAdapter#mCursor.getCount()`是 6。我把它困在了`onContentChanged()`方法中，但我不确定它是在哪里发生的。

`CursorAdapter`当内部光标的计数为六时，为什么计数为零？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:57:00.570

当您查看 CursorAdapter 源代码时，您会看到 getCount() 和 onContentChanged() 的以下内容：

```
public int getCount() {
    if (mDataValid && mCursor != null) {
        return mCursor.getCount();
    } else {
        return 0;
    }
}

protected void onContentChanged() {
    if (mAutoRequery && mCursor != null && !mCursor.isClosed()) {
        if (false) Log.v("Cursor", "Auto requerying " + mCursor + " due to update");
        mDataValid = mCursor.requery();
    }
} 
```

因此，虽然 mCursor.getCount() 可能返回 6，但如果重新查询失败， getCount() 可能返回 0。为什么重新查询失败是另一个问题，而不是我可以从您发布的代码中回答的问题。

顺便说一句，您不需要在 ChallengeDataAdapter 类中保留对 ChallengeAdapter 的引用。ChallengeDataAdapter 是一个内部类，它与其封闭类的实例相关联，并且可以直接访问该对象的方法和字段。而不是调用 mChallengeAdapter.notifyDataSetChanged() 你可以做一个 ChallengeAdapter.this.notifyDataSetChanged();

# git - Git：列出所有带有假设不变标志的文件

> ID：16195729
> 
> 赞同：11
> 
> 时间：2013-04-24T15:14:18.557
> 
> 标签：git

我需要假设未更改标志来避免我的项目设置文件的错误提交。我通过以下方式做到这一点：

```
git update-index --assume-unchanged <file> 
```

还有一种方法可以使用 --no-assume-unchanged 禁用它。

现在我以这种方式添加了 5 个文件，随后决定用反标志再次添加其中一些文件。

有没有办法列出所有这些声明为“假定不变”的文件？

非常感谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-24T16:07:20.483

您可以使用较低级别的命令`ls-files`：

```
% git ls-files -v
h a.txt
H b.txt 
```

如果第一个字符是小写的，它被标记为“假设不变”，在这种情况下`a.txt`。另请参见[ls-files 的手册页](http://git-scm.com/docs/git-ls-files)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-08T22:20:42.667

根据手册页[`git update-index`](https://git-scm.com/docs/git-update-index)：

> 要查看哪些文件设置了“假定未更改”位，请使用 git ls-files -v。

并根据手册页[`git ls-files`](https://git-scm.com/docs/git-ls-files)：

> -v
> 
> [...] 对标记为假定未更改的文件使用小写字母

因此，为了将所有文件标记为假定不变，请使用：

```
ls-files -v | egrep -r "^[a-z] .*" 
```

# sql-server-2008 - LINQ to SQL 分页性能随着行数的增加而降低

> ID：16195735
> 
> 赞同：0
> 
> 时间：2013-04-24T15:14:27.283
> 
> 标签：sql-server-2008, optimization, linq-to-sql

我有一个带有返回大量行的视图的 SQL Server 数据库。在我的项目中，LinqToSql 正在对视图进行排序和分页，以显示在数据网格中。

加载第一页的性能是可以接受的，但是随着分页深入到视图中，加载每个页面的速度会降低。到达视图的最后一页，加载页面需要很长时间。

linq-to-sql to page生成的SQL是

```
SELECT [t1].[Client Id]
       ...
FROM  (SELECT ROW_NUMBER() OVER (ORDER BY [t0].[Last Name]) AS [ROW_NUMBER],
              [t0].[Client Id],
              ...
       FROM [dbo].[View_MemberEligibilitySearch] AS [t0]) AS [t1]
       WHERE [t1].[ROW_NUMBER] BETWEEN 50 /* @p0 */ + 1 AND 50 /* @p0 */ + 15 /* @p1 */
       ORDER BY [t1].[ROW_NUMBER] 
```

有什么方法可以从 SQL Server 的角度进行优化？用于生成视图的表中已经有所有需要的索引。是否可以将索引添加到视图本身以提高此类查询的性能？

我意识到这个问题可以通过不使用视图来解决，但我正在寻找不需要大量代码更改的东西。

有什么方法可以通过 Linq-To-Sql 进行分页视图有效吗？

编辑

更多细节。该视图当前有 350k 条记录。
前 10 秒需要 0 秒，最后需要 15 秒。时间与选择全桌类似。

执行计划对具有相同 350k 记录的表的聚集索引扫描占 99%。（视图的所有其他部分都是查找表，它们几乎不需要时间，因为它们来自主键）

这个问题可以在任何 View 上重现 create a view from select * from MyBigTable

LinqToSql 调用中的映射表

MyTable.Skip(100000).Take(10)

# ruby-on-rails - 需要解释 ruby gem 加载过程。不是铁轨，只是普通的红宝石。一些宝石被加载，而另一些则不被加载。为什么？

> ID：16195736
> 
> 赞同：-4
> 
> 时间：2013-04-24T15:14:27.583
> 
> 标签：ruby-on-rails, ruby, activerecord, capistrano

Ruby 在使用宝石时是如此神秘！这些宝石在哪里？在 Java 中，您可以拥有任意数量的 jar，只需将它们包含在 CLASSPATH 中即可。Ruby 是一种更简单的语言，但为什么我需要为处理简单的废话而头疼呢？谁能认真地解释一下宝石加载过程是如何工作的？似乎没有人真正知道为什么需要一些 gems 才能工作，而即使您安装了 gems 并且它们在 gem 列表中，也不需要其他人。这个网站上的ruby权威在哪里，最终可以澄清gem加载过程。

我尝试在我的 ruby​​ 脚本中包含“rubygems”以防止出现类似错误`LoadError: no such file to load -- pony`

即使我的脚本中确实需要“rubygems”，它仍然会给出 LoadErrors。即使宝石在我的宝石列表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:28:36.720

当您使用[Bundler](http://gembundler.com)管理项目中的 Gems 时（您将在项目`Gemfile`的根目录中有一个），请务必运行

```
bundle install 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T17:14:44.220

需要 ruby​​gems 只加载 ruby​​gems 本身（在 ruby​​ 1.9 及更高版本中不需要）

您需要通过`require`.

如果您使用 bundler，那么您可以选择让 bundle auto 需要 Gemfile 中的所有内容

# c# - 将pdf流式传输到浏览器，怎么做？

> ID：16195737
> 
> 赞同：-3
> 
> 时间：2013-04-24T15:14:30.113
> 
> 标签：c#, asp.net, pdf

谁能告诉我如何将pdf流式传输到新的标签浏览器？我的内存中只有 pdf 流，当我点击链接时，我想在新选项卡或窗口浏览器中显示 PDF。我怎样才能做到这一点？提前致谢！

我有这个链接：

```
<a id="hrefPdf" runat="server" href="#" target="_blank">
    <asp:Literal ID="PdfName" runat="server"></asp:Literal>
</a> 
```

在上面的代码中，我有这个`onload`事件：

```
Stream pdf= getPdf

if (pdf != null)
{
    SetLinkPDF(pdf);
}

private void SetLinkPDF(IFile pdf)
{
    hrefPdf.href = "MyPDF to the Browser"
    PdfName.Text = pdf.PdfName;      
} 
```

不知何故，我必须处理流 pdf（IFile 包含 PDF 的名称、流、元数据等）

我可以做些什么来处理这个以及当我单击在新浏览器中显示流时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:19:55.243

```
Response.Clear();

Response.ClearHeaders();

Response.ClearContent();

Response.AddHeader("Content-Disposition", "attachment; filename=" + file.Name);

Response.AddHeader("Content-Length", file.Length.ToString());

Response.ContentType = "application/pdf";

Response.Flush();

Response.TransmitFile(file.FullName);

Response.End(); 
```

# php - .htaccess 如果匹配，则将“外部”子域重写到子文件夹

> ID：16195741
> 
> 赞同：0
> 
> 时间：2013-04-24T15:14:35.380
> 
> 标签：php, regex, .htaccess, mod-rewrite, url-rewriting

假设我在外部域上有通配符子域，可以是任何东西

demo.site1.com

blah.site1.com

并在外部网站上有这样的目录

external.com/websites/demo.site1.com

external.com/websites/blah.site1.com

我想做到这一点，以便让我们说 demo.site1.com 的所有请求都应该重写为

external.com/websites/demo.site1.com 如果子目录匹配 demo.site1.com

没有重定向，我必须保持 URL 相同...

我必须对具有相同类型子目录的多个子域执行此操作。

可以做吗？？如果不是，是否可以不匹配？？？

在过去的 12 小时里，我一遍又一遍地阅读 apache .htaccess 文档，但似乎无法阅读

想办法怎么做。

你的帮助对我来说意义重大...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:17:25.187

您应该在域管理面板中配置您的域以指向该地址。

如果您无权访问它们，请使用 iframe，但据我所知 .htaccess 不提供这种功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:45:41.153

尝试这个。把它放在`site1.com`文档根目录的 htaccess 中。仅当两个域都有权一起访问时才有效

```
 RewriteEngine On
 RewriteCond %{HTTP_HOST} ^(.*)\.site1.com/(.*)$
 RewriteRule ^(.*)$ external.com/websites/$1.site1.com/$2 [L] 
```

# c++ - 同步查找满足给定模板的元组

> ID：16195742
> 
> 赞同：1
> 
> 时间：2013-04-24T15:14:41.170
> 
> 标签：c++, synchronization, posix, shared-memory, semaphore

```
Tuple read(Template template) 
```

获取一个元组的模板作为参数，并从缓冲区（共享内存）返回一个满足模板的元组。

```
void write(Tuple tuple) 
```

将元组写入共享内存。当共享内存中没有满足模板的元组时，读取函数应该进入休眠状态。当添加适当的元组时，写入应该首先唤醒睡眠进程。

我已经拥有的：

```
Tuple read(Template template)
{
  Tuple result;
  down(empty);
  int uniqSem = register(template);
  down(buffMutex);
  Tuple *tuple = find(template);

  if(tuple != null_ptr)
  {
    result = *tuple;
    remove(tuple);
    up(uniqSem);
  }

  up(buffMutex);
  down(uniqSem);
  unregister(uniqSem);

  return result;
} 
```

当没有满足模板的元组时，这将不起作用。然后该过程将进入休眠状态并且不会获得结果模板。如何重新实现读取功能并实现写入功能以使其工作？

# android - 在一项活动中创建多个上下文菜单

> ID：16195745
> 
> 赞同：6
> 
> 时间：2013-04-24T15:14:45.717
> 
> 标签：android

嗨，我正在尝试在一项活动中制作多个上下文菜单。有两个按钮，我想为每个按钮创建不同的上下文菜单。任何人都可以建议我或向我推荐一些工作示例吗？

这是我当前的代码的样子。

```
registerForContextMenu(btn_1);
registerForContextMenu(btn_2);

btn_1.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {

        openContextMenu(v);
    }   
});

btn_2.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {

        openContextMenu(v);
    }   

});

    }

@Override
public void onCreateContextMenu(ContextMenu menu, View v,ContextMenu.ContextMenuInfo menuInfo) {
        super.onCreateContextMenu(menu, v, menuInfo);
        getMenuInflater().inflate(R.menu.media_menu, menu);
        menu.setHeaderTitle("Context menu for btn_1");
        menu.setHeaderIcon(R.drawable.icon_media_up); 
}

@Override
public boolean onContextItemSelected(MenuItem item) {
        switch(item.getItemId()) {
            case R.id.photo:
                Toast.makeText(this, "One", Toast.LENGTH_SHORT).show();
                return true;
            case R.id.video:
                Toast.makeText(this, "Two", Toast.LENGTH_SHORT).show();
                return true;
            case R.id.audio:
                Toast.makeText(this, "Three", Toast.LENGTH_SHORT).show();
                return true;
            }
        return super.onContextItemSelected(item);
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-24T15:19:11.617

你必须在你的`onCreateContextMenu`方法中处理这个。有一个参数`View`是您单击的视图。因此，通过使用该参数，您可以扩展不同的菜单。例如

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v,ContextMenu.ContextMenuInfo menuInfo) {
        super.onCreateContextMenu(menu, v, menuInfo);
        if(v.getId() == R.id.first_button)
             inflate one menu
        else if(v.getId() == R.id.second_button)
             inflate another menu        
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-15T08:30:06.910

### 这是工作解决方案

```
 @Override
    public void onCreateContextMenu(ContextMenu menu, View v,
            ContextMenuInfo menuInfo) {
        // TODO Auto-generated method stub
        super.onCreateContextMenu(menu, v, menuInfo);

     MenuInflater menuiflatr=getMenuInflater();
         if(v.getId() == R.id.ChooseSession){

        menuiflatr.inflate(R.menu.session_menu, menu);
         menu.setHeaderTitle("Choose Session Type");
         menu.setHeaderIcon(R.drawable.ic_launcher);
         MenuItem item_individual=menu.findItem(R.id.individual);
         MenuItem item_group=menu.findItem(R.id.group);
         if(itemselection_for_sessiontype==1)item_individual.setChecked(true);
         else if(itemselection_for_sessiontype==2)item_group.setChecked(true);
    }
        else if(v.getId() == R.id.ChooseTrajectory){
             //inflate another menu     
             menuiflatr.inflate(R.menu.trajectory_menu, menu);
             menu.setHeaderTitle("Enable Trajectory");
             menu.setHeaderIcon(R.drawable.ic_launcher);
             MenuItem item_On=menu.findItem(R.id.on);
             MenuItem item_Off=menu.findItem(R.id.off);
             if(itemselection_for_trajectory==1)item_On.setChecked(true);
             else if(itemselection_for_trajectory==2)item_Off.setChecked(true);
    }
        else if(v.getId() == R.id.ChooseMapeType){
            //inflate another menu     
            menuiflatr.inflate(R.menu.maptype_menu, menu);
            menu.setHeaderTitle("Choose Map Type");
         menu.setHeaderIcon(R.drawable.ic_launcher);
       }
   }`
  `
     @Override
     public boolean onContextItemSelected(MenuItem item) {
        switch(item.getItemId()){
        case R.id.individual:
            Toast.makeText(this, "Session Type Individual selected!",     `   `Toast.LENGTH_SHORT).show();
            item.setChecked(true);
            itemselection_for_sessiontype=1;
            return true;

    case R.id.group:
        Toast.makeText(this, "Session Type Group selected!", Toast.LENGTH_SHORT).show();
        item.setChecked(true);
        itemselection_for_sessiontype=2;
        return true;

    case R.id.on:
        Toast.makeText(this, "Trajectory Mode Enabled", Toast.LENGTH_SHORT).show();
        item.setChecked(true);
        itemselection_for_trajectory=1;
        return true;

    case R.id.off:
        Toast.makeText(this, "Trajectory Mode Disabled!",               Toast.LENGTH_SHORT).show();
        item.setChecked(true);
        itemselection_for_trajectory=2;
        return true;
    }

    return super.onContextItemSelected(item);
    }

    public void selectSession(View view){
        registerForContextMenu(view);

        openContextMenu(view);
    } 
```

# r - 将字符拆分为数据框中的两个变量

> ID：16195746
> 
> 赞同：11
> 
> 时间：2013-04-24T15:14:49.257
> 
> 标签：r, reshape2

假设我有一个这样的变量向量：

```
>variable
[1] "A1" "A1" "A1" "A1" "A2" "A2" "A2" "A2" "B1" "B1" "B1" "B1" 
```

我想把它转换成这样的数据框：

```
 treatment time
1         A    1
2         A    1
3         A    1
4         A    1
5         A    2
6         A    2
7         A    2
8         A    2
9         B    1
10        B    1
11        B    1
12        B    1 
```

为此，我使用了 reshape2 的 colsplit 函数。它需要一个模式来分割字符串，但我很快意识到没有明显的模式来分割两个字符而没有任何空格。我尝试了“”并得到以下结果：

```
> colsplit(trialm$variable,"",names=c("treatment","time"))
   treatment time
1         NA   A1
2         NA   A1
3         NA   A1
4         NA   A1
5         NA   A2
6         NA   A2
7         NA   A2
8         NA   A2
9         NA   B1
10        NA   B1
11        NA   B1
12        NA   B1 
```

我还尝试了一个lookbehind或lookahead正则表达式：

```
>colsplit(trialm$variable,"(?<=\\w)",names=c("treatment","time"))
Error in gregexpr("(?<=\\w)", c("A1", "A1", "A1", "A1", "A2", "A2", "A2",  : 
  invalid regular expression '(?<=\w)', reason 'Invalid regexp' 
```

但它给了我上述错误。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-24T16:26:19.737

## 更新：2017 年 12 月 24 日

在某个地方，“stringr”包（使用“reshape2”导入并负责使用 进行的拆分`colsplit`）开始将“stringi”用于其几个功能。一些行为似乎因此而改变。

使用当前的“reshape2”（和当前的“stringr”包），`colsplit`按照您对代码的预期方式工作：

```
packageVersion("reshape2")
## [1] ‘1.4.3’
packageVersion("stringr")
## [1] ‘1.2.0’

colsplit(variable, "", names = c("treatment", "time"))
##    treatment time
## 1          A    1
## 2          A    1
## 3          A    1
## 4          A    1
## 5          A    2
## 6          A    2
## 7          A    2
## 8          A    2
## 9          B    1
## 10         B    1
## 11         B    1
## 12         B    1 
```

## 原始答案：2013 年 4 月 24 日

如果可以在您的“变量”中检测到一种模式，但没有可以使用的干净分割字符，则添加一个 :)

```
library(reshape2)
variable <- c("A1", "A1", "A1", "A1", "A2", "A2", 
              "A2", "A2", "B1", "B1", "B1", "B1")
## Here, we add a "." between upper case letters and numbers
colsplit(gsub("([A-Z])([0-9])", "\\1\\.\\2", variable), 
         "\\.", c("Treatment", "Time"))
#    Treatment Time
# 1          A    1
# 2          A    1
# 3          A    1
# 4          A    1
# 5          A    2
# ::::: snip :::: #
# 11         B    1
# 12         B    1 
```

* * *

## 附加选项：2017 年 12 月 23 日

我的“splitstackshape”包有一个单一用途的非导出辅助函数`NoSep`，可以用于此：

```
splitstackshape:::NoSep(variable)
##    .var .time_1
## 1     A       1
## 2     A       1
## 3     A       1
## 4     A       1
## 5     A       2
## ::: snip :::: #
## 11    B       1
## 12    B       1 
```

* * *

“tidyverse”（特别是“tidyr”包）有几个方便的函数用于将值拆分到不同的列中：`separate`和`extract`. [jazzuro 已经演示过](https://stackoverflow.com/a/28314421/1270695)`separate`，但解决方案是针对这个特定问题的。此外，它通常与分隔符一起工作得更好。期望您使用要捕获的组指定正则表达式：`extract`

```
library(tidyverse)
data.frame(variable) %>% 
  extract(variable, into = c("Treatment", "Time"), regex = "([A-Z]+)([0-9]+)")
#    Treatment Time
# 1          A    1
# 2          A    1
# 3          A    1
# 4          A    1
# 5          A    2
# ::::: snip :::: #
# 11         B    1
# 12         B    1 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-24T15:24:39.797

`substr`是另一种方法。

```
> variable <- c(rep("A1", 4), rep("A2", 4), rep("B1", 4))
> data.frame(treatment=substr(variable, 1,1), time=as.numeric(substr(variable,2,2)))
   treatmen time
1         A    1
2         A    1
3         A    1
4         A    1
5         A    2
6         A    2
7         A    2
8         A    2
9         B    1
10        B    1
11        B    1
12        B    1 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-02-04T05:55:42.140

如果您使用矢量创建数据框`variable`，您现在可以`separate()`从`tidyr`包中使用。

```
mydf <- data.frame(variable = c(rep("A1", 4), rep("A2", 4), rep("B1", 4)),
                   stringsAsFactors = FALSE)

separate(mydf, variable, c("treatement", "time"), sep = 1)

#   treatement time
#1           A    1
#2           A    1
#3           A    1
#4           A    1
#5           A    2
#6           A    2
#7           A    2
#8           A    2
#9           B    1
#10          B    1
#11          B    1
#12          B    1 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-24T15:24:51.640

您可以使用`substr`它来拆分它：

例如

```
df <- data.frame(treatment =   substr(variable, start = 1, stop = 1),
                 time =        substr(variable, start = 2, stop = 2) ) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-02-04T08:34:38.707

`tstrsplit()`中引入了一个新功能`data.table v1.9.5`。`t`代表转*置*。这是将字符向量拆分 `strsplit()`然后*转置*的结果。

```
# dummy data
library(data.table)
dt <- data.table(var = c(rep("A1", 4), rep("A2", 4), rep("B1", 4))) 
```

使用`tstrsplit()`：

```
dt[, tstrsplit(var, "")]

    V1 V2
 1:  A  1
 2:  A  1
 3:  A  1
 4:  A  1
 5:  A  2
 6:  A  2
 7:  A  2
 8:  A  2
 9:  B  1
10:  B  1
11:  B  1
12:  B  1 
```

是的，就是这么简单。:-)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-04-24T15:28:50.307

使用正则表达式的另一种解决方案

```
require(stringr)
variable <- c(paste0("A", c(rep(1, 4), rep(2, 3))),
              paste0("B", rep(1, 4))
              )

data.frame(
    treatment = str_extract(variable, "[[:alpha:]]"),
    time = as.numeric(str_extract(variable, "[[:digit:]]"))
    )

##    treatment time
## 1          A    1
## 2          A    1
## 3          A    1
## 4          A    1
## 5          A    2
## 6          A    2
## 7          A    2
## 8          B    1
## 9          B    1
## 10         B    1
## 11         B    1 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-04-24T15:26:47.633

您可以使用 substring() 创建向量，然后使用 data.frame 函数连接它们。

```
yyy<-c("A1", "A1", "A1", "A1", "A2", "A2", "A2", "A2", "B1", "B1", "B1", "B1")

treatment<-substring(yyy, 1,1)

time<-as.numeric(substring(yyy,2,2))

data.frame(treatment,time) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-04-24T15:21:00.280

你可以使用`strsplit`

```
df <- t(data.frame(strsplit(variable, "")))
rownames(df) <- NULL
colnames(df) <- c("treatment" , "time" )
df
      treatment time
 [1,] "A"       "1" 
 [2,] "A"       "1" 
 [3,] "A"       "1" 
 [4,] "A"       "1" 
 [5,] "A"       "2" 
 [6,] "A"       "2" 
 [7,] "A"       "2" 
 [8,] "A"       "2" 
 [9,] "B"       "1" 
[10,] "B"       "1" 
[11,] "B"       "1" 
[12,] "B"       "1" 
```

* * *

而不是使用`t`，您可以使用`rbind`然后强制`data.frame`如下：

```
setNames(as.data.frame(do.call(rbind, strsplit(variable, ""))), 
         c("Treatment", "Time"))
#    Treatment Time
# 1          A    1
# 2          A    1
# 3          A    1
# 4          A    1
# 5          A    2
# 6          A    2
# 7          A    2
# 8          B    1
# 9          B    1
# 10         B    1
# 11         B    1 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-04-11T11:25:00.273

根据@Justin 的评论，我建议这样做（使用`v <- c("A1", "B2")`）：

```
> t(sapply(strsplit(v, ''), '[', c(1, 2)))
     [,1] [,2]
[1,] "A"  "1" 
[2,] "B"  "2" 
```

`'[' 之后的向量从分割向量中选择项目。所以我只分裂了一次，保留了两个项目。如果您想保留每个项目，这可能会更容易：

```
t(sapply(strsplit(v, ''), identity)) 
```

# java - 从 HashMap 填充类属性

> ID：16195754
> 
> 赞同：3
> 
> 时间：2013-04-24T15:15:08.040
> 
> 标签：java

我想将 HashMap 中的项目转换为类的属性。有没有办法在不手动映射每个字段的情况下做到这一点？我知道使用 Jackson，我可以将所有内容转换为 JSON，然后再转换为`GetDashboard.class`正确设置属性的 JSON。这显然不是一种有效的方法。

数据：

```
HashMap<String, Object> data = new HashMap<String, Object>();
data.put("workstationUuid", "asdfj32l4kjlkaslkdjflkj34"); 
```

班级：

```
public class GetDashboard implements EventHandler<Dashboard> {
    public String workstationUuid; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:25:26.200

如果你想自己做：

假设类

```
public class GetDashboard {
    private String workstationUuid;
    private int id;

    public String toString() {
        return "workstationUuid: " + workstationUuid + ", id: " + id;
    }
} 
```

以下

```
// populate your map
HashMap<String, Object> data = new HashMap<String, Object>(); 
data.put("workstationUuid", "asdfj32l4kjlkaslkdjflkj34");
data.put("id", 123);
data.put("asdas", "Asdasd"); // this field does not appear in your class

Class<?> clazz = GetDashboard.class;
GetDashboard dashboard = new GetDashboard();
for (Entry<String, Object> entry : data.entrySet()) {
    try {
        Field field = clazz.getDeclaredField(entry.getKey()); //get the field by name
        if (field != null) {
            field.setAccessible(true); // for private fields
            field.set(dashboard, entry.getValue()); // set the field's value for your object
        }
    } catch (NoSuchFieldException | SecurityException e) {
        e.printStackTrace();
        // handle
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
        // handle
    } catch (IllegalAccessException e) {
        e.printStackTrace();
        // handle
    }
} 
```

将打印（做任何你想做的事，除了）

```
java.lang.NoSuchFieldException: asdas
    at java.lang.Class.getDeclaredField(Unknown Source)
    at testing.Main.main(Main.java:100)
workstationUuid: asdfj32l4kjlkaslkdjflkj34, id: 123 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:23:05.587

尝试 Apache Commons BeanUtils [http://commons.apache.org/proper/commons-beanutils/](http://commons.apache.org/proper/commons-beanutils/)

`BeanUtils.populate(Object bean, Map properties)`

# view - Dojo：从视图中提取数据以在 xpages 中绘制折线图

> ID：16195756
> 
> 赞同：0
> 
> 时间：2013-04-24T15:15:09.047
> 
> 标签：view, dojo, plot, xpages

我正在尝试在 xpages 中使用 dojo 绘制折线图。我有一个脚本库，其中包含从称为 plots 的视图中获取值的代码（该视图分别在两个不同的列中包含 x 和 y 轴的时间和温度值）。我正在尝试将这些值放入 JSON 中，然后提取它们以绘制图形。

这部分脚本库应该将视图中的值转换为 JSON

```
 var vw = database.getView('plots');
  var vwEntries = vw.getAllEntries();
  var Count = vwEntries.getCount();
  var vwEntry = vwEntries.getFirstEntry();

 var plot_temp = vwEntry.getColumnValues().elementAt(1);
 var plot_time = vwEntry.getColumnValues().elementAt(2);

  for (var x=1; x < vwCount; x++){

      var vwEntry = vwEntries.getNextEntry(vwEntry);
      plot_temp = plot_temp+","+vwEntry.getColumnValues().elementAt(1);
      plot_time = plot_time+","+vwEntry.getColumnValues().elementAt(2);
  }      

 getComponent("extracted_temp").setValue("["+plot_temp+"]");
 getComponent("extracted_time").setValue("["+plot_time+"]"); 
```

脚本库的其余部分包含绘制图形的代码，但我不确定使用什么命令来绘制 JSON 值。

到目前为止，它不起作用。这就是我尝试绘制图表的方式。它不起作用。

`chart1.addSeries("Series 1", [ vw ], {stroke: {color: "green"}});`

我在页面上还有一个指定绘图大小的 div。

我曾尝试使用 D3 和 jqplot，但我发现 dojo 可能是最容易使用的。如果我对数据进行硬编码，但不能从视图中绘制，我可以绘制数据。我在从视图中提取数据并将其放入图表时遇到问题。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:53:10.773

您可以尝试更多图形库:-)

在 openNTF 上有一个现成的用于 Dojo 图形[的自定义控件。](http://www.openntf.org/Internal/home.nsf/project.xsp?action=openDocument&name=YouAtNotes%20xCharting)你可以从那个开始。

您似乎面临的重复问题是如何将后端数据导入前端 JavaScript。一旦你掌握了这一点，你就可以使用任何库。所有库都提供了 2 种方法：“静态”值（硬编码时使用的）或 Ajax 查找。

以下是您应该采取的步骤：

1.  创建一个您想在自定义控件中看到的静态图形 - 确保它工作正常
2.  将页面上只有静态的 JS 代码移动到 xp:outputScript 控件中（静态很好） - 确保它工作正常
3.  将自定义控件属性中要更改的所有值（核心数据、标签或其他）定义为变量。例如数据、xAxisLabel、yAxisLabel - 将它们定义为字符串！
4.  在放置自定义控件的页面上，将自定义属性的值作为静态值输入
5.  现在在您的 outputScript 标记中，用参数替换您的静态值 - 确保它工作正常。样本：

**旧的**（你的工作代码 - 不管它是什么）：

```
 var data = [{label : "test", value : 7}, {label : "x", value : 8}]; 
```

**新**：

```
 var data = #{compositeData.data}; 
```

现在测试一下。您的图表必须正确显示 - 否则您错过/搞砸了一步。

1.  最后一步：在页面上，将自定义控件属性中的静态值替换为生成与您输入的静态字符串完全相同的字符串所需的任何代码。

如何做到这一点还有更多变体，一般的想法是 outputScript 标签与 #{EL} 表达式的组合。不要一口气尝试所有这些。逐步验证该步骤是否有效。否则你无法确定它失败的地方。

让我们知道怎么回事

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-28T11:02:47.830

我通过使用 jqplot 找到了解决问题的方法。我得到了我的图表并且没有使用 dojo 或脚本库。它绘制了一个同样漂亮的图表。我从 [这个网站](http://blog.wilhow.net/2013/03/17/charting-104-in-xpages-connecting-to-notes-document/)得到了这个想法 。为了获得绘制我需要的图形的代码，我对提取代码按钮进行了一些修改，并将提取数据和重新绘制按钮合二为一（通过删除部分更新元素 ID），因此代码如下所示

```
var viewPanel = getComponent("viewPanel1"); //in the view panel select the check box
var docIDArray = viewPanel.getSelectedIds(); //get that selected ID

for (i = 0; i < docIDArray.length; i++) {
var docId = docIDArray[i];
var doc = database.getDocumentByID(docId);
var moo = doc.getItemValue("LoggerID"); //selected ID is defined
var h = doc.getItemValue("G");
var e = doc.getItemValue("IE");
var f = doc.getItemValue("FF");
var c = doc.getItemValue("CH");
var s = doc.getItemValue("SA");
var o = doc.getItemValue("OP");
var l = doc.getItemValue("LM");

//comparing the entries to the selected ID and if found extracting the values for LoggerID

var vw = database.getView('BrowserStats'); //Get the Notesview
var vwEntries = vw.getAllEntries(); //Get handle of all entries
var vwCount = vwEntries.getCount(); //Get the Count to use as uBound
var vwEntry = vwEntries.getFirstEntry(); //Get first value

//Get the first entry and get the column value of the first entry

var plot_LoggerID = vwEntry.getColumnValues().elementAt(2);
var plot_G = vwEntry.getColumnValues().elementAt(5);    
var plot_IE = vwEntry.getColumnValues().elementAt(6);    
var plot_FF = vwEntry.getColumnValues().elementAt(7);    
var plot_CH = vwEntry.getColumnValues().elementAt(8);    
var plot_SA = vwEntry.getColumnValues().elementAt(9);
var plot_OP = vwEntry.getColumnValues().elementAt(10);    
var plot_LM = vwEntry.getColumnValues().elementAt(11);            

for (var x = 1; x < vwCount; x++) {
//    Looping through all the entries and collect the column values
vwEntry = vwEntries.getNextEntry(vwEntry);
plot_LoggerID = plot_LoggerID + "," + vwEntry.getColumnValues().elementAt(2);
plot_G = plot_G + "," + vwEntry.getColumnValues().elementAt(5);    
plot_IE = plot_IE + "," + vwEntry.getColumnValues().elementAt(6);    
plot_FF = plot_FF + "," + vwEntry.getColumnValues().elementAt(7);    
plot_CH = plot_CH + "," + vwEntry.getColumnValues().elementAt(8);    
plot_SA = plot_SA + "," + vwEntry.getColumnValues().elementAt(9);    
plot_OP = plot_OP + "," + vwEntry.getColumnValues().elementAt(10);    
plot_LM = plot_LM + "," + vwEntry.getColumnValues().elementAt(11);    

}

getComponent("extracted_LoggerID").setValue(moo);
getComponent("extracted_G").setValue(h);
getComponent("extracted_IE").setValue(e);    
getComponent("extracted_FF").setValue(f);    
getComponent("extracted_CH").setValue(c);    
getComponent("extracted_SA").setValue(s);    
getComponent("extracted_OP").setValue(o);   
getComponent("extracted_LM").setValue(l);       
} 
```

jqplot 函数类似，但我的图表数据不同，我也将其更改为折线图。非常感谢威尔豪！

# elasticsearch - Elasticsearch：_count 给出奇怪的结果

> ID：16195757
> 
> 赞同：0
> 
> 时间：2013-04-24T15:15:10.150
> 
> 标签：elasticsearch

$ curl -XGET ' [http://test.server.es:9200/index/test/_count?pretty](http://test.server.es:9200/index/test/_count?pretty) '

```
{
  "count" : 229594,
  "_shards" : {
    "total" : 5,
    "successful" : 5,
    "failed" : 0
  }
} 
```

再试一次：

$ curl -XGET ' [http://test.server.es:9200/index/test/_count?pretty](http://test.server.es:9200/index/test/_count?pretty) '

```
{
  "count" : 226967,
  "_shards" : {
    "total" : 5,
    "successful" : 5,
    "failed" : 0
  }
} 
```

“count”值小于前一个_count，但两个_count之间没有删除操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T08:23:34.030

您的一个节点发疯了，上面有不完整的分片。

询问统计信息并找到故障节点：

```
curl -XGET 'http://localhost:9200/_cluster/nodes/stats' 
```

如果您将副本设置为至少 1，则只需停止此节点，删除数据目录并重新启动节点。

我的 2 美分

# spring - Spring bean 上的 Perf4j Profiled 注释 ... jmsConnectionFactory 错误

> ID：16195761
> 
> 赞同：0
> 
> 时间：2013-04-24T15:15:20.883
> 
> 标签：spring, perf4j

我需要在基于 Spring 3.2 的应用程序上设置 Perf4j。我有以下 Spring xml 配置内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:p="http://www.springframework.org/schema/p"
xmlns:aop="http://www.springframework.org/schema/aop"
xmlns:jee="http://www.springframework.org/schema/jee"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.1.xsd
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

<context:component-scan base-package="com.xxx.yyy.services" />

<jee:jndi-lookup id="jmsConnectionFactory" jndi-name="java:/JmsXA" lookup-on-startup="true"/>

<bean id="jmsTemplate" class="org.springframework.jms.core.JmsTemplate">
    <property name="connectionFactory" ref="jmsConnectionFactory"/>
    <property name="deliveryPersistent" value="false"/>
    <property name="receiveTimeout" value="30000"/>
</bean>

<bean id="eventConsumer" class="com.motive.kmp.event.JmsEventConsumer"/>

<bean id="eventProducer" class="com.motive.kmp.event.JmsEventProducer">
    <constructor-arg ref="jmsTemplate"/>
</bean>

<aop:aspectj-autoproxy>
      <aop:include name="timingAspect" />
</aop:aspectj-autoproxy>

<bean id="timingAspect" class="org.perf4j.slf4j.aop.TimingAspect" /> 
```

在 JBoss AS 7.1.0.Final 上部署应用程序时出现以下错误：

```
 Exception sending context initialized event to listener instance of class   
  org.springframework.web.context.ContextLoaderListener: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jmsTemplate' defined in class path resource [service-common-context.xml]: Cannot resolve reference to bean 'jmsConnectionFactory' while setting bean property 'connectionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jmsConnectionFactory': Post-processing of the FactoryBean's object failed; nested exception is java.lang.IllegalArgumentException: error Type referred to is not an annotation type: org.perf4j.aop.Profiled

 Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jmsConnectionFactory': Post-processing of the FactoryBean's object failed; nested exception is java.lang.IllegalArgumentException: error Type referred to is not an annotation type: org.perf4j.aop.Profiled
    at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:165) [spring-beans-3.2.0.RELEASE.jar:3.2.0.RELEASE]
    at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.getObjectFromFactoryBean(FactoryBeanRegistrySupport.java:102) [spring-beans-3.2.0.RELEASE.jar:3.2.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.getObjectForBeanInstance(AbstractBeanFactory.java:1443) [spring-beans-3.2.0.RELEASE.jar:3.2.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:249) [spring-beans-3.2.0.RELEASE.jar:3.2.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194) [spring-beans-3.2.0.RELEASE.jar:3.2.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:323) [spring-beans-3.2.0.RELEASE.jar:3.2.0.RELEASE] 
```

Profiled 注释应用于服务 bean 方法。有没有办法指定一个实际使用 Profiled 注释的 bean 列表？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T08:35:56.037

更改 JMS 资源的 jee:jndi-lookup 定义后：指定代理接口，问题就解决了。

```
<jee:jndi-lookup id="jmsConnectionFactory" 
                 jndi-name="java:/JmsXA" 
                 lookup-on-startup="true"
                 proxy-interface="javax.jms.ConnectionFactory"/> 
```

# compact-framework - 带有 ServiceStack 和紧凑框架的 Protobuf-net

> ID：16195762
> 
> 赞同：2
> 
> 时间：2013-04-24T15:15:24.227
> 
> 标签：compact-framework, servicestack, protobuf-net

我编写了一个使用 servicestack 的服务器，以及一个使用 JSON 和 protobuf-net 连接到它的客户端（所以我确信服务器可以工作......）。现在我需要使用 CF3.5 在 Windows Mobile 上开发相同的客户端，并且由于 CF3.5 不支持 servicestack，因此我在客户端 HttpWebRequest 和 NewtonSoft.Json.Compact 上使用了 json 部分，这样：

课程：

```
[ProtoContract]
public class ReqPing 
{
}

[ProtoContract]
public class RespPing
{
    [ProtoMember(1)]
    public string Result { get; set; }
} 
```

功能：

```
ReqPing iReqPing = new ReqPing();

string json = JsonConvert.SerializeObject(iReqPing);

HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://192.168.0.87:82/json/syncreply/ReqPing");
req.ContentType = "text/json";
req.Method = "POST";
req.ContentLength = json.Length;

            using (var streamWriter = new StreamWriter(req.GetRequestStream()))
            {
                streamWriter.Write(json);
                streamWriter.Flush();
                streamWriter.Close();
            }

            HttpWebResponse resp = (HttpWebResponse)req.GetResponse();

            Stream respStream = resp.GetResponseStream();

            string resps;

            using (var reader = new StreamReader(respStream, Encoding.UTF8))
            {
                resps = reader.ReadToEnd();                
            }

            respStream.Close();

            JsonTextReader jreader = new JsonTextReader(new StringReader(resps));
            JsonSerializer serializer = new JsonSerializer();
            RespPing iRespPing = serializer.Deserialize<RespPing>(jreader); 
```

它有效，所以现在我正在尝试用 protobuf 实现相同的功能，但我被困在这里：

```
ReqPing iReqPing = new ReqPing();

var ms = new MemoryStream();?????? correct way?

Serializer.Serialize<ReqPing>(ms, iReqPing);

HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://192.168.0.87:82/x-protobuf/reply/ReqPing");
            req.ContentType = "application/x-protobuf";
            req.Method = "POST";
            req.ContentLength = ????????

how can I write the serialized stream to req??               

            HttpWebResponse resp = (HttpWebResponse)req.GetResponse();

            Stream respStream = resp.GetResponseStream();

            RespPing iRespPing = Serializer.Deserialize<RespPing>(respStream); 
```

任何人都可以建议我什么是正确的方法？

谢谢！马蒂亚

编辑：

好的，关于如何使用流，但我也需要设置 ContentLength，否则我在 GetRequestStream 上收到错误消息（说我必须设置 ContentLength ...）。我使它与：

```
byte[] data;
        using(var stream = new MemoryStream()) 
        {
            Serializer.Serialize(stream, iReqPing);
            data = stream.ToArray();
            req.ContentLength = data.Length;
        }

        using(var stream = req.GetRequestStream()) 
        {
            stream.Write(data, 0, data.Length);                
        } 
```

我还有另一种明显的方式吗？

另一个问题：我让它工作，但在两次请求之后，第三次它在 GetRequestStream 中超时。我注意到我在之前的调用中忘记了在我的 HttpWebResponse 中调用 Close()，我更正了它，现在可以工作了。奇怪的是，即使使用 JSON 版本，我也忘记关闭 HttpWebResponse，而且我没有遇到任何问题......例程完全一样......你能猜到原因吗？再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T06:29:24.273

> 如何将序列化流写入 req？

```
using(var stream = req.GetRequestStream()) {
    Serializer.Serialize(stream, iReqPing);
} 
```

然后反序列化，因为您已经正确：

```
RespPing iRespPing;
using(var stream = resp.GetResponseStream()) {
    iRespPing = Serializer.Deserialize<RespPing>(respStream);
} 
```

不需要 a `MemoryStream`，除非您特别想手动发送长度。如果您*确实*想缓冲，那么也许：

```
byte[] data;
using(var stream = new MemoryStream()) {
    Serializer.Serialize(stream, iReqPing);
    data = stream.ToArray();
}
...
using(var stream = req.GetRequestStream()) {
    stream.Write(data, 0, data.Length);
} 
```

* * *

编辑以显示更有效地使用`MemoryStream`重新现在编辑的问题：

```
 byte[] data;
    int len;
    using(var stream = new MemoryStream()) 
    {
        Serializer.Serialize(stream, iReqPing);
        data = stream.GetBuffer(); // note this is oversized!
        len = (int)stream.Length;
    }
    req.ContentLength = len;

    using(var stream = req.GetRequestStream()) 
    {
        stream.Write(data, 0, len); 
    } 
```

这里的微妙之处在于我们避免了复制`MemoryStream`'s 缓冲区——相反，我们获得了**超大**的后台缓冲区（记住要注意其中有多少实际上是数据），然后*只写入那么多*字节。所以`data.Length`可能是（例如）`4096`，但`len`可能是`3012`。这避免了额外的`byte[]`分配和`Buffer.BlockCopy`.

# winapi - 如何将long int转换为char

> ID：16195764
> 
> 赞同：1
> 
> 时间：2013-04-24T15:15:26.107
> 
> 标签：winapi

```
#include <iostream>
#include <Windows.h>
#include <string>
using namespace std;

HANDLE hPort = CreateFile("COM2",
GENERIC_WRITE|GENERIC_READ,0,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL);
DCB dcb;

bool writebyte(char*data)
{
    DWORD byteswritten;
    if (!GetCommState(hPort,&dcb))
    {
        printf("\nSerial port can't be open\n");
        return false;
    }

    dcb.BaudRate = CBR_9600;
    dcb.ByteSize = 8;
    dcb.Parity = NOPARITY;
    dcb.StopBits = ONESTOPBIT;

    if (!SetCommState(hPort,&dcb))
        return false;

    bool retVal = WriteFile(hPort,data,1,&byteswritten,NULL);

    return retVal;
}

int ReadByte()
{

    int Val;
    BYTE Byte;
    DWORD dwBytesTransferred;
    DWORD dwCommModemStatus;
    if (!GetCommState(hPort,&dcb))
    return 0;

    SetCommMask(hPort,EV_RXCHAR | EV_ERR);
    WaitCommEvent (hPort,&dwCommModemStatus,0);
    if (dwCommModemStatus & EV_RXCHAR)
    ReadFile (hPort,&Byte,1,&dwBytesTransferred,0);
    Val = Byte;
    return Val;
}

int main() {

    POINT p;
    int x;
    int y;
    int z;

    while(0==0){
    GetCursorPos(&p);
    x = p.x;
    y = p.y;
    HDC hDC;

    hDC = GetDC(NULL);

    cin >> z;
    cout << GetPixel(hDC, x, y) << endl;
    Sleep(z);
    ReleaseDC(NULL, hDC);

    char data = GetPixel(hDC, x, y);
        if (writebyte(&data))
        cout <<" DATA SENT.. " << (int)data<< "\n";

    }
} 
```

在通过串行通信发送数据的部分，它不是以 GetPixel(hDC, x, y) 的形式发送数据，而是只发送值 "-1" 。我在想这是因为 char 仅适用于小整数，而我给出的输出是一个非常长的数字。我试图将其更改为 long int 但我仍然得到相同的结果。它只发送“-1”。我认为解决方案可能是在发送数据之前将 char 转换为 long int 或 long int 转换为 char 但我不知道如何......有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T15:20:51.267

为什么`hDC`发布后还要使用？

```
ReleaseDC(NULL, hDC);
char data = GetPixel(hDC, x, y); 
```

`GetPixel``CLR_INVALID`如果出现错误，将返回 -1 ( )（请参阅[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144909(v=vs.85).aspx)）。

而且，顺便说一句， a`COLORREF`不是 a ，因此在存储in`char`的返回值时会丢失 Information 。您应该存储完整并发送/接收所有字节（因此发送/接收字节）。`GetPixel``char data``COLORREF``sizeof(COLORREF)`

还要注意字节顺序。如果您在两台机器之间传输多字节数据，那么您必须确保两者都同意字节的顺序。例如，如果一台机器是小端，另一台是大端，那么它们`COLORREF`以不同的字节顺序存储在内存中。一种是将 COLORREF 0x00BBGGRR 存储在内存中，`{ 0, 0xbb, 0xgg, 0xrr }`而另一种是将其存储为`{ 0xrr, 0xgg, 0xbb, 0 }`. 因此，您需要定义一个传输字节顺序，双方都使用独立于它们的主机字节顺序。如果您不想发明新的轮子，可以查看网络字节顺序并重用它。Socket API 为您提供了一些功能`ntohl`，例如`htonl`帮助您从主机字节顺序转换为网络字节顺序，反之亦然。

# google-analytics - Google Analytics - 如何判断用户是通过 wifi 还是手机连接？

> ID：16195768
> 
> 赞同：6
> 
> 时间：2013-04-24T15:15:42.457
> 
> 标签：google-analytics

有没有办法在 Google Analytics 中判断用户的会话是通过 wifi 还是蜂窝网络？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-24T15:18:35.963

不。

> Google Analytics 不会明确告诉您设备是否在 wifi 上。如果您的网站的流量水平相对较低，粗略估计通过 wifi 和 3G 访问的移动访问次数的方法是使用访问者 ISP 传递的域变量。
> 
> 如果设备使用 3G，它的域将显示为“mycingular.net”“myvzw.com”以及移动蜂窝公司为其 3G（以及 2G、4G、LTE 等）网络提供的其他域。如果设备在 wifi 上，则域将显示为“rr.com”“comcast.net”“sbcglobal.net”或它们所连接的无线网络的任何域。根据您的流量水平，可能有太多的域需要排序以找出 wifi 或 3G 上的确切访问次数。此外，某些域可能不是明确的 wifi 或 3G（例如：AT&T 是蜂窝和互联网提供商）。
> 
> 要查看您需要对多少个域进行排序，请启用“移动”高级细分，导航到受众-->移动-->概览，并将二级维度设置为域。行数等于唯一域的数量。

[参考](https://productforums.google.com/forum/?fromgroups=#!topic/analytics/y_-_ocqodw8)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-05-24T09:35:02.177

在新的 Google 分析更新中，您可以访问受众网络提供商，并由此得出结论是来自 Wifi 还是 2G/3G/4G。

1.  打开谷歌分析控制台。
2.  转到受众 > 技术 > 网络。
3.  滚动到底部，您可以看到一个包含服务提供商/受众（新用户、用户、会话）的表格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-09T06:45:25.083

GA 中的此服务提供商维度已被弃用。[https://www.leadfeeder.com/blog/dear-google-why-oh-why-did-you-remove-service-provider-and-network-domain-from-analytics/](https://www.leadfeeder.com/blog/dear-google-why-oh-why-did-you-remove-service-provider-and-network-domain-from-analytics/)

# vim - autocmd 函数总是执行两次

> ID：16195770
> 
> 赞同：5
> 
> 时间：2013-04-24T15:15:50.823
> 
> 标签：vim, duplication, autocmd

我整理了以下一堆令人敬畏的东西：

```
if !exists("g:AsciidocAutoSave")
  let g:AsciidocAutoSave = 0
endif

fun! AsciidocRefresh()
  if g:AsciidocAutoSave == 1
    execute 'write'
    execute 'silent !asciidoc -b html5 -a icons "%"'
  endif
endf

fun! AsciidocFocusLost()
  augroup asciidocFocusLost
    autocmd FocusLost <buffer> call AsciidocRefresh()
  augroup END
endfun

augroup asciidocFileType
  autocmd FileType asciidoc :call AsciidocFocusLost()
augroup END 
```

唯一的问题是：每次 vim 在`asciidoc`文件中失去焦点时，它会保存两次。

当我`:autocmd asciidocFileType`输入命令行时，它显示：

```
---Auto-Commands---
asciidocFileType  FileType
    asciidoc   :call AsciidocFocusLost()
               :call AsciidocFocusLost() 
```

与`:autocmd asciidocFocusLost`和相同`AsciidocRefresh()`。

为什么会出现这种重复？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T16:08:56.943

我不能肯定地告诉你*为什么*你会得到这些重复项（多个来源？），但防止这种情况的规范方法是清除第`augroup`一个：

```
augroup asciidocFileType
    autocmd!
    autocmd FileType asciidoc :call AsciidocFocusLost()
augroup END 
```

由于您只有一个定义，因此您也可以在一个命令中执行此操作：

```
augroup asciidocFileType
    autocmd! FileType asciidoc :call AsciidocFocusLost()
augroup END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-16T09:36:32.247

[@ingo-karkat](https://stackoverflow.com/users/813602/ingo-karkat)的回答很好，但我想我知道为什么你会得到两倍的`autocmd`s 以及如何自然地防止它：

vim/Neovim 的一些发行版默认确保`filetype plugin indent`是`on`. 用neovim`env XDG_CONFIG_HOME=/dev/null nvim -c 'filetype'`或用vim测试它`env HOME=/dev/null vim -c filetype`

如果输出是

```
filetype detection:ON  plugin:ON  indent:ON 
```

然后你不需要添加`filetype * on`到你的 vimrc 中。

# php - php 形式的安全漏洞

> ID：16195772
> 
> 赞同：0
> 
> 时间：2013-04-24T15:15:56.500
> 
> 标签：php, forms, security, email

显然我的 php 电子邮件表单充满了安全漏洞，我能做些什么来修复它们？

我所说的安全漏洞是指黑客/机器人能够在我的表单中注入额外的标头（例如密件抄送）并以我的名义发送垃圾邮件

有什么建议么？

```
<?php
/*
 * Template Name: Contact Form Page
*/
if(isset($_POST['submitted'])) {
        //Check to make sure that the name field is not empty
        if(trim($_POST['contactName']) === '') {
            $nameError = __("You forgot to enter your name.", "site5framework");
            $hasError = true;
        } else {
            $name = trim($_POST['contactName']);
        }

        //Check to make sure sure that a valid email address is submitted
        if(trim($_POST['email']) === '')  {
            $emailError = __("You forgot to enter your email address.", "site5framework");
            $hasError = true;
        } else if (!eregi("^[A-Z0-9._%-]+@[A-Z0-9._%-]+\.[A-Z]{2,4}$", trim($_POST['email']))) {
            $emailError = __("You entered an invalid email address.", "site5framework");
            $hasError = true;
        } else {
            $email = trim($_POST['email']);
        }

        //Check to make sure comments were entered
        if(trim($_POST['comments']) === '') {
            $commentError = __("You forgot to enter your comments.", "site5framework");
            $hasError = true;
        } else {
            if(function_exists('stripslashes')) {
                $comments = stripslashes(trim($_POST['comments']));
            } else {
                $comments = trim($_POST['comments']);
            }
        }

        //If there is no error, send the email
        if(!isset($hasError)) {
            $msg .= "------------User Info------------ \r\n"; //Title
            $msg .= "User IP: ".$_SERVER["REMOTE_ADDR"]."\r\n"; //Sender's IP
            $msg .= "Browser Info: ".$_SERVER["HTTP_USER_AGENT"]."\r\n"; //User agent
            $msg .= "Referrer: ".$_SERVER["HTTP_REFERER"]; //Referrer

            $emailTo = ''.of_get_option('sc_contact_email').'';
            $subject = 'Contact Form Submission From '.$name;
            $body = "Name: $name \n\nEmail: $email \n\nMessage: $comments \n\n $msg";
            $headers = 'From: '.$name.' <'.$email.'>' . "\r\n" . 'Reply-To: ' . $email;

            if(mail($emailTo, $subject, $body, $headers)) $emailSent = true;

    }

}
get_header();
?>

            <div id="content" class="container clearfix">

                <!-- page header -->
                <div class="container clearfix ">

                    <?php if(of_get_option('sc_contact_map') != '') { ?>
                        <!-- contact map -->
                        <div id="contact-map">
                        <?php echo of_get_option('sc_contact_map') ?>
                        </div>
                        <!-- end contact map -->
                    <?php } else if(of_get_option('sc_showpageheader') == '1' &&  get_post_meta($post->ID, 'snbpd_ph_disabled', true) != 'on' ) : ?>

                        <?php if(get_post_meta($post->ID, 'snbpd_phitemlink', true)!= '') : ?>

                        <?php
                        $thumbId = get_image_id_by_link ( get_post_meta($post->ID, 'snbpd_phitemlink', true) );
                        $thumb = wp_get_attachment_image_src($thumbId, 'page-header', false);
                        ?>
                        <img class="intro-img" alt=" " src="<?php echo $thumb[0] ?>" alt="<?php the_title(); ?>"  />

                        <?php elseif (of_get_option('sc_pageheaderurl') !='' ): ?>

                            <?php
                            $thumbId = get_image_id_by_link ( of_get_option('sc_pageheaderurl') );
                            $thumb = wp_get_attachment_image_src($thumbId, 'page-header', false);
                            ?>
                            <img class="intro-img" alt=" " src="<?php echo $thumb[0] ?>" alt="<?php the_title(); ?>"  />

                        <?php else: ?>

                            <img class="intro-img" alt=" " src="<?php echo get_template_directory_uri(); ?>/library/images/inner-page-bg.jpg" />

                        <?php endif ?>
                    <?php endif ?>

                </div>

                <!-- content -->
                <div class="container">

                    <h1><?php the_title(); ?> <?php if ( !get_post_meta($post->ID, 'snbpd_pagedesc', true)== '') { ?>/<?php }?> <span><?php echo get_post_meta($post->ID, 'snbpd_pagedesc', true); ?></span></h1>

                    <article id="post-<?php the_ID(); ?>" <?php post_class('clearfix'); ?> role="article">

                        <?php if (have_posts()) : while (have_posts()) : the_post(); ?>

                            <div class="page-body clearfix">
                                <?php the_content(); ?>
                            </div>

                            <div class="one-third">
                                <div class="caddress"><strong><?php _e('Address:', 'site5framework') ?></strong> <?php echo of_get_option('sc_contact_address') ?></div>
                                <div class="cphone"><strong><?php _e('Phone:', 'site5framework') ?></strong> <?php echo of_get_option('sc_contact_phone') ?></div>
                                <div class="cphone"><strong><?php _e('Fax:', 'site5framework') ?></strong> <?php echo of_get_option('sc_contact_fax') ?></div>
                                <div class="cemail"><strong><?php _e('E-mail:', 'site5framework') ?></strong> <a href="mailto:<?php echo of_get_option('sc_contact_email') ?>"><?php echo of_get_option('sc_contact_email') ?></a></div>

                            </div>

                            <div class="two-third last">
                                <div id="messages">
                                    <p class="simple-error error" <?php if($hasError != '') echo 'style="display:block;"'; ?>><?php _e('There was an error submitting the form.', 'site5framework'); ?></p>

                                    <p class="simple-success thanks"><?php _e('<strong>Thanks!</strong> Your email was successfully sent. We should be in touch soon.', 'site5framework'); ?></p>
                                </div>

                                <form id="contactForm" method="POST">
                                    <div class="one-third">
                                        <label for="nameinput"><?php _e("Your name", "site5framework"); ?></label>
                                        <input type="text" id="nameinput" name="contactName" value="<?php if(isset($_POST['contactName'])) echo $_POST['contactName'];?>" class="requiredField"/>
                                        <span class="error" <?php if($nameError != '') echo 'style="display:block;"'; ?>><?php _e("You forgot to enter your name.", "site5framework");?></span>
                                    </div>
                                    <div class="one-third last">
                                        <label for="emailinput"><?php _e("Your email", "site5framework"); ?></label>
                                            <input type="text" id="emailinput" name="email" value="<?php if(isset($_POST['email']))  echo $_POST['email'];?>" class="requiredField email"/>
                                          <span class="error" <?php if($emailError != '') echo 'style="display:block;"'; ?>><?php _e("You forgot to enter your email address.", "site5framework");?></span>
                                    </div>
                                    <div class="two-third">
                                        <label for="nameinput"><?php _e("Area/Rep", "site5framework"); ?></label>
                                        <select>
                                            <option>Area 1 - Engela</option>
                                            <option>Area 2 - Francois</option>
                                            <option>Area 3 - Johan</option>
                                        </select>
                                    </div>
                                    <div class="two-third">
                                    <label for="Mymessage"><?php _e("Your message", "site5framework"); ?></label>
                                        <textarea cols="20" rows="20" id="Mymessage" name="comments" class="requiredField"><?php if(isset($_POST['comments'])) { if(function_exists('stripslashes')) { echo stripslashes($_POST['comments']); } else { echo $_POST['comments']; } } ?></textarea>
                                          <span class="error" <?php if($commentError != '') echo 'style="display:block;"'; ?>><?php _e("You forgot to enter your comments.", "site5framework");?></span>
                                    </div>
                                    <br class="clear" />
                                    <input type="hidden" name="submitted" id="submitted" value="true" />
                                    <button type="submit" id="submitbutton" class="button small round orange"><?php _e(' &nbsp;SEND MESSAGE&nbsp; ', 'site5framework'); ?></button>

                                </form>

                            </div>

                        <?php endwhile; ?>
                    </article>

                    <?php else : ?>

                    <article id="post-not-found">
                        <header>
                            <h1><?php _e("Not Found", "site5framework"); ?></h1>
                        </header>
                        <section class="post_content">
                            <p><?php _e("Sorry, but the requested resource was not found on this site.", "site5framework"); ?></p>
                        </section>
                        <footer>
                        </footer>
                    </article>

                    <?php endif; ?>

                </div>

            </div> <!-- end content -->

            <?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:39:28.783

**use another contact template!**

contact templates are a very vulnerable point in web sites, this one is really insecure (I guess / hope it's quite old).

A few points for the curious (only a first glance, there may be more issues)

*   the `$name` parameter is not escaped, malicious user can enter for example bcc addresses, which would be added to the header section, here
*   the regex for the `$email` parameter allows `%`, thus it is possible to enter url_encoded signs like `< >`
*   `$comments` is not secured, too..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:22:49.337

为什么您需要让用户发送带有任意名称和电子邮件地址的电子邮件？你想成为一个开放的代理吗？

像这样的 PS 行不会做你可能想要的，因为它们不处理没有参数或传递数组的情况。

```
trim($_POST['contactName']) === '' 
```

# android - Eventful java客户端库可以用于Android吗？

> ID：16195774
> 
> 赞同：0
> 
> 时间：2013-04-24T15:16:03.980
> 
> 标签：android, api

我正在创建一个显示 android 本地事件的应用程序。我希望使用 Eventful API，因为它带有自己的基于 java 的客户端库。但是，我不确定它是否适合 Android，因为我知道很多这些基于 java 的客户端库使用 Android 不支持的东西。

那么，有人知道它是否有效吗？

如果您想自己检查一下，我的整个项目都[可以在@github上找到。](https://github.com/selbekk/eventually)

[API 可在此处](http://api.eventful.com)找到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T08:10:08.253

我想说最简单的方法是编译和运行嵌入库并测试一些方法的应用程序。

通常，您可能对网络的处理方式有疑问。android做HTTP主要有两种方式，Java和Apache方式，我认为Java URL API是完全支持的并且非常接近实际的Java版本，但是Apache有一些隐藏的差异。

您将面临的主要风险是 A/ 它使用 Android 上不存在的类或包。B/ 一个类的行为不像预期的那样，这确实不时发生，因为 Android 实现是完全特定的。

显然，您已经尝试运行包含该库的 android 应用程序？您是否遇到特定错误？如果你，你能发布堆栈跟踪吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T16:48:15.423

Android 在 Java 客户端库方面没有问题。它建立在标准 Java 之上，并且可以使用所有框架功能。

此外，看起来这个 API 提供了一个 RESTful 接口，这肯定是 Android 支持的。

最重要的是，我确实认为您可以在 Android 中毫无问题地使用此 API。

# google-api - 将 oauth2 与本机 (iOS/Android) 移动应用程序集成

> ID：16195779
> 
> 赞同：5
> 
> 时间：2013-04-24T15:16:17.653
> 
> 标签：google-api, oauth-2.0, security, google-oauth

我需要将 OAuth2 集成到 iOS 和 Android 本机应用程序中。我一直在研究 OAuth2 和移动应用程序并找到了这个文档 - [Google APIs - Using OAuth 2.0 for Installed Applications](https://developers.google.com/accounts/docs/OAuth2InstalledApp "将 OAuth 2.0 用于已安装的应用程序")

上述文档基本上详细介绍了如何在移动应用程序中使用 Goolge OAuth 2.0 端点。

这是文件所说的 -

> 1.  注册应用程序时，您指定该应用程序是已安装的应用程序。这会导致 redirect_uri 参数的值不同。
> 2.  注册时获取的 client_id 和 client_secret 嵌入到你的应用程序的源代码中。在这种情况下，client_secret 显然不被视为秘密。
> 3.  授权代码可以在浏览器的标题栏中返回到您的应用程序，也可以返回到`http://localhost`查询字符串中的端口。

假设用户在其智能手机上安装了 2 个应用程序。

App1 - 使用 Google OAuth2.0 端点的合法应用

App2 - 恶意应用

实际上，我不确定的是，上述在原生移动应用程序中集成/使用 OAuth2.0 端点的技术是否不安全，或者我是否遗漏了什么。这是我的问题-

* * *

*   redirect_uri 可以是`http://localhost`URL，并且可以包含任何端口号。端口号不是初始 API 配置的一部分，因此它可以是任何有效的端口号。此外，client_id（无论如何都不应该是秘密）和 client_secret 并不是真正的秘密，因为它们嵌入在移动应用程序源代码中。

使用上述条件，是不是以下可能性 -

1.  用户启动 App2
2.  App2 将用户重定向到 Google OAuth2.0 端点，但是在请求中，App2 包含 App1 的 client_id 并包含 App2 正在侦听的本地端口号。
3.  当用户被重定向并通过 Google OAuth2.0 端点进行身份验证时，Google 会向用户指示“App1（合法应用程序）要求代表用户访问 Google API 的/数据”，这似乎是一种网络钓鱼攻击，因为用户可能会单击“是”，认为是 App1 要求访问。
4.  然后Google OAuth2.0 会向App2 发出一个授权码，然后App2 可以发出下一个请求，包括App1 的client_id 和client_secret 并获得access_token 和refresh_token 并继续从Google 访问用户数据。

* * *

*   redirect_uri 也可以是 - urn:ietf:wg:oauth:2.0:oob，这意味着 -

> 该值向 Google 授权服务器发出信号，授权代码应在浏览器的标题栏中返回。当客户端在没有重要客户端配置的情况下无法侦听 HTTP 端口时，这很有用。Windows 应用程序具有此特性。
> 
> 使用此值时，您的应用程序可以感知到页面已加载并且 HTML 页面的标题包含授权代码。如果您想确保用户永远不会看到包含授权代码的页面，则由您的应用程序关闭浏览器窗口。执行此操作的机制因平台而异。

上面的意思是授权码是在浏览器窗口的标题中返回的。

我的问题是 - App2 是否也可以感知页面已加载并捕获授权代码，然后使用它（在 App1 之前）与 client_id 和 client_secret 一起获取 access_token 和 refresh_token。浏览器实例是全局的并且任何应用程序都可以监视它并且上述攻击场景是有效的，还是浏览器实例以某种方式特定于应用程序以便只有 App1 可以感知/监视更改？

* * *

我的理解正确还是我错过了什么？我是否错过了缓解上述威胁的任何缓解措施？或者鉴于我们在移动操作系统平台上，上述风险是否有效但可以接受？

在移动应用程序中使用 OAuth2.0 的安全方式是什么？- 在浏览器页面中显示授权码并让用户在应用程序中手动输入？在这种情况下，浏览器实例是私有的，以便另一个应用程序无法监控它并在用户将授权码输入合法的apiation之前获取授权码本身？

任何帮助表示赞赏

谢谢并恭祝安康，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-25T14:45:45.073

不是对这个问题的直接回答，而是对于像我一样来到这里并得到过时回复的人。最好从这里开始：Google[已经发布](https://code.google.com/p/google-oauth-java-client/wiki/OAuth2)了他们的 OAuth Java 库，并且[Scribe](https://github.com/fernandezpablo85/scribe-java)已经为 Java 做好了准备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-07T11:16:24.260

根据我的经验，我发现实际上支持以干净方式检索授权代码的库很少。

在大多数移动平台上，您可以“监听”重定向 URL（是 http 或一些自定义方案）

例如，在 Android 上，可以轻松地创建一个活动来检索访问令牌（基于它通过重定向 URL 接收到的授权代码。

```
 <activity android:name=".OAuthAccessTokenActivity" android:launchMode="singleTask">>
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="http" android:host="localhost"  />
        </intent-filter>
    </activity> 
```

在这种情况下

```
http://localhost 
```

在像 Android 这样的移动平台上，这似乎是合乎逻辑的事情。

在 iOS 上也可以这样做，但如果我没记错的话，适用于 iOS 的 Google OAuth 库使用页面标题方法。

从技术上讲，这两种流程之间没有区别。唯一的区别是重定向 URL 的语法，导致授权代码的位置不同。

从安全的角度来看，如果没有 OAuth2 客户端密码，仅授权代码是毫无价值的。

让用户输入授权码是我在 Oauth2 流程中不习惯看到的，但这是可能的。如果怀疑它会增加任何安全性。恕我直言，它只会让用户感到沮丧。

这并不意味着有不同的方式来检索和处理授权代码（通过使用 localhost 或自定义 URI 方案的重定向自动捕获代码，或手动交付）

# firefox - Firebug：从网页检查 POST

> ID：16195788
> 
> 赞同：1
> 
> 时间：2013-04-24T15:16:44.930
> 
> 标签：firefox, firebug, html-post

我可以使用 Firebug 来检查网页发送到服务器的发布请求吗？如果可以，如何？

我指的是检查使用表单制作的常规 POST，但也有兴趣了解如何使用 javascript 检查帖子。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T23:09:09.073

你当然可以这样做。[*网络*面板](https://getfirebug.com/wiki/index.php/Net_Panel)允许您扩展与网站相关的每个请求。对于通过 AJAX 完成的 POST，您可以设置*XHR*过滤器以仅查看这些请求。

如果您通过单击来展开请求，您将获得与其相关的所有信息。

塞巴斯蒂安

# angularjs - 如何在没有绑定的情况下在角度视图中显示模型值？消除 Angular 绑定？

> ID：16195796
> 
> 赞同：2
> 
> 时间：2013-04-24T15:17:06.530
> 
> 标签：angularjs

我在 $rootScope 中有一个常用的角度模型。使用 {{$rootScope.client.name}} 以角度视图显示数据

有一个表格，用户可以更改他的名字。当它使用新名称更新表单时，模板中的现有名称会更改（由于绑定，这是正常的）。

如何停止此绑定并在下次刷新或保存后手动使更改可用？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:50:21.740

不要将原始对象绑定到表单，而是`angular.copy`在编辑之前对其进行复制（ ）并将副本绑定到表单中。然后在“保存”后将绑定到表单的对象复制回原始对象。

# android - 如何在android中的通知中添加按钮？

> ID：16195800
> 
> 赞同：99
> 
> 时间：2013-04-24T15:17:17.260
> 
> 标签：android, button, widget, notifications

我的应用程序播放音乐，当用户通过从屏幕顶部（或通常从平板电脑屏幕的右下角）滑动打开通知屏幕时，我想向他们展示一个按钮来停止当前播放的音乐并重新启动它，如果他们要。

我不打算将小部件放在用户的主屏幕上，而只是放在通知中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2018-03-28T16:13:51.030

您可以为操作创建一个意图（在这种情况下停止播放），然后将其作为操作按钮添加到您的通知中。

```
Intent snoozeIntent = new Intent(this, MyBroadcastReceiver.class);
snoozeIntent.setAction(ACTION_SNOOZE);
snoozeIntent.putExtra(EXTRA_NOTIFICATION_ID, 0);
PendingIntent snoozePendingIntent =
        PendingIntent.getBroadcast(this, 0, snoozeIntent, 0);

NotificationCompat.Builder mBuilder = new NotificationCompat.Builder(this, CHANNEL_ID)
        .setSmallIcon(R.drawable.notification_icon)
        .setContentTitle("My notification")
        .setContentText("Hello World!")
        .setPriority(NotificationCompat.PRIORITY_DEFAULT)
        .setContentIntent(pendingIntent)
        .addAction(R.drawable.ic_snooze, getString(R.string.snooze),
                snoozePendingIntent); 
```

请参阅[Android 文档](https://developer.android.com/training/notify-user/build-notification.html#Actions)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-03-29T08:29:54.387

我将尝试提供我使用过的解决方案，并且大多数音乐播放器也使用相同的技术在通知栏中显示播放器控件。

我正在运行一项用于管理媒体播放器及其所有控件的服务。例如，活动用户控件通过向服务发送 Intent 来与服务交互

```
 Intent i = new Intent(MainActivity.this, MyRadioService.class);
        i.setAction(Constants.Player.ACTION_PAUSE);

        startService(i); 
```

要在服务类中接收意图并执行操作，我在服务的 onStartCommand 方法中使用以下代码

```
 @Override
public int onStartCommand(Intent intent, int flags, int startId) {

    if (intent.getAction().equals(Constants.Player.ACTION_PAUSE)) {
        if(mediaPlayer.isPlaying()) {
            pauseAudio();
        }
    } 
```

现在要准确回答您的问题，以显示带有播放控件的通知。您可以调用以下方法来显示带有控件的通知。

```
 //    showNotification
private void startAppInForeground() {
//  Start Service in Foreground

    // Using RemoteViews to bind custom layouts into Notification
    RemoteViews views = new RemoteViews(getPackageName(),
            R.layout.notification_status_bar);

// Define play control intent 
   Intent playIntent = new Intent(this, MyRadioService.class);
    playIntent.setAction(Constants.Player.ACTION_PLAY);

// Use the above play intent to set into PendingIntent
    PendingIntent pplayIntent = PendingIntent.getService(this, 0,
            playIntent, 0);

// binding play button from layout to pending play intent defined above 
views.setOnClickPendingIntent(R.id.status_bar_play, pplayIntent);
views.setImageViewResource(R.id.status_bar_play,
            R.drawable.status_bg);

Notification status = null;
 if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
        status = new Notification.Builder(this).build();
    }

  status.flags = Notification.FLAG_ONGOING_EVENT;
    status.icon = R.mipmap.ic_launcher;
    status.contentIntent = pendingIntent;
    startForeground(Constants.FOREGROUND_SERVICE, status); 
```

希望这真的可以帮助你。你将能够实现你想要的。有一个快乐的编码:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-30T05:02:44.243

```
 // It shows buttons on lock screen (notification).

Notification notification = new Notification.Builder(context)
    .setVisibility(Notification.VISIBILITY_PUBLIC)
    .setSmallIcon(R.drawable.NotIcon)
    .addAction(R.drawable.ic_prev, "button1",ButtonOneScreen) 
    .addAction(R.drawable.ic_pause, "button2", ButtonTwoScreen)  
   .....
    .setStyle(new Notification.MediaStyle()
    .setShowActionsInCompactView(1)
    .setMediaSession(mMediaSession.getSessionToken())
    .setContentTitle("your choice")
    .setContentText("Again your choice")
    .setLargeIcon(buttonIcon)
    .build(); 
```

更多详情请参考[这里 点击这里](https://developer.android.com/guide/topics/ui/notifiers/notifications.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-08-24T18:12:06.060

使用 android Pie 测试的工作代码。这些都在同一个服务类中。

显示通知：

```
public void setNotification() {

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O)
    {
    NotificationChannel channel = new NotificationChannel("a", "status", NotificationManager.IMPORTANCE_DEFAULT);
    channel.setDescription("notifications");
    notificationManager = getSystemService(NotificationManager.class);
    notificationManager.createNotificationChannel(channel);

    }
else
    notificationManager =  (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);

Receiver.service = this;
Notification.MediaStyle style = new Notification.MediaStyle();

notification = new Notification.Builder(this)
        .setSmallIcon(R.mipmap.ic_launcher)
        .setContentTitle("Notification")
        .addAction(R.drawable.close_icon,  "quit_action", makePendingIntent("quit_action"))
        .setStyle(style);

style.setShowActionsInCompactView(0);

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O)
    {
    notification.setChannelId("a");
    }

// notificationManager.notify(123 , notification.build()); // pre-oreo
startForeground(126, notification.getNotification());
} 
```

辅助功能：

```
public PendingIntent makePendingIntent(String name)
    {
    Intent intent = new Intent(this, FloatingViewService.Receiver.class);
    intent.setAction(name);
    PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, intent, 0);
    return pendingIntent;
    } 
```

要处理这些操作：

```
static public class Receiver extends BroadcastReceiver {
static FloatingViewService service;

@Override
public void onReceive(Context context, Intent intent)
    {

    String whichAction = intent.getAction();

    switch (whichAction)
        {

        case "quit_action":
            service.stopForeground(true);
            service.stopSelf();
            return;

        }

    }
} 
```

您还需要更新清单：

```
<receiver android:name=".FloatingViewService$Receiver">
        <intent-filter>
            <action android:name="quit_action" />
        </intent-filter>
    </receiver> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-07-25T21:44:07.907

我认为除了 `Ankit Gupta`答案之外，您还可以使用[MediaSession](https://developer.android.com/reference/android/media/session/MediaSession.html) (API > 21) 添加本机[mediaController](https://developer.android.com/reference/android/media/session/MediaController.html)视图：

```
notificationBuilder
        .setStyle(new Notification.MediaStyle()
            .setShowActionsInCompactView(new int[]{playPauseButtonPosition})  // show only play/pause in compact view
            .setMediaSession(mSessionToken))
        .setColor(mNotificationColor)
        .setSmallIcon(R.drawable.ic_notification)
        .setVisibility(Notification.VISIBILITY_PUBLIC)
        .setUsesChronometer(true)
        .setContentIntent(createContentIntent(description)) // Create an intent that would open the UI when user clicks the notification
        .setContentTitle(description.getTitle())
        .setContentText(description.getSubtitle())
        .setLargeIcon(art); 
```

来源：[教程](https://developer.android.com/reference/android/media/session/MediaSession.html)

您也可以创建自定义视图并将其显示在通知区域中，[这里](https://stackoverflow.com/questions/12526228/how-to-put-media-controller-button-on-notification-bar)的第一个答案很棒。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-27T12:23:43.750

您可以添加如下按钮，并且可以对该按钮执行操作，我也为我完成了如下操作，请检查。

```
NotificationManager notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
                NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(this)
                        .setSmallIcon(R.drawable.ic_logo)
                        .setAutoCancel(true)
                        .setContentTitle(name)
                        .setContentText(body)
                        .setGroupSummary(true)
                        .addAction(android.R.drawable.ic_menu_directions, "Mark as read", morePendingIntent); 
```

//morePendingIntent(做你的事情)

```
 PendingIntent morePendingIntent = PendingIntent.getBroadcast(
                        this,
                        REQUEST_CODE_MORE,
                        new Intent(this, NotificationReceiver.class)
                                .putExtra(KEY_INTENT_MORE, REQUEST_CODE_MORE)
                                .putExtra("bundle", object.toString()),
                        PendingIntent.FLAG_UPDATE_CURRENT
                ); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-13T15:45:51.587

我不知道这是否正确，但它确实有效。

1.  创建一个`BroadCastReceiver`类以在按下按钮时接收数据。

```
public class MyBroadCastReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {

        String log = "URI: " + intent.toUri(Intent.URI_INTENT_SCHEME);
        Log.d("my", "LOG:::::::" + log);
    }
} 
```

2.  现在在您要创建通知的任何活动中 -

```
 Intent intent = new Intent();
        intent.setAction("unique_id");
        intent.putExtra("key", "any data you want to send when button is pressed");
        PendingIntent pendingIntent = PendingIntent.getBroadcast(this, REQUEST_CODE, intent, 0); 
```

3.  现在在创建通知时使用此挂起的意图，最后您需要注册此广播以便在 MyBroadCastReceiver 类中接收它。

```
BroadcastReceiver br = new MyBroadCastReceiver();
        IntentFilter filter = new IntentFilter("unique_id");
        registerReceiver(br, filter); 
```

现在，如果您想在按下按钮时执行某些操作，您可以在类中的`onReceive()`方法中执行此操作。`MyBroadCastReceiver`

# javascript - 使用 IE 8 在 Javascript 中遍历空/未定义的 XML 节点

> ID：16195802
> 
> 赞同：1
> 
> 时间：2013-04-24T15:17:18.893
> 
> 标签：javascript, internet-explorer-8, undefined, xmlnode

同样的老故事：某些东西在 Firefox / Chrome 中有效，但在 IE 中无效。

```
var reason = '';
if (data.documentElement.getElementsByTagName("DNFReason")[0].childNodes[0] !== undefined)
{   reason = data.documentElement.getElementsByTagName("DNFReason")[0].childNodes[0].nodeValue; } 
```

这是我发现的第一个可行的解决方案，用于从 Javascript 中的 XML 文档中获取 XML 节点的值，所以我很沮丧，它显然在 IE 中不起作用。

如果节点有一个值，它工作正常，所以问题显然是由一个空/未定义的节点引起的。

有人对此有任何智慧吗？我也在寻找一种稍微不那么冗长的编码方式（可能在 jQuery 中），但我受到时间限制，没有时间像我需要的那样进行研究。

添加了完整的ajax请求：

```
 $.ajax({
                type: "GET",
                url: "SheriffWS.asmx/GetGroupByID",
                data: 'GroupID=' + $("#<%=Groups.ClientID() %>").val(),
                dataType: "xml",
                success: function(data) {
                    var gtype = '';
                    var reason = '';
                    var nme = '';
                    var ttype = '';
                    var ttypeid = 0;

                    if (data.documentElement.getElementsByTagName("Type")[0].childNodes[0] !== undefined) {
                        gtype = data.documentElement.getElementsByTagName("Type")[0].childNodes[0].nodeValue;
                    }

                    if (data.documentElement.getElementsByTagName("Name")[0].childNodes[0] !== undefined) {
                        nme = data.documentElement.getElementsByTagName("Name")[0].childNodes[0].nodeValue;
                    }

                    if (data.documentElement.getElementsByTagName("DNFReason")[0].childNodes[0] !== undefined) {
                        reason = data.documentElement.getElementsByTagName("DNFReason")[0].childNodes[0].nodeValue;
                    }

                    if (data.documentElement.getElementsByTagName("TestName")[0].childNodes[0] !== undefined) {
                        ttype = data.documentElement.getElementsByTagName("TestName")[0].childNodes[0].nodeValue;
                    }

                    if (data.documentElement.getElementsByTagName("TestTypeID")[0].childNodes[0] !== undefined) {
                        ttypeid = data.documentElement.getElementsByTagName("TestTypeID")[0].childNodes[0].nodeValue;
                    }

                    $("#groupinfo-name").val(nme);
                    $("#hid-name").val(nme);

                    $("#groupinfo-type").val(gtype);
                    $("#groupinfo-testtype").val(ttype);
                    $("#groupinfo-testtypeid").val(ttypeid);
                    if (data.documentElement.getElementsByTagName("DNF")[0].childNodes[0].nodeValue == 'false') {
                        $("#groupedit-dnf").removeAttr('checked');
                        $("#groupedit-dnf-li").hide();
                    }
                    else {
                        $("#groupedit-dnf").attr('checked', 'checked');
                        $("#groupedit-dnf-li").show();
                    }

                    $("#<%=GroupEditDNFReason.ClientID() %>").val(reason);
                    $("#hid-dnfreason").val(reason);
                },
                error: function(msg) {

                }

            }); 
```

# c - 输入重定向 GDB

> ID：16195803
> 
> 赞同：0
> 
> 时间：2013-04-24T15:17:20.000
> 
> 标签：c, redirect, input, gdb

我有一个编译程序，它使用标准输入将字符串作为输入五次（在循环中）。每次接受输入后，它都会对其进行一些工作并给出输出。我想调试它 gdb，我必须从文件中给它输入。

我不能直接从键盘输入。
每次程序要求输入时，我都想给出相同的字符串。
我试过 run < input.txt
但在我看来，该程序仅第一次从该文件获取输入，之后它只读取其他 4 个输入的 null。

所以我想知道是否有办法解决这个问题。我对仅在程序第一次请求输入时才从文件中读取输入而不在其余时间从文件中读取的事情是正确的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:26:56.193

`run < input.txt`and `set args < input.txt`and then应该适用于`run`所有从`stdin`. 也许您正在尝试查找程序中的错误。

# matlab - Matlab中的多类SVM分类-图可能吗？

> ID：16195806
> 
> 赞同：1
> 
> 时间：2013-04-24T15:17:28.933
> 
> 标签：matlab, classification, svm

我想使用 SVM 方法对数据集（有四个类）进行分类。我已经使用下面的编码完成了它（对所有都使用 1）。这不是非常准确，但我很感谢现阶段的任何事情。

[http://www.mathworks.co.uk/matlabcentral/fileexchange/39352-multi-class-svm](http://www.mathworks.co.uk/matlabcentral/fileexchange/39352-multi-class-svm)

我想知道是否有办法绘制支持向量和训练点。我已经对 2 类 SVM 分类进行了管理，但找不到使用 >2 类的方法。

![这是一个要求的例子](https://i.stack.imgur.com/qY6S3.jpg)

任何帮助/建议。如何实现半漂亮的图形将不胜感激！

# ruby-on-rails - 在 Heroku 中使用 XServer

> ID：16195812
> 
> 赞同：1
> 
> 时间：2013-04-24T15:17:50.580
> 
> 标签：ruby-on-rails, heroku, xserver

我正在使用`wicked_pdf`gem 在我的 Rails 应用程序中生成 pdf 文件。此 gem 使用[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)将 HTML 文件转换为 PDF。

我要转换为 PDF 的 HTML 文件包含用于生成图表的 JavaScript。为了`wkhtmltopdf`正确呈现这些图表，我需要将`use_xserver`选项设置为`true`.

在本地一切正常。但是，当我在 Heroku 上尝试时，我收到以下错误消息：

```
Error: PDF could not be generated!
Command Error: wkhtmltopdf-amd64: cannot connect to X server 
```

Heroku 是否运行 X 服务器？有可能这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T16:40:55.903

您可能不应该仅仅为了生成 pdf 而在测功机中运行 X-server。看起来 wkhtmltopdf 可以无头运行，请查看以下问题：

*   [wkhtmltopdf：无法连接到 X 服务器](https://stackoverflow.com/questions/9604625/wkhtmltopdf-cannot-connect-to-x-server)
*   [wkhtmltopdf 在没有 X-server 的 Debian 上非常慢](https://stackoverflow.com/questions/6290958/wkhtmltopdf-extremely-slow-on-debian-without-x-server)

# ruby-on-rails - 如何使用 Mongoid 在 Rails 中生成 optgroup？

> ID：16195823
> 
> 赞同：0
> 
> 时间：2013-04-24T15:18:26.647
> 
> 标签：ruby-on-rails, mongodb, group-by, mongoid

使用 MongoDB 时对选项进行分组的最佳方式是什么？

当我尝试这种方法时，我正在使用 Mongoid：

```
<%= field.select :resource_id, 
    grouped_options_for_select(Resource.all.group_by{"resource_type_id"}.map {|k,m|
    [m.first.title, m.first.id] }),:prompt => true %> 
```

它给了我以下错误：

> “5177e6a5359f105f89000001”的未定义方法“map”：Moped::BSON::ObjectId

当我在寻找：

```
<select>
    <optgroup label="RT1">   <!-- RT1 is the name of resource type -->
        <option value="5177e6a5359f105f89000001">Res1</option>
    </optgroup>
</select> 
```

此外，在控制台中的输出`Resource.all.group_by{"resource_type_id"}`是

```
=> {"resource_type"=>[#<Resource _id: 5177e6a5359f105f89000001, 
created_at: 2013-04-24 14:05:25 UTC, updated_at: 2013-04-24 14:54:14 UTC,
title: {"en"=>"Res1"}, slug: {"en"=>"res1"}, content: 
{"en"=>"This is the content for First Resource."},
excerpt: {"en"=>"This is the content for First Resource."}, published: true,
resource_type_id: "5177e3ba359f10d345000004">]} 
```

虽然预期的结果是

```
=> {"RT1"=>[#<Resource _id: 5177e6a5359f105f89000001, 
created_at: 2013-04-24 14:05:25 UTC, updated_at: 2013-04-24 14:54:14 UTC,
title: {"en"=>"Res1"}, slug: {"en"=>"res1"}, content: 
{"en"=>"This is the content for First Resource."},
excerpt: {"en"=>"This is the content for First Resource."}, published: true,
resource_type_id: "5177e3ba359f10d345000004">]} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T20:40:12.437

这里有几件事是错误的。

1.  您似乎将[Enumerable#group_by](http://ruby-doc.org/core-2.0/Enumerable.html#method-i-group_by)与数据库`GROUP BY`运算符混淆了。
2.  您认为资源类型的名称来自哪里？它似乎不在资源中。

看起来资源类型的名称在不同的集合中，您必须将 ID 分别映射到名称。这是 Mongoid 的 NoSQL 部分：您不能简单地连接 Resource 和 ResourceType 表。

```
Resource.all.group_by { |r| r.resource_type_id } 
```

将帮助您入门，但哈希键将是 ID，而不是名称。（这也会一次将所有资源读入内存，这在很多情况下会成为问题，但由于您将它们全部显示在选项列表中，我假设该列表足够小，可以使用。）然后需要获取名称映射并替换哈希键。就像是：

```
resource_names = {}
ResourceType.each { |rt| resource_names[rt.id] = rt.name }
resource_groups = Resource.all.group_by { |r| r.resource_type_id }
resource_options = Hash[resource_groups.map { |k, v| [resource_names[k] || k, [v.title["en"], v.id]] }] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T08:11:26.760

Old Pro 提到的方法很棒，但比预期的要长一点。我花了一些时间查看[`grouped_collection_select`帮助文档](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-grouped_collection_select)中给出的示例，要点是：“为了保持简单和面向对象的方式，您必须从 ResourceType（一个）遍历到 Resource（很多），而不是相反”。另一种方式会令人困惑，因为我们将处理与 ORM 对象相反的没有关系的自定义嵌套数组。

因此，我想要的输出可以通过 ERB 中的以下 Ruby（单行）代码生成：

```
<%= field.grouped_collection_select :resource_id, ResourceType.order_by([:name,:asc]), 
    :resources, :name, :id, :title,  :prompt => true %> 
```

..where `:resources`and`:name`属于 ResourceType 并且`:id`and`:title`是 for`Resource`的选项。

希望它也能帮助其他人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T04:05:24.960

以下是 optgroup 的示例：

```
 @city_group =
                 [
                 ["Wisoncin", [["Lake Geneva", "1"], 
                 ["Elkhart Lake", "2"]]],
                 ["Michigan", [["Harbor Country", "3"], ["Traverse City", "4"]]],
                 ["Indiana", [["Bloomington", "5"], ["Valparaiso", "6"]]],
                 ["Minnesota", [["Twin Cities", 
                 "7"], ["Bloomington", "8"], ["Stillwater", 
                 "9"]]],
                 ["Florida", [["Sanibel & Captiva", "10"]]],
                 ["Illinois", [["Chicago", "11"], 
                 ["Galena", "12"]]],
                 ] 
```

并在您的意见中添加：

```
<%= select_tag(:brand_id, grouped_options_for_select(@city_group, selected_key = "11", prompt = nil)) %> 
```

希望能帮助到你！享受！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-26T21:06:19.973

我假设您想按`resource_type`而不是对选项进行分组`resource_type_id`。

```
f.grouped_collection_select :resource_id, 
                            Resource.all.group_by(:resource_type).to_a, 
                            :last, :first, :id, :name 
```

**说明**：

*   `Resource.all.group_by(:resource_type).to_a`返回一个数组数组。

    ```
    [
      [ "R1", [<Resource _id 51xx0001>, <Resource _id 51xx0002>]],
      [ "R2", [<Resource _id 51xx0003>, <Resource _id 51xx0004>]]
    ] 
    ```

*   `last`对步骤 1 中返回的数组的每一行的方法调用返回一个 Resource 对象数组。

*   `first`对步骤 1 中返回的数组的每一行的方法调用返回资源类型名称。
*   对步骤 2 中返回的数组的每一行的and`id`方法调用返回资源对象的 id 和名称。`name`

# css - 在没有移动设备的情况下测试响应

> ID：16195829
> 
> 赞同：3
> 
> 时间：2013-04-24T15:18:39.570
> 
> 标签：css, responsive-design

我正在努力使我的网站更具响应性。如果我将浏览器宽度减小到最小宽度，这是否可以很好地替代测试在移动设备上会发生什么？

我没有 iPad Mini 或 Galaxy S2/3 等设备，但仍想确保网站在它们上看起来不错。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T16:12:16.417

`Ctrl + Shift + M`在火狐（Windows）上

`Cmd + Option + M`在火狐（Mac）上

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T15:22:48.393

如果您想在本地测试您的设计，在浏览器中，您可以使用 Web Developer Add-On，​​它可以让您选择查看响应式布局

![在此处输入图像描述](https://i.stack.imgur.com/Oq6kz.jpg)

此外，您还可以获得大量在线网站，这些网站将为您完成这项工作

*   [http://mattkersley.com/responsive/](http://mattkersley.com/responsive/)
*   [http://www.studiopress.com/responsive/](http://www.studiopress.com/responsive/)
*   [http://www.responsivedesigntest.net/](http://www.responsivedesigntest.net/)
*   [http://screenqueri.es/](http://screenqueri.es/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T15:23:51.017

如果您正在使用媒体查询，那么只需调整浏览器的大小即可。您可以通过使用诸如萤火虫之类的检查工具并检查主体宽度来密切关注窗口大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T15:30:13.973

CHECK Responsinator：帮助您在不同设备和不同方向上测试站点

[http://www.responsinator.com/](http://www.responsinator.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T15:22:10.727

我建议找到允许您将浏览器调整为特定浏览器尺寸的浏览器插件。然后使用它设置常用尺寸...320px、480px、600px 等，和/或您的项目所需的任何尺寸。

对于 Chrome，我使用 Window Resizer。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T15:23:33.803

我自己使用您描述的方法，它不是 100% 准确，某些文本大小可能会略有变化，特别是如果您使用 em 或 rems。如果测试盒子布局和类似的东西，它可能是相当准确的。

另一种解决方案是使用[http://quirktools.com/screenfly](http://quirktools.com/screenfly)之类的服务，这也是一个相对较好的解决方案。

我也使用的最佳解决方案是浏览器堆栈：[http](http://www.browserstack.com/) ://www.browserstack.com/ 但是它不是免费的。Browser Stack 还允许您测试不同的操作系统、不同的浏览器和多种不同的移动设备。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-24T15:25:12.403

最好的方法是使用设备，但是，如果部分或所有设备不可用，那么您将不得不求助于其他一些（好的）工具。这里有一些例子 ：

*   [测试工具1](http://mattkersley.com/responsive/)

*   [测试工具2](http://www.responsivedesigntest.net/)

请记住，这些工具将向您展示像素完美的输出，并且用户交互/行为可能会有所不同。

# javascript - 用于文件上传的 XMLHttpRequest 在 Chrome 中失败并在 Firefox 中中止

> ID：16195831
> 
> 赞同：0
> 
> 时间：2013-04-24T15:18:46.507
> 
> 标签：javascript, html, firefox, file-upload, xmlhttprequest

这里是 mu uploadFile 函数

```
function uploadFile(options){
  var formData = new FormData();
  formData.append(options.paramName, options.file);
  if(options.data){
    for(var k in options.data){
      formData.append(k, options.data[k]);
    }
  }

  sendRequest(formData, options.url);

  function sendRequest(formData, url){
    var xhr = new XMLHttpRequest();

    // Set up events
    xhr.upload.addEventListener('loadstart', onloadstartHandler, false);
    xhr.upload.addEventListener('progress', onprogressHandler, false);
    xhr.upload.addEventListener('load', onloadHandler, false);
    xhr.addEventListener('readystatechange', onreadystatechangeHandler, false);

    // Set up request
    xhr.open('POST', url, true);
    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
    xhr.setRequestHeader('X-CSRFToken', getCookie('csrftoken'));

    xhr.send(formData)
  }
  function onloadstartHandler(evt){
  }
  function onprogressHandler(evt){

  }
  function onloadHandler(evt){
  }
  function onreadystatechangeHandler(evt){
    if(evt.target.readyState == 4){
      var status = evt.target.status;
      if(evt.target.responseText){
        options.handler(evt.target);
      }
    }
  }
} 
```

我正在从文件输入的“更改”处理程序中调用上述函数，如下所示 -

```
'change input#user_pic': function(ev){
      var selfRef = this;
      var fel = ev.currentTarget;
      if(fel.files.length>0){
        var file = fel.files[0];
        uploadFile({
          paramName: 'photo',
          file: file,
          url: '/'+eventRouter.eventId+'/photos/upload/',
          handler: function(xhr){
            if(xhr.status == '200'){
              var img = $.parseJSON(xhr.responseText)['photo'];
              selfRef.model.set({picture: img});
              console.log('photo uploaded');
              console.log(img);
            }
          }
        });
      }
    } 
```

Chrome 说失败，而 Firefox 说中止。没有显示错误或异常。我不知道为什么请求失败。

这是我在 chrome n/w 选项卡中看到的

```
Request URL:http://localhost:8000/5/photos/upload/
Request Headersview source
Content-Type:multipart/form-data; boundary=----WebKitFormBoundaryg6rSLttylr9m2Yla
Origin:http://localhost:8000
Referer:http://localhost:8000/events/edit/5
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.64 Safari/537.31
X-CSRFToken:qTiEOg9wGFHxEtQV5EyW612DEh9qgooN
X-Requested-With:XMLHttpRequest
Request Payload
------WebKitFormBoundaryg6rSLttylr9m2Yla
Content-Disposition: form-data; name="photo"; filename="Koala.jpg"
Content-Type: image/jpeg

------WebKitFormBoundaryg6rSLttylr9m2Yla-- 
```

它只是说状态失败。

# cocoa-touch - 核心绘图平移手势识别器 requireGestureRecognizerToFail

> ID：16195833
> 
> 赞同：0
> 
> 时间：2013-04-24T15:18:50.647
> 
> 标签：cocoa-touch, core-plot, uipangesturerecognizer

嗨，CorePlot 粉丝们，

我有一个有点棘手的问题：**是否可以在我的图表中调用自动 panGestureRecognizer？**
因为我想限制它被调用的选项：

```
[panRecognizer requireGestureRecognizerToFail recognizer2]; 
```

反之亦然！
TXH 任何有用的答案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:05:09.047

指向内置手势识别器的实例变量是私有的，但您可以在`gestureRecognizers`托管视图的数组中找到它。

# c# - 将文本框的自动背景颜色从灰色更改为白色（字段模板）

> ID：16195834
> 
> 赞同：1
> 
> 时间：2013-04-24T15:18:51.600
> 
> 标签：c#, asp.net, asp.net-dynamic-data

使用 ASP.NET 动态数据（字段模板问题） - 在我的数据库中的一个表中，一列被设置为一个“位”，在屏幕上显示为一个复选框。我使用“字段模板”将复选框更改为一个文本框，该文本框显示是或否，具体取决于它是否被勾选：

在数据库中。文件：

```
[UIHint("Yes_No_Boolean")]
public object Restricted_Hours { get; set; } 
```

然后：

```
public partial class BooleanField : System.Web.DynamicData.FieldTemplateUserControl {
protected override void OnDataBinding(EventArgs e) {
    base.OnDataBinding(e);

    object val = FieldValue;
    if ((bool)val == false)
    {
        TextBox1.Text = "No";
    }
    else
    {
        TextBox1.Text = "Yes";
    }
}

public override Control DataControl {
    get {
        return TextBox1;
    }
} 
```

现在唯一的问题是文本框显示为灰色背景。有谁知道如何将其更改为正常的白色背景？

**编辑** 我刚刚尝试过 CheckBox1.BackColor = System.Drawing.Color.White; 但没有变化

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T09:02:43.843

经过一番研究，我得到了它，不用担心：

```
TextBox1.BackColor = System.Drawing.Color.Transparent;
TextBox1.BorderStyle = BorderStyle.None;
TextBox1.ReadOnly = true; 
```

# sql - 如何使用 OVER 子句删除 SQL Server 中的重复行？

> ID：16195838
> 
> 赞同：4
> 
> 时间：2013-04-24T15:19:01.613
> 
> 标签：sql, sql-server, tsql

这是我表中的列：

```
Id
EmployeeId
IncidentRecordedById
DateOfIncident
Comments
TypeId
Description
IsAttenIncident 
```

我想删除相同的重复行`EmployeeId, DateOfIncident, TypeId`-`Description`只是为了澄清 - 我确实想保留其中之一。我想我应该使用`OVER`with 子句`PARTITION`，但我不确定。

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-24T15:22:14.577

如果您想保留一行重复组，您可以使用`ROW_NUMBER`. 在此示例中，我保留最低的行`Id`：

```
WITH CTE AS 
(
    SELECT rn = ROW_NUMBER() 
                OVER( 
                  PARTITION BY employeeid, dateofincident, typeid, description 
                  ORDER BY Id ASC), * 
    FROM dbo.TableName
) 
DELETE FROM cte 
WHERE  rn > 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-21T12:04:24.797

在不使用 CTE 的情况下使用此查询....

从 (select id,name,place, ROW_NUMBER() over (partition by id,name,place order by id) row_Count from dup_table) 删除 a where a.row_Count >1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-02T10:08:29.790

您可以使用以下查询。这假设您要保留最新行并删除其他重复项。

```
DELETE [YourTable]
FROM [YourTable]  
LEFT OUTER JOIN (  
   SELECT MAX(ID) as RowId 
   FROM [YourTable]   
   GROUP BY EmployeeId, DateOfIncident, TypeId, Description  
) as KeepRows ON  
   [YourTable].ID = KeepRows.RowId  
WHERE  
   KeepRows.RowId IS NULL 
```

# php - PHP 和 MySQL 错误：类 mysqli_result 的对象无法转换为字符串

> ID：16195840
> 
> 赞同：3
> 
> 时间：2013-04-24T15:19:18.367
> 
> 标签：php, mysqli

我收到错误消息：

> mysqli_result 类的对象无法转换为字符串。

代码：

```
<?php
  $con=mysqli_connect("78.46.51.231","root","","multicraft_daemon");
  if (mysqli_connect_errno($con)){
    echo "Failed to connect to MySQL: " . mysqli_connect_error();
  }

  $sql = ("select sum(`memory`) from `server`;");

  $result = mysqli_query($con, $sql);

  echo $result;    //$result is mysqli_result and can't be forced to string.
?> 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-24T15:21:54.143

您不能直接输出查询的结果。利用：

```
$sql = ("select sum(`memory`) AS memTotal from `server`");
// Show used memory
$result = mysqli_query($con, $sql);
echo $result->fetch_object()->memTotal; 
```

该`$result`变量包含一个对象（类型为 mysqli_result），您可以从中获取需要输出的标量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T15:21:41.423

`$result`是一个结果对象。来自手册[`mysqli_query()`](http://www.php.net/manual/en/mysqli.query.php)：

> 失败时返回 FALSE。对于成功的 SELECT、SHOW、DESCRIBE 或 EXPLAIN 查询，mysqli_query() 将返回一个[mysqli_result 对象](http://www.php.net/manual/en/class.mysqli-result.php)。对于其他成功的查询，mysqli_query() 将返回 TRUE。

# ios - 没有带有故事板的 customCell 类的 CustomCell

> ID：16195841
> 
> 赞同：0
> 
> 时间：2013-04-24T15:19:30.007
> 
> 标签：ios, xcode, uitableview, storyboard

我想创建一个自定义单元格而不创建自定义单元格类。我知道这是可能的。我在情节提要中创建了一个带有标签的原型单元的 tableviewcontroller。在属性中，我设置了单元格名称“mycell”。我使用的代码是：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{  static NSString *CellIdentifier = @"mycell";
   UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
   if (cell == nil) 
   { cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];}
   UILabel *title = (UILabel*) [cell viewWithTag:1];
   title.text = @"Hi";
   return cell;
} 
```

但是当我的应用程序运行时，我只看到一个空表，没有带有我的标签的单元格。在我使用的 tableView 方法中：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView { return 1;}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section { 
return 5; } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:30:15.357

如果您以编程方式添加 UILabel，则它需要分配 init，应该给定一个框架并作为子视图添加到单元格中。

```
UILabel *title = (UILabel*) [cell viewWithTag:1];
title.text = @"Hi";
return cell; 
```

应该

```
UILabel *title = [[UILabel alloc] initWithFrame:CGRectMake(50, 10, 50, 20)];
title.text = @"Hi";
[cell addSubview:title];
return cell; 
```

![在此处输入图像描述](https://i.stack.imgur.com/qelO8.png)

# android - 显示android模拟器内置键盘的问题

> ID：16195844
> 
> 赞同：0
> 
> 时间：2013-04-24T15:19:31.537
> 
> 标签：android, emulation, virtual, keypad

我是 Android 开发的新手，所以某些原因可能听起来不正确。

我遇到了一个问题，即当我为任何创建的具有不同参数的 AVD 运行模拟器时，虚拟键盘不显示，但它出现以下消息之一，只是没有预期的键盘：

1.  “在 AVD 中未启用硬件键盘。在屏幕键盘上使用”（取消选中“硬件键盘存在”复选框）。
2.  “硬件键盘。使用您的物理键盘提供输入”（选中复选框“硬件键盘存在”）。

我也玩过带有标志 hw.keyboard、hw.keyboard.lid、hw.touchScreen 的 config.ini，但没有什么能帮到我。

[我的问题的重点是如何像这样](http://www4.picturepush.com/photo/a/5553447/img/5553447.jpg)在模拟器窗口的右侧获得最常见的视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-08T10:39:42.047

所以，目前我已经解决了我的问题。之前的所有答案都没有跟上我的问题，可能是因为我这边解释不清楚。

所以，为了澄清这个问题，在我给出答案之前，重点是：**我的意思是没有硬件或软件键盘，而是模拟器自己的皮肤键盘和几个其他按钮。**我想，我的 AVD 管理器不正确地构建了 AVD。这是包含两个异常参数的特殊**config.ini**文件的谈话：

> 皮肤名称=320x480
> 
> skin.path=320x480

例如，在我将其更改为

> skin.name=HVGA
> 
> skin.path=platforms\android-XX\skins\HVGA

其中 XX 表示 Android SDK 文件夹中描述的皮肤路径中的任何版本，

所有皮肤都正确应用，模拟器看起来更好。

不幸的是，我的理解仍然存在问题。为什么在正确安装和配置 dev 之后。环境 AVD Manager 错误地格式化**config.ini**文件，默认情况下参数**hw.dPad=no**，**hw.trackBall=no**并且**skin.name**和**skin.path**设置为错误的值。

# c# - EF upsert 是否必须手动完成？

> ID：16195847
> 
> 赞同：33
> 
> 时间：2013-04-24T15:19:45.280
> 
> 标签：c#, sql, entity-framework

我想更新现有实体的引用成员。

我必须为 upsert 编写特定的代码吗？

含义：我必须检查我是在处理现有的参考成员还是新的参考成员。

有没有其他简单的方法可以做到这一点？

当你只做的时候会发生什么`Save`？

```
 public void SaveCofiguration(MamConfiguration_V1Ui itemUi)
        {
            var itemEf = mMamConfiguration_V1UiToEfConvertor.ConvertToNewEf(itemUi);

            using (var maMDBEntities = new MaMDBEntities())
            {
                IDal<MamConfiguration_V1> mamConfigurationDal = mDalFactory.GetDal<MamConfiguration_V1>(maMDBEntities);

                mamConfigurationDal.Save(itemEf);
            }
        }

         public MamConfiguration_V1 GetById(object id)
        {           
                id.ThrowIfNull("id");

                int configurationId = Convert.ToInt32(id);

                var result =
                    mMaMDBEntities.MamConfiguration_V1.SingleOrDefault(item => item.ConfigurationId == configurationId);

                return result;

        }

       public MamConfiguration_V1 Save(MamConfiguration_V1 item)
        {

                item.ThrowIfNull("item");

                var itemFromDB = GetById(item.ConfigurationId);

                if (itemFromDB != null)
                {
                    UpdateEfItem(itemFromDB, item);

                   // if (mMaMDBEntities.ObjectStateManager.GetObjectStateEntry(itemFromDB).State == EntityState.Detached)
//                    {
  //                      mMaMDBEntities.MamConfiguration_V1.AddObject(itemFromDB);
    //                }

                    // Attached object tracks modifications automatically
                    mMaMDBEntities.SaveChanges();

                    return item;
                }

       private void UpdateEfItem(MamConfiguration_V1 itemFromDb, MamConfiguration_V1 itemFromUi)
            {
                itemFromDb.UpdatedDate = DateTime.Now;

                itemFromDb.Description = itemFromUi.Description;

                itemFromDb.StatusId = itemFromUi.StatusId;

                itemFromDb.Name = itemFromUi.Name;

                itemFromDb.NumericTraffic = itemFromUi.NumericTraffic;

                itemFromDb.PercentageTraffic = itemFromUi.PercentageTraffic;

                itemFromDb.Type = itemFromUi.NumericTraffic;

                foreach (var item in itemFromDb.MamConfigurationToBrowser_V1.ToList())
                {
                    if (itemFromUi.MamConfigurationToBrowser_V1.All(b => b.BrowserVersionId != item.BrowserVersionId))
                    {
                        mMaMDBEntities.MamConfigurationToBrowser_V1.DeleteObject(item);
                    }
                }

                for (int i = 0; i < itemFromUi.MamConfigurationToBrowser_V1.Count; i++)
                {
                    var element = itemFromUi.MamConfigurationToBrowser_V1.ElementAt(i);
                    var item = itemFromDb.MamConfigurationToBrowser_V1.SingleOrDefault(b => b.BrowserVersionId == element.BrowserVersionId);
                    if (item != null)
                    {
                        // copy properties from element to item
                    }
                    else
                    {
                        element.Browser = mMaMDBEntities.Browsers.Single(browserItem =>
                            browserItem.BrowserID == element.BrowserID);

                        //element.MamConfiguration_V1 = itemFromDb;

                        //have also tried: element.MamConfiguration_V1 = null;

                        //element.MamConfiguration_V1Reference = null;

                        itemFromDb.MamConfigurationToBrowser_V1.Add(element);
                    }
                }
            } 
```

但我会期望`Save(itemUi)`并`SaveChanges()`能正常工作。不？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-24T15:22:42.620

```
public void InsertOrUpdate(DbContext context, UEntity entity)
{
    context.Entry(entity).State = entity.Id == 0 ?
                                   EntityState.Added :
                                   EntityState.Modified;
    context.SaveChanges();
} 
```

[http://forums.asp.net/t/1889944.aspx/1](http://forums.asp.net/t/1889944.aspx/1)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-10-04T14:37:38.590

为了避免查询然后插入或引发异常的开销，您可以利用底层数据库对合并或 upsert 的支持。

这个 nuget 包做得很好：[https ://www.nuget.org/packages/FlexLabs.EntityFrameworkCore.Upsert/](https://www.nuget.org/packages/FlexLabs.EntityFrameworkCore.Upsert/)

Github：[https ://github.com/artiomchi/FlexLabs.Upsert](https://github.com/artiomchi/FlexLabs.Upsert)

例子：

```
DataContext.DailyVisits
    .Upsert(new DailyVisit
    {
        // new entity path
        UserID = userID,
        Date = DateTime.UtcNow.Date,
        Visits = 1,
    })
    // duplicate checking fields
    .On(v => new { v.UserID, v.Date })
    .WhenMatched((old, @new) => new DailyVisit
    {
        // merge / upsert path
        Visits = old.Visits + 1,
    })
    .RunAsync(); 
```

底层生成的 sql 执行正确的 upsert。此命令立即运行并且不使用更改跟踪，因此这是一个限制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-10T14:22:26.050

请参阅 System.Data.Entity.Migrations 的“AddOrUpdate”方法。
[http://msdn.microsoft.com/en-us/library/system.data.entity.migrations.idbsetextensions.addorupdate%28v=vs.103%29.aspx](http://msdn.microsoft.com/en-us/library/system.data.entity.migrations.idbsetextensions.addorupdate%28v=vs.103%29.aspx)

```
using System.Data.Entity.Migrations;

public void Save(Person person) {
    var db = new MyDbContext();
    db.People.AddOrUpdate(person);
    db.SaveChanges();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-10T04:49:14.600

简单场景（演示）的“乐观”方法... dbContext.Find() 的智能感知帮助告诉我们，如果当前上下文中已经存在，它要么按键检索实体，要么查询数据库以获取它...然后我们知道它是否存在以添加或更新。我正在使用 EFCore v2.2.0。

```
 var existing = _context.Find<InventoryItem>(new object[] {item.ProductId});
  if (existing == null) _context.Add(item);
  else existing.Quantity = item.Quantity;
  _context.SaveChanges(); 
```

# php - 使用 JavaScript 将值传递给 PHP 文件并从 PHP 接收一组新值到 JavaScript 并在浏览器中显示

> ID：16195848
> 
> 赞同：0
> 
> 时间：2013-04-24T15:19:47.367
> 
> 标签：php, javascript

1.  我有一个名为 test.html 的页面。此 HTML 页面将包含 2 个 JavaScript 文件。我需要使用第一个 JavaScript 文件将变量值传递给 PHP 文件。用户可以在任意多的页面上复制此 javascript 以显示输出。
2.  从 JavaScript 文件接收变量的 PHP 文件根据变量的值从数据库中检索一些数据。这个检索到的值可以包含 HTML 内容。此 PHP 文件将始终驻留在我的服务器上。
3.  所有检索到的内容（来自 PHP 文件）都需要传递到第二个 JavaScript 文件，以便可以在浏览器中显示数据。此 JS 文件需要与第一个 JS 文件保持在一起才能显示数据。

***所以我有这个：***

**JavaScript 文件**

```
<script type= "text/javascript" src="http://www.myserver.com/custom_script.php?unique_id=12"></script> 
```

**PHP文件**

```
//custom_script.php
<?php
$unique_id= (int)$_GET['unique_id'];

$res = db_res(" SELECT col1, col2, col3, .... col10 FROM table WHERE unique_id = $unique_id
         LIMIT 1 "); 
$rows = mysql_fetch_array($res);
?>
<div id="1"><?php echo $rows['col1']; ?></div>
<div id="2"><?php echo $rows['col2']; ?></div>
<div id="3"><?php echo $rows['col3']; ?></div>
.
.
.
<div id="10"><?php echo $rows['col10']; ?></div> 
```

我需要将上面的所有 HTML 从 PHP 文件发送到第二个 JavaScript 文件，以便显示输出。请注意，CSS 样式也使用 Div ID 应用，所以我希望这些样式也会出现。请注意，可能有超过 10 列，因此非常感谢一种有效的数据传递方式。

那么，将 PHP 文件中的所有 HTML 数据一次性发送到位于 test.html 页面中的第二个 javascript 文件，以便 HTML 数据可以显示在 test.html 文件中的最简单和最好的方法是什么？

**编辑1：**

如果我的问题令人困惑，我向大家道歉。我只是想到了一个示例，因此想将其添加到我的编辑中。我希望你们都知道谷歌分析（GA）（或任何其他网站访问统计跟踪器）的作用。正确的？您注册了一个分析帐户，Google 会为您提供一段 JS 代码，您可以将其复制并粘贴到您的网站中。几天后，您可以登录您的 GA 帐户查看统计信息。正确的？我在这里尝试做的事情是一样的。

用户来到我的网站并注册一个帐户，我给他们 JS 文件，他们可以粘贴到他们的网站上。GA 和我的网站之间的唯一区别是 GA 对您来说是个人的，对其他人没有，但您，帐户持有人可以看到它。而在我的情况下，只要您在网站上包含 JS 文件，其他人也可以看到您的数据。因为用户不能只获取我的 PHP 文件并在他们的服务器上运行它，所以我试图通过在 JS 文件中提供完整路径来访问我的 PHP 文件。

**例如：**

`<script type= "text/javascript" src="http://www.myserver.com/custom_script.php?unique_id=12"></script>`

这不是一个实际的 JS 文件，它只是我的 custom_script.php 脚本接收用户的 unique_id、查询我的数据库并发回与该请求用户相关的 HTML 数据的媒介。我被这部分困住了。希望这可以阐明我正在尝试做的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:44:34.360

jQuery 文档实际上给出了一个与您的问题几乎相同的示例：

[http://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)

```
$.get('ajax/test.html', function(data) {
  $('.result').html(data);
  alert('Load was performed.');
}); 
```

这将获得一个 html 页面并将其插入到具有“result”类的 html 元素下。

您应该能够替换您的 php 脚本 url 并指定输出的显示位置。

如果您担心与其他 jQuery 实例发生冲突，请阅读以下内容： http: [//api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

如果您想编写自己的 AJAX 处理程序，请查看此页面： [https ://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest)

基本上你会做这样的事情（取自链接）：

```
function reqListener () {
  console.log(this.responseText);
};

var oReq = new XMLHttpRequest();
oReq.onload = reqListener;
oReq.open("get", "yourFile.txt", true);
oReq.send(); 
```

我认为，如果您以前从未这样做过，那么这样做是值得的，但是您会发现许多已经为您解决的潜在问题。

理想情况下，如果我这样做，我会从处理程序返回 json 并允许用户决定如何显示它，但那是你的电话。

# wpf - WPF 的 TextBlock 在 Windows 7 和 Windows 8 之间的区别

> ID：16195851
> 
> 赞同：2
> 
> 时间：2013-04-24T15:19:53.743
> 
> 标签：wpf, windows-8, textblock, kerning

在调查一些仅在我的机器上失败的单元测试时，我注意到 TextBlock 在 Windows 7 和 Windows 8 机器上呈现的文本不同。为了检查这个问题，我创建了只包含一个 TextBlock 的示例应用程序：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <TextBlock Text="yo" FontSize="100" FontFamily="Verdana" />
    </Grid>
</Window> 
```

您可以看到（或者至少我希望如此）Windows 7 上的文本长了 1 像素——实际上“y”和“o”之间的字距增加了 1 像素：
![区别win7/8](https://i.stack.imgur.com/M1k4G.png)

我用字体阅读器软件检查了两台机器上的 Verdana.ttf 字体文件，列出的“y”和“o”之间的字距相同：-18。
还检查了 .NET Framework 的版本，它们也相同：4.5.50709。
...我仍然想知道是什么导致了这种差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-21T11:39:31.987

我宁愿认为这与 ClearType 或抗锯齿有关，Microsoft 会在每个 Windows 版本之间不断更改该代码。不要认为您可以对此做任何事情，只需将这些差异考虑到您的单元测试中即可。

# python - django 查询集的批量联合

> ID：16195854
> 
> 赞同：0
> 
> 时间：2013-04-24T15:19:58.217
> 
> 标签：python, django, django-1.3

我正在尝试从递归函数的输出中获取单个查询集，但遇到了性能问题。

基本上，尝试组合单个查询集的行为似乎使处理时间增加了一倍（由于实施，我期待这一点）但我想知道我是否可以更有效地做到这一点。

```
def intersect(self, list_of_querysets):
    combined = list_of_querysets[0]
    for queryset in list_of_querysets:
        combined = combined | queryset
    return [combined]

def _get_template_folders(self, template_folder_list):
    """
    :rtype : list
    """

    parents = []
    for template_folder in template_folder_list:
        if not TemplateFolder.objects.filter(pk=template_folder).exists():
            continue
        templates = TemplateFolder.objects.filter(pk=template_folder)
        for template in templates:

            parent_folders = self._get_template_folders([template.template_folder_parent_id])
            if parent_folders is not None:
                parents.extend(parent_folders)

        if templates is not None:
            parents.append(templates)
    if parents:
        return parents
    else:
        return None

template_folders_list = self.intersect(self._get_template_folders(template_folder_list)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:31:06.070

没有看到你的模型很难说，但你的 TemplateFolder 模型似乎是某种树结构。如果是这样，您应该研究使用 MPTT 之类的东西将其存储在数据库中：这是一种算法，它根据左右节点值在每一行上注释树结构的描述，因此可以查询 a 下的所有内容特定的父级效率极高。有一个很棒的 Django 实现：[django-mptt](https://github.com/django-mptt/django-mptt)。

# xcode - 重置 iOS 模拟器应用程序数据以首次运行应用程序

> ID：16195859
> 
> 赞同：84
> 
> 时间：2013-04-24T15:20:07.610
> 
> 标签：xcode, ios-simulator

我刚刚写完一些代码来检查它是否是应用程序第一次运行然后显示一条消息，如果不是第一次则显示另一条消息..

如何在 Xcode 上重置模拟器，以便我可以在应用程序第一次运行时对其进行测试？

我尝试清理构建文件夹，但它没有工作..

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2013-04-24T15:23:17.057

在 iOS 模拟器中，按**屏幕**顶部菜单中的 iOS 模拟器，然后按“**重置内容和设置...** ”。这将清除整个模拟器。

或者，在模拟器的主屏幕上，以与在物理设备上相同的方式卸载应用程序，按住应用程序图标直到左上角出现“ **x** ”，然后按“x”，并从警报视图中选择“**删除”。**这将清除与单个应用程序关联的所有数据。

然后进行清理，构建并运行。

编辑：

从 Xcode 11+ 模拟器开始，它位于 Device > Erase All Content and Settings 下

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2016-05-31T03:54:02.170

在 XCode 中执行此操作的正确方法是：（必须先关闭模拟器）

`xcrun simctl erase <device UDID>` 或者 `xcrun simctl erase all`

要找出 UDID，请使用：

`xcrun simctl list`

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2018-08-16T19:53:15.250

目前（模拟器版本 10.0），您可以通过以下方式进行操作：

硬件 > 擦除所有内容和设置...

[![重置模拟器的方式截图](https://i.stack.imgur.com/c8peW.png)](https://i.stack.imgur.com/c8peW.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-29T17:27:36.347

@Tim 的答案对于交互式使用可能更容易。

我们使用脚本进行自动化测试并删除模拟器的数据目录以确保其干净。模拟器重新启动时会重新创建基本信息。

删除以下内容：

`~/Library/Application Support/iPhone Simulator/${simulator.version}`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-11T09:06:21.450

真的不知道这是否是最好的方法，但以下对我有用：

首先杀死所有正在工作的模拟器

`killall Simulator 2>&- && sleep 5 || true`

之后重置所有设备

`xcrun simctl erase all`

ps.：我正在使用**XCode 8**

# jquery - 带有ajax请求的jquery循环与包含的警报完美配合，没有警报失败？

> ID：16195860
> 
> 赞同：0
> 
> 时间：2013-04-24T15:20:10.727
> 
> 标签：jquery

我有以下语法可以 100% 正确工作并填充相应的复选框：

```
for (var i = 1; i < 30; i++) {     
$.post('get_sku_prices', {data: $('#product'+i).val()},function(result) {
    $('#price'+i).val(result);
    $('#adjustedprice'+i).val(result);
});
alert(i);
} 
```

如前所述，工作正常。如果我删除警报并且只有

```
for (var i = 1; i < 30; i++) {   
$.post('get_sku_prices', {data: $('#product'+i).val()},function(result) {
    $('#price'+i).val(result);
    $('#adjustedprice'+i).val(result);
});

} 
```

没有警报就不会填充字段，就像警报强制页面刷新一样。

有任何想法吗？提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:21:12.517

这是因为在第一种情况下`alert()`是阻塞的，需要关闭循环才能继续。

在第二种情况下（没有警报），ajax 调用会立即执行而不等待响应。即当第一个请求的响应`(i=1)`到达时，`i`不一定`1`。

您可以通过使用`$.ajax`和它的`context`选项来修复它。

例如：

```
for (var i = 1; i < 30; i++) {     
    $.ajax({
        type: 'POST',
        url: 'get_sku_prices',
        data: {data: $('#product'+i).val()},
        context: {index: i}, // this value will be available in success as "this"
        success: function(result) {
            $('#price'+this.index).val(result); // use "this.index" here
            $('#adjustedprice'+this.index).val(result);
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:32:07.137

您可以创建自己的范围函数，如下所示：

```
for (var i = 1; i < 30; i++) {
    (function (index) {
        $.post('get_sku_prices', {
            data: $('#product' + index).val()
        }, function (result) {
            $('#price' + index).val(result);
            $('#adjustedprice' + index).val(result);
        });
    })(i)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:26:57.523

将 Count 发送到服务器并尝试将计数返回到您的结果中，并根据从结果中收到的计数而不是来自 for 循环的计数进行更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:29:32.923

尝试在函数执行中添加一些延迟

```
var i=0;
function postRequest(i){
$.post('get_sku_prices', {data: $('#product'+i).val()},function(result) {
    $('#price'+i).val(result);
    $('#adjustedprice'+i).val(result);
});
setTimeout(function(){
    postRequest(i++);
},1000);
} 
```

# java - javax.el.PropertyNotFoundException：在类型 org.hibernate.collection.internal.PersistentSet 上找不到属性“toArray”

> ID：16195861
> 
> 赞同：1
> 
> 时间：2013-04-24T15:20:17.260
> 
> 标签：java, jsf-2, el

我`hashset.toArray()[x]`用来在 jsf 视图中显示一个元素，这在我的机器上运行良好。但是当我将其移至测试服务器时，会引发上述错误。

两台机器都运行tomcat 7。

是什么导致了这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:48:51.930

EL 2.2 版引入了在 EL 中调用任意非属性相关方法的能力，它与 Servlet 3.0 齐头并进。此功能在 Servlet 2.5 / EL 2.1 等旧版本中不存在。

因此，如果您将 webapp 部署到具有 Servlet 3.0 兼容`web.xml`根声明的 Servlet 3.0 兼容容器，那么它将正常工作。但是，如果您将 webapp 部署到旧版本的容器中，或者使用`web.xml`指示旧版本的容器，或者将旧版本的任意容器特定 JAR 文件放在 webapp`/WEB-INF/lib`甚至服务器自己的容器中`/lib`，那么此功能不会工作。

如果您绝对肯定测试服务器正在运行 Tomcat 7 而不是 Tomcat 6 左右，那么这只能意味着`web.xml`已更改为指示旧版本，或者您的 webapp 或服务器上`/lib`到处都是任意容器- 特定的 JAR 文件，例如`jsp-api.jar`,`el-api.jar`等，它们只会与容器自己的库冲突（这通常由无知的初学者完成，以解决他们在 IDE 中面临的编译错误；应该以[不同](https://stackoverflow.com/questions/4076601/how-do-i-import-the-javax-servlet-api-in-my-eclipse-project/)的方式解决）。

# c# - C#生成唯一的Guid（数据库中的表中不存在）

> ID：16195863
> 
> 赞同：4
> 
> 时间：2013-04-24T15:20:19.657
> 
> 标签：c#, asp.net-mvc, database, primary-key, guid

我有一个主键类型为 Guid 的表。在我的 MVC 应用程序中，我想向该表添加一条记录。我知道`Guid.newGuid()`这会创建一个新的 Guid。这很好用，但我有一个担心。如何确保创建的 Guid 是唯一的（数据库中尚不存在）？有没有办法通过比较已经存在的值来生成它，以确保新的 guid 在数据库记录中是唯一的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:22:49.837

guid 生成技术的全部目的是它不需要。该算法将生成一个全局唯一值，即使它无法访问所有其他先前生成的 GUID。

特别是，该算法只生成一个大随机数。GUID 中有太多的数据位，以至于其中两个具有相同值的几率非常小。小到可以真正忽略它们。

有关更详细的分析，请参阅[Eric Lippert 关于该主题的博客](http://blogs.msdn.com/b/ericlippert/archive/2012/04/24/guid-guide-part-one.aspx)。（特别[是第三部分](http://blogs.msdn.com/b/ericlippert/archive/2012/05/07/guid-guide-part-three.aspx)。）

请注意，因此，使用 GUID 作为唯一标识符将在数据库中占用比仅使用数字标识符更多的空间。任何体面的数据库都会有一个特殊的列类型，专门设计为它将填充的唯一标识符；这样的列将能够确保唯一性，同时使用比 GUID 少得多的空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:22:23.933

产生重复的可能性非常低。但是，您可以`UNIQUE`对数据库表实施约束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T15:23:37.557

但是，新的 GUId 与数据库中存在的任何人匹配的可能性很小。

但是，如果您仍然想确保只创建一个 proc 或其他可以为 GUID 提供 true 或 false 的东西。如果它返回 true，则再次生成并重复此过程，直到没有获得唯一的 GUID。

# extjs - ExtJS 4 MVC 手风琴，带有来自 json 的动态可点击内容

> ID：16195865
> 
> 赞同：2
> 
> 时间：2013-04-24T15:20:21.857
> 
> 标签：extjs, extjs4, accordion, extjs4.1, dataview

我需要将子面板插入/添加到手风琴。这些子面板中的每一个都应该使用数据中的“字段”值来命名（见下文），并且每个子面板的内容应该是（标签或显示字段或？？），只要它是可点击的。来自服务器的 json 数据如下：

```
data: [{
    'field': 'cities',
    'values': [{
        'value': 'DC',
        'count': 5
    }, {
        'value': 'SF',
        'count': 2
    }, {
        'value': 'NYC',
        'count': 4
    }, {
        'value': 'Nashville',
        'count': 4
    }]
}, {
    'field': 'beaches',
    'values': [{
        'value': 'obx',
        'count': 1
    }, {
        'value': 'ocean city',
        'count': 2
    }, {
        'value': 'myrtle',
        'count': 4
    }]
}, {
    'field': 'planets',
    'values': [{
        'value': 'mercury',
        'count': 1
    }, {
        'value': 'venus',
        'count': 2
    }, {
        'value': 'earth',
        'count': 4
    }, {
        'value': 'mars',
        'count': 1
    }, {
        'value': 'jupiter',
        'count': 2
    }, {
        'value': 'uranus',
        'count': 4
    }, {
        'value': 'neptune',
        'count': 1
    }]
}] 
```

渲染工作！！:)

但是我无法获得有效的点击事件。最终，点击监听器需要让我访问选定的值+“字段”值。（例如，“行星”、“木星”）。

这应该很容易，但我无法让它工作。起初，我尝试嵌套 for 循环并动态创建组件，但无法添加有效的点击处理程序（也许 b/c 我正在商店加载处理程序函数中完成这项工作？）。我还尝试了面板中的数据视图（仅传入数组），但 itemSelector 没有触发。我已经根据代码尝试了“div.facet”、“div.facet_item”（以及其他一些等），但没有运气 - 可能是 b/c 我不知道如何在我的控制器的 this.control()：

```
'panel[itemId=pnlFacets] > panel > dataview': {
    itemclick: me.facetSelect
} 
```

和数据视图尝试的 tpl：

```
var tplFacet = new Ext.XTemplate(
    '<tpl for=".">',
        '<div class="facet">',
            //ignore - (this is handled in title of panel) '<label class="facet_field">{facetName}</label>',   
            '<tpl for="facetEntries">',
                '<div class="facet_item">{value}&nbsp;&nbsp;({count})</div>',
            '</tpl>',
        '</div>',
    '</tpl>'
); 
```

# php - 如何在表中添加新条目并更改其他条目的排序顺序

> ID：16195867
> 
> 赞同：1
> 
> 时间：2013-04-24T15:20:28.893
> 
> 标签：php, mysql, sorting

我正在创建一个论坛应用程序，并且我有一个存储类别的表。该表有 3 列：

```
Category_Id | Category_Name | CategoryOrder 
```

我有一个 PHP 脚本，它向数据库添加了一个新类别，它包括选择类别显示的顺序。因此，例如，如果我在数据库中存储了 5 个类别，并且我想添加一个新类别并使其成为`CategoryOrder`列中的第一类别，这意味着`CategoryOrder`其他类别的类别将不得不更改。

如果表中只有一个类别，我只需将其更新为新值并将该`1`值分配给新类别。但是，如果我有五行，我该怎么办。如何更改所有这些以增加`1`其当前值？我不知道我在这里是否有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:34:36.583

我这样做了几次。我现在找不到任何代码，所以我只发布一个算法（其中可能包含一些伪代码）：

1.  插入一个新值（更简单的一个）：
    *   更新所有与`CategoryOrder`新插入的类别更大或相同的类别： `UPDATE Categories SET CategoryOrder = CategoryOrder + 1 WHERE CategoryOrder >= $newCategory['order'];`
    *   插入您的新类别
2.  更新现有类别：
    *   检查新订单是否比原来更大或更小（如果相同则无需执行任何操作...）
    *   如果它更大，则更新所有`CategoryOrder`大于旧订单且小于新订单的类别并减去 1： `UPDATE Categories SET CategoryOrder = CategoryOrder - 1 WHERE CategoryOrder > $category['old_order'] AND CategoryOrder <= $category['new_order'];`- 通过这个你填补了空白
    *   如果它更小，则与它更大时类似，但将具有`CategoryOrder >= new_order`和的类别加 1`CategoryOrder < new_order`

这应该是它。

**编辑**：对第二种情况的解释（更新）：

假设我们有这些条目：

```
Category_Id | Category_Name | CategoryOrder
1           | name_1        | 1
2           | name_2        | 2
3           | name_3        | 3
4           | name_4        | 4
5           | name_5        | 5 
```

现在我们要使用 order 编辑 category`2`并将其更改为`4`. 我们要做的就是按顺序排列类别并按顺序`3`递减`4`：

```
Category_Id | Category_Name | CategoryOrder
1           | name_1        | 1
2           | name_2        | 2
3           | name_3        | 2
4           | name_4        | 3
5           | name_5        | 5 
```

最后更新所需的类别，它的顺序是`4`：

```
Category_Id | Category_Name | CategoryOrder
1           | name_1        | 1
3           | name_3        | 2
4           | name_4        | 3
2           | name_2        | 4
5           | name_5        | 5 
```

**现在清楚了吗？**

现在，如果我们想用 order 更改 category`5`成为第一个呢？更新所有具有 order >=`1`和`5`< 的类别并将 order 设置为`+1`：

```
Category_Id | Category_Name | CategoryOrder
1           | name_1        | 2
3           | name_3        | 3
4           | name_4        | 4
2           | name_2        | 5
5           | name_5        | 5 
```

最后更新所需的类别：

```
Category_Id | Category_Name | CategoryOrder
5           | name_5        | 1
1           | name_1        | 2
3           | name_3        | 3
4           | name_4        | 4
2           | name_2        | 5 
```

（请注意按其顺序和 ID 排序的类别）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:29:57.927

尝试先增加 CategoryOrder

```
update categorytable set CategoryOrder = CategoryOrder + 1 
```

然后插入新记录`CategoryOrder = 1`

# ios - 我想我发现了 UIActionSheet 的一个重要错误，是吗？

> ID：16195868
> 
> 赞同：1
> 
> 时间：2013-04-24T15:20:31.287
> 
> 标签：ios, sdk, uiactionsheet

=== 代码 ===

```
UIActionSheet* as = // UIActionSheet alloc one

[as addButtonWithTitle:@"Button1"];
[as addButtonWithTitle:@"Button2"];
[as addButtonWithTitle:@"Button3"]; // this button will be set destructive
[as addButtonWithTitle:@"Button4"];

[as addButtonWithTitle:@"ButtonMore1"];
[as addButtonWithTitle:@"ButtonMore2"];
[as addButtonWithTitle:@"ButtonMore3"];

as.destructiveButtonIndex = 2; 
```

=== 错误 ===

我的应用程序在横向模式下运行，超过 5 个按钮的操作表将以全屏样式显示，因此用户可以上下滚动以找到他想要的特殊按钮。

然后破坏性按钮（“Button3”）将被提升到顶部，我猜苹果不希望人们在滚动操作表时错误地点击破坏性按钮，但这会使 buttonIndex 和 buttonTitle 的顺序错误：

```
NSLog(@"index = %d title = %@",buttonIndex,[actionSheet buttonTitleAtIndex:buttonIndex]); 
```

输出不完全是它们应该是的。但如果我没有设置任何破坏性按钮，那么它会按预期工作。

# c# - 如何使用 WPF 搜索数据库并在 DataGrid 中显示结果

> ID：16195869
> 
> 赞同：1
> 
> 时间：2013-04-24T15:20:39.810
> 
> 标签：c#, sql, wpf, winforms

我正在尝试从我的数据库中的“PurchaseTable”表中搜索购买并在 DataGrid 中显示结果，我知道如何使用 Windows 窗体进行操作：

```
private void SearchButton_Click(object sender, EventArgs e)
    {
        DataTable dt = new DataTable();
        SqlDataAdapter SDA = new SqlDataAdapter("SELECT TitleOfRecord, DateOfPurchase FROM  PurchaseTable WHERE (NameOfCustomer = '"+NameOfCustomerSText.Text+"')", connection);
        //Query that will return the Title of the Records and Dates of purchases depending on the Customer which has been searched for
        SDA.Fill(dt);
        PurchaseResults.DataSource = dt;
        //Results will appear in the PurchaseResults DataGrid
    } 
```

但我不知道如何用 WPF 做到这一点，到目前为止我有这个但它不起作用：

```
private void SearchCustomerButton_Click(object sender, RoutedEventArgs e)
    {
        DataTable dt = new DataTable();
        SqlDataAdapter SDA = new SqlDataAdapter("SELECT TitleOfRecord, DateOfPurchase FROM  PurchaseTable WHERE (NameOfCustomer = '" + NameOfCustomerSText.Text + "')", connection);
        //Query that will return the Title of the Records and Dates of purchases depending on the Customer which has been searched for
        SDA.Fill(dt);
        PurchaseResults.DataContext = dt;
        //Results will appear in the PurchaseResults DataGrid
    } 
```

我有这些命名空间：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Data.SqlClient;
using System.Data; 
```

我用这段代码来解决我的问题：

```
private void SearchCustomerButton_Click(object sender, RoutedEventArgs e)
    {
        SqlDataAdapter da;
        DataSet ds;
        da = new SqlDataAdapter("SELECT TitleOfRecord, DateOfPurchase FROM  PurchaseTable WHERE (NameOfCustomer = '" + NameOfCustomerSText.Text + "')", connection);
        //Query that will return the Title of the Records and Dates of purchases depending on the Customer which has been searched for
        ds = new DataSet();
        da.Fill(ds);
        PurchaseResults.ItemsSource = ds.Tables[0].DefaultView;
        //Results will appear in the PurchaseResults DataGrid
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:22:32.950

改变

```
PurchaseResults.DataContext = dt; 
```

至

```
PurchaseResults.ItemsSource = dt; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:27:59.500

您是否定义了数据网格中的列。如果不是，当您将 AutoGenerateColumns 属性设置为 true 时，WPF 可以自动为您生成它。

```
PurchaseResults.AutoGenerateColumns = true;
PurchaseResults.ItemsSource = dt; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T15:31:05.563

当您使用后面的代码时，您应该提供 DataGrid `ItemSouce`，但在使用 MVVM 架构处理绑定时，`DataContext`则使用。

所以更换

```
PurchaseResults.DataContext = dt; 
```

至

```
PurchaseResults.ItemsSource = dt; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T15:43:34.523

你可以试试

```
PurchaseResults.ItemsSource = dt.AsDataView(); 
```

# encoding - 如何在 Sublime Text 中查看文件的当前编码？

> ID：16195871
> 
> 赞同：364
> 
> 时间：2013-04-24T15:20:41.080
> 
> 标签：encoding, sublimetext2

如何在 Sublime Text 中查看文件的当前编码？

这似乎是一件非常简单的事情，但搜索并没有产生太多效果。任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：604
> 
> 时间：2013-12-18T12:11:43.263

由于此线程是 google 搜索中的热门结果，因此对于 sublime text 3 build 3059+ 执行此操作的方法如下：在用户首选项中，添加以下行：

```
"show_encoding": true 
```

* * *

## 回答 #2

> 赞同：315
> 
> 时间：2013-04-24T18:05:39.953

如果您不想使用插件，另一种选择：

`Ctrl`+``` 或

`View -> Show Console`

在控制台上键入以下命令：

```
view.encoding() 
```

如果您想要更具侵入性的东西，可以选择创建一个执行以下命令的快捷方式：

```
sublime.message_dialog(view.encoding()) 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2013-04-24T17:04:15.820

使用[EncodingHelper](https://github.com/SublimeText/EncodingHelper)插件，您可以在状态栏上查看文件的编码。您还可以转换文件的编码并扩展其他功能。

![演示](https://i.stack.imgur.com/KRwEm.png)

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2014-12-22T04:35:26.830

就我而言，**没有任何插件**，只需从“文件”菜单或使用键盘快捷键保存文件

`CTRL`+ `S`(Windows, Linux) 或`CMD`+ `S`(Mac OS)

在编辑器窗口底部的状态栏中，在括号之间简要显示当前编码。这个建议适用于 Sublime Text 2 和 3。

请注意，如果您尝试使用无法代表文件中所有字符的编码保存文件，则 Sublime Text 3 状态栏中显示的编码可能会显示文件的错误编码。在这种情况下，您会看到一个信息对话框，并且 Sublime 告诉您它正在回退到 UTF-8。情况可能并非如此，所以要小心。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-10-22T00:14:06.660

[ShowEncoding](https://github.com/geoffstokes/ShowEncoding)是另一个简单的插件，可以在状态栏中显示编码。仅此而已，要在编码之间进行转换，请使用内置的“使用编码保存”和“使用编码重新打开”命令。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-26T03:30:47.413

插件 ConverToUTF8 也有这个功能。

# compilation - 如何在 OCaml 中很好地管理编译？

> ID：16195873
> 
> 赞同：5
> 
> 时间：2013-04-24T15:20:44.710
> 
> 标签：compilation, ocaml

我正在学习更复杂的编译`OCaml`。

首先，我不是 C 程序员，我真的不知道什么是`make`等。我正在使用`Mac OS X terminal`，我也是一名 Java 程序员。

我发现在 OCaml 中，有一些类似`ocamlc`, `ocamlbuild`, `ocamlfind`,`oasis`等的东西。我对它们感到非常困惑。

* * *

**问题 1**

谁能告诉我应该在`ocamlc`, `ocamlbuild`, `ocamlfind`,中使用哪一个`oasis`？

* * *

**问题2**

我试过这个教程[http://nicolaspouillard.fr/ocamlbuild/ocamlbuild-user-guide.html](http://nicolaspouillard.fr/ocamlbuild/ocamlbuild-user-guide.html)，它对`ocamlbuild`.

但是，如果我想使用外部库，例如`ocaml-batteries`or `camomile`，我该如何使用链接这些库`ocamlbuild`？

* * *

**问题 3**

这是一个关于所有外部库的更实际的问题。

所以对于很多 ocaml 库，我都是`opam install`用来安装的。

1.  为什么需要安装库？我的意思是，在 Java 中，通常我们只是将 lib 复制到某个地方，然后将 lib 的路径包含到`-classpath`or`-cp`中。那为什么我们需要安装 OCaml 库呢？

2.  在`opam install`一个库之后，例如`camomile`（对于 utf8），发生了什么，将会发生什么？这种安装只是下载一个库的源文件并将其复制到某个地方吗？

3.  那怎么才能找到图书馆呢？例如，如果我`opam install camomile`，那么我如何在我自己的代码中链接或使用它们？

4.  通常如何使用`ocaml library`？例如，对于`camomile`（[http://camomile.sourceforge.net/dochtml/index.html](http://camomile.sourceforge.net/dochtml/index.html)）他们有三个模块：`CamomileLibrary`等。所以我应该`open`在我的代码中使用模块，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:44:27.727

工具：

*   ocamlc：OCaml 到字节码的编译器
*   ocamlopt：OCaml 到本地代码编译器
*   ocamlfind：围绕 ocamlc 和 ocamlopt 的包装以编译/链接各种 OCaml 包，即使用“ocamlfind ocamlopt -package camomile -c yourfile.ml”与 yourfile.ml 一起编译，然后使用“ocamlfind ocamlopt -package camomile yourfile.cmx” -linkpkg -o yourfile' 创建可执行文件
*   oasis：一个构建系统生成器，例如用于 C/C++ 的 autoconf&automake，但更简单

使用最近的 ocamlbuild，您可以使用“ocamlbuild -use-ocamlfind -pkg -pkg ...”作为使用 ocamlfind 包 package1、package2 构建项目的快速方法。下一步是使用“ocamlbuild -use-ocamlfind”并将 package() 指令放入 _tags 文件中。

但是我建议尝试 oasis，它简化了为您的项目创建构建系统的过程。如果您想了解在使用 oasis 或 ocamlbuild 时“幕后”发生了什么，请参阅 _build/_log 文件。它包含所有 ocamlfind/ocamlc/ocamldep/ocamlopt 调用。

opam 问题可能属于一个单独的问题。

# neural-network - 前馈神经网络

> ID：16195874
> 
> 赞同：1
> 
> 时间：2013-04-24T15:20:46.343
> 
> 标签：neural-network

如果我使用逻辑函数作为我的 sigmoid，在我的时代是否会出现权重大于 1 的情况？只是想检查我是否正在为我的前馈实现编码正确的方式。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:31:08.137

这是可能的。例如，如果你有一个没有偏差的 1 输入 1 输出前馈网络，你唯一的训练输入是 0.1，对应的输出是 1，那么权重越高越好。逻辑函数只是确保输出在 0 和 1 之间。

# javascript - 正则表达式从javascript中的表中删除特定的tr标签

> ID：16195875
> 
> 赞同：1
> 
> 时间：2013-04-24T15:20:50.047
> 
> 标签：javascript, regex

```
var tableData = '<tr id=7020934><td>7020934</td><td>anuradha</td><td><a href="#" class="delete">x</a></td></tr><tr id=8736519><td>8736519</td><td>Rohan</td><td><a href="#" class="delete">x</a></td></tr>'; 
```

我想删除具有给定 id 的 tr 标签。

我写了以下正则表达式，但每次都返回 false

```
var regex='<tr id=7020934.+?<\/tr>';
alert(/regex/.test(tableData)); 
```

但是如果我使用

```
alert(/<tr id=7020934.+?<\/tr>/.test(tableData)); 
```

我在警报框中变得真实。我无法理解这两种方法之间的区别。

由于我的 ID 是动态生成的，我想采取第一种方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:22:56.773

你应该做

```
var regex=/<tr id=7020934.+?<\/tr>/;
alert(regex.test(tableData)); 
```

问题是介于两者之间的任何内容`//`都被视为正则表达式而不是变量。

如果要基于变量构造正则表达式：

```
var regex = new RegExp(pattern,modifiers) 
```

所以在你的情况下是：

```
var regex='<tr id=7020934.+?<\/tr>';
alert(new RegExp(regex).test(tableData)); 
```

基本上你可以想到

```
var regex = /pattern/modifiers; 
```

作为

```
var regex = new RegExp(pattern,modifiers); 
```

# php - 如何将函数从 PHP Procedural 转换为 PHP MVC？

> ID：16195886
> 
> 赞同：1
> 
> 时间：2013-04-24T15:21:19.763
> 
> 标签：php, codeigniter, procedural-programming

我的视图页面上有这个功能，它会截断一些数据以将其呈现在我的表格上。

```
function truncate($mytext) {  
    //Number of characters to show  
    $chars = 100;  
    $mytext = substr($mytext,0,$chars);  
    $mytext = substr($mytext,0,strrpos($mytext,' '));    
    return $mytext;  
    } 
```

我为我的动态文本设置了一个局部变量：

```
$mydescription = $value['PROBLEM_DESCRIPTION'] 
```

在同一页面上，我有这个：

```
echo '<td><p>' .truncate($mydescription). '; ?></p><</td> 
```

它运行完美，所以我的问题是如何使用 Codeigniter 将其应用于 MVC 架构？如果有人有想法请告诉我，谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:41:55.700

由于您已经有一个工作代码，您需要决定的是应该将其转移到 CI 的 MVC 范式中的哪个位置。我建议把它放在一个[helper](http://ellislab.com/codeigniter/user-guide/general/helpers.html)里面。CI 中的 Helpers 顾名思义，就是一个简单的 php 文件，其中包含许多帮助您完成某些任务的函数。假设你把它放在一个名为“utility.php”的文件中，然后你可以在任何你需要的地方包含这个文件

```
$this->load->helper('utility'); 
```

然后调用截断函数。

现在，如果你有一堆相关的任务想要整齐地组织在一个基于类的结构中，你可以创建自己的 CI[库](http://ellislab.com/codeigniter/user-guide/general/creating_libraries.html)。假设您创建了一个名为 'truncate' 的库，然后类似于 helpers 这些加载为

```
$this->load->library('truncate'); 
```

就个人而言，对于一堆实用程序，我会将它们全部放入帮助程序中，而不是扩展核心 CI 类或创建自定义库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:35:00.077

您至少应该将此函数定义为模型的方法（您从中获取此描述）。

```
class TextModel extends CI_Model {
   ...
   public function getShortDescription(){
       $chars = 100;  
       $mytext = substr($this->mytext,0,$chars);  
       $mytext = substr($mytext,0,strrpos($mytext,' '));    
       return $mytext;
   }
} 
```

并且在您的控制器中，类似于：

```
class Blog extends Controller {

    function index()
    {
            $this->load->model('TextModel');
        $data['short_description'] = $this->TextModel->getShortDescription();

        $this->load->view('blogview', $data);
    }
} 
```

最后，在您看来：

```
echo '<td><p>'.$short_description.'</p></td>'; 
```

我不熟悉 CodeIgniter，但我想任何数据操作都应该在模型中完成，因此您将保持控制器“精简”并且不会违反 MVC 范式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:32:16.447

控制器：创建一个控制器**truncate.php**。

```
<?php
 Class Truncate extends CI_Controller {

 function __construct() {
  parent::__construct();
 }

 function truncate_text($mytext) {  
     //Number of characters to show
     $chars = 100;
     if(empty($mytext))
         echo '$mytext is empty.';
     $mytext = substr($mytext,0,$chars);  
     $data['mytext'] = substr($mytext,0,strrpos($mytext,' '));    
     $this->load->view('truncate_view',$data);
 } 
```

视图：创建视图文件**truncate_view.php**

```
<?php
    echo '<td><p>'.$mytext.'</p></td>';
   //Write your other view code if any are present.
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T15:29:06.910

您可以在控制器中执行此操作：

```
class Something extends CI_Controller{
    public function index(){
        $data['mytext'] = $this->_truncate('some text to truncate');

        //truncated text will be available in the view as $mytext
        $this->load->view('some_view', $data);
    }

    private function _truncate($text = NULL){
        if($text){
            $chars = 100;  
            $mytext = substr($text,0,$chars);  
            $mytext = substr($text,0,strrpos($text,' ')); 
            return $mytext;
        }  
    }
} 
```

* * *

## 编辑：

您在视图中调用 db 东西，这完全不是 Codeigniter MVC。

这可能是 MVC 中的样子：

## 控制器

```
class Something extends CI_Controller{
    public function index(){
        $test_text = $this->my_model->get_text();
        $data['test_text'] = $this->_truncate($test_text);

        //truncated text will be available in the view as $test_text
        $this->load->view('some_view', $data);
    }

    private function _truncate($text = NULL){
        if($text){
            $chars = 100;  
            $mytext = substr($mytext,0,$chars);  
            $mytext = substr($mytext,0,strrpos($mytext,' ')); 
            return $mytext;
        }  
    }
} 
```

## 模型

```
class My_Model extends CI_Model{

    public function get_text(){
        //$this->db->get_where....or other db functions
        return "testing text... this is only a test";
    }

} 
```

## 看法

```
<html>
<body>
<b><?php echo $test_text; ?></b>
</body> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T16:06:03.650

当前的答案说明您可以将该方法添加到模型和控制器中。从功能上讲，这没问题，正如您所说，无论您放置它，该功能都可以完美运行。

当您需要在另一个控制器中调用相同的方法时会发生什么？还是使用不同的型号？

最有可能的是，您最终会出现一些代码重复。

作为一种可能的方案，您可以创建一个类库，允许您将所有字符串操作保存在一个地方。只需向您的课程添加更多方法...

```
// example/libary/path/TextFormatter.php
class TextFormatter
{
  protected $_text = '';

  public function __construct($text)
  {
    $this->_text = $text;

    return $this;
  }

  public function truncate($maxChars = 100)
  {
    $truncated = substr($this->_text, 0, $maxChars);  
    $truncated = substr($truncated, 0, strrpos($truncated,' '));    

    return $truncated;
  }

  public function stripHtml()
  {
    ///.....
  }

  public function doSomethingElseWithText()
  {

  }

} 
```

然后在控制器...

```
// Controller.php

class SomeController extends Controller
{

  public function index()
  {
    $formatter = new TextFormatter('Example text string');  
    $data['formattedText'] = $formatter->truncate();

  }

} 
```

唯一需要注意的是，`TextFormatter`该类需要从您使用它的任何地方自动加载/调用。

# android - Android 上的 Facebook 深度链接

> ID：16195889
> 
> 赞同：21
> 
> 时间：2013-04-24T15:21:40.967
> 
> 标签：android, facebook, android-intent

我正在尝试在我的应用程序上实现 Facebook 的深度链接功能并遇到以下情况：

我有一个名为 MainActivity 的活动，它的声明如下：

```
 <activity
        android:name="com.mypackage.android.MainActivity">

        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

此活动 + 我的包名称也在我的应用程序设置中声明在 facebook 开发者网站上。

在 Facebook 的应用程序上单击链接后，我应该通过我的活动的 onCreate 方法来处理此事件。以下代码处理该事件：

```
 public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        Uri target = getIntent().getData();

        if (target != null){
          // got here via Facebook deep link
          // once I'm done parsing the URI and deciding
          // which part of my app I should point the client to
          // I fire an intent for a new activity and
          // call finish() the current activity (MainActivity)
        }else{
          // activity was created in a normal fashion
        }
    } 
```

一切都按计划进行，除了以下情况：

1.  用户启动了我的应用
2.  MainActivity 创建
3.  次要活动已创建
4.  MainActivity 完成
5.  应用程序通过设备主页按钮进入后台
6.  深层链接在 Facebook 的应用程序上被点击

在这种情况下，我的应用程序再次进入前台，但 MainActivity 的 onCreate / onNewIntent 不会被调用，而是 SecondaryActivity 的 onResume() 被调用并恢复到它的最后状态。

注意：我已经在带有 Android 4.2.1 的三星 Nexus 上测试了这个问题并得到了这个结果，但在带有 Android 2.3.5 的 Galaxy S1 上测试时，它按我最初的预期工作。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-29T05:57:49.793

Facebook 通过显式启动您的“MainActivity”（您在开发人员页面中提供给他们的那个）从他们自己的应用程序启动您的应用程序。

这样 - Android 的默认行为是：如果应用程序已经运行，那么再次调用`startActivity()`不会从头开始新任务，而**只会恢复到前台已经运行的任务。**

但好消息是您可以通过向 MainActivity 添加`android:launchMode="singleTask"`. 它的定义是：

> 系统创建一个新任务并在新任务的根目录下实例化活动。但是，如果活动的实例已经存在于单独的任务中，系统会通过调用其 onNewIntent() 方法将意图路由到现有实例，而不是创建新实例。一次只能存在一个活动实例。

从这一点开始，您始终可以响应起始意图，并且从那时起，您始终可以通过使用两个标志`Intent.FLAG_ACTIVITY_SINGLE_TOP`&&`Intent.FLAG_ACTIVITY_CLEAR_TOP`组合重新启动活动来导航回已经在后台的任务（如果存在）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-28T17:23:57.113

请参阅[http://developer.android.com/guide/topics/manifest/activity-element.html](http://developer.android.com/guide/topics/manifest/activity-element.html)

你可以玩：

```
android:clearTaskOnLaunch
android:noHistory
android:launchMode 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T16:37:12.077

您需要在意图过滤器中包含更多信息：

```
<intent-filter>
   <action android:name="android.intent.action.VIEW"></action>
   <category android:name="android.intent.category.DEFAULT"></category>
   <category android:name="android.intent.category.BROWSABLE"></category>
   <data android:host="www.yoursite.com" android:scheme="http"></data>
</intent-filter> 
```

这将捕获指向您网站的链接（确保更改 URL），并将它们定向到您在其下定义此意图过滤器的任何 Activity。

# mysql - 在 ubuntu ARMHF 上使用 mySQL 触发器 WHITOUT sys_exec 调用外部脚本

> ID：16195894
> 
> 赞同：1
> 
> 时间：2013-04-24T15:21:50.220
> 
> 标签：mysql, linux, triggers, arm

我需要从触发器调用外部脚本来拦截数据库中的每个插入。这是因为我无法轮询该值，我正在为具有 ARM 架构且只有 250MB RAM 的嵌入式系统进行编码。触发器是正确的选择，触发器的代码运行良好，我得到：

```
FUNCTION mydb.sys_exec does not exist (MySQL error code: 1305, SQLState: 42000 ) 
```

所以我尝试安装这个： [https ://github.com/mysqludf/lib_mysqludf_sys](https://github.com/mysqludf/lib_mysqludf_sys)

但它让我：

```
ERROR: You need libmysqlclient development software installed 
to be able to compile this UDF, on Debian/Ubuntu just run:
apt-get install libmysqlclient15-dev 
```

所以如果我输入

```
sudo apt-get install libmysqlclient15-dev 
```

我得到：注意，选择“libmysqlclient-dev”而不是“libmysqlclient15-dev”

当然它不是正确的包，因为它不起作用。git 中包含的 .so 文件是为 intelx86 编译的。

有人有想法吗？由于缺少大量依赖项，因此在 git 中编译 .c 是完全不可能的。

或者..如何在没有 sys_exec 的情况下从触发器执行外部脚本？

PS：为了完整起见，这是触发脚本：

分隔符@@

```
CREATE TRIGGER command_controller
AFTER INSERT ON myDB.foo
FOR EACH ROW
BEGIN
 DECLARE cmd CHAR(255);
 DECLARE result int(10);
 SET cmd='./foo ';
 SET result = sys_eval(cmd);
END;
@@
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-29T15:09:00.370

这是一个适合我的最小版本：

```
#include <string.h>
#include <stdlib.h>
#include <mysql.h>

my_bool sys_exec_init(
  UDF_INIT *initid
, UDF_ARGS *args
, char *message
){
  unsigned int i=0;
  if(args->arg_count == 1
  && args->arg_type[i]==STRING_RESULT){
    return 0;
  } else {
    strcpy(
      message
    , "Expected exactly one string type parameter"
    );
    return 1;
  }
}
void sys_exec_deinit(
  UDF_INIT *initid
){
}
my_ulonglong sys_exec(
  UDF_INIT *initid
, UDF_ARGS *args
, char *is_null
, char *error
){
  return system(args->args[0]);
} 
```

我用这一行编译它：

```
gcc -Wall -I include -I /home/rbouman/mysql/mysql-5.6.10-linux-glibc2.5-x86_64/include -shared -fPIC -o sys_exec.so sys_exec.c 
```

# java - Apache Nutch 2.1 - 跳过 http://someurl.com/something.html；不同的批次 id (null)

> ID：16195904
> 
> 赞同：1
> 
> 时间：2013-04-24T15:22:16.163
> 
> 标签：java, apache, nutch

我用 Apache Nutch 2.1 抓取了几个网站。

在抓取时，我在很多页面上看到以下消息：例如。跳过[http://videos.arte.tv/fr/videos/x-enius--7453284.html](http://videos.arte.tv/fr/videos/x-enius--7453284.html)；不同的批次 id (null)

是什么导致了这个错误？正在解析阶段......我该如何解决这个问题，我使用 HBase 来存储页面。

我在 regex-urlfilter.txt 中的网址看起来像

*   +^http://([a-z0-9]*.)*videos.arte.tv/
*   +^http://([a-z0-9]*.)*rbb-online.de/

但我也尝试过同样的效果

*   +^ [http://videos.arte.tv/](http://videos.arte.tv/)
*   +^ [http://www.rbb-online.de/](http://www.rbb-online.de/)

**编辑：**它被邮件列表的维护者添加到跟踪，如错误，你可以在这里阅读[http://lucene.472066.n3.nabble.com/Nutch-2-1-different-batch-id-null-td4040592.html #a4059636](http://lucene.472066.n3.nabble.com/Nutch-2-1-different-batch-id-null-td4040592.html#a4059636)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T23:23:49.900

我认为，消息没有问题。batch_id 未分配给所有 url。因此，如果 batch_id 为 null ，请跳过 url。为 url 关联 batch_id 时生成 url。

[这里](https://stackoverflow.com/questions/14828438/apache-nutch-2-1-different-batch-id-null/16079418#16079418)有一个类似的问题。

# apache - 修复 X-Authentication-Warning

> ID：16195905
> 
> 赞同：2
> 
> 时间：2013-04-24T15:22:16.597
> 
> 标签：apache, amazon-web-services, amazon-ec2, smtp

当警报邮件没有通过使用 cronjob 传递给用户时，我在 /var/spool/mail/ec2-user 日志文件中收到了一些消息。

所有通过 php 程序（例如 windows live mail）从我的 amazon ec2 服务器发送的电子邮件都将具有以下标题消息

```
X-Authentication-Warning: ec2-user set sender to email using -f 
```

我最近才遇到这个问题，一开始我没有遇到这个问题

我使用以下 Windows Live Mail 配置

```
ini_set('SMTP', "smtp.live.com");
ini_set('smtp_port', "25");
ini_set('sendmail_from', "admin@mail.com");
ini_set('password',"password");
ini_set('Security','Enable TLS'); 
```

# html - 显示 css 属性在打印样式表上不起作用

> ID：16195913
> 
> 赞同：0
> 
> 时间：2013-04-24T15:22:31.613
> 
> 标签：html, css, printing

我为屏幕定义了一个样式表

```
<link type="text/css" rel="stylesheet" href="PATH/style.css"> 
```

和一个用于打印的样式表

```
<link media="print" type="text/css" rel="stylesheet" href="PATH/printable.css"> 
```

在 style.css 中有一些项目没有显示

```
#img-sign{
    display:none;
}

.signatures{display:none;} 
```

但是当我打印时，我想显示它们，所以在 printable.css

```
#img-sign{
    width:370px;
    display:inline-block;
}

.signatures{
    text-align:center;
    margin-top:80px;
} 
```

问题是这些元素不会出现在打印中。

这是我的 HTML 代码

```
<div id="preview">
    <img src="PATH" id="img-sign" />
    <div class="signatures">
        <div class="profesional-signature">
            <hr>
            Profesional signature
        </div>
        <div class="customer-signature">
            <hr>
            Customer signature
        </div>
    </div>
</div> 
```

如果我逐步更改属性`display:none`，打印`visibility: hidden`中`display:block`的`visibility: visible`所有内容看起来都符合我的要求，但在我的网页中，会有白色区域。我已经有2天了这个问题。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:38:39.033

style.css 没有媒体类型，因此它将涵盖所有媒体类型，尝试添加 media="screen" 并希望它可以工作，如果没有，那么您将需要切换样式表

# google-apps-script - 计算运行时减去时间戳

> ID：16195916
> 
> 赞同：0
> 
> 时间：2013-04-24T15:22:41.570
> 
> 标签：google-apps-script, google-docs

我有一个表单，它通过“表单提交”触发器激活程序。在这个例程结束时，我想在例程结束时插入表单的时间戳和当前时间之间的时间差（差仅几秒钟）。

到目前为止，我已经尝试了很多东西，但我通常收到的结果是 NaN。

我认为我最好的选择是构建运行时元素（H、M、S）并类似地从整个时间戳中解构时间元素，然后对其进行一些数学运算：

var rt_ts = Math.abs(run_time - ts_time);

（顺便说一句，我从这个网站的某个地方得到了那个公式，但我显然现在掌握了任何东西。我似乎无法找到解决我的特定问题的线程）

我一直发现在 Javascript 中处理日期和时间是一件棘手的事情（例如：“月”从零开始，而“日期”从 1 开始的怪癖。这不必要地令人费解）。有没有人愿意引导我摆脱目前的“掌握”心态并引导我走向类似于逻辑方法的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T19:41:43.140

您可以简单地将其添加到 onFormSubmit 例程的顶部：

```
 UserProperties.setProperty('start',new Date().getTime().toString()) 
```

最后会以毫秒为单位显示持续时间。

```
var duration = new Date().getTime()-Number(UserProperties.getProperty('start')) 
```

* * *

**根据您的评论进行编辑：**

来自 onFormSubmit 事件的时间戳是返回的数组的第一个元素，`e.values`请参见[此处的文档](https://developers.google.com/apps-script/understanding_events?hl=en)

所以我真的不明白你有什么问题？？

下面这样的东西应该可以工作

```
var duration = new Date().getTime() - new Date(e.values[0]).getTime();//in millisecs 
```

该值是一个字符串，我将它传递给“新日期”以使其再次成为日期对象。您可以像这样使用记录器轻松检查： `Logger.log(new Date(e.values[0]));//`

它将以 **Fri Mar 12 15:00:00 GMT+01:00 2013的形式返回完整的日期值**

但是这些值很可能与我的第一个建议相同，因为时间戳是触发函数的时刻......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T19:20:31.727

我有一个函数，它可以在 A 列中显示带有时间戳的 ss 中的时间。它还将脚本本身的时间添加到第一个时间戳（在第 3 行中）并在日志中显示。

请注意，谷歌电子表格时间戳的分辨率以秒为单位，脚本时间戳以毫秒为单位。因此，如果您只在电子表格时间戳中添加 300 毫秒，那么如果将其发布回电子表格，则可能根本不会显示任何差异。下面的脚本只需要大约 40 毫秒即可运行，因此我添加了一个 Utilities.sleep(0)，您可以在其中将值 0 更改为 1000 以上以显示差异。

```
function testTime(){
      var start = new Date().getTime();
      var values = SpreadsheetApp.getActiveSheet().getDataRange().getValues();
      for(var i = 2; i < values.length ; i++){
      Logger.log(Utilities.formatDate(new Date(values[i][0]),Session.getTimeZone(),'d MMM yy hh:mm:ss' )); // this shows the date, in my case same as the ss timestamp.
      Logger.log(  new Date(values[i][0]).getTime()  ); // this is the date in Milliseconds after 1 Jan 1970
      }

      Utilities.sleep(0); //you can vary this to see the effects

      var endTime = new Date();
      var msCumulative = (endTime.getTime() - start);
      Logger.log(msCumulative);
      var msTot = (msCumulative + new Date(values[2][0]).getTime());
      Logger.log('script length in milliseconds ' + msTot );

      var finalTime = Utilities.formatDate(new Date(msTot), Session.getTimeZone(), 'dd/MM/yyyy hh:mm:ss');
      Logger.log ( finalTime); //Note that unless you change above to  Utilities.sleep(1000) or greater number , this logged date/time is going  to be identical to the first timestamp since the script runs so quickly, less than 1 second.

    } 
```

# cocos2d-iphone - box2d 中的旋转体和附加精灵

> ID：16195918
> 
> 赞同：0
> 
> 时间：2013-04-24T15:22:44.983
> 
> 标签：cocos2d-iphone, rotation, box2d, sprite

我有一个让我想死的问题...

我正在使用 LevelHelper 在 Box2d 中制作关卡。所以我有一个三角形精灵附着在一个三角形的身体上。

现在的问题是我想将那个身体旋转到一个位置，并旋转附加的精灵。

这里有一些代码：

```
//Detecting my actor and my sprite
if (b->GetType() == b2_dynamicBody && myActor == [loader spriteWithUniqueName:@"radar."]){
        radar = b;
        radarSprite = myActor;
    } 
```

只是想尝试 20 度，但它没有旋转。

```
 //trying to rotate inside TICK: Method

    float32 b2Angle = -1 * CC_DEGREES_TO_RADIANS(20);
    radar->SetTransform(radar->GetPosition(), b2Angle);
    radarSprite.position = ccp(radar->GetPosition().x,radar->GetPosition().y); 
```

有小费吗？

非常感谢您提前！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:45:22.363

你有一个错误，你只旋转了物理体，levelhelper 在 LHSprite 中有一个名为 tranformRotation 的方法，所以你需要这样做：

此方法旋转身体和精灵（如果身体附加到精灵）：

```
//radarSprite is a LHSprite
float32 b2Angle = -1 * CC_DEGREES_TO_RADIANS(20);
[radarSprite transformRotation:b2Angle];
[radarSprite transformPosition:ccp(radar->GetPosition().x,radar->GetPosition().y)]; 
```

如果你的身体与精灵分开，你可以这样做：

```
//radarSprite is a LHSprite
float32 b2Angle = -1 * CC_DEGREES_TO_RADIANS(20);
radar->SetTransform(radar->GetPosition(), b2Angle);
[radarSprite transformRotation:b2Angle];
[radarSprite transformPosition:ccp(radar->GetPosition().x,radar->GetPosition().y)]; 
```

**编辑：**

该方法 `spriteWithUniqueName`返回一个 LHSprite，但如果你使用 CCSprite，你可以这样做：

```
//radarSprite is a CCSprite
float32 b2Angle = -1 * CC_DEGREES_TO_RADIANS(20);
radar->SetTransform(radar->GetPosition(), b2Angle);
[radarSprite setRotation:b2Angle];
[radarSprite setPosition:ccp(radar->GetPosition().x,radar->GetPosition().y)]; 
```

# c++ - C++ 是否允许 CTFE？

> ID：16195924
> 
> 赞同：1
> 
> 时间：2013-04-24T15:22:55.180
> 
> 标签：c++, clang, constexpr, ctfe

测试了一个简单的 utf8 strlen 函数，很惊讶trunk clang 完全消除了它（gcc 没有）：

```
static int strlenutf8(const char* s)
{
  int i = 0, l = 0;
  while (s[i])
  {
    if ((s[i] & 0xc0) != 0x80) l++;
    l++;
  }
  return j;
}

int main()
{
    return strlenutf8("bla");
} 
```

clang++ -O3 -S -fverbose-asm：

```
main:                                   # @main
    .cfi_startproc
# BB#0:                                 # %entry
    movl    $3, %eax
    ret 
```

这就像 D 的编译时函数评估。这在 C++ 中是否合法？

*我的意思是说，他们一开始就发明了那个糟糕的constexpr*肯定是有原因的。据我所知，它甚至不能在这里使用，因为它受到严格限制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:31:50.543

`constexpr`仅对于常量表达式上下文（如模板参数推导）是必需的，但`constexpr`不能保证在编译时对函数进行评估。

优化 C++ 程序的黄金法则是`as-if`：

> 本国际标准中的语义描述定义了一个参数化的非确定性抽象机。本国际标准对一致性实现的结构没有要求。特别是，它们不需要复制或模仿抽象机器的结构。相反，需要符合要求的实现来模拟（仅）抽象机的可观察行为，如下所述。

加上急需的脚注：

> 这个规定有时被称为“好像”规则，因为只要从可观察的行为中可以确定，只要结果是好像已经遵守了要求，实施就可以自由地忽略本国际标准的任何要求的程序。例如，如果一个实际的实现可以推断出它的值没有被使用并且没有产生影响程序可观察行为的副作用，那么它就不需要评估表达式的一部分。

有一个主要的**BUT**：具有副作用的复制构造函数（例如，它们增加“称为”计数变量或等效的“复制构造函数”）不需要包含在“as-if”中。这包括在`12.8/31`：

> 当满足某些条件时，允许实现省略类对象的复制/移动构造，即使对象的复制/移动构造函数和/或析构函数具有副作用。在这种情况下，实现将省略的复制/移动操作的源和目标简单地视为引用同一对象的两种不同方式，并且该对象的销毁发生在两个对象本应被删除的较晚时间。在没有优化的情况下销毁。123 这种复制/移动操作的省略，称为复制省略，在以下情况下是允许的（可以结合起来消除多个副本）：[...]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:30:48.810

*通过在编译时评估表达式，需要*符合 C++ 的编译器来支持`constexpr`。as-if 规则*允许*非`constexpr`表达式的编译时求值；由于您的函数没有（可见的）副作用，因此允许编译器忽略它。*`strlenutf8`*

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T16:02:48.930

你将如何编写一个符合标准的 C++ 程序来检测这种优化？如果想不出办法，优化也行（好吧，好吧，如果**没有办法**）。编译器不需要仅仅因为您可能会查看生成的代码而低效地做事。*

# javascript - 仅当单击按钮时，如何显示带有表单的 div？

> ID：16195942
> 
> 赞同：-3
> 
> 时间：2013-04-24T15:23:38.723
> 
> 标签：javascript, html, show-hide

我在 div 中有一个表格，其中包含一个供用户填写的表格。div 上方是一个显示“客户信息”的按钮。我只想在客户想要填写信息时才显示表格。这个想法是，如果他们想填写，可以单击按钮，表格将出现在下方。这些部分有很多，所以我只希望客户必须看到他们想看到的内容。下面是一个例子...

```
<input type="button" value="Customer Info" onClick="">
<div>
<form>
<table>
<tr>
<td>Name:<input type="text" value="" id="name" name="name"></td>
</tr>
</table>
</div> 
```

我的问题是如何编写一个简单的 javascript 函数，该函数将在单击显示和隐藏 Div 的按钮时起作用？该表单仍将隐藏在那里，并且值将是空白的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:27:15.890

您可以使用该`onClick`事件来做到这一点：

# [工作示例](http://jsfiddle.net/EaRuS/)

**HTML：**

```
<button id="some_id">Hide div</button>

<form id="some_form">

<form> 
```

**javascript:**

```
<script type="text/javascript">
    var theButton = document.getElementById('some_id');

    theButton.onclick = function() { 
        document.getElementById('some_form').style.visibility='hidden';   
    }

</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:35:20.783

内联 javascript 被认为是不好的做法

IE。`onClick=""`

改用这样的东西

```
<input id="info" type="button" value="Customer Info">
<div id="myDiv">
    <form>Name:
        <input type="text" value="" id="name" name="name">
        </input>
    </form>
</div>

var button = document.getElementById("info");
var myDiv = document.getElementById("myDiv");

function show() {
    myDiv.style.visibility = "visible";
}

function hide() {
    myDiv.style.visibility = "hidden";
}

function toggle() {
    if (myDiv.style.visibility === "hidden") {
        show();
    } else {
        hide();
    }
}

hide();

button.addEventListener("click", toggle, false); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/3WMsq/)

这是 David Thomas 在评论中建议的代码。它执行完全相同的任务，但对`toggle`函数使用简写 if-else 并且不为您提供单独的`show`和`hide`函数。

```
<input id="info" type="button" value="Customer Info">
<div id="myDiv">
    <form>Name:
        <input type="text" value="" id="name" name="name">
        </input>
    </form>
</div>

var button = document.getElementById("info");
var myDiv = document.getElementById("myDiv");

function toggle() {
    myDiv.style.visibility = myDiv.style.visibility === "hidden" ? "visible" :  "hidden";
}

toggle();

button.addEventListener("click", toggle, false); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/MecJx/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-08T10:07:01.743

```
 <script type="text/javascript">
$("#music").click(function () {
$("#musicinfo").show("slow");
});
</script> 
```

您可以更改效果，例如切换，fadeToggle 代替显示...

# python - 在 iframe 中使用 Django 模板，出现 404 错误

> ID：16195944
> 
> 赞同：0
> 
> 时间：2013-04-24T15:23:49.000
> 
> 标签：python, django, iframe, modal-dialog

我有一个 Django 站点，主页是 home.html。home.html 中有一个模式，设置为在主页加载几秒钟后自动打开。模态框内是一个 iframe，应该显示 template1.html。但是，当模式出现时，我有一个 404 并且我被告知该页面与我定义的 url 模式不匹配。我不完全确定在哪里或如何让 template1.html 显示在 iframe 中。用户没有在主页上单击以调出新模板，这就是我熟悉使用 Django 的方式。我是否需要创建另一个 url 模式或视图来实现这一点，或者我是否还有路要走？这是我的文件：

网址.py：

```
from django.conf.urls.defaults import patterns, url  
from disease import views  

    urlpatterns = patterns('',
    url(r'^$', views.home, name='disease_home'),  
    url(r'^disease/(?P<pk>\d+)/$', 'disease.views.disease', name='disease_disease'),  
    url(r'^treatment/(?P<pk>\d+)$', views.treatment, name='disease_treatment'), 
```

home.html 模态：

```
<div id="challengeModal" class="reveal-modal xlarge">  
    < iframe seamless scrolling="no" src="challenge1.html" name="challenge1"  
id="challenge1"></iframe>  
< /div> 
```

视图.py：

```
 def home(request):  
    return render(request, "disease/home.html")` 
```

其他视图根据 template1.html 中的操作返回第二个模板 template2.html

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:29:04.467

简短的回答是是的，您需要另一个 url 模式和 iframe 的视图。iframe 几乎被视为嵌入式浏览器窗口，它会向服务器发出自己的请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:29:24.687

iframe`src`只是资源的 url。

例如，您可以`treatment`使用

`<iframe src="/treatment/1/"></iframe>`

您将需要创建一个视图来提供您的`challenge1.html`模板和一个 url 来路由到该视图

# c# - 在 ASP.Net 中使用 C# Windows DLL

> ID：16195946
> 
> 赞同：0
> 
> 时间：2013-04-24T15:23:51.757
> 
> 标签：c#, asp.net, dll, mvvm

我有一个 VS2012 Express (Desktop) MVVM 项目，其中模型（EF5 Code First）类存储在一个独立的 C# DLL 中。

我现在正计划使用 ASP.NET 通过 Internet 访问同一数据库的各个部分（与 Windows 编程相比，我的经验要少得多）。因此，我正在创建一个将使用相同模型和 VM 的 ASP.NET 视图。

我是否可以在我的 ASP.NET 项目中简单地使用相同的 DLL，或者与 Windows DLL 相比，在 ASP.NET 中运行的代码是否更受限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:25:06.190

除非您在 Medium Trust 中运行（强烈建议不要这样做），否则在 ASP.Net 中运行的代码可以加载它想要的任何 DLL。（包括P/Invoke）
都是一样的.Net；唯一的区别是它是在交互式会话中运行还是在 IIS 中运行。

请注意，运行 UI 代码会破坏事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:30:13.990

从 ASP.Net 使用相同的 DLL 应该没有问题，但是我想知道如何在 ASP.Net 中使用 VideModel 代码，在您的 ASP 中不支持 ViewModel 的属性更改通知机制（INotifyPropertyChanged 的​​实现）页。

# sublimetext2 - .vim 语法高亮到 textmate 或 sublime 文本 2

> ID：16195947
> 
> 赞同：11
> 
> 时间：2013-04-24T15:23:54.757
> 
> 标签：sublimetext2, textmate

我有一个`.vim script`用于突出显示特定程序的语法（Mplus SEM 软件）。

我想知道是否有一种简单的方法可以将其转换为 textmate 或 sublime text 2，或者我需要自己编写。

最好的，并提前感谢。

[Vim 脚本](http://www.unc.edu/~jmroos/micah/OddsEnds_files/mplus.vim)

注意：这个脚本不是我写的，但要感谢 J Micah Roos。

**编辑：**

不是真正的答案，但我放弃了寻找方法并制作了自己的包来做我想做的事： [https ://github.com/bkeller2/Mplus](https://github.com/bkeller2/Mplus)

只需将它放在那里，以供遇到需要此语法荧光笔的任何人使用。

# performance - 将webpagetest.org 与CI Jenkins 集成

> ID：16195950
> 
> 赞同：2
> 
> 时间：2013-04-24T15:24:02.827
> 
> 标签：performance, jenkins, phantomjs

我们使用webpagetest 来监控我们的网站并查看其运行情况。我知道我们可以将 Yslow 与 Phantom js 和 Jenkins 集成。

有什么方法可以将webpagetest.org 与CI jenkins 集成。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-11T18:43:25.323

您可以尝试[pagestest-api](http://marcelduran.com/webpagetest-api/)这是一个 CLI 工具和 NodeJs 模块。您可以获取您的测试结果并检查您之后的任何指标，然后输出通过/未通过。不幸的是，CI 集成并不是免费的，您可以构建自己的与 pagestest-api 节点模块的集成，或者使用 CLI 工具做一些 bash 脚本魔术。请记住，webpagetest-api test (runTest) 命令是异步的，即：它只安排一个返回测试 id 的测试，以便您稍后检查结果。有一些方法可以集成测试计划和获取结果，请查看[我在上次性能日历上的帖子](http://calendar.perfplanet.com/2012/xmas-gift-webpagetest-api-swiss-army-knife/)。

# xpages - 动态字段绑定的部分刷新会删除值

> ID：16195953
> 
> 赞同：0
> 
> 时间：2013-04-24T15:24:11.820
> 
> 标签：xpages, xpages-extlib, xpages-ssjs

真的想知道为什么我的 XPage 会这样做。

我有一个动态数据绑定的字段：

```
<xp:inputText id="CORE_Input" value="#{Document[compositeData.PARA_DataBinding]}"</xp:inputText> 
```

在我开始根据注释公式隐藏它之前，效果很好。

让我说说它的作用：我单击 XPage 中的一个复选框。该复选框正在运行 SSJS，它正在调用：`Document.getDocument(true)`将数据从我的 XPage 推回到 notesdocument 而不保存它。完成后，我可以`session.evaluate("checkbox!="something"")`用来隐藏 inputText 字段。

它工作得很好，但问题是一旦我取消选中复选框，值就会从输入字段中消失。

如果您知道使用注释公式进行隐藏的更好方法，或者输入字段返回后为空的原因，我们将不胜感激。这是一个例子：

```
<?xml version="1.0" encoding="UTF-8"?>
<xp:view xmlns:xp="http://www.ibm.com/xsp/core" xmlns:xe="http://www.ibm.com/xsp/coreex">
    <xp:checkBox id="checkBox1" value="#{Document.Check}" text="hide" checkedValue="hide">
    <xp:eventHandler event="onchange" submit="false">
        <xp:this.script><![CDATA[document.getElementById("#{id:hide}").click()]]></xp:this.script>
    </xp:eventHandler>
    </xp:checkBox>
    <xp:panel id="test">
    <xp:inputText id="CORE_Input" type="#{compositeData.NODE}"
        value="#{Document[compositeData.PARA_DataBinding]}"
        defaultValue="#{javascript:compositeData.PARA_DefaultValue}" style="margin-left:24px">
        <xp:this.styleClass><![CDATA[#{javascript:DOMElement.getAttribute("stylesize");}]]></xp:this.styleClass>        <xp:this.rendered><![CDATA[#{javascript:var doc:NotesXspDocument=Document;
        var erg=session.evaluate('Check="hide"',doc.getDocument());
        if(@Text(erg)=="1")
        {return false}
        else
        {return true}}]]></xp:this.rendered>
    </xp:inputText>
    <xp:button value="hide" id="hide">
        <xp:eventHandler event="onclick" submit="true"
            refreshMode="partial" refreshId="test">
            <xp:this.action>
            <![CDATA[#{javascript:var doc:NotesXspDocument=Document;doc.getDocument(true)}]]></xp:this.action>
        </xp:eventHandler></xp:button>
    <xp:button value="unhide" id="unhide">
        <xp:eventHandler event="onclick" submit="true" refreshMode="partial" refreshId="test">
            <xp:this.action><![CDATA[#{javascript:sessionScope.hide=""}]]></xp:this.action>
        </xp:eventHandler></xp:button>
    </xp:panel></xp:view> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:03:55.923

您遇到的问题是您的默认值：一旦组件被取消隐藏，就会重新计算该值。您必须检查组件是否部分刷新。如果是这样，请停止重新计算：

```
<xp:this.defaultValue>
    <![CDATA[#{javascript:
        importPackage( com.ibm.xsp.ajax );
            if( AjaxUtil.isAjaxPartialRefresh(facesContext) == true ) 
                return;
            compositeData.PARA_DefaultValue
    }]]>
</xp:this.defaultValue> 
```

这应该可以解决您的问题

# c# - asp.net 中的对象数据源

> ID：16195954
> 
> 赞同：3
> 
> 时间：2013-04-24T15:24:12.277
> 
> 标签：c#

我正在使用 Objectdatasource 来填充网格视图。在 gridview 中，其中一列在数据库中具有加密值。我想在 gridview 中加载列的解密值。

这是gridview和objectdatasource

```
<asp:GridView ID="GridView1" SkinID="GridView" runat="server" Width="100%" AutoGenerateColumns="False"
                            AllowPaging="True" PageSize="10" DataSourceID="ObjectDataSource1" AllowSorting="True"
                            AlternatingRowStyle-BackColor="Silver" HeaderStyle-BackColor="#666666" HeaderStyle-ForeColor="White">
                            <Columns>
                                <asp:HyperLinkField DataNavigateUrlFields="Taxi_Id" HeaderText="Edit" DataNavigateUrlFormatString="TaxiForm.aspx?ID={0}&E=1"
                                    Text="Edit" />
                                <asp:BoundField DataField="Taxi_Id" HeaderText="Taxi_Id" SortExpression="Driver_Id"
                                    Visible="False" />
                                <asp:BoundField DataField="MedallionNo" HeaderText="Medallion No" SortExpression="MeddallionNo" />  
                                <asp:BoundField DataField="Car_Brand_Name" HeaderText="Brand Name" SortExpression="Car_Brand_Name" />
                                <asp:BoundField DataField="Car_Model_Name" HeaderText="Model Name" SortExpression="Car_Model_Name" />
                                <asp:BoundField DataField="Car_Year" HeaderText="Year" SortExpression="Car_Year" />                                                              
                                <asp:BoundField DataField="Affiliation_Name" HeaderText="Affiliation" SortExpression="Affiliation_Name" />
                                <asp:BoundField DataField="Mileage" HeaderText="Mileage" SortExpression="Mileage" />
                                <asp:BoundField DataField="Taxi_Company_Garage_Name" HeaderText="PickUp Location" SortExpression="Taxi_Company_Garage_Name" />                                
                                <asp:HyperLinkField DataNavigateUrlFields="Taxi_Id" HeaderText="Shift Rate" DataNavigateUrlFormatString="TaxiShiftRateList.aspx?ID={0}&E=1" Text="View Shift Rate" />
                            </Columns>
                        </asp:GridView>

<asp:ObjectDataSource ID="ObjectDataSource1" runat="server" 
                            SelectMethod="Owner_GetAll" TypeName="TMS.TaxiObj" >
                            <DeleteParameters>
                                <asp:Parameter Name="Driver_Id" Type="Int32" />
                            </DeleteParameters>
                            <SelectParameters>
                                <asp:ControlParameter ControlID="txtMedallionNo" Name="MedallionNo" PropertyName="Text"
                                    Type="String" DefaultValue="" />
                                <asp:ControlParameter ControlID="ddlBrand" Name="Car_Brand_Id" PropertyName="Text"
                                    Type="Int32" DefaultValue="-1" />
                                <asp:ControlParameter ControlID="ddlModel" Name="Car_Model_Id" PropertyName="Text"
                                    Type="Int32" DefaultValue="-1" />
                                <asp:ControlParameter ControlID="ddlAffiliation" Name="Affiliation_Id" PropertyName="Text"
                                    Type="Int32" DefaultValue="-1" />
                            </SelectParameters>
                        </asp:ObjectDataSource> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:36:49.503

将您的列转换为带有标签的模板列。

```
<asp:GridView ID="GridView1" runat="server" OnRowDataBound="GridView1_RowDataBound">
    <Columns>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:Label runat="server" Id="lbl"></asp:Label>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

注册到`GridView` `OnRowDataBoundEvent`. 在事件处理程序中解密该值并相应地设置标签文本。

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    Label lbl = e.Row.FindControl("lbl") as Label;
    if (lbl != null) {
        var encrypted = DataBinder.Eval(e.Row.DataItem, "EncryptedColumn");
        string decrypted = Decrypt(encrypted);
        lbl.Text = decrypted;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:38:05.990

```
<asp:TemplateField HeaderText="SomeField" SortExpression="SomeField">
    <ItemTemplate>
        <asp:Label ID="Label1" runat="server" Text='<%# Decrypt(Eval("SomeField").ToString()) %>'></asp:Label>
    </ItemTemplate>
</asp:TemplateField> 
```

# c++ - 内存位置的 std::out_of_range

> ID：16195970
> 
> 赞同：0
> 
> 时间：2013-04-24T15:24:51.493
> 
> 标签：c++

此块在内存位置 0x0013f59c 处给我错误消息 std::out_of_range。问题来自 3 条中间线（我放星号的地方）。在代码完美运行之前。我还亲自检查了每一行是否正确包含前 6 个字符。

```
if (openfile.is_open() && newfile.is_open())
{
      while (! openfile.eof())
     {   
                   getline(openfile, originaldata);
                   string day(originaldata,6,2);           *
                   string month(originaldata,4,2);             *
                   string year(originaldata,0,4);              *
                   string data=day+"/"+month+"/"+year;  
     }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:27:21.593

尝试这个

```
if (openfile.is_open() && newfile.is_open())
{
     while (getline(openfile, originaldata))
     {
                   string day(originaldata,6,2);
                   string month(originaldata,4,2);
                   string year(originaldata,0,4);
                   string data=day+"/"+month+"/"+year;  
     }
} 
```

使用 eof 几乎总是错误的，因为 eof 会告诉您**上次**读取失败的原因，它不会告诉您**下一次**读取将失败。因此，如果您要使用它，请在 getline 之后而不是之前使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:27:34.547

您的输入文件可能包含一个空行，`getline`它将读取，产生一个空字符串。

或者格式错误的行太短。

考虑使用这个。

```
 while ( getline(openfile, originaldata) && originaldata.length() > 8 ) 
```

如果在. `getline`_ `while`_ *_* `openfile`不仅仅是EOF。

# javascript - CodeKit - 有什么方法可以忽略 js？

> ID：16195972
> 
> 赞同：8
> 
> 时间：2013-04-24T15:24:52.583
> 
> 标签：javascript, validation, codekit

**TLDR：** CodeKit 验证我糟糕的开发 js，并在不可避免地发现错误时发出警报。在我准备好在生产中抛光之前，我可以关闭它吗？

* * *

这在技术上可能是超级用户的问题，但由于它具有明确的代码和站点布局含义，我认为它可能更适合这里。

一直在使用 CodeKit 来编译我的 LESS 工作表并压缩我的站点图像。CodeKit 也坚持要验证它找到的 js——我仍在开发中，所以它不可避免地会发现一个错误并在每一次该死的保存时发出警报。当我在生产中时，这是需要的，但这还有几周的时间。有什么办法可以暂时阻止 js 验证？以某种方式切换 js 验证？我尝试关闭所有的缩小器和丑化器，但它仍然运行一些基本的缩小器。

我宁愿考虑改变环境结构作为最后的手段。我网站的所有媒体都包含在一个`/ui/`目录中：

```
ui [watched]
-css
-images
-js
-less [compile to ../css] 
```

为了避免观看`/ui/js/`，我将不得不进行以下更改：

```
ui
-css [watched]
--less [compile to ../]
-images [watched]
-js 
```

我必须分别查看两个文件夹，更改站点结构并更改编译路径 - 恕我直言，这破坏了 CodeKit 的优雅，特别是因为当我到达 prod 时我必须撤消它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T15:29:52.487

您可以将其设置为不自动编译：

![在此处输入图像描述](https://i.stack.imgur.com/1qDxT.png)

或者您可以阻止它在出错时将 CodeKit 置于最前面：

![在此处输入图像描述](https://i.stack.imgur.com/CBp8z.png)

# c# - 用蓝牙连接PC和Android手机（c#）

> ID：16195974
> 
> 赞同：4
> 
> 时间：2013-04-24T15:25:01.093
> 
> 标签：c#, android, bluetooth, socketexception

我正在尝试将我的计算机与 android 手机连接以传输一些数据。对于计算机编程语言，我选择了 c#。

在计算机上，代码如下所示：

```
var wantedAddress="303926627f06"; 
var addr = BluetoothAddress.Parse(wantedAddress);
var cli = new BluetoothClient();
cli.Connect(addr, new Guid("{00001101-0000-1000-8000-00805f9b34fb}")); 
```

在 android 手机上，代码看起来像：

```
private UUID uuid = UUID.fromString("00001101-0000-1000-8000-00805f9b34fb");
private BluetoothAdapter btAdapter= BluetoothAdapter.getDefaultAdapter();
private BluetoothServerSocket server=btAdapter.listenUsingRfcommWithServiceRecord("App name",uuid);
while(isRunning)
{
    try {
        BluetoothSocket socket=server.accept();

    } catch (IOException e) {
        isRunning=false;

        e.printStackTrace();
    }
} 
```

尝试连接到手机后，我收到此错误：

```
SocketException:
The requested address is not valid in its context 303926627F06:0000110100001000800000805f9b34fb 
```

有谁知道出了什么问题？

谢谢你的帮助！法理

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T22:07:08.583

[请参阅https://32feet.codeplex.com/wikipage?title=Errors](https://32feet.codeplex.com/wikipage?title=Errors)上的错误代码， 这表明客户端没有找到在目标设备上运行的具有预期 UUID 的服务器。现在为什么...

如果您使用 32feet.NET SdpBrowser 示例并列出所有 SDP 服务“（通过 L2CAP）”，您会看到什么？

您是否连接到正确的设备地址？

# php - 尝试从 URL 中提取 XML 文件，然后提取标签中包含的属性

> ID：16195976
> 
> 赞同：2
> 
> 时间：2013-04-24T15:25:12.177
> 
> 标签：php, xml, parsing

我正在尝试从托管在远程服务器上的实时 XML 文档中提取数据。我正在尝试使用 PHP 来做到这一点。

XML文件的布局是这样的：

```
<carparkData>
<Northwest>
<carpark name="PARNELL" spaces="51"></carpark>
<carpark name="ILAC" spaces=" "></carpark>
<carpark name="JERVIS" spaces="616"></carpark>
<carpark name="ARNOTTS" spaces="170"></carpark>
</Northwest>
<Northeast>
<carpark name="MARLBORO" spaces="185"></carpark>
<carpark name="ABBEY" spaces="97"></carpark>
</Northeast>
<Southwest>
<carpark name="THOMASST" spaces="193"></carpark>
<carpark name="C/CHURCH" spaces="51"></carpark>
</Southwest>
<Southeast>
<carpark name="SETANTA" spaces=" "></carpark>
<carpark name="DAWSON" spaces="113"></carpark>
<carpark name="TRINITY" spaces="178"></carpark>
<carpark name="GREENRCS" spaces="446"></carpark>
<carpark name="DRURY" spaces="562"></carpark>
<carpark name="B/THOMAS" spaces="168"></carpark>
</Southeast>
</carparkData> 
```

使用 PHP 我尝试首先提取数据，然后创建一个循环来捕获`<carpark>`标签内包含的属性：

```
<?php

$data = simplexml_load_file('http://www.dublincity.ie/dublintraffic/cpdata.xml.');

foreach ($data->carpark[0]->attributes() as $a => $b) 
{
        echo $a,'="',$b,"\"\n";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:36:14.310

截至目前，您还没有遍历`carparks`. 这可能会为您指明正确的方向：

```
$data = simplexml_load_file('http://www.dublincity.ie/dublintraffic/cpdata.xml');

if($sectors = $data->children()){
    foreach($sectors as $sector){
        echo '<h1>'.$sector->getName().'</h1>';
        if($carparks = $sector->children()){
            foreach($carparks as $carpark){
                if($attributes = $carpark->attributes()){
                    foreach($attributes as $key=>$value){
                        echo $key.': '.$value.'<br>';
                    }
                    echo '<hr>';
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T16:22:20.793

用于直接`xpath`访问`<carpark>`-nodes：

```
$xml = simplexml_load_string($x); // assume XML in $x

$carparks = $xml->xpath("//carpark");

foreach ($carparks as $carpark) 
    echo $carpark['name'] . " has " . $carpark['spaces'] . " spaces.<br />"; 
```

看到它工作：[http ://codepad.viper-7.com/JUB4Jp](http://codepad.viper-7.com/JUB4Jp)

# regex - isnumeric() 与 PostgreSQL

> ID：16195986
> 
> 赞同：45
> 
> 时间：2013-04-24T15:25:45.177
> 
> 标签：regex, postgresql

我需要确定给定的字符串是否可以在 SQL 语句中解释为数字（整数或浮点数）。如下所示：

```
SELECT AVG(CASE WHEN x ~ '^[0-9]*.?[0-9]*$' THEN x::float ELSE NULL END) FROM test 
```

我发现可以使用 Postgres 的[模式匹配](http://www.postgresql.org/docs/9.2/static/functions-matching.html)。所以我修改了[这个地方](http://www.postgresql.org/message-id/003601c42ec7$e7806ee0$8401a8c0@home.axiontech.com)给出的声明来合并浮点数。这是我的代码：

```
WITH test(x) AS (
    VALUES (''), ('.'), ('.0'), ('0.'), ('0'), ('1'), ('123'),
    ('123.456'), ('abc'), ('1..2'), ('1.2.3.4'))

SELECT x
     , x ~ '^[0-9]*.?[0-9]*$' AS isnumeric
FROM test; 
```

输出：

```
 x    | isnumeric 
---------+-----------
         | t
 .       | t
 .0      | t
 0\.      | t
 0       | t
 1       | t
 123     | t
 123.456 | t
 abc     | f
 1..2    | f
 1.2.3.4 | f
(11 rows) 
```

如您所见，前两项（空字符串`''`和唯一句`'.'`点）被错误分类为数字类型（它们不是）。我现在无法接近这一点。任何帮助表示赞赏！

* * *

**更新**基于[此答案](https://stackoverflow.com/a/16196091/1025391)（及其评论），我将模式调整为：

```
WITH test(x) AS (
    VALUES (''), ('.'), ('.0'), ('0.'), ('0'), ('1'), ('123'),
    ('123.456'), ('abc'), ('1..2'), ('1.2.3.4'), ('1x234'), ('1.234e-5'))

SELECT x
     , x ~ '^([0-9]+[.]?[0-9]*|[.][0-9]+)$' AS isnumeric
FROM test; 
```

这使：

```
 x    | isnumeric 
----------+-----------
          | f
 .        | f
 .0       | t
 0\.       | t
 0        | t
 1        | t
 123      | t
 123.456  | t
 abc      | f
 1..2     | f
 1.2.3.4  | f
 1x234    | f
 1.234e-5 | f
(13 rows) 
```

正如我现在所看到的，科学记数法和负数仍然存在一些问题。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-04-25T03:58:01.130

您可能会注意到，基于正则表达式的方法几乎不可能正确执行。例如，您的测试说这`1.234e-5`不是有效数字，而实际上是。此外，您错过了负数。如果某些东西看起来像一个数字，但是当您尝试存储它时会导致溢出怎么办？

相反，我建议创建尝试实际转换为`NUMERIC`（或者`FLOAT`如果您的任务需要它）并返回`TRUE`或`FALSE`取决于此转换是否成功的函数。

此代码将完全模拟功能`ISNUMERIC()`：

```
CREATE OR REPLACE FUNCTION isnumeric(text) RETURNS BOOLEAN AS $$
DECLARE x NUMERIC;
BEGIN
    x = $1::NUMERIC;
    RETURN TRUE;
EXCEPTION WHEN others THEN
    RETURN FALSE;
END;
$$
STRICT
LANGUAGE plpgsql IMMUTABLE; 
```

对您的数据调用此函数会得到以下结果：

```
WITH test(x) AS ( VALUES (''), ('.'), ('.0'), ('0.'), ('0'), ('1'), ('123'),
  ('123.456'), ('abc'), ('1..2'), ('1.2.3.4'), ('1x234'), ('1.234e-5'))
SELECT x, isnumeric(x) FROM test;

    x     | isnumeric
----------+-----------
          | f
 .        | f
 .0       | t
 0\.       | t
 0        | t
 1        | t
 123      | t
 123.456  | t
 abc      | f
 1..2     | f
 1.2.3.4  | f
 1x234    | f
 1.234e-5 | t
 (13 rows) 
```

它不仅更正确、更容易阅读，而且如果数据实际上是一个数字，它的工作速度也会更快。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-24T15:30:16.660

您的问题是小数点两侧的两个 0 或更多 [0-9] 元素。您需要`|`在号码标识行中使用逻辑 OR：

```
~'^([0-9]+\.?[0-9]*|\.[0-9]+)$' 
```

这将仅排除小数点作为有效数字。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2018-10-30T15:14:19.577

我想有人可能会有这种观点（这不是对异常处理的滥用），但通常我认为应该为此使用异常处理机制。测试字符串是否包含数字是正常处理的一部分，并不是“例外”。

但是你不处理指数是对的。这是正则表达式的第二次尝试（下）。我不得不寻求使用正则表达式的解决方案的原因是，当遇到错误时给出退出指令时，此处作为“正确”解决方案提供的解决方案将失败：

`SET exit_on_error = true;`

我们经常在运行 SQL 脚本组时使用它，并且当我们想在出现任何问题/错误时立即停止时。当给出这个 session 指令时，调用 isnumeric 的“正确”版本将导致脚本立即退出，即使没有遇到“真正的”异常。

```
create or replace function isnumeric(text) returns boolean
  immutable
  language plpgsql
as $$
begin
  if $1 is null or rtrim($1)='' then
    return false;
  else
    return (select $1 ~ '^ *[-+]?[0-9]*([.][0-9]+)?[0-9]*(([eE][-+]?)[0-9]+)? *$');
  end if;
end;
$$; 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2020-02-26T14:43:31.687

从 PostgreSQL 9.5 (2016) 开始，您只需询问 json 字段的类型：

```
jsonb_typeof(field) 
```

从[PostgreSQL 文档](https://www.postgresql.org/docs/9.4/functions-json.html)：

> json_typeof(json)
> jsonb_typeof(jsonb)
> 
> 以文本字符串的形式返回最外层 JSON 值的类型。可能的类型是**object、array、string、number、boolean**和**null**。

**例子**

当聚合数字并想要忽略字符串时：

```
SELECT m.title, SUM(m.body::numeric)
FROM messages as m
WHERE jsonb_typeof(m.body) = 'number'
GROUP BY m.title; 
```

没有 WHERE`::numeric`部分会崩溃。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2018-10-17T16:12:31.270

公认解决方案的明显问题是它滥用了异常处理。如果遇到另一个问题，您将永远不会知道它，因为您已经抛弃了异常。很糟糕的形式。正则表达式将是执行此操作的更好方法。下面的正则表达式似乎表现良好。

```
create function isnumeric(text) returns boolean
    immutable
    language plpgsql
as $$
begin
    if $1 is not null then
     return (select $1 ~ '^(([-+]?[0-9]+(\.[0-9]+)?)|([-+]?\.[0-9]+))$');
    else
     return false;
    end if;
end;
$$
; 
```

# java - 运行测试时出现 UIAutomator 错误

> ID：16195987
> 
> 赞同：1
> 
> 时间：2013-04-24T15:25:45.063
> 
> 标签：java, ui-automation

我对谷歌的 uiautomator 有很大的问题。我有一个未植根的 S3，我无法在设备上运行我的测试。
错误：

```
INSTRUMENTATION_RESULT: shortMsg=java.lang.RuntimeException
INSTRUMENTATION_RESULT: longMsg=com.test1.test
INSTRUMENTATION_CODE: 0 
```

我看到一些答案让我根植手机。我不想那样做。
请给我一些答案如何使用测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T23:34:28.493

我遇到了同样的问题！我不是 100% 确定它为什么会发生，但我认为这与 ant 构建 JAR 文件的方式有关。当我第一次开始编写我的 uiautomation 测试时，我将它们与一些 JUnit 测试放在同一个项目中，这些测试位于不同的包中（一个用于源类，一个用于测试）。我在测试包中创建了我的 uiautomation 测试，当我去构建和运行它们时，我得到一个错误，我的测试类没有被发现。

我相信这是因为 JAR 文件只包含源包而不包含测试包。因此，我创建了一个新项目并将我的 uiautomation 测试放在单个源代码包中，构建项目并将 JAR 推送到我的设备。之后他们顺利地跑了！

我对这些东西也很陌生，所以我不完全确定这是否能回答你的问题。另一种解决方案可能是将 UIA 测试移至源包，而不是创建一个全新的项目。

此外，Google 的资源对于获得设置和使用 uiautomation 的基本感觉非常有用（如果您还没有检查过它们）。如果您真的找不到修复程序，我建议您将他们的演示复制并粘贴到一个新项目中并尝试让它运行：http: [//developer.android.com/tools/testing/testing_ui.html](http://developer.android.com/tools/testing/testing_ui.html)

# sharepoint - SharePoint 2013 应用程序池崩溃

> ID：16195989
> 
> 赞同：0
> 
> 时间：2013-04-24T15:25:52.287
> 
> 标签：sharepoint, iis, sharepoint-2013

我有一个新配置的 SharePoint 2013 场，我的应用程序池继续崩溃（停止）。我已将这些帐户添加到“作为批处理登录”和“作为服务登录”的本地策略和域策略中。Windows 日志中的应用程序池返回有关凭据无效的错误。我从未更改过应用程序池帐户密码，并且在 AD 中，它们设置为永不过期。帐户也没有锁定在 AD 中。IISReset /noforce 在服务器上大约需要 30 分钟的不活动时间才能启动它们。

这些应用程序池崩溃每天发生几次，并且似乎以某种方式与活动目录不同步。在 IIS 和 PowerShell 中将密码更改为未更改的密码不起作用，因为它声称密码不正确。有没有人遇到过这个并有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-31T16:20:01.823

你有可能得到一个错误的错误吗？应用程序池回收的一个常见原因是优化中的错误代码不会自行清理。

# xcode - 将编译源添加到 Xcode 单元测试（应用程序与逻辑）

> ID：16195991
> 
> 赞同：2
> 
> 时间：2013-04-24T15:25:57.820
> 
> 标签：xcode, unit-testing

似乎逻辑测试要求我将应用程序文件（.m 和 .h）与测试 .m 文件一起添加到测试的编译目标。我认为这是因为应用程序测试实际上与测试一起加载应用程序，但我不确定。

捆绑加载器是应用程序和逻辑测试之间的“区别”吗？我不是在谈论为什么要使用它们，而是在谈论它们如何工作和做什么之间的区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:37:38.910

[在这里，您可以找到对测试的详细描述，包括它们的作用以及它们的不同之处。](http://developer.apple.com/library/mac/#documentation/developertools/Conceptual/UnitTesting/01-Unit-Test_Overview/overview.html#//apple_ref/doc/uid/TP40002143-CH2-SW1)此外，在下一节中，您可以[阅读](http://developer.apple.com/library/mac/#documentation/developertools/Conceptual/UnitTesting/02-Setting_Up_Unit_Tests_in_a_Project/setting_up.html#//apple_ref/doc/uid/TP40002143-CH3-SW1)有关如何设置它们的信息，这揭示了它们之间的技术差异。正如您所建议的，加载应用程序包似乎有所作为。

编辑：似乎上面的链接不再有效，我在这里找到了一个遗留文档：[https ://developer.apple.com/legacy/library/documentation/DeveloperTools/Conceptual/UnitTesting/UnitTesting.pdf](https://developer.apple.com/legacy/library/documentation/DeveloperTools/Conceptual/UnitTesting/UnitTesting.pdf)

# delphi - 作为 TServiceApplication 运行时出现 EIntfCastError 'Interface not supported'

> ID：16195992
> 
> 赞同：0
> 
> 时间：2013-04-24T15:25:58.150
> 
> 标签：delphi, com, windows-services

当我将应用程序作为 Windoes 服务（即 TServiceApplication）运行时，我在使用 COM 对象时遇到问题。引发异常 EIntfCastError 'Interface not supported'。

如果我将应用程序作为普通的 Delphi 应用程序运行，那么它工作正常，包括如果我使用 srvany.exe 作为服务运行

```
type IMyInter = interface (IUnknown)
['{9E6B311E-C6D3-4687-B272-3FBE9DBC2DD6}']
//...
end;

type 
  TMyObject = class
  private
    FMyInter: IMyInter;
  published
    constructor Create(const ClassID: TGUID);
  end;

constructor TMyObject.Create(const ClassID:TGUID);
begin
  CoInitialize(nil);
  FMyInter := CreateComObject(ClassID) as IMyInter;  
  //.... 
end; 
```

当结果将分配给 FMyInter 时，似乎在调用 CreateComObject 后引发了错误。应用程序和 COM 对象都是 32 位的。我在 Windows 7 64bit 上运行并使用 Delphi XE3。COM 对象已注册到 regsvr32.exe

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-08T11:14:35.497

我终于设法解决了驻留在 COM 服务器端的问题。创建对象时，即 TComObjectFactory.Create 我将线程模型从 tmSingle 更改为 tmApartment。然后我注销并重新注册了服务器。快！不太清楚为什么，但它对我有用。

```
...    
initialization
    TComObjectFactory.Create( ComServer, TMyComServerClass, Class_ComServerClassGUID, ‘My Com Server Class’, ‘My Descriptive text’, ciMultiInstance, tmApartment); 
```

# asp.net - 如何在 asp.net 中的 .ashx 文件上设置会话值？

> ID：16195993
> 
> 赞同：1
> 
> 时间：2013-04-24T15:26:00.360
> 
> 标签：asp.net, session, file-upload, listbox, uploadify

我在我的网站中使用“jquery.uploadify.js”，这个 jquery 使用 ashx 文件将图像上传到文件夹中。在 .ashx 中，我使用 Session["FileNameNews"] 来保存图像名称，并且在我的代码开头我的 Session["FileNameNews"] 是空的。但是当我上传两个或三个或...图像时，每次我的 Session["FileNameNews"] 都是空的。我不想每次上传照片时都清空我的会话，我希望上传的图像显示在父 .aspx 页面的列表框中。其他方式，我需要在上传开始时将会话清空，并在上传结束时填写图像名称。我可以一次上传多张图片。

有人有想法吗？请帮我。

谢谢你。

.aspx 页面：

```
<script type = "text/javascript">
    $(window).load(
        function() {
            $("#<%=FileUpload1.ClientID%>").fileUpload({
            'uploader': 'scripts/uploader.swf',
            'cancelImg': 'images/cancel.png',
            'buttonText': 'Browse Files',
            'script': 'Upload.ashx',
            'folder': 'Temp',
            'fileDesc': 'Image Files',
            'fileExt': '*.jpg;*.jpeg;*.gif;*.png',
            'multi': true,
            'auto': false
        });
       }
    );
    </script>

<a href="javascript:$('#<%=FileUpload1.ClientID%>').fileUploadStart()">Start Upload</a> 
|<a href="javascript:$('#<%=FileUpload1.ClientID%>').fileUploadClearQueue()">Clear</a> 
<div style = "padding:40px">
  <asp:FileUpload ID="FileUpload1" runat="server" />
</div> 
```

和 Upload.ashx：

```
public class Upload : IHttpHandler, IRequiresSessionState {

public void ProcessRequest(HttpContext context)
{
    context.Session["FileNameNews"] = "";
    context.Response.ContentType = "text/plain";
    context.Response.Expires = -1;
    try
    {
        HttpPostedFile postedFile = context.Request.Files["Filedata"];

        string savepath = "";
        string tempPath = "";
        tempPath = "Temp";//System.Configuration.ConfigurationManager.AppSettings["FolderPath"]; 
        savepath = context.Server.MapPath(tempPath);
        string filename = postedFile.FileName;
        if (!Directory.Exists(savepath))
            Directory.CreateDirectory(savepath);

        string SitePath = context.Server.MapPath(context.Request.ApplicationPath) + @"\Temp\";
        string SitePath1 = context.Server.MapPath(context.Request.ApplicationPath) + @"\WebImages\NewsImages\";
        string FileN = SitePath + filename + "{---}" + context.Session["UserID"].ToString();
        if ((File.Exists(SitePath + filename + "{---}" + context.Session["UserID"])) || (File.Exists(SitePath1 + filename)))
        {
            return;
        }
        else
        {
            postedFile.SaveAs(savepath + @"\" + filename);
            postedFile.SaveAs(savepath + @"\" + filename + "{---}" + context.Session["UserID"]);
            if (context.Session["FileNameNews"] == "") { context.Session["FileNameNews"] = filename; }
            else { context.Session["FileNameNews"] = context.Session["FileNameNews"] + "," + filename; }
            context.Response.Write(tempPath + "/" + filename);
            context.Response.StatusCode = 200;
        }
    }
    catch (Exception ex)
    {
        context.Response.Write("Error: " + ex.Message);
    }
}

public bool IsReusable
{
    get
    {
        return false;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:59:12.847

如果此 ashx 处理程序是您的文件上传 ajax 请求的端点，并且您抛出异常，您将永远不会看到来自 try / catch 的错误消息。您可能会“吞下”您的异常。删除 try / catch 并使用浏览器中的调试工具检查结果状态（或错误消息）。

# c# - 你可以在一个任务上多次调用 Wait() 吗？

> ID：16195994
> 
> 赞同：6
> 
> 时间：2013-04-24T15:26:06.613
> 
> 标签：c#, .net, asynchronous, task, wait

我想异步运行一些对象的初始化，但有些对象依赖于其他对象的初始化。然后需要在我的应用程序的其余部分继续之前初始化所有对象。

是否可以在任务上调用 Wait() 并稍后再次调用 Wait() ，或者在我的示例 WaitAll() 上包含它的集合？

```
Dictionary<String, Task> taskdict = new Dictionary<String, Task>( );

   taskdict.Add( "Task1",
        Task.Factory.StartNew( ( ) => {
         //Do stuff
        } ) );

   taskdict.Add( "Task2",
        Task.Factory.StartNew( ( ) => {
          taskdict[ "Task1" ].Wait( );

         //Do stuff

        } ) );

      try {
        Task.WaitAll( taskdict.Values.Convert<Task[ ]>( ) );
      } 
```

或者第二个 Wait() / WaitAll() 会失败吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-24T15:29:18.457

您当然可以等待两次任务。您可以根据需要多次等待任务，而不会产生负面影响。现在，如果你已经在同一个线程中等待了一个任务，它已经完成了，所以未来的`Wait`调用都会立即返回，因为没有什么可等待的，但它们肯定不会失败或以其他方式产生不适当的结果.

请注意，如果一个任务没有正常完成，而是由于抛出异常而被取消或无法完成，那么调用`Wait`将重新抛出异常（每次调用`Wait`）。如果`Wait`为您抛出异常，则有可能这就是原因。

# c# - 如何为 c++ 代码创建 dll（对树程序使用大量指针），以便可以在 ASP.Net Web 应用程序中引用它

> ID：16195997
> 
> 赞同：1
> 
> 时间：2013-04-24T15:26:14.260
> 
> 标签：c#, c++, asp.net, web-applications

我有一个用于为字符串创建 AVL 树并计算其深度的 C++ 代码。我需要将字符串作为参数从前端（即 asp.net 网页）传递给 c++ 代码的函数，但目前我创建的 dll 不能包含在 asp.net Web 应用程序中。我使用此链接中给出的步骤创建了 dll：

> [http://msdn.microsoft.com/en-in/library/ms235636(v=vs.90).aspx](http://msdn.microsoft.com/en-in/library/ms235636(v=vs.90).aspx)

即使创建了 dll，当我尝试将其添加为我的 Web 应用程序中的引用时，我也会收到以下错误：

> 无法添加对 'c:\....\....\...（dll 路径）的引用。请确保该文件是可访问的，并且它是一个有效的程序集或 COM 组件。

有人可以指出我可能会出错的正确方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:33:18.053

你有几个选择

1.  您可以为您的 dll 提供直接的 C API，然后使用 pinvoke 直接调用从您的 c# 创建的函数。根据有多少类和函数，这可能会很痛苦。请参阅[C++ 中的 Api Design 以](https://rads.stackoverflow.com/amzn/click/com/0123850037)获得一些报道。

2.  [使用ATL 之](http://msdn.microsoft.com/en-us/library/t9adwcde%28v=vs.80%29.aspx)类的东西创建一个 com 接口。

3.  使用[C++ cli](http://en.wikipedia.org/wiki/C++/CLI)包装您的 C++ 代码并使其可从 c# 调用。如果您没有其他选择的经验，我会选择这个。

# wcf-data-services - WCF 数据服务和动态数据结构

> ID：16195999
> 
> 赞同：0
> 
> 时间：2013-04-24T15:26:18.073
> 
> 标签：wcf-data-services, dynamic-data

也许我的问题没有意义，但我会尝试公开我的问题：我想通过 WCF 数据服务公开自定义数据（基于反射提供程序）。

该数据是复杂请求的结果，其结构可能非常多变。我无法通过数据服务公开的 4 或 5 个自定义类对其进行建模。

例如，我可以得到类似 [date,name,age,function] 或 [date,time,page,type], [Country,hits,roi] ...等的结果。我不可能在自定义类中生成所有结果组合并通过 WCF 数据服务公开它们。

那么，是否可以公开具有非常可变结构的数据？当我看到 Azure Table 可以做什么时，我认为这是可能的，但我无法弄清楚它是如何工作的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T18:21:00.160

通常，在 OData 中，您可以使用开放类型执行此操作。通过将属性设置为如下所示，实体类型`$metadata`在服务文档中被声明为打开：`OpenType``true`

```
<EntityType Name="Customer" OpenType="true">
...
</EntityType> 
```

这意味着该实体类型的实例可以动态添加任意数量的未声明属性（除了该类型上的任何已声明属性）。

但是，WCF 数据服务反射提供程序不提供对开箱即用的开放类型的支持。为了将开放类型与 WCF 数据服务一起使用，您需要实现一个自定义提供程序（即，提供`IDataServiceQueryProvider`and的实现`IDataServiceMetadataProvider`）。为了帮助编写自定义提供程序，我[在这里](http://blogs.msdn.com/b/alexj/archive/2010/01/07/data-service-providers-getting-started.aspx)推荐 Alex 的博客系列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:32:23.793

我读过 Alex 的博客系列，但他没有使用开放类型属性。相反，他公开了一种无类型/RO & RW 技术，但我认为它不适合我的问题......