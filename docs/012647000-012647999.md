# StackOverflow 问答 12647000-12647999

# java - 具有包含 CheckBoxes 的自定义适配器的 Listview

> ID：12647001
> 
> 赞同：10
> 
> 时间：2012-09-28T20:30:27.863
> 
> 标签：java, android, listview, checkbox, adapter

我有一个使用自定义适配器的 ListView，如下所示：

```
private class CBAdapter extends BaseAdapter implements OnCheckedChangeListener{

    Context context;
    public String[] englishNames;
    LayoutInflater inflater;
    CheckBox[] checkBoxArray;
    LinearLayout[] viewArray;
    private boolean[] checked;

    public CBAdapter(Context con, String[] engNames){
        context=con;
        englishNames=engNames;
        inflater=(LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        checked= new boolean[englishNames.length];
        for(int i=0; i<checked.length; i++){
            checked[i]=false;
            //Toast.makeText(con, checked.toString(),Toast.LENGTH_SHORT).show();
        }
        checkBoxArray = new CheckBox[checked.length];
        viewArray = new LinearLayout[checked.length];
    }

    public int getCount() {
        return englishNames.length;
    }

    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return null;
    }

    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return 0;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        if(viewArray[position] == null){

            viewArray[position]=(LinearLayout)inflater.inflate(R.layout.record_view_start,null);

            TextView tv=(TextView)viewArray[position].findViewById(R.id.engName);
            tv.setText(englishNames[position]);

            checkBoxArray[position]=(CheckBox)viewArray[position].findViewById(R.id.checkBox1);
        }

        checkBoxArray[position].setChecked(checked[position]);
        checkBoxArray[position].setOnCheckedChangeListener(this);
        return viewArray[position];
    }

    public void checkAll(boolean areChecked){
        for(int i=0; i<checked.length; i++){
            checked[i]=areChecked;
            if(checkBoxArray[i] != null)
                checkBoxArray[i].setChecked(areChecked);
        }
        notifyDataSetChanged();
    }

    public void onCheckedChanged(CompoundButton cb, boolean isChecked) {
        for(int i=0; i<checked.length; i++){
            if(cb == checkBoxArray[i])
                checked[i]=isChecked;
        }

    }
    public boolean itemIsChecked(int i){
        return checked[i];
    }

} 
```

布局相当简单，所以除非有人认为它们相关，否则我不会发布它们。

问题是某些复选框没有响应。它似乎是第一次显示布局时可见的那些。您必须向下滚动才能按预期工作的任何内容。

任何指针表示赞赏。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-31T15:34:59.000

Your code from the answer works but is inefficient(you can actually see this, just scroll the `ListView` and check the `Logcat` to see the garbage collector doing it's work). An improved `getView` method which will recycle views is the one below:

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
     LinearLayout view = (LinearLayout) convertView;
     if (view == null) {
          view = (LinearLayout) inflater.inflate(R.layout.record_view_start, parent, false);
     }
     TextView tv = (TextView) view.findViewById(R.id.engName);
     tv.setText(getItem(position));
     CheckBox cBox = (CheckBox) view.findViewById(R.id.checkBox1);
     cBox.setTag(Integer.valueOf(position)); // set the tag so we can identify the correct row in the listener
     cBox.setChecked(mChecked[position]); // set the status as we stored it        
     cBox.setOnCheckedChangeListener(mListener); // set the listener    
     return view;
}

OnCheckedChangeListener mListener = new OnCheckedChangeListener() {

     public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {   
         mChecked[(Integer)buttonView.getTag()] = isChecked; // get the tag so we know the row and store the status 
     }
}; 
```

Regarding your code from your question, at first I thought it was wrong because of the way you setup the rows but I don't see why the adapter will have that behavior as you detached the row view from the list. Also, I even tested the code and it works quite well regarding `CheckBoxes`(but with very poor memory handling). Maybe you're doing something else that makes the adapter to not work?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:41:57.907

首先让我说你放弃了使用适配器的主要好处之一：可重用视图。对每个创建的对象进行硬引用`View`具有达到内存上限的高风险。您应该`convertView`在它为非空时重用，并在`convertView`为空时创建您的视图。有许多教程向您展示如何做到这一点。

适配器中使用的视图通常`OnClickListener`由父级附加到它们，`View`以便您可以`OnItemClickListener`在`ListView`. 这将取代单个视图上的任何触摸侦听器。尝试`android:clickable="true"`在`CheckBox`XML 中设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T07:46:33.240

这可能不是最优雅或最有效的解决方案，但它适用于我的情况。出于某种原因，尝试从视图数组或使用 convertView 重用视图会使每件事都变得摇摆不定，并且 CheckBoxes 无法响应。

唯一有效的方法是在每次调用 getView() 时创建一个新视图。

```
 public View getView(final int position, View convertView, ViewGroup parent) {
        LinearLayout view;
        view=(LinearLayout)inflater.inflate(R.layout.record_view_start,null);

        TextView tv=(TextView)view.findViewById(R.id.engName);
        tv.setText(englishNames[position]);

        CheckBox cBox=(CheckBox)view.findViewById(R.id.checkBox1);
        cBox.setChecked(checked[position]);
        cBox.setOnCheckedChangeListener(new OnCheckedChangeListener(){

            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                checked[position]=isChecked;
            }
        });
        return view;
    } 
```

找到这个解决方案也受到以下事实的阻碍：我调用了一个单独定义的 onCheckedChangedListener，然后通过 id 识别哪个 CheckBox，而不是为每个 CheckBox 设置一个新的侦听器。

到目前为止，我还没有将其标记为正确答案，因为我希望其他人可能对每次都相当浪费地重建视图有一些意见。

# ruby-on-rails - 由于奇怪的问题，Rails 服务器无法启动（库未加载）

> ID：12647003
> 
> 赞同：1
> 
> 时间：2012-09-28T20:30:33.480
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我突然开始在启动 Rails 服务器时遇到非常奇怪的问题。

谁能帮我？

```
 /Users/toptier/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.1.8/lib/active_support/dependencies.rb:240:in `require': dlopen(/Users/toptier/.rvm/gems/ruby-1.9.2-p320/gems/ffi-1.1.5/lib/ffi_c.bundle, 9): Library not loaded: /opt/local/lib/libffi.5.dylib (LoadError)
  Referenced from: /Users/toptier/.rvm/gems/ruby-1.9.2-p320/gems/ffi-1.1.5/lib/ffi_c.bundle
  Reason: image not found - /Users/toptier/.rvm/gems/ruby-1.9.2-p320/gems/ffi-1.1.5/lib/ffi_c.bundle
from /Users/toptier/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.1.8/lib/active_support/dependencies.rb:240:in `block in require'
from /Users/toptier/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.1.8/lib/active_support/dependencies.rb:223:in `block in load_dependency'
from /Users/toptier/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.1.8/lib/active_support/dependencies.rb:640:in `new_constants_in'
from /Users/toptier/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.1.8/lib/active_support/dependencies.rb:223:in `load_dependency' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T14:35:22.700

我重新安装了 gem“ffi”，一切正常。

谢谢

# python - 获取文件中的下一行

> ID：12647006
> 
> 赞同：18
> 
> 时间：2012-09-28T20:30:36.330
> 
> 标签：python, file, file-io

我正在读一个文件，想知道是否有办法在 for 循环中读取下一行？

我目前正在阅读这样的文件：

```
file = open(input,"r").read()
for line in file.splitlines():
  line = doSomething() 
```

那么无论如何我可以在那个for循环中检索文件的下一行，以便我可以在`doSomething()`函数中执行一些操作吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-28T20:32:04.320

只需循环打开文件：

```
infile = open(input,"r")
for line in infile:
    line = doSomething(line, next(infile)) 
```

因为您现在将文件用作迭代器，所以您可以随时调用变量上的函数[`next()`来](http://docs.python.org/2/library/functions.html#next)`infile`检索额外的行。

两个额外的提示：

1.  不要调用你的变量`file`；它掩盖了python中的内置`file`类型对象。`infile`我改为命名它。

2.  您可以将打开的文件用作`with`语句的上下文管理器。完成后它会自动为您关闭文件：

    ```
    with open(input,"r") as infile:
        for line in infile:
            line = doSomething(line, next(infile)) 
    ```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-28T20:33:42.137

```
file = open(input,"r").read()
lines =  file.read().splitlines()
for i in range(len(lines)):
     line = lines[i]
     next_line = lines[i+1] 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-28T20:40:41.167

我认为您的意思是，如果您在第 n 行，您希望能够访问第 n+1 行。

最简单的方法是更换

`for line in file.splitlines():`

和

```
lines = file.readlines()
for i in xrange(len(lines)): 
```

然后你可以得到当前行 `lines[i]` 和下一行 `lines[i+1]`

更pythonic的方法是使用枚举

```
lines = file.readlines()
for index, line in enumerate(lines): 
```

现在您像正常一样在“行”中拥有当前行，但如果您想找到与其相关的不同行，您也拥有索引。

# javascript - jQuery UI Datepicker 和 var

> ID：12647009
> 
> 赞同：1
> 
> 时间：2012-09-28T20:30:44.790
> 
> 标签：javascript, jquery, jquery-ui, javascript-framework

我似乎一辈子都无法让这个工作。基本上情况是这样的。我有一个函数可以执行并弹出一个 jQuery 对话框窗口，其中嵌入了一个 datepicker。用户选择一个日期，然后选择日期，然后将自动消息捕获到 var 中。问题是，当再次执行相同类型的代码时，sdate 会发生变化，但文本会保持不变，但会出现新的日期。我想要具有动态日期的动态文本。这很棘手，因为我知道 datepicker 是一个回调函数，这基本上超出了我对 javascript 编码的了解。

```
<div style="display:none" id="dd">
<div id="d1"></div>
</div> 
```

例如。测试（'1'） 测试（'2'）

```
var sdate, text

//==========================================================================
    function test(x) {
        //==========================================================================
        if (x == '1') {

            $('#dd')
                .dialog({
                autoOpen: true,
                modal: true,
                overlay: {
                    opacity: 1.0,
                    background: 'black'
                },
                title: "SELECT DATE 1...",
                height: 235,
                width: 235,
                draggable: false,
                resizable: false
            });
            $('#d1')
                .datepicker({
                onSelect: function () {

                    sdate = $(this)
                        .val();
                    $("#dd")
                        .dialog("close");

                    text = 'THE DATE YOU HAVE CHOSEN IS: ' + sdate + '.'
                    alert(text)

                } //end of onSelect: function() {
            }); //end of datepicker

        } //end of (x == '1')

        else if (x == '2') {

            $('#dd')
                .dialog({
                autoOpen: true,
                modal: true,
                overlay: {
                    opacity: 1.0,
                    background: 'black'
                },
                title: "SELECT DATE 2...",
                height: 235,
                width: 235,
                draggable: false,
                resizable: false
            });
            $('#d1')
                .datepicker({
                onSelect: function () {

                    sdate = $(this)
                        .val();
                    $("#dd")
                        .dialog("close");

                    text = 'THE 2ND DATE YOU HAVE CHOSEN IS: ' + sdate + '.'
                    alert(text)

                } //end of onSelect: function() {
            }); //end of datepicker

        } //end of (x == '2')

    } //end of function 
```

发疯了，需要这个论坛专家的帮助。

非常感谢和感谢您的所有帮助和支持

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:08:57.520

我对你运行它的顺序有一点问题，所以我改变了一些东西。我在[jsFiddle](http://jsfiddle.net/JonathanBates/rcpNH/)中运行了这个：

我使用了这个html：

```
<link type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/redmond/jquery-ui.css" rel="stylesheet" />

<div style="display:none" id="dd">
    <div id="d1"></div>
</div>

<button data="1">1</button>
<button data="2">2</button> 
```

按钮仅用于触发代码

我使用了以下脚本：

```
jQuery(document).ready(function(){
    jQuery("button").click(function(){
        test(jQuery(this).attr("data"));        
    });
});

var sdate, text

function test(x) {
    if (x == '1') {
        $('#d1').datepicker({
            onSelect: function() {
                sdate = $(this).val();
                $("#dd").dialog("close");
                text = 'THE DATE YOU HAVE CHOSEN IS: '+ sdate +'.';
                alert(text);
                //jQuery(this).datepicker("destroy");
             }//end of onSelect: function() {
        });//end of datepicker

        $('#dd').dialog({ 
            autoOpen: true, 
            modal: true, 
            overlay: { 
                opacity: 1.0, 
                background: 'black' 
            }, 
            title: "SELECT DATE 1...", 
            height: 400, 
            width: 400, 
            draggable: false, 
            resizable: false});

    } else if (x == '2') {
        $('#d1').datepicker({
            onSelect: function() {
                sdate = $(this).val();
                $("#dd").dialog("close");
                text = 'THE 2ND DATE YOU HAVE CHOSEN IS: '+ sdate +'.';
                alert(text);
            //jQuery(this).datepicker("destroy");

             }//end of onSelect: function() {
        });//end of datepicker

        $('#dd').dialog({ 
            autoOpen: true, 
            modal: true, 
            overlay: { 
                opacity: 1.0, 
                background: 'black' 
            }, 
            title: "SELECT DATE 2...", 
            height: 400, 
            width: 400, 
            draggable: false, 
            resizable: false});

    }//end of (x == '2')

}//end of function 
```

我让它工作的唯一问题是操作顺序。所以我在创建对话框之前创建了日期选择器。

# scala - 用于数据库访问的 Play & Akka 和阻塞线程

> ID：12647010
> 
> 赞同：7
> 
> 时间：2012-09-28T20:30:49.267
> 
> 标签：scala, playframework-2.0, akka, nonblocking

我想调用一个包含大量数据的数据库，并且可能需要一段时间才能返回。

我计划在对 Akka.future(f) 的调用中完成这项工作，并在工作完成后使用 Async{} 呈现响应。

这样做是否有意义，或者我应该只在控制器中进行长时间的数据库调用，而不将工作发送给 Akka？

或者有没有办法进行非阻塞数据库访问？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T15:11:56.573

如果您被迫为您的数据库使用阻塞驱动程序（如果由于某种原因 MySQL 的异步驱动程序不起作用），请考虑使用 PinnedDispatcher 设置一个 Actor 池（使用路由）。

PinnedDispatcher 为每个参与者提供一个线程，并且通过设置路由器，您可以调整严格负责处理数据库调用的线程数。易于缩放。此外，通过使用 Actors，您可以更轻松地构建 Actor 之间的消息（例如，具有数据库调用结果的消息）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T14:59:30.970

您可以使用`Akka.future(f)`并提供您自己的 Akka 配置文件来获得更多线程来处理您的数据库访问。例如看[这个配置文件](https://gist.github.com/2973705)。

但是您指出了：真正的问题在于使用阻塞的数据库驱动程序。我不知道您使用的是哪个数据库，但值得以[ReactiveMongo](http://reactivemongo.org)为例来看看 MongoDB。使用 ReactiveMongo，所有 MongoDB 操作都是完全非阻塞和异步的。[这里](http://stephane.godbillon.com/2012/08/30/reactivemongo-for-scala-unleashing-mongodb-streaming-capabilities-for-realtime-web)有很好的介绍。此外，它很好地处理了 Play 框架（检查[ReactiveMongo Play 插件](https://github.com/zenexity/Play-ReactiveMongo)）。

编辑：您还可以检查“[配置 Playframework 的内部 Akka 系统](http://www.playframework.org/documentation/2.0.3/AkkaCore)”来调整工作线程数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T21:31:53.450

如果响应在数据库调用完成时被阻塞，那么只有在调用运行时您可以完成其他工作来组装响应时，才使其异步有用。

非阻塞数据库访问可能意味着几件不同的事情：一个为您提供基于回调的 API 的客户端库，这与未来的解决方案非常相似，或者一个使用非阻塞套接字来节省线程使用的客户端库。我假设您的意思是前者，在这种情况下，我认为它在功能上等同于使用未来。

# javascript - 卸载时更改 href（或 location.href 更改）

> ID：12647014
> 
> 赞同：0
> 
> 时间：2012-09-28T20:31:14.690
> 
> 标签：javascript, dom-events, location-href

在我们的网站中有几个链接（和 Javascript 片段）包含`/2012/responses/{pathParams...}`，如果它是 web 视图，我现在需要有条件地添加到路径中。

```
if (isWebview) {
  // use '/2012/responses/webview/{pathParams...}'
} else {
  // use '/2012/responses/{pathParams...}'
} 
```

我可以通过检查来处理链接`document.links`，但我想知道是否有办法处理使用`window.location = '/2012/responses/...'`. 一种方法是创建一个函数来更改 window.location 并将 window.location 语句替换为该函数。但是，有没有办法将它作为一个事件来处理，所以当页面发生变化时，我可以有条件地`/webview`在 URL 中插入？浏览器限制似乎将`beforeunload`事件限制为仅提示用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:42:45.563

我认为你不能。我有 2 个选项供您选择：

**选项1：**

*如果 -->我建议*使用三元内联替换所有代码

 *样本：

> 搜索：
> 
> ```
>  '/2012/responses/{pathParams...}' 
> ```
> 
> 用。。。来代替：
> 
> ```
>  '/2012/responses/'+((isWebView?)?'webview/':'')+'{pathParams...}' 
> ```

**选项 2：**

将`/webView`有条件地放在*服务器端*的`{pathParams...}`变量内*

# ios - iOS Animate 使用手势将图像视图从屏幕外滑动到屏幕上

> ID：12647017
> 
> 赞同：1
> 
> 时间：2012-09-28T20:31:51.547
> 
> 标签：ios, image, animation, sliding

我正在寻找带有文字的气泡动画，以在屏幕上滑动和滑出。此动画的理想实现是启用分页的 iOS 水平滚动。当我到达语音气泡的末尾时，我绝对想要“反弹”，并且我绝对希望气泡跟踪手指直到它们滑出屏幕之前的某个点。我相信这与滑动不同（这只是一个方向的轻弹）。

然而，水平滚动的问题在于它针对静态数量的图像进行了优化。我将拥有动态数量的图像，据我所知，您不能将图像动态附加到水平滚动条。这个想法是应用程序在您继续浏览滚动条时动态地将内容添加到滚动条中。

卷轴很容易上手，但我现在必须把它拆掉。我如何开始使用手势（我不确定标准手势识别器此时是否对我有用）以及动画？我以前从未使用过这部分 iOS 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:08:00.060

我不确定我是否完全遵循您的问题，但是如果您想根据手势为某物的运动设置动画，您可以使用 a`UIPanGestureRecognizer`并更改`center`您想要的任何子视图。例如，`viewDidLoad`你会：

```
UIPanGestureRecognizer *panGesture = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(movePiece:)];
[whateverViewYouWantToAnimate addGestureRecognizer:panGesture]; 
```

然后，您可以让手势识别器将其移动到您想要的任何位置：

```
- (void)movePiece:(UIPanGestureRecognizer *)gestureRecognizer
{
    static CGPoint originalCenter;

    if (gestureRecognizer.state == UIGestureRecognizerStateBegan)
    {
        originalCenter = [gestureRecognizer view].center;
    }
    else if (gestureRecognizer.state == UIGestureRecognizerStateChanged)
    {
        CGPoint translation = [gestureRecognizer translationInView:self.view];

        gestureRecognizer.view.center = CGPointMake(originalCenter.x + translation.x, originalCenter.y);

        // if you wanted to animate both left/right and up/down, it would be:
        // gestureRecognizer.view.center = CGPointMake(originalCenter.x + translation.x, originalCenter.y + translation.y);
    }
    else if (gestureRecognizer.state == UIGestureRecognizerStateEnded)
    {
        // replace this offscreen CGPoint with something that makes sense for your app

        CGPoint offscreen = CGPointMake(480, gestureRecognizer.view.center.y);

        [UIView animateWithDuration:0.5
                         animations:^{
                             gestureRecognizer.view.center = offscreen;
                         }
                         completion:^(BOOL finished){
                             // when you're done, you might want to do whatever cleanup
                             // is appropriate for your app (e.g. do you want to remove it?)
                             [gestureRecognizer.view removeFromSuperview];
                         }];
    }
} 
```

# ios - iOS 客户端应用程序中的 HTTP 身份验证类型协商

> ID：12647019
> 
> 赞同：3
> 
> 时间：2012-09-28T20:31:59.730
> 
> 标签：ios, asihttprequest, kerberos, http-authentication, negotiate

iOS 应用程序是否支持“协商”HTTP 身份验证方案？

我正在尝试访问使用此身份验证方案的服务器。我目前正在使用 ASIHTTPRequest 类，它在内部使用 CFNetwork 库。身份验证失败，并且通过 ASIHTTPRequest 代码跟踪我看到它在通过调用 CFHTTPAuthenticationCreateFromResponse 函数创建的 CFHTTPAuthentication 对象未能通过 CFHTTPAuthenticationIsValid 函数检查后失败。返回的错误是“kCFStreamErrorHTTPAuthenticationTypeUnsupported = -1000”。它用于尝试创建 CFHTTPAuthentication 的响应具有“WWW-Authenticate = Negotiate”标头。这让我觉得不支持协商方案。但是 CFHTTPAuthentication 的库文档将“kCFHTTPAuthenticationSchemeNegotiate”列为“

以下是来自 attemptToApplyCredentialsAndResume 方法的 ASIHTTPRequest.m 代码的相关部分。

```
// Read authentication data
if (!requestAuthentication) {
    CFHTTPMessageRef responseHeader = (CFHTTPMessageRef) CFReadStreamCopyProperty((CFReadStreamRef)[self readStream],kCFStreamPropertyHTTPResponseHeader);
    requestAuthentication = CFHTTPAuthenticationCreateFromResponse(NULL, responseHeader);
    CFRelease(responseHeader);
    [self setAuthenticationScheme:[(NSString *)CFHTTPAuthenticationCopyMethod(requestAuthentication) autorelease]];
}

//SNIP

// See if authentication is valid
CFStreamError err;      
if (!CFHTTPAuthenticationIsValid(requestAuthentication, &err)) {

    CFRelease(requestAuthentication);
    requestAuthentication = NULL; 
```

我对协商方案本身也有些困惑。据我了解，如果可能，它应该尝试使用 Kerberos 方案，如果没有，则回退到 NTLM 方案。iOS 支持 NTLM 方案，但这种回退似乎没有发生，至少不是 CFHTTPAuthenticationCreateFromResponse 处理它的方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-04T16:43:46.680

iOS 7 上的 Safari 通过 HTTP 协商支持单点登录 (SSO)：

> 为了配置 SSO，iOS 支持配置文件负载，允许 MDM 服务器下推必要的设置。这包括设置用户主体名称（即 Active Directory 用户帐户）和 Kerberos 领域设置，以及配置应允许哪些应用程序和/或 Safari Web URL 使用 SSO。

来源： [iOS 安全，2014 年 2 月](http://images.apple.com/iphone/business/docs/iOS_Security_Feb14.pdf)（第 18 页）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T07:20:06.700

iPhone 上不支持 Kerberos。协商回退到 NTLM，但不要期望 iOS 支持专有的身份验证方案。可能存在第三方实现。

# eclipse - Eclipse 是否支持“快速大纲”命令之类的东西，但适用于所有项目？

> ID：12647020
> 
> 赞同：1
> 
> 时间：2012-09-28T20:32:03.510
> 
> 标签：eclipse

在 Eclipse 中，“快速大纲”命令可以让您快速跳转到当前类中的某个方法。是否有类似的功能可以让您快速跳转到所有项目中的任何方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:30:17.663

不，

CTRL+SHIFT+T 和 CTRL+SHIFT+R（打开类型和打开资源）可以打开工作区中的任何类型/文件，从这里您可以跳转到方法。但是，Eclipse 不会保留工作区中所有方法的索引。

您还可以进行“Java 搜索”——这是一种具有更多上下文的搜索。例如，您可以在整个工作区中搜索名为 setFoo 的方法。这可能会有所帮助，但我不会说这是“快速方法”。

# mysql - 查询之间的细微差别？

> ID：12647023
> 
> 赞同：2
> 
> 时间：2012-09-28T20:32:11.890
> 
> 标签：mysql, sql, arel

在文章*[为什么是 Arel？](https://magicscalingsprinkles.wordpress.com/2010/01/28/why-i-wrote-arel/)*，作者提出问题：

> 假设我们有一个 users 表和一个 photos 表，我们想要选择所有用户数据和他们创建的照片的 *count*。

他提出的解决方案（添加了换行符）是

```
SELECT users.*, photos_aggregation.cnt
FROM users
LEFT OUTER JOIN (SELECT user_id, count(*) as cnt FROM photos GROUP BY user_id)
  AS photos_aggregation
ON photos_aggregation.user_id = users.id 
```

当我尝试编写这样的查询时，我想出了

```
select users.*, if(count(photos.id) = 0, null, count(photos.id)) as cnt
from users
left join photos on photos.user_id = users.id
group by users.id 
```

^(（`if()`列列表中的只是为了让它在用户没有照片时表现相同。）)

文章的作者接着说

> 只有高级 SQL 程序员知道如何写这个（我在工作面试中经常问这个问题，我从未见过有人做对）。而且应该不难！

我不认为自己是“高级 SQL 程序员”，所以我认为我遗漏了一些微妙的东西。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:59:11.763

我相信您的版本会产生错误，至少在某些数据库引擎中是这样。在 MSSQL 中，您的选择会生成`[Column Name] is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.`. 这是因为您选择的只能包含 group by 或 count 中的值。

您可以将您的版本修改为`select users.id, count(photo.id)`并且它会起作用，但它与他的查询的结果不同。

我不会说您必须特别先进才能提出一个可行的解决方案（或他提出的具体解决方案），但有必要在连接中或@ron tornambe 建议的单独查询中执行该组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:00:44.677

在大多数 DBMS（MySQL 和[Postgres](http://www.postgresql.org/docs/9.2/static/sql-select.html#SQL-GROUPBY)除外）中，您问题中的版本将无效。

您需要编写不使用派生表的查询

```
select users.*, CASE WHEN count(photos.id) > 0 THEN count(photos.id) END as cnt
from users
left join photos on photos.user_id = users.id
group by users.id, users.name, users.email /* and so on*/ 
```

MySQL 允许您选择不在`group by`列表中的非聚合项，但这仅在它们在功能上依赖于`group by`.

虽然`group by`没有派生表的列表更冗长，但我希望大多数优化器无论如何都能够将一个转换为另一个。当然，在 SQL Server 中，如果它看到您正在按 PK 和其他一些列进行分组，它实际上并没有通过对这些其他列的比较进行分组。

关于这种 MySQL 行为与标准 SQL 的一些讨论在[Debunking GROUP BY 神话中](http://rpbouman.blogspot.co.uk/2007/05/debunking-group-by-myths.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:37:24.973

也许这篇文章的作者是错误的。您的解决方案也很有效，而且可能会更快。

就个人而言，我会完全放弃`if`。如果你想计算图片的数量，'没有图片'的结果是有意义的，`0`而不是`null`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T20:55:24.760

作为替代方案，您还可以编写相关子查询：

```
SELECT u.*, (SELECT Count(*) FROM photos p WHERE p.userid=u.id) as cnt
FROM users u 
```

# c# - linq 从字典中选择

> ID：12647025
> 
> 赞同：-1
> 
> 时间：2012-09-28T20:32:18.127
> 
> 标签：c#, linq, linq-to-sql

> **可能重复：**
> [linq-to-sql group by 计数和自定义对象模型](https://stackoverflow.com/questions/12644136/linq-to-sql-group-by-with-count-and-custom-object-model)

我有一个 linq-to-sql 查询，它可以分组和计数，结果最终出现在字典中。我想将字典映射到对象模型的属性。对象模型如下所示：

```
public class MyCountModel()
{
  int CountSomeByte1 { get; set; }
  int CountSomeByte2 { get; set; }
  int CountSomeByte3 { get; set; }
  int CountSomeByte4 { get; set; }
  int CountSomeByte5 { get; set; }
  int CountSomeByte6 { get; set; }
} 
```

我想映射字典，以便查询像这样结束：

```
var TheQuery = MyDC.SomeTable
               .Where(...)
               .GroupBy(...)
               .ToDictionary(x => x.Key, x=> x.Count()
               .Select(m => new MyCountModel()
               {
                  CountSomeByte1 = ..., // the value where Key is 1
                  CountSomeByte2 = ...., // the value where Key is 2
                  ....
                  CountSomeByte6 = .... // the value where Key is 6
                }); 
```

我怎么能写出这样的东西？感谢您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:42:24.960

你不想选择任何东西。我认为您只是想将查询“减少”为单个值：

```
var dictionary = MyDC.SomeTable
               .Where(...)
               .GroupBy(...)
               .ToDictionary(x => x.Key, x=> x.Count());

var result = new  MyCountModel
               {
                  CountSomeByte1 = dictionary[1],
                  CountSomeByte2 = dictionary[2],
                  ....
                  CountSomeByte6 = dictionary[6]
                }); 
```

# zend-framework2 - zend framework 2 使用依赖注入配置模块失败

> ID：12647031
> 
> 赞同：0
> 
> 时间：2012-09-28T20:32:48.063
> 
> 标签：zend-framework2

我正在尝试使用依赖注入配置应用程序模块。但是依赖项似乎没有被注入。这是我的配置的一部分：

```
'di' => array(
    'instance' => array(
        'Zend\View\Resolver\AggregateResolver' => array(
                'injections' => array(
                        'Zend\View\Resolver\TemplateMapResolver',
                        'Zend\View\Resolver\TemplatePathStack',
                ),
        ),
        'Zend\View\Resolver\TemplateMapResolver' => array(
                'parameters' => array(
                        'map'  => array(
                                'home'        => __DIR__ . '/../view/home.phtml',
                                'site/layout' => __DIR__ . '/../view/site/layout.phtml',
                                'site/error'  => __DIR__ . '/../view/site/error.phtml',
                                'site/404'    => __DIR__ . '/../view/site/404.phtml',
                        ),
                ),
        ),
        'Zend\View\Resolver\TemplatePathStack' => array(
                'parameters' => array(
                        'paths'  => array(
                                'application' => __DIR__ . '/../view',
                        ),
                ),
        ),
        'Zend\View\Renderer\PhpRenderer' => array(
                'parameters' => array(
                        'resolver' => 'Zend\View\Resolver\AggregateResolver',
                ),
        ),
        'Zend\Mvc\View\DefaultRenderingStrategy' => array(
                'parameters' => array(
                        'layoutTemplate' => 'site/layout',
                ),
        ),
        'Zend\View\View' => array(
            'parameters' => array(
                        'renderer'=>'Zend\View\Renderer\PhpRenderer'
                    )
        ),
    ) 
```

),

`Zend\View\Renderer\PhpRenderer`对象未注入。如何配置我的应用程序以将 DI 用于视图和解析器？

# php - 获取所有对象变量的列表，而不考虑修饰符 PHP

> ID：12647038
> 
> 赞同：0
> 
> 时间：2012-09-28T20:33:32.410
> 
> 标签：php, oop

我想获得一个类中所有变量的数组，包括私有变量，而不必实例化对象。我知道 php 的 get_class_vars() 但它只显示范围内的变量。我从课堂外调用它，所以所有私有变量都被隐藏了。

我的目的是为列出的每个对象创建一个包含所有变量的页面，并且我不想实例化每个对象，因为它们都需要不同的标识符来实例化，我想避免必须传递一堆 id如果可能，该页面。

请注意，变量的值并不重要，我只想要变量名。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:36:12.220

使用[反射](http://php.net/manual/en/reflectionclass.getproperties.php)，卢克。

使用`ReflectionClass::getProperties`，您可以获得一个类的所有字段。

例如

```
$reflection = new ReflectionClass('YourClass');

foreach( $reflection -> getProperties() as $field )
{

    echo $field ."\n";

} 
```

# dependency-injection - 简单的注入器 ASP.NET MVC 发布表单结果错误

> ID：12647040
> 
> 赞同：0
> 
> 时间：2012-09-28T20:33:41.410
> 
> 标签：dependency-injection, simple-injector

我是使用简单注入器的新手，按照 codeplex 和 nuget 包指南中的说明注册所有实例。当我单击链接时，一切正常，这与没有表单返回结果的操作有关。

当我有一个输入了一些数据的表单并在单击提交按钮后，对于任何 get 或 post 方法，我都有一个错误，例如容器未初始化：

“没有为此对象定义无参数构造函数。”

无法弄清楚为什么会这样。

# php - 没有数据库的多个字段同名的表单验证后的cakephp空表单

> ID：12647050
> 
> 赞同：0
> 
> 时间：2012-09-28T20:34:24.717
> 
> 标签：php, cakephp

我正在使用具有多个同名字段的表单。在对表单进行错误验证后，我将使用验证消息返回给它。这一切都有效。虽然字段的验证消息显示正确，但字段中输入的数据却消失了。

它的 cakephp 2.2 应用程序没有数据库。（将数据保存到 3 页的会话中，然后将其写入 XML）

step2.ctp：

```
debug($this->Form);
echo $this->Form->input('Invoice.0.InvoiceOrderNumber', array('label' => false));
echo $this->Form->input('Invoice.0.NetAmount', array('label' => false));
echo $this->Form->input('Invoice.0.CostBearer', array('label' => false));
echo $this->Form->input('Invoice.0.CostCenter', array('label' => false));
echo $this->Form->input('Invoice.0.LedgerAccount', array('label' => false)); 
```

控制器：

```
public function step2() {
    $invoice = $this->Session->read('Invoice');
    if (!isset($invoice) && is_array($invoice))
        $this->redirect(array('action' => 'step1'));
    else
    {       
        $this->set('title_for_layout', 'Nieuwe interne doorbelasting');
        if ($this->request->is('post')) {

            debug($this->request->data);
            if ($this->Invoice->validateMany($this->request->data['Invoice']))
            {
                if ($this->Session->write('Invoice', $this->request->data['Invoice'])) {
                    $this->Session->setFlash(__('The invoice has been saved'));
                    $this->redirect(array('action' => 'step3'));
                } else {
                    $this->Session->setFlash(__('The invoice could not be saved. Please, try again.'));
                }
            }
        }
    }
} 
```

step2.ctp 中 ($this->Form) 的调试：

```
 .....
request => object(CakeRequest) {
    params => array(
        'plugin' => null,
        'controller' => 'invoices',
        'action' => 'step2',
        'named' => array(),
        'pass' => array(),
        'models' => array(
            'Invoice' => array(
                'plugin' => null,
                'className' => 'Invoice'
            )
        )
    )
    data => array(
        'Invoice' => array(
            (int) 0 => array(
                'Invoice' => array(
                    'InvoiceOrderNumber' => 'adfas',
                    'NetAmount' => '2',
                    'CostBearer' => '',
                    'CostCenter' => '',
                    'LedgerAccount' => ''
                )
            ),
            (int) 1 => array(
                'Invoice' => array(
                    'InvoiceOrderNumber' => 'adaaaaaaaaa',
                    'NetAmount' => 'bbbbbbbbb',
                    'CostBearer' => '',
                    'CostCenter' => '',
                    'LedgerAccount' => ''
                )
            )
        )
    )
.... 
```

所以数据在那里，但蛋糕没有把它放在字段中。但我想不通为什么...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T13:19:22.573

我在提示后找到了解决方案。验证确实改变了数据。我错过了模型中的警告：“* 警告：此方法可能会更改传递的参数 $data，* 如果您不希望发生这种情况，请在将 $data 传递给此方法之前复制它*”

所以我的解决方案：

```
 $invoiceData = $this->request->data['Invoice'];
    if ($this->Invoice->validateMany($this->request->data['Invoice']))
    {
    ...
    }
    $this->request->data['Invoice'] = $invoiceData; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T11:21:23.463

尝试这个：

```
$this->Form->create('Invoice');
$this->Form->input('0.OrderNumber');
$this->Form->input('0.NetAmount');
...
$this->Form->input('1.OrderNumber');
$this->Form->input('1.NetAmount'); 
```

# java - Java：如何创建一个需要扩展类并实现接口的数据类型的泛型类？

> ID：12647051
> 
> 赞同：4
> 
> 时间：2012-09-28T20:34:26.503
> 
> 标签：java, gwt

我想在 GWT 中创建一个组合，该组合需要一个扩展类并实现接口的类。伪代码如下（它显然不起作用）：

```
class GridRow<T extends Widget implements HasText> extends Composite{
  //more codes here
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-28T20:37:05.330

写成：

```
class GridRow<T extends Widget & HasText> extends Composite {
    // ...
} 
```

您可以拥有`[class or interface]( & [interface])*`（使用伪正则表达式语言）。

# perl - 如何在 Perl 或 PowerShell 脚本中访问文件属性的“详细信息”（“标题”、“主题”等）

> ID：12647054
> 
> 赞同：7
> 
> 时间：2012-09-28T20:34:36.380
> 
> 标签：perl, powershell, file-properties

如果您在 Windows 资源管理器中查看文件属性，“详细信息”选项卡， - 对于许多文件类型（例如，tiff 或 jpeg 图像、Office 文档等），“描述”部分包含“标题”、“主题”、“标签”和“评论”。有没有办法从 Perl 或 PowerShell 脚本读取/写入这些字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:39:54.473

不久前，我写了[一篇关于如何访问扩展属性](http://rkeithhill.wordpress.com/2005/12/10/msh-get-extended-properties-of-a-file/)的博文——就像 PowerShell 仍处于测试阶段并称为 Microsoft Command Shell (MSH) 时一样。:-) 我认为这仍然是一种有效的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-06T14:14:57.263

PowerShell 经历了一些迭代，现在可以使用本机命令来实现：**Get-ItemProperty**

示例：显示 ntdll.dll 文件的当前详细信息：

```
Get-ItemProperty C:\Windows\System32\ntdll.dll | format-list 
```

# c - 未定义的函数引用 - 包括头文件

> ID：12647059
> 
> 赞同：0
> 
> 时间：2012-09-28T20:35:21.643
> 
> 标签：c

我在 memory.c 的 get_metadata_record_new(sz) 上得到“未定义的对 `get_metadata_record_new' 的引用”

{内存.c}

```
#include "metadata_record.h"

bool add_tohashtable(struct memory *mem, char *key_address, size_t sz) {
    //Getting the error on this next line
    struct metadata_record * metarec = get_metadata_record_new(sz);
    ...
} 
```

{metatdata_record.h}

```
#ifndef METADATA_H_
#define METADATA_H_
struct metadata_record {
    size_t size;
    bool allocated;
};

struct metadata_record *get_metadata_record_new(size_t);
...
#endif /* METADATA_H_ */ 
```

我尝试将此定义从 metadata_record.c 文件复制并粘贴到 memory.c 的顶部，错误消失了：

```
struct metadata_record *get_metadata_record_new(size_t sz) {
...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:40:31.823

您必须将两个文件链接在一起才能看到另一个文件。

专业提示：不要像这样编写 Makefile

```
myprog: file_one.o file_two.o 
```

你**会忘记更新它们。**此外，这只是一个糟糕的概念。相反，像这样写 Makefile

```
OBJECTS = $(patsubst %.c, %.o, $(wildcard *.c))
myprog: $(OBJECTS) 
```

那会*不那么频繁地中断。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:38:56.210

我忘了链接文件（在我的 make 文件中）。

# ruby-on-rails-3 - 门卫和 OAuth2

> ID：12647063
> 
> 赞同：0
> 
> 时间：2012-09-28T20:36:16.433
> 
> 标签：ruby-on-rails-3, gem

当我按照 ryan 的教程了解如何使用[Doorkeeper 保护其余 API](http://railscasts.com/episodes/353-oauth-with-doorkeeper)时，我总是遇到此错误：

> OAuth2::Error: invalid_grant: 提供的授权授权无效、已过期、已撤销、与授权请求中使用的重定向 URI 不匹配，或者已发布给另一个客户端。{"error":"invalid_grant","error_description":"提供的授权授权无效、过期、撤销、与授权请求中使用的重定向 URI 不匹配，或者已发布给另一个客户端。"}

当我处于解析令牌阶段时。有什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:46:28.977

我有提前 20 分钟调整时间的习惯，这就是问题的根源。通过同步更改时间，现在一切正常:)

# c# - int 上的无效强制转换异常加倍

> ID：12647068
> 
> 赞同：24
> 
> 时间：2012-09-28T20:36:41.637
> 
> 标签：c#, linq, casting, linqpad

也许我疯了，但我认为这是一个有效的演员表：

```
(new int[]{1,2,3,4,5}).Cast<double>() 
```

为什么 LinqPad 会抛出一个

> InvalidCastException：指定的强制转换无效。

?

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-28T20:41:32.193

C# 允许`int`直接从 to 转换`double`，但不允许从`int`to `object`to 转换`double`。

```
int i = 1;
object o = i;
double d1 = (double)i; // okay
double d2 = (double)o; // error 
```

扩展方法的`Enumerable.Cast`行为类似于后者。它不会将值转换为不同的类型，它会断言值已经是预期的类型，如果不是则抛出异常。

您可以尝试`(new int[]{1,2,3,4,5}).Select(i => (double)i)`获得价值转换行为。

# mysql - SQL - 如何通过将分号连接到数字来形成字符串？

> ID：12647070
> 
> 赞同：0
> 
> 时间：2012-09-28T20:36:46.270
> 
> 标签：mysql, sql, concatenation

特别是 MySQL，但我猜答案应该是通用的。

首先，我将一个变量设置为一个数字，如下所示：

```
SET @somenumber:=LAST_INSERT_ID(); 
```

请注意，这`LAST_INSERT_ID()`基本上相当于 MySQL 的`SCOPE_IDENTITY()`. 接下来我尝试通过将分号连接到这个数字来创建一个字符串：

```
SET @somestring:=';'+@somenumber+';'; 
```

最后我尝试将其作为字符串插入：

```
INSERT INTO `sometable` (`somevarcharcolumn`) VALUES (somestring); 
```

结果是列中只添加了数字而缺少分​​号。

谁能指出我做错了什么或者我需要做些什么才能让它发挥作用？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:39:34.977

希望这可以帮助

```
//MySQL
SET @somestring:=CONCAT(';',@somenumber,';');

//SQL Server
SET @somestring = ';'+CAST(@somenumber AS VARCHAR)+';';

//Oracle
SET somestring_ :=';' || somenumber_ || ';'; 
```

# iphone - uitextfield positionFromPosition：偏移量不起作用表情符号

> ID：12647071
> 
> 赞同：5
> 
> 时间：2012-09-28T20:36:59.313
> 
> 标签：iphone, objective-c, ios, uitextfield, emoji

我正在尝试实现我自己的包含表情符号的键盘。为此，我将表情符号插入光标位置。

如果 UITextField 中不存在 4 字节的表情符号字符，则此方法可以正常工作。否则应用程序会崩溃。

我在这里发布插入代码。有人可以指出如何解决这个问题吗？

```
UITextField *field = self.textField;
UITextRange *range = field.selectedTextRange;
int pos = [field offsetFromPosition:field.beginningOfDocument toPosition:range.end];
NSString * firstHalfString = [field.text substringToIndex:pos];  
NSString * secondHalfString = [field.text substringFromIndex:pos];  
field.text = [NSString stringWithFormat: @"%@%@%@", firstHalfString, emoticon, secondHalfString];
UITextPosition *newPos = [field positionFromPosition:field.beginningOfDocument offset:pos + 1];
field.selectedTextRange = [field textRangeFromPosition:newPos toPosition:newPos]; 
```

如果文本中有表情符号，则此行返回 nil：

```
UITextPosition *newPos = [field positionFromPosition:field.beginningOfDocument offset:pos + 1]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-02T03:02:56.210

最后，我通过编写自己的长度和偏移量计算方法解决了这个问题，将 4 字节字符计为 1 个字符，而不是 2 个。

```
@implementation NSString (UnicodeAdditions)
-(NSInteger)utf32length {
    const char* bytes = [self UTF8String];
    int length = [self lengthOfBytesUsingEncoding:NSUTF16StringEncoding];
    int newLength = 0;
    for (int i=0; i<length; i++) {
        if (((unsigned char)bytes[i] >> 7) == 0b00000000)  {
          newLength++;
        }
        else if (((unsigned char)bytes[i] >> 5) == 0b00000110) {
            newLength++;
            i+=1;
        }
        else if (((unsigned char)bytes[i] >> 4) == 0b00001110) {
            newLength++;
            i+=2;
        }
        else if (((unsigned char)bytes[i] >> 3) == 0b00011110) {
            newLength++;
            i+=3;
        }
    }
    return newLength;
}

-(NSInteger)utf32offsetWithOffset:(NSInteger)offset {
    const char* bytes = [self UTF8String];
    int length = [self lengthOfBytesUsingEncoding:NSUTF16StringEncoding];
    int newLength = 0;
    for (int i=0; i<length && offset!=0; i++) {
        if (((unsigned char)bytes[i] >> 7) == 0b00000000)  {
            offset--;
            newLength++;
        }
        else if (((unsigned char)bytes[i] >> 5) == 0b00000110) {
            offset--;
            newLength++;
            i+=1;
        }
        else if (((unsigned char)bytes[i] >> 4) == 0b00001110) {
            offset--;
            newLength++;
            i+=2;
        }
        else if (((unsigned char)bytes[i] >> 3) == 0b00011110) {
            offset-=2;
            newLength++;
            i+=3;
        }
    }
    return newLength;
}

@end 
```

查看完整的博客文章[http://bit.ly/PT9VSz](http://bit.ly/PT9VSz)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-11T10:49:16.843

我找到了另一种方法，它对我有用：

```
- (NSRange)findRealRangeForString:(NSString *)text range:(NSRange)range
{
    __block int loc = 0;
    __block int len = 0;
    [text enumerateSubstringsInRange:NSMakeRange(0, text.length) options:(NSStringEnumerationByComposedCharacterSequences) usingBlock:^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop)
     {
         if (substringRange.location < range.location)
             loc++;
         else if (substringRange.location < range.location + range.length)
             len++;
         else
             *stop = YES; 
     }];
    return NSMakeRange(loc, len);
} 
```

# c# - 例如，如何将 DbSet 变成下拉列表？

> ID：12647079
> 
> 赞同：3
> 
> 时间：2012-09-28T20:37:44.183
> 
> 标签：c#, asp.net, .net, asp.net-mvc, entity-framework

我试图把所有这些 ViewModel 的东西都包起来，并以正确的方式做事。我有几个模型通过实体框架链接到 SQL 表，比如这个：

```
[Table("HardwareOptions", Schema = "dbo")]
public class HardwareOption {
  [Key]
  public int RecordID {get; set;}
  [ForeignKey("Configuration")]
  public string Configuration {get; set;}
  public string ComputerManufacturer {get; set;}
  public string ComputerModel {get; set;}
  public string ComputerDescription {get; set;}
  public int MonitorCount {get; set;}
  public string MonitorManufacturer {get; set;}
  public string MonitorModel {get; set;}
  public string MonitorDescription {get; set;}
} 
```

我有一个这样的视图模型：

```
public class OrderIndexViewModel {
  public Customer Customer {get; set;}
  public MetaUser MetaUser {get; set;}
  public DbSet<HardwareOption> HardwareOptions {get; set;}
  public DbSet<Machine> Machines {get; set;}
  public DbSet<PendingOrder> PendingOrders {get; set;}
} 
```

我的控制器有点像这样：

```
private MyDbContext db = new MyDbContext();
OrderIndexViewModel viewmodel = new OrderIndexViewModel();
viewmodel.Customer = db.Customers.Find("myselffortesting");
viewmodel.MetaUser = db.MetaUsers.Find("myselffortesting");
viewmodel.HardwareOptions = db.HardwareOptions;
viewmodel.Machines = db.Machines;
viewmodel.PendingOrders = db.PendingOrders;
return View(viewmodel); 
```

如您所见，在我看来，我只需要有关一位客户/用户的信息，但我需要能够查询整个 HardwareOptions、Machines 和 PendingOrders 表。现在，如果我的架构完全错误，请告诉我，因为这更多是关于这个问题的。但是对于特定的东西，比如说我想从 HardwareOptions 中创建一个下拉列表。从技术上讲，我希望每个`SelectItem`人都说出几列值的字符串组合，但现在我会说我只想要一个，比如配置。这样做的正确方法是什么？我不知道如何操纵`DbSet`. 当我尝试从 中创建一个`Html.DropDownList`时`DbSet`，我得到了一个包含正确数量的项目的列表，但他们都说“mynamespace.Models.HardwareOption”。这是有道理的，我只是不知道如何正确地做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T20:52:28.353

您可以`DbSet<T>`在示例中使用 a 做的有用的事情是*投影*。您将定义第二个 ViewModel，其中包含要在下拉列表中显示的属性：

```
public class HardwareOptionViewModel
{
    public int Id { get; set; }
    public string Configuration { get; set; }
    public string AnotherProperty { get; set; }
    //...
} 
```

而不是你在`DbSet`你的使用这个 ViewModel 的集合`OrderIndexViewModel`：

```
public class OrderIndexViewModel
{
    //...
    public IEnumerable<HardwareOptionViewModel> HardwareOptions { get; set; }
    //...
} 
```

并且仅使用以下`Select`方法从数据库中加载这些属性：

```
viewmodel.HardwareOptions = db.HardwareOptions
    .Select(h => new HardwareOptionViewModel
    {
        Id = h.Id,
        Configuration = h.Configuration,
        AnotherProperty = h.AnotherProperty,
        //...
    })
    .ToList(); 
```

**编辑**

您可以将集合绑定到下拉列表，如下所示：

```
@model MyNamespace.OrderIndexViewModel

...

<div>
    @Html.DropDownListFor(model => model.CurrentHardwareOptionId,
        new SelectList(Model.HardwareOptions, "Id", "Configuration",
                       Model.CurrentHardwareOptionId))
</div> 
```

在这里，我介绍了一个与(在示例中)具有相同类型的新属性`CurrentHardwareOptionId`，它应该是下拉列表中选定的属性应该在页面回发时绑定到的属性：`OrderIndexViewModel``Id``int``Id`

```
public class OrderIndexViewModel
{
    //...

    public int CurrentHardwareOptionId { get; set; }
} 
```

# node.js - 回调在 NodeJS 中究竟是如何工作的？

> ID：12647082
> 
> 赞同：0
> 
> 时间：2012-09-28T20:37:59.377
> 
> 标签：node.js, callback, express

我有一个带有用户对象的 mongob。这是架构：

```
{
    "_id": {
        "$oid": "50658c835b821298d3000001"
    },
    "email": "admin",
    "password": "admin",
    "id": 1
} 
```

我写了一个简单的演示（只有主要部分）：

```
function findByEmail(email, callback) {
  db.collection("users", function(err, collection) {
      collection.find({}, function(err, users) {
          users.each(function(err, user) {
              if (user) {
                  if (user.email === email) {
                      //for a case, is we found user - return it
                      callback(null, user);
                  }
              }
          });
          //for a case, is we didn't find user - return null
          callback(null, null);
      });
  });
} 
```

以及测试路线：

```
app.get('/test',function(req,res){
  findByEmail("admin", function(err, user){
    res.send(user);
  })
}) 
```

启动 localhost:3000/test 后，我​​得到

```
Error: Can't set headers after they are sent. 
```

如果我评论行`callback(null, null);`，我不会收到此错误。似乎回调有效......两次！怎么会这样？我想如果我`if (user.email === email) { ... }`工作并`callback(null, user);`启动，函数`findbyEmail`返回`<user>`到`app.get`，但回调工作两次（`callback(null, null);`也），即使`if (user.email === email) { ... }`是真的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:47:24.297

您`callback(null, null)`在迭代结果后立即调用。因此，如果您有一些结果 -`callback`将被调用两次：

*   一个用于处理结果（将发送输出）
*   迭代后第二次。

`callback(null, null)`只有在没有结果的情况下才应该打电话...

```
if (!users || users.toArray().length==0) callback(null, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T06:47:55.577

让我们参考传递给 as 的函数和传递给`collection.find`as的函数（为清楚起见，我在下面的代码块中将它们标记为这样）。现在，问题是当您调用in时，循环继续运行，并且仍将继续测试结果中的所有剩余元素；此外，该函数仍未完成，将在循环完成后调用您的回调。你真的不能像我之前建议的那样在找到用户并调用之后，因为这只会终止单次迭代`outer``users.each``inner``callback(null, user)``inner``users.each``outer``callback(null, null)``users.each``return``callback(null, user)``users.each`循环并将继续处理下一个和所有剩余元素；您需要定义一个标志，指示您是否已经找到记录：

```
collection.find({}, function outer(err, users) {
    var found = false;
    users.each(function inner(err, user) {
        if (user && !found) {
            if (user.email === email) {
                //for a case, is we found user - return it
                callback(null, user);
                found = true;
            }
        }
    });
    //for a case, is we didn't find user - return null
    if (!found) {
        callback(null, null);
    }
}); 
```

*另请注意，您可以完全*在 mongo 中通过电子邮件搜索用户记录，并将整个逻辑替换为：

```
collection.find({ email: email }, function(err, users) {
    callback(null, users.length? users[0]: null);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:05:21.373

你的回调仍然被执行：

```
for ( var key in obj ) {
  foo();
}

foo(); 
```

为什么您希望不调用第二个 foo() ？

你需要做 return foo(); 如果你不想继续下去。

# javascript - jquery mobile如何在changePage后强制目标页面刷新

> ID：12647084
> 
> 赞同：1
> 
> 时间：2012-09-28T20:38:11.037
> 
> 标签：javascript, jquery, jquery-mobile

有什么办法可以在changePage 之后刷新目标页面。

我真的在搜索，但没有什么对我有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-09T01:59:21.913

这可能是您（或其他人）真正想要的：

`data-ajax="false"`

```
<a href="/" data-ajax="false">
    <img id="mainLogo" src="logo.svg" width="215" />
</a> 
```

这将绕过 ajax 行为。

> [没有 Ajax 的链接](http://demos.jquerymobile.com/1.4.2/navigation-linking-pages/)
> 
> 指向其他域或具有 rel="external"、data-ajax="false" 或 target 属性的链接将不会被 Ajax 加载。相反，这些链接将导致整个页面刷新而没有动画过渡。两个属性（rel="external" 和 data-ajax="false"）具有相同的效果，但语义不同：链接到另一个站点或域时应使用 rel="external"，而 data-ajax=" false" 对于简单地选择域中的页面不通过 Ajax 加载很有用。由于安全限制，框架总是选择链接到外部域的 Ajax 行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T06:44:39.143

尝试以下解决方案之一：

**1 -**使用`$(location).attr('href',"your_html.html");`

**例子：**

由于您使用的是单页模板，因此假设您在 2 个单独的 HTML 文件（和）中有两个 jQuery Mobile 页面（和`#page_1`）。`#page_2``page_1.html``page_2.html`

如果您想从`#page_1`(which is in `page_1.html`) 导航到`#page_2`(which is in `page_2.html`)，您可以使用：

```
$(location).attr('href',"page_2.html"); 
```

***检查下面的完整示例：***

**-** `page_1.html`：

```
<html>
    <head>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile.structure-1.1.1.min.css" />
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>

        <script>
            $(function() {
                $("#mlink").click(function() {
                    $(location).attr('href',"page_2.html");
                });

                $("#mlink_2").click(function() {
                    $(location).attr('href',"page_1.html");
                });
            });
        </script>
    </head>

    <body>
        <div id="page_1" data-role="page">
            <div data-role="content">
                PAGE 1<br>

                <!-- WHEN CLICKING ON THIS LINK, YOU'LL GO TO #page_2 in page_2.html 
                WITH PAGE REFRESH -->
                <a id="mlink">GO TO PAGE 2</a>
            </div>
        </div>
    </body>
</html> 
```

**-** `page_2.html`：

```
<html>
    <head>      
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile.structure-1.1.1.min.css" />
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>          

        <script>
            $(function() {
                $("#mlink").click(function() {
                    $(location).attr('href',"page_2.html");
                });

                $("#mlink_2").click(function() {
                    $(location).attr('href',"page_1.html");
                });
            });
        </script>
    </head>

    <body>
        <div id="page_2" data-role="page">
            <div data-role="content">
                PAGE 2<br>

                <!-- WHEN CLICKING ON THIS LINK, YOU'LL GO TO #page_1 in page_1.html 
                WITH PAGE REFRESH -->
                <a id="mlink_2">GO TO PAGE 1</a>
            </div>
        </div>          
    </body>
</html> 
```

* * *

**2 -**尝试使用`$.mobile.changePage("your_html.html", { reloadPage: true });`

考虑到前面的示例，并假设您想从 to 导航`#page_1`，`#page_2`您只需将该方法替换为`$(location).attr('href',"page_2.html");`：

```
$.mobile.changePage("page_2.html", { reloadPage: true }); 
```

有关该方法`$.mobile.changePage()`及其选项的更多信息`reloadPage`，请查看以下链接：http: [//jquerymobile.com/demos/1.1.0/docs/api/methods.html](http://jquerymobile.com/demos/1.1.0/docs/api/methods.html)

# mysql - Ruby 错误处理中的 MySQL 连接执行

> ID：12647086
> 
> 赞同：0
> 
> 时间：2012-09-28T20:38:27.623
> 
> 标签：mysql, ruby-on-rails, ruby

如何在 RoR 中使用类似的内容进行错误处理：

```
conn = Person.connection
conn.execute(sql_stmt) 
```

如果执行 SQL 时出现错误怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:34:58.550

该[`execute`方法](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/AbstractMysqlAdapter.html#method-i-execute)只是连接`query`方法的包装器，如果出现问题，它将引发`Mysql::Error`异常。如果您使用 mysql2 而不是较旧的 mysql gem，那么我认为您会遇到`Mysql2::Error`异常。

# azure - Azure 网站上的经典 ASP 站点，远程 mysql 数据库

> ID：12647089
> 
> 赞同：4
> 
> 时间：2012-09-28T20:38:52.683
> 
> 标签：azure

我已将一个经典的 asp 网站复制到新的 Azure 网站，并试图让它连接到远程 MySQL 数据库（远程未托管在 Azure 上）。我收到一条内部服务器错误消息，详细日志似乎表明我的连接字符串存在问题。

当前字符串设置如下：

```
database_string = "Driver={mySQL ODBC 5.1 Driver}; Server=server.com; Port=3306; Option=0; Socket=; Stmt=; Database=mydb; Uid=user; Pwd=password;"

and the ADODB connection is setup like such;
Set area_rec = Server.CreateObject("ADODB.Recordset")
area_rec.ActiveConnection = MM_database_STRING 
```

我很难看到具体的错误，但是如果有人可以提供一些指导，有几个问题。

1.  我假设首先支持远程数据库
2.  连接字符串是否正确？
3.  我需要设置链接资源吗
4.  如果我最终将它全部移植到 SQL Azure，那么使用 ADODB 重新设置有什么问题吗？

非常感谢您的帮助，我已经为此苦苦挣扎了一段时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T04:54:35.427

它们不支持连接到不是由它们或 ClearDB 托管的外部数据库。

在 VM 中设置您自己的 MYSQL 或使用 ClearDB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-13T16:55:45.337

天蓝色网站上的经典 asp 不支持执行此操作 - 即使清除 db，也不会安装 MYSQL ODBC 驱动程序。Azure 上的唯一方法是在 VM 中。

# xml - Qt XML 序列化/反序列化到 Q_PROPERTY

> ID：12647092
> 
> 赞同：3
> 
> 时间：2012-09-28T20:38:56.263
> 
> 标签：xml, qt, serialization, properties, qtxml

QJson ( [http://qjson.sourceforge.net](http://qjson.sourceforge.net) ) 实现了一个非常方便的 API 用于序列化和反序列化 Q_OBJECTS - 通过将 Q_PROPERTIES 转换为 qVariant，它允许对任意模型实例进行方便的序列化和反序列化。

XML有类似的东西吗？QDom* 和 QXml* 系列都相当有限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T11:30:32.223

据我所知，没有任何第三方库可以做到这一点。你有两个选择：

一个。手动编码每个对象的序列化/反序列化。这很容易。要序列化，请执行以下操作：

```
QDomElement Asset::ToXMLNode(QDomDocument& doc)
{
    QDomElement elem = doc.createElement("Asset");
    elem.setAttribute("Image", ImageName);
    elem.setAttribute("Name", Description);
    elem.setAttribute("ID", ID);
    elem.setAttribute("TargetClass", ClassType);
    elem.setAttribute("Type", TypeToString());
    QDomElement physEl = doc.createElement("Physics");
    for(int i=0;i<BodyShapes.count();i++)
    {
        physEl.appendChild(BodyShapes[i]->ToXMLNode(doc));
    }
    elem.appendChild(physEl);
    return elem;
} 
```

反序列化：

```
void Asset::Load(const QDomElement& node)
{
    ImageName =  node.attribute("Image");
    Bitmap.load(GetResourceFolder() + QDir::separator() + ImageName);
    Description =  node.attribute("Name");
    ID =  node.attribute("ID");
    ClassType =  node.attribute("TargetClass");
    QDomNodeList shapes = node.firstChildElement("Physics").childNodes();
    for(int i=0;i<shapes.count();i++)
    {
        BodyShape* s = BodyShape::Load(shapes.item(i).toElement());
        BodyShapes << s;
    }
    IsLoaded = true;
} 
```

湾。克隆 QJSON 并重写发出 JSON 字符串的部分以发出 XML 字符串，反之亦然。应该是一天的工作时间。

# jquery - 拖放时在可拖动元素处执行还原事件

> ID：12647094
> 
> 赞同：0
> 
> 时间：2012-09-28T20:38:58.863
> 
> 标签：jquery, jquery-ui, jquery-droppable

我对 jQueryUI 和可拖放/可拖放选项有疑问。

我想要完成的是：

1）将一个元素拖到另一个元素中 2）一旦元素在那里，将可拖动元素恢复到其初始状态（并做一些其他的事情）

我可以通过执行以下操作将对象恢复为其初始状态：

```
revert : function(event, ui) {
      B(this).data("draggable").originalPosition = {
          top: 0,
          left: 0
      };
      return !event;
} 
```

但我想恢复元素，即使它被拖到正确的位置......

**编辑**

我试过这个：

```
B('#template').find('section').droppable({
  drop : function(e, ui) {
    ui.draggable.triggerHandler('revert');
  }
} 
```

但它不起作用......我也试图获得该选项并执行它，但它也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:09:05.650

如果您总是想恢复，只需`return true`在您的恢复功能中

# svg - 如何在鼠标事件中确定附近的 SVG 元素？

> ID：12647101
> 
> 赞同：8
> 
> 时间：2012-09-28T20:39:39.390
> 
> 标签：svg, d3.js

我正在使用 D3 JavaScript 库来构建 SVG 图并将鼠标事件分配给它们。SVG 图可能很复杂，由许多任意路径元素组成。我一直在努力寻找一种方法来确定鼠标悬停事件中所有附近的元素。因此，例如，当鼠标光标移动到图表上时，我可以确定距离光标 N 个像素半径内的所有组件 SVG 元素。

我完全不知道如何解决这个问题。我什至不确定是否有允许我确定 SVG 组成元素是否在边界区域内的 API？

任何有关如何解决此问题的提示将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-30T03:41:04.843

前言：@Duopixel 对您的原始帖子的评论很棒——我不知道这种方法存在。但是，看起来它只支持 MSDN 文档中的矩形区域，而在鼠标周围有一个圆圈似乎更直观。

其他一些技术：

1.  如果您没有以其他方式使用笔触进行样式设置，请使用不可见的粗笔触来“扩展”您的元素，或者在元素顶部绘制一条更大的透明线条/形状。监听这些元素的“点击”事件。

2.  将每个元素与鼠标点击半径进行成对比较。我在这里做了一个例子：http: [//jsfiddle.net/AkPN2/5/](http://jsfiddle.net/AkPN2/5/)。我只实现了圆形，因为它们很简单——您需要为矩形添加几何图形。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-05T15:30:59.523

我最终使用了 DuoPixel 建议的 SVGEdit 中的方法。它使用 svgcanvas.js 中定义的其他 SVGEdit 方法，因此它并不是真正意义上的独立。这是评论中建议的 DuoPixel 方法的工作链接： [https ://github.com/duopixel/Method-Draw/blob/master/method-draw/src/svgcanvas.js#L600](https://github.com/duopixel/Method-Draw/blob/master/method-draw/src/svgcanvas.js#L600)

如果链接发生变化，具体实现如下：

```
// This method sends back an array or a NodeList full of elements that
// intersect the multi-select rubber-band-box on the current_layer only.
//
// Since the only browser that supports the SVG DOM getIntersectionList is Opera,
// we need to provide an implementation here. We brute-force it for now.
//
// Reference:
// Firefox does not implement getIntersectionList(), see https://bugzilla.mozilla.org/show_bug.cgi?id=501421
// Webkit does not implement getIntersectionList(), see https://bugs.webkit.org/show_bug.cgi?id=11274
var getIntersectionList = this.getIntersectionList = function(rect) {
if (rubberBox == null) { return null; }
var parent = current_group || getCurrentDrawing().getCurrentLayer();
if(!curBBoxes.length) {
// Cache all bboxes
curBBoxes = getVisibleElementsAndBBoxes(parent);
}
var resultList = null;
try {
resultList = parent.getIntersectionList(rect, null);
} catch(e) { }
if (resultList == null || typeof(resultList.item) != "function") {
resultList = [];
if(!rect) {
var rubberBBox = rubberBox.getBBox();
var bb = {};
for(var o in rubberBBox) {
bb[o] = rubberBBox[o] / current_zoom;
}
rubberBBox = bb;
} else {
var rubberBBox = rect;
}
var i = curBBoxes.length;
while (i--) {
if(!rubberBBox.width || !rubberBBox.width) continue;
if (svgedit.math.rectsIntersect(rubberBBox, curBBoxes[i].bbox)) {
resultList.push(curBBoxes[i].elem);
}
}
}
// addToSelection expects an array, but it's ok to pass a NodeList
// because using square-bracket notation is allowed:
// http://www.w3.org/TR/DOM-Level-2-Core/ecma-script-binding.html
return resultList;
}; 
```

# ruby-on-rails - 从字符串中提取某些字符空格

> ID：12647106
> 
> 赞同：1
> 
> 时间：2012-09-28T20:40:18.637
> 
> 标签：ruby-on-rails, ruby-on-rails-3, string, extract

所以很难弄清楚这个主要是因为我不知道正确的术语。我想根据它们在字符串中的位置从字符串中打印某些字符。

例子。假设我有一个从 RoR 打印的字符串 2012-08-18。现在，我想要做的实际上只是打印出最后两个字符，在本例中为 18。我总是想打印最后两个字符，因为它们将永远是一天。

想法？

这是我当前需要添加的代码：

```
<%= event.start_date %> 
```

打印出来

```
2012-08-18 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:43:28.280

如果你在 Rails 中，你可以这样做：

```
s = '2012-08-18'
s.last(2) # => "18" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:45:18.917

如果你只想要天数，你应该使用方法“strftime”

[在此处查看 Rubyonrails.org 上的文档](http://corelib.rubyonrails.org/classes/Time.html#M000264)

在你的情况下，你可以使用这个：

```
<%= event.start_date.strftime("%d") %> # Will print the day of the month (01..31) 
```

希望这可以帮助！

# expression - 需要一个正则表达式（不时）asp.net中的文本框

> ID：12647107
> 
> 赞同：-4
> 
> 时间：2012-09-28T20:40:18.360
> 
> 标签：expression

需要 asp.net 中的文本框的正则表达式（我使用 vb.net 作为后面的代码）

hh:mm 上午/下午 - hh:mm 上午/下午

下午 2:30 - 下午 3:45

我想为此进行掩码编辑，以便用户知道格式。

hh:mm 上午/下午 - hh:mm 上午/下午

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:43:37.170

```
am|pm 
```

将匹配`am`或`pm`。

```
0?\d|1[0-2] 
```

将匹配一个小时。

```
[0-5]\d|60 
```

将匹配一分钟。

把它们放在一起：

```
^(0?\d|1[0-2]):([0-5]\d|60) (am|pm) - (0?\d|1[0-2]):([0-5]\d|60) (am|pm)$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:51:49.613

完全取决于您要实现的目标，约束是什么以及您使用的语言，但这可能会有所帮助：

```
/[0-9][0-9]?:[0-9][0-9] [ap]m - [0-9][0-9]?:[0-9][0-9] [ap]m/g 
```

可以在这里玩更多：[http ://refiddle.com/7u0](http://refiddle.com/7u0)

# javascript - 检查是否点击了特定的标签

> ID：12647115
> 
> 赞同：2
> 
> 时间：2012-09-28T20:41:13.040
> 
> 标签：javascript, jquery

我怎样才能做到这一点：

```
var izbor = $('.kategorija_izbor ul a'),
    mgl = $(".mali_oglasi"),
    pretraga = $('.mali_oglas a[role=pretraga]'),
    article = $('.mali_oglasi article'),
    mgl_wrapper = $('.mali_oglasi_wrapper');

(pretraga || izbor).on('click', function(e) {
    var id = $(this).attr('href').split('/'),
        mgl_space = $(this).attr('href').replace(/\s+/g, '-').toLowerCase();
    link = mgl_space + ' .mali_oglasi';
    mgl.animate({
        'opacity': 0
    }, 400, function() {
        mgl_wrapper.load(link, function() {
            mgl.animate({
                'opacity': 1
            }, 400);
        });
    });
    e.preventDefault();
});​ 
```

我需要查看是否按下了**pretraga**或**izbor**。这种方式行不通。有没有办法让它发生？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:46:56.357

`or`运算符不能用于引用两个变量实例。

您想要做的是将函数绑定到多个`jQuery`对象：

```
$('.kategorija_izbor ul a, .mali_oglas a[role=pretraga]').on('click',
    function(e) {
        var id = $(this).attr('href').split('/'),
            mgl_space = $(this).attr('href').replace(/\s+/g, '-').toLowerCase();
        link = mgl_space + ' .mali_oglasi';
        mgl.animate({
            'opacity': 0
        }, 400, function() {
            mgl_wrapper.load(link, function() {
                mgl.animate({
                    'opacity': 1
                }, 400);
            });
        });
        e.preventDefault();
    });​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:45:13.613

`$('.mali_oglas a[role=pretraga], .kategorija_izbor ul a').on(...`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:54:37.820

使用 jQuery 的 parentsUntil 函数。[http://api.jquery.com/parentsUntil/](http://api.jquery.com/parentsUntil/)

所以你可以在你的点击函数中看到，这两个元素中的哪一个被点击了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T20:48:41.907

我修改了您的代码，您可以`isPretraga` 在 click 函数中使用变量来检查是否`pretraga`点击。

```
var izbor = $('.kategorija_izbor ul a'),
    mgl = $(".mali_oglasi"),
    pretraga = $('.mali_oglas a[role=pretraga]'),
    article = $('.mali_oglasi article'),
    mgl_wrapper = $('.mali_oglasi_wrapper');

$('.mali_oglas a[role=pretraga], .kategorija_izbor ul a').on('click', function(e) {
    var id = $(this).attr('href').split('/'),
        mgl_space = $(this).attr('href').replace(/\s+/g, '-').toLowerCase();
    var isPretraga = $(this).attr('role') == 'pretraga';
    link = mgl_space + ' .mali_oglasi';
    mgl.animate({
        'opacity': 0
    }, 400, function() {
        mgl_wrapper.load(link, function() {
            mgl.animate({
                'opacity': 1
            }, 400);
        });
    });
    e.preventDefault();
});​ 
```

# ms-word - Office-Word 找出从另一台计算机复制的文件的原始创建日期，有可能吗？

> ID：12647116
> 
> 赞同：0
> 
> 时间：2012-09-28T20:41:20.683
> 
> 标签：ms-word, ms-office

我怎样才能找出一个 word 文件的原始创建日期，尤其是当文档是从另一台计算机复制时？（因为在属性文件夹中它显示了复制的日期）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:58:34.053

您必须在传输文件之前对其进行存档以保留其原始创建日期，因为文件系统有责任对此进行跟踪。因此，文件很少会费心存储这些信息。所以 zip tar 或 rar 它。

# javascript - 查找和替换 Javascript 需要从 excel 工作表中提取值、循环并输出

> ID：12647117
> 
> 赞同：0
> 
> 时间：2012-09-28T20:41:22.783
> 
> 标签：javascript, excel

我有一个脚本可以替换句子中的多个单词。

这是当前脚本：http:
[//jsfiddle.net/2z3b4/](http://jsfiddle.net/2z3b4/)

我想更进一步，并能够遍历 Excel 表中的替换单词列表。句子会改变几个单词，所以理想情况下我需要从多个列中提取单词

即要替换的word1 = 列A1 要替换的word2 = 列B1

然后它将开始移动到下一列

```
 word1 to be replaced = column A2
 word2 to be replaced = column B2 
```

在它提取并替换这些值之后，我希望它在页面上返回输出。

a.) 我将如何从 Excel 工作表中提取值？
b.) 如何让 excel 表循环遍历所有列，然后在完成时停止？
c.) 如何在单独的页面上返回输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:47:43.453

如果您需要从 Excel 工作表中获取值，认为您需要考虑使用与 Javascript 不同的语言 - 也许在 Excel 中使用 VBA？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T09:33:26.590

您实际上可以使用 javascript 来执行此操作。只要它是 excel 2007+ 文档，这并不难。只是很多步骤和模棱两可。如果是 2003 或更低版本，您可能会遇到一些问题，因为我不确定是否有任何 JS 库可以真正帮助读取二进制文件。反正...

获取[jszip](https://github.com/Stuk/jszip)。这使您可以解压缩 Excel 2007+ 文件（实际上，Excel 2007+ 文件包含的所有内容都是一堆 XML 文件）

如果您不关心 IE，并且希望您的客户端浏览器是最新的，您可以使用 FileReader api（查看[http://caniuse.com/#feat=filereader](http://caniuse.com/#feat=filereader)）。如果您确实关心 IE，我敢肯定有一个 flash 项目可以读取文件的内容并通过 externalInterface 将其发送到 javascript。或者你可以自己装。或者，也许您可​​以在 iframe 中“上传”文件并有一个“echo”，只需打印出 base64 编码文件的内容，然后您可以将其泵入 jszip。

一旦你能够读取文件的内容，使用 jszip 打开文件内容，可能使用`new JSZip(zipDataBinary, {base64:false});`

由于您只是替换文本，因此您很可能只关注 sharedStrings.xml 文件。

```
zipFile = new JSZip(zipDataBinary, {base64:false});
var sharedStringFile= zipFile.file(/sharedStrings\.xml/); 
```

现在，轻松-

```
var newData = sharedStringFile.asText().replace(/* and all the stuff you want replaced, or in a loop, or whatever.. */); 
```

这里要注意的重要一点是，Excel 2007+ 文件中的每个字符串都保存在这个 sharedStrings.xml 文件中——他们做了一些工作来尝试优化 excel 文件的大小，字符串数据是最重要的数据之一电子表格中通常重复的数据片段。所以，如果你有一个单元格 A1 有“这是一个单元格！”，它实际上表示为

```
<c r="A1" t="s">
    <v>1</v>
</c> 
```

'1' 是 sharedStrings.xml 文件中字符串的索引。无论如何..

完成后，

```
zipFile.file(sharedStringFile.name, newData); 
```

这将更新 zip 文件的内容。现在您可以使用某种“echo”机制将其发送到服务器，或者使用“Downloadify”允许用户下载它。或者，如果您想实际阅读并在页面上显示它，您可以......它只是涉及更多。

像这样打包 zip 文件：

```
var sendThisDataSomewhere = zipFile.generate({base64: false}); 
```

作为一个无耻的插件，我从我一直在从事的项目中发现了这一切 - [http://excelbuilderjs.com/](http://excelbuilderjs.com/)

# javascript - 什么类型的架构是backbone.js？

> ID：12647118
> 
> 赞同：0
> 
> 时间：2012-09-28T20:41:23.197
> 
> 标签：javascript, backbone.js

在本[教程](http://arturadib.com/hello-backbonejs/docs/3.html)中，我看到他们从模型中调用视图中的 3 个。

在我见过的所有图表中，都应该有一个控制器来调解这种交互。

我没有抱怨，但他们是否违反了严格的 MVC 模式？

就跟踪依赖而言，控制器应该依赖于模型和视图。

模型和视图应该相互独立并且独立于控制器。

Backbone 是否打破了 MVC 模式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T20:51:43.900

无论如何，Backbone 都不是 MVC。视图充当了一个控制器，破坏了 MVC 关注点分离的目的。

此外，（视图/控制器）包含在严格的 MVC 中将保留在模型中的逻辑。

**从常见问题解答** [http://backbonejs.org/#FAQ-mvc](http://backbonejs.org/#FAQ-mvc)

> Backbone 与“传统”MVC 有何关系？模型-视图-控制器模式的不同实现往往对控制器的定义存在分歧。如果有帮助的话，在 Backbone 中，View 类也可以被认为是一种控制器，调度源自 UI 的事件，而 HTML 模板作为真正的视图。我们称它为 View 是因为它代表 UI 的逻辑块，负责单个 DOM 元素的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T16:26:44.497

对不起，Hiro，但我不得不不同意你的看法。Backbone.js 可以非常 MVC，但这完全取决于您如何实现它。问题是大多数的backbone.js 示例只显示视图事件绑定到该视图中的方法，但是有两种方法可以绕过这个来完成MVC 模式。

第一个是简单地将视图中的所有事件/按钮替换为路由器可以轻松获取的 hashbang URL 链接，或者您可以让您的事件方法定义调用控制器中的适当方法并传递参数。

正如 ertume 所说，你永远不应该从模型中调用视图。

# objective-c - 如何在更改文本字段文本时更改标签文本

> ID：12647123
> 
> 赞同：0
> 
> 时间：2012-09-28T20:41:44.787
> 
> 标签：objective-c, ios, ios4

我正在制作一个非常简单的 iphone 项目，但我遇到了 2 个问题：

1-我想让一个应用程序在你输入时输入你的名字，所以我希望它在我输入任何我绑定使用`while`但它失败并崩溃的字母时立即输入

2-当我输入长名称时，它显示（...）如何使它显示在多行中

这就是我的代码

```
@synthesize textField,label;

-(IBAction)changeName:(id)sender{

    label.text=textField.text;
    while (label.text != textField.text){
        label.text=textField.text;
    }
    [sender resignFirstResponder];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:45:39.227

让你的视图遵守[`UITextFieldDelegate`协议](https://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)，然后实现方法：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string 
```

并使用类似的东西：

```
label.text = [textField.text stringByReplacingCharactersInRange:range withString:string]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:47:18.513

对于第二个问题，将 UILabel 的 numberOfLines 属性值更改为 0。

请注意，在您的解决方案中，您正在检查字符串身份而不是相等性。所以你应该使用
`![label.text isEqualToString:textField.text]`

代替
`label.text != textField.text;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T10:32:58.223

这样做，这将使您的标签设置为您在 TextField 中键入的内容。

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text{

UILabel *lbl_YORLabel ;
lbl_YORLabel.lineBreakMode = UILineBreakModeCharacterWrap;

CGSize size = [textView.text sizeWithFont:[UIFont systemFontOfSize:12] constrainedToSize:CGSizeMake(320, 1000) lineBreakMode:UILineBreakModeWordWrap];

// Now set the Frame size of the label and text.
CGRect _frame = lbl_YORLabel.frame;
_frame.size.height = size.height;
lbl_YORLabel.frame = _frame;

// Set text to the label
lbl_YORLabel.text = textView.text;

return YES;
} 
```

# c++ - 错误 RC2104：未定义的关键字或键名：DS_SETFONT

> ID：12647130
> 
> 赞同：3
> 
> 时间：2012-09-28T20:42:32.537
> 
> 标签：c++

我开始了解 Windows API。所以我打开了 Microsoft Visual C++ 并创建了一个新项目。我选择了 Win32 项目，它启动了。然后我在输入任何内容之前单击了构建并运行，我想出了这个错误：

```
error RC2104: undefined keyword or key name: DS_SETFONT.... 
```

该错误告诉我它在我无法编辑的 Windows 资源文件中。我在网上查了一下，找不到关于这个话题的任何东西。

我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-22T06:29:03.397

生成解决方案时，它会删除`#include <windows.h>`.

只需添加即可`#include <windows.h>`修复它。

就我而言，我将它添加到 *.rc 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-26T09:27:58.507

对于遇到此问题的其他人：我的问题似乎源于我正在处理一个旧项目，其中资源文件未在 Visual Studio 中生成，并且正常的向导设置尚未完成。

我试图向定义菜单等的 MYAPP.RC 文件添加/更改控件，但收到错误“RC2104 未定义关键字或键名：DS_SETFONT”。这是因为符号指令需要标头 #include "windows.h"

我想通了这一点，并将 #include "windows.h" 添加到 resource.h 文件中。问题是 MYAPP.RC 和 resource.h 文件都是自动生成的，并且任何手动插入的 #include "windows.h" 每次都会被转储。

这个[Microsoft 帮助](https://docs.microsoft.com/en-us/cpp/mfc/tn035-using-multiple-resource-files-and-header-files-with-visual-cpp?view=msvc-160#_mfcnotes_tn035_set_includes)页面让我直截了当，我转到资源视图 -> 资源包含 -> 只读符号指令窗口并插入：# include "windows.h"

现在可以编辑资源没问题。

# php - simplexml_load_file 结果问题

> ID：12647133
> 
> 赞同：0
> 
> 时间：2012-09-28T20:42:37.060
> 
> 标签：php

我是 PHP 新手，我正在尝试读取驻留在本地机器上的文件夹中的 XML 文件的输出。在 PHP.net/simplexml_load_file 教程中，当我执行 print_r($xml) 时，以下 LIKE 代码应显示 SimpleXMLElement 对象。但是当我在本地终端上运行脚本时，我得到了文件路径：

/Users/msavoy/XMLSourceDir/sfly-6x8.000020513524-7001536_28935-tb.33.xml

我需要能够获取 $xml 对象，以便可以显示对象中的所有元素。

这是我的代码：

```
// Get the correct count of the values in the $sourceXmlDir after the unset function completes
$sourceXmlArray = array_values($sourceXmlDir);
$count_xml_files = count($sourceXmlArray);

// Check to ensure that there are xml files in the directory before processing parsing the file
// If no files exist create an Exception and log the error.
if ($count_xml_files > 0) {

    // Cycle through the XML files in the $sourceXmlArray
    for ($i = 0; $i < $count_xml_files; $i++) {

        $xml = ($sourceDir . '/' . $sourceXmlArray[$i]);

        print_r($xml);
    }
} else {
    $error_output = date('Y-m-d H:i:s') . 'There are no XML files in the source directory: ' . $sourceDir;
    error_log(date('Y-m-d H:i:s') . 'There are no XML files in the source directory: ' . $sourceDir);
    throw new Exception($error_output);
} 
```

我错过了什么？任何帮助/方向将不胜感激。问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:47:07.793

```
$xml = ($sourceDir . '/' . $sourceXmlArray[$i]);

print_r($xml); 
```

你实际上并没有打电话`simplexml_load_file`，那为什么会`$xml`是一个`SimpleXMLElement`对象？

试试这个：

```
$xml = simplexml_load_file($sourceDir . '/' . $sourceXmlArray[$i]);

print_r($xml); 
```

# javascript - jQuery：从样式定义的位置动画到类定义的位置

> ID：12647134
> 
> 赞同：0
> 
> 时间：2012-09-28T20:42:38.403
> 
> 标签：javascript, jquery, jquery-ui, jquery-animate

我在页面上有一些简单的拖放功能，您可以将一个元素拖放到目标区域，该元素将捕捉到目标区域内的指定位置。目前，我正在使用“drop”事件处理程序来完成此操作，该处理程序向具有正确位置的元素添加一个类，然后删除 jQuery 定义的位置样式（在拖动时定位元素）。因此，元素被移动到正确的位置。

但是，我想给元素一个漂亮的动画，让它从你放下它的地方移动，而不是让它立即出现在新的地方。问题是 jquery 允许我从一种样式动画到另一种样式，或者从一个类到另一个类，但不能从一种样式动画到一个类。我试过这样做：

```
feature.addClass('selected');
feature.animate({
    'top': '',
    'left': '',
    'bottom': '',
    'right': ''
}); 
```

其中“选定”包含顶部和左侧的定义。但是这样做是将元素移动到 0,0（而不是动画删除我想要的样式的过程）。

有谁知道我该怎么做？我可以将坐标存储在元素数据中，但我希望它们在 CSS 中定义。或者，有没有一种方法可以使用 Javascript 从 CSS 中读取所选位置并动态存储它？即找出“对于这个元素，如果我要添加选定的类，top 和 left 的值是多少”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:49:46.547

我假设由于您使用的是 jQuery，因此您正在使用 jQuery UI 来执行拖放功能。$.draggable() 方法有一个选项，如下所示：

```
$( "#draggable" ).draggable({ revert: true }); 
```

更多信息来自这里：http: [//jqueryui.com/demos/draggable/#revert](http://jqueryui.com/demos/draggable/#revert)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:19:02.100

感谢@Huangism的想法，我让它像这样工作：

*   创建了一个不可见的“位置测试器”div
*   在初始化期间，将每个可拖动元素的类复制到该 div，并使用它来测试它们将被拖放到的位置
*   将这些位置存储在可拖动元素中
*   然后，在放置处理程序中，我将元素的样式更新为那些存储的位置，允许我对其进行动画处理

# .net - 没有使用 DataContractSerializer 从 XML 根目录中删除命名空间

> ID：12647135
> 
> 赞同：1
> 
> 时间：2012-09-28T20:42:39.780
> 
> 标签：.net, xml, namespaces, xml-serialization, datacontractserializer

有谁知道为什么在数据合同序列化期间仍将命名空间添加到根目录？

**XML**：

```
<Response xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
  <Event>
    <Address>
      .
      .
      .
</Response> 
```

**代码：**

```
[DataContract(Name = "Response", Namespace = "")]
public class ApiEventResponse
{
    [DataMember(EmitDefaultValue = false)]
    public ApiEvent Event { get; set; }
}

var serializer = new DataContractSerializer(type, "Response", "");

return Task.Factory.StartNew(() =>
  {
      using (var xmlw = new XmlTextWriter(writeStream, Encoding))
      {
          xmlw.Formatting = Formatting.Indented;
          serializer.WriteObject(xmlw, value);
      }
  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:36:51.330

无论使用什么数据协定或实际命名空间，似乎都会发出 XMLSchema-instance 命名空间。XMLSchema-instance 命名空间前缀实际上并未在您的示例中使用，它只是被声明了。

序列化程序可能只是始终发出该名称空间，以防它以后发现需要在序列化数据时引用 XMLSchema 的情况。

# jquery - 未定义变量问题

> ID：12647138
> 
> 赞同：0
> 
> 时间：2012-09-28T20:42:49.997
> 
> 标签：jquery

我在声明一个变量时遇到了麻烦。

我有

```
function employees(){
   //init employees...;
}

employees.prototype.getName=function(){
            if(ajax.doingStuff){
                return;
            }               
        } 

$(document).ready(function(){
     var ajax=new ajaxCall();
     var people=new employees();   

     $('#option').on('change', function(){
                people.getName();                
       })        

}) 
```

当我点击`$('#option)`按钮时，我得到了

```
Uncaught ReferenceError: ajax is not defined 
```

谁能帮我解决这个问题？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:45:52.283

你有一个范围问题。该`ajax`变量仅在`ready`函数内可用。您要么需要将`ajax`变量移出`ready`函数，要么将使用它的代码移入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T20:46:15.327

您的变量`ajax`只存在于传递给`ready()`. 如果您想在别处使用它，您要么必须传递对该对象的引用（例如，`ajax`作为`getName`函数的参数传入），要么将所有代码移动到同一范围。

例如：

```
var ajax=new ajaxCall(); 
```

可以移动到全局范围，或者：

```
function employees(){
   //init employees...;
} 
```

可以移动到就绪函数中。

# combobox - 为什么在做出选择之前不应用我的 javafx 组合框按钮单元格渲染器？

> ID：12647139
> 
> 赞同：2
> 
> 时间：2012-09-28T20:42:56.090
> 
> 标签：combobox, cell, javafx, renderer

我正在扩展 ComboBox 并尝试自定义按钮图形，使其根据是否选择了列表中的项目来显示选中/未选中状态。默认情况下没有选择任何值，所以它只是显示提示文本，我*希望*它显示“未选中”图形，但在用户选择一个值之前，我似乎无法显示任何类型的图形，哪种方式违背了拥有图形的目的......

```
public class ComponentComboBox extends ComboBox<String> {

    String promptText;
    boolean promptAsPrefix = true; // keeps the prompt as a prefix to the selected item
    final ImageView checked = new ImageView( new Image( Main.actions.getClass().getResourceAsStream( "res/checked.png" ) ) );
    final ImageView unchecked = new ImageView( new Image( Main.actions.getClass().getResourceAsStream( "res/unchecked.png" ) ) );

    public ComponentComboBox( String promptText, boolean promptAsPrefix, int maxWidth ) {
        init( promptText, promptAsPrefix, maxWidth );
    }

    private void init( final String promptText, final boolean promptAsPrefix, int maxWidth ) {
        this.promptText = promptText;
        this.promptAsPrefix = promptAsPrefix;
        setPromptText( promptText );
        setMaxWidth( maxWidth );
        setPrefWidth( maxWidth );
        Callback<ListView<String>,ListCell<String>> cb = new Callback<ListView<String>,ListCell<String>>() {
            @Override public ListCell<String> call( ListView<String> p ) {
                ListCell<String> ret = new ListCell<String>() {
                    @Override protected void updateItem( String item, boolean empty ) {
                        super.updateItem( item, empty );
                        if ( item == null || empty ) {
                            setGraphic( unchecked );
                        } 
                        else {
                            setGraphic( checked );
                            if ( promptAsPrefix ) {
                                setText( promptText + " " + item );
                            }
                        }
                    }
                };
                ret.setGraphic( unchecked );
                return ret;
            }
        };
        setButtonCell( cb.call( null ) );
    }
} 
```

当没有选择任何值时，甚至可以显示自定义图形吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-08T12:59:12.033

以下对我有用：

```
setButtonCell( cb.call( null ) );
Platform.runLater(new Runnable() {
        @Override
        public void run() {
            getButtonCell().updateIndex(0);
        }
    }); 
```

# adt - 在 Eclipse Juno 上安装了 ADT，但无法创建 Android 项目（仅限 32 位）

> ID：12647147
> 
> 赞同：0
> 
> 时间：2012-09-28T20:43:29.290
> 
> 标签：adt, eclipse-juno

我有两台机器，一台 64 位机器和一台 32 位机器，都运行 Win7。我在这两个上都遵循了这些步骤：

1.  将 Eclipse 解压缩到一个目录。
2.  以管理员模式运行 Eclipse。
3.  选择帮助/安装新软件
4.  单击添加按钮
5.  输入以下位置：[https ://dl-ssl.google.com/android/eclipse/](https://dl-ssl.google.com/android/eclipse/)
6.  输入以下名称：ADT 插件
7.  选定的“开发者工具”
8.  安装包。
9.  允许 Eclipse 重新启动。

两种情况都没有错误。

在我的 64 位机器上，我现在可以创建新的 android 项目，我在 Window/Preferences... 下看到了 Android 选项，在 help/about 中我看到了许多 android 选项。

在我的 32 位机器上，我看不到这些东西。我确实看到已安装的软件包（帮助/关于），但不是插件（帮助/关于的插件选项卡）。

当我在 32 位机器上启动 Eclipse 时，错误日志中列出了一些错误。像这样的事情：

> java.io.IOException：无法解析插件“平台：/plugin/com.android.ide.eclipse.adt/icons/android_file.png”。在 org.eclipse.core.internal.runtime.PlatformURLPluginConnection.parse(PlatformURLPluginConnection.java:64) 在 org.eclipse.core.internal.runtime.PlatformURLPluginConnection.resolve(PlatformURLPluginConnection.java:75) 在 org.eclipse.core.internal .boot.PlatformURLHandler.openConnection(PlatformURLHandler.java:67) at org.eclipse.osgi.framework.internal.protocol.URLStreamHandlerProxy.openConnection(URLStreamHandlerProxy.java:112) at java.net.URL.openConnection(Unknown Source) at org .eclipse.core.internal.runtime.PlatformURLConverter.toFileURL(PlatformURLConverter.java:33) 在 org.eclipse.core.runtime.FileLocator.toFileURL(FileLocator.java:206) 在 org.eclipse.jface.resource。

我也尝试使用下载的存档。(ADT-20.0.3.zip) 这在 64 位机器上工作正常，但在 32 位机器上安装失败，并出现以下错误：

> 无法完成安装，因为找不到一项或多项所需项目。正在安装的软件：Android 开发工具 20.0.3.v201208082019-427395 (com.android.ide.eclipse.adt.feature.group 20.0.3.v201208082019-427395) 缺少要求：Android 开发工具 20.0.3.v201208082019-427395 ( com.android.ide.eclipse.adt.feature.group 20.0.3.v201208082019-427395) 需要 'org.eclipse.wst.sse.core 0.0.0' 但找不到

这是一个与此类似的问题（带有不同的错误消息），但我检查过，这里发布的解决方案对我不起作用。 [我安装了Eclipse ADT，没有任何错误信息，但是重启后，我看不到任何Android插件](https://stackoverflow.com/questions/11494117/i-installed-eclipse-adt-without-any-error-message-but-after-rebooting-i-cant)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-11T11:01:10.707

以非管理员模式运行 Eclipse。

在管理员模式下运行给我带来了很多麻烦。当我在非管理员模式下再次启动 Eclipse 时，会弹出一个迁移向导快速修复所有内容（最后重新启动 Eclipse）。

# actionscript-3 - Actionscript - 如何在 Windows 中测试触摸事件

> ID：12647150
> 
> 赞同：0
> 
> 时间：2012-09-28T20:43:42.773
> 
> 标签：actionscript-3, flash, actionscript, air, touch

我在 Actionscript (Adobe Air) 上编码并尝试在 Windows 7 上测试触摸事件，但它似乎不起作用。我该如何测试它？

```
this.stage.addEventListener(TransformGestureEvent.GESTURE_SWIPE, onSwipe);

private function onSwipe(e:TransformGestureEvent):void
{
    trace('touch swipe! ' + e.offsetX);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:20:43.573

我很确定你不能在 Windows 上做到这一点。至少我从来都做不到。

*PressAndTapGestureEvent 类允许您在支持触摸的设备上处理按下并点击手势。*

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/PressAndTapGestureEvent.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/PressAndTapGestureEvent.html)

在您的手机/平板电脑上进行测试。

# breeze - 结果 js 与微风 js

> ID：12647151
> 
> 赞同：8
> 
> 时间：2012-09-28T20:43:45.793
> 
> 标签：breeze, single-page-application, upshot

upshot js 是否正在积极开发中？upshot的文章都是2012年3月写的，upshot js稳定吗？Breeze 似乎正在积极开发中。

准备好生产了吗？添加了 vs spa 应用程序模板，后来又删除了。什么时候会重新添加？我猜它会用结果重新添加，因为结果与 ms 相关联。

```
public class TodosController : ApiController {

    readonly EFContextProvider<TodosContext> contextProvider = 
        new EFContextProvider<TodosContext>("TodosContext");

    // ~/api/todos/Metadata 
    [AcceptVerbs("GET")]
    public string Metadata() {
        return contextProvider.Metadata();
    }

    // ~/api/todos/Todos
    // ~/api/todos/Todos?$filter=IsArchived%20eq%20false&$orderby=CreatedAt 
    [AcceptVerbs("GET")]
    public IQueryable<TodoItem> Todos() {
        return contextProvider.Context.Todos;
    }

    // ~/api/todos/SaveChanges
    [AcceptVerbs("POST")]
    public SaveResult SaveChanges(JArray saveBundle) {
        return contextProvider.SaveChanges(saveBundle);
    }

    // other miscellaneous actions of no interest to us here
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-09T06:08:19.813

根据最新的路线图，结果已经死了：[ASP.NET Webstack Roadmap](http://aspnetwebstack.codeplex.com/wikipage?title=Roadmap)

我想现在，[微风](http://www.breezejs.com/home)就是它。我希望他们添加的样本比经典的 ToDo 更大，这样我们就可以看到它的真正能力。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-02T00:39:27.030

Clive - 我看到您发布了 Breeze Todo 示例中的 Web API 控制器的快照。很高兴你在看它。

多年来没有人听说过结果。它可能已经死了，也可能只是奄奄一息，有朝一日有复活的机会。在任何实际意义上，它肯定不是“活着的”。

另一方面，Breeze 正在积极开发中。高温高压

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-02T11:18:54.627

我们在一个相当大的项目中广泛使用了结果（至少半年），在一些严重的问题之后我们决定放弃它——在我看来它还**没有**准备好用于生产，除非你的应用程序非常简单（因此示例 todo 应用程序和交付跟踪器示例）。

哎呀，他们最后一次有意义的提交是半年前（2012 年初），代码很大、很复杂，并且充满了“NYI”（尚未实现）注释。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T23:45:46.967

胡安很到位。结果死了。

“今年早些时候，Visual Studio 2012 的 Beta 版包含一个模板，该模板旨在使用 Upshot.js 和一个特殊的基于 Web API 的 DataController 构建“单页应用程序”，该数据控制器支持使用该单元进行插入、更新和删除操作支持事务的工作模式。我们目前没有继续开发该模板或 Upshot.js。我们希望首先专注于改善现有流行 JavaScript 库的开发体验，在未来的版本中，我们将重新审视这个决定，看看是否有其他库需要完善 SPA 体验。”

Colin Blair 在[RIA 服务博客上发表了他的想法 WCF RIA 服务已死，WCF RIA 服务万岁](http://www.riaservicesblog.net/Blog/post/WCF-RIA-Services-is-Dead-Long-Live-WCF-RIA-Services.aspx)。

# svn - SVN 文件夹不能合并到自身或从它分支的任何东西

> ID：12647152
> 
> 赞同：1
> 
> 时间：2012-09-28T20:44:17.063
> 
> 标签：svn

我在 SVN 中有一个似乎存在身份危机的文件夹。我可以检查它并对其进行分支，但是任何合并都会失败。

```
svn co http://svn/myrepo
cd myrepo
svn merge . 
```

以上产生了这样的东西（缩写）：

```
--- Merging r33050 through r36572 into '.':
   C Gemfile.lock
   C test_source/src/...
Skipped missing target: 'test_source/libs'
 G   test_source/src
 G   test_source
Skipped missing target: 'source/Rakefile'
Skipped missing target: 'source/Gemfile'
Skipped missing target: 'source/libs'
Skipped missing target: 'source/Gemfile.lock'
   C source/src/...
 G   source
   C Rakefile
   C Gemfile
 G   .
Summary of conflicts:
  Tree conflicts: 26
  Skipped paths: 5 
```

同样，如果我从这个文件夹分支`svn cp http://svn/myrepo http://svn/myrepo2`，那么分支同样不能合并到它自己，主干也不能合并到它，反之亦然。

话虽如此，`svn up`仍然可以正常工作。

我觉得我在这段历史上一定做了坏事。有什么办法可以修复这个或我可以进一步调查的任何地方吗？如果可以避免的话，我宁愿不导出/导入。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T11:20:56.843

虽然我同意这里所有评论者的观点，你所做的合并命令没有任何意义，但我想仔细看看。所以我也尝试了自己，完全没有得到你描述的结果。

对我来说，结帐后的那个命令`svn merge .`根本没有任何作用——除了例外。现在我想知道在您的案例中合并的这些更改来自哪里。您的示例中有一些奇怪的地方。

*如果*您真的一个接一个地执行了这三个步骤（结帐、cd、合并），那么*通常*没有可合并的更改。那么这两个版本 r33050 和 r36572 是从哪里来的呢？`svn merge`使用三个位置：两个“源”位置，谁的差异（修订）被合并到第三个，“目标”位置。该语法实际上允许省略单独目标的显式规范。但是，源和目标之间不能有任何差异，*除非*同时派生签出位置的存储库状态发生了变化。在*这种*情况下，您引用的输出是预期的，但您肯定会说如果在您的检出和合并尝试之间提交了 3500 个修订。

因此，您的设置中必须有一些不同的东西。您真的可以排除存储库在签出和合并之间发生变化的可能性吗？也许存储库不是由您维护的？也许一些备份刚刚通过导入所有修订重新加载？或者，位置可能已经在两者之间移动了？这些东西将解释输出，如果不是详细的话，那么至少在一般情况下。

在存储库方面没有任何更改，我得到了人们所期望的：

```
$> svn co https://.../[...]
$> cd [...]
$> svn merge . 
$> 
```

我的结论：其中之一：

*   您的结帐和合并之间的存储库已更改。
*   您的存储库在内部使用了一些不受支持的网络，例如文件系统中的 NFS，它总是会产生“有趣的”伪影。
*   结帐和合并之间的 url 已更改（可能是别名或重定向？）。
*   你省略了一些关于你做了什么导致你引用的结果的信息。
*   你有一些附加的钩子，可能是通过 svn 属性，它采取了上述一些行动。
*   `svn switch`在结帐时发出命令或其他命令，`svn merge`可能是向后
*   您根本没有检查头部，而是在过去的某个时间点进行了 3500 次修订。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T18:20:42.780

我只是在这里尝试过，但效果不佳。据我了解，该命令的作用可能不是您想要的。

`svn help merge`说：

> 这种形式称为“同步”（或“追赶”）合并：
> 
> svn 合并源[@REV] [TARGET_WCPATH]
> 
> 同步合并用于获取在父分支上所做的所有最新更改。换句话说，目标分支最初是通过复制源分支创建的，并且自分支以来在源分支上提交的任何更改都将应用于目标分支。这使用合并跟踪来跳过所有已经合并的修订，因此可以定期重复同步合并以与源分支保持最新。

因此，通过此命令，您要求 svn 尝试应用路径“。”的所有更改。（我猜，翻译为“http://svn/myrepo”）到当前的 WC。当然，这必须失败。

我看不到你想用这个命令做什么有用的服务。如果您想“导入”最新的更改，一个简单的`svn up`方法就是将服务器中的所有新更改集成到您的 WC 中。

# c# - 我是否需要使用我的应用程序为每个设备移动外部库

> ID：12647153
> 
> 赞同：0
> 
> 时间：2012-09-28T20:44:19.170
> 
> 标签：c#, .net

为了在我的 C# 项目中使用外部库，我们需要将其添加为 dll 文件形式的程序集引用，如下图所示： ![在此处输入图像描述](../Images/d174122de557cd2c7728778cda9ccd83.png) 但是通过这种方式，我是否需要将 dll 文件与我的应用程序一起放在每台机器中我移动我的应用程序？或者它们将嵌入我的应用程序中，因此不需要总是携带它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:55:49.587

您可以复制项目的引用，[将库作为​​资源嵌入](https://stackoverflow.com/questions/2452114/how-do-package-managed-c-sharp-dlls-with-a-managed-c-sharp-application-without-l)，或者使用[ILMerge](http://www.microsoft.com/en-us/download/details.aspx?id=17630)生成一个大型可执行文件。但是，除非您有充分的理由不复制引用程序集，否则我会坚持复制引用程序集的标准做法。（为了简单起见只想拥有一个文件对我来说不是一个强有力的理由）。

Framework ( `System.*`) 库将安装在目标机器上的 GAC 中，因此您不必部署它们。

任何非系统库都需要安装在 GAC 中（由您或第三方安装程序的库）或与解决方案一起复制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:46:05.673

为此，您的参考属性窗口中有一个名为`Copy Local`. 如果此属性设置为 true，则在运行时将引用复制到项目的输出路径。

![在此处输入图像描述](../Images/a872bca3272e58b1f2557605d15d8029.png)

# php - mysqli 查询结果显示所有行

> ID：12647154
> 
> 赞同：16
> 
> 时间：2012-09-28T20:44:26.610
> 
> 标签：php, mysqli, while-loop

我有以下代码：

```
include $_SERVER['DOCUMENT_ROOT'].'/include/conn.php'; 

$query = "SELECT title FROM news_event";
$result = $mysqli->query($query);
$row = $result->fetch_array(MYSQLI_BOTH);
$row_cnt = $result->num_rows;
$result->free();
$mysqli->close(); 
```

如果只有一个结果，这很好，因为我可以回显`$row['title']`但是如果有很多结果，我如何让它循环并打印每一行？

我确信这真的很简单，但我只是不确定我需要在 Google 中搜索什么。

我正在寻找`mysqli`类似的东西：

```
while( $row = mysql_fetch_array($result) )
{
    echo $row['FirstName'] . " " . $row['LastName'];
    echo "<br />";
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-28T20:46:46.043

只需将其替换为`mysqli_fetch_array`or `mysqli_result::fetch_array`:)

```
while( $row = $result->fetch_array() )
{
    echo $row['FirstName'] . " " . $row['LastName'];
    echo "<br />";
} 
```

几乎所有`mysql_*`的功能都有对应的`mysqli_*`功能。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-11-19T01:34:07.893

**简单的mysqli解决方案：**

```
$db = new mysqli('localhost','user','password','database');
$resource = $db->query('SELECT * FROM table WHERE 1');
while ( $rows = $resource->fetch_assoc() ) {
    print_r($rows);//echo "{$row['field']}";
}
$resource->free();
$db->close(); 
```

**错误处理：**如果出现致命错误，脚本将终止并显示错误消息。

```
// ini_set('display_errors',1); // Uncomment to show errors to the end user.
mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);
$db = new mysqli('localhost','user','password','database');
$resource = $db->query('SELECT field FROM table WHERE 1');
while ( $row = $resource->fetch_assoc() ) {
    echo "{$row['field']}";
}
$resource->free();
$db->close(); 
```

**使用迭代器：** PHP 5.4 添加了支持

```
$db = new mysqli('localhost','user','password','database');
foreach ( $db->query('SELECT * FROM table') as $row ) {
    print_r($row);//echo "{$row['field']}";
}
$db->close(); 
```

**获取单个记录：**此代码不需要循环。

```
$db = new mysqli('localhost','user','password','database');
$resource = $db->query('SELECT field FROM table');
$row = $resource->fetch_assoc();
echo "{$row['field']}";
$resource->free();
$db->close(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-28T20:49:32.550

利用：

```
while ($row = $result->fetch_array(MYSQLI_BOTH)) {
    // Look inside $row here, do what you want with it.
} 
```

查看这里的关联数组示例（也应与 fetch_array() 版本对应）：

[http://php.net/manual/en/mysqli-result.fetch-assoc.php](http://php.net/manual/en/mysqli-result.fetch-assoc.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-06T13:02:40.570

您可以简单地循环使用`foreach`

```
$query = "SELECT title FROM news_event";
$result = $mysqli->query($query);
foreach($result as $row) {
    echo $row['FirstName'] . " " . $row['LastName'];
    echo "<br />";
} 
```

如果您想将 mysqli 代码和 HTML 分开，那么最好将所有内容提取到一个数组中并稍后循环。

```
$query = "SELECT title FROM news_event";
$result = $mysqli->query($query);
$news_events = $result->fetch_all(MYSQLI_ASSOC);

// Later in HTML:    

<div>
<?php foreach($news_events as $row): ?>
    <p><?= $row['FirstName'] ?> <?= $row['LastName'] ?></p>
<?php endforeach ?>
</div> 
```

# r - 将 data.frame 变成单行

> ID：12647159
> 
> 赞同：5
> 
> 时间：2012-09-28T20:45:08.280
> 
> 标签：r, plyr, reshape

我有这些数据：

```
structure(list(type = c("journal", "all", "similar_age_1m", "similar_age_3m", 
"similar_age_journal_1m", "similar_age_journal_3m"), count = c("13972", 
"754555", "22408", "56213", "508", "1035"), rank = c("13759", 
"754043", "22339", "56074", "459", "947"), pct = c("98.48", "99.93", 
"99.69", "99.75", "90.35", "91.50")), .Names = c("type", "count", 
"rank", "pct"), row.names = c(NA, -6L), class = "data.frame") 
```

我想把它变成一行，列的名称`2:4`以相应的类型为前缀。例如`journal.count`，`journal.rank`...最快的方法是什么？出于某种原因`dcast`，并`reshape`没有为我做这件事，我的解决方案有点太麻烦了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T21:13:06.923

你提到`reshape2`了，所以这是一种方法：

```
library("reshape2")
dcast(melt(dat, id.var="type"), 1~variable+type) 
```

这给出了：

```
 1 count_all count_journal count_similar_age_1m count_similar_age_3m
1 1    754555         13972                22408                56213
  count_similar_age_journal_1m count_similar_age_journal_3m rank_all
1                          508                         1035   754043
  rank_journal rank_similar_age_1m rank_similar_age_3m
1        13759               22339               56074
  rank_similar_age_journal_1m rank_similar_age_journal_3m pct_all pct_journal
1                         459                         947   99.93       98.48
  pct_similar_age_1m pct_similar_age_3m pct_similar_age_journal_1m
1              99.69              99.75                      90.35
  pct_similar_age_journal_3m
1                      91.50 
```

`type`和变量是用`_`, 而不是 ,分隔的`.`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T21:09:17.717

这是另一种方式：

```
y <- as.numeric(as.matrix(x[-1])) # flatten the data.frame
names(y) <- as.vector(outer(x[['type']], names(x)[-1], paste, sep='.')) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T18:42:14.867

假设您可以为整形添加一个虚拟“时间”变量，您也可以使用基本 R 轻松完成此操作。假设你`data.frame`被称为：

```
mydf$id <- 1
(mydfw <- reshape(mydf, direction = "wide", idvar="id", timevar="type"))
#   id count.journal rank.journal pct.journal count.all rank.all pct.all
# 1  1         13972        13759       98.48    754555   754043   99.93
#   count.similar_age_1m rank.similar_age_1m pct.similar_age_1m
# 1                22408               22339              99.69
#   count.similar_age_3m rank.similar_age_3m pct.similar_age_3m
# 1                56213               56074              99.75
#   count.similar_age_journal_1m rank.similar_age_journal_1m
# 1                          508                         459
#   pct.similar_age_journal_1m count.similar_age_journal_3m
# 1                      90.35                         1035
#   rank.similar_age_journal_3m pct.similar_age_journal_3m
# 1                         947                      91.50 
```

如果您想重新排序列，清理也不错。

```
mydfw <- mydfw[, unlist(sapply(names(mydf), grep, names(mydfw)))] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T21:07:50.633

这是`expand.grid`用于获取名称的解决方案。

要获取数据，首先，子集删除包含名称的第一列。然后，转置并转换为数字。

```
> eg <- expand.grid(colnames(x[, -1]), x[, 1])
> setNames(as.numeric(t(x[, -1])), paste(eg[[2]], eg[[1]], sep="."))
               journal.count                 journal.rank 
                    13972.00                     13759.00 
                 journal.pct                    all.count 
                       98.48                    754555.00 
                    all.rank                      all.pct 
                   754043.00                        99.93 
        similar_age_1m.count          similar_age_1m.rank 
                    22408.00                     22339.00 
          similar_age_1m.pct         similar_age_3m.count 
                       99.69                     56213.00 
         similar_age_3m.rank           similar_age_3m.pct 
                    56074.00                        99.75 
similar_age_journal_1m.count  similar_age_journal_1m.rank 
                      508.00                       459.00 
  similar_age_journal_1m.pct similar_age_journal_3m.count 
                       90.35                      1035.00 
 similar_age_journal_3m.rank   similar_age_journal_3m.pct 
                      947.00                        91.50 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-28T21:14:30.090

```
#assuming your data is called "test"
result <- as.data.frame(matrix(t(test[-1]),nrow=1),stringsAsFactors=FALSE)
names(result) <- as.vector(t(outer(unique(test$type),names(test[-1]),paste,sep=".")))

str(result)
'data.frame':   1 obs. of  18 variables:
 $ journal.count               : chr "13972"
 $ journal.rank                : chr "13759"
 $ journal.pct                 : chr "98.48"
 $ all.count                   : chr "754555"
 $ all.rank                    : chr "754043"
 $ all.pct                     : chr "99.93"
 $ similar_age_1m.count        : chr "22408"
 $ similar_age_1m.rank         : chr "22339"
 $ similar_age_1m.pct          : chr "99.69"
 $ similar_age_3m.count        : chr "56213"
 $ similar_age_3m.rank         : chr "56074"
 $ similar_age_3m.pct          : chr "99.75"
 $ similar_age_journal_1m.count: chr "508"
 $ similar_age_journal_1m.rank : chr "459"
 $ similar_age_journal_1m.pct  : chr "90.35"
 $ similar_age_journal_3m.count: chr "1035"
 $ similar_age_journal_3m.rank : chr "947"
 $ similar_age_journal_3m.pct  : chr "91.50" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-28T21:00:49.317

假设您的数据框被称为 dat 这是一个解决方案。这有点粗略，可能不是您所追求的：

```
dat2 <- data.frame(matrix(unlist(lapply(1:nrow(dat), function(i) dat[i, -1])), nrow=1))
colnames(dat2) <- paste0(rep(dat[, 1], each=ncol(dat)-1), ".", 1:(ncol(dat)-1)) 
dat2 
```

如果它不必是数据框，这也可以工作：

```
dat3 <- as.numeric(unlist(lapply(1:nrow(dat), function(i) dat[i, -1])))
names(dat3) <- paste0(rep(dat[, 1], each=ncol(dat)-1), ".", 1:(ncol(dat)-1)) 
dat3 
```

# regex - 正则表达式查找字符连续少于 x 次且超过 y 次？

> ID：12647160
> 
> 赞同：2
> 
> 时间：2012-09-28T20:45:10.557
> 
> 标签：regex

我试图找到连续出现多次且连续出现少于 23 次的空间。我只需要它来找到 . 什么是正则表达式？

我想要 \s\s\s\s\s\s\s\s\s\s\s\s\s\s\s\s\s\s\s\s\s\s (<-- 22 次）与 \s\s\s\s 一起被找到，但我永远不想只找到一个空格或超过 22 个空格。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T20:47:25.793

简单地说`\s{2,22}`，这样它将连续匹配 2 到 22 个空格

# android - Tycho 找不到 Android 开发工具包

> ID：12647177
> 
> 赞同：3
> 
> 时间：2012-09-28T20:46:37.013
> 
> 标签：android, eclipse, maven, tycho

我正在尝试构建一个依赖于`com.android.ide.eclipse.adt`捆绑包的插件+功能。为此，我已将 ADT 存储库添加到 master `pom.xml`：

```
<repository>
  <id>adt</id>
  <layout>p2</layout>
  <url>http://dl-ssl.google.com/android/eclipse</url>
</repository> 
```

现在构建失败并出现以下错误：

```
[INFO] Adding repository http://dl-ssl.google.com/android/eclipse
[INFO] Fetching site.xml (0B of 1,8kB at 0B/s) from http://dl-ssl.google.com/android/eclipse/
[INFO] 1 operation remaining.
[INFO] Fetching site.xml (1,8kB of 1,8kB at 0B/s) from http://dl-ssl.google.com/android/eclipse/
[INFO] Adding repository http://dl-ssl.google.com/android/eclipse
[INFO] Resolving dependencies of MavenProject: me.fixpoint.eared:me.fixpoint.eared.plugin:0.0.4-SNAPSHOT @ D:\Projects\eared\plugin\pom.xml
[INFO] Cannot complete the request.  Generating details.
[INFO] Cannot complete the request.  Generating details.
[INFO] {osgi.ws=win32, osgi.os=win32, osgi.arch=x86_64, org.eclipse.update.install.features=true}
[ERROR] Cannot resolve project dependencies:
[ERROR]   Software being installed: me.fixpoint.eared 0.4.0
[ERROR]   Missing requirement: me.fixpoint.eared 0.4.0 requires 'bundle com.android.ide.eclipse.adt 0.0.0' but it could not be found
[ERROR]
[ERROR] Internal error: java.lang.RuntimeException: "No solution found because the problem is unsatisfiable.": ["Unable to satisfy dependency from me.fixpoint.eared 0.4.0 to bundle com.android.ide.eclipse.adt 0.0.0.", "No solution found because the problem is unsatisfiable."] -> [Help 1]
org.apache.maven.InternalErrorException: Internal error: java.lang.RuntimeException: "No solution found because the problem is unsatisfiable.": ["Unable to satisfy dependency from me.fixpoint.eared 0.4.0 to bundle com.android.ide.eclipse.adt 0.0.0.", "No solution found because the problem is unsatisfiable."] 
```

我已尝试从该线程中获得以下建议：[https ://groups.google.com/group/adt-dev/tree/browse_frm/month/2012-07/39c71d32169b9569?rnum=51&_done=/group/adt-dev/browse_frm /month/2012-07?&pli=1](https://groups.google.com/group/adt-dev/tree/browse_frm/month/2012-07/39c71d32169b9569?rnum=51&_done=/group/adt-dev/browse_frm/month/2012-07?&pli=1)并在 处创建 p2 更新站点`http://dl.dropbox.com/u/1236385/adt`，但错误相同：

```
[INFO] Adding repository http://dl.dropbox.com/u/1236385/adt
[INFO] Fetching content.jar (0B of 18,09kB at 0B/s) from http://dl.dropbox.com/u/1236385/adt/
[INFO] 1 operation remaining.
[INFO] Fetching content.jar (3,97kB of 18,09kB at 0B/s) from http://dl.dropbox.com/u/1236385/adt/
[INFO] Adding repository http://dl.dropbox.com/u/1236385/adt
[INFO] Fetching artifacts.jar (0B of 783B at 0B/s) from http://dl.dropbox.com/u/1236385/adt/
[INFO] 1 operation remaining.
[INFO] Fetching artifacts.jar (783B of 783B at 0B/s) from http://dl.dropbox.com/u/1236385/adt/
[INFO] Resolving dependencies of MavenProject: me.fixpoint.eared:me.fixpoint.eared.plugin:0.0.4-SNAPSHOT @ D:\Projects\eared\plugin\pom.xml
[INFO] Cannot complete the request.  Generating details.
[INFO] Cannot complete the request.  Generating details.
[INFO] {osgi.ws=win32, osgi.os=win32, osgi.arch=x86_64, org.eclipse.update.install.features=true}
[ERROR] Cannot resolve project dependencies:
[ERROR]   Software being installed: me.fixpoint.eared 0.4.0
[ERROR]   Missing requirement: me.fixpoint.eared 0.4.0 requires 'bundle com.android.ide.eclipse.adt 0.0.0' but it could not be found
[ERROR]
[ERROR] Internal error: java.lang.RuntimeException: "No solution found because the problem is unsatisfiable.": ["Unable to satisfy dependency from me.fixpoint.eared 0.4.0 to bundle com.android.ide.eclipse.adt 0.0.0.", "No solution found because the problem is unsatisfiable."] -> [Help 1]
org.apache.maven.InternalErrorException: Internal error: java.lang.RuntimeException: "No solution found because the problem is unsatisfiable.": ["Unable to satisfy dependency from me.fixpoint.eared 0.4.0 to bundle com.android.ide.eclipse.adt 0.0.0.", "No solution found because the problem is unsatisfiable."] 
```

为什么找不到`com.android.ide.eclipse.adt`？

以防万一，[这里是主 POM 的链接](https://bitbucket.org/fixpoint/eared/src/312c31ac288e/build/pom.xml)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T20:41:52.877

旧式更新站点只有关于工件依赖关系的不完整元数据。然而，Tycho 需要完整的依赖元数据用于其依赖解析机制，因此不能使用旧式更新站点。Dropbox 站点可能采用现代 p2 存储库格式，但它包含相同的、不完整的元数据。（在 p2 中，这些元数据不完整的条目称为“部分 IU”。）在 Tycho 0.18.0 之前，这些部分 IU 被静默删除，导致所描述的分辨率问题。这在[Tycho 0.18.0](http://wiki.eclipse.org/Tycho/Release_Notes/0.18)中得到了改进：从那个版本开始，Tycho 失败并出现错误消息，指向包含不完整元数据的存储库。

要解决您的问题，最好要求项目提供适当的 p2 存储库。p2 提供了不同的[发布者应用程序](http://wiki.eclipse.org/Equinox/p2/Publisher)来执行此操作。理论上，您也可以自己调用发布者应用程序，但这实际上应该只是一种临时解决方法。

# java - SocketInputStream 和 InputStream 支持 Reset() 或 MarkSupported()

> ID：12647183
> 
> 赞同：0
> 
> 时间：2012-09-28T20:47:00.727
> 
> 标签：java, core

我正在尝试创建一个`InputStream`以`SocketInputStream`. 不支持`reset()`和`mark()`。现在，一旦我处理了这个输入流，我就可以再次处理它以进行其他操作，因为它已关闭，在 eof 处到达。就像我想使用`InputStream`允许`reset()`和`markSupported()`.

`InputStream`在这种情况下我该如何处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:22:07.173

显然，默认情况下`SocketInputStream`不支持`mark()`and `reset()`。网络流不是您可以重新定位的东西。没有任何东西存储已经读取的字节，因此流永远不会返回。

也就是说，您可以扩展`SocketInputStream`并提供该功能。您将需要覆盖该`SocketInputStream.read(byte b[], int off, int length)`方法并将信息存储在 a`ByteArrayOutputStream`或其他一些 running `byte[]`. 每当重新定位标记时，如果您位于内部数组的末尾，则需要从`byte[]`唯一发出的 a中读取。`super.read(...)`

但是，要做到正确是一项很好的工作，并且您必须*非常*小心这里的内存。

# c# - 将动态创建的 ActionBlock 链接到 BufferBlock

> ID：12647185
> 
> 赞同：5
> 
> 时间：2012-09-28T20:47:08.233
> 
> 标签：c#, task-parallel-library, tpl-dataflow

我不确定这是否可能，但如果是的话，我可能做得不对。假设我有一个链接到许多消费者（ActionBlocks）的共享缓冲区。每个消费者都应该使用满足用于将其链接到缓冲区的谓词的数据。例如，ActionBlock1 应该消耗满足的数字`x => x % 5 == 0`，ActionBlock2 应该只消耗`x => x % 5 == 1`等等。

这是我所拥有的：

```
private static ITargetBlock<int> BuildPipeline(int NumProductionLines)
{
    var productionQueue = new BufferBlock<int>();

    for (int i = 0; i < NumProductionLines; i++)
    {
        ActionBlock<int> productionLine = new ActionBlock<int>(num => Console.WriteLine("Processed by line {0}: {1}", i + 1, num));

        productionQueue.LinkTo(productionLine, x => x % NumProductionLines == i);
    }

    return productionQueue;
} 
```

然后我打电话：

```
Random rnd = new Random();

ITargetBlock<int> temp = BuildPipeline(5);

while (true)
{
    temp.Post(rnd.Next(255));
} 
```

但是，这不起作用。控制台中不显示任何输出。如果我将`BuildPipeline`方法修改为：

```
private static ITargetBlock<int> BuildPipeline(int NumProductionLines)
{
    var productionQueue = new BufferBlock<int>();

    ActionBlock<int> productionLine1 = new ActionBlock<int>(num => Console.WriteLine("Processed by line {0}: {1}", 1, num));
    ActionBlock<int> productionLine2 = new ActionBlock<int>(num => Console.WriteLine("Processed by line {0}: {1}", 2, num));
    ActionBlock<int> productionLine3 = new ActionBlock<int>(num => Console.WriteLine("Processed by line {0}: {1}", 3, num));
    ActionBlock<int> productionLine4 = new ActionBlock<int>(num => Console.WriteLine("Processed by line {0}: {1}", 4, num));
    ActionBlock<int> productionLine5 = new ActionBlock<int>(num => Console.WriteLine("Processed by line {0}: {1}", 5, num));

    productionQueue.LinkTo(productionLine1, x => x % 5 == 0);
    productionQueue.LinkTo(productionLine2, x => x % 5 == 1);
    productionQueue.LinkTo(productionLine3, x => x % 5 == 2);
    productionQueue.LinkTo(productionLine4, x => x % 5 == 3);
    productionQueue.LinkTo(productionLine5, x => x % 5 == 4);

    return productionQueue;
} 
```

代码完成了预期的工作。

有人可以解释为什么动态创建和链接动作块不起作用吗？

PS 如果我在`ITargetBlock<int> temp = BuildPipeline(5);`temp 确实显示 5 个目标链接到缓冲区之后立即中断代码。并且每个目标的ID是不同的。

提前致谢

编辑：添加了 svick 建议的更改，但仍然没有好处：

```
private static ITargetBlock<int> BuildPipeline(int NumProductionLines)
{
    var productionQueue = new BufferBlock<int>();
    var opt = new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 1 };

    for (int i = 0; i < NumProductionLines; i++)
    {
        ActionBlock<int> productionLine = new ActionBlock<int>(num => Console.WriteLine("Processed by line {0}: {1}", i + 1, num));

        int j = i;
        productionQueue.LinkTo(productionLine, x => x % NumProductionLines == j);
    }

    ActionBlock<int> discardedLine = new ActionBlock<int>(num => Console.WriteLine("Discarded: {0}", num));
    productionQueue.LinkTo(discardedLine);

    return productionQueue;
} 
```

现在只有第二条生产线处理数据（满足 x % 5 == 1 谓词的那个）。并且数据不满足谓词，这意味着我得到了以 9 和 7 结尾的数字。

编辑：工作代码如下所示：

```
private static ITargetBlock<int> BuildPipeline(int NumProductionLines)
{
    var productionQueue = new BufferBlock<int>();
    var opt = new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 1 };

    for (int i = 0; i < NumProductionLines; i++)
    {
        int j = i;
        ActionBlock<int> productionLine = new ActionBlock<int>(num => Console.WriteLine("Processed by line {0}: {1}", j + 1, num));

        productionQueue.LinkTo(productionLine, x => x % NumProductionLines == j);
    }

    productionQueue.LinkTo(DataflowBlock.NullTarget<int>());

    return productionQueue;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T09:16:11.790

问题是在您的第一个版本中，您对每个目标块使用相同的谓词。换句话说，谓词不依赖于`i`.

但即使这样做，您的代码也不会工作，因为`i`变量在谓词之间共享，所以它们都将使用最后一个值。解决方法是复制`i`到局部变量中并在谓词中使用它。

代码可能如下所示：

```
private static ITargetBlock<int> BuildPipeline(int NumProductionLines)
{
    var productionQueue = new BufferBlock<int>();

    for (int i = 0; i < NumProductionLines; i++)
    {
        int iCopy = i;

        ActionBlock<int> productionLine = new ActionBlock<int>(
            num => Console.WriteLine("Processed by line {0}: {1}", iCopy + 1, num));

        productionQueue.LinkTo(
            productionLine, x => x % NumProductionLines == iCopy);
    }

    return productionQueue;
} 
```

如果您问为什么您的代码至少不处理`x % 5 == 1`数字，那是因为随机生成器可能会生成一个与该谓词不匹配的数字，因此没有一个`ActionBlock`s 会接受它。因此，该号码将留在源块的输出队列中，其他号码将无法通过。

如果在您的真实代码中可能发生类似情况并且您想丢弃所有不适合任何谓词的数字，您可以将源块链接到[一个什么都不做](http://msdn.microsoft.com/en-us/library/hh462765)并接受任何东西的块，然后将它链接到所有你有用的块：

```
productionQueue.LinkTo(DataflowBlock.NullTarget<int>()); 
```

# r - 如何将此“稀疏”Matlab bsxfun 调用转换为 R？

> ID：12647191
> 
> 赞同：2
> 
> 时间：2012-09-28T20:47:26.230
> 
> 标签：r, matlab, vectorization, bsxfun

```
>> A = sparse([1,2,3,4,5])

A =

   (1,1)        1
   (1,2)        2
   (1,3)        3
   (1,4)        4
   (1,5)        5

>> B = sparse([1;2;3;4;5])

B =

   (1,1)        1
   (2,1)        2
   (3,1)        3
   (4,1)        4
   (5,1)        5

>> bsxfun(@times, A, B)

ans =

   (1,1)        1
   (2,1)        2
   (3,1)        3
   (4,1)        4
   (5,1)        5
   (1,2)        2
   (2,2)        4
   (3,2)        6
   (4,2)        8
   (5,2)       10
   (1,3)        3
   (2,3)        6
   (3,3)        9
   (4,3)       12
   (5,3)       15
   (1,4)        4
   (2,4)        8
   (3,4)       12
   (4,4)       16
   (5,4)       20
   (1,5)        5
   (2,5)       10
   (3,5)       15
   (4,5)       20
   (5,5)       25 
```

以非稀疏形式看起来像这样：

```
>> full(ans)

ans =

     1     2     3     4     5
     2     4     6     8    10
     3     6     9    12    15
     4     8    12    16    20
     5    10    15    20    25

>> 
```

编辑：

我想对这些稀疏向量进行矩阵乘法，并返回一个稀疏数组：

```
> class(NRowSums)
[1] "dsparseVector"
attr(,"package")
[1] "Matrix"
> class(NColSums)
[1] "dsparseVector"
attr(,"package")
[1] "Matrix"
> 
```

NRowSums * NColSums（我认为；或者如果返回标量，则翻转它们）不使用非稀疏变量临时存储数据。

编辑2：

我目前有这个：

```
NSums = tcrossprod(as(NRowSums, "sparseMatrix"), as(NColSums, "sparseMatrix")) 
```

这对于我正在尝试做的事情似乎有点尴尬，尤其是类型转换。它也非常低效，因为它计算存在 NRowSum 或 NColSum 的所有元素，而不仅仅是这两者的交集。也就是说，这个 NSums 中的条目比原始稀疏矩阵中的条目多 100 倍。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-26T17:14:40.867

检查包“pracma” [http://cran.r-project.org/web/packages/pracma/index.html](http://cran.r-project.org/web/packages/pracma/index.html) 然后你可以像在 Matlab 中一样使用 bsxfun()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:20:00.140

如果你真的有一个“稀疏”的情况，我想你可能想从

```
df <- expand.grid(A=A, B=B)
df$val <- with(df, A*B))
# then pass that triple column set of i,j, and values to the sparse matrix constructors. 
```

目前，您的示例不适合测试，因为它很密集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T20:55:31.397

您可以先将 B 数组转置为与 A 相同的布局：

```
B = t(B) 
```

然后调用两个数组的外积：

```
outer(A,B) 
```

# image - Go + Appengine Blobstore，调整图片上传大小

> ID：12647194
> 
> 赞同：1
> 
> 时间：2012-09-28T20:47:59.963
> 
> 标签：image, google-app-engine, go

我正在尝试了解 Go + Appengine。我一直在使用 Blobstore 来存储用户上传的图片。无论如何我可以从 BlobStore 下载图像并对其进行操作吗？

还是有其他解决方案？

[图像库](https://developers.google.com/appengine/docs/go/images/overview)有点受限。我还想将其他格式转换为 jpeg。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-29T01:08:02.903

是的，您可以从 blobstore 中提取文件并利用 Go 1 中包含的图像包，包括[image/draw](http://golang.org/pkg/image/draw/)和[image/jpeg](http://golang.org/pkg/image/jpeg/)。有关概述和[图像/绘图博客文章](http://blog.golang.org/2011/09/go-imagedraw-package.html)，请参阅[Go 图像包](http://golang.org/doc/articles/image_package.html)。假设您已经拥有要操作的图像的[BlobInfo ，您可以通过将嵌入的 BlobKey 传递给](https://developers.google.com/appengine/docs/go/blobstore/reference#BlobInfo)[blobstore.NewReader](https://developers.google.com/appengine/docs/go/blobstore/reference#NewReader)来获取其原始数据，从而为您提供一个 io.Reader 对象。将其传递给例如[png.Decode](http://golang.org/pkg/image/png/#Decode)以获取[image.Image](http://golang.org/pkg/image/)。做任何你喜欢的操作，然后将其保存回 blobstore，从[blobstore.Create](https://developers.google.com/appengine/docs/go/blobstore/reference#Create)获取 Writer并将其交给[jpeg.Encode](http://golang.org/pkg/image/jpeg/#Encode). 最后调用 blobstore.Close 和 .Key 以获取新的 BlobKey 以保存在数据存储中。

如果您想做更复杂的操作，可以使用几个纯 Go 库，您可以将它们与您的应用程序一起上传并与 image.Image 一起使用。例如，参见[graphics-go和](http://code.google.com/p/graphics-go/)[Libraries Written in Go](http://go-lang.cat-v.org/pure-go-libs)的“图像和图形”部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T17:05:03.127

我想要一个包，它会自动执行优化 blobstore 图像的魔力。结果可以在 GitHub 上找到：[https ://github.com/TomiHiltunen/GAE-Go-image-optimizer](https://github.com/TomiHiltunen/GAE-Go-image-optimizer)

该算法本身与 Adam Thomason 所描述的非常相似。这个包只是隐藏了丑陋的部分并自动化了这个过程。

您可以像使用 blobstore.ParseUploads() 一样使用它。它的作用是遍历上传的 blob 并优化图像，使所有其他类型的 blob 保持不变。它还将返回从 blobstore.ParseUploads() 传递的所有其他值。

# python - 如何关闭 python simpleHTTPserver？

> ID：12647196
> 
> 赞同：72
> 
> 时间：2012-09-28T20:48:17.917
> 
> 标签：python, d3.js, simplehttpserver

所以我正在尝试学习 d3，而[wiki](https://github.com/mbostock/d3/wiki)建议

> 要在本地查看示例，您必须拥有本地 Web 服务器。任何网络服务器都可以工作；例如，您可以运行 Python 的内置服务器：
> 
> `python -m SimpleHTTPServer 8888 &`

太好了...只是现在我有一个服务器正在运行...但是在某些时候我想我可能应该再次关闭它。

有没有比使用更好的方法来关闭它`kill <pid>`？对于一份小工作来说，这似乎是一把大锤子。

（我正在运行 Mac OS 10.6.8（雪豹））

FWIW：`ctrl+c`给出大约 10 行的回溯，抱怨被打断。

`kill -3 <pid>`在单独的窗口“Python 意外退出”中给出 Finder 警告。

默认`kill <pid>`且`kill -15 <pid>`相对干净（且简单）。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-09-28T20:56:33.247

您只是向进程发送信号。`kill`是发送这些信号的命令。

键盘命令`Ctrl`+`C`发送一个 SIGINT，`kill -9`发送一个 SIGKILL，然后`kill -15`发送一个 SIGTERM。

您想向服务器发送什么信号来结束它？

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2015-07-10T06:52:08.630

如果您已经启动了服务器

```
python -m SimpleHTTPServer 8888 
```

然后你可以按 ctrl + c 来关闭服务器。

但是如果你已经启动了服务器

```
python -m SimpleHTTPServer 8888 & 
```

或者

```
python -m SimpleHTTPServer 8888 & disown 
```

您必须先查看列表才能终止该进程，

运行命令

```
ps 
```

或者

```
ps aux | less 
```

它会告诉你一些像这样的运行过程..

```
PID TTY          TIME CMD
7247 pts/3     00:00:00 python
7360 pts/3     00:00:00 ps
23606 pts/3    00:00:00 bash 
```

您可以从这里获取 PID。并通过运行此命令终止该进程..

```
kill -9 7247 
```

这里 7247 是 python id。

同样由于某种原因，如果端口仍然打开，您可以使用此命令关闭端口

`fuser -k 8888/tcp`

这里8888是python打开的tcp端口。

希望现在清楚。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-05-13T15:39:57.860

```
MYPORT=8888; 
kill -9 `ps -ef |grep SimpleHTTPServer |grep $MYPORT |awk '{print $2}'` 
```

这就对了！

## 解释命令行：

*   `ps -ef` : 列出所有进程。

*   `grep SimpleHTTPServer`: 属于“SimpleHTTPServer”的过滤进程

*   `grep $MYPORT` ：再次过滤进程属于“SimpleHTTPServer”，其中端口为MYPORT（.ie：MYPORT=8888）

*   `awk '{print $2}'`：打印结果的第二列，即 PID（进程 ID）

*   `kill -9 <PID>` ：使用适当的 PID 强制终止进程。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-09-28T21:18:21.640

或者你可以这样做`kill %1`，这将杀死第一个放在后台的工作

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2015-01-17T16:06:36.170

原来有一个关闭，但这必须从另一个线程启动。

这个解决方案对我有用：[https ://stackoverflow.com/a/22533929/573216](https://stackoverflow.com/a/22533929/573216)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-07-27T22:50:37.767

当您将程序作为后台进程运行时（通过在其后添加`&`），例如：

```
python -m SimpleHTTPServer 8888 & 
```

如果终端窗口仍然打开，您可以执行以下操作：

```
jobs 
```

获取正在运行的 shell 进程中所有后台作业的列表。

它可能看起来像这样：

```
$ jobs
[1]+  Running                 python -m SimpleHTTPServer 8888 & 
```

要终止作业，您可以执行终止`kill %1`作业“[1]”，或者`fg %1`将作业置于前台（fg）然后使用 ctrl-c 终止它。（只需输入`fg`会将最后一个后台进程置于前台）。

就 SimpleHTTPServer 而言，它似乎`kill %1`比`fg`+ ctrl-c 更好。至少它不会用 kill 命令抗议。

以上已经在 Mac OS 中测试过，但据我所知，它在 Linux 中的工作方式相同。

**更新：**为此，必须直接从命令行启动 Web 服务器（逐字第一个代码片段）。使用脚本启动它会使`jobs`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-09-28T20:53:49.133

这似乎有点矫枉过正，但您可以使用[supervisor](http://supervisord.org/)来启动和停止您的 simpleHttpserver，并将其作为服务完全管理。

或者只是按照建议在前台运行它并使用`Ctrl``C`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-17T16:26:12.067

击中`Ctrl``C`一次（等待回溯），然后`Ctrl``C`再次击中对我来说是诀窍:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-26T07:58:28.980

这是另一个解决方案。

假设您已使用此命令启动服务器 -

```
python3 -m http.server 7800 
```

要杀死该进程，请使用 -

```
pkill -9 -f  'python3 -m http.server 7800 
```

就是这样。

# c# - C# JavaScriptSerializer json 数组反序列化

> ID：12647199
> 
> 赞同：1
> 
> 时间：2012-09-28T20:48:38.117
> 
> 标签：c#, json, arraylist, arrays, javascriptserializer

**代码：**

```
string json = "[{\"Name\" : \"dan\", \"Age\" : 25, \"City\" : \"lllal\", \"About\" : \"im dan\", \"Bdate\" : \"26/06/1997\"}]";

JavaScriptSerializer ser = new JavaScriptSerializer();
List<Person> ncontacts = ser.Deserialize<List<Person>>(json);

foreach (Person person in ncontacts)
    listView1.Items.Add(person.Name); 
```

**人物类：**

```
class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
    public string City { get; set; }
    public string About { get; set; }
    public DateTime Bdate { get; set; }
} 
```

* * *

问题是列表视图保留 0 个项目，即使它应该有`dan`.

我尝试调试并在该`foreach`行上放了一个断点，奇怪的是它永远不会到达该行..如果我在断点之前放一个断点...

欢迎任何帮助，丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:52:16.077

您的日期字符串`26/06/1997`不是用于反序列化的有效格式，并且您的代码出现异常。如果你替换`public DateTime Bdate { get; set; }`为`public string Bdate { get; set; }`你可以看到它正在工作。

# iphone - UITableViewCell 中的 UIImageView 调整为行高

> ID：12647203
> 
> 赞同：0
> 
> 时间：2012-09-28T20:48:47.197
> 
> 标签：iphone, objective-c, ios, ipad

我有一个 UITableViewCell，我正在使用它的 UIImageView，我有一个大小为 25,25 的图像，我用它来设置 UIImageView。问题是当我点击单元格时，图像大小会调整为行高，这不是我想要的。我希望它保持固定在 25,25。这可能吗？这是我的代码：

```
 cell.imageView.bounds = CGRectMake(cell.imageView.origin.x, cell.imageView.origin.y, 25, 25);
        cell.imageView.frame = cell.imageView.bounds;
        cell.imageView.autoresizingMask = UIViewAutoresizingNone;
        cell.imageView.clipsToBounds = YES;
        cell.imageView.layer.borderWidth = 0;
        cell.imageView.layer.borderColor = [UIColor blackColor].CGColor; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:39:48.300

是的，这是可能的，但您必须通过子类 UITableViewCell 创建自己的 UITableViewCell 并添加具有固定大小的 UIImageView

# bash - 切换文件不可变

> ID：12647205
> 
> 赞同：0
> 
> 时间：2012-09-28T20:49:00.207
> 
> 标签：bash, file-attributes

我制作了一个简单的小 bash 脚本来切换一些文件（特别是我的桌面图标，因此它们在不应该移动时不会移动）

我有使文件 [im] 可变的命令：

```
sudo chattr +i ~/.config/xfce4/desktop/icons* 
```

但是，要使脚本切换状态，我需要检查状态并采取相应措施。但我不太擅长 bash 代码，一些谷歌搜索并没有找到任何解决方案

答案可能与“lsattr”和“grep”有关，但我不确定它们应该采用哪种形式......

（如果答案可以是 if 语句的形式，那就太好了：D）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:29:02.253

也许

```
for file in ~/.config/xfce4/desktop/icons*
do
     sudo chattr \
       $(lsattr "$file" | cut -c 5 | fgrep -q 'i' \
            && echo "-i" || echo "+i") \
       "$file"
done 
```

效率极低，但是……</p>

作为“如果”——

```
 if lsattr "$file" | cut -c 5 | fgrep -q 'i'
  then
        # whatever
  fi 
```

# r - 在 R 和 RStudio 中读取 URL

> ID：12647207
> 
> 赞同：5
> 
> 时间：2012-09-28T20:49:05.967
> 
> 标签：r, rstudio

当我在 RStudio 中键入以下内容时，它工作正常：

```
nyt1 <- read.csv(url("http://stat.columbia.edu/~rachel/datasets/nyt1.csv")) 
```

但是当我在 R 控制台中输入相同的内容时，我收到了这个错误：

```
Error in open.connection(file, "rt") : cannot open the connection
In addition: Warning message:
In open.connection(file, "rt") : cannot open: HTTP status was '0 (nil)' 
```

我已经检查并重新检查了一千次，RStudio 和 R 之间的一切似乎都完全相同（相同版本等），那么为什么会出现错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T17:30:44.797

RStudio 和 R 控制台之间的代理设置或其他网络设置可能存在差异。例如，“internet2”选项（在调用 R 时在命令行上定义）的使用可能会有所不同。`setInternet2(NA)`每个平台上都会显示设置。如果结果不同，那可能是差异的根源。

# .net - 仅在 .net 中为某个功能模拟管理员

> ID：12647210
> 
> 赞同：1
> 
> 时间：2012-09-28T20:49:24.067
> 
> 标签：.net, impersonation, administrator

我有一个程序，我需要在其中对文件夹访问权限进行一些更改，通常，只有管理员用户可以这样做。但是，对于特定情况，即使运行应用程序的用户没有管理员权限，我也必须能够“假装”我是管理员并进行一些更改。

有没有办法执行这样的任务？

谢谢

编辑：如果需要，拥有用户名/密码不是问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:59:20.327

对于当前用户来说是这样的：

```
System.Security.Principal.WindowsImpersonationContext impersonationContext;
impersonationContext = 
    ((System.Security.Principal.WindowsIdentity)User.Identity).Impersonate();

//Insert your code that runs under the security context of the authenticating user here.

impersonationContext.Undo(); 
```

如果您要模拟特定用户，则需要做更多工作：

[http://platinumdogs.me/2008/10/30/net-c-impersonation-with-network-credentials/](http://platinumdogs.me/2008/10/30/net-c-impersonation-with-network-credentials/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:16:57.290

```
public class ImpersonationDemo
{
    [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
    public static extern bool LogonUser(String lpszUsername, String lpszDomain, String lpszPassword,
        int dwLogonType, int dwLogonProvider, out SafeTokenHandle phToken);

    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
    public extern static bool CloseHandle(IntPtr handle);

    // Test harness. 
    // If you incorporate this code into a DLL, be sure to demand FullTrust.
    [PermissionSetAttribute(SecurityAction.Demand, Name = "FullTrust")]
    public static void Main(string[] args)
    {
        SafeTokenHandle safeTokenHandle;
        try
        {
            string userName, domainName;
            // Get the user token for the specified user, domain, and password using the 
            // unmanaged LogonUser method. 
            // The local machine name can be used for the domain name to impersonate a user on this machine.
            Console.Write("Enter the name of the domain on which to log on: ");
            domainName = Console.ReadLine();

            Console.Write("Enter the login of a user on {0} that you wish to impersonate: ", domainName);
            userName = Console.ReadLine();

            Console.Write("Enter the password for {0}: ", userName);

            const int LOGON32_PROVIDER_DEFAULT = 0;
            //This parameter causes LogonUser to create a primary token. 
            const int LOGON32_LOGON_INTERACTIVE = 2;

            // Call LogonUser to obtain a handle to an access token. 
            bool returnValue = LogonUser(userName, domainName, Console.ReadLine(),
                LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT,
                out safeTokenHandle);

            Console.WriteLine("LogonUser called.");

            if (false == returnValue)
            {
                int ret = Marshal.GetLastWin32Error();
                Console.WriteLine("LogonUser failed with error code : {0}", ret);
                throw new System.ComponentModel.Win32Exception(ret);
            }
            using (safeTokenHandle)
            {
                Console.WriteLine("Did LogonUser Succeed? " + (returnValue ? "Yes" : "No"));
                Console.WriteLine("Value of Windows NT token: " + safeTokenHandle);

                // Check the identity.
                Console.WriteLine("Before impersonation: "
                    + WindowsIdentity.GetCurrent().Name);
                // Use the token handle returned by LogonUser.
                WindowsIdentity newId = new WindowsIdentity(safeTokenHandle.DangerousGetHandle());
                using (WindowsImpersonationContext impersonatedUser = newId.Impersonate())
                {

                    // Check the identity.
                    Console.WriteLine("After impersonation: "
                        + WindowsIdentity.GetCurrent().Name);
                }
                // Releasing the context object stops the impersonation 
                // Check the identity.
                Console.WriteLine("After closing the context: " + WindowsIdentity.GetCurrent().Name);
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine("Exception occurred. " + ex.Message);
        }

    }
}
public sealed class SafeTokenHandle : SafeHandleZeroOrMinusOneIsInvalid
{
    private SafeTokenHandle()
        : base(true)
    {
    }

    [DllImport("kernel32.dll")]
    [ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
    [SuppressUnmanagedCodeSecurity]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool CloseHandle(IntPtr handle);

    protected override bool ReleaseHandle()
    {
        return CloseHandle(handle);
    }
} 
```

更多信息：http: [//msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.aspx](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.aspx)

# python - 为什么执行某些命令后 Pexpect 会间歇性挂起（未检测到 EOF）？

> ID：12647212
> 
> 赞同：8
> 
> 时间：2012-09-28T20:49:36.020
> 
> 标签：python, spawn, pexpect

**语境：**

我有一些使用 编写的代码`pexpect`，其工作是提供命令的“实时”输出。即当命令生成一些输出时或不久之后打印一些东西，而不是等到命令完成然后与它的输出交互。

我所做的只是启动和停止服务。我通过`spawn`ing 进程来做到这一点，然后在打印时输出每一行，如下所示：

```
def watch(process):
    output = ""
    while True:
        try:
            line = process.read_nonblocking(timeout = -1)
            print(line, end ="")
            output += line
        except pexpect.EOF:
            break
    del process
    return output

while True:
    print("IN 1")
    process = pexpect.spawn("service",["zend-server", "stop"], timeout = None)
    watch(process)
    print("OUT 1")

    print("IN 2")
    process = pexpect.spawn("service",["zend-server", "start"], timeout = None)
    watch(process)
    print("OUT 2") 
```

这段代码应该只是循环服务：一遍又一遍地启动和停止它，打印启动/停止的输出。它可以很好地打印输出。但是，它最终会在“OUT 2”之前挂起。我可以查看输出，并看到`service`调用停止执行。但是，该`watch`函数永远不会引发 EOF 并退出。

并非每项服务都会发生这种情况。一些服务无限循环。`zend-server`但是，与其他一些不相关的命令一起，以相同的方式间歇性地失败。

通过“最终挂起”，我的意思是它启动/停止服务几次（每次运行时可变），然后挂起。它通常在 4 到 6 点后起泡，但从来没有在第一次通话时出现 - 至少在第二次通话时（因此`del`声明；我想我会稳妥行事）。

Python 2.6.6、CentOS (64) 6.3、Pexpect 2.3-6、FWIW

**问题：**

为什么`pexpect`挂在某些命令上？我应该如何解决这个问题？使用超时不是一个可行的解决方案，因为其中一些命令确实可以运行任意长时间。`service zend-server stop`只是我选择的一个例子，因为它不需要那么长时间，我可以观察它完成。

**我试过的：**

我尝试用以下方法替换该`watch`方法，该方法使用`expect('\n')`，但结果是相同的：重启次数可变，然后最终挂起。

我也可以添加`pexpect.EOF`到与`expect`一起编辑的数组中`\n`，并处理返回值以跳出循环，它仍然挂在同一个地方。

```
def watch2(process):
    output = ""
    done = False
    while True:
        try:
            if not process.isalive():
                line = process.readline()
                done = True
            else:
                process.expect(['\n'])
                line = process.before
             print(line)
            output += line
            if done:
                raise pexpect.EOF(0)
        except pexpect.EOF:
            break
    del process
    return output 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:09:34.953

看起来像一个缓冲问题，其中 pexpect 正在等待更多数据。`maxread=1`您可以尝试通过传递来禁用缓冲`pexpect.spawn()`

# java - 从 AppEngine 开发服务器运行任意 Java

> ID：12647213
> 
> 赞同：1
> 
> 时间：2012-09-28T20:49:41.380
> 
> 标签：java, google-app-engine

为了帮助开发，我想从 appengine 开发服务器启动一些需要访问文件系统、执行环境等的程序。本质上，我想写：

```
if (SystemProperty.environment.value().equals(
        SystemProperty.Environment.Value.Development)) {

    doStuffICannotDoOnRealAppengineButShouldBeABleToDoOnMyMachine();

} 
```

这可能吗？

我的目标是预览 AppEngine 正在发送的电子邮件。现在我可以将内容打印到 System.out，但我想将它们保存到文件并启动浏览器，以便我的设计人员可以立即看到电子邮件内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T18:38:40.703

Hrm. I see a number of ways of accomplishing this *without* having to get around GAEs file system restrictions.

*   You could provide some debug call with an email address request param which would send the particular email via [Google's email API](https://developers.google.com/appengine/docs/java/mail/usingjavamail) to the address specified. You'd probably want to see it "rendered" by the email client anyway.
*   You could store the file using [Google's cloud storage API](https://developers.google.com/appengine/docs/java/googlestorage/). This should allow you to put a file that can be displayed via an URL. If you can't using that API then you certainly can using S3's.
*   You could make some HTTP post request to a local server using [Google's URL fetch API](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/urlfetch/package-summary). You could even do it to localhost port 8100 (or whatever) and then run netcat to receive the email `nc -l 8100`.

Hope something here helps.

# java - Ant - 如何在 javac 任务的类路径中使用文件集 ID？

> ID：12647215
> 
> 赞同：0
> 
> 时间：2012-09-28T20:49:45.593
> 
> 标签：java, maven, ant, javac

我的项目是使用 Maven 构建的。我很高兴用 Maven 构建它。现在，我需要用 Ant 构建它（我希望我不需要！！！）。我希望使用现有的 maven 依赖项——即，希望保留 pom 以进行依赖项管理。

所以，我写了这个任务：

```
<target name="java.compile">
  <artifact:pom id="mypom" file="pom.xml" />
  <artifact:dependencies filesetId="mypomdeps" pomRefId="mypom" />

  <mkdir dir="build/classes" />

  <javac
    srcdir="${src.java.dir}"
    destdir="build/classes"
    includeantruntime="no">

    <classpath>
      <fileset refid="mypomdeps"/>
    </classpath>

  </javac>
</target> 
```

但是，ant 编译输出抱怨 mypomdeps 指向的库（在 jar 中）丢失。

javac 无法看到我想要的类路径的原因是什么？

我是否正确使用了 artifact:dependencies 生成的 filesetId？

**我的 ant 项目 defn**：
我将 maven-ant-tasks-2.1.3.jar 放在项目 basedir 中。

```
<project name="why-does-the-sun-go-on-shining"
  default="java.compile"
  xmlns:artifact="antlib:org.apache.maven.artifact.ant">

  <path id="maven-ant-tasks.classpath" path="maven-ant-tasks-2.1.3.jar" />
  <typedef
    resource="org/apache/maven/artifact/ant/antlib.xml"
    uri="antlib:org.apache.maven.artifact.ant"
    classpathref="maven-ant-tasks.classpath" /> 
```

**进一步澄清**

问题的要点是......如何在我的 Ant javac 任务中使用我的 pom 依赖项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T22:51:24.983

想回答我自己的问题说

我的蚂蚁目标和定义是正确的。正确引用了对人工制品依赖项的 refid。

但是，在 pom.xml 中定义了一些系统范围依赖项。

antlib:org.apache.maven.artifact.ant 不会解析系统范围的传递依赖。例如，

```
<dependencies>
  <dependency>
    <groupId>sun.jdk</groupId>
    <artifactId>tools</artifactId>
    <version>LATEST</version>
    <scope>system</scope>
    <systemPath>${java.home}/../lib/tools.jar</systemPath>
  </dependency>
</dependencies> 
```

*感谢 Oers 让我通过发出 echo 元素来调试 ant 脚本。*

# c++ - 使 C++ 类成为监视器（在并发意义上）

> ID：12647217
> 
> 赞同：22
> 
> 时间：2012-09-28T20:49:55.937
> 
> 标签：c++, multithreading, templates, boost, concurrency

我想确保一次只有一个线程可以运行我的 C++ 类的方法。换句话说，让这个类表现得像一个[Monitor](http://en.wikipedia.org/wiki/Monitor_%28synchronization%29)。

有没有一种模式、模板化的方式来做到这一点，或者我可以使用一些 Boost 类？因为到目前为止我唯一的想法是添加一个关键部分成员，并在每个方法的开头获取它并在最后释放它（当然使用 RAII）。但这似乎非常多余，我不能将它重用于其他课程。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2018-01-23T19:02:20.733

您可以通过明智地使用`operator->`现代 c++ 来实现这一点，它提供了比以前接受的答案更简洁的语法：

```
template<class T>
class monitor
{
public:
    template<typename ...Args>
    monitor(Args&&... args) : m_cl(std::forward<Args>(args)...){}

    struct monitor_helper
    {
        monitor_helper(monitor* mon) : m_mon(mon), m_ul(mon->m_lock) {}
        T* operator->() { return &m_mon->m_cl;}
        monitor* m_mon;
        std::unique_lock<std::mutex> m_ul;
    };

    monitor_helper operator->() { return monitor_helper(this); }
    monitor_helper ManuallyLock() { return monitor_helper(this); }
    T& GetThreadUnsafeAccess() { return m_cl; }

private:
    T           m_cl;
    std::mutex  m_lock;
}; 
```

这个想法是您使用箭头运算符来访问底层对象，但这会返回一个辅助对象，该对象锁定然后解锁函数调用周围的互斥锁。然后通过反复应用语言的魔力，`operator->`您可以获得对底层对象的引用。

用法：

```
monitor<std::vector<int>> threadSafeVector {5};

threadSafeVector->push_back(0);
threadSafeVector->push_back(1);
threadSafeVector->push_back(2);

// Create a bunch of threads that hammer the vector
std::vector<std::thread> threads;
for(int i=0; i<16; ++i)
{
    threads.push_back(std::thread([&]()
    {
        for(int i=0; i<1024; ++i)
        {
            threadSafeVector->push_back(i);
        }
    }));
}

// You can explicitely take a lock then call multiple functions
// without the overhead of a relock each time. The 'lock handle'
// destructor will unlock the lock correctly. This is necessary
// if you want a chain of logically connected operations 
{
    auto lockedHandle = threadSafeVector.ManuallyLock();
    if(!lockedHandle->empty())
    {
        lockedHandle->pop_back();
        lockedHandle->push_back(-3);
    }
}

for(auto& t : threads)
{
    t.join();
}

// And finally access the underlying object in a raw fashion without a lock
// Use with Caution!

std::vector<int>& rawVector = threadSafeVector.GetThreadUnsafeAccess();
rawVector.push_back(555);

// Should be 16393 (5+3+16*1024+1)
std::cout << threadSafeVector->size() << std::endl; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-29T00:15:11.483

首先制作通用监视器类。借助 C++11 的强大功能，您可以像这样简单地做到这一点：

```
template <class F>
struct FunctionType;
template <class R, class Object, class... Args>
struct FunctionType<R (Object::*)(Args...)> {
  typedef R return_type;
};
template <class R, class Object, class... Args>
struct FunctionType<R (Object::*)(Args...) const> {
  typedef R return_type;
};

template <class Object_>
class Monitor {
public:
   typedef Object_ object_type;
   template <class F, class... Args >
   typename FunctionType<F>::return_type operation(const F& f, Args... args)
   {
       critical_section cs;
       return (object.*f)(args...);
   }
   template <class F, class... Args >
   typename FunctionType<F>::return_type operation(const F& f, Args... args) const
   {
       critical_section cs;
       return (object.*f)(args...);
   }
private:
  object_type object;
  class critical_section {};
}; 
```

当然，`critical_section`实施取决于您。我推荐 POSIX 或一些 BOOST。

它现在可以使用了：

```
Monitor<std::vector<int> > v;
v.operation((void (std::vector<int>::*)(const int&)) &std::vector<int>::push_back, 1);
v.operation((void (std::vector<int>::*)(const int&)) &std::vector<int>::push_back, 2);
size = v.operation(&std::vector<int>::size);
std::cout << size << std::endl; 
```

正如您所看到的，有时您需要明确说明要调用的成员函数 - std::vector<> 有多个 push_back...

* * *

对于仍然不支持可变参数模板的编译器 - 下面没有它的解决方案 - 我有最多两个参数的时间 - 这非常不方便 - 如果需要 - 添加具有更多参数的函数：

```
template <class F>
struct FunctionType;
template <class R, class Object>
struct FunctionType<R (Object::*)()> {
  typedef R return_type;
};
template <class R, class Object>
struct FunctionType<R (Object::*)() const> {
  typedef R return_type;
};
template <class R, class Object, class Arg1>
struct FunctionType<R (Object::*)(Arg1)> {
  typedef R return_type;
};
template <class R, class Object, class Arg1>
struct FunctionType<R (Object::*)(Arg1) const> {
  typedef R return_type;
};
template <class R, class Object, class Arg1, class Arg2>
struct FunctionType<R (Object::*)(Arg1,Arg2)> {
  typedef R return_type;
};
template <class R, class Object, class Arg1, class Arg2>
struct FunctionType<R (Object::*)(Arg1,Arg2) const> {
  typedef R return_type;
};

template <class Object_>
class Monitor {
public:
   typedef Object_ object_type;
   template <class F>
   typename FunctionType<F>::return_type operation(const F& f)
   {
       critical_section cs;
       return (object.*f)();
   }
   template <class F>
   typename FunctionType<F>::return_type operation(const F& f) const
   {
       critical_section cs;
       return (object.*f)();
   }
   template <class F, class Arg1>
   typename FunctionType<F>::return_type operation(const F& f, Arg1 arg1)
   {
       critical_section cs;
       return (object.*f)(arg1);
   }
   template <class F, class Arg1>
   typename FunctionType<F>::return_type operation(const F& f, Arg1 arg1) const
   {
       critical_section cs;
       return (object.*f)(arg1);
   }
   template <class F, class Arg1, class Arg2>
   typename FunctionType<F>::return_type operation(const F& f, Arg1 arg1, Arg2 arg2)
   {
       critical_section cs;
       return (object.*f)(arg1, arg2);
   }
   template <class F, class Arg1, class Arg2>
   typename FunctionType<F>::return_type operation(const F& f, Arg1 arg1, Arg2 arg2) const
   {
       critical_section cs;
       return (object.*f)(arg1, arg2);
   }
private:
  object_type object;
  class critical_section {};
}; 
```

# entity-framework - 实体框架在我的 WebAPI Mvc4 解决方案中不可用

> ID：12647219
> 
> 赞同：8
> 
> 时间：2012-09-28T20:50:19.960
> 
> 标签：entity-framework, asp.net-web-api

我已经使用流利的 api 制作了实体框架代码。

我有一个 web api 控制器：

```
public class NewsController : ApiController
{
    private TrafficTheoryContext db = new TrafficTheoryContext();

    // GET api/News
    public IEnumerable<News> GetNews()
    {
        //return new List<News> {
       //  new News{ Title = "Featuring Azure ACS Authentication", Subtile="Hello "}};
        return db.News.AsEnumerable();
    }
} 
```

如果我发出获取请求，我会收到错误消息：

此 XML 文件似乎没有任何与之关联的样式信息。文档树如下所示。

```
<Error>
<Message>An error has occurred.</Message>
<ExceptionMessage>
The 'ObjectContent`1' type failed to serialize the response body for content type 'application/xml; charset=utf-8'.
</ExceptionMessage>
<ExceptionType>System.InvalidOperationException</ExceptionType>
<StackTrace/>
<InnerException>
<Message>An error has occurred.</Message>
<ExceptionMessage>
Type 'System.Data.Entity.DynamicProxies.News_786DE29B12691F869E9C9DF523A808EABE06546C3FCE3354F77875B83B9EB51C' with data contract name 'News_786DE29B12691F869E9C9DF523A808EABE06546C3FCE3354F77875B83B9EB51C:http://schemas.datacontract.org/2004/07/System.Data.Entity.DynamicProxies' is not expected. Consider using a DataContractResolver or add any types not known statically to the list of known types - for example, by using the KnownTypeAttribute attribute or by adding them to the list of known types passed to DataContractSerializer.
</ExceptionMessage>
<ExceptionType>
System.Runtime.Serialization.SerializationException
</ExceptionType>
<StackTrace>
at System.Runtime.Serialization.XmlObjectSerializerWriteContext.SerializeAndVerifyType(DataContract dataContract, XmlWriterDelegator xmlWriter, Object obj, Boolean verifyKnownType, RuntimeTypeHandle declaredTypeHandle, Type declaredType) at System.Runtime.Serialization.XmlObjectSerializerWriteContext.SerializeWithXsiType(XmlWriterDelegator xmlWriter, Object obj, RuntimeTypeHandle objectTypeHandle, Type objectType, Int32 declaredTypeID, RuntimeTypeHandle declaredTypeHandle, Type declaredType) at System.Runtime.Serialization.XmlObjectSerializerWriteContext.InternalSerialize(XmlWriterDelegator xmlWriter, Object obj, Boolean isDeclaredType, Boolean writeXsiType, Int32 declaredTypeID, RuntimeTypeHandle declaredTypeHandle) at WriteArrayOfNewsToXml(XmlWriterDelegator , Object , XmlObjectSerializerWriteContext , CollectionDataContract ) at System.Runtime.Serialization.CollectionDataContract.WriteXmlValue(XmlWriterDelegator xmlWriter, Object obj, XmlObjectSerializerWriteContext context) at System.Runtime.Serialization.XmlObjectSerializerWriteContext.WriteDataContractValue(DataContract dataContract, XmlWriterDelegator xmlWriter, Object obj, RuntimeTypeHandle declaredTypeHandle) at System.Runtime.Serialization.XmlObjectSerializerWriteContext.SerializeWithoutXsiType(DataContract dataContract, XmlWriterDelegator xmlWriter, Object obj, RuntimeTypeHandle declaredTypeHandle) at System.Runtime.Serialization.DataContractSerializer.InternalWriteObjectContent(XmlWriterDelegator writer, Object graph, DataContractResolver dataContractResolver) at System.Runtime.Serialization.DataContractSerializer.InternalWriteObject(XmlWriterDelegator writer, Object graph, DataContractResolver dataContractResolver) at System.Runtime.Serialization.XmlObjectSerializer.WriteObjectHandleExceptions(XmlWriterDelegator writer, Object graph, DataContractResolver dataContractResolver) at System.Runtime.Serialization.DataContractSerializer.WriteObject(XmlWriter writer, Object graph) at System.Net.Http.Formatting.XmlMediaTypeFormatter.<>c__DisplayClass7.<WriteToStreamAsync>b__6() at System.Threading.Tasks.TaskHelpers.RunSynchronously(Action action, CancellationToken token)
</StackTrace>
</InnerException>
</Error> 
```

如果我只是返回一个新闻列表，它可以正常工作。我注意到这些类附加了某种我不知道是什么的名称？

我该怎么做才能让 webapi 工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-13T09:27:32.843

当我禁用代理创建时，我在 Mcv5 项目中也遇到了同样的问题，每件事都像魅力一样工作。我希望它也会对你有所帮助。

```
DbContext.Configuration.ProxyCreationEnabled = false; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T21:32:40.203

我相信您会因为为您的实体生成动态代理而获得此异常。如果您查看异常消息，您实际上并没有序列化 News 类型，而是 System.Data.Entity.DynamicProxies.News_786DE29B12691F869E9C9DF523A808EABE06546C3FCE3354F77875B83B9EB51C 类型。此类型由 Entity Framework 为您创建以支持延迟加载。您可以在此处找到有关动态代理的更多详细信息：http: [//msdn.microsoft.com/en-US/data/jj592886](http://msdn.microsoft.com/en-US/data/jj592886)。我不太了解 WebAPI，但异常实际上说明了需要做什么：

Type 'System.Data.Entity.DynamicProxies.News_786DE29B12691F869E9C9DF523A808EABE06546C3FCE3354F77875B83B9EB51C' with data contract name 'News_786DE29B12691F869E9C9DF523A808EABE06546C3FCE3354F77875B83B9EB51C:http://schemas.datacontract.org/2004/07/System.Data.Entity.DynamicProxies' is not expected. **考虑使用 DataContractResolver 或将任何静态未知的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将它们添加到传递给 DataContractSerializer 的已知类型列表中。**

由于类型是自动创建的，因此您不能放置属性。因此，我将专注于“考虑使用 DataContractResolver”和“将它们添加到传递给 DataContractSerializer 的已知类型列表中”部分。

顺便说一句，您使用的是什么版本的 EF？我想我之前看到过这个问题，它在 EF5 RTM 中得到了修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:40:48.300

使用 .ToList() 代替 .AsEnumerable。我也很好奇您是如何创建和销毁数据上下文的。

# c - 在 C 中读取和写入 rsa 密钥到 pem 文件

> ID：12647220
> 
> 赞同：15
> 
> 时间：2012-09-28T20:50:28.007
> 
> 标签：c, security, openssl, rsa, pem

我正在编写一个 C 程序来为 RSA 生成密钥并将它们写入文件，然后从中读取。作业要求我生成 openssl 格式的文件。所以，我选择了PEM。现在，我有以下用于创建文件的功能

```
rsa = RSA_new();
// These 3 keys are generated beforehand
rsa->e = e;
rsa->n = n;
rsa->d = d;

fp = fopen(pubkey_file, "w");
if(!PEM_write_RSAPublicKey(fp, rsa))
{
    printf("\n%s\n", "Error writing public key");
}
fflush(fp);
fclose(fp);

fp = fopen(privkey_file, "w");
// pRsaKey = EVP_PKEY_new();
// EVP_PKEY_assign_RSA(pRsaKey, rsa);
if(!PEM_write_RSAPrivateKey(fp, rsa, NULL, 0, 0, NULL, NULL))
// if (!PEM_write_PrivateKey(fp, pRsaKey, NULL, NULL, 0, 0, NULL))
{
    printf("\n%s\n", "Error writing private key");
}
fflush(fp);
fclose(fp); 
```

这是读取文件的功能

```
rsa = RSA_new();
fp = fopen(pubkey_file, "r");
if(PEM_read_RSAPublicKey(fp, &rsa, NULL, NULL) == NULL)
{
    printf("\n%s\n", "Error Reading public key");
    return;
}

fclose(fp);
BN_bn2bin(rsa->n, (unsigned char *)modulus);
BN_bn2bin(rsa->e, (unsigned char *)exp);
printf("\n%s\n%s\n", exp, modulus);
RSA_free(rsa);

// pRsaKey = EVP_PKEY_new();
fp = fopen(privkey_file, "r");
if(fp)
    // if((PEM_read_PrivateKey(fp, &pRsaKey, NULL, NULL)) == NULL)
    if((PEM_read_RSAPrivateKey(fp, &rsa, NULL, NULL)) == NULL)
    {
        printf("\n%s\n", "Error Reading private key");
        return;
    }
// rsa = RSA_new();
// rsa = EVP_PKEY_get1_RSA(pRsaKey);
fclose(fp); 
```

公钥按要求写入和读取，但证明密钥失败。我尝试过同时使用 rsa 和 evp 进行编写（在上面的代码中对此进行了注释）。但是，两者都失败了。我无法理解为什么会发生这种情况，也无法尝试找到调试此问题的位置。任何人都可以为此提供一些指示吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-30T12:52:22.003

RSA 密钥是对称的，您可以将它们中的任何一个用作私钥或公钥，这只是您选择的问题（但 DSA 密钥**不是**对称的）。下面的程序生成两个 2048 位长的 RSA 密钥，然后将它们保存到文件中并将它们读回内存中。这应该让你知道如何去做。

```
#include <stdio.h>
#include <string.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <openssl/bio.h>
#include <openssl/err.h>
#include <openssl/rsa.h>
#include <openssl/evp.h>
#include <openssl/pem.h>

const char* pcszPassphrase = "open sezamee";

static void gen_callback(int iWhat, int inPrime, void* pParam);
static void init_openssl(void);
static void cleanup_openssl(void);
static int passwd_callback(char *pcszBuff,int size,int rwflag, void *pPass);
static EVP_PKEY* create_rsa_key(void);
static void handle_openssl_error(void);

int main(int argc, char **argv)
{
    int iRet = EXIT_SUCCESS;
    EVP_PKEY* pPrivKey = NULL;
    EVP_PKEY* pPubKey  = NULL;
    FILE*     pFile    = NULL;
    const EVP_CIPHER* pCipher = NULL;
    init_openssl();

    pPrivKey = create_rsa_key();
    pPubKey  = create_rsa_key();

    if(pPrivKey && pPubKey)
    {/* Save the keys */
        if((pFile = fopen("privkey.pem","wt")) && (pCipher = EVP_aes_256_cbc()))
        {

            if(!PEM_write_PrivateKey(pFile,pPrivKey,pCipher,
                                    (unsigned char*)pcszPassphrase,
                                    (int)strlen(pcszPassphrase),NULL,NULL))
            {
                fprintf(stderr,"PEM_write_PrivateKey failed.\n");
                handle_openssl_error();
                iRet = EXIT_FAILURE;
            }
            fclose(pFile);
            pFile = NULL;
            if(iRet == EXIT_SUCCESS)
            {
                if((pFile = fopen("pubkey.pem","wt")) && PEM_write_PUBKEY(pFile,pPubKey))
                    fprintf(stderr,"Both keys saved.\n");
                else
                {
                    handle_openssl_error();
                    iRet = EXIT_FAILURE;
                }
                if(pFile)
                {
                    fclose(pFile);
                    pFile = NULL;
                }
            }
        }
        else
        {
            fprintf(stderr,"Cannot create \"privkey.pem\".\n");
            handle_openssl_error();
            iRet = EXIT_FAILURE;
            if(pFile)
            {
                fclose(pFile);
                pFile = NULL;
            }
        }
        if(iRet == EXIT_SUCCESS)
        {/* Read the keys */
            EVP_PKEY_free(pPrivKey);
            pPrivKey = NULL;
            EVP_PKEY_free(pPubKey);
            pPubKey = NULL;

            if((pFile = fopen("privkey.pem","rt")) && 
               (pPrivKey = PEM_read_PrivateKey(pFile,NULL,passwd_callback,(void*)pcszPassphrase)))
            {
                fprintf(stderr,"Private key read.\n");
            }
            else
            {
                fprintf(stderr,"Cannot read \"privkey.pem\".\n");
                handle_openssl_error();
                iRet = EXIT_FAILURE;
            }
            if(pFile)
            {
                fclose(pFile);
                pFile = NULL;
            }

            if((pFile = fopen("pubkey.pem","rt")) && 
               (pPubKey = PEM_read_PUBKEY(pFile,NULL,NULL,NULL)))
            {
                fprintf(stderr,"Public key read.\n");
            }
            else
            {
                fprintf(stderr,"Cannot read \"pubkey.pem\".\n");
                handle_openssl_error();
                iRet = EXIT_FAILURE;
            }
        }
    }

    if(pPrivKey)
    {
        EVP_PKEY_free(pPrivKey);
        pPrivKey = NULL;
    }
    if(pPubKey)
    {
        EVP_PKEY_free(pPubKey);
        pPubKey = NULL;
    }
    cleanup_openssl();
    return iRet;
}

EVP_PKEY* create_rsa_key(void)
{
    RSA *pRSA      = NULL;
    EVP_PKEY* pKey = NULL;
    pRSA = RSA_generate_key(2048,RSA_3,gen_callback,NULL);
    pKey = EVP_PKEY_new();
    if(pRSA && pKey && EVP_PKEY_assign_RSA(pKey,pRSA))
    {
        /* pKey owns pRSA from now */
        if(RSA_check_key(pRSA) <= 0)
        {
            fprintf(stderr,"RSA_check_key failed.\n");
            handle_openssl_error();
            EVP_PKEY_free(pKey);
            pKey = NULL;
        }
    }
    else
    {
        handle_openssl_error();
        if(pRSA)
        {
            RSA_free(pRSA);
            pRSA = NULL;
        }
        if(pKey)
        {
            EVP_PKEY_free(pKey);
            pKey = NULL;
        }
    }
    return pKey;
}

void gen_callback(int iWhat, int inPrime, void* pParam)
{
    char c='*';
    switch(iWhat)
    {
        case 0: c = '.';  break;
        case 1: c = '+';  break;
        case 2: c = '*';  break;
        case 3: c = '\n'; break;
    }
    fprintf(stderr,"%c",c);
}

int passwd_callback(char *pcszBuff,int size,int rwflag, void *pPass)
{
    size_t unPass = strlen((char*)pPass);
    if(unPass > (size_t)size)
        unPass = (size_t)size;
    memcpy(pcszBuff, pPass, unPass);
    return (int)unPass;
}

void init_openssl(void)
{
    if(SSL_library_init())
    {
        SSL_load_error_strings();
        OpenSSL_add_all_algorithms();
        RAND_load_file("/dev/urandom", 1024);
    }
    else
        exit(EXIT_FAILURE);
}

void cleanup_openssl(void)
{
    CRYPTO_cleanup_all_ex_data();
    ERR_free_strings();
    ERR_remove_thread_state(0);
    EVP_cleanup();
}

void handle_openssl_error(void)
{
    ERR_print_errors_fp(stderr);
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-04-12T13:08:35.170

sirgeorge 给出的答案在 Code 中有错误。`create_rsa_key`不应调用两次。如果它被调用两次，则私钥没有匹配的公钥。这会导致解密期间出现问题。`main`方法中需要的修改

```
RSA *pRSA      = NULL;
pRSA = RSA_generate_key(2048,RSA_3,gen_callback,NULL);    
pPrivKey = create_rsa_key(pRSA);
pPubKey  = create_rsa_key(pRSA); 
```

中需要的修改`create_rsa_key`

```
EVP_PKEY* create_rsa_key(RSA *pRSA)
{
    EVP_PKEY* pKey = NULL;
    pKey = EVP_PKEY_new();
    if(pRSA && pKey && EVP_PKEY_assign_RSA(pKey,pRSA))
    {
        /* pKey owns pRSA from now */
        if(RSA_check_key(pRSA) <= 0)
        {
            fprintf(stderr,"RSA_check_key failed.\n");
            handle_openssl_error();
            EVP_PKEY_free(pKey);
            pKey = NULL;
        }
    }
    else
    {
        handle_openssl_error();
        if(pRSA)
        {
            RSA_free(pRSA);
            pRSA = NULL;
        }
        if(pKey)
        {
            EVP_PKEY_free(pKey);
            pKey = NULL;
        }
    }
    return pKey;
} 
```

# sql - 进行递归连接的最佳方法？

> ID：12647221
> 
> 赞同：1
> 
> 时间：2012-09-28T20:50:28.573
> 
> 标签：sql, oracle

在 Oracle 中进行递归连接的最佳方法是什么？假设我有如下架构：

```
node:
  id: number
  parent_id: number
  name: string 
```

我如何将子节点与其所有父节点一起加入？

我尝试了以下方法，但失败了：

```
SELECT c.* from node LEFT JOIN(
  SELECT * FROM node c
  START WITH id = c.id
  CONNECT BY PRIOR id = parent_id
) ON 1 = 1 
```

它抱怨 START WITH id = c.id 部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:19:54.553

基本上你需要一个从哪里开始的起点，所以会有一个没有的 id`parent_id`和它的`null`，所以我在这里做了什么来解释 id 1 没有 parent_id 。

```
create table node (id number,parent_id number,name varchar2(200));

insert into node values(1,null,'king');
insert into node values(2,1,'gaurav');
insert into node values(3,1,'rohan');
insert into node values(4,2,'anshoo');
insert into node values(5,4,'ajay');

 select id,parent_id,name from node 
 start with parent_id is null 
 connect by prior id= parent_id; 
```

sqlfiddle [链接](http://www.sqlfiddle.com/#!4/0cce5/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T19:08:42.537

根据您在问题中提供的信息，很难说出您真正想要实现的目标，但在我看来，您想为每个子树显示子树`ID`（主树从 ID=1 开始，让我们对它们进行排序方式，然后从 ID=2 开始的子树，依此类推）。

这是一个例子：

```
with Tb_Table (id, parent_id, name) as(
  select 1, 1, 'Child_1' from dual union all
  select 2, 1, 'Child_2' from dual union all
  select 3, 3, 'Child_3' from dual
),
rec_data (id, parent_id, name, lv) as(
  select id
       , parent_id
       , name
       , 0 lv
   from  Tb_Table  
  where id = id

  union all

  select tt.id
       , tt.parent_id
       , tt.name 
       , lv + 1
   from rec_data rt
   join tb_table tt
     on (rt.id = tt.parent_id)   
)
search depth first by id set ord
cycle id set is_cycle to 'Y' default 'N'
select id
     , parent_id
     , concat(lpad(' ', lv*3,' '), name) name
  from rec_data 
```

结果：

```
Id Parent_Id   Name 
-----------------------   
1     1        Child_1 
1     1          Child_1 
2     1          Child_2 
2     1        Child_2 
3     3        Child_3 
3     3          Child_3 
```

[**演示**](http://www.sqlfiddle.com/#!4/0725d/4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:18:51.990

`c`在连接中的某处，无法在括号外到达，但我认为你应该逐步学习如何使用`connect by`. 老实说，这个链接帮助我学习和理解它： http: [//www.adp-gmbh.ch/ora/sql/connect_by.html](http://www.adp-gmbh.ch/ora/sql/connect_by.html)

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-09-28T20:55:30.847

在 SQL Server（看起来您正在使用）中支持递归查询。以我下面的示例为例，用户被分配到许多位置。这些位置中的每一个都可以有一个父位置。此查询返回分配给 @userID 的所有位置以及子位置。

```
 ALTER FUNCTION [dbo].[tvf_UserLocations_Recursive] 
(   
    @UserID uniqueidentifier
)
RETURNS TABLE 
AS
RETURN 
(
    WITH recusrive (LocationID)
    AS (
        --anchor
        SELECT LocationID
        FROM LocationUser lu
        WHERE lu.Aspnet_Userid = @userID
        UNION ALL
        -- Recursive member definition
        SELECT child.LocationID         
        FROM recusrive parent
            INNER JOIN Location child ON (parent.LocationID = child.LocationParentID)
    )
    SELECT *
    FROM recusrive
) 
```

# dreamweaver - 为什么 Dreamweaver CS6 代码提示出现延迟？

> ID：12647223
> 
> 赞同：0
> 
> 时间：2012-09-28T20:50:53.937
> 
> 标签：dreamweaver, code-hinting

当然这个问题存在于所有版本的 Dreamweaver 中，但是当我输入代码时，它就像代码提示中有延迟，而不是在按键上，它似乎只有在我停止输入后才赶上？我是一个快速打字员，但我就是不明白这一点。

我知道 Preferences -> Code Hinting -> delay 中有一个延迟设置 你为什么还要延迟？

我习惯了像 MS 这样的环境，他们的智能感知在每次击键时都是瞬时的。

希望我不会在这方面不走运。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:06:45.880

如果您只是偶尔使用提示，延迟可能会很有用。大多数时候，当我输入代码提示时，代码提示会尽可能多地提供帮助。因此，如果在给定的时间间隔内没有击键，延迟会告诉 DW“我被卡住了”。

# php - 将图像从远程 mysql db 检索到 android

> ID：12647224
> 
> 赞同：0
> 
> 时间：2012-09-28T20:50:55.210
> 
> 标签：php, android, mysql, json, http

如何获取存储在服务器上 mysql 中的图像？我想根据用户输入的值（意味着动态查询）来获取这些图像。我想使用 json 将图像从 php 发送到 android。我使用静态查询成功地在 Web 浏览器中显示了该图像，但是当我在 android 应用程序中看到 php 的响应时，它显示了一些 html 代码而不是图像。请帮助我解析图像 json 响应并显示该图像。以下是将图像发送到 android 的 php 代码。

```
 while($post = mysql_fetch_object($data))
 {
    $posts[] = $post;

 }
         //header("Content-type: image/jpeg");

         echo '{"pprs":'.json_encode($posts).'}'; 
```

现在我得到回应：{"pprs":[{"pprs":null},{"pprs":null}]}

请帮助我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T13:22:55.063

如果要使用 JSON，则需要将图像转换为字符串：

```
 $posts[] = base64_encode($post); 
```

在 Android 方面：

```
String base64image = jsonobject.getString("pprs");
byte[] rawImage = Base64.decode(base64image, Base64.DEFAULT);
Bitmap bmp = BitmapFactory.decodeByteArray(rawImage, 0, rawImage.length);
ImageView imageview = (ImageView) findViewById(R.id.imgPicture);
imageview.setImageBitmap(bmp); 
```

# regex - 使用 awk 仅返回某些数据块

> ID：12647225
> 
> 赞同：2
> 
> 时间：2012-09-28T20:50:59.710
> 
> 标签：regex, awk, pattern-matching

我不能 100% 确定如何简单地表达我的问题，所以我很抱歉，如果这个问题已经在某个地方得到了回答，而我只是找不到它。

我所拥有的是调试日志，其中包含身份验证数据包以及一堆其他输出。我需要搜索大约 200 万行日志才能找到每个包含某个 MAC 地址的数据包。

数据包看起来像这样（略微审查）：

```
-----------------[ header ]-----------------
Event:     Authd-Response (1900)
Sequence:  -54
Timestamp: 1969-12-31 19:30:00 (0)
---------------[ attributes ]---------------
Auth-Result = Auth-Accept
Service-Profile-SID = 53
Service-Profile-SID = 49
RADIUS-Access-Accept-Attr/WiMAX-Capability = 0x(numbers)
Session-Timeout = 3600
Service-Profile-SID = 4
Service-Profile-SID = 29
Chargeable-User-Identity = "(Numbers)"
User-Password = "(the MAC address I'm looking for)"
-------------------------------------------- 
```

然而，大约有 10 种不同的可能类型具有不同的可能长度。它们都以标题行开始，以全破折线结束。

我已经成功使用 awk 来获取代码块自己使用这个：

```
awk '/-----------------\[ header \]-----------------/,/--------------------------------------------/' filename.txt 
```

但我希望能够使用它只返回包含我需要的 MAC 地址的数据包。

几天来我一直试图弄清楚这一点，但我很困惑。我可以尝试编写一个 bash 脚本，但我可以发誓我以前用 awk 做过类似的事情......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T06:13:05.227

这可能对您有用（GNU awk）：

```
awk '$0~mac{printf($0.RT)}' mac="01:23:45:67:89:ab" RS="\n[-]+\n" file 
```

`mac`您选择的地址在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:43:45.323

单程。

假设`infile`具有以下内容（具有不同 MAC 的三个标头）：

```
-----------------[ header ]-----------------
Event:     Authd-Response (1900)
Sequence:  -54
Timestamp: 1969-12-31 19:30:00 (0)
---------------[ attributes ]---------------
Auth-Result = Auth-Accept
Service-Profile-SID = 53
Service-Profile-SID = 49
RADIUS-Access-Accept-Attr/WiMAX-Capability = 0x(numbers)
Session-Timeout = 3600
Service-Profile-SID = 4
Service-Profile-SID = 29
Chargeable-User-Identity = "(Numbers)"
User-Password = "ab:89:67:45:23:01"
--------------------------------------------
-----------------[ header ]-----------------
Event:     Authd-Response (1900)
Sequence:  -54
Timestamp: 1969-12-31 19:30:00 (0)
---------------[ attributes ]---------------
Auth-Result = Auth-Accept
Service-Profile-SID = 53
Service-Profile-SID = 49
RADIUS-Access-Accept-Attr/WiMAX-Capability = 0x(numbers)
Session-Timeout = 3600
Service-Profile-SID = 4
Service-Profile-SID = 29
Chargeable-User-Identity = "(Numbers)"
User-Password = "01:23:45:67:89:ab"
--------------------------------------------
-----------------[ header ]-----------------
Event:     Authd-Response (1900)
Sequence:  -54
Timestamp: 1969-12-31 19:30:00 (0)
---------------[ attributes ]---------------
Auth-Result = Auth-Accept
Service-Profile-SID = 53
Service-Profile-SID = 49
RADIUS-Access-Accept-Attr/WiMAX-Capability = 0x(numbers)
Session-Timeout = 3600
Service-Profile-SID = 4
Service-Profile-SID = 29
Chargeable-User-Identity = "(Numbers)"
User-Password = "00:00:45:67:89:ab"
-------------------------------------------- 
```

运行以下`awk`脚本：

```
awk -v mac="01:23:45:67:89:ab" '
    BEGIN { 
        RS = "-+\\[ header \\]-+"; 
        FS = "\n"; 
    } 
    ## Save record separator. I must do at the beginning because later the
    ## variable is reset. ¿Bug?
    FNR == 1 {
        record_sep = RT;
    }
    { 
        ## Go throught each line searching for the MAC. If found print
        ## the whole block.
        for (i = 1; i <= NF; i++ ) { 
            if ( match( $i, mac ) > 0 ) {
                print record_sep, $0;
                break;
            }
        } 
    }
' infile 
```

这会产生：

```
-----------------[ header ]----------------- 
Event:     Authd-Response (1900)
Sequence:  -54
Timestamp: 1969-12-31 19:30:00 (0)
---------------[ attributes ]---------------
Auth-Result = Auth-Accept
Service-Profile-SID = 53
Service-Profile-SID = 49
RADIUS-Access-Accept-Attr/WiMAX-Capability = 0x(numbers)
Session-Timeout = 3600
Service-Profile-SID = 4
Service-Profile-SID = 29
Chargeable-User-Identity = "(Numbers)"
User-Password = "01:23:45:67:89:ab"
-------------------------------------------- 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:30:17.150

一些 awks 支持多字符记录分隔符。如果 '--------' 行总是相同的长度，那么

```
 awk 'BEGIN{ORS=RS="^---------------------$";}/macAddress/{print}' logfile 
```

应该管用。

（当然，扩展 '----' 以匹配您真正的记录分隔符的长度。

IHTH

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:36:30.207

```
awk -v mac=MACADDR '
     /^-----------------\[ header \]-----------------$/ { inpacket=1; found=0 }
     inpacket { packet = packet "\n" $0; if (/User-Password = / && $3 == mac) { found=1 } }
     /^--------------------------------------------$/ && found { print packet; inpacket=0 }' 
```

我假设上面示例中的引号和括号实际上不是文件格式的一部分。如果是，请将第一行更改为：

```
awk -v mac='"('MACADDR')"' ' 
```

# jquery - 使用 jquery/ajax 从 xml 到 html 表

> ID：12647228
> 
> 赞同：1
> 
> 时间：2012-09-28T20:51:30.593
> 
> 标签：jquery, xml, ajax

我想使用 jquery/ajax 将 xml 文档转换为 HTML 表。另外，我想在`tr`满足条件时添加一个类。这是我到目前为止所做的，但它没有按预期工作：1）HTML 表输出比它应该有的更多，2）tr ( ) 的条件类`tr`不起作用。任何帮助将不胜感激！`td``.no-kids`

JQUERY/AJAX 代码：

```
$(document).ready(function(){
  $.ajax({
  type: "GET",
  url: "database.xml",
  dataType: "xml",
  success: function(xmlData) {
    $("person", xmlData).each(function(){
    var name = $(this).find("name").text(),
        kids = $(this).find("kids").text(),
            cars = $(this).find("cars").text();
    if(kids<1){
      $("tbody").append('<tr class="no-kids">');
    }else{
      $("tbody").append('<tr>');
    }             
    $("tbody tr").append('<td class="name">'+name+'</td>');
    $("tbody tr").append('<td class="kids">'+kids+'</td>');
    $("tbody tr").append('<td class="cars">'+cars+'</td>');
    $("tbody").append('</tr>');
    });
   }
  });
  $(".no-kids").css("color","red");
}); 
```

HTML 代码：

```
<table> 
    <thead>
        <tr> 
            <th>NAME</th>
            <th>KIDS</th>
            <th>CARS</th>
        </tr> 
    </thead> 
    <tbody>
    </tbody> 
</table> 
```

DATABASE.XML 代码：

```
<root>
  <person>
    <name>Matt</name>
    <kids>3</kids>
    <cars>1</cars>
  </person>
  <person>
    <name>Jason</name>
    <kids>0</kids>
    <cars>2</cars>
  </person>
  <person>
    <name>Molly</name>
    <kids>1</kids>
    <cars>0</cars>
  </person>
</root> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T20:55:57.650

jQuery 只附加整个元素，而不是开始/结束标签。

```
var output = '<tr' + parseInt(kids) < 1 ? ' class="no-kids">' : '>';
output += '<td class="name">'+name+'</td>';
output += '<td class="kids">'+kids+'</td>';
output += '<td class="cars">'+cars+'</td>';
output += '</tr>';
$("tbody").append(output); 
```

编辑：此外，您需要在成功回调中应用红色字体颜色。

```
 }
  });
  $(".no-kids").css("color","red");
}); 
```

应该

```
 $(".no-kids").css("color","red");
   }
  });
}); 
```

# c# - Appfabric 缓存的执行速度比 SQL Server 2008 慢 4 倍？？

> ID：12647232
> 
> 赞同：8
> 
> 时间：2012-09-28T20:51:45.137
> 
> 标签：c#, performance, comparison, appfabric, distributed-caching

我正在运行一个测试，我正在比较黑白 appfabric 和 SQL Server 2008 的获取时间，并且看起来 appFabric 的执行时间比 SQL Server 慢 4 倍。

我有一个 SQL Server 2008 设置，它只包含一个包含 4 列（全部`nvarchar`）的表。该表有 6000 行。我在 appfabric 缓存中插入同一行（作为 CLR 可序列化 obj）。我正在运行一个循环来获取数据 x 次。

这是代码

```
public class AppFabricCache
{
readonly DataCache myDefaultCache;

public AppFabricCache()
{
//-------------------------
// Configure Cache Client 
//-------------------------

//Define Array for 1 Cache Host
var servers = new List<DataCacheServerEndpoint>(1);

//Specify Cache Host Details 
//  Parameter 1 = host name
//  Parameter 2 = cache port number
servers.Add(new DataCacheServerEndpoint(@"localhost", 22233));

//Create cache configuration
var configuration = new DataCacheFactoryConfiguration();

//Set the cache host(s)
configuration.Servers = servers;

//Set default properties for local cache (local cache disabled)
configuration.LocalCacheProperties = new DataCacheLocalCacheProperties();

//Disable exception messages since this sample works on a cache aside
DataCacheClientLogManager.ChangeLogLevel(System.Diagnostics.TraceLevel.Off);

//Pass configuration settings to cacheFactory constructor
DataCacheFactory myCacheFactory = new DataCacheFactory(configuration);

//Get reference to named cache called "default"
myDefaultCache = myCacheFactory.GetCache("default");
}

public bool TryGetCachedObject(string key, out object value)
{
value = myDefaultCache.Get(key);
bool result = value != null;
return result;
}

public void PutItemIntoCache(string key, object value)
{
myDefaultCache.Put(key, value, TimeSpan.FromDays(365));
}

} 
```

这是从缓存中获取数据的循环

```
public double RunReadStressTest(int numberOfIterations, out int recordReadCount)
{
recordReadCount = 0;
Stopwatch sw = Stopwatch.StartNew();
for (int i = 0; i < numberOfIterations; i++)
{
for (int j = 1; j <= 6000; j++)
{
string posId = "PosId-" + j;
try
{
object value;
if (TryGetCachedObject(posId, out value))
recordReadCount++;
}
catch (Exception e)
{
Trace.WriteLine("AS%% - Exception - " + e.Message);
}
}
}
sw.Stop();
return sw.ElapsedMilliseconds;
}
} 
```

我有完全相同的逻辑从 SQL Server 检索数据。它创建了一个

```
sqlCommand = 'Select * from TableName where posId = 'someId'' 
```

这是结果...

```
SQL Server 2008 R2  Reading-1(ms)   Reading-2(ms)   Reading-3(ms)   Average Time in Seconds
 Iteration Count = 5    2528              2649            2665                 2.614
 Iteration Count = 10   5280              5445            5343                 5.356
 Iteration Count = 15   7978              8370            7800                 8.049333333
 Iteration Count = 20   9277              9643            10220                9.713333333

AppFabric                 Reading-1         Reading-2   Reading-3   Average Time in Seconds
Iteration Count = 5        10301            10160            10186                10.21566667
Iteration Count = 10       20130            20191            20650                20.32366667
Iteration Count = 15       30747            30571            30647                30.655
Iteration Count = 20       40448            40541            40503                40.49733333 
```

我在这里错过了什么吗？为什么这么慢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-25T19:36:29.767

不同之处在于网络开销。在您的 SQL 示例中，您跳过网络一次并选择 N 行。*在您的 AppFabric 示例中，您按记录*而不是批量跳过网络。这就是区别。为了证明这一点，将您的记录临时存储在 AppFabric 中作为列表并仅获取一次列表，或者使用 AppFabric 批量 API 在一个请求中将它们全部选中 - 这应该会造成很大的差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T17:44:53.133

这可能是由 .Net 的内置序列化引起的。

.Net 序列化利用反射，这反过来又具有**非常**差的性能。我建议研究使用自定义编写的序列化代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T11:12:20.703

我认为你的测试是有偏见的，你的结果不是最优的。

**关于分布式缓存**

*   本地缓存：您已禁用[本地缓存](http://msdn.microsoft.com/en-us/library/ee790983.aspx)功能。缓存对象总是从服务器获取；网络传输和反序列化是有代价的。
*   BulkGet ：[BulkGet](http://msdn.microsoft.com/en-us/library/jj613598.aspx)在与小对象一起使用时提高了性能，例如，在检索许多大小为 1 - 5KB 或更小的对象时。
*   无数据压缩：AppFabric 和缓存客户端之间无压缩。检查[这个](http://msdn.microsoft.com/en-us/library/hh351483.aspx)。

**关于你的测试**

另一个重要的事情是你没有测试同样的东西：一方面你测试 SELECT *，而另一方面你测试 N x GET ITEM。

# json - 使用 Freepascal\Lazarus JSON 库

> ID：12647236
> 
> 赞同：0
> 
> 时间：2012-09-28T20:52:17.037
> 
> 标签：json, freepascal, lazarus

我希望对使用 Lazarus\Freepascal JSON 解析有一点“简单”演示\解释。我在[这里](http://www.lazarus.freepascal.org/index.php/topic,18348.0.html)问了一个问题，但所有的回复都是“阅读这个”，没有一个真的能帮助我掌握，因为这些例子有点太深入了，我正在寻找一个非常简单的例子来帮助我理解如何有用。

简而言之，我的程序以 4096 字节的块读取一个无类型的二进制文件。然后将原始数据转换为 ASCII 并存储在字符串中。然后，它通过变量寻找某些模式，结果证明，这些模式是 JSON 数据结构。我目前已经使用 Pos 和 ExtractANSIString 等对解析进行了艰难的编码。但我已经了解到 Lazarus 和 FPC 有 JSON 库，即 fcl-json、fpjson、jsonparser、jsonscanner 等。

[https://bitbucket.org/reiniero/fpctwit/src](https://bitbucket.org/reiniero/fpctwit/src) http://fossies.org/unix/misc/fpcbuild-2.6.0.tar.gz:a/fpcbuild-2.6.0/fpcsrc/packages/fcl-json /src/ [http://svn.freepascal.org/cgi-bin/viewvc.cgi/trunk/packages/fcl-json/examples/](http://svn.freepascal.org/cgi-bin/viewvc.cgi/trunk/packages/fcl-json/examples/)

但是，我仍然无法弄清楚如何读取字符串变量并将其解析为 JSON 数据，然后访问这些 JSON 结构。

谁能给我一个非常简单的例子来帮助我前进？

到目前为止，我的代码（没有 JSON）是这样的：

```
try
  SourceFile.Position := 0;
  while TotalBytesRead < SourceFile.Size do
    begin 
      BytesRead := SourceFile.Read(Buffer,sizeof(Buffer));
      inc(TotalBytesRead, BytesRead);      
      StringContent := StripNonAsciiExceptCRLF(Buffer);    // A custom function to strip out binary garbage leaving just ASCII readable text     
      if Pos('MySearchValue', StringContent) > 0 then
          begin          
            // Do the parsing. This is where I need to do the JSON stuff 
```

...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T09:30:36.667

请参阅**parsedemo.pp**，特别*是 parsestring*。只需修改*doparse*例程以从 j:TJSonData 对象中提取您需要的任何信息。

simpledemo.pp演示了如何**剖析**jsondata 对象。

然后阅读**src/README.txt**文件。它似乎暗示了 jsonobject 的一系列属性，这些属性允许按名称获取字段。这仅适用于结构 json 对象，如数组和对象。

我确实同意对此进行演示将是一件好事。如果你成功了，请提交给mantis。

免责声明：我与 json 包无关，我快速浏览了（诚然 2.7.1）源代码。

# database - 检查两个表的值？

> ID：12647238
> 
> 赞同：0
> 
> 时间：2012-09-28T20:52:21.410
> 
> 标签：database, visual-studio-2010, visual-studio, datagridview

我正在为大学作业构建应用程序，我正在使用 Visual Basic 2010 和 Micrsoft Access 作为数据库。

我有一个表格，客户可以在其中订购产品，每个产品都有一个固定价格，例如 product1 是 1 英镑，但是有些客户会以更便宜的价格购买产品，所以我有一个“特价”表，特价表将包含行，包括'customerid' 'productid' 和 'specialprice'。

我需要知道如何显示价格，如果客户选择产品1，我需要我的应用程序首先检查他们是否有特价，如果不只显示正常价格，

谢谢，

杰克。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:05:22.193

如果客户没有特价，则为空

```
SELECT p.Price, c.CustomerID, sp.SpecialPrice, IFNULL(sp.SpecialPrice, p.Price) As UsedPrice
FROM Product p
LEFT JOIN SpecialPrice sp ON p.ProductID = sp.ProductID
AND sp.CustomerID = 123 
```

我的回答是基于 SQL Server 我希望你能把它翻译成 MSAccess。要点是将产品表加入到当前客户所在的特价表中。如果有特价，请使用它，否则使用产品中的价格

或在代码中

```
if(row["SpecialPrice"] != null) // if(row["SpecialPrice"] != DBNull.Value) --- instead
  price = row["SpecialPrice"];
else
  price = row["Price"]; 
```

# ruby-on-rails - Rails 3：未定义的 URL 帮助程序上的 respond_with 错误

> ID：12647239
> 
> 赞同：24
> 
> 时间：2012-09-28T20:52:23.390
> 
> 标签：ruby-on-rails

我现在有一个`Artwork`仅由 API 端点操作的模型。（您很快就会明白为什么这很重要）。这些 API 端点在我的`routes.rb`文件中声明如下：

```
namespace :api do
  namespace :v1, :defaults => { :format => :json } do
    resources :artworks, :only => [:create, :destroy, :index, :show, :update] 
```

这导致以下路线：

```
api_v1_artworks GET        /api/v1/artworks(.:format)                                             api/v1/artworks#index {:format=>:json}
                POST       /api/v1/artworks(.:format)                                             api/v1/artworks#create {:format=>:json}
api_v1_artwork  GET        /api/v1/artworks/:id(.:format)                                         api/v1/artworks#show {:format=>:json}
                PUT        /api/v1/artworks/:id(.:format)                                         api/v1/artworks#update {:format=>:json}
                DELETE     /api/v1/artworks/:id(.:format)                                         api/v1/artworks#destroy {:format=>:json} 
```

相关代码：

```
class Api::V1::ArtworksController < Api::V1::ApiController
  def create
    artwork = Artwork.create(artwork_params)

    respond_with artwork
  end 
```

**问题**

`#create`成功时，`respond_with`窒息：

```
`undefined method `artwork_url' for #<Api::V1::ArtworksController:0x007fea1b4c67f8>` 
```

它期望 HTTP Location 的助手是`artwork_url`. 我如何告诉它使用`api_v1_artwork_url`呢？我可以给 URL 助手起别名吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-09-28T21:16:43.460

在这种情况下，您需要为响应者指定命名空间。尝试：

```
respond_with :api, :v1, artwork 
```

# jquery - 动态内容鼠标悬停

> ID：12647242
> 
> 赞同：0
> 
> 时间：2012-09-28T20:52:28.460
> 
> 标签：jquery

我有一些用 json 字符串中的数据创建的 div。其中大部分是图像。在那些动态加载的图像上，并希望在鼠标悬停时显示 div 并在鼠标移出时隐藏。因此我使用了直播功能，在论坛上找到了它。鼠标悬停功能有效，但不会鼠标移出。因此，当我将鼠标悬停在一张图像上时，会显示 div，但是当我将鼠标移出时，div 仍然可见。对此有何建议？

我的代码

```
<script type="text/javascript">
    $('.product').live("hover", function() {
        $(this).find('.product').stop(false,true); // get the image where hovering
        $(this).find('div.caption').stop(false,true).fadeIn(100); // and fade in
    },
     function() {
        $(this).find('.product').stop(false,true); // on mouse leave hide it  
        $(this).find('div.caption').stop(false,true).fadeOut(100); // fade out
     });
</script> 
```

**更新的答案** 感谢下面的帮助，我找到了解决方案。

```
$(".productsGrid .product").live("mouseenter", function() {$(this).find('.product').stop(false,true);
$(this).find('div.caption').stop(false,true).fadeIn(100);})
$(".productsGrid .product").live("mouseleave", function() { $(this).find('.product').stop(false,true);   
$(this).find('div.caption').stop(false,true).fadeOut(100);}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:08:55.637

问题是`live`它只接受一个函数参数，而不是`hover`函数那样的 2 个。使用`hover`with`live`基本上只是将一个函数绑定到`mouseenter`and `mouseleave`。

[您可以在此处](https://stackoverflow.com/questions/2262480/jquery-live-hover)查看解释和解决方案。

但是，除非您使用的是 1.7 之前的 jquery 版本，否则您不应该使用`live`它，因为它已被弃用。您应该改用`on`.

您的代码将如下所示：

```
$(STATIC ANCESTOR).on({ 
        mouseenter: 
           function() 
           { 

           }, 
        mouseleave: 
           function() 
           { 

           } 
       }, ".product"
    ); 
```

Where`STATIC ANCESTOR`被替换`.product`为未动态加载的元素的祖先元素。如果需要`document`可以使用，但只能作为最后的手段使用。

# c# - 定时器对象和BackgroundWorker

> ID：12647243
> 
> 赞同：1
> 
> 时间：2012-09-28T20:52:36.817
> 
> 标签：c#, winforms, multithreading, timer, backgroundworker

我对 .NET 中的线程非常陌生，并且对 Java 中的线程的接触有限。简而言之，我有一个有`System.Windows.Forms.Timer`对象的表单。计时器每 1000 毫秒计时一次。事件处理程序仅检查布尔类变量（即 processingResponseFiles）以确定处理请求文件的当前操作是否正在进行中。如果不在进行中，它应该处理任何请求文件。否则，它应该什么都不做。

该`ProcessRequestFiles`方法查看请求，然后运行 ​​a`BackgroundWorker`来执行工作。我正在努力解决的问题是 processingResponseFiles 的值始终为 false，即使我在 ProcessingRequestFiles 方法的第一条语句中将其分配为 true。有人可以告诉我为什么 processingResponseFiles 的值总是假的，即使我在`ProcessRequestFile()`方法中设置它？

我需要保护此方法，使其不会被多次执行。

```
private void timerRequestTimer_Tick(object sender, EventArgs e)
{
    if (!processingResponseFiles)
    {
        ProcessRequestFile();                
    }

private void ProcessRequestFile()
{
    processingResponseFiles = true;

   // Process Request Files
   // If request type is Synchronize Customers
   // Run thread that synchronizes customers
   // If request type is Synchronize Items
   // Run thread that synchronizes items

   processingResponseFiles = false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:59:25.337

不是很清楚，注释掉了太多东西，但显然需要`false`在 BackgroundWorker.RunWorkerCompleted 事件处理程序中将标志重置回。只有这样你才知道工作已经完成。或者只使用 BackgroundWorker.IsBusy 属性。

# antlr - ANTLR中语法的简单程序化生成和编译？

> ID：12647244
> 
> 赞同：0
> 
> 时间：2012-09-28T20:52:38.173
> 
> 标签：antlr

我想以编程方式以字符串的形式获取语法，并为其生成 Java 作为字符串或字符串。我想在内存中完成这一切，不涉及任何文件。我查看了 org.antlr.Tool 源代码，但我希望有一些更简单的方法来做我想做的事情，而不是在没有文件的情况下重写 Tool。有什么东西已经存在了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T06:49:29.993

> 有什么东西已经存在了吗？

不，不是AFAIK。不在 ANTLR 的公共 API 中，也没有一些现有的 3 ^(rd)方工具可以做到这一点。

# zend-framework2 - Zend Framework 2 Zend_DB MasterSlaveFeature

> ID：12647245
> 
> 赞同：1
> 
> 时间：2012-09-28T20:52:39.163
> 
> 标签：zend-framework2, zend-db, tablegateway

该文档提到了通过将 MasterSlaveFeature 传递给 TableGateway 构造函数以及从适配器作为 MasterSlaveFeature 的参数来进行主从的能力。我的问题是如何在实例化 TableGateway 对象时访问该从适配器。

根据快速入门，我正在主要的全局和本地配置文件中设置我的主文件。我将如何配置从适配器以及如何设置多个从适配器？

是否有一个如何做到这一点的工作示例？

更新：我在这方面取得了一些进展。在全局配置文件中，我添加了另一个名为 slave 的数组键，并在那里输入了连接信息。然后我创建了一个 SlaveAdapterServiceFactory 类，它模仿 Zend\Db\Adapter\AdapterServiceFactory 的行为，但获取“slave”配置键值而不是“db”。然后，在我进行主适配器的构造函数注入的模块配置中，我还获取从适配器并将其作为构造函数参数传递给我的模型表，并传递给新的 MasterSlaveFeature 实例。我还必须更改我的模型表类以查找在构造函数中传递的 Feature 内容。由于模态表类扩展了 AbstractTableGateway，我希望它知道如何处理该功能。希望这个假设是正确的。这一切听起来真的很混乱！这是一些代码。首先是 config/autoload 目录中的 global.php：

```
return array(
    'db' => array(
        'driver'         => 'Pdo',
        'dsn'            => 'mysql:dbname=zf2test;host=one.host.com',
        'driver_options' => array(
            PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES \'UTF8\''
        ),
    ),
    'slave' => array(
        'driver'         => 'Pdo',
        'dsn'            => 'mysql:dbname=zf2test;host=two.host.com',
        'driver_options' => array(
            PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES \'UTF8\''
        ),
    ),
    'service_manager' => array(
        'factories' => array(
            'Zend\Db\Adapter\Adapter'
                => 'Zend\Db\Adapter\AdapterServiceFactory',
            'My\Db\Adapter\SlaveAdapter'
                => 'My\Db\Adapter\SlaveAdapterServiceFactory'
        ),
    )    
); 
```

这是模块的 module.config.php 文件中的代码：

```
return array(
    'service_manager' => array(
        'factories' => array(
            'Album\Model\AlbumTable' =>  function($sm) {
                $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
                $slaveAdapter = $sm->get('My\Db\Adapter\SlaveAdapter');
                $table = new AlbumTable($dbAdapter, new MasterSlaveFeature($slaveAdapter));
                return $table;
            }
        )
    )
); 
```

我没有机会测试查询是否真的进入了正确的连接，但我没有收到任何错误。

另一个问题是如何自动将这些适配器传递给任何创建的模型，而不必为您实例化的每个模型执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:17:50.927

这应该可以帮助您：[MasterSlaveFeature How-To](https://stackoverflow.com/questions/13674199/masterslavefeature-how-to)

然而，在 ZF2 的这个领域与当前的开发人员交谈似乎确实存在一个错误。我已经根据他的建议提交了一份报告，所以一旦解决了，我展示的示例应该可以工作，并结合你所拥有的 =)

# c# - 如何将 XtraUserControl 运行到 SplitContainerControl

> ID：12647248
> 
> 赞同：1
> 
> 时间：2012-09-28T20:52:47.867
> 
> 标签：c#, devexpress

我的表单中有一个 SplitContainerControl ，它包含面板（panel1 和 panel2），面板 1 包含一个 NavBarControl 。我创建了一个包含一些控件的 XtraUserControl，当我单击 NavBarControl 中的某个项目时，我希望将此 XtraUserControl 运行到此 SplitContainerControl 的 panel2 中，但我不知道允许我这样做的方法！

当我单击 NavBarControl 中的某个 Item 时，这是允许我运行一些代码的事件：

```
private void listeLivres_LinkPressed(object sender, DevExpress.XtraNavBar.NavBarLinkEventArgs e)
        {
            // Some Code Here
        } 
```

如果没有办法做到这一点，是否有任何其他解决方案，例如允许我包含 XtraUserControl 的容器

# ios - NSNumber 到 NSString 转换的自定义格式

> ID：12647253
> 
> 赞同：0
> 
> 时间：2012-09-28T20:53:13.493
> 
> 标签：ios, nsstring, nsnumber, nsnumberformatter

我的应用程序上有一个`UITextField`接收号码的 a。

我希望这个数字以特定格式表示，如下所示：`(62) 1234 1234`

问题是：我已经控制了方法`-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string`，但我不知道如何制作这个“面具”

目前我正在这样做：

```
string = [textField.text stringByReplacingCharactersInRange:range withString:string];
string = [[string componentsSeparatedByCharactersInSet:[[NSCharacterSet decimalDigitCharacterSet] invertedSet]] componentsJoinedByString:@""];

NSNumberFormatter * f = [[NSNumberFormatter alloc] init];
[f setNumberStyle:NSNumberFormatterDecimalStyle];
NSNumber * myNumber = [f numberFromString:string];
NSLog(@"%@", myNumber); 
```

在这段代码的末尾，我有两件事：

1.  string ：我的文本的字符串表示形式（例如`6212341234`作为 a `NSString`）
2.  myNumber ：此字符串的编号（例如`6212341234`作为 a `NSNumber`）

我怎样才能创建这个字符串：`(62) 1234 1234`基于`myNumber`或`string`？

**编辑**

回答 rdelmar 问题：

该数字可以有 10 或 11 个数字，我打算像这样分开它们： `(62) 1234 1234`或`(62) 12345 1234`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T16:48:49.117

你可以用`NSRegularExpression`...

```
- (NSString *) formattedString:(NSString *)inputString
{
    NSError *error = NULL;
    NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"(?:([0-9]{2})([0-9]{5})([0-9]{4}))|(?:([0-9]{0,2}+)([0-9]{0,4}+)([0-9]{0,4}+))" options:0 error:&error];
    NSArray *components = [NSArray array];
    NSArray *matches = [regex matchesInString:inputString options:0 range:NSMakeRange(0, [inputString length])];
    NSTextCheckingResult *match = [matches objectAtIndex:0];
    for ( NSUInteger i = 1; i <= 3; ++i )
    {
        NSRange range = [match rangeAtIndex:i];
        if ( NSNotFound == range.location )
        {
            break;
        }
        components = [components arrayByAddingObject:[inputString substringWithRange:range]];
    }
    if ( 0 == [components count] )
    {
        for ( NSUInteger i = 4; i <= 6; ++i )
        {
            NSRange range = [match rangeAtIndex:i];
            components = [components arrayByAddingObject:[inputString substringWithRange:range]];
        }
    }
    return [NSString stringWithFormat:@"(%@) %@ %@",
            [components objectAtIndex:0],
            [components objectAtIndex:1],
            [components objectAtIndex:2]];
}

- (void) testFormatting
{
    NSLog(@"%@", [self formattedString:@"62123451234"]);
    NSLog(@"%@", [self formattedString:@"6212341234"]);
    NSLog(@"%@", [self formattedString:@"621234123"]);
    NSLog(@"%@", [self formattedString:@"62123412"]);
    NSLog(@"%@", [self formattedString:@"6212341"]);
    NSLog(@"%@", [self formattedString:@"621234"]);
    NSLog(@"%@", [self formattedString:@"62123"]);
    NSLog(@"%@", [self formattedString:@"6212"]);
    NSLog(@"%@", [self formattedString:@"621"]);
    NSLog(@"%@", [self formattedString:@"62"]);
    NSLog(@"%@", [self formattedString:@"6"]);
} 
```

调用该`testFormatting`方法的结果是：

```
(62) 12345 1234
(62) 1234 1234
(62) 1234 123
(62) 1234 12
(62) 1234 1
(62) 1234 
(62) 123 
(62) 12 
(62) 1 
(62)  
(6) 
```

这样，您可以将中间字符串传递给格式化程序，它会尝试做正确的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:13:07.263

你可以这样做（对于 10 位数字）：

```
-(NSString *)formatString:(NSString *) input {
    NSString *part1 = [NSString stringWithFormat:@"(%@)",[input substringToIndex:2]];
    NSString *part2 = [input substringWithRange:NSMakeRange(2, 4)];
    NSString *part3 = [input substringWithRange:NSMakeRange(6, 4)];
    NSString *formatted = [NSString stringWithFormat:@"%@ %@ %@",part1,part2,part3];
    return formatted;

} 
```

要处理 10 位或 11 位数字，您必须放入 if 子句来测试长度，然后相应地更改 part2 和 part3 的范围。

编辑后：这样的事情怎么样。我认为这是可以做到的。它会在您键入时将其分解为 (xx) xxxx xxxx，如果您键入另一个数字，它会将其分解为 (xx) xxxx xxxx。任何进一步的输入都将被忽略。

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    if (textField.text.length == 0)
     textField.text = [NSString stringWithFormat:@"(%@",textField.text];

    if (textField.text.length == 3)
        textField.text = [NSString stringWithFormat:@"%@) ",textField.text];

    if (textField.text.length == 9)
        textField.text = [NSString stringWithFormat:@"%@ ",textField.text];

    if (textField.text.length == 14) {
        NSString *part1 = [textField.text substringToIndex:9];
        part1 = [part1 stringByAppendingString:[textField.text substringWithRange:NSMakeRange(10, 1)]];
        NSString *part2 = [textField.text substringWithRange:NSMakeRange(11, 3)];
        textField.text = [NSString stringWithFormat:@"%@ %@",part1,part2];
    }

    if (textField.text.length > 14)
        return NO;

    return YES;
} 
```

# python - 欧拉计划 17

> ID：12647254
> 
> 赞同：3
> 
> 时间：2012-09-28T20:53:19.193
> 
> 标签：python

我一直在尝试解决 Euler 17 并且遇到了一些麻烦。该问题的定义是：

> 如果数字 1 到 5 用单词写出：一、二、三、四、五，那么总共使用了 3 + 3 + 5 + 4 + 4 = 19 个字母。
> 
> 如果用文字写出从 1 到 1000（一千）的所有数字，将使用多少个字母？
> 
> 注意：不要计算空格或连字符。例如，342（三百四十二）包含 23 个字母，而 115（一百一十五）包含 20 个字母。在写出数字时使用“and”符合英国的用法。

我是用 Python 写的，代码看了三四遍还是看不出问题出在哪里。它很长（我刚开始学习python，以前从未编码过），但我基本上只是定义了不同的函数，它们采用不同的位数并计算每个字母的数量。我最终得到 21254，看起来实际答案是 21124，所以我正好相差 130。任何帮助将不胜感激。

```
# create dict mapping numbers to their
# lengths in English

maps = {}
maps[0] = 0
maps[1] = 3
maps[2] = 3
maps[3] = 5
maps[4] = 4
maps[5] = 4
maps[6] = 3
maps[7] = 5
maps[8] = 5
maps[9] = 4
maps[10] = 3
maps[11] = 6
maps['and'] = 3
maps['teen'] = 4
maps[20] = 6
maps[30] = 6
maps[40] = 5
maps[50] = 5
maps[60] = 6
maps[70] = 7
maps[80] = 6
maps[90] = 6
maps[100] = 7
maps[1000] = 8

# create a list of numbers 1-1000
def int_to_list(number):
    s = str(number)
    c = []
    for digit in s:
        a = int(digit)
        c.append(a)
    return c  # turn a number into a list of its digits
def list_to_int(numList):
    s = map(str, numList)
    s = ''.join(s)
    s = int(s)
    return s

L = []
for i in range(1,1001,1):
    L.append(i)

def one_digit(n):
    q = maps[n]
    return q
def eleven(n):
    q = maps[11]
    return q
def teen(n):
    digits = int_to_list(n) 
    q = maps[digits[1]] + maps['teen']
    return q
def two_digit(n):
    digits = int_to_list(n)
    first = digits[0]
    first = first*10
    second = digits[1]
    q = maps[first] + one_digit(second)
    return q
def three_digit(n):
    digits = int_to_list(n)
    first = digits[0]
    second = digits[1]
    third = digits[2]

    # first digit length
    f = maps[first]+maps[100]

    if second == 1 and third == 1:
        s = maps['and'] + maps[11]
    elif second == 1 and third != 1:
        s = digits[1:]
        s = list_to_int(s)
        s = maps['and'] + teen(s)
    elif second == 0 and third == 0:
        s = maps[0]
    elif second == 0 and third != 0:
        s = maps['and'] + maps[third]
    else:
        s = digits[1:]
        s = list_to_int(s)
        s = maps['and'] + two_digit(s)

    q = f + s
    return q
def thousand(n):
    q = maps[1000]
    return q

# generate a list of all the lengths of numbers

lengths = []

for i in L:
    if i < 11:
        n = one_digit(i)
        lengths.append(n)
    elif i == 11:
        n = eleven(i)
        lengths.append(n)
    elif i > 11 and i < 20:
        n = teen(i)
        lengths.append(n)
    elif i > 20 and i < 100:
        n = two_digit(i)
        lengths.append(n)
    elif i >= 100 and i < 1000:
        n = three_digit(i)
        lengths.append(n)
    elif i == 1000:
        n = thousand(i)
        lengths.append(n)
    else:
        pass

# since "eighteen" has eight letters (not 9), subtract 10
sum = sum(lengths) - 10
print "Your number is: ", sum 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T20:57:05.520

### 解释差异

您的代码充满了错误：

1.  这是错误的：

    ```
    maps[60] = 6 
    ```

    对错误的贡献：+100（因为它影响 60 到 69、160 到 169、...、960 到 969）。

2.  有几个少年误会了：

    ```
    >>> teen(12)
    7
    >>> teen(13)
    9
    >>> teen(15)
    8
    >>> teen(18)
    9 
    ```

    对错误的贡献：+40（因为它影响 12、13、...、112、113、...、918）

3.  以及任意数量的 x10 形式：

    ```
    >>> three_digit(110)
    17 
    ```

    对错误的贡献：9（因为 110、210、... 910）

4.  数字 20 不计入（您考虑`i < 20`但`i > 20`不考虑`i == 20`）。

    对误差的贡献：-6

5.  数字 1000 用英语写成“一千”，但是：

    ```
    >>> thousand(1000)
    8 
    ```

    对误差的贡献：-3

6.  最后减去 10 以弥补其中一个错误。

    对误差的贡献：-10

总误差：100 + 40 + 9 - 6 - 3 - 10 = 130。

### 你怎么能避免这些错误

通过尝试直接处理字母计数，您很难检查自己的工作。“一百一十”又有多少个字母？是17还是16？如果您采用了这样的策略，那么测试您的工作会容易得多：

```
unit_names = """zero one two three four five six seven eight nine ten
                eleven twelve thirteen fourteen fifteen sixteen seventeen
                eighteen nineteen""".split()
tens_names = """zero ten twenty thirty forty fifty sixty seventy eighty
                ninety""".split()

def english(n):
    "Return the English name for n, from 0 to 999999."
    if n >= 1000:
        thous = english(n // 1000) + " thousand"
        n = n % 1000
        if n == 0:
            return thous
        elif n < 100:
            return thous + " and " + english(n)
        else:
            return thous + ", " + english(n)
    elif n >= 100:
        huns = unit_names[n // 100] + " hundred"
        n = n % 100
        if n == 0:
            return huns
        else:
            return huns + " and " + english(n)
    elif n >= 20:
        tens = tens_names[n // 10]
        n = n % 10
        if n == 0:
            return tens
        else:
            return tens + "-" + english(n)
    else:
        return unit_names[n]

def letter_count(s):
    "Return the number of letters in the string s."
    import re
    return len(re.findall(r'[a-zA-Z]', s))

def euler17():
    return sum(letter_count(english(i)) for i in range(1, 1001)) 
```

使用这种方法可以更轻松地检查您的结果：

```
>>> english(967)
'nine hundred and sixty-seven' 
```

# regex - Perl：用于查找每行第一次出现的正则表达式？（编辑板）

> ID：12647258
> 
> 赞同：0
> 
> 时间：2012-09-28T20:53:49.770
> 
> 标签：regex

我正在使用 EditPad，但通常 Perl 正则表达式适用于它。我试图在编辑板中只找到每行第一次出现的模式。

例如：在 947319949194 中搜索数字 1 我只希望找到第一个 1，而不是第二个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:05:53.000

我相信（在 Perl 中）每行的第一次出现`1`应该由正则表达式找到`/^[^1\n\r]*(1)/m`

# math - 如何在中心附近的矩形内获得一个随机点？

> ID：12647259
> 
> 赞同：0
> 
> 时间：2012-09-28T20:54:08.027
> 
> 标签：math

我知道如何在矩形内获得一个随机点，但我知道我需要知道如何获得一个随机点，如果它靠近中心，它将更有可能被选中。它应该是某种形式的指数方程，但我无法弄清楚。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:02:01.297

听起来您正在尝试计算游戏中的子弹散布之类的东西。

由于您知道要在其中生成所有命中的矩形，因此您也知道该矩形的中心。

我建议您从该点计算水平和垂直偏移的随机值。通过将函数应用于您获得的随机值，您可以使它们看起来更聚集。

我不知道性能是否对您来说是一个密切关注的问题，但平方根是一个这样的函数，您可以应用它来将您的值聚集到接近零的位置。其他替代方案包括曲线，例如 y = ln(x)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T20:56:58.770

将您的随机值视为极​​坐标，而不是笛卡尔坐标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:05:55.990

您是指以矩形中心为中心的极坐标上的正态分布吗？

![正态分布](../Images/42b373d80465d07ed4a5836516f0d3ec.png)

![在此处输入图像描述](../Images/682f7f508fa2375250586fd1d4e03d60.png)

![在此处输入图像描述](../Images/76fd9f9cd8f6d3df4f99dd045cf9d502.png)

# html - 使用 CSS 将侧边栏定位在内容旁边

> ID：12647260
> 
> 赞同：0
> 
> 时间：2012-09-28T20:54:11.563
> 
> 标签：html, css, sidebar

我正在尝试创建一个位于内容 div 旁边的侧边栏，但它位于内容 div 下方，它位于正确的 x 位置而不是正确的 y 位置。

**HTML：**

```
<body>
    <div id="framediv">

        <div id="headerdiv">
        </div>

        <div id="content" class="container">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent fringilla adipiscing velit, a pharetra sem dictum vel. Aliquam varius porta est, vitae pulvinar nunc adipiscing in. Maecenas sem eros, gravida nec blandit vel, aliquam at dui. Aliquam ante est, lacinia id laoreet ac, convallis ac magna. Maecenas rhoncus ligula vitae mauris volutpat sed dapibus lectus fringilla. Nam orci metus, molestie eu placerat sit amet, faucibus in libero. Nunc tristique, elit vitae tincidunt rutrum, odio erat blandit nibh, eu facilisis sapien dolor rhoncus risus. Ut eu velit lectus. Sed vitae nisl orci. Nulla vel nisl ante. Donec sit amet nulla eget massa euismod ultrices vitae at nisi. Donec tempor justo auctor libero dapibus viverra. Cras commodo fermentum nisi. Maecenas porttitor euismod metus lacinia sodales. Aliquam egestas ligula purus, id sollicitudin risus. Nullam vel odio et libero viverra blandit vel et dolor.

            Nullam mauris dui, consequat a placerat eu, semper non mi. Nam in leo vel lorem adipiscing commodo. Duis vestibulum erat vel felis tincidunt in congue ipsum rutrum. Sed in ipsum ligula. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris pharetra nisi eget arcu malesuada at dapibus elit varius. Morbi sodales, justo fermentum lobortis elementum, orci turpis vehicula nisl, quis laoreet sapien libero a leo. Aenean ac arcu augue, vitae pellentesque ipsum. Ut nec mauris at nisl luctus tempor a sed turpis. Pellentesque in odio libero, sit amet tincidunt nisl. Duis dictum tortor vitae sem sagittis in molestie nisl interdum. Maecenas mollis adipiscing augue, eget accumsan justo ultrices a. Suspendisse scelerisque justo et nisl consectetur a varius lacus sodales. Duis accumsan iaculis nulla, non pretium metus venenatis et. Sed gravida elementum ipsum sed aliquet.

            Vestibulum tincidunt pulvinar aliquet. Nullam bibendum vulputate diam quis mattis. Etiam mollis dui eu quam feugiat pharetra. Donec non tempus eros. Fusce eleifend magna eu lorem imperdiet bibendum rhoncus eget odio. Etiam adipiscing nibh sit amet augue elementum tempus. Etiam hendrerit massa a augue laoreet vitae pretium enim aliquet. Mauris malesuada lorem vitae neque pretium convallis. Sed condimentum semper ipsum, consectetur imperdiet eros interdum eu. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Donec adipiscing nisi in erat feugiat tempor. Nunc tincidunt neque non nisl tristique quis ornare elit ornare.

            Praesent nec augue ligula, quis iaculis diam. Nam eget felis est, eget pellentesque lectus. Ut suscipit varius magna, ac vestibulum risus egestas ac. Quisque id sapien sed leo luctus faucibus in non leo. Integer sit amet pellentesque velit. Vivamus convallis, lacus nec tincidunt viverra, nunc velit aliquam nisi, eu pretium tellus nisl eget eros. Etiam dolor leo, feugiat vel faucibus ac, ullamcorper quis turpis. Mauris nec felis elit. Donec dignissim ullamcorper arcu. Proin tempor, dui vel malesuada viverra, lacus mauris ullamcorper lacus, eu convallis dolor justo non massa. Maecenas volutpat, leo gravida eleifend pharetra, dolor mauris tempor odio, quis facilisis tellus nisl quis sapien. Donec quam mauris, malesuada id iaculis ut, pellentesque non mauris. Nullam interdum justo id nunc tempor sed consequat quam venenatis.

            Curabitur ipsum augue, posuere at adipiscing nec, rutrum in nisi. Ut mattis placerat est aliquam vulputate. Nullam faucibus, libero in facilisis auctor, lectus metus suscipit ligula, quis sollicitudin ligula erat sit amet nisi. Suspendisse et suscipit lectus. Sed fermentum porta lorem, vel congue tortor sollicitudin molestie. Nulla imperdiet purus non velit ornare vestibulum id at massa. Curabitur lorem urna, fermentum ut suscipit sed, pretium sed ante. Nullam ligula ante, aliquam at blandit ac, aliquam in velit. Cras nisl libero, iaculis at rutrum ac, mollis nec tortor. Aenean dignissim viverra molestie. Vivamus ultricies sem purus, tempor pharetra elit. Sed placerat est at turpis eleifend accumsan. Cras metus ante, imperdiet et suscipit ut, interdum eget est. In rutrum imperdiet mi in consectetur. 
        </div>

        <div id="sidebar" align="center" class="container">
            <p>dvsdvs</p>
        </div>

    </div>
</body> 
```

**CSS：**

```
#menudiv{
    display:inline-block;
    float:none;
    padding-bottom:20px;
}

#html, body {
  top: 0px;
  right: 0px;
  bottom: 0px;
  left: 0px;
  width:980px;
  height: 100%;
  margin: auto;
}
#headerdiv{
    width:950px;
    -webkit-box-shadow:10px 10px 20px #000;
    -moz-box-shadow:10px 10px 20px #000;
}

#content.container{
    height:100%;
    width: 640px;
    padding-top:50;
    margin-top:50;
    padding-left: 10px;
    padding-right: 10px;
    padding-left: 10px;
    padding-bottom: 10px;
    border:thin;
    border-color:#CCC;
    border-style:solid;
    -webkit-box-shadow:10px 10px 20px #000;
    -moz-box-shadow:10px 10px 20px #000;
}

#sidebar{
    position:absolute
float:left;
    float:right;
    top:250px;
    height:100%;
    width: 280px;
    border:thin;
    border-color:#CCC;
    border-style:solid;
    -webkit-box-shadow:10px 10px 20px #000;
    -moz-box-shadow:10px 10px 20px #000;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:02:51.907

在这里`#html, body`你不需要`#`前面的'' `html`。`#sidebar`你有

```
float:left;
float:right; 
```

...不要认为你有任何问题，因为你将它定位为绝对。JSFiddle 也会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:13:36.633

用 DIV 包装你的内容

```
<div id="content" class="container">
        <div id="maincontent">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent fringilla adipiscing               
        velit, a pharetr
        </div>

        <div id="sidebar" align="center" class="container">
          <p>dvsdvs</p>
        </div>

 </div>

.container#maincontent {float:left: width:75%} //75% minus paddings minus margins minus borders
.container#sidebar {float:right; width:25%} //25% minus paddings minus margins minus borders 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:00:59.833

在您的容器中也包括浮动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:01:37.927

你的问题似乎有点矛盾......你的一些代码也是如此。

如果您只是希望侧边栏位于内容 div 的右侧，那么您可以在代码中将侧边栏 div 移动到内容 div 上方，并为其分配“float: right”。

如果通过“但它位于内容 div 下方”您指的是代码而不是视觉布局，那么您可以将内容 div 浮动到左侧并删除侧边栏上的浮动（或浮动：右侧）。

我还注意到，在您的#sidebar css 中，您为左右两边声明了冲突的浮动。

# php - PHP fopen() 内存效率和使用情况

> ID：12647261
> 
> 赞同：6
> 
> 时间：2012-09-28T20:54:11.983
> 
> 标签：php, memory, fopen

我正在构建一个系统来创建从几 Kb 到大约 50Mb 的文件，这个问题更多是出于好奇。我在网上找不到任何答案。

如果我使用

```
$handle=fopen($file,'w'); 
```

在我调用之前存储的 $handle 在哪里

```
fclose($handle); 
```

? 它是存储在系统内存中还是某个临时文件中？

其次，我正在使用一个循环构建文件，该循环一次需要 1024 个字节的数据，并且每次将数据写入为：

```
fwrite($handle, $content); 
```

然后它调用

```
fclose($handle); 
```

当循环完成并写入所有数据时。但是，使用这样的循环会更有效还是更友好？

```
$handle = fopen($file, 'a');
fwrite($handle, $content);
fclose($handle); 
```

?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T20:59:00.427

在 PHP 术语中，`fopen()`（以及许多其他函数）返回一个[*资源*](http://php.net/manual/en/language.types.resource.php)。引用`$handle`与您的`$file`.

[资源](http://php.net/manual/en/language.types.resource.php)是内存中的对象，它们不会被 PHP 持久化到文件系统中。

您当前的方法是两种选择中更有效的一种。一次又一次地打开、写入和关闭同一个文件的效率低于只打开一次、多次写入然后关闭它的效率。打开和关闭文件需要设置输入和输出缓冲区并分配其他内部资源，这些都是相对昂贵的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T20:58:55.000

您的文件句柄只是另一个内存引用，并且像其他程序变量和资源一样存储在堆栈内存中。同样在文件 I/O 方面，打开和关闭一次，根据需要多次写入 - 这是最有效的方式。

```
$handle = fopen($file, 'a'); //open once
while(condition){
  fwrite($handle, $content); //write many
}
fclose($handle); //close once 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:05:21.443

1.  根据[PHP DOCS](http://ru2.php.net/manual/en/resource.php) fopen() 创建一个流，它是一个`File handle`. 它与文件系统中的文件相关联。

2.  `File handle`每次需要再写 1024 个字节时 创建新的会非常慢。

# android - 选择上下文菜单选项后在地图上显示地点

> ID：12647262
> 
> 赞同：1
> 
> 时间：2012-09-28T20:54:34.590
> 
> 标签：android, map, contextmenu, mapactivity, geopoints

我正在使用谷歌地图制作一个简单的应用程序，我在地图中间有一个上下文菜单，我想在选择其中一个上下文菜单选项时显示地点（菜单项有侦听器，选择后应该触发请求用于网络服务，然后在地图上显示结果）。如果我将上下文菜单活动的参数传递给 mapactivity 并在 mapactivity onResume() 上检查它，那么正确的方法是什么？还是有一些更简单的方法？如果您有一些书面指南或代码示例，我会更高兴。

ps 在性能方面，因为我想将 web 服务结果存储到 SQLite 实例，我应该在哪里将结果插入数据库？

# python - pip 安装后 virtualenvwrapper.sh 在哪里？

> ID：12647266
> 
> 赞同：147
> 
> 时间：2012-09-28T20:54:49.737
> 
> 标签：python, macos, virtualenv, pip, virtualenvwrapper

我正在尝试在 OSX 上设置 virtualenvwrapper，我发现的所有说明和教程都告诉我将源命令添加到 .profile，指向 virtualenvwrapper.sh。我检查了所有 python 和 site-packages 目录，但找不到任何 virtualenvwrapper.sh。这是我需要单独下载的东西吗？pip没有正确安装吗？

这是 /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/virtualenvwrapper 的内容：

```
hook_loader.py      hook_loader.pyc     project.py      project.pyc     user_scripts.py     user_scripts.pyc 
```

如您所见，没有 virtualenvwrapper.sh。它在哪里？

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2012-09-28T22:11:23.790

您可以使用以下`find`命令搜索文件：

`find / -name virtualenvwrapper.sh`

这将从根目录搜索文件的所有目录。

* * *

在 ubuntu 12.04 LTS 上，通过 pip 安装，它安装到

`/usr/local/bin/virtualenvwrapper.sh`

* * *

在 ubuntu 17.04 上，以普通用户身份通过​​ pip 安装，它被安装到

`~/.local/bin/virtualenvwrapper.sh`

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2013-05-23T04:42:40.570

你已经试过了吗？

```
$ which virtualenvwrapper.sh 
```

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2013-07-27T12:46:47.893

我刚刚用 pip 重新安装了它。

```
sudo pip uninstall virtualenvwrapper
sudo pip install virtualenvwrapper 
```

这次它把它放在/usr/local/bin 中。

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2017-01-16T12:43:24.513

**virtualenvwrapper.sh** 存储/定位的确切路径 *因操作系统而异*。即使在相同的操作系统中，它也会因*版本而异。*所以我们需要一个适用于所有操作系统版本的通用解决方案。

*我发现找到它的路径的最简单方法是*：做

```
pip uninstall virtualenvwrapper 
```

这将提示确认。说“否”但确认的第一行显示 virtualenvwrapper.sh 的路径（如果您说“是”，提示将提供它将删除的文件列表。此列表中的第一个条目包含您机器中 virtualenvwrapper.sh 的路径）

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-03-28T09:32:20.687

或者，像我一样..只需卸载 virtualenvwrapper

> sudo pip 卸载 virtualenvwrapper

然后用 easy_install 安装

> sudo easy_install virtualenvwrapper

这次我发现安装了文件“ **/usr/local/bin/virtualenvwrapper.sh** ”...在此之前，即使通过此命令，我也没有在任何地方找到该文件

> 查找 / -name virtualenvwrapper.sh

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-11-07T07:19:00.987

在 Mac 操作系统上

```
which virtualenvwrapper.sh 
```

你懂得

```
/Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenvwrapper.sh 
```

你可以

```
sudo ln /Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenvwrapper.sh /usr/local/bin/virtualenvwrapper.sh 
```

在你的`.bash_profile`

```
source /usr/local/bin/virtualenvwrapper.sh 
```

**或者**你可以

```
source /Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenvwrapper.sh 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-02-22T23:20:30.220

在 OS X 10.8.2 和 Python 2.7 中：

`/Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenvwrapper.sh`

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-01-10T06:17:27.350

在 OSx EI 队长中，我将 virtualenvwrapper 安装为

```
sudo pip3 install virtualenvwrapper 
```

，但是我在 中找不到 virtualenvwrapper.sh ，`/user/local/bin`它终于在`/Library/Frameworks/Python.framework/Versions/3.4/bin/virtualenvwrapper.sh`

`ln -s /Library/Frameworks/Python.framework/Versions/3.4/bin/virtualenvwrapper.sh /usr/local/bin/virtualenvwrapper.sh`，以及您可以按照官方文档中的设置指南进行的所有操作。祝你好运！

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-07-07T15:03:09.643

对我来说，它在：

```
~/Library/Python/2.7/bin/virtualenvwrapper.sh 
```

（使用 OS X，需要`pip install --user`安装）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-11-30T16:57:50.343

我也有同样的问题。如果您有旧版本的 virtualenvwrapper，那么 pip 将无法工作。

[从http://pypi.python.org/pypi/virtualenvwrapper/3.6](http://pypi.python.org/pypi/virtualenvwrapper/3.6)下载 src 并安装 python setup.py。然后问题就解决了。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2013-09-28T14:22:51.510

对于基于 RPM 的发行版（如 Fedora 19），运行`sudo pip install virtualenvwrapper`命令后，您可以在以下位置找到该文件：

```
/usr/bin/virtualenvwrapper.sh 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-11-16T20:35:41.043

使用普通用户在 Ubuntu 15.10 上使用 pip 安装它`~/.local/bin/virtualenvwrapper.sh`，我通过运行找到了它：

`$ find / -name virtualenvwrapper.sh 2>/dev/null`

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-10-28T02:25:22.433

使用

```
find / -name virtualenvwrapper.sh 
```

我得到了大量的“权限被拒绝”，以及文件位置的一个打印输出。我错过了它，直到我用 pip 再次卸载/安装它时找到该文件位置。

如果你很好奇，它在

```
/usr/local/share/python/virtualenvwrapper.sh 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-08-27T10:41:31.230

```
/usr/share/virtualenvwrapper/virtualenvwrapper.sh 
```

我已经在 Ubuntu 16.04 上安装了它，它导致了这个位置。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-05-14T11:39:48.790

我可以在使用 virtualenvwrapper-4.8.4 时在 macOS Mojave (10.14) 中找到一个

/Library/Frameworks/Python.framework/Versions/3.7/bin/virtualenvwrapper.sh

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-06-25T10:51:18.463

就我而言（OSX El Capitan，版本 10.11.5），我需要像这样编辑 .profile：

在终端：

> vim ~/.profile

```
export WORKON_HOME=$HOME/.virtualenvs
export MSYS_HOME=C:\msys\1.0
source /Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenvwrapper.sh 
```

然后重新加载配置文件（它将在当前会话中可用。）

> 源〜/ .profile

希望它会帮助某人。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-08-10T04:05:55.163

虽然这是一个 OS X 问题，但这对我在 Linux（Red Hat）上有用。

我的 virtualwrapper.sh 在

```
~/.local/bin/virtualenvwrapper.sh 
```

这可能是因为我在本地安装了 virtualenvwrapper，使用`--user`标志...

```
pip install --user virtualenvwrapper 
```

...作为[使用](https://stackoverflow.com/questions/21055859/what-are-the-risks-of-running-sudo-pip)`sudo pip`.

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-09-28T20:59:46.260

```
/usr/local/bin/virtualenvwrapper.sh 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-07-17T10:29:06.103

我在使用小猎犬骨黑（debian）时遇到了同样的问题。

手动下载软件包并安装对我有用。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-03-27T13:32:48.573

**对于 Ubuntu**
，如果您刚刚安装它，请检查终端上的输出，我正在发布我的：

```
Running setup.py install for virtualenv-clone    
Installing virtualenv-clone script to /home/username/.local/bin
Successfully installed virtualenvwrapper virtualenv virtualenv-clone stevedore pbr six
Cleaning up... 
```

这里第二行告诉你路径。对我来说，它在`/home/username/.local/bin`

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-09-05T19:09:06.597

如果您在`pip install virtualenvwrapper`没有 sudo 的情况下作为普通用户执行**pip 将运行但不会将文件复制到所需位置**，因为缺少权限。

```
mortiz@florida:~# sudo pip3 install virtualenvwrapper 
```

使用 sudo 文件将在各自的路径下创建：

```
root@florida:/usr/local/bin# ls -ltr
total 8008
-rwxr-xr-x 1 root staff 8136192 Jun 11 17:45 chromedriver
-rwxr-xr-x 1 root staff   41697 Sep  5 16:06 virtualenvwrapper.sh
-rwxr-xr-x 1 root staff    2210 Sep  5 16:06 virtualenvwrapper_lazy.sh
-rwxr-xr-x 1 root staff     215 Sep  5 16:06 pbr
-rwxr-xr-x 1 root staff     218 Sep  5 16:06 virtualenv-clone
-rwxr-xr-x 1 root staff     213 Sep  5 16:06 virtualenv
root@florida:/usr/local/bin# 
```

在 Debian GNU/Linux 9 上为我工作

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-05-27T16:10:58.370

pip 不会故意为难你。

问题是基于命令的文件始终安装在`/bin`文件夹中，它们可以位于系统路径上的任何位置。

我遇到了同样的问题，我发现我的文件中有这些文件

`~/.local/bin/`

文件夹而不是

`/usr/loca/bin/`

这是常见的情况，但我认为他们将默认路径更改为

`~`或 $HOME

目录，因为它对 pip 安装更加隔离，并提供了 apt-get 包和 pip 包之间的区别。

所以说到这里，你有两个选择，要么你去你的 ***.bashrc***并进行这样的更改

```
# for virtualenv wrapper
export WORKON_HOME=$HOME/Envs
export PROJECT_HOME=$HOME/Devel
source $HOME/.local/bin/virtualenvwrapper.sh 
```

而不是在下面创建一个目录**virtualenvwrapper**， 然后像这样`/usr/share/`对你的**virtualwrapper_lazy.sh进行符号链接**

```
sudo ln -s ~/.local/bin/virtualenvwrapper_lazy.sh /usr/share/virtualenvwrapper/virtualenvwrapper_lazy.sh 
```

您可以检查您的**workon**命令是否正在运行，这将列出您现有的 virtualenv。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2016-11-04T20:48:36.090

在我的情况下：/home/username/.local/bin/virtualenvwrapper.sh

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2017-12-14T20:59:35.533

您是否使用 sudo 安装了它？在我的情况下是错误的。

# uiwebview - iOS 6 上的 UIWebView 不会在 webarchives 中显示具有相对 URL 的图像

> ID：12647267
> 
> 赞同：2
> 
> 时间：2012-09-28T20:55:03.687
> 
> 标签：uiwebview, mobile-safari, ios6, webarchive

我们有时会在我们的应用程序中使用 webarchives，因为这是一种非常方便的方式，可以将 HTML + 所有相关图像/CSS/脚本/等存储在桌面上的单个文件中，将其放入项目中，然后将其加载到 UIWebView 中像这样的单个调用：

```
NSData *webArchiveData = /* ... Load data from a single file ... */ ;
[webView
    loadData:webArchiveData
    MIMEType:@"application/x-webarchive"
    textEncodingName:@"utf-8"
    baseURL:nil
]; 
```

然而，这在 iOS 6 上停止工作：HTML 已加载，但通过相对 URL 引用的图像不再显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:55:03.687

我从 webarchive 中的一些 JavaScript 中跟踪 location.href，发现在 iOS 5 及更低版本中，这是保存为 webarchive 的原始 HTML 的 URL。它用作基本 URL，因此从 HTML（图像等）引用的资源的相对 URL 可以正确解析，然后在网络存档中找到（因为它们与原始绝对 URL 一起存储在那里）。

然而，在 iOS 6 上，跟踪 location.href 会给出类似的 URL `applewebdata://1B648BC1-F143-4245-A7AD-6424C3E3D227`，因此所有相对 URL 都相对于这个 URL 进行解析，当然再也无法在 webarchive 中找到了。

我发现的一种解决方法是将与 nil 不同的内容传递给 loadData:MIMEType:textEncodingName:baseURL:，如下所示：

```
[webView
    loadData:serializedWebArchive
    MIMEType:@"application/x-webarchive"
    textEncodingName:@"utf-8"
    baseURL:[NSURL URLWithString:@"file:///"] // Passing nil here won't work on iOS 6
]; 
```

它适用于 iOS 6 和 iOS 5，并且转储 location.href 提供与以前相同的原始 HTML 的绝对 URL。

有什么缺点/建议吗？

# c# - c++ 函数调用监听器

> ID：12647272
> 
> 赞同：0
> 
> 时间：2012-09-28T20:55:12.133
> 
> 标签：c#, c++

我有一个用 C++ 编写的代码，它是一个 Windows 应用程序。

我想保留代码并创建另一个项目（C# 或 C++ - 而不是 C#）

这将“监听”该 Windows 应用程序中的某些函数调用。

我什至不知道从哪里开始，它只能是 dll 还是必须是可执行的，甚至是如何连接侦听器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:07:35.720

您可以在 WinAPI 的帮助下连接到另一个应用程序，因此您的程序不需要是 DLL，但是，我认为它不允许您监听对函数的调用等。您应该有某种原始过程中的“信号者”，您可以在挂钩时捕获它...

当您看到这种情况时，这也是合乎逻辑的：由于优化等原因，编译器有时会用它们的裸特化替换内联函数；从而完全去除分支。现在，在这种情况下，你怎么知道是否发生了分支，对吧？...

也许，您可能会改变设计模式，而不是挂钩——您可能会改变项目（当然，如果可以的话）并使它们成为两个进程相互传递消息。这可以使用 API 等来完成 - 这将使您的程序特定于操作系统 - 但这就像完全重写应用程序的某些部分（主要部分）一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:30:51.153

在托管模式下编译您的 C++ 库，然后您可以将 .dll 用于您的 c# 项目。

# c - c中的二维数组和图像平滑

> ID：12647273
> 
> 赞同：0
> 
> 时间：2012-09-28T20:55:16.377
> 
> 标签：c, arrays, image, 2d, smoothing

我必须编写一个程序，“将图像作为输入，由二维数组像素值表示（为简单起见，每个像素都可以用整数表示）。通过将均值滤波器应用于数组”。

我只是在学习数组，但我什至不知道如何启动这个程序。每当我搜索这个主题时，它都会变得非常混乱，因为我发现的每个示例或概念都在使用或谈论实际图像。由于我的程序使用整数，我很难区分需要什么和不需要什么。基本上我理解这个前提（至少我认为我理解），每个数字必须从它周围的 4 个数字中取平均值，但是在基本概念之外，我不知道需要做什么。任何帮助、建议或示例都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:06:51.697

0）加载图像？还是给定整数数组？

1）我们从一个二维数组开始，生成一个副本：`int I[N][M]; int New[N][M];`

2）循环通过值：

```
for (i = 0; i < N; i++){
    for (j = 0; j < M; j++){ 
```

3）做你的事

```
New[i][j] = sum(I[i-1][j] + I[i][j-1]...)/4; 
```

*   请注意，请注意（i 或 j-1）< 0 且（i 或 j+1）> N 或 M。按照您认为合适的方式处理这些边界条件。

显然这是最简单的方法，但看起来你在上课，所以应该没问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:08:21.223

一个关键概念：

```
int values[20][20];
float intermediates[20][20];
for (int y = 1; y < 19; y++)
  for (int x = 1; x < 19; x++)
    intermediates = (float)values[y][x];

int means[20][20];
for (int y = 1; y < 19; y++)
  for (int x = 1; x < 19; x++)
    means[y][x] = (int) ( (float) (intermediates[y-1][x-1] + intermediates[y-1][x] + intermediates[y-1][x+1] + intermediates[y][x-1] + intermediates[y][x] + intermediates[y][x+1] + intermediates[y+1][x-1] + intermediates[y+1][x] + intermediates[y+1][x+1]) / 9.0F); //  Divisor is 9 because we added nine values and we're getting the mean 
```

现在有 4 种极端情况：intermediates[0][0]、intermedias[0][19] 等，然后是所有边。

这些值首先被复制到“中间体”中，因为我不想把（浮动）放在所有东西的前面。

# c# - 使用 ServiceStack.Text：覆盖 CreateInstance 的东西？

> ID：12647278
> 
> 赞同：2
> 
> 时间：2012-09-28T20:55:40.503
> 
> 标签：c#, json, deserialization, servicestack

我正在为我的一个项目使用 ServiceStack.Text 的 JSON 序列化内容。但是，在反序列化数据时，我希望能够覆盖创建对象实例的部分。我希望它使用我的 IoC 容器来创建反序列化期间所需的任何新对象的实例。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:53:17.677

在[ServiceStack 的 JSON 序列化](https://github.com/ServiceStack/ServiceStack.Text)器中有钩子：

```
JsConfig<T>.OnSerializingFn 
```

和

```
JsConfig<T>.OnDeserializedFn 
```

那应该让你这样做。

# c++ - Qt 虚拟键盘和 QInputContextFactory

> ID：12647279
> 
> 赞同：2
> 
> 时间：2012-09-28T20:55:47.537
> 
> 标签：c++, qt, qt4, user-input, virtual-keyboard

我为我的 Ubuntu 桌面构建了 Maliit (https://wiki.maliit.org/Main_Page) 虚拟屏幕键盘，它与包含的示例应用程序配合得很好。我还能够制作自己的简单 Qt 示例应用程序，当小部件获得焦点时会显示键盘。

我现在正尝试将虚拟键盘部署到在我的目标板上运行的带有触摸屏的嵌入式 Linux 系统。目标板上没有安装 X11，我使用 QWS ( -qws ) 运行了很多 Qt 应用程序。

Maliit 架构 ( [http://maliit.org/doc/framework/latest/architecture.html](http://maliit.org/doc/framework/latest/architecture.html) ) 需要一个服务器实例来与应用程序通信，并且应用程序使用 QApplication::setInputContext 设置它的输入上下文。

在 Ubuntu 上，我只是这样做：

```
export QT_IM_MODULE=Maliit
maliit-server -software &
maliit-exampleapp-plainqt 
```

键盘出现了，一切正常（当然我有 X11）！

在嵌入式板上，我在一个 SSH 会话中执行：

```
export QT_IM_MODULE=Maliit
dbus-launch --auto-syntax maliit-server -software -qws 
```

然后是另一个 SSH 会话：

```
export QT_IM_MODULE=Maliit
source /find_dbus_address.sh
echo $DBUS_SESSION_BUS_ADDRESS
maliit-exampleapp-plainqt -qws 
```

但我总是得到错误：

```
QApplication::setInputContext: called with 0 input context 
```

这意味着示例应用程序在以下行中的 main 失败：

```
// Workaround for lighthouse Qt
kit.setInputContext(QInputContextFactory::create("Maliit", &kit)); 
```

嵌入式板上“ps”命令的输出显示如下：

```
 191 user     1692 S    -sh
  192 user    39608 S    maliit-server -software -qws
  196 user     2092 S    /usr/bin/dbus-daemon --fork --print-pid 4 --print-address 6 --session
  201 user     1692 R    ps 
```

所以服务器并没有像在 Ubuntu 中那样主动运行……而是处于“可中断睡眠”状态。鼠标确实在这种状态下移动。我仍然收到 0 输入上下文错误。

这里有一个错误 --> [https://bugs.maliit.org/show_bug.cgi?id=185](https://bugs.maliit.org/show_bug.cgi?id=185)声称带有 Maliit 的 QWS 正在为他工作，至少他可以看到输入..

还有一种可能绕过 DBUS 的 Maliit 模式（请参见此处 --> [http://www.jonnor.com/2012/03/](http://www.jonnor.com/2012/03/)）并且我仍然会收到“0输入上下文”错误：

所以我试着在我的嵌入式板上做：

```
export QT_IM_MODULE=MaliitDirect ; echo $QT_IM_MODULE ; maliit-exampleapp-embedded -qws 
```

并且总是收到：

```
QApplication::setInputContext: called with 0 input context
Unable to embedded Maliit input method widget 
```

我在 Ubuntu 12.04 桌面上构建了 Qt 4.8.2 Embedded，并且可以使用 -qws 以及示例应用程序启动 maliit-server，并且可以看到使用 QWS 的虚拟键盘工作得很好。我正在为插件和 maliit-framework 使用 git repo 的最新克隆。

我的问题是在目标上运行为我的 ARM 板编译的相同 maliit-server 和示例应用程序。我经常收到错误 QApplication::setInputContext: called with 0 input context。

我使用 DBUS dbus-monitor 工具进行了一些监控。我最初在我的板上打开了 1 个 SSH 会话并运行**eval`dbus-launch --auto-syntax`**并复制了 DBUS_SESSION_BUS。然后我打开了 2 个新的 SSH 会话。

在我做的第一个中：

```
$ export DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-vVNCW9zP7e,guid=75ecd72645dfb9b4358048db506dfec
$ export QT_IM_MODULE=Maliit
$ maliit-server -software -qws 
```

在第二个中，我做了：

```
$ export DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-vVNCW9zP7e,guid=75ecd72645dfb9b4358048db506dfecb
$ export QT_IM_MODULE=Maliit
$ maliit-exampleapp-settings -qws 
```

但是，我立即面临：

```
[9;0]QApplication::setInputContext: called with 0 input context
SettingsWidget::connected()
SettingsWidget::pluginSettingsReceived()
Setting layout QVariant(QString, "nemo-keyboard.qml:") 
```

在 dbus-monitor shell 中，我看到：

```
desktop.DBus; member=NameOwnerChanged
   string ":1.6"
   string ""
   string ":1.6"
method call sender=:1.6 -> dest=org.freedesktop.DBus serial=1 path=/org/freedesktop/DBus; interface=org.freedesktop.DBus; member=Hello
signal sender=org.freedesktop.DBus -> dest=(null destination) serial=8 path=/org/freedesktop/DBus; interface=org.freedesktop.DBus; member=NameOwnerChanged
   string "org.maliit.server"
   string ""
   string ":1.6"
method call sender=:1.6 -> dest=org.freedesktop.DBus serial=2 path=/org/freedesktop/DBus; interface=org.freedesktop.DBus; member=RequestName
   string "org.maliit.server"
   uint32 4
signal sender=org.freedesktop.DBus -> dest=(null destination) serial=9 path=/org/freedesktop/DBus; interface=org.freedesktop.DBus; member=NameOwnerChanged
   string ":1.7"
   string ""
   string ":1.7"
method call sender=:1.7 -> dest=org.freedesktop.DBus serial=1 path=/org/freedesktop/DBus; interface=org.freedesktop.DBus; member=Hello
method call sender=:1.7 -> dest=org.maliit.server serial=2 path=/org/maliit/server/address; interface=org.freedesktop.DBus.Properties; member=Get
   string "org.maliit.Server.Address"
   string "address"
method return sender=:1.6 -> dest=:1.7 reply_serial=2
   variant       string "unix:abstract=/tmp/maliit-server/dbus-CPgFHrxwAi,guid=dfc1dfc367a647e36e6e4c3c506e00db" 
```

有人知道这里发生了什么吗？DBUS 可能与 QInputContextFactory 失败有关吗？我能否以某种方式获得有关失败原因以及为什么无法设置输入上下文的更多信息？

感谢您的帮助 -

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T13:03:10.173

难以置信，如此简单的修复。只需像这样设置 QT_PLUGIN_PATH ：

```
export QT_PLUGIN_PATH=/home/user/plugins 
```

# android - IntentService 是否有可能在 Activity 使用它之前被杀死？

> ID：12647293
> 
> 赞同：2
> 
> 时间：2012-09-28T20:57:35.823
> 
> 标签：android, android-intent, android-service

我有一个应用程序，它有一个 IntentService 来提供后台处理——特别是它从网络中获取数据并将其存储在 Sqlite 数据库中。我的活动使用 Context.startService() 请求服务更新数据，更新完成时服务会发送本地广播消息。

IntentService 使用线程池来完成工作——主要是为了在请求完成之前打开一个新的 Activity，因此对不同资源的新请求不会阻塞等待前一个完成。

一切正常，但为了防止对同一资源的多个同时请求，我在活动发送请求后在活动中设置了一个标志，该标志停止发送新请求，直到它从服务返回 DONE 消息。

现在，如果 IntentService 在操作过程中被终止，它将永远不会发送 DONE 消息，并且 Activity 永远不会知道请求未完成，也不会重新请求资源。这可能吗？如果发生这种情况，是否有任何方法可以通知活动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:02:06.213

> 这可能吗？

只要您捕获所有可能的未处理异常，就不会。组件不会被单独“杀死”，例如内存回收——这是在逐个进程的基础上完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:08:14.813

如果您对此感到担忧，请[在 IntentService 的 onDestroy 中](http://developer.android.com/reference/android/app/IntentService.html#onDestroy%28%29)发送一个广播标志（或者只需设置一个断点，以便查看它是否被命中）。IntentService 旨在作为一种简化的服务来处理自己的生命周期，因此如果您将工作从服务传递到线程池，则 IntentService 可能认为它完成了工作 - 您可以在 onDestroy 中捕获它。

显然不能在不查看代码的情况下说是否发生了这种情况，但是这种机制可以让您检查是否发生了这种情况。

# php - 如何在命令行中制作计时器动画？

> ID：12647294
> 
> 赞同：1
> 
> 时间：2012-09-28T20:57:35.337
> 
> 标签：php, animation, command-line, timer

这有点傻，但是我以前想做却永远无法弄清楚的事情。我有一个从命令行运行的 PHP 脚本。我想要一个小定时器动画，让用户知道脚本仍在运行。这是我所拥有的：

```
while (1 == 1) {
   echo '—';
   usleep(100000);
   echo '\';
   usleep(100000);
   echo '|';
   usleep(100000);
   echo '/';
} 
```

但是如何让每个回声*替换*它之前的字符呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:08:42.200

您需要在每个字符之前打印一个退格键，例如：-

```
echo '-';
usleep(100000);
echo "\b/"; 
```

请注意，您必须在此处使用双引号，否则转义序列将不起作用。

我相信你可以解决剩下的:)

如果 "\b" 不起作用，请尝试：-

```
echo chr(8) . '/'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:15:21.407

您可以使用

```
echo "yourCharacter1\r";
usleep(100000);
echo "yourCharacter1\r"; 
```

或者

```
echo "\ryourCharacter1\r";
usleep(100000);
echo "\ryourCharacter2\r"; 
```

`\r`将光标返回到同一行的位置 0。

您也可以尝试（在网上找到）

```
system("clear"); // before you echo new characters 
```

或者

```
passthru('clear'); // before you echo new characters 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T21:03:46.477

试试 php ncurses 扩展：

[http://php.net/manual/en/ref.ncurses.php](http://php.net/manual/en/ref.ncurses.php)

# javascript - 在第二次保存操作中未调用子文档的 Mongoose 预保存中间件

> ID：12647295
> 
> 赞同：7
> 
> 时间：2012-09-28T20:57:45.087
> 
> 标签：javascript, node.js, mongodb, mongoose

我有一个带有子文档的猫鼬模式。父模式和子模式都有预保存挂钩。例如：

```
var mongoose = require('mongoose');
var Schema = mongoose.Schema;

var SubSchema = new Schema( { x : Number } );
SubSchema.pre('save', function (next) {
  console.log("pre save Sub");
  next();
});

var MainSchema = new Schema( { x : Number, children : [SubSchema] } );
MainSchema.pre('save', function (next) {
  console.log("pre save Main");
  next();
});
var Main = mongoose.model('Main', MainSchema);

var m = new Main();
m.children.push( { x : 42 } );

m.save( function(err, doc) {
  console.log(doc +"\n\n");
  doc.children[0].x = 43;

  doc.save( function(err, doc2) {
    console.log(doc2 + "\n\n");
  });
}); 
```

当我运行此代码时，我得到以下输出：

```
pre save Sub
pre save Main
{ __v: 0,
  _id: 50660b319aec895a50000002,
  children: [ { x: 42, _id: 50660b319aec895a50000003 } ] }

pre save Main
{ __v: 0,
  _id: 50660b319aec895a50000002,
  children: [ { x: 43, _id: 50660b319aec895a50000003 } ] } 
```

在第二次保存操作中没有为子文档运行预保存挂钩的任何原因？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-29T00:25:29.110

这在 v3.2.0 中已修复，允许您执行以下操作：

```
doc.children.set(0, {x: 43})
doc.save() 
```

# php - 从主站点域 (public_html) 对私有文件夹/php 文件的 Ajax 调用

> ID：12647296
> 
> 赞同：1
> 
> 时间：2012-09-28T20:58:01.063
> 
> 标签：php, ajax, private, public-html

我正在将我的站点从其本地主机位置迁移到服务器。在我的服务器根目录中，我想要一个映射到主域的 public_html 文件夹，以及一个包含我的资源（模型、库、模板、php 工具等）的私有文件夹。目前，虽然我在公共文件夹中有一些 javascript 文件，它们对我想保留在私有目录中的 php 文件进行 ajax 调用。我知道，由于 ajax 调用将来自客户端浏览器，因此我无法引用私有文件夹。

所以这是我的两个想法：

1.  将 php 文件移动到公共目录。（不完全确定安全风险，但他们所做的只是调用我的数据库，我对其输入进行了清理）。

2.  让 ajax 在公共目录中调用一个 php 文件，该文件包含我要调用的私有 php 文件的服务器端。

选项 2 真的是防止访问公共目录之外的私人文件的解决方案吗？如果没有，如果我需要将名为 php 的 ajax 文件移动到公共目录，我应该记住哪些安全问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:21:29.023

您所描述的选项 2 通常称为“网关”，它用于在客户端和安全服务器文件之间提供受控的数据流。选项 2 是一个有效的解决方案。

编辑：

虽然此方法将阻止其他文件直接访问，但公共文件或它包含的文件的功能仍需要验证发送给它的数据，以防止被操纵的数据利用系统中的漏洞。

# javascript - 如何在新位置旋转 dojox gfx 形状？

> ID：12647297
> 
> 赞同：0
> 
> 时间：2012-09-28T20:58:02.417
> 
> 标签：javascript, svg, dojo, gfx

如何在新位置旋转 dojox gfx？

形状是可移动的，必须在新位置旋转和缩放。为了演示，我使用了[dojox gfx 的 Butterly Demo](http://demos.dojotoolkit.org/demos/butterfly/demo.html)。有关可移动蝴蝶的信息，请参见[jsfiddle 的此示例](http://jsfiddle.net/mbecker/G8f7g/)。

如何在新位置和新中心旋转和缩放形状？

提前致谢，

贝克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:51:04.073

由于修改了函数，我分叉了你的 jsFiddle ( [http://jsfiddle.net/phusick/ta65D/](http://jsfiddle.net/phusick/ta65D/) ) 并添加了两个 (translateX & translateY) 实例来移动蝴蝶：`dijit/form/NumberSpinner``updateMatrix`

```
var updateMatrix = function() {
    var translateX = xSpinner.get("value");
    var translateY = ySpinner.get("value");

    var centerX = 210 + translateX;
    var centerY = 170 + translateY;

    if(g) {
        g.setTransform([
            m.rotategAt(rotation, centerX, centerY), 
            m.scaleAt(scaling, centerX, centerY), 
            m.translate(translateX, translateY)
        ]);
    }
}; 
```

**编辑：**要添加鼠标 DnD 支持，请将以下代码添加到上述代码中：

```
var moveable = new Moveable(g);   // require("dojox/gfx/Moveable")
moveable.onMoved = function(mover, shift) {
    xSpinner.set("value", xSpinner.get("value") + shift.dx);
    ySpinner.set("value", ySpinner.get("value") + shift.dy);
} 
```

当然，您不必使用`NumberSpinner`，但由于我之前将它放在那里，它会给您一个很好的反馈，幕后发生了什么。在 jsFiddle 上查看：http: [//jsfiddle.net/phusick/ta65D/](http://jsfiddle.net/phusick/ta65D/)。

# javascript - 无法加载位于我的计算机上的 JSON 文件

> ID：12647298
> 
> 赞同：1
> 
> 时间：2012-09-28T20:58:08.897
> 
> 标签：javascript, json, angularjs

我正在使用 AngularJS 的`http()`方法加载位于我计算机上的 JSON 文件。该文件的内容是：

```
{
  "topics": [
    {
      "canonical": "Nebraska Football",
      "alias": "NEB",
      "score": 45,
    },
    {
      "canonical": "Ohio State Football",
      "alias": "OSU",
      "score": 10,
    }
  ]
} 
```

当我加载文件（名为 example.json）时，我在使用 Firefox 和 Safari 时收到一条错误消息，上面写着`Error: JSON.parse: expected double-quoted property name`. 在 Chrome 中（正如预期的那样，由于它的默认安全性）它只是简单地不起作用。

JSON 最初在 Firefox 中加载良好，但在浏览器更新后它停止工作。

我这样称呼JSON：

```
$http.get("json/example.json").success(function(data) {
    console.log(data);
}); 
```

我也尝试使用 Python 的 SimpleHTTPServer 来运行该站点，但并没有什么不同。如果有人对这里出了什么问题有任何猜测，我将非常感谢您的帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:01:20.097

无效的 Json 尝试

```
{
    "topics": [
    {
        "canonical": "Nebraska Football",
        "alias": "NEB",
        "score": 45
    },
    {
        "canonical": "Ohio State Football",
        "alias": "OSU",
        "score": 10
    }
]
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:01:48.577

如果您通过 jsonlint.com 运行 JSON，它会将错误指向`},{`. 如果您从那里向上看，您会看到`,`不应该存在的尾随 's。你的 JSON 应该是：

```
{
  "topics": [
    {
      "canonical": "Nebraska Football",
      "alias": "NEB",
      "score": 45
    },
    {
      "canonical": "Ohio State Football",
      "alias": "OSU",
      "score": 10
    }
  ]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:02:06.353

修改后的代码：从最后一项中删除“，”可能会解决您的问题

```
{
  "topics": [
    {
      "canonical": "Nebraska Football",
      "alias": "NEB",
      "score": 45
    },
    {
      "canonical": "Ohio State Football",
      "alias": "OSU",
      "score": 10
    }
  ]
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:02:11.827

您的问题是`,`您的 JSON 中有额外的 s。修改如下：

```
{
  "topics": [
    {
      "canonical": "Nebraska Football",
      "alias": "NEB",
      "score": 45
    },
    {
      "canonical": "Ohio State Football",
      "alias": "OSU",
      "score": 10
    }
  ]
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T21:03:38.023

[JSON Lint](http://jsonlint.com/)是验证 JSON 的好地方。这就是说您应该删除`,`每个数组元素中最终值之后的逗号。所以`"score":45,`应该是`"score":45`

# mysql - MySQL如何在同一张表中仅对一列更新添加时间戳

> ID：12647302
> 
> 赞同：1
> 
> 时间：2012-09-28T20:58:33.753
> 
> 标签：mysql, sql-update, eventtrigger

到目前为止，这是我的代码

```
DELIMITER $$
    CREATE TRIGGER status AFTER UPDATE ON users
        FOR EACH ROW BEGIN
            IF NEW.status != OLD.status
            THEN INSERT INTO users (status_change_date)
            VALUES (NOW());
            ENDIF;
END$$

DELIMITER; 
```

我们要做的是在指定字段更改时使用当前日期更新字段，并将该日期保存在 status_change_date 下的同一个表中。上面的代码在 MySQL 中抛出错误。它对我尖叫，它不能调用自己来更新同一张表。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:10:42.897

我想修改同一张表，尝试使用`BEFORE UPDATE`触发器而不是`AFTER UPDATE`，如下所示：

```
DELIMITER $$
    CREATE TRIGGER status BEFORE UPDATE ON users
        FOR EACH ROW BEGIN
            IF NEW.status != OLD.status
            THEN INSERT INTO users (status_change_date)
            VALUES (NOW());
            ENDIF;
END$$

DELIMITER; 
```

# c# - 释放从 BlockingCollection 读取的对象

> ID：12647305
> 
> 赞同：1
> 
> 时间：2012-09-28T20:58:46.893
> 
> 标签：c#, performance, parallel-processing, task-parallel-library

我必须解析很多文件。所以现在我打开一个文件来读取解析内容并将输出写入不同的位置。**这基本上是我需要做的，但我想加快这个过程，因为我正在解析 14000 个文件。**

我通过在多个线程上拆分工作来改进我的算法。所以我有 1 个线程执行 25% 的文件，接下来是 25%，依此类推。

无论如何，如果我有以下条件，我相信我会显着提高性能和速度：

1.  `Task 1`读取文件并将文件内容放入 `BlockingCollection1`（内存）
2.  `Task 2`将创建多个线程来解析内容`BlockingCollection1`并将解析后的数据放入`BlockingCollection2`
3.  `Task 3`从磁盘读取内容`BlockingCollection2`并将其写入磁盘。

**我现在遇到的问题是出现内存不足异常。**我想让垃圾收集器从 BlockingCollection1 中删除已使用的项目。`BlockingCollection2`如果项目已写入磁盘，我也想删除它们。

**使用 a 非常方便，`BlockingCollection<T>`因为一个线程可以将项目添加到该集合中，而另一个线程可以处理这些项目。**在我使用链接列表之前，但我倾向于这个问题：[https](https://stackoverflow.com/a/12519345/637142) : //stackoverflow.com/a/12519345/637142 BlockingCollection 的文章和有用性如何。 **无论如何我怎么能解决这个问题？我是否必须使用不同类型的集合，例如堆栈？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:10:26.240

创建`BlockingCollection<T>`实例时，可以使用接受[bounding capacity](http://msdn.microsoft.com/en-us/library/dd267301.aspx)的构造函数。这可以防止您一次将太多项目放入集合中，这可以帮助您限制“生成”的项目数量以帮助匹配消耗的项目数量。

通过保持这种限制，您可能会阻止自己使用所有内存，因为您处理项目的速度不会比将它们写入磁盘的速度更快。

# gson - 用于反序列化嵌套 JSON 的 GSON 代码

> ID：12647306
> 
> 赞同：1
> 
> 时间：2012-09-28T20:58:52.450
> 
> 标签：gson

嗨，我的 json 是这样的，我使用 gson 转换为 Java，我创建了一个包含所有属性的顶级类和另一个具有列表的类。但是，即使数组大小正确，这些值也会打印为 null。我究竟做错了什么？

* * *

```
Gson json = new Gson();
ProductListResponse [] response = json.fromJson(str, ProductListResponse[].class); 
```

* * *

```
public class ProductList {

    public String code;
    public String name;
    public String description;
    public Date lastUpdateDate;
    public String lastUpdatedBy;        

}
------------------------------------------------------------------------------------

public class ProductListResponse {

    public ProductList plist;   

}
-------------------------------------------------------------------------------------------

[
    {
        "product": {
            "code": "RA",
            "name": "Read About",
            "description": "Read About"
        }
    },
    {
        "product": {
            "code": "READ180",
            "name": "Read180",
            "description": "Read180"
        }
    },
    {
        "product": {
            "code": "RLIB",
            "name": "Read180 Library Catalog",
            "description": "Read180 Library Catalog",
            "last_udapte_date": "2010-12-07 00:00:00.0",
            "last_updated_by": "fdixon00"
        }
    },
    {
        "product": {
            "code": "EREADS",
            "name": "Read180 eReads",
            "description": "Read180 eReads"
        }
    },
    {
        "product": {
            "code": "RSKILL",
            "name": "Read180 rSkills",
            "description": "Read180 rSkills",
            "last_udapte_date": "2010-09-20 00:00:00.0",
            "last_updated_by": "fdixon00"
        }
    },
    {
        "product": {
            "code": "POOL",
            "name": "Reference Asset Pool",
            "description": "Reference Asset Pool"
        }
    },
    {
        "product": {
            "code": "SU",
            "name": "Scholastic U",
            "description": "Scholastic U"
        }
    },
    {
        "product": {
            "code": "TR8TS",
            "name": "Six Traits of Writing",
            "description": "Six Traits of Writing"
        }
    },
    {
        "product": {
            "code": "TFX",
            "name": "TrueFlix",
            "description": "TrueFlix",
            "last_udapte_date": "2012-08-20 10:47:46.0",
            "last_updated_by": "wbyler00"
        }
    }
] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:13:25.217

这只是命名混乱：`ProductListResponse`重命名`plist`为`product`，它会立即工作。

# objective-c - Admob 横幅未从超级视图中删除

> ID：12647308
> 
> 赞同：1
> 
> 时间：2012-09-28T20:58:54.587
> 
> 标签：objective-c, cocos2d-iphone, admob, ios5.1

我正在使用 cocos2d 框架开发一个 2d 游戏，在这个游戏中我使用 admob 进行广告，在某些类中不是在所有类中，但 admob 横幅在每个类中都可见，并且在一段时间后游戏也会崩溃。

我不知道 admob 横幅是如何出现在每个类中的，事实上我没有在 Rootviewcontroller 类中声明。任何人都可以建议我如何将 Admob 集成到 cocos2d 游戏中，我希望 Admob 横幅在特定的类中而不是在每个类中，我使用的是最新的 google admob sdk，我的代码如下：

提前致谢

`

```
-(void)AdMob{
NSLog(@"ADMOB");

CGSize winSize = [[CCDirector sharedDirector]winSize];
// Create a view of the standard size at the bottom of the screen.

if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad){

    bannerView_ = [[GADBannerView alloc]
                  initWithFrame:CGRectMake(size.width/2-364,
                                           size.height -
                                           GAD_SIZE_728x90.height,
                                           GAD_SIZE_728x90.width,
                                           GAD_SIZE_728x90.height)];

}
else { // It's an iPhone

    bannerView_ = [[GADBannerView alloc]
                  initWithFrame:CGRectMake(size.width/2-160,
                                           size.height -
                                           GAD_SIZE_320x50.height,
                                           GAD_SIZE_320x50.width,
                                           GAD_SIZE_320x50.height)];
}

if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
{
    bannerView_.adUnitID =@"a15062384653c9e";
}
else {
    bannerView_.adUnitID =@"a15062392a0aa0a";
}

bannerView_.rootViewController = self;
[[[CCDirector sharedDirector]openGLView]addSubview:bannerView_];
[bannerView_ loadRequest:[GADRequest request]];

GADRequest *request = [[GADRequest alloc] init];
request.testing =  [NSArray arrayWithObjects:
                  GAD_SIMULATOR_ID, nil];                              // Simulator

[bannerView_ loadRequest:request];
 }

   //best practice for removing the barnnerView_

-(void)removeSubviews{
 NSArray* subviews = [[CCDirector sharedDirector]openGLView].subviews;
 for (id SUB in subviews){
    [(UIView*)SUB removeFromSuperview];
    [SUB release];
 }
 NSLog(@"remove from view");
  }

    //this makes the refreshTimer count
-(void)targetMethod:(NSTimer *)theTimer{

//INCREASE OF THE TIMER AND SECONDS
elapsedTime++; 
seconds++;

//INCREASE OF THE MINUTOS EACH 60 SECONDS
if (seconds>=60) {
    seconds=0; minutes++;
    [self removeSubviews];
    [self AdMob];
  }
NSLog(@"TIME: %02d:%02d", minutes, seconds);
 } 
```

`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T17:17:55.460

更新：在这里参考广义答案：[Admob-banner-integration-in-cocos2d](https://stackoverflow.com/questions/14278166/admob-banner-integration-in-cocos2d-2-0-admob-banner-in-iphone-games/14296630#14296630)

我希望你已经得到了解决方案。如果没有，那么这里是 cocos2D 游戏中 Admob 集成的所有代码。

```
 #define ENABLE_ADMOB 1
 //#define COCOS2D_2_0 1

@interface MyMainMenu : CCLayer
{
    #ifdef ENABLE_ADMOB
    GADBannerView *mBannerView;
    #endif
}

@implementation MyMainMenu

-(void)onEnter
{
    [super onEnter];

    #ifdef ENABLE_ADMOB
       #ifdef COCOS2D_2_0
         AppController *app =  (AppController*)[[UIApplication sharedApplication] delegate];    
       #else 
         AppDelegate* app = (AppDelegate*)[[UIApplication sharedApplication] delegate];
       #endif
    mBannerView = [[GADBannerView alloc] initWithAdSize:kGADAdSizeBanner];

    // Specify the ad's "unit identifier." This is your AdMob Publisher ID.
    mBannerView.adUnitID = MY_BANNER_UNIT_ID;

    // Let the runtime know which UIViewController to restore after taking
    // the user wherever the ad goes and add it to the view hierarchy.

    //size

    #ifdef COCOS2D_2_0
    mBannerView.rootViewController = app.navController;
    [app.navController.view addSubview:mBannerView];
    #else 
    mBannerView.rootViewController = app.viewController;
    [app.viewController.view addSubview:mBannerView];
    #endif

    // Initiate a generic request to load it with an ad.
    [mBannerView loadRequest:[GADRequest request]];

    CGSize AdSize = kGADAdSizeBanner.size;

    CGRect frame = mBannerView.frame;
    frame.origin.y = -50.0f;

    #ifdef COCOS2D_2_0
    frame.origin.x = (app.navController.view.bounds.size.width - AdSize.width) / 2 ;
    #else
    frame.origin.x = (app.viewController.view.bounds.size.width - AdSize.width) / 2 ;
    #endif

    mBannerView.frame = frame;

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];

    frame = mBannerView.frame;
    frame.origin.y = 0.0f;

    mBannerView.frame = frame;
    [UIView commitAnimations];    

    #endif
}

-(void)showBannerView
{
    if (mBannerView) 
    {
        [UIView animateWithDuration:0.5
                              delay:0.1
                            options: UIViewAnimationCurveEaseOut
                         animations:^
         {
             CGRect frame = mBannerView.frame;
             frame.origin.y = 0.0f;
             mBannerView.frame = frame;
         } 
                         completion:^(BOOL finished)
         {
         }];
    }

}

-(void)hideBannerView
{
    if (mBannerView) 
    {
        [UIView animateWithDuration:0.5
                              delay:0.1
                            options: UIViewAnimationCurveEaseOut
                         animations:^
         {
             CGRect frame = mBannerView.frame;
             frame.origin.y = -50.0f;
             mBannerView.frame = frame;
         } 
                         completion:^(BOOL finished)
         {
         }];
    }

}

-(void)dismissAdView
{
#ifdef ENABLE_ADMOB
    if (mBannerView) 
    {
        [UIView animateWithDuration:0.5
                              delay:0.1
                            options: UIViewAnimationCurveEaseOut
                         animations:^
         {
             CGRect frame = mBannerView.frame;
             frame.origin.y = -50.0f;
             mBannerView.frame = frame;
         } 
                         completion:^(BOOL finished)
         {
             [mBannerView setDelegate:nil];
             [mBannerView removeFromSuperview];
             mBannerView = nil;

         }];
    }
#endif  

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-05T08:03:08.793

完全修复（使用 iOS 8.1 和 Admob 6.12.0 测试）

```
-(void)RemoveAds
{
    if (adBanner != nil)
    {
        [adBanner setRootViewController:nil];
        [adBanner removeFromSuperview];
        adBanner = nil;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:18:32.913

由于在 cocos2d 中，您将有不同的场景类。

我的建议是为添加横幅创建一个单独的类，并让一个静态方法为您完成这项工作。您必须在该类中保存对添加横幅的引用，并使用静态方法将其添加到 openglview 中/从中删除它。

对于删除你只会做：[bannerView removeFromSuperview];

# eclipse - 在 p2 生成后更新捆绑限定符

> ID：12647309
> 
> 赞同：2
> 
> 时间：2012-09-28T20:58:56.573
> 
> 标签：eclipse, eclipse-plugin, equinox, p2

当 p2 存储库完成构建后，我更新了品牌插件中的 .eclipseproduct 和 plugin.properties。由于已经生成了 md5，我运行 p2.process.artifacts 来更新 md5 总和。但是，品牌插件的限定符不会更改，因此此捆绑包不会更新，因此之前所做的 plugin.properties 和 .eclipseproduct 更改不会使其更新。当我查看帮助 - > 关于时，我会看到上一个版本的版本号。

更新文件后是否需要重新生成品牌插件的限定符，如果是，那么如何？还是我做错了什么导致品牌插件无法更新？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T21:24:14.857

每当插件中发生任何变化时，您都必须重新构建它（并因此恢复它）。p2 使用 ID + Version 作为所有工件的唯一标识符。

如果您更改品牌插件，则需要重新构建它（使用您正在使用的任何构建技术，例如 Tycho、PDE/Build 等...）。

# wso2 - 如何在单个 Carbon 平台上安装 WSO2 产品（ESB、AS、BPEL、IS）？

> ID：12647316
> 
> 赞同：0
> 
> 时间：2012-09-28T20:59:28.410
> 
> 标签：wso2, wso2esb, wso2carbon

我能够安装安装了 ESB 和 AS 功能的 Carbon 4.0.1。

但是，当我尝试安装 Identity Server 和 BPEL 时，会出现错误，因为 Carbon 核心不一样。我认为还没有与 Carbon 4 兼容。

是否还有办法在 Carbon 4.0.1 上安装这两个产品？

如果没有，我必须分别安装 Identity Server 和 BPEL，我会遇到兼容性问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T02:45:46.750

新碳版本的 BPEL 和身份功能将很快在 4.0.2 版本下发布。您需要使用旧版 carbon 3.2.3 并使用[此 p2 repo](http://dist.wso2.org/p2/carbon/releases/3.2.3/features/)安装功能。如果您要使用 BPEL 和 IS 单独安装，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-06T10:22:10.803

您必须在 $CARBON_HOME/repository/conf/carbon.xml 文件中设置 Offset 参数，以便在同一服务器上设置多个 wso2 产品。例如，如果您想设置 ESB、BPS 和 IS，您必须修改每个产品的安装并指定不同的偏移量。

目前，我们无法在同一个 carbon 平台上配置多个 wso2 产品。您可以在同一台服务器上安装多个产品，但每个产品都将在各自的 carbon 环境中运行。

# c# - ASP.NET WebControls DataGrid 获取选定的行

> ID：12647317
> 
> 赞同：0
> 
> 时间：2012-09-28T20:59:36.247
> 
> 标签：c#, asp.net, datagrid

我在 ASP.NET 页面中使用[DataGrid 。](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid%28v=vs.100%29.aspx)

当有人用鼠标单击一行时，我想使用来自该 DataGrid 的 Selected Row 的信息填写表单上的数据。

我已经连接了控件的`SelectedIndexChanged`事件，但似乎没有任何方法可以访问各个行。

```
protected void DataGridRow_Selected(object sender, EventArgs e) {
  var row = grid1\. ???
} 
```

有没有办法做到这一点？

我主要使用 Windows 窗体，因此对于更频繁使用 WebForms 的人来说，我可能会遗漏一些完全显而易见的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:25:30.127

您可以使用 JQuery 之类的 Ajax 来获取该网格单元格的内容并填充到您的表单字段中。

```
$("#inputfield").value($("#gridcell").html()) 
```

# dynamics-crm - 如何查找未被 activitymimeattachment 记录引用的附件记录？

> ID：12647318
> 
> 赞同：0
> 
> 时间：2012-09-28T20:59:40.157
> 
> 标签：dynamics-crm, dynamics-crm-2011, crm, dynamics-crm-online

我需要找到“activitymimeattachment”（AMA）记录未引用的所有“附件”（A）记录。如果这2条记录相关，则A记录的Id存储在AMA记录的“attachmentid”属性中。

我可以通过以下查询找到 AMA 引用的所有 As：

```
 QueryExpression BLOBQuery = new QueryExpression("attachment");
    LinkEntity link = new LinkEntity("attachment", "activitymimeattachment", "attachmentid", "attachmentid", JoinOperator.Inner);
    BLOBQuery.LinkEntities.Add(link);

and grouping, selecting first to get unique results based on Id 
```

任何 crm 查询机制是否可能相反？链接似乎无关紧要，因为它是我想要的反链接......

我可以遍历我所有的 A 并检查每个 A 是否被引用，但我有很多，它可以运行至少一天。

# scheme - 这个怎么读？

> ID：12647321
> 
> 赞同：1
> 
> 时间：2012-09-28T20:59:51.987
> 
> 标签：scheme, racket

我有以下测试示例可以使用`read`，但遇到一些问题：

```
#lang racket
(struct test (num) #:prefab)
(define s3 (read (open-input-string "((AK= #s(test .)) (AV))")))
(match s3
   [`((AK= ,(struct test (val))) (AV)) (displayln val)]) 
```

它会发出`read: unexpected`)'`

我知道这是因为`.`，但我的源将包含很多这种东西，那么问题是我怎样才能在球拍中阅读它们？

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:22:43.187

[`read-accept-dot`](http://docs.racket-lang.org/reference/Reading.html#%28def._%28%28quote._~23~25kernel%29._read-accept-dot%29%29)您可以使用and禁用读取点[`read-accept-infix-dot`](http://docs.racket-lang.org/reference/Reading.html#%28def._%28%28quote._~23~25kernel%29._read-accept-infix-dot%29%29)，但如果有点，那只会使其成为错误。所以听起来你想在这里使用[自定义可读表](http://docs.racket-lang.org/reference/readtables.html)（也阅读[指南部分](http://docs.racket-lang.org/guide/hash-reader.html#%28part._readtable%29)）：

```
#lang racket
(struct test (num) #:prefab)
(define rt:no-dots
  (make-readtable (current-readtable)
                  #\. 'non-terminating-macro (  _ #'|.|)))
(define (read-with-dots str)
  (parameterize ([current-readtable rt:no-dots])
    (read (open-input-string str))))
(define s3 (read-with-dots "((AK= #s(test .)) (AV))"))
(match s3
   [`((AK= ,(struct test (val))) (AV)) (displayln val)]) 
```

或者，您可以将点视为注释：

```
(define rt:no-dots
  (make-readtable (current-readtable)
                  #\. 'non-terminating-macro
                  (  _ (make-special-comment #f)))) 
```

# c# - Monotouch PushSharp 问题

> ID：12647322
> 
> 赞同：0
> 
> 时间：2012-09-28T20:59:59.567
> 
> 标签：c#, xamarin.ios, apple-push-notifications

我正在使用 PushSharp 库，并且在通过消息发送示例时遇到问题。

我得到一个 deviceToken 就好了，但是当我尝试通过 PushSharp 示例向它发送消息时，我收到一个错误，并且没有消息被推送到我的 iPad。

```
 push.QueueNotification(NotificationFactory.Apple()
            .ForDeviceToken("c27d5fc52e4fce7a3dcf2306d984a90179ba0bde443e2c6f6d7399cb02d13ad5")
            .WithAlert("1 Alert Text!")
            .WithSound("default")
            .WithBadge(7)); 
```

这是控制台输出

```
Waiting for Queue to Finish... 
Sent: Apple -> {"aps":{"alert":"1 Alert Text!","badge":7,"sound":"default"}}
Queue Finished, press return to exit...
Device Subscription Expired: Apple -> c27d5fc52e4fce7a3dcf2306d984a90179ba0bde44
3e2c6f6d7399cb02d13ad5 
```

关于从哪里开始寻找的任何想法？

谢谢，

# c++ - 如何在 C++ 类中包装 C 结构并保持相同的名称？

> ID：12647324
> 
> 赞同：1
> 
> 时间：2012-09-28T21:00:33.950
> 
> 标签：c++, namespaces, wrapper

假设 Acme 公司发布了一个有用的库，其中包含一个极其丑陋的 C API。我想将结构和相关函数包装在 C++ 类中。似乎我不能为包装类使用相同的名称，因为原始库不在命名空间内。

这样的事情是不可能的，对吧？

```
namespace AcmesUglyStuff {
    #include <acme_stuff.h>   // declares a struct Thing
}
class Thing {
 public:
    ...
 private:
    AcmesUglyStuff::Thing thing;
}; 
```

链接将是一个问题。

我能想到的包装库的唯一方法，而不是用 C 库名称污染我的命名空间，是这样的 hack，在类中保留空间：

```
// In mything.h
namespace wrapper {
  class Thing {
   public:
    ...
   private:
    char impl[SIZE_OF_THING_IN_C_LIB];
  };
}

// In thing.cc
#include <acme_stuff.h>
wrapper::Thing::Thing() {
    c_lib_function((::Thing*)impl); // Thing here referring to the one in the C lib
} 
```

这是唯一的方法吗？我想避免在我的所有类名上加上前缀，比如`XYThing`等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:13:04.427

似乎你让这变得比它需要的更难。

```
#include "acme_stuff.h" // puts all of its names in global namespace

namespace acme {

class Thing {
public:
    // whatever
private:
    ::Thing thing;
};

} 
```

现在只需使用`acme::Thing`而不是`Thing`.

如果在全局命名空间中没有 C 名称对您来说真的很重要，那么您需要一个间接级别：

```
namespace acme {

class Thing {
public:
    Thing();
    ~Thing();
    // whatever
private:
    void *acme_thing;
};

} 
```

在您的实现文件中`#include "acme_stuff.h"`，在您的构造函数中创建一个`new ::Thing`对象并将其地址存储在 中`acme_thing`，在您的析构函数中删除它，并在您的成员函数中强制`acme_thing`转换为 type `::Thing*`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:40:25.710

尝试将某事物命名为与其他事物完全相同的事物并不是一个好主意。（我的意思是相等的完全限定名称，包括所有名称空间。）如果某个库已经在全局名称空间中获取了明显的最佳名称，则您需要选择一个不同的名称。

您可以按照 Pete Becker 的建议将*您的*类`Thing`放在命名空间中，然后使用它`::Thing`来访问 Acme 的`Thing`. 如果您准备始终通过其完全命名空间限定的名称（例如 ）来访问您的类，那将会很好`My::Thing`。尝试`using My::Thing;`or很诱人`using namespace My;`，但这[不起作用](http://ideone.com/ETyON)，因为任何包含类定义的翻译单元（例如，通过您创建的头文件）必须首先将 Acme 拉`Thing`入全局命名空间（否则为“未定义符号”编译解析 ) 的定义时会发生错误`My::Thing`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-28T21:05:54.767

它真的是一个**C** API 吗？尝试使用`extern "C" {}`整个包含的标题来解决链接问题。

```
namespace AcmesUglyStuff {
  extern "C" {
    #include <acme_stuff.h>
  }
} 
```

# scala - 在不使用惰性值的情况下避免特征初始化中的 NPE

> ID：12647326
> 
> 赞同：3
> 
> 时间：2012-09-28T21:00:43.873
> 
> 标签：scala, nullpointerexception

这可能已被 Jesse Eichar 的[博客文章](http://daily-scala.blogspot.co.at/2010/03/nullpointer-when-mixed-traits-warning.html)所涵盖——我仍然无法弄清楚如何在**不使用惰性**val 的情况下更正以下问题，以便修复 NPE：

给定

```
trait FooLike { def foo: String }
case class Foo(foo: String) extends FooLike

trait Sys {
  type D <: FooLike
  def bar: D
}

trait Confluent extends Sys {
  type D = Foo
}

trait Mixin extends Sys {
  val global = bar.foo
} 
```

第一次尝试：

```
class System1 extends Mixin with Confluent {
  val bar = Foo("npe")
}

new System1  // boom!! 
```

第二次尝试，改变mixin顺序

```
class System2 extends Confluent with Mixin {
  val bar = Foo("npe")
}

new System2  // boom!! 
```

现在我同时使用了这两种方法`bar`并且`global`非常频繁，因此我不想仅仅因为 Scala (2.9.2) 没有正确初始化而支付惰性值税。该怎么办？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-28T21:35:16.903

您可以使用[早期初始化程序](https://stackoverflow.com/questions/4712468/in-scala-what-is-an-early-initializer)：

```
class System1 extends {
  val bar = Foo("npe")
} with Mixin with Confluent {
  // ...
}

scala> new System1
res3: System1 = System1@1d0bfedd 
```

# php - 没有 API 控制台的活动 Google API

> ID：12647331
> 
> 赞同：1
> 
> 时间：2012-09-28T21:00:58.570
> 
> 标签：php, google-api, oauth-2.0

有没有办法在不通过 Google API 控制台网站的情况下在 php 中激活 Google Api 服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T23:05:50.613

这取决于您要使用的 API。一些 API，例如[Google 静态地图 API](https://developers.google.com/maps/documentation/staticmaps/)，不需要您注册为应用程序。大多数 API，尤其是访问某些用户数据的 API，都需要您使用[Google 的 API 控制台](https://code.google.com/apis/console/)设置 API 项目，因此 Google 知道访问其 API 的是您的应用程序。

# ruby - 为什么插入数组后哈希中的值是空的？

> ID：12647332
> 
> 赞同：0
> 
> 时间：2012-09-28T21:00:55.357
> 
> 标签：ruby

我有一个数字数组，我希望各个数字成为键，而数组本身就是值。这样做没有问题

```
keys.each do |i| 
    myHash[i] = keys
end 
```

但是现在我希望这些值是数组减去每个后续迭代的第一个值，所以我这样做了

```
keys = Array.new

numbers.each do |i|
    keys.push(i)
end

keys.each do |i|
    # puts i
    # puts numbers.inspect
    myHash[i] = numbers
    numbers.shift
end 
```

它给了我空数组作为我所有键的哈希值。这是为什么？最终，我希望我的哈希看起来像这样给定一个数组 [1, 2, 3, 4]

{1=>[1, 2, 3, 4], 2=>[2, 3, 4], 3=>[3, 4], 4=>[4]}

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:02:45.357

您没有对数组进行深层复制。

尝试 ：

```
keys.each do |i|
   # puts i
   # puts numbers.inspect
   myHash[i] = numbers.clone
   numbers.shift
end 
```

# open-source - Autohotkey 无法识别活动窗口？

> ID：12647335
> 
> 赞同：0
> 
> 时间：2012-09-28T21:01:09.470
> 
> 标签：open-source, hotkeys, autohotkey, keymapping

```
WinGetPos,X,Y,W,H,A

space::MsgBox,%H%,%W%,%X%,%Y% 
```

当它运行时，我得到 X 和 y 为 0，并且我得到 hidth 和 width 作为我屏幕的分辨率是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:13:58.023

您是通过双击桌面上的图标还是从全屏窗口启动此脚本？

该`WinGetPos`命令将在脚本启动后立即运行。当您按空格键时，只会运行消息框，但无论您当时在哪个窗口中，都会始终返回相同的初始值。

把它改成这个，你应该得到预期的结果：

```
space::
    WinGetPos,X,Y,W,H,A
    MsgBox,%H%,%W%,%X%,%Y%
    return 
```

# image - SVG 对于网络上高度复杂的插图是否实用？

> ID：12647338
> 
> 赞同：4
> 
> 时间：2012-09-28T21:01:15.043
> 
> 标签：image, web-applications, graphics, web, svg

我正在开发一个网络应用程序，该应用程序使用相当多的大型复杂图像作为背景和前景插图。我倾向于使用 SVG 而不是光栅图形，因为它的可扩展性和它允许的动态交互。但是一些较大的图像非常复杂（数千条路径，在 Inkscape 中绘制）。

使用这种尺寸的 SVG 图像（在性能方面）有多实用？与使用 PNG 图像相比，它会使我的页面显着变慢吗？是否有特定的技术（例如，一种嵌入方法优于另一种）会影响下载和渲染速度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T10:53:41.263

您可以简化路径数据以适合您的视口大小。一些不可见的元素不应该输出到 DOM 树。谷歌地图也使用 SVG 并且运行良好。

# javascript - 如何隐藏滚动条，同时将功能保留在倾斜的 div 中

> ID：12647339
> 
> 赞同：2
> 
> 时间：2012-09-28T21:01:15.897
> 
> 标签：javascript, html, css, scrollbar

我正在尝试创建一个倾斜的 div，其中包含滚动内容。

您可以在这里查看我的代码：http: [//jsfiddle.net/kDv45/1/](http://jsfiddle.net/kDv45/1/)

最初我通过将内容放置在一个较小的 div 中来隐藏它，但是倾斜使滚动条再次可见。

如果我将 css 溢出设置为隐藏，它会隐藏滚动条，但不再能够滚动。你们能想出解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:15:11.750

我建议你使用 overflow : hidden 在 x 和 y 上。并使用 JavaScript 事件进行滚动。

# javascript - 如何增强动态创建的 Jquery Mobile 复选框？

> ID：12647341
> 
> 赞同：0
> 
> 时间：2012-09-28T21:01:22.807
> 
> 标签：javascript, jquery, jquery-mobile, checkbox, render

我正在努力让它发挥作用：

```
var selectorBox = $('<label for="'+selectorID+'"><input type="checkbox" id="'+selectorID+'" name="'+selectorID+'" class="selector" data-inline="true" data-iconpos="notext"></label>').trigger('create'),
    cell = $( "<th class='persist essential notxtchkbx rowHigh' "+rowSpanner+"></th>" ).append( selectorBox );

currentRow.prepend( cell ); 
```

`selectorBox`是复选框 HTML，我试图`trigger("create")`在创建单元格并将此单元格插入表格行之前对其进行增强。

**问题**：
如何让此复选框正确呈现？

感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T10:35:54.177

要增强复选框，您需要调用`trigger("create")`其父**元素**。直接在复选框上调用它不起作用。只需使用类似的东西：

```
$("input.myCheckbox").closest("div").trigger("create"); 
```

它应该工作。

# android - 带有列表视图的水平投掷：滞后问题

> ID：12647342
> 
> 赞同：1
> 
> 时间：2012-09-28T21:01:27.267
> 
> 标签：android

我根据这个主题实现了我的手势监听器：[ListView Horizo​​ntal Fling Gesture](https://stackoverflow.com/questions/5481814/listview-horizontal-fling-gesture)

但是，我可以看到列表滚动较慢，有时（当您滚动非常慢时）它也会阻塞。我认为问题出在听众身上：计算值需要时间，因此得到我正在寻找的实际“从左到右”的投掷......没有更有效的方法吗？

**编辑**

问题在这里：

```
@Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
        if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH) {
            return false;
        }

        // right to left swipe
        if(e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
            System.out.println("right to left");
            animatedStartActivity(0);

            // right to left swipe
        }  else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
            System.out.println("left to right");
            animatedStartActivity(1);
        }

        return false;
    } 
```

评估这种方法需要时间

**编辑2：** 我猜问题是因为listview已经有自己的手势监听器并且附加我的覆盖它。这是一个问题，因为 listview 手势侦听器也考虑了速度和加速度，以提供良好的移动效果。我的听众很原始，所以列表滚动不再流畅了..即使我的 onFLing 方法总是返回 false （所以它不消耗事件）列表滚动受到影响......

**edit3：好吧，也许我找到了解决方案，但我需要你的帮助！我可以在容器布局上设置onTouchListener，问题是listview实际上覆盖了父级的onTouch，所以我需要扭转这种情况：listview上的onTouchEvent必须被父级拦截，所以返回false是对listview的影响**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:09:58.030

解决了！！！问题是 ListView 的 onTouchEvent 执行了一些其他操作！所以我扩展了ListView：

```
public class FlingListView extends ListView{

private GestureDetector detector; //this is my detector

public void setDetector(GestureDetector detector){
    this.detector = detector;
}

public FlingListView(Context context) {
    super(context);
    // TODO Auto-generated constructor stub
}

public FlingListView(Context context,AttributeSet set) {
    super(context,set);
    // TODO Auto-generated constructor stub
}

public FlingListView(Context context,AttributeSet set, int a) {
    super(context,set,a);
    // TODO Auto-generated constructor stub
}

     //here I do the magic
@Override
public boolean onTouchEvent(MotionEvent ev) {
    // TODO Auto-generated method stub
    super.onTouchEvent(ev); //I always do the list on touch event
    return(detector.onTouchEvent(ev)); //..but I return the detector!

}
 } 
```

我不知道这是否是最好的解决方案，但仍然......它有效！

# java - 如何定义 RequestMapping 优先级

> ID：12647346
> 
> 赞同：7
> 
> 时间：2012-09-28T21:01:44.217
> 
> 标签：java, spring, spring-mvc

我有一种情况，我需要以下内容`RequestMapping`：

```
@RequestMapping(value={"/{section}"})
...method implementation here...

@RequestMapping(value={"/support"})
...method implementation here... 
```

有明显的冲突。我希望 Spring 会自动解决这个问题并映射`/support`到第二种方法，而其他一切都映射到第一种方法，但它会映射`/support`到第一种方法。

我如何告诉 Spring 允许在同一个地方显式地用 a`RequestMapping`覆盖 a ？`RequestMapping``PathVariable`

**编辑2：**`/support`如果映射在映射之前，它似乎会起作用`/{section}`。不幸的是，我们有几十个控制器，其中包含许多带有`RequestMapping`. 如何确保具有`/{section}`映射的控制器最后初始化？或者预拦截器是要走的路吗？

**编辑1：**这是简化的，我知道`RequestMapping`单独拥有这两个没有多大意义）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T14:36:24.423

使用 Spring，您可以扩展 org.springframework.web.HttpRequestHandler 以支持您的方案。

实现方法：

```
@Override
public void handleRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {} 
```

使用它来分析传入的请求，确定请求 url 是否是您的请求 url 的特殊子集的一部分，并转发到适当的位置。

前任：

```
@Override
public void handleRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { 
/** You will want to check your array of values and have this data cached  **/
if (urlPath.contains("/sectionName")) {
        RequestDispatcher requestDispatcher = request.getRequestDispatcher("sections" + "/" + urlPath);
        requestDispatcher.forward(request, response);
    }

} 
```

并设置您的部分，例如：

```
@RequestMapping(value={"/sections/{sectionName}"}) 
```

这不会干扰任何预先存在的控制器映射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:05:03.607

这似乎不是问题，这是一个有效的映射。如果你看看[http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates)

在**16.3.2 使用 @RequestMapping 映射请求**部分中存在两种方法，它们的作用与您尝试的完全相同。

为确保您的类正在编译，请尝试在类级别添加 @RequestMapping("/someprefix") 以查看 URL 是否按照您的需要公开。

我使用版本 3.1.0.RELEASE 在本地验证您的示例，并且没有出现问题。

作为一种解决方法（也为了提供一个易于理解的 REST URI，向您的第二个映射添加一些上下文：

```
@RequestMapping(value={"client/support"}) // i.e: if you are working with clients
public ModelAndView getsupport(@PathVariable Long supportId){
    // do your code here something here
  } 
```

当然，如果这是系统中存在的唯一控制器，则这是有效的，否则您必须按照我上面的建议在类级别使用 RequestMapping。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T21:35:44.227

如果 2 这些方法是在 2 个不同的控制器中定义的，那么您的问题是您有 2 个控制器映射到相同的 URL。您现在无法控制控制器初始化的顺序，因此顺序是随机的。

我认为您需要`/support`先初始化映射`/{section}`。

为了实现这一点，尝试定义控制器“部分”取决于控制器“支持”。如果这无济于事，请尝试将两种方法放在一个控制器上，并将映射到“支持”的方法放在“部分”之前

我这在这里不起作用是其他建议。什么是“节”？如果它可以接受有限数量的值，则应将其定义为`enum`. 我相信在这种情况下，如果支持和部分方法在一个控制器或单独的控制器中，一切都会按要求工作。

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:51:37.667

我在 Spring 3.1.2 中没有看到这种行为，它可能是旧 Spring 版本的错误。这是一个对我来说没有任何问题的要点 - [https://gist.github.com/3802254](https://gist.github.com/3802254)

# c# - 设置 ReSharper 以识别未在范围内调用的 Dispose() 或仅更改颜色（无 resharper）？

> ID：12647350
> 
> 赞同：2
> 
> 时间：2012-09-28T21:01:56.117
> 
> 标签：c#, .net, resharper

> **可能重复：**
> [如果 IDisposable 处理不正确，是否可以将 Resharper 设置为警告？](https://stackoverflow.com/questions/101664/can-resharper-be-set-to-warn-if-idisposable-not-handled-correctly)

有没有办法为 resharper 创建一个规则，该规则强调实现 IDisposable 但不在方法内的任何位置调用 Dispose() （或使用）的对象？

例如，ClassA 实现 IDisposable。我新建了一个 ClassA 的实例，但我没想过要检查它是否有 IDisposable 或 Dispose() ）。Resharper 检查对象并发现它实现了 IDisposable 或包含一个名为 Dispose() 的方法。然后它在包含方法中查看是否曾经调用过 .Dispose()，或者声明是否在 using 构造中。如果不是，那么它强调了声明，让我觉得吉布森刚刚坠毁。

我已经在其他线程中多次看到这种情况，但其中大多数似乎至少有 3 年历史，尚无定论等。即使只是更改实现类的类型的突出显示颜色，我也会很高兴它，只是为了提醒我。

TIA

# ruby-on-rails - Rails 线程测试数据库锁

> ID：12647356
> 
> 赞同：0
> 
> 时间：2012-09-28T21:02:31.783
> 
> 标签：ruby-on-rails, ruby, multithreading

假设我们要测试数据库是否被锁定..

```
$transaction = Thread.new  {
    Rails.logger.debug 'transaction process start'
    Inventory.transaction do
      inventory.lock!
      Thread.stop
      inventory.units_available=99
      inventory.save
    end
  }
  $race_condition = Thread.new  {
    Rails.logger.debug 'race_condition process start'
    config = ActiveRecord::Base.configurations[Rails.env].symbolize_keys
    config[:flags] = 65536 | 131072 | Mysql2::Client::FOUND_ROWS
    begin
      connection = Mysql2::Client.new(config)

      $transaction.run
      $transaction.join
    rescue NoMethodError
    ensure
      connection.close if connection
    end
  }
  Rails.logger.debug 'main process start'
  $transaction.join
  Rails.logger.debug 'main process after transaction.join'
  sleep 0.1 while $transaction.status!='sleep' 
  Rails.logger.debug 'main process after sleep'
  $race_condition.join
  Rails.logger.debug 'main process after race_condition.join' 
```

理论上，我认为它会执行事务线程，然后等待（ Thread.stop ），然后主进程会看到它正在休眠，并启动竞争条件线程（它将尝试更改锁定表中的数据当它实际工作时）。然后竞争条件将在完成后继续事务线程。

奇怪的是痕迹

```
main process start
transaction process start
race_condition process start 
```

来自 nodejs，似乎线程并不完全像用户友好.. 但是，必须有一种方法来完成这项工作。

有没有更简单的方法来锁定数据库，然后尝试用不同的线程更改它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:10:24.077

Thread.new 自动启动线程。但这并不意味着它正在执行。这取决于操作系统、ruby 或 jruby、多少个内核等。

在您的示例中，主线程一直运行到 $transaction.join，然后您的事务线程才会启动，这只是偶然。它仍然运行 Thread.stop，然后您的“$race_condition”线程启动，因为其他两个线程都被阻止（它可能之前已经启动）

这样就解释了您的日志。

你有两个 $transaction.join
他们等到线程退出，但是一个线程只能退出一次......我不知道会发生什么，也许第二个调用会永远等待。

对于您的测试，您需要某种显式同步，以便我们的 race_thread 在 transaction_thread 处于事务中间时准确地写入。您可以使用 Mutex 来做到这一点，但更好的是某种消息传递。以下博客文章可能会有所帮助：

[http://www.engineyard.com/blog/2011/a-modern-guide-to-threads/](http://www.engineyard.com/blog/2011/a-modern-guide-to-threads/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:57:40.600

对于任何使其成为“互斥”的资源，您需要使用**Mutex**类并使用**同步**方法使资源在一个线程使用它们时锁定。你必须做这样的事情：

`semaphore = Mutex.new`

并在 Thread 实例中使用它。

```
$transaction = Thread.new  { 
  semaphore.synchronize{
  # Do whatever you want with the *your shared resource*
  }
} 
```

这样您就可以防止任何死锁。

希望这可以帮助。

# c++ - 用于内存修补的 const struct 声明

> ID：12647362
> 
> 赞同：0
> 
> 时间：2012-09-28T21:03:21.087
> 
> 标签：c++, c, hook, code-injection

我正在做逆向工程并通过 DLL 修补游戏的内存。通常我会坚持在一个或多个函数中修补所有内容的旧方法。但是感觉它可以通过使用一个结构数组来更好地完成，该数组定义了需要发生的内存写入并一次循环遍历它们。更容易管理，IMO。

不过，我想让它保持不变。因此，数据一次性全部存在（在 .rdata 中），而不必为每个补丁动态分配内存，这是一个简单的“字节大小”数据任务，例如：

```
struct struc_patch
{
    BYTE val[8];    // max size of each patch (usually I only use 5 bytes anyway for call and jmp writes)
                    // I can of course increase this if really needed
    void *dest;
    char size;
} patches[] =
{
    // simply write "01 02 03 04" to 0x400000
    {{0x1, 0x2, 0x3, 0x4}, (void*)0x400000, 4},
};
//[...]
for each(struc_patch p in patches)
{
    memcpy(p.dest, p.val, p.size);
} 
```

但是当我想对这些类型更感兴趣时，我找不到将像“0x90909090”这样的整数指定为字节数组“90 90 90 90”的方法。所以这行不通：

```
struct struc_patch
{
    BYTE val[8];    // max size of each patch (usually I only use 5 bytes anyway for call and jmp writes)
                    // I can of course increase this if really needed
    void *dest;
    char size;
} patches[] =
{
    // how to write "jmp MyHook"? Here, the jmp offset will be truncated instead of overlapping in the array. Annoying.
    {{0xE9, (DWORD)&MyHook - 0x400005}, (void*)0x400000, 5},
}; 
```

当然，主要问题是 &MyHook 必须由编译器解决。还有其他方法可以获得所需的结果并保持不变吗？

老实说，我对 STL 的经验很少。因此，如果有使用它的解决方案，我可能需要对其进行详细解释，以便正确理解代码。我是一个大 C/C++/WinAPI 瘾君子，哈哈，但它是为类似性质的游戏编写的，所以它适合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:09:30.053

我认为 STL 中的任何内容都不会帮助您解决这个问题，而不是在编译时。可能有一种奇特的方式来处理模板，就像处理宏一样。（逗号分隔字节）

但我建议做这样简单的事情：

```
struct jump_insn
{
    unsigned char opcode;
    unsigned long addr;
} jump_insns[] = {
    {0xe9, (unsigned long)&MyHook - 0x400005}
};

struct mem
{
   unsigned char val[8];
} mems[] = {
    {1,2,3,4}
};

struct struc_patch
{
    unsigned char *val;    // max size of each patch (usually I only use 5 bytes anyway for call and jmp writes)
                    // I can of course increase this if really needed
    void *dest;
    char size;
} patches[] =
{
    // simply write "01 02 03 04" to 0x400000
    {(unsigned char*)(&mems[0]), (void*)0x400000, 4},

    // how to write "jmp MyHook"? Here, the jmp offset will be truncated instead of overlapping in the array. Annoying.
    {(unsigned char*)(&jump_insns[0]), (void*)0x400000, 5},
}; 
```

你不能内联做所有事情，你需要为不同类型的补丁提供新类型，但它们可以任意长（不仅仅是 8 个字节），并且所有内容都在 .rodata 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:01:41.340

处理这个问题的更好方法是即时计算地址差异。例如（[来源](https://www.assembla.com/code/d2bs/subversion/nodes/branches/patch-113d/Offset.cpp?rev=1758)）：

```
#define INST_CALL    0xE8

void InterceptLocalCode(BYTE bInst, DWORD pAddr, DWORD pFunc, DWORD dwLen)
{
    BYTE *bCode = new BYTE[dwLen];
    ::memset(bCode, 0x90, dwLen);
    DWORD dwFunc = pFunc - (pAddr + 5);

    bCode[0] = bInst;
    *(DWORD *)&bCode[1] = dwFunc;
    WriteBytes((void*)pAddr, bCode, dwLen);

    delete[] bCode;
}

void PatchCall(DWORD dwAddr, DWORD dwFunc, DWORD dwLen)
{
    InterceptLocalCode(INST_CALL, dwAddr, dwFunc, dwLen);
} 
```

dwAddr 是要放入 call 指令的地址，dwFunc 是要调用的函数，dwLen 是要替换的指令的长度（基本上用来计算要放入多少 NOP）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T02:57:48.770

总而言之，我的解决方案（感谢 Nicolas 的建议）：

```
#pragma pack(push)
#pragma pack(1)
#define POFF(d,a) (DWORD)d-(a+5)
struct jump_insn
{
    const BYTE opcode = 0xE9;
    DWORD offset;
};

struct jump_short_insn
{
    const BYTE opcode = 0xEB;
    BYTE offset;
};

struct struc_patch
{
    void *data;
    void *dest;
    char size;
};
#pragma pack(pop) 
```

并在使用中：

```
// Patches
jump_insn JMP_HOOK_LoadButtonTextures = {POFF(&HOOK_LoadButtonTextures, 0x400000)};

struc_patch patches[] =
{
    {&JMP_HOOK_LoadButtonTextures, IntToPtr(0x400000)},
}; 
```

使用类成员 const，我可以更轻松、更清晰地定义所有内容，并且可以简单地全部使用 memcpy。pack pragma 当然需要确保 memcpy 不会复制 BYTE 操作码和 DWORD 值之间的 3 个对齐字节。

谢谢大家，帮助我使我的修补方法更加强大。

# sql-server - SQL Server 中的 BCP IN UTC 日期时间值

> ID：12647363
> 
> 赞同：0
> 
> 时间：2012-09-28T21:03:27.710
> 
> 标签：sql-server, sql-server-2008-r2, bcp

我已经使用以下 BCP 命令很长时间了，但是我的数据的生产者更改了数据的日期时间格式，现在它因无效的强制转换规范而失败。

鉴于采用两个日期值的列是 SQL Server DateTime 数据类型，有谁知道我如何在下面显示的数据中进行 BCP？

```
bcp IDSCHEME in C:\IDSCHEME_20120926_1517.bcp -F2 -w -t"|^|" -r"|!|\n" -Uuser
-Ppass -Slocalhost 
```

这是新文件中标题行和第一个数据行的示例：

```
SchemeID|^|ActiveFrom|^|ActiveTo|^|UniqueName|^|SchemeEnglishName|!|
15000|^|1900-01-01T00:00:00|^|9999-12-31T00:00:00|^|BC|^|Business Classifications|!|
... lots more rows. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T15:31:11.003

回答：SQL Server BCP 目前不支持这种日期时间格式。如果需要，您可以使用 SQLCMD 命令行实用程序和 BULK INSERT 来模拟功能，这样您就不必转换数据文件。

# php - Jquery val() 不会重新检查/重新评估值

> ID：12647364
> 
> 赞同：0
> 
> 时间：2012-09-28T21:03:31.367
> 
> 标签：php, jquery

简短描述 我正在使用 jquery、jqueryUI 和 ajax。

我第一次完美地使用 val() 从字段中获取值，但是如果我更改字段中的值，则值保持不变。

详细描述我正在开发一个大项目我在这个项目上大约有 2 年的时间我的头在抽！;)

我有这样的事情：

这是 div 的 html：

```
<div id="add_task_diag" style="display: none">
   <label for="task">Task : </label><input id="taskfrm" label="Task" value="task" name="taskval" placeholder="e.g fill in tax form" />
   <button value="submit" class="btn btn-large add_task_frm">Add task</button> <button class="btn btn-large cancel_add_task">Cancel</button>
</div>
<button class="btn btn-primary" id="add_task"><i class="icon-file icon-white"></i> Add Todo</button> 
```

这是脚本：

```
<script>
$(".add_task_frm").click(function() {
    function taskgen() {
        var data = "task=" + $("#taskfrm").val();
        alert(data); // only for debuging
        var task_data = data;
        alert(task_data); // only for debuging
        $.post("whereitneedtogo.php?task=action80", task_data), //this is the ajax part
        $("#add_task_diag").dialog("destroy"); // I had here close I changed it to "destroy"
        task_data = undefined; //I tried to unset the variable
    }
    taskgen();
});​
</script> 
```

当我运行它时，一切正常！当我用另一个值重新发送时，变量保持不变。例如，如果我将 test123 放在第二个测试的字段中，它将保持 test123 我需要重新加载页面以重置变量。

我不想使用 location.reload()

该文件有 1700 多行，但这是问题所在。

我尝试了很多类似的事情： - 在 Dom 准备好后设置我的脚本 - 将我的变量设置为未定义或 null - 销毁 jquery 选项卡 - 唯一对我有用的部分似乎是 location.reload 但我的应用程序是完整的 ajax。

感谢您的帮助，我希望这是愚蠢或容易的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:10:50.737

为什么每次单击时都尝试声明和调用该函数。尝试将其移到单击事件处理程序之外。

```
<script>
$(".add_task_frm").click(function() {
    taskgen();
});​

function taskgen() {
        var data = "task=" + $("#taskfrm").val();
        alert(data); // only for debuging
        var task_data = data;
        alert(task_data); // only for debuging
        $.post("whereitneedtogo.php?task=action80", task_data), //this is the ajax part
        $("#add_task_diag").dialog("destroy"); // I had here close I changed it to "destroy"
        task_data = undefined; //I tried to unset the variable
    }

</script> 
```

当您想从其他地方调用 taskgen() 时，您可能还会遇到范围问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:11:29.583

这是因为您在点击处理程序中定义了您的闭包。将`taskgen`函数移到单击处理程序之外，将所有内容都包含在内，`$(document).ready()`您应该一切顺利！见下文：

```
$(document).ready(function() {

    $(".add_task_frm").click(function() {
       taskgen();
    });

    function taskgen() {
       var data = "task=" + $("#taskfrm").val();

       alert(data); // only for debuging
       var task_data = data;
       alert(task_data); // only for debuging
       $.post("whereitneedtogo.php?task=action80", task_data), //this is the ajax part
       $("#add_task_diag").dialog("close").dialog("destroy"); // I usually chain 'close' and 'destroy'
    }

}); 
```

# python - Clickatell 无法将消息路由到 Google 语音

> ID：12647368
> 
> 赞同：1
> 
> 时间：2012-09-28T21:04:05.133
> 
> 标签：python, sms, clickatell

当我使用 clickatell 向我的谷歌语音帐户发送短信时，它返回：ERR：114，无法路由消息

我住在美国，并发送到美国当地的谷歌语音号码。所以这不是国际短信吗？

以前有没有人遇到过这个问题，如果有，解决方案是什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T07:02:34.520

我终于得到了 Clickatell Tier 1 Consultant 的答复：

```
"Unfortunately we do not cover Google Voice numbers.

Please refer to the following link, to view which mobile operators we cover:

http://americas.clickatell.com/pricing-coverage/small-business-api/

The reason the error 114 does not appear in the reports is because it fails
on an API level, which means it fails before we can select an upstream supplier
to deliver a text message, therefore an API message I.D is not generated." 
```

# mysql - 内连接关键字搜索的SQL数据库索引设计

> ID：12647369
> 
> 赞同：2
> 
> 时间：2012-09-28T21:04:07.490
> 
> 标签：mysql, sql

我有这个查询

```
SELECT a.* 
FROM entries a 
INNER JOIN entries_keywords b ON a.id = b.entry_id 
INNER JOIN keywords c ON b.keyword_id = c.id 
WHERE c.key IN ('wake', 'up') 
GROUP BY a.id 
HAVING COUNT(*) = 2 
```

但它很慢。如何优化设计索引以加快速度？

**编辑** 这是当前模式

```
CREATE TABLE `entries` (`id` integer PRIMARY KEY AUTOINCREMENT, `sha` text);
CREATE TABLE `entries_keywords` (`id` integer PRIMARY KEY AUTOINCREMENT, `entry_id` integer REFERENCES `entries`, `keyword_id` integer REFERENCES `keywords`);
CREATE TABLE `keywords` (`id` integer PRIMARY KEY AUTOINCREMENT, `key` string);
CREATE INDEX `entries_keywords_entry_id_index` ON `entries_keywords` (`entry_id`);
CREATE INDEX `entries_keywords_entry_id_keyword_id_index` ON `entries_keywords` (`entry_id`, `keyword_id`);
CREATE INDEX `entries_keywords_keyword_id_index` ON `entries_keywords` (`keyword_id`);
CREATE INDEX `keywords_key_index` ON `keywords` (`key`); 
```

我用的是Sqlite3，查询没有失败，但是很慢。

现在我是这样的查询（每个关键字的子查询）：

```
select *
from (
    select *
    from (entries) e
    inner join entries_keywords ek on e.id = ek.entry_id
    inner join keywords k on ek.keyword_id = k.id
    where k.key = 'wake') e
inner join entries_keywords ek on e.id = ek.entry_id
inner join keywords k on ek.keyword_id = k.id
where k.key = 'up'; 
```

这速度更快，但感觉不对，因为如果我有很多关键字，它会变得很难看。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:08:21.260

该查询所需的关键索引

*   关键字（键）
*   entry_keywords(keyword_id,entry_id)
*   条目（ID）

您必须使用 MySQL，否则 SELECT a.* 会失败。
**在关于此声明的第二条评论之后编辑**，让我指出*为什么* `select a.*`会在这里失败 - 这是因为`GROUP BY`.

解释一下，因为条件（WHERE）在c.key上，所以需要索引。
然后这会针对 b.keyword_id 进行 JOIN。我们创建一个包含 b.entry_id 的索引，这样它就不必查找表——仅索引就可以覆盖所需的列。
最后，a.id=b.entry_id 连接回条目表，因此我们索引该表的 id。

它很可能`entries(id)`已经是主键，但您可能已经以相反的*方式建立*`entries_keywords`索引- 它无法满足此连接。

# algorithm - 用于创建家谱的树

> ID：12647373
> 
> 赞同：-1
> 
> 时间：2012-09-28T21:04:57.267
> 
> 标签：algorithm, tree, parent-child

我正在寻找一种好的算法来计算两个人的最低共同祖先，而无需初始整体树。

如果我有孩子，我可以打电话找家长。所以如果我有两个孩子，我需要打电话给每个孩子，直到他们有一个共同的祖先。至此，我应该有两个列表，我可以将它们构建成一棵树。

什么样的算法对此有好处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T18:52:18.223

如果有一些基本信息可以确定特定节点是否可以“原则上”成为另一个特定节点的父节点，那么它将允许您快速/有效地确定共同祖先（如果有的话）。这就是我关于“年龄”的问题——见评论——是关于的。年龄属性显然会给你那种类型的信息。

假设从您的回答中没有此类信息可用，则有两种明显的方法：

A. 向上扫描两棵树（getParent 等），为每个初始孩子构建祖先列表，同时检查每个新祖先是否出现在另一个孩子的祖先列表中。一般而言，没有理由假设共同祖先与两个孩子的距离（“几乎”）相等，因此您构建各自祖先列表的任何顺序都同样会给您在尽可能少的步骤。

这种方法的一个缺点是，您冒着不得不在相互列表中搜索大量新候选者的风险。这可能很慢。

B. 另一种方法是简单地独立构建两个祖先列表中的每一个，直到用尽。这可能相对较快，因为您不会在每一步都因必须检查“另一个”列表的内容而被打断。

然后，当你完成这两个列表时，你要么有一个共同的祖先，要么没有，只需通过相互验证顶部项目。如果没有，你就完成了（没有结果）。如果是的话，你同步地走回列表并检查它们分开的位置，再次避免列表搜索。

从一般的角度来看，我更喜欢方法 B。有时方法 A 当然会更快地产生结果，但在糟糕的情况下，它可能会变得乏味/缓慢，而方法 B 不会发生这种情况。我当然假设任何祖先列表都不能是循环的，即一个节点不能是它自己的祖先。

As a final note: IF, after all, you do have a property that "orders" nodes in the sense of "age", then you should build the two lists simultaneously, in the sense that you always process the list that has currently a top node which cannot possibly be the parent of the other list's topnode. This allows you to check only the current topnodes against each other (and not any other members of the lists).

# javascript - 扩展对象的原型在 Chrome 中有奇怪的行为

> ID：12647375
> 
> 赞同：0
> 
> 时间：2012-09-28T21:05:08.040
> 
> 标签：javascript, google-chrome, prototype-programming, prototyping

谁能解释一下为什么这段代码在谷歌浏览器下表现得如此奇怪：

```
<script>
console.log({someproperty:'hello'}) ;
Object.prototype.get = function(){} ;
</script> 
```

在控制台打印的对象的内容没有“someproperty”，而是有一个“get someproperty”，这是一个函数。
我正在使用 Chrome 21.0。

这是预期的吗？它是一个错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:23:41.723

我无法向您解释为什么将 Object.prototype.get 设置为不同的东西会导致这种奇怪的行为，除了几乎可以肯定 Chrome/Webkit 在幕后使用该函数来生成其花哨的对象日志记录。

我*可以*告诉您，即使您在 console.log 之后设置 .get 也会发生这种情况的原因是 Chrome/Webkit 在您实际单击控制台中的箭头以展开对象之前不会检索该对象。你可以通过运行这个 jsfiddle 来测试它：http: [//jsfiddle.net/BNjWZ/](http://jsfiddle.net/BNjWZ/)

请注意，如果您立即单击箭头展开对象，该对象将看起来很正常，但如果您等待 .get = function(){}; 3 秒钟；被调用，它将有'get's。

我在 22.0.1229.79 中看到了这种行为（对象显示中的奇怪“获取”和延迟的对象日志记录）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:05:24.140

这不是预期的。规范中没有关于属性名称的限制。因此，'get' 是对象属性和原型对象的合法名称。

这似乎是控制台全局 dir() 函数中的一个错误。

补充：JQuery 的 'get' 和 'set' 属性有问题。

# go - leveldb-go 示例，文档

> ID：12647378
> 
> 赞同：4
> 
> 时间：2012-09-28T21:05:21.797
> 
> 标签：go, leveldb

[LevelDB-Go](http://code.google.com/p/leveldb-go/)是 Go 语言中 LevelDB 的移植。LevelDB-Go 通常被称为 Go 应用程序的原生替代方案。网站没有示例，也没有文档。

我应该通过阅读源代码来学习它吗？或者有另一个网站有示例和文档？

库是否支持并发？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-02T08:42:07.783

我玩了一下 leveldb 这是我到目前为止得到的。这应该让你开始。

```
package main

import (
    "code.google.com/p/leveldb-go/leveldb/db"
    "code.google.com/p/leveldb-go/leveldb/table"
    "fmt"
    "runtime"
)

type kv struct {
    K []byte
    V []byte
}

type kvs struct {
    items map[int]kv
}

func (p *kv) PutKV(k []byte, v []byte) {
    p.K = k
    p.V = v
}

func (items *kvs) PutKVs() {
    fmt.Println(items)
}

func (p *kv) GetKV() (key []byte, value []byte) {
    key = p.K
    value = p.V
    return
}

func Check(e error) {
    if e != nil {
        _, file, line, _ := runtime.Caller(1)
    }
}

func p(r []byte, e error) {
    if e != nil {
        return e
    }
    println(string(r))
}

const (
    DBFILE = "/tmp/leveldb2.db"
)

var DBFS = db.DefaultFileSystem

func main() {
    Connection, e := DBFS.Create(DBFILE)
    Check(e)
    w := table.NewWriter(Connection, nil)
    defer w.Close()

    e = w.Set([]byte("1"), []byte("red"), nil)
    Check(e)
    e = w.Set([]byte("2"), []byte("yellow"), nil)
    Check(e)
    e = w.Set([]byte("3"), []byte("blue"), nil)
    Check(e)
    e = w.Close()
    Check(e)
    w = nil

    count()

    fmt.Println("Printing # KV")
    itemsKV := readByte()
    fmt.Println(itemsKV[0])
    fmt.Println(itemsKV[1])
    fmt.Println(itemsKV[2])
    println("Done Printing # KV")

    Connection, e = DBFS.Create(DBFILE)
    Check(e)
    w = table.NewWriter(Connection, nil)
    defer w.Close()
    e = w.Set([]byte("4"), []byte("green"), nil)
    Check(e)
    e = w.Set([]byte("5"), []byte("white"), nil)
    Check(e)
    e = w.Set([]byte("6"), []byte("black"), nil)
    Check(e)
    e = w.Close()
    Check(e)
}

func count() {
    Connection, e := DBFS.Open(DBFILE)
    Check(e)
    b := []byte("0")
    r := table.NewReader(Connection, nil)

    println("\n\n###### Counting ###### ")

    iter, n := r.Find(b, nil), 0
    for iter.Next() {
        n++
        println("Count # ", n)
    }

    e = r.Close()
    Check(e)
    println("#####Total: ", n)
}

func read() map[int64]string {
    Connection, e := DBFS.Open(DBFILE)
    Check(e)
    b := []byte("0")
    r := table.NewReader(Connection, nil)

    items := map[int64]string{}
    iter, _ := r.Find(b, nil), 0
    for iter.Next() {
        k := iter.Key()
        v := iter.Value()
        items[int64(k[0])] = string(v)
    }

    e = r.Close()
    Check(e)
    return items
}

func readByte() map[int]kv {
    Connection, e := DBFS.Open(DBFILE)
    Check(e)
    c := 0
    b := []byte("0")
    r := table.NewReader(Connection, nil)

    //items := map[int64]kv{}
    item := new(kv)
    items := map[int]kv{}
    iter, _ := r.Find(b, nil), 0
    for iter.Next() {
        k := iter.Key()
        v := iter.Value()
        item.PutKV(k, v)
        items[c] = *item
        c++
    }

    e = r.Close()
    Check(e)
    return items
}

func findOne(k []byte) []byte {
    Connection, e := DBFS.Open(DBFILE)
    Check(e)
    b := []byte("0")
    r := table.NewReader(Connection, nil)

    iter, _ := r.Find(b, nil), 0
    k = iter.Key()
    v := iter.Value()

    e = r.Close()
    Check(e)
    return v
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T01:06:06.023

如果我当时从邮件列表中回忆，LevelDB-Go 还不完整。这可能解释了缺乏文档和示例的原因。您可以使用项目问题跟踪器来请求文档和/或 ping 作者以查看它是否可以使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:11:27.057

LevelDB-Go 尚未完成，但有可用的 leveldb 包装器，名为[levigo](https://github.com/jmhodges/levigo)。你也可以查阅它的[文档](http://go.pkgdoc.org/github.com/jmhodges/levigo)。

# bash - 通过 ssh 获取以 nohup 启动的进程的 PID

> ID：12647382
> 
> 赞同：8
> 
> 时间：2012-09-28T21:05:26.757
> 
> 标签：bash, ssh, pid, nohup

我想通过 ssh 在远程机器上使用 nohup 启动一个进程。问题是如何让进程的PID以nohup启动，所以“进程实际上在做某事”，而不是一些外壳实例等。另外，我想将 stdout 和 stderr 存储在文件中，但这不是这里的问题......

在本地，它可以完美地使用

```
nohup sleep 30 > out 2> err < /dev/null & echo $! 
```

它向我呼应了命令“sleep 30”的确切 PID，我也可以使用“top”或“ps aux|grep sleep”看到它。

但我无法通过 ssh 远程执行此操作。我尝试了类似的东西

```
ssh remote_machine 'nohup bash -c "( ( sleep 30 ) & )" > out 2> err < /dev/null' 
```

但我不知道在哪里放置“回声$！” 以便它显示在我的本地外壳中。它总是向我显示错误的 PID，例如“bash”实例之一等。

有人知道如何解决这个问题吗？

编辑：好的，这里可能不需要“bash -c”。就像 Lotharyx 指出的那样，我可以很好地使用正确的 PID

```
ssh remote 'nohup sleep 30 > out 2> err < /dev/null & echo $!' 
```

但问题是，如果你用产生输出的东西代替“sleep 30”，比如“echo Hello World！”，那么输出不会在文件“out”中结束，无论是在本地还是在远程端。有人知道为什么吗？

EDIT2：我的错！另一台设备上没有剩余空间，这就是文件“out”和“err”保持空白的原因！

所以这是有效的。另外，如果要连续调用多个命令，用分号（;）分隔，仍然可以使用“bash -c”，如下所示：

```
ssh remote 'nohup bash -c "echo bla;sleep 30;echo blupp" > out 2> err < /dev/null & echo $!' 
```

然后它在本地打印出“bash -c”的PID，这很好。（不可能得到“最内层”或“忙碌”进程的PID，因为每个程序本身都会产生新的子进程，没有办法找出来……）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T21:15:29.487

我尝试了以下方法（本地机器是 Debian；远程机器是 CentOS），它的工作方式完全符合我的预期：

```
    ~# ssh someone@somewhere 'nohup sleep 30 > out 2> err < /dev/null & echo $!'
    某人@某处的密码：
    14193
    ~#

```

在远程机器上，我执行了 ps -e，看到了这一行：

```
    14193 ? 00:00:00 睡觉

```

所以，很明显，在我的本地机器上，输出是在远程机器上执行的“睡眠”的 PID。

为什么在通过 SSH 隧道发送命令时将 bash 添加到命令中？

# iphone - UIAlertView 清理背景

> ID：12647385
> 
> 赞同：0
> 
> 时间：2012-09-28T21:05:46.507
> 
> 标签：iphone, objective-c, uiviewcontroller, uialertview, nsnotificationcenter

[我阅读了有关背景模式](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html) 的苹果文档
，但我不明白什么时候应该关闭我的 UIAlertView。在`applicationWillResignActive:`通知中还是在`applicationDidEnterBackground:`？如果我在`applicationWillResignActive:`或中关闭 UIAlertView 有什么区别`applicationDidEnterBackground:`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T07:23:51.750

如果您的应用程序进入后台，您不必关闭警报*视图*。该`UIAlertView`文档指出：

> ...由您决定是关闭警报视图（并执行其取消处理程序）还是在应用程序移回前台时使其可见。

但是在很多情况下，关闭警报视图是有意义的。如果用户在 2 天后打开您的应用程序，他看到的第一件事是警告“您真的要删除此文件吗？” 他可能不再知道这个问题是关于什么的。对于这种情况，最好在应用程序进入后台时关闭警报并取消相应的操作。

我会为此目的使用`applicationDidEnterBackground`（或相应的），因为也称为临时中断，例如来电或短信。`UIApplicationDidEnterBackgroundNotification``applicationWillResignActive`

# ruby-on-rails - heroku run rake db:migrate 在输入控制台时正常工作，但在通过 rake 任务运行时不能正常工作

> ID：12647386
> 
> 赞同：0
> 
> 时间：2012-09-28T21:05:48.800
> 
> 标签：ruby-on-rails, heroku, rake, dbmigrate

我有以下任务：

```
task :migrate_test => :environment do
   puts 'Running database migrations ...'
   puts `heroku run rake db:migrate --app my-app`
end 
```

当我`heroku run rake db:migrate --app my-app`在控制台中运行时，迁移成功进行。但是，当我运行时`rake migrate_test`，我收到以下错误：

* * *

```
Running database migrations ...
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/dependency.rb:52:in `initialize': Valid types are [:development, :runtime], not nil (ArgumentError)
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/resolver.rb:371:in `new'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/resolver.rb:371:in `search'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/resolver.rb:361:in `gems_size'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/resolver.rb:159:in `start'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/resolver.rb:159:in `map'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/resolver.rb:159:in `start'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/resolver.rb:128:in `resolve'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/resolver.rb:127:in `catch'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/resolver.rb:127:in `resolve'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/definition.rb:182:in `resolve'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/definition.rb:113:in `specs'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/definition.rb:162:in `specs_for'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/definition.rb:151:in `requested_specs'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/environment.rb:23:in `requested_specs'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/runtime.rb:11:in `setup'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler.rb:116:in `setup'
    from /Users/Will/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.2.0/lib/bundler/setup.rb:17 
```

* * *

我相信这与在另一个找不到路径但无法找到解决方法的进程中运行任务有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:16:07.607

你的代码没有问题。在 GitHub 上查看[此问题](https://github.com/carlhuda/bundler/issues/592)。

只需更新 ruby​​gems 和 RVM。甚至更好：使用[rbenv](https://github.com/sstephenson/rbenv)！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T19:32:40.363

解决方案是升级 Heroku 工具带。我仍然收到一个错误`/Users/Will/.rvm/gems/ruby-1.9.3-p194@global/bin/rake: No such file or directory`，但我猜工具带足够聪明，可以补偿。最新的工具带可以在这里找到：[https ://toolbelt.heroku.com/](https://toolbelt.heroku.com/)

我还建议使用`exec ...`而不是`puts ...`在 rake 任务中，因为您将能够实时查看进度。

# c++ - 我的 Phoenix lambda 表达式有什么问题？

> ID：12647390
> 
> 赞同：0
> 
> 时间：2012-09-28T21:05:55.267
> 
> 标签：c++, boost, boost-phoenix

我希望以下示例 Boost Phoenix 表达式能够编译。

我错过了什么？

```
int plus(int a,int b)
{
    return a+b;
}

void main(int argc,char** argc)
{
    auto plus_1 = phx::bind(&plus,1,arg1);
    auto value  = phx::lambda[phx::val(plus_1)(arg1)]()(1);
    std::cout << value << std::endl;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T02:01:19.410

```
auto plus_1 = phx::bind(&plus,1,arg1); 
```

在这一行之后，`plus_1`是一个函数对象，它接受一个`int`参数并向其添加一个参数。

```
phx::lambda[plus_1(arg1)](1); 
```

哎呀。这是行不通的，因为（如上所述）`plus_1`是一个函数对象，它接受一个`int`参数并向其添加一个参数。在这里，您尝试使用`arg1`.

从您的代码中看不出您期望它做什么。你能澄清一下吗？

**====编辑====**

我看到您已经编辑了问题中的代码。您的代码仍然是错误的，但现在出于不同的原因。这：

```
phx::val(plus_1)(arg1) 
```

... 用于`val`创建一个返回`plus_1`一元函数的空函数。然后，您尝试使用 调用 nullary 函数`arg1`。繁荣。

这是执行和执行（我相信）您想要的代码：

```
#include <iostream>
#include <boost/phoenix/phoenix.hpp>
namespace phx = boost::phoenix;
using phx::arg_names::arg1;

int plus(int a,int b)
{
    return a+b;
}

int main()
{
    auto plus_1 = phx::bind(&plus, 1, arg1);
    int value = phx::bind(phx::lambda[plus_1], arg1)(1);
    std::cout << value << std::endl;
} 
```

第一个`bind`接受二进制`plus`并将其转换为一元函数，第一个参数绑定到`1`. 第二个创建了一个*与第一个等效*`bind`的新一元函数，但它是通过使用 安全地包装第一个函数来实现的。为什么这是必要的？考虑下面的代码，它是等效的，但没有：*`lambda``lambda`*

 *```
// Oops, wrong:
int value = phx::bind(phx::bind(&plus, 1, arg1), arg1)(1); 
```

请注意，它`arg1`出现了两次。所有表达式都是从内到外进行评估的。首先，我们将内部绑定`arg1`到`1`，然后评估内部`bind`yielding `2`，然后我们尝试绑定并调用它。那是行不通的，因为`2`它是不可调用的。

的使用为`lambda`内部创建了一个范围，`arg1`因此它不会被急切地替换。但是就像我说的那样，使用第二个`bind`，它强制需要 for `lambda`，产生一个与第一个等效的函数。所以它是不必要的复杂。但也许它可以帮助您了解`bind`,`lambda`和 Phoenix 范围。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T21:19:32.113

我不清楚你想通过`lambda`在这里使用来完成什么，但如果你只是想`plus_1`用`1`（导致`2`）调用，它比你的尝试简单得多：

```
#include <iostream>
#include <boost/phoenix.hpp>

int plus(int a, int b)
{
    return a + b;
}

int main()
{
    namespace phx = boost::phoenix;

    auto plus_1 = phx::bind(plus, 1, phx::arg_names::arg1);
    std::cout << plus_1(1) << '\n';
} 
```

^([在线演示](http://liveworkspace.org/code/de99a99396a4d6a3e52010d36cbdcc9d))

如果这*不是*你想要完成的，那么你需要描述你真正想要的。:-]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T16:39:55.757

也许这可以更好地解释它。

凤凰不是*魔法*；它首先是 C++。因此它遵循 C++ 的*规则*。

`phx::bind`是一个返回函数对象的函数，该对象具有`operator()`调用被绑定的函数的重载。您的第一条语句将此对象存储到`plus_1`.

考虑到这一切，***只要***你有表达式`plus_1(...)`，这就是一个*函数调用*。就是这样；你是说你想在`operator()`那个对象的类型上调用重载函数，并且你要把一些值传递给那个函数。

该表达式是否在 a 的中间`[]`并不重要。`phx::lambda`不能让 C++ 改变它的规则。除了立即函数调用之外，*它*不能进行`plus_1(...)`任何操作。也不能立即调用函数。*`arg1``plus_1(...)`**

# c# - 访问 Excel 电子表格中的行单元格计数

> ID：12647392
> 
> 赞同：1
> 
> 时间：2012-09-28T21:06:01.237
> 
> 标签：c#, excel, openxml

我需要知道如何使用 OpenXML 获取 Row 对象中的单元格数。目前，我正在使用

```
row.Descendants<Cell>().Count<Cell>() 
```

但这根本不正确。任何想法什么方法/属性给了我细胞计数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T12:29:58.620

您可以使用以下方法之一获取计数：

```
row.Descendants<Cell>().Count<Cell>() //The one you used

row.Elements<Cell>().Count<Cell>()

row.Count() 
```

我测试了所有这些，它们工作正常。在验证返回计数的正确性时，请记住以下几点：
- 隐藏列包含在计算中
- 合并的单元格单独计算。如果您的 Excel 工作表包含**3 列 A、B 和 C，但 A 和 B 已合并**，则单元格数为**3 而不是 2**

您可以使用以下方法提取工作表中所有合并单元格的列表：

```
SpreadsheetDocument ExcelSpreadSheet = SpreadsheetDocument.Open(ReportFile, true);
WorksheetPart ExcelWSP = GetWorksheetPartByName(ExcelSpreadSheet, TemplateEntity.ExcelSheetName);
MergeCells mergeList = ExcelWSP.Worksheet.Elements<MergeCells>().First(); 
```

合并信息保存在 Reference 属性中，您可以使用以下命令访问它：

```
((MergeCell)mergeList.ElementAt(i)).Reference 
```

# c# - 以非编程方式强制 .NET 应用程序的文化

> ID：12647393
> 
> 赞同：0
> 
> 时间：2012-09-28T21:06:04.087
> 
> 标签：c#, .net, globalization

我发现了很多关于以编程方式强制 .NET WinForm 程序（C#、.NET 4.5）的文化的帖子。

有没有办法在没有代码的情况下强制培养文化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T22:01:14.403

Windows 7 上的过程（对话框和名称已多次更改）：

*   开始 + 控制面板
*   单击区域和语言
*   单击“管理”选项卡
*   单击“更改系统区域设置”按钮
*   选择以“英语”开头并与您的客户居住地相匹配的语言环境之一。

在此之后启动的任何程序都将使用您在此对话框中选择的默认区域性进行初始化，这将锻炼您的附属程序集。

请注意，按照评论中的建议，更改 Thread.CurrentThread.CurrentCulture 和 CurrentUICulture 属性并不是真正的替代品。线程池线程仍然将自己初始化为系统语言环境。通过添加 CultureInfo.DefaultThreadCurrentCulture 和 DefaultThreadCurrentUICulture 属性，最终在 .NET 4.5 中解决了一个非常讨厌的问题。

请注意，许多本机 Windows 对话框（如 MessageBox 和 OpenFileDialog）仍会以您的操作系统语言显示文本。您需要购买 Windows Ultimate 的许可证并安装语言包以进行更改。MSDN 订阅是获得用户启动的特定语言操作系统的好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:58:22.567

另一个可能对您有用的奇怪选项是创建引导程序 exe，它将设置机器人文化设置（CurrentCulture 和 CurrentUICulture），然后加载您的实际 exe 并调用正确类的 Main 函数。具有仅在主线程上设置文化的所有缺点，但可能可以作为权宜之计。

# windows-runtime - ApplicationPageBackgroundThemeBrush 不工作？

> ID：12647401
> 
> 赞同：3
> 
> 时间：2012-09-28T21:06:50.610
> 
> 标签：windows-runtime, winrt-xaml

我想将页面的背景设置为我使用的用户选择的默认主题颜色：

```
Background="{StaticResource ApplicationPageBackgroundThemeBrush}" 
```

但这只是返回一个透明的背景。这不是默认主题颜色的正确方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T21:22:25.750

**Windows 8-8.1 答案**

不，事实上，Windows 应用商店应用程序无法访问用户选择的强调色。

**Windows 10 答案**

`(Color)Application.Current.Resources["SystemAccentColor"]``new UISettings().ColorValuesChanged`为您提供当前的强调色，您可以使用事件监视更改。

# php - 没有为 MySQLi 准备好的语句中的参数提供数据

> ID：12647404
> 
> 赞同：5
> 
> 时间：2012-09-28T21:06:57.653
> 
> 标签：php, mysqli

我一直在修改我的网站，从不受保护的 MySQL 查询到 mysqli 准备好的语句，一切都很顺利，直到我得到这个：没有为准备好的语句中的参数提供数据。

```
if(empty($err)) {
    $pSETQuery  = NULL;
    if(!empty($_POST['password'])) {
        $pSETQuery .= ", password = ?";
    }
    if($session->isSuperuser()) {
        $pSETQuery .= ", usertype = ?";
    }
    if(!($stmt = $database->prepare("UPDATE user SET username = ?, email = ? $pSETQuery WHERE UserId = ?"))) {
        $err[] = "PREPARE FAILED.";
    }
    $stmt->bind_param("s", $_POST['username']);
    $stmt->bind_param("s", $_POST['email']);
    if(!empty($_POST['password'])) {
        $stmt->bind_param("s", $_POST['password']);
    }
    if($session->isSuperuser()) {
        $stmt->bind_param("s", $_POST['usertype']);
    }
    $stmt->bind_param("i", $_POST['userid']);
    if(!$stmt->execute()){
        $err[] = "Execute failed. ERROR: " . $stmt->error;
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2020-12-09T12:41:17.607

您收到的错误是由于以下几行：

```
$stmt->bind_param("s", $_POST['username']);
$stmt->bind_param("s", $_POST['email']); 
```

您只能调用`bind_param()`一次，并且您需要提供确切数量的值，因为您在 SQL 中有占位符。这个功能设计得不好，这也是人们偏爱PDO的主要原因之一。

要解决这个问题，您需要动态准备 3 样东西：占位符、类型和要绑定的变量。以下是动态构建此类查询的方法：

```
if(empty($err)) {
    $pSETQuery  = '';
    $types = 'sss'; // for the three constant placeholders
    $data = [$_POST['username'], $_POST['email']];
    if(!empty($_POST['password'])) {
        $pSETQuery .= ", password = ?";
        $types .= 's'; //concat one more
        $data[] = $_POST['password'];
    }
    if($session->isSuperuser()) {
        $pSETQuery .= ", usertype = ?";
        $types .= 's'; //concat one more
        $data[] = $_POST['usertype'];
    }
    $data[] = $_POST['userid']; // for UserId

    $stmt = $database->prepare("UPDATE user SET username = ?, email = ? $pSETQuery WHERE UserId = ?");
    $stmt->bind_param($types, ...$data);
    $stmt->execute();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T12:47:37.270

你使用 Zend 框架吗？这可能是 PHP 和 Zend 之间的版本问题。我遇到了 PHP 5.3 + 的问题，他在使用 Zend 框架 1.8.3 插入或更新时遇到了同样的错误。

如果是这种情况，解决方案之一是将连接器更改为数据库。试试这个，它对我有用：

```
$db = new Zend_Db_Adapter_Pdo_Mysql(array(
    'host'     => '127.0.0.1',
    'username' => 'webuser',
    'password' => 'xxxxxxxx',
    'dbname'   => 'test'
)); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-18T17:58:10.990

我刚刚找到了解决同样问题的方法。

这是一个传递给 MySQL 的值，即`NULL`. 而此列不能`NULL`在表定义中......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-29T23:07:58.803

“未为准备好的语句中的参数提供数据”表示语句正常，但您提供给 bind_param 的至少一个变量未按预期存在！我会打印出 $_POST 并查看发生了什么并最终设置 $pSETQuery = ''; 而不是空！

```
$_POST['username']
$_POST['email']
$_POST['password']
$_POST['usertype']
$_POST['userid'] // this one is the one I would really watch after, how do you tell the userid if the user is not logged ( i assume that from email, passwrod and might be wrong) 
```

# php - 正则表达式将 abcd 转换为 (a(b(c(d))))

> ID：12647412
> 
> 赞同：3
> 
> 时间：2012-09-28T21:08:21.290
> 
> 标签：php, regex, preg-replace, pcre

我正在使用 PHP 的 preg_replace，并尝试转换字符串

`abcd`

进入

`(a(b(c(d))))`

这是我所拥有的最好的：

```
preg_replace('/.(?=(.*$))/', '$0($1)', 'abcd');
// a(bcd)b(cd)c(d)d() 
```

甚至可以使用正则表达式吗？

**编辑**我刚刚在 PCRE 规范中发现了这一点：`Replacements are not subject to re-matching`所以我原来的方法是行不通的。我想保留所有正则表达式，因为在我的实际用例中有一些更复杂的匹配逻辑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T21:13:06.873

怎么样：

```
preg_replace('/./s', '($0', 'abcd') . str_repeat(')', strlen('abcd')); 
```

?

（这算作“使用正则表达式”吗？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:18:18.593

您可以使用 preg_match_all。不过，不确定你想要什么样的角色。因此，我将为所有字符举一个例子：

```
$val = 'abcd1234';
$out = '';

if(preg_match_all('#.#', $val, $matches))
{
    $i = 0; // we'll use this to keep track of how many open paranthesis' we have
    foreach($matches[0] as &$v)
    {
        $out .= '('.$v;
        $i++;
    }
    $out .= str_repeat(")", $i);
}
else
{
    // no matches found or error occured
}

echo $out; // (a(b(c(d(1(2(3(4)))))))) 
```

也很容易进一步定制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:24:16.983

这是我的做法=)：

```
<?php
$arr = str_split("abcd");
$new_arr =  array_reverse($arr);

foreach ($new_arr as $a) {
    $str = sprintf('(%s%s)', $a, $str);
}
echo "$str\n";

?> 
```

[亲吻](http://en.wikipedia.org/wiki/KISS_principle)不是吗？（几行：6）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:24:24.543

我采用了上述答案的组合方式：

```
preg_match_all('/./ui', 'abcd', $matches);
$matches = $matches[0];
$string = '('.implode('(', $matches).str_repeat(')', count($matches)); 
```

# wordpress - 将 WordPress 存档列表拆分为多列

> ID：12647413
> 
> 赞同：1
> 
> 时间：2012-09-28T21:08:31.363
> 
> 标签：wordpress, list, count, archive, multiple-columns

我想将此存档列表分成多列（三列）...我不想为此使用 CSS3。我可以用 wp_list_categories 轻松做到这一点，但该方法不适用于 wp_get_archives。

理想情况下，我想实现一个计数器来添加大约 1/3 计数的标签......然后我可以使用 CSS 来完成其余的工作。

自定义存档功能：

```
function wp_custom_archive($args = '') {
global $wpdb, $wp_locale;
$defaults = array(
    'limit' => '',
    'format' => 'html', 'before' => '',
    'after' => '', 'show_post_count' => false,
    'echo' => 1
);
$r = wp_parse_args( $args, $defaults );
extract( $r, EXTR_SKIP );
if ( '' != $limit ) {
    $limit = absint($limit);
    $limit = ' LIMIT '.$limit;
}
// over-ride general date format ? 0 = no: use the date format set in Options, 1 = yes: over-ride
$archive_date_format_over_ride = 0;
// options for daily archive (only if you over-ride the general date format)
$archive_day_date_format = 'Y/m/d';
// options for weekly archive (only if you over-ride the general date format)
$archive_week_start_date_format = 'Y/m/d';
$archive_week_end_date_format   = 'Y/m/d';
if ( !$archive_date_format_over_ride ) {
    $archive_day_date_format = get_option('date_format');
    $archive_week_start_date_format = get_option('date_format');
    $archive_week_end_date_format = get_option('date_format');
}
//filters
$where = apply_filters('customarchives_where', "WHERE post_type = 'post' AND post_status = 'publish'", $r );
$join = apply_filters('customarchives_join', "", $r);
$output = '<ul>';
    $query = "SELECT YEAR(post_date) AS `year`, MONTH(post_date) AS `month`, count(ID) as posts FROM $wpdb->posts $join $where GROUP BY YEAR(post_date), MONTH(post_date) ORDER BY post_date DESC $limit";
    $key = md5($query);
    $cache = wp_cache_get( 'wp_custom_archive' , 'general');
    if ( !isset( $cache[ $key ] ) ) {
        $arcresults = $wpdb->get_results($query);
        $cache[ $key ] = $arcresults;
        wp_cache_set( 'wp_custom_archive', $cache, 'general' );
    } else {
        $arcresults = $cache[ $key ];
    }
    if ( $arcresults ) {
        $afterafter = $after;
        foreach ( (array) $arcresults as $arcresult ) {
            $url = get_month_link( $arcresult->year, $arcresult->month );
            /* translators: 1: month name, 2: 4-digit year */
            $text = sprintf(__('%s'), $wp_locale->get_month($arcresult->month));
            $year_text = sprintf('<li>%d</li>', $arcresult->year);
            if ( $show_post_count )
                $after = '&nbsp;('.$arcresult->posts.')' . $afterafter;
            $output .= ( $arcresult->year != $temp_year ) ? $year_text : '';
            $output .= get_archives_link($url, $text, $format, $before, $after);
            $temp_year = $arcresult->year;
        }
    }
$output .= '</ul>';
if ( $echo )
    echo $output;
else
    return $output; 
```

}

当前 HTML 输出（缩短）：

```
<ul>
<li>2012</li>
<li><a href='http://alittlesewing.com.s118336.gridserver.com/2012/09/' title='September'>September</a></li>
<li><a href='http://alittlesewing.com.s118336.gridserver.com/2012/08/' title='August'>August</a></li>
<li><a href='http://alittlesewing.com.s118336.gridserver.com/2012/07/' title='July'>July</a></li>
<li><a href='http://alittlesewing.com.s118336.gridserver.com/2012/06/' title='June'>June</a></li>
<li><a href='http://alittlesewing.com.s118336.gridserver.com/2012/05/' title='May'>May</a></li>
<li><a href='http://alittlesewing.com.s118336.gridserver.com/2012/04/' title='April'>April</a></li>
<li><a href='http://alittlesewing.com.s118336.gridserver.com/2012/03/' title='March'>March</a></li>
<li><a href='http://alittlesewing.com.s118336.gridserver.com/2012/02/' title='February'>February</a></li>
<li><a href='http://alittlesewing.com.s118336.gridserver.com/2012/01/' title='January'>January</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T16:52:56.030

如果我理解正确，你将不得不做这样的事情

```
$output = '<ul class="col1">';
if ( $arcresults ) {
    $numarticles = count($arcresults);
    $column1 = round($numarticles/3);
    $column2 = round($column1*2);
    $counter = 0;
    $afterafter = $after;
    foreach ( (array) $arcresults as $arcresult ) {
        if($counter == $column1) {
           $output .= "</ul><ul class='col2'>";
        } elseif($counter == $column2)  {
           $output .= "</ul><ul class='col3'>";
        }
        $url = get_month_link( $arcresult->year, $arcresult->month );
        /* translators: 1: month name, 2: 4-digit year */
        $text = sprintf(__('%s'), $wp_locale->get_month($arcresult->month));
        $year_text = sprintf('<li>%d</li>', $arcresult->year);
        if ( $show_post_count )
            $after = '&nbsp;('.$arcresult->posts.')' . $afterafter;
        $output .= ( $arcresult->year != $temp_year ) ? $year_text : '';
        $output .= get_archives_link($url, $text, $format, $before, $after);
        $temp_year = $arcresult->year;
        $counter ++;
    }
    $output .= '</ul>';
} 
```

这样，当计数器达到三分之一时，它会添加另一个列表，所以最后你将有 3 个列表。

希望这可以帮助。

# asp.net - 尝试创建通用事件处理程序引发程序时出错

> ID：12647417
> 
> 赞同：1
> 
> 时间：2012-09-28T21:08:44.940
> 
> 标签：asp.net, events, generics, event-handling

我有一组具有相同签名的事件，所以我试图创建一个通用的引发方法以供所有事件使用。

```
protected virtual void RaiseEvent<T>(EventHandler<T> eventToRaise, T eventArgs)
{
    if (eventToRaise != null)
    {
        try
        {
            eventToRaise(this, eventArgs);
        }
        catch (Exception ex)
        {
            throw new Exception("a problem accured while raising event : " + ex.Message);
        }
    }
} 
```

但是在尝试编译时出现此错误：

```
The type 'T' cannot be used as type parameter 'TEventArgs' in the generic type or method 'System.EventHandler<TEventArgs>'. There is no boxing conversion or type parameter conversion from 'T' to 'System.EventArgs' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T21:16:58.723

将泛型类型约束添加`where`到您的签名中：

```
protected virtual void RaiseEvent<T>(EventHandler<T> eventToRaise, T eventArgs) 
    where T : EventArgs 
```

# scala - 如何在 Scala 中定义特定容器类型的方法？

> ID：12647421
> 
> 赞同：2
> 
> 时间：2012-09-28T21:09:10.713
> 
> 标签：scala

我有一个`val list = List[Foo]()`并且我想在这个上定义某些方法，`List`但只有当它是类型时`Foo`，说`list.prettyDisplay()`。

这在 Scala 中可能吗？我正在查看有关高级类型的教程（[http://twitter.github.com/scala_school/advanced-types.html](http://twitter.github.com/scala_school/advanced-types.html)），但我认为我没有看到我在寻找什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T21:14:38.147

`List[Foo]`您可以定义从某个实现的类的隐式转换`prettyDisplay`。由于其参数的类型，此转换不适用于其他列表。

```
class Foo

implicit def betterFooList(l:List[Foo]) = new {
  def prettyDisplay() = ???
}

List(new Foo).prettyDisplay() 
```

# php - 将参数从laravel中的路由传递给控制器

> ID：12647424
> 
> 赞同：42
> 
> 时间：2012-09-28T21:09:50.077
> 
> 标签：php, laravel

**这是 LARAVEL 3 的问题**

鉴于以下路线

```
Route::get('groups/(:any)', array('as' => 'group', 'uses' => 'groups@show')); 
```

还有我想使用的网址，

```
http://www.example.com/groups/1 
```

我希望能够`(:any)`在我的控制器中使用该值。

我的控制器看起来像

```
class Groups_Controller extends Base_Controller {

    public $restful = true;    

    public function get_show($groupID) {
        return 'I am group id ' . $groupID;
    }  

} 
```

这怎么可能？我尝试了一些事情，包括以下内容

```
Route::get('groups/(:any)', array('as' => 'group', 'uses' => 'groups@show((:1))')); 
```

但它没有用。

**更新**

每当我尝试传递如上所示的参数时，我都会收到 404 错误。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-28T23:04:48.190

添加参数不需要任何特殊的东西。就像你拥有它一样。

```
Route::get('groups/(:any)', array('as' => 'group', 'uses' => 'groups@show'));

class Groups_Controller extends Base_Controller {

    public $restful = true;    

    public function get_show($groupID) {
        return 'I am group id ' . $groupID;
    }  

} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-07-31T10:47:58.783

这就是您在 1 行代码中所需要的。

`Route::get('/groups/{groupId}', 'GroupsController@getShow');`

建议：使用 CamelCase 而不是下划线，尝试并遵循[PSR-* 指南](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-1-basic-coding-standard.md)。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-05-13T12:02:31.453

你可以像这样添加它们

```
 Route::get('company/{name}', 'PublicareaController@companydetails'); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-19T05:53:22.327

```
 $ php artisan route:list
  +--------+--------------------------------+----------------------------+--    -----------------+----------------------------------------------------+---------  ---+
  | Domain | Method                         | URI                        |  Name              | Action                                             |    Middleware |
  +--------+--------------------------------+----------------------------+-------------------+----------------------------------------------------+------------+
  |        | GET|HEAD                       | /                          |                           
  |        | GET                            | campaign/showtakeup/{id}   | showtakeup         | App\Http\Controllers\campaignController@showtakeup | auth       |     | 
```

路由.php

```
 Route::get('campaign/showtakeup/{id}', ['uses' =>'campaignController@showtakeup'])->name('showtakeup'); 
```

活动.showtakeup.blade.php

```
 @foreach($campaign as $campaigns)

   //route parameters; you may pass them as the second argument to the method:

   <a href="{{route('showtakeup', ['id' => $campaigns->id])}}">{{ $campaigns->name }}</a>

            @endforeach 
```

希望这能解决您的问题。谢谢

# c - 字符指针如何处理每个字节的 MSB 位？

> ID：12647427
> 
> 赞同：2
> 
> 时间：2012-09-28T21:10:09.153
> 
> 标签：c, pointers

对于以下代码：

```
void main()
{
   int i;
   float a=5.2;
   char *ptr;
   ptr=(char *)&a;
   for(i=0;i<=3;i++)
      printf("%d ",*ptr++);
} 
```

我得到 o/p 为 102 102 -90 64 ..为什么？字符指针如何处理每个字节的 MSB 位？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:13:42.177

char 是有符号还是无符号是实现定义的。显然，系统中的 char 数据类型已签名。所以 MSB 是符号位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:50:09.163

如果将`5.2`浮点值转换为二进制格式，则会得到：

```
5.2 = 01000000 (=64) 10100110 (=166) 01100110 (=102) 01100110 (= 102) 
```

如果您取第 3 个字节 ( `166`) 并将其转换为一个`signed char`值（在 内`[-128, 127]`），那么您将获得`-90`.

编译您的程序`-funsigned-char`以获取`102 102 166 64`输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T21:13:34.340

在您的情况下，显然它将最高有效位视为符号位，换句话说，在您的实现`char`中是有符号整数类型，顺便说一句，带有二进制补码表示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T09:38:43.267

在您的情况下，`char`使用有符号位表示。就值而言，它们取决于您正在处理的系统的[字节顺序。](http://en.wikipedia.org/wiki/Endianness)

# android - 带有删除选项的 EditText

> ID：12647435
> 
> 赞同：-1
> 
> 时间：2012-09-28T21:10:51.383
> 
> 标签：android, android-layout, android-edittext

嗨，请给我一些示例，演示如何使用“删除”按钮创建 editText ，当单击删除选项时，它将删除创建的 editText 。提前致谢 ...

动态创建textEdit的代码..

```
LinearLayout rAlign = (LinearLayout)findViewById(R.id.lId);
        EditText newPass = new EditText(getApplicationContext());
        allEds.add(newPass);
        newPass.setHint("Name of Label");
        newPass.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
        newPass.setWidth(318);
        newPass.setTextColor(Color.parseColor("#333333"));
        newPass.setId(MY_BUTTON);
        //newPass.
        //newPass.setOnClickListener(this);
        rAlign.addView(newPass);
        MY_BUTTON ++;               
        addSpinner();  //Function for adding spinner 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:32:49.487

布局可能是这样的：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<EditText
    android:id="@+id/editText1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_marginTop="50dp"
    android:ems="10" >

    <requestFocus />
</EditText>

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/editText1"
    android:layout_alignBottom="@+id/editText1"
    android:layout_toRightOf="@+id/editText1"
    android:text="Button" /> 
```

Java 可能是这样的：

```
public class MainActivity extends Activity implements OnClickListener {

TextView tv;
Button btn;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    btn = (Button) findViewById(R.id.button1);
    tv = (TextView) findViewById(R.id.editText1);

    btn.setOnClickListener(this);
}

@Override
public void onClick(View v) {

    tv.setVisibility(View.GONE);

} 
```

}

# c++ - 为什么 C++11 的移动构造函数/赋值运算符不按预期运行

> ID：12647437
> 
> 赞同：8
> 
> 时间：2012-09-28T21:11:06.280
> 
> 标签：c++, visual-c++, c++11, visual-studio-2012, move-semantics

```
#include <iostream>

using namespace std;

struct A
{
    A()
    {
        cout << "A()" << endl;
    }

    ~A()
    {
        cout << "~A()" << endl;
    }

    A(A&&)
    {
        cout << "A(A&&)" << endl;
    }

    A& operator =(A&&)
    {
        cout << "A& operator =(A&&)" << endl;
        return *this;
    }
};

struct B
{
    // According to the C++11, the move ctor/assignment operator
    // should be implicitly declared and defined. The move ctor
    // /assignment operator should implicitly call class A's move
    // ctor/assignment operator to move member a.
    A a;
};

B f()
{
    B b;

    // The compiler knows b is a temporary object, so implicitly 
    // defined move ctor/assignment operator of class B should be
    // called here. Which will cause A's move ctor is called.
    return b; 
}

int main()
{
    f();
    return 0;
} 
```

我的预期输出应该是：

```
A()
A(A&&)
~A()
~A() 
```

但是，实际的输出是：（C++编译器是：Visual Studio 2012）

```
A()
~A()
~A() 
```

这是VC++的错误吗？还是只是我的误解？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-28T21:30:24.603

根据[这篇博](http://blogs.msdn.com/b/vcblog/archive/2011/09/12/10209291.aspx)文，VC++ 2012 目前实现[了 N2844](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2844.html) + [DR1138](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#1138)，但没有[实现 N3053](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3053.html)。因此，编译器*不会*为您隐式生成移动构造函数或赋值运算符。如果您添加显式默认值并将构造函数移动到，`B`那么您将获得您期望的输出。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-28T21:33:21.983

Visual C++ 2012 没有为右值引用和移动操作实现最终的 C++11 规范（规范在标准化过程中更改了几次）。*您可以在右值引用*下的 Visual C++ 团队博客文章[“Visual C++ 11 中的 C++11 功能”](http://blogs.msdn.com/b/vcblog/archive/2011/09/12/10209291.aspx)中找到更多信息。

 *具体而言，在您的示例中，这以两种方式表现出来：

*   用户定义的移动操作的定义`A`不会抑制隐式声明的复制操作。

*   没有隐式定义的移动操作`B`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T21:23:35.383

我不认为移动构造函数的声明会阻止复制ctor的生成。...而且编译器似乎更喜欢复制构造函数而不是移动构造函数。

实际上，根据 12.8 [class.copy] 第 7 段，移动构造函数的存在应该阻止复制构造函数：

> 如果类定义没有显式声明复制构造函数，则隐式声明。如果类定义声明了移动构造函数或移动赋值运算符，则隐式声明的复制构造函数定义为已删除；否则，它被定义为默认值（8.4）。

然而，移动构造的细节直到过程后期才改变，似乎 VC++ 没有实现实际标准，而是较早的修订版。*

# c# - 为插件设计合约

> ID：12647441
> 
> 赞同：1
> 
> 时间：2012-09-28T21:11:49.300
> 
> 标签：c#, plugins

我正在考虑为我目前正在开发的应用程序的未来插件创建设计一个适当的合同。基本上这个想法是定义一个接口，但我希望应用程序知道当前呈现给系统的插件，并向用户显示一个很好的插件列表，其中包含它们的名称和简短的描述，当然插件的开发人员应该提供，应用程序的用户不应该能够轻易地改变它，所以额外的配置文件不是一个选项。我不想为此使用程序集文件名的类名。另外我认为它应该可以在不实例化插件的情况下访问，但可以通过反射来访问，例如：`assembly.GetType(type).GetProperty("Name").GetValue(null, null).ToString();`. 当然，我可以提供一些逻辑来检查是否存在，例如`if(assembly.GetType(type).GetProperty("Name") != null)`，但这也不是一个好主意，因为如果该属性不存在，最终用户将不知道该插件的作用，甚至不知道它的名称是什么。现在，它的行为应该像一个静态属性，但静态是不可覆盖的，所以似乎我不能将它声明为接口的一部分，也不能在抽象类中声明。也许我走错了路，它看起来只是一个静态属性，我可以通过另一种方法实现这个功能。所以简短的问题可能是*“如何强制第三方开发人员提供一些关于他的插件的元信息”*。请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T23:17:26.910

您可以尝试使用两个接口：

`IAddIn`for 是所有加载项都将实现的主界面。

`IAddInInfo`作为提供插件元数据（名称、发布者、描述版本等）的接口

每个加载项都应该实现这两个。一个`IAddInInfo`实现可能是这样的：

```
public class ScannerAddInInfo : IAddInInfo
{
    public string Name { get { return "Scanner"; } }

    public string Description { get { return "Add-in for acquiring images from a scanner device"; } }
} 
```

为了确保加载项的所有实现都带有元数据，您可以创建`IAddIn`一个通用接口，例如：

```
public interface IAddIn<T> where T : IAddInInfo
{
    T Info { get; }

    //Continue with the rest of the members you would want every add-in to have.
} 
```

那么扫描仪插件实现将是：

```
public class ScannAddIn : IAddIn<ScannerAddInInfo>
{
    private ScannerAddInInfo _info = new ScannerAddInInfo();

    public ScannerAddInInfo Info { get { return _info; } }

    //Continue with the rest of the IAddIn implementation.
} 
```

然后，您可以从一个特殊的加载项文件夹加载加载项程序集，并创建实现类型的实例，`IAddInInfo`并在您的应用程序中显示来自已发现加载项的信息。请注意，尚未创建任何加载项。为此，您需要添加更多反射来查找实现的类型`IAddIn<ScannerAddInInfo>`。

为了使这更简单，您可以将加载项类型名称添加到`IAddInInfo`接口或类似的东西。

这种方法的唯一缺点是您必须加载在您的特殊加载项文件夹中找到的所有程序集，即使它们不包含任何加载项。

为避免这种情况，您可以尝试[Mono.Cecil](http://www.mono-project.com/Cecil#Documentation)。然后你将不得不做这样的事情：

```
AssemblyDefinition ad = AssemblyDefinition.ReadAssembly(assemblyPath); 

foreach (TypeDefinition td in ad.MainModule.GetTypes()) 
{ 
    if (td.BaseType != null && td.BaseType.FullName == "MyNamespace.MyAddInBase") 
    {         
        return true; 
    } 
} 
```

要加载程序集，您可以使用[Assembly.LoadForm](http://msdn.microsoft.com/en-us/library/f8c4tzhc.aspx)并创建加载项和加载项信息的实例，这是[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)重载之一。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:25:51.437

要向插件添加一些“元数据”，您可以使用属性。为您的插件创建一个自定义属性，并通过反射读出信息并将其显示在您的应用程序中。

有关属性的更多信息：

[创建自定义属性（C# 和 Visual Basic）](http://msdn.microsoft.com/en-us/library/sw480ze8.aspx)

[使用反射访问属性](http://msdn.microsoft.com/en-us/library/z919e8tw.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:37:19.430

您应该做的事情基本上是定义您的接口并期望其他人实现他们的具体类并以某种方式将该运行时对象提供给您（您的预定义方法、配置等）

但是有一些称为依赖注入的机制。这允许你定义你的接口和你的入口点，而一个“系统”负责匹配你的入口点和实现者的具体细节。为此目的有“System.ComponentModel.Composition”命名空间。

我知道有一个名为“Unity”的框架在做这样的工作。我猜组合命名空间在某种程度上是统一的简化版本。您可以查看“ImportAttribute”和“ExportAttribute”类的帮助以获取一些提示。

# c# - DragDrop 注册未成功异常

> ID：12647442
> 
> 赞同：0
> 
> 时间：2012-09-28T21:12:07.500
> 
> 标签：c#, winforms, drag-and-drop

我从 proc COM 服务器外启动了一个对话框，该对话框中有一些拖放 ctrl 操作。经过一些研究发现该对话框必须在 STA 线程中启动。我设法做到了，但对随后的对话有一些副作用。因此，计划在不使用内置的情况下实现拖放操作。IE。通过处理鼠标事件和切换光标，天气这是可行的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T21:07:53.363

我发现将 AllowDrop 属性设置为 false 后，无法实现自定义拖放。原因：从一个控件拖动时 - 不会触发其他控件的鼠标事件。IE，。在一个表单中，同时将 1 个按钮拖动到另一个面板：即使鼠标悬停/鼠标移动表单 /target panel dint 也会被触发。

# google-chrome-extension - Chrome 插件未正确初始化

> ID：12647445
> 
> 赞同：2
> 
> 时间：2012-09-28T21:12:17.537
> 
> 标签：google-chrome-extension

我正在尝试编写一个 chrome 插件，我使用以下清单定义了该插件：

```
{
  "name": "test",
  "version": "1.0",
  "background": { "scripts": ["background.js"] },
  "permissions": [
    "tabs", "http://*/*"
  ],
  "browser_action": {
    "name": "test",
    "icons": ["icon.png"]
  },
  "manifest_version": 2
} 
```

我的`background.js`文件如下所示：

```
chrome.app.runtime.onLaunched.addListener(function() { 
    console.log('details', chrome.app.getDetails());
}); 
```

加载时，我在控制台上看到此错误：

```
Uncaught TypeError: Cannot read property 'onLaunched' of undefined 
```

我不知道为什么我没有看到正确初始化的`chrome.app.runtime`.

我该如何调试？

基因

**更新：**

当我运行以下代码时：

```
console.log("before connection");
chrome.extension.onConnect.addListener(function(port) {
    console.log("connected");
}); 
```

我看到第一个日志输出 ( `before connection`) 但没有看到第二个；这是否意味着它无法连接到浏览器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T17:36:51.150

`chrome.app`未定义，因为您没有将扩展程序定义为应用程序。

Chrome 扩展程序只能是**清单**文件中的以下之一： `browser_action`、`page_action`、`theme`或`app`.

在您的清单中，您正在定义一个浏览器操作。

因此，深呼吸并阅读[清单文件](http://developer.chrome.com/extensions/manifest.html)的文档。

# javascript - 保护对象文字并防止它们被覆盖的好习惯

> ID：12647446
> 
> 赞同：2
> 
> 时间：2012-09-28T21:12:42.110
> 
> 标签：javascript, design-patterns, object-literal, revealing-module-pattern

我一直在对对象文字等进行一些研究。我正在创建一个具有来自我的玩家的各种属性的游戏。这些属性存储在多个组中，例如他的船和所有属性，他的武器和所有属性等。因此，我一直将这些属性存储到对象文字中。

我不希望我的对象值被覆盖。我在这里遇到了一篇文章[http://www.gabordemooij.com/jsoop.html](http://www.gabordemooij.com/jsoop.html)，并且很好奇这样的事情是否会是一个健康的开始，以防止对象值被轻易覆盖......

```
Cat = {
  createNew: function() {
    var cat = {};
    var sound = "meow"; //sound is local
    cat.makeSound= function(){
        //can reach sound from here
        alert( sound );
    }
    return cat;
  }
}

var cat = Cat.createNew();
cat.makeSound();
//but can't reach sound from here
alert(cat.sound); //fail! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:46:16.057

我在[jsFiddle](http://jsfiddle.net/9JFDj/)中设置了一个小测试来演示显示对象模式是多么美妙的事情：

```
var Test = (function(){
    var priv = "Banana";
    var public = "Orange";
    var pubobj = {name:"Cheese"};

    function constructor(){
        this.public = public;
        this.pubobj = pubobj;

        this.instance = {name:"Grape"};

        this.instanceMethod = function(){
            return priv;
        };
    };

    constructor.prototype.private = function(){
        return priv;
    };            

    return constructor;

})();

var myTest = new Test();

console.log(myTest.public);     //Orange
console.log(myTest.priv);       //undefined
console.log(myTest.private());  //Banana

var myTest2 = new Test();

console.log(myTest.public === myTest2.public);    //true (they are both primitives with the same value)
console.log(myTest.private === myTest2.private);  //true (the methods share the same instance)

myTest.public = "cheese";
console.log(myTest.public, myTest2.public);       // "cheese", "Orange" (overwriting the primitive doesn't change the primitive of myTest2)

myTest.pubobj.name = "Melon";                   
console.log(myTest.pubobj, myTest2.pubobj);       //the name property for both is now "Melon" (both test objects share the same instance of pubobj)

myTest.instance.name = "Raspberry";
console.log(myTest.instance, myTest2.instance);  // the name of myTest2.instance is unchanged

console.log(myTest.instanceMethod === myTest2.instanceMethod);​  // false (while identical, these methods have separate instances) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:36:34.243

它失败了，因为声音是一个不能在对象外部引用的局部变量。

如果你想引用它，你需要做一个getter。

```
Cat = {
  createNew: function() {
    var cat = {};
    var sound = "meow"; //sound is local
    cat.getSound= function(){
        //can reach sound from here
        return sound;
    }
    return cat;
  }
}

var cat = Cat.createNew();
alert(cat.getSound()); 
```

或者

```
Cat = {
  createNew: function() {
    var cat = {};

    var props = {
        sound : "meow",
        foo : "bar"
    };

    cat.get= function(key){            
        return props[key];
    }
    return cat;
  }
}

var cat = Cat.createNew();
alert(cat.get("sound")); 
```

# c - 指向指针的指针给出分段错误？

> ID：12647454
> 
> 赞同：1
> 
> 时间：2012-09-28T21:13:09.887
> 
> 标签：c

这是代码

```
 int main
    {
    char s[]="prady";
    char **p;

    p=(char **)&s;

    printf("%u %u\n",p,*p);
    printf("%u %u\n",&s,s); 

    printf("%s\n",s);
    printf("%s\n",&s);
    printf("%u %u\n",s+1,&s+1);

    printf("%s\n",p);
    printf("%s\n",*p);
    } 
```

o/p：

```
3217062327 1684107888
3217062327 3217062327
prady
prady
3217062328 3217062336
prady
Segmentation fault 
```

我的疑惑如下

1.  s和&s的地址如何相同？

2.  如果两者相同，那么在添加 1 时它们如何显示不同？

3.  我如何在 *p 中出现分段错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:58:36.480

首先，数组不是指针。指针不是数组。数组**衰减**为指针。

`1.How both the address is same of s and &s?`

```
char s[]="prady";

   --------------------------
s: | p | r | a | d | y | \0 |
   -------------------------- 
```

该数组`s`是一个要求留出 6 个字符的请求。换句话说，`s`有 6 个字符。's` 是一个“东西”，它不指向任何东西，它只是。

```
char *ptr = "prady";

------         --------------------------
|*ptr|    -->  | p | r | a | d | y | \0 |
------         -------------------------- 
```

指针`ptr`请求一个存放指针的地方。指针可以指向任何字符或任何字符串文字（连续字符）。

另一种思考方式：

```
int b;   //this is integer type 
&b;      //this is the address of the int b, right?  

int c[]; //this is the array of ints 
&c;      //this would be the address of the array, right? 
```

所以这是可以理解的：

```
*c;   //that's the first element in the array 
```

那行代码告诉你什么？如果我尊重 c，那么我会得到一个 int。这意味着只是简单的 c 是一个地址。由于它是数组的开头，它是数组的地址，因此：

```
c == &c; 
```

`2\. If both are same then how they show different when adding 1 to it.`

从我对＃1的回答中，我假设您明白为什么它们不一样。那么为什么你会得到不同的值呢？看看你得到的值：

```
s    = 0x3217062327 
s+1  = 0x3217062328  // It's 1 bigger, why? Because a char takes 1 byte, s holds chars
                     // so s (address of a char) + 1 (sizeof char) gives you one more than s
&a + 1 //This is adding 1 (sizeof array) which is bigger than the size of a char 
```

`3\. How I got segmentation fault in *p.`

我想你可以从我之前的两个答案中得到这个......但是：

1.  p 是指向字符的指针
2.  您将 p 设置为数组的地址（记住，是数组本身）
3.  对 p 的尊重是指向 char （另一个地址）的指针，但是您不能对数组执行此操作。

当您进行类型转换时，您告诉编译器“我比您更了解，所以只需让这两个工作”。当你出现段错误时......那是因为你真的不知道更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:38:15.380

> 1.s和&s的地址如何相同。

`s`是一个字符数组。但是，数组被转换为指针，保存在少数情况下：当它们用于初始化数组时（例如：你的`char s[]="prady";` 行），当它们是一元运算`&`符的操作数时（你的代码中有很多情况），当它们是运算符的操作数`sizeof`。

> 2.如果两者相同，那么在向其添加 1 时它们如何显示不同。

他们不一样。

> 2.我是如何在 *p 中得到分段错误的。

`p`包含 的地址`"prady"`。`*p`包含`"prady"`. 尝试将`"prady"`其用作字符串的地址会导致段错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T21:18:03.353

在您的情况下， s 不是指针。这是一个数组！

一个小小的改变将解决一个问题：

```
char *s = "prady"; 
```

# android - 无法将 facebook sdk 导入我的 android 项目

> ID：12647455
> 
> 赞同：0
> 
> 时间：2012-09-28T21:13:31.727
> 
> 标签：android, facebook, facebook-android-sdk

我已经为我的 android 项目导入并添加了 facebook sdk。但是在 gen 文件夹下的项目中，然后在 com.facebook.android 文件夹下，我只得到 R.java 文件。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:52:14.560

您必须将其导入您的工作区并将其配置为库（ Properties/Android/Library Is Library 检查）

然后将其导入到您的项目中 Properties/Android/Library 添加 facebook 项目

检查 facebook 项目是否在您的构建路径 Properties/Java Build Path/Projects

然后你应该在 Android Dependencies 下看到它

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-03T10:39:17.897

你可以反过来做，而不是导入 facebook 库，只需将整个包 com.facebook.android 复制到你的项目中......就是这样......不需要导入任何东西......

# r - 仅安装此软件包会加速 R 吗？

> ID：12647469
> 
> 赞同：6
> 
> 时间：2012-09-28T21:14:41.343
> 
> 标签：r

根据[此链接](http://statcomputingucdavis.github.com/Spring12BBSeminar/Config_BLAS.pdf)， 仅在 Ubuntu 中安装以下软件包将显着加快 R*的某些计算*：

```
libatlas3gf-base 
```

我是否必须从源代码编译才能获得此好处？如果没有，`R`安装此软件包后是否必须重新安装？

是否还有其他与此类似的软件包，它们可以通过安装它们来加快速度？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T22:01:53.377

基本`libatlas3gf-base`包已经对默认的“reference blas”有所帮助，但您可以（如果您愿意）通过本地构建 Atlas 做得更好。这在某种程度上就是 Atlas 的重点，因为 A 和 T 代表 Automatically Tuned。

现在，请记住 a) 重建软件包并不像安装基础软件包那么简单，并且 b) 您指出*某些计算*是完全正确的。您在 R 中花费的净时间很少会受到您可以在此处加速的线性代数运算的限制。所以对我来说，在我的 Ubuntu 和 Debian 系统上安装 atlas-base 通常就足够了。

# python - 尝试索引数组时，具有多个元素的数组的真值不明确

> ID：12647471
> 
> 赞同：20
> 
> 时间：2012-09-28T21:14:50.987
> 
> 标签：python, numpy, list-comprehension

如果 var（另一个 numpy 数组）中的元素是 >=0 和 <=.1 ，我试图将 rbs 的所有元素放入一个新数组中。但是，当我尝试以下代码时，出现此错误：

```
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() 
```

* * *

```
rbs = [ish[4] for ish in realbooks]
for book in realbooks:
    var -= float(str(book[0]).replace(":", ""))
    bidsred = rbs[(var <= .1) and (var >=0)] 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-28T21:22:52.380

正如我在对先前答案的评论中告诉您的那样，您需要使用以下任一方法：

```
c[a & b] 
```

或者

```
c[np.logical_and(a, b)] 
```

原因是`and`Python 使用关键字在两个布尔值之间进行测试。数组怎么可能是布尔值？如果它的 75% 的项目是`True`，是吗`True`？`False`因此，numpy 拒绝比较两者。

因此，您要么必须使用逻辑函数逐个元素地比较两个布尔数组 ( `np.logical_and`)，要么使用二元运算符`&`。

此外，出于索引目的，您确实需要一个与您要索引的数组大小相同的布尔数组。*它必须是一个数组*，你不能使用一个列表来`True/False`代替：原因是使用布尔数组告诉 NumPy 返回哪个元素。如果您使用 的列表`True/False`，NumPy 会将其解释`1/0`为整数列表，即索引，这意味着您将获得数组的第二个或第一个元素。不是你想要的。

现在，您可以猜到，如果您想使用两个布尔数组`a`或`b`用于索引，选择其中一个`a`或`b`为 True 的项目，您将使用

```
c[np.logical_or(a,b)] 
```

或者

```
c[a | b] 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-28T21:21:38.340

尝试在涉及 Numpy 数组的比较表达式上使用 Python 布尔运算符 ( `not`, `and`, ) 时，通常会收到此错误消息，例如`or`

```
>>> x = np.arange(-5, 5)
>>> (x > -2) and (x < 2)
Traceback (most recent call last):
  File "<ipython-input-6-475a0a26e11c>", line 1, in <module>
    (x > -2) and (x < 2)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() 
```

这是因为这样的比较，与 Python 中的其他比较相反，创建布尔数组而不是单个布尔值（但也许你已经知道了）：

```
>>> x > -2
array([False, False, False, False,  True,  True,  True,  True,  True,  True], dtype=bool)
>>> x < 2
array([ True,  True,  True,  True,  True,  True,  True, False, False, False], dtype=bool) 
```

您的问题的部分解决方案可能替换`and`为`np.logical_and`，它在两个数组上广播 AND 操作`np.bool`。

```
>>> np.logical_and(x > -2, x < 2)
array([False, False, False, False,  True,  True,  True, False, False, False], dtype=bool)
>>> x[np.logical_and(x > -2, x < 2)]
array([-1,  0,  1]) 
```

但是，此类布尔数组不能用于索引普通 Python 列表，因此您需要将其转换为数组：

```
rbs = np.array([ish[4] for ish in realbooks]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-17T19:57:08.047

```
# draw the previous original bounding boxes
if rectsPersist != None:
    for (x, y, w, h) in rectsPersist:
        cv2.rectangle(orig, (x, y), (x + w, y + h), (0, 0, 255), 2)

# draw the previous final bounding boxes
if pickPersist != None:
    for (xA, yA, xB, yB) in pickPersist:
        cv2.rectangle(image, (xA, yA), (xB, yB), (0, 255, 0), 2)

if not count % 1:
    count = 0
    image = imutils.resize(image, width=min(700, image.shape[1])) 
```

如果 rectsPersist != None: ValueError: 具有多个元素的数组的真值是不明确的。使用 a.any() 或 a.all()

# c# - 如何将 UserControl 显示到表单中

> ID：12647473
> 
> 赞同：2
> 
> 时间：2012-09-28T21:15:14.870
> 
> 标签：c#, winforms

我创建了一个 UserControl，当我单击某个按钮时，我希望将此 UserControl 显示到我的表单中。

有什么办法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-28T21:38:20.673

您可以将用户控件动态添加到表单控件集合中。

例如，在按钮单击事件处理程序中：

```
MyUserControl uc = new MyUserControl();
uc.Dock = DockStyle.Fill;
this.Controls.Add(uc); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:17:55.783

把它放在表格上。启动它是不可见的，当单击按钮时将其设置为可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:18:17.703

将您的用户控件拖到您的表单并将其 Visible 属性更改为 false

```
UserControl1.Visible = false; 
```

然后在您的按钮上将您的用户控件的可见性设置为 true。

```
private void button1_Click(object sender, EventArgs e)
{
    UserControl1.Visible = true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:20:37.163

它是典型的 ascx 类型的控件吗？如果是，那么您可以通过按钮单击事件设置控件的“可见”属性。

假设你有：

```
<uc1:ft ID="userctrl"  runat="server" Visible="false" /> 
```

然后在您的按钮事件上：

```
protected void Button1_Click(object sender, EventArgs e)
{
    userctrl.Visible = true;
} 
```

# android - webview打开默认浏览器，不知道代码放哪

> ID：12647476
> 
> 赞同：3
> 
> 时间：2012-09-28T21:15:25.737
> 
> 标签：android, url, android-webview

所以，我已经用谷歌搜索了 4 个小时了 :( 我无法让网站只在应用程序中保持打开状态。点击登录后输入用户名和密码后，页面会在默认浏览器中打开。我的学到的是，我应该使用：`shouldOverrideUrlLoading()` 但我不知道它在哪里以及如何使用它。这是我的`MainActivity.java`，我在哪里或放什么来阻止它在默认浏览器中打开。（忽略***）

```
package com.example.***.*******c;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.webkit.WebView;

public class MainActivity extends Activity {

    private WebView mWebView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mWebView = (WebView) findViewById(R.id.webview);
        mWebView.getSettings().setJavaScriptEnabled(true);
        mWebView.loadUrl("http://www.*******.org/");
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-28T21:19:37.687

您必须实现一个扩展 WebViewClient 的类并在其中覆盖它。试试这个：

```
public class MainActivity extends Activity {

    private WebView mWebView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mWebView = (WebView) findViewById(R.id.webview);
        mWebView.getSettings().setJavaScriptEnabled(true);
        webView.setWebViewClient(new MyWebViewClient());
        mWebView.loadUrl("http://www.*******.org/");
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    private class MyWebViewClient extends WebViewClient {

        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return false;
        }
    }
} 
```

# css - 大型下拉导航菜单不覆盖具有相对位置的 div

> ID：12647478
> 
> 赞同：0
> 
> 时间：2012-09-28T21:15:34.987
> 
> 标签：css, drop-down-menu, position

我发现[这个](http://net.tutsplus.com/tutorials/html-css-techniques/how-to-build-a-kick-butt-css3-mega-drop-down-menu/)使用 CSS3 的大型下拉菜单。这工作得很好，但我有任何问题。我把这个菜单放在后面`DIV`。`position:relative`现在，当我`hover` `LI`菜单（主页）时，下拉菜单不覆盖我的 div。如何解决这个问题？[演示](http://jsfiddle.net/BBKING/b6r9Q/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:19:34.647

给你：http: [//jsfiddle.net/b6r9Q/1/](http://jsfiddle.net/b6r9Q/1/)

只需输入 z-index: 1; 在下拉列中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:20:54.800

只需增加下拉列的 z-index 即可。见这里[http://jsfiddle.net/b6r9Q/3/](http://jsfiddle.net/b6r9Q/3/)

```
.dropdown_1column, 
.dropdown_2columns, 
.dropdown_3columns, 
.dropdown_4columns,
.dropdown_5columns {
    z-index:500;
    margin:4px auto;
    float:left;
    position:absolute;
    left:-999em; /* Hides the drop down */
    text-align:left;
    padding:10px 5px 10px 5px;
    border:1px solid #777777;
    border-top:none;

    /* Gradient background */
    background:#F4F4F4;
    background: -moz-linear-gradient(top, #EEEEEE, #BBBBBB);
    background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#EEEEEE), to(#BBBBBB));

    /* Rounded Corners */
    -moz-border-radius: 0px 5px 5px 5px;
    -webkit-border-radius: 0px 5px 5px 5px;
    border-radius: 0px 5px 5px 5px;
} 
```

# c# - 如何将返回的强类型对象值分配给标签文本？

> ID：12647479
> 
> 赞同：-1
> 
> 时间：2012-09-28T21:15:41.570
> 
> 标签：c#, entity-framework

我有一个存储过程，我将其作为实体框架模型中的函数导入。我想将存储过程的值之一分配给我的 label.text 但它没有出现在智能感知中。我一定做错了什么。有人可以帮忙吗？

```
 private void GetBackgroundData()
    {
        List<GetBackground_Result> results = context.GetBackground().ToList();
        lblFullName.Text = results.FullName  // FullName doesn't appear in my intellisense
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:17:26.847

`results`是一个列表，而不是`GetBackground_Result`. 您需要从集合中获取单个元素来设置文本：

```
// if there could be multiple elements in the list
lblFullName.Text = results.First().FullName;

// or, if there should only be one element in the list
lblFullName.Text = results.Single().FullName; 
```

# java - JPanel 不会出现在 JFame 中

> ID：12647484
> 
> 赞同：2
> 
> 时间：2012-09-28T21:16:28.450
> 
> 标签：java, swing, graphics, jframe, jpanel

我是java新手。我确实有一个 java 类，但我想继续前进。我很喜欢！这是我的问题。我正在尝试绘制游戏所需的两个桨。我确实为它们创建了 2 个对象，它们都“显示”，但会发生以下情况：

主要赛跑者

```
import javax.swing.JFrame;

public class PongRunner {

    public static void main (String[] args)
    {

        new PongRunner();
    }

    public PongRunner()
    {
        JFrame PongFrame= new JFrame();
        PongFrame.setSize(800,600);
        PongFrame.add(new PaddleB());
        PongFrame.add(new PaddleA());
        PongFrame.setLocationRelativeTo(null);
        PongFrame.setTitle("My Pong Game");
        PongFrame.setResizable(false);
        PongFrame.setVisible(true);
        PongFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }

} 
```

`PaddleA`并且`PaddleB`都是drawRect Graphics并绘制一个特定的矩形。

我告诉`JFrame`首先添加的图形是唯一可见的。它下面的那个没有被添加到框架中我想知道为什么，以及如何将两个桨画在同一个`JFrame`... 2天。一些帮助会很好。我刚开始学习java，我认为我正在取得进步。一些技巧也很好，谢谢:)，特别是`actionListener`因为我将不得不使用它们来移动桨！

两个桨的源代码：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JPanel;
import javax.swing.Timer;

public class PaddleA extends JPanel implements ActionListener
{
    private Timer timer;

    public void timer()
    {
        timer = new Timer(25, this);
        timer.start();

    }

public void actionPerformed(ActionEvent e)
{
    repaint();
}

public void paintComponent(Graphics g)
{
    super.paintComponent(g);
    g.setColor(Color.RED);
    g.fillRect(70,200,20,100);      
}
} 
```

桨B：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JPanel;
import javax.swing.Timer;

public class PaddleB extends JPanel implements ActionListener
{

private Timer timer;

    public void timer()
    {
        timer = new Timer(25, this);
        timer.start();

    }

    public void actionPerformed(ActionEvent e)
    {
        repaint();
    }

    public void paintComponent(Graphics g)
    {
        super.paintComponent(g);
        g.setColor(Color.BLUE);
        g.fillRect(500, 200, 20, 100);

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:50:14.480

这是因为您添加了第一个桨，然后在第一个桨上添加了第二个桨，从而替换了它们：

```
 PongFrame.add(new PaddleB());
    PongFrame.add(new PaddleA()); 
```

在这里尝试使用`LayoutManager`s 只是一个快速示例：

```
 PongFrame.getContentPane().add(new PaddleB(),BorderLayout.WEST);
    PongFrame.getContentPane().add(new PaddleA(),BorderLayout.EAST); 
```

您`g.fillRect(...);`的 x 和 y 坐标也太大`JFrame`，因此不会显示。像这样改变它：

```
 g.fillRect(0,0, 20, 100); 
```

虽然不相关：

*   不要`JFrame.add()`使用`JFrame.getContentPane().add()`

更新：

正如其他人提到的那样，游戏的逻辑有点不对劲。您应该有一个单独的*绘图面板*，它添加到s 中，`JFrame`并且所有绘图都是在单个`JPanel`using `Graphic`s 而不是`JPanel`s 上完成的。这是一个小例子：

![在此处输入图像描述](../Images/9368a7b88b54932a7dbcf8377fa073c0.png)

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Rectangle;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class PongRunner {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new PongRunner();
            }
        });
    }

    public PongRunner() {
        JFrame PongFrame = new JFrame();
        PongFrame.setTitle("My Pong Game");
        PongFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        PongFrame.setResizable(false);
        PongFrame.setSize(400,400);
        //PongFrame.setLocationRelativeTo(null);
        PongFrame.getContentPane().add(new DrawingPanel());
        PongFrame.setVisible(true);
    }
}

class DrawingPanel extends JPanel {

    Rect rect1, rect2;

    public DrawingPanel() {
        super(true);
        rect1 = new Rect(80, 80, 20, 100, Color.yellow);
        rect2 = new Rect(100, 200, 20, 100, Color.red);

    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.setColor(rect1.getColor());
        g.fillRect(rect1.getX(), rect1.getY(), rect1.getWidth(), rect1.getHeight());
        g.setColor(rect2.getColor());
        g.fillRect(rect2.getX(), rect2.getY(), rect2.getWidth(), rect2.getHeight());
    }
}

class Rect {

    private Color color;
    private int x, y, height, width;

    Rect(int x, int y, int width, int height, Color color) {
        this.x = x;
        this.y = y;
        this.height = height;
        this.width = width;
        this.color = color;
    }

    public Color getColor() {
        return color;
    }

    public int getX() {
        return x;
    }

    public int getY() {
        return y;
    }

    public int getWidth() {
        return width;
    }

    public int getHeight() {
        return height;
    }

    public Rectangle getBounds() {
        return new Rectangle(x, y, width, height);
    }
} 
```

请注意，此片段并不完美，仅演示了绘制矩形以形成某种游戏所需的陈规定型逻辑

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T21:29:38.147

由于您已将 2 个 paddle 添加到`BorderLayout.CENTER`main 的同一位置，因此`PongFrame`只会显示第二个 paddle。

这种类型的绘画更容易在一个`Graphics`对象上使用一个对象来完成`JComponent`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T21:32:51.640

Swing 组件并不是真正设计成这样使用的。您的每个桨 JPanel 都试图绘制一个矩形，但容器（JFrame）及其布局管理器将控制 JPanel 的大小和位置。所以他们绘制的矩形可能超出了他们的界限，根本不会出现。

如果您像这样一个接一个地添加它们，某些布局管理器将仅显示其中一个 JPanel - 请参阅*Reimus*的回答。

要制作这样的动画图形，您可能需要从填充 JFrame 的单个 JComponent（例如 JPanel）开始，并将两个桨画为矩形。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:28:37.057

我没有时间尝试运行您的代码，但尝试设置“桨”对象的大小和位置，或者将它们设置为不透明。我相信 Swing 试图通过不绘制完全被另一个不透明组件覆盖的组件来加速渲染。出于这个原因，它可能不会画出你的一个桨。

如果您确实设置了桨的大小和位置，您可能需要修改您的`paintComponent`方法：如果我的记忆是正确的，我认为`Graphics`传入的对象被剪辑到组件的区域，所以 0,0 将是组件的左上角。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T21:29:17.413

您不应该`JFrame`通过该`JFrame#add(Component)`方法将您的 JPanel 添加到您的。最好将它们添加到 contentPane：`frame.getContentPane().add(panel);`尽管您应该阅读有关[LayoutManager](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)的信息。他们可以通过在框架中定位组件来帮助您，或者如果您使用不正确，它们会搞砸。

# iphone - 每次调用网络服务时都应该检查互联网连接吗？

> ID：12647486
> 
> 赞同：0
> 
> 时间：2012-09-28T21:16:45.537
> 
> 标签：iphone

我只想知道测试互联网连接可用性的最佳实践。
我的应用程序对所有内容都使用互联网连接。
如果我每次都检查 google.com 是否可用，那么我肯定会在用户每次向我的服务器发出请求时延迟获取他的数据。

所以我的问题是我应该在每次发出网络服务请求时检查连接可用性，还是应该使用某种全球互联网检查器来保持特定时间段内的互联网连接状态？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T06:06:58.797

我在我的应用程序中使用了以下代码来检查互联网连接。

```
-(void) connection: (NSURLConnection *) connection didFailWithError:(NSError *)error
{
UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"Error" message:@"No Internet Connection " delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:nil];
[alert show];
} 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:23:40.570

您的应用使用其他人的服务器（在本例中为 google.com）来验证互联网连接似乎是不礼貌的。

我会通过对请求本身设置一个合理的（可能是几秒钟）超时来解决这个问题。不知道您使用什么 API 或协议（HTTP 等）来发出请求，我无法评论如何实现这样的超时。

# javascript - 未触发 YUI 'valuechange' 事件

> ID：12647489
> 
> 赞同：0
> 
> 时间：2012-09-28T21:16:58.343
> 
> 标签：javascript, yui

[http://jsfiddle.net/mark69_fnd/cKWJh/](http://jsfiddle.net/mark69_fnd/cKWJh/)

在上述 jsFiddle 的文本框中输入内容应该会打开一个警报窗口。它没有，我不知道为什么。

任何人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:15:00.577

您需要将“event-valuechange”添加到您的 use() 列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T02:20:59.293

您需要等到呈现 TabView 之后才能侦听位于 TabView 内的 DOM 节点上的事件。这是因为`content`每个 Tab 的属性的设置器在渲染时执行，并且该设置器执行：

```
this.get('panelNode').setContent(content); 
```

这会重写`innerHTML`面板节点的 ，因此您会丢失对节点和事件侦听器的所有引用。

这是您的 Fiddle 的快速而肮脏的编辑，以显示如何将事件初始化代码放入函数中并在渲染 TabView 后调用它：http: [//jsfiddle.net/vWb5R/](http://jsfiddle.net/vWb5R/)

# html - 在 Disqus 2012 中更改字体大小

> ID：12647491
> 
> 赞同：0
> 
> 时间：2012-09-28T21:17:15.783
> 
> 标签：html, css, fonts, disqus

我在我的网站上使用 Disqus 2012 评论系统。我的网站默认字体是 13 像素（在 body 标签中定义），但 Disqus 显示评论的字体是 14 像素。反正有没有改变它的字体大小？我已经尝试了很多使用 Firebug 检查评论的 HTML 源并在我的样式表中指定了字体大小，但它不起作用。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T19:50:25.533

虽然此功能目前在 Disqus 2012 中不可用，但 Disqus 正在寻找其他自定义选项以在未来提供帮助。

# c# - 列出 Windows 8 / WinRT / XAML 应用程序中的时区？

> ID：12647492
> 
> 赞同：4
> 
> 时间：2012-09-28T21:17:16.280
> 
> 标签：c#, timezone, windows-8, winrt-xaml

它曾经是我们`TimeZoneInfo.GetSystemTimeZones()`用来枚举时区的。

您如何在 Windows 8 应用程序中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T23:27:27.170

我刚刚发布了有关如何执行此操作的 [博客，并将您需要的代码作为](http://novotny.org/blog/converting-timezones-in-store-winrt-apps) [要点](https://gist.github.com/3896181)包含在内。

此外，为了解决另一位评论者，不，ARM 兼容性不是问题，因为编组正确发生。

编辑：只是让它变得更好，并将其变成通用的 NuGet 包：

[https://nuget.org/packages/WinRTTimeZones](https://nuget.org/packages/WinRTTimeZones)

来源在这里：[https ://github.com/onovotny/WinRTTimeZones](https://github.com/onovotny/WinRTTimeZones)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T04:04:37.960

根据[MSDN 论坛](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/b3021654-0a34-409c-8afa-54ebd7df8ff4)，您将不得不推出自己的方法，也许通过公开[ICANN 数据](http://www.iana.org/time-zones)的服务？

通过 PInvoke ( [EnumDynamicTimeZoneInformation](http://msdn.microsoft.com/en-us/library/windows/desktop/hh706893%28v=vs.85%29.aspx) )，您可以获得其中的一个子集。即使使用[GetSystemTimeZones](http://msdn.microsoft.com/en-us/library/bb397781.aspx)，您也​​不能保证全部获得它们（尽管我期望比使用 PInvoke 更多）。

# android - Android列表未从sqlite数据库加载

> ID：12647496
> 
> 赞同：0
> 
> 时间：2012-09-28T21:17:30.293
> 
> 标签：android, database, sqlite, csv

我一直在开发一个使用数据库填充列表的 Android 应用程序。该数据库由位于 /assets 文件夹中的 .csv 文件中的记录填充。几分钟前一切正常，但自从我刷新了我的 CSV 后，不再显示包含数据的列表（它只是说“没有要显示的订单”，这意味着它没有找到任何数据填充列表）。此外，代码不会产生任何错误，而且 LogCat 对我来说并没有真正的用处。

我想知道是否有人可以帮助我：谢谢你！

这是 DatabaseActivity.java 文件：

```
public class DatabaseActivity extends ListActivity {

String ID;
String title;
String location;
String startTime;
String endTime;
String date;
String description;
private DatabaseHelper dbh;

private ProgressDialog m_ProgressDialog = null; 
private ArrayList<Order> m_orders = null;
private OrderAdapter m_adapter;
private Runnable viewOrders;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    this.dbh = new DatabaseHelper(this);

    try {
        csvtodb();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    m_orders = new ArrayList<Order>();
    this.m_adapter = new OrderAdapter(this, R.layout.row, m_orders);
    setListAdapter(this.m_adapter);

    viewOrders = new Runnable(){
        @Override
        public void run() {
            getOrders();
        }
    };
    Thread thread =  new Thread(null, viewOrders, "MagentoBackground");
    thread.start();
    m_ProgressDialog = ProgressDialog.show(DatabaseActivity.this,    
            "Even geduld...", "Database wordt geladen...", true);

}

private Runnable returnRes = new Runnable() {

    @Override
    public void run() {
        if(m_orders != null && m_orders.size() > 0){
            m_adapter.notifyDataSetChanged();
            for(int i=0;i<m_orders.size();i++)
                m_adapter.add(m_orders.get(i));
        }
        m_ProgressDialog.dismiss();
        m_adapter.notifyDataSetChanged();
    }
};

private void getOrders(){
    try{
        m_orders = new ArrayList<Order>();
        SQLiteDatabase db = dbh.getReadableDatabase();
        Cursor c = db.query(DatabaseHelper.tblEvents, 
                new String[] {DatabaseHelper.title, 
                DatabaseHelper.location, 
                DatabaseHelper.startTime,
                DatabaseHelper.description}, 
                null, null, null, null, 
                DatabaseHelper.startTime + " ASC");
        int numberOfRows = c.getCount();
        for (int i = 0; i < numberOfRows; i++){
            c.moveToPosition(i);
            // Obtain the title
            int col1 = c.getColumnIndex(DatabaseHelper.title);
            String title = c.getString(col1);
            // Obtain the location
            int col2 = c.getColumnIndex(DatabaseHelper.location);
            String location = c.getString(col2);
            // Obtain the time
            int col3 = c.getColumnIndex(DatabaseHelper.startTime);
            String startTime = c.getString(col3);
            // Obtain the description
            int col4 = c.getColumnIndex(DatabaseHelper.description);
            String description = c.getString(col4);
            Order o = new Order();
            o.setOrderTime(startTime);
            o.setOrderTitle(title);
            o.setOrderLocation(location);
            o.setOrderDescription(description);
            m_orders.add(o);
        }
        db.close();
        Thread.sleep(2000);
        Log.i("ARRAY", ""+ m_orders.size());
    } catch (Exception e) { 
        Log.e("BACKGROUND_PROC", e.getMessage());
    }
    runOnUiThread(returnRes);
}

public void csvtodb() throws IOException {
    // Get a writable database
    SQLiteDatabase db = dbh.getWritableDatabase();
    if (dbh.isDbInitialized(db)) {
        db.close();
        return;
    }

    AssetManager assetManager = getAssets();
    InputStream input = assetManager.open("testcsv.csv");

    BufferedReader in = new BufferedReader(new InputStreamReader(input, "UTF-8"));
    String reader = "";
    while ((reader = in.readLine()) != null)
    {
        String[] RowData = reader.split(",");

        ID = RowData[0];
        title = RowData[1];
        location = RowData[2];
        startTime = RowData[3];
        endTime = RowData[4];
        date = RowData[5];
        description = RowData[6];

        DatabaseHelper.fillTable(db, ID, title, location, startTime, endTime, date, description);
    }

    in.close();
}

public class OrderAdapter extends ArrayAdapter<Order> {

    private ArrayList<Order> items;

    public OrderAdapter(Context context, int textViewResourceId, ArrayList<Order> items) {
        super(context, textViewResourceId, items);
        this.items = items;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;
        if (v == null) {
            LayoutInflater vi = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(R.layout.row, null);
        }
        Order o = items.get(position);
        if (o != null) {
            TextView time = (TextView) v.findViewById(R.id.time);
            TextView title = (TextView) v.findViewById(R.id.title);
            TextView location = (TextView) v.findViewById(R.id.location);
            TextView description = (TextView) v.findViewById(R.id.description);
            if (time != null) {
                time.setText(o.getOrderTime());                            
            }
            if(title != null){
                title.setText(o.getOrderTitle());
            }
            if(location != null){
                location.setText("Locatie: " + o.getOrderLocation());
            }
            if(description != null){
                description.setText(o.getOrderDescription());
            }
        }
        return v;
    }
}
} 
```

这是 DatabaseHelper.java：

```
public class DatabaseHelper extends SQLiteOpenHelper{
// Database name and version
static final String dbName = "Evenementen";
static final int dbVersion = 1;

// Names of tables and columns
static final String tblEvents = "Evenementen";
static final String eventID = "ID";
static final String title = "Titel";
static final String location = "Locatie";
static final String startTime = "Begintijd";
static final String endTime = "Eindtijd";
static final String date = "Datum";
static final String description = "Beschrijving";

// Constructor
public DatabaseHelper(Context context) {
    super(context, dbName, null, dbVersion);
}

@Override
public void onCreate(SQLiteDatabase db) {
    createDB(db);
}

public void createDB(SQLiteDatabase db) {
    db.execSQL("CREATE TABLE " + tblEvents + " (" +
            eventID   + " INTEGER PRIMARY KEY, " +
            title   + " TEXT , " +
            location   + " TEXT , " +
            startTime   + " TEXT , " +
            endTime   + " TEXT , " +
            date   + " TEXT , " +
            description + " TEXT" +
            ")");
}

public boolean isDbInitialized(SQLiteDatabase db) {
    return db.rawQuery("SELECT DISTINCT tbl_name FROM sqlite_master WHERE tbl_name = '"+ tblEvents + "'", null) != null;
}

public static void fillTable(SQLiteDatabase db, String first, String second, String third, 
        String fourth, String fifth, String sixth, String seventh) {
    String template = "INSERT INTO " + tblEvents + 
            "(" + eventID + "," + title + "," + location + "," + startTime + "," + endTime + "," + date + "," + description + ")" + 
            "VALUES (?,?,?,?,?,?,?)";
    Object[] args = new Object[]{first, second, third, fourth, fifth, sixth, seventh};
    db.execSQL(template, args);
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // Bluntly remove table (and thus discard ALL data in it!) if we're upgrading  
    db.execSQL("DROP TABLE IF EXISTS " + tblEvents);
    onCreate(db);
}

} 
```

这是我的 CSV 文件（它是荷兰语。值用逗号分隔）：

```
1,Cross Rubicon,van der Werff & Studio de Veste,15:00,Nvt,03-okt,Geen beschrijving beschikbaar
2,Ferry Nick & Lodewijk Band,van der Werff & Studio de Veste,18:30,Nvt,03-okt,Bekend van de Edwin Evers Band & Marco Borsato
3,LOS,van der Werff & Studio de Veste,21:00,Nvt,03-okt,Nederpopcovers
4,La Cubaniza,Scheltema,16:00,Nvt,03-okt,Cuban liveband & DJ 
```

仅供参考：我正在使用[此参考](http://www.softwarepassion.com/android-series-custom-listview-items-and-adapters/)在列表中显示我的数据库中的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:23:32.647

您的活动似乎按标题查找列

```
// Obtain the time
            int col1 = c.getColumnIndex(DatabaseHelper.title); 
```

但是包含的 CSV 列表没有标题...

# python - pygame 没有被导入

> ID：12647498
> 
> 赞同：0
> 
> 时间：2012-09-28T21:17:49.467
> 
> 标签：python, pygame

我有一个非常基本的问题，pygame 在 Windows 7 中没有被识别。我安装了 ActiveState Python 2.7 和 pygame-1.9.2a0.win32-py2.7.msi。然而，一个简单的导入 pygame 的 hello world 程序给出了

```
Traceback (most recent call last):
File "foo.py", line 1, in <module>
import pygame
ImportError: No module named pygame 
```

谁能帮我这个？如果需要的话，我对编辑 PATH 不是很熟悉，谢谢。

编辑：是因为 ActiveState 是 64 位的，而我使用的是 32 位版本的 pygame？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:27:20.517

将 pygame 添加到路径是我会尝试的第一件事。

一个非常简单（可能把它留在那里但可以测试）的方法是找到你的 pygame 的安装位置，并将其添加到 sys.path

这里有更多信息：http: [//greennotebook.com/2010/06/how-to-change-pythonpath-in-windows-and-ubuntu/](http://greeennotebook.com/2010/06/how-to-change-pythonpath-in-windows-and-ubuntu/)

您最终可以将其添加到 Windows PATH。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:49:18.167

啊，没关系，看来我需要 ActiveState 和 pygame 的两个版本都是 32 位的。现在工作。

# c++ - 如果两者都会给出相同的结果，我应该更喜欢加法还是逻辑 OR 运算符？

> ID：12647501
> 
> 赞同：1
> 
> 时间：2012-09-28T21:18:06.757
> 
> 标签：c++, operators, logic, addition, or-operator

如果两者都会给出相同的结果，我应该更喜欢`+`（加法）运算符还是（或）运算符？`|`

我知道加法和逻辑或是不同的东西。但是它们有时在某些宏中会做同样的事情，尤其是在处理字节和位时。在这种情况下我应该更喜欢哪一个？

例子：

```
uint8_t Byte1 = 0x02;   // 0000 0010
uint8_t Byte2 = 0x80;   // 1000 0000
uint16_t Word1, Word2;  // 0000 0010 1000 0000 = 640 = 0x0280

Word1 = (Byte1 << 8) + Byte2;
Word2 = (Byte1 << 8) | Byte2;

std::cout << "Word1 = " << Word1 << std::endl;
std::cout << "Word2 = " << Word2 << std::endl; 
```

输出：

> 字 1 = 640
> 字 2 = 640

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T21:20:53.727

在操作位模式时，逻辑运算符是合适的。操作数值时，算术运算符是合适的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:25:48.963

我会避免在同一个表达式中混合位运算和算术运算，所以我会写

```
Word1 = (Byte1 * 256) + Byte2; 
```

但

```
Word2 = (Byte1 << 8) | Byte2; 
```

可读性是这里唯一需要担心的事情，因为一个好的优化器应该为两个表达式生成完全相同的代码。

# .net - 哪个 C# 库允许可靠的 SVG 到 PDF 转换？

> ID：12647502
> 
> 赞同：3
> 
> 时间：2012-09-28T21:18:13.333
> 
> 标签：.net, pdf, svg, pdf-generation

我正在寻找一个（不一定是免费的）.Net 库，它是：

*   保持
*   可靠的
*   生产就绪

我不能使用光栅化图像格式，因为我不想失去在输出媒体上拥有图形矢量的好处。

我目前使用 Aspose.Pdf 作为 PDF 相关问题的一般答案，我想更改，因为：

*   API 在没有向后兼容性的情况下经常更改。
*   有太多难以解决的错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T11:45:28.357

您是否考虑过在命令行上使用[Inkscape ？](http://inkscape.org/)它是免费的，适用于所有主要操作系统，并且可以使用库系统调用轻松调用。

[请在此处](https://stackoverflow.com/a/10400963/472495)查看我的答案，但请使用该`--export-pdf`选项而不是`--export-png`. 我自己在服务器应用程序上使用过它，它非常好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:30:57.413

我不知道直接的 API，但是使用[类似问题的东西](https://stackoverflow.com/questions/58910/converting-svg-to-png-using-c-sharp)生成 SVG 到位图会很容易。[并使用许多编写 PDF 的库（如 ITextSharp](http://sourceforge.net/projects/itextsharp/) ）将图像添加到 PDF 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T19:35:29.347

经过广泛的研究，似乎这样的图书馆还不存在或很难找到。我将不得不坚持使用 Aspose。

# python - 列表理解中的捕获和输出

> ID：12647510
> 
> 赞同：4
> 
> 时间：2012-09-28T21:18:30.580
> 
> 标签：python, iteration, generator, list-comprehension

我正在编写一个生成器函数。我想知道是否有更好的（阅读：更多pythonic，最好是列表理解）方法来实现这样的东西：

```
generator = gen()
captures = []
for _ in xrange(x):
    foo = next(generator)
    directories.append(foo['name'])
    yield foo 
```

这里的关键是我不想捕获整个产量 - 返回的字典`gen()`很大，这就是我使用生成器的原因。不过，我确实需要捕获所有“名称”。我觉得有一种方法可以通过列表理解来做到这一点，但我只是没有看到它。想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T21:24:01.750

还有另一种/更短的方法可以做到这一点，但我不会称它为 Pythonic：

```
generator = gen()
directories = []
generator_wrapper = (directories.append(foo['name']) or foo 
                         for foo in generator) 
```

这利用了这样一个事实，即`append`像 Python 中的所有变异方法一样，总是返回`None`，所以`.append(...) or foo`总是评估为`foo`。

这样，整个字典仍然是生成器表达式的结果，您仍然会得到惰性求值，但名称仍然会保存到`directories`列表中。

您也可以在显式`for`循环中使用此方法：

```
for foo in generator:
    yield directories.append(foo['name']) or foo 
```

甚至只是简化你的循环：

```
for foo in generator:
    directories.append(foo['name'])
    yield foo 
```

因为没有理由使用`xrange`just 来迭代生成器（除非您实际上只想迭代一些已知数量的步骤）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:52:11.077

您想要`x`生成器的前多个元素吗？使用`itertools.islice`：

```
directories = [item['name'] for item in itertools.islice(gen(), x)] 
```

# android - 在Android上访问本机串口

> ID：12647513
> 
> 赞同：6
> 
> 时间：2012-09-28T21:18:46.440
> 
> 标签：android, serial-port

我想让 android 应用程序/服务访问本机串行端口（UART RS-232）。当我说本机时，我指的是真正的 UART，而不是 USB 转串行加密狗。我可以从终端看到它们（连接到 4 个本机串行端口之一）。它表明内核已经处理了低级的东西。

```
# ls -l /dev 
crw-rw-rw- system   system   204,  67 2010-01-01 07:00 s3c2410_serial3
crw-rw-rw- system   system   204,  66 2010-01-01 07:00 s3c2410_serial2
crw-rw-rw- system   radio    204,  65 2010-01-01 07:00 s3c2410_serial1
crw-rw-rw- system   system   204,  64 2010-01-01 07:00 s3c2410_serial0 
```

我用姜饼。我已将 Android 移植到具有 S5PV210 处理器的平台上。我完全控制内核和权限。我已经修改了很多东西（蜂窝、触摸屏、LCD 面板尺寸等），包括 init.rc 文件。

如何通过 Android APK 与这些设备通信？如您所见，“s3c2410_serial1”来自用户“radio”，因为我获取 Gingerbread 源代码的原始系统在该串行端口上有一个 GPRS 模块。在 init.rc 中很容易更改。但这只是证明我们至少可以访问 Android 系统上的本机串行端口。

应用程序或服务不需要控制 APK 的波特率或任何花哨的东西。我只想发送和接收字符。内核可以设置默认波特率，我对此很满意。我什至不需要控制 RTS/CTS。

任何提示表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T02:00:26.353

我找到了一个方法。它似乎适用于任何类型的设备，因为它只是将设备作为文件访问。请参阅链接[android-serialport-api](http://code.google.com/p/android-serialport-api/)。它适用于任何类型的 /dev/... 在我的情况下，我必须安装 NDK 并通过所有的 hooplas 才能让它工作。在 C 语言中有一段代码用于设置波特率。其实open和close都是用C实现的，剩下的都是标准的android java。

# xsd - 如何在 Xquery 中映射抽象 XSD 元素？

> ID：12647528
> 
> 赞同：0
> 
> 时间：2012-09-28T21:20:16.747
> 
> 标签：xsd, xquery, osb

我有一个在我的 Xquery 请求中定义的表单。此表单建立在 XSD 架构上。

**我的表格：**

```
<xsd:element name="AddInsuranceToOrderForm">
        <xsd:complexType>
              <xsd:sequence>
                    <xsd:element name="OrderId" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                    <xsd:element name="DistributionChannel" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                    <xsd:element name="FloatNumber" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                    <xsd:element name="UserId" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                    <xsd:element name="SalesId" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                    <xsd:element name="TotalDue" type="xsd:decimal" minOccurs="1" maxOccurs="1"/>
                    <xsd:element name="ChangeDue" type="xsd:decimal" minOccurs="1" maxOccurs="1"/>
                    **<xsd:element ref="tns:tenderItem" minOccurs="0" maxOccurs="unbounded"/>**
                    <xsd:element name="ProtectionPlans" type="tns:ProtectionPlanItemType" minOccurs="0" maxOccurs="unbounded"/>
                    <xsd:element name="InsurancePlans" type="tns:FeatureItemType" minOccurs="0" maxOccurs="unbounded"/>
              </xsd:sequence>
        </xsd:complexType>
  </xsd:element> 
```

**注意tenderItems 是一个参考。它的来源在这里：**

```
<xsd:element abstract="true" name="tenderItem" type="tns:TenderType"/>
  <xsd:complexType name="TenderType">
        <xsd:sequence>
              <xsd:element maxOccurs="1" minOccurs="0" name="date" type="xsd:dateTime"/>
              <xsd:element maxOccurs="1" minOccurs="0" name="lineNumber" type="xsd:string"/>
              <xsd:element maxOccurs="1" minOccurs="0" name="tenderId" type="xsd:long"/>
              <xsd:element maxOccurs="1" minOccurs="0" name="returnTenderId" type="xsd:long"/>
              <xsd:element maxOccurs="1" minOccurs="0" name="tenderType" type="tns:TenderTypeType"/>
              <xsd:element maxOccurs="1" minOccurs="0" name="amount" type="xsd:decimal"/>
              <xsd:element maxOccurs="1" minOccurs="0" name="signature" type="tns:SignatureType"/>
        </xsd:sequence>
  </xsd:complexType> 
```

有几个扩展tenderType 的特定投标，我想将它们添加到我的Xquery 请求中。**这是一个例子：**

```
 <xsd:element name="billToAccount" substitutionGroup="tns:tenderItem" type="tns:BillToAccountType"/>
  <xsd:complexType name="BillToAccountType">
        <xsd:complexContent>
              <xsd:extension base="tns:TenderType">
                    <xsd:sequence>
                          <xsd:element maxOccurs="1" minOccurs="0" name="accountId" type="xsd:long"/>
                          <xsd:element maxOccurs="1" minOccurs="0" name="subscriptionId" type="xsd:string"/>
                          <xsd:element maxOccurs="1" minOccurs="0" name="chargeDescription" type="xsd:string"/>
                          <xsd:element maxOccurs="unbounded" minOccurs="0" name="lineItems" type="tns:BillToAccountLineItemType"/>
                    </xsd:sequence>
              </xsd:extension>
        </xsd:complexContent>
  </xsd:complexType> 
```

**那么这在 Xquery 中是如何完成的呢？我尝试了以下方法：**

```
{
    for $BillToAccount in $addInsuranceToOrderABM1/ns3:MessagePayload/ns3:AddInsuranceToOrder/ns1:AddInsuranceToOrderDataArea/ns2:TenderItem
        return
            <ns2:billToAccount>
                {
                    for $Date in $BillToAccount/ns0:Date
                    return
                        <ns2:date>{ data($Date) }</ns2:date>
                }…
} 
```

我为每个tenderType 都这样做了，但是映射器不支持XML 元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T20:31:52.640

您可以使用`schema-element(ns3:tenderItem)`匹配该替换组中的任何元素。

```
import schema default element namespace "http://www.example.com/xml-namespace/" at "schema.xsd";

declare variable $input as schema-element(AddInsuranceToOrderForm)
   := validate { doc('data.xml')/AddInsuranceToOrderForm };

for $item in $input/schema-element(tenderItem)
return $item 
```

与`schema.xsd`：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified"
    xmlns:tns="http://www.example.com/xml-namespace/"
    targetNamespace="http://www.example.com/xml-namespace/">
    <xsd:element name="AddInsuranceToOrderForm">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element name="OrderId" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                <xsd:element name="DistributionChannel" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                <xsd:element name="FloatNumber" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                <xsd:element name="UserId" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                <xsd:element name="SalesId" type="xsd:long" minOccurs="1" maxOccurs="1"/>
                <xsd:element name="TotalDue" type="xsd:decimal" minOccurs="1" maxOccurs="1"/>
                <xsd:element name="ChangeDue" type="xsd:decimal" minOccurs="1" maxOccurs="1"/>
                <xsd:element ref="tns:tenderItem" minOccurs="0" maxOccurs="unbounded"/>
            </xsd:sequence>
        </xsd:complexType>
    </xsd:element>
    <xsd:element abstract="true" name="tenderItem" type="tns:TenderType"/>
    <xsd:complexType name="TenderType">
        <xsd:sequence>
            <xsd:element maxOccurs="1" minOccurs="0" name="date" type="xsd:dateTime"/>
            <xsd:element maxOccurs="1" minOccurs="0" name="lineNumber" type="xsd:string"/>
            <xsd:element maxOccurs="1" minOccurs="0" name="tenderId" type="xsd:long"/>
            <xsd:element maxOccurs="1" minOccurs="0" name="returnTenderId" type="xsd:long"/>
            <xsd:element maxOccurs="1" minOccurs="0" name="amount" type="xsd:decimal"/>
        </xsd:sequence>
    </xsd:complexType>
    <xsd:element name="BillToAccount" substitutionGroup="tns:tenderItem" type="tns:BillToAccountType"/>
    <xsd:complexType name="BillToAccountType">
        <xsd:complexContent>
            <xsd:extension base="tns:TenderType">
                <xsd:sequence>
                    <xsd:element maxOccurs="1" minOccurs="0" name="accountId" type="xsd:long"/>
                    <xsd:element maxOccurs="1" minOccurs="0" name="subscriptionId" type="xsd:string"/>
                    <xsd:element maxOccurs="1" minOccurs="0" name="chargeDescription" type="xsd:string"/>
                </xsd:sequence>
            </xsd:extension>
        </xsd:complexContent>
    </xsd:complexType>
</xsd:schema> 
```

并且`data.xml`作为：

```
<?xml version="1.0" encoding="UTF-8"?>
<AddInsuranceToOrderForm xmlns="http://www.example.com/xml-namespace/">
    <OrderId>1</OrderId>
    <DistributionChannel>1</DistributionChannel>
    <FloatNumber>1</FloatNumber>
    <UserId>1</UserId>
    <SalesId>1</SalesId>
    <TotalDue>1</TotalDue>
    <ChangeDue>1</ChangeDue>
    <BillToAccount>
        <date>2012-10-01T23:59:59</date>
        <lineNumber>line 1</lineNumber>
        <tenderId>1</tenderId>
        <returnTenderId>1</returnTenderId>
        <amount>1.2</amount>
        <accountId>1</accountId>
        <subscriptionId>1</subscriptionId>
        <chargeDescription>1</chargeDescription>
    </BillToAccount>
</AddInsuranceToOrderForm> 
```

给出输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<BillToAccount xmlns="http://www.example.com/xml-namespace/">
    <date>2012-10-01T23:59:59</date>
    <lineNumber>line 1</lineNumber>
    <tenderId>1</tenderId>
    <returnTenderId>1</returnTenderId>
    <amount>1.2</amount>
    <accountId>1</accountId>
    <subscriptionId>1</subscriptionId>
    <chargeDescription>1</chargeDescription>
</BillToAccount> 
```

# file-upload - 有什么好的文件重命名方案吗？

> ID：12647529
> 
> 赞同：1
> 
> 时间：2012-09-28T21:20:22.687
> 
> 标签：file-upload, file-rename

我正在尝试找到重命名文件的好主意。

我有一个带有一些编辑器的小网站，有时他们会上传与前一个文件同名的文件。例如：

> 文档.doc

我不喜欢这个解决方案：

> 文档(1).doc

因为它没有说明该文件，只是之前还有其他“类似”文件。

我想添加一个时间戳，但下载文件并不好：

> 文档_1348849299.doc

你有什么建议或命名文件的好方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:40:17.250

我认为你的方法是一个很好的方法。您可以将时间戳格式化为更具吸引力，例如 document_2012-09-28_11.59.00.doc

另一种方法是保留一个包含文件的数据库表和一个包含文件版本的表。以文件版本 ID 命名磁盘上的文件。

例如 SQL 表

```
File
    FileID
    FileName
    CreatedBy
    [Whatever]
FileVersion
    FileVersionID
    FileID
    UserName
    UploadTime
    [Whatever]

~/file_store/
    1.file
    2.file 
```

# facebook - 从服务器获取 facebook 页面访问令牌

> ID：12647530
> 
> 赞同：0
> 
> 时间：2012-09-28T21:20:26.207
> 
> 标签：facebook, access-token, facebook-page

我需要在服务器上获取一个 facebook 页面访问令牌。

从我读到的获取页面访问令牌的内容中，您必须首先获取具有 manage_pages 权限的用户访问令牌，然后单独调用“我/帐户”以获取页面访问令牌。

这个问题是我正在开发的应用程序会自动将内容从服务器发布到 Facebook 页面。话虽如此，从后端获取用户访问令牌是一个问题。

理想情况下，我想以编程方式获取用户访问令牌，然后完全在后端获取页面访问令牌，以便能够自动将内容发布到页面。

关于如何从服务器端完成此操作的任何建议？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:24:20.630

`access_token`如果没有用户身份验证和`manage_pages`权限授予，则无法获取页面。

作为页面指南进行身份验证指出：

> 首先，您需要对用户进行身份验证，并获取用户访问令牌。为此，请遵循移动 Web 和桌面 Web 的服务器端或客户端身份验证流程，或者本机 iOS 或本机 Android 身份验证流程。

有关详细信息，请参阅[身份验证文档](https://developers.facebook.com/docs/authentication/)和[身份验证作为页面指南](https://developers.facebook.com/docs/authentication/pages/)。

# c# - 如何将针对标准偏差编码为 1 的逆 CDF 转换为不同的 STDDEV？

> ID：12647539
> 
> 赞同：3
> 
> 时间：2012-09-28T21:21:27.117
> 
> 标签：c#, probability, standard-deviation

作为使用逆累积分布函数 (CDF) 进行数值积分的算法的一部分，我正在做拒绝抽样。

我发现了两种可能的实现：

1.  在 C 和 Java 中（以及其他，但不是 C#，所以我需要翻译）：

[http://home.online.no/~pjacklam/notes/invnorm/](http://home.online.no/~pjacklam/notes/invnorm/ "一种计算逆正态累积分布函数的算法")

1.  在 C# 中，有 StatisticFormula.InverseNormalDistribution（在 System.Windows.Forms.DataVisualization.Charting 中）。鉴于微软多年前在 Excel 中执行不良 NORMINV 的记录，我对此持怀疑态度。

这两个函数都假定均值为零（我将使用它）和标准偏差为 1。如何转换此函数的输入和/或输出，以使标准偏差不同于一个？

我知道高斯分布：

f(x,mean,sd) = (1/(sd*sqrt(2*pi))) *exp(-0.5* ((x-mean)/sd)^2)

因此，如果我有 g(x) = f(x,0,1)，则 f(x,mean,sd) = (1/sd)*g(x/sd)。

将 Gaussian 转换为不同的 Std Dev 很容易。**我可以为逆 CDF 做类似的事情吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T12:10:21.707

当一切都失败时，试试 MS Excel。我使用 NORMINV（它允许您提供标准偏差）计算了逆 CDF，并将其与使用 NORMSINV（假定标准偏差为 1）返回的值进行了比较。令人高兴的结果是，您只需将使用标准差 1 获得的结果乘以所需的标准差即可。

NORMSINV(x) * SD = NORMINV(x,0,SD)

顺便说一句：我尝试使用 Microsoft 库，但没有成功。您只能在图表的上下文中调用函数，这是不可接受的开销。我最终将 Jeremy Lea 的 C 实现移植到 C#。引用了我在问题中给出的链接， [http://home.online.no/~pjacklam/notes/invnorm/](http://home.online.no/~pjacklam/notes/invnorm/)

我在移植时犯了一个错误，或者 C 版本有一个错误，因为我在负输入时得到了很好的准确度，但是当 x > 6 时准确度迅速下降并且 x = 7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-12T13:59:43.953

由于 Paul Chernoch 的答案与实现的链接断开，我不得不寻找自己的答案。我在这里找到了具有参数化均值和标准差的 R 版本的逆 CDF 的实现：[C# 中的标准正态分布 z 值函数](https://stackoverflow.com/questions/1662943/standard-normal-distribution-z-value-function-in-c-sharp)

为了防止另一个断开链接的风险，我在下面列出了我的方法副本。

```
 /// <summary>
    /// Quantile function (Inverse CDF) for the normal distribution.
    /// </summary>
    /// <param name="p">Probability.</param>
    /// <param name="mu">Mean of normal distribution.</param>
    /// <param name="sigma">Standard deviation of normal distribution.</param>
    /// <param name="isLowerTail">If true, probability is P[X <= x], otherwise P[X > x].</param>
    /// <param name="isLogValues">If true, probabilities are given as log(p).</param>
    /// <returns>P[X <= x] where x ~ N(mu,sigma^2)</returns>
    /// <remarks>See https://svn.r-project.org/R/trunk/src/nmath/qnorm.c </remarks>
    public static double QNorm(double p, double mu, double sigma, bool isLowerTail, bool isLogValues)
    {
        if (double.IsNaN(p) || double.IsNaN(mu) || double.IsNaN(sigma)) return (p + mu + sigma);
        double ans;
        bool isBoundaryCase = R_Q_P01_boundaries(p, double.NegativeInfinity, double.PositiveInfinity, isLowerTail, isLogValues, out ans);
        if (isBoundaryCase) return (ans);
        if (sigma < 0) return (double.NaN);
        if (sigma == 0) return (mu);

        double p_ = R_DT_qIv(p, isLowerTail, isLogValues);
        double q = p_ - 0.5;
        double r, val;

        if (Math.Abs(q) <= 0.425)  // 0.075 <= p <= 0.925
        {
            r = .180625 - q * q;
            val = q * (((((((r * 2509.0809287301226727 +
                       33430.575583588128105) * r + 67265.770927008700853) * r +
                     45921.953931549871457) * r + 13731.693765509461125) * r +
                   1971.5909503065514427) * r + 133.14166789178437745) * r +
                 3.387132872796366608)
            / (((((((r * 5226.495278852854561 +
                     28729.085735721942674) * r + 39307.89580009271061) * r +
                   21213.794301586595867) * r + 5394.1960214247511077) * r +
                 687.1870074920579083) * r + 42.313330701600911252) * r + 1.0);
        }
        else
        {
            r = q > 0 ? R_DT_CIv(p, isLowerTail, isLogValues) : p_;
            r = Math.Sqrt(-((isLogValues && ((isLowerTail && q <= 0) || (!isLowerTail && q > 0))) ? p : Math.Log(r)));

            if (r <= 5)              // <==> min(p,1-p) >= exp(-25) ~= 1.3888e-11
            {
                r -= 1.6;
                val = (((((((r * 7.7454501427834140764e-4 +
                        .0227238449892691845833) * r + .24178072517745061177) *
                      r + 1.27045825245236838258) * r +
                     3.64784832476320460504) * r + 5.7694972214606914055) *
                   r + 4.6303378461565452959) * r +
                  1.42343711074968357734)
                 / (((((((r *
                          1.05075007164441684324e-9 + 5.475938084995344946e-4) *
                         r + .0151986665636164571966) * r +
                        .14810397642748007459) * r + .68976733498510000455) *
                      r + 1.6763848301838038494) * r +
                     2.05319162663775882187) * r + 1.0);
            }
            else                     // very close to  0 or 1 
            {
                r -= 5.0;
                val = (((((((r * 2.01033439929228813265e-7 +
                        2.71155556874348757815e-5) * r +
                       .0012426609473880784386) * r + .026532189526576123093) *
                     r + .29656057182850489123) * r +
                    1.7848265399172913358) * r + 5.4637849111641143699) *
                  r + 6.6579046435011037772)
                 / (((((((r *
                          2.04426310338993978564e-15 + 1.4215117583164458887e-7) *
                         r + 1.8463183175100546818e-5) * r +
                        7.868691311456132591e-4) * r + .0148753612908506148525)
                      * r + .13692988092273580531) * r +
                     .59983220655588793769) * r + 1.0);
            }
            if (q < 0.0) val = -val;
        }

        return (mu + sigma * val);
    }

    private static bool R_Q_P01_boundaries(double p, double left, double right, bool isLowerTail, bool isLogValues, out double ans)
    {
        if (isLogValues)
        {
            if (p > 0.0)
            {
                ans = double.NaN;
                return (true);
            }
            if (p == 0.0)
            {
                ans = isLowerTail ? right : left;
                return (true);
            }
            if (p == double.NegativeInfinity)
            {
                ans = isLowerTail ? left : right;
                return (true);
            }
        }
        else
        {
            if (p < 0.0 || p > 1.0)
            {
                ans = double.NaN;
                return (true);
            }
            if (p == 0.0)
            {
                ans = isLowerTail ? left : right;
                return (true);
            }
            if (p == 1.0)
            {
                ans = isLowerTail ? right : left;
                return (true);
            }
        }
        ans = double.NaN;
        return (false);
    }

    private static double R_DT_qIv(double p, bool isLowerTail, bool isLogValues)
    {
        return (isLogValues ? (isLowerTail ? Math.Exp(p) : -ExpM1(p)) : R_D_Lval(p, isLowerTail));
    }

    private static double R_DT_CIv(double p, bool isLowerTail, bool isLogValues)
    {
        return (isLogValues ? (isLowerTail ? -ExpM1(p) : Math.Exp(p)) : R_D_Cval(p, isLowerTail));
    }

    private static double R_D_Lval(double p, bool isLowerTail)
    {
        return isLowerTail ? p : 0.5 - p + 0.5;
    }

    private static double R_D_Cval(double p, bool isLowerTail)
    {
        return isLowerTail ? 0.5 - p + 0.5 : p;
    }
    private static double ExpM1(double x)
    {
        if (Math.Abs(x) < 1e-5)
            return x + 0.5 * x * x;
        else
            return Math.Exp(x) - 1.0;
    } 
```

我针对 Excel 2016 中 NORM.INV 的实现对该方法的结果进行了一些初步的测试。准确度似乎相同，精度为 10^-7。

# java - 处理来自 Google Protocol Buffer 库的 IOExceptions

> ID：12647543
> 
> 赞同：0
> 
> 时间：2012-09-28T21:21:45.437
> 
> 标签：java, sockets, protocol-buffers

我有一些代码试图从 Java 中的套接字读取 Google 协议缓冲区消息。但是，如果 mergeDelimitedFrom() 方法读取无效数据或重置套接字连接（可能还有其他原因），则可能会引发 IOException。如果连接被重置，我想退出循环，但如果它只是一条无效消息，我想继续运行。一种想法是在 X 次连续失败后只使用某种异常计数器并退出，但我希望能够弄清楚发生了什么类型的错误，而不是一头雾水。

这基本上是我的代码：

```
while (m_Running)
{
    SomeMessage message = null;
    try
    {
        final Builder builder = SomeMessage.newBuilder();
        if (builder.mergeDelimitedFrom(m_InputStream))
        {
            message = builder.build();
        }
        else
        {
            // Google protocol buffers doesn't document it very well
            // but if mergeDelimietedFrom returns false then it has
            // reached the end of the input stream.  For a socket, no
            // more data will be coming so exit from the thread
            m_Running = false;
        }
    }
    catch (final IOException e)
    {
        // what should really be done here ???
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T01:37:54.523

只是不要这样做。如果您直接从套接字读取协议缓冲区对象，那么您实际上是在定义自己的应用程序协议。正确地做这件事比您想象的要难 - 在[On the Design of Application Protocols](http://www.rfc-editor.org/rfc/rfc3117.txt)中有一些问题的很好的一般描述。理解框架很重要 - 确定一条消息在哪里结束，另一条消息从哪里开始。

[这让我们从https://developers.google.com/protocol-buffers/docs/techniques](https://developers.google.com/protocol-buffers/docs/techniques)的 protobuf 的发明者那里得到了一些建议。关键的建议是这样的：

> 如果您想将多条消息写入单个文件或流，则由您来跟踪一条消息的结束位置和下一条消息的开始位置。

我建议您决定使用框架协议将流划分为消息，然后编写一些自定义套接字代码来处理工作或读取套接字的字节，将它们划分为字节数组，其中每个字节数组都已知只包含一条消息，然后最后使用 protobuf 将每个消息字节数组反序列化为一个对象。保证没有 IOException protobuf 反序列化。

您仍然必须处理 IOExceptions，但它将处于较低级别，您只是在读取字节数组，并且您将确切知道发生错误时已反序列化了多少数据。

还可以考虑使用[netty](https://netty.io)之类的东西来帮助处理套接字代码。

# .htaccess - 使用 mod_rewrite 去除垃圾

> ID：12647545
> 
> 赞同：1
> 
> 时间：2012-09-28T21:21:55.930
> 
> 标签：.htaccess, mod-rewrite

我们在日志中看到了一些非常奇怪的 URL，我被告知要开始重定向它们。我知道有几个更好的方法来解决这个问题，但老板希望这样做。我提前道歉。

我们在日志中看到如下内容：

[http://www.example.com/foo/bar/bla&ob=&ppg=&rpp=100&ob=&rpp=&ppg=&rpp=30&ppg=&ppg=1&rpp=10&rpp=50&ob=&ob=&ob=&rpp=40&ob=&rpp=5&rpp= 30&rpp=&rpp=20&order_by=&results_per_pge=75](http://www.example.com/foo/bar/bla&ob=&ppg=&rpp=100&ob=&rpp=&ppg=&rpp=30&ppg=&ppg=1&rpp=10&rpp=50&ob=&ob=&ob=&rpp=40&ob=&rpp=5&rpp=30&rpp=&rpp=20&order_by=&results_per_pge=75)

有人告诉我“在 .htaccess 文件中添加一些 mod_rewrite 规则”，然后去掉所有的 ob、rpp 和 ppg 变量。

现在，我找到了剥离一切的方法。如果我可以将 /foo/bar/bla 留在其中，那也不会太糟糕。但我似乎无法做到这一点。基本上，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:57:40.540

尝试：

```
# strip out any params that's ob=, rpp= or ppg=
RewriteRule ^/?(.*)&ob=([^&]*)&(.*)$ /$1&$3 [L]
RewriteRule ^/?(.*)&rpp=([^&]*)&(.*)$ /$1&$3 [L]
RewriteRule ^/?(.*)&ppg=([^&]*)&(.*)$ /$1&$3 [L]

# if everything's gone, finally redirect and fix query string
RewriteCond %{REQUEST_URI} !&(ob|rpp|ppg)
RewriteRule ^/?(.*?)&(.*) /$1?$2 [L,R=301] 
```

这里的问题是您的网址：

`http://www.example.com/foo/bar/bla&ob=&ppg=&rpp=100&ob=&rpp=&ppg=&rpp=30&ppg=&ppg=1&rpp=10&rpp=50&ob=&ob=&ob=&rpp=40&ob=&rpp=5&rpp=30&rpp=&rpp=20&order_by=&results_per_pge=75`

在 URI 中有*很多*ob=、rpp= 和 ppg=。超过 10 个。这意味着如果您针对该 URL 使用这些规则，您将收到 500 内部服务器错误。默认情况下，apache 将内部递归限制设置为 10，这意味着如果它需要循环超过 10 次（对于上面的 URL 也会如此），它将保释并返回 500。您需要将其设置得更高：

```
LimitInternalRecursion 30 
```

或其他一些理智的数字。不幸的是，您不能在 htaccess 文件中使用该指令，您需要进入服务器或虚拟主机配置并进行设置。

# javascript - 从 XMLHttpRequest 对象返回自定义对象

> ID：12647546
> 
> 赞同：0
> 
> 时间：2012-09-28T21:22:00.647
> 
> 标签：javascript

我正在从我的 javascript ajax 调用中返回一个“Employee”对象。

```
var xhReq = new XMLHttpRequest();
xhReq.open("POST", "MobileClientService.svc/REST/TestReturnEmployee", false);
xhReq.send(null);

var serverResponse = xhReq.responseText; 
```

返回的是 JSON 数据。我想返回一个具有 Employee 对象结构的对象，以便我可以用 javascript 编写。

```
var name = serverResponse.Name; 
```

这是可能的还是我唯一的选择来解析返回的 JSON 字符串？不，我不能使用 jquery（它以这种方式返回对象），它必须只是 javascript。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:38:20.543

`responseText`当 jQuery需要 JSON 响应时，它会自动将其解析为一个对象。

在 vanilla JS 中，您可以使用以下方式解析它[`JSON.parse`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse)：

```
var response = JSON.parse(xhReq.responseText),
    name = response.Name; 
```

如果您需要与 IE<=7 兼容，还包括此库：[Crockford's JSON2](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)

* * *

## 关于`eval`

也可以使用`eval`将`responseText`字符串解析为对象以与 IE<=7 兼容，而无需包含额外的代码，但这`eval`是邪恶的。

当然，如果您的服务器总是回显格式正确的 JSON，那将不是问题。我个人会避免`eval`并使用正确的`JSON.parse`，但是如果您想在`eval`不包含额外代码的情况下使用 IE<=7 兼容性，您可以按如下方式进行：

```
var response = eval('(' + xhReq.responseText + ')'),
    name = response.Name; 
```

# php - 带有php变量的sql选择

> ID：12647547
> 
> 赞同：0
> 
> 时间：2012-09-28T21:22:06.407
> 
> 标签：php

我正在尝试从 db-table 'dimensions' 中打印出一个 html-table。我只想要从下拉框中获得的所选管道类型的尺寸。现在我只是手动输入“钢”。Steel 在数据库表“管道”中具有 pipe_id = 2。

我已经在我的 db-tool 中运行了第一个查询，它返回 2 所以那里没有错。第二个查询不返回任何内容。但是当我手动设置 $wq = 2 （我在下面注释掉）时，它会完美地打印出 html 表。我在这里做错了什么？

```
$wq="SELECT pipe_id FROM pipes WHERE title_en = 'Steel'";
//$wq = '2';

$sql="SELECT * FROM dimensions WHERE  pipe_id = '".$wq."'"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:34:56.633

只需使用这个简单的子查询：

```
 $sql="SELECT * FROM dimensions WHERE pipe_id = 
    (SELECT pipe_id FROM pipes WHERE title_en = 'Steel'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:30:48.517

如果我是你，我会尝试更多类似的东西：

```
$sql = "SELECT * FROM dimensions AS A, pipe_id AS B WHERE B.title_en='Steel' AND A.pipe_id=B.pipe_id'; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-28T21:34:25.087

## 1.

```
SELECT
    d.*
FROM 
    dimensions AS d
    INNER JOIN pipes AS p ON
        p.pipe_id = d.pipe_id AND
        p.title_en = 'Steel' 
```

## 2.

```
SELECT
    d.*
FROM (
    dimensions AS d,
    pipes AS p
)
WHERE
    p.pipe_id = d.pipe_id AND
    p.title_en = 'Steel' 
```

## 3.

```
SELECT
    d.*
FROM
    dimensions AS d
WHERE
    d.pipe_id = (
        SELECT p.pipe_id
        FROM pipes AS p
        WHERE p.title_en = 'Steel'
        LIMIT 1
    ) 
```

# php - 如何在 PHP 中为 echo 语句获取超链接

> ID：12647548
> 
> 赞同：0
> 
> 时间：2012-09-28T21:22:22.360
> 
> 标签：php, html, image

我有一段 php 代码，我想将其作为链接。

```
 echo"<img border='1' src='$images[$i]' width='350' height='250'>"; 
```

这就是我想出的

```
 <a href = "something"> above statement <a> 
```

但这给了我错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:24:40.600

```
<?php echo "<a href = 'something'><img border='1' src='".$images[$i]."' width='350' height='250'></a>"; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:23:40.880

```
 echo"<a href=\"something\"><img border='1' src='$images[$i]' width='350' height='250'></a>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:26:15.560

```
echo"
    <a href='...'>
       <img border='1' src='{$images[$i]}' width='350' height='250'>
    </a>
"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:30:22.497

```
 echo "<a href="url" > <img border='1' src='".$images[$i]."' width='350' height='250'> </a>"; 
```

或者

```
 <a href="url" > <?php echo "<img border='1' src='".$images[$i]."' width='350' height='250'>"; ?></a> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T22:29:13.530

您可以通过这种方式使用[连接点运算符](http://php.net/manual/en/language.operators.string.php)：

```
<?php
echo '<img border="1" width="350" height="250" src="'.$images[$i].'"'>;
?> 
```

# c - recv() 和 accept() 可以互换吗？

> ID：12647550
> 
> 赞同：1
> 
> 时间：2012-09-28T21:22:30.507
> 
> 标签：c, sockets, network-programming

我有一个设置为 listen() 的套接字

通常我会根据通过 select() 准备好的文件描述符来接受（）这些连接。我可以将其更改为具有相同文件描述符的 recv() 而不是 accept() 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T21:29:42.580

不，它们不可互换。

您只使用 监听单个文件描述符，但是一旦连接了客户端，您希望*每个连接*`select`都有一个文件描述符。

 *`accept`提取侦听套接字的挂起连接队列中的第一个连接请求，创建一个新的连接套接字，并**返回一个引用该套接字的新文件描述符**。

一旦有了新的文件描述符，就可以使用 recv 从客户端接收数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:51:07.043

帮助我“得到它”的是意识到设置为侦听的套接字仅用于接受连接（并且从不用于来回发送数据），而 accept() 返回的文件描述符用于发送回数据并传给一个特定的客户端（进行连接的客户端），并且在与任何其他客户端交互方面没有用处（包括它在接受来自其他客户端的连接方面没有任何作用）。HTH。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:00:15.187

不。

您可能会感到困惑，因为 recv(2) 和 read(2) （大部分）可以互换，但 accept 完全不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-16T12:47:49.933

accept() 返回一对 (conn, address)，其中 conn 是一个新的套接字对象，可用于在连接上**发送和接收**数据，而 address 是绑定到连接另一端套接字的地址。
换句话说，accept() 形成一个新套接字（选择一个新端口）来处理请求，并且使用这个新套接字你可以调用 recv() 和 send()。*

# zend-framework - 使用 Zend_Service_Twitter 从用户那里获取最后的推文而不使用 OAuth？

> ID：12647552
> 
> 赞同：0
> 
> 时间：2012-09-28T21:22:36.423
> 
> 标签：zend-framework, twitter

据我所知，Twitter API 应该在没有 API 密钥且不通过 OAuth 连接的情况下以较小的限制率可用。

有没有办法简单地通过 Zend_Service_Twitter 使用它？或者我会结束解析某种类型的提要：[https ://twitter.com/statuses/user_timeline/12345.json?callback=twitterCallback2&count=1](https://twitter.com/statuses/user_timeline/12345.json?callback=twitterCallback2&count=1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:36:11.557

其他[问题](https://stackoverflow.com/questions/1979933/zend-framework-how-to-get-my-statuses-from-twitter)相同的答案：

```
 $twitter_search = new Zend_Service_Twitter_Search('json');
    $response = $twitter_search->search('from:twitter_handle');
    print_r($response);die; 
```

# javascript - 如何使用正则表达式匹配一个而不是两个字符

> ID：12647553
> 
> 赞同：0
> 
> 时间：2012-09-28T21:22:41.397
> 
> 标签：javascript, regex

使用 javascript 正则表达式，你如何匹配一个字符而忽略任何其他也匹配的字符？

示例 1：我想匹配 $，但不是 $$ 或 $$$。示例 2：我想匹配 $$，但不匹配 $$$。

正在测试的典型字符串是“$ $$ $$$ asian italian”

从用户体验的角度来看，用户选择或取消选择其值与项目列表中的标签匹配的复选框。必须匹配（检查）所有标签才能显示项目。

```
 function filterResults(){

// Make an array of the checked inputs
var aInputs = $('.listings-inputs input:checked').toArray();
// alert(aInputs);
// Turn that array into a new array made from each items value.
var aValues = $.map(aInputs, function(i){
    // alert($(i).val());
    return $(i).val();
});
// alert(aValues);
// Create new variable, set the value to the joined array set to lower case.
// Use this variable as the string to test
var sValues = aValues.join(' ').toLowerCase();
// alert(sValues);

// sValues = sValues.replace(/\$/ig,'\\$');
// alert(sValues);

// this examines each the '.tags' of each item
$('.listings .tags').each(function(){
    var sTags = $(this).text();
    // alert(sTags);
    sSplitTags = sTags.split(' \267 '); // JavaScript uses octal encoding for special characters
    // alert(sSplitTags);
    // sSplitTags = sTags.split(' \u00B7 '); // This also works

    var show = true;

    $.each(sSplitTags, function(i,tag){

        if(tag.charAt(0) == '$'){
            // alert(tag);
            // alert('It begins with a $');
            // You have to escape special characters for the RegEx
            tag = tag.replace(/\$/ig,'\\$');
            // alert(tag);
        }           

        tag = '\\b' + tag + '\\b';

        var re = new RegExp(tag,'i');

        if(!(re.test(sValues))){
            alert(tag);
            show = false;
            alert('no match');
            return false;
        }
        else{
            alert(tag);
            show = true;
            alert('match');
        }
    });

    if(show == false){
        $(this).parent().hide();
    }
    else{
        $(this).parent().show();
    }

});

// call the swizzleRows function in the listings.js
swizzleList();
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-05-26T10:27:09.933

通常，使用正则表达式，您可以使用`(?<!x)x(?!x)`来匹配一个 `x`既不在前面也不在后面的`x`。

借助现代 ECMAScript 2018+ 兼容的 JS 引擎，您可以使用基于后视的正则表达式：

```
(?<!\$)\$(?!\$) 
```

查看 JS 演示（仅在[支持的浏览器](http://kangax.github.io/compat-table/es2016plus/)中运行，它们的数量正在增长，请查看此处的列表）：

```
const str ="$ $$ $$$ asian italian";
const regex = /(?<!\$)\$(?!\$)/g;
console.log( str.match(regex).length ); // Count the single $ occurrences
console.log( str.replace(regex, '<span>$&</span>') ); // Enclose single $ occurrences with tags
console.log( str.split(regex) ); // Split with single $ occurrences
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T20:48:52.763

```
\bx\b 
```

说明：在两个单词边界之间匹配 x（有关单词边界的更多信息，请查看[本教程](http://www.regular-expressions.info/wordboundaries.html)）。`\b`包括字符串的开头或结尾。

我正在利用您问题中的空格分隔。如果那不存在，那么您将需要一个更复杂的表达式，例如`(^x$|^x[^x]|[^x]x[^x]|[^x]x$)`匹配可能在字符串开头和/或结尾的不同位置。这会将其限制为单个字符匹配，而第一个模式匹配整个标记。

另一种方法是对字符串进行标记（将其拆分为空格）并从标记构造一个对象，您可以查看它以查看给定字符串是否与其中一个标记匹配。这应该比正则表达式的每次查找要快得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:38:21.500

像这样的东西：

```
q=re.match(r"""(x{2})($|[^x])""", 'xx')

q.groups() ('xx', '')

q=re.match(r"""(x{2})($|[^x])""", 'xxx')

q is None True 
```

# xml-serialization - 如何读取新的 XStreamConverter 参数？

> ID：12647555
> 
> 赞同：1
> 
> 时间：2012-09-28T21:22:47.167
> 
> 标签：xml-serialization, marshalling, xstream

从 XStream 1.4.2 版本开始，XStreamConverter 注释需要额外的参数（非常好的特性，正是我需要的）。

```
@XStreamConverter(value=CustomXStreamConverter.class, strings={xyz"})
private List<String> phones; 
```

但是如何在我的自定义转换器中读取这个值（xyz）？

```
public class CustomXStreamConverter implements Converter {
    //?
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:13:33.607

我想出了解决方案，只需重写类构造函数即可接收参数。

```
public class CustomXStreamConverter implements Converter {

private String alias;

public ListToStringXStreamConverter(String alias) {
    super();
    this.alias = alias; //xyz
}
//... 
```

# java - Pojo 的 SpringMvc 注释

> ID：12647561
> 
> 赞同：2
> 
> 时间：2012-09-28T21:23:18.220
> 
> 标签：java, spring-mvc, annotations

如果使用基于注释的配置，您将在 POJO、DAO 和接口、实现的接口类上使用哪些注释。我不熟悉在 applicationContext.xml 中使用我知道的注释，您将包括

此外，使用注释时 servlet-context.xml 中定义的内容是否保留了 bean 定义，例如。

```
<bean name="/welcome.htm" class="com.test.WelcomeController">
        <property name="welcomeManager" ref="welcomeManager"/>  
 </bean> 
```

我正在阅读 Springsource 文档，但没有看到 POJO、DAO、接口和已实现接口的任何配置

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T00:02:49.837

对于我会使用的 POJO `@Component`，对于由 DB 支持的 DAO，我会使用`@Repository`（你会得到持久性异常转换）。有关更多信息，请参阅[这个 SO question](https://stackoverflow.com/questions/6827752/whats-the-difference-between-component-repository-service-annotations-in)。

# iphone - ios AVAudioPlayer 播放带有回声的声音

> ID：12647569
> 
> 赞同：1
> 
> 时间：2012-09-28T21:23:53.907
> 
> 标签：iphone, ios, ipad, avaudioplayer

我有两个 AVAudioPlayer 来确定什么声音完成之后做某事。第一个声音播放得很好，但第二个声音（twoPlayer）播放带有回声的声音。你们中的任何人都知道为什么或如何发生这种情况吗？

我的 .h 文件中有这个：

```
@interface myClass : UIViewController<AVAudioPlayerDelegate>
{
    AVAudioPlayer *onePlayer;
    AVAudioPlayer *twoPlayer;
}
@property (retain, nonatomic) AVAudioPlayer *onePlayer;
@property (retain, nonatomic) AVAudioPlayer *twoPlayer;

.m file:

    NSString *urlAddress = [[NSBundle mainBundle] pathForResource:@"sound" ofType:@"m4a"];

    NSURL *url = [NSURL fileURLWithPath:urlAddress];

    NSError *error;
    twoPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];
    twoPlayer.delegate=self;
    twoPlayer.volume=0.5;
    if (twoPlayer == nil)
        NSLog(@"[error description]");
    else
        [twoPlayer play];

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag {

    if (player==onePlayer) {
        [onePlayer release];
    }
    if (player==twoPlayer) {
        [numberPlayer release];
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:59:54.827

我发现错误我正在使用“forControlEvents：UIControlEventAllTouchEvents”设置 UIButton，并且 actionw 被多次触发。我用这个 forControlEvents:UIControlEventTouchDown 替换 UIButton 并且工作得很好。

# java - 正则表达式 JAVA 返回分隔符之间的链

> ID：12647571
> 
> 赞同：-1
> 
> 时间：2012-09-28T21:23:58.260
> 
> 标签：java, regex, delimiter

> **可能重复：**
> [正则表达式匹配打开的标签，XHTML 自包含标签除外](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)

我正在尝试检索分隔符之间的字符串...

这里的样本：

```
<TAG> x1 x2 y1 y2 </TAG> 
```

我希望我的正则表达式返回`TAG`

您能否提供一个**好的**正则表达式文档的链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:40:03.227

您正在做的事情可能没问题，只要标签不是递归的，否则这样做不是一个好主意！（有趣的[读物](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)）。

如果您尝试编写正则表达式以在这些标签之间获取某些内容，并且这是您希望处理的唯一确切情况：

1.  您需要在标签 1 中捕获名称。请参阅-[这](http://www.javamex.com/tutorials/regular_expressions/capturing_groups.shtml)是通过用括号括起来完成的。

> `regex = "<(.*?)>"`.

问号是为了确保匹配最短的字符串（非贪婪） - 在你的情况下是 TAG 。如果你只给出 <.*> 它匹配整个表达式，因为默认情况下正则表达式倾向于匹配最长的字符串。括号中存储了标签名称，以便在步骤 2 中使用。

2.  然后，您需要确保结束标签具有相同的标签 - 这需要对捕获的组进行反向引用。（请参阅[this](http://www.regular-expressions.info/brackets.html)）。所以，在这里你需要写：

> `regex = "<(.*?)>.*</\1>"`

\1 是对第一组括号中捕获的表达式的反向引用。

我自己没有测试它，但它应该让您了解编写此类表达式所需的概念。

# wordpress - Wordpress 插件功能代码

> ID：12647578
> 
> 赞同：0
> 
> 时间：2012-09-28T21:24:35.403
> 
> 标签：wordpress, plugins

我正在尝试制作一个简单的插件，在用户个人资料页面中显示一些信息（我已经管理了这部分）但我没有开始工作的是我想添加一个函数来检查文件是否存在于一个文件夹（我可以做这部分），但是当我将一个函数添加到插件代码中时，它不起作用或阻止页面显示。

任何帮助都会很棒，我只需要在用户查看配置文件时触发该功能。

```
function check_file(){
  if($file == 'me.jpg'){
     //do something
  }
  else{}
}
 check_file(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:32:58.157

找到了答案

```
add_action( 'show_user_profile', 'check_file' ); 
```

`check_file`当用户看到配置文件时，上面的行将运行该功能。

# html - 将组从 svg 文件嵌入到 html

> ID：12647581
> 
> 赞同：1
> 
> 时间：2012-09-28T21:24:48.447
> 
> 标签：html, image, svg, embed

我想从 SVG 文件中嵌入一个组，该组可以用 id 标识。我天真的方法是：

**1.嵌入**

```
<embed src="cards/svg-cards.svg#joker_red"
  id="embsvg"
  width="300" height="220"  type="image/svg+xml"
  pluginspage="http://www.adobe.com/svg/viewer/install/"  
  viewBox="0 0 100 100"
 /> 
```

**2\. 图像**

```
<image id="i" x="10" y="20" width="80" height="80" 
   xlink:href="cards/svg-cards.svg#joker_red" /> 
```

**3\. 对象**

```
<object data="cards/svg-cards.svg#red_joker"></object> 
```

我尝试了一些更愚蠢的变体，包括 USE 元素和 javascript。

svg 文档取自这里：[Sourceforge](http://sourceforge.net/projects/svg-cards/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T10:52:52.820

我自己发现了。

重要的是，给所有可见元素一个类属性，比如 class="card" 并指定 'svg .card { display: none }' 作为样式。那会让一切都消失。然后只有在svg文件名后面通过#选择的项目才会真正显示出来。

要显示的部分是组元素还是 svg 元素并不重要。

罗伯特发布的代码就是这样做的，但对我来说，这门课的重要性并不明显。

# c# - VSTO：Visual Studio 2005 和 Office 2010 64

> ID：12647584
> 
> 赞同：0
> 
> 时间：2012-09-28T21:25:19.447
> 
> 标签：c#, visual-studio-2005, vsto, office-2010, office-2003

我正在使用 Visual Studio 2005 开发 Office 2003 加载项。但在卸载 Office 2003 和安装 Office 2010 x64 后，我的项目停止工作。

它存在一些错误：

```
Error   7   The type or namespace name 'IRibbonControl' could not be found (are you missing a using directive or an assembly reference?)    x.cs    83  45  x
Error   5   The type or namespace name 'IRibbonUI' could not be found (are you missing a using directive or an assembly reference?) x.cs    358 38  x
Error   3   The type or namespace name 'IRibbonExtensibility' does not exist in the namespace 'Microsoft.Office.Core' (are you missing an assembly reference?)  x.cs    45  43  x 
```

有什么方法可以让我的 AddIn 运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T05:50:32.677

不知道你是否看过这个，但这里有一些解释：

> Office 2010 32 位应运行 VSTO 2005 SE 加载项而不进行修改，但 Office 2010 64 位将不会加载 VSTO 2005 SE 加载项。
> 
> 需要 Visual Studio 2005 Tools for Office Second Edition Runtime 的 Office 解决方案与 64 位版本的 Microsoft Office 2010 不兼容。要在 64 位版本的 Microsoft Office 2010 中运行这些解决方案，您必须将项目升级到 Visual Studio 2010 或针对 2007 Microsoft Office 系统的 Visual Studio 2008 项目。

更多细节[在这里](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/921dfc91-b076-4c11-87c9-2e1a79e7c260/)。

还可以查看[维基百科](http://en.wikipedia.org/wiki/VSTO)上的 VSTO 兼容性表，这可能是有用的信息

# iphone - UIImageView如何清除选中的点颜色？

> ID：12647586
> 
> 赞同：0
> 
> 时间：2012-09-28T21:25:29.913
> 
> 标签：iphone, ios4

我正在创建一个具有绘图模块的应用程序，我正在尝试做的是我有一个图像，我必须在其上绘制文本。现在我需要用橡皮擦删除文本，并且绘图板（UIImageView）的高度必须是无限的。所以我需要滚动图像视图以及在其上应用绘图。如果有人有任何答案，请回复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T13:38:42.297

我以前回答过这样的问题....也许这会对您有所帮助:)您还会看到我认为会有所帮助的冗长讨论....

[在 Iphone 的 ImageView 上写作](https://stackoverflow.com/questions/11828200/can-we-write-by-dragging-finger-over-screen/11828810#11828810)

# visual-studio-2010 - MSBuild/VS2010：如何在 VS2010“属性表”中引用“RuntimeLibrary”编译器设置

> ID：12647593
> 
> 赞同：5
> 
> 时间：2012-09-28T21:25:54.793
> 
> 标签：visual-studio-2010, msbuild, propertysheet

我正在编写一个 Visual Studio 2010 属性表来集成一个复杂的第 3 方 C++ 库。

要确定我需要链接到我的项目的库的哪些部分（以及配置各种定义、包含、目录等），我的属性表需要确定项目当前配置的 C 运行时库（即“MultiThreaded”、“ MultiThreadedDebug”、“MultiThreadedDLL”或“MultiThreadedDebugDLL”）。

但是，正如 stackoverflow 上的一个[基本相似的问题](https://stackoverflow.com/questions/4721879/ms-build-access-compiler-settings-in-a-subsequent-task)所指出的那样，这个 MSBuild 条件不起作用：

```
Condition = " '$(RuntimeLibrary)' == 'MultiThreadedDLL' " 
```

提供了另一个选项，但它是针对*后续*构建任务的。在构建之前我需要这个值。

我还搜索了谷歌和微软的 MSDN 网站，寻找一种方法来获得这个价值，但结果却一无所获。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:48:54.630

由于无法通过 MSBuild 的 XML 直接获取配置的运行时库，因此我对项目文件进行了正则表达式。这是执行此操作的 XML PropertyGroup 片段：

```
<PropertyGroup Label="UserMacros">
  <RuntimeLibraryRegex>
    <![CDATA[<ItemDefinitionGroup Condition=".*']]>$(Configuration)\|$(Platform)<![CDATA['">(?:.*\n)*?.*<RuntimeLibrary>(.*)</RuntimeLibrary>(?:.*\n)*?.*</ItemDefinitionGroup>]]>
  </RuntimeLibraryRegex>
  <RuntimeLibrary>
    $([System.Text.RegularExpressions.Regex]::Match($([System.IO.File]::ReadAllText($(MSBuildProjectFullPath))), $(RuntimeLibraryRegex)).Result('$1'))
  </RuntimeLibrary>
</PropertyGroup> 
```

现在问题中的 Condition 语句将按原样工作。

另外，请注意，此 MSBuild 属性组 XML 不考虑运行时库默认值（例如，如果项目没有设置运行时库），但可以轻松实现。

# mysql - 用 Java 从 WikiMedia 数据库中读取 varbinary 值

> ID：12647596
> 
> 赞同：0
> 
> 时间：2012-09-28T21:26:12.360
> 
> 标签：mysql, wikipedia, wikimedia

我正在尝试使用以下代码获取 MySQL 查询（WikiMedia；“ **varbinary 字段”）的结果：**

```
rs = stmt.executeQuery("SELECT *  FROM `redirect` WHERE `rd_namespace` = 0 AND `rd_title` = XY);

        while (rs.next()) {         
             title = rs.getString("title");
        } 
```

不幸的是，“title”杀死了所有的德语“元音变音”（ä、ü、ö 等）

我怎么解决这个问题？

谢谢 ：-）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T08:11:01.173

最后我解决了这个问题:-)

![在此处输入图像描述](../Images/c7e8db3de65924e42bed1737f631aaa8.png)

# c++ - 需要一个宏来从 std::ostringstream 和 << arg 列表创建 std::string

> ID：12647601
> 
> 赞同：0
> 
> 时间：2012-09-28T21:26:48.130
> 
> 标签：c++, ostringstream

我想编写一个宏，它将 std::ostream& operator<< 连接对象的列表作为其唯一参数，并将合并的字符串作为单个 std::string 对象传递给函数。将合并后的字符串传递给函数的能力是关键；在下面的示例中，我知道示例本身可以通过定义宏来重写以工作`ERR_MSG(inputs) std::cout << "ERROR: " << inputs`，但是将输出发送到 std::cout 不是目标，它只是我为示例选择的测试目标。

我正在使用 GCC 4.1.2（Red Hat 4.1.2-52）并且升级它不是一个选项。这是我尝试过的一个非常简单的版本：

```
#include <sstream>
#include <iostream>

#define ERR_MSG(inputs) errMsg(std::ostringstream().str())           // 1
#define ERR_MSG(inputs) errMsg((std::ostringstream()<<inputs).str()) // 2
<aReturnType> errMsg(const std::string& msg)                                 // use with 1 & 2
{
    std::cout << "\nERROR: " << msg << "\n\n";
    return <someObjectCreatedBasedOnTheInput>;
}

#define ERR_MSG(inputs) errMsg(std::ostringstream()<<inputs)         // 3
<aReturnType> errMsg(const std::ostringstream& msg)                           // use with 3
{
    std::cout << "\nERROR: " << msg.str() << "\n\n";
    return <someObjectCreatedBasedOnTheInput>;
}

int main()
{
    ERR_MSG("A number: " << 24 << ", a char: " << 'c' << ", that's all!");
} 
```

宏 #1 编译，但当然只打印消息的“”。宏 2 和 3 都无法编译，并出现以下错误：

```
#define ERR_MSG(inputs) errMsg((std::ostringstream()<<inputs).str()) // 2
error: ‘struct std::basic_ostream<char, std::char_traits<char> >’ has no member named ‘str’

#define ERR_MSG(inputs) errMsg(std::ostringstream()<<inputs)         // 3
no matching function for call to ‘errMsg(std::basic_ostream<char, std::char_traits<char> >&)’
    note: candidates are: char* errMsg(const std::string&)
    note:                 char* errMsg(const std::ostringstream&) 
```

我对如何在没有宏的情况下重写它***不感兴趣；***我自己可以很容易地做到这一点。

=== 更新：=== 我忘了提到在它的实际用例中，宏调用的函数返回一个可以被宏调用者使用的对象。这会使无法在单个表达式中实现的任何宏实现无效，其结果是宏调用的函数的返回类型。宏的“什么都不做”实现（用于发布版本）将简单地将空的 std::string 传递给函数，而不管“输入”是什么。很抱歉没有在前面提到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:37:58.663

您当前的问题是所有各种`operator<<`函数都返回一个`ostream&`，而不是一个`ostringstream&`。你可以用[一个简单的演员](http://ideone.com/f2JE7)来解决这个问题：

```
#define ERR_MSG(inputs) errMsg((static_cast<std::ostringstream&>(std::ostringstream().flush() << inputs)).str()) 
```

是需要的`flush`，因为`std::ostringstream()`是临时的。因此，您不能在其上调用采用左值引用的函数（即：）`std::ostream&`。与大多数`operator<<`变体一样的功能。`flush`调用所做的只是将指针`this`作为左值引用返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:36:53.573

~~如果你愿意使用一些[GCC 扩展](http://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html#Statement-Exprs)~~，您可以在块中的宏内声明一个实际的 ostringstream，以便可以使用 .str() 方法而无需强制转换：

```
#define ERR_MSG(inputs) \
    do { std::ostringstream _s_; _s_<<inputs;errMsg(_s_.str()); } while(false) 
```

演示：http: [//ideone.com/clone/y56lc](http://ideone.com/clone/y56lc)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T22:12:24.893

```
#include <sstream>
#include <iostream>

#define ERR_MSG(inputs) errMsg(std::ostringstream().flush()<<inputs)
int errMsg(std::ostream& os)
{
    std::ostringstream& oss(static_cast<std::ostringstream&>(os));
    const std::string& str(oss.str());
    std::cout << "\nERROR: " << str << "\n\n";
    return str.length();
}

int main()
{
    int i = ERR_MSG("A number: " << 24 << ", a char: " << 'c' << ", that's all!");
   std::cout << i << "\n";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T21:52:58.617

使用`do { } while (false)`idiom 使几行宏。

```
#define ERR_MSG(inputs) \
  do { \
      std::ostringstream osERR_MSG; \
      osERR_MSG << inputs; \
      errMsg(osERR_MSG.str()); \
  } while (false)

int main() {
   if (1) ERR_MSG("A number: " << 24 << ", a char: " << 'c' << ", that's all!");
   else return 0;
} 
```

我之所以取这个奇怪的名字`osERR_MSG`是为了尽可能避免这样的情况：

```
int osERR_MSG = 7;
ERR_MSG(osERR_MSG); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T22:18:52.870

将 Nicol 的答案恢复为迄今为止最好的答案：

您当前的问题是所有各种`operator<<`函数都返回一个`ostream&`，而不是一个`ostringstream&`。你可以用[一个简单的演员](http://ideone.com/NQrAO)来解决这个问题：

```
#define ERR_MSG(inputs) errMsg((static_cast<std::ostringstream&>(std::ostringstream().flush() << inputs)).str()) 
```

当然，这仍然有问题（就像这里的所有答案一样）

```
ERR_MSG(x ? "x is true" : "x is false") 
```

会以一种奇怪而令人困惑的方式行为不端。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-28T21:45:46.277

我不会创建一个`std::ostringstream`，而是有一个从派生自`std::ostream`. 下面是这种方法的一个例子：

```
#include <sstream>
#include <iostream>

void someFunction(std::string const& value)
{
    std::cout << "someFunction(" << value << ")\n";
}

void method(std::string const& value)
{
    std::cout << "method(" << value << ")\n";
}

class FunctionStream
    : private virtual std::stringbuf
    , public std::ostream
{
public:
    FunctionStream()
        : std::ostream(this)
        , d_function(&method)
    {
    }
    FunctionStream(void (*function)(std::string const&))
    : std::ostream(this)
    , d_function(function)
    {
    }
    ~FunctionStream()
    {
        this->d_function(this->str());
    }
private:
    void (*d_function)(std::string const&);
};

int main(int ac, char* av[])
{
    FunctionStream() << "Hello, world: " << ac;
    FunctionStream(&someFunction) << "Goodbye, world: " << ac;
} 
```

示例使用不使用宏，但这可以很容易地围绕上述使用`FunctionStream()`. 请注意，在宏中，您可能希望确保宏的用户看到的类型是类型`std::ostream&`而不是临时类型，以便可以直接与用户定义的输出运算符一起使用。为此，您应该插入其中一种直接支持的类型，该类型`std::ostream`没有任何效果但返回一个`std::ostream&`，例如：

```
#define SomeMacro(output) FunctionStream(&someFunction) << "" << output 
```

# java - Spring：控制器@RequestMapping到jsp

> ID：12647605
> 
> 赞同：4
> 
> 时间：2012-09-28T21:27:11.877
> 
> 标签：java, spring, spring-mvc

使用 Spring 3.1.2

您如何从 jsp 中引用 CONTROLLER（不是方法）RequestMapping 的注释值，以便我可以构建相对于控制器的 URL。如果引用了方法级别的请求映射，则会导致我的链接不起作用，因此它们无论如何都不能成为 this 的一部分。

例如（注意这个控制器的映射是“/foo/test”）：

```
@Controller
@RequestMapping("/foo/test")
public class FooController {

    @RequestMapping(value="/this", method=RequestMethod.GET)
    public String getThis() {
        return "test/this";
    }

    @RequestMapping(value="/that", method=RequestMethod.GET)
    public String getThat() {
        return "test/that";
    }

    @RequestMapping(value="/other", method=RequestMethod.GET)
    public String getOther() {
        return "test/other";
    }
} 
```

...从我的 this.jsp 中：

```
<%@ taglib uri="http://www.springframework.org/tags" prefix="s"%>
<s:url value="${controllerRequestMapping}" var="baseUrl"/>

<a href="${baseUrl}/that">That</a>
<a href="${baseUrl}/other">Other</a> 
```

我需要访问 RequestMapping 的原因是因为我的视图可以从多个控制器访问。注意这个控制器的映射是“/bar/test”！

```
@Controller
@RequestMapping("/bar/test")
public class BarController {

    @RequestMapping(value="/this", method=RequestMethod.GET)
    public String getThis() {
        return "test/this";
    }

    @RequestMapping(value="/that", method=RequestMethod.GET)
    public String getThat() {
        return "test/that";
    }

    @RequestMapping(value="/other", method=RequestMethod.GET)
    public String getOther() {
        return "test/other";
    }
} 
```

我的一些控制器级别的请求映射也有路径变量，所以只获取请求映射的字符串值是行不通的。必须解决：

```
@Controller
@RequestMapping("/something/{anything}/test/")
public class SomethingController {
...
} 
```

**更新**

也许如果有一种方法可以通过在 Spring URL 标记之前将控制器请求映射附加到上下文路径来修改上下文路径，那将解决问题。

```
contextPath = contextPath/controllerRequestMapping 
```

然后，我可以这样做，因为我相信 Spring 会自动检索当前上下文路径：

```
<%@ taglib uri="http://www.springframework.org/tags" prefix="s"%>

<a href="<s:url value="/that"/>">That</a>
<a href="<s:url value="/other"/>">Other</a> 
```

当然，这将是最佳的！想法？想法……？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T04:03:56.187

您可以使用 Servlet API 获取 URI。据我所知，没有“春天”的方式来做到这一点。

```
@RequestMapping(value="/this", method=RequestMethod.GET)
public String getThis(HttpServletRequest request, Model m) {
    m.addAttribute("path", request.getRequestURI());
    return "test/this";
} 
```

然后在您的 JSP 中：

```
<a href="${path}">This</a> 
```

有关 HttpServletRequest 的更多信息，[请参阅此处的 API](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getRequestURI%28%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:30:00.877

没有内置的方式来访问`@RequestMapping`，但您可以简单地将 URL 添加到模型中，并以这种方式从视图中引用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:50:30.730

如果您使用的是 Spring 3.1 及更高版本，请参阅下面的代码以访问请求映射。我不确定这是否是您所需要的。这只是一种尝试，当然我不知道任何直接的方法。从具有请求映射的方法内部调用 getRequestMappings()。

```
public class FooController{

    private RequestMappingHandlerMapping handlerMapping = null;

    @Autowired
    public FooController(RequestMappingHandlerMapping handlerMapping){
        this.handlerMapping = handlerMapping;
    }

    public Set<String> getRequestMappings(){
        Map<RequestMappingInfo, HandlerMethod> handlerMap = handlerMapping.getHandlerMethods();
        Iterator<RequestMappingInfo> itr = handlerMap.keySet().iterator();
        while(itr.hasNext()){
            RequestMappingInfo info = itr.next();
            PatternsRequestCondition condition = info.getPatternsCondition();
            Set<String> paths = condition.getPatterns();
            HandlerMethod method = handlerMap.get(info);
            if(method.getMethod().getName().equals(Thread.currentThread().getStackTrace()[2].getMethodName()))
            return paths;

            }
        return new HashSet<String>();
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T05:50:05.070

根据我的说法，在类级别和方法级别放置 @RequestMapping 注释没有区别。取而代之的是，您只能在方法顶部使用组合的 @RequestMapping 注释。

所以现在你的方法级别注释将是这样的。

```
@RequestMapping(value="("/foo/test/this", method=RequestMethod.GET) 
```

或者

```
@RequestMapping(value="("/bar/test/this", method=RequestMethod.GET) 
```

现在，由于您的两种方法都返回相同的视图，您可以只为它们两种方法使用一种方法。并且在注解映射值而不是 foo 和 bar 中，您可以引入一个路径变量**{from}**。所以最后你的注释和方法将是这样的。

```
@RequestMapping(value="("/{from}/test/this", method=RequestMethod.GET)
public String getThis(@PathVariable("from") String from) {       
    return "test/this";       
} 
```

在您的方法中执行此操作后，您可以根据您获得的路径变量的运行时值执行不同的计算或**操作**。在 JSP 页面中，您可以简单地使用`${from}`.

希望这对您有所帮助。干杯。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-20T05:57:08.603

从 4.1 开始，每个 @RequestMapping 都根据类的大写字母和完整的方法名称分配了一个默认名称。例如，类 FooController 中的方法 getFoo 被分配了名称“FC#getFoo”。此命名策略`enter code here` 可通过实现 HandlerMethodMappingNamingStrategy 并在您的 RequestMappingHandlerMapping 上进行配置来插入。此外，@RequestMapping 注释包括一个名称属性，可用于覆盖默认策略。Spring JSP 标记库提供了一个名为 mvcUrl 的函数，可用于基于此机制准备指向控制器方法的链接。

例如给出：

```
@RequestMapping("/people/{id}/addresses")
public class MyController {
@RequestMapping("/{country}")
public HttpEntity getAddress(@PathVariable String country) { ... }
} 
```

下面的 JSP 代码可以准备一个链接：

```
<%@ taglib uri="http://www.springframework.org/tags" prefix="s" %>
...
<a href="${s:mvcUrl('MC#getPerson').arg(0,'US').buildAndExpand('123')}">Get Address</a> 
```

确保您已使用 Java Config 或 XML 方式配置 MVC，而不是两种方式。你会得到一个异常：多个 RequestMappingInfo HandlerMapping 被发现。

# plugins - Magento 插件现在随机成为我们的主页

> ID：12647607
> 
> 赞同：0
> 
> 时间：2012-09-28T21:27:15.243
> 
> 标签：plugins, magento-1.4, magento

我们最近购买了 Unirgy 的一个名为 uStoreLocator 的 Magento 插件。我们运行的是免费版，但刚刚更新到完整版。

现在插件已安装，后端工作正常。但...

它仍然在商店定位器页面上显示旧版本，并且相同的旧版本现在已经取代了我们的实际主页！

有人对做什么或去哪里有任何建议吗？

我们正在运行 Magento v1.4.1

# android - Android -> 如何使用 Eclipse 发现错误？

> ID：12647610
> 
> 赞同：-1
> 
> 时间：2012-09-28T21:27:23.697
> 
> 标签：android, eclipse, error-handling

我正在写一个应用程序。我正在使用 eclipse 在我的手机上进行测试。突然我的应用程序开始崩溃，但我在 Eclipse 中没有任何错误。我想知道我怎么能看到，问题出在哪里，发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:29:57.003

您可以在 LogCat 中查看日志（以及如果您的应用程序崩溃时的堆栈跟踪）。

*   在 Eclipse 中，转到窗口-> 显示视图-> 其他-> Android-> Logcat。

*   在您的设备上，您可以下载[aLogCat](https://play.google.com/store/apps/details?id=org.jtb.alogcat&hl=en "日志猫")并使用它来查看手机上的日志。

# c# - Wcf 服务异常良好实践

> ID：12647615
> 
> 赞同：33
> 
> 时间：2012-09-28T21:27:54.510
> 
> 标签：c#, .net, wcf, web-services

我正在开发一个分布式应用程序。在其中，我必须验证角色和权限集。
抛出**异常**（例如**未经授权的访问**）是一种好习惯吗？
或者我应该向客户发送一些消息？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-09-28T22:05:09.250

在您的服务操作中，您可以指定一个能同时满足这两个目的的***FaultContract ，如下所示：***

```
[OperationContract]
[FaultContract(typeof(MyServiceFault))]
void MyServiceOperation(); 
```

请注意，必须使用 DataContract 和 DataMember 属性标记 MyServiceFault，就像使用复杂类型一样：

```
[DataContract]
public class MyServiceFault
{
    private string _message;

    public MyServiceFault(string message)
    {
        _message = message;
    }

    [DataMember]
    public string Message { get { return _message; } set { _message = value; } }
} 
```

在服务端，您可以：

```
throw new FaultException<MyServiceFault>(new MyServiceFault("Unauthorized Access")); 
```

在客户端：

```
try
{
    ...
}
catch (FaultException<MyServiceFault> fault)
{
    // fault.Detail.Message contains "Unauthorized Access"
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-28T22:12:25.053

好吧，您可以在 WCF 服务实现方法中捕获所有异常并将它们作为 FaultExceptions 重新抛出。通过这种方式，异常将在客户端上重新抛出，并带有您选择的消息：

```
[OperationContract]
public List<Customer> GetAllCustomers()
{
    try
    {
        ... code to retrieve customers from datastore
    }
    catch (Exception ex)
    {
        // Log the exception including stacktrace
        _log.Error(ex.ToString());

        // No stacktrace to client, just message...
        throw new FaultException(ex.Message);
    }
} 
```

为了避免将意外错误转发回客户端，最好不要在服务器端的代码中抛出异常实例。而是创建一种或多种您自己的异常类型并抛出它们。通过这样做，您可以区分意外的服务器处理错误和由于无效请求等引发的错误：

```
public List<Customer> GetAllCustomers()
{
    try
    {
        ... code to retrieve customers from datastore
    }
    catch (MyBaseException ex)
    {
         // This is an error thrown in code, don't bother logging it but relay
         // the message to the client.
         throw new FaultException(ex.Message);
    }
    catch (Exception ex)
    {
        // This is an unexpected error, we need log details for debugging
        _log.Error(ex.ToString());

        // and we don't want to reveal any details to the client
        throw new FaultException("Server processing error!");
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-03T11:01:10.117

**如果您不使用basicHTTPBinding**，则抛出一般的 Dot Net 异常会使服务客户端代理和服务器通道进入故障状态...为了避免您应该始终从服务中抛出**FaultException** ... 从您的 catch 块中使用：

```
throw new FaultException("Your message to the clients"); 
```

# sql - CROSS APPLY 与 OUTER APPLY 相比

> ID：12647616
> 
> 赞同：5
> 
> 时间：2012-09-28T21:28:03.813
> 
> 标签：sql, sql-server-2008-r2

这些脚本给了我相同的结果

```
SELECT * FROM
(select x = null) x
OUTER APPLY
(select x = 1) y  

SELECT * FROM
(select x = null) x
CROSS APPLY
(select x = 1) y 
```

`CROSS APPLY`和`OUTER APPLY`一样吗 ？

有没有他们不返回相同结果的情况的例子？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-28T21:31:28.367

想想 INNER JOIN（用于 CROSS）和 LEFT JOIN（用于 OUTER），以使区别更容易理解。CROSS 仅返回应用函数返回结果集的外部表中的行。OUTER 返回外部表中的所有行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-28T21:36:57.493

这是他们不会返回相同结果的情况。顺便说一句，仅当您需要将先前的表/子查询与下一个相关联时才使用 APPLY。

```
 SELECT x.x, y.x y
       FROM (select [x] = 1) x
OUTER APPLY (select [x] = 1 where x.x is null) y  

-- result
1, null

     SELECT x.x, y.x y
       FROM (select [x] = 1) x
CROSS APPLY (select [x] = 1 where x.x is null) y

-- result
(empty result set) 
```

OUTER APPLY 是 CROSS APPLY
OUTER JOIN 是 INNER JOIN

# java - Android：使用 SharedPreferences 时出现 NullPointerException

> ID：12647617
> 
> 赞同：1
> 
> 时间：2012-09-28T21:28:09.740
> 
> 标签：java, android, sharedpreferences

使用 SharedPreferences，此活动在启动时崩溃。首先我会发布活动代码，然后我会发布我的 LogCat。非常感谢你们，你们总是这么大的帮助！:-)

活动代码；

```
package com.creativecoders.gymbuddy;

import com.creativecoders.gymbuddy.R;

import android.app.Activity;
import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.EditText;
import android.widget.TextView;

public class Benchmark extends Activity {

public static final String GB_PREFERENCES_BENCH = "Bench";
public static final String GB_PREFERENCES_FLIES = "Flies";

SharedPreferences settings = getSharedPreferences("gBValues", 
     Context.MODE_PRIVATE);

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_benchmark);
    }

public void onStart() {
    super.onStart();

    findViewById(R.id.button5).setOnClickListener(new handleButton5());

}

class handleButton5 implements OnClickListener {
    public void onClick(View v) {

        EditText editText1 = (EditText)findViewById(R.id.editText1);
        String sWeight = editText1.getText().toString();
        final double dWeight = Double.parseDouble(sWeight);

        EditText editText2 = (EditText)findViewById(R.id.editText2);
        String sPush = editText2.getText().toString();
        final double dPush = Double.parseDouble(sPush);

        EditText editText3 = (EditText)findViewById(R.id.editText3);
        String sSit = editText3.getText().toString();
        final double dSit = Double.parseDouble(sSit);

        EditText editText4 = (EditText)findViewById(R.id.editText4);
        String sPull = editText4.getText().toString();
        final double dPull = Double.parseDouble(sPull);

        double dBench = (((Math.floor(dWeight*.0664))*10)-10)+dPush;
        double dFlies = (Math.floor(((Math.floor(dBench*.6)/10)*10)));

        int iBench = (int)dBench;
        int iFlies = (int)dFlies;

        String sBench = "" + iBench;
        String sFlies = "" + iFlies;

        SharedPreferences.Editor editor1 = settings.edit();
        editor1.putString(GB_PREFERENCES_BENCH, sBench);
        editor1.commit();

        SharedPreferences.Editor editor2 = settings.edit();
        editor2.putString(GB_PREFERENCES_FLIES, sFlies);
        editor2.commit();

        TextView TextView1 = (TextView)findViewById(R.id.textView1);
        TextView1.setText(String.valueOf("Bench Press "+ iBench +" lbs"));

        TextView TextView2 = (TextView)findViewById(R.id.textView2);
        TextView2.setText(String.valueOf("Bar Curls "+ iCurls +" lbs"));
        }
    }

} 
```

这是我的 LogCat；

```
09-28 21:18:52.636: E/AndroidRuntime(686): FATAL EXCEPTION: main
09-28 21:18:52.636: E/AndroidRuntime(686): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.creativecoders.gymbuddy/com.creativecoders.gymbuddy.Benchmark}: java.lang.NullPointerException
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1879)
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.app.ActivityThread.access$600(ActivityThread.java:122)
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.os.Looper.loop(Looper.java:137)
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.app.ActivityThread.main(ActivityThread.java:4340)
09-28 21:18:52.636: E/AndroidRuntime(686):  at java.lang.reflect.Method.invokeNative(Native Method)
09-28 21:18:52.636: E/AndroidRuntime(686):  at java.lang.reflect.Method.invoke(Method.java:511)
09-28 21:18:52.636: E/AndroidRuntime(686):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-28 21:18:52.636: E/AndroidRuntime(686):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-28 21:18:52.636: E/AndroidRuntime(686):  at dalvik.system.NativeStart.main(Native Method)
09-28 21:18:52.636: E/AndroidRuntime(686): Caused by: java.lang.NullPointerException
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.content.ContextWrapper.getSharedPreferences(ContextWrapper.java:153)
09-28 21:18:52.636: E/AndroidRuntime(686):  at com.creativecoders.gymbuddy.Benchmark.<init>(Benchmark.java:35)
09-28 21:18:52.636: E/AndroidRuntime(686):  at java.lang.Class.newInstanceImpl(Native Method)
09-28 21:18:52.636: E/AndroidRuntime(686):  at java.lang.Class.newInstance(Class.java:1319)
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
09-28 21:18:52.636: E/AndroidRuntime(686):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1870)
09-28 21:18:52.636: E/AndroidRuntime(686):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T21:31:17.413

您必须在调用 onCreate 之后访问共享首选项。否则上下文将为空 :) 这就是为什么你得到一个空指针异常

移动这一行：

```
SharedPreferences settings = getSharedPreferences("gBValues", 
     Context.MODE_PRIVATE); 
```

在 onCreate()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-13T20:17:51.437

```
public class MainActivity extends Activity{

SharedPreferences sharedpreferences;    

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

sharedpreferences = getSharedPreferences("preferences", Context.MODE_PRIVATE);  

            editor.putBoolean("sharedpreferences", true);
            editor.commit();

// your code ...

}

// your code ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T21:33:32.700

将设置实例变量的实例化移动到您的 onCreate 方法中。在 super.onCreate 调用之后。

你现在这样做的方式，它被设置为空；

# c# - 为什么我要包含一个 Func/Func 作为参数？

> ID：12647620
> 
> 赞同：3
> 
> 时间：2012-09-28T21:28:36.917
> 
> 标签：c#, .net

我承认它们可能很有用，但是当我实际上想要将 func 作为方法的参数时，我试图绕开我的脑袋。

```
public void WeirdMethod(int myNumber, func op); 
```

在设计和功能方面，有人可以向我解释一些我想考虑这个的情况吗？“可重用性”理论对我没有多大帮助。现实世界的场景将是最好的。帮助我像你一样思考，哈哈。

以下是我所知道的一切：

*   这将允许我通过一个代表
*   这将允许我使用 lambda 表达式。

是的...

注意：我知道这个帖子会被关闭，因为没有“正确”的答案。但我认为刚才对我来说点击它的是“延迟计算”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T21:40:26.237

*   将操作推迟到以后。一个非常实际的例子是推迟更改跟踪，直到完全填充对象树。每种类型或存储库都可以告诉您它想要做什么，而调用者可以决定何时实际执行它。

*   逻辑的组成（正如贾斯汀尼斯纳所提到的）。

*   抽象，例如（“这是一个具有输入和输出的合同，但我不在乎它的实现是什么，只要它履行合同即可）。例如，您可以将“statusWriter”传递给`Func`可能写入的方法控制台、调试窗口、日志文件、数据库，或者什么都不做。所有消费方法都知道它消费一个类型并在需要时调用它。

*   同样，将 a 传递`Func`给方法允许以一种抽象且简单的方式允许调用者定义*where谓词。*我经常使用这种范例来支持将强类型过滤器应用于结果（不是在谈论 LINQ to SQL，只是在调用者认为合适的时候过滤信息列表）。

*   优雅的函数范式，例如[这个例子](http://blogs.msdn.com/b/wesdyer/archive/2007/02/02/anonymous-recursion-in-c.aspx)，它演示了使用匿名函数的递归。如果无法将一个函数传递给另一个函数（尤其是缩写形式），这些构造将是冗长/不可能的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T21:31:57.677

一般情况是您必须将延迟计算传递给您的方法。这在计算某些东西很昂贵时很有用，例如，当您缓存某些东西时。

```
public Guid GetFromCache(string key, Func<Guid> make) {
    Guid res;
    if (!cache.TryGetValue(key, out res)) {
        res = make();
        cache.Add(key, res);
    }
    return res;
} 
```

现在您可以按如下方式调用此方法：

```
Guid guid = GetFromCache(myKey, () => database.MakeNewGuid()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T21:32:26.287

如果你有一些异步的东西，你想给它一个回调方法？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T21:31:18.363

它们使您能够使用 Curry 函数以及使用函数组合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T21:56:31.553

虽然您之前几乎肯定使用过委托（因为这就是事件），但 LINQ 是一个很好的例子，当将委托作为函数参数传递时很有用。

想想`Where`。您正在为将其用作执行的一部分的函数提供一段逻辑（特别是满足您的标准的定义 - 无论它们是什么）。

# php - str_replace 在模型或视图中？

> ID：12647623
> 
> 赞同：0
> 
> 时间：2012-09-28T21:29:05.100
> 
> 标签：php, codeigniter

# 模型

```
function Show_all_products()
{
   return $this->db->get('printer')->result();
} 
```

# 看法

表格内容正在循环中回显

```
 $i = -1;
 echo '<ul class="products">'; foreach($products as $product) : 
 if($i % 11 == 10) echo '</ul><ul class="products">'; 
?>

<li><a href="<?php echo base_url(); ?>does/products/<?php echo $product->id; echo '/'.$product->name; ?>"><?php echo $product->name; ?> </a></li>

<?php 
 $i += 1;
 endforeach; 
 echo "</ul>"; 
```

产品名称已保存，因为`Something_Something_Blah`我无法修改产品名称，因为它们被配置为显示干净的 URL 和面包屑。

问题是此视图中的链接显示为`Something_Something_Blah`

我试图做一个`str_replace`但是`$product = str_replace('_',' ', $product);`这不起作用。

我如何剥离'_'并插入 `\s` ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:33:16.040

我看到你有`<?php echo $product->name; ?>`这意味着`$product`是一个对象。

所以你应该打电话`str_replace('_', ' ', $product->name);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:52:24.217

根据[PHP 文档](http://php.net/manual/en/function.str-replace.php)，`str_replace()`接受字符串或数组作为它的第三个参数。您正在向它传递一个对象。你应该传递`$product->name`给它。

此外，请努力在您的 HTML 中嵌入 PHP，而不是在您的 PHP 中嵌入 HTML。你会发现自己在做`echo`所有事情。您也不需要手动创建`$i`迭代器，因为 foreach 循环将为您创建一个，前提是您使用`foreach($x as $key => $val)`语法。您也可以丢失`<?php echo $var;?>`for `<?= $var;?>`，并与`.`符号连接：

```
<ul class="products">
    <? foreach($products as $pK => $pV):?> 
        <? if($pK % 11 == 10):?></ul><ul class="products"><? endif;?>
        <li>
            <a href="does/products/<?= $pV->id .'/'. $pV->name;?>"><?= $pV->name;?></a>
        </li>
    <? endforeach;?>
</ul> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:37:06.353

```
 <?php 
 $i = -1;
 echo '<ul class="products">'; foreach($products as $product) : 

 $product->name = str_replace('_',' ', $product->name);

 if($i % 11 == 10) echo '</ul><ul class="products">'; 
?>

<li><a href="<?php echo base_url(); ?>does/products/<?php echo $product->id; echo '/'.$product->name; ?>"><?php echo $product->name; ?> </a></li>

<?php 
 $i += 1;
 endforeach; 
 echo "</ul>";
 ?> 
```

`str_replace`必须从内部调用，`foreach`否则将返回错误。那是我的错误。

# hash - 如何从自动递增的整数生成唯一 ID？

> ID：12647627
> 
> 赞同：1
> 
> 时间：2012-09-28T21:29:22.043
> 
> 标签：hash, hashcode, uniqueidentifier

我有一个自动递增的 id（一个 int），我想将其转换为不太“可开采”的东西。基本上，我不希望人们能够访问 data/0、data/1、data/2 等并破坏我们的整个数据库。我正在考虑只是对 ID 进行哈希处理，但我不确定是否可以保证唯一性。

假设价值范围是从 1 到几亿。可能其中一种哈希算法可以保证这些参数内的唯一性。

如果没有，采取什么好方法？

我确实考虑过散列，然后附加 ID。

我试图避免使用 GUID，因为它需要对现有代码进行大量更改，所以我更愿意转换我拥有的数据。

编辑：

为了进一步解释这种情况 - 这些是受到打击的静态资源。我不必去数据库并反转它或对照其他东西查找它。想象一下产品列表 - 用户可能有指向特定页面的链接，但我不希望他们能够以编程方式浏览每个页面，因此我需要一个非递增 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:51:40.983

据我所知，散列旨在根据一些具体数据（例如姓名、姓氏等）创建唯一 ID。散列自动递增 ID 不会对您有太大帮助。如果有人通过输入一个自动递增的 ID 搜索您的数据库，该 ID 将作为参数传递给哈希函数，他仍然会得到他想要的数据。所以我认为更好的解决方案是散列一些其他数据以获得唯一的 ID。如果您这样做，那么搜索您的数据库的人将必须知道存储在其中的确切数据（例如，他必须知道您员工的确切姓名或他的 SSN）。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T05:22:38.023

如果不需要反向查找，请在散列之前使用伪随机值对值进行加盐。

# scala - Scala 总是返回 true....为什么？

> ID：12647628
> 
> 赞同：2
> 
> 时间：2012-09-28T21:29:25.027
> 
> 标签：scala

我正在尝试学习 Scala 并且是新手。我知道这不是最佳的功能代码，欢迎任何人给我的任何建议，但我想了解为什么我一直对这个功能持正确态度。

```
 def balance(chars: List[Char]): Boolean = {
    val newList = chars.filter(x => x.equals('(') || x.equals(')'));
    return countParams(newList, 0)
  }                                               

  def countParams(xs: List[Char], y: Int): Boolean = {
    println(y + " right Here")
    if (y < 0) {
      println(y + " Here")
      return false
    } else {
      println(y + " Greater than 0")
      if (xs.size > 0) {
        println(xs.size + " this is the size")
        xs match {
          case xs if (xs.head.equals('(')) => countParams(xs.tail, y + 1)
          case xs if (xs.head.equals(')')) => countParams(xs.tail, y - 1)
          case xs => 0
        }
      }
    }
    return true;
  }
  balance("()())))".toList) 
```

我知道我遇到了 if 语句的错误分支，但它在我的函数结束时仍然返回 true。请帮我理解。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:36:20.827

您要么必须更明确地返回要返回的内容，要么使其对编译器更加明确。这有效：

```
def countParams(xs: List[Char], y: Int): Boolean = {
    println(y + " right Here")
    if (y < 0) {
      println(y + " Here")
      false
    } else {
      println(y + " Greater than 0")
      if (xs.size > 0) {
        println(xs.size + " this is the size")
        xs match {
          case xs if (xs.head.equals('(')) => countParams(xs.tail, y + 1)
          case xs if (xs.head.equals(')')) => countParams(xs.tail, y - 1)
          case xs => false
        }
      } else {
        true
      }
    }
} 
```

在上面的代码中，每个分支都`if`返回一些值，因此编译器假定它是要返回的值。顺便说一句，没有日志记录和更惯用的版本：

```
def countParams(xs: List[Char], y: Int) =
    xs match {
        case Nil => y == 0
        case '(' :: rest => countParams(rest, y + 1)
        case ')' :: rest if(y > 0) => countParams(rest, y - 1)
        case _ => false  //must be closing parens but y < 0
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T21:36:00.663

`if`in scala 是一个表达式。它返回一个值，并且在概念上类似于其他语言中的三元。

如果你想在你的 else 分支中返回一些东西，你应该为嵌套的 if 设置一个 else 并允许它返回一个值。

换句话说，正在评估所有代码并落到块中分配给 countParams`countParams`的最后一行 (the )。`{}`也就是说，`true`;

简而言之，在 countParams 的末尾丢失 true，并给你的嵌套 if 一个 else 返回有意义的东西。

# html - 创建缩略图或使用两次大高清图像？

> ID：12647638
> 
> 赞同：1
> 
> 时间：2012-09-28T21:30:07.473
> 
> 标签：html, image, usability

我有一个幻灯片，它将显示 400 像素 X 1000 像素的大图像。我需要幻灯片中每个图像的缩略图，所以我想知道......如果我只是使用图像的第二个实例但降低宽度和高度，页面加载会更快吗 - 页面会加载大图像两次吗？或者如果我加载高清图像和较小的缩略图，页面加载会更快吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:39:30.707

通常，仅使用全尺寸图像创建任何类型的图像库是一种不好的做法，在用作缩略图时会降低它们的尺寸。但是，如果您的案例是一个小画廊，每页显示 < 30 张图像，那么这可能会起作用。在另一种情况下，假设页面必须预加载所有大图像，无论用户是否播放整个幻灯片。这会减慢页面加载时间并产生不需要的数据传输。当涉及到时间时，生成缩略图仍然会更快。一个很好的工具可能是[phpThumb](http://phpthumb.sourceforge.net/)，它能够从原始图像生成任何大小的图像，然后缓存输出，从而加快下次页面加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:35:18.693

一般来说，我建议不要使用大于预期用途的图像。就个人而言，我绝对会推荐提供适当大小的图像。这些建议较少基于页面加载时间（因为您的情况的差异可能可以忽略不计），而更多地基于最佳实践。

一个非常方便的 php 实用程序，我用过很多这样的东西是[timthumb](http://code.google.com/p/timthumb/)

# ruby-on-rails-3 - Rails 3 中的 collection_select 提示/默认值

> ID：12647643
> 
> 赞同：1
> 
> 时间：2012-09-28T21:30:33.043
> 
> 标签：ruby-on-rails-3, forms

我有：

```
<%= collection_select(:name, :room_id, @room, :id, :name, class: "select optional", prompt: 'Add New Room') %> 
```

在用户选择时，房间的 ID 被传递给一个脚本，该脚本使具有该 ID 的 div 保持编辑表单可见。我想要一个“添加新房间”选项，它将显示创建新房间的表格。问题是“添加新房间”选择器没有与之关联的值，这意味着我无法为该项目构建 div。无论如何要给它一个值或更一般地向选择菜单添加一个选项？

# android - 在服务中启动具有隐式意图的主要活动

> ID：12647651
> 
> 赞同：0
> 
> 时间：2012-09-28T21:31:26.663
> 
> 标签：android, android-intent

我在向我的主要活动以及另一个类发送信息的服务中有一个隐含的意图。我现在也希望这种意图能够启动我的主要活动。我查看了与此相关的无数帖子，并尝试了许多不同的东西——清单中的`addCategory`, `setAction(MAIN; the activity's name; you name it, I've tried it...)`,`category.DEFAULT`以及其他一些导致 ActivityNotFoundExceptions （最常见）或其他不受欢迎的行为的事情。

这是设置意图的位置和清单的相关部分。意图的接收者在主活动中注册。

```
final String NEW_DOSES = "changed to protect the innocent";
Intent bluetoothBroadcast = new Intent();
several putExtra lines here
bluetoothBroadcast.setAction(NEW_DOSES);
sendBroadcast(bluetoothBroadcast);

<activity
   android:name=".AsthmaAppActivity"
   android:label="@string/app_name" >
   <intent-filter>
       <action android:name="android.intent.action.MAIN" />
       <category android:name="android.intent.category.LAUNCHER" />
   </intent-filter>
</activity> 
```

是否有可能通过相对较小的更改来启动我的主要活动？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:56:16.830

是的，但是 sendBroadcast(bluetoothBroadcast); sendBroadcast 不启动活动。您必须使用 startActivity 来实现这一点。例如，这里是启动器应用程序为了启动应用程序将执行的操作：

```
public static void LaunchApplication(Context cx, String packagename) {
    PackageManager pm = cx.getPackageManager();
    Intent i = pm.getLaunchIntentForPackage(ai.packageName);
    if (i != null) cx.startActivity(i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK));
} 
```

您可以轻松调整启动活动所需的附加功能和数据。例如，如果您的活动名为 myActivity，那么您可以这样：

```
Intent i = new Intent(cx, myActivity.class);
//Put the extras and the data you want here...
//If you are launching the activity from a receiver component you must use
//i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
cx.startActivity(i); 
```

希望这可以帮助...

# jquery - 使用 jQuery 更新输入值，旧值提交到表单

> ID：12647660
> 
> 赞同：0
> 
> 时间：2012-09-28T21:32:19.207
> 
> 标签：jquery, html, forms, input

我有一个带有 id/name 输入的表单`league_id`：

```
<form accept-charset="UTF-8" action="/user" method="post">
    <div style="margin:0;padding:0;display:inline">
        <input name="utf8" type="hidden" value="✓">
        <input name="authenticity_token" type="hidden" value="bb92urX83ivxOZZJzWLJMcr5ZSuamowO9O9Sxh5gqKo=">
    </div>
    <input id="league_id" name="league_id" type="text" value="11">
    <select class="sport_selector" id="sport_type_id" name="sport_type_id">
        <option value="5" selected="selected">Football</option>
        <option value="25">Women's Soccer</option>
        <option value="30">Volleyball</option>
        <option value="10">Men's Soccer</option>
    </select>
    <input name="commit" type="submit" value="Save changes">
</form> 
```

在我页面的另一部分，我有一个下拉菜单，更改后会清除以下值`league_id`：

```
$("#sport_type_id").change(function(){
    $("#league_id").val(null)
    $(this).parents('form:first').submit()
}); 
```

如果我调试这个页面，我可以看到文本框中的值被擦除，但是当表单被提交时，我的控制器总是得到旧值。

**更新**

我的错。我有多个标记为`league_id`. 不知道到底发生了什么，但是当我输入错误时，我开始得到非常奇怪的结果，一旦我确保所有的 ID 都是唯一的，我就开始得到预期的结果。

对不起脸

我尝试更改输入的名称并得到相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:57:30.493

认为这是罪魁祸首

```
$("#league_id").val(null).. 
```

如果您在将 DOM设为**null**后检查 DOM，则 value 字段仍然存在，可能是 DOM 尚未刷新。

因此，当表单发布时，可能正在发送 value="11"。

您为什么不尝试完全删除该属性，然后再试一次..

```
 $('#league_id').removeAttr('value'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:34:05.757

我自己的错，元素名称冲突

# objective-c - for循环中的分配时间

> ID：12647661
> 
> 赞同：0
> 
> 时间：2012-09-28T21:32:22.043
> 
> 标签：objective-c, ios, for-loop, allocation

我有一个运行良好的 for 循环。我在一个新的 UIVIew 子类分配中添加，在每个循环迭代中完成：

```
 for (n=something; n>0; n--)
{
   //(...)

    MyView* theview=[[myView alloc]initWithFrame:self.frame];
    float y=sin(DEGREES_TO_RADIANS(currentAngle));
    float x=cos(DEGREES_TO_RADIANS(currentAngle));

    theview.point1=CGPointMake(x, y);  
  // printf x & y here

    [self addSubview:theview];
} 
```

其实是分配了view，但是loop里面定义的point和我在view里面看的时候point1是不一样的。

**事实上，view 的所有迭代似乎都在循环结束后分配**，正如 view drawrect 方法中的 printf 所述，该方法在调用循环的所有迭代中的所有 printf 后调用。如果不清楚，我会看到类似的内容：

x=1 Y=1 x=2 y=2 x=3 y=3 printf 从视图 printf 从视图 printf 从视图

. 为什么？提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T21:37:20.060

视图被立即分配和初始化。它们也会立即添加到视图层次结构中。然而，在下一次渲染视图层次结构之前，它们不会被要求渲染自己。由于此刷新是在主线程上完成的，在您完成分配视图之前您会阻塞，您的视图的 -drawRect: 方法将永远不会在您至少从该方法返回之前被调用（可能还有其他方法取决于在当前事件链和当前堆栈上）。

# java - SwingWorker，再次，但新

> ID：12647666
> 
> 赞同：-3
> 
> 时间：2012-09-28T21:32:44.133
> 
> 标签：java, swing, swingworker

所以，我想出了 SwingWorker 的事情。

然而，另一个问题出现了（去图）......

Swing worker 实际管理错误报告和电子邮件发送，而电子邮件是一项冗长（超过 0.5 秒）的任务，它派上用场......

为了防止我的程序在处理错误之前继续执行，我必须暂停 EDT 线程（使用同步的东西）。但是，这也会暂停未确定的 JProgressBar 具有的很酷的小动画，并且在发送消息时正在使用它，因此，当 EDT 暂停时。

我的问题是，有没有办法阻止我的程序继续执行，同时在 JProgressBar 上显示动画？

这是一些伪代码：

发生主类错误 - 用同步暂停线程并执行（创建）另一个执行 SwingWorker 的类（另一个类是必要的，确实如此，如果不是，我不会有这么多麻烦）。

```
new ErrorDialog(Main.modal, lang.getString("errorConfigMissingTitle"), lang.getString("errorConfigMissingMessage"), e, false); 
```

它调用这个：

```
 //bunch of code, this below is an action listener of one of the buttons

            String s = "";

            (new ErrorSender(parent, error, s, dialog)).execute();

            synchronized (s)
            {
                try
                {
                    s.wait();
                }

                catch (InterruptedException e1)
                {
                    e1.printStackTrace();
                }
            }

            dialog.dispose();

            //create JDialog that tell user message was sent 
```

SwingWorker 类创建sendingErrorReport JDialog（带有JProgressBar）并在后台发送消息，当消息发送时，删除暂停（notyfyAll()）。

```
public class ErrorSender extends SwingWorker<Boolean, Void>
{
    Exception e;
    String s;

    public ErrorSender(JFrame parent, Exception error, String k, JDialog sendingDialog)
    {
        e = error;
        s = k;

        sendingDialog = new JDialog(parent, "Sending...", false);

        JProgressBar progress = new JProgressBar();
        progress.setString("Sending report...");
        progress.setStringPainted(true);
        progress.setIndeterminate(true);

        sendingDialog.getContentPane().add(progress);   
        sendingDialog.pack();
        sendingDialog.setLocationRelativeTo(null);
        sendingDialog.getContentPane().validate();
        sendingDialog.setResizable(false);
        sendingDialog.setVisible(true);
    }

    @Override
    protected Boolean doInBackground() throws Exception
    {

    //send email here

        synchronized (s)
        {
            s.notifyAll();
        }

        return null;
    }
} 
```

我没有从 done() 方法中删除暂停，因为如果没有删除暂停，则永远不会到达/调用 done()...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T21:38:08.243

在后台线程运行时暂停 EDT 然后恢复它是完全相同的，但是以一种更复杂的方式，就像在 EDT 中执行冗长的阻塞操作一样。这没有道理。

如果您想阻止用户在后台任务运行时使用该程序，只需显示一个模式对话框，并在后台任务完成后关闭它（或允许关闭它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:40:36.127

看看，请测试

1.  [预订示例 SwingWorker 和 JProgressBar](https://stackoverflow.com/a/10774277/714968)

2.  [执行者和 SwingWorker](https://stackoverflow.com/a/6824207/714968)

3.  [如何获得异常](https://stackoverflow.com/questions/7053865/cant-get-arrayindexoutofboundsexception-from-future-and-swingworker-if-threa)

# vim - 如何以交互方式用第二个列表的元素替换一个值列表的元素？

> ID：12647675
> 
> 赞同：1
> 
> 时间：2012-09-28T21:33:23.023
> 
> 标签：vim

写作时，有时我必须连续替换几个不同的单词，比如 a1 -> a2、b1->b2、c1->c2 等等。

为此，我手动编辑命令历史记录，因此我从

```
:s/a1/a2/gc 
```

用 b1 和 b2 替换 a1 和 a2 后，进行替换并继续下一项。

我想要的工作流程是这样的：

```
:let in = ['a1', 'b1', 'c1']
:let out = ['a2', 'b2', 'c2']
:call ReplaceAllWithConfirmation(in, out) 
```

其中 ReplaceAllWithConfirmation 将是一个执行替换但每次都要求我确认的函数。

这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T00:08:27.107

您不需要编写函数。只需运行以下命令：

```
:%s/[a-c]1/\={'a1':'a2','b1':'b2','c1':'c2'}[submatch(0)]/gc 
```

后面可以有表达式`\=`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T10:24:40.767

使用 Tim Pope 的[Abolish plugin](http://www.vim.org/scripts/script.php?script_id=1545)，您的示例将是

```
%Subvert/{a,b,c}1/{}2/g 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T17:38:15.953

在我提出问题后，我想出了这个功能和映射，几乎可以满足我的需求。这不像其他两个答案那样优雅，但它可以适应执行一系列由在每个命令之间暂停的列表指定的一般命令，所以我在这里写。

```
function! MyLatexReplaceText(...)
  if a:0 > 0
    if a:0 != 2
      echom "provide two lists to the function"
      return ''
    endif
    let g:replace_list_in = a:1
    let g:replace_list_out = a:2
    let g:replace_ncur = 0
  endif
  if a:0 == 0 && !exists("g:replace_ncur")
    let g:replace_list_in = ['a1', 'b1', 'c1']
    let g:replace_list_out = ['a2', 'b2', 'c2']
    let g:replace_ncur = 0
  endif
  if g:replace_ncur == len(g:replace_list_in)
    let g:replace_cmd = ":echom 'reached end of list'\<CR>"
    let g:replace_ncur = -1
  else
    let range_ = "'<,'>"
    let extra_flags = 'gc'
    let g:replace_cmd = ':' .range_ . "s/" .  g:replace_list_in[g:replace_ncur] 
          \ . "/" . g:replace_list_out[g:replace_ncur] . "/" . extra_flags
          \ . "\<CR>"
    call histadd("cmd", g:replace_cmd)
  endif
  let g:replace_ncur += 1
  return g:replace_cmd
endfunction
nnoremap <silent><expr> <Leader>ns MyLatexReplaceText() 
```

# javascript - Javascript，jQuery - 如何对刚刚创建的对象进行签名操作？

> ID：12647676
> 
> 赞同：0
> 
> 时间：2012-09-28T21:33:23.817
> 
> 标签：javascript, jquery

我正在尝试制作能够添加和删除元素的简单列表。现在我正在对每个列表元素对象（现有的和添加的）添加和执行一个简单的操作。不幸的是，我遇到了一些困难。我可以修改一开始创建的对象，但不能修改在“网页工作”期间添加的对象。

首先，我的想法是为此添加 AJAX，但我认为这不是最简单的方法。

我想前段时间（我不记得在哪里）我读过如何使这项工作，但现在我不知道。如果有人能帮我解决这个问题，或者至少给出一个很好的解释的链接，我会很高兴。

到目前为止我已经做了什么（这主要只是一个划痕，但主要思想在其中）：http: [//jsfiddle.net/sebap123/pAZ7H/0](http://jsfiddle.net/sebap123/pAZ7H/0)

```
$("li").click(function() {
    $(this).text("new text");
});
$("#addButton").click(function() {
    $(".list").append(
    $('<li>').append($('<span>').append("added li")));
});​ 
```

感谢您的所有回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:36:08.900

您只需要使用事件委托，`on()`方法是：

```
$("ul").on('click','li', function() {
    $(this).text("OK");
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/pAZ7H/4/)。

您遇到的问题是 jQuery 只能将事件直接绑定到已经存在的元素（存在于事件绑定点）；该`on()`方法将操作绑定到添加新内容的元素（或新添加元素的祖先元素），标识要侦听的事件`'click'`（以空格分隔的事件列表），匹配选择器 ( `li`)然后该函数执行所需的操作。

如果您使用的是 jQuery 1.7（或更高版本）`on()`，则应使用 jQuery < 1.7 的版本`delegate()`（它或多或少做同样的事情，但反转事件列表和选择器参数）：

```
$("ul").delegate('li', 'click', function() {
    $(this).text("OK");
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/pAZ7H/6/)。

参考：

*   [`delegate()`](http://api.jquery.com/delegate/).
*   [`on()`](http://api.jquery.com/on/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:41:41.460

需要在这里使用事件委托..试试这个

```
$("ul").on('click' , 'li', function() {
    $(this).text("OK");
}); 
```

上一个点击事件的问题是事件只附加到页面上的当前元素..

但是当您创建一个新元素时，该元素不会附加任何事件。

您在这里有两个选择。要么委托您的活动，即；将事件侦听器添加到元素的祖先 ..

或者在创建元素后添加事件..

第二种方法

```
var clickEvent = function() {
    $('li').unbind().on('click', function() {
        $(this).text("OK");
    });
}

clickEvent();

$("#addButton").click(function() {
    $(".list").append(
    $('<li>').append($('<span>').append("Press me - I am new!")));
    clickEvent();
});​ 
```

在第二种方法中，一旦添加了新元素，您将绑定解除绑定并将新事件绑定到所有元素。

绑定并再次重新绑定事件是一种糟糕的设计模式

[小提琴](http://jsfiddle.net/sushanth009/pAZ7H/7/)

[第二种方法](http://jsfiddle.net/sushanth009/pAZ7H/10/)

# log4j - Log4j 和 Websphere 7 应用服务器

> ID：12647680
> 
> 赞同：0
> 
> 时间：2012-09-28T21:34:21.623
> 
> 标签：log4j, websphere

我收到以下错误，并且未创建日志文件。我知道 log4j.properties 没有被正确选择

```
log4j:WARN No appenders could be found for logger 
```

1.  log4j jar 在 lib 和 classpath 中
2.  log4j.properties 位于 src 文件夹中，并在构建时加载到 classes 文件夹

我尝试了很多方法来修复这个错误，比如使用 log4j 实现类添加服务文件夹来修复 WAS 日志记录冲突也尝试了 sfl4j

有没有人找到解决 WAS7 或更高版本的 log4j 问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T09:23:51.193

`log4j.debug=true`您可以通过指定系统变量对 Log4J 本身进行故障排除。然后，您将确切地知道 Log4J 在内部发生了什么。

您的`log4j.properties`文件是否包含任何记录器定义？也许你可以在这里粘贴文件？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:32:28.557

我遇到了同样的问题（WAS 忽略了我的`META-INF/services/org.apache.commons.logging.LogFactory`文件）。

当我将 commons-logging 降级到 1.0.3 以匹配 WAS 版本时，问题得到了解决。查看[这篇文章](http://majikshoe.blogspot.com.br/2009/01/joys-of-websphere-61-and-commons.html)了解更多信息。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-06T10:27:40.250

考虑改用 Java Logging 框架，它内置在标准 Java 运行时环境中，不需要额外的安装或配置。相关的类在 java.util.logging 包中，这里有使用它们的过程的概述[（](http://docs.oracle.com/javase/1.4.2/docs/guide/util/logging/overview.html)它的工作方式与 log4j 非常相似）。

# jquery - 使用ajax多次弹出确认框

> ID：12647685
> 
> 赞同：0
> 
> 时间：2012-09-28T21:35:02.760
> 
> 标签：jquery, ajax

我正在使用 Ajax 删除记录并在删除此记录时显示动画消息（函数 display_message），但我注意到根据记录数弹出确认框。例如，如果我的列表中有 2 条记录，并且我想删除其中的一条。在删除之前确认框会弹出两次，并且消息会发生同样的事情，它会出现两次（我正在使用淡入和out），等等（3条记录-> 3条弹出，等等）。我尝试了很多来解决它，但我没有成功。这是我删除记录的功能：

```
$(function() {
$(".delete_class").click(function() {
var id = $(this).attr("id");
var dataString = 'id='+ id ;
var parent = $(this).parent().parent();
if(confirm("are you sure?")) {
$.ajax({
type: "POST",
url: "delete.php",
data: dataString,
cache: false,
success: function()
    {
   parent.hide();
    }
 });
}
display_message("user deleted!")
}); 
}); 
```

请帮忙。

编辑：这是 display_message 函数：

```
function display_message(msg) {
  $(".success").html(msg).effect("drop", { mode: "show", direction: "up" }, function( {
     window.timer = function() {
       $(".success").effect("drop", { mode: "hide", direction: "up"});
     }
window.setTimeout("window.timer()", 3000);
  }
 ) 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:26:24.743

```
function display_message(msg) {
    $(".success").stop().html(msg).effect("drop", { mode: "show", direction: "up" }, function({
        window.timer = function() {
            $(".success").effect("drop", { mode: "hide", direction: "up"});
    } window.setTimeout("window.timer()", 3000);
}); 
```

我认为您可以调用`stop()`以仅触发最后一个动画作为解决方法...

# java - 我的 DAO（数据库实体）是否应该直接匹配我的 UI 对象？

> ID：12647686
> 
> 赞同：0
> 
> 时间：2012-09-28T21:35:06.943
> 
> 标签：java, design-patterns, jakarta-ee

我正在尝试找出 N 层应用程序设计的最佳实践。在设计我的 UI 需要的对象以及那些将保留在数据库中的对象时，我的一些同事建议这些对象是同一个对象。这对我来说感觉不对，我最终正在寻找一些最佳实践文档来帮助我做出这个决定。

**编辑：** 让我通过说数据库中的表（实体类）与 UI 中使用的对象相同来澄清这一点

老实说，鉴于其他应用程序可能想要与我的数据访问层交互，我真的不明白为什么要这样设计……或者这只是我的无知或缺乏理解。

您可以提供的任何文档和信息将不胜感激。只是想更好地理解这些概念，我很难找到一些关于实现这些模式的最佳实践的好信息（或者它就在我面前，我发现了什么，我不明白所概述的内容） .

谢谢，

小号

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:45:22.790

首先，DAO 和数据库实体是两个非常不同的东西。

现在的问题。你是对的。数据库实体映射到数据库模式，并且该数据库模式应遵循数据库设计最佳实践，并进行规范化。UI 有时会准确显示来自给定实体的信息，但通常会以聚合格式显示来自多个实体的数据。或者，相反，它们只显示给定实体的一小部分。

例如，用户界面显示产品名称、描述和价格以及其类别名称、库存剩余商品数量以及产品制造商是有意义的。拥有一个包含所有这些字段的持久实体是没有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:51:48.693

一般来说，根据大多数“最佳实践”评论，是的，这两层应该解耦并且应该有单独的对象。

但是：如果您的映射只是一对一的映射，在非数据库对象中没有任何进一步的功能，为什么要引入一个额外的对象？所以，这取决于。（照常 ;-） ）。

如果引入的开销大于增益，则不要使用额外的对象。如果可重用性是首要目标，则不要将这两层结合起来。某些遗留应用程序可能并非如此，例如

# android - 立方体在显示器中不可见

> ID：12647687
> 
> 赞同：0
> 
> 时间：2012-09-28T21:35:09.783
> 
> 标签：android, opengl-es

我试图在我的显示器上显示一个正方形，但我做不到。我的问题是什么？我怎样才能在屏幕上显示它（屏幕中央）？

这是我的渲染类：

```
public class GLRenderEx implements Renderer {

    private GLCube cube;
    Context c;

    GLCube quad; // ( NEW )

    // Constructor
    public GLRenderEx(Context context) {
        // Set up the data-array buffers for these shapes ( NEW )
        quad = new GLCube(); // ( NEW )
    }

    // Call back when the surface is first created or re-created.
    @Override
       public void onSurfaceCreated(GL10 gl, EGLConfig config) {
          // NO CHANGE - SKIP
       }

    // Call back after onSurfaceCreated() or whenever the window's size changes.
    @Override
       public void onSurfaceChanged(GL10 gl, int width, int height) {
          // NO CHANGE - SKIP
       }

    // Call back to draw the current frame.
    @Override
    public void onDrawFrame(GL10 gl) {
        // Clear color and depth buffers using clear-values set earlier
        gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);

        gl.glLoadIdentity(); // Reset model-view matrix ( NEW )
        gl.glTranslatef(-1.5f, 0.0f, -6.0f); // Translate left and into the
                                                // screen ( NEW )

        // Translate right, relative to the previous translation ( NEW )
        gl.glTranslatef(3.0f, 0.0f, 0.0f);
        quad.draw(gl); // Draw quad ( NEW )
    }
} 
```

这是我的方形课：

```
public class GLCube {

    private FloatBuffer vertexBuffer; // Buffer for vertex-array

    private float[] vertices = { // Vertices for the square
    -1.0f, -1.0f, 0.0f, // 0\. left-bottom
            1.0f, -1.0f, 0.0f, // 1\. right-bottom
            -1.0f, 1.0f, 0.0f, // 2\. left-top
            1.0f, 1.0f, 0.0f // 3\. right-top
    };

    // Constructor - Setup the vertex buffer
    public GLCube() {
        // Setup vertex array buffer. Vertices in float. A float has 4 bytes
        ByteBuffer vbb = ByteBuffer.allocateDirect(vertices.length * 4);
        vbb.order(ByteOrder.nativeOrder()); // Use native byte order
        vertexBuffer = vbb.asFloatBuffer(); // Convert from byte to float
        vertexBuffer.put(vertices); // Copy data into buffer
        vertexBuffer.position(0); // Rewind
    }

    // Render the shape
    public void draw(GL10 gl) {
        // Enable vertex-array and define its buffer
        gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, vertexBuffer);
        // Draw the primitives from the vertex-array directly
        gl.glDrawArrays(GL10.GL_TRIANGLE_STRIP, 0, vertices.length / 3);
        gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:39:39.020

我没有看到任何投影矩阵，所以我必须假设您使用单位投影矩阵。在这种情况下，唯一呈现的东西将在所有轴上的 -1 和 1 之间。

以 (1.5, 0, -6) 为中心的四边形将在 z 轴上太远而无法看到。

尝试删除两个翻译调用，看看它是否可见。

# c# - 使用 C# 进行尾递归和记忆

> ID：12647691
> 
> 赞同：0
> 
> 时间：2012-09-28T21:35:26.460
> 
> 标签：c#, .net, tail-recursion, memoization

我正在编写一个函数，该函数根据数据库条目表查找目录的完整路径。每条记录都包含一个键、目录的名称和父目录的键（如果您熟悉，它就是 MSI 中的目录表）。我有一个迭代解决方案，但它开始看起来有点讨厌。我以为我可以编写一个优雅的尾递归解决方案，但我不确定了。

我将向您展示我的代码，然后解释我面临的问题。

```
Dictionary<string, string> m_directoryKeyToFullPathDictionary = new Dictionary<string, string>();
...
private string ExpandDirectoryKey(Database database, string directoryKey)
{
    // check for terminating condition
    string fullPath;
    if (m_directoryKeyToFullPathDictionary.TryGetValue(directoryKey, out fullPath))
    {
        return fullPath;
    }

    // inductive step
    Record record = ExecuteQuery(database, "SELECT DefaultDir, Directory_Parent FROM Directory where Directory.Directory='{0}'", directoryKey);
    // null check
    string directoryName = record.GetString("DefaultDir");
    string parentDirectoryKey = record.GetString("Directory_Parent");

    return Path.Combine(ExpandDirectoryKey(database, parentDirectoryKey), directoryName);
} 
```

这就是当我意识到我有问题时代码的样子（删除了一些小的验证/按摩）。我想尽可能使用记忆来短路，但这需要我对字典进行函数调用以存储递归`ExpandDirectoryKey`调用的输出。我意识到我在`Path.Combine`那里也有一个电话，但我认为可以用`... + Path.DirectorySeparatorChar + ...`.

我考虑过使用一个帮助方法来记忆目录并返回值，以便我可以在上面的函数末尾这样调用它：

```
return MemoizeHelper(
    m_directoryKeyToFullPathDictionary,
    Path.Combine(ExpandDirectoryKey(database, parentDirectoryKey)),
    directoryName); 
```

但我觉得这是作弊，不会被优化为尾递归。

有任何想法吗？我应该使用完全不同的策略吗？这根本不需要是一个超级高效的算法，我只是很好奇。我正在使用.NET 4.0，顺便说一句。

谢谢！

PS如果你想知道我的终止条件，别担心。我用根目录预播字典。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T17:18:20.650

你说你很好奇，我也是，让我们看看你对这种方法的看法。我正在概括您的问题以解释我的观点。假设您有这样的`Record`类型：

```
class Record
{
    public int Id { get; private set; }
    public int ParentId { get; private set; }
    public string Name { get; private set; }

    public Record(int id, int parentId, string name)
    {
        Id = id;
        ParentId = parentId;
        Name = name;
    }
} 
```

和一个由这个函数表示的“数据库”：

```
static Func<int, Record> Database()
{
    var database = new Dictionary<int, Record>()
     {
         { 1, new Record(1, 0, "a") },
         { 2, new Record(2, 1, "b") },
         { 3, new Record(3, 2, "c") },
         { 4, new Record(4, 3, "d") },
         { 5, new Record(5, 4, "e") },
     };
     return x => database[x];
 } 
```

让我们介绍一种“表示”递归的方法，如下所示：

```
public static class Recursor
{
    public static IEnumerable<T> Do<T>(
        T seed, 
        Func<T, T> next, 
        Func<T, bool> exit)
    {
        return Do(seed, next, exit, x => x);
    }

    public static IEnumerable<TR> Do<T, TR>(
        T seed, 
        Func<T, T> next, 
        Func<T, bool> exit, 
        Func<T, TR> resultor)
    {
        var r = seed;
        while (true)
        {
            if (exit(r))
                yield break;
            yield return resultor(r);
            r = next(r);
        }
    }
} 
```

如您所见，这根本不是递归，而是允许我们根据“看起来”递归的部分来表达算法。我们的路径生成函数如下所示：

```
static Func<int, string> PathGenerator(Func<int, Record> database)
{
    var finder = database;

    return id => string.Join("/",
        Recursor.Do(id,                       //seed
                    x => finder(x).ParentId,  //how do I find the next item?
                    x => x == 0,              //when do I stop?
                    x => finder(x).Name)      //what do I extract from next item?
                .Reverse());                  //reversing items
} 
```

该函数使用`Recursor`来表示算法，并收集所有产生的部分来组成路径。这个想法是`Recursor`不累积，它将累积的责任委托给调用者。我们将像这样使用它：

```
var f = PathGenerator(Database());
Console.WriteLine(f(3));           //output: a/b/c 
```

您还想要记忆，让我们介绍一下：

```
public static class Memoizer
{
    public static Func<T, TR> Do<T, TR>(Func<T, TR> gen)
    {
        var mem = new Dictionary<T, TR>();
        return (target) =>
        {
            if (mem.ContainsKey(target))
                return mem[target];
            mem.Add(target, gen(target));
            return mem[target];
        };
    }
} 
```

有了这个，您可以记住您对昂贵资源（数据库）的所有访问，只需更改其中的一行`PathGenerator`，如下所示：

```
var finder = database; 
```

对此：

```
var finder = Memoizer.Do<int, Record>(x => database(x)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T21:44:56.083

即使您确实获得了正确的代码布局，您也会遇到的第一个主要问题是 C# 编译器并不能很好地支持尾递归。[C#中的尾递归](http://www.thomaslevesque.com/2011/09/02/tail-recursion-in-c/)

使用那里的信息，您可能可以使其工作。但这充其量是不雅的。

# codeigniter - Codeigniter - 在方法调用时更改 url

> ID：12647692
> 
> 赞同：0
> 
> 时间：2012-09-28T21:35:33.263
> 
> 标签：codeigniter, url, post, edit

我想知道是否可以在codeigniter中完成以下操作。

假设我有一个名为 Post.php 的文件，用于在管理界面中管理帖子。它有几个方法，例如索引（列出所有帖子），添加，更新，删除......现在，我访问add方法，这样url就变成了

/帖子/添加

我添加了一些数据。我单击“保存”以添加新帖子。它使用 if 语句调用相同的方法，例如“如果“this->input->post('addnew')”被传递，调用模型，将其添加到数据库中

问题如下：如果一切正常，它会转到包含所有帖子列表的索引，并显示确认

但

不，网址仍然是帖子/添加，因为我在验证数据添加后调用了 $this->index() 之类的函数。我无法将其重定向到“posts/”，因为在这种情况下不会显示确认消息！

所以我的问题是：我可以从同一个类中的另一个方法调用一个方法，并将 url 设置为该方法（/posts/index 而不是/posts/add）吗？

这有点令人困惑，但我希望我给了你足够的信息来发现问题

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:58:04.880

`redirect()`与 CodeIgniter 的[Flash Data](http://codeigniter.com/user_guide/libraries/sessions.html)结合使用，或选择 AJAX。

# regex - 正则表达式提取连接到最近分号的单词？

> ID：12647693
> 
> 赞同：0
> 
> 时间：2012-09-28T21:35:42.130
> 
> 标签：regex

我正在尝试从文本文件中提取一系列数据值。

值采用以下格式：`<MODIFIER NAME1 VALUE; MODIFIER NAME2 VALUE;>`

出于我当前任务的目的，我只关心提取位于每个分号旁边的 VALUE。REGEX 命令看起来像什么会隔离这些 VALUES 中的每一个（最好是这样我在处理的替换部分中反向引用所有值。）我相信 ^(.*?); 以某种方式使用，但我没有看到如何仅隔离组中附加到分号的单词以供反向引用使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:39:21.370

确切的语法取决于语言，但下面的正则表达式应该这样做

```
"(\w+);" 
```

我使用了 c# 语法。在其他语言中，语法可能会有所改变，但实际的正则表达式保持不变。

where`\w`表示任何字母（它还包括 0-9 和 '_），括号表示您捕获了里面的组。

如果你只想要字母，你可以改变`\w`to `[a-zA-Z]`（同样，不同的语言可能有也可能没有不同的语法）

我使用[This reference](http://www.regular-expressions.info/reference.html)来引用我的 c# regex 语法。如果您使用的是另一种语言，那么在某处也会有类似的东西。

# bash - 在匹配模式的行上使用 sed 中的变量

> ID：12647695
> 
> 赞同：1
> 
> 时间：2012-09-28T21:35:52.933
> 
> 标签：bash, shell, sed

我正在尝试执行以下命令并且 sed 不喜欢它。我确信修复很简单，但我还没有找到任何解决方案。

在不以 http 开头的行上，我试图将 $currentlink 的内容放在行首。Sed 抛出错误。任何帮助将不胜感激 - 谢谢！

```
sed '/^http/!s/^/$currentlink\//g' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:46:07.103

单引号不插入 shell 变量。有几种选择，其中之一是使用双引号。

```
sed -e "/^http/!s/^/$currentlink/" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:37:47.780

请试试这个：

> sed '/^http/!s@^@'"$(echo ${currentlink}|sed 's/@/\\@/g')/"'@'

# php - MySQL：从“父母”更新“孩子”的值

> ID：12647702
> 
> 赞同：0
> 
> 时间：2012-09-28T21:36:38.410
> 
> 标签：php, mysql

我有一个包含“父母”和“孩子”行的数据库。类似的条目，但一个条目是更具体的子项的通用版本。但是，我希望这些条目在某些列中完全匹配。

这是我的数据库的示例：

```
| ID |  IsChildOfID |   Food    |   Type        |
| 1  |              |           |   Fruit       |
| 2  |      1       |   Apple   |   Fruit       |
| 3  |      1       |   Pear    |   Vegetable   |
| 4  |      1       |   Banana  |   Vegetable   |
| 5  |              |           |   Vegetable   |
| 6  |      5       |   Lettuce |   Fruit       |
| 7  |      5       |   Celery  |   Vegetable   |
| 8  |      5       |   Cabbage |   Fruit       | 
```

在此示例中，有 2 个父母和 6 个孩子。“类型”字段的值对于某些孩子来说是不稳定的。我希望能够在数据库中找到任何子项，并**仅在某些列中将**其替换为父项的值。纯MySQL可以做到这一点，还是我需要用php做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:39:52.653

一般来说，当你在sql中使用父子关系时，你应该为每个创建两个单独的数据库表。在您的情况下，您应该创建一个名为“类型”的数据库，并`type_id`为子表中的每个元素包含一个。

*例子*

**子表：**

```
| ID |    TYPE_ID   |   Food    |
| 2  |      1       |   Apple   | 
| 3  |      2       |   Pear    |  
| 4  |      2       |   Banana  |   
| 6  |      1       |   Lettuce |  
| 7  |      2       |   Celery  | 
| 8  |      1       |   Cabbage | 
```

**类型表：**

```
| ID |        Type          |
| 1  |        Fruit         |
| 2  |       Vegetable      | 
```

然后，您可以通过遍历类型表并使用类似的 sql 语句来引用它

```
$types = mysql_query ( 'SELECT * FROM type_table');

WHILE ( $type = mysql_fetch_array ( $types ) )
{
 $sql = 'SELECT * FROM  child_table WHERE TYPE_ID = "' . $type['type'] . '"';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:43:32.557

```
UPDATE name_of_table SET Type = "Fruit" WHERE IsChildOfID = 1 
```

和

```
UPDATE name_of_table SET Type = "Vegetable" WHERE IsChildOfID = 5 
```

*   但如果你想动态地做，请使用 php 或其他语言......

此外，我更愿意为此类数据使用 2 个表...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:00:11.060

类似的答案在这里： [UPDATE multiple tables in MySQL using LEFT JOIN](https://stackoverflow.com/questions/806882/update-multiple-tables-in-mysql-using-left-join)

我打算写这个：

```
UPDATE foods c
  JOIN foods p ON p.id = c.IsChildOfId 
   SET c.type = p.type
 WHERE p.isChildOfId IS NULL 
```

但是在进一步阅读上面的链接后，不确定您是否可以引用目标表。值得一试。

# iphone - 如何支持多个 iOS 版本？

> ID：12647713
> 
> 赞同：3
> 
> 时间：2012-09-28T21:37:55.667
> 
> 标签：iphone, ios

所以现在有很多版本的 iOS 在设备上运行，我有一些关于支持不同类型的问题。

如果我要发布一个应用程序，想要使用 iOS 6 中的某些功能，但又不想失去 iOS 5 用户，是否可以在 App Store 上提供的同一个应用程序中同时定位两个版本？

这里的其他选择是什么？要跳过 iOS 6 功能而只针对 iOS 5？在这种情况下，应用程序是否会完全支持 iOS 6？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T22:08:42.840

iOS 用户的升级速度比其他任何群体都快。除非您有特殊的用户群，否则我不建议您花费大量时间来支持超过 6 个月的 iOS 版本。对于许多类型的应用程序，即使这样也太长了。[当 iOS 5 发布时，Matt Gemmell 对此进行了精彩的讨论。](http://mattgemmell.com/2011/12/05/latest-version/)

在过渡期间，在切换到最新版本之前，我的建议是针对旧 SDK 进行构建。不要只设置“部署目标”。设置“基础 SDK”。这意味着您需要保留旧的 SDK 并将它们链接到您的 Xcode 副本，因为 Apple 将继续删除它们。Google 四处寻找如何针对旧 SDK 进行构建。有很多讨论。我敢肯定SO上有很多东西。我强烈推荐这个有几个原因（无论您等待升级多长时间）：

*   您实际上可以在最新版本中提供旧版本中没有的功能，这有点罕见。大多数情况下，您最终不得不以某种形式在旧版本中提供它。这意味着您现在有两个版本的代码在做基本相同的事情。大多数时候，旧方法更难，但仍然有效。一旦你编写了 hard 方法，那么*还要*编写 easy 方法，然后编写额外的代码来在它们之间进行选择有什么意义呢？

*   交换功能所需的测试非常高。一开始就很难测试功能。现在测试它*并*测试没有该功能。

*   当您使用“开发目标”时，编译器不会给您任何帮助。如果您从 iOS 6 调用一个方法而不检查它是否存在，那么您将不会收到任何警告。你只会在 iOS 5 上崩溃。如果你使用 Base SDK，那么编译器会在它不可用时告诉你。我在 WWDC 上与 Xcode 团队讨论过这个问题。他们指出，Apple 建议使用 Deployment Target，但承认在实践中使用它非常脆弱。

所以基本上，我说在你准备好使用 iOS 6 之前，请继续使用 iOS 5 SDK。然后再使用 iOS 6 SDK，永不回头。

# php - JS 和 PHP 脚本无法在 Chrome 或 IE8 中加载

> ID：12647724
> 
> 赞同：-2
> 
> 时间：2012-09-28T21:38:29.017
> 
> 标签：php, javascript, frontpage-extensions

JS 和 PHP 脚本在 Chrome 或 IE 下无法正常加载。我正在使用 FrontPage 2003 (SP-3) 开发家庭企业网站以支持视频游戏开发。

```
<?PHP
if(strstr($_SERVER["HTTP_USER_AGENT"],"MSIE")==false) {
header('Content-type: text/javascript');
header("Content-Disposition: inline; filename=\"register.js\"");

 } else {
      header("Content-type: text/force-download");
      header("Content-Disposition: attachment; filename=\"register.js\"");

 } else {
 <Location register.js>
      ForceType ('application/x-httpd-php')
</Location>
}

require_once("./include/membersite_config.js");

if(isset($_POST['submitted']))
{
   if($fgmembersite->RegisterUser())
   {
        $fgmembersite->RedirectToURL("thank-you.html");
   }
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:42:33.260

```
} else {
 <Location register.js>
      ForceType ('application/x-httpd-php')
</Location>
} 
```

那不是有效的 PHP ......（你会很好地听取 AlienWebguy 的建议）

# ios - 此媒体所需的编码器正忙

> ID：12647725
> 
> 赞同：3
> 
> 时间：2012-09-28T21:38:32.453
> 
> 标签：ios, avfoundation

尝试通过 AVAssetWriter 和 AVAssetWriterInput 方法将多个视频连接为一个时。在第三个视频之后，我收到来自 AVAssetWriter.error 的“无法编码”错误。

此外，我可以通过控制台看到成功读取缓冲区，但只有最后一次成功读取的视频才会在连接的 mov 中结束。任何对任何一个或两个问题的见解都值得赞赏，来源和日志如下。谢谢

```
+(void)doWriteWithVideoWriter:(AVAssetWriter *)videoWriter withIndex:(int)index withWriterInputArray:(NSMutableArray *)writersArray withInstance:(VideoCombinerManager *)theInstance{
if ([writersArray count] > 0)
{
    int newIndex = index+1;

    NSError *readerError;
    NSDictionary *videoOptions = [NSDictionary dictionaryWithObject:[NSNumber numberWithInt:kCVPixelFormatType_420YpCbCr8BiPlanarVideoRange] forKey:(id)kCVPixelBufferPixelFormatTypeKey];

    AVAsset *sourceAsset = [theInstance.loadedAssetsForCompilationDictionary objectForKey:[theInstance.sortedKeysArray objectAtIndex:index]];
    AVAssetTrack *videoTrack = [[sourceAsset tracksWithMediaType:AVMediaTypeVideo] objectAtIndex:0];
    AVAssetReaderTrackOutput *currentReaderTrackOutput = [[AVAssetReaderTrackOutput alloc] initWithTrack:videoTrack outputSettings:videoOptions];
    AVAssetReader *currentReader = [[AVAssetReader alloc] initWithAsset:sourceAsset error:&readerError];
    [currentReader addOutput:currentReaderTrackOutput];
    [currentReader startReading];

    AVAssetWriterInput *writerInput = [[writersArray objectAtIndex:0] retain];

    dispatch_queue_t _processingQueue = dispatch_queue_create("asdf", NULL);
    [writerInput requestMediaDataWhenReadyOnQueue:_processingQueue usingBlock:^{
    if ([writerInput isReadyForMoreMediaData])
    {
        CMSampleBufferRef nextSampleBuffer;

        if ([currentReader status] == AVAssetReaderStatusReading &&
        (nextSampleBuffer = [currentReaderTrackOutput copyNextSampleBuffer])) {

        if (nextSampleBuffer)
        {
            BOOL result = [writerInput appendSampleBuffer:nextSampleBuffer];
            if (!result)
            {
            NSLog(@"videoWriter.error.userInfo: %@", videoWriter.error.userInfo);
            }
            CFRelease(nextSampleBuffer);
        }
        }
        else
        {
        NSLog(@"writer done: %d", index);
        dispatch_release(_processingQueue);

        [writersArray removeObjectAtIndex:0];

        [writerInput markAsFinished];
        [writerInput release];

        [currentReader release];
        [currentReaderTrackOutput release];

        [VideoCombinerManager doWriteWithVideoWriter:videoWriter withIndex:newIndex withWriterInputArray:writersArray withInstance:theInstance];
        }
    }
    }];
}
else
    [videoWriter finishWriting];

} 
```

作家完成：0

作家完成：1

作家完成：2

```
videoWriter.error.userInfo: {
    NSLocalizedDescription = "Cannot Encode";
    NSLocalizedFailureReason = "The encoder required for this media is busy.";
    NSLocalizedRecoverySuggestion = "Stop any other actions that encode media and try again.";
    NSUnderlyingError = "Error Domain=NSOSStatusErrorDomain Code=-12915 \"The operation couldn\U2019t be completed. (OSStatus error -12915.)\"";
}

videoWriter.error.userInfo: {
    NSLocalizedDescription = "Cannot Encode";
    NSLocalizedFailureReason = "The encoder required for this media is busy.";
    NSLocalizedRecoverySuggestion = "Stop any other actions that encode media and try again.";
    NSUnderlyingError = "Error Domain=NSOSStatusErrorDomain Code=-12915 \"The operation couldn\U2019t be completed. (OSStatus error -12915.)\"";
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T10:41:26.013

至于无法编码错误，您有太多的 writer 和/或 writerInputs 同时存在。当我遇到同样的错误时，我意识到我必须释放所有以前使用的 writer 和 writerInputs 才能摆脱它。由于您确实释放了它们，因此您的问题可能是您同时拥有许多它们。

# excel - 查找范围的列数

> ID：12647733
> 
> 赞同：8
> 
> 时间：2012-09-28T21:39:20.643
> 
> 标签：excel, vba, count

下面是一些 Excel VBA 代码，它应该打印字符串中指定范围的列数。我在该`Debug.Print`部分中遇到错误。我究竟做错了什么？

```
Dim val1a As String
val1a = "A1:D1"

Dim Rng1 As Range

Debug.Print Rng1(var1a).Columns.Count  ' error here 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-28T22:03:56.127

采用

```
Range(var1a).Columns.Count 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-10T05:56:11.473

你犯的错误是，

您声明了“val1a”，但调用了“var1a”。

更正错字，您将能够得到它。

# python - Python bz2 未压缩文件大小

> ID：12647738
> 
> 赞同：2
> 
> 时间：2012-09-28T21:39:31.493
> 
> 标签：python, compression

我正在使用 Python 2.7。我有一个 .bz2 文件，我需要在不实际解压缩的情况下计算出其组件文件的未压缩文件大小。我已经找到了对 gzip 和 tar 文件执行此操作的方法。有人知道 bz2 文件的方法吗？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T22:03:51.190

正如其他答案所述，如果不解压缩数据，这是不可能的。但是，如果解压后的数据很大，可以通过分块解压并加上块的大小来实现：

```
>>> import bz2
>>> with bz2.BZ2File('data.bz2', 'r') as data:
...     size = 0
...     chunk = data.read(1024)
...     while chunk:
...         size += len(chunk)
...         chunk = data.read(1024)
... 
>>> size
11107 
```

或者（可能更快，虽然我没有对此进行分析）你可以`seek()`到文件的末尾，然后使用`tell()`它来找出它有多长：

```
>>> import bz2
>>> import os
>>> with bz2.BZ2File('data.bz2', 'r') as data:
...     data.seek(0, os.SEEK_END)
...     size = data.tell()
...
>>> size
11107L 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T21:51:37.863

我怀疑这是不可能的，因为*bz2*格式的性质和它使用的压缩技术。这是对格式和算法的很好的描述[http://en.wikipedia.org/wiki/Bzip2#File_format](http://en.wikipedia.org/wiki/Bzip2#File_format)

在解压缩之前，您永远不会知道原始数据的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:46:05.857

似乎在不实际解压缩的情况下告诉 bz2 文件的大小是不可能的。有关更多详细信息和可能的解决方案，请参阅链接： [https ://superuser.com/questions/53984/is-there-a-way-to-determine-the-decompressed-size-of-a-bz2-file](https://superuser.com/questions/53984/is-there-a-way-to-determine-the-decompressed-size-of-a-bz2-file)

# java - Java DerbyDB：如何按创建日期的升序逐一获取数据库的所有表？

> ID：12647741
> 
> 赞同：0
> 
> 时间：2012-09-28T21:39:41.683
> 
> 标签：java, database, date, derby

我有一个应用程序，我需要每三天左右创建一个新表。每个表都会有一些信息。

一个月或一段时间后，我可能决定对我最初创建的数据库的所有表运行一些统计数据，以便找出一些结果。

然而，统计数据将显示数据在几天内的变化情况。所以让我们假设在第一天我们创建了第一个名为“date_1”的表

第三天“date_3”、第六天“date_6”、第九天“date_9”和第十二天“date_12”。实际上，“date_”字符串后面的数字将是真实日期，我也可以在两天或一天后创建另一个表，不一定是三天。

现在假设在第 13 天我决定运行统计数据。找出数据库中可用表的一种方法是运行以下代码：

```
 public void printTables(){

    static Connection conn;
    String driver = "org.apache.derby.jdbc.EmbeddedDriver";
    String connectionURL = "jdbc:derby:myDB;create=true";
   try {
        conn = DriverManager.getConnection(connectionURL);
        DatabaseMetaData dbmd = conn.getMetaData();
        ResultSet resultSet = dbmd.getTables(null, null, null,
                new String[] { "TABLE" });
        int tableCount = 0;
        while (resultSet.next()) {
            System.out.println(resultSet.getString("TABLE_NAME"));
            tableCount++;
        }
       }catch (Exception e) {
        e.printStackTrace();
    }
  } 
```

现在的问题是，以下代码按字母顺序返回表格，这意味着我们将打印以下表格：

```
 date_1
 date_12
 date_3
 date_6
 date_9 
```

但是我需要它们按以下顺序

```
 date_1
 date_3
 date_6
 date_9
 date_12 
```

因此，如果我以第二个顺序获得表名，我可以简单地为每个返回的表运行适当的选择语句，进行统计并打印正确的结果。所以我的问题是，是否可以按创建日期而不是简单地按名称（字符串）按升序获取表格？

# css - 浮动：中心不起作用？

> ID：12647745
> 
> 赞同：3
> 
> 时间：2012-09-28T21:40:08.893
> 
> 标签：css, css-float, tumblr

我正在使用教程做我的第一个 Tumblr 主题，我完全是新手。

```
.metadata a {
display: inline-block;
float: center;
margin-left: 2%;
} 
```

我希望帖子居中，但唯一有效的是 float: left 和 float: right

我应该怎么办 ？请解释清楚，因为正如我所说，我是一个完全的新手，而且我不是以英语为母语的人。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T21:42:16.643

您只能向左或向右浮动，因此浮动不是这里的选项。

添加`text-align: center`到 a-tag 的父元素。这不仅会居中文本，还会居中其他内联和内联块元素，比如你的。

另一种居中元素的方法是给它们`display: block; margin 0 auto`。“自动”左右边距使元素居中。将元素居中是一种常见的技巧，但它仅适用于块元素（或带有 的元素`display: block`）。这也意味着您必须指定宽度，因为如果您不指定，块元素将消耗父宽度的 100%。

我认为在你的情况下，明确的宽度不是一个选项，所以 text-align 将是最好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T21:48:54.660

对不起，但没有`float: center;`。用于`margin: 0 auto;`居中块级元素和`text-align: center;`内联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T21:44:53.743

您可能希望使用“text-align”并将其应用于 a 标签的父级，而不是使用“float”来控制文本的方向。“文本对齐：居中；” 将适用于父级中的所有内联元素（如 a）。请参阅 [文本对齐](http://www.w3schools.com/cssref/pr_text_text-align.asp) 和 [浮动](http://www.w3schools.com/cssref/pr_class_float.asp) 文档/教程。

# c# - 如何强制 ListView 忽略单击/不突出显示单击的项目？

> ID：12647752
> 
> 赞同：7
> 
> 时间：2012-09-28T21:40:45.460
> 
> 标签：c#, winforms, listview, selection, highlighting

由于我没有根据用户可能选择的内容处理 ListView 中的项目（处理始终使用列表中的所有内容），我想禁止选择可能使用户认为他将处理限制为那一项（我已经得到了 multiselect = false，所以这不是问题）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-28T21:47:15.980

中没有任何属性可以禁用项目选择`ListView`。

`ItemSelectionChanged`您可以做的是通过将事件处理程序附加到然后取消选择该项目来处理通知已选择项目的事件：

```
yourListView.ItemSelectionChanged += yourListView_ItemSelectionChanged;

private void yourListView_ItemSelectionChanged(
    object sender,
    ListViewItemSelectionChangedEventArgs e)
{
   if (e.IsSelected)
      e.Item.Selected = false;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-02-29T13:50:58.133

为了添加到*Adriano Repettis*的独奏中，我有类似的东西，我将我想要阻止的项目变灰，他的解决方案阻止了蓝色突出显示，但项目仍然有焦点，当项目的背景色设置为白色以外的任何东西时，这会导致问题，因为有些所选行的 变为白色。为了解决这个问题，我建议添加以下行：

```
e.Item.Focused = false; 
```

最终代码：

```
yourListView.ItemSelectionChanged += yourListView_ItemSelectionChanged;

private void yourListView_ItemSelectionChanged(
    object sender,
    ListViewItemSelectionChangedEventArgs e)
{
    if (e.Item.BackColor == Color.LightGray)
    {
        e.Item.Selected = false;
        e.Item.Focused = false;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-07-11T18:20:39.320

该解决方案可能会导致闪烁。您可能想要捕获 mousedown 和 mouseup 事件。在 mousedown 中，您可以通过将 WM_SETREDRAW 消息发送到具有 0 wParam 的列表视图或通过调用 LockWindowUpdate 传递列表视图的窗口句柄来禁用列表视图的重绘。前任

```
SendMessage(listview.Handle, WM_SETREDRAW, 0, 0); 
```

或者

```
LockWindowUpdate(listview.Handle); 
```

在 mouseup 中，您将通过以下任一方法启用重绘。

```
SendMessage(listview.Handle, WM_SETREDRAW, 1, 0); 
```

或者

```
LockWindowUpdate(IntPtr.Zero); 
```

...而且，您不必立即使列表视图无效。必要时它会自己做。

请注意，您必须在此方法中执行 dllimports。

你觉得这太过分了吗？

这是另一个：

扩展 ListView 类，重写 WndProc，等待 WM_NOTIFY 反映到控件，检查 m.LParam 的前四个字节是否为 -100，如果为则设置 m.Result = (IntPtr)1 和 don '不将消息传递给 base.WndProc。

-100 是 LVN_ITEMCHANGING。通过 m.Result 返回 1 或 0 将不允许或允许更改发生。m.LParam 的前四个字节是通知代码，接下来的四个字节是发送消息的控件的标识，第三个字节是发送消息的控件的窗口句柄。有关详细信息，请参阅 NMHDR 和 NMLISTVIEW 结构。谷歌是你的朋友。

不过，迟到的答案。你可能会认为写这么久我花了好几年才完成。

# data-structures - 3-D数据结构显示设计：

> ID：12647754
> 
> 赞同：2
> 
> 时间：2012-09-28T21:40:50.277
> 
> 标签：data-structures, language-agnostic, 3d

我没有 3-D 数据结构显示的解决方案，希望得到一些建议。

每个`n`节点都有`k`孩子。孩子通过`k`球体电子电荷算法分布在节点的边界球上。虽然在技术上并不准确，但最简单的说法是，孩子在节点的边界范围内“均匀分布”。

目前，我用球体表示节点。然而对于 large `n`，由于绘制球体的复杂性，动态显示的计算效率很低。

对于 和 的所有选择，解决方案必须具有可理解且视觉上规则的表示`n`，`k_i`视觉上规则的意思是，如果一条线垂直于两个节点的两个面，则所有线都垂直于某个选择的两个面的某个选择两个节点，等等。

我在这里有几个选择：

1.  使用使用较少面来表示球体的球体绘制算法。

    *   这看起来很难看，从“球体”延伸的线不会齐平地退出图形（从“球体”A到“球体”B的线不能保证垂直于A或B的入口面，更不用说两个都。）
2.  使用凸正多面体代替球体，这样多面体的面数等于子面数。这将允许绘制垂直于多面体 A 和多面体 B 的线。

    *   这在数学上是不可能的，因为只有 5 个这样的图形具有不变的多面，但这种结构要求有足够的面来映射`k`点。如果我们尝试映射到顶点，该论点同样成立。
3.  利用 ？？？？多面体，但从顶点到顶点画线。
    *   我相信这总是可行的，因为据我所知，我画的线条无论如何都勾勒出这些多面体。但是，我不知道绘制这些多面体的有效算法，而且我不知道它们的名称来自己查找。
4.  社区可能对我有任何建议。

我附上了一张图片来说明我的显示器的结构。这是一个具有根节点的结构，有 30 个子节点。根节点的子节点没有子节点。

![结构](../Images/68dd3ff005152a9389bed035d33944c3.png)

我附上了第二张没有绘制节点的图片，以显示 3 中描述的多面体的示例，如果我的意思还不是很明显的话。

![多面体](../Images/88df3fe9856a55e105528bfbe6cb8a75.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-11T12:05:38.190

用正方形替换球体，并使用特殊着色器为它们赋予球体的外观。要显示线条，就好像它们从球体表面弹出一样，只需这样做：将起点和终点设置为球体表面（计算坐标是简单的数学运算）。

# java - long 类型的错误值：- Postgresql、Hibernate、Spring

> ID：12647755
> 
> 赞同：30
> 
> 时间：2012-09-28T21:40:51.377
> 
> 标签：java, spring, hibernate, postgresql, blob

我想使用 Spring MVC 和 Hibernate 在 PostgresQL 中存储一个实体（一个字符串 + 一个图像）这是我的表。图像应该是oid的类型。

```
CREATE TABLE document
(
  name character varying(200),
  id serial NOT NULL,
  content oid,   // that should be the image
  CONSTRAINT document_pkey PRIMARY KEY (id )
)
WITH (
  OIDS=FALSE
); 
```

这是我要存储的实体。

```
 @Entity
    @Table(name = "document")
    public class Document {

        @Id
        @GeneratedValue(strategy = GenerationType.IDENTITY)
        @Column(name = "id")
        private Long id;

        @Column(name = "name")
        private String name;

        @Column(name="content")
            private Blob content;  //this is the image
//getters- setters 
```

你可以看到变量“name”是一个String，而不是Long。仍然当我提交带有非数字值的表单时，它会抛出 `org.postgresql.util.PSQLException: Bad value for type long : x`

这是表格：

```
<form:form method="post" action="save.html" commandName="document" enctype="multipart/form-data">
    <form:errors path="*" cssClass="error"/>
    <table>
    <tr>
        <td><form:label path="name">Name</form:label></td>
        <td><form:input path="name" /></td> 
    </tr>

     <tr>
        <td><form:label path="content">Document</form:label></td>
        <td><input type="file" name="file" id="file"></input></td>
    </tr>
    <tr>
        <td colspan="2">
            <input type="submit" value="Add Document"/>
        </td>
    </tr>
</table>  
</form:form> 
```

如果我输入一个数值并提交，OK。但是任何非数字值都会触发上述异常...我读到这可能是由于我没有正确使用 OID 引起的，但我不知道应该怎么做才能消除此异常。其实我也不明白 excpetion 的名字。它说“ **long**类型的价值不高”。但是谁想要长字呢？**变量“名称”是字符串类型！！！！**

最后，这是控制器

```
@RequestMapping(value = "/save", method = RequestMethod.POST)
public String save(@ModelAttribute("document") Document document, @RequestParam("file") MultipartFile file) {

    try {
        Blob blob = Hibernate.createBlob(file.getInputStream());
        document.setContent(blob);
        documentDao.save(document);
    } catch (Exception e) {
        e.printStackTrace();
    }

    return "redirect:/index.html";
} 
```

任何建议都会被采纳。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2014-02-04T07:57:21.717

我有一个类似的问题，但它与数据库中 ID 字段的顺序无关。

经过一番搜索，我发现[这](http://www.shredzone.de/cilla/page/299/string-lobs-on-postgresql-with-hibernate-36.html)表明除非另有说明，否则 Hibernate 中的 Lobs 被视为 OID。

这意味着 Hibernate 将尝试将 Lob 放入 Long a 中，因此产生异常**PSQLException: Bad value for type long**

指定 Lob 被视为文本的方法是注释字段

```
@Lob
@Type(type = "org.hibernate.type.TextType") 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-29T19:52:44.447

当我创建表格时，“名称”列恰好是第一个。这不好。Id 必须是第一列。如果我更改列的顺序，它可以正常工作......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-07-26T14:02:51.220

起初我试图设置

```
@Column(columnDefinition = "text") 
```

而不是 @Lob 注释，正如这里已经提到的。它在 PostgreSQL 上对我有用，但出现错误 org.hibernate.tool.schema.spi.SchemaManagementException: Schema-validation: wrong column type 在表 [Question] 的列 [htmlText] 中遇到；找到 [clob (Types#CLOB)]，但期待 [text (Types#VARCHAR)]

在我的单元测试中（在 HSQLDB 上）。

然后它尝试了

```
@Column(columnDefinition = "clob") 
```

它在 PostgreSQL 和 HSQLDB 上都运行良好！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-30T11:56:43.283

Postgres 和 Hibernate 存在问题。列`text`无法映射到字符串。您需要添加：**@Type(type="org.hibernate.type.TextType")**

例子 ：

```
@Lob
@Type(type = "org.hibernate.type.TextType")
@Column
private String contentJson; 
```

如果列包含二进制类型，请使用： **@Type(type="org.hibernate.type.BinaryType")**

基于页面的解决方案：[https ://github.com/jhipster/generator-jhipster/issues/5995](https://github.com/jhipster/generator-jhipster/issues/5995)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-07-14T23:41:04.593

我遇到了微笑错误，原因是我在整数数据类型中包含除整数以外的一些字符

例如- ,111 和 144- 等

# cassandra - Astyanax：如何确定用于反序列化的动态列的类型

> ID：12647764
> 
> 赞同：1
> 
> 时间：2012-09-28T21:41:57.440
> 
> 标签：cassandra, astyanax

我有一个带有字符串的列族和一个用于列名的复合类型。

当我得到一行作为 ByteBuffers 的 ColumnList 时，我需要知道该列的类型是什么，以便使用适当的序列化程序。有没有办法获得类型或者我应该以另一种方式这样做？

代码：

```
ColumnFamily<String, ByteBuffer> cfBytes =  ColumnFamily.newColumnFamily("mycolumnfamily",StringSerializer.get(), ByteBufferSerializer.get());

ColumnFamilyQuery<String, ByteBuffer> cfq = keyspace.prepareQuery(cfBytes);

RowQuery<String, ByteBuffer> rowQuery = cfq.getKey("foobar");

ColumnList<ByteBuffer> result = rowQuery.execute().getResult(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:40:25.987

如果你得到单行，你可以告诉复合列的类型：

```
// Query the composite columns
@SuppressWarnings("rawtypes")
OperationResult<ColumnList<ColumnFamily>> result = null;
try {
    result = oKeyspace.getKeyspaceContext().
             getEntity().prepareQuery(compTestCF).getRow("12345").execute();
} catch (ConnectionException e1) {
    e1.printStackTrace();
}
for (@SuppressWarnings("rawtypes")
Column<ColumnFamily> col : result.getResult()) {
    String colClass = ((Object) col.getName()).getClass().getName();
    if (colClass.equals(CompositeColumn.class.getName())) {
    System.out.println(col.getLongValue());
    }
} 
```

我的复合列测试类的名称是 CompositeColumn，如上所示。之所以可行，是因为 OperationResult 是一个`ColumnList<ColumnFamily>`对象。每个`Column<ColumnFamily>`对象都包含复合列对象作为名称，这使我们可以找到 CompositeColumn 类名称。我们可以这样做，因为“getRow”或“getKey”调用的结果是一个 RowQuery 对象。

不幸的是，当返回多行时，我还没有找到一种方法来执行此操作。在这种情况下，永远不会`ColumnList<ColumnFamily>`为每一行生成一个对象，而是`ColumnList<Object>`对象。那是因为任何切片或范围查询的结果都是一个 RowSliceQuery 对象，由于某些疯狂的原因，它不会为您提供相同的功能。col.getName() 调用为复合列返回一个空字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T13:03:01.247

对于通用的 Composite Column，您可以只使用**Composite**类型或**MockComposite**类型，例如：

```
ColumnFamily<String, MockCompositeType> CF_COMPOSITE = 
    ColumnFamily.newColumnFamily("CompositeColumn", StringSerializer.get(),
        new AnnotatedCompositeSerializer<MockCompositeType>(MockCompositeType.class)); 
```

您可以**[在此链接](https://github.com/Netflix/astyanax/blob/5c05d118e22eef541a7a201adf7c1c610da13f5b/src/test/java/com/netflix/astyanax/thrift/ThrifeKeyspaceImplTest.java)**中找到更多信息。

或者，编写纯 Astyanax 的替代方法是**[PlayORM](https://github.com/deanhiller/playorm)**。

# ruby - 使用 ruby 单元测试为多个实例运行相同的测试集

> ID：12647765
> 
> 赞同：2
> 
> 时间：2012-09-28T21:42:08.200
> 
> 标签：ruby, testunit

我想在初始化时使用两个不同的参数运行一组测试。我现在正在做的是：

```
require 'rubygems'
gem 'test-unit'
require 'test/unit'
require 'calc'

class My_test < Test::Unit::TestCase
  class << self
    def startup
      $obj = Calc.new("test1")
    end
  end

  def test_1
    #testing $obj method 1
  end

  def test_2
    #testing $obj method 2
  end
  .
  .
  .
end 
```

现在我想使用不同的参数执行所有测试 test_1...test_n 说'test2'，Calc.new（“test2”）。

最好的方法是什么？任何建议。我正在使用 gem test-unit 2.5.x

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:04:51.040

您可以将 test_1... 放入模块中并创建 2 个测试类。

示例（一个测试成功，第二个有错误）：

```
require 'rubygems'
gem 'test-unit'
require 'test/unit'
#~ require 'calc'

module My_tests
  def test_1
    assert_equal( 2, 2*@@obj)
  end
end

class My_test1 < Test::Unit::TestCase
  class << self
    def startup
      @@obj = 1 #Calc.new("test1")
    end
  end
  include My_tests
end

class My_test2 < Test::Unit::TestCase
  class << self
    def startup
      @@obj = 2 #Calc.new("test1")
    end
  end
  include My_tests
end 
```

我没有使用全局变量 ( `$obj`)，而是使用了类属性 ( `@@obj`)。

也许你应该更好地使用`setup`：

```
require 'rubygems'
gem 'test-unit'
require 'test/unit'
#~ require 'calc'

module My_tests
  def test_1
    assert_equal( 2, 2*@obj)
  end
end

class My_test1 < Test::Unit::TestCase
  def setup
    @obj = 1 #Calc.new("test1")
  end
  include My_tests
end

class My_test2 < Test::Unit::TestCase
  def setup
    @obj = 2 #Calc.new("test1")
  end
  include My_tests
end 
```

# c# - 将 dll 函数导出到非托管程序

> ID：12647766
> 
> 赞同：4
> 
> 时间：2012-09-28T21:42:13.230
> 
> 标签：c#

如何导出我的 c# dll 函数以便能够从非托管程序中使用它们。

*   例如：C#中的Dll和Delphi/c++中的应用程序。

我没有 exe 的来源，因为不是 Open S。不能使用 COM。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T21:48:03.907

我推荐使用 Robert Giesecke 的[Unmanaged Exports](https://sites.google.com/site/robertgiesecke/Home/uploads/unmanagedexports)。

# c - Valgrind 通知我 C 中的内存泄漏，我很确定我已修复

> ID：12647767
> 
> 赞同：0
> 
> 时间：2012-09-28T21:42:13.947
> 
> 标签：c, linked-list, valgrind, memory-leaks

我正在用 C 语言实现链表。程序从文件中读取数据并将其放入链表中，打印一些内容，然后删除链接列表并释放内存。然后我在它上面运行 valgrind，它告诉我文件中存在内存泄漏。这是我处理文件的代码：

```
while(fgets(line, sizeof line, file) != NULL){
            theData = (ElementStructs*) malloc(sizeof(ElementStructs));
            token = strtok(line, " \t\n");
            strcpy((theData->word), token);

            AddToBackOfLinkedList(theList, theData);
}

/* Do some printing here */

fclose(file);

DestroyLinkedList(theList); 
```

我看到的问题当然是我为每个数据令牌分配了一个新的内存块。但是，我很确定我在 DestroyLinkedList() 函数中释放了分配的内存块。这是我的 DestroyLinkedList() 函数的代码：

```
void DestroyLinkedList(LinkedLists *ListPtr){
    LinkedListNodes* curNode = ListPtr->FrontPtr;
    LinkedListNodes* nextNode = curNode->Next;
    while(curNode != NULL){
        free(curNode);
        curNode = nextNode;
        if(curNode!=NULL){
            nextNode = curNode->Next;       
    }
}
 } 
```

我释放分配给列表节点的内存的方式有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:52:54.333

您需要释放链表的数据和 data->word（假设是动态分配的）。您可以在 DestroyLinkedList 中执行以下操作：

```
void DestroyLinkedList(LinkedLists *ListPtr){
    LinkedListNodes* curNode = ListPtr->FrontPtr;
    LinkedListNodes* nextNode = curNode->Next;
    while(curNode != NULL){
        free(curNode->data->word);
        free(curNode->data);
        free(curNode);
        curNode = nextNode;
        if(curNode!=NULL){
            nextNode = curNode->Next;       
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:43:57.450

您`LinkedListNodes`包含其他数据，不仅`Next`. 您还必须释放该数据：

```
void DestroyLinkedList(LinkedLists *ListPtr)
{
    if (!ListPtr) return; // Better safe than sorry

    LinkedListNodes* curNode = ListPtr->FrontPtr;
    while (curNode)
    {
        LinkedListNodes* nextNode = curNode->Next;
        free(curNode->WHATEVER); // Corresponds to theData

        // Other frees go here

        free(curNode);
        curNode = nextNode;
    }
} 
```

# magento - Magento -- 根据数量/分层定价动态显示价格

> ID：12647770
> 
> 赞同：2
> 
> 时间：2012-09-28T21:42:20.117
> 
> 标签：magento

我最近有几个人问我这个问题，我对他们没有太多的答案，在其他地方也找不到太多关于这个的信息。

默认情况下，在产品页面上，显示的价格会根据自定义选项动态更新。根据分层定价结构动态更新价格是否会是一个主要的痛苦？基本上，如果用户使用分层定价的产品，并且他们输入了符合分层定价条件的数量，则价格会根据所选的分层定价和数量进行更新。

我认为一些 jQuery voodoo 不应该那么难构建，因此价格会根据值重新计算，但我很好奇是否有其他人以前这样做过，以及他们是否知道这样做的任何潜在陷阱。

有没有很好的理由*不*这样做......或者换句话说，有没有很好的理由为什么它不是作为 Magento Core 的一部分构建的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T12:35:53.130

是的，您可以使用 javascript 来执行此操作，您只需要将层数据放入`<script>`模板中的某个 var 中，这样就可以工作（如果您想使用 jQuery）：

模板： **目录\产品\view.phtml**

```
<script type="text/javascript">
    jQuery(function($){
        // probably you want a custom method in your block for getting a better and safer tierPrices array here
        // for example with formatted prices
        var tierPrices = <?php echo json_encode($_product->getTierPrice()) ?>;
        var getPrice = function(qty){
            qty = Number(qty);
            var i = tierPrices.length;
            while(i--)
            {
                if(qty >= tierPrices[i]['price_qty']){
                    return tierPrices[i]['price'];
                }
            }
            return null;
        };
        var updatePrice = function(price){
            $('.price').html(price);
        };
        // you can use more events here if you want a live response while the user is typing
        $('#qty').change(function(){
            var price = getPrice(this.value);
            if(price !== null){
                updatePrice(price);
            }
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-10T19:11:44.183

我找到了一个简单的解决方案，我检索了货币汇率，它工作正常。代码如下

```
<script type="text/javascript">
jQuery(function($$){
    var inst_price_format = <?php echo Mage::helper('core')->jsonEncode( Mage::app()->getLocale()->getJsPriceFormat() ); ?>;
    var rate = <?php echo Mage::app()->getStore()->getCurrentCurrencyRate(); ?>;
    var tierPrices = <?php echo json_encode($_product->getTierPrice()) ?>;
    var getPrice = function(qty){
        qty = Number(qty);
        var i = tierPrices.length;
        while(i--)
        {
            if(qty >= tierPrices[i]['price_qty']){
                return tierPrices[i]['price'];
            }
        }
        return null;
    };
    var updatePrice = function(price) { 
        $$('.price-box .price').html( formatCurrency( (price*rate), inst_price_format) ); 
    };
    var updateTotalPrice = function(price, qty) { 
        $$('.total-price').html( formatCurrency( ((price*rate) * qty), inst_price_format) ); 
    };

    $$('#qty').change( function(){
        var price = getPrice(this.value);
        var qty = this.value;
        if(price !== null) { 
            updatePrice(price); 
            updateTotalPrice(price, qty); 
        } else { 
            updatePrice(<?php echo $_product->getPrice(); ?>); 
            updateTotalPrice(<?php echo $_product->getPrice(); ?>, qty);
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T02:10:43.930

我在周末花了一些时间并设法让它工作，但我不喜欢我正在修改 tierprices.phtml 模板，以便我可以通过一个类来获取“price_qty”。我按照您的建议将其换掉并使用 $_product->getTierPrice() 代替。我最终得到的代码如下：

----edit---- 我重写了一些东西来支持特价。

```
 <script type="text/javascript">
    var $j = jQuery;
    var $p = {};
    var prices = {};
    //dom elements being used
    $p["old"] = $j(".price-box .old-price .price");
    $p["special"] = $j(".price-box .special-price .price");
    $p["regular"] = $j(".price-box .regular-price .price");

    //save original price to reset back if quantity is reset
    //Checking for special price
    if ($p["special"].html()) {
        var specialPrice = $p["special"].html();
        var oldPrice = $p["old"].html();
    } else {
        var originalPrice = $p["regular"].html();
    }

    //lets get to work.
    $j(function(){
        var tiers = <?php echo json_encode($_product->getTierPrice()) ?>;
        var h = tiers.length;
        while (h--) {
            var key = h;
            var line = {};
            //just build the prices object for use later
            line["qty"] = parseInt(tiers[h]["price_qty"]);
            line["price"] = parseFloat(tiers[h]["price"]).toFixed(2);
            prices[key] = line;
        }
        //keyup event works nicely here
        $j("#qty").on("keyup",function(){
            var quantity = $j(this).val();
            for (var i in prices) {
                var z = i;
                //save lowest tier for reset back to original price
                var lowest = prices[0]["qty"];
                //set the range
                var bottom = prices[i]["qty"];
                var top = prices[z++]["qty"];
                //format to currency -- should probably switch to magento's helper method.
                var price = "<?php echo Mage::app()->getLocale()->currency(Mage::app()->getStore()->
     getCurrentCurrencyCode())->getSymbol() ?>"+prices[i]["price"];
                //check if the price needs to be reset after quantity is reset < lowest
                if (quantity < lowest) {
                    if (specialPrice) {
                        $p["special"].html(specialPrice);
                        $p["old"].html(oldPrice);
                    } else {
                        $p["regular"].html(originalPrice);
                    }
                    break;
                }
                //check the ranges, set the price accordingly.
                if (quantity >= bottom) {
                    if (quantity >= top) {
                        if (specialPrice) {
                            $p["special"].html(price);
                        } else {
                            $p["regular"].html(price);
                        }
                        continue;
                    } else {
                        break;
                    }
                }
            }
        })
    })
</script> 
```

我使用 $j("#qty").on("keyup",function(){}) 代替实时反馈。我可能可以清理它以使用 whiles 而不是我设置的 if 结构，但它可以工作，所以至少它是一种替代方法。

感谢您的协助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-14T21:21:44.807

此版本考虑了产品选项和一级价格：

```
<script type="text/javascript">
jQuery(function($){
    // probably you want a custom method in your block for getting a better and safer tierPrices array here
    // for example with formatted prices
    var tierPrices = <?php
        $_tier_json = json_encode($_product->getTierPrice());
        $_tier_json = substr($_tier_json,0,1) . '{"price":"'.$_product->getFinalPrice().'","price_qty":"1"},' . substr($_tier_json,1);
        echo $_tier_json;

     ?>;
    var getPrice = function(qty){
        qty = Number(qty);
        var i = tierPrices.length;
        while(i--)
        {
            if(qty >= tierPrices[i]['price_qty']){
                return tierPrices[i]['price'];
            }
        }
        return null;
    };

    var formatPrice = function(price) {
        return '$' + parseFloat(price).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
    };

    var updatePrice = function(price){

        // if product has options, use optionsPrice functionality
        if ( typeof optionsPrice != 'undefined' && typeof optionsPrice.productPrice != 'undefined' ) {
            optionsPrice.productPrice = price;
            optionsPrice.reload();
        } else {
            // or if it is a simple product, change price directly in the html
            $(".price-box .price").html( formatPrice(price) );
        }
    };

    var updatePriceEvent = function() {
        var price = getPrice( $('#qty').val() );
        if(price !== null){
            updatePrice(price);
        }
    };

    $('#qty').change( updatePriceEvent );
    $('div.qty-changer .qty_inc, div.qty-changer .qty_dec').click( updatePriceEvent );

});
</script> 
```

如果是可配置产品，或带有自定义选项的产品，它将根据当前选择的选项调整价格。另外，$_product->getTierPrice() 返回从第二层开始的价格，这将在数量较少时显示错误的价格

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-10T18:52:37.553

这不适用于多商店。货币已更改，但价格以默认货币显示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-30T10:28:02.150

我现在为我们的多商店系统做了完全相同的事情。

如果您只有一个价格集，我还添加了一个后备，并且我正在格式化输出以获得更好的用户体验。

随意使用此代码：

```
<script type="text/javascript">
    jQuery(function($){
        // This was built using https://stackoverflow.com/questions/12647770/ and https://himansuboity.wordpress.com/2014/09/30/magento-tip-how-to-get-the-store-price-format-by-javascript/
        var inst_price_format = <?php echo Mage::helper('core')->jsonEncode( Mage::app()->getLocale()->getJsPriceFormat() ); ?>

        var tierPrices = <?php echo json_encode($_product->getTierPrice()) ?>;

        var getPrice = function(qty){
            qty = Number(qty);
            var i = tierPrices.length;
            while(i--)
            {
                if(qty >= tierPrices[i]['price_qty']) { return tierPrices[i]['price']; }
            }
            return null;
        };

        var updatePrice = function(price, qty) { $('.price').html( formatCurrency( (price * qty), inst_price_format) ); };

        $('#qty').change( function() {
            var price = getPrice(this.value);
            var qty = this.value;
            if(price !== null) { updatePrice(price, qty); }
            // no tier prices set, use base price
            else { updatePrice(<?php echo $product->getPrice(); ?>, qty); }
        });
    });
</script> 
```

# java - 嵌套的 JTabbedPane 格式问题

> ID：12647772
> 
> 赞同：1
> 
> 时间：2012-09-28T21:42:38.617
> 
> 标签：java, swing, jpanel, jtabbedpane

我有一个`JTabbedPane`如下图所示：

![在此处输入图像描述](../Images/7e7b41c9e8064b5f99419bcf3c429bef.png)

带有水平标签的表格只是一个简单`JTabbedPane`的，垂直标签是`JTabbedPane`标签位置设置为的`JTabbedPane.LEFT`。它们使用本文中的代码垂直排列： [http ://www.jroller.com/santhosh/date/20050617#adobe_like_tabbedpane_in_swing](http://www.jroller.com/santhosh/date/20050617#adobe_like_tabbedpane_in_swing)

左侧的每个选项卡都包含一个`JTabbedPane`具有水平选项卡的选项卡。

我希望实现两件事，但遇到了一些麻烦：

1）我想摆脱水平标签所在区域周围的边框。我注意到只有当我将内部 tabbedPane 绘制为外部 tabbedPane 的组件时才会显示此边框，如果我自己绘制它，则边框不会显示。

2）我想让垂直选项卡与内容表对齐，而不是与包围内部*tabbedPane*的假想边界对齐。我也试图让它更好地对齐，所以没有像“标签”选项卡下方的小空间这样的小空间。

提前感谢您的帮助！

# r - ggplot 中是否有与 plot 中的 varwidth 选项等效的选项？

> ID：12647774
> 
> 赞同：9
> 
> 时间：2012-09-28T21:42:56.357
> 
> 标签：r, plot, ggplot2

我正在使用 ggplot 创建箱线图，并希望表示对每个框有贡献的样本量。在基本`plot`功能中有`varwidth`选项。它在ggplot中有等价物吗？

例如，在基图中

```
data <- data.frame(rbind(cbind(rnorm(700, 0,10), rep("1",700)),
                         cbind(rnorm(50, 0,10), rep("2",50))))
data[ ,1] <- as.numeric(as.character(data[,1]))
plot(data[,1] ~ as.factor(data[,2]), varwidth = TRUE) 
```

![在此处输入图像描述](../Images/e0b7c368d874b79674a47b9551c3bf0f.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-29T05:31:54.757

不优雅，但您可以通过以下方式做到这一点：

```
data <- data.frame(rbind(cbind(rnorm(700, 0,10), rep("1",700)),
                         cbind(rnorm(50, 0,10), rep("2",50))))
data[ ,1] <- as.numeric(as.character(data[,1]))
w <- sqrt(table(data$X2)/nrow(data))
ggplot(NULL, aes(factor(X2), X1)) + 
  geom_boxplot(width = w[1], data = subset(data, X2 == 1)) +
  geom_boxplot(width = w[2], data = subset(data, X2 == 2)) 
```

![在此处输入图像描述](../Images/2b0182cb814772712e51a8c9a5ba9dee.png)

如果您有多个级别`X2`，则无需对所有级别进行硬编码即可：

```
ggplot(NULL, aes(factor(X2), X1)) + 
  llply(unique(data$X2), function(i) geom_boxplot(width = w[i], data = subset(data, X2 == i))) 
```

您也可以发布功能请求： [https ://github.com/hadley/ggplot2/issues](https://github.com/hadley/ggplot2/issues)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-02T14:42:27.187

[`ggplot2`(V 2.1.0)](http://docs.ggplot2.org/dev/geom_boxplot.html)的当前版本现在包含一个`varwidth`选项：

```
data <- data.frame(rbind(cbind(rnorm(700, 0,10), rep("1",700)),
                     cbind(rnorm(50, 0,10), rep("2",50))))
data$X1 <- as.numeric(as.character(data$X1))
ggplot(data = data, aes(x = X2, y = X1)) + 
    geom_boxplot(varwidth = TRUE) 
```

[![ggplot2 的示例输出图](../Images/0069cac3da54f1e86c236e4ac5317a36.png)](https://i.stack.imgur.com/4kBLd.jpg)

# jquery - 使用 Metro JS 的平铺动画

> ID：12647775
> 
> 赞同：4
> 
> 时间：2012-09-28T21:43:07.913
> 
> 标签：jquery

我正在尝试使用[Metro js](http://www.drewgreenwell.com/projects/metrojs)插件组合两个动画。我想将[多站](http://jsfiddle.net/drewgreenwell/D9usk/presentation/)动画与[翻转动画](http://jsfiddle.net/drewgreenwell/UR6HB/presentation/)结合起来。翻转动画应该在延迟后发生。你能帮我开始一些示例代码吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T18:45:26.023

这取决于您正在寻找多少黑客。

有一个简短而肮脏的方法可以做到这一点，但我不能保证它会跨浏览器工作，如果你关心同步问题，你还必须仔细调整。

解释一下，您可以将一个图块嵌入到另一个图块的框架中，但内部图块不会“智能”地判断它是否正在显示：它不会在每次再次显示时重置其动画。

如果您以翻转瓷砖作为外部动画开始，然后嵌入多个停止瓷砖作为翻转的第一面显示，您可以显示多个停止，然后瓷砖翻转。

变得棘手的是该`delay`值只是：动画*之间*的延迟，但不考虑动画运行的时间。为了在翻转之前显示多个停靠点的所有停靠点，您的翻转瓷砖的延迟必须是：`number-of-stops * ( multiple-stops-tile-delay + multiple-stops-tile-single-animation-time ) - flip-tile-single-animation-time`

**[这是一个示例 jsfiddle](http://jsfiddle.net/MWLFZ/8/)**（我只是修改了给出的两个示例），其中翻转瓷砖的延迟设置得不够长，因为我懒得计算/编码潜入 ms 动画时间。我只是使用了停站数 * 延迟时间。因此，将多个停止瓷砖设置为 3 个停止的 6000 延迟，我将父翻转瓷砖设置为 18000 延迟。如果您让它运行超过几次翻转，它将完全不同步。

**注意：**我已经在 Chrome、Firefox 和 IE 9 中对此进行了测试，它基本上适用于所有三种浏览器，但 IE 可能具有与其他两种不同的奇怪延迟时间，这可能会导致在所有三种浏览器中停止翻转同步是不可能的。

更长和更优雅的方法将涉及对插件的代码更改以强制重置其他图块内的图块的动画，或一些类似的方法，但不仅仅是指出这一点将超出直接答案的范围。

# bash - 用于自动更改到项目目录的后激活脚本

> ID：12647779
> 
> 赞同：1
> 
> 时间：2012-09-28T21:43:39.323
> 
> 标签：bash, virtualenv, virtualenvwrapper, virtualenv-commands

我的 virtualenv 脚本中有一个单行条目，`postactivate`它通知我我所在的 virtualenv：

```
export PS1="\[\033[40;1;36m\](`basename $VIRTUAL_ENV`)\[\033[00m\]\[\033[01;34m\] \W\[\033[00m\] \$ " 
```

我想添加一行，当我发出 workon 命令时，该行也将更改为我的项目目录。这真的只适合我，所以我很高兴发出命令`workon myproject`并使用 myproject 作为唯一变量，然后更改为`/path/to/projects/myproject`. 这将起作用，因为我所有的项目都在同一个目录中。展示：

```
cd ~/projects/django-projects/$1 
```

会工作，但当然命令变量实际上是`post_activate`. 我可以轻松地从命令行获取字符串并将其传递给该脚本吗？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T17:20:38.650

我就是这样做的，尽管我认为有多种解决方案：

```
dir=${VIRTUAL_ENV:17}; cd ~/projects/django-projects/$dir 
```

# javascript - javascript onsubmit = function yielding '无法设置 onsubmit 的属性：对象为 null 或未定义

> ID：12647781
> 
> 赞同：1
> 
> 时间：2012-09-28T21:43:40.997
> 
> 标签：javascript

标题基本上说明了一切。

我遇到的错误：

```
document.forms[0].onsubmit = validateForm; 
```

这是我的 .js 文件的最顶部。这有关系吗？

> 无法设置属性“onsubmit”的值：对象为空或未定义

在 IE 的调试器中。

作为测试，我将 设置`validateForm()`为 always `true`，但仍然出现错误。我很肯定`document.forms[0]`我的网页中有一个，而且我确实有一个功能`validateForm()`。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T21:52:48.237

那时您没有加载任何表单...尝试：

```
 window.onload = function () {
    document.forms[0].onsubmit = validateForm;
  } 
```

# php - 验证失败时，Codeigniter 表单 URI 丢失段

> ID：12647784
> 
> 赞同：0
> 
> 时间：2012-09-28T21:43:51.870
> 
> 标签：php, codeigniter

使用 codeigniter 2.1.2，我通过一个带有参数的控制器加载了一个表单视图。这个参数是一个布尔值，告诉视图是否在表单上呈现某些内容。

标准表单的 URI 是：`ordering/create/` 但如果表单应该呈现为“假期”表单是：`ordering/create/holiday`

如果提交的表单未通过验证，则始终显示标准表单。如何通过验证和表单重新填充使最后一段保持不变？

这是我的控制器功能。

```
public function create($holiday = NULL)
{
    $data['holiday'] = ($holiday != NULL) ? TRUE : FALSE;

    //load the code igniter helpers we'll be using
    $this->load->helper('form');
    $this->load->library('form_validation');

    //set the page title
    $data['title'] = 'Create an Order';

    //validate the form input
    $this->form_validation->set_rules('firstName','First Name','required');
    $this->form_validation->set_rules('lastName','Last Name','required');
    $this->form_validation->set_rules('phoneNumber','Phone Number','required|callback_validate_phoneNumber');
    $this->form_validation->set_rules('emailAddress','Email Address','required|valid_email');               
    $this->form_validation->set_rules('pickupDate','Pickup Date','required|callback_validate_pickupDate');
    $this->form_validation->set_rules('pickupTime','Pickup Time','required');

    //check that at least one product was selected
    $this->load->model('products_model');
    $data['products'] = $this->products_model->get_online_products($data['holiday']);
    $productSelections = array();
    $totalProducts = 0;
    foreach($data['products']->result() as $product)
    {
        $productSelections[$product->productProductSizeId] = $this->input->post('product_'.$product->productProductSizeId);
        $totalProducts += $productSelections[$product->productProductSizeId];
    }

    $pickupDate = new DateTime($this->input->post('pickupDate'));

    //if the form failed validation, or there is no form data yet, send the user back to the form
    if($this->form_validation->run() === FALSE || $totalProducts == 0)
    {
        $this->load->model('calendar_model');
        $data['calendarRules'] = $this->calendar_model->get_rules($data['holiday']);

        $data['productSelections'] = $productSelections;

        if($this->form_validation->run() === TRUE && $totalProducts == 0)
        {
            $data['productsError'] = 'You must order at least one product';
        }

        $this->load->view('templates/header', $data);
        $this->load->view('ordering/create', $data);
        $this->load->view('templates/footer');
    }
    else
    {
        //save the data to the DB
        $savedData = $this->ordering_model->create_order($data['holiday']);

        //send the confirmation email and redirect to the confirmation page
        $this->send_confirmation($savedData['orderHeader']['orderId']);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:06:34.683

在控制器`ordering`中，创建一个方法`create($holiday = null)`。

然后你这样做：

```
$data['holiday'] = ($holiday != NULL) ? true : false;
$this->load->view('yourView', $data); 
```

要保留`holiday`您的值，应相应地设置表单提交操作。

在您看来，您可以执行以下操作：

```
<?php
$submitUrl = site_url('ordering/create');
if ($holiday) {
    $submitUrl .= '/holiday';
}

<form method="post" action="<?= $submitUrl ?>">
</form> 
```

# javascript - Javascript删除方法

> ID：12647786
> 
> 赞同：0
> 
> 时间：2012-09-28T21:44:05.930
> 
> 标签：javascript, processing.js

我正在尝试使用 proccessing.js 库创建一个画布游戏。

我使用一个数组来保存我所有的对象。

```
class blah{
    ...
    void delete(){
       // this.remove ???
    }
}

blah myArray = [];
myArray.push(new blah()); 
```

有没有办法可以在该类中创建一个删除函数，以便在删除元素时将其从数组中删除？我想到了一种解决方法，例如将元素在数组中的位置作为参数传递。有没有不通过任何参数直接删除它的方法？

我上面说的解决方法：

```
void delete(int i){
  myArray.splice(i,1);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:03:16.383

您应该能够通过以下方式找到实例[`indexOf`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf)：

```
void delete() {
    int index = myArray.indexOf(this);

    if (index > -1) {
        myArray.splice(index, 1);
    }
} 
```

# java - BATCH 文件错误 - 线程“main”中的异常，但在没有批处理文件的情况下编译和运行良好

> ID：12647791
> 
> 赞同：0
> 
> 时间：2012-09-28T21:44:47.027
> 
> 标签：java, batch-file

我正在尝试制作一个批处理文件来自动编译和执行java程序。这是我的批处理脚本：

```
@echo off
cd X:\
echo Compile/Execute Java
echo Author: Phil Eaton
echo Created: 09-28-2012
set /P file=File name: %=%
set java = %file%.java
javac %java%
java %file%
set /P quit= 
```

但是，它返回“线程“main”中的异常 java.lang.NoClassDefFoundError：HelloWorld”，其中 HelloWorld 是用户输入。但是，当我在命令提示符下运行 javac HelloWorld.java 时，它可以正常编译，而当我运行 java HelloWorld 时，它也可以正常运行。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T21:54:26.827

`set`周围不允许有空格`=`：

```
set java=%file%.java 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:54:51.403

建议：

```
@rem Compile and run Java program
@if "%1"=="" goto USAGE

javac %1%.java
java %1%
@goto THE_END

:USAGE
@echo EXAMPLE USAGE: doit HelloJava
@goto THE_END

:THE_END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T21:55:44.000

只需删除空格：

```
set java=%file%.java 
```

当存在空格时，`java`变量将为空。或者，您可以使用：

```
set java = "%file%.java" 
```

# ios - 使用 Facebook iOS SDK 3.1 所需的最低 iOS 版本是多少？

> ID：12647807
> 
> 赞同：2
> 
> 时间：2012-09-28T21:46:18.560
> 
> 标签：ios, facebook

Facebook 文档表明新的 SDK 支持新的 iOS 6 功能，并且在一定程度上也向后兼容。Facebook iOS SDK 3.1 支持的最低 iOS 版本是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:05:07.833

位于存储库中的 XCode 项目[将 iOS 3 指定为 SDK 本身的部署目标，](https://github.com/facebook/facebook-ios-sdk/blob/e2b10bb2efbe6a176386092f2534e8beb4f1e885/src/facebook-ios-sdk.xcodeproj/project.pbxproj#L880)并将 iOS 5 指定为测试。

但您可能无法在 iOS 3 上使用它，请参阅 Facebook 员工回答的其他问题：[Facebook iOS SDK 3.0 是否不能在 iOS 3.x 上运行？](https://stackoverflow.com/questions/11441067/will-facebook-ios-sdk-3-0-not-work-on-ios-3-x)：

> Facebook iOS SDK 3.0 不适用于 iOS 3.x。我们觉得 iOS 4.x 中的生产力增强（例如块）实在是太有用了。SDK 是开源的，我们计划维护历史记录，其中包括适用于 3.x 的现有代码。

# sql-server - 为什么递归字符串连接中的子查询总是返回NULL？

> ID：12647808
> 
> 赞同：1
> 
> 时间：2012-09-28T21:46:27.977
> 
> 标签：sql-server, string, sql-server-2005

假设我有两张桌子：

*   表 1：有一个我需要处理的 ID 列表。
*   表 2：具有 ID 和值的键值对。

我需要从 TABLE2 中检索 TABLE1 中所有 ID 的值，作为单个字符串。为了实现这一点，我进行了下一个查询：

```
DECLARE @id INT, @value VARCHAR(10);

SELECT @id=0, @value='';

SELECT
    @value = @value + (SELECT TOP 1 value FROM TABLE2 WHERE id=@id) + '-',
    @id = @id+1
FROM TABLE1 
```

但是当我运行这个查询时，子查询总是返回 null （因此，`@value=NULL`最后）。我的问题是：为什么子查询`SELECT TOP 1 value FROM TABLE2 WHERE id=@id`总是返回 NULL，即使在 TABLE2 中找到了 ID？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T21:48:09.213

这是尝试实现 treewalker 的一种非常奇怪的方式，在 SELECT 中增加 @id 并期望它应用于子查询。它不起作用，因为 SQL Server 在查询设置阶段将子查询表达式的 @id 值锁定为常量。

请参阅此示例，其中返回的@value 清楚地表明@id 被锁定为 1。对于您的问题，它被锁定为 0，因此每个子查询将返回 NULL，表面上是因为 @id = 0 不匹配。

```
create table table1 (
  id int);
create table table2 (
  id int, value varchar(10));
insert table1 values (1),(2),(3),(4);
insert table2 values
(1,1),
(2,2),
(3,3),
(4,4);

DECLARE @id INT, @value VARCHAR(10);

SELECT @id=1, @value='';

SELECT
    @value = @value + (SELECT TOP 1 value FROM TABLE2 WHERE id=@id) + '-',
    @id = @id+1
FROM TABLE1;

select @value, @id

-- result
1-1-1-1       5 
```

如果您只想要 2 中的值，那么您只需将子查询与 table.id 相关联，而不是变量 @id，如下所示：

```
create table table1 (id int);
create table table2 (id int, value varchar(10));
insert table1 values (1),(2),(3),(4);
insert table2 values
(1,1),
(3,9),
(4,4);

DECLARE @value VARCHAR(10);

SELECT @value='';

SELECT
    @value = @value + isnull((SELECT TOP 1 value 
                              FROM TABLE2 
                              WHERE id=table1.id) + '-','')
FROM TABLE1;

select @value

-- Result
1-9-4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:52:58.243

还有另一种解决方案（如果 table2 中的值不为空，则此解决方案仅在 table2 中的值之间附加“-”分隔符）：

```
declare @id int, @value varchar(max);
select @id = 0, @value='';

select 
    @value = @value + isnull(value,'') + case when value is null then '' else '-' end
from 
    table2 t2
where 
    t2.id in (select id from table1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T21:56:25.843

这是因为您从 0 开始 @id。除非您的表中的 id 为 0，否则您可能需要这样做：SELECT @id=1

或者，您可以将其压缩为此而不使用 id：

```
SELECT @value = @value + value +  '-'
FROM TABLE2 t2
INNER JOIN TABLE1 t1 ON t1.id = t2.id 
```

# c# - 启动 Windows 服务时找不到 app.config

> ID：12647810
> 
> 赞同：3
> 
> 时间：2012-09-28T21:46:33.967
> 
> 标签：c#, windows, service, app-config

我有一个在 Windows 7 上运行的 CSharp Windows 服务。它从一个用于设备管理的框架中实例化一个 dll。此 dll 有一些设置存储在名为“pm.config”的 app.config 中。

我将所有程序集和 pm.config 文件复制到 winsvc 项目文件夹同一级别的名为“bin”的文件夹中。

我添加了对 dll 框架的引用并编译了项目。pm.config 文件存在于“bin\debug”和“bin\release”子文件夹中。我使用 installutil 安装了 winsvc 并启动了 winsvc。一切都很好，除了当 winsvc 从框架 dll 调用“Initialize”方法时，此方法尝试打开 pm.config 文件并生成以下异常：

```
InnerException = {"The machine.config file 'pm.config' was not found.\r\nParameter name: machineConfigFilename"} 
```

我使用检查了程序集位置`Assembly.GetExecutingAssembly().Location` ，它指向了 winsvc 项目的正确文件夹，我的意思是“mysvcproject\bin\debug”文件夹。

我很确定这与winsvc的安全上下文有关，但我不知道。我正在使用 LocalService 帐户来启动 winsvc，而 'bin\debug' 没有此帐户的权限。相反，我完全控制了此文件夹上的所有人帐户，但仍然出现错误。

我完全迷路了，有人可以帮助我吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:56:15.317

不久前我在部署 Windows 服务时遇到了类似的问题。那么问题是 Windows 服务期望该文件位于 c:\windows\system32 中。不要使用 Assembly.GetExecutingAssembly().Location 进行检查，而是尝试 Directory.GetCurrentDirectory() 并查看是否产生相同的结果。如果没有，请尝试将 pm.config 文件放在当前目录中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:49:45.040

App.config 文件名必须与您的 Windows 服务可执行文件的文件名匹配，并附加“.config”。所以如果你的服务是“pm.exe”，你的配置文件应该是“pm.exe.config”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-26T20:57:21.013

我成功地将 Daniel 的解决方案与此解决方案相结合：[https ://stackoverflow.com/a/7262937/771473](https://stackoverflow.com/a/7262937/771473)

```
Configuration cfg = ConfigurationManager.OpenExeConfiguration(Assembly.GetExecutingAssembly().Location);
String MyValue = cfg.AppSettings.Settings["MyKey"].Value; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T22:20:25.287

正在执行的应用程序使用它自己的 app.config，而不是您引用的 dll 中的那个。您应该在执行程序集中创建一个 app.config 并将您的设置放在那里。

[dll 的 App.config](https://stackoverflow.com/questions/154837/app-config-for-dll)

# python - 从 2 个数据框列交换单元格字符串

> ID：12647811
> 
> 赞同：1
> 
> 时间：2012-09-28T21:46:38.623
> 
> 标签：python, dataframe, pandas, compare-and-swap

我正在努力从数据框的 2 列交换值，如下所示：

```
rs649071 rs640249 0.265 0.49 
rs647621 rs640249 0.227 0.34 
rs644339 rs640249 0.116 0.08 
rs641563 rs640249 1.0 33.96 
rs640249 rs11073074 0.248 0.77 
rs640249 rs11637397 0.194 0.68 
```

这个想法是测试第 2 列的每个单元格是否为 rs640249，如果不是，则更改为第 1 列中的相应字符串，反之亦然。这样，最终结果将类似于：

```
rs649071 rs640249 0.265 0.49 
rs647621 rs640249 0.227 0.34 
rs644339 rs640249 0.116 0.08 
rs641563 rs640249 1.0 33.96 
rs11073074 rs640249 0.248 0.77 
rs11637397 rs640249 0.194 0.68 
```

我试图迭代元组，但是，元组不支持项目分配。

```
rscode='rs640249'
for inf in LDfiles:
    df = read_csv(inf, sep='\t', skiprows=1, names=['A', 'B', 'C'])
    for tup in df.itertuples():
        if tup[2] != rscode:
            tup[1], tup[2] = tup[2], tup[1]
        print(tup) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:50:31.837

一种方法是使用[apply](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.apply.html?highlight=apply#pandas.DataFrame.apply)：

```
def my_fun(row):
    if row['col1'] == 'rs640249':
        return row['col2'], row['col1']
    else:
        return row['col1'], row['col2']

df = df.apply(my_fun, axis=1) 
```

如果您只想更改一列中的值，您仍然可以使用`apply`：

```
def my_fun2(row, colID):
    if row[colID][0] == 'rs640249':
        return row[colID][::-1] #reverse the tuple
    else:
        return row[colID]

df[colID] = df.apply(lambda x: my_fun2(x, colID), axis=1) 
```

*注意：由于`my_fun2`返回的是单个值，所以这次`apply`返回的是一个Series，所以我们需要稍微改变一下我们申请apply的方式。*

例子：

```
df
#                             0
# 0    ('rs649071', 'rs640249')
# 1  ('rs640249', 'rs11073074')

df[0] = df.apply(lambda x: my_fun2(x,0), axis=1)
#                             0
# 0    ('rs649071', 'rs640249')
# 1  ('rs11073074', 'rs640249') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T20:43:43.057

对于未来的裁判，这里有一个可能的解决方案：

```
 for row_index, row in df.iterrows():
        if row['L1'] == 'rs640249':
            df.set_value(row_index, 'L1' , row['L2'])
            df.set_value(row_index, 'L2' , row['L1']) 
```

最好的，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T19:42:29.593

你为什么不尝试这样的事情，使用数组操作：

```
condition = df['L1'] == 'rs640249'
tmp = df['L1'].copy()
df['L1'][condition] = df['L2'][condition]
df['L2'][condition] = tmp[condition] 
```

# c++ - 如何响应在 qml、C++ qt、Blackberry 10 Cascades 中的列表视图中单击列表项

> ID：12647816
> 
> 赞同：3
> 
> 时间：2012-09-28T21:47:43.027
> 
> 标签：c++, qt, listview, qml, blackberry-10

我试图弄清楚如何能够单击黑莓列表中的项目。我正在使用 QML、C++、QT 和 Blackberry 10 Cascades。我已经实现了列表视图，然后我尝试通过查看这个 Twitter 时间线示例来点击列表中的项目（顺便说一句 - 我无法运行该示例）。

我在做什么是行不通的。当我调用 listView_->setListItemManager(new CustomerListItemManager(customerListContainer_)) 时，它会导致列表视图为空白（在我添加该代码之前，列表视图出现了）。

所以基本上如何获得点击列表中的项目并让它响应工作的能力。

无论如何 - 这是我迄今为止尝试过的相关代码：

```
Container {
    id: customersListContainer
    objectName: "customersListContainer"

    ListView {
        id: customersList
        objectName: "customersList"

        listItemComponents: [
            ListItemComponent {
        type: "item"

        Container {

        HeaderListItem {
            title: ListItemData.firstName + " " + ListItemData.lastName
        }

            StandardListItem {
            title: ListItemData.officePhone + "\t" + ListItemData.cellPhone
            description: ListItemData.email
        }
        ]                           
    }
} 
```

CustomerListItemManager.cpp：

```
CustomerListItemManager::CustomerListItemManager() {}

CustomerListItemManager::~CustomerListItemManager() {}

VisualNode *CustomerListItemManager::createItem(ListView *list, const QString &type) 
{
    //the CustomerList::getInstance()->customerListContainer returns the customersListContainer (see the qml code above)
    //
    return new CustomerItem(CustomerList::getInstance()->customerListContainer());
}

void CustomerListItemManager::updateItem(ListView *list, VisualNode *control, const   QString &type, const QVariantList &indexPath, const QVariant &data)
{
    QObject* obj = qvariant_cast<QObject *>(data);
    CustomerData* customer = qobject_cast<CustomerData *>(obj);
} 
```

客户项目.cpp：

```
CustomerItem::CustomerItem(Container *parent) : CustomControl(parent) {}

CustomerItem::~CustomerItem() {}

void CustomerItem::updateItem(const QString text, QDateTime date) {}

void CustomerItem::select(bool select) {

    // Is this where you handle the response to clicking on an item on the list???
    //
    if (select) qDebug() << "item selected";

else;
}

void CustomerItem::reset(bool selected, bool activated) {
select(selected);
}

void CustomerItem::activate(bool activate) { Q_UNUSED(activate); } 
```

在另一个文件中填充列表：

```
for (int i = 0; i < customers->length(); ++i) {
    groupDataModel_.insert(customers->at(i)
}
listView_->setDataModel(&groupDataModel_);

//the customerListContainer_ is the customersListContainer (see the qml code above)
// 
listView_->setListItemManager(new ListItemManager(customerListContainer_); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T10:27:05.433

我以前遇到过这个问题。基本上，从 ListItemComponent 中，您不能直接使用它们的 id 与外部元素进行交互，例如......

我不确切知道您想做什么，但这里有两个可能对您有所帮助的解决方案：

1）使用单击列表中的元素时发出的信号“onTriggered”。这是一个 QML 示例：

```
onTriggered: {
    console.log("onTriggered");

    // Retrieve the selected item
    var chosenItem = dataModel.data(indexPath);

    // Bind with C++ using a Q_INVOQUABLE method
    controller.launchItem(chosenItem);
} 
```

2) 在 ListItemComponent 中选择元素的情况下，可以使用中间函数。例如，从您的 ListItemComponent QML 定义中，您可以调用：

```
// Load additional comments
ListItem.view.launchAdditionalCommentButtonPressedAction(); 
```

然后将该函数添加到 QML 文件中的 ListView 中：

```
function launchAdditionalButtonPressedAction() {
    // Bind with C++ using a Q_INVOQUABLE method
    controller.additionalButtonPressed();
} 
```

我不确定这正是您正在寻找的，但我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-11T12:21:10.700

在 ListView 的声明中，使用 onTriggered 事件如下

```
 onTriggered: {
                  var selectedItem = dataModel.data(indexPath);
                 // do something with the selected item
               } 
```

# c# - 列表框多选方法

> ID：12647819
> 
> 赞同：-2
> 
> 时间：2012-09-28T21:47:50.943
> 
> 标签：c#, ribbon

我有一个列表框和一个列表视图。当我在 Listbox 上选择多个项目并单击添加时，它将第一个选定的项目添加到列表视图中。我无法克服这个问题。同时，扩展了Listbox选择模式。

```
void reinit()
{
    if (_adrlinks == null)
        return;
    object li = listAdr.SelectedItem;
    listAdr.Items.Clear();
    foreach (LnkAdresse ele in _adrlinks) {
        if (((Filter == eFilter.all) || (Filter == eFilter.basic && ele.RType <= 1) ||
             (Filter == eFilter.synteilnehmer && ele.RType == 8) ||
             (Filter == eFilter.deliveryteam && ele.RType >= 16 && ele.RType <= 31) ||
             (Filter == eFilter.explorationteam && ele.RType >= 32 && ele.RType <= 63)
            ) && (int)ele.mut >= 0)
        {
            listAdr.Items.Add(ele);  //listAdr is my listview
            if (ele == li)
                listAdr.SelectedItem = li;
        }
    }
    //NotifyContent("changeDoc", "", "");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:01:06.840

虽然不直接回答您的问题，但我建议您使您的代码更具可读性和可维护性。也许你的问题会消失？

一个建议：创建一个像这样的过滤器方法

```
private bool TakeLinkAddress(eFilter filter, LnkAdresse linkAddress)
{
    if ((int)linkAddress.mut < 0) {
        return false;
    }
    int rType = linkAddress.RType;
    switch (filter) {
        case eFilter.all:
            return true;
        case eFilter.basic:
            return rType <= 1;
        case eFilter.synteilnehmer:
            return rType == 8;
        case eFilter.deliveryteam:
            return rType >= 16 && rType <= 31;
        case eFilter.explorationteam:
            return rType >= 32 && rType <= 63;
        case else:
            return false;
    }
} 
```

也给你的变量更好的名字。现在你的循环看起来好多了：

```
foreach (LnkAdresse linkAddress in _adrlinks) {
    if (TakeLinkAddress(filter, linkAddress)) {
        linkAddressListView.Items.Add(linkAddress);
        if (linkAddress == selectedLinkAddress) {
            linkAddressListView.SelectedItem = selectedLinkAddress;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:55:17.217

您的问题非常不清楚，要从列表框中获取多个选定项目，您可以使用 SelectedItems 属性，但是如果您这样做，我不得不对您想用它做什么做出巨大的猜测。

或许

```
void reinit()
{
  if (_adrlinks == null) return;
  listAdr.Items.Clear();
  foreach(var li in ListAdr.SelectedItems)
  {
    foreach (LnkAdresse ele in _adrlinks)
    {
      if (((Filter == eFilter.all) || (Filter == eFilter.basic && ele.RType <= 1) || (Filter == eFilter.synteilnehmer && ele.RType == 8)
                || (Filter == eFilter.deliveryteam && ele.RType >= 16 && ele.RType <= 31) || (Filter == eFilter.explorationteam && ele.RType >= 32 && ele.RType <= 63))
                && (int)ele.mut >= 0)
      {
        listAdr.Items.Add(ele);  //listAdr is my listview
        // commented out as it won't ever be true in a multiselect scenario
        // and wouldn't make any sense if it did 
        //if (ele == li) listAdr.SelectedItem = li;
      }
    }
  }
  //NotifyContent("changeDoc", "", "");
} 
```

也许 ？？？

# javascript - 将代码与其他脚本隔离（命名空间）

> ID：12647821
> 
> 赞同：2
> 
> 时间：2012-09-28T21:48:07.473
> 
> 标签：javascript, jquery

我这样做是这样的：

```
;(function($, window, document, undefined){

  var MyNamespace= MyNamespace || {};

  $.MyNamespace.someMethod = function(){
    // code
  };

  $.MyNamespace.someOtherMethod = function(){
    // code
  };

  $.MyNamespace.someProperty = {};

  // etc.

}(jQuery)); 
```

可以吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:53:22.473

在变量初始化中，`MyNamespace`如果存在，则将其设置为全局，这不是作用域/隔离的。

然后，您引用`$.MyNamespace`而不是`MyNamespace`引用两个非常不同的事物。`$`是引用的参数，`jQuery`因此可以全局访问，并且不与其他代码隔离。

如果`$.MyNamespace`您希望其他代码可以访问它，并且`MyNamespace`如果您希望仅访问此代码，请使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:52:03.670

修改代码：有两个问题。

MyNamespace 是 $ 的属性。并且窗口和文档在函数体内不可用。

```
;(function($, window, document, undefined){

  $.MyNamespace= $.MyNamespace || {};

  $.MyNamespace.someMethod = function(){
    // code
  };

  $.MyNamespace.someOtherMethod = function(){
    // code
  };

  $.MyNamespace.someProperty = {};

  // etc.

}(jQuery, window, window.document)); 
```

# csv - 使用来自守护进程的 monetdb 导入 CSV

> ID：12647824
> 
> 赞同：0
> 
> 时间：2012-09-28T21:48:12.283
> 
> 标签：csv, monetdb

有没有办法在不必启动实例的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T11:55:52.950

monetdb 工具管理（创建、启动、停止……）数据库，但不管理存储在其中的数据。

原则上，您可以通过直接编辑底层数据结构来加载数据而无需启动 mserver。列（bats）存储为内存映射文件，您可以使用自己编写的程序手动编辑它们。但是，您会弄乱莫奈的内部结构，这不是一个好主意。

只是出于好奇：你为什么要这样做？你想达到什么目的？您介意提出第二个问题来说明您的真正问题吗？

# c - 固定大小类型的动态分配

> ID：12647829
> 
> 赞同：2
> 
> 时间：2012-09-28T21:48:55.540
> 
> 标签：c, linux, memory, memory-management, malloc

假设我们有一些固定长度的数据类型，例如 C 结构：

```
struct T
{
    ...;
} 
```

分配 T 的一种方法是：

```
T* create_t() { return (T*) malloc(sizeof(T)); } 
```

并解除分配：

```
void destroy_t(T* t) { free(t); } 
```

在后台 malloc 使用一种内存分配算法，以不同的方式处理不同大小的块。

假设我们正在编写一个经常调用 create_t 和 destroy_t 的程序，并且一次分配了非常多的 T 个项目（并且以伪随机顺序）。

鉴于所需的内存是固定大小的元素，是否可以编写一个优于 malloc 的通用实现的自定义内存分配方案。

例如，我们可以预先分配一个包含大小为 T 的元素的巨大数组，然后使用它们，但是跟踪哪些元素已分配而哪些未分配的最佳方法是什么？

当使用大量相同大小的分配调用时，Linux 上的 malloc 最终使用什么算法？

与通用 malloc 相比，此自定义方法的性能大致如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:21:15.130

至于#1——其他人已经处理了，简而言之，glibc 做得相当好，而其他 malloc 在各种情况下可能做得更好。

但是，至于您的第二个问题：定制的性能如何？

• 一般而言，了解应用程序自身使用模式和需求的自由列表分配器的手工编码的低级实现可能会胜过像 GNU libc 提供的一般情况算法。

• 但是你必须通过写东西来证明它。

Custom malloc有一些相关答案，[用于许多固定大小的小块？](https://stackoverflow.com/questions/3622637/custom-malloc-for-lots-of-small-fixed-size-blocks)， 顺便一提。

您还可以查看各种文件系统驱动程序中磁盘扇区使用的表示，因为它们有效地解决了相同的问题——在各种负载下以伪随机间隔分配固定大小的块/扇区——而大多数 malloc 将专注于通用——目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T22:07:02.350

首先，您可以有多个`malloc`. 例如，Glibc malloc（解释[here](http://bardofschool.blogspot.fr/2009/09/glibc-malloc-implementation.html)）是[here](http://sourceware.org/git/?p=glibc.git;a=tree;f=malloc;hb=HEAD)，但是[musl libc](http://www.musl-libc.org/) malloc is [here](http://git.musl-libc.org/cgit/musl/tree/src/malloc)。[C 动态内存实现](http://en.wikipedia.org/wiki/C_dynamic_memory_allocation)的多样性是众所周知的。

还要注意一个简单的实现

```
void *malloc (size_t sz)
{
   errno = ENNOMEM;
   return 0;
} 
```

[可能符合malloc 标准规范](http://pubs.opengroup.org/onlinepubs/009695399/functions/malloc.html)（例如在 Posix 和 C99 中）的字母，但不符合精神。

实际上，它是通过[系统调用](http://en.wikipedia.org/wiki/Syscall)（如[mmap(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html)和有时[sbrk(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/sbrk.2.html)等都与[虚拟内存](http://en.wikipedia.org/wiki/Virtual_memory)和[地址空间相关的）向](http://en.wikipedia.org/wiki/Address_space)[Linux 内核](http://en.wikipedia.org/wiki/Linux_kernel)`malloc`询问一些内存块来实现的。由于[ASLR](http://en.wikipedia.org/wiki/ASLR) ，您的程序运行一次到下一次运行的结果可能会有所不同。能够处理许多相同大小的分配，但是您最终可能会在运行时间很长的程序上产生[内存碎片。](http://en.wikipedia.org/wiki/Fragmentation_%28computing%29)`munmap(2)``malloc``malloc`

您也可以使用例如[glib 内存切片](http://developer.gnome.org/glib/2.32/glib-Memory-Slices.html)中的切片分配器，但它可能很少有用。您还可以使用[Boehm 的保守垃圾收集器](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)（例如，使用`GC_malloc`而不是显式地`malloc`打扰`free`您的数据）。

实际上，在 Linux 上，`malloc`效果很好。我认为你不应该为此烦恼。当然，它旨在最大限度地减少内存分配低级操作，例如`mmap`（这很昂贵；一个好的实现可以很好地管理内存池，并在从内核询问之前`malloc`尝试重新使用-d 内存）。`free`还有与多线程等相关的问题。

在担心降低`malloc`应用程序的成本之前，您应该测量它（[valgrind](http://valgrind.org/)很有用，也可以调试`malloc`相关的错误）。很多时候，成本`malloc`在应用程序中并不重要。如果你真的想要，你可以管理自己的[记忆领域](http://en.wikipedia.org/wiki/Region-based_memory_management)，但我不确定你应该打扰。（优化前先测量）。在当今的机器上，缓存考虑因素也对代码的实际性能起主导作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T21:54:29.837

据我所知，所使用的内存管理是一种“桶”管理。

`malloc`将空闲内存段保存在桶中，并在被调用时尝试将最适合的块之一传递给调用者。

但是只需下载 libc 的源代码并自己查看即可。

而且编写内存管理是相当棘手的，并且在当前使用的算法上投入了大量精力。我确实相信很难（尤其是作为一个人）想出比所有这些人做得更好的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T22:03:25.927

问：鉴于所需的内存是固定大小的元素，是否可以编写一个优于 malloc 通用实现的自定义内存分配方案？

答：也许吧。这可能是一项不平凡的工作。

任何给定的操作系统都可能有不同的“malloc()”实现。Linux 的标准（例如）是 Gnu Libc。你可以在这里找到源代码：

*   [http://www.gnu.org/software/libc/](http://www.gnu.org/software/libc/)

'希望有帮助！

# python-2.7 - Python：使用“while”循环返回列表中小于目标值的值的索引

> ID：12647830
> 
> 赞同：0
> 
> 时间：2012-09-28T21:49:04.047
> 
> 标签：python-2.7, while-loop

该程序应该将列表作为输入并返回小于 0 的值的索引。

但是，我不允许使用 for 循环。我必须使用while循环来做到这一点。

例如，如果我的函数被命名为 findValue(list) 并且我的列表是 [-3,7,-4,3,2,-6]，它看起来像这样：

```
>>>findValue([-3,7,-4,3,2,-6]) 
```

会回来

```
[0, 2, 5] 
```

到目前为止，我已经尝试过：

```
def findValue(list):
    under = []
    length = len(list)
    while length > 0:
        if x in list < 0:       #issues are obviously right here.  But it gives you
            under.append(x)     #an idea of what i'm trying to do
        length = length - 1
    return negative 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:12:56.550

我对你的代码做了一些小的改动。基本上我使用一个变量来表示给定迭代`i`中元素的索引。`x`

```
def findValue(list):
    result = []
    i = 0
    length = len(list)
    while i < length:
        x = list[i]
        if x < 0:      
            result.append(i)
        i = i + 1 
    return result

print(findValue([-3,7,-4,3,2,-6])) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-11T02:43:07.843

试试这个：

```
def findValue(list):
    res=[]
    for i in list:
        if i < 0:
            res.append(list.index(i))
    return res 
```

# c - 我的链表实现有什么问题？

> ID：12647842
> 
> 赞同：0
> 
> 时间：2012-09-28T21:51:13.457
> 
> 标签：c, visual-studio-2010, linked-list

好吧，首先，我必须承认，我真的没有实现链表，嗯，事实上，我最近没有使用 C。

所以我确信这是一个非常愚蠢的简单错误。

好吧（不知道为什么——但我就是喜欢这个词），我试着刷新一下我的想法，然后我决定实现一些简单的链表。

```
void addToLast(linkedList* head, int data) {
    linkedList* ptr = head; // points to ptr
    while(ptr) /* p ins't null */ ptr = ptr->next;
    // ptr now is null
    ptr = (linkedList*)malloc(sizeof(linkedList)); // we have new node
    if(ptr == NULL) printf("DAFUQ Null\n");
    ptr->num = data;
    ptr->next = NULL;
//  return!
    return;
} 
```

好吧，由于某些奇怪的原因，每次迭代 ptr 的值都是 NULL。

似乎每当我调用`addToLast`函数时，ptr 都保持为空。

我真的不知道为什么——要么我真的很累，要么我只是有一个愚蠢的问题。

好吧，正如我所说 - 我不明白为什么 ptr 保持为空，

我分配了一个新节点 -

```
ptr = (linkedList*)malloc(sizeof(linkedList)); // we have new node 
```

那么为什么 ptr 不保存它的价值呢？

主要&打印功能：

```
void printList(linkedList* list) {
linkedList* p;
putchar('[');
for(p = list;p;) {
    printf("%d, ",p->num);
    p = p->next;
}
putchar(']'); 
```

}

```
int main() {
    // create list
    linkedList *root = (linkedList*)malloc(sizeof(linkedList));
    root->next = NULL;
    addToLast(root,0);
    addToLast(root,5);
    printList(root);
    system("pause");
    return 0; // blet :o
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:01:43.877

在您的函数中，您永远不会分配下一个上一个元素，并且当 ptr 指向 null 时停止循环，您必须在此之前停止

```
void addToLast(linkedList* head, int data) {
    linkedList* ptr = head; // points to ptr
    linkedList* last= null; // new element

    last = (linkedList*)malloc(sizeof(linkedList)); // we have new node
    if(last == NULL) 
        printf("DAFUQ Null\n");

    last ->num = data;
    last ->next = NULL;

    while(ptr->next!=null) 
        ptr = ptr->next;

    ptr->next=last;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:08:59.857

好吧，问题是列表中的最后一个节点仍然指向`NULL`. 您必须保存最后一个节点：

```
void addToLast(linkedList* head, int data) {
    linkedList* ptr = head, *last; // points to ptr
    while(ptr) /* p ins't null */ {
        last = ptr;
        ptr = ptr->next;
    }
    // ptr now is null
    ptr = (linkedList*)malloc(sizeof(linkedList)); // we have new node
    if(ptr == NULL) printf("DAFUQ Null\n");
    ptr->num = data;
    ptr->next = NULL;
    last->next = ptr;
//  return!
    return;
} 
```

或者像那样

```
void addToLast(linkedList* head, int data) {
    linkedList* ptr = head;
    while(ptr->next) ptr = ptr->next;
    ptr->next = (linkedList*)malloc(sizeof(linkedList)); // we have new node
    if(ptr == NULL) printf("DAFUQ Null\n");
    ptr->next->num = data;
    ptr->next->next = NULL;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:13:38.137

```
void addToLast(linkedList **head , int data){
linkedList *temp, *r;
temp = *head;

if(*head == NULL)//list is empty create first node
{
temp = malloc(sizeof(linkedList));
temp->num = data;
temp->next = NULL;
*head = temp;
}
else
{

//go to last node    
while(temp->next!=NULL)
temp = temp->next;

//add node at end
r = malloc(sizeof(linkedList));
r->num = data;
r->next = NULL;
temp->link = r;
}
} 
```

我只是将指针头作为指向指针的指针传递，`linkdList **head`而不是`linkedList *head`

# excel - 运行时错误“91”

> ID：12647844
> 
> 赞同：1
> 
> 时间：2012-09-28T21:51:16.683
> 
> 标签：excel, vba

> 运行时错误“91”：对象变量或未设置块

我的代码是

```
Private Sub Workbook_Open()
  Dim MenuBar As CommandBarButton
  Set MenuBar = CommandBars(Standard).Controls(3)
  MsgBox MenuBar.Caption
End Sub 
```

请帮我解决这个错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:18:18.593

你把`Standard`而不是`"Standard"`. 因此我总是建议使用`Option Explicit`.

如果不使用`"`then`Standard`则被视为变量。

# php - PHP 变量存储 id 但我需要列名才能在 SQL 语句中进行比较

> ID：12647849
> 
> 赞同：2
> 
> 时间：2012-09-28T21:51:41.007
> 
> 标签：php, sql

我有一些下拉框，其中存储县和选区。

当您从下拉列表中选择一个项目并单击搜索按钮时，返回的值是所选县或选区的主键 ID。

```
<option value="<?php htmlout($county['ids']); ?>">
<option value="<?php htmlout($constituency['ids']); ?>"> 
```

这些值已成功返回，因为我可以使用以下方法输出它们：

```
 $countyid = $_GET['county'];
$constituencyid = $_GET['constituency'];

<?php echo $countyid ?>
<?php echo $constituencyid ?> 
```

然后我有一个sql语句如下：

```
 $sqlparams = array();

if($countyid !== '') {
    $sqlparams[] = "county = '$countyid'";
}
if($constituencyid !== '') {
    $sqlparams[] = "constituency = '$constituencyid'";
}

$sql = "SELECT * FROM pt";

if (count($sqlparams) > 0) {
    $sql .= " WHERE " . implode(" AND ", $sqlparams); 
} 
```

然后执行此操作并将结果存储在数组中，所有这些都有效。

但是，问题在于例如以下示例：

```
if($countyid !== '') {
    $sqlparams[] = "county = '$countyid'";
} 
```

我将 'county' 一个 VARCHAR 列与 '$countyid' 一个整数进行比较。

如果有意义的话，我想知道用县名代替 $countyid 变量的最佳方法，以便我将 VARCHAR 与 VARCHAR 进行比较。

如果这很简单，我很抱歉，但我对如何做到这一点感到困惑。

我知道我可以更改下拉列表的值以返回名称，但是后台发生了一些需要返回 id 的事情，我很确定返回 id 是一种很好的做法，因为这是非常灵活的。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:10:37.623

这样做的西方方法是使用[pdo 的参数绑定](http://php.net/manual/en/pdostatement.bindparam.php)：

```
$sql = "SELECT * FROM pt 
    WHERE county = :countyid AND constituency = :constituencyid";

$sth = $dbh->prepare( $sql );
$sth->bindParam(':countyid', $countyid, PDO::PARAM_INT);
$sth->bindParam(':constituencyid', $constituencyid, PDO::PARAM_INT); 
```

您不仅可以定义要绑定的值类型 ( `PDO::PARAM_INT`)，还可以防止 SQL 注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:14:42.870

假设表Counties 具有列名称和countyid：

`$sqlparams[] = "county IN (SELECT name FROM counties WHERE countyid = $countyid)"`

# linq - Linq Lambda 表达式按总计返回订单

> ID：12647850
> 
> 赞同：0
> 
> 时间：2012-09-28T21:51:46.250
> 
> 标签：linq, c#-4.0, lambda

我有一张如下表

```
   顾客  
   ID 1 月 2 月 3 月 4 月 ...... 12 月  
   1 10 12 12 10 .........40   
   2 11 13 12 10 .........42  

```

我想编写 Linq 表达式以按 total(jan+feb...dec) desc 返回 order
我想要类似`customers.OrderbyDesc(p=>Sum(p.jan,p.feb,.p.dec)`.

注意：最后没有总计栏。
如果有一种方法可以将总和投影到临时变量中然后对其进行排序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:02:09.547

当然 - 类似：

```
var ordered = customers.OrderByDescending(p => p.jan + p.feb + p.mar + ...); 
```

你不需要在`Sum`这里使用......只是正常的添加。

# embedded - 是时候通过 9600 波特串行发送 32KB 了？

> ID：12647857
> 
> 赞同：9
> 
> 时间：2012-09-28T21:52:15.390
> 
> 标签：embedded, serial-port, baud-rate

我想知道我的数学是否正确。如果我的波特率为 9600，那么这意味着每秒发送 9600 位，对吗？如果是这样，那么：

```
9600 bit/sec <=> 1000 ms/ 9600 bit = 0.1042 ms/bit 
```

因此，发送 32KB 需要：

```
32,000*(8+2) bits = 320,000 bits -- (8+2) because 8 data bits + 1 start bit + 1 stop bit
320,000 bits*0.1042 ms/bit = 33344 ms = 33.344 sec 
```

那是对的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-29T08:08:40.617

确实，但是通过将位宽的*近似值*相乘，您已经失去了精度，因此将时间指定到小数点后三位是不正确的。

为避免精度损失，请勿使用四舍五入的中间表达式，而是：

```
bytes x bits_per_character / bits_per_second 
```

所以在你的情况下：

```
32000 x 10 / 9600 = 33.333(recurring) seconds. 
```

然而，传统上 32Kb 指的是 32 x 1024 字节，所以在这种情况下：

```
32 x 1024 x 10 / 9600 = 34.1333(recurring) seconds. 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-28T22:54:50.020

如果您需要粗略检查幅度（无论是 3s 还是 30 或 300），请记住 9600 kbps ~ 1KB/秒（如果您有 2 个额外的奇偶校验/停止位，则为 10 位），因此 32KB -> 大约 32 秒。

# java - 正则表达式，字符串操作

> ID：12647862
> 
> 赞同：0
> 
> 时间：2012-09-28T21:52:50.617
> 
> 标签：java, regex

我必须遵循文本格式，我想使用模板提取内容。

> Value{ABC,XYZ...}|Message{这是测试消息}

当我遇到上面的字符串时，我想提取'Value'和'Message'的内容而不用Java解析整个字符串。

正则表达式可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:23:43.410

是的，假设格式没有改变，这可以通过正则表达式实现。

[http://rubular.com/r/R8WIonv6Oj](http://rubular.com/r/R8WIonv6Oj) <- 请点击此链接查看示例。

```
Value\{(.*)\}\|Message\{(.*)\} 
```

有两个匹配组，用于花括号之间的内容。但是，您可以轻松地做到这一点，而无需使用正则表达式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:02:25.013

如果您的字符串始终采用您提到的格式，则以下代码有效...

```
String s = "Value{ABC,XYZ...}|Message{This is test message}";
System.out.println(s.split("value")[0].split("\\{")[1].split("}")[0]); //prints ABC,XYZ...
System.out.println(s.split("Message")[1].split("\\{")[1].split("}")[0]); //prints This is test message 
```

# cocoa-touch - OpenGL设置纹理亮度

> ID：12647863
> 
> 赞同：0
> 
> 时间：2012-09-28T21:52:51.803
> 
> 标签：cocoa-touch, opengl-es, textures, brightness

我对 OpenGL 很陌生：

在我们的（iOS）项目中，我们使用以下方法渲染纹理：

```
 self.effect.texture2d0.name = self.textureInfo.name;
    self.effect.texture2d0.enabled = YES;

    self.effect.transform.modelviewMatrix = self.modelMatrix;

    self.effect.useConstantColor = YES;
    self.effect.constantColor = GLKVector4Make(1, 1, 1, self.alphaValue);

    [self.effect prepareToDraw];

    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glEnableVertexAttribArray(GLKVertexAttribTexCoord0);

    long offset = (long)&_quad;
    glVertexAttribPointer(GLKVertexAttribPosition, 2, GL_FLOAT, GL_FALSE, sizeof(TexturedVertex), (void *) (offset + offsetof(TexturedVertex, geometryVertex)));
    glVertexAttribPointer(GLKVertexAttribTexCoord0, 2, GL_FLOAT, GL_FALSE, sizeof(TexturedVertex), (void *) (offset + offsetof(TexturedVertex, textureVertex)));

    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4); 
```

我现在正在尝试更改 GLKBaseEffect 对象中使用的纹理的亮度。有没有简单的方法来实现这一点？我已经搜索了几个小时的文档，但找不到解决方案。

谢谢你的帮助。

# java - 如何触发调整大小事件？

> ID：12647865
> 
> 赞同：0
> 
> 时间：2012-09-28T21:52:56.077
> 
> 标签：java, gwt

我在下面尝试了这段代码，看起来非常好，但它给了我错误`handler.onResize(this)`并告诉我：

> ResizeHandler 类型中的 onResize(ResizeEvent) 方法不适用于参数（new GwtEvent(){}）

这是我的代码：

```
private void update(){
    this.fireEvent(new GwtEvent<ResizeHandler>(){

        @Override
        public com.google.gwt.event.shared.GwtEvent.Type<ResizeHandler> getAssociatedType() {
            return new Type<ResizeHandler>();
        }

        @Override
        protected void dispatch(ResizeHandler handler) {
            handler.onResize(this);
        }

        });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:34:53.957

您应该传入 a[`new ResizeEvent()`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/event/logical/shared/ResizeEvent.html)并覆盖您需要的方法。ResizeHandler`onResize`需要 a `ResizeEvent`，而不是`GwtEvent`.

# javascript - 我的 Javascript If...else... 函数有什么问题？

> ID：12647868
> 
> 赞同：-1
> 
> 时间：2012-09-28T21:53:15.267
> 
> 标签：javascript, iframe, if-statement

我目前正在建立一个网站，作为我 11 年媒体课程的一部分，但我似乎无法让这个 If...Else... 功能正常工作。这是我的编码。

```
if(ifr.contentDocument.getElementById("ctl00_ctl00_cphBanner_MenuRedesign_BannerAlertsAndOptionsLoginView_BannerAlertsAndOptions_Authenticated_MessagesTextWrapper") != null){
    notify("Personalising site...")
    document.getElementById("loginButton").innerHTML = "Account Connected!";
    document.getElementById("loginButton").onclick=function(){window.location.href="//roblox.com/--place?id=91276386";}
    notify("Account connected successfully");
    hideWheel();
}else{
    notify("Could not connect account");
    hideWheel();
}; 
```

我删除了“if(...){...}else{...};” 从代码中发现它有效，所以我确定故障出在“if(...)”本身。

如果有帮助，ifr 实际上是使用 document.createElement("iframe"); 创建的。iFrame 确实有一个“src”，并且确实显示在显示内容的页面上。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:01:18.463

尝试使用：

`ifr.contentWindow.document`

也可以参考：[如何使用 Javascript 访问 iframe 元素？](https://stackoverflow.com/questions/1452871/how-can-i-access-iframe-elements-with-javascript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:00:03.110

试试这个：

```
var x = document.getElementById("ctl00_ctl00_cphBanner_MenuRedesign_BannerAlertsAndOptionsLoginView_BannerAlertsAndOptions_Authenticated_MessagesTextWrapper");
var y = (x.contentWindow || x.contentDocument);

if(y.document){

    notify("Personalising site...")
    document.getElementById("loginButton").innerHTML = "Account Connected!";
    document.getElementById("loginButton").onclick=function(){window.location.href="//roblox.com/--place?id=91276386";}
    notify("Account connected successfully");
    hideWheel();

}
else{

    notify("Could not connect account");
    hideWheel();

}; 
```

您尝试访问的 iframe 和您尝试访问的页面是否在同一个域上？如果它在另一个域上，由于跨域封锁，您无法访问它！

我也对那个长ID感到惊讶，那个ID正确吗？

# jquery - 更改 a 的属性 和带有 jquery 的选项我想根据下拉菜单中选择的选项更改 div 的可见性，我认为这样的事情会起作用 <select><option onclick="hideButton();" value="A">A</option> <option onclick="showButton();" value="B">B</option> <option value="A">A</option> <option value="B">B</option> <option value="C">C</option></select>  于 2012-09-28T22:05:29.020 回答 This answer is useful 0 您可以决定option必须采取的行动： html: <select> <option data-visibility="hide" value="A">A</option> <option data-visibility="show" value="B">B</option> <option data-visibility="show" value="C">C</option> </select> JS（jQuery）： $('select').bind('change', function(event) { var method = $(this).find('option:selected').data('visibility'); $('.button')[method]('slow'); }); 于 2012-09-28T22:10:54.680 回答 Related 1 android - Android：调整缩放以包含所有标记 0 android - 从 Html 字符串和图像问题设置文本的 Listview 5 c# - C# TextBox 中的负数 4 java - 通过java将文件从Windows机器复制到另一台Windows机器 3 variables - 如何在 Powershell 中将 $size 变量从字节转换为 GB？ 1 c# - 使用 nhibernate 连接两个表 2 java - 动作抛出自定义异常但未在过滤器中捕获 1 php - 获取谷歌文档作为downloadUrl 0 ios - PJSIP 错误 pjsua_call_media_init 1 asp.net-mvc-4 - 编译 asp.net MVC 4 视图/编译时出错，不仅在第一次访问时 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：12647872
> 
> 赞同：1
> 
> 时间：
> 
> 标签：jquery, forms, select, option

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:57:12.417

尝试这个：

```
 $('select').change(function(){
    if($(this).val() == 'A'){
      hideButton();
    }else{
      showButton();
    }
  }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:05:29.020

[检查小提琴](http://jsfiddle.net/sushanth009/t3Rbv/1/)

```
 $(function() {
        $('select').on('change', function() {

            if ($(this).val() == 'A') {
                $('.button').hide('slow');
            }
            else {
                $('.button').show('slow');
            }
        }).change();
    });​

<select>
<option value="A">A</option>
<option value="B">B</option>
<option value="C">C</option>
</select>
<input class="button" name="button" type="submit" value="delete" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:10:54.680

您可以决定`option`必须采取的行动：

html:

```
<select>
   <option data-visibility="hide" value="A">A</option>
   <option data-visibility="show" value="B">B</option>
   <option data-visibility="show" value="C">C</option>
</select> 
```

JS（jQuery）：

```
$('select').bind('change', function(event) {

    var method = $(this).find('option:selected').data('visibility');
    $('.button')[method]('slow');

}); 
```

# iphone - 不理解重用表格视图单元格

> ID：12647873
> 
> 赞同：0
> 
> 时间：2012-09-28T21:53:45.833
> 
> 标签：iphone, xcode, uitableview

我进行了重大更改并为 TableView 单元设置了一个自定义类。

细胞.h

```
#import <UIKit/UIKit.h>

@interface Cell : UITableViewCell
@property (nonatomic, retain) UILabel *month;
@property (nonatomic, retain) UILabel *date;
@end 
```

细胞.m

```
#import "Cell.h"

@implementation Cell
@synthesize date, month;
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code
    }
    return self;
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}
- (void)layoutSubviews {
    [super layoutSubviews];
    self.imageView.frame = CGRectMake(1,1,69,69);

    float limgW =  self.imageView.image.size.width;
    if(limgW > 0) {
        UIFont *cellFont3 = [UIFont fontWithName:@"ArialRoundedMTBold" size:9];
        UIFont *cellFont4 = [UIFont fontWithName:@"ArialRoundedMTBold" size:18];
        self.textLabel.frame = CGRectMake(82,0,228,53);
        self.detailTextLabel.frame = CGRectMake(82, 20, 228, 53);
        self.month = [[UILabel alloc] initWithFrame:CGRectMake(8, 10, 53, 21)];
        self.month.font = cellFont3;
        self.month.textAlignment = UITextAlignmentCenter;
        self.month.backgroundColor = [UIColor clearColor];

        self.date = [[UILabel alloc] initWithFrame:CGRectMake(11, 21, 50, 45)];
        self.date.backgroundColor = [UIColor clearColor];
        self.date.font = cellFont4;
        self.date.textAlignment = UITextAlignmentCenter;

    }
}
@end 
```

然后在我的 TableView 代码中：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    Cell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[Cell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];

    }

    RSSEntry *entry = [_allEntries objectAtIndex:indexPath.row];

    NSDateFormatter * dateFormatter = [[[NSDateFormatter alloc] init] autorelease];
    [dateFormatter setTimeZone:[NSTimeZone localTimeZone]];
    [dateFormatter setTimeStyle:NSDateFormatterShortStyle];
    [dateFormatter setDateStyle:NSDateFormatterShortStyle];

    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"MM"];
    NSString *monthfromdate = [formatter stringFromDate:entry.articleDate];
    NSLog(@"%@", monthfromdate);
    [formatter release];

    NSDateFormatter *formatter2 = [[NSDateFormatter alloc] init];
    [formatter2 setDateFormat:@"dd"];
    NSString *datefromdate = [formatter2 stringFromDate:entry.articleDate];
    NSLog(@"%@", datefromdate);
    [formatter2 release];

    if ([monthfromdate isEqualToString:@"01"]) {
        self.currentmonth = @"January";
    }
    if ([monthfromdate isEqualToString:@"02"]) {
        self.currentmonth = @"February";
    }
    if ([monthfromdate isEqualToString:@"03"]) {
        self.currentmonth = @"March";
    }
    if ([monthfromdate isEqualToString:@"04"]) {
        self.currentmonth = @"April";
    }
    if ([monthfromdate isEqualToString:@"05"]) {
        self.currentmonth = @"May";
    }
    if ([monthfromdate isEqualToString:@"06"]) {
        self.currentmonth = @"June";
    }
    if ([monthfromdate isEqualToString:@"07"]) {
        self.currentmonth = @"July";
    }
    if ([monthfromdate isEqualToString:@"08"]) {
        self.currentmonth = @"August";
    }
    if ([monthfromdate isEqualToString:@"09"]) {
        self.currentmonth = @"September";
    }
    if ([monthfromdate isEqualToString:@"10"]) {
        self.currentmonth = @"October";
    }
    if ([monthfromdate isEqualToString:@"11"]) {
        self.currentmonth = @"November";
    }
    if ([monthfromdate isEqualToString:@"12"]) {
        self.currentmonth = @"December";
    }

    NSString *currentday = datefromdate;

    NSString *articleDateString = [dateFormatter stringFromDate:entry.articleDate];
    UIFont *cellFont = [UIFont fontWithName:@"ArialRoundedMTBold" size:15];
    UIFont *cellFont2 = [UIFont fontWithName:@"ArialRoundedMTBold" size:12];

    cell.imageView.image = [UIImage imageNamed:@"calendar1.png"];
    cell.imageView.contentMode = UIViewContentModeScaleAspectFit;

    cell.detailTextLabel.text = [NSString stringWithFormat:@"%@ - %@", articleDateString, entry.blogTitle];
    cell.detailTextLabel.textColor = [UIColor grayColor];
    cell.detailTextLabel.font = cellFont2;

    cell.textLabel.text = entry.articleTitle;
    cell.textLabel.font = cellFont;
    cell.month.text = currentmonth;
    cell.date.text = currentday;
    return cell;
} 
```

这解决了重复或标签被写在彼此之上的问题，但只有 cell.textLabel 显示任何内容。detailTextLabel 或我设置的其他 2 个标签上没有显示任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:05:20.113

你的方法不正确。当单元被重用时，这并不一定意味着索引路径 {0,1} 上的单元将在下次该特定索引路径单元变为可见时被重用。将使用具有相同标识符的单元格，它可能包含不同索引路径上不同单元格的数据。您的方法应该是根据出队后单元格的存在情况对单元格进行出队或初始化，但始终根据索引路径在单元格上分配数据。

几点建议：不要在 cellForRowAtIndexPath 方法中创建/释放 NSDateFormatter 对象。它会给你带来性能问题。此外，出于组织目的，请继承 UITableViewCell 并正确创建接口。即时添加它们是混乱和混乱的。

另外，看看你想要做什么，你可能想看看 NSDateFormatter 的 monthSymbols 和 weekdaySymbols 方法，以及[NSDateComponent 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateComponents_Class/Reference/Reference.html)。您可以获得月份和日期信息，而不是使用 12 个“ifs”来获取月份。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T07:41:05.917

将其移至答案，因为我认为这可能是解决方案（希望如此）。

我认为您的标签显示不正确，因为您在布局子视图方法中有它们。当您执行诸如调用 setFrame、addSubview 或调整视图大小之类的操作时，会自动调用此方法。您没有在 cellForRowAtIndexPath 中进行任何这些调用，因此操作系统不会自动进行布局子视图调用（我希望这是有道理且正确的）。如果我是你，我会有一个单独的 XIB 用于表格单元格，它更容易管理。

# ms-word - Office 2010 的 WordprocessingML

> ID：12647875
> 
> 赞同：0
> 
> 时间：2012-09-28T21:54:07.597
> 
> 标签：ms-word, xsd, ms-office

我有三个文件，一个 xml 模板、一个 xsl 转换文件和一个 xsd 数据文件，用于自动归档表单。它大概是使用 WordprocessingML 创建的。从网上看，WordprocessingML 似乎只在 Office 2003 中，而不是在 2010 年或更高版本中，或者缺少什么？

以后的办公室是否对此提供支持，而我只是想念它？或者微软是否创造了更好的方法来做到这一点，如果是这样，解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T22:51:48.530

Word 2003 有自己的 XML 格式；Word 2007、2010 及更高版本使用 WordML。

有关 Word 2010 中的自定义转换，请参阅[http://www.itechtalk.com/thread9012.html](http://www.itechtalk.com/thread9012.html)

# python - Python最短距离

> ID：12647878
> 
> 赞同：0
> 
> 时间：2012-09-28T21:54:25.540
> 
> 标签：python, map, shortest

我想编写一个程序，返回从 A 点到 E 点的最短距离。我编写了代码来获取长度，但我不知道如何实际获取这些点。

![在此处输入图像描述](../Images/2a0e66ead72e9fe5416e4e7cf1bbb9eb.png)

```
d  = {("A","A"):0, ("A","B"):1, ("A","C"):3, ("A","D"):7 , ("A","E"):101,
           ("B","A"):101, ("B","B"):0, ("B","C"):42, ("B","D"):6, ("B","E"):27,
           ("C","A"):101, ("C","B"):101, ("C","C"):0, ("C","D"):2, ("C","E"):13,
           ("D","A"):101, ("D","B"):101, ("D","C"):101, ("D","D"):0, ("D","E"):5,
           ("E","A"):101, ("E","B"):101, ("E","C"):101, ("E","D"):101, ("E","E"):0
    }

def shortestPath(Cities,Distances):
'''Returns the length of the shortest path from the first city in the list to the last city in the list, using only cities that appear in that list.'''
    if len(Cities)==1: return 0
    else: return min( map( lambda n: (Distances[Cities[0],Cities[n]] + shortestPath(Cities[n:],Distances)), range(1,len(Cities))) ) 
```

输入的答案：shortestPath(["A","B", "C", "D", "E"],d) 是 10。但程序也应该输出距离，所以答案实际上应该是为 [10, ["A", "C", "D", "E"]]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:44:29.077

如果您决定将其保留在一行中，则可以对代码进行一些小的更改：

```
def track_past_city(x,y):
    return (x[0]+y[0],x[1:]+y[1:]) #0 is how far you've gone, #[1:] is where you've been

def shortestPath(Cities,Distances):
    if len(Cities)==1: return 0, Cities[0]
    else: return min( map( lambda n: (track_past_city((Distances[Cities[0],Cities[n]],Cities[0]),shortestPath(Cities[n:],Distances))), range(1,len(Cities))) )

shortestPath(["A","B", "C", "D", "E"],d)
# (10, ('A', ('C', ('D', 'E')))) 
```

我*不太*确定如何在哪里发生错误的元组添加，但是从这里你应该能够调整你自己的解决方案......

注意：这带有一个健康警告，你不应该将所有代码写在一行上，它很难阅读，很难调试，而且通常是个坏主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:19:29.910

看起来像一个典型的最短路径问题。显而易见的方法是使用 dijkstra，但也有更酷的算法。例如，我在 codegolf 会话中破解了这个：

```
G,S,T=input();J={n:9e9if n!=T else 0for n in G}
while J[S]>1e9:J={n:0if n==T else min(c+J[d]for d,c in G[n].items())for n in G}
while S!=T:print S;S=min((c+J[d],d)for d,c in G[S].items())[1] 
```

不过，您必须更改图形表示，但它会为此输入输出正确的最短路径（您的解释图）：

```
{'A': {'C': 3, 'B': 1, 'D': 7}, 'C': {'A': 3, 'B': 42, 'E': 13, 'D': 2}, 'B': {'A': 1, 'C': 42, 'E': 27, 'D': 6}, 'E': {'C': 13, 'B': 27, 'D': 5}, 'D': {'A': 7, 'B': 6, 'E': 5}}, 'A', 'E' 
```

所以......阅读图算法，它们并不难。如果你拒绝这样做：祝你好运，理解我的 codegolfed fixpoint 算法。

# javascript - 根据文档宽度制作 HTML 元素

> ID：12647881
> 
> 赞同：0
> 
> 时间：2012-09-28T21:54:48.837
> 
> 标签：javascript, jquery, responsive-design

当文档宽度小于 470 时，我正在尝试为移动菜单添加一个按钮。

当页面最初加载时它会这样做，但是当我在浏览器上弄乱实际文档的宽度时，它不会与文档一起改变。我如何实现这一目标？

按钮应该在宽度小于 470 时出现，并且在页面宽度大于 470 时消失，基本上。

这是我的代码。

```
 var width = $(document).width();
        if (width < 470) {
            $("<button id='menu'>Menu</button>").insertAfter("#navigation a img");
        } else {
            $("<button id='menu'></button>").hide();
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:57:05.910

将函数/检查绑定到`resize`窗口上的方法：

```
$(window).resize(
    function(){
        /* do stuff in here */
    }); 
```

[简单的概念验证](http://jsfiddle.net/davidThomas/DL93h/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T21:57:19.717

每次窗口大小更改时检查文档的宽度。

```
function onresize(){
   var width = $(document).width();
   if (width < 470) {
        if($("#menu").length){
               $("#menu").show();
         }
         else{
                $("<button id='menu'>Menu</button>").insertAfter("#navigation a img");
         }
    } else {
        $("#menu").hide();
    }
}

onresize()//first call
$(window).resize(onresize); 
```

# c# - 为什么在 DGV 中按“Shift”键会引发异常？

> ID：12647883
> 
> 赞同：0
> 
> 时间：2012-09-28T21:54:54.197
> 
> 标签：c#, winforms, datagridview, shift

我在派生自 DataGridView 的自定义类中有此代码：

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    if (char.IsNumber(Convert.ToChar(keyData)) || 
        char.IsControl(Convert.ToChar(keyData)) || 
        (keyData >= Keys.NumPad0 && keyData <= Keys.NumPad9) ||
        (keyData == Keys.Up) ||
        (keyData == Keys.Down) ||
        (keyData == Keys.Left) ||
        (keyData == Keys.Right) ||
        (keyData == Keys.Home) ||
        (keyData == Keys.PageDown) ||
        (keyData == Keys.PageUp) ||
        (keyData == Keys.Space) ||
        (keyData == Keys.Back) ||
        (keyData == Keys.Decimal))
    {
        return false;
    }
    return true;
} 
```

我可以输入数据（数字和.），并从一个单元格到另一个单元格，但是如果我按“Shift”键，我会得到，*“System.OverflowException 未被用户代码处理 Message=Value 太大或太小一个字符。Source=mscorlib StackTrace: at System.Convert.ToChar(Int32 value)..."*

我认为这是导致问题的行：

```
char.IsControl(Convert.ToChar(keyData)) 
```

...但是为什么 Shift 有问题，我应该怎么做才能让它忽略 Shift 键（用户没有理由按下 DGV 中的 Shift 键）。

## 更新

我必须承认我不太理解 quetzalcoatl 的回答，但我试图以这种方式应用它：

```
Keys specials = keyData & Keys.Modifiers; 
Keys keycode = keyData & ~Keys.Modifiers;

if (char.IsNumber(Convert.ToChar(keyData)) || 
    //char.IsControl(Convert.ToChar(keyData)) || 
    //(keyData == specials) || <-- didn't work
    //(keyData == keycode) ||  <-- didn't work
    (keyData != specials) ||
    (keyData != keycode) ||
    . . . 
```

...并且仍然得到同样的错误。我如何应用他提供的信息来解决问题？

## 更新 2

我仍在为此苦苦挣扎。

我试过这个：

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    Keys keycode = keyData & ~Keys.Modifiers;

    if (keycode >= Keys.D0 && keycode <= Keys.D9 ||          
        keycode >= Keys.NumPad0 && keycode <= Keys.NumPad9 ||
        (keycode == Keys.Up) ||
        (keycode == Keys.Down) ||
        (keycode == Keys.Left) ||
        (keycode == Keys.Right) ||
    (keyData == Keys.Tab) ||
        (keycode == Keys.Tab) ||
        (keycode == Keys.Home) ||
        (keycode == Keys.PageDown) ||
        (keycode == Keys.PageUp) ||
        (keycode == Keys.Space) ||
        (keycode == Keys.Back) ||
        (keycode == Keys.Decimal))
    {
        return false;
    }
    return true;
} 
```

...和这种方法：

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
        Keys keycode = keyData & ~Keys.Modifiers;

        bool isDigit = keycode >= Keys.D0 && keycode <= Keys.D9 ||
                       keycode >= Keys.NumPad0 && keycode <= Keys.NumPad9;
        bool isControl = (keyData & Keys.Modifiers) != Keys.None;

        if (isDigit ||
            isControl ||
            (keyData == Keys.Up) ||
            (keyData == Keys.Down) ||
            (keyData == Keys.Left) ||
            (keyData == Keys.Right) ||
        (keyData == Keys.Tab) ||
            (keyData == Keys.Home) ||
            (keyData == Keys.PageDown) ||
            (keyData == Keys.PageUp) ||
            (keyData == Keys.Space) ||
            (keyData == Keys.Back) ||
            (keyData == Keys.Decimal))
        {
            return false;
        }
        return true;
} 
```

它们都解决了导致溢出的 Shift 键，但它们都防止输入小数。我不明白这一点，因为 Decimal 被（据说）明确允许。其他所有明确检查的内容都是允许的（Home、PageUp、PageDown 等）——它只是“。” 被禁止进入的角色。

## 更新 3

使用上面的第二种方法并将“Keys.Decimal”替换为“Keys.OemPeriod”可以：

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    Keys keycode = keyData & ~Keys.Modifiers;

    bool isDigit = keycode >= Keys.D0 && keycode <= Keys.D9 ||
                   keycode >= Keys.NumPad0 && keycode <= Keys.NumPad9;
    bool isControl = (keyData & Keys.Modifiers) != Keys.None;

    if (isDigit ||
        isControl ||
        (keyData == Keys.Up) ||
        (keyData == Keys.Down) ||
        (keyData == Keys.Left) ||
        (keyData == Keys.Right) ||
        (keyData == Keys.Home) ||
        (keyData == Keys.Tab) ||
        (keyData == Keys.PageDown) ||
        (keyData == Keys.PageUp) ||
        (keyData == Keys.Space) ||
        (keyData == Keys.Back) ||
        (keyData == Keys.OemPeriod))
    {
        return false;
    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:03:11.737

这是因为您`Keys keyData`以错误的方式将 in 转换为 Char 。Convert.ToChar 不处理。

Keys 枚举包含 `` 掩码，用于过滤掉所有修饰符，如 shift、alt、control：

```
Keys specials = keyData & Keys.Modifiers;
Keys keycode = keyData & ~Keys.Modifiers; 
```

现在，`keycode`恰好等于 Keys 中定义的正常 A/B/C/... 值之一，并且`specials`是由 Control/Alt/Shift 修饰符组成的位集。

错误的确切原因是，虽然一些“低键值”（a、b、c、..z、0-9 等）实际上与 ASCII 码相等/相似，但“修饰符”是提供一个非常高的整数，按位或运算到基本键码：

```
Keys justA = Keys.A;
Keys theAandShift = Keys.A | Keys.Shift; 
```

等等。这导致“A with Shift”在 ASCII 甚至 Unicode 的意义上具有完全荒谬的数值......这就是为什么你必须首先切断修饰符代码！

编辑：

```
Keys specials = keyData & Keys.Modifiers;
Keys keycode = keyData & ~Keys.Modifiers;

bool withShift = specials.HasFlag( Keys.Shift );
bool withControl = specials.HasFlag( Keys.Control );
bool withAlt = specials.HasFlag( Keys.Alt );

if(keycode == Keys.F1 && !withShift && !withControl && !withAlt)
    ; // it was plain F1 with no specials

else if(keycode == Keys.VolumeUp)
    ; // it was 'volume-up' key with any or none of the modifiers

else if(keycode >= Keys.A && keycode <= Keys.Z && withControl)
    ; // it was CTRL+Letter

else if(keycode >= Keys.D0 && keycode <= Keys.D9 && withShift)
    ; // it was SHIFT+Digit 
```

等等

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T22:01:15.973

`Keys`不能转换成`char`这样的。如果您查看[Keys](http://msdn.microsoft.com/en-us/library/system.windows.forms.keys%28v=vs.71%29.aspx)`Shift`枚举，它的值为 65536，超出了`char`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T23:40:21.517

不要将 a 转换`Keys`为`char`. 这不起作用。测试它是否是一个数字

```
Keys code = keyData & ~Keys.Modifiers;

bool isDigit = code >= Keys.D0 && code <= Keys.D9 ||
               code >= Keys.NumPad0 && code <= Keys.NumPad9 
```

测试它是否是一个控制键

```
bool isControl = (keyData & Keys.Modifiers) != Keys.None; 
```

# javascript - 如何将绑定变量传递给 ng-click 函数？

> ID：12647891
> 
> 赞同：72
> 
> 时间：2012-09-28T21:55:36.950
> 
> 标签：javascript, angularjs

我有一个简单的删除按钮，可以接受字符串或数字，但不接受 ng-model 变量（不确定这是否是正确的术语）。

```
<button class="btn btn-danger" ng-click="delete('{{submission.id}}')">delete</button> 
```

生成：

```
<button class="btn btn-danger" ng-click="delete('503a9742d6df30dd77000001')">delete</button> 
```

但是，当我单击时没有任何反应。如果我对变量进行硬编码，那么它就可以正常工作。我假设我只是没有以“Angular”的方式做事，但我不确定那是什么:)

这是我的控制器代码：

```
$scope.delete = function ( id ) {
    alert( 'delete ' + id );
} 
```

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-09-28T22:34:44.697

您不需要在 中使用大括号 ( `{{}}`) `ng-click`，试试这个：

```
<button class="btn btn-danger" ng-click="delete(submission.id)">delete</button> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-24T13:22:00.347

该**[`ngClick`](https://docs.angularjs.org/api/ng/directive/ngClick)**指令绑定一个**表达式**。它直接执行 Angular 代码（如[`ngIf`](https://docs.angularjs.org/api/ng/directive/ngIf)、[`ngChange`](https://docs.angularjs.org/api/ng/directive/ngChange)等），而不需要`{{ }}`.

```
angular.module('app', []).controller('MyCtrl', function($scope) { 
    $scope.submission = { id: 100 };

    $scope.delete = function(id) {
        alert(id + " deleted!");
    }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script>

<div ng-app="app" ng-controller="MyCtrl">
    <button ng-click="delete(submission.id)">Delete</button>
</div>
```

# jquery - RSS 提要 - 排序和过滤

> ID：12647893
> 
> 赞同：0
> 
> 时间：2012-09-28T21:55:50.757
> 
> 标签：jquery, json, rss, jsonp

[http://latimesblogs.latimes.com/alltherage/atom.xml](http://latimesblogs.latimes.com/alltherage/atom.xml)

当我在 IE9 中查看上面的 RSS 提要时，我会自动在我的页面右上角看到一个漂亮的排序和过滤界面。Firefox 不提供此功能。

我正在开发一个显示 RSS 提要数据的自定义网页，并且我想以编程方式提供排序和过滤功能，以便它在大多数（所有）浏览器中都可用。

我使用 jQuery $.each 方法编写了一个简单的页面来循环 json 并显示数据。到目前为止，我的渲染非常像 IE 和 FF，没有我在 IE 中获得的排序和过滤器。我不确定如何使用该排序/过滤功能。我将不胜感激有关如何完成此任务的任何建议。

提前致谢。

# ios - 自定义表格视图标题

> ID：12647895
> 
> 赞同：0
> 
> 时间：2012-09-28T21:56:03.067
> 
> 标签：ios, objective-c, iphone

如何自定义表格视图的导航栏？一个示例（不限于）将是 Google Drive 的黑条。此外，其他应用程序具有带图像的导航栏！我可以自定义哪些其他属性以及如何自定义？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:03:31.503

你可以改变颜色

```
[self.navigationController.navigationBar setTintColor:[UIColor colorWithRed:153.0f/255.0f green:153.0f/255.0f blue: alpha:1]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T21:58:29.257

这是一个重复的问题，也是一个常见问题/回答问题：

[自定义 UINavigationBar 背景](https://stackoverflow.com/questions/704558/custom-uinavigationbar-background)

# excel - 任何编辑的受保护工作表警告

> ID：12647902
> 
> 赞同：1
> 
> 时间：2012-09-28T21:56:48.170
> 
> 标签：excel, vba, password-protection

希望能对 Excel 2010 有所帮助。

我有三张可见的床单。在 Workbook Open 上，vba 密码保护三个工作表中的每一个。

*现在，每当我对任何工作表中的任何未锁定*单元格进行更改时，都会弹出 4 个受保护工作表警告弹出窗口。那个说单元格被锁定并且您必须取消保护才能编辑的那个？除了我没有编辑锁定的单元格之外，这一切都很好。我正在编辑其他工作表中未锁定的单元格！

有没有人有过这样的经历？我玩过，其中两个可以归因于两张纸中的每一张。也就是说，当我只保护第一张时，我没有弹出窗口，当我只保护第二张时，我得到 2，当我只保护第三张时，我得到 2。

取出公式并没有什么不同。

这是锁定的代码：

```
For Each wSheet In Worksheets

    wSheet.Unprotect Password:="JMP_DST_Lock"

    If wSheet.Visible = True Then
        wSheet.Protect Password:="JMP_DST_Lock", UserInterFaceOnly:=True
        wSheet.EnableOutlining = True
    End If

Next wSheet

ThisWorkbook.Protect Password:="JMP_DST_Lock" 
```

非常感谢您的帮助。

编辑：原来组合框是错误的原因。如果链接的单元格被锁定，则工作表计算的任何时间（自动计算时的任何更改）都会导致警告。现在，我有代码可以取消保护每个组合框 GotFocus 上的工作表，但除此之外，这些都出现了。

有中间立场吗？一种在不弹出这些警告的情况下保持链接单元格锁定的方法？一种确保组合框在选择时点击链接单元格的方法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:21:01.230

你的逻辑似乎是错误的。您正在取消保护工作表，然后保护可见工作表，然后保护整个工作簿（在最后一个代码行中）。

尝试这样的事情（未经测试）：

```
For Each wSheet In Worksheets
  If wSheet.Visible = True Then
    wSheet.Protect Password:="JMP_DST_Lock", UserInterFaceOnly:=True
    wSheet.EnableOutlining = True
  End If
Next wSheet 
```

如果工作簿与处于受保护状态的工作表一起保存，请将其更改为以下内容：

```
For Each wSheet In Worksheets
  If wSheet.Visible = False Then
    wSheet.UnProtect Password:="JMP_DST_Lock"
  End If
Next wSheet 
```

# excel - 从另一个列表中减去一个 CSV 列表？

> ID：12647905
> 
> 赞同：1
> 
> 时间：2012-09-28T21:56:59.537
> 
> 标签：excel, csv, numbers, seo

我有一个巨大的使用 Screaming Frog 生成的断开链接列表，并开始修复其中的很多。我通过 Screaming Frog 运行 csv 文件以查看我留下了哪些断开的链接，所以现在我有 2 个 CSV 文件。如何从旧列表中减去较新的列表，以便查看已修复的链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-05T17:59:35.303

以下方法假设：

答：所有损坏的链接都在 oldfile 中。B: 一些损坏的链接在新文件中。C：共享行是完全重复的。

```
sort newfile oldfile | uniq -d > filesThatAreStillBroken 
```

或者

```
sort  newfile oldfile | uniq -u > filesThatAreFixed 
```

排序将文件合并到一个排序列表中。不管是 newfile 还是 oldfile 在前都没有关系。

uniq -d 只输出多次出现的行。由于它们在两个列表中，它们仍然被破坏。

uniq -u 只有行是唯一的。

注意：这不会捕获您在修复旧错误时引入的新错误。新错误只会出现在新文件中，因此会在第二次调用中被错误地报告为已修复，而在第一次调用中根本不会报告。

类型

```
man sort
man uniq 
```

有关这两个命令行实用程序的更多详细信息。

如果你在 windows 机器上，你可以安装 cygwin 环境，或者 windows 现在可能有一个 posix 命令集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:05:15.760

将两个 CSV 文件都导入到 excel 中。

将公式添加到较大列表的 B 列中的单元格中：`=COUNTIF(Sheet2!A:A,A1)`

这将使您计算该单元格在另一个列表中出现的次数。

现在您只需删除任何计数 > 0 的内容。

提示：要轻松删除行：添加标题行，打开自动过滤器，取消选择计数为 0，删除行，关闭自动过滤器。（或者，如果您不介意顺序混乱，您可以对列表进行排序）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:20:10.527

在 Excel 中试试这个函数：

```
=IF(COUNTIFS($B$1:$B$6, A1), "Borked", "Fixed") 
```

只需确保 A 值指向较小列表中的某些内容（仍然断开），并且 B 范围涵盖原始断开链接集

# android - 是否可以使用 IntelliJ 的 --custom-package 标志？

> ID：12647912
> 
> 赞同：0
> 
> 时间：2012-09-28T21:57:46.560
> 
> 标签：android, intellij-idea

`aapt`似乎有`--custom-package`一面旗帜。是否可以配置 IntelliJ 的 Android 方面以便可以使用此标志？查看项目结构 GUI，我得到的印象并非如此。

虽然我确实看到文件`CUSTOM_COMPILER_MANIFEST`中列出了它`.iml`，但我没有看到它是如何冒泡到 UI 中的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T07:54:36.790

目前不支持，请[投票支持此功能请求](http://youtrack.jetbrains.com/issue/IDEA-71391)。

# html - 如果选中输入，则设置父背景

> ID：12647913
> 
> 赞同：1
> 
> 时间：2012-09-28T21:58:00.837
> 
> 标签：html, css

我的 html 标记看起来像这样..

```
<div class="siteCheckboxes">
   <label for="filterAll">
      All <input name="filterAll" type="checkbox" id="filterAll" checked="checked"  />
   </label>
</div> 
```

我需要知道如何更改复选框所在的父标签的颜色。我尝试过...

```
input[type="checkbox"]:checked > label{ background-color:#F00; } 
```

为了更改父标签的背景颜色，但这不起作用。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:59:13.300

CSS 不能根据子级修改父级。这是一种单向`parent -> child`访问路径。

-编辑：

正如 Little Big Bot 在评论中指出的那样，有兄弟选择器 (`+`和`~`) 可用，但尚未完全支持。如果您按照您的说明嵌套元素，它们将无济于事。无论如何，它们是：

[http://reference.sitepoint.com/css/adjacentsiblingselector](http://reference.sitepoint.com/css/adjacentsiblingselector)

[http://reference.sitepoint.com/css/generalsiblingselector](http://reference.sitepoint.com/css/generalsiblingselector)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T22:01:10.180

这不能用严格的 CSS 来完成。CSS（甚至不是 CSS 3）没有“父”选择器。

更多信息：[http ://css-tricks.com/parent-selectors-in-css/](http://css-tricks.com/parent-selectors-in-css/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T05:40:20.123

如果您使用标记，其中`input`and`label`元素是相邻的兄弟元素并且没有嵌套并且标签出现在复选框之后（这是更常见的用法，因此更好的可用性），您可以在纯 CSS 中执行此操作：

```
<input name="filterAll" id="filterall" type="checkbox" id="filterAll" 
       checked="checked"  />
<label for="filterAll">All</label> 
```

然后你可以使用相邻的兄弟选择器`+`：

```
input[type="checkbox"]:checked + label { background-color:#F00; } 
```

# php - 用阿拉伯语将html转换为pdf

> ID：12647917
> 
> 赞同：7
> 
> 时间：2012-09-28T21:58:33.950
> 
> 标签：php, pdf

我需要用 php 从 html 生成一个 pdf 文件，我使用 html2pdf 但它不支持阿拉伯语。我需要一些易于使用的东西。

并提前感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T22:05:40.233

您可以尝试使用[**TCPDF**](http://www.tcpdf.org/)，我过去使用过它并完成了工作，它列出的功能之一是：

*   UTF-8 Unicode 和从右到左的语言

所以我想这涵盖了阿拉伯语。

**更新**：
是的，他们支持它，甚至有一个在线示例：

RTL 文档上的波斯语和阿拉伯语：[PDF](http://www.tcpdf.org/examples/example_018.pdf)及其[PHP 源代码](http://www.tcpdf.org/examples/example_018.phps)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-27T07:16:49.023

以下是使用阿拉伯语的示例。

```
 <?php

include("MPDF57/mpdf.php");
$mpdf=new mPDF('utf-8'); 

$html = '
<p> قال الرئيس الامريكي جورج بوش في حديث متلفز في الذكرى الرابعة للغزو الامريكي للعراق ان الاولوية حاليا لاعادة الامن للعراق.</p>
<p> هل ستسفر الجهود الدبلوماسية الجارية عن حلول؟ وكيف تنظر للاتهامات لبعض هذه الدول بالتدخل في الشأن العراقي، والتورط في دعم عمليات العنف؟ والى اي مدى يبدو الوضع في العراق انعكاسا للصراعات الإقليمية في المنطقة؟</p>
<p> وادان البيت الابيض "بشدة" تفجير ايلات فيما اعربت وزارة الخارجية الروسية عن "ادانتها الشديدة" للحادث" واصفة اياه بـ"المتطرف" الذي استهدف "مدنيين مسالمين".</p>

test
';

 $html = iconv("windows-1256","UTF-8//IGNORE",$html);
$mpdf=new mPDF('ar','A4','','',32,25,27,25,16,13); 
// From mPDF 5.1 onwards you must set:
$mpdf->SetDirectionality('rtl');
$mpdf->mirrorMargins = true;
//$mpdf->SetDisplayMode('fullpage');
//$mpdf->WriteHTML($stylesheet,1);  // The parameter 1 tells that this is css/style only and no body/html/text
$mpdf->WriteHTML($html);

$mpdf->Output(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-02T12:54:16.393

试试[mPDF](http://mpdf1.com)，它非常易于使用，并且惊人地支持 RTL 语言，如阿拉伯语、希伯来语、波斯语/波斯语、乌尔都语和普什图语。[检查手册](https://mpdf.github.io)。

# linux - 在不挂起的情况下将“tail -f”管道传输到 awk

> ID：12647919
> 
> 赞同：3
> 
> 时间：2012-09-28T21:58:42.317
> 
> 标签：linux, awk

像这样的东西会挂起：

```
tail -f textfile | awk '{print $0}' 
```

while`grep`使用而不是 awk 时不会挂起。

我的实际意图是仅使用标准命令为某些日志输出添加颜色；`tail -f`但是，管道似乎`awk`不起作用。我不知道这是否是缓冲区问题，但我尝试了一些不起作用的方法，例如：

```
awk '{print $0;fflush()}' 
```

以及[如何将 tail -f 导入 awk](https://stackoverflow.com/questions/11469959/how-to-pipe-tail-f-into-awk)

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T19:26:22.030

我在mawk遇到了几乎完全相同的问题。我认为这是由于 mawk 刷新其缓冲区的方式，当我切换到 gawk 时问题就消失了。希望这会有所帮助（我知道有点晚了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:12:37.737

我试过这个命令：

```
tail -f test | awk '{print $0;}' 
```

它不会挂起。每次我在`test`文件中添加内容时，Awk 都会打印新值。

```
echo "test" >> test 
```

我认为您只是忘记了命令中的引号，因为您写道*（编辑：好吧，在您的帖子被编辑之前）*：

```
tail -f textfile | awk {print $0}' 
```

代替 ：

```
tail -f textfile | awk '{print $0}' 
```

# java - Amazon AWS S3 如何跟踪来自 Java 的下载

> ID：12647920
> 
> 赞同：-2
> 
> 时间：2012-09-28T21:58:42.603
> 
> 标签：java, amazon-s3, amazon-web-services

我正在寻找一种方法来跟踪存储在 amazon S3 服务中的文件的下载。我下载了 API，然后我迷路了。我只想知道我必须从 API 中使用哪些对象和方法才能获取存储在那里的文件的信息。我想跟踪下载，包括发出请求的地址。

感谢提前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:12:35.117

如果您正在谈论下载日志存储桶中的文件，我们使用如下内容：

*   连接到 S3（使用访问/密钥）
*   打开题为的桶`"loggingBucket"`
*   获取该桶中的每个对象
*   读入文件并处理它
*   处理完每个文件后，我们将其删除

这是示例代码：

```
BasicAWSCredentials credentials =
    new BasicAWSCredentials("accessKey", "secretAccessKey");
AmazonS3Client client = new AmazonS3Client(credentials);

for (ObjectListing listing = client.listObjects("loggingBucket");;
        listing = client.listNextBatchOfObjects(listing)) {
    // run through each listing to process it
    for (S3ObjectSummary summary : listing.getObjectSummaries()) {
        String bucketName = summary.getBucketName();
        String fileName = summary.getKey();
        S3Object object = client.getObject(bucketName, fileName);
        S3ObjectInputStream stream = object.getObjectContent();
        BufferedReader reader =
            new BufferedReader(new InputStreamReader(stream));
        ... process the file here writing it locally or something
        // delete the file afterwards
        client.deleteObject(bucketName, fileName);
    }
    // we may need to get more files
    if (!listing.isTruncated()) {
        break;
    }
} 
```

如果这不是您想要的，请编辑您的帖子，以便我们更好地帮助您。

# c# - .Net 缓存过期

> ID：12647921
> 
> 赞同：4
> 
> 时间：2012-09-28T21:59:02.553
> 
> 标签：c#, .net, caching

在我的项目中，我们使用 Web 服务从数据库中获取数据，并将来自 Web 服务的数据填充到缓存中。我正在使用 Absolute expiration ，并且持续时间设置为 4 小时。因此 4 小时后，缓存过期，因此调用 Web 服务重新填充缓存中的数据。

现在发生的问题是：

有时在 Web 服务和数据库之间建立连接时出现问题，因此 Web 服务不返回数据。

在这种情况下，缓存将填充所有字段的空值，并且最多 4 小时的缓存（直到它再次过期）不会重新填充。

我正在寻找两种解决方案：1）我们可以在缓存到期之前更新缓存，然后调用 Web 服务。如果 Web 服务取回数据，则覆盖缓存。2）缓存永远不会过期，如果我们取回数据，我们经常会产生一个更新缓存的线程。

但我不确定如何实施上述解决方案？有人可以给我关于技术部分的见解吗？谢谢您的帮助！

我当前填充缓存的代码：

```
ctx.Cache.Insert("cachename", cacheValue, null,
              DateTime.Now.AddHours(Int32.Parse(siteViewModel.ApplicationSettings["CacheDurationHours"])), System.Web.Caching.Cache.NoSlidingExpiration, 
             System.Web.Caching.CacheItemPriority.Default,
             null
             ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T22:07:00.920

不要传递 null，而是实现[CacheItemRemovedCallback](http://msdn.microsoft.com/en-us/library/system.web.caching.cacheitemremovedcallback.aspx)作为[Cache.Insert(..)](http://msdn.microsoft.com/en-us/library/05kd8d77.aspx)的最后一个参数。在检索值以重新填充缓存时，您可以进行空检查并暂时使用旧值。

# html - 水豚选择选项不起作用

> ID：12647923
> 
> 赞同：6
> 
> 时间：2012-09-28T21:59:17.700
> 
> 标签：html, ruby-on-rails, ruby, rspec, capybara

我已经尝试了很多方法来尝试和我的水豚测试从这个表格中选择一个选项。

```
 <select id="mapping_midi_controller_id" name="mapping[midi_controller_id]"><option value="17">MIDI Fighter Classic</option>
      <option value="18">MIDI Fighter Pro</option>
      <option value="16">Traktor Control S2</option>
      <option value="15">Traktor Control S4</option>
      <option value="19">VCI-100</option>
      <option value="0">Other ...</option>
    </select> 
```

我试过
1) `page.select "VCI-100", :from => "mapping_midi_controller_id"`
2)`select "19", :from => "mapping_midi_controller_id"`

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T03:19:30.087

我认为第二个命令应该是：

> 选择“ **VCI-100** ”，：来自=>“mapping_midi_controller_id”

# css - nth-child 或 first/last-child 选择器不起作用。如何正确应用它们？

> ID：12647925
> 
> 赞同：0
> 
> 时间：2012-09-28T21:59:38.977
> 
> 标签：css, css-selectors

我有一个结构：

```
<div id="div">
    <ul class="ul">
        <li class="li_one">
        </li>
        <li class="li_two">
        </li>
    </ul>
</div> 
```

我想使用伪选择器设置`background:red`第二个元素（“li_two”类），并希望从最外层的 div 开始。`li`我正在尝试这种方式：

```
#div > ul:nth-child(1) { background:red; }   // works but wrong, sets background to ul
#div ul:last-child { background:red; }   // doesn't set to any element
#div ul:first-child { background:red; }  // again sets to ul but not to li
#div [class=li_two] { background:red; }  // only this one works fine 
```

是否可以将样式设置`li_two`为`#div`使用`:nth-child`或`:last-child`或`:first-child`选择器？怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:03:39.473

**#div li:last-child**

您的第二个选项几乎是正确的:) 我认为您误解了 last-child 所做的事情。xx:last-child 不选择元素xx的最后一个子元素；它选择作为其父级的最后一个子级的每个 xx 元素。

[一些阅读](http://www.w3schools.com/cssref/sel_last-child.asp)。

[我为你创建了一个 JSFiddle 来测试它](http://jsfiddle.net/TV3Vk/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T22:01:58.597

`:nth-child()`并且其他伪类应该应用于子元素，而不是父元素。将这些伪类应用于`li`s：

```
#div ul li:last-child {
    background: red;
} 
```

# c++ - 重用 Web 浏览器控件

> ID：12647927
> 
> 赞同：7
> 
> 时间：2012-09-28T21:59:58.573
> 
> 标签：c++, windows, winapi, com, webbrowser-control

我有一个纯 Win32 应用程序（没有 MFC 等），我想在窗口中添加一个 Web 浏览器控件。我知道 COM 的基础知识，并且可以使用为浏览器创建一个 COM 对象

```
 hr = CoCreateInstance(
    CLSID_WebBrowser,
    NULL,
    CLSCTX_INPROC,
    IID_IWebBrowser2,
    (void**) &pWebBrowser); 
```

然而，显然需要调用 SetClientSite，传递一个 IOleClientSite*。如何获得这样的接口？[这个例子](http://msdn.microsoft.com/en-us/library/aa451946.aspx)实现了它自己的浏览器类，它通过从它派生并实现它来提供接口[（这里）](http://msdn.microsoft.com/en-us/library/aa451938.aspx)。我试图沿着这条路走，但是为了实例化浏览器类，我必须注册它（不是吗？）。这看起来非常复杂——我只想使用现有的 COM 对象，而不是实现和注册我自己的。我错过了什么？

假设我确实将自己的 ClientSite 类实现为我的应用程序的一部分，是否可以不注册它，而只是通过调用`new ClientSite`（然后以 using 获取接口`QueryInterface`）来​​实例化它？这会起作用，还是必须打电话`CoCreateInstance`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T22:15:36.317

[CodeGuru](http://www.codeguru.com/cpp/i-n/ieprogram/article.php/c4379/Display-a-Web-Page-in-a-Plain-C-Win32-Application.htm)上有一个示例，[CodeProject](http://www.codeproject.com/Articles/3365/Embed-an-HTML-control-in-your-own-window-using-pla)上有另一个示例，其中包含托管以纯 C 实现的 Web 浏览器控件的最简单实现。您必须实现自己的`IOleClientSite`，但它是更容易实现的类之一。是的，必须调用`CoCreateInstance`或`OleCreate`创建 Web 浏览器控件的实例。

[http://www.codeguru.com/cpp/in/ieprogram/article.php/c4379/Display-a-Web-Page-in-a-Plain-C-Win32-Application.htm](http://www.codeguru.com/cpp/i-n/ieprogram/article.php/c4379/Display-a-Web-Page-in-a-Plain-C-Win32-Application.htm)

[http://www.codeproject.com/Articles/3365/Embed-an-HTML-control-in-your-own-window-using-pla](http://www.codeproject.com/Articles/3365/Embed-an-HTML-control-in-your-own-window-using-pla)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:01:52.883

尝试 WTL（来自 MS 的仅标头库）。安装其项目模板。从模板创建一个新的 WTL 项目并选择“Web 浏览器”控制选项（或任何名称）。现在你可以调查生成的资源或者（我个人的建议）将你的东西移到这个项目中

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-28T22:08:51.793

我不确定你到底想做什么......

...但我会首先尝试使用简单的 ShellExecute()，如果可能的话：

*   [http://msdn.microsoft.com/en-us/library/windows/desktop/bb762153%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762153%28v=vs.85%29.aspx)

*   [http://support.microsoft.com/kb/224816](http://support.microsoft.com/kb/224816)

# php - 新电子邮件验证/无法访问旧电子邮件帐户

> ID：12647929
> 
> 赞同：1
> 
> 时间：2012-09-28T22:00:03.277
> 
> 标签：php

我有一个正在构建的客户程序，并且我有一个系统，该系统最初通过向他们发送哈希来验证他们的电子邮件，如果他们发送正确的哈希，他们就会被输入。我想要做的是让用户能够将他们的电子邮件更新为新的电子邮件地址，我想知道最好的方法是什么。

我想做的是：

用户填写电子邮件更改表格，并使用新电子邮件地址进入数据库并创建哈希（带超时）并将带有哈希的电子邮件发送到旧电子邮件地址。

但这让我想到了如何处理无法访问其旧电子邮件地址的用户。我是否应该让管理员手动更新他们的电子邮件地址，方法是通过“无法访问您的旧电子邮件地址”复选框向管理员发送电子邮件，该复选框带有一个区域供用户为管理员添加消息。然后管理员发送一封电子邮件，其中包含该用户的哈希值。

或者是否有其他方式我应该完成这项任务。

**编辑：**我认为对于某些情况，最好在数据库中添加一个“你最喜欢的__”问题W/答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:08:25.083

为什么要将邮件发送到旧地址？

显然，在新地址得到确认之前，您需要跟踪这两个地址，但如果用户已通过身份验证，您只需将更改邮件消息发送到新地址即可。

# fancybox-2 - 花式框上一个和下一个按钮//如何在某些而不是其他中显示

> ID：12647935
> 
> 赞同：0
> 
> 时间：2012-09-28T22:00:25.943
> 
> 标签：fancybox-2

我在 ►<a href="http://camandbenny.com/work" rel="nofollow">此页面中有 3 个精美的幻灯片放映◀

1 在人像中。
2 在舷窗。
3 来自任何滑块本身。

任何滑块都在 ul 中 - 但我不希望在该滑块上显示 previos 和 next 按钮。

由于它们都使用相同的 CSS，我不能只是隐藏它们。所以我想我必须在 javaScript 中做......但我在文档中找不到任何东西。

你们有什么想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:27:55.517

`rel`从您不希望有下一个/上一个按钮的链接中删除属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-10T08:42:43.977

从 fancybox 中删除或隐藏上一个下一个功能

.ui-widget-overlay { 不透明度：0.9 !important; 背景：无重复滚动 0 0 #111111 !important;
} .fancybox-prev span, .fancybox-next span { /* .... */ visibility: hidden !important;
} .fancybox-next { z-index:-999 !important;
} .fancybox-prev { z-index:-999 !important;
}

# objective-c - sqlite 未关闭的读取事务

> ID：12647936
> 
> 赞同：2
> 
> 时间：2012-09-28T22:00:55.297
> 
> 标签：objective-c, ios, database, multithreading, sqlite

我在 iOS 应用程序中使用 sqlite3 并且多次遇到一个非常奇怪的问题。

我正在使用 WAL，我的所有写入都发生在一个托管线程上，该线程一次只允许 1 个操作，我的读取使用不同的数据库句柄，一切正常。我看到的问题是有时我的读取句柄会进入这种奇怪的状态，它不会读取提交的数据。就像它有一个未提交的读取事务......

我可以成功写入数据库，并将结果导出到我的计算机，在那里我可以看到新写入的结果。但是，我的读取似乎是在较早的时间点访问数据库......就像他们被卡住了一样。如果我关闭应用程序并重新打开它，它们会很好并且它们会读取新提交的数据，但我想知道我的应用程序是如何陷入这种状态的。

任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:11:43.677

我遇到了完全相同的问题，但是在带有 SQLite3 3.7.7.1 的 Debian Lenny（内核 2.6.33）上。

事实证明，在我删除并重新创建数据库文件后，我的一些进程挂在了一些陈旧的数据库文件描述符上。

我通过确保在再次重新创建数据库之前杀死所有使用数据库的进程来修复它。

通过摆脱旧进程，文件句柄也被删除。

# asp.net-mvc-4 - 登录后 WebSecurity.CurrentUserName 和 User.Identity.Name 为空

> ID：12647942
> 
> 赞同：8
> 
> 时间：2012-09-28T22:01:33.707
> 
> 标签：asp.net-mvc-4, security, simplemembership

我声明要为我的 ASP.Net MVC 4 站点找出 SimpleMembership。我用自定义属性 AccountTypeId 扩充了 UserProfile。我已经使用增强属性更新了数据库表，并且可以在注册时将数据保存到数据库中。我对如何在用户登录后检索有关用户的数据感到有些困惑。

在我的帐户控制器中，我有一个登录操作，当用户登录时会发布到该操作。这是我的代码：

```
[HttpPost]
    [AllowAnonymous]
    [ValidateAntiForgeryToken]
    public ActionResult Login(LoginModel model, string returnUrl)
    {
        if (ModelState.IsValid && WebSecurity.Login(model.UserName, model.Password, persistCookie: model.RememberMe))
        {
            var userName = WebSecurity.CurrentUserName;
            var identityName = User.Identity.Name;
            var currentuserid = WebSecurity.GetUserId(model.UserName);
            var context = new UsersContext();
            var user = context.UserProfiles.SingleOrDefault(u => u.UserId == currentuserid);
            var accountTypeId = user.AccountTypeId;

            return RedirectToLocal(returnUrl);
        }

        // If we got this far, something failed, redisplay form
        ModelState.AddModelError("", "The user name or password provided is incorrect.");
        return View(model);
    } 
```

WebSecurity.CurrentUserName 和 User.Identity.Name 都是空字符串，但是，我可以使用 WebSecurity.GetUserId(model.UserName) 检索 UserId，因此可以检索用户数据，我可以获得 accountTypeId。

奇怪的是，当用户被重定向到登录页面后，从 .cshtml 页面调用 User.Identity.Name 时，它​​会显示在我的页面上。因此，在我的控制器的登录操作和目标页面之间的某个位置，User.Identity 正在设置数据。

我假设由于我通过了 WebSecurity.Login 检查，WebSecurity 将拥有有关登录用户的信息，但似乎并非如此。

我错过了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T15:17:55.803

用户名被写入 cookie。为了使 cookie 数据可用，必须将其放入响应中并发送回浏览器。在下一次请求时，cookie 值将被读取并用于填充`User.Identity.Name`属性。

换句话说，在您调用 Redirect 之前，该`User.Identity.Name`属性**应该**是一个空字符串。这就是登录后重定向的目的：将cookie写入浏览器，以便后续请求将用户视为已登录。

# django - Twitter-Bootstrap 模式中的简单 Django 表单

> ID：12647949
> 
> 赞同：0
> 
> 时间：2012-09-28T22:01:54.407
> 
> 标签：django, jquery, twitter-bootstrap, django-views

我正在尝试使用 Twitter-Bootstrap 模式运行 django 表单。我想知道`/`表单提交后我应该怎么做才能返回。我的`views`和`templates`在下面。

### 网址.py

```
urlpatterns = patterns('myapp.views',
    url(r'^$', 'main'),
    url(r'^add/', 'form_add'),
) 
```

### 视图.py

```
def main(request):
    if request.method == 'POST':
        form = MyModelForm(request.POST)
        if form.is_valid():
            name = form.cleaned_data['name']
            request.session['name'] = name
            mm = MyModel.objects.create(name=name)
            mm.save()
            return HttpResponseRedirect('/add') # Redirect after POST
    else:
        form = MyModelForm()
    args = {}
    args['last_item'] = MyModel.objects.all().order_by('pk').reverse()[0]
    args['form'] = form
    return render(request, 'form.html', args)

def form_add(request):
    args = {}
    name = request.session['name']

    return render(request, 'add.html', args) 
```

### 表单.html

```
{% extends "base.html" %}

{% block content %}
<button type="button" data-toggle="modal"
        data-target="#myModal1">Launch modal</button>

<div class="modal" id="myModal1" tabindex="-1" role="dialog"
     aria-labelledby="myModal1Label" aria-hidden="true" style="display: none">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModal1Label">Modal header</h3>
  </div>
  <div class="modal-body">
    <form method="POST" id="" action="">
      {% csrf_token %}
      {{ form.as_p }}
      <button>Submit</button>
    </form>
  </div>
</div>

<p>Last item: {{ last_item }}</p>
{% endblock %}

{% block scripts %}
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T05:20:48.460

评论转换为答案。

`HttpResponseRedirect('/')`而不是`'/add'`？

# mamp - 即使重新安装后 MAMP Pro 也无法启动

> ID：12647957
> 
> 赞同：0
> 
> 时间：2012-09-28T22:03:14.607
> 
> 标签：mamp

我的 mac 今天早些时候死机了，我强迫它重新启动（涉及几次强制退出并最终按住电源按钮）。启动后，除 MAMP Pro 外，一切正常。当它启动时，它不报告任何错误，只是在启动 MySQL 时挂起，旁边有一个微调器。

我试过卸载并重新安装无济于事。但是，常规 MAMP 工作得很好。我已经多次删除并重新安装了 /Library/Application Support/appsolute/MAMP Pro，但也许还有其他文件丢失了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T23:50:34.373

今晚我遇到了这个问题。

***原因是我创建了一个主机名，但在单击Apply***之前忘记将其分配给磁盘位置。

令人惊讶的是，一旦你这样做了，就没有办法真正纠正你的错误——每次启动时它都会挂起，而且你永远无法选择修复磁盘位置。

解决方案是从 MAMP 设置列表中手动删除该条目。

1.  退出 MAMP Pro
2.  打开`~/Library/Application Support/appsolute/MAMP PRO/settings.plist`
3.  找到`<dict>`包含错误主机的条目 - 您将在 XML 中看到：

    ```
    <key>serverName</key>
    <string>yourhostname</string> 
    ```

4.  `<dict>...</dict>`删除包含您的主机名的整个节点缺少磁盘位置并保存文件

5.  重新打开 MAMP Pro

你应该回来做生意了。

为了将来避免这种情况，最好打开 MAMP 首选项并取消选中***允许在主机的磁盘位置无效时应用***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-11T05:21:49.267

只需在终端 killall -9 mysqld 上运行它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T23:33:43.223

通过用 /etc/apache2/httpd.conf~original 覆盖 /etc/apache2/httpd.conf 来修复它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-20T08:32:13.893

在此问题发生之前，我添加了一个名称中带有下划线的虚拟主机。

通过手动编辑 ~/Library/Application Support/appsolute/MAMP PRO/settings4.plist 用破折号替换下划线后，一切都恢复了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-14T14:55:20.270

Mamp Pro 6（从 2021 年 7 月的版本 5 更新）有同样的启动问题，以下修复了它...

*   **从 /Applications/MAMP/ 中删除整个`htdocs`文件夹（将其移至我的 Documents 文件夹）**

启动 MAMP。一切又开始工作了。很奇怪，但它起作用了，这里的其他答案都没有，所以......

# facebook - FBUserSettingsViewController 隐藏导航栏

> ID：12647969
> 
> 赞同：2
> 
> 时间：2012-09-28T22:04:50.950
> 
> 标签：facebook, ios6, facebook-ios-sdk

当我以模态方式呈现 FBUserSettingsViewController 时，它有一个导航栏，上面有取消和完成栏按钮。

如何隐藏它？

```
FBUserSettingsViewController *settings = PF_FBUserSettingsViewController.new;
settings.delegate = self;
[self presentViewController:settings animated:YES completion:nil]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T23:04:25.380

您可以通过将 FBUserSettingsViewController 的doneButton**和**cancelButton**都****设置**为**nil**来隐藏工具栏：

```
self.settingsViewController.doneButton = nil;
self.settingsViewController.cancelButton = nil; 
```

这已在 Facebook SDK 3.2 中得到验证。

# mysql - 从 Mysql 表的列中检索数据作为复选框，并将选择发送到同一 DB 的另一个表的另一列

> ID：12647970
> 
> 赞同：1
> 
> 时间：2012-09-28T22:04:51.420
> 
> 标签：mysql, insert, checkbox

我为我的无知道歉。我发誓我已经用谷歌搜索了足够多的关于这个特定的东西，但没有找到任何具体的东西。我将代码视为一种形状并将其理解为一种形状，而我的问题表明我是多么无知。

关于复选框的问题都是关于直接在复选框输入中命名的复选框：复选框值=红色，蓝色，粉红色；或大、中、x 大...等。但是我没有发现从 mysql 表的列的名称中检索到的复选框名称，然后返回以作为逗号分隔值发送到 BD 的另一个列表....

由于我不想让您阅读很多内容，因此我在此处放了一个屏幕截图：

[http://handyq.textblock.org/camtasia/Stackoverflow/Stackoverflow.html](http://handyq.textblock.org/camtasia/Stackoverflow/Stackoverflow.html)

如果需要，您可以在[此处](http://handyq.textblock.org/?seccion=auditorias_admin&aktion=add "Handy-Q 是一款质量管理系统软件")将表单视为演示<--

请参阅使表单有效的存档代码，如下所示：

在此，我对其中一个视频进行了一些更改：我在第 180 行附近添加了这个：

```
 foreach ( $_POST['AreaAuditada'] as $area )
            {
                $AreaAuditada_Post .= '[' . $area . ']';
            } 
```

我必须将选中的复选框正确发送到 mysql 表“informeauditoria”，发送到“areaauditada”，如果可以的话，在括号之间，并带有通知：

注意：第 188 行 C:\Archivos de programa\EasyPHP-5.3.9\www\handyq\mod\auditorias_admin.php 中的数组到字符串转换。

去演示看看最后的成就。

现在我只需要修复通知...

```
 <html>
    <head>
    </head>
    <body>
    <table class="print" style="width:80%" summary="Modificar auditorías">
    <caption><?php echo AINFORMES_ADMINISTRAR;
    include('acciones/acciones_ainformes.php'); ?></caption>  
    <tbody>
    <tr>
    <td><a href="?seccion=auditorias_admin&aktion=add"><?php echo AINFORMES_ANADIR; ?>  </a>::
    <a href="?seccion=auditorias_admin&aktion=change"><?php echo AINFORMES_CAMBIAR; ?> </a>
    </td>
    </tr>
    </tbody>
    </table>
    <br>

   <?php
        // requires the class
        require "class.datepicker.php";

        // instantiate the object
        $db=new datepicker();

        // uncomment the next line to have the calendar show up in german
        //$db->language = "dutch";

        $db->firstDayOfWeek = 1;

        // set the format in which the date to be returned
        $db->dateFormat = "Y-m-d";

// Aktionen
$aktion = '';
if(isset($_GET['aktion'])) $aktion = $_GET['aktion'];

if($aktion == ""){
 echo 'Admin Area';
 }

if($aktion == "add"){
if((empty($_POST['ai'])) AND (empty($_POST['Fecha'])) AND (empty($_POST['AreaAuditada'])) AND (empty($_POST['Documentacion'])) AND (empty($_POST['Auditor'])) AND (empty($_POST['ObjetoAuditoria']))  AND (empty($_POST['Resultado']))){
echo '<form action="" method="POST">';
   echo '<table class="print" style="width:80%" summary="Modificar auditorías">';
   echo '<caption>';
      echo AINFORMES_ANADIR;
  echo '</caption>';
   echo '<tbody>';
    echo '<tr>';
      echo '<th>';
      echo AINFORMES_NUMERO;
      echo '</th>';
       echo '<td>';
       echo ' <select name="ai" value="">';
             echo '<option>...</option>';

             $sql = "SELECT * FROM aisgc ORDER BY fecha DESC";
             $sql = mysql_query($sql);
             while($row = mysql_fetch_assoc($sql)) {
             //$row['ai'] = htmlentities($row['ai']);
             echo '<option value="'.$row[ai].'">'.$row[ai].' de fecha: '.$row[fecha].'</option>';
             }

       echo '</select>';
      echo '</td>';
    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo GENERAL_FECHA;
      echo '</th>';                     

      echo '<td><input type="text" id="date" class="inputfecha" name="Fecha" value="">';
      ?>

      <input type="button" value="::" onclick="<?=$db->show('date')?>">

      <?php
      echo '</td>';       

    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo AINFORMES_AREA_AUDITADA;
      echo '</th>';

     // echo '<td><input class="inputlargo" name="AreaAuditada" value=""></td>';

     // SOME TESTS
       /*echo '<td>';
       echo ' <select name="AreaAuditada" value="">';
             echo '<option>...</option>';

             $sql = "SELECT * FROM areassensibles ORDER BY nombrearea";
             $sql = mysql_query($sql);
             while($row = mysql_fetch_assoc($sql)) {
             //$row['nombrearea'] = htmlentities($row['nombrearea']);
             echo '<option value="'.$row[nombrearea].'">'.$row[nombrearea].'</option>';
             }

       echo '</select>';
       echo '</td>';

       echo '<td>';
             $sql2 = "SELECT nombrearea FROM areassensibles ORDER BY nombrearea";
             $sql2 = mysql_query($sql2);
             define("nombrearea", "nombrearea");
             while($row = mysql_fetch_assoc($sql2)) {
             echo $row['nombrearea'];
             echo '<input type=checkbox name="AreaAuditada" value="'.$row[nombrearea].'">';
             }
        echo '<td>';*/

       echo '<td>';         
            $sql2="SELECT * FROM areassensibles";
            define("nombrearea", "nombrearea");
            $resultado=mysql_query($sql2); 
            while($nombrearea=mysql_fetch_array($resultado)){               
            echo '<input id="IDnombrearea[]" name="AreaAuditada[]" type="checkbox" value="'.$nombrearea[nombrearea].'">'.$nombrearea[nombrearea].'';                
            }               

        echo '<td>';            

    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo GENERAL_DOCUMENTACION;
      echo '</th>';
      echo '<td><input class="inputlargo" name="Documentacion" value=""></td>';
    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo AUDITORIAS_AUDITOR;
      echo '</th>';
      echo '<td>';
       echo ' <select name="Auditor" value="">';
             echo '<option>...</option>';

             $sql = "SELECT * FROM auditores WHERE activo=1";
             $sql = mysql_query($sql);
             while($row = mysql_fetch_assoc($sql)) {
             //$row['auditor'] = htmlentities($row['auditor']);
             echo '<option value="'.$row[auditor].'">'.$row[auditor].'</option>';
             }

       echo '</select>';
      echo '</td>';
      //echo '<td><input class="width:90%" name="Auditor" value=""></td>';
    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo AINFORMES_OBJETO;
      echo '</th>';
      echo '<td><textarea class="textareasmall" name="ObjetoAuditoria" value=""></textarea></td>';
    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo GENERAL_RESULTADO;
      echo '</th>';
      echo '<td><textarea class="textareanormal" name="Resultado" value=""></textarea></td>';
      echo '</tr>';
      echo '<td colspan="2"><input type="submit" value="'.GENERAL_ANADIR.'"></td>';
    echo '</tr>';
   echo '</tbody>';     
  echo '</table>';
echo '</form>';
 }else{
$ai_Post = $_POST['ai'];
$Fecha_Post = $_POST['Fecha'];
$AreaAuditada_Post = $_POST['AreaAuditada'];

            foreach ( $_POST['AreaAuditada'] as $area )
            {
                $AreaAuditada_Post .= '[' . $area . ']';
            }

$Documentacion_Post = mysql_real_escape_string($_POST['Documentacion']);
$Auditor_Post = mysql_real_escape_string($_POST['Auditor']);
$ObjetoAuditoria_Post = mysql_real_escape_string($_POST['ObjetoAuditoria']);
$Resultado_Post = mysql_real_escape_string($_POST['Resultado']);
$sql =    mysql_query("INSERT INTO informeauditoria (ai, Fecha, AreaAuditada, Documentacion, Auditor, ObjetoAuditoria, Resultado) VALUES ('".$ai_Post."', '".$Fecha_Post."', '".$AreaAuditada_Post."', '".$Documentacion_Post."', '".$Auditor_Post."', '".$ObjetoAuditoria_Post."', '".$Resultado_Post."')");
if($sql) echo "Auditoría añadida";
else echo "Error al añadir el registro!";
}
}

if($aktion == "change"){
$sql = mysql_query("SELECT * FROM informeauditoria ORDER BY id DESC");

echo '<table class="print" summary="Modificar auditorías">';
echo '<caption>';
      echo AINFORMES_CAMBIAR;
  echo '</caption>';
echo '<thead>';
echo AINFORMES_ADVERTICE; 
echo '</thead>';
echo '<tbody>';
echo '<tr>';
//<!--<th>Id</th>-->';
 echo '<th>';
     echo AINFORMES_INFORME;
echo '</th>';
 echo '<th>';
     echo GENERAL_FECHA;
 echo '</th>';
echo '<th>';
     echo AINFORMES_AREA_AUDITADA;
echo '</th>';
 //<!--<th>Documentaci&oacute;n</th>-->
 echo '<th>';
     echo AUDITORIAS_AUDITOR;
 echo '</th>';
 //<!--<th>Objeto</th><th>Resultado</th>-->
echo '</tr>';
while($row = mysql_fetch_row($sql)) {
    echo "<tr>";  
    //echo "<td>".$row['0']."</td>";
    echo "<td><a href='?seccion=auditorias_admin&aktion=change_id&id=".$row['0']."'>".$row['1']."</a></td>";
    echo "<td><a href='?seccion=auditorias_admin&aktion=change_id&id=".$row['0']."'>".$row['2']."</a></td>";
    echo "<td><a href='?seccion=auditorias_admin&aktion=change_id&id=".$row['0']."'>".$row['3']."</a></td>";
    //echo "<td><a href='?seccion=auditorias_admin&aktion=change_id&id=".$row['0']."'>".$row['4']."</a></td>";
    echo "<td><a href='?seccion=auditorias_admin&aktion=change_id&id=".$row['0']."'>".$row['5']."</a></td>";
    /*echo "<td><a href='?seccion=auditorias_admin&aktion=change_id&id=".$row['0']."'>".$row['6']."</a></td>";
    echo "<td><a href='?seccion=auditorias_admin&aktion=change_id&id=".$row['0']."'>".$row['7']."</a></td>";*/
    echo "</tr>";
}
  echo '</tbody>';
 echo "</table>";
 }

 if($aktion == "change_id"){
 if((empty($_POST['ai_change'])) AND (empty($_POST['Fecha_change'])) AND (empty($_POST['AreaAuditada_change'])) AND (empty($_POST['Documentacion_change'])) AND (empty($_POST['Auditor_change'])) AND (empty($_POST['ObjetoAuditoria_change'])) AND (empty($_POST['Resultado_change']))){
$id = $_GET['id'];
$sql = mysql_query("SELECT * FROM informeauditoria WHERE id = $_GET[id] ");
$data = mysql_fetch_row($sql);

echo '<form action="" method="POST">';
  echo '<table class="print" summary="Modificar auditorías">';
  echo '<caption>';
      echo AINFORMES_PRINT_DETAILS;
  echo '</caption>';
   echo '<tbody>';
    echo '<tr>';
      echo '<th>';
     echo AINFORMES_INFORME;
     echo '</th>';
      echo '<td><input class="inputlargo" name="ai_change" value="'.$data[1].'"></td>';
    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo GENERAL_FECHA;
      echo '</th>';
      echo '<td><input class="inputlargo" name="Fecha_change" value="'.$data[2].'"></td>';
    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo AINFORMES_AREA_AUDITADA;
      echo '</th>';
      echo '<td><input class="inputlargo" name="AreaAuditada_change" value="'.$data[3].'"></td>';
    echo '</tr>';
    echo '<tr>';
       echo '<th>';
     echo GENERAL_DOCUMENTACION;
      echo '</th>';
      echo '<td><input class="inputlargo" name="Documentacion_change" value="'.$data[4].'"></td>';
    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo AUDITORIAS_AUDITOR;
      echo '</th>';
      echo '<td><input class="inputlargo" name="Auditor_change" value="'.$data[5].'"></td>';
    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo AINFORMES_OBJETO;
      echo '</th>';
      echo '<td><textarea class="inputlargo" rows="5" name="ObjetoAuditoria_change">'.$data[6].'</textarea></td>';
    echo '</tr>';
    echo '<tr>';
      echo '<th>';
     echo GENERAL_RESULTADO;
      echo '</th>';
      echo '<td><textarea class="textareanormal" rows="15" name="Resultado_change">'.$data[7].'</textarea></td>';
    echo '</tr>';
      echo '<td colspan="2"><input type="submit" value="'.GENERAL_MODIFICAR.'"></td>';
    echo '</tr>';
  echo '</tbody>';    
  echo '</table>';
echo '</form>'; 
}else{
$sql = mysql_query("UPDATE informeauditoria SET ai='$_POST[ai_change]',Fecha='$_POST[Fecha_change]',AreaAuditada='$_POST[AreaAuditada_change]',Documentacion='$_POST[Documentacion_change]',Auditor='$_POST[Auditor_change]',ObjetoAuditoria='$_POST[ObjetoAuditoria_change]',Resultado='$_POST[Resultado_change]' WHERE id=$_GET[id]");
if($sql) echo 'Auditor&iacute;a actualizada!';
}
}
?>
</body>
</html> 
```

# perl - 为我的 perl 脚本输出的文件和目录设置 unix 组权限？

> ID：12647975
> 
> 赞同：0
> 
> 时间：2012-09-28T22:05:09.167
> 
> 标签：perl, unix

我的脚本按我想要的方式工作，但有一个例外。我希望能够自动将 unix 组权限设置为我在 perl 脚本中创建的目录和文件。

这可能吗，还是我只需要求助于

```
chgrp <group> <directory> 
```

运行我的脚本后？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:24:47.653

您可以像这样使用 Perl 的`chown`函数：

```
# Get the GID as a number 
my $gid = getgrnam("group");

# Change the ownership 
chown -1, $gid, $dir; # Or $file or @list_of_files depending on your need 
```

但是，如文档中所述，您可能需要权限才能执行此操作。 [http://perldoc.perl.org/functions/chown.html](http://perldoc.perl.org/functions/chown.html)

# java - 将 Java 结果传递给 JSP

> ID：12647981
> 
> 赞同：0
> 
> 时间：2012-09-28T22:06:00.563
> 
> 标签：java, jsp

我最近被扔进了用 Java 编程网站的美妙世界。我对 Java 有一点经验，但仍然认为自己是初学者。

我创建了一个 Java 类，其中包含一个简单的 SQL 查询。我正在尝试在 JSP 页面上显示，但不确定如何实现这一点。

这是我的名为 Main.java 的 Java 类：

```
public static void main(String[] args) throws Exception { 
    //Accessing driver from JAR
    Class.forName("com.mysql.jdbc.Driver");

    //Creating a variable for the connection called "con"
    //jdbc:mysql://host_name:port/dbname
    //Driver name = com.mysql.jdbc.Driver
    Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/wae","root","");

    PreparedStatement statement = con.prepareStatement("select name from user");
    ResultSet result = statement.executeQuery();
    while(result.next()) {
        System.out.println(result.getString(1));
    }
} 
```

我将如何进入`system.out.println`JSP 页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:17:32.420

如果需要保存结果并显示到 JSP 中。

将结果保存在请求中，并在视图层中使用 JSTL 进行迭代以显示结果。这意味着，在 servlet 中获取请求并将其转发给新的 jsp

我建议使用 JSF 而不是 JSP ，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T05:24:26.940

对于您发布的示例，您需要做的是编写一个 servlet，在该 servlet 中您将进行业务逻辑调用（在本例中为数据库查询），在获取数据后，您必须将其传递给 JSP 页面. 使用 servlet 不需要 main 方法，但它们必须部署在 servlet 容器（如 Tomcat）中。

这是代码：

公共类 UserListServlet 扩展 HttpServlet {

```
protected void processRequest(HttpServletRequest request, HttpServletResponse response) 
                                    throws ServletException, IOException {  
    //Accessing driver from JAR
    Class.forName("com.mysql.jdbc.Driver");

    //Creating a variable for the connection called "con"
    //jdbc:mysql://host_name:port/dbname
    //Driver name = com.mysql.jdbc.Driver
    Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/wae","root","");

    PreparedStatement statement = con.prepareStatement("select name from user");
    ResultSet result = statement.executeQuery();
    //creates a list with the user names
    List<String> userList = new ArrayList<String>();
    while(result.next()) {
        userList.add(result.getString(1));
    }
    //passing the data to the JSP
    request.setAttribute("users", userList);
    getServletContext().getRequestDispatcher("/user_list.jsp").forward(request, response);  
}  

protected void doGet(HttpServletRequest request, HttpServletResponse response)                           throws ServletException, IOException {  
    processRequest(request, response); 
}  

protected void doPost(HttpServletRequest request, HttpServletResponse response) 
                                throws ServletException, IOException {
    processRequest(request, response);
} 
```

}

现在在 JSP 中你可以有这样的东西：

```
<%@ page contentType="text/html" pageEncoding="UTF-8"%>
<%@ page import="java.util.List" %>
<!DOCTYPE HTML>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>User List</title>
    </head>
    <body>
        <%
        if (request.getAttribute("userList") != null) {
            List<String> users = request.getAttribute("userList");
        %>

        <h1>Users: </h1>
        <table>
            <tr>
                    <td>Name<</td>
            </tr>

            <% for (String name : users) {%>

            <tr>
                <td><%= name%></td>
            </tr>
            <% }
          }%>

        </table>
    </body>
</html> 
```

您可以通过使用[JSTL](http://www.oracle.com/technetwork/java/index-jsp-135995.html)而不是 Scriptlet (<% ... %>) 来改进此示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:21:46.457

JSP 还允许您在 JSP 中编写 Java 代码块。为此，您可以将 Java 代码放在 <% 和 %> 字符之间。scriptlet 包含每次调用 JSP 时都会执行的 Java 代码。
这是一个简单的 jsp Web 应用程序的链接，它应该可以帮助您入门。

[http://j2ee.masslight.com/Chapter1.html#mygreeting](http://j2ee.masslight.com/Chapter1.html#mygreeting)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T22:33:57.587

您可以使用下面的示例代码作为参考。

```
JSP page
       <form action="servlet1" method="get">
        <%   ModelClass class = new ModelClass();
        class.connectDb();
        class.performDBoperations();
          %>
       <table><tr><td>
      <%   
              class.id;     
       %> 
       </form>

Model Class:
        class ModelClass {
          int id;
            public static void connectDb() {
               dbConnection code
               }
             public void performDBoperations() {
                  get info from table with SQL thru JDBC.
                    id=update it;  
               } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T22:47:05.473

Web 编程中的一个基本概念是您不会从方法（`main`或任何其他方法）开始操作。有人请求 JSP 或 servlet 和相应的类答案。您可以在 JSP 中完成这两件事，并将连接到数据库的工作留给辅助类，如 @chaitanya10 答案所示。

JSP 的Nebeans[教程](http://netbeans.org/kb/docs/web/quickstart-webapps.html)是一个不错的起点。网络上有几个 JSP/Servlets 教程，但我建议远离 Java EE 教程。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-09-28T22:16:30.810

您确定这是创建 Java 网站的好方法吗？

向谷歌询问 Java EE、Servlet 并进入它。

# foursquare - 向foursquare场地页面添加信息？

> ID：12647982
> 
> 赞同：1
> 
> 时间：2012-09-28T22:06:03.790
> 
> 标签：foursquare

我的主要问题是：连接的应用程序可以将相关信息添加到场地页面吗？

我是一名程序员和狂热的 Foursquare 用户。关于场地的基本信息很酷（位置、照片、提示等），但是当我吃饭时（如果是餐厅），我想了解更多关于场地的信息，比如后面-故事，即这个地方的历史，它是什么时候建立的，由谁建立的，以及关于场地的其他有趣的事实。

我认为连接的应用程序将是答案，也许我可以编写一个简单的 wiki 与场地页面集成，以便用户提供他们对场地的了解。但从我所读到的内容看来，这不是连接应用程序或 API 的意图。我是正确的，这是这个假设吗？如果是这样，这个想法可以放入 Foursquare 建议箱吗？我认为这将是一个很好的增值功能——尤其是对于我们喜欢阅读的书呆子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T14:48:10.830

这是连接应用程序的一个很好的用例。连接的应用程序可以使用最多 200 个字符的文本和指向更多内容的链接来回复签到。这可用于提供有关场地的其他信息。查看[https://foursquare.com/apps/](https://foursquare.com/apps/)以查看连接应用程序的示例，以及它们对签到的响应类型。

# c# - Metro Style 应用程序中的异步和等待问题

> ID：12647983
> 
> 赞同：1
> 
> 时间：2012-09-28T22:06:11.373
> 
> 标签：c#, xaml, windows-8, microsoft-metro, winrt-xaml

我有一个简单的 Metro 风格应用程序，它给我一个（异步和等待）问题。

```
List<string> fileNames = new List<string>();
...
...
LoadList();
...
...
(Problem) Code that accesses the elements of the fileNames List
...
...

private async void LoadList()
{
    // Code that loops through a directory and adds the 
    // file names to the fileNames List using GetFilesAsync()
} 
```

问题是文件名列表被过早访问 - 在它完全加载项目之前。
这是因为 async 方法 - 程序继续执行下一行代码，而 async 方法继续其处理。

完全加载后如何访问列表（在异步方法完成后）？

有没有办法在 Metro 应用程序中不使用异步来完成我想要做的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:22:23.850

您也需要调用方法是异步的 - 而不是有一个变量`fileNames`，我会让`LoadList`方法返回它。所以你会有：

```
public async Task ProcessFiles()
{
    List<string> fileNames = await LoadList();
    // Now process the files
}

public async Task<List<string>> LoadList()
{
    List<string> fileNames = new List<string>();
    // Do stuff...
    return fileNames;
} 
```

This does mean that you need to wait for all the files to be found before you start processing them; if you want to process them *as you find them* you'll need to think about using a `BlockingCollection` of some kind. EDIT: As Stephen points out, [TPL Dataflow](http://msdn.microsoft.com/en-us/devlabs/gg585582.aspx) would be a great fit here too.

# mysql - 中级/高级 MySQL 资源

> ID：12647985
> 
> 赞同：-2
> 
> 时间：2012-09-28T22:06:23.993
> 
> 标签：mysql

我正在寻找有关 MySQL 查询的更多知识。我一直在努力将自己打造为一名程序员，现在我需要更多地了解 MySQL 高级技术。

我需要了解 MySQL JOIN 查询、CASE、MAX ...，以及我还不知道的一切。

我非常感谢一些有用文章的链接，这些文章对高级 MySQL 进行了深入的解释。如果你知道任何关于学习 MySQL 的好视频教程，推荐它，我会购买它。

对不起，如果这个问题对你们中的任何人来说似乎无用，但这对我很重要，因为我不能在这里一直问与 SQL 相关的问题，我必须学会自己做一些事情。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:52:44.000

掌握了几个关键字（视频教程、购买），再加上您对建立技能的兴趣，我建议您在[http://www.lynda.com/上订阅](http://www.lynda.com/)

根据您与 MySQL 一起使用的编程语言，我还建议您研究 PDO（假设您还不熟悉它）。

一些有用的 PDO 文章，以补充您现有的 MySQL 知识： http:
[//net.tutsplus.com/tutorials/php/php-database-access-are-you-doing-it-correctly/](http://net.tutsplus.com/tutorials/php/php-database-access-are-you-doing-it-correctly/)
[http://www.phpro .org/tutorials/Introduction-to-PHP-PDO.html](http://www.phpro.org/tutorials/Introduction-to-PHP-PDO.html)
[http://returnsuccess.com/post/15-PDO-class-Object-Oriented-PHP](http://returnsuccess.com/post/15-PDO-class-Object-Oriented-PHP)

我会更有帮助，但我只能提供与问题本身一样多的信息。

# javascript - 使用 WebSharper 编译器编写 Node.js 应用程序

> ID：12647986
> 
> 赞同：4
> 
> 时间：2012-09-28T22:06:25.907
> 
> 标签：javascript, node.js, f#, websharper

我想知道是否可以使用 WebSharper 编译器在 F# 中编写 Node.js 应用程序。有没有可用的资源可以告诉我如何做到这一点？有什么好的理由不尝试这样做吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-29T00:07:14.227

*[我会将此作为评论发布，但它有点太长了......]*

这是另一个不这样做的好理由 - F#*代理*和*异步工作流*提供了一种并发编程模型，在许多方面都比 Node.js 提供的要好得多。例如：

*   它为您提供并发性和真正的并行性，因此您可以编写在需要使用 CPU 执行某些工作时不会阻塞系统的代码
*   异步工作流提供了处理异常和处理资源的简单方法
    （您可以`try .. with`在异步（或基于事件）代码中使用）
*   基于代理的编程模型为您提供了一种存储状态的好方法

如果您可以使用 F# 来编写您的服务器端应用程序，那么您也可以使用它提供的强大抽象。有关简要介绍，请参阅[服务器端函数式编程](http://msdn.microsoft.com/en-us/library/hh273081.aspx)。我还在[服务器端做了一个 F#](http://skillsmatter.com/podcast/scala/talk-by-tomas-more-info-coming-soon)演讲，已经录制并讨论了相同的主题。

*这不一定是不尝试*的理由。尝试这可能会很有趣，如果你喜欢 F# 语言，但又想在 Node.js 环境中使用，那么拥有它会非常有用。

# objective-c - 无法在 iOS 中显示表格单元格左侧的缩略图

> ID：12647988
> 
> 赞同：0
> 
> 时间：2012-09-28T22:06:37.943
> 
> 标签：objective-c, ios, nsstring, uiimage, nsdata

我在 SO 上看到了几篇关于此的帖子，但这些解决方案似乎对我不起作用。也许是因为我通过 JSON 获取图像 URL。JSON 中的所有其他文本字段都通过了 OK，这只是我无法显示并收到 SIGABRT 错误的图像。

有问题的代码是这样的：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"PostCell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    NSDictionary *post           = [posts objectAtIndex:indexPath.row];
    NSString     *postText       = [post objectForKey:@"post_text"];
    NSString     *postAuthorName = [post objectForKey:@"post_author_name"];
    NSString     *postPictureUrl = [post objectForKey:@"post_picture"];
    NSData       *data           = [NSData dataWithContentsOfURL:[NSURL URLWithString:postPictureUrl]];

    cell.textLabel.text       = postText;
    cell.detailTextLabel.text = [NSString stringWithFormat:@"by %@", postAuthorName];
    cell.imageView.image      = [UIImage imageWithData:data];

    return cell;
} 
```

我的表格单元格是字幕，没有其他更改或接线。

知道我在哪里搞砸了吗？

PS我使用`async`请求的完整代码

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"PostCell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    NSDictionary *post           = [posts objectAtIndex:indexPath.row];
    NSString     *postText       = [post objectForKey:@"post_text"];
    NSString     *postAuthorName = [post objectForKey:@"post_author_name"];

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        NSString *postpictureUrl = [post objectForKey:@"http://example.com/post/1200"];
        NSData   *data           = [NSData dataWithContentsOfURL:[NSURL URLWithString:postpictureUrl]];

//      NSLog(@"%@", data);

        dispatch_async(dispatch_get_main_queue(), ^{
//            [[cell imageView] setImage:[UIImage imageWithData:data]];
        });
    });

    cell.textLabel.text       = postText;
    cell.detailTextLabel.text = [NSString stringWithFormat:@"by %@", postAuthorName];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:42:55.193

一些小的更改和以下作品（即，标题和副标题左侧的缩略图显示）。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {

        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }

    NSDictionary *post           = [posts objectAtIndex:indexPath.row];

    cell.textLabel.text       = [post objectForKey:@"post_text"];
    cell.detailTextLabel.text = [post objectForKey:@"post_author_name"];

    NSString *postpictureUrl = [post objectForKey:@"picture"];
    NSData   *data           = [NSData dataWithContentsOfURL:[NSURL URLWithString:postpictureUrl]];

    cell.imageView.image = [UIImage imageWithData:data];

    return cell;
} 
```

注意使用`initWithStyle:UITableViewCellStyleSubtitle`代替`Default`。

这里的指南很重要：http: [//developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/TableViewCells.html](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/TableViewCells.html)

最后，请注意这是图像的同步下载，这在现实世界中是行不通的。因此，我将在 SO 上发布另一个关于最佳解决方案的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T05:57:32.493

你可以这样做：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath

    [NSThread detachNewThreadSelector:@selector(downloadImages:) toTarget:self withObject:  [NSMutableDictionary dictionaryWithObjectsAndKeys:imageURL,@"imageURL",[NSIndexPath indexPathWithIndex:indexPath.row],@"indexPath", nil]]; 
```

调用上面的函数和

```
- (void) downloadImages:(NSMutableDictionary*)dict{

    NSURL *nurl = [NSURL URLWithString:[dict objectForKey:@"imageURL"]];

    NSURLRequest *req = [NSURLRequest requestWithURL:nurl];
    NSURLResponse * response;

    NSData *data = [NSURLConnection sendSynchronousRequest: req returningResponse: &response error: &error];

    UITableViewCell *cell = [YOURTABLENAME cellForRowAtIndexPath:(NSIndexPath*)[dict objectForKey:@"indexPath"]];

    cell.imageView.image = [UIImage imageWithData:data];

    if (error) {...handle the error}
} 
```

# linux - 如何从核心文件中定位线程的堆栈基础？

> ID：12647995
> 
> 赞同：1
> 
> 时间：2012-09-28T22:07:14.480
> 
> 标签：linux, debugging, gdb, core

我有一个核心转储，显示线程在执行时因 SIGBUS 信号而死机`mov %r15d,0xa0(%rsp)`。这似乎告诉我它死了，因为它用完了线程堆栈。

但是我怎么证明呢？除了线程回溯之外，我似乎找不到显示线程信息的 GDB 命令。在这种情况下，没有回溯。它显示当前函数，然后显示 0x0000000000000000。我认为，堆栈损坏的另一个迹象。

我没有 /proc/[pid]/maps 程序死亡时的副本。我可以查看 GDB 或核心文件中的任何内容以查找每个线程堆栈的基础吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:40:07.233

> 这似乎告诉我它死了，因为它用完了线程堆栈。

很可能

> 但是我怎么证明呢？

```
(gdb) p/x $rsp
$1 = 0x7fffc5791000

(gdb) info target
Symbols from "a.out".
Local core dump file:
    `core', file type elf64-x86-64.
    0x0000000000400000 - 0x0000000000401000 is load1
    ...
    0x00007faaf2240000 - 0x00007faaf2241000 is load14
    0x00007fffc5791000 - 0x00007fffc5f91000 is load15
    0x00007fffc5faf000 - 0x00007fffc5fb0000 is load16
    0xffffffffff600000 - 0xffffffffff600000 is load17
 Local exec file:
  ... 
```

注意段`$rsp`的（低）端如何`load15`，并且没有“覆盖”的映射`$rsp-8`

# javascript - 将速记JS添加到父级

> ID：12647996
> 
> 赞同：3
> 
> 时间：2012-09-28T22:07:26.333
> 
> 标签：javascript, json, google-apps-script

我正在创建一些速记 js 变量，这些变量最终将合并到父级中以创建一些 XML。我的速记js在这里做错了什么？我有点失落。

我想出了这个简短的例子来概述我的问题：

```
function testing() {
  var attachments = [];

  var attachment1 = [ "attachment" ,
                     [ "name", "myname1" ],
                     [ "type", "mytype1" ]
                    ];
  attachments.push(attachment1);
  var attachment2 = [ "attachment" ,
                     [ "name", "myname2" ],
                     [ "type", "mytype2" ]
                    ];
  attachments.push(attachment2);

  var email = [ "email",
               [ "subject", "mySubject"],
               [ "body", "myBody"],
               [ "attachments", attachments ]
              ];
  Logger.log(Xml.parseJS(email).toXmlString());
} 
```

日志输出：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<email>
    <subject>mySubject</subject>
    <body>myBody</body>
    <attachments>[Ljava.lang.Object;@b06f679</attachments>
</email> 
```

理想情况下，它应该是：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<email>
    <subject>mySubject</subject>
    <body>myBody</body>
    <attachments>
        <attachment>
            <name>myname1</name>
            <type>mytype1</type>
        </attachment>
        <attachment>
            <name>myname2</name>
            <type>mytype2</type>
        </attachment>
    </attachments>
</email> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:07:46.243

您正在将数组放入数组中。

```
var attachment1 = [ "attachment" ,
                   [ "name", "myname1" ],
                   [ "type", "mytype1" ]
                  ];

var attachment2 = [ "attachment" ,
                   [ "name", "myname2" ],
                   [ "type", "mytype2" ]
                  ];

var email = [ "email",
             [ "subject", "mySubject"],
             [ "body", "myBody"],
             [ "attachments"]
            ];
email[3].push(attachment1);
email[3].push(attachment2); 
```

You can use console.log(email) to see the different in the structures the web browser

This will also the same thing is more readable

```
attachments = ["attachments"];
attachments.push(attachment1);
attachments.push(attachment2);
var email = [ "email",
              [ "subject", "mySubject"],
              [ "body", "myBody"],
              attachments
            ]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:24:36.693

错误在这一行：

```
[ "attachments", attachments ] 
```

这有效地做的是：

```
[ "attachments", [ [attachment1], [attachment2] ] ] 
```

而正确的应该是：

```
[ "attachments", [attachment1], [attachment2] ] 
```

一种解决方案是：

```
var email = [ "email",
              [ "subject", "mySubject"],
              [ "body", "myBody"],
              [ "attachments", attachment1, attachment2 ]   //<-- The attachment row must have two childs not one. 
            ]; 
```

或者，您可以按如下方式初始化附件数组：

```
var attachments = ['attachments'] 
```

然后按照上面的测试代码推送附件。最后，电子邮件将是：

```
var email = [ "email",
              [ "subject", "mySubject"],
              [ "body", "myBody"],
              attachments
            ]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T08:31:09.990

我建议使用[E4X 扩展](http://en.wikipedia.org/wiki/ECMAScript_for_XML)在 GAS 中创建 XML。这是一个例子。both`getOrgXML`和`createXMLFromCode`函数创建相同的 XML 字符串。

```
function getOrgXML() {
  var xml = <email>
    <subject>mySubject</subject>
    <body>myBody</body>
    <attachments>
        <attachment>
            <name>myname1</name>
            <type>mytype1</type>
        </attachment>
        <attachment>
            <name>myname2</name>
            <type>mytype2</type>
        </attachment>
    </attachments>
  </email>;
  return xml;
}

function createXMLFromCode() {
  var attachment = <attachment/>;
  attachment.name = '';
  attachment.type = '';
  var email = <email/>;
  email.subject = 'mySubject';
  email.body = 'myBody';
  email.attachments = <attachments/>;
  var attach1 = attachment.copy();
  attach1.name = 'myname1';
  attach1.type = 'mytype1';
  var attach2 = attachment.copy();
  attach2.name = 'myname2';
  attach2.type = 'mytype2';
  email.attachments.appendChild(attach1);
  email.attachments.appendChild(attach2);
  return email;
}

function testXML() {
  var areEqual = getOrgXML().toXMLString() == createXMLFromCode().toXMLString();
  return areEqual;
} 
```

# php - 重构具有相同扩展但相互调用方法的类的可能性

> ID：12647997
> 
> 赞同：0
> 
> 时间：2012-09-28T22:07:28.457
> 
> 标签：php, class, refactoring

A 类和 B 类都扩展了 C 类，并且 C 类中有一些 A 类和 B 类都需要的常用方法。

有些情况需要从A类调用B类中的方法，目前是通过在A类中创建B类的对象来实现的，但是C类中添加的方法越来越多，效率低下由于重复，在 A 类中创建 B 类的对象。

我的问题是重构类以使其具有更好的结构的可能解决方案是什么，例如使用面向对象、工厂模式等？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:14:09.700

您可以使用[Traits](http://php.net/traits)（仅 PHP >= 5.4.0）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:36:43.547

如果 A 和 B 所需的方法可以分解为单一职责，那么您可以考虑添加类 D，然后由类 A 和 B 使用。单一职责主体 (SRP) 是 SOLID 中的 S，它是面向对象设计。

您可以在 Google 上找到大量关于 SOLID 的一般信息，以及 SRP 在 PHP 中的应用。我在 SRP 上向我们当地的 PHP 聚会小组做了一个演示，可以在这里在线找到：[SRP 演示](http://blog.vicmetcalfe.com/2011/11/02/solid-php-code-smells-part-1-single-responsibility-principle/)

# java - 正则表达式（Java）提取href属性值

> ID：12647998
> 
> 赞同：-1
> 
> 时间：2012-09-28T22:07:36.910
> 
> 标签：java, regex

我在 xml 文件中有一个标签，例如

```
<a href="/abc/xyz/ccc" id="link_abc" title="bala" name="link_abc"></a> 
```

所以我将此值存储在一个名为 tempString 的字符串中；现在我必须解析 tempString 以便我只能提取 href 属性值。我期待的输出是/abc/xyz/ccc。我正在寻找 Java 正则表达式来执行此操作。

我非常感谢您在这方面的帮助。

问候，罗摩克里希纳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:13:48.783

为什么不使用[jsoup](http://jsoup.org/)？

IE ：

```
Document doc = Jsoup.connect("http://yoururl.com/").get();
Elements link = doc.select("#link_abc");
String href = link.attr("href"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:17:42.510

你可以使用 String.split();

```
 String h = "<a href=\"/abc/xyz/ccc\" id=\"link_abc\" title=\"bala\"   name=\"link_abc\">planx</a>";
System.out.println(h.split("href")[1].substring(2).split("\"")[0]);

OUTPUT: /abc/xyz/ccc 
```

# javascript - 在子窗口打开时阻止在父浏览器窗口中导航

> ID：12647999
> 
> 赞同：0
> 
> 时间：2012-09-28T22:07:50.700
> 
> 标签：javascript, browser

///这是在javascript中显示弹出窗口的代码。如何防止用户返回父窗口，直到他关闭弹出窗口？

```
<script type="text/javascript">
 <!--
  var stile = "top=10, left=10, width=600, height=800 status=no, menubar=no, toolbar=no scrollbar=no";
     function Popup(apri) {
        window.open(apri, "", stile);
     }
 //-->
</script>
<a href="javascript:Popup('YOURPAGE.html')">show popup</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:10:45.377

在不是弹出窗口的现代浏览器中，它是在浏览器中打开的一个新选项卡。检查 jquery 或其他 javascript 库以创建适当的**模式**弹出窗口。这就是你要找的。

查看[http://jqueryui.com/demos/dialog/#modal](http://jqueryui.com/demos/dialog/#modal)

有无数这样的开箱即用的解决方案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:18:10.030

这`window.open()`将打开一个新的浏览器窗口或选项卡，它们都不会阻止用户返回到父窗口。这种类型的窗口称为[模态窗口](http://en.wikipedia.org/wiki/Modal_window)，是一种常见的 UI 范例。

我建议在谷歌上搜索`javascript modal`or `javascript overlay`，你会得到很多解释如何做到这一点的结果。这需要一些工作，但它是学习现代 javascript 技术的一个很好的课程。

根据您的需要，您可能需要查看 javascript 库来解决此问题，或者您可以手动编写 javascript 和 CSS。