# StackOverflow 问答 12713000-12713999

# python - 无法通过套接字'/opt/local/var/run/mysql55/mysqld.sock'连接到本地MySQL服务器（2）

> ID：12713000
> 
> 赞同：1
> 
> 时间：2012-10-03T16:41:59.017
> 
> 标签：python, mysql, mysql-python

> **可能重复：**
> [Python：MySQLdb 连接问题](https://stackoverflow.com/questions/758819/python-mysqldb-connection-problems)

MySQL 服务器运行正常，但我的 python 没有在 mysql 中连接 MySQL-python 库，为什么？

```
$ port installed
mysql55 @5.5.27_0 (active)
mysql55-server @5.5.27_0 (active)
mysql_select @0.1.2_0 (active) 
```

显示表格确定...

```
$ mysql -uroot -Dtest
mysql> SHOW TABLES;
Empty set (0.00 sec) 
```

我的python安装

```
$ pip freeze
Django==1.4.1
MySQL-python==1.2.4b2 
```

为什么？

```
$ python
Python 2.7.3 (default, Jul 30 2012, 16:41:43) 
[GCC 4.2.1 Compatible Apple Clang 4.0 ((tags/Apple/clang-421.0.57))] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import MySQLdb
>>> db = MySQLdb.connect(host="localhost", port=3306, user="root", passwd="", db="test")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "build/bdist.macosx-10.7-x86_64/egg/MySQLdb/__init__.py", line 81, in Connect

  File "build/bdist.macosx-10.7-x86_64/egg/MySQLdb/connections.py", line 187, in __init__
_mysql_exceptions.OperationalError: (2002, "Can't connect to local MySQL server through socket '/opt/local/var/run/mysql55/mysqld.sock' (2)")

$ ll /opt/local/var/run/mysql55/mysqld.sock
ls: /opt/local/var/run/mysql55/mysqld.sock: No such file or directory 
```

# c++ - shared_ptr 会自动释放内存吗？

> ID：12713004
> 
> 赞同：6
> 
> 时间：2012-10-03T16:42:13.920
> 
> 标签：c++, memory-management, shared-ptr

我需要在这里使用 shared_ptr 因为我无法更改 API。

```
Foo1 *foo1 = new Foo1(...);
shared_ptr<Foo2> foo2(foo1); 
```

这里的 shared_ptr 是否会处理释放 foo1 使用的内存？如果我理解正确，我不应该在 foo1 上调用 delete 对吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-03T16:45:16.123

是的。你是对的，但正确的初始化方法`foo2`是：

```
std::shared_ptr<Foo2> foo2 = std::make_shared<Foo1>(); 
```

`std::make_shared<>()`Herb Sutter 讨论了您应该在此处 使用的原因： [https ://herbsutter.com/2013/05/29/gotw-89-solution-smart-pointers/](https://herbsutter.com/2013/05/29/gotw-89-solution-smart-pointers/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T16:44:24.177

您不应该在 foo1 上调用 delete。

最好不要创建 foo1。只有 foo2：

```
shared_ptr<Foo2> foo2(new Foo1(...)); 
```

*   std::shared_ptr: [http://en.cppreference.com/w/cpp/memory/shared_ptr](http://en.cppreference.com/w/cpp/memory/shared_ptr)

> std::shared_ptr 是一个智能指针，它通过指针保留对象的共享所有权。

如果您不需要共享此指针 - 考虑使用`std::unique_ptr`

*   std::unique_ptr: [http://en.cppreference.com/w/cpp/memory/unique_ptr](http://en.cppreference.com/w/cpp/memory/unique_ptr)

> std::unique_ptr 是一个智能指针，它： 通过指针保留对象的唯一所有权，并在 unique_ptr 超出范围时销毁指向的对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T16:45:51.103

正确的。智能指针提供所有权语义。特别是，提供的语义使得`std::shared_ptr`一旦最后一个`shared_ptr`指向它的对象被销毁，该对象将被删除。`shared_ptr`保持一个引用计数（有多少个`shared_ptr`s 正在引用该对象），当它达到 0 时，它会删除该对象。

# paypal - 使用一个令牌处理经常性和非经常性付款

> ID：12713009
> 
> 赞同：0
> 
> 时间：2012-10-03T16:42:34.090
> 
> 标签：paypal

我正在尝试一次性处理一组定期付款和一次非定期付款，但是使用 0 作为经常性金额的定期付款选项会引起大惊小怪（说付款金额必须大于 0），并且使用 CallMarkExpressCheckout 会生成另一个令牌，然后由于令牌无效，它会阻止处理定期付款。如何一次性处理两种不同类型的付款？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:06:52.270

我不确定您正在使用的功能，但 PayPal 的 API 支持这一点。您可以在 SetExpressCheckout API 调用中简单地传递一个“INITAMT”，它会立即向买家收取适当的金额，并在调用 CreateRecurringPaymentsProfile API 调用后返回一个定期付款配置文件 ID。

# eclipse - Eclipse 无法将所有依赖项部署到 Tomcat

> ID：12713010
> 
> 赞同：0
> 
> 时间：2012-10-03T16:42:38.317
> 
> 标签：eclipse, tomcat

我在 Eclipse 的 Tomcat6 中运行 webapp 时遇到了 ClassNotFoundException。我的 webapp (projectA) 有两个项目依赖项 - 一个是标准项目 (projectB)，第二个是另一个 web 项目 (projectC)。

我已在“服务器”选项卡中将 Tomcat 设置为服务器，并且 projectA 和 projectC 都部署到了 Tomcat。我可以毫无问题地运行和调试projectC。我可以运行/调试 projectA，但找不到 projectC 中的任何类。

我查看了 tomcat/webapps/projectA/WEB-INF/lib 目录，并且 projectC 的 jar 不存在。tomcat/webapps/projectA/WEB-INF/classes 中也缺少 projectC 的类，但是 projectB 中的所有类都在那里。

当我查看 projectA 的 buildpath->projects 列表时，会列出 projectB 和 projectC。当我查看 projectA 的 buildpath->Order 和 Export 列表时，会列出 projectB 和 projectC。

我假设问题围绕着 projectC 是一个 Web 项目而不是一个标准项目这一事实 - 但我不确定解决方法是什么。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:00:53.240

您的问题可能是部署程序集。打开项目 A 的属性并转到部署程序集（左侧）。如果项目 C 未在此处列出，请单击添加并选择项目 C（以及项目 A 具有的任何其他依赖项）。

# sql-server - 多行计算 SQL Server

> ID：12713011
> 
> 赞同：1
> 
> 时间：2012-10-03T16:42:40.190
> 
> 标签：sql-server, tsql

我有一张桌子：

```
UNIQUE KEY ID      Clicks    INSERTDATE
 1         100001   10     2011-05-14 00:00:00.000
 2         100001   20     2011-05-13 00:00:00.000
 3         100001   30     2011-05-18 00:00:00.000
 4         100002   10     2011-05-20 00:00:00.000
 5         100002   15     2011-05-24 00:00:00.000
 6         100002   10     2011-05-05 00:00:00.000 
```

我有一个点击阈值，比如说 20。

我需要编写一个 T-SQL，它应该删除不符合每个 ID 的累积点击总和阈值的点击。

因此，对于上面的示例 ID“100001”，累积点击次数为 60 (10+20+30)，但由于阈值为 20，因此应从结果中删除最后一条记录，即点击值为 30 的记录。但是，即使该点的总和 > 我的阈值 (10 + 20)，仍应包括第二条记录。

编辑 ：

另一个需要应用的主要规则是在执行任何计算之前必须对 INSERTDATE 进行排序

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T16:53:02.763

如果我正确理解了这个问题，您想过滤给定 ID 的 RunningTotal，如下所示：

```
select c1.*
from ClickTable c1
outer apply (
  select sum(Clicks) as RunningTotal
  from ClickTable 
  where pk < c1.pk
    and id = c1.id
) c2
where isnull(RunningTotal, 0) <= 20 
```

这意味着您在表中有一个唯一的键字段，称为`PK`.

### 运行示例：[http ://www.sqlfiddle.com/#!3/98173/11](http://www.sqlfiddle.com/#!3/98173/11)

## 更新

要通过点击而不是主键进行排序，只需更改行

```
where pk < c1.pk 
```

至

```
where Clicks < c1.Clicks 
```

### 运行示例：[http ://www.sqlfiddle.com/#!3/31750/2](http://www.sqlfiddle.com/#!3/31750/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T16:46:11.757

我希望我正确地阅读了这个问题。似乎太简单了：

```
SELECT ID, SUM(Clicks) AS Clicks 
FROM t1
WHERE Clicks <= 20                 -- <== this is your threshold
GROUP BY ID 
```

会给你

```
ID 点击次数
100001 30
100002 35
```

# amazon-web-services - 无法更改现有 AWS::AutoScaling::Trigger 的任何属性

> ID：12713015
> 
> 赞同：0
> 
> 时间：2012-10-03T16:42:47.913
> 
> 标签：amazon-web-services, amazon-cloudformation

我有点困惑；我似乎无法更改与现有 AWS::AutoScaling::Trigger 关联的任何属性。

这似乎是您在完成设置后想要做的一件非常基本的事情。可能会调整期限、违反持续时间、增量、上限+下限。

如果我使用我的模板，只需更改“UpperThreshold”属性，并尝试用它更新我现有的堆栈，我会收到此错误并且更新失败：

```
The following resource(s) failed to update: [AutoscalingTrigger].
Updating the properties of AWS::AutoScaling::Trigger resources is not supported. 
```

建议？

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T05:50:54.300

我不确定这是否有帮助，但我在[UpdateAutoScalingGroup](http://docs.amazonwebservices.com/AutoScaling/latest/APIReference/API_UpdateAutoScalingGroup.html)页面上看到了这个注释：

> “要使用 InstanceMonitoring 标志设置为 False 的启动配置更新 Auto Scaling 组，您必须首先确保禁用组指标收集。否则，对 UpdateAutoScalingGroup 的调用将失败。如果您之前启用了组指标收集，您可以通过调用 DisableMetricsCollection 来禁用所有组指标的收集。”

# javascript - 最多可以在 3 个选项卡中打开的网页 - 如何？

> ID：12713017
> 
> 赞同：-3
> 
> 时间：2012-10-03T16:42:50.257
> 
> 标签：javascript, browser

可以这样制作网页吗？如何？我可以在 javascript 中使用 onunload 或 onbeforeunload 之类的事件，但不是每个浏览器都可以处理它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T16:57:04.257

人们可能不会喜欢这个，但一个选项是用来`localStorage`存储打开了多少个窗口。在您的页面`<head>`部分：

```
// Check localStorage item - if it exists, see if the count is 3 (or greater, I guess)
//   -If so, redirect this page somewhere else (attempt to use window.close(), otherwise redirect this page to some other page)
//   -If not, increment the counter
// If localStorage item doesn't exist - create it and set it to 1
// What I mean by "item" is that localStorage is basically key/value pairs, so check for your key you want to store this as    

$(window).on("unload", function () {
    // Decrement count in localStorage
}); 
```

我不确定当浏览器进程以意外方式终止时“卸载”如何工作，但这可能是个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T16:46:08.077

这是不可能的。您无法更改用户可以从远程服务器打开的选项卡数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:10:06.983

这有点粗糙，但可能会奏效。如果您可以识别用户（登录等），那么您可以让基于 JS 的心跳消息从浏览器发送到您的服务器，每隔 1-2 秒使用用户名和每个打开页面的唯一标识符。这样一来，您就可以在服务器上根据用户收到的独特心跳数，了解该页面为用户打开的选项卡数量，如果他尝试第四次，您可以拒绝从服务器提供该页面。一旦心跳消息停止 30 秒或 1 分钟（超时），您可以考虑关闭选项卡。

这可以处理意外的浏览器关闭，并且不需要对客户端环境进行任何特殊访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T16:46:13.043

这是不可能的。您无法阻止网站以这种方式打开新标签页。或者用户应该允许你访问他的电脑以保持标签的数量..（但到底谁会接受呢？）

# meteor - 错误：无法将 $push 修饰符应用于 Meteorjs 中的非数组

> ID：12713018
> 
> 赞同：2
> 
> 时间：2012-10-03T16:42:53.123
> 
> 标签：meteor

这是一个添加字典作为主文档的子项的功能。

```
addSubItem = function(id, data) {
  s = Item.findOne(id);
  if(s){
    Item.update({_id:id},{$push:{'subItemsList':data}});
  }
}; 
```

我验证传递的数据并且是有效的主文档 id 子项数据。

```
data = {num:1, value: 'Subitem1'}; 
```

昨天使用最新版本的流星（0.4.2）可以正常工作，但今天我在 javascript 控制台收到此消息：

```
Error: Cannot apply $push modifier to non-array 
```

我创建并设置了一个新项目，但我仍然得到相同的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T13:27:56.270

感谢 Lloyd，很好的解决方法并感谢 javascript 速成课程（我是初学者），但我找到了解决方案：（注意“$push”）

```
addSubItem = function(id, data) {
  s = Item.findOne(id);
  if(s){
    Item.update({_id:id},{"$push":{'subItemsList':data}});
  }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T16:47:03.730

尝试这个：

```
addSubItem = function(id, data) {
  s = Item.findOne(id);
  if(s){
    s.subItemsList = s.subItemsList || [];
    s.subItemsList.push(data);
    Item.update(id, s);
  }
}; 
```

# sql - 使用 MID 命令过滤组合框和 SQL

> ID：12713022
> 
> 赞同：0
> 
> 时间：2012-10-03T16:43:04.853
> 
> 标签：sql, database, vba, ms-access

我已经尝试并试图让这段代码正常工作，但没有运气。

该代码应该选择与 cmbsource 具有相同产品代码部分的产品。

```
Private Sub cmbSource_AfterUpdate()

Dim Worktop As String

If ProductType = 1 Then

Worktop = "SELECT [products/stock].[Product Code], [products/stock].Description, [products/stock].[Stock Level] FROM [products/stock] " & _
"WHERE Category = 'DPALRC' " & _
"AND Mid('[Product Code]',1,5) = Mid('" & Me.cmbSource.Value & "',1,5) " & _
"AND Mid('[Product Code]',9,6) = Mid('" & Me.cmbSource.Value & "',9,6) " & _
"ORDER BY [Product Code];"

Me.cmbResult.rowSource = Worktop
Me.cmbResult = vbNullString

End If 
```

有任何想法吗？

在此先感谢，鲍勃 P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:29:04.113

这里只是一个疯狂的猜测。

```
Worktop = "SELECT ps.[Product Code], ps.Description, ps.[Stock Level]" & vbCrLf & _
"FROM [products/stock] AS ps" & vbCrLf & _
"WHERE ps.Category = 'DPALRC'" & vbCrLf & _
"AND Mid([Product Code],1,5) = '" & Mid(Me.cmbSource,1,5) & "'" & vbCrLf & _
"AND Mid([Product Code],9,6) = '" & Mid(Me.cmbSource,9,6) & "'" & vbCrLf & _
"ORDER BY ps.[Product Code];"
Debug.Print Worktop 
```

转到立即窗口 ( `Ctrl+g`) 并从那里复制语句。然后创建一个新的 Access 查询，切换到 SQL 视图，粘贴语句文本并运行它。

如果我建议的代码没有返回您想要的结果，请向我们展示实际的 SQL 语句文本并解释它有什么问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T07:32:24.157

```
Worktop = "SELECT [products/stock].[Product Code], [products/stock].Description, [products/stock].[Stock Level] FROM [products/stock] " & _
"WHERE Category = 'DPALRC' " & _
"AND Mid([Product Code],1,5) = Mid('" & Me.cmbSource.Value & "',1,5) " & _
"AND Mid([Product Code],9,6) = Mid('" & Me.cmbSource.Value & "',9,6) " & _
"ORDER BY [Product Code];" 
```

这是我的更新版本，原来编码中唯一的错误是在`[Product Code]`.

# ios - 调用静态库会使我的 iOS 模拟器崩溃

> ID：12713024
> 
> 赞同：0
> 
> 时间：2012-10-03T16:43:18.160
> 
> 标签：ios, ios-simulator, static-libraries, xcode4.5, ios-frameworks

自从过渡到 XCode 4.5 并使用 iOS 6 SDK 构建后，每次调用第三方框架或静态库 .a 文件时，我的应用程序都会崩溃。最初，当我过渡到 XCode 4.5 时，这些框架起作用了。当我开始更新框架时，这个问题开始出现。删除旧版本的框架并添加新版本后，我的模拟器开始崩溃。

在设备上运行代码按预期运行，但只要我在模拟器上调用我的任何一个第三方框架或静态库，我就注定要失败。导致崩溃的一些框架是 Parse Framework、Socialize。错误

有没有人经历过这个或希望找到解决方案？设备上的测试速度较慢，但​​真正令人沮丧的是我无法在我的应用程序上运行任何单元测试。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T16:52:50.517

既然您说您更新了框架或静态库：

*   您确定这些框架/库的 API 在此期间没有改变吗？
*   您确定您在应用程序项目的构建阶段再次在“Link Binary With Libraries”中添加了框架，以将您的应用程序与 fmk/libs 链接？
*   还要确保该`-ObjC`标志仍然存在于您的应用程序的“其他链接器标志”构建设置中，即使您已经拥有它（就像以前一样）也没有理由不这样做。

此外，调用这些方法时的崩溃日志和错误消息是什么？

# python - 列表上的 Python 2 字符串操作

> ID：12713025
> 
> 赞同：0
> 
> 时间：2012-10-03T16:43:21.360
> 
> 标签：python, string, list

列表需要转换为字符串并执行字符串操作，

有没有一种有效的方法可以将这两个操作都转换为 1，

```
lista = ['col-1,','col-2,','col-3,']

stra = ' '.join(lista)

stra = stra.rstrip(',') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T16:47:03.090

怎么样`', '.join(['col-1', 'col-2', 'col-3'])`？那你根本不需要`rstrip`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T16:46:36.647

所有字符串方法都返回新字符串。

```
stra = " ".join(s.rstrip(",") for s in lista) 
```

或者，如果您只想修剪最后一个逗号，只需`" ".join(lista).rstrip(",")`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T16:48:21.183

由于该`join()`方法返回一个字符串，因此您可以链接方法：

```
stra = ' '.join(lista).rstrip(',')  # prints col-1, col-2, col-3 
```

或者，如果你想在加入字符串之前去掉逗号（因为你在每个字符串的末尾都有逗号，我假设你想要这样做）：

```
stra = ' '.join(map(lambda s: s.rstrip(','), lista))  # prints col-1 col-2 col-3 
```

或者：

```
stra = ' '.join(s.rstrip(',') for s in lista)  # prints col-1 col-2 col-3 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T16:57:52.347

我不完全确定“将两个操作都转换为 1”是什么意思，但是如果您对 lista 没有任何控制权，并且可以依赖它采用指定的格式，那么只需执行

```
' '.join(lista)[:-1] 
```

如果您*确实*可以控制 lista，请按照[nneonneo 的](https://stackoverflow.com/a/12713081/1015178)建议删除列表中的逗号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T16:45:58.437

由于您`join`返回一个字符串..因此，您可以链接另一个方法调用，而不是存储它...

```
stra = ' '.join(Lista).rstrip(',') 
```

或者，你可以这样做更好： -

```
stra = ' '.join(s.rstrip(',') for s in lista) 
```

这不会在您的列表项之间打印逗号（，）..

# sql - 数据库模式，指向文件的指针

> ID：12713026
> 
> 赞同：0
> 
> 时间：2012-10-03T16:43:23.217
> 
> 标签：sql, database, schema

这可能是一个非常简单的问题，但只是确保。我正在设计一个数据库模式，一些表应该链接到文件系统上的文件（PDF、PPT 等）。

这应该怎么做？

我最初的想法是 varchar(255) 与文件的绝对/相对路径。有一个更好的方法吗？我在网上搜索并找到了 varbinary(max)，但不确定这是否是我真正想要的；我不希望实际将任何二进制文件加载到数据库中，只是为了有一个指向文件的指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T16:47:06.507

这取决于操作系统和有效路径的最大长度。您所说的“指针”只是一个带有文件路径的文本字段，因此与其他字符数据没有什么不同。

我通常会存储相对路径，并在我的应用程序中指定根文件夹。例如，通过这种方式，您可以将文件移动到不同的驱动器，而不必更新数据库中的行。

您选择的实际数据类型取决于您使用的 dbms。一些数据库还为您可能想要探索的文件提供特定的数据类型，例如[`FileStream`](http://msdn.microsoft.com/en-us/magazine/dd695918.aspx)SQL Server 2008 中引入的数据类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T16:47:25.397

您需要在数据库中存储文件的名称，以及它的路径，对吗？然后您应该使用 varchar(255) 创建一个字段。我一直这样使用，从来没有遇到过问题。希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T16:49:05.257

如果您不想将文件的二进制数据存储在数据库中，那么存储路径是唯一的方法。存储绝对路径还是相对路径取决于您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T16:59:11.553

是的，基本上就是这样。在 Db 中配置为参数的某个位置的相对路径是它的常用方式。除了获得回合长度限制。

如果您说 C:MySystem\MyData 作为基本路径。然后你可以做 Images\MyImageFile.jpg、Docs\MyDopc.pdf 等。

请注意对备份和还原的影响。你必须做数据库和文件系统。

另一个可能的考虑因素是文件名必须是唯一的。所以你如果 Fred 和 Wilma 都上传 Picture1.jpg，db 没问题，但文件系统会被塞满。通常的方法是有一个用户文件名和一个实际文件名。

所以 Fred 的 Picture1.jpg 实际上是 p000004566.jpg

不要忘记添加代码来处理您认为应该存在的文件已被某些 twit 删除。

此外，在极不可能发生编码错误的情况下，整理孤立文件的某种管理任务也可能是有序的。:)

此外，如果文件的路径可由软件配置，请确保检查将执行该工作的帐户是否具有读写访问权限，可能还希望使用 UNC 路径，但不要让自己背负映射驱动器。

# php - 子路由中的 ZF2 可选路由约束

> ID：12713029
> 
> 赞同：6
> 
> 时间：2012-10-03T16:43:48.790
> 
> 标签：php, zend-framework2, zend-route

我遇到了一个路由中的可选约束问题，该路由在其子级中是非可选的。我的路由结构如下：

```
'profile' => [
    'type' => 'segment',
    'options' => [
        'route' => '/profile[/:id]',
        'constraints' => ['id' => '[0-9]*'],
        'defaults' => [
            'controller' => 'User\Controller\User',
            'action' => 'profile'
        ]
    ],
    'may_terminate' => true,
    'child_routes' => [
        'sessions' => [
            'type' => 'literal',
            'options' => [
                'route' => '/sessions',
                'defaults' => ['action' => 'sessions']
            ]
        ]
    ]
] 
```

在我看来，这应该给我以下路线：

1.  `/profile`- 作品
2.  `/profile/123`- 作品
3.  `/profile/sessions`-**不工作**
4.  `/profile/123/sessions`- 作品

当我在 URL 视图助手中使用路由 3 时，我收到以下错误：

```
$this->url('profile/sessions'); 
```

> `Zend\Mvc\Router\Exception\InvalidArgumentException`：缺少参数“id”

我最初有`[0-9]+`作为我的约束，但将其设为可选 ( `*`) 似乎没有帮助。有没有人经历过这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-05T07:51:50.670

将其添加到您的父路由。

```
'profile' => [
    'type' => 'segment',
    'options' => [                 // ↓ 
        'route' => '/profile[/:id][/:action]',
        'constraints' => [ 'id' => '[0-9]*', 'action' => '[a-zA-Z][a-zA-Z0-9_-]*' ],
        'defaults' => [
            'controller' => 'User\Controller\User',
            'action' => 'profile',
        ],
    ],
] 
```

这将使拥有`id`和/或`action`. 至少在理论上它应该使您列出的所有路线成为可能，这存在[一些问题](http://framework.zend.com/issues/browse/ZF2-407?page=com.atlassian.jira.plugin.system.issuetabpanels%3aall-tabpanel#issue-tabs)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T18:00:31.597

我曾经遇到过同样的问题，我发现的唯一解决方案是创建一个单独的路由（在您的情况下为 /profile/sessions）作为基本路由的可选参数，这在访问子路由时似乎成为强制性的。

# pdf - 跟踪从外部站点下载的 PDF

> ID：12713039
> 
> 赞同：1
> 
> 时间：2012-10-03T16:44:39.257
> 
> 标签：pdf, google-analytics

我有一个网站托管几个 PDF，这些 PDF 通常直接从其他网站链接到。

每当有人从外部站点登陆 PDF 页面时，我都希望能够跟踪（最好使用 Google Analytics）。

如果我可以使用`<embed>`以我的 PDF URL 作为`src`属性的标签来跟踪外部站点的页面何时加载我的 PDF，那也很棒。

通常的`_gaq.push`（等）方法（例如，[对于这个问题](https://stackoverflow.com/questions/8829655/google-analytics-track-pdf-downloads)）在这种情况下不起作用，因为我无法修改外部站点。

任何帮助将不胜感激。谢谢你。

# android - 在 Eclipse + Android 中智能重构文件名？

> ID：12713040
> 
> 赞同：5
> 
> 时间：2012-10-03T16:44:42.040
> 
> 标签：android, eclipse, refactoring

有没有办法重构类文件的名称以及Android项目中对该名称的所有引用？

例如，如果我 Refactor > Rename 文件 CustomerListFragment.java ，Android资源文件中的以下引用仍然需要手动更改。

```
 <fragment android:name="my.package.CustomerListFragment"
    android:id="@+id/item_list"
    android:layout_width="400dp"
    android:layout_height="match_parent"
    /> 
```

我认为 Visual Studio 会自动进行这种重构，Eclipse(Android) 中是否有任何等价物？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T16:48:09.313

是的，不是的，它实际上在他们的路线图上被列为： [更好的重构支持](http://tools.android.com/roadmap)

信不信由你，重构/重命名支持在过去几周实际上变得更好了。直到最近，在 Manifest 文件中替换类名和包名时仍然会出错（每当某些 Activity 文件名被重构/重命名时）。但最近，我没有收到这些错误，我很高兴这不再是我必须做的手动步骤。

[您还可以在http://b.android.com](http://b.android.com)上查看他们的错误跟踪器， 如果您真的想在这个确切的测试用例得到处理时得到通知，请给问题加注星标。

# javascript - 替换 innerHTML 并返回到保留事件的原始 HTML

> ID：12713042
> 
> 赞同：1
> 
> 时间：2012-10-03T16:45:03.947
> 
> 标签：javascript, jquery, html, dom, innerhtml

我有一个目标 div**显示**了一些组件。这些组件附加了一些事件（鼠标悬停，点击）。我不控制这段代码也不控制那些事件。他们就在那里。我想在这个 div 中渲染一个小部件。为此，我正在做类似的事情：

```
var save = el.innerHTML; 
el.innerHTML = "my widget code"; 
```

当我的小部件完成其过程时，我想回到原始内容，所以我这样做：

```
el.innerHTML = save; 
```

先前保存的组件已正确替换，但附加到它们的事件不再起作用。

我无法隐藏，显示 div。我需要替换 innerHTML 以获得准确的样式和定位。

在我的情况下你会怎么做？如果有帮助，我正在使用 jQuery。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T16:51:19.407

当您将 DOM 元素序列化回 HTML 时，所有事件处理程序和绑定数据都将丢失。

如果您有 DOM，请使用它，而不是使用 HTML：

```
var save = $(el).children().detach();
$(el).html(widgetHTML);

// later
$(el).empty().append(save); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T17:01:02.010

您可能会发现`.detach`有用 - [http://api.jquery.com/detach/](http://api.jquery.com/detach/)

它的作用与保留所有关联的 jquery 元素数据相同，`.remove`但会保留所有关联的 jquery 元素数据——这将包括使用 jquery 添加的任何事件侦听器，尽管您将丢失任何附加的“常规 dom 事件”。

您也必须使用 jQuery 重新附加元素：

```
var stored = $(el).detach();

//… wait for something to finish, then reattach

stored.appendTo('#outer'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T16:49:09.390

您可以将事件委托给您的`el`元素，因为它似乎没有改变 - 这些新添加的元素在绑定时不存在

```
$(el).on('click','yourelementtoattachevent',function(){
       // replace click with your event/events
       // your code goes here
}); 
```

这是假设您使用的是 jQuery 1.7+，供其他人使用

```
$(selector).live();                // jQuery 1.3+
$(document).delegate(selector, events, handler);  // jQuery 1.4.3+
$(document).on(events, selector, handler);        // jQuery 1.7+ 
```

# c - 反映赋值操作左边全局指针的变化

> ID：12713046
> 
> 赞同：1
> 
> 时间：2012-10-03T16:45:22.540
> 
> 标签：c, pointers

我正在编写一个如下所示的 C 程序，其中我将一个值分配给一个由全局指针指向的变量，该指针正在被赋值右侧的函数调用更改。

但是变化发生在它之前指向的位置。因此，对于以下代码，它会打印

"GP:5 P:5 GPV:11" ,

它应该在哪里

“GP:10 P:10 GPV:9”

我试过用-O2和-O0编译它。相同的输出。

我知道如果我将作业分成两行，它是固定的。但是我正在做的项目有很多这样的地方。

这是否可以让它像我想要的那样工作而不把它分成两行？

任何建议都受到高度赞赏。

```
#include <stdio.h>

int * gp;  
// volatile int *gp;   // I tried these two.    
// int * volatile gp;  // Didn't help.

int func(int *p) 
{  
   *p = 5;
   gp = p;  
   return *p;
}

int main()                                                                      
{                                                                               
   int p = 7;
   int gp_v;
   gp = &gp_v; 
   *gp = 8;
   *gp = func(&p) + *gp;
   gp_v ++;
   printf("GP:%d P:%d GPV:%d\n", *gp, p, gp_v);
   return(0); 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:18:27.917

此行具有未指定的行为：

```
*gp = func(&p) + *gp; 
```

C 标准没有指定在表达式中计算参数的顺序，因此编译器`func(&p)`可以在读取之前或之后自由执行`*gp`以计算加法。同样，它可以在评估`*gp`其存储的值之前或之后评估赋值左侧的 （以确定将结果存储到的地址）。

您需要将语句分解为单独的语句，以使其具有明确定义的行为。这些中的任何一个都可以工作，但它们具有不同的语义：

```
// Option 1: write to old location of *gp
int *old_gp = gp;
int old_gp_val = *gp;
*old_gp = func(&p) + old_gp_val;

// Option 2: write to new location of *gp
int old_gp_val = *gp;
int new_val = func(&p) + old_gp_val;
*gp = new_val; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:30:31.583

要将其保留在一行，您必须将其包装起来：

```
#include <stdio.h>

int * gp;  

int funcPlus(int *p, int *pGlobal)
{
    func(p);              // alters the value of *pGlobal
    return *p + *pGlobal; // use the new value
}

int func(int *p) 
{  
   *p = 5;
   gp = p;  
   return *p;
}

int main()                                                                      
{                                                                               
   int p = 7;
   int gp_v;
   gp = &gp_v; 
   *gp = 8;
   // *gp = func(&p) + *gp; // undefined behavior
   *gp = funcPlus(&p, gp);
   gp_v ++;
   printf("GP:%d P:%d GPV:%d\n", *gp, p, gp_v);
   return(0); 
} 
```

# jsf - 在动作事件之后触发哪个事件？

> ID：12713047
> 
> 赞同：1
> 
> 时间：2012-10-03T16:45:23.450
> 
> 标签：jsf, jsf-2, primefaces

我想显示带有值的模式弹出窗口的标题`chatBean.selectedUser`。发生的事情是`onclick`事件在事件之前触发，`action`因此在触发事件时页面不会刷新`onclick`。因此，我无法将 modal 的标题弹出为`chatBean.selectedUser`. 无论如何，我可以在`chatbean.selectedUser`提交页面后显示带有值的模式弹出窗口的标题吗？

这是视图的相关部分：

```
<h:form>
    <p:selectOneMenu value="#{chatBean.selectedUser}" id="select">
        <f:selectItems value="#{chatBean.friendList}" var="users" itemLabel="#{users.firstName}" itemValue="#{users.firstName}"/>
    </p:selectOneMenu>
    <p:commandButton id="basic"  value="Basic" onclick="dlg.show()" type="button"  action="#{chatBean.refresh}"></p:commandButton>      
    <p:dialog id="modalDialog" header="#{chatBean.selectedUser}" widgetVar="dlg" modal="true" height="100">  
        <h:outputText value="This is a Modal Dialog." />  
        <h:inputText></h:inputText>
    </p:dialog>
</h:form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T18:02:37.307

您应该仅在操作完成时才显示对话框，而不是之前。请改用该`oncomplete`属性。

```
<p:commandButton ... oncomplete="dlg.show()" /> 
```

不要忘记在打开对话框之前明确更新对话框的内容。我在您的代码中的任何地方都没有看到。也许您正在使用`RequestContext#update()`或其他东西，但通常您会`update`为此使用属性。

```
<p:commandButton ... update="modelDialog" oncomplete="dlg.show()" /> 
```

此外，这`type="button"`很奇怪。这种方式根本不会调用动作，但也许这只是实验的粗心剩余。去掉它。

# regex - WOFF 匹配正则表达式

> ID：12713048
> 
> 赞同：1
> 
> 时间：2012-10-03T16:45:33.400
> 
> 标签：regex, woff

我正在尝试验证 WOFF 链接中的每个字体名称，例如

```
<link href='http://fonts.googleapis.com/css?family=Anonymous+Pro:400,700italic,400italic,700|Radley:400,400italic' rel='stylesheet' type='text/css'> 
```

通过使用以下代码

```
<?php
$woff = 'Oswald:400,600,700Italic';
$f = preg_match('/^([a-zA-Z0-9+]{1,20}):{0,1}(([1-9]00(italic){0,1},{0,1}){0,3})/',$woff);
echo ($f);
?> 
```

这工作做得很好。但是，我绝不是 RegEx 专家，所以我怀疑我的 regex 是一个非常幼稚的。任何有关抛光它的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:15:08.290

与此正则表达式匹配`Anonymous+Pro:400,700italic,400italic,700`：

```
/([^:]+) *: *((?:[\d\w]+,*)+)/ 
```

回报：

```
> test.match(/([^:]+) *: *((?:[\d\w]+,*)+)/)
[ 'Anonymous+Pro:400,700italic,400italic,700',
  'Anonymous+Pro',
  '400,700italic,400italic,700',
  index: 0,
  input: 'Anonymous+Pro:400,700italic,400italic,700' ] 
```

看看你期望的输出是什么会很有帮助。

# redirect - 用户友好的网址显示

> ID：12713050
> 
> 赞同：0
> 
> 时间：2012-10-03T16:45:45.337
> 
> 标签：redirect, yii, routes, friendly-url

可以说我想直接显示 `http://example.com/topic/view/topicname/thenameofthetopic`为`http://example.com/thenameofthetopic`

所以我已经实现了，当输入时`http:// example.com/thenameofthetopic`，它会正确地将您重定向到控制器/动作，并且网站显示我想要显示的内容，问题当然是 URL 更改了，我希望它保持格式`http://example.com/thenameofthetopic`

触摸 htaccess 文件有可能吗？只需用 yii 配置即可

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T16:53:14.097

你的具体情况是：

```
'components'        => array(
  'urlManager' => array(
      'urlFormat'      => 'path',
      'showScriptName' => false,
      'rules' => array(
          "<name_of_topic:\w+>/" => 'controller/action'
       ),
   ),
) 
```

您将在 Yii::app()->request->getQuery('name_of_topic'); 中获得主题名称

**htaccess**是 Yii - 经典，必须存在：

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [L,QSA] 
```

我会建议你做另一种方式。

```
'components'        => array(
  'urlManager' => array(
      'urlFormat'      => 'path',
      'showScriptName' => false,
      'rules' => array(
          "t/<name_of_topic:\w+>/" => 'controller/action'
       ),
   ),
) 
```

所以主题链接将是[http://www.example.com/t/name_of_topic](http://www.example.com/t/name_of_topic)。这将允许您对文章等使用“a//”。

还有一件事。阅读这篇文章可以找到很多有趣的东西[http://www.yiiframework.com/doc/guide/1.1/en/topics.url](http://www.yiiframework.com/doc/guide/1.1/en/topics.url)

# java - JTextField 输入输出

> ID：12713052
> 
> 赞同：1
> 
> 时间：2012-10-03T16:45:56.490
> 
> 标签：java, swing, jtextfield

我正在尝试用 Java 设计一个英里到海里的计算器。

我能够通过控制台创建和运行它，但我在学习如何在 JFrames 中完成它时遇到了麻烦。

我基本上想做的是：

有两个文本字段和一个按钮，一个文本字段是英里，一个是海里，当您在一个文本字段中输入金额然后按下按钮时，结果将显示在另一个字段中。

我在下面粘贴了我的代码

不太确定下一步该做什么

```
package Mile_Conversion;

import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.SwingConstants;

public class OwnWindow implements ActionListener{

    public static void main(String[] args) {
        MyJFrame();

    }

    public static void MyJFrame() {

        //JLabel
        JLabel start = new JLabel("Enter the amount below to calculate");
        start.setBounds(/*x*/70, -65/*Y*/, 270, 150); // x, y, width, height    x across, y down
        JLabel milecon = new JLabel("Miles");
        milecon.setBounds(154, 55, 50, 150);
        JLabel nautcon = new JLabel("Nautical Miles");
        nautcon.setBounds(135, -15, 150, 150);

        //JTextField
        JTextField miles = new JTextField();
        miles.setBounds(100, 140, 150, 25);
        JTextField nautical = new JTextField();
        nautical.setBounds(100, 70, 150, 25);

        double mile, nautmile;

    /*
            mile = nautmile * 0.868;

            nautmile = mile * 1.150; 
    */

        //JButton
        JButton convert = new JButton("Convert");
        convert.setBounds(250, 200, 90, 25);

        //JFrame
        JFrame window = new JFrame("Milage Conversion");
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setSize(400, 300);
        window.setVisible(true);
        window.setLayout(null);
        window.setResizable(false);
        window.add(start);
        window.add(miles);
        window.add(nautical);
        window.add(convert);
        window.add(milecon);
        window.add(nautcon);

    }

    @Override
    public void actionPerformed(ActionEvent e) {

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T20:13:22.293

欢迎来到可变字体、分辨率和 DPI 的美妙世界，它在屏幕上的外观永远无法与其他任何人匹配（好吧，这有点夸张，但感觉就像 :P）

在这个世界上，布局管理器是你的朋友。它们将为您节省很多很多很多小时的挫败感和折磨。

我建议您通读一遍；

*   [使用布局管理器](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)
*   [布局管理器的视觉指南](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)

这是我对你正在尝试做的事情的看法......

```
public class TestConvertDistance {

    public static void main(String[] args) {
        new TestConvertDistance();
    }

    public TestConvertDistance() {

        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new DistancePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    protected class DistancePane extends JPanel {

        private JLabel lblInstruct;
        private JLabel lblMiles;
        private JLabel lblNauticalMiles;

        private JTextField fldMiles;
        private JTextField fldNauticalMiles;

        private JButton btnCalculate;

        public DistancePane() {

            lblInstruct = new JLabel("Enter the amount below to calculate");
            lblMiles = new JLabel("Miles");
            lblNauticalMiles = new JLabel("Nautical Miles");

            fldMiles = new JTextField(8);
            fldNauticalMiles = new JTextField(8);

            btnCalculate = new JButton("Convert");

            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.insets = new Insets(2, 2, 2, 2);
            gbc.anchor = GridBagConstraints.WEST;
            gbc.gridwidth = GridBagConstraints.REMAINDER;
            add(lblInstruct, gbc);

            gbc.gridx = 0;
            gbc.gridy++;
            gbc.anchor = GridBagConstraints.WEST;
            gbc.gridwidth = 1;
            add(lblMiles, gbc);

            gbc.gridy++;
            add(lblNauticalMiles, gbc);

            gbc.gridx = 1;
            gbc.gridy = 1;
            add(fldMiles, gbc);

            gbc.gridy++;
            add(fldNauticalMiles, gbc);

            gbc.gridx = 0;
            gbc.gridy++;
            gbc.anchor = GridBagConstraints.CENTER;
            gbc.gridwidth = GridBagConstraints.REMAINDER;
            add(btnCalculate, gbc);

            btnCalculate.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    // Do your calculation here...
                }
            });

        }

    }

} 
```

请注意，我使用过`GridBagLayout`，这是核心 API 中最强大和最复杂的布局管理器之一，所以如果一开始看起来很混乱，请不要担心；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T16:52:53.277

在方法内部编写转换代码`actionPerformed`：

*   从第一`JTextField`英里获取输入
*   将其解析为 int 或 float（作为`JTextField`s`getText()`方法返回`String`）
*   进行转换
*   将转换后的值设置为其他`JTextField`航海使用`nautical.setText();`方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:05:14.200

这是我的版本。它可能并不完美，也没有任何异常处理：

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.SwingConstants;

public class OwnWindow implements ActionListener
{

    JLabel start;
    JLabel milecon;
    JLabel nautcon;
    JTextField miles;
    JTextField nautical;
    JButton convert;
    JFrame window;

    double mile, nautmile;
    public static void main(String[] args) 
    {
        OwnWindow obj = new OwnWindow();

    }
    public OwnWindow()
    {
        start = new JLabel("Enter the amount below to calculate");
        start.setBounds(/*x*/70, -65/*Y*/, 270, 150); // x, y, width, height    x across, y down

        milecon = new JLabel("Miles");
        milecon.setBounds(154, 55, 50, 150);

        nautcon = new JLabel("Nautical Miles");
        nautcon.setBounds(135, -15, 150, 150);

        miles = new JTextField();
        miles.setBounds(100, 140, 150, 25);

        nautical = new JTextField();
        nautical.setBounds(100, 70, 150, 25);

        convert = new JButton("Convert");
        convert.setBounds(250, 200, 90, 25);
        convert.addActionListener(this);

        window = new JFrame("Milage Conversion");
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setSize(400, 300);
        window.setVisible(true);
        window.setLayout(null);
        window.setResizable(false);
        window.add(start);
        window.add(miles);
        window.add(nautical);
        window.add(convert);
        window.add(milecon);
        window.add(nautcon);
    }

    @Override
    public void actionPerformed(ActionEvent e) 
    {
        String strNaut = nautical.getText();
        String strMile = miles.getText();

        //this means the user wants to convert nautical to normal
        if(strNaut.length() > 0)
        {
            nautmile = Double.parseDouble(strNaut);
            miles.setText(nautmile*0.868 + "");
        }
        else if(strMile.length() > 0)
        {
            mile = Double.parseDouble(strMile);
            nautical.setText(mile*1.150 + "");
        }
    }
} 
```

# asp.net - 像类型一样使用的字段

> ID：12713054
> 
> 赞同：0
> 
> 时间：2012-10-03T16:46:00.593
> 
> 标签：asp.net

从字段作为类型开始，我在这里遇到了很多错误！我在这里尝试使用一个类，用户可以通过输入有关其外观的详细信息来创建时尚档案

```
public class Profile
    {
    public Profile()
    {
    }
    // method
    public string getMSG()
    {
        return "What;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T16:51:38.267

```
 if!string.IsNullOrEmpty(value); 
```

这应该是错误的，（删除“if”后的分号，将条件放在括号中）

```
 if (!string.IsNullOrEmpty(value))
    {
        // your code
    } 
```

也不应该有任何分号“;” 如果您正在获取/设置它，则在 eyeColor 之后。

```
 public string eyeColor 
```

# objective-c - 代表没有调用方法

> ID：12713055
> 
> 赞同：0
> 
> 时间：2012-10-03T16:46:01.920
> 
> 标签：objective-c, ios, objective-c-protocol

所以我有一个问题。有人可以告诉我这行代码调用（协议）方法的问题吗

```
 [self.delegate poplogin]; 
```

poplogin 是方法名称，由于某种原因它不起作用。它没有调用方法poplogin

以供参考 ：

```
@property(nonatomic,retain) id<loginAuthDelegate> delegate; 
```

所以让我解释一下这个案子

所以可以说我有一个类 abc.h

```
@protocol loginAuthDelegate <NSObject>
-(void)poplogin;
@end 
```

接口后

```
@property(nonatomic,retain) id<loginAuthDelegate> delegate;

in .m i am just calling the Delegate and @synthesize it
[self.delegate poplogin];

not i have another files
let say def.h
i am importing the Class abc.h
@interface def : UIViewController<loginAuthDelegate>

def.m
-(void)poplogin
{
NSLog(@"Delegate doesn't respond to here");
vmpaSecureLogin *ivc = [[vmpaSecureLogin alloc] init];
ivc.modalPresentationStyle = UIModalPresentationFormSheet;
[self presentModalViewController:ivc animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T16:49:40.817

这可能是`self.delegate`因为`nil`.

您可能忘记将您的对象影响`delegate`到您实现委托方法的其他对象，例如您的 ViewController 或其他东西。

# ruby-on-rails - 如何使用 Rails 中的链接更新属性？

> ID：12713056
> 
> 赞同：0
> 
> 时间：2012-10-03T16:46:02.470
> 
> 标签：ruby-on-rails, ruby

我想将名为“rang”的数据表中的属性更新`0`为`1`使用链接。

我有一个动作：

```
def ready
  @task = Task.find(params[:id])
  @task.update_attributes(:ready => '1')
  @task.save
  redirect_to :action => :index  
 end 
```

和一个链接：

```
<%= link_to 'READY', { :action => :ready, :id => task.id } %> 
```

但什么也没有发生。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T18:25:54.793

尝试 ：

在`routes.rb`

```
 resources :tasks do
      member do
        get 'ready'
      end
    end 
```

然后像这样链接：

```
<%= link_to 'READY', ready_task_url(task.id) %> 
```

# javascript - 获取用户的 1 度连接之间的距离？

> ID：12713057
> 
> 赞同：0
> 
> 时间：2012-10-03T16:46:04.753
> 
> 标签：javascript, api, linkedin

如何获取两个 1 度连接并获取它们之间的距离，以查看它们是否相互连接。到目前为止，我已经设法获得了授权用户的 1 度连接列表，但我对距离有疑问。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:02:41.500

您只能通过 API 使用`relation-to-viewer:(distance)` [field](https://developer.linkedin.com/documents/profile-fields#profile)直接确定与当前用户的任意用户的距离。

您需要让连接 A 登录并为连接 B 拉取该字段以确定距离。

# css - 在动态元素的右上角显示图像

> ID：12713071
> 
> 赞同：0
> 
> 时间：2012-10-03T16:46:29.693
> 
> 标签：css, positioning, image

我有一个“文章框”，用于具有 2 个不同宽度的几个不同页面。我有一个图像，我想在每个框的右上角显示。我如何使用 css 在每个框的右上角正确显示图像？

我有以下 css 代码不太好用，在此先感谢。

```
.wide-article-box {
    @extend .article-box;
        padding: 20px;
        max-width: 900px;

    #badge {
        position: relative;
        max-width:260px;    
    }

    #badge img {
            position: absolute;
        border-width: 0px;  
    }       
} 
```

并且在视图中

```
 <div class="wide-article-box">
     <!--text etc -->
      <div id="badge">  
        <%= image_tag "BLH_BADGE.png" %>            
      </div>
       </div 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T16:49:33.523

```
.wide-article-box {
    @extend .article-box;
        padding: 20px;
        max-width: 900px;
        position: relative;

    #badge {
        position: absolute;
            top: 0;
            right: 0;
        max-width:260px;    
    }

    #badge img {
        border-width: 0px;  
    }       
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:00:34.323

您可以查看`float`CSS 的属性。它还会自动将文本环绕在图像（或任何块元素）周围。

```
#badge {
    float: right;
    max-width: 260px;    
} 
```

PS 你可能还必须使用`clear`css 属性，但这取决于 DOM 的性质。只需阅读`float`和`clear`属性

# java - macos 上的端口绑定

> ID：12713080
> 
> 赞同：0
> 
> 时间：2012-10-03T16:46:58.640
> 
> 标签：java, sockets, osx-server

我在java中使用ServerSocket来检查mysql是否正在运行。如果它没有运行，我提示用户请运行你的 mysql 服务器。但是，我的一些用户抱怨虽然 mysql 正在运行，但我们收到了错误消息。它只发生在 macos 中。我发现的是 .

Java 代码：

```
public static boolean isPortFree(int port)
{
    if(port <= 0)
    {
        return false;
    }
    ServerSocket sock = null;
    try
    {
        String bindAddress = System.getProperty("bindaddress", "127.0.0.1");
        sock = new ServerSocket(port,0,InetAddress.getByName(bindAddress));
    }
    catch(Exception ex)
    {
        return false;
    }
    finally
    {
        if (sock != null)
        {
            try
            {
                sock.close();
            }
            catch (Exception e)
            {
                e.printStackTrace();
            }
        }
    }
    return true;
} 
```

如果我将系统属性设置`bindaddress`为`localhost`它返回 false 我设置为`127.0.0.1`返回 true 。localhost , 127.0.0.1 与它的行为相同。它只出现在 macos 中。我认为这不是`my.cnf`绑定地址问题。因为我签入了命令提示符

```
 mysql -uroot -hlocalhost
 mysql -uroot -h127.0.0.1 
```

两者都是作品。

**网络统计**

苹果系统

```
 tcp4       0      0  *.3306                 *.*                    LISTEN 
```

其他操作系统

```
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN 
```

tcp4和tcp有什么区别吗？

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T16:53:19.653

这两个示例有效地绑定到不同的接口：`INADDR_ANY`不阻止绑定到特定的适配器。

*如果在 OSX MySQL 上的配置与您报告的“其他操作系统*”完全相同，它将按预期工作。

# .net - 使用 vb.net 分割字符串的第一部分

> ID：12713097
> 
> 赞同：0
> 
> 时间：2012-10-03T16:47:31.420
> 
> 标签：.net, vb.net

下面是完美的工作代码，当我用谷歌搜索用分隔符分割字符串的第一部分时。

但是我有一个问题，因为此代码仅在目标框架为 4 时才有效我如何转换此代码，它将在目标框架 2 中运行

```
 Public Shared Function FirstFromSplit(ByVal source As String, ByVal delimiter As String) As String
        Dim i = source.IndexOf(delimiter)

       Return If(i = -1, source, source.Substring(0, i))

    End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T16:55:58.860

据了解，这两种字符串方法都存在于 2.0 中，所以我猜是返回语句带来了麻烦。尝试用旧样式重写它。

```
Public Shared Function FirstFromSplit(ByVal source As String, ByVal delimiter As String) As String 
     Dim i = source.IndexOf(delimiter) 

     If i < 0 Then
       return source
     Else
       return source.Substring(0, i)
     End if
End Function 
```

# windows - 为 HTML5 视频配置服务器

> ID：12713103
> 
> 赞同：0
> 
> 时间：2012-10-03T16:48:00.660
> 
> 标签：windows, html5-video

我正在尝试将 HTML 5 视频放在我的网站上，但由于某种原因它无法正常工作。

我将完全相同的文件夹放在两个不同的服务器上。一方面有效，另一方面无效。

这是它的工作原理： [http ://www.unitedsytes.com/vid/vid.php](http://www.unitedsytes.com/vid/vid.php)

这是它不起作用的地方：http: [//www.promilitarybusinessnetwork.com/vid/vid.php](http://www.promilitarybusinessnetwork.com/vid/vid.php)

我添加了 phpinfo，这样您就可以看到服务器的配置，并希望看到它在一个服务器上运行而不是在另一个服务器上运行的确切区别。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T16:51:13.193

您是否检查过在 IIS mime 类型中设置了 ogv 和 mp4？

当 IIS 收到对不在 mime 类型列表中的文件类型的请求时，它不会提供服务。

# scroll - UICollectionView 有效拖拽

> ID：12713111
> 
> 赞同：60
> 
> 时间：2012-10-03T16:48:30.217
> 
> 标签：scroll, uiscrollview, uicollectionview, drag-and-drop

我目前正在尝试使用 UICollectionView 实现 UITableView 重新排序行为。

让我们调用一个**UItableView TV**和一个**UICollectionView CV**（澄清以下解释）

我基本上是在尝试重现电视的拖放，但我没有使用编辑模式，只要触发长按手势，单元格就可以移动。它工作得很好，我正在使用 CV 的移动方法，一切都很好。

我更新了 CV 的 contentOffset 属性以在用户拖动单元格时处理滚动。当用户转到顶部和底部的特定矩形时，我会更新 contentOffset 和 CV 滚动。问题是当用户停止移动手指时，手势不会发送任何更新，这会使滚动停止并在用户移动手指后立即重新开始。

这种行为绝对不自然，我宁愿继续滚动，直到用户释放 CV，就像电视中的情况一样。电视拖放体验很棒，我真的很想重现同样的感觉。有谁知道他们在重新排序期间如何管理电视中的滚动？

*   我尝试使用计时器重复触发滚动动作，只要手势位置在正确的位置，滚动很糟糕而且效率不高（非常缓慢和跳跃）。
*   我还尝试使用 GCD 在另一个线程中收听手势位置，但结果更糟。

我对此一无所知，所以如果有人有答案，我会嫁给他！

下面是 longPress 方法的实现：

```
- (void)handleLongPress:(UILongPressGestureRecognizer *)sender
{
    ReorganizableCVCLayout *layout = (ReorganizableCVCLayout *)self.collectionView.collectionViewLayout;
    CGPoint gesturePosition = [sender locationInView:self.collectionView];
    NSIndexPath *selectedIndexPath = [self.collectionView indexPathForItemAtPoint:gesturePosition];

    if (sender.state == UIGestureRecognizerStateBegan)
    {
        layout.selectedItem = selectedIndexPath;
        layout.gesturePoint = gesturePosition; // Setting gesturePoint invalidate layout
    }
    else if (sender.state == UIGestureRecognizerStateChanged)
    {
        layout.gesturePoint = gesturePosition; // Setting gesturePoint invalidate layout
        [self swapCellAtPoint:gesturePosition];
        [self manageScrollWithReferencePoint:gesturePosition];
    }
    else
    {
        [self.collectionView performBatchUpdates:^
        {
            layout.selectedItem = nil;
            layout.gesturePoint = CGPointZero; // Setting gesturePoint invalidate layout
        } completion:^(BOOL completion){[self.collectionView reloadData];}];
    }
} 
```

为了使 CV 滚动，我正在使用该方法：

```
- (void)manageScrollWithReferencePoint:(CGPoint)gesturePoint
{
    ReorganizableCVCLayout *layout = (ReorganizableCVCLayout *)self.collectionView.collectionViewLayout;
    CGFloat topScrollLimit = self.collectionView.contentOffset.y+layout.itemSize.height/2+SCROLL_BORDER;
    CGFloat bottomScrollLimit = self.collectionView.contentOffset.y+self.collectionView.frame.size.height-layout.itemSize.height/2-SCROLL_BORDER;
    CGPoint contentOffset = self.collectionView.contentOffset;

    if (gesturePoint.y < topScrollLimit && gesturePoint.y - layout.itemSize.height/2 - SCROLL_BORDER > 0)
        contentOffset.y -= SCROLL_STEP;
    else if (gesturePoint.y > bottomScrollLimit &&
             gesturePoint.y + layout.itemSize.height/2 + SCROLL_BORDER < self.collectionView.contentSize.height)
        contentOffset.y += SCROLL_STEP;

    [self.collectionView setContentOffset:contentOffset];
} 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-10-06T07:29:59.303

这可能会有所帮助

[https://github.com/lxcid/LXReorderableCollectionViewFlowLayout](https://github.com/lxcid/LXReorderableCollectionViewFlowLayout)

这是扩展的，`UICollectionView`以允许`UICollectionViewCells`用户通过长按（又名触摸并按住）手动重新排列每个。用户可以将单元格拖动到集合中的任何其他位置，其他单元格将自动重新排序。感谢[lxcid](https://github.com/lxcid)。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2013-05-28T05:38:21.127

[这](https://github.com/lukescott/DraggableCollectionView)是一个替代方案：

DraggableCollectionView 和[LXReorderableCollectionViewFlowLayout](https://github.com/lxcid/LXReorderableCollectionViewFlowLayout)的区别是：

*   数据源只更改一次。这意味着当用户拖动项目时，单元格会重新定位，而无需修改数据源。
*   它的编写方式使其可以与自定义布局一起使用。
*   它使用一个`CADisplayLink`平滑的滚动和动画。
*   拖动时取消动画的频率较低。感觉更“自然”。
*   该协议`UICollectionViewDataSource`使用类似于 的方法进行扩展`UITableViewDataSource`。

这是一项正在进行的工作。现在支持多个部分。

要将其与自定义布局一起使用，请参阅`DraggableCollectionViewFlowLayout`. 大多数逻辑存在于`LSCollectionViewLayoutHelper`. CircleLayoutDemo 中还有一个示例，展示了如何使 WWDC 2012 中的 Apple 的 CircleLayout 示例正常工作。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2016-01-02T04:12:42.243

从 iOS 9 开始，`UICollectionView`现在支持重新排序。

对于`UICollectionViewController`s，只需覆盖`collectionView(collectionView: UICollectionView, moveItemAtIndexPath sourceIndexPath: NSIndexPath, toIndexPath destinationIndexPath: NSIndexPath)`

对于s，除了实现上述方法`UICollectionView`外，您还必须自己处理手势。`UICollectionViewDataSource`

以下是源代码：

```
private var longPressGesture: UILongPressGestureRecognizer!

override func viewDidLoad() {
    super.viewDidLoad()

    longPressGesture = UILongPressGestureRecognizer(target: self, action: "handleLongGesture:")
    self.collectionView.addGestureRecognizer(longPressGesture)
}

func handleLongGesture(gesture: UILongPressGestureRecognizer) {

    switch(gesture.state) {

    case UIGestureRecognizerState.Began:
        guard let selectedIndexPath = self.collectionView.indexPathForItemAtPoint(gesture.locationInView(self.collectionView)) else {
            break
        }
        collectionView.beginInteractiveMovementForItemAtIndexPath(selectedIndexPath)
    case UIGestureRecognizerState.Changed:
        collectionView.updateInteractiveMovementTargetPosition(gesture.locationInView(gesture.view!))
    case UIGestureRecognizerState.Ended:
        collectionView.endInteractiveMovement()
    default:
        collectionView.cancelInteractiveMovement()
    }
} 
```

资料来源： [https ://developer.apple.com/library/ios/documentation/UIKit/Reference/UICollectionView_class/#//apple_ref/doc/uid/TP40012177-CH1-SW67](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UICollectionView_class/#//apple_ref/doc/uid/TP40012177-CH1-SW67)

[http://nshint.io/blog/2015/07/16/uicollectionviews-now-have-easy-reordering/](http://nshint.io/blog/2015/07/16/uicollectionviews-now-have-easy-reordering/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-31T16:07:11.533

如果你想尝试推出自己的，我刚刚写了一个基于 Swift 的教程，你可以看看。我尝试构建最基本的案例，以便更容易理解[这一点](http://karmadust.com/drag-and-rearrange-uicollectionviews-through-layouts/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-10T00:17:13.417

[这](https://github.com/henrytkirk/HTKDragAndDropCollectionViewLayout)是另一种方法：

主要区别在于此解决方案不需要“幽灵”或“虚拟”单元格来提供拖放功能。它只是使用细胞本身。动画符合 UITableView。它通过在移动时调整集合视图布局的私有数据源来工作。一旦你放手，它会告诉你的控制器你可以将更改提交到你自己的数据源。

我相信对于大多数用例来说，使用它会更简单一些。仍在进行中的工作，但还有另一种方式来实现这一点。大多数人应该会发现这很容易合并到他们自己的自定义 UICollectionViewLayouts 中。

# mysql - 计数 substring_index

> ID：12713113
> 
> 赞同：4
> 
> 时间：2012-10-03T16:48:36.067
> 
> 标签：mysql, sql

我需要知道如何`substring_index`只返回与分隔符数量完全匹配的所有行。在这种情况下`.`

例如这个查询：

```
 SELECT
 SUBSTRING_INDEX(ABC, '.', 4)
 FROM xxx 
```

只有当行完全像这样（4个字）时才应该输出：

```
aaa.bbb.ccc.ddd 
```

问题是：这一行也显示了。

```
aaa.bbb 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T16:53:03.147

这将返回 ABC 有 3 个`.`分隔符的任何内容。

```
select *
from xxx
where char_length(replace(ABC, '.', '')) + 3 = char_length(ABC) 
```

如果您的定界符有一个多字符串，则需要将 3 乘以定界符长度。

# android - 为 Android 应用预加载数据的良好、优雅和安全的方式

> ID：12713118
> 
> 赞同：3
> 
> 时间：2012-10-03T16:48:53.890
> 
> 标签：android, sqlite

我有一个 android 应用程序，我需要一些“静态配置”数据来预加载并且不可编辑。该数据也是相关的。并且可能会随着应用程序功能的增长而及时更改。

环顾四周，我看到了预先准备 sqlite3 db 文件的建议，然后将其按代码放置在典型的 db 目录（/data/data/whateverapp/databases/preloaded.db）中。但是使用这种方法，我担心具有 root 权限的人（即 root 电话）可能会输入和编辑数据。并且必须加密/解密 db 文件可能会变得很麻烦和混乱（没有本地方法可以实现这个 afaik）。

我什至看到了使用静态数据列表构建类的建议。这可能有效，但也有点混乱而且不优雅。

那么，实现这一目标的正确、优雅和安全的方法是哪一种呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:29:01.780

您可以只拥有一个包含已定义 XML 资源的配置文件。我已经这样做了，而且效果很好。这样，如果您有多个配置，您可以备份这些配置文件以使用旧版本。据我所知，我认为您也不能以编程方式编辑这些资源。

这是我如何使用它的一个简单示例。IE：

显现：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="blah.blah"
      android:versionCode="@integer/version_code"
      android:versionName="@string/build_version"> 
```

我的资源文件：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <integer name="version_code">1</integer>
    <string name="build_version">1.0</string>
        <string name="param">Some other Param</string>
</resources> 
```

现在您的程序将能够在运行时获取版本代码和版本名称的资源。要以编程方式获取其他值，您可以使用以下代码：

```
public class Configuration {
Context thisContext;
private String Param = "";

    public Configuration(Context cont){
        thisContext = cont;
        String param= thisContext.getResources().getString(R.string.param);

        setParam(param);
    }

    /**
     * @return the param
     */
    public static String getParam() {
        return Param;
    }
    /**
     * set the Param
     */
    public static void setParam(String param) {
        Param= param;
    }
} 
```

然后您可以在您的应用程序 onCreate 中创建一个配置对象，如下所示：

```
new Configuration(this); 
```

然后你可以使用该功能

```
Configuration.getParam(); 
```

在您想要获得价值的任何课程中。

您仍然必须写入各种参数，但这很简单。而如果

您需要参考旧版本，就像换出配置文件一样简单。

希望这可以帮助你！干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T02:58:47.523

很多方法可以做到这一点：

*   捆绑为应用程序中的资源，在首次运行时提取和更新数据库等
*   从服务器下载，使用 GCM 通知数据更新。数据更改时无需更新整个应用程序
*   使用 Google Play 扩展（或者是扩展？）文件。数据从 Google 服务器下载，您的应用需要进行身份验证。您需要推送新的应用版本来更新数据。
*   使用远程 API，忘记处理原始数据

优雅是主观的，随你挑选。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T18:11:19.053

我的建议是使用基于服务器的数据库并使用严格的安全性让用户访问服务器。如果您安全地加密和混淆您的访问代码并保护用户凭据，那么您已经抵御了许多没有经验的黑客，并且不必担心手机已root，因为数据库甚至不在手机上。正如评论中提到的，黑客已经变得非常聪明，但这不应该阻止你让他们更难破解你的代码。

# wpf - 视图顶部的 MainWindow 中的显示控件

> ID：12713126
> 
> 赞同：0
> 
> 时间：2012-10-03T16:49:23.633
> 
> 标签：wpf, xaml

是否可以采用在主窗口中创建的控件以及在切换视图时...使其 zindex 位于顶部以显示在视图顶部？

我尝试玩 ZIndex 但没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T16:54:02.107

[ZIndex](http://msdn.microsoft.com/en-us/library/system.windows.controls.panel.zindex.aspx)是一个 Canvas 属性，因此它不适用于其他面板类型，如 Grid 等。如果您需要它出现在顶部，您可以让控件继承自或放置在[`Popup`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.aspx).

或者，如果您将它添加到主窗口 XAML 的最底部，那么它应该呈现在顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:02:04.367

你必须尝试 DockPanel。

```
 <DockPanel LastChildFill="True">

 <TextBlock DockPanel.Dock="Top" 
               Background="OliveDrab"
               Foreground="Cornsilk"
               FontFamily="Veranda"
               FontSize="20"
               TextAlignment="Center">
 </DockPanel> 
```

# mysql - 高性能 mysql 行内文本字段

> ID：12713127
> 
> 赞同：2
> 
> 时间：2012-10-03T16:49:31.217
> 
> 标签：mysql

为了争论，假设我试图在 MySQL 表中表示一个非常简单的文件系统。请注意，这并不是我正在做的事情，它只是为问题提供了一个简单的基础。所以不要费心告诉我存储文件的更好方法。该表的架构如下：

```
varchar path
varchar filename
blob content 
```

上述模式的问题在于，只要查询不一定需要内容字段，它的性能就会很差，因为内容字段可能非常大。例如，如果我想执行一个列出给定路径中所有文件的查询，MySQL 引擎（为了读取文件名字段）会将每一行读取到与 where 子句匹配的内存中。这意味着这个查询不需要的内容仍然需要加载到内存中，这会损害性能。

这个问题的典型解决方案是将内容移动到一个单独的表中，该表总是由 id 直接访问。这种方法的问题在于它增加了插入和选择的复杂性。内容直接附加到单行不再是显而易见的。

所以，我的问题（终于！）是这个。有没有办法将 blob 留在模式中，但导致 MySQL 仅在特别请求时才抓取它？我想知道是否可以在列上放置备用存储引擎或修饰符。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:26:11.743

简短的回答*不是真的*（至少，不是我见过的）。表数据以特定方式存储在磁盘/内存中，访问它总是会导致您的`BLOB`内容受到惩罚。

一种有助于加快处理速度的方法（您可能已经采用或尚未采用这种方法）是在`path`和/或`filename`如果您基于这些查询的基础上使用索引。当然，您开始插入的数据越多，查询将开始花费的时间越长，无论索引优化如何。

我个人建议使用您急于避免的解决方案。这是一种经常使用的方法，实际上并没有增加更多的复杂性。这是一条附加`INSERT`语句，您可以`SELECT`使用`JOIN`或第二`SELECT`条语句来获取数据。

关于“*不再立即将内容直接附加到单行*”语句 - 您是设计系统的人，因此内容附加到另一个表中的一行应该*非常明显。*如果您充分命名表和列，那么（希望）对于在您的系统中工作的其他人来说也是显而易见的。诸如`files`(with `id`, `path`and `filename`) 和`file_contents`(with `file_id`, `content`) 之类的东西。

# python - 如何使用 Gram Schmidt 计算完整的 QR 分解？

> ID：12713141
> 
> 赞同：1
> 
> 时间：2012-10-03T16:50:31.790
> 
> 标签：python, numpy, linear-algebra

我目前正在使用修改后的 Gram-Schmidt 算法来计算矩阵 A (mxn) 的 QR 分解。我目前的问题是我需要完整的分解 Q (mxm) 而不是细的 Q (mxn)。有人可以帮我吗，我必须在算法中添加什么来计算完整的 QR 分解？

```
import numpy as np

def gs_m(A):

    m,n= A.shape
    A= A.copy()
    Q= np.zeros((m,n))
    R= np.zeros((n,n))

    for k in range(n):

        R[k,k]= np.linalg.norm(A[:,k:k+1].reshape(-1),2)
        Q[:,k:k+1]= A[:,k:k+1]/R[k,k]
        R[k:k+1,k+1:n+1]= np.dot( Q[:,k:k+1].T, A[:,k+1:n+1] )
        A[:,k+1:n+1]= A[:, k+1:n+1] - np.dot( Q[:,k:k+1], R[k:k+1,k+1:n+1])

     return Q, R 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:03:25.713

也许你应该使用 scipy.linalg.qr 它有完整和精简版本（模式参数）

# powershell - Powershell：围绕流读取器实现 IdataReader 包装器

> ID：12713142
> 
> 赞同：1
> 
> 时间：2012-10-03T16:50:34.420
> 
> 标签：powershell, streamreader, sqlbulkcopy, idatareader

我正在尝试使用 Powershell 将非常大的 CSV 文件加载到 SQL Server 中。该代码还必须即时应用正则表达式替换，允许使用各种分隔符、EOR 和 EOF 标记。为了维护，我真的希望所有这些逻辑都存在于 Powershell 中，而无需导入程序集。

为了提高效率，我知道我需要使用 SQLBulkCopy 方法。但是，我看到的所有 Powershell 示例都填充了一个 DataTable 并传递它，这对我来说是不可能的，因为文件大小。

我很确定我需要将 StreamReader 包装在 Idatareader 中，然后将其传递给 SQLBulkcopy。我发现了几个用 C# 实现的很好的例子：http:
[//archive.msdn.microsoft.com/FlatFileDataReader](http://archive.msdn.microsoft.com/FlatFileDataReader)
[http://www.codeproject.com/Articles/9258/A-Fast-CSV-Reader](http://www.codeproject.com/Articles/9258/A-Fast-CSV-Reader)

是否可以在不导入 C# 程序集的情况下使用本机 PowerShell 完成此功能？我特别难以转换抽象类包装器。

这是我到目前为止没有通过 IdataReader 并打破内存限制的代码。

```
function Get-CSVDataReader()
{
param (
   [string]$path
)
    $parsedData = New-Object 'System.Collections.Generic.List[string]'
    #List<string[]> parsedData = new List<string[]>()

    $sr = new-object IO.StreamReader($path)

    while ($line = $sr.ReadLine())
    {
        #regex replace and other logic here
        $parsedData.Add($line.Split(','))
    }

    ,$parsedData #if this was an idatareader, the comma keeps it from exploding
}

$MyReader = Get-CSVDataReader('This should not fill immediately.  It needs a Read Method.') 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-04T14:26:48.720

我正在通过数据表导入大型 CSV，并在 100 万行后执行批量更新。

```
if ($dt.rows.count -eq 1000000) {
    $bulkCopy.WriteToServer($dt)
    $dt.Clear()
} 
```

[这是我在博客上详细说明我自己的脚本的链接](http://blog.netnerds.net/2014/07/import-large-csvs-into-sql-server-using-powershell/ "netnerds.net")，但上面的代码概述了基本概念。我的 PowerShell 脚本花了 4.x 分钟从 1.1 GB CSV 导入 900 万行。该脚本依赖于 SqlBulkCopy、[System.IO.File]::OpenText 和一个数据表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T20:42:45.603

如果您只想使用带有 SqlBulkCopy 的 DataReader，您可以使用 Office 2007/2010 附带的 ACE 驱动程序，也可以单独下载以打开与 CSV 文件的 OLEDB 连接，打开阅读器并调用 WriteToServer

```
$ServerInstance = "$env:computername\sql1"
$Database = "tempdb"
$tableName = "psdrive"
$ConnectionString = "Server={0};Database={1};Integrated Security=True;" -f $ServerInstance,$Database
$filepath = "C:\Users\Public\bin\"

get-psdrive | export-csv ./psdrive.csv -NoTypeInformation -Force

$connString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=`"$filepath`";Extended Properties=`"text;HDR=yes;FMT=Delimited`";"

$qry = 'select * from [psdrive.csv]'

$conn = new-object System.Data.OleDb.OleDbConnection($connString)
$conn.open()
$cmd = new-object System.Data.OleDb.OleDbCommand($qry,$conn) 
$dr = $cmd.ExecuteReader()

$bulkCopy = new-object ("Data.SqlClient.SqlBulkCopy") $connectionString
$bulkCopy.DestinationTableName = $tableName
$bulkCopy.WriteToServer($dr)

$dr.Close()
$conn.Close()

#CREATE TABLE [dbo].[psdrive](
#   [Used] [varchar](1000) NULL,
#   [Free] [varchar](1000) NULL,
#   [CurrentLocation] [varchar](1000) NULL,
#   [Name] [varchar](1000) NULL,
#   [Provider] [varchar](1000) NULL,
#   [Root] [varchar](1000) NULL,
#   [Description] [varchar](1000) NULL,
#   [Credential] [varchar](1000) NULL,
#   [DisplayRoot] [varchar](1000) NULL
#) 
```

# windows-8 - 为什么在自定义 WinRT C++/CX 控件中默认添加 [Windows::Foundation::Metadata::WebHostHidden]？

> ID：12713143
> 
> 赞同：8
> 
> 时间：2012-10-03T16:50:39.233
> 
> 标签：windows-8, windows-runtime, visual-studio-2012, c++-cx

当我在 WinRT C++/CX 项目中创建新控件时`[Windows::Foundation::Metadata::WebHostHidden]`，Visual Studio 2012 默认添加了 class 属性。

例子：

```
namespace WindowsRuntimeComponent1
{
    [Windows::Foundation::Metadata::WebHostHidden]
    public ref class MyUserControl sealed
    {
    public:
        MyUserControl();
    };
} 
```

*   是否有任何记录在案的原因？（我做了功课，但我没有找到这条信息）
*   据我所知，使用该属性`[WebHostHidden]`会使该类对 WinRT HTML/Javascript 项目不可见。这是否意味着我无法在 C++/CX 中创建可在 Javascript 中使用的控件？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-03T17:03:41.357

> 据我所知，使用该属性`[WebHostHidden]`会使该类对 WinRT HTML/JavaScript 项目不可见。

这是正确的：此属性隐藏了 JavaScript 投影中的类型，因此从 JavaScript 来看，就好像该类型不存在一样。

> 这是否意味着我无法在 C++/CX 中创建可在 JavaScript 中使用的控件？

您不能使用 JavaScript 中的 XAML 控件，句号。使用 JavaScript 时，UI 是使用 HTML 而非 XAML 创作的。

# asp.net - ASP.NET Eval 字节数组作为字符串

> ID：12713145
> 
> 赞同：0
> 
> 时间：2012-10-03T16:50:47.987
> 
> 标签：asp.net, listview, data-binding, bytearray, eval

我正在从 EntityDataSource 构建 ListView。有一个名为 Sha1Hash 的 Byte[] 字段，我需要将其转换为超链接的字符串类型。这是来自 ItemTemplate 的代码片段：

```
<asp:HyperLink ID="hl_Document" runat="server"
    NavigateUrl='<%# string.Format("~/GetDocument.ashx?docId={0}", Eval("SHA1HASH") ) %>' 
    Text='<%# Eval("DOCUMENTNAME") %>' /> 
```

这会生成一个类似“~/GetDocument.ashx?docId=System.Byte[]”的 URL，但它需要是一个表示字节数组值的十六进制字符串。实现这一目标的最佳方法是什么？理想情况下，我会完全在 .aspx 页面中完成此操作，而不是在后面的代码中。

更新：我通过使用解决了这个问题

```
NavigateUrl='<%# string.Format("~/GetDocument.ashx?docId={0}", BitConverter.ToString((byte[])Eval("SHA1HASH")).Replace("-", string.Empty) ) %>' 
```

我的问题是我需要将 Eval() 转换为 byte[]。它被转换成字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T16:53:09.110

根据您想要的格式，您可能正在寻找`Convert.ToBase64String()`或`BitConverter.ToHexString()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T13:41:08.723

我通过使用解决了这个问题

```
NavigateUrl='<%# string.Format("~/GetDocument.ashx?docId={0}", BitConverter.ToString((byte[])Eval("SHA1HASH")).Replace("-", string.Empty) ) %>' 
```

我的问题是我需要将 Eval() 转换为 byte[]。

# java - Java 需要关于构造函数的帮助

> ID：12713149
> 
> 赞同：0
> 
> 时间：2012-10-03T16:51:14.227
> 
> 标签：java, constructor

我的作业（现在编辑完整作业）

*   使用上面定义的属性创建一个类 Punt（坐标需要用 ax 和 y 值定义。选择正确的数据类型。
*   为类 Punt 创建 2 个构造函数
*   一个不接受参数并将其初始化为 (0,0) 的构造函数
*   一个接受 x 和 y 坐标这两个参数的构造函数必须初始化为 x 和 y 值，并将它们各自的值作为参数

    在类 Punt 中创建一个打印坐标的 print() 方法。• 通过在名为Main 的main() 类中执行以下操作来测试Punt 类。o 使用不带参数的构造函数从 Punt 生成一个对象。o 使用另一个构造函数（具有 2 个参数的那个）在 Punt 中创建另一个对象。o 从两个对象调用 print 方法并检查输出是否正确

我的问题是我应该使用什么数据类型？x 的 int 和 y 的 int 还是我应该使用双精度数？同样对于不接受任何参数的构造函数，我应该如何写这个？

这堂课将

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T16:53:34.850

您使用的数据类型取决于您的设计决策。您希望您的网格具有多少特异性？您是否希望所有`Punt`s 都准确地落在一条网格线上，或者您是否希望在您的平面之间有度数？如果是前者，请使用`int`; 如果是后者，请使用`double`. 这个决定不需要任何真正的编程知识，只需要一些批判性思维。

无参数构造函数的编写方式与编写无参数方法的方式相同。

```
public Punt() {

    //Do stuff

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:10:10.007

您应该使用的数据类型取决于此类的用途。如果您只需要积分 - 使用 int，如果您需要更高的精度，请使用非积分（双精度在内存中占用更多空间，并且由于您对精度浮点数没有任何特定要求似乎是最合理的选择）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T16:52:51.717

```
public class Punt
{
    private int x, y;

    public Punt()
    {
       this(0,0);
    }

    public Punt(int x, int y)
    {
       this.x = x;
       this.y = y;
    }

    public void print()
    {
         System.out.println("(X, Y) = ("+x+", "+y+")");
    }
} 
```

JB Nizet 确实提出了一个有效的观点。

```
public class Main
{
    public static void main(String[] args)
    {
        Punt p1 = new Punt();
        Punt p2 = new Punt(-2, -1);

        p1.print();
        p2.print();
    }
} 
```

还不如现在完成...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T16:53:52.413

您需要多少精度？你的坐标是整数还是实数的一部分？那应该回答您关于什么数据类型的问题。Oracles JavaDocs 有几页关于[构造函数](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)。

# c# - 隐藏表单图标时，Winforms显示任务栏图标

> ID：12713152
> 
> 赞同：1
> 
> 时间：2012-10-03T16:51:35.137
> 
> 标签：c#, winforms

我的应用程序启动了几个表单，它们的父级设置为“主表单”。主窗体有一个窗体图标和`ShowIcon = true`. 我的“子”表单也都有一个图标集，但有`ShowIcon = false`. 我想要的效果是它在任务栏中显示图标，但不在表单本身中。目前，它改为显示一个通用的 Windows 图标。

有没有办法做到这一点？

# php - 如何通过使用的存储来分离测试用例？

> ID：12713156
> 
> 赞同：1
> 
> 时间：2012-10-03T16:52:01.200
> 
> 标签：php, unit-testing, phpunit

我有一个测试数据模型的测试：

```
<?php
namespace Tests\Model\SQL;

/**
 * @group Model_Users
 * @group Model
 */
class UsersTest extends TestCase {

/** @var Users */
private $model;

public function setUp() {
    parent::setUp();
    $this->connection->execute( file_get_contents(
        __DIR__ . '/fixtures/countries.sql' ) );
    $this->model = new \Users(
        $this->connection
    );
}

    public function testUserExists() {
            $exists = $this->model->userExists( 'johndoe' );
            $this->assertTrue( $exists );
    }

} 
```

使用**SQLite**`Tests\Model\SQL\TestCase`作为数据库以尽可能快地保持测试。**无论如何，正如您所料，SQLite 与Postgres**不是同一个数据库，因此可能有一些特殊的数据库，它们在 SQLite 上会失败并在 PostgreSQL 上传递，反之亦然。

 ******我的问题是**：

如何有效地（在牢记 DRY 的情况下）设计架构以仅使用 SQLite 运行测试，然后仅使用 Postgres。

当我说[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)时，我的意思是理想情况下，当我只为一个模型编写一个测试用例并且我的测试架构会处理这个问题时，我将能够像这样运行测试：

```
php tests/run.php --group=MockedDbWithSqlite # fast way, prefered, default

php tests/run.php --group=RealDb # slower way, but with more precise results 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:26:24.327

因此，从评论来看，这个问题与任何具体的存储问题无关，更多的是关于**如何将自定义参数传递给 PHPUnit**。

因为，使用此参数，您将关闭数据库驱动程序。

有几个选项可以做到这一点，但没有官方支持的“自定义参数”对象或其他东西。即便如此，如果有人能添加这个可能会很好:)

我的建议是使用以下选项之一：

## 环境变量

使测试/引导代码依赖于`$_ENV`变量。

```
$dbDriverFactory->getInstanceFor(getenv('DB')); 
```

并使用以下方法之一

```
export DB=postgress
phpunit 
```

或者

```
DB=postpress; phpunit; 
```

或使用 phpunits xml 配置来设置环境或任何你喜欢的。

通过这样做，您可以提供两个 xml 配置`phpunit-sqlite.xml`&`phpunit-pg.xml`并运行：

```
phpunit -c phpunit-sqlite.xml 
```

它不必*是*环境。文档部分中列出的任何方法[**`Setting PHP INI settings, Constants and Global Variables`**](http://www.phpunit.de/manual/current/en/appendixes.configuration.html#appendixes.configuration.php-ini-constants-variables)都可以使用。

## “自定义”cli 参数

像这样调用 phpunit：

```
phpunit --colors --usePostgres 
```

并在测试用例或引导代码中添加类似的内容：

```
if (in_array('--usePostgress', $_SERVER['argv'], true) {
    $db = $this->setupPG();
} else {
    $db = $this->setupSqlite();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T02:34:42.153

我对[edorian](https://stackoverflow.com/a/12716343/841830)的阅读方式不同。我喜欢对这种事情使用继承。优点是您可以在同一个测试运行中同时运行 SQLite 和 Postgres 测试。缺点是您必须向要使用两个数据库运行的每个测试文件添加一些代码。您必须对每个要测试的新数据库重复此操作。下面是它的工作原理：

```
class UsersTestBase extends TestCase {
    //Unchanged
}

class UsersTestSQLite extends UsersTestBase{}

class UsersTestPostgres extends UsersTestBase {
    function __construct(){
        parent::_construct("postgres");
    }
} 
```

因此，UsersTest 完全相同，只是名称已更改为附加“Base”。然后你有一个派生的 UsersTestSQLite 类。这无济于事。在这一点上，我们没有得到或失去任何东西。

然后我们有了UsersTestPostgres。这以某种方式告诉对象使用 postgres 而不是 sqlite。在这种情况下，我假设 TestCase 有一个构造函数，可以将数据库用作可选参数（默认为“sqlite”）。显然有很多替代方案，但我希望你能看到总体思路。

最后，您需要将合适的`@group`标签添加到派生类中，以便您控制它们何时运行。****

# asp.net-mvc-3 - 在 MVC3 中创建由其他模型的对象组成的视图模型

> ID：12713157
> 
> 赞同：2
> 
> 时间：2012-10-03T16:52:03.930
> 
> 标签：asp.net-mvc-3, c#-4.0, viewmodel

我有一个模型和一个可枚举的模型，我将它们放在 asp.net mvc3 中的视图模型中，就像这样。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ComponentModel.DataAnnotations;

namespace FuelPortal.Models.DBModels
{
    public class UserDBModel
    {

        public int userId { get; set; }

        [Required, Display(Name = "User Name")]
        public string userName { get; set; }

        [Required, Display(Name = "Password")]        
        public string password { get; set; }

        [Required, Display(Name = "First Name")]
        public string firstName { get; set; }

        [Required, Display(Name = "Last Name")]
        public string lastName { get; set; }

        [Required, Display(Name = "Email")]
        public string email { get; set; }

        [Display(Name = "Phone")]
        public string phone { get; set; }

        [Display(Name = "Account Expiration Date(Optional)")]
        public DateTime expireDate { get; set; }

        [Display(Name = "Password Expiration Date")]
        public DateTime passwordExpireDate { get; set; }

        [Display(Name = "Last Date Modified")]
        public DateTime DateModified { get; set; }

    }
}

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using FuelPortal.Models.DBModels;

namespace FuelPortal.Models.ViewModels
{
    public class UserMaintenanceViewModel
    {

        public UserDBModel user = new UserDBModel();
        public List<UserDBModel> userList = new List<UserDBModel>();
    }
} 
```

现在我强烈键入一个视图以使用视图模型。

```
@model FuelPortal.Models.ViewModels.UserMaintenanceViewModel  
<div class="frmBG">
        @using (Ajax.BeginForm(new AjaxOptions { UpdateTargetId = "wrapperData" }))
        {

                <h5>Create New User</h5> 
                <br />
                <table cellpadding="2" cellspacing="10" border="0">
                <tr><td>
                <div class="editor-label">
                    @Html.LabelFor(model => model.user.userName)
                </div></td><td>

                <div class="editor-field">
                    @Html.EditorFor(model => model.user.userName)
                    @Html.ValidationMessageFor(model => model.user.userName)
                </div></td></tr>

                <tr><td>
                <div class="editor-label">
                    @Html.LabelFor(model => model.user.password)
                </div></td><td>
                <div class="editor-field">
                    @Html.PasswordFor(model => model.user.password)
                    @Html.ValidationMessageFor(model => model.user.password)
                </div></td></tr>

                <tr><td>
                <div class="editor-label">
                    @Html.LabelFor(model => model.user.firstName)
                </div></td><td>
                <div class="editor-field">
                    @Html.EditorFor(model => model.user.firstName)
                    @Html.ValidationMessageFor(model => model.user.firstName)
                </div></td></tr>

                <tr><td>
                <div class="editor-label">
                    @Html.LabelFor(model => model.user.lastName)
                </div></td><td>
                <div class="editor-field">
                    @Html.EditorFor(model => model.user.lastName)
                    @Html.ValidationMessageFor(model => model.user.lastName)
                </div></td></tr>

                <tr><td>
                <div class="editor-label">
                    @Html.LabelFor(model => model.user.email)
                </div></td><td>
                <div class="editor-field">
                    @Html.EditorFor(model => model.user.email)
                    @Html.ValidationMessageFor(model => model.user.email)
                </div></td></tr>

                <tr><td>
                <div class="editor-label">
                    @Html.LabelFor(model => model.user.phone)
                </div></td><td>
                <div class="editor-field">
                    @Html.EditorFor(model => model.user.phone)
                    @Html.ValidationMessageFor(model => model.user.phone)
                </div></td></tr>

                <tr><td>
                <div class="editor-label">
                    @Html.LabelFor(model => model.user.expireDate)
                </div></td><td>
                <div class="editor-field">
                    @Html.EditorFor(model => model.user.expireDate)
                    @Html.ValidationMessageFor(model => model.user.expireDate)
                </div></td></tr>

                <tr><td></td><td>
                <p>
                    <input type="submit" value="" class="create" /><input type="button" value="" class="close_tab"/>
                </p></td></tr>
                </table>
        }
    </div> 
```

由于某种原因，它不会在视图模型中填充对象。因此，当我创建发布操作时，（UserMaintenanceViewModel 模型）的所有值都为空。像这样。。

```
 [HttpPost]
        public ActionResult CreateUser(UserMaintenanceViewModel model)
        {
            try
            {
                /// TODO: Add insert logic here
                var result = repository.insertNewUser(Session["UserId"].ToString(), model.user.UserName, model.user.Password, model.user.FirstName,
                                                      model.user.LastName, model.user.Email, model.user.Phone, model.user.ExpireDate);
                // If result > 0 user insert successful 
```

此外，如果我切换到通过（FormCollection 表单）获取回发，我会看到 html 元素的名称是“user.UserName”而不是预期的“UserName”。任何指导将不胜感激，我觉得我应该能够做到这一点。

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T20:05:33.897

如果您有一个复杂的视图模型，那么您必须确保在构造函数中创建对象的实例。然后，您可以将信息添加到任何子对象，因为它现在有一个实例。

```
public class MyViewModel
{

    public MyViewModel()
    {
        Customer= new CustomerViewModel ();
        Address = new AddressViewModel();
    }

    public int OrderNumber{ get; set; }
    public CustomerViewModel Customer  { get; set; }
    public AddressViewModel Address { get; set; }

} 
```

}

# ajax - ASP MVC 3：使用 AJAX 提交表单时客户端验证无法正常工作

> ID：12713158
> 
> 赞同：0
> 
> 时间：2012-10-03T16:52:07.237
> 
> 标签：ajax, asp.net-mvc, jquery, web

我有以下场景，我有一个使用 ajax 提交的，使用以下代码：

```
$("#cmdAjaxSave").click(function (evt) {
            evt.preventDefault();
            var $form = $('#frmItem');
            if ($form.valid()) {
                ajaxSave();
            }
        });

function ajaxSave() {
        if (!onBeforeSubmit()) return; //item is not valid, so the ajax call should not be executed
        //var token = $('[name=__RequestVerificationToken]').val();
        popup('ajaxSplash');
        $.ajax({
            type: "POST",
            url: '@Url.Action("Index")',
            data: $("#frmItem").serialize(),
            success: function (html) {
                //console.log(html);                
                $("#formDiv").empty();
                $("#formDiv").append(html);
                initItemPage();
                alert("Item was saved successfully");
            },
            error: function () { popup('ajaxSplash'); onFailure(); }
        });
    } 
```

我在这里看到的问题是，即使“frmItem”在我到达客户端时返回“true”，ModelState 也是无效的。专门针对三个属性，它们实际上具有正确的值。

深入研究最初编写此代码的开发人员编写的代码，我发现例如这个属性：

```
@Html.TextBoxFor(model => model.Item.Service.CPC_BW, htmlAttributes: new { @class = "Text", @onkeyup = "validItem();", @id = "SrvCPCBlk" }) 
```

实际上是这样定义的：

```
private double _CPC_BW;

[Required]
        [Range(0, 100000, ErrorMessage = "CPC value required")]
        public string CPC_BW { get { return String.Format("{0:F}", _CPC_BW); } set { _CPC_BW = Convert.ToDouble(value); } } 
```

我认为他这样做是因为 TextBoxFor 没有提供一种明显的方法来格式化数字，即使它看起来很可疑，我也不知道这怎么会导致错误。

表单的Html是这样渲染的

```
<div id="itemPopUpForm">
    @{Html.EnableClientValidation();}    
    <div id="formDiv">
        @{ Html.RenderPartial("ItemData", Model, new ViewDataDictionary() { { "Machines", ViewBag.Machines }, { "WarehouseList", ViewBag.WarehouseList }, { WebConstants.FORM_ID_KEY, @ViewData[WebConstants.FORM_ID_KEY] } }); }
    </div>
</div> 
```

部分视图包含在 ajax 请求中提交的表单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T09:29:03.323

我认为您应该尝试清除模型状态，然后测试其是否有效...

这是一个常见的问题。

```
ModelState.Clear();
ModelState.IsValid(); 
```

# android - Android - 通过蓝牙从 Arduino 接收奇怪的位

> ID：12713160
> 
> 赞同：2
> 
> 时间：2012-10-03T16:52:24.877
> 
> 标签：android, bluetooth, arduino

我正在为 Arduino 和 Android 之间的通信编写 Android 软件。

Arduino 使用`serial.println`- 我发送文本“它有效！”发送数据。

Android以这种方式接收数据：

```
bytes = mmInStream.read(buffer);
mHandler.obtainMessage(MESSAGE_READ, bytes, -1, buffer).sendToTarget(); 
```

它显示一些代码而不是“它有效！”，更准确地说它显示`[B@40e3f9b8`.

原因是什么？如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:00:21.533

您刚刚尝试打印一个字节数组。在 Java 中，这只是打印出 object 的类型`[B`，然后是它的 address `@40e3f9b8`。

如果要打印文本，请使用`new String(bytes)`从字节数组中获取字符串（使用默认字符集），然后打印字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T05:26:26.340

您必须从字节数组创建一个字符串： **String strIncom = new String(buffer, 0, msg.arg1);** \r\n 处理程序的完整示例：

```
 h = new Handler() {
    public void handleMessage(android.os.Message msg) {
        switch (msg.what) {
        case RECIEVE_MESSAGE:                                                   // if receive massage
            byte[] readBuf = (byte[]) msg.obj;
            String strIncom = new String(readBuf, 0, msg.arg1);                 // create string from bytes array
            sb.append(strIncom);                                                // append string
            int endOfLineIndex = sb.indexOf("\r\n");                            // determine the end-of-line
            if (endOfLineIndex > 0) {                                           // if end-of-line,
                String sbprint = sb.substring(0, endOfLineIndex);               // extract string
                sb.delete(0, sb.length());                                      // and clear
                txtArduino.setText("Data from Arduino: " + sbprint);            // update TextView
            }
            //Log.d(TAG, "...String:"+ sb.toString() +  "Byte:" + msg.arg1 + "...");
            break;
        }
    };
}; 
```

[在此处](http://english.cxem.net/arduino/arduino5.php)查看带有 apk 和源代码的完整示例程序

# reporting-services - 仅当月份的日期介于 2 到 7 之间时才显示文本

> ID：12713162
> 
> 赞同：0
> 
> 时间：2012-10-03T16:52:30.500
> 
> 标签：reporting-services, reporting, reportingservices-2005

我想知道如果月份的日期在 2 日和 7 日之间，是否可以在 Reporting Services 2005 中显示文本。

例如，如果今天是 3 号，我将显示“TEXT”，但如果是 27 号，“TEXT”将不可见。

使用如下表达式时出现错误：

```
=IIF(Day >= 2 Or Day < 7,'TEXT','') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:30:12.857

你能试试这个：

```
=IIF((Day(Now()) >= 2 ) and (Day(Now()) < 7) ,"TEXT","") 
```

# spring - Spring MVC：我设置了默认页面但spring总是应该我找不到配置文件

> ID：12713168
> 
> 赞同：2
> 
> 时间：2012-10-03T16:53:01.077
> 
> 标签：spring, spring-mvc, configuration, jboss, http-status-code-404

我尝试在 Eclipse 上运行一个基本的 Java EE Spring 项目（jboss 7.1.1 服务器，Spring 3.1.2 发布），但是当它总是打印配置文件找不到但我实际上将配置文件放在正确的位置时。我没有配置欢迎文件，而是 mvc:view-controller。

![这是我的错误屏幕截图](../Images/468cc9205c39143caaa55cf9bd6f2e51.png)

这是 web.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="3.0"
xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee /web-app_3_0.xsd">
<display-name>springupload</display-name>
<context-param>
<param-name>contextConfigLocation</param-name>
<param-value>/WEB-INF/web-application-config.xml</param-value>
</context-param>
<!-- Loads the Spring web application context -->
<listener>
<listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<servlet>
<servlet-name>Spring MVC Dispatcher Servlet</servlet-name>
<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
<init-param>
<param-name>contextConfigLocation</param-name>
<param-value/>
</init-param>
<load-on-startup>1</load-on-startup>
</servlet>
<!-- Map all *.spring requests to the DispatcherServlet for handling -->
<servlet-mapping>
<servlet-name>Spring MVC Dispatcher Servlet</servlet-name>
<url-pattern>/</url-pattern>
</servlet-mapping>

</web-app> 
```

这是 web-application-config.xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:context="http://www.springframework.org/schema/context"
   xsi:schemaLocation="
       http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<!-- Scans for application @Components to deploy -->
<context:component-scan base-package="com.pack" />

<!-- Imports the configurations of the different infrastructure systems of the application -->
<import resource="webmvc-config.xml" />
<!-- <import resource="webflow-config.xml" /> -->
<!-- <import resource="data-access-config.xml" /> -->

    <bean class="org.springframework.web.multipart.commons.CommonsMultipartResolver" id="multipartResolver">
        <property name="maxUploadSize" value="1000000"></property>
    </bean>
</beans> 
```

这是 webmvc-config.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xmlns:aop="http://www.springframework.org/schema/aop"
xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
   http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">

<!-- Enables controllers mapped with @RequestMapping annotations, formatting annotations @NumberFormat @DateTimeFormat, and JSR 303 style validation -->
<mvc:annotation-driven/>

<mvc:resources mapping="/res/**" location="/, classpath:/META-INF/web-resources/" />
<mvc:view-controller path="/" view-name="hello"/>
<mvc:default-servlet-handler />

    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver" id="jspre">
        <property name="prefix" value="/WEB-INF/"/>
        <property name="suffix" value=".jsp"/>
    </bean>

     <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver" id="htmlre">
        <property name="prefix" value="/WEB-INF/"/>
        <property name="suffix" value=".html"/>
    </bean>

</beans> 
```

您可以在图片中看到的错误：

HTTP 状态 404 - /springupload/WEB-INF/webmvc-config.xml

类型状态报告

消息 /springupload/WEB-INF/webmvc-config.xml

描述 请求的资源（/springupload/WEB-INF/webmvc-config.xml）不可用。JBoss Web/7.0.13.Final

我真的不知道为什么我配置了html和jsp页面，而它应该一些配置文件作为我的起始页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T18:13:13.007

你的配置离OK不远了。

我注意到的一件事是该`hello.html`文件位于您的根`WebContent`文件夹中。我想这是您在访问时想要呈现的视图，`http://localhost:8080/springupload/`因为配置中的这一行：

```
<mvc:view-controller path="/" view-name="hello"/> 
```

如果是这样，那么 Spring 正试图解决这个*viewResolver*`/WEB-INF/hello.html`上的`prefix`and ：`suffix`

 *```
<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver" id="htmlre">
    <property name="prefix" value="/WEB-INF/"/>
    <property name="suffix" value=".html"/>
</bean> 
```

但是，您有两个没有顺序的视图解析器，而 Spring 只采用第一个解析为 的视图解析器`/WEB-INF/hello.jsp`，因此`404 Not found`

总结它，您的解决方案是像这样移动`hello.html`到`/WEB-INF/`并更改您的*viewResolver*配置`webmvc-config.xml`

```
<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver" id="jspre">
    <property name="order" value="2" />
    <property name="prefix" value="/WEB-INF/"/>
    <property name="suffix" value=".jsp"/>
</bean>

<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver" id="htmlre">
    <property name="order" value="1" />
    <property name="prefix" value="/WEB-INF/"/>
    <property name="suffix" value=".html"/>
</bean> 
```

最后，您不应该直接访问`http://localhost:8080/WEB-INF/*`URL 中的内容，因此您在此处尝试的所有操作都会导致`404 Not found`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:06:37.067

将您的配置文件名更改为`[dispatcher servlet name]-servlet.xml`

[http://static.springsource.org/spring/docs/3.0.x/reference/mvc.html](http://static.springsource.org/spring/docs/3.0.x/reference/mvc.html)*

# python - 编写和导入自定义模块/类

> ID：12713170
> 
> 赞同：0
> 
> 时间：2012-10-03T16:53:02.260
> 
> 标签：python, python-2.6

我有一个我正在尝试编写的名为 dbObject 的类，我正在尝试从不同文件夹中的脚本导入它。我的结构如下：

```
/var/www/html/py/testobj.py

/var/www/html/py/obj/dbObject.py

/var/www/html/py/obj/__init__.py 
```

现在，`__init__.py`是一个空文件。以下是 dbObject.py 的内容：

```
class dbObject:
        def __init__():
                print "Constructor?"

        def test():
                print "Testing" 
```

这是 testobj.py 的内容：

```
#!/usr/bin/python
import sys
sys.path.append("/var/www/html/py")
import obj.dbObject

db = dbObject() 
```

当我运行它时，我得到：

```
Traceback (most recent call last):
  File "testobj.py", line 7, in <module>
    db = dbObject()
NameError: name 'dbObject' is not defined 
```

我是 Python 新手，所以我对自己做错了什么感到非常困惑。有人可以指出我正确的方向吗？

编辑：感谢 Martijn Pieters 的回答，我修改了我的 testobj.py 如下：

```
#!/usr/bin/python
import sys
sys.path.append("/var/www/html/py")
sys.path.append("/var/www/html/py/dev")
from  obj.dbObject import dbObject

db = dbObject() 
```

但是，现在当我运行它时，我收到了这个错误：

```
Traceback (most recent call last):
  File "testobj.py", line 7, in <module>
    db = dbObject()
TypeError: __init__() takes no arguments (1 given) 
```

这是指我的**init** .py 还是 dbObject 中的构造函数？

编辑（2）：我自己解决了这个问题，构造函数必须能够接受至少一个参数 - 对自身的引用。简单的修复。看来这个问题已经解决了！

编辑（最终）：这很好 - 我可以删除 import sys 和 sys.path.append 行，它在这种情况下仍然有效。迷人的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T16:55:08.250

您需要从模块中导入类：

```
from obj.dbObject import dbObject 
```

这会将类`dbObject`直接添加到您的本地命名空间。

您的语句`import obj.dbObject`将名称添加`obj`到本地命名空间，因此您也可以这样做：

```
db = obj.dbObject.dbObject() 
```

因为`obj.dbObject`是你的包目录中的`dbObject.py`模块。`obj`

# php - 在网页中回显打印文字代码。[PHP]

> ID：12713174
> 
> 赞同：1
> 
> 时间：2012-10-03T16:53:08.917
> 
> 标签：php, session, syntax, session-variables

我很难弄清楚我的 php 代码在变量传递或我的 php 语法方面有什么问题。所以这是包含 start_session(); 的 php。这些位于需要共享变量的页面的顶部。

```
<?php
error_reporting(E_ALL ^ E_NOTICE);
session_start();
$CustNum = $_SESSION['CustNum'];
$UserName = $_SESSION['UserName'];
?> 
```

然后这是正文代码。

```
<?php
if($UserName && $UserID)
    echo ("Welcome <b>$UserName</b>. <br> <a href='index.php'><b>Log Out</b></a>");
else
    echo ("Please log in to access this page.<br><a href='login.php'>Log In Here</a>"); 
```

?>

这是网页中打印的结果：

```
"$UserName. 
 Log Out"); else echo ("Please log in to access this page.
 Log In Here"); ?> " 
```

谁能告诉我问题是什么。谢谢！

# gwt - SmartGwt 窗口标题高度

> ID：12713177
> 
> 赞同：0
> 
> 时间：2012-10-03T16:53:13.737
> 
> 标签：gwt, smartgwt, smartclient

知道如何在 smartGwt中更改**窗口的****标题高度吗？**

 **我尝试增加标题内容的字体，然后自动设置高度，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T19:25:07.560

我找到了解决方案，你所要做的就是为你的窗口类重新定义属性 headerDefaults，它是一个地图，所以你可以像这样继续：

```
Map<String, Object> headerDefaults = new HashMap<String, Object>();
Integer newHeight = 64;
headerDefaults.put("height", newHeight);
mySmartGwtWindow.setAttribute("headerDefaults", headerDefaults, true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:52:56.563

我没有找到任何可以更改标题高度的属性。我试过玩***HeaderControl***想我可以添加一个虚拟控件一个空图标，其高度可能是我们要寻找的，但***ControlIcon***的高度在构造函数中固定为 15。所以今晚没有更多想法......**

# php - 将对象转换为数组

> ID：12713182
> 
> 赞同：0
> 
> 时间：2012-10-03T16:53:27.003
> 
> 标签：php, symfony

我创建了一个将父子列表转换为“城市”类对象的函数：

```
 public static function createCity(array $config)
{
    $city= new City();

    $id=key($config);
    $label= $config[$id]['label'];

    $city->setId($id);
    $city->setLabel($label);

    $children = $config[$id]['childrens'];

    if(!empty($children)){
        foreach($children as $key_child => $child) {
            $children = array($key_child => $child);

            $city->addChild(self::createCity($children));

        }
    }
  return $city;
} 
```

现在我要创建一个函数来执行相反的操作 => 将 Class City 类型的对象转换为数组，所以我喜欢这样：

```
 public function getCityArray(City$rootCity)
{
        $result = array();

        $result['id'] = $rootCity->getId();
        $result['label']= $rootCity->getLabel();

    $children = $rootCity->getChildren();

    if ( !empty($children)) {
        foreach ($children as $key_child => $child) {

            $result['childrens'] = array($key_child => $child );

            $result[] = $this->getCityArray($child);
        }
    }

    return $result;

} 
```

但这不起作用，因为当我执行 var_dump('$result') 时，我有一个没有结束的列表并且循环不会停止？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:15:06.870

尝试这个。因为我不知道有完整的代码，所以不确定它是否会工作。类变量`$result`将包含结果。

```
$result = array();
public function getCityArray(City $rootCity) {

  $result['id'] = $rootCity->getId();
  $result['label']= $rootCity->getLabel();
  $children = $rootCity->getChildren();

  if ( !empty($children)) {
    $result['childrens'] = $children;
    $this->result[] = $result;
    foreach ($children as $key_child => $child) {
      $this->getCityArray($child);
    }
  }

} 
```

# android - 使用选项菜单时的异常

> ID：12713183
> 
> 赞同：-1
> 
> 时间：2012-10-03T16:53:28.923
> 
> 标签：android, android-optionsmenu

这是我的`onOptionsItemSelected`回调代码。我在使用 id 的项目时遇到问题`R.id.up`：

```
@Override
public boolean onOptionsItemSelected(MenuItem item)
{
    switch (item.getItemId())
    {
    case R.id.can:
        can = false;
        sel = false;
        FileName.setEnabled(false);
        FileName.setText("");
        String[] values = new String[] {"Open", "Save (As)", "New"};
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, values);
        setListAdapter(adapter);
        return true;
    case R.id.sel:
        can = false;
        sel = false;
        SelDir = CurDir;
        if (SelDir != null)
        {
        try
        {
            file = new File(SelDir, (FileName.getText().toString() + ".txt"));
            w = new FileWriter(file);
            writer = new BufferedWriter(w);
            writer.write(TextEditor.getText().toString());
            writer.close();
        }
        catch (Exception e)
        {
            Toast.makeText(this, "Error:\n" + e.getMessage().toString(), Toast.LENGTH_LONG).show();
        }
        }
        else
        {
            Toast.makeText(this, "Error:\n" + "Please Select A Directory", Toast.LENGTH_LONG).show();
        }
        values = new String[] {"Open", "Save (As)", "New"};
        adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, values);
        setListAdapter(adapter);
        String temp = FileName.getText().toString() + ".txt";
        FileName.setText(SelDir + "/" + temp);
        FileName.setEnabled(false);
        SelDir = null;
        return true;
    case R.id.up:
        if (CurDir != homeDir)
        {
            CurDir = CurDir.substring(0, CurDir.lastIndexOf("/") - 1);
            dir = new File(CurDir);
            values = dir.list(filter);
            adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, values);
            setListAdapter(adapter);
        }
        return true;
    default:
        return super.onOptionsItemSelected(item);
    }
} 
```

当我按下该项目时，`R.id.up`我的应用程序强制关闭。其他两项工作正常。我找不到我的代码的问题。

编辑：`logcat`除了：

```
10-03 11:57:45.952: E/AndroidRuntime(18460): FATAL EXCEPTION: main
10-03 11:57:45.952: E/AndroidRuntime(18460): java.lang.NullPointerException
10-03 11:57:45.952: E/AndroidRuntime(18460):    at java.util.Arrays$ArrayList.<init>(Arrays.java:47)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at java.util.Arrays.asList(Arrays.java:169)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at android.widget.ArrayAdapter.<init>(ArrayAdapter.java:125)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at com.IPP.EZPadd.EZPaddActivity.onOptionsItemSelected(EZPaddActivity.java:102)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at android.app.Activity.onMenuItemSelected(Activity.java:2205)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at com.android.internal.policy.impl.PhoneWindow.onMenuItemSelected(PhoneWindow.java:823)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at com.android.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl.java:143)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at com.android.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:855)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at com.android.internal.view.menu.IconMenuView.invokeItem(IconMenuView.java:532)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at com.android.internal.view.menu.IconMenuItemView.performClick(IconMenuItemView.java:122)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at android.view.View$PerformClick.run(View.java:9081)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at android.os.Handler.handleCallback(Handler.java:587)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at android.os.Handler.dispatchMessage(Handler.java:92)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at android.os.Looper.loop(Looper.java:130)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at android.app.ActivityThread.main(ActivityThread.java:3686)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at java.lang.reflect.Method.invokeNative(Native Method)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at java.lang.reflect.Method.invoke(Method.java:507)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
10-03 11:57:45.952: E/AndroidRuntime(18460):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:14:50.707

我变了：

```
CurDir = CurDir.substring(0, CurDir.lastIndexOf("/") - 1); 
```

到：

```
CurDir = CurDir.substring(0, CurDir.lastIndexOf("/")); 
```

# sql - 列值匹配时的 SQL 求和字段

> ID：12713187
> 
> 赞同：12
> 
> 时间：2012-10-03T16:53:44.213
> 
> 标签：sql, sum

标题很难用词，但问题很简单。我到处搜索，找不到适合我的具体问题的东西，所以就在这里。我正在使用 Microsoft SQL Server Management Studio 2010。

表目前看起来像这样

```
 | Value | Product Name|
  |  300  | Bike        |
  |  400  | Bike        |
  |  300  | Car         |
  |  300  | Car         | 
```

我需要表格来显示产品名称匹配的值的总和 - 像这样

```
 | TOTAL | ProductName |
  |  700  | Bike        |
  |  600  | Car         | 
```

我试过一个简单的

```
 SELECT
      SUM(Value) AS 'Total'
      ,ProductName
 FROM TableX 
```

但上述不起作用。我最终得到列中所有值的总和。如何根据产品名称匹配求和？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-03T16:55:51.227

```
SELECT SUM(Value) AS 'Total', [Product Name]
FROM TableX  
GROUP BY [Product Name] 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!3/a3366/2)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T17:16:05.387

每当您在语句中使用带有列的聚合函数 ( `SUM`, `MIN`, ... ) 时，都必须使用. 这是一个组函数，它指示聚合所依据的列。此外，任何不在聚合中的列都不能在您的语句中。`MAX``SELECT``GROUP BY``SELECT`

例如，以下语法无效，因为您指定的列 ( `col2`) 不在您的范围内`GROUP BY`（即使 MySQL 允许这样做）：

```
SELECT col1, col2, SUM(col3)
FROM table
GROUP BY col1 
```

您的问题的解决方案是：

```
SELECT ProductName, SUM(Value) AS 'Total'
FROM TableX
GROUP BY ProductName 
```

# recursion - 如何设置 SQLITE_MAX_TRIGGER_DEPTH？

> ID：12713188
> 
> 赞同：2
> 
> 时间：2012-10-03T16:53:44.010
> 
> 标签：recursion, sqlite, triggers

我需要增加 SQLite 中递归触发器的最大深度。我知道我需要将 设置为`SQLITE_MAX_TRIGGER_DEPTH`我想要的值，但我找不到这样做的方法。

我试过`PRAGMA SQLITE_MAX_TRIGGER_DEPTH = X`了，它没有用。

关于如何设置这个变量的任何想法？谢谢！

引用 SQLite 文档：

> SQLite 限制了触发器的递归深度，以防止涉及递归触发器的语句使用无限量的内存。
> 
> 在 SQLite 版本 3.6.18 之前，触发器不是递归的，所以这个限制是没有意义的。从版本 3.6.18 开始，支持递归触发器，但必须使用 PRAGMA recursive_triggers 语句显式启用。从版本 3.7.0 开始，递归触发器默认启用，但可以使用 PRAGMA recursive_triggers 手动禁用。SQLITE_MAX_TRIGGER_DEPTH 仅在启用递归触发器时才有意义。
> 
> 默认的最大触发递归深度为 1000。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:44:30.887

`PRAGMA recursive_triggers`仅用于启用递归触发器。

该`SQLITE_MAX_TRIGGER_DEPTH`参数是一个C预处理器符号，在编译SQLite本身时必须设置；在运行时增加它是不可能的。

# java - 使用 Java 存储和检索大型数据集的最佳方式

> ID：12713194
> 
> 赞同：6
> 
> 时间：2012-10-03T16:54:03.477
> 
> 标签：java, dataset, store

我目前正在开发一个 Java 项目，我必须在一个非常大的数据集上执行多个信息检索和分类任务。一个小集合将有 10K 个文档。每个文档中大约有 100 个 150 维的双精度向量。所以大约有 150 个双打或 150M 双打的 1M 个向量。存储后，我需要召回所有这些或其中的一部分并执行聚类（例如 KMEANS）。实际收藏有更多文档（我目前正在处理 200K 文档）。

当然，我已经多次处理过 OutOfMemoryError，我最后一次解决这个问题的方法是存储在 10 个总大小 > 5GB 的巨大 XML 文件中。文件必须为 10，因为 DOM Writer 内存已满。对于阅读，我使用了 SAX Parser，它完成了这项工作而无需将它们加载到内存中。此外，将 double 存储到任何类型的文本中都会增加他的实际大小并增加解析和转换的计算成本。最后，聚类算法通常是迭代的，因此它们将一次又一次地需要相同的数据。我的方法没有缓存任何东西，它只是从磁盘读取了很多次。

我现在正在寻找一种更紧凑的方式来以二进制格式（数据库、原始二进制文件等）存储任意数量的数据，以及一种读取它们的有效方式。有没有人有什么想法可以提出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T17:34:24.127

嵌入式数据库或键值存储。它们有很多，例如[JDBM3](https://github.com/jankotek/JDBM3)。以 xml 格式存储是多么奇怪的想法？您可以使用标准序列化技术简单地将数组转储到文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:42:33.800

我不太确定您的情况，但是对于我们的“大数据处理”需求，我们使用了 noSQL DB，它工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:38:46.357

请勿将 Derby 用于此目的。存储超过 500k 个条目非常慢并且使用太多内存

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T20:38:01.437

In-Memory Datagrids 可以解决您的问题。有几种可用的开源解决方案（Hazelcast、Infinispan）。

我只与 hazelcast 合作过 - 所以不能告诉你任何关于其他人的事情。

Hazelcast 将数据分布在多个节点上。查询也分布在集群中的所有节点上。

# php - 检测 Flash 播放器 - 有点工作

> ID：12713195
> 
> 赞同：1
> 
> 时间：2012-10-03T16:54:05.333
> 
> 标签：php, javascript, flash, cookies

我正在使用它来检测是否安装了 Flash 播放器。如果是，我会显示特定的字段。

```
<script>
  var hayFlash = function(a,b){try{a=new ActiveXObject(a+b+'.'+a+b)}catch(e){a=navigator.plugins[a+' '+b]}return!!a}('Shockwave','Flash')

  if(hayFlash) {
   document.cookie = 'flash=1';
  }
  else {
    alert("Flash Player is required to copy GUID's");
    document.cookie = 'flash=0';

  }
</script> 
```

这似乎有效。

我遇到的问题是，一旦设置了 cookie，我必须刷新页面才能访问 cookie。

有没有办法让这个页面检查播放器，设置一个 cookie（或其他变量）然后让页面加载的其余部分显示或不显示正确的字段？

谢谢

# c++ - 如何在我的软件中配置中文支持？

> ID：12713196
> 
> 赞同：2
> 
> 时间：2012-10-03T16:54:05.540
> 
> 标签：c++, fltk

我`FLTK`用来实现我的应用程序的用户界面。为了实现中文支持，我使用了字体`wenquanyi`。但是，当配置此字体时，罗马字符以丑陋的方式显示，而罗马数字以粗体显示。这是支持混合实现的最佳字体，罗马字符与汉字混合？

也许我用来加载字体的参数是错误的

```
Fl::set_font(FL_HELVETICA, "-wenquanyi-wenquanyi bitmap song-medium-r-normal--0-0-100-100-p-0-iso10646-1"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:23:22.853

问题是与汉字符混合的拉丁文本有一个排版要求，以显示成比例。某些地区的现代媒体可能更喜欢混合布局形式，但没有单一的通用方法。

因此，您实际上正在寻找的是将布局的元数据标记为汉文和混合形式以及纯拉丁形式。

![不同文本布局示例（来源：State Farm 广告）](../Images/4182fda4a0cd7b9746aafd613def9cb4.png)

解决方法是使用两种字体并管理应用程序中的上下文。

# android - 安卓动画问题

> ID：12713199
> 
> 赞同：2
> 
> 时间：2012-10-03T16:54:15.570
> 
> 标签：android, animation, android-linearlayout

嗨，我需要将线性布局从一个位置移动到另一个位置，我需要他留在那里，但是动画根本不起作用这是代码

```
LinearLayout ll = (LinearLayout) findViewById(R.id.tanim);
    TranslateAnimation ta = new TranslateAnimation(-80, -80, 0, 0);
    ta.setDuration(1000);
    ll.startAnimation(ta); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:13:57.057

当然那是行不通的。

前两个参数是 fromX 和 toX 0 您输入的值告诉视图从 -80 移动到 -80 .. 尝试：

```
TranslateAnimation ta = new TranslateAnimation(0, -80, 0, 0); 
```

如果您希望动画结束后视图保持原位而不返回其原始位置，请添加：

```
ta.setFillAfter(true); 
```

# css - 如何摆脱流浪 » 列表中的字符

> ID：12713203
> 
> 赞同：1
> 
> 时间：2012-10-03T16:54:20.390
> 
> 标签：css

`&raquo;`我的文档在每个列表元素的开头出现了杂散。当我在浏览器中查看源代码时，该字符不在文档中——它只出现在屏幕上。

我怎样才能摆脱它？

我会`list-style-postion`以某种方式使用吗？

我已经尝试了所有我能想到的css：

```
list-style:none !important;
list-style-type:none !important;
list-style-image:none !important; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T16:56:21.723

它可能是由`:before`伪元素添加的。

寻找类似的东西

```
li:before {
    ...
} 
```

并删除它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T16:58:08.943

这应该重置/清除列表

```
ul, ol, li, dl, dt, dd
{
padding: 0;
margin: 0;
list-style-type: none;
list-style-position: inside;
list-style-image: none;
} 
```

查看是否使用任何伪选择器来添加它们。

# database - 将序列更新到 PostgresQL 中可用的下一个

> ID：12713204
> 
> 赞同：2
> 
> 时间：2012-10-03T16:54:24.550
> 
> 标签：database, postgresql, sequence, auto-increment

好的，我正在使用 PostgresQL 制作用户数据库，我已经使用了一两个月，但不是很熟悉。目前，每个注册的用户都会通过 PostgresQL 序列自动分配一个唯一的 ID。这一直是惯例，并且一直运行良好，但是......我有来自客户的请求，希望能够手动输入用户的某些 ID。我预计用户不会超过 300 个，因此我为手动输入的 ID 保留了 ID 500-600。（如果他们在线注册，他们会得到自动递增的数字，很可能不会超过 300。如果他们需要手动 ID，他们会获得一个预先确定的 ID，介于 500 和 600 之间。）是的，我 99.9999% 确信不会有超过 300 个“自动识别”用户。

我真的希望能够提供我想要的任何手动 ID，然后如果他们在线注册并且 ID 已被占用，他们将获得下一个可用 ID。我意识到这违背了序列的目的，但是，我不确定我的其他选择是什么。我只能给出一定数量的 ID，所以如果可能的话，我宁愿不只是“max+1”——我想“填补空白”。我相当确定答案在于手动输入 ID 时更新序列的某个地方，但这听起来是个坏主意，不知道为什么。

如果这不是一个好主意，就说——“嘿，你是个白痴。谁让你负责数据库的？” 我们将继续我们的一天。谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T23:27:25.093

我可能会`DROP`完全按照顺序并`ALTER TABLE`从列中删除默认值。然后，在 期间`INSERT`，我会写如下内容：

```
BEGIN;
LOCK TABLE users IN EXCLUSIVE MODE;
INSERT INTO users (user_id, blah, blah)
VALUES (
   coalesce(
       requested_id_or_null_if_none_supplied,
       (SELECT coalesce(max(user_id),0) FROM users)+1
   ),
   'blah',
   'blah'
);
COMMIT; 
```

这有不好的并发性。在任何给定时刻，只有一个事务可以插入用户。鉴于您正在处理的交易量应该非常好，只要您保持交易简短。

考虑添加一个用作公共*显示标识符*的新字段，与数据库的内部*主键*分开。为客户的目的使用此字段进行显示。让他们放任何他们想要的东西，只需将其声明`UNIQUE`为合适的唯一键的一部分。

如果这样做，您可以使用相同的序列保持基础编号分配，因此您不必更改在数据库中其他地方引用用户的方式。您不必更改应用程序的任何其他部分在内部引用用户的方式。显示用户标识符时，只需查找“用户编号”即可显示并使用它。当用户输入用户编号时，查找匹配行的主键。用户编号仅用于输入/输出作为最终用户的标识符，它不会在数据库的其余部分中被引用。

这就是为什么数据库/应用程序设计智慧强调*您通常不应该向用户公开生成的密钥的*原因。最终，如果他们能看到它们，他们将不可避免地希望能够通过“有趣”的结果来改变它们。给他们自己的公共标识符来玩要容易得多。如果他们突然决定它应该是字母数字，但只有在满月的星期二——没关系，你可以这样做。

一旦您将“显示标识符”和“唯一内部行键”拆分为单独的东西，您就可以自由地对显示标识符做任何您想做的事情，包括轻松地让他们更改它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T01:14:58.300

你显然得到了关于如何*正确*使用序列的讲座。您在问题中表现出一些见解，@Craig 的回答全面涵盖了这些差距。

至于你的问题，我会反过来说**：**为
特殊客人预留一组特殊号码。特殊数字应该很短。
例如，从`10000`（对于您的情况）开始您的序列。不用勤俭持家，序号便宜又丰富。

```
CREATE TABLE usr (
  usr_id serial PRIMARY KEY
 ,usr text   -- UNIQUE??
);

-- Let sequence start at 10000
SELECT setval('usr_usr_id_seq', 10000, FALSE);

-- Init table with first user if you want to start at certain number
-- Else numbers start at the lowest manual entry.
INSERT INTO usr(usr_id, usr) VALUES (1, 'first_user'); 
```

*特殊插入*（如果请求的号码不可用，则取第一个免费号码）：

```
WITH x AS (SELECT 4::int AS usr_id, 'special_guest' AS usr)
INSERT INTO usr(usr_id, usr)
SELECT CASE
         WHEN x.usr_id IS NULL THEN nextval('usr_usr_id_seq'::regclass)
         WHEN EXISTS (SELECT 1 FROM usr u WHERE u.usr_id = x.usr_id) THEN (
            SELECT u.usr_id + 1
            FROM   usr u
            WHERE  NOT EXISTS (SELECT 1 FROM usr u1
                               WHERE  u1.usr_id = u.usr_id + 1)
            ORDER  BY u.usr_id
            LIMIT  1)
         ELSE x.usr_id
       END
      ,x.usr
FROM   x; 
```

*通用 INSERT*（从序列中获取编号）：

```
INSERT INTO usr(usr) VALUES ('unspecial_guest'); 
```

-> [**sqlfiddle 演示**](http://www.sqlfiddle.com/#!12/f65d4/6)

### 并发

如果您需要担心并发性，则不应一开始就使用它。
此设置适用于充满特殊情况的手。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:04:46.767

我相信您的问题与序列无关。您可以创建一个产生负数的序列。这样您就可以完全分离手动和自动标识符。但这并不能解决您的问题，因为您仍然需要在正 ID 中找到“下一个可用数字”。

解决方案还取决于用户数量。如果您最多只有 1000 个用户。然后您可以使用 for 循环确定“下一个更大的可用数字”。但是，如果您要拥有 100 万个具有随机（手动给定）标识符的用户，那么问题就不那么容易了。

我不明白这里的概念。他们要么手动提供数字，要么不提供。如果该号码已被占用，那么您为什么要找到最接近的可用号码？为什么它比序列返回的任何其他数字更好？我的意思是，如果手动输入的数字已经被使用，那么你可以向用户抛出一条错误消息。如果用户不坚持给定的数字，那么任何其他数字都可以。对？

# java - 除了堆大小之外，还有什么会限制 HashMap 可以容纳的元素数量

> ID：12713206
> 
> 赞同：0
> 
> 时间：2012-10-03T16:54:28.807
> 
> 标签：java, hashmap

根据标题 - 什么限制了 HashMap 可以容纳的元素数量以及可以使用什么数据结构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T16:59:04.980

`hashCode`返回 an`int`而不是 a的事实`long`也阻止`HashMap`了超过 2^32 个条目的效率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T16:56:25.250

一件事是最大数组大小，在 Java 中是[`Integer.MAX_VALUE`](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#MAX_VALUE).

如果这对您有限制，那么您可以创建自己的类来包装`HashMap`对象列表或使用[`LinkedHashMap`](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:00:28.340

我真的不认为有限制。

首先，一个对象的 hashCode 将始终适合最大数组大小，因为最大的 int 值给出了最大数组大小。

其次，afaik HashMap 使用列表作为键。因此，如果两个键具有相同的 hashCode（即使您只插入一些值也可能发生这种情况），它们无论如何都会被插入。由于列表可以随心所欲，因此除了效率之外没有真正的限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T17:02:43.100

数据结构由底层哈希表的`HashMap`数组支持。因为必须使用整数指定 Java 数组大小，所以它们的大小被限制为`Integer.MAX_VALUE`（大约 20 亿个元素）。

如果需要对更多元素进行恒定时间查找，我想您可以将嵌套`HashMap`的 s 包装在自己的类定义中，但您还必须绕过 Java`Collection`接口指定`int`大小值的事实 - 简而言之，它是可能有一个存储多个元素的数据结构，但是接口`Integer.MAX_VALUE`中的任何东西都没有真正支持这一点。`Collection`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T16:57:17.763

唯一的约束是数组大小 (2^31-1) 和您的键类型可能的唯一值的数量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-03T17:03:36.053

除了您已经提到的堆大小之外，我认为您可以放入 HashMap 的项目数量没有任何硬性限制。

HashMaps 内部有一个“桶”数组，每个桶都是一个链表。当您添加一个项目时，它会被散列以找到正确的存储桶，然后添加到该链接列表的前面。因此，即使每个桶中都有一个项目，再添加一个项目只会将该项目添加到桶中的链表中。

我上面描述的行为是 Oracle JRE 附带的 HashMap 类的实现，在其他平台上可能会有所不同，因此其他平台可能对可以放入其中的项目数量有限制。

还值得指出的是，如果您将超过 Integer.MAX_VALUE 项放入 HashMap 中，则查找性能将大大降低，因为 HashMap 在尝试查找项时必须遍历列表。

# c# - 使用 C# 将灵活的 GUI 网页转换为 Excel

> ID：12713208
> 
> 赞同：1
> 
> 时间：2012-10-03T16:54:31.447
> 
> 标签：c#, asp.net, web-parts

我有一个使用 Web 部件在`C#.NET 4.0`. 它具有灵活的用户界面，用户可以通过拖放来更改控件的位置。此页面还具有***“导出到 Excel”***的功能，其中将页面内容导出到 Excel。

由于用户可以更改页面的布局，因此我无法`HTML`从 C# 创建表并将其导出到`Excel`. 谁能建议我克服这个问题的方法？

我希望 excel 具有与当前在网页上对用户可见的控件相同的定位和内容。

# javascript - 加载phonegap网站后在android上隐藏启动画面

> ID：12713212
> 
> 赞同：0
> 
> 时间：2012-10-03T16:54:46.270
> 
> 标签：javascript, eclipse, cordova, splash-screen

我有一个使用媒体查询在手机上看起来不错的网站，我将它包装在 phonegap 中，这样我也可以将它作为应用程序使用。我已将 super.loadUrl 设置为我的网站，并且这很有效，我还有一个工作启动画面，我想在网站加载之前跟上它。我遇到了[这篇博](http://simonmacdonald.blogspot.co.uk/2012/04/phonegap-android-splashscreen-just-got.html)文并按照说明进行操作。如果我是 index.html（应用程序主页）的 super.loadUrl，但如果我 loadUrl 的实际站点则不行。

启动画面代码（主 java 文件）

```
super.setIntegerProperty("splashscreen", R.drawable.splash);
super.loadUrl("My External Site Url", 20000); 
```

Index.html 代码（如果我 loadUrl 到它，这有效，但我想 loadUrl 到我的站点）

```
document.addEventListener("deviceready", onDeviceReady, false);
function onDeviceReady() {
    navigator.splashscreen.hide();
} 
```

但是，当我在我的外部 html 文件中使用上述代码（并包含 cordova.js）时，它无法识别 onDeviceReady，因此启动画面不会自行隐藏，我等待 20 秒。

我错过了什么吗？我什至可以从外部 html 文件（例如，未内置到应用程序中的文件）中使用 onDeviceReady 还是应该这样工作而我只是引用了cordova 错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T11:20:13.940

事实证明，prototype.js 的旧包含搞砸了。一旦我删除它，它就会非常有效。

对于未来的人，我得到的错误是：

*   应用程序对触摸没有反应，无法使用输入按钮和超链接。
*   如果您按住输入、超链接等，它会显示橙色焦点框，但从未将我带到链接或激活输入按钮（光标或键盘）
*   原型阻止我在任何时候准备好设备，但没有抛出 JS 错误（除了 IE 不喜欢 addEventListener）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T14:47:28.323

尝试这样做：

```
<script> 
function init() {
    document.addEventListener("deviceready", onDeviceReady, false);
}
function onDeviceReady() {
    navigator.splashscreen.hide();
}
</script>
<body onload="init()"> 
```

虽然由于您使用的是 jQuery，但您可能希望将其更改为：

```
$(document).ready(function() {
  document.addEventListener("deviceready", onDeviceReady, false);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-26T08:16:59.060

首先添加启动画面插件，如下所示：

```
$ phonegap plugin add org.apache.cordova.splashscreen 
```

第二次构建项目，“splashscreen.js”将被合并到“phonegap.js”中

```
$ phonegap local build 
```

祝你好运

# codeigniter - Laravel vs Codeigniter - 在 Laravel 中获取 CI 的 HMVC 功能

> ID：12713214
> 
> 赞同：2
> 
> 时间：2012-10-03T16:54:48.583
> 
> 标签：codeigniter, laravel, bundle, hmvc

如果我没记错的话，Laravel 的 Bundles 应该类似于 Codeigniter 的 Hierarchical MVC triads。我有一个内置 CI 的项目，我想将它迁移到 Laravel，所以我正在尝试匹配一些功能。在 CI 中，只需安装 HMVC 扩展，创建适当的文件夹结构，您就可以访问新创建的控制器。但是，在 Laravel 中，创建捆绑包后，您需要`application/bundles.php`通过添加来注册它

```
return array('newbundle'), 
```

有没有办法让我自动注册我的包目录中存在的所有（有效）包？就像这样，无需显式注册每个新捆绑包。换句话说，我想让bundle更加动态，这样我就可以复制一个bundle，将它粘贴到另一个项目中并立即开始使用它。

作为一个附带问题，是否有人知道使用 Laravel 的捆绑包实现 Wordpress 对其插件所做的“正确”方式：显示安装在捆绑包目录中的所有捆绑包的列表，但仅激活（注册）选定的那些？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-20T14:40:50.463

我不明白为什么没有人给你真正的答案。到目前为止，您可能已经知道如何实现自动加载包，如果没有，请看下面的包。

[http://bundles.laravel.com/bundle/autobundle](http://bundles.laravel.com/bundle/autobundle)

对于第二个问题，您需要开发一个自定义应用程序/捆绑包来管理它，就像 wordpress 使用插件一样。我只能给你想法，开发部分是你的。

保留一个数据库表（示例包）并有一个自定义包或路由/控制器来管理添加/删除包，包括将新包上传为 zip 并将其解压缩到包文件夹，同时在 db 表中注册包详细信息。每当您想激活插件时，将 activate 字段设置为 true 并在应用程序目录的 main start.php 中使用自定义捆绑启动方法，该方法可以是获取已激活捆绑包的所有名称并将其加载到的函数注册表。如果您想使用这种方法，您可以避免使用自动捆绑，因为它实际上会加载捆绑目录中的所有内容。

# network-programming - 在 solaris 中禁用 Nagle 算法

> ID：12713217
> 
> 赞同：0
> 
> 时间：2012-10-03T16:55:12.013
> 
> 标签：network-programming, solaris

假设我想在 Solaris 中禁用 Nagle 算法（用于实时传输数据），其中进程之间的连接是使用本地环回建立的，这会是一个问题。至于我的理解，Solaris 中的本地循环确实启用了 TCP 融合（有点类似于 Unix 域套接字）以减少堆栈使用的开销。它们是相关的还是相互排斥的？我的怀疑基本上是它会产生任何影响吗？

另外我想澄清一下是否可以禁用 Nagle 算法以进行本地环回通信？

我知道我可以使用 TCP_NODELAY。可能我需要澄清更多：1）在禁用Nagle算法的本地循环中会发生什么（默认情况下始终启用）。TCP 堆栈会等待 MSS，还是会立即将数据推出堆栈。2) 默认情况下，在 solaris 中启用 TCP 融合以加快读写速度。如果禁用 Nagle 是否会产生任何问题。最后我想要的是数据应该实时发送，没有任何延迟。所以我必须禁用Nagle或TCP融合就足够了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:56:30.550

我承认我不知道是否只能为 1 个接口禁用 naggle。在全球范围内，这将通过以下命令完成（但我猜你已经知道了）：

```
/usr/sbin/ndd -set /dev/tcp tcp_naglim_def 1 
```

我的 Solaris VM 现在坏了，所以我无法测试，但如果我们想象“lo0”是您的环回，“/usr/sbin/ndd -set /dev/ **lo0** tcp_naglim_def 1”会起作用吗？

推荐的默认设置是保持 Nagle 启用，您可以在应用程序中禁用它吗？它应该像使用 TCP_NODELAY 选项调用 setsockopt() 一样简单。

# ruby-on-rails-3 - Ruby on rail 3.1 不适用于回形针 3.2.0 与 3.0.3

> ID：12713219
> 
> 赞同：2
> 
> 时间：2012-10-03T16:55:24.383
> 
> 标签：ruby-on-rails-3, imagemagick, paperclip

我在一个与回形针 3.0.3 完美配合但与回形针 3.2.0 完全兼容的项目上使用回形针。在 3.0.3 中，它裁剪图像并添加水印，在 3.2.0 中，它在处理每个图像的第一个命令时循环，并一次又一次地执行直到崩溃。

下面找到的代码主要来自 Railcast 关于回形针和我在 stackoverflow 上找到的其他代码。我认为人们可能会感兴趣地看到一个集成了所有这些的工作版本（带有回形针 3.0.3）。

这是模型的代码

```
require 'paperclip_processors/watermark'
require 'paperclip_processors/cropper'

class Imageblock < ActiveRecord::Base

   belongs_to :block

   attr_accessor :crop_x, :crop_y, :crop_w, :crop_h, :old_size_width, :old_size_height

   validates_presence_of :size_width, :size_height, :photo

   validates_format_of :description, :with => /\A[^"]+\z/, :message => "No quotes allowed"

   has_attached_file :photo, :styles => lambda { |attachment| 
       image = attachment.instance
       dimensions = "#{image.size_width}x#{image.size_height}#"
       { 
          :small => {:geometry => "100x100#"},
          :custom => {:geometry => dimensions, :processors => [:cropper] },
          :large => {:geometry => "500x500>"},
          :display =>{:geometry => "1000x1000>", :watermark_path => "#{Rails.root}/app/assets/images/monogram.png", :processors => [:watermark]},
          :retina =>{:geometry => "2000x2000>", :watermark_path => "#{Rails.root}/app/assets/images/monogram.png", :processors => [:watermark]} 
       }
   }, :dependant => :destroy,  :url => "/art/photo/:id/:style/:basename.:extension", :path => ":rails_root/public/art/photo/:id/:style/:basename.:extension"

   after_update :reprocess_photo, :if => :cropping?

   def cropping?
       !crop_x.blank? && !crop_y.blank? && !crop_w.blank? && !crop_h.blank?
   end

   def photo_geometry(style = :original)
       @geometry ||= {}
       @geometry[style] ||= Paperclip::Geometry.from_file(photo.path(style))
   end

   private

   def reprocess_photo
       photo.reprocess!
   end

 end 
```

这是裁剪器处理器的代码

```
module Paperclip
class Cropper < Thumbnail
   def transformation_command
      if crop_command
         crop_command + super.join(' ').sub(/ -crop \S+/, '').split(' ') # super returns     an array like this: ["-resize", "100x", "-crop", "100x100+0+0", "+repage"]
      else
        super
      end
    end

    def crop_command
       target = @attachment.instance
       if target.cropping?
          ["-crop", "#{target.crop_w}x#{target.crop_h}+#{target.crop_x}+#{target.crop_y}"]
       end
    end
  end
end 
```

水印的代码很长，在stackoverflow中找到的

```
module Paperclip
class Watermark < Processor
 # Handles watermarking of images that are uploaded.
   attr_accessor :current_geometry, :target_geometry, :format, :whiny, :convert_options, :watermark_path, :overlay, :position

   def initialize file, options = {}, attachment = nil
      super
      geometry          = options[:geometry]
      @file             = file
      @crop             = geometry[-1,1] == '#'
      @target_geometry  = Geometry.parse geometry
      @current_geometry = Geometry.from_file @file
      @convert_options  = options[:convert_options]
      @whiny            = options[:whiny].nil? ? true : options[:whiny]
      @format           = options[:format]
      @watermark_path   = options[:watermark_path]
      @position         = options[:position].nil? ? "SouthEast" : options[:position]
      @overlay          = options[:overlay].nil? ? true : false
      @current_format   = File.extname(@file.path)
      @basename         = File.basename(@file.path, @current_format)
    end

    # TODO: extend watermark

    # Returns true if the +target_geometry+ is meant to crop.
     def crop?
       @crop
     end

     # Returns true if the image is meant to make use of additional convert options.
     def convert_options?
       not @convert_options.blank?
     end

     # Performs the conversion of the +file+ into a watermark. Returns the Tempfile
     # that contains the new image.
     def make
       dst = Tempfile.new([@basename, @format].compact.join("."))
       dst.binmode

       command = "convert"
       params = [fromfile]
       params += transformation_command
       params << tofile(dst)
       begin
         success = Paperclip.run(command, params.flatten.compact.collect{|e| "'#{e}'"}.join(" "))
         rescue PaperclipCommandLineError
         raise PaperclipError, "There was an error resizing and cropping #{@basename}" if @whiny
       end

       if watermark_path
         command = "composite"
         params = %W[-gravity #{@position} #{watermark_path} #{tofile(dst)}]
         params << tofile(dst)
         begin
           success = Paperclip.run(command, params.flatten.compact.collect{|e| "'#{e}'"}.join(" "))
         rescue 
           raise PaperclipError, "There was an error processing the watermark for #{@basename}" if @whiny
         end
       end

       dst
     end

     def fromfile
       File.expand_path(@file.path)
     end

     def tofile(destination)
       File.expand_path(destination.path)
     end

     def transformation_command
       scale, crop = @current_geometry.transformation_to(@target_geometry, crop?)
       trans = %W[-resize #{scale}]
       trans += %W[-crop #{crop} +repage] if crop
       trans << convert_options if convert_options?
       trans
     end
  end
end 
```

如果有人知道为什么它不能与回形针 3.2.0 一起使用，我在网上找不到有关此错误的任何帮助。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T03:40:01.413

看看 [https://github.com/thoughtbot/paperclip/issues/866](https://github.com/thoughtbot/paperclip/issues/866) 它应该已经修复了。

**更新**

您的代码将在深度堆栈级别错误中运行。它是通过 after_update 过滤器回调和回形针中的更改引起的（查看问题 866）。你必须移动后处理！从模型调用控制器#update

```
def update
  if @asset.save
    if params[:asset][:crop_x] 
      @asset.attach.reprocess!
    end
    redirect_to .. 
```

# html - xpath 表达式不起作用

> ID：12713222
> 
> 赞同：2
> 
> 时间：2012-10-03T16:55:30.093
> 
> 标签：html, r, xpath

```
 <DOC NUMBER=1>
<DOCFULL> -->
<br><div class="c0">
<p class="c1"><span class="c2">Dokument 1 von 3</span></p>
</div>
<br><div class="c0">
<br><p class="c1"><span class="c2">Associated Press Financial Wire</span></p>
</div>
<br><div class="c3">
<p class="c1"><span class="c2">April 25, 2012 Wednesday 9:18 PM GMT </span></p>
</div>
<br><div class="c4">
<p class="c5"><span class="c6">Apple CEO Tim Cook emerges from Steve Jobs' shadow</span></p>
</div>
<br><div class="c4">
<p class="c5"><span class="c7">BYLINE: </span><span class="c2">By PETER SVENSSON, AP Technology Writer</span></p>
</div>
<br><div class="c4">
<p class="c5"><span class="c7">SECTION: </span><span class="c2">BUSINESS NEWS</span></p>
</div>
<br><div class="c4">
<p class="c5"><span class="c7">LENGTH: </span><span class="c2">794 words</span></p>
</div>
<br><div class="c4">
<p class="c5"><span class="c7">DATELINE: </span><span class="c2">NEW YORK </span></p>
</div>
<br><div class="c4">
<p class="c8"><span class="c2"> MAIN TEXT 1</span></p>
</div>
<br><div class="c4">
<p class="c5"><span class="c7">LOAD-DATE: </span><span class="c2">April 26, 2012</span></p>
</div>
<br><div class="c4">
<p class="c5"><span class="c7">LANGUAGE: </span><span class="c2">ENGLISH</span></p>
</div>
<br><div class="c4">
<p class="c5"><span class="c7">PUBLICATION-TYPE: </span><span class="c2">Newswire</span></p>
</div>
<br><div class="c0">
<br><p class="c1"><span class="c2">Copyright 2012 Associated Press<br>All Rights Reserved</span></p>
</div>
<!-- Hide XML section from browser
</DOCFULL>
</DOC> --> 
```

我是 xpath 的新手，我想将它与 R（Duncan Lang 的 xml 包）结合使用来查询我从 LexisNexis 收到的 html 文档。该文档包含多篇新闻文章，每篇文章都以`<DOC NUMBER=1> <DOCFULL>`标签为界。我希望为每个文档提取一些信息，例如提取 SECTION 信息，我到此为止：

```
doc <- htmlParse("hmtldoc.HTML")
xpathSApply(doc,"//span[text()='SECTION: ']/..", xmlValue) 
```

这给了我：

```
[1] "SECTION: BUSINESS NEWS" "SECTION: BUSINESS NEWS" "SECTION: BUSINESS NEWS" 
```

那是我可以使用的输出。主要问题是并非每篇文章都有 SECTION 信息。我需要知道的是哪篇文章提供了这些信息，哪些没有，最好是通过返回 NA 或一个空的列表元素，这样我就可以自己推断出这些信息。

与这个问题相关：我试图提出一个解决方案，我首先选择 DOC 或 DOCFULL 节点并从那里继续，例如：

```
xpathSApply(doc,"//DOCFULL/*/span[text()='SECTION: ']/..", xmlValue) 
```

我认为这应该返回与上面相同的文本，但事实并非如此。无论如何，我对这门语言还是很陌生，感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:08:08.410

`DOCFULL`因为 s和s之间存在不止一个“级别”的后代元素`span`，所以您需要

*含糊其辞*

```
//DOCFULL//*/span[text()='SECTION: ']/.. 
```

或 *具体说明级别（div 和 p）*

```
//DOCFULL/*/*/span[text()='SECTION: ']/.. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T13:03:03.773

有了给定的文档，您就可以使用它：

```
//*[span='SECTION: '] 
```

您无需指定查找带有文本“SECTION:”的跨度节点，然后选择它的父节点，您只需选择具有该文本的“跨度”子节点的任何节点。

如果您需要它成为`DOCFULL`元素的后代，请使用

```
//DOCFULL//*[span='SECTION: '] 
```

# c - 内核的哪一部分加载了 PS3 的 framebuffer 模块？

> ID：12713230
> 
> 赞同：0
> 
> 时间：2012-10-03T16:55:56.067
> 
> 标签：c, linux, video, linux-kernel, linux-device-driver

我试图弄清楚 PS3 如何启动它的视频驱动程序。

[linux内核源代码](http://lxr.free-electrons.com/source/drivers/video/ps3fb.c?a=arm#L1288)`static int __init ps3fb_init(void)`中有什么调用？

*   `insmod`这个模块有什么要求？
*   它发生在源代码中的什么地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-06T04:18:14.093

ps3fb_init 由 module_init 调用。

```
static int __init ps3fb_init(void)
{
        if (!ps3fb_videomemory.address ||  ps3fb_setup())
                return -ENXIO;

        return ps3_system_bus_driver_register(&ps3fb_driver);
}

[..]

module_init(ps3fb_init); 
```

udev 在引导期间加载所需的模块。来自 udev 文档，

```
 - All kernel events are matched against a set of specified rules in
    /etc/udev/rules.d/ which make it possible to hook into the event
    processing to load required kernel modules and setup devices. For all
    devices the kernel exports a major/minor number, udev will create a
    device node with the default kernel name or the one specified by a
    matching udev rule. 
```

# c# - MVC 4 Web API OData 奇怪的结果

> ID：12713232
> 
> 赞同：1
> 
> 时间：2012-10-03T16:55:59.453
> 
> 标签：c#, asp.net-mvc, asp.net-web-api, odata

我以前使用以下代码让我的 Web API 控制器正常工作：

```
 [Queryable(ResultLimit = 30)]
    public IQueryable<Lead> Get()
    {
        return _db.Leads;
    } 
```

然后我在我的 Leads 表上添加了一个外键。我收到 JSON 循环错误。所以我决定只选择我需要从控制器返回的字段。以下是代码示例：

```
 [Queryable(ResultLimit = 30)]
    public IQueryable<dynamic> Get()
    {
        return _db.Leads.Select(x => new
                                    {
                                        x.FirstName,
                                        x.LeadTypeID,
                                        x.DateSent
                                    }).AsQueryable();
    } 
```

当我通过我的应用程序或终端调用 api 时，结果或返回正确。但是，当我将 url 粘贴到浏览器 (Chrome) 中时，出现服务器 500 错误。猜测 XML 而不是 JSON 错误。它在添加关系之前起作用。我想解决上一个问题，但这并不重要。关注的领域是数据被返回，但我的 OData 过滤器被忽略了。

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:15:36.250

内置的 XML 序列化程序不支持匿名类型，这就是您遇到运行时异常的原因。有 3 种方法可以解决这个问题：

1.  创建自定义 POCO 以返回而不是您的匿名类型。
2.  您可以删除 XML 序列化程序并让您的应用程序始终返回 JSON。`GlobalConfiguration.Configuration.Formatters.XmlFormatter.SupportedMediaTypes.Clear();`您可以通过在 global.asax.cs 文件的 Application_Start() 方法中添加：来禁用序列化 程序。
3.  您可以选择支持匿名类型的不同 XML 序列化程序。我不知道任何手头，但我敢肯定那里有一些。

# bash - 未找到 NGINX brew install 命令

> ID：12713233
> 
> 赞同：8
> 
> 时间：2012-10-03T16:56:13.367
> 
> 标签：bash, command-line, nginx, homebrew, .bash-profile

我愿意

```
$ brew install nginx 
```

并得到：

```
==> Downloading http://nginx.org/download/nginx-1.2.2.tar.gz
Already downloaded: /Library/Caches/Homebrew/nginx-1.2.2.tar.gz
==> Patching
patching file conf/nginx.conf
==> ./configure --prefix=/usr/local/Cellar/nginx/1.2.2 --with-http_ssl_module --with-pcre         --with-ipv6 --with-cc-opt=-I/usr/local/include --with-ld-opt=-L/usr/local/lib --conf
==> make
==> make install
==> Caveats
In the interest of allowing you to run `nginx` without `sudo`, the default
port is set to localhost:8080.

If you want to host pages on your local machine to the public, you should 
change that to localhost:80, and run `sudo nginx`. You'll need to turn off
any other web servers running port 80, of course.

You can start nginx automatically on login running as your user with:
mkdir -p ~/Library/LaunchAgents
cp /usr/local/Cellar/nginx/1.2.2/homebrew.mxcl.nginx.plist ~/Library/LaunchAgents/
launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist

Though note that if running as your user, the launch agent will fail if you
try to use a port below 1024 (such as http's default of 80.)
Warning: /usr/local/sbin is not in your PATH
You can amend this by altering your ~/.bashrc file 
```

我的 ~/.bashrc 文件中有这个：

```
 export PATH=$PATH:/usr/local/sbin 
```

当我运行 nginx -v 或 sudo nginx -ti 得到这个：

```
-bash: nginx: command not found 
```

我没有正确安装nginx吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T17:34:09.370

运行 echo $PATH，会出现 /usr/local/sbin 吗？如果没有：尝试采购您的 ~/.bashrc 文件，看看它是否出现：source ~/.bashrc

再次运行 echo $PATH。它应该出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-08T08:26:44.840

我只是通过brewHome安装nginx，发现路径是`/usr/local/Cellar/nginx/1.12.0/bin`，所以我只是添加`export PATH=$PATH:/usr/local/Cellar/nginx/1.12.0/bin`到conf文件中，它运行良好。

供参考

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:03:29.790

在我的 debian 6 服务器中，nginx 安装在`/usr/sbin/`. 如果您想直接从终端访问它，请将该目录添加到您的 PATH 变量中：

```
PATH=/usr/sbin/:$PATH 
```

这些`sbin`目录通常被添加到 root 用户的 PATH 中，您是否以 root 身份登录终端？如果没有，您可以通过输入`su`命令来执行此操作。

# sql - SQL Server - 使用 group by 聚合比不使用聚合更快

> ID：12713234
> 
> 赞同：3
> 
> 时间：2012-10-03T16:56:18.607
> 
> 标签：sql, indexing, group-by, aggregate, sql-execution-plan

我很难弄清楚为什么在一种情况下强制执行特定的执行计划，而不是在另一种情况下。例子：

```
select min(COLUMN) from TABLE where FK_COLUMN = 1; 
```

对比

```
select min(COLUMN) from TABLE where FK_COLUMN = 1 group by FK_COLUMN; 
```

第一个生成带有索引扫描的执行计划，而在第二个中，扫描被查找替换。进一步增加我的困惑的是，这不会发生在表格的每一列上 - 对于某些列，我不需要 group by 来生成搜索。我还注意到，缓慢的情况只发生在某些外键值上——那些只返回没有行的值，但不是所有没有返回行的值都会产生不利的计划。是什么赋予了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T07:23:17.857

我`@Robbie Dee`选择 Oracle CBO 选择的执行计划并不意味着它是最好的方式，而是在大多数情况下最优化的方式。此外，执行计划可以根据列和行的存储方式（基本上是表的大小）而改变。

考虑一个以 EMP_ID 列为主键的 EMP 表。如果我们在搜索中包含主键列，我们会期待一个`INDEX RANGE SCAN`但我们可能会`FULL TABLE ACCESS`进入解释计划。这是 Oracle CBO 选择的数据访问路径，因为它知道表的大小太小，不需要根据主键进行搜索。

嗯...

# jquery - 在 jquery 数据表中添加图像作为行值

> ID：12713238
> 
> 赞同：2
> 
> 时间：2012-10-03T16:56:33.603
> 
> 标签：jquery, datatables

我有来自服务器的 json 响应，如下所示

```
{"id":20,"name":"d","jobid":"22","workflow":"Diagnostic","**status**":"COMPLETE"}... 
```

我的js函数是这样的，

```
var oTable = $('#myTable').dataTable({
    'sPaginationType': 'sample',
    "bStateSave": true,
    "bServerSide": true,
    "bDestroy": true,
    "sAjaxSource": "/someurl"
});​ 
```

我可以在数据表中显示这些数据。但是基于 json 响应中的状态值，我需要提供**图像作为数据表行值。** （说 img1 状态“完成”...）..

我必须使用 jquery 来执行此操作才能使用 jquery 数据表进行显示。

请帮忙

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T17:08:31.710

只需在 JSON 中添加图像

```
{
    "id": 20,
    "name": "d",
    "jobid": "22",
    "workflow": "Diagnostic",
    "**status**": "<img src=\"img1.jpg\">"
} 
```

如果要根据状态切换图像。只需通过条件语句切换它。

例如 ：

```
if($status == "complete"){
  $img = "<img src=\"img1.jpg\">";
}
else{
   $img = "<img src=\"img1.jpg\">";
} 
```

然后使用 img 变量构建您的 json。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:36:37.040

将您的响应变量之一设置为 html 字符串。当您将该 html 放入单元格时，它应该可以工作。

# java - 在本地机器上创建消息队列

> ID：12713240
> 
> 赞同：0
> 
> 时间：2012-10-03T16:56:44.290
> 
> 标签：java, message-queue

如何在不使用任何消息队列软件（如 IBM Websphere MQ）的情况下创建消息队列？如果是这样，我应该如何在本地机器上的 eclipse 中运行我的 java 客户端应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T18:10:37.187

这取决于您要达到的目标。

如果您需要在线程之间建立一个非常简单的通信，您可以使用java.util.concurrent 中的[BlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)来分发您的消息对象。

如果你不想使用消息队列软件的原因只是你不想要任何繁重的东西，那么你可以考虑使用[ZeroMQ——](http://www.zeromq.org/)一个轻量级的消息传递库。它易于设置并提供从套接字已知的简单 API。我不知道它在 Java 世界中是否流行，但它在 C++ 和 Python 世界中使用。

# objective-c - 如何将项目文件复制到应用程序的文件夹？

> ID：12713245
> 
> 赞同：0
> 
> 时间：2012-10-03T16:57:16.153
> 
> 标签：objective-c

我想使用 NSFileManager 在 MyApp.app/Document 文件夹中创建一个文件夹。（MyApp 是我的自定义应用程序。）

因此，我将 IMG_0525.jpg（用于测试）复制到项目的文件夹中。

然后尝试将其从项目文件夹复制到 MyApp.app/Document 文件夹。

但我不知道如何指定路径名。（源和目标路径）

你能告诉我怎么做吗？

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    [self generateTableContents];

}

- (void)generateTableContents {

    NSFileManager * fileManager = [NSFileManager defaultManager];
    NSArray *appsDirectory = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentPath = [appsDirectory objectAtIndex:0];
    NSLog(@"documentPath : %@", documentPath);

    [fileManager changeCurrentDirectoryPath:documentPath];
    [fileManager createDirectoryAtPath:@"user_List1" withIntermediateDirectories:YES attributes:nil error:nil];

    // I'm trying to copy IMG_0525.jpg to MyApp.app/Document/user_List1 folder.
    [fileManager copyItemAtPath:<#(NSString *)srcPath#> toPath:<#(NSString *)dstPath#> error:<#(NSError * *)error#>];

} 
```

![在此处输入图像描述](../Images/5cb851681f25231959f12dbe93572574.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:10:13.770

*   您用于获取此文档目录的代码`NSSearchPathForDirectoriesInDomains`是正确的，但请注意，这不会指向“MyApp.app/Documents”。事实上，你不能在运行时修改应用程序的包内容（顺便说一句，如果你修改它会违反包的代码签名），但你可以在应用程序的沙箱中复制文件（它在“MyApp.app”之外" bundle)，这是您调用`NSSearchPathForDirectoriesInDomains`将返回的此应用程序沙箱的 Document 文件夹的路径

*   话虽如此，您现在有了文件的目标文件夹，这就是方法的`toPath:`参数`-copyItemAtPath:toPath:error:`。唯一缺少的部分是指向包中资源的源路径（指向您在 Xcode 项目中添加的图像文件，一旦它在包中编译）。

**要获取此源路径，请使用`-[NSBundle pathForResource:ofType:]`方法**。这使用起来非常简单：

```
NSString* sourcePath = [[NSBundle mainBundle] pathForResource:@"IMG_0525" ofType:"jpg"]; 
```

*   最后一个`error:`参数可以是，如果您想在方法失败的情况下检索错误，则可以是`NULL`指向对象的指针。对于该参数，只需在调用之前创建一个变量，然后传递给.`NSError*``-copyItemAtPath:toPath:error:``NSError* error;``&error``-copyItemAtPath:toPath:error:`

所以完整的调用将如下所示：

```
NSError* error; // to hold the error details if things go wrong
NSString* sourcePath = [[NSBundle mainBundle] pathForResource:@"IMG_0525" ofType:"jpg"];

BOOL ok = [fileManager copyItemAtPath:sourcePath toPath: documentPath error:&error];
if (ok) {
  NSLog(@"Copy complete!");
} else {
  NSLog(@"Error while trying to copy image to the application's sandbox: %@", error);
} 
```

# java - 在 Java 中读取和写入同一个文件

> ID：12713247
> 
> 赞同：11
> 
> 时间：2012-10-03T16:57:16.647
> 
> 标签：java, file-io

我想从 `criteria.txt`文件中读取，以标记化并在同一文件的末尾附加标记。程序抛出异常：`No file found!`我不知道我的错误在哪里。任何建议都会帮助我。先感谢您！

这是我的代码：

```
import java.io.*;
import java.util.StringTokenizer;

public class Test
{
    private FileReader fr;
    private BufferedReader br;
    private FileWriter fw;
    private BufferedWriter bw;
    private StringTokenizer strtok;
    private String s;

    //constructor
    public Test()  
    {
        try
        {
            fw=new FileWriter("criteria.txt", true);
            bw=new BufferedWriter(fw);

            try
            {
                fr=new FileReader("criteria.txt");
                br=new BufferedReader(fr);

                while((s=br.readLine())!=null)
                {
                    strtok=new StringTokenizer(s," ");
                    while(strtok.hasMoreTokens())
                    {
                        bw.write("\n"+strtok.nextToken());
                    }
                    br.close();
                }
            }
            catch(FileNotFoundException e)
            {
                System.out.println("File was not found!");
            }
            catch(IOException e)    
            {
                System.out.println("No file found!");
            }

            bw.close();
        }
        catch(FileNotFoundException e)
        {
            System.out.println("Error1!");
        }
        catch(IOException e)    
        {
            System.out.println("Error2!");
        }
    }   

    public static void main(String[] args) 
    {
        Test t=new Test();
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T17:14:47.133

完成阅读文件后，即在 while 循环之后，您需要关闭阅读器。目前，您在阅读第一行后关闭它，这会`IOException: Stream closed`在它尝试阅读第二行时导致“”。

改成：

```
while((s=br.readLine())!=null)
{
    strtok=new StringTokenizer(s," ");
    while(strtok.hasMoreTokens())
    {
        bw.write("\n"+strtok.nextToken());
    }
    //br.close(); <----- move this to outside the while loop
}
br.close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T00:15:27.450

您最大的失败是将循环放在`br.close();`内部`while()`：每次写入文件时都告诉计算机立即关闭它，因此文件保持关闭状态，并且计算机在循环的下一次迭代/执行期间永远找不到它。但是，我已将初始程序编辑为：

```
import java.io.*;
import java.util.StringTokenizer;

public class Test
{
    private FileReader fr;
    private BufferedReader br;
    private FileWriter fw;
    private BufferedWriter bw;
    private StringTokenizer strtok;
    private String s;

    //constructor
    public Test()  
    {
        try
        {
            fw=new FileWriter("criteria.txt", true);
            bw=new BufferedWriter(fw);

            try
            {
                fr=new FileReader("criteria.txt");
                br=new BufferedReader(fr);

                **while((s=br.readLine())!=null)
                {
                    strtok=new StringTokenizer(s," ");
                    while(strtok.hasMoreTokens())
                    {
                        bw.write("\n"+strtok.nextToken());
                    }

                }
                     br.close();
            }**
            catch(FileNotFoundException e)
            {
                System.out.println("File was not found!");
            }
            catch(IOException e)    
            {
                System.out.println("No file found!");
            }
            bw.close();
        }
        catch(FileNotFoundException e)
        {
            System.out.println("Error1!");
        }
        catch(IOException e)    
        {
            System.out.println("Error2!");
        }
    }   

    public static void main(String[] args) 
    {
        Test t=new Test();
    }
} 
```

在这种情况下，文件存在的文件夹或目录无关紧要，因为程序将在与 java 程序相同的文件夹中创建一个名为“criteria.txt”的新文件；但是，您必须使用文本编辑器打开文件以添加/附加一些数据，因为该文件最初是空白的。程序的后续运行现在会将已插入的内容作为连接字符串附加到新行上。每次运行程序时都会产生一个新行。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:51:34.450

在我看来，你不能那样做。您不能同时打开同一个文件进行读写。您必须打开文件信息并将其保存在数据结构中，然后将其关闭。然后您必须使用内存中的数据结构并打开文件以写入结果。当你写完你应该关闭它。

# spring.net - Spring.NET WebServiceExporter 和 WCF

> ID：12713250
> 
> 赞同：2
> 
> 时间：2012-10-03T16:57:30.787
> 
> 标签：spring.net

我修改了我原来的问题（希望这是允许的）......

我已经使用 WCF 来公开我的 Spring Service 层。我创建了一个 WCF 项目，对于我的应用程序中的每个服务接口（IOrderService、ICustomerService 等），我创建了一个 SVC 文件并在 web.config 中添加了适当的配置。这一切都很好，Spring 的依赖注入也很有效。

我希望 Spring 的 ServiceExporter 类可以使这个过程更加简单。但它给了我什么我还没有的东西？*它是否允许我在不需要*WCF 项目的情况下实现相同的目标？我问的原因是我看到的大多数示例还提到了 WCF 项目中的“编辑 .svc 文件”。

由于 ASMX WebServiceExporter 允许我仅从我的界面和一些 XML 配置创建 Web 服务，因此我认为 ServiceExporter 会类似。

可选：顺便说一句，在 Spring 中只有一个 WebServiceExporter 类并拥有一个属性（例如 exportAs="WCF | ASMX"）不是更好吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:26:36.250

首先，请阅读： [http ://www.springframework.net/docs/1.2.0-M1/reference/html/wcf-quickstart.html](http://www.springframework.net/docs/1.2.0-M1/reference/html/wcf-quickstart.html)

> 我希望 Spring 的 ServiceExporter 类可以使这个过程更加简单。但它给了我什么我还没有的东西？

好吧，主机必须引用导出器对象：

```
<object id="OpcServiceHost"
type="Spring.ServiceModel.Activation.ServiceHostFactoryObject,Spring.Services">    
<property name="TargetName" value="OpcServiceExporter" /> 
</object> 
```

> 它是否允许我在不需要 WCF 项目的情况下实现相同的目标？

你指的是服务接口项目吗？如果是这样 - spring.net 示例显示 WCF 接口的 Spring 特定实现在服务器项目中使用，而不是在它自己的接口项目中使用。另请注意，基本的 WCF 服务接口（System.ServiceModel.Dispatcher.IInstanceProvider 和 System.ServiceModel.Description.IServiceBehavior）由 Spring 封装。链接中给出的示例表明您不需要这样的项目，但是接口是在服务器项目中定义的。

> 顺便说一句，在 Spring 中只有一个 WebServiceExporter 类并拥有一个属性，例如 exportAs="WCF | ASMX" 不是更好吗？

不是一个选项 - 但是，您可以尝试使用 ServiceExporter 类的 GenerateProxy 方法： [http ://www.springframework.net/docs/1.3.2/api/net-2.0/html/topic16729.html](http://www.springframework.net/docs/1.3.2/api/net-2.0/html/topic16729.html)

# ruby - Ruby：如何判断字符是大写还是小写

> ID：12713251
> 
> 赞同：43
> 
> 时间：2012-10-03T16:57:30.270
> 
> 标签：ruby

我很惭愧地问这个问题，因为它看起来应该很明显，但是如何判断字符串中的给定字符在 Ruby 中是大写还是小写呢？`String`我在课堂上看不到明显的罐头解决方案。

我采用了以下方法，其中不考虑非 ASCII 代码：

```
def is_lower?(c)
  c >= 'a' && c <= 'z'
end

def is_upper?(c)
  ! is_lower(c)
end 
```

我考虑的其他事情是：

```
def is_lower?(c)
    c != c.upcase
end 
```

有什么更惯用的吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-10-03T17:06:06.877

使用正则表达式模式：[AZ] 或：

```
/[[:upper:]]/.match(c) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-10-03T17:06:11.417

我不认为有更惯用的东西。你唯一能做的——而不是将字符串作为参数传递——是猴子补丁`String`类：

```
class String
  def is_upper?
    self == self.upcase
  end

  def is_lower?
    self == self.downcase
  end
end

"a".is_upper? #=> false
"A".is_upper? #=> true 
```

使用上面评论者和猴子补丁建议[的答案](https://stackoverflow.com/a/8529619/84631)`String`中的方法，您可以这样做：

```
class String
  def is_upper?
    !!self.match(/\p{Upper}/)
  end

  def is_lower?
    !!self.match(/\p{Lower}/)
    # or: !self.is_upper?
  end
end 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-08-26T09:52:40.100

只需使用 if 语句，例如`if c == c.upcase`or `if c == c.downcase`。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-07-18T23:04:52.733

字符串小写是什么意思？这是否意味着字符串仅包含小写字符或不包含任何大写字符？就我而言，我想要：

```
"a2".is_lower? #=> true 
```

..这导致我：

```
class String

  def is_upper?
    not self.match /[[:lower:]]/
  end

  def is_lower?
    not self.match /[[:upper:]]/
  end

end 
```

请注意，这`/\p{Lower}/`可能会更好，但在 Ruby 1.8 上不受支持。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-06-18T10:02:58.380

匹配转换不会模拟 libc`isupper()`和`islower()`函数的功能，因为两者都应该返回`false`非 alpha。

范围似乎是对单个字符执行此操作的最简单方法。

```
class String
  def islower?
    return false if self.size > 1
    ('a'..'z').include? self
  end

  def isupper?
    return false if self.size > 1
    ('A'..'Z').include? self
  end
end 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-11-29T20:27:54.700

验证字符是大写还是小写的最简单方法：

```
#Can be any character
char = 'a'
if char === char.capitalize then
  return 'Character is uppercase.'
else
  return 'Character is lowercase.'
end 
```

这个非常简单`if loop`的方法可以通过检查它是否等于它的大写形式来确定一个字母的“大小写”。如果它已经是大写的，它显然是`true`.

# c# - 按 long 列表对对象列表进行排序

> ID：12713254
> 
> 赞同：0
> 
> 时间：2012-10-03T16:57:32.030
> 
> 标签：c#

我有一个有点像这样的类模型：

```
public class MyModel
{
   long MyModelID { get; set; }
} 
```

我有一个`MyModel`名为的对象列表`TheListOfModels`和一个名为的 long 列表`TheListOfIDs`：我希望`TheListOfModels`按照与`TheListOfIDs`.

我想到的是一个循环，它`TheListOfIDs`在每次迭代时将对应的添加`TheListOfModels`到一个名为的新列表中`SortedList`，然后将该列表重新分配给原始的`TheListOfModels`.

这是最好的方法还是这个特定操作有 linq 语法？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:19:50.647

这会做到：

```
var q = (from i in TheListOfIDs
        join m in TheListOfModels on i equals m.MyModelID
        select m).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:08:32.643

这个效率不是很高，但它可以解决问题：

```
List<Model> models = ...
List<long> ids = ...

var dic = models.ToDictionary(x => x.ID, x => x);
var modelsByIds = ids.Select(x => dic[x]).ToList(); 
```

# database - 使用 PHP、MySQL 和 Redis

> ID：12713255
> 
> 赞同：6
> 
> 时间：2012-10-03T16:57:41.200
> 
> 标签：database, caching, redis

我试图了解如何以一种好的方式缓存数据库以及该做什么和不该做什么。虽然我想确保到目前为止我已经正确理解了所有内容。也许你能帮助我？

目前我没有任何缓存，我使用 XAMPP 在本地完成所有操作。为了存储数据，我使用 MySQL/PHPMyAdmin，为了获取、添加和更新数据，我只需在 PHP 中进行 Mysqli 查询。正如我所说，我现在没有任何缓存，所以我开始寻找最好的方法来做到这一点。

经过快速搜索，我找到了[Redis](http://redis.io/)。所以我的想法是使用 MySQL 存储数据并使用 Redis 将其缓存。这是一个好方法还是我完全理解错了？

如果我是对的，我该如何实现 Redis？如何缓存数据？如果我想要的数据被缓存，我是否会在 PHP 中进行检查，如果是则从缓存中获取，否则从 MySQL 数据库中获取。

真的很想知道我是否走在正确的轨道上。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-03T17:10:33.520

Redis 是一个开源数据结构服务器，具有内存数据集，由于其内置的数据类型，它的功能远不止简单的键/值存储。

如果您的要求是缓存批量数据，您可以这样做，这里有一个快速[教程](http://phpmaster.com/an-introduction-to-redis-in-php-using-predis/)

如果你只是想实现缓存，你可以使用 memcache

memcache 适用于存储返回小数据集的慢查询 [1 - 50 个结果，取决于平均行权重]

对于任何返回大型数据集的查询 [100 - ∞，取决于平均行权重]，memcache 的效率都不是那么高

以下是一些链接，您可以在其中找到有关 memcache 的更多信息

[内存缓存介绍](http://papermashup.com/using-memcache-with-php/)

[将 memcache 与 php 和 mysql 一起使用](http://pureform.wordpress.com/2008/05/21/using-memcache-with-mysql-and-php/)

还有，最后但并非最不重要的

mysql也缓存查询结果，可能你可以增加mysql查询缓存大小吗？或者将大查询的结果缓存在一个独立的表中。

许多 SO 帖子中提供了有关 Mysql 查询缓存的更多信息，但我觉得最好的一篇是这里的一篇

[Mysql查询缓存](https://stackoverflow.com/questions/2095614/mysql-query-caching-limited-to-a-maximum-cache-size-of-128-mb)

上面的SO帖子可能会对您有所帮助

# android - 如何保护 XML 文件？

> ID：12713259
> 
> 赞同：2
> 
> 时间：2012-10-03T16:57:58.470
> 
> 标签：android, xml

我有一个从我的网络空间解析数据的应用程序。但如果你对我的应用程序进行逆向工程，任何人都可以找到我存储数据的位置。如何防止其他人访问我的 XML 文件。（我将所有文件路径存储在字符串文件中，所以 proguard 不会解决它），有没有办法将数据保存在工作区中，并且只有应用程序可以访问它`？还是有提供这种功能的服务？（注：我没有任何网络开发经验）

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:05:15.713

没有一个简单的方法可以做到这一点。您可以做几件事，例如密码保护您的目录（但密码必须存储在 apk 中）或使用 API 密钥（但同样，您需要将其存储在 apk 中）。

一种选择是通过某种复杂的算法动态构建字符串路径，从而使 proguard 混淆变得有用。但是，归根结底，您仍然容易受到数据包检查的影响（假设您没有使用 HTTPS）。您还可以构建在应用程序上运行并在服务器上运行的共享密钥生成器（基本上是一种基于时间生成看似随机密钥的算法）。然后将在运行时比较这些值，如果它们匹配，则将提供文件。同样，proguard 混淆将有助于弄清楚算法是如何工作的。

另一种选择是利用 Android 的私人空间。如果手机被扎根，你会感到很沮丧，但这会有所帮助。基本上遵循这个算法：

1.  安装后让应用程序生成一个唯一的 id
2.  将唯一 ID 发送到记录它并生成对称密钥的服务器
3.  将对称密钥存储在应用程序私有存储空间中
4.  每次发出请求时，都会随请求一起发送唯一 ID
5.  服务器从数据库中检索先前生成的密钥并使用它来加密正在服务的文件
6.  然后应用程序从应用程序私有存储空间中加载密钥并解密文件

# java - 初始容量如何影响 HashMap 的性能

> ID：12713260
> 
> 赞同：3
> 
> 时间：2012-10-03T16:58:03.593
> 
> 标签：java, performance, hashmap

[HashMap](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/HashMap.html)的文档包含以下语句：

> 因此，如果迭代性能很重要，则不要将初始容量设置得太高（或负载因子太低），这一点非常重要。

有人可以解释一下吗。我没有看到任何更改或影响 HashMap 的负载因子的方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:01:12.810

当您将 HashMap 声明为[构造函数](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/HashMap.html#HashMap%28int,%20float%29)参数的一部分时，您可以为其提供初始容量和负载因子：

```
 HashMap(int initialCapacity, float loadFactor) 
     Constructs an empty HashMap with the specified initial capacity and load factor. 
```

您还可以查看[此 SO 线程](https://stackoverflow.com/q/434989/827480)以了解有关负载因子和初始容量的一些见解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T17:14:57.387

太大的初始容量和太低的负载因子都会导致哈希表中的大多数条目是空的。虽然这降低了冲突的几率（从而提高了平均查找性能），但迭代哈希表的键/值/项需要跳过更多的空槽。

正如其他人所解释的，您可以在构造哈希表对象时给出负载因子和初始容量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:01:39.940

哈希表背后有很多理论，什么使给定输入集预测的“好”哈希表，我将从[Wikipedia 文章](http://en.wikipedia.org/wiki/Hash_table#Load_factor)开始（特别是在链接的“负载因子”部分）。

# java - 面对 Improsys Java API for AOL 的问题

> ID：12713264
> 
> 赞同：1
> 
> 时间：2012-10-03T16:58:28.183
> 
> 标签：java, api, aol, contact-list

我们一直在使用 Improsys java api 来导入联系人列表。它工作正常。从上个月开始，当我们尝试从 AOL 获取联系人列表并返回空的联系人列表时，我们遇到了这个 API 的问题。它适用于 gmail、hotmail 和 yahoo 等其他邮件。

使用最新的 jars，即使 gmail 也无法正常工作

# javascript - 无法在 chrome 中获取 flash 对象

> ID：12713275
> 
> 赞同：1
> 
> 时间：2012-10-03T16:59:56.760
> 
> 标签：javascript, google-chrome, flash

有没有办法像在 IE 中一样在 chrome 中获取 flash 对象引用？IE 的代码如下所示：

```
window[appName] 
```

它返回一个看起来像这样的对象

```
window[appName] 
{
    saveRecordFnc : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   },
    showMessageFnc : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   },
    saveImageToServerFnc : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   },
    saveTemplateToServerFnc : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   },
    openImageFnc : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   },
    setCanvasDimensionsFnc : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   },
    executeFunction : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   },
    start : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   },
    save : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   },
    exit : function () {      return eval(instance.CallFunction("<invoke name=\""+name+"\" returntype=\"javascript\">" + __flash__argumentsToXML(arguments,0) + "</invoke>"));   }
    ...
} 
```

window[appName] 和 document[appName] 在 chrome 中都返回 undefined。关于我做错了什么的任何想法？

**编辑** 这是我们使用的实际标签

```
<object type="application/x-shockwave-flash" data="clarkii.swf" width="100%" height="100%" id="myClarkii">
    <param name="movie" value="clarkii.swf" />
    <param name="bgcolor" value="#333333" />
    <param name="allowfullscreen" value="true" />
    <param name="allowscriptaccess" value="always" />
    <param name="flashvars" value="redirectUrl=saveConfirm.aspx&amp;StartupProject=<%= hdnTempFileName.Value %>&amp;FilePath=<%=System.Configuration.ConfigurationManager.AppSettings["CarkiiFilePath"] %>&amp;UploadScript=upload.aspx&amp;SnapshotScript=mySnapshot.aspx&amp;DataScript=myUpload_XML.aspx" />
    <a href="http://www.adobe.com/go/getflashplayer">
        <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="<%= Resources.bicweb_resources.GET_ADOBE_FLASH_PLAYER %>" />
    </a>
</object> 
```

# php - 禁用按钮在颜色框中不起作用

> ID：12713276
> 
> 赞同：1
> 
> 时间：2012-10-03T16:59:57.333
> 
> 标签：php, jquery, colorbox

我在颜色框中显示表单并通过 ajax 调用它。我想在点击后禁用提交按钮。我已通过 jquery 禁用它，它正在工作但没有提交表单值。请让我知道如何解决它。我正在使用以下代码。

```
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script> 
<script type="text/javascript">
  $(document).ready(function(){
        $(".submitonce").click(function(){
        $(".submitonce").attr('disabled','disabled');           
        });
           });
     </script>

      echo "<div id='".$divid."' style='display:none'>
    <div style='margin:10px 0px 0px 0px'    align='center'><h4>".$title."</h4></div>
    <div style='margin:30px 0px 0px 0px'><center></center></div>
     <div>".$description."</div>   
   <div style='margin:10px'>
    <center><form action='' name='theform3' method='post'>
    <input type='hidden' name='p-id' value='".$prodid."' />
  <input type='submit' name='oneclickorder' class='submitonce' 
    value='Confirm' style='size:20px' /></a>
  <input type='button' name='no1' value='Cancel' onclick='tb_remove()'/>
   </form></center></div>
    </div>"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:02:16.143

您只是没有打开表单标签。输入类型也应该是“提交”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:10:34.270

你解决了吗？似乎对我有用，如此[处所示](http://jsfiddle.net/6WpAL/)

我不确定，如果你的问题有完整的代码，但是你给出的，在`<script>`标签之后，它需要包含在`<form>`这样的标签中：

```
 <form>
 <div style='margin:10px 0px 0px 0px'    align='center'><h4>".$title."</h4></div>
<div style='margin:30px 0px 0px 0px'><center></center></div>
 <div>".$description."</div> 
```

编辑：说`<form id='main_form'>`

```
 $(document).ready(function(){
    $(".submitonce").click(function(){
    $('#main_form').submit();
    $(this).attr('disabled','disabled');           
    }); 
```

});​</p>

# javascript - 如果某些数组元素未定义，如何在对象数组中查找对象？

> ID：12713278
> 
> 赞同：0
> 
> 时间：2012-10-03T17:00:14.477
> 
> 标签：javascript, jquery

我有一个具有以下格式的对象数组：

```
obj = { ref: 8, id: "obj-8" } 
```

以及一个使用 jQuery 的*grep*方法通过搜索对象*ref*属性从该数组返回项目的函数：

```
function returnObj(arr,r){
    return $.grep(arr, function(elem,index){ return elem.ref == r; })[0];
} 
```

如果我在其中包含未定义元素的数组上使用此函数（它们之前已使用*delete*运算符删除），我会收到以下错误：*Uncaught TypeError: Cannot read property 'ref' of undefined*，我假设当遇到未定义的元素。

如何修改函数使其不会中断？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:01:59.477

只需检查当前项目是否为`undefined`，或者如果您期望特定对象则简单地“假”，如果是则返回`false`。

```
function returnObj(arr,r){
    return $.grep(arr, function(elem,index){ 
                           return elem ? elem.ref == r : false;
                       })[0];
} 
```

* * *

这是另一种选择。由于您`delete`用于删除项目，因此您可以使用本机`.filter`方法，该方法会跳过不存在的数组成员。

```
function returnObj(arr,r){
    return arr.filter(function(elem){ elem.ref == r})[0];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:02:56.477

只需检查它不是`undefined`：

```
function returnObj(arr,r){
    return $.grep(arr, function(elem,index){
        return elem ? elem.ref == r : false; 
    })[0];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:04:23.137

我相信您可以简单地为未定义添加一个测试：

```
return $.grep(arr, function(elem,index){ return elem != undefined && elem.ref == r; })[0]; 
```

但我不确定你为什么使用`$.grep`. 您可以使用现有的`Array.filter`来实现相同的结果：

```
function returnObj(arr,r){
    return arr.filter(function(ele,index){return ele && ele.ref == r;})[0];
} 
```

# database - 产品定制选项的数据库模型

> ID：12713281
> 
> 赞同：1
> 
> 时间：2012-10-03T17:00:25.297
> 
> 标签：database, database-design, model, database-schema

我正在设计一个电子商务，其中各种项目对每个产品都有不同的自定义选项，并且正在考虑构建我的数据库的最佳方法。例如，我可能想出售红色或白色以及不同尺寸的商品，但另一件商品可能只出售绿色或红色，没有尺寸选项。我有一堆我在下面概述的幼稚方法，但想知道是否有人有任何想法。我想保持这种关系，除非有充分的理由转向 NoSQL。

1.  **选项 1：**为每种类型的选项提供一个单独的表格。例如，一个表包含所有可能的颜色列表，另一个表使用颜色子集引用此表并且还与产品相关联。然后将有另一个表格来处理为添加到购物车的实际产品选择的颜色。
2.  **选项 2：**由于每个产品的选项数量很少，为什么不只使用一组包含每个可能选项的值的列。这基本上是产品表，其中包含一个名为“颜色”的文本列，然后仅列出可用的颜色选项。我个人不喜欢这个，因为它太受限制了——如果我想将图像与每种颜色相关联或根据选项更改定价怎么办？
3.  **选项 3：**前两者的组合，其中每个产品都有一组列，这些列将引用可用的自定义选项。例如，每个产品都有一个“颜色选项”列，如果不为空，该列将可用于该产品并指向一组结构良好的选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:55:21.527

**选项 4：**

有一个处理多个选项的选项表。

```
Option
------
Option ID
Item ID
Category ID
Category Text 
```

选项 ID 是一个自动递增的序列号。

项目 ID 是一个指向项目的整数。

类别 ID 是表示类别的整数。例如，颜色为 1，尺寸为 2。

类别文本是实际的颜色或大小。

**当且仅当**您不想搜索所有已售出的红色商品或所有已售出的 XL 商品时，此方法才有意义。

这种类型的数据设计称为[实体/属性数据模型](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T09:01:55.307

我会使用类似以下架构的东西：

**表“产品”**

```
Product id
Product name
Product base price 
```

**表“尺寸”**

```
Size ID
Size name
Additional price 
```

**表“颜色”**

```
Colour ID
Colour Name
Additional price 
```

**表'SaleItems'**

```
SaleItem ID
Product ID
Size ID
Colour ID 
```

客户会购买包含在“SaleItems”表中的商品。一个项目的例子是一件马球 T 恤，它有四种不同的尺寸和三种不同的颜色。这样，您将在 'SaleItems' 表中有 12 行，每行具有不同的特征，但能够知道销售了多少 Polo 衫、多少红色衬衫（销售了所有类型的产品）、多少 XL 商品， ETC。

您可能不需要价格字段，但基本款马球 T 恤的价格为 10 件；小号没有附加价格，而 XL 有 10% 的附加价格。大多数颜色的价格可能相同，但一些异国情调的颜色可能会贵 10%。一件这种异国情调的 XL polo T 恤将花费 10 * 1.1 * 1.1 = 12.1 个单位。

此模式假定所有产品都可以具有所有尺寸和颜色。

# sql - 如何将 SQL Server 作业名称传递给此作业中的存储过程？

> ID：12713283
> 
> 赞同：2
> 
> 时间：2012-10-03T17:00:29.733
> 
> 标签：sql, sql-server, tsql, token, sql-job

我有工作：

运行程序

它有以下步骤：

第 1 步：做某事
第 2 步：做其他事情
第 3 步：发送电子邮件

在第 3 步中，我有：

```
EXEC spSendSuccessEmail -- and here's where I want to pass the job name. 
```

这是上面存储过程的代码：

```
ALTER PROCEDURE [dbo].[spSendSuccessEmail] @JobName VARCHAR(30)
AS 
BEGIN
    SET NOCOUNT ON;

    DECLARE @EmailBody VARCHAR(50)

    SET @EmailBody = @JobName + ' ran successfully'

    BEGIN TRY
        EXEC msdb.dbo.sp_send_dbmail 
            @profile_name = 'DBTeam',
            @recipients = 'user@universe.com',
            @copy_recipients = 'user2@universe.com',
            @subject = 'Process Complete',
            @body = @EmailBody,
            @importance = 'Normal',
            @sensitivity = 'Normal';
    END TRY
    BEGIN CATCH
        EXEC spGetDatabaseErrorInfo
    END CATCH           
END 
```

如何将其所在作业的名称传递给此存储过程？

我阅读了令牌，但我对如何完成这项任务有点困惑。

谁能帮我一把？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T17:11:25.127

**更新** 我做了一些测试，对于某些版本的 SQL Server（2005 sp1 及更高版本），您必须转义令牌。我已将转义命令添加到下面的代码中。

$(JOBID) 是你要使用的[令牌，你可以从 msdb..sysjobs 查询找到作业名称。](http://msdn.microsoft.com/en-us/library/ms175575.aspx)

对于 sql server 2005 sp1 及更高版本：

```
declare @jobName varchar(100)

select @jobName = name from msdb..sysjobs where job_id = $(ESCAPE_NONE(JOBID))

exec spSendSuccessEamil @jobName 
```

对于 sql server 2005 及更早版本：

```
declare @jobName varchar(100)

select @jobName = name from msdb..sysjobs where job_id = $(JOBID)

exec spSendSuccessEamil @jobName 
```

只需在工作的第三步中使用其中之一作为命令文本。

# sql - 罗马数字作为数据库中的页码

> ID：12713286
> 
> 赞同：3
> 
> 时间：2012-10-03T17:00:38.527
> 
> 标签：sql, database-schema, roman-numerals

假设我有下表：

```
create table Section (
    id integer not null primary key,
    book_id integer not null foreign key references Book (id),
    title varchar(100) not null,
    page_start varchar(10) not null,
    page_end varchar(10) not null
    ... remaining fields ...
) 
```

请注意，起始页和结束页字段是 varchars。这样我就可以包含通常使用罗马数字的序言中的页码。

我的问题是：修改此表和编写应用程序的有效方法是什么：

*   我可以通过开始和结束页面正确地对部分进行排序，最好使用 SQL
*   我可以用页数计算一个部分的长度
*   我可以确定给定的页码（例如“xviii”或 475）是否在给定的部分内

请记住以下条件/事实：

*   我不希望用户必须输入任何附加信息。例如，他们不必计算前缀的阿拉伯语等值并将其输入。
*   任何可能存在的书籍预编号规则都被严格遵循（因此，例如，所有页码都将以正确的罗马或阿拉伯格式输入）
*   我可以添加我需要的任何其他字段，如果需要，甚至可以添加一个单独的表格
*   这是一个网络应用程序，因此我可以在插入或显示数据之前对数据库中的数据进行预处理或后处理
*   部分可以即时添加或删除，例如可能有一个介绍部分，然后稍后添加另一个部分。该书中所有部分的分页和排序应该保持正确。

我最终可能会在不同平台上用几种不同的语言实现它，因此首选与代码无关的伪代码。

# 澄清

因为我要处理成千上万条记录，所以我不能以编程方式遍历所有记录来执行排序之类的操作。所以有些工作需要在数据库端进行。

使用 njk 的查找表的想法，我们有类似的东西：

```
SELECT id, book_id, title, page_start, page_end, 
    COALESCE(RN_Lookup_End.value - RN_Lookup_Start.value + 1, CAST(page_end AS integer)-CAST(page_start AS integer) + 1) as number_of_pages
FROM
    Section 
    LEFT JOIN RN_Lookup AS RN_Lookup_Start ON Section.page_start=RN_Lookup_Start.key
    LEFT JOIN RN_Lookup AS RN_Lookup_End ON Section.page_end=RN_Lookup_End.key
ORDER BY
    book_id, 
    CASE WHEN RN_Lookup_Start.value IS NOT NULL
    THEN -1
    ELSE 0
    END, -- roman page numbers come before normal page numbers
    COALESCE(RN_Lookup_Start.value, page_start), COALESCE(RN_Lookup_End.value, page_end) 
```

如果我想遍历按页码排序的所有书籍。这看起来对吗？

考虑一下，我想知道对表格进行以下更改是否会更好：

```
create table Section (
    id integer not null primary key,
    book_id integer not null foreign key references Book (id),
    title varchar(100) not null,
    page_start integer not null,
    page_end integer not null,
    is_front_matter bit default 0,
    page_start_label varchar(10) null,
    page_end_label varchar(10) null
    ... remaining fields ...
) 
```

上面的查询如下所示：

```
SELECT id, book_id, title, 
    COALESCE(page_start_label, CAST(page_start as varchar)) as page_start,
    COALESCE(page_end_label, CAST(page_end as varchar)) as page_end,
    (page_end - page_start + 1) as number_of_pages
FROM
    Section 
ORDER BY
    book_id, is_front_matter DESC, page_start, page_end 
```

然后我所要做的就是在插入和更新时将值`page_start_label`从`page_end_label`罗马转换为阿拉伯语。两个额外的整数加上位意味着每条记录多出 8 个字节的额外存储空间，**但**大多数记录都留下了`page_start_label`空白，`page_end_label`我实际上可能会*节省*空间！

这听起来像是一个合理的解决方案吗？还是我错过了潜在的陷阱/不利因素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:20:21.937

虽然我通常会将演示细节留给演示层，但在这种情况下我同意@njk。

由于您将罗马数字作为传入数据的一部分，需要潜在地服务于多个前端和翻译，并且您希望能够轻松地在 SQL 中排序，我会预先计算一个罗马数字及其查找表整数等价于一些相当大的页码（也许是 32,767，尽管你知道你的数据）。

重申一下，我假设页码有一些合理的上限，并且您不会在需要包含数百万个值的查找表的地方转换任何内容。这足以说服我为此使用表示层中的代码。

那里似乎已经[有许多功能，](https://www.google.com/search?q=sql+roman+numerals+function&aq=0&oq=sql+roman&sugexp=chrome,mod=0&sourceid=chrome&ie=UTF-8#hl=en&sclient=psy-ab&q=sql+roman+numerals&oq=sql+roman+numerals&gs_l=serp.3..0j0i30j0i5i30j0i8i30.34111.34111.0.34225.1.1.0.0.0.0.95.95.1.1.0.les%3Bepsugrpq2..0.0...1.1.49ADyYRBAr8&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&fp=5936a6d8fe4522bb&biw=1920&bih=989)因此您不必重新发明轮子来创建此表。

即使您将来转向不同的方案，使用罗马数字传入数据的想法意味着您可能总是需要这种类型的表才能导入书籍/章节。

# python - 使用隐藏所有窗口的子进程启动程序

> ID：12713289
> 
> 赞同：0
> 
> 时间：2012-10-03T17:00:59.583
> 
> 标签：python, windows, subprocess

我在 Windows 上使用子进程来启动 IrfanView 以使用命令行开关将 TIFF 文件转换为 PDF。

我正在处理几个 TIFF 文件夹，并为每个文件调用命令。保存 PDF 时，IrfanView 会显示一个标题为“保存 PDF”的对话框以显示进度。

该对话框仅显示片刻，但会抓住窗口焦点，因此当我的脚本在后台运行时无法使用计算机。我尝试使用`subprocess.STARTUPINFO`值来隐藏窗口，虽然现在隐藏了对话框，但它似乎仍然抓住了焦点。

下面是我调用 IrfanView 应用程序的方式。

```
startup_info = subprocess.STARTUPINFO
startup_info.dwFlags = 1
startup_info.wShowWindow = 0

subprocess.call(['i_view32.exe', 'c:/input.tif', '/convert=c:/output.pdf'], startupinfo=startup_info) 
```

有谁知道启动应用程序的方法，它的窗口被隐藏并且不窃取焦点？我很乐意尝试一些事情——如果存在这样的程序，即使是随后调用 IrfanView 的包装应用程序也会这样做。我只在 Windows 上需要这个，所以我不需要跨平台的解决方案。

我知道我也可以使用 GraphicsMagick 或类似的东西，但是 IrfanView 在匹配输入文件的压缩格式方面做得更好，所以理想情况下我想使用 IrfanView 让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:22:49.557

这将取决于支持非交互模式的应用程序。 `subprocess`可以阻止调用在启动应用程序时打开控制台窗口，但不能阻止应用程序本身打开窗口。

谷歌搜索 irfanview 返回[一篇](http://www.makeuseof.com/tag/10-useful-commandline-irfanview-tools-working-images/)描述“隐藏”命令行选项的文章 - hide=15 可能会做你想做的事，但有可能泄露一堆不可见的僵尸窗口。该程序显然没有真正的 /batch 选项，它首先会避免打开对话框或其他窗口。

# objective-c - UIStoryboard - OutletCollection

> ID：12713293
> 
> 赞同：1
> 
> 时间：2012-10-03T17:01:13.430
> 
> 标签：objective-c, ios, xcode, uibutton, storyboard

我正在使用 nib 文件来构建用户界面，但现在我切换到故事板并发现了一个问题。

在 nib 文件中，我部署了 10 个按钮，我曾经参与按钮 -`IBOutletCollection (UIButton *) NSArray` 第一个按钮的值为 0，第二个为 2，依此类推（在 中`OutletCollection Array`）。

但是使用 UIStoryBoard 按钮是随机放置的。

有谁知道如何解决这个问题？

谢谢您的回答 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T14:44:20.630

我为解决这个问题所做的是设置我添加到我的 outletcollection 的 UIViews 的标签，然后将它添加到我的 viewDidLoad ...

```
NSComparator compareTags = ^(id a, id b) {
                    NSInteger aTag = [a tag];
                    NSInteger bTag = [b tag];
                    return aTag < bTag ? NSOrderedAscending
                    : aTag > bTag ? NSOrderedDescending
                    : NSOrderedSame;
                };

self.UIViewCollection = [self.UIViewCollection sortedArrayUsingComparator:compareTags]; 
```

现在我的 UIViews 订购了 1-20。出口集合只是一个对象数组。

# php - 包含不存在链接 rel 的 .css 页面是否有任何错误消息或处罚？

> ID：12713299
> 
> 赞同：0
> 
> 时间：2012-10-03T17:01:34.240
> 
> 标签：php, css

我正在使用一个实时 Joomla 站点，我想在模板中包含一个 page_title.css，但我想知道即使样式表不存在，我是否可以只包含链接，而不会出现错误消息或搜索引擎惩罚。

```
<link rel="stylesheet" type="text/css" href="page_title.css" /> 
```

如果 page_title.css 不存在就不会有任何问题，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:05:39.077

搜索引擎通常不会关心 CSS（或 js）文件等，所以那里不应该有“惩罚”。

在您的 Web 服务器上，对不存在的 CSS 文件的请求将出现 404 错误。这些可能会累积成一个相当重要的统计数据。对于像我这样的人，这会打扰我，但也许你并不在乎。

（根据[ernie](https://stackoverflow.com/users/759517/ernie)添加的评论，请注意，还有一些与这些 404 请求/响应相关的服务器负载）

至于浏览器，它会尝试加载一个不存在的 CSS 文件，但没有浏览器会弹出任何错误消息或任何类似的东西。不过，您的其余样式将被正确应用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:07:33.680

也许您可以检查它是否存在，如果[存在](http://www.w3schools.com/php/func_filesystem_file_exists.asp)则包含它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:04:55.447

它真的取决于浏览器如何处理这种情况。大多数现代的不会受到采购不存在的 CSS 或 JS 文件的影响。但是，我无法谈论您问题的 SEO 方面。

包含不存在的文件仍然不是一个好习惯。

# dojo - 获取dojo NodeList内部元素的值

> ID：12713306
> 
> 赞同：1
> 
> 时间：2012-10-03T17:02:01.677
> 
> 标签：dojo, innerhtml, nodelist

我正在使用 dojo 构建一个配置对话框，稍后我需要询问用户输入。对话框中有多行，每行具有相同的格式和标签。这是我用来构建每一行的 html。

```
html = '<div class="cfgtxtrow"> <label>Label:</label>
<input id="mac" type="hidden" name="mac" value="'+mac+'"/>
<input id="label" type="text" maxlength="6" name="label" value="'+labl+'"/>
</div>'; 
```

这部分一切正常，我可以在返回时看到 Firebug 中的数据。

我需要解析出这些值并最终使用 xhr 将它们发送到服务器。所以我认为我可以使用 dojo 查询来获取节点列表并遍历每个节点以获取输入值并构建它们的关联数组以发送。我认为这很像以编程方式验证值。

我可以在每个节点上看到 innerhtml（使用 dojo.query(".cfgtxtrow").forEach(function(node)) 但无法弄清楚如何以编程方式（使用 dojo）获取每个节点上的值。我以为我将能够使用 dojo.byId 或在 Nodelist 上查询来获取其内部元素，但我只是得到错误。

我开始怀疑我的概念都是错误的，因为我认为这很简单。

这是我最终得到的..

```
dojo.query(".cfgtxtrow input").forEach( function(node)
{
    id = dojo.attr(node, "id" );
    console.debug( node );

    if( id == "mac" ) mac = dojo.attr( node, "value" ); // since mac comes first this is safe..
    if( id == "label" )
    {
        labl = dojo.attr( node, "value" );
        console.debug( mac );
        console.debug( labl );
        macLabels[mac] = labl;
    }
});
console.debug(macLabels[mac]);
// send the data via the xhrPut call.. 
```

我认为它应该很简单，并且 dojo.attr 调用似乎可以完成这项工作..

有没有更好的方法来做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T01:38:58.480

首先，您不应该使用 id 属性来标识多行。一个 html 文档中只能有一个具有特定 id 的 dom 节点。也许这就是你问题的开始？

所以如果你改变你的html如下：

```
<div class="cfgtxtrow"> <label>Label:</label>
<input class="mac" type="hidden" name="mac" value="macValue"/>
<input class="label" type="text" maxlength="6" name="label" value="labelValue"/>
</div>​ 
```

在上面运行这个（快速而肮脏的）代码

```
​require(['dojo/query'],function(query) {
    var macLabels = {};
    query('.cfgtxtrow').forEach(function(row) {
        var mac = query('.mac', row)[0].value;
        var label = query('.label', row)[0].value;
        macLabels[mac] = label;
    });
    console.log(macLabels);
});​​​​​​​​​ 
```

将在控制台日志上输出此对象：{macValue: "labelValue"}

# c# - 将我的服务器升级到 Windows Server 2012 / VS 2012 / IIS 8.0 后，PUT 不再工作

> ID：12713310
> 
> 赞同：1
> 
> 时间：2012-10-03T17:02:20.593
> 
> 标签：c#, visual-studio-2012, servicestack, iis-8

将工作站升级到 Windows Server 2012 / VS 2012 并将现有的 ServiceStack 服务重新部署到 IIS 8 后，PUT 开始返回 405？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:02:20.593

要让 PUT 在 Windows Server 2012 和 IIS8 中再次工作，您需要从 IIS 中删除 WebDav Publishing。

# java - 写入 MediaWiki：对等方重置连接

> ID：12713311
> 
> 赞同：1
> 
> 时间：2012-10-03T17:02:21.750
> 
> 标签：java, http, post, mediawiki, apache-httpclient-4.x

我已经编写了一些代码来在 MediaWiki 服务器（特别是 wikia.com）上读写文章。我能够获得编辑令牌并阅读文章，没问题。但是当我尝试写一篇文章时，我收到以下错误：

```
java.net.SocketException: Connection reset by peer: socket write error
at java.net.SocketOutputStream.socketWrite0(Native Method)
at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:109)
at java.net.SocketOutputStream.write(SocketOutputStream.java:153)
at org.apache.http.impl.io.AbstractSessionOutputBuffer.flushBuffer(AbstractSessionOutputBuffer.java:106)
at org.apache.http.impl.io.AbstractSessionOutputBuffer.writeLine(AbstractSessionOutputBuffer.java:198)
at org.apache.http.impl.io.HttpRequestWriter.writeHeadLine(HttpRequestWriter.java:61)
at org.apache.http.impl.io.AbstractMessageWriter.write(AbstractMessageWriter.java:93)
at org.apache.http.impl.AbstractHttpClientConnection.sendRequestHeader(AbstractHttpClientConnection.java:240)
at org.apache.http.impl.conn.DefaultClientConnection.sendRequestHeader(DefaultClientConnection.java:252)
at org.apache.http.impl.conn.AbstractClientConnAdapter.sendRequestHeader(AbstractClientConnAdapter.java:227)
at org.apache.http.protocol.HttpRequestExecutor.doSendRequest(HttpRequestExecutor.java:213)
at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:124)
at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:483)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:641)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:576)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:554)
at com.walkertribe.niftybot.wiki.MediaWiki.loadXML(MediaWiki.java:350)
... 3 more 
```

下面是尝试编写文章的代码的简化版本。我正在使用[Apache HttpClient](http://hc.apache.org/httpcomponents-client-ga/index.html)向服务器发出请求。Page 类是一个 POJO，除其他外，它提供文章的标题和最后修订时间。URIBuilder 类是用于构建 URL 的便利类。

```
public void savePage(Page page, String content, String summary) {
    if (_token == null) {
        throw new IllegalStateException("No edit token received");
    }

    String md5;

    try {
        md5 = Util.md5(content);
    } catch (UnsupportedEncodingException | NoSuchAlgorithmException ex) {
        throw new RuntimeException(ex);
    }

    URIBuilder b = _config.buildURIBuilder()
            .addQueryParam("title", page.getTitle())
            .addQueryParam("text", content)
            .addQueryParam("summary", summary)
            .addQueryParam("bot", null)
            .addQueryParam("basetimestamp", page.getLastRevision())
            .addQueryParam("watchlist", "nochange")
            .addQueryParam("md5", md5)
            .addQueryParam("token", _token)
            .addQueryParam("starttimestamp", _timestamp);
    URI uri = b.toURI();
    Document doc = loadXML(uri, HttpMethod.POST);
    /* do stuff with the returned document */
}

private Document loadXML(URI uri, HttpMethod method) throws WikiException {
    HttpRequestBase requestBase = method.getMethod(uri);
    HttpResponse response;

    try {
        response = client.execute(requestBase);
    } catch (ClientProtocolException ex | IOException ex) {
        throw new WikiException(ex);
    }

    HttpEntity entity = response.getEntity();

    if (entity == null) {
        throw new WikiException("No content found: " + uri);
    }

    try (InputStream content = entity.getContent()) {
        // do something with the content
    } catch (IllegalStateException | IOException ex) {
        throw new WikiException(ex);
    }

    return doc;
}

private enum HttpMethod {
    GET {
        @Override
        public HttpRequestBase getMethod(URI uri) {
            return new HttpGet(uri);
        }
    },
    POST {
        @Override
        public HttpRequestBase getMethod(URI uri) {
            return new HttpPost(uri);
        }
    };

    abstract HttpRequestBase getMethod(URI uri); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T19:22:47.340

弄清楚了。当提交的文本很大时，您必须使用 MultipartEntity 进行 post 操作。给定名为 params 的参数 NameValuePair 列表和要发布到的 URI：

```
HttpPost post = new HttpPost(uri);
MultipartEntity entity = new MultipartEntity();

for (NameValuePair param : params) {
    entity.addPart(param.getName(), new StringBody(param.getValue()));
}

post.setEntity(entity);

try {
    HttpResponse response = client.execute(post);
    // do something with the response
} catch (ClientProtocolException ex | IOException ex) {
    // deal with exception
} 
```

# iphone - 键盘在 UIScrollView 中隐藏文本字段。如何根据键盘移动文本字段？

> ID：12713317
> 
> 赞同：1
> 
> 时间：2012-10-03T17:02:38.620
> 
> 标签：iphone, objective-c, ios, xcode

我正在开发一个有 15 个文本字段的应用程序。所以我使用 UIScrollView 使滚动成为可能。但是当单击这些文本字段进行编辑时，我的最后五个文本字段隐藏在键盘后面。一旦它们处于编辑模式，如何将这些文本字段移动到键盘上方？同样，它们的文本字段位于 UIScrollView 上。不是 UIView。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:10:34.737

尝试[TPKeyboardAvoidingScrollView](https://github.com/michaeltyson/TPKeyboardAvoiding)。

只需抓住您已有的滚动视图并将其类更改为`TPKeyboardAvoidingScrollView`，现在当键盘弹出时，它将调整其大小和偏移量，以便正确显示字段。

我建议这样做，因为当您有复杂的布局（许多文本字段和其他组件）时，手动执行此操作可能会很棘手。这个控件非常简单，并且工作起来就像一个魅力！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:56:07.960

这是一些示例代码：

```
#define kOFFSET_FOR_KEYBOARD 80.0

-(void)keyboardWillShow {
    // Animate the current view out of the way
    if (self.view.frame.origin.y >= 0)
    {
        [self setViewMovedUp:YES];
    }
    else if (self.view.frame.origin.y < 0)
    {
        [self setViewMovedUp:NO];
    }
}

-(void)keyboardWillHide {
    if (self.view.frame.origin.y >= 0)
    {
        [self setViewMovedUp:YES];
    }
    else if (self.view.frame.origin.y < 0)
    {
        [self setViewMovedUp:NO];
    }
}

-(void)textFieldDidBeginEditing:(UITextField *)sender
{
    if ([sender isEqual:mailTf])
    {
        //move the main view, so that the keyboard does not hide it.
        if  (self.view.frame.origin.y >= 0)
        {
            [self setViewMovedUp:YES];
        }
    }
}

//method to move the view up/down whenever the keyboard is shown/dismissed
-(void)setViewMovedUp:(BOOL)movedUp
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3]; // if you want to slide up the view

    CGRect rect = self.view.frame;
    if (movedUp)
    {
        // 1\. move the view's origin up so that the text field that will be hidden come above the keyboard 
        // 2\. increase the size of the view so that the area behind the keyboard is covered up.
        rect.origin.y -= kOFFSET_FOR_KEYBOARD;
        rect.size.height += kOFFSET_FOR_KEYBOARD;
    }
    else
    {
        // revert back to the normal state.
        rect.origin.y += kOFFSET_FOR_KEYBOARD;
        rect.size.height -= kOFFSET_FOR_KEYBOARD;
    }
    self.view.frame = rect;

    [UIView commitAnimations];
}

- (void)viewWillAppear:(BOOL)animated
{
    // register for keyboard notifications
    [[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(keyboardWillShow)
                                             name:UIKeyboardWillShowNotification
                                           object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(keyboardWillHide)
                                             name:UIKeyboardWillHideNotification
                                           object:nil];
}

- (void)viewWillDisappear:(BOOL)animated
{
    // unregister for keyboard notifications while not visible.
    [[NSNotificationCenter defaultCenter] removeObserver:self
                                             name:UIKeyboardWillShowNotification
                                           object:nil];

    [[NSNotificationCenter defaultCenter] removeObserver:self
                                             name:UIKeyboardWillHideNotification
                                           object:nil];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:19:53.813

你可以减少你的`scrollView` **Y**坐标`textFieldShouldBeginEditing:`

```
-(BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
   if(textField == textField11 || textField == textField12 || textField == textField13 || textField == textField14 || textField == textField15)
   {   
       [UIView beginAnimations:nil context:NULL];
       [UIView setAnimationDuration:0.3];
       //set Y according to keyBoard height
       [scrollView setFrame:CGRectMake(0.0,-220.0,320.0,460.0)];
       [UIView commitAnimations];
   }
} 
```

**并按键盘的返回**键设置`scrollView`框架

 **```
-(BOOL)textFieldShouldReturn:(UITextField *)textField
{
    [textField resignFirstResponder];
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];
    [scrollView setFrame:CGRectMake(0.0,0.0,320.0,460.0)];
    [UIView commitAnimations];   
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T17:06:00.473

您需要在 scrollView 上相应地设置 contentSize 和 contentOffset。因此，如果您的最后一个文本框的原点为 (0,300)，您可能希望 contentSize 为 CGSizeMake(0, 600) 左右，然后将 contentOffset 设置为 (0, 250)。**

# jquery - Jquery PathName 正则表达式改变背景

> ID：12713318
> 
> 赞同：1
> 
> 时间：2012-10-03T17:02:39.307
> 
> 标签：jquery, regex, path

我刚开始学习jquery，我想知道我是否做得对。这是我的代码

```
 var images = ['1.jpg', '2.jpg', '3.jpg', '4.jpg', '5.jpg','6.jpg', '7.jpg', '8.jpg', '9.jpg'];
if (window.location == 'http://localhost:81/ci/login') {
    $('body').css('background-image', 'url("public/images/login_4.jpg")');
} else if(window.location == 'http://localhost:81/ci/index.php/login') {
    $('body').css('background-image', 'url("../public/images/login_4.jpg")');
}else {
    $('body').css({'background-image': 'url(public/images/' + images[Math.floor(Math.random() * images.length)] + ')'});
} 
```

第一个块所做的是检查位置是否与给定的字符串相同，问题是如果 url 看起来像这样 `http://localhost:81/ci/login?`或`http://localhost:81/ci/login#`

代码失败......我知道有一个正则表达式解决方案。小伙伴们怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:04:38.143

你不需要任何正则表达式，你可以使用`indexOf()`

```
if(window.location.href.indexOf('http://localhost:81/ci/login') != -1)
{....}
else if(window.location.href.indexOf('http://localhost:81/ci/index.php/login' != -1)
{....} 
```

或者更好的是，将它们组合在一起以获得更便携的代码：

```
if(window.location.href.indexOf('login') != -1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:08:53.803

RegEx 效率低下，对于像这样的简单情况应避免使用。

试试这个：

```
if (window.location.href.indexOf('http://localhost:81/ci/login') == 0) {
     ...
} ... 
```

如果您坚持使用正则表达式（当然是开始学习的便捷工具），您可以这样做：

```
if (/^http:\/\/localhost:81\/ci\/login/.test(window.location.href)) {
     ...
} ... 
```

插入符号 ^ 符号标记匹配字符串的开始 - 没有它，即使模式出现在字符串中间，这个测试也是正确的。由于斜线标记正则表达式的开始和结束，因此必须转义模式中的所有斜线。

# java - Google 协作平台中的 Java 小程序和“不兼容的幻数”错误

> ID：12713320
> 
> 赞同：1
> 
> 时间：2012-10-03T17:02:43.563
> 
> 标签：java, applet, google-sites

我已经看到很多关于这个主题的问题，但没有一个能回答我的具体情况。我已经完成了要嵌入到 Google 协作平台网站上的 Java 小程序。我已将整个小程序打包在一个 .jar 文件中，将其作为一般附件上传到站点，并使用 CodeWrapper 小部件将其链接到页面，方法是插入代码库和存档的正确值（基本上，我选择了附件的下载链接并将其分成两部分：“代码库”的路径和“存档”的文件名）。但是，我得到一个：

```
Incompatible magic value 1008813135 in class file *my class file* 
```

尝试运行时出错。这个数字似乎对应于 ASCII `<!DO`，因此使许多人认为它实际上代表 XML 文档的开头，并且这是一个 404: file not found 错误，我得到了。我认为这可能与 Google Sites 的结构有关，并尝试将 .jar 文件上传到我的 Public Dropbox 文件夹中。事实上，通过执行与上述相同的操作（在“codebase”和“archive”之间分割路径和文件名），它工作得非常好！所以我确信问题确实出在 Google 协作平台上。现在我将使用 Dropbox 解决方案，但这并不是我真正想要依赖的东西；如果我可以将文件嵌入到网站中，我会感觉好多了。有人对此有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T06:07:13.970

在 Google 协作平台上托管 .jar 文件会产生 googlegroups.com 的缓存效果。我现在不能说*为什么*会这样，但是如果你将跟踪级别设置为 5，你可以在 Java 控制台中看到它的证据。

对于我拥有的一些小程序，这没有问题。但是，我遇到`getSoundClip`了在我的小程序中无法弄清楚的安全异常。当我将它托管在我的 ISP 设置的站点上时，它总是有效。我注意到来自某种缓存的奇怪 googlegroups.com URL 出现在控制台中。如果我没记错的话，默认控制台设置不显示缓存。

将 .jar 文件上传到 code.google.com（并设置代码库等）没有任何缓存（我可以看到），并且我的`getSoundClip`调用没有安全异常。

*在 Google 协作平台上适用*于我的小程序控制台的以下摘录中，您可以看到**sites.google.com**上的 URL 示例及其在**bab6424e-a-62cb3a1a-s-sites.googlegroups.com**中的相应缓存. 注意：我将 URL 中的真实路径替换为，`X/Y`并将 jarfile 替换为`Z.jar`

```
...
基本：添加进度监听器：sun.plugin.util.ProgressMonitorAdapter@bc71bd
基本：为 https://sites.google.com/site/X/Y/Z.jar 调用 Plugin2ClassLoader.addURL 父级
安全性：在 Mozilla 用户配置文件中访问密钥和证书：null
安全性：未配置 JSS
安全性：启用黑名单撤销检查
安全性：已启用受信任库列表检查
cache: Adding MemoryCache entry: https://bab6424e-a-62cb3a1a-s-sites.googlegroups.com/site/X/Y/Z.jar?attachauth=ANoY7cpwDuO2zcBBImZ-rJvrPReeiY0EyL874NTY538mtqnsfd-A6p4uVsSKbeO0jcW336bRzkmqoJSiKk3MgG6dxISu6iXodhaXlmyxEaZ2sZ8sSkEkABSMu89vHzugUVfF2m31qp3N5RFe5QSqVMoY2vMjf7HAjLVmObNEmp7J83khcV1jepHpudfPZXhYeXD89Bv6XbBaePhwoueUZT9ZPEwNvepaKwGIr2IsActrdYOtrjiRScAzyp2dr9EwhnZXXIv6KsKv&attredirects=0
网络：找到缓存条目 [url：https://sites.google.com/site/X/Y/Z.jar，版本：null] prevalidated=false/0
缓存：添加 MemoryCache 条目：https://sites.google.com/site/X/Y/Z.jar
...
```

# android - 如果知道关联的值，我可以从 SharedPreferences 获取密钥吗？

> ID：12713321
> 
> 赞同：3
> 
> 时间：2012-10-03T17:02:51.810
> 
> 标签：android, sharedpreferences, key-value

如果我知道与之配对的“值”值，是否可以从 SharedPreferences 文件中获取“键”值？

假设我进入了 SharedPreferences 文件，并通过用户操作获得了值“London, UK”。

现在我想获取与“伦敦，英国”值关联的 KEY，然后将其用于下一步，这可能吗？

我现在使用的代码从 SharedPerferences 中获取所有数据，按值排序，用这些数据填充 AlertDialog，处理用户从 AlertDialog 中选择一个选项，然后返回该选项的值。我现在需要与值配对的 KEY。

```
public void openServerDialog() {

        final SharedPreferences myPrefs = this.getSharedPreferences("FileName", MODE_PRIVATE);
        TreeMap<String, ?> keys = new TreeMap<String, Object>(myPrefs.getAll());
        for (Map.Entry<String, ?> entry : keys.entrySet()) {
            Log.i("map values", entry.getKey());
            //some code
        }

      List<Pair<Object, String>> sortedByValue = new LinkedList<Pair<Object,String>>();
        for (Map.Entry<String, ?> entry : keys.entrySet()) {
            Pair<Object, String> e = new Pair<Object, String>(entry.getValue(), entry.getKey());
            sortedByValue.add(e);
        }

     // Pair doesn't have a comparator, so you're going to need to write one.
        Collections.sort(sortedByValue, new Comparator<Pair<Object, String>>() {
            public int compare(Pair<Object, String> lhs, Pair<Object, String> rhs) {

                String sls = String.valueOf(lhs.first);
                String srs = String.valueOf(rhs.first);
                int res = sls.compareTo(srs);
                // Sort on value first, key second
                return res == 0 ? lhs.second.compareTo(rhs.second) : res;
            }
        });

        for (Pair<Object, String> pair : sortedByValue) {
            Log.i("map values", pair.first + "/" + pair.second);
        }

      Collection<?> stringArrayList = keys.values();
      final CharSequence[] prefsCharSequence = stringArrayList.toArray(new CharSequence[stringArrayList.size()]);

        new AlertDialog.Builder(this)   
        .setTitle(R.string.server_title)
        .setItems(prefsCharSequence, 
        new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialoginterface, int i) {

                setServer(prefsCharSequence[i]);   

            }
        })
        .show();
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T17:09:34.800

您可以使用该`SharedPreferences.getAll`方法。

```
String findKey(SharedPreferences sharedPreferences, String value) {
    for (Map.Entry<String, ?> entry: sharedPreferences.getAll().entrySet()) {
        if (value.equals(entry.getValue())) {
            return entry.getKey();
        }
    }
    return null; // not found
} 
```

您应该注意，虽然键在 SharedPreferences 中保证是唯一的，但不能保证值是唯一的。因此，此函数将仅返回第一个匹配值的键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:08:32.847

你可以试试：

```
SharedPreferences prefs = context.getSharedPreferences(context.getPackageName(), 0);

Iterator iter = prefs.getAll().entrySet().iterator();
    while (iter.hasNext()) {
        Map.Entry pair = (Map.Entry)iter.next();
       // Check the value here
    } 
```

您可以遍历该映射并查找所需的值。

# c# - 使用 LINQ 搜索二进制字段

> ID：12713325
> 
> 赞同：2
> 
> 时间：2012-10-03T17:03:02.980
> 
> 标签：c#, linq

我有一个包含 14 字节数据的二进制字段（称为“bin”）的表。我想对该字段进行搜索，如下所示：

```
from row in db.users where row.bin.SequenceEqual(data) select row 
```

“数据”变量的类型是字节[]。但是当我运行“q.Count()”时，我遇到了以下错误：

```
LINQ to Entities 无法识别方法“Boolean SequenceEqual[Byte]”
(System.Collections.Generic.IEnumerable`1[System.Byte],
System.Collections.Generic.IEnumerable`1[System.Byte])' 方法，
而且这个方法不能翻译成商店表达式。

```

如何检索匹配二进制数据的计数？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:31:40.727

如果您拥有数据模型，并且您的二进制数据是小的固定大小的字节数组，您可以将 SQL 数据类型从 更改`binary(14)`为`char(21)`，[`Convert.ToBase64String`](http://msdn.microsoft.com/en-us/library/dhx0d524.aspx)在进入数据库的途中使用，并[`Convert.FromBase64String`](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx)在退出时使用。

切换到字符串将使您的数据可搜索：只需将您的搜索编码`data`为 base64 字符串，并`==`在搜索条件中使用运算符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:06:20.950

你不能。实体框架不支持使用二进制字段进行操作。

# android - 什么是根视图？

> ID：12713327
> 
> 赞同：2
> 
> 时间：2012-10-03T17:03:15.807
> 
> 标签：android

我需要将根视图传递给函数以显示弹出窗口

```
instructions_popup_window.showAtLocation( "parent view", Gravity.CENTER, 0, 0); 
```

问题是放什么`"parent view"`。

在`onCreate`我有

```
setContentView(R.layout.splash); 
```

我的根本观点也是如此：`"R.layout.splash"`还是`"findViewById(R.layout.splash)"`其他什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:06:23.063

根视图是初始布局中最顶层的视图。

您可以给它一个 ID，然后给它`findviewbyid`，或者您可以使用此函数获取活动的根视图：

```
getWindow().getDecorView() 
```

# php - PHP mkdir 失败

> ID：12713332
> 
> 赞同：2
> 
> 时间：2012-10-03T17:03:36.123
> 
> 标签：php, html, file, file-upload, upload

我正在尝试上传文件，所以这是我的 html：

```
<form action="upload_file.php" method="post" enctype="multipart/form-data">
    Select a file: <input type="file" name="upload">
    <input type="submit">
</form> 
```

这是我的php：

```
 <?php
    ini_set('display_errors', 'On');
    error_reporting(E_ALL | E_STRICT);
    session_start();
    $allowedExts = array("doc", "docx");
    $extension = pathinfo( $_FILES["upload"]["name"],PATHINFO_EXTENSION);

    if (($_FILES["upload"]["size"] < 200000)
    && in_array($extension, $allowedExts)) {
        if ($_FILES["upload"]["error"] > 0)
        {
            echo "Return Code: " . $_FILES["upload"]["error"] . "<br />";
        }
        else
        {
            echo "Upload: " . $_FILES["upload"]["name"] . "<br />";
            echo "Type: " . $_FILES["upload"]["type"] . "<br />";
            echo "Size: " . ($_FILES["upload"]["size"] / 1024) . " Kb<br />";
            echo "Temp file: " . $_FILES["upload"]["tmp_name"] . "<br />";

            $dir_exists = is_dir("Proposals/". $_SESSION["FirstName"] ."/");
            $file_exists = file_exists("Proposals/".$_SESSION["FirstName"] ."/" . $_FILES["upload"]["name"]);
            $folderName=$_SESSION["FirstName"];
            $baseDir = "Proposals" ;
            //var_dump($_FILES);
            //die();
            // Create directory if it does not exist
            if (! $dir_exists) {
                if(!is_dir($baseDir))
                    mkdir($baseDir);
                mkdir($baseDir . DIRECTORY_SEPARATOR . $_SESSION["FirstName"]);
            } 

            if ($file_exists) {
                echo $_FILES["upload"]["name"] . " already exists. ";
            } else {
                move_uploaded_file($_FILES["upload"]["tmp_name"],
                "Proposals/". $_SESSION["FirstName"] ."/". $_FILES["upload"]["name"]);
                echo "Stored in: " . "Proposals/". $_SESSION["FirstName"] ."/". $_FILES["upload"]["name"];
            }
        }
    } else {
        echo "Invalid file";
    }

?> 
```

文件输出：

```
Type: application/msword
Size: 124.9296875 Kb
Temp file: /tmp/phpUWDc3s 
```

var_dump 在测试文件中输出了这个：

```
array(1) { ["upload"]=> array(5) { 
["name"]=> string(18) "Test.doc" 
["type"]=> string(18) "application/msword" 
["tmp_name"]=> string(14) "/tmp/phpUWDc3s" 
["error"]=> int(0) 
["size"]=> int(127928) } } 
```

它给我的警告/错误是：

```
Strict Standards: Only variables should be passed by reference in /disks/vhosts/***/***/upload_file.php on line 6 Upload: Test.doc 
```

没有它给我的 mkdir 代码：

```
Warning: move_uploaded_file(Proposals/Test.doc): failed to open stream: Permission denied in /disks/vhosts/***/***/upload_file.php on line 40 Warning: move_uploaded_file(): Unable to move '/tmp/phpQmgxdO' to 'Proposals/Test.doc' in /disks/vhosts/***/***/upload_file.php on line 40 Stored in: Proposals/Test.doc 
```

出于某种原因，无论是否使用 mkdir，提案文件中都没有放入任何文件，即使它是正确的文件类型。这只是服务器的权限问题，还是我必须添加/更改才能使这一切正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:08:24.473

A. 第一个错误

> 严格的标准：只有变量应该在/disks/vhosts///upload_file.php第6行通过引用传递***上传***：Test.doc

改变

```
 $extension = end(explode(".", $_FILES["upload"]["name"])); 
```

到

```
 $extension = path_info( $_FILES["upload"]["name"],PATHINFO_EXTENSION); 
```

B、第二个错误

> 警告：move_uploaded_file(Proposals/Test.doc)：打开流失败：第 40 行 /disks/vhosts/ /upload_file.php 中的权限被拒绝***警告***：move_uploaded_file()：无法将“/tmp/phpQmgxdO”移动到“提案” /Test.doc' in /disks/vhosts/ ***/*** /upload_file.php on line 40 存储在：Proposals/Test.doc

在完整路径中使用类似的东西`/disks/vhosts/***/***/`

```
$baseDir = __DIR__ ; // or /disks/vhosts/***/***/ has applicable 
if (! $dir_exists) {
    if (is_writable("$baseDir/Proposals/")) {
        mkdir("$baseDir/Proposals/" . $_SESSION["FirstName"]);
    } else {
        trigger_error("Proposals/ is not writeable");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:16:57.120

您目前有此代码...

```
if(!$dir_exists) {
    mkdir("Proposals/". $_SESSION["FirstName"]);
} elseif ($file_exists) {
    echo $_FILES["upload"]["name"] . " already exists. ";
} else {
    move_uploaded_file($_FILES["upload"]["tmp_name"],
    "Proposals/". $_SESSION["FirstName"] ."/". $_FILES["upload"]["name"]);
    echo "Stored in: " . "Proposals/". $_SESSION["FirstName"] ."/". $_FILES["upload"]["name"];
} 
```

仅`move_uploaded_file`当您要查找的目录存在时。将该行移到您的`if`语句下方，然后它应该在需要时创建目录，然后上传文件。

# c# - 访问控制器中的表单值，我正在尝试将整个网格发布回发布方法 ASP.net MVC

> ID：12713333
> 
> 赞同：3
> 
> 时间：2012-10-03T17:03:37.100
> 
> 标签：c#, asp.net-mvc

我以网格 [basic html table] 的形式显示了一个数据列表并放置了文本框，以便我们可以在网格内进行编辑并发布值以便我可以保存它。列表并不大，大约 5-10 行。

如何在控制器中访问这些表单值？`FormCollection`似乎不起作用，我什至无法通过`Request.Form[]`. 我希望它以列表的形式返回，以便我可以遍历它并获取新值。

**.cshtml**

```
 <form action="/Parameter/StudentWeights" method="post">
     <table>
    <tr>
        <th>
            Category
        </th>
        <th>
            CategoryAlias
        </th>

        <th>
            YearCode
        </th>
          <th>
            ClassKto8
        </th>
        <th>
            Class9to12
        </th>
        <th></th>
    </tr>
    @foreach(var item in Model.StudentWeights) {
    <tr>
    <td>
            @Html.HiddenFor(modelItem => item.CategoryId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Category)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CategoryAlias)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.YearCode)
        </td>
        <td>
            @Html.EditorFor(modelItem => item.ClassKto8)
        </td>
         <td>
            @Html.EditorFor(modelItem => item.Class9to12)
        </td>

    </tr>
}

</table>
<input type="submit" value = "Submit" />
 </form> 
```

**控制器**

```
[HttpPost]
public ActionResult studentWeights(FormCollection collection)
{
    try
    {
        // TODO: Add update logic here

        //service.
        foreach (var item in collection)
        { 
            int x = item. // i want to loop through it and access the values.
        }
    }
    catch
    {
        return View();
    }
} 
```

请帮助我如何获得这些值。我不想使用 JEditable 或任何第三方 jQuery 工具。

有什么方法可以在单击按钮时创建自定义类型并在 JavaScript 或 jQuery 中分配值，然后将其发送到我的控制器操作？

非常感谢，任何建议都会很有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T12:41:25.323

您需要以不同的方式访问表单集合。表单集合是发布到控制器的值的键值对。表单集合[“后值”]

```
[HttpPost]
public ActionResult studentWeights(FormCollection formCollection)
{
    foreach (string _formData in formCollection)
    {
        var x = formCollection[_formData];
    }

} 
```

以下是遍历表单集合的几种方法 [http://stack247.wordpress.com/2011/03/20/iterate-through-system-web-mvc-formcollection/](http://stack247.wordpress.com/2011/03/20/iterate-through-system-web-mvc-formcollection/)

# bash - 在 shell 中，如何删除编号的重复文件？

> ID：12713336
> 
> 赞同：6
> 
> 时间：2012-10-03T17:03:49.333
> 
> 标签：bash, awk

我有一个目录，里面有几千个文件，命名如下：

```
filename.ext
filename (1).ext
filename (2).ext
otherfile.ext
otherfile (1).ext
etc. 
```

大多数带有括号数字的文件都是原始文件的副本，但在某些情况下它们不是。

如何保留原始文件，删除重复文件，但不丢失不同的文件？

我知道我可以`rm *\).ext`，但这显然不能确保文件与原始文件匹配。

我使用的是 OS X，所以我有一个`md5`功能类似于`md5sum`Linux 的程序，尽管它将散列放在行尾而不是开头。我在想我可以使用 awk 脚本来获取 的输出`md5 *.ext | awk 'some script'`，通过 md5 查找重复项并删除它们，但是命令行太长（`bash: /sbin/md5: Argument list too long`）。

而且我不知道该在脚本中写什么。我正在考虑用这个将东西存储在一个数组中：

```
awk '{a[$NF]++} a[$NF]>1{sub(/).*/,""); sub(/.*(/,""); system("rm " $0);}' 
```

但这似乎总是删除我的原件。

我究竟做错了什么？我该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T17:10:43.333

您的 awk 脚本会删除原始文件，因为当您对文件进行排序时，`.`（句点）会排在`（空格）之后。因此，看到的第一个文件被编号，而不是原始文件，随后的检查（包括与原始文件的检查）将文件与第一个编号的文件进行比较。`

 `不仅`rm *\).txt`无法匹配原始文件，它还会丢失最初可能没有原始文件的文件。

我不会这样做。无需检查*每个编号文件*并验证它是否与原件匹配，您可以查看原件列表，然后删除与它们匹配的编号文件。

反而：

```
$ for file in *[^\)].txt; do echo "-- Found: $file"; rm -v $(basename "$file" .txt)\ \(*\).txt; done 
```

您可以扩展它以检查 MD5。但它的代码更多，所以我将它分成多行，在一个脚本中：

```
#!/bin/bash

shopt -s nullglob              # Show nothing if a fileglob matches no files

for file in *[^\)].ext; do
  md5=$(md5 -q "$file")        # The -q option gives you only the message digest
  echo "-- Found: $file ($md5)"
  for duplicate in $(basename "$file" .ext)\ \(*\).ext; do
     if [[ "$md5" = "$(md5 -q "$duplicate")" ]]; then
        rm -v "$duplicate"
     fi
  done
done 
```

作为替代方案，您可能会更简单地执行此操作，与计算 MD5 摘要相比，CPU 开销更少。Unix 和 Linux 都有一个叫做 的 shell 工具[`cmp`](http://www.freebsd.org/cgi/man.cgi?query=cmp)，它就像`diff`没有输出一样。所以：

```
#!/bin/bash

shopt -s nullglob

for file in *[^\)].ext; do
  for duplicate in $(basename "$file" .ext)\ \(*\).ext; do
    if cmp "$file" "$duplicate"; then
      rm -v "$file"
    fi
  done
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:10:05.940

如果您不需要使用 AWK，您可以在 bash 中做一些更简单的事情：

```
for file in *\([0-9]*\)*; do
    [ -e "$(echo "$file" | sed -e 's/ ([0-9]\+)//')" ] && rm "$file"
done 
```

希望这会有所帮助=)`

# java - Mongo Java 数组

> ID：12713337
> 
> 赞同：1
> 
> 时间：2012-10-03T17:03:56.773
> 
> 标签：java, mongodb

快速且希望简单的问题。

```
DBObject res = collection.findOne(new BasicDBObject("_id",id));
// some_array is just an array of strings
Arr = res.get("some_array"); 
```

Arr 需要是什么类型？`String[]`? `ArrayList`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-11T20:56:07.740

res.get() 返回一个对象，因此您需要进行显式转换（您需要知道*some_array*字段的类型。

IE：

```
List<Integer> values = (List<Integer>)res.get("some_array"); 
```

这是原因之一，因为我不支持将 Java 和 MongoDB 结合在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:08:13.817

Java 驱动程序将在文档中返回数组作为`List`- 对于您的示例，您可能希望 Arr 是`List<String>`.

# plugins - Sigplus 和 Aidanews2

> ID：12713344
> 
> 赞同：0
> 
> 时间：2012-10-03T17:04:45.083
> 
> 标签：plugins, joomla, joomla2.5, joomla-extensions

我对 Aidanews2 和 Sigplus 画廊插件有疑问。

我的问题是，在文章中添加了 sigplus 画廊，例如`{gallery}mygallery{/gallery}`. 所以 aidanews 只显示纯文本`{gallery}mygallery{/gallery}`，而不显示图库链接。

我已将 aidanews 设置中的“Strip Plugins”设置为“no”，但它仍然无法正常工作。有什么办法让它工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T18:12:50.227

问题是 Joomla 不会在模块中自动运行插件。“剥离插件”选项应该用于剥离插件代码，因此它不会像您的情况那样显示出来。

为了使其工作，您将不得不更改模块的视图并让它在输出内容之前运行任何插件。您可以很好地了解需要在此处添加的代码 - [http://www.alltogetherasawhole.org/group/developers/forum/topics/running-joomla-content-plugins](http://www.alltogetherasawhole.org/group/developers/forum/topics/running-joomla-content-plugins)

# android - 使用外部类在活动之间保存数据

> ID：12713348
> 
> 赞同：4
> 
> 时间：2012-10-03T17:04:50.543
> 
> 标签：android, string, class, save, external

我正在开发一个必须在活动之间共享字符串的应用程序。我试图让单独的活动来调用具有 set 和 get 方法的公共类。调用方法部分有效，尽管 set 和 get 类必须记住 set 值，但我设法得到了响应。这是我的设置和获取课程的链接，它非常基本： http: [//pastebin.com/0WabNKz3](http://pastebin.com/0WabNKz3)

现在我的问题是：我如何设置并获取课程以记住我在会话之间的值？如果有什么你不明白的，请随时提问。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:11:30.953

你需要使用`SharedPreferences`. 即使在应用程序关闭并且您可以从任何地方访问它之后，这也是保存数据的方式：

```
public void savePrefrences(String key, String value)
    {
        SharedPreferences prefs = context.getSharedPreferences(context.getPackageName(), 0);
        prefs.edit().putString(key, value).commit();
    }

    public String getPrefrences(String key)
    {
        SharedPreferences prefs = context.getSharedPreferences(context.getPackageName(), 0);
        return prefs.getString(key, "");
    } 
```

随时随地保存偏好，随时随地获取。

关闭应用程序时不会删除该值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T18:29:30.860

我最终创建了不可见的 EditTextPreference，它现在保存了我想要保留的数据，因为它们可以轻松共享。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:09:53.053

当您说在会话之间保存时，您是指在应用程序暂停或完全关闭之间？

生命周期和跨会话存储数据的一个很好的资源是：//developer.android.com/training/basics/activity-lifecycle/index.html

# ruby-on-rails - 虚拟属性：没有路由匹配 {:controller=>"phone", :action=>"new"}

> ID：12713351
> 
> 赞同：0
> 
> 时间：2012-10-03T17:04:56.263
> 
> 标签：ruby-on-rails, ruby

我有一个控制器“find_numbers”，我用它来向 Twilio API 提交表单。不过，在提交之前，我想针对两个表单字段进行验证，这两个表单字段不在此控制器的数据模型中。字段是 :name 和 :original_number

因此，在我的 find_numbers 模型中，我添加了 attr_accessor :name, attr_accessor :originial number 以在其下运行 validates 命令。

完成此操作并将表单提交为无效后，我收到错误消息：

```
Routing Error

No route matches {:controller=>"phone", :action=>"new"}
Try running rake routes for more information on available routes. 
```

我不确定为什么它说没有根，但我不确定它为什么要访问它。我希望它发布到 find_numbers

find_numbers/新模板

```
 <%= form_tag("/find_numbers", :method => "post", :id => "new_user" ) do %>
    <%= render 'shared/error_messages' %>    

    <%= label_tag(:name, "What Are You Tracking?") %>
     <%= text_field_tag(:name) %>

    <%= label_tag(:original_number, "Your Orginal Number") %>
    <%= text_field_tag(:original_number) %>

    <%= label_tag(:in_postal_code, "Near US postal code (e.g. 94117):") %>
    <%= text_field_tag(:in_postal_code) %>

    <%= label_tag(:near_number, "Near this other number (e.g. +4156562345)") %>
    <%= text_field_tag(:near_number) %>

    <%= label_tag(:contains, "Matching this pattern (e.g. 415***EPIC):") %>
    <%= text_field_tag(:contains) %>  

    <%= submit_tag("Search", :class => "btn btn-large btn-primary") %>

  <% end %> 
```

这是我的 find_number 模型

```
class FindNumber < ActiveRecord::Base

    attr_accessor :name
    attr_accessor :original_number

    validates :name, presence: true
    validates :original_number, presence: true

end 
```

这是我的 Find_number 控制器

```
class FindNumbersController < ApplicationController

    def new
        @user = current_user
    end

    def create
        @user = current_user
        client = Twilio::REST::Client.new(@user.twilio_account_sid, @user.twilio_auth_token)

        search_params = {}
          %w[in_postal_code near_number contains].each do |p|
            search_params[p] = params[p] unless params[p].nil? || params[p].empty?
          end

        local_numbers = client.account.available_phone_numbers.get('US').local
        @numbers = local_numbers.list(search_params)

        unless @numbers.empty?
        render 'find_numbers/show'
        else
        flash.now[:error] = "Sorry, We Couldn't Find Any Numbers That Matched Your Search! Maybe Something Simpler?"    
        render 'find_numbers/new'
        end
    end

    def show

    end

end 
```

任何关于实现这一点的想法将不胜感激！

**编辑**

Routes.rb 文件

```
 Dct::Application.routes.draw do

  resources :users
  resources :sessions, only: [:new, :create, :destroy]
  resources :phones, only: [:new, :create, :destroy]
  resources :find_numbers, only: [:new, :create, :destroy]  

  match '/find_numbers',  to: 'find_numbers#new'  

  match '/signup',  to: 'users#new'
  match '/login',  to: 'sessions#new'
  match '/signout', to: 'sessions#destroy', via: :delete

  root  to: 'static_pages#home'

  match '/product_demo', to: 'static_pages#product_demo'

  match '/pricing', to: 'plans#index'

  match '/contact', to: 'static_pages#contact' 
```

**编辑**

这是服务器日志，当我点击提交时发生了什么

[http://stepanp.com/railserror.jpg](http://stepanp.com/railserror.jpg)

另外，这里是 find_numbers/show 视图

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:08:49.657

根据您发布的内容，对我来说唯一看起来可疑的另一件事是您可能有一个 PhonesController（复数），因为您已经声明了资源：phones，但似乎发生了路由错误，因为它正在寻找一个 PhoneController（单数）。

# jsp - 如何在 JSP 中使用 SSL（在 Java EE 应用程序中）？

> ID：12713357
> 
> 赞同：1
> 
> 时间：2012-10-03T17:05:18.577
> 
> 标签：jsp, jakarta-ee, ssl, openssl, websphere

我正在使用 Java EE 和 JSP 创建一个 Web 应用程序。我使用 Tomcat 和 WebSphere Application Server 作为服务器应用程序。

我想在 SSL 中实现我的网络应用程序，因此它显示 https:// 并具有安全站点图标。

如何在 tomcat 和 WAS 上创建具有 SSL 加密的 Java EE Web 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:08:35.957

获取 SSL 证书并将其安装在您的服务器上。（您的 ISP 应该能够提供帮助。）如果安装正确，您需要做的就是从 HTTP 更改为 HTTPS。

您可能需要检查任何访问是否通过 HTTPS。一种方法是在您的 JSP 中检查它。尝试以下代码段：

```
if (!request.getScheme().equals("https") 
{
    //  throw an error something... 
} 
```

否则，您的代码应该使用 HTTP 或 HTTPS。

附录：如果您想创建自己的自签名证书，请查看[MobilFish openSSL](http://www.mobilefish.com/developer/openssl/openssl_quickguide_code_examples.html)或 Google “JAVA openssl”

# php - 在 osCommerce 信用卡模块中获取送货地址值而不是计费

> ID：12713358
> 
> 赞同：0
> 
> 时间：2012-10-03T17:05:21.333
> 
> 标签：php, oscommerce

如何`$sendto`在 cc.php（creditcard.php 模块）中获取送货地址值 ( )？

现在，该模块使用以下代码填充 billing firstname 和 billing lastname 变量：

```
'field' => tep_draw_input_field('cc_owner', $order->billing['firstname'] . 
  ' ' . $order->billing['lastname'])), 
```

我希望模块使用**Shipping Address firstname 和 Shipping address Lastname**填充该字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:33:43.660

好的，我想出了答案。把上面的代码改成

```
'field' => tep_draw_input_field('cc_owner', $order->delivery['firstname'] . ' ' . $order->delivery['lastname'])), 
```

# mysql - 如何使用 INSERT INTO 获取当前 ID 号？

> ID：12713359
> 
> 赞同：1
> 
> 时间：2012-10-03T17:05:24.100
> 
> 标签：mysql, sql, insert-into

> **可能重复：**
> [php/MySQL 插入行然后获取 'id'](https://stackoverflow.com/questions/897356/php-mysql-insert-row-then-get-id)

如何使用 INSERT INTO 获取当前 ID 号？

```
mysql_query("INSERT INTO mytable(id,a,b) VALUES(null,3,current ID) ");

mysql_query("
    INSERT INTO tablo(id,a,b)
    VALUES(null,3,this ID number)
            ^            ^
            |            |
            | <Copy ID>  |
            |____________|
"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T17:10:58.950

Use `mysqli_insert_id()`，它返回上次查询中使用的自动生成的 id。

阅读“ [PHP mysql_insert_id() 函数](http://www.w3schools.com/php/func_mysql_insert_id.asp)”或“ [`mysql_insert_id`](http://php.net/manual/en/function.mysql-insert-id.php)”。

例子：

```
<?php
$query= "INSERT INTO table_name VALUES ('a','b','c')";
$result = mysql_query($query);
echo "INSERT statement ID is" . mysql_insert_id();
?> 
```

并阅读`mysql_insert_id`页面上 PHP 文档中的红色大框，以`mysqli`.

请参阅[PHP 文档](http://www.php.net/manual/en/mysqli.insert-id.php)以获取更多参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:11:43.157

基本上你可以使用该[`mysqli_insert_id`](http://www.php.net/manual/en/mysqli.insert-id.php)功能。

如 PHP 手册中所述：

> mysqli_insert_id() 函数返回由对具有 AUTO_INCREMENT 属性的列的表的查询生成的 ID。如果最后一个查询不是 INSERT 或 UPDATE 语句，或者修改后的表没有具有 AUTO_INCREMENT 属性的列，则此函数将返回零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:13:17.183

您可以尝试获取所选表中使用的序列的下一个值。请检查 MySQL 是否有任何函数来获取这个值。如果在执行 SQL 语句时需要这个数字，那么使用 PHP 函数是不可能的。

选中“[使用 MySQL 查询获取自动增量值](https://stackoverflow.com/a/1109170/1702557)”。

# hadoop - 在 Apache PIG 中按父值过滤包

> ID：12713364
> 
> 赞同：0
> 
> 时间：2012-10-03T17:06:01.843
> 
> 标签：hadoop, mapreduce, apache-pig

我在 Apache PIG 中有以下关系。

```
TSERIES: {ORDERED: {(timestamp: long,contentHost: chararray)},ts1: long} 
```

我想做以下事情：

```
F = foreach TSERIES {
    ts = filter ORDERED by timestamp > TSERIES.ts1;
    generate ts;
} 
```

简而言之，我想保持 bag ORDERED 的所有元素的时间图高于 ts1，但 pig 不允许，特别是这部分`ts = filter ORDERED by timestamp > TSERIES.ts1;`。

这可能吗？我正在使用版本`0.9.2-cdh4.0.1`（cloudera）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T23:42:09.400

我不确定是否有办法在没有 UDF 的情况下做到这一点......似乎应该有，但我也想不通。无论如何，您可以直接编写一个 UDF 来执行此操作：遍历袋子，过滤掉一些，然后返回一个袋子。或者，您可以编写一个 UDF 来生成 UUID，然后将包展平并重新分组 - 像这样平滑：

```
a = foreach TSERIES generate ORDERED, ts1, myudfs.GenerateUUID() as id;
b = foreach a generate FLATTEN(ORDERED) as ts, ts1, id;
c = filter b by ts.timestamp > ts1;
d = group c by id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:21:48.820

你试过了吗：

测试 = 过滤 tseries By (ordered.timestamp > ts1);

# scala - 分配一个匿名函数 - 哪个更惯用？

> ID：12713366
> 
> 赞同：1
> 
> 时间：2012-10-03T17:06:06.440
> 
> 标签：scala

假设我想分配一个匿名函数，它将一个映射`Int`到一个`Int`

我可以这样分配

```
val double = (x: Int) => x * 2 
```

或者像这样

```
val double: Int => Int = x => x * 2 
```

哪个更惯用？或者是否有一种情况比另一种更可取？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T18:01:08.113

我会调用它*两次*，因为它`double`是 Java 中的保留字，可能会导致与数据类型混淆`Double`（即`double`在 Java 中）。无论如何，两者都没有比另一个更惯用。在其他条件相同的情况下，我更喜欢第一种形式，因为它更短，并且如果我决定`x`应该是 a `Float`（即我只需要在一个地方更改类型），它会自动为我修复我的类型。如果我认为它是一个重要但不明显的`Int => Int`，或者如果情况更复杂并且需要该信息来进行正确的类型推断，我会赞成第二个。实际上，在这种简单的情况下，我会将案例写为

```
val twice = (x: Int) => x * 2
val twice: Int => Int = _ * 2 
```

这使它们的长度相同。（我仍然喜欢第一个，因为它不再是，并且在您需要多次引用变量的情况下，您可以保持相同的形式。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:40:17.103

我会说这取决于你同事的背景。

第二个在我看来更像 Haskellish，第一个更像 Javaish。

此外，第二个实际上指定了返回类型，当 double 是公共 API 的一部分时这是一个很好的做法，而第一个只是推断它，当实现发生更改时容易发生意外更改。

# sitecore - 即使未配置为，如何在所有页面中显示占位符？

> ID：12713369
> 
> 赞同：0
> 
> 时间：2012-10-03T17:06:15.553
> 
> 标签：sitecore

我在布局中有以下占位符

*   标题占位符
*   顶后占位符
*   中心占位符
*   底部后占位符
*   页脚占位符

以及使用上述布局的以下项目

*   Home Item - 用于显示主页
*   文章项目 - 用于显示文章页面

这里上面布局中使用的两个后退占位符用于在页面的顶部和底部显示一个后退按钮（这里我将为两个不同的占位符配置相同的子布局以在顶部和底部显示后退按钮）但是这些后退按钮应仅显示在文章页面中，而不应显示在主页中。

所以我只为文章项目（使用演示文稿 - > 详细信息选项）而不是主页项目进行相应配置。但是在编辑模式下，我可以看到一个包含返回占位符的空白部分，在顶部和底部要求返回子布局主页，虽然我没有在主页项目的 Presentation->Details 中配置它。

请让我知道我缺少的设置在主页中显示占位符，即使它未配置为显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T00:06:03.437

您已正确设置它，但似乎对占位符与子布局和渲染有点混淆。

占位符只是可用于包含子布局和/或渲染的区域。一个占位符可以包含 0 个或多个子布局和渲染。

在您的示例中： - 占位符仍然存在于 Home 项目的布局中。如果不为该占位符分配子布局或渲染（如在 Home 项上所做的那样），则页面上的该位置不会填充任何内容。

在编辑模式（我假设是页面编辑器模式）下，您会看到那些占位符的区域，其中没有任何内容，因为 Sitecore 只是允许您在需要时在其中放置一些东西。（即它向您展示了一个占位符供您填充子布局或渲染，但目前没有任何内容。）

如果您想从布局中删除占位符仅用于主项目，您可以在布局中添加一些代码来执行以下操作：-

给占位符一个 ID（如 topBackPlaceholder）。

```
if (Sitecore.Context.Item.Paths.FullPath == Sitecore.Context.Site.RootPath)
{
    topBackPlaceholder.Visible = false;
} 
```

# java - JAXB 元素 与布尔值

> ID：12713373
> 
> 赞同：6
> 
> 时间：2012-10-03T17:06:22.387
> 
> 标签：java, web-services, soap, jaxb, boolean

究竟是什么`JAXBElement Boolean`以及如何将其设置为布尔等效的“ `true`”？

方法：

```
 public void setIncludeAllSubaccounts(JAXBElement<Boolean> paramJAXBElement)
  {
    this.includeAllSubaccounts = paramJAXBElement;
  } 
```

这不会**编译**：

```
returnMessageFilter.setIncludeAllSubaccounts(true); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T19:13:28.173

`JAXBElement`当 JAXB (JSR-222) 实现无法仅根据值判断要做什么时，A会作为模型的一部分生成。在您的示例中，您可能有一个元素，例如：

```
<xsd:element 
    name="includeAllSubaccounts" type="xsd:boolean" nillable="true" minOccurs="0"/> 
```

生成的属性不能是`boolean`因为`boolean`不代表`null`. 您可以创建该属性`Boolean`，但是您如何区分缺少的元素和带有`xsi:nil`. 这就是 JAXBElement 的用武之地。请参阅下面的完整示例：

**富**

```
package forum12713373;

import javax.xml.bind.JAXBElement;
import javax.xml.bind.annotation.*;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Foo {

    @XmlElementRef(name="absent")
    JAXBElement<Boolean> absent;

    @XmlElementRef(name="setToNull")
    JAXBElement<Boolean> setToNull;

    @XmlElementRef(name="setToValue")
    JAXBElement<Boolean> setToValue;

} 
```

**对象工厂**

```
package forum12713373;

import javax.xml.bind.JAXBElement;
import javax.xml.bind.annotation.*;
import javax.xml.namespace.QName;

@XmlRegistry
public class ObjectFactory {

    @XmlElementDecl(name="absent")
    public JAXBElement<Boolean> createAbsent(Boolean value) {
        return new JAXBElement(new QName("absent"), Boolean.class, value);
    }

    @XmlElementDecl(name="setToNull")
    public JAXBElement<Boolean> createSetToNull(Boolean value) {
        return new JAXBElement(new QName("setToNull"), Boolean.class, value);
    }

    @XmlElementDecl(name="setToValue")
    public JAXBElement<Boolean> createSetToValue(Boolean value) {
        return new JAXBElement(new QName("setToValue"), Boolean.class, value);
    }

} 
```

**演示**

```
package forum12713373;

import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Foo.class);

        ObjectFactory objectFactory = new ObjectFactory();

        Foo foo = new Foo();
        foo.absent = null;
        foo.setToNull = objectFactory.createSetToNull(null);
        foo.setToValue = objectFactory.createSetToValue(false);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(foo, System.out);
    }

} 
```

**输出**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<foo>
    <setToNull xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
    <setToValue>false</setToValue>
</foo> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T17:40:03.127

感谢 NullUserException 的评论，我能够在一行中实现这一点。它略有不同，所以我想我会为了他人的利益而发布它。

```
returnMessageFilter.setIncludeAllSubaccounts(new JAXBElement<Boolean>(new QName("IncludeAllSubaccounts"), 
Boolean.TYPE, Boolean.TRUE)); 
```

澄清一下，QName 是 XmlElement 标记名称。

另外，需要导入：

```
import javax.xml.bind.JAXBElement; 
```

**编辑**

最好在返回Blaise 建议的`ObjectFactory`类中使用便捷方法。`JAXBElement`

# windows-8 - WinJS / WinRT：检测损坏的图像文件

> ID：12713375
> 
> 赞同：2
> 
> 时间：2012-10-03T17:06:23.780
> 
> 标签：windows-8, windows-runtime, winjs, storagefile

我正在构建一个从本地图片库加载图片的 Win8/WinJS 应用程序。一切通常都可以正常加载有效图像并在列表视图中显示它们。

现在我需要检测损坏的图像并为这些图像禁用部分应用程序。

例如，打开一个文本文件并在其中输入一些文本。将文件另存为 .jpg，这显然不是有效的 jpg 图像。由于 .jpg 名称，我的应用程序仍会加载文件，但现在我需要禁用应用程序的某些部分，因为图像已损坏。

有没有办法检查我加载的给定图像是否是有效的图像文件？检查它是否损坏？

我正在使用标准 WinRT / WinJS 对象，如 StorageFile、Windows.Storage.Search 相关对象等，根据搜索文件类型加载我的图像列表。

我不需要从搜索结果中过滤掉损坏的图像。在有人在 ListView 中选择图像后，我只需要能够判断图像是否损坏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:02:59.863

一种可能的解决方案是检查图像`width`和`height`属性以确定它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-23T08:25:47.427

其中 SelectImagePlaceholder 是一个图像控件.. =)

> 存储文件文件；
> 
> ```
>  using (IRandomAccessStream fileStream = await file.OpenAsync(Windows.Storage.FileAccessMode.Read))
>         {
>             try
>             {
>                 // Set the image source to the selected bitmap
>                 BitmapImage bitmapImage = new BitmapImage();
> 
>                 await bitmapImage.SetSourceAsync(fileStream);
> 
>                 SelectImagePlaceholder.Source = bitmapImage;
>                 //SelectImagePlaceholder.HorizontalAlignment = HorizontalAlignment.Center;
>                 //SelectImagePlaceholder.Stretch = Stretch.None;
>                 this.SelectImagePlaceholder.DataContext = file;
> 
>                 _curMedia = file;
>             }
>             catch (Exception ex)
>             {
>                 //code Handle the corrupted or invalid image
>             }
>         } 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T02:55:29.230

是的，该`contentType`属性将返回任何文件扩展名。我能找到它查看[图像属性](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.fileproperties.imageproperties)的最佳方法：

```
file.properties.getImagePropertiesAsync()
               .done(function(imageProps) {
                   if(imageProps.width === 0 && imageProps.height === 0) {
                       // I'm probably? likely? invalid.
                   }); 
```

# opengl - 使用 opengl 和 x264 更快地编码实时 3D 图形

> ID：12713376
> 
> 赞同：4
> 
> 时间：2012-10-03T17:06:29.403
> 
> 标签：opengl, 3d, video-encoding, x264

我正在开发一个系统，该系统将压缩视频从 3d 图形发送到客户端，这些图形在渲染后立即在服务器中完成。我已经让代码工作了，但我觉得它可能会更快（而且它已经是系统中的瓶颈）

这是我正在做的事情：

首先我抓住帧缓冲区

```
glReadBuffer( GL_FRONT );
glReadPixels( 0, 0, width, height, GL_RGB, GL_UNSIGNED_BYTE, buffer ); 
```

然后我翻转帧缓冲区，因为 swsScale（我用于色彩空间转换）有一个奇怪的错误，它在我转换时垂直翻转图像。我是提前翻的，没什么花哨的。

```
void VerticalFlip(int width, int height, byte* pixelData, int bitsPerPixel)
{
byte* temp = new byte[width*bitsPerPixel];
height--; //remember height array ends at height-1

for (int y = 0; y < (height+1)/2; y++) 
{
    memcpy(temp,&pixelData[y*width*bitsPerPixel],width*bitsPerPixel);
    memcpy(&pixelData[y*width*bitsPerPixel],&pixelData[(height-y)*width*bitsPerPixel],width*bitsPerPixel);
    memcpy(&pixelData[(height-y)*width*bitsPerPixel],temp,width*bitsPerPixel);
}
delete[] temp;
} 
```

然后我将其转换为 YUV420p

```
convertCtx = sws_getContext(width, height, PIX_FMT_RGB24, width, height, PIX_FMT_YUV420P, SWS_FAST_BILINEAR, NULL, NULL, NULL);
uint8_t *src[3]= {buffer, NULL, NULL}; 

sws_scale(convertCtx, src, &srcstride, 0, height, pic_in.img.plane, pic_in.img.i_stride); 
```

然后我几乎只是调用 x264 编码器。我已经在使用 zerolatency 预设。

```
int frame_size = x264_encoder_encode(_encoder, &nals, &i_nals, _inputPicture, &pic_out); 
```

我的猜测是应该有一种更快的方法来做到这一点。捕获帧并将其转换为 YUV420p。最好在 GPU 中将其转换为 YUV420p，然后再将其复制到系统内存中，希望有一种无需翻转即可进行颜色转换的方法。

如果没有更好的方法，至少这个问题可以帮助尝试这样做的人，像我一样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T21:36:36.397

首先，使用 PBO 使用异步纹理读取。这里是[示例](http://www.songho.ca/opengl/gl_pbo.html)它通过使用 2 个异步工作的 PBO 来加快读取速度，而不会像直接使用 readPixels 那样停止管道。在我的应用程序中，当切换到 PBO 时，我的性能提升了 80%。此外，在某些 GPU 上，glGetTexImage() 的运行速度比 glReadPixels() 更快，因此请尝试一下。

但是，如果您真的想将视频编码提升到一个新的水平，您可以使用[Nvidia Codec Library](https://developer.nvidia.com/nvidia-codec-libraries)通过 CUDA 来完成。我最近问了同样的问题，所以[这](https://stackoverflow.com/questions/13857400/encoding-fbo-textures-to-h-264-video-directly-on-gpu)可能会有所帮助。

# c++ - 具有单位向量约束的非线性优化

> ID：12713381
> 
> 赞同：1
> 
> 时间：2012-10-03T17:06:45.840
> 
> 标签：c++, algorithm, math, matrix

我有一个 3x3 矩阵 E，我正在尝试解决这个优化问题：

```
|| E * t || = minimum 
```

其中 t 是我正在寻找的解决方案，它必须是单位向量（表示为 3x1 矩阵）。|| x || 表示 x 的欧几里得距离。

有没有图书馆可以帮助我解决这个问题？我在各种库中找到了几个求解函数，但我似乎找不到一个可以让我施加额外约束的函数，即 t 必须是单位向量。那么我可以在没有库的情况下以编程方式解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T17:27:15.237

对我来说，这看起来像是一个特征向量类型的问题——你`minimum`应该是 的特征值中的最小绝对值`E`。

对矩阵 E进行[奇异值分解](http://en.wikipedia.org/wiki/Singular_value_decomposition)(SVD)（此操作应作为任何好的线性代数库的一部分提供）。这将为您提供 E 的因式分解：

```
E =  U diag V* 
```

其中`diag`是具有非负对角线值的对角矩阵，`U`和`V`是正交的。

找到 的最小对角线元素`diag`；的相应行`V*`（或列`V`）是您的解决方案`t`。

这个值`t`将是一个单位向量，因为`V`它是正交的，并且结果向量`E t`将是最小的，因为`U`并`V`保持向量长度。

# pyqt4 - 当 ItemIgnoresTransformations 打开时 QGraphicsView 的 fitInView 出现问题

> ID：12713385
> 
> 赞同：2
> 
> 时间：2012-10-03T17:07:04.723
> 
> 标签：pyqt4, qgraphicsview

在尝试实现项目大小不变但项目之间的距离被放大的场景时，我遇到了以下代码的问题，该代码绘制了一个矩形和文本“A”。现在，如果我在矩形项目上设置标志 ItemIgnoresTransformations，放大会导致矩形消失（单击并在矩形周围拖动鼠标按钮）。但在文本的情况下不会发生这种情况。此外，fitInView 设置的新视口区域与我要求的非常不同：

```
import sys
from PyQt4 import QtCore, QtGui

class GV(QtGui.QGraphicsView):
    def __init__(self, *args, **kwargs):
        QtGui.QGraphicsView.__init__(self, *args, **kwargs)

    def mousePressEvent(self, event):
        pos = QtCore.QPoint(event.pos())
        self.startPos = pos

    def mouseReleaseEvent(self, event):
        pos = QtCore.QPoint(event.pos())
        self.endPos = pos
        rect = QtCore.QRect(self.startPos, self.endPos) 
        sceneRect = self.mapToScene(rect).boundingRect()
        print 'Selected area: viewport coordinate:', rect, \
            ', scene coordinate:', sceneRect
        self.fitInView(sceneRect)
        print 'new viewport in scene coordinates:', \
            self.mapToScene(self.viewport().geometry()).boundingRect()

class Scene(QtGui.QGraphicsScene):
    def __init__(self, *args, **kwargs):
        QtGui.QGraphicsScene.__init__(self, *args, **kwargs)    
        self.itemA = QtGui.QGraphicsSimpleTextItem('A')
        self.itemA.setPos(20, 20)
        self.itemA.setFlag(QtGui.QGraphicsItem.ItemIgnoresTransformations, True)
        self.addItem(self.itemA)
        self.itemB = QtGui.QGraphicsRectItem(30, 50, 20, 20)
        self.addItem(self.itemB)
        self.itemB.setFlag(QtGui.QGraphicsItem.ItemIgnoresTransformations, True)

if __name__ == '__main__':
    app = QtGui.QApplication(sys.argv)
    widget = QtGui.QMainWindow()
    scene = Scene()
    view = GV(scene, widget)
    widget.setCentralWidget(view)
    widget.show()
    app.exec_() 
```

任何解释将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T04:46:05.863

事实上，矩形并没有消失。但它“奇怪地”移动。

```
self.itemB = QtGui.QGraphicsRectItem(30, 50, 20, 20) 
```

这条线可能不是你想要的。这将创建一个项目并从*本地坐标*开始放置一个矩形/正方形`(30, 50)`。然后将其添加到场景中。这为您提供了一个锚定在 的项目，跨越到但仅在右下角绘制一个矩形。*`(0, 0)``(50, 70)``20x20`*

 *当您设置 时`ItemIgnoresTransformations`，项目在缩放的情况下无法进行常规转换。场景放大，为了让 item 忽略这种转换，它本身有点“缩小”。但它仍然锚定在`(0, 0)`并且矩形位于右下角，因此绘制的矩形向左上角移动。

解决方案相当简单。不要在局部坐标中创建你的矩形，即你的矩形应该从开始`(0, 0)`并且你应该明确定位它。这意味着：

```
self.itemB = QtGui.QGraphicsRectItem(0, 0, 20, 20)
self.itemB.setPos(30, 50) 
```*

# c# - 什么是最小的 ASP.NET MVC 4 安装？

> ID：12713386
> 
> 赞同：26
> 
> 时间：2012-10-03T17:07:10.480
> 
> 标签：c#, .net, asp.net-mvc, development-environment

好的，我已经通过 Microsoft Web Platform Installer 4.0 在本地安装了 ASP.NET MVC 4。它有一些我们作为开发人员需要的好东西。我现在正尝试在我们的开发服务器（Windows 2003 Server 机器）上安装它；但是，它想很好地下载一吨的其他东西。我正在尝试找到一个将 MVC 4 文件放入 GAC 的最小安装。我的开发服务器上不需要 Sql Server express（Sql Server 2005 已经存在）。我也不需要 Visual Web Developer 2010 Express，因为我不在服务器上开发；这只是在服务器上和本地机器上进行测试的第一步。

细节：

Microsoft Web Platform Installer 4.0：ASP.NET MVC 4 Tools Update with Language Packs（2012 年 8 月）中列出的下载选项。

要安装的项目的完整列表是：

*   Visual Studio 2010 SP1 核心
*   视觉 Web 开发者 2010 速成版
*   Sql Server Express 2008 R2
*   视窗安装程序 4.5
*   视觉工作室 2010 SP1 KB983509
*   ASP.NET MVC 4 工具更新语言包安装程序
*   ASP.NET MVC 4 安装程序（VS 2010）-默认语言环境

总而言之，仅下载量就达到惊人的 710.02 MB。我只需要 ASP.NET MVC 4 作为框架......只是库。这是安装它的唯一方法吗？ASP.NET MVC 3 的安装时间很长，但肯定没有那么分散。

想法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-03T17:28:43.973

[Microsoft 下载页面上的独立 ASP.NET MVC 4](http://www.microsoft.com/en-us/download/details.aspx?id=30683)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-03T17:30:24.520

与 MVC3 不同，MVC4 没有独立的安装程序，并且不再部署到 GAC。它与应用程序一起部署。

部分原因是 MVC4 现在通过 NuGet 包分发，并分解为各种组件，以允许人们只选择他们想要的东西。

我相信您可以自己将其部署到 GAC，但何必费心呢？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T17:24:32.790

您可以像这样进行 bin 部署：

1.  右键单击您的项目并选择“添加库包引用” - 检查 ASP.NET MVC
2.  在服务器上安装 .Net Framework 4.5
3.  在服务器上发布项目
4.  将网站的 AppPool 设置为 .NET Framework 4 Integrated

# objective-c - 从子 UIViewController 中检索 UINavigationController 属性

> ID：12713389
> 
> 赞同：0
> 
> 时间：2012-10-03T17:07:39.560
> 
> 标签：objective-c, properties, uinavigationcontroller, subclass

我创建了一个`UINavigationController`被调用的子类，`CustomNavigationController`它跟踪用户当前所处的级别。

它有一个名为`currentLevel`, 类型的属性`NSString`。

```
// CustomNavigationController.h
#import <UIKit/UIKit.h>
@interface CustomNavigationController : UINavigationController{
    NSString *_currentLevel;
}    
@property (nonatomic, retain) NSString *currentLevel;
@end 
```

我可以使用以下内容从子视图控制器中检索属性：

```
[(CustomNavigationController *)self.navigationController currentLevel]; 
```

然而，currentLevel 总是返回`(null)`。

我在我的视图控制器中引用了一个 setter 方法来增加它：

```
[(CustomNavigationController *)self.navigationController setCurrentLevel:@"Level 5"];
NSLog(@"%@",[(CustomNavigationController *)self.navigationController currentLevel]);
//returns Level 5 
```

但是，当一个新的视图控制器被推入堆栈或从堆栈中弹出时，我在`viewDidLoad`方法中的原始行返回`(null)`.

`ViewController`我的`CustomNavigationController`. 这个 View Controller 取决于知道它在哪个级别。我有逻辑根据用户当前在`CustomNavigationController`.

# coffeescript - foo(a:b, dx) 是非法咖啡脚本的事实是解释器的错误还是语言的一部分？

> ID：12713390
> 
> 赞同：7
> 
> 时间：2012-10-03T17:07:39.740
> 
> 标签：coffeescript

在咖啡脚本中，以下代码都是合法的

> 富（a：b，d）
> 
> 富（{a：b}，dx）
> 
> 富（a：b，（dx））

但不知为何

> 富（a：b，dx）

是非法的。我认为这一定是因为这里有一个我没有看到的模棱两可的地方，或者是口译员过于警惕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T02:51:26.923

原来这是一个先前报告的咖啡脚本错误

# sharepoint - 如何将根网站重定向到网站集

> ID：12713391
> 
> 赞同：3
> 
> 时间：2012-10-03T17:07:48.640
> 
> 标签：sharepoint, iis, sharepoint-2010, alternate-access-mappings

我很难弄清楚这个问题，我需要你的帮助。这是场景：

我的端口 80 上有一个 sharepoint 2010 Web 应用程序。它有 2 个网站集、根目录和 /sites/official。我的问题是：根站点是空的，但将来它会是我的东西（我还不知道是什么），但是我的其他站点集合已经准备就绪，而且我已经有了它的 Internet 地址。

我想要做的是以我可以输入的方式配置所有内容`http://contoso.com`并作为响应我的子站点（是的，它是一种重定向）......

我该怎么做？我应该在哪里配置它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T06:25:48.310

在您的根网站集上添加内容编辑器 webpart 并将此 javascript 放入该 webpart

```
<script type="text/javascript">
window.location = "http://contoso.com/sites/official"
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-25T15:20:40.747

1.  打开 IIS 管理器
2.  右键单击您的 SharePoint 网站 ->`Properties`
3.  转到选项卡`Home Directory`
4.  选择`A redirection to a URL`
5.  填写重定向的 URL。例如：`http://contoso.com/sites/official`

笔记：

*   确保检查`A Directory below URL entered`以避免重定向循环
*   链接到另一个线程可能会让读者感兴趣 - [sharepoint 中的立即重定向页面](https://sharepoint.stackexchange.com/questions/51604/immediate-redirect-page-in-sharepoint?newreg=abbb93ea53c04f718d49b56abd1c08e6)

截屏：

![在此处输入图像描述](../Images/3101ef1b2096148a90418d8772008431.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T12:57:25.127

从管理中心为子网站集添加备用访问映射。

管理中心 > 应用程序管理 > Web 应用程序 > 配置备用访问映射

# python - Gimp：为什么我不能注册这个？

> ID：12713399
> 
> 赞同：1
> 
> 时间：2012-10-03T17:08:07.833
> 
> 标签：python, blender, gimp, python-fu, gimpfu

我正在为 Blender 编写一个附加组件以将其与 Gimp 同步，并且该脚本应该能够从 Gimp 中启动，但我无法注册它......为什么？

blender_gimp_sync.py：

```
# -*- coding: utf-8 -*-

#!/usr/bin/env python

from gimpfu import *

def blender_gimp_sync():
    image_dir = "/home/antoni4040/Έγγραφα/Layout.png"
    image = gimp.pdb.gimp_file_load(image_dir, image_dir)
    gimp.Display(image)

register(
    "python_fu_bgsync",
    "Blender-Gimp Sync",
    "Syncronize Gimp with Blender for texturing",
    "Antonis Karvelas",
    "Antonis Karvelas",
    "2012",
    "<Image>/Image/Blender-Gimp Sync",
    "*",
    [],
    [],
    blender_gimp_sync
)   

main() 
```

真的很奇怪……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T02:42:12.223

您没有说您遇到了哪个错误-但是自从您发布了源文件以来，我想我可以猜到：GIMP期望它的插件可以由系统执行-以及什么告诉Posix（包括Linux）系统该文件应该使用特定的解释器或 shell 执行的是 shebang 行 -`#!/usr/bin/env python`您的示例中的行。

然而，这一行必须是文件的*第一*行——其中的`#!`字符应该是文件的前两个字符。表示字符编码的行 -`# -*- coding: utf-8 -*-`应该在它之后 - 它必须是文件中的第二行，它们之间没有空行）。

最后，确保通过在 Python 文件上运行“chmod a+x”将脚本设置为可执行文件。

与它相关，但不是导致问题的原因，将菜单路径与脚本菜单名称一起放在 GIMP 中已弃用 - 正确的做法是，在“日期”参数之后，只传递应该显示的名称在菜单中 - “同步” - 并在调用结束时将菜单路径作为命名参数传递，例如：`menu="<Image>/Image/Blender-Gimp"`

# android - 在 Android 中使用 HttpUrlConnection 进行无限缩放

> ID：12713401
> 
> 赞同：1
> 
> 时间：2012-10-03T17:08:13.873
> 
> 标签：android, httpurlconnection, pinchzoom

我使用以下代码通过`HttpUrlConnection`. 我想添加图像放大和缩小 ( `pinch zoom`)。我还从网上搜索了一些代码，但我发现图像可以无限放大和缩小。我不知道如何解决它。

这是我的`Httpurlconnection`：

```
public class MainActivity extends Activity {
    private ImageView m_imgView;
    private String m_strImgURL = "http://wptrafficanalyzer.in/blog/wp-content/uploads/2012/09/http_url_connection_download_image_new_android_project.png";
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        m_imgView = (ImageView) findViewById(R.id.myImageView);
        m_imgView.setImageBitmap(GetURLBitmap());
        m_imgView.setOnTouchListener(new zoom ());
    }
    private Bitmap GetURLBitmap() {
        URL url = null;
        Bitmap bmp = null;

    try {
        url = new URL(m_strImgURL);         
    } catch (MalformedURLException e) {
        e.printStackTrace();
    }

    try {
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.connect();

        InputStream in = conn.getInputStream();
        bmp = BitmapFactory.decodeStream(in);
        in.close();
    } catch (IOException e) {
        e.printStackTrace();
    }

    return bmp;
}
} 
```

这是我的`Zoom`：

```
public class zoom implements OnTouchListener {   
        Matrix matrix = new Matrix();   
        Matrix savedMatrix = new Matrix();   
        static final int NONE = 0;   
        static final int DRAG = 1;   
        static final int ZOOM = 2;   
        int mode = NONE;   
        PointF start = new PointF();   
        PointF mid = new PointF();   
        float oldDist = 1f;   
        @Override   
        public boolean onTouch(View v, MotionEvent event) {   
                ImageView view = (ImageView) v;   
                switch (event.getAction() & MotionEvent.ACTION_MASK) {   
                case MotionEvent.ACTION_DOWN:   
                        matrix.set(view.getImageMatrix());   
                        savedMatrix.set(matrix);   
                        start.set(event.getX(), event.getY());   
                        mode = DRAG;   

                    break;   
            case MotionEvent.ACTION_POINTER_DOWN:   
                    oldDist = spacing(event);   
                    if (oldDist > 10f) {   
                            savedMatrix.set(matrix);   
                            midPoint(mid, event);   
                            mode = ZOOM;   
                    }   
                    break;   
            case MotionEvent.ACTION_UP:   
            case MotionEvent.ACTION_POINTER_UP:   
                    mode = NONE;   
                    break;   
            case MotionEvent.ACTION_MOVE:   
                    if (mode == DRAG) {   
                            matrix.set(savedMatrix);   
                            matrix.postTranslate(event.getX() - start.x, event.getY()   
                                            - start.y);   
                    } else if (mode == ZOOM) {   
                            float newDist = spacing(event);   
                            if (newDist > 10f) {   
                                    matrix.set(savedMatrix);   
                                    float scale = newDist / oldDist;   
                                    matrix.postScale(scale, scale, mid.x, mid.y);   
                            }   
                    }   
                    break;   
            }   
            view.setImageMatrix(matrix);   
            return true;   
    }   

    private float spacing(MotionEvent event) {   
            float x = event.getX(0) - event.getX(1);   
            float y = event.getY(0) - event.getY(1);   
            return FloatMath.sqrt(x * x + y * y);   
    }   

    private void midPoint(PointF point, MotionEvent event) {   
            float x = event.getX(0) + event.getX(1);   
            float y = event.getY(0) + event.getY(1);   
            point.set(x / 2, y / 2);   
    }   
} 
```

# unit-testing - 您如何正确测试测试类中的循环查询？

> ID：12713407
> 
> 赞同：1
> 
> 时间：2012-10-03T17:08:46.033
> 
> 标签：unit-testing, class, for-loop, salesforce

我有一个可安排的课程，每晚会被叫一次。我已经匿名运行代码，一切正常。我遇到的问题是我无法对其进行适当的测试覆盖！我编写了一个我认为应该可以工作的测试类，但由于某种原因，我的 for 循环中的任何行都没有被覆盖。

我认为这是因为这些查询没有返回任何数据，但是应该返回数千条记录。我已经在生产环境中运行了查询，没有任何问题。

在可调度的类中运行查询是否有单独的进程？

**这是我的课的一部分：**

```
global class UpdateUnitPrice  implements Schedulable{

    global void execute(SchedulableContext sc){

        // OwnerId -> List of Strings with Row Contents
        Map<Id,Map<Id,Map<String,String>>> updateContainer = new Map<Id,Map<Id,Map<String,String>>>{};  // Covered

        List<Id> ownerContainer = new List<Id>{};  // Covered

        String EmailMessage;     // Covered
        String EmailLine;        // Covered
        String EmailAddedLines;  // Covered

        String CurrentEmailLine; // Covered
        String NewEmailLine;     // Covered

        List<Id> opportunityList = new List<Id>{};  // Covered

        for(Opportunity thisOpp :[SELECT Id,Name FROM Opportunity WHERE Order_Proposed__c = null])
        {
            // Thousands of records should be returned

            opportunityList.add(thisOpp.Id); // NOT COVERED!!

        }

        List<OpportunityLineItem> OppLineItemList = new List<OpportunityLineItem>{};  // Covered

        for(OpportunityLineItem thisOppProd : [SELECT Id,OpportunityId,Opportunity.OwnerId,Opportunity.Name,Product_Name__c,UnitPrice,ListPrice 
                                               FROM OpportunityLineItem 
                                               WHERE OpportunityId IN :opportunityList
                                               AND UnitPrice_lt_ListPrice__c = 'True'
                                               ORDER BY OpportunityId ASC])
        {

            . . . // NO LINES COVERED WITHIN THIS LOOP

        }

      . . .

    }

} 
```

**这是我的测试课：**

```
@isTest
private class UpdateUnitPriceTest {

    static testMethod void myUnitTest() {

        Test.startTest();

        // Schedule the test job 
        String jobId = System.schedule('UpdateUnitPrice','0 0 0 3 9 ? 2022',new UpdateUnitPrice());

        // Get the information from the CronTrigger API object
        CronTrigger ct = [SELECT Id, CronExpression, TimesTriggered, NextFireTime FROM CronTrigger WHERE id = :jobId];

        // Verify the expressions are the same
        System.assertEquals(ct.CronExpression,'0 0 0 3 9 ? 2022');

        // Verify the job has not run
        System.assertEquals(0, ct.TimesTriggered);

        // Verify the next time the job will run
        System.assertEquals('2022-09-03 00:00:00', String.valueOf(ct.NextFireTime));

        Test.stopTest();

    }
} 
```

我是否应该在这些 for 循环中专门引用某些内容以供它们触发？这个类应该能够自己运行所有东西，而无需插入记录进行测试。我错过了什么？

提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T18:27:54.360

API 24.0 中添加了一个可爱的功能，它要求测试类包含一小行（新）代码，以便查看查询的数据。我不知道为什么要这样做，但它确实让我感到困惑。

***为了让我们的测试类正常运行，它们现在必须在顶部具有以下内容：***

```
@isTest (SeeAllData = true) 
```

***以前，只需要：***

```
@isTest 
```

**您可以在此处阅读有关测试类和这个新“功能”的更多信息：[Apex 测试类注释](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_annotation_isTest.htm "Apex 类注释 isTest")**

# android - ListFragment 中的手势检测

> ID：12713409
> 
> 赞同：4
> 
> 时间：2012-10-03T17:08:48.997
> 
> 标签：android, android-listfragment, gesturedetector

我有一个用 ContentProvider 填充的**ListFragment 。**

我需要为它们中的每一个附加一个**手势监听**器，以便当用户向右滑动时，该项目会从列表中删除。

以下是我目前在我的 ListFragment 中的所有内容。

```
@Override
public void onListItemClick(ListView l, View v, int position, long id) {

 String selection = l.getItemAtPosition(position).toString();
 Toast.makeText(v.getContext(), selection + "", Toast.LENGTH_LONG).show();
 Log.d("TodoListFragment", selection+ "");

} 
```

我将如何附加手势检测和监听？

我做了一些研究，发现了这段代码：

```
class MyGestureDetector extends SimpleOnGestureListener {
    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
        try {
            if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
                return false;
            // right to left swipe
            if(e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
               Log.d("Swipe", "Left");
            }  else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                Log.d("Swipe", "Right");
            }
        } catch (Exception e) {
            // nothing
        }
        return false;
    }

} 
```

谁能告诉我如何实现它？（不是删除部分，只是实现）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-26T09:03:06.037

我在使用以下答案解决问题的过程中遇到了一些问题。

它完美地工作。

```
class SideIndexGestureListener extends GestureDetector.SimpleOnGestureListener {
        @Override
        public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) {

            Log.d("Scrolled- fragment ", "Scrolling");
            return super.onScroll(e1, e2, distanceX, distanceY);
        }
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        final GestureDetector gestureDetector = new GestureDetector(getActivity(),
                new SideIndexGestureListener());
        View.OnTouchListener gestureListener = new View.OnTouchListener() {
            public boolean onTouch(View v, MotionEvent event) {
                return gestureDetector.onTouchEvent(event);
            }
        };
        getListView().setOnTouchListener(gestureListener);
        try {

           adapter = new ArrayAdapter<String>(getActivity(),
                    android.R.layout.simple_list_item_single_choice, elementos);
            setListAdapter(adapter);
            getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE);

        }catch (Exception e){

        } 
```

# ruby - Ruby 1.9.3 - CSV.table 如何知道 CSV 文件中是否没有标题？

> ID：12713410
> 
> 赞同：9
> 
> 时间：2012-10-03T17:08:48.567
> 
> 标签：ruby, csv

我一直在做一些测试`CSV.table`。我有两个几乎相同的小 CSV 文件，但是其中一个缺少标题行。

当我`CSV.table`对带有标题行的 CSV 文件运行时，一切都按预期工作。

当我对没有标题行的 CSV 文件运行它时，我得到：

```
NoMethodError: undefined method `encode' for nil:NilClass 
```

我尝试了不同类型的数据，不同类型的标题，并得到相同的结果。

我对它的魔力很好奇`CSV.table`。如果我使用`CSV.parse`设置为 true 的标题，那么无论如何它总是使第一行成为标题。所以，我一直`CSV.table`在检查正在导入的 CSV 文件是否有标题行，但我对此不太满意，因为我不明白它是否或何时会或不会像我使用它的方式工作。

```
begin
  CSV.table(csv_file_path)
rescue
  # Add error to log or something.
end 
```

有人知道吗？

PS我已经阅读了这个以及它在每种方法上提供的源代码 - [http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-06T22:16:18.293

没有任何魔法，一般来说它对你不起作用。

正如您[从源代码](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html#method-c-table)中看到的那样，`table`实际上只是调用`read`. `headers: true`但它也将标头转换为符号 ( `header_converters: :symbol`)，这是它看起来有效的关键。

您会收到没有标题的错误，因为您的第一行数据中有一个空白列（类似于`a,b,,d,e`）。空白被读取为`nil`，并且由于`nil`无法转换为符号，因此它会爆炸。

尝试使用第一行中没有空白的一些数据 - 您会看到它`table`将该行数据视为标题，就像任何其他方法一样。

# vb.net - VB.Net 和通过接口类型的变量访问

> ID：12713415
> 
> 赞同：0
> 
> 时间：2012-10-03T17:09:17.987
> 
> 标签：vb.net

对于声明为该类实现的接口之一的类型的变量，如何使类的属性在继承类中可用？

到目前为止，我所做的是`MyAbstract`使用关键字 MustInherit 创建一个抽象类，并在继承类`MyInheritingClass`中添加了继承，然后是抽象类的名称。现在这一切都很好，但是在我的继承类中，如果我在该类上创建一个接口`MyInterface`并在我的代码中的其他地方使用该接口，然后我发现我看不到抽象类的属性，在用它声明的变量上界面。

我在这里做错了什么，还是我需要做其他事情？

一个例子如下：

```
Public MustInherit Class MyAbstract
    Private _myString as String
    Public Property CommonString as String
        Get
            Return _myString
        End Get
        Set (value as String)
            _myString = value
        End Set
    End Property
End Class

Public Class MyInheritingClass
    Inherits MyAbstract
    Implements MyInterface

    Sub MySub(myParameter As MyInterface)
        myParameter.CommonString = "abc" ' compiler error - CommonString is not a member of MyInterface.
    End Sub

    'Other properties and methods go here!'
End Class 
```

所以，这就是我正在做的事情，但是当我使用 时`MyInterface`，我看不到我的抽象类的属性！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T18:47:58.770

除非我完全误解了你的问题，否则我不确定你为什么对这种行为感到困惑。不仅是它应该如何工作，而且这也是它在 c# 中的工作方式。例如：

```
class Program
{
    private abstract class MyAbstract
    {
        private string _myString;
        public string CommonString
        {
            get { return _myString; }
            set { _myString = value; }
        }
    }

    private interface MyInterface
    {
        string UncommonString { get; set; }
    }

    private class MyInheritedClass : MyAbstract, MyInterface
    {
        private string _uncommonString;
        public string UncommonString
        {
            get { return _uncommonString; }
            set { _uncommonString = value; }
        }
    }

    static void Main(string[] args)
    {
        MyInterface test = new MyInheritedClass();
        string compile = test.UncommonString;
        string doesntCompile = test.CommonString;  // This line fails to compile
    }
} 
```

当您通过任何接口或基类访问对象时，您将只能访问由该接口或基类公开的成员。如果您需要访问 的成员`MyAbstract`，则需要将该对象强制转换为`MyAbstract`或`MyInheritedClass`。这在两种语言中都是正确的。

# c# - 如何在 WinRT 应用程序中使用 nUnit 测试？

> ID：12713417
> 
> 赞同：2
> 
> 时间：2012-10-03T17:09:33.067
> 
> 标签：c#, nunit, winrt-async

我不知道如何在 WinRT 应用程序（地铁）中使用 nUnit。我编写此代码并运行测试（使用 Resharper 测试运行器）。测试通过了。为什么？

```
using System.Threading.Tasks;
using NUnit.Framework;
namespace UnitTestInWinRT
{
    [TestFixture]
    public class NUnitClassTest
    {
        [Test]
        public void TestnUnitAsyncTest()
        {
            var number = GetNumberAsync(7);
            number.ContinueWith(n => Assert.AreEqual("string is 6", n.Result));
        }
        public Task<string> GetNumberAsync(int n)
        {
            return Task.Run(() => "string is " + n);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T10:26:02.230

问题是：

您使用[ContinueWith](http://msdn.microsoft.com/en-us/library/dd270696.aspx)方法。

> 在目标任务完成时创建一个异步执行的延续。

因此，NUnit 在其他线程中运行您的 Lamba，并结束测试方法。`AssertionExcecption`发生在其他线程中，这就是测试通过的原因。

如果您在同一个线程中运行它，测试将按预期失败。

```
[TestFixture]
public class NUnitClassTest
{
    [Test]
    public void TestnUnitAsyncTest()
    {
        var number = GetNumberAsync(7);
        number.Wait();
        Assert.AreEqual("string is 6", number.Result);
    }

    public Task<string> GetNumberAsync(int n)
    {
        return Task.Run(() => "string is " + n);
    }
} 
```

# glassfish - 我可以限制 glassfish 虚拟服务器可用的 Web 服务吗

> ID：12713420
> 
> 赞同：0
> 
> 时间：2012-10-03T17:09:42.763
> 
> 标签：glassfish

我对很多网络服务都很熟悉。我现在需要将其中一些暴露给第三者。为了管理连接，我打算创建一个虚拟服务器，但似乎我必须让整个耳朵都可用。

我想做的是创建虚拟服务器并说它只能访问这些少数/特定的 Web 服务。

使用 Glassfish 3.12

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T06:05:40.067

您必须在 Web 服务中实现身份验证和授权机制，因此只有被允许的方可以访问它们。

# xamarin.ios - 使用 mdtool 编译 MonoTouch 应用程序时，查找 Mono for Android SDK 时出错

> ID：12713423
> 
> 赞同：3
> 
> 时间：2012-10-03T17:09:51.377
> 
> 标签：xamarin.ios

我正在尝试从命令行编译一个单点触控应用程序，作为自动构建的一部分。当我运行以下命令时：

```
/Applications/MonoDevelop.app/Contents/MacOS/mdtool -v build "--configuration:Debug:iPhone --project:App.Project" /Users/james/Development/App/App.sln 
```

我得到输出：

```
MonoDevelop Build Tool
ERROR [2012-10-03 18:03:33Z]: ANDROID: Error finding Mono for Android SDK
System.ArgumentNullException: Argument cannot be null.
Parameter name: path1
  at System.IO.Path.Combine (System.String path1, System.String path2) [0x00000] in <filename unknown>:0 
  at Xamarin.AndroidTools.MonoDroidSdkUnix.FindFramework (System.String sdk) [0x00000] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.0.4-branch/ea010826/source/md-addins/MonoDevelop.MonoDroid/external/androidtools/Xamarin.AndroidTools/Sdks/MonoDroidSdkUnix.cs:51 
  at Xamarin.AndroidTools.MonoDroidSdkBase.Initialize (System.String mfaSdkPath, System.String mfaFrameworkPath) [0x0000e] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.0.4-branch/ea010826/source/md-addins/MonoDevelop.MonoDroid/external/androidtools/Xamarin.AndroidTools/Sdks/MonoDroidSdkBase.cs:56 
  at Xamarin.AndroidTools.MonoDroidSdk.Refresh (System.String mfaSdkPath, System.String mfaFrameworkPath) [0x00037] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.0.4-branch/ea010826/source/md-addins/MonoDevelop.MonoDroid/external/androidtools/Xamarin.AndroidTools/MonoDroidSdk.cs:120 
Loading solution: /Users/james/Development/App/App.sln
   Loading solution: /Users/james/Development/App/App.sln
      Loading projects .. 
```

关于如何让 mdtool 使用 MonoTouch 而不是 MonoDroid 编译的任何想法？

附加配置信息：

```
MonoDevelop 3.0.4.7
Runtime:
    Mono 2.10.9 (tarball)
    GTK 2.24.10
    GTK# (2.12.0.0)
    Package version: 210090011
Apple Developer Tools:
     Xcode 4.5 (1839)
     Build 4G182
Monotouch: 6.0.3
Mono for Android: Not Installed 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T18:19:14.967

您可以忽略此错误。它总是会发生，但是当您从 MonoDevelop 中构建时，您看不到它。

# c# - 找到不在我的 WPF 的 exe 路径中的文件？

> ID：12713426
> 
> 赞同：0
> 
> 时间：2012-10-03T17:10:03.833
> 
> 标签：c#, wpf, .net-4.0

我的exe的路径是`c:\dev\source\project1\bin\debug\app.exe`

但我的 XML 文件位于`c:\dev\source\project1\file.xml`

如何在运行时加载 XML 文件，现在我一直在硬编码绝对 url，但我不想这样做。

如果我更改位置或最终用户将文件移动到另一个位置（例如，移动到被调用`file.xml`的子目录下），在这种情况下会发生什么，我是否必须再次更改内容。有没有办法不必担心文件的位置？`project1``sub`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:17:14.280

在您的解决方案资源管理器中，转到设置`Copy to Output Directory`为`Copy Always`或的 XML 文件，`Copy if Newer`这会将 xml 文件的副本放入其中，`c:\dev\source\project1\bin\debug\`并让您的程序引用与 exe 位于同一文件夹中的版本。

![在此处输入图像描述](../Images/a61010bf97eaf8794028f23e0bf30567.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:13:14.390

只需在 app.config 文件中指定 Xml 文件的路径。更改路径时，您不必担心硬编码内容和 EXE 的编译。只需更改配置中的路径，一切都很好。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <appSettings>
    <add key="xmlFile" value="c:\dev\source\project1\file.xml"/>
  </appSettings>
</configuration> 
```

# css - SCSS @import 使用完整路径

> ID：12713430
> 
> 赞同：1
> 
> 时间：2012-10-03T17:10:09.440
> 
> 标签：css, filepath, sass

我目前有一个 Web 应用程序，它在其他库中使用 SCSS、交响乐和学说。它的设置很好，结构很重。

我们目前正在尝试使用 Bootstrap.css 对其进行视觉样式化，但是当我们开始尝试使用 SASS/SCSS @import 函数以便我们可以 @extend 引导类时，它已成为一个相当大的问题。然而，当试图这样做时，它变得有问题。

```
 @import url('/bundles/iccsrpit/sass/css/_bootstrap.scss'); 
```

上面有些工作（在查看 Firebug 时，代码实际上从未包含在 css 文件中。我可以单击路径，它会将我带到文件中。

```
 @import '/bundles/iccsrpit/sass/css/_bootstrap.scss'; 
```

导致 CSS 文件完全中断，我不确定为什么我不能以这种方式访问​​该文件。

如果有人可以提供解决此问题的方法，请提供帮助！

谢谢你，艾瑞德

# c# - 子视图绑定c#中的子模型

> ID：12713433
> 
> 赞同：0
> 
> 时间：2012-10-03T17:10:18.527
> 
> 标签：c#, .net, asp.net-mvc

我有以下主要模型：

```
public class PersonalDetailContainerViewModel {

    public AprobacionViewModel aprobacionPersonal { get; set; }
    public AprobacionViewModel aprobacionMinera { get; set; }

public PersonalDetailContainerViewModel() {
        aprobacionPersonal = new AprobacionViewModel();
        aprobacionMinera = new AprobacionViewModel();
    }
} 
```

子模型：

```
public class AprobacionViewModel {

    [DisplayName("Observación")]
    public string observation { get; set; }
    [DisplayName("Responsable")]
    public string responsable { get; set; }
    [UIHint("DropDownList")]
    [DisplayName("Estado")]
    public IEnumerable<SelectListItem> ListEstado { get; set; }

    public AprobacionViewModel() {
        ListEstado = CommonService.createDropDownListEstado();
    }

} 
```

主视图：

```
@model PersonalDetailContainerViewModel

@Html.Partial("Aprobacion", Model.aprobacionPersonal)
@Html.Partial("Aprobacion", Model.aprobacionMinera) 
```

和......详细视图：

```
@model AprobacionViewModel
<fieldset>
    <legend>Aprobación / Rechazo</legend>
            @Html.EditorFor(m => m.ListEstado, null)<br />
            @Html.EditorFor(m => m.observation, null)<br />
            @Html.EditorFor(m => m.responsable, new { disabled = "disabled" })

</fieldset> 
```

我的问题是，在绑定中，我总是收到 AprobacionViewModel 字段的空值：

```
[HttpPost]
public ActionResult Details(PersonalDetailContainerViewModel model){

    model.aprobacionPersonal.observation //NULL ??
} 
```

可以在没有自定义模型绑定器的子视图中使用子模型吗？

ps：Darin Dimitrov 是我的英雄 :)) 我想要一个粉丝页面，只为点击“我喜欢它！” Darin vous êtes mon heros !! ou est votre page facebook 为 les 粉丝提供服务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T01:45:27.827

`@Html.Partial`渲染元素时不尊重模型层次结构，因此表单元素不会被正确命名，因此不会被模型绑定。

改用`@Html.EditorFor`：

```
@model PersonalDetailContainerViewModel

@Html.EditorFor(model => model.aprobacionPersonal)
@Html.EditorFor(model => model.aprobacionMinera) 
```

用于`Html.Partial`呈现 HTML 内容/布局等 - 不是表单的一部分。

# java - 如何在 web 应用程序中调试 OutOfMemoryException

> ID：12713435
> 
> 赞同：2
> 
> 时间：2012-10-03T17:10:20.493
> 
> 标签：java, performance, spring, jakarta-ee, out-of-memory

我正在尝试调试内存不足错误。当我使用 Jmap 进行堆转储并使用 eclipse Mat 分析结果时 - 我看到以下内容。

```
7,677 instances of "java.lang.Class", loaded by 
"<system class loader>" occupy 48,094,720 (23.99%) bytes. 
```

最大实例：

```
class blah.BlahService$$EnhancerByCGLIB$$4a0a7d43 @ 0x2aaab06d9668 
- 2,067,096 (1.03%) bytes. 
```

BlahService 是一个带有@Service 注解的spring 服务。所有服务类在春季都是单例的——每个 IOC 每个 bean 一个——那么为什么这个类会成为头号嫌疑人。

我也看到

```
One instance of "org.apache.jasper.servlet.JspServlet" loaded by 
"org.apache.catalina.loader.StandardClassLoader @ 0x2aaac17bc260" occupies 42,724,168 
(21.31%) bytes. The memory is accumulated in one instance of 
"java.util.concurrent.ConcurrentHashMap$Segment[]" loaded by "<system class loader>". 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T10:28:35.877

OutOfMemoryError 通常表示以下两个问题之一： 1\. 您的应用程序需要的内存太少。然后，您需要使用 Xmx 启动参数 2 增加服务器的堆大小。或者您的应用程序或它使用的第 3 方库之一中存在内存泄漏。如果没有经验，跟踪内存泄漏并不是一件容易的事。我可以推荐[Plumbr](http://plumbr.eu)。这是一个非常容易使用和精确的监控内存泄漏的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T12:08:51.843

我使用了 java profilers，但我对实际性能调整和内存使用的输出不满意，目前我们已经切换到[java melody](https://code.google.com/p/javamelody/)。这不仅有助于开发和生产系统中的性能优化。Java melody 非常易于集成和配置，在生产中您只需更新 web.xml 即可启用或禁用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T23:22:23.913

是的，当修复它为时已晚时，该错误就会出现，因为一旦堆被填满，JVM就无法做任何事情，因为它无法创建对象来做某事，另一方面，因为你'重新使用 Spring 我猜你正在做一个 Web 系统，在这种情况下，你所要做的就是在 deploy 命令的开头提供更多的堆空间（它类似于'-Xms：256'）并计划了多少资源将需要您的应用程序，因为这是一个事实，如果内存被填满，系统就会崩溃

# c - 如何在 C 中的 UDP 客户端/服务器中为 sento 和 recvfrom 添加延迟

> ID：12713438
> 
> 赞同：4
> 
> 时间：2012-10-03T17:10:21.430
> 
> 标签：c, sockets

对于学校的一个编程项目，我们必须使用 tcp 协议和 udp 协议设计一个基本的客户端/服务器设置。我已经使用 C Socket 库中的 read() 和 write() 让 TCP 工作了。我现在需要创建一个“可靠的 UDP”系统。例如：

“当服务器接收到长度消息时，它将等待最多 500 毫秒以发送该字节数。如果它接收到正确的字节数，它将以包含字符“ACK”的字符串进行响应（常见缩写为确认）。如果在超时期限结束时没有收到正确的字节数，服务器将放弃并静默退出。

我设置了 sendto() 和 recvfrom() 函数，但我不确定如何执行超时功能，以便它只等待 500ms 发送第二个 msg。如果它没有收到“ACK”并重新发送长度 msg + msg 几次，我也必须稍后在客户端执行此操作。我该如何做超时？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T17:29:12.990

在您的程序中添加以下函数并使用它，而不是直接使用 recvfrom 函数。

以下functiong与recvfrom函数的输入参数相同+最后一个超时输入参数

```
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netdb.h>
#include <unistd.h>

int timeout_recvfrom (int sock, char *buf, int *length, struct sockaddr_in *connection, int timeoutinseconds)
{
    fd_set socks;
    struct timeval t;
    FD_ZERO(&socks);
    FD_SET(sock, &socks);
    t.tv_sec = timeoutinseconds;
    if (select(sock + 1, &socks, NULL, NULL, &t) &&
        recvfrom(sock, buf, *length, 0, (struct sockaddr *)connection, length)!=-1)
        {
        return 1;
        }
    else
        return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-04T05:49:01.190

不使用 select 或 poll 的替代方法是使用套接字选项 SO_RCVTIMEO 和 SO_SNDTIMEO

```
tv.tv_sec = 10; /* seconds */
tv.tv_usec = 0;

if(setsockopt(socket, SOL_SOCKET, SO_SNDTIMEO, &tv, sizeof(tv)) < 0)
        printf("Cannot Set SO_SNDTIMEO for socket\n");

if(setsockopt(socket, SOL_SOCKET, SO_RCVTIMEO, &tv, sizeof(tv)) < 0)
        printf("Cannot Set SO_RCVTIMEO for socket\n"); 
```

[SO_RCVTIMEO 和 SO_SNDTIMEO 套接字选项](http://linux.die.net/man/7/socket)

如果您有一个单独的套接字可以读取或写入/写入，那么这是一个更好的选择。如果您正在使用多个套接字并希望继续使用一个完全发送/接收数据的套接字，那么也许 select 会更合适。

# javascript - 空事件监听器：这样可以吗？

> ID：12713439
> 
> 赞同：5
> 
> 时间：2012-10-03T17:10:29.700
> 
> 标签：javascript, jquery, ios, mobile, button

**一些快速背景**

我正在构建一个在某些区域使用 html 网络视图的 iOS 应用程序。我想确保这些页面上的 html 按钮在外观和感觉上都尽可能像 iOS 按钮。为此，我想要一个点击状态，以便在点击时按下 html 按钮。现在在 HTML 中这很容易。您只需为 :active 或 :hover 或其他设置样式。我实际上已经定义了这个。然而，在 iOS 中，这些状态不会随时参与 - 至少在正常情况下是这样。所以我的目标是编写一个小脚本，为按钮添加一个类来改变它在touchstart上的外观。

**问题**

然而，事实证明我不需要那么复杂......纯属偶然，我使用以下代码进行了测试：

```
document.addEventListener('touchstart', function(event) {
    console.log("test");
}, true); 
```

我对 javascript 和 jQuery 非常熟悉，所以我想做的就是检查我的语法并确保在我点击按钮时触发了 eventListener。令我惊讶的是，css 中按钮的 :active 状态被触发（以及 :hover 状态）。该代码...解决了我的问题！

**我的问题**

所以这是我的问题：上面的代码有效吗？我的意思是，这样做不好吗？就好像空的 eventListener 只是触发了桌面浏览器已经提供的行为。使用这种方法有什么问题吗？我是绿色的，但我不想养成坏习惯。如果这是一种不好的编码方式，我不想使用它。

感谢你们能给我的任何见解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:44:12.793

我个人认为空事件侦听器没有任何问题（除了函数调用的开销 --- 这在这里听起来可以忽略不计）。我建议你利用 jQuery 的`noop`功能，但如果你*必须*添加一个事件监听器但让它什么都不做：

```
$(document).on('touchstart', $.noop);

// or

document.addEventListener('touchstart', $.noop); 
```

# python - 反转字形：位图 > 通过自动跟踪的 SVG > 通过 fontforge 的字形

> ID：12713444
> 
> 赞同：6
> 
> 时间：2012-10-03T17:10:41.640
> 
> 标签：python, svg, fonts, fontforge

我正在尝试通过以下方式创建字体/字形：

*   拍摄位图图像
*   使用自动跟踪创建 SVG（在 Linux 上）
*   使用 python-fontforge (glyph.importOutlines(svgfile) ) 将大纲作为字形导入

这工作正常**，除了生成的字形反转**（参见图像）。知道如何防止这种情况，如何反转 SVG 或字形，或类似的东西吗？

源位图： ![源位图](../Images/670723b574d8becb90a853f7d083c2d2.png)

自动跟踪 SVG： ![在此处输入图像描述](../Images/1317b4970bf78d22e4d45aec27177973.png)

结果字体： ![在此处输入图像描述](../Images/7877cc676f0dfa3a976afce76e608e3f.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-07T11:12:40.190

只需使用[potrace](http://potrace.sourceforge.net/)而不是 autotrace 即可解决此问题。

供参考，这些是步骤：

将位图转换为 svg（linux 命令行）：

```
potrace -s sourceimg.bmp 
```

使用 svg 作为字形（python）：

```
import fontforge
font = fontforge.open('blank.sfd')
glyph = font.createMappedChar('A')
glyph.importOutlines('sourceimg.svg')
font.generate('testfont.ttf') 
```

就是这样，下面的结果可以在网站上使用：

CSS：

```
@font-face
{
font-family: testfont;
src: url('testfont.ttf');
} 
```

html:

```
<span style="font-family:testfont; font-weight:normal; color:green;">A</span>
<span style="font-family:testfont; font-weight:bold; color:green;">A</span> 
```

![在此处输入图像描述](../Images/0e99bd8ac224454c70eacf1040bf1eac.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T14:28:15.103

您可以尝试反转路径，不确定 fontforge 中是否有让您这样做的选项，但您可以使用 inkscape（路径 > 反转）来实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T01:22:37.233

看来您的字形是手绘的。如果您想制作具有数十或数百个字形的完整 TTF 字体，那么您可以考虑例如。我用来生成手绘字体的[Scanahand 。](http://www.high-logic.com/font-generator/scanahand.html)它使用一个模板，您可以在该模板上绘制（或粘贴）字母，以便它们位于正确的垂直位置。至少在 [A-Za-z] 中自动计算水平位置（和间距）（将来可能还有其他字母）。

但我很欣赏[您的解决方案](https://stackoverflow.com/a/12768301/1691517)，因为它使用免费或开源工具，并且您几乎可以完全控制所有内容（例如间距）。potrace 和 fontforge 最棒的地方在于，您可以即时完成或提供在线字体创建服务！Potrace 移植到[AS3](http://potrace.sourceforge.net/#other)（它可以工作，我测试过），现在也移植到 JS（[https://github.com/antimatter15/js-potrace](https://github.com/antimatter15/js-potrace)或[https://github.com/dunvi/potrace-js](https://github.com/dunvi/potrace-js)），所以它应该还可以制作一个实时预览窗口，显示当potrace参数变化时矢量化结果如何变化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-24T00:18:02.957

如果有人对使用 Autotrace 执行此操作感到好奇，那是因为具有白色背景的图像的自动跟踪 SVG 的第一个孩子是定义白色背景的路径。我通过编写一个小程序解决了这个问题，该程序在导入之前删除了 SVG 的第一个子项，但您也可以通过编辑字形删除 FontForge 中的矩形。

# php - 基于图像的身份验证

> ID：12713445
> 
> 赞同：-1
> 
> 时间：2012-10-03T17:10:42.710
> 
> 标签：php, javascript, html

是否可以使用 base64 编码的图像创建基于图像的身份验证系统？在 php 或 java 中...我只是想知道这是否可能？..如果可能的话，我可以得到一个简报我应该怎么做？我真的很期待这样做。

```
data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAA......
<img width="110" height="58" title="" alt="" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAAEAYABgAAD//gAfTEVBRCBUZWNobm9s.......> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T18:10:38.303

我建议您改为指示用户上传图像以在系统中对他进行身份验证，请执行以下操作。

允许客户端用户选择一张图片，而不是上传图片并将图片发送到服务器，只需在客户端计算图像的哈希（校验和），并将这个哈希（校验和）发送到服务器。您可以通过计算两个文件的哈希（校验和）来检查用户选择的文件是否与服务器中的文件相同，如果哈希匹配，那么您确定用户选择了正确的图像。另外我建议你做点什么，否则。嗅探器（中间人）有可能获取客户端发送的哈希并使用它来进行自我身份验证。我想在发送之前在散列上加一些盐，以便在发送之前获得文件散列的加密字符串表示。

# javascript - 创建新专辑时描述中的特殊字符

> ID：12713453
> 
> 赞同：0
> 
> 时间：2012-10-03T17:11:18.917
> 
> 标签：javascript, facebook-graph-api, character-encoding, facebook-javascript-sdk

我正在使用 Facebook 的 Graph API 和 JavaScript SDK 创建一个新专辑。在创建带有描述（消息）和名称的新专辑时，会编码特殊字符。但是，当我尝试对字符进行编码时，一旦创建专辑，它们就不会被解码。有没有其他人遇到过这个问题？

## JavaScript

```
/** Example One: Facebook encodes characters **/
var albumName = "Album Name";
var albumDesc = "Description with áéíóú";
FB.api("/me/albums", "post", {message:albumDesc, name:albumName}, function(res) {
     albumID = res.id;
     uploadPhotoToAlbum(albumID);
});

/** Example Two: Facebook does not decode characters **/
var albumName = "Album Name";
var albumDesc = "Description with %C3%A1%C3%A9%C3%AD%C3%B3%C3%BA";
FB.api("/me/albums", "post", {message:albumDesc, name:albumName}, function(res) {
     albumID = res.id;
     uploadPhotoToAlbum(albumID);
});

/** Example Three: Facebook does not decode characters **/
var albumName = "Album Name";
var albumDesc = "Description with &#225;&#233;&#237;&#243;&#250;";
FB.api("/me/albums", "post", {message:albumDesc, name:albumName}, function(res) {
     albumID = res.id;
     uploadPhotoToAlbum(albumID);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T14:39:16.470

对于可能遇到此问题的其他任何人，我发现这是由于文件编码造成的。将文件编码为 UTF-8 后，“示例一”按预期工作。

# javascript - Zebra 条带化到一个表列

> ID：12713454
> 
> 赞同：1
> 
> 时间：2012-10-03T17:11:24.573
> 
> 标签：javascript, jquery, css, tablesorter, zebra-striping

我有一个表，它对表行使用表排序器和斑马条纹。我想在其中一个表 COLUMNS 中添加斑马条纹，以稍微强调一下。像这样：

![我想要做什么的总体思路](../Images/7789d83a50386a12258d7765744247fc.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T17:16:51.830

如果您知道要条带化的列索引，则只能在 CSS 中使用 :nth-of-type 选择器，如下所示：

`tr:nth-of-type(even) td:nth-of-type(3) { background: rgba(0,0,0,0.1); }`

`3`（目标列索引的占位符在哪里使用）

另一种选择是将一个类放在要条带化的列的标题（或第一个 td）上，然后使用 JS 对同一列中的其他 td 进行条带化：

```
var col_to_stripe = $('th.stripe-this-one').index();

$('table.selectively-stripe').find('tr:odd')
  .each(function() {
    $(this).children('td')
      .eq(col_to_stripe)
      .css('background', 'pink');
  }); 
```

该类不是必需的，因为显然您可以像使用纯 CSS 方法一样放置您想要的列索引，但是为了代码的清晰性更好。

在这里演示：http: [//jsbin.com/axutal/2/edit](http://jsbin.com/axutal/2/edit)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T17:20:07.510

检查这个[**链接**](http://jsbin.com/axutal/5/edit)

这可以使用 jQuery 来完成，而无需提供类名或 id。

```
 $('tr:odd  td:nth-child(4)').css('background','#999999'); /* For odd td's */
 $('tr:even td:nth-child(4)').css('background','#DDDDDD'); /* For even td's */ 
```

有关此[jQuery 选择器](http://api.jquery.com/category/selectors/)的更多信息，请访问此[链接](http://api.jquery.com/nth-child-selector/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:15:05.000

对于该列中的 TD，您需要一个额外的类名和相应的 CSS 声明。

# asp.net - 一种语言的用户代理样式覆盖字体

> ID：12713457
> 
> 赞同：1
> 
> 时间：2012-10-03T17:11:25.510
> 
> 标签：asp.net, localization, styles, agent, overriding

我希望找到一些关于追踪缺陷的方向或线索。

我有一个带有 aspx 页面链接的 ul 侧菜单

*当语言仅为法语*时，这些页面的子集以斜体显示菜单项。

发生这种情况时，控制台会显示菜单项的新样式条目：

*继承自 i:*

```
i, cite, em, var, address, dfn {
font-style: italic; 
```

*   受影响的 aspx 页面与未受影响的页面具有相同的标题和样式链接。
*   页面在其他语言中呈现良好
*   Chrome 中存在问题，但资源管理器中不存在
*   aspx 页面上没有内嵌样式
*   即使我在其中添加以下内容作为测试，用户样式也会覆盖我的样式表：

    我{字体样式：无！重要；}

关于什么可能导致用户代理样式优先的任何想法？

# c# - 如何获得由关节移动的刚体的速度？

> ID：12713466
> 
> 赞同：0
> 
> 时间：2012-10-03T17:11:57.107
> 
> 标签：c#, unity3d

我在一个有 2 个对象的项目中工作。一个通过使用 (Transform.position) 编辑位置来移动，另一个在第一个上附加了一个弹簧接头。

这个想法是第二个对象将跟随第一个但是如果运动很小，第二个对象会改变他的颜色。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T14:17:36.317

如果我明白你想要什么，你想根据第二个对象的速度相对于第一个对象的速度来更改第二个对象的*颜色*。

因此，在循环中的某个点（`FixedUpdate`可能是方法），您将测量速度之间差异的大小：

```
var diff = (gameObject1.rigidbody.velocity - gameObject2.rigidbody.velocity).magnitude; 
```

（或用户 sqrMagnitude 性能）

之后，您可能只需要标准化到速度没有差异且差异巨大`diff`的区间内`[0;1]`，然后将其乘以颜色。`0``1`

# c# - 按键手势不起作用

> ID：12713467
> 
> 赞同：0
> 
> 时间：2012-10-03T17:12:04.777
> 
> 标签：c#, wpf, mvvm

我正在开发一个 WPF 应用程序，其中有一个 RibbonWindow 类型的 MainWindow 和（显然）一个 Ribbon 控件；我正在尝试将 KeyGestures 添加到来自 viewmodel 的一些命令中，但无法做到，我已经阅读了很多关于并应用了一些给出的答案的问题和文章，但无法弄清楚出来。

我尝试过的一些事情：

1 从代码隐藏中添加 KeyGesture（甚至使用其他命令进行测试，例如 ApplicationCommands.Close）：

```
private KeyGesture _closeGesture = new KeyGesture(Key.E, ModifierKeys.Control);
private KeyBinding _closeBinding;
//...
public MainWindow()
{
   InitializeComponent();
   _closeBinding = new KeyBinding(ApplicationCommands.Close, _closeGesture);
   this.InputBindings.Add(_closeBinding);
} 
```

2 直接在 XAML 中添加 KeyGesture：

```
<rcl:RibbonWindow.InputBindings>
    <KeyBinding Command="ApplicationCommands.Close" 
                Key="E" Modifiers="Control" />
</rcl:RibbonWindow.InputBindings> 
```

3 使用上述任何方法添加 KeyGesture，但将其绑定到 viewmodel 的命令，甚至使用其中的 KeyGesture 实现 RelayCommand。

我会很感激你能给我的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:28:50.917

我在我的应用程序中使用了底层代码，它工作正常我的 xaml 代码看起来像

```
 <KeyBinding Command="{Binding ExitCommand}"

                    Key="{Binding ExitCommand.GestureKey}"

                    Modifiers="{Binding ExitCommand.GestureModifier}"/> 
```

在我的视图模型中 k public ICommand ExitCommand

```
 {

        get

        {

            if (exitCommand == null)

            {

                exitCommand = new DelegateCommand(Exit);

                exitCommand.GestureKey = Key.X;

                exitCommand.GestureModifier = ModifierKeys.Control;

                exitCommand.MouseGesture = MouseAction.LeftDoubleClick;

            }

            return exitCommand;

        }

    }
 private void Exit()
    {
        Application.Current.Shutdown();
    } 
```

# sql - SQL 能否确定一组可能的列值中的哪些值不存在？

> ID：12713468
> 
> 赞同：0
> 
> 时间：2012-10-03T17:12:05.657
> 
> 标签：sql

我有一个独特的专栏。我还有一组已知的元素，它们是列的可能值。我需要知道哪些可能的值尚未在表中，因此适合插入。

这可以通过 SQL 实现还是需要后处理？

目前，我正在使用“in”运算符来选择列值等于我的集合中的一个元素的所有行。然后我通过后处理从我的集合中删除所有匹配的元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:18:00.990

要完全在 SQL 中执行此操作，您需要创建一个包含一列的单独表。每行包含一个已知元素集合中的一个值。假设该表称为 ElementList 而另一个表称为 Existing：

```
 SELECT * FROM ElementList WHERE Element NOT IN 
    (SELECT DISTINCT Element FROM Existing) 
```

根据您使用的数据库引擎，您可以使用临时表来创建和保存列表，而无需将其永久保存在数据库中。但是，存储允许元素的列表对于限制现有表中的元素列（以及在用户界面中向用户显示允许的元素）是有价值的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:18:43.947

将允许的值粘贴在临时表中`allowed`，然后使用子查询`NOT IN`：

```
SELECT *
FROM allowed
WHERE allowed.val NOT IN (
    SELECT maintable.val
) 
```

一些数据库将允许您“就地”构建表，而不必创建单独的表。例如在 PostgreSQL（任何版本）中：

```
SELECT *
FROM (
    SELECT 'foo'
    UNION ALL SELECT 'bar'
    UNION ALL SELECT 'baz'    -- etc.
) inplace_allowed
WHERE inplace_allowed.val NOT IN (
    SELECT maintable.val
) 
```

更现代的 PostgreSQL 版本（可能还有其他数据库）将允许您使用稍微更好的[VALUES](http://www.postgresql.org/docs/8.2/static/sql-values.html)语法来做同样的事情。

# yii - 带有来自 2 个不相关模型的数据的 Cgridview

> ID：12713472
> 
> 赞同：0
> 
> 时间：2012-10-03T17:12:23.503
> 
> 标签：yii

我正在慢慢推进 yii 不是如何应用这个：我有一个 CGridView 显示来自 3 个相关表的数据我这样做（修改由 crud 生成的默认值：

模型表1

```
public function search()
{
...
...
...

$criteria=new CDbCriteria;

$criteria->with = array('tabla2','tabla3');
$criteria->together = true;
$criteria->addInCondition('t.idtb1',1,3,5,6,7);
$criteria->compare('idtb2',$this->idtb2);
$criteria->compare('date',$this->date,true);
$criteria->compare('tabla2.codigo',$this->codigo,true);
$criteria->compare('tabla3.description',$this->descrip,true);

return new CActiveDataProvider($this, array(
                        'criteria'=>$criteria,  
));
} 
```

风景

```
...
...
...
<?php $this->widget('zii.widgets.grid.CGridView', array(
        'id'=>'redeemed-grid',
        'dataProvider'=>$model->search(),
        'filter'=>$model,
        'columns'=>array(        
        array(
            'name'=>'codigo',
            'value'=>'$data->tabla2->codigo',         
        ),
        array(
            'name'=>'description',
            'value'=>'$data->tabla3->descrip',         
        ), 
```

这向我展示了一切都很完美。问题是我想使用另外两个不相关的表，它们是 tabla4 和 tabla5，并将两个表中的数据聚合到 Cgridview。可以将数据链接到 table1 与 tabla4 和 tabla5 无关吗？

问候和感谢

# ruby-on-rails - 将 URL 参数添加到 form_tag

> ID：12713473
> 
> 赞同：0
> 
> 时间：2012-10-03T17:12:28.667
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想在 a 中合并 URL 参数`form_tag`，但我发现我无法指定参数是什么，因为它们被覆盖了。传递参数的目的是提供过滤和排序变量，因此，我希望它们在 URL 中可见而不是隐藏。

我最接近的是这样做：

```
form_tag( :controller => 'assets',:action => 'index', :params => params.merge(:order => 'name'), :method => :get) do 
```

问题是该`:get`方法只是作为另一个参数传递而不是实际上作为方法传递，因此它解析为`POST`.

我也尝试了以下方法，但也不起作用。

```
form_tag(params.merge(:order => 'name', :method => :get) do 
```

路径是正确的，但是 URL 参数的格式很奇怪，因为您看到参数没有以 a 为前缀`&`，但是在提交表单时仍然丢失了。

```
action="/assets?commit=Filter&amp;order=name&amp;utf8=%E2%9C%93" method="get" 
```

这是覆盖参数的另一个示例。以下代码将生成表单代码的底层元素，但将删除参数。

```
form_tag(url_for(:order => 'name'), :method => :get) do 
```

底层代码，参数在提交时不会被传递：

```
action="/asset_ratings?order=name" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T21:28:38.603

根据我的经验，在表单中使用“隐藏”输入标签是通常的方式：

[http://apidock.com/rails/ActionView/Helpers/FormTagHelper/hidden_​​field_tag](http://apidock.com/rails/ActionView/Helpers/FormTagHelper/hidden_field_tag)

# hibernate - 多租户解析为错误的租户标识符 EJB + JPA + HIBERNATE

> ID：12713474
> 
> 赞同：1
> 
> 时间：2012-10-03T17:12:30.173
> 
> 标签：hibernate, jpa, ejb, entitymanager, multi-tenant

我在使用 GlassFish 3.1.2 作为 Java EE 容器使用 Hibernate 4.1.7 和 EJB 3.1 实现多租户应用程序时遇到问题 目前有一个实现 org.hibernate.context.spi.CurrentTenantIdentifierResolver 的类，它标识登录的租户获取使用此代码登录的用户：

```
@Override
public String resolveCurrentTenantIdentifier() {
    try {
        SessionContext context = ServiceLocator.locate(SessionEjbContext.class).getSessionContext();

        String userName = context.getCallerPrincipal().getName();

        AppLogger.info("current tenant identifier [" + userName + "]");

        return userName;
    } catch (Throwable e) {
        AppLogger.info("erro lookup");
    }

    return "default";
} 
```

SessionContext.class 是这样实现的

```
@Stateful
@SessionScoped
public class SessionEjbContext {

    @Resource
    private SessionContext sessionContext;

    public SessionContext getSessionContext() {
        return sessionContext;
    }
} 
```

然后将 id 提供给扩展 org.hibernate.service.jdbc.connections.spi.AbstractMultiTenantConnectionProvider 的类，该类实现 ConnectionProvider selectConnectionProvider(String tenantIdentifier) 方法，并且必须返回一个 c3p0 ConnectionProvider 对象才能使用。

真正的问题是：当用户 user1 对系统进行身份验证时，db 连接正常。但是当 user2 进行身份验证时，ConnectionProvider selectConnectionProvider(String tenantIdentifier) 方法接收的参数是 user1，而不是 user2，导致我们选择与 user1 相同的数据库。

EntityManager 是使用 PersistenceContextType.EXTENDED 注释实现的，这会导致问题吗？也许它正在重用有关第一个用户的信息！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-04T07:01:48.103

根据各种帖子，对有状态 bean 的 JNDI 查找可以创建 bean 的新实例。相反，为调用resolveCurrentTenantIdentifier() 返回相同的bean。请检查服务定位器和 JNDI 查找方法。JNDI 库缓存对象实例是一种常见的行为。正如您调用 JNDI 查找对应于 user1 的 SessionEjbContext 一样，它可能已被缓存并为所有后续调用返回。

# magento - magento 创建自己的包或使用默认值

> ID：12713475
> 
> 赞同：4
> 
> 时间：2012-10-03T17:12:36.580
> 
> 标签：magento, themes, installation, packages

我喜欢创建一个新包的主要原因是它允许您在商店主题和默认捆绑的 Magento 主题之间保持清晰的分离。另一方面，大多数扩展将布局和模板文件安装到**app/design/frontend/default/default/**并且如果您的主题安装在默认包下，magento 将找到扩展前端文件，否则您必须将扩展文件复制到**应用程序/设计/前端/包/默认/**始终。所以使用你自己的包需要做更多的工作。

我很想知道我是否遗漏了其他任何东西，那么在 Magento 中创建自己的主题包而不是使用默认包有什么好处？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-03T17:50:04.923

首先，创建一个新包是 Magento 官方用户指南需要做的事情。

[http://info.magento.com/rs/magentocommerce/images/MagentoDesignGuide.pdf](http://info.magento.com/rs/magentocommerce/images/MagentoDesignGuide.pdf)

它是这样说的：“请忽略指示您在默认设计包中创建自定义主题或直接在默认/默认目录中编辑文件的遗留 Magento 说明和教程。相反，提供最佳升级的方法您的主题的路径和对意外更改的最大保护是创建一个新的设计包并在其中创建您的自定义主题。”

我个人创建新包的逻辑是，如果 Magento 需要很少的商店视图并且它们有差异，我需要有自己的“默认”主题，这正是我通过创建自己的包得到的（Magento 将在 my_theme 中查找文件自定义设计包中的主题，然后在默认主题中，然后回退到基本包）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:58:46.680

如果您使用默认/默认，并且您使用的第三方扩展将它们的文件放在默认/默认中，那么您不能覆盖这些文件 - 您必须直接编辑它们。

所以，由

1.  修复供应商/上游分支中的第三方扩展
2.  使用你自己的包

您只能覆盖您的包中需要的模板/布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T11:47:26.660

/app/design 和 /skin 两个文件夹是相同的（可以说是镜像）。将所有的 css、图像文件保存在 /skin/your_theme 目录下，将 .phtml 用于布局的 /app/design/your_theme 文件夹中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T16:48:59.367

从我的角度来看，默认/默认包的设计很糟糕。如果您使用自己的包，则扩展不能使用您的默认目录（？对吗？）。我建议添加一个字段 default-package。

我现在使用这个解决方法 - config.xml：

```
 <core>
            <rewrite>
                <design_package>Your_Extension_Model_Design_Package</design_package>
            </rewrite>
    </core> 
```

模型/设计/Package.php

```
 class Your_Extension_Model_Design_Package extends Mage_Core_Model_Design_Package
    {
    /**
    * Use this one to get existing file name with fallback to default
    *
    * $params['_type'] is required
    *
    * @param string $file
    * @param array $params
    * @return string
    */
   public function getFilename($file, array $params)
   {
    Varien_Profiler::start(__METHOD__);
    $this->updateParamDefaults($params);
    $result = $this->_fallback($file, $params, array(
        array(),
        //'_package' is new. Uses this package when looking for default theme
        array('_theme' => $this->getFallbackTheme()),
        array('_theme' => self::DEFAULT_THEME, '_package' => 'default'),
    ));
    Varien_Profiler::stop(__METHOD__);
    return $result;
    }
    } 
```

# c# - C# SQL 需要在 WHERE 子句中包含 Profile

> ID：12713476
> 
> 赞同：0
> 
> 时间：2012-10-03T17:12:38.823
> 
> 标签：c#, sql

我是 .NET 的新手，需要编写一条 SQL 语句。它需要阅读类似的内容

```
"SELECT Title, Post, CONVERT(varchar, PostDate, 107) AS DatePosted FROM Posts WHERE RepID = " + Profile("RepID"); 
```

我需要能够从配置文件中获取 RepID 的值。当我在我的代码中使用上述语句时，我收到一个编译器错误，即 Profile 在当前上下文中不存在。我加了

```
using System.Web.Profile; 
```

但我仍然得到错误。我需要在 where 子句中包含 RepID 做什么？我希望我正确地引用了配置文件。我认为这是安全数据库中的一个设置。我是新手，我没有设置数据库，所以请耐心等待。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:45:36.390

找到了我要找的东西。这是解决方案：

```
ProfileCommon profile = (ProfileCommon)HttpContext.Current.Profile;
string sql = "SELECT Title, Post, CONVERT(varchar, PostDate, 107) AS DatePosted FROM Posts WHERE RepID = " + profile.RepID; 
```

希望这也可以帮助那些试图解决这个问题的人。

# grails - Grails：如何在标签库中使用请求范围服务？

> ID：12713479
> 
> 赞同：3
> 
> 时间：2012-10-03T17:12:59.697
> 
> 标签：grails, taglib

我对 Grails 社区比较陌生，但我已经喜欢该引擎所提供的功能。目前，我正在实现一个自定义标签库，以便轻松地在我们的页面上进行标准设计。但是，为了实用目的（例如过滤数据）和存储关于我的标签的请求级元数据（例如计数器、父/子关系），我需要一种调用辅助函数的方法。

我尝试了两种解决方案：

首先：我创建了一个服务，将其范围设置为“请求”

```
package myapp

class CustomTagService {
    static scope = 'request'
    def data = []

    def add(localData) {
        data.add(localData)
    }
} 
```

但是，当我尝试将它注入我的标签库时

```
package myapp

class MyTagLib {
    def customTagService

    def myTag = { attrs, body ->
        customTagService.add(attrs)
    }

} 
```

引擎因引用请求范围而对我大喊大叫（经过长时间痛苦的堆栈跟踪）：“**范围'请求'对于当前线程不活动；如果您打算从单例中引用它，请考虑为该 bean 定义一个范围代理**”

第二：我知道 pageScope 在标签闭包内可供我使用，并且我之前已经利用过它。但是，对于我想要的结构，封装将是更可取的。

如果我走错了路，请告诉我。我们欢迎所有的建议！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T18:37:37.690

您不能在单例 bean 中使用作用域 bean，因为单例 bean（包括标记库）是在启动时在没有活动请求时创建的。而是使用作用域代理（有点复杂），或者`ApplicationContext`在有活动请求时在运行时从 for each use 获取 bean：

```
package myapp

class MyTagLib {

   def grailsApplication

   def myTag = { attrs, body ->
      customTagService.add(attrs)
   }

   private getCustomTagService() {
       grailsApplication.mainContext.customTagService
   }
} 
```

# symfony - Doctrine - ManyToMany 自引用关联 + 在子元素上嵌套 toArray()

> ID：12713484
> 
> 赞同：2
> 
> 时间：2012-10-03T17:13:16.290
> 
> 标签：symfony, doctrine-orm, many-to-many, associations, self-reference

我正在尝试按照 Doctrine 文档在我的 Symfony 2.1 项目中执行多对多自引用关联：http: [//docs.doctrine-project.org/en/latest/reference/association-mapping.html#many-to-多自引用](http://docs.doctrine-project.org/en/latest/reference/association-mapping.html#many-to-many-self-referencing)

我的用例是我正在开发一个 CMS，并且我正在添加拥有相关内容项的能力。例如：我可以在网站上有一个侧边栏，它会说这段内容 X 与 Y 和 Z 相关。类似地，在出现内容 Y 的页面上，它说它与内容项 X 相关。

在我的测试中，使用它在内容项之间添加新关系失败了，因为它达到了 PHP 的最大嵌套级别 100，因为它在当前内容项上运行 toArray()，然后在相关内容项上再次运行，依此类推。

我在 SO 上看到了许多关于多对多自引用学说关联的类似问题，但没有一个具有足够完整的代码来了解其他人是如何管理这个问题的。有人可以帮忙吗？

## 我的内容实体：

```
/**
 * @ORM\MappedSuperclass
 * @ORM\Table(name="content")
 * @ORM\Entity(repositoryClass="CMS\Bundle\Common\ContentBundle\Entity\ContentRepository")
 * @ORM\InheritanceType("JOINED")
 */
abstract class content implements ContentInterface
{
    /**
     * @var int $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string $title
     *
     * @ORM\Column(name="title", type="string", length=255)
     * @Assert\NotBlank()
     */
    private $title;

    // Other class properties

    /**
     * @var array
     *
     * @ORM\ManyToMany(targetEntity="Content", cascade={"persist"})
     * @ORM\JoinTable(name="content_relation",
     *      joinColumns={@ORM\JoinColumn(name="relation_id", referencedColumnName="id")},
     *      inverseJoinColumns={
     *          @ORM\JoinColumn(name="related_content_id", referencedColumnName="id")
     *      })
     **/
    private $related;

    public function __construct() 
    {
        $this->related = new ArrayCollection();
    }

    // Other getters & setters for class properties

    /**
     * @return array
     */
    public function getRelated()
    {
    return $this->related;
    }

    /**
     * @param Content $relation
     */
    public function addRelation(Content $relation)
    {
        $this->related->add($relation);
        $this->related->add($this);
    }

    /**
    * @return array
    */
    public function toArray()
    {
        $related = array();
        foreach($this->getRelated() as $relatedItem) {
        $related[] = $relatedItem->toArray();
    }

    return array(
        'type' => static::getType(),
        'id' => $this->id,
        'title' => $this->title,
        ....
        'related' => $related
    );
} 
```

## 在用于管理相关内容数据的 RelationsController 中，我像这样使用它：

```
/**
 * Creates a new relation to a content item
 * 
 * @Route("{_locale}/content/{id}/related", name="relation_add")
 * @Method("POST")
 */
public function addAction(Request $request, $id)
{
    // Validation and error checking
    // $entity is loaded by the repository manager doing a find on the passed $id
    $entity->addRelation($relation);

    $em = $this->getEntityManager();
    $em->persist($entity);
    $em->persist($relation);
    $em->flush();

    $response = $relation->toArray();

    return new JsonResponse($response, 201);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T13:11:35.810

对此的解决方法是使用[JMSSerializerBundle](http://jmsyst.com/bundles/JMSSerializerBundle)将实体编码为 JSON，而不是使用 toArray 方法并将 addRelation 函数更改为：

```
/**
 * @param Content $relation
 */
public function addRelation(Content $relation)
{
    $this->related[] = $relation;

    if (! $relation->getRelated()->contains($this)) {
        $relation->addRelation($this);
    }
} 
```

# python - numpy 保存/加载损坏数组

> ID：12713486
> 
> 赞同：9
> 
> 时间：2012-10-03T17:13:18.947
> 
> 标签：python, numpy, save, large-data

我正在尝试保存一个大型 numpy 数组并重新加载它。使用`numpy.save`and `numpy.load`，数组值被破坏/改变。数组预保存和加载后的形状和数据类型是相同的，但加载后数组的绝大多数值都归零。数组是 (22915,22915)，值是 float64，将 3.94 gb 作为 .npy 文件，数据条目平均约为 0.1（不是可能合理转换为零的微小浮点数）。我正在使用 numpy 1.5.1。

任何有关为什么会发生这种腐败的帮助将不胜感激，因为我不知所措。下面是一些提供上述声明证据的代码。

```
In [7]: m
Out[7]: 
      array([[ 0\.     ,  0.02023,  0.00703, ...,  0.02362,  0.02939,  0.03656],
             [ 0.02023,  0\.     ,  0.0135 , ...,  0.04357,  0.04934,  0.05651],
             [ 0.00703,  0.0135 ,  0\.     , ...,  0.03037,  0.03614,  0.04331],
             ..., 
             [ 0.02362,  0.04357,  0.03037, ...,  0\.     ,  0.01797,  0.02514],
             [ 0.02939,  0.04934,  0.03614, ...,  0.01797,  0\.     ,  0.01919],
             [ 0.03656,  0.05651,  0.04331, ...,  0.02514,  0.01919,  0\.     ]])
In [8]: m.shape
Out[8]: (22195, 22195)

In [12]: save('/Users/will/Desktop/m.npy',m)

In [14]: lm = load('/Users/will/Desktop/m.npy')

In [15]: lm
Out[15]: 
       array([[ 0\.     ,  0.02023,  0.00703, ...,  0\.     ,  0\.     ,  0\.     ],
              [ 0\.     ,  0\.     ,  0\.     , ...,  0\.     ,  0\.     ,  0\.     ],
              [ 0\.     ,  0\.     ,  0\.     , ...,  0\.     ,  0\.     ,  0\.     ],
              ..., 
              [ 0\.     ,  0\.     ,  0\.     , ...,  0\.     ,  0\.     ,  0\.     ],
              [ 0\.     ,  0\.     ,  0\.     , ...,  0\.     ,  0\.     ,  0\.     ],
              [ 0\.     ,  0\.     ,  0\.     , ...,  0\.     ,  0\.     ,  0\.     ]])
In [17]: type(lm[0][0])
Out[17]: numpy.float64

In [18]: type(m[0][0])
Out[18]: numpy.float64

In [19]: lm.shape
Out[19]: (22195, 22195) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:02:54.243

这是一个已知[问题](http://projects.scipy.org/numpy/ticket/1505)（请注意，该问题与 numpy 1.4 相关联）。如果您真的无法升级，我的建议是尝试以不同的方式保存（savez、savetxt）。如果 getbuffer 可用，您可以尝试直接写入字节。如果一切都失败了（并且您无法升级），您可以很容易地编写自己的保存功能。

# configuration - 添加链接到 Coova 强制门户的登录页面

> ID：12713488
> 
> 赞同：0
> 
> 时间：2012-10-03T17:13:23.700
> 
> 标签：configuration, portal, openwrt, captivenetwork

我已经建立了一个带有强制门户的 Coova 热点。目前，它被配置为内部热点，并且强制门户的网页是自包含在路由器中的。我能够成功登录、浏览和注销网络。

我想在登录页面中添加一个，点击后将打开我公司的网页（所有这些，在身份验证发生之前）。我在门户中的“登录页面”html 代码中添加了简单的 HTML 代码（如下）。

```
<a href="www.mycompany.com"> My Company </a> 
```

我还在围墙花园中添加了“www.mycompany.com”，以便在身份验证成功之前允许访问。

单击链接时，无法打开所需的网页。它尝试搜索路由器内部的页面。但是如果在浏览器中输入，我可以访问相同的页面。请告诉我如何在将门户用作内部热点时自定义门户。甚至有可能做到这一点吗？

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T19:22:07.427

解决了。​​我必须提供完整的地址作为链接 - “http://mycompany.com”。

# c# - 在 C# 中将格式不正确的字符串转换为 DateTime 格式

> ID：12713489
> 
> 赞同：0
> 
> 时间：2012-10-03T17:13:27.103
> 
> 标签：c#, string, datetime

我有以下字符串：

```
Updated: 15:14 03/10 
```

我希望将其转换为日期时间格式，以便将其插入到 sql server 中的日期时间字段中。

```
string date = 'Updated: 15:14 03/10';
    string updatedTime = date.Split(' ')[0];
    string updatedDate = date.Split(' ')[1];
    string updatedMonth = updatedDate.Split('/')[1];
    string updatedDay = updatedDate.Split('/')[0];
    string updatedYear = DateTime.UtcNow.Year.ToString();
    string updated = updatedYear + '-' + updatedMonth + '-' + updatedDay + ' ' + updatedTime;
DateTime dt = Convert.ToDateTime(updated); 
```

这有更清洁/更有效的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T17:15:54.177

您可以使用[`DateTime.ParseExact`](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx)正确的[格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)。像这样的东西：

```
string date = "Updated: 15:14 03/10";
string modifiedDate = date.Replace("Updated: ", "");
string format = "HH:mm dd/MM";
DateTime parsedDate = DateTime.ParseExact(modifiedDate, format, CultureInfo.CurrentCulture); 
```

**编辑**实际上，您不需要格式字符串中的年份；DateTime 解析器足够聪明，可以假设当前年份。

**编辑#2**如果你想变得厚脸皮，你可以在格式字符串中包含“更新”部分。不过这有点难看，因为您需要转义字符`d`,`t`和`:`.

```
string date = "Updated: 15:14 03/10";
string format = @"Up\da\te\d\: HH:mm dd/MM";
DateTime parsedDate = DateTime.ParseExact(date, format, CultureInfo.CurrentCulture); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T17:17:04.483

总是*那个*形式？如果是这样，看起来你应该能够做到：

```
string trimmed = text.Substring("Updated: ".Length);
DateTime dateTime = DateTime.ParseExact(trimmed, "HH:mm dd/MM",
                                        CultureInfo.InvariantCulture); 
```

这也可能有效，但我还没有尝试过：

```
DateTime dateTime = DateTime.ParseExact(text, "'Updated: 'HH:mm dd/MM",
                                        CultureInfo.InvariantCulture); 
```

顺便说一下，不清楚您期望结果是本地还是 UTC - 您可以通过`DateTimeStyles`.

# css - 盒子阴影被切断

> ID：12713492
> 
> 赞同：36
> 
> 时间：2012-10-03T17:13:46.513
> 
> 标签：css

在使用 CSS3`box-shadow`时，我遇到了一个通常没有的问题。

盒子阴影通常只是在 div 边缘流血，但不会在这个边缘流血。

`box-shadow`在顶部和右侧被切断..

这是我用于 box-shadow 的 css：

```
-moz-box-shadow: 0 0 5px #555;
-webkit-box-shadow: 0 0 5px #555;
 box-shadow: 0 0 5px #555; 
```

干杯

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-10-03T17:16:50.897

问题是您的 center-main div 正在裁剪阴影的边缘。设置`overflow:visible`这个，你应该看到它。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-10-03T17:22:36.003

如果`box-shadow`被截断，请确保`overflow:visible`在包含您的元素的任何 div 上设置。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2019-06-13T11:26:11.323

使用填充 + 负边距，如：

```
.img {
  padding: 10px;
  margin: -10px;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-24T04:57:38.543

我用 IE 多次遇到这个问题，我发现最好的解决方案是在 div 周围使用透明轮廓。这似乎可以防止 IE 剪裁框阴影，即使在 Gecko 和 Webkit 没有剪裁的情况下也是如此。使用大纲来解决这个问题的一大好处是它不会影响 div 的位置。

例如，我有一个 div，我使用**position: absolute**和**bottom: -30px**将它放在相对于其父 div 的某个位置。IE，并且只有 IE，正在切断盒子阴影的顶部和底部。添加此轮廓将其固定，而不会更改位置。

```
outline: 10px solid transparent; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T17:26:01.587

您可以正确设置此样式 img 标签以显示阴影框

```
.img{
  margin:20px;
 -moz-box-shadow: 0 0 5px #555;
  -webkit-box-shadow: 0 0 5px #555;
  box-shadow: 0 0 5px #555;
 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-02T16:46:00.777

您可以使用

```
.img{
    filter: drop-shadow(0 0 5px #555);
} 
```

反而

# database - 用于跟踪编辑历史的数据库架构

> ID：12713494
> 
> 赞同：0
> 
> 时间：2012-10-03T17:13:48.167
> 
> 标签：database

我正在为政府竞赛创建一个问答网站，用户可以在其中提出问题并获得答案。

我需要允许用户像 StackOverflow 一样编辑彼此的问题和答案。问题是我需要存储版本历史记录，以便可以恢复不正确的编辑。

为此，我制作了一个新表并将原始帖子存储在其中，直到成功提交编辑。

如何保留修订历史记录以便显示以前的版本，并在必要时恢复编辑？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T18:20:30.347

您可以通过使用计数器字段定义您的问答表来保留修订历史记录。

```
Question                 Answer
--------                 ------ 
Question ID              Answer ID
Edit counter             Edit counter
Question text            Answer Text 
```

问题 ID 和答案 ID 是自动递增的整数。

当问题或答案首次发布时，编辑计数器为零。第一次编辑后，您写入一个新行，编辑计数器设置为 1。下一次编辑是一个新行，编辑计数器设置为 2。依此类推。

这些表的主要索引是 ID 和编辑计数器。ID 递增，编辑计数器递减。这样，最近的编辑是检索到的第一行。编辑计数器告诉您已进行了多少编辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:27:36.237

不要使用单独的表。如果不使用较新版本的唯一原因是未完成或无效的编辑会话，则依赖数据库中的普通事务。您只需在事务中替换数据库中的文本。只有当编辑被评估为“有效”时，才会提交该事务。否则你回滚事务。

但是，如果您需要所有以前的修订，这在大多数情况下是有意义的，那么仍然将内容保存在一个表中。只需为每个问题或答案的编辑添加一个又一个版本。如果未指定 id，则获取最新的。这样您仍然可以访问所有以前的修订。

# java - 构造函数多次调用

> ID：12713495
> 
> 赞同：0
> 
> 时间：2012-10-03T17:13:51.223
> 
> 标签：java, ajax, jsf-2, primefaces, ajax4jsf

简而言之，这里的问题是当我改变菜单的值时，它在支持 bean 中再次执行后构造函数，然后执行方法 fillAreas 并且我使用了视图范围。

```
<p:selectOneMenu id="governate" value="#{add.selectedGovern}"  style="height:26px; text-align: right; width: 303px;"
                                                     valueChangeListener="#{add.fillAreas}" rendered="#{languageBean.isDefaultLanguage==true}" immediate="true" >  
                                        <f:selectItem itemLabel="---#{prompts._select} ---" itemValue="0"/>
                                        <f:selectItems value="#{add.governrateList}" var="govern" itemLabel="#{govern.governrateName}" itemValue="#{govern.governrateId}" />  
                                        <f:ajax  immediate="true"/>

                                    </p:selectOneMenu> 
```

我能做些什么来防止调用 post-constructor ？如果后构造函数调用一次，为什么每次我从菜单中选择它都会调用它？提前致谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:15:13.203

`<c:forEach>`当视图范围 bean 的属性绑定到标记处理程序（JSTL 、Facelets `<ui:include>`、JSF`<f:validateXXX>`等）的属性或JSF UI 组件（等）的`binding`或属性时，将在每个请求上重新创建视图范围 bean 。`id``<h:someComponent>`

这与[JSF issue 1492](http://java.net/jira/browse/JAVASERVERFACES-1492)有关。您可以通过禁用特定视图的部分状态保存来解决它，或者通过寻找替代方法来实现所需的功能需求。

### 也可以看看：

*   [JSF 2.0 中的通信 -`@ViewScoped`在标记处理程序中失败](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ViewScopedFailsInTagHandlers)

# javascript - 将 Javascript 代码重写为 jQuery

> ID：12713499
> 
> 赞同：2
> 
> 时间：2012-10-03T17:14:15.607
> 
> 标签：javascript, jquery

如何在 jQuery 中编写下面的代码并将其应用于所有带有`something`. 我试图让[https://gist.github.com/1129073](https://gist.github.com/1129073)应用于由类指定的多个元素，而不是仅以 id 为目标的单个元素。

更具体地说，**我正在查看[http://jsfiddle.net/fgnass/9BkjZ/](http://jsfiddle.net/fgnass/9BkjZ/)并试图使其在类上工作而不仅仅是一个 id，因此它可以应用于许多元素。**

```
(function(a,b,c){
  setInterval(function(){
    for(
      b=0;
      b<8;c||(a.innerHTML+='<i><b>'),
      a.childNodes[b].style.opacity=(++b-~c)%8*.1+.2);
    c=-~c
  },99)
})(document.getElementsByClassName('something')); 
```

上面的代码仅适用于作为最后一行`someting`使用时的第一个带有类名的元素。`})(document.getElementsByClassName('something')[0]);`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T00:20:56.143

这一点 jQuery 应该和你的 javascript 做同样的事情。

```
$('.something').each(function() {
    for (i = 0; i < 8; i++) 
    {
        $(this).append('<b class="b' + i + ' o' + i + '" data-opacity="' + i + '"><i>•&lt;/i></b>');
    }
});

setInterval(function() {
    $('.something b').each(function () {
        $(this).removeClass('o' + $(this).attr('data-opacity'));
        $(this).attr('data-opacity', (parseInt($(this).attr('data-opacity')) + 1) % 8);
        $(this).addClass('o' + $(this).attr('data-opacity'));
    });
}, 99); 
```

您可能还想查看以下内容，它也可以在不使用图像的情况下创建加载微调器：http:
[//fgnass.github.com/spin.js/](http://fgnass.github.com/spin.js/)
[http://cssload.net/](http://cssload.net/)
[http://www。 jquery4u.com/animation/10-css3-jquery-loading-animations-solutions/](http://www.jquery4u.com/animation/10-css3-jquery-loading-animations-solutions/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:16:24.060

它也可以工作

```
$('.something').show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:27:12.460

稍微解释一下

```
$('.something').fadeIn(); 
```

取自 SLaks 答案

```
$('.something') 
```

将使用 .something 类抓取所有元素，而 fadeIn() 是一个内置的 jquery 方法，它将相关元素的不透明度从 0 更改为 1。请注意，如果您的元素的不透明度为 1 并且您调用fadeIn，我认为它会闪烁并淡入。除了fadeIn 之外，还有很多其他jquery 实用程序可以在jquery 网站上找到。

```
$('SELECTOR') 
```

SELECTOR 可以是任何 css 选择器，例如

```
$('#myID .something')
$('#myID > .something')
$('#myID .something:first-child')
$('div.className #myid') 
```

# android - 我如何判断（通过检查框架代码）Android 意图广播是否“粘性”

> ID：12713500
> 
> 赞同：1
> 
> 时间：2012-10-03T17:14:19.383
> 
> 标签：android, android-intent

特别是，我对由于按下硬件按钮而产生的意图感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:43:06.673

如果发送者使用`sendStickyBroadcast()`or `sendStickyOrderedBroadcast()`，则广播是粘性的。

如果硬件按钮按下是粘性广播，我会有些惊讶，因为按下按钮确实是一个时间点事件。粘性广播通常用于最后广播值相关的情况。因此，例如，当前的电池电量是相关的，因此`ACTION_BATTERY_CHANGED`是粘性的。但是，如果说`ACTION_CAMERA_BUTTON`是粘性的，那么我们会发现自手机上次重新启动以来是否随时按下 CAMERA 按钮，这通常不相关。

# mysql - 无法从 MySQL 查询访问第二个数据库中的表

> ID：12713504
> 
> 赞同：0
> 
> 时间：2012-10-03T17:14:36.697
> 
> 标签：mysql, multiple-databases

我在服务器上有 2 个数据库：

*   数据库1
*   数据库2

我正在尝试查询每个数据库中的表。但是，当我尝试这样做时，出现以下错误：

> 字段列表中的未知表“database2.client”

这是我在数据库 1 上运行的脚本中使用的代码：

```
SELECT database2.client.id; 
```

它返回未知表错误。奇怪的是，如果我查询数据库，它会同时显示它们：

```
SHOW DATABASES 
```

它返回以下内容：

```
information_schema
database1
database2 
```

我不确定为什么 SHOW 语法确认两个数据库都存在，但我无法从另一个表中选择数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:18:19.503

我相信正确的语法是：

```
SELECT id FROM database2.client 
```

`id`列在哪里，`database2`你的数据库在哪里，`client`你的表在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:17:05.433

如果你先运行`use database2`，你能选择它，然后`SELECT client.id`？

**编辑：**

正如许多人指出的那样，您需要使用正确的`SELECT`语法。

```
USE database2;
SELECT id FROM client; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:17:36.680

尝试这个：

```
SELECT id FROM database2.client; 
```

# javascript - 页面外的 JQuery Mobile Popover

> ID：12713505
> 
> 赞同：1
> 
> 时间：2012-10-03T17:14:42.393
> 
> 标签：javascript, jquery, jquery-mobile

我正在尝试在 jQuery Mobile 中创建一个带有一些警报的全局弹出框。那可能吗？似乎弹出窗口必须位于 jquery 移动页面中才能访问。我假设这是因为该页面之外的所有内容都不可见。

这是我正在谈论的一个例子。如何让第二个版本工作？

作品

```
<div data-role="page" data-theme="a">
    <div data-role="content">

        <a href="#alert-popup" data-rel="popup" data-role="button" data-inline="true">Popup with close button right</a>

        <div data-role="popup" id="alert-popup" data-theme="c">
            <a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
            <h1>Alert Title</h1>
            <p>
                Freegan thundercats raw denim adipisicing elit. 8-bit hella lomo do irony, sartorial aliquip wes anderson. Elit quinoa consectetur hoodie, bushwick 3 wolf moon godard eiusmod next level quis echo park. Keytar ullamco exercitation salvia, brunch before they sold out cray minim echo park polaroid vegan cliche reprehenderit vero synth. Artisan VHS fanny pack aliqua ex williamsburg duis. Reprehenderit chillwave skateboard post-ironic, food truck ethical est wes anderson letterpress incididunt master cleanse. Selvage farm-to-table elit vinyl jean shorts, consectetur delectus non banksy.
            </p>
        </div>

    </div>
</div> 
```

不工作

```
<div data-role="page" data-theme="a">
    <div data-role="content">

        <a href="#alert-popup" data-rel="popup" data-role="button" data-inline="true">Popup with close button right</a>

    </div>
</div>

<div data-role="popup" id="alert-popup" data-theme="c">
    <a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
    <h1>Alert Title</h1>
    <p>
        Freegan thundercats raw denim adipisicing elit. 8-bit hella lomo do irony, sartorial aliquip wes anderson. Elit quinoa consectetur hoodie, bushwick 3 wolf moon godard eiusmod next level quis echo park. Keytar ullamco exercitation salvia, brunch before they sold out cray minim echo park polaroid vegan cliche reprehenderit vero synth. Artisan VHS fanny pack aliqua ex williamsburg duis. Reprehenderit chillwave skateboard post-ironic, food truck ethical est wes anderson letterpress incididunt master cleanse. Selvage farm-to-table elit vinyl jean shorts, consectetur delectus non banksy.
    </p>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:35:00.337

你是对的，请看[这里](http://jquerymobile.com/test/docs/pages/popup/index.html)：

> 弹出 div 必须嵌套在与链接相同的页面内。

```
<div data-role="page" data-theme="a">
    <div data-role="content">
        <a href="#alert-popup" data-rel="popup" data-role="button" data-inline="true">Popup with close button right</a>
    </div>
    <div data-role="popup" id="alert-popup" data-theme="c">
        <a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
        <h1>Alert Title</h1>
        <p>
            Freegan thundercats raw denim adipisicing elit. 8-bit hella lomo do irony, sartorial aliquip wes anderson. Elit quinoa consectetur hoodie, bushwick 3 wolf moon godard eiusmod next level quis echo park. Keytar ullamco exercitation salvia, brunch before they sold out cray minim echo park polaroid vegan cliche reprehenderit vero synth. Artisan VHS fanny pack aliqua ex williamsburg duis. Reprehenderit chillwave skateboard post-ironic, food truck ethical est wes anderson letterpress incididunt master cleanse. Selvage farm-to-table elit vinyl jean shorts, consectetur delectus non banksy.
        </p>
    </div>
</div> 
```

**[例子](http://jsfiddle.net/mqZzd/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:36:06.653

不幸的是，到目前为止，弹出窗口必须位于同一页面或同一 data-role="page" div 中（如果您在一个文件中创建多页站点）。为了解决这个问题，我在每个页面上放置了一个占位符弹出框，并在加载站点时使用一些 JS 填充它（或者如果您希望每次单击菜单按钮时）。

下面是一个基本示例，您可以在此处获取完整的详细信息（包括一个关于禁用用户当前页面的菜单选项的小脚本：http: [//fromdehart.tumblr.com/post/35555011698/jquerymobile-included-多页站点的弹出菜单](http://fromdehart.tumblr.com/post/35555011698/jquerymobile-included-popup-menus-for-multipage-site)

或在此处下载或分叉 GIT 上的完整代码：[https ://github.com/fromdehart/jQueryMobile-Included-Popup-Menus/](https://github.com/fromdehart/jQueryMobile-Included-Popup-Menus/)

```
<!— Popup Placeholder —&gt;
<div data-role=“popup” id=“lMenu” data-overlay-theme=“a” class=“ui-content” data-position-to=“window”&gt;
    <a href=”#” data-rel=“back” data-role=“button” data-theme=“a” data-icon=“delete” data-iconpos=“notext” class=“ui-btn-right”&gt;Close</a>
    <!—create a list where we can populate the menu—&gt;
    <ul data-role=“listview” class=“leftMenu”&gt;</ul>
</div> 
```

用于创建和发布菜单的 JS

```
function leftMenu() {
  output = ””;
  //html for menu list items
  output += ‘&lt;li><a data-transition=”slide” href=”#home”&gt;Home</a></li>’;
  output += ‘&lt;li><a data-transition=”slide” href=”#taryn”&gt;Taryn</a></li>’;
  output += ‘&lt;li><a data-transition=”slide” href=”#flula”&gt;Flula</a></li>’;
  //write html into any items with the <ul> with the class of “leftMenu”
  $(‘.leftMenu’).html(output);
 //Targeting a class allows us to input the code in multiple places rather than an ID where it will only effect the first instance of that ID
} 
```

回到 HTML 中，在正文关闭之前，我们将调用菜单函数

```
 <script type=“text/javascript”&gt;leftMenu();</script>
</body> 
```

# c# - ASP.NET 中的 Active Directory 身份验证

> ID：12713517
> 
> 赞同：0
> 
> 时间：2012-10-03T17:15:18.617
> 
> 标签：c#, c#-4.0, active-directory, c#-3.0

我正在尝试实现活动目录身份验证，但我遇到了异常，就像

```
System.Runtime.InteropServices.COMException was caught
  Message=Unknown error (0x80005000)
  Source=System.DirectoryServices
  ErrorCode=-2147463168
  StackTrace:
       at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)
       at System.DirectoryServices.DirectoryEntry.Bind()
       at System.DirectoryServices.DirectoryEntry.get_AdsObject()
       at System.DirectoryServices.DirectorySearcher.FindAll(Boolean findMoreThanOne)
       at System.DirectoryServices.DirectorySearcher.FindOne()
       at ConsoleApplication1.ADAuthentication.AuthenticateADUsers(String userNameWithDomain, String password) in C:\Users\awadhendrat\documents\visual studio 2010\Projects\ConsoleApplication1\ConsoleApplication1\Program.cs:line 83
       at ConsoleApplication1.Program.Main(String[] args) in C:\Users\awadhendrat\documents\visual studio 2010\Projects\ConsoleApplication1\ConsoleApplication1\Program.cs:line 23
  InnerException: 
```

我不知道我错过了什么。以下代码是我为实现 AD 身份验证而编写的。

```
public bool AuthenticateADUsers(string userNameWithDomain, string password)
        {
            DirectoryEntry objDirectoryEntry = null;
            DirectorySearcher objDirectorySearcher = null;

            try
            {
                objDirectoryEntry = new DirectoryEntry("https://ab.hotels.com/", userNameWithDomain, password, AuthenticationTypes.Delegation);
                objDirectorySearcher = new DirectorySearcher(objDirectoryEntry);
                objDirectorySearcher.Filter = string.Format("(&(objectClass=user)(objectCategory=user) (sAMAccountName={0}))", userNameWithDomain.Substring(0, userNameWithDomain.IndexOf('@')));
                objDirectorySearcher.PropertiesToLoad.Add("msRTCSIP-PrimaryUserAddress");
                var result = objDirectorySearcher.FindOne();
                if (result != null)
                    return true;
                else
                    return false;                           
            }
            catch
            {
                throw;
            }
        } 
```

我做了一些谷歌但没有得到帮助。在这里，我几乎没有像他们写 LDAP://somedomain/ 的每个地方那样混淆，但在这里我有[https://somedomain.com](https://somedomain.com)另一个混淆是我的测试应用程序在一个域上，并且提供的域在另一台服务器上。

当我打开客户端提供的用于 AD 身份验证的链接时，它会打开 Open Office Web Access。

我不知道如何解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:34:21.490

根据[这个答案](https://stackoverflow.com/a/1722429/16959)（以及我为测试它而编写的一些快速代码），这是一个权限问题（可能与您对 AD 路径使用 https URL 有关，请查看[此代码](http://aspnetgotyou.blogspot.com/2011/01/active-directory-ad-c-net.html)以构建`DirectoryEntry`一个完整的使用您尝试验证的同一用户进行 AD 搜索）。

# heroku - Heroku H13错误有办法解决吗？

> ID：12713518
> 
> 赞同：0
> 
> 时间：2012-10-03T17:15:26.517
> 
> 标签：heroku

我有一个在 Heroku 上运行的应用程序，有时会出现此错误：

```
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/path_traversal.rb:16:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/json_csrf.rb:17:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/base.rb:47:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/logger.rb:15:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/commonlogger.rb:20:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/head.rb:9:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/sinatra-1.3.2/lib/sinatra/base.rb:1334:in `block in call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/sinatra-1.3.2/lib/sinatra/base.rb:1416:in `synchronize'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/sinatra-    1.3.2/lib/sinatra/base.rb:1334:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/commonlogger.rb:20:in `call'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:80:in `block in pre_process'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `catch'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `pre_process'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:53:in `process'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:38:in `receive_data'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/backends/base.rb:63:in `start'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/server.rb:159:in `start'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/controllers/controller.rb:86:in `start'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:185:in `run_command'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:151:in `run!'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/bin/thin:6:in `<top (required)>'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'
2012-10-03T17:01:32+00:00 app[web.1]:   /app/vendor/bundle/ruby/1.9.1/bin/thin:19:in `<main>' 
```

那我该怎么办？...

**编辑：添加 gemfile**

```
source :rubygems

# use Heroku Toolbelt instead
# gem "heroku"

# sinatra main library
gem "sinatra"

# sinatra plugin for localization
gem "sinatra-r18n"

gem "resolv-ipv6favor"

# Json
gem "json"

# rack middleware csrf protection
gem "rack_csrf"

# database handler | orm
gem "pg"
gem "sequel"
gem "sequel_sluggable"

gem "unicode_utils"
gem "sanitize"
gem "fog"
gem "mail"
gem "thin"

# Full system log
gem 'remote_syslog_logger'

group :development do
  gem "awesome_print"
  gem "sinatra-reloader"
  gem "sqlite3"
end 
```

# android - Android 从 Webview 保存图像并启用 javascript

> ID：12713522
> 
> 赞同：2
> 
> 时间：2012-10-03T17:15:44.033
> 
> 标签：android, webview

如何在使用来自谷歌图像的 setJavaScriptenabled(true) 时从 webview 保存图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:48:11.220

基本上，您必须从`<img src=""/>`JavaScript 中的元素中捕获图像 URL，并将此值传递回您的代码。之后，您将执行单独的 (Java) 调用来捕获流，然后将其保存到 SD（或磁盘或内存）

# scala - 在辅助构造函数中传递方法

> ID：12713523
> 
> 赞同：1
> 
> 时间：2012-10-03T17:15:51.143
> 
> 标签：scala

我正在尝试创建一个接收函数的类，但是，我希望它是可选的，如果调用者将其排除在外，我希望将其替换为默认函数。

目前我有以下内容：

```
class MenuItem(val text: String, val onClick: (Vector2f) => Unit) extends Renderable {
  def this(text: String) = this(text, { position => () })

  private def default(position: Vector2f) = {
    println(text + " was clicked, but is still using the default event.")
  }
} 
```

这工作正常，但我想替换`{ position => () })`构造函数中的，`default`但这样做会导致错误“未找到：值默认值”。

我试过在没有 private 修饰符的情况下声明默认值，但这没有帮助。

我想出的最佳解决方案是这样声明：

```
def this(text: String) = this(text, position => println(text + " was clicked, but is still using the default event.")) 
```

有没有办法可以保留定义的默认方法并只使用它的名称，还是我必须坚持内联实现该方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T17:33:30.607

这应该可以工作（删除了奇怪的类型以使其可编译）：

```
object MenuItem {
    def default(text: String, position: AnyRef) = {
        println(text + " was clicked, but is still using the default event.")
    }
}

class MenuItem(val text: String, val onClick: (AnyRef) => Unit) {
    def this(text: String) = this(text, MenuItem.default(text, _))
} 
```

访问您尝试构造的对象的方法不起作用，因为它只有在构造后才能访问。

从[语言规范第 5.3.1 节](http://www.scala-lang.org/docu/files/ScalaReference.pdf)：

> 构造函数定义的签名和自构造函数调用在封闭类定义时有效的范围内进行类型检查和评估，并由封闭类的任何类型参数和任何早期定义（§5.1 .6) 的封闭模板。

'self 构造函数调用是对主构造函数的调用。而且由于它是在封闭类的范围内进行类型检查的，这意味着它看不到类内的方法。

这是一件好事，因为在调用主构造函数之前，`text`没有定义实例的字段（在这种情况下）。

# c - 多链表（变量输入）

> ID：12713528
> 
> 赞同：0
> 
> 时间：2012-10-03T17:16:02.403
> 
> 标签：c, linked-list

我正在尝试在 C 中实现聚类算法。我想将数据集群存储在不同的链表中。并且要找到的簇的数量是由用户输入的。那么有没有一种方法可以在循环中生成对象到链表结构，直到用户输入的集群数量？或者任何其他可能的实现？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:36:37.170

利用`list.h`

是一个包含所有链表实用程序的链表库：添加、删除、浏览...

**list.h 源码**

```
#ifndef _LINUX_LIST_H
#define _LINUX_LIST_H

/*
 * These are non-NULL pointers that will result in page faults
 * under normal circumstances, used to verify that nobody uses
 * non-initialized list entries.
 */
#define LIST_POISON1  ((void *) 0x00100100)
#define LIST_POISON2  ((void *) 0x00200200)

/*
 * Simple doubly linked list implementation.
 *
 * Some of the internal functions ("__xxx") are useful when
 * manipulating whole lists rather than single entries, as
 * sometimes we already know the next/prev entries and we can
 * generate better code by using them directly rather than
 * using the generic single-entry routines.
 */

struct list_head {
    struct list_head *next, *prev;
};

#define LIST_HEAD_INIT(name) { &(name), &(name) }

#define LIST_HEAD(name) \
    struct list_head name = LIST_HEAD_INIT(name)

#define INIT_LIST_HEAD(ptr) do { \
    (ptr)->next = (ptr); (ptr)->prev = (ptr); \
} while (0)

/*
 * Insert a new entry between two known consecutive entries.
 *
 * This is only for internal list manipulation where we know
 * the prev/next entries already!
 */
static inline void __list_add(struct list_head *new,
                  struct list_head *prev,
                  struct list_head *next)
{
    next->prev = new;
    new->next = next;
    new->prev = prev;
    prev->next = new;
}

/**
 * list_add - add a new entry
 * @new: new entry to be added
 * @head: list head to add it after
 *
 * Insert a new entry after the specified head.
 * This is good for implementing stacks.
 */
static inline void list_add(struct list_head *new, struct list_head *head)
{
    __list_add(new, head, head->next);
}

/**
 * list_add_tail - add a new entry
 * @new: new entry to be added
 * @head: list head to add it before
 *
 * Insert a new entry before the specified head.
 * This is useful for implementing queues.
 */
static inline void list_add_tail(struct list_head *new, struct list_head *head)
{
    __list_add(new, head->prev, head);
}

/*
 * Delete a list entry by making the prev/next entries
 * point to each other.
 *
 * This is only for internal list manipulation where we know
 * the prev/next entries already!
 */
static inline void __list_del(struct list_head * prev, struct list_head * next)
{
    next->prev = prev;
    prev->next = next;
}

/**
 * list_del - deletes entry from list.
 * @entry: the element to delete from the list.
 * Note: list_empty on entry does not return true after this, the entry is
 * in an undefined state.
 */
static inline void list_del(struct list_head *entry)
{
    __list_del(entry->prev, entry->next);
    entry->next = LIST_POISON1;
    entry->prev = LIST_POISON2;
}

/**
 * list_del_init - deletes entry from list and reinitialize it.
 * @entry: the element to delete from the list.
 */
static inline void list_del_init(struct list_head *entry)
{
    __list_del(entry->prev, entry->next);
    INIT_LIST_HEAD(entry);
}

/**
 * list_move - delete from one list and add as another's head
 * @list: the entry to move
 * @head: the head that will precede our entry
 */
static inline void list_move(struct list_head *list, struct list_head *head)
{
        __list_del(list->prev, list->next);
        list_add(list, head);
}

/**
 * list_move_tail - delete from one list and add as another's tail
 * @list: the entry to move
 * @head: the head that will follow our entry
 */
static inline void list_move_tail(struct list_head *list,
                  struct list_head *head)
{
        __list_del(list->prev, list->next);
        list_add_tail(list, head);
}

/**
 * list_empty - tests whether a list is empty
 * @head: the list to test.
 */
static inline int list_empty(const struct list_head *head)
{
    return head->next == head;
}

/**
 * list_empty_careful - tests whether a list is
 * empty _and_ checks that no other CPU might be
 * in the process of still modifying either member
 *
 * NOTE: using list_empty_careful() without synchronization
 * can only be safe if the only activity that can happen
 * to the list entry is list_del_init(). Eg. it cannot be used
 * if another CPU could re-list_add() it.
 *
 * @head: the list to test.
 */
static inline int list_empty_careful(const struct list_head *head)
{
    struct list_head *next = head->next;
    return (next == head) && (next == head->prev);
}

static inline void __list_splice(struct list_head *list,
                 struct list_head *head)
{
    struct list_head *first = list->next;
    struct list_head *last = list->prev;
    struct list_head *at = head->next;

    first->prev = head;
    head->next = first;

    last->next = at;
    at->prev = last;
}

/**
 * list_splice - join two lists
 * @list: the new list to add.
 * @head: the place to add it in the first list.
 */
static inline void list_splice(struct list_head *list, struct list_head *head)
{
    if (!list_empty(list))
        __list_splice(list, head);
}

/**
 * list_splice_init - join two lists and reinitialise the emptied list.
 * @list: the new list to add.
 * @head: the place to add it in the first list.
 *
 * The list at @list is reinitialised
 */
static inline void list_splice_init(struct list_head *list,
                    struct list_head *head)
{
    if (!list_empty(list)) {
        __list_splice(list, head);
        INIT_LIST_HEAD(list);
    }
}

#define offsetof(TYPE, MEMBER) ((size_t) &((TYPE *)0)->MEMBER)

/**
 * container_of - cast a member of a structure out to the containing structure
 *
 * @ptr:        the pointer to the member.
 * @type:       the type of the container struct this is embedded in.
 * @member:     the name of the member within the struct.
 *
 */
#define container_of(ptr, type, member) ({                      \
        const typeof( ((type *)0)->member ) *__mptr = (ptr);    \
        (type *)( (char *)__mptr - offsetof(type,member) );})

/**
 * list_entry - get the struct for this entry
 * @ptr:    the &struct list_head pointer.
 * @type:   the type of the struct this is embedded in.
 * @member: the name of the list_struct within the struct.
 */
#define list_entry(ptr, type, member) \
    container_of(ptr, type, member)

/**
 * list_for_each    -   iterate over a list
 * @pos:    the &struct list_head to use as a loop counter.
 * @head:   the head for your list.
 */
#define list_for_each(pos, head) \
    for (pos = (head)->next; prefetch(pos->next), pos != (head); \
            pos = pos->next)

/**
 * __list_for_each  -   iterate over a list
 * @pos:    the &struct list_head to use as a loop counter.
 * @head:   the head for your list.
 *
 * This variant differs from list_for_each() in that it's the
 * simplest possible list iteration code, no prefetching is done.
 * Use this for code that knows the list to be very short (empty
 * or 1 entry) most of the time.
 */
#define __list_for_each(pos, head) \
    for (pos = (head)->next; pos != (head); pos = pos->next)

/**
 * list_for_each_prev   -   iterate over a list backwards
 * @pos:    the &struct list_head to use as a loop counter.
 * @head:   the head for your list.
 */
#define list_for_each_prev(pos, head) \
    for (pos = (head)->prev; prefetch(pos->prev), pos != (head); \
            pos = pos->prev)

/**
 * list_for_each_safe   -   iterate over a list safe against removal of list entry
 * @pos:    the &struct list_head to use as a loop counter.
 * @n:      another &struct list_head to use as temporary storage
 * @head:   the head for your list.
 */
#define list_for_each_safe(pos, n, head) \
    for (pos = (head)->next, n = pos->next; pos != (head); \
        pos = n, n = pos->next)

/**
 * list_for_each_entry  -   iterate over list of given type
 * @pos:    the type * to use as a loop counter.
 * @head:   the head for your list.
 * @member: the name of the list_struct within the struct.
 */
#define list_for_each_entry(pos, head, member)              \
    for (pos = list_entry((head)->next, typeof(*pos), member);  \
         prefetch(pos->member.next), &pos->member != (head);    \
         pos = list_entry(pos->member.next, typeof(*pos), member))

/**
 * list_for_each_entry_reverse - iterate backwards over list of given type.
 * @pos:    the type * to use as a loop counter.
 * @head:   the head for your list.
 * @member: the name of the list_struct within the struct.
 */
#define list_for_each_entry_reverse(pos, head, member)          \
    for (pos = list_entry((head)->prev, typeof(*pos), member);  \
         prefetch(pos->member.prev), &pos->member != (head);    \
         pos = list_entry(pos->member.prev, typeof(*pos), member))

/**
 * list_prepare_entry - prepare a pos entry for use as a start point in
 *          list_for_each_entry_continue
 * @pos:    the type * to use as a start point
 * @head:   the head of the list
 * @member: the name of the list_struct within the struct.
 */
#define list_prepare_entry(pos, head, member) \
    ((pos) ? : list_entry(head, typeof(*pos), member))

/**
 * list_for_each_entry_continue -   iterate over list of given type
 *          continuing after existing point
 * @pos:    the type * to use as a loop counter.
 * @head:   the head for your list.
 * @member: the name of the list_struct within the struct.
 */
#define list_for_each_entry_continue(pos, head, member)         \
    for (pos = list_entry(pos->member.next, typeof(*pos), member);  \
         prefetch(pos->member.next), &pos->member != (head);    \
         pos = list_entry(pos->member.next, typeof(*pos), member))

/**
 * list_for_each_entry_safe - iterate over list of given type safe against removal of list entry
 * @pos:    the type * to use as a loop counter.
 * @n:      another type * to use as temporary storage
 * @head:   the head for your list.
 * @member: the name of the list_struct within the struct.
 */
#define list_for_each_entry_safe(pos, n, head, member)          \
    for (pos = list_entry((head)->next, typeof(*pos), member),  \
        n = list_entry(pos->member.next, typeof(*pos), member); \
         &pos->member != (head);                    \
         pos = n, n = list_entry(n->member.next, typeof(*n), member))

/*
 * Double linked lists with a single pointer list head.
 * Mostly useful for hash tables where the two pointer list head is
 * too wasteful.
 * You lose the ability to access the tail in O(1).
 */

struct hlist_head {
    struct hlist_node *first;
};

struct hlist_node {
    struct hlist_node *next, **pprev;
};

#define HLIST_HEAD_INIT { .first = NULL }
#define HLIST_HEAD(name) struct hlist_head name = {  .first = NULL }
#define INIT_HLIST_HEAD(ptr) ((ptr)->first = NULL)
#define INIT_HLIST_NODE(ptr) ((ptr)->next = NULL, (ptr)->pprev = NULL)

static inline int hlist_unhashed(const struct hlist_node *h)
{
    return !h->pprev;
}

static inline int hlist_empty(const struct hlist_head *h)
{
    return !h->first;
}

static inline void __hlist_del(struct hlist_node *n)
{
    struct hlist_node *next = n->next;
    struct hlist_node **pprev = n->pprev;
    *pprev = next;
    if (next)
        next->pprev = pprev;
}

static inline void hlist_del(struct hlist_node *n)
{
    __hlist_del(n);
    n->next = LIST_POISON1;
    n->pprev = LIST_POISON2;
}

static inline void hlist_del_init(struct hlist_node *n)
{
    if (n->pprev)  {
        __hlist_del(n);
        INIT_HLIST_NODE(n);
    }
}

static inline void hlist_add_head(struct hlist_node *n, struct hlist_head *h)
{
    struct hlist_node *first = h->first;
    n->next = first;
    if (first)
        first->pprev = &n->next;
    h->first = n;
    n->pprev = &h->first;
}

/* next must be != NULL */
static inline void hlist_add_before(struct hlist_node *n,
                    struct hlist_node *next)
{
    n->pprev = next->pprev;
    n->next = next;
    next->pprev = &n->next;
    *(n->pprev) = n;
}

static inline void hlist_add_after(struct hlist_node *n,
                    struct hlist_node *next)
{
    next->next = n->next;
    n->next = next;
    next->pprev = &n->next;

    if(next->next)
        next->next->pprev  = &next->next;
}

#define hlist_entry(ptr, type, member) container_of(ptr,type,member)

#define hlist_for_each(pos, head) \
    for (pos = (head)->first; pos && ({ prefetch(pos->next); 1; }); \
         pos = pos->next)

#define hlist_for_each_safe(pos, n, head) \
    for (pos = (head)->first; pos && ({ n = pos->next; 1; }); \
         pos = n)

/**
 * hlist_for_each_entry - iterate over list of given type
 * @tpos:   the type * to use as a loop counter.
 * @pos:    the &struct hlist_node to use as a loop counter.
 * @head:   the head for your list.
 * @member: the name of the hlist_node within the struct.
 */
#define hlist_for_each_entry(tpos, pos, head, member)            \
    for (pos = (head)->first;                    \
         pos && ({ prefetch(pos->next); 1;}) &&          \
        ({ tpos = hlist_entry(pos, typeof(*tpos), member); 1;}); \
         pos = pos->next)

/**
 * hlist_for_each_entry_continue - iterate over a hlist continuing after existing point
 * @tpos:   the type * to use as a loop counter.
 * @pos:    the &struct hlist_node to use as a loop counter.
 * @member: the name of the hlist_node within the struct.
 */
#define hlist_for_each_entry_continue(tpos, pos, member)         \
    for (pos = (pos)->next;                      \
         pos && ({ prefetch(pos->next); 1;}) &&          \
        ({ tpos = hlist_entry(pos, typeof(*tpos), member); 1;}); \
         pos = pos->next)

/**
 * hlist_for_each_entry_from - iterate over a hlist continuing from existing point
 * @tpos:   the type * to use as a loop counter.
 * @pos:    the &struct hlist_node to use as a loop counter.
 * @member: the name of the hlist_node within the struct.
 */
#define hlist_for_each_entry_from(tpos, pos, member)             \
    for (; pos && ({ prefetch(pos->next); 1;}) &&            \
        ({ tpos = hlist_entry(pos, typeof(*tpos), member); 1;}); \
         pos = pos->next)

/**
 * hlist_for_each_entry_safe - iterate over list of given type safe against removal of list entry
 * @tpos:   the type * to use as a loop counter.
 * @pos:    the &struct hlist_node to use as a loop counter.
 * @n:      another &struct hlist_node to use as temporary storage
 * @head:   the head for your list.
 * @member: the name of the hlist_node within the struct.
 */
#define hlist_for_each_entry_safe(tpos, pos, n, head, member)        \
    for (pos = (head)->first;                    \
         pos && ({ n = pos->next; 1; }) &&               \
        ({ tpos = hlist_entry(pos, typeof(*tpos), member); 1;}); \
         pos = n)

#endif 
```

# javascript - Javascript ajax 帖子

> ID：12713530
> 
> 赞同：1
> 
> 时间：2012-10-03T17:16:04.843
> 
> 标签：javascript, ajax, http, jquery

> **可能重复：**
> [如何在 jQuery 的 POST 请求中转义 &？](https://stackoverflow.com/questions/3319123/how-to-escape-in-a-post-request-in-jquery)

我正在使用 jQuery ajax 在我的网站上自动完成。我遇到了一个问题，一个 & 可以存储在数据库中，这只会对我发布的变量造成严重破坏。它需要做什么：（`ajax=true&search=t&w`使用搜索变量的 & 和 w 部分）

它的作用是创建一个新的 post 变量`w`。

有没有办法阻止 & 符号创建新的 post 变量，或者我只需要更改`&'s`to 和/And

这是我的代码：

```
$.ajax({
    url: page_url,
    type: 'POST',
    data: 'ajax=true&search='+$('#search_string').val(),
    success: function(data){

    }
}); 
```

如果值被编码，数据库将如何处理编码的 &？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:25:29.510

如果您将传递给数据的值设置为对象，它将轻松编码：

```
data: {ajax:isAjaxTrue, search: searchValue} 
```

请参阅：[如何在 jQuery 的 POST 请求中转义 &？](https://stackoverflow.com/questions/3319123/how-to-escape-in-a-post-request-in-jquery)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T17:23:14.550

您需要使用 url 编码器来避免参数值中出现特殊字符。

```
encodeURIComponent(value); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:23:51.980

看看`encodeURIComponent()`。

```
$.ajax({
    ...
    data: encodeURIComponent('ajax=true&search='+$('#search_string').val()),
    ...
}); 
```

# java - 使用正则表达式解析 Java 语法

> ID：12713535
> 
> 赞同：0
> 
> 时间：2012-10-03T17:16:37.583
> 
> 标签：java

我目前正在我的文本编辑器中为 java 开发一个校正器。为此，我认为最好的方法是使用 Pattern 来查找 java 语法的元素（导入或包声明，类或方法声明......）。我已经写了一些这样的模式：

```
private String regimport = "^import(\\s+)(static |)(\\w+\\.)*(\\w+)(\\s*);(\\s*)$",
                regpackage="^package(\\s+)[\\w+\\.]*[\\w+](\\s*);(\\s*)$",
                regclass="^((public(\\s+)abstract)|(abstract)|(public)|(final)|(public(\\s+)final)|)(\\s+)class(\\s+)(\\w+)(((\\s+)(extends|implements)(\\s+)(\\w+))|)(\\s*)(\\{)?(\\s*)$"; 
```

现在不是很困难，但恐怕需要很长时间才能实现。有人知道是否已经存在类似的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:30:52.693

> 为此，我认为最好的方法是使用 Pattern 来查找 java 语法的元素

不正确。正则表达式模式无法充分识别 Java 语法元素。这就是为什么存在更复杂的解析器的原因。举个简单的例子，想象一下如何避免注释中保留字的错误匹配，例如

```
/* this is not importing anything
import java.util.*;
*/ 
```

但是如果你非常热衷于使用正则表达式，并且愿意花费大量精力，请查看`Emacs` `font-lock-mode`，它使用正则表达式来识别和字体化语法元素。

[PS：我提到的“大量努力”是指学习如何`Emacs`工作，阅读`elisp`代码并将`Emacs`正则表达式翻译成Java。如果您已经知道所有这些，那么您将需要更少的努力。]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T01:32:36.337

谢谢大家的答案。我想我将使用 javaparser AST，它会容易得多:)

这是用于检查 AST 错误的代码

```
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;

import org.eclipse.jdt.core.compiler.IProblem;
import org.eclipse.jdt.core.dom.AST;
import org.eclipse.jdt.core.dom.ASTParser;
import org.eclipse.jdt.core.dom.CompilationUnit;

public class Main {

    public static void main(String[] args) {

        ASTParser parser = ASTParser.newParser(AST.JLS2);
        FileInputStream in=null;
        try {
            in = new FileInputStream("/root/java/Animbis.java"); //your personal java source file
            int n;
            String text="";
            while( (n=in.read()) !=-1) {
                text+=(char)n;
            }
            CompilationUnit cu;
            // parse the file
            parser.setSource(text.toCharArray());
            in.close();
        }catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        CompilationUnit unit = (CompilationUnit) parser.createAST(null); 
        //unit.recordModifications();
        AST ast = unit.getAST(); 

        IProblem[] problems = unit.getProblems();
        boolean error = false;
        for (IProblem problem : problems) {
           StringBuffer buffer = new StringBuffer();
           buffer.append(problem.getMessage());
           buffer.append(" line: ");
           buffer.append(problem.getSourceLineNumber());
           String msg = buffer.toString(); 
           if(problem.isError()) {
              error = true; 
              msg = "Error:\n" + msg;
           }    
           else 
              if(problem.isWarning())
                 msg = "Warning:\n" + msg;

           System.out.println(msg);  
        }

    }

} 
```

使用以下 jar 运行：

```
org.eclipse.core.contenttype.jar
org.eclipse.core.jobs.jar
org.eclipse.core.resources.jar
org.eclipse.core.runtime.jar
org.eclipse.equinox.common.jar
org.eclipse.equinox.preferences.jar
org.eclipse.jdt.core.jar
org.eclipse.osgi.jar 
```

从 [Eclipse ASTParser](http://www.ibm.com/developerworks/opensource/library/os-ast/#N10184)和ASTParser[示例获取信息](http://www.programcreek.com/2011/01/a-complete-standalone-example-of-astparser/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:33:00.617

正则表达式无法解析 Java 的完整语法。它们是不同类别的语言。Java 至少是 Chomsky 类型 2 语言，而 RegEx 是类型 3，而类型 2 从根本上比类型 3 更复杂。另请参阅[这个](https://stackoverflow.com/a/1732454/854793)关于使用 RegEx 解析 HTML 的著名答案......它本质上是相同的问题。

# c# - 从 C# 中保存泛型类型的字典中获取值

> ID：12713540
> 
> 赞同：0
> 
> 时间：2012-10-03T17:16:57.160
> 
> 标签：c#, generics

```
public class Table<T> where T:SomeClassWithIntegerID
{
    private Dictionary<int, T> map = new Dictionary<int, T>();

    public bool isInMemory(int id)
    {
        if (map.ContainsKey(id))
            return true;
        return false;
    }

    public T setIt(T obj)
    {
        map[obj.id] = obj;
    }

    public T getIt(int id)
    {
        return map[id];
    }
} 
```

例子：

```
private static Table<User> table = new Table<User>;

class User : SomeClassWithIntegerID
{
    public string name { get; set; }
    public string password { get; set; }
}

class SomeClassWithIntegerID
{
    public int id { get; set; }
} 
```

我现在可以检查是否`Table`持有具有特定 ID 的用户，因为我使用它作为密钥，但现在我无法检查是否`Table`持有Bob 或其他什么`User`。`name`我希望能够做类似的事情，`table.isInMemory(name, "bob")`但是泛型类型怎么可能呢？

我需要创建一个函数，允许最终用户指定该字段的字段和预期值，之后 Table 将遍历该类的所有对象，存储在 Dictionary 中，以查看是否有与该值匹配的字段.

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:22:21.207

```
public bool IsInMemory(Func<T, bool> predicate)
{
    return map.Values.Any(predicate);
} 
```

然后，您可以将其称为：

```
table.IsInMemory(u => u.Name == "bob"); 
```

如果你想使用一个属性名称和值来匹配你可以添加一个重载：

```
public bool IsInMemory(string propertyName, object value)
{
    PropertyInfo property = typeof(T).GetProperty(propertyName);
    if(property == null) throw new ArgumentException("Invalid property name: " + propertyName);

    var predicate = new Func<T, bool>(item => object.Equals(value, property.GetValue(item, null)));
    return IsInMemory(predicate);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T17:34:48.823

我会用 Where-method 来补充 Lee 的回答，以便使用 LINQ 进行查询：

```
public IEnumerable<T> Where(Func<T, bool> predicate)
{
    return map.Values.Where(predicate);
} 
```

And an example:

```
table.Where(x => x.name.Contains("natli"))
     .OrderBy(x => x.name); 
```

To answer your actual question, you can (if you're using .NET 4.0) use the *dynamic* type, which resolves all methods and such at runtime, to call methods or properties that the compiler doesn't know about from its context.

```
dynamic dynObject = someObject;
dynObject.SomeMethod("Hi there", 27); // Call whatever method or property you "know" exist 
```

# objective-c - Mobclix 实现方法冲突 Xcode 4.5

> ID：12713545
> 
> 赞同：1
> 
> 时间：2012-10-03T17:17:17.020
> 
> 标签：objective-c, ios, xcode4.5, mobclix

我在我的应用程序中实现 Mobclix 但收到 2 个方法冲突警告：

/Users/user/MyFolder/Myapp/Mobclix SDK/libMobclix.a(MobclixController.o) 类别中的实例方法“mcScanCStyleComment:”与另一个类别中的相同方法冲突

/Users/user/Myfolder/Myapp/Mobclix SDK/libMobclix.a(MobclixController.o) 类别中的实例方法“mcScanCPlusPlusStyleComment:”与另一个类别中的相同方法冲突

尽管有警告，该应用程序在模拟器上运行良好，但没有显示测试广告。

知道如何摆脱这些警告并展示广告吗？

我使用 XCode 4.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T21:50:04.653

刚刚收到 Mobclix 支持的回复。这些警告显然是一个已知问题，他们建议在下一次发布之前忽略此问题。

至于广告没有显示，我遇到了同样的问题，直到他们指出广告的大小不适用于我使用的设备。（试图在 iPad 上使用 320x50 广告，但他们已弃用。他们现在使用的是 468x60 广告）。

# java - Java 扩展最终类

> ID：12713549
> 
> 赞同：2
> 
> 时间：2012-10-03T17:17:28.057
> 
> 标签：java, oop

我想覆盖第 3 方，开源最终类的非最终方法。

```
final class A 
{
    void put(obj a)
    {...}

    obj get()
    {...}
} 
```

请告诉我如何覆盖`get()`and`put()`方法，但仍保留此类的其他行为和功能。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-03T17:18:27.680

它是开源的：分叉它，并使类非最终。

如果不使其成为非最终版本，您将无法扩展它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T17:23:29.987

如果您的类有一个定义的接口，其中定义了 put 和 get 方法，那么您可能想尝试代理该类。

最简单的方法是创建这样的东西：

```
public interface CommonInterface {

void put(); Object get();

}

final class A implements CommonInterface
{

void put(obj a)
{...}
obj get()
{...}

}

public class ProxyToA implements CommonInterface{

   private A a;

  void put(Object a){
   // your override functionality

  } 

    Object get(){
       // same here
    }

   void otherAStuff(){
        a.otherAStuff();
   }

} 
```

然后只需使用 CommonInterface 并代理您的对象。或者您可以使用 JDK 代理、javassist 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:18:12.327

你不能扩展`final`课程。根据 Java 规范。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T17:23:39.983

您绝对应该尝试找出课程是最终课程的*原因。*如果您能够说服自己这样做是可以的，另一种选择是使用[AspectJ](http://www.eclipse.org/aspectj/)来更改这两种方法的行为。

**AspectJ**允许您修改特定方法的行为。它甚至可以对`private`方法（允许安全约束）执行此操作，并访问和分配类的私有字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T17:23:59.417

简短的回答是你不能重写方法，因为你不能扩展类。您打算通过覆盖来处理 get 和 put 方法吗？如果您正在寻找为这些方法添加一些功能，您可以创建另一个包含此类的类。

# python - Python shebang 和换行符

> ID：12713555
> 
> 赞同：4
> 
> 时间：2012-10-03T17:17:37.847
> 
> 标签：python, bash, shebang

为了使 Python 脚本在 Linux 和 bash 上可执行，可以使用 shebang

```
#! /usr/bin/env python 
```

作为脚本的第一行。如果此行恰好以 Windows 样式的换行符 \r\n（回车 - 换行符）而不是 Unix 样式的换行符 \n 结尾，那么 bash 将无法通过 Python 解释器运行脚本。

我正在使用 Python 进行跨平台开发。当我在 Windows 中工作时，自然换行符是 \r\n。当我在 Linux 中工作时，自然换行符是 \n。鉴于我使用 Mercurial 进行版本控制，在包含 shebang 的脚本文件中强制使用 \n 换行符的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T18:01:43.990

常见的方法是根本不自己生成外包装脚本，而是在你的指定它们`setup.py`并让它们在包安装期间生成。

如果您执行以下操作：

```
setup(
    entry_points = {
        "console_scripts": [
            "script_name": "your.module.name:main",
        ],
    }
) 
```

...然后，在安装时，将生成并安装一个名为的包装器`script_name`，并进行适当的配置以在您当前的平台上运行（shebang 行和所有）。这使得使用中的行尾字符没有实际意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:51:01.497

这个问题对于在非本地平台上开发的所有脚本都很常见，而不仅仅是 Python。大多数 SCM 具有自动行结束转换功能。Mercurial 可以做到这一点，但这不是默认设置。请参阅[EOL 扩展](http://mercurial.selenic.com/wiki/EolExtension)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:50:49.297

您可能需要检查[EolExtension](http://mercurial.selenic.com/wiki/EolExtension)。

使用[EolExtension](http://mercurial.selenic.com/wiki/EolExtension)，您可以为存储库强制使用特定的行结尾。以不同行结尾提交的文件会自动转换。

# text - NLP - 句子的主题

> ID：12713557
> 
> 赞同：1
> 
> 时间：2012-10-03T17:17:49.673
> 
> 标签：text, nlp, text-mining, stanford-nlp, opennlp

我试图得到一个句子的主要主题，即一个句子在说什么（不是可能不同的语法主题）。

到目前为止，我得到了

1.) Java 中的 OpenNLP，它为我提供了句子检测、POS 标记、解析、标记器和名称查找器。

2.) MatlParser,stanford Parser - 它可以通过依存解析给出一个简单句子的语法主语。

我认为名词或名词短语在更一般的意义上总是主语，但一个句子可以有很多名词和名词短语。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-04T15:48:47.050

正如您正确指出的那样，语法是不够的。必须使用某种形式的浅语义分析来识别您所谓的“主题”。我相信它在 SRL（语义角色标签）的上下文中更常被称为代理。有开源工具（例如[UIUC SRL 解析器](http://cogcomp.cs.illinois.edu/demo/srl/)）来执行语义角色标签，至少对于英语来说，但它们通常处理单独的谓词，其中在一个句子中可能有几个，所以必须以某种方式找出哪个“主题”是“主要”之一。

事实上，我认为后一个概念的定义并不明确，因为在一个复杂的句子中，可能不清楚哪个主语是“主要”主语。对于特定类型的句子，它可能更有意义，但不是一般的。我认为，如果您描述您正在使用的数据和/或给出一些示例，将会有所帮助。

PS你可以考虑在[https://linguistics.stackexchange.com/上问这个](https://linguistics.stackexchange.com/)

# python - 在 MATLAB 中运行的 Python 程序无法导入 pygame

> ID：12713558
> 
> 赞同：3
> 
> 时间：2012-10-03T17:17:56.897
> 
> 标签：python, matlab, pygame

我正在尝试`pygame`从 MATLAB 运行一个使用模块的 Python 程序。我知道我可以使用

```
system('python program.py') 
```

要不就

```
! python program.py 
```

但是，我不断收到错误消息：

```
Traceback (most recent call last):
  File "program.py", line 1, in <module>
    import pygame
ImportError: No module named pygame 
```

奇怪的是，如果我从命令行运行程序，它工作得很好。有谁知道为什么如果从 MATLAB 中运行，Python 找不到`pygame?`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:44:44.197

问题可能是 MATLAB 没有看到您的 PYTHONPATH，它通常存储 Python 库和模块。对于自定义模块，PYTHONPATH 还应该包含自定义文件夹的路径。

您可以尝试在 MATLAB 运行会话中设置 PYTHONPATH 的值：

```
PATH_PYTHON = '<python_lib_folder>' 
setenv('PYTHONPATH', PATH_PYTHON); % set env path (PYTHONPATH) for this session
system('python program.py'); 
```

另请参阅此处可能相关的 SO 答案：[如何从 matlab 调用 Qtproject？](https://stackoverflow.com/questions/12350282/how-can-i-call-a-qtproject-from-matlab)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:41:29.957

由于我没有经常使用 matlab 并且现在没有可用的程序我不能肯定地说，但是 matlab 可能正在使用自定义路径创建自定义环境（这种情况经常发生，因此用户在他们的软件）。安装 matlab 时，它可能不会将其自身模块的路径导出到您的默认环境。因此，当在 matlab 之外调用 pygame.py 时，python 在其通常的查找路径下找不到 pygame.py。

解决方案可能是：

*   找到 pygame.py，并直接在您的代码中映射到它的路径，尽管这可能会导致您稍后在部署过程中感到头疼

*   尝试将 pygame.py 文件复制到您的工作目录，可能会有需要解决的依赖关系。

*   直接从[http://www.pygame.org](http://www.pygame.org)的开发者处安装 pygame 。版本差异可能是一个问题，但 pygame 被放在 python 的通常查找路径下。（这将是我个人的首选解决方案。）

*   或者只是将matlab库中pygame的路径位置导出到您的默认环境。这也可能是部署期间的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-04T03:37:28.517

对于后代，首先尝试 Stewie 在此处指出的所有内容（[“尝试从 MATLAB R2014b 加载 Python 时“未定义的变量“py”或类”？](https://stackoverflow.com/questions/37152895/undefined-variable-py-or-class-when-trying-to-load-python-from-matlab-r2014b)）。如果它不起作用，那么您可能有多个蟒蛇。您可以尝试在您的 bash/终端上检查哪个 python 工作（以及所有相关的已安装模块）。然后使用

pyversion PYTHONPATH

让matlab知道正确的路径。之后还使用 py.importlib.import_module('yourmodule') 导入模块。那应该让你开始。

# c# - 整数溢出 - 将 C# 转换为 VB.Net 代码

> ID：12713562
> 
> 赞同：3
> 
> 时间：2012-10-03T17:18:08.770
> 
> 标签：c#, vb.net, int, overflow

从 C# 到 VB.Net 的代码转换出现问题。

```
var x = 5783615;
var y = 56811584;
var t = x * y; 
```

x、y 和 t 是整数。在 c# 中，'t' 将为 -15536​​49728。在 VB.Net 中，我会得到一个整数溢出异常。

知道如何解决吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T17:22:18.860

默认情况下，C# 不检查溢出，但 VB 会（默认情况下）。

您可以将 VB 项目设置为不在“编译”选项卡的“高级编译选项”中检查整数溢出。在这种情况下，这将导致该特定项目停止引发[OverflowException](http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T18:28:11.740

通过以 64 位计算乘积，然后仅使用 32 位结果，您可以获得与 C# 忽略溢出相同的值：

```
Dim x As Integer = 5783615
Dim y As Integer = 56811584
Dim tmp As Int64 = Convert.ToInt64(x) * Convert.ToInt64(y)

Dim bb = BitConverter.GetBytes(tmp)
Dim t = BitConverter.ToInt32(bb, 0)
' t is now -1553649728 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:24:58.137

您需要显式类型定义来避免这种情况，因为定义将隐式地从值中获取。在 vb.net 中尝试：

```
dim x as int = 5783615
dim y as int = 56811584
dim t as int = x * y 
```

可能还有其他方法可以做到这一点，但这应该是一个开始。在 C# 中，您也可以尝试使用 int 或 int32 或 int64。

祝你好运。

# java - Java Swing：为什么必须调整框架大小，这样才能显示组件已添加

> ID：12713563
> 
> 赞同：4
> 
> 时间：2012-10-03T17:18:08.970
> 
> 标签：java, swing, layout, jframe, jscrollpane

我有一个简单的 Swing GUI。（不仅如此，我写的所有摇摆GUI）。运行它时，除了空白屏幕，它什么都不显示，直到我调整主框架的大小，所以每个组件都重新绘制，我可以显示它们。

这是我的简单代码：

```
public static void main(String[] args) {
        JFrame frame = new JFrame("JScroll Pane Test");
        frame.setVisible(true);
        frame.setSize(new Dimension(800, 600));

        JTextArea txtNotes = new JTextArea();
        txtNotes.setText("Hello World");
        JScrollPane scrollPane = new JScrollPane(txtNotes);
        frame.add(scrollPane);
} 
```

所以，我的问题是：当我开始这个课程时，框架会出现我添加的所有组件，直到我调整框架大小。

谢谢 ：）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-03T17:21:36.643

*   不要在可见 ( )`JFrame`之后添加组件`JFrame``setVisible(true)`

*   `setSize()`调用框架而不是调用`pack()`（导致`JFrame`调整大小以适应其子组件的首选大小和布局）并让`LayoutManager`处理大小并不是一个很好的做法。

*   使用[EDT](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)（事件调度线程）

*   像@Gilbert Le Blanc所说的那样打电话`JFrame#setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE)`（给他+1），否则你的EDT/Initial线程即使在*关闭*`JFrame`后也将保持活动状态

 *像这样：

```
public static void main(String[] args) {
        //Create GUI on EDT Thread
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {

                  JFrame frame = new JFrame("JScroll Pane Test");
                  frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);  

                  JTextArea txtNotes = new JTextArea();
                  txtNotes.setText("Hello World");
                  JScrollPane scrollPane = new JScrollPane(txtNotes);
                  frame.add(scrollPane);//add components

                  frame.pack();
                  frame.setVisible(true);//show (after adding components)
            }
        });
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-03T17:26:46.690

您的简单代码缺少一些东西。

您必须调用`SwingUtilities`以将 Swing 组件放在事件分派线程上。

你应该`setDefaultCloseOperation`在`JFrame`.

您必须以`JFrame`正确的顺序调用这些方法。`setSize`or`pack`方法被调用，然后该方法`setVisible`被最后调用。

```
public class SimpleFrame implements Runnable {

    @Override
    public void run() {
        JFrame frame = new JFrame("JScroll Pane Test");

        JTextArea txtNotes = new JTextArea();
        txtNotes.setText("Hello World");
        JScrollPane scrollPane = new JScrollPane(txtNotes);
        frame.add(scrollPane);

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);    
        frame.setSize(new Dimension(800, 600));
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new SimpleFrame());
    }

} 
```*

# javascript - JavaScript 中只能调用一次的函数

> ID：12713564
> 
> 赞同：135
> 
> 时间：2012-10-03T17:18:09.913
> 
> 标签：javascript, function, design-patterns

我需要创建一个只能执行一次的函数，在第一次之后的每次都不会执行。我从 C++ 和 Java 知道可以完成这项工作的静态变量，但我想知道是否有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：269
> 
> 时间：2012-10-03T17:20:49.053

如果“不会被执行”是指“多次调用时什么都不做”，则可以创建一个闭包：

```
var something = (function() {
    var executed = false;
    return function() {
        if (!executed) {
            executed = true;
            // do something
        }
    };
})();

something(); // "do something" happens
something(); // nothing happens 
```

回复@Vladloffe 的评论（现已删除）：使用全局变量，其他代码可以重置“已执行”标志的值（无论您选择什么名称）。使用闭包，其他代码无法做到这一点，无论是无意的还是有意的。

正如这里的其他答案所指出的那样，几个库（例如[Underscore](http://underscorejs.org/)和[Ramda](http://ramdajs.com/)）有一个小实用函数（通常命名为`once()`^([*])），它接受一个函数作为参数并返回另一个函数，该函数只调用一次提供的函数，不管如何多次调用返回的函数。返回的函数还缓存提供的函数首先返回的值，并在后续调用中返回该值。

但是，如果您不使用这样的第三方库，但仍然想要一个实用函数（而不是我上面提供的 nonce 解决方案），那么它很容易实现。我见过的最好的版本是[David Walsh 发布的](https://davidwalsh.name/javascript-once)：

```
function once(fn, context) { 
    var result;
    return function() { 
        if (fn) {
            result = fn.apply(context || this, arguments);
            fn = null;
        }
        return result;
    };
} 
```

我倾向于更改`fn = null;`为`fn = context = null;`. 没有理由让闭包保持对`context`一次`fn`被调用的引用。

用法：

```
function something() { /* do something */ }
var one_something = once(something);

one_something(); // "do something" happens
one_something(); // nothing happens 
```

* * *

^([*]) [但是请注意，其他库，例如[这个 Drupal 对 jQuery 的扩展](https://www.drupal.org/node/444344)，可能有一个名为的函数`once()`，它的作用完全不同。]

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2012-10-03T17:20:45.303

将其替换为可重复使用的 NOOP *（无操作）*功能。

```
// this function does nothing
function noop() {};

function foo() {
    foo = noop; // swap the functions

    // do your thing
}

function bar() {
    bar = noop; // swap the functions

    // do your thing
} 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2014-05-15T17:44:53.223

## 调用后指向一个*空*函数：

```
function myFunc(){
     myFunc = function(){}; // kill it as soon as it was called
     console.log('call once and never again!'); // your stuff here
};
```

```
<button onClick=myFunc()>Call myFunc()</button>
```

* * *

## 或者，像这样：

```
var myFunc = function func(){
     if( myFunc.fired ) return;
     myFunc.fired = true;
     console.log('called once and never again!'); // your stuff here
};

// even if referenced & "renamed"
((refToMyfunc)=>{
  setInterval(refToMyfunc, 1000);
})(myFunc)
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2012-10-03T17:20:18.273

UnderscoreJs 有一个功能，[underscorejs.org /#once](http://underscorejs.org/#once)

```
 // Returns a function that will be executed at most one time, no matter how
  // often you call it. Useful for lazy initialization.
  _.once = function(func) {
    var ran = false, memo;
    return function() {
      if (ran) return memo;
      ran = true;
      memo = func.apply(this, arguments);
      func = null;
      return memo;
    };
  }; 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-03-14T10:12:06.200

谈到静态变量，这有点像闭包变体：

```
var once = function() {
    if(once.done) return;
    console.log('Doing this once!');
    once.done = true;
};

once(); once(); 
```

然后，您可以根据需要重置功能：

```
once.done = false; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-10-03T17:26:38.750

您可以简单地使用“删除自身”功能

```
​function Once(){
    console.log("run");

    Once = undefined;
}

Once();  // run
Once();  // Uncaught TypeError: undefined is not a function 
```

但是，如果您不想吞下错误，这可能不是最好的答案。

你也可以这样做：

```
function Once(){
    console.log("run");

    Once = function(){};
}

Once(); // run
Once(); // nothing happens 
```

*我需要它像智能指针一样工作，如果没有 A 类型的元素可以执行，如果有一个或多个 A 元素，则无法执行函数。*

```
function Conditional(){
    if (!<no elements from type A>) return;

    // do stuff
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-10-03T17:19:27.943

```
var quit = false;

function something() {
    if(quit) {
       return;
    } 
    quit = true;
    ... other code....
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-04-16T10:26:48.950

From some dude named Crockford... :)

```
function once(func) {
    return function () {
        var f = func;
        func = null;
        return f.apply(
            this,
            arguments
        );
    };
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-10-03T17:22:58.550

尝试这个

```
var fun = (function() {
  var called = false;
  return function() {
    if (!called) {
      console.log("I  called");
      called = true;
    }
  }
})() 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-04-27T23:50:45.253

Reusable `invalidate` function which works with `setInterval`:

```
var myFunc = function (){
  if (invalidate(arguments)) return;
  console.log('called once and never again!'); // your stuff here
};

const invalidate = function(a) {
  var fired = a.callee.fired;
  a.callee.fired = true;
  return fired;
}

setInterval(myFunc, 1000); 
```

Try it on JSBin: [https://jsbin.com/vicipar/edit?js,console](https://jsbin.com/vicipar/edit?js,console)

Variation of [answer from Bunyk](//stackoverflow.com/a/35984663/4592648)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-07-14T08:12:49.857

简单的装饰器，在需要时易于编写

```
function one(func) {
  return function () {
     func && func.apply(this, arguments);
     func = null;
  }
} 
```

使用：

```
var initializer= one( _ =>{
      console.log('initializing')
  })

initializer() // 'initializing'
initializer() // nop
initializer() // nop 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-12-09T12:02:17.703

如果您使用 Node.js 或使用 browserify 编写 JavaScript，请考虑使用[“once”npm 模块](https://www.npmjs.org/package/once)：

```
var once = require('once')

function load (file, cb) {
  cb = once(cb)
  loader.load('file')
  loader.once('load', cb)
  loader.once('error', cb)
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-10-28T08:55:47.597

最初设定：

```
var once = function( once_fn ) {
    var ret, is_called;
    // return new function which is our control function 
    // to make sure once_fn is only called once:
    return function(arg1, arg2, arg3) {
        if ( is_called ) return ret;
        is_called = true;
        // return the result from once_fn and store to so we can return it multiply times:
        // you might wanna look at Function.prototype.apply:
        ret = once_fn(arg1, arg2, arg3);
        return ret;
    };
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-07-02T14:54:47.017

这是一个示例 JSFiddle - [http://jsfiddle.net/6yL6t/](http://jsfiddle.net/6yL6t/)

和代码：

```
function hashCode(str) {
    var hash = 0, i, chr, len;
    if (str.length == 0) return hash;
    for (i = 0, len = str.length; i < len; i++) {
        chr   = str.charCodeAt(i);
        hash  = ((hash << 5) - hash) + chr;
        hash |= 0; // Convert to 32bit integer
    }
    return hash;
}

var onceHashes = {};

function once(func) {
    var unique = hashCode(func.toString().match(/function[^{]+\{([\s\S]*)\}$/)[1]);

    if (!onceHashes[unique]) {
        onceHashes[unique] = true;
        func();
    }
} 
```

你可以这样做：

```
for (var i=0; i<10; i++) {
    once(function() {
        alert(i);
    });
} 
```

它只会运行一次:)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-03-21T01:31:10.637

如果您希望将来能够重用该功能，那么根据上面 ed Hopp 的代码，这可以很好地工作（我意识到最初的问题并没有要求这个额外的功能！）：

```
 var something = (function() {
   var executed = false;              
    return function(value) {
        // if an argument is not present then
        if(arguments.length == 0) {               
            if (!executed) {
            executed = true;
            //Do stuff here only once unless reset
            console.log("Hello World!");
            }
            else return;

        } else {
            // otherwise allow the function to fire again
            executed = value;
            return;
        }       
    }
})();

something();//Hello World!
something();
something();
console.log("Reset"); //Reset
something(false);
something();//Hello World!
something();
something(); 
```

输出如下所示：

```
Hello World!
Reset
Hello World! 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-03-04T04:53:31.500

仅打开一次灯的简单示例。

```
function turnOnLightOnce() {
  let lightOn = false;

  return function () {
    if (!lightOn) {
      console.log("Light is not on...Turning it on for first and last time");
      lightOn = true;
    }

  };
}

const lightOn = turnOnLightOnce();
lightOn()  // Light is not on...Turning it on for first and last time
lightOn()
lightOn()
lightOn()
lightOn() 
```

[https://codesandbox.io/s/javascript-forked-ojo0i?file=/index.js](https://codesandbox.io/s/javascript-forked-ojo0i?file=/index.js)

这是由于 JavaScript 中的闭包造成的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-04-17T11:15:34.107

尝试使用下划线“一次”功能：

```
var initialize = _.once(createApplication);
initialize();
initialize();
// Application is only created once. 
```

[http://underscorejs.org/#once](http://underscorejs.org/#once)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-04-07T19:47:25.537

**[JQuery 只允许使用one()](https://api.jquery.com/one/)方法调用该函数一次：**

```
let func = function() {
  console.log('Calling just once!');
}

let elem = $('#example');

elem.one('click', func);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div>
  <p>Function that can be called only once</p>
  <button id="example" >JQuery one()</button>
</div>
```

**使用 JQuery 方法[on()](https://api.jquery.com/on/)实现：**

```
let func = function(e) {
  console.log('Calling just once!');
  $(e.target).off(e.type, func)
}

let elem = $('#example');

elem.on('click', func);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div>
  <p>Function that can be called only once</p>
  <button id="example" >JQuery on()</button>
</div>
```

**使用原生 JS 实现：**

```
let func = function(e) {
  console.log('Calling just once!');
  e.target.removeEventListener(e.type, func);
}

let elem = document.getElementById('example');

elem.addEventListener('click', func);
```

```
<div>
  <p>Functions that can be called only once</p>
  <button id="example" >ECMAScript addEventListener</button>
</div>
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-08-20T09:52:53.613

尽可能简单

```
function sree(){
  console.log('hey');
  window.sree = _=>{};
} 
```

你可以看到结果

![脚本结果](../Images/aa16ef61f908794235b107a269bac87e.png)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-01-13T17:58:03.980

```
var init = function() {
    console.log("logges only once");
    init = false;
}; 

if(init) { init(); }

/* next time executing init() will cause error because now init is 
   -equal to false, thus typing init will return false; */ 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-05-25T16:01:32.510

如果你使用 Ramda，你可以使用函数["once"](http://ramdajs.com/docs/#once)。

文档中的引用：

> 一次函数 (a… → b) → (a… → b) 参数在 v0.1.0 中添加
> 
> 接受一个函数 fn 并返回一个保护 fn 调用的函数，这样 fn 只能被调用一次，无论返回的函数被调用多少次。计算的第一个值在后续调用中返回。

```
var addOneOnce = R.once(x => x + 1);
addOneOnce(10); //=> 11
addOneOnce(addOneOnce(50)); //=> 11 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-02-12T14:32:57.077

```
if (!window.doesThisOnce){
  function myFunction() {
    // do something
    window.doesThisOnce = true;
  };
}; 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-08-23T00:42:07.333

把我的帽子扔进戒指中以获得乐趣，增加了记忆的优势

```
const callOnce = (fn, i=0, memo) => () => i++ ? memo : (memo = fn()); 
```

```
// usage
const myExpensiveFunction = () => { return console.log('joe'),5; }
const memoed = callOnce(myExpensiveFunction);
memoed(); //logs "joe", returns 5
memoed(); // returns 5
memoed(); // returns 5
... 
```

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2016-04-01T23:51:56.620

这对于防止无限循环很有用（使用 jQuery）：

```
<script>
var doIt = true;
if(doIt){
  // do stuff
  $('body').html(String($('body').html()).replace("var doIt = true;", 
                                                  "var doIt = false;"));
} 
</script> 
```

如果您担心命名空间污染，请用一个长的随机字符串替换“doIt”。

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2016-05-11T08:45:37.697

它有助于防止粘性执行

```
var done = false;

function doItOnce(func){
  if(!done){
    done = true;
    func()
  }
  setTimeout(function(){
    done = false;
  },1000)
} 
```

# c# - 是否应该只记录错误消息？

> ID：12713571
> 
> 赞同：2
> 
> 时间：2012-10-03T17:18:23.720
> 
> 标签：c#, logging, nlog

我刚开始使用 NLog 和一般的日志记录，但我发现自己可能过度滥用它。我正在记录每一行代码，其中大部分是 Info 消息，但在我的 try catch 场景中，或者如果某些内容为空，我将记录一个错误。什么是最好的记录？

我将其用于具有 2 个项目的 WPF 解决方案（1 个是 UI，另一个是类库）

```
<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <!-- make sure to set 'Copy To Output Directory' option for this file -->
  <!-- go to http://nlog-project.org/wiki/Configuration_file for more information -->

  <targets>
        <target name="errorLog" xsi:type="File" fileName="${basedir}/error.txt" />
      <target name="infoLog" xsi:type="File" fileName="${basedir}/info.txt" />
    </targets>

    <rules>
        <logger name="*" level="Error" writeTo="errorLog" />
      <logger name="*" level="Info" writeTo="infoLog" />
    </rules>
</nlog> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:20:54.837

NLog 支持日志级别的概念。

使用低于 Error 的级别记录任何可能有助于跟踪程序为何执行此操作的内容是一个好主意。部署应用程序时，在 NLog.config 中将所需的日志记录级别设置为错误。

[http://nlog-project.org/wiki/Log_Levels](http://nlog-project.org/wiki/Log_Levels)

如果用户遇到意外问题，您可以将日志级别更改为例如 Info 并获取有关正在发生的事情的更多信息。

话虽如此，*每一行代码*几乎肯定是矫枉过正。如果你走到那个极端，你的代码就会被日志记录弄得乱七八糟。

专注于应用程序中可能出现问题的地方。

我个人的偏好是：

*   使用 Trace 级别来指示代码的流向（进入一个方法，退出一个方法）
*   使用信息级别指示关键计算中的进度/步骤
*   使用错误级别来指示应用程序可以从中恢复的意外情况
*   使用致命级别表示发生了非常糟糕的事情并且应用程序即将关闭。

# android - 如何跨浏览器标准化 Helvetica Neue 行高（不是粗体文本）？

> ID：12713580
> 
> 赞同：8
> 
> 时间：2012-10-03T17:18:56.510
> 
> 标签：android, fonts, cross-browser, css

因此，我正在开发一个需要跨多种浏览器运行的网站，无论是桌面浏览器、移动浏览器还是您拥有的浏览器。正如 mac 设计师经常做的那样，设计师们使用 Helvetica Neue 作为整个网站的字体。我试图通过@font 包含来让它工作，它显示得很好.. 但是线高给了我一个溃疡。

见下图，这是 Arial、Helvetica Neue Std 和 Helvetica Neue Pro。Windows Chrome 像冠军一样处理所有这三个，但这里的其余部分非常不一致。它们现在都设置为 line-height 18px，我也尝试了 line-height: 1，但无济于事。

![坚果](../Images/9a3fbe43add38292da3629212e20a70d.png)

我用于此测试的 HTML/CSS：

```
<style type="text/css">

    @font-face { font-family: "Helvetica Neue Std"; src: url( 'HelveticaNeueLTStd-Md.otf' ) format( "opentype" ); }
    @font-face { font-family: "Helvetica Neue Pro"; src: url( 'HelveticaNeueLTPro-Md.otf' ) format( "opentype" ); }

    .box {
        float: left;
        padding: 10px;
        border: 1px solid red;
        font-size: 18px;
        line-height: 18px;
    }

    .box .text_1 { font-family: Arial; }
    .box .text_2 { font-family: "Helvetica Neue Std" }
    .box .text_3 { font-family: "Helvetica Neue Pro" }

</style>

<div class="box">
    <span class="text_1">Aw Nuts</span>
</div>

<div class="box">
    <span class="text_2">Aw Nuts</span>
</div>

<div class="box">
    <span class="text_3">Aw Nuts</span>
</div> 
```

我只是在这里不走运吗？我现在正在考虑只使用 Arial，因为试图制作文本垂直居中的工具栏和按钮被证明是一场噩梦。我*当然*不想嗅探操作系统和浏览器并为每个元素编写自定义行高。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T04:21:47.983

我可以提供这篇深入的背景文章，[说明为什么行高很痛苦](http://webfonts.info/webfonts-know-how/part-2-problem-line-height)。

总之，不同浏览器处理垂直间距度量的方式可能是导致这些不一致的原因。一些从字体最高升序的顶部开始计算，并在下面添加所有行间距，而另一些则分割文本行前后的间距。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-05T16:04:15.470

这看起来像一个`vertival metrics`问题。字体永远不会正确对齐，因为它的*垂直度量*很差。使字体在浏览器中一致呈现的唯一方法是修复它的*垂直度量*。

大多数字体提供商允许您在下载字体之前更新和修复字体的*垂直指标。*不过，他们可能会以不同的方式调用该选项。例如：*Fontsquirrel*调用它`Auto-Adjust Vertical Metrics`，*myFonts.com*调用它`Line Height Adjustments`，等等。

[字体：较差的垂直度量会导致跨浏览器的行高呈现不一致。解决方案？](https://stackoverflow.com/questions/33633992/font-poor-vertical-metrics-cause-inconsistent-line-height-rendering-across-brow/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T04:03:09.700

请试试这个。

```
*{
   margin: 0px;
   padding: 0px;
   font-size: 100%;
   vertical-align: baseline;
 } 
```

font-size: 100% 将自动重置您的字体默认值，您需要在 pa div 等上手动指定字体大小。

# c# - InfoPath 开发 IDE？

> ID：12713581
> 
> 赞同：0
> 
> 时间：2012-10-03T17:18:58.707
> 
> 标签：c#, visual-studio-2010, infopath-2007

我需要一些有关为 InfoPath 创建“适当”开发环境的指导。这是我所拥有的：

1 - 一个包含大量代码的现有 InfoPath 表单模板，到目前为止，我一直在使用基本的 MS 脚本编辑器进行编辑

2 - 信息路径 2007

3 - 视觉工作室 2010

我在 VS 中找不到任何明显的东西来表明开发 Infopath 表单的能力 - 我只找到 InfoPath 加载项的条目。

如何组合这些工具以便在 VS 中开发我的 InfoPath 代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T16:10:28.120

我也开发 InfoPath 表单，我很同情你和在 Visual Studio 中工作的愿望。对于习惯于 VS 2008、2010 或 2012 的任何人来说，MSE 都是非常简单的，而且在那种环境中工作很烦人。

在为 InfoPath 表单开发代码时，您可以选择 MSE 或 Microsoft Visual Studio Tools for Applications (VSTA)，但我相信 VSTA 仅支持托管语言 (C#/VB)。

从现在的位置进入 Visual Studio 的唯一方法是从 javascript 切换到 .net。

参考：[关于 InfoPath 编程环境](http://msdn.microsoft.com/en-us/library/office/bb250982%28v=office.12%29.aspx)

# list - 如何从两个已经排序的列表中创建一个排序列表

> ID：12713586
> 
> 赞同：3
> 
> 时间：2012-10-03T17:19:22.580
> 
> 标签：list, sorting, merge, prolog

在 Prolog 中，我必须想办法将两个已经排序的列表组合成一个排序列表。换句话说：我必须从 2 个列表中比较头部并将最小的添加到新列表中。我想我已经走得很远了，但不知何故它就是行不通，我不知道为什么不行。顺便说一句，我没有收到任何错误。它只是`false`回馈。

所以，我希望有人能告诉我我做错了什么。

```
sort([],L,L).
sort(L,[],L).
sort([Head1|Tail1],[Head2|Tail2],L) :- 
    Head1 < Head2 -> append([Head1],L,L2), sort(Tail1,[Head2|Tail2],L2) ; 
    Head1 > Head2 -> append([Head2],L,L2), sort([Head1|Tail1],Tail2,L2) ; 
    Head1 == Head2 -> append([Head1],L,L2), append([Head2],L2,L3), 
                                            sort(Tail1,Tail2,L3). 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T17:57:41.963

您应该稍微简化一下代码：

```
sort([],L,L).
sort(L,[],L).
sort([Head1|Tail1], [Head2|Tail2], L) :- 
    Head1 < Head2 -> L = [Head1|R], sort(Tail1,[Head2|Tail2],R) ;
    Head1 > Head2 -> L = [Head2|R], sort([Head1|Tail1],Tail2,R) ;
    L = [Head1,Head2|R], sort(Tail1,Tail2,R). 
```

测试：

```
?- sort([1,2,4,5,18],[1,3,5,10],R).
R = [1, 2, 3, 4, 5, 10, 18] . 
```

命名这样的谓词*排序*确实会产生误导，*合并*会更好....

*edit* `L = [Head1,Head2|R]`而不是`L = [Head1|R]`where Head1=Head2 （之前的测试失败）背离了 sort/2 Prolog 语义，它删除了重复项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T17:27:36.867

在 SWI Prolog 中有一个`merge/3`内置的谓词可以做到这一点。所以你不应该把你的谓词称为“排序”；它不是。这是“合并”。

接下来，让我们阅读您的定义。

```
merge([H1|T1], [H2|T2], L) :- 
```

意思是，合并两个列表会产生合并的列表`L`。到目前为止，一切都很好。

```
 H1 < H2 -> append([H1],L,L2), merge(T1,[H2|T2],L2) 
```

意味着，如果`H1 < H2`，在*答案列表* `L`前加上give ，`H1`这`L2`是合并的结果……等等，什么？那有意义吗？

Prolog 不是基本的。我们写的不是“做”事情的“命令” [（嗯，它们是，但以一种迂回的方式）]。如果我们想说那`H1`是 的头部元素`L`，我们说：

```
 L = [H1|L2],        merge(T1,[H2|T2],L2) 
        %% or: append([H1],L2,L), 
```

等等。现在这是有道理的。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-17T12:23:06.197

从您问题中的代码来看，您正在合并排序的数字列表。如果这些数字都是整数并且您的 Prolog 系统提供[clpfd](/questions/tagged/clpfd "显示标记为“clpfd”的问题")，请考虑使用此处提供的代码。为什么？

*   该实现保留了[逻辑纯度](/questions/tagged/logical-purity "显示标记为“逻辑纯度”的问题")。
*   代码是单调的，使其健壮和灵活：即使在处理非地面数据时，也总是能得到逻辑上合理的答案。
*   主谓词`sorted1_sorted2_merged/3`表现得像一个真实的关系。
*   与 builtin 不同`sort/2`，此代码保留所有重复项（完全相同的多重性）。
*   关于要合并的列表中的相等项目，它的行为是合理的：输入#1 中的项目等于输入#2 中的某些项目，然后是合并结果中的项目。
*   从某种意义上说，该实现是有效的，它不会留下无用的选择点，如`sorted1_sorted2_merged([1,3,5],[2,4,5,6],Zs)`.

事不宜迟......这是代码：

```
:- use_module(library(clpfd)).

sorted1_sorted2_merged([]    ,Ys,Ys).
sorted1_sorted2_merged([X|Xs],Ys,Zs) :-
   sorted2_hd1_tl1_merged(Ys,X,Xs,Zs).

hd1_tl1_hd2_tl2_merged(X,Xs,Y,Ys,Zs) :-
   zcompare(Op,X,Y),
   op_hd1_tl1_hd2_tl2_merged(Op,X,Xs,Y,Ys,Zs).

sorted1_hd2_tl2_merged([]    ,Y,Ys,[Y|Ys]).
sorted1_hd2_tl2_merged([X|Xs],Y,Ys,Zs) :- 
   hd1_tl1_hd2_tl2_merged(X,Xs,Y,Ys,Zs).

sorted2_hd1_tl1_merged([]    ,X,Xs,[X|Xs]).
sorted2_hd1_tl1_merged([Y|Ys],X,Xs,Zs) :-
   hd1_tl1_hd2_tl2_merged(X,Xs,Y,Ys,Zs).

op_hd1_tl1_hd2_tl2_merged(<,X,Xs,Y,Ys,[X|Zs]) :-
   sorted1_hd2_tl2_merged(Xs,Y,Ys,Zs).
op_hd1_tl1_hd2_tl2_merged(=,X,Xs,Y,Ys,[X|Zs]) :- 
   sorted1_hd2_tl2_merged(Xs,Y,Ys,Zs).
op_hd1_tl1_hd2_tl2_merged(>,X,Xs,Y,Ys,[Y|Zs]) :- 
   sorted1_hd2_tl2_merged(Ys,X,Xs,Zs). 
```

关于一些查询！第一的：

```
?- sorted1_sorted2_merged([1,3,4,6],[2,4,5,5,7],Xs).
Xs = [1,2,3,4,4,5,5,6,7].         % succeeds deterministically 
```

它是否也适用于“其他方向”？

```
?- sorted1_sorted2_merged([1,3,4,6],Ys,[1,2,3,4,4,5,5,6,7]).
Ys = [2,4,5,5,7] ;                % succeeds, but leaves behind choicepoint
false.

?- sorted1_sorted2_merged(Xs,[2,4,5,5,7],[1,2,3,4,4,5,5,6,7]).
Xs = [1,3,4,6] ;                  % succeeds, but leaves behind choicepoint
false. 
```

最后，一个非常普遍的用法：

```
?- sorted1_sorted2_merged(Xs,Ys,[0,1,2,3]).
Xs = [       ], Ys = [0,1,2,3] ;
Xs = [0,1,2,3], Ys = [       ] ;
Xs = [0      ], Ys = [  1,2,3] ;
Xs = [0,1    ], Ys = [    2,3] ;
Xs = [0,1,2  ], Ys = [      3] ;
Xs = [0,1,  3], Ys = [      2] ;
Xs = [0,  2,3], Ys = [      1] ;
Xs = [0,    3], Ys = [  1,2  ] ;
Xs = [0,  2  ], Ys = [  1,  3] ;
Xs = [  1,2,3], Ys = [0      ] ;
Xs = [    2,3], Ys = [0,1    ] ;
Xs = [      3], Ys = [0,1,2  ] ;
Xs = [    2  ], Ys = [0,1,  3] ;
Xs = [  1    ], Ys = [0,  2,3] ;
Xs = [  1,2  ], Ys = [0,    3] ;
Xs = [  1,  3], Ys = [0,  2  ] ;
false. 
```

# performance - OpenGL 性能

> ID：12713594
> 
> 赞同：-1
> 
> 时间：2012-10-03T17:19:39.657
> 
> 标签：performance, opengl

首先让我稍微解释一下应用程序。这是一款视频安全软件，可以同时显示多达 48 个摄像头。每个视频流都有自己的 Windows HDC，但它们都使用共享的 OpenGL 上下文。我使用 OpenGL 获得了相当不错的性能，它可以在 Windows/Linux/Mac 上运行。在后台，上下文是使用 wxWidgets 2.8 wxGLCanvas 创建的，但我认为这与问题无关。

现在问题来了。假设我使用同一个相机并将其显示在我的所有 48 个窗口中。这基本上意味着我只解码 30fps（无论如何都是在不同的线程上完成的）但显示高达 1440fps 以从图片中提取解码。我正在使用 PBO 来传输图像，这取决于是否支持像素着色器和多纹理，我可以使用它们在 GPU 上进行 YUV->RGB 转换。然后我使用四边形来定位纹理并调用 SwapBuffers。所有的 OpenGL 调用都来自 UI 线程。此外，我尝试在 CPU 上进行 YUV->RGB 转换，并搞砸了使用 GL_RGBA 和 GL_BGRA 纹理，但所有格式仍然产生大致相同的性能。现在的问题是我只能从可能的 1440fps 中得到大约 1000fps（我知道我不应该以 fps 来衡量，但在这种情况下更容易）。上述场景使用 320x240 (YUV420) 视频，大约只有 110MB/秒。如果我使用 1280x720 相机，那么我得到的帧速率大致相同，接近 1.3GB/秒。这告诉我，这肯定不是纹理上传速度。如果我在 CPU 上进行 YUV->RGB 转换和缩放并使用 Windows DC 进行绘画，那么我可以轻松获得完整的 1440fps。

另一件要提到的事情是，我已经在我的视频卡上和通过 OpenGL 使用 wglSwapIntervalEXT 禁用了 vsync。也没有报告 OpenGL 错误。但是，使用 very sleepy 来分析应用程序似乎大部分时间都花在了 SwapBuffers 中。我假设这个问题与我在某处使用多个 HDC 或 SwapBuffers 有某种关系，但是，我不确定我正在做的其他事情。

我不是 OpenGL 方面的专家，所以如果有人有任何建议或任何我想听听的意见。如果我正在做的任何事情听起来是错误的，或者我可以更有效地实现同样的事情，我很想听听。

以下是 glIntercept 日志的一些链接，以便更好地了解所有正在进行的 OpenGL 调用：

简单 RGB：[https ://docs.google.com/open?id=0BzGMib6CGH4TdUdlcTBYMHNTRnM](https://docs.google.com/open?id=0BzGMib6CGH4TdUdlcTBYMHNTRnM)

着色器 YUV：[https ://docs.google.com/open?id=0BzGMib6CGH4TSDJTZGxDanBwS2M](https://docs.google.com/open?id=0BzGMib6CGH4TSDJTZGxDanBwS2M)

分析信息：所以在分析之后报告了几个冗余的状态变化，我对此并不感到惊讶。我消除了所有这些，并没有看到我预期的明显性能差异。每个渲染循环有 34 个状态更改，并且我使用了几个不推荐使用的函数。我将研究使用可以解决这些问题的顶点数组。但是，我每个渲染循环只做一个四边形，所以我真的不期望这会对性能产生太大影响。另外请记住，我不想把所有东西都撕掉并全部使用 VBO，因为我仍然需要支持一些我认为只有 OpenGL 1.4 的相当老的英特尔芯片组驱动程序。

真正让我感兴趣并且之前没有想到的事情是每个上下文都有自己的前后缓冲区。由于我只使用一个上下文，因此之前的 HDC 渲染调用必须在交换发生之前完成对后台缓冲区的写入，然后下一个可以再次开始写入后台缓冲区。使用多个上下文真的会更有效吗？或者我应该考虑渲染到纹理（我认为是 FBO）并继续使用一个上下文？

编辑：使用多个 OpenGL 上下文提到的原始描述，但我错了，我只使用一个 OpenGL 上下文和多个 HDC。EDIT2：在使用 gDEBugger 进行分析后添加了一些信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-10T11:25:09.417

我试图让您的应用程序更快。我创建了一个 OpenGL 渲染线程（如果您有 2 个或更多显卡，则创建更多）。显卡无法一次处理多个上下文，您的多个 OpenGL 上下文正在等待其中一个上下文。这个线程只会让 OpenGL 工作，比如 YUV->RGB 转换（使用 FBO 渲染到纹理）。Camere 的线程将图像发送到该线程，UI 线程可以将其拾取并显示在窗口上。您可以在 OpenGL 上下文中处理查询，并且可以将多个帧组合到一个纹理中以通过一次转换来转换它。它可能很有用，因为您最多有 48 个摄像头。作为另一个变体，如果 OpenGL 线程现在很忙，您可以在 CPU 上转换一些帧。

从日志中我看到您经常调用相同的方法：

```
glEnable(GL_TEXTURE_2D)
glMatrixMode(GL_TEXTURE)
glLoadIdentity()
glColor4f(1.000000,1.000000,1.000000,1.000000) 
```

您可以在每个上下文中调用一次，而不是为每个渲染调用一次。

如果我理解正确，您对 YUV 的每个平面使用 3 个纹理

```
glTexSubImage2D(GL_TEXTURE_2D,0,0,0,352,240,GL_LUMINANCE,GL_UNSIGNED_BYTE,00000000)
glTexSubImage2D(GL_TEXTURE_2D,0,0,0,176,120,GL_LUMINANCE,GL_UNSIGNED_BYTE,000000)
glTexSubImage2D(GL_TEXTURE_2D,0,0,0,176,120,GL_LUMINANCE,GL_UNSIGNED_BYTE,00000000) 
```

尝试使用一种纹理并在着色器中使用计算来为像素获取正确的 YUV 值。有可能，我在我的应用程序中做到了。

# email - drupal Commerce 上的事件错误

> ID：12713596
> 
> 赞同：0
> 
> 时间：2012-10-03T17:19:45.730
> 
> 标签：email, drupal, drupal-commerce

当一个人完成订单时，我已经做了一个事件，他/她的订单会发送一封电子邮件给我，而他/她的订单最初不是一个事件。但是当有人在我的商业网站上完成订单时，我不断收到此错误。虽然电子邮件是发给我的。你能帮帮我吗？

注意：未定义索引：待定 rules_action_mail()（第 90 行 /home/content/60/9584160/html/profiles/commerce_kickstart/modules/rules/modules/system.eval.inc）。注意：未定义索引：待定 rules_action_mail()（第 90 行 /home/content/60/9584160/html/profiles/commerce_kickstart/modules/rules/modules/system.eval.inc）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T18:47:34.133

快速搜索错误消息显示您可能只需要应用补丁： [http ://drupal.org/node/1490136](http://drupal.org/node/1490136)

或者，如有必要，最好将您的规则模块更新到最新版本。

# java - 如何使用 Scanner.hasNext 填充多个数组值？

> ID：12713598
> 
> 赞同：0
> 
> 时间：2012-10-03T17:19:51.393
> 
> 标签：java, java.util.scanner

我有一系列骰子，对于每个骰子，我都需要提示用户是否愿意重新掷骰子。最简单的方法似乎是 Scanner 类的提示 - 我检查他们输入的内容并正确处理。但是，如果用户输入中不存在请求的数据，scanner.next() 将抛出异常。所以，scanner.hasnext() 需要以某种方式适应这里。

这是我的代码；它会将条目输入到响应数组中，但如果用户输入既不包含 Y 也不包含 N，则会引发异常。

```
public Boolean[] chooseDice(int diceNum){
    Boolean[] responses = new Boolean[diceNum];
    Scanner scansworth = new Scanner(System.in);
    for (int i=0; i<diceNum; i++){
        System.out.printf("Reroll this die? (%d)\n",i);
                responses[i] = (scansworth.next("[YN]")) == "Y" ? true : false;
    }
        return responses; 
```

如何调用 scansworth.hasNext("[YN]") 以便解释器不会锁定并在循环的每个步骤之后正确检查条目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:28:32.847

您可以将读取用户输入的代码用一段时间包围，以检查用户输入是否处于给定模式.. 使用`hasNext("[YN]")`.. 此外，您不需要`scanner.next([YN])`.. 只需使用`next()`.. 它会获取您输入的下一行，您可以将其与“Y”进行比较..

```
 for (int i=0; i<diceNum; i++){
           int count = 0;
           System.out.printf("Reroll this die? (%d)\n",i);

           // Give three chances to user for correct input.. 
           // Else fill this array element with false value..

           while (count < 3 && !scansworth.hasNext("[YN]")) {
               count += 1;  // IF you don't want to get into an infinite loop
               scansworth.next();
           }    

           if (count != 3) {
                /** User has entered valid input.. check it for Y, or N **/
                responses[i] = (scansworth.next()).equals("Y") ? true : false;
           } 
           // If User hasn't entered valid input.. then it will not go in the if  
           // then this element will have default value `false` for boolean..
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:39:56.393

我想你可以试试这样的......

```
public Boolean[] chooseDice(int diceNum){
    Boolean[] responses = new Boolean[diceNum];
    boolean isCorrect = false;
    Scanner scansworth = new Scanner(System.in);
    for (int i=0; i<diceNum; i++){

while(!isCorrect){

if((scansworth.hasNext().equalsIgnoreCase("Y")) ||  (scansworth.hasNext().equalsIgnoreCase("N")))`{

    responses[i] = scansworth.next();
    isCorrect = true;

}else{

       isCorrect = false;

    }
  }

} 
```

# android - 缺少 cookie 标头

> ID：12713605
> 
> 赞同：2
> 
> 时间：2012-10-03T17:20:24.913
> 
> 标签：android, asp.net, web-services, ksoap2

我用 ksoap 调用 web 服务，我想在 web 服务中维护会话，我试图设置会话 cookie，但是从服务响应中我没有得到带有会话 ID 的会话 cookie，我这样做：

```
URLConnection connection = new URL(url).openConnection();
String cookies = connection.getHeaderFields().toString(); 
```

并且在输出中没有 Cookie 标头，只有这些标头：

```
cache-contro=[private], content-type=[.....], server=[Microsoft-IIS/7.5], 
x-aspnet-version=[.....], x-powered-by=[ASP.NET], date=[......], 
content-length=[.....] } 
```

我从 Web 浏览器测试了该服务并且会话有效，但没有从 Android 应用程序返回会话 cookie。你知道是什么问题吗？？

在我的服务方法之前，我已经声明：

```
[ScriptMethod]
[WebMethod(EnableSession = true)] 
```

我正在使用`ksoap 2.6.1`图书馆

# java - gwt：如何使用 setEventListener？

> ID：12713616
> 
> 赞同：0
> 
> 时间：2012-10-03T17:21:08.087
> 
> 标签：java, gwt

我有这个代码：

```
DOM.setEventListener(row.getElement(), new ClickListener(){

    @Override
    public void onClick(Widget sender) {
    // TODO Auto-generated method stub

    }}); 
```

我认为代码很好并且可以`ClickListener`扩展`EventListener`，但它给出了错误消息：`The method setEventListener(Element, EventListener) in the type DOM is not applicable for the arguments (Element, new ClickListener(){})`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:28:58.493

真正的答案是你可能不知道。虽然这可用于将侦听器附加到事件，但您只能为每个元素附加一个侦听器 - 侦听然后获取所有已配置的 dom 事件（请参阅`DOM.sinkEvents`） - 并且您负责确保在页面卸载之前分离所有侦听器，否则某些浏览器会泄漏内存。

相反，强烈考虑使用 Widget（和子类）来管理事件。RootPanel 是其他人应该添加到的基本小部件，它将管理从页面中分离所有其他小部件以防止内存泄漏。

此外，您可以根据您所关注的事件类型来监听其中发生的事件。例如，即使在像 Label 这样通常不会触发 mouseover 事件的小部件上，您仍然可以附加处理程序并获取通知：

```
Label label = new Label();
label.addDomHandler(new MouseOverHandler() {
  @Override
  public void onMouseOver(MouseOverEvent event) {
    // do something
  }
}, MouseOverEvent.getType());
RootPanel.get().add(label); 
```

在大多数情况下，您将使用现有的支持方法，例如 Button 来获取点击事件 - 已经有方便的方法供您使用，这要归功于以下接口`HasClickHandlers`：

```
Button button = new Button();
button.addClickHandler(new ClickHandler() {
  @Override
  public void onClick(ClickEvent event) {
    // do something
  }
});
panel.add(button); 
```

有关 GWT、Widget 和内存泄漏的更多信息：

*   [https://developers.google.com/web-toolkit/articles/dom_events_memory_leaks_and_you](https://developers.google.com/web-toolkit/articles/dom_events_memory_leaks_and_you)
*   [http://code.google.com/p/google-web-toolkit/wiki/UnderstandingMemoryLeaks](http://code.google.com/p/google-web-toolkit/wiki/UnderstandingMemoryLeaks)

# backbone.js - Marionette 多用户/角色应用程序

> ID：12713617
> 
> 赞同：2
> 
> 时间：2012-10-03T17:21:14.070
> 
> 标签：backbone.js, marionette

我必须使用 Backbone Marionette 构建一个非常复杂的应用程序。用户界面必须处理具有不同角色的多个用户。例如，“admin”用户将看到完整的菜单，而“guest”用户将访问同一菜单的子集。此外，所有用户都可以访问某些视图，但其中的功能（添加、编辑、删除）需要针对不同的角色进行配置。

我不确定解决此问题的正确方法。我可以为不同的角色使用不同的模板，但在这种情况下，大量代码将在其中重复。是否有任何最佳实践（或者可能是一些示例）来使用 Marionette 解决我的问题？

在此先感谢，法布里齐奥

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:44:00.953

我会保留一个 mypermissions 对象，然后在 itemview 中编写逻辑来处理不同的情况。您可以创建一个名为“hide”的 CSS 类，该类设置为

> 显示：无

然后你只需添加那个类这可以在不更改模板的情况下完成。

这是 Coffeescript 中的一个示例（未经测试或其他任何内容）

```
AuthView = Backbone.Marionette.ItemView.extend
    template: '#auth-template'          
    onRender: ->
        @checkpermissions()
    checkpermissions: -> 
        if (mypermissions.isUser)
            $(".delete").addClass 'hide'
            $(".add").addClass 'hide'
        elseif (mypermissions.isAdmin)
            $(".delete").removeClass 'hide'
            $(".add").removeClass 'hide' 
```

# ios - 如何在应用程序运行时在锁定屏幕中显示（官方方式）自定义艺术

> ID：12713620
> 
> 赞同：2
> 
> 时间：2012-10-03T17:21:28.907
> 
> 标签：ios, audio, avplayer, avqueueplayer

我听说有人说苹果不允许这样做：[如何在 iPhone 中以编程方式设置锁屏、壁纸和铃声？](https://stackoverflow.com/questions/4476777/how-to-set-lock-screen-wallpaper-and-ringtone-programmatically-in-iphone/4476831#4476831)

但是，我想知道是否有官方的方法可以做到这一点。如果没有，或者像 Songza 这样的音乐应用程序如何在锁定屏幕中显示正在播放的艺术作品？

有任何想法吗？

# c# - Windows 8 - 在 For 循环中等待异步时出现线程错误

> ID：12713621
> 
> 赞同：2
> 
> 时间：2012-10-03T17:21:29.967
> 
> 标签：c#, multithreading, windows-8, windows-runtime

我正在尝试在我的 Windows 8 应用程序中加载保存的数据。所有方法都是异步的。当`await GetStoredActivitiesInFolder(groupFolder);`第二次在 for 循环中运行时，我得到一个错误，因为线程仍在处理第一个（我猜）。

错误（当我删除上面的代码行时它消失了）：

> mscorlib.dll 中出现“System.Runtime.InteropServices.COMException”类型的异常，但未在用户代码中处理
> 
> 附加信息：应用程序调用了为不同线程编组的接口。（来自 HRESULT 的异常：0x8001010E (RPC_E_WRONG_THREAD)）

我的代码：

```
 public async void LoadActivities()
    {
        StorageFolder storageFolder = ApplicationData.Current.LocalFolder;

        StorageFolder activityFolder = await storageFolder.CreateFolderAsync(App.AppSettings.ActivityDirectory, CreationCollisionOption.OpenIfExists);

        IReadOnlyList<StorageFolder> groupFolders = await activityFolder.GetFoldersAsync();

        ObservableCollection<ActivityDataGroup> groups = new ObservableCollection<ActivityDataGroup>();

        foreach (var groupFolder in groupFolders)
        {
            ActivityDataGroup group = new ActivityDataGroup();
            group.GroupName = groupFolder.Name;

            ICollection<ActivityViewModel>  activities = await GetStoredActivitiesInFolder(groupFolder);

            foreach (var activity in activities)
            {
                group.Items.Add(activity);
            }

            AllGroups.Add(group);

        }

        this.IsDataLoaded = true;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T18:23:12.690

我认为您的 GetStoredActivitiesInFolder 可能会在非 UI 线程上返回，然后您可以对其进行修改以使其不返回或执行类似操作以确保您更新 UI 线程上的视图绑定项，例如：

```
await Dispatcher.RunAsync(
    CoreDispatcherPriority.High,
    () =>
    {
        AllGroups.Add(group);
    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:55:38.877

以上都不起作用，但我偶然发现了它。在页面的构造函数中调用了 LoadActivities 函数。当我将它移到 OnLaunched 方法时，它神奇地起作用了。我不知道为什么，但确实如此。=)

无论如何，感谢您的帮助，抱歉打扰。

# c# - 如何在单元测试中引用 viewModel？

> ID：12713623
> 
> 赞同：0
> 
> 时间：2012-10-03T17:21:50.140
> 
> 标签：c#, asp.net-mvc, unit-testing

我有以下动作：

```
public ViewResult Index()
{
    var model = new MyIndexViewModel { TotalTips = (decimal)7.51 };
    return View(model);
} 
```

我想编写一个单元测试来验证 model.TotalTips 是 7.51。

我正在尝试这样的事情：

```
[TestMethod]
public void Test()
{
    // Arrange
    var controller = new MyController(_mockRepository.Object);
    MyIndexViewModel test = new MyIndexViewModel{TotalTips = (decimal)7.51};

    // Action
    ViewResult result = controller.Index();

    // Assert
    Assert.AreEqual(result.ViewData.Model.TotalTips, test.TotalTips); // Problem line
} 
```

但 我无法解决`TotalTips`.`result.ViewData.Model.TotalTips`

我知道这是错误的，但无法弄清楚如何正确解决我发布到索引视图的模型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:30:10.047

根据[文档](http://msdn.microsoft.com/en-us/library/system.web.mvc.viewdatadictionary.model.aspx) `ViewDataDictionary.Model`被键入为对象，因此您必须将其转换为您的视图模型类型：

```
var viewModel = (MyIndexViewModel)result.ViewData.Model;
Assert.AreEqual(viewModel.TotalTips, test.TotalTips); 
```

# java - 在输出流中写入 imageicon

> ID：12713633
> 
> 赞同：1
> 
> 时间：2012-10-03T17:22:45.483
> 
> 标签：java, image, sockets, outputstream, awtrobot

我无法在输出流中编写图像图标。这是我的代码。请任何人帮助我。

```
 public ScreenSpyer(Socket socket, Robot robot, Rectangle rect) {
        this.socket = socket;
        this.robot = robot;
        this.rectangle = rect;
        start();
    }

    public void run(){
        oos = null; 
        try{                
            oos = new ObjectOutputStream(socket.getOutputStream());
            oos.writeObject(rectangle);
            //  oos.flush();
            // oos.reset();
        }catch(IOException ex){
            ex.printStackTrace();
        }

        while(continueLoop){
            //Capture screen
            image =  robot.createScreenCapture(rectangle);              
            imageIcon = new ImageIcon(image);    
            //Send captured screen to the server
            try {
                System.out.println("before sending image");
                System.out.println("intermidiate");
                // oos.reset();
                oos.writeObject(imageIcon);                    
                System.out.println("New screenshot sent");
                //oos.reset();
                //oos.flush();
                oos.reset();
            } catch (IOException ex) {
               ex.printStackTrace();
            }    

            try{
                Thread.sleep(1000);                   
            }catch(InterruptedException e){
                e.printStackTrace();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T11:20:38.487

你说“它卡住了”；你怎么知道的？这显然是一个线程，被其他代码终止。我假设跟踪输出“发送的新屏幕截图”没有被执行；这可能是因为它被卡住了，或者 writeObject() 可能会抛出您没有捕获的异常。

在 IOException 之后捕获 throwable 以查看是否还有另一个异常。

生成图像后，立即将其替换为已知图像并查看是否写入；这将有助于确定这个特定的 writeObject() 调用是否存在问题，或者程序中的其他地方是否有问题。

尝试使用屏幕上的一个小矩形，而不是全部。也许 getScreenSize() 返回一些不可用的东西，比如比屏幕大一个像素的东西。如果一个小矩形有效，请尝试在两个维度上将矩形缩小几个像素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T18:05:16.113

看起来您实际上是在尝试将屏幕截图图像保存`OutputStream`到磁盘或可能保存到磁盘。

在这种情况下，您不必使用`ImageIcon`. 您可以保存从`createScreenCapture`调用返回的图像。您可以`ImageIO`用于保存图像：

```
ImageIO.write(BufferedImage image, String formatName, File output); 
```

或者

```
ImageIO.write(BufferedImage image, String formatName, ImageOutputStream output); 
```

或者

```
ImageIO.write(BufferedImage image, String formatName, OutputStream output); 
```

`formatName`可以是 jpg、png 或 gif 。

# sql - Sql Server 2008 中的重复架构

> ID：12713635
> 
> 赞同：0
> 
> 时间：2012-10-03T17:22:57.310
> 
> 标签：sql, sql-server-2008, schema

我想用表结构复制现有模式，但不是任何现有数据。从本质上讲，我们将两家目前在数据库中共享一个模式的公司分开，它们具有完全相同的数据结构，但我们希望它们采用不同的模式（出于访问控制目的）。

是否可以将一个模式的整个表结构复制到一个新模式中而不带入任何数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:26:23.273

您可以在 SSMS (Sql Server Management Studio) 中执行此操作

*   右键单击数据库
*   脚本数据库为
*   创建到
*   文件

在结果文件中进行全局搜索和替换，将您的架构名称更改为所需的架构名称。

我建议您继续维护更改脚本，以便在进一步开发应用程序时将任何需要的更改应用于数据库。这样，您可以共享更改脚本，并在准备升级应用程序版本时应用它们。

# android - Sqlite 数据库未从资产文件夹 Android 复制

> ID：12713640
> 
> 赞同：2
> 
> 时间：2012-10-03T17:23:01.240
> 
> 标签：android, sqlite, copy, assets

我正在尝试将名为“adinpect”的数据库从资产文件夹复制到应用程序数据库文件夹，但它不起作用......

代码（在主要活动 onCreate() 中，仅用于测试）：

```
 try {
        String destPath = "/data/data/" + getPackageName() + "/databases";
        File f = new File(destPath);

        if (!f.exists()) {

            f.mkdirs();
            f.createNewFile();
            //---copy the db from the assets folder into the databases folder---
            CopyDB(getBaseContext().getAssets().open("adinspect"), new FileOutputStream(destPath + "/adinspect"));
        }

    } 
        catch (FileNotFoundException e) {
            e.printStackTrace();
    }   catch (IOException e) {
            e.printStackTrace();
    }

 public void CopyDB(InputStream inputStream, OutputStream outputStream) throws IOException {

        //---copy 1K bytes at a time---
        byte[] buffer = new byte[1024];
        int length;
        while ((length = inputStream.read(buffer)) > 0) {
            outputStream.write(buffer, 0, length);
        }

        inputStream.close();
        outputStream.close();

}//end copyDB 
```

“数据库”文件夹已创建，但其中没有任何内容，试图通过 DDMS 访问它。

我没有收到任何错误。

有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T17:29:19.060

此代码将帮助您从资产文件夹复制数据库。您可以先检查数据库是否存在。

```
try{
    // CHECK IS EXISTS OR NOT
    SQLiteDatabase dbe = SQLiteDatabase.openDatabase("/data/data/"+getPackageName+"/databases/dbname.sqlite",null, 0);
    dbe.close();
}
catch(Exception e)}
{
    // COPY IF NOT EXISTS
    AssetManager am = getApplicationContext().getAssets();
    OutputStream os = new FileOutputStream("/data/data/"+getPackageName+"/databases/dbname.sqlite");
    byte[] b = new byte[100];
    int r;
    InputStream is = am.open("dbname.sqlite");
    while ((r = is.read(b)) != -1) {
         os.write(b, 0, r);
   }
   is.close();
   os.close();
} 
```

# javascript - 给 JavaScript 函数一个“假”选项？

> ID：12713644
> 
> 赞同：0
> 
> 时间：2012-10-03T17:23:10.520
> 
> 标签：javascript

你如何让 JavaScript 函数有一个 false 选项，以确保函数不执行？

这是代码：

```
 function deleteExtraRows(tableID){
        tableID = '#'+tableID;    
       $(tableID+' tr').each(function(){
            if($(tableID+' tr').length>1){
                $(this).remove();
            }
        });

    } 
```

我还希望能够给它一个 (false) 选项，这样我就可以运行 deleteExtraRows(false)，这不会使函数运行。我知道这似乎有点倒退，但如果我能做到这一点，它将适合我正在从事的项目。

请帮忙！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T17:24:49.483

这应该可以解决问题：

```
function deleteExtraRows(tableID){
    if(tableID === false)
        return;
    ....
} 
```

重要的是使用`===`，而不是`==`因为`===`检查类型。如果 tableID 为 0 或空字符串，它将评估为 true 并返回。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T17:25:02.353

如果页面上没有 id 为`false`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:25:20.447

像这样做

```
 function deleteExtraRows(tableID){
        if(!tableID)
            return;
        tableID = '#'+tableID;    
        $(tableID+' tr').each(function(){
            if($(tableID+' tr').length>1){
                $(this).remove();
            }
        });
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T17:40:11.253

我建议上面 Greg 的答案，但认为您可以通过像这样重写它来优化您的代码：

```
function deleteExtraRows (tableID) {

    if (tableID === false) {
        return;
    }

    $('#' + tableID).find('tr:not(:last)').remove();
} 
```

...除非我在那里误解了您的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T17:24:44.397

只是**返回**

return 停止函数的执行..

```
function deleteExtraRows(tableID, valid ){
      if(!valid)
         return;
        tableID = '#'+tableID;    
       $(tableID+' tr').each(function(){
            if($(tableID+' tr').length>1){
                $(this).remove();
            }
        });

    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-03T17:24:45.093

尝试这个：

```
function deleteExtraRows(tableID, doWork){
    if (!doWork) return;
        tableID = '#'+tableID;    
       $(tableID+' tr').each(function(){
            if($(tableID+' tr').length>1){
                $(this).remove();
            }
        });
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-03T17:27:31.290

它在哪里被调用？做就是了：

```
if(!!tableID) deleteExtraRows(tableID); 
```

# session - 使用 Tomcat 会话重新连接客户端请求

> ID：12713657
> 
> 赞同：3
> 
> 时间：2012-10-03T17:24:08.273
> 
> 标签：session, tomcat, jmeter, sessionid

我有通过负载均衡器启动并路由到权重最小的 Tomcat 服务器进行处理的客户端请求。

当客户端访问目标 Tomcat 服务器时，对客户端的响应包含用于第二个请求的绝对 URL。这基本上消除了负载均衡器，以允许客户端在客户端会话的生命周期内直接与 Tomcat 实例通信。

ISSUE：问题是通过负载均衡器的第一个请求正在创建一个 SESSION，然后直接向 Tomcat 的第二个请求为单个客户端创建了第二个 SESSION。第一个 SESSION 只是未使用并最终到期。

问题：如何在第二个请求上连接客户端，回到在第一个请求上创建的 SESSION（通过负载均衡器）？

**更新：** 我在 JMeter 中对此进行了测试，但连接会话没有任何运气。

要求一：

```
http://loadbalancer:80/page1.jsp 
```

响应头：

```
Set-Cookie: JSESSIONID=070894D435A46DF60AFE506018018325; Path=/ 
```

那么第二个请求是：

```
http://directTomcat:8080/page2.jsp?token1=123&token2=xyz;JSESSIONID=070894D435A46DF60AFE506018018325

[no cookies] 
```

第二个响应标头：

```
Set-Cookie: JSESSIONID=1081A016CBA9B3AA7E7C38EF775C04F7; Path=/ 
```

我也试过：

```
http://directTomcat:8080/page2.jsp?token1=123&token2=xyz&JSESSIONID=070894D435A46DF60AFE506018018325 
```

但这也不起作用。

在发出第二个请求之前，是否需要在客户端将 JSESSIONID 设置为 cookie？

# javascript - 为什么我不能访问 TypeScript 私有成员？

> ID：12713659
> 
> 赞同：114
> 
> 时间：2012-10-03T17:24:20.030
> 
> 标签：javascript, typescript

我正在研究 TypeScript 中私有成员的实现，我发现它有点令人困惑。Intellisense 不允许访问私有成员，但在纯 JavaScript 中，它就在那里。这让我觉得 TS 没有正确实现私有成员。有什么想法吗？

```
class Test{
  private member: any = "private member";
}
alert(new Test().member); 
```

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-10-03T17:36:58.397

就像类型检查一样，成员的隐私只在编译器内强制执行。

私有属性被实现为常规属性，并且不允许类外的代码访问它。

要在类中使某些东西真正私有，它不能是类的成员，它将是在创建对象的代码内的函数范围内创建的局部变量。这意味着您不能像类成员一样访问它，即使用`this`关键字。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2014-06-06T16:01:00.610

JavaScript 确实支持私有变量。

```
function MyClass() {
    var myPrivateVar = 3;

    this.doSomething = function() {
        return myPrivateVar++;        
    }
} 
```

在 TypeScript 中，这将表示如下：

```
class MyClass {

    doSomething: () => number;

    constructor() {
        var myPrivateVar = 3;

        this.doSomething = function () {
            return myPrivateVar++;
        }
    }
} 
```

**编辑**

这种方法只能在绝对需要的情况下**谨慎使用。**例如，如果您需要临时缓存密码。

使用这种模式会产生性能成本（与 Javascript 或 Typescript 无关），并且只能在绝对必要的情况下使用。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2020-01-13T07:40:44.850

由于 TypeScript 3.8 将发布，您将能够声明 **在包含类之外无法访问甚至无法检测到的**私有字段。

```
class Person {
    #name: string

    constructor(name: string) {
        this.#name = name;
    }

    greet() {
        console.log(`Hello, my name is ${this.#name}!`);
    }
}

let jeremy = new Person("Jeremy Bearimy");

jeremy.#name
//     ~~~~~
// Property '#name' is not accessible outside class 'Person'
// because it has a private identifier. 
```

私有字段以`#`字符开头

请注意，这些私有字段将不同于标有`private`关键字的字段

参考。[https://devblogs.microsoft.com/typescript/announcing-typescript-3-8-beta/](https://devblogs.microsoft.com/typescript/announcing-typescript-3-8-beta/)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-04-10T04:23:32.557

一旦对[WeakMap](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap)的支持得到更广泛的支持，[这里](http://www.2ality.com/2016/01/private-data-classes.html)的示例 #3 中就会详细介绍一种有趣的技术。

它允许私有数据并通过允许从原型方法而不是仅实例方法访问数据来避免 Jason Evans 示例的性能成本。

链接的 MDN WeakMap 页面列出了 Chrome 36、Firefox 6.0、IE 11、Opera 23 和 Safari 7.1 的浏览器支持。

```
let _counter = new WeakMap();
let _action = new WeakMap();
class Countdown {
  constructor(counter, action) {
    _counter.set(this, counter);
    _action.set(this, action);
  }
  decrement() {
    let counter = _counter.get(this);
    if (counter < 1) return;
    counter--;
    _counter.set(this, counter);
    if (counter === 0) {
      _action.get(this)();
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-10-06T14:51:26.597

感谢 Sean Feldman 提供有关此问题的官方讨论的链接 - 请参阅[他对链接的回答](https://stackoverflow.com/a/12713927/3012550)。

我阅读了他链接到的讨论，**这里是关键点的摘要：**

*   *建议：*构造函数中的私有属性
    *   *问题：*无法从原型函数访问
*   *建议：*构造函数中的私有方法
    *   *问题：*与属性相同，而且您失去了在原型中为每个类创建一次函数的性能优势；相反，您为每个实例创建函数的副本
*   *建议：*添加样板以抽象属性访问并强制可见性
    *   *问题：*主要的性能开销；TypeScript 专为大型应用程序而设计
*   *建议：* TypeScript 已经将构造函数和原型方法定义包装在一个闭包中；将私有方法和属性放在那里
    *   *将私有属性放在该闭包中的问题：*它们成为静态变量；每个实例没有一个
    *   *将私有方法放在该闭包中的问题：*`this`如果没有某种解决方法，它们就无法访问
*   *建议：*自动修改私有变量名
    *   *反驳论点：*这是命名约定，而不是语言结构。自己弄乱
*   *建议：*`@private`使用能够识别注释的缩小器对 私有方法进行注释，从而可以有效地缩小方法名称
    *   对此没有重要的反驳论据

**在发出的代码中添加可见性支持的总体反对论点：**

*   问题是 JavaScript 本身没有可见性修饰符——这不是 TypeScript 的问题
*   JavaScript 社区中已经有一个既定模式：在私有属性和方法前加上下划线，表示“风险自负”
*   当 TypeScript 设计者说真正私有的属性和方法不是“可能的”时，他们的意思是“在我们的设计约束下不可能”，具体来说：
    *   发出的 JS 是惯用的
    *   样板是最小的
    *   与普通的 JS OOP 相比没有额外的开销

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-09-14T22:12:51.887

我意识到这是一个较早的讨论，但分享我对 TypeScript 中所谓的私有变量和方法“泄漏”到已编译 JavaScript 类的公共接口中的问题的解决方案可能仍然有用。

对我来说，这个问题纯粹是装饰性的，也就是说，当在 DevTools 中查看实例变量时，视觉上的杂乱无章。我的解决方法是将私有声明组合在另一个类中，然后在主类中实例化并分配给一个`private`（但在 JS 中仍然公开可见）变量，其名称类似于`__`（双下划线）。

例子：

```
class Privates {
    readonly DEFAULT_MULTIPLIER = 2;
    foo: number;
    bar: number;

    someMethod = (multiplier: number = this.DEFAULT_MULTIPLIER) => {
        return multiplier * (this.foo + this.bar);
    }

    private _class: MyClass;

    constructor(_class: MyClass) {
        this._class = _class;
    }
}

export class MyClass {
    private __: Privates = new Privates(this);

    constructor(foo: number, bar: number, baz: number) {
        // assign private property values...
        this.__.foo = foo;
        this.__.bar = bar;

        // assign public property values...
        this.baz = baz;
    }

    baz: number;

    print = () => {
        console.log(`foo=${this.__.foo}, bar=${this.__.bar}`);
        console.log(`someMethod returns ${this.__.someMethod()}`);
    }
}

let myClass = new MyClass(1, 2, 3); 
```

当`myClass`在 DevTools 中查看该实例时，您不会看到它的所有“私有”成员与真正的公共成员混合在一起（在正确重构的真实代码中可能会在视觉上变得非常混乱），而是看到它们整齐地分组在折叠`__`属性中：

[![在此处输入图像描述](../Images/c158e6814e7161524cec9ca3d66d08a0.png)](https://i.stack.imgur.com/4LqAB.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-15T07:33:28.783

在 TypeScript 中，私有函数只能在类内部访问。像

[![在此处输入图像描述](../Images/b31464496e801925977cdc27b08a045a.png)](https://i.stack.imgur.com/gwnjJ.png)

当您尝试访问私有成员时，它会显示错误。这是示例：

[![在此处输入图像描述](../Images/f4b6c8e316ad33506f05bdebaf5d8c2c.png)](https://i.stack.imgur.com/yFUdU.png)

> 注意：使用 javascript 就可以了，并且这两个函数都可以在外部访问。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-03-12T06:22:01.487

这是添加适当私有属性的可重用方法：

```
/**
 * Implements proper private properties.
 */
export class Private<K extends object, V> {

    private propMap = new WeakMap<K, V>();

    get(obj: K): V {
        return this.propMap.get(obj)!;
    }

    set(obj: K, val: V) {
        this.propMap.set(obj, val);
    }
} 
```

假设您在`Client`某处有需要两个私有属性的类：

*   `prop1: string`
*   `prop2: number`

下面是你如何实现它：

```
// our private properties:
interface ClientPrivate {
    prop1: string;
    prop2: number;
}

// private properties for all Client instances:
const pp = new Private<Client, ClientPrivate>();

class Client {
    constructor() {
        pp.set(this, {
            prop1: 'hello',
            prop2: 123
        });
    }

    someMethod() {
        const privateProps = pp.get(this);

        const prop1 = privateProps.prop1;
        const prop2 = privateProps.prop2;
    }
} 
```

如果你只需要一个私有属性，那么它会变得更简单，因为在这种情况下你不需要定义任何东西`ClientPrivate`。

值得注意的是，在大多数情况下， class`Private`只是提供了一个可读性很好的签名，而直接使用 of`WeakMap`却没有。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2020-12-07T18:05:57.183

其实这个问题的答案很简单。

你有这个代码：

```
class Test{
  private member: any = "private member";
}
alert(new Test().member); 
```

在该代码中，您混合了两种不同的语言。这部分是 TypeScript：

```
class Test{
  private member: any = "private member";
} 
```

这部分是JavaScript：

```
alert(new Test().member); 
```

字段类中的`private`关键字用于 TypeScript。因此 TypeScript 中的其他类无法访问该字段，因为 TypeScript 编译器不允许它。例如，如果您尝试这样做，它将无法正常工作：`Test``member``member`

```
class Test2 {
    constructor() {
        var test = new Test();
        test.member = "Cannot do this";
    }
} 
```

是否放置`private`或`public`放在生成的 JavaScript 上没有区别。生成的 JavaScript 代码将始终为：

```
var Test = (function () {
    function Test() {
        this.member = "private member";
    }
    return Test1;
}()); 
```

因此，您可以这样做，因为 JavaScript 将允许这样做：

```
alert(new Test().member); 
```

* * *

这不是一成不变的规则，可能有一些我不知道的情况，但如果你使用的是 TypeScript，那么为什么要担心你被允许使用 JavaScript 做什么呢？这个想法是您不再编写 JavaScript，因此您在 JavaScript 中可以/不能做的事情不再需要担心。对我来说，这种担心就像编写 C# 代码然后说我为什么能够更改[CIL](https://en.wikipedia.org/wiki/Common_Intermediate_Language)或汇编语言中的私有字段一样。我不确定 CIL 是否允许，但这不是重点。关键是，在用 C# 编写代码之后，您不要到处寻找可以用 CIL 做什么。

在某些情况下，您使用 TypeScript 编写代码，但公众可能会使用生成的 JavaScript，也许是一个插件，并且您不希望他们破坏事物，那么在这种情况下您会担心它。对于这些情况，您将编写 TypeScript 代码以使字段`private`甚至在 JavaScript 端。其他答案已经涵盖了如何做到这一点。

# jquery - 在 Ajax 建议框中使用 Jquery 更改类

> ID：12713664
> 
> 赞同：0
> 
> 时间：2012-10-03T17:24:36.003
> 
> 标签：jquery, ajax, search, autosuggest

我正在创建一个建议搜索框，当我向上或向下浏览建议时，它会在短时间内更改为新的高亮类，然后恢复为默认类。问题似乎是当我用这条线调用我的 php 时`searchReq.open("GET", '/search/ajax-suggest.php?search=' + str, true);`。如果我将其注释掉并将硬编码值添加到我的 search_suggest div 中，则该功能可以正常工作。这个 php 页面只是在后面用换行符回显值。

我在 html 页面上的输入是

```
<form id="frmSearch" action="/search/index.php" method="get">

            <input type="text" id="zoom_query" name="zoom_query" alt="Search Criteria" onkeyup="searchSuggest(); " autocomplete="off"  />
            <input type="image" src="/images/search_button.gif" id="cmdSearch" name="cmdSearch" value="Search" alt="Run Search" /><br/>
            <div id="search_suggest">
            </div>
                        </form> 
```

在我的 js 页面上，我有

```
function getXmlHttpRequestObject() {
if (window.XMLHttpRequest) {
    return new XMLHttpRequest();
} else if(window.ActiveXObject) {
    return new ActiveXObject("Microsoft.XMLHTTP");
} else {
    alert("Your Browser is out of date");
}
}

//Our XmlHttpRequest object to get the auto suggest
var searchReq = getXmlHttpRequestObject();

//Called from keyup on the search textbox.
//Starts the AJAX request.
function searchSuggest() { 
if (searchReq.readyState == 4 || searchReq.readyState == 0) {
    var str = escape(document.getElementById('zoom_query').value);
    searchReq.open("GET", '/search/ajax-suggest.php?search=' + str, true);
    searchReq.onreadystatechange = handleSearchSuggest; 
    searchReq.send(null);   
}       
}

//Called when the AJAX response is returned.
function handleSearchSuggest() {
if (searchReq.readyState == 4) {
    var ss = document.getElementById('search_suggest')
    ss.innerHTML = '';
    var str = searchReq.responseText.split("\n");
    for(i=0; i < str.length - 1; i++) {
    var suggest = '<div class="suggest_link">' + str[i] + '</div>';
        ss.innerHTML += suggest;
    }
}
}
$(document).keyup(function(e) {
var $hlight = $('div.suggest_link_over'), $div = $('div.suggest_link');
if (e.keyCode == 40) {
    $hlight.removeClass('suggest_link_over').next().addClass('suggest_link_over');
    if ($hlight.next().length == 0) {
        $div.eq(0).addClass('suggest_link_over')
    }
} else if (e.keyCode === 38) {
    $hlight.removeClass('suggest_link_over').prev().addClass('suggest_link_over');
    if ($hlight.prev().length == 0) {
        $div.eq(-1).addClass('suggest_link_over')
    }
}
}) 
```

# actionscript-3 - 使用 Flash CS5 编译 AS3 swf

> ID：12713665
> 
> 赞同：0
> 
> 时间：2012-10-03T17:24:40.190
> 
> 标签：actionscript-3, flash, flash-cs5

这里有一堆动作脚本，知道如何使用 Flash CS5 编译它（不幸的是我没有 flashbuilder）

[https://github.com/jwagener/recorder.js/tree/master/flash](https://github.com/jwagener/recorder.js/tree/master/flash)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:33:43.037

我不知道您使用的是哪种编程环境，但[FDT](http://fdt.powerflasher.com)提供了许多超出简单编译和部署 ActionScript 应用程序的功能。

或者，您可以使用[flex 框架](http://incubator.apache.org/flex/)（现在在 apache 下）工具来编译您的应用程序

# android - Android 地图覆盖在缩放时消失

> ID：12713671
> 
> 赞同：3
> 
> 时间：2012-10-03T17:24:57.033
> 
> 标签：android, google-maps, overlay, zooming

我对 Android 的 Google Maps API 感到头疼……我在地图上绘制了一些叠加层，一切都很好，它会定期更新并很好地处理手势，没问题……但是，当我放大到 15 级时- 16 或更高，一个或多个较大的多边形不会重绘。这只发生在例如圆的质心超出屏幕边界的情况下，并且仅在放大时发生..它不会在缩小时发生，也不会发生在向任何方向平移地图时（翻译）。

当非常接近放大时，我猜系统会忽略覆盖/形状，将其视为不重要？我想要绘制与屏幕边界相交的任何形状。我是否在这里遗漏了一些明显的东西，因为我似乎找不到任何关于如何处理这种情况的明确答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:54:56.120

我实现它的方式是在[这里](https://github.com/jgilfelt/android-mapviewballoons)`mapviewballons`使用as 库，然后使用调用
`super(boundCenter(defaultMarker), mapView);`

boundCenter 将质心保持在屏幕上，其覆盖在屏幕上，并且在缩放时不受影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T18:00:47.030

我有一个类似的问题，但我只使用正方形，这样更容易解决。

**问题细节（至少有正方形）：**

canvas.drawRect() 仅当矩形的顶部和底部在可见屏幕内都有坐标时才绘制矩形。只要矩形的顶部或底部在屏幕外有坐标，它就不会被绘制。

**我用于正方形的解决方案**

我裁剪了正方形以使其始终适合可见的屏幕坐标，并且绘制正确。

如果您使用更复杂的图形，此解决方案可能更难以实施。

祝你好运。

# c++ - 委托中的 QWidget：鼠标悬停时不会重绘，因此无法检查 MouseOver 状态

> ID：12713673
> 
> 赞同：0
> 
> 时间：2012-10-03T17:25:01.533
> 
> 标签：c++, qt

它确实适用于 Linux+KDE，但不适用于 Windows/OSX/Linux + XFCE。

我有一个列表视图，这些项目是自定义小部件，如果鼠标悬停在元素上，则列表视图项目的委托不会获得 paint() 调用。

试图通过 css ( :hover ) 模拟事件，但它似乎不适用于 QWidgets。

我是否遗漏了某些东西，或者它确实是 KDE 以外的平台上缺少的功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:45:09.187

您可能需要打开鼠标跟踪。

[QWidget::setMouseTracking(bool)](http://qt-project.org/doc/qt-4.8/qwidget.html#mouseTracking-prop)

# javascript - 带有 JavaScript 的原生 Android DatePicker

> ID：12713679
> 
> 赞同：2
> 
> 时间：2012-10-03T17:25:22.417
> 
> 标签：javascript, android, datefield

我目前正在构建一个基于 Web 的应用程序，并希望将原生 Android 日期选择器用于字段。我已经研究过使用 PhoneGap，但它似乎超出了我的项目所需。有没有用基本的 JavaScript 调用日期选择器字段？

另外，我不打算使用 jQuery Mobile 作为 CSS，因为它完全禁用了我当前的外观。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T09:38:38.087

在 Android 上，您无法从 Web 应用程序调用本机日期选择器（输入 type="date" 是正确的方法，iOS > 5 支持该方法）。

我建议使用[Mobiscroll](http://mobiscroll.com)，这是一个 javascript 日期选择器（而不仅仅是日期选择器）插件，它的主题使其看起来像原生日期选择器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T17:31:46.077

我很确定你的问题的答案是“不”。PhoneGap 的工作原理是为每个平台提供可通过 Javascript API 访问的本地库——如果没有本地库，我认为您将无法调用日期选择器字段。

也就是说，PhoneGap 是一个开源项目，因此您始终可以分析它们的源代码，并了解实现它需要什么。Android 的 PhoneGap 代码在这里：

[https://github.com/apache/incubator-cordova-android](https://github.com/apache/incubator-cordova-android)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:33:59.880

我用谷歌搜索了 PhoneGap 数据选择器插件，发现了这个

[https://github.com/phonegap/phonegap-plugins/tree/master/Android/DatePicker](https://github.com/phonegap/phonegap-plugins/tree/master/Android/DatePicker)

我认为这就是您要寻找的东西，但我没有亲自测试过。

# objective-c - NSImage 的问题

> ID：12713681
> 
> 赞同：0
> 
> 时间：2012-10-03T17:25:37.110
> 
> 标签：objective-c, xcode, nsimage

我在使用类时遇到问题`NSImage`。我正在尝试使用该功能`initWithData:`，但它不起作用（任何相关的东西都`NSImage`不起作用）。这是我尝试的一个简单示例。`NSData`数据是对的。

我的项目是一个基础类型的命令行工具。

```
NSData *imdata =[[NSData alloc] initWithContentsOfFile:@"/Users/JulianDavid/Desktop/ecoli_20000.png"];
if(!imdata){
    NSLog(@"there is data");
}
NSImage *imag=[[NSImage alloc]initWithData:imdata]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T17:25:11.123

错误

```
Undefined symbols for architecture x86_64: "_OBJC_CLASS_$_NSImage" 
```

意味着链接器找不到实现`NSImage`该类的代码。根据[`NSImage`文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/nsimage_Class/Reference/Reference.html)，它是在 AppKit 框架中实现的。因此，为了让链接器正确链接代码，您需要链接到 AppKit 框架。通过[将 AppKit 框架添加](https://stackoverflow.com/questions/3352664/how-to-add-existing-frameworks-in-xcode-4)到您的 Xcode 项目中来做到这一点。

# java - 带字幕的android ListActivity

> ID：12713687
> 
> 赞同：1
> 
> 时间：2012-10-03T17:26:00.077
> 
> 标签：java, android, listactivity, populate

我是为 android 开发的新手，我正在尝试制作一个带有标题和副标题的 ListActivity。到目前为止，仅设法使标题：

```
this.data = new ArrayList<String>();

// add some objects into the array list
this.data.add("YOU WILL HEAR");
this.data.add("USEFUL PHRASES");
this.data.add("VOCABULARY");
this.data.add("DIALOGUES");
this.data.add("INFORMATION");

this.port = new ArrayList<String>();
this.port.add("BEM VINDO");
this.port.add("FRASES ÚTEIS");
this.port.add("VOCABULÁRIO");
this.port.add("DIÁLOGOS");
this.port.add("VOCABULÁRIO");

this.setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item,R.id.title,this.data));

ListView lv = getListView(); 
```

此代码在 onCreate 方法中。

我的问题是，我怎样才能`R.id.subtitle`用第二个数组填充？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:35:03.490

试试下面的代码：

```
 public ListView lv;

            lv = (ListView) findViewById(R.id.ListView01);
            lv.setAdapter(adapter);
    lv.setTextFilterEnabled(true);
    lv.setBackgroundResource(R.drawable.background);
    lv.setCacheColorHint(00000000);
    lv.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

        }
    });

         class MySimpleArrayAdapter extends ArrayAdapter<String> {
    private Context context;

    public MySimpleArrayAdapter(Context context) {
        super(context, R.layout.list);
        this.context = context;

    }

    public int getCount() {
        return names.size();
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        View rowView = convertView;

        if (rowView == null) {

            LayoutInflater vi = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            rowView = vi.inflate(R.layout.list, null);
        }
        TextView name = (TextView) rowView.findViewById(R.id.Name);
        TextView number = (TextView) rowView.findViewById(R.id.no);

        return rowView;
    }
} 
```

# ios - 容器控制器和 iOS 6 旋转

> ID：12713695
> 
> 赞同：0
> 
> 时间：2012-10-03T17:26:26.703
> 
> 标签：ios, uiviewcontroller, rotation, ios6

我的应用支持纵向、横向左和横向右方向，但在应用程序的某些地方我只支持纵向。

使 iOS 6 适应我有一个问题。我在 UINavigationController 中展示了一个模态控制器，根控制器实现了旋转方法，但从未被调用，因为新的旋转行为与容器内的控制器有关。

我的问题有一个快速响应：如果我有一个不支持所有应用程序方向的控制器，并且该控制器位于容器控制器内，我是否必须继承该容器（在我的情况下是导航）以覆盖旋转方法并完成我的目标？

我认为这非常棘手，但我没有找到其他解决方案。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T23:58:23.087

有几个“伪官方”源将容器类子类化，特别是 UINavigationController 是实现定位任务的方式。

以下是 Apple 开发者论坛的一些链接，其中企业的回答说明了这一点：

*   [https://devforums.apple.com/message/740014#740014](https://devforums.apple.com/message/740014#740014)
*   [https://devforums.apple.com/message/744384#744384](https://devforums.apple.com/message/744384#744384)

很多开发者使用的分类方法不正确，见**thread#message 728805#728805** （不能多发两个链接）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T23:37:03.460

是的。子类化您的 UINavigationController 并覆盖肖像的自动旋转方法。

# c# - 使用正则表达式从字符串中检索数字

> ID：12713696
> 
> 赞同：4
> 
> 时间：2012-10-03T17:26:27.093
> 
> 标签：c#, .net, regex

我正在尝试做的事情相当简单，尽管我遇到了困难。我有一个 url 字符串，格式为[http://www.somedomain.com?id=someid](http://www.somedomain.com?id=someid)我想要检索的是 someid 部分。我想我可以使用正则表达式，但我对它们不是很好，这就是我尝试过的：

```
Match match = Regex.Match(theString, @"*.?id=(/d.)"); 
```

我收到一个正则表达式异常，说解析正则表达式时出错。我读这个的方式就是`"any number of characters"`字面`"?id="`意思`"by any number of digits"`。我把数字放在一个组中，这样我就可以把它们拉出来。我不确定这有什么问题。如果有人能告诉我我做错了什么，我将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T17:32:12.007

不需要正则表达式。只需使用内置实用程序。

```
string query = new Uri("http://www.somedomain.com?id=someid").Query;
var dict = HttpUtility.ParseQueryString(query);

var value = dict["id"] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T17:28:02.133

您的正则表达式中有几个错误。试试这个：

```
Match match = Regex.Match(theString, @".*\?id=(\d+)"); 
```

具体来说，我：

*   更改`*.`为`.*`（点匹配所有非换行符，`*`表示前面的零个或多个）
*   在 the 之前添加了一个转义序列，`?`因为问号是正则表达式中的特殊字符。它表示前面的零个或一个。
*   改为`/d.`（`\d*`你的斜线走错了方向，你使用了点，上面已经解释过，而不是`*`上面也解释过）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T17:28:01.720

尝试

```
var match = RegEx.Match(theString, @".*\?id=(\d+)"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T17:31:05.960

*   该错误可能是由于前面的`*`. 正则表达式中的`*`字符匹配零次或多次出现的前一个字符；所以它不能是第一个字符。
*   可能是错字，但 digit 的快捷方式是`\d`, not`/d`
*   `.`匹配任何字符，您需要匹配一个或多个数字 - 所以使用`+`
*   `?`是一个特殊字符，所以需要转义。

所以它变成：

```
Match match = Regex.Match(theString, @".*\?id=(\d+)"); 
```

话虽如此，正则表达式并不是最好的工具。使用适当的查询字符串解析器，否则事情最终将变得难以管理。

# php - PHP：对象上的递归htmlspecialchars

> ID：12713702
> 
> 赞同：3
> 
> 时间：2012-10-03T17:26:48.760
> 
> 标签：php, json, object, recursion

我想为来自各种来源的数据建立一个通用的消毒剂。我的意思是（在这个阶段）将 htmlspecialchars 应用于字符串。现在，来自这些源的数据可以是任何东西，从对象到数组再到字符串，都是嵌套的（而且很复杂），而且格式总是有点不同。

所以我想到了一个递归的 htmlspecialchars 函数，它适用于数组和对象，并且只将 htmlspecialchars 应用于字符串，但是我如何递归地遍历一个对象呢？

谢谢。

**编辑：**我想我应该提到这一点 - 我实际上正在构建一个严重依赖 JS 和 JSON 进行客户端-服务器通信的 RIA。服务器唯一要做的就是从数据库中获取数据并通过 JSON 将其返回给客户端，格式如下：

```
{"stat":"ok","data":{...}} 
```

现在正如我所说，数据可以是任何东西，不仅来自字符串形式的数据库，还来自 XML 处理 JSON 的工作流程如下：

1.  从 DB/XML 获取数据（源编码为 iso-8859-1）
2.  将它们放入“数据”数组

3.  使用递归从 iso-8859-1 转换为 utf-8

    ```
    private function utf8_encode_deep(&$input) {
    if (is_string($input)) {
        $input = $this -> str_encode_utf8($input);
    } else if (is_array($input)) {
        foreach ($input as &$value) {
            $this -> utf8_encode_deep($value);
        }

        unset($value);
    } else if (is_object($input)) {
        $vars = array_keys(get_object_vars($input));

        foreach ($vars as $var) {
            $this -> utf8_encode_deep($input -> $var);
        }
    }
    } 
    ```

4.  使用 PHP`json_encode`将数据转换为 JSON

5.  将数据发送（回显）到客户端

6.  使用 JS 渲染数据（例如放入表格）

在这之间的某个地方，应该以某种方式对数据进行清理（在这个阶段只有 htmlspecialchars）。现在的问题应该是：***在哪里消毒，使用什么方法？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:31:30.837

您只想在输出到 HTML 时转义。而且您无法将完整的数组或对象输出到 HTML 中，因此转义所有内容似乎无效。

由于您的 JSON 输出，您有一个间接级别。因此，您无法在 PHP 中决定数据用于什么上下文 - JSON 仍然是纯文本，而不是 HTML。

因此，要决定是否必须为 HTML 转义 JSON 中的任何数据，我们必须知道您的 Javascript 是如何使用 JSON 数据的。

示例：如果您的 JSON 被视为纯文本，并且包含类似的内容`<b>BOLD</b>`，那么在任何 HTML 中使用时的预期结果就是该文本，包括看起来像 HTML 标记的字符，但没有粗体排版。只有当您的 Javascript 客户端将此测试作为纯文本处理时才会发生这种情况，例如，它不会用于`innerHTML()`将其放置在页面上，因为这会激活 HTML 标记，而只会激活`innerText()`或`textContent()`或任何其他方便的方法，例如 jQuery ( `.text()`)。

另一方面，如果您希望 JSON 包含馈入的现成 HTML `innerHTML()`，那么您必须先转义此字符串，然后才能将其放入 JSON。但是，只有当您不想为其添加任何格式时，您才必须转义整个字符串。否则，您将处于使用模板将预定义格式与用户内容混合的情况：用户内容在放入 HTML 上下文时必须转义，但结果不能 - 否则 Javascript 无法将其放入`innerHTML()`并启用格式。

基本上，对数组或对象中的所有内容进行全局转义很可能是错误的，除非您知道 Javascript 将在 HTML 上下文中使用的所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T18:02:23.603

您可以尝试以下方法

```
class MyClass {
    public $var1 = '<b>value 1</b>';
    public $var2 = '<b>value 2</b>';
    public $var3 = array('<b>value 3</b>');
}

$list = array();
$list[0]['nice'] = range("A", "C");
$list[0]['bad'] = array("<div>A</div>","<div>B</div>","<div>C</div>",new MyClass());
$list["<b>gloo</b>"] = array(new MyClass(),"<b>WOW</b>");

var_dump(__htmlspecialchars($list)); 
```

使用的功能

```
function __htmlspecialchars($data) {
    if (is_array($data)) {
        foreach ( $data as $key => $value ) {
            $data[htmlspecialchars($key)] = __htmlspecialchars($value);
        }
    } else if (is_object($data)) {
        $values = get_class_vars(get_class($data));
        foreach ( $values as $key => $value ) {
            $data->{htmlspecialchars($key)} = __htmlspecialchars($value);
        }
    } else {
        $data = htmlspecialchars($data);
    }
    return $data;
} 
```

输出类似的东西

```
array
  0 => 
    array
      'nice' => 
        array
          0 => string 'A' (length=1)
          1 => string 'B' (length=1)
          2 => string 'C' (length=1)
      'bad' => 
        array
          0 => string '&lt;div&gt;A&lt;/div&gt;' (length=24)
          1 => string '&lt;div&gt;B&lt;/div&gt;' (length=24)
          2 => string '&lt;div&gt;C&lt;/div&gt;' (length=24)
          3 => 
            object(MyClass)[1]
              ...

    array
      0 => 
        object(MyClass)[2]
          public 'var1' => string '&lt;b&gt;value 1&lt;/b&gt;' (length=26)
          public 'var2' => string '&lt;b&gt;value 2&lt;/b&gt;' (length=26)
          public 'var3' => 
            array
              ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:29:31.250

```
function htmlrecursive($data){
    if (is_array($data) && count($data) > 1){
        foreach ($data as &$d){
            $d = htmlrecursive($d);
        }
    } else if (!is_array($data)){
        return htmlspecialchars($data);
    }
    else {
         return htmlspecialchars($data[0])
    }
}

htmlrecursive($array); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T17:32:00.570

对于需要实现[ArrayAccess 接口的](http://de.php.net/manual/en/class.arrayaccess.php)对象，您可以进行数组遍历递归

还要检查这个问题[Getting an object to work with array_walk_recursive in PHP](https://stackoverflow.com/questions/4179306/getting-an-object-to-work-with-array-walk-recursive-in-php)

# android - android API 上微调器的布局 >= 7

> ID：12713706
> 
> 赞同：3
> 
> 时间：2012-10-03T17:27:03.660
> 
> 标签：android, spinner

我想在 Android API 7 及更高版本上制作微调器，看起来像这样（我没有任何弹出/对话框的东西）

![在此处输入图像描述](../Images/fc0f9daedf1ee2fd8a50074e2729f351.png)

示例来自：[开发者 android](http://developer.android.com/guide/topics/ui/controls/spinner.html)

怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T23:03:57.933

看看[HoloEverywhere](https://github.com/Prototik/HoloEverywhere "全息无处不在")。这是一个旨在“将 Holo 主题从 Android 4.1 带到 2.1 及更高版本”的库。如果它符合您的需求，您可以试用[Demo 。](https://play.google.com/store/apps/details?id=org.holoeverywhere.demo "PlayStore 中的演示")或者 - 如果您没有 2.1 设备 - 使用[apk](http://mvnrepository.com/artifact/org.holoeverywhere/demo "HoloEverywhere 演示的 Maven 存储库")（下载 - 二进制）将其加载到模拟器上。

# c# - 如何检查是否只有一个角色匹配？

> ID：12713708
> 
> 赞同：4
> 
> 时间：2012-10-03T17:27:08.607
> 
> 标签：c#, asp.net-mvc, membership

我需要按角色过滤用户，但所有用户都属于两个角色

示例：对于一个用户，对于`Admin`另一个用户。`Group1``User``Group1`

现在我想按`Group1`Role 过滤它们并忽略`Admin`and `User`。

```
public ViewResult Index()
{
    string[] roles = Roles.GetRolesForUser();
    var group = string.Join(" ", roles ); 
    group = group.Replace("Admin", "");//Used this to single out Group1 from Admin user
    return View(new UserViewModel
                    {
                        Users = _userService.FindAll().Where(x => Roles.GetRolesForUser(x.UserName).Contains(group)),
                        Roles = roles
                    });
} 
```

这不会出错，但它显示为空。我想我知道为什么，但仍然无法弄清楚如何绕过它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T18:30:00.863

```
public ViewResult Index()
{
   var roleFilter = Roles.GetRolesForUser().First(r => !r.equals("Admin"));

   return View(new UserViewModel
                {
                    Users = _userService.FindAll().Where(x => Roles.GetRolesForUser(x.UserName).Contains(roleFilter)),
                    Roles = new [] {roleFilter}
                });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T01:42:49.033

好吧，就这样吧。我对您的问题的理解是您想检查用户是否具有一个或多个特定角色。如果是，允许访问；否则，拒绝他们访问并将他们送入黑洞。听起来在您的示例中您只想检查一个特定角色。阅读您的一些评论后，您可能还想在某个时候检查多个角色。我将向您展示的代码示例允许您根据一组一个或多个角色来检查用户，用户必须分配给这些角色才能访问页面。

```
string[] requiredRoles = new string[] { "Awesome", "Pancake" };
if (requiredRoles.Except(theUsersAssignedRoles).Any())
{
    // Authorization has failed!
    // The user is not awesome and they are not a pancake.
}
else
{
    // User is awesome and a pancake so let them through.
} 
```

这里的想法是列出所有必需的角色，并减去用户分配给他或她的所有角色。如果减法后列表中还有任何角色，则用户没有所有必需的角色。这里有一些例子。授权所需的角色在减号的左侧，而用户分配的角色在减号的右侧，就像上面的代码一样。

用户很棒，而且是煎饼，因此允许他们访问。请注意，我们最终得到一个空集，这意味着用户满足要求：

```
{ "Awesome", "Pancake" } - { "Awesome", "Pancake" } = { } 
```

用户只是一个煎饼。他们不被允许访问。结果集包含“Awesome”，这意味着它们缺少“Awesome”角色：

```
{ "Awesome", "Pancake" } - { "Pancake" } = { "Awesome" } 
```

这个用户不是很棒也不是煎饼，但她是管理员。尽管如此，我们仍然需要很棒的煎饼才能进入该页面，因此该用户被拒绝访问：

```
{ "Awesome", "Pancake" } - { "Admin" } = { "Awesome", "Pancake" } 
```

如果您有任何问题或这不是您想要的，请发表评论。如果需要，我很乐意为您提供进一步的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T18:24:55.330

听起来您确实在尝试使用此方法：

> [http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.getusersinrole.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.getusersinrole.aspx)
> 
> 参数
> 
> `roleName` 类型：System.String 获取用户列表的角色名称。

# asp.net - 从 MVC 操作返回多个文件

> ID：12713710
> 
> 赞同：23
> 
> 时间：2012-10-03T17:27:13.923
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, download

所以我有一个 MVC 3 应用程序，它有几个地方生成文本文件并在操作中返回：

```
return File(System.Text.Encoding.UTF8.GetBytes(someString),
                 "text/plain", "Filename.extension"); 
```

这非常有效。现在我遇到了一种情况，我试图以类似的方式返回一对文件。在视图中，我有一个操作链接，例如“单击此处获取这 2 个文件”，我希望下载这两个文件，就像在上面的代码片段中下载单个文件一样。

我怎样才能做到这一点？一直在搜索，甚至没有看到任何地方提出这个问题......

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-21T02:12:20.680

基于 Yogendra Singh 的想法并使用[DotNetZip](http://dotnetzip.codeplex.com/)：

```
var outputStream = new MemoryStream();

using (var zip = new ZipFile())
{
    zip.AddEntry("file1.txt", "content1");
    zip.AddEntry("file2.txt", "content2");
    zip.Save(outputStream);
}

outputStream.Position = 0;
return File(outputStream, "application/zip", "filename.zip"); 
```

**2019 年4 月 10 日更新：** 正如 @Alex 所指出的，自 .NET Framework 4.5 起，来自[JitBit](https://www.jitbit.com/alexblog/278-returning-a-zip-file-from-aspnet-mvc-action---in-pure-net/)和其他人的本地支持压缩：

```
using (var memoryStream = new MemoryStream())
{
   using (var archive = new ZipArchive(memoryStream, ZipArchiveMode.Create, true))
   {
      var file1 = archive.CreateEntry("file1.txt");
      using (var streamWriter = new StreamWriter(file1.Open()))
      {
         streamWriter.Write("content1");
      }

      var file2 = archive.CreateEntry("file2.txt");
      using (var streamWriter = new StreamWriter(file2.Open()))
      {
         streamWriter.Write("content2");
      }
   }

   return File(memoryStream.ToArray(), "application/zip", "Images.zip")
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-11-23T00:14:15.290

*很抱歉碰到一个老问题，但是......*

另一种选择是**使用 JavaScript 启动多个文件下载**，并在 ASP.NET 端以两种不同的操作方法提供文件。

你说你有一个链接：

> 在视图中，我有一个操作链接，例如“单击此处获取这 2 个文件”

所以让这个链接像这样：

```
<a href="#" onclick="downloadFile(url1); downloadFile(url2);">Click to get 2 files</a>
<script src="download.js"></script> 
```

我正在使用[此处](https://github.com/PixelsCommander/Download-File-JS/blob/master/src/download.js)`download.js`找到的脚本，但您可以找到许多不同的其他选项，请参阅这个 SO 问题：例如[使用 JavaScript 开始文件下载](https://stackoverflow.com/q/365777/714733)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-03T17:37:31.460

我建议`zip`使用步骤（算法）创建一个文件以包含这两个文件：

1.  创建一个 Zip 文件并将所需文件添加到 zip 中
2.  从操作中返回包含所有所需文件的 zip 文件

Java 语法（仅供理解）

```
 FileOutputStream fos = new FileOutputStream("downloadFile.zip");
      ZipOutputStream zos = new ZipOutputStream(new BufferedOutputStream(fos));
      zos.putNextEntry(new ZipEntry("Filename1.extension"+));
      //write data in FileName1.extension
      zos.write(contentBuffer1, 0, len);

      zos.putNextEntry(new ZipEntry("Filename2.extension"));
      //write data in FileName2.extension
      zos.write(contentBuffer2, 0, len);

      //write other files.....
      zos.close(); 
```

创建文件后`zip`，返回新创建的`zip`文件进行下载。

```
 return File("downloadFile.zip"); 
```

.DOT 网络等效使用[DotNetZip](http://dotnetzip.codeplex.com/)

```
 var os = new MemoryStream();

     using (var zip = new ZipFile())
     {
         //write the first file into the zip
         zip.AddEntry("file1.txt", "content1");

         //write the second file into the zip
         zip.AddEntry("file2.txt", "content2");

         //write other files.....
         zip.Save(os);
      }

      outputStream.Position = 0;
      return File(outputStream, "application/zip", "filename.zip"); 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T20:06:34.477

看看这个 SO 解决方案： [MVC Streaming Zip File](https://stackoverflow.com/questions/838397/stream-zip-file-mvc-net-start-streaming)

此解决方案的优点是它将文件流式传输到客户端。

几天前我刚刚实施了这个解决方案，效果非常好。

# asp.net - Visual Web Developer Publish 上的“找不到有效的 AspnetMergePath”？

> ID：12713714
> 
> 赞同：26
> 
> 时间：2012-10-03T17:27:25.953
> 
> 标签：asp.net, visual-studio, deployment, publishing, visual-web-developer

我想使用 Visual Web Developer Express 2010 发布网站，使用以下设置通过 FTP 预编译到远程服务器：

*   仅部署运行此应用程序所需的文件
*   在发布之前预编译此应用程序
*   允许网站可更新
*   没有部署数据库
*   站点被部署为文件层次结构，而不是 .zip 包

我的第一次构建/部署似乎进展顺利，但在第二次编译后，我收到以下错误：

```
Transformed web.config using C:\path_to_site\Web.Debug.config into obj\Debug\TransformWebConfig\transformed\web.config.
Copying all files to temporary location below for package/publish:
obj\Debug\AspnetCompileMerge\Source.
C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.5\Web\Transform\Microsoft.Web.Publishing.AspNetCompileMerge.targets(132,5): Error : Can't find the valid AspnetMergePath 
```

这是 Microsoft.Web.Publishing.AspNetConfigurationMerge.targets 文件内容的子集：

```
 <Target
      Name="GetAspNetMergePath"
      DependsOnTargets="$(GetAspNetMergePathDependsOn)"
      Condition ="'$(GetAspNetMergePath)' != 'false'">
    <PropertyGroup>
      <AspnetMergeName>aspnet_merge.exe</AspnetMergeName>
      <AspnetMergePath Condition="Exists('$(TargetFrameworkSDKToolsDirectory)$(AspnetMergeName)')">$(TargetFrameworkSDKToolsDirectory)</AspnetMergePath>
    </PropertyGroup>
    <Error Condition="'$(AspnetMergePath)' == '' Or !Exists($(AspnetMergePath))"
           Text="Can't find the valid AspnetMergePath" />
  </Target> 
```

编辑：在发布之前更改发布设置以删除所有现有文件毕竟不能解决问题。我假设这个问题现在是本地的。

我的 web.config 中似乎没有 AspMergePath 标记。我不知道我是否应该手动添加标签。但是，路径“obj{publish setting}\AspnetCompileMerge\Source”确实存在于我的项目中。

如果它很重要，我的项目名称是“TestProject.NET”

感谢您的反馈。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-05-22T14:34:54.820

我遇到了同样的问题。搜索了所有与微软相关的网站，发现很多投诉，微软无意修复它。

这是我如何在我的系统上解决它的。编辑`Microsoft.Web.Publishing.AspNetConfigurationMerge.targets`文件并添加以下行。请确保您的 PC 上的 Microsoft SDK 路径相同，否则请更改它：

```
<TargetFrameworkSDKToolsDirectory>C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\</TargetFrameworkSDKToolsDirectory> 
```

这是它的样子：

```
 <Target
  Name="GetAspNetMergePath"
  DependsOnTargets="$(GetAspNetMergePathDependsOn)"
  Condition ="'$(GetAspNetMergePath)' != 'false'">
<PropertyGroup>
  <TargetFrameworkSDKToolsDirectory>C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\</TargetFrameworkSDKToolsDirectory>
  <AspnetMergeName>aspnet_merge.exe</AspnetMergeName>
  <AspnetMergePath Condition="Exists('$(TargetFrameworkSDKToolsDirectory)$(AspnetMergeName)')">$(TargetFrameworkSDKToolsDirectory)</AspnetMergePath>
</PropertyGroup>
<Error Condition="'$(AspnetMergePath)' == '' Or !Exists($(AspnetMergePath))"
       Text="Can't find the valid AspnetMergePath" /> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-01-08T19:06:21.263

这是一个不需要更改目标文件的解决方案。[http://connect.microsoft.com/VisualStudio/feedback/details/786492/publish-cant-find-the-valid-aspnetmergepath](http://connect.microsoft.com/VisualStudio/feedback/details/786492/publish-cant-find-the-valid-aspnetmergepath)的解决方法建议将其他属性传递给 msbuild。我能够使用它来工作：

> msbuild website.publishproj /p:DeployOnBuild=true /p:PublishProfile=Release /p:VisualStudioVersion=12.0 /p:AspnetMergePath="C:\Program Files (x86)\Microsoft SDKs\Windows\v8.1A\bin\NETFX 4.5 .1 工具\"

这里的关键是`AspnetMergePath`属性，如果 Windows SDK 安装在不同的位置，您可能需要更改该属性。如果我包含`GetAspNetMergePath`解决方法中的属性，它会失败，但根据 SDK 版本可能需要这样做。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-04-15T14:55:47.357

您需要的是 aspnet_merge.exe，它是作为 Windows SDK 的一部分分发的工具。它旨在预编译站点，因此您可以关闭该预编译，或安装正确版本的[Windows SDK](http://en.wikipedia.org/wiki/Microsoft_Windows_SDK)。参考维基百科，因为下载页面的链接很好。你不需要下载/安装所有东西（它很大），只需下载网络安装程序并选择 .Net 工具，大约需要 50 兆字节。

请注意，它与 Visual Studio 2010 Windows SDK 版本捆绑在一起。7.0A 无法单独下载，因此您必须在构建服务器上安装 Visual Studio，或者按照“[运行 MSBuild 无法读取 SDKToolsPath](https://stackoverflow.com/questions/2731365/running-msbuild-fails-to-read-sdktoolspath) ”的答案中所述进行调整。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-02-10T12:40:43.133

*所有这些东西的一种解决方法 [包括必须安装 SDK 等] 是禁用 Precompile On Publish 选项，即使您没有指定要在最终输出中合并内容*，它也需要存在 AspNetMerge 。

我竭尽全力弄清楚如何将其关闭，仔细研究选项对话框并阅读友好手册以确认我已将其关闭了很长时间才意识到它是外面的复选框：

[![在此处输入图像描述](../Images/770960f2d467eccc5391add880219103.png)](https://i.stack.imgur.com/ew8cf.png)

取消选中会对 产生以下更改`.pubxml`：

```
-    <PrecompileBeforePublish>True</PrecompileBeforePublish>
-    <EnableUpdateable>True</EnableUpdateable>
-    <DebugSymbols>False</DebugSymbols>
-    <WDPMergeOption>DonotMerge</WDPMergeOption> 
```

这对我有用。

NB然而，至关重要的是*，*在（假设 Visual Studio 2015 工具）下存在（这将通过惰性进行静默发布）和（这将产生编译器错误）子文件夹用于发布[以](https://stackoverflow.com/questions/6409549/web-deploy-packaging-not-working-on-my-build-server)**成功****`Web`生成`/p:DeployOnBuild`**`WebApplications`包`%Program Files (x86)%\MSBuild\Microsoft\VisualStudio\v14.0`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-10T13:30:56.527

我遇到了同样的问题。

编辑 Microsoft.Web.Publishing.AspNetConfigurationMerge.targets 文件并添加以下行。确保以管理员权限运行编辑器。

在我的案例 VS2013 中看起来是正确的 Visual Studio 版本。

x64

```
<TargetFrameworkSDKToolsDirectory>C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\</TargetFrameworkSDKToolsDirectory> 
```

x86

```
<TargetFrameworkSDKToolsDirectory>C:\Program Files\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\</TargetFrameworkSDKToolsDirectory> 
```

它有效！我可以编译我的项目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-07-20T12:43:45.840

在我的情况下失踪了。它发生在将 Visual Studio 2017 更新到 15.7.5 之后。在此之前它工作正常。我必须添加

```
<TargetFrameworkSDKToolsDirectory>C:\Program Files (x86)\Microsoft SDKs\Windows\v8.1A\bin\NETFX 4.5.1 Tools\</TargetFrameworkSDKToolsDirectory> 
```

它位于 Microsoft.Web.Publishing.AspNetCompileMerge.targets 的第 129 行

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-23T16:41:09.163

更改目标框架 ...

```
<compilation debug="true" targetFramework="4.8"/>
<httpRuntime targetFramework="4.8"/> 
```

# c++ - 使用 CryptVerifySignature 进行数字签名

> ID：12713715
> 
> 赞同：0
> 
> 时间：2012-10-03T17:27:29.793
> 
> 标签：c++, winapi, cryptography, digital-signature

我想使用 CryptVerifySignature 实现数字签名应用程序。我已经编写了这段代码（在 MSDN 示例的帮助下）：

```
#define Check(condition, message) if (!(condition)) { fprintf(stderr, "%s\n", message); goto Exit; };
void DigSign(const char* inputFileName, const char* signFileName)
{

    HCRYPTPROV hProv;
    BYTE *pbBuffer= NULL;
    DWORD dwBufferLen = 0;
    HCRYPTHASH hHash;
    HCRYPTKEY hKey;
    HCRYPTKEY hPubKey;
    BYTE *pbKeyBlob;        
    BYTE *pbSignature;
    DWORD dwSigLen;
    DWORD dwBlobLen;

    FILE* inputFile = NULL;

    Check((inputFile = fopen(inputFileName, "r")) != NULL, "File does not exists");
    dwBufferLen = GetFileSize(inputFile);
    Check(pbBuffer = (BYTE*)malloc(dwBufferLen + 1), "cannot allocate memory");

    fread(pbBuffer, 1, dwBufferLen, inputFile);
    pbBuffer[dwBufferLen] = '\0';
    fclose(inputFile);

    //-------------------------------------------------------------------
    // Acquire a cryptographic provider context handle.

    Check(CryptAcquireContext(&hProv, NULL, NULL, PROV_RSA_FULL, 0), "Error during CryptAcquireContext.");

    if(!CryptGetUserKey(hProv, AT_SIGNATURE, &hKey)) 
    {
        if(NTE_NO_KEY == GetLastError())
        {
            Check(CryptGenKey(hProv, AT_SIGNATURE, CRYPT_EXPORTABLE, &hKey), "Could not create a user public key.\n");
        }
        else
        {
            goto Exit;
        }
    }

    Check(CryptExportKey(hKey, NULL, PUBLICKEYBLOB, 0, NULL, &dwBlobLen), "Error computing BLOB length.");
    Check(pbKeyBlob = (BYTE*)malloc(dwBlobLen), "Out of memory. \n");
    Check(CryptExportKey(hKey, NULL, PUBLICKEYBLOB, 0, pbKeyBlob, &dwBlobLen), "Error during CryptExportKey.");

    //-------------------------------------------------------------------
    // Create the hash object.
    Check(CryptCreateHash(hProv, CALG_SHA, 0, 0, &hHash), "Error during CryptCreateHash.");

    //-------------------------------------------------------------------
    // Compute the cryptographic hash of the buffer.
    Check(CryptHashData(hHash, pbBuffer, dwBufferLen, 0), "Error during CryptHashData.");

    //-------------------------------------------------------------------
    // Determine the size of the signature and allocate memory.

    dwSigLen= 0;
    Check(CryptSignHash(hHash, AT_SIGNATURE, NULL, 0, NULL, &dwSigLen), "Error during CryptSignHash.");

    //-------------------------------------------------------------------
    // Allocate memory for the signature buffer.
    Check(pbSignature = (BYTE *)malloc(dwSigLen), "Out of memory.");

    //-------------------------------------------------------------------
    // Sign the hash object.
    Check(CryptSignHash(hHash, AT_SIGNATURE, NULL, 0, pbSignature, &dwSigLen), "Error during CryptSignHash.");

    FILE* f = fopen(signFileName, "w");
    fwrite(pbSignature, dwSigLen, 1, f);
    printf("W: %.128s\n", pbSignature);
    fwrite(pbKeyBlob, dwBlobLen, 1, f);
    printf("W: %.148s\n", pbKeyBlob);
    fclose(f);
    //-------------------------------------------------------------------
    // Destroy the hash object.

    if(hHash) 
        CryptDestroyHash(hHash);

    free(pbSignature);
    free(pbKeyBlob);

    if(hProv) 
        CryptReleaseContext(hProv, 0);

Exit:;
}

bool CheckDigSign(const char* inputFileName, const char* signFileName, const char* userName)
{
    bool result = false;
    HCRYPTPROV hProv;
    BYTE *pbBuffer= (BYTE *)"The data that is to be hashed and signed.";
    DWORD dwBufferLen = strlen((char *)pbBuffer)+1;
    HCRYPTHASH hHash;
    HCRYPTKEY hKey;
    HCRYPTKEY hPubKey;
    BYTE *pbKeyBlob;        
    BYTE *pbSignature;
    DWORD dwSigLen;
    DWORD dwBlobLen;

    FILE* inputFile = NULL;

    Check((inputFile = fopen(inputFileName, "r")) != NULL, "File does not exists");
    dwBufferLen = GetFileSize(inputFile);
    Check(pbBuffer = (BYTE*)malloc(dwBufferLen + 1), "cannot allocate memory");

    fread(pbBuffer, 1, dwBufferLen, inputFile);
    pbBuffer[dwBufferLen] = '\0';
    fclose(inputFile);

    FILE* signFile = NULL;
    Check((signFile = fopen(signFileName, "r")) != NULL, "File does not exists");
    DWORD dwSignFileLen = GetFileSize(signFile);
    dwSigLen = 128;
    pbSignature = (BYTE*)malloc(dwSigLen);
    dwBlobLen = dwSignFileLen - dwSigLen;
    pbKeyBlob = (BYTE*)malloc(dwBlobLen);
    fread(pbSignature, 1, dwSigLen, signFile);
    fread(pbKeyBlob, 1, dwBlobLen, signFile);
    fclose(signFile);

    printf("R: %.128s\n", pbSignature);
    printf("R: %.148s\n", pbKeyBlob);

    Check(CryptAcquireContext(&hProv, NULL, NULL, PROV_RSA_FULL, 0), "Error during CryptAcquireContext.");

    Check(CryptImportKey(hProv, pbKeyBlob, dwBlobLen, 0, 0, &hPubKey), "Public key import failed.");

    //-------------------------------------------------------------------
    // Create a new hash object.
    Check(CryptCreateHash(hProv, CALG_SHA, 0, 0, &hHash), "Error during CryptCreateHash.");

    //-------------------------------------------------------------------
    // Compute the cryptographic hash of the buffer.
    Check(CryptHashData(hHash, pbBuffer, dwBufferLen, 0), "Error during CryptHashData.");

    //-------------------------------------------------------------------
    // Validate the digital signature.

    result = CryptVerifySignature(hHash, pbSignature, dwSigLen, hPubKey, NULL, 0); 
    printf("%u %x", GetLastError(), GetLastError());
    //-------------------------------------------------------------------
    // Free memory to be used to store signature.

    if(pbSignature)
        free(pbSignature);

    //-------------------------------------------------------------------
    // Destroy the hash object.

    if(hHash) 
        CryptDestroyHash(hHash);

    //-------------------------------------------------------------------
    // Release the provider handle.

    if(hProv) 
        CryptReleaseContext(hProv, 0);

Exit:
    return result;
}

int _tmain(int argc, _TCHAR* argv[])
{

    DigSign("test3.txt", "test.sig");
    printf("TEST: %u\n", CheckDigSign("test3.txt", "test.sig", ""));
} 
```

DigSign 函数必须对文件内容进行签名，并将签名和公钥写入另一个文件。如果符号正确，CheckSign 必须返回 true。但我不明白为什么我的代码不起作用。_tmain 中的 CheckDigSign 必须返回 true，但它返回 false。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T18:10:01.980

我拿了你的整个代码示例，稍微修改了一下，并为所有文件 I/O 使用了 CreateFile、ReadFile 和 WriteFile。有用。带有附加公钥的签名文件对源文件进行了很好的检查。

因此，我怀疑这是读取/写入文件的方法，特别是“w”和“r”与“wb”和“rb”对你的字节的影响。尝试改变这些，看看你想出了什么。

作为参考，修改后的代码在下面，并且在我所做的更改中没有错误检查，所以不要将它用于任何特殊的东西，因为它的价值实际上低于其印刷的纸张（即什么都没有）。

```
#define Check(condition, message) if (!(condition)) { fprintf(stderr, "%s\n", message); goto Exit; };
void DigSign(const char* inputFileName, const char* signFileName)
{

    HCRYPTPROV hProv;
    BYTE *pbBuffer= NULL;
    DWORD dwBufferLen = 0;
    HCRYPTHASH hHash;
    HCRYPTKEY hKey;
    BYTE *pbKeyBlob;        
    BYTE *pbSignature;
    DWORD dwSigLen;
    DWORD dwBlobLen;

    FILE* inputFile = NULL;

    HANDLE hFileInput = CreateFile(inputFileName,   // file to open
                         GENERIC_READ,              // open for reading
                         FILE_SHARE_READ,           // share for reading
                         NULL,                      // default security
                         OPEN_EXISTING,             // existing file only
                         FILE_ATTRIBUTE_NORMAL,     // normal file
                         NULL);    

    dwBufferLen = GetFileSize(hFileInput, NULL);
    Check(pbBuffer = (BYTE*)malloc(dwBufferLen + 1), "cannot allocate memory");

    DWORD dwBytesRead = 0L;
    ReadFile(hFileInput, pbBuffer, dwBufferLen, &dwBytesRead, NULL);
    pbBuffer[dwBufferLen] = 0;
    CloseHandle(hFileInput);

    //-------------------------------------------------------------------
    // Acquire a cryptographic provider context handle.

    Check(CryptAcquireContext(&hProv, NULL, NULL, PROV_RSA_FULL, 0), "Error during CryptAcquireContext.");

    if(!CryptGetUserKey(hProv, AT_SIGNATURE, &hKey)) 
    {
        if(NTE_NO_KEY == GetLastError())
        {
            Check(CryptGenKey(hProv, AT_SIGNATURE, CRYPT_EXPORTABLE, &hKey), "Could not create a user public key.\n");
        }
        else
        {
            goto Exit;
        }
    }

    Check(CryptExportKey(hKey, NULL, PUBLICKEYBLOB, 0, NULL, &dwBlobLen), "Error computing BLOB length.");
    Check(pbKeyBlob = (BYTE*)malloc(dwBlobLen), "Out of memory. \n");
    Check(CryptExportKey(hKey, NULL, PUBLICKEYBLOB, 0, pbKeyBlob, &dwBlobLen), "Error during CryptExportKey.");

    //-------------------------------------------------------------------
    // Create the hash object.
    Check(CryptCreateHash(hProv, CALG_SHA, 0, 0, &hHash), "Error during CryptCreateHash.");

    //-------------------------------------------------------------------
    // Compute the cryptographic hash of the buffer.
    Check(CryptHashData(hHash, pbBuffer, dwBufferLen, 0), "Error during CryptHashData.");

    //-------------------------------------------------------------------
    // Determine the size of the signature and allocate memory.

    dwSigLen= 0;
    Check(CryptSignHash(hHash, AT_SIGNATURE, NULL, 0, NULL, &dwSigLen), "Error during CryptSignHash.");

    //-------------------------------------------------------------------
    // Allocate memory for the signature buffer.
    Check(pbSignature = (BYTE *)malloc(dwSigLen), "Out of memory.");

    //-------------------------------------------------------------------
    // Sign the hash object.
    Check(CryptSignHash(hHash, AT_SIGNATURE, NULL, 0, pbSignature, &dwSigLen), "Error during CryptSignHash.");

    HANDLE hFileSign = CreateFile(signFileName, // name of the write
                         GENERIC_WRITE,         // open for writing
                         0,                     // do not share
                         NULL,                  // default security
                         CREATE_NEW,            // create new file only
                         FILE_ATTRIBUTE_NORMAL, // normal file
                         NULL);                  // no attr. template

    DWORD dwBytesWritten = 0;
    WriteFile(hFileSign, pbSignature, dwSigLen, &dwBytesWritten, NULL);
    WriteFile(hFileSign, pbKeyBlob, dwBlobLen, &dwBytesWritten, NULL);
    CloseHandle(hFileSign);

    printf("W: %.128s\n", pbSignature);
    printf("W: %.148s\n", pbKeyBlob);

    //-------------------------------------------------------------------
    // Destroy the hash object.

    if(hHash) 
        CryptDestroyHash(hHash);

    free(pbSignature);
    free(pbKeyBlob);

    if(hProv) 
        CryptReleaseContext(hProv, 0);

Exit:;
}

bool CheckDigSign(const char* inputFileName, const char* signFileName, const char* userName)
{
    BOOL result = false;
    HCRYPTPROV hProv;
    BYTE *pbBuffer= (BYTE *)"The data that is to be hashed and signed.";
    DWORD dwBufferLen = strlen((char *)pbBuffer)+1;
    HCRYPTHASH hHash;
    HCRYPTKEY hPubKey;
    BYTE *pbKeyBlob;        
    BYTE *pbSignature;
    DWORD dwSigLen;
    DWORD dwBlobLen;

    HANDLE hFileInput = CreateFile(inputFileName,   // file to open
                         GENERIC_READ,              // open for reading
                         FILE_SHARE_READ,           // share for reading
                         NULL,                      // default security
                         OPEN_EXISTING,             // existing file only
                         FILE_ATTRIBUTE_NORMAL,     // normal file
                         NULL);

    dwBufferLen = GetFileSize(hFileInput, NULL);
    Check(pbBuffer = (BYTE*)malloc(dwBufferLen + 1), "cannot allocate memory");

    DWORD dwBytesRead = 0;
    ReadFile(hFileInput, pbBuffer, dwBufferLen, &dwBytesRead, NULL);
    pbBuffer[dwBufferLen] = 0;
    CloseHandle(hFileInput);

    HANDLE hFileSig = CreateFile(signFileName,      // file to open
                         GENERIC_READ,              // open for reading
                         FILE_SHARE_READ,           // share for reading
                         NULL,                      // default security
                         OPEN_EXISTING,             // existing file only
                         FILE_ATTRIBUTE_NORMAL,     // normal file
                         NULL);

    DWORD dwSignFileLen = GetFileSize(hFileSig, NULL);
    dwSigLen = 128;
    pbSignature = (BYTE*)malloc(dwSigLen);
    dwBlobLen = dwSignFileLen - dwSigLen;
    pbKeyBlob = (BYTE*)malloc(dwBlobLen);
    ReadFile(hFileSig, pbSignature, dwSigLen, &dwBytesRead, NULL);
    ReadFile(hFileSig, pbKeyBlob, dwBlobLen, &dwBytesRead, NULL);
    CloseHandle(hFileSig);

    printf("R: %.128s\n", pbSignature);
    printf("R: %.148s\n", pbKeyBlob);

    Check(CryptAcquireContext(&hProv, NULL, NULL, PROV_RSA_FULL, 0), "Error during CryptAcquireContext.");
    Check(CryptImportKey(hProv, pbKeyBlob, dwBlobLen, 0, 0, &hPubKey), "Public key import failed.");

    //-------------------------------------------------------------------
    // Create a new hash object.
    Check(CryptCreateHash(hProv, CALG_SHA, 0, 0, &hHash), "Error during CryptCreateHash.");

    //-------------------------------------------------------------------
    // Compute the cryptographic hash of the buffer.
    Check(CryptHashData(hHash, pbBuffer, dwBufferLen, 0), "Error during CryptHashData.");

    //-------------------------------------------------------------------
    // Validate the digital signature.

    result = CryptVerifySignature(hHash, pbSignature, dwSigLen, hPubKey, NULL, 0); 
    printf("%u %x", GetLastError(), GetLastError());
    //-------------------------------------------------------------------
    // Free memory to be used to store signature.

    if(pbSignature)
        free(pbSignature);

    //-------------------------------------------------------------------
    // Destroy the hash object.

    if(hHash) 
        CryptDestroyHash(hHash);

    //-------------------------------------------------------------------
    // Release the provider handle.

    if(hProv) 
        CryptReleaseContext(hProv, 0);

Exit:
    return !!result;
}

int _tmain(int argc, _TCHAR* argv[])
{
    if (argc == 3)
    {
        DigSign(argv[1], argv[2]);
        printf("TEST: %u\n", CheckDigSign(argv[1], argv[2],""));
        return 0;
    }
    return 1;
} 
```

# dictionary - 二郎语词典。它是存储在内存中还是磁盘上

> ID：12713721
> 
> 赞同：1
> 
> 时间：2012-10-03T17:27:52.710
> 
> 标签：dictionary, erlang

我是一个二郎新手，所以如果这个问题非常愚蠢，我深表歉意。我正在`erlang:dict()`构建一些引用用户信息的东西，例如 Kevin Smith 的 Erlang in Practice 示例。

我想知道`dict`记录是否存储在内存中。是不是类似于 Ruby 的 Hash 数据结构。

`dict`当系统重新启动后需要引用记录时，记录是否实际存储在生产系统中？我需要为在我的系统上注册的每个用户存储一个用户 Uid、昵称和密码，但我需要这些信息是持久的，就像 XMPP 如何处理注册用户一样。在这种情况下我应该使用 Mnesia 吗？

非常感谢您的帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T17:43:39.870

字典不会在重新启动后存活。您应该根据需要使用 mnesia、dets 或其他您选择的数据库系统。我猜 mnesia 对 ids、unames 和密码都很好。

# c# - 用于检索的实体框架代码优先过滤结果

> ID：12713728
> 
> 赞同：0
> 
> 时间：2012-10-03T17:28:24.613
> 
> 标签：c#, .net, entity-framework

> **可能重复：**
> [Soft Delete Entity Framework Code First](https://stackoverflow.com/questions/12698793/soft-delete-entity-framework-code-first)

有没有办法在返回结果之前过滤实体的结果？所以说 First 或 Find 或我选择对实体使用的任何方法都不会返回任何超过 3 个月的东西。此外，如果我包含实体，它也会被过滤。我正在尝试使用它来实现软删除等

如果可能的话，我希望以某种方式在内部完成，所以我可以说`_db.SmallGroups.ToList()`，它会知道不带回哪些记录（即旧记录，IsDeleted==true 记录）我不想每次都输入这个逻辑如果可能，查询点

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:31:32.770

当然，您可以在*where*子句中指定您的条件

```
DateTime threeMonthsAgo = DateTime.Now.AddMonths(-3);

var results = 
    (from t in context.MyTable where t.TheTime > threeMonthsAgo select t).First(); 
```

**更新**

根据您的评论...

您确实可以构建一个表达式，您可以将其用作*where*条件。

这是我为*包含*条件类型编写的扩展方法（XML 注释中引用的原始源）

```
/// <summary>
/// Extension method that enables .Contains(obj) like functionality for Linq to Entities.
/// 
/// Source: http://www.velocityreviews.com/forums/t645784-linq-where-clause.html
/// </summary>
/// <typeparam name="TElement">The element being evaluated by the Where clause</typeparam>
/// <typeparam name="TValue">The value to match</typeparam>
/// <param name="valueSelector">Lamda for selecting matching values</param>
/// <param name="values">IEnumerable of the values</param>
/// <returns>Expression consumable by Linq to Entities that reflects semantics of .Contains(value)</returns>
/// <remarks>
/// Usage:
/// 
/// Replace expression like 
/// 
/// where ChildrenIDs.Contains(items.CategoryID)
/// 
/// with
/// 
/// .Where((BuildContainsExpression<Item, int>(item => item.CategoryID, ChildrenIDs))
/// 
/// NOTE: If the item collection is large, the SQL query will be as well.
/// </remarks>
static public Expression<Func<TElement, bool>> BuildContainsExpression<TElement, TValue>(Expression<Func<TElement, TValue>> valueSelector, IEnumerable<TValue> values)
{
    if (null == valueSelector)
    {
        throw new ArgumentNullException("valueSelector");
    }
    if (null == values) { throw new ArgumentNullException("values"); }

    ParameterExpression p = valueSelector.Parameters.Single();
    if (!values.Any())
    {
        return e => false;
    }

    var equals = values.Select(value => (Expression)Expression.Equal(valueSelector.Body, Expression.Constant(value, typeof(TValue))));
    var body = equals.Aggregate<Expression>((accumulate, equal) => Expression.Or(accumulate, equal));
    return Expression.Lambda<Func<TElement, bool>>(body, p);
} 
```

**用法**

```
HashSet<long> productCodes = new HashSet<long>(); // Populate with some product codes to match

productCodeWhere = LinqToEntitiesUtil.BuildContainsExpression<Verbatim, long>(v => v.ProductCode, productCodes);

var matching = (from v in ctx.MyTable where MY_CONDITIONS select v)
    .Where(productCodeWhere); 
```

# django - 管理员内联 one2one 字段

> ID：12713730
> 
> 赞同：0
> 
> 时间：2012-10-03T17:28:30.640
> 
> 标签：django, django-admin

我有三个 django 模型，我想在订单页面上编辑项目的实例。可能吗？

```
#models.py

class Item(models.Model):
    name = models.CharField(max_length = 128)
    cart = models.ForeignKey('Cart')

class Cart(models.Model):
    number = models.IntegerField()

class Order(models.Model):
    cart = models.OneToOneField('Cart')

#admin.py

ItemInline(admin.TabularInline):
    model = Item

CartInline(admin.TabularInline):
    model = Cart

Order(ModelAdmin):
    inlines = (CartInline,) # I need ItemInline here... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T04:59:36.463

让它成为购物车的内联，而不是相反？

# java - 使用 JavaScript 和 JSP 使用动态信息填充 Google Analytics 标记

> ID：12713734
> 
> 赞同：0
> 
> 时间：2012-10-03T17:28:46.673
> 
> 标签：java, javascript, analytics

我正在更新一个 JSP 文件以在 Google Analytics 中创建一个虚拟综合浏览量。当我单击正确的链接时，我可以看到 trackPageView 事件触发，但是我试图动态提取的信息没有出现，我不知道为什么。

我尝试了两种方法。我的第一次尝试是直接在 GA 标记中添加一个语句（它始终适用于 _trackEvent）。这不会产生任何信息。

我的第二个想法是在 JavaScript 中使用 a 创建一个变量，然后在 GA 代码中使用该变量。这样做的问题是我不太了解 JavaScript（或者 JSP 就这件事......在工作中学习）并且我不确定提取该变量的正确方法，因为它已经在 ''从 GA 代码。这是我的代码（应该动态填充 _trackPageView 调用中的 currentPDP）：

```
 <script type="text/javascript">
                    var currentPDP = <c:out value="${link.key}" /> [];
                    var _gaq = _gaq || [];

                    $(document).ready(function(){
                        $('a.online').click(function (e) {
                            $('#retail-modal').modal();
                            _gaq.push(['_setAccount', 'UA-33021136-1']); 
                            _gaq.push(['_trackPageview', '/vp/currentPDP/retailer links page']);
                            (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                  })();
                            return false;

                        });
                    });

                </script> 
```

任何有关如何实现这一目标的建议将不胜感激。最终目标是将用户正在查看的当前页面中的特定值（产品名称）添加到 Google Analytics 标记中，以便我们知道他们在哪个页面上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T14:31:08.467

我最终通过更新另一个.JSP 文件中的JavaScript 函数来解决这个问题，该文件正在向这个文件发送数据。我必须将相应的参数添加到 .JSP 文件中，然后才能提取我正在寻找的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:25:59.960

在 JSP 中，你可以像这样插入一个“echo”标签：

```
<%= jspVariable %> 
```

在 JavaScript 代码中，您可以通过执行以下操作将 JavaScript 变量连接到另一个变量：

```
var url = 'http://mydomain.com/other/stuff';
existingVar += url; 
```

您要添加到哪一行 Google Analytics（分析）代码？

猜测它的这条线：

```
_gaq.push(['_trackPageview', '/vp/currentPDP/retailer links page']); 
```

假设您要替换**零售商链接页面**，您将对 Java 变量执行以下操作：

```
_gaq.push(['_trackPageview', '/vp/currentPDP/<%= jspVariableHoldingPageURLLink %>']); 
```

或使用 Javascript

```
_gaq.push(['_trackPageview', '/vp/currentPDP/' + 'javaScriptVariableHoldingPageURLLink' ]); 
```

# php - PHP 在响应时显示 iFrame

> ID：12713738
> 
> 赞同：-1
> 
> 时间：2012-10-03T17:28:53.850
> 
> 标签：php, html, iframe, file-upload, fancybox

[我在这里](https://stackoverflow.com/questions/12712814/html-iframe-hide-show)有一个较早的帖子，但答案根本没有帮助。我有这样的上传功能：

```
<iframe class="iframe" name="message" src="upload.php" style="display:none;"></iframe>
<form action="upload.php" method="post" enctype="multipart/form-data" target="message">
    Select a file: <input type="file" name="upload">
    <input type="submit">
</form> 
```

我正在尝试做这样的事情：

```
$('.iframe').fancybox({
    'hideOnContentClick': true
}); 
```

因此，当 upload.php 给出响应（“文件成功上传”）时，它会进入 iframe，这很棒。但我需要 iframe 来显示。upload.php 回复消息后如何取消隐藏 iframe？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:01:38.703

你真的必须有一个内联 iframe 吗？您可以尝试`submit`通过 ajax 表单并在 fancybox 中显示响应，而无需像内联 iframe

```
<form id="uploadForm" action="upload.php" method="post" enctype="multipart/form-data" target="message">
    Select a file: <input type="file" name="upload">
    <input type="submit">
</form> 
```

**请注意**，我在表单中添加了一个**ID**，以便我们可以通过该选择器对其进行操作。然后是 jQuery ：

```
$("#uploadForm").bind("submit", function() {
 $.ajax({
   type     : "POST",
   cache    : false,
   url      : "upload.php",
   success  : function(data) {
    $.fancybox(data.responseText,{
      'hideOnContentClick': true
    });
   }
 });
 return false;
}); 
```

# object - 命令行参数 - 需要对象：'objshell.NameSpace(...)'

> ID：12713740
> 
> 赞同：6
> 
> 时间：2012-10-03T17:28:59.603
> 
> 标签：object, vbscript, namespaces

我正在编写一个脚本，该脚本将利用 Windows 的内置功能来解压缩提供的 .zip 文件。我对 vbscript 很陌生，所以有些语法让我有点难过。我正在使用一些现有代码并尝试对其进行修改，以便它将为文件名提供命令行选项。如果我使用命令行传递文件名，我会收到错误：

> 需要对象：'objshell.NameSpace(...)'

如果我在脚本中使用文本填充相同的变量，则脚本运行时不会出错。尝试使用命令参数时是否还缺少其他部分？

这是我的代码：

```
Option Explicit

Dim sDestinationDirectory,sLogDestination,fso,outLog,sJunk,sSourceFile

sDestinationDirectory = "C:\scripts\vbscriptTemplates\unzip"
sLogDestination = "C:\scripts\vbscriptTemplates\"

Set fso=CreateObject("Scripting.FileSystemObject")
Set outLog = fso.OpenTextFile("unzipRIP.log", 2, True)
If WScript.Arguments.Count = 1 Then
    sSourceFile = WScript.Arguments.Item(0)     'Using this line the code will fail.
    'sSourceFile = "C:\scripts\vbscriptTemplates\test.zip"     'Using this line the code will run.
    outLog.WriteLine ".:|Processing new zip file|:."
    outLog.WriteLine "Processing file: " & sSourceFile
    Extract sSourceFile,sDestinationDirectory
Else
    sJunk = MsgBox("File to be processed could not be found. Please verify.",0,"Unzip - File not found")
    outLog.WriteLine "File to be processed could not be found. Please verify."
    outLog.Close
    Wscript.Quit
End If

Sub Extract( ByVal myZipFile, ByVal myTargetDir )
    Dim intOptions, objShell, objSource, objTarget

    outLog.WriteLine "Processing file in subroutine: " & myZipFile & " target " & myTargetDir
    ' Create the required Shell objects
    Set objShell = CreateObject( "Shell.Application" )

    ' Create a reference to the files and folders in the ZIP file
    Set objSource = objShell.NameSpace( myZipFile ).Items()

    ' Create a reference to the target folder
    Set objTarget = objShell.NameSpace( myTargetDir )
    intOptions = 4

    ' UnZIP the files
    objTarget.CopyHere objSource, intOptions

    ' Release the objects
    Set objSource = Nothing
    Set objTarget = Nothing
    Set objShell  = Nothing
End Sub 
```

引用的行是

> sSourceFile = WScript.Arguments.Item(0)

这是我尝试对 Rob van der Woude 编写的代码进行修改。 [http://www.robvanderwoude.com/vbstech_files_zip.php#CopyHereUNZIP](http://www.robvanderwoude.com/vbstech_files_zip.php#CopyHereUNZIP)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-03T23:27:44.273

尝试

```
Set fso = CreateObject("Scripting.FileSystemObject")
sSourceFile = fso.GetAbsolutePathName(WScript.Arguments.Item(0)) 
```

代替

```
sSourceFile = WScript.Arguments.Item(0) 
```

# python - 在python中，如何操作实例的命名空间

> ID：12713743
> 
> 赞同：0
> 
> 时间：2012-10-03T17:29:10.323
> 
> 标签：python

问题是在单元测试的背景下。我已经创建了我正在测试的类的一个实例，并尝试测试它的一种方法。该方法使用从单独模块中定义的不同类获取的数据。我要模拟那个模块。如何访问我的实例的名称空间 - 我必须在运行我正在测试的方法之前这样做，以模拟包含我的方法从中获取数据的类的定义的模块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:44:09.160

我将在这里创建一个示例，我认为它与您正在尝试做的事情相似。

假设您有一些我们将`Data`在模块中定义的类`foo`。`foo`模块导入和调用`bar`方法来填充自身。`foo.Data``bar.get_data()`

您想要创建一个`test`将创建 的实例的模块`foo.Data`，但不是使用实际模块，而是`bar`希望该实例使用 this 的模拟版本。

**您可以通过从您的测试模块导入来设置它`foo`，然后重新绑定`foo.bar`到您的模块的模拟版本。**

这是一个看起来如何的示例：

*   酒吧.py：

    ```
    def get_data():
        return 'bar' 
    ```

*   foo.py：

    ```
    import bar

    class Data(object):
        def __init__(self):
            self.val = bar.get_data()

    if __name__ == '__main__':
        d = Data()
        print d.val    # prints 'bar' 
    ```

*   测试.py：

    ```
    import foo

    class bar_mock(object):
        @staticmethod
        def get_data():
            return 'test'

    if __name__ == '__main__':
        foo.bar = bar_mock
        d = foo.Data()
        print d.val    # prints 'test' 
    ```

尽管这可以让您完成一个简单的测试用例，但您最好还是研究一个模拟库来为您处理这个问题。

# javascript - 在 Chrome 开发工具中显示 JavaScript 异常消息

> ID：12713745
> 
> 赞同：3
> 
> 时间：2012-10-03T17:29:17.467
> 
> 标签：javascript, google-chrome, google-chrome-devtools

我正在使用 Chrome 开发工具来调试我的 JavaScript。当我告诉 Chrome “不要暂停异常”并加载我的脚本时，我得到了一个清晰的描述，说明了正确的行突出显示出了什么问题：

```
var back_buffer = goog.dom.getElement('back_buffer').getContext('2d');
  --> "Uncaught TypeError: Cannot call method 'getContext' of null" 
```

好的，这是有道理的：我的画布元素的名称中有错字，因此“getElement”返回 null。

现在回到我的问题：当我告诉 Chrome '暂停未捕获的异常'时，它仍然正确地突出显示我脚本中的违规行，但现在漂亮、易懂的错误描述已经消失了！怎么来的？即使在调试模式下，我也希望看到错误消息，因为它非常有用。我四处寻找，但在任何地方都找不到。

有人可以在这里帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-13T18:19:24.997

目前似乎没有很好的方法来做到这一点。这是你能得到的最接近的： ![在此处输入图像描述](../Images/a5d0d2231033f1ef62b9b7d5ccf6e676.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T23:36:59.940

该错误未显示，因为该脚本的执行在它进入异常之前被暂停。

它在错误之前暂停，因此您可以在控制台中调试一些东西。在您谈论的情况下，我倾向于做的事情，并且范围变量没有提供更多信息，是添加一些监视表达式或在控制台中执行一些命令。

例如，在您的 back_buffer 案例中，您可以添加一个像这样的监视表达式，`goog.dom.getElement('back_buffer')`以便您可以看到它解析为什么。如果该表达式导致错误，您将在那里看到错误消息，就像发生脚本错误后一样。

对某些人来说，当脚本执行停止时，执行上下文与脚本暂停时的执行上下文相同，这对某些人来说可能并不完全明显，因此控制台中的所有局部变量都可以通过 console.log() 或console.dir() 或任何东西。

当您将漂亮的打印设置为打开时，在它暂停的那一行上不会发生太多事情，所以大多数情况下您不必搜索很长时间来了解导致错误的原因和原因。

希望对您有所帮助，PM5544。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T07:31:52.107

一旦执行，您应该能够在有问题的源代码行下方的红色气泡消息中看到相同的文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:35:58.353

只需再执行一个“步骤”，就会出现红色气泡。这是合乎逻辑的，因为它在错误/冒泡行为发生之前暂停。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T15:53:22.517

如果您捕获异常并将其发送到日志怎么办：

```
try
  {
       var back_buffer = goog.dom.getElement('back_buffer').getContext('2d');
  }
catch(err)
  {
        console.log(err);
  } 
```

进入控制台后，您可以更详细地检查对象。

# css - Bootstrap 布局下推

> ID：12713749
> 
> 赞同：2
> 
> 时间：2012-10-03T17:29:33.083
> 
> 标签：css, html, twitter-bootstrap, alignment

我在我的最新设计中一直使用 Twitter Bootstrap 2.1。出于某种原因，当我将任何 div 元素添加到页面时，我的所有内容/主体都被推得很深，并且整个页面都添加了额外的空间，这里有一个实时示例和提供的图片： [http:// www.japaneselanguagefriend.com/application/home.php](http://www.japaneselanguagefriend.com/application/home.php)

![布局被下推](../Images/25c606e417ebef89ed2a5857ede50d9e.png)

在我的 bootstrap.min.css 文件中的 CSS 中，我有

```
body{
font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;
font-size:14px;
line-height:20px;
    position:relative;
} 
```

对于 div

```
#apDiv1 {
position:relative;
left:439px;
top:669px;
width:300px;
height:670px;
z-index:1;

} 
```

我试图让一个 div 直接显示在我的主要内容上，如图所示，但间距和更多似乎都以某种方式搞砸了。任何有关该问题的建议或帮助将不胜感激。谢谢！

更新：所以我需要找出在不影响整个布局间距的情况下放置 div 的最佳方法。（感谢 Mr.Alien 建议调整 top:size；以我的 divs 风格） ![在此处输入图像描述](../Images/460c187e32f34828026eab0fe46382c4.png)

我正在寻找使用示例图片中的橙色框将其正确定位的最佳方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:32:32.923

你用`top:669px;`的太少了`top:30px;`

# .net - OpenCover 不向 NUnit 传递参数

> ID：12713750
> 
> 赞同：1
> 
> 时间：2012-10-03T17:29:47.147
> 
> 标签：.net, nunit, opencover

我刚刚从 Nuget 获取了 NUnit、NUnit Runners 和 OpenCover。NUnit 部件在 GUI 和控制台模式下运行良好。但在 PowerShell 中，我似乎无法让 OpenCover 正常工作。按照各种使用示例，我最终得到了这个命令：

```
.\OpenCover.Console.exe -register:user -target:"..\NUnit.Runners.2.6.1\tools\nunit-console.exe" -targetargs:"/noshadow C:\Path\To\Tests.dll" -filter:+[*]* -output:coverage.xml 
```

我从 NUnit 看到了开放的版权信息，但随后 NUnit 告诉我：

> 致命错误：未指定输入

当然，随后是描述标志和诸如此类的标准帮助输出。然后，自然地，OpenCover 也会显示一个错误，表明没有任何内容与过滤器匹配并且没有结果。

所以我尝试直接运行 NUnit：

```
..\NUnit.Runners.2.6.1\tools\nunit-console.exe /noshadow C:\Path\To\Tests.dll 
```

它运行良好。测试通过，一切顺利。考虑到文档和示例可能已经过时，我尝试将其`targetargs`直接组合到调用中：

```
.\OpenCover.Console.exe -register:user -target:"..\NUnit.Runners.2.6.1\tools\nunit-console.exe /noshadow C:\Path\To\Tests.dll" -filter:+[*]* -output:coverage.xml 
```

但是错误输出仍然相同。

我是否在正确使用 OpenCover 时遗漏了什么？如何让它与 NUnit 控制台运行器正确交互？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T12:01:12.170

可能与首先设置当前工作目录有关吗？

我的过滤器参数也用引号引起来，例如`-filter:"+[*]*"`

至少可能值得排除这些......

# java - 布尔值是如何排序的？

> ID：12713759
> 
> 赞同：3
> 
> 时间：2012-10-03T17:30:20.867
> 
> 标签：java, hibernate, sorting, boolean, hibernate-criteria

我正在使用以下代码进行排序：

```
undoneCategories = session.createCriteria(Category.class);
undoneCategories.add(Restrictions.eq("Done", false));
undoneCategories.addOrder(Order.asc("UpwardGenerator"));
undoneCategories.setMaxResults(1); 
```

`UpwardGenerator`在哪里`boolean`。

它将如何排序？与`false`第一？还是`true`先？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-03T17:34:39.817

它将`false`首先排序，因为在数据库中`true`和`false`分别表示为`1`和`0`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T17:37:15.623

默认情况下，`boolean`s 首先排序`false`，然后是`true`。这是因为在二进制中`false`equals`0`和`true`equals `1`。因此，旧的 C 范式`while(1) { }`（顺便说一句，它不能在 Java 中编译）。

# php - 提交 & 数组 php

> ID：12713760
> 
> 赞同：1
> 
> 时间：2012-10-03T17:30:22.107
> 
> 标签：php, arrays, add

我有一个问题。所以，我用两个文本字段（名字、姓氏）和一个提交按钮（如“添加联系人”）构建了我的 PHP 应用程序。我不使用 MySQL。我使用数组。我想要以下内容：当我第一次单击提交按钮时，我应该看到我的联系人的名字和姓氏。第二次单击提交按钮时，我应该再次看到第一个联系人和新联系人。例子：

第一次点击 - 我明白了：John Johnson

第二次点击 - 我明白了：John Johnson（旧联系人）、Peter Peterson（新联系人）

她的是我的代码：

```
 <?php

/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

class Contact {

    private $lastname;
    private $firstname;

    public function getLastname() {
        return $this->lastname;
    }

    public function setLastname($lastname) {
        $this->lastname = $lastname;
    }

    public function getFirstname() {
        return $this->firstname;
    }

    public function setFirstname($firstname) {
        $this->firstname = $firstname;
    }

}

?>

   <?php

/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
class Controller {

    private $arr;

    public static function addContact($person) {
        $this->arr[] = $person;
    }

    public function getArr() {
        return $this->arr;
    }

    public function setArr($arr) {
        $this->arr = $arr;
    }

}
?>

    <!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title></title>
    </head>
    <body>
        <form action="" name="form" method="post">
            <table>
                <tr>
                    <td>First Name:</td>
                    <td><input type="text" name="fname" value=""></td>
                </tr>
                <tr>
                    <td>Last Name:</td>
                    <td><input type="text" name="lname" value=""></td>
                </tr>
                <tr>
                    <td><input type="submit" name="submit" value="Add Person"></td>
                </tr>
            </table>
        </form>

        <?php
        include_once 'Contact.php';
        include_once 'Controller.php';

        $controller = new Controller();

        if (isset($_POST['submit'])) {

            $person = new Contact();
            $person->setFirstname($_POST['fname']);
            $person->setLastname($_POST['lname']);
            $controller->addContact($person);

            print_r($controller->getArr());
        }
        ?>
    </body>
</html> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:32:30.947

您需要启动一个会话并将数组添加到 $_SESSION 数组：

[http://www.thesitewizard.com/php/sessions.shtml](http://www.thesitewizard.com/php/sessions.shtml)

但请注意，只要当前会话存在，数据就会存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:41:14.753

如前所述，您可以将会话用作存储，但它只会持续到会话超时（默认为 30 分钟）。

```
<?php
session_start();
 if (!isset($_SESSION['names']) || $_SERVER['REQUEST_METHOD'] == 'GET')
    $_SESSION['names'] = array();
if (!empty($_POST)) {
  $_SESSION['names'][] = $_POST['name'];
} 
?>

<?php foreach($_SESSION['names'] as $name): ?>
  <?php echo $name ?>
<?php endforeach; ?>
<form method="post">
  <input type="text" name="name" />
  <input type="submit" value="Add" />
</form> 
```

# android - AndEngine：不在 ICS 4.0.3 r2 模拟器上运行

> ID：12713762
> 
> 赞同：1
> 
> 时间：2012-10-03T17:30:29.887
> 
> 标签：android, emulation, opengl-es-2.0, andengine

我正在读[这篇文章](http://android-developers.blogspot.com/2012/04/faster-emulator-with-better-hardware.html)。Google 表示您的 OpenGL ES 2.0 游戏现在可以在模拟器中运行。我得到了 ICS 4.0.3 r2 并创建了一个启用了 gpu 仿真的仿真器，但它再次给出了与“未找到 EGLConfig！”相同的错误。我正在使用 32 位 Windows 7。还有其他事情要做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:47:38.580

抱歉，我仅在[http://moregamedev.blogspot.com/2012/04/4-andengine-gles2-examples-intellij.html的俄语博客中找到了有关此问题的一些信息](http://moregamedev.blogspot.com/2012/04/4-andengine-gles2-examples-intellij.html)

# signalr - 与 SignalR 的私人聊天

> ID：12713769
> 
> 赞同：13
> 
> 时间：2012-10-03T17:31:00.470
> 
> 标签：signalr

我想知道是否可以为 gmail 聊天或 hotmail 等私人对话创建聊天。如何确保只有客户 A 与客户 B 交谈？我如何确保只有登录的客户可以交谈？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T17:34:11.417

当然，每次用户发起与另一个用户（或一组用户）的聊天时，您都可以创建一个唯一的“组”。然后，当您向该组发送消息时，只有这些用户会收到消息。您还可以在向组发送消息之前增加更多安全性，以确保允许发送消息的人向该组发送消息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-05-03T10:10:18.247

试试这个应用程序与 SignalR 进行私人聊天

应用说明： [http ://www.aspbucket.com/2016/03/implement-of-private-one-to-one-chat.html](http://www.aspbucket.com/2016/03/implement-of-private-one-to-one-chat.html)

下载链接 [https://github.com/shivam01990/SignalR-private-one-to-one-chat](https://github.com/shivam01990/SignalR-private-one-to-one-chat)

[![在此处输入图像描述](../Images/5675862a0677dc2b28fcab98302e8bbc.png)](https://i.stack.imgur.com/o5BBI.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-01T07:03:28.690

查看[基本聊天示例](https://github.com/SignalR/Samples/search?utf8=%E2%9C%93&q=chatwithtracking)`ChatWithTracking`，这是IM 设置的一个很好的起点

ps：更新了链接；使用搜索查询以防他们再次更改回购结构

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-30T01:27:09.907

每个连接到集线器的客户端都会传递一个唯一的连接 ID。您可以在集线器上下文的 Context.ConnectionId 属性中检索此值。如果您的应用程序需要将用户映射到连接 ID 并保留该映射，您可以使用以下方法之一：

1.  [内存存储](http://www.asp.net/signalr/overview/hubs-api/mapping-users-to-connections#inmemory)，例如字典
2.  每个用户的[SignalR 组](http://www.asp.net/signalr/overview/hubs-api/mapping-users-to-connections#groups)
3.  [永久的外部存储](http://www.asp.net/signalr/overview/hubs-api/mapping-users-to-connections#database)，例如数据库表或 Windows Azure 表

[http://www.asp.net/signalr/overview/hubs-api/mapping-users-to-connections](http://www.asp.net/signalr/overview/hubs-api/mapping-users-to-connections)

# iphone - 适用于 iphone 4s/5 的 UIImagePickerController 720p 视频

> ID：12713770
> 
> 赞同：0
> 
> 时间：2012-10-03T17:31:02.467
> 
> 标签：iphone, objective-c, ios, video, uiimagepickercontroller

我正在使用 UIImagePickerController 录制视频，我总是希望输出视频为 1280 x 720（足够小以用于其他目的），但在 iphone 4s/iphone 5 中，输出视频将为 1920 x 1280。我找不到合适的配置这有助于我制作 1280 x 720 的视频。

```
 UIImagePickerControllerQualityTypeHigh            = 0,
   UIImagePickerControllerQualityTypeMedium          = 1,  // default value
   UIImagePickerControllerQualityTypeLow             = 2,
   UIImagePickerControllerQualityType640x480         = 3, 
```

iPhone 4s/iPhone 5 的最高分辨率为 1920 x 1280

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-03T17:34:00.087

也许这个线程可以帮助！在问这样的问题之前，你应该使用谷歌。:D

[链接到 stackoverf 上的线程。](https://stackoverflow.com/questions/11751883/how-can-i-reduce-the-file-size-of-a-video-created-with-uiimagepickercontroller)

# git - git工作流程：一次合并和修复冲突

> ID：12713774
> 
> 赞同：0
> 
> 时间：2012-10-03T17:31:29.900
> 
> 标签：git, version-control, workflow, git-merge, merge-conflict-resolution

我们有一个简单的工作流程，包含三个主要分支

`staging`即测试环境

`master`即生产环境

`dev/XXX`其中 XXX 是票号

*   客户登录票据
*   我们创建一个分支，例如`dev/2332`
*   我们工作+提交+推送
*   我们将准备好的工作合并到`staging`
*   客户批准工作`staging`
*   我们将工作合并到`master`生产中并部署票证

问题：

如果多个开发人员在各自的`dev/XXX`分支上工作；当它们合并时`staging`，有时会产生冲突。他们在分期和推送上解决了这些冲突。

问题是当客户批准那些特定的票并且我们将工作合并到`master`时，我们必须再次解决冲突

重要的：

*   我们无法将 staging 合并到 master 中——因为票证未经批准
*   默认情况下，所有分支都是从最新的 master 创建的
*   多个工单正在同时开发，但在批准后部署
*   仅当工作已获得批准+已部署时，才可以从 master 重新定位以避免冲突
*   从暂存中重新定位*不是*一种选择 - 因为未经批准的票证

有关如何解决此问题的任何想法？我们的工作流程有缺陷吗？我们错过了一些 git hack 吗？

基本上，我不希望团队重复同样的事情两次

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T23:54:28.067

查看[每个功能的分支](http://dymitruk.com/blog/2012/02/05/branch-per-feature/)。你应该得到我关于这个主题的帖子。我还在这里回答了一个关于[共享 rerere 缓存的问题](https://stackoverflow.com/questions/12566023/sharing-rerere-cache)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:57:51.080

您需要保持`master`并`staging`尽可能靠近彼此。您可以尝试以 git 本身`pu`分支的方式处理它。也就是说，当一项新任务完成时，将*删除*、重新创建分支，`master`并将所有待批准的功能合并到其中。这样做的好处是分支不会分歧，并且不存在取消合并被拒绝功能的问题。缺点是您无法在此基础上进行任何工作，但无论如何您都不会。

当发生冲突时，您可以调整开发分支以干净地合并并运行“章鱼”合并（与超过 2 个父级合并）`staging`再次创建，或者在尝试暂存依赖项之前等待任何依赖项或冲突功能得到批准.

在任何情况下，特性分支都应该在尝试暂存它们之前重新基于（或合并）最新`master`的。它们在创建时是由 master 制作的，因此将它们重新定位在后来的 master 上就像它们是后来开始的并且开发得更快，这显然不会错。

# php - 重写规则不适用于 IIS 上的 CakePHP

> ID：12713780
> 
> 赞同：1
> 
> 时间：2012-10-03T17:31:43.697
> 
> 标签：php, cakephp, iis

我一直在尝试使用根文件夹中的以下 web.config 设置来获取重写规则以在 CakePHP 的 IIS 上工作：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
          <rules>
            <rule name="Imported Rule 1" stopProcessing="true">
              <match url="^$" ignoreCase="false" />
              <action type="Rewrite" url="app/webroot/" />
            </rule>
            <rule name="Imported Rule 2" stopProcessing="true">
              <match url="(.*)" ignoreCase="false" />
              <action type="Rewrite" url="app/webroot/{R:1}" />
            </rule>
            <rule name="Imported Rule 3" stopProcessing="true">
              <match url="^$" ignoreCase="false" />
              <action type="Rewrite" url="webroot/" />
            </rule>
            <rule name="Imported Rule 4" stopProcessing="true">
              <match url="(.*)" ignoreCase="false" />
              <action type="Rewrite" url="webroot/{R:1}" />
            </rule>
            <rule name="Imported Rule 5" stopProcessing="true">
              <match url="^(.*)$" ignoreCase="false" />
              <conditions>
                <add input="{REQUEST_FILENAME}" matchType="IsDirectory" ignoreCase="false" negate="true" />
                <add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
              </conditions>
              <action type="Rewrite" url="index.php" appendQueryString="true" />
            </rule>
          </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

所有的 CSS、JS 和其他文件都可以正常工作。与在主页中加载一样，但其他页面如`/pages/about`仅显示 404！

编辑： IIS 中设置的屏幕截图：

![在此处输入图像描述](../Images/5a589c766cd856c18d4656fd81580b9c.png)

有什么问题？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-22T12:52:13.783

IIS7 本身不支持 .htaccess 文件。虽然有可以添加此支持的附加组件，但您也可以将 htaccess 规则导入 IIS 以使用 CakePHP 的本机重写。为此，请按照下列步骤操作：

1.使用微软的Web Platform Installer安装URL Rewrite Module 2.0或直接下载（32位/64位）。

2\. 在 CakePHP 根文件夹中创建一个名为 web.config 的新文件。

3.使用记事本或任何 XML 安全编辑器并将以下代码复制到新的 web.config 文件中...

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
            <rules>
            <rule name="Redirect static resources" stopProcessing="true">
            <match url="^(ico|img|css|files|js)(.*)$" />
            <action type="Rewrite" url="app/webroot/{R:1}{R:2}" appendQueryString="false" />
            </rule>
            <rule name="Imported Rule 1" stopProcessing="true">
            <match url="^(.*)$" ignoreCase="false" />
            <conditions logicalGrouping="MatchAll">

                        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
            </conditions>
            <action type="Rewrite" url="index.php?url={R:1}" appendQueryString="true" />
            </rule>
            <rule name="Imported Rule 2" stopProcessing="true">
              <match url="^$" ignoreCase="false" />
              <action type="Rewrite" url="/" />
            </rule>
            <rule name="Imported Rule 3" stopProcessing="true">
              <match url="(.*)" ignoreCase="false" />
              <action type="Rewrite" url="/{R:1}" />
            </rule>
            <rule name="Imported Rule 4" stopProcessing="true">
              <match url="^(.*)$" ignoreCase="false" />
              <conditions logicalGrouping="MatchAll">

                        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
              </conditions>
              <action type="Rewrite" url="index.php?url={R:1}" appendQueryString="true" />
            </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T19:32:08.250

我对 IIS 没有太多经验，但是回到这个问题，我注意到一些明显的问题。IIS 已经导入了所有三个 CakePHP 的 .htaccess，而不考虑它们包含在哪个目录中。

CakePHP 附带了两个额外的 .htaccess 文件，因此用户可以轻松地将安装程序放入 Apache 中，并且无论他们尝试使用什么 URL，他们都应该总是（希望）被重定向到*正确*的.htaccess 文件，并且事情应该“正常工作”（TM ):

```
Document root     Additional .htaccess file     Correct .htaccess file
/ --------------> /.htaccess -----------------> /app/webroot/.htaccess
/app/ ----------> /app/.htaccess -------------> /app/webroot/.htaccess
/app/webroot ---------------------------------> /app/webroot/.htaccess 
```

IIS 导入这些文件的方式，假设您的文档根设置为`/`，则不需要规则 3-4（来自第二个 .htaccess 文件）。但更重要的是，由于`(.*)`规则 2 中的包罗万象的正则表达式（来自第一个 .htaccess 文件），规则 2 之外的任何规则都*不会*执行——这意味着请求永远不会被传递给 index.php。

无论如何，您没有使用 Apache，因此您不能随意扔掉 CakePHP 安装，期望它们正常工作。在任何 Web 服务器（Apache、IIS、Nginx 等）上的生产环境（用于性能和安全性）中使用的正确文档根目录是恰当命名的`/app/webroot`目录。该目录包含 index.php、静态文件和正确的 .htaccess 文件。

之后，您只需要规则 5（来自正确的 .htaccess 文件）。它基本上是这样写的：“匹配所有请求并将它们发送到 index.php，除非有我们可以服务的真实文件或目录”：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
          <rules>
            <rule name="CakePHP" stopProcessing="true">
              <match url="^(.*)$" ignoreCase="false" />
              <conditions>
                <add input="{REQUEST_FILENAME}" matchType="IsDirectory" ignoreCase="false" negate="true" />
                <add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
              </conditions>
              <action type="Rewrite" url="index.php" appendQueryString="true" />
            </rule>
          </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

# ios - iOS 6 MKMapView 偶尔会在 initWithFrame 中崩溃

> ID：12713781
> 
> 赞同：28
> 
> 时间：2012-10-03T17:31:44.457
> 
> 标签：ios, ios6, ios6-maps

我在苹果商店有一个应用程序，在 iOS6 更新后，我收到了数百个崩溃报告`MKMapView`。我无法在我的设备上重现崩溃。看起来有问题`EAGLContext`。`MKMapView`我们的应用程序中没有使用 OpenGL，但我们在不同的控制器中有多个实例。我在这里发现了一个类似的问题，[iOS 6 app 在显示地图时在 EAGLContext 中崩溃，](https://stackoverflow.com/questions/12670528/ios-6-app-crashes-in-eaglcontext-when-displaying-maps)但它们使用 OpenGL。

这里有回溯：

```
Exception Type:  SIGSEGV
Exception Codes: SEGV_ACCERR at 0x1
Crashed Thread:  0

Thread 0 Crashed:
0   libGPUSupportMercury.dylib          0x00000e22 gpus_ReturnNotPermittedKillClient + 10
1   libGPUSupportMercury.dylib          0x3bccc5fb gldCreateContext + 190
2   GLEngine                            0x344c2b15 gliCreateContextWithShared + 676
3   OpenGLES                            0x0000491d -[EAGLContext initWithAPI:properties:] + 1433
4   OpenGLES                            0x000042d7 -[EAGLContext initWithAPI:sharedWithCompute:] + 143
5   VectorKit                           0x00011c81 -[VGLGPU init] + 105
6   VectorKit                           0x000d4659 __24+[VGLGPU sharedInstance]_block_invoke_0 + 49
7   libdispatch.dylib                   0x000014b7 _dispatch_client_callout + 23
8   libdispatch.dylib                   0x000073f7 dispatch_once_f$VARIANT$mp + 43
9   VectorKit                           0x00011c13 +[VGLGPU sharedInstance] + 39
10  VectorKit                           0x00001db1 -[VKMainLoop updateLinkState] + 485
11  VectorKit                           0x00001955 -[VKScreenCanvas _updateDisplayStatus:] + 109
12  UIKit                               0x0001c371 -[UIView initWithFrame:] + 129
13  VectorKit                           0x00010ca5 -[VGLScreenCanvas initWithFrame:context:] + 53
14  VectorKit                           0x00010a7d -[VKScreenCanvas initWithFrame:context:] + 57
15  VectorKit                           0x00010a3f -[VKScreenCanvas initWithFrame:] + 39
16  VectorKit                           0x000106bd -[VKMapCanvas initWithFrame:shouldRasterize:] + 65
17  VectorKit                           0x000104bb -[VKMapView initWithFrame:andGlobe:shouldRasterize:] + 647
18  MapKit                              0x0000dc95 -[MKMapView _commonInitAndEnableLoading:fromIB:] + 725
19  MapKit                              0x0000d811 -[MKMapView initWithFrame:] + 257
..... 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-25T21:30:53.097

当用户在我们的应用程序后台运行时，我们遇到了类似的问题，就像我们弹出一个包含地图子视图的窗口一样。崩溃似乎是由于我们在后台使用 openGL 调用的地图。我们必须将地图子视图的创建包装在一个检查中，如下所示：

```
UIApplicationState appState = [[UIApplication sharedApplication] applicationState];
    if( (appState != UIApplicationStateBackground) && (appState != UIApplicationStateInactive))
    {
        // Do map subview initialization...
    }
    else
    {
        self.attemptedToLoadMap = YES;
    } 
```

我们保存了布尔值，以便如果应用程序回到前台，我们可以添加子视图以进行显示。

每当您以导致重新绘制操作的方式（例如，添加注释）操作地图时，您都必须这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T21:42:32.593

[http://developer.apple.com/library/ios/#qa/qa1766/_index.html](http://developer.apple.com/library/ios/#qa/qa1766/_index.html)

此技术 QA 解决了此问题

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-16T21:00:57.327

我们在我们的应用程序中找到了这个问题的原因，所以我想发布解决方案，以防它对其他人有所帮助。我们的主视图控制器在显示时监视显着的位置变化，并在隐藏时停止监视。我们的一些用户在此屏幕上遇到了不相关的崩溃，这使应用程序处于监控状态。当应用程序注册了重大位置更改更新时，如果应用程序没有运行，iOS 实际上会将应用程序启动到后台以告知新位置。由于我们的应用程序在首次启动时会显示地图，这导致了崩溃。Apple 支持与我们确认，运行 iOS 8.x 的 32 位设备上存在一个错误，如果在应用程序处于后台时更新 MapView（或其他 OpenGL 上下文），可能会导致崩溃。

我们更改了代码，以便如果应用程序由于位置发生重大变化而启动，我们会立即停止监控并引发异常以使应用程序崩溃。这对用户来说是完全不可见的，因此他们不会注意到崩溃，并且可以防止进一步的崩溃发生。

```
- (void)validateLaunchWithOptions:(NSDictionary *)launchOptions
{
    if (launchOptions[@"UIApplicationLaunchOptionsLocationKey"]) {
        // the app was launched due to a significant location change, which is not valid and causes crashes
        // prevent this from happening again by disabling significant location monitoring
        CLLocationManager *locationManager = [[CLLocationManager alloc] init];
        [locationManager stopMonitoringSignificantLocationChanges];

        // intentionally crashing the app here; it is not in a good state and it needs to be prevented from
        // getting to any code that would re-enable significant location monitoring
        @throw [NSException exceptionWithName:@"com.redacted.significantLocationLaunch"
                                       reason:@"app may not be launched due to significant location changes"
                                     userInfo:@{}];
    }
} 
```

我们看到了*数千*次这样的崩溃，但在我们找出原因之前无法在我们的测试设备上复制它。如果您想复制它（并确认修复），请在您的应用开始监控重大位置更改后立即@throw 异常。应用程序崩溃后，去开车。一旦您的手机切换信号塔，iOS 将在后台启动该应用程序，您将遇到崩溃。我们能够拿到我们的一部用户手机并检查崩溃日志。所有的车祸都发生在她上下班的路上。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-08T02:59:01.717

我面临着类似的堆栈跟踪。我注意到在控制台中它提供了有关实际问题的更多详细信息：您不能在后台使用 GPU。iOS 5 的地图是基于图块的，所以我假设没有使用 GPU，但 iOS 6 中的新地图使用矢量图形，因此使用了 GPU。因此，任何曾经在后台的地图作品都不再可以。

# iphone - UITapGestureRecognizer 和 UIButton

> ID：12713783
> 
> 赞同：0
> 
> 时间：2012-10-03T17:31:48.573
> 
> 标签：iphone, uiscrollview, uibutton, ios6, uitapgesturerecognizer

`UITapGestureRecognizer`并且`UIButton`没有一起工作。

`UIButton`没有 . 单独工作正常`UITapGesturerecognizer`。它显示在所有滚动图像视图中，但在添加`UITapGestureReconizer`功能后，点击时不显示`UIButton`。

```
BOOL numberofTaps;
@interface ImageScrollViewController : UIViewController <UIGestureRecognizerDelegate>
@property (nonatomic, assign) UITapGestureRecognizer *recognizer;

- (void)handleTap:(UIGestureRecognizer*)sender;
//////////////////////////
- (void)viewDidLoad {
    self.view.backgroundColor = [UIColor blackColor];
    UIScrollView *imageScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
    imageScrollView.pagingEnabled = YES;
    NSInteger numberOfViews = 61;
    for (int i = 0; i < numberOfViews; i++) {
        CGFloat xOrigin = i * self.view.frame.size.width;
        UIButton *myButton = [UIButton buttonWithType:UIButtonTypeCustom];
        [myButton addTarget:self action:@selector(dismissView:) forControlEvents:UIControlEventTouchUpInside];
        myButton.frame = CGRectMake(xOrigin, 10, 60, 35);
        [myButton.layer setMasksToBounds:YES];
        [myButton.layer setCornerRadius:10.0f];
        myButton.layer.borderWidth = 2;
        myButton.layer.borderColor = [[UIColor whiteColor] CGColor];
        [myButton setTitle:@"Done" forState:UIControlStateNormal];
        myButton.backgroundColor = [UIColor blackColor];
        myButton.hidden = YES;

        NSString *imageName = [NSString stringWithFormat:@"image%d.png", i];
        UIImage *image = [UIImage imageNamed:imageName];
        UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
        imageView.frame = CGRectMake(xOrigin, 0, self.view.frame.size.width, self.view.frame.size.height);

        UITapGestureRecognizer *recognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTap:)];
        recognizer.numberOfTapsRequired = 1;
        [imageView addGestureRecognizer:recognizer];
        imageView.userInteractionEnabled = YES;
        recognizer.delegate = self;
        numberofTaps = 1;
        [recognizer release];

        [imageScrollView addSubview:imageView];
        [imageScrollView addSubview:myButton];
     // [imageScrollView addGestureRecognizer:tap];
     // [imageView addSubview:tap];
        [imageView release];
    }
    imageScrollView.contentSize = CGSizeMake(self.view.frame.size.width * numberOfViews, self.view.frame.size.height);
    [self.view addSubview:imageScrollView];
    [imageScrollView release];
 } 
```

编辑：**这怎么行，但是当我只取消注释 myButton.hidden= NO 时，它可以工作，但仍然没有在图像视图上显示我的按钮 DONE**

```
- (void)handleTap:(UIGestureRecognizer*)sender {

   // if(numberofTaps == 1){
    CGPoint tapPoint = [sender locationInView:_imageScrollView];
    int tapX = (int) tapPoint.x;
    int tapY = (int) tapPoint.y;
    NSLog(@"TAPPED X:%d Y:%d", tapX, tapY);
//_myButton.hidden = NO;
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Hello" message:@"How are you?" delegate:nil cancelButtonTitle:@"I'm awesome." otherButtonTitles:nil];
[alert show];
[alert release];
} 
```

否则它正在工作但没有显示完成 UIButton 的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:51:39.143

首先，您必须找到`button`要展示的内容。因此，为此，您必须`setTag:`先将`UIButton`它们添加到`scrollView`

像这样 -

```
myButton.tag = i; 
```

然后在添加标签`UIImageView`之前添加标签到你的也`scrollView`像这样 -

```
 imageView.tag = i*100; 
```

现在在`handleTap:`方法中，您可以比较标签并获得您必须显示的按钮。

```
-(void)handleTap:(UIGestureRecognizer *)sender 
{
    //getting all buttons of scrollView
    for(UIButton *button in scrollView.subviews)
    {
       //comparing tags
       if(button.tag == sender.view.tag/100)
       {
           button.hidden = NO;
       }
    }
} 
```

这样做，删除你的 if 条件。

# ruby-on-rails - 如何让模型知道它在 Rails 中的控制器？

> ID：12713784
> 
> 赞同：0
> 
> 时间：2012-10-03T17:31:49.247
> 
> 标签：ruby-on-rails, decorator

我正在制作一个 Rails 应用程序，我希望能够使用传递给视图的模型对象来获取对该对象的某些操作的 URL，例如：

```
link_to object.public_send(attribute),
        { :controller => object.controller_path,
          :action     => :show,
          :id         => object.id } 
```

什么是这样做的好方法？可以用像[Draper](https://github.com/jcasimir/draper)这样的装饰器来完成吗？网上有例子吗？

* * *

**更新。** 我考虑过这一点并决定装饰器不是保存控制器信息的好地方。这不是装饰者的责任。装饰器应该只知道使用标记呈现格式化数据。现在我创建了一个模块`Accessor`，我尝试将模型与控制器和路由感知混合在一起。我仍然想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:26:24.897

如果你不介意在你的视图上有另一个实例变量，你可以使用一个非常简单的类来实现它（不需要装饰器）。

```
class MyRouter
  def initialize(controller, object)
    @controller = controller
    @object     = object
  end

  def url_for(action_name)
    controller.url_for(object, :action => action_name)
  end
end 
```

在您的控制器上：

```
class AController
  def edit
    @router = MyRouter.new(self, object)
    render 'shared_view'
  end
end

class BController
  def edit
    @router = MyRouter.new(self, object)
    render 'shared_view'
  end
end 
```

在您的共享视图中：

```
<%= @router.url_for(:show) # Varies with the controller that rendered the view %> 
```

当然，这假设您想要作为目标的控制器与呈现视图的控制器相同，这可能不是真的。不过，使用这种模式，您可以适应更复杂的逻辑以满足您的需求（`Router`例如，具有多个类），而无需更改视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T17:50:33.030

我在Avdi Grimm的[Objects on Rails中找到了一个非常有趣的解决方案：](http://objectsonrails.com/) [Exhibits for REST](http://objectsonrails.com/#ID-2d96b566-da6d-473f-8bfb-b4022caa4416)。简而言之，他的想法是应用多个 Ruby 的`SimpleDelegator`s 作为具有各种功能的装饰器。

# dns - 无法获取 DNSMASQ DHCP 来配置多个名称服务器

> ID：12713785
> 
> 赞同：1
> 
> 时间：2012-10-03T17:31:55.687
> 
> 标签：dns, dhcp, dnsmasq

也许有人有帮助？我在 Ubuntu 12.04 LTS 上运行 dnsmasq。此服务器的地址是 192.168.15.3。我网关的 DNS 是 192.168.1.254，它将我带到 Internet。我在 192.168.15.2 也有一个专用 DNS。所以我想将这 3 个名称服务器提供给 DHCP 客户端。这是我的 dnsmasq.conf server= 部分：

```
server=/localnet/192.168.15.3
server=/localnet/192.168.15.2
server=/15.168.192.in-addr.arpa/192.168.1.254 
```

但是，当我查看客户端上的 DHCP 分配时，我只看到 192.168.15.3 作为唯一的 DNS 服务器。客户端无法访问 Internet（.3 上的 NIC 配置正确，可以通过其控制台登录访问 Internet）。

当然，第一个 server= 行可能不是必需的，但我添加它认为它可能会有所帮助，但没有。

我究竟做错了什么？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-04T13:16:11.980

好的，经过大量实验后，我发现我必须手动推送该选项。在 dnsmasq.conf 文件中，我添加了以下行：

dhcp 选项=6，

像这样：

dhcp 选项=6,192.168.15.3,192.168.15.2,192.168.1.254

这为 DHCP 客户端提供了正确的名称服务器列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-27T22:14:17.613

这些`server`行是 dnsmasq*自己的*DNS 服务器的配置，关于它应该将收到的 DNS 请求转发到哪里*以便*能够解析（和缓存）它们。

**只有**s 是传递给 DHCP 客户端的 DHCP 配置的`dhcp-option`一部分 - 因此，接受的分析器是正确的，但我想分享*原因*。

# java - Java中的tan()返回一个奇怪的值

> ID：12713790
> 
> 赞同：8
> 
> 时间：2012-10-03T17:32:18.870
> 
> 标签：java, math

我的代码将弧度角传递给`cos`,`tan`和`sin`. 一切似乎都很好，除了 tan of ，它出于某种奇怪的原因`90`给出了值。`16331239353195370`示例代码：

```
import java.text.DecimalFormat;

public class mathtable {

  public static void main(String[] args) {

    System.out.println("Angle   Sin Cos Tan");
    System.out.println("-----   --- --- ---");

    for (double angle = 0.0; angle < 180; angle +=5) {
      double angle_rad = Math.toRadians(angle);
      double sin = Math.sin(angle_rad);
      String sin_4 = new DecimalFormat("#.####").format(sin);
      double cos = Math.cos(angle_rad);
      String cos_4 = new DecimalFormat("#.####").format(cos);
      double tan = Math.tan(angle_rad);
      String tan_4 = new DecimalFormat("#.####").format(tan);
      System.out.println(angle + "  " + sin_4 + "   " + cos_4 + "   " + tan_4);
    }
  }
} 
```

为什么返回的值不严格等于 IEEE 无穷大？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-03T17:34:24.390

好吧，`tan(pi/2)`弧度基本上是无限的，不是吗？所以你会期望得到一个非常大的数字，不是吗？（它不是无穷大，因为 pi/2 不能精确地表示为 a `double`。您会在渐近曲线上找到一个非常*接近*它将变为无限的值。）

请参阅[这些 sin/cos/tan 图表](http://www.bbc.co.uk/schools/gcsebitesize/maths/algebra/furthergraphhirev5.shtml)以了解我的意思，记住 pi/2 弧度是 90 度。

# html - 如何防止在这个jsfiddle中向右滚动

> ID：12713794
> 
> 赞同：0
> 
> 时间：2012-10-03T17:32:42.757
> 
> 标签：html, css

我有以下 jsfiddle [http://jsfiddle.net/KfPOQ/](http://jsfiddle.net/KfPOQ/)

使用网络浏览器很好，但是当在 iphone 或 ipad 上的 ebay 应用程序上时，我必须向右滚动才能看到完整页面如何消除这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:40:17.733

您需要使页面内容适合给定媒体类型的视口（或屏幕）尺寸。您可以根据[链接/样式表标签中的媒体类型](http://reference.sitepoint.com/html/style/media)拥有不同的样式表。比如说，对于 iphone，使用`media="handheld"`并尝试将内容保留在周围`600px`，或者在您的移动设备上看起来不错的任何内容。

这是 w3c 的另一个[资源](http://www.w3.org/TR/CSS2/media.html)。

# python - 基于主题的文本和用户相似度

> ID：12713797
> 
> 赞同：3
> 
> 时间：2012-10-03T17:32:57.970
> 
> 标签：python, numpy, recommendation-engine, topic-modeling, gensim

我希望使用他们的主题表示来计算用户和文本文档之间的相似性。即，每个文档和用户都由一个主题向量（例如神经科学、技术等）以及该主题与用户/文档的相关程度来表示。

然后我的目标是计算这些向量之间的相似度，以便我可以找到相似的用户、文章和推荐文章。

我曾尝试使用 Pearson Correlation，但一旦达到约 40k 篇文章并且向量的长度约为 10k，它最终会占用过多的内存和时间。

我正在使用 numpy。

你能想象一个更好的方法来做到这一点吗？还是不可避免（在单台机器上）？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:46:09.750

我建议只使用[gensim](http://radimrehurek.com/gensim/)而不是自己滚动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T21:08:42.997

不太明白为什么你最终会占用太多内存来计算`O(n^2)`一对项目的相关性。正如维基百科文章指出的那样，要计算皮尔逊相关性， ![在此处输入图像描述](../Images/301aed6ecfcb4c11300ac835302e4468.png)

也就是说，要获得`corr(X,Y)`一次只需要两个向量。如果您一次处理一对数据，则内存根本不成问题。

如果您要加载所有向量并进行一些矩阵分解，那就是另一回事了。

对于计算时间，我完全理解，因为您需要比较这`O(n^2)`对项目。

* * *

众所周知，Gensim 能够在合理的时间范围内以适度的内存要求（< 1 Gb）在单个 CPU/台式计算机上运行。查看他们使用 MacBook Pro、Intel Core i7 2.3GHz、16GB DDR3 RAM 在 8.2GB 数据集[上](http://radimrehurek.com/gensim/wiki.html)所做的实验。我认为这是一个比您拥有的更大的数据集。

* * *

如果您有更大的数据集，您可能想尝试分布式版本的 gensim 甚至 map/reduce。

另一种方法是尝试[局部敏感散列](https://stackoverflow.com/questions/12952729/how-to-understand-locality-sensitive-hashing/12967538#12967538)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T12:18:03.180

我的技巧是使用ElasticSearch之类的搜索引擎，效果很好，通过这种方式我们统一了我们所有推荐系统的api。详情如下：

*   通过您的语料库训练主题模型，每个主题是一个单词数组，每个单词都有一个概率，我们将前 6 个最可能的单词作为一个主题的表示。
*   对于语料库中的每个文档，我们可以为其推断出一个主题分布，该分布是每个主题的概率数组。
*   对于每个文档，我们生成一个包含主题分布和主题表示的假文档，例如，假文档的大小约为 1024 个单词。
*   对于每个文档，我们生成一个包含主题分布和主题表示的查询，例如查询的大小约为 128 个单词。

所有准备工作如上完成。当您想获取类似文章或其他文章的列表时，您只需执行搜索即可：

*   获取您的文档的查询，然后通过查询对您的假文档执行搜索。

我们发现这种方式非常方便。

# android - Android 堆叠图片库

> ID：12713798
> 
> 赞同：0
> 
> 时间：2012-10-03T17:32:58.220
> 
> 标签：android, animation, image-gallery, android-gallery, flip

我正在尝试创建一个堆叠的图片库，这是一个所有图片在一个堆栈（或一堆）中相互叠加的画廊，例如：卡片堆，用户将能够看到和触摸上部图像并将其翻转/扔出屏幕（带有翻译动画）。投掷第一张图片后，用户将看到隐藏在第一张图片下方的第二张图片，依此类推。

除了“weheartpics”之外，我在其他应用程序中没有找到类似的画廊（当然适用于 Iphone）

我现在遵循的解决方案是创建一个 FrameLayout，在其上添加一些叠加图片，以在用户触摸它时删除上面的图片（而不是将其扔出屏幕）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:26:13.880

使用`StackView`，适用于 API 级别 11 及更高级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:38:03.907

为什么不使用[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)并从左到右翻阅您的图像？然后，您可以利用[FragmentStatePagerAdapter](http://developer.android.com/reference/android/support/v13/app/FragmentStatePagerAdapter.html)预取和缓存您的图像，因为使用翻转这些

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T17:20:14.990

好的 - 这是另一种方式：

1.  添加带有 2 个 ImageView 的[ViewSwitcher](http://developer.android.com/reference/android/widget/ViewSwitcher.html)
2.  由于您不能使用拖放库[寻找一些替代方案](https://stackoverflow.com/questions/4255859/touch-and-drag-image-in-android)，但通常您希望实现拖动顶部图像。希望这会暴露隐藏的图像，但如果不是，您将不得不在拖动开始时交换图像
3.  实现[手势执行侦听](http://developer.android.com/reference/android/gesture/GestureOverlayView.OnGesturePerformedListener.html)器以侦听顶部图像上的轻弹事件
4.  当图像被弹开时：

    一种。在 ViewSwitcher 中交换图像视图（如果尚未为拖放交换）

    湾。将下一张图片预加载到隐藏的 ImageView 中

5.  否则将顶部图像返回到原始位置（不要将任何内容加载到隐藏的 ImageView 中）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T11:34:38.593

好的，该问题的解决方案是使用 frameLayout 并从代码中添加 imageView 。在图像上应用动画并在动画开始后删除/添加它们很容易。

# process - Python 2.7.3 process.Popen() 失败

> ID：12713801
> 
> 赞同：4
> 
> 时间：2012-10-03T17:33:05.420
> 
> 标签：process, python-2.7, windows-7-x64

我目前在 Windows 7 64 位机器上使用 python 2.7.3（也在 Linux 32 位、Ubuntu 12.04 中开发）并且在让 python 与命令提示符/终端成功通信时遇到了奇怪的困难。我的代码如下所示：

```
import subprocess, logging, platform, ctypes

class someClass (object):

def runTerminalCommand:

    try:
        terminalOrCmdLineCommand = self.toString()

        process = subprocess.Popen(terminalOrCmdLineCommand, shell=True,stdout=subprocess.PIPE,stderr=subprocess.PIPE)
        output = process.stdout.readlines()

        if len(output) < 1:
            logging.exception("{} error : {}".format(self.cmd,process.stderr.readlines()))
            raise ConfigError("cmd issue : {}".format(self.cmd))
        return output

    except ValueError as err:
        raise err
    except Exception as e:
        logging.exception("Unexpected error : " + e.message)
        raise ConfigError("unexpected error") 
```

现在，我知道如果我手动输入 self.toString() 返回的值将正确处理，因此我将其限制为我如何通过子进程将其发送到命令行的问题。我已经阅读了文档，发现 subprocess.check_call() 如果遇到错误不会返回任何内容，所以我正在使用 .Popen()

我得到的例外是，

```
 [date & time] ERROR: Unexpected error :
    Traceback (most recent call last):
      File "C:\[...]"
        raise ConfigError("cmd issue : {}".format(self.cmd))
    "ConfigError: cmd issue : [the list self.cmd printed out]" 
```

我正在尝试做的是运行命令，然后读回输入。但我似乎无法自动执行我想要运行的呼叫。:(

有什么想法吗？（如果我遗漏了任何需要的细节，请告诉我）

非常感谢，提前。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-03T18:30:00.910

[文档说](http://docs.python.org/library/subprocess.html#subprocess.Popen.communicate)：

> 使用communicate() 而不是.stdin.write、.stdout.read 或.stderr.read 以避免由于任何其他OS 管道缓冲区填满并阻塞子进程而导致的死锁。

你可以使用`.communicate()`如下：

```
p = Popen(cmd, stdout=PIPE, stderr=PIPE)
stdout_data, stderr_data = p.communicate()
if p.returncode != 0:
    raise RuntimeError("%r failed, status code %s stdout %r stderr %r" % (
                       cmd, p.returncode, stdout_data, stderr_data))
output_lines = stdout_data.splitlines() # you could also use `keepends=True` 
```

请参阅[在 Python 中获取子进程输出的其他方法](https://stackoverflow.com/a/12606327/4279)。

# python - 如何在python中将数字转换为数字列表？

> ID：12713802
> 
> 赞同：1
> 
> 时间：2012-10-03T17:33:06.740
> 
> 标签：python

> **可能重复：**
> [如何在 Python 中获取用户输入的列表？](https://stackoverflow.com/questions/4663306/how-can-i-get-a-list-as-input-from-the-user-in-python)

我目前有这个：

```
c = eval(input("Enter a group of numbers "))
#say someone types 123
print (c)
#prints out 123 
```

我要这个：

```
c = eval(input("Enter a group of numbers "))
#say they enter 123
print (c)
#prints out [1,2,3] 
```

我想`123`最终成为`[1,2,3]`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T17:34:33.957

```
In [32]: c=raw_input()
123

In [33]: map(int,c)
Out[33]: [1, 2, 3] 
```

如果`split()`输入类似于`1 2 3`：

```
In [37]: c=raw_input()
1 2 3

In [38]: map(int,c.split())
Out[38]: [1, 2, 3] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T17:35:12.710

您可以`int`使用以下方法将数字转换为 s `map()`：

```
>>> map(int, '123')
[1, 2, 3] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-03T17:35:21.737

```
>>> s = '123'
>>> [int(c) for c in s]
[1, 2, 3] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T17:36:14.390

怎么样？：

```
c = [int(x) for x in input("Enter a group of numbers ")]
#list comprehension over the input function 
```

输入 123 结果为 [1, 2, 3]

好的，假设对于 python 2.x（输入返回一个 int 对象）

```
c = [int(x) for x in str(input("Enter a group of numbers "))]
#added an str() function for iterating 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T17:36:25.607

您可以将其转换为字符串，然后将字符串中的每个字符转换为数字。

```
 myStr = str(myInt)
out = [int(i) for i in myStr] 

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-03T17:44:42.240

通常不应在用户输入上使用[eval 。](http://docs.python.org/library/functions.html#eval)有人可以键入一个将评估为恶作剧的语句。

出于同样的原因，您应该避免使用[input()](http://docs.python.org/library/functions.html#input)，因为它等同于`eval(raw_input())`也可能导致恶作剧——有意或无意。

[但是，您可以使用ast.literal_eval](http://docs.python.org/library/ast.html#ast.literal_eval)安全地将用户输入的 Python 解释为 Python 数据结构：

```
>>> import ast
>>> ast.literal_eval(raw_input('Type Python input: '))
Type Python input: 1,2,3
(1, 2, 3)
>>> ast.literal_eval(raw_input('Type Python input: '))
Type Python input: [1,2,3]
[1, 2, 3]
>>> ast.literal_eval(raw_input('Type Python input: '))
Type Python input: 123
123
>>> ast.literal_eval(raw_input('type a number: '))
type a number: 0xab
171 
```

（在每种情况下，后面的第一行`>>> Type Python input:`都是我在`raw_input()`

如果你想分开数字，你可以这样做：

```
>>> [int(c) for c in raw_input() if c in '1234567890']
1234
[1, 2, 3, 4]
>>> [int(c) for c in raw_input() if c in '1234567890']
123a45
[1, 2, 3, 4, 5] 
```

请注意，非数字已被过滤。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-03T17:42:58.750

首先，以下内容：

```
c = eval(input("Enter a group of numbers ")) 
```

是相同的：

```
c = eval(eval(raw_input("Enter a group of numbers "))) 
```

所以你现在调用 eval 两次。更多关于[输入](http://docs.python.org/library/functions.html#input)的信息可以在[这里](http://docs.python.org/library/functions.html#input)找到。

这是您想要的可能的解决方案：

```
c = raw_input("Enter a group of numbers "))
c = [int(i) for i in c]
print(c) 
```

您当然可以将上面的示例减少到两行（实际上甚至是一行）。

# java - 无法使用 Java 和 CXF 连接到服务器上的 war 文件中的 Web 服务

> ID：12713804
> 
> 赞同：0
> 
> 时间：2012-10-03T17:33:27.763
> 
> 标签：java, web-services, tomcat, cxf, myeclipse

我在 myEclipse 10.0 中使用 tomcat 6（嵌入式服务器）以及用于 Web 服务应用程序的 Apache CXF。我的问题是我正在尝试连接到一个服务器，该服务器有一个带有一些服务代码的 war 文件。但是，当我尝试通过代码点击它时，我从 CXF 收到此错误：

> 警告：拦截器已抛出异常，现在正在展开 org.apache.cxf.interceptor.Fault：无法发送消息。

然后这个错误似乎是根本问题：

> 原因：javax.net.ssl.SSLHandshakeException：sun.security.validator.ValidatorException：PKIX 路径构建失败：sun.security.provider.certpath.SunCertPathBuilderException：无法找到请求目标的有效证书路径

我使用 InstallCert.java 访问服务器，它给了我这个：

> 正在加载 KeyStore jssecacerts...打开连接到：443...开始 SSL 握手...
> 
> 没有错误，证书已经被信任

我使用 Porticle 查看 cacerts 文件，果然服务器 sha1 和 md5 信息与服务器上的信息完全匹配。cacerts 文件位于 java/jre6/lib/security 文件夹下，我认为它是在加载时由 tomcat 自动拾取的。

我还创建了一个 .bin 文件夹作为另一个想法，并将其放在 tomcat 的 webapps 目录下，并像这样修改了服务器 xml：

```
<Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
               maxThreads="150" scheme="https" secure="true"
               clientAuth="false" sslProtocol="TLS" 
               keystoreFile="<path on my machine>/webapps/tomcat.bin" keystorePass="changeit" /> 
```

我发现一些文章展示了如何将证书加载到您的密钥库，但这似乎不是问题，即使这是此错误的常见解决方案。是否有我遗漏的东西或者我收到此错误的其他原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:55:29.280

事实证明，myEclipse 有它自己的 jre，运行它自己的默认 cacerts 文件。在我的机器上它位于：C:\MyEclipse\Common\binary\com.sun.java.jdk.win32.x86_1.6.0.013\jre\lib\security。

我使用 ProcessExplorer 查看 javaw.exe 进程，然后执行 Find（控制键 + F 键），它显示了已加载的附加 jre。我将正确的 cacerts 复制到该目录并重新启动了所有内容，并且成功了！

# objective-c - 在 ios6 中将 sendSynchronousRequest 更改为 sendASynchronousRequest？iPhone5 在 3G 连接中崩溃

> ID：12713809
> 
> 赞同：1
> 
> 时间：2012-10-03T17:33:43.550
> 
> 标签：objective-c, asynchronous, ios6, xcode4.5

我一直在调整代码以使我的应用程序在新的 iOS6/iPhone5 上运行。

一切似乎都运行良好，直到用户告诉我该应用程序在通过 3G 连接时挂在他的 iPhone5 的欢迎屏幕上，使用 wifi 一切正常。

他给我发了崩溃日志，我注意到问题与以下代码中的“sendSynchronousRequest”部分有关：

```
- (void)loadCurrentURL {   NSString *appURL = [NSString stringWithFormat:@"%@@%@", app_SERVER_URL, @"auth/app/register"];

NSHTTPURLResponse *response = [[NSHTTPURLResponse alloc] init];
NSError *error;

[NSURLConnection sendSynchronousRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:appURL]] returningResponse:&response error:&error];
if (response.statusCode == 200) {
    self.currentValidURL = app_SERVER_URL;
} else {
    self.currentValidURL = app_APPLE_TEST_URL;
}
} 
```

因此，在对 Apple 的文档和 StackOverFlow 进行了大量研究之后，我将代码更改为：

```
- (void)loadCurrentURL{   NSString *appURL = [NSString stringWithFormat:@"%@@%@", app_SERVER_URL, @"auth/app/register"];

 NSOperationQueue *queue = [[[NSOperationQueue alloc] init] autorelease];

 [NSURLConnection sendAsynchronousRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:appURL]]
 queue:queue
 completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
 {
 NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;
 if ([httpResponse statusCode] == 200) {
 self.currentValidURL = app_SERVER_URL;
 } else {
 self.currentValidURL = app_APPLE_TEST_URL;
 }
 }];
} 
```

现在的问题是它挂在我的 iPhone4 设备和 iOS5,6 模拟器中。

我不是专家开发人员，我正在学习，所以我想知道是否有人对此有答案。任何帮助将不胜感激:)

非常感谢你。

（我知道在 stackOverFlow 上还有其他类似的问题，但似乎没有一个可以解决这个问题。）

# css - 外部 CSS 文件不像为 UL 嵌入的那样工作？

> ID：12713812
> 
> 赞同：1
> 
> 时间：2012-10-03T17:33:46.547
> 
> 标签：css

我还是想不通。我设法将图像用作无序列表的项目符号，并且仅当 css 代码位于我拥有 UL 的 html 文件中时它才有效（我是否将 ID 附加到列表或类都无关紧要）。这是我的片段：

```
<head>

   <link rel="stylesheet" href="fis_css/subtitles.css" type="text/css" name="stil_b">

    <style type="text/css">

      .lista{
             list-style-image:url("buttons/pic.gif");
             background-repeat:no-repeat;
             }

    </style>

    </head>

<body>

<div id="lista_meniu">
   <ul class="lista">
      <li><a href="#c1">Perioadele critice de dezvoltare al creierului la copii </a></li> 
      <hr>
      <li><a href="#c2">Dezvoltarea vizual&#259; &#351;i auditiv&#259; </a></li>
      <hr>    
      <li><a href="#c3">Dezvoltarea limbajului verbal </a></li> 
      <hr>   
      <li><a href="#c4">Dezvoltarea fizic&#259; &#351;i motorie </a></li> 
      <hr>   
      <li><a href="#c5">Dezvoltarea emo&#355;ional&#259; &#351;i social&#259; </a></li>
   </ul>
</div>

.................................... 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:36:19.597

这是因为为图像指定的相对 URL 是相对于外部 CSS 位置的，而不是相对于您的文档的

> 部分 URL 被解释为相对于样式表的来源，而不是相对于文档

[http://www.w3.org/TR/REC-CSS1/#url](http://www.w3.org/TR/REC-CSS1/#url)

指定图像的绝对 URL `li`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T17:36:33.597

当相对于 html 文件而不是 css 时，您用于图像的路径是正确的。

Assuming your image folder and css folder are on the same level, you may need to add `../` to the beginning of the image url.

So the url you use is right when you use it inside the html page, but as your css is in a lower directory, it will not be able to find the same image using the same relative url.

# diacritics - Visual Studio 2008 不显示 CZ 变音符号

> ID：12713813
> 
> 赞同：1
> 
> 时间：2012-10-03T17:33:48.917
> 
> 标签：diacritics

我在 Visual Studio 2008 中的程序有问题。

在诸如 STRING 等资源中定义的文本中，不显示字母 (ř, č, ě)。对话框中定义的文本很好。问题出在 Visual Studio 2008（也许）:( 相比之下，2006 版本不是问题。

你能帮我解决这个问题吗？谢谢 ：）

# javascript - History.js 无法回到空状态

> ID：12713815
> 
> 赞同：0
> 
> 时间：2012-10-03T17:33:49.907
> 
> 标签：javascript, history.js

我正在开发一个画廊查看器，我使用 History.js 来获得一个不错的链接。这是流程：

[http://foo.com/gallery/show/](http://foo.com/gallery/show/)显示主画廊

[http://foo.com/gallery/show/photo1](http://foo.com/gallery/show/photo1)向查看者展示照片

所以我使用 History.pushState({}, "photo1") 从 show/ 到 show/photo1

我的问题是，当我关闭查看器时，我希望 url 返回显示/所以我尝试了：History.pushState({}, "") 但这不起作用它只是停留在 show/photo1。

顺便说一句，我真的不想使用 History.go(-X) 在那个用例中对我来说似乎不合逻辑。

我怎样才能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T00:24:51.120

HTML：

```
<html>
<head>
</head>
<body>
    <a class='img' href="img1">Image 1</a>
    <a class='img' href="img2">Image 2</a>
    <div class="image-viewer" style="display:none"><p></p>
    <a class="close" href="">Close</a>
    </div>
</body>
</html>
​ 
```

JS：

```
$(function() {
var begin=location.href;
$(".img").on('click', function(e) {
    console.log(location.href);
    var href = $(this).attr("href")
    History.pushState({"state": href, "rand": Math.random()}, "", href);
        console.log(location.href);
     e.preventDefault();
});

History.Adapter.bind(window, 'statechange', function() {
    $(".image-viewer p").html(History.getState());
    $(".image-viewer").show();
});

$(".close").click( function(e) {
    e.preventDefault();
    console.log($(this).parent());
    $(this).parent().fadeOut(1);
    History.pushState({"state": begin, "rand": Math.random()}, "", begin);
});
​}) 
```

[http://jsfiddle.net/rAxAw/2/](http://jsfiddle.net/rAxAw/2/)

如果需要进一步的帮助，请随时询问任何 qn

# sql - 动态 tsql 变量数据类型导致查询返回错误结果

> ID：12713816
> 
> 赞同：0
> 
> 时间：2012-10-03T17:33:49.853
> 
> 标签：sql, sql-server-2008, tsql

我正在使用 Sql Server 2008

假设您有一个名为“Weights”的表，并且在该表中您有一个名为“Weight”的列，其数据类型定义为“真实”，并包含以下数据。

权重（真实数据类型）

2 2.001 2.002 2.003 2.004 2.005 2.006 2.007 2.008 2.009 3

这是我在新查询窗口中针对表运行的查询

```
declare @sql nvarchar(MAX)
declare @params nvarchar(MAX)
declare @interval float = .001
declare @conversion float = 1/@interval         

set @sql =
N'select FLOOR(Weight * @INPUTconversion)*@INPUTinterval as [Weight],
COUNT(1) as ''Count''
FROM dbo.Weights
GROUP BY FLOOR(Weight*@INPUTconversion)*@INPUTinterval
order by FLOOR(Weight*@INPUTconversion)*@INPUTinterval'

set @params =
N'
@INPUTconversion real,
@INPUTinterval float'

exec sp_executesql @sql, @params,  
@INPUTconversion = @conversion,
@INPUTinterval = @interval 
```

这是似乎错误的结果。

重量计数

2 2 2.002 1 2.003 1 2.004 1 2.005 1 2.006 1 2.007 2 2.009 1 3 1

如何使用相同的查询使返回看起来像这样？我需要更改我的变量数据类型吗？

重量计数

2 1 2.001 1 2.002 1 2.003 1 2.004 1 2.005 1 2.006 1 2.007 1 2.008 1 2.009 1 3 1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:41:38.303

这显然是数据中数字表示的问题。您所看到的 2.001 必须真正存储为 2.00099999999999 。. . 对于一些“9”。

我认为您最好的解决方案是将数据类型更改为 DECIMAL(12, 6) 之类的类型，您所见即所得。

或者，您可以通过向值添加一个非常小的增量来做一些模糊数学：

```
select FLOOR(Weight * @INPUTconversion + 0.0000001)*@INPUTinterval as [Weight] 
```

这会将真正接近 2.001 的权重视为 2.001，而不仅仅是少一点。

# sql - SQL Server 存储过程中的意外递归调用

> ID：12713820
> 
> 赞同：1
> 
> 时间：2012-10-03T17:34:02.710
> 
> 标签：sql, sql-server, sql-server-2008, ssms

我有一个表，如果不存在特定键，我必须在其中插入数据。我决定编写一个存储过程来插入数据。我想做的是：

1.  创建一个存储过程。
2.  使用存储过程插入一堆行。
3.  删除存储过程。

我想在一个脚本文件中完成所有这些操作，这样就没有人知道存储过程的存在。

这是我所拥有的：

**创造**

```
CREATE PROCEDURE My_Proc(@key varchar(10))
  AS
  BEGIN
  IF NOT EXISTS (SELECT * FROM [dbo].[My_Table] WHERE [key] = @key)
    INSERT INTO [dbo].[My_Table] (key, created, modified)
    VALUES (@key, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
  END 
```

**插入**

```
EXECUTE My_Proc 99241
GO
EXECUTE My_Proc 99242
GO
EXECUTE My_Proc 99243
GO 
```

**降低**

```
DROP PROCEDURE My_Proc 
```

现在我在 SQL Server Management Studio 中右键单击我的数据库，单击`New Query`并粘贴上面的查询。我得到以下输出：

```
(1 row(s) affected)

(1 row(s) affected)
Msg 217, Level 16, State 1, Procedure My_Proc, Line 9
Maximum stored procedure, function, trigger, or view nesting level exceeded (limit 32).

(1 row(s) affected)
Msg 217, Level 16, State 1, Procedure My_Proc, Line 9
Maximum stored procedure, function, trigger, or view nesting level exceeded (limit 32). 
```

我无法弄清楚导致错误的原因。此外，当我突出显示`EXECUTE`SSMS 上的特定命令时`EXECUTE My_Proc 99241`，数据会被插入而不会出现任何错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T17:57:41.390

在创建过程之后您需要一个 GO。我相信由于缺少 GO，第一个“EXECUTE My_Proc 99241”被包含在过程中，所以基本上你有一个递归调用。

Create Procedure 语句（以及函数和类似语句）将所有内容带到批处理的末尾，这就是为什么它们必须后跟“GO”或文件末尾的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:50:17.317

如果您有一个键列表，其中一些可能在表中，请尝试以下操作：

```
insert into my_tableC(key, created, modified)
    select key, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP
    from <list of keys query> k
    where k.key not in (select key from my_table) 
```

如果您有列表，但不在表格中，则可以将其创建为：

```
with toinsert as (
    select <keyval1> as key union all
    select <keyval2> union all
    select <keyval3> . . .
    select <keyvaln>
)
insert into my_tableC(key, created, modified)
    select key, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP
    from toinsert k
    where k.key not in (select key from my_table) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:35:38.017

您要插入的表上是否有触发器？因为您要插入的表似乎存在某种循环。正在中断的函数/过程的名称不是您创建的过程的名称。注意错误信息：

```
（1 行受影响）

（1 行受影响）
消息 217，级别 16，状态 1，过程 InsertProfessionalComponentLookupForCpt，第 9 行
超出最大存储过程、函数、触发器或视图嵌套级别（限制 32）。

（1 行受影响）
消息 217，级别 16，状态 1，过程 InsertProfessionalComponentLookupForCpt，第 9 行
超出最大存储过程、函数、触发器或视图嵌套级别（限制 32）。

```

确保没有任何触发器或计算列在此表上做一些额外的工作。

# php - MySQL或PHP动态将行变成列

> ID：12713824
> 
> 赞同：1
> 
> 时间：2012-10-03T17:34:09.420
> 
> 标签：php, mysql, pivot

好的，我有一个如下所示的销售表：

```
产品 ID | Store_ID | 日期_售出 | Num_Sold

105 | 1010 | 2012-09-21 | 50
105 | 1011 | 2012-09-22 | 20
105 | 1012 | 2012-09-22 | 35
..................................................
109 | 1010 | 2012-09-21 | 25
109 | 1011 | 2012-09-23 | 15
109 | 1012 | 2012-09-23 | 30
```

我想创建一个如下所示的新表或视图：

```
Store_ID | 105 | ... | 109

1010 | 50 | ... | 25
1011 | 20 | ... | 15
1012 | 35 | ... | 30
```

我不确定如何做到这一点。我已经看到人们在哪里硬编码，但我不想这样做，因为我有超过 50 个不同的 Prod_ID，而且它们在不断变化。有没有办法动态地做到这一点？我将通过 PHP 在网页上显示这些数据，所以也许有更简单的方法来使用 PHP？如果这个解释不清楚，请告诉我。

提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:40:49.077

在 MySQL 中，您需要对数据使用准备[好的语句](http://buysql.com/mysql/14-how-to-automate-pivot-tables.html)`PIVOT`。由于 MySQL 没有`PIVOT`函数，因此您需要使用聚合函数和`CASE`：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'sum(case when Prod_ID = ''',
      Prod_ID,
      ''' then Num_Sold end) AS ''',
      Prod_ID, ''''
    )
  ) INTO @sql
FROM  yourtable;

SET @sql = CONCAT('SELECT store_id, ', @sql, ' 
                  FROM yourtable 
                   GROUP BY store_id');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/31e1a/8)

如果您有已知数量的列，那么您将硬编码类似于以下的值：

```
select store_id,
  sum(case when prod_id = 105 then Num_Sold end) as '105',
  sum(case when prod_id = 109 then Num_Sold end) as '109'
from yourtable
group by store_id 
```

见[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/31e1a/7)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:52:25.513

所以上面的视图是 MySQL 中的输出。PHP 允许您根据需要布置数据，并将解决您的问题。您将在表中创建一个重复行（html 用于布局，php 用于重复），然后在该表中放置通过 PHP 调用的 MySQL 语句的输出。

有大量代码用于设置 MySQL 连接 (PHP)，当然还有布置表格 (HTML)。

# javascript - 上传到 URL 时 JavaScript 不工作

> ID：12713828
> 
> 赞同：0
> 
> 时间：2012-10-03T17:34:21.040
> 
> 标签：javascript, html, upload, ftp

我在浏览器中的计算机上获得了一个 java 脚本幻灯片放映，但是当我将文件上传到我的 ftp 站点时，图像变得堆叠而不是旋转进出框架。

我的示例页面链接：

[http://www.thaigerkitchen.com/menus.html](http://www.thaigerkitchen.com/menus.html)

如果您需要脚本，请告诉我。

我的文件位于正确的文件夹中，我认为我的代码是正确的。

你能帮我吗？

我是否需要在 ftp 站点上使用一些特殊的东西才能使我的 JavaScript 工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T17:36:01.043

您的 html 引用 slideShow.js 但服务器上的文件名是 slideshow.js - 它在本地工作，因为 Windows 文件系统不区分大小写。

将您的代码更改为全部小写的 slideshow.js 或将服务器上的文件名修复为混合大小写的 slideShow.js，只要它们匹配就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:36:19.027

你的脚本：

```
<script src="slideShow.js"></script> 
```

没有加载。

检查您是否已将其上传到站点的根目录。另外，请检查大小写是否正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:37:27.343

当我检查网站时，它说它无法加载 slideShow.js 你确定你上传了 js 文件吗？还是名称不正确？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T17:39:22.490

将您的代码改为：

```
<script src="slideshow.js"></script> 
```

所有文件名都区分大小写。

# google-maps - “Directions Web Service”IP 的 2,500 个请求限制是否基于？

> ID：12713831
> 
> 赞同：6
> 
> 时间：2012-10-03T17:34:28.747
> 
> 标签：google-maps

我正在开发一个使用“Directions Web Service”的应用程序。文件指出，API 的免费版本限制为每天 2,500 个请求。（请参阅[http://maps.google.com/help/maps/getmaps/compare.html](http://maps.google.com/help/maps/getmaps/compare.html)）。

在我们的应用程序中，这个请求是在客户端浏览器上用 javascript 发出的，它不是由我们的服务器完成的。所以我想知道这个限制是每个用户的IP地址还是以某种方式传递我的应用程序URL/IP并以此为基础进行限制。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T18:07:33.643

使用[Google Maps API v3 中的 Google Maps API v3 路线服务，](https://developers.google.com/maps/documentation/javascript/directions)请求限制和配额适用于每个客户端（IP 地址）。

使用[Directions Web 服务](https://developers.google.com/maps/documentation/directions/)，请求限制和配额适用于服务器（适用于其 IP 地址）。

我承认您提供的链接并不能很清楚地说明他们在谈论哪一个。

# amazon-ec2 - 在一个 AWS EC2 实例上运行多个环境 (Elastic Beanstalk)

> ID：12713834
> 
> 赞同：26
> 
> 时间：2012-10-03T17:34:40.113
> 
> 标签：amazon-ec2, amazon-elastic-beanstalk

我对 Amazon AWS 服务非常陌生。我想知道是否有办法运行 EC2 实例（例如，Amazon Linux AMI），然后将两个环境连接到该实例。

特别是，我想在单个 EC2 实例上运行 PHP 和 Tomcat 环境。

问题是，每次我在 Elastic Beanstalk 中创建一个新环境时，似乎也创建了一个新的 EC2 实例。我在这里错过了什么吗？

我将不胜感激任何提示。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-05T07:31:30.463

AWS Elastic Beanstalk 旨在以一种专为从头开始的可扩展性而设计的方式部署您正在运行的应用程序。因此，Elastic Beanstalk 将启动一个或多个 EC2 实例，将它们连接到 Elastic Load Balancer 实例，配置 CloudWatch 监控和 Auto Scaling 触发器。

此外，由于其基本的可扩展性设计，Elastic Beanstalk 是围绕每个环境一个应用程序模型设计的（“环境”是指这些 EC2 + ELB + CloudWatch + AutoScaling 集群之一）。

由于使用两个独立的应用程序（PHP 和 Java）运行两个独立的 Web 服务器*并不是*一个从根本上可扩展的设计，因此它不是 Elastic Beanstalk 优化的用例。

您可以随意启动独立 EC2 实例并在其上安装任何您想要的东西，但您是对的 -`git aws.push`独立 EC2 实例尚未提供支持。如果 git 支持对您很重要，您需要权衡每种方法的优缺点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T21:35:59.597

我也希望能够做到这一点，基本上是从演示等成本的角度来看。

例如，具有一个 PHP 应用程序和一个 Java 应用程序的单个实例。或者，具有两个 Java 应用程序的单个实例。

但是，从我目前在 Elastic Beanstalk 开发人员指南中阅读的内容来看，我没有发现任何明确说明每个环境支持多个应用程序的内容（或者甚至每个 EC2 实例支持多个环境 - 如果这有意义的话）。

这让我想知道这是否是未来经常要求和计划的功能，或者是否出于某种原因“按环境设计单个应用程序”模型。

# azure - 使用 Windows Azure 云项目进行调试时未找到 WCF RIA 服务域服务

> ID：12713841
> 
> 赞同：0
> 
> 时间：2012-10-03T17:35:14.683
> 
> 标签：azure, visual-studio-2012, wcf-ria-services

我正在尝试使用在具有 IIS 8 Express 的 Windows 8 PC 上运行 Windows Azure SDK 1.7 的 Visual Studio 2012 在本地调试 Windows Azure 云项目。云项目包括一个运行 ASP.NET MVC 3.0 Web 项目的 Web 角色，该 Web 项目包括 WCF RIA 服务，而 WCF RIA 服务又链接到该网站上托管的 Silverlight 项目。当我直接运行该网站并且不尝试调试 Azure 云项目时，我可以访问该网站，并且可以毫无问题地访问 Silverlight 应用程序和 RIA 服务。但是，如果我调试 Azure Cloud 项目，模拟器会启动并且网站会出现。然后我可以访问 Silverlight 应用程序，但是当它尝试向 WCF RIA 服务域服务发出请求时，我从 IIS 服务器收到一个错误，指出域服务不可用。

我已经通过各种搜索来尝试解决问题，并且我使用 Fiddler 来确保网络请求没有任何问题。我无法确定任何问题。我还尝试打开 WCF 跟踪以查看是否出现任何错误，但是当我通过 Azure Cloud 项目进行调试时，甚至没有更新跟踪文件。

在反复出现这种行为后，我尝试完全重新安装 Visual Studio 2012 和 Azure 1.7 SDK，但我仍然得到相同的行为。由于 WCF 跟踪没有为我提供任何其他信息，是否有人对问题可能是什么或我如何尝试追踪问题有建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:07:24.577

奇怪的。你能试试[这个示例项目](https://skydrive.live.com/redir?resid=1BCE1D5766DF232B!3311&authkey=!AMYu537-QcYNqTg)吗，它是使用 IIS8 Express、.NET 4.0、MVC3 托管域服务和使用该域服务的 Silverlight 在 W8 上使用 VS2012 快速创建的。一切正常。

如果该项目在您的环境中运行良好 - 那么它可能是您的 web.config/global.asax 文件的一些错误配置。如果该项目在您的环境中也失败 - 那么它可能与环境非常混乱。

# image-processing - 无法让 AVFoundation 使用 AVCaptureSessionPresetPhoto 分辨率

> ID：12713844
> 
> 赞同：0
> 
> 时间：2012-10-03T17:35:26.580
> 
> 标签：image-processing, opencv, uiimage, avfoundation, avcapturesession

我似乎无法让像素对齐与 AVCaptureSessionPresetPhoto 分辨率中的 AVFoundation 一起使用。像素对齐适用于较低的分辨率，如 AVCaptureSessionPreset1280x720 (AVCaptureSessionPreset1280x720_Picture)。![AVCaptureSessionPreset1280x720_picture](../Images/6ad7e54ae043653e6fbae68b3a49448e.png)![AVCaptureSessionPresetPhoto_picture](../Images/97277c8897c04472e3e9ced94fe269fa.png)

具体来说，当我取消注释这些行时： if ([captureSession canSetSessionPreset:AVCaptureSessionPresetPhoto]) { [captureSession setSessionPreset:AVCaptureSessionPresetPhoto];
} else { NSLog(@"无法将分辨率设置为 AVCaptureSessionPresetPhoto"); 我得到一个错过的对齐图像，如下面的第二张图片所示。非常感谢任何意见/建议。

这是我设置 1) 捕获会话、2) 委托回调和 3) 保存一个蒸汽图像以验证像素对齐的代码。
1.捕获会话设置

```
 - (void)InitCaptureSession {
captureSession = [[AVCaptureSession alloc] init];
if ([captureSession canSetSessionPreset:AVCaptureSessionPreset1280x720]) {
    [captureSession setSessionPreset:AVCaptureSessionPreset1280x720];        
} else {
    NSLog(@"Unable to set resolution to AVCaptureSessionPreset1280x720");
}

//    if ([captureSession canSetSessionPreset:AVCaptureSessionPresetPhoto]) {
//        [captureSession setSessionPreset:AVCaptureSessionPresetPhoto];        
//    } else {
//        NSLog(@"Unable to set resolution to AVCaptureSessionPresetPhoto");
//    }

captureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
videoInput = [AVCaptureDeviceInput deviceInputWithDevice:captureDevice error:nil];

AVCaptureVideoDataOutput *captureOutput = [[AVCaptureVideoDataOutput alloc] init];
captureOutput.alwaysDiscardsLateVideoFrames = YES; 

dispatch_queue_t queue;
queue = dispatch_queue_create("cameraQueue", NULL);
[captureOutput setSampleBufferDelegate:self queue:queue];
dispatch_release(queue);
NSString* key = (NSString*)kCVPixelBufferPixelFormatTypeKey; 
    NSNumber* value = [NSNumber     numberWithUnsignedInt:kCVPixelFormatType_420YpCbCr8BiPlanarFullRange];
NSDictionary* videoSettings = [NSDictionary dictionaryWithObject:value forKey:key];     
[captureOutput setVideoSettings:videoSettings]; 

[captureSession addInput:videoInput];
[captureSession addOutput:captureOutput];
    [captureOutput release];

    previewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:self.captureSession];
[previewLayer setVideoGravity:AVLayerVideoGravityResizeAspectFill];

    CALayer *rootLayer = [previewView layer];// self.view.layer; //

[rootLayer setMasksToBounds:YES];
[previewLayer setFrame:[rootLayer bounds]];
[rootLayer addSublayer:previewLayer];
[captureSession startRunning];  
}

- (void)captureOutput:(AVCaptureOutput *)captureOutput 
didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer 
   fromConnection:(AVCaptureConnection *)connection 
{ 

NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
static int processedImage = 0;
processedImage++;
if (processedImage==100) {
    [self SaveImage:sampleBuffer]; 
}

[pool drain];
} 

// Create a UIImage CMSampleBufferRef and save for verifying pixel alignment
- (void) SaveImage:(CMSampleBufferRef) sampleBuffer 
{
CVImageBufferRef imageBuffer = CMSampleBufferGetImageBuffer(sampleBuffer); 
CVPixelBufferLockBaseAddress(imageBuffer, 0); 
CvSize imageSize;
imageSize.width = CVPixelBufferGetWidth(imageBuffer); ;
imageSize.height = CVPixelBufferGetHeight(imageBuffer); 
IplImage *image = cvCreateImage(imageSize, IPL_DEPTH_8U, 1);     
void *y_channel = CVPixelBufferGetBaseAddressOfPlane(imageBuffer, 0); 
char *tempPointer = image->imageData;
memcpy(tempPointer, y_channel, image->imageSize);
CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceGray();
NSData *data = [NSData dataWithBytes:image->imageData length:image->imageSize];
CGDataProviderRef provider = CGDataProviderCreateWithCFData((CFDataRef)data);
CGImageRef imageRef = CGImageCreate(image->width, image->height,
                                    8, 8, image->width,
                                    colorSpace, kCGImageAlphaNone|kCGBitmapByteOrderDefault,
                                    provider, NULL, false, kCGRenderingIntentDefault);
UIImage *Saveimage = [UIImage imageWithCGImage:imageRef];
CGImageRelease(imageRef);
CGDataProviderRelease(provider);
CGColorSpaceRelease(colorSpace);
UIImageWriteToSavedPhotosAlbum(Saveimage, nil, nil, nil);
CVPixelBufferUnlockBaseAddress(imageBuffer,0);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T10:08:16.883

在 内， is`SaveImage`的第 5 个参数并且您不应该传递，因为在内存对齐的情况下每行的字节数可能会有所不同。where （带有 iPhone 4 摄像头）就是这种情况，而第一个平面 (Y) 的每行字节数是 16 字节对齐的。`CGImageCreate``bytesPerRow``image->width``AVCaptureSessionPresetPhoto``width = 852``864`

1/ 你应该得到每行的字节数如下：

```
size_t bpr = CVPixelBufferGetBytesPerRowOfPlane(imageBuffer, 0); 
```

2 /然后在将像素复制到您的时注意考虑每行的字节数`IplImage`：

```
char *y_channel = (char *) CVPixelBufferGetBaseAddressOfPlane(imageBuffer, 0);

// row by row copy
for (int i = 0; i < image->height; i++)
  memcpy(tempPointer + i*image->widthStep, y_channel + i*bpr, image->width); 
```

您可以保持`[NSData dataWithBytes:image->imageData length:image->imageSize];`原样，因为`image->imageSize`考虑到对齐 ( `imageSize = height*widthStep`)。

3/ 最后将`IplImage`宽度步长作为`CGImageCreate`第 5 个参数传递：

```
CGImageCreate(image->width, image->height, 8, 8, image->widthStep, ...); 
```

# doctrine - symfony setDefault 不保存值

> ID：12713847
> 
> 赞同：0
> 
> 时间：2012-10-03T17:35:37.500
> 
> 标签：doctrine, symfony-1.4, setdefault

我在动作中定义了一个表单，并将其传递给模板。保存时无法设置默认值。你能告诉我我做错了什么吗？

在模块\问题\操作中：

```
 public function executeNew(sfWebRequest $request)
  {
    $this->form = new questionForm();

    if ($this->getRequest()->getMethod() == sfRequest::POST)
    {
      // create question
      $user = $this->getUser()->getGuardUser()->getId();

      $question = new Question();
      $question->setQuestionTitle($this->getRequestParameter('question_title'));
      $question->setQuestionBody($this->getRequestParameter('question_body'));
      $question->setUserId($user);
      $question->save();

      $question->addTagsForUser($this->getRequestParameter('tag'), $user);

      return $this->redirect('question/index');
    }

    //set current user as default
    $this->form->setDefault('user_id',$this->getUser()->getGuardUser()->getId());
  } 
```

在 \modules\question\templates 中：

```
<?php echo $form->renderFormTag('question/new') ?>
  <table>
    <?php echo $form['question_title']->renderRow(array('size' => 40), 'Question title:') ?>
    <?php echo $form['question_body']->renderRow(array('cols' => 40, 'rows' => 10), 'Description:') ?>

    <?php echo input_auto_complete_tag('tag', '', '@tag_autocomplete', 'autocomplete=off', 'use_style=true') ?>
    <tr>
      <td colspan="2">
        <input type="submit" value="ask it" />
      </td>
    </tr>
  </table>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:52:25.257

两个选项之一：

1.  将 setDefault 代码放在 QuestionForm 类中

或者

1.  在实例化表单对象之后立即放置 setDefault 代码

常见的做法是选项 #1，因为它会导致表单配置和操作之间的松散耦合。

# java - 在 Java web Start 下调用 getResourceasStream() 时代码卡住

> ID：12713848
> 
> 赞同：0
> 
> 时间：2012-10-03T17:35:37.607
> 
> 标签：java, eclipse, jakarta-ee

我的代码在 Eclipse 中运行良好，但是当我尝试使用 Java web start 运行相同的代码时，它会自动终止并且无法调用`getResourceAsStream()`方法。

这是代码

```
 public ImageIcon loadImageIcon ( String name ) throws IOException, FileNotFoundException {

      logger.info("entering resource loader class in loadimage icond method");
      logger.info("object is "+this);
      logger.info("class is "+this.getClass());
      logger.info("class loader is "+this.getClass().getClassLoader()+" object trying to load is "+name);
      InputStream in = this.getClass().getResourceAsStream( name ) ;
      logger.debug("loadimageicon:  loading image inside resource loader "+this.getClass().getResource(name).getPath());
      ImageIcon   returnImage = null ;
     if ( in != null ) {
         returnImage = new ImageIcon ( InputStreamLoader.load ( in ) ) ;
         in.close() ;
      } else
         throw new FileNotFoundException ( name ) ;
      return( returnImage ) ;
   } 
```

这是日志

```
[2012-10-03 13:15:03,015] [Thread-21] INFO  com.test.nzna.shared.util.ResourceLoader  - object is com.ibm.nzna.shared.util.ResourceLoader@1b7f958
[2012-10-03 13:15:03,015] [Thread-21] INFO  com.test.nzna.shared.util.ResourceLoader  - class is class com.ibm.nzna.shared.util.ResourceLoader
[2012-10-03 13:15:03,015] [Thread-21] INFO  com.test.nzna.shared.util.ResourceLoader  - class loader is com.sun.jnlp.JNLPClassLoader@1bf68a9 object trying to load is Default\logon.gif 
```

我重复代码在 Eclipse 中运行得非常好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:12:34.447

好吧，我找到了问题的答案，我将“ `File.separator`”作为图像文件的名称传递，导致它找不到资源，所以我将其更改为“ `/`”，它在 eclipse 和 java 中再次开始正常工作网络开始

# serial-port - 是否可以像 fiddler 或 wireshark 这样的串口监听通信？

> ID：12713849
> 
> 赞同：3
> 
> 时间：2012-10-03T17:35:45.500
> 
> 标签：serial-port

我有一个非常旧的程序可以与我的计算机的 COM1 端口通信。porgram 将命令发送到 PBX 盒子并从盒子接收答案。现在我不得不为我们需要的新功能重新编写程序（因为它太旧了，不能满足我们的需要）。但问题是我们没有数据表或其他关于如何与盒子通信的东西。所以我决定在 COM1 端口上监听通信，但如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:41:02.770

其实用一点硬件应该很容易做到，只需轻按串口线即可。

[http://www.stratusengineering.com/EZTap.html](http://www.stratusengineering.com/EZTap.html)

[http://www.lammertbies.nl/comm/cable/RS-232-spy-monitor.html](http://www.lammertbies.nl/comm/cable/RS-232-spy-monitor.html)

我想你正在寻找更多类似的东西：

[http://technet.microsoft.com/en-us/sysinternals/bb896644.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896644.aspx)

但我不知道你在哪个平台上，所以很难推荐。而硬件水龙头将在任何平台上工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T08:00:29.157

高级串行端口监视器 -> 间谍模式。 [http://www.aggsoft.com/serial-port-monitor.htm](http://www.aggsoft.com/serial-port-monitor.htm)

# cocoa - 窗口顶部的自定义控制栏

> ID：12713852
> 
> 赞同：0
> 
> 时间：2012-10-03T17:36:09.257
> 
> 标签：cocoa, user-interface

我想创建一个控制栏，如果这就是它的名称，其图标类似于屏幕截图右侧显示的图标。这是 Sparrow 的屏幕截图，如您所见，“控制栏”的右上角有图标（按钮）。

![在此处输入图像描述](../Images/d9d9230ca8d89657bdb9d560ef550d5c.png)

我在 Sparrow、Coda、Reeder 和 Ecoute 中看到过这个，但我在研究它时遇到了麻烦，因为我不知道那个酒吧的实际名称是什么，而且我是 Cocoa 的新手。

如何创建这种类型的 UI？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:45:53.020

这些应用程序中的大多数都是使用`INAppStoreWindow`类制作的。

在 Github 上查看：
[https ://github.com/indragiek/INAppStoreWindow](https://github.com/indragiek/INAppStoreWindow)

把功劳归功于伟大的开发者；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T18:00:46.643

该栏称为标题栏。另外，这是我想要的很好的[教程。](http://www.behindtechlines.com/2012/05/25/cocoa-add-a-search-bar-and-other-controls-to-titlebar/)

# ios - 无法在 iOS 6 上为 Facebook 3.1 SDK/本机帐户提供“不允许”权限处理

> ID：12713853
> 
> 赞同：3
> 
> 时间：2012-10-03T17:36:10.580
> 
> 标签：ios, facebook, ios6, facebook-ios-sdk

我正在开发一个应用程序，它既在 iOS 5 上进行基于应用程序切换的登录，又在 iOS 6 下进行本机登录。不幸的是，如果用户不允许访问本机帐户，则返回的错误是通用的“登录错误。对于 iOS 5，我们通常不会处理此错误，因为用户通常会自己点击“取消”，并且我们不需要显示任何额外的 UI。但如果用户已经告诉 iOS 6 拒绝我们的应用程序访问令牌，这意味着我们只是悄悄地失败了。

有没有办法我们可以判断登录失败是由于 iOS 的隐私设置造成的，并且我们可以提供适当的反馈？我在这里看到了一些示例，但它们不提供 iOS 6/iOS 5 特定的行为。我也可以根据 iOS 的版本进行分支，但我只是想看看是否有更官方的方式来区分 iOS SDK。

# c# - 扩展方法获取“方法没有重载”错误

> ID：12713857
> 
> 赞同：0
> 
> 时间：2012-10-03T17:36:21.053
> 
> 标签：c#, asp.net, extension-methods, concurrentdictionary

我最近刚刚将这个项目从 ASP.Net 3.5 升级到 4.0，这样我就可以使用 concurrentDictionary 而不是 Dictionary 因为线程安全特性。

为了使用它，我使用帮助论坛中的代码创建了一个扩展。

这一切都非常接近工作，我不知道如何修改扩展以使其正常工作。

这是代码：

```
var catalogs = (from _catalog in entities.catalogs
                        from rolePermission in entities.c_roleperm
                        from _group in entities.c_group
                        from _user in entities.c_user
                        where _group.id == rolePermission.groupID
                            && rolePermission.roleID == user.roleID
                            && _catalog.groupID == rolePermission.groupID
                            && _user.id == _catalog.userID
                        select new { name = _catalog.name, groupID = _catalog.groupID, userName = _user.name, userID = _catalog.userID, groupName = _group.name, ID = _catalog.id }
                );

var listItems = catalogs.ToList(p => new CatalogItem() { name = p.name, groupID = p.groupID, userID = p.userID, username = p.userName, groupName = p.groupName, ID = p.ID }).GroupBy(p => p.groupName).ToConcurrentDictionary(p => p.Key, p => p.ToList()); 
```

以及扩展中的代码：

```
public static class Extentions
{
    public static ConcurrentDictionary<TKey, TValue> ToConcurrentDictionary<TKey, TValue>(
          this IEnumerable<KeyValuePair<TKey, TValue>> source)
    {
        return new ConcurrentDictionary<TKey, TValue>(source);
    }
    public static ConcurrentDictionary<TKey, TValue> ToConcurrentDictionary<TKey, TValue>(
           this IEnumerable<TValue> source, Func<TValue, TKey> keySelector)
    {
        return new ConcurrentDictionary<TKey, TValue>(
            from v in source
            select new KeyValuePair<TKey, TValue>(keySelector(v), v));
    } 
```

这是我收到的错误：

**错误 1 ​​方法“ToConcurrentDictionary”没有重载需要 2 个参数**

在这种情况下，我需要修改什么扩展才能工作？非常感谢任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:47:48.893

您没有允许您从项目中提取值的重载：

```
public static ConcurrentDictionary<TKey, TValue> ToConcurrentDictionary<T, TKey, TValue>(this IEnumerable<T> source, Func<T, TKey> keySelector, Func<T, TValue> valueSelector)
{
    var pairs = source.Select(i => new KeyValuePair<TKey, TValue>(keySelector(i), valueSelector(i)));
    return new ConcurrentDictionary<TKey, TValue>(pairs);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-31T20:17:21.177

不需要中间转换`KeyValue`成对的变体，并且与 Linq 的`ToDictionary`.

```
public static class ConcurrentDictionaryExtensions
{
    public static ConcurrentDictionary<TKey, TElement> ToConcurrentDictionary<TKey, TSource, TElement>(
        this IEnumerable<TSource> source,
        Func<TSource, TKey> keySelector,
        Func<TSource, TElement> elementSelector)
    {
        return ToConcurrentDictionary(source, keySelector, elementSelector, EqualityComparer<TKey>.Default);
    }

    public static ConcurrentDictionary<TKey, TElement> ToConcurrentDictionary<TKey, TSource, TElement>(
        this IEnumerable<TSource> source,
        Func<TSource, TKey> keySelector,
        Func<TSource, TElement> elementSelector,
        IEqualityComparer<TKey> keyComparer)
    {
        if (source == null)
            throw new ArgumentNullException("source");
        if (keySelector == null)
            throw new ArgumentNullException("keySelector");
        if (elementSelector == null)
            throw new ArgumentNullException("elementSelector");

        ConcurrentDictionary<TKey, TElement> dest = new ConcurrentDictionary<TKey, TElement>(keyComparer);
        foreach (TSource entry in source)
        {
            var key = keySelector(entry);
            var element = elementSelector(entry);
            dest.AddOrUpdate(key, element, (k, e) => element);
        }
        return dest;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:54:35.540

Func 关键字实际上更像是一个返回值的函数。您可能正在查看“表达式”以传递此类内容。接近这个的东西：

```
public static ConcurrentDictionary<TKey, TValue> ToConcurrentDictionary<TKey, TValue>  (
    this IEnumerable<TValue> source, Expression<Func<T, bool>> keySelector)     
{         
return new ConcurrentDictionary<TKey, TValue>(
         from v in source
         select new KeyValuePair<TKey, TValue>(keySelector(v), v));     
} 
```

没有代码保证，但我建议阅读[THIS POST](https://stackoverflow.com/questions/1299534/linq-passing-lambda-expression-as-parameter-to-be-executed-and-returned-by-meth)和MSDN中的[Expression Class](http://msdn.microsoft.com/en-us/library/bb335710.aspx)

# ruby-on-rails - 我使用哪些 ActiveRecord 回调来确保捕获所有插入、更新和删除？

> ID：12713860
> 
> 赞同：1
> 
> 时间：2012-10-03T17:36:27.483
> 
> 标签：ruby-on-rails, activerecord, callback

我有一个 Rails 2.3.12 应用程序需要更新 Rails 3.2.8 应用程序。他们的数据库位于同一台机器上。

留给 2.3.12 应用程序的时间不多了，所以我没有选择一个强大的消息传递解决方案，而是选择了更轻量级的东西来进行更新。2.3.12 应用程序是一个产品目录，我只需要更新那些与它们相关联的一些更改的产品或它们的下级 has_many 模型。

我认为最好的方法是在`after_save`和`before_destroy`回调挂钩上附加一些代码。我将有第三个表来跟踪相关的产品 ID，然后 3.2.8 应用程序上的后台进程将不断循环通过该表以查找更新。

我是否用这两个回调覆盖了足够的基础，还是我需要捕捉其他东西来处理对特定模型的所有插入、更新和删除？

另外，如果有更好的方法，我很想听听。我考虑过使用观察者，但我不知道这些是否在 2.3.12 中可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:10:46.960

AR Observer 确实在 2.3.8 及更高版本中可用。我写了一个观察者，把它附加到我关心的模型上，并将细节写到一个表中。效果很好！

# java - 如何将直接访问的资源打包成jar文件

> ID：12713861
> 
> 赞同：3
> 
> 时间：2012-10-03T17:36:27.133
> 
> 标签：java, jar, resources, runnable, slick2d

我最近在 Slick2D 中开发了一个游戏，我直接访问了我的所有图像，例如

```
Image i = new Image("address.png"); 
```

而不是使用将加载资源的类或使用输入流。

我想知道是否仍然可以将所有资源加载到 jar 中，我将`/res`文件夹添加到我的 buildpath 并使用 jarsplice 添加我的库和本机但是 jar 将无法运行，因为它找不到图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:41:34.280

```
Image i = new Image("address.png"); 
```

正在查看您的应用程序正在运行的根文件系统。如果您想使用打包在 jarfile 中的资源，您必须执行以下操作：

```
Image i = new Image(getClass().getResource("/res/address.png").toURI()); // In case your Image object accepts URI as parameters 
```

**编辑**

```
Image i = new Image(getClass().getResource("/res/address.png").toExternalForm()); // Since your object only accept Strings 
```

# jquery - Jquery 时间前仅以天为单位

> ID：12713867
> 
> 赞同：1
> 
> 时间：2012-10-03T17:36:43.470
> 
> 标签：jquery, setting, days, timeago

我希望 jquery timeago 只显示几天前的 timeago ！我的意思是当经过 30 天时，它会显示 31、32、32 天而不是 1 个月。谢谢你的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:06:41.380

一种解决方案是修改插件以获得您描述的行为。考虑**jquery.timeago.js**的第 83 行：

```
days < 30 && substitute($l.days, Math.round(days)) || 
```

例如，如果您更改`30`为`40`，如下所示：

```
days < 40 && substitute($l.days, Math.round(days)) || 
```

直到 39 天前，该插件仍会显示“x 天前”。

如果您想完全禁用大于“天”的单位，您可以在 的分配中取出该部分`words`，如下所示：

```
var words = seconds < 45 && substitute($l.seconds, Math.round(seconds)) ||
            seconds < 90 && substitute($l.minute, 1) ||
            minutes < 45 && substitute($l.minutes, Math.round(minutes)) ||
            minutes < 90 && substitute($l.hour, 1) ||
            hours < 24 && substitute($l.hours, Math.round(hours)) ||
            hours < 42 && substitute($l.day, 1) ||
            substitute($l.days, Math.round(days)); 
```

# php - Zend框架如何使用带有动态添加元素的表单的视图脚本装饰器？

> ID：12713868
> 
> 赞同：0
> 
> 时间：2012-10-03T17:36:45.863
> 
> 标签：php, zend-framework, frameworks, decorator

Zend 框架如何使用带有动态添加元素的表单的视图脚本装饰器？有没有办法做到这一点？

# ruby - 如何对 mongoid belongs_to 关联进行正则表达式查询？

> ID：12713870
> 
> 赞同：0
> 
> 时间：2012-10-03T17:36:57.283
> 
> 标签：ruby, mongodb, mongoid

我正在使用 mongoid 2.4.10，我正在尝试通过friend.name 对friend_notifications 进行正则表达式查询，它总是返回nil。即使是 'user.name' => 'username' 的非正则表达式查询也返回 nil。是否可以使用 mongoid 甚至 mongo ruby​​ 驱动程序来做我正在寻找的事情？

```
class FriendNotifications
  include Mongoid::Document
  belongs_to :user
  belongs_to :friend, class_name: User.to_s
end  

class User
  include Mongoid::Document
  field :name
end      

@friend_notifications = current_user.friend_alerts.where('friend.name' => /userna/i).first 
```

# sql - 如何在 SQL Server 2005 中读取 xml？

> ID：12713871
> 
> 赞同：2
> 
> 时间：2012-10-03T17:36:58.817
> 
> 标签：sql, xml, sql-server-2005, xml-parsing

我有这个查询

```
WITH XMLNAMESPACES (DEFAULT 'http://www.w3.org/2005/Atom') 
select 
cast(idsku as int) idsku,
cast(entregado as int) entregado from #final1 final FOR XML AUTO, ROOT ('clientesxml'), ELEMENTS 
```

这个回报

```
<clientesxml xmlns="http://www.w3.org/2005/Atom">
  <final>
    <idsku>191</idsku>
    <entregado>159</entregado>
  </final>
</clientesxml> 
```

我的问题是如何创建一个存储过程来读取返回的 XML 并将其转换为`#tempTable`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:17:21.357

以下是一些在创建 proc 时可能会派上用场的类似方法：

```
-- Declare some xml
declare @xml xml = '<clientesxml xmlns="http://www.w3.org/2005/Atom">
  <final>
    <idsku>191</idsku>
    <entregado>159</entregado>
  </final>
</clientesxml>'

-- Shred the xml
;with xmlnamespaces (default 'http://www.w3.org/2005/Atom') 
select x.Record.value('idsku[1]', 'int') as idsku
    , x.Record.value('entregado[1]', 'int') as entregado
from @xml.nodes('//clientesxml/final') as x (Record)

-- Shred and insert the xml into a new temp table
;with xmlnamespaces (default 'http://www.w3.org/2005/Atom') 
select x.Record.value('idsku[1]', 'int') as idsku
    , x.Record.value('entregado[1]', 'int') as entregado
into #tempTable
from @xml.nodes('//clientesxml/final') as x (Record)

-- Shred and insert the xml into an existing temp table
;with xmlnamespaces (default 'http://www.w3.org/2005/Atom') 
insert into #tempTable (idsku, entregado)
select x.Record.value('idsku[1]', 'int') as idsku
    , x.Record.value('entregado[1]', 'int') as entregado
from @xml.nodes('//clientesxml/final') as x (Record) 
```

# java - Spring 3.1 如何将所有异常发送到一页？

> ID：12713873
> 
> 赞同：4
> 
> 时间：2012-10-03T17:37:10.317
> 
> 标签：java, spring, exception-handling, error-handling

我有以下

web.xml

```
<error-page>
    <error-code>500</error-code>
    <location>/WEB-INF/views/errorPages/500.jsp</location>
</error-page>

<error-page>
    <exception-type>java.lang.Exception</exception-type>
    <location>/WEB-INF/views/errorPages/error.jsp</location>
</error-page>

<error-page>
    <exception-type>java.lang.Throwable</exception-type>
    <location>/WEB-INF/views/errorPages/500.jsp</location>
</error-page> 
```

弹簧上下文.xml

```
<bean class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">
    <property name="exceptionMappings">
    <props>
        <prop key="java.lang.Exception">error</prop>
    </props>
    </property>
</bean>

<bean id="exceptionResolver"
    class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">

    <property name="exceptionMappings">
        <props>
            <prop key="com.company.server.exception.GenericException">GenericExceptionPage</prop>
            <prop key="java.lang.Exception">error</prop>
        </props>
    </property>

    <property name="defaultErrorView" value="defaulterror"></property>
</bean>

<bean id="viewResolver"
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix">
        <value>/WEB-INF/views/</value>
    </property>
    <property name="suffix">
        <value>.jsp</value>
    </property>
</bean> 
```

通用异常.java

```
public class GenericException extends RuntimeException
{
  private static final long serialVersionUID = 1L;

  private String customMsg;
  public String message;

  public String getCustomMsg()
  {
    return customMsg;
  }

  public void setCustomMsg(String customMsg)
  {
    this.customMsg = customMsg;
  }

  public GenericException(String customMsg)
  {
    this.customMsg = customMsg;
  }

  @Override
  public String getMessage()
  {
    return message;
  }

} 
```

myController.java

```
@Controller
@RequestMapping(value = "/admin/store")
public class AdminController
{

 //bunch of restful drivin requestMappings

} 
```

**问题：如何获取所有内部服务器错误和异常以将异常/错误消息显示到单个页面？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-03T17:42:04.507

我会考虑[`@ExceptionHandler`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/bind/annotation/ExceptionHandler.html)在我的控制器中的方法上使用注释。`Exception`这个注解标记了一个方法，当一个冒泡通过控制器时，Spring 将调用该方法。

这样，当您的一个`@RequestMapping`方法抛出一个`Exception`时，该方法将被调用并可以返回您想要的任何错误消息。

```
public class BaseController {
    @ExceptionHandler(Throwable.class)
    public String handleException(Throwable t) {
        return "redirect:/errorPages/500.jsp";
    }

    @ExceptionHandler(Exception.class)
    public String handleException(Throwable t) {
        return "redirect:/errorPages/error.jsp";
    }
}

@Controller
@RequestMapping(value = "/admin/store")
public class AdminController extends BaseController
{
    @RequestMapping(...)
    //Some method

    @RequestMapping(...)
    //Another method
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-05T02:07:31.300

如果您想处理来自*所有*控制器的异常，您真的应该扩展[SimpleMappingExceptionResolver](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/web/servlet/handler/SimpleMappingExceptionResolver.html)或[AbstractHandlerExceptionResolver](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/web/servlet/handler/AbstractHandlerExceptionResolver.html)并在容器中配置它，如此处[所述](https://stackoverflow.com/a/7405515/760179)。

这将防止您（或其他在代码中工作的人）必须将所有控制器子类化，并在一个地方处理异常。

使用注释和超类将起作用，但注释似乎更多地针对每个控制器的使用。

此外，这两个建议都只适用于控制器方法抛出的异常。

如果您担心 .jsp 文件中的异常，那么[这篇文章](https://stackoverflow.com/a/220865/760179)应该提供一个补充解决方案。

以上都不是 web.xml 错误页面配置的替代品，因为它们的范围不同。对于讨论[，这篇文章](https://stackoverflow.com/questions/6182771/how-to-properly-handle-exceptions-in-a-jsp-servlet-app)似乎是一个很好的起点。

# multithreading - linux上线程多的进程会比一个线程的进程有更多的cpu时间吗？

> ID：12713880
> 
> 赞同：5
> 
> 时间：2012-10-03T17:37:39.807
> 
> 标签：multithreading, linux-kernel, scheduler

Linux 上拥有更多线程的进程是否会比拥有一个线程的进程拥有更多的 CPU 时间？

在 Linux 中，进程和线程由 task 结构描述，[调度是基于 tasks 的](https://stackoverflow.com/questions/8463741/how-linux-handles-threads-and-process-scheduling)。我还发现[了这个](http://oreilly.com/catalog/linuxkernel/chapter/ch10.html)：

> 创建新进程时`do_fork()`，按以下方式设置当前（父）和 p（子）进程的计数器字段：
> 
> ```
> current->counter >>= 1;
> p->counter = current->counter; 
> ```
> 
> 换句话说，留给父母的滴答数被分成两半，一份给父母，一份给孩子。这样做是为了防止用户通过使用以下方法获得无限量的 CPU 时间：父进程创建一个运行相同代码的子进程，然后杀死自己；通过适当调整创建速率，子进程将始终在其父进程的量程到期之前获得一个新的量程。这个编程技巧不起作用，因为内核不奖励分叉。类似地，用户不能通过在 shell 中启动大量后台进程或在图形桌面上打开大量窗口来占用处理器的不公平份额。更一般地说，一个进程不能通过分叉多个后代来占用资源（除非它有权给自己一个实时策略）。

实际上我在内核源代码中没有找到，但也许是我的错，也许我看到了错误的内核版本。

但是以后会发生什么，每个线程会像一个单独的进程一样参与调度吗？一个有十个线程的进程会比一个有一个线程的进程获得十倍的滴答声吗？从这个意义上说，IO 呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-03T19:24:29.973

是的，具有更多线程的进程将获得比其竞争对手更多的 CPU 时间。一个众所周知的案例是 maven 编译，maven 使用大量 CPU 密集型线程，占用系统。

但是，当前的 linux 调度程序不仅考虑了任务，还考虑了 cpu cgroup 层次结构中的控制组。因此，CPU时间在控制组之间分配，然后在每个控制组中，CPU时间在任务之间分配。

从 2.6.38 开始，Linux 会根据会话 id 自动将任务放入不同的 cpu cgroup。这意味着例如： konsole/gnome-terminal 中的单独选项卡有自己的控制组。所以现在你的 maven 编译很好地隔离了，不再占用系统。请参阅[kernelnewbies](http://kernelnewbies.org/Linux_2_6_38#head-59575a6aeafa38490226a560ee02de89829a5b20)和[lwn.net](https://lwn.net/Articles/418884/)上的描述。

[在 2.6.38 击中大多数系统之前，Lennart Poettering 在此 LKML 消息](https://lwn.net/Articles/415753/)中展示了如何在 shell 脚本上手动执行此操作。

实际上，我有一个运行 Eclipse 和 maven 编译的系统，从 pre-2.6.38 到 pre-2.6.38 + Lennart 的 cgroup 绑定（我在我`/etc/bashrc` **的**Eclipse 启动器脚本上放置）的变化非常完美。Maven 不再占用系统（如果不是 CPU 负载监视器，你不会知道有一个 Maven 编译正在进行），Eclipse 现在只是占用自己，而不是系统的其余部分（我会满足于Eclipse）。现在我只需要将内核更新为具有更好的脏页写回功能的内核，该系统将变得轻而易举。

# jquery - 为什么下拉菜单隐藏在jQuery按钮后面？

> ID：12713882
> 
> 赞同：3
> 
> 时间：2012-10-03T17:37:57.877
> 
> 标签：jquery, asp.net, css, jquery-ui, menu

为什么菜单下拉隐藏在jQuery按钮后面？

![在此处输入图像描述](../Images/0a76a2cefe3f335c2d7c3b9dbf6a573c.png)

```
div.menu ul li a, div.menu ul li a:visited
{
    background-color: #465c71;
    border: 1px #4e667d solid;
    color: #dde4ec;
    display: block;
    line-height: 1.35em;
    padding: 4px 20px;
    text-decoration: none;
    white-space: nowrap;
    position: relative;
    z-index: 9999;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T02:15:09.357

我也遇到了这个问题。我找到了原因和解决方案。

**原因：**该按钮在菜单之后呈现，但它已被一些附加元素包裹`jquery-ui`，因此它`z-index`已增加。

**解决方案：**为了克服这个问题，我们可以增加`z-index`菜单（比减少`z-index`很多按钮更好的方法）。但请记住

> “`z-index`仅适用于**定位**元素（`position:absolute`、、`position:relative`或`position:fixed`）”

所以我们也需要定位我们的菜单。这是我的代码：

```
<div style="position:relative;z-index:99"> MENU HERE </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:40:36.693

也试试这个

```
div.menu 
{

   z-index : 9999;
} 
```

好像您只是将活动的 li 设置为 z-index .. 不活动的会发生什么

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-20T16:35:47.963

我有一个 jquery 组合框插件，如果父 div 不够大，它不会显示完整的下拉列表。经过大量研究并弄乱了 z-index 和其他东西，我发现我需要将父 div 溢出更改为“可见”。如果您遇到同样的问题，也许这会对某人有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T17:42:41.673

您可能想要检查您的列表的 z-index 是否高于您的按钮，如下所示

```
div.menu ul li {
 z-index:999;
}

.yourbutton {
 z-index: 1;
} 
```

但是粘贴您的html代码供我们查看。

# c# - 内存流替换？

> ID：12713886
> 
> 赞同：5
> 
> 时间：2012-10-03T17:38:17.517
> 
> 标签：c#, .net, memorystream

几周前，我读到了一些关于 .Net 4/4.5 中的一个新类的内容，它的性能比[MemoryStream](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx)好，但我似乎再也找不到它了。

我查看了[IO 命名空间](http://msdn.microsoft.com/en-us/library/system.io.aspx)，但找不到任何东西。有人记得读过类似的东西吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T17:40:33.697

也许您阅读过 Memory Tributary，这是一个 CodePlex 项目，它提供了更适合大量内存的 MemoryStream 替代品

> MemoryTributary 是 MemoryStream 的替代品，它使用多个内存段来存储流的内容，而不是 MemoryStream 的单字节数组。它被设计为完全替代，能够处理 MemoryStream 无法处理的大型数据集。

[http://memorytributary.codeplex.com/](http://memorytributary.codeplex.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-19T21:13:08.987

不是 OP 正在寻找的答案，但它可能对像我这样搜索 MemoryStream 替代品的人有用： [Bing 团队发布的 RecyclableMemoryStream](http://www.philosophicalgeek.com/2015/02/06/announcing-microsoft-io-recycablememorystream/)，这实际上是更好`MemoryStream`的替代品。

# actionscript-3 - 数据绑定到数组集合不起作用

> ID：12713887
> 
> 赞同：0
> 
> 时间：2012-10-03T17:38:21.503
> 
> 标签：actionscript-3, apache-flex

我正在尝试根据我拥有的这个可绑定数组集合中是否存在特定字符串来使 CheckBox 元素可见，但它似乎不起作用。如果有人能指出我做错了什么，我将不胜感激。

在我的动作脚本代码中，我有

```
[Bindable]private var dataTypesUsed:ArrayCollection = new ArrayCollection(); 
```

在我的弹性代码中，我有

```
<s:CheckBox selected="true" label="test" id="testBox" visible="{dataTypesUsed.contains('Target')}" includeInLayout="{dataTypesUsed.contains('Target')}"/> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T19:58:03.787

问题是`contains()`方法`ArrayCollection`不是[Bindable]。在 MXML 花括号表达式中，属性链中的所有内容都必须是 [Bindable]。

通常，当花括号表达式中的属性之一不是 [Bindable] 时，Flex 编译器会警告您。当其中一个属性是函数时，不会生成警告，按照我的设计，我认为它可能是一个有用的快捷方式。

函数可以标记为[Bindable]。只要在定义函数的类中的某个位置，就会调度“绑定”事件。查看源代码`ListCollectionView`——这是实际定义`contains()`方法的类。

您会看到该`contains()`方法未标记为 [Bindable]，相比之下，该`getItemAt()`方法是。

您可以通过几种不同的方式解决您的问题。这是一个调度自定义绑定事件的事件：

```
[Bindable("dataTypesUsedChanged")]
private var dataTypesUsed:ArrayCollection = new ArrayCollection();

private function someMethodThatUpdatesTheCollection():void
{
    dataTypesUsed.addItem("foo");
    // addItem will make the collection dispatch CollectionEvent.COLLECTION_CHANGE
    dispatchEvent(new Event("dataTypesUsedChanged")

}

<s:CheckBox visible={dataTypesUsed.contains('foo')} /> 
```

不同之处在于，当您未在 [Bindable] 元数据中指定事件名称时，Flex 使用默认的“propertyChanged”事件。

在您的场景中，没有任何事情调度“propertyChange”事件来触发绑定（b/c 属性实际上没有改变）。此外，集合调度的“collectionChange”事件未被使用，因为该`contains()`方法未标记为 [Bindable]。

# iphone - 启用的推送通知证书现在显示“可配置”

> ID：12713889
> 
> 赞同：1
> 
> 时间：2012-10-03T17:38:35.097
> 
> 标签：iphone, ios, push-notification

我注意到最近在注册通知时，新的设备令牌没有发送到我的服务器。请注意，推送通知仍在发送到我拥有设备令牌的设备，我只是似乎没有收到新的/更新的令牌。

当我转到供应门户中的“应用程序 ID”时，我的应用程序 ID 在生产中的推送通知显示“可配置”。但是，当单击“配置”时，生产推送 SSL 证书显示“已启用”，并且直到 2013 年 4 月才过期。

我使用“codesign”实用程序查看了一些最近提交到 App Store 的档案，我发现旧的将 aps-environment 设置为“生产”，而新的则没有 aps-environment 权利。

谁能想到为什么配置文件中会缺少证书？即使旧证书尚未过期，我是否应该生成新的推送 SSL 证书？

任何帮助表示赞赏！

# css - CSS - 相对于内容的页眉/页脚背景

> ID：12713900
> 
> 赞同：0
> 
> 时间：2012-10-03T17:39:09.897
> 
> 标签：css, background, header, footer

我正在尝试对页眉和页脚具有不同背景的网站进行布局。所以这基本上是我的做法：

```
body{
    background: url(images/header.png) top center no-repeat,
            url(images/footer2.png) bottom center no-repeat,
                url(images/bg.jpg) fixed;
    background-size: contain, contain, auto;
} 
```

我之所以选择这样做是因为当我为页眉和页脚（而不是正文）应用背景时，背景无法覆盖屏幕的宽度。但是有一个错误：当我放大或缩小时，只有内容的大小发生变化，而背景的大小保持不变，如下面的截图所示： ![在此处输入图像描述](../Images/7c68ba6d5e6af4777b3ac39fae6fb815.png)

在这种情况下，最好的解决方案是什么？我正在寻找一个纯 CSS 解决方案（不必更改 HTML 标记）。请帮帮我，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:48:26.407

您的问题是`contain`在您的背景定义中使用。这使图像的大小与主体一样大，并且主体保持全尺寸。

尝试使用 repeat-x 而不是 no-repeat，并将背景大小的宽度部分设置为与标题元素的宽度相同的值。

除非我遗漏了一些东西，否则这应该使它可以匹配。

# wcf - 我可以在 WCF .config 文件中嵌套连接字符串吗？

> ID：12713902
> 
> 赞同：1
> 
> 时间：2012-10-03T17:39:17.720
> 
> 标签：wcf, web-config, wcf-data-services

我正在使用具有多个调用的 WCF Web 服务的 Web 应用程序。我们正在尝试将调用分割成属于同一业务功能的单独调用*模块，并使用一个核心模块来容纳所有通用设置。*

但是，我们有一种情况，其中一个模块需要不同的数据库连接，但它特定于业务功能，因此不包含在核心 .config 中。

```
<configuration>
    <connectionStrings>
        <add name="connectionName" providerName="System.Data.SqlClient"
            connectionString="Data Source=server,1111;Database=Whatever;Trusted_Connection=True;Min Pool Size=0;Max Pool Size=50;" />
    </connectionStrings>
    <system.serviceModel>
        <services>
            <service name="Foo.DataFeedService" behaviorConfiguration="FooServiceBehavior">
                <endpoint binding="basicHttpBinding" bindingConfiguration="FooBasicHttpBinding" 
                    name="Foo" contract="Foo.IDataFeedService"/>
            </service>
        </services>
    </system.serviceModel>
</configuration> 
```

本质上，这只是一个带有连接字符串的服务存根。我们的其他每个 .config 文件都是这样构造的，服务模型在每个文件中都被存根，sans- `<connectionString>`。他们都正常工作。但是，引入连接字符串会导致问题。将连接字符串移动到根配置中解决了这个问题，它只是与我们试图通过分割每个业务功能来实现的目标背道而驰。有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:04:31.773

无法跨多个配置文件分离连接字符串或在单个配置文件的不同位置定义它们。

如果您有一个应用程序，并且您尝试按业务功能分离设置，则可以使用自定义配置部分。

A. 为服务的每个应用程序设置定义一个自定义配置节类：

```
public class DataFeedServiceSettings : ConfigurationSection
{
    [ConfigurationProperty("connectionString", IsRequired=true)]
    public string ConnectionString { get; set; }

    [ConfigurationProperty("propertyA", IsRequired = true)]
    public string PropertyA { get; set; }
}

public class OtherServiceSettings : ConfigurationSection
{
    [ConfigurationProperty("connectionString", IsRequired = true)]
    public string ConnectionString { get; set; }

    [ConfigurationProperty("propertyB", IsRequired = true)]
    public string PropertyB { get; set; }
} 
```

B. 将配置部分添加到配置文件中。

```
<configuration>
    <configSections>
        <section name="dataFeedServiceSettings" type="DataFeedServiceSettings" />
        <section name="otherServiceSettings" type="OtherServiceSettings" />
    </configSections>
    <dataFeedServiceSettings connectionString="[connectionstring1]"
        propertyA="value1" />
    <otherServiceSettings connectionString="[connectionstring2]"
        propertyB="value2" />
</configuration> 
```

配置部分也可以位于单独的文件中。

```
<configuration>
    <configSections>
        <section name="dataFeedServiceSettings" type="DataFeedServiceSettings" />
        <section name="otherServiceSettings" type="OtherServiceSettings" />
    </configSections>
    <dataFeedServiceSettings configSource="file1.config" />
    <otherServiceSettings configSource="file2.config" />
</configuration> 
```

文件1.config

```
<?xml version='1.0' encoding='utf-8'?>
<dataFeedServiceSettings connectionString="[connectionstring1]"
    propertyA="value1" /> 
```

文件2.config

```
<?xml version='1.0' encoding='utf-8'?>
<otherServiceSettings connectionString="[connectionstring2]"
    propertyB="value2" /> 
```

这种方法的缺点是连接字符串不再位于 connectionStrings 部分，但是您可以将“业务模块”分组到它们自己的部分中并将业务配置移动到它们自己的文件中。

# tfs - 使用 CLI 从 tfs 服务器获取最新信息

> ID：12713909
> 
> 赞同：2
> 
> 时间：2012-10-03T17:40:11.370
> 
> 标签：tfs, batch-file, command-line-interface

我正在处理这个命令行，它应该允许我从我的团队基础服务器获取最新版本。我只是做了很多谷歌查找，每次我都卡住了。

这是我得到的和我想要的。

我想从目录（“$/projects/name”）递归获取最新版本并将其放在本地文件夹（“D:\destination”）

这是我在尝试拨打电话时遇到的问题：

"C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\tf.exe" 获取 "$/projects/name" /force /recursive "D:\destination" /server:tfs.server.net

这对我来说很有意义，但不知何故它不起作用。

我使用新的 tfs 11。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T18:27:08.600

Team Foundation Server 使用*工作区映射*来配置应将服务器路径下载到本地文件系统的位置。这允许非常复杂的源代码控制配置方案，但这也意味着您需要在下载代码之前执行更多步骤：即，在最终[执行 get之前](http://msdn.microsoft.com/en-us/library/fx7sdeyf%28v=vs.100%29.aspx)[创建工作区](http://msdn.microsoft.com/en-us/library/y901w7se%28v=vs.100%29.aspx)并[设置工作区映射](http://msdn.microsoft.com/en-us/library/0fa04bx6%28v=vs.100%29.aspx)。

要使用 TFS 命令行客户端执行此操作：

```
tf workspace /collection:http://server:8080/tfs/DefaultCollection /new /noprompt WORKSPACE_NAME
tf workfold /collection:http://server:8080/tfs/DefaultCollection /map $/Server/Path C:\Local\Path
tf get C:\Local\Path 
```

# vba - 如何以可读的方式重写excel公式？

> ID：12713913
> 
> 赞同：15
> 
> 时间：2012-10-03T17:40:19.880
> 
> 标签：vba, excel, excel-formula

我有一个以这种方式包含公式的 Excel 文件：

`=IF(OR(ISERROR(G16),ISERROR(G17)),X16,IF(OR(G16="xxx",G16="yyy",G16="zzz"),Y16,IF(G16="333","N\A",IF(G17="333",Z16,IF(D17="",IF((HEX2DEC(W$10)-HEX2DEC(W16))/VLOOKUP(F16,$M$36:$N$41,2,FALSE)<0,0,(HEX2DEC(W$10)-HEX2DEC(W16))/VLOOKUP(F16,$M$36:$N$41,2,FALSE)), IF((HEX2DEC(W17)-HEX2DEC(W16))/VLOOKUP(F16,$M$36:$N$41,2,FALSE)<0,0,(HEX2DEC(W17)-HEX2DEC(W16))/VLOOKUP(F16,$M$36:$N$41,2,FALSE)))))))`

我想简化它们，以便以更易读的方式编写。

*   我可以以缩进的方式编辑/编写 Excel 公式吗？
*   我可以做什么样的简化？
*   我应该使用 VBA 脚本而不是 Excel 的公式吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-03T18:55:02.470

您可以在公式栏中使用 Alt+Enter 使公式变为多行。可悲的是，没有制表符只有空格，因此创建和编辑变得乏味。也可以看看

[http://www.dailydoseofexcel.com/archives/2005/04/01/excel-formula-formatter/](http://www.dailydoseofexcel.com/archives/2005/04/01/excel-formula-formatter/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-03T18:21:26.613

命名您引用的一些单元格可能会使整个内容更具可读性

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-03T18:18:48.243

作为使用辅助列的示例，您可以使用以下内容缩短公式

[A1]`=VLOOKUP(F16,$M$36:$N$41,2,FALSE)`

[B1]`=HEX2DEC(W$10)`

[C1]`=HEX2DEC(W16)`

[D1]`=HEX2DEC(W17)`

然后将大公式缩短为

`=IF(OR(ISERROR(G16),ISERROR(G17)),X16,IF(OR(G16="xxx",G16="yyy",G16="zzz"),Y16,IF(G16="333","N\A",IF(G17="333",Z16,IF(D17="",IF((B1-C1)/A1<0,0,(B1-C1)/A1), IF((D1-C1)/A1<0,0,(D1-C1)/A1))))))`

这在使用 DATE 或 NOW 等易失性函数时特别有效，当结果相同时，您不想为每个单元格重新计算。

它是否更具可读性，也许不是，但您可以用适当的注释标记列标题

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-18T01:00:30.707

[FormulaDesk](http://www.formuladesk.com)是一个免费的 Excel 插件，它使复杂的公式更具可读性和更易于理解，而无需重写它们。它使创建、编辑、调试和理解公式变得更加容易。它有两种模式：“编辑视图”和“探索视图”，可以切换。

*   “编辑”视图是一个增强的公式编辑器，具有 Intellisense 等功能。它在您键入时格式化，垂直偏移嵌套元素以提高清晰度和可理解性。

*   “探索”视图以简单的嵌套/上卷方式呈现公式，首先是最简单的公式顶层视图，但允许您向下钻取到嵌套表达式。这使您能够快速了解​​它如何/为什么返回当前结果。单击绿色条（汇总结果）以向下钻取。或者，单击“全部展开”、“全部折叠”按钮。

*   在这两个视图中，您可以将鼠标悬停在各种元素（例如：函数、参数等）上以查看包含更多信息的弹出窗口，例如定义/描述、当前值等。例如，悬停在某个范围上将显示其当前值。

*   还有很多其他功能。

*[披露：我是 FormulaDesk 的作者]*

![在此处输入图像描述](../Images/d78489be9495b69b00fad11a1cc8c348.png)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-03T18:32:38.863

辅助列和命名范围的组合将使该公式变得非常简单。

在下图中，您可以看到命名范围如何整理公式：

请注意，“prices”是范围 A2:A7 的名称，“inflated_prices”是 B2:B7 的名称。

另请注意，名称是智能的：`sum(prices)`将对整个范围求和，而`=+prices*2`在 B2 中解析为`=+A2*2`，`=+prices*2`在 B3 中解析为`=+A3*2`等等。

![在此处输入图像描述](../Images/f320698cb5443e9473e584479619496d.png)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-03T19:03:33.517

您可以大大简化您的公式，同时仍然保留一个公式。您对该`HEX2DEC/VLOOKUP`部分重复几乎相同的表达式 4 次，如果您认识到这可以简化为单个实例

=IF(公式<0,0,公式)

......相当于

=MAX(0,公式)

[对于公式的数值结果]

如果您将 IF(D17=""..... 表达式嵌套在主公式中，即此版本

`=IF(ISERROR(G16&G17),X16,IF(OR(G16={"xxx","yyy","zzz"}), Y16,IF(G16="333","N\A",IF(G17="333",Z16,MAX(0,(HEX2DEC(IF(D17="",W$10,W17))-HEX2DEC(W16))/VLOOKUP(F16,$M$36:$N$41,2,0))))))`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-10-05T07:28:11.320

既然您询问了 VBA 代码，我想我会尝试一下。它当然更容易理解，因此更易于维护，但是该函数有 11 个参数，所以有点笨拙。

```
Function Magic(d17 As Range _
                , f16 As Range _
                , g16 As Range _
                , g17 As Range _
                , w10 As Range _
                , w16 As Range _
                , w17 As Range _
                , x16 As Range _
                , y16 As Range _
                , z16 As Range _
                , m36 As Range) As Variant

    Dim a As Variant
    Dim b As Variant

    If IsError(g16.Value) Or IsError(g17.Value) Then
        Magic = x16.Value
        Exit Function
    End If

    If g16.Value = "xxx" Or g16.Value = "yyy" Or g16.Value = "zzz" Then
        Magic = y16.Value
        Exit Function
    End If

    If g16.Value = "333" Then
        Magic = "N\A"
        Exit Function
    End If

    If g17.Value = "333" Then
        Magic = z16.Value
        Exit Function
    End If

    If d17.Value = "" Then
        a = Application.WorksheetFunction.Hex2Dec(w10.Value) _
                - Application.WorksheetFunction.Hex2Dec(w16.Value)
        a = a / Application.WorksheetFunction.VLookup(f16.Value, m36, 2, False)
        If a < 0 Then
            Magic = 0
            Exit Function
        Else
            Magic = a
            Exit Function
        End If
    Else
        b = Application.WorksheetFunction.Hex2Dec(w17.Value) _
                - Application.WorksheetFunction.Hex2Dec(w16.Value)
        b = b / Application.WorksheetFunction.VLookup(f16.Value, m36, 2, False)
        If b < 0 Then
            Magic = 0
            Exit Function
        Else
            Magic = b
            Exit Function
        End If
    End If
End Function 
```

为了更容易遵循您的公式逻辑（我不知道单元格代表什么），我为单元格引用命名了变量。您需要将它们重命名为有意义的名称。代码属于一个模块。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-07T23:43:27.703

如果您有一个看起来像这样的公式，那么要获得有意义的响应，您必须在论坛上发布一个示例工作簿，其中包含有关您要实现的目标的明确说明。

是的，上面的一些答案指出了如何更好地查看公式，或者摆脱一些多余的东西，或者隐藏一些 VBA 中的复杂性（在我看来，这仅涉及化妆品，可能会大大增加重新计算时间）。

但如果不知道公式的**意图**——以及它所在的工作簿——只能提供这么多的建议。

如果你的工作簿中有*成千上万个*这样的公式，那么你有一个数据结构问题，而不是公式问题。最有效的公式是避免使用的公式。如果您要从头开始重新设计此工作簿，以便它利用 Excel 表、数据透视表，也许还有高级筛选器，那么您将避免使用数以万计的公式。也许成千上万的公式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-07T13:59:35.827

FormulaDesk 仅适用于 Windows。

除了上面的 FormulaDesk：

这是 FastExcel 当前 Beta 3 的链接。但它们似乎已经存在了十多年。29 美元。我认为只有窗户。网站不清楚。

[http://fastexcel.wordpress.com/2014/04/28/making-sense-of-complex-formulas-an-indenting-viewer-editer/](http://fastexcel.wordpress.com/2014/04/28/making-sense-of-complex-formulas-an-indenting-viewer-editer/)

Precision Calc 的类似功能。12 美元有一个 Nagware 免费版本，如果你只是偶尔需要它。仅限窗户。

[http://precisioncalc.com/tf/what_is_the_formulator.html](http://precisioncalc.com/tf/what_is_the_formulator.html)

# twitter-bootstrap - 在 Twitter Bootstrap 中制作过渡效果

> ID：12713917
> 
> 赞同：11
> 
> 时间：2012-10-03T17:40:43.287
> 
> 标签：twitter-bootstrap, css-transitions

我对 Twitter Bootstrap 真的很陌生（在我学习它的第二个小时里 :)

我想做一个像这样的滑动过渡效果：[http ://webdesigntutsplus.s3.amazonaws.com/tuts/317_coming_soon/demo/index.html](http://webdesigntutsplus.s3.amazonaws.com/tuts/317_coming_soon/demo/index.html)

我该如何在 Twitter Bootstrap 中执行此操作。我的问题是我不知道如何进行转换。任何代码都是有价值的。

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-21T11:20:27.620

不要使用 Twitter Bootstrap；使用与您在亚马逊页面上提到[的相同的 CSS 框架。](http://daneden.me/animate/)

查看[文档](https://github.com/daneden/animate.css)以获取有关如何使用它的更多信息。它说：

> 要在您的网站中使用 animate.css，只需将样式表放入您的文档中`<head>`，然后将类`animated`与任何动画名称一起添加到元素中。而已！你有一个 CSS 动画元素。极好的！

# python - 我必须搜索扩展名为 .txt 的文件，但路径每天都在变化

> ID：12713919
> 
> 赞同：0
> 
> 时间：2012-10-03T17:40:56.800
> 
> 标签：python

我的文件管理有问题。我必须搜索扩展名为 .txt 的文件，但路径每天都在变化。

我有另一个包含实际路径的文件，我可以将它存储在一个字符串中，但是当我给出搜索算法时，Windows 会丢弃一条错误消息。

这是我的脚本：

```
path= 'c:\..... this is the path what I get back from an another script'

os.chdir(path)
for files in os.listdir("."):``
    if files.endswith(".txt"):
        print files 
```

错误信息：WindowsError: [错误 3] 系统找不到指定的路径：'c:....'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T17:45:39.973

这是为了解决问题。

```
from glob import glob
from os.path import join

path = 'c:\\test'
print glob(join(path, '*.txt')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T17:43:56.193

尝试这个

```
path= 'c:/..... this is the path what I get back from an another script'

os.chdir(path)
for files in os.listdir("."):``
    if files.endswith(".txt"):
        print files 
```

`/`代替`\`

# jsf - JSF - 像 asp.net 中的控制状态？

> ID：12713921
> 
> 赞同：2
> 
> 时间：2012-10-03T17:41:12.713
> 
> 标签：jsf, controls, javabeans

我创建了一个自定义控件并将其添加到我的标签库中。

此控件显示两个 selectonemenu，其中第二个依赖于第一个，并通过 ajax 从数据库中的数据进行更新。

目前，我使用视图范围 bean 来选择第二个的数据。但我对这个解决方案并不满意，因为有一个 bean 可能用于多个实例。

在asp.net中有一个控件状态来保存控件相关数据。有没有类似的东西？

或者，我可以将请求范围的 bean 与转换器一起使用，该转换器在选择时再次从数据库中检索数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:57:42.593

`Component State`在谈论扩展类时调用等效项`UIComponent`。

```
@Override
public Object saveState(FacesContext context) {
    Object values[] = new Object[2];
    values[0] = super.saveState(context);
    values[1] = label;
    return ((Object) (values));
}

@Override
public void restoreState(FacesContext context, Object state) {
    Object values[] = (Object[])state;
    super.restoreState(context, values[0]);
    label = (String)values[1];
} 
```

以上是如何在 UIComponent 中跨回发持久化组件属性的示例。简单扩展以下两种方法。

# c# - 动态确定应用程序是基于 Winform 还是基于 ASP.NET

> ID：12713924
> 
> 赞同：1
> 
> 时间：2012-10-03T17:41:21.630
> 
> 标签：c#, asp.net, .net, winforms, n-tier-architecture

我有一个数据访问层，它被编译为类库并编译为 dll。从历史上看，该 dll 为我的 Web 应用程序提供了对我的数据库的数据访问。它工作得很好，但它的作用是从 web.config 中提取我的连接字符串。这也很好，但现在我想在 Windows 窗体应用程序中使用这个数据 dll。有没有办法让 DLL 知道它是否在 Web 应用程序或 winform 应用程序中运行，并从 web.config 或 app.config 文件中适当地提取连接字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:59:06.140

正如我在评论中所说，类库将使用引用它的应用程序的配置文件。不管是 WinForms 还是 Web App。只要有配置文件，库就可以访问/使用它。

这是将库用于可重用代码的一大优势。

对此的警告是确保配置文件（应用程序或网络）中包含正确的信息:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:50:26.867

实际上，从解耦的角度来看，最好的方法是让使用 DLL 的应用程序向库提供连接字符串。

# android - 在 Android 的列表视图中滑动时显示删除按钮

> ID：12713926
> 
> 赞同：6
> 
> 时间：2012-10-03T17:41:22.013
> 
> 标签：android, listview, onfling

扩展另一个 Stackoverflow 问题，我实现了一些手势检测代码，以便我可以检测我的列表视图（在 FrameLayout 中）中的一行何时被刷过。我在这里按照 Damian 的问题/回答，了解如何从适配器获取单个行/视图。 [如何在列表视图中获取行的位置（在屏幕上）](https://stackoverflow.com/questions/2139700/how-to-get-location-on-screen-of-row-in-listview)

我的 onFling 中有获取行视图的代码，并尝试将在我的 xml 布局中设置为不可见的删除按钮设置为可见。但是，这不会发生。我想知道如何在滑动时使按钮在列表视图中可见？

```
class MyGestureDetector extends SimpleOnGestureListener {
    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {
        try {

            if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                    && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                int itemId = MyClass.this.lv.pointToPosition(
                        (int) e1.getX(), (int) e1.getY());

                Log.v("item id", String.valueOf(itemId));
                View v = MyClass.this.adapter
                        .getViewOnScreen(itemId);
                Button delete = (Button) v.findViewById(R.id.button_delete);

                delete.setVisibility(View.VISIBLE);
                //MyClass.this.adapter.notifyDataSetChanged();

            }

        } catch (Exception e) {
            // nothing
        }
        return false;
    }
} 
```

我的列表适配器代码与引用的问题相同。

编辑：我尝试在 listview 上使用 getChildAt() 来获取行的视图，当有一个或更少的项目时，这有效，但是当返回的视图多于错误视图时，错误的删除按钮变得可见。

[编辑2：我在这里](https://stackoverflow.com/a/2140831/211457)使用了问题的答案来让它工作：

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T17:47:42.133

我曾经在我的应用程序中实现过这样的事情。我这样做的方式：

```
public class MyGestureDetector extends SimpleOnGestureListener {
    private ListView list;

    public MyGestureDetector(ListView list) {
        this.list = list;
    }

    //CONDITIONS ARE TYPICALLY VELOCITY OR DISTANCE    
    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
        if (INSERT_CONDITIONS_HERE)
            if (showDeleteButton(e1))
                return true;
        return super.onFling(e1, e2, velocityX, velocityY);
    }

    private boolean showDeleteButton(MotionEvent e1) {
        int pos = list.pointToPosition((int)e1.getX(), (int)e1.getY());
        return showDeleteButton(pos);
    }

    private boolean showDeleteButton(int pos) {
        View child = list.getChildAt(pos);
        if (child != null){
            Button delete = (Button) child.findViewById(R.id.delete_button_id);
            if (delete != null)
                if (delete.getVisibility() == View.INVISIBLE)
                    delete.setVisibility(View.VISIBLE);
                else
                    delete.setVisibility(View.INVISIBLE);
            return true;
        }
        return false;
    }
} 
```

这对我有用，希望你能让它工作，或者它至少给你一些提示。

# java - Spring - 实例化一个错误对象

> ID：12713933
> 
> 赞同：31
> 
> 时间：2012-10-03T17:41:39.897
> 
> 标签：java, spring

我有这样的方法：

```
public boolean validateMessage(String message, Errors errors) {
  if (!StringUtils.hasLength(message)) {
    errors.rejectValue(wrapperName + "message", "EMPTY_MESSAGE", EMPTY_MESSAGE_ERRORMSG) ;
            return false ;
        }
        return true ;
    } 
```

我想用一个新`Errors`对象调用这个方法，比如：

```
boolean result = validateMessage("hi", new Errors()) ; 
```

但是，这种实例化是不允许的`Errors`。请指教。

如果没有`Errors`，我可以使用空（新）来实现吗`BindingResult`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-03T18:11:37.573

`Errors`并且`BindingResult`是接口，因此它们不能被实例化。您唯一的选择是使用实现`Errors`.

您可以使用`org.springframework.validation.BindException`，这个工具`Errors`-[请参阅此处了解详细信息](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/validation/BindException.html)。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-03-02T11:44:56.923

另一种选择是使用 org.springframework.validation.BeanPropertyBindingResult，它实现了 Errors。此对象与您在 Spring MVC 控制器中收到的 BindingResult 属于同一类

```
Errors errors = new BeanPropertyBindingResult(objectToValidate, "objectName"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-10-03T04:22:29.830

首先，您不能初始化 Errors 对象，因为这是一个接口。

我正在尝试为我的 JUnit 测试用例初始化 Errors 对象。Spring中有许多可用的错误实现，（我在下面附上了一张图片）。

我试过`new EscapedErrors(null)`了，但它的构造函数本身需要传递 Errors 对象。

**解决方案**： 的构造函数`org.springframework.validation.BeanPropertyBindingResult`如下所示：

```
public BeanPropertyBindingResult(Object target, String objectName) {
        this(target, objectName, true, Integer.MAX_VALUE);
    } 
```

所以对我来说，`Errors errors = new BeanPropertyBindingResult(new Object(), "dummy");`就像一个魅力。

[![在此处输入图像描述](../Images/9d07311b6f86db1701360c75cbf433e0.png)](https://i.stack.imgur.com/IL1GN.jpg)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T18:09:27.357

您可以实例化类对象。但是`Errors`是一个接口，而不是一个类。因此，它不能像您尝试做的那样实例化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-12T13:40:40.050

如果这是一个 Spring MVC 应用程序并且您正在使用 @Controllers，您可以将验证对象`org.springframework.validation.BindingResult`作为映射的一部分传递，如下所示：

```
@RequestMapping(value="login.htm", method=RequestMethod.POST)
public String doLogin(HttpServletRequest request, Model model, BindingResult errors) {
    // ..... some validation code

    String message = "My message";
    boolean valid = validateMessage(message, errors); 

    // .... some more code
} 
```

这是显式实例化的另一种方法`org.springframework.validation.Errors`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-03T18:17:23.063

该方法需要一个实现`Errors`接口的对象。任何实现 Errors 接口的类都可以工作。如果您不想使用现有的类，例如`org.springframework.validation.BindException`，可以使用匿名内部类。有关已经实现的现有类，请参阅[Spring Docs](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/validation/Errors.html)`Errors`。但是你的匿名类需要实现所有的接口方法，这些方法非常多，使你的代码越来越难以阅读：

```
boolean result = validateMessage( "hi", new Errors() {

        @Override
        public void setNestedPath(String nestedPath) {
            // TODO Auto-generated method stub

        }

        @Override
        public void rejectValue(String field, String errorCode, Object[] errorArgs, String defaultMessage) {
            // TODO Auto-generated method stub

        }

        @Override
        public void rejectValue(String field, String errorCode, String defaultMessage) {
            // TODO Auto-generated method stub

        }

        @Override
        public void rejectValue(String field, String errorCode) {
            // TODO Auto-generated method stub

        }

        @Override
        public void reject(String errorCode, Object[] errorArgs, String defaultMessage) {
            // TODO Auto-generated method stub

        }

        @Override
        public void reject(String errorCode, String defaultMessage) {
            // TODO Auto-generated method stub

        }

        @Override
        public void reject(String errorCode) {
            // TODO Auto-generated method stub

        }

        @Override
        public void pushNestedPath(String subPath) {
            // TODO Auto-generated method stub

        }

        @Override
        public void popNestedPath() throws IllegalStateException {
            // TODO Auto-generated method stub

        }

        @Override
        public boolean hasGlobalErrors() {
            // TODO Auto-generated method stub
            return false;
        }

        @Override
        public boolean hasFieldErrors(String field) {
            // TODO Auto-generated method stub
            return false;
        }

        @Override
        public boolean hasFieldErrors() {
            // TODO Auto-generated method stub
            return false;
        }

        @Override
        public boolean hasErrors() {
            // TODO Auto-generated method stub
            return false;
        }

        @Override
        public String getObjectName() {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public String getNestedPath() {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public List<ObjectError> getGlobalErrors() {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public int getGlobalErrorCount() {
            // TODO Auto-generated method stub
            return 0;
        }

        @Override
        public ObjectError getGlobalError() {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public Object getFieldValue(String field) {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public Class getFieldType(String field) {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public List<FieldError> getFieldErrors(String field) {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public List<FieldError> getFieldErrors() {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public int getFieldErrorCount(String field) {
            // TODO Auto-generated method stub
            return 0;
        }

        @Override
        public int getFieldErrorCount() {
            // TODO Auto-generated method stub
            return 0;
        }

        @Override
        public FieldError getFieldError(String field) {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public FieldError getFieldError() {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public int getErrorCount() {
            // TODO Auto-generated method stub
            return 0;
        }

        @Override
        public List<ObjectError> getAllErrors() {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public void addAllErrors(Errors errors) {
            // TODO Auto-generated method stub

        }
    } ); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-08-21T06:22:29.077

大多数时候，开发人员使用`@Valid`并`BindingResult`验证发布的或新的对象。例如，在下面的代码中，通过注释验证**Category**对象`@Valid`，然后将其结果与`BindingResult`. 但是所有这些步骤都是`Spring`自动完成的。

```
@PostMapping
public String saveCategory(@Valid Category category, BindingResult bindingResult)
{
    // if there are some errors
    if (bindingResult.hasErrors())
    {
        for (ObjectError objectError : bindingResult.getAllErrors())
        {
            System.out.println(objectError.getDefaultMessage());
        }
    }

    ...
} 
```

尽管上述代码片段是 Spring 的突出优势之一，但有时您希望在其他层中具有相同的行为。因此，您必须获取 BindingResult 的实现形式的实例并将 Validator 注入到您的代码中：

```
...
import org.springframework.validation.Validator;
...

@Service
public class CategoryService
{

    @Autowired
    private Validator validator;
    ...

    private void insertNewCategory(Category category)
    {
        BindingResult bindingResult = new BeanPropertyBindingResult(category, "objectName");
        validator.validate(category, bindingResult);
        if(bindingResult.hasErrors())
        {
            for (FieldError fieldError : bindingResult.getFieldErrors())
            {
                System.out.println(fieldError.getDefaultMessage());
            }
        }
    ....
    }
} 
```

# java - 在 Java 中将 md5 转换为两个长变量

> ID：12713938
> 
> 赞同：3
> 
> 时间：2012-10-03T17:42:17.893
> 
> 标签：java, hash, md5, long-integer

我正在尝试散列一些值并将散列值用作数据库中的索引。没有碰撞非常重要，这就是我使用 md5 的原因。拥有 128 位，给了我更多的空间，我不需要担心碰撞（我知道 md5 不是碰撞安全的）。

无论如何，我怎样才能将 md5 的结果存储在数据库中，以便我可以索引它并快速检索它？我正在考虑有两个 Long 变量，其中一个将保存前 64 位的值，另一个保存第二个 64 位的值，并使用两个键作为我数据库上的索引。但我需要一种快速的方法来做到这一点......最快的方法是什么？

当我需要索引时，我不认为将 md5 散列值存储为字节数组会有很大帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:44:30.960

只需将其存储为字符串（VARCHAR）并让您的数据库对其进行索引。这是最简单的解决方案，您将从索引中获得性能提升。

# php - 如何通过ajax将带有复选框数据的数组发送到php脚本

> ID：12713939
> 
> 赞同：0
> 
> 时间：2012-10-03T17:42:17.477
> 
> 标签：php, jquery, html

还有另一个问题，与 ajax 以及如何在没有任何页面重新加载/重定向的情况下从复选框表单发送数据有关，我有以下代码，这是标记：

```
 <html>
   <head>
      <title>guild</title>
   </head>
   <body>
      <div id="dive">
         <form method="post" action="">
            <input type="checkbox" name="userList[]" value="together" />together<br />
            <input type="checkbox" name="userList[]" value="we" />we<br />
            <input type="checkbox" name="userList[]" value="made" />made<br />
            <input type="checkbox" name="userList[]" value="it" />it<br />
            <input type="submit" id="submit" value="yeah we did it!" />
         </form>
      </div>
      and here's the jquery:
      <script type="text/javascript" src="jquery-1.8.0.min (1).js"></script>
      <script type="text/javascript">
         $(document).ready(function(){
         //when the button is clicked
         $("#submit").click(function(){
         //put the checked data into an array
         var userList= $('#dive input[type=checkbox]:checked').serializeArray();
         //send the data without page reload/refresh/redirect
         $.post("guild.php", {userList: userList},function(userList)
         {
         });
         });
         });
      </script>
   </body>
</html> 
```

所以检查的数据应该被发送到一个将其写入文件的php文件，这是脚本：

```
<?php
//get sent data
$userList=$_POST['userList'];
//open file to be written to
$fp=fopen("guild.html", 'a');
//write data into file
for($i=0;$i<sizeof($userList);$i++) 
{
fwrite($fp, "<div class='gn'>."userList[$i]"."<br>"."</div>");
}
//close file
fclose($fp);
?> 
```

我知道这是一个非常简单的问题，但即使在阅读其他答案之后，我也无法让它发挥作用。我需要以数组的形式发送检查的数据，而不是字符串。那么我将如何更改 jquery 部分以使其工作？提前感谢您的帮助，我是一个极端的初学者！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:47:17.950

根据[jQuery post 文档](http://api.jquery.com/jQuery.post/#example-2)，您应该像这样发送 post 数据数组：

```
$.post("guild.php", { "userList[]": userList }... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T11:06:45.190

我使用该脚本并收到以下信息：

```
Array ( [0] => [object Object] [1] => [object Object] ) 
```

我使用这段代码：

```
function add_apartament ()
    {
var vedere= $('#vedere input[type=checkbox]:checked').serializeArray();
        $.ajax({
            type: "POST",
            url: "inc/ajax/add_apartament_action.php",
            data: { 
                    'vedere[]':vedere
                  },
            success: function (msg) {

                $("#action").html(msg);
            },
            error: function (xhr, err) {
                alert("readyState: " + xhr.readyState + "\nstatus: " + xhr.status);
                alert("responseText: " + xhr.responseText);
            }
        });

    } 
```

和 php...

```
<?php

print_r($_POST['vedere']);

?> 
```

# php - Prestashop - 从模块内部实用地创建后台选项卡

> ID：12713941
> 
> 赞同：1
> 
> 时间：2012-10-03T17:42:25.930
> 
> 标签：php, content-management-system, e-commerce, prestashop

我正在编写一个 prestashop 模块。在安装功能中，我想创建一个后台选项卡来管理我的模块操作。是否可以使用 Prestashop 类而不直接在数据库中创建坏的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T13:45:00.490

Prestashop 有这样的课程。
这是 Tab 类，使用函数`add`.

看：

```
$tab = new Tab();
$tab->class_name = 'your_class';
$tab->id_parent = 0;
$tab->module = 'Your module';
$tab->name[(int)(Configuration::get('PS_LANG_DEFAULT'))] = $this->l('Module name');

return $tab->add(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T17:10:50.803

您不必在 admin/tab 中创建 admintap 文件

只下载这个模块，看看它是如何工作的 [Prestashop Autoupgrade 模块](https://addons.prestashop.com/en/administration-tools-prestashop-modules/5496-autoupgrade.html)

它是一个标准的 prestashop 模块，可以为自己创建新标签

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T07:33:34.563

是的，这是可能的，您可以为您的模块提供自己的选项卡或子选项卡，请查看以下文档：

*   [Prestashop 1.4](http://doc.prestashop.com/display/PS14/Creating+a+PrestaShop+module#CreatingaPrestaShopmodule-Creatingthemodule%27sbackofficetab,anditsclass)
*   [Prestashop 1.5](http://doc.prestashop.com/display/PS15/Creating+a+PrestaShop+module#CreatingaPrestaShopmodule-Creatingthemodule%27sbackofficetab,anditsclass)

唯一的问题是您必须在模块文件夹之外添加文件，并在后台手动添加选项卡...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T13:15:34.997

是的，你可以做到。创建您的类`object model`的表数据库并将您的类插入到表数据库`tab`中。

例如我修改模块`mymodule`文档 1.4 ：

```
 public function install()

     {

         if (parent::install() == false OR 

                 !$this-registerHook('leftColumn') OR 

                 !Db::getInstance()-Execute('
                     CREATE TABLE IF NOT EXISTS `'._DB_PREFIX_.'test` (

                         `id_test` int(6) NOT NULL AUTO_INCREMENT,

                         `test` varchar(255) NOT NULL,

                         PRIMARY KEY(`id_test`)

                     ) ENGINE='._MYSQL_ENGINE_.' default CHARSET=utf8') OR 

                 !$this-setTab()
             )
             return false;
         return true;
     }

     public function setTab() {
         if (!Db::getInstance()-Execute(
                         "INSERT INTO `"._DB_PREFIX_."tab` 
                             (`class_name`, `position`, `id_parent`) 
                             VALUES ('AdminTest', '10', '1')"
                     )) 
                 return false;

         $id = Db::getInstance()-insert_id();
         $count = (int)Db::getInstance()-getValue('SELECT COUNT(*) FROM '._DB_PREFIX_.'lang');

         while ($count  0) {
             if (!Db::getInstance()-Execute(
                         "INSERT INTO `"._DB_PREFIX_."tab_lang` 
                             (`id_tab`, `id_lang`, `name`) 
                             VALUES (".$id.", ".  $count.", 'Test Tab')"
                     )) 
                 return false;

             $count--;
         }

         if (!TabCore::initAccess($id))            
             return false;

         return true;
     } 
```

尝试修改`install`功能和添加`setTab`功能。您可以为您的模块进行修改。

# html - 我怎样才能像谷歌一样调整我的搜索引擎？

> ID：12713950
> 
> 赞同：-1
> 
> 时间：2012-10-03T17:43:05.120
> 
> 标签：html, css

谷歌如何调整其搜索引擎？似乎任何屏幕分辨率，搜索栏始终居中，其上方是徽标，下方是按钮。我希望我的搜索引擎完全一样，唯一的问题是它似乎在更大的分辨率上向右移动但在我的 Macbook Pro 上很好？

有任何想法吗？我的CSS代码如下：

```
.searching {
  position:relative;
  top:-60px;
  left:-30px;
  background-color:#EBEAE2;
  color:#000000;
  font-family:Trebuchet MS; 
  font-weight:normal; 
  font-size:16px; 
  width:800px;
}
.logo {
  posistion:relative;
  margin-top:30px;
  margin-left:270px;
}
.qlickbutton {
  position:relative;
  top:-42px;
  left:10px;
  height:50px;
  width:70px;
} 

<img src="Qlick1.png" class="logo" id="logo" width="600" height="300"> 

<form action='search2.php' method='get' autocomplete="off">
  <center> 
    <input class="searching" id="searching" autocomplete="off" type="text" name="k" maxlength="255">
    <input class="qlickbutton" id="qlickbutton" type="image" src="qlick button.png" alt="Qlick"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:45:42.103

将左/右边距设置为自动，并在 div 上设置宽度。

此外，如果您想知道另一个网站是如何做某事的，只需查看它们的来源和/或使用您的浏览器工具进行检查！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T17:57:43.327

如果您想让它在所有浏览器中完美对齐，请使用百分比

**HTML**

```
​&lt;div id="main">
  <div id="searchName">your search engine name</div>
  <div id="searchEngine">SEARCH</div>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**CSS**

```
#main
{
  width:50%;
  margin:30% 25%; /* for alignment (set as you need)*/
}

#main div
{    
  width:100%;
  text-align:center;
}​ 
```

或者使用定位来实现对齐。

我对你的建议是不要跟随别人的设计。在实施之前创建自己的或理解它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T17:48:18.370

这就是谷歌对齐的方式

```
center {
   text-align: -webkit-center;
}

<center>
    <div style="height:102px;"></div>
</center> 
```

要查看完整的 html\css 源代码，请右键单击页面并使用 Chrome 检查元素。

# html - 带有 CSS 显示表的滚动布局

> ID：12713952
> 
> 赞同：2
> 
> 时间：2012-10-03T17:43:07.403
> 
> 标签：html, css, css-tables

我正在尝试使用显示表进行两列布局，但是我无法弄清楚如何将其设为固定高度（浏览器的高度）并让“单元格”在溢出时滚动以显示内容。

我认为这将是一件简单的事情，但它却出人意料地困难。

正如你所看到的，我什至尝试添加一个`.scroll` `<div>`几乎什么都不做的特殊功能。

## HTML

```
<div class="dashboard">
    <div class="side panel">
        <div class="scroll">
            <div style="height: 400px">
            asdfasdf
            </div>
        </div>
    </div>
    <div class="main panel">
        <div style="height: 400px">

        </div>
    </div>
</div> 
```

## CSS

```
html, body, .dashboard {
    position: absolute;
    display: block;
    top: 0; bottom: 0; height: 100%;
    left: 0; right: 0;  width: 100%;
}
.dashboard {
    display: table;
}
.panel {
    display: table-cell;
    vertical-align: top;
}
.panel .scroll {
    display: block;
    overflow: auto;
}
.side.panel {
    width: 200px;
} 
```

### SCSS：http: [//jsfiddle.net/JamesKyle/j7U5E/](http://jsfiddle.net/JamesKyle/j7U5E/)

### CSS：http: [//jsfiddle.net/JamesKyle/fScW3/](http://jsfiddle.net/JamesKyle/fScW3/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:47:37.950

使用`overflow-y: scroll;`而不是使用`overflow: auto;`，因为`overflow: auto;`会增加 div 的高度，但不会使其滚动里面的内容......

[我的小提琴](http://jsfiddle.net/fScW3/5/)

# android - 如何在模拟器上安装安卓市场

> ID：12713953
> 
> 赞同：1
> 
> 时间：2012-10-03T17:43:12.277
> 
> 标签：android, android-emulator, google-play

我尝试使用这些说明在模拟器上安装 android market - [How to install android market on emulator for all api's](https://stackoverflow.com/questions/8606186/how-to-install-android-market-on-emulator-for-all-apis)，但重新启动模拟器后，所有更改都将丢失。

[在其他指南](http://blog.varunkumar.me/2010/11/how-to-install-android-market-in-google.html)中，我读到我需要从设备 avd 文件夹中删除一些 .img 文件，但它不起作用。我还能做些什么来将市场永久安装到模拟器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:43:25.800

正如您告诉我的那样，您需要这个用于测试目的，我认为这不值得麻烦。你不知道有人用安卓设备来测试它吗？我知道这不是您期望的答案 - 但无论如何建议在真实设备上进行测试 - 这是我的建议：

我一直在市场上的一些应用程序中使用此代码，并且运行良好：

```
public static void goToMarket(Context context){
    Intent it = new Intent(Intent.ACTION_VIEW);
    it.setData(Uri.parse(context.getString(R.string.playstorelink)));
    context.startActivity(it);
} 
```

字符串中的链接可能如下所示：market://details?id=com.google.zxing.client.android

为了防止此代码在模拟器上崩溃（显然没有 PlayStore），您可以将此代码包装在 try catch 博客中：

```
catch (ActivityNotFoundException e) {
        // Do something
} 
```

# jquery - jQuery 使用 on() 事件停止对 body 的所有子节点的传播

> ID：12713958
> 
> 赞同：0
> 
> 时间：2012-10-03T17:43:47.923
> 
> 标签：jquery, parent-child, children, stoppropagation

我有一个脚本在显示弹出框时禁用正文元素的滚动，但是我不想禁用弹出框（或主体以外的任何其他滚动条）的滚动，我已经建立通过选择弹出框中的元素我想要什么，但是我希望它适用于所有内容，而不仅仅是那个元素。

```
 $('html').on('mousewheel DOMMouseScroll', "body", function(e) {
    var scrollTo = null;

    if (e.type == 'mousewheel') {
        scrollTo = (e.originalEvent.wheelDelta * -1);
    }
    else if (e.type == 'DOMMouseScroll') {
        scrollTo = 40 * e.originalEvent.detail;
    }

    if (scrollTo) {
        e.preventDefault();
        $(this).scrollTop(scrollTo + $(this).scrollTop());
    }
});

$('div').on('mousewheel DOMMouseScroll', ".photos", function(e) {
    e.stopPropagation();

}); 
```

所以我想要做的是第二个脚本，而不是直接选择 .photos ，只是选择 <body> 的任何孩子

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:47:48.310

尝试使用`>`子选择器，不要在委托节点集上使用选择器。

```
$('body > *').on('mousewheel DOMMouseScroll', null, function(e) {
    e.stopPropagation();
}); 
```

如果您想要任何*后代*，请`body`删除该`>`规则。

**编辑：**
前面的代码使用了一个选择器，这会使委托无效。感谢@RichardNeilIlagan 指出这一点。

**编辑 2：**
如果您只想滚动弹出框中的内容，为什么不让您的弹出框使用 100% W x 100% H 覆盖，就像 jQuery UI 对话框在“模态”模式下所做的那样？然后你可以将你的无滚动处理程序附加到全窗口覆盖`stopPropagation`上，不是吗。除非您要求弹出窗口后面的内容仍然可以访问，否则这将起作用。

# sql-server - 使用单字符通配符更新不起作用

> ID：12713966
> 
> 赞同：0
> 
> 时间：2012-10-03T17:44:36.383
> 
> 标签：sql-server, replace

为什么这不起作用？是字符集问题还是什么？这真让我抓狂。我一直在寻找。也许这只是那些日子之一。:(

```
select replace('Doe, John B ',' _ ','') 
```

预期结果：“Doe，John”

实际结果：“Doe, John B”

如果这是不可能的`replace`，我还能如何实现这个结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:50:48.213

该`REPLACE`函数不接受 sql server 中的模式/通配符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T18:13:12.020

对于这个变量：

```
select 
rtrim(reverse(substring(reverse(rtrim('Doe, John B ')), charindex(' ', reverse(rtrim('Doe, John B '))), len(rtrim('Doe, John B '))))) 
```

对于整个表：

```
select 
rtrim(reverse(substring(reverse(rtrim(columnname)), charindex(' ', reverse(rtrim(columnname))), len(rtrim(columnname)))))
from tablename
where columnname like '% _ ' 
```

# mysql - 附近日期的mysql平均值

> ID：12713970
> 
> 赞同：0
> 
> 时间：2012-10-03T17:44:55.127
> 
> 标签：mysql, datetime, average

我有一张桌子

```
datetime (every 15 mins) | value 
```

我如何显示平均价值

```
select  avg( value_15mins_before, value, value_15mins_after ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:19:51.657

我建议您在表中放置一个自动递增的 id。使用时间戳时，事情可能会延迟几分之一秒，这可能会导致问题。

以下将为您提供每个点周围的移动平均线：

```
select (value + coalesce(tprev.value, 0.0) + coalesce(tnext.value, 0.0)) /
       ((case when value is not null then 1.0 else 0.0 end) +
        (case when tprev.value is not null then 1.0 else 0.0 end) +
        (case when tnext.value is not null then 1.0 else 0.0 end)
       ) as moving_avg
from (select t.*,
             (select max(t2.dt) from t t2 where t2.dt < t.dt) as dt_prev,
             (select min(t2.dt) from t t2 where t2.dt > t.dt) as dt_next
      from t
     ) t left outer join
     t tprev
     on t.dt_prev = tprev.dt_prev left outer join
     t tnext
     on t.dt_next = tnext.dt_next 
```

它假设数据中没有“漏洞”。您可以通过在 dt_prev 和 dt_next 的子查询中添加约束来解决此问题。. . 例如，仅考虑在给定值 20 分钟内的时间值。

这也假设它`value`不为空。

# android - FrameRecorder / FFmpegFrameRecorder 输出文件中没有声音

> ID：12713971
> 
> 赞同：1
> 
> 时间：2012-10-03T17:45:06.690
> 
> 标签：android, opencv, ffmpeg, javacv

这是我用来使用 JavaCV 和 ffmpeg 在 android 中调整视频大小的代码 -

```
FFmpegFrameGrabber grabber = new FmpegFrameGrabber("/sdcard/DCIM/100MEDIA/VIDEO0066.mp4"); 
        grabber.start();

        int w = (int)grabber.getImageWidth()/2;
        int h = (int)grabber.getImageHeight()/2;        

        if (w%2 != 0) w=w-1;
        if (h%2 != 0) h=h-1;

        FrameRecorder recorder = new FFmpegFrameRecorder("/sdcard/DCIM/output.mov", w, h ,grabber.getAudioChannels());

        recorder.setVideoCodec(avcodec.CODEC_ID_MPEG4);
        recorder.setPixelFormat(avutil.PIX_FMT_YUV420P);
        recorder.setAudioCodec(avcodec.CODEC_ID_PCM_S16LE); 
        recorder.start(); 

        Frame frame = null;
        while ((frame = grabber.grabFrame()) != null)
        {
            IplImage source = frame.image;
            if (source!=null)
            {
            IplImage destination = cvCreateImage(cvSize(w , h), source.depth(), source.nChannels() );
            cvResize(source, destination);
            frame.image = destination;
            recorder.record(frame);

            }
        } 
```

如果我使用原始宽度和高度而不是视频有声音，但是当我使用 w/2 和 h/2 时，输出文件没有声音。请指教。

# sql-server - Junit测试不回滚sqlserver上的事务

> ID：12713973
> 
> 赞同：1
> 
> 时间：2012-10-03T17:45:10.867
> 
> 标签：sql-server, spring, hibernate, junit, rollback

我创建了一个服务的集成测试，它在完成后不回滚事务。我通过查看数据库和第二次运行测试时遇到的错误知道这一点。我整个早上都在谷歌上搜索这个问题，感觉一切都设置妥当了。这是一个写入 SQLServer 2008 的 hibernate/jpa 应用程序。我不知道还能去哪里看。片段如下。

```
@RunWith(SpringJUnit4ClassRunner.class)
@TestExecutionListeners({
        DependencyInjectionTestExecutionListener.class,
        DirtiesContextTestExecutionListener.class,
        TransactionalTestExecutionListener.class })
@TransactionConfiguration(defaultRollback=true)
@Transactional // extend transactional boundary to test class so that automatic rollback works properly
@ContextConfiguration(locations = {
        "file:./src/main/resources/AghostMobile.Service-business.service-context.xml",
        "file:./src/main/resources/AghostMobile.Service-service-context.xml",
        "file:./src/main/resources/AghostMobile.Service-dao-context.xml"})
public class ColorSchemeMigrationServiceIntTest {

    /**
     * The service being tested, injected by Spring
     *
     */
    @Autowired
    ColorSchemeMigrationService service;

    /**
     * The helper services, injected by Spring.
     *
     */
    @Autowired
    protected WebsitecolorpaletteuserdefinedService userPaletteService;
    @Test
    public void testSaveColorPalette() {
        Integer mobileWebsiteId = Integer.valueOf(386);
        Integer custId = Integer.valueOf(15);
        Integer siteId = Integer.valueOf(2);
        String user = "Test";

        Websitecolorpaletteuserdefined palette = service.translateColorScheme(mobileWebsiteId, custId, siteId, user);

        service.saveColorPalette(palette);

        Websitecolorpaletteuserdefined response = userPaletteService.findWebsitecolorpaletteuserdefinedByCustIdAndSiteId(custId, siteId);

        assertNotNull("User palette not found.", response);
        assertEquals("CustId is not the expected value.", custId, response.getCustId());
        assertEquals("SiteId is not the expected value.", siteId, response.getSiteId());
    } 
```

目前，我定义了以下 bean：

```
<!-- ******************************************************************** -->
<!-- Setup the transaction manager -->
<!-- ******************************************************************** -->
    <!-- Using Atomikos Transaction Manager -->
    <bean id="atomikosTransactionManager" class="com.atomikos.icatch.jta.UserTransactionManager" init-method="init"
        destroy-method="close">
        <property name="forceShutdown" value="true" />
        <property name="startupTransactionService" value="true" />
        <property name="transactionTimeout" value="60" />
    </bean>

    <bean id="atomikosUserTransaction" class="com.atomikos.icatch.jta.UserTransactionImp" />
    <!-- Configure the Spring framework to use JTA transactions from Atomikos -->
    <bean id="transactionManager" class="org.springframework.transaction.jta.JtaTransactionManager">
        <property name="transactionManager" ref="atomikosTransactionManager" />
        <property name="userTransaction" ref="atomikosUserTransaction" />
        <property name="transactionSynchronizationName" value="SYNCHRONIZATION_ON_ACTUAL_TRANSACTION" />
    </bean>
<!-- ******************************************************************** -->
<!-- Setup a data source -->
<!-- ******************************************************************** -->
<!-- Using Apache DBCP Data Sources -->
<bean name="hostDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" >
    <property name="driverClassName" value="${My_JDTs_to_AgHost_Host_scheme.connection.driver_class}" />
    <property name="username" value="${My_JDTs_to_AgHost_Host_scheme.connection.username}" />
    <property name="password" value="${My_JDTs_to_AgHost_Host_scheme.connection.password}" />
    <property name="url" value="${My_JDTs_to_AgHost_Host_scheme.connection.url}" />
    <property name="maxIdle" value="${My_JDTs_to_AgHost_Host_scheme.minPoolSize}" />
    <property name="maxActive" value="${My_JDTs_to_AgHost_Host_scheme.maxPoolSize}" />
</bean>

<!-- ******************************************************************** -->
<!-- Setup each persistence unit -->
<!-- ******************************************************************** -->
            <!-- Configure a JPA vendor adapter -->
            <bean id="My_JDTs_to_AgHost_Host_schemeJPAVendorAdapter" class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
                <property name="showSql" value="${My_JDTs_to_AgHost_Host_scheme.show_sql}" />
                <property name="generateDdl" value="${My_JDTs_to_AgHost_Host_scheme.generateDdl}" />
                <property name="databasePlatform" value="${My_JDTs_to_AgHost_Host_scheme.dialect}" />
            </bean>
            <!-- EntityManager Factory that brings together the persistence unit, datasource, and JPA Vendor -->
            <bean id="My_JDTs_to_AgHost_Host_scheme" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
                <property name="dataSource" ref="hostDataSource" />
                <property name="persistenceUnitName" value="My_JDTs_to_AgHost_Host_scheme" />
                <property name="jpaVendorAdapter" ref="My_JDTs_to_AgHost_Host_schemeJPAVendorAdapter" />
                    <property name="jpaPropertyMap">
                        <map>
                                    <entry key="hibernate.transaction.manager_lookup_class" value="com.atomikos.icatch.jta.hibernate3.TransactionManagerLookup" />
                                    <!-- <entry key="hibernate.transaction.factory_class" value="org.hibernate.transaction.JTATransactionFactory" /> -->
                                    <entry key="hibernate.connection.release_mode" value="on_close" />
                        </map>
                    </property>
            </bean> 
```

这确实允许我更新我的数据，但不会回滚我的事务。所以，我正在使用事务管理器 org.springframework.jdbc.datasource.DataSourceTransactionManager。我将“设置事务管理器”块中的三个 bean 替换为：

```
 <bean id="transactionManager"
        class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="hostDataSource" />
    </bean> 
```

这让我的测试失败并出现*IllegalStateException：此方法需要调用线程的事务，并且不存在。*例外还指出：

```
Possible causes: either you didn't start a transaction,
it rolledback due to timeout, or it was committed already.
ACTIONS: You can try one of the following: 
1\. Make sure you started a transaction for the thread.
2\. Make sure you didn't terminate it yet.
3\. Increase the transaction timeout to avoid automatic rollback of long transactions;
   check [http://www.atomikos.com/Documentation/JtaProperties][1] for how to do this. 
```

我承认尚未阅读该文档，并将在发布这些更新后这样做。我还发现了这个看起来很有希望的线程：[persistence-unit, different hibernate.transaction.manager_lookup_class property](https://stackoverflow.com/questions/10897015/persistence-unit-different-hibernate-transaction-manager-lookup-class-property)。您可以看到在 bean My_JDTs_to_AgHost_Host_scheme 中注释掉了。这失败得很惨。但是，也许我没有正确使用它。

我还发现了这个线程：[Spring/JTA/JPA DAO 集成测试不回滚？](https://stackoverflow.com/questions/3128111/spring-jta-jpa-dao-integration-test-doesnt-rollback). 这看起来很有希望，但我再次不确定如何使用它告诉我的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:46:14.280

答案竟然可以在这里找到：[Spring/JTA/JPA DAO 集成测试不回滚？](https://stackoverflow.com/questions/3128111/spring-jta-jpa-dao-integration-test-doesnt-rollback). 我将数据源更改为以下内容。

```
<bean name="hostDataSource" class="com.atomikos.jdbc.nonxa.AtomikosNonXADataSourceBean" destroy-method="close" >
    <property name="driverClassName" value="${My_JDTs_to_AgHost_Host_scheme.connection.driver_class}" />
    <property name="user" value="${My_JDTs_to_AgHost_Host_scheme.connection.username}" />
    <property name="password" value="${My_JDTs_to_AgHost_Host_scheme.connection.password}" />
    <property name="url" value="${My_JDTs_to_AgHost_Host_scheme.connection.url}" />

    <property name="maxPoolSize" value="20" />
    <property name="reapTimeout" value="300" />
    <property name="uniqueResourceName" value="myappDatabase" />
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T18:11:22.097

你加载的上下文中有一个`DataSourceTransactionManager`bean吗？

[DataSourceTransactionManager 示例](http://static.springsource.org/spring/docs/2.0.x/reference/transaction.html)

见第 9.3 节

# php - PHP 输出：文件包含与函数（性能）

> ID：12713974
> 
> 赞同：1
> 
> 时间：2012-10-03T17:45:15.843
> 
> 标签：php, html, performance, include

这是显示 html 输出的两种方法：**function**与**include**。访问文件系统而不是访问内存时是否会影响性能？如果每个页面加载有几十个甚至几百个包含，这在什么时候会成为问题？

选项 1：使用**函数的 Html 显示循环**

```
foreach ($items as $item){
    displayItem($item);
}

function displayItem($item){ ?>
    <html output>
<?php } 
```

**选项 2：使用包含的**Html 显示循环

 **```
foreach ($items as $item){
    include $path . 'displayItem.php';
}

//inside displayItem.php:
<html output> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T17:48:09.900

当然，磁盘访问比内存访问慢得多，这就是为什么磁盘访问通常被操作系统缓存在内存中的原因。即便如此，如果您能以某种方式缓存（可能包括文件）的输出，然后使用[memcache](http://php.net/manual/en/book.memcached.php)`displayItem()`之类的东西从内存中保存和加载缓存的输出，您应该会看到性能显着提高。**

# c# - Telerik RadUpload 控制错误

> ID：12713975
> 
> 赞同：0
> 
> 时间：2012-10-03T17:45:24.617
> 
> 标签：c#, asp.net, telerik, radupload

我正在使用 Telerik RadUpload 控件来上传图像，但在本地主机或本地机器上它的工作但是当我将这些代码传输到我的托管面板然后我尝试做同样的事情时它不起作用。您可以[在此站点上检查错误。](http://www.gts24x7.in/upload.aspx)

所以帮助我摆脱这个错误。

![在此处输入图像描述](../Images/2126f614b25a9ce8e1c8d36b09b95ec7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T18:00:23.997

您需要在 web.config 中注册 RadUploadProgressHandler。这是[说明](http://www.telerik.com/help/aspnet-ajax/upload-configuration.html)。

# windows - 如何将发送到 bat 文件的“kill”传播到从中调用的进程？

> ID：12713976
> 
> 赞同：0
> 
> 时间：2012-10-03T17:45:26.653
> 
> 标签：windows, process, batch-file, kill-process

我有一个启动 java 进程“java -jar ...”的 .bat 脚本，之后我在 Windows 中有两个进程，即运行 bat 的原始进程（一个 cmd 进程）和一个 java 进程。

如果我们终止 java 进程，控制返回到 bat 脚本并完成，但如果我们终止 cmd 进程，java 进程将继续运行。是否存在将 bat 脚本中的 kill 传播到从它打开的其他进程的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:04:40.610

用于`START`启动进程而不等待它返回，这样您的批处理可以根据需要完成。

```
START "WindowTitle" java -jar ... 
```

如果您需要先完成该过程，您实际上必须告诉它等待

```
START "WindowTitle" /WAIT java -jar ... 
```

如果启动程序被杀死，您的 Java 程序将不得不寻找启动它的进程以停止

# c# - 模型中的 SelectList 未显示在下拉列表中

> ID：12713983
> 
> 赞同：1
> 
> 时间：2012-10-03T17:45:57.543
> 
> 标签：c#, asp.net-mvc, razor, selectlist

重构我的 MVC 页面以获得更好的设计，就这样吧。

模型：

```
public class MyModel
{
    public IEnumerable<SelectListItem> SpeciesDropDown {get; set;}
} 
```

控制器

```
 [HttpGet]
    public ActionResult Index()
    {
    MyModel model = new MyModel()
    {
    SpeciesDropDown = StaticClass.GetSpeciesSelectList()
    } 
```

GetSpeciesSelectList 返回值列表的位置（我知道它可以工作，因为它与 viewdata 一起工作。现在视图可以工作，但有一个错误

```
 @model MyModel
    Species: @Html.DropDownList("SpeciesDropDown", 
    new SelectList(ViewData.Model.SpeciesDropDown)) 
```

它吐出一堆`System.Web.Mvc.SelectListItem`. 有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:21:47.080

代替

```
@Html.DropDownList("SpeciesDropDown", 
new SelectList(ViewData.Model.SpeciesDropDown)) 
```

使用时会发生什么

```
@Html.DropDownList("SpeciesDropDown", ViewData.Model.SpeciesDropDown) 
```

也看看这个答案：

[Asp.Net MVC 2 下拉显示 System.Web.MVC.SelectListItem](https://stackoverflow.com/questions/3832830/asp-net-mvc-2-dropdown-displaying-system-web-mvc-selectlistitem)

# c# - 如何从 C#.net 中的控件中删除所有事件处理程序

> ID：12713984
> 
> 赞同：1
> 
> 时间：2012-10-03T17:46:01.913
> 
> 标签：c#, .net, events

我在表单加载期间使用了一些递归函数。我以编程方式在控件上附加事件处理程序。由于递归函数，事件处理程序会多次与控件挂钩。我想从这些控件中删除所有处理程序。

例如。我在文本框中添加了 keypress、keydown、gotfocus 等事件。我想删除所有这些处理程序。怎么实现呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:51:03.580

如果`loEventHandler`是一个事件处理程序，您之前订阅了一个事件（例如 Click），您可以通过`loBox.Click -= loEventHandler;`.

也可以通过将事件设置为 null 来清除私有范围内的事件，`MyEvent = null;`但这不适用于公共范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T18:00:09.690

你不能从“外部”世界做到这一点，因为事件是不允许订阅者相互干扰的特殊类型的代表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:05:03.120

为避免单个事件被多次注册，您可以像这样添加一个属性包装器

```
 public event EventHandler<EventArgs> _event;
    public event EventHandler<EventArgs> PublicEvent
    {

        add
        {
            if (_event == null)
                _event += value;
        }

        remove
        {
            _event -= value;
        }
    } 
```

# javascript - Google API V3 一次只打开一个 infoWindow

> ID：12713986
> 
> 赞同：2
> 
> 时间：2012-10-03T17:46:16.957
> 
> 标签：javascript, google-api, infowindow

我根本不懂 javascript，但我设法让地图上的所有东西都能正常工作，除了这一件事。我正在为一个论坛开发一项功能，成员将他们的城市和州发给我，然后我将它们添加到地图中。这是我所拥有的：[http://l4ptester.solidwebhost.com/L4p.html](http://l4ptester.solidwebhost.com/L4p.html) 如果您单击几个地图标记，您会看到您可以一次打开任意数量的 infoWindows，而我不希望那样。我只希望一次打开 infoWindow。因此，如果我单击佛罗里达州的一个标记，然后单击加利福尼亚州的一个标记，佛罗里达州的一个就会关闭。

这是我的代码中地图标记的条目：

```
var InvadermooseLL = new google.maps.LatLng(27.321984,-82.527666);
  var contentString = 
    '<div id="content">'+
    '<center> <strong>Invadermoose</strong> </center>'+
        '<img src="http://www.luxury4play.com/customavatars/avatar16771_3.gif">'+
        '<div id="bodyContent">'+
        '<a href="http://www.luxury4play.com/members/invadermoose.html" '+
        'target="_blank">Invadermoose&#39;s L4P Profile</a>'+
        '<br/><font size="2">(Opens in new tab)</font>'+
        'City: Sarasota'+
        'State: Florida'+
        '</div>'+
        '</div>';

var InvadermooseIW = new google.maps.InfoWindow({
    content: contentString
});

var InvadermooseMKR = new google.maps.Marker({
    position: InvadermooseLL,
    map: map,
    title:"Invadermoose"
});

google.maps.event.addListener(InvadermooseMKR, 'click', function() {
    InvadermooseIW.open(map,InvadermooseMKR);
    IrelentlessIW.close(map,IrelentlessMKR);
    Hollywood85IW.close(map,Hollywood85MKR);
    HazeMythIW.close(map,HazeMythMKR);
    jagkidIW.close(map,jagkidMKR);
    DiegoVIW.close(map,DeigoVMKR);
    RaceMindedIW.close(map,RaceMindedMKR);
}); 
```

我会稍微解释一下。Invadermoose 是获取地图标记的用户，因此我将其用作 ID 以保持其井井有条。所以 var InvadermooseLL 基本上是 Invadermoose LatLang，InvadermooseMKR 是 Invadermoose Marker。它只是帮助我保持井井有条。

现在，在脚本的底部，我拥有所有的“点击”功能。在我看来，它会关闭其他成员标记，但它不起作用。我在堆栈溢出的某个地方读到这是这样做的方法，但它不起作用。

我基本上为每个拥有地图标记的用户重复相同的代码，我只是将 ID 更改为他们的用户名，并带有我的识别前缀（LL、MKR、IW）和一些“点击”功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T18:39:59.557

这比您想象的要容易，在示例中您可以找到解决方案是重用`InfoWindow`. 这比为每个用户创建一个新的要干净得多。如果只有一个`InfoWindow`，您可以简单地更新它的位置和`InfoWindow`在旧位置关闭并在新位置再次打开。

这样做的副作用是，不可能同时`InfoWindow`打开多个，因为实际上只有一个。

# c# - C# 中的类型转换对象数组成员会导致异常

> ID：12713987
> 
> 赞同：5
> 
> 时间：2012-10-03T17:46:21.603
> 
> 标签：c#, arrays, object

我有以下代码，我正在尝试调试

```
int ll(ref float[,] _lv) {
  object[] results = new object[20];

  results = func_v1(11, _lv);

} 
```

打破观察变量“结果”显示如下

```
results {object[11]}
 + [0] {float[1,1]}
 + [1] {double[1,1]}
 + [2] {float[48,1]}
   ...
   ...
 + [10] {float[1,1]} 
```

而且我无法键入 cast 以从中获取值

`float f = (float)results[0];`抛出一个无效的强制转换异常。

请帮助我了解这个对象数组到底是什么以及如何从中获取值。

问候。ak

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T17:50:20.733

您正在使用可以在此处阅读的多维数组：http: [//msdn.microsoft.com/en-us/library/2yd9wwz4 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/2yd9wwz4(v=vs.71).aspx)

你需要适当地投射它

```
var f = (float[,])results[0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T17:50:08.567

> `float f = (float)results[0];`抛出一个无效的强制转换异常。

我想你需要

```
float[,] f = (float[,])results[0];
double[,] d = (double[,])results[1]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T17:50:20.600

索引 0 处的项目不是 a `float`- 它是`float[,]`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T17:56:32.937

显然 object[] 结果中没有浮点数。您需要进入 func_v1 并查看它返回的内容。显然，它返回的东西正在被贬低为对象的东西，这可能是任何东西。从您粘贴的输出看来，它返回了一个混合了二维浮点数和双精度数的对象数组。

您可以尝试强制转换 (float[,])results[0]，但显然，当您对实际上是 double[,] 的项目执行此操作时，它会爆炸。如果您无法更改 func_v1() 您将需要对项目的类型进行切换。

即： if (results[0].GetType() == typeof(float[,]))

# java - JAVA 用 Apache POI 替换演示文稿 (PPTX) 中的图像/图片

> ID：12713988
> 
> 赞同：0
> 
> 时间：2012-10-03T17:46:22.017
> 
> 标签：java, image, powerpoint, apache-poi

只想知道如何使用 POI 将我在缓冲图像中的图像绘制到 PictureShape 中。我编写了下面的代码来完成我的要求，但没有成功。

感谢您阅读并幸运地提供帮助。

```
 for (int i = 0; i < listNewImage.size(); i++) {
                try {
                    Icon icon = listNewImage.get(i).getIcon();
                    BufferedImage im = (BufferedImage) iconToImage(icon);

                    Graphics2D g = im.createGraphics();

                    listImageShape.get(i).drawContent(g);

                } catch (IOException ex) {
                    Logger.getLogger(EditorMenuWindows.class.getName()).log(Level.SEVERE, null, ex);
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-06T05:08:35.857

这是我编写的一个[pptx4j 示例](https://github.com/plutext/docx4j/blob/master/src/pptx4j/java/org/pptx4j/samples/InsertPicture.java)，您可能会适应它。POI 的工作方式大体相似（它使用 XML Bean，而不是 JAXB）。

# java - 如何在 Java 中使用 Streaming API 解析 JSON 日志文件，然后输出列表式日志文件

> ID：12713990
> 
> 赞同：1
> 
> 时间：2012-10-03T17:46:40.523
> 
> 标签：java, json, jackson, gson

我手头有一个问题，我试图解析以 JSON 格式存储的大型日志文件，然后将数据制成表格并将其作为另一个 JSON 文件输出。以下是我正在解析的日志文件的格式：

```
{
"timestamp": "2012-10-01TO1:00:00.000",
"id": "someone@somewhere.net",
"action": "Some_Action"
"responsecode": "1000"
} 
```

这里的动作是某些用户执行的动作，响应码是该动作的结果。

时间戳和 id 实际上与我的制表无关，我只对操作/代码字段感兴趣。在任何给定的日志文件中可能有数以万计的这些条目，我想要做的是跟踪所有类型的**操作**、**响应**代码及其各自的出现次数。

下面是我希望生成的输出示例。

```
{"actionName": "Some_User_Action",
"responses": [{"code": "1000", "count": "36"},
              {"code": "1001", "count": "6"},
              {"code": "1002", "count": "3"},
              {"code": "1003", "count": "36"},
              {"code": "1004", "count": "2"}],
"totalActionCount": "83"} 
```

所以基本上，对于每个动作，我想跟踪它产生的所有不同响应，以及每个动作发生的次数。最后，我想跟踪该操作的响应总数。

目前，我已经为我计划在其中存储输出数据的输出对象创建了一个 Java 类。我对存储响应数组及其各自计数的格式也有点困惑。响应代码类型的总数也因操作而异。

根据我的研究，我似乎需要使用 Streaming API 来使用 JSON 解析。使用流式 API 的原因主要是由于使用非流式 API 需要大量内存开销，而这些日志文件的大小可能无法实现。我目前正在考虑使用 Jackson 或 GS​​ON，但我找不到任何具体的示例或教程来帮助我入门。有谁知道我可以学习的一个很好的例子，或者对我如何解决这个问题有任何提示？谢谢！

编辑：我的班级定义。

```
public class Action {

public static class Response {

    private int _resultCode;
    private int _count = 0;

    public Response() {}

    public int getResultCode() { return _resultCode; }
    public int getCount() { return _count; }

    public void setResultCode(int rc) { _resultCode = rc; }
    public void setCount(int c) { _count = c; }

}

private List<Response> responses = new ArrayList<Response>();
private String _name;

// I've left out the getters/setters and helper functions that I will add in after.

} 
```

如果我正在使用 Jackson，并希望最终能够轻松地将这个对象序列化回 JSON，关于我如何定义这个类有什么建议吗？目前，我正在我的 main() 方法中创建另一个此 Action 类型的 ArrayList，使用： List actions = new ArrayList(); 使用 HashMaps 或其他替代方案是更好的选择吗？此外，它是否允许我之后使用 Jackson 轻松地将其序列化为 JSON？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:55:44.453

好的，首先，使用 Jackson，您可以将数据绑定与流结合起来。您所需要的只是一个`JsonParser`（使用创建`JsonFactory`的，可以从中获取`ObjectMapper`或直接构造的实例）。然后，您可以将流推进到第一个条目，并从那里开始使用数据绑定 ( `ObjectMapper.readValue(...)`)。这只会读取获取所需单值实例所需的最小值。

或者更好的是，一旦到达数组，就使用“readValues()”方法

```
ObjectMapper mapper = new ObjectMapper();
JsonParser jp = mapper.getJsonFactory().createJsonParser(sourceFile);
while (jp.nextToken() != JsonToken.START_ARRAY) { }
MappingIterator<Response> it = mapper.readValues(jp, Entry.class);
while (it.hasNextValue()) {
   Response value = it.nextValue();
   // process it; keep count, whatever
} 
```

要输出，您可能需要考虑[Jackson CSV 模块](https://github.com/FasterXML/jackson-dataformat-csv)：它可以使用 CSV 变体之一编写条目；您可以将分隔符重新定义为您喜欢的任何内容。有关示例，请参阅项目 README。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:50:19.530

您可以查看 Genson 库[http://code.google.com/p/genson/](http://code.google.com/p/genson/)，在 wiki 页面上您会找到一些有关如何使用它的示例。自首次发布以来，它提供了流模型，并且似乎是继杰克逊之后最快的，请参阅[基准](http://code.google.com/p/genson/wiki/Metrics2)。

如果您想做一些真正有效的事情并且占用很小的内存空间，请通过实例化 JsonReader 直接使用流 api，然后使用它来读取记录的结构并增加您的计数器。

否则，您可以使用 Genson 实例将文件直接解析为 java 对象，但在您的情况下，我认为这不是正确的解决方案，因为它需要您将所有对象存储在内存中！

这是一个直接使用流 api 的快速示例。它不会准确打印您期望的结构，因为它需要更多代码才能有效地计算结构：

```
public static void main(String[] args) throws IOException, TransformationException {
    Map<String, Map<String, Integer>> actions = new HashMap<String, Map<String, Integer>>();
    Genson genson = new Genson();

    ObjectReader reader = genson.createReader(new FileReader("path/to/the/file"));
    while(reader.hasNext()) {
        reader.next();
        reader.beginObject();
        String action = readUntil("action", reader);
        // assuming the next name/value pair is responsecode
        reader.next();
        String responseCode = reader.valueAsString();
        Map<String, Integer> countMap = actions.get(action);
        if (countMap == null) {
            countMap = new HashMap<String, Integer>();
            actions.put(action, countMap);
        }

        Integer count = countMap.get(responseCode);
        if (count == null) {
            count = 0;
        }
        count++;
        countMap.put(responseCode, count);

        reader.endObject();
    }

    // for example if you had 2 different response codes for same action it will print
    // {"Some_Action":{"1001":1,"1000":1}}
    String json = genson.serialize(actions);
}

static String readUntil(String name, ObjectReader reader) throws IOException {
    while(reader.hasNext()) {
        reader.next();
        if (name.equals(reader.name())) {
            return reader.valueAsString();
        }
    }
    throw new IllegalStateException();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:26:06.037

您可以一一解析您的记录，因此我认为 JSON 结构的内存消耗不会超过几千字节。只需创建

```
class Something {
    String action;
    int responsecode;
    // do not include the fields you don't need
} 
```

并在每个步骤中读取一条记录。Guava 的`HashMultiset<String, Integer>`方法`put`, `count`, 并`size`为您提供所需的一切。如果你的内存用完了（因为 Multimap 很大），你可能需要一个数据库，但我会先尝试简单的解决方案。

对于输出 JSON，您可能需要 GSON`TypeAdapter`或`JsonSerializer`. 或者作为 hack，您可以轻松地手动生成输出。

# iphone - 与 RestKit 映射对象和引用作斗争

> ID：12713992
> 
> 赞同：6
> 
> 时间：2012-10-03T17:47:03.383
> 
> 标签：iphone, objective-c, core-data, restkit, relationship

**这是我的实体**

```
- HomeArticle
identifier
article (relationship)

- Article
identifier
title
subtitle
text
home (relationship) 
```

我有一个看起来像这样的有效负载：

```
[
    {
        "id": "1",
        "title": "A Nice Simple One",
        "subtitle": "Subtitle",
        "text": "text text text"
    },
    {
        "id": "2",
        "title": "A Nice Simple Two",
        "subtitle": "London",
        "text": "text text text"
    }
] 
```

我正在尝试填充**HomeArticle**并同时创建**关系**，例如：

```
RKObjectManager* objectManager = [RKObjectManager sharedManager];
    NSString *pathString = @"/get_news/";
    [objectManager loadObjectsAtResourcePath:pathString usingBlock:^(RKObjectLoader *loader) {
        loader.delegate = self;
        loader.objectMapping = [self myHomeArticleMapping];

        loader.onDidLoadObject = ^(id object) {
            ...
        };
    }];

- (RKManagedObjectMapping *) myHomeArticleMapping{
    if(_homeArticleMapping == nil){
        _homeArticleMapping = [RKManagedObjectMapping mappingForClass:[HomeArticle class] inManagedObjectStore:[[RKObjectManager sharedManager] objectStore]];
        [_homeArticleMapping mapKeyPath:@"id" toAttribute:@"identifier"];
        [_homeArticleMapping mapRelationship:@"article" withMapping:[self myArticleMapping]];
        [_homeArticleMapping connectRelationship:@"article" withObjectForPrimaryKeyAttribute:@"identifier"];
    }
}

- (RKManagedObjectMapping *) myArticleMapping{
    if(_articleMapping == nil){
        _articleMapping = [RKManagedObjectMapping mappingForClass:[Article class] inManagedObjectStore:[[RKObjectManager sharedManager] objectStore]];

        [_articleMapping mapKeyPath:@"id" toAttribute:@"identifier"];
        [_articleMapping mapKeyPath:@"title" toAttribute:@"title"];
        [_articleMapping mapKeyPath:@"subtitle" toAttribute:@"subtitle"];
        [_articleMapping mapKeyPath:@"text" toAttribute:@"text"];
    }
} 
```

“HomeArticle”的标识符已填充，但未创建关系。你知道我怎么能做到这一点吗？我正在处理的项目有点复杂，但我简化了它以使其更清晰。

## 解决方法

好的，我设法完成这项工作的唯一方法是重新处理方法中的有效负载：

```
- (void)objectLoader:(RKObjectLoader*)loader willMapData:(inout id *)mappableData 
```

我基本上从有效负载数组中创建了一个字典，将 id 作为键：

```
- (void)objectLoader:(RKObjectLoader*)loader willMapData:(inout id *)mappableData {
    NSMutableArray *newsArray = [NSMutableArray arrayWithArray:(NSArray *)*mappableData];
    NSMutableDictionary *newData = [[NSMutableDictionary alloc] init];
    int elementNumber = [newsArray count];
    for(int i = 0 ; i < elementNumber ; i++){
        NSMutableDictionary *news = [NSMutableDictionary dictionaryWithDictionary:[newsArray objectAtIndex:i]];

        [newData setObject:news forKey:[news objectForKey:@"id"]];
    }
    *mappableData = newData;
} 
```

然后我改变了“HomeArticle”的映射，如下所示：

```
if(_homeArticleMapping == nil){
            _homeArticleMapping = [RKManagedObjectMapping mappingForClass:[HomeArticle class] inManagedObjectStore:[[RKObjectManager sharedManager] objectStore]];
        _homeArticleMapping.forceCollectionMapping = YES;
        [_homeArticleMapping mapKeyOfNestedDictionaryToAttribute:@"identifier"];
        _homeArticleMapping.primaryKeyAttribute = @"identifier";
        [_homeArticleMapping mapKeyPath:@"(identifier)"
                         toRelationship:@"article"
                            withMapping:[self myArticleMapping]];
 } 
```

它有效，但我真的不喜欢它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T18:19:23.603

假设我有一个与对手关系的实体。我想用另一个名为 facebookMapping 的映射来映射关系。然后将映射添加到相应 keyPath（或根名称）处的 mappingProvider。

```
RKManagedObjectMapping *gameEntryMapping = [RKManagedObjectMapping mappingForClass:[GameEntry class] inManagedObjectStore:[RKObjectManager sharedManager].objectStore];
RKManagedObjectMapping *facebookMapping = [RKManagedObjectMapping mappingForClass:[FacebookUser class] inManagedObjectStore:[RKObjectManager sharedManager].objectStore];
[gameEntryMapping mapRelationship:@"opponent" withMapping:facebookMapping];
[facebookMapping mapKeyPath:@"systemID" toAttribute:@"systemId"];
[facebookMapping mapKeyPath:@"name" toAttribute:@"name"];
[[RKObjectManager sharedManager].mappingProvider setMapping:gameEntryMapping forKeyPath:@"games"];
[[RKObjectManager sharedManager].mappingProvider addObjectMapping:gameEntryMapping];
[[RKObjectManager sharedManager] loadObjectsAtResourcePath:@"/syncGames" usingBlock:^(RKObjectLoader *loader) {
    loader.method = RKRequestMethodPOST;
    loader.params = params;
    loader.delegate = self;
}]; 
```

# iphone - ViewController 在 iOS6 上不旋转

> ID：12713993
> 
> 赞同：0
> 
> 时间：2012-10-03T17:47:06.967
> 
> 标签：iphone, objective-c, ios, xcode, rotation

我的大部分应用程序不支持轮换。在支持的方向上，我只选择了肖像。在应用程序使用的 UIViewController 子类上，我有这个：

```
-(BOOL)shouldAutorotate {
    return NO;
}

-(NSUInteger)supportedInterfaceOrientations {
    NSLog(@"supported?");
    return UIInterfaceOrientationMaskPortrait;
}

-(UIInterfaceOrientation)preferredInterfaceOrientationForPresentation {

    NSLog(@"preferred");
    return UIInterfaceOrientationPortrait;
} 
```

在支持方向的 UIViewController 子类中，我有这个：

```
-(BOOL)shouldAutorotate {
    return YES;
}

-(NSUInteger)supportedInterfaceOrientations {
    NSLog(@"supported?");
    return UIInterfaceOrientationMaskAll;
}

-(UIInterfaceOrientation)preferredInterfaceOrientationForPresentation {

    NSLog(@"preferred");
    return UIInterfaceOrientationPortrait;
} 
```

但是，我的应用程序不会在任何视图上旋转，包括这个。如何让它按照我的意愿在这里旋转？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T17:59:34.220

如果您使用的是导航控制器，请确保在您的 App Delegate 中执行此操作：

`self.window.rootViewController = self.navigationController;`

有关其他参考资料，请从 SO 检查此问题：

[旋转在 iOS6 上表现不同](https://stackoverflow.com/questions/12536645/rotation-behaving-differently-on-ios6/12536787#12536787)

# c++ - 以 10 为基数到 n 基数的转换

> ID：12713999
> 
> 赞同：16
> 
> 时间：2012-10-03T17:47:48.183
> 
> 标签：c++, algorithm, base-conversion

我正在尝试编写一个进行基本转换的 C++ 程序。

我想将十进制数转换为从 2 到 20 的所有其他整数基数。

是否有一种高效且易于实现的基本转换算法？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-10-03T17:53:55.823

我不明白问题到底出在哪里？进行基本转换非常简单直接：您可以像手动一样进行。

*   将*数字*除以*基数*
*   写下余数
*   用除法的整数部分重复该过程
*   当你到达零时停止
*   以相反顺序的余数为您提供*基数*

例子：

1025（十进制）以 15 为底：

```
1025 / 15 = 68 , remainder 5
68   / 15 =  4 , remainder 8
4    / 15 =  0 , remainder 4 
```

以 15 为底的数字是 485

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T17:54:50.940

你可能有两个问题：

*   从原始基数解析为计算机的本机整数表示（`strtol`在这方面非常擅长）。

*   格式化到新的基地。（`itoa`很擅长这个）。

如果你想自己写，你可能会喜欢这个[`div`函数](http://linux.die.net/man/3/div)。你输入数字和基数，它会从最右边的数字中分离出来。重复以获取所有数字。

如果你想更有效率，你可以除以基数的平方，一次得到两个数字（使用查找表来获取两个数字的 ASCII 字符）。 [这是一些非常有效的实现的示例。](https://stackoverflow.com/questions/4351371/c-performance-challenge-integer-to-stdstring-conversion) 改变它以使用不同的基地并不困难。