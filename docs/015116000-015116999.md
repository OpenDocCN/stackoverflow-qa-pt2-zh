# StackOverflow 问答 15116000-15116999

# forms - 将参数传递给 VFP 9 表单

> ID：15116003
> 
> 赞同：0
> 
> 时间：2013-02-27T15:34:56.153
> 
> 标签：forms, visual-foxpro

我在 VFP 9 中有一个表单，通常从另一个带有 2 个参数的表单调用。我发生了一件奇怪的事情：当我`DO FORM jobless_add`在命令窗口中执行时，第一个参数总是设置为“2”，而没有添加任何参数。

结果，我有`EMPTY(par1) == false`和`EMPTY(par2) == true`。之后，我尝试以正常方式打开表单（从另一个表单的按钮单击 2 个参数），我得到了这个结果`debugger`

这是我第一次访问，所以我不能插入图像。链接：[图片](http://img29.imageshack.us/img29/8378/22323i.png) *（提示：本地人：一切正常，手表：又是“2”）*

注意：我还没有全局变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:50:23.643

您很可能有一个包含名为“jobless_id”的字段/列的表。

为了进一步澄清，如果您仅引用不合格的字段名称，则表的字段优先于内存变量。尝试使用“m.jobless_id”显式引用变量（即参数）。

# facebook-like - Facebook 的“赞”按钮无法正常工作

> ID：15116004
> 
> 赞同：1
> 
> 时间：2013-02-27T15:34:58.607
> 
> 标签：facebook-like

我知道关于这个主题有很多线程；我全部阅读了（我认为），但没有一个能解决我的问题，所以这里是：我想要一个 facebook 的“喜欢”按钮 om 我的网站；邀请喜欢者添加评论的那种。它工作“有点”，但不是我期望的方式。我使用一个特殊的 fb-account 进行测试，发现：

*   我“喜欢”我的网页的事实显示在“操作”下，但不在“喜欢”下。

*   “评论”丢失（未发布）。因此，“喜欢”不会出现在时间线中。（从 FB 的文档中，我收集到只有在添加评论时才会在时间线上发布“喜欢”。事实上，当我点击其他网站上的“喜欢”按钮并添加评论时，它似乎是这样工作的。）因此，它也没有出现在我的“朋友”的“新闻源”上。

我做错了什么？

*   当然，我使用 FB 调试器（“linter”）来确保我的网页通过了所有测试。

*   我使用了 iFrame 版本以及按钮的 javascript 版本，但这似乎没有什么区别。

*   我使用了由 fb 自己的代码生成器（即使用 javascript 的 xdbml 版本）生成的代码，以及来自其他代码生成器的 iFrame 代码。最后，我从另一个网站复制了确切的 iFrame 代码，它确实按预期工作（即：点赞动作显示在时间线中并带有提供的评论，并且“点赞”被添加到我的“点赞”集中。）我只是用我自己的 URL 替换了 URL，注意它是正确的 url 编码的。但是这段代码，虽然显然适用于其他人，但不适用于我：我得到了同样令人失望的结果。

实际上，还有另一个区别：当我在 facebook 中单击我“喜欢”的某个其他网站的链接时，我会立即被带到那个网站和我“喜欢”的页面。但是当我点击我自己网站的链接时，我首先会得到一个“警告”对话框，告诉我点击链接的危险。对于我的一生，我无法理解为什么会出现这些行为差异。

提示有问题可能是（？）在我的网站上，当单击按钮后出现“评论框”时，单击“发布”时它不会关闭；相反，该框一直可见，直到我单击“关闭”。这是我使用的代码：

元标签：

```
<meta property="og:title" content="Modern soefisme - Modern Sufism" />
<meta property="og:description" content="Home Page of Mabel van Asperen, devoted to sufism,  sufi acivities and sufi literature" />
<meta property="og:type" content="non_profit" />
<meta property="og:url" content="http://www.phlogiston.nl/speeltuin/" />
<meta property="og:image" content="http://www.phlogiston.nl/speeltuin/images/hearts_with_wings.jpg" />
<meta property="og:site_name" content="Sufi Stuff" />
<meta property="fb:admins" content="100000985117039" />
<meta property="og:locale" content="en_US" /> 
```

iFrame：

```
<iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww%2Ephlogiston%2Enl%2Fspeeltuin%2F&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light&amp;height=80" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100%; height:80px;" allowTransparency="true"></iframe> 
```

xfbml 版本：

```
<script Language="javascript">
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/nl_NL/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-like" data-href="http://www.phlogiston.nl/speeltuin/" data-send="true" data-width="450" data-show-faces="false"></div> 
```

任何人都可以对此有所了解吗？我将不胜感激，因为“每个人”似乎都能做出功能良好的点赞按钮，但我却做不到。（而且我也厌倦了“实验”似乎如此困难的事实：在单击“赞”按钮后，我无法再次使用它。因此，每次尝试我都必须制作一个新网页。或者有人知道更好的方法吗？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-20T23:31:07.350

我不确定这是否能解决您的问题，但尝试将 iframe 中的溢出 css 值更改为隐藏以外的其他值。

[类似插件](https://developers.facebook.com/docs/reference/plugins/like/)的facebook 参考说明：

> 当我单击“赞”按钮时，不会显示弹出窗口（或“弹出窗口”）。为什么？
> 
> 如果将 Like 按钮放置在 HTML 元素的边缘附近，并且溢出属性设置为隐藏，则单击按钮时弹出按钮可能会被剪裁或完全隐藏。这可以通过将溢出属性设置为隐藏以外的值来解决，例如可见、滚动或自动。

至于“不喜欢”您的点赞按钮，很难看到，但如果您将鼠标光标移动到点赞按钮的左侧，则会出现一个灰色的“x”。

![将出现一个灰色的“x”。](../Images/4297429b49ac4a6da518a7ec687e6acc.png)

单击它，您将与众不同。

希望有帮助！

我也很难过，所以你并不孤单！我似乎无法从允许我在我的提要中共享链接的“喜欢”按钮弹出窗口。我不断收到此“未知 RPC 服务：小部件交互”错误。希望它更容易。

# matlab - 我想使用 MATLAB fft2 函数进行电磁波传播

> ID：15116011
> 
> 赞同：2
> 
> 时间：2013-02-27T15:35:13.587
> 
> 标签：matlab, fft, ifft

我想通过以下方式进行 EM（电磁）波传播

1.  在平面 z==d 中找到场傅里叶变换， `A = fft2(F(x,y,d))`
2.  PS（相移 `kz = k^2 -(kx^2+ky^2)`）`kx = 2*pi*1/dx ,ky = 2*pi*1/dy`
3.  `C = IFFT2(A*EXP(i*PS)`

但我没有得到预期的结果，我认为我混淆了 FFT 输出排列和我定义 kx 和 ky 排列的方式

任何线索表示赞赏。

流程图如下： 1.计算 z==d 上的字段

2.对 z ==d =====> F(Kx,Ky,d) 处的场进行傅里叶二维变换，其中 ,

```
 kx = 2*pi*fx , fx = 1/dx
 ky = 2*pi*fy , fy =1/dy
 kz = k^2 – (kx^2+ky^2) 
```

3.当 d1 >d 时，对 @ Z == d1 进行逆傅立叶变换，`(F(Kx,Ky,d)*exp(i*kz*(Z-d)))` 以找到 z == d1 中的总场 这发生在 z = d1,d1,…..,dn

但是，我对 fft 输出的频率安排以及我定义空间频率（kx 和 Ky）的方式感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T20:12:11.793

看来您正在通过弗劳恩霍夫近似传播波？虽然我不确定您的输出是什么样子，但 FFT 通常会“拆分”所需信号，使其一半在窗口右侧，另一半在左侧。

尝试使用：

```
fftshift(fft(yourstuff)); 
```

请务必阅读`fftshift`MATLAB 中的帮助条目。

如果幅度有问题，请记住正确归一化 FFT（除以最大值 bin）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T19:56:46.447

您是否检查过您之前是否使用过 i 变量（例如在 for 循环中？）有时它会被覆盖...（在您使用 j 或普通 sqrt(-1) 的情况下）

# angularjs - AngularJS中范围和数字输入的双向绑定

> ID：15116017
> 
> 赞同：17
> 
> 时间：2013-02-27T15:35:35.870
> 
> 标签：angularjs

我刚刚开始使用 AngularJS 并试图了解绑定技术。对于初学者，我尝试制作一个简单的转换计算器（几十到几，几到几十）。效果很好，但是当我尝试将**范围**输入和**数字**输入绑定到同一个模型属性时，调整**范围**值时**数字**输入不会更新。我有一个显示行为的 jsfiddle：

 **用于损坏和工作小提琴的常用javascript：

```
var myApp = angular.module('myApp', []);

myApp.controller('CalcCtrl', function ($scope) {
    var num = 0.0;
    $scope.qty = new Quantity(12);
    $scope.num = num;
});

function Quantity(numOfPcs) {
    var qty = numOfPcs;
    var dozens = numOfPcs / 12;

    this.__defineGetter__("qty", function () {
        return qty;
    });

    this.__defineSetter__("qty", function (val) {
        qty = val;
        dozens = val / 12;
    });

    this.__defineGetter__("dozens", function () {
        return dozens;
    });

    this.__defineSetter__("dozens", function (val) {
        dozens = val;
        qty = val * 12;
    });
} 
```

[断小提琴](http://jsfiddle.net/garethconner/2Pk3M/)

html:

```
<div ng-controller="CalcCtrl">
    <form>
        <label for="pcs">Pieces:</label>
        <input type="number" min="0" ng-model="qty.qty" size="20" id="pcs"
        />
        <input type="range" min="0" max="100" ng-model="qty.qty" />
        <br/>
        <label for="numOfDozens">Dozens</label>
        <input type="number" min="0" ng-model="qty.dozens" size="20"
        id="numOfDozens" />
    </form>
</div> 
```

**但是，将两个数字**输入绑定到同一个模型属性似乎可以正常工作，如下面的小提琴所示：

[工作小提琴](http://jsfiddle.net/garethconner/2Pk3M/1/)

html:

```
<div ng-controller="CalcCtrl">
    <form>
        <label for="pcs">Pieces:</label>
        <input type="number" min="0" ng-model="qty.qty" size="20" id="pcs"
        />
        <input type="number" min="0" max="100" ng-model="qty.qty" />
        <br/>
        <label for="numOfDozens">Dozens</label>
        <input type="number" min="0" ng-model="qty.dozens" size="20"
        id="numOfDozens" />
    </form>
</div> 
```

任何想法如何在AngularJS中获取绑定到单个模型属性的**范围**和**数字输入？**谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-27T16:04:15.567

这里的问题是输入类型=“范围”适用于**字符串**而不适用于**数字**（而输入类型=“数字”仅适用于数字）。

[http://www.w3.org/wiki/HTML/Elements/input/range](http://www.w3.org/wiki/HTML/Elements/input/range)

> 范围状态表示用于将元素的值设置为表示数字的字符串的控件。

如果您在setter上添加`val = parseInt(val)`第一条指令，它应该可以工作：`qty`

```
this.__defineSetter__("qty", function (val) {        
    val = parseInt(val);
    qty = val;
    dozens = val / 12;
}); 
```

**jsfiddle**：http: [//jsfiddle.net/bmleite/2Pk3M/2/](http://jsfiddle.net/bmleite/2Pk3M/2/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-02-06T19:38:52.407

我认为这个解决方案更通用。

```
myApp.directive('input', function() {
return {
    restrict: 'E',
    require: '?ngModel',
    link: function(scope, element, attrs, ngModel) {
        if ('type' in attrs && attrs.type.toLowerCase() === 'range') {
            ngModel.$parsers.push(parseFloat);
        }
    }
}; 
```

});

[完整的解释](https://liamnewmarch.co.uk/input-range-angular/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-20T10:14:12.023

您可以使用`ng-model-options`. 我改变了[jsfiddle](http://jsfiddle.net/qg55y4m4/6/)，这里是代码：

**html**：

```
<div ng-controller="CalcCtrl">
    <form>
        <label for="pcs">Pieces:</label>
        <input type="number" min="0" ng-model="qty.qty" size="20" id="pcs" ng-model-options="{ getterSetter: true }"/>
        <input type="range" min="0" max="100" ng-model="qty.qty" ng-model-options="{ getterSetter: true }"/>
        <br/>
        <label for="numOfDozens">Dozens</label>
        <input type="number" min="0" ng-model="qty.dozens" size="20"
        id="numOfDozens" ng-model-options="{ getterSetter: true }"/>
    </form>
</div> 
```

**js**：

```
var myApp = angular.module('myApp', []);

myApp.controller('CalcCtrl', function ($scope) {
    var num = 1.0;
    $scope.qty = {
    qty:function (val) {
        return arguments.length ? (num = parseFloat(val)) : num;
     }, 
     dozens: function (val) {
            return arguments.length ? (num = val*12) : num/12;
        }
     };
}); 
```**

# vb.net - 动态创建的按钮上的 VB.NET 右键单击 事件

> ID：15116020
> 
> 赞同：1
> 
> 时间：2013-02-27T15:35:40.307
> 
> 标签：vb.net, events

类似于：[在点击事件中获取按钮的 ID/名称。VB.NET](https://stackoverflow.com/questions/14566156/get-the-id-name-of-a-button-in-a-click-event-vb-net) ?

我正在寻找是否在鼠标上单击了左键或右键。我已经声明了一个包含按钮的块类。我已经为按钮点击分配了一个事件：

```
Class Block
  Public X As Integer
  Public Y As Integer
  Public type As String
  Public status As String
  Public text As String
  Public WithEvents button As Button

  Private Sub btnReveal_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles button.Click
  ....
  ....
  End Sub 
```

这很好用，但是当我尝试使用右键单击时：

```
 If e.Button = MouseButtons.Right Then
        MessageBox.Show("RH click")
    Else
        button.Text = text
        button.BackColor = Color.LightGray
    End If 
```

它抱怨 e.Button: Button 不是 System.EventArgs 的成员

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T15:40:49.603

处理[MouseUp](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseup.aspx)或[MouseDown](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mousedown.aspx)事件。他们通过`MouseEventArgs`.

# jquery - Jquery Animate 菜单向下

> ID：15116021
> 
> 赞同：0
> 
> 时间：2013-02-27T15:35:53.627
> 
> 标签：jquery, css, menu, jquery-animate, rollover

我正在开发一个 css jquery 菜单。我有一个像这样的代码[http://jsfiddle.net/A6rUG/](http://jsfiddle.net/A6rUG/)并试图动画下来而不是向上。代码是 var slideNav = (function() {

```
 var spanHeight,
        nav = $('#nav'),
        lis = $('li', nav),
        anchors = $('a', lis).css('padding', 0);

    $.each(anchors, function() {
        var a = $(this),
            val = a.text();

        a.html('<span>' + val + '</span> <span>' + val + '</span>')
         .parent('li')
            .height(a.children('span:first').outerHeight())
         .end()
         .children('span:first')
            .css('marginTop', 0) // strange for IE
    });

    spanHeight = lis.eq(0).height();

    lis.hover(function() {
        $(this).find('span:first').animate({
            marginTop : -56
        }, { duration: 200, queue : false });
            }, function() {
        $(this).find('span:first').animate({
            marginTop : 0
        }, { duration: 200, queue: false });
    });

})(); 
```

更改 marginTop 或 marginBottom 似乎并没有解决问题。有人知道会怎样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:39:07.887

```
marginTop : "56px" 
```

但是您必须更改其他代码以将悬停链接`BEFORE`实际`<a>`放在 DOM 中，而不是之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:55:41.637

这应该可以解决问题：

```
var slideNav = (function() {

    var spanHeight,
        nav = $('#nav'),
        lis = $('li', nav),
        anchors = $('a', lis).css('padding', 0);

    $.each(anchors, function() {
        var a = $(this),
            val = a.text();

        a.html('<span>' + val + '</span> <span>' + val + '</span>')
         .parent('li')
            .height(a.children('span:first').outerHeight())
         .end()
         .children('span:first')
            .css('marginTop', -56) // strange for IE
    });

    spanHeight = lis.eq(0).height();

    lis.hover(function() {
        $(this).find('span:first').animate({
            marginTop : 0
        }, { duration: 200, queue : false });
            }, function() {
        $(this).find('span:first').animate({
            marginTop : -56
        }, { duration: 200, queue: false });
    });

})(); 
```

和 CSS：

```
body {
     text-align: center;
     background: #676767;
     font-family: helvetica;
    }

    ul, li {
     margin: 0; padding: 0;
     overflow: hidden;
    }

    ul li {
     float: left;
     list-style: none;
     margin-right: 1em; 
     position: relative; /* IE fix */
    }

    li a {
     color: white;
     text-decoration: none;
     float: left;
     font-size: 30px;
     background: black;
     padding: 10px;
    }

    li a:hover {
     background: #ff0;
    color:white;
    }

    /* if JS */

    li a span {
        display: block;
        background: white;
        color: maroon;
        padding: 10px;
        position: relative;
        font-weight: bold;
    }

    li a span:last-child {
        background: black;
        color: white;
    } 
```

# internet-explorer-8 - IE 8 中的缩放和选择元素

> ID：15116023
> 
> 赞同：1
> 
> 时间：2013-02-27T15:35:59.307
> 
> 标签：internet-explorer-8, ie8-compatibility-mode

这段代码：

```
<select>
    <OPTION value="Aston Martin">Aston Martin</OPTION>
    <OPTION value="Alfa Romeo">Alfa Romeo</OPTION>
    <OPTION value="Volkswagen">Volkswagen</OPTION>
</select> 
```

...呈现：

![在此处输入图像描述](../Images/45b7c3de31c0f1bc8d304c1cee3dad68.png)

如果你使用 IE8 并按 ctrl + '+' 三次放大你会得到这个：

![在此处输入图像描述](../Images/9c742c6354c22771cd5e0e9923260ad4.png)

该框未调整大小。如果您让 IE8 进入“兼容性视图”，它会增大框（但在缩小时，它不会缩小框...）。

有没有办法不必进入兼容性视图并且仍然让框在缩放时自行调整大小？兼容性视图带来了一些其他问题......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:42:42.147

是的，为 IE8 用户提供以下链接：[http ://browsehappy.com/](http://browsehappy.com/)

# php - CutyCapt 与 php 执行

> ID：15116030
> 
> 赞同：5
> 
> 时间：2013-02-27T15:36:11.347
> 
> 标签：php, cutycapt

我在我的 CentOS 上使用 CutyCapt。它可以通过终端正常工作，但不能通过 php exec 函数工作。我已经在终端中通过命令启动了 xvfb：

```
Xvfb :99 -screen 0 1024x768x24 
```

我正在尝试通过 php 脚本进行屏幕截图：

```
exec("DISPLAY=:99 /path/to/cutycapt --url=<some url> --out=<path/to/output>"); 
```

它没有显示任何错误，但没有输出文件（输出目录有 chmod 777） 有人可以帮助我吗？

谢谢

**UPD：** 也许允许 Apache 执行 Xvfb 会更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T18:03:36.860

最后，我设法让 CutyCapt 使用 php 成功运行。$_parameters 通过 AJAX 传递给 php 脚本。希望这可以帮助...

```
 case 'Output_Chart': {

    // We always create the .png.  We use the  ImageMagick convert (IMC) command to make .pdfs
    if ($_Suffix == 'pdf') {
       $IMC = ";convert -page 735x850 '$_PathOut/$_ChartName.png' '$_PathOut/$_ChartName.pdf'";
    } else {
       $IMC = '';
    }

    // Prepare the query string for the CutyCapt URL
    $sQuery_Pattern   = '?Path=%s&iDL=%d';
    $sQuery           = sprintf($sQuery_Pattern, $_Path, $_iDL);

    // Prepare CutyCapt's command and parameters (NB: query string and out parameter are enclosed in aposts for the shell)
    $sCC_Cmd          = '/var/www/LF/Includes/CutyCapt';
    $sCC_URL          = "http://localhost/LF/LFPrint.html'$sQuery'";     // Note: Inner apostrophes
    $sCC_Out          = "'$_PathOut/$_ChartName.png'";
    $sCC_Pattern      = ' --url=%s --out=%s --delay=%d --min-width=%d';
    $sCC_Options      = sprintf($sCC_Pattern, $sCC_URL, $sCC_Out, $_Delay, $_MinWidth);
    //$sCC_CmdLine         = $sCC_Cmd . $sCC_Options . " 2> CutyCapt.err.txt";
    $sCC_CmdLine         = $sCC_Cmd . $sCC_Options . " 2> /dev/null";

    // Prepare the final command line with xvfb-run, CutyCapt, and the URL?QueryString
    $sCC_CmdLine = 'xvfb-run --auto-servernum --server-args="-screen 0, 800x1000x24" ' . $sCC_CmdLine . $IMC;
    exec( $sCC_CmdLine, $aOutput = array(), $ret);
    // Wait for and then return the results.  sCC_CmdLine and aOutput are just for debugging
    echo json_encode(array("ret" => $ret, "cmd" => $sCC_CmdLine, "Output" => $aOutput));
    break;
 } 
```

# c# - RollingFileAppender 有时我的服务会停止生成日志文件并停止写入日志文件

> ID：15116031
> 
> 赞同：1
> 
> 时间：2013-02-27T15:36:16.497
> 
> 标签：c#, log4net

我使用 RollingFileAppender，但遇到了一个奇怪的问题：有时我的服务会停止生成日志文件，并且如果文本编辑器打开它，则会停止写入日志文件。

我做错了什么？

这是我如何配置

```
PatternLayout layout = new PatternLayout
    {ConversionPattern = "%date %-5level [%logger] [%-4thread]: %exception%message%newline"};
layout.ActivateOptions();
RollingFileAppender fileAppender = new RollingFileAppender {
   AppendToFile = append,
   File = traceFileName,
   MaxSizeRollBackups = maxSizeRollBackups,
   DatePattern = "_dd.MM.yyyy",
   LockingModel = new FileAppender.MinimalLock(),
  Layout = layout,
  RollingStyle = RollingFileAppender.RollingMode.Date,
};
fileAppender.ActivateOptions();
log4net.Config.BasicConfigurator.Configure(fileAppender); 
```

# google-app-engine - 为什么此 JPA 代码不更新 AppEngine 本地数据存储中的实体？

> ID：15116034
> 
> 赞同：2
> 
> 时间：2013-02-27T15:36:37.107
> 
> 标签：google-app-engine, jpa

所以我有下面的实体和下面的代码来创建和更新对象。调用该方法后的结果数据是该字段`Value`的值`1`在我本地计算机上运行的 Datastore 中。为什么？对象不是由 JPA 管理（或按[本文所述](http://www.datadisk.co.uk/html_docs/ejb/ejb3_manipulating.htm)*附加*）并且应该在其上进行自我更新吗？`em2.close()`

**实体：**

```
@Entity 
public class MyObj {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    public Long Id;
    public int Value = 0;
} 
```

**代码：**

```
public void createAndUpdate() {
    Long id = null;
    // Line below calls Persistence.createEntityManagerFactory("transactions-optional").createEntityManager()
    EntityManager em1 = Database.getEntityManager(); 
    MyObj obj = new MyObj();
    obj.Value = 1;      
    em1.persist(obj);
    em1.close();
    id = obj.Id;

    EntityManager em2 = Database.getEntityManager();
    obj = (MyObj) em2.find(MyObj.class, id);
    obj.Value = 2;
    // NOTE1
    em2.close();        
} 
```

在标记的行上，`NOTE1`我尝试插入 `em2.persist(obj)`and `em2.merge(obj)`（即使从我读过的内容来看，这不应该是必要的，因为`find()`返回了一个*附加*的对象）。他们都没有帮助。

我正在使用 JPA v1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:42:47.833

正如 JPA 规范所说，**您不能直接更新 Entity objects 的字段**，但是在您发布的代码中您就是这样做的（因此持久性提供程序无法知道某些内容已更改，因此无法将这些更改刷新到数据存储区）。

**如果您将执行此操作的类增强为“PersistenceAware”，**[DataNucleus JPA](http://www.datanucleus.org/products/accessplatform.html)实际上确实允许您直接更新该字段。

 **解决方案：使用 setter 更新字段**

# c# - 数据库表中的并发读取和更新

> ID：15116042
> 
> 赞同：5
> 
> 时间：2013-02-27T15:36:51.003
> 
> 标签：c#, oracle, entity-framework, transactions, devart

我有一个使用 Devart 和实体框架访问的 Oracle 数据库。

有一个名为`IMPORTJOBS`column的表`STATUS`。

我也有多个进程同时运行。`IMPORTJOBS`他们每个人都读取具有状态的第一行`'REGISTERED'`，将其置于状态`'EXECUTING'`，如果完成则将其置于状态`'EXECUTED'`。

现在因为这些进程是并行运行的，我相信可能会发生以下情况：

*   进程 A 读取具有状态的第 10 行`REGISTERED`，
*   进程 B 还读取第 10 行，它仍然有状态`REGISTERED`，
*   进程 A 将第 10 行更新为 status `EXECUTING`。

进程 B 不应该能够读取第 10 行，因为进程 A 已经读取了它并且将要更新其状态。

我应该如何解决这个问题？将读取和更新放入事务中？还是我应该使用一些版本控制方法或其他方法？

谢谢！

编辑：感谢接受的答案，我得到了它的工作并在此处记录：http: [//ludwigstuyck.wordpress.com/2013/02/28/concurrent-reading-and-writing-in-an-oracle-database](http://ludwigstuyck.wordpress.com/2013/02/28/concurrent-reading-and-writing-in-an-oracle-database)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:01:37.833

`SELECT ... FOR UPDATE`每个进程在读取行时都可以发出一个来锁定行。在这种情况下，进程 A 将读取并锁定该行，进程 B 将尝试读取该行并阻塞，直到进程 A 通过提交（或回滚）其事务来释放锁定。然后，Oracle 将确定该行是否仍符合 B 的标准，并且在您的示例中，不会将该行返回给 B。这有效，但这意味着您的多线程进程现在可能是有效的单线程，具体取决于您的事务控制方式需要工作。

提高可扩展性的可能方法

*   消费者解决此问题的一种相对常见的方法是拥有一个协调线程，该线程从表中读取数据，将工作分配给不同的线程，并适当地更新表（包括如果线程知道如何重新分配工作）被分配的它已经死了）。
*   如果您使用的是 Oracle 11.1 或更高版本，您可以在您的上使用该[`SKIP LOCKED`子句](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:2060739900346201280)`FOR UPDATE`，以便每个会话取回满足其条件且未锁定的第一行（该子句存在于早期版本中但未记录，因此它可能无法正常工作）。
*   `ImportJobs`您可以使用具有多个消费者的队列，而不是使用表。这将允许 Oracle 将消息分发到每个进程，而无需构建任何额外的锁定（Oracle 队列在幕后完成这一切）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T16:10:38.870

您应该使用数据库的内置锁定机制。不要重新发明轮子，尤其是因为 RDBMS**旨在**处理并发性和一致性。

在 Oracle 11g 中，我建议您使用该[`SKIP LOCKED`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10002.htm#SQLRF55374)功能。例如，每个进程都可以调用这样的函数（假设`id`是数字）：

```
CREATE OR REPLACE TYPE tab_number IS TABLE OF NUMBER;

CREATE OR REPLACE FUNCTION reserve_jobs RETURN tab_number IS
   CURSOR c IS 
      SELECT id FROM IMPORTJOBS WHERE STATUS = 'REGISTERED'
      FOR UPDATE SKIP LOCKED;
   l_result tab_number := tab_number();
   l_id number;
BEGIN
   OPEN c;
   FOR i IN 1..10 LOOP
      FETCH c INTO l_id;
      EXIT WHEN c%NOTFOUND;
      l_result.extend;
      l_result(l_result.size) := l_id;
   END LOOP;
   CLOSE c;
   RETURN l_result;
END; 
```

这将返回未锁定的 10 行（如果可能）。这些行将被锁定，会话不会相互阻塞。

在 10g 及之前的版本中，由于 Oracle 返回一致的结果，`FOR UPDATE`请明智地使用，您应该不会遇到您描述的问题。例如考虑以下内容`SELECT`：

```
SELECT *
  FROM IMPORTJOBS 
 WHERE STATUS = 'REGISTERED'
   AND rownum <= 10
FOR UPDATE; 
```

如果所有进程都用这个 SELECT 保留它们的行，会发生什么？这将如何影响您的方案：

1.  会话 A 获得 10 行未处理。
2.  会话 B 将获得相同的 10 行，被阻塞并等待会话 A。
3.  会话 A 更新选定行的状态并提交其事务。
4.  Oracle 现在将（自动）从头开始重新运行会话 B 的选择，因为数据已被修改并且我们已指定`FOR UPDATE`（此子句强制 Oracle 获取块的最后一个版本）。
    这意味着会话 B 将获得 10 个**新行**。

所以在这种情况下，你没有一致性问题。此外，假设请求一行并更改其状态的事务很快，并发影响将很小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T16:02:19.370

使用[版本控制和乐观并发](http://blogs.msdn.com/b/alexj/archive/2009/05/20/tip-19-how-to-use-optimistic-concurrency-in-the-entity-framework.aspx)。

该`IMPORTJOBS`表应该有一个时间戳列，您在模型中将其标记为`ConcurrencyMode`= `Fixed`。现在，当 EF 尝试进行更新时，时间戳列将合并到更新语句中：`WHERE timestamp = xxxxx`.

对于`B`，时间戳同时发生了变化，因此引发了并发异常，在这种情况下，您可以通过跳过更新来处理。

我来自 SQL 服务器背景，我不知道时间戳（或行版本）的 Oracle 等效项，但我的想法是它是一个在对记录进行更新时自动更新的字段。

# asp.net-mvc - 带有 WCF 的 MVC 4 中的自定义更新方法

> ID：15116046
> 
> 赞同：1
> 
> 时间：2013-02-27T15:37:01.380
> 
> 标签：asp.net-mvc, wcf, controller, updates

我是 MVC 的新手，目前在我的 Web 项目中使用 MVC 4 + EF Code First 和 WCF。基本上，在我的项目中，WCF 服务会为我从数据库中获取数据，它也会负责更新数据。结果，当我完成更新记录时，我必须调用服务客户端来为我进行更改，而不是“传统”MVC 方式。这是我的示例代码：

模型：

```
[DataContract]
public class Person
{
    [Key]
    [DataMember]
    public int ID{ get; set; }

    [DataMember]
    public string Name{ get; set; }

    [DataMember]
    public string Gender{ get; set; }

    [DataMember]
    public DateTime Birthday{ get; set; }
} 
```

控制器：

```
 [HttpPost]
    public ActionResult Detail(int ID, string name, string gender, DateTime birthday)
    {
        // get the WCF proxy
        var personClient = personProxy.GetpersonSvcClient();

        //update the info for a person based on ID, return true or false
        var result = personClient.Updateperson(ID, name, gender, birthday);

        if (result)
        {
            return RedirectToAction("Index");
        }
        else
        {
            //if failed, stay in the detail page of the person
            return View();
        }
    } 
```

看法：

```
@model Domain.person

@{
    ViewBag.Title = "Detail";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Detail</h2>
@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

<fieldset>
    <legend>Person</legend>

    @Html.HiddenFor(model => model.ID)

    <div class="editor-label">
        @Html.LabelFor(model => model.Name)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Name)
        @Html.ValidationMessageFor(model => model.Name)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Gender)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Gender)
        @Html.ValidationMessageFor(model => model.Gender)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Birthday)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Birthday)
        @Html.ValidationMessageFor(model => model.Birthday)
    </div>
    <p>
        <input type="submit" value="Update"/>
    </p>
</fieldset>

}

<div>
    @Html.ActionLink("Back to List", "Index")
</div> 
```

控制器是我感到困惑的部分。Detail 函数有多个参数，如何从 View 调用它？另外，我应该在控制器的这个返回字段中输入什么：

```
//if failed, stay in the detail page of the person
return View(); 
```

我们通常将模型放入，但模型似乎没有改变，因为我是直接从我的 WCF 服务更新数据库。

任何建议将不胜感激！

**更新：** 我知道我可以通过将更新方法更改为仅采用模型本身的一个参数来使其工作，但这不是我的项目中的一个选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:56:38.663

表单将调用控制器中的 post 方法，该方法与提交时呈现视图的 get 方法同名。

`BeginForm`您可以通过在方法中指定参数来更改此默认行为

```
@using (Html.BeginForm("SomeAction", "SomeController")) 
```

此外，您使用的是强类型视图（很好！），因此您可以更改 post 方法的签名以接受模型对象

```
 [HttpPost]
 public ActionResult Detail(Person person) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:44:04.253

当您点击“更新”时，您在控制器中调用详细信息操作

//旁注：在你的函数中使用单个参数来接受它使生活更轻松的值

# java - Notify 和 NotifyAll 仅影响处于阻塞状态的线程

> ID：15116049
> 
> 赞同：0
> 
> 时间：2013-02-27T15:37:13.560
> 
> 标签：java, multithreading

![在此处输入图像描述](../Images/c3fbb599e8e4df7c241e94c656bb0388.png)

我的理解是当我们调用object.notify（一个线程）和object.notifyAll（所有线程）时，处于阻塞状态的线程会被通知。

可运行状态线程没有收到任何通知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:42:50.383

> 正在通知处于阻塞状态的线程。

有点。 `notify`唤醒处于[WAITING](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.State.html#WAITING)状态的线程。

然后通知将他们置于[BLOCKED](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.State.html#BLOCKED)状态，直到他们可以获取他们正在等待的对象监视器。在初始调用时已被 BLOCKED 的对象`synchronized`不受影响。

RUNNABLE 线程不会被通知，因为它们没有在监视器上等待。

# python - 在 while 循环中使用迭代器

> ID：15116051
> 
> 赞同：0
> 
> 时间：2013-02-27T15:37:16.090
> 
> 标签：python

我有一个函数`foo()`可以清空项目队列，NB，而不是 Queue()，只是项目列表。`False`如果列表为空，则该函数返回。使用`while`循环重复调用这个函数有什么缺点吗？简单地`pass`在循环体中似乎有点不对劲。前任：

```
while foo():
    pass 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:47:20.483

这种形式可能更容易理解：

```
while items:
    foo() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:08:11.367

`all(foo())`将消耗来自迭代器的项目，直到它接收到错误值（或直到迭代器耗尽）。

# c - C 中 send(),recv() 的一些 EOF 机制

> ID：15116053
> 
> 赞同：2
> 
> 时间：2013-02-27T15:37:26.370
> 
> 标签：c, sockets

我想知道，如果我用 C 编写的客户端执行 4 次 send()，我的服务器是否需要 read() 4 次，还是第一次读取会一起读取所有 4 个 send()？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T15:49:24.027

为了帮助你一点，你基本上已经回答了你自己的问题。

可以这么说，您需要“分层”进行。

客户：

```
int len = strlen(Filename) + 1; //Mind the terminating 0.
send(sock, (const char *)&len, sizeof(int), 0);
send(sock, Filename, len, 0);  //Sending the filename
send(sock, &FileSize, sizeof(int), 0);
send(sock, FileBuf, FileSize, 0); 
```

此代码将在途中发送整个数据（假设整个文件在“FileBuf”-Variable 中）。

服务器：

```
int len;
char *FileBuf, FileName[20];
recv(sock, &len, sizeof(int), 0);  //Receives the filename length. (4 Bytes)
recv(sock, FileName, len, 0);      //Receives the filename (x bytes)
recv(sock, &len, sizeof(int), 0);  //Receives the file length (again, 4 bytes)
FileBuf = new char[len];           //Creates sufficient space in memory.
recv(sock, FileBuf, len, 0);       //Receives the file into the appropriate variable. 
```

这是绝对的准系统变体，不是很可靠，但你应该明白。

更强大的方法需要您检查 recv() 和 send() 的返回值。两者都将返回已使用此调用处理的字节数。如果此数量等于“0”，则表示连接已被另一端关闭。（主要用于`recv()`）。如果它等于 -1，则意味着出现问题，您应该检查`errno`变量。

如果一切顺利，它等于您发送/尝试接收的确切字节数。

但是，如果它不是“len”（或 0 或 -1），您可以编写一个像这样的小包装器。

```
unsigned char Recv(int sock, void *target, int Len) {
    unsigned char *ptr = (unsigned char *)target, Ret = 0;
    int RecvBytes = 1;
    while(Len && !Ret) {
        RecvBytes = recv(sock, ptr, Len, 0);
        if(!RecvBytes) Ret = 1;
        else if(RecvBytes == -1) Ret = errno;
        else {
            Len -= RecvBytes;
            ptr += RecvBytes;
        }
    }
    return Ret;
} 
```

这段代码的作用：它一直在接收，直到您收到您期望的所有数据（`Len`参数）或发生错误。如果一切顺利，它会返回“0”，您可以使用`if(!Recv())`.

另一个有用的包装函数（可以说是一种快捷方式）是这个：

```
uint32_t RecvInt(int sock) {
    uint32_t Ret;
    Recv(sock, &Ret, sizeof(Ret));
    return ntohl(Ret);
} 
```

该函数只接收一个无符号整数并将字节序从网络字节顺序更正为主机字节顺序。（网络字节序总是大端，主机字节序往往是：小端）

使用这些包装函数，可以像这样更改代码：

```
uint32_t len;
char *FileBuf, FileName[20];
len = RecvInt(sock);               //Receives the filename length. (4 Bytes)
Recv(sock, FileName, len);         //Receives the filename (x bytes)
len = RecvInt(sock);               //Receives the file length (again, 4 bytes)
FileBuf = new char[len];           //Creates sufficient space in memory.
Recv(sock, FileBuf, len);          //Receives the file into the appropriate variable. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:44:42.393

**对于流套接字（例如 TCP）** ：在发送端进行多少`send()`或调用没有区别。`write()`数据可以少至一个块，多至 n 个块，每块 1 个字节（其中 n 是发送的字节数），或介于两者之间的任何数据。

**对于数据报套接字（例如 UDP）**：每个`recv()`or`recvmsg()`调用将返回一个从另一端发送的完整数据报。`recv()`or调用的数量`recvmsg()`应该与发送的数据报的数量相同。`recv()`从数据报套接字读取时是首选，但我相信`read()`应该表现相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T15:42:00.007

`write()`s的数量`read()`不必相同 - 有可能`write()`将所有数据写入一个片段，但在另一台计算机上`read()`只能设法以几个块的形式接收它，反之亦然。这就是为什么您应该**始终检查**这些函数的返回值，如果仅发生部分数据传输，则继续发送/接收其余部分。

# php - URL 重写以隐藏 .php 和变量名

> ID：15116057
> 
> 赞同：1
> 
> 时间：2013-02-27T15:37:35.790
> 
> 标签：php, .htaccess, url-rewriting

我最近学习了使用`.htaccess`, 的 URL 重写。作为初学者，这对我来说已成为一项艰巨的任务:(

我可以重写一个特定的 url，比如：

```
RewriteEngine On
RewriteRule    ^nothing/?$    abc.php    [NC,L] 
```

但我对此并不满意，需要你的帮助。

我的 .php 文件保存在一个名为`files`. 所以我有这样的网址：

```
www.mysite.com/files/login.php?lf=student
www.mysite.com/files/login.php?lf=admin
www.mysite.com/files/s_home.php
www.mysite.com/files/recharge.php 
```

我想要的很简单：

```
mysite.com/login
mysite.com/login
mysite.com/s_home
mysite.com/recharge 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:07:34.167

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{DOCUMENT_ROOT}/files/$1.php -f
RewriteRule ^([^/]+)/(.+)/?$ /files/$1.php?lf=$2 [L,QSA]

RewriteCond %{DOCUMENT_ROOT}/files/$1.php -f
RewriteRule ^([^/]+)/?$ /files/$1.php [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:46:14.143

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php 
```

即使这会按照您的要求进行，但您为什么要尝试隐藏`.php`扩展程序？

# sql - 为什么我得到数据库中已经有一个名为“XXX”的对象？

> ID：15116058
> 
> 赞同：0
> 
> 时间：2013-02-27T15:37:41.703
> 
> 标签：sql, sql-server, sql-server-2008

我正在做一些有意义的简单的事情，

```
IF EXISTS(SELECT * FROM sysobjects WHERE xtype = 'TF' AND name = 'GetGeographyFromSourceID')
BEGIN
    DROP FUNCTION dbo.GetGeographyFromSourceID
END
GO

CREATE FUNCTION dbo.GetGeographyFromSourceID
(
    @SourceID INT
)
RETURNS  GEOGRAPHY
AS
BEGIN
    DECLARE @Longitude FLOAT = 0; 
    DECLARE @Latitude FLOAT = 0; 
    DECLARE @Geo GEOGRAPHY;

    SELECT  @Longitude = Longitude, 
            @Latitude = Latitude 
    FROM    Sources 
    WHERE   ID = @SourceID; 

    SELECT @Geo = geography::STGeomFromText('POINT(' + CONVERT(VARCHAR( 100), @Longitude) + ' ' + CONVERT( VARCHAR( 100),@Latitude) + ')', 4326);

    RETURN(@Geo)
END 
```

如果存在，则删除它并重新创建它。但我收到错误`There is already an object named 'XXX' in the database?`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T15:42:16.380

您正在测试数据库中是否存在表值函数，但您描述的函数不返回表。用这个替换代码的第一部分（在开始之前），然后重试：

```
IF EXISTS (
    SELECT * FROM sysobjects WHERE id = object_id(N'GetGeographyFromSourceID') 
    AND xtype IN (N'FN', N'IF', N'TF')
)
    DROP FUNCTION GetGeographyFromSourceID
GO 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T15:42:36.833

看起来它实际上并没有击中您的 DROP FUNCTION 语句，因为您正在检查`xtype = 'TF'`哪个只查找此未尝试的表函数`xtype='FN'`（标量函数）

[MSDN 参考](http://msdn.microsoft.com/en-us/library/ms177596.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-27T15:42:30.770

将其更改为 FN 而不是 TF

```
IF EXISTS(SELECT * FROM sysobjects WHERE xtype = 'FN' AND name = 'GetGeographyFromSourceID')
BEGIN
    DROP FUNCTION dbo.GetGeographyFromSourceID
END
GO

CREATE FUNCTION dbo.GetGeographyFromSourceID
(
    @SourceID INT
)
RETURNS  GEOGRAPHY
AS
BEGIN
    DECLARE @Longitude FLOAT = 0; 
    DECLARE @Latitude FLOAT = 0; 
    DECLARE @Geo GEOGRAPHY;

    SELECT  @Longitude = Longitude, 
            @Latitude = Latitude 
    FROM    Sources 
    WHERE   ID = @SourceID; 

    SELECT @Geo = geography::STGeomFromText('POINT(' + CONVERT(VARCHAR( 100), @Longitude) + ' ' + CONVERT( VARCHAR( 100),@Latitude) + ')', 4326);

    RETURN(@Geo)
END 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T15:55:27.510

我知道这已经得到了回答，但只是为了补充一点。鉴于 SQL 处理对象名称的方式，通常最好不要在使用此类代码时进行检查。创建对象时，它的名称是唯一的，而不是名称+类型的组合。还有一种更简单的检查方法是使用 OBJECT_ID 函数。这是我在主数据库上做的几个例子。

```
IF (OBJECT_ID('sysobjects') IS NOT NULL)
    PRINT OBJECT_ID('sysobjects')

IF (OBJECT_ID('sys.sysobjects') IS NOT NULL)
    PRINT OBJECT_ID('sys.sysobjects')

IF (OBJECT_ID('xyz') IS NOT NULL)
    PRINT OBJECT_ID('xyz') 
```

前两个将评估为 true 并运行打印（给出相同的对象 id），第三个将评估为 false 不运行打印。

# javascript - 我们可以为绝对定位元素指定一个定位元素吗？

> ID：15116060
> 
> 赞同：0
> 
> 时间：2013-02-27T15:37:43.553
> 
> 标签：javascript, html, css, css-position

绝对定位的元素总是相对于它最近的定位祖先定位。我想知道是否有一些方法可以为绝对定位的元素指定参考元素，而不仅仅是最近定位的祖先？（CSS 或 jquery）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:47:16.250

不怕！我敢肯定，很多 UI 开发人员都梦想过使用这样的东西……</p>

```
relative-to: #arbitrary .selector; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:45:50.217

不，你不能。但是仅仅将它添加（/移动）到那个元素呢：

```
$('#absoluteElement').appendTo('#relativeToElement'); 
```

# r - 将数据帧解析为 JSON（通过 RJSONIO）

> ID：15116072
> 
> 赞同：2
> 
> 时间：2013-02-27T15:38:07.973
> 
> 标签：r, rjsonio

我对 RJSONIO 有疑问。我有一个像 df 这样的数据框

```
df <- data.frame(a = c(1:3), b = c(4:6), c = c(7:9) )
df
  a b c
1 1 4 7
2 2 5 8
3 3 6 9 
```

现在我需要的是使用这个数据框并生成以下 JSON 结构中的行。所以最后它看起来像这样：

```
{
"job_id": "1",
"page": "1",
"rows": [
    {
        "row": [
            "1",
            "4",
            "7"
        ]
    },
    {
        "row": [
            "2",
            "5",
            "8"
        ]
    },
    {
        "row": [
            "3",
            "6",
            "9"
        ]
    }
] 
```

}

我从这段代码开始，但数组内的引号有问题（大括号括起来）：

```
rows <- apply(df, 1, function(x) toJSON(list(row = x)) )
toJSON(list("job_id" = "1",  "page" = "1", "rows" = paste(rows) ) ) 
```

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:47:00.283

在这里，您如何创建 JSON 格式。

```
list(job_id = "1", 
   page = "1", 
   rows = lapply(seq(nrow(df)), function(x) list(row=as.character(df[x,]))))

cat(toJSON(ll))
{"job_id": "1",
 "page": "1",
 "rows": [
  {
   "row": [ "1", "4", "7" ] 
  },
  {
   "row": [ "2", "5", "8" ] 
  },
  {
   "row": [ "3", "6", "9" ] 
  } 
 ] 
} 
```

# c++ - 如何清理 WT 中的内存？

> ID：15116077
> 
> 赞同：3
> 
> 时间：2013-02-27T15:38:21.083
> 
> 标签：c++, project-management, persistent-storage, wt

***2013 年 3 月 27 日更新***

看来我没有泄漏内存，只是每次按下 F5 或新用户连接时 WT 都没有保持持久会话。基本上，旧会话被删除，每次按 F5 或新用户从另一台机器连接时都会创建一个新会话。我已经阅读了文档的某些部分，其中提到了使会话持久化，因此当用户重新加载页面或不同的用户连接时，他们都会看到相同的内容。但是，我还不能让它工作。我认为这是 wt_config.xml 文件中的函数调用或设置。如果我取得任何其他进展，将更新。

***原帖***

所以我的问题是，我如何清理 WT 中的内存，以便每次用户在页面上按 F5 时内存使用在任务管理器中保持不变？

好的，所以我正在使用 WT 发音（诙谐），我注意到每次用户在页面上按 F5 刷新它时，我的服务器应用程序都会消耗更多内存，这对我来说看起来像是在泄漏内存，但我遵循与 WT 大多数基本应用程序相同的过程...

所以，我回到了我能找到的最基本的 WT 应用程序，hello 应用程序的代码和工作示例可以在这里找到（[http://www.webtoolkit.eu/wt/examples/](http://www.webtoolkit.eu/wt/examples/)）如果你没有亲自建造过这个项目。

一旦我在我的机器上运行示例并在页面上按 F5，我的任务管理器中的内存就会增加。

我可能怀疑是下面的这个功能。

```
WApplication *createApplication(const WEnvironment& env)
{
  /*
  * You could read information from the environment to decide whether
  * the user has permission to start a new application
  */
  return new HelloApplication(env);
} 
```

每次按下 F5 时都会调用它，并创建一个继承自 WApplication 的 HelloApplication 的新实例。

我试图纠正这种情况但没有奏效的一些事情包括： 为 HelloApplication 保留 2 个指针，以便每次分配新指针时都可以删除旧指针。调用 quit() 函数，并删除指针。只需调用 quit() 函数。我还在 WT 文档站点（[http://www.webtoolkit.eu/wt/doc/reference/html/index.html](http://www.webtoolkit.eu/wt/doc/reference/html/index.html)）上查看了有关该类及其方法的更多详细信息，但还没有提出任何有效的东西。

我要求任何回复的人尽可能详细地说明如何处理内存清理。一个例子将不胜感激，在此先感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-22T13:30:58.153

您还必须知道，从 Wt 3.3.0 开始，只要收到请求，会话才会被清理（参见Wt 开发人员的[此回复](http://redmine.webtoolkit.eu/boards/2/topics/5614?r=5615#message-5615)）。为了克服这个限制，开发人员建议使用类似于以下代码的东西。

```
static bool terminating = false;

void
callRepeatedly(boost::function<void()> function, int seconds)
{
    if (!terminating) {
        Wt::WServer::instance()->ioService().schedule(
            seconds * 1000, boost::bind(callRepeatedly, function, seconds));
    }
    function();
}

int
main(int argc, char** argv)
{
    ...

    callRepeatedly(boost::bind(&Wt::WServer::expireSessions, &server), 60);
    Wt::WServer::waitForShutdown();
    terminating = true;
    server.stop();

    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T13:55:12.530

WApplication 的手册说您在调用 createApplication 回调时创建它，而 Wt 在调用 quit 时以及会话超时时将其删除。默认会话超时为 10 分钟 (wt_config.xml)，因此这可能是您的内存消耗最初在按 F5 时增长的原因。

[http://www.webtoolkit.eu/wt/doc/reference/html/classWt_1_1WApplication.html#details](http://www.webtoolkit.eu/wt/doc/reference/html/classWt_1_1WApplication.html#details)

一些不同的东西可以解释您所看到的：操作系统报告的内存消耗不是确定应用程序是否泄漏内存的可靠方法，[因为 free 并没有真正将内存返回给 OS](https://stackoverflow.com/questions/2215259/will-malloc-implementations-return-free-ed-memory-back-to-the-system)。使用适当的内存检查工具，例如 valgrind。

# arrays - 线程“主”java.lang.NullPointerException 中的异常？这是什么意思？

> ID：15116080
> 
> 赞同：0
> 
> 时间：2013-02-27T15:38:24.567
> 
> 标签：arrays, methods, runtime-error, is-empty

尝试运行此程序时出现错误。这不是整个程序，只是我认为问题所在的几个细节。错误指出

```
if(board[randSpace].isEmpty())  and 
cl.makeChutes(5);" 
```

错误是：

```
"Exception in thread "main" java.lang.NullPointerException
at ChutesAndLadders.makeChutes(ChutesAndLadders.java:29)
at ChutesAndLadders.main(ChutesAndLadders.java:67)" 
```

这是我的程序：

```
import java.util.Random;
public class ChutesAndLadders{

Cell [] board = new Cell [100];
Random rand = new Random ();
public int chutes, ladders;

public void makeChutes (int a ){
    int makeChutes = a;
    for (int i = 0; i < a; i++){
        int randSpace = rand.nextInt(99);
        if(board[randSpace].isEmpty())
            board[randSpace] = new Cell (-10,"C");
        else 
            i--;
    }
}

 public static void main(String[] args) {
 // Create an instance of ChutesAndLadders
 ChutesAndLadders cl = new ChutesAndLadders(10,10);

 // Randomly place 5 more chutes and 5 more ladders
 cl.makeChutes(5);
 cl.makeLadders(5); 
```

这是我的 isEmpty： public boolean isEmpty(){ for(int i = 0; i < board.length; i++) { if (board[i].isEmpty()) return true; } 返回假；}

我的编码可能完全错误。我还在学习中，请耐心等待。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:46:08.687

此行出现问题：

```
if(board[randSpace].isEmpty()) 
```

所以假设randSpace的obect已经存在，如果不是你创建对象（Cell）。但是对象尚未创建，如果为 null ，您如何询问它`isEmpty()`。只需先检查 null

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T04:48:14.597

按照 Dewfy 的说法，board 是一组`Cell`对象。这意味着它是`Cell`对象的占位符——一堆`null`s 等待被 a 替换`Cell`。

如果说，位置 1 ( `board[1]`) 的对象尚未分配`Cell`对象（即您尚未发出类似命令`board[1]=new Cell()`或类似的命令），`board[1]`则为`null`。因此，如果您要问`board[1].isEmpty()`，您会得到 a `NullPointerException`，因为您正在尝试调用`null`对象上的方法。

`board[randSpace]`现在，您的错误很可能来自`null`. 所以，问题是：它是否包含一个`Cell`对象？你有没有用`Cell`对象初始化你的数组？

检查这一点的一种方法是说： `if (board[randSpace]==null || board[randSpace].isEmpty())`.....

# r - 控制 ggplot2 中 facet_grid/facet_wrap 的顺序？

> ID：15116081
> 
> 赞同：65
> 
> 时间：2013-02-27T15:38:25.240
> 
> 标签：r, ggplot2

我正在使用`facet_wrap`和`facet_grid`在ggplot中绘制东西，例如：

```
ggplot(iris) + geom_histogram(aes(iris$Petal.Width)) + facet_grid(Species ~ .) 
```

是否可以控制`Species`面板在图中的排序顺序？这可以在不更改`iris`数据框或制作新数据框的情况下完成吗？这里的默认显示 setosa, versicolor, virginica 但我想要不同的顺序。谢谢。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-02-27T15:50:53.690

我认为我不能真正满足您“不创建新数据框”的要求，但您可以即时创建新数据框：

```
ggplot(transform(iris,
      Species=factor(Species,levels=c("virginica","setosa","versicolor")))) + 
    geom_histogram(aes(Petal.Width))+ facet_grid(Species~.) 
```

或者，在 tidyverse 成语中：

```
iris %>%
   mutate(across(Species, factor, levels=c("virginica","setosa","versicolor"))) %>%
ggplot() + 
   geom_histogram(aes(Petal.Width))+ 
   facet_grid(Species~.) 
```

我同意如果有另一种方法来控制它会很好，但`ggplot`它已经是一个非常强大（和复杂）的引擎......

请注意，**数据集中 (1) 行的顺序与 (2)****因子水平的**顺序无关。#2 是什么`factor(...,levels=...)`变化，以及什么`ggplot`是确定方面的顺序。执行 #1（按指定顺序对数据框的行进行排序）是一个有趣的挑战。我想我实际上可以通过首先执行#2，然后使用`order()`或`arrange()`根据因子的数值进行排序来实现这一点：

```
neworder <- c("virginica","setosa","versicolor")
library(plyr)  ## or dplyr (transform -> mutate)
iris2 <- arrange(transform(iris,
             Species=factor(Species,levels=neworder)),Species) 
```

*如果不*更改因子级别的顺序，我无法立即看到一种快速的方法（您可以这样做，然后相应地重置因子级别的顺序）。

通常，R 中依赖于分类变量级别顺序的函数基于因子级别顺序，而不是数据集中行的顺序：上面的答案更普遍适用。

# php - Doctrine2 查询验证和错误处理

> ID：15116088
> 
> 赞同：1
> 
> 时间：2013-02-27T15:38:33.770
> 
> 标签：php, validation, symfony, doctrine, dbal

我想使用`DBALException`执行验证而不是显式检查条件。

例如，使用“删除限制”删除其子记录持有引用的父记录将违反完整性约束。这是当前在 MYSQL 中使用 Doctrine2 DBAL 和 mysql pdo 驱动程序。

我希望能够捕获 DBALException（到目前为止已成功）并立即确定发生了什么。

我不是要代码解决方案，而是要处理和规范化错误的学说的选项或扩展，一个简单的例子是：

```
catch(\Doctrine\DBAL\DBALException $e) {

    if($e->getPrevious()->getCode() == 23000) { // Integrity constraint violation
        /*
         * We know the type of problem; cannot delete parent record, 
         * or cannot create duplicate record.
         * But which one is it? And which child table was complaining?
         */
    }
} 
```

这是使用 PDOException 和 SQLSTATE 错误代码来大致了解问题，但它不够具体，虽然它符合 ODBC，但不能保证适用于每个数据库。

我需要这个的原因是我不能为每个删除过程中的每个实体存在或将来存在的每个可能的引用编写验证代码。

自行关闭：

意识到这是错误的验证方式，不要在测试环境之外使用这个概念。

# java - java.lang.IndexOutOfBoundsException

> ID：15116092
> 
> 赞同：0
> 
> 时间：2013-02-27T15:38:37.007
> 
> 标签：java, arraylist

我有一个返回整数数组的 SQL 查询。

```
ArrayList<Integer> intArray = new ArrayList<>(44);

while (result.next()){
   intArray.add(result.getInt("CNT"));     // Insert the result into Java Array List
}

// Insert the result into Java Object
dc = new DCDataObj(
       intArray.get(1), //    Datacenter          1000
       intArray.get(2), //    Zone                1100
       ..................
     ) 
```

运行代码时出现此错误： `java.lang.IndexOutOfBoundsException: Index: 40, Size: 40`

当我使用 ArrayList 时，你能告诉我我的错误在哪里吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T15:39:58.080

你必须从索引 0 而不是 1 开始

```
dc = new DCDataObj(
intArray.get(0), //    Datacenter          1000
intArray.get(1), //    Zone                1100 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T15:40:12.047

代替

```
dc = new DCDataObj(
           intArray.get(1), //    Datacenter          1000
           intArray.get(2), //    Zone                1100
           ... 
```

采用

```
dc = new DCDataObj(
           intArray.get(0), //    Datacenter          1000
           intArray.get(1), //    Zone                1100
           ... 
```

因为`List`索引是从零开始的（就像数组和字符串一样）。

* * *

如果我是你，我可能会提供一个`DCDataObj`带有`List<Integer>`as 参数的构造函数，然后你可以简单地调用

```
dc = new DCDataObj(intArray); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T17:21:57.343

另一种方法是使用这样的方法：

```
 dc = new DCDataObj();
    for (Integer k: intArray) {
        dc.add(k);
    } 
```

然后您可以动态添加元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T15:47:05.527

您试图获取只有 40 个元素的数组列表的第 41 个元素。

请记住，就像数组（以及 Java 中的所有索引集合）一样，索引从 0 开始。

你应该从：

```
dc = new DCDataObj(
    intArray.get(0), ... , intArray.get(39) ... 
```

# php - 从 Python 背景了解 PHP 数组

> ID：15116098
> 
> 赞同：0
> 
> 时间：2013-02-27T15:38:49.857
> 
> 标签：php, python

我通常用 Python、Java 或 C 编写代码。我正在使用 PHP 进行一个项目，并且正在阅读 PHP 中的数组，但我完全感到困惑。如果我理解正确，PHP 中的数字索引不一定对应于位置，而只是 Python 中的 dict 中的键。所以，当你打乱一个 PHP 数组时，元素的顺序会改变，但它们的键将保持不变。因此，在调用 时`array[9]`，如果 shuffle 以这种方式对元素进行排序，您实际上可能会获得数组的第一个元素。这引发了一系列问题：

*   那么，PHP 数组是否总是某种有序的哈希表？这对开销意味着什么？在 Python 中，列表的功能类似于经典的数组数据结构，而字典则更像散列结构。PHP 似乎通过为每个值分配唯一键并跟踪这些值的顺序来将两者结合起来。如果我想使用关联数组结构进行恒定时间查找，由于这种排序开销，我是否比使用 Python 字典更糟糕？是否有只有数组或只有哈希表的 PHP 数据结构？

*   当你从一个编号的 PHP 数组中删除一个值时会发生什么？如果我有一个数组，`[1, 2, 3, 4, 5]`我从数组中删除 4，然后尝试访问`array[3]`，它是否会给我一个错误，因为我
    删除了带有键 3 的元素？
    或者 PHP在这种情况下是否会进行某种键调整？

*   如果您更改数组的顺序（即，通过排序或
    随机播放），唯一的方法是让索引对应于使用 .
    将数组复制到新数组的位置`array_values()`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:26:59.160

1.  [http://php.net/manual/en/class.splfixedarray.php](http://php.net/manual/en/class.splfixedarray.php)
2.  这段代码：

    ```
    $arr = array(0,1,2,3,4);
    unset($arr[3]);
    echo $arr[3];  // undefined index warning, execution continues;
    echo isset($arr[3]) ? $arr[3] : '';
    print_r($arr); 
    ```

    `print_r()`输出：

    ```
    Array
    (
        [0] => 0
        [1] => 1
        [2] => 2
        [4] => 4
     ) 
    ```

3.  这[取决于您选择的功能](http://www.php.net/manual/en/function.sort.php)。有些维护索引关联，有些不维护。

## 专家提示：

*   永远不要期望两个看似相似的 PHP 函数的行为彼此相似。这是编程语言的“英语”：充满了从其他语言窃取的废话和大量相互矛盾的约定，但每个人都说它，所以跳上自由列车。

    '穆尔卡。

# solr - solr：使用 FileListEntityProcessor 时如何存储相对路径

> ID：15116100
> 
> 赞同：0
> 
> 时间：2013-02-27T15:39:06.260
> 
> 标签：solr, dataimporthandler

我使用 FileListEntityProcessor 来索引本地目录。 [该](https://stackoverflow.com/questions/9883699/how-to-store-file-path-in-solr-when-using-tikaentityprocessor)解决方案有效，但我不想存储绝对路径。相反，我想存储相对于 baseDir 的路径。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T04:18:04.353

如果要存储相对路径，可以使用[ScriptTransformer](http://wiki.apache.org/solr/DataImportHandler#ScriptTransformer)使用绝对路径并修改它以生成相对路径的新字段。例如

```
<dataConfig>
        <script><![CDATA[
                function retrieveRelativePath(row)    {
                    var absolutePath = row.get('absolutePath');
                    // Curtail to Relative path
                    var relativePath = absolutePath.something();
                    row.put('relativePath', relativePath);
                    return row;
                }
        ]]></script>
        <document>
                <entity name="e" pk="id" transformer="script:retrieveRelativePath" query="select * from X">
                ....
                </entity>
        </document>
</dataConfig> 
```

# php - php mysql插入内存问题

> ID：15116101
> 
> 赞同：0
> 
> 时间：2013-02-27T15:39:07.023
> 
> 标签：php, mysql

我有一些 PHP mysql 代码可以插入到表中（如下所示）。在我家里的盒子上，它似乎运行良好，但在我托管的生产服务器上，我在运行和减速时获得了令人难以置信的内存。

```
Column  Type    Null    Default Comments
uid int(1)  No       
CUID    int(11) No    
AUID    int(11) No       
user    varchar(10) No       
position    varchar(15) No       
User Added By   varchar(10) No       
Added On    datetime    No       Indexes

Keyname Type    Unique  Packed  Column  Cardinality Collation   Null    Comment
PRIMARY BTREE   Yes No  uid 17196   A   No  
AUID    BTREE   No  No  AUID    9   A   No  
user    BTREE   No  No  user    150 A   No  
CUID    BTREE   No  No  CUID    3439    A   No  

Space usage:
Data    794,776 B
Index   605,184 B
Total   1,367   KiB

Row Statistics:
 Format  dynamic
 Rows    17,196
 Row length ø    46
 Row size ø  81 B
 Next autoindex  27,104 
```

当我转到表单所在的网页时，我填写表单并插入到此表中。第一次速度是*合理*的。第二次页面需要 10 秒才能完成，当我检查托管服务器上的内存日志等时，RAM 达到了所有限制。

```
From ▴  To  aCPU    mCpu    aEP mEP lEP aMEM    mMEM    lMEM    MemF    MepF
02-27 10:08 02-27 10:09 12  62  1   3   20  359.1M  4.0G    4.0G    1   0
02-27 10:07 02-27 10:08 0   0   0   0   20  4.1M    4.1M    4.0G    0   0
02-27 10:06 02-27 10:07 0   0   0   0   20  4.1M    4.1M    4.0G    0   0
02-27 10:05 02-27 10:06 0   0   0   0   20  4.1M    4.1M    4.0G    0   0
02-27 10:04 02-27 10:05 25  62  1   4   20  22.5M   59.8M   4.0G    0   0
02-27 10:00 02-27 10:05 0   0   0   2   20  4.6M    22.7M   4.0G    0   0
02-27 09:00 02-27 10:00 0   75  0   4   20  5.8M    452.7M  4.0G    0   0
02-27 08:00 02-27 09:00 0   0   0   1   20  284K    18.1M   4.0G    0   0 
```

注意第一行中的 4.0G。

我真的很想知道这可能是什么。托管地点使用的是 suPHP，我听说这里面曾经有过错误（但那是几年前的事了）。

也许这是不现实的，但是在这个表中进行一次插入（我认为这是相对较小的）不应该导致整个地方的内存问题。这是插入语句：

```
mysql_query('INSERT INTO call_member SET user="'.$user.'", position="'.$position.'", CUID="'.$CUID.'", AUID="'.$apparatus.'", `LOSAP Added By`="'.$losap_added_by.'", `Added On`=NOW()'); 
```

现在，我知道我需要切换到 mysqli。那是在短期计划中。

什么会杀死服务器？我与托管公司合作，他们的服务器看起来不错。

我不*完全*确定这会导致内存问题，但每次运行这段代码时都会发生这种情况。所以，我*相信*这是原因。任何想法将不胜感激。

[添加更多代码]

```
$query = 'SELECT USER FROM member WHERE USER = "'.strtolower($user).'"';
$ck = squery( $query );
$num_entries = mysql_num_rows( $ck );
$row_person = mysql_fetch_assoc($ck);

$query = 'SELECT USER FROM call_member WHERE CUID='.$_REQUEST['CUID'].' AND USER = "'.strtolower($user).'" LIMIT 1';
$ck = squery( $query );

if( $num_entries == 1 && mysql_num_rows($ck) == 0 )
{       

    if( $num_entries == 1 )
    {
            $query = 'INSERT INTO call_member SET LOSAP="'.$row_person['LOSAP'].'", ccnumber ="' . $ccnumber . '", position="'.$position.'", CUID="'.$CUID.'", apparatus="'.$apparatus .'", `LOSAP Added By`="'.$user_added_by.'", `Added On`=NOW()';
            $result = squery( $query );
    }
    else
    {
            print '<div>Error: Could not find a user number or unique person for "'.$user.'" or the person is not a current member.</div>';
    }
} 
```

我在包含函数中定义了一个函数 squery：

```
function squery( $query  ) 
{
    $result = mysql_query( $query );
    print mysql_error();
    return $result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:39:27.617

你的查询方法：

函数查询（$查询）

```
{
    $result = mysql_query( $query );
    print mysql_error();
} 
```

应该有一个：

```
return $result; 
```

在最后。

# ms-access - 如何在 ms 访问中存储包含转义序列的文本

> ID：15116104
> 
> 赞同：1
> 
> 时间：2013-02-27T15:39:11.367
> 
> 标签：ms-access

当我尝试在 MS ACCESS 表中存储包含“C”代码的文本时（以编程方式）。它用一些问号符号替换转义序列（'\n'、'\t'）。

例子 ：

要存储的代码：

```
#include<stdio.h>
int main()
{
  printf("\n\n\t Hi there...");
  return 0;
} 
```

当我看到上面插入代码的 MS-Access 表时，它显示每个换行符和 '\t' 字符替换为 '?' 一种符号。

我的问题是“MS-Access 文件中是否还有其他数据类型可以按原样存储代码而不用某些符号替换转义序列？” 和“像 MYSQL 这样的其他 DBMS 中是否存在‘原始’数据类型可以完成我的工作？”

这是它在 access-07 中的显示方式：

![这就是它显示问号符号的方式](../Images/c42ffdbde2e6ae8bf4e0fbd42bf42818.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:04:43.933

看起来源文本中的换行符不是 Windows 标准的 CRLF（回车、换行）。找出那些神秘人物的字符代码。

使用下面的过程，我可以给它一个文本字符串，它会列出每个字符的代码。这是立即窗口中的一个示例。

```
AsciiValues "a" & vbcrlf & "b"
position      Asc           AscW
 1             97            97 
 2             13            13 
 3             10            10 
 4             98            98 
```

如果我想检查存储在表格文本字段中的值，我可以`DLookup`用来获取该值并将其提供给函数。

```
AsciiValues DLookup("memo_field", "tblFoo", "id=1")
position      Asc           AscW
 1             108           108 
 2             105           105 
 3             110           110 
 4             101           101 
 5             32            32 
```

一旦确定了问题字符的代码，您就可以执行一条`UPDATE`语句，将问题字符代码替换为合适的替代代码。

```
UPDATE YourTable
SET YourField = Replace(YourField, Chr(x), Chr(y)); 
```

这是程序...

```
Public Sub AsciiValues(ByVal pInput As String)
    Dim i As Long
    Dim lngSize As Long
    lngSize = Len(pInput)
    Debug.Print "position", "Asc", "AscW"
    For i = 1 To lngSize
        Debug.Print i, Asc(Mid(pInput, i, 1)), AscW(Mid(pInput, i, 1))
    Next
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T02:15:18.453

我会说你可能缺少整个换行符。Access 中的换行符由回车符 (ASCII 13)**和**换行符(ASCII 10) 组成。这缩写为 CRLF。你可能只有一个或另一个，但不是两者都有。

使用 HansUp 的 AsciiValues 程序来看看。

# java - 如何在 httpcompnents 中设置 httpstate

> ID：15116105
> 
> 赞同：1
> 
> 时间：2013-02-27T15:39:11.920
> 
> 标签：java, apache-httpclient-4.x

我正在我的项目中更新 httpclient 版本。httpclient 的当前版本是 httpclient3.2 我需要将它升级到 4.x(httpcomponents)。我可以通过[这个](http://debuguide.blogspot.in/2013/01/quick-guide-for-migration-of-commons.html)url 进行很多更改。但是设置 httpstate 很困惑。在 httpclient 3.x 版本中，以下代码用于设置 http 版本

```
 PoolingClientConnectionManager connMgr =new PoolingClientConnectionManager();
  connMgr.setDefaultMaxPerRoute( m_maxConnectionsPerHost );

    // Create a new HttpState container
    HttpState initialState = new HttpState();
    m_client = new DefaultHttpClient(connMgr);
    m_client.setState( initialState ); 
```

什么是 HttpState 的等效 API，我可以使用它在 httpclient4.x(httpcomponents) 中设置 httpstate。我用谷歌搜索但没有清除。提前感谢您的帮助。

# javascript - Phonegap如何在没有商店的情况下更新html js android应用程序

> ID：15116107
> 
> 赞同：0
> 
> 时间：2013-02-27T15:39:12.917
> 
> 标签：javascript, android, cordova

我正在考虑如何为我的 Phonegap 应用程序实现更新系统，至少就 Javascript 而言，我能想到的最简单的方法是将 apk 文件存储在服务器中，通过版本号检查更新，然后就下载apk文件并让用户安装它。

我该怎么做，或者有什么最简单的方法吗？在此先感谢您的帮助 ！

# java - 多对多枚举的休眠条件查询

> ID：15116108
> 
> 赞同：0
> 
> 时间：2013-02-27T15:39:13.473
> 
> 标签：java, hibernate, hibernate-criteria

我有一个班级评论：

```
@Entity
@Table(name = Constants.COMMENTS_TABLE)
@Audited
public class Comment {

@Column(name = "comment", nullable = false)
private String comment;

@ElementCollection(targetClass = CommentTopic.class)
@Enumerated(EnumType.STRING)
@Fetch(value = FetchMode.JOIN)
@CollectionTable(name = Constants.COMMENTS_TOPIC_JOIN_TABLE, joinColumns = @JoinColumn(name = "comment_id"))
@Column(name = "topic")
private Set<CommentTopic> commentTopics;

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
@Column(name = "comment_id", nullable = false)
private Long commentId;
} 
```

保持评论类有效，但以下条件查询：

```
Criteria criteria = session.createCriteria(Comment.class)
         .add(Restrictions.eq("commentTopics", topic));

List<Comment> entries = criteria.list(); 
```

throws org.hibernate.exception.DataException：没有为参数 1 指定值。

这是构建的查询：

选择 this_.comment_id 作为comment1_0_0_，this_.comment 作为comment0_0_，commenttop2_.comment_id 作为comment1_0_2_，commenttop2_.topic 作为topic2_ 从评论中选择this_ left outer join comments_topic commenttop2_ on this_.comment_id=commenttop2_.comment_id where this_.comment_id=?

我是否使用了不正确的注释？

条件查询是否构造不正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T18:45:37.053

我将 CommentTopic 枚举放在 CommentTopicWrapper 类中。

我将 commentTopicsSet 的注释更新为：

```
@OneToMany(targetEntity = CommentTopicWrapper.class, cascade = CascadeType.ALL, fetch = FetchType.EAGER)
@JoinTable(name = Constants.COMMENTS_TOPIC_JOIN_TABLE, joinColumns = @JoinColumn(name = "comment_id"), inverseJoinColumns = @JoinColumn(name = "topic"))
private Set<CommentTopicWrapper> commentTopics; 
```

# java - 自定义 ROM 和 Google Analytics

> ID：15116109
> 
> 赞同：0
> 
> 时间：2013-02-27T15:39:15.077
> 
> 标签：java, android, google-analytics, google-analytics-api

如果用户正在使用`Custom ROM`（无论是什么），是否无法使用 跟踪他们`Google Analytics`？以下 SO 主题听起来像是真的。

[谷歌分析easytracker导致java连接异常](https://stackoverflow.com/questions/8545854/google-analytics-easytracker-causes-java-connection-exception)

这是真的？如果是这样，我们作为开发人员是否只是将这些用户归为“无法追踪”？如果是真的，那有点令人失望。有已知的解决方法吗？

# review-board - 在 ReviewBoard 中提出审核请求时出错

> ID：15116111
> 
> 赞同：-1
> 
> 时间：2013-02-27T15:39:27.093
> 
> 标签：review-board

我已经安装了reviewboard。我向其中添加了本地 GIT 存储库。在创建审查请求期间，可以选择存储库。但是，当我从存储库中选择一个文件并尝试将其添加为差异时，它会显示“所选文件似乎不是差异”。如果有人对这个问题有任何答案，请告诉我。谢谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T12:02:51.760

```
git diff <filename1> ><filename2>.diff 
```

这可用于生成差异文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-01T08:10:54.847

```
Some helpful tips for reviewboard are:

Log Settings:
Check/Tick - Enable logging
Log directory: /var/www/reviewboard
Log Level: Debug

Review board git configuration steps::
$ git config --global user.name "Chalpat Rauth"
$ git config --global user.email chalpat.rauth@ap.sony.com
You can veryify the entries in vim ~/.gitconfig
$ ssh-keygen -t rsa
copy the public key ./root/.ssh/id_rsa.pub to gitlab as a new key 
chmod 700 -R /root/.ssh/
git clone git@gitlab.csx.sony.co.jp:testtest.git
During configuration in ReviewBoard:
Hosting service: None - Custom Repository
Repository Type: Git
Path: /var/www/reviewboard/code/testtest/.git
Note the below:
In path: /var/www/reviewboard/code/testtest/helloworld/src/test/java/com/sony/csx
git add <file_name>
git commit -m "This is second commit"
git push
git diff HEAD >DiffForReview

LDAP Settings::
Check/Tick - Allow anonymous read-only access
Authentication Method: LDAP
LDAP Server: ldap://ldap.csx.sony.co.jp
LDAP Base DN: dc=csx,dc=sony,dc=co,dc=jp
Surname Attribute: csxUsername1
Full Name Attribute: csxUsernameF
E-Mail LDAP Attribute: mail
User Mask: uid=%s 
```

# java - 我们怎么知道一个文件是读保护的？

> ID：15116124
> 
> 赞同：0
> 
> 时间：2013-02-27T15:39:55.727
> 
> 标签：java, windows, file

在 Windows 上的 Java 中，我们如何知道文件或文件夹是否被读保护？

我尝试使用 canRead() 和 setReadable() ：

```
String pathFile = "D:/Folder";
File f = new File(pathFile);
System.out.println("Is Protected => " + f.setReadable(true)==true); 
```

但它不能解决我的问题

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:50:13.053

当且仅当文件系统实际上包含由此抽象路径名表示的文件并且允许应用程序写入该文件时，canWrite 方法才为真；否则为假。

```
File lFile = new File("Sample.txt")
lFile.canWrite(); 
```

# windows-phone-7 - 在 Windows Phone 8 中播放视频文件

> ID：15116128
> 
> 赞同：2
> 
> 时间：2013-02-27T15:40:11.353
> 
> 标签：windows-phone-7, video-streaming, windows-phone-8, windows-phone

我想为 WP8 制作应用程序，它将下载和播放电影。Android Market 有很多这种类型的应用程序。但所有只是获取内容，并将其传递给视频播放器（例如 MX 播放器），格式可以不同（.avi、.mkv、.mpeg 等），但播放器显示内容没有任何问题。例如，在我的三星 s5830 上，1400 mb .avi 电影播放效果很好。正如我所见 - WP8 没有自定义视频播放器。

**问题：**如果我在我的应用程序中从网络下载一些 .avi 格式的电影，我可以在 WP8 上播放吗？网络视频流的相同问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:03:33.553

您可以播放手机支持的任何视频文件（这在[MSDN](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff462087%28v=vs.105%29.aspx)上有文档）。您可以使用 SDK 和 WP8 中的独立存储流式传输或播放下载的视频，`MediaElement`我认为也有 DirectX 选项。

仅仅说支持一种文件类型是不够的，因为它们只是视频“容器”——每个容器都可以包含不同编解码器的音频和视频。然而，MKV 看起来根本不受支持。

您可以看到这种视频格式（编解码器）支持在 WP7 和 8 甚至某些类型的手机之间有所不同，具体取决于手机中的芯片组支持的内容。（特别是对于高比特率高清编解码器）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T11:53:27.410

有一个很好的框架可以帮助您在应用程序中播放电影！在 codeplex [http://playerframework.codeplex.com上查看它](http://playerframework.codeplex.com)

还有一些文档[http://smf.codeplex.com/documentation](http://smf.codeplex.com/documentation)

# java - Java 会执行两个 TRUE Switch 案例吗？

> ID：15116135
> 
> 赞同：-4
> 
> 时间：2013-02-27T15:40:22.053
> 
> 标签：java, switch-statement

这是我的代码：

```
int x = 10;
switch(x) {
    case 10:
        System.out.println("10");
        break;
    case 5+5:
        System.out.println("5+5");
        break;
} 
```

在这种情况下，两种情况都成立，会执行什么？第一种情况，还是两者兼而有之？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T15:41:26.003

无效：5+5 解析为 10，并且不能有两个`case`具有相同常量的子句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T15:41:36.070

`5+5`编译为，`10`您的代码具有重复条件，这在 java switch 语句中是非法的。

从[规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.11)：

> 与 switch 语句关联的任何两个 case 常量表达式都不能具有相同的值。

所以没有人可以“解释执行”：没有执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T15:41:35.153

您将收到“重复案例”错误。

根据您的评论，这是您观察到的问题。

解释是编译器在编译时`5+5`评估`10`的，这意味着您有两个具有相同值的 case 分支。这是不允许的（代码应该采用哪一个？）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T15:41:48.667

switch 块中的每个 case 语句必须是唯一的。`case 10`并且`case 5 + 5`是同一件事，因此您的代码将无法编译。

# video - 如何在网站的视频上绘制草图

> ID：15116136
> 
> 赞同：0
> 
> 时间：2013-02-27T15:40:27.220
> 
> 标签：video, web, video-streaming, html5-canvas, html5-video

如何在网页上的任何视频上绘制草图或线条、圆形、方形等元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:50:08.173

您必须在视频上放置画布（此处解释：http: [//developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/HTML-canvas-guide/PuttingVideoonCanvas/PuttingVideoonCanvas.html](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/HTML-canvas-guide/PuttingVideoonCanvas/PuttingVideoonCanvas.html)）

然后，您将形状绘制到画布上（有很多教程，只需 google 即可），例如：[https ://developer.mozilla.org/en-US/docs/HTML/Canvas/Tutorial/Drawing_shapes?redirectlocale= zh-CN&redirectslug=Canvas_tutorial%2FDrawing_shapes](https://developer.mozilla.org/en-US/docs/HTML/Canvas/Tutorial/Drawing_shapes?redirectlocale=en-US&redirectslug=Canvas_tutorial%2FDrawing_shapes)

# asp.net-mvc-3 - mvc3 页面上的更多模型

> ID：15116139
> 
> 赞同：0
> 
> 时间：2013-02-27T15:40:30.310
> 
> 标签：asp.net-mvc-3, models

我可以在剃须刀页面上有更多模型吗？例如，当我有更多的网格控件时，每个控件都有一个用于编辑数据的区域（模板），之后我想保存数据并在网格中查看它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:47:14.203

您可以执行以下示例（这是一个非常简化的示例）：

```
public class AnimalDataViewModel
{
    public List<Dog> DogData { get; set; }

    public List<Cat> CatData { get; set; }

    public List<Mouse> MouseData { get; set; }

    public AnimalDataViewModel()
    {
        this.DogData = new List<Dog>();
        this.CatData = new List<Cat>();
        this.MouseData = new List<Mouse>();
    }
} 
```

然后在您的操作方法中：

```
public ActionResult DisplayAnimalDataGrids()
{
    AnimalDataViewModel model = new AnimalDataViewModel();

    model.DogData = this.myDataService.GetDogData();
    model.CatData = this.myDataService.GetCatData();
    model.MouseData = this.myDataService.GetMouseData();

    return View(model);
} 
```

那么在你看来：

```
@model AnimalDataViewModel

@Html.Grid(Model.DogData)
@Html.Grid(Model.CatData)
@Html.Grid(Model.MouseData) 
```

# sql - 从数据库中删除记录或在读取期间简单地隐藏它们？

> ID：15116146
> 
> 赞同：4
> 
> 时间：2013-02-27T15:40:53.427
> 
> 标签：sql, database, database-design

我想知道是否有人可以提供各种理由/解决方案来了解何时从数据库中删除记录，而不是在读取操作期间通过字段值（例如`is_hidden=1`.

我的应用程序是一个社交网络/电子商务网络应用程序。我倾向于支持这种`is_hidden`策略，但随着网站的增长，我可以看到这会导致网站的表现非常糟糕。

这是我的清单。我缺少清单上的哪些项目？列表的优先级是否良好？

`Delete`：

1.  理由：减少表大小/提高数据库性能
2.  基本原理：如果数据创建起来很简单，则很有用
3.  解决方案：SQL`DELETE`

`is_hidden`：

1.  理由：允许用户/DBA 恢复数据/对敏感和难以处理的`CREATE`数据有用
2.  理由：`DELETE`如有必要，以后可以吗
3.  解决方案：SQL`SELECT ... WHERE is_hidden!=1`

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T04:21:33.663

您可能想要进行软删除的主要原因是审计跟踪需要它。例如，我们可能有一个发票表和一个作废的列，我们通常可能只是忽略作废的发票。这保留了审计跟踪，因此我们知道输入了哪些发票以及哪些发票已作废。

出于这个原因，有许多领域（尤其是金融领域）首选软删除。通常，与数据集相比，删除的数量很小，并且您不想真正删除，因为实际上这样做可能会让某人为盗窃金钱或现实世界的商品提供掩护。然后可以为那些需要它的查询显示“已删除”的数据。

一个很好的非数据库示例如下：“在您的普通日记帐或总账中书写时，请用笔书写，如果您立即发现错误，请用单行划掉，以便原始数据仍然清晰，并在下面写正确的值。如果以后发现，要么写一个调整条目，要么写一个反转和一个新的。在这种情况下，您的主要理由是查看何时更改了哪些内容，以便在有问题时审核这些更改。

通常需要查看此类信息的人可能是财务或其他审计师。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T15:55:14.383

你已经在你的问题中说了一切：

**DELETE**将完全删除该条目并

**is_hidden=1**将隐藏它。

所以：如果您将来可能需要这些数据，您应该使用隐藏方法。如果您确定数据将永远不会被再次使用：使用删除。

**关于性能：**

您可以使用两个表：

*   1 用于可见项目
*   1 隐藏的

甚至三个表：

*   1 为可见
*   1 为隐藏
*   1 作为存档，您可以在其中移动所有超过 3 年或其他时间的隐藏数据

或者：

*   1 用于可见和隐藏的（使用 is_hidden 标志）
*   1 作为旧条目的存档

全取决于你。但如果你看看 facebook 或 google：他们永远不会删除任何东西！数据 == 金钱 == 权力 ;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T04:41:39.677

就性能和易于开发而言，您的平台上可能有过滤索引、索引视图等，这意味着保留软删除的数据对您的系统几乎没有影响。

# ios - CAKeyframeAnimation 在我旋转设备之前没有动画

> ID：15116151
> 
> 赞同：0
> 
> 时间：2013-02-27T15:41:07.750
> 
> 标签：ios, calayer, cakeyframeanimation

在为关键帧设置动画时，我似乎遗漏了明显的东西。我查看了许多代码示例，包括文档`MoveMe`中引用的 Apple's ，`CAKeyframeAnimation`但是，我找不到会导致我所看到的差异。

我创建 a `CGMutablePathRef`，然后创建 a`CAKeyframeAnimation`并将其设置为沿路径为图像视图设置动画。创建了一个动画组，因此我可以在完成后删除视图。

然而，我的动画从未出现。直到我旋转设备。似乎重新布局视图会导致动画启动。我尝试了明显的 like`[theImageView setNeedsDisplay]`或 even `setNeedsLayout`，以及容器视图。然而，当我需要时，仍然无法让它工作。它们仅在我旋转设备时出现。

在下文中，`-cgPathFromArray:`采用 an`NSArray`内部操作码转换为`CGPathRef`. 它被验证是正确的，因为当我旋转设备时，动画确实会沿着编程的路径显示。

```
- (void) animateImage: (NSString*) imageName
               onPath: (NSArray*) path
         withDuration: (NSString*) duration
{
    if (self.sceneView)
    {
        CGMutablePathRef    animationPath   =   [self cgPathFromArray: path];

        if (animationPath)
        {
            UIImage*    image       =   [self findImage: imageName];

            if (image)
            {
                UIImageView*    imageView   =   [[UIImageView alloc] initWithFrame: CGRectMake(0, 0, image.size.width, image.size.height)];

                if (imageView)
                {
                    CAKeyframeAnimation*    keyFrameAnimation   =   [CAKeyframeAnimation animationWithKeyPath: @"position"];

                    imageView.image = image;

                    [self.sceneView addSubview: imageView];

                    keyFrameAnimation.removedOnCompletion   =   YES;
                    keyFrameAnimation.fillMode              =   kCAFillModeForwards;
                    keyFrameAnimation.duration              =   duration.floatValue;
                    keyFrameAnimation.timingFunction        =   [CAMediaTimingFunction functionWithName: kCAMediaTimingFunctionLinear];
                    keyFrameAnimation.repeatCount = 0;

                    keyFrameAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];

                    [keyFrameAnimation setPath: animationPath];

                    //group animation with termination block to cleanup
                    CAAnimationGroup* group     =   [CAAnimationGroup animation];

                    group.duration              =   keyFrameAnimation.duration;
                    group.removedOnCompletion   =   YES;
                    group.fillMode              =   kCAFillModeForwards;
                    group.animations            =   @[keyFrameAnimation];

                    CorpsAnimationCompletionBlock theBlock = ^void(void)
                    {
                        [imageView removeFromSuperview];
                    };

                    [group setValue: theBlock
                             forKey: kCorpsAnimationCompletionBlock];

                    group.delegate = self;

                    [imageView.layer addAnimation: group
                                           forKey:  nil];
                }
            }
        }
    }
} 
```

任何人都可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:31:17.607

您可能遇到了麻烦，因为您在将图层添加到可见图层树的同一事务中将动画添加到图层。Core Animation 不喜欢将动画附加到尚未提交的图层上。您可以`[CATransaction flush]`在添加图层后解决此问题。

由于过度嵌套，您的代码很难看。考虑使用提前返回使其更具可读性。

`-[UIImage initWithImage:]`此外，您正在显式创建初始化程序将为您创建的同一帧。

如果您使用动画组并简单地设置代理以便在动画结束时执行块，则有一种更简单的方法。您可以开始一个`CATransaction`，设置事务的完成块，然后添加动画，然后提交事务。

因此：

```
- (void) animateImage:(NSString *)imageName onPath: (NSArray *)path
    withDuration: (NSString *)duration
{
    if (!self.sceneView)
        return;

    CGMutablePathRef animationPath = [self cgPathFromArray:path];
    if (!animationPath)
        return;

    UIImage *image = [self findImage:imageName];
    if (!image)
        return;

    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    [self.sceneView addSubview: imageView];

    // commit the implicit transaction so we can add an animation to imageView.
    [CATransaction flush];

    [CATransaction begin]; {
        [CATransaction setCompletionBlock:^{
            [imageView removeFromSuperview];
        }];

        CAKeyframeAnimation *animation = [CAKeyframeAnimation
            animationWithKeyPath:@"position"];
        animation.duration = duration.floatValue;
        animation.timingFunction = [CAMediaTimingFunction
            functionWithName:kCAMediaTimingFunctionLinear];
        animation.path = animationPath;
        [imageView.layer addAnimation:animation forKey:animation.keyPath];
    } [CATransaction commit];
} 
```

# algorithm - 找到条纹线的角度/旋转角度

> ID：15116157
> 
> 赞同：1
> 
> 时间：2013-02-27T15:41:24.463
> 
> 标签：algorithm, matlab, opencv, image-processing

因此，我试图在所附照片等图像中找到条纹线的旋转角度。唯一的假设是这些线是平行的，并且它们的方向大约或多或少约为 90 度[比如 5 度公差]。我必须确保结果图像中的条纹线垂直 %100。图像的质量以及它们的直方图/灰度值不同。因此，对于我的案例，基于非自适应阈值的方法已经失败[如果我不能使其自适应，我对基于阈值的方法不感兴趣]。此外，有时条纹线顶部会出现一些随机的黑色簇。

到目前为止我所做的：1）当然，HoughLines 是第一个选项，但我无法让它适用于我的所有图像，尽管遵循了这篇很棒的文章，但我取得了一些部分成功：http: [//felix.abecassis.me/ 2011/09/opencv-检测-倾斜角度/](http://felix.abecassis.me/2011/09/opencv-detect-skew-angle/)。我理解失败的主要原因是，我需要为不同的图像微调参数。Canny/BW/Morphological边缘检测等参数（如果需要） | minLinelength/maxLineGap/等的参数。当然，有一种方法可以破解它并使其工作，但是，对我来说，这是一个脆弱的解决方案！

2）我现在正在做的是将图像划分为顶部切片和底部切片，然后找到每个切片的峰和谷。然后基本上使用图像的宽度和峰的平移来找到角度。我目前正在寻找顶部切片的哪个峰值属于底部切片的哪个峰值，因为由于带状线顶部存在黑色/白色簇，我的计算中会出现一些误报峰值。

示例：切片的峰值位置：Top Slice = { 1, 33,67,90,110} BottomSlice = { 3, 14, 35,63,90,104}

提取峰值时，我实际上得到了相似的向量。可以看出，向量的长度可能会有所不同，知道我怎样才能得到一个像这样的组：

{{1,3},{33,35},{67,63},{90,90},{110,104}}

我对改进任何这些算法或全新方法的任何想法持开放态度。如果需要，我可以上传更多图片。

![在此处输入图像描述](../Images/bcd52edac55a729b74ad9d8898081715.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:21:09.760

如果您可以获得单条线的点列表，[线性回归](http://en.wikipedia.org/wiki/Best_fit_line)将为您提供最适合这些点的直线的公式。一个简单的三角操作会将直线公式转换为角度。

您可能可以使用一些细线操作将条纹变成点列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:49:31.763

您可以沿不同角度运行空间导数的累加器。如果您想要半度精度和 5 行样本，则最多有 10*5*1500 = 7.5m 次迭代。您可以安全地将沿线的采样率降低十倍，这将为您提供每个样本 150 个点的样本大小，从而将迭代次数减少到不到一百万。在该点附近的某个地方，拉直图像的操作应该成为瓶颈。

# java - AndEngine - 使用匹配的 ID 在关卡对象/实体之间画一条线

> ID：15116158
> 
> 赞同：-1
> 
> 时间：2013-02-27T15:41:25.487
> 
> 标签：java, android, xml, andengine

[编辑 4]Nvm 我忘了添加：

```
childInt_id[i] = Integer.parseInt(childString_id[i]); 
```

[编辑 3]所以现在我希望能够让父实体有多个子实体

```
 <entity x="640" y="224" type="gamebutton1" id="1" child_id="2, 3"/> 
```

我现在将 child_id 解析为字符串，通过 .split(",") 将其转换为字符串数组，并将字符串数组转换为 int 数组

```
final String child_id = SAXUtils.getAttributeOrThrow(pAttributes, TAG_ENTITY_ATTRIBUTE_CHILD_ID);
String[] childString_id = child_id.split(",");
int[] childInt_id = new int[childString_id.length]; 
```

我已将 levelObjectUserData 中的 ChildID 声明为数组

```
public int[] ChildID = {-1}; 
```

我正在循环遍历 ButtonSpriteChild 数组以查看它是否与 ButtonSpriteID 匹配

```
for (int k = 0; k < ButtonSpriteChild.length; k++){
if (ButtonSpriteChild[k] == ButtonSpriteID){ ... } } 
```

运行游戏时我没有收到任何错误，但现在实体之间没有画线。我想问我是否遗漏了什么？顺便说一句，这就是我画线的方式：

```
float parentX = levelObjects.get(i).getX();
float parentY = levelObjects.get(i).getY();
float childX = levelObjects.get(j).getX();
float childY = levelObjects.get(j).getY();
Line line = new Line(parentX, parentY, childX, childY, 10,vbom);
line.setColor(Color.GREEN);
attachChild(line); 
```

[编辑 2]：非常感谢史蒂夫的帮助！还有一件事可以在你的答案的最后一点上扩展一点 - “现在在你解析 XML 之后......”，我无法理解你的例子“（（levelObjectUserData）（levelObjects.get（i）.getUserData ())).ChildID”，当我尝试使用它时出现以下错误：“语法错误，插入“AssignmentOperator 表达式”以完成表达式”。再次感谢您的帮助

[编辑]：我已经弄清楚了我的问题的第一部分，xml 文件中的一些实体缺少 id 和 child_ids，并添加这些修复了错误。

所以我的问题变成了，我如何使用“id”和“child_id”在两个实体之间画一条线。因此，一旦匹配了两个级别对象，我需要获取父实体的 x 和 y 值以及子实体的 x 和 y 值，以便可以在它们之间绘制一条线，即

```
<entity x="640" y="224" type="gamebutton1" id="1" child_id="2"/> 
<entity x="512" y="224" type="gamebutton2" id="2"/>
Line line = new Line(parentX, parentY, childX, childY, 5, vbom); 
```

所以这就是我解析 levelObjects 的方式

```
levelLoader.registerEntityLoader(new EntityLoader<SimpleLevelEntityLoaderData>(TAG_ENTITY) {

        @Override
        public IEntity onLoadEntity(String pEntityName, IEntity pParent, Attributes pAttributes, SimpleLevelEntityLoaderData pEntityLoaderData) throws IOException {
            final int x = SAXUtils.getIntAttributeOrThrow(pAttributes, TAG_ENTITY_ATTRIBUTE_X);
            final int y = SAXUtils.getIntAttributeOrThrow(pAttributes, TAG_ENTITY_ATTRIBUTE_Y);
            final String type = SAXUtils.getAttributeOrThrow(pAttributes, TAG_ENTITY_ATTRIBUTE_TYPE);
            final int id = SAXUtils.getIntAttributeOrThrow(pAttributes, TAG_ENTITY_ATTRIBUTE_ID);
            final int child_id = SAXUtils.getIntAttributeOrThrow(pAttributes, TAG_ENTITY_ATTRIBUTE_CHILD_ID);

            final ButtonSprite levelObject;

            if (type.equals(TAG_ENTITY_ATTRIBUTE_VALUE_GAMEBUTTON1)) {
                levelObject = new ButtonSprite(x, y, resourcesManager.gamebutton1_region, vbom, new OnClickListener() {

                    @Override
                    public void onClick(ButtonSprite pButtonSprite, float pTouchAreaLocalX, float pTouchAreaLocalY) {                           

                    }
                });
            }

            else if (type.equals(TAG_ENTITY_ATTRIBUTE_VALUE_GAMEBUTTON2)) {
                levelObject = new ButtonSprite(x, y, resourcesManager.gamebutton2_region, resourcesManager.gamebuttonpressed_region, vbom, new OnClickListener() {

                    @Override
                    public void onClick(ButtonSprite pButtonSprite, float pTouchAreaLocalX, float pTouchAreaLocalY) {

                    }
                });
            }

            else if (type.equals(TAG_ENTITY_ATTRIBUTE_VALUE_GAMEBUTTON3)) {
                levelObject = new ButtonSprite(x, y, resourcesManager.gamebutton3_region, resourcesManager.gamebuttonpressed_region, vbom, new OnClickListener() {

                    @Override
                    public void onClick(ButtonSprite pButtonSprite, float pTouchAreaLocalX, float pTouchAreaLocalY) {

                    }
                });
            }

            else if (type.equals(TAG_ENTITY_ATTRIBUTE_VALUE_GAMEBUTTON4)) {
                levelObject = new ButtonSprite(x, y, resourcesManager.gamebutton4_region, resourcesManager.gamebuttonpressed_region, vbom, new OnClickListener() {

                    @Override
                    public void onClick(ButtonSprite pButtonSprite, float pTouchAreaLocalX, float pTouchAreaLocalY) {

                    }
                });
            }

            else if (type.equals(TAG_ENTITY_ATTRIBUTE_VALUE_GAMEBUTTON5)) {
                levelObject = new ButtonSprite(x, y, resourcesManager.gamebutton5_region, resourcesManager.gamebuttonpressed_region, vbom, new OnClickListener() {

                    @Override
                    public void onClick(ButtonSprite pButtonSprite, float pTouchAreaLocalX, float pTouchAreaLocalY) {

                    }
                });
            }

            else if (type.equals(TAG_ENTITY_ATTRIBUTE_VALUE_GAMEBUTTON6)) {
                levelObject = new ButtonSprite(x, y, resourcesManager.gamebutton6_region, resourcesManager.gamebuttonpressed_region, vbom, new OnClickListener() {

                    @Override
                    public void onClick(ButtonSprite pButtonSprite, float pTouchAreaLocalX, float pTouchAreaLocalY) {

                    }
                });
            }

            else {
                throw new IllegalArgumentException();
            }

            levelObject.setCullingEnabled(true);
            registerTouchArea(levelObject);
            setTouchAreaBindingOnActionDownEnabled(true);
            return levelObject;
        }
    }); 
```

基于此，我假设获得父 x 和 y，我会简单地使用 final int x 和 final int y，但我不确定如何获得子 x 和 y。我希望我能够澄清我的问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:18:29.040

你有选择，

1）您可以在加载每个实体时动态执行此操作，但您需要确保对 child_id 指向的另一个实体的引用之前已创建。根据您的 XML 判断，情况并非如此，您的第一个实体的 child_id 2 指向尚未创建的第二个实体，因此您无法在当前正在处理的实体 (1) 和那个之间加入一条线。因此，要做到这一点，您需要重新组织 XML 并从一个最初没有与另一个实体划线的实体开始。

或 2）一旦创建了所有实体，您将遍历所有实体并相应地画线，我觉得这会更好，因为您将它们放在 XML 中的顺序无关紧要。

无论您选择哪种方式，您都需要能够恢复创建的每个 ButtonSprite 的信息、其 ID 以及 ChildID（如果您选择选项 2）。为此，您还需要一个指向每个 ButtonSprite 的指针引用来恢复信息。

您可以将 ID 和 ChildID 放在 Sprite 的用户数据中，即

创建一个名为 levelObjectUserData 的类或具有两个公共整数字段 ID 和 ChildID 的类。默认情况下将它们设置为 -1。IE，

```
public class levelObjectUserData {
    public int ID = -1;
    public int ChildID = -1;
} 
```

然后对于您在加载程序中创建的每个 levelObject，即，之后

```
levelObject.setCullingEnabled(true); 
```

放置如下内容，

```
final levelObjectUserData MyData = new levelObjectUserData ();
MyData.ID = id;
MyData.ChildID = child_id;
levelObject.setUserData(MyData); 
```

现在，将每个 levelObject 添加到某种列表中（我使用链表）。即，在

```
levelLoader.registerEntityLoader... 
```

声明你的链表

```
LinkedList<Shape> levelObjects = new LinkedList<Shape>(); 
```

然后，每次您在加载程序中创建一个时，将其添加到列表中，即，在

```
levelObject.setCullingEnabled(true); 
```

将 levelObject 添加到列表中，

```
levelObjects.add(levelObject); 
```

现在，在您解析 XML 之后，在您的加载器完成之后，您可以访问通过遍历您的链表并在它们之间画线来创建的每个 levelObject。通过获取该项目的用户数据，您可以轻松找到要从当前 levelObject 绘制线条的按钮精灵，即

```
for (int i = 0;i<levelObjects.size();i++)
{

        final int ButtonSpriteChild  = ((levelObjectUserData) (levelObjects.get(i).getUserData())).ChildID;
        for (int j = 0;j<levelObjects.size();j++)
        {
            final int ButtonSpriteID = ((levelObjectUserData) (levelObjects.get(j).getUserData())).ID;

            if (ButtonSpriteChild  == ButtonSpriteID)
            {
                //Draw your line here between ButtonSprite levelObjects.get(i)
                //and ButtonSprite levelObjects.get(j) - the child that matches up
            }
        }

} 
```

（其中 i 是介于 0 和 levelObjects.size() - 1 之间的值）

然后再次找到 ID 与列表中的 ChildID 匹配的精灵按钮（假设它仍然没有默认值 -1）。

您会得到子 x 和 y，因为它们是 Sprite 创建时的初始位置。一旦您从链表中获得对子 Sprite 的引用，只需调用，

```
levelObjects.get(j).getInitialX()...
levelObjects.get(j).getInitialy()... 
```

其中 j 是子 Sprite 的索引。

希望这是有帮助的。

# pdf - 在solr中获取pdf的搜索结果的页码

> ID：15116160
> 
> 赞同：3
> 
> 时间：2013-02-27T15:41:26.097
> 
> 标签：pdf, solr, full-text-search, apache-tika, solr-cell

我正在构建一个 Web 应用程序，用户可以在其中搜索 pdf 文档并使用 pdf.js 查看它们。我想显示搜索结果，其中包含找到搜索词的段落的简短片段以及在右侧页面打开文档的链接。

所以我需要的是每个搜索结果的页码和一个简短的文本片段。

我正在使用 SOLR 4.1 来索引 pdf 文档。索引本身工作正常，但我不知道如何获取搜索结果的页码和段落。

我在这里找到了“[使用 Solr 用页码索引 PDF](https://stackoverflow.com/questions/4094269/indexing-pdf-with-page-numbers-with-solr) ”，但这并没有真正的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T11:14:15.100

我现在拆分 PDF 并将每个页面分别发送到 SOLR。因此，每个页面都是一个自己的文档，带有一个 id`<id_of_document>_<page_number>`和一个附加字段 doc_id，其中仅包含`<id_of_document>`用于对结果进行分组的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T04:12:43.517

JIRA [SOLR-380](https://issues.apache.org/jira/browse/SOLR-380)有一个补丁，您可以查看它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-03T16:49:02.497

我自己没有尝试过。方法，

1.  Solr 客户连接器与用于索引 PDF 的 Apache Tika 解析器集成
2.  在 Solr 中创建多个属性，例如 page1、page2、page3…、pageN – 或者，可以在 Solr 中使用动态属性
3.  在客户连接器中，逐页阅读 PDF，将它们索引到相应的页面属性/动态属性中
4.  在所有“页面”属性上启用搜索
5.  当用户搜索时，使用“highlighter/Summary/Teaser”组件只检索有命中的“page”属性
6.  对给定记录具有命中（从荧光笔/摘要/预告片中查找）的“页面”属性是具有搜索短语的页面。
7.  将 PDF 与 PDF 的“#PageNumber”链接并在单击时弹出页面

与拆分 PDF 并将它们作为单独的 Solr 文档进行索引相比，这是一种更好的方法。

如果您在此设计中发现缺陷，请回复我的帖子。我会尝试解决它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-02T04:20:48.380

我也尝试使用页码获取结果，但无法做到。我使用 Apache PDFBox 来拆分目录中存在的所有 PDF 并将文件发送到 Solr 服务器。

# javascript - 用于从没有特定 ID 的元素创建链接 url 的 javascript

> ID：15116161
> 
> 赞同：0
> 
> 时间：2013-02-27T15:41:27.297
> 
> 标签：javascript

在返回搜索结果列表的 CMS 中，我有一个看起来像这样的项目列表：

```
<ul class="results_odd_row">
  <li class=title> Title </li>
  <li class=published> Year </li>
  <li class="author"> Author </li>
  <li class="avail"> Out; try <a href="http://another.search">Another Search</a></li>
</ul>
<ul class="results_even_row">... </ul>
<ul class="results_odd_row">... </ul>
...etc... 
```

对于“尝试另一个搜索”链接，我想在 url 上附加一些关于记录的信息，比如“http://another.search?title=[title]&author=[author]”，这样信息就可以用于执行其他搜索。

如何识别没有特定 ID 的元素，以及同一页面上有多个相同类的元素？在伪代码中，我想要的可能是这样的：

```
 1\. href = base URL (http://another.search) plus
 2\. the text from the first <li> element above with class="title"
 3\. the text from the first <li> element above with class="author" 
```

此外，我受到 CMS 的限制，只能在 A 标记中使用任何 javascript。

如果它还不是很明显，我是一个完全使用 javascript 的新手，所以请不要觉得你的潜在反应是侮辱基本的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:04:08.403

您可以通过这种方式构建查询字符串

```
var baseUrl = "http://another.search"
var author = $('.results_even_row .author, .results_odd_row .author').first().text();
var title = $('.results_even_row .title, .results_odd_row .title').first().text();

var queryString = baseUrl + "?title=[" + title + "]&author=[" + author + "]" 
```

[在这里](http://jsfiddle.net/markus85/y5gsH/)试试。

然后，您只需使用此字符串进行下一次搜索。

# spring-mvc - 在默认 cstr 中设置日志路径

> ID：15116168
> 
> 赞同：0
> 
> 时间：2013-02-27T15:41:37.210
> 
> 标签：spring-mvc, log4j

在我的默认 cstr 中，我实例化了我的 log4j 记录器，其中我想在运行时发送日志文件目录路径。

我的默认 cstr 有这个：

```
logger = new LoggerSetup().SetLogger(Logger.getLogger(ServiceController.class), "FileLogger", LogDirPath); 
```

我在我的属性文件中设置了路径，我通过

```
@Value("#{settings['ApplicationLogDirPath']}")
private String LogDirPath; 
```

但是，由于在连接之前调用`@Value`了 cstr，因此 cstr 中的 LogDirPath 始终为空。

是否还有其他我应该使用的注释是否有更好的方法？

我想要实现的是从日志文件中动态设置 log4j 日志路径，此外我的控制器需要 2 个记录器，以便将应用程序级日志记录到一个位置，并且长时间运行的数据库调用 [控制器调用 biz 层] 写入到另一个位置。控制器在调用 biz 层之前记录，然后一旦 biz 层返回它就会记录该记录，因此会记录 2 个不同的日志文件。客户需要这种奇怪的日志记录，所以它就是这样

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:55:45.630

您可以使用 ${log.dir} 属性替换技术。就是这样：

```
String dynamicLog = // log directory somehow chosen...
Properties p = new Properties( Config.ETC + "/log4j.properties" );
p.put( "log.dir", dynamicLog ); // overwrite "log.dir"
PropertyConfigurator.configure( p ); 
```

[以下](https://stackoverflow.com/questions/4825414/best-practice-on-configuring-log4j-properties-path)也应该解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:29:44.713

您可以尝试手动加载属性文件并获取属性

```
File resource = new File(SO15116168.class.getClassLoader().getResource(".").getFile());
File file = new File(resource.getParent()+"/spring","customprops.properties");
System.out.println(file);
Properties p = new Properties();
p.load(new FileInputStream(file));
String property = p.getProperty("ApplicationLogDirPath"); 
```

替换`SO15116168`为您的班级。

# ios - 从视图中删除所有 UIButtons？

> ID：15116175
> 
> 赞同：-2
> 
> 时间：2013-02-27T15:41:53.440
> 
> 标签：ios, objective-c, cocos2d-iphone

我很难从视图中删除所有 UIButtons 。

我已将它们添加到`UIScrollView`for 循环中，稍后我需要删除它们。

所以添加它们：（在 cocos2d 场景中）

```
sview = [[UIScrollView alloc]
                          initWithFrame:[[UIScreen mainScreen] bounds]];

......
for(int i =0; i<[assets count]-1; i++)  
    {

        UIImage *thumb= [assets objectAtIndex:i];
        UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];
               [sview addSubview:button];
.......
 [[[CCDirector sharedDirector] view] addSubview:sview]; 
```

并删除它们：

```
[((UIView *)sview) removeFromSuperview]; //which usually works but no now . 
```

我以后如何在所有这些按钮上运行并删除它们？我没有指向它们的链接，我想在视图中的所有按钮上运行..

**编辑：尝试过但没有成功**

```
for (int i=0; i<[assets count];i++)
    {
        UIButton *myButton = (UIButton *)[sview viewWithTag:i];
         [((UIView *)myButton) removeFromSuperview];
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:46:00.630

虽然技术上可行，但这样设计代码并不是一个好主意。

> 我没有链接到他们

这就是你的问题。在创建时将它们放入`NSMutableArray`并添加它们，然后遍历此数组以删除它们。

但是，如果由于某种原因您不这样做，您可以检查视图的所有子视图是否为 UIButton：

```
- (void)removeUIButtonsFromView:(UIView *v)
{
    for (UIView *sub in v.subviews) {
        if ([sub isKindOfClass:[UIButton class]]) {
            [sub removeFromSuperview];
        } else {
            [self removeUIButtonsFromView:sub];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:45:39.250

```
for (UIView *subview in [((UIView *)sview).subviews copy]) {
    if ([subview isKindOfClass:[UIButton class]])
        [subview removeFromSuperview];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T15:47:18.457

如果它只是滚动视图中的按钮，请使用以下命令将它们全部删除：

```
[sview.subviews makeObjectsPerformSelector:@selector(removeFromSuperview)]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T15:52:34.440

有几种方法可以做到。有人提出了一种方法。我个人喜欢将我添加的所有内容保存在一个`NSMutableArray`（当您将它们添加到视图中时添加到数组中），然后循环遍历数组以删除它们。

```
for ( ... ; ... ; ...) {
    UIButton *button = ....
    // in your "add button loop" just record them in an array
    [self.transientViews addObject:button];
}

// remove them later with
for (UIView *view in self.transientViews)
    [view removeFromSuperview];
[self.transientViews removeAllObjects]; 
```

我喜欢这个，因为它给了我更多的灵活性。我可能想删除它们或其他东西。它们可以是任何子类，`UIView`我不必担心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T15:48:27.943

```
[((UIView *)sview) removeFromSuperview] 
```

您正在删除滚动视图`sview`：为什么？

添加按钮时，只需将它们也添加到`NSArray`您保留的属性中。然后只要你想删除它们就迭代那个数组

```
//in your interface

@property (nonatomic, strong) NSArray *buttons;

//in your implementation

sview = [[UIScrollView alloc]
                          initWithFrame:[[UIScreen mainScreen] bounds]];

......
NSMutableArray *tempArray = [NSMutableArray array];
for(int i =0; i<[assets count]-1; i++)  
    {

        UIImage *thumb= [assets objectAtIndex:i];
        UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];
               [sview addSubview:button];
        [tempArray addObject:button];
    }
    self.buttons = tempArray;
.......

// later, to remove all buttons

- (void) removeButtons
{
    for(UiButton *button in self.buttons){
        [button removeFromSuperview];
    }
    self.buttons = nil;
} 
```

# java - 如果我有 wsdl 文件而不生成存根 java 类，如何调用 web 服务？

> ID：15116183
> 
> 赞同：2
> 
> 时间：2013-02-27T15:42:19.623
> 
> 标签：java, web-services, wsdl

我只有 wsdl 文件，我对它的内容一无所知。我必须实现两个功能

1.  获取有关 wsdl 文件中描述的所有 Web 服务（名称和参数）的详细信息
2.  调用 web 服务而不生成存根 java 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:33:09.537

您不需要生成代码来使用 JAX-WS 客户端 -[示例](http://illegalargumentexception.blogspot.co.uk/2011/04/java-jax-ws-web-services-and-clients.html#ws_dynamic)- 但您需要了解请求/响应的形式才能调用服务并解释响应。

WSDL 描述了 SOAP 有效负载的形式。SOAP 有效负载可以包含各种复杂的 XML 结构。该服务可能能够在合同中描述其所有约束，但可能存在无法描述的逻辑约束。您可以从 WSDL 推断出有限数量的内容。

# css - 如何使用图例调整字段集中的内部容器高度？(CSS)

> ID：15116184
> 
> 赞同：0
> 
> 时间：2013-02-27T15:42:23.347
> 
> 标签：css, height, legend, fieldset

我尝试在 chrome 中创建带有可滚动内容的组框：http: [//jsfiddle.net/66a8V/](http://jsfiddle.net/66a8V/)。

```
 <!-- language-all: lang-html -->
    <fieldset style="width:400px; height: 200px">
        <legend>Groupbox</legend>
        <div style="overflow: hidden; width:100%; height: 100%">
            <div style="overflow:scroll; width:100%; height: 100%">
                <h1>Content</h1>
                <h1>Content</h1>
                <h1>Content</h1>
                <h1>Content</h1>
                <h1>Content</h1>
                <h1>Content</h1>
                <h1>Content</h1>
            </div>
        </div>
    </fieldset> 
```

Groupbox 大小不固定。

Fieldset 测量内部可用高度，没有图例。如何适应内部 div 大小？

# garbage-collection - Minor Collection 运行时发生并发标记扫描 (CMS) GC

> ID：15116195
> 
> 赞同：2
> 
> 时间：2013-02-27T15:42:46.567
> 
> 标签：garbage-collection, jvm, java, jvm-hotspot

我们使用的是 Java 1.6 Hotspot JVM。CMS GC 应该在 Old Gen 接近容量时运行。当 Young Gen 接近容量时，Minor Collection 运行。

但是，在一台服务器上，每次发生 Minor Collection 时，我们都会获得 CMS GC。在第二台服务器上，这不会发生（正常操作）。两台服务器上的 jvm 选项完全相同；这发生在我们升级到 64 位网络服务器和 JRE 之后。JVM选项如下：

```
<jvm-options>-Xms4096M -Xmx4096M</jvm-options>
<jvm-options>-server</jvm-options>
<jvm-options>-Xss256k</jvm-options>
<jvm-options>-XX:NewSize=392M</jvm-options>
<jvm-options>-XX:MaxNewSize=392M</jvm-options>
<jvm-options>-XX:+DisableExplicitGC</jvm-options>
<jvm-options>-XX:+UseParNewGC</jvm-options>
<jvm-options>-XX:+PrintClassHistogram</jvm-options>
<jvm-options>-XX:+PrintGCDateStamps</jvm-options>
<jvm-options>-XX:+UseConcMarkSweepGC</jvm-options>
<jvm-options>-XX:+PrintGCDetails</jvm-options>
<jvm-options>-XX:PermSize=80m</jvm-options>
<jvm-options>-XX:MaxPermSize=80m</jvm-options>
<jvm-options>-d64</jvm-options>
<jvm-options>-XX:+CMSIncrementalMode</jvm-options>
<jvm-options>-XX:+CMSIncrementalPacing</jvm-options>
<jvm-options>-XX:CMSIncrementalSafetyFactor=75</jvm-options> 
```

CMSInitiatingOccupancyFraction 未设置，因此它是默认值。这可能是什么原因造成的？对于未定义的 JVM 参数，两个 JVM 是否可以有不同的默认值？

请看下面的 GC 日志。第一行是Minor Collection。几分之一秒后，CMS GC 仅在 10% 满时运行。

```
2013-02-28T13:49:55.446-0500: 1052247.742: [GC 1052247.742: [ParNew: 334791K->12629K(361280K), 0.0402234 secs] 687147K->366075K(4154176K) icms_dc=100 , 0.0409779 secs] [Times: user=0.28 sys=0.00, real=0.04 secs]
2013-02-28T13:49:55.505-0500: 1052247.801: [GC [1 CMS-initial-mark: 353445K(3792896K)] 366282K(4154176K), 0.0581835 secs] [Times: user=0.06 sys=0.01, real=0.06 secs]
2013-02-28T13:49:55.565-0500: 1052247.860: [CMS-concurrent-mark-start]
2013-02-28T13:49:56.713-0500: 1052249.009: [CMS-concurrent-mark: 0.796/1.148 secs] [Times: user=6.03 sys=0.04, real=1.15 secs]
2013-02-28T13:49:56.713-0500: 1052249.009: [CMS-concurrent-preclean-start]
2013-02-28T13:49:56.808-0500: 1052249.104: [CMS-concurrent-preclean: 0.094/0.095 secs] [Times: user=0.11 sys=0.00, real=0.10 secs]
2013-02-28T13:49:56.808-0500: 1052249.104: [CMS-concurrent-abortable-preclean-start] 
  CMS: abort preclean due to time 2013-02-28T13:50:01.892-0500: 1052254.188: [CMS-concurrent-abortable-preclean: 5.080/5.083 secs] [Times: user=5.98 sys=0.11, real=5.08 secs]
2013-02-28T13:50:01.911-0500: 1052254.207: [GC[YG occupancy: 56184 K (361280 K)]1052254.207: [Rescan (parallel) , 0.0413292 secs]1052254.249: [weak refs processing, 0.0001292 secs] [1 CMS-remark: 353445K(3792896K)] 409629K(4154176K), 0.0421145 secs] [Times: user=0.63 sys=0.02, real=0.04 secs]
2013-02-28T13:50:01.954-0500: 1052254.250: [CMS-concurrent-sweep-start]
2013-02-28T13:50:04.032-0500: 1052256.328: [CMS-concurrent-sweep: 2.078/2.078 secs] [Times: user=2.40 sys=0.03, real=2.08 secs]
2013-02-28T13:50:04.032-0500: 1052256.328: [CMS-concurrent-reset-start]
2013-02-28T13:50:04.050-0500: 1052256.346: [CMS-concurrent-reset: 0.018/0.018 secs] [Times: user=0.02 sys=0.00, real=0.02 secs]
2013-02-28T13:50:44.487-0500: 1052296.783: [GC 1052296.783: [ParNew: 333781K->12385K(361280K), 0.0377823 secs] 686314K->366061K(4154176K) icms_dc=100 , 0.0385722 secs] [Times: user=0.29 sys=0.00, real=0.04 secs]
2013-02-28T13:50:44.544-0500: 1052296.840: [GC [1 CMS-initial-mark: 353676K(3792896K)] 366257K(4154176K), 0.0562739 secs] [Times: user=0.06 sys=0.00, real=0.06 secs]
2013-02-28T13:50:44.601-0500: 1052296.897: [CMS-concurrent-mark-start]
2013-02-28T13:50:45.420-0500: 1052297.716: [CMS-concurrent-mark: 0.784/0.819 secs] [Times: user=5.79 sys=0.02, real=0.82 secs]
2013-02-28T13:50:45.420-0500: 1052297.716: [CMS-concurrent-preclean-start]
2013-02-28T13:50:45.517-0500: 1052297.813: [CMS-concurrent-preclean: 0.096/0.097 secs] [Times: user=0.12 sys=0.00, real=0.10 secs]
2013-02-28T13:50:45.518-0500: 1052297.813: [CMS-concurrent-abortable-preclean-start]
  CMS: abort preclean due to time 2013-02-28T13:50:50.524-0500: 1052302.820: [CMS-concurrent-abortable-preclean: 4.903/5.006 secs] [Times: user=5.39 sys=0.05, real=5.01 secs]
2013-02-28T13:50:50.543-0500: 1052302.839: [GC[YG occupancy: 49968 K (361280 K)]1052302.839: [Rescan (parallel) , 0.0695454 secs]1052302.909: [weak refs processing, 0.0001064 secs] [1 CMS-remark: 353676K(3792896K)] 403644K(4154176K), 0.0702712 secs] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T11:31:38.697

From your logs it seems that CMS is running continuously. Normally CMS will delay initial-mark for next young GC (because young space have smallest size right after young GC). This is a reason why you are seeing CMS initial-mark right after ParNew.

icms_dc=100 suggest that CMS were running non-stop even before ParNew.

I have seen this once [(read more details)](http://blog.ragozin.info/2012/06/story-of-relentless-cms.html), in my case CMS were triggered by premanent space reaching occupancy threshold. Check your permspace occupation, there is a chance that you should increase it.

You could also configure different occupancy threshold for permanent space (though I'm not sure how it will work with iCMS).

```
-XX:CMSInitiatingPermOccupancyFraction=N 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-22T16:04:24.650

[文档](http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html)。_

首先你必须定义一个一致的配置（所以每次都特别选择CMS...） 很久以前，我进行了很多性能测试，我尝试使用这个选项'-XX:CMSInitiatingOccupancyFraction'。我观察到一种与文档中解释的行为不同的行为（GC 调整通常是这种情况......）

经过一番研究，我发现了一个名为“-XX:+UseCMSInitiatingOccupancyOnly”的未记录选项。自 Java 6 以来，该选项应该已消失，但它是操作 CMSInitiatingOccupancyFraction 的便捷解决方法。

我不尝试使用 Java 7 或 Java 8。所以这个技巧可能已经过时了。也许不是^^

# php - 对来自文本文件的阿拉伯文本展开操作

> ID：15116199
> 
> 赞同：0
> 
> 时间：2013-02-27T15:42:56.833
> 
> 标签：php

我有一个包含阿拉伯文和英文字符的文件。我需要阅读文件并对文本进行爆炸操作。

虽然来自文件的文本正确显示了字符，但当我应用`explode`它时会打印出不同的字符，例如搀碗愀氀漀ⴀ愀✀ 我该怎么做才能修复它？

```
$file = fopen("files/MetinCeviriKelimeler.txt","r");
$temp=fgets($file); 
echo $temp;
$explode_str = explode('>',$temp);
echo $explode_str[0]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:46:58.850

您需要`mb_split()`改用（从技术上讲，它是第一个参数的正则表达式，但出于您的目的，您可以像使用它一样使用它`explode()`）。

普通的 php 字符串函数倾向于破坏 UTF 文本；有一个完整的 mb_ 函数库来保存编码。

**- 编辑 -**

您还可以设置：

```
mb_internal_encoding("UTF-8"); 
```

在文件顶部的某处。要使其生效，您的源代码文件也需要编码为 UTF8。

# php - 寻找使 MYSQL JOIN 与关系表和全局变量一起工作的解决方案

> ID：15116202
> 
> 赞同：0
> 
> 时间：2013-02-27T15:43:12.410
> 
> 标签：php, mysql, join, subquery

编辑：以下代码显示了问题的答案。感谢 VolkerK。

```
$result = mysqli_query($link,"SELECT ctas.*, ctas_pr.*, nav.id
                              FROM web_ctas AS ctas

                              LEFT JOIN web_ctas_page_relation AS ctas_pr
                              ON ctas.id = ctas_pr.cta_id

                              LEFT JOIN web_navbar  AS nav
                              ON ctas_pr.navbar_id = nav.id
                              AND nav.link_name = '".$page."'")

                              or die(mysqli_error($link)
                      ); 
```

早上好/下午/晚上好，

我希望你们中的一些人可以帮助我解决有关 mySQL 的特定问题。

我试图让`JOIN`两个表传递一些逻辑并取回匹配的相关字段数据，我必须解释过程和表，以便您对代码和过程有一点了解。

“web_ctas”表有一个与 web_navbar 表对应的关系字段。

非常感谢任何可以在此问题上提供帮助的人。

下面是两张表：

**web_ctas**

```
id | title | img_src | img_alt | link_href | link_title | desc
==============================================================
1  | title | pears   | apples  | foo       | bar        | blah
2  | title | apples  | pears   | bar       | foo        | bleh 
```

**web_navbar**

```
id | link_name | visible
========================
1  | home      |   1
2  | products  |   1 
```

**web_ctas_page_relation**

```
id | cta_id | navbar_id
=======================
1  |    1   |    2
2  |    2   |    2 
```

下面是我到目前为止的 SQL（我知道这可能根本行不通）：

```
$query = mysqli_query($link,"SELECT web_ctas.*, web_navbar.id AS nav_id
                             FROM web_ctas
                             JOIN web_navbar
                             ON web_navbar.id = web_ctas.page_relation
                             AND page_relation='".$page."'"); 
```

下面是 HTML/PHP，它将从 SQL 查询结果中提取数据。

```
$page = 'home';

while($row = mysqli_fetch_object($query)): ?>
        <li>
            <a href="<? echo $row->link_href; ?>" title="<? echo $row->link_title; ?>">
                <h3><? echo $row->title; ?></h3>
                <div>
                    <img src="<? echo $row->img_src; ?>" alt"<? echo $row->img_alt; ?>">
                </div>
            </a>
        </li> <?
    endwhile; 
```

因此，简而言之，我正在寻找一种方法，当它与 web_ctas 中的行匹配时，从**web_navbar**表中获取**link_name**字段，该**行在****page_relation**字段中具有关系**id**并与变量 $page 匹配。

 ******如果我错过了任何关键代码/信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:37:58.330

对不起，该走了；仅是示例脚本的时间，而不是解释。既然你已经自己弄清楚了关系表的东西，只给了 1NF 链接，我相信你也可以通过这个链接进行挖掘；-)
使用 mysqli 而不是 pdo_mysql 的工作方式相同。

```
<?php
$pdo = new PDO('mysql:host=localhost;dbname=test;charset=utf8', 'localonly', 'localonly');
$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
setup($pdo);

$navbar = 'nav_36'; // this would be $navbar='products'; in your case
$stmt = $pdo->prepare('
    SELECT
        nv.id as navid,
        nv.link_name,
        ct.id as ctasid,
        ct.title,
        ct.link_href
    FROM 
        tmp_web_navbar as nv
    LEFT JOIN
        tmp_web_ctas_nav_rel as r
    ON
        nv.id = r.id_navbar
    LEFT JOIN
        tmp_web_ctas as ct
    ON
        r.id_ctas=ct.id
    WHERE
        nv.link_name = ?
');
$stmt->setFetchMode(PDO::FETCH_ASSOC);
$stmt->execute(array($navbar));
foreach($stmt as $row ) {
    foreach($row as $k=>$v) {
        echo $k,'=', $v, ' ';
    }
    echo "\n";
}

// boilerplate for creating table layout and populating some example data
function setup($pdo) {
    $pdo->exec('
        CREATE TEMPORARY TABLE tmp_web_navbar (
            id int auto_increment,
            link_name varchar(32),
            visible varchar(32),
            primary key(id)
        )
    ');
    // add some entries to tmp_web_navbar since the example data uses the range [1,50]
    $stmt = $pdo->prepare('INSERT INTO tmp_web_navbar (link_name,visible) VALUES (?,?)');
    for($i=1; $i<60; $i++) {
        $stmt->execute(array(sprintf('nav_%02d', $i), 'title'));
    }

    $pdo->exec('
        CREATE TEMPORARY TABLE tmp_web_ctas (
            id int auto_increment,
            title varchar(32),
            link_href varchar(32),
            primary key(id)
        )
    ');
    // add some ctas elements
    $stmt = $pdo->prepare('INSERT INTO tmp_web_ctas (title,link_href) VALUES (?,?)');
    for($i=1; $i<60; $i++) {
        $stmt->execute(array('title', sprintf('ctas_%02d', $i)));
    }

    $pdo->exec("INSERT INTO tmp_web_ctas (title,link_href) VALUES
        ('title','foo'),
        ('title ','bar')
    ");

    // a table to store the relationships
    $pdo->exec('
        CREATE TEMPORARY TABLE tmp_web_ctas_nav_rel (
            id int auto_increment,
            id_ctas int,
            id_navbar int,
            primary key(id),
            key(id_ctas)
        )
    ');

    // and define some relationships
    // three of them having id_navbar=36: cats=4,5 and 7
    $stmt = $pdo->prepare('INSERT INTO tmp_web_ctas_nav_rel (id_ctas,id_navbar) VALUES (?,?)');
    $rel = array(
        1=>array(1,6,10,50),
        2=>array(2,13,15,30),
        3=>array(9,7,11,51),
        4=>array(17,24,36,34), // here
        5=>array(18,24,36,35), // here
        6=>array(19,24,33,38),
        7=>array(19,24,32,36), // and here
        8=>array(19,24,39,38),
    );
    foreach($rel as $ctas=>$navrels) {
        foreach( $navrels as $nav ) {
            $stmt->execute(array($ctas,$nav));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:47:48.943

```
$query = mysqli_query($link,"SELECT web_ctas.*, web_navbar.id AS nav_id
                             FROM web_ctas
                             JOIN web_navbar
                             ON web_navbar.id IN (web_ctas.page_relation)
                             AND page_relation='".$page."'"); 
```******

# android - 来自新谷歌地图 v2 的奇怪异常

> ID：15116207
> 
> 赞同：2
> 
> 时间：2013-02-27T15:43:22.223
> 
> 标签：android, google-maps-android-api-2

我最近从使用我的应用程序的用户中发现了以下异常，有人遇到过这种异常吗？

**编辑：**这是一个**[已确认的错误](https://code.google.com/p/gmaps-api-issues/issues/detail?id=5025)**。

这是堆栈跟踪：

```
java.lang.RuntimeException: Error receiving broadcast Intent { act=android.net.conn.CONNECTIVITY_CHANGE flg=0x10000000 (has extras) } in maps.z.bz@407c91c8
    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:722)
    at android.os.Handler.handleCallback(Handler.java:587)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:123)
    at android.app.ActivityThread.main(ActivityThread.java:3701)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:862)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:620)
    at dalvik.system.NativeStart.main(Native Method)
    Caused by: java.lang.IllegalArgumentException: Receiver not registered:   maps.z.bz@407c91c8
    at android.app.LoadedApk.forgetReceiverDispatcher(LoadedApk.java:610)
    at android.app.ContextImpl.unregisterReceiver(ContextImpl.java:822)
    at android.content.ContextWrapper.unregisterReceiver(ContextWrapper.java:331)
    at maps.z.bz.onReceive(Unknown Source)
    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:709)
    ... 9 more
    java.lang.IllegalArgumentException: Receiver not registered: maps.z.bz@407c91c8
    at android.app.LoadedApk.forgetReceiverDispatcher(LoadedApk.java:610)
    at android.app.ContextImpl.unregisterReceiver(ContextImpl.java:822)
    at android.content.ContextWrapper.unregisterReceiver(ContextWrapper.java:331)
    at maps.z.bz.onReceive(Unknown Source)
    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:709)
    at android.os.Handler.handleCallback(Handler.java:587)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:123)
    at android.app.ActivityThread.main(ActivityThread.java:3701)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:862)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:620)
    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:37:54.503

请确认您是否按如下方式编辑了清单文件：

插入元素以包含 API 密钥作为

```
<meta-data
android:name="com.google.android.maps.v2.API_KEY"
android:value="--- your API Key here ---"/> 
```

请记住用您自己的 API 密钥替换值。

请注意，您必须在测试中使用调试 API 密钥（请参阅“为 Google Maps Android API v2 服务生成调试 API 密钥”）。然后在您的发布 APK 中替换为发布 API 密钥（请参阅“为 Google Maps Android API v2 服务创建和获取 API 密钥”）。添加和 MAPS_RECEIVE。

```
<permission 
android:name="com.example.androidmapsv2.permission.MAPS_RECEIVE" 
android:protectionLevel="signature"></permission>
<uses-permission 
android:name="com.example.androidmapsv2.permission.MAPS_RECEIVE"/> 
```

其中 com.example.androidmapsv2 是我的包，替换为您自己的包名。

添加使用权限：

```
<uses-permission
android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
<uses-permission
android:name="android.permission.INTERNET"/>
<uses-permission
android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

和可选的：

```
<uses-permission
android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission
android:name="android.permission.ACCESS_FINE_LOCATION"/> 
```

指定 OpenGL ES 2 的使用特性：

```
<uses-feature
android:glEsVersion="0x00020000"
android:required="true"/> 
```

**编辑：** 您是否在您的应用程序中使用任何类型的接收器？如果是，请检查：

那么问题的原因可能在这里：

```
unregisterReceiver(yourReciever); 
```

如果接收方已经取消注册或未注册，则调用 unregisterReceiver 将引发 IllegalArgumentException。确认并告诉我

# c# - 调试 .NET Async/Await 函数时无法检查变量

> ID：15116210
> 
> 赞同：9
> 
> 时间：2013-02-27T15:43:27.123
> 
> 标签：c#, debugging, async-await

`async/await`我有一个正在使用功能的 .NET 4.5 项目。

当我尝试在等待语句之后检查/快速观察变量引用时，我得到以下信息：

> `The name 'id' does not exist in the current context`

知道如何解决这个问题，以便我可以调试它？

编辑 - 这是代码

```
 [Fact]
    public async Task works_as_expected()
    {
        var repo = Config.Ioc.GetInstance<IAsyncRepository<Customer>>();

        var work = Config.Ioc.GetInstance<IUnitOfWork>();
        Customer c= new Customer()
        {
            FirstName = "__Micah",
            LastName = "__Smith_test",
            DateCreated = DateTime.Now,
            DateModified = DateTime.Now,
            Email = "m@m.com",
            Phone = "7245551212"
        }; 

        var id=await repo.Insert(c);
        // i can't inspect the value of id
        Assert.True(id > 0);
    } 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-27T15:45:09.327

该变量尚不存在，因此无法检查其值。它没有价值（还）。

从技术上讲，它不会被定义，直到你到达定义它的代码行，并且在你初始化它之前它不会有一个值。虽然在某些情况下，您可以在分配变量之前从技术上检查变量的值，但该值永远无法在代码中访问（在不安全代码之外），因此几乎没有理由查看它。

至于何时分配该位置的内存（即您第一次可以选择在调试器中查看它时），那将是在您到达第一行之后，最后一行之后`await`再使用变量。

# linux - 从 Perl 采购 Shell 脚本

> ID：15116221
> 
> 赞同：2
> 
> 时间：2013-02-27T15:43:57.210
> 
> 标签：linux, perl, shell

我有点难以理解为什么从命令行获取文件的 csh 命令可以正常工作，但在合并到 Perl 脚本中时却无法正常工作。

```
 my @envvar = ();
  if (-e $ENV{WSDIR}."/<script>.csh") {
    @envvar = `csh -c "cd $WSDIR ; source <script>.csh  ; env"`;
  } 
```

当我运行 Perl 脚本时，我收到如下错误*script.csh: No such file or directory*，而从终端作为 csh 命令运行按预期工作。在 Perl 的 csh 命令中使用环境变量有什么限制？我该如何克服这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T15:50:42.063

`$WSDIR`被插入到空字符串中`perl`。您需要对“$”进行转义，以便将其发送到外壳，外壳可以`$WSCIR`根据需要进行扩展。

```
@envvar = `csh -c "cd \$WSDIR ; source <script>.csh  ; env"`; 
```

或者你可以让 perl 扩展环境变量本身：

```
@envvar = `csh -c "cd $ENV{WSDIR} ; source <script>.csh  ; env"`; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-10T05:21:43.320

当 perl 启动时，它会成为自己的子 shell。该子外壳不包含所有功能，例如采购仅可用于主外壳的外壳文件。

您可以通过从 CPAN 安装外部模块来做到这一点，即 Shell::Source

```
$env_path= Shell::Source->new(shell=>"tcsh",file=>"../path/to/file/<script>.csh");
$env_path->inherit;
print "Your env path: $ENV{WSDIR}"; 
```

由于 perl 在 shell 上运行时会创建自己的实例，所以我们不能为主 shell 设置环境路径，因为 perl 的实例就像主 shell 的子 shell。孩子不能为父母设置环境路径。

现在直到 perl 的子 shell 运行，您将能够访问 .csh 中存在的所有路径

# winapi - 以编程方式为 WinRT 应用程序设置屏幕

> ID：15116225
> 
> 赞同：0
> 
> 时间：2013-02-27T15:44:16.270
> 
> 标签：winapi, windows-runtime, windows-store-apps

我正在寻找以编程方式设置 WinRT 应用程序监视器的可能性。

我不仅限于 WinRT API，我也可以使用任何 WinAPI 调用（可以将 WinAPI 应用程序或服务保留在目标机器上）。

我尝试通过进程句柄访问窗口句柄，但 WinRT 应用程序没有主窗口。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T01:29:53.760

AFAIK，无法以编程方式强制 Windows Store 应用程序在特定显示器上运行（我假设这就是您所说的“屏幕”）。

在具有多个监视器的系统上启动 Windows 应用商店应用程序时，它将始终在显示“开始屏幕”的同一屏幕上运行。这只能由用户更改（同样，AFAIK），例如，使用 Win+PgUp/PgDn 快捷方式。

如果您想知道为什么，这是一个一致性问题和让用户控制的问题。他们可以决定他们的 Windows 应用商店应用程序的运行位置，而不是开发人员。

希望有帮助。

有关 Windows 应用商店应用开发的更多信息，请注册[Generation App](http://bit.ly/gd30tolaunch)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T11:45:43.973

我发现 Windows 商店应用程序是具有自己窗口的常规 WinAPI 应用程序。所以我得到了它的 HWND 使用`FindWindow(L"Windows.UI.Core.CoreWindow", L"APP_NAME")`并用来`SetWindowPos`移动它。它不会改变 app 的“逻辑”监视器，但它可以改变它的位置。甚至可以将它扩展到几台显示器上。

我知道为什么没有黑客就无法使用它，我不在乎，因为它是一个信息亭模式应用程序，它永远不会去商店。

# php - php进程LD_LIBRARY_PATH大cpu使用率

> ID：15116235
> 
> 赞同：-1
> 
> 时间：2013-02-27T15:44:45.417
> 
> 标签：php, system-calls, strace

我正在寻找 PHP 进程使用这么多 CPU 的原因，服务器是 Apache mpm worker + suphp 下面是“strace php”的一些输出，如您所见，该进程正在“不正确”路径中寻找 dso，这些是刚刚编译了 PHP 扩展，有没有办法将搜索路径指定为 '/lib64:/usr/lib64' ？因为我发现它在多次尝试负面路径后最终将 dso 加载到 lib64 或 /usr/lib64 中，这是系统 CPU 消耗，你知道，很多系统调用都是徒劳的。提前致谢。

```
open("/opt/xslt/lib/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/tidy/lib/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/mhash/lib/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/libmcrypt/lib/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/pcre/lib/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/curlssl/lib/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/lib64/mysql/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/xml2/lib/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/pcre/lib64/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/curlssl//lib64/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/php_with_imap_client//lib64/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/libmcrypt//lib64/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/mhash//lib64/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/tidy//lib64/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/xslt//lib64/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/lib64/tls/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/lib64/libselinux.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/lib64/libselinux.so.1", O_RDONLY) = 3

open("/opt/xslt/lib/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/tidy/lib/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/mhash/lib/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/libmcrypt/lib/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/pcre/lib/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/curlssl/lib/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/lib64/mysql/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/xml2/lib/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/pcre/lib64/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/curlssl//lib64/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/php_with_imap_client//lib64/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/libmcrypt//lib64/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/mhash//lib64/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/tidy//lib64/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/xslt//lib64/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/lib64/tls/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/lib64/libsepol.so.1", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/lib64/libsepol.so.1", O_RDONLY)  = 3
open("/opt/xslt/lib/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/tidy/lib/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/mhash/lib/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/libmcrypt/lib/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/pcre/lib/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/curlssl/lib/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/lib64/mysql/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/xml2/lib/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/pcre/lib64/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/curlssl//lib64/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/php_with_imap_client//lib64/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/libmcrypt//lib64/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/mhash//lib64/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/tidy//lib64/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/opt/xslt//lib64/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/lib64/tls/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/usr/lib64/libnss_files.so.2", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/lib64/libnss_files.so.2", O_RDONLY) = 3 
```

我的意见正确吗？还是以下原因导致 CPU 使用率高？

```
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/index.php", {st_mode=S_IFREG|0644, st_size=1971, ...}) = 0
access("/home/socialth/public_html/components/com_content/router.php", F_OK) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/index.php", {st_mode=S_IFREG|0644, st_size=1971, ...}) = 0
access("/home/socialth/public_html/components/com_content/router.php", F_OK) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/index.php", {st_mode=S_IFREG|0644, st_size=1971, ...}) = 0
access("/home/socialth/public_html/components/com_content/router.php", F_OK) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/index.php", {st_mode=S_IFREG|0644, st_size=1971, ...}) = 0
access("/home/socialth/public_html/components/com_content/router.php", F_OK) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0    
stat("/home/socialth/public_html/index.php", {st_mode=S_IFREG|0644, st_size=1971, ...}) = 0
access("/home/socialth/public_html/components/com_content/router.php", F_OK) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0
stat("/home/socialth/public_html/index.php", {st_mode=S_IFREG|0644, st_size=1971, ...}) = 0
access("/home/socialth/public_html/components/com_content/router.php", F_OK) = 0
lstat("/home", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth", {st_mode=S_IFDIR|0711, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html", {st_mode=S_IFDIR|0750, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/home/socialth/public_html/components/com_content/router.php", {st_mode=S_IFREG|0644, st_size=8157, ...}) = 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:54:52.273

您对此无能为力，尤其是因为所有这些软件包都已将自己安装在自己的小目录树中。虽然 /opt 是一个很好的概念，可以将整个包相互隔离，但这确实意味着任何为系统其余部分提供共享库的包都必须放入库搜索路径中，你最终会得到长时间无意义的打开/ stat 在搜索任何共享库时调用。您可以做的唯一优化可能是重新排列路径，以便不经常使用的库位于搜索路径的尾部，这样点击就会“更快”出现，并且不会浪费时间检查很少使用的区域。

你的 PHP 自动加载器也是如此。通向任何特定文件的长统计链也是必要的，因为系统会在每个阶段检查访问权限。

顺便说一句，这就是不鼓励使用 .htaccess 文件的确切原因。启用 .htaccess 后，Apache 必须检查通向请求文件的每个目录是否存在 .htaccess 文件。如果文件存在，则必须加载/解析/等...所有这些都会浪费大量的 CPU 周期和磁盘带宽。

.htaccess 在开发/测试时很好，但是一旦你有了一个可以工作的设置， .htaccess 指令应该被转移到主服务器的 .conf 文件中，所以它们只在服务器启动时加载/解析一次。

# python - Python中列表的n个最大值

> ID：15116236
> 
> 赞同：2
> 
> 时间：2013-02-27T15:44:46.133
> 
> 标签：python, sorting

获得给定列表的 n 个最高值的最佳方法是什么？如果我们处于 n 与 的长度相比相当小的情况下`alist`，是否有比以下更有效的方法：

```
alist.sort()
return alist[0:n] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T15:51:05.690

使用[`heapq`模块](http://docs.python.org/2/library/heapq.html)：

```
import heapq

return heapq.nlargest(n, l) 
```

如果您正在寻找相对较少数量的`n`元素，则使用堆队列比完整排序更有效。如果`n`更大，`sorted(l)[-n:]`则效率更高。`heapq.nlargest()`实现确实测试了这些条件，如果它可以确定等于或大于 ，将切换`sorted()`到`n`使用`len(l)`。

请注意，该`heapq`模块将就地修改列表（在`heapq.heapify()`列表上调用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:59:32.577

您的方法非常简洁，但可能不是最有效的。一种可能性是实现确定性选择算法（如[本文中的此处和视频中的](http://www.ics.uci.edu/~eppstein/161/960130.html)此处[所述](http://www.youtube.com/watch?v=XEh_jiob7lM)），然后将其调用为您想要的值。这将给你和 O(n) 整体操作，并且由于你正在谈论通过一个列表，我认为你不会能够变得*更好*。

# c# - 是否可以根据链接按钮检查某些复选框？

> ID：15116241
> 
> 赞同：0
> 
> 时间：2013-02-27T15:45:04.283
> 
> 标签：c#, asp.net, entity-framework

我有一个页面，我正在尝试为项目管理应用程序自定义“语言组”。（我们做的艺术作品经常需要翻译，我希望能够让用户点击链接按钮（或其他控件）将某些语言组合在一起。他们可能会点击“拉丁美洲”按钮，这将检查所有我定义为该组中的语言。我不想限制或限制他们的选择；我只想让按钮简单地预先检查一堆框，以提高流程效率。

我有一个包含所有语言的表，带有 ID，然后我有另一个包含语言组的表（带有`LanguageID`和 a `LanguageGroupID`）。

链接按钮将传递一个“ ”，然后如果在表中找到并对应于`LanguageGroupID`该框，则框将变为选中状态。`LanguageID``LanguageGroup``LanguageGroupID`

我用另一种方式构建了它，它有 的复选框`LanguageGroups`，当你检查它时，它会显示这些语言，但它很混乱，而且它没有按照我想要的方式工作。我会向您展示该代码，但我将放弃该方法！

那么，有没有人有一些基本的例子来说明我将如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:31:31.097

这可以通过多种方式实现。客户端，您可以使用javascript。一种情况是在您的语言表中有一个具有语言类型的列（这可能是可见的或隐藏的）。当用户检查语言类型时，这可能会触发一个遍历语言表的 javascript 事件，在语言类型列中查找值。如果匹配，请检查它。这一切都可以通过使用文档对象模型来完成。

或者，如果您使用带有代码的 asp.net，您可以在更新面板内实现一个网格视图，它附加到您创建的数据源（具有语言和语言类型值的类列表）。当用户检查语言类型时，会发生部分回发。然后，您可以遍历 gridview 的数据源并选中相应的复选框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:09:36.667

As far as I understand your question you're saying as a user I would want to click some button for "Latin America" and then a series of checkboxes would become checked, so PortugueseCB, SpanishCB, etcCB... Also it sounds like you have 3 items: Languages, Language ID, LanguageGroupId.
What you could do is create a class that contains the id and the language

```
public class LanguageIdent
{
public int ID; 
public string Language 
} 
```

Then create another class that contains a list of these

```
public class LanguageGroup
{
public List<LanguageIdent> LanguageID; 
} 
```

From there you can initialize and create methods as you see fit. Also you use the all the methods given to lists which is awesome. You could implement your check system perhaps like

```
private void SpanishCB_checkChanged(object sender, EventArgs e)
{
LanguageGroup LG = new LanguageGroup(); 
for(int i =0; i<LG.Count(); i++)
{
if(LG.LanguageID.ID == LatinAmericaID)
{
int index = checkedListBox1.IndexOf(nL.LanguageID[i].Language);
checkedListBox.SetItemsChecked(index, checked(CheckState.Checked));
}
}
} 
```

So in your form you would have a checkedListBox which you could arrange any way you want, alphabetically, region, etc. Then when the user checked "Latin America" only places languages belonging to that id will be checked. Hope this helps.

# javascript - 单击点时将 div 浮动到画布上方的代码

> ID：15116243
> 
> 赞同：0
> 
> 时间：2013-02-27T15:45:04.930
> 
> 标签：javascript, html, html5-canvas

我有一个 HTML5 画布元素和一个用于单击的事件侦听器，我需要将其链接到一个浮动 div，该 div 出现在用户单击画布的位置。最佳方法的代码建议？

我正在跟踪鼠标位置：

```
 var pos = getMousePos(canvas, evt);
        mousePos.x = pos.x;
        mousePos.y = pos.y; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:53:45.763

这应该可以解决问题：

**HTML：**

```
<div style="position: relative">
    <canvas />
    <div style="position: absolute" id="floatingDiv">Floating div</div>
</div> 
```

**Javascript：**

```
var pos = getMousePos(canvas, evt);
mousePos.x = pos.x;
mousePos.y = pos.y;
var floatingDiv = document.getElementById('floatingDiv');
floatingDiv.style.top = pos.y + 'px';
floatingDiv.style.left = pos.x + 'px'; 
```

# c++ - VBO 比绘制图元的过时方法慢 - 为什么？

> ID：15116250
> 
> 赞同：7
> 
> 时间：2013-02-27T15:45:13.733
> 
> 标签：c++, performance, opengl, graphics, vbo

我正在开发基于 Tile 的 OpenGL、C++ 应用程序。我正在从应用程序中添加示例屏幕，以便更清晰：

![](../Images/d146e65730bf60977c4e495c2ed00104.png)

我有`Tile`一个包含s数组的类`Object`。每个图块最多可以存储 15 个对象 - 例如`Tile`上面有绿色和黄色方块（两个对象），因此`Object`绘制时间为 10x10x15 = 1500 秒（在最坏的情况下，因为我没有处理“空”的对象） ）。通常它会更少，在我的测试中我使用了大约 600 个。`Object`有它自己的图形，可以绘制。每个都`Object`属于一个`Tile`，但可以移动（例如图片中的红色方块）。

`Object`s 背景将有一个边框，它们需要很好地扩展，所以我使用 9-patch 模式来绘制它们（它们由 9 个四边形组成）。

如果没有画`Tile`s（`Object`准确地说是他们的 s），我的应用程序大约有`600 fps`.

起初，我一直在使用过时的方法来绘制那些`Tile`s - 使用`glBegin(GL_QUADS)`/`glEnd()`和`glDisplayList`s。由于那次绘图，我的表现大幅下降 - 从`600`到`320 fps`。这就是我画它们的方式：

```
bool Background::draw(const TPoint& pos, int width, int height)
{
    if(width <= 0 || height <= 0)
        return false;
    //glFrontFace(GL_CW);
    glPushMatrix();
    glTranslatef((GLfloat)pos.x, (GLfloat)pos.y, 0.0f);     // Move background to right direction
    if((width != m_savedWidth) || (height != m_savedHeight))    // If size to draw is different than the one saved in display list,
        // then recalculate everything and save in display list
    {
        // That size will be now saved in display list
        m_savedWidth = width;
        m_savedHeight = height;

        // If this background doesn't have unique display list id specified yet,
        // then let OpenGL generate one
        if(m_displayListId == NO_DISPLAY_LIST_ID)
        {
            GLuint displayList;
            displayList = glGenLists(1);
            m_displayListId = displayList;
        }

        glNewList(m_displayListId, GL_COMPILE);

        GLfloat texelCentersOffsetX = (GLfloat)1/(2*m_width);

        // Instead of coordinates range 0..1 we need to specify new ones
        GLfloat maxTexCoordWidth = m_bTiling    ? (GLfloat)width/m_width    :   1.0;
        GLfloat maxTexCoordHeight = m_bTiling   ? (GLfloat)height/m_height  :   1.0;

        GLfloat maxTexCoordBorderX = (GLfloat)m_borderWidth/m_width;
        GLfloat maxTexCoordBorderY = (GLfloat)m_borderWidth/m_height;

        /* 9-cell-pattern

        -------------------
        | 1 |    2    | 3 |
        -------------------
        |   |         |   |
        | 4 |    9    | 5 |
        |   |         |   |
        -------------------
        | 6 |    7    | 8 |
        -------------------

        */

        glBindTexture(GL_TEXTURE_2D, m_texture);               // Select Our Texture

        // Top left quad [1]
        glBegin(GL_QUADS);
            // Bottom left
            glTexCoord2f(0.0, maxTexCoordBorderY);
            glVertex2i(0, 0 + m_borderWidth);

            // Top left
            glTexCoord2f(0.0, 0.0);
            glVertex2i(0, 0);

            // Top right
            glTexCoord2f(maxTexCoordBorderX, 0.0);
            glVertex2i(0 + m_borderWidth, 0);

            // Bottom right
            glTexCoord2f(maxTexCoordBorderX, maxTexCoordBorderY);
            glVertex2i(0 + m_borderWidth, 0 + m_borderWidth);
        glEnd();

        // Top middle quad [2]
        glBegin(GL_QUADS);
            // Bottom left
            glTexCoord2f(maxTexCoordBorderX + texelCentersOffsetX, maxTexCoordBorderY);
            glVertex2i(0 + m_borderWidth, 0 + m_borderWidth);

            // Top left
            glTexCoord2f(maxTexCoordBorderX + texelCentersOffsetX, 0.0);
            glVertex2i(0 + m_borderWidth, 0);

            // Top right
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX - texelCentersOffsetX, 0.0);
            glVertex2i(0 + width - m_borderWidth, 0);

            // Bottom right
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX - texelCentersOffsetX, maxTexCoordBorderY);
            glVertex2i(0 + width - m_borderWidth, 0 + m_borderWidth);
        glEnd();

        // Top right quad [3]
        glBegin(GL_QUADS);
            // Bottom left
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX, maxTexCoordBorderY);
            glVertex2i(0 + width - m_borderWidth, 0 + m_borderWidth);

            // Top left
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX, 0.0);
            glVertex2i(0 + width - m_borderWidth, 0);

            // Top right
            glTexCoord2f(1.0, 0.0);
            glVertex2i(0 + width, 0);

            // Bottom right
            glTexCoord2f(1.0, maxTexCoordBorderY);
            glVertex2i(0 + width, 0 + m_borderWidth);
        glEnd();

        // Middle left quad [4]
        glBegin(GL_QUADS);
            // Bottom left
            glTexCoord2f(0.0, (GLfloat)1.0 - maxTexCoordBorderY );
            glVertex2i(0, 0 + height - m_borderWidth);

            // Top left
            glTexCoord2f(0.0, maxTexCoordBorderY );
            glVertex2i(0, 0 + m_borderWidth);

            // Top right
            glTexCoord2f(maxTexCoordBorderX, maxTexCoordBorderY );
            glVertex2i(0 + m_borderWidth, 0 + m_borderWidth);

            // Bottom right
            glTexCoord2f(maxTexCoordBorderX, (GLfloat)1.0 - maxTexCoordBorderY );
            glVertex2i(0 + m_borderWidth, 0 + height - m_borderWidth);
        glEnd();

        // Middle right quad [5]
        glBegin(GL_QUADS);
            // Bottom left
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX, (GLfloat)1.0 - maxTexCoordBorderY);
            glVertex2i(0 + width - m_borderWidth, 0 + height - m_borderWidth);

            // Top left
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX, maxTexCoordBorderY);
            glVertex2i(0 + width - m_borderWidth, 0 + m_borderWidth);

            // Top right
            glTexCoord2f(1.0, maxTexCoordBorderY);
            glVertex2i(0 + width, 0 + m_borderWidth);

            // Bottom right
            glTexCoord2f(1.0, (GLfloat)1.0 - maxTexCoordBorderY);
            glVertex2i(0 + width, 0 + height - m_borderWidth);
        glEnd();

        // Bottom left quad [6]
        glBegin(GL_QUADS);
            // Bottom left
            glTexCoord2f(0.0f, 1.0);
            glVertex2i(0, 0 + height);

            // Top left
            glTexCoord2f(0.0f, (GLfloat)1.0 - maxTexCoordBorderY);
            glVertex2i(0, 0 + height - m_borderWidth);

            // Top right
            glTexCoord2f(maxTexCoordBorderX, (GLfloat)1.0 - maxTexCoordBorderY);
            glVertex2i(0 + m_borderWidth, 0 + height - m_borderWidth);

            // Bottom right
            glTexCoord2f(maxTexCoordBorderX, 1.0);
            glVertex2i(0 + m_borderWidth, 0 + height);
        glEnd();

        // Bottom middle quad [7]
        glBegin(GL_QUADS);
            // Bottom left
            glTexCoord2f(maxTexCoordBorderX + texelCentersOffsetX, 1.0);
            glVertex2i(0 + m_borderWidth, 0 + height);

            // Top left
            glTexCoord2f(maxTexCoordBorderX + texelCentersOffsetX, (GLfloat)1.0 - maxTexCoordBorderY);
            glVertex2i(0 + m_borderWidth, 0 + height - m_borderWidth);

            // Top right
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX - texelCentersOffsetX, (GLfloat)1.0 - maxTexCoordBorderY);
            glVertex2i(0 + width - m_borderWidth, 0 + height - m_borderWidth);

            // Bottom right
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX - texelCentersOffsetX, 1.0);
            glVertex2i(0 + width - m_borderWidth, 0 + height);
        glEnd();

        // Bottom right quad [8]
        glBegin(GL_QUADS);
            // Bottom left
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX, 1.0);
            glVertex2i(0 + width - m_borderWidth, 0 + height);

            // Top left
            glTexCoord2f((GLfloat)1.0 - maxTexCoordBorderX, (GLfloat)1.0 - maxTexCoordBorderY);
            glVertex2i(0 + width - m_borderWidth, 0 + height - m_borderWidth);

            // Top right
            glTexCoord2f(1.0, (GLfloat)1.0 - maxTexCoordBorderY);
            glVertex2i(0 + width, 0 + height - m_borderWidth);

            // Bottom right
            glTexCoord2f(1.0, 1.0);
            glVertex2i(0 + width, 0 + height);
        glEnd();

        GLfloat xTexOffset;
        GLfloat yTexOffset;

        if(m_borderWidth > 0)
        {
            glBindTexture(GL_TEXTURE_2D, m_centerTexture);     // If there's a border, we have to use
            // second texture now for middle quad
            xTexOffset = 0.0;                                  // We are using another texture, so middle middle quad
            yTexOffset = 0.0;                                  // has to be texture with a whole texture
        }
        else
        {
            // Don't bind any texture here - we're still using the same one

            xTexOffset = maxTexCoordBorderX;                   // But it implies using offset which equals
            yTexOffset = maxTexCoordBorderY;                   // maximum texture coordinates
        }

        // Middle middle quad [9]
        glBegin(GL_QUADS);
            // Bottom left
            glTexCoord2f(xTexOffset, maxTexCoordHeight - yTexOffset);
            glVertex2i(0 + m_borderWidth, 0 + height - m_borderWidth);

            // Top left
            glTexCoord2f(xTexOffset, yTexOffset);
            glVertex2i(0 + m_borderWidth, 0 + m_borderWidth);

            // Top right
            glTexCoord2f(maxTexCoordWidth - xTexOffset, yTexOffset);
            glVertex2i(0 + width - m_borderWidth, 0 + m_borderWidth);

            // Bottom right
            glTexCoord2f(maxTexCoordWidth - xTexOffset, maxTexCoordHeight - yTexOffset);
            glVertex2i(0 + width - m_borderWidth, 0 + height - m_borderWidth);
        glEnd();

        glEndList();
    }

    glCallList(m_displayListId); // Now we can call earlier or now created display list

    glPopMatrix();

    return true;
} 
```

那里可能有太多代码，但我想展示一切。此版本的主要内容是使用显示列表，`glVertex2i`但已弃用。

我认为这种减速的问题是使用我阅读的这种过时的方法很慢，所以我决定使用`VBO`. 我已经使用[了本教程](http://www.songho.ca/opengl/gl_vbo.html)，并根据它改变了我的方法，如下所示：

```
bool Background::draw(const TPoint& pos, int width, int height)
{
    if(width <= 0 || height <= 0)
        return false;

    glPushMatrix();
    glTranslatef((GLfloat)pos.x, (GLfloat)pos.y, 0.0f);             // Move background to right direction
    if((width != m_savedWidth) || (height != m_savedHeight))        // If size to draw is different than the one saved in display list,
                                                                    // then recalculate everything and save in display list
    {
        // That size will be now saved in display list
        m_savedWidth = width;
        m_savedHeight = height;

        GLfloat texelCentersOffsetX = (GLfloat)1/(2*m_width);

        // Instead of coordinates range 0..1 we need to specify new ones
        GLfloat maxTexCoordWidth = m_bTiling    ? (GLfloat)width/m_width    :   1.0;
        GLfloat maxTexCoordHeight = m_bTiling   ? (GLfloat)height/m_height  :   1.0;

        GLfloat maxTexCoordBorderX = (GLfloat)m_borderWidth/m_width;
        GLfloat maxTexCoordBorderY = (GLfloat)m_borderWidth/m_height;

        /* 9-cell-pattern, each number represents one quad

        -------------------
        | 1 |    2    | 3 |
        -------------------
        |   |         |   |
        | 4 |    9    | 5 |
        |   |         |   |
        -------------------
        | 6 |    7    | 8 |
        -------------------

        */

        /* How vertices are distributed on one quad made of two triangles

        v1 ------ v0
        |       /  |
        |     /    |
        |  /       |
        v2 ------ v3

        */

        GLfloat vertices[] = { 
                                // Top left quad [1]
                                m_borderWidth, 0, 0,                            // v0
                                0, 0, 0,                                        // v1       
                                0, m_borderWidth, 0,                            // v2               

                                0, m_borderWidth, 0,                            // v2
                                m_borderWidth, m_borderWidth, 0,                // v3
                                m_borderWidth, 0, 0,                            // v0

                                // Top middle quad [2]
                                width-m_borderWidth, 0, 0,                      // v0
                                m_borderWidth, 0, 0,                            // v1
                                m_borderWidth, m_borderWidth, 0,                // v2

                                m_borderWidth, m_borderWidth, 0,                // v2
                                width-m_borderWidth, m_borderWidth, 0,          // v3
                                width-m_borderWidth, 0, 0,                      // v0

                                // Top right quad [3]
                                width, 0, 0,                                    // v0  
                                width-m_borderWidth, 0, 0,                      // v1
                                width-m_borderWidth, m_borderWidth, 0,          // v2

                                width-m_borderWidth, m_borderWidth, 0,          // v2
                                width, m_borderWidth, 0,                        // v3
                                width, 0, 0,                                    // v0

                                // Middle left quad [4]
                                m_borderWidth, m_borderWidth, 0,                // v0
                                0, m_borderWidth, 0,                            // v1
                                0, height-m_borderWidth, 0,                     // v2

                                0, height-m_borderWidth, 0,                     // v2
                                m_borderWidth, height-m_borderWidth, 0,         // v3
                                m_borderWidth, m_borderWidth, 0,                // v0

                                // Middle right quad [5]
                                width, m_borderWidth, 0,                        // v0
                                width-m_borderWidth, m_borderWidth, 0,          // v1
                                width-m_borderWidth, height-m_borderWidth, 0,   // v2

                                width-m_borderWidth, height-m_borderWidth, 0,   // v2
                                width, height-m_borderWidth, 0,                 // v3
                                width, m_borderWidth, 0,                        // v0

                                // Bottom left quad [6]
                                m_borderWidth, height-m_borderWidth, 0,         // v0
                                0, height-m_borderWidth, 0,                     // v1
                                0, height, 0,                                   // v2

                                0, height, 0,                                   // v2
                                m_borderWidth, height, 0,                       // v3
                                m_borderWidth, height-m_borderWidth, 0,         // v0

                                // Bottom middle quad [7]
                                width-m_borderWidth, height-m_borderWidth, 0,   // v0
                                m_borderWidth, height-m_borderWidth, 0,         // v1
                                m_borderWidth, height, 0,                       // v2

                                m_borderWidth, height, 0,                       // v2
                                width-m_borderWidth, height, 0,                 // v3
                                width-m_borderWidth, height-m_borderWidth, 0,   // v0

                                // Bottom right quad [8]
                                width, height-m_borderWidth, 0,                 // v0
                                width-m_borderWidth, height-m_borderWidth, 0,   // v1
                                width-m_borderWidth, height, 0,                 // v2

                                width-m_borderWidth, height, 0,                 // v2
                                width, height, 0,                               // v3
                                width, height-m_borderWidth, 0,                 // v0

                                // Middle middle quad [9]
                                width-m_borderWidth, m_borderWidth, 0,          // v0
                                m_borderWidth, m_borderWidth, 0,                // v1
                                m_borderWidth, height-m_borderWidth, 0,         // v2

                                m_borderWidth, height-m_borderWidth, 0,         // v2
                                width-m_borderWidth, height-m_borderWidth, 0,   // v3
                                width-m_borderWidth, m_borderWidth, 0           // v0
                            };

        copy(vertices, vertices + 162, m_vCoords);              // 162, because we have 162 coordinates 

        int dataSize = 162 * sizeof(GLfloat);
        m_vboId = createVBO(m_vCoords, dataSize);

    }

    // bind VBOs for vertex array
    glBindBufferARB(GL_ARRAY_BUFFER_ARB, m_vboId);          // for vertex coordinates

    glEnableClientState(GL_VERTEX_ARRAY);                   // activate vertex coords array
        glVertexPointer(3, GL_FLOAT, 0, 0);                     
        glDrawArrays(GL_TRIANGLES, 0, 162);
    glDisableClientState(GL_VERTEX_ARRAY);                  // deactivate vertex array

    // bind with 0, so, switch back to normal pointer operation
    glBindBufferARB(GL_ARRAY_BUFFER_ARB, NO_VBO_ID);

    glPopMatrix();

    return true;
} 
```

它与以前的版本非常相似，但不是`glDisplayList`and`glVertex2i()`我使用`VBO`的是从存储在数组中的数据创建的。

但是结果让我失望了，因为我得到了性能下降而不是提升，我几乎没有 `~260 fps`，我必须注意，在这个方法版本中我还没有实现纹理的使用，所以现在只有四边形没有任何纹理绑定到它。

我已经阅读了几篇文章以找出导致速度变慢的原因，并发现这可能是由于大量的小`VBO`s 而我可能应该有一个`VBO`包含所有背景数据的文章，而不是`VBO`为每个背景分开。但问题是`Object`s 可以四处移动并且它们具有不同的纹理（并且纹理图集对我来说不是一个好的解决方案），因此我很难为那些`Object`改变了它们状态的 s 更新这些更改。现在，当`Object`s 被更改时，我只是重新创建它`VBO`，其余`VBO`的 s 保持不变。

所以我的问题是——我做错了什么？使用更大（~600）个小`VBO`s 真的比过时的绘图方法慢`glVertex2i`吗？在我的情况下，什么可能是——也许不是最好的，但更好的——解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T16:23:58.367

从外观上看，您正在用每一帧重新创建 VBO。如果您只想更改数据使用`glBufferSubData`，则需要`glBufferData`经历整个冗长的 VBO 初始化。

如果数据是静态的，则只创建一次 VBO，然后重复使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T17:33:15.543

仅仅因为固定功能的东西是旧的，不推荐使用的，通常不推荐，并不一定意味着它总是很慢。

带有缓冲区和着色器之类的花哨的“新”（已经有一段时间了）功能也不一定意味着一切都会闪电般快速。

当您将绘图包装在显示列表中时，您基本上是将一堆操作传递给驱动程序。这实际上为驱动程序提供了相当大的空间来优化正在发生的事情。它可以很好地将您正在做的大部分事情打包成一个非常高效的预打包 GPU 操作块。这可能比将数据打包到缓冲区并将它们发送出去*时*的效率略高。

这并不是说我会建议坚持使用旧式界面，但我当然不会感到惊讶，因为在某些情况下它做得很好。

# php - 使用 PEAR 从数据库中提取 Excel：带枚举的列

> ID：15116258
> 
> 赞同：0
> 
> 时间：2013-02-27T15:45:42.167
> 
> 标签：php, javascript, html, excel, pear

我的网站有一个部分允许使用数据库中的数据提取 Excel 文件。为了完成这个任务，我使用了 PEAR 库。

生成的 Excel 表由 32 列组成。我目前的目标是添加第 33 列，它只生成一个从 1 开始的数字并增加每一行（只是为了在打印后轻松识别不同的行）。我知道这可能是一项简单的任务，但我是一名初级程序员，因此不熟悉某些术语。因此，我很难找到我正在寻找的东西。

目前，这就是我使用 SQL 查询之后的数据填充表的方式，并且一切正常。

```
$worksheet->write($row, $column , $sqlquery[$i][$column], $format); 
```

据我了解，我应该能够使用类似于类似的 FOR 循环来完成我的目标

```
for ($i=1; $i<=5; $i++)
  {
  echo  $i;
  } 
```

但是，我已经在使用以下两个循环（一个用于 $row，一个用于 $column）

```
for ($i = 0; $i < count($sqlquery); $i++) {

    $row= $i + 4;

    for ($j = 0; $j < 33; $j++) { 
```

我在这里缺乏经验，我正在阻止，因为我不知道如何集成解决方案，或者我可能一起使用了错误的策略。

如果可能的话，最好使用完整的示例，因为它们对我来说更容易理解。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:50:25.263

在你的第二个循环中，你已经有了`i`一个计数器。只需添加 1 以使其对人类友好（从 1 而不是 0 开始）：

```
if ($i<33) {
    $worksheet->write($row, $column , $sqlquery[$i][$column], $format);
} else {
    $worksheet->write($row, $column , $i+1 , $format );
} 
```

当然，将您的内部循环更改为 $j < 34

# c# - 使用 .NET 2.0 解析 JSON

> ID：15116262
> 
> 赞同：8
> 
> 时间：2013-02-27T15:45:43.783
> 
> 标签：c#, json

我有一个用 .NET Framework 2.0 版用 C# 编写的应用程序。不幸的是，我没有更新到较新版本的 .NET 的选项。

我的应用程序正在调用返回一些 JSON 的 Web 服务。返回的 JSON 如下所示：

```
{"Status":1, "ID":"12345"} 
```

我需要解析这个字符串并获取相应的状态和 ID 值。如果我使用的是更高版本的 .NET 框架，我会使用`System.Json`命名空间。然而，我没有那种奢侈。我不知道如何解析这个响应。

有谁知道我如何在 .NET 2.0 中使用 C# 解析它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-27T15:47:28.393

是的，James Newton-King 的[JSON.NET](http://james.newtonking.com/projects/json-net.aspx)支持 .NET 2.0，并且使用起来相当简单。

我已经使用过很多次了，但 .NET 的 JavaScriptSerializer 并没有解决它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T15:47:26.687

您可以并且应该使用此库 [http://james.newtonking.com/pages/json-net.aspx做到这一点](http://james.newtonking.com/pages/json-net.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T15:47:40.050

您应该能够使用 JSON.NET，[这里是描述这个的文章](http://james.newtonking.com/archive/2009/08/02/net-2-0-support-added-to-json-net.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-27T09:40:55.380

不幸的是， [JSON.NET](http://james.newtonking.com/json)不适用于 .NET Compact Framework 2.0。

我将[Json 用于 Compact Framework](http://jsoncf.codeplex.com/)。

```
public class YourClass {        
  public int Status = 0;
  public String ID = "";
}

using CodeBetter.Json;

YourClass object = Converter.Deserialize<YourClass >(jsonString); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-20T09:35:47.197

通过一些小的改动，我能够将 Mono 的 System.Json 实现反向移植到 C# 2.0。

您需要从这里下载 6 个文件，或者您可以从[这里](http://vm1.duckdns.org/Public/System.Json/System.Json.zip)下载我的 C# 2.0[项目](https://github.com/mono/mono/tree/mono-4.8.0-branch/mcs/class/System.Json/System.Json)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-04-09T09:58:40.327

对于.net 2.0，您可以使用[Newtonsoft.Json](https://www.nuget.org/packages/Newtonsoft.Json/)并且可以像这样解析`JsonConvert.DeserializeObject<yourobject>(jsonString);`

# msbuild - 如何在 nant 脚本中指定 MSBuild 版本？

> ID：15116265
> 
> 赞同：5
> 
> 时间：2013-02-27T15:45:50.850
> 
> 标签：msbuild, nant, msbuild-4.0

我有一个 nant 脚本，它在其中一个目标中使用 msbuild 标记来构建 Visual Studio 2010 解决方案。

问题是它到达这一点时失败，错误是：

```
Solution file error MSB5014: File format version is not recognized.  MSBuild can only read solution files between versions 7.0 and 9.0, inclusive.

Failed to start MSBuild.

External Program Failed:  C:\Windows\Microsoft.NET\Framework\v2.0.50727\msbuild.exe (return code was 1) 
```

该错误是有道理的，如果它调用 .NET 2.0 版本的 MSBuild，它将无法编译 VS2010 解决方案。但是，我不知道如何让它调用正确版本的 MSBuild。

如果我运行'where MSBuild'（来自构建脚本失败的同一个 VS2010 命令提示符），我得到：

```
 C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe
 C:\Windows\Microsoft.NET\Framework\v3.5\MSBuild.exe 
```

如果我运行“msbuild /version”（同样是同一窗口），我会得到：

```
 Microsoft (R) Build Engine version 4.0.30319.17929
 [Microsoft .NET Framework, version 4.0.30319.18034]
 Copyright (C) Microsoft Corporation. All rights reserved.

 4.0.30319.17929 
```

所以一切看起来都应该使用 4.0 版本，但事实并非如此。知道什么给出了吗？我知道我之前已经解决过这个问题，但不记得是什么拯救了我的生命。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T15:42:17.017

我很欣赏答案，而且我知道 skolima 会起作用，解决方案最终就像添加这个标签一样简单：

```
 <property name="nant.settings.currentframework" value="net-3.5"/> 
```

再次感谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T22:51:41.840

旧版本的 NAnt/NAntContrib 默认为 v2.0。

听起来像：[.net 4.0 rc 的 Nant msbuild 任务](https://stackoverflow.com/questions/2353404/nant-msbuild-task-with-net-4-0-rc)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T23:17:30.330

我通常使用的是`NAnt` 使用`-t:net-4.0`switch（或任何其他框架版本）执行，并且在我的脚本中我必须[`<exec program="${framework::get-tool-path('msbuild.exe')}" managed="strict" />`](http://nant.sourceforge.net/release/latest/help/functions/framework.get-tool-path%28System.String%29.html)实际调用 msbuild。是的，这不使用内置[`<msbuild/>`](http://nantcontrib.sourceforge.net/release/latest/help/tasks/msbuild.html)任务，但更具弹性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T17:58:33.823

我回答了一个类似的问题：[<msbuild> task or msbuild.exe with NAnt?](https://stackoverflow.com/questions/1195389/msbuild-task-or-msbuild-exe-with-nant/1202121#1202121) 一会儿回来

本质上，如果您设置一个指向 MSBuild 可执行文件的属性，您可以在升级到比 NAnt 开箱即用支持的更新的 .NET 时避免（长期）问题。

# infragistics - 文本更改和离开的 Infragistics UltraTextEditor 事件？

> ID：15116267
> 
> 赞同：0
> 
> 时间：2013-02-27T15:45:58.807
> 
> 标签：infragistics

UltraTextEditor 是否存在仅在控件失去焦点且其文本已被修改时触发的事件？

例如，Ultragrids 有一个名为 AfterCellUpdate 的东西，我正在为 textEditor 寻找类似的东西......我在这里遗漏了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:33:26.763

有两个事件称为：

```
 private void UltraTextEditor_AfterExitEditMode(object sender, EventArgs e)
    private void UltraTextEditor_AfterEnterEditMode(object sender, EventArgs e) 
```

当`AfterExitEditMode`控件退出编辑模式时触发，此事件可以与标准`ValueChanged`事件一起使用以监视控件上的编辑。

如您所见，这些事件具有所有相同的签名，因此可以由相同的事件处理程序处理。

# android - 如何在android中实现自定义下拉菜单到actionbar

> ID：15116271
> 
> 赞同：4
> 
> 时间：2013-02-27T15:46:17.980
> 
> 标签：android, drop-down-menu, menu, android-actionbar

我正在尝试在操作栏中实现下拉菜单（项目数可能在运行时非常多）。例如：谷歌地图有一个。

如何在android中实现它。这里是我正在寻找的菜单。即，如果我单击 R 图像按钮，我想要一个下拉菜单。同样，如果我点击 L，应该会出现左侧菜单。知道该怎么做吗？.

我根本不想滑动，我想要一个下拉菜单。

![在此处输入图像描述](../Images/6399b996e35e817dd8ad1e561ba11371.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:10:56.407

关于操作栏的结构，左侧有两个选项，右侧有一个选项。

### 左边：

启用[操作栏下拉导航](http://developer.android.com/guide/topics/ui/actionbar.html#Dropdown)

```
 actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST); 
```

*或者*

在您的情况下，通过 a添加自定义`View`作为导航元素。[`ActionBar#setCustomView()`](http://developer.android.com/reference/android/app/ActionBar.html#setCustomView(int))`Spinner`

### 右边：

在您的情况下，仅将一个`MenuItem`作为[自定义 Action View添加到操作栏中。](http://developer.android.com/guide/topics/ui/actionbar.html#ActionView)`Spinner`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-07-02T11:04:53.517

操作栏右侧的下拉菜单是旧的导航设计，因此他们将其替换为新的[背景](https://material.io/components/backdrop)材质组件。

[![背景的行为](../Images/ad3f98353ea1636d1ad82c573e9fa546.png)](https://i.stack.imgur.com/kxhra.gif)

* * *

旧的解决方案是

```
 actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST); 
```

> 此[方法](https://developer.android.com/reference/android/app/ActionBar#setNavigationMode(int))在 API 级别 21 中已弃用。操作栏导航模式已被弃用，并且内联工具栏操作栏不支持。考虑改用其他[常见的导航模式](https://developer.android.com/guide/navigation/navigation-design-graph)。

# objective-c - 如何确定我的项目是否使用自动引用计数

> ID：15116272
> 
> 赞同：1
> 
> 时间：2013-02-27T15:46:18.470
> 
> 标签：objective-c, memory-management, automatic-ref-counting

我遇到了一个问题，我在 cocos2D box2D 项目中使用的对象被垃圾覆盖。经过一番调试后，我发现如果以下行更改为：

```
player = [[[Player alloc] initWithWorld:world atLocation:ccp(playerPositionX, playerPositionY)] autorelease]; 
```

至

```
player = [[Player alloc] initWithWorld:world atLocation:ccp(playerPositionX, playerPositionY)]; 
```

然后问题就消失了。这非常令人困惑，因为此代码和底层类定义或多或少是学习 Cocos2D 书中描述的 SpaceViking 项目的代码副本。

我突然想到，问题可能是当我创建新项目时，我可能选择了自动引用计数，而我可能没有为 SpaceViking 项目选择。我目前正在使用 xcode 4.6，无法弄清楚如何确定该项目中是否使用了 ARC。我去构建设置并搜索自动引用计数，但找不到它。

如何确定我的项目是否使用自动引用计数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T15:47:47.837

尝试这个：

```
#if __has_feature(objc_arc)
/* ARC is used */
#endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:53:57.017

尝试

```
[player release]; 
```

它应该给你“ARC Restrictions”错误

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T16:55:39.320

您已经可以告诉您在没有 ARC 的情况下进行构建：如果启用，您的调用`autorelease`将导致编译器错误。当然，这表明您的实际问题与 ARC 无关——删除`autorelease`调用可能会防止对象过度释放，但也很可能导致泄漏。

不过，除此之外：除了迄今为止建议的其他方法外，您还可以在 Xcode 中找到通常在项目或目标范围级别控制 ARC 的位置。在导航器中选择您的项目，然后在 Build Settings 选项卡中，在“Apple LLVM Compiler 4.2 - Language”下查找“Objective-C Automatic Reference Counting”（或使用顶部的搜索框查找“Automatic Reference Counting”或“ARC”。如果您使用的是其他人最初设置的项目，您可能还希望检查`-fobjc-arc`或`-fno-objc-arc`标志是否设置在每个文件级别。当您的项目和在 Xcode 中选择目标。

# python - Virtualenv下的Fabric：如何获取系统的Python库路径（不是virtualenv Python的库路径）

> ID：15116279
> 
> 赞同：1
> 
> 时间：2013-02-27T15:46:30.053
> 
> 标签：python, deployment, virtualenv, fabric

我开始使用 Fabric 作为 Python 项目的简单部署工具，但是有一项任务需要知道系统 Python 库路径在哪里，才能正确设置一些包符号链接。

所以问题是：如何在我的 fabfile 中获取系统 Python 路径？例如，此 Python 代码返回正确的库路径：

```
# Without virtualenv activated
>>> from distutils.sysconfig import get_python_lib;
>>> print get_python_lib()
'/usr/lib/python2.7/dist-packages'

# With virtualenv activated
>>> from distutils.sysconfig import get_python_lib;
>>> print get_python_lib()
'/home/mandx/dev/my_project/env/lib/python2.7/site-packages' 
```

就我而言，在 Fabric 中运行任务（并且 virtualenv 处于活动状态）时，我需要知道这两者。

我将解释我对此的需求：我想通过简单地将 HTML 和 CSS 内容传递给构造函数并调用渲染方法来使用[Wea​​syPrint](http://weasyprint.org/)生成 PDF。这种灵活性很好，因为现在可以将 PDF 布局用于具有 CSS 知识的设计师，并且 WeasyPrint 力求与 CSS3 兼容。

权衡是它依赖于一些不能用 Pip 安装的库（特别是 Pango、GdkPixbuf 和 Cairo）。所以我现在的解决方案是在系统范围内安装这些并将它们符号链接到项目的 virtualenv。

我不太喜欢使用 virtualenv`--system-site-packages`选项的想法，但我想听听为什么它比我的符号链接想法更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:03:29.297

只需运行一个 fabric shell 脚本命令任务来询问操作系统的 python：

```
/usr/bin/python -c 'from distutils.sysconfig import get_python_lib;print get_python_lib()' 
```

# asp.net-web-api - WebAPI SelfHost 站点

> ID：15116283
> 
> 赞同：1
> 
> 时间：2013-02-27T15:46:39.763
> 
> 标签：asp.net-web-api, self-hosting

是否可以像 Nancy 一样将 WebAPI 设置为 Self Host。这样它就承载了一个

> /api/...

部分提供 json 和 xml 响应并托管一个

> /内容/...

提供 *.jpg 和 *.html 和 *.js 的部分

我正在尝试创建一个以 WebAPI 作为后端的自托管单页应用程序，而我看到的唯一接近的是 Nancy。

WebAPI 自托管可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T21:12:06.203

刚刚写了一篇博客： [ASP.NET Web API 和使用 OWIN 和 Katana 的静态文件的零摩擦并行自托管](http://blog.alexonasp.net/post/2013/04/27/Zero-friction-parallel-self-hosting-of-ASPNET-Web-API-and-static-files-using-OWIN-and-Katana.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:43:19.973

我想你会发现 Katana 项目对你来说非常有趣。它允许您做的一件事是启动一个自托管服务器，该服务器可以同时托管 Web API、静态文件，甚至是 SignalR 等其他框架。

这是一个链接： http: [//katanaproject.codeplex.com/SourceControl/changeset/view/aaf5d99f63d8#README](http://katanaproject.codeplex.com/SourceControl/changeset/view/aaf5d99f63d8#README)

Filip 有一篇关于在 Katana 上托管 Web API 的博文：

[http://www.strathweb.com/2012/12/running-aspnet-web-api-with-owin-and-katana/](http://www.strathweb.com/2012/12/running-aspnet-web-api-with-owin-and-katana/)

# c# - 返回修改后的数据集

> ID：15116285
> 
> 赞同：0
> 
> 时间：2013-02-27T15:46:46.533
> 
> 标签：c#, asp.net, gridview, asmx, webmethod

我有以下`WebMethod`-

```
[WebMethod]

public DataSet fillGridview(string sql)
{
    using (OdbcConnection cnn = new OdbcConnection(DBcon))
    {
        if (string.IsNullOrEmpty(sql))
        {
            sql = "statement";
        }

        OdbcDataAdapter da = new OdbcDataAdapter(sql, cnn);
        DataSet ds = new DataSet();
        da.Fill(ds, "DB.TABLE");

        char tick = (char)0x221A;
        char untick = (char)'x';
        int r = 0;
        foreach (DataRow row in ds.Tables[0].Rows)
        {

            if (ds.Tables[0].Rows[r]["intValue"].ToString() == "-1")
            {
                ds.Tables[0].Rows[r]["intValue"] = untick + " No";
            }
            else
            {
                ds.Tables[0].Rows[r]["intValue"] = tick + " Yes";
            }

            r = r + 1;

        }

        return ds;

    } 
```

尝试将 of 转换为 或 时，`intValue`这`1`是`√ Yes`破坏性`-1`的`x No`。

错误是 -

> 输入字符串的格式不正确。无法在 intValue 列中存储 <√ Yes>。预期类型是 Int32。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:54:46.377

您的列`intValue`是一个`Int32`，因此您无法将其设置为一个`string`值，这是您在`foreach`循环中尝试执行的操作。

在设置时，您不需要该`int r = 0;`变量来访问循环中的行，这将为您提供当前行。`foreach``DataRow row`

如果您尝试将 GridView 上的列的值设置为新的字符串值，则可以使用[GridView.RowDataBound](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)事件根据隐藏列中的值设置一列的值。

或者，您可以将字符串列添加到 DataTable 并绑定到该列，见下文：

```
DataTable dt = ds.Tables[0];

dt.Columns.Add("TickedValue", typeof(String));

foreach (DataRow row in dt.Rows)
{

    if (row["intValue"].ToString() == "-1")
    {
        row["TickedValue"] = untick + " No";
    }
    else
    {
        row["TickedValue"] = tick + " Yes";
    }        
} 
```

# android - android apk 更新：我对最新版本了解多少？

> ID：15116291
> 
> 赞同：2
> 
> 时间：2013-02-27T15:47:05.827
> 
> 标签：android, version, apk, upgrade

我的应用程序有 2 个版本，清单中都有 android:versionCode="1" 。

1.  一个版本 (versionCode=1) 通过电子邮件分发。
2.  其他版本（也是 versionCode=1）在 google play 上发布。

versionCode 是一样的，但是 apk 不一样。它们的属性文件（原始资源 release.properties）中的一个值不同。这个属性使他们的行为有点不同。

如果我发布新版本 (versionCode=2)，两者都会更新。没关系，但我希望这种不同的行为能够持续存在。但我可以吗？我没有将属性文件写入磁盘，它在旧的 apk 中，将被覆盖。

我想了很多事情，但似乎想不出一种方法可以让两个版本保持不同的行为，因为我只知道更新时的最后一个版本代码，而我对最后一个版本一无所知，或者我知道吗？ ?

这个问题有解决方案吗？关于我可以尝试什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:53:20.803

我想正确的答案是没有解决方案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:22:48.330

你应该给你通过电子邮件分发的版本一个不同的包名。

如果您的电子邮件分发仍然很小，我会更改包名并使用更改后的包名重新分发它。但是，电子邮件分发上的用户将无法“更新”，这可能是一个大问题。但如果你的电子邮件分布很小，这个问题可能不会那么大。

# dependency-injection - 温莎城堡：无法解析控制器

> ID：15116295
> 
> 赞同：1
> 
> 时间：2013-02-27T15:47:12.080
> 
> 标签：dependency-injection, castle-windsor

我正在尝试在我的解决方案中使用 DI（即 Castle Windsor），但出现以下异常：

```
No component for supporting the service Company.Web.Controllers.DashboardController was found 
```

此异常发生在`WindsorControllerFactory.GetControllerInstance()`尝试解析控制器时（即`(IController)_kernel.Resolve(controllerType);`：）

**但是，**当我将 DI 安装程序和控制器工厂移动到 asp.net 应用程序并让该 Web 项目引用我的解决方案中的所有项目时，不会发生异常。

**问题：如何解决上述异常并将我的依赖注入及其配置放入它自己的程序集中（即：Company.Initialization）？**

请随时提供任何可以改进代码的建设性批评。

**当前解决方案项目设置**

1.  Company.Initialization 位于名为 Company.Initialization 的程序集中。这包含程序集包含 DI 配置和对 Castle Windosr 的引用。
2.  Company.Initialization 对每个程序集都有引用。
3.  Company.Web 位于名为 Company.Web 的程序集中
4.  Company.Web 是一个 ASP.NET MVC4 应用程序。

**ControllersInstaller.cs**

```
namespace Company.Initialization
{
    public class ControllersInstaller : IWindsorInstaller
    {
        /// <summary>
        /// Installs the controllers
        /// </summary>
        /// <param name="container"></param>
        /// <param name="store"></param>
        public void Install(IWindsorContainer container, IConfigurationStore store)
        {
            container.Register(FindControllers().LifestyleTransient());
        }

        /// <summary>
        /// Find controllers within this assembly in the same namespace as HomeController
        /// </summary>
        /// <returns></returns>
        private BasedOnDescriptor FindControllers()
        {
            return AllTypes.FromAssemblyNamed("Company.Web")
                 .BasedOn<IController>()
                 .If(Component.IsInNamespace(@"Company.Web.Controllers"))
                 .If(t => t.Name.EndsWith("Controller"));

        }

    }
} 
```

**RepoInstaller.cs**

```
namespace Company.Initialization
{
    public class RepoInstaller : IWindsorInstaller
    {

        public void Install(IWindsorContainer container, IConfigurationStore store)
        {
            container.Register(AllTypes.FromAssemblyNamed("Company.Services")
                .Where(type => type.Name.EndsWith("Service"))
                .WithService.DefaultInterfaces().LifestyleSingleton());

            container.Register(AllTypes.FromAssemblyNamed("Company.NHibernateProvider")
               .Where(type => type.Name.EndsWith("Repository"))
               .WithService.DefaultInterfaces().LifestyleSingleton());

        }
    }
} 
```

**WindsorControllerFactory.cs**

```
namespace Company.Initialization
{
    public class WindsorControllerFactory : DefaultControllerFactory
    {
        private readonly IKernel _kernel;

        /// <summary>
        /// Constructor
        /// </summary>
        /// <param name="kernel"></param>
        public WindsorControllerFactory(IKernel kernel)
        {
            _kernel = kernel;
        }

        /// <summary>
        /// Release the controller at the end of it's life cycle
        /// </summary>
        /// <param name="controller">The Interface to an MVC controller</param>
        public override void ReleaseController(IController controller)
        {
            _kernel.ReleaseComponent(controller);
        }

        /// <summary>
        /// Resolve a controller dependency
        /// </summary>
        /// <param name="requestContext">The HTTP context</param>
        /// <param name="controllerType">Type of controller to resolve</param>
        /// <returns>IController</returns>
        protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
        {
            if (controllerType == null)
            {
                throw new HttpException(404, string.Format("The controller for path '{0}' could not be found.",
                    requestContext.HttpContext.Request.Path));
            }
            return (IController)_kernel.Resolve(controllerType);
        }

    }
} 
```

# java - Java/JNLP：从参数列表中替换 user.home

> ID：15116306
> 
> 赞同：1
> 
> 时间：2013-02-27T15:47:34.283
> 
> 标签：java, properties, persistence, jnlp, java-web-start

我有一个 JNLP，我在其中为主应用程序提供了一些参数。

我想以可移植（至少 Windows/Linux）的方式提供用户主目录的子目录作为参数。

我试图查看 ${user.home}，但我真的不知道 JNLP 是否会执行替换。

**编辑**

说清楚：我不需要在客户端机器上存储或查找某些属性的方法。我需要一种通过包含用户主目录的 JNLP 传递参数的方法。这显然至少应该在 Windows 和 Linux 平台上工作。为了实现这个目标，我只想读取 JVM 设置的系统属性“user.home”。但是，我认为 Java Web Start 可以在客户端上执行一些替换。

确实，所需的参数可能与用户的主目录相关，而我的应用程序可以只加载系统属性。但是，当我不想要这种行为时，有一些用例。

我只是想用一种独立于平台的方式来指定用户的主目录……</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:28:16.380

在 jnlp 文件中由 Web 服务器自动替换的唯一值是：

*   $$codebase - 请求的 URL，JNLP 文件的名称除外
*   $$name JNLP 文件的名称
*   $$context Web 应用程序的基本 URL
*   $$site Web 服务器地址
*   $$hostname 服务器的名称

只有在 servlet 容器中使用 JNLPDownloadServlet 时才会发生这些替换。

主机在下载 JNLP 文件时不可能知道用户 home 参数的值。

如果您正在部署可以作为独立运行的 JNLP，并且您需要将参数加载到应用程序，我建议在特定位置使用属性文件，并在文件不存在时使用默认值（应用程序可以动态创建属性文件第一次运行时，或者您可以使用安装程序来执行此操作）。

下面是一个详细的例子：

```
public class Main {
    public static void main(String ... args) throws IOException{
         new Main();
    }

    private static Properties instance;

    public static Properties getProperties(){
        return instance;
    }

    private static Properties defaultProperties(){
        // implement default properties here
        Properties props = new Properties();
        props.setProperty("myApp.property1","someDefaultValue");
        return props;
    }

    public static void createDefaultPropsFile(File propsFile,Properties props) throws IOException {
        propsFile.getParentFile().mkdirs();            
        props.store(new FileWriter(propsFile),"My App Properties");
    }

    private Main() throws IOException{
         File appDir = new File(System.getProperty("user.home"), "myApp");
         // find property file
         File propsFile = new File(appDir, "settings.properties");
         Properties appProperties = new Properties(defaultProperties());
         if(!propsFile.exists()){
             createDefaultPropsFile(propsFile,appProperties);
         } else {
             appProperties.load(new FileReader(propsFile));
         }
         // this should really be done using a singleton or something similar
         instance = appProperties; 
         System.out.println("Property"+getProperties().getProperty("myApp.property1"));        
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T13:02:09.967

感谢您的回答，但我无法将属性存储在用户目录中。我只希望参数列表是可移植的，以便始终找到用户主目录。

我的解决方案并不完美，它只是遵循 Apache 的 Ant 方式：将出现的 ${myvariable} 替换为系统属性中的相应值。

这是代码：

```
public class PropertySubstitutor {
    private static final Pattern VARIABLE_PATTERN = Pattern.compile("\\$\\{(.*?)\\}");

    public static String substitute(String source) {
        Matcher matcher = VARIABLE_PATTERN.matcher(source);
        Properties properties = System.getProperties();
        StringBuffer buffer = new StringBuffer(source.length());
        while (matcher.find()) {
            matcher.appendReplacement(buffer, properties.getProperty(matcher.group(1), ""));
        }
        matcher.appendTail(buffer);
        System.out.println(buffer.toString());
        return buffer.toString();
    }

    private PropertySubstitutor() {}
} 
```

可以更改此帮助程序以使用用户定义的属性对象。

我使用缓慢的正则表达式引擎，因为我只需要在应用程序启动时解析两个或参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-27T17:01:44.240

如果您重定向桌面 - java 7 及以下版本似乎错误地设置了 user.home。例如，不符合 %userprofile% 。

# c++ - 我应该用什么在 Windows 上编译 C++？

> ID：15116310
> 
> 赞同：0
> 
> 时间：2013-02-27T15:47:46.680
> 
> 标签：c++, windows, unix

我是一名 C++ 程序员，来自在 GCC 中编译的 UNIX 环境，想要开始为 Windows 编译程序。你们会在 IDE/编译器方面推荐什么？与这两种环境相比，我真正要研究的是什么不同？我不打算对我的应用程序做任何真正花哨的事情，只是想要一个带有输入和输出的基本终端窗口，这样我就可以编写一些基本的应用程序。

我已经开始下载 Visual Studio 2012 express 但我想获得更多意见。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T15:51:35.547

`VS Express for Desktop`比我在 Linux 上使用过的任何 IDE 都要好得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T15:52:26.713

在 Windows 中，您应该主要使用 Microsoft 的编译器[**Visual c++**](http://en.wikipedia.org/wiki/Visual_C%2B%2B)，并辅以

*   优化的替代方案（例如[英特尔 C++ 编译器](http://en.wikipedia.org/wiki/Intel_C%2B%2B)），

*   符合标准的前端（我不知道任何当前，但对于 C++03，您可以使用[Comeau](http://en.wikipedia.org/wiki/Comeau_C/C%2B%2B)），以及

*   用于检查可移植性的“2 号”编译器，它只是 GNU 工具链的[**g++**编译器](http://en.wikipedia.org/wiki/G%2B%2B)（或者可以在 *nix 中编译真正可移植的源代码，但这对 Windows 特定代码没有帮助：g++ 确实支持 Windows 特定事物）。

Visual C++ 和 g++ 是免费的。

对于专业工作，公司应购买完整的**Visual Studio** IDE 和**MSDN 库**订阅。作为学生，您可以通过[Dreamspark 程序](https://www.dreamspark.com/)免费获得完整的 Visual Studio 。作为一个爱好者免费获得[Visual Studio Express](http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-windows-desktop)（而我，作为一个爱好者，从微软得到了完整的 Visual Studio 作为礼物，不知道他们为什么这么喜欢我）。

据我所知，英特尔和 Comeau 只是商业用途。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-27T15:50:37.927

使用 TurboC++ 或只是 TurboC。IT 可在线免费获得。但是考虑到 UI，Visual Studio 或具体来说是 Visual C++ 更好。

# python - 在 Flask+Heroku 上将 HTTP 重定向到 HTTPS

> ID：15116312
> 
> 赞同：7
> 
> 时间：2013-02-27T15:47:48.053
> 
> 标签：python, heroku, https, flask

当我尝试将传入流量重定向到 https 时，我得到一个无限重定向循环。

```
@app.route('/checkout/')                                                                                                                                                                                        
def checkout():                                                                                                                                                                                                 
    checkout = "https://myapp.herokuapp.com/checkout/"                                                                                                                                              
    if checkout != request.url:                                                                                                                                                                             
        print checkout, request.url                                                                                                                                                                             
        return redirect(checkout)                                                                                                                                                                               
    return render_template('checkout.html', key=keys['publishable_key']) 
```

request.url 永远不会更改为前缀 https。我想使用 heroku 的背驮式 ssl 来最小化成本。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-03-03T02:23:05.047

1) 执行“pip install flask-sslify”

（github在这里：[https](https://github.com/kennethreitz/flask-sslify) ://github.com/kennethreitz/flask-sslify ）

2) 包括以下几行：

```
from flask_sslify import SSLify
if 'DYNO' in os.environ: # only trigger SSLify if the app is running on Heroku
    sslify = SSLify(app) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-27T16:08:01.137

在 Heroku 上，SSL (https) 在到达您的应用程序之前就被终止，因此您的应用程序永远不会真正看到 SSL 流量。要检查是否使用 https 发出请求，您必须检查`x-forwarded-proto`标头。更多信息：[如何仅在 Heroku https 上制作 python？](https://stackoverflow.com/questions/8436666/how-to-make-python-on-heroku-https-only)

更新：为了您的使用，您应该只检查 request.url 中的“myapp.herokuapp.com/checkout/”；并验证标头是“https”

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-03-13T07:11:31.210

我尝试了 SSLify、url_for _scheme，并设置了 PREFERRED_URL_SCHEME；但是至少在发布级别上没有成功。（在本地运行良好）然后我想；

```
@app.before_request
def beforeRequest():
    if not request.url.startswith('https'):
        return redirect(request.url.replace('http', 'https', 1)) 
```

这本质上是另一种无需任何配置或扩展即可完成的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T17:26:14.403

我能够将 flask-sslify 代码重新用于单个视图。只需要检查是否使用 SSL 发出请求并将正确的标头添加到响应中。[https://github.com/kennethreitz/flask-sslify](https://github.com/kennethreitz/flask-sslify)

```
@app.route('/checkout/')                                                                                                                                                                                        
def checkout():                                                                                                                                                                                                 
    checkout = "https://myapp.herokuapp.com/checkout/"                                                                                                                                              
    if request.headers.get('X-Forwarded-Proto', 'http') == 'https':                                                                                                                                             
        resp = make_response(render_template('checkout.html', key=keys['publishable_key']))                                                                                                              
        return set_hsts_header(resp)                                                                                                                                                                            
    return redirect(checkout, code=302)                                                                                                                                                                         

def set_hsts_header(response):                                                                                                                                                                                  
    """Adds HSTS header to each response."""                                                                                                                                                                    
    response.headers.setdefault('Strict-Transport-Security', hsts_header)                                                                                                                                       
    return response                                                                                                                                                                                             

def hsts_header():                                                                                                                                                                                              
    """Returns the proper HSTS policy."""                                                                                                                                                                       
    hsts_policy = 'max-age={0}'.format(31536000) #year in seconds                                                                                                                                               
    if self.hsts_include_subdomains:                                                                                                                                                                            
        hsts_policy += '; includeSubDomains'                                                                                                                                                                    
        return hsts_policy 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-15T12:16:46.543

你只需要检查`X-Forwarded-Proto`标题。如果为 false，则重定向到等效的 https url。

这里是对在 heroku 上运行的烧瓶应用程序上的所有调用强制执行 https 的代码：

```
@app.before_request
def enforceHttpsInHeroku():
  if request.headers.get('X-Forwarded-Proto') == 'http':
  url = request.url.replace('http://', 'https://', 1)
  code = 301
  return redirect(url, code=code) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-24T19:14:56.067

你可以这样做：

```
@app.before_request
def before_request():
    if 'DYNO' in os.environ: # Only runs when on heroku
        if request.url.startswith('http://'):
            url = request.url.replace('http://', 'https://', 1)
            code = 301
            return redirect(url, code=code) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-19T22:42:32.797

在我对[另一个问题](https://stackoverflow.com/a/67611776/15016163)的回答中，我已经说明了最新的 Flask 建议。使用 Talisman 代替 SSLify。

> 对于 Flask 使用[Talisman](https://github.com/GoogleCloudPlatform/flask-talisman)。[Flask](https://flask.palletsprojects.com/en/2.0.x/security/#security-headers)、[Heroku](https://help.heroku.com/J2R1S4T8/can-heroku-force-an-application-to-use-ssl-tls)和[SSLify](https://github.com/kennethreitz/flask-sslify) 文档更倾向于使用[Talisman](https://github.com/GoogleCloudPlatform/flask-talisman)而不是 SSLify，因为后者不再维护。
> 
> 从[SSLify](https://github.com/kennethreitz/flask-sslify)：
> 
> > 该扩展不再维护，更喜欢使用 Flask-Talisman，因为 Flask 安全指南鼓励使用它。
> 
> 通过 pip 安装：
> 
> ```
> $ pip install flask-talisman 
> ```
> 
> 实例化扩展（示例）：
> 
> ```
> from flask import Flask
> from flask_talisman import Talisman
> 
> app = Flask(__name__)
> if 'DYNO' in os.environ:
>     Talisman(app) 
> ```
> 
> Talisman 默认启用 CSP（内容安全策略），仅允许加载来自同一域的资源。如果您想禁用它并处理其影响：
> 
> ```
> Talisman(app, content_security_policy=None) 
> ```
> 
> 如果您不想禁用它，您已将 `content_security_policy`参数设置为允许来自外部域的资源，例如 CDN。为此，请参阅 [文档](https://github.com/GoogleCloudPlatform/flask-talisman)。

# java - 如何使用 Criteria API 根据不同的条件找到特定的人？

> ID：15116315
> 
> 赞同：1
> 
> 时间：2013-02-27T15:48:03.730
> 
> 标签：java, database, jpa, criteria-api

我喜欢过去仅仅通过阅读您的主题而获得的所有帮助，但是我现在偶然发现了一些我根本不知道如何实施的东西。

**编辑：忘记了很大一部分-> 我的框架：我在 Netbeans 上运行它，使用带有 EJB 的 Glassfish 服务器和在 MySQL 服务器上运行的数据库。我也在使用JPA。**

我有一个包含多个表的数据库，但有 3 个我需要使用连接，以便让符合条件的人从中脱颖而出。

我的数据库： ![我的数据库](../Images/33eaf92cb0a39e531f0190f5396b3d41.png)

我将尝试简化我正在尝试做的事情，实际上可能会帮助我在打字时对此有所了解。

我试图

*   在可用性中查找用户发送的日期介于两者之间的所有 pid。示例：用户在 2010 年 10 月 10 日至 2011 年 1 月 1 日期间发送，我试图找到所有 pid，在可用性中，from_date 为“高于”或超过 2010-10-10 并且 to_date 低于超过或不超过 2011-01-01。

*   在 Competence_profile 中查找所有 pid，其中，competent_name 是用户发送的姓名，years_of_experience 至少等于或大于用户发送的经验年限。

*   以某种方式加入它们，以便我从 Person 表中获取 Person p，它与加入后剩余的 pid 匹配（这意味着，该 pid 存在于标准的可用性和 Competence_profile 中）。

如何根据 Criteria API 执行此类操作？我玩了一会儿，阅读了很多教程和主题，但没有人能够真正回答我如何以这种形式组合它的问题。

很感谢任何形式的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:08:15.483

这与 Hibernate Criteria API 一起使用。

```
 // First set up a subquery to get the ids of Persons who are available
     // (assuming that the Person must be available for the entire duration)
     DetachedCriteria dc = DetachedCriteria.forClass(Person.class)
         .setProjections(Projections.id())
         .createAlias("availability", "a")
         .add(Restrictions.le("a.to", endDate)
         .add(Restrictions.ge("a.from", startDate);

     Criteria crit = session.createCriteria(Person.class)
          .createAlias("competence", "c")
          .add(Restrictions.eq("c.name", competenceName)
          .add(Subqueries.in(dc,"id");

     List<Person> people = crit.list(); 
```

# makefile - 获取 GNU makefile 的包含树

> ID：15116316
> 
> 赞同：0
> 
> 时间：2013-02-27T15:48:08.540
> 
> 标签：makefile, gnu

在现有的 GNU Make 构建系统中，我希望看到 makefile 包含的树。我该怎么做？像[你知道项目\文件中包含文件的工具构建树吗？](https://stackoverflow.com/questions/1226044/do-you-know-tool-building-tree-of-include-files-in-project-file)但对于 GNU Make 而不是 C 和 C++。

我感兴趣的一个相关但略有不同的功能：能够将 $(info ...) 语句放入 makefile 并让它打印出包含该 info 语句的回溯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:42:02.090

如果您只需要包含的 makefile 列表，`$(info Included files: ${MAKEFILE_LIST})`主 makefile 底部的 a 就可以满足要求。

但是，如果您确实想要一棵树，则必须将所有内容替换`include <file>`为`$(call include,<file>)`. 该`include`功能将类似于：

```
space :=
space +=
${space} := ${space}

stack := $(firstword ${MAKEFILE_LIST})

define includefunc
  stack := $(subst ${ },|,$(strip ${MAKEFILE_LIST} $1)) ${stack}
  $(info INCLUDES $(firstword ${stack}))
  include $1
  stack := $(wordlist 2,$(words ${stack}),${stack})
  MAKEFILE_LIST := $(subst |, ,${stack})
endef

include = $(eval $(value includefunc))

$(call include,1.mak)
$(call include,_1/1.mak)
$(call include,folder/Makefile)

.PHONY: all
all: ; echo $@ success 
```

# php - 如何使用 PDO MySQL 查找投票数

> ID：15116317
> 
> 赞同：0
> 
> 时间：2013-02-27T15:48:10.270
> 
> 标签：php, mysql, pdo, count

我有一个 PHP 脚本，它允许基于登录系统进行投票。

我正在尝试将所有代码切换到 PDO 而不是 MySQL。我无法切换这段特定的代码。这是原文：

```
 $get_votes = mysql_query("SELECT * FROM votes WHERE poll_id = 1 "); //select all votes to this poll

$votes = array(); //the array that will be containing all votes

$total_votes = 0;

while($vote = mysql_fetch_assoc($get_votes)) { //retrieve them
$answer_id = $vote['answer_id'];
$votes[$answer_id] = (int)$votes[$answer_id]+1; //add 1 vote for this particular answer
$total_votes++;
}

$get_answers = mysql_query("SELECT * FROM answers WHERE poll_id = 1 ");

while($answer = mysql_fetch_assoc($get_answers)) { //loop through all answers

$id = $answer['id']; 
$width = round((int)$votes[$id]/$total_votes*99+1); //100%

echo ' This Answer has ('.(int)$votes[$id].' vote'.((int)$votes[$id] != 1 ? "s":"").')
   ';

} 
```

我想保留的是`$width`票数和票数`$votes[$id]`。如果我提供了答案变量，无论是从数组计算全部还是计算单个答案结果的情况。

我在这里无所适从，我很快就会没有头发，所以如果有帮助，欢迎任何建议/批评。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:53:47.030

```
$q = 'SELECT * FROM votes WHERE poll_id = :poll_id';
$params = array(':poll_id' => 1);
$stmt = $db->prepare($q);
$stmt->execute($params);
while ($row = $stmt->fetch()) { 
```

将是转换为 PDO 的非常基本的查询/结果（这只是在 PDO 中执行此操作的一种方法）。你到底有什么问题？PHP 站点上的 PDO 文档非常强大，其中包含大量示例。

你试过什么？什么不工作？您遇到了哪些意外行为或错误？在给出任何真正的答案之前，需要更多关于实际问题的信息。

-- 从评论中编辑 --

您的原始代码应该可以正常工作

```
while ($row = $stmt->fetch()) {
  $answer_id = $row['answer_id'];
} 
```

应该仍然可以工作，你可以从那里开始。

# c# - 从输出中删除异常消息

> ID：15116320
> 
> 赞同：3
> 
> 时间：2013-02-27T15:48:17.553
> 
> 标签：c#, visual-studio, exception, output

我正在调试我的应用程序，所以我经常使用代码`Debug.WriteLine();`。问题是我也有`TimeoutException`几乎每 500 毫秒运行一次的线程，我收到此错误不是问题，因为我正在从串行端口接收数据，问题是它也填满了我的输出日志快，阅读我自己创建的其他消息。

**问题：**如何从我的输出日志中删除以下异常：`A first chance exception of type 'System.TimeoutException' occurred in System.dll`？

**回答：**

问题已通过 2 种方法解决输出日志中的异常：

**Tim Coker 的第一种方法：**

工具 -> 选项 -> 调试 -> 输出窗口 -> 异常消息关闭。

**查理·基利安的第二种方法**

在输出日志上鼠标右键，取消选中异常消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:52:25.710

您可以通过工具 > 选项 > 调试 > 输出窗口调整输出窗口的内容。您可能想要禁用“异常消息”。

# ruby-on-rails-3 - 将复选框添加到简单表单以输入不在模型中

> ID：15116321
> 
> 赞同：8
> 
> 时间：2013-02-27T15:48:20.883
> 
> 标签：ruby-on-rails-3, simple-form

我正在尝试在 Rails 中的简单表单中添加一个复选框输入。我只需要 javascript 的输入，实际上并不希望它在我的模型文件中。

我了解到，为了向模型中不存在的简单表单添加输入，必须在参数中传递一个值

```
input_html: {value: true} 
```

这适用于文本输入，但我无法让它适用于复选框。

我试过了

```
<%= f.input :current_job, :as => :check_box, input_html: {value: false} %> 
```

和

```
<%= f.input :current_job, :as => :check_box, input_html: {checked: false} %> 
```

但我得到一个错误说

```
No input found for check_box 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-09-23T07:32:34.977

您应该在字段中使用类型作为**布尔值。**在你的情况下，你可以改变这个：

```
 <%= f.input :current_job, :as => :check_box, input_html: {checked: false} %> 
```

对此：

```
 <%= f.input :current_job, :as => :boolean, input_html: {checked: false} %> 
```

# php - 文件上传和配额

> ID：15116324
> 
> 赞同：0
> 
> 时间：2013-02-27T15:48:25.460
> 
> 标签：php, file-upload, upload

我正在开发一个 web 项目，在不同的应用程序中分开（使用 SSO 让用户同时登录所有应用程序），用户可以在所有应用程序中上传文件。

问题是，每个应用程序都以自己的方式上传文件，将文件上传到自己的位置，从而使服务器变得混乱并无法追踪文件属于哪个文件。

我想为此开发一个组件，以便所有应用程序通过它上传并跟踪每个用户配额、文件等。

因为我可以自己弄清楚如何做到这一点，所以我想知道这样做是否有好的做法。有没有我可以阅读的文章？有没有可用的系统？另外，如果您想知道的话，我正在使用 PHP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:16:47.407

您需要做的第一件事就是开始 :) 因为这毕竟是编程，反复试验。您可能会发现自己必须重新开始任务的一半，但这在工作描述中。

但我同意在开始之前制定计划非常有用。我不知道任何涵盖正确做事的良好实践和标准的教程，但我会尝试给你一些提示。

*   始终检查 MIME 类型、扩展名和文件大小。您还可以阻止 .htaccess 中的某些类型的文件，以防万一您忘记或不够小心

* * *

```
<FilesMatch ".(htaccess|htpasswd|php|js|exe|bat)$"> // extentions to block
Order Allow,Deny
Deny from all
</FilesMatch> 
```

* * *

您还可以考虑使用白名单而不是黑名单。

*   有一些明确定义的位置，这在很大程度上取决于您需要的文件数量以及为什么需要它们。

如果您有很多文件，您可以以哈希表的形式创建文件夹结构。例如，您可以去除非字母数字字符，并根据文件的第一个字母创建 2 级文件夹。

**例子：**

test_image.png => 上传/app_x `/t/e/`test_image.png

another_img.png => 上传/app_x `/a/n/`test_image.png

* * *

您也可以为此使用日期（就像**wordpress**一样）：

test_image.png => 上传/app_x `/2013/02/27/`test_image.png

another_img.png => 上传/app_x `/2013/02/26/`test_image.png

* * *

如果您有用户上传的文件，您可能需要为每个用户创建一个文件夹（**uploads/app_y/user_x/his_file.pdf**）。

这将使在服务器上查找文件的速度更快。最好在开始之前记住文件夹结构，并且最好考虑所有可能的文件类型。

*   如有必要，请考虑更改文件的名称。例如，这取决于您是否希望使文件公开可见。

当我回到家时会继续这个列表，但这应该是一些值得深思的地方。

# java - 无法在类路径上找到 Clojure 资源

> ID：15116334
> 
> 赞同：1
> 
> 时间：2013-02-27T15:49:05.510
> 
> 标签：java, clojure, leiningen, counterclockwise

我正在尝试在我的 Java 代码中访问我的一些 clojure 函数（我正在使用 Eclipse 和 CounterClockWise）。首先，我不知道该怎么做？[但后来我在这里](https://stackoverflow.com/questions/15071622/how-to-access-clojure-functions-in-java)找到了一些答案。

我用于在我的 Java 代码`clojure.lang.RT package`中调用文件。`.clj`在命名命名空间时，`.clj`文件的正确约定已被遵循，就像在核心是文件`ns test.clojure.core`的包中一样。同样根据一些信息，我在我的.`test.clojure``.clj``src/test/java``src/test/clojure``project.clj`

但是，当我运行我的 Java 文件时，会出现以下错误 - a) `Could not locate Clojure resource on classpath`b) `Attempting to call unbound fn`。

请如果社区中的任何人可以通过详细的程序或教程帮助我（假设我是绝对的初学者），我将不胜感激，因为我可以获得（用于使用`clojure.lang.RT`）的信息非常少。

期待得到一个完整的答案来结束我的沮丧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:27:38.660

我猜你使用`RT.loadResourceScript`的是导致问题的。你可以尝试这样的事情：

```
//Load the namespace 
    RT.var("clojure.core","eval").invoke(RT.var("clojure.core","read-string").invoke("(use 'test.clojure.core)"));

//Find a function in namespace
    IFn fn = (IFn)RT.var("test.clojure.core","hello");

//Call that function
    fn.invoke(); 
```

# php - 正则表达式从此 url 查找图像名称和扩展名

> ID：15116336
> 
> 赞同：1
> 
> 时间：2013-02-27T15:49:10.937
> 
> 标签：php, regex

我有这个自动生成的 url。

```
uploads/1/0/1/7/10178123/4320885_orig.png 
```

我需要从此 url 获取图像的名称和扩展名，在本例中为 4320885_orig.png

我无法编写正则表达式来查找名称和扩展名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T15:51:44.617

我建议你检查 php 的[Basename](http://php.net/manual/en/function.basename.php)函数而不是使用正则表达式

```
echo basename("uploads/1/0/1/7/10178123/4320885_orig.png");

//result: 4320885_orig.png 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T15:51:59.353

不要使用正则表达式，使用`pathinfo`...

```
echo pathinfo('uploads/1/0/1/7/10178123/4320885_orig.png', PATHINFO_BASENAME); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T15:52:26.720

尝试`pathinfo()`：

```
$path = 'uploads/1/0/1/7/10178123/4320885_orig.png';

echo pathinfo($path, PATHINFO_BASENAME); //png 
```

您还可以获得路径的其他组件：

```
$path_parts = pathinfo($path);

echo $path_parts['extension'], "\n"; //png
echo $path_parts['dirname'],   "\n"; //uploads/1/0/1/7/10178123
echo $path_parts['basename'],  "\n"; //4320885_orig.png
echo $path_parts['filename'],  "\n"; //4320885_orig 
```

有关更多信息，请参阅[PHP 文档。`pathinfo()`](http://php.net/manual/en/function.pathinfo.php)

# c# - 使用 C# WebBrowser 实现 Web 自动化

> ID：15116338
> 
> 赞同：0
> 
> 时间：2013-02-27T15:49:15.123
> 
> 标签：c#, html, .net, webautomation

我正处于尝试从网站自动输入和收集数据的早期阶段。我有一个 16,000 行的 CSV 文件。对于每一行，我想将该行中的数据输入到`textarea`网页上的 a 中。然后，该网页可以使用该数据执行一些计算并吐出我收集的答案。具体来说，在网页[http://www.mirbase.org/search.shtml](http://www.mirbase.org/search.shtml)，我想在底部的序列文本框中输入一个序列，点击“Search miRNAs”按钮，然后在下一个收集结果页。

我现在的计划是使用 C# `WebBrowser`。我的理解是我可以访问`HtmlDocument`by或坐标`id`中的各个元素。`name`最后一个选项并不理想，因为如果我将这个程序分发给其他人，我不能确定他们会在相同的坐标下使用。至于其他2个选项，`textarea`有一个`name`，但它与表单名称相同，所以我不知道如何访问它。我想点击的按钮既没有 a`name`也没有`id`.

有人对如何访问我需要的元素有任何想法吗？我绝不会使用这种方法，所以如果有更简单/更好的方法，我当然愿意接受建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T15:59:18.947

该`WebBrowser`课程不是为此而设计的，因此您为什么要提出问题。

您需要研究专*为*Web 自动化设计的工具。

由于您使用的是 C#，所以 Selenium 有一组很棒的 C# 绑定，它可以解决您的问题，因为您将使用不同的定位器（专门通过 CSS 选择器或 XPath 定位元素）。

[http://docs.seleniumhq.org/](http://docs.seleniumhq.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:08:13.250

检查 mshtml - [msdn 上的Mshtml](http://msdn.microsoft.com/en-us/library/bb498651%28v=vs.85%29.aspx)

您可以将它与 WebBrowser 对象一起使用。

将 Microsoft.mshtml 引用添加到您的项目和类中的 using mshtml 声明。

使用 mshtml，您可以轻松设置和获取元素属性。

# oauth - search.twitter.com API 会在 2013 年 3 月被弃用吗？

> ID：15116342
> 
> 赞同：2
> 
> 时间：2013-02-27T15:49:23.200
> 
> 标签：oauth, twitter, deprecated, twitter-search

我已经开始阅读有关 2013 年 3 月左右的某些 Twitter API 1.0 弃用截止日期的内容，邀请他们的所有用户迁移到所述 API 的 1.1 版本。他们两个（除其他外）之间的主要区别似乎是“OAUTH 的事情”。

目前，我一直在开发一个 iOS/Android 应用程序，它使用 search.twitter.com/search.json API，没有大问题。好消息是“search.twitter.com” API 是一个未经身份验证的 API，现在，它足以满足我的需求。我现在“不想在 OAUTH 身份验证上投入时间”。

另一方面，老实说，我不知道“search.twitter.com” API 是否与 1.0 Twitter API 相同。是吗？我是否在不知不觉中使用了 Twitter API 1.0？

有谁知道 search.twitter.com “API”是否会在 2013 年 3 月“也”被弃用？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T17:00:06.150

最后，看起来这个 API 将被弃用。您可以在 Twitter 开发者论坛上找到更多信息。

[https://dev.twitter.com/discussions/12727](https://dev.twitter.com/discussions/12727)

[https://dev.twitter.com/discussions/14587](https://dev.twitter.com/discussions/14587)

[https://dev.twitter.com/discussions/14785](https://dev.twitter.com/discussions/14785)

所以是时候移动 1.1 和 OAuth 了。

# javascript - 循环延迟超时问题

> ID：15116344
> 
> 赞同：0
> 
> 时间：2013-02-27T15:49:28.180
> 
> 标签：javascript, loops, delay

我正在开发一款 HTML5 游戏，目前正在尝试制作一种武器，可以在几秒钟后发射 3 枚射弹。所以基本上，一支3连发突击步枪。

我首先做了：

```
for(var i = 0; i < 3; i++){
   player.bullets.push(bulletInstance);
}
player.shotBullet = true; 
```

这有效，但当然，弹丸同时释放，这意味着每次射击之间没有延迟。所以我尝试引入一个 setTimeout 函数：

```
setTimeout(function (){
    i++;
    if(i < 3){
        var b = new Rectangle( player.x + (player.width / 2) - 4, player.y + (player.height / 2) - 4, 8, 8);

        player.bullets.push(bulletInstance);
    }
}, 1000)
player.shotBullet = true; 
```

这也不起作用。有人可以在这里指出我的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T15:51:15.633

一种简单的方法是这样的：

```
for(var i = 0; i < 3; i++){

   window.setTimeout( function(){ player.bullets.push(bulletInstance); }, i * 1000 );

} 
```

这将间隔 1 秒初始化 3 个函数，每个函数都根据您的逻辑发射子弹。

您可能必须创建单独的`bulletInstance`.

如果要执行的操作超过 3 个，我建议`setInterval()`改用。不过在这么低的地方，`setTimeout()`应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:52:44.370

更具体地说明什么不是 wouking 会有所帮助。在您的情况下，问题是 setTimeout 只运行一次。您应该在处理程序中创建一个新的 settimeout 调用或使用 setInterval 代替（只要记住在完成后清除Interval 以便它停止）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T15:59:36.593

您可以使用 jQuery 中的[delay()](http://api.jquery.com/delay/)。

# extjs - 使用 UglifyJS 缩小 ExtJS 应用程序？

> ID：15116347
> 
> 赞同：2
> 
> 时间：2013-02-27T15:49:32.320
> 
> 标签：extjs, minify

是否可以使用像 UglifyJS 这样的第三方工具来缩小 ExtJS 4 MVC 风格的应用程序？

我尝试将应用程序中的每个文件压缩到一个文件中，但是 ExtJS 加载器随后报告它找不到要加载的文件。

我知道 Sencha 有一个官方的构建工具，但我正试图让 minify 使用更易于在服务器上部署的更行业标准的工具。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T17:35:28.903

我认为可以手动使用 UglifyJS，但我建议使用 Sencha Cmd。除了 JS 压缩之外，它还处理许多其他任务：依赖跟踪、包管理、主题构建等。并不是所有这些都是 Ext JS 应用程序所必需的，但 Sencha Cmd 肯定会为您节省大量时间和痛苦，而且您的应用程序越大，效果就越明显。

反正只是我的2美分。

# ios - iOS Web 服务结果到数组

> ID：15116348
> 
> 赞同：1
> 
> 时间：2013-02-27T15:49:33.980
> 
> 标签：ios, web-services

我使用网络服务来获取信息。当我获取字符串结果时，我无法将其写入数组。

在 foundCharacters 中，当我编写`NSLog(@"%@",string);`它时，它会正确写入所有值，但是当我编写时：

```
[myArray addObject:string];
NSLog(@"%@",myArray); 
```

我看到很多空值。如何获取这些值并将它们写入数组:(

```
-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response{

    [datawebservice setLength:0];
}

-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data{

    [datawebservice appendData:data];
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection{

    xmlparserr = [[NSXMLParser alloc] initWithData:datawebservice];
    [xmlparserr setDelegate:self];
    [xmlparserr parse];

}

-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{

    elementyedek = elementName;

}

-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{

}

-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{

    if ([elementyedek isEqualToString:@"StokAdi"]) {
       [myArray addObject:string];

        NSLog(@"%@",myArray);       

    }

}

-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{

    NSLog(@"ERROR with theConnection");
} 
```

# matlab - matlab坐标

> ID：15116349
> 
> 赞同：1
> 
> 时间：2013-02-27T15:49:37.520
> 
> 标签：matlab, 3d, coordinates, mesh

我正在处理一个涉及在 Matlab 中绘制一些坐标的小项目。

下面是我的 csv 文件的示例。数据总行数约为 160,000：

> 31040,55725,0
> 30930,55725,-1
> 30875,55630,3
> 30765,55630,0
> 30655,55630,5
> 30545,55630,0

前两列是 x,y 坐标，第三列是它们的值。数据是从 rpg 类型的游戏中生成的。玩家在给定坐标处做某事，然后他要么找到东西 (0 < z <= 23 ) 要么什么也没找到 (z = 0)。（z = -1 表示不确定，在这种情况下可以忽略）。由于玩家可以一遍又一遍地玩游戏，一些 x,y 坐标将具有相同或不同的值。

所以我想做的是制作一个 3D 图，显示坐标有多少次命中，以及命中的值是多少，有点像直方图？

我的值范围为 x：30000 - 33000，Y：55000 - 56000 和 z：-1 - 23。

我尝试在包含 5 行的示例文件上使用网格/网格网格并且它有效。但是，即使我尝试重新排列列或转置矩阵，x、y、z 坐标总是被错误地放置。

注意：当我使用原始文件尝试代码时，出现“内存不足”错误。Matlab不能取大量数据吗？还是我的代码？

我尝试的简单代码如下所示：

```
x = test(:, 1);
y = test(:, 2);
z = test(:, 3);

zz = [x,y,z];
%R = meshgrid(zz);
%mesh(R);
mesh(zz) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:29:11.720

如何使用[`accumarray`](http://www.mathworks.com/help/matlab/ref/accumarray.html)自定义函数：

```
sel = test(:,3) > 0; % work only with z>0
x = test(sel,1) - min(test(sel,1)) + 1; % convert from x to legitimate indices
y = test(sel,2) - min(test(sel,2)) + 1;
a = accumarray( {x, y}, test(sel,3), [max(x) max(y)], @numel, [], true );
% plot using bar3
bar3( a, 1, 'detached' ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:29:51.500

我会用这个：

```
[X,Y] = meshgrid(30000:33000,55000:56000);
Z=zeros(size(X));
Z(31040-30000+1,55725-55000+1) = 0;
Z(31930-30000+1,55725-55000+1) = -1;
Z(30875-30000+1,55630-55000+1) = 3;
mesh(Z) 
```

请注意： - 大小（X）== 大小（Y）

> > 所以我想做的是制作一个 3D 图，显示坐标有多少次命中，以及命中的值是多少，有点像直方图？

您可以增加适当的 Z(i,j) 字段来计算坐标出现的频率。

# objective-c - 保存到 plist 文件问题

> ID：15116352
> 
> 赞同：0
> 
> 时间：2013-02-27T15:49:42.467
> 
> 标签：objective-c, nsmutablearray, plist, nsmutabledictionary

由于某种原因，我无法将新数据保存到 plist 文件中。这是我一直用来保存数据的代码：

```
 -(void)saveData:(NSMutableDictionary *)dictionaryData toFile:(NSString *)filename {
     NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
     NSString *docDir = [paths objectAtIndex:0];
     NSString *path = [docDir stringByAppendingPathComponent:filename];
     NSMutableArray *data = [[NSMutableArray alloc] initWithContentsOfFile:path];
    [data addObject:dictionaryData];
    [data writeToFile:filename atomically:YES];
     } 
```

这是我用来将文件从包复制到应用程序目录的代码，以防万一它不存在：

```
 -(NSMutableArray *)loadFromFile:(NSString *)filename {
     NSError *error;
     NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
     NSString *docDir = [paths objectAtIndex:0];
     NSString *path = [docDir stringByAppendingPathComponent:filename];
     NSFileManager *fileMgr = [NSFileManager defaultManager];
     if(![fileMgr fileExistsAtPath:path]) {
        NSArray *fileArray = [filename componentsSeparatedByString:@"."];
        NSString *name = [fileArray objectAtIndex:0];
        NSString *ext = [fileArray objectAtIndex:1];
        NSString *bundle = [[NSBundle mainBundle] pathForResource:name ofType:ext];
        [fileMgr copyItemAtPath:bundle toPath:path error:&error];
     }
     NSMutableArray *data = [[NSMutableArray alloc] initWithContentsOfFile:path];
     return data;
     } 
```

由于某种原因，我无法将新数据保存到 plist 文件中。当我尝试将新的 NSMutableDictionary 对象添加到我的 plist 文件（使用 saveData:toFile: 方法）并且使用 plist 文件数据重新加载我的数组变量时 - 新对象不存在。难道我做错了什么？

这就是我加载 plist 文件的方式：

```
 @property (nonatomic, strong) NSMutableArray *modules;
 @property (nonatomic, strong) NSMutableDictionary *module; 

  - (void)viewDidLoad {
    [super viewDidLoad];

    self.modules = [self loadFromFile:@"ModulesList.plist"];
    self.module = [self.modules objectAtIndex:0];

    for (int i = 0; i < self.modules.count; i++ ) {
        NSLog(@"Modules array from plist file, module at index %i : %@",i, [self.modules         objectAtIndex:i]);
    } 
```

而不是为了测试目的，我有这个代码来添加新的模块对象：

```
 - (IBAction)leftButton:(id)sender {
      NSString *mytitle = [[NSString alloc] initWithFormat:@"my title"];
      NSString *myauthor = [[NSString alloc] initWithFormat:@"my author2"];
      NSUInteger myean = 22023423;
      NSString *mytitle2 = [[NSString alloc] initWithFormat:@"my title 2"];
      NSString *myauthor2 = [[NSString alloc] initWithFormat:@"my author2"];
      NSUInteger myean2 = 29032432;
      NSString *mytitle3 = [[NSString alloc] initWithFormat:@"my title 3"];
      NSString *myauthor3 = [[NSString alloc] initWithFormat:@"my author 3"];
      NSUInteger myean3 = 21023423;

      NSMutableDictionary *mybook = [[NSMutableDictionary alloc] init];
      NSMutableDictionary *mybook2 = [[NSMutableDictionary alloc] init];
      NSMutableDictionary *mybook3 = [[NSMutableDictionary alloc] init];

      [mybook setObject:mytitle forKey:@"title"];
      [mybook setObject:myauthor forKey:@"author"];
      [mybook setObject:[NSNumber numberWithInteger:myean] forKey:@"ean"];

      [mybook2 setObject:mytitle2 forKey:@"title"];
      [mybook2 setObject:myauthor2 forKey:@"author"];
      [mybook2 setObject:[NSNumber numberWithInteger:myean2] forKey:@"ean"];

      [mybook3 setObject:mytitle3 forKey:@"title"];
      [mybook3 setObject:myauthor3 forKey:@"author"];
      [mybook3 setObject:[NSNumber numberWithInteger:myean3] forKey:@"ean"];

      NSMutableArray *mybooks = [[NSMutableArray alloc] init];

      [mybooks addObject:mybook];
      [mybooks addObject:mybook2];
      [mybooks addObject:mybook3];

      [self.module setObject:mybooks forKey:@"books"];
      [self.modules addObject:self.module];

      for (int i = 0; i < self.modules.count; i++ ) {
          NSLog(@"Modules array after add operation, module at index: %i: %@",i, [self.modules objectAtIndex:i]);
}

      [self saveData:self.module toFile:@"ModulesList.plist"];   
   } 
```

当我使用按钮操作从 plist 重新加载我的 self.modules 数组时，我的新数据不存在：

```
 - (IBAction)reload:(id)sender {
         self.modules = [self loadFromFile:@"ModulesList.plist"];
         for (int i = 0; i < self.modules.count; i++ ) {
             NSLog(@"RELOAD: Modules array from plist file, module at index %i : %@",i,[self.modules objectAtIndex:i]);
         }

   } 
```

这是我的 plist 文件的屏幕截图：http: [//dl.dropbox.com/u/49076351/Screen%20Shot%202013-02-27%20at%2016.27.45.png](http://dl.dropbox.com/u/49076351/Screen%20Shot%202013-02-27%20at%2016.27.45.png)

# mysql - MYSQL 查询适用于本周而不是下周

> ID：15116355
> 
> 赞同：1
> 
> 时间：2013-02-27T15:49:51.983
> 
> 标签：mysql, database, intervals

```
SELECT a.agent, a.talktime, a.percentclosed,COALESCE(COUNT(b.dealamount),0),COALESCE(SUM(b.dealamount),0) , b.dealdate
FROM closers a
LEFT JOIN deals b ON a.agent = b.agent
WHERE b.dealdate IS NULL OR YEARWEEK( b.dealdate ) = YEARWEEK( NOW( ) ) 
GROUP BY a.agent
ORDER BY COALESCE( SUM( b.dealamount ) , 0 ) DESC 
```

任何人都可以帮我解决这个问题，我知道它很乱，但我对此很陌生，

这适用于本周，但如果我添加 +1 来模拟未来一周，前一周有交易的每个人都不会显示，

谢谢，

约翰，

查询的图像

![](../Images/8d009a956a6b6dfb84052040e5bf5689.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:56:42.467

在这种情况下，WEEKOFYEAR 并不好，因为它将在年底结束。您应该使用 YEARWEEK()。

```
WHERE b.dealdate IS NULL OR YEARWEEK( b.dealdate ) = YEARWEEK( NOW( ) ) +1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:59:04.660

```
WHERE b.dealdate IS NULL OR WEEKOFYEAR( b.dealdate ) = WEEKOFYEAR( date_add(NOW( ), interval 1 week)) 
```

使用 mysql 的间隔功能，以及 date_add 或 date_sub 函数

[参考](http://www.electrictoolbox.com/date-add-mysql-intervals-dates/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T12:14:36.837

得到它的工作！，

```
SELECT a.agent, a.talktime, a.percentclosed, COALESCE( COUNT( b.dealamount ) , 0 )     ,COALESCE( SUM( b.dealamount ) , 0 ) , b.dealdate
FROM closers a
LEFT JOIN deals b ON a.agent = b.agent
AND WEEKOFYEAR( b.dealdate ) = WEEKOFYEAR( NOW( ) ) 
WHERE b.dealdate IS NULL 
OR WEEKOFYEAR( b.dealdate ) = WEEKOFYEAR( NOW( ) ) 
GROUP BY a.agent
ORDER BY COALESCE( SUM( b.dealamount ) , 0 ) DESC 
LIMIT 0 , 30 
```

# java - 关于谷歌应用引擎实体删除

> ID：15116356
> 
> 赞同：0
> 
> 时间：2013-02-27T15:49:54.027
> 
> 标签：java, google-app-engine, google-cloud-datastore

我想删除所有实体。我发现如果我想删除一个实体，

```
// Key employeeKey = ...;
datastore.delete(employeeKey); 
```

上面的代码可以删除一个实体。但我想删除所有实体。有什么好的方法可以一次性删除吗？只能删除每个实体吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:00:56.127

delete 方法可以接受一个参数`Iterable<Key>`，所以做类似的事情

```
List<Key> keys = Arrays.asList(key1, key2, key3);
datastore.delete(keys); 
```

[https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/datastore/DatastoreService#delete%28java.lang.Iterable%29](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/datastore/DatastoreService#delete%28java.lang.Iterable%29)

# php - 将值从一种形式传递到另一种形式

> ID：15116357
> 
> 赞同：0
> 
> 时间：2013-02-27T15:49:54.243
> 
> 标签：php, javascript, database, web

我需要一些帮助。我需要某种方式从该网站获取信息：

[https://npiregistry.cms.hhs.gov/NPPESRegistry/NPIRegistrySearch.do?subAction=reset&searchType=ind](https://npiregistry.cms.hhs.gov/NPPESRegistry/NPIRegistrySearch.do?subAction=reset&searchType=ind)

并将其发布给我自己的。我想要做的是让医生能够输入他的名字和姓氏以及 NPI 号码，并自动发布一些相关字段，如电话和地址，而无需他们自己输入这些信息。

我试图实现的一个例子是：

[https://provider.myhelo.com/enroll.php](https://provider.myhelo.com/enroll.php)

在这个网站上，当医生输入他的信息时，它会询问他希望如何与他的地址和电话号码联系，这两者都是根据他输入的医生信息填充的。

我已经查看了 PHP cURL 方法，但我并不完全理解它或确切地知道这是否是我正在寻找的。我不太了解javascript，但我愿意学习。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:55:51.360

您无法从第三方站点获取用户输入的信息，除非该站点愿意向您提供这些数据。

# sql - 检索插入的最后一个 id 的问题

> ID：15116358
> 
> 赞同：0
> 
> 时间：2013-02-27T15:49:57.437
> 
> 标签：sql, sql-server, odbc

我使用`odbc_connection`，问题是我需要插入最后一个 id。

我在这里使用此查询，但没有得到所需的结果：

```
echo  $result = odbc_exec($connection, "SELECT @"."@IDENTITY AS Ident"); 
```

难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:50:59.803

如果您在 ODBC 下有 MySQL - 您可以使用下一个查询：

```
"SELECT LAST_INSERT_ID( );" 
```

或者

```
SELECT @@IDENTITY AS ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:19:17.967

我假设您要插入的表有一个 Identity 列？

当你说你没有得到所需的结果时，你的意思是你得到了错误的数字还是你得到了空？如果你得到错误的数字，你插入的表是否有一个插入另一个表的触发器？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T17:43:03.797

您需要使用 IDENT_CURRENT('dtabase name') 来检索从任何连接插入到列中的最后一个标识值。

您的解决方案不起作用的原因是 @@Identity 仅适用于当前连接而忽略其他连接。

# jquery - 如何删除数组对象中的项目

> ID：15116366
> 
> 赞同：-2
> 
> 时间：2013-02-27T15:50:17.323
> 
> 标签：jquery, arrays, object

早上好，伙计们，我是新来的，并创建了这个新主题，因为我没有找到任何可以消除我怀疑的东西。  

我有以下情况。  

我有一个对象：  

```
var ITEMS = new Object (); 
```

在这个对象中有一个电话号码数组。  

```
ITEMS.Phones = new Array (); 
```

在该数组中添加另一个对象，如下所示...   

```
var_number = $ ("# Number"). val ();
ITEMS.Phones.push (new Object ({phoneid: "", Number: var_number})); 
```

在那之前一切都很好，只是不能删除这个数组中的对象，我正在尝试以下操作：  

```
ITEMS.Phones.splice ($. InArray (removes ITEMS.Phones), 1); 
```

但我没有成功。  

有谁知道解决我的问题的方法，或者更简单的实现方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:56:32.800

如果它是实际代码而不是伪代码，则该行：

```
ITEMS.Phones.splice ($. InArray (removes ITEMS.Phones), 1); 
```

...至少有一个语法错误和一个其他错误（`InArray`应该是`inArray`）。你走在正确的轨道上，这`splice`就是你想要的。

你还没有说是什么`removes`，但**如果**它是对你要删除的对象的引用，那么该行

```
ITEMS.Phones.splice ($.inArray(removes, ITEMS.Phones), 1); 
```

...将删除它。但请注意，它必须是对**同一**对象的引用，因为`inArray`用于`===`搜索对象。它不能是对不同但等效对象的引用。

假设您要删除具有给定`Number`属性的对象的条目。你可以这样做：

```
var_number = /* ...the number you want to remove...*/
$.each(ITEMS.Phones, function(index, entry) {
    if (entry.Number === var_number) {
        ITEMS.Phones.splice(index, 1); // Removes the entry
        return false;                  // Terminates the $.each loop
    }
}); 
```

# asp.net - 我可以在将图像文件上传到 ASP.NET 之前测试其有效性吗？

> ID：15116373
> 
> 赞同：0
> 
> 时间：2013-02-27T15:50:48.560
> 
> 标签：asp.net, malware-detection

我有一个 ASP.NET Web 应用程序，它允许用户将文件从他的 PC 上传到 SQL Server 数据库（稍后用于为标签生成图像）。是否有一种“简单”的方法可以在 .NET 中测试图像，以在保存之前验证它不包含任何恶意内容？

现在，我使用这个：

```
 MemoryStream F = new MemoryStream();
    Bitmap TestBitmap = new Bitmap(Filename);
    TestBitmap.Save(F, System.Drawing.Imaging.ImageFormat.Png);
    int PhotoSize = (int)F.Length;
    Photo = new byte[PhotoSize];
    F.Seek(0, SeekOrigin.Begin);
    int BytesRead = F.Read(Photo, 0, PhotoSize);
    F.Close(); 
```

如果 TestBitmap 不是图像（例如，如果 Filename 是文本文件的名称），则创建 TestBitmap 会失败，但显然这不会阻止带有恶意代码的图像文件作为图像加载，因此保存它作为 MemoryStream 然后将流写入字节数组（稍后保存在数据库中）据说可以解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:29:18.473

为避免人们使用将照片上传到您的网站的功能传递程序和其他信息，您可以执行两个主要步骤。

1.  使用您的代码再次读取并保存图像以删除其他任何内容。
2.  将每个图像的大小限制为一个逻辑数字。

为了避免有人上传错误代码并在您的服务器上运行它，您保留了一个隔离文件夹，没有运行任何东西的权限。更多信息关于：

[我被黑了 上传的邪恶 aspx 文件名为 AspxSpy。他们还在努力。帮我困住他们‼</a>](https://stackoverflow.com/questions/4288362/ive-been-hacked-evil-aspx-file-uploaded-called-aspxspy-theyre-still-trying/4289379#4289379)

[](https://stackoverflow.com/questions/4288362/ive-been-hacked-evil-aspx-file-uploaded-called-aspxspy-theyre-still-trying/4289379#4289379)

[还有一个关于同一主题的一般主题：](https://stackoverflow.com/questions/4288362/ive-been-hacked-evil-aspx-file-uploaded-called-aspxspy-theyre-still-trying/4289379#4289379)[为渗透测试准备一个 ASP.Net 网站](https://stackoverflow.com/questions/4122486/preparing-an-asp-net-website-for-penetration-testing/4163850#4163850)

# jquery - 使用 jQuery Mobile 更新数据

> ID：15116382
> 
> 赞同：0
> 
> 时间：2013-02-27T15:51:12.060
> 
> 标签：jquery, asp.net-mvc, jquery-mobile

我有一个简单的表单，其中包含 jquery UI 日期选择器，基本上，当日期更改时，我想刷新我的数据（去获取基于日期的所有记录）。但是我不知道如何刷新数据？因此，如果您可以提供帮助，请寻求建议和简单的示例。

```
@model ViewModels.ScheduleMobileDisplay
@{
    ViewBag.Title = "Test";
    Layout = "~/Views/Shared/_AppHomeLayout.Iphone.cshtml";

}

@using (Html.BeginForm())
{
{
    <div data-role="page" id="pageAccount">
        <link href="~/Content/CSS/jquery-ui-1.10.1.Redmond/jquery-ui-1.10.1.custom.min.css" rel="stylesheet" />
        <script>
            $(function () {
                $("#datepicker").datepicker(
                    {
                        showButtonPanel: true,
                        dateFormat: "dd-M-yy",
                        onSelect: function (dateText, inst) {
                            var date = $(this).val();
                            alert('I Need to refresh the data below' + date);
                        }
                    });
            });

        </script>
        <div data-role="content">

            <input type="text" id="datepicker"  placeholder="Select Date" />

            <ul data-role="listview" data-divider-theme="b" data-inset="true">
                <li data-role="list-divider" role="heading">
                    @Model.AppointmentDate
                </li>
                @foreach (var item in Model.Appointments)
                {
                    <li data-theme="c">
                        <a href="/Schedule/MobileAppointmentEdit/@item.Id" data-transition="slide">
                            @item.StartTime @item.Name
                        </a>
                    </li>
                }

            </ul>
        </div>

    </div>

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:54:58.950

您希望对web 服务进行[ajax](http://api.jquery.com/jQuery.ajax/)调用以获取数据，然后在 ajax 调用的`success`回调中更新您的页面。

```
$.ajax('www.mywebsite.com/myserviceurl', {
    contentType: 'application/json; charset=utf-8',
    dataType: 'json',
    data: messageData,
    type: 'POST',
    timeout: 20000,
    success: function(data) {
        /* update page here */
    },
    error: function(jqXHR, textStatus, errorThrown) {
        console.log(errorThrown);
    }
}); 
```

# openssl - OpenSSL 无法将证书添加到数据库

> ID：15116386
> 
> 赞同：1
> 
> 时间：2013-02-27T15:51:18.340
> 
> 标签：openssl

我正在尝试建立一个测试实验室，我可以在其中使用证书进行身份验证。我正在使用 debian 挤压、glasfish 和 openssl。

在我制作了客户端证书并尝试将其存储在数据库中后，我收到一个错误：

`1 out of 1 certificate request certified, commit? [y/n]y`

`write out database with 1 new entries`

`unable to rename ./demoCA/index.txt to ./demoCA/index.txt.old`

`reason: is a directory`

当我制作自签名 CA 证书时，它运行良好，但现在它无法运行。Maby 我错过了显而易见的事情，因为我在互联网上找不到任何关于它的信息。因此，任何解决此问题的指导将不胜感激。

最好的问候马里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T02:13:16.603

基于你的`ls -al`

```
total 44 drwxr-xr-x 4 root root 4096 Feb 27 16:30 . 
drwxr-xr-x 5 root root 4096 Feb 27 16:25 .. 
-rw-r--r-- 1 root root 3 Feb 27 12:39 crlnumber 
-rw-r--r-- 1 root root 52 Feb 27 14:30 index.txt 
-rw-r--r-- 1 root root 21 Feb 27 16:30 index.txt.attr 
-rw-r--r-- 1 root root 20 Feb 27 16:30 index.txt.attr.new 
-rw-r--r-- 1 root root 110 Feb 27 16:30 index.txt.new 
drwxr-xr-x 2 root root 4096 Feb 27 12:38 index.txt.old 
drwxr-xr-x 2 root root 4096 Feb 27 16:30 newcerts 
-rw-r--r-- 1 root root 3 Feb 27 16:30 serial -rw-r--r-- 
1 root root 3 Feb 27 16:16 serial.old 
```

`index.txt.old`实际上是一个目录。你可以说是因为`d`in `drwxr-xr-x`。我不知道您正在使用的所有内容，但您可以尝试备份它`mv index.txt.old index.txt.old.backup`，然后它应该可以正常运行。

# php - 通过加密链接下载时文件损坏

> ID：15116389
> 
> 赞同：0
> 
> 时间：2013-02-27T15:51:21.867
> 
> 标签：php, wordpress, binary, download, ascii

我们的产品是电子书，通过 WordPress 的[http://www.tipsandtricks-hq.com/](http://www.tipsandtricks-hq.com/) eStore 插件以 .epub 和 .mobi 格式提供，该插件会生成加密的下载链接。

*   大约 5 天前突然出现问题，之前运行良好大约三个月

*   当客户通过下载链接下载购买的产品时，所有 .epub 文件都会损坏，并且在尝试将 ePub 导入图书馆时，Adobe Digital Editions 会出错

*   所有 .mobi 文件在下载然后加载到 Kindle 时都会损坏，Kindle 会出现类似的错误

*   我们尝试关闭谷歌网址缩短器，错误

*   我们已经用 IE、Chrome 和 Firefox 测试了链接，错误

*   我们在没有加密链接的情况下进行了测试，通过浏览器中的直接链接下载文件，它们工作正常，没有错误

我们学到了什么：

*   我们已经测试了使用 FTP 以 ASCII 和二进制模式下载......使用 ASCII 我们得到与使用加密下载链接相同的错误

*   使用 FTP 传输的文件使用 ASCII 和 Binary 后大小相同，但运行哈希检查显示内容不同

*   我们正在使用 FileZilla 在 PC 和 Mac 上通过 FTP 进行测试，但是错误只发生在 PC 上

*   所以，我们假设这个问题与文件传输类型和电脑有关

*   在 /home/foo/bar/wp-content/plugins/wp-cart-for-digital-products/download.php 我们看到 header("Content-Transfer-Encoding: binary"); 所以我们假设在使用加密链接时强制使用二进制

加密的链接字符串中是否可能有一些字符强制使用 ASCII？以下是加密链接的示例：

```
https://fu.com/bar/download.php?file=LRtro6WQMN12ip%2BEcL0TYS8sMZmSKOlkRedVCZyfACsqSllzCAjDp%2FZJyfQ2oq0ZP6vg1EMrR%2FOFC4B3wGDHl3N0u0sulcBhIfkOJ0C0UQh6 
```

这里是 http 标头：

```
Status: HTTP/1.1 200 OK
Date: Wed, 27 Feb 2013 14:55:47 GMT 
Server: Apache 
X-Powered-By: PHP/5.3.17 
Set-Cookie: PHPSESSID=7d61c9dd6ecbd321bea8cffg4a25d5e8; path=/ 
Expires: 0 
Cache-Control: public 
Pragma: public 
X-CF-Powered-By: WP 1.3.9 
Content-Description: File Transfer 
Content-Disposition: attachment; filename="Some-File-Name-Which-Was-Replaced.epub" 
Content-Transfer-Encoding: binary 
Content-Length: 5088032 
Connection: close 
Content-Type: application/epub+zip 
```

还有什么可能导致这种情况？我们的服务器会在 .htaccess 或 apache 配置设置中强制使用 ASCII 吗？

非常感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T15:41:50.897

我们的一位程序员在他的编辑器中使用了错误的字符编码。我们需要处理带有 UTF-8（BOM 关闭）的 PHP 文件，或者空格或换行符会以某种方式影响文件完整性：

[PHP 文件中的 UTF-8 BOM 签名](https://stackoverflow.com/questions/2558172/utf-8-bom-signature-in-php-files)

WordPress的functions.php中的违规代码行：`if ($bom != b"\xEF\xBB\xBF")`

我们的罪魁祸首 HTML 字符代码`&#239;&#176;&#191;`，我们从 HEX 值解码：`EF BB BF` 这是出现在损坏的 .epub 文件开头的垃圾数据。

每次在 WordPress 中运行时，functions.php 总是输出这些垃圾数据。

很高兴我们终于找到了问题的根源，这让我们发疯了！哈哈哈！！！

和平与快乐编码给你

# android - 在 Android 中的 ImageButton 中适合图像

> ID：15116393
> 
> 赞同：171
> 
> 时间：2013-02-27T15:51:30.410
> 
> 标签：android, image, android-linearlayout, scale, imagebutton

我的活动中有 6 个 ImageButton，我通过其中的代码设置图像（不使用 xml）。

我希望它们覆盖 75% 的按钮区域。但是由于有些图像覆盖的区域较小，有些图像太大而无法放入 imageButton。如何以编程方式调整大小并显示它们？下面是屏幕截图

![在此处输入图像描述](../Images/c2d074af920d2b05fbe108e9c8a3c307.png) 下面是xml文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:layout_marginBottom="5sp"
        android:layout_marginLeft="2sp"
        android:layout_marginRight="5sp"
        android:layout_marginTop="0sp"     >
   <LinearLayout
        android:layout_height="0dp"
        android:layout_width="match_parent"
        android:layout_weight="1"
        android:orientation="horizontal">
        <ImageButton          

            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_topleft"
        android:layout_marginBottom="5sp"
        android:layout_marginLeft="2sp"
        android:layout_marginRight="5sp"
        android:layout_marginTop="0sp"
            />
        <ImageButton
            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_topright"
    android:layout_marginBottom="5sp"
        android:layout_marginLeft="2sp"
        android:layout_marginRight="5sp"
        android:layout_marginTop="0sp"
            />
    </LinearLayout>
    <LinearLayout
        android:layout_height="0dp"
        android:layout_width="match_parent"
        android:layout_weight="1"
        android:orientation="horizontal">

        <ImageButton
            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_repeat"
    android:layout_marginBottom="5sp"
        android:layout_marginLeft="2sp"
        android:layout_marginRight="5sp"
        android:layout_marginTop="0sp"     
             />

              <ImageButton
            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_next"
    android:layout_marginBottom="5sp"
        android:layout_marginLeft="2sp"
        android:layout_marginRight="5sp"
        android:layout_marginTop="0sp"     
             />

    </LinearLayout>    
   <LinearLayout
        android:layout_height="0dp"
        android:layout_width="match_parent"
        android:layout_weight="1"
        android:orientation="horizontal">

        <ImageButton
            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_bottomleft"
    android:layout_marginBottom="5sp"
        android:layout_marginLeft="2sp"
        android:layout_marginRight="5sp"
        android:layout_marginTop="0sp"                                 
             />
        <ImageButton
            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_bottomright"
    android:layout_marginBottom="5sp"
        android:layout_marginLeft="2sp"
        android:layout_marginRight="5sp"
        android:layout_marginTop="0sp"                  
            />        
    </LinearLayout>        

</LinearLayout> 
```

和 myClass.java 的片段：

```
public void addImageButtons()
    {
        iB_topleft = (ImageButton) findViewById(R.id.button_topleft);
        iB_topright = (ImageButton) findViewById(R.id.button_topright);
        iB_bottomleft = (ImageButton) findViewById(R.id.button_bottomleft);
        iB_bottomright = (ImageButton) findViewById(R.id.button_bottomright);
        iB_next = (ImageButton) findViewById(R.id.button_next);
        iB_repeat = (ImageButton) findViewById(R.id.button_repeat);
    }

    public void setImageNextAndRepeat()
    {

    iB_topleft .setImageResource(R.drawable.aa);
        iB_topright.setImageResource(R.drawable.bb);   

    iB_bottomleft.setImageResource(R.drawable.cc);
        iB_bottomright.setImageResource(R.drawable.dd);   

        iB_next.setImageResource(R.drawable.next);
        iB_repeat.setImageResource(R.drawable.repeat);      
    } 
```

* * *

## 回答 #1

> 赞同：437
> 
> 时间：2013-02-27T16:44:34.147

> 我希望它们覆盖 75% 的按钮区域。

使用`android:padding="20dp"`（根据需要调整填充）来控制图像在按钮上的占用量。

> 但是由于有些图像覆盖的区域较小，有些图像太大而无法放入 imageButton。如何以编程方式调整大小并显示它们？

使用 a`android:scaleType="fitCenter"`让 Android 缩放图像，并`android:adjustViewBounds="true"`让它们因缩放而调整其边界。

所有这些属性都可以在每个`ImageButton`运行时的代码中设置。但是，在我看来，在 xml 中设置和预览要容易得多。

此外，**请勿**用于`sp`文本大小以外的任何内容，它会根据用户设置的文本大小偏好进行缩放，因此`sp`如果用户具有“大”文本设置，您的尺寸将大于您的预期。改为使用`dp`，因为它不按用户的文本大小偏好进行缩放。

以下是每个按钮的外观片段：

```
 <ImageButton
        android:id="@+id/button_topleft"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_marginBottom="5dp"
        android:layout_marginLeft="2dp"
        android:layout_marginRight="5dp"
        android:layout_marginTop="0dp"
        android:layout_weight="1"
        android:adjustViewBounds="true"
        android:padding="20dp"
        android:scaleType="fitCenter" /> 
```

![示例按钮](../Images/0b4407b9764a938909941232e8187fcc.png)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2015-11-17T11:31:34.370

我正在使用以下代码`xml`

```
android:adjustViewBounds="true"
android:scaleType="centerInside" 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-02-27T16:48:49.067

尝试`android:scaleType="fitXY"`在 i-Imagebutton xml中使用

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-11-12T13:26:43.563

我正在`android:scaleType="fitCenter"`满意地使用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-02-21T09:00:34.560

请参阅以下链接并尝试找到您真正想要的内容：

> ImageView.ScaleType CENTER 使图像在视图中居中，但不执行缩放。
> 
> ImageView.ScaleType CENTER_CROP 均匀缩放图像（保持图像的纵横比），使图像的两个尺寸（宽度和高度）都等于或大于视图的相应尺寸（减去填充）。
> 
> ImageView.ScaleType CENTER_INSIDE 统一缩放图像（保持图像的纵横比），使图像的两个尺寸（宽度和高度）都等于或小于视图的相应尺寸（减去填充）。
> 
> ImageView.ScaleType FIT_CENTER 使用 CENTER 缩放图像。
> 
> ImageView.ScaleType FIT_END 使用 END 缩放图像。
> 
> ImageView.ScaleType FIT_START 使用 START 缩放图像。
> 
> ImageView.ScaleType FIT_XY 使用 FILL 缩放图像。
> 
> ImageView.ScaleType MATRIX 绘制时使用图像矩阵进行缩放。

[https://developer.android.com/reference/android/widget/ImageView.ScaleType.html](https://developer.android.com/reference/android/widget/ImageView.ScaleType.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-03-19T23:08:07.583

我最近偶然发现，由于您对 ImageView 有更多控制权，因此您可以为图像设置 onclicklistener 这里是动态创建的图像按钮的示例

```
private int id;
private bitmap bmp;
    LinearLayout.LayoutParams familyimagelayout = new LinearLayout.LayoutParams(
                    LinearLayout.LayoutParams.MATCH_PARENT,LinearLayout.LayoutParams.WRAP_CONTENT );

    final ImageView familyimage = new ImageView(this);
            familyimage.setBackground(null);
            familyimage.setImageBitmap(bmp);
            familyimage.setScaleType(ImageView.ScaleType.FIT_START);
            familyimage.setAdjustViewBounds(true);
            familyimage.setId(id);
            familyimage.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View v) {
                    //what you want to do put here
                }
            }); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-20T19:56:06.217

你可以像我一样制作你的 ImageButton 小部件。就我而言，我需要一个具有固定图标大小的小部件。让我们从自定义属性开始：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <declare-styleable name="ImageButtonFixedIconSize">
        <attr name="imageButton_icon" format="reference" />
        <attr name="imageButton_iconWidth" format="dimension" />
        <attr name="imageButton_iconHeight" format="dimension" />
    </declare-styleable>
</resources> 
```

Widget 类非常简单（重点是*onLayout*方法中的填充计算）：

```
class ImageButtonFixedIconSize
@JvmOverloads
constructor(
    context: Context,
    attrs: AttributeSet? = null,
    defStyleAttr: Int = android.R.attr.imageButtonStyle
) : ImageButton(context, attrs, defStyleAttr) {

    private lateinit var icon: Drawable

    @Px
    private var iconWidth: Int = 0
    @Px
    private var iconHeight: Int = 0

    init {
        scaleType = ScaleType.FIT_XY
        attrs?.let { retrieveAttributes(it) }
    }

    /**
     *
     */
    override fun onLayout(changed: Boolean, left: Int, top: Int, right: Int, bottom: Int) {
        val width = right - left
        val height = bottom - top

        val horizontalPadding = if(width > iconWidth) (width - iconWidth) / 2 else 0
        val verticalPadding = if(height > iconHeight) (height - iconHeight) / 2 else 0

        setPadding(horizontalPadding, verticalPadding, horizontalPadding, verticalPadding)

        setImageDrawable(icon)

        super.onLayout(changed, left, top, right, bottom)
    }

    /**
     *
     */
    private fun retrieveAttributes(attrs: AttributeSet) {
        val typedArray = context.obtainStyledAttributes(attrs, R.styleable.ImageButtonFixedIconSize)

        icon = typedArray.getDrawable(R.styleable.ImageButtonFixedIconSize_imageButton_icon)!!

        iconWidth = typedArray.getDimension(R.styleable.ImageButtonFixedIconSize_imageButton_iconWidth, 0f).toInt()
        iconHeight = typedArray.getDimension(R.styleable.ImageButtonFixedIconSize_imageButton_iconHeight, 0f).toInt()

        typedArray.recycle()
    }
} 
```

最后你应该像这样使用你的小部件：

```
<com.syleiman.gingermoney.ui.common.controls.ImageButtonFixedIconSize
    android:layout_width="90dp"
    android:layout_height="63dp"

    app:imageButton_icon="@drawable/ic_backspace"
    app:imageButton_iconWidth="20dp"
    app:imageButton_iconHeight="15dp"

    android:id="@+id/backspaceButton"
    tools:ignore="ContentDescription"
    /> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-08-20T08:17:56.973

在我的情况下效果很好。首先，您下载一个图像并将其重命名为 iconimage，将其定位在 drawable 文件夹中。`android:layout_width`您可以通过设置或更改大小`android:layout_height`。最后，我们有

```
 <ImageButton
        android:id="@+id/answercall"
        android:layout_width="120dp"
        android:layout_height="80dp"
        android:src="@drawable/iconimage"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:scaleType="fitCenter" /> 
```

# knockout.js - 将嵌套剔除模型绑定到复选框失败

> ID：15116394
> 
> 赞同：1
> 
> 时间：2013-02-27T15:51:31.460
> 
> 标签：knockout.js

我无法绑定这个：

js：

```
function User(jsonModel) {

    self.show= ko.observable(jsonModel.show);

}

function ViewModel(jsonModel) {
    var self = this;
    self.user = ko.observable(new User(jsonModel.User));

} 
```

对此：

```
 <input id="it" type="checkbox" data-bind="checked: user.show" /> 
```

无论如何，该复选框都未选中。我还在这里检查了 viewModel .user() = true ：

```
 var viewModel = new ViewModel(json);
            ko.applyBindings(viewModel); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:08:47.620

你必须解开`user`可观察的：

```
<input id="it" type="checkbox" data-bind="checked: user().show" /> 
```

# php - 多前缀路由和DRY原则

> ID：15116396
> 
> 赞同：0
> 
> 时间：2013-02-27T15:51:33.520
> 
> 标签：php, cakephp, cakephp-2.2

我使用 CakePHP 2.2.7

在我的应用程序中，我有一个公共区域和管理区域。我使用前缀路由，因此对于我使用的管理操作 `admin_index()`等。

现在我需要为经理添加额外的管理区域。在某些情况下，此管理器区域与管理区域不同。不同的布局，并非所有操作都允许。

我的问题是：我应该简单地复制已经为管理区域实施的操作（并添加另一个前缀，例如`manager_index()`）还是有一个更简单和 DRY 的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:38:41.430

例如，您可以这样做

```
public function manager_edit($fooId = null) {
    $this->admin_edit($fooId);
} 
```

但是，如果您做得很好，您的大部分代码应该已经在模型中，并且您的代码看起来像这样（只是一个基本示例）；

```
public function manager_edit($fooId = null) {
    if ($this->Foo->edit($fooId, $this->request->params, $this->Auth->user('id')) { /*....*/ }
} 
```

# android - Android 模拟器与 Google API 的兼容性

> ID：15116398
> 
> 赞同：1
> 
> 时间：2013-02-27T15:51:35.517
> 
> 标签：android, emulation

我写了一个简单的代码，它使用 Eclipse 和今天更新的 ADT 插件来实现 MapView。为了对其进行测试，我创建了一个基于 Galaxy Nexus 设备的新模拟器，并针对 Google API 级别 17。模拟器已创建且没有错误并且可以正常启动。

我设置了针对 Google API 的项目属性。我编译了项目并尝试在我的模拟器上运行，但我收到一条警告消息：未找到兼容的目标，您希望添加新的 Android 虚拟设备吗？

独立于我单击的按钮，会出现一个新的 avd 窗口，并且我的新模拟器以红色叉号而不是绿色复选标志突出显示。

我可以选择忽略警告并继续使用我的模拟器，但我的应用程序在到达主要活动 onCreate() 方法之前会阻塞，因为我在该方法中放置了一个从未到达的断点。

我添加了 Internet 权限标签以显示我从 Google 获得的 API 密钥代码。

有人能解释我的项目有什么问题吗？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T01:33:54.347

如果您使用 Google API 级别 17 作为项目的目标，请确保您的**模拟器的 API 级别**也是**17**。您可能已经使用 Google API 创建了一个模拟器，但 API 级别不同。

要检查模拟器的 API 级别，请打开您的 AVD，然后确认目标名称是否为 Google APIs(Google Inc.) 且 API 级别为 17。

# c# - DataGridView 没有被重绘

> ID：15116399
> 
> 赞同：0
> 
> 时间：2013-02-27T15:51:42.260
> 
> 标签：c#, winforms, datagridview

我有一个`DataGridView`，我有选择地（迭代地）隐藏行，使用`row.Visible`：

```
void UpdateMessageWindow()
{
    MessageDataGridView.CurrentCell = null;
    foreach (DataGridViewRow row in MessageDataGridView.Rows)
    {
        row.Visible = DisplayedLevels.HasFlag((MessageLevel)row.Cells[3].Value);
    }
} 
```

我遇到了一个问题，即在添加行后，它们不会被重新绘制，直到您单击单元格（重新绘制单击的单元格）、按下一个键或隐藏窗口。如果您将鼠标移到 DGV 上，您可以看到它们存在，因为光标发生了变化。

我很确定我已经在 DataGridView 上尝试了所有相关探测方法的组合，但没有任何帮助。

**编辑：** 我已将其修改为使用 BindingSource.Filter，通过在 DataSet 表中添加“可见”列、设置`messageBindingSource.Filter = "Visible"`并将 UpdateOutput 重写为

```
void UpdateOutputWindow() 
{
    foreach (JobDataSet.MessagesRow row in _dataSet.Messages)
    {
        row.Visible = DisplayedLevels.HasFlag(row.Level);
    }
} 
```

但它仍然显示相同的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T10:07:13.153

我发现答案是为`DataTable.RowChanged`事件添加一个处理程序：

```
_dataSet.Messages.RowChanged += delegate
                                {
                                    MessageDataGridView.Invalidate();
                                    MessageDataGridView.Update();
                                }; 
```

它可能效率低下，但它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:03:35.443

尝试使用以下方法聚焦 DataGridView：

```
MessageDataGridView.Focus(); 
```

# google-maps-api-3 - 在失败的地理编码地图未设置为提供的坐标

> ID：15116403
> 
> 赞同：0
> 
> 时间：2013-02-27T15:51:47.307
> 
> 标签：google-maps-api-3

我正在使用以下代码初始化 Google 地图：

```
function googleMapinitialize(fenceAddIn){
var fenceAdd=new google.maps.LatLng(37.2146,121.5545);
var mapProp = {
        center:fenceAdd,
        zoom:30,
        mapTypeId:google.maps.MapTypeId.TERRAIN
};

var map = new google.maps.Map(document.getElementById("fenceMap"),mapProp);

var geocoder = new google.maps.Geocoder();
var location = fenceAddIn; //"2001 Gateway PI, San Jose, CA";

if(!geocoder) {
    geocoder = new google.maps.Geocoder();
}

var geocoderRequest = {
    address: location
}

var myCity = null;
var marker = null;
var infowindow = null;
geocoder.geocode(geocoderRequest, function(results, status) {
    if (status =="" || status == google.maps.GeocoderStatus.ZERO_RESULTS){
        alert("'" + location + "' not found!!!");
        map.setCenter(fenceAdd);
    } else if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        fenceAdd = new google.maps.LatLng(results[0].geometry.location.hb,results[0].geometry.location.ib);
        if (!marker) {
            marker = new google.maps.Marker({
                map: map,
                raiseOnDrag:false,
                draggable:true
            });
            marker.setPosition(results[0].geometry.location);
            google.maps.event.addListener(marker,'click',function(){
                if (!infowindow) {
                  infowindow = new google.maps.InfoWindow({
                      disableAutoPan:true,
                      maxWidth:100
                  });
                }
                var content = '<strong>' + results[0].formatted_address + '</strong>';
                infowindow.setContent(content);
                infowindow.setPosition(results[0].geometry.location);
                infowindow.open(map, marker);                   
            });

        }
    }
    myCity = new google.maps.Circle({
        center:fenceAdd,
        radius:125,
        strokeColor:"#0000ff",
        strokeOpacity:0.1,
        strokeWeight:0.1,
        fillColor:"#0000ff",
        fillOpacity:0.20,
        map:map
    });

    google.maps.event.addListener(map, 'click', function(){
        infowindow.close();
    });
    google.maps.event.addListener(map, 'dblclick', function(){
        window.open("<%=request.getContextPath() %>/jsp/googleMapPopup.jsp?fenceAddress="+$('#haddr').val(),'ADDRESSMAP','height=400,width=600');
    });
});
} 
```

我正在发送一个经过地理编码的地址，并在地图上用大头针标记位置。但如果地理编码失败，地图将以中国为中心。因此，为了克服这个问题，我将地图中心重置为原始纬度并在其上绘制圆圈。当我调试代码时，我看到坐标设置正确，但地图仍然显示中国地图。

有人能告诉我在这种情况下如何重置地图位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:43:23.617

你的fenceAdd坐标默认为中国：

> 山东省烟台市牟平省道206号（37.21401、121.5955285）

如果您不希望地图居中，请更改这些坐标。

# vb.net - 如何在 vb.net 中每周按日期时间使用循环

> ID：15116405
> 
> 赞同：0
> 
> 时间：2013-02-27T15:51:54.580
> 
> 标签：vb.net, datetime, loops, data-binding, foreach

我在 VB.NET 2008 中每周使用 datetime 尝试循环。

**本守则**

```
Private Sub Button1_Click()....
        'Select DateTime 
        Dim strDate As Date = dateTimePicker.Value.ToString("yyyy-MM-dd")

        'one week (+7)
        Dim strDateWeek As String = DateAdd("d", +7, dateTimePicker.Value.ToString("yyyy-MM-dd"))

        'DateCurrent
        Dim strDateNow As String = DateAdd("d", 0, Now.ToLongDateString())

        'While strDate < strDateNow
            'ListBox1.Items.Add(strDateWeek)
        'End While
        ListBox1.Items.Add(strDateWeek)
End Sub 
```

**例子**

```
I select on datetimepicker at "04/02/2013"
Output now: 11/02/2013

But I need Output each on weekly
11/02/2013
18/02/2013
25/02/2013 >>> To Current Week 
```

我尝试循环while，但不工作。

谢谢你的时间。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:05:19.070

你可以做一个while循环，直到日期时间大于今天？

您想使用 DateTime 而不是 Date，因此您可以与 DateTime.Now 进行比较

你想将你的实际 DatePicker 值设置为一个变量，否则它总是相同的，你只会得到一个无限循环。

```
 Dim datePickerValue As DateTime = DateTimePicker.Value
    Dim strDate As Date = DateTimePicker.Value.ToString("yyyy-MM-dd")
    Dim strDateWeek As String
    Dim strDateNow As String = DateAdd("d", 0, Now.ToLongDateString())

    While datePickerValue < DateTime.Now()
     strDateWeek = DateAdd("d", +7, datePickerValue.ToString("yyyy-MM-dd"))
     datePickerValue = DateAdd("d", +7, datePickerValue.ToString("yyyy-MM-dd"))
     ListBox1.Items.Add(strDateWeek)
   End While 
```

刚刚使用您的命名约定在我的 VS 上完成了它，这对我来说很好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:07:43.770

好久没用VB了，也许我能帮上忙？在您的代码中，使用 while 可能是一个错误的选择，也许您可​​以使用 for 和 break 来代替。

```
for I = 1 to 10
Dim strDateWeek As String = DateAdd("d", +7 * i, dateTimePicker.Value.ToString("yyyy-MM-dd"))
.
.
. 
```

或者

```
while(...)
I += 1
Dim strDateWeek As String = DateAdd("d", +7 * i, dateTimePicker.Value.ToString("yyyy-MM-dd")) 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:12:52.877

尝试这个：

```
Dim dtAux As Date = dateTimePicker.Value
Dim dtEnd As Date = Date.Today.AddDays(7 - dt.DayOfWeek)

While dtAux <= dtEnd
    ListBox1.Items.Add(dtAux.ToString("yyyy-MM-dd"))
    dtAux = dtAux.AddDays(7)
End While 
```

日期`dtEnd`是当前一周的最后一天，如果您希望循环在当前日期停止，只需将 while 条件更改为：
`While dtAux <= Date.Today`

# c# - 如何使用隐藏的 WinForm 设置剪贴板挂钩？

> ID：15116407
> 
> 赞同：1
> 
> 时间：2013-02-27T15:51:59.460
> 
> 标签：c#, winforms, clipboard

我正在尝试在 user32.dll 上使用 SetClipboardViewer 方法放置剪贴板挂钩

```
 [DllImport("User32.dll", CharSet = CharSet.Auto)]
 public static extern IntPtr SetClipboardViewer(IntPtr hWndNewViewer); 
```

然后我覆盖表单上的 WndProc 方法以捕获消息：

```
 protected override void WndProc(ref Message message)
    {
        switch ((User32Handler.SystemMessages)message.Msg)
        {
            case User32Handler.SystemMessages.WM_DRAWCLIPBOARD:

                if (MainForm.isFirstCopyPaste)
                {
                    MainForm.isFirstCopyPaste = false;
                    return;
                }

                var data = Clipboard.GetDataObject();
                if (data.GetDataPresent(DataFormats.Text))
                {
                    NotifyIconMain.ShowBalloonTip(2000, "Text Copied", "Plain text copied", ToolTipIcon.Info);
                }

                User32Handler.SendMessage(_nextClipboardViewer, message.Msg, message.WParam, message.LParam);
                break;
            case User32Handler.SystemMessages.WM_CHANGECBCHAIN:
                Debug.WriteLine("WM_CHANGECBCHAIN: lParam: " + message.LParam, "WndProc");
                if (message.WParam == _nextClipboardViewer)
                {
                    _nextClipboardViewer = message.LParam;
                }
                else
                {
                    User32Handler.SendMessage(_nextClipboardViewer, message.Msg, message.WParam, message.LParam);
                }
                break;
            default:
                base.WndProc(ref message);
                break;
        }
    } 
```

我能够做到这一点，但我也想对用户隐藏窗口，并且只在系统托盘上显示它（而不是在任务栏上）。

当我从任务栏中隐藏窗口时，钩子停止工作。当我再次带回窗户时，它甚至不起作用。

有人有想法么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T22:03:33.230

确保无论你做什么来隐藏窗口都不会破坏它。从应用程序开始到终止，您的窗口句柄必须是相同的数字。因此，一点调试日志应该会告诉您在从托盘恢复后是否获得了与您最初开始（并随后注册）的句柄相同的句柄。

# java - 设置 Eclipse 以始终包含 hadoop jar 文件

> ID：15116408
> 
> 赞同：0
> 
> 时间：2013-02-27T15:52:09.663
> 
> 标签：java, eclipse, hadoop

我正在尝试创建一个 Eclipse 文件夹（包？）团队成员可以下载，当他们创建新项目时，它会自动将 Hadoop jar 文件添加到类路径中，这可能吗？

谢谢！

PS。我确实在 Eclipse 论坛中询问过，但没有任何回应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:54:10.753

您可以创建一个具有完整配置和库的虚拟项目。开发人员只需要重命名它..

或者，如果您想走行家之路，请使用原型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:55:00.927

我还没有听说过这样的文件夹/包概念。为什么不创建一个包含所有依赖项的预配置空项目？您还可以创建一个 Maven 项目来轻松管理依赖项。

# spring-mvc - Spring Security 身份验证决策

> ID：15116409
> 
> 赞同：0
> 
> 时间：2013-02-27T15:52:09.217
> 
> 标签：spring-mvc, spring-security

在我的 Spring Security 中，我遇到了一个问题。当我访问 /admin、/client 甚至 /admin/addUser.jsp 之类的 url 时，它会将我返回到登录页面（根据需要），但是当我访问 /addUser（映射到 Spring MVC 控制器）之类的 url 时，它会返回我任何情况下的页面，即使用户未通过身份验证。我需要添加/删除/修改什么配置才能安全执行一切。

```
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:security="http://www.springframework.org/schema/security"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd">

       <security:http auto-config="true" use-expressions="true"> <!--access-decision-manager-ref="accessDecisionManager"-->
            <security:intercept-url pattern="/login" access="permitAll"/>
            <security:intercept-url pattern="/admin*/**" access="hasRole('ROLE_ADMIN')"/>
            <security:intercept-url pattern="/client*/**" access="hasRole('ROLE_USER')"/>
            <security:form-login login-page="/login" default-target-url="/index" authentication-failure-url="/loginFail"
                                 authentication-success-handler-ref="redirectRoleStrategy"/>
            <security:logout logout-success-url="/logout" invalidate-session="true"/>
            <security:access-denied-handler error-page="/403"/>
       </security:http>

       <bean id="daoAuthenticationProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
           <property name="userDetailsService" ref="userDetailsService"/>
       </bean>

       <bean id="authenticationManager" class="org.springframework.security.authentication.ProviderManager">
            <property name="providers">
                <list>
                    <ref local="daoAuthenticationProvider"/>
                </list>
            </property>
       </bean>

        <security:authentication-manager>
            <security:authentication-provider user-service-ref="userDetailsService"/>
        </security:authentication-manager>

        <bean id="redirectRoleStrategy" class="com.payment.system.util.RoleBasedAuthenticationSuccessHandler">
            <property name="roleUrlMap">
                <map>
                    <entry key="ROLE_ADMIN" value="/admin"/>
                    <entry key="ROLE_USER" value="/client"/>
                </map>
            </property>
        </bean>
</beans> 
```

PS：顺便说一句，我的 IDEA 给我留下了一条`<property name="providers">`线，告诉我这个属性已被弃用。我应该将其替换为什么属性？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:55:55.310

只需添加

```
<security:intercept-url pattern="/**" access="isFullyAuthenticated()" /> 
```

**毕竟**你的拦截网址标签（我的意思是它必须是最后一个）

对于 PS 问题：如 javadoc 中所述，只需使用构造函数注入（通过**constructor-arg**标签）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T08:41:38.510

当您添加 Maksym 建议的配置时，它将解决您的身份验证问题。但它不会解决您的授权问题。具有 ROLE_USER 角色的用户将能够访问 /addUser。两种解决方案：

1) 将所有应该由 admin 访问的 URL 移动到 /admin**。这个解决方案可能很复杂。

2）用以下配置替换我的Maxim建议的配置：

```
<security:intercept-url pattern="/**" access="hasRole('ROLE_ADMIN')" /> 
```

请注意，在这种情况下，角色 ROLE_USER 的用户将只能访问 URL /client*/**

如果您需要任何其他帮助，请告诉我。

此致，

```
Michael 
```

PS我建议通过命名空间定义所有bean，如下所述：http: [//static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html)

它应该消除警告。

# c++ - 使程序花费实际时间来执行 C++

> ID：15116412
> 
> 赞同：0
> 
> 时间：2013-02-27T15:52:17.963
> 
> 标签：c++, time

我正在尝试使用 C++ 模拟一个需要实际时间的现实生活场景；我正在使用 for 循环将时间分成五分钟的增量。

我想知道是否有任何方法可以告诉程序每秒只执行for循环的一个步骤？这样节目将变得“可观看”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T15:55:39.993

获取当前时间并添加频率，执行您的动作并等待计算的时间。像这样。

```
#include <thread>
#include <chrono>

//...

while(whatever_condition()) {
    auto next=std::chrono::system_clock::now() 
             +std::chrono::seconds(1);

    do_whatever();

    std::this_thread::sleep_until(next);
} 
```

[http://en.cppreference.com/w/cpp/thread/sleep_until](http://en.cppreference.com/w/cpp/thread/sleep_until)

注意使用普通的“sleep”和“usleep”函数是非标准的，并且不会考虑操作所花费的时间。

编辑：这是一个 c++11 解决方案，但是如果没有 C++11 boost 也为 C++98 和 03 提供此功能。我相信这仍然比使用更可取`sleep`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:55:12.753

使用睡眠，您可以让程序等待。我不知道这是不是你想要的。因此，要等待一秒钟，请键入：

> 睡眠(1000)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T15:58:25.100

它以一致的速度运行有多重要？`sleep()`是一种可能的方法，但`sleep`在提供准确的时间片方面很差。当然，游戏需要一直这样做，所以游戏程序员已经探索了各种各样的方法来做到这一点，你可以在这里找到关于如何实现游戏循环的[讨论](http://www.koonsolo.com/news/dewitters-gameloop/)。中心理论是定期检查计时器并根据每秒产生所需的帧数进行更新。

# c# - 如何将域和存储库层公开为服务？

> ID：15116413
> 
> 赞同：2
> 
> 时间：2013-02-27T15:52:22.613
> 
> 标签：c#, wcf, domain-driven-design, domain-model

我的应用程序中当前有以下层：

1.  API
2.  应用服务层
3.  领域模型
4.  存储库

较低的 (2) 层（域和存储库）提供了跨业务需求的几乎全部重用，因此我想至少将我的域模型公开为服务，可能是 WCF 服务。基本上域实体数据、行为和持久性是可重用的，我需要一种方法来集中公开它。

我已阅读以下内容（[与 WCF 服务共享域模型](https://stackoverflow.com/questions/1468573/sharing-domain-model-with-wcf-service)）和类似的内容，这些内容表明为什么*不*直接通过 WCF 公开域实体是有充分理由的。大多数示例表明创建数据合约以公开域数据，然后具有映射机制以在域和 DTO（数据合约）数据之间进行映射。到目前为止，一切都很好。

如果我的域层中有如下方法，如何通过新的 WCF 服务公开它？我以为我只会公开 DTO，因此如何公开我想跨进程重用的共享/公共域行为？

```
public int ProcessSomeRule(string param1, string param2) 
```

如果答案是在 WCF 服务上创建一个充当代理但仍不`ProcessSomeRule`直接公开该方法的方法，我对此很满意，但这会产生另一个问题。这种抽象的目的和在名为 example 的 WCF 服务上创建一个方法，`ProcessSomeRuleWCF(string,string)`它只是在内部转身并调用域方法，似乎仍然是耦合的，而不是提供纯粹的抽象。它仍然对签名更改很敏感。

我读到通过不直接公开方法，我们可以在内部进行更改而无需修改合约接口。好的，这听起来很不错，但是如果我的内部方法需要一个*额外*的参数并且现在有签名 `ProcessSomeRule(string, string, string)，你猜怎么着？我的合约接口方法现在将中断，因为它缺少第三个参数，所以我的接口*必须*更改。不确定如何做到这一点并且仍然使抽象值得？

我的存储库以*同样*的方式是通用的，可以跨进程使用，我也想重用这一层。目前我的存储库（UoW）接口被注入到我的 AppService 层，所以我不知道如果 Repository 层是 WCF 服务，这将如何工作。

**问题：**如何公开域和存储库层的共享行为以及这些新层的名称是什么？新层是否公开了名为“Domain Service”的域并位于“AppService”和“DomainModel”之间？

最后，如果我走错了路，请随时指导我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:26:01.413

> 如何公开域和存储库层的共享行为以及这些新层的名称是什么？

在[六边形（端口和适配器）架构](http://alistair.cockburn.us/Hexagonal+architecture)的上下文中，您的领域层将被应用程序服务封装，从而定义您的应用程序的核心。应用程序服务通过委托聚合和域服务以及编排对存储库和基础设施服务的访问来实现用例。接下来，您可以“调整”您的应用程序以适应基础架构。让存储库实现在域层中声明的存储库接口就是一个例子。存储库实现充当域和外部世界之间的适配器。对于 WCF 服务也是如此，通常称为**开放主机服务**在 DDD 中，它们使您的应用程序适应传输基础设施。WCF 服务或 ASP.NET WebAPI 服务是委托给应用程序服务的一个相对较薄的层。同样，这一层的目的只是用作适配器。该层确实拥有它公开公开的合约。在 DDD 中，这称为已**发布语言**。例如，在 WCF 中，它将通过`DataContract`和`DataMember`属性来定义。这些合同是外部系统访问您的域的方式。在已发布的合约和内部域之间有一个缓冲很重要，因为它们可能会以不同的速率变化并具有不同的消费者需求。

> 新层是否公开了名为“Domain Service”的域并位于“AppService”和“DomainModel”之间？

不，域服务是域层本身的一部分，与实体、聚合和值对象一起存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-04T14:16:23.623

我认为将域对象公开为服务并不困难。但系统确实是服务和用户界面的结合。UI 访问服务，服务可以通过不同的方式实现：DDD 或 database-central 。所以告诉服务调用者我们如何实现我们的业务逻辑可能不是一个好主意。

# c# - Visual Studio 2012 中的 TFS 强制签入

> ID：15116418
> 
> 赞同：8
> 
> 时间：2013-02-27T15:52:26.420
> 
> 标签：c#, tfs, visual-studio-2012

上面的链接没有回答这个问题......

我在 TFS 上遇到了一些问题，其中 Visual Studio 在本地机器上构建没问题，但是当我尝试在服务器上构建时，我得到了构建错误。这些错误与这个问题无关。

我遇到的问题是，为了修复错误，我必须手动编辑本地计算机上的一些文件，并且由于它们是手动编辑的，因此 TFS 没有检测到更改，因此它不会让我将更改集上传到可以解决那里问题的服务器。

我的第一个也是主要问题是：如何强制 TFS 将所有本地文件复制到服务器。有点像整体的反面：

转到查看/其他窗口/源代码管理资源管理器/右键单击相关项目/高级/获取特定版本/选中“覆盖所有文件...”/按确定。

哪个（可以说，因为根据我的经验，它并不总是能得到所有东西）从服务器获取完整的文件集到本地机器。

我厌倦了 TFS 上传部分文件集，然后当解决方案在本地删除，然后从服务器重新下载时，我必须从一些备份中提取丢失的文件和引用。如果它在开始时完全上传并且正确，我可能会减少这些问题。所以这是我的主要问题。如何强制 TFS 上传我的所有文件，无论它们是否已更改。

为了进一步解释我在使用 nuget 包管理器时遇到的问题。我禁用了“允许 NuGet 在构建期间下载丢失的包”选项。所以在本地我得到了实际的构建错误。是的，没错，构建错误。像这样...

> 项目 XXX：默认情况下禁用包还原。要给予同意，请打开 Visual Studio 选项对话框，单击包管理器节点并选中“允许 NuGet 在构建期间下载丢失的包”。您还可以通过将环境变量“EnableNuGetPackageRestore”设置为“true”来表示同意。

现在迫使我重新启用此选项以消除错误。我对此感到恼火，因为此类错误应作为警告显示，以免阻止构建。这非常令人失望，因此我对 NuGet 的看法很差。

无论如何，足够的咆哮，我重新启用了这个，不像我有选择。但是禁用此功能的版本会上传到服务器。现在我在服务器上收到此错误。我尝试重新启用它并进行检查，但 TFS 不允许我这样做。（警告...没有挂起的更改）。当然不是，它只是一个愚蠢的复选框。什么可能已经改变了。但是现在我在服务器上遇到了一个错误，我无法修复所有错误，因为 NuGet 的某个人没有将一些教导用于正确设计他们的警告（而不是通过导致错误来阻止构建）。

所以，再一次，我怎样才能强制 TFS 将我所有的文件，无论是更改还是未更改，逐字逐句传送到服务器。这样，当我在本地修复问题时，它“应该”也在服务器上修复它。或者至少，当我下次下载它时，我确信拥有整个文件集。

抱歉，如果这听起来我很消极，但我已经坚持了 5 天，它已经完全停止了开发，这让我和公司损失了很多钱。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T16:33:05.620

没有办法告诉 TFS 获取我文件系统中的所有内容。您需要做的是一个多步骤的过程。首先签出整个目录，这不会覆盖您的手动更改，但允许您重新签入并让它检测这些更改。其次，如果创建了任何新文件，您需要在根目录中添加并获取所有新添加。最后检查所有更改。真的应该这么简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T08:28:24.280

如果您使用的是 TFS 2012，那么`Local Workspaces`对您来说将是一个很好的解决方案。

只是要清楚 -`Local Workspaces`并不意味着您的开发人员在本地工作。所有代码仍处于源代码控制之下，与`Server Workspaces`.

`Local Workspaces`是 TFS 2012 的新手，可以解决您的问题。您的主要优势是文件不再被标记`read-only`。这使您能够从任何地方（记事本、任何其他 IDE、Visual Studio）编辑它们，而无需先进行结帐。然后 Visual Studio 将自动检测文件已更改并在`Pending Changes`窗口中列出。

比较不同类型的工作空间的好文章：http: [//blogs.msdn.com/b/willy-peter_schaub/archive/2011/11/30/team-foundation-server-trying-to-understand-server-versus-local -workspaces.aspx](http://blogs.msdn.com/b/willy-peter_schaub/archive/2011/11/30/team-foundation-server-trying-to-understand-server-versus-local-workspaces.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-15T07:15:39.287

是的，我知道在火焰开始出现之前，这不是传统的....但是团结一致我经常遇到这个问题。当我更新到统一 5.5 时，现在从字面上处理它，它在我当前的项目中带来了很多东西。在统一解决之后，我的项目完全不同步......无论出于何种原因，vis stu 拒绝监控这些变化......可以肯定的是，这很烦人，但不用担心，因为我每次都成功解决了它通过执行以下操作来完成迭代：

1.  在单独的位置创建一个备份文件夹并将整个内容复制过来。只要备份在一个唯一的单独文件夹中，备份到哪里都没有关系。请务必复制文件夹而不是单个文件，因为某些文件可能会被隐藏。

2.  完整获取最新版本（根据 TFS）。这可能需要一些时间，这就是您将其备份到单独位置的原因。请务必在这一点上保持 VS 开放！！！

3.  使用您在步骤 1 中创建的备份覆盖您“获得”的所有文件。当您使用备份副本将文件覆盖到本地空间时，本地工作空间将监控对文件的更改，并将它们标记为待处理如果新的有任何差异，则相应地更改。

4.  在源代码管理资源管理器中更新对 TFS 服务器的待定更改。在覆盖期间检测到的任何更改都将添加到包含的更改部分。

瞧，您已将文件、工作和意愿强制到 TFS 服务器上！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-02T18:37:46.727

我喜欢使用源代码管理资源管理器窗口，然后右键单击文件夹并选择比较。您可以选择查看目标文件夹中有什么不同，或者什么是新文件。不同的文件以红色显示。然后，您可以右键单击它们并签出和签入文件，或者使用 control-click 一次选择多个文件。

# r - 从行创建序列概览

> ID：15116419
> 
> 赞同：1
> 
> 时间：2013-02-27T15:52:28.933
> 
> 标签：r, sequence

我有一个示例数据集，如下所示：

```
tc <- textConnection('
path           touchpoint  time
abc             A           1        
abc             A           2        
abc             B           3        
abc             C           4         
def             A           2       
def             B           3       
def             D           4        
def             C           5        
def             D           6 
ghi             A           1
ghi             A           2
ghi             A           3
ghi             C           4
jkl             A           5        
jkl             A           6        
jkl             B           7        
jkl             C           8     
mno             B           1        
mno             A           2        
mno             A           3       
mno             C           4 
pqr             A           1
pqr             C           2
test     "touchpoint A"     1
test     "touchpoint-B"     2
')

paths <- read.table(tc, header=TRUE) 
```

我想创建路径概览，并计算路径出现的次数。是`touchpoints`形成`path`. 每个`path`都由一个字符（或一组字符）标识，该字符在列中说明`path`。例如`path`abc 包含接触点 A、A、B 和 C。作为输出，我想了解所有不同接触点的路径及其计数。

这个输出表没有固定的宽度，因为一条路径可以有大量不同的接触点。因此，我想在第一列中有计数。另外两个限制是：

*   路径是根据时间创建的，时间最短的接触点应始终排在第一位。
*   如果随后有来自同一实例的接触点（所以 AA），那么在概述中它应该显示为 A，或者更理想的是 A（2x）

我真的不知道从哪里开始这个..

该示例的预期输出为：

```
freq           1                2               3       4       5
 2             A                B               C   
 2             A                C
 1             A                B               D       C       D
 1             B                A               C
 1            "touchpoint A"    "touchpoint-B" 
```

更理想的输出是：

```
freq           1                2               3       4       5
 2             A (2x)           B               C   
 1             A                B               D       C       D
 1             A (3x)           C
 1             B                A (2x)          C
 1             A (2x)           C
 1            "touchpoint A"    "touchpoint-B" 
```

选择列名 1 到 N 来指示接触点是第一个、第二个还是第 N 个。请注意，在“理想”输出中，由于提供的第一个输出的旅程`ghi`和`pqr`提供的第一个输出的旅程相同（AAC 将在此处变为 AC），因此会呈现更多旅程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:11:37.643

一个简短的辅助函数使用`rle()`和一点`plyr`：

```
library(plyr)

foo <- function(x){
  r <- rle(as.character(x))
  short <- paste0(r$values, collapse="_")
  long  <- paste0(r$values, "(", r$lengths, ")", collapse="_")
  data.frame(short, long)
}

ddply(paths, .(path), function(x)foo(x$touchpoint))

  path                     short                            long
1  abc                     A_B_C                  A(2)_B(1)_C(1)
2  def                 A_B_D_C_D        A(1)_B(1)_D(1)_C(1)_D(1)
3  ghi                       A_C                       A(3)_C(1)
4  jkl                     A_B_C                  A(2)_B(1)_C(1)
5  mno                     B_A_C                  B(1)_A(2)_C(1)
6  pqr                       A_C                       A(1)_C(1)
7 test touchpoint A_touchpoint-B touchpoint A(1)_touchpoint-B(1) 
```

* * *

这可以让你大部分时间到达那里。`ddply()`您可以使用另一个或`tapply()`类似的方法来计算出现次数。并且您可以将短格式转换为带有`strsplit()`.

# node.js - 在 socket.io 中阻止调用似乎不会阻止其他客户端

> ID：15116423
> 
> 赞同：0
> 
> 时间：2013-02-27T15:52:41.493
> 
> 标签：node.js, socket.io

我有以下代码：

```
var schedules = io.on('connection', function(client) {
    var schJSON = JSON.parse(fs.readFileSync(__dirname +'huge_file.json', 'utf8'));
    client.json.send(schJSON);
}); 
```

`readFileSync`作为一个阻塞调用，我认为当服务器正在处理一个客户端的请求时，其他客户端会排队。因此，如果读取文件大约需要 10 秒，并且我触发了与服务器的三个不同连接，那么第三个连接将需要大约 30 秒才能得到响应。

实际上，所有三个客户端几乎同时获得响应（经过 10 秒后）。这三个请求是从三台不同的机器（具有相同的外部 IP 地址）发出的。

这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:06:39.257

我希望流程是这样的：

1.  第一个请求进来并阻塞读取文件。
2.  又有两个请求进来，它们的“连接”回调排队。
3.  初始文件读取完成，异步`client.json.send`调用开始发送响应。
4.  其他两个请求的回调被调用，每个`readFileSync`调用都很快完成，因为文件在磁盘缓存中，然后`client.json.send`被调用，以便并行发送所有三个请求的响应。
5.  所有三个请求都完成了，可能接近于同一时间，因为第 4 步非常快。

# java - 如何管理字节流以及何时关闭流

> ID：15116424
> 
> 赞同：2
> 
> 时间：2013-02-27T15:52:41.947
> 
> 标签：java, file-io, inputstream, out-of-memory

每当我尝试执行我的代码时，我都会遇到 java.lang.OutOfMemoryError: Java heap space。但是，如果我在某些情况下关闭流，错误就会消失，但是由于我的流过早关闭，我会丢失数据。

我对 Java 很陌生，我显然不了解如何管理流。我应该如何以及何时关闭流？

```
private void handleFile(File source)
{
    FileInputStream fis = null;

    try
    {
        if(source.isFile())
        {
            fis = new FileInputStream(source);
            handleFile(source.getAbsolutePath(), fis);
        }
        else if(source.isDirectory())
        {
            for(File file:source.listFiles())
            {
               if(file.isFile())
               {
                   fis = new FileInputStream(file);
                   handleFile(file, fis);
               }
               else
               {
                   handleFile(file);
               }
            }
         }
     }
     catch(IOException ioe)
     {
         ioe.printStackTrace();
     }
     finally
     {
         try
         {
             if(fis != null) { fis.close(); }
         }
         catch(IOException ioe) { ioe.printStackTrace(); }
     }
}

private handleFile(String fileName, InputStream inputStream)
{
    try
    {
       byte[] initialBytes = isToByteArray(inputStream);
       byte[] finalBytes = initialBytes;

       if(initialBytes.length == 0) return;

       if(isBytesTypeB(initialBytes))
       {
          finalBytes = getBytesTypeB(startingBytes);
       }
       // Other similar method checks
       // .....

       map.put(fileName, finalBytes);
     }
     catch(IOException ioe)
     {
         ioe.printStackTrace();
     }
}

private byte[] isToByteArray(InputStream inputStream)
{
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    byte[] buffer = new byte[1024];

    int nRead;
    while((nRead = inputStream.read(buffer)) != -1)
    {
        baos.write(buffer, 0, nRead);
    }
    return baos.toByteArray();
 }

 private boolean isBytesTypeB(byte[] fileBytes)
 {
     // Checks if these bytes match a particular type
     if(BytesMatcher.matches(fileBytes, fileBytes.length))
     {
         return true;
     }
     return false;
 }

 private byte[] getBytesTypeB(byte[] fileBytes)
 {
     //decompress bytes

     return decompressedBytes;
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:07:14.350

首先，不要读取内存中的整个流。读写时使用缓冲区。

`ByteArrayInputStream`并且`ByteArrayInputStream`仅当您确定要读取非常小的流（您需要将其数据重新用于某些操作）并且将数据保存在内存中确实有意义时才使用。否则，您将很快（或意外）耗尽内存。

在 try-catch 块之外定义流并在 finally 块中关闭它们（如果它们不为空）。例如：

```
void doSomeIOStuff() throws IOException
{
    InputStream is = null;

    try
    {
        is = new MyInputStream(...);
        // Do stuff
    }
    catch (IOException ioExc)
    {
        // Either just inform (poor decision, but good for illustration):
        ioExc.printStackTrace();
        // Or re-throw to delegate further on:
        throw new IOException(ioExc);
    }
    finally
    {
        if (is != null)
        {
            is.close();
        }
    }
} 
```

这样，您的资源在使用后始终会正确关闭。

出于好奇，该`handleFile(...)`方法真正应该做什么？

# bash - Bash 字符串替换给了我“坏替换”

> ID：15116427
> 
> 赞同：8
> 
> 时间：2013-02-27T15:52:43.427
> 
> 标签：bash, replace

我有一个 url 变量，我想在 bash 中替换该 url 的一部分，但我不断收到“错误替换”

```
URL="http://hostname/project/branches/Old_Branch/package"
SRC="Old_Branch"
REP="New_Branch"

echo ${$URL/$SRC/$REP};
# desired output is http://hostname/project/branches/New_Branch/package 
```

不知道我到底哪里错了......

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-27T15:57:24.477

```
URL="http://hostname/project/branches/Old_Branch/package"
SRC="Old_Branch"
REP="New_Branch"

echo "${URL/$SRC/$REP}" 
```

请注意in =)中没有`$`标记`URL``${}`

# android - 以编程方式在 TextView 中的子底部索引文本

> ID：15116429
> 
> 赞同：1
> 
> 时间：2013-02-27T15:52:44.810
> 
> 标签：android, textview

我需要以编程方式将 TextView 设置为“CO2”，并将 2 作为子索引。

我可以使用带有 string.xml 的预填充视图

```
 <string name="co2">CO<sub>2</sub></string> //prints CO2 with sub index 
```

但不知何故，当我用代码设置它时它不起作用

```
 textView.setText(getString(R.string.co2)); //prints CO2 without sub index 
```

我知道我可以进行布局并放置 2 个文本视图，但这是唯一的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T15:54:26.073

利用：

```
textView.setText(Html.fromHtml(getString(R.string.co2))); 
```

编辑：您需要导入[android.text.Html](http://developer.android.com/reference/android/text/Html.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:35:06.790

```
((TextView)findViewById(R.id.text)).setText(Html.fromHtml("Co<sup>2</sup>")); 
```

或者

[http://ftp.gunadarma.ac.id/android/sdk/sdk_310712/docs/resources/faq/commontasks.html#selectingtext](http://ftp.gunadarma.ac.id/android/sdk/sdk_310712/docs/resources/faq/commontasks.html#selectingtext)（镜像链接）

# iphone - 如何在不启动的情况下在 ios 应用程序之间发送获取数据

> ID：15116431
> 
> 赞同：0
> 
> 时间：2013-02-27T15:52:55.143
> 
> 标签：iphone, ios

我想使用代理之类的ios应用程序。同一设备上将安装各种应用程序，所有应用程序都将通过代理应用程序与服务器通信。

我将向代理应用程序发送请求，代理应用程序将处理请求，将其发送到服务器并将响应发送到各种应用程序。

当我使用**URLScheme**时，这将启动应用程序并将其放在前面。我不想启动应用程序。有可能做到这一点吗？使用应用程序谎言服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:22:29.437

AppSupport 框架公开了一个适合进程间通信的 Objective-C 类：`CPDistributedMessagingCenter`. [您可以在此处](http://iphonedevwiki.net/index.php/CPDistributedMessagingCenter)阅读有关其用法和实现方式的详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T22:17:18.703

对于跨多个应用程序的登录，您应该使用 KeychainManager 和共享子域，该子域具有将应用程序与 keychain-access-group 链接在一起的权利。

请参阅[如何在 iOS 应用程序之间共享钥匙串数据](https://stackoverflow.com/questions/4115744/how-to-share-keychain-data-between-ios-applications)

# php - 在 mysql 表名中使用 php uniqid 会导致偶尔出现错误 - 如何避免它？

> ID：15116435
> 
> 赞同：0
> 
> 时间：2013-02-27T15:53:08.403
> 
> 标签：php, mysql, apache

在不详细说明原因的情况下，我需要自动生成 mySQL 表，该表利用包含 PHP uniqid 函数生成的字符串的唯一表名。这样做时，我偶尔（并非总是）收到以下查询错误：

> 无效查询：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ''512e1d9518d44_tbl'' 附近使用正确的语法 整个查询：SELECT SUM(p_count) AS 'pcnt' FROM 512e1d9518d44_tbl

我知道我可以使用一个简单的交叉引用查找表，但是有没有另一种方法可以避免错误，我认为这是违反表命名规则的结果，同时仍然保持表命名的非顺序唯一性？我试过单引号表名但得到相同的结果顺便说一句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:55:30.247

当您的表/列名称以数字开头时，您必须使用反引号对其进行转义：

```
SELECT SUM(p_count) AS pcnt FROM `512e1d9518d44_tbl` 
```

# javascript - jQuery UI 对话框不会正确居中

> ID：15116438
> 
> 赞同：1
> 
> 时间：2013-02-27T15:53:13.190
> 
> 标签：javascript, jquery, html, jquery-ui, jquery-ui-dialog

我有一个想要打开的 jQuery 弹出对话框，`max-width`我希望它居中。我还想对其内容重复使用相同`div`的内容。我的问题是，如果您`width:auto`在打开对话框时进行设置，正如您需要做的`max-width`那样，如果您首先弹出一些*不会*导致溢出的文本，然后弹出对话框，则对话框将无法正确居中一些*文字*：

[http://jsfiddle.net/kxCuq/2/](http://jsfiddle.net/kxCuq/2/)

如您所见，第二次弹出窗口向右移动，而不是水平居中。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T11:09:54.073

我建议一旦你改变了内容的宽度，销毁并重新创建它，以便 jQuery 可以重新计算宽度和中心。

此外，该`maxWidth`选项指定*对话框可以调整大小的最大宽度，以像素为单位*；所以这个选项不能按你期望的方式工作。设置内容的最大宽度。所以我们有：

```
#dialog {
    max-width: 200px;
    display: none;
} 
```

```
$("#dialog").dialog({
    modal: true,
    draggable: false,
    width: "auto",
    close: function (event, ui) {
        $(this).dialog("destroy");
    }
}); 
```

[**jsFiddle 上的演示**](http://jsfiddle.net/salman/kxCuq/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T06:50:25.693

我不知道为什么这是一个很难的问题。通过为 'ui-dialog' 类设置 css 属性真的可以很容易地完成。

这是做什么：

设置好 html 后，添加这个 jquery：

`$('.ui-dialog').css('position','relative');`

`$('.ui-dialog').css('margin','10px auto');`

如果您希望它具有固定的最大宽度，例如 400px，您也可以添加：

`$('.ui-dialog').css('max-width','400px');`

如果您希望两个框相同且完全相同（第一个弹出窗口和第二个弹出窗口），您可以将其添加到您的 css 中：

`.ui-dialog{ position:relative; max-width:200px; margin:10px auto 10px auto; }`

这是现场演示链接：

[现场演示](http://jsfiddle.net/MFmCB/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:35:26.760

`width:auto`似乎是罪魁祸首。删除它，一切都正确居中。

如果您需要设置宽度，可以在更改内容时使用设置器来更改宽度： `$( ".selector" ).dialog( "option", "width", 500 );`

# ios - 第二次访问页面时，Phonegap 设备无法正常工作

> ID：15116440
> 
> 赞同：0
> 
> 时间：2013-02-27T15:53:17.873
> 
> 标签：ios, google-maps, cordova

我正在尝试使用 phonegap + google maps for ios 创建一个地图。它第一次运行良好，但如果我导航到另一个页面然后我再次返回到我的地图页面，似乎什么都没有发生，似乎 deviceready 没有被触发。任何想法？

```
<script src="phonegap.js"></script>
<script src="maparestaurante.js"></script>
<link href="styles/retina.css" rel="stylesheet" type="text/css" media="only screen and (-webkit-min-device-pixel-ratio: 2)" />

</head>

<body onload="onLoad()"> 
```

和javascript：

```
function onLoad() {
document.addEventListener("deviceready", onLoad2, true);
}
function onLoad2() {
if (navigator.geolocation) {
navigator.geolocation.getCurrentPosition(success, error);
} else {
error('not supported');
}
} 
```

正如我所说，这第一次工作正常，但如果再次访问地图部分，它将永远无法工作，在浏览器中测试它时一切正常

提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:19:10.470

deviceReady 只会被触发一次。当应用程序初始化时。当您想在再次访问页面时触发加载函数时，您需要在“页面视图”（您的 SPA 框架支持的任何事件）事件中再次调用该函数。

# sql - 实数和浮点数小数长度和精度

> ID：15116444
> 
> 赞同：0
> 
> 时间：2013-02-27T15:53:21.453
> 
> 标签：sql, sql-server

我知道[**float 和 real 是**](http://msdn.microsoft.com/en-us/library/ms173773.aspx)：

> 用于浮点数值数据的近似数数据类型。浮点数据是近似的；因此，并非数据类型范围内的所有值都可以准确表示。

但是，在以下示例中：

**Q1：**为什么*'float( **24** )'* (ie; real)比*'float(* ***53*** *)'给出**更多的小数*但不那么准确？

 ****Q2：**如何在不四舍五入的情况下将*@s 存储在数字字段中？*

```
declare @s varchar(50) = '34.770438199999944'
select convert(float(24), @s) real_, convert(float(53), @s) float_ 
```

[**结果**](http://sqlfiddle.com/#!6/d41d8/2856)（括号是为了使差异更清晰）

```
|             real_ |       float_ |
------------------------------------
| 34.77043(9147949) | 34.77043(82) | 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:01:19.347

Q1。这只是一个显示问题，对于其他数字可能会有所不同。它将在更适合的地方四舍五入（它将更接近数字的实际近似值）。精度较低，因为它存储数字的数据较少。

Q2。在 mssql 中（如标签所示 sql-server），您可以进行小数化，并且您将存储该数字而不会丢失精度。但是您可以存储的数量是有限的。**

# jquery-plugins - zepto $.type() 函数

> ID：15116445
> 
> 赞同：0
> 
> 时间：2013-02-27T15:53:20.923
> 
> 标签：jquery-plugins, porting, zepto

我目前正在尝试使[jquery tokeninput](http://loopj.com/jquery-tokeninput/)插件 zepto 兼容。

根据 1.0 版中的[zepto 文档](http://zeptojs.com/#%24.type)，应该有一个名为的函数`$.type()`（我使用的是最新的 1.0rc），但每当我尝试调用此函数时，都会收到以下错误：

`Object function (a,b){return w.init(a,b)} has no method 'type'`

有人对此有快速的回答/修复吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T13:52:18.263

就我而言，我`typeof()`的工作满足了我的需要。

由于 zepto 终于在 1.0 版中推出，它也支持 $.type 。

# java - 如何将带有 DI 的过程代码转换为 OO 代码

> ID：15116447
> 
> 赞同：1
> 
> 时间：2013-02-27T15:53:23.580
> 
> 标签：java, cdi

我有一个使用 CDI 的项目。具有状态列表的容器托管服务类。

```
@ApplicationScoped
public class StateService {

    @Inject
    MailService mailService;

    //Inject some other stuff

    private Map<String, State> state = new HashMap<String, State>();

    public void makeStateTransition(StateChange stateChange) {
        State currentState = state.get(stateChange.getKey());
        switch (currentState.stateType) {
            case STATE1:
                handleState1Transition(stateChange);
            case STATE2:
                handleState2Transition(stateChange);
            case STATE3:
                handleState3Transition(stateChange);
        }
    }

    private void handleState1Transition(StateChange stateChange) {
        //Do some stuff to handle state and use injected mailsender to send some email
        mailService.sendEmail("Send some email");
        //if some criteria is right create a new state and set it in the map
        State newState = new State();
        //Set some variable
        state.put(stateChange.getKey(), newState);
    }

    private void handleState2Transition(StateChange stateChange) {
        //Do stuff similar to above, maybe use other injected fields
    }

    private void handleState3Transition(StateChange stateChange) {
        //Do stuff similar to above
    }
}

public class State {

    public enum StateType {
        STATE1, STATE2, STATE3
    }

    public StateType stateType;

    //Bunch of other properties

} 
```

事实证明这是非常程序化的。我对其进行了重构以尝试使其更加面向对象。

```
@ApplicationScoped
public class StateService {

    @Inject
    MailService mailSerice;

    //Inject some other stuff

    private Map<String, State> state = new HashMap<String, State>();

    public void makeStateTransition(StateChange stateChange) {
        State currentState = state.get(stateChange.getKey());
        State newState = currentState.handleStateChange(stateChange, mailService);
        state.put(stateChange.getKey(), newState);
    }
} 
```

现在 StateService 不需要知道所有的状态转换

```
public abstract class State {
    //Some protected fields shared by all states

    public abstract State handleStateChange(StateChange stateChange, MailService mailService);
}

public class SomeState extends State {

    //Some properties specific to this state

    public State handleStateChange(StateChange stateChange, MailService mailSerice) {
        //Do some stuff to handle state and use injected mailsender to send some email
        mailSerice.sendEmail("Send some email");
        return new SomeOtherState();
    }
} 
```

这会产生更好的代码，尤其是随着可能状态数量的增加。问题是让注入的邮件发件人进入需要它的正确状态。有些州可能不需要它，而另一些州可能需要别的东西。因为状态不是由容器创建的，所以它们自己不能使用注入。在状态的构造函数中传递注入的字段是可能的，但是注入的对象可能会在非托管状态中变得“陈旧”？

我求助于在方法调用中将其作为参数发送，这样它应该始终是“新鲜的”。如果需要将许多注入作为参数发送并且在某种程度上感觉错误，则非常麻烦。

您将如何建议如何处理此示例中状态对象所需的注入资源？

请忽略课堂上的任何线程问题。

# android - Eclipse 无法判断 android 设备版本

> ID：15116449
> 
> 赞同：0
> 
> 时间：2013-02-27T15:53:25.673
> 
> 标签：android

所以，我设法让 Eclipse 检测我的 Android 设备进行调试，但由于某种原因它无法检测到 Android 版本。这意味着我无法在设备上启动我的应用程序。

![设备选择器消息](../Images/114deabb79fdc6810a1e040107475209.png)

有谁知道这是为什么？（在任何人说之前，我已经尝试重新启动一切）

编辑：这是一个 HTC Desire 设备，我以前从未遇到过这个问题（即它以前工作过）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:46:43.233

它与新 ADT 21.1 的问题，如果你没有安装平台 17，那么你有这个问题..安装新 ADT 并更新 ADB 并重新启动 pc.done

# javascript - 使用 javascript/jquery 获取正文边距

> ID：15116451
> 
> 赞同：0
> 
> 时间：2013-02-27T15:53:32.897
> 
> 标签：javascript, jquery, html, css

我在 CSS 文件中定义了网页的边距：

```
body {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-color: #000000;
    margin: 8px;
} 
```

使用 JavaScript/JQuery，我如何获得保证金值？在这种情况下，值为“8”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T15:54:57.273

那将是

```
$('body').css('margin'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:56:42.847

获得风格..

```
$('body').css('margin'); 
```

# c++ - Openvms C++ - 如何将值传递给环境

> ID：15116452
> 
> 赞同：0
> 
> 时间：2013-02-27T15:53:33.583
> 
> 标签：c++, environment-variables, openvms

我正在尝试从 VMS 上的 C++ 程序传递值。

```
$DESCRIPTOR( lname, (char*) "A" );
$DESCRIPTOR( lvalue, (char *) "Hello World" );
lib$set_logical( &lname, &lvalue );
lib$set_symbol (&lname,&lvalue); 
```

它应该工作吗？如果不是，我该如何纠正？

如何检查返回值？

如果成功，我如何检查环境？

如果有效，是否可靠？（不取决于权限等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:47:24.403

不。查看 $DESCRIPTOR 是如何定义的，在 descrip.h 中： `#define $DESCRIPTOR(name,string) struct dsc$descriptor_s name = { sizeof( string)-1, DSC$K_DTYPE_T, DSC$K_CLASS_S, string }`

在您的示例中，lname 和 lvalue 的第一个元素都包含 3，从 (char*) 的大小派生，但预期是字符串的长度，从字符数组的大小派生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-27T04:03:54.073

[lib$set_symbol](http://www.eight-cubed.com/examples/framework.php?file=lib_set_symbol.c)和[lib$set_logical](http://www.eight-cubed.com/examples/framework.php?file=lib_set_logical.c)的 C 语言工作示例，包括如何正确执行描述符和标准化错误检查。你不需要特权来执行这些功能，所以是的，它是“可靠的”。

要查看程序的结果，您可以输入（对于我的示例）：

```
$ SHOW SYMBOL/GLOBAL LIB_SET_SYMBOL_TEST 
```

和：

```
$ SHOW LOGICAL LIB_SET_LOGICAL_TEST 
```

# javascript - Coldfusion 使用 javascript 显示/隐藏 div 块

> ID：15116454
> 
> 赞同：2
> 
> 时间：2013-02-27T15:53:37.047
> 
> 标签：javascript, html, coldfusion

我在 ColdFusion5 中编程并尝试根据 select 语句的 onchange 调用显示/隐藏 div 代码块。我在网上发现了类似的问题，但是我没有使用 style.display 或 visibility。使用此代码，我可以进入 js 函数，第一个警报触发选择选择的值，然后我在 if 语句中获得第二个警报。一旦它到达隐藏/显示 div 的行，它就会退出。有任何想法吗？

**ColdFusion 代码（注意：此代码在 iframe 中）：**

```
<select name="select_Attendee_2" required="yes" onchange="parent.showHideGuestForm();">
        ...stuff...
    </select>
    <div id="GuestLayer1">
        ...more stuff...
    </div> 
```

**Javascript（在外部文件中）：**

```
function showHideGuestForm()
{
    var iFrame = $($('#my_iframe').contents());
    alert(window.my_iframe.document.formAttendees.elements['select_Attendee_2'].value);

    if ((trim(window.my_iframe.document.formAttendees.elements['select_Attendee_2'].value)) == '')
        {
            alert("before none");
            window.my_iframe.document.formAttendees.getElementById('GuestLayer1').style.display = 'hidden';
            alert("after none");
        }
        else
        {
            alert("before block");
            window.my_iframe.document.formAttendees.getElementById('GuestLayer1').style.display = 'block';
            alert("after block");
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T05:07:20.793

我给出 jquery 示例来隐藏/显示选中的 div（在切换中）

```
<!--jquery code -->
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
 </script>
<script language="jscript">
$(document).ready(function(){
$("#NewVendor").click(function(){
    $("#ebdiv").toggle();
});
});
</script>
<!--jquery code ends -->

<!-- cf part--->
 <input type="checkbox" name="NewVendor" id="NewVendor"  /> New Vendor

 <div id="ebdiv" >
<table  border="0" width="70%" cellspacing="0" cellpadding="0" id="cartContentsDisplay">
<tr>
<td width="25%"><b>New Vendor </b></td> <td>:*</td><td align="left"><cfinput type="text" name="VendorName" id="VendorName" value="" size="30"  />
</td>
</tr>
<tr>
<td><b>Address</b> </td> <td>:*</td><td align="left"><cfinput type="text" name="Address" id="Address" value="" size="30" />
</td>
</tr>
<tr>
</table>
<<!-- cf part ends---> 
```

它正在 Chrome 上运行，并在其他浏览器中进行了检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T03:39:15.943

这让我很烦，所以我用 html 文件尝试了它。它与 ColdFusion 无关。这是 iframe 内页面的相关部分。

```
<p id="p2">This is page 2.</p>
<form id="myForm" action="Page2.html" method="post">
    <div id="div1">
        <p>This is in the div.</p>
    </div>

</form> 
```

这是父页面的相关部分，包括 javascript。

```
<p id="p1">hello</p>
<iframe id="myIframe" width="100" height="200" src="Page2.html"></iframe>
<p>
    <button id="theButton" value="a button" onclick="hideDiv()"></button>

</p>
<script>
    function hideDiv() {
        var iFrame = document.getElementById("myIframe");
        var theDiv = iFrame.contentWindow.document.getElementById("div1");
        theDiv.style.visibility = "hidden";
    }

</script> 
```

此代码适用于 Firefox。我没有在其他浏览器中尝试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T15:18:53.427

事实证明这是过度范围的问题，删除表单名称解决了问题：

```
window.my_iframe.document.getElementById('GuestLayer1').style.display = 'none'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T07:04:16.187

试试这个代码............

```
<script type='text/javascript'>
function showDiv() {
    if (document.getElementById('hiddenDiv').style.display == 'block') {
        document.getElementById('hiddenDiv').style.display = 'none';
    } else {
        document.getElementById('hiddenDiv').style.display = 'block';
    }
}
</script>
<div id="hiddenDiv"  style="display:none;" class="answer_list" >
  WELCOME
</div>
<input type="button" name="answer" value="Show Div" onclick="showDiv()" /> 
```

# c# - 类型的运算符重载

> ID：15116455
> 
> 赞同：0
> 
> 时间：2013-02-27T15:53:38.530
> 
> 标签：c#, operator-overloading

当我输入问题时，我可以看到*运算符重载列表...*问题排成一列。其中大多数是用于 C++ 或 Haskell 的。我的问题是针对 C# 的，可以说逻辑可能是相同的。我的问题是我想了解 C# 上下文中的运算符重载。

我正在看一个教程，它显示，

```
DateTime dt1 = new DateTime();
//do some work
DateTime dt2 = new DateTime();
TimeSpan ts = dt2 - dt1; 
```

并且作者说，使用`-`DateTime 数据类型是最好的运算符重载示例。我只能看到一个日期被另一个日期减去并保存到一个`TimeSpan`对象中。它也没有使用`operator`关键字和`static`关键字。

我觉得很难理解。有人可以解释这里发生了什么吗？这是否意味着在上面的下面`ts = dt2 - dt1`，有一个正在发生的`public static DateTime operator -(DateTime, DateTime)`事情？

更新：

第二个例子：

```
//some parameterized constructor is here to set X, Y

public static Point operator +(Point p1, Point p2)
{   
    Point p = New Point();
    p.X = p1.X + p2.X;
    p.Y = p2.Y + p2.Y;
    return p
{ 
```

在这种情况下，操作数必须与返回类型相同？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T15:55:57.577

该`operator`关键字在*声明*重载运算符时使用，而不是在*使用*它时使用。

所以操作符会写成这样：

```
public static TimeSpan operator -(DateTime lhs, DateTime rhs)
{
    // Code to execute
} 
```

*当您使用*运算符时，这些都不会干扰- 您只需在您已经显示的代码类型中使用它。所以这一行：

```
TimeSpan ts = dt2 - dt1; 
```

将调用上面给出的代码。

示例代码：

```
using System;

public class Int32Wrapper
{
    private readonly int value;
    public int Value { get { return value; } }

    public Int32Wrapper(int value)
    {
        this.value = value;
    }

    public static Int32Wrapper operator +(Int32Wrapper lhs, Int32Wrapper rhs)
    {
        Console.WriteLine("In the operator");
        return new Int32Wrapper(lhs.value + rhs.value);
    }
}

class Test
{
    static void Main()
    {
        Int32Wrapper x = new Int32Wrapper(10);
        Int32Wrapper y = new Int32Wrapper(5);
        Int32Wrapper z = x + y;
        Console.WriteLine(z.Value); // 15
    }
} 
```

要回答您问题的最后一点：

> 这是否意味着在上面的下面`ts = dt2 - dt1`，有一个正在发生的`public static DateTime operator -(DateTime, DateTime)`事情？

不 - 没有`DateTime`返回的减法运算符`DateTime`- 只有一个返回的`TimeSpan`。

编辑：关于你的第二个例子`Point`，我认为将两个`Point`值加在一起在逻辑上没有意义。例如，如果您将您的家庭位置添加到您的工作位置，您会得到什么？有一个类型更有意义`Vector`，然后：

```
public static Vector operator -(Point p1, Point p2)
public static Vector operator +(Vector v1, Vector v2)
public static Point operator +(Point p1, Vector v1) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T16:02:31.263

假设您有一个“金额”类，如下所示：

```
public class Amount
{
    public int AmountInt { get; set; }
} 
```

你有该类的两个实例：

```
Amount am1 = new Amount { AmountInt = 2 };
Amount am2 = new Amount { AmountInt = 3 }; 
```

你不能简单地做：

```
Amount am3 = am1 + am2; //compilation error 
```

您必须向 Amount 类添加一个运算符以提供此功能：

```
public static Amount operator +(Amount amount1, Amount amount2)
{
    return new Amount { AmountInt = amount1.AmountInt + amount2.AmountInt };
} 
```

减法 (-) 也是如此。现在，如果你这样做：

```
Amount am3 = am1 + am2; 
```

在这种情况下，am3 的 int-value 属性将为 5。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T15:58:50.770

一个运算符就是一个方法的语法糖。例如 - 运算符可能类似于

```
//not the actual syntax
public MyObject minus(MyObject object1, MyObject object2)
{
    //insert custom subtraction logic here
    return result
} 
```

* * *

您可以为您定义的任何自定义类重载运算符。

[这是我在你身上找到的一个教程](http://msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx)

这是本教程第一个示例的相关片段

```
 // Declare which operator to overload (+), the types 
   // that can be added (two Complex objects), and the 
   // return type (Complex):
   public static Complex operator +(Complex c1, Complex c2) 
   {
      return new Complex(c1.real + c2.real, c1.imaginary + c2.imaginary);
   } 
```

# xcode - 使用 git 从一个分支变基到另一个分支时出现意外错误，在此过程中似乎修改了某些文件

> ID：15116459
> 
> 赞同：0
> 
> 时间：2013-02-27T15:53:47.953
> 
> 标签：xcode, macos, git, rebase

尝试将 git 分支重新建立在另一个分支上时出现意外错误。给定两个 git 分支 A 和 B，以及 base_commit 历史中这两个分支的共同提交。

例如，A 在 base_commit 之前 2 次提交，B 在 base_commit 之前 3 次提交（这些值并不重要，只是说两个分支是“关闭的”）。

当我尝试在 B 上重新设置 A 时，它有时会附加一个错误：

```
error: Your local changes to the following files would be overwritten by merge:
[...]
Please, commit your changes or stash them before you can merge.
Aborting
Failed to merge in the changes.
Patch failed at 0004 Passage de ZIM sous forme d'une bibliothèque

When you have resolved this problem run "git rebase --continue".
If you would prefer to skip this patch, instead run "git rebase --skip".
To check out the original branch and stop rebasing run "git rebase --abort". 
```

但是索引没有变化（git status 什么也没给出）

一个解决方案是中止并重试，有时它会起作用。执行 git gc 会有所帮助，但并非总是如此……

我在 MacOS X 上，代码是用 XCode 制作的，我没有防病毒软件，即使 XCode 和 SourceTree 都结束了，也会出现问题。

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:39:05.273

假设分支`A`和`B`，站在`A`，文件`f`被修改（而不是签入`A`），同时`B`包含另一个版本。如果我尝试重新定位`B`到`A`，则本地更改`f`将丢失。解决方案：将更改提交到`f`，或将它们藏起来以备后用，或者可能通过 丢弃它们`git checkout f`。

简而言之，这就是消息所说的。

如果您“再次尝试直到成功”，您可能会丢失上述更改。

**故事的寓意：**如果你想做任何更复杂的操作`git`（比如从上游拉，变基，改变最后一次提交，......）*确保*一切都是整洁的。即，`git status`说它很干净，希望没有未跟踪的文件。

# bash - 使用 grep 一次搜索两个表达式

> ID：15116460
> 
> 赞同：35
> 
> 时间：2013-02-27T15:53:52.597
> 
> 标签：bash, grep

这是基本的，但我无法用谷歌搜索它。我可以在调用 grep 时使用吗

```
grep expr1 | grep expr2 
```

以便它打印包括 expr1 和 expr2 的行？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2014-05-09T17:51:49.727

您可以提供多个表达式以使用多个[-e 标志](https://www.gnu.org/software/grep/manual/grep.html#Matching-Control)进行搜索。另见[这篇文章](http://liquidat.wordpress.com/2008/10/08/short-tip-grep-with-more-than-one-expression/)。

IE

> grep -e expr1 -e expr2

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-02-27T15:57:49.910

尝试这个：

`grep 'expr1.*expr2\|expr2.*expr1'`

如果您知道“expr2”总是在“expr1”之后，这比它需要的要复杂一些。在这种情况下，您可以将其简化为：

`grep 'expr1.*expr2'`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-27T15:57:11.860

你所拥有的应该工作。

以下是实现相同效果的另一种方法：

```
grep -E 'expr1.*expr2|expr2.*expr1' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-07T12:18:07.417

实际上，如果您想获得包含两个表达式的行，您自己的建议几乎是正确的。利用：

```
grep expr1 somefile | grep expr2 
```

# vxml - 如何在 VXML 中动态设置 bargein 属性？

> ID：15116464
> 
> 赞同：2
> 
> 时间：2013-02-27T15:53:59.590
> 
> 标签：vxml, voicexml

如何在 VoiceXML 中动态设置提示的 bargein 属性？

根据流程早期提示的结果，我们希望稍后允许或禁止闯入。如果这有影响，我们将在 Voxeo 托管。

这有效：

```
<prompt bargein="false"> 
```

这不起作用：

```
<assign name="allowBarge" expr="false" />
...
<prompt bargein="allowBarge" > 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:19:48.277

您可以在提示中使用 cond 表达式并复制提示，一次打开 bargein，一次关闭它。像这样的东西。

```
<assign name="allowBarge" expr="false"/>
...
<prompt cond="allowBarge == true" bargein="true" >
Say something
</prompt>

<prompt cond="allowBarge == false" bargein="false" >
Say something
</prompt> 
```

在此示例中，bargein 将被关闭，因为 allowBarge 设置为 false。

这将是处理静态 VoiceXML 的一种方法。另一种选择是动态创建 VoiceXML 并根据查询字符串中传递的参数设置 bargein。

# android - AsyncTask/Thread 和 networkonmainthreadexception 的问题

> ID：15116467
> 
> 赞同：0
> 
> 时间：2013-02-27T15:54:22.907
> 
> 标签：android, sockets, android-asynctask

大家好，
我想为我的 Android 制作一个聊天客户端。但我就是无法获得任何联系。
好吧，也许你可以帮我一点..
在我的 MainActivity.java 我打电话：

```
//connect to the server
SocketTask connection = new SocketTask(this); 
connection.execute(); 
```

我的 SocketTask.java 如下所示：

```
package chat.client;

import java.io.DataInputStream;
import java.io.IOException;
import java.io.PrintStream;
import java.net.Socket;

import android.os.AsyncTask;

public class SocketTask extends AsyncTask<Void, Void, Void>{
    private Socket socket;
    private DataInputStream input;
    protected PrintStream output;
    private MainActivity main;
    private Thread thrd;

    public SocketTask(MainActivity main){
        this.main = main;
    }

    @Override
    protected Void doInBackground(Void... params) {
        try {
            socket = new Socket("192.168.178.23", 1338);
            input = new DataInputStream(socket.getInputStream());
            output = new PrintStream(socket.getOutputStream());

            // submittes the name of the client
            output.println("Mobile");
            output.flush();
            thrd = new Thread(new Runnable() {
                public void run() {
                    while (!Thread.interrupted()) {
                        try {
                            final String data = input.readLine();
                            if (data != null)
                                main.runOnUiThread(new Runnable() {
                                    //new Runnable(){
                                    @Override
                                    public void run() {
                                        if(!data.equals("")){
                                            //main.chatHistory.append(data+"\n");
                                            main.addText(data);
                                        }else{
                                            //chatHistory.append("\n");
                                            main.addText("");
                                        }

                                    }
                                });
                            //};
                        } catch (IOException e) {
                            //chatHistory.append("Verbindung zum Server abgebrochen!");
                            main.addText("Verbindung zum Server abgebrochen!");
                        }
                    }
                }
            });
            thrd.start();
        } catch (Exception e) {
            //chatHistory.append("Es konnte keine Verbindung zum Server aufgebaut werden!");
            main.addText("Es konnte keine Verbindung zum Server aufgebaut werden!"+e);
        }
        return null;
    }
} 
```

但是当我启动它时，我只得到：
02-27 16:32:05.875: E/SensorManager(26146): thread start

此外，当我尝试调用“connection.doInBackground()”而不是“connection.execute()”时（我知道这根本没有任何意义），我得到一个“networkonmainthreadexception” - 但我想我'已经用 AsyncTask 解决了这个问题。好吧，我是 Android 新手，但我已经用谷歌搜索了很多，不知道我是不是那么愚蠢，但现在我放弃了，所以我在这里注册了我。也许你们中的某个人可以告诉我，我做错了什么..

（不确定我是否需要发布我的 MainActivity 类..）
谢谢！:)

编辑：谢谢大家的所有这些答案，知道我有点过分了，给我一些时间来尝试/理解你所有的提示，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:24:58.100

在 AsyncTask 的实现上有很多概念性错误，甚至很难弄清楚为什么会出错，所以我将在这里写一个关于如何编写 AsyncTask 的秘诀和感觉提示然后应用它们，如果仍然出现错误，请再次询问：

**尖端：**

*   不要在 AsyncTask 中创建新线程，doInBackground() 已经在后台线程中被调用
*   不要在 AsyncTask 上调用 runOnUiThread，在 UI 线程上已经调用了 onPostExecute()
*   如果您的活动暂停（调用 onPause()）在您的 AsyncTask 上调用 .pause() ，否则您可能会有一些`NullPointerException`
*   不要`doInBackground()`按照您的建议直接调用，该`execute()`调用将创建一个新线程并为您调用它（这就是 AsyncTask 的用途）
*   不要持有活动对象或任何其他持有 AsyncTask 上下文的对象。只需将 AsyncTask 类声明放在 Activity 本身中，出于组织目的，让 doInbackground() 调用不同类中的一个方法进行实际处理。这样，您的 onPostExecute 可以调用 UI 来更新它，但您将数据收集/处理与活动分开

**食谱：**

```
// put this class inside your Activity and
// just call a separate class (for organisation),
// or just put the code all in there (for no organisation)
private class SocketTask extends AsyncTask<Void, Void, String> {

@Override
protected String doInBackground(Void... params) {
    // Whatever you do inside here
    // DO NOT create a new thread!
    return APIConnection.callAPI();
}

@Override
protected void onPostExecute(String result) {
    if(result!=null){
    //Update your UI here
    }else{
    // Some error happen?
    }
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:07:50.563

您是否在清单中添加了所需的权限？

```
<uses-permission android:name="android.permission.INTERNET"></uses-permission> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:14:40.587

您正在尝试与您一起工作，`MainActivity`这`doInBackground()`需要在线程`onPostExecute()`上运行的方法中，而该方法没有。`UI``doInBackground()`

[异步任务](http://developer.android.com/reference/android/os/AsyncTask.html)

> 4个步骤
> 
> 当一个异步任务被执行时，任务会经过 4 个步骤：
> 
> onPreExecute()，在任务执行之前在 UI 线程上调用。此步骤通常用于设置任务，例如通过在用户界面中显示进度条。
> 
> doInBackground(Params...)，在 onPreExecute() 完成执行后立即在后台线程上调用。此步骤用于执行可能需要很长时间的后台计算。异步任务的参数传递到这一步。计算的结果必须由这一步返回，并将传递回最后一步。此步骤还可以使用 publishProgress(Progress...) 来发布一个或多个进度单位。这些值在 UI 线程上的 onProgressUpdate(Progress...) 步骤中发布。
> 
> onProgressUpdate(Progress...)，在调用 publishProgress(Progress...) 后在 UI 线程上调用。执行的时间是不确定的。此方法用于在后台计算仍在执行时在用户界面中显示任何形式的进度。例如，它可用于动画进度条或在文本字段中显示日志。
> 
> onPostExecute(Result)，在后台计算完成后在 UI 线程上调用。后台计算的结果作为参数传递给该步骤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T16:16:19.093

`AsynTask`如果您需要在主线程（即 UI）上运行某些东西，而不是尝试以您的方式在主线程上运行某些东西，您将调用`publishProgess()`from `doInBackground(...)`，而后者又调用`onProgressUpdate(...)`. 不要`doInBackground`直接调用，`execute()`是正确的启动方式`AsyncTask`。当`doInBackground()`返回时，`onPostExecute()`将在主线程上自动调用。

上的[Android 文档`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)非常好，并且有一个很好的使用示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T16:18:01.390

异常表示您需要在后台线程上运行网络操作。直接调用 doInBackground() 只会使所有内容都在调用的同一线程中运行，显然是主线程。所以，你必须用`connection.excute()`. 但是，您不能从后台线程更新 UI 元素。要在主线程上执行此操作，您需要`onProgressUpdate()`像这样为您的 AsyncTask 实现：

```
 @Override
    protected void onProgressUpdate(String... arg) {            
        main.addText(arg[0]);
    } 
```

`addText()`现在，将in的所有调用替换`doInBackground()`为`publishProgress("whatever");`. 不要忘记将异步任务声明更改为`AsyncTask<Void, String, Void>`. 完成上述所有操作后，您无需在其中生成另一个线程`doInBackground()`，它无论如何都会在后台线程中执行。虽然，您当前的代码所做的大致相同，但这将解决混乱（不再是`thrd = new Thread(new Runnable() {...`and `main.runOnUiThread...`）并可能解决您的问题。

# c# - 使用剃刀在javascript中调用带有参数的C#代码方法

> ID：15116469
> 
> 赞同：2
> 
> 时间：2013-02-27T15:54:26.053
> 
> 标签：c#, javascript, asp.net-mvc-3, razor

我正在尝试在我的 javascript 代码中调用 C# 方法，并尝试使用剃刀语法将参数传递给它，但无法正确执行。下面是我的代码：

```
function RecallNoFmatter(cellvalue) {
    var value = @(Precall.S300FormatRecall(+cellvalue+));
    return value;

} 
```

我收到此错误消息：

编译器错误消息：CS0103：当前上下文中不存在名称“cellvalue”。

有人可以告诉我如何在上面传递参数的正确语法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T15:56:07.577

C# 在服务器端运行。`@`代码在脚本交付给客户端之前在服务器端运行，并且无法访问 JavaScript 值。

您的 JavaScript 在客户端运行，无法调用服务器端方法。

如果您想向客户端公开服务器端功能，您将不得不使用 AJAX 并提供一些服务供客户端调用。

# python - 未知的密码散列算法。PASSWORD_HASHERS 设置 - 使用工厂男孩

> ID：15116483
> 
> 赞同：2
> 
> 时间：2013-02-27T15:55:12.893
> 
> 标签：python, django, unit-testing, factory-boy

如果我为测试创建示例用户帐户，则会出现此错误：

> 未知密码散列算法“password1”。您是否在 PASSWORD_HASHERS 设置中指定了它？

```
class ExampleTest(TestCase):
    def test_sample_data(self):
        for i in range(0,1):
            user = content.factories.UserFactory.create() 
```

工厂.py：

```
class UserFactory(factory.Factory):
    FACTORY_FOR = User

    username = factory.Sequence(lambda n: 'User' + n)
    email = 'mail@gmail.com'
    password = 'password1' 
```

如何解决？

编辑：

**解决方案：**

```
user = content.factories.UserFactory.create()
user.set_password('yourpassword')
user.save() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-20T05:05:26.300

**更新。**它在[文档](https://factoryboy.readthedocs.org/en/latest/reference.html?highlight=password#postgenerationmethodcall)中有所描述，您应该使用`factory.PostGenerationMethodCall`：

```
class UserFactory(factory.Factory):
    class Meta:
        model = User

    username = 'user'
    password = factory.PostGenerationMethodCall('set_password',
                                                'defaultpassword') 
```

**旧答案**。实际上，这在[factory-boy 文档](https://github.com/dnerdy/factory_boy#customizing-creation)中有所描述：

```
class UserFactory(factory.Factory):
    @classmethod
    def _prepare(cls, create, **kwargs):
        password = kwargs.pop('password', None)
        user = super(UserFactory, cls)._prepare(create, **kwargs)
        if password:
            user.set_password(password)
            if create:
                user.save()
        return user 
```

最好使用这个解决方案，这样你就可以正确使用`UserFactory.build()`,`UserFactory.create()`和`UserFactory.attributes()`（稍后会返回未哈希的密码）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-20T10:12:01.110

```
class UserFactory(factory.Factory):
    FACTORY_FOR = User

    username = 'user'
    password = factory.PostGenerationMethodCall('set_password',
                                            'defaultpassword') 
```

请参阅此处的文档[https://factoryboy.readthedocs.org/en/v1.3.0/reference.html#postgenerationmethodcall](https://factoryboy.readthedocs.org/en/v1.3.0/reference.html#postgenerationmethodcall)

# jquery - jQuery插件和变量作用域

> ID：15116486
> 
> 赞同：0
> 
> 时间：2013-02-27T15:55:23.630
> 
> 标签：jquery, jquery-plugins

我开发了一个简单的插件，允许您为文本框创建多列下拉菜单。您传入一个 Web 服务 URL，以及一个 jQuery 选择器数组，这些选择器对应于您希望从结果集中的每一列中填充的每个元素。

$('#txtProduct').multiColumnDropDown({ 'url': '/api/GetProductAndCategoryByRegion', 'targets' : ['#txtProduct', "#txtCategory"] });

这将构建一个多列下拉列表，当用户单击其中的记录时，#txtProduct 和 #txtCategory 将被填充。

一切正常，但我希望能够将多个 multiColumnDropDowns 应用到我的页面。我将遇到问题，因为我不知道如何引用特定于插件实例的动态生成的下拉标记。

在我的插件中，我为下拉列表生成一个包装器并将其放置在需要的位置。如果我想通过重新查询来更新包装器及其下拉列表，我如何确保我只更新我想要的，而不是我生成的所有包装器？

完整代码如下：

```
(function ($) {
var methods = {
    init: function (options) {
        return this.each(function () {
            var settings = $.extend({
                'targets': [this]
            }, options);

            var targets = settings["targets"];

            var yOffset = $(this).position().top + $(this).height() + 'px';
            var xOffset = $(this).position().left + 'px';

            var wrapper = $('<div class="dropdown-wrapper"></div>')
                .css('top', yOffset)
                .css('left', xOffset)
                .hide();

            $(document).click(function () {
                wrapper.hide();
            })

            if (settings["url"] != undefined && settings["url"] != '') {
                methods.populateDropDown(settings["url"], targets, wrapper);
            }

            $(this).click(function (e) {
                e.stopPropagation();
                wrapper.show();
            });
        });
    },
    update: function (options) {
        return this.each(function () {
            var settings = $.extend({
                'targets': [this]
            }, options);

            var targets = settings["targets"];

            //How do I reference the correct wrapper?
            //The following will reference all wrappers on the page :\
            var wrapper = $('div.dropdown-wrapper')

            //Repopulate the wrapper and dropdown code goes here....
        })
    },
    populateDropDown: function (url, targets, wrapper) {
        $.ajax({
            url: url,
            type: 'get',
            dataType: 'json'
        })
        .done(function (data) {
            var $table = $('<table class="multi-column-table">');
            data.forEach(function (item) {
                var $tr = $('<tr>').appendTo($table);
                var idx = 0;
                $.each(item, function (k, v) {
                    var $td = $('<td>');
                    if (targets[idx] != undefined)
                        $td.attr('data-target', targets[idx]);
                    $td.text(v);
                    $td.appendTo($tr);
                    idx++;
                });
            });
            $table.on('click', 'tr', function () {
                $.each(this.children, function (i, td) {
                    if ($(td).attr('data-target'))
                        $($(td).attr('data-target')).val($(td).text());
                });
            });
            $(wrapper).append($table).prependTo('body');

        })
        .fail(function (jqXHR, textStatus, errorThrown) {
            alert('Error: ' + errorThrown);
        });
    }
};

$.fn.multiColumnDropDown = function (method) {
    if (methods[method]) {
        return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
    } else if (typeof method === 'object' || !method) {
        return methods.init.apply(this, arguments);
    } else {
        $.error('Method ' + method + ' does not exist on jQuery.multiColumnDropDown');
    }
}; 
```

})(jQuery);

如果有人对 CSS 感兴趣：

```
.dropdown-wrapper
{
border:1px solid #000;
border-bottom-right-radius:3px;
border-bottom-left-radius:3px;
z-index:100;
background-color:#fff;
position:absolute;
}

.dropdown-wrapper tr:hover
{
background-color:#0081C2;
color:#fff;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:01:51.867

您可以参考本指南 Jquery Plugin Authoring ( [http://docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring) )

基本上，您需要将插件的实例存储到 html 控件的 data 属性中。检查下面的代码

```
 var $this = $(this),
         data = $this.data('tooltip'),
         tooltip = $('<div />', {
           text : $this.attr('title')
         });

     // If the plugin hasn't been initialized yet
     if ( ! data ) {

       /*
         Do more setup stuff here
       */

       $(this).data('tooltip', {
           target : $this,
           tooltip : tooltip
       }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:02:29.483

`var wrapper = $('div.dropdown-wrapper')`就像您注意到的那样，在该`update`方法中引用了页面上的所有包装器，因为您正在选择`dropdown-wrapper`该类的所有 div。

要引用在该实例中创建的包装器，您必须将在`init`函数中创建的包装器存储在某处。为此，您可以在插件上下文中使用[data方法。](http://docs.jquery.com/Plugins/Authoring#Data)

# regex - 从 Perforce 提交的变更列表中获取特定信息

> ID：15116492
> 
> 赞同：0
> 
> 时间：2013-02-27T15:55:34.540
> 
> 标签：regex, perforce

我想从 Perforce 获取有关提交的更改列表的具体信息：

所以我的目标是获取提交的文件和发布描述：

我将从这样的事情开始：

```
p4 changes -m //depot/main/path/...@2013/02/20,@now 
```

这将给我更改列表编号、日期、提交的用户、更改列表描述。

但是，我可以使用什么正则表达式来包含或仅获取发行说明以及包含在此更改列表中的文件？

任何想法都非常感谢......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T09:40:57.683

鉴于您使用的是 Unix，最简单的方法是：

```
p4 changes //depot/main/path/...@2013/02/20,@now | awk '{print $2}' | xargs p4 describe -s 
```

您示例中的`-m`标志需要一个参数（您希望看到的最大更改数）。

# c# - 删除引用后，以前引用的 DLL 仍包含在构建输出中

> ID：15116497
> 
> 赞同：3
> 
> 时间：2013-02-27T15:55:49.783
> 
> 标签：c#, .net, visual-studio, build

我正在使用 Visual Studio 2010 并处理其他人创建的项目。这个项目引用了几个 DLL（直接引用 DLL），由于一些重大的设计更改，我不再需要其中的许多。我已经从我的项目中删除了引用，但是在构建我的项目时，不需要的 DLL 仍然被放入构建输出中，并且它们作为检测到的依赖项包含在我创建的新安装项目中。

为什么当我删除了对 DLL 的引用时，它仍然会被检测为依赖项并包含在构建中？代码中没有引用任何这些 DLL，我已经确定了这一点。我还在文本编辑器中打开了 csproj 文件，但没有看到任何引用这些 DLL 的东西，这些 DLL 仍然出现在构建中，那么给出了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T20:50:01.713

您正在构建的项目可能会传递地依赖于该程序集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:59:00.060

使用 Build > Clean Solution 或 Rebuild Solution，它可能会消失。

简单地构建解决方案时不会清理输出文件夹，因此在您发出上述任一命令之前，所有旧文件都会保留在那里。

# python - 是否可以在 Mayavi 中使用鼠标禁止轴旋转？

> ID：15116508
> 
> 赞同：2
> 
> 时间：2013-02-27T15:56:07.563
> 
> 标签：python, mayavi

我正在使用 Mayavi 创建一个 2-D 绘图，以便利用一些渲染功能。由于它是一个 2-D (x,y) 图，放置在 3-D 空间中，我想限制鼠标与图的交互，这样图就不能用鼠标旋转，只能缩放或平移。这可能吗？

[这里](https://stackoverflow.com/questions/14225512/constrain-mayavi-mouse-drag-to-rotating-earth-around-its-axis)有一个类似的问题，但还没有回答。那里的代码也适用于我的案例，即使它是 3-D。

问候，

-标记

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T20:12:27.940

通过 Gael Varoquaux： [http ://docs.enthought.com/mayavi/mayavi/tips.html#chang-the-interaction-with-a-scene](http://docs.enthought.com/mayavi/mayavi/tips.html#changing-the-interaction-with-a-scene)

```
figure.scene.interactor.interactor_style =  tvtk.InteractorStyleImage() 
```

# html - 为什么使用某个 @font-face 会导致涉及 CSS3 和 jQuery 转换的文本在 mac 上的 webkit 浏览器中不可见？

> ID：15116510
> 
> 赞同：0
> 
> 时间：2013-02-27T15:56:08.143
> 
> 标签：html, css, macos, webkit, font-face

我正在为我正在开发的网站使用@font-face 字体，由于某种原因，当我使用 AvenirLight 而不是 Avenir 作为正文字体时，它使文本仅与 CSS3 和 JavaScript 转换相关联（不透明度：0 到 1）仅在 Mac webkit 浏览器上不可见。

我仍然不知道为什么会发生这种情况，以及为什么它只发生在 Mac 上的 webkit 浏览器中。

让我们尝试解决这个问题！

这是当前存在问题的地方（当您将鼠标悬停在两个产品图像上时，产品名称应该可见）：

[https://fine-grain-2.myshopify.com/](https://fine-grain-2.myshopify.com/)

这是我的@font-face 声明：

```
@font-face {
    font-family: Avenir;
    font-weight: normal;
    font-style: normal;
    src: url("AvenirLTStd-Medium.otf") format("opentype");
}

@font-face {
    font-family: AvenirBold;
    font-weight: normal;
    font-style: normal;
    src: url("AvenirLTStd-Black.otf") format("opentype");
}

@font-face {
    font-family: AvenirLight;
    font-weight: normal;
    font-style: normal;
    src: url("AvenirLTStd-Light.otf") format("opentype");
} 
```

这是我声明使文本消失的正文字体系列的地方：

```
body {
    background: none repeat scroll 0 0 #999999;
    font-family: AvenirLight;
    font-weight: normal;
} 
```

如果我将其切换到此，文本将再次可见，但我真的很想使用 AvenirLight vs Avenir：

```
 body {
        background: none repeat scroll 0 0 #999999;
        font-family: AvenirLight;
        font-weight: normal;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T00:26:15.723

对于每个字体声明，使用相同的字体系列名称 - 在你的情况下，Avenir - 设置你的字体声明，如下所示。你最好使用 woffs 有两个原因——一个是你可以用一个好的转换器将你的 woffs 降低到大约 20k，每个都可以浏览你的页面加载，另一个是随时使用工作站字体——它可能会给你一种“错误”的印象您的字体在实际上不工作时正在工作 - （想想上次您将文档发送到打印机并且它回来看起来不像预期的那样，即通过打印服务器发送，不支持字体）另外，由于整个版权问题pre IE9，见：[http ://caniuse.com/#search=woff](http://caniuse.com/#search=woff)- IE 确实是您需要计划支持的一个 - 对于跨浏览器支持，请使用 eot 文件。如果您希望获得移动 android、apple 3g 的字体回退，请使用可以删除尽可能多的字形的 fontkit 服务（例如 fontsquirrel） - 但是请注意，有许多专业字体被列入黑名单。在哪里制造，甚至是你获得合法的、功能性的工作站许可证服务都不允许使用带有字体的服务（使得围绕 ttf/otf 进行规划非常困难）。

回顾： 1\. 字体系列保持不变 2\. 样式和重量变化的属性 3\. 在您的工具包中使用 woffs 和 eots 或 (ttf/otf) 4\. 如果您关心更多的 IE 支持而不是手机 - 包括 eots 和 ( 1) otf 用于 android, os 4.0 的后备方案；反向 *5。如果使用 sans-serif - 不要忘记 'sans' 中的 's' （错别字），您的页面将在 Chrome 中呈现正常，但在 IE 中不会呈现，它会让您发疯 *6。如果使用特殊的 google 字体样式（例如 &effect=destruction），请先阅读文档，以便知道谁可以看到 *7。总是，总是获得适当的许可文件，特别是对于商业网站！不要假设您的字体来自可靠来源，从而使自己处于妥协的位置！如果它不是开放许可证，并且您没有它的副本，您可能要承担责任。

```
/* font sytles
-------------------------------- */
@font-face { 
    font-family: "Avenir"; 
    src: url("your-bold-file") format("woff"); 
    font-style: normal; 
    font-weight: bold; 
}
@font-face {
    font-family: "Avenir";
    src: url("your-bolditalic-file") format("woff");
    font-style: italic;
    font-weight: bold;
}
@font-face {
    font-family: "Avenir";
    src: url("your-italic-file") format("woff"); 
    font-style: italic; 
    font-weight: normal; 
}
@font-face {
    font-family: "Avenir";
    src: url("your-normal-file") format("woff");
    font-style: normal;
    font-weight: normal;
}

body { /* universal body style attributes */
    margin: 0; /* reset body margins */
    font-family: "Avenir", sans-serif; /* whatever your font family is of */
    font-size: 100%; /* universal font size across all browsers */
} 
```

顺便说一句，只要属性出现，新字体就会接管，您可以通过调用选择器来切换字体。如果您想坚持使用字体并赋予权重，即 - p>.class {font-weight:700; /* 不切换字体 */} - 仅添加 woffs 作为示例，你可以放任何你想要的

从那里你的主题正在做一些你的插件在移动端没有设计做的事情。基本上你需要找到一种方法来打破固定的约束，否则你唯一的选择就是在给定的视口内工作。（例如，如果您将固定位置设置为相对位置，您会看到您的手机可以滚动，但没有幻灯片）

您可能想联系主题支持或 Galleria.io 寻求帮助。

```
 </article><!-- product-details -->

    <div id="galleria"><div style="width: 100%; height: 100%;" class="galleria-container notouch fullscreen"><div class="galleria-stage"><div style="position: relative; top: 0px; left: 0px; width: 100%; height: 100%;" class="galleria-images"><div style="overflow: hidden; position: absolute; top: 0px; left: 0px; transition: none 0s ease 0s ; opacity: 0; z-index: 0;" class="galleria-image"><div style="position: absolute; top: 0px; left: 0px; right: 0px; bottom: 0px; z-index: 2;" class="galleria-layer"></div></div><div style="overflow: hidden; position: absolute; top: 0px; left: 0px; opacity: 1; width: 1349px; height: 638px; transition: none 0s ease 0s ; z-index: 1;" class="galleria-image"><div style="position: absolute; top: 0px; left: 0px; right: 0px; bottom: 0px; z-index: 2; display: none;" class="galleria-layer"></div><img src="MG_9400_1024x1024.jpg" style="display: block; opacity: 1; min-width: 0px; min-height: 0px; max-width: none; max-height: none; width: 1349px; height: 898px; position: absolute; top: -130px; left: 0px;" height="898" width="1349"></div></div><div style="opacity: 1; display: none;" class="galleria-loader"></div><div style="opacity: 1;" class="galleria-counter"><span class="galleria-current">1</span> / <span class="galleria-total">10</span></div><div class="galleria-image-nav"><div style="opacity: 0.5; display: block;" class="galleria-image-nav-right"></div><div style="opacity: 0.5; display: block;" class="galleria-image-nav-left"></div></div></div><div style="top: 562px; opacity: 1;" class="galleria-thumbnails-container"><div class="galleria-thumb-nav-left disabled"></div><div style="overflow: hidden; position: relative;" class="galleria-thumbnails-list"><div style="overflow: hidden; position: relative; width: 180px; height: 10px; left: 0px;" class="galleria-thumbnails"><div class="galleria-image active"><span style="opacity: 1;" class="img"></span></div><div class="galleria-image"><span style="opacity: 1;" class="img"></span></div><div class="galleria-image"><span style="opacity: 1;" class="img"></span></div><div class="galleria-image"><span style="opacity: 1;" class="img"></span></div><div class="galleria-image"><span style="opacity: 1;" class="img"></span></div><div class="galleria-image"><span style="opacity: 1;" class="img"></span></div><div class="galleria-image"><span style="opacity: 1;" class="img"></span></div><div class="galleria-image"><span style="opacity: 1;" class="img"></span></div><div class="galleria-image"><span style="opacity: 1;" class="img"></span></div><div class="galleria-image"><span style="opacity: 1;" class="img"></span></div></div></div><div class="galleria-thumb-nav-right disabled"></div><div style="visibility: hidden;" class="galleria-thumbnails-tab"></div></div><div style="position: absolute; left: -10000px; display: block; opacity: 1;" class="galleria-info"><div style="width: 1309px;" class="galleria-info-text"><div style="display: none;" class="galleria-info-title"></div><div class="galleria-info-description">BOWDEN</div></div></div><div style="opacity: 0;" class="galleria-tooltip"></div></div></div><!-- galleria --> 
```

如果发现有帮助，请投票，因为我是这个社区的新手，并且由于 2 个帖子限制而无法贡献。谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T16:27:55.780

我注意到您正在使用带有`font-weight: 600`粗体的“AvenirLight”，并且同时使用浅色字体 + 粗体可能无法与 Mac webkit 浏览器正确兼容/实现。尝试`font-weight`先正常测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T16:55:29.917

环顾四周，一件事跳了出来：

```
@font-face {
font-family: AvenirBold;
font-weight: normal;
font-style: normal;
src: url("AvenirLTStd-Black.otf") format("opentype");
}

@font-face {
font-family: AvenirLight;
font-weight: normal;
font-style: normal;
src: url("12-Avenir-Light.ttf") format("opentype");
} 
```

您已经列出了格式为“opentype”（otf）的 TrueType 字体（.ttf）。我无法在 Chrome 的开发工具中找到远程更改它的方法，以查看是否可以修复它，但这看起来是一个合理的原因。

ttf 文件是 truetype 格式：

```
src: url("12-Avenir-Light.ttf") format("truetype"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T06:45:22.347

我很好奇你是否知道为什么嵌入的字体看起来很粗体。我之前遇到过这个问题，并没有意识到是什么原因造成的。

我会尝试通过 Font Squirrel 运行您的字体，以确保您嵌入了所有正确的字体格式（eot、ttf、otf、woff、svg），以便您的网站是跨浏览器友好的。您可能已经这样做了，但在您的代码中我刚刚看到了 ttf/otf。

[http://www.fontsquirrel.com/tools/webfont-generator](http://www.fontsquirrel.com/tools/webfont-generator)

# vba - 上周一的日期 Excel

> ID：15116513
> 
> 赞同：4
> 
> 时间：2013-02-27T15:56:12.700
> 
> 标签：vba, excel, excel-formula, excel-2010

今天是 2013 年 2 月 27 日，也就是星期三。我需要公式，它将返回上一个星期一的日期。这将是 (02/17/2013)

我需要这样才能在发送电子邮件的 vba 代码中使用文件名或电子邮件主题。

```
With oMail
     'Uncomment the line below to hard code a recipient
     .To = "myemail@email.com"
     'Uncomment the line below to hard code a subject
     .Subject = "Current Report"
     .Attachments.Add WB.FullName
    .Display
End With 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-27T16:16:15.323

```
Public Function LastMonday(pdat As Date) As Date
    LastMonday = DateAdd("ww", -1, pdat - (Weekday(pdat, vbMonday) - 1))
End Function 
```

Weekday(yourdate, vbMonday) 返回 1 表示周一，2 表示周二，等等。所以

```
pdat - (Weekday(pdat, vbMonday) - 1) 
```

通过从过去的日期中减去 Weekday()-1 # 天数，将为我们提供最近的星期一。

```
DateAdd("ww", -1, ...) 
```

从该日期减去一周。

```
LastMonday(cdate("2/27/13")) 
```

返回 2/18/2013（星期一，不是 17 号）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T16:07:04.483

计算 Weekday(Now()) 和 2（= 星期一的工作日）之间的差，然后加上 7。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T16:38:09.453

丹的答案应该涵盖您在 VBA 中的需求

或在 Excel 工作表公式中，您可以执行以下操作：

```
 =TEXT(DateCell- (WEEKDAY(DateCell,2)-1),"dddd mmmm dd") 
```

所以 DateCell 是一个包含您要查找上周一日期的日期的范围！

因此，如果您将 08/04/2012 放入 DateCell，那么该公式将在 4 月 2 日星期一重新运行！

（归功于 MrExcel.com 和 Google 搜索！）HTH Philip

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-11T12:41:23.380

为了使接受的答案的功能更加通用，一些小的更改可以让您指定一周中的哪一天，以及您想要它向后/向前多远。

```
Public Function LastDow(pdat As Date, dow as integer, _&
                optional weeksOffset = -1 as integer) As Date
    LastDow = DateAdd("ww", weeksOffset, pdat - (Weekday(pdat, dow) - 1))
End Function 
```

有了这个函数，你可以得到，比如说，下周三：

```
dim myDt as date
dim nextWed as date
myDt = now()
// Get next Wednesday (dow = Wednesday, weeksOffset is +1
x = LastDow(myDt, vbWednesday, 1) 
```

再次感谢原始解决方案作者（Dan Meltheus）。

# windows - 使用许多特殊参数在 .bat 中执行多个命令

> ID：15116516
> 
> 赞同：1
> 
> 时间：2013-02-27T15:56:18.277
> 
> 标签：windows, batch-file, cmd

它很简单 - 我想从上到下一个接一个地执行一个命令。

这可能听起来很疯狂，但我想使用很多参数，例如

```
PUSHD %~dp0

wkhtmltopdf.exe --no-stop-slow-scripts --debug-javascript --javascript-delay 15000 --images --print-media-type "http://ridiculous.lo/ng?url=with&strange=%parameters&including=every%20special%20character%25youCanImagine" filename.pdf

wget -m --recursive --page-requisites --html-extension --convert-links --restrict-file-names=windows --no-parent http://ridiculous.lo/ng?url=with&strange=%parameters&including=every%20special%20character%25youCanImagine"

POPD %~dp0 
```

只是。当“手动”输入 cmd.exe 时，命令运行良好。

什么是最好的方法？我真的需要彻底更换参数吗？

START 和 CMD 需要对字符串等进行非常烦人的处理。

请让我开心。

更新请求。通过评论

某种真正的命令：

```
wkhtmltopdf.exe --no-stop-slow-scripts --debug-javascript --javascript-delay 15000 --images --print-media-type "http://someServer:1337/php/rework/autogen.php?step=AggregationController&AggregationType=PG&PG_textBox=&PG%5B%5D=S2-1113F&ID_textBox=&AGG_textBox=&CHA_textBox=&RO_textBox=&TECH_textBox=&TO_textBox=&RR_textBox=&CRITIC__textBox=&LE_textBox=&MODULE__textBox=&preselect=x&view=default&HistoryFilter=%25SH32%25&latestWorkWeek=2013_WW08&view=cuNoAjax&pageBreakOverview=70" nameOfPDF.pdf 
```

请注意，网址在浏览器中工作正常 - 到目前为止感谢所有人

### 在 rojo 的评论中找到答案：

只需替换`%`为即可`%%`！（尝试了更多）。

谢谢大家的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:03:02.783

请记住，在您编写批处理脚本之前，该脚本会执行所有疯狂的操作来设置您的路径。浏览到您想要到达的路径，修改路径中的开始，或者只是简单地执行 cd\ cd.. 或任何需要到达您需要的路径的方法。在要调试的内容之后暂停一下，看看发生了什么（可能会很快）。还可以使用您的回声来查看 CMD 窗口的内容。

请记住，您还可以执行 cmd /c 来运行命令。还要确保您的批处理文件和会话具有适当的管理凭据。如果需要，您可能必须在提升的用户模式下运行。

如果您也告诉我们您的操作系统在说什么，这将有助于我们为您提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T11:53:18.773

在您列出的示例中，唯一需要做的就是将百分比符号更改为双百分比。所以代替`%5B%5D`你需要`%%5B%%5D`. 其他一切都以应有的方式输出，无需转义。如果将百分比更改为双百分比对您来说不切实际，那么也许您可以对字符进行 URL 解码并使用它们的文字值而不是编码的等价物（例如`[]`，而不是`%%5B%%5D`）。

# c++ - 双打的二叉树/双打C++的比较

> ID：15116518
> 
> 赞同：1
> 
> 时间：2013-02-27T15:56:24.343
> 
> 标签：c++, comparison, double, binary-tree

我正在尝试用双打实现二叉树，但我相信我的双打比较不正确。当我喂它整数时，它可以正常工作；但是，如果我插入带有许多尾随小数位的双精度数，则会出现段错误。

这是我的插入函数的样子：

```
int BinaryTree::insert_node(double val, char *str){;
  return insert_node_helper(this->root, val, str); 
}

int BinaryTree::insert_node_helper(TreeNode *&node, double val, char *str){

  if(node == NULL){
    node = new TreeNode;
    node->val = val;
    node->str = strdup(str);
    node->left = NULL;
    node->right = NULL;
    return 0;
  }else if(val > node->val){ 
    return insert_node_helper(node->right, val, str);
  }else{
    return insert_node_helper(node->left, val, str);
  }

  return 1;
} 
```

树节点定义：

```
struct TreeNode {
   double val;
   char *str;
   TreeNode *left;
   TreeNode *right;
}; 
```

调用代码：

```
void HashTable::chi_squared(){

  int numTokens = numBigrams + 1;
  BinaryTree topBigrams;
  int treeInsertions = 0;

  //indices for confusion matrix
  int o11, o12, o21, o22 = 0;
  int w1, w2, notW1, notW2 = 0;
  double e11, e12, e21, e22 = 0;
  double x2 = 0;

  for(int i = 0; i < size; i++){
    if(table[i] != NULL){
      TokenList *temp = table[i]->tl;
      while(temp != NULL){

    Entry *temp2 = search(temp->str);
    if(temp2 == NULL){
      printf("string (  %s  ) \n", temp->str);
      temp = temp->next;
      continue;
    }

    o11 = temp->occurrences;  //total occurrences of word1 followed by word2
    o21 = table[i]->occurrences - temp->occurrences;  //total occurrences of word1 not followed by word2
    o12 = search(temp->str)->occurrences - temp->occurrences;  //total occurrences of not word1 followed by word2
    o22 = numTokens - o11 - o12 - o21;   //total occurrences of not word1 followed by not word2

    w1 = table[i]->occurrences;
    w2 = search(temp->str)->occurrences;
    notW1 = numTokens - w1;
    notW2 = numTokens - w2;

    e11 = (w1 / (double)numTokens) * (w2 / (double)numTokens) * numTokens;
    e12 = (notW1 / (double)numTokens) * (w2 / (double)numTokens) * numTokens;
    e21 = (w1 / (double)numTokens) * (notW2 / (double)numTokens) * numTokens;
    e22 = (notW1 / (double)numTokens) * (notW2 / (double)numTokens) * numTokens;

    x2 = (pow((o11 - e11), 2) / (double)e11) + 
      (pow((o12 - e12), 2) / (double)e12) +
      (pow((o21 - e21), 2) / (double)e21) +
      (pow((o22 - e22), 2) / (double)e22);

    x2 /= 100;

    if(x2 >= 50){
      if(treeInsertions < 100){
        topBigrams.insert_node(x2, strcat(strcat(temp->str, "  "), table[i]->str));
        treeInsertions++;
      }else if(x2 > topBigrams.find_min()->val){
         topBigrams.replace_min(x2, strcat(strcat(temp->str, "  "), table[i]->str));

    }

    temp = temp->next;
      }
    }
  }

} 
```

x2 通常看起来像： 50.91747014595311071616 但是，如果它是 50 或任何其他整数，插入就可以了。

我将不胜感激任何帮助！

# opencl - OpenCL __constant 与 #define

> ID：15116521
> 
> 赞同：2
> 
> 时间：2013-02-27T15:56:30.677
> 
> 标签：opencl

在我的 OpenCL 内核中，我有很多控制内存分配、循环迭代次数等的常量。使用全局 __constants 或 #defines 更快吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T16:23:02.470

与“普通”C 编译器相同的规则适用于 OpenCL 编译器：A被实际编译*之前*`#define`的值替换，因此它们被烘焙到内核中。

 *根据定义，`__constant`变量在全局内存中分配，并且必须在使用前传输。这比使用`#define`d 文字要慢。但是，NVIDIA 和 AMD 的 GPU 架构会缓存这些值，并且比普通的全局内存读取速度更快。

故事结束和我的个人建议：`#defines`用于常量值以及“神奇”数字和`__constant`内存，用于更大的快速但只读的内存块（例如查找表）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T09:38:01.933

define 的工作方式与 C 中的相同。AMD APP SDK v2.8 之前的所有版本（不支持 OpenCL 1.2）是一个例外。

__Constant 是缓存的内存空间。请阅读有关 OpenCL 中内存布局的更多信息。

__global 是 GPU 的总内存，对所有线程可见。

__local 是 GPU 的本地内存，只有块内的线程可见。

__constant 是缓存内存，它比全局快得多但有限，因此仅在需要时使用它。

__private 是 GPU 的私有内存，仅对每个单独的线程可见。

注意：线程，我的意思是处理元素。*

# c - 在C中进行扫描的while循环

> ID：15116529
> 
> 赞同：1
> 
> 时间：2013-02-27T15:56:53.747
> 
> 标签：c, while-loop, infinite-loop

所以我的问题如下。

```
int n=0;
while(n<=0)
    scanf("%d",&n); 
```

这段代码进入一个无限循环，我不知道为什么。当用户输入一个大于 0 的数字时，循环应该停止。

谢谢:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T15:59:29.620

一遍又一遍，一遍又一遍……

`stdin`（通常）是行缓冲的 - 必须按下`<enter>`才能使终端将字符传输到您的程序。所以现在缓冲区中有一个悬空的换行符，并且`scanf()`会在下一次迭代中尝试读取它，但它不是整数，所以它失败并且不会改变变量的内容。要解决这个问题，`scanf()`请使用换行符：

```
scanf("%d\n", &number); 
```

（哦，是的，`n`也未初始化使用，但似乎您的代码无论如何都进入了循环，所以这不是问题。但请**初始化它**，否则您**将**面临其他奇怪的错误。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:58:14.390

```
while (n <= 0)
    // something 
```

意思是“当值*小于或等于**”**时做某事`n``0`*。只需确保在评估`n`条件时对其进行初始化。`n <= 0`使用未初始化的变量会产生**未定义的行为**。

你应该做：

```
int n = 0;
while (n <= 0)
    scanf("%d\n",&n); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:09:27.703

既然你声称已经尝试过，但它们没有用（尽管我不明白为什么）让我们试试别的。让我们使用程序员最好的朋友：`printf`. 如何尝试运行此代码：

```
int n = 0;

while(n <= 0)
{
    printf("Please enter a number: ");
    scanf("%d\n", &n);
    printf("I see you entered: %d\n", n);
}

printf("Done with the loop. The value of n is: %d\n", n); 
```

这将让您看到计算机正在做什么以及它在读取它们时读取的值。尝试用上面的代码替换你的代码，让我们看看会发生什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T16:18:44.073

我认为你应该改变你的编译器，因为我得到了很好的结果。

你可能在其他地方有问题。

你可以在这里查看：

[http://ideone.com/C4Yobi](http://ideone.com/C4Yobi)

代码：

```
#include<stdio.h>
main( )
{
int n = 0;
while (n <= 0)
    scanf("%d",&n);
printf("%d",n);
}

Input:
-5
4
Output:
4 
```

# magento - Magento - 从订单中发送联系信息

> ID：15116530
> 
> 赞同：0
> 
> 时间：2013-02-27T15:56:58.883
> 
> 标签：magento

我将 Magento 用于客户的商店，他们有一个他们使用的 CRM (Hubspot)。他们的要求是，当客户通过他们的一站式结账页面进行购买时，输入的联系信息也会发送到他们的 CRM。

表单动作和诸如此类的东西不是我想要的。相反，我希望有人可以概述我将如何获取他们在结账时输入的信息。我是否需要有一个成功页面并将代码添加到该成功页面？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:36:47.197

您可以使用该`app/design/frontend/base/default/template/checkout/success.phtml`页面。首先，将其复制到您自己的包和主题中。然后你可以使用这样的东西：

```
$customerId = Mage::getSingleton('customer/session')->getCustomerId();
$customerData = Mage::getModel('customer/customer')->load($customerId)->getData();
var_dump($customerData); 
```

你应该能够从那里提取你需要的东西。

嗯！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:52:40.407

假设您正在使用他们的 REST Api @ [http://developers.hubspot.com/docs/methods/contacts/create_contact](http://developers.hubspot.com/docs/methods/contacts/create_contact)

您可以将您的 api 帖子添加到`app/design/frontend/base/default/template/checkout/success.phtml`（只会将信息发送到从前端而不是从管理员下订单的客户的 crm）

你也可以创建一个观察者

在 config.xml

```
 <events>
        <sales_order_place_after>
            <observers>
                <hubspot_create_customer_api>
                    <type>singleton</type>
                    <class>hubspotApi/observer</class>
                    <method>createCustomer</method>
                </hubspot_create_customer_api>
            </observers>
        </sales_order_place_after> 
```

在你的observer.php

```
class MageIgniter_HubspotApi_Model_Observer 
{

    public function createCustomer($event)
    {
        //$_order = $event->getOrder();
        //$_order->getCustomerFirstname();
        print_r($_order->getBillingAddress()); //get customer billing info
        print_r($_order->getBillingAddress()->getFirstname()); 

       //make curl call to post info to api
       //see http://mydons.com/using-curl-functions-in-magento-way/

    }
} 
```

学习如何[使用观察者创建自定义模块](https://stackoverflow.com/questions/12677971/change-magento-default-status-for-duplicated-products)

# nasm - nasm 输入/输出到窗口

> ID：15116531
> 
> 赞同：0
> 
> 时间：2013-02-27T15:57:00.303
> 
> 标签：nasm, tasm

我已经从 tasm 离开了一段时间，现在正在迁移到 nasm。我注意到的一件事是，鉴于此代码

```
mov ah,00h
int 16h

cmp ah,3Bh
je aaaa
jne bbbb 
```

为什么如果我在 nasm 中编译并链接并运行它，它不会产生一个像命令提示符那样等待我的键盘输入的窗口（它只是通过关闭它来完成执行）？之前，这段代码在 tasm 中运行良好，当我运行它时，它会打开一个提示符，然后等待我的键盘输入。

（我在 tasm 中注意到的一件事是 int 21h 函数 01,02,09 似乎运行良好，但在 nasm 中却没有）。谢谢

谢谢

# java - Java中的条件SQL where子句

> ID：15116532
> 
> 赞同：3
> 
> 时间：2013-02-27T15:57:09.823
> 
> 标签：java, sql, hibernate

我们希望有条件地将 where 子句添加到 SQL where 类

例如，我们有一个 DAO，它有一个带有 10 个参数的方法。

对于这些参数中的每一个，我们检查它是否为空，如果不是，我们在 where 子句中添加一个 AND。

“base”查询是一个硬编码字符串，我们将它与 ANDS 连接起来。

我正在寻找一种更优雅的方式来实现这一点。

我们在应用程序的其他地方使用休眠

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:59:30.887

您可以使用[Hibernate 条件 API](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/ch12.html)来动态构建查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:11:57.130

为简单起见，您可以使用可变参数方法并为数组启动循环并检查不为空并将其连接起来。否则你可以使用 Hibernate 标准 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:00:22.040

Hibernate Criteria 可能是您想要的。

[http://www.mkyong.com/hibernate/hibernate-criteria-examples/](http://www.mkyong.com/hibernate/hibernate-criteria-examples/)

[http://www.dil.univ-mrs.fr/~massat/docs/hibernate-3.1/api/org/hibernate/Criteria.html](http://www.dil.univ-mrs.fr/~massat/docs/hibernate-3.1/api/org/hibernate/Criteria.html)

# android - 当应用程序被杀死或状态保存时，MapFragment 被阻止或震惊

> ID：15116536
> 
> 赞同：0
> 
> 时间：2013-02-27T15:57:14.277
> 
> 标签：android, android-fragments, android-mapview, actionbarsherlock, android-maps-v2

我在 Activity 中使用 MapFragment + ListFragment 时遇到问题，当我使用 show() 和 hide() 方法时，一切正常，但是当我在后台运行应用程序并返回时，GoogleMap 被惊呆或被阻止，并且我不知道该怎么做才能解决这个问题。我可以正常工作的唯一解决方案是使用替换事务，但我不喜欢这种方式，因为在每次事务中我们都应该启动所有地图位置气球，并且它不会保留您的最后一个相机位置，所以......我不知道该怎么办。

PS：我使用 SherlockActionBar

提前致谢：

这是我的代码：

活动：

```
...
@Override
public void onCreate(Bundle savedInstanceState) {
    BugSenseHandler.initAndStartSession(this, "f8013578");
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_route_place);
    setViews();
    setData();
    doStuff();
}

@Override
public void onClick(View v) {
    switch (v.getId()) {
    case R.id.route_place_list:
        analyticTracker.sendView("/RoutePlaceActivity/List");
        isMap = true;
        changeFragments();
        break;
    case R.id.route_place_map:
        analyticTracker.sendView("/RoutePlaceActivity/Home");
        isMap = false;
        changeFragments();
        break;
    default:
        break;
    }
}

@Override
public void onRouteMapPlaceClick(Place place) {
    goToDetails(place);
}

@Override
public void onRouteListPlaceClick(Place place) {
    goToDetails(place);
}

@Override
public void onShowMessage(String message, Message type) {
    showMessage(message, type);
}

...

private void setData() {
    route = getIntent().getExtras().getParcelable("route");
    analyticTracker = GoogleAnalytics.getInstance(this).getTracker(Config.GOOGLE_ANALYTICS_ID);

    final FragmentTransaction ft = getSupportFragmentManager().beginTransaction();
    /*
     * If the activity is killed while in BG, it's possible that the
     * fragment still remains in the FragmentManager, so, we don't need to
     * add it again.
     */
    if (mapFragment == null) {
        Log.v("RoutePlaceActivity", "mapFragment = null");
        mapFragment = new RoutePlaceMapFragment();
        ft.add(R.id.route_place_container, mapFragment);
    }
    ft.hide(mapFragment);
    if (listFragment == null) {
        Log.v("RoutePlaceActivity", "listFragment = null");
        listFragment = RoutePlaceListFragment.newInstance();
        ft.add(R.id.route_place_container, listFragment);
    }
    ft.hide(listFragment);
    ft.commit();
}

private void doStuff() {
    changeFragments();
    sendItineraryPlacesRequest();
}

private void changeFragments() {
    final FragmentTransaction ft = getSupportFragmentManager().beginTransaction();
    ft.setCustomAnimations(android.R.anim.fade_in, android.R.anim.fade_out);
    if (isMap) {
        ft.hide(listFragment);
        ft.show(mapFragment);
        switcherView.setDisplayedChild(VIEW_LIST);
    } else {
        ft.hide(mapFragment);
        ft.show(listFragment);
        switcherView.setDisplayedChild(VIEW_MAP);
    }
    ft.commit();
}

private void sendItineraryPlacesRequest() {
    ... {

        ...

        @Override
        public void onSuccess(JSONObject response) {
            super.onSuccess(response);
            Places places = JSONObjectAdapter.getPlaces(response);
            mapFragment.addPlaces(places);
            listFragment.addPlaces(places);
        }

        ...

    });

} 
```

地图片段：

```
/********************* Constructors **********************/
...

/********************* Class Methods *********************/
...

@Override
public void onCreate(Bundle savedInstanceState) {
    Log.v(CLASS_TAG, "onCreate");
    super.onCreate(savedInstanceState);
    setData(savedInstanceState);
    setUpMapIfNeeded();
}

@Override   
public void onResume() {
    super.onResume();
    setUpMapIfNeeded();
}
...

@Override 
public void onDestroyView() {
    ((ViewGroup)getView()).removeAllViews();
    super.onDestroyView();
}

/******************** Public Methods ********************/
public void addPlaces(Places places) {
    mMap.clear();
    placeMap.clear();
    Builder builder = new LatLngBounds.Builder();
    for (Place place : places) {
        LatLng placePos = new LatLng(place.getLatitude(), place.getLongitude());
        builder.include(placePos);
        Marker m = mMap.addMarker(new MarkerOptions().position(placePos).title(place.getName()).draggable(false));
        placeMap.put(m, place);
    }

    if (places.size() > 1) {
        final LatLngBounds bounds = builder.build();
        try {

        mMap.moveCamera(CameraUpdateFactory.newLatLngBounds(bounds, 50));

        } catch (Exception e) {
            // layout not yet initialized
            final View mapView = getView();
            if (mapView.getViewTreeObserver().isAlive()) {
                mapView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {

                    @SuppressWarnings("deprecation")
                    @SuppressLint("NewApi")
                    // We check which build version we are using.
                    @Override
                    public void onGlobalLayout() {
                        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.JELLY_BEAN) {
                            mapView.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                        } else {
                            mapView.getViewTreeObserver().removeOnGlobalLayoutListener(this);
                        }
//                          mMap.moveCamera(CameraUpdateFactory.newLatLngBounds(bounds, 50));
                    }
                });
            }
        }

    } else if (places.size() != 0) {
        final CameraPosition cameraPosition = new CameraPosition.Builder().zoom(17).target(new LatLng(places.get(0).getLatitude(), places.get(0).getLongitude())).tilt(25).build();
        try {
            mMap.animateCamera(CameraUpdateFactory.newCameraPosition(cameraPosition), 4000, null);
        } catch (Exception e) {
            // layout not yet initialized
            final View mapView = getView();
            if (mapView.getViewTreeObserver().isAlive()) {
                mapView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {

                    @SuppressWarnings("deprecation")
                    @SuppressLint("NewApi")
                    // We check which build version we are using.
                    @Override
                    public void onGlobalLayout() {
                        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.JELLY_BEAN) {
                            mapView.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                        } else {
                            mapView.getViewTreeObserver().removeOnGlobalLayoutListener(this);
                        }
                        mMap.animateCamera(CameraUpdateFactory.newCameraPosition(cameraPosition), 4000, null);
                    }
                });
            }
        }

    } else {
        myListener.onShowMessage("No se han encontrado sitios cercanos", Message.INFO);
    }
}

/******************** Private Methods ********************/
private void setData(Bundle savedInstanceState) {
    placeMap = new HashMap<Marker, Place>();
    mMap = null;
}

private void setUpMapIfNeeded() {
    // Do a null check to confirm that we have not already instantiated the map.
    if (mMap == null) {
        mMap = getMap();
        // Check if we were successful in obtaining the map.
        if (mMap != null) {
            setUpMap();
        }
    }
}

private void setUpMap() {
    mMap.setMyLocationEnabled(true);
    mMap.setOnInfoWindowClickListener(this);

//        mMap.setOnMarkerClickListener(this);

    UiSettings uiSettings = mMap.getUiSettings();
    uiSettings.setCompassEnabled(false);

    Places places = getArguments().getParcelable("places");
    if (places != null) {
        addPlaces(places);
    }
} 
```

![列表片段 (1)](../Images/ff5493edd15bc6465a6bccaffb45af7c.png)

![地图片段 (1)](../Images/9d120cc3aeb75e0490c0854b14d8501b.png)

![地图片段 (2)](../Images/f9e8555d32aa9889ed7e4e6f8cff2ea0.png)

![列表片段 (2)](../Images/7254832e12f9026bdf5f551784043863.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:14:29.973

我在新的地图 api（Maps V2 android）中也面临同样的问题。但是我通过在容器活动中覆盖 onSaveInstance 和 onRestoreInstance 方法解决了它。而不是调用 super.onSaveInstance()。和 super.onRestoreInstance()。

这只是一个临时的 hack.. 但我认为你会启动并运行你漂亮的应用程序..

# java - 如何将类中的静态变量转换为json

> ID：15116537
> 
> 赞同：6
> 
> 时间：2013-02-27T15:57:15.753
> 
> 标签：java, json, gson

嗨，我有一个只包含静态变量的类常量。公共类常量

```
public class Constant
{
    public static class A
    {
        public static class B
        {
            public static final int  COLUMN = 0;
            public static final String  TYPE =  ColumnType.INPUT;
        }
    }
} 
```

有没有办法将此类转换为 JSON ？

我使用的是 gson，但显然它忽略了静态变量。那么我该怎么做呢？
谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-07-22T09:24:00.883

接受的答案是正确的。为清楚起见，这里是一个工作示例。您可以将 GsonBuilder 类与[excludeFieldsWithModifiers 方法一起使用。](http://google-gson.googlecode.com/svn/tags/1.2.3/docs/javadocs/com/google/gson/GsonBuilder.html#excludeFieldsWithModifiers%28int...%29)

```
 GsonBuilder gsonBuilder  = new GsonBuilder();
    // Allowing the serialization of static fields
    gsonBuilder.excludeFieldsWithModifiers(java.lang.reflect.Modifier.TRANSIENT);
    // Creates a Gson instance based on the current configuration
    Gson gson = gsonBuilder.create();
    String json = gson.toJson(objectToSerialize);
    System.out.println(json); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-27T15:59:39.380

您可以在类上使用[此方法](http://google-gson.googlecode.com/svn/tags/1.2.3/docs/javadocs/com/google/gson/GsonBuilder.html#excludeFieldsWithModifiers%28int...%29)配置 GSON 忽略哪些字段修饰符。`GsonBuilder`

# r - R中的扩展回归模型

> ID：15116546
> 
> 赞同：1
> 
> 时间：2013-02-27T15:57:54.653
> 
> 标签：r, linear-regression

我正在将几个分类变量和连续变量混合在一起进行回归。为了简化我的问题，我想创建一个回归模型，该模型可以预测给定某个驾驶员在不同区域的行驶里程的行驶时间。也就是说，我的训练数据中有 5 个不同的驱动程序和 2 个区域。

我知道我可能需要建立 5*2=10 的回归模型来进行预测。我在 R 中使用的是

```
m <- lm(driving_time ~ factor(driver)+factor(zone)+miles) 
```

但似乎 R 并没有消耗这个组合。我的问题是是否有任何聪明的方法可以在 R 中自动进行扩展。或者我必须一个一个地编写 10 个回归模型。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:30:59.103

请阅读`?formula`。`+`在公式中意味着将该变量作为主要影响。您似乎正在寻找 和 之间的交互`driver`项`zone`。您可以使用运算符创建交互项`:`。还有一个捷径可以通过`*`运营商获得主效应和交互效应。

关于您是否还想`miles`进行交互存在一些混淆，但我假设不在这里，因为您只提到 2 x 5 项。

```
foo <- transform(foo, driver = factor(driver), zone = factor(zone))
m <- lm(driving_time ~ driver * zone + miles, data = foo) 
```

在这里，我假设您的数据在 data frame 中`foo`。*第一行通过在拟合之前*将感兴趣的变量转换为因子，将数据处理与模型规范/拟合分开。

然后，该公式指定 的主效应和交互效应，`driver`以及`zone`的主效应`miles`。

如果您想要所有三个之间的交互，那么：

```
m <- lm(driving_time ~ driver * zone * miles, data = foo) 
```

或者

```
m <- lm(driving_time ~ (driver + zone + miles)^3, data = foo) 
```

会为你做的。

# java - 在 JSTL 中迭代列表

> ID：15116547
> 
> 赞同：1
> 
> 时间：2013-02-27T15:57:56.407
> 
> 标签：java, jstl

我有一个控制器文件，其中包含模型中的值列表，例如，

```
List caseIds = new ArrayList();
for(int i=0; i<caseLists.size(); i++)
{
    if(caseIds.contains(caseLists.get(i).getCaseId()))
        continue;
    else 
        caseIds.add(caseLists.get(i).getCaseId());             
}
model.put("caseIdList", caseIds); 
```

我想在下拉框中的 UI 中显示这个 caseIds。我的代码看起来像这样，

```
<select name="caseIds" id="caseIds">
    <option value="">All</option>
    <c:forEach var="item" items="${model.caseIdList}">
        <option value="<c:out value='${item.caseIdList}'/>" >
            <c:out value="${item.caseIdList}"/>     
        </option>
    </c:forEach>
</select> 
```

我的意思是我想要一个 id 和 value 作为 caseId 的下拉列表（选择框）。我了解使用 item.caseIdList 获取项目时出错。我应该如何接近？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:05:06.987

这就是你想要做的：

```
<select name="caseIds" id="caseIds">
    <option value="">All</option>
    <c:forEach var="item" items="${model.caseIdList}">
        <option value="<c:out value='${item}'/>" >
            <c:out value="${item}"/>     
        </option>
    </c:forEach>
</select> 
```

您需要使用`item`而不是`item.caseIdList`因为`caseIdList`contains `Integer`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:06:03.273

`item`在 jsp 中的 for 循环中将是添加了的 caseId `caseLists.get(i).getCaseId()`，所以我认为您只需要以下内容：

```
<select name="caseIds" id="caseIds">
    <option value="">All</option>
    <c:forEach var="item" items="${model.caseIdList}">
        <option value="<c:out value='${item}'/>" >
            <c:out value="${item}"/>     
        </option>
    </c:forEach>
</select> 
```

# ios - 使用 phonegap 时出现 Xcode 错误

> ID：15116548
> 
> 赞同：0
> 
> 时间：2013-02-27T15:58:03.450
> 
> 标签：ios, objective-c, xcode, cordova

因此，当我使用 phonegap 创建本机 ios 应用程序时，我遇到了 2 个错误，我不确定如何解决它们。Xcode 和 Objective-C 现在超出了我的知识范围，所以我不知道该怎么做。他们声明有多个构建命令。

```
Warning: Multiple build commands for output file /Users/gcollins/Library/Developer/Xcode/DerivedData/Hanna_Instruments_App-dcesxqrxziqltacadrozhxjujrgz/Build/Products/Debug-iphonesimulator/hanna-project.app/icon-72.png
Warning: Multiple build commands for output file /Users/gcollins/Library/Developer/Xcode/DerivedData/Hanna_Instruments_App-dcesxqrxziqltacadrozhxjujrgz/Build/Products/Debug-iphonesimulator/hanna-project.app/Default-Portrait~ipad.png 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:46:24.033

Xcode 告诉您您正在尝试将相同的文件两次/多次添加到包中。

在“Project Navigator”中选择您的 Xcode 项目文件。寻找“复制捆绑资源”构建阶段，它将显示项目中包含的所有文件。删除重复的引用。

# asp.net-mvc - asp.net mvc3中基于角色的授权

> ID：15116550
> 
> 赞同：0
> 
> 时间：2013-02-27T15:58:05.430
> 
> 标签：asp.net-mvc, authorization

**您好，我是新的 ASP.NET MVC。目前正在从asp.net官方网站学习MVCmusicstore教程。但是在其中实现基于角色的授权后执行项目时出现错误。堆栈跟踪如下。请指教**

堆栈跟踪：

[FileLoadException：无法加载文件或程序集“System.Runtime.DurableInstancing，版本=4.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。

句柄无效。（来自 HRESULT 的异常：0x80070006 (E_HANDLE)）] System.RuntimeTypeHandle.CreateInstance（RuntimeType 类型，Boolean publicOnly，Boolean noCheck，Boolean& canBeCached，RuntimeMethodHandleInternal& ctor，Boolean& bNeedSecurityCheck）+0

System.RuntimeType.CreateInstanceSlow（布尔publicOnly，布尔skipCheckThis，布尔fillCache）+98

System.RuntimeType.CreateInstanceDefaultCtor（布尔publicOnly，布尔skipVisibilityChecks，布尔skipCheckThis，布尔fillCache）+241

System.Activator.CreateInstance（类型类型，布尔非公共）+69

System.RuntimeType.CreateInstanceImpl（BindingFlags bindingAttr，Binder binder，Object[] args，CultureInfo 文化，Object[] activationAttributes）+1136

System.Activator.CreateInstance（类型类型，BindingFlags bindingAttr，Binder binder，Object[] args，CultureInfo 文化，Object[] activationAttributes）+111

System.Activator.CreateInstance（类型类型，BindingFlags bindingAttr，Binder binder，Object[] args，CultureInfo 文化）+23

System.Web.HttpRuntime.CreateNonPublicInstance（类型类型，Object[] args）+60

System.Web.Configuration.HttpModulesSection.CreateModules() +221

System.Web.HttpApplication.InitModules() +28

System.Web.HttpApplication.InitInternal（HttpContext 上下文，HttpApplicationState 状态，MethodInfo[] 处理程序）+828

System.Web.HttpApplicationFactory.GetNormalApplicationInstance(HttpContext 上下文) +304

System.Web.HttpApplicationFactory.GetApplicationInstance（HttpContext 上下文）+107

System.Web.HttpRuntime.ProcessRequestInternal(HttpWorkerRequest WR) +327

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:03:35.413

您似乎缺少对以下程序集的引用：

```
System.Runtime.DurableInstancing 
```

右键单击项目，选择“添加引用”并添加此程序集。

# javascript - 确定是否已加载 Google 网络字体

> ID：15116553
> 
> 赞同：2
> 
> 时间：2013-02-27T15:58:15.723
> 
> 标签：javascript, jquery, fonts, google-webfonts

我正在建立一个网站，让用户可以选择应用于其文本的字体。我正在使用谷歌的网络字体。目前，当他们通过下拉菜单选择字体时，我正在使用：

```
 $("head").append("<link href='https://fonts.googleapis.com/css?family=" + FontName + "' rel='stylesheet' type='text/css'>"); 
```

这很好用。我的问题是：

*   如果用户多次选择相同的字体（在同一个会话中）该字体是否加载了两次？
*   如果是这样，有没有办法确定字体 X 是否已经加载，以免重新加载它？

有很多，我想我不想全部预加载，只是在选择时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:06:59.880

用户的浏览器应该缓存字体而不需要你做任何额外的事情。

由于字体位于 google 的服务器中，缓存协商发生在 google 和您的用户之间。换句话说，你甚至无法控制它。

因此，第二次添加相同内容不应导致用户浏览器再次加载它。当然，除非用户在他们的浏览器上禁用了缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:05:16.347

字体应由浏览器缓存，请参阅[https://developers.google.com/webfonts/faq#Many_Fonts_Per_Page](https://developers.google.com/webfonts/faq#Many_Fonts_Per_Page)

# php - PHP循环进行MYSQL查询

> ID：15116555
> 
> 赞同：0
> 
> 时间：2013-02-27T15:58:18.867
> 
> 标签：php, mysql

我有一个从一组复选框生成的 ID 列表，如下所示：

```
$list = mysql_real_escape_string(implode(',',$_POST['checkbox'])); 
```

输出如下列表：

a,b,c

我想在 MYSQL 数据库中设置与每个列表项相对应的列，但尝试使用 foreach 循环创建查询未成功，如下所示：

```
$update_query= '';
foreach($list as $item){     //error on this line
 $update_query .= "
  INSERT INTO t (Col_1, Col_2)
  VALUES  ('".$item."',now());
     ";} 
```

它没有告诉我我为 foreach() 提供了一个无效的参数，但我不确定，a。那是什么意思，和b。如何解决它；任何人都可以提供任何指导以使我的循环正常工作或执行此插入的更好方法。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:01:54.743

`$list`是一个字符串，而不是一个数组。在加载之前尝试传入数组：

```
$update_query= '';

foreach($_POST['checkbox'] as $item)
{
    $update_query .= "INSERT INTO t (Col_1, Col_2) VALUES ('".addslashes($item)."', now());"; 
} 
```

不过，使用准备好的语句会更好！

# razor - 带有动态列表和参数的 ASP.NET MVC 4 面包屑

> ID：15116565
> 
> 赞同：10
> 
> 时间：2013-02-27T15:58:43.897
> 
> 标签：razor, asp.net-mvc-4, breadcrumbs

基本上我想做的是创建一个面包屑列表。该动态列表（当您深入到更深的页面时，面包屑列表会增加）并且大多数链接都有参数。我见过 MVCSiteInfo 的例子，但有点困惑，因为我见过的大多数例子都集中在一组没有参数的静态链接上。我无法想象这不是一个常见问题，所以我想知道实现此功能的最佳方法是什么。

提前致谢！

西格

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-17T01:28:24.530

我建议您使用[MVC Sitemap 提供程序](http://nuget.org/packages/MvcSiteMapProvider/ "MVC 站点地图提供程序")和其中的面包屑路径。您将需要构建一个动态节点提供程序，但这相当简单 - 只需按照[使用动态节点的步骤](https://github.com/maartenba/MvcSiteMapProvider/wiki/Dynamic-sitemaps)

构建动态节点的技巧之一是确保在每个级别的每个节点上进行 foreach，但将其添加到顶部的节点集合中。

```
 var nodes = new List<DynamicNode>();
        foreach (var eventCategory in eventCategories)
        {
            var node = new DynamicNode
                {
                    Key = string.Format("{0}_{1}", "home_events", eventCategory.Name),
                    ParentKey = "home_events",
                    Title = pluralize.Pluralize(eventCategory.Name),
                    Description = eventCategory.Description,
                    Controller = "event",
                    Action = "category"
                };
            node.RouteValues.Add("slug", eventCategory.Slug);
            nodes.Add(node);

            foreach (var e in eventCategory.Events)
            {
                var eventNode = new DynamicNode
                {
                    Key = string.Format("{0}_{1}", eventCategory.Name, e.Name),
                    ParentKey = node.Key,
                    Title = e.Name,
                    Controller = "event",
                    Action = "event"
                };
                eventNode.RouteValues.Add("categorySlug", eventCategory.Slug);
                eventNode.RouteValues.Add("slug", e.Slug);
                nodes.Add(eventNode);
            }
        } 
```

然后就像这样把面包屑放进去

```
Html.MvcSiteMap().SiteMapPath() 
```

**主页 > 赛事 > 马拉松 > 墨尔本马拉松**

# css - 如何避免水平滚动条

> ID：15116568
> 
> 赞同：0
> 
> 时间：2013-02-27T15:58:52.613
> 
> 标签：css

任何人都可以看看我的代码

```
<html>
    <div class="box">
        <div class="txtFld">
            <input type="text"/>
        </div>
        <ul>
            <li>text</li>
            <li>text</li>
            <li>text</li>
            <li>text</li>
            <li>text</li>
            <li>text</li>
            <li>text</li>
            <li>text</li>
        </ul>
    </div>
</html> 
```

CSS 代码：

```
ul{margin:0;padding:0}
ul li{border-bottom:1px solid #f1f1f1;padding:5px}
.box{width:160px;overflow:auto;border:1px solid #ccc;height:150px}
.txtFld{-webkit-box-sizing:border-box;box-sizing:border-box;-moz-box-sizing:border-box}
.txtFld input{width:100%;} 
```

水平滚动条出现在 chrome 和 ie 浏览器中。我在哪里犯错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-10T12:14:40.257

我知道这个问题很老，但答案是：

您必须`box-sizing:border-box`在文本输入上设置属性（而不是像您那样在他的父 div 上）。

它会正常工作，请在 JSFiddle 中查看：http: [//jsfiddle.net/rE6xW/2/](http://jsfiddle.net/rE6xW/2/)

这是因为文本输入默认具有填充（2px）和边框（1px），当您将其宽度设置为 100% 时，`100%+2*[padding+border]`您会得到一个水平滚动条，因为它比其父级宽 6px。当您设置`box-sizing:border-box`属性时，您的`width:100%`属性将被解释为：

> 100% = 内部宽度 + 填充 + 边框

我希望这会对某人有所帮助。

.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:06:17.883

这是因为

```
.txtFld input{width:100%;} 
```

改成

```
.txtFld input{width:50%;} 
```

或任何适合的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:07:12.117

如果您只需要隐藏滚动条，请使用

```
.box::-webkit-scrollbar {
    display: none;                                                          
} 
```

铬

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T19:20:34.680

只需将宽度设置`.txtFld`为`auto`：

```
.txtFld input {
  width:auto;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T16:12:41.003

假设您不希望在任何具有“box”类的元素上出现滚动条，则需要将**overflow**设置为**hidden**。

```
.box {
  border: 1px solid #CCC;
  height: 15px;
  overflow: hidden;
  width: 150px;
} 
```

如果只想禁用水平滚动条，则将**overflow-x**设置为隐藏。

```
overflow-x: hidden; 
```

如果您不希望整个页面都有水平滚动条，那么您需要在**body**标签上设置**overflow-x 。**

 **```
body { overflow-x: hidden; } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T16:14:29.130

您的文本框宽度是否被项目中的其他地方覆盖？

```
.txtFld input{
  width:100%;
} 
```

当从您提供的代码中删除它时，它似乎只在 IE 和 Chrome 中有一个水平条，但在 Firefox 中可以正常工作。也许仔细检查您的 CSS 文档和 HTML。**

# php - 读取大文件并强制下载

> ID：15116570
> 
> 赞同：1
> 
> 时间：2013-02-27T15:58:55.870
> 
> 标签：php, csv

```
$name = 'mybigfile.csv';
    $fp = fopen(...);
    while($row = mysql_fetch_assoc($sql_result)) {
       fputcsv($fp, $row);
    }
    fclose($fp);

// send the correct headers
header("Content-Type: application/csv etc ....");
header("Content-Length: " . filesize($name));

// dump the file and stop the script
readfile($name);
exit; 
```

这种方法工作得很好，但有些文件很大，所以它的过程很慢......我在想 - 也许我可以避免先创建文件然后写入数据然后读取数据和输出的过程。 ... .ie如果我在while循环之前发送标头并在while循环中回显行（而不是写在一行中）或类似的东西。这会是更有效的过程吗？你会建议我如何改进这个过程？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:02:13.150

直接写入输出：

```
header("Content-Type: application/csv etc ....");

while ($row = mysql_fetch_assoc($sql_result)) {
    fputcsv(STDOUT, $row);
} 
```

请参阅此处以供参考：[http ://www.php.net/manual/en/wrappers.php.php](http://www.php.net/manual/en/wrappers.php.php)

# linq-to-sql - 自动生成视图模型

> ID：15116574
> 
> 赞同：1
> 
> 时间：2013-02-27T15:59:10.810
> 
> 标签：linq-to-sql, mvvm, silverlight-4.0, mvvm-light, ria

在我当前的项目中，我们正在使用 GalaSoft 的 Silverlight 4、RIA 服务、Linq-to-SQL、MVVMlight。我知道创建 .dbml 文件、domainservices.cs 和 doaminservice.metadata.cs 文件。但我不知道自动创建 viewmodel.cs 文件。

这个项目已经完成了一半，所有的 viewmodel.cs 文件都是自动生成的。我不知道如何自动生成视图模型文件。我正在尝试手动编写代码，但问题是在重建我编写的代码后消失了，或者它没有采用任何数据上下文。

我是 RIA 服务的新手。谁能帮我解决这个问题。非常感谢。

```
using .VSO.ViewModels;

//------------------------------------------------------------------------------
// <copyright file="PlannerViewModel.cs" company=" Corporation">
//     Copyright (c) Corporation. All rights reserved.
// </copyright>
// <auto-generated>
//     Template Version : 1.0.0.0
//     ViewModel for Planner 
//   Generated from C:\DEV2010\VSO\Source\VSO\VSO.Web\Models\Planner.dbml
// </auto-generated>
//------------------------------------------------------------------------------

namespace .VSO.ViewModel 
```

或者是否有任何其他工具可以生成代码。

# javascript - CSS/JS 资产可视化工具

> ID：15116575
> 
> 赞同：1
> 
> 时间：2013-02-27T15:59:11.813
> 
> 标签：javascript, css, sitemap, assets

是否有一个实用程序可以为页面资源生成“站点地图”？多年来，我们的网站已经积累了大量各种 JS 和 CSS 资产的重复副本，我希望有一种方法可以插入我们的网站并让它生成一个列表，列出在哪里调用的内容，这样我们就可以开始清理了。我刚开始手动完成 - 我完全可以手动完成，但这需要一段时间，我认为这样的东西必须已经存在。

任何人都可以提出建议吗？

# c# - 使用 html 助手将渲染视图中的数字范围限制为正数

> ID：15116576
> 
> 赞同：0
> 
> 时间：2013-02-27T15:59:12.523
> 
> 标签：c#, asp.net-mvc, html

我正在构建一个 MVC 应用程序，我试图将输入类型数字字段的范围限制为正数。

这是一个例子：

```
Quantity: <input type="number" value="int" name="quantity"/> 
```

我的视图中的这行代码将生成一个数字字段，用户可以在该字段上单击并选择一个数字。但是这个数字可以是正数也可以是负数，我想将其仅限于正数。

知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:03:13.417

`<input type="number" value="int" name="quantity" min="0"/>`

这是很酷的新 HTML5 输入类型功能之一。

# jquery - jQuery悬停链接交换图像

> ID：15116577
> 
> 赞同：4
> 
> 时间：2013-02-27T15:59:12.137
> 
> 标签：jquery, image, swap

如果用户将鼠标悬停在图像将与末尾带有“-on”的图像交换的链接上，我想做以下操作。

但是，当我悬停 a 标签时，如何在图像上获取交换内容？

**HTML 代码：**

```
<div>
    <a href="#">
        <img src="image.jpg" alt="" />
        Here some caption
    </a>
</div> 
```

*我无法将图片网址放在标题中...*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-27T16:10:55.097

```
$(function () {
    $('a img').hover( function () {
        $(this).attr('src', $(this).attr('src').replace(/\.jpg/, '-on.jpg') );
    });
}); 
```

阅读 jQuery 文档[`replace`](http://api.jquery.com/replace/)和[`attr`](http://api.jquery.com/attr/).

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-27T16:04:06.783

改变`src`你的形象只是`attr`：

```
$('img').attr("src", "image2.jpg"); 
```

您需要使用[悬停](http://api.jquery.com/hover/)：

```
$("a").hover(
function() {
    $(this).find('img').attr("src", "image2.jpg");
},
function() {
    $(this).find('img').attr("src", "image.jpg");
}
); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T16:07:05.683

您可以在 a 标签上使用 DOM 'mouseover' 事件并向其附加回调（然后在内部，您将更改图像的 URL）

编辑，示例代码：

```
<div>
<a id="myLink" href="#">
    <img id="myImg" src="image.jpg" alt="" />
    Here some caption
</a>
</div> 
```

在 JS 中：

```
var img = document.getElementById('myImg');
document.getElementById('myLink').onmouseover = function(){
    //manipulate the image source here.
    img.src = img.src.replace(/\.jpg/, '-on.jpg');
} 
```

然后，您将需要使用 onmouseout 将原始图像放回原处。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-25T05:10:08.967

```
$(document).ready(function($) {
	$('img').on('mouseover', function(){
		src = $(this).attr('src').replace('.gif', '-hover.gif');
		$(this).attr('src', src);
	})
	$('img').on('mouseout', function(){
		src = $(this).attr('src').replace('-hover.gif', '.gif');
		$(this).attr('src', src);
	});	
});
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-24T20:00:43.573

这是一种在鼠标离开时让图像恢复到原始状态的方法。

```
 $(document).ready(function($) {
    	$('img').on('mouseover', function(){
    		src = $(this).attr('src').replace('hover', 'thanks!');
    		$(this).attr('src', src);
    	})
    	$('img').on('mouseout', function(){
    		src = $(this).attr('src').replace('thanks!', 'hover');
    		$(this).attr('src', src);
    	});	
    });
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>

<img src="http://placeholder.pics/svg/500x150/DEDEDE/555555/hover" />
```

# workspace - Websphere 启动错误

> ID：15116579
> 
> 赞同：0
> 
> 时间：2013-02-27T15:59:14.587
> 
> 标签：workspace, websphere-7

我正在尝试在 RAD IDE 上使用 Websphere 7.0 应用程序服务器设置工作区。我正在使用 Java 1.6

当我尝试启动我的服务器时，它会引发以下错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: Files
Caused by: java.lang.ClassNotFoundException: Files
at java.net.URLClassLoader.findClass(URLClassLoader.java:434)
at java.lang.ClassLoader.loadClass(ClassLoader.java:660)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:358)
at java.lang.ClassLoader.loadClass(ClassLoader.java:626)
Could not find the main class: Files.  Program will exit. 
```

这会是什么原因？以前有没有人遇到过这种错误。

注意：我尝试使用谷歌搜索，人们建议尝试更改类路径，我尝试过但没有奏效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T12:53:26.610

看起来某处未能引用包含 C:\Program Files 的参数，可能是由于自定义 JVM 配置。如果您对 bin\startServer.bat 使用 -script 选项，您可能能够确定哪里出了问题。这可能是产品问题，因此如果您无法解决（或者您认为不应归咎于您的配置），那么您可以考虑与 IBM 建立 PMR。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-07T20:14:58.427

如果您在尝试从 RAD 控制台启动服务器时遇到此问题，这可能是产品问题，解决此问题的快速方法可能是使用命令行启动服务器，请参阅下面有关如何启动服务器的示例

C:\WorkFolder\WASV8.5_Install\profiles\AppSrv03\bin>startServer.bat server1 -profileName AppSrv02

尝试在命令提示符下启动，您会看到服务器也在您的 RAD 控制台中启动。

```
 C:\WorkFolder\WASV8.5_Install\profiles\AppSrv02\logs\server1\startServer.log 
```

ADMU0128I：使用 AppSrv02 配置文件启动工具 ADMU3100I：读取服务器的配置：server1 ADMU3200I：服务器已启动。等待初始化状态。ADMU3000I：服务器 server1 对电子商务开放；进程 ID 为 20484

# php - jQuery - 远程验证规则

> ID：15116585
> 
> 赞同：1
> 
> 时间：2013-02-27T15:59:31.077
> 
> 标签：php, jquery, jquery-validate

```
<script type="text/javascript">
$(document).ready(function() {
    jQuery(function($){
        $("#form").submit(function(e){
           if ($(this).valid()){
                $.ajax( {
                    type: "POST",
                    url: "http://localhost/My/modules/validate.php",
                });
           }
           return false;
     })});
        $("#form").validate({
            rules: {
                user: {
                    remote: {
                        url: "http://localhost/My/modules/validate.php",
                        async: false,
                    }
                }
            }
        });
});
$.validator.setDefaults({
    debug:      true,
    success:    "valid",
});
</script> 
```

我想创建远程验证规则。此示例正确读取 ajax 请求。虽然返回真/假都评估为验证错误。

但是，删除 ajax 部分 (jQuery()) 会导致缺少 ajax 初始化，甚至不处理请求。

async: false 似乎是被动的，删除它会导致同样的事情。

任何人都可能知道这里有什么问题？

编辑：

```
$(document).ready(function() {
        $("#form").validate({
            rules: {
                user: {
                    remote: "http://localhost/My/modules/validate.php",
                }
            },
            submitHandler: function (form) {
                // do your ajax form submission here
                return false; // prevent redirect since you did ajax
            }
        });
});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:20:32.740

使用 Validate 插件时不需要外部`submit`处理程序，因为它已经内置了所有事件处理程序。

`submitHandler`仅当表单有效并且您可以在其中放置任何`ajax`表单提交时才会触发内置函数。

你`ajax`在两个地方做......使用`remote`规则和你的`submit`处理程序。

*   `remote`如果您的 ajax 用于验证字段，请使用该规则。
*   如果`submitHandler`您的 ajax 用于表单提交，请使用。

[根据文档，](http://docs.jquery.com/Plugins/Validation/Methods/remote#options)这仅使用[规则`remote`](http://docs.jquery.com/Plugins/Validation/Methods/remote#options)：

```
$(document).ready(function () {

    $("#form").validate({
        rules: {
            user: {
                // ajax in remote rule to check this field
                remote:  "http://localhost/My/modules/validate.php"
                }
            }
        }
    });

});

// get rid of all this
//$.validator.setDefaults({
    //debug: true,  // not needed in production
    //success: "valid", // this is already the default.
//}); 
```

* * *

**如果**您使用 ajax 进行表单提交，以下只是我的建议。否则忽略它。

[根据文档，](http://docs.jquery.com/Plugins/Validation/validate#toptions)[这`submitHandler`](http://docs.jquery.com/Plugins/Validation/validate#toptions)是使用回调：

```
$(document).ready(function () {

    $("#form").validate({
        // your rules & options,
        submitHandler: function (form) {
            // do your ajax form submission here
            return false; // prevent redirect since you did ajax
        }
    });

}); 
```

# domain-driven-design - 如何创建多语言领域模型

> ID：15116593
> 
> 赞同：6
> 
> 时间：2013-02-27T15:59:49.547
> 
> 标签：domain-driven-design, multilingual

我正在使用域驱动设计，并且对我的域模型有一个非常清晰的了解。它包含超过 120 个类，并且非常稳定。我们将在 .NET 4 和 C# 中实现它。问题是，我们需要模型是多语言的；一些属性需要以多种语言存储。例如，Person 类有一个 Position 类型的属性，`string`它应该存储英语（例如“Librarian”）和西班牙语（例如“Bibliotecario”）的值。此属性的 getter 应根据某些语言参数返回英语或西班牙语版本。

这里开始我的问题。我不确定如何参数化它。我已经探索了两种主要的方法：

1.  使用属性集合。Position 不是 a`string`而是 a `Dictionary<Language, string>`，它可以让客户通过语言检索该人的位置。
2.  保持简单的标量属性，但让它们根据全球已知的“当前语言”设置返回（或设置）一种语言或另一种语言的值。客户端代码将设置工作语言，然后所有对象将设置并获取该语言的值。

选项 1 避免了全局状态，但它弄乱了我模型中几乎每个类的接口。另一方面，选项 2 的表现力较差，因为如果不查看全局设置，您将无法判断您将获得哪种语言。此外，它在全局设置的每个类中引入了依赖关系。

请注意，我对数据库或 ORM 实现不感兴趣；我只在域模型级别工作。

那么我有两个具体问题：

*   哪个是实现多语言域模型目标的最佳选择（1 或 2）？
*   还有其他我没有考虑过的选项，它们是哪些？

谢谢你。

**编辑**. 有人认为这是与用户界面相关的问题，因此可以通过 .NET 中的全球化/本地化支持来解决。我不同意。仅当您知道必须在编译时向用户显示的本地化文字时，UI 本地化才有效，但这不是我们的情况。我的问题涉及编译时未知的多语言数据，因为它将在运行时作为用户数据提供。这不是与 UI 相关的问题。

**编辑 2**。请记住，Person.Position 只是用来说明问题的玩具示例。它不是真实模型的一部分。不要试图批评或改进它；这样做是没有意义的。我们的业务需求涉及到很多不能编码为枚举类型或类似的属性，并且必须保持为自由文本。因此困难重重。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T09:23:33.207

鉴于以下情况：

> 一些用例涉及以所有支持的语言设置对象的值；其他涉及查看一种给定语言的值。

我建议两种选择都去。这意味着持有多语言内容的 Person 和所有类都应保持该内容处于其状态，并且：

*   **Position 属性应该以当前**用户的语言设置/获取人员的位置 。

*   **所有** 语言设置/获取 都应该有相应的属性或方法。

*   应该有一种方法来设置（甚至在需要时切换）用户语言。我将创建一个带有抽象 SetLanguage(Language lang) 方法和 CurrentLanguage getter 的抽象类（例如 BaseMultilingualEntity）。您需要在某种会公开语言设置的注册表中跟踪从 BaseMultilingualEntity 派生的所有对象。

**用一些代码编辑**

 `````
public enum Language {
    English,
    German
}

// all multilingual entity classes should derive from this one; this is practically a partly implemented observer
public abstract class BaseMultilingualEntity
{
    public Language CurrentLanguage { get; private set; }

    public void SetCurrentLanguage(Language lang)
    {
        this.CurrentLanguage = lang;
    }
}

// this is practically an observable and perhaps SRP is not fully respected here but you got the point i think
public class UserSettings
{
    private List<BaseMultilingualEntity> _multilingualEntities;

    public void SetCurrentLanguage(Language lang)
    {
        if (_multilingualEntities == null)
            return;

        foreach (BaseMultilingualEntity multiLingualEntity in _multilingualEntities)
            multiLingualEntity.SetCurrentLanguage(lang);
    }

    public void TrackMultilingualEntity(BaseMultilingualEntity multiLingualEntity)
    {
        if (_multilingualEntities == null)
            _multilingualEntities = new List<BaseMultilingualEntity>();

        _multilingualEntities.Add(multiLingualEntity);
    }
}

// the Person entity class is a multilingual entity; the intention is to keep the XXXX with the XXXXInAllLanguages property in sync
public class Person : BaseMultilingualEntity
{
    public string Position
    {
        set
        {
            _PositionInAllLanguages[this.CurrentLanguage] = value;
        }
        get
        {
            return _PositionInAllLanguages[this.CurrentLanguage];
        }
    }

    private Dictionary<Language, string> _PositionInAllLanguages;

    public Dictionary<Language, string> PositionInAllLanguages {
        get
        {
            return _PositionInAllLanguages;
        }
        set
        {
            _PositionInAllLanguages = value;
        }
    }
}

public class Program
{
    public static void Main()
    {

        UserSettings us = new UserSettings();
        us.SetCurrentLanguage(Language.English);

        Person person1 = new Person();
        us.TrackMultilingualEntity(person1);

        // use case: set position in all languages
        person1.PositionInAllLanguages = new Dictionary<Language, string> {
            { Language.English, "Software Developer" }, 
            { Language.German, "Software Entwikcler" }
        };

        // use case: display a person's position in the user language
        Console.WriteLine(person1.Position);

        // use case: switch language
        us.SetCurrentLanguage(Language.German);
        Console.WriteLine(person1.Position);

        // use case: set position in the current user's language
        person1.Position = "Software Entwickler";

        // use case: display a person's position in all languages
        foreach (Language lang in person1.PositionInAllLanguages.Keys)
            Console.WriteLine(person1.PositionInAllLanguages[lang]);

        Console.ReadKey();

    }
} 
````  `* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T20:47:48.007

域模型是一种抽象——它为世界的特定部分建模，它捕获了域的*概念*。

该模型的存在使开发人员可以像领域专家的交流方式在代码中进行交流——对相同的概念使用相同的名称。

现在，西班牙专家和英语专家可能对同一个概念使用不同的词，但概念本身是相同的（希望，虽然语言可能是模棱两可的，人们并不总是以相同的方式理解同一个概念，但我离题了）。

代码应该为这些概念选择一种人类语言并坚持下去。绝对没有理由让模型包含不同的语言来表示单个概念。

现在，您可能需要用他们的语言向用户*展示*应用程序数据和元数据，但这个概念并没有改变。

在这方面，您的第二个选择是您应该做的事情 - 对于 .NET，这通常是通过查看`CurrentThread.CurrentCulture`和/或`CurrentThread.CurrentUICulture`以及使用包含本地化资源的[附属程序集来完成的。](http://blogs.msdn.com/b/global_developer/archive/2011/07/22/introduction-to-satellite-assemblies.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T10:05:33.423

> 我的问题涉及多语言**数据**

[...]

> 请注意，我对数据库或 ORM 实现不感兴趣；

我可以在这两个陈述中看到一些矛盾。无论最终的解决方案是什么，无论如何，您的数据库中都会有多语言特定的结构以及查询它们进行翻译的机制，对吗？

问题是，除非你的领域真的是*关于*翻译的，否则我会尽量避免它与多语言问题有关，原因与你试图让你的领域持久性无知或 UI 无知的原因相同。

因此，我至少会将多语言解析逻辑放在基础设施层中。例如，如果您确实需要在实体中跟踪多语言并且不希望持久层透明地处理所有这些，则可以使用[方面仅将多语言行为附加到某些属性：](http://en.wikipedia.org/wiki/Aspect-oriented_programming)

```
public class Person
{
   [Multilingual]
   public string Position { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T23:57:06.447

**使用户明确！**
我已经遇到过用户的文化是该域中的一等公民的域，但是在这种情况下，我建模了一个适当的值对象（在您的示例中，我将使用[正确](http://www.codeproject.com/Articles/20592/Implementing-IEquatable-Properly)实现的 Position 类`IEquatable<Position>`）和能够表达此类[的 User](http://epic.tesio.it/doc/manual/bounded_roles.html)价值观。

坚持你的例子，比如：

```
public sealed class VATIN : IEquatable<VATIN> { // implementation here... }
public sealed class Position : IEquatable<Position> { // implementation here... }
public sealed class Person 
{ 
    // a few constructors here...

    // a Person's identifier from the domain expert, since it's an entity
    public VATIN Identifier { get { // implementation here } }

    // some more properties if you need them...
    public Position CurrentPosition { get { // implementation here } }

    // some commands
    public void PromoteTo(Position newPosition) { // implementation here }
}
public sealed class User
{
    // <summary>Express the position provided according to the culture of the user.</summary>
    // <param name="position">Position to express.</param>
    // <exception cref="ArgumentNullException"><paramref name="position"/> is null.</exception>
    // <exception cref="UnknownPositionException"><paramref name="position"/> is unknown.</exception>
    public string Express(Position position) { // implementation here }

    // <summary>Returns the <see cref="Position"/> expressed from the user.</summary>
    // <param name="positionName">Name of the position in the culture of the user.</param>
    // <exception cref="ArgumentNullException"><paramref name="positionName"/> is null or empty.</exception>
    // <exception cref="UnknownPositionNameException"><paramref name="positionName"/> is unknown.</exception>
    public Position ParsePosition(string positionName) { // implementation here }
} 
```

并且不要忘记文档和正确设计的[异常](http://epic.tesio.it/2013/03/04/exceptions-are-terms-ot-the-ubiquitous-language.html)！

**警告**
您提供的示例模型中至少有两种巨大的设计气味：

*   公共设置器（Position 属性）
*   持有业务价值的 System.String

公共设置器意味着您的实体将其自己的状态暴露给客户，而不管其自身的不变量如何，或者此类属性对实体没有商业价值，因此根本不应该成为实体的一部分。实际上，可变实体应该始终[将命令（可以改变状态）和查询（不能）分开](http://epic.tesio.it/doc/manual/command_query_separation.html)。

具有业务语义的 System.String 总是带有隐含的域概念的味道，通常是具有相等操作的值对象（我的意思是实现 IEquatable）。

请注意，要获得可重用的领域模型非常具有挑战性，因为它需要两名以上的领域专家和丰富的 ddd 建模经验。我在职业生涯中遇到的最糟糕的“领域模型”是由一位具有丰富 OOP 技能但之前没有建模经验的高级程序员设计的：它是 GoF 模式和数据结构的混合体，希望非常灵活，事实证明没用。在花费了 20 万欧元之后，我们不得不把它扔掉并从头开始。

可能你只需要一个好的数据模型直接映射到 C# 中的一组简单数据结构：如果你真的不需要它，你将永远不会从域模型的前期投资中获得任何投资回报！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T01:19:37.847

值得一提的是 Apache 的*MultiViews*功能以及它根据浏览器的*Accept-Language*标头提供不同内容的方式。

因此，如果用户请求“content.xml”，例如，Apache 将根据某些优先级规则提供 content.en.xml 或 content.sp.xl 或 content.fr.xml 或任何可用的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T18:38:05.087

> 它包含超过 120 个类，并且非常稳定。

与问题没有直接关系，但您可能需要考虑您的域中是否存在多个有界上下文。

我同意 Oded 的观点，在您的场景中，语言似乎是一个 UI 问题。当然，域可以通过C#和英文的组合来声明，它代表的是抽象的。[UI 将使用CultureInfo.CurrentCulture](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.currentculture.aspx)处理语言- 有效的选项 #2。

具有 Position 属性的 Person 实体不控制用于表示职位的自然语言。您可能有一个用例，您希望以一种语言显示位置，而该位置最初以另一种语言存储。在这种情况下，您可以将翻译器作为 UI 的一部分。这类似于将货币表示为一对金额和货币，然后在货币之间进行转换。

**编辑**

> 此属性的 getter 应根据某些语言参数返回英语或西班牙语版本。

是什么决定了这个语言参数？什么负责确保以多种语言存储，比如位置？还是即时进行翻译？谁是物业的客户？如果客户端确定了语言参数，为什么客户端不能在不涉及域的情况下进行翻译？是否存在与多种语言相关的任何行为，或者这只是出于阅读目的的考虑？DDD 的重点是提炼您的核心行为领域，并将与查询数据相关的方面转移到其他责任领域。例如，您可以使用[读取模型模式](http://gorodinski.com/blog/2012/04/25/read-models-as-a-tactical-pattern-in-domain-driven-design-ddd/)来访问具有特定语言的聚合的 Position 属性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-24T15:33:59.467

鉴于要求，我可能会尝试将职位本身建模为实体/价值。该对象不是翻译字典，而只是可用作域字典的键。

```
// IDomainDictionary would be resolved based on CurrentThread.CurrentUICulture
var domainDict = container.Resolve<IDomainDictionary<Position>>();
var position = person.Position;
Debug.Writeline(domainDict.NameFor(position, pluralForm: 1)); 
```

现在假设您需要在不存在合适的同义词时动态创建新位置，您可以通过使用 IDomainDictionary 作为 UI 中自动完成建议的来源来保持数据的整洁。``

# linux - 实现可移植的文件锁定机制

> ID：15116594
> 
> 赞同：8
> 
> 时间：2013-02-27T15:59:59.450
> 
> 标签：linux, lockfile

我已经按照“open”的 linux 手册页中的建议实现了文件锁定机制，其中指出：

> 想要使用 lockfile 执行原子文件锁定并且需要避免依赖 NFS 对 O_EXCL 支持的便携式程序，可以在同一文件系统上创建唯一文件（例如，合并主机名和 PID），并使用 link(2)创建锁定文件的链接。如果link(2) 返回0，则锁定成功。否则，对唯一文件使用 stat(2) 来检查其链接数是否增加到 2，在这种情况下，锁定也是成功的。

这似乎工作得很好，但是为了在我的测试中获得 100% 的代码覆盖率，我需要涵盖链接数增加到 2 的情况。

我试过谷歌搜索，但我似乎能找到的只是上面提到的与“完成方式”相同的参考。

谁能向我解释一下哪些情况会导致链接失败（返回 -1），但链接数增加到 2？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-18T02:05:44.843

Linux程序员手册的链接（2）页面底部提供了您问题的答案：

```
 On NFS file systems, the return code may  be  wrong  in  case  the  NFS
   server  performs  the link creation and dies before it can say so.  Use
   stat(2) to find out if the link got created. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T17:47:38.743

创建另一个文件比什么都麻烦。而是创建一个目录并检查创建结果。Unix 手册指出，只有一个任务可以成功创建目录，如果目录已经存在，另一个任务将失败，包括两个任务同时尝试的情况。操作系统本身会处理该问题，因此您不必这样做。

如果不是因为可能的陈旧锁，这就是您所要做的。然而，事情发生了，程序中止并且并不总是删除它们的锁。所以实现可以稍微复杂一点。

在脚本中，我经常使用下面的代码。它会自动处理陈旧的锁。您可以在 C 中实现相同的功能。检查手册页：

```
man -s 2 mkdir 
```

EXECUTION_CONTROL_FILE：是名称 PATH 和 Dir 名称，类似于 /usr/tmp/myAppName

second_of_now：以秒为单位返回当前时间（包括在下面）

LOCK_MAX_TIME：是锁在被认为是陈旧之前可以存在多长时间（以秒为单位）

sleep 5：总是假设锁会做一些简短而甜蜜的事情。如果没有，也许你的睡眠周期应该更长。

```
LockFile() {
  L_DIR=${EXECUTION_CONTROL_FILE}.lock
  L_DIR2=${EXECUTION_CONTROL_FILE}.lock2
  (
  L_STATUS=1
  L_FILE_COUNT=2
  L_COUNT=10
  while [ $L_STATUS != 0 ]; do
    mkdir $L_DIR 2>/dev/null
    L_STATUS=$?
    if [ $L_STATUS = 0 ]; then
      # Create the timetime stamp file
      second_of_now >$L_DIR/timestamp
    else
      # The directory exists, check how long it has been there
      L_NOW=`second_of_now`
      L_THEN=`cat $L_DIR/timestamp 2>/dev/null`
      # The file does not exist, how many times did this happen?
      if [ "$L_THEN" = "" ]; then
        if [ $L_FILE_COUNT != 0 ]; then
          L_THEN=$L_NOW
          L_FILE_COUNT=`expr $L_FILE_COUNT - 1`
        else
          L_THEN=0
        fi
      fi
      if [ `expr $L_NOW - $L_THEN` -gt $LOCK_MAX_TIME ]; then
        # We will try 10 times to unlock, but the 10th time
        # we will force the unlock.
        UnlockFile $L_COUNT
        L_COUNT=`expr $L_COUNT - 1`
      else
        L_COUNT=10  # Reset this back in case it has gone down
        sleep 5
      fi
    fi
  done
  )
  L_STATUS=$?
  return $L_STATUS
}

####
#### Remove access lock
####
UnlockFile() {
  U_DIR=${EXECUTION_CONTROL_FILE}.lock
  U_DIR2=${EXECUTION_CONTROL_FILE}.lock2
  (
  # This 'cd' fixes an issue with UNIX which sometimes report this error:
  #    rm: cannot determine if this is an ancestor of the current working directory
  cd `dirname "${EXECUTION_CONTROL_FILE}"`

  mkdir $U_DIR2 2>/dev/null
  U_STATUS=$?
  if [ $U_STATUS != 0 ]; then
    if [ "$1" != "0" ]; then
      return
    fi
  fi

  trap "rm -rf $U_DIR2" 0

  # The directory exists, check how long it has been there
  # in case it has just been added again
  U_NOW=`second_of_now`
  U_THEN=`cat $U_DIR/timestamp 2>/dev/null`
  # The file does not exist then we assume it is obsolete
  if [ "$U_THEN" = "" ]; then
    U_THEN=0
  fi
  if [ `expr $U_NOW - $U_THEN` -gt $LOCK_MAX_TIME -o "$1" = "mine" ]; then
    # Remove lock directory as it is still too old
    rm -rf $U_DIR
  fi

  # Remove this short lock directory
  rm -rf $U_DIR2
  )
  U_STATUS=$?
  return $U_STATUS
}

####
second_of_now() {
  second_of_day `date "+%y%m%d%H%M%S"`
}

####
#### Return which second of the date/time this is. The parameters must
#### be in the form "yymmddHHMMSS", no centuries for the year and
#### years before 2000 are not supported.
second_of_day() {
  year=`printf "$1\n"|cut -c1-2`
  year=`expr $year + 0`
  month=`printf "$1\n"|cut -c3-4`
  day=`printf "$1\n"|cut -c5-6`
  day=`expr $day - 1`
  hour=`printf "$1\n"|cut -c7-8`
  min=`printf "$1\n"|cut -c9-10`
  sec=`printf "$1\n"|cut -c11-12`
  sec=`expr $min \* 60 + $sec`
  sec=`expr $hour \* 3600 + $sec`
  sec=`expr $day \* 86400 + $sec`
  if [ `expr 20$year % 4` = 0 ]; then
    bisex=29
  else
    bisex=28
  fi
  mm=1
  while [ $mm -lt $month ]; do
    case $mm in
      4|6|9|11) days=30 ;;
      2) days=$bisex ;;
      *) days=31 ;;
    esac
    sec=`expr $days \* 86400 + $sec`
    mm=`expr $mm + 1`
  done
  year=`expr $year + 2000`
  while [ $year -gt 2000 ]; do
    year=`expr $year - 1`
    if [ `expr $year % 4` = 0 ]; then
      sec=`expr 31622400 + $sec`
    else
      sec=`expr 31536000 + $sec`
    fi
  done
  printf "$sec\n"
} 
```

像这样使用：

```
 # Make sure that 2 operations don't happen at the same time
    LockFile
    # Make sure we get rid of our lock if we exit unexpectedly
    trap "UnlockFile mine" 0
.
.  Do what you have to do
.
    # We need to remove the lock
    UnlockFile mine 
```

# javascript - Simplecart.js 检查 Simplecart_Items 是否有项目

> ID：15116595
> 
> 赞同：0
> 
> 时间：2013-02-27T16:00:03.950
> 
> 标签：javascript, shop, simplecart

是否可以像这样检查 div 类 simplecart_items 中是否有项目？

```
if simplecart_items == 0 {
NO ITEMS IN THE CARD // Shows no add to card, no total coast and no products quantity
}
else {
The "normal" output // Shows add to card, total coasts and products
} 
```

有办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T06:49:53.603

您可以在 simplecartjs 脚本的 V3 中尝试这种方式，

```
if(simpleCart.items().length == 0)
{
//No items in the cart
} 
```

如果您想检查购物车中已经存在的特定商品，请使用 jQuery。

```
simpleCart.bind('beforeAdd', function (item) {
  if (simpleCart.has(item)) 
  {
      alert("Already in the Cart");
      return false;
  }
}); 
```

# sql - SQL Server ADO.NET 同时选择查询申诉

> ID：15116602
> 
> 赞同：0
> 
> 时间：2013-02-27T16:00:27.303
> 
> 标签：sql, sql-server-2008, ado.net, .net-4.5

我得到了 10 个选择查询，其中一个使用了 nolock 提示`SqlConnection`。这给了我 10 个`SqlCommand`对象。

我根据一些业务规则并行推进每个指针，因此我无法从查询 1 中获取所有数据，关闭它，然后继续下一个，依此类推。

我的一个查询包含一个 max 和 group by 子句。

*   如果我放在第二或第三位，它就可以了。
*   如果我把它放在最后，我会超时。

我折腾了`ConnectionTimeout`也没用。

有任何想法吗 ？

提前致谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:42:17.847

经过大量阅读，我得出以下结论：数据库服务器上没有足够的内存来及时为我的应用程序提供服务。

我去了 DBA，在日志中没有发现任何错误消息:(。

有没有办法告诉我给定查询消耗了多少内存？SQL Server Profiler 为我提供了读取/写入次数、持续时间，但没有提供查询结果消耗的内存。

谢谢 ：）

# php - 如何为 .click 事件赋值

> ID：15116604
> 
> 赞同：1
> 
> 时间：2013-02-27T16:00:38.310
> 
> 标签：php, javascript, jquery

我有很多输入字段在按下输入键时发布数据我做了一件事我找到所选按钮的 id 并希望通过单击事件 bt 它给出错误这里是代码

```
$(".text").bind("keydown", function(event) {
  // track enter key
  var keycode = (event.keyCode ? event.keyCode : (event.which ? event.which : event.charCode));
  if (keycode == 13) { 
      var id=$(this).parent().find("input[type=submit]").attr('id');    
    (id).click(); // this one give error
     return false;
  } else  {
     return true;
  }
}); 
```

**(id).click();** 这一行给出了 id.click 不是函数的错误。我缺少什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:04:29.853

我认为您正在寻找：

```
$(this).closest("form").find("input[type=submit]").trigger("click"); 
```

无需尝试查找`id`并创建不同的 JQuery 对象。您将参考您要查找的内容`find("input[type=submit]")`。

为了确定，我们需要查看您的标记，以便找到最有效的方法来查找您正在寻找的元素，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:02:15.850

`id`是一个字符串。
字符串没有`click`方法。

相反，您应该直接提交表单：

```
$(this).closest('form').submit(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T16:06:51.990

您需要使用以下内容：

```
$("#"+id).trigger("click"); 
```

# c# - ActionFilterAttribute 期间的绑定

> ID：15116607
> 
> 赞同：0
> 
> 时间：2013-02-27T16:00:46.377
> 
> 标签：c#, asp.net-mvc, model-binding

努力弄清楚为什么我在这里从 BindModel 返回 null 。我有一个正在扩展的属性`ActionFilterAttribute`...

```
public class MyCachedAttribute : ActionFilterAttribute
{
  private IModelBinder binder = new DefaultModelBinder();
  private Type model;

  public MyCachedAttribute(Type model)
  {
     this.model = model;
  }

  public override void OnActionExecuting(ActionExecutingContext filterContext)
  {
     ModelBindingContext bindingContext = new ModelBindingContext()
     {
        ModelMetadata = ModelMetadataProviders.Current.GetMetadataForType(null, model),
        ModelName = model.Name,
        ModelState = filterContext.Controller.ViewData.ModelState,
        ValueProvider = filterContext.Controller.ValueProvider
     };

     object data = binder.BindModel(filterContext.Controller.ControllerContext, bindingContext); 
```

此时`data`是`null`。

编辑：我回到这个并意识到`ModelState`它是空的（因此导致`null`），因为该方法没有正常传入的模型（因此为什么我在这种情况下绑定，以获取它）。

```
 [MyCached(typeof(FooViewModel))]
  public ActionResult Foo()
  {
     return PartialView(new FooViewModel());
  } 
```

如何`ModelState`为我拥有的类型生成，并将其传递给活页夹？我试图避免将模型添加为输入参数，因为它会导致问题，但如果这仍然是一个问题，我可能不得不对这些问题进行排序。

谢谢。

Edit2：我在这里使用 ActionFilterAttribute 来修改在某些情况下作为响应发送的模型，而在其他情况下，它接受要在缓存中更新的模型。在这种情况下，我需要绑定它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:24:59.563

您应该在 modelbinder 中进行模型绑定。不是动作过滤器。ActionFilters 用于拦截和修改请求和响应。所以，像这样清理你的 ActionResult 。

```
public ActionResult Foo(FooViewModel model)
{
    return PartialView(model);
} 
```

然后创建一个自定义模型绑定器。

```
public class CachedModelBinder : DefaultModelBinder {

public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) {
    object data = base.BindModel(controllerContext, bindingContext);
    // data is not null anymore. You can do your custom stuff now, then return the model
    return data;
} 
```

并将其注册`Application_Start()`到您的`global.asax.cs`

```
ModelBinders.Binders.Add(typeof(FooViewModel), new CachedModelBinder()); 
```

# java - Java Graphics2D 擦除到 alpha 背景

> ID：15116608
> 
> 赞同：3
> 
> 时间：2013-02-27T16:00:54.120
> 
> 标签：java, user-interface, graphics2d, java-2d, erase

我正在制作一个应用程序，它有一个绘图板，您可以在其中用鼠标绘图，它绘制在 BUfferedImage 中的标签之上。我现在要实现的是橡皮擦，问题是我找不到任何帮助将橡皮擦清除到 alpha 背景的地方。（我无法定义颜色背景，因为用户可以将背景更改为他想要的任何图像）。总结一下：

*   如何用 alpha 像素擦除/覆盖 Graphics2D 像素？我发现的方法是使用 clearRect 但您需要指定背景颜色。

以下是我的 DrawBoard 类，其中包含要绘制的所有内容。

```
public class DrawBoard extends JPanel implements MouseListener, MouseMotionListener{

public JLabel status;
private JLabel imgLabel; // this is where the drawing happens
public Point pstart, pfinish;
private List<Point> points = new ArrayList<Point>();
private List<BufferedImage> lines = new ArrayList<BufferedImage>();

private static final int BI_WIDTH = 1024;
private static final int BI_HEIGHT = 800;
private static int STROKESIZE = 7;

private BufferedImage bImage = new BufferedImage(BI_WIDTH, BI_HEIGHT,
        BufferedImage.TYPE_INT_ARGB);

public Color currentColor;

public static boolean eraser = false;

private int xX1, yY1;

public DrawBoard(){  

   Graphics2D g2d = bImage.createGraphics();
   g2d.dispose();

    Dimension size = getPreferredSize();
    size.setSize(1024,800); //w, h
    setPreferredSize(size);
    //status =  new JLabel("default");
    //add(status, BorderLayout.SOUTH);
    addMouseListener(this);
    addMouseMotionListener(this);  

     imgLabel = new JLabel(new ImageIcon(bImage)) {
     @Override
     protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        paintInLabel(g);
     }
   };
     imgLabel.setOpaque(false);
     setOpaque(false);
      add(imgLabel, BorderLayout.CENTER);

}

private void paintInLabel(Graphics g) {
  Graphics2D g2d = (Graphics2D) g;
  g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
  g2d.setColor(getColor()); // this colour is when mouse is pressed
  g2d.setStroke(new BasicStroke(STROKESIZE));
  if (points.size() < 2) {
     return;
  }
  for (int i = 1; i < points.size(); i++) {
     int x1 = points.get(i - 1).x;
     int y1 = points.get(i - 1).y;
     int x2 = points.get(i).x;
     int y2 = points.get(i).y;
     g2d.drawLine(x1, y1, x2, y2);
  }
 }

@Override
public void mouseExited(MouseEvent e){  
}

@Override
public void mouseEntered(MouseEvent e){  
}

@Override
public void mouseMoved(MouseEvent e){   
}

// Where the drawing happens
@Override
public void mousePressed(MouseEvent e) {
    //status.setText("you pressed down the mouse");
    xX1 = e.getX();
    yY1 = e.getY();

        points.add(e.getPoint());
}

@Override
public void mouseDragged(MouseEvent e) {
  //status.setText("you draged the mouse");
        points.add(e.getPoint());
        imgLabel.repaint();

}

@Override
public void mouseReleased(MouseEvent e) {
    //status.setText("you release the mouse click");
    Graphics2D g2d = bImage.createGraphics();
    g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
    g2d.setColor(getColor()); // this is the final colour
    g2d.setStroke(new BasicStroke(STROKESIZE));

     if (points.size() >= 2) {
        for (int i = 1; i < points.size(); i++) {
           int x1 = points.get(i - 1).x;
           int y1 = points.get(i - 1).y;
           int x2 = points.get(i).x;
           int y2 = points.get(i).y;
           g2d.drawLine(x1, y1, x2, y2);
        }
     }
     g2d.dispose();

     points.clear();
     imgLabel.repaint();

}
// End of where the drawing happens

public void clearDrawBoard() {

}

private Color getColor() {

    return ColourToolbar.selectedColor;
}

private void setColor(Color col){

    this.currentColor = col;
}

@Override
public void mouseClicked(MouseEvent e) {
    //throw new UnsupportedOperationException("Not supported yet.");
}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T16:12:07.537

您应该在绘制矩形之前[为您的 Graphics2D 设置自定义 Composite](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics2D.html#setComposite%28java.awt.Composite%29)，特别是[AlphaComposite.Clear 。](http://docs.oracle.com/javase/7/docs/api/java/awt/AlphaComposite.html#Clear)完成后不要忘记将合成重置为默认值 (SRC_OVER)，因为相同的 Graphics 对象将被重用于绘制其他组件。

# floating-point - 整数乘以浮点数，然后除以相同的浮点数 - 一种将值强制返回原始整数的干净方法

> ID：15116609
> 
> 赞同：0
> 
> 时间：2013-02-27T16:00:56.023
> 
> 标签：floating-point, floating-accuracy, floating-point-precision

好的，所以我们有经典的 1 * 1/3 * 3 = 0.9999999。我明白为什么会这样。

在我的用例中，我试图产生一个整数。我很乐意接受我的价值，除非无限精度数学要求我们应该以整数开头（参见：上述用例）。

有没有一种常用的方法来实现这一点？

例子：

双倍 myFloat = 1.0/2.0;

1 * myFloat * 2 = 2 结果：2

我的浮动 = 1.0/2.0;

2.5 * myFloat * 2 = 2.5 结果：2

myFloat = 1.0 / 3.0;

1 * myFloat *3 = .9999 结果：1

myFloat = 1.0 / 3.0;

.9 * myFloat *3 = .9 结果：0

我想到的一种方法是在铺平之前总是对我的结果进行一些增量。不过，我想以一种干净、普遍接受的方式来实现我的结果。

编辑：为清晰起见，根据反馈进行了更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T03:02:25.673

将 f(x) 舍入到最接近的整数，round(f(x))

比较 f(x) 和 round(f(x))。如果它们足够接近，差异是由于四舍五入造成的，则使用 round(f(x)) 作为结果。如果没有，请使用 floor(x)。

如果输入的大小都相似，则对某个固定数 epsilon 使用 abs(f(x)-round(f(x)) < epsilon 可能就足够了。如果不是，请使用 abs((f(x)-round (f(x))/f(x)) < 非零 f(x) 的 epsilon。

# sql-injection - SQL 注入：语法错误

> ID：15116615
> 
> 赞同：0
> 
> 时间：2013-02-27T16:01:01.930
> 
> 标签：sql-injection, inject

我有一篇关于 SQL 注入的文章（它是什么 - 它是如何完成的以及如何避免它）。我知道它是什么以及它是如何工作的。但我似乎无法在我的数据库上重现注入。

我使用 mysql 工作台制作了一个非常简单的数据库，用于视频俱乐部。电影 - 股票 - 价格 - 客户购物车等。我还制作了一个非常简单的 html 页面，我可以从中添加电影 - 查看我的库存等。

所以我有一个 txt 字段，我可以在其中输入电影名称，然后我会返回该特定电影的一些信息。

获取我输入的名称并进行查询的代码是::

```
$name = $_POST ['txtfld'];
$sql = ("SELECT * FROM test_table WHERE adad = '$Mname'");
if ($result = mysqli_query($dbc,$sql)) 
```

现在，当我将“a”作为输入时，一切都按预期工作。我取回了一个 pk 等于 [a] 的条目。查询变为 :: SELECT * FROM test_table WHERE adad='a'。

下一步是看看我是否可以从中获取整个表或一些随机条目。输入是：[ a' OR 'x'='x ] 查询变为 :: SELECT * FROM test_table where adad = ' ***a' OR 'x' = 'x*** ' 一切都按预期工作，我取回了整个表的内容。

下一步是尝试注入第二个查询。我试图更新 test_table。输入是 :: [ a;' update test_table set asda = '123456' where adad = 'u ] 查询现在变成 :: SELECT * FROM test_table WHERE adad= ' **a;' 更新 test_table SET asda ='123456' WHERE adad = 'u** '

我遇到了一个语法错误，所以我尝试了所有我能想到的语法，包括 [ **a;' 更新 test_table SET asda = '123456' 其中 adad = 'u';#** ] 。他们都没有工作。

问题是，我真的不明白为什么会出现语法错误。

对于上面给出的输入，mysqli_error 返回此消息

```
error: You have an error in your SQL syntax; check the manual that corresponds to your
MySQL server version for the right syntax to use near 'update test_table set asda =
'123456' where adad = 'u'' at line 1 
```

而我插入的回声返回这个

```
SELECT * FROM test_table WHERE adad = 'a;' UPDATE test_table SET asda = '123456' WHERE 
adad = 'u' 
```

我在回显返回中没有看到任何语法错误，并且我不知道 mysqli_error 返回末尾的第二个 [ ' ] 字符来自何处。

据我了解，这是执行第二个查询的失败（无论查询是什么 - 删除、插入、更新）

我想念什么吗？

提前致谢。

迈克尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:04:19.423

mysql 的 PHP 驱动程序不允许在单个 ->query() 调用中进行多个查询，正是出于这个原因。这是一种反注入防御，可以防止经典的[Bobby Tables](http://bobby-tables.com)攻击。对于所有 PHP db 接口（mysql、mysqli、pdo）都是如此，因为它们都使用相同的底层 mysql C api 库来实际与 db 对话。在单个查询调用中运行 2+ 个查询的任何尝试都会导致语法错误。

但是请注意，它不能防止您的`' or 1=1`注射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T02:30:49.207

为了让您的堆叠查询注入技术发挥作用，您需要使用“mysqli_multi_query()”函数：

[http://php.net/manual/en/mysqli.multi-query.php](http://php.net/manual/en/mysqli.multi-query.php) [http://www.websec.ca/kb/sql_injection#MySQL_Stacked_Queries](http://www.websec.ca/kb/sql_injection#MySQL_Stacked_Queries)

MsSQL 是唯一默认支持堆叠查询的数据库。

UNION 攻击也可能是一种更好、更可靠的注入技术，然后从“mysql.user”表中转储 MySQL 凭据，然后使用这些来破坏数据库。

# android - 恢复 Drawable[] 的长度

> ID：15116616
> 
> 赞同：-1
> 
> 时间：2013-02-27T16:01:11.227
> 
> 标签：android, android-drawable

我想知道是否可以恢复drawable []的长度。

我试着像对 Integer[] 那样做：

```
int count;
count = myDrawable[].length; 
```

但返回结果大约需要 5 秒（drawable[] 只包含 4 行）。

```
Drawable[] theme = {    
    Drawable.createFromStream(expansionFile.getInputStream("amiante_plombier_ce_1.png"), "src"),
    Drawable.createFromStream(expansionFile.getInputStream("amiante_plombier_ce_2.png"), "src"),
    Drawable.createFromStream(expansionFile.getInputStream("amiante_plombier_ce_3.png"), "src"),
    Drawable.createFromStream(expansionFile.getInputStream("amiante_plombier_ce_4.png"), "src"),
}; 
```

知道为什么需要这么长时间吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-28T13:27:03.877

好的，关键是我`int count; count = myDrawable[].length;`在 PagerAdapter 的函数 getCount() 内部使用了我的函数，我必须在函数`count`外部进行初始化，并进行测试`count`以避免在我的扩展文件中循环和检查多次。它与这样的东西完美配合：

```
 public int count = -1;

    @Override
    public int getCount(){
        if (count == -1){
            try {
                count = theme.length;
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return count;
    } 
```

# javascript - 表格排序的jQuery精确数字匹配

> ID：15116617
> 
> 赞同：1
> 
> 时间：2013-02-27T16:01:18.550
> 
> 标签：javascript, jquery, sorting

我正在构建一个 jQuery 表格排序脚本。是的，是的，我知道有插件，但是摆脱别人的大衣尾巴有什么乐趣（更不用说完全缺乏学习和理解）？

所以我已经对 alpha 类型进行了很好的排序，我现在正在研究数字排序。

这么快又脏。我得到列值并将它们推入一个数组：

```
 var counter = $(".sort tr td:nth-child("+(columnIndex+1)+")").length;

    for (i = 1; i <= counter; i++) {
        columnValues.push($(".sort tr:eq("+i+") td:eq("+columnIndex+")").text());
    } 
```

然后我对它们进行排序：

```
 columnValues.sort(function(a,b){
        return a-b
    }); 
```

然后我检查唯一条目（这主要用于相同的名称）：

```
 $.each(columnValues, function(i, el){
        if($.inArray(el, uniqueColumns) === -1) uniqueColumns.push(el); 
    }); 
```

然后我使用数组作为键列表从表中获取数据并推入另一个数组。这就是问题所在。对于名称，它可以正常工作，但对于数字（即 3、30、36）则不行。对于以 3 开头的排序列表，它会在 30 和/或 36 中看到 3 并抓取它。

这是我尝试过的：

```
 for (i = 0; i < counter; i++) {
        var key = uniqueColumns[i];

        $(".sort tr:contains("+key+") td").each(function(){
            rowValues.push($(this).text());
        });

    } 
```

和：

```
 for (i = 0; i < counter; i++) {
        var key = uniqueColumns[i];

        $(".sort tr td").filter(function(i){
            if($(this).text() === key) {
                rowValues.push($(this).text());
            }
        });
    } 
```

这是使用第一组代码运行代码的小提琴（比第二组更好）：

更新：

也刚刚尝试过（仍然无法正常工作，适用于初始排序但不适用于后续排序）：

```
 for (i = 0; i < counter; i++) {
        var key = uniqueColumns[i];
        var found = false;

        $(".sort tr:contains("+key+")").filter(function(j){
            $(this).children().each(function(){
                if ($(this).text() === key) {
                    found = true;
                } 
            });

            $(this).children().each(function(){
                if (found) {
                    rowValues.push($(this).text());
                } 
            });
        });
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T15:32:41.910

我自己想出来的。决定采用完全不同的方法。我从表数据中创建了一个多维数组，然后创建了一个适用于数字和 alpha 数据的自定义排序函数。这是获取数据、对数据进行排序和重写表的函数。

```
function sort(column) {
    var columnIndex = $(column).index(),
    rowValues = [];

    /* Get Data */
    $(".sort tr").not(":first-child").each(function () {
        var innerArray = [];

        $(this).find('td').each(function () {
            innerArray.push($(this).text());
        });

        rowValues.push(innerArray);
    });

    /* Sort Data */
    rowValues.sort((function(index){
        return function(a, b){                
            if (!isNaN(a[index])) {
                a[index] = parseInt(a[index]);
            }

            if (!isNaN(b[index])) {
                b[index] = parseInt(b[index]);
            }

            return (a[index] === b[index] ? 0 : 
                   (a[index] < b[index] ? -1 : 1));
        };
    })(columnIndex));

    /* Replace Data */
    $(".sort tr").not(":first-child").each(function(i){
        $(this).find("td").each(function(j){
            $(this).replaceWith("<td>"+rowValues[i][j]+"</td>");
        });
    });
} 
```

# html - 列表中的图像不能正确浮动

> ID：15116627
> 
> 赞同：0
> 
> 时间：2013-02-27T16:01:52.793
> 
> 标签：html, css, image, html-lists

我正在尝试制作一个图像列表，每行 2 个。

不均匀的行（1、3、5 等）应该首先有一个小图像，然后是一个宽的图像。偶数行（2、4、6、8 等）应该首先具有宽图像，然后再具有较小的图像。

我现在在第 3 行，无论出于何种原因，我都无法将小图像放在左边。正如您在下图中看到的那样，它向右浮动。

我的代码非常基本，Dreamweaver 在其拆分功能中正确显示它。

HTML：

```
<div id="portfolio-screen"></a>
    <ul>
            <li><img src="images/portfolio-jaar1.png" width="228"/></li>
            <li><img src="images/portfolio-pr1_2.png" width="500"/></li>
            <li><img src="images/portfolio-pr1_4.png" width="500"/></li>
            <li><img src="images/portfolio-pvs1.png" width="228"/></li>     
            <li><img src="images/portfolio-jaar2.png" width="228"/></li>
            <li><img src="images/portfolio-pr2_2.png" width="500"/></li>
    </ul>                   
</div> 
```

CSS

```
#portfolio-screen       {margin-top: 8px; width: 768px; height: 602px; background-color:#37322d; overflow: auto;}
#portfolio-screen li    {margin-top: 8px; margin-left: 8px; float: left;} 
```

由于某种原因，不允许发布图片，所以我提供了一个链接：http: [//oi51.tinypic.com/b63vkk.jpg](http://oi51.tinypic.com/b63vkk.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:39:28.487

您可以尝试这样的事情 - 可以根据您的尺寸需要删除图像的 CSS 高度。

HTML

```
<div id="portfolio-screen">
<ul>
    <li>
        <img src="images/portfolio-jaar1.png" class="imgSmall" />
    </li>
    <li>
        <img src="images/portfolio-pr1_2.png" class="imgLarge" />
    </li>
    <li>
        <img src="images/portfolio-pr1_4.png" class="imgLarge" />
    </li>
    <li>
        <img src="images/portfolio-pvs1.png" class="imgSmall" />
    </li>
    <li>
        <img src="images/portfolio-jaar2.png" class="imgSmall" />
    </li>
    <li>
        <img src="images/portfolio-pr2_2.png" class="imgLarge" />
    </li>
</ul>
</div> 
```

CSS：

```
img {
 height:20px;
}
.imgSmall {
 width:228px;
}
.imgLarge {
 width: 500px;
}
#portfolio-screen {
 margin: 0;
 padding: 0;
 width: 768px;
 height: 602px;
 background-color:#37322d;
}
#portfolio-screen ul {
 margin: 0;
 padding: 15px;
 width: 768px;
}
#portfolio-screen li {
 margin-top: 8px;
 margin-left: 8px;
 display: inline-block;
}
#portfolio-screen li:nth-child(odd) {
 margin:0;
} 
```

JS 小提琴：http: [//jsfiddle.net/5qREV/](http://jsfiddle.net/5qREV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:21:59.873

首先，你有一个坏`</a>`的那里。

其次，确保您的无序列表的**边距和填充为 0**

最后，弄乱 JSfiddle：

[http://jsfiddle.net/Riskbreaker/NT4DS/10/](http://jsfiddle.net/Riskbreaker/NT4DS/10/)

*而不是浮动尝试内联块*

# php - 验证登录数据 PDO PHP

> ID：15116629
> 
> 赞同：2
> 
> 时间：2013-02-27T16:01:56.160
> 
> 标签：php, pdo

我正在尝试将我的代码从 mysql_connect 更改为 PDO，但遇到了一些问题。我是 PHP 新手，有人告诉我 mysql_connect 很旧，所以这是我的代码。我似乎无法验证用户。即使我输入了错误的用户，它也不会输出无效的用户。

```
 $_GET['errorCode'];

        $errors = array(
      1 => 'Invalid User',
      2 => 'Incorrect Password');

      if(isset($_GET['errorCode'])){
      $code = $_GET['errorCode'];
      print isset($errors[$code]) ? $errors[$code] : 'Unknown error';
    }

         if($_SERVER['REQUEST_METHOD']== 'POST'){

        $username = $_POST['username'];
        $password = $_POST['password'];

        if(isset($_POST['username']) && isset($_POST['password'])){

              $stmt = $dbh->prepare("SELECT password, salt FROM user WHERE username = :user_name");
         $stmt->execute(array(':user_name' => "$username"));
            $stmt->bindParam(':user_name', $username, PDO::PARAM_STR);

        if(!$stmt->rowCount() > 0)

       {
        header('Location: index.php?errorCode=1');

        exit;

    }
        $result = $stmt->fetch(PDO::FETCH_ASSOC);

    $hash = hash('sha256', $result['salt'] . hash('sha256', $password) );
if($hash != $result['password']) //incorrect password
    {

      header('Location: index.php?errorCode=2');

       exit;
        }
        else
        {
            validateUser(); //sets the session data for this user
            Header("Location: index.php");
        exit;
        } 
        }
           } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:04:01.653

您忘记执行该语句 - 您只需要`$stmt->execute();`在绑定参数后运行。

-- 编辑 --
并删除该行：`$userData = $dbh->query($stmt);`; 您的行将`$result`与您当前的代码一起被提取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:07:36.927

除了缺少的`execute`陈述之外，这永远不会起作用：

```
Header("Location: index.php");
$errmessage = "Invalid user";
print "<p id\"errmessage\"> $errmessage </p>";
exit; 
```

重定向后，浏览器将立即加载`index.php`，因此您将永远不会看到错误消息。您应该重定向**或**显示错误消息，但不能同时显示**。**

# css - 如何格式化最近点击的链接

> ID：15116630
> 
> 赞同：0
> 
> 时间：2013-02-27T16:02:06.810
> 
> 标签：css, hyperlink

我想知道是否可以仅格式化最近单击的链接，以便我可以使用它来显示用户在哪个页面上？我的代码目前看起来像这样：e-loa

```
.topbar a:link {color:#999}
.topbar a:visited {color:#999;}
.topbar a:hover { color:#666;}
.topbar a:active {color:#CCC;} 
```

理想情况下，我希望活动链接在它链接到的页面加载时保持活动状态，以便链接颜色较浅，以向用户显示他们所在的页面，但显然这是不可能的。我也喜欢任何关于更好的方法的建议，毫无疑问有很多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:34:12.593

没有使用 CSS 的解决方法。您需要在标记中定义处于活动状态的链接。例如：

```
<nav class="topbar">
  <a href="1.html" class="active"></li>
  <a href="2.html"></li>
  <a href="3.html"></li>
</nav> 
```

您必须在标记本身中执行此操作，然后创建如下样式：

```
.topbar a.active {color:#red;} 
```

您还可以通过使用一些 javascript 来完成该链接上的课程。这可以找出您所在的页面并将该类添加到该特定链接元素。

:active 选择器仅定义您在链接上按下的那一刻的样式。这有点像 Button Pressed Down 风格。很高兴向用户反馈链接被实际点击并给人一种很好的感觉。但它不会突出显示最近点击过的链接。

# javascript - 用于 document.innerHTML 更改的 onready/onload

> ID：15116631
> 
> 赞同：0
> 
> 时间：2013-02-27T16:02:07.800
> 
> 标签：javascript, callback, onload, icanhaz.js

我正在使用 iCanHaz.js 来交换屏幕，但我需要一个函数来在新内容完全加载完成后触发。我以前可以通过使用 0 的 setTimeout 使调用异步来做到这一点，但是在有很多图像的页面上，这似乎还不够快。

```
function show_page(){
   document.getElementById('container').innerHTML = ich.artworks({
      variables : variables
   });
   window.setTimeout(function(){
       var midWidth = (document.body.offsetWidth/2) - window.innerWidth / 2;
      var midHeight = (document.body.offsetHeight/2) - window.innerHeight / 2;
      scrollTo( midWidth, midHeight);
   }, 0);
} 
```

我怎样才能延迟这个功能，直到知道高度？即使我知道高度，我也无法滚动到页面当前高度以下的点，所以如果我不知道它们的高度，我必须等到图像加载完毕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:18:31.900

您必须稍微修改基于模板的方法，但如果您使用创建图像`new Image()`，则可以使用`onload`事件来确定所有图像何时加载，然后设置尺寸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:21:40.000

有一个类似的案例：

[我如何知道对 jquery html() 的更改何时完成？](https://stackoverflow.com/questions/2570061/how-can-i-tell-when-changes-to-jquery-html-have-finished)

建议的解决方案是为要在 HTML 渲染后执行的代码添加超时 1（而不是 0），因为超时代码在 JavaScript 唯一线程完成其渲染内容后执行。

希望这适用于您的情况。

# actionscript-3 - AS3 中子精灵的坐标

> ID：15116632
> 
> 赞同：0
> 
> 时间：2013-02-27T16:02:10.343
> 
> 标签：actionscript-3, coordinates, sprite

我有一个更大的项目，但我可以将问题缩小到这个例子：

```
public function Main() 
    {
        var myContainer:Sprite = new Sprite;
        myContainer.graphics.beginFill(0xFFFFFF);
        myContainer.graphics.lineStyle(1);
        myContainer.graphics.drawRect(10, 10, 300, 300);
        myContainer.graphics.endFill();
        addChild(myContainer);
        trace('Container coords: ' + myContainer.x + ' ' + myContainer.y);
        trace('Instance coords: ' + getChildAt(numChildren - 1).x + ' ' + getChildAt(numChildren - 1).y);
        var spr:Sprite = new Sprite;
        spr.graphics.beginFill(0xFF0000);
        spr.graphics.lineStyle(1);
        spr.graphics.drawCircle(30, 30, 10);
        spr.graphics.endFill();
        myContainer.addChild(spr);
        trace('Child coords: ' + spr.x + ' ' + spr.y);
        trace('Child instance coords: ' + myContainer.getChildAt(myContainer.numChildren - 1).x + ' ' + myContainer.getChildAt(myContainer.numChildren - 1).y);
    } 
```

输出是这样的：

```
Container coords: 0 0
Instance coords: 0 0
Child coords: 0 0
Child instance coords: 0 0 
```

有人可以解释如何在精灵中获取子精灵的实际坐标（本地或全局，我知道你可以在两者之间转换）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:16:41.453

你`myContainer`没有设置 x,y。仅已设置图形绘制坐标（10,10）。`spr`反之亦然。

请参阅以下代码。此代码有些不同，但视觉输出相同。设置为 10 父的坐标。绘制坐标集 (0,0)。所以 myContainer x,y 是 10，我想，你有点误会了。`getChildAt(numChildren-1)`是`myContainer`。所以这个坐标也一样。myContainer 没有任何孩子。[`graphics`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Graphics.html)不是小孩子的概念。此外，子坐标是相对于父坐标的。

```
var myContainer:Sprite = new Sprite;
myContainer.x = 10;
myContainer.y = 10;
myContainer.graphics.beginFill(0xFFFFFF);
myContainer.graphics.lineStyle(1);
myContainer.graphics.drawRect(0, 0, 300, 300);
myContainer.graphics.endFill();
addChild(myContainer);

//myContainer.x = 10, myContainer.y=10
//getChildAt(numChildren - 1).x = 10, getChildAt(numChildren - 1).y = 10 
```

您的代码如下：

![在此处输入图像描述](../Images/1b7f77e0fbe57ff2941bc08d5310113f.png)

我的代码如下：

![在此处输入图像描述](../Images/46bef656c64c46ec398dbc0094a0ac3f.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:32:40.003

试试这个！

```
var point:Point = new Point(spr.x, spr.y);
point = localToGlobal(point);
trace('Child coords: ' + point); 
```

# css - 边缘出血是 WebKit 中的错误吗？

> ID：15116633
> 
> 赞同：0
> 
> 时间：2013-02-27T16:02:12.323
> 
> 标签：css, html, webkit, render

我不确定这是一个错误还是这里有一些神秘的 CSS 规则。基本上，子元素上的边距设置将在其父元素之外实现，即使父元素足够大以容纳子元素并且它的边距完全。

这是一个演示这一点的小型 HTML 文档：[https](https://gist.github.com/skid/5048988) ://gist.github.com/skid/5048988 。这发生在 Chrome 25 上，但不在 Firefox 14 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:08:27.157

[来自@Yosyhi 评论](https://developer.mozilla.org/en-US/docs/CSS/margin_collapsing)：块的顶部和底部边距有时会组合（折叠）成单个边距，其大小是组合到其中的最大边距，这种行为称为边距折叠。

保证金崩溃发生在三种基本情况下：

*   相邻的兄弟姐妹
*   父母和第一个/最后一个孩子
*   空块

# ember.js - 断言失败：指定了出口（菜单），但此视图将在根级别呈现

> ID：15116634
> 
> 赞同：2
> 
> 时间：2013-02-27T16:02:12.463
> 
> 标签：ember.js, ember-router

当我在我的应用程序的根级别上渲染一个额外的出口时，我遇到了这个奇怪的断言错误。

这是我使用的代码：

```
<div id="app">
   <nav>{{outlet "menu"}}</nav>
   <div class="content">{{outlet}}</div>
</div> 
```

我有一个名为`menu`. 这是我的 App.ApplicationRout

```
app.ApplicationRoute = Ember.Route.extend({
    renderTemplate: function() {
        this.render();
        this.render("menu", {
            outlet: "menu"
        });
    }
}); 
```

但它抛出一个错误：`assertion failed: An outlet (menu) was specified but this view will render at the root level`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T16:02:12.463

我发现了问题，在根级别你应该在 -function 中传递`into`-property `render`：

```
app.ApplicationRoute = Ember.Route.extend({
    renderTemplate: function() {
        this.render("menu", {
            outlet: "menu",
            into: 'application'
        });
        return this._super.apply(this,arguments);
    }
}); 
```

现在它渲染得很好。

# .net - 在实体框架的上下文中实现业务逻辑

> ID：15116638
> 
> 赞同：0
> 
> 时间：2013-02-27T16:02:17.053
> 
> 标签：.net, entity-framework, entity-framework-4

我浏览了 Web 上的许多页面，这些页面涉及如何在实体框架的上下文中最好地将业务对象和数据对象放在一起。但是，找不到一个清晰直接的答案，因此，让我感到困惑，我仍然不确定在使用 EF 时哪种方式是实现我的业务逻辑的最佳方式（如果我坚持在单独的层上）。

*   使用实体框架是否意味着您的业务对象现在应该或最好集成/嵌入到您的“数据访问层”/EF 应用程序中。这是否意味着不需要业务逻辑“层”。

*   如果在使用 EF 时可以有一个单独的“业务逻辑层”，这是如何实现的（找不到任何可以涵盖这一点的示例或指南）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T08:05:45.843

这是建议的答案，但是，我想获得第二意见，好像这是经验丰富的专业人员可以接受的程序。

[http://aspalliance.com/1943_ASPNET_40_and_the_Entity_Framework_4__Part_4__A_3_Layered_Approach_to_the_Entity_Framework.all](http://aspalliance.com/1943_ASPNET_40_and_the_Entity_Framework_4__Part_4__A_3_Layered_Approach_to_the_Entity_Framework.all)

# c - 在 C 中返回一个字符串

> ID：15116639
> 
> 赞同：1
> 
> 时间：2013-02-27T16:02:18.667
> 
> 标签：c, dynamic

我试图`char`从内存中返回一个数组，我只是得到一些随机值。我不知道出了什么问题。这是我的代码：

堆栈.h：

```
struct node{
    char s[MAX_STRING_SIZE];
    struct node * next;
};

typedef struct {
    struct node * head;
} stack; 
```

堆栈.c：

```
char * pop(stack * my_stack){
    if (my_stack->head == NULL){
        printf("Stack is empty.");
        exit(0);
    } else {
        struct node * tmp = my_stack->head;
        char * s = tmp->s;

        my_stack->head = my_stack->head->next;

        free(tmp);

        return s;
    }
} 
```

主.c：

```
char * s2 = pop(&my_stack);
printf("%s\n", s2); 
```

这只会将一些随机值打印到控制台。我检查并弹出正确地从内存中删除节点。如何正确返回此字符串？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T16:03:45.130

线

```
free(tmp); 
```

释放包含您返回的字符串的内存。（一旦被释放，内存可以在任何时候重用。在某些情况下，它也可能变得无法从您的进程中读取。大概您看到的是“随机值”，因为您正在运行一个调试构建，其中堆管理器立即设置释放内存到不同的值。）

有几种方法可以解决此问题，包括

*   更改`pop`为 return `node*`，将调用者留给`free`弹出的节点
*   return `void` from `pop`, printing the value of `s` inside `pop` before `tmp` is freed
*   allocate memory inside `pop`, copying `tmp->s` into this then returning this newly allocated block (which the caller would have to free). I don't recommend this; having a stack popping function which fails in low memory would be very odd...

# java - 零是 Android 中 ScheduledThreadPoolExecutor 的有效 corePoolSize 吗？

> ID：15116647
> 
> 赞同：2
> 
> 时间：2013-02-27T16:02:40.360
> 
> 标签：java, android, scheduled-tasks, threadpoolexecutor

[文档](http://developer.android.com/reference/java/util/concurrent/ScheduledThreadPoolExecutor.html#ScheduledThreadPoolExecutor%28int%29)说如果 corePoolSize 小于零，构造函数会抛出 IllegalArgumentException。这表明零是一个有效值，这意味着不在池中保留任何空闲线程。这在实践中真的有效吗？ [这个非 Android 特定的问题](https://stackoverflow.com/questions/2335702/scheduledthreadpoolexecutor-and-corepoolsize-0)表明，这将导致永远不会创建线程，也不会执行任何计划任务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:02:40.360

**不**，这实际上不适用于 Android，但出于不同的原因。虽然在 Android 上为 corePoolSize 传递零**确实**允许在池中创建线程并执行计划任务，但似乎有一个**错误**导致**ScheduledThreadPoolExecutor****旋转**，不断创建和拆除线程，破坏性能和甚至可能使 Eclipse 无响应。

# java - 如何在 Jelastic Tomcat 中引用 DLL 文件

> ID：15116648
> 
> 赞同：0
> 
> 时间：2013-02-27T16:02:44.083
> 
> 标签：java, servlets, ddl, jelastic

我已经在 tomcat 服务器中成功开发和部署了一个 java servlet。

但是在那个 servlet 中，我调用了一个 dll 文件。在我运行tomcat服务器的计算机上，我调用了我使用的库`System.load("C:/java/src/calldllfile.dll");`，它工作正常。

问题是在jelastic tomcat中我真的不知道我应该使用什么路径以及我应该将我的dll文件放在哪里让我的servlet调用......我尝试在我的代码中捕获它返回一个UnsatisfiedLinkError所以它真的必须是路径...

在下面评论中的jelastic论坛中的类似答案之后，我尝试将我的文件设置到主文件夹并调用它

`System.loadLibrary(System.getProperty("user.home")+"/"+"calldllfile.dll");` 但它没有用。

所以我真的不知道该怎么做......我在我部署的 servlet 的图像下面包含了我无法调用的 dll 库的位置。如果有人告诉我应该在 System.load("?????"); 中使用什么路径，那将非常有帮助。谢谢

![在此处输入图像描述](../Images/471a7af36d62aacc42704eb4e07b8764.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T20:20:03.003

文件夹**webapps**和**home**位于同一级别，它们的根文件夹是**/opt/tomcat/**（等效于环境变量 CATALINA.HOME -[部分 docs](http://jelastic.com/docs/environment-variables)）。如果您谈论的是绝对位于您的上下文（例如 ROOT）下的 WEB-INF 文件夹，要获得它，您需要使用 /opt/tomcat/webapps/ROOT/WEB-INF （或 System.getProperty("catalina.主页")+ "webapps/ROOT/WEB-INF/")。

关于 .dll 库，您可以检查[一下](http://community.jelastic.com/index.php/topic/543-tomcat-dll-access/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-17T17:45:19.007

我知道这是一个旧线程，但答案可能对某人有用。

要从 Tomcat 安装访问主文件夹，您必须使用真实路径`/opt/tomcat/`

这样您就可以使用路径访问您的dll`/opt/tomcat/temp/calldllfile.dll`

# selenium - 使用 selenium2library 和机器人框架验证页面中是否存在 2 个文本中的一个文本

> ID：15116652
> 
> 赞同：5
> 
> 时间：2013-02-27T16:02:53.180
> 
> 标签：selenium, selenium-webdriver, robotframework

我想测试页面是否包含“TEXT1”或“TEXT2”。

页面应包含 TEXT1 或 TEXT2。

有什么建议我该怎么做？目前我只能检查一个文本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T13:26:06.233

您可以使用

[`Page Should Contain Element`](http://rtomac.github.com/robotframework-selenium2library/doc/Selenium2Library.html#Page%20Should%20Contain%20Element)

带定位器

```
xpath=//*[contains(text(),'TEXT1') or contains(text(),'TEXT2')] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-03T20:39:12.497

使用以下三个语句：

如果 '${var1}' == 'TEXT1' 则通过执行

如果 '${var1}' == 'TEXT2' 则通过执行

失败

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T13:43:21.640

感谢斯莱尼克提供的信息。

我还发现了另一种仅使用 Robot Framework 来解决此问题的方法，就像这样。

@{VAR1} = 运行关键字并忽略错误 等待页面包含 TEXT1 运行关键字如果 '@{VAR1}[0]' == 'FAIL' 等待页面包含 TEXT2

因为文本可以是 TEXT1 或 TEXT2，具体取决于场景。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-20T08:56:09.383

```
${t1 present}=  Run Keyword And Return Status  Page Should Contain  TEXT1
Run Keyword If  not ${t1 present}  Page Should Contain  TEXT2 
```

第 1 行之后`${t1 present}`是`True`是否存在 TEXT1；如果是这样，则不会运行第 2 行的检查。如果是`False`，则检查页面是否有 TEXT2 - 如果它不存在，则会失败。

# css - 如何在 grails 2.2 中停用 css 预处理？

> ID：15116654
> 
> 赞同：2
> 
> 时间：2013-02-27T16:02:57.037
> 
> 标签：css, grails

将这些行添加到我的 style.css 文件后，我没有在前端/浏览器中获得预期的回报。`resources:/`我得到了字体路径之前包含的css文件的预处理版本。我不想要这种预处理。我怎样才能停用它？我认为这是执行此操作的资源插件。

我正在使用 Grails 2.2。

CSS：

```
@font-face{
font-family:'FontAwesome'; 
src:url('../font/fontawesome-webfont.eot?v=3.0.1');
src:url('../font/fontawesome-webfont.eot?#iefix&v=3.0.1') format('embedded-opentype'),
url('../font/fontawesome-webfont.woff?v=3.0.1') format('woff'),
url('../font/fontawesome-webfont.ttf?v=3.0.1') format('truetype');
font-weight:normal;
font-style:normal } 
```

输出：

```
@font-face{
font-family:'FontAwesome'; 
src:url('resource:/font/fontawesome-webfont.eot?v=3.0.1');
src:url('resource:/font/fontawesome-webfont.eot?#iefix&v=3.0.1') format('embedded-opentype'),
url('resource:/font/fontawesome-webfont.woff?v=3.0.1') format('woff'),
url('resource:/font/fontawesome-webfont.ttf?v=3.0.1') format('truetype');
font-weight:normal;
font-style:normal } 
```

我只想从预处理中排除一个 css 文件。不是所有的 css 文件。

# django - 在 Django Rest Framework 选项请求中显示过滤器和排序

> ID：15116658
> 
> 赞同：8
> 
> 时间：2013-02-27T16:03:07.123
> 
> 标签：django, django-rest-framework

我正在使用 Django Rest Framework，我注意到在 API 的 Web 可浏览部分有一个名为“选项”的按钮，单击它会显示以下内容...

```
HTTP 200 OK Vary: Accept Content-Type: text/html Allow: HEAD, GET, OPTIONS
{
    "parses": [
        "application/json", 
        "application/x-www-form-urlencoded", 
        "multipart/form-data"
    ], 
    "renders": [
        "application/json", 
        "text/html"
    ], 
    "name": "Products", 
    "description": "API endpoint."
} 
```

我的问题是，无论如何我可以在这里列出所有过滤器选项以及此网址的其他内容吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T16:43:56.557

您可以`OPTIONS`通过覆盖`.metadata()`视图上的方法来返回任何您想要的东西。

见这里：[https ://github.com/tomchristie/django-rest-framework/blob/master/rest_framework/views.py#L340](https://github.com/tomchristie/django-rest-framework/blob/master/rest_framework/views.py#L340)

* * *

**截至 2015 年的更新**：我们现在有一个可定制的元数据 API，使这更容易： http: [//www.django-rest-framework.org/api-guide/metadata/](http://www.django-rest-framework.org/api-guide/metadata/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-12-23T00:55:34.120

你完全可以做到这一点。这是一个[自定义元数据类](http://www.django-rest-framework.org/api-guide/metadata/)，我一直在 StackOverflow 上保持最新状态。这只是列出了所有可用的过滤器、它们的类型和它们的选择。它还列出了类中可用的排序字段：

```
class SimpleMetadataWithFilters(SimpleMetadata):

    def determine_metadata(self, request, view):
        metadata = super(SimpleMetadataWithFilters, self).determine_metadata(request, view)
        filters = OrderedDict()
        if not hasattr(view, 'filter_class'):
            # This is the API Root, which is not filtered.
            return metadata

        for filter_name, filter_type in view.filter_class.base_filters.items():
            filter_parts = filter_name.split('__')
            filter_name = filter_parts[0]
            attrs = OrderedDict()

            # Type
            attrs['type'] = filter_type.__class__.__name__

            # Lookup fields
            if len(filter_parts) > 1:
                # Has a lookup type (__gt, __lt, etc.)
                lookup_type = filter_parts[1]
                if filters.get(filter_name) is not None:
                    # We've done a filter with this name previously, just
                    # append the value.
                    attrs['lookup_types'] = filters[filter_name]['lookup_types']
                    attrs['lookup_types'].append(lookup_type)
                else:
                    attrs['lookup_types'] = [lookup_type]
            else:
                # Exact match or RelatedFilter
                if isinstance(filter_type, RelatedFilter):
                    model_name = (filter_type.filterset.Meta.model.
                                  _meta.verbose_name_plural.title())
                    attrs['lookup_types'] = "See available filters for '%s'" % \
                                            model_name
                else:
                    attrs['lookup_types'] = ['exact']

            # Do choices
            choices = filter_type.extra.get('choices', False)
            if choices:
                attrs['choices'] = [
                    {
                        'value': choice_value,
                        'display_name': force_text(choice_name, strings_only=True)
                    }
                    for choice_value, choice_name in choices
                ]

            # Wrap up.
            filters[filter_name] = attrs

        metadata['filters'] = filters

        if hasattr(view, 'ordering_fields'):
            metadata['ordering'] = view.ordering_fields
        return metadata 
```

把它放在你的项目中的某个地方，然后设置你的`DEFAULT_METADATA_CLASS`，你应该已经准备好了，你的`OPTIONS`请求上有一个新的键，如下所示：

```
"filters": {
    "sub_opinions": {
        "type": "RelatedFilter"
    },
    "source": {
        "type": "MultipleChoiceFilter",
        "choices": [
            {
                "display_name": "court website",
                "value": "C"
            },
        ]
    }
    ...more...
} 
```

这也将显示`choices`，反映它在 DRF 中其他地方的处理方式。

# javascript - 在 Windows 8 和 Windows Phone 8 上使用带有 HTML5/Javascript 的 F# 可移植库

> ID：15116664
> 
> 赞同：6
> 
> 时间：2013-02-27T16:03:22.230
> 
> 标签：javascript, html, windows-8, f#, windows-phone-8

抱歉，如果这已经得到回答，但其他帖子已经过时了。

我想用 HTML5 和 JavaScript 构建一个 Windows 8 应用程序，该应用程序使用 F# 可移植库项目来完成繁重的计算工作。这是允许的吗？当我尝试从 JS 项目 VS2012 中添加对我的 F# 项目的引用时给了我一个错误，但无论如何让我添加它，这以后会在我面前爆炸吗？我也想做一个Windows Phone 8版本

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T20:15:04.647

JavaScript Metro 应用程序不能直接调用 .net 库。为了使 javascript 能够调用您的 F# 库，您应该将其转换为 Windows 运行时组件 (winmd)。现在，我不能 100% 确定是否可以使用 F# 制作 winmd，因为官方官方只支持 c# 和 VB。在 WP8 端，javascript 无法直接调用 .net 或 winmd 库，因此您必须手动桥接 js 和 .net。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T02:20:39.483

据我所知，当前的 F# 编译器无法创建 WINMD 组件（Denis 提到），因此您将无法直接从 JavaScript 调用 F# 代码。可能（但我不确定！）将 F# 库创建为可移植库，并从编译为 WINMD 组件的 C# 项目中引用它，然后从 JavaScript 中引用*它。*这增加了一个额外的步骤，因此可能有点不方便。

[请将此作为对Visual Studio UserVoice](http://visualstudio.uservoice.com/forums/121579-visual-studio/category/30935-languages-f-)的反馈提交。如果更多人投票明确表示这对他们来说是一个重要的场景，则更有可能添加！

或者，正如 Ramon 所提到的，有一些工具可以将 F# 转换为 JavaScript，并允许您将 F# 代码作为 JavaScript 运行（并直接从 JS 调用它）：

*   [WebSharper](http://www.websharper.com/home)是一款受支持的商业产品，在 AGPL 许可下具有开源版本。
*   [FunScript](https://github.com/ZachBray/FunScript)是最近在 Apache 2.0 下提供的开源社区项目

我只有 FunScript 的经验（效果很好并且有一些不错的功能），但是 WebSharper 已经存在了更长的时间，所以我认为它更可靠。它还添加了基于*formlet*（和类似模式）的更复杂的 GUI 框架，而 FunScript 通过导入 TypeScript 定义的类型提供程序简单地提供对 JQuery 的类型安全访问。

# ruby - 是否可以在任务要求中对同一命名空间中的多个任务使用简写？

> ID：15116666
> 
> 赞同：0
> 
> 时间：2013-02-27T16:03:25.207
> 
> 标签：ruby, rake, rakefile

这是一个示例 Rakefile

```
namespace :install do
   task :baz do
       ...
   end

   task :quux do
       ...
   end
end

task :foo => ['bar:baz','bar:quux'] do
    ...
end 
```

是否可以写类似的东西`task :foo => ['bar' => ['baz', 'quux']] do`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:26:07.033

这是做不到的。我刚刚在源代码中进行了挖掘，如果必须：结帐[resolve_args_with_dependencies](https://github.com/jimweirich/rake/blob/master/lib/rake/task_manager.rb#L95)。在那里，你需要做一些可怕的事情来完成这项工作。我不会推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:17:24.627

你离实现这一目标只有一个超级黑客猴子补丁，但我不建议这样做。这将创建一个非标准的依赖关系。如果您可以批准拉取请求，那么嘿，无论如何。

如果您担心这样的事情，为什么不直接使用较短的别名呢？

# android - 获取给定号码的 CONTACT_ID

> ID：15116668
> 
> 赞同：0
> 
> 时间：2013-02-27T16:03:34.393
> 
> 标签：android

我正在尝试创建一个将 a`String`作为参数的函数，它将返回`Contact_ID`具有所提供电话号码的联系人的`String`。

我已经找到以下代码

```
private String getContactName (String number) 
{
    String contactName = "";
    ContentResolver context = getContentResolver();

    /// number is the phone number
    Uri lookupUri = Uri.withAppendedPath(
    PhoneLookup.CONTENT_FILTER_URI, 
    Uri.encode(number));

    String[] mPhoneNumberProjection = { PhoneLookup._ID, PhoneLookup.NUMBER, PhoneLookup.DISPLAY_NAME };

    Cursor cur = context.query(lookupUri,mPhoneNumberProjection, null, null, null);
    try 
    {
       if (cur.moveToFirst()) 
       {
          contactName = cur.getString(2);
          return contactName;
       }
    } 
    finally 
    {
        if (cur != null)
            cur.close();
    }
    return contactName;
} 
```

它返回给定号码的所有contactName。我如何从这里获取联系人 ID？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:45:14.113

您只需替换`cur.getString(2)`为`cur.getString(0)`. 您已经将`_ID`作为投影的一部分（顺便说一句，可以将其简化为`_ID`）。

# php - 如何屏蔽用户？

> ID：15116672
> 
> 赞同：5
> 
> 时间：2013-02-27T16:03:43.727
> 
> 标签：php, networking, ip

我想创建一个阻止用户而不是整个网络（调制解调器）的 php 脚本。我知道我可以从调制解调器获取 IP，但是我的服务器如何区分调制解调器后面的用户？有没有可能的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T16:10:16.370

没有办法只阻止一个用户：您可以阻止用户代理和 IP 地址的组合，但用户可以更改浏览器。到目前为止，黑客也可以更改他的用户代理，这几乎是不可能的。

您可以尝试的事情（但它们可能会失败）：

*   阻止 User-Agent 和 IP 的组合
*   设置块 cookie
*   在本地存储中设置一个块条目
*   根据例如已安装的插件或字体创建指纹

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:06:03.123

当用户足够聪明地知道如何清理 cookie 时，如果不阻止 IP，就不可能做你想做的事。

# css - CSS3 - 过渡

> ID：15116675
> 
> 赞同：0
> 
> 时间：2013-02-27T16:03:49.657
> 
> 标签：css, hover, css-transitions

我对 CSS 有一点问题。我正在关注一本书来学习 CSS3，我刚刚发现了函数 Transition。所以我决定尝试一下，我无法弄清楚我错在哪里，希望你能帮助我。

这是我的 Index.html 文件

```
<html>
<head>
    <title>My Test</title>
    <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>

<div class="box"></div>
<div class="ssin"></div>

</body>
</html> 
```

没什么特别的 ！这是 main.css

```
.box{
    height: 200px;
    width: 200px;
    background-color: #333333;
}

.ssin{
    height: 200px;
    width: 200px;
    background-color: red;
}

.box:hover .ssin{
    width: 500
} 
```

我认为问题就在这里......

```
.box:hover .ssin{
    width: 500;
} 
```

如果我 .box 没有任何反应，理论上它应该改变 ssin div 的宽度。

你能帮我吗（我知道这很愚蠢，但我还在学习）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:06:43.380

您缺少`width`属性的测量值，但您的标记不允许您尝试实现的目标。

`.box:hover .ssin`只会在`.ssin`是 的孩子时触发`.box`。如果您想为悬停`.ssin`时的宽度设置动画，`.box`则必须使用 CSS ( `+`) 中的相邻兄弟选择器：

```
.box:hover + .ssin {
    width: 500px;
} 
```

如果您希望元素具有动画效果，还需要添加相关的 CSS 属性：

```
.ssin {
    -webkit-transition: width 0.2s linear;
       -moz-transition: width 0.2s linear;
            transition: width 0.2s linear;
} 
```

这是一个[**jsFiddle 演示**](http://jsfiddle.net/Ph2jH/1/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T16:10:07.187

在您在那里发布的 HTML 中，`ssin`不在`box`. `.box:hover .ssin`选择`ssin`里面有类的东西`box`。我相信您在这里想要的是相邻的兄弟选择器：`.box:hover + .ssin`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T16:06:33.443

试试这个，

```
.box:hover .ssin{
    width: 500px;
} 
```

我认为`width: 500px;`是失踪

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T16:17:37.273

由于您正在尝试研究 CSS3 过渡，因此我假设您正在尝试增加框的大小。所以，你的标记有点错误。`ssin`应该在里面`.box`

```
<div class="box">
    <div class="ssin"></div>
</div> 
```

并将转换 css 添加到您的代码中

```
.ssin {
    -webkit-transition: all 0.5s linear;
       -moz-transition: all 0.5s linear;
            transition: all 0.5s linear;
} 
```

# c++ - 擦除 `std::list` 的 `end()` 的行为是什么？

> ID：15116676
> 
> 赞同：9
> 
> 时间：2013-02-27T16:03:57.673
> 
> 标签：c++, stl, iterator

我需要从 a 中删除一个元素，`std::list`然后用`std::find`. `std::list::erase`用`end()`列表调用的行为是什么？我的情况是这样的：

```
std::list<T> mylist;
T value;
std::list::iterator it = std::find(mylist.begin(), mylist.end(), value);
std::list::iterator next = mylist.erase(it); 
```

[cplusplus.com](http://www.cplusplus.com/reference/list/list/erase/)说：

> 如果位置（或范围）**有效**，则函数从不抛出异常（不抛出保证）。否则，它会导致未定义的行为。

但我不知道`end()`那里是否被认为是有效的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-27T16:09:14.117

该站点使用模糊（并且可以说是不正确的）术语“有效”，但库规范（C++11 23.2.3）使用更具体的术语“可取消引用”——这意味着迭代器必须引用一个对象。过去的迭代器是不可取消引用的，因此擦除它会产生未定义的行为。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-27T16:05:46.970

它不是。尝试擦除`end()`会导致未定义的行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T16:08:19.667

end() 返回一个迭代器，它引用列表容器中的最后一个迭代器，而不是列表中的最后一个对象。

通过删除/擦除结束，您正在删除列表范围之外。您的代码应该是：

```
std::list<T> mylist;
T value;
std::list::iterator it = std::find(mylist.begin(), mylist.end(), value);
If(it!=mylist.end())
  std::list::iterator next = mylist.erase(it); 
```

此外，如果 find() 未能在您的列表中找到一个值，它将返回结束迭代器，它基本上告诉您您正在搜索的值在您的列表之外（不在您的列表中）

# css - 负边距响应流体/固定列 - 导航不起作用

> ID：15116682
> 
> 赞同：0
> 
> 时间：2013-02-27T16:04:13.977
> 
> 标签：css, responsive-design

我在这里有一个演示来说明我的问题。

[http://www.ttmt.org.uk/forum/](http://www.ttmt.org.uk/forum/)

这是一个简单的响应式 3 列布局，其中两个导航列（左）是固定宽度，内容列（右）是流动的。

我已经在固定宽度列滑入的内容列上使用负右边距来完成此操作。

调整页面大小时，导航栏应移动到内容上方。

我的问题是固定宽度列中的链接不起作用。当页面调整大小并且导航移动到内容上方时，导航再次起作用。

我尝试将固定宽度列的 html 放在内容下方，并且导航再次工作，但是当窗口调整大小时，导航低于内容。

[http://www.ttmt.org.uk/forum/index1.html](http://www.ttmt.org.uk/forum/index1.html)

我假设导航不起作用，因为它在内容中，但我该如何修复它。

```
 <!DOCTYPE html>
    <html>
      <meta charset="UTF-8">
      <title>Title of the document</title>
      <meta name="description" content="">
      <meta name="keywords" content="">
      <meta name="robots" content="">

      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>

      <link rel="stylesheet" href="css/master.css" />

      <!--[if lt IE 9]>
             <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

      <style type="text/css">
        *{
          margin:0;
          padding:0;
        }
        li{
          list-style:none;
        }
        body{
            background:#f5f5f3 url('../images/bg.png') 0 0 repeat-x;
            font:10px sans-serif;
            font-size:1em;
        }
        a{
            color:black;
            text-decoration:none;
        }
        #pageWrap{
            max-width:1000px;
            margin:0 auto;
            border-left: 20px transparent solid;
            border-right: 20px transparent solid;
        }
        /*-----------------
         Structure
        -------------------*/

        header {
          height:50px;
        }

        #rightCol{
            float:right;
            width:100%;
            margin-left:-386px;
        }

        #rightCol #rightCol-inner{
            margin-left:386px;
            background:#fff;
            padding:20px;
        }

        #leftCol,
        #middleCol{
            background:#eee;
            float:left;
        }

        #leftCol{
            width:141px;
            margin:0 10px 0 0;
        }
        #middleCol{
            width:225px;
        }

        #leftCol nav,
        #middleCol ul{
            padding:10px;
        }

        #leftCol nav li,
        #middleCol ul li{
            border-top:1px solid black;
        }
        #leftCol li a,
        #middleCol ul li a{
            display:block;
            padding:10px 12px;
            font-size:1em;
            margin:4px 0;
            color:#555;
        }
        #leftCol li a:hover,
        #middleCol li a:hover{
            background:red;
        }

        /*--------------------
            Media Queries
        ---------------------*/

        @media only screen and (max-width : 780px) {

            #rightCol{
                float:none;
                width:100%;
                margin:0;
            }

            #rightCol #rightCol-inner{
                margin:0;
                background:#fff;
            }

            #leftCol,
            #middleCol{
                float:none;
                display:block;
                margin:10px 0;
                width:100%;
            }

            #leftCol nav{
                float:none;
            }
            #leftCol nav li,
          #middleCol ul li{
            display:inline-block;
            border:0;
          }

            #leftCol li a,
            #middleCol li a{
                display:inline-block;
                padding:10px 12px;
                border-right: 1px solid #999;
                border-top:0;
                border-bottom:0;

            }
        }

      </style>

      </head>

    <body>

        <div id="pageWrap">
          <header>
          </header>    

          <div id="pageContent" class="group">

            <aside id="leftCol">
              <nav>
                <ul>
                  <li><a href="#">Link</a></li>
                  <li><a href="#">Link</a></li>
                  <li><a href="#">Link</a></li>
                  <li><a href="#">Link</a></li>
                </ul>
              </nav>  
            </aside><!--leftCol-->  

            <aside id="middleCol">
              <ul id="second-nav">
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
                <li><a href="#">Link</a></li>
              </ul>
            </aside><!--middleCol-->

            <section id="rightCol">
              <div id="rightCol-inner">

                <div  class="serviceText">
                  <p>
                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                  </p>
                  <p>
                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                  </p>

                  <p>
                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                  </p>

                </div>

              </div><!-- #rightCol-inner -->

            </section><!--rightCol-->  

          </div><!-- pageContent-->  

        </div><!-- #pageWrap -->  

    </body>

    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:11:58.173

```
#rightCol {
    position: relative;
    z-index: -1;
} 
```

请注意，IE < 9 可能需要更多说服力。

# java - 根据后台进程启动进程

> ID：15116685
> 
> 赞同：1
> 
> 时间：2013-02-27T16:04:20.197
> 
> 标签：java, linux, shell, jboss, jenkins

有一些测试在应用服务器（JBoss）中运行；我们想将这些测试集成到 Jenkins 中。

在 Jenkins 中有这些步骤（所有步骤都是 Ant 步骤）：

*   ...（其他步骤）
*   在后台启动服务器
*   运行测试
*   停止服务器
*   ...（其他步骤）

服务器需要在后台启动才能让以下任务完成它们的工作。我编写了以下脚本来模仿这一点：

```
export LAUNCH_JBOSS_IN_BACKGROUND=1
./run.sh &
sleep 400
cd /testTriggerLocation
ant run-tests
kill `cat $jBossHome/4.0.5/bin/jboss.pid` 
```

run.sh 启动服务器并在启动后将 JVM 进程 ID 存储在 jboss.pid 中。

在正常方式（前台进程）中，JBoss 需要大约 100 秒才能启动，但在这里它需要一个取决于 sleep 参数的值。如果我放 200 秒，则需要 ~ 190 - 210 秒，如果是 300 秒，则需要 290 - 310 秒；问题是，如果在服务器启动之前触发测试，它们显然会失败。有没有办法同步这个？或者也许是另一种方式来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:03:29.673

您可能想考虑使用一个简单的进程管理器，例如[supervisord](http://supervisord.org/)或[God](http://godrb.com/)，它可以在您运行测试时为您守护进程。

就我而言，使用上帝我会运行：

```
 god -c my-project.god
 ruby test-runner.rb
 god terminate 
```

# drupal-7 - Drupal 7 和 Dspace 的集成

> ID：15116687
> 
> 赞同：1
> 
> 时间：2013-02-27T16:04:24.827
> 
> 标签：drupal-7, single-sign-on, dspace

我需要将 DSpace 与 Drupal 集成。

我已经安装了 DSpace 并使用了 XMLUI 界面。它工作正常。现在我需要将它与 Drupal 集成，并且我还想使用单点登录系统。

我已经[为 Drupal 尝试了这个 DSpace 模块，](http://drupal.org/project/dspace)甚至按照给出的说明进行操作，但我仍然无法访问 DSpace 内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-14T11:15:26.683

您的问题中有几个不同的组成部分：

**单点登录**

DSpace 支持可堆叠的身份验证方法。根据您希望使用的单点登录，您可能需要考虑不同的方法。可以在此处找到有关身份验证方法的整体文档： [https ://wiki.duraspace.org/display/DSDOC4x/Authentication+Plugins](https://wiki.duraspace.org/display/DSDOC4x/Authentication+Plugins)

**Drupal 对 DSpace 的只读操作**

DSpace 4 附带基于 Jersey 的 REST API [https://wiki.duraspace.org/display/DSDOC4x/REST+API](https://wiki.duraspace.org/display/DSDOC4x/REST+API)

基于此 API，您可以使用如下 Drupal 模块进行集成： [http://drupal.org/project/rest_client](http://drupal.org/project/rest_client) [http://drupal.org/project/clients](http://drupal.org/project/clients)

**从 Drupal 将内容存入 DSpace**

上述 REST API 尚不支持写入操作。但是，DSpace 支持 SWORD 2，这是一个用于促进存款的非常精细的标准。

我不确定是否有用于 SWORD 2 存款的 Drupal 模块。我在这里找到了一个旧的：http: [//drupal.org/project/sword](http://drupal.org/project/sword)

SWORD 2 规范本身可以在以下网址找到： [http ://swordapp.org/](http://swordapp.org/)

# sql - 经纬度转换错误

> ID：15116688
> 
> 赞同：0
> 
> 时间：2013-02-27T16:04:29.803
> 
> 标签：sql, sql-server, tsql

我正在尝试在我的数据库中执行特定查询，但出现以下错误

**表San_Filial**

```
Filial_Id   Name    lat            lon
2           A       -19.926131     -43.924373
3           B       -19.952192     -43.938789
4           C       -19.939626     -43.924541
5           D       -19.95529      -43.92953
6           E       -19.9099       -43.93124
7           F       -19.926191     -43.946067
9           G       -19.97125      -43.96622
14          H       -19.89038      -43.921734
17          I       -19.88838      -43.93059
19          J       -19.94305      -43.94093 
```

**询问**

```
SELECT *
FROM San_Filial 
WHERE San_Filial.Credenciada_Id IN (2,3,4,5,6,7,9,14,17)
AND ACOS(COS(RADIANS(ltrim(San_Filial.lat))) 
* COS(RADIANS(convert(float, -19.926131))) 
* COS(RADIANS(ltrim(San_Filial.lon)) 
- RADIANS(convert(float, -43.924373))) 
+ SIN(RADIANS(ltrim(San_Filial.lat))) 
* SIN(RADIANS(convert(float, -19.926131)))) * 6380 < 5.0 
```

**错误**

```
Mesage 8114, Level 16, State 5, Line 1
Error converting data type varchar to float. 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:25:21.843

首先查看您是否有任何格式不正确的数据：

```
select *
from san_filia1
wHERE San_Filial.Credenciada_Id IN (2,3,4,5,6,7,9,14,17) and
      (isnumeric(lat) = 0 or isnumeric(long) = 0) 
```

从这里，您将看到导致问题的原因，然后您可以解决它。

正确的解决方法可能是这样的：

```
select *
from (select sf.*,
             (case when isnumeric(lat) then cast(lat as float) end) as latf,
             (case when isnumeric(long) then cast(long as float) end) as longf
      from san_filial sf
     ) sf
where . . . -- use Latf and Longf instead of lat and long 
```

您需要在`case`语句中进行转换以保证它按预期工作。SQL 不保证语句的顺序，计算*后*可能会应用过滤器。

# ruby-on-rails - Rails Haml 表单 url 参数 - 如何使 html 表单使用所需的 rails 路由

> ID：15116691
> 
> 赞同：0
> 
> 时间：2013-02-27T16:04:33.260
> 
> 标签：ruby-on-rails, haml, forms

使用 HAML 代码：

```
%form{:action => "activate_foobar", :method => :post, :controller => "foobar", :url => activate_foobar_foobar_index_path}
%input{:type => "submit", :value => "Activate"} 
```

提交按钮指向

```
No route matches "/activate_foobar" 
```

而不是“/foobar/activate_foobar”。它似乎不理解 url 参数。

* * *

## **细节**

在 foobar 的索引页面上，有一个表单，我试图将其发布到 foobar_controller 的方法 activate_foobar。Foobar 没有模型，因为没有这样的对象——它只是 Widget 的一个特殊属性。（小部件有一个模型和一个方法 .activate_foobar）

activate_foobar_foobar_index 在路由中定义为：

```
resources :foobar, :only => [:index] do
  collection do
    post :activate_foobar
  end
end 
```

:用 rake:routes 确认为：

```
activate_foobar_foobar_index POST     /foobar/activate_foobar(.:format)   {:action=>"activate_foobar", :controller=>"foobar"} 
```

: 正如预期的那样。

此外，实验一个简单的：

```
=link_to "Activate", activate_foobar_foobar_index_path, {:method => :post} 
```

:路由成功到 /foobar/activate_foobar

在使用表单（而不是使用 simple_form_for 或其他基于模型的解决方案）的范围内，您如何更正路径“foobar/activate_foobar”？

资料来源：我正在关注[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html) “添加更多 RESTful 操作”和[http://www.w3schools.com/html/html_forms.asp](http://www.w3schools.com/html/html_forms.asp)以尝试了解如何引导表单到正确控制器的正确方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:08:28.097

就像您说的那样，它将表单发送到 /activate_foobar，由于某种原因（可能是 haml 错误），它不采用 :controller 参数来解决这个问题

```
:action => 'foobar/activate_foobar' 
```

但是您必须小心，因为它采用相对路径而不是绝对路径。因此，如果您不想处理该问题，我建议您更改为 rails form helper

```
= form_tag(activate_foobar_foobar_index_path, :method => :post) do 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:34:14.403

由于 activate_foobar 嵌套在 foobar 下，您是否尝试过

```
 :url => activate_foobar_foobar_index_path(@foobar) 
```

你需要告诉 rails 在哪里寻找特定的 foobar 来激活 foobar。

希望能帮助到你。

# c# - 从 GET 方法中读取 WEB API 的值

> ID：15116693
> 
> 赞同：0
> 
> 时间：2013-02-27T16:04:34.100
> 
> 标签：c#, asp.net-web-api

我正在尝试获取 WebAPI 中的项目列表

ajax 方法看起来像这样

```
 $.ajax({
            type: 'GET',
            url: 'api/values',
            data: JSON.stringify({ pageNo: pageNo + 1, pageSize: pageSize }), 
            contentType: 'application/json'
       }); 
```

在值控制器中，我无法获取值。

我的控制器看起来像这样。

```
 public IEnumerable<string> Get([FromURI] pagingInfo)
    {   
        return new string[] { "value1", "value2" };
    } 
```

什么是正确的标准。上述标准是否正确或应该将 pageno 和 pagesize 放在 url 中并创建另一个路由。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:00:18.993

一般不推荐（甚至禁止）通过 GET 发送 body，只有查询字符串有效：

删除方法`JSON.stringify`，你的ajax调用应该是：

```
$.ajax({
    type: "GET",
    url: "/api/values",
    data: { pageNo: 1, pageSize: 2 },
    success: function (data) {
    }
}); 
```

它将自动转换为查询字符串，如果使用`JSON.stringify`，您将在查询字符串中得到 JSON 表示法并使其出错。如果你看一下 Fiddler，使用`JSON.stringify`，URL 是这样的：

```
/api/values?{%22PageNo%22:1,%22PageSize%22:2} 
```

你的行动是直到：

```
public IEnumerable<string> Get([FromURI]PagingInfo pagingInfo)
{   
    return new string[] { "value1", "value2" };
} 
```

# python - 如何在 OSX 10.8 的用户 bash_profile 中设置多个 PATH？

> ID：15116695
> 
> 赞同：5
> 
> 时间：2013-02-27T16:04:41.230
> 
> 标签：python, eclipse, macos, cordova, osx-mountain-lion

我正在寻找使用 Eclipse 在 OSX 10.8 中为 Python 开发和 Phonegap Android 开发设置我的笔记本电脑。我安装了最新版本的 Python (3.3)，它添加了代码：

```
# Setting PATH for Python 3.3
# The orginal version is saved in .bash_profile.pysave
PATH="/Library/Frameworks/Python.framework/Versions/3.3/bin:${PATH}"
export PATH 
```

到我的 .bash_profile。在设置 Phonegap 的过程中，您需要使用以下行为 Android 开发工具设置 PATH：

```
export PATH=${PATH}:/Development/android-sdk-macosx/platform-tools:/Development/android-sdk-macosx/tools 
```

是否可以在 .bash_profile 中设置两个 PATH 以便 Python 和 Android 开发可以同时进行？或者我是否需要根据我想做的开发类型在 PATH 之间切换？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T16:08:00.920

是的，您只需将它们都添加到路径列表中：

```
PATH="/Library/Frameworks/Python.framework/Versions/3.3/bin:${PATH}:/Development/android-sdk-macosx/platform-tools:/Development/android-sdk-macosx/tools"
export PATH 
```

这里唯一需要注意的是，如果由于某种原因可能需要在 sdk 路径之一下执行特定于 sdk 的 python 版本，因为其中的版本`/Library/Frameworks/Python.framework/Versions/3.3/bin`将优先。

# java - 如何从字符串中分离字母和符号。（几乎完成）

> ID：15116705
> 
> 赞同：0
> 
> 时间：2013-02-27T16:05:34.187
> 
> 标签：java, string, javac, symbols, letters

```
import java.util.Scanner;

public class Separate {

   public static void main(String[] args) {
         Scanner user_input = new Scanner( System.in ); 
    String variable;
    System.out.print("Enter Variable:");
      variable = user_input.next();
          Separate(variable);
   }

   public static void Separate(String str) {
          String number = "";
          String letter = "";
      String symbol = "";
          for (int i = 0; i < str.length(); i++) {
                 char a = str.charAt(i);
                 if (Character.isDigit(a)) {
                       number = number + a;

                 } else {
                       letter = letter + a;

         }
          }
          System.out.println("Alphabets in string:"+letter);
          System.out.println("Numbers in String:"+number);   
   } 
```

}

好的，我已经有了这个代码来分隔我输入的数字和字母。问题是，当我输入符号时，例如 (^,+,-,%,*) 它也表示为字母。

我想要做的是将符号与字母分开，就像我在数字和字母上所做的那样，并为其制作另一个输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:28:18.850

```
public static void separate(String string) {
        StringBuilder alphabetsBuilder = new StringBuilder();
        StringBuilder numbersBuilder = new StringBuilder();
        StringBuilder symbolsBuilder = new StringBuilder();
        for (int i = 0; i < string.length(); i++) {
            char ch = string.charAt(i);
            if (Character.isAlphabetic(ch)) {
                alphabetsBuilder.append(ch);
            } else if (Character.isDigit(ch)) {
                numbersBuilder.append(ch);
            } else {
                symbolsBuilder.append(ch);
            }
        }
        System.out.println("Alphabets in string: " + alphabetsBuilder.toString());
        System.out.println("Numbers in String: " + numbersBuilder.toString());
        System.out.println("Sysmbols in String: " + symbolsBuilder.toString()); 
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:07:18.893

您正在测试 character `isDigit`，`else`将其视为字母。好吧，如果它不是数字，则所有其他情况都转到`else`您的代码中。也为这些符号创建一个`else`案例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:10:23.830

由于这是家庭作业，只需查看[Character 的文档](http://docs.oracle.com/javase/7/docs/api/java/lang/Character.html)，它具有很好的功能`isDigit`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T16:14:05.180

```
public static void Separate(String str) 
{
    String number = "";
    String letter = "";
    String symbol = "";

    for (int i = 0; i < str.length(); i++) 
    {
        char a = str.charAt(i);
        if (Character.isDigit(a)) 
        {
            number = number + a;
            continue;
        } 
        if(Character.isLetter(a))
        {
            letter = letter + a;
        }
        else
        {
            symbol = symbol + a;
        }
    }
    System.out.println("Alphabets in string:"+letter);
    System.out.println("Numbers in String:"+number);   
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-13T15:16:19.200

```
import java.util.Scanner;

public class Separate {

public static void main(String[] args) {

      Scanner user_input = new Scanner( System.in );

      String variable;

      System.out.print("Enter Variable:");

      variable = user_input.next();

      Separate(variable);
   }

         public static void Separate(String str) 
         {
          String number = "";

          String letter = "";

          String symbol = "";

          for (int i = 0; i < str.length(); i++) {

                 char a = str.charAt(i);

                 if (Character.isDigit(a)) {
                       number = number + a;

                 } else if (Character.isLetter(a)) {
                       letter = letter + a;
                 } else {
                       symbol = symbol + a;
         }
       }
     System.out.println("Alphabets in string:"+letter);
     System.out.println("Numbers in String:"+number);
     System.out.println("Symbols in String:"+symbol);   
   }

} 
```

# gnuplot - Gnuplot 线与抽动重叠

> ID：15116707
> 
> 赞同：1
> 
> 时间：2013-02-27T16:05:38.267
> 
> 标签：gnuplot, lines, overlap

我怎样才能避免我的情节与抽动重叠，我想让它们在前面，情节在背景中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:43:22.740

该命令有一个选项可以`tics`做到这一点：

```
set tics front 
```

# nservicebus - 开发机器的 NServiceBus 许可证文件（不断请求）

> ID：15116708
> 
> 赞同：2
> 
> 时间：2013-02-27T16:05:42.293
> 
> 标签：nservicebus

我已经成功使用 NServiceBus 了，我不知道多久了。许可证声称过期并通知我需要一个新的许可证文件。所以我去了网站并生成了一个新的（用于开发机器）。每次调试时，我都会收到相同的消息，并请求许可证文件。有什么办法可以防止每次我尝试调试时出现此消息？（比如可能以编程方式设置路径？）

![许可证文件](../Images/4a4af232536db91091772e3bcc0ef610.png) <

Andreas：日志文件中唯一提到的许可证如下：

```
2013-03-05 14:24:23,983 [1] [INFO ] [NServiceBus.Licensing.LicenseManager] - No valid license found.
2013-03-05 14:24:23,986 [1] [DEBUG] [NServiceBus.Licensing.LicenseManager] - Trial for NServiceBus v3.3 has expired.
2013-03-05 14:24:23,988 [1] [WARN ] [NServiceBus.Licensing.LicenseManager] - Falling back to run in Basic1 license mode. 
```

这是我选择新文件后提示的快速屏幕截图。只是为了让你知道它是在说它是一个有效的文件。

![在此处输入图像描述](../Images/ecbc28cbcd390c4e1c966286dde1e083.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:00:56.817

我相信如果您的许可证与您正在运行的软件版本不同，也会发生这种情况。您可能需要申请与您的 NSB 版本一致的许可证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T01:37:22.730

收到免费许可证后，您是否将其导入？
您需要单击“浏览...”按钮并选择许可证以导入它！

# elasticsearch - 在elasticsearch中搜索子父级

> ID：15116711
> 
> 赞同：1
> 
> 时间：2013-02-27T16:05:54.490
> 
> 标签：elasticsearch

如果我在弹性搜索中有一个子父映射。我将如何根据孩子的统计数据寻找父母。

例子：

```
{
  'parent':{
    '_id':{
      'path':'parent_id'
    },
    'properties':{
      'parent_id':{
        'type':'string'
      },
      'name':{
        'type':'string'
      },
      'job':{
        'type':'string'
      },
      'age':{
        'type':'integer'
      },

    }
  }
}{
  'child':{
    '_parent':{
      'type':'parent'
    },
    '_id':{
      'path':'child_id'
    },
    'properties':{
      'child_id':{
        'type':'string'
      },
      'name':{
        'type':'string'
      },
      'favorite_toy':{
        'type':'string'
      },
      'age':{
        'type':'integer'
      },

    }
  }
} 
```

我将如何：

1.  得到所有有一个孩子叫“鲍勃”的父母？
2.  计算所有有一个孩子叫“鲍勃”的父母？
3.  得到所有有两个以上孩子的父母？
4.  得到所有有 2 个 5 岁以上孩子的父母？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:41:46.523

1) 和 2) - 您可以简单地将查询包装到 has_child 查询中：

```
{
  "has_child":{
    "type":"child",
    "query":{
      "match":{
        "name":"bob"
      }
    }
  }
} 
```

3）和4）-我认为目前这是不可能的。

# ios - 如何延迟 CABasicAnimation？

> ID：15116712
> 
> 赞同：61
> 
> 时间：2013-02-27T16:05:54.913
> 
> 标签：ios, uikit, core-animation, cabasicanimation

我有一个`CABasicAnimation`并且想在延迟后启动它。在 UIKit 我可以指定延迟。该`CAMediaTiming`协议有一个`timeOffset`属性，但我看不到效果。我的下一个尝试是使用 GCD 来延迟它，但感觉有点矫枉过正。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2013-02-27T16:21:56.403

您不应该使用该`[CAMediaTiming beginTime]`属性（[参考](https://developer.apple.com/documentation/quartzcore/camediatiming/1427654-begintime)）吗？

请参阅[Core Animation Programming Guide](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/AdvancedAnimationTricks/AdvancedAnimationTricks.html)中的*自定义动画时序*。

```
CABasicAnimation *animation;
animation.beginTime = CACurrentMediaTime() + 0.3; //0.3 seconds delay 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-11-16T00:23:45.950

在 Swift 3.0 中：

```
func animateYourView () {
   let myDelay = 5.0
   let scalePulseAnimation: CABasicAnimation = CABasicAnimation(keyPath: "transform.scale")
   scalePulseAnimation.beginTime = CACurrentMediaTime() + myDelay
   scalePulseAnimation.duration = 0.5
   scalePulseAnimation.repeatCount = 2.0
   scalePulseAnimation.autoreverses = true
   scalePulseAnimation.fromValue = 1.0
   scalePulseAnimation.toValue = 0.5
   myView.layer.add(scalePulseAnimation, forKey: "scale")
} 
```

延迟的关键线是：

```
 scalePulseAnimation.beginTime = CACurrentMediaTime() + myDelay 
```

# javascript - 使用jquery对数组进行升序和降序排序

> ID：15116713
> 
> 赞同：1
> 
> 时间：2013-02-27T16:05:56.387
> 
> 标签：javascript, html, css, sorting

我正在尝试对数组进行升序和降序排序。我似乎无法弄清楚如何正确地做到这一点。我尝试了不同的方法，但都没有奏效。当我单击两个按钮时，应该会发生这种情况，一个 ID 为“stigande”升序，一个 ID 为“fallande”降序。有什么解决办法吗？

Javascript

```
$(document).ready(function(){

var $films = [];

// ändra bakgrundsfärg för textfield 
$('#name').keyup(function(){
            $('#name').css('background-color', 'white');
});

// ändra bakgrundsfärg för select lista
$('#options').change(function(){
            $('#options').css('background-color', 'white');
});

// kör funktionen när knappen med id button klickas
$("#button").click(function(){
    var $titelBetyg = [];

    var $titel = $('#name').val();
    var $betyg = $('#options').val();

    // kontrollera om textfield är tom
    if($titel == ""){
        $('#name').css('background-color', 'red');
        alert("Mata in titel.....");
    }

    // kontrollera om select lista inte är vald
    else if($betyg == "0"){
        $('#options').css('background-color', 'red');
        alert("Välj betyg....");
    }
    else{

        $titelBetyg.push($titel);
        $titelBetyg.push($betyg);
        $films.push($titelBetyg);

        var $ul = $('#rightbar ul').empty();
        if (!$ul.length){ // om ul inte finns
            $ul = $("<ul>").appendTo('#rightbar'); // skapa en ny
        }

        // loopa igenom arrayen och placera innehållet i ul och li
        for (var i=0; i<$films.length; i++){
            $ul.append("<li>" + $films[i][0] + " " + $films[i][1] + "</li>");
        }

        $('#form').get(0).reset();

    }
});

// kör funktionen när knappen med id stigande klickas
$('#stigande').click(function(a,b){
    $films.sort();
});

// kör funktionen när knappen med id fallande klickas
$('#fallande').click(function(){
    $films.reverse();   
});

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T16:12:12.817

当您对数组数组进行排序而不是仅对一系列名称进行排序时，您需要对排序做一些稍微不同的事情。

尝试使用这样的东西：

```
function arrSort(arr, subkey){
  //Default to 0 if no subkey is set
  subkey = (subkey===undefined?0:subkey);

  var a = arr.slice(0),
      b = [], x;

  //For each section in the array, create an array containing whatever we are trying to sort by and our unique ID
  for (x in a){
    b[x]=[a[x][subkey], x];
  }

  b=b.sort();

  //Wipe out all the data that's currently in arr!
  arr.splice(0, arr.length);

  for (x in b){
    arr.push(a[b[x][1]]);
  }
  return arr;
} 
```

我相信你会想按 $titel 排序，所以你想实现这样的东西：

```
// kör funktionen när knappen med id stigande klickas
$('#stigande').click(function(a,b){
  arrSort($films, 0);
});

// kör funktionen när knappen med id fallande klickas
$('#fallande').click(function(){
  arrSort($films, 0);
  $films.reverse();   
}); 
```

# iphone - 在 Iphone iOS 中阻止短信

> ID：15116716
> 
> 赞同：-2
> 
> 时间：2013-02-27T16:06:03.133
> 
> 标签：iphone, ios, objective-c, jailbreak

在使用应用程序时，我想阻止所有来电和短信。它至少应该在越狱的iphone上工作。我有这段代码可以阻止通话，但不能阻止短信 - 我该如何解决？

```
 importCoreTelephony/CoreTelephonyDefines.h>

 extern NSString const *kCTSMSMessageReceivedNotification; extern
 NSString const *kCTSMSMessageReplaceReceivedNotification; extern
 NSString const *kCTSIMSupportSIMStatusNotInserted; extern NSString
 const *kCTSIMSupportSIMStatusReady;

 typedef struct __CTCall CTCall; extern NSString
 CTCallCopyAddress(void, CTCall *);

 void * CTSMSMessageSend(id server,id msg); typedef struct
 __CTSMSMessage CTSMSMessage; NSString *CTSMSMessageCopyAddress(void *, CTSMSMessage *); NSString *CTSMSMessageCopyText(void *, CTSMSMessage
 *);

 int CTSMSMessageGetRecordIdentifier(void * msg); NSString *
 CTSIMSupportGetSIMStatus(); NSString *
 CTSIMSupportCopyMobileSubscriberIdentity();

 id CTSMSMessageCreate(void* unknow/always 0/,NSString*
 number,NSString* text); void * CTSMSMessageCreateReply(void*
 unknow/always 0/,void * forwardTo,NSString *text);

 id CTTelephonyCenterGetDefault(void); void
 CTTelephonyCenterAddObserver(id, id, CFNotificationCallback, NSString
 *, void ,int); void CTTelephonyCenterRemoveObserver(id,id,NSString,void*); int
 CTSMSMessageGetUnreadCount(void);

 void * CTCallDisconnect(CTCall *call);

 static void callback(CFNotificationCenterRef center, void *observer,
 CFStringRef name, const void *object, CFDictionaryRef userInfo) {

 NSString *notifyname = (__bridge NSString *)name;

 if ([notifyname
 isEqualToString:@"kCTCallIdentificationChangeNotification"]) {

     NSDictionary *info = (__bridge NSDictionary *)userInfo;

     CTCall *call = (__bridge CTCall *)[info objectForKey:@"kCTCall"];

     NSString *caller = CTCallCopyAddress(NULL, call);

     NSLog(@"RECEIVED CALL: %@", caller);

     CTCallDisconnect(call);

 } }

 static void signalHandler(int sigraised) {

 printf("\nInterrupted.\n"); exit(0); } 
```

在 viewdidload 中：

```
 id ct = CTTelephonyCenterGetDefault();
 CTTelephonyCenterAddObserver(ct, NULL, callback, NULL, NULL,
 CFNotificationSuspensionBehaviorHold);

 sig_t oldHandler = signal(SIGINT, signalHandler); if (oldHandler ==
 SIG_ERR) {

 printf("Could not establish new signal handler"); exit(1); }

 printf("Starting run loop and watching for notification.\n");
 CFRunLoopRun(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:25:47.877

我认为您在以下行中犯了一些语法错误，请检查

```
 id CTSMSMessageCreate(void* unknow/*always 0*/,NSString* number,NSString* text);
void * CTSMSMessageCreateReply(void* unknow/*always 0*/,void * forwardTo,NSString *text); 
```

# jquery - html5画布和jquery的奇怪行为

> ID：15116718
> 
> 赞同：1
> 
> 时间：2013-02-27T16:06:14.723
> 
> 标签：jquery, html5-canvas

我开始玩 html5 画布。我将逐个像素地绘制图。首先，我想逐个像素地制作两个矩形。以下代码有效：

```
<html>
<head>

<%= javascript_include_tag "jquery-1.9.1" %>

<script type="text/javascript" src=""></script>

<script type="text/javaScript">

function plotCanvas2d(mean,nx,nz,canvas)
{

var context = canvas.getContext('2d');

var imageData = context.createImageData(nx,nz);

var kk=0;
var blue;

for (var jj=0; jj<nz; ++jj) {
    for (var ii=0; ii<nx; ++ii) {

        blue = mean[ii][jj]*255;

        imageData.data[kk] = 0;
        imageData.data[kk+1] = 0;
        imageData.data[kk+2] = blue;
        imageData.data[kk+3] = 255;
        kk += 4;
    }
}

context.putImageData(imageData, 0, 0);
}

$(document).ready( function plotFull()
{

var nx = 600;
var nz = 300;

var mean = new Array(nx);

for (var ii=0; ii<nx; ii++)
{
    mean[ii] = new Array(nz);
}

for (var ii=0; ii<nx; ii++) {
    for (var jj=0; jj<nz; jj++)
    {
        mean[ii][jj] = 0.0;
    }
}

// $('#canvas').height(nz);
// $('#canvas').width(nx);
var canvas = document.getElementById('canvas');

for (var jj=0; jj<nz/2; ++jj) {
    for (var ii=0; ii<nx; ++ii) { 
        mean[ii][jj] = 0; }}

for (var jj=nz/2; jj<nz; ++jj) {
    for (var ii=0; ii<nx; ++ii) {
        mean[ii][jj] = 1; }}

plotCanvas2d(mean,nx,nz,canvas)

});      

</script>

</head> 
<body>
<!-- <canvas id="canvas" width="600" height="300"></canvas> -->
<canvas id="canvas" ></canvas>
</body>
</html> 
```

但是如果我取消注释三个注释行，并在 html 正文上注释画布定义，它不会。我正在做一些更复杂的事情，并且能够解决这个问题。如果我在其定义中设置画布的大小，则代码有效。如果我使用 jquery 设置大小，则不会。在第一种情况下，图像是一个蓝色和黑色的矩形，在第二种情况下只有黑色。在更大的代码段中，第二种情况下的行为几乎是不可预测的。我错过了什么？它必须是一些愚蠢的东西，但我就是看不到它......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:17:47.867

如果我理解正确，请尝试使用

```
 $('#canvas').attr('width',600);
 $('#canvas').attr('height',300); 
```

我认为您需要设置宽度和高度属性，因此需要设置 .attr()。

另外，如果使用 jquery，我认为您需要使用：

```
var canvas = $('#canvas')[0]; 
```

将画布传递给您的方法而不是 jquery 对象。

# ios - 应用程序检查更新

> ID：15116719
> 
> 赞同：1
> 
> 时间：2013-02-27T16:06:15.567
> 
> 标签：ios, objective-c, methods

我正在为内部企业应用程序创建更新方法。我要创建的是一个可以快速放入应用程序的类，如果需要更新，它将与服务器检查。这就是我到目前为止所拥有的，它检查正确，但它`NO`在完成方法之前返回。

在我的 checkUpdate.h

```
@interface checkForUpdate : NSObject

+ (BOOL)updateCheck;

@end 
```

在我的 checkUpdate.m

```
#import "checkForUpdate.h"

@implementation checkForUpdate

BOOL needsUpdate
NSDictionary *versionDict;

#define kBgQueue dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0)

+ (BOOL)updateCheck {

    NSString *urlStringVersion = [[NSString alloc] initWithFormat:@"http://URL/app_info?app=app"];
    NSURL *urlVersion = [NSURL URLWithString:urlStringVersion];

    dispatch_async(kBgQueue, ^{
        NSData* data =[NSData dataWithContentsOfURL:urlVersion];

        if (data){
            NSError* error;
            NSArray* json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
            if (json != nil && [json count] != 0) {
                versionDict = [json objectAtIndex:0];

                CGFloat serverVersion = [[versionDict valueForKey:@"version"]floatValue];
                CGFloat appVersion = [[[[NSBundle mainBundle] infoDictionary] objectForKey:(NSString*)kCFBundleVersionKey] floatValue];
                NSLog(@"Server Version %f",serverVersion);
                NSLog(@"App Version %f",appVersion);

                if ([versionDict count] != 0){
                    if (serverVersion > appVersion){
                        [[UIApplication sharedApplication] setApplicationIconBadgeNumber:1];
                        needsUpdate = YES;
                    }else{
                        [[UIApplication sharedApplication] setApplicationIconBadgeNumber:0];
                        needsUpdate = NO;
                    }
                }

            }
        }

    });

    return needsUpdate;

}

@end 
```

我这样称呼它

```
NSLog(@"Needs Update %@",[checkForUpdate checkForUpdateWithResponse] ? @"Yes":@"No"); 
```

这是我的日志

```
 Needs Update No
 Server Version 2.000000
 App Version 1.000000 
```

我不确定为什么它甚至在检查之前就返回 NO。我需要它是异步的，因为应用程序将检查的服务器位于我们的防火墙后面。因此，如果此人在防火墙之外，则应用程序需要在无法访问服务器时继续。我是朝着正确的方向前进，还是有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:25:35.947

由于`dispatch_async`是非阻塞的，因此您的方法在您的更新信息返回之前返回（调度并继续）。`needsUpdate`默认为，`NO`这就是您将看到的。您可以在日志时间中看到这一点 - “需要更新否”显示在服务器和应用程序版本之前。

您需要某种回调（例如委托方法或第二种方法`dispatch_async`）以确保获得正确的结果，或者您需要阻止。我建议查看[`NSURLConnection`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html), 和[`sendAsynchronousRequest:queue:completionHandler:`](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html#//apple_ref/occ/clm/NSURLConnection/sendAsynchronousRequest%3aqueue%3acompletionHandler%3a)- 它将在完成时执行完成处理程序，您可以在其中拥有处理更新所需的任何代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T16:28:42.790

您正在异步检查更新，但由于您的方法设计而期望立即响应。您可以将您的方法重新设计为类似于下面的示例，以便在操作完成时通知处理程序：

注意：未经检查和未经测试的错误；然而，从这个例子中得到的教训是使用各种回调：

**更新检查器类**

```
typedef void (^onComplete)(BOOL requiresUpdate);

@interface UpdateChecker : NSObject
-(void)checkForUpdates:(onComplete)completionHandler;
@end

@implementation UpdateChecker
-(void)checkForUpdates:(onComplete)completionHandler
{
    NSString *urlStringVersion = [[NSString alloc] initWithFormat:@"http://URL/app_info?app=app"];
    NSURL *urlVersion = [NSURL URLWithString:urlStringVersion];
    dispatch_block_t executionBlock = 
    ^{
         /*
             Your update checking script here
             (Use the same logic you are currently using to retrieve the data using the url)
          */
         NSData* data = [NSData dataWithContentsOfURL:urlVersion];
         BOOL requiresUpdate = NO; 
         if (data)
         { 
             ...
             ...
             ...
             requiresUpdate = ...; //<-whatever your outcome
         }

         //Then when completed, notify the handler (this is our callback)
         //Note: I typically call the handler on the main thread, but is not required.  
         //Suit to taste.
         dispatch_async(dispatch_get_main_queue(),
         ^{
             if (completionHandler!=NULL)
                 completionHandler(requiresUpdate);
         });
    };
    dispatch_async(kBgQueue, executionBlock);
}
@end 
```

**当您使用 UpdateChecker 检查整个应用程序的更新时，这就是它的外观**

```
UpdateChecker *checker = [UpdateChecker alloc] init];
[checker checkForUpdates:^(BOOL requiresUpdate)
{
     if (requiresUpdate)
     {
        //Do something if your app requires update
        [[UIApplication sharedApplication] setApplicationIconBadgeNumber:1];
     }
     else         
        [[UIApplication sharedApplication] setApplicationIconBadgeNumber:0];
}]; 
```

# mysql - 内部 JOIN 缺失行

> ID：15116723
> 
> 赞同：0
> 
> 时间：2013-02-27T16:06:23.443
> 
> 标签：mysql, wordpress, inner-join

首先，我想提一下我在 MYSQL 和 JOIN 方面的技能有限。然而，这就是我所拥有的，也是我想要实现的：

我有默认的 WordPress 表，并且喜欢从某个元键中获取包含 post_name、title、status 和 meta_value 的结果。

这就是我所拥有的：

```
SELECT
    wp_posts.ID, wp_posts.post_name, wp_posts.post_title, wp_posts.post_status, wp_postmeta.meta_value
FROM wp_posts
INNER JOIN
    wp_term_relationships ON ( wp_posts.ID = wp_term_relationships.object_id ) 
INNER JOIN
    wp_postmeta ON ( wp_posts.ID = wp_postmeta.post_id ) 
WHERE (
        wp_term_relationships.term_taxonomy_id
        IN ( 1, 2, 3 )
    )
    AND wp_posts.post_type =  'my_post_type'
    AND (
        wp_posts.post_status
    IN (
        'my_status_1',  'my_status_2'
    )
)
AND wp_postmeta.meta_key =  'my_meta_key'
GROUP BY wp_posts.ID
ORDER BY wp_posts.ID ASC 
```

当每个帖子的 postmeta 为“my_meta_key”时，一切都会按预期工作。但是，如果缺少“my_meta_key”，则该帖子不在结果中。

我猜它是由第二次 INNER JOIN 引起的，但如上所述，我不知道应该用什么替换它。

我确定这很简单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:10:52.727

移动`AND wp_postmeta.meta_key = 'my_meta_key'` 到

```
INNER JOIN
    wp_postmeta ON ( wp_posts.ID = wp_postmeta.post_id ) 
```

像这样，将 INNER 更改为 LEFT

```
 LEFT JOIN
        wp_postmeta ON ( wp_posts.ID = wp_postmeta.post_id 
        AND wp_postmeta.meta_key =  'my_meta_key') 
```

如果您将条件放在“Where 子句”中，则左连接将被“覆盖”。我会添加一个建议。当您真的不需要括号以使代码易于阅读时，请不要使用括号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:08:54.737

将桌子`INNER JOIN`上的更改为：`wp_postmeta``LEFT JOIN`

```
LEFT JOIN wp_postmeta 
    ON ( wp_posts.ID = wp_postmeta.post_id ) 
```

`WHERE`并将过滤器移动`wp_postmeta`到`JOIN`条件。

所以您的查询将是：

```
SELECT wp_posts.ID, wp_posts.post_name, wp_posts.post_title, wp_posts.post_status, wp_postmeta.meta_value
FROM wp_posts 
INNER JOIN wp_term_relationships 
    ON ( wp_posts.ID = wp_term_relationships.object_id ) 
LEFT JOIN wp_postmeta 
    ON ( wp_posts.ID = wp_postmeta.post_id ) 
    AND wp_postmeta.meta_key =  'my_meta_key'
WHERE wp_term_relationships.term_taxonomy_id IN ( 1, 2, 3 )
    AND wp_posts.post_type =  'my_post_type'
    AND wp_posts.post_status IN ('my_status_1',  'my_status_2')
GROUP BY wp_posts.ID
ORDER BY wp_posts.ID ASC 
```

该`INNER JOIN`语法将仅返回在两个表中匹配的行。因此，如果您没有匹配的行，您将不会得到任何结果。通过将其更改为 a `LEFT JOIN`，即使`wp_postmeta`表中没有匹配的行，您也将返回所有行。如果该行不存在，则`wp_postmeta`表中的值将为`null`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:14:38.250

以下返回

*   来自 WP_Posts 的所有记录
*   只有那些带有 WP_TERM_RELATIONSHIPS 的记录
*   只有 wp_postmeta 中与 wp_posts 匹配的那些记录。

*

```
SELECT wp_posts.ID, wp_posts.post_name, wp_posts.post_title, 
  wp_posts.post_status, wp_postmeta.meta_value
FROM wp_posts
LEFT JOIN wp_term_relationships 
  ON wp_posts.ID = wp_term_relationships.object_id
LEFT JOIN wp_postmeta 
  ON wp_posts.ID = wp_postmeta.post_id
WHERE wp_term_relationships.term_taxonomy_id IN ( 1, 2, 3 )
  AND wp_posts.post_type =  'my_post_type'
  AND wp_posts.post_statusIN ('my_status_1',  'my_status_2') 
  AND (wp_postmeta.meta_key =  'my_meta_key' or wp_postmeta.meta_key is null)
GROUP BY wp_posts.ID
ORDER BY wp_posts.ID ASC 
```

您需要 is null 否则将排除 wp_posts 中没有 wp_postmeta 数据的记录。

# jquery - 淘汰表排序，每列的单一功能？

> ID：15116724
> 
> 赞同：0
> 
> 时间：2013-02-27T16:06:26.990
> 
> 标签：jquery, sorting, knockout.js, tablesorter

我有多个要使用 Knockout 填充的表。目前我正在使用淘汰赛排序方法

```
 { return a.total_sales() > b.total_sales() ? -1 : 1; }
    else { return a.total_sales() < b.total_sales() ? -1 : 1; }; 
```

但是，我需要对每个表中的每一列进行排序。有没有写所有这些陈述？我查看了 jquery 表排序器，但它似乎不适用于我的表。许多列是按钮或其他对象，而不仅仅是文本。如果我坚持使用淘汰赛方法，我将拥有超过 100 个这样的方法。建议？

如果需要，我可以添加一个使用 tablesorter 失败的表格示例

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:00:26.307

您可以添加绑定处理程序以使用 jquery 插件：

```
ko.bindingHandlers.tablesorter = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
    var options = ko.utils.unwrapObservable(valueAccessor());
        $(element).tablesorter(options)
    }
} 
```

然后在你的html中：

```
<table data-bind="tablesorter: {sortList: [[0,0], [1,0]]}"></table> 
```

# jquery - 此代码在 Jquery 1.4.2 中有效，但在 1.9.1 中无效，为什么？我可以在 JQ 1.9.1 中使用什么

> ID：15116729
> 
> 赞同：0
> 
> 时间：2013-02-27T16:06:35.440
> 
> 标签：jquery, toggle

```
$(document).ready(function() {
   $("div").css({
       "width":"80px",
       "height":"40px",
       "margin":"5px",
       "float":"left",
       "background-color":"blue",
       "border":"10px outset",
       "cursor":"pointer"
       });

       $("div").toggle(function(){
          $(this).css({
               "border":"5px inset",
               "background-color":"red"
               });

       },function(){
           $(this).css({
               "border":"10px outset",
               "background-color":"yellow"
               });     
       },function(){
           $(this).css({
               "background-color":"blue"
               });

        });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:10:23.183

`.toggle()`您使用的在 jQuery 1.8 中已弃用并在 1.9 中删除。

[http://api.jquery.com/toggle-event/](http://api.jquery.com/toggle-event/)

您需要用`.click()`函数替换它，或者编写自己的函数[来模拟旧功能](https://stackoverflow.com/questions/14382857/what-to-use-instead-of-toggle-in-jquery-1-8)。

# listview - Android 小部件：如何在列表视图中从网络加载图像？

> ID：15116736
> 
> 赞同：0
> 
> 时间：2013-02-27T16:06:53.277
> 
> 标签：listview, android-widget, uiimageview, httpurlconnection

**小部件说明：**

小部件由一个列表视图组成。此列表视图的每个项目都有不同的属性：

*   标题
*   图片网址
*   价格
*   ...

**问题 ：**

使用每个项目的 url，我编写了一些代码来从网络加载图像，图像很好地显示在我的列表视图中，但是当我想滚动我的列表视图时，所有项目都消失了，系统尝试加载与该项目相对应的其他图像被展示。

**代码示例：**

这是我执行这些操作的 getViewAt() 方法的代码：

```
public RemoteViews getViewAt(int position) {

    WidgetItem item = mWidgetItems.get(position);
    // We construct a remote views item based on our widget item xml file, and set the
    // text based on the position.

    SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(mContext);
    String theme = settings.getString("choixtheme", "default");

    if (theme.equals("default")) {
        rv = new RemoteViews(mContext.getPackageName(), R.layout.widget_item_default);
    }

    if (item.urlImage != "") {
            URL url = new URL(urlImage);
            HttpURLConnection connection = (HttpURLConnection) url.openConnection();
            connection.setDoInput(true);
            connection.connect();
            InputStream input = connection.getInputStream();
            myBitmap = BitmapFactory.decodeStream(input);   
    }       

    // Return the remote views object.
    return rv;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:20:41.860

你可以参考这个： http: [//www.developerfusion.com/article/145373/android-listviews-with-dynamic-data/](http://www.developerfusion.com/article/145373/android-listviews-with-dynamic-data/)

和

[ListView 中图像的延迟加载](https://stackoverflow.com/questions/541966/how-do-i-do-a-lazy-load-of-images-in-listview)

希望它有帮助！

# android - Android：如何从 SingleTask TabActivity 的 onNewIntent 创建子活动的新实例？

> ID：15116743
> 
> 赞同：1
> 
> 时间：2013-02-27T16:07:14.057
> 
> 标签：android, android-intent, android-tabactivity

在正常情况下我有以下流程

H ( `homeactivity`) - T( `TabActivity`)- L (`Activity`包含列表的类) - D ( `DescriptionActivity`)

如果 pushnotification 来了，它将在没有任何点击的情况下遍历到 D（刷新后台每个活动的关联数据）。

但是因为 T 是`singleTask`，（如果应用程序在推送通知时被最小化）它的 (T)`onNewIntent`被调用并且 L 和 D 不会被刷新

请帮我

*   罗尼

# jquery - 未捕获的类型错误：无法读取未定义的属性“webkit”

> ID：15116745
> 
> 赞同：6
> 
> 时间：2013-02-27T16:07:14.660
> 
> 标签：jquery, railstutorial.org

我正在研究 Ruby on Rails 教程第 8 章中的示例，并且在我的页面上出现上述错误，并且我的下拉菜单不起作用。关于如何解决这个问题的任何想法？

```
/* ===================================================
 * bootstrap-transition.js v2.0.0
 * http://twitter.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

!function( $ ) {

  $(function () {

    "use strict"

    /* CSS TRANSITION SUPPORT (https://gist.github.com/373874)
     * ======================================================= */

    $.support.transition = (function () {
      var thisBody = document.body || document.documentElement
        , thisStyle = thisBody.style
        , support = thisStyle.transition !== undefined || thisStyle.WebkitTransition !== undefined || thisStyle.MozTransition !== undefined || thisStyle.MsTransition !== undefined || thisStyle.OTransition !== undefined

      return support && {
        end: (function () {
          var transitionEnd = "TransitionEnd"
          if ( $.browser.webkit ) {
Uncaught TypeError: Cannot read property 'webkit' of undefined
            transitionEnd = "webkitTransitionEnd"
          } else if ( $.browser.mozilla ) {
            transitionEnd = "transitionend"
          } else if ( $.browser.opera ) {
            transitionEnd = "oTransitionEnd"
          }
          return transitionEnd
        }())
      }
    })()

  })

}(window.jQuery); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-08T08:32:15.900

我认为这里的问题是：`$.browser.webkit`- 显然 $.browser 已在 jQuery 1.9+ 中删除。

根据[这个线程](https://stackoverflow.com/questions/9645803/whats-the-replacement-for-browser)没有直接替换，但是通过使用[这个插件](https://github.com/jquery/jquery-migrate/)，您应该能够恢复该标签的功能。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-08T17:16:03.433

通过使用以下行更新您的 Gemfile 将您的 bootstrap-sass gem 升级到最新版本：

```
gem 'bootstrap-sass', '~> 2.3.0.1' 
```

我遇到了问题，这是因为我正在运行该 gem 的 2.0.0 版本。不确定他们推荐在教程中运行哪个版本，但升级到最新版本应该不会对您造成伤害。

# ruby-on-rails - Rails 生成的 Ruby 源代码？

> ID：15116746
> 
> 赞同：2
> 
> 时间：2013-02-27T16:07:19.037
> 
> 标签：ruby-on-rails

是否可以查看解释器为 Ruby on Rails 生成的源代码？

例如 ERB 模板引擎用 ERB 块解析 html。然后解析的输出应该以某种方式呈现，等等。我相信应该有明确的代码（由 iterpretered 生成）来完成这个。只是想看看所有这些东西在内部是​​如何工作的。

这是来自 ASP.NET 世界的一个类比：HttpRuntime.CodegenDir，它获取 ASP.NET 为当前应用程序存储临时文件（生成的源代码、编译的程序集等）的目录的物理路径。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T00:58:47.083

对服务器的每个请求都会导致 ERB 模板被解释。

因为 Ruby 是一种动态语言，所以没有预编译步骤，因此没有生成输出的来源。

可以在 HTTP 请求之间修改 ERB，并且修改后的模板将在下一个 HTTP 请求中可用。

Rails 确实缓存了生成的输出，但很难在缓存目录中找到它。

# java - @Autowired 在扩展 Junit Testwatcher 的类中为空

> ID：15116748
> 
> 赞同：0
> 
> 时间：2013-02-27T16:07:20.690
> 
> 标签：java, spring, jakarta-ee, spring-mvc, junit

我在我的测试框架中使用 Spring 自动扫描组件。

Autowired 在所有类中都可以正常工作，除了扩展 Junit Testwatcher 的类。

我扩展 Junit testwatcher 的类是：

```
@Component
public class PrintTrace extends TestWatcher{//this class overrides pass and fail   
                                            //methods in Testwatcher           

@Autowired
private HTMLLogger htmlLogger //this is null all the time. it works in 
                              //other classes
} 
```

我的基类看起来像：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath:beans.xml"})
@TestExecutionListeners({ DependencyInjectionTestExecutionListener.class,
        DirtiesContextTestExecutionListener.class })
public class YahooTestSetUp {

    public static WebDriver driver;

    @Rule
    public PrintTrace printTrace = new PrintTrace();

    @Autowired
    private HTMLLogger htmlLogger;//here its working fine
} 
```

还有我的 xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xmlns:context="http://www.springframework.org/schema/context"
     xsi:schemaLocation="http://www.springframework.org/schema/beans
         http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
         http://www.springframework.org/schema/context
         http://www.springframework.org/schema/context/spring-context-3.0.xsd">
    <context:annotation-config />
    <context:component-scan base-package="com.pilz"/>
</beans> 
```

请建议这对我来说非常重要。否则我应该选择单例对象，这对我来说不是一个好的解决方案。

* * *

**添加更多信息：**

假设我有 2 个测试套件，它们访问 2 个通用类 HTMLLogger.class 和 PrintTraece.class。

每个测试套件都独立于其他套件。这些套件有@BeforeClass 和@AfterClass

**见下文：**

```
@RunWith(Suite.class)
@Suite.SuiteClasses({ AutowireClass.class})
public class YahooTestSuite extends YahooTestSetUp{
    private static HTMLLogger htmlLogger;

    @BeforeClass
    public static void allTests() throws Exception {**//Can I use @Autowired in
                                                      static methods(no)**  

        htmlLogger = new HTMlLogger()

        htmlLogger.createHTMLLogFile();
    }

    @AfterClass
    public static void afterAll() throws Exception{
        htmlLogger.htmlLogEnd();
    }

} 
```

另一个套件对其他模块做同样的事情。

正如我之前所说，我的 PrintTrace.class extends Testwatcher.class(Junit rule) 它看起来像

使用基类中创建的规则调用此类。

```
@Component
public class PrintTrace extends TestWatcher{

    private HTMLLogger htmlLogger = null;
@Override
    public void starting(final Description description) {

    }

    @Override
    public void failed(final Throwable e, final Description description) {
        htmlLogger.writeFailLog();**//This is common for all suites**
                                        //This should be same object used in suite
    }

    @Override
    public void succeeded(final Description description) {

        htmlLogger.writePassLog();//This is common for all suites
                                      //This should be same object used in suite
    }

    @Override
    public void finished(Description description) {

    } 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:19:33.283

为什么要为 JUnit 规则使用 Spring DI？您的测试代码不是您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:02:07.260

在某些 java 类中，例如测试用例或 web 侦听器，`@Autowired`不起作用。您必须像对象一样定义 applicationContext 并手动接收 bean。

```
ApplicationContext context = AnnotationConfigApplicationContext("app_context_file_path")

HTMLLogger htmlLogger = context.getBean("loggerBeanName"); 
```

另外，看看这里 - [http://static.springsource.org/spring/docs/3.0.x/reference/testing.html](http://static.springsource.org/spring/docs/3.0.x/reference/testing.html)

和谷歌关于`@Resource`弹簧注释。

要获得您需要的确切对象，您应该具有以下配置：

如果您在应用程序上下文文件中创建一个 bean，只需在`getBean(name)`方法中使用它的 id。如果您将它作为一个单独的类，请为它（类）提供`@Component(value)`注释并在应用程序上下文中扫描包。之后，使用该 bean（组件）的值名称来获取您配置的确切对象。

# jquery - 并排放置 FullCalendar 事件。将偶数大小限制为 10px x 10px

> ID：15116750
> 
> 赞同：0
> 
> 时间：2013-02-27T16:07:22.167
> 
> 标签：jquery, fullcalendar

我想知道是否有一种很好的方法来定位`FullCalendar`事件，就好像它们向左浮动一样。在可用的水平空间被填满后，它们将垂直堆叠。这看起来没问题，因为事件也将限制为`10px x 10px`.

我知道我需要更改`left:`和`top:`CSS 属性。

而不是看起来像这样：

> ======== ->活动
> ======== ->活动

它看起来像这样：

> [--] [--] -> 事件 ^ 事件

我在哪里可以在 FullCalendar.js 中进行更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T04:09:34.893

需要修改函数renderSlotSegs；编码：

```
if (levelI) {
    // indented and thin
    outerWidth = availWidth / (levelI + forward + 1);
}else{
    if (forward) {
        // moderately wide, aligned left still
        outerWidth = ((availWidth / (forward + 1)) - (12/2)) * 2; // 12 is the predicted width of resizer =
    }else{
        // can be entire width, aligned left
        outerWidth = availWidth;
    }
} 
```

应改为：

```
if (levelI) {
    // indented and thin
    outerWidth = availWidth / (levelI + forward + 1);
}else{
    if (forward) {
        // changed to limit width of first overlapping slot
        outerWidth = availWidth / (forward + 1);
    }else{
        // can be entire width, aligned left
        outerWidth = availWidth;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:11:30.620

In `.min` version near `var R,V=la+"-widget-header",ea=la+"-widget-content"` you have the following code:

```
R="<table class='fc-border-separate' style='width:100%' cellspacing='0'><thead><tr>";for(aa=0;aa<F;aa++)R+="<th class='fc- "+V+"'/>";R+="</tr></thead><tbody>";for(aa=0;aa<w;aa++){R+="<tr class='fc-week"+aa+"'>";for(V=0;V<F;V++)R+="<td class='fc- "+ea+" fc-day"+(aa*F+V)+"'><div>"+(I?"<div class='fc-day-number'/>":"")+"<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";R+="</tr>"}R+="</tbody></table>"; 
```

Did you try to edit this part.

Worked for me a few months ago.

# asp.net-mvc - Ajax 将多个数组发布到 MVC 4 控制器

> ID：15116753
> 
> 赞同：1
> 
> 时间：2013-02-27T16:07:25.207
> 
> 标签：asp.net-mvc, jquery

我有一个我认为很奇怪的问题，我希望它只是被忽略的东西。我试图使用 ajax 将一些数组传递给我的 mvc 控制器，从我的控制台输出中我可以看到正确的值被发布但似乎只有其中一个*不会*正确绑定，我只是得到 null**但**只有在其他 2 个数组有价值观。如果其他 2 个为 null，则 KnownTo 将正确 bing。

这是我的javascript代码

```
var sectors = new Array();
var offices = new Array();
var KnownTo = new Array(); 
```

在单击事件中，我通过检查页面上某些元素的某些数据属性来添加到这些数组中。然后我做请求。

```
postData = {
            'Sector': sectors,
            'Offices': offices, 
            'KnownTo': KnownTo 
        };

$.ajax({
        type: 'POST',
        contentType: "application/json;charset=utf-8",
        url: 'Controller/SearchActivities',
        dataType: 'json',
        data: JSON.stringify(postData),
        success: function (result) {
           console.log(result)
        },
        failure: function (result) {
           console.log(result)
        }
    }); 
```

在 ajax 调用之后，我看到了在 firebug 中发布的正确值。

然后我到控制器...

```
 [HttpPost]
    public JsonResult SearchActivities(FilterPageViewModel model)
    {
           //something
    } 
```

部门和办事处已正确填写，但我的 KnownTo 未填写。这是 FilterPageViewModel

```
public class FilterPageViewModel
{
    public int[] Sector{ get; set; }
    public int[] Offices{ get; set; }
    public int[] KnownTo{ get; set; }
} 
```

现在奇怪的是，如果只有 KnownTo 有值发布到它并且其他 2 为 null 那么 KnownTo 会**正确**绑定，但如果其他数组中的任何一个上有值，那么 KnownTo 无论如何都将为**null**。我希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:19:42.637

我通过将 KnownTo 数组重命名为其他名称来解决此问题。我猜 KnownTo 是某种保留字。

# image-processing - 当aforge和c#中连接字符时的图像分割

> ID：15116756
> 
> 赞同：4
> 
> 时间：2013-02-27T16:07:37.930
> 
> 标签：image-processing, aforge, image-segmentation

我有下面的图像并且已经二值化了。</p>

![在此处输入图像描述](../Images/4cbd1485023d827a39d16ed94918f1a9.png)

我需要分割这个图像并识别数字。连接在一起的两位数字 4' 和 '9'。

我读了一些提到“分水岭形态”方法的文件。下面的图像已经实现了“分水岭分割”。

![在此处输入图像描述](../Images/486d394b0633283260a4fdfb08a85a81.png)![在此处输入图像描述](../Images/903b517165a35d0514ddd764373e8a8e.png)

很明显，双**44**位数字仍然相连，但**9**位数字已经成功分割。

我需要一些帮助如何分割**44 个**字符！谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T07:29:24.553

正春，

您需要了解这是一项相当艰巨的任务，在我看来，并非在所有情况下都可以完美解决。

首先，在不知道大小和形状的情况下正确拆分字符是**不可能**的：只要考虑字母 W，它就可以很好地拆分为两个 V；相反，没有什么可以告诉您两个意外接触的 IJ 确实是两个不同的字母，而不是 U。

这意味着，无论多么复杂，都没有像分水岭或任何其他方法这样的“盲目”方法可以成功。仅几何是不够的，您需要依赖字体的一些描述（大小和形状）。

据我所知，您**必须**让细分和识别协同工作。你可以做的是：

*   使用初始分割，希望不要经常出现触碰和断字；
*   从左边开始，尝试通过在一个字符宽度后拆分来立即识别字符（您需要依次尝试每个字体字符，可能具有不同的宽度）；
*   保留最可能的识别结果，并从该分割继续识别，向右；
*   如果您希望字符损坏，您也可以尝试跨两个或多个 blob 的识别并将它们分组。（斑点之间的间隙是分裂的好提示，除非你的角色可能被破坏或遗漏部分。）

您可以通过添加启发式方法来改进上述过程，以决定在哪里更有可能分裂，例如在最低高度，但这很棘手。一点黑魔法……

# php - PHP：贝宝集成

> ID：15116757
> 
> 赞同：0
> 
> 时间：2013-02-27T16:07:41.103
> 
> 标签：php, paypal

我正在建立一个存在 2 个用户组的网站：卖家和买家。买家购买东西并应通过 PayPal 向卖家付款。

因此，它不是一种用户直接向我（作为网站所有者/在线商店）付款的网上商店，而是向其他用户（卖家）付款。因此，我需要将我网站上的一位用户（买方）的 PayPal 交易转发给另一位用户（卖方）。

我阅读了一些 PayPal API 描述，但假设我想将 PayPal 付款处理到我的 PayPal 帐户，这不是我的情况。一个想法是卖家向我付款，然后我向买家付款，但这不是我想做的。

所以，我想要的是：买家应该直接将 PayPal 付款处理到卖家的 PayPal 账户，然后我应该收到付款确认并通知卖家。

有人对这些东西有想法、经验或建议吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T09:37:48.857

对于如何处理它，您有很多选择。

一，您可以使用[Express Checkout API](https://www.x.com/sites/default/files/pp_expresscheckout_integrationguide.pdf)来构建结帐系统，并且您将使用[Permissions API](https://www.x.com/sites/default/files/pp_permissions.pdf)（可选），以便用户可以轻松地授予您的应用程序权限以代表他们进行 API 调用。请注意，用户也可以通过他们的 PayPal 个人资料手动执行此操作，直到您集成了 Permissions 部分。

要获得您的付款，您可以让您的用户使用[Preapproval API](https://www.x.com/developers/paypal/documentation-tools/api/preapproval-api-operation)创建一个预先批准配置文件。这将允许您随时以他们的名义自动提交付款。因此，您可以直接在结帐流程中或在[IPN](https://www.x.com/developers/paypal/documentation-tools/ipn/integration-guide/IPNIntro)（我建议这样做）中使用 Pay 调用中的 preapproval 密钥从用户帐户向您自己提交付款。

另一种选择是在 Express Checkout 中使用[并行付款](https://www.x.com/developers/paypal/documentation-tools/how-to-guides/how-make-parallel-payments-using-express-checkout)。这将在卖家和您自己之间自动为您分摊付款，但买家会在结账时看到该分摊。

另一种选择是使用[Pay API](https://www.x.com/developers/paypal/documentation-tools/api/pay-api-operation)进行结帐，这将允许您创建链式付款。这与并行付款相同，只是它对买方隐藏了拆分，如果您出于任何原因需要，您实际上可以延迟向二级收款人付款。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:45:01.867

如果您有立即购买按钮或类似按钮，请使用以下卖家的电子邮件地址

```
<input type="hidden" name="business" value="sellers@email.com"> 
```

它将使用该电子邮件地址向用户付款。如果这不是他们的贝宝地址，它将提示他们注册贝宝以接收或将其添加到当前帐户。

然后使用 PHP`mail()`或您的 CMS/Admin 系统在从 Paypal 推荐返回后加载成功支付页面时通知您。

# extjs - ExtJs 确定表单加载的可见性

> ID：15116759
> 
> 赞同：1
> 
> 时间：2013-02-27T16:07:47.487
> 
> 标签：extjs, extjs3

在 Extjs 3.4 中，我有一个相当大的表单，它是从一个 ajax 调用中填充的，通过`someForm.getForm().load({url: someplace, etc})`它可以完美地工作。不过，我似乎无法解决的问题是，有几个组合框和复选框可以确定另一个字段是否可见，并且`allowBlank`.

根据类似问题的答案，我尝试`actioncomplete`在表单上使用该事件，但该字段此时没有值。我也尝试过使用通话`success`事件，`load()`但遇到了同样的问题。

有没有其他方法可以从`form.load()`调用中获取此功能？

编辑 - 这是我的`load`电话：

```
var panel = Ext.getCmp('someFormID');
panel.getForm().load({
    method: 'GET',
    url: 'ajax_get_request.aspx?id=' + id,
    success: function (form) {
        // This will error: object is null or undefined
        alert(form.findField('fieldID').getValue());
    }
}); 
```

我对 Extjs 比较陌生，所以也许我只是在这里遗漏了一些东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:51:24.603

不知道为什么挂钩`success`回调`Ext.form.BasicForm.load()`失败，但我可以提出一种替代方法。

我通常使用显式`Ext.Ajax.request()`调用将数据加载到`Ext.data.Record`. 然后在`request()`'s`success`回调中，我使用`Ext.form.BasicForm.loadRecord()`. 如果您需要对加载的值采取行动，您可以在同一个回调中执行。

我这样做是因为我喜欢将来自服务器的原始值存储在某个地方。

# jquery - 在我的网站上首次游览时使用引导粘性\持久性弹出框

> ID：15116762
> 
> 赞同：1
> 
> 时间：2013-02-27T16:07:51.270
> 
> 标签：jquery, twitter-bootstrap, popover

我的网站上有一些功能想介绍给我的新用户。所以每次新用户登录时，不熟悉新功能，我会将他重定向到 index.php?welcome=1。

在这个页面上，我想让他浏览这个页面上的某些元素，在每个元素旁边为他提供解释，并带有一个“下一步”按钮，允许他继续下一个元素。

现在我似乎有两个问题：

1.  我不希望用户意外关闭弹出框，因此，我想禁用负责通过单击绑定到的元素来切换弹出框的功能。

2.  此外，我不希望我的用户意外或故意跳过第一次解释，首先因为系统非常复杂，我希望我的用户收到关于如何使用它的完整解释。

非常感谢任何帮助！由于这个小问题，我即将自定义 twitter 项目文件。

我的代码：（test.json）

```
 {
   "0":{
      "id":"intro",
      "title":"Welcome",
      "body":"Hello, and <b>welcome</b> to atavde"
   },
   "1":{
      "id":"autoShare",
      "title":"AutoShare position",
      "body":"Here you can autoShare a position Break line"
   },
   "2":{
      "id":"personalShare",
      "title":"PerrsonalShare section",
      "body":"personalBodypersonalBody"
   },
   "3":{
      "id":"anotherExample",
      "title":"thisispersonal share exmp",
      "body":"personalBodypersonalBody"
   },
   "4":{
      "id":"specificExample",
      "title":"This is a specific example",
      "body":"specific example horrey"
   }  
} 
```

(popoverNavigate.js)

```
var currentPopOver = 0;
popOvers = {};
$(function ()  
{
    var i = 0
    $.getJSON("test.json", function(json) {
            console.log(json);
            // json.each(function(){
            //  console.log($(this));
            // });
            for(var j in json){
                json[j]['body'] = json[j]['body'] + "<div style='display:block;'><span class='btn btn-link next'>Next</span><span class='btn btn-link close'>Close</span></div>";
            }
            popovers = json;
            $('[rel="popover"]').each(function(){
                var currentId = $(this).attr('id');
                // var currentConetnet = currentId.substr(currentId.length  - 1);
                console.log(currentId);
                $(this).popover({
                    html : true,
                    placement : 'bottom',               
                    title: popovers[i]['title'],
                    content: popovers[i]['body'] /*function(){return $('#content' + currentConetnet).html()}*/
                })
                // .on('click', function(){
                //  $(this).popover('hide').delay(300).queue(function(next){
                //  $(this).popover('show');        
                //  });
                // });
                i++;

            });
            $('#' + popovers[currentPopOver]['id']).popover('show');
});
// $.ajax(data: "JSON", type: "POST", url : "../test.json",success: function(json) {
//    alert("JSON Data: " + json);
//  });

// htmlElements = ;

// $('body').on('click', '.popover .close', function(){
//  $('#example' + currentPopOver).popover('hide');
// })
// $('[rel="popover"]').click(function(e){
//   e.preventDefault();
//   if (! $(this).next('div.popover:visible').length){

//      // $('#' + popovers[currentPopOver]['id']).popover('show');
//      openedPopoverId = $(this).attr('id');
//      for(i in popovers){
//          if(openedPopoverId == popovers[i]['id']){
//              var previousPopover = currentPopOver;
//              currentPopOver = i;
//              $('#' + popovers[previousPopover]['id']).popover('hide').delay(500).queue(function(next){
//                  $('#' + popovers[currentPopOver]['id']).popover('show');
//                  next();
//              });
//          }

//      }
//  }   
//  return false;

// });
$('body').on('click', '.popover .close', function(){
    $('#' + popovers[currentPopOver]['id']).popover('hide');
})

$('body').on('click', '.popover .next', function () {
   if(currentPopOver < $('[rel="popover"]').length - 1)
    nextPopOver(1);
    else if(currentPopOver == $('[rel="popover"]').length - 1 ){
        $('#' + popovers[currentPopOver]['id']).popover('hide');
    }
});

// $('.next').live('click', function(){
// if(currentPopOver < $('a').length)
//  nextPopOver(1);
// })

$('body').on('click', '.popover .previous', function(){
if(currentPopOver > 1)  
    nextPopOver(-1);
})

});  

function nextPopOver(direction){//1 - next, -1 previous
    $('#' + popovers[currentPopOver]['id']).popover('hide').delay(500).queue(function(next){
    currentPopOver += direction;
    $('#' + popovers[currentPopOver]['id']).popover('show');
    $('#' + popovers[currentPopOver]['id']).focus();
    next(); 
    });
} 
```

# php - 如何在多个字符后剪切文本并在多行上获取文本？

> ID：15116763
> 
> 赞同：0
> 
> 时间：2013-02-27T16:07:54.047
> 
> 标签：php, string, substring

我有一个很长的文本，我需要在 N 个字符之后剪切文本，以便最后得到一个文本，呈现在多行上，没有任何单词被剪切；

所以，如果有一个长度为 1000 个字符的文本，它已保存在 1 行，我需要从 100 个字符剪切到 100 个字符，最后，我将得到一个分布在 10 行的文本。

我尝试了一些东西，但我卡住了；

foreach 不起作用，没有看到 aa 数组的文本；另外，我没有确保在我的测试中保持单词完整；

有没有人试过这个？或者有解决方案的链接吗？

```
public static function cut_line_after_n_chars($str, $n = 70) {
    $result = '';
    $pos = 0;
    foreach ($str as $c) {
        $pos++;
        if ($pos == $n) {
            $result .= $c + '<br/>';
            $pos = 0;
        }
        else
            $result .= $c;
    }
    return $result;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T16:11:15.173

听起来你需要`wordwrap`.

[http://php.net/manual/en/function.wordwrap.php](http://php.net/manual/en/function.wordwrap.php)

这使您可以将字符串分成一组片段，而不会切断单词。然后，您可以根据需要格式化这些片段。

**编辑**

如果您仍然需要每行包含 100 个字符，则可以使用[`str_pad`](http://php.net/manual/en/function.str-pad.php)在每行上添加额外的空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:13:43.097

使用 explode() 函数从字符串中获取单词数组。

```
$words = explode( ' ', $str );

$length = 0;
foreach( $words as $word ) {
  // Your loop code goes here.
} 
```

# ruby-on-rails - Capistrano 中等效的 Heroku run rake

> ID：15116776
> 
> 赞同：0
> 
> 时间：2013-02-27T16:08:26.127
> 
> 标签：ruby-on-rails, deployment, capistrano, unicorn

我曾经让 Heroku 管理我的 Rails 应用程序部署，但现在我用 Capistrano、Nginix 和 Unicorn 构建了自己的服务器。

在 Heroku 中，当我想运行 rake 任务时，我会这样做：

```
heroku run rake:migrate VERSION=0 
```

如何使用 Capistrano 完成相同的任务？我似乎找不到一个清晰而简单的解决方案。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:25:22.533

尝试：

```
bundle exec RAILS_ENV=PRODUCTION rake db:migrate VERSION=0 
```

在项目的`current`目录上。

[在这里](https://stackoverflow.com/questions/1196310/how-can-i-migrate-my-database-with-rails-to-the-first-revision-without-dropping)您可以找到有关主题的更多信息。

# ruby - 希望帮助从嵌套在使用 Mechanize 过滤的 javascript 文本中的模型数据中提取

> ID：15116779
> 
> 赞同：0
> 
> 时间：2013-02-27T16:08:31.067
> 
> 标签：ruby, screen-scraping, nokogiri, mechanize

使用以下内容：

```
LowEast = agent.get('https://rs.alarmnet.com/TotalConnectComfort/Device/Control/12345')
puts LowEast.parser.xpath("//script[@type='text/javascript']") 
```

返回以下内容，为简洁起见，我对其进行了删减。具体来说，我想提取每个分号之前的两条信息，然后我会弄清楚如何将它们转储到日志文件中。我还没有看到如何做到这一点，但它似乎不应该很难。如果我错过了类似的问题，我深表歉意。

```
<script type="text/javascript" src="/TotalConnectComfort/Scripts/Control/Control.Urls.js?v=1.5.46"></script>
<script type="text/javascript" src="/TotalConnectComfort/Scripts/Control/Control.Init.js?v=1.5.46"></script>
<script type="text/javascript">
    $(document).ready(function() 
    {
        ///////////////////// pass model data to client-side logic /////////////////////
        Control.Model.set(Control.Model.Property.batteryStatus, 0);
        Control.Model.set(Control.Model.Property.commercial, false);
        Control.Model.set(Control.Model.Property.communicationLost, false);
        Control.Model.set(Control.Model.Property.coolLowerSetpLimit, 50.0000);
        Control.Model.set(Control.Model.Property.coolNextPeriod, 88);
        Control.Model.set(Control.Model.Property.coolSetpoint, 78.0000);
        Control.Model.set(Control.Model.Property.coolUpperSetptLimit, 99.0000);
        Control.Model.set(Control.Model.Property.deadband, 0.0000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:34:32.573

只需使用扫描：

```
text.scan /Control.Model.set\((.*), (.*)\);/ 
```

# php - 需要 CURLOPT_CAINFO 吗？

> ID：15116780
> 
> 赞同：0
> 
> 时间：2013-02-27T16:08:42.053
> 
> 标签：php, ssl, curl, certificate, paypal-ipn

PayPal 的 curl_setopt_array 中的 CURLOPT_CAINFO 是为了让“实时”模式工作吗？

所以基本上我要问的是我们是否必须拥有 SSL 才能使 PayPal 实时模式工作，因为我制作的脚本在沙盒中工作，按照我想要的方式更新我的数据库，但只在沙盒中，而不是实时。我不想在这里发布我的脚本，我会为此打开一个新线程，我只是问一个一般性问题，所以希望它会对我或该功能中的其他人有所帮助，我搜索了谷歌并无法得到一个可靠的答案。

祝你有美好的一天！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:04:08.803

至于使用 curl 连接到 Paypal，如果 Paypal 确实允许纯 http 连接，请确保您不必担心 SSL。在这种情况下，对您要求的问题的回答是否定的。但如您所见，这取决于您正在与之交谈的服务。假设 Paypal 只允许生产服务器使用 https，那么您必须处理 SSL，要么忽略它，要么设置正确的证书路径。两者都必须在 set_opt 中完成。这是另一个问题： [Web 服务访问的 PEM 文件源](https://stackoverflow.com/questions/11994658/source-of-pem-files-for-web-service-access)

# windows - 有什么方法可以用 github 自动维护一个“最新”版本的文件夹？

> ID：15116784
> 
> 赞同：0
> 
> 时间：2013-02-27T16:08:47.983
> 
> 标签：windows, git, github, github-for-windows

我有一个列出数百个“名称”文件夹的 github 存储库。在每个“名称”文件夹中，每个版本的内容都有“版本”文件夹。

例子：

```
 nameFolder1 -> 0.1 -> Multiple files for version 0.1
                -> 0.2 -> Multiple files for version 0.2
    nameFolder2
    ... 
```

我想要的是在每个“名称”文件夹中都有一个“最新”文件夹，该文件夹将始终包含最新版本的文件。
基本上，当我添加一个新的“版本”文件夹时，如果它不存在，它会以某种方式创建“最新”文件夹，然后将最新版本的文件复制到那里。如果该文件夹存在，则只需删除其中的所有内容并粘贴最新版本文件夹中的文件。

有什么办法可以自动化吗？

# python - AppEngine 中（或者可能在 Django 中）是否有称为 insert_or_update 的快捷方法？为什么不？

> ID：15116787
> 
> 赞同：2
> 
> 时间：2013-02-27T16:08:54.910
> 
> 标签：python, django, google-app-engine, insert-update

我多次重复这种模式：（我认为这不是很常见吗？）

**谷歌应用引擎**

```
# Insert if object doesn't exist, Otherwise Update Object
obj = get_or_insert('123', title='Hello World')
obj.title = 'Hello World'
obj.puts() 
```

**姜戈**

```
# Insert if object doesn't exist, Otherwise Update Object
obj, created = Model.objects.get_or_create(id='123', 
                   defaults={'title':'Hello World'}
if not created:
    obj.title = 'Hello World'
    obj.save() 
```

**如果**我**能**打电话就好了`insert_or_update`。不是吗？例如：

```
# AppEngine
obj = insert_or_update('123', title='Hello World')

# Django
obj = Model.objects.insert_or_update(id='123', defaults={'title': 'Hello World'}) 
```

# 更新

回到 App Engine[文档](https://developers.google.com/appengine/docs/python/datastore/modelclass#Model_get_or_insert)，我找到了关于这个`get_or_insert`方法做什么的片段。类似于以下内容：

```
def txn(key_name, **kwds):
    entity = Story.get_by_key_name(key_name, parent=kwds.get('parent'))
    if entity is None:
        entity = Story(key_name=key_name, **kwds)
        entity.put()
    return entity

def get_or_insert(key_name, **kwargs):
    return db.run_in_transaction(txn, key_name, **kwargs)

get_or_insert('some key', title="The Three Little Pigs") 
```

我想知道为什么`insert_or_update`在应用程序引擎和 django 中都没有创建一个方法。

## App Engine 解决方法

```
@classmethod
def insert_or_update(cls, key_name, parent=None, **kwargs):
    def _tx():
        entity = cls.get_by_key_name(key_name, parent=parent)
        if entity:
            for key in kwargs:
                setattr(entity, key, kwargs[key])
        else:
            entity = cls(key_name=key_name, parent=parent, **kwargs)
        entity.put()
        return entity
    return db.run_in_transaction(_tx) 
```

## Django 解决方案

[见下文](https://stackoverflow.com/a/20430268/764592)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-06T17:45:33.220

# 姜戈

[**update_or_create**](https://docs.djangoproject.com/en/dev/ref/models/querysets/#update-or-create)（来自 Django 官方文档）

```
update_or_create(defaults=None, **kwargs) 
```

*Django 1.7 版本中的新功能。*

一种使用给定对象更新对象的便捷方法，`kwargs`如有必要，创建一个新对象。这`defaults`是用于更新对象的（字段，值）对的字典。

返回 的元组`(object, created)`，其中`object`是创建或更新的对象，`created`是一个布尔值，指定是否创建了新对象。

该`update_or_create`方法尝试根据给定的`kwargs`. 如果找到匹配项，它会更新`defaults`字典中传递的字段。

这意味着作为样板代码的快捷方式。例如：

```
try:
    obj = Person.objects.get(first_name='John', last_name='Lennon')
    for key, value in updated_values.iteritems():
        setattr(obj, key, value)
    obj.save()
except Person.DoesNotExist:
    updated_values.update({'first_name': 'John', 'last_name': 'Lennon'})
    obj = Person(**updated_values)
    obj.save() 
```

随着模型中字段数量的增加，这种模式变得非常笨拙。上面的例子可以这样重写`update_or_create()`：

```
obj, created = Person.objects.update_or_create(
    first_name='John', last_name='Lennon', defaults=updated_values) 
```

有关如何解析在 kwargs 中传递的名称的详细说明，请参阅[`get_or_create()`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.get_or_create).

如上所述[`get_or_create()`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.get_or_create)，如果在数据库级别未强制执行唯一性，此方法容易出现竞争条件，这可能导致同时插入多行。

# 应用引擎

正如马特之前提到的那样，还没有那么幸运，它可能不是一个常见的用例。也许在 AppEngine 中，这样的用例并不多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:10:30.753

它可能不像你想象的那么普遍。就个人而言，我发现自己不必经常这样做，当我这样做时，它只比你提出的`insert_or_update`方法长两三行，这不足以让我为这个功能哭泣或激励我添加它我。虽然我过去使用`INSERT … ON DUPLICATE KEY UPDATE`过很多 MySQL。

我自己也有过几次这样的经历，就在几周前，我想知道为什么 Django 没有`toggle`关于 M2M 关系的方法……我最终做了一个：

[https://github.com/Matt-Stevens/django/commit/f7c36](https://github.com/Matt-Stevens/django/commit/f7c36)

# 编辑

Django 1.7 看起来会具备这种“ ***UPSERT*** ”能力，[https://github.com/django/django/commit/6272d](https://github.com/django/django/commit/6272d)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:11:41.870

如果我正确理解了这个问题：

```
obj, created = Model.objects.get_or_create(id='123', 
               defaults={'title':'Hello World'}) 
```

以上内容应替换为以下内容：

```
obj, created = Model.objects.get_or_create(foo='alpha', bar='beta' 
               defaults={'title':'Hello World'}) 
```

其中*foo*和*bar*是模型中的字段。这解决了 django 的重复问题。不确定应用引擎。高温高压

# css - div 浮动，定位

> ID：15116790
> 
> 赞同：0
> 
> 时间：2013-02-27T16:09:08.940
> 
> 标签：css, html, positioning

我有这样的html代码：

```
<body style="text-align: center;">
<div style="background-color: #014156; text-align: center; width: 985px; margin:6px auto;">
<div style="background-color: #a6a6a6; width: 975px; background-image:url('shadow.gif'); background-repeat:repeat-x; background-position: center top; margin: 6px; overflow:hidden;">
<div style="float:left; width: 674px; text-align: center; color:#056c02; margin-left: 5px; margin-top: 10px; font-size: 20opx;" title="Product title"><span style="color: #d2ff00">"</span><span style="background-color: #d2ff00">[[Title]]</span><span style="color: #d2ff00">"</span><p style="text-align: left; font-size: 14px; margin-bottom: 5px;" title="Description">[[Description]]</p></div>
<div style="float:left; width: 301px; text-align: center; " title="General information (Image, stock, price)">[[Picture1]]<BR><SPAN style="FONT-SIZE: 9px; background-color: #FFFFFF;">Image is for illustrative purposes only. Please refer to product description.</SPAN></div>
</div> 
```

结果：

![在此处输入图像描述](../Images/a9156d8d17d14f6d0307ec72eb6e2126.png)

在灰色背景的 div 中，我需要两个 div 对齐内联，结果将是这样的： ![在此处输入图像描述](../Images/c4f38238d28bb97a05e2af2d65b8c400.png)

我应该改变什么，问题出在哪里？

Ps 我的样式在标签中进行了描述，因为由于某些主机原因，我无法为此使用 css。所以请不要开始告诉我这件事:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:14:35.440

您需要降低左 div 或右 div 的宽度。

例如，降低第一个 div 可以`650px`解决问题。

您的逻辑是正确的：674px + 301px 确实等于 975px，但您没有考虑这些值中的边距、填充和边框。使“真实”宽度小于或等于 975px

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:13:51.740

而不是`float: left`，尝试使用`display: inline-block`，应该可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:15:08.093

你有一个`p`标签，它是在`block`inline 旁边排列的`span`。根据您的要求添加`inline`或添加`inline-block`到标签中。`p`另一种可能性是您可以将 更改`p`为`span`.

# java - Java Spring MVC 依赖注入的状态变量

> ID：15116795
> 
> 赞同：1
> 
> 时间：2013-02-27T16:09:17.690
> 
> 标签：java, spring-mvc, dependency-injection

我们在 Java Spring MVC 中使用依赖注入向控制器添加资源。例如：

```
@Autowired
public MyController(
    @Qualifier("MyOtherControllerA") MyOtherControllerA myOtherControllerA,                 
    @Qualifier("MyOtherControllerB") MyOtherControllerB myOtherControllerB)
{
    ...
} 
```

我们想为 DEBUG 模式和 LIVE 注入不同的依赖项。例如，对于调试，我们可以：

```
@Autowired
public MyController(
    @Qualifier("MyOtherControllerA_Mock") MyOtherControllerA myOtherControllerA,                 
    @Qualifier("MyOtherControllerB_Mock") MyOtherControllerB myOtherControllerB)
{
    ...
} 
```

我们如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:18:34.693

不要将不同环境的逻辑放入您的代码中。看看[环境特定的配置](https://stackoverflow.com/questions/6284745/environment-specific-configuration-for-a-spring-based-web-application)。他们也有类似的问题。

# c# - 检查数据绑定是否存在

> ID：15116797
> 
> 赞同：3
> 
> 时间：2013-02-27T16:09:23.667
> 
> 标签：c#, wpf, binding

我正在将 xaml 文件动态加载到具有绑定的程序中：

```
<ListView
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Grid.Row="2" BorderBrush="White" Name="ListView1"
    ItemsSource="{Binding Path=line}" HorizontalAlignment="Stretch">
    <ListView.View>
        <GridView>
            <GridViewColumn Header="Lines"
             DisplayMemberBinding="{Binding Path=aline}" />
        </GridView>
    </ListView.View>
</ListView > 
```

在我的程序中，我想检查 Binding 是否存在。

这应该如何实现？

**编辑：**这`aline`是`DataContext`对象的属性

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-27T16:29:53.277

您可以检查这样的绑定：

```
BindingExpression be = BindingOperations.GetBindingExpression(ListView1, ItemsSourceProperty);
return be != null ? "ItemsSource is bound" : "ItemsSource is not bound"; 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-02-27T16:16:54.790

```
if (ListView1.ItemsSource != null)
            Console.WriteLine("Is Bound");
        else Console.WriteLine("Is Not bound"); 
```

# iphone - 左侧的 PushViewController - 简单吗？

> ID：15116801
> 
> 赞同：3
> 
> 时间：2013-02-27T16:09:40.410
> 
> 标签：iphone, xcode, ios6, pushviewcontroller

我试图让我的 ViewController 以与标准 PushViewConrtoller 相同的速度从左滑到右，我没有使用 NavBar 也不想使用 Modal，有没有简单的方法可以做到这一点，我在不同的线程上看到了很多变化，但它们都不能正常工作！

我正在为我的 Push right 使用带有以下代码的导航控制器...

```
- (IBAction)launch1990:(id)sender {

UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"1990Storyboard" bundle:nil];
UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"1990"];
[self.navigationController pushViewController:vc animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T16:25:38.037

UIStroryBoard 当您推送视图控制器或 segues 时，它不会让您自定义太多。我最终做的是重写 perform 方法并使用 QuartzCore Animations 来自定义我们的过渡。我继承了 UIStoryBoardSegue 并覆盖了 perform 函数。

下面为 Push 或 Pop 定制，然后为 Segues 定制。（对于 segues，请记住将类更改为 IB 中的自定义类）。

要从普通的 pop 或 push（这确实交叉淡入淡出动画，请根据您的调整）：

```
 #import <QuartzCore/QuartzCore.h>

 - (IBAction)launch1990:(id)sender {
    CATransition* transition = [CATransition animation];
    transition.duration = .45;
    transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
    transition.type = kCATransitionFade;
    [self.navigationController.view.layer addAnimation:transition forKey:kCATransition];

    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"1990Storyboard" bundle:nil];
    UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"1990"];
    [self.navigationController pushViewController:vc animated:NO];
  } 
```

从 segue 做到这一点：

```
//ZHCustomSegue.h
#import <Foundation/Foundation.h>

@interface ZHCustomSegue : UIStoryboardSegue

@end

//  ZHCustomSegue.m
#import "ZHCustomSegue.h"
#import "QuartzCore/QuartzCore.h"

@implementation ZHCustomSegue

-(void)perform {

    UIViewController *sourceViewController = (UIViewController*)[self sourceViewController];
    UIViewController *destinationController = (UIViewController*)[self destinationViewController];

    CATransition* transition = [CATransition animation];
    transition.duration = .45;
    transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
    transition.type = kCATransitionFade; //kCATransitionMoveIn; //, kCATransitionPush,   kCATransitionReveal, kCATransitionFade
   //transition.subtype = kCATransitionFromLeft; //kCATransitionFromLeft, kCATransitionFromRight, kCATransitionFromTop, kCATransitionFromBottom

    [sourceViewController.navigationController.view.layer addAnimation:transition
                                                            forKey:kCATransition];

    [sourceViewController.navigationController pushViewController:destinationController animated:NO];

}
@end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-27T16:49:26.303

`CATransition`与_ `subtype: kCATransitionFromLeft`

```
CATransition *transition = [CATransition animation];
    transition.duration = .3;
    transition.type = kCATransitionMoveIn;
     transition.subtype= kCATransitionFromLeft;
    [self.navigationController.view.layer addAnimation:transition forKey:nil]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T16:21:51.787

做正常的导航vc推送，但事先：

```
vc.navigationBar.hidden = YES; 
```

# x86 - x86 微处理器的内存限制

> ID：15116802
> 
> 赞同：2
> 
> 时间：2013-02-27T16:09:49.290
> 
> 标签：x86, memory-model

我最近从一个在线资源开始学习计算机体系结构课程。我从我拿起的一本书中读到，x86 处理器有 32 条地址线，可以在数据总线上一次读取 4 个字节的数据。现在我了解到 32 条地址线将可寻址内存限制为 40 亿个唯一地址。我难以理解的事实是，如果 CPU 可以在每个周期从这 40 亿个唯一地址中的每一个读取 4 个字节的数据，为什么 x86 系统上的 RAM 限制为 4 GB。它不应该是 16 GB（4 乘以 4 GB）吗？有人可以帮我解决这个问题吗？另外，当我谈到 32 位或 64 位微处理器时，32/64 是指 CPU 上的地址线数还是数据线数？（对于我的第一个问题，我可能应该提到我'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:43:08.180

x86 微处理器是一个广泛的处理器类别，经过几十年的发展，从[8086](http://en.wikipedia.org/wiki/Intel_8086)发展到今天的 64 位多核 CPU。x86 处理器的优势之一是它们[向后兼容](http://en.wikipedia.org/wiki/Backward_compatibility)，这意味着该系列中最新的处理器能够理解 8086 的指令（它们必须以一种称为 的特殊模式运行`Real Mode`）。8086 有 16 位寄存器和 16 位总线到内存和 I/O，它是[字节可寻址](http://en.wikipedia.org/wiki/Byte_addressing)的，这意味着程序使用的地址是单个字节的地址。8086 可以从内存中加载 1 或 2 个字节（称为一个字）。随着时间的推移，较新的 x86 处理器向地址线添加了更多位，并添加了虚拟内存，并添加了更大的`words`. 所以一个 32 位的数据项被称为`double word`一个 64 位的数据项被称为 a `quad word`，然后 SSE 出现了，我们有了 128 位`octaword or double quadword`，[这是一个数据大小表](http://en.wikipedia.org/wiki/Integer_%28computer_science%29)。较新的 x86 处理器可以访问任何这些大小的数据，实际上最新的具有 256 位向量寄存器的[AVX 指令。](http://en.wikipedia.org/wiki/Advanced_Vector_Extensions)从程序的角度来看，寻址存储器仍然是通过给出最低地址的字节地址来完成的。

[您可以在此处](http://en.wikipedia.org/wiki/64-bit_computing)阅读有关 64 位计算的更多信息。这是一个很好的总结：

> 无需进一步限定，64 位计算机体系结构通常具有 64 位宽的整数和寻址寄存器，允许直接支持 64 位数据类型和地址。但是，CPU 可能具有与寄存器不同大小的外部数据总线或地址总线，甚至更大（例如，32 位 Pentium 具有 64 位数据总线）。

# java - Hibernate 使用数据库触发器填充主键

> ID：15116803
> 
> 赞同：1
> 
> 时间：2013-02-27T16:09:56.843
> 
> 标签：java, hibernate, jpa, oracle10g, jpa-2.0

我在 Spring 3 中使用 Hibernate 4.1.0.Final

我在实体类中有以下内容

```
@Id
@Column(name = "PROJECT_NO")
@GeneratedValue(strategy=GenerationType.TABLE)
private String projectNumber; 
```

是否可以使用数据库触发器来填充表的主键？或者我必须为此使用 CustomGenerator？

当我尝试上述方法时，出现以下异常

```
org.hibernate.id.IdentifierGenerationException: Unknown integral data type
for ids : java.lang.String 
```

数据库触发器没有任何序列，它正在使用

```
SELECT NVL (MAX (project_no), 0) + 1 FROM projects 
```

编辑 1

```
@GeneratedValue(generator="trig")
@GenericGenerator(name="trig", strategy="select", 
parameters=@Parameter(name="key", value="projectNo")) 
```

以上抛出以下异常

```
Hibernate: select PROJECT_NO from PROJECTS where PROJECT_NO =?

java.lang.NullPointerException
exception in save null
    at org.hibernate.tuple.entity.AbstractEntityTuplizer.getPropertyValue(AbstractEntityTuplizer.java:645)
    at org.hibernate.persister.entity.AbstractEntityPersister.getPropertyValue(AbstractEntityPersister.java:4268)
    at org.hibernate.id.SelectGenerator$SelectGeneratorDelegate.bindParameters(SelectGenerator.java:138)
    at org.hibernate.id.insert.AbstractSelectingDelegate.performInsert(AbstractSelectingDelegate.java:84)
    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2764)
    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3275)
    at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:81) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:20:57.613

问题是您使用的是字符串而不是数值。使用 Long 而不是 String，您的错误将消失。

AFAIK，您不能使用触发器来填充 ID。实际上，Hibernate 必须检索生成的 ID，但由于它没有 ID，我看不出它如何读回刚刚插入的行（鸡和蛋的问题）。

您可以在插入行之前使用 SQL 查询获取 ID，但这种策略效率低下，并且在并发插入的情况下存在重复 ID 的风险。所以我不会使用这个策略。您使用 Oracle 标记了您的帖子。我建议你使用一个序列。这就是他们的目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T16:20:15.287

在[Hibernate 3.3 文档页面上](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/mapping.html#mapping-declaration-id)，您可以这样做。

> **选择**
> 
> 通过按某个唯一键选择行并检索主键值来检索由数据库触发器分配的主键。

# c# - 为什么我的图像不显示在网格中？

> ID：15116805
> 
> 赞同：0
> 
> 时间：2013-02-27T16:10:00.740
> 
> 标签：c#, wpf, image, grid

我找不到图像不会显示在我创建的网格中的原因

```
Image img = new Image();

img.Source = new BitmapImage(new Uri(@"C:\logo.bmp", UriKind.Relative));

img.Width = 50;
img.Height = 50;
img.Margin = new Thickness(5, 5, 5, 5);

grid1.Children.Add(img); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:14:29.067

您的图像 URI 是绝对路径。

你应该写

```
img.Source = new BitmapImage(new Uri(@"C:\logo.bmp", UriKind.Absolute)); 
```

或更好

```
img.Source = new BitmapImage(new Uri(@"C:\logo.bmp")); 
```

# bash - 如何查看所有 bash 历史记录？

> ID：15116806
> 
> 赞同：40
> 
> 时间：2013-02-27T16:10:06.953
> 
> 标签：bash, shell, history

首先让我在下面展示一个示例。

在 shell(1) 中，我执行了以下命令。

```
$ ping google.com
PING google.com (74.125.235.164) 56(84) bytes of data.
64 bytes from nrt19s12-in-f4.1e100.net (74.125.235.164): icmp_seq=1 ttl=54 time=2.85 ms
64 bytes from nrt19s12-in-f4.1e100.net (74.125.235.164): icmp_seq=2 ttl=54 time=3.42 ms 
```

之后，打开另一个 shell(2) 并查看历史。

```
$ history
 .
 .
 .
 8720  exit
 8721  clear
 8722  history 
```

在这种情况下，shell 看不到 shell(1) 执行的历史记录，但我想查看每个 shell 中的所有 bash 历史记录。

所以我的问题是如何查看所有 bash 历史记录？有人知道如何破解吗？

非常感谢您！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2015-10-02T18:26:40.603

```
cat ~/.bash_history 
```

也可以，虽然我倾向于只使用

```
vim ~/.bash_history 
```

然后用于`/`搜索

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-02-27T16:12:38.923

您应该查看`histappend`shell 选项和`-a`标志`history`：

> **`histappend`**
> 
> 如果设置，历史列表将在 shell 退出时附加到由**`HISTFILE`**变量值命名的文件，而不是覆盖文件。
> 
> **`history`**
> 
> **`-a`** 将“新”历史记录行（自当前 bash 会话开始后输入的历史记录行）附加到历史记录文件。

如果你把`history -a`你的`PROMPT_COMMAND`，你会得到一个永远是最新的`.bash_history`文件。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-27T16:36:02.687

试试这个：

编辑您的 .bashrc 并将其附加到它的末尾：

```
shopt -s histappend
PROMPT_COMMAND="history -n; history -a"
unset HISTFILESIZE
HISTSIZE=2000 
```

来源：[http ://subbass.blogspot.com.br/2009/10/howto-sync-bash-history-between.html](http://subbass.blogspot.com.br/2009/10/howto-sync-bash-history-between.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-03-16T18:38:13.903

您可以安装诸如 Advanced Shell History 之类的东西，它将每个命令记录到 sqlite3 数据库中。它带有一个用于从命令行查询数据库的工具。 [https://github.com/barabo/advanced-shell-history](https://github.com/barabo/advanced-shell-history)

通过此设置，您将拥有所有会话中命令历史记录的统一视图。您还可以获得当前工作目录（或子树）的命令历史记录、命令退出代码、命令持续时间等内容。

完全披露：我编写并维护了该工具。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-01-22T21:31:20.607

正如一些人所指出的，您需要使用`shopt -s histappend`. 通过运行`shopt`并验证 histappend 是否“打开”来检查。

要确保每个命令（跨多个并发 shell）出现在每个 shell 的历史记录中，请将其添加到 .bashrc 文件的末尾：

```
# Skip if not an interactive shell
if [ -z "${PS1}" ]; then return; fi
export PROMPT_COMMAND="history -a; history -c, history -r; ${PROMPT_COMMAND} 
```

-a：将新的历史行（自当前 Bash 会话开始以来输入的历史行）附加到历史*文件*。

-c：清除历史*列表*。

-r：读取当前历史*文件*并将其内容附加到历史*列表中*。

运行`source .bashrc`或创建新会话，并在多个终端窗口`#Tn`中分别输入注释。然后在一个终端上，输入`history | tail -N`以查看最后 N 行。您应该会看到在不同终端上输入的所有评论。

将以下内容添加到 /etc/profile.d/bashrc.sh 以获取历史记录每一行的时间戳可能会有所帮助：

```
if [ -z "${PS1}" ]; then return; fi
export HISTTIMEFORMAT='%F %T ' 
```

结果如下所示：

```
 [moi@laBoheme ~]$ history | tail -4
 3292  2019-01-22 12:41:27  # T1
 3293  2019-01-22 12:41:34  # T2
 3294  2019-01-22 12:41:42  # T3
 3295  2019-01-22 12:41:50  history | tail -4 
```

# c# - 识别 N 维数据集中的差距

> ID：15116808
> 
> 赞同：2
> 
> 时间：2013-02-27T16:10:10.967
> 
> 标签：c#, math

我们有一个有趣的问题需要在这里解决，我们使用的是 C# .NET 4.0，但该语言应该是无关紧要的，因为它是一个数学问题。

**问题**：我们需要识别 N 维数据集中的差距，并将这些差距准确地报告给用户。

例如，假设我们正在使用 3-D，所以我们有这个`Quote`具有 6 个属性的对象：`TermFrom, TermTo, AgeFrom, AgetTo, AmountFrom, AmountTo`以及我们需要覆盖的边界：`MinTerm = 0, MaxTerm = 5, MinAge = 0, MaxAge = 5, MinAmount = 0, MaxAmount = 5`。假设所有最小值`0`和最大值`5`只是为了简化示例，尽管它们可能不同。因此，我们需要检查差距的数据是以下数据集：

```
Quote[] {
  {  TermFrom=0, TermTo=3, AgeFrom=0, AgetTo=4, AmountFrom=0, AmountTo=2  },
  {  TermFrom=4, TermTo=5, AgeFrom=0, AgetTo=5, AmountFrom=3, AmountTo=5  } 
```

该数据集包含组合的空白：（`{ Term: 0-5, Age: 4-5, Amount: 0-2 } and { Term: 0-3, Age: 0-5, Amount: 2-5 }, { Term: 4-5, Age: 0-5, Amount: 0-2 }`我认为）

即，如果您想象一个立方体并且数据集是该立方体的一部分，则计算出的所有数据集的总体积必须等于立方体的体积。如果它的体积未满，我们需要确定这个立方体中的间隙在哪里。

所有这些都需要更多的维度：4 和 5，但要可视化要困难得多。我希望有某种数学解决方案可以解决这个问题，我们可以将其转换为 c# 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:13:55.433

使用 kd 树，它的目的是为这些类型的应用程序划分空间。

# java - ThreadPoolExecutor 运行应用程序

> ID：15116818
> 
> 赞同：0
> 
> 时间：2013-02-27T16:10:34.020
> 
> 标签：java, multithreading, threadpool

计费类具有与国家计费相关的所有逻辑。它从数据库中获取结果，然后向用户收费。计费类实现 Runnable。我想根据国家参数并行执行计费，以便快速计费大量用户（500 万+）。现在需要几个小时才能完成。

我正在尝试实现 ThreadPoolExecutor 来执行 Billing 类，但我很困惑如何？以下有什么区别或者我做错了什么？请推荐！！总共有 20 个国家，但我在这里只粘贴 5 个。

```
 //for 20 countries  ThreadPoolExecutor (20,20,20.......)????

ThreadPoolExecutor executor = new ThreadPoolExecutor(5, 5, 5, TimeUnit.SECONDS, 
new ArrayBlockingQueue<Runnable>(10), new ThreadPoolExecutor.CallerRunsPolicy());

executor.execute(new Billing("UK")); 
executor.execute(new Billing("USA")); 
executor.execute(new Billing("Germany")); 
executor.execute(new Billing("Spain")); 
executor.execute(new Billing("Italy")); 
```

或者

```
ThreadPoolExecutor executor = new ThreadPoolExecutor(5, 5, 5, TimeUnit.SECONDS, 
new ArrayBlockingQueue<Runnable>(10), new ThreadPoolExecutor.CallerRunsPolicy());
for(int i=0;i<5;i++) // for 20 countries   i<20??
{    

   executor.execute(new Billing("UK")); 
   executor.execute(new Billing("USA")); 
   executor.execute(new Billing("Germany")); 
   executor.execute(new Billing("Spain")); 
   executor.execute(new Billing("Italy")); 
}

while (! executor.isTerminated()) {
   try{
      executor.awaitTermination(100, TimeUnit.SECONDS);
   }catch(InterruptedException iE)
   {
      iE.printStackTrace();
      System.out.println("Executor Exception: "+ iE);
   } 
```

提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:18:21.200

循环解决方案似乎不正确。无需`Runnable`多次执行相同的操作。

`ThreadPoolExecutor`您正在使用两者进行实例化`corePoolSize`并`maximumPoolSize`设置为`5`，这意味着执行程序会将池中的线程数保持为`5`，即使它们处于空闲状态。它还说`5`池中只能有线程。

有了这个，您可以期望最多`5`并行运行的线程执行任务（`Billing`对象）。

当您继续向with方法提交`Billing`对象时，它们将添加到您提供的方法中。这个队列的大小在这里。在某些情况下，队列可能已经达到其最大容量并且无法执行更多任务，在这种情况下，任务被拒绝并提供给构造函数中提供的任务。它的工作是用已实现的方法处理被拒绝的任务。`executor``execute``ArrayBlockingQueue``10``RejectedExecutionHandler``ThreadPoolExecutor``rejectedExecution`

如果您想查找是否有任何被拒绝的任务，您必须提供自己的任务，`RejectedExecutionHandler`而不是使用默认的`ThreadPoolExecutor.CallerRunsPolicy`. 你可以这样做：

```
ThreadPoolExecutor executor = new ThreadPoolExecutor(5, 5, 5,
        TimeUnit.SECONDS, new ArrayBlockingQueue<Runnable>(10),
        new RejectedExecutionHandler() {
            @Override
            public void rejectedExecution(Runnable r,
                    ThreadPoolExecutor executor) {
                System.out.println("I got rejected: " + r);
                if (!executor.isShutdown()) {
                    r.run();
                }
            }
        }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:41:29.770

第一：忘记循环

```
for(int i=0;i<5;i++) // for 20 countries   i<20??
{    

   executor.execute(new Billing("UK")); 
   executor.execute(new Billing("USA")); 
   executor.execute(new Billing("Germany")); 
   executor.execute(new Billing("Spain")); 
   executor.execute(new Billing("Italy")); 
} 
```

这会多次循环所有帐单。

正确的做法是在第一个片段中：

```
executor.execute(new Billing("UK")); 
executor.execute(new Billing("USA")); 
executor.execute(new Billing("Germany")); 
executor.execute(new Billing("Spain")); 
executor.execute(new Billing("Italy")); 
```

另一个错误在于终止检查：

```
while (! executor.isTerminated()) {
   try{
      executor.awaitTermination(100, TimeUnit.SECONDS);
   }catch(InterruptedException iE)
   {
      iE.printStackTrace();
      System.out.println("Executor Exception: "+ iE);
   }
} 
```

的 javadoc`Executor.awaitTermination`说：

> 在关闭请求后阻塞，直到所有任务都完成执行，

但你永远不会发出关闭请求。

在您的情况下，您可以利用`ExecutorCompletionService`如下：

```
CompletionService<String> ecs = new ExecutorCompletionService<String>(executor);
List<String> countries= Arrays.asList("UK","USA","Germany","Spain","Italy");   
for(String country : countries) {
    ecs.submit(new Billing(country),country);
}
// wait for completion
for(int i=0;i<countries.size();i++){
      ecs.take(); // wait for next country completion
}
// all work completed, shutdown
executor.shutdownNow(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:17:34.307

我不确定你是否理解循环是如何工作的。不同之处在于第二个代码块将在每个列出的国家/地区运行 5 次计费。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T16:19:42.917

假设您正在谈论`for`代码的循环部分，那么它是如何工作的并不明显。

理想情况下，循环看起来像这样：

```
for(String country : countryCollection) {
    executor.execute(new Billing(country));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T16:32:32.590

您是否考虑过使用`enum`?

```
static class Billing implements Runnable {

  enum Country {
    UK,
    USA,
    Germany,
    Spain,
    Italy;
  }

  public Billing(Country country) {
  }

  @Override
  public void run() {
  }
}
public void test() {
  ThreadPoolExecutor executor = new ThreadPoolExecutor(5, 5, 5, TimeUnit.SECONDS,
       new ArrayBlockingQueue<Runnable>(10), 
          new ThreadPoolExecutor.CallerRunsPolicy());
  for ( Billing.Country country : Billing.Country.values() ) {
    executor.execute(new Billing(country));
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T16:42:52.040

考虑实现这一点的另一种方法是查看[The Fork/Join Framework](http://docs.oracle.com/javase/tutorial/essential/concurrency/forkjoin.html)。这似乎真的可以从工作中受益。例如，您可以看似相当干净地将其分解。这基本上将允许您分解按用户或用户子集计费的任务，而不是让一个看似代表一个国家/地区的线程通过其所有计费工作。

您可以找到该库的链接：[如果您使用的是 Java < 7 版本，请点击此处](http://g.oswego.edu/dl/concurrency-interest/)

# c# - ObservableCollection 更新元素内容：没有收到通知

> ID：15116819
> 
> 赞同：0
> 
> 时间：2013-02-27T16:10:34.487
> 
> 标签：c#, observablecollection, inotifypropertychanged

我已将我的数据网格绑定到我的 ViewModel 元素的可观察集合，然后将其链接到 NotifyCollectionChangedEventHandler 事件：

```
obsListOfClients = new ObservableCollection<ClientVM>();
foreach (var c in contexte.listOfClients)
{
    ClientVM cvm = new ClientVM(c);
    obsListOfClients.Add(cvm);
}
obsListOfClients.CollectionChanged += new System.Collections.Specialized.NotifyCollectionChangedEventHandler(collectionOfClientssChanged); 
```

我正在我的 vue 中编辑我的数据网格，我希望能够添加/删除、更新内容并在每个操作完成时得到通知：我已经创建了这个功能：

```
 void collectionOfClientssChanged(object sender, NotifyCollectionChangedEventArgs e)
 {
     switch (e.Action)
     {
         case NotifyCollectionChangedAction.Add:
         //Ajouter dans la base de données :
             for(int i = 0; i<e.NewItems.Count;i++)
             {
                 ClientVM item = e.NewItems[i] as ClientVM;
                 contexte.ListOfClientsToAdd.Add(item.Client);
             }
             break;

         case NotifyCollectionChangedAction.Remove:
             for(int i = 0; i < e.OldItems.Count; i++)
             {
                 ClientVM item = e.OldItems[i] as ClientVM;
                 contexte.ListOfClientsToRemove.Add(item.Client);
             }
             break;

         case NotifyCollectionChangedAction.Replace:
             for(int i = 0; i < e.OldItems.Count; i++)
             {
                 ClientVM item = e.OldItems[i] as ClientVM;
                 contexte.ListOfClientsToUpdate.Add(item.Client);
             }
             break;
     }
} 
```

然后我使用我的三个列表（ListOfClientsToUpdate、ListOfClientsToRemove、ListOfClientsToAdd）来跟踪我的更改并能够在数据库中推送所有修改。

问题是，当我在数据网格中添加或删除行时，我收到通知并且列表中充满了元素，但是当我更新现有行的内容时，我什至没有收到有关集合更改的通知！ ！！所以我无法跟踪我对现有元素的修改！

任何的想法 ？多谢 ：） ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:13:51.360

要检测列表中元素的更改，您需要侦听 ClientVM 上的属性更改，因为这些不计入客户端列表的更改。

非常粗略地，您可以执行以下操作：

```
obsListOfClients = new ObservableCollection<ClientVM>();
foreach (var c in contexte.listOfClients)
{
    ClientVM cvm = new ClientVM(c);
    // NEW BIT HERE
    cvm.PropertyChanged += ClientVMChangedEventHandler;
    obsListOfClients.Add(cvm);
}
obsListOfClients.CollectionChanged += ...;

private void ClientVMChangedEventHandler(object sender,
                                         PropertyChangedEventArgs e)
{
    contexte.ListOfClientsToUpdate.Add(((ClientVM)sender).Client);
} 
```

添加新项目时也这样做。删除项目时不要忘记删除事件处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:14:01.797

是否`ClientVM`实现`INotifyPropertyChanged`接口？另外：您正在监视集合本身的更改，而不是他们的项目。

`CollectionChanged`当集合项的属性发生更改时，不应调用该事件，而仅当集合本身发生更改时才调用该事件-这就是您所经历的。

要获得有关单个项目更改的通知，我建议您订阅/取消订阅从您上面发布的代码中添加/替换/删除`PropertyChanged`的每个实例的事件。添加和删​​除案例的示例可能是：`ClientVM``ObservableCollection`

```
switch (e.Action)
{
    case NotifyCollectionChangedAction.Add:
        for(int i = 0; i<e.NewItems.Count;i++)
        {
            ClientVM item = e.NewItems[i] as ClientVM;
            item.PropertyChanged += ItemPropertyChanged;
            contexte.ListOfClientsToAdd.Add(item.Client);
        }
        break;

    case NotifyCollectionChangedAction.Remove:
        for(int i = 0; i < e.OldItems.Count; i++)
        {
            ClientVM item = e.OldItems[i] as ClientVM;
            item.PropertyChanged -= ItemPropertyChanged;
            contexte.ListOfClientsToRemove.Add(item.Client);
        }
        break;
} 
```

作为`ItemPropertyChanged`事件处理程序：

```
private void ItemPropertyChanged(object sender, PropertyChangedEventArgs e)
{
    // Handle property change here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T16:14:54.740

那是因为您的收藏实际上并**没有**改变。集合中的每个元素都是对对象的*引用*。对象发生了变化，但引用保持不变。因此，集合不会改变。

对可观察集合的**更新**操作意味着用不同的元素替换元素。这不是你的情况。

您将需要一个更复杂的解决方案来解决您的问题，该解决方案还注册集合中对象的属性更改通知。

# jsf - JSF 登录过滤器，会话为空

> ID：15116820
> 
> 赞同：2
> 
> 时间：2013-02-27T16:10:36.477
> 
> 标签：jsf, session, null, servlet-filters

我一直试图主要遵循[这个](https://stackoverflow.com/questions/8480100/how-implement-a-login-filter-in-jsf)答案，但我总是被重定向到我的 login.xhtml （除了当我从登录页面登录时），因为这......

```
AppManager am = (AppManager) req.getSession().getAttribute("appManager"); 
```

始终为空。我一直在尝试在登录屏幕上打印出用户信息，无论我如何到达那里，所有字段（用户名、密码、登录...）始终为空，即使我直接从管理页面输入地址（即登录时获得的位置）。我如何才能保存会话，而不是每次我手动输入地址/离开页面时都被鞭打？

应用管理器：

```
import java.io.Serializable;
import javax.ejb.EJB;
import javax.enterprise.context.SessionScoped;
import javax.faces.bean.ManagedBean;
import javax.faces.context.FacesContext;
import jobapp.controller.Controller;

@ManagedBean(name="appManager")
@SessionScoped
public class AppManager implements Serializable {
private static final long serialVersionUID = 16247164405L;
    @EJB
    private Controller controller;
    private String username;
    private String password;
    private boolean loggedIn;
    private Exception failure;
    ...
     /**
     * 
     * @param e an exception to handle.
     */
    private void handleException(Exception e) {
        e.printStackTrace(System.err);
        failure = e;
        FacesContext.getCurrentInstance().getExternalContext().invalidateSession();
    }

    /**
     * The login method.
     * calls the controllers login method.
     * 
     */ 
    public void login(){
        try{
            failure = null; 
            loggedIn = controller.login(username, password);

        }catch (Exception e){
            handleException(e);
        }
    }
    /**
     * The logout method.
     * Sets the user's info to null
     * and stops the conversation.
     */
    public void logout(){
        username = null;
        password = null;
        loggedIn = false;
        FacesContext.getCurrentInstance().getExternalContext().invalidateSession();
    }
... 
```

筛选：

```
@WebFilter("/faces/admin.xhtml")
public class LoginFilter implements Filter {
...
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws ServletException, IOException {    
        HttpServletRequest req = (HttpServletRequest) request;
        //TODO fix "am" nullpointer
        AppManager am = (AppManager) req.getSession().getAttribute("appManager");
        if (am != null && am.isLoggedIn()) {
            // User is logged in, so just continue request.
            chain.doFilter(request, response);
        } else {
            // User is not logged in, so redirect to login.
            HttpServletResponse res = (HttpServletResponse) response;
            res.sendRedirect(req.getContextPath() + "/faces/login.xhtml");
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:00:46.710

> *@SessionScoped 来自 javax.enterprise.context.SessionScoped*

这个仅与 CDI 结合使用`@Named`。当您使用 JSF[`@ManagedBean`](http://docs.oracle.com/javaee/6/api/javax/faces/bean/ManagedBean.html)时，您应该使用`javax.faces.bean`包中的范围注释。

```
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

@ManagedBean
@SessionScoped
public class AppManager implements Serializable { 
```

如果没有有效的作用域，JSF 托管 bean 的行为将类似于[`@RequestScoped`](http://docs.oracle.com/javaee/6/api/javax/faces/bean/RequestScoped.html)这实际上意味着它在每个请求上一次又一次地构造。

# asp.net-web-api - ASP.Net Web API 帮助页面：忽略某些属性

> ID：15116822
> 
> 赞同：16
> 
> 时间：2013-02-27T16:10:40.977
> 
> 标签：asp.net-web-api

是否可以让帮助页面示例生成器忽略特定类型的某些属性？

例如，对于 POST 和 PUT 请求，我们对对象请求和响应消息使用相同的 DTO。当用户发布模型（创建新记录）时，他们不需要提供 ID 字段。

但是一旦它被创建并且我们将新记录序列化到响应正文中，ID 字段就会被包含并返回给客户端。

所以在 POST 请求示例中，我不希望显示 ID 字段，因为对于 post 请求它没有意义。

但是 POST 响应示例，我确实希望显示 ID 字段...

我知道有`ApiExplorerSettings`可以应用于类或方法的属性......但是属性有什么类似的吗？

这样的事情会很棒：

```
public class MyDTO
{
    [ApiExplorerSettings(IgnoreForRequestApi = true, IgnoreForResponseApi = false)]
    public int Id { get; set; }

    // Other properties omitted for brevity...
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-05-01T10:00:28.787

使用下面的注释，我已经成功地从一代中隐藏了一个属性！

```
[ApiExplorerSettings(IgnoreApi = true)] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T17:39:56.977

不，没有类似的属性选项。HelpPage 使用在应用程序上配置的格式化程序实例来序列化样本，并且您可以想象格式化程序本身必须没有这些知识。

关于解决方法：

一个。*您可以通过 HttpRequestMessage 的SetSampleRequest*扩展为特定操作的 requestsample 显式设置原始样本。您应该能够在 *Areas\HelpPage\App_Start\HelpPageConfig.cs* 的文件中看到一些关于此的示例。

湾。在文件*Areas\HelpPage\SampleGeneration\HelpPageSampleGenerator.cs*中，有一个名为*WriteSampleObjectUsingFormatter*的方法，它使用应用程序的格式化程序实例来编写样本。在这里，您需要创建与普通应用程序具有相似设置的**新**格式化程序实例（以便它们反映您的应用程序在发出实际请求时通常会做出反应的确切序列化/反序列化语义），然后尝试隐藏您的属性想要。我们想要创建新实例，因为我们不想干扰应用程序的正常运行。

示例：对于 Json，您可以创建一个新的 Json 格式化程序实例并提供一个可以隐藏属性的*ContractResolver 。*检查此链接：http: [//james.newtonking.com/projects/json/help/html/ConditionalProperties.htm](http://james.newtonking.com/projects/json/help/html/ConditionalProperties.htm)

在 Xml 的情况下，我不确定我们如何在不使用 IgnoreDataMember 属性的情况下隐藏属性并且也不是侵入性的。

**目前，我更喜欢选项“a”，因为它比“b”更简单。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-17T07:58:34.553

ASP.NET WEB API 将 Json.NET 用于 JSON 和`DataContarctSerailizer`XML 格式设置，因此如果您`[JsonIgnore]`在不希望包含在序列化中的属性上添加注释应该可以正常工作。

# android - 如何在表格上叠加图形？

> ID：15116823
> 
> 赞同：0
> 
> 时间：2013-02-27T16:10:52.880
> 
> 标签：android, graphics, android-tablelayout

我有一个界面，它是一个带有 3x3 组图标（漂亮的数字`ImageView`s）的表格，缩放以适应显示器。我的视图结构是：

```
TableLayout
Row - Header graphic
Row - horizontal separator
Row - 3 buttons
Row - 3 buttons
Row - 3 buttons
Row - horizontal separator
Row - scroll view of buttons 
```

当用户选择一个图标时，我用背景图形突出显示它。

我想在每个按钮上添加叠加层以显示进度，例如我们在许多游戏中显示成就的星星。例如。显示第 4 级的“4”图标，并根据完成的程度用 1、2 或 3 颗星覆盖它。我不知道该怎么做！中只有一个图形选项`ImageView`。

# c++ - GtkGrid 没有显示附加到它的新小部件

> ID：15116828
> 
> 赞同：3
> 
> 时间：2013-02-27T16:11:11.677
> 
> 标签：c++, c, gtk

我决定制作一个玩具应用程序，在其中我通过向 GtkGrid 添加元素的行/列来调整标签表的大小。

从按钮回调函数内部向 GtkGrid 添加新元素时，网格小部件会更新其大小，但无法更新内容。

```
#include <gtk/gtk.h>

static void kaboom(GtkWidget*, gpointer);
static void minusVert(GtkWidget*, gpointer);
static void plusVert(GtkWidget*, gpointer);

static int x = 1;
static int y = 1;

int main(int argc, char** argv) {
    GtkWidget* window, *subs, *buts, *grid, *button;

    gtk_init(&argc, &argv);

    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);
    gtk_window_set_title(GTK_WINDOW(window), "Playground!!");
    gtk_widget_set_size_request(window, 200, 50);

    g_signal_connect(G_OBJECT(window), "destroy", G_CALLBACK(kaboom), NULL);

    subs = gtk_paned_new(GTK_ORIENTATION_VERTICAL);
    gtk_container_add(GTK_CONTAINER(window), subs);

    grid = gtk_grid_new();
    gtk_paned_pack1(GTK_PANED(subs), grid, true, false);

    gtk_grid_set_row_homogeneous(GTK_GRID(grid), true);
    gtk_grid_set_column_homogeneous(GTK_GRID(grid), true);

    gtk_grid_attach(GTK_GRID(grid), gtk_label_new("×"), 0, 0, 1, 1);

    buts = gtk_grid_new();
    gtk_paned_pack2(GTK_PANED(subs), buts, false, false);

    gtk_grid_set_row_homogeneous(GTK_GRID(grid), true);
    gtk_grid_set_column_homogeneous(GTK_GRID(buts), true);

    gtk_grid_attach(GTK_GRID(buts), gtk_label_new("Vertical"), 0, 0, 2, 1);

    button = gtk_button_new_with_label("-");
    g_signal_connect(G_OBJECT(button), "clicked", G_CALLBACK(minusVert), grid);
    gtk_grid_attach(GTK_GRID(buts), button, 0, 1, 1, 1);

    button = gtk_button_new_with_label("+");
    g_signal_connect(G_OBJECT(button), "clicked", G_CALLBACK(plusVert), grid);
    gtk_grid_attach(GTK_GRID(buts), button, 1, 1, 1, 1);

    gtk_grid_attach(GTK_GRID(buts), gtk_label_new("Horizontal"), 2, 0, 2, 1);

    button = gtk_button_new_with_label("-");
    gtk_grid_attach(GTK_GRID(buts), button, 2, 1, 1, 1);

    button = gtk_button_new_with_label("+");
    gtk_grid_attach(GTK_GRID(buts), button, 3, 1, 1, 1);

    gtk_widget_show_all(window);

    gtk_main();

    return 0;
}

static void kaboom(GtkWidget* window, gpointer data) {
    gtk_main_quit();
}

static void minusVert(GtkWidget *button, gpointer data) {
    if (y > 1) {
        // Remove all the elems in the last row
        for (int i = 0; i < x; ++i) {
            gtk_widget_destroy(gtk_grid_get_child_at(GTK_GRID(data), i, y - 1));
        }
        --y;
    }
}

static void plusVert(GtkWidget *button, gpointer data) {
    for (int i = 0; i < x; ++i) {
        // Add the new row
        gtk_grid_attach(GTK_GRID(data), gtk_label_new("×"), i, y, 1, 1);
    }
    ++y;
} 
```

前后截图：

![之前和之后的截图](../Images/cfaaa78deb8920da3da8484d98f8c815.png)

我的问题是：如何使新标签附加到`GtkGrid`可见标签上？

注意：我使用的是 C++，但不是 GTKmm，因为我正在阅读一本为 GTK+ 编写的书。即使移植到纯 C，应用程序的行为也是一样的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:11:25.263

创建小部件时，默认情况下不会显示这些小部件。你必须告诉他们这样做。您可以将回调更改`plusVert`为：

```
static void plusVert(GtkWidget *button, gpointer data) {
  for (int i = 0; i < x; ++i) {
    GtkWidget *label = gtk_label_new("×");
    gtk_grid_attach(GTK_GRID(data), label, i, y, 1, 1);
    gtk_widget_show(label);
  }
  ++y;
} 
```

请参阅[gtk_widget_show()](http://developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-show)。

# database-design - sqlalchemy 图数据库数据操作

> ID：15116830
> 
> 赞同：0
> 
> 时间：2013-02-27T16:11:14.327
> 
> 标签：database-design, graph, sqlalchemy

我正在设计一个图形数据库结构。一个节点可以是一个人、一个部门等。这就是我添加 nodeType 的原因。节点之间的关系也可以是多种类型。从下面的代码中，r1 和 r2 被插入到数据库中。当我阅读数据库时，我看到 null null null。这是为什么 ？我希望看到与.id 字段相关的值（例如 n1.id、rt1.id、n2.id）

```
from sqlalchemy import MetaData, Table, Column, Integer, ForeignKey, \
    create_engine, String
from sqlalchemy.orm import mapper, relationship, sessionmaker
from sqlalchemy.ext.declarative import declarative_base

engine = create_engine('sqlite:///dir_graph.sqlite', echo=True)

Base = declarative_base()
Session = sessionmaker(bind=engine)
session = Session()

class NodeType(Base):
    __tablename__ = 'nodetype'
    id      = Column(Integer, primary_key=True)
    name    = Column(String(20), unique=True)
    nodes   = relationship('Node', backref='nodetype')

    def __init__(self, name):
        self.name = name

    def __repr__(self):
        return "Nodetype: %s" % (self.name)

class Node(Base):
    __tablename__ = 'node'

    id = Column(Integer, primary_key=True)
    name = Column(String(20), unique=True)
    type_id = Column(Integer,
                        ForeignKey('nodetype.id')) 

    def __init__(self, _name, _type_id):
        self.name = _name
        self.type_id = _type_id

class Relation(Base):
    __tablename__ = 'relation'

    id      = Column(Integer, primary_key=True)
    name    = Column(String(20), unique=True)
    type_id = Column(Integer,
                        ForeignKey('relationtype.id')) 

    from_id = Column(Integer,
                        ForeignKey('node.id'))

    to_id = Column(Integer,
                        ForeignKey('node.id'))

    def __init__(self, _fromNode, _type_id, _toNode):
            self.from_id = _fromNode
            self.type_id =  _type_id
            self.to_id   = _toNode

class RelationType(Base):
    __tablename__ = 'relationtype'

    id             = Column(Integer, primary_key=True)
    name           = Column(String(20), unique=True)
    description    = Column(String(30), unique=True)

    relations      = relationship('Relation', backref='relationtype')

    def __init__(self, _name):  
        self.name = _name

    def description(self, _description):
        self.description = _description  
Base.metadata.create_all(engine)

nt1 = NodeType('nt1')
nt2 = NodeType('nt2')

n1 = Node('n1type1', 1)
n2 = Node('n2type1', 1)
n3 = Node('n3type1', 1)
n4 = Node('n4type2', 2)
n5 = Node('n5type2', 2)

rt1 = RelationType('rt1')
rt2 = RelationType('rt2')
rt3 = RelationType('rt3')

r1 = Relation(n1.id,rt1.id,n2.id)
r2 = Relation(n3.id,rt2.id,n5.id)

session.add_all([nt1,nt2,n1,n2,n3,n4,n5,rt1,rt2,rt3,r1,r2])
session.commit() 
```

其他关于代码改进的评论也值得赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:14:26.743

您的代码的问题是您在将节点插入数据库之前尝试使用 Node.id 属性。在您调用`session.flush()`or之前`session.commit()`，新创建的对象没有 ID，并且不能，因为它是生成 ID 的数据库引擎。

所以 SQLAlchemy 这样做的方法是定义`Relation`对象和`Node`对象之间的关系，并分配对象`Relation.__init__`而不是分配 id。像这样：

```
from sqlalchemy import MetaData, Table, Column, Integer, ForeignKey, \
    create_engine, String
from sqlalchemy.orm import mapper, relationship, sessionmaker
from sqlalchemy.ext.declarative import declarative_base

engine = create_engine('sqlite:///dir_graph.sqlite', echo=True)

Base = declarative_base()
Session = sessionmaker(bind=engine)
session = Session()

class NodeType(Base):
    __tablename__ = 'nodetype'
    id = Column(Integer, primary_key=True)
    name = Column(String(20), unique=True)
    nodes = relationship('Node', backref='nodetype')

    def __init__(self, name):
        self.name = name

    def __repr__(self):
        return "Nodetype: %s" % self.name

class Node(Base):
    __tablename__ = 'node'

    id = Column(Integer, primary_key=True)
    name = Column(String(20), unique=True)
    type_id = Column(Integer,
                     ForeignKey('nodetype.id'))

    def __init__(self, _name, _type_id):
        self.name = _name
        self.type_id = _type_id

class Relation(Base):
    __tablename__ = 'relation'

    id = Column(Integer, primary_key=True)
    name = Column(String(20), unique=True)
    type_id = Column(Integer,
                     ForeignKey('relationtype.id'))

    from_id = Column(Integer,
                     ForeignKey('node.id'))

    to_id = Column(Integer,
                   ForeignKey('node.id'))

    from_node = relationship(Node, primaryjoin=Node.id == from_id)
    to_node = relationship(Node, primaryjoin=Node.id == to_id)

    def __init__(self, _fromNode, _type_id, _toNode):
        self.from_node = _fromNode
        self.type_id = _type_id
        self.to_node = _toNode

class RelationType(Base):
    __tablename__ = 'relationtype'

    id = Column(Integer, primary_key=True)
    name = Column(String(20), unique=True)
    description = Column(String(30), unique=True)

    relations = relationship('Relation', backref='relationtype')

    def __init__(self, _name):
        self.name = _name

    def description(self, _description):
        self.description = _description

Base.metadata.create_all(engine)

nt1 = NodeType('nt1')
nt2 = NodeType('nt2')

n1 = Node('n1type1', 1)
n2 = Node('n2type1', 1)
n3 = Node('n3type1', 1)
n4 = Node('n4type2', 2)
n5 = Node('n5type2', 2)

rt1 = RelationType('rt1')
rt2 = RelationType('rt2')
rt3 = RelationType('rt3')

r1 = Relation(n1, rt1.id, n2)
r2 = Relation(n3, rt2.id, n5)

session.add_all([nt1, nt2, n1, n2, n3, n4, n5, rt1, rt2, rt3, r1, r2])
session.commit() 
```

# tfs - TFS 中的可追溯性矩阵？

> ID：15116832
> 
> 赞同：1
> 
> 时间：2013-02-27T16:11:15.950
> 
> 标签：tfs

是否有在 TFS中实现[可追溯性矩阵的最佳实践？](http://en.wikipedia.org/wiki/Traceability_matrix)

我们目前正在努力解决如何配置区域、迭代以及如何构建“矩阵”。我们计划将这些区域用作“功能组件”和软件版本的迭代。

最后，我们希望能够创建这样的报告：

```
 | Release_1 | Release_2 | Release_3
-------------------------------------------------------
Requirement 1      |    X           X
Requirement 2      |                            X
Requirement 3      |    X                       X 
```

对我们来说重要的一点是为特定版本生成完整的需求列表。我们面临的问题是发布是增量开发的。这意味着随着时间的推移会增加新的要求。我们知道正在寻找一种简单的方法来将旧的/现有的需求链接到特定的版本，而无需复制每个需求。

有人可以建议一种实现上述矩阵的方法吗？

编辑：

需求是指要实现的功能。Release 是一个特定的软件版本。需求会逐渐添加到版本中。这意味着实现的需求数量可能会随着版本的发布而增长。我们现在可以做的是将需求的实现链接到特定的版本（迭代）。但所有后续版本（迭代）都会自动包含此要求，因为我们是增量工作的。但也有可能在下一个版本中需求被更改甚至过时。我们如何处理这个问题才能获得特定版本的完整/完整需求列表？

# drupal - Drupal Commerce 产品属性

> ID：15116833
> 
> 赞同：0
> 
> 时间：2013-02-27T16:11:17.417
> 
> 标签：drupal, drupal-7, drupal-commerce

到目前为止，我正在尝试将产品属性添加到我的 drupal 商业商店，但没有成功。

我创建了一个产品展示，其中显示了我的标题、价格和一般产品，然后是一个不同颜色的产品列表

我的产品显示引用了我的“产品参考”，并且在创建新显示时，我按预期提供了标题、正文的表单，并且我可以选择所有颜色，但是一旦保存，用户就没有下拉菜单可供选择颜色，它总是默认为创建产品展示时首先选择的任何颜色

任何帮助或提示将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-23T21:04:26.440

对于选择颜色，可以帮助模块[Commerce Fancy Attributes](https://drupal.org/project/commerce_fancy_attributes)

# python - %reset 后重新加载自动导入

> ID：15116847
> 
> 赞同：0
> 
> 时间：2013-02-27T16:12:12.677
> 
> 标签：python, ipython

如果我的 IPython 会话运行时间过长（[请参阅这篇文章的评论](https://stackoverflow.com/a/14511382/198633)），我有冲动`exit()`重启 IPython 以释放该会话中所有变量占用的内存。但是，重新启动占用了宝贵的几秒钟，我觉得这很烦人（并不是说我不能学会忍受它，但我不应该这样做）。

我发现了杀死我所有变量的魔法函数`%reset`（耶！），但这样做也杀死了导入我的命名空间的名称。其中包括在 中定义的自动导入`~/.ipython/profile_default/startup/00-imports.py`，这是我希望在 IPython 会话开始时执行的导入。

有没有办法让我重新运行这些导入（有点像`source`bash 中的命令）；或者更好的是，是否有一个版本`%reset`可以杀死我的变量，而不是导入？

**技术细节**：

1.  IPython 版本：0.13.1
2.  操作系统：MAC OS X 10.7.5 (Lion)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:22:31.620

定义你自己的魔法函数

*   通话重置
*   重新导入您的导入

你可能会称之为

```
%deset 
```

或类似的东西。

您需要学习如何做的一切都[在这里](http://ipython.org/ipython-doc/stable/interactive/reference.html)。

# sublimetext2 - 在 Sublime Text 中更改“转到任何内容”的默认行为

> ID：15116856
> 
> 赞同：3
> 
> 时间：2013-02-27T16:12:43.153
> 
> 标签：sublimetext2, sublimetext

当我按下 时`CTRL + P`，我想避免特定文件夹的建议文件（在我的例子中是 doc/）。
有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T17:11:29.847

*我已经在评论中回答了这个问题，但我在这里提供了一个答案，这样它就不再被标记为未回答。*

[Sublime 论坛](http://www.sublimetext.com/forum/viewtopic.php?f=2&t=7340)上有一个类似的主题讨论这个问题。

简而言之，您需要将以下内容添加到您的用户设置 ( `Preferences -> Settings - User`) 以及您希望忽略的任何其他目录或文件类型。

```
// folder_exclude_patterns and file_exclude_patterns control which files
// are listed in folders on the side bar. These can also be set on a per-
// project basis.
"folder_exclude_patterns": [".svn", ".git", ".hg", "CVS"],
"file_exclude_patterns": ["*.pyc", "*.pyo", "*.exe", "*.dll", "*.obj","*.o", "*.a", "*.lib", "*.so", "*.dylib", "*.ncb", "*.sdf", "*.suo", "*.pdb", "*.idb", ".DS_Store", "*.class", "*.psd", "*.db"],
// These files will still show up in the side bar, but won't be included in
// Goto Anything or Find in Files
"binary_file_patterns": ["*.jpg", "*.jpeg", "*.png", "*.gif", "*.ttf", "*.tga", "*.dds", "*.ico", "*.eot", "*.pdf", "*.swf", "*.jar", "*.zip"], 
```

# javascript - 添加回调到 $(xml).find("..").each

> ID：15116857
> 
> 赞同：1
> 
> 时间：2013-02-27T16:12:45.840
> 
> 标签：javascript, jquery

是否可以向此循环添加回调？作为让应用程序知道“现在是时候执行此操作..”的一种方式..？

```
$(xml).find("book").each(function(){
    var id = $(this).find("id").text(); 
    var x = $(this).find("x").text();   
    var y = $(this).find("y").text();   
    var z = $(this).find("z").text();   

    hasItem(id, x, y, z, function(flag, id, x, y, z) {
        if(!flag) {
            //doing something
        }
    });
}); 

//add callback to tell me that all rows of xml has been read and hasItem is done reading? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:15:21.637

即使它是一个异步操作，你为什么不在完成后调用一个函数呢？

```
function done(){
    // completed...
}
var total = $(xml).find("book").length;
$(xml).find("book").each(function(index, element){
    var id = $(this).find("id").text(); 
    var x = $(this).find("x").text();   
    var y = $(this).find("y").text();   
    var z = $(this).find("z").text();  
    hasItem(id, x, y, z, function(flag, id, x, y, z) {
        if(!flag) {
            //doing something
            if(total == index+1)
               done();
        }
    });
}); 
```

# javascript - 将数据标签对齐到列高图的顶部

> ID：15116858
> 
> 赞同：0
> 
> 时间：2013-02-27T16:12:50.630
> 
> 标签：javascript, formatting, alignment, highcharts

如果该列正在上升，我正在尝试将列内的数据标签放在顶部，如果该列现在正在下降，则将其放在底部，并且此代码与中间的左侧对齐。

```
plotOptions: {
        series: {
        stacking: 'normal',
            dataLabels: {
                align: 'top',
                enabled: true,
                formatter: function() {
                    return this.y.toFixed(2) +' %';
                }
            }
        }
    }, 
```

我该怎么做？此外，如果 highcharts 显示的列不如文本宽，我将如何检查并将文本放在列上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:20:37.923

您可以通过翻译功能将数据标签“移动”到负列的底部。

[http://jsfiddle.net/wMLg6/33/](http://jsfiddle.net/wMLg6/33/)

```
 var datalabel;

        $.each(chart.series[0].data,function(j,data){
            if(data.y < 0)
            {
                datalabel = data.dataLabel;
                datalabel.translate(datalabel.x,data.plotY-20);
            }
        }); 
```

# xsl-fo - 标题接近编号时的 TOC 格式问题

> ID：15116859
> 
> 赞同：2
> 
> 时间：2013-02-27T16:12:50.397
> 
> 标签：xsl-fo, apache-fop, dita

我遇到过这样一种情况，如果 TOC 标题太接近 TOC 编号，它会将编号向内拉。

在这里，您可以看到几个示例，其中我开始一次添加/删除一个字符，以查看它何时会错误地将编号向内拉动与正确换行到下一行。

![目录格式不正确](../Images/08002d4708cb15265b32192abfc483df.png)

这是来自 topic.fo 的两个块。第一个是不拉入 TOC 编号，第二个是拉入编号。

```
<fo:block
    start-indent="0in + (2 * 30pt) + 14pt">
    <fo:block
        end-indent="22pt"
        font-size="10pt"
        font-style="italic"
        font-weight="normal"
        last-line-end-indent="-22pt"
        text-align="justify"
        text-align-last="justify"
        text-indent="-14pt"
        line-height-shift-adjustment="disregard-shifts"
        font-family="Helvetica, Arial Unicode MS">
        <fo:basic-link
            internal-destination="_OPENTOPIC_TOC_PROCESSING_d73e797"
            line-height="150%"
            line-height-shift-adjustment="disregard-shifts"
            font-family="Helvetica, Arial Unicode MS">
            <fo:inline
                end-indent="14pt"
                keep-together.within-line="auto"
                line-height-shift-adjustment="disregard-shifts"
                font-family="Helvetica, Arial Unicode MS">Notes Associated with an Improperly Filled Card or a Negative Profile (Biopattern)</fo:inline>
            <fo:leader
                leader-pattern="dots"/>
            <fo:inline
                keep-together.within-line="always"
                padding-left.length="12pt"
                start-indent="-14pt"
                text-align="right"
                line-height-shift-adjustment="disregard-shifts"
                font-family="Helvetica, Arial Unicode MS">2-<fo:page-number-citation
                    ref-id="_OPENTOPIC_TOC_PROCESSING_d73e797"/>
            </fo:inline>
        </fo:basic-link>
    </fo:block>
</fo:block>
<fo:block
    start-indent="0in + (2 * 30pt) + 14pt">
    <fo:block
        end-indent="22pt"
        font-size="10pt"
        font-style="italic"
        font-weight="normal"
        last-line-end-indent="-22pt"
        text-align="justify"
        text-align-last="justify"
        text-indent="-14pt"
        line-height-shift-adjustment="disregard-shifts"
        font-family="Helvetica, Arial Unicode MS">
        <fo:basic-link
            internal-destination="_OPENTOPIC_TOC_PROCESSING_d73e800"
            line-height="150%"
            line-height-shift-adjustment="disregard-shifts"
            font-family="Helvetica, Arial Unicode MS">
            <fo:inline
                end-indent="14pt"
                keep-together.within-line="auto"
                line-height-shift-adjustment="disregard-shifts"
                font-family="Helvetica, Arial Unicode MS">Notes Associated with an Improperly Filled Card or with a Negative Profile (Biopat</fo:inline>
            <fo:leader
                leader-pattern="dots"/>
            <fo:inline
                keep-together.within-line="always"
                padding-left.length="12pt"
                start-indent="-14pt"
                text-align="right"
                line-height-shift-adjustment="disregard-shifts"
                font-family="Helvetica, Arial Unicode MS">2-<fo:page-number-citation
                    ref-id="_OPENTOPIC_TOC_PROCESSING_d73e800"/>
            </fo:inline>
        </fo:basic-link>
    </fo:block> 
```

我尝试调整不同的末端缩进，看看我是否可以在没有任何运气的情况下强制它换行。我正在使用 DITA-OT 1.5.4 和 FOP 1.0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T10:05:57.383

看起来像 FOP 中的错误，请参阅[常见问题解答](http://xmlgraphics.apache.org/fop/faq.html#page-number-align)。

> 如果引用发生在 FOP 格式化请求的页面之前，通常在 TOC 或索引页面中，则 fo:page-number-citation 元素会发生这种情况。这是由FOP必须猜测未知页码将占用多少空间的问题引起的，通常猜测有些偏差。
> 
> 最新的 FOP 版本应该修复了这个问题。检查是否可以升级。

# c - 在 C 中释放双指针时出错

> ID：15116864
> 
> 赞同：1
> 
> 时间：2013-02-27T16:13:04.407
> 
> 标签：c, memory, free, genetic-algorithm

我正在为遗传算法编写代码，但我被困在无法释放未使用内存的地步。这是我的 main() 代码：

```
 szChromosomes = initial_population(&data[0]);
while (iCurrentGen <= data->m_iMaxGenerations)
{
    arrfSelectedChromosomes = selection(&data[0], szChromosomes);
    iSelectedLen = order_descending_grid(arrfSelectedChromosomes);
    szAuxGen = crossover(&data[0], arrfSelectedChromosomes, szChromosomes);
    free_generation(&data[0], szChromosomes);//Error line
    szChromosomes = szAuxGen;
    szAuxGen = NULL;
} 
```

initial_population(&data[0]) 创建 szChromosomes 数组（我稍后尝试释放），如下所示：

```
char** initial_population(struct INPUT_DATA* d)
{
int i, j = 0;
float fMember = 0.0;
char** szChromosomes = (char**)malloc(d->m_iPopulationSize * sizeof(char*));

srand(time(NULL));
for (i = 0; i < d->m_iPopulationSize; ++i)
{
    szChromosomes[i] = (char*)malloc(d->m_iBitsPChromosome * sizeof(char));
    for (j = 0; j < d->m_iBitsPChromosome; ++j)
    {
        szChromosomes[i][j] = rand_1_0(0.0, 1.0) == 1? '1' : '0';
    }
    szChromosomes[i][j] = '\0';
}

return szChromosomes; 
```

}

当我调用 free_generation 函数时，会执行下面的 For 循环：

```
 int i;

for (i = 0; i < d->m_iPopulationSize; ++i)
{
    free(szChromosomes[i]);
}

free(szChromosomes);
szChromosomes = NULL; 
```

当第一次调用 free(szChromosomes[i]); 发生，我收到以下错误：

检测到堆损坏：在正常块 (#99) 之后。CRT 检测到应用程序在堆缓冲区结束后写入内存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:22:18.603

```
char** initial_population(struct INPUT_DATA* d)
{
int i, j = 0;
float fMember = 0.0;
char** szChromosomes = (char**)malloc(d->m_iPopulationSize * sizeof(char*));

srand(time(NULL));
for (i = 0; i < d->m_iPopulationSize; ++i)
{
    szChromosomes[i] = (char*)malloc(d->m_iBitsPChromosome * sizeof(char));
    for (j = 0; j < d->m_iBitsPChromosome; ++j)
    {
        szChromosomes[i][j] = rand_1_0(0.0, 1.0) == 1? '1' : '0';
    }
    szChromosomes[i][j] = '\0';
}

return szChromosomes; 
```

您在每个字符串 szChromosomes[i] 的末尾插入一个 '\0' 但只使用长度为 d->m_iBitsPChromosome 的 malloc

因此，您尝试在内存中写得太远。要改变这一点，只需将您的第二个 malloc 更改为：

```
szChromosomes[i] = (char*)malloc((d->m_iBitsPChromosome + 1) * sizeof(char)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:21:17.997

```
szChromosomes[i][j] = '\0'; 
```

此行写入您不拥有的内存。

例如。举这个例子

```
char * p;
p = malloc(2);
p[0] = 'a';
p[1] = 'b'; 
```

你不应该这样做

```
p[2] = '\0' 
```

在此之后，因为您只分配了 2 个字节，但您正在写入 3 个字节。

您可以通过两种方式解决此问题

1.  你需要'\0'吗？除非您打算使用其中一个函数`<string.h>`需要 '\0' 来检查结尾，否则您需要用 '\0' 终止它。在您自己的遍历数组的代码中，您可以使用以 . 结尾的 for 循环进行遍历`ctr < d->m_iBitsPChromosome`。

2.  或者你可以分配`malloc(d->m_iBitsPChromosome + 1)`

# c# - 具有相同方法名称并沿类层次结构覆盖的多个接口

> ID：15116865
> 
> 赞同：4
> 
> 时间：2013-02-27T16:13:05.750
> 
> 标签：c#, uml

本主题的目的不是要问如何实现两个具有相同方法名称的接口。我在问自己为什么我们不能让抽象或虚拟成为方法的显式实现。这里有一个简单的：

![简单的类层次结构](../Images/b7fd37633d50fdbb30f4dbb028e0d016.png)

AbstractClass 是一个抽象类，它实现：

*   `IFlexibility1`通过声明`Method()`为抽象。
*   `IFlexibility2`通过声明`Method2()`为虚拟。

ConcreteClass 是一个 AbstractClass 并实现 Method() 和`Method2()`. 没关系 ！

现在，假设`IFlexibility1`和`IFlexibility`接口提供具有相同签名的方法 void `Method()`。如果我们想要做两个不同的实现，我们必须在 AbstractClass 中使用显式的实现规则：

```
// Two explicit privates methods
void IFlexibility1.Method()
{

}

void IFlexibility2.Method()
{

} 
```

这是我的问题：为什么不能像第一种情况那样让子类实现这些方法。事实上，我们不能声明一个*虚拟的 void IFlexibility1.Method()*或一个*抽象的 void IFlexibility2.Method()*，这是逻辑，因为这些方法是私有的。但我认为以下语法可能是正确的*protected abstract void IFlexibility1.Method()*。你怎么看 ？

我很好，这不是 21 世纪的问题。此外，我们通常不会实现与这种情况相匹配的两个接口。由于这些原因，Java 没有提供显式实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:00:58.683

显式接口实现既不是私有的也不是公共的。它们可以通过已定义接口的实例简单地公开访问。从实现接口的类派生的类*本身*不实现接口，因此不能显式实现接口的成员，因此派生类不能覆盖该成员（出于同样的原因，不能声明显式实现`abstract`）。

派生类*也*可以实现接口，从而显式实现该接口的成员。例如：

```
 public class ConcreteClass : IFlexibility1, IFlexibility2
    {
        void IFlexibility1.Method()
        {
            Trace.WriteLine("CC");
        }

        void IFlexibility2.Method()
        {
        }
    }

    public class Impl2 : ConcreteClass, IFlexibility1
    {
        void IFlexibility1.Method()
        {
            Trace.WriteLine("I2");
        }
    } 
```

但接下来`Impl2`是“隐藏”`ConcreteClass`的实现。

但是，总的来说；能够做到你所要求的意味着什么？

# c++ - 将 const QObject* 转换为 QObject*

> ID：15116867
> 
> 赞同：0
> 
> 时间：2013-02-27T16:13:08.183
> 
> 标签：c++, qt, type-conversion, constants, qobject

我对 Qt 很陌生。让 MyClass 成为 QObject 的子类。

有没有办法将对象正确转换`const MyClass *`为`MyClass *`对象？

我想创建一个构造函数`MyClass(const MyClass *object);`，但似乎不推荐。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:17:10.963

使用以下代码：

```
 MyClass *objRef = const_cast<MyClass *>(obj); 
```

# signalr - SignalR：将 SSL 页面上的 JS 客户端连接到不使用 SSL 的 SelfHost

> ID：15116869
> 
> 赞同：0
> 
> 时间：2013-02-27T16:13:19.237
> 
> 标签：signalr, signalr-hub, signalr.client, owin

我正在开发一个应用程序，以使用 SignalR 在多个 Web 托管应用程序之间执行上下文同步。客户端机器使用 SignalR Owin 主机实例化主机，应用程序使用 JS 客户端的无代理版本连接到它。我遇到的问题是“客户端”应用程序托管在 SSL 环境中，而 SignalR 主机不是（因为它受限于本地机器）。如果我尝试从托管 javascript 客户端的标准非 SSL 网站连接到集线器，一切正常。一旦我将客户端加载到 SSL 网站，但是当我尝试启动连接时，我会收到“SignalR：协商请求期间错误：未定义”。有人知道解决这个问题的方法吗？

主持人：

```
 public class SignalRHost : IDisposable
{
    private IDisposable _webApp;

    public SignalRHost(string url = "http://localhost:9000/")
    {
        _webApp = WebApplication.Start<Startup>(url);
    }

    public class Startup
    {
        public void Configuration(IAppBuilder app)
        {
            bool enableErrorDetail = false;
#if DEBUG
            enableErrorDetail = true;
#endif
            app.MapHubs(new HubConfiguration { EnableCrossDomain = true, EnableDetailedErrors = enableErrorDetail });
        }

    }

    public void Dispose()
    {
        _webApp.Dispose();
    }
} 
```

JS客户端：

```
 (function (ns_HubClient) {
    ns_HubClient.connection;
    ns_HubClient.proxy;

    ns_HubClient.initialize = function () {
        ns_HubClient.connection = $.hubConnection("http://localhost:9000");
        ns_HubClient.proxy = ns_HubClient.connection.createHubProxy("fluencyHub");

        ns_HubClient.proxy.on('addMessage', function (data) { ns_HubClient.processMessage(data); });

        ns_HubClient.connection.start()
            .done(function () {
                alert("connection complete");
            })
            .fail(function (data) {
                alert("connection start failed: " + data);
            });
    };

    ns_HubClient.login = function (sUserName, sPassword, sDomain) {
        var fluencyMessage = {
            MessageId: "",
            CallType: "Asynchronous",
            Method: "Login",
            Status: "",
            Response: {},
            Request: {
                sUserName: sUserName,
                sPassword: sPassword,
                sDomain: sDomain
            }
        };

        ns_HubClient.sendMessage(fluencyMessage);
    };

    ns_HubClient.writeLog = function (message, errorLevel) {
        var logMessage = {
            ErrorLevel: errorLevel,
            Message: message
        };
        ns_HubClient.proxy.invoke("logMessage", logMessage);
    };

    ns_HubClient.processMessage = function (message) {

    };

    ns_HubClient.sendMessage = function (data) {
        ns_HubClient.proxy.invoke("addMessage", data);
    };

} (window.ns_HubClient = window.ns_HubClient || {})); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:33:20.470

SignalR JS 客户端创建一个 XHR 来“协商”应该使用哪些传输（例如 WebSocket）来与 SignalR 服务器建立双向通信等。

浏览器供应商可以选择不允许从 HTTPS 页面到 HTTP 资源的 XHR：http: [//www.w3.org/TR/access-control/#user-agent-security](http://www.w3.org/TR/access-control/#user-agent-security)

请注意第四个要点：“允许用户代理终止算法而不发出请求。这可以这样做，因为例如：...。不允许 https 到 http。”

浏览器供应商可能会选择这样做，因为不安全的 XHR 会使原本安全的 Web 应用程序容易受到中间人攻击。

[我会使用您浏览器的 F12 工具或使用像fidler](http://www.fiddler2.com/fiddler2/)这样的 HTTP 代理来验证浏览器实际上是在发出“协商”请求。如果是，您可以查看响应以帮助弄清楚发生了什么。

# java - BIRT 表 - 如何停止在报告中截断数据

> ID：15116870
> 
> 赞同：1
> 
> 时间：2013-02-27T16:13:31.070
> 
> 标签：java, birt

使用 Birt 4.2

有没有办法阻止数据单元格截断表格中查看的数据。

目前有一种停止换行的方法（表格单元格的常规选项卡上没有换行），但这只会阻止它出现在两行上。

要重新创建您，请执行以下操作

1.  您创建一个数据集
2.  将数据集绑定到报表上的表格
3.  将数据单元格放入表格中
4.  将所有数据、单元格和行设置为不换行
5.  导出到 XLS

这些列不会自动调整到数据的大小，因此在导出到 XLS 时，在单元格中查看的数据会被截断。

有谁知道如何告诉 BIRT 调整列大小而不截断 BIRT 表中正在查看的数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-21T08:26:25.367

最新版本的 SpudSoft Excel Emitter 在自动计算列宽时可选择支持考虑页眉/页脚内容的大小。使用 RenderOption：ExcelEmitter.AutoColWidthsIncludeTableHeader（布尔值，设置为 True）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T16:16:45.843

不是一个完整的答案，但[Spudsoft Birt Excel Emitter](http://www.spudsoft.co.uk/2011/10/the-spudsoft-birt-excel-emitters/)能够根据其数据自动调整单元格的宽度。但它只比较一定数量的行。它不会处理标题。

# php - Paypal 多件商品立即购买

> ID：15116871
> 
> 赞同：0
> 
> 时间：2013-02-27T16:13:34.113
> 
> 标签：php, paypal

我正在尝试将存款自动添加到此贝宝表单中，理想情况下是账单上的单独项目。从其他论坛、支持小组以及我所确定的以下内容应该是正确的。然而事实并非如此，PayPal 仅检测基于 item_name_1 的值，而不检测基于 item_name_2 的值。任何想法都非常感谢。

```
 <input type="hidden" name="business" value="foo@bar.com">
    <input type="hidden" name="cmd" value="_xclick">
    <input type="hidden" name="item_name_1" value="<?php echo $item_name; ?>">
    <input type="hidden" name="amount_1" value="<?php echo $thePriceToPay;  ?>"> 
<input type="hidden" name="quantity_1" value="1">
    <input type="hidden" name="item_name_2" value="Deposit">
    <input type="hidden" name="amount_2" value="<?php echo $depositToPay;  ?>"> 
<input type="hidden" name="quantity_2" value="1">
    <input type="hidden" name="currency_code" value="<?php echo $currencyCodes; ?>">
    <INPUT TYPE="hidden" NAME="return" value="<?php echo get_bloginfo('url'); ?>/order-processing/">
    <INPUT TYPE="hidden" NAME="first_name" VALUE="<?php echo $nameExplode[0]; ?>"> 
    <INPUT TYPE="hidden" NAME="last_name" VALUE="<?php echo $nameExplode[1].' '.$nameExplode[2].' '.$nameExplode[3]; ?>">
    <INPUT TYPE="hidden" NAME="address1" VALUE="<?php echo $yourAddress; ?>">
    <INPUT TYPE="hidden" NAME="city" VALUE="<?php echo $yourTown; ?>">
    <INPUT TYPE="hidden" NAME="state" VALUE="<?php echo $yourState; ?>">
    <INPUT TYPE="hidden" NAME="zip" VALUE="<?php echo $yourPostCode; ?>">
    <INPUT TYPE="hidden" NAME="email" VALUE="<?php echo $yourEmail; ?>"> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T21:38:42.560

这是因为您正在使用“立即购买”按钮的代码，该代码仅支持单个项目。您需要使用购物车上传按钮，您可以在其中上传所有商品。

您需要删除以下行：

```
<input type="hidden" name="cmd" value="_xclick"> 
```

然后你需要添加这两行。

```
<input type="hidden" name="cmd" value="_cart">
<input type="hidden" name="upload" value="1"> 
```

# java - 用于 JavaHelp 的 Java newInstance 调用在第二次和后续调用中因 createUI 错误而崩溃

> ID：15116872
> 
> 赞同：1
> 
> 时间：2013-02-27T16:13:37.510
> 
> 标签：java, classloader, javahelp

在我的应用程序中，我动态加载 JavaHelp 的 jhall 文件，因此我的代码使用反射。奇怪的是它在第一次调用时运行良好，而且我的 JavaHelp 屏幕显示良好，所有导航都显示出来。如果我关闭我的 JavaHelp 屏幕，然后再次打开它，我会收到以下消息：

> UIDefaults.getUI() failed: createUI() failed for javax.help.JHelpContentViewer[,0,0,0x0,invalid,alignmentX=0.0,alignmentY=0.0,border=,flags=0,maximumSize=,minimumSize=,preferredSize= ] java.lang.reflect.InvocationTargetException java.lang.Error

这发生在除第一个之外的所有 JavaHelp 请求上。但是，没有捕捉到异常，我尝试捕捉 createUI 错误，但也没有捕捉到任何东西（显然这并不奇怪）。这可能是一个类加载器问题——我对类加载器有点动摇——但没有发现异常……我真的需要一些帮助来解决这个错误。TIA

FWIW，（大部分）代码如下 - jHelpClass 和 helpSetClass 在其他地方声明......

```
jHelpClass = null;
helpSetClass = null;
URLClassLoader cl = null;

File jFile = new File(jhallJarFile);
if (!(jFile.exists())) {
    JOptionPane.showMessageDialog(frame,"JavaHelp jar file shown in properties does not exist");
    return;
}
try {
    URI uri = jFile.toURI();
    URL url = uri.toURL();
    URL[] urls = new URL[]{url};

    // Create a new class loader with the directory
    cl = new URLClassLoader(urls, this.getClass().getClassLoader());

    jHelpClass = cl.loadClass("javax.help.JHelp");

    // Find the HelpSet file and create the HelpSet object
    helpSetClass = cl.loadClass("javax.help.HelpSet");
} catch (MalformedURLException e2) {
} catch (ClassNotFoundException e2) {
} catch (NoClassDefFoundError e2) {
}

if (jHelpClass == null || helpSetClass == null) {
    JOptionPane.showMessageDialog(frame,
            "JHelp class or HelpSet class not found in jar file");
    return;
}

// HelpSet hs = null;

URL url = null;
//Object hv = null;
JComponent hv = null;
try {
    url = this.getClass().getClassLoader()
            .getResource("helpSet.hs");
    if (url == null) {
        JOptionPane.showMessageDialog(frame, "HelpSet not found");
        return;
    }

    Constructor conhs = helpSetClass.getConstructor(
            ClassLoader.class, URL.class);
    //Object hs = conhs.newInstance(null, url);
    Object hs = conhs.newInstance(cl, url);
    Constructor conjh = jHelpClass.getConstructor(helpSetClass);
    hv = (JComponent) conjh.newInstance(hs);

} catch (Exception e2) {
    JOptionPane.showMessageDialog(frame,
            "HelpSet could not be processed: " + e2);
    return;
}           

// Create a new frame.
final JFrame frame2 = new JFrame();
frame2.setTitle("Help DrawFBP");
frame2.setIconImage(favicon.getImage());
//frame2.setRequestFocusEnabled(true);
frame2.addKeyListener(new KeyAdapter() {
    public void keyPressed(KeyEvent ev) {
        if (ev.getKeyCode() == KeyEvent.VK_ESCAPE) {
            //frame2.setVisible(false);
            frame2.dispose();
        }
    }
});
// Set its size.
frame2.setPreferredSize(frame.getPreferredSize());
// Add the created helpViewer to it.
frame2.getContentPane().add(hv);code
// Set a default close operation.
frame2.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
// Make the frame visible.
frame2.setVisible(true);
frame2.pack();
return; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:02:54.640

事实证明，我可以通过挂在名为“hv”（JHelp 实例）的变量上来解决这个问题，而不是每次都重新计算它——显然所有重新加载都以某种方式损坏了存储中的类......？不知道这是否有意义，但我的应用程序目前正在运行。我很想知道更多关于这个问题的真正原因，以及将来是否有解决问题的技术，但显然解决方案不再紧迫！感谢任何花时间在这方面的人。

# php - 如何将带有 php 函数和 html 标签的 html 作为字符串保存到 php 变量中？

> ID：15116874
> 
> 赞同：1
> 
> 时间：2013-02-27T16:13:43.543
> 
> 标签：php, html

```
<div class="readstar">
    <div class="stars">
    <?php if(is_active_sidebar('callout-box1')): ?>
    <?php $rating = get_average_rating($post->ID);echo num_to_stars($rating, 1);  ?>
    </div>
    <a class="readmore" href="<?php the_permalink();?> " >
    <img  src="<?php bloginfo('template_url');?>/images/readmore_2.png" alt="read more" />
    </a>
    <?php endif; ?> 
</div> 
```

我在下面发布了一个 html。我想将它作为字符串保存到一个 php 变量中，其中包含 html 标签和 php 函数。我试过这个

```
$str='<div class="readstar">
<div class="stars">
TEST TEST
</div>'; 
```

它只创建一个字符串 TEST TEST。但我需要带有标签的整个 html。请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:24:23.833

您提供的代码将整个字符串写入**$str**。回显它时，您应该使用**htmlspecialchars()**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:15:31.017

你想执行那个 php 代码并保存生成的 html 吗？最简单的方法是使用输出缓冲：

```
ob_start();
... your html+php code here ...
$html = ob_get_clean(); 
```

同样，请注意，如果您在浏览器中查看此输出，浏览器将**呈现**html 标记。尝试“查看源代码”来获取原始页面内容，包括标签。

# jquery - 使用土耳其字符传递 URL 参数

> ID：15116876
> 
> 赞同：0
> 
> 时间：2013-02-27T16:13:51.780
> 
> 标签：jquery, asp.net, urlencode

我正在从带有土耳其字符的 jQuery 向 Web 服务发送请求。在我从 jQuery 发送它之前，我`encodeURI`是土耳其字符串，并尝试在 C# 的 Web 服务中对其进行解码。但这不起作用。

这是jQuery代码

```
 $.ajax({url: 'http://xxxxxx.com/medbul/HoverCard_WebService.aspx?q=' + encodeURI(span_text), 
```

这是Web服务中的代码

```
 HttpUtility.UrlDecode(Request.QueryString["q"].ToString()) 
```

但这不起作用。有什么办法可以做到这一点？

我的意思是如果我传递英文字符，它会做它应该做的事情，但是当我传递土耳其字符时，它不会显示结果。我没有显示所有代码，因为没有必要。我认为我在 Javascript 中的编码和 C# 中的解码存在问题。或者我应该使用其他逻辑吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:21:57.870

当您赢得从 URL 发送 UTF-8 作为您的语言时，正确的是使用`encodeURIComponent`

因此，将您的代码更改为

```
$.ajax({url: 'http://xxxxxx.com/medbul/HoverCard_WebService.aspx?q=' + encodeURIComponent(span_text), 
```

它会起作用。

[比较 escape()、encodeURI() 和 encodeURIComponent()](http://xkr.us/articles/javascript/encode-compare/)

# django - Django StreamingHttpResponse 到模板中

> ID：15116881
> 
> 赞同：2
> 
> 时间：2013-02-27T16:14:00.730
> 
> 标签：django, templates, stream

Django 1.5 刚刚问世，它提供了 StreamingHttpResponse。现在，我已经阅读[了这个讨论](https://stackoverflow.com/questions/2922874/how-to-stream-an-httpresponse-with-django/) ，第二个答案实际上打印出页面中的流（实际上只是数据）。

我想要做的是将流响应的输出打印到模板中，而不仅仅是像[讨论](https://stackoverflow.com/questions/2922874/how-to-stream-an-httpresponse-with-django/)中那样打印数据。

我应该怎么办？我是否必须使用 javascript 并调用实现 StreamingHttpResponse 的视图，或者有一种方法告诉 django 呈现模板，然后将 StreamingHttpResponse 数据发送到模板（然后我需要知道存储数据的变量是什么） ?

编辑：到目前为止我找到的解决方案是将最终的 html 页面的片段写入生成器（yield）。这个解决方案的问题是，例如，我不能拥有一个随着数据流而增长的栏（如加载栏）。

再见

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T11:43:55.190

是的，但它可能不是您真正想要的，因为整个模板将被迭代。但是，对于它的价值，您可以为模板流式传输重新渲染的上下文。

```
from django.http import StreamingHttpResponse
from django.template import Context, Template

#    Template code parsed once upon creation, so
#        create in module scope for better performance

t = Template('{{ mydata }} <br />\n')

def gen_rendered():
    for x in range(1,11):
        c = Context({'mydata': x})
        yield t.render(c)

def stream_view(request):
    response = StreamingHttpResponse(gen_rendered())
    return response 
```

**编辑**：您也可以渲染一个模板，然后对其进行附加`<p>`或`<tr>`标记，但这与模板的初衷完全相反。（即从代码中分离表示）

```
from django.template import loader, Context
from django.http import StreamingHttpResponse

t = loader.get_template('admin/base_site.html') # or whatever
buffer = ' ' * 1024

def gen_rendered():  
    yield t.render(Context({'varname': 'some value', 'buffer': buffer}))
    #                                                 ^^^^^^
    #    embed that {{ buffer }} somewhere in your template 
    #        (unless it's already long enough) to force display

    for x in range(1,11):
        yield '<p>x = {}</p>{}\n'.format(x, buffer) 
```

# mysql - 在字符串逗号分隔的字符串前后加上一个字符加上可能的“，”

> ID：15116886
> 
> 赞同：0
> 
> 时间：2013-02-27T16:14:08.113
> 
> 标签：mysql, sql, pdo

这些是 table column 上的情况`post_attending`，`post_attending`可能是：`5`or `5,6,7`or `6,7,5`or or `6,5,7`or `''`or more string comma separator and 5 on this or not。我应该如何删除`,`在 PDO 查询中使用的“5”和“可能”？

我试过这个：

```
$q= "UPDATE table SET post_attending = SUBSTR(REPLACE(CONCAT(',', post_attending, ','), ? , ','), 2, LENGTH(REPLACE(CONCAT(',', post_attending, ','), ? , ',')) - 2) WHERE id = x "
$sql->execute(array(5,5,x)); 
```

`,`但是当最后有一个 5 或 5 时，它给我留下了一个。

我读过这个也`TRIM(BOTH ',' FROM REPLACE(wishes, '(,)? :var (,)?', ''))`没有真正弄清楚正确的语法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:45:20.103

不使用任何`CASE`语句，我相信它会更快

```
UPDATE table SET post_attending = SELECT REPLACE(REPLACE(REPLACE(REPLACE(val, ',5,', ','), ',5', ''), '5,', ''),'5', '') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:23:20.957

尝试这个：

```
update table
    set post_attending = (case when val like '5,%' then SUBSTRING(val, 3, LENgth(val) - 2)
                               when val like '%,5' then SUBSTRING(val, 1, length(val) - 2)
                               when val = '5' then ''
                               else REPLACE(val, ',5,', ',')
                           end) 
```

# java - NullPointerException：println 需要一条消息

> ID：15116887
> 
> 赞同：1
> 
> 时间：2013-02-27T16:14:09.557
> 
> 标签：java, android, nullpointerexception

我知道我有一个空指针，但我不知道它发生在哪里或为什么。希望能在这里得到一些帮助。

```
Button add = (Button) findViewById(R.id.addfencebutton);
add.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View add) {
        //code to store in fence locations database
        createData();

    }
});
}

public void createData(){
    Course course = new Course();
    course.setcoursename("courseNamefield");
    course.setfencename("fenceNamefield");
    course.setAlocation("standardAfield");
    course.setBlocation("standardBfield");
    course = datasource.create(course);
    Log.i(course.getcoursename(), null);
    //Log.i("course created with id" + course.getcourseid(), null);
//  Log.i("course name is " + course.getcoursename(), null);
} 
```

文件课程DBopenHelper

```
public class courseDBOpenHelper extends SQLiteOpenHelper {

private static final String LOGTAG = "courseDatabase";

private static final String DATABASE_NAME = "courses.db";
private static final int DATABASE_VERSION = 1;

public static final String TABLE_COURSES = "courses";
public static final String COLUMN_ID = "coursesID";
public static final String COLUMN_COURSENAME = "coursename";
public static final String COLUMN_FENCENAME = "fencename";
public static final String COLUMN_ALOCATION = "alocation";
public static final String COLUMN_BLOCATION = "blocation";

private static final String TABLE_CREATE = 
        "CREATE TABLE " + TABLE_COURSES + " (" +
        COLUMN_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
        COLUMN_COURSENAME + " TEXT, " +
        COLUMN_FENCENAME + " TEXT, " +
        COLUMN_ALOCATION + " NUMERIC, " +
        COLUMN_BLOCATION +  " NUMBERIC " +
        ")";

public courseDBOpenHelper(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
}

@Override
public void onCreate(SQLiteDatabase db) {
    db.execSQL(TABLE_CREATE);
    Log.i(LOGTAG, "table created");
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    db.execSQL("DROP TABLE IF EXISTS" + TABLE_COURSES);
    onCreate(db);

}

} 
```

courseDataSource.java

```
public class courseDataSource {

public static final String LOGTAG = "courseDatabase";

SQLiteOpenHelper dbhelper;
SQLiteDatabase database;

public courseDataSource(Context context) {
    dbhelper = new courseDBOpenHelper(context);
    database = dbhelper.getWritableDatabase();
}

public void open(){
    Log.i(LOGTAG, "database open");
    database = dbhelper.getWritableDatabase();
}

public void close(){
    Log.i(LOGTAG, "database closed");
    dbhelper.close();
}

public Course create(Course course) {
    ContentValues values = new ContentValues();
    values.put(courseDBOpenHelper.COLUMN_COURSENAME, course.getcourseid());
    values.put(courseDBOpenHelper.COLUMN_FENCENAME, course.getcoursename());
    values.put(courseDBOpenHelper.COLUMN_ALOCATION, course.getAlocation());
    values.put(courseDBOpenHelper.COLUMN_BLOCATION, course.getBlocation());
    long insertid = database.insert(courseDBOpenHelper.TABLE_COURSES, null, values);
    course.setcourseid(insertid);
    return course;
}

} 
```

课程.java

```
public class Course {
private long courseid;
private String coursename;
private String fencename;
private String Alocation;
private String Blocation;

public long getcourseid(){
    return courseid;
}

public void setcourseid(long courseid) {
    this.courseid = courseid;
}

public String getcoursename(){
    return coursename;
}

public void setcoursename(String string){
    this.coursename = coursename;
}

public String getfencename(){
    return fencename;
}

public void setfencename(String fencename){
    this.fencename = fencename;
}

public String getAlocation(){
    return Alocation;
}

public void setAlocation(String view){
    this.Alocation = view;
}

public String getBlocation(){
    return Blocation;
}

public void setBlocation(String view){
    this.Blocation = view;
}

} 
```

错误日志

```
02-27 11:03:42.058: E/AndroidRuntime(909): FATAL EXCEPTION: main
02-27 11:03:42.058: E/AndroidRuntime(909): java.lang.NullPointerException: println needs a message
02-27 11:03:42.058: E/AndroidRuntime(909):  at android.util.Log.println_native(Native Method)
02-27 11:03:42.058: E/AndroidRuntime(909):  at android.util.Log.i(Log.java:159)
02-27 11:03:42.058: E/AndroidRuntime(909):  at com.greygoosefarmpa.fencecoursebuilder.addFence.createData(addFence.java:155)
02-27 11:03:42.058: E/AndroidRuntime(909):  at com.greygoosefarmpa.fencecoursebuilder.addFence$4.onClick(addFence.java:140)
02-27 11:03:42.058: E/AndroidRuntime(909):  at android.view.View.performClick(View.java:4202)
02-27 11:03:42.058: E/AndroidRuntime(909):  at android.view.View$PerformClick.run(View.java:17340)
02-27 11:03:42.058: E/AndroidRuntime(909):  at android.os.Handler.handleCallback(Handler.java:725)
02-27 11:03:42.058: E/AndroidRuntime(909):  at android.os.Handler.dispatchMessage(Handler.java:92)
02-27 11:03:42.058: E/AndroidRuntime(909):  at android.os.Looper.loop(Looper.java:137)
02-27 11:03:42.058: E/AndroidRuntime(909):  at android.app.ActivityThread.main(ActivityThread.java:5039)
02-27 11:03:42.058: E/AndroidRuntime(909):  at java.lang.reflect.Method.invokeNative(Native Method)
02-27 11:03:42.058: E/AndroidRuntime(909):  at java.lang.reflect.Method.invoke(Method.java:511)
02-27 11:03:42.058: E/AndroidRuntime(909):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-27 11:03:42.058: E/AndroidRuntime(909):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-27 11:03:42.058: E/AndroidRuntime(909):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T16:16:53.283

你的错误很明显

```
E/AndroidRuntime(909): java.lang.NullPointerException: println needs a message 02-27 11:03:42.058: 
```

您必须为日志消息提供消息。它不能为空。

```
Log.i(course.getcoursename(), null); 
```

应该

```
Log.i(course.getcoursename(), "Some not null string"); 
```

# rack - Rack + Thin，无限连接？

> ID：15116890
> 
> 赞同：2
> 
> 时间：2013-02-27T16:14:19.503
> 
> 标签：rack, thin, connection

我有自己的 MVC 环境，运行 Rack and Thin。

默认情况下，thin 的连接数限制为 1024。如何更改最大可用连接数？在最好的情况下，无限的可用连接。

乔恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T15:06:39.727

据我所见，这是不可能通过任何途径从`rackup -s thin`，因为 Thin 的配置选项不是通过 暴露的`rackup -O`，只是通过解析 ARGV。

但是，以下应该有效：

```
thin -R config.ru --max-conns 2000 --max-persistent-conns 1000 start 
```

在我的机器上，Thin 拒绝以这种方式支持超过 10000 个以上的连接（相反，它使用值 2560）。对我来说不是问题，我分别设置了 30 和 1 的值来进行测试。

在任何情况下，都不建议设置一个真正巨大的数字，因为服务将在您允许的连接用完之前由于资源问题而失败。事实上，您可以通过在服务器上保留内存来处理它永远不会使用的连接来加速该过程。

# mysql - 如果插入命令不起作用，如何在mysql中插入数据

> ID：15116891
> 
> 赞同：-1
> 
> 时间：2013-02-27T16:14:20.177
> 
> 标签：mysql, sql-insert

当 INSERT INTO 命令为您提供外键错误消息时，您可以使用 MYSQL 中的哪些命令来插入新数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:16:39.270

你没有。您`Insert`以满足数据库要求的方式制作数据和/或语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:36:40.407

如果您准确指定了您收到的“*外键错误消息*”，那将会有所帮助。但是，假设它是最有可能的候选人之一：

*   错误 1216：[无法添加或更新子行：外键约束失败](http://dev.mysql.com/doc/refman/5.5/en/error-messages-server.html#error_er_no_referenced_row)；或者
*   错误 1452：[无法添加或更新子行：外键约束失败 (%s)](http://dev.mysql.com/doc/refman/5.5/en/error-messages-server.html#error_er_no_referenced_row_2)。

这两条消息都表示同一件事：您试图插入（或更新）一条记录，以便表示外键的列包含引用父表中不存在的记录的值。

在下面的示例中，尝试使用表`CustomerID`中不存在的a 插入/更新订单时会收到错误 1216 `Customers`：

```
CREATE TABLE Customers (
  CustomerID SERIAL
) Engine=InnoDB;

CREATE TABLE Orders (
  OrderID    SERIAL,
  CustomerID BIGINT UNSIGNED NOT NULL,
  FOREIGN KEY (CustomerID) REFERENCES Customers (CustomerID)
);

INSERT INTO Customers
  (CustomerID)
VALUES
  (100),
  (200)
;

INSERT INTO Orders
  (OrderID, CustomerID)
VALUES
  (1, 200), -- okay,  as CustomerID 200 exists
  (2, 300)  -- fails, as CustomerID 300 does not exist
; 
```

正如其他人所建议的那样，此问题的*最佳*解决方案是修改您的数据库活动以满足外键约束。

或者，您可以从数据库中删除外键约束（但是 RDBMS 不会为您强制执行参照完整性，这通常是人们希望它做的事情）。或者可以暂时禁用 MySQL 的引用完整性检查——但这通常只在加载已知具有引用完整性的数据时才会这样做，这可能会导致违反约束：*不*建议在一般应用程序中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:19:42.113

您必须`INSERT ... ON DUPLICATE KEY UPDATE`处理重复键错误，但您没有外键错误。

如果要处理重复键，请参阅[http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

# c# - Resharper 文件头被双注释

> ID：15116893
> 
> 赞同：1
> 
> 时间：2013-02-27T16:14:24.587
> 
> 标签：c#, resharper

有什么办法可以防止 Resharper 插入的文件头被双重注释。

我正在使用默认文件头模板并在代码清理中打开插入文件头。

（Resharper 版本 7.1.2）

```
// #region Copyright © 2013 xxx Systems, Incorporated
// //
// // All rights are reserved. Reproduction or transmission in whole or in part, in
// // any form or by any means, electronic, mechanical or otherwise, is prohibited
// // without the prior written consent of the copyright owner.
// //
// // Filename: xxx.cs
// // Date:     27/02/2013
// // Author:   xxx
// // 
// #endregion 
```

这是模板：

```
#region Copyright © $CURRENT_YEAR$ xxx Systems, Incorporated
//
// All rights are reserved. Reproduction or transmission in whole or in part, in
// any form or by any means, electronic, mechanical or otherwise, is prohibited
// without the prior written consent of the copyright owner.
//
// Filename: $FILENAME$
// Date:     $CURRENT_DAY$/$CURRENT_MONTH$/$CURRENT_YEAR$
// Author:   $USER_LOGIN$
// 
#endregion 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T00:34:20.367

您应该创建不带 // 的模板，它应该只包含

```
All rights are reserved. Reproduction or transmission in whole or in part,
any form or by any means, electronic, mechanical or otherwise, is prohibited
without the prior written consent of the copyright owner.

Filename: $FILENAME$
Date:     $CURRENT_DAY$/$CURRENT_MONTH$/$CURRENT_YEAR$
Author:   $USER_LOGIN$ 
```

然后在“将文件头包含在带有名称的区域”字段中（就在文件模板下方）你应该写

```
Copyright © $CURRENT_YEAR$ xxx Systems, Incorporated 
```

# python - 程序太大而无法放入内存 Pyinstaller

> ID：15116899
> 
> 赞同：1
> 
> 时间：2013-02-27T16:14:37.613
> 
> 标签：python, exe, pyinstaller

我决定尝试 PyInstaller，在编译小型可执行文件后，我尝试在 Windows 7 上运行它并得到“程序太大而无法放入内存”

我在 Ubuntu 中编译使用：

python pyinstaller.py --onefile test.py python pyinstaller.py --onefile test/test.spec

（我也试过没有 --onefile ）

编译的小python代码：http: [//pastebin.com/ZJbxEzuE](http://pastebin.com/ZJbxEzuE)

有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:21:40.023

如果你在 linux 上编译了你的程序，你只能在 linux 上运行生成的可执行文件，如果你试图在 windows 上运行它，你会得到错误。在这种情况下，它接缝窗口没有找到文件的结尾，所以它说它太大了。

要将程序作为 *.exe 在 windows 上运行，您必须在 windows 上编译它（或直接从 *.py 文件运行它）。

# r - 覆盖 plot.factor 的技巧？

> ID：15116901
> 
> 赞同：3
> 
> 时间：2013-02-27T16:14:38.383
> 
> 标签：r, plot

我已经使用`plot`了很长一段时间了，我想知道如果类型参数可以覆盖分类预测变量会破坏多少。现在 plot 总是在 x 变量是一个因素时尝试箱线图。似乎该`plot.factor`方法总是被调用。如果 type 可以覆盖该功能并且我不必将 x 轴设为数字，将其隐藏，然后稍后再添加，那就太好了。我对包装函数不感兴趣，因为我几乎只是描述了如何做到这一点。我只是想知道是否有一个`plot`我错过的论点可以解决这个问题。

例如，在这种情况下，通常会尝试使用箱线图......

```
y <- 1:4
x <- factor(letters[1:4])
plot(y ~ x) 
```

我希望它只绘制点并正确标记 x 轴。以下工作，但我希望有一个更简单的版本。

```
nx <- length(x)
plot(y ~ 1:nx, xaxt = 'n')
axis(1, 1:nx, x, xlab = '') 
```

我希望像下面这样的东西可能会起作用......

```
plot(y ~ x, type = 'n')
points(1:nx, y) 
```

但不行。而且`type = 'p'`也不这样做。

我相信这最后一次失败是 R 中不一致的另一个例子。设置`type = 'n'`也应该在方法调用中起作用，或者应该强制所有`plot`函数都使用它（继承或至少传递`...`）。它在`plot.default`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:06:33.590

你可以调用 plot.default:

```
y<-rnorm(100)
x<-factor(sample(c("a","b","c"),size=100,replace=TRUE))
plot.default(x,y) 
```

编辑：将因子级别更改为字符，因此很明显这即使在那时也有效。

# android - 无法从 SmsReceiver 调用不同类的方法

> ID：15116903
> 
> 赞同：0
> 
> 时间：2013-02-27T16:14:40.643
> 
> 标签：android, sms, broadcastreceiver

我正在开发 android 上的短信应用程序，发送方类型并单击发送消息，消息在 Ecc 类中进行操作并发送到接收方。接收者必须阅读此消息并将其发送到其 Ecc 类，在该类中对其进行操作并发送回发送者。我能够将消息发送给接收者，但接收者端没有任何反应。

这是 SmsReceiver 类

```
 package com.example.smsTest;

 import android.content.BroadcastReceiver;
 import android.content.Context;
 import android.content.Intent;
 import android.os.Bundle;
 import android.telephony.SmsMessage;
 import android.widget.Toast;

 public class SMSReceiver extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    // TODO Auto-generated method stub
    Bundle bundle=intent.getExtras();
    Object[] messages=(Object[])bundle.get("pdus");
    SmsMessage[] sms=new SmsMessage[messages.length];

    Ecc ecc;
    ecc = new Ecc(context);
    String msg_receive = intent.getStringExtra("message1"); 
    if (msg_receive != null)  { 

    for(int n=0;n<messages.length;n++)
        {
            sms[n]=SmsMessage.createFromPdu((byte[]) messages[n]);

        }

    for(SmsMessage msg:sms)
        {
            String ph=msg.getDisplayOriginatingAddress();
            String body=msg.getMessageBody();
            ecc.recv(ph,body);          
            Toast.makeText(context,"ecc entered at receiver", Toast.LENGTH_SHORT).show();

            SMSTest.update("\n From:" +ph+"\n"+"message:"+body+"\n");

            Toast.makeText(context,"updated", 
                    Toast.LENGTH_SHORT).show();

        }

    }
  } 
} 
```

这是ecc类

```
package com.example.smsTest;
import java.util.*;
public class Ecc{

//code
private SMSTest smsTest;

// Constructor
public Ecc(SMSTest smsTest) {
    this.smsTest = smsTest;
}

public void recv(String phn, String smsg){

    String[] spl1=str.split("\\.");
 if("abc".equals(spl1[0])){
    //code
   sendSMS(ph,smsg)  
 }  
 if("pmg".equals(spl1[0])){
   //code 
sendSMS(ph,smsg)  
 }  
}

//code
//---sends a SMS message to another device---
    @TargetApi(Build.VERSION_CODES.DONUT)
    @SuppressLint("NewApi")    
    public void sendSMS(String phoneNumber, String message)
    {      
        /*
        PendingIntent pi = PendingIntent.getActivity(this, 0,
                new Intent(this, test.class), 0);                
            SmsManager sms = SmsManager.getDefault();
            sms.sendTextMessage(phoneNumber, null, message, pi, null);        
        */

        String SENT = "SMS_SENT";
        String DELIVERED = "SMS_DELIVERED";

        PendingIntent sentPI = PendingIntent.getBroadcast(smsTest, 0,
            new Intent(SENT), 0);

        PendingIntent deliveredPI = PendingIntent.getBroadcast(smsTest, 0,
            new Intent(DELIVERED), 0);

        //---when the SMS has been sent---
        registerReceiver(new BroadcastReceiver(){
            @Override
            public void onReceive(Context arg0, Intent arg1) {
                switch (getResultCode())
                {
                    case Activity.RESULT_OK:
                        Toast.makeText(smsTest, "SMS sent", 
                                Toast.LENGTH_SHORT).show();
                        break;
                    case SmsManager.RESULT_ERROR_GENERIC_FAILURE:
                        Toast.makeText(smsTest, "Generic failure", 
                                Toast.LENGTH_SHORT).show();
                        break;
                    case SmsManager.RESULT_ERROR_NO_SERVICE:
                        Toast.makeText(smsTest, "No service", 
                                Toast.LENGTH_SHORT).show();
                        break;
                    case SmsManager.RESULT_ERROR_NULL_PDU:
                        Toast.makeText(smsTest, "Null PDU", 
                                Toast.LENGTH_SHORT).show();
                        break;
                    case SmsManager.RESULT_ERROR_RADIO_OFF:
                        Toast.makeText(smsTest, "Radio off", 
                                Toast.LENGTH_SHORT).show();
                        break;
                }
            }
        }, new IntentFilter(SENT));

        //---when the SMS has been delivered---
        registerReceiver(new BroadcastReceiver(){
            @TargetApi(Build.VERSION_CODES.DONUT)
            @SuppressLint("NewApi")
            @Override
            public void onReceive(Context arg0, Intent arg1) {
                switch (getResultCode())
                {
                    case Activity.RESULT_OK:
                        Toast.makeText(smsTest, "SMS delivered", 
                                Toast.LENGTH_SHORT).show();
                        break;
                    case Activity.RESULT_CANCELED:
                        Toast.makeText(smsTest, "SMS not delivered", 
                                Toast.LENGTH_SHORT).show();
                                break;                  
                }
            }
        },new IntentFilter(DELIVERED));        

        SmsManager sms = SmsManager.getDefault();
        sms.sendTextMessage(phoneNumber, null, message, sentPI, deliveredPI);               
    }

    private void registerReceiver(BroadcastReceiver broadcastReceiver,
            IntentFilter intentFilter) {
        // TODO Auto-generated method stub

    }

 } 
```

这里是 SMSTest 类

```
package com.example.smsTest;

import android.annotation.SuppressLint;
import android.annotation.TargetApi;
import android.app.Activity;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.os.Build;
import android.os.Bundle;
import android.telephony.SmsManager;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

@TargetApi(Build.VERSION_CODES.DONUT)
@SuppressLint("NewApi")
public class SMSTest extends Activity 
{
public final static String SMS_Message = "com.example.SMSTest.MESSAGE";
public final static String SMS_Phone = "com.example.SMSTest.MESSAGE";
static TextView txtmsg;
Button btnSendSMS;
EditText txtPhoneNo;
EditText txtMessage;
Ecc ecc; 

/** Called when the activity is first created. */

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    txtmsg=(TextView)findViewById(R.id.txtmsg);
    btnSendSMS = (Button) findViewById(R.id.btnSendSMS);
    txtPhoneNo = (EditText) findViewById(R.id.txtPhoneNo);
    txtMessage = (EditText) findViewById(R.id.txtMessage);

    ecc=new Ecc(this);

    /*
    Intent sendIntent = new Intent(Intent.ACTION_VIEW);
    sendIntent.putExtra("sms_body", "Content of the SMS goes here..."); 
    sendIntent.setType("vnd.android-dir/mms-sms");
    startActivity(sendIntent);
    */

    btnSendSMS.setOnClickListener(new View.OnClickListener() 
    {
        public void onClick(View v) 
        {               
            String phoneNo = txtPhoneNo.getText().toString(); 
            String message = txtMessage.getText().toString();
            message="pmg."+message;
            if (phoneNo.length()>0 && message.length()>0){
                System.out.println("details verified");    
                Toast.makeText(getBaseContext(),"Ecc call clicked", 
                    Toast.LENGTH_SHORT).show();
                ecc.recv(phoneNo, message);
            }
            else
                Toast.makeText(getBaseContext(), 
                    "Please enter both phone number and message.", 
                    Toast.LENGTH_SHORT).show();

        }
    });

}

public static void update(String msg) {
    // TODO Auto-generated method stub
    txtmsg.append(msg);

}

} 
```

这是清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.example.smsTest"
  android:versionCode="1"
  android:versionName="1.0">
      <uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<uses-feature android:name="android.hardware.telephony" /> 
<uses-permission android:name="android.permission.READ_SMS" />
<uses-permission android:name="android.permission.WRITE_SMS" />
<uses-permission android:name="android.permission.SEND_SMS" />
<uses-permission android:name="android.permission.RECEIVE_SMS" />

  <application android:icon="@drawable/icon" android:label="@string/app_name">
    <activity android:name=".SMSTest"
              android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <receiver android:name=".SMSReceiver"> 
        <intent-filter >
               <action android:name="android.provider.Telephony.SMS_RECEIVED"/>
        </intent-filter>
    </receiver>
  </application>
</manifest> 
```

我没有收到任何错误。发送方功能如我所愿，接收方收到消息，但没有任何反应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:33:36.713

在`Ecc`课堂上：

```
// Constructor
public Ecc(SMSTest smsTest) {   //<<<<
    this.smsTest = smsTest;
} 
```

您已经`Ecc`使用 Activity 类型参数创建了构造函数，`SMSTest`但是您在内部创建对象时传递`SMSReceiver`给`BroadcastReceiver`

**解决方案：**

而不是通过创建 Activity 实例来调用 Activity 的方法，而是创建一个单独的普通 java 类，用于在 Activity 或`BroadcastReceiver`. 而不是传递任何组件实例传递上下文以发送短信：

```
Context context ;
    // Constructor
    public Ecc(Context context) {   //<<<<
        this.context = context;
    } 
```

现在`context`用于发送 SMS 并 `Ecc`在内部创建类实例`BroadcastReceiver`：

```
Ecc ecc;
ecc=new Ecc(context);  //<< pass context instead of this 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:24:43.070

请像这样在 Manifast 文件中注册您的广播

```
<receiver android:name="your package name and class name">  </receiver> 
```

或尝试在代码中注册您的广播，而不是像这样的清单

```
IntentFilter in_filter = new IntentFilter("android.intent.action.PHONE_STATE");
     Incoming = new BroadcastReceiver()
            {   
            @Override
            public void onReceive(final Context context, Intent intent) {
                // TODO Auto-generated method stub
                  {
                      telephonyManager = (TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);
                      callEventListener = new PhoneStateListener(){
                          public void onCallStateChanged(int state, String incomingNumber) {
                                super.onCallStateChanged(state, incomingNumber);
                                if (state == TelephonyManager.CALL_STATE_IDLE){
                                     System.out.println("Idel State phone");
                                }
                                else if (state == TelephonyManager.CALL_STATE_RINGING){
                                    context.stopService(new Intent(context, myPlayService.class));
                                    System.out.println("phone ringing");
                                }
                            }
                        };
                telephonyManager.listen(callEventListener, PhoneStateListener.LISTEN_CALL_STATE);
                      }
                 }
            };

            this.registerReceiver(Incoming, in_filter); 
```

# android - Android - 如何将音乐频率从 440Hz 转换为 432Hz

> ID：15116907
> 
> 赞同：0
> 
> 时间：2013-02-27T16:15:00.023
> 
> 标签：android, frequency

我想将频率从 440Hz 转换为 432Hz 的音乐文件。请帮助我，我不知道使用任何库或算法来完成它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:28:50.743

我会让自己设置并熟悉[Android NDK](http://developer.android.com/tools/sdk/ndk/index.html)。

之后，您可以尝试使用[来自 Audacity](http://audacity.sourceforge.net/download/source)的一些源代码或[libsoxr](http://wiki.audacityteam.org/wiki/Libsoxr)库本身。

:)

# git - git branch --merged 使用管道命令

> ID：15116908
> 
> 赞同：7
> 
> 时间：2013-02-27T16:15:01.457
> 
> 标签：git

有没有办法实现相当于 `git branch --merged` 使用 git 管道命令？

我知道有些命令`git for-each-ref`可以为您提供提交哈希及其相应的参考名称。是否有一个命令来判断一个提交是否可以从另一个提交中访问（这基本上是`--merged`做什么的）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-09T06:22:07.333

`git merge-base --independent X Y Z`将告诉您其中哪些尚未合并到另一个分支。

此外，`git merge-base --is-ancestor X Y`它会告诉您 X 是否是 Y 的祖先，但这是一种低效的实现方式，`git branch --merged`因为您需要为 N 个分支运行 N^2 次。

# css - 响应式设计混乱

> ID：15116913
> 
> 赞同：0
> 
> 时间：2013-02-27T16:15:24.420
> 
> 标签：css, responsive-design

就在我以为我对媒体查询和响应式设计的所有理解和组织时，我开始在某些设备中看到一些奇怪的行为，这使得它变得一团糟。

我的意图是拥有一组媒体查询，我可以使用这些查询涵盖所有不同的设备/分辨率。我看过一些带有示例的文章并开始将它们付诸实践，但是在三星 Galaxy SII 手机中进行测试时，它们似乎并没有按预期工作。

开始宽度 SII 声称具有 480x800 的分辨率。我不知道这个分辨率是否仅用于视频播放，但是当我准备我的设计时，它们似乎适合 320px 宽度。

我正在使用 javascript screen.width 和 screen.height 属性来检查它使用的分辨率，这是我的结果：

*   在本机浏览器中，我在纵向加载页面时获得 320x450 分辨率。但是，在同一个浏览器中，如果我以横向重新加载页面，我会得到 533x235 尺寸。就在这里，这很奇怪，因为无论使用的方向如何，我都希望具有相同的高度和宽度。此外，它们都不符合声称的 480x800 设备分辨率。

*   如果我使用 Firefox 浏览器，我确实获得了横向和纵向方向的 480x800 宽度的屏幕属性，但如果我尝试适合 480 像素宽度的图像，它不会，因为它似乎只有 320 像素宽度。

实际上，所有这些情况下的实际分辨率似乎都是 320x533。

有人对这种奇怪的行为有解释吗？

有什么建议可以接近它并获得一组媒体查询以涵盖所有分辨率？

编辑：：：：：：：：：：：：：：

我试过视口：

```
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"> 
```

仍然没有成功。实际上，根据 hexblot “maximum-scale=1”给出的链接中的文章，不应该 aoiv 缩放，但它在我的设备中确实如此（它可能只适用于 iOS，不知道）。我有以下CSS链接：

```
<link rel='stylesheet' type='text/css' media='only screen and (max-width : 320px)' href='".home_url()."/wp-content/themes/twentyeleven/style-xsmall.css'>
<link rel='stylesheet' type='text/css' media='only screen and (min-width : 321px) and (max-width : 479px)' href='".home_url()."/wp-content/themes/twentyeleven/style-small.css'>
<link rel='stylesheet' type='text/css' media='only screen and (min-width : 481px) and (max-width : 767px)' href='".home_url()."/wp-content/themes/twentyeleven/style-medium.css'>
<link rel='stylesheet' type='text/css' media='only screen and (min-width : 768px) and (max-width : 959px)' href='".home_url()."/wp-content/themes/twentyeleven/style-large.css'>
<link rel='stylesheet' type='text/css' media='only screen and (min-width : 960px)' href='".home_url()."/wp-content/themes/twentyeleven/style-xlarge.css'> 
```

在我的设备中访问该站点时，我可以检查它是否使用 style-xsmall.css（最大 320px 宽度）。

老实说，它的实际宽度在纵向时看起来是 320 像素（至少对于网页浏览而言），而在横向时它的实际宽度是 533 像素（奇怪的尺寸）。

有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:17:37.323

您是否通过相关元标记设置视口？否则屏幕可能会在大多数移动设备中自动缩放。结帐[http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag/](http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:13:17.867

显然这是因为像素密度，在这个设备中是 1.5（480 变成 320，800 变成 533）。使用像素密度=2 将实际密度除以 2 的某些 iOS 设备似乎也会发生同样的情况。

我从这个链接得到了这个信息：[http](http://www.javascriptkit.com/dhtmltutors/cssmediaqueries2.shtml) ://www.javascriptkit.com/dhtmltutors/cssmediaqueries2.shtml 。希望对其他人有帮助。

因此，似乎在使用 javascript 屏幕属性时，firefox 检索设备宽度/高度，而本机 android 浏览器获取“转换后的”尺寸。

我仍然不明白为什么在本机浏览器中，根据设备方向显示不同的分辨率。

最后，进行一些快速测试（不幸的是，我没有足够的时间得出深入的结论），似乎 max-device-width 和 max-width 都适用于隐蔽尺寸（320x533）。

尽管如此，考虑到这一切有点混乱（至少对我而言），如果其他人可以提供一些有关如何处理所有这些功能的相关信息，那就太好了。

# ios - UITableViewCell 在滚动后的第一个单元格中显示最后一个单元格。

> ID：15116914
> 
> 赞同：1
> 
> 时间：2013-02-27T16:15:25.273
> 
> 标签：ios, objective-c, cocoa-touch

我创建了一个表格，其中的单元格大小会根据填充它们的内容量而动态变化。我遇到的问题是，当我向下滚动然后再次备份时，第一个单元格添加了不应该存在的内容。

[这](https://www.youtube.com/watch?v=TXO0ucayAxI)是一个显示我的问题的视频。

这是我用来尝试实现它的代码。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *CellIdentifier = @"Cell";
    //NotificationCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    noteBody = [Noifications objectAtIndex:indexPath.row];
    yPosition = 10;
    NSLog(@"noteBody: %@",noteBody);

    double titleHeight = 0;
    NSUInteger titleLenght = [noteBody objectForKey:@"title"];

    if (titleLenght < 30)titleHeight = 25;
    else if(titleLenght < 60)titleHeight = 50;
    else if(titleLenght < 90)titleHeight = 75;
    else if(titleLenght < 120)titleHeight = 100;
    else if(titleLenght < 150)titleHeight = 125;
    else if(titleLenght < 180)titleHeight = 150;
    else titleHeight = 200;

    UILabel *Title = [[UILabel alloc]initWithFrame:CGRectMake(10, yPosition, self.view.frame.size.width-30, titleHeight)];
    Title.text = [noteBody objectForKey:@"title"];
    Title.font = [UIFont boldSystemFontOfSize:20];
    Title.textAlignment = NSTextAlignmentCenter;
    Title.numberOfLines = 0;
    [Title sizeToFit];
    yPosition += Title.frame.size.height;
    [cell addSubview:Title];

    UILabel *Date = [[UILabel alloc]initWithFrame:CGRectMake(10, yPosition, self.view.frame.size.width-30, 25)];
    Date.text = [noteBody objectForKey:@"date"];
    Date.numberOfLines = 0;
    [Title sizeToFit];
    yPosition += Date.frame.size.height;
    [cell addSubview:Date];

    double bodyHeight = 0;
    NSUInteger bodyLenght = [noteBody objectForKey:@"title"];

    if (bodyLenght < 30)titleHeight = 25;
    else if(bodyHeight < 60)titleHeight = 50;
    else if(bodyHeight < 90)titleHeight = 75;
    else if(bodyHeight < 120)titleHeight = 100;
    else if(bodyHeight < 150)titleHeight = 125;
    else if(bodyHeight < 180)titleHeight = 150;
    else if(bodyHeight < 210)titleHeight = 175;
    else if(bodyHeight < 240)titleHeight = 200;
    else if(bodyHeight < 270)titleHeight = 225;
    else if(bodyHeight < 300)titleHeight = 250;
    else if(bodyHeight < 330)titleHeight = 275;
    else if(bodyHeight < 360)titleHeight = 300;
    else if(bodyHeight < 390)titleHeight = 325;
    else bodyHeight = 350;

    UILabel *Body = [[UILabel alloc]initWithFrame:CGRectMake(10, yPosition, self.view.frame.size.width-30, bodyHeight)];
    Body.text = [noteBody objectForKey:@"body"];
    Body.numberOfLines = 0;
    [Body sizeToFit];
    yPosition += Body.frame.size.height;
    [cell addSubview:Body];

    return cell;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    noteBodyCellHeight = [Noifications objectAtIndex:indexPath.row];

    NSLog(@"cellHeights: %@",cellHeights);

    NSString *title = [noteBodyCellHeight objectForKey:@"title"];
    NSString *date = [noteBodyCellHeight objectForKey:@"date"];
    NSString *body = [noteBodyCellHeight objectForKey:@"body"];

    CGRect frame = [UIScreen mainScreen].bounds;
    CGFloat width = frame.size.width;

    int section = indexPath.section;

    CGSize title_size = {0, 0};
    CGSize date_size = {0, 0};
    CGSize body_size = {0, 0};

    if (title && [title isEqualToString:@""] == NO ) {
        title_size = [title sizeWithFont:[UIFont systemFontOfSize:22.0]
                              constrainedToSize:CGSizeMake(width, 4000)
                                  lineBreakMode:UILineBreakModeWordWrap];
    }

    if (date && [date isEqualToString:@""] == NO ) {
        date_size = [date sizeWithFont:[UIFont systemFontOfSize:18.0]
                       constrainedToSize:CGSizeMake(width, 4000)
                           lineBreakMode:UILineBreakModeWordWrap];
    }

    if (body && [body isEqualToString:@""] == NO ) {
        body_size = [body sizeWithFont:[UIFont systemFontOfSize:18.0]
                                constrainedToSize:CGSizeMake(width, 4000)
                                    lineBreakMode:UILineBreakModeWordWrap];
    }

    CGFloat title_height = title_size.height;
    CGFloat date_height = date_size.height;
    CGFloat body_height = body_size.height;

    //CGFloat content_size = Body.frame.size.height + Title.frame.size.height + Date.frame.size.height;
    CGFloat content_size = title_height + date_height + body_height +20;
    NSLog(@"content_size: %f",content_size);
    CGFloat height;

    switch ( section ) {

        case 0:
            height = content_size;
            break;

            //Just in case
        default:
            height = 44.0;
            break;

    }

    return height;

} 
```

谁能告诉我哪里出了问题，并指出我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T16:21:08.127

尝试使用自定义单元格类或删除单元格现有子视图以重用。

基本上在每次调用`cellForRow`.. 时，子视图都会添加到单元格中，即使它正在被重用。

```
 if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    } 
```

在上面添加这个

```
for(UIView *view in cell.contentView.subviews)
{
  [view removeFromSuperView];
} 
```

也`cell addSubview`改为`cell.contentView addSubview`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:24:32.687

您可能只想将三个子视图添加到单元格中一次，为每个子视图赋予一个唯一的标签，即在`if`块中对其进行初始化之后。之后，您可以通过在单元格上使用来引用您的标签并设置它们的大小和内容`-viewWithTag:`。

# jquery - 使用 Rails 对 <200 项进行 JQuery 自动完成的远程或本地数据？

> ID：15116919
> 
> 赞同：0
> 
> 时间：2013-02-27T16:15:40.890
> 
> 标签：jquery, ruby-on-rails

我的 Rails 3.2 应用程序在其导航菜单中（即在每个页面上）都有一个搜索栏，可以让用户搜索产品类别。目前有约 20 个类别，但预计将增长到约 200 个类别。当前类别列表每天最多可以更改一次或两次。

我正在使用 JQuery UI Autocomplete 来提供匹配产品类别名称作为用户类型的建议。

自动完成有两个选项来提供它建议的术语：本地或远程。您可以为它提供一个字符串数组，它会在客户端进行搜索，或者您可以为它提供一个 URL，它会根据用户实时输入的内容返回 JSON 和建议的术语（即搜索是在服务器上）。

目前，我正在使用本地数据方法，但我正在动态生成此本地数据。在 category.js.coffee 中：

```
$('#search').autocomplete
    source: $('#search').data('autocomplete-source') 
```

我使用辅助方法生成潜在结果数组，并使用 HTML5 数据元素将数组存储在搜索文本字段中：

`<%= text_field_tag :search, params[:search], :data => { :autocomplete_source => category_array.to_json } %>`

辅助方法只是从数据库中收集所有类别名称，并将它们放入一个数组中：

```
def category_array
  Category.pluck(:name)
end 
```

我的问题是：**这是一种合理的方法吗？**

我担心的是，由于导航栏出现在每个页面上，我正在访问数据库以收集每个页面请求上的所有类别名称。我对此太陌生，不知道 Rails/Postgres 缓存是否解决了这种性能问题。但是，仅添加 200 个项目的远程搜索功能似乎有点傻，所以我认为使用这样的本地数据会使自动完成功能感觉更快。

有一个更好的方法吗？还是我应该使用远程数据方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:30:55.640

对我来说似乎值得远程选择。您始终可以计算开销。

**[KB 200+ 类别的数据大小] * [每天平均页面请求数]**

*对比*

**[超过 200 个类别的 KB 数据大小] * [每天的平均搜索次数]**

除此之外，您还可以按照自己喜欢的方式设计远程搜索。例如，如果在第一次搜索时加载所有选项会更快，然后在客户端过滤原始列表，则将其构建到源回调中：

```
source: function( request, response ) { 
    // make request for all categories and send back a response
    // set a flag to indicate the data has been loaded
    // for subsequent requests and filter on `request.term`
} 
```

# c# - 如果 DataBinder.Eval 为空，则隐藏链接？

> ID：15116920
> 
> 赞同：0
> 
> 时间：2013-02-27T16:15:48.040
> 
> 标签：c#, asp.net

我有以下项目模板：

```
 <ItemTemplate>
                        <asp:Label ID="lblUser" runat="server"
                            Text='<%# DataBinder.Eval(Container.DataItem, "Schedule.Employee.EmployeName") %>'></asp:Label>

                                <a href="#scheduleModal" id="scheduleLnk"
                       onclick="<%# "go('scheduleFrame',
'ScheduleFrame.aspx?type=project&id=" + Eval("ProjectID").ToString() + "')" %>"
                           data-toggle="modal">Unassigned</a>
                    </ItemTemplate> 
```

我有一个标签和一个打开模式的链接。

如果：`DataBinder.Eval(Container.DataItem, "Schedule.Employee.EmployeName")`为空，表示项目未安排，lblUser 应隐藏并显示链接，否则应隐藏链接并显示 lblUser。

有没有办法做到这一点？我不确定 scheduleLnk 是否具有可见属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T16:22:25.223

是的，有一种方法：

```
<ItemTemplate>
     <asp:Label ID="lblUser" runat="server"
          Text='<%# DataBinder.Eval(Container.DataItem, "Schedule.Employee.EmployeName") %>'
          Visible='<%# DataBinder.Eval(Container.DataItem, "Schedule.Employee.EmployeName") == null ? false: true %>'> 
      </asp:Label>

      <a href="#scheduleModal" id="scheduleLnk"
           onclick="<%# "go('scheduleFrame',
               'ScheduleFrame.aspx?type=project&id=" + Eval("ProjectID").ToString() + "')" %>"
           data-toggle="modal"
           style='<%# DataBinder.Eval(Container.DataItem, "Schedule.Employee.EmployeName") == null ? "display:block;": "display:none;"%>'>>
             Unassigned
      </a>
</ItemTemplate> 
```

# r - 拆分并保存在新的 data.frames 中

> ID：15116921
> 
> 赞同：4
> 
> 时间：2013-02-27T16:15:53.170
> 
> 标签：r

我有一个大数据框架（144 列）。我想将它分成每组 3 列（子文件或子 data.frame），然后将子 data.frames 保存在单独的文件中。换句话说：file1 将包含从 1 到 3 的列，file2 将包含从 6 到 9 的列，依此类推。

有什么想法吗？

只是一个例子：

> ```
>  Hb1  Int1  Value1   Hb2  Int2  Value2         
>    A     c     0.3     SW   n     0.34        
>    V     sd    0.45    FG   b     0.345    
>    N     wer   0.76    GH   m     0.67 
> ```

所以：文件“output1”将包含：

> ```
>  Hb1  Int1   Value1   
>    A     c     0.3
>    V     sd    0.45    
>    N     wer   0.76 
> ```

文件“output2”将包含：

> ```
>  Hb2    Int2  Value2     
>  SW       n    0.34    
>  FG       b    0.345    
>  GH       m    0.67 
> ```

等等。

我尝试向包含索引值的转置 data.frame 添加一列，以便：

> 索引 = 代表（1：48，每个 = 3）

然后我尝试根据索引列拆分大data.frame，但我无法继续。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T16:44:02.810

也许这对你有用：

```
# A simple function (EDIT: FIXED) 
Split_and_save_DF <- function(DF, split){
  # Spliting your data frame by columns to get several data.frames
  DFlist <-lapply(seq(1, ncol(DF), split), function(x, i){x[, i:(i+(split-1))]}, x=DF)
  # Saving each data.frames as .txt file
  invisible(sapply(1:length(DFlist), function(x, i) write.table(x[[i]], file=paste0('DF', i, '.txt')), x=DFlist))
} 
```

# 例子

```
DF <- data.frame(matrix(rnorm(144*12, 100, 30), ncol=144))
dim(DF) # a dataframe with 12 rows and 144 cols
Split_and_save_DF(DF=DF, split=3) # will produce 48 DF's 
```

`DF`data.frame在哪里，`split`是您希望数据框分割的列数。

这不是一个很好的答案，但它可以满足您的需求。

此函数将拆分您的 DF 并将每个新的 DF 保存在您当前的工作目录中，名称如下：`DF1.txt`, `DF2.txt`, `DF3.txt`.... 以便您可以通过执行以下操作来读取每个文件：

```
read.table("DF1.txt", header=TRUE) # and so on 
```

为了检查输出：

```
dim(read.table("DF1.txt", header=TRUE)) # checking dims of new DF's
[1] 12  3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T17:09:08.937

你很接近`Index = rep(1: 48, each = 3)`，你可以用它来分割列名。

```
lapply(split(colnames(DF),
             rep(1:48,each=3)),
       function(x)DF[,x]) 
```

使用@Jilber 示例对其进行测试：

```
colnames(DF) <-  paste(c('Hb','Int',  'Value'),rep(1:48,each=3),sep='')

> ll <- lapply(split(colnames(DF),
+              rep(1:48,each=3)),
+        function(x)DF[,x])
> head(ll)
$`1`
         Hb1      Int1    Value1
1  155.56103 114.70061  50.15758
2  100.91212 108.93485 138.43324
3   65.02612  97.95829  60.55026
4  102.85399  99.80714  74.53144
5  152.52558 100.28795 109.27979
6  110.84282 122.67727 100.60916
7  100.06572  92.96498 118.99915
8  104.69424  91.46041  38.57983
9   74.59960 119.89719 158.41313
10 100.89299  85.79222 122.57668
11  92.87294  84.40889  95.39005
12  81.20039 127.29311  92.19261

$`2`
         Hb2      Int2    Value2
1  101.27385  96.21813  21.83450
2  124.26445 117.29466  53.67718
3  144.58042 111.06022  91.92567
4  120.74942  98.63582 123.98479
5   95.74860  79.96633 149.62814
6   74.78898  68.25731 122.72720
7  132.12760  97.76982  56.66394
8   47.18706 118.68346 113.63118
9  115.27 
```

# java - Grails / Spring Security - 注册电子邮件未解锁帐户

> ID：15116922
> 
> 赞同：-2
> 
> 时间：2013-02-27T16:15:54.507
> 
> 标签：java, grails, spring-security, grails-2.0

我正在运行一个带有spring security的站点grails站点，用户注册一个帐户，然后使用他们的电子邮件地址登录。在测试中，我发现当我创建一个帐户时，我收到了验证电子邮件，但点击链接没有解锁帐户。我实际上必须以管理员身份登录并进入 spring security 用户管理 UI 并手动解锁帐户。这只是最近的一个问题（当我们从拥有用户名的用户切换到让用户只使用他们的电子邮件地址登录时）。任何想法为什么“注册”链接不会自动解锁帐户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T05:34:33.097

查看 Spring Security 中的 RegisterController 源代码：( [https://github.com/grails-plugins/grails-spring-security-ui/blob/master/grails-app/controllers/grails/plugins/springsecurity/ui/RegisterController .groovy#L113](https://github.com/grails-plugins/grails-spring-security-ui/blob/master/grails-app/controllers/grails/plugins/springsecurity/ui/RegisterController.groovy#L113)）我发现在验证过程中，代码尝试通过用户名查找用户，而它应该通过电子邮件查找用户。由于这可能会超载，我只是重写了有问题的部分。

# javascript - onbeforeunload - 检测动作类型（只需要导航按钮，而不是窗口退出）

> ID：15116926
> 
> 赞同：0
> 
> 时间：2013-02-27T16:16:10.013
> 
> 标签：javascript, onbeforeunload

在我的应用程序中，当页面处于卸载状态时，我使用 onbeforeunload 调用函数。该javascript函数中是否有任何方法可以确定究竟是哪个动作被击中导致这种情况？我的问题是我的页面包含两个 iframe - 每个都有自己的页面。我对这两个页面都进行了卸载检查，但是对于其中一个页面，如果单击 x 以关闭浏览器或窗口，我不想给出错误，只有在点击导航按钮时。（这样当用户点击 x 关闭时，只提示他们是否想离开页面一次）。下面列出的是我使用的 javascript 示例。再次感谢。

```
 function UnLoadWindow() {
        return 'Please do not use Browser Navigation Buttons. Please make sure all work is Saved prior to leaving this page.'

}

window.onbeforeunload = UnLoadWindow; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-14T01:45:42.173

这是一个老问题，所以您可能已经找到了解决方案。

但是，您可以尝试使用 onhashchange 事件而不是 onbeforeunload。那么它不应该在关闭时触发吗？

再说一次，我不确定您的 iframe 中有什么，以及它们是否可以从那里导航到其他页面。

但它可能会有所帮助，因为它具有 newURL 和 oldURL 值，因此您可以使用它们来判断用户是否要返回上一页。

看一下：

[onhashchange 事件](https://developer.mozilla.org/en-US/docs/Web/API/window.onhashchange)

# d3.js - 将限制线添加到 D3.js 折线图

> ID：15116933
> 
> 赞同：1
> 
> 时间：2013-02-27T16:16:32.880
> 
> 标签：d3.js

有没有办法按照下图向 D3.js 折线图添加限制线？（不必用虚线） 我的数据库中有上限和下限列。一直在网上搜索不成功的例子来说明如何实现这一点？

![在此处输入图像描述](../Images/d14f7667027e387d9abb74ff225e12c9.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T16:25:56.873

不确定“限制线”到底是什么，但这在视觉上不是问题。作为一个起点，我建议这样做：

```
// (assuming some vars have been created per usual templates)

svg.append( "line" )
  .attr("x1", x( x.domain()[0] ) )
  .attr("x2", x( x.domain()[1] ) )
  .attr("y1", y( 80 ) )   // whatever the y-val should be
  .attr("y2", y( 80 ) ) 
```

然后添加 css 或 attrs 来定义您的线路的特定外观。

请评论它不适合您的任何方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-21T12:10:21.173

我确实通过引入另一组具有恒定 y 值的线来解决问题，从而产生了这个图表： [![在此处输入图像描述](../Images/ae80e7c6a502bb54ea050973640b2779.png)](https://i.stack.imgur.com/ZoIH0.png) 它基本上是一个多折线图，带有额外的两条线，如下[所示](https://next.plnkr.co/plunk/8aj8ZU)。

# javascript - 大规模 jQuery 选择器缓存

> ID：15116934
> 
> 赞同：1
> 
> 时间：2013-02-27T16:16:36.950
> 
> 标签：javascript, jquery, performance

哪些模式可用于在大型 JavaScript 应用程序中缓存许多 jQuery 选择器以重复重用？

关于将 jQuery 选择器存储在简单函数中的简单变量中的说法很多，但是在 JavaScript 对象中，例如在流行的模块模式中，如何干净地设置和存储它们？

我最初的尝试是使用全局变量，但这会弄脏命名空间并可能导致冲突。我的第二次尝试涉及将选择器存储在相应对象内的对象文字中，但这会导致对它们的调用比预期的要长，例如：

```
var Module = {

  nodes: {},

  storeSelectorsInCache: function() {
    Module.nodes = {
      form: $('#form'),
      grid: $('#grid')
    };
  },

  initialize: function() {
    Module.storeSelectorsInCache();

    // notice the long hierarchy to get to Module.nodes.form
    Module.nodes.form.submit(function() {
      // event handler
    });
  }

}; 
```

那里一定有一个更干净的速记。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T16:40:46.993

这样的事情可能很酷：

```
var _nodes = {};

var Module = {
  /**
   * You could call this when you want to query a selector and store it for reuse. Then 
   * just use this for querying.
   * 
   * @param {String} selector The selector to memoize.
   * @param forceUpdate {Boolean} jQuery selectors don't update with their DOM 
   *     counterparts. This will take that into account. Pass in true to override cache.
   *
   * @return {Object<Array<jQuery>>} The matching selectors.
   */
  $: function(selector, forceUpdate) {
    if (forceUpdate === true || !({}).hasOwnProperty.call(_nodes, selector)) {
      _nodes[selector] = jQuery(selector); // Not that robust, just a basic example
    }
    return _nodes[selector];
  },

  initialize: function() {
    this.$('#form').submit(function () { /* ... */ });
  }
}; 
```

So with this every time you query for a selector using the locally-scoped `Module.$` function it would cache the result in the nodes object (which here is being exploited as an associative array). However if there was no result for that selector in the nodes object then it would query the DOM for it. Furthermore there's an added param to force the selectors in `nodes` to be updated.

Alternatively you could use lodash's [memoize](http://lodash.com/docs#memoize) function, like so:

```
// inside your Module
$: _.memoize(jQuery); 
```

# jquery - $('[id$= 在 jquery 中代表什么？

> ID：15116937
> 
> 赞同：1
> 
> 时间：2013-02-27T16:16:43.390
> 
> 标签：jquery, jquery-selectors

我正在查看一些代码，我看到了很多：

```
$('[id$="txt"]').attr('excludeDirty', 'True'); 
```

我假设“id$=txt”代码是一种告诉 jquery 如何在 DOM 中查找特定对象的方法，但我找不到任何引用来支持它。

我确实发现 $() 是 jquery 选择器，所以括号内的代码必须是识别选择器的代码，对吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T16:18:15.510

```
$('[id$="txt"]') 
```

是 id 以 结尾的元素的集合`txt`。

它使用[“属性以选择器结尾”](http://api.jquery.com/attribute-ends-with-selector/)。

语法显然受到正则表达式的启发：它与

```
$('*').filter(function(){ return /text$/.test(this.id) }); 
```

属性以文本开头的元素有对称选择器，并且在逻辑上

```
$('[attributename^="txt"]') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:18:23.707

你说的是“以”选择器[http://api.jquery.com/attribute-ends-with-selector/](http://api.jquery.com/attribute-ends-with-selector/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T16:18:26.453

如果等号前面有美元符号 ($)，则选择器将匹配属性的最后一个字符（例如文件扩展名）。

# asp.net-mvc-3 - ASP.NET MVC。EditorTemplate 或 @Html.Action / Partial 中的名称重复

> ID：15116940
> 
> 赞同：0
> 
> 时间：2013-02-27T16:16:47.707
> 
> 标签：asp.net-mvc-3, razor, modelbinder

在对这个问题进行了大量搜索之后，我正在向社区寻求帮助：

我在视图中做类似的事情（如果我使用@Html.Action 或 PartialView，问题是一样的

```
@for(int i= 0; i< Model.Contacts.Count(); i++)
{
     @Html.EditorFor(m => m.Contacts[i] , "AccreditationContact" )
} 
```

我有一个像这样的经典 EditorTemplate 或 PartialView

```
 @model FrontOffice.Models.AccreditationStepSevenModel

    <div>
        @Html.LabelFor(m => m.Nom)
        @Html.TextBoxFor(m => m.Nom)
        @Html.ValidationMessageFor(m => m.Nom)
    </div>
[There is a lots of other fields here] 
```

为“Nom”字段生成的 html 看起来像这样：

```
 <input id="Contacts_0__Nom" name="Contacts[0].Nom" type="text" value="Doe" > 
    <input id="Contacts_1__Nom" name="Contacts[1].Nom" type="text" value="Doe1" >
    <input id="Contacts_2__Nom" name="Contacts[2].Nom" type="text" value="Doe2" > 
```

当我提交表单时，这里没有问题，所有字段都由我的控制器中的本机 ModelBinder 正确绑定到一个数组中

现在我想在 javascript 中动态生成另一个 AccreditationStepSevenModel，我使用了 $load 和 Jquery。问题是生成的 html 不会增加名称然后我有多个具有相同名称的字段并且我的 ModelBinder 不再工作......

我想过在javascript中重命名名称，这会起作用，但是有更好的解决方案吗？

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T09:53:02.823

默认的 ModelBinder 只有在索引是完整的整数序列时才有效，从 0 开始，每个元素加 1。要支持非顺序索引，您必须指定索引器，例如

```
<input type="hidden" name="Contacts.Index" value="0" />     
<input id="Contacts_0__Nom" name="Contacts[0].Nom" type="text" value="Doe" > 
```

请参阅此博客文章以了解想法：[编辑可变长度列表，ASP.NET MVC 2-style](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T15:53:13.667

我找到了如何使客户端验证工作：

在 ajax 调用之后，我们需要像这样重置验证器： $("#addAccredBtn").click(function () {

```
 $.ajax({
                url: this.href,
                cache: false,
                success: function (html) {
                    $("#accreds").append(html);

                    var form = $("#myform");
                    form.removeData("validator");
                    form.removeData("unobtrusiveValidation");
                    $.validator.unobtrusive.parse("#myform");
                }
            });

            return false;
        }); 
```

# c# - 在流中获取泛型类的类型

> ID：15116943
> 
> 赞同：1
> 
> 时间：2013-02-27T16:16:53.460
> 
> 标签：c#, generics, serialization, stream

我试图通过发送不同的广播消息来获得一个简单的网络程序。

首先是我的消息类：

```
[Serializable()]
public class Message<T>
{
    public enum MessageType
    {
        Broadcast,
        Unicast
    }

    private T _payload;
    private readonly MessageType _type;
    private readonly DateTime _createdOn = DateTime.Now;

    public MessageType Type
    {
        get { return _type; }
    }

    public T Payload
    {
        get { return _payload; }
        set { _payload = value; }
    }

    public DateTime CreatedOn
    {
        get { return _createdOn; }
    }
    private Message() { }
    private Message(T setPayload, MessageType type)
    {
        _payload = setPayload;
        _type = type;
    }

    public class Builder
    {
        private readonly T _payload;
        private MessageType _messageType = MessageType.Unicast;

        public Builder(T payload)
        {
            _payload = payload;
        }

        public Builder Broadcast()
        {
            _messageType = MessageType.Broadcast;
            return this;
        }

        public Message<T> Build()
        {
            Message<T> result = new Message<T>(_payload, _messageType);
            return result;
        }
    }
} 
```

然后我有我的课程：

```
[Serializable()]
public class HelloWorld
{
    public String HelloString { get; set; }
    public HelloWorld() { }
}

[Serializable()]
class HelloWorld2
{
    public String HelloString2 { get; set; }
    public HelloWorld2() { }
} 
```

现在我有两种方法`SendHelloWorld()`和`SendHelloWorld2()`.

我正在为包含 typeName 的字符串保留我的 Memorystream 的前 32 个字节。

```
internal void SendHelloWorld()
    {
        HelloWorld helloWorld = new HelloWorld();

        var message = new Message<HelloWorld>.Builder(helloWorld).Broadcast().Build();

        // implement broadcasting
        Stream memoryStream = new MemoryStream();
        byte[] buffer = ASCIIEncoding.ASCII.GetBytes("Messages.HelloWorld");

        memoryStream.Write(buffer, 0, buffer.Length);

        SerializationService.Serialize(memoryStream, message);
        SendBroadcastMessage(memoryStream);
    } 
```

SendBroadCastMessage 只是将流转换为 byte[] 并广播消息。

收到它们时，我必须检查消息是 Typeof HelloWorld 还是 HelloWorld2

但我还没有找到让它工作的方法，字符串被接受为类型，我不想使用 switch-case，因为之后会添加更多类型的消息。

```
private void UdpListener()
    {
        UdpClient listener = new UdpClient(9050, AddressFamily.InterNetwork);
        IPEndPoint iep = new IPEndPoint(IPAddress.Any, 9050);

        Stream inputStream = new MemoryStream(listener.Receive(ref iep));
        byte[] buffer = new byte[32];
        inputStream.Read(buffer, 0, 32);
        string type = ASCIIEncoding.ASCII.GetString(buffer,0,32);

        Message<type> message = _service.Deserialize<Message<HelloWorld>>(inputStream);

        Received(message.Payload);

        listener.Close();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:45:19.847

问：是什么`SerializationService`？

希望您使用的是 .NET 标准序列化，更准确地说是：BinaryFormatter。如果您使用的是 SoapFormatter，那么泛型将不起作用。如果您使用的不是这 2 个，请告诉我们它是哪种序列化服务。

如果答案是有利的（BinaryFormatter），您可以走以下路线。

提议：

1）制作这个抽象类并让你的扩展它像这样：

```
 [Serializable()]
 public abstract class AbstractMessage {

     public object Payload { get { return this.GetPayload(); } }
     protected abstract object GetPayload();

 }

 [Serializable()]
 public class Message<T> : AbstractMessage
 {
     // .... etc ....
     public new T Payload
     {
         get { return _payload; }
         set { _payload = value; }
     }
     // .... etc ....
     protected override object GetPayload() { return this.Payload; }
 } 
```

2）停止这样做：

```
byte[] buffer = ASCIIEncoding.ASCII.GetBytes("Messages.HelloWorld");
memoryStream.Write(buffer, 0, buffer.Length); 
```

3）这：

```
byte[] buffer = new byte[32];
inputStream.Read(buffer, 0, 32);
string type = ASCIIEncoding.ASCII.GetString(buffer,0,32); 
```

（因为 .NET 序列化比以往任何时候都更容易解释，让它为您完成艰苦的工作）

4）在你的接收应用程序中，做这样的事情

```
private void UdpListener()
{
    // .... etc ....

    //object obj = _service.Deserialize<object>(inputStream);

    // this should now work perfectly (as long as you stopped writing the string into stream
    // from the client)
    object obj = (new BinaryFormatter()).Deserialize(inputStream);

    if (!(obj is AbstractMessage))
       // complain to yourself via exception, log or other things

    var message = obj as AbstractMessage;
    object payload = message.Payload;

    // here you can access on of two things:
    Type payloadType = payload.GetType();
    Type aproximatelySameType = message.GetType().GetGenericArguments()[0];

    // and you can honor this payload like an object or by casting it to whatever
    // you desire, or by reflection, or whatever
    Received(message.Payload);

    listener.Close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:25:15.603

您可以使用静态方法[GetType](http://msdn.microsoft.com/en-us/library/w3f99sx1.aspx)从字符串中获取类型：

```
var myType = Type.GetType("SomeType"); 
```

但是，除非该类型当前在执行程序集中，否则您将不得不使用[完全限定的类型名称](http://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname.aspx)。否则你会得到一个例外。

如果您想查看您的类型的完全限定程序集名称是什么，您可以检查 Type 对象的[AssemblyQualifiedName](http://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname.aspx)属性。

```
typeof(HelloWorld).AssemblyQualifiedName 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-06T14:11:33.317

得到它工作刚刚改变了UdpListener：

```
private void UdpListener()
    {
        _iep = new IPEndPoint(IPAddress.Any, 9050);
        _listener = new UdpClient(_iep);

        while (true)
        {
            Stream inputStream = new MemoryStream(_listener.Receive(ref _iep));

            dynamic msg = _service.Deserialize<object>(inputStream);

            Received(msg.Payload);
        }
    } 
```

感谢所有答案

# c# - 检查 21，使用 C# .net 的图像现金信

> ID：15116946
> 
> 赞同：3
> 
> 时间：2013-02-27T16:16:57.413
> 
> 标签：c#, .net

我需要为我正在处理的 .Net C# 项目创建一个 Check 21/Image Cash Letter(X9.37-2003)，但我做这件事的时间很糟糕。有谁知道我在哪里可以获得一些示例代码或库或其他东西？这似乎是银行发送扫描支票的一种非常流行的方式，因此似乎应该有很多信息可供使用。

我看过 X9.org 但他们似乎没有我需要的东西。我有一个规范文档，告诉我文件需要看起来像什么，但它们似乎是某种编码，这导致了我的问题。

任何对此有帮助的东西都会非常有帮助，尤其是代码示例或库。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T18:49:11.530

![在此处输入图像描述](../Images/f2f2e3fcaba446c4c75ae6f7a6cfb5a6.png)

网络上并没有很多像样的示例代码用于处理 x9 文件（尤其是对于编写格式良好的 x9 文件）。

为了编写有效的 x9.37（或 x9.100-187）文件，您必须对 ANSI 规范有非常全面的了解。没有太多的办法。该规范非常具体地说明了有效 x9 文件的构成、接收机构接受或拒绝它的原因等。有很多规则涉及与其他记录和图像格式相关的记录放置。

此外，您对文件编码的困惑并不奇怪，因为它有点复杂。X9.37 (& .100-187) 文件是二进制文件。**文件中的大部分**数据**通常是**EBCDIC 编码的字符串数据，但您也会遇到一些 ASCII 编码的数据。您可以使用 EBCDIC 编码，例如：`Encoding.GetEncoding(37)`

另一方面是文件中的所有记录在理论上都是可变长度的，因此以它们的长度为前缀（以字节为单位）。奇怪的是长度存储为大端、二进制 32 位整数。最后，其中携带的图像数据当然是二进制数据。

我创建了一个很好的、全面的 .net 库来处理 x9 文件，但目前它仅可供我们公司的产品使用。考虑到足够的需求，我们正在考虑为 .NET 开发人员发布商业 SDK 的想法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-28T15:48:16.200

过去几周我一直在做这件事，因为我的任务是为 Wells Fargo 制作 RDC 文件。对我来说不幸的是，虽然富国银行的人非常了解文件的结构，但他们不了解编码或二进制数据。在过去的 2 天里，我从他们那里解析了一个示例文件，这就是我发现的：

1.  没有行终止字符，例如 \r\n。除 52 条记录外，每一行的长度为 80 个字符，并且必须按原样解析/创建。插入换行符将产生第 81 个和可能的第 82 个字符，这将搞砸解析器。

2.  虽然文件的编码是 EBCDIC (Encoding.GetEncoding(37))，但整个文件不是 EBCDIC 编码的。只有文本部分被编码。因此，您必须逐个字符地编码为 EBCDIC，直到将二进制图像数据放入 52 记录中为止。此时您只需放入二进制数据，任何解析器都应该根据前一个字段知道该数据的长度（字段 18，图像数据的长度，通常是 52 条记录的 111-117 位置）

这是一个非常古老的问题，但我在研究我的设置时已经多次遇到这个问题，所以我认为是时候用真实信息给出正确答案了。

# reverse-proxy - 以编程方式访问托管在 WebSEAL 反向代理后面的资源

> ID：15116948
> 
> 赞同：2
> 
> 时间：2013-02-27T16:16:59.940
> 
> 标签：reverse-proxy, webseal

*   我们有一个 iPad 应用程序显示来自 drupal 站点的内容（仅提供 json 文件）。
*   我们的 IT 部门在 drupal 站点前放置了一个 SSO。WebSEAL 用于实现 SSO。
*   因此，当我们从浏览器访问 drupal 站点时，我们将被重定向到登录页面（表单身份验证），我们需要输入 Windows 用户名和密码才能继续。

当我们尝试从 ipad 访问 json 文件时，我们得到 401 状态，其中包含 html 内容和登录页面的 url。我们尝试通过在标头中发送用户名和密码来使用基本身份验证，但没有成功。谷歌搜索没有给出任何有用的解决方案。

有人有类似的问题吗？我只需要一种使用非浏览器客户端的用户名和密码进行身份验证的方法。

示例节点 js 代码

```
var http = require('http');

var username = 'username';
var password = 'password';
var auth = "Basic " + new Buffer(username + ":" + password).toString("base64");

var options = {
  host: 'devhome.intranet.example.com',
  port: 80,
  path: '/app/api/rest/views/category.json',
  headers : {
    "Authorization" : auth
  }
};

http.get(options, function(res) {
  console.log("Got response: " + res.statusCode);
  console.log(res);
}).on('error', function(e) {
  console.log("Got error: " + e.message);
}); 
```

非常感谢任何帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-07-08T14:24:14.760

我知道这是一个老问题，但我尝试做非常相似的事情（.Net 客户端访问 WebSeal 后面的 Web 服务）。谷歌搜索后没有有用的解决方案。

但是 IBM 文档给了我一个线索 [http://www.ibm.com/support/knowledgecenter/SSPREK_8.0.1.2/com.ibm.isamw.doc_8.0.1.2/wrp_config/task/tsk_submt_form_data_ws.html](http://www.ibm.com/support/knowledgecenter/SSPREK_8.0.1.2/com.ibm.isamw.doc_8.0.1.2/wrp_config/task/tsk_submt_form_data_ws.html)

基本上，当您从浏览器通过 Webseal 访问资源时，Webseal 会使用登录页面进行响应。输入用户名和密码后，表单数据将提交到 /pkmslogin.form 。Webseal 还返回一个 cookie，因此不必再次验证后续请求。

这意味着您需要发送一个 POST 请求：

> > 必须对 /pkmslogin.form 进行 POST。POST 请求正文必须包含三个字段的字段数据：用户名、密码、登录表单类型
> > 
> > 对于表单登录，login-form-type 的值必须是“pwd”。content-length 标头必须指示生成的请求正文的长度。

我在 .Net 中使用 HttpClient 做到了这一点。像这样的东西：

```
using (var httpClient = new HttpClient())
{
    // First post the authentication data
    var authenticationResult = httpClient.PostAsync("http://webseal/pkmslogin.form", 
        new FormUrlEncodedContent(
            new Dictionary<string, string>()
            {
                {"username", "user"},
                {"password", "pwd"},
                {"login-form-type", "pwd"}
            }
        )
    ).Result;
    // Now access our resource
    var webserviceResult = httpClient.GetAsync("http://webseal/webservice").Result;
} 
```

如果这不起作用，您可能需要通过 WebSeal 获取 Cookie 返回并每次发送该 Cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-28T20:32:33.287

```
------------------------------------------------------------------------------------
STEP (1)
------------------------------------------------------------------------------------
WEBSEAL URL: https://webseal/pkmslogin.form
METHOD     : POST
TYPE       : FormUrlEncodedContent
HEADER     : Content-Type: application/x-www-form-urlencoded
BODY       : login-form-type: pwd, password: XXXXXXXX, username: AAAAAAAA
-------------------------------------------------------------------------------------

200 OK

content-length: 818
content-type: text/html
date: Thu, 28 Jun 2099 19:58:54 GMT
p3p: CP="NON CUR OTPi OUR NOR UNI"
server: WebSEAL/6.0.0.3 (Build 060807)
pragma: no-cache
cache-control: no-cache
Set-Cookie: PD-S-SESSION-ID=2_Uufb+DPeYhDCsF2cjib-aQO6LwMn3VNM1faxbUOGbLKXqwBO; Path=/; Secure

STEP (2)
-------------------------------------------------------------------------------------
ENGAGE URL : https://webseal/engagetv/EngageAgent/MainPage.aspx?windowtype=popup&action_name=startactivity&jobTypeCode=A25&custPkey=0018048794_77
METHOD     : GET 
HEADER     : Set-Cookie: PD-S-SESSION-ID=2_Uufb+DPeYhDCsF2cjib-aQO6LwMn3VNM1faxbUOGbLKXqwBO; Path=/; Secure

200 OK

content-type: text/html; charset=utf-8
date: Thu, 28 Jun 2099 20:09:40 GMT
p3p: CP="NON CUR OTPi OUR NOR UNI"
x-old-content-length: 28754
transfer-encoding: chunked
x-powered-by: ASP.NET
x-ua-compatible: IE=9
cache-control: private
Set-Cookie: Eng5800TicketData=TtyXO3QjJu4qSQAYI6u5rZJr7ZCDRne10O1dt9e5BgPuU02sgszMUKwWOKlSyDVeMnfXyM4XJfe93tv4lQpxgpVKzScTGzK8sIsUiOSX5gHZWtPWcGW+axoaiZcH2+g9to+JvudPAtWvP/7Ikd88qwhCCRLv0KgSBXrpYkh6UlFOe3SDGuor/3/NX9dQbXA9zCqBymhR7W2ZEDYq37lStCKsEOvzV/sUyrAAHGYpptFZzIYIDwuytUpkMi3S6n1ZaDuysxjCjVNvNez5w+M3QF2bzMf625cvlCpJSb1WSnc1ZLbSxMRLXRCrWw/jJKJ1z7c7fPJozwwks/UQyTcRUkdPmwgjiNphT9+c7+LF74k75JAayMYkjR5lD79brFl5oFquck6zyZMCCy8445N98owHOr0vqqtZZaa7qKjZDOaUprx8LD4Qlzn+/YsMEMvgBFDTt1sKdv+SUGkVPi53AzPEkrpmD0H8pdEM6GOS2gXnYZw1tf6hDf3ZDVeGrl9k2ETn6XqDuQoB80af16Ew64TXMHSQgDtur9tndltcp2nqu0Grv04ov6TZKkloAPSZZcQ6ezgivlsASyLupFBKgtcUbC1L92vuf2YVPYA0oBSqOzIsRDe2f3gqNxcBOR9/vmGAhinQ5WzgSo9BkAbGTx/ooqk6kUMbwX2bvKth1SV5oDH5hkrOdnc2pkfpByipTE8lGxvGR1r6PeY7r3WHdfDy8c4HUpLWl3BCKckrmTvIPi2llpkzVRGyWrFVWpb2X/jF+MnGvcdH9Vo7PVvn7seD9TlXXo/ef8RRUmLmykUfxxDgrA1+qru0qu7STDpW4YYY/DPGPVlqg3sX4LRt5w==; Path=/
Eng5800Theme=Default; Path=/
PD-S-SESSION-ID=2_RZOySBlG-n-s7rUo7AiXIWgujUyyWN5674O4AOlW1W3W1-9n; Path=/; Secure
...
... 
```

# ios - 如何在 NSURLRequest 的类别中添加属性并实现 getter 和 setter？

> ID：15116949
> 
> 赞同：1
> 
> 时间：2013-02-27T16:17:00.273
> 
> 标签：ios, objective-c

我们如何在 NSURLRequest 的类别中添加属性，并在 NSURLRequest 中实现 getter，在 NSMutableURLRequest 中实现 setter？

我想要做的是在 NSMutableURLRequest 中设置一些自定义属性并将其加载到 UiWebView 中。我想要来自 UIWebView 的所有请求，无论 NSMutableURLRequest 或 NSURLRequest 是否具有这些自定义属性，我可以在自定义 NSURLProtocol 中访问它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:20:05.863

> 我们如何在 NSURLRequest 的类别中添加属性，并在 NSURLRequest 中实现 getter，在 NSMutableURLRequest 中实现 setter？

只是你会为任何其他课程做......

```
@interface NSURLRequest (MyCategory)

@property (nonatomic, assign) int foo;

@end

@implementation NSURLRequest (MyCatgeory)

- (int)foo
{
    return 42;
}

- (void)setFoo:(int)f
{
    otherVar = f;
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-10T00:13:52.223

向 NSURLRequest 添加额外的属性是一种特殊情况，实现如下：

NSMutableURLRequest+JSONBody.h

```
@interface NSMutableURLRequest (JSONBody)

@property (nullable, copy, setter=mhf_setJSONBody:) id mhf_JSONBody;

@end 
```

NSMutableURLRequest+JSONBody.m

```
@implementation NSMutableURLRequest (JSONBody)

-(id)mhf_JSONBody{
    return [NSURLProtocol propertyForKey:NSStringFromSelector(@selector(mhf_JSONBody)) inRequest:self];
}

-(void)mhf_setJSONBody:(id)JSONBody{
    [NSURLProtocol setProperty:JSONBody forKey:NSStringFromSelector(@selector(mhf_JSONBody)) inRequest:self];
}

@end 
```

以这种方式而不是通过关联对象执行此操作可以让复制工作！

# .net - MVVM - 一个视图对其他 ViewModel 了解多少？

> ID：15116950
> 
> 赞同：0
> 
> 时间：2013-02-27T16:17:01.927
> 
> 标签：.net, mvvm

我正在尝试找出实现我的设计的最佳方法，或者了解我的设计在 MVVM 方法方面是否错误。

这个想法是我的 MainWindow 将有 2 个控件；A `Menu`（正常、文件、编辑等）和`ContentControl`. 将`ContentControl`绑定到我的 MainWindowViewModel 的属性。

当应用程序加载时，我的 MainWindowViewModel 的构造函数将一个属性（称为 CurrentView）绑定到我的 WelcomeView；这是一条欢迎信息，有 2 个按钮。第一个按钮是打开一个名为 SearchView 的新视图，另一个按钮是打开一个名为 AddView 的视图。

我遇到的问题是弄清楚这将如何工作。

是否允许我的 WelcomeViewModel 知道 MainWindow 视图模型？我假设注意。也许它应该调用 App.xaml 中的一个函数，上面写着“我已被点击，请关闭我并打开新视图”？

我希望我的问题很清楚，如果没有，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:37:26.723

是的。这就是我在 WPF 中解决“部分视图”的方式：

MainView 有一个

`<ContentPresenter Content="{Binding ActiveViewModel}"/>`,

那么 MainViewModel 有一个

`public BaseViewModel ActiveViewModel {get;set;} //NotifyPropertyChanged, of course =)`

因此，每当您更改“活动 ViewModel”时，contentpresenter 都会显示该 VM 的视图。就如此容易

# jqgrid - JqG rid - 同一级别的多个子网格

> ID：15116951
> 
> 赞同：0
> 
> 时间：2013-02-27T16:17:02.490
> 
> 标签：jqgrid, subgrid

任何人都可以指向同一级别的多个子网格演示或示例。我已经看过[http://www.trirand.net/demoaspnet.aspx](http://www.trirand.net/demoaspnet.aspx)。我正在寻找 javascript 中的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:29:54.447

trirand.net[的演示仅显示以下内容](http://www.trirand.net/examples/grid/hierarchy/several_subgrids/default.aspx)

![在此处输入图像描述](../Images/2bed615bdf2b1704edd44f83c7aef86e.png)

像上图那样创建子网格非常容易。您应该只了解[Subgrid as Grid](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:subgrid_as_grid)技术的工作原理。

如果用户单击“扩展”（“+”）图标 jqGrid 在扩展下方创建空的新行。行 ( `<tr>`) 将获得类`"ui-subgrid"`。在行 jqGrid 的内部，使用主要的子网格信息创建两个元素`<td>`。jqGrid 分配，以便将扩展到网格的最后一列。在jqGrid 内部创建**empty**。空 div 获取唯一属性，该属性将由网格 id 的 id、字符“_”和扩展行的 id 构成。`td.subgrid-cell``td.subgrid-data``colspan``<td>``td.subgrid-data`**`div.tablediv`**`id`

下一步是最重要的。jqGrid 调用`subGridRowExpanded`回调。回调的第一个参数是应该放置“子网格”内容`id`的空`<div>`( )。`div.tablediv`代替`<table>`element one 可以放置**任何其他 HTML 片段**。请参阅[答案](https://stackoverflow.com/a/4115481/315935)中[的旧演示](http://www.ok-soft-gmbh.com/jqGrid/SubGrid.htm)。因此，要创建“同一级别的多个子网格”，只需放置两个具有一些唯一 ID 的元素，然后使用 jqGrid 在表格的位置创建网格。`<table>`

# aptana - 如何从 Aptana 中删除片段或优先考虑 Emmet

> ID：15116956
> 
> 赞同：0
> 
> 时间：2013-02-27T16:17:12.737
> 
> 标签：aptana

当我使用 Emmet 并按 c TAB 时，我得到的是版权而不是颜色。

我在片段中搜索了版权一词，但没有找到相关的狙击。我在 Preferences > Keys 下查找并搜索 Zen 或 Tab，但我不知道如何设置 Emmet 的优先级。当去 Command > HTML /CSS>Edit this bundle 注意发生

有谁知道我如何从 Aptana 中删除所有片段或优先考虑 Emmet（Zen Coding）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:50:10.413

版权片段可在文本包中找到。要禁用它，请转到`Commands > Text > Edit this Bundle`。这将在 Project Explorer 视图中创建一个新项目。在项目内部的代码片段下，有一个名为 snippets.rb 的文件，您可以在其中找到支持版权代码片段的代码。将其注释掉或删除，保存文件，然后重新启动 Aptana。`c)`不应再制作版权代码段。

# c# - 从 LiNQ 查询中获取结果

> ID：15116957
> 
> 赞同：1
> 
> 时间：2013-02-27T16:17:12.357
> 
> 标签：c#, asp.net, linq

我是使用 LiNQ 的新手。我有以下代码，用于在发票对象上查找零件的订购数量。

```
var invoiceQty = from i in returnInvoices
                 where i.PartNo == returnPart.PartNo && i.InvoiceID == hiddenInvoiceId.Value
                 select i.OrderLineQty;

if (Convert.ToInt32(txtReturnProdQty.Text) > Convert.ToInt32(invoiceQty))
{
    args.IsValid = false;
    SourceValidate.ErrorMessage = "Returned qty cannot be greater than quantity available on the invoice.";
    txtReturnProdQty.Focus();
    return;
} 
```

我认为我没有`OrderLineQty`正确获取 if 语句的值，因为它会生成以下错误：

```
System.InvalidCastException: Unable to cast object of type  'WhereSelectListIterator`2[Invoice,System.Double]' to type 'System.IConvertible'. 
```

谁能帮我理解如何在 LiNQ 查询中使用返回值？

LiNQ 需要一段时间才能融入其中！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:23:37.900

在“使用”之前，不会评估 linq 表达式。

这意味着即调用 invoiceQty.ToList() 或 .First()

在此之前 invoiceQty 类型是“表达式”而不是有效类型。要获得您需要的总量：

```
invoiceQty.Sum() 
```

或者干脆替换查询：

```
var invoiceQty = (from i in returnInvoices
                 where i.PartNo == returnPart.PartNo && i.InvoiceID == hiddenInvoiceId.Value
                 select i.OrderLineQty).Sum(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:51:55.820

试试这个方法：

```
if (invoiceQty.FirstOrDefault() != null) return;

if (Convert.ToInt32(txtReturnProdQty.Text) > (decimal)invoiceQty.First())
{
    args.IsValid = false;
    SourceValidate.ErrorMessage = "Returned qty cannot be greater than quantity available on the invoice.";
    txtReturnProdQty.Focus();
    return;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:24:09.483

这是因为您要返回一个`IEnumerable<T>`，如果`OrderLineQty`是一个 int，那么 invoiceQty 的类型就是`IEnumerable<int>`。

当您进行比较时，这是没有意义的。

如果您只期望一个结果，请`.Single()` [在此处使用](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.single.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T16:24:26.587

如果您熟悉的话，Linq 就像一个 SQL 查询。在您的代码中，invoiceQty 将包含一个 i.OrderLineQty 的 LIST（更具体地说，是一个 IQueryable），它满足您在 where 子句中的搜索条件。即使只有一个匹配，它仍然会给你一个包含一个元素的列表。

您希望确定只有一个匹配（并且 where 子句似乎支持该假设），因此如果您的情况可以请求 Single、First、SingleOrDefault 或 FirstOrDefault（[单击此处](http://msdn.microsoft.com/en-us/library/bb341635.aspx)查看可用方法的完整列表）

```
if (Convert.ToInt32(txtReturnProdQty.Text) > Convert.ToInt32(invoiceQty.First())) 
```

# javascript - 你如何传递语义数据做一个 jQuery 委托？

> ID：15116958
> 
> 赞同：0
> 
> 时间：2013-02-27T16:17:17.397
> 
> 标签：javascript, jquery

jQuery 中的委派/“on”似乎是新的热点。我完全明白委托函数接收事件对象。

但我的问题是如何将语义/应用程序数据传递给委托？

## 老方法，没有委托：

```
// bind a new closure for each button
for (var i = 0; i < MyApp.Widgets.length; i++) {
  var widgetId = MyApp.Widgets[i];

  $('#myapp-widget-button-' + i).click(
    function () {
      MyApp.upgradeWidgetById(widgetId);
    }
  );
} 
```

## 新方式，委托（和部分缺失）：

```
// refactor custom closures into one delegate
$('#myapp-widget-container').delegate('.myapp-widget-button', 'click', function () {
  // MyApp.upgradeWidgetById( ... )
}); 
```

从哪里来`widgetId`？我感觉到这是数据属性发挥作用的地方：

## 新方式，具有委托和数据属性

```
// attach application data to the handled objects
for (var i = 0; i < MyApp.Widgets.length; i++) {
  var widgetId = MyApp.Widgets[i];

  $('#myapp-widget-button-' + i).data('widgetId', widgetId);
}

// refactor custom closures into one delegate
$('#myapp-widget-container').delegate('.myapp-widget-button', 'click', function () {
  var widgetId = $(this).data('widgetId');

  MyApp.upgradeWidgetById(widgetId)
}); 
```

但这真的是唯一的方法吗？我很担心，因为没有多少教程提到与代表相关的数据属性，所以我想知道我是否遗漏了什么或做错了什么。

编辑：编辑以反映“开”是新的黑色，尽管是穿着羊皮的代表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:28:55.947

您实际上并不需要委托，因为您似乎为这些元素设置了 data 属性。

只需`.click`像下面这样使用数据参数，

```
// attach application data to the handled objects
for (var i = 0; i < MyApp.Widgets.length; i++) {
  var widgetId = MyApp.Widgets[i];

  $('#myapp-widget-button-' + i).click({'widgetId', widgetId}, myFunction);
}

//later in code
function myFunction(e) {
    var widgetId = e.data.widgetId;

    //your code
} 
```

**注意：**我正在使用`.click`，因为我不确定您使用的 jQuery 版本。

# servicestack - mini-profiler javascript 和 css 包含不返回

> ID：15116959
> 
> 赞同：2
> 
> 时间：2013-02-27T16:17:23.280
> 
> 标签：servicestack

在 global.asax 中包含用于启动和停止分析的代码。

当我查看页面时，加载 ssr-jquip、ssr-includes（javascript 和 css）的请求失败。

这以前有效 - 上次我查看它是几个版本的服务堆栈之前。

我需要做什么或必须让这些文件由 servicestack.net 交付？

![请求失败](../Images/f1eb0c8d703e485cd5d06d53e8c36896.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T06:02:54.393

事实证明，如果您更改 ServiceStackHandlerFactoryPath 并使用以正斜杠开头的路径，则 mini profiler 生成的脚本引用不正确。

因此，例如，如果您这样做：
`var endpointHostConfig = new EndpointHostConfig { ServiceStackHandlerFactoryPath = "/newpath", };` 那么您引用 localhost:2343/newpath/someApiCall
然后迷你分析器将发出对 newpath/ssr-includes.css 的引用，这是不正确的。

将您的代码更改为： `var endpointHostConfig = new EndpointHostConfig { ServiceStackHandlerFactoryPath = "newpath", };`

解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T13:33:53.833

您也可以使用以下语法处理此问题：

```
Profiler.Settings.RouteBasePath = "~/newpath"; 
```

# java - 使用 WindowsBuilder Pro

> ID：15116961
> 
> 赞同：3
> 
> 时间：2013-02-27T16:17:33.683
> 
> 标签：java, eclipse, swing, ubuntu, miglayout

我正在尝试使用 WindowsBuilder Pro 来开发 Swing UI。我正在使用 MiGLayout 管理器。在设计视图中开发时，当我创建一个新项目（JLabel、JTextField 等）时，要编辑的框会出现在图片中可以看到的实际组件之外。

![WindowsBuilder Pro 中的错误渲染](../Images/4582ebff9b7bcf3f67d9d53ef652dd3f.png)

我搜索了有关 WindowsBuilder Pro 和 MiGLayout 的信息，但发现工作正常，如图所示从[这个链接](https://developers.google.com/java-dev-tools/wbpro/layoutmanagers/swing/miglayout#MainFeatures)

![工作正常的 WindowsBuilder Pro](../Images/d4da2e59604cc426d55a7d992b4e2e0b.png)

我在我的 Ubuntu 12.10 x64 系统中使用 Eclipse。

如何解决？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-03-13T08:47:31.087

或重新设计布局或手动查看代码。一定是添加和删除组件一直是垃圾。

# java - 我无法在我的 java 代码中访问正确的 MANIFEST.MF 文件

> ID：15116968
> 
> 赞同：2
> 
> 时间：2013-02-27T16:17:50.813
> 
> 标签：java, jar, manifest.mf

我尝试了多种方法来在单元测试中从正确的 jar 访问清单。我遇到的问题是它似乎是在读取它的第一个 jar 文件，而不是我班级的那个。这是我最近的尝试

```
InputStream is = Test.class.getResourceAsStream("/META-INF/MANIFEST.MF");
try {
    if (is == null) {
        System.out.println("null no input stream");
    } else {
        Manifest manifest = new Manifest(is);
        Attributes attributes = manifest.getMainAttributes();
        v = attributes.getValue("Test");
        System.out.println("Test="+v);
        v = attributes.getValue("Created-by");
        System.out.println("By="+v);
    }
} catch (IOException e) {
    System.out.println("error");
} finally {
    if (is != null) {
        is.close();
    }
} 
```

这些是结果

`Test=null By=1.6.0_18 (Sun Microsystems Inc.)`

`MANIFEST.MF`我想使用的值为，`Test`所以我知道这是读取错误的文件

有谁知道我如何指定包含清单文件以供单元测试使用的 jar？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:48:39.867

这就是我想出的......注意`HTMLDocumen`用你的类/对象替换 t 。

```
 HTMLDocument htmlDoc = new HTMLDocument();

    try
    {
      JarFile jarfile = new JarFile(htmlDoc.getClass().getProtectionDomain().getCodeSource().getLocation().getPath());

      // Get the manifest
      Manifest manifest = jarfile.getManifest();

      Map<String,Attributes> msa = manifest.getEntries();

      for (String key : msa.keySet())
      {
        System.out.println("KEY: " + key);

        Attributes a = msa.get(key);

        for (Object k : a.keySet())
        {
          System.out.println(k + " - " + a.get(k));
        }
      }
    }
    catch (IOException e)
    {
      System.out.println("error");
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:29:30.267

你可以试试这个：

```
URLClassLoader classLoader = (URLClassLoader) getClass().getClassLoader();
try {
  URL url = classLoader.findResource("META-INF/MANIFEST.MF");
  Manifest manifest = new Manifest(url.openStream());
  // add your code
  ...
} catch (IOException E) {
  // handle exception
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T17:18:39.073

您可以通过以下方式访问包含您的类的 jar：

```
InputStream in = MyClass
                .class
                .getProtectionDomain()
                .getCodeSource()
                .getLocation()
                .openStream(); 
```

我在您的代码中更改了这一行并得到了相同的结果，[您可能想自己步行并阅读整个 jar，](https://stackoverflow.com/a/5061589/20654)直到找到清单文件然后从那里读取它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T16:40:23.910

*“测试”*不是[主要属性](http://docs.oracle.com/javase/1.5.0/docs/guide/jar/jar.html#Main%20Attributes)。

尝试[getEntries()](http://docs.oracle.com/javase/6/docs/api/java/util/jar/Manifest.html#getEntries%28%29)并在那里查找您的自定义属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T19:02:04.587

这是我最后使用的方法...

```
String path = Test.class.getProtectionDomain()
            .getCodeSource().getLocation().getPath();

    path = path.replace("classes/", "");

    URL url = null;
    try {
        url = new URL("jar:file:"+path+"test.jar!/");
        JarURLConnection jarConnection = null;
        try {
            jarConnection = (JarURLConnection)url.openConnection();
            Manifest manifest = jarConnection.getManifest();

            java.util.jar.Attributes manifestItem = manifest.getMainAttributes();
            System.out.println(manifestItem.getValue("Test"));
            System.out.println(manifestItem.getValue("Implementation-Version"));

        } catch (IOException e) {
            e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        }

    } catch (MalformedURLException e) {
        e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
    } 
```

它对所有路径操作和 jar 名称的硬编码非常脏……这有关系吗？再一次感谢你！

# java - X509证书文件检查

> ID：15116978
> 
> 赞同：0
> 
> 时间：2013-02-27T16:18:28.863
> 
> 标签：java, x509certificate

我已经签名文件并且我有 X509Certificate 实例，如何根据这个证书检查这个文件是否有效？程序是用 Java 编写的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:35:20.597

检查这个例子。您可以将其从验证消息更改为验证文件： [http ://www.flexiprovider.de/examples/ExampleSMIMEverify.html](http://www.flexiprovider.de/examples/ExampleSMIMEverify.html)

# requirejs - RequireJs - 第一次尝试 - 似乎无法正确

> ID：15116983
> 
> 赞同：0
> 
> 时间：2013-02-27T16:18:33.563
> 
> 标签：requirejs

因此，我尝试根据 John Papa 在 PlurarlSight 上的 Code Camper 教程使用 RequireJs 进行设置，但我似乎仍然无法做到正确。

我的 bootstrapper.run() 永远不会被调用，因为 bs 总是未定义

_Layout.cshtml

```
@Scripts.Render("~/Scripts/kendo/2012.3.1114/jquery.min.js")
@Scripts.Render("~/Scripts/kendo/2012.3.1114/kendo.web.min.js")
@Scripts.Render("~/Scripts/libs/knockout-2.2.1.js")
@Scripts.Render("~/Scripts/libs/toastr-1.1.5.js")
@Scripts.Render("~/Scripts/libs/require.js") 
```

脚本/main.js

```
(function() {
var root = this;
requirejs.config({
    baseUrl: 'Scripts/libs',
    paths: {
        app: '../app'
    }
});
Define3rdPartyModules();
LoadPluginsAndBoot();

function Define3rdPartyModules() {
    //Load things such as jquery, ko, Kendo, toastr etc here
    define('jquery', [], function () { return root.jQuery; });
    define('knockout', [], function () { return root.ko; });
    define('toastr', [], function () { return root.toastr; });
    define('kendo', [], function() { return root.kendo; });
}

function LoadPluginsAndBoot() {
    //Load self create plugins and extensions here
    requirejs(['app/ko-bindingHandlers', 'app/ko-kendo'], Boot);
}

function Boot() {

  require(['app/bootstrapper'], 
    function (bs) {
        bs.run();
    });
}

})(); 
```

脚本/app/bootstrapper.js

```
define('bootstrapper',
[],
function () {

  var run = function () {
    alert('we ran this');
  };

  return { run: run };
}); 
```

bootstrapper.js 出现在我的开发控制台窗口中，但 bs 未定义。

此外，我正在尝试使用 Ryan Niemeyer 创建的 ko-kendo 扩展，我看到它内置了 requirejs 检查，所以我应该在我的 _Layout.cshtml 中定义它还是将其保留在原处？

# ruby-on-rails - Ruby on Rails 指南：nil:NilClass 的未定义方法“fields_for”

> ID：15116985
> 
> 赞同：0
> 
> 时间：2013-02-27T16:18:42.660
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在阅读 Rails 指南（[http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html),and)），并被困在第 11 项“构建多模型表单”中。

这部分练习解释了如何将一个模型的表单字段包含在另一个模型的表单中......

新/编辑帖子上的错误：**nil:NilClass 的未定义方法“fields_for”**

```
Extracted source (around line #2):

1: <% @post.tags.build %>
2: <%= form.fields_for :tags do | tag_form | %>
3:   <div class="field">
4:     <%= tag_form.label :name, 'Tag: ' %>
5:     <%= tag_form.text_field :name %> 
```

代码完全按照练习（我什至绝望并直接从示例中复制并粘贴代码）

我的代码发布在下面..我花了几个小时将它与指南中的代码进行比较，它完全一样..谁能指出我可能出了什么问题？

提前谢谢了。

这是我包含部分的代码

**模型/post.rb：**

```
class Post < ActiveRecord::Base
  attr_accessible :content, :name, :title, :tags_attributes

  validates :name, :presence =>true
  validates :title, :presence =>true,
                        :length => { :minimum => 5 }
  has_many :comments, :dependent => :destroy
  has_many :tags

  accepts_nested_attributes_for :tags, :allow_destroy => :true,
    :reject_if => proc { |attrs| attrs.all? { |k, v| v.blank? } }
end 
```

**模型/tag.rb：**

```
class Tag < ActiveRecord::Base
  belongs_to :post
  attr_accessible :name
end 
```

**帖子/_form.html.erb：**

```
<% @post.tags.build %>
<%= form_for(@post) do |post_form| %>
  <% if @post.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h2>

      <ul>
      <% @post.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= post_form.label :name %><br />
    <%= post_form.text_field :name %>
  </div>
  <div class="field">
    <%= post_form.label :title %><br />
    <%= post_form.text_field :title %>
  </div>
  <div class="field">
    <%= post_form.label :content %><br />
    <%= post_form.text_area :content %>
  </div>
  <h2>Tags</h2>
  <%= render :partial => 'tags/form',
                     :locals => {:from => post_form} %>
  <div class="actions">
    <%= post_form.submit %>
  </div>
<% end %> 
```

**标签/_form.html.erb：**

```
<%= form.fields_for :tags do | tag_form | %>
  <div class="field">
    <%= tag_form.label :name, 'Tag: ' %>
    <%= tag_form.text_field :name %>
  </div>
  <% unless tag_form.object.nil?  || tag_form.object.new_record? %>
    <div class="field">
      <%= tag_form.label :_destroy, 'Remove: ' %>
      <%= tag_form.check_box :_destroy %>
    </div>
  <% end %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:23:06.207

只是您的帖子/_form 结尾处的一个错字

```
<%= render :partial => 'tags/form', :locals => {:from => post_form} %> 
```

应该

```
<%= render :partial => 'tags/form', :locals => {:form => post_form} %> 
```

表格不从！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:24:39.257

表格拼写错误。

`:locals => {:from => post_form}` 到 `:locals => {:form => post_form}`

# algorithm - Big-O 表示法 - 算法分析

> ID：15116989
> 
> 赞同：2
> 
> 时间：2013-02-27T16:19:00.437
> 
> 标签：algorithm, big-o

是 O(5n) = 5*O(n) 吗？据我了解，O(5n) == O(n)。因此他们不相等？如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T16:20:42.197

您只关心函数的渐近行为，如果`f(x)/g(x)`收敛到一个常数，则两个函数被定义为属于同一个 big-O 类。所以`5*n / n`总是5。所以`O(n) = O(5*n)`。

至于您的问题：`O(f(x))`被定义为具有与 f(x) 相同的渐近行为的函数集，因此`5*O(N)`未定义。哪有这回事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T16:22:14.313

你说得对，`O(5n)`确实等于`O(n)`。5*O(n) 没有意义，`O`不返回结果，它是一个符号。所以你不能把它和一个数字相乘。

尽管有一些定义在公式中使用了大 O，例如[error terms](http://en.wikipedia.org/wiki/Big_O_notation#Infinitesimal_asymptotics)。但它必须事先像这样定义。

这里的[维基百科链接](http://en.wikipedia.org/wiki/Big_O_notation#Multiplication_by_a_constant)描述`O(c*n) = O(n)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T16:46:48.977

> O(5n) = 5*O(n)

如前所述，这没有定义。

我建议您至少（重新）阅读[有关该主题的维基百科文章](http://en.wikipedia.org/wiki/Big_O_notation)。

“f(x) = O(g(x)) as x -> 无限”意味着（非正式直观定义）：“f 以 g 为界，渐近到一个常数因子”。有关正式定义，请参阅上面的文章。

> O(5n) == O(n)。

我认为这是更正确的（“作为 x -> 无限”暗示）： f(x) = O(x) <=> f(x) = O(5x)

干杯!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T16:20:50.717

变量增长率的重要性。加、减、乘或除以任何常数不会改变它们。

因此，任何常数都是微不足道的，可以在不损失准确性的情况下省略。

关于你的问题——`O(5n) = O(n) = 5*O(n)`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T16:26:55.673

是什么`5 * { Droider }`？

`operator *`如果没有对[*集合*](http://en.wikipedia.org/wiki/Set)的特殊定义（或者至少对于大 O 符号），这两个问题（你的和我的）都没有任何意义。
当然你可以定义`g(n)*O(f(n)) = O(f(n) * g(n))`，然后它就很有意义了，但是你必须先定义它。
AFAIK，此操作没有标准定义。

有了上面的定义，我们得到`5*O(n) = O(5*n) = O(n)`，你的假设是正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T16:29:28.693

数学上 O(5N) != O(N) 但是当涉及到算法时，你关心的是效率，或者换句话说，算法的复杂性，所以你更关心变量 N 所以 O(5N) == O(N)就像同样有效（或复杂）一样。

# c# - Windows 窗体中的动态搜索

> ID：15116991
> 
> 赞同：-1
> 
> 时间：2013-02-27T16:19:04.800
> 
> 标签：c#, ajax, winforms

我刚刚为我的第一学期大学项目设置了我的软件开发任务，并且一直在规划 UI。

在被介绍给 C# 之前，我花了很多时间进行 Web 开发，并且非常熟悉 AJAX。

我想知道 C#/Windows 表单中是否有任何工具可以在用户输入文本框时提供实时字段刷新 - 任何反馈都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:29:51.167

Windows 窗体中没有 AJAX 或类似的东西。实时字段刷新是通过几个事件完成的。假设您有一个 TextBox 和一个 ComboBox（下拉列表）。该列表包含很多项目，您想使用文本框过滤它们。

在这种情况下，您可以使用 TextBox 的 TextChanged 事件并从初始项目集合中筛选项目。过滤后，再次将项目绑定到您的 ComboBox。

# c# - 使用 Rijndael 加密和解密字符串

> ID：15116995
> 
> 赞同：0
> 
> 时间：2013-02-27T16:19:20.213
> 
> 标签：c#, security, cryptography, aes, rijndael

在开始之前，我知道在 stackoverflow 上有很多类似的问题，但大多数答案都包含一大段代码，没有任何解释或帮助帮助用户。

我需要做的很简单，从用户那里获取一个字符串作为输入，然后是密码，然后用密码加密字符串并将密文写入文件。然后在用户需要时，从文件中读取密文并对其进行解密，并向用户呈现原始纯文本。我可以处理文件的写入和写入，我只需要加密字符串的帮助。（注意：我不想只加密/解密整个文件 - 因为它必须包含一些未加密的东西 - 只是程序中的一个字符串）

此外，所需的“初始化向量” - 它可以与密码相同吗？或者它可以简单地硬编码到程序中吗？它甚至对安全至关重要吗？如果没有，那么用户是否必须记住密码和 IV？

另一件事，当用户来解密并输入错误的密码时，Rijndael 类中的方法只是引发错误还是什么？

我精通 C#，但我是密码学的新手，所以如果你能引导我完成任何代码或回答你的帖子，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T21:28:47.380

大多数 Rijndael 模式都需要 IV，通常您只需将其添加到密文中，用户无需记住。

由于您使用用户键入的密码进行解密，因此您希望使用[Authenticated Encryption](http://en.wikipedia.org/wiki/Authenticated_encryption)以便您的程序可以在输入错误密码时安全地重新提示，否则您的程序可能不会给出任何指示存在问题并吐出随机文本.

我有一个使用带有 HMAC-SHA256 身份验证的 AES-CBC 的示例，我尝试更新并进行了审查，它实际上有一个帮助方法，可以仅使用纯文本和密码处理加密，并且也得到了很好的评论：

[字符串的对称认证加密的现代示例。C＃](https://stackoverflow.com/a/10366194/637783)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T21:28:40.523

您需要采取以下步骤：

1.  根据密码计算密钥。您需要生成一个 8 字节的随机盐和一个迭代计数作为基于密码的密钥派生函数 (PBKDF) 的输入，例如 PBKDF2；
2.  使用任何编码（如 UTF-8）对字符串进行编码，为您提供密码的明文；
3.  使用 PKCS#7 填充创建密码，例如 CBC 模式下的 AES-128；
4.  创建一个随机 IV，这应该是以字节为单位的块大小（因此对于 AES，这将是 16 个字节）；
5.  使用给定的密码加密你的明文，给你密文；
6.  存储盐、IV 和密文 - 如果需要字符串，可以使用 Base64 等编码。

PBKDF2 在`Rfc2898DeriveBytes`.

请注意，此答案仅显示如何实现机密性，而不是完整性或真实性。

# android - 当设置了不保留活动时调用 oncreate

> ID：15116999
> 
> 赞同：0
> 
> 时间：2013-02-27T16:19:37.173
> 
> 标签：android, performance

谁能告诉我在以下情况下我应该怎么做。我有四个活动 Ac1、Ac2、Ac3 和 Ac4，每个活动都有一个取消按钮，按下时应该转到 Ac1。后退按钮也应该返回到以前的活动。Ac1 是流程的起点，Ac4 是流程的终点。

我在取消按钮和最后一个 Ac4 中使用了 FLAG_ACTIVITY_NEW_TASK 以返回到 Ac1。但这并没有按预期工作。所以要做到这一点，我有一个广播寄存器来在任何活动中按下取消按钮时停止活动。因此，在收到广播接收器时，我会调用 finish() 来关闭堆叠的活动。未设置开发人员选项时一切正常（不要保留活动）。设置此选项时，1\. Ac1 移动到 Ac2。2\. Ac2 启动，但 Ac1 清零。3\. Ac2 移动到 Ac3 4\. Ac3 启动，Ac2 被清除。5\. 当 Cancel 被调用时，广播接收器被发送到关闭活动。6\. 令人惊讶的是，我看到调用的是 Ac2，而不是 Ac1。我可以看到 Ac2 的 onCreate 正在被调用。

我不知道如何摆脱这种情况。谁能帮我摆脱这种情况。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:40:01.507

如果我理解正确，您希望支持可能从 A1 增长到 A4 的一系列活动。用户可以使用后退按钮从 A(N+1) 转换回 A(N)，并且可以点击取消按钮来清除从 A(N) 到 A2 的整个堆栈，只留下 A1。

（对不起，如果这不比你原来的描述更清楚:-)

我的第一种方法是使用[`Activity.startActivityForResult`](http://developer.android.com/reference/android/app/Activity.html#startActivityForResult%28android.content.Intent,%20int%29)启动子活动。当子活动退出时（无论是通过后退按钮、取消按钮还是正常退出），该子活动的直接父级可以查看传递回的结果代码，[`onActivityResult`](http://developer.android.com/reference/android/app/Activity.html#onActivityResult%28int,%20int,%20android.content.Intent%29)如果结果代码指示取消，则自行终止按钮被选中。

你有没有尝试过这样的事情？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:26:25.597

广播有点矫枉过正，而 FLAG_ACTIVITY_NEW_TASK 不是您想要的。尝试在取消按钮中调用 Ac1`intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP|Intent.FLAG_ACTIVITY_SINGLE_TOP);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:38:47.450

我会这样做：

```
class Activity2{

    int KILL_ACTIVITY=555;

    startActivityForResult(new Intent(Activity2.this,Activity3.class), 0);

    @Override onActivityResult(... , int result){
        if(result==KILL_ACTIVITY)
            finish();
    } 
```

## }

```
class Activity3{

    int KILL_ACTIVITY=555;
    @Override onClick(View v){
        if(v.getId()==R.id.button){
            setResult(KILL_ACTIVITY);
            finish();
        }
    }

    startActivityForResult(new Intent(Activity3.this,Activity4.class), 0);

    @Override onActivityResult(... , int result){
        if(result==KILL_ACTIVITY)
            finish();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T16:36:07.070

尝试将取消按钮链接到 ac1 尝试清除旧的活动堆栈并跳转到 ac1

```
Intent intent  = new Intent(this, ac1.class);
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);        
startActivity(intent); 
```