# StackOverflow 问答 14865000-14865999

# d3.js - NVD3 lineChart中的可变笔划宽度

> ID：14865001
> 
> 赞同：2
> 
> 时间：2013-02-13T23:06:36.007
> 
> 标签：d3.js, nvd3.js

我试图弄清楚是否有一种相当简单的方法可以扩展 NVD3 的 lineChart 模型以允许沿图表中的每条线路径的可变笔划宽度。

具体来说，我正在处理一个简单的折线图，我需要在其中显示不同行业的就业同比增长（NVD3 的折线图完美地工作），同时也给出这些行业的相对权重的概念（即农业可能正在增长，而总体上只雇用了几百人，而零售业可能正在苦苦挣扎，但仍在雇用很大比例的人口）——这当然不是线性规模，但假设每个部门的相对权重不同随着时间的推移，与细线相比，较粗的线可能代表一个拥有更多员工的部门。

显然，我可以很容易地使用即整个时间跨度内每个扇区的平均权重来更改整条线的笔划宽度，但据我了解，SVG 中无法指定单个路径元素的不同宽度：创建一个建立在 lineChart 之上的 NVD3 模型，但将每条线分割成离散的多边形（三角形？），是否有意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-16T21:35:12.847

我自己正在寻找这个问题的答案。似乎没有简单的方法，但一种可能性是使用 stroke-dasharray 属性。 [http://owl3d.com/svg/vsw/articles/vsw_article.html](http://owl3d.com/svg/vsw/articles/vsw_article.html)

本质上，您可以创建一系列克隆路径，涵盖一系列笔划宽度。如果将它们转换为破折号数组，则可以使用破折号之间的间距来控制在每个点上可见的路径。

根据您正在寻找的形状和宽度，您还可以通过添加第二个路径元素来伪造它，该元素与第一个元素的偏移量不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-16T21:47:01.083

也许生成一个闭合路径并在该路径上应用[图案](https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Patterns)填充或常规填充。闭合路径实际上是三角形，以模拟不同宽度的线。

# java - 如何仅将 Servlet 保留到我的站点（某种身份验证）？

> ID：14865009
> 
> 赞同：1
> 
> 时间：2013-02-13T23:07:32.730
> 
> 标签：java, web-applications, servlets

我有一个通过 servlet 向用户发送动态信息的网站。它是无状态的，没有登录。这个特定站点使用大量的 doPost() 和 doGet() 从客户端浏览器到服务器的调用。

我的问题是，如果有人阅读了我的源代码，他们可以轻松地撕掉我面向公众的 servlet URL，并以我的网络服务器为费用获得免费的 API。

我怎样才能防止这种情况发生？我可以在 JavaScript 和 Java 之间使用某种不会增加明显延迟的身份验证包吗？我只希望我网页上的用户能够调用面向公众的 servlet。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:10:44.320

两个想法：

1.  REFERRER HTTP 标头以确保客户端来自授权来源
2.  要求您服务的授权用户提供与其网站相关联的 API 密钥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:58:57.427

不是专家，但这可能会有所帮助： http: [//oauth.net/](http://oauth.net/)我知道像 twitter 这样的大型网络 API 使用它。

# hadoop - 将 pig 脚本的输出存储在文件名是动态生成的文件中

> ID：14865011
> 
> 赞同：0
> 
> 时间：2013-02-13T23:07:45.427
> 
> 标签：hadoop, mapreduce, apache-pig

在执行 pig 脚本时，如果您有一个将输出存储到文件中的步骤。我们能否在不给出固定文件名的情况下动态生成文件名。

如果可以动态创建文件名，我们可以保留当前日期作为文件名吗？

谢谢，

问候， Dheeraj Rampally。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:05:04.357

您可以通过 pig -param date=value 或在 pig.params 中指定 date=value 来使用参数替换。您将能够通过 $date 访问 pig 脚本中的指定值

# c# - 如何创建设计器代码？

> ID：14865012
> 
> 赞同：0
> 
> 时间：2013-02-13T23:07:51.417
> 
> 标签：c#, asp.net, .net

我有一个 ascx，当我拖放任何控件时，设计器中不会创建任何内容，并且后面的代码中没有任何智能感知。是否有手动创建设计器和初始化代码的步骤？还是其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:15:16.037

在解决方案资源管理器中右键单击您的`ascx`或`aspx`文件，然后单击`Covert to Web Application`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:15:35.200

尝试删除设计器文件，关闭 ascx 并重新打开它。VS 应该重新创建设计器。

# asp.net-mvc-3 - EntityFramework 中的 FindBy Id 方法

> ID：14865013
> 
> 赞同：1
> 
> 时间：2013-02-13T23:07:58.793
> 
> 标签：asp.net-mvc-3, entity-framework, repository-pattern

当我们有这个 GenericRepository 类时，可以在实体框架中实现 FindBy 方法：

```
public class Repository<T> : IRepository<T> where T : class, IAggregateRoot
    {

        private readonly DbSet<T> _entitySet;
public IQueryable<T> FindBy(Expression<Func<T, bool>> predicate)
        {
            //IQueryable<T> query=_entitySet.
        }
} 
```

在这种情况下如何实现 FindBy ！？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T10:54:51.000

这应该工作

```
public class Repository<T> : IRepository<T> where T : class, IAggregateRoot
    {

        private readonly DbSet<T> _entitySet;
        public IQueryable<T> FindBy(Expression<Func<T, bool>> predicate)
        {
            return _entitySet.Where(predicate).
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T11:59:09.933

My Repository 具有以下方法来通过给定表达式返回单个实体。

```
public T FindSingle(Expression<Func<T, bool>> predicate) {
  return _entitySet.FirstOrDefault(predicate);
} 
```

现在调用者可以使用任何表达式来获取单个实体，例如

```
var entity = _repository.FindSingle(entity=> entity.Id == 23); 
```

或者

```
var entity = _repository.FindSingle(entity=> entity.Name == "Hello World"); 
```

如果您的接口 IAggregateRoot 定义了一个属性 Id，您还可以向您的通用接口添加一个显式方法，以通过其 Id 获取单个实体。

```
public interface IAggregateRoot {
  int Id {get;}
}

public class GenericRepository {
  public T FindSingleById(int id) {
    return _entitySet.FirstOrDefault(entity=>entity.Id == id);
  }
} 
```

# javascript - 内联编辑但实例不存在

> ID：14865014
> 
> 赞同：0
> 
> 时间：2013-02-13T23:08:06.523
> 
> 标签：javascript, ajax, ckeditor

我有自己的自定义非 jQuery ajax，用于编写 Web 应用程序。我最近在使用 TinyMCE 时遇到了 IE9 的问题，所以我试图切换到 CKeditor

可编辑的文本被包裹在一个 div 中，如下所示：

```
<div id='content'>
  <div id='editable' contenteditable='true'>
    page of inline text filled with ajax when links throughout the site are clicked
  </div> 
</div> 
```

当我尝试使用文档中的示例获取可编辑内容的数据时，出现错误。

我这样做：

```
CKEDITOR.instances.editable.getData(); 
```

得到这个：

> 未捕获的类型错误：无法调用未定义的方法“getData”

所以我认为它不知道编辑器在 dom 中的位置......我已经尝试通过所有编辑器来获取编辑器名称，但这不起作用 - 似乎没有找到名称。

我试过这个：

```
for(var i in CKEDITOR.instances) { 
  alert(CKEDITOR.instances[i].name);
} 
```

警报只是空白 - 因此显然没有与之关联的名称。

我还应该提到，尽管我尽了最大努力，但我似乎无法像在[大规模内联编辑示例中那样让可编辑文本出现在其上方的菜单](http://nightly.ckeditor.com/13-02-13-08-51/standard/samples/inlineall.html)

感谢您提供的任何帮助。

杰森西尔弗

更新：

我在这里炫耀我缺乏知识，但我以前从未遇到过“contenteditable ='true'”，所以认为因为我能够内联输入，因此编辑器以某种方式被实例化......但现在我'我想知道编辑器是否甚至被应用于我的 div。

更新 2：

加载页面并最初调用脚本时，div 不存在。可编辑的 div 使用 AJAX 发送到 DOM。@Zee 在下面留下了一条评论，这让我想知道是否应该调用其他命令才能将编辑器应用于该 div，因此我在页面中创建了一个按钮，并使用以下 onclick 作为测试这种方法的一种方式： （改编自 ajax 示例）

```
var editor,html='';config = {};editor=CKEDITOR.appendTo('editable',config, html ); 
```

这会在 Chrome 中出现以下错误：

```
> Uncaught TypeError: Cannot call method 'equals' of undefined 
>  + CKEDITOR.tools.extend.getEditor ckeditor.js:101
>    b ckeditor.js:252
>    CKEDITOR.appendTo ckeditor.js:257
>    onclick www.pediatricjunction.com:410 
```

我是否朝着正确的方向前进？是否有另一种方式以编程方式告诉 CKEditor 将编辑器应用于 div？

更新 3：

感谢@Reinmar，我有一些新的尝试。我测试这是否是解决方案的最明显方法是在内容可编辑 div 上方放置一个按钮，分别调用 CKEDITOR.inlineAll() 和 inline('editable') ：

```
<input type='button' onclick=\"CKEDITOR.inlineAll();\" value='InlineAll'/>
<input type='button' onclick=\"CKEDITOR.inline('editable');\" value='Inline'/>
<input type='button' onclick=\"var editor = CKEDITOR.inline( document.getElementById( 'editable' ) );\" value='getElementById'/> 
```

这在 Chrome 中为所有三个按钮返回了相同类型的错误，即：

```
Uncaught TypeError: Cannot call method 'equals' of undefined ckeditor.js:101
+  CKEDITOR.tools.extend.getEditor ckeditor.js:101
   CKEDITOR.inline ckeditor.js:249
   CKEDITOR.inlineAll ckeditor.js:250
   onclick 
```

更新 4：

在进一步摆弄之后，我找到了与 json2007.js 相关的问题，这是我使用的一个脚本，可与 Real Simple History (RSH.js) 一起使用。这些脚本的目的是跟踪 ajax 历史记录，因此当我在浏览器中前进和后退时，AJAX 页面浏览量不会丢失。

这是小提琴页面：http: [//jsfiddle.net/jasonsilver/3CqPv/2/](http://jsfiddle.net/jasonsilver/3CqPv/2/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T16:30:05.523

当您要初始化内联编辑器时，有两种方法：

1.  如果加载页面时存在可编辑（具有`contenteditable`属性）的元素，CKEditor 将自动为其初始化一个实例。它的名称将取自该元素的 id 或者它将是`editor<number>`. [您可以在此示例](http://nightly.ckeditor.com/13-02-14-08-51/standard/samples/inlineall.html)中找到自动初始化的编辑器。

2.  如果这个元素是动态创建的，那么你需要自己初始化编辑器。例如，在附加`<div id="editor" contenteditable="true">X</div>`到文档后，您应该调用：

    `CKEDITOR.inline( 'editor' )`

    或者

    `CKEDITOR.inlineAll()`

    请参阅[文档](http://docs.ckeditor.com/#!/api/CKEDITOR-method-inline)和[文档](http://docs.ckeditor.com/#!/api/CKEDITOR-method-inlineAll)。[您可以在此示例](http://nightly.ckeditor.com/13-02-14-08-51/standard/samples/inlinebycode.html)中找到以这种方式初始化的编辑器。

该[`appendTo`](http://docs.ckeditor.com/#!/api/CKEDITOR-method-appendTo)方法有不同的用途。您可以在指定元素内初始化主题（非内联）编辑器。此方法还接受编辑器的数据（作为第三个参数），当所有其他方法（`CKEDITOR.inline`, `CKEDITOR.replace`, `CKEDITOR.inlineAll`）从它们正在替换/使用的元素中获取数据时。

**更新**

我检查了您与 CKEditor 一起使用的库是否写得不好并导致您提到的错误。删除`json2007.js`和`rsh.js`CKEditor 工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T13:52:33.500

好的，所以我已经找到了问题所在。

我用于跟踪 Ajax 历史记录和记住后退按钮命令的库（称为 Real Simple History）使用了一个名为 json2007 的脚本，该脚本具有侵入性，并将本机原型扩展至出现问题的地步。

RSH.js 有点老了，无论如何我都没有充分利用它，所以我的最终解决方案是重写我需要的基本代码，即监听器中的锚（哈希）变化URL，然后解析这些更改并重新提交 ajax 命令。

```
var current_hash = window.location.hash;
function check_hash() {
    if ( window.location.hash != current_hash ) {
        current_hash = window.location.hash;
        refreshAjax();
    }
}
hashCheck = setInterval( "check_hash()", 50 ); 
```

'refreshAjax()' 无论如何都是一个现有的函数，所以这实际上是一个比我在 Real Simple History 中使用的更优雅的解决方案。

去掉 json2007.js 脚本后，其他一切都正常了，CKEditor 很漂亮。

非常感谢您的帮助，@Reinmar ...我感谢您的耐心和努力。

# r - R从矩阵上的条件运算创建一个向量

> ID：14865023
> 
> 赞同：0
> 
> 时间：2013-02-13T23:09:02.420
> 
> 标签：r

我想通过将条件语句应用于每一列来从矩阵创建一个向量。条件语句是，如果列中的任何值超过固定阈值，那么向量中的值应该是该列的最后一行，如果没有，那么向量中的值应该是 0。最后，我最终应该得到一个与我的矩阵列数相同的向量。关于如何做到这一点的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:15:29.880

类似的东西？

```
mat <- matrix(rnorm(100),nrow=10,ncol=10)
apply(mat, 2, function(v) {
  ifelse (any(v > 0.7), v[length(v)],0)
}) 
```

# java - 为什么转发到不存在的jsp不会出现404错误？

> ID：14865029
> 
> 赞同：0
> 
> 时间：2013-02-13T23:09:34.167
> 
> 标签：java, jsp, servlets

如果请求调度程序指向不存在的 jsp，我想重定向到 404 页面。但是我不知道怎么做，因为我没有得到任何异常或空值。

示例：没有 blablabla.jsp

```
RequestDispatcher view = request.getRequestDispatcher("blablabla.jsp");
view.forward(request, response); 
```

网页.xml：

```
 <servlet>
            <servlet-name>MainServlet</servlet-name>
            <servlet-class>creator.controllers.MainController</servlet-class>
        </servlet>
    <servlet-mapping>
        <servlet-name>MainServlet</servlet-name>
        <url-pattern>/main</url-pattern>
    </servlet-mapping>

    <welcome-file-list>
        <welcome-file>login.jspx</welcome-file>
    </welcome-file-list>

    <error-page>
        <error-code>404</error-code>
        <location>/404.jsp</location>
    </error-page> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:24:35.730

因为你在转发：请求的端点*确实*存在；这是您尝试放入响应中的内容，而不是，这是不同的。

开发级错误的用户级错误的目的是什么？

您可以执行类似[此解决方案](https://stackoverflow.com/questions/6886441/dispatcher-doesnt-throw-an-exception)的操作并返回 404，但 IMO 正在解决应由集成（或功能）测试处理的开发级问题。

# facebook - 如何忽略 Qt5 QML QWebKit 3.0 中的 SSL 错误？

> ID：14865033
> 
> 赞同：1
> 
> 时间：2013-02-13T23:09:49.397
> 
> 标签：facebook, ssl, qml, qt5, qwebkit

我在显示**www.facebook.com**时遇到问题`Qt5 QML QWebKit 3.0`。

问题在于*SSL 证书*。有一个解决方案`Qt 4.*`，但我需要`Qt 5.0.1`在所有 API 都发生变化的地方实现它。

`Qt 4.*`可以在此处找到示例解决方案[链接](http://qt-project.org/forums/viewthread/8911)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:50:58.793

这是解决方案，如何在 Qt5 中忽略来自 QML 的 SSL 错误。它帮助我展示了 Facebook 页面。我将使用实验性 API。该解决方案适用于 Windows 7 64bit 中的 Qt 5.0.1 msvc2010 版本。

```
import QtWebKit 3.0
import QtWebKit.experimental 1.0

WebView {
    id: webView;
    url: "https://www.facebook.com";
    experimental.certificateVerificationDialog: Item {
        Component.onCompleted: {
            model.accept();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-03T22:43:41.287

我无法使用实验功能解决 Qt 5.1 和 MinGW4.8 的这个问题。

最后我安装了新的 Qt 5.2 版本，它有一个更具表现力的错误消息：

```
QSslSocket: cannot call unresolved function SSLv23_client_method
QSslSocket: cannot call unresolved function SSL_CTX_new
QSslSocket: cannot call unresolved function SSL_library_init
QSslSocket: cannot call unresolved function ERR_get_error
QSslSocket: cannot call unresolved function ERR_get_error 
```

因此，有了这些新信息，解决方案就是安装 Win32OpenSSL：[http ://slproweb.com/products/Win32OpenSSL.html](http://slproweb.com/products/Win32OpenSSL.html)

# java - 使用多词元素搜索 JComboBoxes

> ID：14865035
> 
> 赞同：1
> 
> 时间：2013-02-13T23:09:57.333
> 
> 标签：java, swing, jcombobox

例如，假设我有一个`JComboBox`元素 {"example 1", "example 2", "example 3"} （请注意 example 和相应数字之间的空格）。

当您在选择组合框时尝试通过键入来搜索“示例 2”时，它会关闭，因为空格键会切换组件的弹出窗口。

这可以分为两个问题：

1.  我已经做了一个摇摆事件，到目前为止它可以识别空格键，并且我已经禁用了`JComboBox`. 我该如何做到这一点，以便按下空格键实际上会使其在搜索中添加“”？
2.  如果 #1 不可能或未知，还有什么其他方法可以做到这一点？

任何能正确回答这个问题的人都肯定会得到支持。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:19:16.650

您可以使用：

```
KeyStroke space = KeyStroke.getKeyStroke("pressed SPACE");
InputMap im = comboBox.getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
im.getParent().remove(space); 
```

此解决方案的问题在于它删除了应用程序中所有组合框的弹出功能，这可能是也可能不是您想要的。

编辑：

如果这是针对单个组合框，则需要更多的工作。您需要调用**comboBox.selectWithKeyChar()**方法。使用自定义操作很容易做到这一点。不幸的是，这仍然不起作用，因为此代码最终调用了**DefaultKeySelectionManager**，这取决于 BasicComboBoxUI 类中包含的一些类变量。因此，我最终编写了自己的 ow KeySelectionManager，它将所有这些变量保持在本地。这就是我想出的：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.plaf.basic.*;
import javax.swing.text.*;

public class ComboBoxKeySelection extends JPanel
{
    JComboBox<String> comboBox;

    public ComboBoxKeySelection()
    {
        String[] data =
        {
            " 1", " 2",  " 3", " 4",
            "a", "ab", "abc", "abcd",
            "b1", "b2", "b3", "b4", "be",
            "c", "d", "e", "f"
        };

        comboBox = new JComboBox<String>( data );
        add( comboBox );

        Action search = new AbstractAction()
        {
            public void actionPerformed(ActionEvent e)
            {
                comboBox.selectWithKeyChar( " ".charAt(0) );
            }
        };

        KeyStroke space = KeyStroke.getKeyStroke("typed SPACE");
        comboBox.getActionMap().put("spacePopup", search);

        comboBox.setKeySelectionManager( new MyKeySelectionManager(comboBox) );
    }

    static class MyKeySelectionManager implements JComboBox.KeySelectionManager
    {
        private JComboBox comboBox;
        private JList listBox;
        private boolean useComboBoxModel;

        private long timeFactor;
        private long lastTime;
        private long time;

        private String prefix = "";
        private String typedString = "";

        public MyKeySelectionManager(JComboBox comboBox)
        {
            this.comboBox = comboBox;

            Long l = (Long)UIManager.get("ComboBox.timeFactor");
            timeFactor = l == null ? 1000L : l.longValue();

            Object child = comboBox.getAccessibleContext().getAccessibleChild(0);

            if (child instanceof BasicComboPopup)
            {
                BasicComboPopup popup = (BasicComboPopup)child;
                listBox = popup.getList();
                useComboBoxModel = false;
            }
            else
            {
                listBox = new JList();
                useComboBoxModel = true;
            }
        }

        public int selectionForKey(char aKey, ComboBoxModel aModel)
        {
            if (useComboBoxModel)
            {
                listBox.setModel( aModel );
            }

            time = System.currentTimeMillis();
            boolean startingFromSelection = true;
            int startIndex = comboBox.getSelectedIndex();

            if (time - lastTime < timeFactor)
            {
                typedString += aKey;

                if((prefix.length() == 1) && (aKey == prefix.charAt(0)))
                {
                    // Subsequent same key presses move the keyboard focus to the next
                    // object that starts with the same letter.
                    startIndex++;
                }
                else
                {
                    prefix = typedString;
                }
            }
            else
            {
                startIndex++;
                typedString = "" + aKey;
                prefix = typedString;
            }

            lastTime = time;

            if (startIndex < 0 || startIndex >= aModel.getSize())
            {
                startingFromSelection = false;
                startIndex = 0;
            }

            int index = listBox.getNextMatch(prefix, startIndex, Position.Bias.Forward);

            if (index < 0 && startingFromSelection)
            {
                // wrap
                index = listBox.getNextMatch(prefix, 0, Position.Bias.Forward);
            }

            return index;
        }
    }

    private static void createAndShowUI()
    {
        JFrame frame = new JFrame("ComboBoxKeySelection");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add( new ComboBoxKeySelection() );
        frame.pack();
        frame.setLocationRelativeTo( null );
        frame.setVisible( true );
    }

    public static void main(String[] args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                createAndShowUI();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:23:23.153

您可以捕获 keypressed 事件并简单地将“”附加到所需的字符串。

# .net - 在实体框架 5 中将代码生成从无更改为默认后出现错误

> ID：14865038
> 
> 赞同：5
> 
> 时间：2013-02-13T23:10:16.020
> 
> 标签：.net, visual-studio, entity-framework, entity-framework-5

我有一个 wpf 项目 4.5，我正在使用 EF 5 生成模型类。我想为生成的 EF 类实现 iNotifyPropertyChanged。所以我右键单击我的设计器（visual studio 2012）并将代码生成设置从“无”更改为“默认”

一旦我这样做了，我就会遇到数百个错误，如下所示：

> 错误 67 '公共属性*"TableColumnName"*因为*"ColumnType"*有多个具有相同签名的定义。

[编辑 1]

这些错误都在 DataModel.Designer.Vb 文件中引发。它们出现在与另一个表中的列/导航属性同名的任何表列属性或导航属性上。我很难相信我不能在不同的表中拥有相同名称的列，这里肯定发生了其他事情。

[编辑 2]

所以我从设计器中删除了我所有的数据库对象，然后将代码生成策略更改为默认策略，然后在图表中添加了一个表（客户端）。对于表的每个属性，我都会遇到很多错误（所以这一定不是因为其他表具有与我之前认为的相同的列名）。我在每个属性（表列）上都收到上面列出的错误，以及每个属性的以下错误：

> 错误变量“_ColumnName”与为“client”类中的属性“ColumnName”隐式声明的成员冲突。C:...\FTC_DAL.Designer.vb

当我将代码生成恢复为无时，这种情况就消失了。我开始认为这是 EF 5 中的一个错误。

[编辑 3]

重现步骤：

1.  在 Visual Studio 2012、wpf 应用程序中创建新项目。
    它可以是vb或c，我都测试过
2.  添加 ADO.NET 实体数据模型（edmx 文件）
3.  从 sql server 添加表（我使用的是 express 2008 R2）
4.  构建项目，然后在空白处单击 edmx 设计器。在属性窗口中，将**代码生成策略**更改为*default*而不是*none*。
5.  构建项目，将出现错误。

我在用：

*   视觉工作室 2012 专业版 v.11.0.51106.01 更新 1
*   .NET 4.5.50709
*   视窗 8 专业版

我将安装 sql server 2012 express 看看这是否有什么不同

有人可以帮我弄清楚为什么会发生这些错误。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-09-20T21:02:03.233

请参考以下链接。我花了很多时间对这个问题感到沮丧，并从显示在“添加域服务类”屏幕上的链接中找到了这篇支持文章，就在“一些......可能丢失”之后......

观察总结是 WCF RIA 不支持 DBContext（由 .tt 文件指示）。要使用域服务类，需要 ObjectContext 类。这是[支持文章](http://support.microsoft.com/kb/2745294)中的解决方案。

> 为了将实体框架模型与 WCF RIA 服务一起使用，您必须将其转换为基于“ObjectContext”的模型。这可以使用以下步骤来完成：
> 
> 1.  在设计器中打开您的实体模型
> 2.  （如果需要，点击设计器的“空白”，确保模型内没有对象被选中）
> 3.  在“属性”窗口中，将“代码生成策略”从“无”更改为“默认”
> 4.  删除与模型相邻的两个“.tt”文件，假设您在创建实体模型时没有将这些文件修改为超出其原始状态。如果您修改了这些文件，则对实体模型的自定义将丢失。
> 5.  重建项目
> 
> 完成这些步骤后，您将能够在“可用上下文类”列表中选择实体模型的上下文类。此过程的副作用是您现在已将实体模型从基于实体框架 DbContext 的模型转换为基于 ObjectContext 的模型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-14T18:00:04.043

将代码生成策略设置为“无”是正确的，您应该这样保留它。

当您将其更改为“默认”时，您将获得模型中所有实体的类。但是，您已经从`.tt`模板中获得了这些相同的类。结果，您将获得所有班级成员两次。

为了改变类的生成方式，*仍然*将代码生成策略保留为“无”，因为默认代码生成无论如何都不能自定义。该`Model.tt`文件可以自由修改以满足您的需要，并且不应该花费太多精力来修改它以使您的类实现您想要的任何接口。

# asp.net-mvc-4 - 访问 ViewModel 中的数据

> ID：14865042
> 
> 赞同：0
> 
> 时间：2013-02-13T23:10:33.073
> 
> 标签：asp.net-mvc-4, telerik-grid, entity-framework-4.3

我有以下实体框架代码片段，它有一个“Groups”表和一个包含我需要的 ApplicationID 字段的子“ApplicationsGroupsLK”表。

```
IEnumerable<Groups> Groups = DbContext.Groups.Include("ApplicationsGroupsLK").Where(p => p.GroupNumber > 0); 
```

子数据显然在集合中返回。

我基本上需要显示父数据以及子 ApplicationID 字段（许多应用程序到 1 个组）。

## 在我的 MVC 视图中，我的 ViewModel 应该是什么样的，它将包含我需要的返回的父数据和子数据，以便我可以正确地将其绑定到网格？

第二个帖子：

此外，以下模型是从实体框架生成的：

```
public partial class Project
    {
        public Project()
        {
            this.TimeTrackings = new HashSet<TimeTracking>();
        }

     [DataMember]
        public short ProjectID { get; set; }
     [DataMember]
        public short CustomerID { get; set; }
     [DataMember]
        public string Name { get; set; }
     [DataMember]
        public string Description { get; set; }
     [DataMember]
        public short CategoryID { get; set; }
     [DataMember]
        public short PriorityID { get; set; }
     [DataMember]
        public short StatusID { get; set; }
     [DataMember]
        public Nullable<decimal> Quote { get; set; }
     [DataMember]
        public string Notes { get; set; }
     [DataMember]
        public System.DateTime CreatedDate { get; set; }
     [DataMember]
        public Nullable<System.DateTime> UpdatedDate { get; set; }

     [DataMember]
        public virtual Category Category { get; set; }
     [DataMember]
        public virtual Customer Customer { get; set; }
     [DataMember]
        public virtual Priority Priority { get; set; }
     [DataMember]
        public virtual Status Status { get; set; }
     [DataMember]
        public virtual ICollection<TimeTracking> TimeTrackings { get; set; }
    } 
```

可以看到 TimeTrackings 是 Project 的子表。您还可以看到 CategoryID、CustomerID、PriorityID 和 StatusID 是父表具有的外键。在这种情况下，我只对 CategoryID FK 感兴趣。

## 我还没有这样做（不是在我家里的机器上），但是当我将数据输入这个模型时，**公共虚拟类别类别字段中实际包含什么**？由于不是集合，查询执行后该字段返回什么数据。

第三篇文章： Telerik asp.net 用于 DB 调用的 mvc 语法：

```
IEnumerable<Groups> GroupList = db.GetGroups();

            return View(new GridModel<Groups>
            {
                Data = GroupList
            }); 
```

* * *

第四篇文章：Trey，下面是我为我的目的修改的代码，希望你能在我实现它之前检查它。我想我理解它并且看起来很棒......

```
public partial class Project
    {
        public Project()
        {
            this.TimeTrackings = new HashSet<TimeTracking>();
        }

     [DataMember]
        public short ProjectID { get; set; }
     [DataMember]
        public short CustomerID { get; set; }
     [DataMember]
        public string Name { get; set; }
     [DataMember]
        public string Description { get; set; }
     [DataMember]
        public short CategoryID { get; set; }
     [DataMember]
        public short PriorityID { get; set; }
     [DataMember]
        public short StatusID { get; set; }
     [DataMember]
        public Nullable<decimal> Quote { get; set; }
     [DataMember]
        public string Notes { get; set; }
     [DataMember]
        public System.DateTime CreatedDate { get; set; }
     [DataMember]
        public Nullable<System.DateTime> UpdatedDate { get; set; }
     [DataMember]
        public short ApplicationID { get; set; }
     [DataMember]
        public string ApplicationName { get; set; }
     [DataMember]
        public virtual Category Category { get; set; }
     [DataMember]
        public virtual Customer Customer { get; set; }
     [DataMember]
        public virtual Priority Priority { get; set; }
     [DataMember]
        public virtual Status Status { get; set; }
     [DataMember]
        public virtual ICollection<TimeTracking> TimeTrackings { get; set; }

     public ProjectModel(Project project)
     {
        ProjectID = project.ProjectID;
        CustomerID = project.CustomerID;
        Name = project.Name;
        Description = project.Description;
    CategoryID = project.CategoryID;
        PriorityID = project.PriorityID;
        StatusID = project.StatusID;
        Quote = project.Quote;
        Notes = project.Notes;
        CreatedDate = project.CreatedDate;
        UpdatedDate = project.UpdatedDate;
        ApplicationID = project.ApplicationsGroupsLK.ApplicationID;
        ApplicationName = project.ApplicationsGroupsLK.ApplicationName;
     }

     // Neat Linq trick to convert database query results directly to Model
     public static IList<ProjectModel> FlattenToThis(IList<Project> projects)
     {
        return projects.Select(project => new ProjectModel(project)).ToList();
     }

    } 
```

* * *

第五帖：

```
using (wmswebEntities DbContext = new wmswebEntities())
                {
                    DbContext.Configuration.ProxyCreationEnabled = false;
                    DbContext.Database.Connection.Open();

                    IEnumerable<Projects> projects = DbContext.Projects.Where(p => p.GroupNumber > 0);

                    IList<ProjectModel> results = Project.FlattenToThis(projects);

                    return results 
```

## }

第六篇命名空间CMSEFModel { using System; 使用 System.Collections.Generic；

```
public partial class GroupModel
{
    public GroupModel()
    {
        this.ApplicationsGroupsLKs = new HashSet<ApplicationsGroupsLK>();
        this.GroupApplicationConfigurationsLKs = new HashSet<GroupApplicationConfigurationsLK>();
        this.UsersGroupsLKs = new HashSet<UsersGroupsLK>();
    }

    public int GroupNumber { get; set; }
    public string GroupName { get; set; }
    public int GroupRank { get; set; }
    public bool ActiveFlag { get; set; }
    public System.DateTime DateAdded { get; set; }
    public string AddedBy { get; set; }
    public System.DateTime LastUpdated { get; set; }
    public string LastUpdatedBy { get; set; }
    // Application - Lazy Loading population
    public int ApplicationID { get; set; }
    // UsersGroupsLK - Lazy Loading population
    public int UserNumber { get; set; }
    public string UserID { get; set; }

    public virtual ICollection<ApplicationsGroupsLK> ApplicationsGroupsLKs { get; set; }
    public virtual ICollection<GroupApplicationConfigurationsLK> GroupApplicationConfigurationsLKs { get; set; }
    public virtual ICollection<UsersGroupsLK> UsersGroupsLKs { get; set; }

    public GroupModel()
    {}
    public GroupModel(GroupModel group)
     {
        GroupNumber = group.GroupNumber;
        GroupName = group.GroupName;
        ActiveFlag = group.ActiveFlag;
        DateAdded = group.DateAdded;
        AddedBy = group.AddedBy;
        LastUpdated = group.LastUpdated;
        LastUpdatedBy = group.LastUpdatedBy;
        UserNumber = group.UsersGroupsLKs.
     }

 // Neat Linq trick to convert database query results directly to Model
 public static IList<GroupModel> FlattenToThis(IList<GroupModel> groups)
 {
    return groups.Select(group => new GroupModel(group)).ToList();
 }
} 
```

## }

第七篇文章 - 这是我在之前发布的错误中遇到问题的模型。Trey，如果你能帮忙，我真的很感激......我“死在水里”，除非我能让这部分工作。

```
namespace CMSEFModel
{
    using System;
    using System.Collections.Generic;

    public partial class Group
    {
        public Group()
        {
            this.ApplicationsGroupsLKs = new HashSet<ApplicationsGroupsLK>();
            this.GroupApplicationConfigurationsLKs = new HashSet<GroupApplicationConfigurationsLK>();
            this.UsersGroupsLKs = new HashSet<UsersGroupsLK>();
        }

        public int GroupNumber { get; set; }
        public string GroupName { get; set; }
        public int GroupRank { get; set; }
        public bool ActiveFlag { get; set; }
        public System.DateTime DateAdded { get; set; }
        public string AddedBy { get; set; }
        public System.DateTime LastUpdated { get; set; }
        public string LastUpdatedBy { get; set; }
        // Application - Lazy Loading population
        public int ApplicationID { get; set; }
        // UsersGroupsLK - Lazy Loading population
        public int UserNumber { get; set; }
        public string UserID { get; set; }

        public virtual ICollection<ApplicationsGroupsLK> ApplicationsGroupsLKs { get; set; }
        public virtual ICollection<GroupApplicationConfigurationsLK> GroupApplicationConfigurationsLKs { get; set; }
        public virtual ICollection<UsersGroupsLK> UsersGroupsLKs { get; set; }

        public GroupModel(Group group)
         {
            GroupNumber = group.GroupNumber;
            GroupName = group.GroupName;
            ActiveFlag = group.ActiveFlag;
            DateAdded = group.DateAdded;
            AddedBy = group.AddedBy;
            LastUpdated = group.LastUpdated;
            LastUpdatedBy = group.LastUpdatedBy;
            UserNumber = group.UsersGroupsLKs.
         }

     // Neat Linq trick to convert database query results directly to Model
     public static IList<GroupModel> FlattenToThis(IList<Group> groups)
     {
        return groups.Select(group => new GroupModel(group)).ToList();
     }
    } 
```

## }

八贴：

```
using (wmswebEntities DbContext = new wmswebEntities())
                {
                    DbContext.Configuration.ProxyCreationEnabled = false;
            DbContext.Configuration.LazyLoadingEnabled = true;
                    DbContext.Database.Connection.Open();

                    List<Groups> myGroups = new List<Groups>();

                     var myGroups = from p in DbContext.Groups
                                where p.ActiveFlag = true
                                select new
                                {
                                    p.Groups.ApplicationName,
                                    p.Groups.GroupName,
                                    p.Groups.GroupRank,
                                    p.Groups.ActiveFlag,
                                    p.Groups.DateAdded,
                                    p.Groups.AddedBy,
                                    p.Groups.LastUpdated,
                                    p.Groups.LastUpdatedBy,
                                    p.Groups.ApplicationsGroupsLK.ApplicationID,
                                    p.Groups.UsersGroupsLK.UserNumber
                                };

                    return myGroups;
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T01:58:16.257

这需要稍微调整一下思路。Grid 只接受平面模型。这类问题经常被问到，这里是一个入门答案：[Kendo UI Grid - How to Bind to Child Properties](https://stackoverflow.com/questions/14756973/kendo-ui-grid-how-to-bind-to-child-properties/14774189#14774189)

如果这没有帮助，请在此处发布更多代码，我可以与您一起完成它。

# ios - PushWoosh 集成错误

> ID：14865044
> 
> 赞同：1
> 
> 时间：2013-02-13T23:10:41.667
> 
> 标签：ios, objective-c, apple-push-notifications, pushwoosh

我一直在尝试将 PushWoosh 集成到我的项目中，实际上我确实成功集成了它并在 appStore 上发布了应用程序。现在我计划发布非常相似但内容不同的应用程序。我最近也做了同样的事情，而且 PW 对每个新的重复目标都工作得很好。但最近重复的目标引起了问题。在应用程序启动时发出此错误警报：

```
Title: PushWoosh Error
Description: Your provisioning profile does not have any APS entry. Please make your profile push compatible. 
```

我通过 Pushwoosh 的自动功能使配置文件 Push 兼容，并下载然后修改配置文件并将它们用于存档。如果你们能指出我需要查看的任何内容，我将不胜感激。

[更新]

值得一提的是，我在制作副本时切换了计算机。所以，一开始所有的构建都给出了错误，然后在沮丧之后，我为这台新计算机生成了全新的分发证书。现在，有了新的证书和东西，我准备好了我的第一个目标 pushWoosh，但随后在第二个目标上给出了与上述相同的错误，令人惊讶的是，第三个目标与 PW 配合得很好。现在我正在修复导致此类随机错误的问题所在。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T12:01:00.723

您的移动配置文件中有“aps-environment”字符串吗？如果不需要，则必须在 Apple Development Portal 中重新创建它，然后确保新配置文件中有这样的字符串，并且它的值与您在 PW 中使用的网关匹配，即 Sandbox 的“开发”和生产的“生产”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-25T16:20:02.233

我刚刚想出了一个不同的解决方案来解决这个问题，希望对您有所帮助：

我的问题是我在 Xcode 中的应用程序名称与我在 Apple Developer Portal 上手动创建的应用程序 ID 不同。我在 Xcode 中打开了“自动管理签名”，因此 Xcode 在 Apple Developer Portal 中自动创建了一个名为 XC com paye 的 App ID ...

我遵循从头开始创建证书的过程，将它们添加到 Xcode 创建的应用程序 ID 中，瞧！有用。

希望这可以帮助！:-)

# asp.net-mvc - MVC Web API 错误，“ObjectContent`1”类型无法序列化响应正文，构造函数的参数数量不正确

> ID：14865049
> 
> 赞同：2
> 
> 时间：2013-02-13T23:10:56.690
> 
> 标签：asp.net-mvc, asp.net-web-api, json.net

完整的错误是：

```
{
Message: "An error has occurred.",
ExceptionMessage: "The 'ObjectContent`1' type failed to serialize the response body for content type 'application/json; charset=utf-8'.",
ExceptionType: "System.InvalidOperationException",
StackTrace: null,
InnerException: {
Message: "An error has occurred.",
ExceptionMessage: "Incorrect number of arguments for constructor",
ExceptionType: "System.ArgumentException",
StackTrace: " at System.Linq.Expressions.Expression.ValidateArgumentCount(MethodBase method, ExpressionType nodeKind, Int32 count, ParameterInfo[] pis) at System.Linq.Expressions.Expression.ValidateArgumentTypes(MethodBase method, ExpressionType nodeKind, ReadOnlyCollection`1& arguments) at System.Linq.Expressions.Expression.New(ConstructorInfo constructor, IEnumerable`1 arguments) at System.Data.Objects.ELinq.InitializerMetadata.ProjectionNewMetadata.Emit(Translator translator, List`1 propertyTranslatorResults) at System.Data.Common.Internal.Materialization.Translator.HandleLinqRecord(RecordColumnMap columnMap, InitializerMetadata initializerMetadata) at System.Data.Common.Internal.Materialization.Translator.Visit(RecordColumnMap columnMap, TranslatorArg arg) at System.Data.Query.InternalTrees.RecordColumnMap.Accept[TResultType,TArgType](ColumnMapVisitorWithResults`2 visitor, TArgType arg) at System.Data.Common.Internal.Materialization.Translator.ProcessCollectionColumnMap(CollectionColumnMap columnMap, TranslatorArg arg, ColumnMap discriminatorColumnMap, Object discriminatorValue) at System.Data.Common.Internal.Materialization.Translator.Visit(SimpleCollectionColumnMap columnMap, TranslatorArg arg) at System.Data.Query.InternalTrees.SimpleCollectionColumnMap.Accept[TResultType,TArgType](ColumnMapVisitorWithResults`2 visitor, TArgType arg) at System.Data.Common.Internal.Materialization.Translator.TranslateColumnMap[TRequestedType](QueryCacheManager queryCacheManager, ColumnMap columnMap, MetadataWorkspace workspace, SpanIndex spanIndex, MergeOption mergeOption, Boolean valueLayer) at System.Data.Common.Internal.Materialization.ShaperFactory.TypedShaperFactoryCreator`1.TypedCreate(QueryCacheManager cacheManager, ColumnMap columnMap, MetadataWorkspace metadata, SpanIndex spanInfo, MergeOption mergeOption, Boolean valueLayer) at System.Data.Common.Internal.Materialization.ShaperFactory.Create(Type elementType, QueryCacheManager cacheManager, ColumnMap columnMap, MetadataWorkspace metadata, SpanIndex spanInfo, MergeOption mergeOption, Boolean valueLayer) at System.Data.Objects.Internal.ObjectQueryExecutionPlan.Prepare(ObjectContext context, DbQueryCommandTree tree, Type elementType, MergeOption mergeOption, Span span, ReadOnlyCollection`1 compiledQueryParameters, AliasGenerator aliasGenerator) at System.Data.Objects.ELinq.ELinqQueryState.GetExecutionPlan(Nullable`1 forMergeOption) at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption) at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator() at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext() at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection) at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source) at Newtonsoft.Json.Serialization.JsonArrayContract.CreateWrapper(Object list) in c:\Dev\Releases\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\JsonArrayContract.cs:line 108 at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty) in c:\Dev\Releases\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\JsonSerializerInternalWriter.cs:line 128 at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty) in c:\Dev\Releases\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\JsonSerializerInternalWriter.cs:line 342 at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty) in c:\Dev\Releases\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\JsonSerializerInternalWriter.cs:line 123 at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value) in c:\Dev\Releases\Working\Newtonsoft.Json\Src\Newtonsoft.Json\Serialization\JsonSerializerInternalWriter.cs:line 58 at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value) in c:\Dev\Releases\Working\Newtonsoft.Json\Src\Newtonsoft.Json\JsonSerializer.cs:line 608 at System.Net.Http.Formatting.JsonMediaTypeFormatter.<>c__DisplayClassd.<WriteToStreamAsync>b__c() at System.Threading.Tasks.TaskHelpers.RunSynchronously(Action action, CancellationToken token)"
}
} 
```

这似乎与我的计算机隔离，因为我们的服务器和其他同事可以正常运行相同的代码。

我唯一的线索是我刚刚将 Visual Studio 2012 Express 与我正在运行的 VS 2010 并排安装。尽管它们都出现了相同的错误。

更令人困惑的是，json.net库是在本地引用的，并没有改变。

只有一个 web api 控制器抛出错误（联系人是一个 IQueryable，在此之前已经以多种方式过滤，但在调试器中工作直到渲染）：

```
var r =
    contacts
    .Skip(offset).Take(count)
    .Join(
        crm.ContactViews,
        c => c.Id,
        cv => cv.Id,
        (c, cv) => new { 
            contact = c, 
            view = cv, 
            userInfo = c.ContactUsers.Select(u => new {
                name = u.User.UserName,
                id = u.UserId
            }).FirstOrDefault(),
            lastCalled = crm.CallLogs
                .Where(x => x.ContactId == c.Id)
                .OrderByDescending(x => x.CallEnd)
                .Select(log => new { date = log.CallStart, username = crm.Users.FirstOrDefault(x => x.UserId == log.Caller).UserName })
                .FirstOrDefault()
        }
    )               
    .AsEnumerable()
    .Select(c => new
    {
        id = c.contact.Id,
        firstName = c.contact.FirstName,
        lastName = c.contact.LastName,
        dateCreated = formatDate(c.contact.DateCreated),
        score = c.contact.Score,

        companyName = c.view.Company,
        phone = c.view.Phone,
        email = c.view.Email,
        street = c.view.Street,
        street2 = c.view.Street2,
        city = c.view.City,
        state = c.view.State,
        zip = c.view.Zip,

        assignedUserName = c.userInfo != null ? c.userInfo.name : null,
        assignedUserId = c.userInfo != null ? c.userInfo.id : (Guid?)null,

        dateLastCalled = c.lastCalled != null ? formatDate(c.lastCalled.date) : null,
        lastCalledBy = c.lastCalled != null ? c.lastCalled.username : null
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:50:31.317

通过正常的消除过程，我将问题缩小到使用匿名对象的连接语句：

```
var r =
contacts
.Skip(offset).Take(count)
.Join(
    crm.ContactViews,
    c => c.Id,
    cv => cv.Id,
    (c, cv) => new ContactJoin(){ 
        contact = c, 
        view = cv, 
        test = c.Score // <-- this line
    }
)               
.AsEnumerable()
.Select(c => new
{
    id = c.contact.Id,
    firstName = c.contact.FirstName,
    lastName = c.contact.LastName,
    score = c.test,
}); 
```

删除该`test = c.Score`行将修复错误。更多测试显示匿名对象抛出了“构造函数的参数数量不正确”错误，因此解决方法是使连接强类型化：

```
.Join(
    crm.ContactViews,
    c => c.Id,
    cv => cv.Id,
    (c, cv) => new ContactJoin(){ 
        contact = c, 
        view = cv, 
        userInfo = c.ContactUsers.Select(u => new UserInfo(){
            name = u.User.UserName,
            id = u.UserId
        }).FirstOrDefault(),
        lastCalled = crm.CallLogs
            .Where(x => x.ContactId == c.Id)
            .OrderByDescending(x => x.CallEnd)
            .Select(log => new LastCall(){ 
                date = log.CallStart, 
                username = crm.Users.FirstOrDefault(x => x.UserId == log.Caller).UserName 
            })
            .FirstOrDefault()
    }
) 
```

为了可维护性，我仍然想找到问题的根源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-09T21:09:50.900

升级到 .NET 4.5 后，我发现由于匿名对象中属性的顺序，这样的投影失败了。

```
(t1, t2) => new { Thing1 = t1, Thing2 = t2, Thing1Prop1 = t1.Prop1, Thing2Prop1 = t2.Prop1 }; 
```

切换顺序为

```
(t1, t2) => new { Thing1Prop1 = t1.Prop1, Thing2Prop1 = t2.Prop1, Thing1 = t1, Thing2 = t2 }; 
```

为我解决了这个问题，但我还没有尝试过其他场景。这似乎是一个突破性的、令人讨厌的变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-24T12:30:20.240

我发现了以下内容：

我必须添加`this.Configuration.ProxyCreationEnabled = false`到基于 DbContext 的类。

实际上，这会禁用对 EF 6.x 的巨大优化。

否则，此代码将*不会*运行并返回与您相同的错误。

（基于 ApiController 的类）

```
public IHttpActionResult Surveys(int filterscount, int groupscount, 
       int pagenum, int pagesize, int recordstartindex, int recordendindex)
{
    var data = _dbContext.Surveys.OrderByDescending(o => o.ID)
                                 .Skip(pagenum * pagesize)
                                 .Take(pagesize)
                                 .ToList();         
    return Ok(data);
} 
```

# c# - WinRT - 值不在预期范围内

> ID：14865054
> 
> 赞同：3
> 
> 时间：2013-02-13T23:11:33.037
> 
> 标签：c#, windows-runtime, windows-store-apps, winrt-xaml

我必须在 C# 中制作 MetroApp 前端。

我有一个 OverviewPage，其中有一个`GridView`详细信息页面的预览。我更详细地描述了它，并在以下线程中使用屏幕截图： [WinRT XamlControl Preview Image](https://stackoverflow.com/questions/14822211/winrt-xamlcontrol-preview-image)

我从外部库获得了在 DetailPage 中显示的内容面板。

因为我想在我的 OverviewItems 中预览 DetailPage，所以我必须`Panel`在我的`GridView Items`.

当我单击`Item`它时，它会将我导航到 DetailPage，当我尝试将面板添加到我的 DetailPage 时出现以下错误：值不在预期范围内。

我认为这是因为我的 VisualTree 中已经有了一个同名的面板？！这个假设正确吗？面板包含一个带有一些 xaml 元素和 onclick-Event-triggers 的 Canvas 顺便说一句。

我能做些什么来修复这个错误？我不知道如何继续..：/

如果您需要更多信息 - 请询问。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T23:22:12.150

您不能在应用程序的多个位置使用相同的元素实例，因此如果实例已经在可视化树中的某个位置 - 您也不能将其添加到其他位置。我不认为重复的名称是一个问题，除非它们在相同的名称范围内，如果它们是你可能会在构建时失败。

# python - 如何使用 OOP 在 Tkinter 中将小部件放置到不同的框架中

> ID：14865055
> 
> 赞同：2
> 
> 时间：2013-02-13T23:11:38.777
> 
> 标签：python, python-2.7, tkinter

**背景**

大家好！我目前正在开发一个可以加载和保存文本文件的基本 GUI 文本编辑器。正如我在这里学到的那样，我想为工具栏和文本框使用多个框架[。](https://stackoverflow.com/questions/14846063/what-is-a-better-tkinter-geometry-manager-than-grid)我正在使用 OOP，并在方法中设置了我的框架`__init__`，并在方法中设置了小部件`widget`。由于某种原因，小部件无法放置在它们各自的框架中。

**代码**

```
from Tkinter import *
class Application:
    def __init__(self,parent):  #initialize the grid and widgets
        self.myParent = parent

        #Init the toolbar
        self.toolbar = Frame(parent)
        self.toolbar.grid(row = 0)

        #Init frame for the text box

        self.mainframe = Frame(parent)
        self.toolbar.grid(row = 1)
    def widget(self):#Place widgets here

        #Save Button
        self.saveButton = Button (self, self.toolbar,
                                  text = "Save", command = self.saveMe)
        self.saveButton.grid(column = 0, row = 0, sticky = W)

        #Open Button
        self.openButton = Button (self, self.toolbar,
                                 text = "Open", command = self.openMe)
        self.openButton.grid(column = 0, row = 1, sticky = W)
        #Area where you write 
        self.text = Text (self, self.mainframe,
                          width = (root.winfo_screenwidth() - 20),
                          height = (root.winfo_screenheight() - 10))
       self.text.grid(row = 2) 
```

**问题**

1.  仍然使用不同的方法，我怎样才能确保每个小部件都放置在正确的框架中？

    *   如果这是不可能的，请告诉我如何使用 OOP 来做到这一点——我对 Tkinter 在那种环境下最满意，并承诺自己会改进。
2.  请*解释*你的答案。我*需要*同源——而不是简单地对着电脑点头并继续前进。

3.  额外的信用：我将如何在 OOP 中使用 Tkinter 初始化多个窗口（每个窗口是不同的类）？例如，如果这是我的代码：

    ```
    class MainWindow(Frame):
        ---init stuff---
        def widget(self):
            newWindow = Button(self, text = "click for a new window",
                               command = self.window)
            newWindow.grid()
       def window(self):
             #What would I put in here to initialize the new window??

    class theNextWindow(Frame): 
    ```

    我会在`window.self`方法中放入什么使`theNextWindow`窗口可见？

感谢大家的帮助！

**编辑 1**

`self.widget()`我在方法中添加了这一行`__init__`，我得到了这个“精彩”错误的奖励：

```
Traceback (most recent call last):
File "D:\Python Programs\Text Editor\MyTextv2.py", line 67, in <module>
 app = Application(root)
File "D:\Python Programs\Text Editor\MyTextv2.py", line 14, in __init__
 self.widget()
File "D:\Python Programs\Text Editor\MyTextv2.py", line 24, in widget
 text = "Save", command = self.saveMe)
File "C:\Python27\lib\lib-tk\Tkinter.py", line 2044, in __init__
 Widget.__init__(self, master, 'button', cnf, kw)
File "C:\Python27\lib\lib-tk\Tkinter.py", line 1965, in __init__
 BaseWidget._setup(self, master, cnf)
File "C:\Python27\lib\lib-tk\Tkinter.py", line 1943, in _setup
 self.tk = master.tk
AttributeError: Application instance has no attribute 'tk' 
```

由于错误日志在这里清楚地引用了我的主循环：`File "D:\Python Programs\Text Editor\MyTextv2.py", line 67, in <module> app = Application(root)`我决定添加它：

```
root = Tk()
root.title("My Text Editor")

#This is wierd - it gets the computer windows dimensions
w, h = root.winfo_screenwidth(), root.winfo_screenheight()
root.overrideredirect(0)

#And then applies them here
root.geometry("%dx%d+0+0" % (w, h))

app = Application(root)

root.mainloop() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:24:18.683

我*终于*找到了答案。根据我的发现（如果错误，请随时编辑）`Frame`在 Tkinter 中只有两种方法可以继承 a：从类本身和从小部件当前所在的方法。解决问题，我将类设置`Application`为框架，然后在其中放置其他框架。这是我所做的基本演绎：

```
#Import Tkinter
from Tkinter import *

#Main Frame
class Application(Frame):
    def __init__(self, master):  #initialize the grid and widgets
        Frame.__init__(self,master)
        self.grid()
        self.redFUN() #initialize the red frame's Function
        self.greenFUN() #initialize the green frame's Function
        self.widgets() #To show that you can still place non-Frame widgets 
    def widgets(self):
        self.mylabel = Label (self, text = "Hello World!")
        self.mylabel.grid()
    def redFUN(self): #The 'self' means that it is an instance of the main frame
        #Init the red frame
        self.redFrame = Frame(root, width = 100, height = 50,pady = 5,
                              bg = "red")
        self.redFrame.grid()

    def greenFUN(self): #Child of the mainframe
        self.greenFrame = Frame(root, width = 100, height = 50,pady = 5,
                          bg = "green") #it is green!
        self.greenFrame.grid()

#These lines of code are used for the grid
root = Tk()
root.title("Frame Example")
root.geometry("300x300")
app = Application(root)

root.mainloop() 
```

我希望这对每个人都有帮助-如果您有任何疑问，请随时发表评论！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T01:24:03.067

问题1：

一个小部件只能有一个直接父级。传递两个父母没有语法。例如，您似乎`self`同时`self.toolbar`作为`self.saveButton`.

```
myButton = Button(self.toolbar, text="Blah", command=self.someCommand) 
```

是您应该使用的表格。

问题2：

假设您希望`Application`(AKA the `self`in `Button(self, self.toolbar...)`) 成为`myButton`. 这也不起作用，因为要成为 Tk 小部件的分层父级，类也必须是`Widget`. 通常，如果您希望这样做是继承`tk.Tk()`如下`Application`：

```
class Application(Tk):

    def __init__(self, *args, **kwargs):

        Tk.__init__(self, *args, **kwargs) #It's important that you call the parent class's __init__ method first

        self.createWidgets()

    def createWidgets(self):

        self.myButton = Button(self, text="Blah", command=lambda x: print "x")
        #this is ok, because now self (AKA Application) is a valid instance of Tk 
```

# php - 在 HTML/PHP 中启用表单缓存

> ID：14865058
> 
> 赞同：1
> 
> 时间：2013-02-13T23:12:04.717
> 
> 标签：php, html, forms, caching

我在这里有点疯狂，试图找到一个可能非常简单的解决方案。

我在 Intranet 上有一组报告（外界无法访问），每个报告都有一个输入表单，其中包含一组 HTML 输入，这些输入会改变报告数据。

问题是当您从报告中返回表单时，表单会重置为其原始状态。我希望它缓存（记住 HTML 输入变量），我能找到的只是如何关闭缓存，我想要它！我不希望使用 $_SESSION 和 $_COOKIE 存储来执行此操作，因为我有 120 个报告，每个报告大约有 10 个左右的输入，因此要花很长时间来存储每个人并在刷新时重新加载变量。

我不是服务器管理员，但我相信我们正在运行 Apache 2.2 Web 服务器。这些都是基于 PHP/HTML 的页面。任何建议都会很棒！

这与我的浏览器无关，因为正在缓存其他表单。我更多地研究需要激活服务器上的哪些模块以允许缓存以及我应该在表单的标题中放置哪些注释以允许缓存。Intranet 通过代理运行，所以我想我需要公开缓存控制。

编辑：

当我运行表单页面时，HTTP 标头向我显示了我认为应该更改的内容：

（在响应标题下）

```
 X-Powered-By: PHP/5.3.3
 Via: *[REMOVED]*
 Server: Apache/2.2.3 (Red Hat)
 Proxy-Connection: Keep-Alive
 Pragma: no-cache
 Expires: Thu, 19 Nov 1981 08:52:00 GMT
 Date: Wed, 13 Feb 2013 23:33:32 GMT
 Content-Type: text/html; charset=UTF-8
 Content-Length: 5191
 Connection: Keep-Alive
 Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 
```

我感觉我需要更改 Cache-Control 和 Pragma 值。有谁知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T02:07:54.647

尝试将这些标题添加到页面顶部：

```
header("Cache-Control: private, max-age=10800, pre-check=10800");
header("Pragma: private");
header("Expires: " . date(DATE_RFC822,strtotime("+2 day"))); 
```

注意：如果表单提交并将数据发布到第二页，您可能希望将其放在两个页面的顶部。另外，确保代码在任何 session_start() 之后；如果您正在使用会话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T23:33:16.643

尝试将输入的自动完成属性设置为打开。

```
<input name="myinput" autocomplete="on" type="text"> 
```

# winforms - 如何使用所有者绘制的节点更正 Winforms Treeview 水平滚动条？

> ID：14865059
> 
> 赞同：1
> 
> 时间：2013-02-13T23:12:06.983
> 
> 标签：winforms, treeview, scrollbar, ownerdrawn

我正在创建一个完全由所有者绘制的自定义 winforms Treeview。当粗体文本节点被绘制并超出 Treeview 的宽度时，文本将被截断，因为水平滚动条无法进一步滚动。我认为它与粗体文本有关，并且无法确定正确的宽度。有没有办法纠正滚动条，让它可以一直滚动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:51:40.697

对此没有干净的解决方法，本机 Windows 树视图控件缺少“MeasureNode”类型的消息。如果您自定义绘制更宽的字符串，则需要为水平滚动条提供适当的范围。因此，不可避免地，它仍然基于 TreeNode.Text 字符串的大小。

对此有一个肮脏的解决方案，它有效但令人不快。您可以通过为 TreeNode.Text 属性提供一个*假*字符串来做到这一点，该字符串的宽度足以改变滚动条的形状。并使用 Tag 属性来存储您要绘制的真实字符串。丑陋但有效的黑客攻击。不愉快，因为您不能轻易隐藏该代码。

# java - CallableStatement + 插入从同一个表中选择的新行的过程返回新的 PK

> ID：14865060
> 
> 赞同：0
> 
> 时间：2013-02-13T23:12:29.793
> 
> 标签：java, oracle, stored-procedures, callable-statement

我正在尝试在表中插入新行，该行是从同一表中选择的行的副本。我创建了一个过程，它根据表中的 id 选择行，并用一些新值插入回同一个表中。该过程还返回新行的 PK。

当我执行 CallableStatement 时，出现以下异常：

```
java.sql.SQLException: ORA-06550: line 1, column 371:
PL/SQL: ORA-00933: SQL command not properly ended
ORA-06550: line 1, column 7:
PL/SQL: SQL Statement ignored

at oracle.jdbc.driver.SQLStateMapping.newSQLException(SQLStateMapping.java:70) 
```

我找不到错误

> Commond没有正确结束

在我的程序中

我的代码供参考。任何帮助或提示表示赞赏。谢谢你。

```
public void updateFileToThisVersion(VaMediaFile fileDTO, Long fromMediaId){

    Connection conn = null;
    CallableStatement cst = null;
    try {
        String insertQuery = "BEGIN INSERT INTO VA_MEDIA_FILE (VMF_ID, VMF_FILE_NAME, VMF_FILE, VMF_FILE_CONTENT_TYPE, VMF_FILE_VER_NUM, VMF_IS_ACTIVE, VMF_UPLOADED_BY_ROLE_ID, VMF_UPLOADED_BY_USER_ID, VMF_UPLOADED_TS, VMF_COMMENTS) " + 
                "  (SELECT VMF_ID_SEQ_NUM.NEXTVAL, VMF_FILE_NAME, VMF_FILE, VMF_FILE_CONTENT_TYPE, ?, 'Y', ?, ?, SYSDATE, VMF_COMMENTS FROM VA_MEDIA_FILE where VMF_ID = ?) RETURNING VMF_ID INTO ?; END;";

        conn = getConnection(); 
        conn.setAutoCommit(false);
        cst = conn.prepareCall(insertQuery);

        cst.setString(1, fileDTO.getFileVerNum());
        cst.setString(2, fileDTO.getUploadedByRoleId());
        cst.setString(3, fileDTO.getUploadedByUserId());
        cst.setLong(4, fromMediaId);            
        cst.registerOutParameter(5, Types.NUMERIC);

        cst.execute();
        long newRecordId = cst.getLong(5);
        if(newRecordId != 0L){                      
            conn.commit();
        }           

    } catch (Exception sqlException) {
    } finally {
        OracleDaoUtils.closeQuietly(cst, conn);     
    }               
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:41:59.970

Oracle 似乎不喜欢将“插入语句中的选择语句”与“返回”子句混合。首先，您需要一个单独的 select 语句来选择包含您的 select 语句中所有字段的记录类型。然后，您可以将记录中的 vmf_id 分配给 JDBC 输出参数。最后，您可以在插入语句中使用该记录。

# eclipse - 由第一个空格修剪的 Eclipse JSP 页面参数值

> ID：14865067
> 
> 赞同：-1
> 
> 时间：2013-02-13T23:13:08.080
> 
> 标签：eclipse, jsp

我是 JSP Eclipse 编程的新手。我正在使用 Eclipse 构建 JSP 页面，它使用 Tomcat 5.5 作为应用程序服务器来运行该页面。

现在我有两个 JSP 页面。第一页显示来自 SAP BO 的文件名链接。当用户单击此文件名时，它应该显示文件中生成的值。

现在的问题是：假设文件名是`sales revenue`. 当我单击链接时，参数值被修剪为`sales`. 消除空间后的一切。

我的代码：

```
out.println("<a href=New.jsp?sDocName="+res+" target=_blank > click to view SQL and Export to Repository : "+res+" </a>"); 
```

...`res`变量在哪里。

如何获取包含整个文件名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:30:12.590

首先将`href`属性放在引号中，否则 HTML 解析器认为第一个空格是属性的结尾。

其次，URL 对文件名进行编码并将其用作`sDocName`参数。

* * *

未经测试；关闭：

```
String url      = String.format("New.jsp?sDocName=%s", URLEncoder.encode(res));
String linkText = String.format("Click to view SQL and Export to Repository: %s", res);
String linkHtml = String.format("<a href='%s' target='_blank'>%s</a>", url, linkText);
out.println(linkHtml); 
```

# css - CSS：在悬停时添加渐变

> ID：14865074
> 
> 赞同：-1
> 
> 时间：2013-02-13T23:13:42.680
> 
> 标签：css

是否可以在悬停时添加渐变？我想避免使用图像并使用纯 css3。

我有一个带有 backgroundc-color: blue 的简单框，带有一个图标。我想在鼠标悬停时添加渐变效果。

如何在屏幕抓取时获得渐变发光效果？

我试图在下面获得这种效果：

![蓝色渐变](../Images/163cce0112a8295058bc6fc87268b0ca.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:15:44.617

你可以在 CSS 中做渐变，虽然定义可能有点冗长。这是一个可靠的[CSS3 渐变创建器](http://www.colorzilla.com/gradient-editor/)。

然后只需添加一个`:hover`到您的链接。

```
.your-link:hover {
 // gradient here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:36:19.043

有关 css3 的最佳实践，您可以访问 css3please.com。只需将 :hover 添加到课程中即可满足您的需求：

```
.box_gradient:hover {
  background-color: #444444;
  background-image: -webkit-gradient(linear, left top, left bottom, from(#444444), to(#999999)); /* Chrome, Safari 4+ */
  background-image: -webkit-linear-gradient(top, #444444, #999999); /* Chrome 10-25, iOS 5+, Safari 5.1+ */
  background-image:    -moz-linear-gradient(top, #444444, #999999); /* Firefox 3.6-15 */
  background-image:      -o-linear-gradient(top, #444444, #999999); /* Opera 11.10-12.00 */
  background-image:         linear-gradient(to bottom, #444444, #999999); /* Chrome 26, Firefox 16+, IE 10+, Opera 12.50+ */
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T23:22:40.990

我会这样做：

```
.link:hover {
background-image: -webkit-gradient(radial, 50% 100%, 0, 50% 100%, 116, color-stop(1%, #57fdfe), color-stop(100%, #2c95dd));
background-image: -webkit-radial-gradient(center bottom, farthest-side, #57fdfe 1%, #2c95dd 100%);
background-image: -moz-radial-gradient(center bottom, farthest-side, #57fdfe 1%, #2c95dd 100%);
background-image: -ms-radial-gradient(center bottom, farthest-side, #57fdfe 1%, #2c95dd 100%);
background-image: -o-radial-gradient(center bottom, farthest-side, #57fdfe 1%, #2c95dd 100%);
background-image: radial-gradient(farthest-side at center bottom, #57fdfe 1%, #2c95dd 100%);
} 
```

这是一个完整的示例，您只需复制和粘贴即可，它应该可以工作:) 享受！

请注意，那里有你的颜色和它的径向:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T23:22:56.437

这是你要找的东西吗？
显然使用你自己的颜色。

[**演示**](http://jsfiddle.net/yentup/DrRda/)

这是CSS：

```
.blah:hover {
   background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#0198E1), to(#00FFFF));
   background-image: -webkit-linear-gradient(top, #0198E1, #00FFFF); 
   background-image:    -moz-linear-gradient(top, #0198E1, #00FFFF);
   background-image:     -ms-linear-gradient(top, #0198E1, #00FFFF);
   background-image:      -o-linear-gradient(top, #0198E1, #00FFFF);
} 
```

# arrays - Numpy 数组内存管理

> ID：14865075
> 
> 赞同：6
> 
> 时间：2013-02-13T23:13:45.340
> 
> 标签：arrays, memory, numpy

我有一个关于 Numpy 数组内存管理的问题。假设我使用以下内容从缓冲区创建一个 numpy 数组：

```
>>> s = "abcd"
>>> arr = numpy.frombuffer(buffer(s), dtype = numpy.uint8)
>>> arr.flags
  C_CONTIGUOUS : True
  F_CONTIGUOUS : True
  OWNDATA : False
  WRITEABLE : False
  ALIGNED : True
  UPDATEIFCOPY : False
>>> del s # What happens to arr? 
```

在上述情况下，'arr' 是否包含对 's' 的引用？如果我删除's'，这是否会释放为's'分配的内存，从而使'arr'可能引用未分配的内存？

我还有一些其他问题：

*   如果这是有效的，Python 怎么知道何时释放 's' 分配的内存？gc.get_referrents(arr) 函数似乎没有显示“arr”包含对“s”的引用。
*   如果这是无效的，我怎样才能将 's' 的引用注册到 'arr' 中，以便 Python GC 在对它的所有引用都消失时自动获取 's'？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T01:02:31.743

The following should clarify things a little:

```
>>> s = 'abcd'
>>> arr = np.frombuffer(buffer(s), dtype='uint8')
>>> arr.base
<read-only buffer for 0x03D1BA60, size -1, offset 0 at 0x03D1BA00>
>>> del s
>>> arr.base
<read-only buffer for 0x03D1BA60, size -1, offset 0 at 0x03D1BA00> 
```

In the first case `del s` has no effect, because what the array is pointing to is a `buffer` created from it, which is not referenced anywhere else.

```
>>> t = buffer('abcd')
>>> arr = np.frombuffer(t, dtype='uint8')
>>> arr.base
<read-only buffer for 0x03D1BA60, size -1, offset 0 at 0x03C8D920>
>>> arr.base is t
True
>>> del t
>>> arr.base
<read-only buffer for 0x03D1BA60, size -1, offset 0 at 0x03C8D920> 
```

In the second case, when you `del t`, you get rid of the variable `t` pointing to the `buffer` object, but because the array still has a reference to that same `buffer`, it is not deleted. While I am not sure how to check it, if you now `del arr`, the `buffer` object should lose its last reference and be automatically garbage-collected.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-07T10:57:42.963

为了补充@seberg 的评论：

```
 import ctypes
    import sys

    import numpy as np

    b = bytearray([1, 2, 3])
    b_addr = id(b)
    print(sys.getrefcount(b) - 1, ctypes.c_long.from_address(b_addr).value)  # => 1 1
    a1 = np.frombuffer(b, dtype=np.int8)
    assert b[0] == a1[0]
    b[0] = b[0] + 1
    assert b[0] == a1[0]
    print(sys.getrefcount(b) - 1, ctypes.c_long.from_address(b_addr).value)  # => 2 2
    a2 = np.frombuffer(b, dtype=np.int8)
    print(sys.getrefcount(b) - 1, ctypes.c_long.from_address(b_addr).value)  # => 3 3
    del a2
    print(sys.getrefcount(b) - 1, ctypes.c_long.from_address(b_addr).value)  # => 2 2
    del b
    print(ctypes.c_long.from_address(b_addr).value)  # => 1
    del a1
    print(ctypes.c_long.from_address(b_addr).value)  # => 0 
```

`sys.getrefcount(b)`返回更高的值*“因为它包含（临时）引用作为 getrefcount() 的参数”*

# ruby-on-rails - 使用时出现问题 || (OR) 在 if 语句中

> ID：14865078
> 
> 赞同：0
> 
> 时间：2013-02-13T23:13:55.530
> 
> 标签：ruby-on-rails, ruby-on-rails-3, if-statement

在我的项目控制器中，我有以下操作。如您所见，在呈现“show”视图时调用了“check_if_owner_or_member”，它检查用户是否是项目成员或管理员。如果不是这种情况，用户会收到一条错误消息并被重定向到根目录。

在尝试该操作时，如果用户是管理员，它会起作用，但如果用户是成员，则不会。所以，'if !is_owner || 显然有问题 !is_member'，因为如果我只尝试使用 'if !is_member'，它就可以工作。

我究竟做错了什么？

```
before_filter :check_if_owner_or_member, :only => [:show]

def is_owner
    Project.where("id = ? AND user_id = ?", params[:id], current_user.id).count > 0
end

def is_member
    ProjectsUser.where("project_id = ? AND user_id = ?", params[:id], current_user.id).count > 0
end

def check_if_owner_or_member
    if !is_owner || !is_member
        redirect_to root_path
        flash[:error] = "You don't have permission to the project!"
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:17:53.263

由于成员不是管理员，因此第一部分为真，第二部分不会执行。我想你会想在这里使用 && 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T23:18:56.017

您应该像这样重构您的代码：

```
before_filter :check_if_owner_or_member, :only => [:show]

def is_owner?
  Project.exists?(id: params[:id], user_id: current_user.id)
end

def is_member?
  ProjectsUser.exists?(project_id: params[:id], user_id: current_user.id)
end

def check_if_owner_or_member
  unless is_owner? || is_member? # as TheDude said, you probably meant && here
    redirect_to root_path
    flash[:error] = "You don't have permission to the project!"
  end
end 
```

它更具可读性，并且使用`exists?`比查找、计数和比较零更快的方法执行。

# algorithm - 在有向无环图中找到最低共同祖先的算法？

> ID：14865081
> 
> 赞同：32
> 
> 时间：2013-02-13T23:14:25.467
> 
> 标签：algorithm, graph, directed-acyclic-graphs, lowest-common-ancestor

想象一个如下的有向无环图，其中：

*   “A”是根（总是只有一个根）
*   每个节点都知道它的父节点
*   节点名称是任意的 - 无法从中推断出任何内容
*   我们从另一个来源知道节点按 A 到 G 的顺序添加到树中（例如，它们是版本控制系统中的提交）

![有向无环图](../Images/cf7347e0389db2f35579df891220e2da.png)

我可以使用什么算法来确定两个任意节点的最低共同祖先 (LCA)，例如，以下的共同祖先：

*   B和E是B
*   D和F是B

笔记：

*   从根到给定节点不一定只有一条路径（例如“G”有两条路径），因此您不能简单地[遍历从根到两个节点的路径并寻找最后一个相等的元素](http://www.stoimen.com/blog/2012/08/24/computer-algorithms-finding-the-lowest-common-ancestor/)
*   我找到了树的 LCA 算法，尤其是二叉树，但它们不适用于这里，因为一个节点可以有多个父节点（即这不是一棵树）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-12-04T03:14:16.737

[Den Roman 的链接](http://www.gghh.name/dibtp/?p=526)（[存档版本](https://web.archive.org/web/20190914030055/http://www.gghh.name:80/dibtp/2014/02/25/how-does-mercurial-select-the-greatest-common-ancestor.html)）似乎很有希望，但对我来说似乎有点复杂，所以我尝试了另一种方法。这是我使用的一个简单算法：

假设您想用*x*和*y*两个节点计算 LCA(x,y)。每个节点必须有一个值`color`和`count`，分别。初始化为*白色*和*0*。

1.  *将x*的所有祖先着色为*蓝色*（可以使用[BFS](https://en.wikipedia.org/wiki/Breadth-first_search)完成）
2.  *将y*的所有*蓝色*祖先着色为*红色*（再次 BFS）
***   对于图中的每个*红色*节点，将其父节点的值加`count`一**

 **每个值设置为*0的**红色*节点是一个解决方案。`count`

 *可能有不止一种解决方案，具体取决于您的图表。例如，考虑这个图表：

[![LCA 可以有两个值的 DAG 示例](../Images/a910efd3e119fbc0e54d740c99d17d83.png)](https://i.stack.imgur.com/Cjn5H.png)

LCA(4,5) 可能的解是 1 和 2。

请注意，如果您想找到 3 个或更多节点的 LCA，它仍然有效，您只需为每个节点添加不同的颜色。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-18T03:08:29.603

我一直在寻找相同问题的解决方案，并在以下论文中找到了解决方案：

[http://dx.doi.org/10.1016/j.ipl.2010.02.014](http://dx.doi.org/10.1016/j.ipl.2010.02.014)

简而言之，您不是在寻找最低的共同祖先，而是寻找他们在本文中定义的最低的 SINGLE 共同祖先。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-07-31T13:19:20.213

我知道这是一个老问题和很好的讨论，但是由于我有一些类似的问题要解决，所以我遇到了[JGraphT](https://jgrapht.org/)的[Lowest Common Ancestor](https://en.wikipedia.org/wiki/Lowest_common_ancestor)算法，认为这可能会有所帮助：

*   [本机LcaFinder](https://jgrapht.org/javadoc/org/jgrapht/alg/NaiveLcaFinder.html)
*   [TarjanLowestCommonAncestor](https://jgrapht.org/javadoc/org/jgrapht/alg/TarjanLowestCommonAncestor.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-22T22:48:42.393

只是一些疯狂的想法。将两个输入节点都用作根，并逐步同时执行两个 BFS 怎么样。在某个步骤，当它们的 BLACK 集合（记录访问过的节点）中有重叠时，算法停止并且重叠的节点是它们的 LCA（s）。这样一来，任何其他共同祖先的距离都会比我们发现的要长。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-17T08:53:53.507

假设您想在图中找到 x 和 y 的祖先。

维护一个向量数组——**父母**（存储每个节点的父母）。

1.  首先做一个bfs（继续存储每个顶点的父母）并找到x的所有祖先（找到x的父母并使用**parents**，找到x的所有祖先）并将它们存储在一个向量中。此外，将每个父级的深度存储在向量中。

2.  使用相同的方法找到 y 的祖先并将它们存储在另一个向量中。现在，您有两个向量分别存储 x 和 y 的祖先及其深度。

3.  LCA 将是具有最大深度的共同祖先。深度定义为距根的最长距离（in_degree=0 的顶点）。现在，我们可以按照向量深度的降序对向量进行排序并找出 LCA。使用这种方法，我们甚至可以找到多个 LCA（如果有的话）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-27T22:51:10.927

[这个链接](http://www.gghh.name/dibtp/2014/02/25/how-does-mercurial-select-the-greatest-common-ancestor.html)（[存档版本](https://web.archive.org/web/20190914030055/http://www.gghh.name:80/dibtp/2014/02/25/how-does-mercurial-select-the-greatest-common-ancestor.html)）描述了它是如何在 Mercurial 中完成的 - 基本思想是找到指定节点的所有父节点，按照距根的距离对它们进行分组，然后对这些组进行搜索。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-14T07:16:04.120

我也需要完全相同的东西，在 DAG（有向无环图）中找到 LCA。LCA 问题与 RMQ（Range Minimum Query Problem）有关。

可以将 LCA 简化为 RMQ，并从有向无环图中找到两个任意节点的所需 LCA。

我发现[这个教程](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor)的细节很好。我也计划实现这一点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-06-07T07:23:52.010

我提出 O(|V| + |E|) 时间复杂度解决方案，我认为这种方法是正确的，否则请纠正我。

给定有向无环图，我们需要找到两个顶点 v 和 w 的 LCA。

[步骤 1：使用 bfs http://en.wikipedia.org/wiki/Breadth-first_search](http://en.wikipedia.org/wiki/Breadth-first_search)找到所有顶点到根顶点的最短距离， 时间复杂度为 O(|V| + |E|)，并找到每个顶点的父节点。

Step2：通过使用parent找到两个顶点的共同祖先，直到我们到达根顶点时间复杂度- 2|v|

Step3: LCA 将是具有最大最短距离的共同祖先。

所以，这是 O(|V| + |E|) 时间复杂度算法。

如果我错了，请纠正我或欢迎任何其他建议。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-14T00:09:58.497

如果图表有循环，那么“祖先”的定义是松散的。也许您的意思是 DFS 或 BFS 的树输出上的祖先？`E`或者也许“祖先”是指有向图中的节点，它最小化从和的跳数`B`？

如果您不担心复杂性，那么您可以计算从每个节点到`E`和的 A*（或 Dijkstra 的最短路径） `B`。对于可以同时到达`E`和`B`的节点，您可以找到最小化 的节点`PathLengthToE + PathLengthToB`。

编辑：既然你已经澄清了一些事情，我想我明白你在寻找什么。

如果你只能“向上”树，那么我建议你执行一个 BFS from`E`和一个 BFS from `B`。图表中的每个节点都将有两个与之关联的变量： hops from`B`和 hops from `E`。让两者都`B`拥有`E`图节点列表的副本。`B`的列表按来自的跳数排序，`B`而`E`的列表按来自的跳数排序`E`。

对于 ' 列表中的每个元素`B`，尝试在`E`' 列表中找到它。将匹配项放在第三个列表中，按 hops from `B`+ hops from排序`E`。在你用尽`B`'s list 之后，你的第三个排序列表应该包含 LCA 在它的头部。这允许一个解决方案、多个解决方案（通过它们的 BFS 排序任意选择`B`）或没有解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-10T20:47:03.643

```
package FB;

import java.util.*;

public class commomAnsectorForGraph {
    public static void main(String[] args){
        commomAnsectorForGraph com = new commomAnsectorForGraph();
        graphNode g = new graphNode('g');
        graphNode d = new graphNode('d');
        graphNode f = new graphNode('f');
        graphNode c = new graphNode('c');
        graphNode e = new graphNode('e');
        graphNode a = new graphNode('a');
        graphNode b = new graphNode('b');

        List<graphNode> gc = new ArrayList<>();
        gc.add(d);
        gc.add(f);
        g.children = gc;

        List<graphNode> dc = new ArrayList<>();
        dc.add(c);
        d.children = dc;

        List<graphNode> cc = new ArrayList<>();
        cc.add(b);
        c.children = cc;

        List<graphNode> bc = new ArrayList<>();
        bc.add(a);
        b.children = bc;

        List<graphNode> fc = new ArrayList<>();
        fc.add(e);
        f.children = fc;

        List<graphNode> ec = new ArrayList<>();
        ec.add(b);
        e.children = ec;

        List<graphNode> ac = new ArrayList<>();
        a.children = ac;

        graphNode gn = com.findAncestor(g, c, d);
        System.out.println(gn.value);
    }

    public graphNode findAncestor(graphNode root, graphNode a, graphNode b){
        if(root == null) return null;
        if(root.value == a.value || root.value == b.value) return root;

        List<graphNode> list = root.children;

        int count = 0;
        List<graphNode> temp = new ArrayList<>();

        for(graphNode node : list){
            graphNode res = findAncestor(node, a, b);
            temp.add(res);
            if(res != null) {
                count++;
            }
        }

        if(count == 2) return root;

        for(graphNode t : temp){
            if(t != null) return t;
        }

        return null;
    }
}
class graphNode{
    char value;
    graphNode parent;
    List<graphNode> children;
    public graphNode(char value){
        this.value = value;
    }
} 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2017-08-02T20:50:54.980

每个人。请在Java中尝试。

```
static String recentCommonAncestor(String[] commitHashes, String[][] ancestors, String strID, String strID1)
{
    HashSet<String> setOfAncestorsLower = new HashSet<String>();
    HashSet<String> setOfAncestorsUpper = new HashSet<String>();
    String[] arrPair= {strID, strID1};
    Arrays.sort(arrPair);
    Comparator<String> comp = new Comparator<String>(){
        @Override
        public int compare(String s1, String s2) {
           return s2.compareTo(s1);
        }};
    int indexUpper = Arrays.binarySearch(commitHashes, arrPair[0], comp);
    int indexLower = Arrays.binarySearch(commitHashes, arrPair[1], comp);
    setOfAncestorsLower.addAll(Arrays.asList(ancestors[indexLower]));
    setOfAncestorsUpper.addAll(Arrays.asList(ancestors[indexUpper]));
    HashSet<String>[] sets = new HashSet[] {setOfAncestorsLower, setOfAncestorsUpper};
    for (int i = indexLower + 1; i < commitHashes.length; i++)
    {
        for (int j = 0; j < 2; j++)
        {
            if (sets[j].contains(commitHashes[i]))
            {
                if (i > indexUpper)
                    if(sets[1 - j].contains(commitHashes[i]))
                        return commitHashes[i];
                sets[j].addAll(Arrays.asList(ancestors[i]));
            }
        }
    }
    return null;
} 
```

这个想法很简单。我们假设 commitHashes 按降级顺序排列。我们找到字符串的最低和最高索引（哈希 - 不意味着）。很明显（考虑后代顺序）共同祖先只能在上索引之后（哈希中的较低值）。然后我们开始枚举提交的哈希并构建后代父链的链。为此，我们有两个哈希集由提交的最低和最高哈希的父母初始化。setOfAncestorsLower，setOfAncestorsUpper。如果下一个哈希提交属于任何链（哈希集），那么如果当前索引高于最低哈希的索引，那么如果它包含在另一个集合（链）中，我们返回当前哈希作为结果。如果不是，我们将其父项 (ancestors[i]) 添加到 hashset，它跟踪集合的祖先集合，当前元素包含在其中。***

# javascript - 如何验证 延迟并基于bean值？

> ID：14865082
> 
> 赞同：0
> 
> 时间：2013-02-13T23:14:25.533
> 
> 标签：javascript, jsf-2, primefaces

我有一个`<p:inputText id="address">`我希望在何时`<p:inputText id="validField">`或引用支持 bean 值为时显示验证消息`false`。该值由 给出，`codeAddress()`并且此 JS 函数有相当长的延迟。

```
<h:form id="addressForm">
    <p:inputText id="address" onchange="codeAddress()"/>
    <p:message id="addressValidate" for="address" display="text"/>
    <p:commandButton value="submit" />
    <p:inputText id="validField" value="#{addressBean.valid}"/>
</h:form> 
```

js：

```
var geocoder;
var map;
var valid = false;
var fullAddress = "none";

function initialize() {
    geocoder = new google.maps.Geocoder();
}

function codeAddress() {
    var address = (document.getElementById('addressForm:address').value + ", Germany");
    geocoder.geocode({'address' : address},function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            var latLong = results[0].geometry.location;
            var latitude = results[0].geometry.location.lat();
            var longitude = results[0].geometry.location.lng();
            var country, postal_code, locality, street_number, route;
            for (i = 0; i < results[0].address_components.length; ++i) {
                var component = results[0].address_components[i];
                if (!locality && component.types.indexOf("locality") > -1)
                    locality = component.long_name;
                else if (!postal_code && component.types.indexOf("postal_code") > -1)
                    postal_code = component.long_name;
                else if (!country && component.types.indexOf("country") > -1)
                    country = component.long_name;
                else if (!street_number && component.types.indexOf("street_number") > -1)
                    street_number = component.long_name;
                else if (!route && component.types.indexOf("route") > -1)
                    route = component.long_name;
            }
            if (typeof latLong != "undefined"
                && typeof latitude != "undefined"
                && typeof longitude != "undefined"
                && typeof route != "undefined"
                && typeof street_number != "undefined"
                && typeof postal_code != "undefined"
                && typeof locality != "undefined"
                && typeof country != "undefined"){
                valid = true;               
                fullAddress = results[0].formatted_address;
            }
            else{
                valid=false;
                fullAddress="none";
            };
        }
        else{

            valid=false;
            fullAddress="none";
        }

    });
    window.setTimeout(sendAjaxical, 200);
}

function sendAjaxical(){
//  alert(fullAddress + valid);
    document.getElementById('addressForm:fullAddress').value = fullAddress;
    document.getElementById('addressForm:validField').value = valid;
    jsf.ajax.request(this, event, {execute:"@form"});
    if(valid){
        document.location.href='nextPage.xhtml';
    }else{
        showValidation();
    }
}; 
```

更新的js：

```
var geocoder;
var map;

function initialize() {
    geocoder = new google.maps.Geocoder();
}

function codeAddress() {
    var address = (document.getElementById('addressForm:address').value + ", Germany");
    geocoder.geocode({
        'address' : address
    }, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            var latLong = results[0].geometry.location;
            var latitude = results[0].geometry.location.lat();
            var longitude = results[0].geometry.location.lng();
            var country, postal_code, locality, street_number, route;
            for (var i = 0; i < results[0].address_components.length; ++i) {
                var component = results[0].address_components[i];
                if (!locality && component.types.indexOf("locality") > -1)
                    locality = component.long_name;
                else if (!postal_code
                        && component.types.indexOf("postal_code") > -1)
                    postal_code = component.long_name;
                else if (!country && component.types.indexOf("country") > -1)
                    country = component.long_name;
                else if (!street_number
                        && component.types.indexOf("street_number") > -1)
                    street_number = component.long_name;
                else if (!route && component.types.indexOf("route") > -1)
                    route = component.long_name;
            }
            if (typeof latLong != "undefined" && typeof latitude != "undefined"
                    && typeof longitude != "undefined"
                    && typeof route != "undefined"
                    && typeof street_number != "undefined"
                    && typeof postal_code != "undefined"
                    && typeof locality != "undefined"
                    && typeof country != "undefined") {
                sendAjaxical(true,results[0].formatted_address);
            } else {
                sendAjaxical(false,"none");
            }
        } else {

            sendAjaxical(false,"none");
        }

    });
}

function sendAjaxical(valid,fullAddress) {
    // alert(fullAddress + valid);
    document.getElementById('addressForm:fullAddress').value = fullAddress;
    document.getElementById('addressForm:validField').value = valid;
    jsf.ajax.request(this, event, {
        execute : "@form"
    });
    if (valid) {
        document.location.href = 'nextPage.xhtml';
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T13:08:27.617

您应该在地理编码器完成时调用 JSF ajax 请求，而不是在任意超时之后。

改变

```
geocoder.geocode({'address' : address},function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
        // ...
    }
});

window.setTimeout(sendAjaxical, 200); 
```

经过

```
geocoder.geocode({'address' : address},function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
        // ...

        sendAjaxical();
    }
}); 
```

# sql-server - 使用连接删除是否会锁定*未*被删除的表？

> ID：14865083
> 
> 赞同：3
> 
> 时间：2013-02-13T23:14:32.937
> 
> 标签：sql-server, tsql, sql-server-2008-r2

如果我的查询如下所示：

```
DELETE a
FROM TableA AS a
JOIN TableB as b
ON a.SomeColumn = b.SomeColumn 
```

`TableB`是否在从 中删除所有记录的持续时间内被锁定`TableA`？如果是，是表级、页级还是行级锁定？

我正在使用 SQL Server 2008 R2，我很难找到关于 SQL Server 何时以及如何使用一般锁定的良好信息，因此任何与此相关的资源将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:46:56.220

最有可能的是，共享锁将发布给`TableB`，与您运行`SELECT`. 但是，所采用的特定类型的锁定以及锁定的持续时间将根据您的个人情况而有所不同，因此您应该执行以下验证以获得您问题的准确答案：

首先，`SET TRANSACTION ISOLATION LEVEL REPEATABLE READ`。这将导致共享锁在事务完成之前被持有，而不是像在`READ COMMITTED`.

我们正在提高隔离级别，以便我们可以检查稍后发布了哪些锁……但正因为如此，*您可能不想在生产系统上进行此测试*。

接下来，`BEGIN TRANSACTION`。

然后，发出有问题的`DELETE`命令。

现在，检查[`sys.dm_tran_locks`](http://msdn.microsoft.com/en-us/library/ms190345%28v=sql.105%29.aspx). 我强烈建议[`SELECT`在这个答案中使用@Martin Smith 提供的声明](https://stackoverflow.com/a/7821066/643591)。

最后`COMMIT`还是`ROLLBACK`要关闭事务并释放锁。

使用的结果将为您提供有关所`SELECT`采用`sys.dm_tran_locks`的锁类型以及所采用的对象的详细信息。

# php - 为什么这些简单的更新和插入 sql 函数不能与我的 php 查询一起正常工作？

> ID：14865092
> 
> 赞同：0
> 
> 时间：2013-02-13T23:15:39.187
> 
> 标签：php, mysql, joomla

我正在开发一个自定义 joomla 组件，它只是将一个带有两个字段（id，points）的点表添加到数据库中...... id 是主键，我试图将它设置为与用户 joomla 用户 id 相同...

我需要一个函数来返回用户的点数和另一个将用户点更新为给定值的函数......我成功创建了第一个名为：

```
getUserPoints() 
```

它返回给定用户的点数......然后我启动了第二个更新函数，称为：

```
updateUserPoints() 
```

这是目前“不一致”的部分，我认为我错了......我只是想制作一个简单的函数来更新当前用户的积分值......而且我也在尝试处理如果没有记录的情况......然后创建一个！......我通过在 updateUserPoints() 函数中创建一个名为的函数来做到这一点：

```
newUserCheck() 
```

它应该检查用户是否有积分，然后回复真假：

```
$db->setQuery("SELECT points FROM #__mytable WHERE id = '".$user->id."'");
$db->query();
$points = $db->loadResult();
    if($points){
           return false;
       } else {
           return true;
     } 
```

然后更新创建新记录或更新现有记录...此代码几乎可以工作！...它在三个测试中对我有用...但是当我添加第二个用户时，它似乎有点不一致.. .它会成功创建一个新用户并给他们5分....然后当我再次运行它进行更新时，它会说“更新积分”但它似乎并没有真正更新数据库中的积分值？！

有一个或没有现有用户，它似乎工作正常！无论如何......欢迎提出建议......我确信我在这里做错了，但我想让它正常工作！我是 MVC 编程的新手，你可能会说：P

这是整个 joomla 控制器：

```
<?php defined('_JEXEC') or die('');
// userprofilepoints CONTROLLER

    jimport('joomla.application.component.controller');
    jimport('joomla.user.helper');

    class userprofilepointsController extends JController {

        function getUserPoints(){

            $values = JRequest::get("post");
            $userIdNumber = $values['userIdNumber'];
            $user = & JFactory::getUser();

            $db = JFactory::getDBO();
            $db->setQuery("SELECT points FROM #__mytable WHERE id = '".$user->id."'");
            $db->query();
            $points = $db->loadResult();

            echo $points;
        }

        function updateUserPoints(){

            function newUserCheck(){

                $values = JRequest::get("post");
                $userIdNumber = $values['userIdNumber'];
                $user = & JFactory::getUser();
                $db = JFactory::getDBO();
                $db->setQuery("SELECT points FROM #__mytable WHERE id = '".$user->id."'");
                $db->query();
                $points = $db->loadResult();

                    if($points){
                        return false;
                    } else {
                        return true;
                    }
            }

            if(newUserCheck() == false){

                $values = JRequest::get("post");
                $userIdNumber = $values['userIdNumber'];
                $newPointsAmount = $values['newPointsAmount'];
                $user = & JFactory::getUser();
                $db = JFactory::getDBO();               
                $db->setQuery("UPDATE #__mytable SET points = '".$newPointsAmount."' WHERE id = '".$user->id."'");
                $db->query();

                //echo getUserPoints();
                //$points = $db->loadResult();
                echo "Points Updated";

            } else if(newUserCheck() == true) {

                $values = JRequest::get("post");
                $userIdNumber = $values['userIdNumber'];
                $user = & JFactory::getUser();
                $db = JFactory::getDBO();               
                $db->setQuery("INSERT INTO #__mytable SET id = $user->id, points = 5");
                $db->query();

                echo "New User Created!";

            }

        }
} 
```

最后是我的 html 和 javascript 视图！......谢谢！:)

```
<?php defined('_JEXEC') or die(); 

// MAIN PAGE TEMPLATE
    jimport('joomla.user.helper');
    $user = & JFactory::getUser();
    $profile = JUserHelper::getProfile($user->id);
?>

<script type="text/javascript">
jQuery(document).ready(function($) {

$('#updateBTN').click(function(){

    updateUserPoints();
});

function getUserPoints(){

    //Post the following to the controller
    $.post('http://www.mysite.com/index.php?format=raw&option=com_userprofilepoints&task=getUserPoints', {

        userIdNumber:   <?php echo $user->id; ?>

    }, function(data) {

        alert(data);                        

    }); 
}

function updateUserPoints(){

    //Post the following to the controller
    $.post('http://www.mysite.com/index.php?format=raw&option=com_userprofilepoints&task=updateUserPoints', {

        userIdNumber:   <?php echo $user->id; ?>,
        newPointsAmount:    555444  //random hardcoded points amount to test with

    }, function(data) {

        alert(data);                        

    }); 
}

});

</script>

<div id="main_block">
    <p>Points Page:</p>
    <br />
    <button id="updateBTN">Trigger Update</button>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:04:04.250

从`newUserCheck()`

```
$db->setQuery("SELECT points FROM #__mytable WHERE id = '".$user->id."'");
$db->query();
$points = $db->loadResult(); 
```

实际上应该是：

```
$db->setQuery("SELECT points FROM #__mytable WHERE id = '".$user->id."'");
$points = $db->loadResult(); 
```

`loadResult()`将运行查询。

# unit-testing - Cakephp 2.3 单元测试参数['requested']

> ID：14865096
> 
> 赞同：2
> 
> 时间：2013-02-13T23:16:20.293
> 
> 标签：unit-testing, cakephp-2.3

我正在尝试测试一个只应该从这样的元素调用的控制器操作：

```
$notes = $this->requestAction(array(
        'controller' => 'notes'
    ) , array(
        'pass' => array(
            'location' => $requestUrl
        )
    )); 
```

在操作本身上，有一个检查以确保该操作是“请求的”：

```
public function index() {
    if (!empty($this->params['requested'])) {
        ...
        return $notes;
    } else {
        throw new ForbiddenException();
    }
} 
```

如何测试上面的代码？以下：

```
$this->testAction('/notes', array(

                'passed' => array('location'=>'location1'),

                'return' => 'vars'

            )); 
```

触发 ForbiddenException。我尝试使用 $this->generate 但我不确定我应该如何生成 $this->controller->params 对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:13:18.323

谢谢@nanoman 的回复。但是，我找到了一个更简单的解决方案（不知道我之前为什么想到这个）。写在这里以备将来参考。

只需从测试中调用 requestAction ！

```
function testMytest() {
    $this->controller = $this->generate('Notes', array(
           'components' => array(
                'Auth'
            )
        ));
    $notes = $this->controller->requestAction(array(
        'controller' => 'notes'
    ) , array(
        'pass' => array(
            'location' => 'location1'
        )
    ));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T09:22:05.333

无法修改正在使用的模拟`CakeRequest`对象`ControllerTestCase::_testAction`。

您唯一的机会是子类`ControllerTestCase`化，复制其中的`_testAction`方法，并向您传递参数或`CakeRequest`要使用的对象的方法添加一个附加参数。请参阅下面的实现。

在您的测试用例中，您将按如下方式使用它：

```
$testUrl = '/notes';
$request = $this->getMock('CakeRequest', array('_readInput'), array($testUrl));
$request->addParams(array('requested' => true));
$this->testAction('/notes', array(
    'passed' => array('location'=>'location1'),
    'return' => 'vars',
    'request' => $request
)); 
```

MyControllerTestCase

```
class MyControllerTestCase() {
    protected function _testAction($url = '', $options = array()) {
        $this->vars = $this->result = $this->view = $this->contents = $this->headers = null;

        $options = array_merge(array(
            'data' => array(),
            'method' => 'POST',
            'return' => 'result',
            'request' => null
        ), $options);

        $restore = array('get' => $_GET, 'post' => $_POST);

        $_SERVER['REQUEST_METHOD'] = strtoupper($options['method']);
        if (is_array($options['data'])) {
            if (strtoupper($options['method']) == 'GET') {
                $_GET = $options['data'];
                $_POST = array();
            } else {
                $_POST = $options['data'];
                $_GET = array();
            }
        }

        if($options['request'] instanceof CakeRequest) {
            $request = $options['request'];
        } else {
            $request = $this->getMock('CakeRequest', array('_readInput'), array($url));
        }

        if (is_string($options['data'])) {
            $request->expects($this->any())
                ->method('_readInput')
                ->will($this->returnValue($options['data']));
        }

        $Dispatch = new ControllerTestDispatcher();
        foreach (Router::$routes as $route) {
            if ($route instanceof RedirectRoute) {
                $route->response = $this->getMock('CakeResponse', array('send'));
            }
        }
        $Dispatch->loadRoutes = $this->loadRoutes;
        $Dispatch->parseParams(new CakeEvent('ControllerTestCase', $Dispatch, array('request' => $request)));
        if (!isset($request->params['controller']) && Router::currentRoute()) {
            $this->headers = Router::currentRoute()->response->header();
            return;
        }
        if ($this->_dirtyController) {
            $this->controller = null;
        }

        $plugin = empty($request->params['plugin']) ? '' : Inflector::camelize($request->params['plugin']) . '.';
        if ($this->controller === null && $this->autoMock) {
            $this->generate($plugin . Inflector::camelize($request->params['controller']));
        }
        $params = array();
        if ($options['return'] == 'result') {
            $params['return'] = 1;
            $params['bare'] = 1;
            $params['requested'] = 1;
        }
        $Dispatch->testController = $this->controller;
        $Dispatch->response = $this->getMock('CakeResponse', array('send'));
        $this->result = $Dispatch->dispatch($request, $Dispatch->response, $params);
        $this->controller = $Dispatch->testController;
        $this->vars = $this->controller->viewVars;
        $this->contents = $this->controller->response->body();
        if (isset($this->controller->View)) {
            $this->view = $this->controller->View->fetch('__view_no_layout__');
        }
        $this->_dirtyController = true;
        $this->headers = $Dispatch->response->header();

        $_GET = $restore['get'];
        $_POST = $restore['post'];

        return $this->{$options['return']};
    }
} 
```

# c# - 自定义控件库文件资源

> ID：14865097
> 
> 赞同：0
> 
> 时间：2013-02-13T23:16:21.353
> 
> 标签：c#, wpf, resources, class-library

我正在开发自定义控件，其中包括其控件模板中的 WebBrowser 控件。在控件模板中创建自定义控件和访问 WebBrowser 没有任何问题，但我有一种情况，即 OnAppyTemplate 方法需要动态加载同一自定义控件库 DLL 中的 HTML 文件。这是我目前正在使用的代码，但是当我尝试访问文件时 streamResourceInfo 始终为空

```
 public override void OnApplyTemplate()
    {
        base.OnApplyTemplate();

        _host = GetTemplateChild("PART_BrowserHost") as WebBrowser;
        if (_host == null) return;
        _host.LoadCompleted += HostOnLoadCompleted;

        var uri = new Uri(@"pack://application:,,,/Taicodev.Shark.Controls;component/EpubReader/Resources/Book.html", UriKind.Absolute);
        var streamResourceInfo = Application.GetContentStream(uri);

        var source = streamResourceInfo.Stream;
        _host.NavigateToStream(source);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:55:52.770

是文件资源的构建操作还是 EmbeddedResource？后者需要使用[GetManifestResourceStream](http://support.microsoft.com/kb/319292)而不是包 Uri。如果它是资源，您是否已验证这是资源的正确名称？例如，在反射器/ilspy 中查看该组件的资源。

# c# - 使用 LINQ，获取满足分组条件的项目数

> ID：14865099
> 
> 赞同：9
> 
> 时间：2013-02-13T23:16:29.297
> 
> 标签：c#, .net, linq

如果我太努力的话，我可能会扼杀术语，所以通过代码来描述会更容易：

`var fooGroup = fooList.GroupBy(x => x.SomeID);
//fooGroup is now of type IEnumerable<IGrouping<int, Foo>>
var someCount = fooGroup.Count(y => y.Where(f => f.Bar == "Bar"));`

由于此错误，上述内容无法编译：“无法将 lambda 表达式转换为委托类型`System.Func<System.Linq.IGrouping<int,Foo>,bool>` ，因为块中的某些返回类型不能隐式转换为委托返回类型”

我认为答案很简单，但我不能完全理解如何做到这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T23:29:49.327

您尝试对 group by 执行的操作没有多大意义。我提出以下建议。

如果您正在寻找有多少个元素`Bar == "Bar"`，请在组之前进行。

```
var someCount = fooList.Count(y => f.Bar == "Bar"); 
```

如果您要计算包含与相同条件匹配的元素的组。

```
var fooGroup = fooList.GroupBy(x => x.SomeID)
    .Where(x => x.Any(z => z.Bar == "Bar")).Count(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-13T23:20:29.750

`IEnumerable<IGrouping<int, Foo>>`你通过分组获得。

它是一`IEnumerable`组。该组的键类型为`int`，这是因为您按 int id 列分组。该分组包含一个`IEnumerable`包含所有具有此键的对象的列表。它是类型`Foo`。

然后是一个简单的查询。从分组中，您可以找到具有所需键（即 int id）的那些，然后从 groups 中选择计数`IEnumerable`。

```
var fooGrouping = fooList.GroupBy(x => x.SomeID);
var someCount = fooGrouping.Where(grp => grp.Key == someKey).Select(p=>p.Count()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T23:25:37.670

尝试这个：

```
var someCount = fooGroup.Sum(y => y.Where(f => f.Bar == "Bar").Count()); 
```

或者更干净

```
var someCount = fooGroup.Sum(y => y.Count(f => f.Bar == "Bar")); 
```

# json - 无法反序列化一组多态对象 (Jackson 2.1.2)

> ID：14865105
> 
> 赞同：1
> 
> 时间：2013-02-13T23:17:05.840
> 
> 标签：json, serialization, jackson

我正在尝试反序列化以下内容：

```
{
 "type":"GIQuestionnaire",
 "id":6051,   
 "questions":[
      {
        "type":"IncludeExcludeQuestion",
        "id":24057,
        "answers":[
            {
              "type":"IncludeExcludeAnswer",
               "id":101497
            },
            {
              "type":"IncludeExcludeAnswer",
               "id":101496
            }
         ]
      }
   ]
} 
```

导致此错误：

```
java.lang.AssertionError: Can not handle managed/back reference 'questionnaire-questions': value deserializer is of type ContainerDeserializerBase, but content type is not handled by a BeanDeserializer  (instead it's of type com.foo.questionnaire.json.QuestionDeserializer) 
```

Junit测试：

```
@Test
public void testDeserializeQuestionnaire() {
    ObjectMapper mapper = new ObjectMapper();
    GIQuestionnaire q = manager.createGIQuestionnaire(…);
    try
    {
        String json = mapper.writeValueAsString(q);
        assertTrue(q.equals(mapper.readValue(json, GIQuestionnaire.class)));
    } catch (Exception e) {
        fail(e.getMessage());
    }
} 
```

Questionnaire 包含 Question 对象的 Set（实现为 TreeSet）。一个问题包含一组答案对象（TreeSet）。

以下是显示我如何使用 Jackson 注释的相关代码片段：

```
// Questionnaire abstract base class
@JsonTypeInfo(use=JsonTypeInfo.Id.NAME, include=JsonTypeInfo.As.PROPERTY, property="type")
@JsonSubTypes({
    @JsonSubTypes.Type(value=GIQuestionnaire.class, name="GIQuestionnaire"),
    @JsonSubTypes.Type(value=PolicyQuestionnaire.class, name="PolicyQuestionnaire")    
})
public abstract class Questionnaire implements Serializable {
    @JsonManagedReference("questionnaire-questions")
    @JsonDeserialize(as = TreeSet.class, contentAs = Question.class)

    private Set<Question> questions = new TreeSet<>();

    // … remainder omitted for brevity 
}

// Question abstract base class
@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "type")
@JsonSubTypes({
    @JsonSubTypes.Type(value = EntityQuestion.class, name = "EntityQuestion"),
    @JsonSubTypes.Type(value = IncludeExcludeQuestion.class, name = "IncludeExcludeQuestion")
})
@JsonDeserialize(using = QuestionDeserializer.class)
public abstract class Question implements Comparable<Question>, Serializable {
   @JsonBackReference("questionnaire-questions")
   private Questionnaire questionnaire;

   @JsonManagedReference("question-answers")
   @JsonDeserialize(as = TreeSet.class, contentAs = Answer.class)
   private Set<Answer> answers = new TreeSet<>();

    // … remainder omitted for brevity
}

// Answer abstract base class
@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "type")
@JsonSubTypes({
    @JsonSubTypes.Type(value = EntityAnswer.class, name = "EntityAnswer"),         
    @JsonSubTypes.Type(value = IncludeExcludeAnswer.class, name = "IncludeExcludeAnswer")
})
@JsonDeserialize(using = AnswerDeserializer.class)
public abstract class Answer implements Comparable<Answer>, Serializable {

   @JsonBackReference("question-answers")
   private Question question;
   // … remainder omitted for brevity 
}

public class QuestionDeserializer extends JsonDeserializer<Question> {
    @Override
    public Question deserialize(JsonParser jsonParser, DeserializationContext     deserializationContext) throws IOException, JsonProcessingException {
        //deserialize a Question to a concrete instance
    }
}

public class AnswerDeserializer extends JsonDeserializer<Answer> {
    @Override
    public Answer deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException, JsonProcessingException {
        //deserialize an Answer to a concrete instance
    }
} 
```

我的注释和/或反序列化器哪里出错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-06T08:39:34.413

根据[Jackson WIKI](http://wiki.fasterxml.com/JacksonFeatureBiDirReferences)，不支持多态反序列化和 @JsonManagedReference / @JsonBackReference 的组合。

> 目前（从 1.6.0 版开始）抽象类型的组合（使用 @JsonTypeInfo 进行多态处理）不适用于此功能

另请参阅 Jackson 问题跟踪器中的最新问题[JIRA-890](https://jira.codehaus.org/browse/JACKSON-890)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-07T01:31:47.713

如果您尝试`@JsonIdentityInfo`使用 jackson 2 库中提供的非常方便的接口实现会怎样？

```
@Entity
@JsonIdentityInfo(generator=ObjectIdGenerators.PropertyGenerator.class, property="id")
public class Answer { ....

@Entity
@JsonIdentityInfo(generator=ObjectIdGenerators.PropertyGenerator.class, property="id")
public class Question { .... 
```

在 Maven 中

```
<dependency>
    <groupId>com.fasterxml.jackson.core</groupId>
    <artifactId>jackson-core</artifactId>
    <version>2.0.2</version>
</dependency> 
```

# c++ - Peg Solitaire - 坚持创建状态数组

> ID：14865111
> 
> 赞同：0
> 
> 时间：2013-02-13T23:17:52.123
> 
> 标签：c++

我需要修改状态数组以使每个状态仅使用四位。由于没有原生 4 位类型，您将需要使用更大的类型和位操作来获取和设置每个状态的位。这四个位将用于两个目的。

一个。四位中的两位将代表 4 个值：已经看到、当前深度、下一个深度和未看到。这将有效地标记在当前迭代和未来迭代中应该扩展哪些状态。

湾。其他位将存储每个状态模 4 的深度。这是从电路板中提取路径的足够信息。

是的，这是一个硬件问题，所以我不期待答案，只是指导。我不确定如何继续我的 determineStateInfo 函数。这是我当前的代码：

```
 #include <iostream>
#include <climits>
#include <vector>
#include <assert.h>
#include <stdio.h>
enum state {NEXT_DEPTH = 2, UNSEEN = 3, CURRENT_DEPTH = 1, ALREADY_SEEN = 0};

bool valid[56] =
{
    false, false, false,  false, false, false, false,
    false,  true,  true,  true,  true,  true, false,
    false,  true,  true,  true,  true,  true, false,
    false,  true,  true,  true,  true,  true, false,
    false,  true,  true,  true,  true,  true, false,
    false,  true,  true,  true,  true,  true, false,
    false,  true,  true,  true,  true,  true, false,
    false, false, false,  false, false, false, false
};

struct PegState {
    bool board[56];
};

struct PegAction {
    int from, to, middle;
};

PegState GetStartState()
{
    PegState s;
    for (int x = 0; x < 56; x++)
    {
        s.board[x] = true;
    }
    s.board[24] = 0;
    return s;
}

uint32_t GetHashFromState(PegState s)
{
    uint32_t hash = 0;
    for (int x = 0; x < 56; x++)
    {
        if (valid[x])
            hash = (hash<<1)|(s.board[x]?1:0);
    }
    return hash;
}

PegState GetStateFromHash(uint32_t hash)
{
    PegState s;
    for (int x = 55; x >= 0; x--)
    {
        if (valid[x])
        {
            s.board[x] = hash&0x1;
            hash = hash>>1;
        }
    }
    return s;
}

uint32_t GetMaxHashValue()
{
    uint32_t vals = 0;
    for (int x = 0; x < 55; x++)
    {
        if (valid[x])
            vals = (vals<<1)|1;
    }
    return vals;
//  return 0xFFFFFFFFul;
}

void Print(PegState s)
{
    for (int x = 0; x < 7; x++)
    {
        for (int y = 0; y < 8; y++)
        {
            if (valid[x+y*7])
            {
                printf("%c", s.board[x+y*7]?'o':'.');
            }
            else {
                printf(" ");
            }
        }
        printf("\n");
    }
    printf("\n");
    printf("\n");
}

std::vector<PegAction> GetLegalActions(PegState s)
{
    std::vector<PegAction> moves;
    for (int x = 0; x < 5; x++)
    {
        for (int y = 1; y < 7; y++)
        {
            if (valid[x+0+y*7] && valid[x+1+y*7] && valid[x+2+y*7])
            {
                // right
                if ((s.board[x+0+y*7] == true) &&
                    (s.board[x+1+y*7] == true) &&
                    (s.board[x+2+y*7] == false))
                {
                    PegAction a;
                    a.from = x+0+y*7;
                    a.middle = x+1+y*7;
                    a.to = x+2+y*7;
                    moves.push_back(a);
                }
                // left
                if ((s.board[x+0+y*7] == false) &&
                    (s.board[x+1+y*7] == true) &&
                    (s.board[x+2+y*7] == true))
                {
                    PegAction a;
                    a.from = x+2+y*7;
                    a.middle = x+1+y*7;
                    a.to = x+0+y*7;
                    moves.push_back(a);
                }
            }
        }
    }

    for (int x = 1; x < 6; x++)
    {
        for (int y = 0; y < 6; y++)
        {
            if (valid[x+(y+0)*7] && valid[x+(y+1)*7] && valid[x+(y+2)*7])
            {
                // down
                if ((s.board[x+(y+0)*7] == true) &&
                    (s.board[x+(y+1)*7] == true) &&
                    (s.board[x+(y+2)*7] == false))
                {
                    PegAction a;
                    a.from = x+(y+0)*7;
                    a.middle = x+(y+1)*7;
                    a.to = x+(y+2)*7;
                    moves.push_back(a);
                }
                // up
                if ((s.board[x+(y+0)*7] == false) &&
                    (s.board[x+(y+1)*7] == true) &&
                    (s.board[x+(y+2)*7] == true))
                {
                    PegAction a;
                    a.from = x+(y+2)*7;
                    a.middle = x+(y+1)*7;
                    a.to = x+(y+0)*7;
                    moves.push_back(a);
                }
            }
        }
    }
    return moves;
}

PegState ApplyAction(PegState s, PegAction a)
{
    assert(s.board[a.from] == true);
    s.board[a.from] = false;
    assert(s.board[a.middle] == true);
    s.board[a.middle] = false;
    assert(s.board[a.to] == false);
    s.board[a.to] = true;

    return s;
}

void undo()
{

}

void reverse()
{

}

void setBit(uint8_t *array, const uint32_t hash, const uint8_t new_info)
{
    assert(new_info == (new_info&0xF));
    const uint8_t index ( hash/2 );
    if(hash%2 == 0) //even
    {
        array[index] &= 0xF;  //00001111
        array[index] |= new_info << 4;
    }
    else
    {
        array[index] &= 0xF0;   //11110000
        array[index] |= new_info;
    }
}

uint8_t getStateInformation(const uint8_t *array, const uint32_t hash)
{
    const uint8_t index ( hash/2 );
    if(hash%2 == 0) //even
        return array[index] & 0xF;
    else
        return array[index] & 0xF0;
}

void savestate(PegState *temp)
{
    FILE *f;
    f = fopen("state.txt", "w+");

    for (int x = 0; x < 55; x++) {}
        //fwrite(&temp.board[x], sizeof(PegState), 1, f);
}

uint8_t determineStateInfo(uint8_t status, uint32_t depth)
{
    if(status == CURRENT_DEPTH)
    {

    }
    else if(status == ALREADY_SEEN)
    {

    }
    return 0;
}

bool compare(uint8_t stateInfo)
{
    if(stateInfo == 0xF)
        return true;
    else
        return false;
}

void BFS()
{
    // initialize memory, 1 byte per state, to store the depth of the state
    uint32_t maxVal = GetMaxHashValue();
    int8_t *dist = new int8_t[maxVal];

    // reset all memory to -1 (unseen)
    for (uint32_t x = 0; x < maxVal; x++)
        dist[x] = -1;

    // Set the start state to depth 0
    PegState s = GetStartState();
    dist[GetHashFromState(s)] = 0;
    Print(s);

    printf("Ready to begin search\n");

    // Loop through all states; any at the current depth should:
    //   * Have their legal actions generated
    //   * Find all possible successor states
    //   * Write the depth of the successors
    // Repeat the loop until no states are updated in the loop
    int update = 0;
    int expand = 0;
    int currDepth = 0;
    do {
        expand = 0;
        update = 0;
        for (uint32_t x = 0; x < maxVal; x++)
        {
            uint8_t i = getStateInformation(dist[x], maxVal);
//          if (0 == x%100000000)
//              printf("%ul\n", x);
            if (dist[x] == currDepth)
            {
                expand++;
                s = GetStateFromHash(x);
                std::vector<PegAction> m = GetLegalActions(s);
                for (unsigned int t = 0; t < m.size(); t++)
                {
                    PegState res = ApplyAction(s, m[t]);
                    uint32_t rank = GetHashFromState(res);
                    if (dist[rank] == -1)
                    {
                        dist[rank] = currDepth+1;
                        update++;
                    }
                }
            }
        }
        printf("Depth %d; %d expanded; %d unique generated\n",currDepth, expand, update);
        currDepth++;
    } while (update > 0);

    for (uint32_t x = 0; x < maxVal; x++)
    {
        if (dist[x] == (currDepth-1) || dist[x] == 0)
        {
            s = GetStateFromHash(x);
            Print(s);
        }
    }
    // Print statistics about the search
}

int main(int argc, const char * argv[])
{
    BFS();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:58:14.717

从 C 的早期开始，您可以通过将其放入结构中来创建 4 位变量：

```
struct PegState
{
    unsigned int view:2;
    unsigned int depth:2;
}; 
```

对于更紧凑的表示，要求说明了一切：使用位操作操作。
要设置一个位，请使用“或”运算符，“|”：

```
unsigned int value = value | 16;
value |= (1 << 8); 
```

要擦除一点，请使用 1 的补语和“与”运算符“&”：

```
unsigned int value = 0xFF;
value = value & (~(1 << 5)); 
```

要测试该位，您可以使用 AND 运算符：

```
unsigned int value = 0x55;
if (value & (1 << 2))
{
} 
```

在 SO 和网络上搜索“位操作”。

# ios - 核心数据后台获取失败，直到多余的插入

> ID：14865115
> 
> 赞同：0
> 
> 时间：2013-02-13T23:18:00.690
> 
> 标签：ios, core-data

我正在尝试从 sqlite 持久存储的后台线程上的核心数据中进行简单的获取。

该方法是来自返回对象的 RESTful api 调用的响应。如果找到这个对象，它想更新它。如果没有找到，它想插入它。

但发生的情况是，在每次重新启动应用程序后第一次调用 api 时，提取不成功（即使我可以在 sql 数据库中看到该对象）并且插入了一个新的托管对象。但是，此插入不会导致创建新对象。仍然只有一个对象！

第二次调用api，fetch成功找到对象，一切正常。

所以谓词是正确的，模型中没有错别字。

以下是后台方法的基础知识：

```
 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{

         // Create a MOC for this background thread.
         NSManagedObjectContext *backgroundContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
         [backgroundContext setPersistentStoreCoordinator:((MyAppDelegate *)([UIApplication sharedApplication].delegate)).persistentStoreCoordinator];

         [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(mergeChanges:) name:NSManagedObjectContextDidSaveNotification object:backgroundContext];

         // This is the returned value from the api call.
         NSDictionary *responseDict = [completedOperation.responseString JSONValue];
        NSString *venueName = [responseDict valueForKey:@"venueName"];

         // VenueDescription is a managed object model.
         VenueDescription *venueDesc = [[DatabaseManager sharedDatabaseManager] fetchVenueDescriptionForVenueName:venueName context:backgroundContext];

          if (!venueDesc) { // venueDesc is nil the first time even though the object exists.
                 // This insert does NOT create a new object.        
               venueDesc = [NSEntityDescription insertNewObjectForEntityForName:@"VenueDescription" inManagedObjectContext:backgroundContext];
          }

          if (venueDesc) {

                venueDesc.venueName = venueName;
                /*.... code to update venueDesc from the dictionary....*/

                [backgroundContext refreshObject:venueDesc mergeChanges:YES];

           }

            [[DatabaseManager sharedDatabaseManager] saveContext:backgroundContext];

         [[NSNotificationCenter defaultCenter] removeObserver:self name:NSManagedObjectContextDidSaveNotification object:backgroundContext];
         [backgroundContext release];

     }); 
```

这是 fetch 方法：

```
 -(VenueDescription *)fetchVenueDescriptionForVenueName:(NSString *)venueName context:(NSManagedObjectContext *)context {

NSEntityDescription * entity = [NSEntityDescription entityForName:@"VenueDescription" inManagedObjectContext:context];

if (!entity) return nil;

NSFetchRequest * fetchRequest = [[NSFetchRequest alloc] init];
[fetchRequest setEntity:entity];
[fetchRequest setResultType:NSManagedObjectResultType];
[fetchRequest setFetchLimit:1];

NSSortDescriptor *nameSortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"venueName" ascending:YES];
NSArray *sortDescriptorArray = [NSArray arrayWithObject:nameSortDescriptor];
[nameSortDescriptor release];
[fetchRequest setSortDescriptors:sortDescriptorArray];

NSPredicate *predicate = [NSPredicate predicateWithFormat:@"venueName LIKE %@", venueName];

[fetchRequest setPredicate:predicate];

NSFetchedResultsController *controller = [[[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:context sectionNameKeyPath:nil cacheName:nil] autorelease];

NSError *error = nil;
[controller performFetch:&error];

if (error) NSLog(@"Error fetching Venue Descriptions: %@", error);

[fetchRequest release];

if ([controller.fetchedObjects count] == 0) return nil;

return [controller.fetchedObjects objectAtIndex:0]; 
```

}

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T09:29:00.990

您在这里缺少一些基本人员。

第一的。改变您在多线程环境中使用托管对象上下文的方式。第二。你不需要创建**NSFetchedResultsController**来执行获取请求。

那么，假设**((MyAppDelegate *)([UIApplication sharedApplication].delegate)).managedObjectContext***返回具有 * NSMainQueueConcurrencyType** 并发类型*的主托管对象上下文，那么您的背景和 fetch 方法应该是什么样子：*

```
 // Create a MOC for this background thread.
     NSManagedObjectContext *backgroundContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
     [backgroundContext setParentContext:((MyAppDelegate *)([UIApplication sharedApplication].delegate)).managedObjectContext];
     [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(mergeChanges:) name:NSManagedObjectContextDidSaveNotification object:backgroundContext];
     NSDictionary *responseDict = [completedOperation.responseString JSONValue];

     [backgroundContext performBlock:^{

     // This is the returned value from the api call.
    NSString *venueName = [responseDict valueForKey:@"venueName"];

     // VenueDescription is a managed object model.
     VenueDescription *venueDesc = [[DatabaseManager sharedDatabaseManager] fetchVenueDescriptionForVenueName:venueName context:backgroundContext];

      if (!venueDesc) { // venueDesc is nil the first time even though the object exists.
             // This insert does NOT create a new object.        
           venueDesc = [NSEntityDescription insertNewObjectForEntityForName:@"VenueDescription" inManagedObjectContext:backgroundContext];
      }

      if (venueDesc) {

            venueDesc.venueName = venueName;
            /*.... code to update venueDesc from the dictionary....*/

            [backgroundContext refreshObject:venueDesc mergeChanges:YES];

       }

        [[DatabaseManager sharedDatabaseManager] saveContext:backgroundContext];

     [[NSNotificationCenter defaultCenter] removeObserver:self name:NSManagedObjectContextDidSaveNotification object:backgroundContext];
     [backgroundContext release];

 }); 
```

和 fetch 方法

```
-(VenueDescription *)fetchVenueDescriptionForVenueName:(NSString *)venueName context:(NSManagedObjectContext *)context {

    NSEntityDescription * entity = [NSEntityDescription entityForName:@"VenueDescription" inManagedObjectContext:context];

    if (!entity) return nil;

    NSFetchRequest * fetchRequest = [[NSFetchRequest alloc] init];
    [fetchRequest setEntity:entity];
    [fetchRequest setResultType:NSManagedObjectResultType];
    [fetchRequest setFetchLimit:1];

    NSSortDescriptor *nameSortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"venueName" ascending:YES];
    NSArray *sortDescriptorArray = [NSArray arrayWithObject:nameSortDescriptor];
    [nameSortDescriptor release];
    [fetchRequest setSortDescriptors:sortDescriptorArray];

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"venueName LIKE %@", venueName];

    [fetchRequest setPredicate:predicate];

    NSError *error = nil;
    NSArray* fetchedObjects = [context executeFetchRequest:fetchRequest error:&error];

    if (error) NSLog(@"Error fetching Venue Descriptions: %@", error);

    [fetchRequest release];

    return [fetchedObjects lastObject];
} 
```

# sublimetext2 - Sublime Text Plugin：禁用水平滚动，也不要自动换行

> ID：14865117
> 
> 赞同：10
> 
> 时间：2013-02-13T23:18:02.547
> 
> 标签：sublimetext2, sublimetext

我喜欢尽可能多的 Sublime Text 窗口并排，所以我禁用了装订线和行号以及所有这些，这样窗口的宽度正好是 80 个字符。但是随后 Sublime Text 坚持水平滚动一点，超过第 80 列。当我使用带有触控板的两指滚动时，这尤其令人讨厌，因为我经常不得不将视图推回左侧。

我可以启用`word_wrap`并禁用水平滚动，这很好，除非即使使用`wrap_width`，我也不能仅在第 80 列之后进行换行。如果 wrap_width 大于或等于窗口宽度，它坚持以略小于窗口宽度，正好是 80 个字符。

假设我是正确的，标准设置不允许我同时禁用水平滚动和自动换行，这可以通过插件 API 实现吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-11-27T21:28:10.467

我有同样的问题，我能找到的唯一解决方案是手动聚焦每个窗口，然后查看>自动换行列>自动。这将解决问题，但必须为您单独使用的每个窗口完成。多花 30 秒手动执行此操作可以在一天中为我节省更多时间。我希望我们可以通过首选项/设置来修复它，但它在 ST2 中并没有出现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-27T06:46:31.377

在此页面[http://www.sublimetext.com/docs/file-type-preferences](http://www.sublimetext.com/docs/file-type-preferences)

似乎 wordWrap 和水平滚动是绑定的（？）。

> wordWrap：水平滚动设置为 false。默认为真。

所以

> wantVerticalScrollBar：设置为 false 隐藏垂直和水平滚动条。默认为真。wantHorizo​​ntalScrollBar true

我不确定它是否可以在控制台上修改（页面中的命令）。

希望对你有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-26T18:20:30.007

1.  视图 > 自动换行列 > 自动

2.  查看 > 点击“自动换行”

# java - 如何绘制 ASCII 直角三角形？

> ID：14865124
> 
> 赞同：-3
> 
> 时间：2013-02-13T23:19:01.310
> 
> 标签：java

这段代码有什么问题？？它似乎没有打印出很多东西

```
public void RTriangle(char appearance, int size)
    {
        for (int i = 0; i < size; i++)
        {
            for (int j = 0; j < i; j++)
            {
                System.out.println(appearance);
            }
            System.out.println();
        }
        System.out.println();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:33:02.763

```
public void print(final char appearance, final int size){
    for (int i = 1; i <= size; i++) {
        for (int j = size - i; j >0; j--)
            System.out.print(" ");
        for (int k = i; k > 0; k--)
            System.out.print(appearance);
        System.out.println();
    }
} 
```

那应该按照指示去做。如果你想让我解释一下逻辑，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:32:55.120

我认为您必须正确设置索引。例如：

```
for (int i = 0 ; i < size ; i++) { // count of rows
    for (int j = 0 ; j < size ; j++)
      System.out.print ((i < j) ? " " : appearance);
    System.out.println();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T23:32:55.810

```
public void RTriangle(char appearance, int size)
{
    for(int i=0;i<size;i++)
    {
        for(int j=0;j<size;j++)
        {
            if((size-j)<i) // the amount of * depents on i and it goes from the right to the left so use size -j
                System.out.print(""+appearance); //""+ turns the char into a string
        }
        System.out.println(); //append a line when your first line is done
    }
} 
```

# mysql - SQL - 获取一个字段中两个单词之间的单词

> ID：14865127
> 
> 赞同：-1
> 
> 时间：2013-02-13T23:19:59.450
> 
> 标签：mysql, sql

我有一张表（house_1），其中字段 term_list 具有这种结构......

[id-537,typeOfObject-'house',workNumber-631,title-'A beautifull House',titleGerman-'Eine schöne Haus',titleEnglish-'A beautifull House',titleFrench-'Une maison magnifique',finishedPlace-' Traun',1966 年,heightMm-480,widthMm-665]

我试过这个，但不返回任何东西......

```
SELECT * 
FROM house_1 
WHERE term_list LIKE '%titleEnglish-\'% beautifull %\',title%'" 
```

我知道数据库设计很恶心，但现在不可能重新设计。

任何想法？很感谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T03:41:58.090

您可以使用正则表达式：

```
SELECT * FROM `house_1` WHERE `term_list` REGEXP "^(.)*(titleEnglish){1}(.)*(beautifull){1}(.)*$" 
```

请注意，这是一个缓慢的查询。

# indexing - node_auto_index 不存在

> ID：14865128
> 
> 赞同：3
> 
> 时间：2013-02-13T23:20:07.577
> 
> 标签：indexing, neo4j

我已经创建了包含用户、媒体及其关系等实体的数据集。我的`neo4j.properties`文件为节点和关系打开了自动索引。我还添加了一个属性`'type'`到`node_keys_indexable`. 但是，当我在运行以下查询时收到以下错误。

```
START user =node:node_auto_index(fn="Balaji") 
RETURN user.ln

Error: Index `node_auto_index` does not exist 
```

我是新手`neo4j`。感谢任何帮助。

感谢和问候巴拉吉

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T08:06:50.420

您是否在配置自动索引之前添加了节点？

然后你必须重新索引你的节点，例如运行这样的密码查询：

```
start n=node(*)
where has(n.type)
set n.type=n.type 
```

这适用于小图，对于较大的图，您必须对其进行分页。

```
start n=node(*)
with n
skip 25000 limit 25000 
where has(n.type)
set n.type=n.type 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-03T19:53:16.860

我有同样的症状。问题是我在 neo4j 配置中拼错了索引键的名称。检查您创建的节点是否具有与`neo4j.properties`.

# azure - DataCacheFactoryConfiguration 仅使用本地内存？

> ID：14865129
> 
> 赞同：1
> 
> 时间：2013-02-13T23:20:09.280
> 
> 标签：azure, azure-caching

无论如何配置 DataCache 提供程序以仅依赖本地内存进行缓存？

出于性能原因，我的一些开发人员在测试他们的 Azure 东西时不使用 Azure 模拟器，而是直接调试 Web 应用程序。

我们根本没有使用 web.configs 来驱动缓存配置，如果能够将设置注入到我们的自定义配置实用程序中，在这样的模式下，DataCache 不会尝试使用 Shared 或专用 Azure 缓存，但只是 PC 上的本地内存。(InProc - HttpRunTime.Cache)

# google-apps-script - 在谷歌电子表格中编辑另一个单元格时自动在一个单元格中添加数据

> ID：14865134
> 
> 赞同：1
> 
> 时间：2013-02-13T23:20:24.520
> 
> 标签：google-apps-script, google-sheets

我一直在尝试让谷歌电子表格在编辑另一个单元格时自动将数据添加到一个单元格中，但是我似乎只能让 onedit 函数在全局范围内工作。

具体来说，如果编辑了 B2、B3、B4 等，我希望 N2、N3、N4 等自动填充时间戳或用户名。

任何帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-03T22:11:22.167

[在这里](https://stackoverflow.com/a/17754113/1677912)扩展答案...

```
function onEdit(e)
{
  var row = e.range.getRow();
  var sheet = e.range.getSheet();

  //  if B2, B3, B4 etc. was edited, fill N2, N3, N4 etc. with a timestamp
  var value = new Date();
  // ... or the user's name. 
  // var value = Session.getActiveUser().getEmail();

  var headerRows = 1;  // # header rows to ignore

  // Skip header rows
  if (row <= headerRows) return;

  // We're only interested in column B (aka 2)
  if (e.range.getColumn() != 2) return;

  sheet.getRange(row,14).setValue(value); // N<row>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-06T11:29:19.820

**对于其他可能想要自动添加数据插入的日期和时间的人。**

我刚遇到这个问题，我修改了[Internet Geeks](http://www.internetgeeks.org/tech/add-timestamp-time-stamp-google-docs-spreadsheet/)提供的代码。

他们的代码通过更新指定列来工作，时间戳被插入到另一个指定列的同一行中。

我改变的是我将日期和时间分开，因为时间戳是一个字符串，而不是日期格式。我的 was 对于生成图表很有用。

它的工作原理是指定要跟踪更改的列，然后分别为日期和时间创建 upDate 和 upTime 列。

```
function onEdit(event) {
  var timezone = "GMT+1";
  var date_format = "MM/dd/yyyy";
  var time_format = "hh:mm";

  var updateColName = "Резултат";

  var DateColName = "upDate";
  var TimeColName = "upTime";

  var sheet = event.source.getActiveSheet(); // All sheets
  // var sheet = event.source.getSheetByName('Test'); //Name of the sheet where you want to run this script. 

  var actRng = event.source.getActiveRange();
  var editColumn = actRng.getColumn();
  var index = actRng.getRowIndex();
  var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues();

  var dateCol = headers[0].indexOf(DateColName);
  var timeCol = headers[0].indexOf(TimeColName);

  var updateCol = headers[0].indexOf(updateColName);
  updateCol = updateCol + 1;

  if (dateCol > -1 && timeCol > -1 && index > 1 && editColumn == updateCol) {
    // only timestamp if 'Last Updated' header exists, but not in the header row itself! 

    var cellDate = sheet.getRange(index, dateCol + 1);
    var cellTime = sheet.getRange(index, timeCol + 1);

    var date = Utilities.formatDate(new Date(), timezone, date_format);
    var time = Utilities.formatDate(new Date(), timezone, time_format);

    cellDate.setValue(date);
    cellTime.setValue(time);
  }
} 
```

希望这对人们有所帮助。

# c++ - C++ 中向量推回操作的类型转换

> ID：14865137
> 
> 赞同：1
> 
> 时间：2013-02-13T23:20:33.300
> 
> 标签：c++, types, vector, casting, push-back

我有两个向量

```
std::vector<std::string> outputStack, operatorStack; 
```

在某些时候，我需要从一个堆栈中弹出一些元素并将其推入另一个堆栈。

```
while(operatorStack.back().compare(L_BRACKET)) {
    outputStack.push_back(operatorStack.pop_back());
} 
```

但是，eclipse 会抛出一个错误，无效的参数。但是当我输入强制转换输入时工作正常。

```
outputStack.push_back((std::string)operatorStack.pop_back()); 
```

现在，为什么需要这种类型转换？我正在阅读（主要是在 C++ Primer 中）根据 C++11 需要避免类型转换。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T23:22:36.083

[`std::vector::pop_back()`](http://en.cppreference.com/w/cpp/container/vector/pop_back)返回`void`。你需要得到第[`back()`](http://en.cppreference.com/w/cpp/container/vector/back)一个，*然后*弹出它。

```
outputStack.push_back(operatorStack.back());
operatorStack.pop_back(); 
```

`pop`出于异常安全原因，这在标准库容器函数中很常见。返回 pop 的 value_type 通常意味着复制构造，这可能会抛出，这意味着容器将丢失调用者未成功复制的元素。所以`pop()`和`back()`或`front()`操作是分开的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T23:22:45.567

[`pop_back`](http://en.cppreference.com/w/cpp/container/vector/pop_back)不返回元素。它有一个无效的回报。即使 Eclipse 没有抱怨，如果该演员表能够编译，我会感到震惊（它肯定不应该）。

由于`pop_back`在 C++ 中实际上并不返回弹出的元素，因此您需要先抓取它[`back`](http://en.cppreference.com/w/cpp/container/vector/back)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T23:25:19.217

您需要使用`std::vector::back()`来获取最后一个元素的值，而不是[std::vector::pop_back](http://en.cppreference.com/w/cpp/container/vector/pop_back)，因为 pop_back 只是从后面删除元素并返回 void。

Also need to compare `std::string::compare` with `std::string::npos`

```
while(operatorStack.back().compare(L_BRACKET) == 0) {
    outputStack.push_back(operatorStack.back());
    operatorStack.pop_back();
} 
```

# oracle - 存储过程PLSQL中的条件选择？

> ID：14865139
> 
> 赞同：0
> 
> 时间：2013-02-13T23:20:44.193
> 
> 标签：oracle, plsql

我创建了一个存储过程来搜索员工姓名，但是我希望它是开放式的，以便用户可以插入名字或姓氏，或者根本没有名字......只是想知道如何构造这个逻辑。

基本上像下面这样..如果它为空，我希望它跳过对名称的检查。下面的行应该工作吗？还是我搞砸了。谢谢。

```
search_employe(name, type)

SELECT * FROM employee_table e
WHERE e.type = type
AND IF name is not null THEN e.FNAME = name OR e.LName = name END IF
AND {...} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:25:42.670

选择不需要任何 plsql，但原始帖子谈到了“插入”，所以可能需要澄清一下——你的意思是，传递参数吗？

```
SELECT * FROM employee_table e
WHERE e.type = type
AND (name is null OR e.FNAME = name OR e.LName = name) 
```

我认为拥有一个存储过程，其中调用者传递一个要匹配的名称，但您也将返回任何没有注册名称的员工，并认为这是一个匹配。如果您真的想返回如此混乱的数据（QA 会有一个现场日），那么可以这样做：

```
SELECT * FROM employee_table e
WHERE e.type = type
AND 
(
    -- matching names, or the value was passed in null
    (name is null OR e.FNAME = name OR e.LName = name)
    OR
    -- value passed in, but the employee has no registered name
    (name is not null AND e.FNAME is null AND e.LName is null)
) 
```

但我真的建议回到绘图板上来了解数据的要求和完整性。

# cocoa-touch - 在 cocos2d 中双击

> ID：14865141
> 
> 赞同：2
> 
> 时间：2013-02-13T23:20:48.027
> 
> 标签：cocoa-touch, cocos2d-iphone

我正在尝试使用 cocos2d 开发游戏。我现在卡住了。我不知道如何检测双击事件，就像 windows 中的双击一样。我尝试使用

```
NSArray * allTouches = [touches allObjects];
int count = [allTouches count]; 
```

在`ccTouchesEnded`

但这似乎在同时发生双重触摸时起作用。我想要它在 Windows 中的样子。

谁能给我一些想法？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T03:09:52.850

如果您使用targetedTouchDelegate，您可以这样做：

```
- (void) ccTouchEnded:(UITouch *)touch withEvent:(UIEvent *)event {
    if(touch.tapCount==1) MPLOG(@"ONE TAP");
    if(touch.tapCount==2) MPLOG(@"TWO TAPS");
    return;
} 
```

当双击发生时，您将获得两次触摸，即，当双击时，这将记录“ONE TAP”和“TWO TAPS”。由你来弄清楚你的状态并做你的事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T17:53:19.140

您在谈论多点触控 2 指点击或双击，就像在 mac 和 windows 中一样？

如果它像在 mac 和 windows 中一样双击，那么这里是解决方案。

你可以通过两种方式做到这一点。

1.  使用 UITapGestureRecognizer（设置为检测双击）LearnCocos2D 在这个[问题](https://stackoverflow.com/questions/14895613/how-to-find-if-a-view-is-tapped-more-than-2-times-within-certain-time-period-in/14896063#14896063)中建议。

2.  通过使用时间差使用手动双击跟踪。

//在接口文件中声明这个

```
 NSTimeInterval      mLastTapTime; 
```

在实施文件中：

```
-(id)init
{
    if(self = [super init])
    {
         mLastTapTime = [NSDate timeIntervalSinceReferenceDate];
    }
    return self;
} 
```

//在触摸方法中

```
NSTimeInterval currentTime = [NSDate timeIntervalSinceReferenceDate];
NSTimeInterval diff = currentTime - mLastTapTime;

if(diff < 0.5 ) //0.5 or less
{
     //double tap
}

mLastTapTime = [NSDate timeIntervalSinceReferenceDate]; 
```

# android - 在旋转事件上保留 MenuItem 复选框状态

> ID：14865143
> 
> 赞同：0
> 
> 时间：2013-02-13T23:21:14.157
> 
> 标签：android, checkbox, sharedpreferences, menuitem

我的菜单中有一个来自 SherlockActionBar 的 MenuItem，它有一个复选框，但是当我旋转设备时，该复选框仍然处于活动状态，但标签右侧的图标未选中。

我想要实现的是在旋转设备后再次显示该框。

到目前为止，我一直在尝试使用 SharedPreferences、标志、将“菜单”（来自 onCreateOptionsMenu）存储到变量并查找 id onPrepareOptionsMenu 来修复它，但没有做我想做的事情。

我现在正在做的是将MenuItem的状态标志存储在“onOptionsItemSelected”上，然后在“onPrepareOptionsMenu”上检查标志的值并设置检查......但这会造成更多麻烦。

我不知道该怎么做。:(

编码：

```
private boolean lockFlag;

...

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    this.menu = menu;

    getSupportMenuInflater().inflate(R.menu.activity_main, menu);

    return super.onCreateOptionsMenu(menu);
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case R.id.menu_lock:
        if (item.isChecked()) {
            item.setChecked(false);
            lockFlag = false;
        } else {
            item.setChecked(true);
            lockFlag = true;
        }
        return true;
    default:
        return super.onOptionsItemSelected(item);
    }
}

@Override
public boolean onPrepareOptionsMenu(Menu menu) {
    super.onPrepareOptionsMenu(menu);
    if (lockFlag) {
        menu.findItem(R.id.menu_lock).setChecked(true);
    } else {
        menu.findItem(R.id.menu_lock).setChecked(false);
    }

    return true;
}

private void savePrefs() {
    getSharedPreferences("LOCKBARS", MODE_PRIVATE).edit().putBoolean("lockbars", lockFlag).commit();
}

private void loadPrefs() {
    this.lockFlag = getSharedPreferences("LOCKBARS", MODE_PRIVATE).getBoolean("lockbars", false);
} 
```

编辑：这些是我正在使用的复选框，我没有手动设置任何图标。

![在此处输入图像描述](../Images/eca2a73a6d4b7a15e313af4df32eccbc.png) ![在此处输入图像描述](../Images/f3eb020b8ec2dda06576b9336f8ebc17.png)

编辑2：

好的，看起来这样就`android:configChanges="orientation|screenSize"`可以了，但是它停止使用横向模式的布局，而是使用默认的布局。`android:configChanges="orientation"`没有“screenSize”，什么也做不了。

编辑3：

无耻的汽车碰撞。我还是被困住了。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:36:13.753

看起来像一个常见的方向变化 - 对我来说状态保存问题。这个问题已经有了很好的解决方案，例如以下链接中提供的解决方案：

[如何在Android中的方向更改期间保存状态](https://stackoverflow.com/a/12054158/559885)

[在 Android 中保存 Activity 状态](https://stackoverflow.com/questions/151777/saving-activity-state-in-android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:45:01.433

根据我的经验，在我的清单文件中包含以下内容会保留状态。

" android:configChanges="orientation|screenSize"/>

稍后看到您的编辑。可能这是你做错了什么：

[MenuItem 的选中状态未通过其图标正确显示](https://stackoverflow.com/questions/6683186/menuitems-checked-state-is-not-shown-correctly-by-its-icon)

# meteor - 用于移动平台的 Meteor js api

> ID：14865144
> 
> 赞同：1
> 
> 时间：2013-02-13T23:21:15.037
> 
> 标签：meteor

我们有一个项目，我们将 Meteor 作为 Web 前端运行，并且我们在另一个端口有 PHP + nginx，用于来自移动平台的 api 调用。

Meteor 和 PHP 后端连接到通用 mongo 数据库。

Meteor 在授权和注册时不会向服务器发送明文密码，并使用安全远程密码协议。

```
Meteor.loginWithPassword(user, password, [callback]) 
```

不能在服务器上使用

如何创建可以注册/授权的 Web 服务并将令牌提供给可用于授权的移动客户端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T08:06:21.410

我知道这有点棘手，因为目前还没有很好地访问对流星的 POST 和 GET 请求，我认为它在路线图上，但你可以试试这个。我从另一个[答案借来的](https://stackoverflow.com/questions/11689755/meteorjs-image-upload-conversion)

您可以尝试为特定的 JS 请求创建自定义节点路由。例如

```
__meteor_bootstrap__.app.stack.splice (0, 0, {
route: '/checklogin',
handle: function (req,res, next) {
        username = req.param('username') //req contains POST data
        //Check whether the thing is logged in
        //Other stuff..
        res.send({success:false..}});
    }.future ()
}); 
```

# java - 对话框上的 NullPointerException - Android

> ID：14865147
> 
> 赞同：0
> 
> 时间：2013-02-13T23:21:28.097
> 
> 标签：java, android, dialog, nullpointerexception

我正在尝试实现一个`dialog`在单击按钮时出现的框。由于我以前从未使用过，因此我按照示例获取了以下代码`dialogs`。我在`Results`班上的 2 个不同地点获得了 NPE。我已经在我的代码中评论了这两个地方。

提前感谢您的帮助。

Java代码：

```
public class Results extends Activity {

    Button detailsBtn;
    final Context context = this;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.resultsmain);

        detailsBtn = (Button)findViewById(R.id.detailsBtn);
        detailsBtn.setText("Details");

        detailsBtn.setOnClickListener(new OnClickListener() {
            public void onClick(View arg0) {

                final Dialog dialog = new Dialog(context);
                dialog.setContentView(R.layout.resultsdetailsdisplay);
                dialog.setTitle("Detailssss");

                TextView title = (TextView)findViewById(R.id.title);
                title.setText("TITLE - TESTING");  //NULL POINTER EXCEPTION

                Button close = (Button)findViewById(R.id.close);

                close.setOnClickListener(new OnClickListener() {  //NULL POINTER EXCEPTION
                    public void onClick(View arg0) {
                        dialog.dismiss();
                    }
                });
            }
        });
    }
} 
```

结果详细信息显示.xml：

```
<RelativeLayout 
    xmlns:tools="http://schemas.android.com/tools" 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/scroll" >

    <TextView
        android:id="@+id/title"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textSize="12sp"
        android:layout_centerHorizontal="true"
        android:gravity="center" />
</RelativeLayout> 
```

LogCat 输出

```
02-13 18:36:39.900: E/AndroidRuntime(767): java.lang.NullPointerException
02-13 18:36:39.900: E/AndroidRuntime(767):  at matt.lyons.bibletrivia.Results$4.onClick(Results.java:85)
02-13 18:36:39.900: E/AndroidRuntime(767):  at android.view.View.performClick(View.java:4084)
02-13 18:36:39.900: E/AndroidRuntime(767):  at android.view.View$PerformClick.run(View.java:16966)
02-13 18:36:39.900: E/AndroidRuntime(767):  at android.os.Handler.handleCallback(Handler.java:615)
02-13 18:36:39.900: E/AndroidRuntime(767):  at android.os.Handler.dispatchMessage(Handler.java:92)
02-13 18:36:39.900: E/AndroidRuntime(767):  at android.os.Looper.loop(Looper.java:137)
02-13 18:36:39.900: E/AndroidRuntime(767):  at android.app.ActivityThread.main(ActivityThread.java:4745)
02-13 18:36:39.900: E/AndroidRuntime(767):  at java.lang.reflect.Method.invokeNative(Native Method)
02-13 18:36:39.900: E/AndroidRuntime(767):  at java.lang.reflect.Method.invoke(Method.java:511)
02-13 18:36:39.900: E/AndroidRuntime(767):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
02-13 18:36:39.900: E/AndroidRuntime(767):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
02-13 18:36:39.900: E/AndroidRuntime(767):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:29:23.250

使用对话框对象：

```
TextView title = (TextView) dialog.findViewById(R.id.title); 
```

和

```
Button close = (Button) dialog.findViewById(R.id.close); 
```

[如此处](http://developer.android.com/reference/android/app/Activity.html#findViewById%28int%29)指定： **findViewById** - 从在 onCreate(Bundle) 中处理的 XML 中查找由 id 属性标识的视图。

您的对话框是在事后加载的，因此只有对话框上下文知道这些视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T09:56:04.257

`TextView tv = (TextView)dialog.findViewById(R.id.title);`

`Button close = (Button)dialog.findViewById(R.id.close);`

在上面的 xml 中，您也没有创建`button`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T23:27:05.137

这两个问题都是由相同的方法引起的，`findViewById(R.id.something)`. 由于您尝试从外部类（即`OnClickListener`）引用您的视图，因此您不能`findViewById`直接使用。相反，您可以使用例如，

```
Results.this.findViewById(R.id.title); 
```

希望它有效！

# firefox-addon - 如何更新 Firefox 插件以适应“服务模块”替换？

> ID：14865148
> 
> 赞同：0
> 
> 时间：2013-02-13T23:21:28.860
> 
> 标签：firefox-addon

Mozilla Validator 刚刚向我报告：

> E4X 已弃用/已删除
> 
> 错误：不再可能在大多数上下文之间传递 E4X 对象，包括不同的 chrome 窗口或 JS 模块。E4X 将被 Gecko 20（或可能更早）完全删除。有关更多信息，请参阅 [https://developer.mozilla.org/en-US/docs/E4X](https://developer.mozilla.org/en-US/docs/E4X)。

现在，错误出现在这一行：

```
Components.utils.import("resource://gre/modules/Services.jsm");
const XUL = Namespace("xul", "http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"); 
```

Mozilla Validator 指向一个[页面，该页面建议将此作为解决方案](https://developer.mozilla.org/en-US/docs/E4X)：

> 警告：E4X 已过时。在 Firefox 17 中默认禁用网页（内容），在 Firefox 20 中默认禁用 chrome，并将在 Firefox 21 中删除。请改用 DOMParser/DOMSerializer 或非本机 JXON 算法。

```
var response = xmlhttprequest.responseText; // bug 270553
response = response.replace(/^<\?xml\s+version\s*=\s*(["'])[^\1]+\1[^?]*\?>/, ""); // bug 336551
var e4x = new XML(response); 
```

我在这里有点不合群，不知道该怎么办。任何线索将不胜感激。我该如何使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:35:39.693

啊，是代码串的第二行。

问题出在这里（AMO 编辑之一向我建议）：

```
const XUL = Namespace("xul", "http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"); 
```

定义常量是访问 E4X 对象的内容。我从来没有在我的任何代码中使用过这个常量——它就在那里，因为我在原来的插件示例中看到了它，然后把它复制了过来。

在我删除它之后，验证器不再抱怨。当我提交更新的插件时，它通过并获得了正式批准。

# python - Python，多处理模块，进程类，启动方法失败？启动无限的解释器：|

> ID：14865159
> 
> 赞同：2
> 
> 时间：2013-02-13T23:22:09.170
> 
> 标签：python, multithreading, multiprocessing

此代码启动了无数个进程，随后使我的 PC 崩溃。

```
import multiprocessing

def f(process_name):
    print process_name, 'says hi'

p1 = multiprocessing.Process(None,f,'1',('1st',))
p1.start() 
```

在控制台中，我一遍又一遍地看到“1st say hi”，在任务管理器中，我看到大量的解释器开始运行——我从 PyDev eclipse 和命令行中运行它——结果相同。

我得到的另一个结果是运行了一个 python 解释器（虽然死亡并很快生成另一个解释器），所以我无法在任务管理器中杀死它（句柄无效）。不过，它占用了 100% 的处理器。

我习惯了 java 线程 API，模块 multiprocessing 声称具有与线程模块类似的接口，它是 java 的副本。

为什么进程没有死亡？我缺少什么来简单地让这个产生一个线程，打印这个东西然后消失？

Thx，你们统治！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T23:25:51.613

您需要将初始化代码包装在一个`if __name__ == "__main__":`块中。

`__main__`在 fork 启动新的解释器后，Python 会再次执行您的模块。任何不受此构造保护的东西都将再次执行。这会产生您看到的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:33:46.673

我不相信进程会死，直到你用命令命令它们这样做`myProcess.exit.set()`。我会编辑您的代码，使其看起来像这样：

```
import multiprocessing

def f(process_name):
    print process_name, 'says hi'

p1 = multiprocessing.Process(None,f,'1',('1st',))
p1.start()
p1.exit.set() 
```

不过，我不会在较大的程序中这样做，因为它可能会导致问题。有关详细信息，请参见[此处。](https://stackoverflow.com/questions/1231599/python-multiprocessing-exit-elegantly-how)我还建议访问有关此的[文档](http://docs.python.org/2/library/multiprocessing.html)。

# c# - .NET 数据绑定和内存泄漏

> ID：14865168
> 
> 赞同：1
> 
> 时间：2013-02-13T23:22:51.870
> 
> 标签：c#, .net, winforms, profiler

我的应用程序中有内存泄漏，我找不到真正的来源。在一个名为的控件中有这行代码`DataTableEditor`：

```
refreshButton.DataBindings.Add("Enabled", asyncSqlResultsViewer, "CanRefresh", true, DataSourceUpdateMode.Never); 
```

这`asyncSqlResultsVewer`只是一个`DataGridView`显示数据的用户控件。用于异步加载数据，但现在不再加载。该`DataTableEditor`控件是另一个包含`AsyncSqlResultsVewer`. 泄漏似乎与此有关，因为它显示`PropertyDescriptor`为保持对象活动的路径的一部分：

![.net 内存分析器屏幕截图](../Images/4a852785175d3b1179a91ac032e95a34.png)

我是使用 .NET Memory Profiler 的新手，但问题是，删除上面的行可以消除泄漏。删除绑定`DataBindings.Remove`也可以修复泄漏。但是，这应该发生吗？被`asyncSqlResultsVewer`处置并且据我所知与 一起被取消引用`DataTableEditor`，因此只要没有其他人引用它们中的任何一个（对吗？），它们中的每个引用都不应该让它们继续存在。我仍然可以删除绑定以防万一或作为黑客攻击，但我希望有人帮助我找出泄漏的真正原因是什么。

如果您怀疑这是实际的内存泄漏，应用程序会在打开和关闭几个`DataTableEditor`显示大量数据的 s 后崩溃。此外，分析器告诉我该对象已被处置，但仍有对其的引用。

如果有任何其他信息可以帮助您帮助我解决这个问题，请告诉我。

**编辑：**我想我知道泄漏可能来自哪里。`refreshButton`上面是这个类的一个实例：

```
public class ToolStripBindableButton : ToolStripButton, IBindableComponent, INotifyPropertyChanged
{
    private ControlBindingsCollection dataBindings;

    private BindingContext bindingContext;

    public ControlBindingsCollection DataBindings
    {
        get
        {
            if (dataBindings == null) dataBindings = new ControlBindingsCollection(this);
            return dataBindings;
        }
    }

    public BindingContext BindingContext
    {
        get
        {
            if (bindingContext == null) bindingContext = new BindingContext();
            return bindingContext;
        }
        set { bindingContext = value; }
    }

    public override Image Image
    {
        get { return base.Image; }
        set { SetImage(value); }
    }

    private void SetImage(Image value)
    {
        if (base.Image != value)
        {
            base.Image = value;
            OnPropertyChanged(new PropertyChangedEventArgs("Image"));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        if (PropertyChanged != null) PropertyChanged(this, e);
    }
} 
```

添加`Dispose`覆盖并`dataBindings.Clear()`修复泄漏。这是我应该做的事情还是泄漏的真正原因仍在其他地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T07:03:54.373

我相信您已经自己回答了内存泄漏问题。

在我看来，泄漏的来源似乎很可能是刷新*按钮*（的实例`ToolStripBindableButton`）。

当`ToolStripButton.Dispose()`被调用时，它知道如何清理/释放所有需要的对象。但是它无法知道你是如何扩展类的，因此它不能帮助你清理。

我会期望`ControlBindingsCollection`并`BindingContext`继承`IDisposable`，从而清楚地表明需要进行清理。

```
protected override void Dispose(bool disposing)
{
  base.Dispose(disposing);

  if (disposing && dataBindings != null)
  {
    dataBindings.Clear();
  }
  dataBindings = null;
  dindingContext = null;
  PropertyChanged = null;
} 
```

很难说你是否找到了问题的根源，但我会密切关注任何未以某种方式处理/释放/杀死的事件。

还要密切关注表单上的组件。Theise 只有在使用 IContainer 实例创建时才会自动处理，并且 WinForms 设计者可以选择不这样做。

# javascript - 对如何使用 JScover 感到困惑

> ID：14865170
> 
> 赞同：2
> 
> 时间：2013-02-13T23:23:09.683
> 
> 标签：javascript, jquery, unit-testing, testing

我需要检查我的 Jscript 应用程序中的测试覆盖率。我使用 Qunit 作为单元测试框架。我无法让 Jscover 正常工作。我不明白我应该如何使用它，我应该发出哪个命令以及我必须在路径中指定哪些目录。

这是我的文件系统的结构：

```
JSON/ 
css/
html/
images/  
js/
test/
index.html 
```

我要测试的代码在 js 文件夹中，而 qunit 测试在 test 文件夹中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T23:44:19.113

[您可以在https://github.com/tntim96/JSCover/issues](https://github.com/tntim96/JSCover/issues)将此作为问题发布，但会尝试在此处回答...

如果您通过将浏览器指向 'index.html' 文件来运行测试，并假设它位于目录 'c:/your-test-directory' 中，则可以通过服务器模式运行它。例如：

```
java -jar target/dist/JSCover.jar -ws --branch --document-root=c:/your-test-directory --report-dir=target --no-instrument=test --no-instrument=js/lib 
```

我添加了“--no-instrument=js/lib”来说明如何从检测中排除第三方库，例如 JQuery。

然后将浏览器指向`http://localhost:8080/jscoverage.html?/index.html`

[手册](http://tntim96.github.com/JSCover/manual/manual.xml)中也有更多信息。让我知道你怎么去。

# c++ - 不允许从函数返回函数。我怎么能？

> ID：14865174
> 
> 赞同：5
> 
> 时间：2013-02-13T23:23:29.000
> 
> 标签：c++, function, function-pointers, language-lawyer

`8.3.5/8 Functions [dcl.fct]`说

> [...]**函数不应具有类型**数组或**函数**的返回类型，尽管它们可能具有类型指针或对此类事物的引用的返回类型。[...]

为什么这么明确的规则？是否有一些语法甚至允许返回一个函数而不是函数指针？

我是否误解了报价？

```
typedef void (*fp)();

void foo(){}
fp goo()
{
    return foo; //automatically converted to function pointer
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:38:00.367

这是一个试图返回函数的函数的一个相当人为的例子：

```
void foo() { }

template<typename T>
T f() { return foo; }

int main(){
    f<decltype(foo)>();
} 
```

这是我从 Clang 3.2 得到的错误：

```
Compilation finished with errors:
source.cpp:7:5: error: no matching function for call to 'f'
    f<decltype(foo)>();
    ^~~~~~~~~~~~~~~~
source.cpp:4:3: note: candidate template ignored: substitution failure 
[with T = void ()]: function cannot return function type 'void ()'
T f() { return foo; }
~ ^
1 error generated. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T23:37:33.657

> 是否有一些语法甚至允许返回一个函数而不是函数指针？

语法？当然有：

```
using fun = int (int);

fun function_that_returns_a_function(); 
```

这不会编译，因为 §8.3.5/8 中的规则禁止它。我不知道为什么这个规则特别存在——但考虑到“函数”类型没有任何大小，所以你不能在 C++ 中创建函数类型的对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T23:30:27.130

我知道这可能不能完全回答你的问题，但它部分回答了

您可以从另一个函数返回一个函数（这就是 lambdas）

```
std::function<int (int)> retLambda() {
    return [](int x) { return x; };
} 
```

# c# - UIColor 子类中的工厂方法导致崩溃

> ID：14865179
> 
> 赞同：0
> 
> 时间：2013-02-13T23:23:52.703
> 
> 标签：c#, xamarin.ios, crash, static-methods, uicolor

我正在涉足 Android 的 MonoTouch / Mono，目前正在创建我自己的 UIColor 子类。不知何故，我无法让我的工厂方法以我想要的方式工作（但我确实有一个解决方法）。

以下代码导致我崩溃：

```
using System;

#if ANDROID
// TODO: T.B.I.
#else 
using MonoTouch.UIKit;
#endif

namespace OurCompany.Core
{
    public class Color : UIColor
    {
        public Color (float r, float g, float b, float a) : base(r, g, b, a)
        {
        }

        // our webservice sends color strings in the following ugly format:
        //  0,255,100,1.0
        public static Color FromColorString (string colorString)
        {
            var comps = colorString != null ? colorString.Split (new char[] {','}) : null;
            if (comps == null || comps.Length != 4) {
                return null;
            }

            float r = 0.0f, g = 0.0f, b = 0.0f, a = 1.0f;

            float.TryParse (comps [0], out r);
            float.TryParse (comps [1], out g);
            float.TryParse (comps [2], out b);
            float.TryParse (comps [3], out a);

            return new Color (r, g, b, a);
        }
    }
} 
```

当我将 return 语句更改为以下内容时，我没有遇到任何崩溃：

```
return (Color)UIColor.FromRGBA (
    r > 0 ? r / 255 : 0.0f,
    g > 0 ? g / 255 : 0.0f,
    b > 0 ? b / 255 : 0.0f,
    a
); 
```

此返回语句的主要区别在于创建了一个 UIColor 对象并将其类型转换为一个 Color 对象，而在崩溃版本中，我使用我的参数实例化了一个 Color 对象。以这种方式实例化基类时可能出现问题？我很困惑。

* * *

最后是崩溃的堆栈跟踪：

**堆栈跟踪：**

```
 at (wrapper managed-to-native) MonoTouch.ObjCRuntime.Messaging.IntPtr_objc_msgSendSuper (intptr,intptr) <IL 0x00026, 0xffffffff>
  at MonoTouch.UIKit.UIColor.get_CGColor () [0x00021] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIColor.g.cs:476
  at MonoTouch.UIKit.UIColor.GetRGBA (single&,single&,single&,single&) [0x00000] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIColor.cs:51
  at MonoTouch.UIKit.UIColor.ToString () [0x00000] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIColor.cs:141
  at string.FormatHelper (System.Text.StringBuilder,System.IFormatProvider,string,object[]) [0x00168] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System/String.cs:1890
  at string.Format (System.IFormatProvider,string,object[]) [0x00000] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System/String.cs:1820
  at string.Format (string,object[]) [0x00000] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System/String.cs:1815
  at OurCompany.Core.AppDefaults.ToString () [0x00000] in /Volumes/Development/Mono/OurCompany/OurCompany.Core.Cloned/DL/AppDefaults.cs:78
  at string.FormatHelper (System.Text.StringBuilder,System.IFormatProvider,string,object[]) [0x00168] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System/String.cs:1890
  at string.Format (System.IFormatProvider,string,object[]) [0x00000] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System/String.cs:1820
  at string.Format (string,object) [0x00000] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System/String.cs:1800
  at System.IO.TextWriter.Write (string,object) [0x00000] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System.IO/TextWriter.cs:191
  at System.IO.TextWriter.WriteLine (string,object) [0x00000] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System.IO/TextWriter.cs:305
  at System.IO.SynchronizedWriter.WriteLine (string,object) [0x0000c] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System.IO/TextWriter.cs:598
  at System.Console.WriteLine (string,object) [0x00000] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System/Console.cs:459
  at OurCompany.Core.AppDefaults..ctor (System.IO.MemoryStream) [0x0012b] in /Volumes/Development/Mono/OurCompany/OurCompany.Core.Cloned/DL/AppDefaults.cs:73
  at OurCompany.Core.HomeScreenService/<LoadAppDefaultsAsync>c__AnonStorey2.<>m__2 (byte[],System.Exception) [0x0000f] in /Volumes/Development/Mono/OurCompany/OurCompany.Core.Cloned/SAL/HomeScreenService.cs:47
  at OurCompany.Core.ServiceRequest/<LoadRequestAsync>c__AnonStorey4.<>m__4 (object,System.Net.DownloadDataCompletedEventArgs) [0x00022] in /Volumes/Development/Mono/OurCompany/OurCompany.Core.Cloned/SAL/ServiceRequest.cs:31
  at System.Net.WebClient.OnDownloadDataCompleted (System.Net.DownloadDataCompletedEventArgs) [0x00011] in /Developer/MonoTouch/Source/mono/mcs/class/System/System.Net/WebClient.cs:1388
  at System.Net.WebClient.<DownloadDataAsync>m__D (object) [0x00019] in /Developer/MonoTouch/Source/mono/mcs/class/System/System.Net/WebClient.cs:1037
  at System.Threading.Thread.StartInternal () [0x00032] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System.Threading/Thread.cs:699
  at (wrapper runtime-invoke) object.runtime_invoke_void__this__ (object,intptr,intptr,intptr) <IL 0x0004e, 0xffffffff> 
```

**本机堆栈跟踪：**

```
0   OurCompanyiOS                         0x0009148c mono_handle_native_sigsegv + 284
1   OurCompanyiOS                         0x00005568 mono_sigsegv_signal_handler + 248
2   libsystem_c.dylib                   0x99d7686b _sigtramp + 43
3   ???                                 0xffffffff 0x0 + 4294967295
4   CoreFoundation                      0x012c3ae0 __CFStringAppendFormatCore + 16208
5   CoreFoundation                      0x012bfaab CFStringCreateWithFormatAndArguments + 107
6   CoreFoundation                      0x01348da1 +[NSException raise:format:] + 65
7   UIKit                               0x028f7f34 -[UIColor CGColor] + 82
8   ???                                 0x100a2743 0x0 + 269100867
9   ???                                 0x140ee158 0x0 + 336519512
10  ???                                 0x140edcbc 0x0 + 336518332
11  ???                                 0x140eda18 0x0 + 336517656
12  ???                                 0x0fbf703a 0x0 + 264204346
13  ???                                 0x13e03a8c 0x0 + 333462156
14  ???                                 0x140e9394 0x0 + 336499604
15  ???                                 0x140e90c8 0x0 + 336498888
16  ???                                 0x0fbf703a 0x0 + 264204346
17  ???                                 0x13e03a8c 0x0 + 333462156
18  ???                                 0x13ecd1b0 0x0 + 334287280
19  ???                                 0x13ecd110 0x0 + 334287120
20  ???                                 0x13ecd0a7 0x0 + 334287015
21  ???                                 0x13eccffe 0x0 + 334286846
22  ???                                 0x13eccf68 0x0 + 334286696
23  ???                                 0x13ebb838 0x0 + 334215224
24  ???                                 0x13ebb0c8 0x0 + 334213320
25  ???                                 0x13ea481a 0x0 + 334120986
26  ???                                 0x13ea42e9 0x0 + 334119657
27  ???                                 0x13e167f2 0x0 + 333539314
28  ???                                 0x13e150d7 0x0 + 333533399
29  ???                                 0x0fbf4070 0x0 + 264192112
30  OurCompanyiOS                         0x00009922 mono_jit_runtime_invoke + 722
31  OurCompanyiOS                         0x0016c4ae mono_runtime_invoke + 126
32  OurCompanyiOS                         0x0016c61c mono_runtime_delegate_invoke + 140
33  OurCompanyiOS                         0x001a7522 start_wrapper + 466
34  OurCompanyiOS                         0x001d94ba thread_start_routine + 154
35  OurCompanyiOS                         0x002008ad GC_start_routine + 93
36  libsystem_c.dylib                   0x99d8a557 _pthread_start + 344
37  libsystem_c.dylib                   0x99d74cee thread_start + 34

=================================================================
Got a SIGSEGV while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries 
used by your application.
================================================================= 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T05:15:45.677

好吧，我意识到我做错了什么，我应该更清楚地检查错误消息。

我的 AppDefaults 类具有以下 ToString() 方法（由 MonoDevelop 自动完成，并且可能仍然依赖于我之前的`UIColor`实现）：

```
public override string ToString ()
{
    return string.Format ("[AppDefaults: name={0}, appId={1}, userId={2}, themeId={3}, parallaxEnabled={4}, themeModifyDate={5}, tabBarColor={6}, tabColor={7}, backButtonColor={8}]", name, appId, userId, themeId, parallaxEnabled, themeModifyDate, tabBarColor, tabColor, backButtonColor);
} 
```

错误消息还显示了尝试为颜色类写入字符串值时发生错误的提示：

```
at MonoTouch.UIKit.UIColor.GetRGBA (single&,single&,single&,single&) [0x00000] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIColor.cs:51
at MonoTouch.UIKit.UIColor.ToString () [0x00000] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIColor.cs:141
at string.FormatHelper (System.Text.StringBuilder,System.IFormatProvider,string,object[]) [0x00168] in /Developer/MonoTouch/Source/mono/mcs/class/corlib/System/String.cs:1890 
```

所以最终修复很简单：`ToString()`从类中禁用我的方法。我讨厌我在这个明显的错误上浪费了 6 个小时，但是在使用新框架时总是会发生这样的事情......

**编辑：**也许我也可以`ToString()`在我的自定义 Color 子类中覆盖我的方法，尽管这本身似乎并不能防止崩溃。我确实意识到如果某个随机的人会使用此代码，我需要防止将来发生这种崩溃。

**编辑 2：**查看崩溃日志，似乎初始化可能无法正常工作。我看到很多`null`值（0x000 ....）。调用 GetRGBA() 时出现问题。也许我需要重写`UIColor`基类的一些成员才能使这个方法起作用？我可以想象在我的自定义类而不是基类`GetRGBA()`上被调用，导致失败。`Color``UIColor`

**编辑 3：**这个人可能为我的问题选择了更好的方法。也许这将是我需要的修复：

[http://codebetter.com/petervanooijen/2010/09/28/monotouch-drawing-an-image-pixel-by-pixel/](http://codebetter.com/petervanooijen/2010/09/28/monotouch-drawing-an-image-pixel-by-pixel/)

**编辑4：**我决定根据最后一个链接重构我的代码。我的自定义颜色类将存储颜色的属性，并有 1 个或多个方法来创建本机颜色对象（例如 iOS 上的 UIColor，Android 上的相应颜色对象）。

# c++ - 什么属于“面向数据的设计”？

> ID：14865180
> 
> 赞同：2
> 
> 时间：2013-02-13T23:23:55.497
> 
> 标签：c++, c, performance, optimization, latency

[此Sony Research 文档](http://research.scee.net/files/presentations/gcapaustralia09/Pitfalls_of_Object_Oriented_Programming_GCAP_09.pdf)和[此文档](http://dice.se/wp-content/uploads/Introduction_to_Data-Oriented_Design.pdf)最正式地介绍了 Data Oriented Design 。

然而，除了显而易见的，我想知道编程的其他方面属于“面向数据的设计”吗？SIMD/SSE 指令？有什么可以减少 TLB 未命中的方法吗？还是 CPU 亲和性？

到目前为止，我对 DOD 的唯一理解是“减少缓存未命中的任何东西”。有什么不明显的东西属于面向数据的设计吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-27T14:13:17.333

对我来说显而易见的是，国防部是关于以数据为中心的设计。在上下文中更多地看到它。我对它的对应部分 OOD 有着明显的第一印象。面向对象正在将您的解决方案建模为现实世界模型。Wich 很好，因为它更容易理解。但是你的硬件不喜欢这样。面向数据就是以数据为中心。平台喜欢它的方式。

SMID, Cache line 是平台的一些细节。但是除了缓存行之外，还有更多内容。

面向数据使并发编程比 OoD 方式更容易。OOD 对人类更加友好。因为每个人都知道现实世界。国防部您需要更多地了解该平台，以便对数据进行建模以获得最佳性能。还有你对这些数据进行的转换。

DOD 是关于，了解平台并了解问题领域。与国防部一起充分利用它。

# iphone - iphone推送通知触发方法

> ID：14865182
> 
> 赞同：1
> 
> 时间：2013-02-13T23:24:30.243
> 
> 标签：iphone, ios, apple-push-notifications, background-process

我不像项目经理那样是开发人员，如果以下内容可以帮助我决定项目的未来，我需要了解更多。主要是我的问题是，我可以使用推送通知在我的应用程序中触发某个方法（功能）吗？所以我的应用程序可能在后台（或不在后台），我想发送一条推送通知消息来唤醒应用程序并执行一些代码。如果答案是肯定的，这可以在没有用户交互的情况下完成吗？所以我的意思是没有用户点击推送消息？是某种自动化，所以我发送推送通知消息，iPhone 接收它并执行代码，没有使用交互？如果需要，我可以设置自己的 APNS 服务器。我不是在寻找代码，而是在寻找答案是否可以完成。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:19:04.683

是的，这是可能的，只要用户点击通知。这可以通过本地通知或推送通知来完成。

当应用程序响应通知而启动时，该`AppDelegate`方法`application:didFinishLaunchingWithOptions:`将有一个选项指示促成启动的通知。

据我所知，如果没有用户交互，它就无法实现。

# localization - django-cms 中最好的 apphooks 多语言库是什么？

> ID：14865189
> 
> 赞同：1
> 
> 时间：2013-02-13T23:25:18.797
> 
> 标签：localization, django-cms

我正在寻找使用 django-cms 解决多语言网页问题的最佳解决方案。Django-cms 内置了多语言并且运行良好。现在我准备自己的应用程序。我将通过 apphook 将这个应用程序与 django-cms 连接起来。我需要一些聪明的想法来将语言放入我的应用程序中。最好的解决方案是在我的应用程序中使用与 langs 相同的选项卡，就像在 django-cms 页面中一样。我喜欢这个 cms 的解决方案，但我不知道该怎么做。你有什么想法吗？

* * *

好的，我看到我的问题减一分，我不明白为什么。我做了很多研究。我正在尝试 transmeta，这不是我所期望的，django-multilingual 错误：

```
multilingual/templatetags/multilingual_tags.py in reorder_translation_formset_by_language_id, line 82 
```

不支持多语言-ng。

在 djangopackages.com 中，我发现了很多库，我正在考虑这个 django-modeltranslation，但我仍然在寻找与 django-cms 最相似的最佳解决方案——这个选项卡看起来很酷。如果有人可以帮助我，如果你能给我一些建议，我会很高兴。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T12:50:13.877

[https://github.com/KristianOellegaard/django-hvad](https://github.com/KristianOellegaard/django-hvad)

与 django CMS 的联系非常紧密，因此它很可能会工作并继续工作。

# openlayers - OpenLayers.Protocol.HTTP 中的“TypeError: this.options is null”‏

> ID：14865195
> 
> 赞同：1
> 
> 时间：2013-02-13T23:26:13.050
> 
> 标签：openlayers, javascript

我将 OL 2.11 与 GeoExt 1.1 一起使用。在测试和修改此 GeoExt 示例：[http](http://geoext.org/lib/GeoExt/widgets/form/FormPanel.html) ://geoext.org/lib/GeoExt/widgets/form/FormPanel.html 后，我在销毁和读取新协议时遇到问题，我收到“TypeError: this.options is null HTTP.js（第 180 行）”在 firebug 中。我从第 180 行了解到的是新选项（在新协议中）不存在，不确定这是否是问题以及如何解决。这是原始协议（在 FormPanel 之外创建）：

```
protocol = new OpenLayers.Protocol.HTTP({
    url: '/fs/',
    format: new OpenLayers.Format.GeoJSON({
        ignoreExtraDims: true,
        'internalProjection': new OpenLayers.Projection('EPSG:900913'),
        'externalProjection': new OpenLayers.Projection('EPSG:4326')
    })
}); 
```

这是创建新协议的 FormPanel 末尾的代码：

```
 buttons: [{
        text: 'Search',
        handler: function() {

            comboLayer = Ext.getCmp('idcombo').getValue();
            keyword = Ext.getCmp('idtextfield').getRawValue();

            protocol.destroy();

            protocol = new OpenLayers.Protocol.HTTP({
                url: '/fs/' + comboLayer + '?format=GeoJSON&comments__ilike=' + keyword + '&queryable=comments',
                format: new OpenLayers.Format.GeoJSON({
                    ignoreExtraDims: true,
                    'internalProjection': new OpenLayers.Projection('EPSG:900913'),
                    'externalProjection': new OpenLayers.Projection('EPSG:4326')
                })
            });

            protocol.read();

            formPanel.search();
        }
    }] 
```

在我删除“protocol.destroy();”的情况下，原始协议和新协议都被发送，但总是在新协议之后发送原始协议，这是因为请求是 AJAX 吗？原件之后可以寄新的吗？

我会感谢一些支持，在此先感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T16:17:31.050

解决方案是只使用“protocol.options.url = newUrl;” 而不是protocol.destroy()；或者protocol.read();，完整的解释在[这里](https://stackoverflow.com/questions/14664759/how-can-i-overwrite-the-url-of-openlayers-protocol-http)

# sql - 改进 SQL Server 查询以将任意表转换为 JSON

> ID：14865199
> 
> 赞同：8
> 
> 时间：2013-02-13T23:26:30.497
> 
> 标签：sql, sql-server, json, converter

经过大量搜索和拼凑使用 Web 上的 FOR XML 和 .nodes() 命令转换结果集的非常出色的技术后，我能够创建这个单一的查询（不是存储过程），它可以合理地执行将任意 SQL 查询转换为 JSON 数组的工作做得很好。

该查询会将每个数据行编码为带有前导逗号的单个 JSON 对象。数据行用括号括起来，然后整个结果集将被导出到一个文件中。

我想看看是否有人可以看到提高其性能的方法？

这是带有示例表的查询：

```
declare @xd table (col1 varchar(max), col2 int, col3 real, colNull int) 

insert into @xd 
select '', null, null, null
UNION ALL select 'ItemA', 123, 123.123, null
UNION ALL select 'ItemB', 456, 456.456, null
UNION ALL select '7890', 789, 789.789, null

select '[{}'
UNION ALL
select ',{' + STUFF((
    (select ','
        + '"' + r.value('local-name(.)', 'varchar(max)') + '":'
        + case when r.value('./@xsi:nil', 'varchar(max)') = 'true' then 'null'
        when isnumeric(r.value('.', 'varchar(max)')) = 1
            then r.value('.', 'varchar(max)')
        else '"' + r.value('.', 'varchar(max)') + '"'
        end
    from rows.nodes('/row/*') as x(r) for xml path(''))
    ), 1, 1, '') + '}'
from (
    -- Arbitrary query goes here, (fields go where t.* is, table where @xd t is)
    select (select t.* for xml raw,type,elements XSINIL) rows
    from @xd t
) xd
UNION ALL
select ']' 
```

我对它最大的批评是它非常缓慢。
目前大约需要 3:30 处理约 42,000 行。

我的另一个重大批评是，它目前假设所有看起来像数字的东西都是数字。它至少不会尝试发现列类型（我什至不确定它是否可以）。

最后一个小批评是第一个数据行前面会有一个逗号，从技术上讲它不应该。为了弥补这一点，它需要在启动 JSON 数组的第一行中使用空 JSON 对象。

邀请了其他批评（最好是解决方案），我唯一真正的限制是该解决方案在许多任意 SQL 查询上都可以很好地重复，而无需显式识别列名。

我正在使用 SQL Server 2012。

感谢并感谢像我这样正在寻找通用 SQL 结果-> JSON 数组转换器的其他人，享受吧！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-14T04:32:58.070

我说如果你真的想提高性能，请使用元编程。下面的示例对 40,000 行进行了尝试，并在不到一秒的时间内返回结果（不包括插入最初的 40k 行，在本示例中只需要大约 2 秒）。它还考虑到您的数据类型，不要将数字括在引号中。

```
declare @xd table (col1 varchar(max), col2 int, col3 real, colDate datetime, colNull int);

declare @i int = 0;

while @i < 10000 begin
    set @i += 1;
    insert into @xd
    select '', null, null, null, null
    union all select 'ItemA', 123, 123.123, getDate(), null
    union all select 'ItemB', 456, 456.456, getDate(), null
    union all select '7890', 789, 789.789, getDate(), null;
end;

select *
into #json_base
from (
    -- Insert SQL Statement here
    select * from @xd
) t;

declare @columns table (
    id int identity primary key,
    name sysname,
    datatype sysname,
    is_number bit,
    is_date bit);

insert into @columns(name, datatype, is_number, is_date)
select columns.name, types.name,
       case when number_types.name is not NULL
            then 1 else 0
       end as is_number,
       case when date_types.name is not NULL
            then 1 else 0
       end as is_date
from tempdb.sys.columns
join tempdb.sys.types
    on (columns.system_type_id = types.system_type_id)
left join (values ('int'), ('real'), ('numeric'),
                  ('decimal'), ('bigint'), ('tinyint')) as number_types(name)
    on (types.name = number_types.name)
left join (values ('date'), ('datetime'), ('datetime2'),
                  ('smalldatetime'), ('time'), ('datetimeoffset')) as date_types(name)
    on (types.name = date_types.name)
where object_id = OBJECT_ID('tempdb..#json_base');

declare @field_list varchar(max) = STUFF((
    select '+'',''+' + QUOTENAME(QUOTENAME(name, '"') + ':', '''')
           + '+' + case when is_number = 1
                        then 'COALESCE(LTRIM('
                                + QUOTENAME(name) + '),''null'')'
                        when is_date = 1
                        then 'COALESCE(QUOTENAME(LTRIM(convert(varchar(max), '
                                + QUOTENAME(name) + ', 126)),''"''),''null'')'
                        else 'COALESCE(QUOTENAME('
                                + QUOTENAME(name) + ',''"''),''null'')'
                   end
    from @columns
    for xml path('')),
    1, 5, '');

create table #json_result (
    id int identity primary key,
    line varchar(max));

declare @sql varchar(max) = REPLACE(
    'insert into #json_result '
  + 'select '',{''+{f}+''}'' '
  + 'from #json_base', '{f}', @field_list);

exec(@sql);

update #json_result
set line = STUFF(line, 1, 1, '')
where id = 1;

select '['
UNION ALL
select line
from #json_result
UNION ALL
select ']';

drop table #json_base;
drop table #json_result; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T04:36:08.970

来自[Firoz Ansari](http://firozansari.com/2008/11/21/generating-json-from-tsql-query/)：

```
CREATE PROCEDURE [dbo].[GetJSON] (
@ParameterSQL AS VARCHAR(MAX)
)
AS
BEGIN

DECLARE @SQL NVARCHAR(MAX)
DECLARE @XMLString VARCHAR(MAX)
DECLARE @XML XML
DECLARE @Paramlist NVARCHAR(1000)
SET @Paramlist = N'@XML XML OUTPUT'
SET @SQL = 'WITH PrepareTable (XMLString) '
SET @SQL = @SQL + 'AS ( '
SET @SQL = @SQL + @ParameterSQL+ ' FOR XML RAW, TYPE, ELEMENTS '
SET @SQL = @SQL + ') '
SET @SQL = @SQL + 'SELECT @XML = XMLString FROM PrepareTable '
EXEC sp_executesql @SQL, @Paramlist, @XML=@XML OUTPUT
SET @XMLString = CAST(@XML AS VARCHAR(MAX))

DECLARE @JSON VARCHAR(MAX)
DECLARE @Row VARCHAR(MAX)
DECLARE @RowStart INT
DECLARE @RowEnd INT
DECLARE @FieldStart INT
DECLARE @FieldEnd INT
DECLARE @Key VARCHAR(MAX)
DECLARE @Value VARCHAR(MAX)

DECLARE @StartRoot VARCHAR(100); SET @StartRoot = ''
DECLARE @EndRoot VARCHAR(100); SET @EndRoot = ''
DECLARE @StartField VARCHAR(100); SET @StartField = ''

SET @RowStart = CharIndex(@StartRoot, @XMLString, 0)
SET @JSON = ''
WHILE @RowStart &gt; 0
BEGIN
    SET @RowStart = @RowStart+Len(@StartRoot)
    SET @RowEnd = CharIndex(@EndRoot, @XMLString, @RowStart)
    SET @Row = SubString(@XMLString, @RowStart, @RowEnd-@RowStart)
    SET @JSON = @JSON+'{'

    -- for each row
    SET @FieldStart = CharIndex(@StartField, @Row, 0)
    WHILE @FieldStart &gt; 0
    BEGIN
        -- parse node key
        SET @FieldStart = @FieldStart+Len(@StartField)
        SET @FieldEnd = CharIndex(@EndField, @Row, @FieldStart)
        SET @Key = SubString(@Row, @FieldStart, @FieldEnd-@FieldStart)
        SET @JSON = @JSON+'"'+@Key+'":'

        -- parse node value
        SET @FieldStart = @FieldEnd+1
        SET @FieldEnd = CharIndex('0 SET @JSON = SubString(@JSON, 0, LEN(@JSON))
    SET @JSON = @JSON+'},'
    --/ for each row

    SET @RowStart = CharIndex(@StartRoot, @XMLString, @RowEnd)
END
IF LEN(@JSON) > 0 SET @JSON = SubString(@JSON, 0, LEN(@JSON))
SET @JSON = '[' + @JSON + ']'
SELECT @JSON
END 
```

# sql-server - 将存储过程提交到 SVN 存储库

> ID：14865200
> 
> 赞同：6
> 
> 时间：2013-02-13T23:26:35.607
> 
> 标签：sql-server, svn, ssms

我当前的 C# 项目开发环境是 Visual Studio，带有 SQL Server 数据库并使用 VisualSVN 连接到我的 SVN 存储库。为了管理我的存储过程、视图等的修订，我将`ALTER`脚本保存到我的 SVN 客户端监视的文件夹中，以便将它们包含在存储库中。

我已经查看了一些（现在较旧的）帖子，比如这篇文章（[如何在 SVN/Other 存储库中保留存储过程和其他脚本？](https://stackoverflow.com/questions/51288/how-to-keep-stored-procedures-and-other-scripts-in-svn-other-repository)以及[SQL Server Management Studio 2005 或 2008 是否有 SVN 插件？](https://stackoverflow.com/questions/1716360/is-there-a-svn-plugin-for-sql-server-management-studio-2005-or-2008)）并看到了关于这些工具：[http](http://www.red-gate.com/products/sql-development/sql-source-control/) ://www.red-gate.com/products/sql-development/sql-source-control/和[http://www.zeusedit.com/agent/ssms/ms_ssms.html](http://www.zeusedit.com/agent/ssms/ms_ssms.html)。

由于我很少与进行大量 DB 端编程的项目一起工作，这从来都不是一个大麻烦（一个文件夹中的十几个脚本具有一些命名方案并不能手动管理），但我刚刚继承了一个有几百个的项目从未包含在版本控制中的视图和 1000 多个存储过程。

我的问题是：

其他人遵循什么流程来管理他们的 SQL Server 代码的版本控制——我在这里缺少一种可接受的、*聪明的或其他明显的方法吗？*我目前倾向于购买上述工具之一 - 但在我这样做之前正在寻求社区的建议。

*我意识到这可能会导致工具推荐而不是代码解决方案，但会发布到 SO，因为我认为这是提出这个问题的合适人群。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:58:57.007

我建议您使用 redgate 工具之类的工具，并以与处理 C# 源代码相同的方式处理任何 SQL 数据库；随着修改数量的增加，手动跟踪 ALTER 语句会让你更晚或更晚。不能代表 zeus 编辑工具，但使用了 redgate 工具，它“正常工作” - 以及使用的另一个好处像这样的工具是它可以管理您的迁移脚本，因此您可以对您的开发版本进行大量更改，然后生成一个更新脚本来更新您的测试数据库等，包括数据更改，恕我直言，这是手动管理的最大 PITA .

要考虑的另一件事是，即使更改的数量很少，并且您可以手动跟踪 ALTER 语句，但如果其他人最终在同一个项目上工作怎么办？现在你有另一个管理不善的更改脚本的可能性....

无论如何，请让我们知道您的进展情况并祝您好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:03:21.290

我一直在维护一个包含大约 800 多个 db 对象的数据库。正如您所描述的，我们一直只是将数据库对象编写到一个 svn-watched 文件夹中。我们在使用这种方法时遇到了一些问题，主要是人们忘记编写新的或修改过的对象的脚本。归根结底，这对我们的项目来说并不是什么大问题，但您的问题可能会有所不同。

我们研究了几个工具，但它们总是假设您是从零开始，我们想要保留将近 10 年的历史。最后，我们最终还是回到了我们基于文本的手动解决方案。它既便宜又容易。

您可能想要研究的另一个选项是设置 Visual Studio 数据库项目。它将编写所有对象的脚本并提供一些部署选项。我的观点是，过于紧密地集成到我们的口味是很累的——我们有一些对链接数据库的命名引用，它就是不会放弃的。

# wpf - 如何让 VisualBrush 在 Xaml 中填充其容器？

> ID：14865202
> 
> 赞同：1
> 
> 时间：2013-02-13T23:26:40.860
> 
> 标签：wpf, xaml

我有用于搜索的文本框，我希望在其中包含提示文本以提示用户进行搜索以及放大镜图标。我正在使用一种`VisualBrush`样式，我想要最左边的标签和最右边的图像，但我无法获得`VisualBrush`填充整个文本框的内容。它们要么在左边粘在一起，要么在右边粘在一起，这取决于我`AlignmentX`在`VisualBrush`. 我尝试过使用`StackPanel`, `DockPanel`，`Grid`但它们都不会填满整个文本框，让我在文本框的两端都有元素。

```
<VisualBrush x:Key="CueBannerBrush"
             AlignmentX="Left"
             AlignmentY="Center"
             Stretch="None">
  <VisualBrush.Visual>
    <DockPanel HorizontalAlignment="Stretch">
      <Label Content="Begin typing to search"
             Foreground="LightGray"
             DockPanel.Dock="Left" />
      <Image Source="/WPF;component/Icons/32/Modern3D/objects/magnifier.png"
             Height="20"
             DockPanel.Dock="Right" />
    </DockPanel>
  </VisualBrush.Visual>
</VisualBrush> 
```

产生这个输出：

![在此处输入图像描述](../Images/ccd0b8cf23386bcb72c48abaecf5f111.png)

关于如何让画笔的孩子填充整个文本框并将提示文本与放大镜图标分开的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:44:10.627

您可以将其包装在 a 中`Grid`，并为每个项目（标签、图像）创建正确的列大小，然后您可以`VisualBrush` `width`将`Texbox` `ActualWidth`.

```
<VisualBrush x:Key="CueBannerBrush"
             AlignmentX="Left"
             AlignmentY="Center"
             Stretch="None">
  <VisualBrush.Visual>
    <Grid Width="{Binding Path=ActualWidth, RelativeSource={RelativeSource FindAncestor, AncestorType=TextBox}}">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="163*" />
        <ColumnDefinition Width="26" />
      </Grid.ColumnDefinitions>
      <Label Content="Begin typing to search"
             Foreground="LightGray"
             Grid.Column="0" />
      <Image Source="http://icons.iconarchive.com/icons/awicons/vista-artistic/24/search-icon.png"
             Height="20"
             Grid.Column="1" />
    </Grid>
  </VisualBrush.Visual>
</VisualBrush> 
```

结果：

![在此处输入图像描述](../Images/43cc7db2eb925b34e5c62fb4bc9f5f92.png)

# python - Django Javascript 输出

> ID：14865204
> 
> 赞同：0
> 
> 时间：2013-02-13T23:26:47.353
> 
> 标签：python, django, google-maps-api-3

我正在尝试呈现由包含 JS 代码的 python 谷歌地图库生成的 html 输出。我正在传递使用 html_map 变量显示谷歌地图的部分，如下所示：

```
html = t.render(Context({'html_map':html_map}))
return HttpResponse(html) 
```

但是，页面不显示地图，而是显示js代码（即直接打印它）。下图显示了这一点：

![输出](../Images/a2f87cbfe0591e589a25258f7328c4db.png)

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:34:20.253

```
html = t.render(Context({'html_map':html_map}))
return HttpResponse(html) 
```

在模板中使用：

```
{{ htm_map|safe }} 
```

# java - 二进制到十进制转换 Java 代码错误

> ID：14865207
> 
> 赞同：0
> 
> 时间：2013-02-13T23:27:26.463
> 
> 标签：java

所以我正在做一个项目，我必须将二进制数转换为小数等。这是我到目前为止的代码，并且有一个错误。在像 1101 这样的二进制数中，假设输出的十进制数是 13，但从代码中输出的数字是 11。这个错误发生在所有以一串 1 开头并且像单个 0 的二进制数上。

```
import java.util.*; // imports everything in java.util

public class newCalculator{

   * Conversion asks the user for a binary number.  It converts the input to a decimal number
   * using arrays and then displays the answer to the screen.
  */

  public static void main (String[]args){ // creates the main method
  binaryToDecimal(); //calls the user defined method binaryToDecimal
  }

  public static void binaryToDecimal() {
    Scanner scan = new Scanner(System.in); // Creates a new Scanner
    System.out.println("Input a Binary Number"); // Asks the user to input their number
    String binary = scan.next(); // Creates a new String that stores the value of the input
    char[] charArray = binary.toCharArray(); //Create a new Array and implements in the input
    double answer = 0;  // Creates a new double called answer setting it to zero
    for (double index = 0; index < charArray.length; index++){//For loop
      if (charArray[(int)index] == '1') {//If statement that allows the binary input to work
        answer = answer + Math.pow(2.0, index);//Sets the answer with the math class power of 2
      }
    }
    System.out.println(answer);//Prints out the final conversion result
     /* Test Cases   Expected Result   Output
   * 101                 5             5
   * 11                  3             3
   * 1                   1             1
   * 1101                13            11<--
   * 111                 7             7
   * 1000001             65            65
   * 1111                15            15
   * 1001                9             9
   * 11101               29            23<--
   * 10101               21            21
   * 
   */
  }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:31:09.677

正在计算您的预期结果，就好像从右到左读取二进制字符串一样；但是，您的代码正在从左到右读取二进制字符串。

改变这个：

```
for (double index = 0; index < charArray.length; index++){ 
```

对此：

```
for (double index = charArray.length - 1; index >= 0; index--) { 
```

您还应该更改为使用整数作为索引，如下所示：

```
for (int index = charArray.length - 1; index >= 0; index--) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-29T02:44:55.067

```
package pdaproject;
import java.util.Scanner;
public class NewCalc {

    public static void main(String[] args) {
        binaryToDecimal();
    } 
    // convert to decimal (base 10)
    public static void binaryToDecimal() {
        Scanner scan = new Scanner(System.in);
        System.out.println("Input a Binary Number");
        String binary = scan.next();
        int answer = 0;
        // process left to right
        for (int i = 0; i < binary.length(); i++) {
            answer = 2 * answer + (binary.charAt(i) == '1' ? 1 : 0);
        }
        System.out.println(answer);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T23:31:31.857

你正在以错误的顺序浏览你的位。您的第一个索引指的是最高有效位，而不是最低有效位。

您对 Math.pow 的调用应该是

```
answer = answer + Math.pow(2.0, (charArray.length - index - 1)); 
```

正如 Tom Leese 已经指出的那样，请使用整数作为循环索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T23:43:46.350

对称就是答案。如果您查看所有测试输入，它们都是对称的，除了 `1101`

您的算法是正确的，除了您需要使用 的不是`index`in ，而是正确的实现（实际上只有很小的增量更改）`Math.pow``Math.pow(2.0, charArray.length - i - 1)`

```
import java.util.Scanner;

public class NewCalc {

    public static void main(String[] args) {
        binaryToDecimal();
    }

    public static void binaryToDecimal() {
        Scanner scan = new Scanner(System.in);
        System.out.println("Input a Binary Number");
        String binary = scan.next();
        char[] charArray = binary.toCharArray();
        double answer = 0;
        for (int i = 0; i < charArray.length; i++) {
            answer = charArray[i] == '1'
                    ? answer + Math.pow(2.0, charArray.length - i - 1)
                    : answer;
        }
        System.out.println(answer);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-08T19:20:43.410

```
 public class BinaryToDecimal {
    static int testcase1=1001;
    public static void main(String[] args) {
        BinaryToDecimal test = new BinaryToDecimal();
        int result = test.convertBinaryToDecimal(testcase1);
        System.out.println(result);
    }

    //write your code here
    public int convertBinaryToDecimal(int binary)
    {
        int deci = 0;
        int p=1;
        int rem = 0;
        while(binary>0)
        {
            rem = binary%10;
            deci = deci+(rem*p);
            p = p*2;
            binary = binary/10;
        }

        return deci;
    }

} 
```

# mysql - MySQL 别名帮助 ERROR 1054 (42S22)

> ID：14865211
> 
> 赞同：2
> 
> 时间：2013-02-13T23:28:27.047
> 
> 标签：mysql, syntax-error

我将保持简短和简单。我想执行这个查询：

```
mysql> SELECT ORDER_NUM, NUM_ORDERED * QUOTED_PRICE AS TOTAL_AMOUNT
    -> FROM ORDER_LINE
    -> WHERE TOTAL_AMOUNT > '1000'
    -> ORDER BY ORDER_NUM;
ERROR 1054 (42S22): Unknown column 'TOTAL_AMOUNT' in 'where clause' 
```

我确定这很简单，但我不明白为什么使用别名 TOTAL_AMOUNT 不起作用。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:30:37.873

尝试这个

```
mysql> SELECT ORDER_NUM, NUM_ORDERED * QUOTED_PRICE AS TOTAL_AMOUNT
-> FROM ORDER_LINE
-> WHERE NUM_ORDERED * QUOTED_PRICE > '1000'
-> ORDER BY ORDER_NUM; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:37:05.870

检查该星号是否没有给您带来问题，或者您是否缺少逗号，如果这不起作用，请将别名括在重音符号之间，如下所示：

```
... QUOTED_PRICE AS `TOTAL_AMOUNT`... 
```

# c - 将 unsigned long 转换为 char *

> ID：14865212
> 
> 赞同：0
> 
> 时间：2013-02-13T23:28:28.043
> 
> 标签：c

所以我有这个功能：

```
static void doPrint (const char *s)
{
    write (STDOUT_FILENO, s, strlen(s));
} 
```

我正在尝试向它传递一个无符号长变量，但到目前为止我没有尝试过任何工作。我的问题是，我该怎么做呢？我正在考虑使用类似 _ultoa_s 或其他类似功能的东西。

有任何想法吗？谢谢

注意：对 printf、sprintf 等的访问受到限制

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:35:54.590

您可以尝试将指针传递给 long 变量并将大小传递给您的`doPrint`函数，如下所示

```
doPrint((char *)(&someLongVariable), sizeof(someLongvariable));

void doPrint(char *inpString, int size)
{
     write (STDOUT_FILENO, inpString, size);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:38:43.900

几乎可以肯定你不想将 a 传递`double`给这个函数。它期望输出文本，这是`stdout`.

几乎可以肯定，您首先需要用字符表示双精度值并将其传递给函数。这是一个复杂的话题，也可能是练习的重点。谷歌[“将浮点数转换为 ascii”](https://www.google.com/#hl=en&sugexp=les;&gs_rn=3&gs_ri=psy-ab&gs_mss=convert%20float%20to%20as&tok=o7gLcbJq5nSIhWArpUyxPQ&cp=21&gs_id=bu&xhr=t&q=convert+float+to+ascii&es_nrs=true&pf=p&safe=off&tbo=d&output=search&sclient=psy-ab&oq=convert+float+to+asii&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.&bvm=bv.42452523,d.cGE&fp=a04951e09a4959a8&biw=1280&bih=674)以了解您必须做什么的一些想法。

* * *

跟进：

如果您被允许使用`_ultoa_s`，那么您当然可以调用[`fcvt()`或`ecvt()`](http://linux.about.com/library/cmd/blcmdl3_fcvt.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T23:42:28.990

您没有提到“受限”是否意味着您的（嵌入式？）平台上不提供简单的功能（printf 和朋友），或者这是对分配的限制。

无论如何，你所做的永远不会奏效。您正在传递一个二进制变量（长），它不会自动转换为字符串。

看看这个函数，在[这里](http://code.google.com/p/my-itoa/)找到，一个紧凑的 itoa 函数。制作 ltoa 需要进行一些调整，但很容易看出它是如何工作的。

```
//return the length of result string. support only 10 radix for easy use and better performance
int my_itoa(int val, char* buf)
{
    const unsigned int radix = 10;

    char* p;
    unsigned int a;        //every digit
    int len;
    char* b;            //start of the digit char
    char temp;
    unsigned int u;

    p = buf;

    if (val < 0)
    {
        *p++ = '-';
        val = 0 - val;
    }
    u = (unsigned int)val;

    b = p;

    do
    {
        a = u % radix;
        u /= radix;

        *p++ = a + '0';

    } while (u > 0);

    len = (int)(p - buf);

    *p-- = 0;

    //swap
    do
    {
        temp = *p;
        *p = *b;
        *b = temp;
        --p;
        ++b;

    } while (b < p);

    return len;
} 
```

# clojure - 使用 clojure.walk 深度优先索引任何 Clojure 表单

> ID：14865213
> 
> 赞同：8
> 
> 时间：2013-02-13T23:28:35.567
> 
> 标签：clojure

给定以下树（或 Clojure 中的任何其他形式，包括映射和向量）：

```
'( (a b) (c d) ) 
```

我想在 Clojure 中生成一个映射，该映射根据整个表单的深度优先遍历对每个子表单进行索引，并提供表单子项（如果有）索引的向量（或列表）。

```
0 -> a []
1 -> b []
2 -> (a b) [0 1]
3 -> c []
4 -> d []
5 -> (c d) [3 4]
6 -> ( (a b) (c d) ) [2 5] 
```

到目前为止，我只设法使用**clojure.walk**来生成第一部分（索引子表单），但我对如何生成孩子的索引也感到困惑。我的代码附加在最后并产生：

```
user=> (depthFirstIndexing '( (a b) (c d) ))
{6 ((a b) (c d)), 5 (c d), 4 d, 3 c, 2 (a b), 1 b, 0 a} 
```

因此，子表单的索引是根据深度优先遍历正确生成的，但我不知道如何获得每个子表单的子表单的索引。我尝试使用 zippers 模块，但看不到如何执行深度优先遍历来收集索引。

## 中途代码

```
(use 'clojure.walk)
(defn depthFirstIndexing [aform]
  (let [counter       (atom -1)
        idxToSubform  (atom {})
        ]
    (postwalk (fn [x]
                (def idx (swap! counter inc))
                (swap! idxToSubform assoc idx x)
                x)
    aform)
  @idxToSubform)) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T04:04:36.390

A`walk`是递归的，不提供累加器参数，这就是为什么你不得不求助于更新原子的原因。

A`zipper`是迭代的，因此您可以在不破坏功能模式的情况下携带其他信息。

自然的深度优先遍历是前序遍历，但是你是在后序遍历之后，所以这需要一些额外的工作。

这是使用 zippers 的后序遍历：

```
(require '[clojure.zip :as z])

(defn dfs-post-order-traversal [zipper]
  (loop [loc zipper, a []] 
    (cond 
      (z/end? loc) 
        (conj a (z/node loc))
      (z/branch? loc) 
        (recur (z/next loc) a)
      :else
        (recur 
          (z/next loc) 
          (into 
            (conj a (z/node loc)) 
            (reverse 
              (drop 
                ((fnil count [nil]) (z/path (z/next loc))) 
                (z/path loc)))))))) 
```

和测试用例：

```
(dfs-post-order-traversal (z/seq-zip '((a b) (c d))))
=> [a b (a b) c d (c d) ((a b) (c d))] 
```

现在要完成您的请求，我们需要将树位置映射回它们的索引：

```
(defn dfs-post-order-indexing [branch? children root]
  (let [pot (dfs-post-order-traversal (z/zipper branch? children conj root))
        m (zipmap pot (range))]
    (for [n pot] [(m n) n (if (branch? n) (map m (children n)) (list))])))

(dfs-post-order-indexing seq? identity '((a b) (c d)))
=>  ([0 a ()]
     [1 b ()]
     [2 (a b) (0 1)]
     [3 c ()]
     [4 d ()]
     [5 (c d) (3 4)]
     [6 ((a b) (c d)) (2 5)]) 
```

更奇特的东西：

```
(dfs-post-order-indexing coll? seq [{:a :b :c :d} :e [:f [:g '(:h :i)]]])
=>  ([0 :a ()]
     [1 :b ()]
     [2 [:a :b] (0 1)]
     [3 :c ()]
     [4 :d ()]
     [5 [:c :d] (3 4)]
     [6 {:a :b, :c :d} (2 5)]
     [7 :e ()]
     [8 :f ()]
     [9 :g ()]
     [10 :h ()]
     [11 :i ()]
     [12 (:h :i) (10 11)]
     [13 [:g (:h :i)] (9 12)]
     [14 [:f [:g (:h :i)]] (8 13)]
     [15 [{:a :b, :c :d} :e [:f [:g (:h :i)]]] (6 7 14)]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T03:43:50.857

```
(use '[clojure.walk :only (postwalk)])
(use '[clojure.set :only (map-invert)])

(defn idx [col]
  (let [m (map vector 
               (range) 
               (let [v (atom [])]
                 (postwalk (fn [f] (swap! v conj f) f) col) 
                 @v))
        rm (map-invert m)]
    (into {} (map (fn [[i e]]
                    [i [e (if (sequential? e) 
                            (mapv rm e)
                            [])]])
                  m))))

(idx '((a b) (c d)))
=> {0 [a []],
    1 [b []],
    2 [(a b) [0 1]],
    3 [c []],
    4 [d []],
    5 [(c d) [3 4]],
    6 [((a b) (c d)) [2 5]]} 
```

# node.js - 节点 ImageMagick 调整大小不保留文件名

> ID：14865214
> 
> 赞同：1
> 
> 时间：2013-02-13T23:28:41.413
> 
> 标签：node.js, image-processing, imagemagick, docpad, node-imagemagick

许多解决方案都指向使用 mogrify，如果它是 Node js 实现的一部分，它会很好用。我需要做的就是调整图像大小并保留文件名，但将它们放在单独的“调整大小”文件夹中。这是我在这里所做的（在咖啡脚本中，作为 DocPad 静态网站生成器的插件）：

```
# Export Plugin
module.exports = (BasePlugin) ->

  im = require 'imagemagick'

  # Define Plugin
  class ImageMagickPlugin extends BasePlugin

      # Plugin name
      name: 'imagemagick'

      im.resize
        srcPath: './src/files/images/source/*.jpg'
        dstPath: "./src/files/images/resized/.jpg"
        width: 256
      , (err, stdout, stderr) ->
        throw err  if err
        console.log "resized some files to fit within 256" 
```

结果是我的图像被正确调整大小，并放置在正确的文件夹中，但名称本身是“-0.jpg、-1.jpg、-2.jpg”等等。我真的是为我们自己的特定用途而写这个，而不是一个严肃的 DocPad 插件，尽管我认为当它运行良好时，我们绝对可以修改它以供一般使用。

我很感激任何帮助！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T01:54:18.707

我像这样修改了您的代码：

```
# Export Plugin
module.exports = (BasePlugin) ->

  im = require('imagemagick')

  # Define Plugin
  class ImageMagickPlugin extends BasePlugin
    # Plugin name
      name: 'imagemagick'
      config:
        source: "images"
        suffix: "_resized"
        width: 256

      writeAfter: (opts,next) ->
        docpad = @docpad
        config = @config
        docpad.getDatabase().forEach (document) ->
          attr =  document.attributes
          if attr.extension is 'jpg' and attr.relativeDirPath is config.source
            srcPath = './src/files/' + attr.relativePath
            dstPath = './out/' + config.source + "/" + attr.basename + config.suffix + ".jpg"
            im.resize
              srcPath: srcPath
              dstPath: dstPath
              width: config.width
            , (err, stdout, stderr) ->
              throw err  if err
              console.log "File resized: " + attr.filename
        next() 
```

这样，您循环查找 ./src/files/images/ 中的 jpg 文件的文件，并直接在 ./out/images/ 中使用修改后的名称编写调整大小的版本： foo.jpg 在 foo_resized.jpg 中调整大小. 通过这样做，您不会“污染”您的 src 文件。

如果您只想用 ./out/images/ 中调整大小的图像替换源图像，您可以简单地为 in 的后缀定义一个空字符串`docpad.coffee`：

```
plugins:
  imagemagick:
    suffix: ""
    width: 300 
```

或者只是在插件的配置对象中设置它！

# sql - SQL 命令 - 用于多列

> ID：14865216
> 
> 赞同：0
> 
> 时间：2013-02-13T23:28:53.867
> 
> 标签：sql, pivot

我有一个包含列的表格 - `InvDate`、`CustName`、`InvAmt`、`PayType`和`PaidAmt`。客户可以通过现金、支票或信用卡 ( `PayType`) 支付金额。现在基于这张表，我想要这样的东西：

```
SELECT InvDate, CustName, InvAmt, 
       (PaidAmt as CashPay Where PayType = 'Cash'), 
       (PaidAmt as CheqPay WHERE PayType = 'Cheque'), 
       (PaidAmt As CCPay WHERE PayType = "CC') FROM Invoice 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:35:15.987

您没有指定您正在使用什么 RDBMS，但您应该能够使用聚合函数和任何数据库中的表达式来*透视数据：*`CASE`

```
select invDate, custName, InvAmt,
  sum(case when PayType = 'Cash' then PaidAmt else 0 end) CashPay,
  sum(case when PayType = 'Cheque' then PaidAmt else 0 end) CheqPay,
  sum(case when PayType = 'CC' then PaidAmt else 0 end) CCPay
from Invoice
group by invDate, custName, InvAmt 
```

如果您使用的是带有`PIVOT`函数的数据库（SQL Server 2005+/Oracle 11g+），那么您可以使用：

```
select *
from
(
  select invDate, custName, InvAmt,
    PayType, PaidAmt
  from Invoice
) src
pivot
(
  sum(paidamt)
  for paytype in (Cash, Cheque, CC)
) piv 
```

还有一些方法可以通过多次加入您的表来完成，但您需要提供有关表结构的其他详细信息才能正确构造该查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:35:35.813

如果您使用的是 SQL Server，您可以编写如下内容：

```
SELECT InvDate, CustName, InvAmt, 
       CASE WHEN PayType = 'Cash' THEN PaidAmt ELSE 0 END CashPay,
       CASE WHEN PayType = 'Cheque' THEN PaidAmt ELSE 0 END CheqPay,
       CASE WHEN PayType = 'CC' THEN PaidAmt ELSE 0 END CCPay
FROM Invoice 
```

# php - Doctrine2.1 加载部分关联

> ID：14865222
> 
> 赞同：1
> 
> 时间：2013-02-13T23:29:32.977
> 
> 标签：php, symfony, doctrine-orm

假设我在 Doctrine 中有一个名为 Post 的实体，它与另一个名为 Comment 的实体具有双向多对一关系。

假设我在 Post 中有一个函数将帖子序列化为 JSON 并包含部分评论：

```
public function serialize(){
   return array(
          ... other data here ....
          'comments' => $this->getSerializedComments(5),
          'total_comments' => $this->getComments()->count()
   );
} 
```

我还想编写一个函数 getSerializedComments(limit)，它只加载到限制关联中的评论（即不是帖子的所有评论，只有 5 个）。如果我理解正确，如果我将关联设为 EXTRA_LAZY，count() 只会运行一个计数查询，而不是水合整个关联。

我宁愿在我的实体类中完成所有这些，而不必在单独的管理器或存储库函数中完成。

我知道对多对关系有一个 @OrderBy 注释。不过似乎没有@Limit。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:11:14.567

您可以简单地使用，如果它被标记为[`Doctrine\Common\Collections\Collection::slice()`](https://github.com/doctrine/collections/blob/v1.0/lib/Doctrine/Common/Collections/Collection.php#L231-L242)，它不会[初始化集合](https://github.com/doctrine/doctrine2/blob/2.1.0/lib/Doctrine/ORM/PersistentCollection.php#L662-L683)[`EXTRA_LAZY`](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/tutorials/extra-lazy-associations.html)

# r - 转换为 R 中的公式：使用 X（数据框）预测 Y（因子变量）

> ID：14865223
> 
> 赞同：-1
> 
> 时间：2013-02-13T23:29:47.503
> 
> 标签：r

我正在研究一个分类问题，对于我的训练数据，我有一个数据框`X`和一个因子变量`Y`，我想预测我的变量`Y`。`X`

[派对](http://cran.r-project.org/web/packages/party/index.html)`cforest`包中的功能具有以下接口

```
 cforest(formula, data = list(), ...) 
```

在哪里：

> **公式**：要拟合的模型的符号描述。请注意，':' 和 '-' 之类的符号将不起作用，并且树将使用 'formula' 右侧列出的所有变量。
> 
> **data**：包含模型中变量的数据框。

但是，当我尝试：

```
# Build a random set of training vectors X
X <- data.frame(replicate(5, rnorm(2000)))

# Build Y from X
Y <- runif(1)*X[,1]*X[,2]^2+runif(1)*X[,3]/X[,4]

cforest(Y, data = X, ...) 
```

我收到一个错误：

```
..
10: ParseFormula(formula, data = data)
...
5: cforest(Y, data = X, ...) at .. 
```

从回溯来看，我似乎没有`cforest`正确使用该界面。我已经阅读了 R 公式（`?formula`以及 非常有帮助的[本教程](http://ww2.coastal.edu/kingw/statistics/R-tutorials/formulae.html)），并且我抽象地理解了这个概念，但我不知道如何将我的预测问题（我会写`Y ~ X`）转换为公式语法。

如何将我的呼叫转换为`cforest`使用公式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:55:51.800

答案是使用以下语法：

```
cf.model = cforest(Y ~ ., data=X, ...) 
```

基本上说“`X`在尝试预测时使用数据框中的所有变量`Y`”

# php - 如何使用 CakePHP 在控制器的 add 方法中创建多个对象

> ID：14865227
> 
> 赞同：0
> 
> 时间：2013-02-13T23:29:55.283
> 
> 标签：php, cakephp, cakephp-2.3

我有`ProductsController`一个添加视图，作为自动完成字段（'brand_name'），用户可以在其中输入品牌名称。在我的处理程序中，我想检查数据库中是否已存在品牌名称，应在产品上设置品牌 ID。如果数据库中不存在，则应创建一个新品牌并将其插入数据库中。

下面的代码被简化：

应用程序/模型/Product.php

```
class Product extends AppModel {
    public $belongsTo = array('Brand');
} 
```

应用程序/控制器/ProductsController.php

```
class ProductsController extends AppController {
    public $helpers = array('Html', 'Form', 'Session');
    public $components = array('Session');

    public function add() {
        if ($this->request->is('post')) {
            $this->Product->create();

            $brand = $this->Product->Brand->find(
                'first', 
                array(
                    'conditions' => array(
                        'Brand.name' => $this->request->data['Product']['brand_name']
                    )
                )
            );
            if($brand)
            {
                $this->request->data['Product']['brand_id'] = intval($brand['Brand']['id']);
            }
            else
            {
                // Add new brand
                //$this->Product->Brand->create();
                $this->Product->Brand->name = $this->request->data['Product']['brand_name'];
            }

            if ($this->Product->saveAll($this->request->data)) {
                $this->Session->setFlash(__('The product has been saved.'));
                //$this->redirect(array('action' => 'index'));
            } else {
                $this->Session->setFlash(__('Unable to add the product.'));
            }
        }
    }
} 
```

一切正常，除了创建和插入新的 Brand 对象。如何在代码中创建此对象？我是 CakePHP 的新手，所以如果我的方法有误，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:48:02.963

我已经通过向`$this->request->data`数组添加一个新值来解决这个问题，如下所示：

```
if($brand)
{
    $this->request->data['Product']['brand_id'] = intval($brand['Brand']['id']);
}
else
{
    $this->request->data['Brand']['name'] = $this->request->data['Product']['brand_name'];
} 
```

# visual-studio-2010 - 在 Visual Studio 2010 中将目标名称与配置对齐

> ID：14865230
> 
> 赞同：0
> 
> 时间：2013-02-13T23:30:17.160
> 
> 标签：visual-studio-2010, dll, configuration, static-libraries, 32bit-64bit

我正在使用 32 位源库并在 64 位平台上编译并遇到对齐问题（不仅是 32 位与 64 位，还有字符集）。

我想将所有 64 位配置放入“Win64”文件夹，将 32 位配置放入“Win32”目录。

我正在研究修改项目文件的一些指导，以便目标库和 dll 文件名与配置相关。

例子：

*   Win64/testrunner_x64d.lib -- 库，调试，64 位平台，ASCII 字符集。
*   Win64/testrunner_x64ud.lib -- 库，调试，64 位平台，Unicode 字符集。
*   Win32/testrunner_x32d.lib -- 库，调试，32 位平台，ASCII 字符集。
*   Win32/testrunner_x32ud.lib -- 库，调试，32 位平台，Unicode 字符集。

我不熟悉在 Visual Studio 2010 中使用配置以及移植现有项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T06:26:02.793

对于字符设置，请转到“配置属性”->“常规”->“项目默认值”->“字符集”，根据需要选择一个。

对于不同配置的库名称，您可以通过“链接器”->“常规”->“输出文件”设置

# wpf - 更改 WPF Toolkit NumericUpDown 控件中的箭头颜色？

> ID：14865232
> 
> 赞同：2
> 
> 时间：2013-02-13T23:30:27.567
> 
> 标签：wpf, wpftoolkit, numericupdown

有没有一种样式可以从 WPF 工具包中定位 NumericUpDown 控件中的箭头？我想改变箭头的颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-13T14:19:26.217

要添加 Xceed.Wpf.Toolkit.Themes 命名空间，请使用此 xmlns:theme="clr-namespace:Xceed.Wpf.Toolkit.Themes;assembly=Xceed.Wpf.Toolkit"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:26:58.547

您可以覆盖`GlyphNormalForeground`颜色。

您必须将`Xceed.Wpf.Toolkit.Themes`xmnls 命名空间添加到您的 xaml。（或 WpfToolkit.Themes 如果您使用旧版本）

例子：

```
<Grid>
    <wpfToolkit:IntegerUpDown  Margin="37,25,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" >
        <wpfToolkit:IntegerUpDown.Style>
            <Style TargetType="{x:Type wpfToolkit:IntegerUpDown}">
                <Style.Resources>
                    <SolidColorBrush x:Key="{x:Static theme:ResourceKeys.GlyphNormalForegroundKey}"  Color="Red"/>
                </Style.Resources>
            </Style>
        </wpfToolkit:IntegerUpDown.Style>
    </wpfToolkit:IntegerUpDown>
</Grid> 
```

结果：

![在此处输入图像描述](../Images/231ca3d3df2aebf31d8f6c463e28df23.png)

# json - 通过socket.io发送匿名函数？

> ID：14865233
> 
> 赞同：4
> 
> 时间：2013-02-13T23:30:32.703
> 
> 标签：json, node.js, socket.io, anonymous-function

我想创建一个客户端函数，可以使用客户端变量接收和执行任意命令。我将从我的服务器发送这些函数，方法是使用 socket.io 发送一个 JSON 对象，其中包含一个匿名函数，这将是我的命令。它看起来像下面这样：

```
//client side

socket.on('executecommand', function(data){
    var a = "foo";
    data.execute(a); //should produce "foo"
});

//server side

socket.emit('executecommand', {'execute': function(param){
    console.log(param);
}}); 
```

然而，当我尝试它时，客户端收到一个空的 json 对象（`data == {}`），然后抛出异常，因为数据不包含执行方法。这里出了什么问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T00:02:17.637

JSON 不支持包含`function`定义/表达式。

你可以做的是`commands`用你需要的 s 定义一个对象，`function`然后传递一个`commandName`：

```
// client-side

var commands = {
    log: function (param) {
        console.log(param);
    }
};

socket.on('executecommand', function(data){
    var a = 'foo';
    commands[data.commandName](a);
}); 
```

```
// server-side

socket.emit('executecommand', { commandName: 'log' }); 
```

您还可以使用以下命令[`fn.apply()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)传递参数并检查`commandName`与命令的匹配[`in`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/in)：

```
// client-side
var commands = { /* ... */ };

socket.on('executecommand', function(data){
    if (data.commandName in commands) {
        commands[data.commandName].apply(null, data.arguments || []);
    } else {
        console.error('Unrecognized command', data.commandName);
    }
}); 
```

```
// server-side

socket.emit('executecommand', {
    commandName: 'log',
    arguments: [ 'foo' ]
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T23:32:49.910

您不能发送文字 JavaScript 函数并期望它能够工作。您需要首先对函数进行字符串化（即，将其放在一组引号内），然后在客户端评估字符串。

# spring - Nexus 从 springsource 存储库中排除整个工件

> ID：14865234
> 
> 赞同：0
> 
> 时间：2013-02-13T23:30:33.663
> 
> 标签：spring, maven, cloud-foundry, nexus, sonatype

我正在尝试将 Springsource maven 存储库添加为我的 nexus 安装中的代理存储库，它仅包括那里的 org/springframework 工件。我无法解决其他任何问题。我需要能够解决：

```
 <dependency>
        <groupId>org.cloudfoundry</groupId>
        <artifactId>cloudfoundry-runtime</artifactId>
        <version>0.8.2</version>
    </dependency> 
```

[http://repo.springsource.org/milestone/org/cloudfoundry/cloudfoundry-runtime/0.8.2/](http://repo.springsource.org/milestone/org/cloudfoundry/cloudfoundry-runtime/0.8.2/)

有谁知道为什么 nexus 不包括 org/cloudfoundry？代理 repo 配置是默认配置，url 为： [http ://repo.springsource.org/milestone](http://repo.springsource.org/milestone)

任何帮助，将不胜感激！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T16:53:10.910

在[hipchat nexus 社区](https://links.sonatype.com/products/nexus/community-chat)一位有用的人的帮助下，我解决了这个问题。我认为问题在于春季回购不在我的公共回购组配置中。他们看起来就像在那里，但我可能在将它们移到那里后从未点击过保存。是什么让我发现这是通过在我的浏览器中加载这个网址：http: [//yourdomain.com :8081/nexus/content/groups/public/org/cloudfoundry/cloudfoundry-runtime/0.8.2/cloudfoundry-runtime-0.8 .2.pom?描述](http://yourdomain.com:8081/nexus/content/groups/public/org/cloudfoundry/cloudfoundry-runtime/0.8.2/cloudfoundry-runtime-0.8.2.pom?describe)

这将吐出一堆 json 并列出了被搜索的 repos。很明显，spring repos 没有被搜索，所以我回到配置，添加它们，这次确定点击保存，然后我可以解决依赖关系！

# php - 搜索整个文档而不是按行 php

> ID：14865241
> 
> 赞同：0
> 
> 时间：2013-02-13T23:31:11.587
> 
> 标签：php, string, file-listing

好的，所以我试图在 PHP 中列出文本文件，我需要它们包含任意数量的一个变量`$words_to_match ='spaghetti'`并回显链接。如您所见，文本文件充满了字符串（或者每个都是一个字符串）。

这是我的代码：

```
if($_POST["Confirmed"]=='') 
{
    echo "You need to enter something to search!";
}
else
{
    $path_to_check = 'Confirmed/';
    $words_to_match = $_POST["Confirmed"];//Checks the form from the last page 

    foreach(glob($path_to_check.'*.txt') as $filename)
        {
            foreach(file($filename) as $fli=>$fl) // Not sure what to put here.
                {
                    if (stristr($fl,$words_to_match) !== false) //Or here.
                    {
                        echo '<a href="'.$filename.'">'.$filename.'</a><br />';
                        }
                    }
                }
            } 
```

我不知道在说`foreach(file($filename) as $fli=>$fl)`Or的地方放什么`if (stristr($fl,$words_to_match) !== false)`。我很确定第二个是对的。当我搜索包含多行的文件时`spaghetti`，它会显示几个相同的文件。如果有 3 行`spaghetti`，则有 3 个文件 - 等等。我只想列出其中一个文件，即使该文件中有一大堆`spaghetti`。我的理论是它逐行读取文件，并给出其中所有行的输出`spaghetti`。

回顾一下，我想这样做，所以我有一个列出的文件，而不是多少行包含一个列为文件的字符串。

有任何想法吗？

顺便说一句，我使用 PHP 5.3 的标准 GoDaddy 托管帐户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:42:02.577

为什么不只是：

```
foreach(glob(...) as $filename) {
    if( stripos(file_get_contents($filename),$words_to_check) !== false) {
        // word is present.
    }
} 
```

# android - 使用 Sqlite 游标时如何在对话框中获取 setMultiChoiceItems 复选框以进行更新

> ID：14865242
> 
> 赞同：3
> 
> 时间：2013-02-13T23:31:17.630
> 
> 标签：android, dialog, cursor

使用游标实现 setMultiChoiceItems 时，必须指定 isCheckedColumn。

[正如其他网站](http://code.google.com/p/android/issues/detail?id=2998)所阐述的那样，问题是当用户从列表中选择一个项目时，复选框不会更新。有些人建议每次用户选择一个项目时更新 Sqlite 表，但这在我的应用程序中不起作用。这是我想出的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:31:17.630

这就是我想出的：

```
 @Override
public Dialog onCreateDialog(Bundle savedInstanceState) {

    int myDialogChoice = getArguments().getInt("whichDialog");
    mSelectedItems = new ArrayList();  // Where we track the selected items
    mCurrentFavoritesSelection = new ArrayList();

    myDataBaseAdapter = new AthleteDbAdapter(getActivity());
    //      int myAthleteId;
    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());

    switch(myDialogChoice) {
        case Select_From_Favorites:

            myCursorFromSqLite = myDataBaseAdapter.fetchAllFavorites(getActivity());

            // You need a Primative Boolean Array to specify which items were selected last time.
            boolean[] booleanPrimativeArray = new boolean[myCursorFromSqLite.getCount()];

            final ArrayList mArrayListOfIDs             =   new ArrayList();
            ArrayList<Boolean> myBooleanList = new ArrayList<Boolean>();

            // This array will be the choices that appear in the Dialog.
            ArrayList<String> mArrayListOfNames =   new ArrayList<String>();

            myCursorFromSqLite.moveToFirst();
            /* Populate Arrays
             *
             */
            int iCount = 0;

            while(!myCursorFromSqLite.isAfterLast()) {
                // put _id's from SqLite data into an array.
                mArrayListOfIDs.add(Integer.valueOf(
                                                    myCursorFromSqLite.getString(myCursorFromSqLite.getColumnIndex(KEY_ROWID))));

                // put series of booleans into Primative Array depending upon whether user selected them last time.
                if(Integer.valueOf(myCursorFromSqLite.getString(myCursorFromSqLite.getColumnIndex("checked"))) == 1){
                    booleanPrimativeArray[iCount] = true;
                    mSelectedItems.add(
                                       Integer.valueOf(myCursorFromSqLite.getString(myCursorFromSqLite.getColumnIndex(KEY_ROWID)))
                                       );
                    // I kept track of what selections from last time were.
                    mCurrentFavoritesSelection.add(
                                                   Integer.valueOf(myCursorFromSqLite.getString(myCursorFromSqLite.getColumnIndex(KEY_ROWID)))
                                                   );
                } else booleanPrimativeArray[iCount] = false;
                iCount++;
                mArrayListOfNames.add(myCursorFromSqLite.getString(myCursorFromSqLite.getColumnIndex("fullName")));
                myCursorFromSqLite.moveToNext();
            }

            // Change the ArrayList of names to a Char Sequence
            CharSequence[]  charSeqOfNames = mArrayListOfNames.toArray(new CharSequence[mArrayListOfNames.size()]);
            try{
                myCursorFromSqLite.close();
            } catch (Throwable t) {
                Log.e(APP_TAG,"Error closing myCursorFromSqLite Cursor " + t);
            }
            builder.setTitle(R.string.pick_athletes)

            .setMultiChoiceItems(charSeqOfNames, booleanPrimativeArray,
                                 new DialogInterface.OnMultiChoiceClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which,
                                    boolean isChecked) {
                    if (isChecked) {
                        // If the user checked the item, build an array containing the selected items _id's.
                        mSelectedItems.add((Integer) mArrayListOfIDs.get(which));

                    } else if (mSelectedItems.contains((Integer) mArrayListOfIDs.get(which))) {
                        // Else, if the user changes his mind and de-selects an item, remove it 
                        mSelectedItems.remove((Integer) mArrayListOfIDs.get(which));
                    }
                }
            })
            // Set the action buttons
            .setPositiveButton(R.string.pullathletesbutton, new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int id) {
                    // User clicked OK, so save the mSelectedItems results somewhere
                    // or return them to the component that opened the dialog
                    Log.d(APP_TAG,"Call something");

                    mListener.onDialogPositiveClick(PickListDialog.this, mSelectedItems, mCurrentFavoritesSelection);
                }
            })
            .setNegativeButton(R.string.cancelbutton, new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int id) {

                }
            }); 
```

这运作良好。用户可以在不影响底层数据库的情况下改变主意，并且复选标记会正确更新。一旦用户完成了他的选择，他点击“肯定”按钮并更新数据库。

# sql - SQL 从一列中取出顶部和底部元素并将它们放在两个不同的列中

> ID：14865244
> 
> 赞同：0
> 
> 时间：2013-02-13T23:31:22.353
> 
> 标签：sql, select, join

我有 2 个选择语句。我想按字母顺序取名字并将其放在标题为 First 的列中，然后按字母顺序将其放在姓氏旁边的标题为 Last 的列中。

```
SELECT Name AS 'First'
FROM contactlist
ORDER BY Name ASC
LIMIT 1;

SELECT Name AS 'Last'
FROM contactlist
ORDER BY Name DESC
LIMIT 1; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:41:39.680

不知道你为什么需要这个，但你去：

```
SELECT First, Last
FROM (
  SELECT Name AS 'First'
  FROM contactlist
  ORDER BY Name ASC
  LIMIT 1
  ) t, (
  SELECT Name AS 'Last'
  FROM contactlist
  ORDER BY Name DESC
  LIMIT 1
  ) t2 
```

取你所有的名字并按行号匹配它们可能会更有趣（ASC First to DESC Last）——像这样：

```
SELECT First, Last
FROM (
  SELECT Name AS 'First',
    @rowNum:=@rowNum + 1 rn
  FROM contactlist
    JOIN (SELECT @rowNum:= 0) r
  ORDER BY Name ASC
  ) t JOIN
 (
  SELECT Name AS 'Last',
    @rowNum2:=@rowNum2 + 1 rn
  FROM contactlist
    JOIN (SELECT @rowNum2:= 0) r
  ORDER BY Name DESC
  ) t2 ON t.rn = t2.rn 
```

还有一些[小提琴](http://sqlfiddle.com/#!2/b33ea/1)。

# excel - 使用基于前一个单元格中的路径摘录的文件名填充单元格

> ID：14865258
> 
> 赞同：1
> 
> 时间：2013-02-13T23:32:18.897
> 
> 标签：excel, vba

我正在使用一个 Excel 电子表格，该电子表格在 A 列中有一个标题列表，在 D 列中有一个文件名列表。文件名是使用基于 A 列标题的特定命名约定创建的 - 例如，如果A1 中的标题是“Taco_123”，那么 D1 中的文件名将包含确切的短语“Taco_123”。

目前，文件名必须在文件创建后手动输入到 D1 中。但我想要的是一个可以自动执行此操作的 VBA 脚本。我的想法是，对于每一行，它将读取 A 列中的标题，在文件所在的目录中搜索包含该确切短语的文件，然后将文件名（减去扩展名）复制到 D 列中。

这样的事情甚至可能吗？我已经尝试在网上搜索解决方案，因为我知道有关 VBA 的知识，但我运气不佳；我什至找不到其他有同样问题的人。任何帮助，将不胜感激。

编辑：我不知道这是否会有所不同，但需要搜索匹配文件名的文件类型是 PSD。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T02:37:44.877

这样的事情绝对是可能的。在 Excel 2003 及更早版本中使用 Application.FileSearch 在旧版本的 excel 中执行此操作有一个简单的方法。对于 2007 年及更新版本，您必须使用或修改 P. Havdra 的解决方案，此处：

[http://social.msdn.microsoft.com/Forums/en-US/isvvba/thread/a450830d-4fc3-4f4e-aee2-03f7994369d6/](http://social.msdn.microsoft.com/Forums/en-US/isvvba/thread/a450830d-4fc3-4f4e-aee2-03f7994369d6/)

该脚本会打印出与您的搜索参数匹配的文件列表，并且还会弹出一个烦人的消息框。

我对他的 FileSearch 子程序进行了一些修改以帮助您入门。这会在指定目录中构建一组匹配的 PSD 文件名，然后您可以对数组进行处理并与工作表数据进行交互。

```
Sub FileSearch()
'
' Example of FileSearchByHavrda procedure calling as replacement of missing FileSearch     function in the newest MS Office VBA
' 01.06.2009, Author: P. Havrda, Czech Republic

'As modified Feb-13-2013, David Zemens, for _
http://stackoverflow.com/questions/14865258/populate-cell-with-a-filename-based-on-path-excerpt-in-previous-cell
'
Dim sDir As String  '< this is the search directory you will use

Dim FileNameWithPath As Variant
Dim ListOfFilenamesWithParh As New Collection ' create a collection of filenames
Dim rCount As Long 'row counter

Dim myArray() As Variant
Dim a As Long 'array iterator
a = 0

'Set the search directory:
sDir = "C:\DESKTOP\"  '<-- MODIFY TO SUIT YOUR NEEDS

' Filling a collection of filenames (search Excel files including subdirectories)
Call FileSearchByHavrda(ListOfFilenamesWithParh, sDir, "*.psd", False)

' Print list to immediate debug window and as a message window
For Each FileNameWithPath In ListOfFilenamesWithParh ' cycle for list(collection) processing
    'Create an array of matching filenames
    ReDim Preserve myArray(a)
    myArray(a) = FileNameWithPath
    a = a + 1
Next FileNameWithPath

' If no file was found:
If ListOfFilenamesWithParh.Count = 0 Then
    'Debug.Print "No file was found !"
    MsgBox "No file was found !"
Else:
    'some files were found, so do something with myArray
    '########################################################
    '
    '  <-- Code to manipulate your worksheet will go here -->
    '
    '
    '########################################################
End If
End Sub 
```

# mysql - mySQL 年份之间的值范围

> ID：14865263
> 
> 赞同：0
> 
> 时间：2013-02-13T23:33:00.580
> 
> 标签：mysql, range, between

我对这种形式的 SQL 很陌生。因此，如果这是一个明显/愚蠢的问题，我深表歉意。

基本上，我正在编写一个简单的查询，该查询应该在一年内查找威塞克斯国王。年份存储为 INT，因为我认为它无法处理低于 1000AD 的年份。反正。

用户应输入他们感兴趣的年份范围，例如 793 - 794。这是在带有两个文本框的表单中输入的。

Beorhtric 在 786 年至 802 年期间将成为威塞克斯国王，但使用当前的 BETWEEN 函数只会带回林迪斯法恩修道院被维京人焚烧的事件。我还想要返回的是，Beorhtric 是此时的威塞克斯国王。

到目前为止，这是我的代码：

```
<?php

  $con = mysql_connect("");
  if (!$con) {
  die('Could not connect: ' . mysql_error());
  }

  mysql_select_db("magorumc_authentibase", $con);
  $result = mysql_query("SELECT * FROM exportinfomod
           WHERE date_s BETWEEN ".mysql_real_escape_string($_GET['searchs'])." 
                 AND ".mysql_real_escape_string($_GET['searchd'])." 
           ORDER BY date_s ASC");
  echo "<b>Output Display in Table formate and php formate</b><br>";
  echo "<table border='1'>
  <tr>
  <th>Start Date</th>
  <th>End Date</th>
  <th>Title</th>
  <th>Text</th>
  </tr>";
  while ($row = mysql_fetch_array($result)) {
    echo "<tr>";
    echo "<td>" . $row['date_s'] . "</td>";
    echo "<td>" . $row['date_e'] . "</td>";
    echo "<td>" . $row['title'] . "</td>";
    echo "<td>" . $row['text'] . "</td>";
    echo "</tr>";
  }
  echo "</table>";

  mysql_close($con);
?> 
```

非常感谢您提前。

亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:52:30.850

您可能在这里缺少正确的逻辑，以便按预期工作。这是范围的典型问题，因为它们可能远不直观。

例如，如果事件 A 跨越时间 t=2 到 t=6，并且您想知道在 t=4 和 t=5 之间发生了哪些事件，那么除非您的范围正确，否则您将找不到 A。

正确的查询应该是：

```
SELECT ... WHERE date_s <= :searchd AND date_e >= :searchs 
```

这假定`:searchd`是您范围的结束，并且`:searchs`是开始。*在长格式中，这意味着“查找事件在范围结束之前开始并在范围开始**之后*结束的所有事件。” 我相信这会起作用，就像在人为的例子中一样，因此该事件将符合条件。*`6 >= 5``2 <= 4`*

# hibernate - 休眠多个多对一映射

> ID：14865265
> 
> 赞同：0
> 
> 时间：2013-02-13T23:33:12.893
> 
> 标签：hibernate, hql, hibernate-mapping

我有一个具有多个多对一映射的作业表。一个申请表，其中包含特定工作的申请者和地址表，其中包含有关此工作发布位置的多个位置。我正在寻找一个查询来获取我的工作列表（每个工作没有多个条目）。当我做 job.getApplicants 时，它应该给我该工作的所有申请人列表，而 job.addresses 应该给我这份工作的所有地址。重要的是，上述所有数据都应该在**One Single Eager** fetch 中获得。

我现在遇到的问题是，如果我有 10 位申请人，我的 jobList 中的单项工作将获得 10 个条目。我使用的代码有点像这样。

```
select j from Job j left outer join fetch j.applicants apps where j.job_id = :job_id 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T04:08:36.323

实际上，答案很简单。我只需要添加不同的喜欢

```
select distinct j from Job 
```

我以前不能使用 distinct，因为作业中的列之一是 xml 类型。我仍在寻找有关如何在创建实体类本身时将 xml 类型列转换为 String/varchar 的答案，同时使用注释进行映射。

# ios - 使用 Storyboard 中的 UITableViewCell 时使用 alloc 和 init

> ID：14865266
> 
> 赞同：2
> 
> 时间：2013-02-13T23:33:12.270
> 
> 标签：ios, objective-c, uitableview, storyboard

我正在使用 Storyboard 做一个简单的应用程序，它有一个 View 和一个`UITableView`with a `UITableViewCell`，它可以导航到另一个`UIView`.

所以必须编写代码来填充表格视图上的单元格。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *cellIdentifier = @"SampleCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:cellIdentifier];
        NSLog(@"cai no init da cell");
    }

    GPItem *item = [self.items objectAtIndex:indexPath.row];

    cell.textLabel.text = @"Post";
    cell.detailTextLabel.text = item.imageURL;

    return cell;
} 
```

我意识到代码`if (cell == nil) { ...`永远不会执行，所以我真的需要使用 Storyboard 中的单元格来执行此操作吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T23:36:56.893

你是对的; 如果您使用情节提要，则该代码保证返回非零单元格。此外，在 iOS 6 中，新调用`dequeueReusableCellWithIdentifier:forIndexPath:` *永远不会*返回 nil。请参阅我书中的讨论：

[http://www.aeth.com/iOSBook/ch21.html#_registering_a_cell_class](http://www.apeth.com/iOSBook/ch21.html#_registering_a_cell_class)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:36:45.287

如果你已经在表格视图的原型单元格中声明了你的 UITableViewCell ，那么它已经被分配并且只需要出列。如果您使用自定义 UITableViewCell 子类，则必须检查它是否为 nil 并在必要时分配新实体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T23:38:57.863

不，在使用情节提要中制作的单元格时，您不需要该代码。

最好删除此代码，以便如果`identifier`您在界面构建器中提供给单元格并且您在代码中使用的标识符曾经漂移，那么您会尽早崩溃。此代码段将掩盖此错误，并仅提供您最可能不打算拥有的单元格。

# c# - 创建包装请求/响应协议的异步/等待 API

> ID：14865270
> 
> 赞同：1
> 
> 时间：2013-02-13T23:33:43.307
> 
> 标签：c#, .net, .net-4.5

我有一个通过 TCP 运行的请求/响应协议，我想为其提供一个异步/等待 API。该协议是 STOMP，它是一个相当简单的基于文本的协议，通过 TCP 或 SSL 运行。在 STOMP 中，客户端发送六个左右的命令帧之一，并`receipt`在命令的标头中指定一个 ID。服务器将使用 a`RECEIPT`或`ERROR`frame 和`receipt-id`字段进行响应，因此客户端可以将响应与原始请求相匹配。服务器也可以随时发送一个`MESSAGE`帧（STOMP 本质上是一种消息传递协议），其中不包含`receipt-id`.

为了允许多个未完成的请求并处理任何`MESSAGE`帧，计划是始终有一个`Socket.BeginReceive()`未完成的请求。所以我在想的是，最简单的实现是创建一个可等待事件（如互斥锁），将该事件存储在一个表中，将带有`receipt`集合的命令请求发送到表中的索引，然后阻止该事件。触发时`socket.BeginReceive()`，该函数可以`receipt-id`从消息中获取，在表中查找事件，并发出信号（并存储一些状态，如成功或错误）。这将唤醒调用函数，该函数可以查看结果并将成功或失败返回给调用应用程序。

这听起来基本正确吗？我以前使用过 async/await API，但从未编写过自己的 API。如果可以，我应该使用哪种可等待事件？一个简单的`Monitor.Wait()`会阻塞但不是我想要的方式，对吗？如果我把整个东西都包起来，它的`Task.Run()`行为会正常`Monitor.Wait()`吗？或者是否有我应该使用的新同步结构？我基本上是在实施`HttpClient.GetAsync()`，有人知道这在幕后是如何工作的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:40:26.270

`HttpClient`更简单，因为 HTTP 对每个请求只有一个响应。HTTP 中不存在未经请求的服务器消息。

要正确设置这样的事件“流”，最好使用[TPL Dataflow](http://msdn.microsoft.com/en-us/devlabs/gg585582.aspx)或[Rx](http://msdn.microsoft.com/en-us/data/gg577609)。否则，您必须创建一个无界接收缓冲区并重复异步 ReceiveMessage 调用。

因此，我建议使用 TPL 数据流管道来创建“消息”的源块，然后将一些与请求匹配（`TaskCompletionSource`用于通知发送者它已完成）并将其余的（`MESSAGE`帧）作为源块公开。

在内部，您的处理管道将如下所示：

*   重复`BeginReceive`->
*   `TransformBlock`用于消息框架->
    *   `ActionBlock`将响应消息与请求匹配。
    *   `BufferBlock`为`MESSAGE`框架。

# java - 如果文件已存在于下载位置，如何强制 Firefox18 提示输入文件名？

> ID：14865274
> 
> 赞同：1
> 
> 时间：2013-02-13T23:33:51.580
> 
> 标签：java, firefox, selenium, webdriver

我无法让 Firefox 在保存文件时提示我输入文件名。我有这个工作，但最近升级到版本 18 后，它停止工作。

无论我尝试什么，Firefox 都会提示我下载 CrystalReport.csv，但它无法通知我该文件已存在于下载位置，因此无法提示我输入新文件名。结果是我在名为“CrystalReport(1).csv”、“CrystalReport(2).csv”、“CrystalReport(3).csv”、“CrystalReport(4).csv”的默认“下载”目录中获取文件'， ETC。

我该如何强制或控制它？

这是我如何初始化我的个人资料。奇怪的是，我在下面设置的首选项并没有永久保存到 prefs.js 文件中。他们不应该吗？：

```
public static FirefoxProfile initializeFirefoxProfile() {
    FirefoxProfile profile = null;
    File profileDir = new File( profileFirefoxDir + System.getProperty("file.separator") + profileFirefoxName );
    if ( profileDir.exists() ) {
        logger.info("Loading Firefox profile from " + profileDir + " named \"" + profileFirefoxName + "\"" );
        profile = new FirefoxProfile( profileDir );
    } else {
        logger.info("Cannot find defined profile dir. Loading Firefox profile from system by name: \"" + profileFirefoxName + "\"" );
        ProfilesIni allProfiles = new ProfilesIni();
        profile = allProfiles.getProfile( profileFirefoxName );
    }
    profile.setPreference("app.update.auto", false);
    profile.setPreference("app.update.enabled", false);
    profile.setPreference("app.update.url", "");
    profile.setPreference("app.update.interval", 8640001);
    profile.setPreference("browser.download.dir", "C:\\Windows\\Temp");
    profile.setPreference("browser.helperApps.alwaysAsk.force", true);
    return profile;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:48:07.070

我建议在 Firefox 选项对话框的“常规”选项卡的“下载”部分中选择“总是询问我将文件保存在哪里”选项。

通过 about:config，我找不到与此相对应的条目，但如果您使用该选项，则无需手动将其添加到您的配置文件中。

否则，如果文件已存在，某些附加组件会提供提示您输入文件名的功能。

# ruby - Rails 3 - 公共文件夹中的 MP3 文件

> ID：14865277
> 
> 赞同：0
> 
> 时间：2013-02-13T23:33:58.297
> 
> 标签：ruby, ruby-on-rails-3, mp3, download

我将 mp3 文件添加到 /public 文件夹中，但发现了一些问题。

在我看来，我添加了链接：

```
= link_to "Interview 1", "/interview_01.mp3" 
```

当我从页面上看到链接时，一切看起来都很正常，直到我点击它。浏览器挂起一分钟或更长时间，磁贴变为“未定义”，我的谷歌浏览器冻结。

它出什么问题了？我怎样才能使人们可以下载文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T00:06:00.273

## 编辑：我的回答有更多背景，因为有人投了我的票

当您链接到 mp3 文件时，大多数现代浏览器会尝试直接在浏览器中播放该文件。您的浏览器可能会冻结，因为您的浏览器用于开始播放文件的任何插件都已损坏。我的猜测是您正在运行 Windows，它正在尝试使用 quicktime 插件或类似的东西。

如果您不希望浏览器播放该文件，而您实际上希望该文件开始下载，则需要在 HTTP 响应中添加一些额外的标头。最重要的是：

`Content-Disposition: attachment; filename="filenamehere.mp3"`

我的原始答案提供了完成此操作的说明。如果这不是您希望实现的目标，那么您可以忽略它。

如果您希望使用新的 HTML5 音频标签将文件直接嵌入到页面中，您可以按照@Alen 对您的问题的评论中给出的建议进行操作。

## 原答案：

您应该尝试使用`#send_file`控制器辅助方法从控制器操作发送文件。

```
= link_to "Inteview 1", :controller => 'files', :action => 'send_file', :filename => 'interview_01.mp3' 
```

然后

```
class FilesController

  def send_file
    file_path = "#{Rails.root}/public/#{params[:filename]}"
    send_file file_path, :filename => params[:filename], :disposition => 'attachment'
  end

end 
```

参考 Rails Api：[http ://api.rubyonrails.org/classes/ActionController/DataStreaming.html#method-i-send_file](http://api.rubyonrails.org/classes/ActionController/DataStreaming.html#method-i-send_file)

该`send_file`方法正确设置 HTTP 标头以告诉浏览器下载文件而不是尝试呈现它。

# smooth-streaming - 如何在 SMFPlayer 中挂钩 ISmoothStreamCache 对象（Smooth Streaming Development kit）

> ID：14865281
> 
> 赞同：1
> 
> 时间：2013-02-13T23:34:07.663
> 
> 标签：smooth-streaming, smooth-streaming-player

我在 SilverLight Smooth Streaming Development Kit 中使用 SMFPlayer。而且我可以播放视频内容，但是出于某种原因，我们希望控制正在下载和解析的数据。为此，我们要开始使用 ISmoothStreamingCache 接口。我想知道在 SMFPlayer 中挂钩 ISmoothStreamingCache 对象的正确方法是什么。

提前致谢

大O

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T08:35:47.177

`ISmoothStreamingCache's`实现也应该实现`IPlugin`接口。它也应该用`ExportAdaptiveCacheProvider`属性装饰。

然后它会自动挂接到 SMFPlayer。

下面是类的骨架代码：

```
using System;
using System.Collections.Generic;
using System.IO.IsolatedStorage;
using System.Net;
using Microsoft.SilverlightMediaFramework.Plugins;
using Microsoft.SilverlightMediaFramework.Plugins.Metadata;
using Microsoft.Web.Media.SmoothStreaming;

namespace MyNamespace
{
    [ExportAdaptiveCacheProvider(PluginName = "My Smooth Streaming Cache")]
    public class MySmoothStreamingCache : ISmoothStreamingCache, IPlugin
    {
        public MySmoothStreamingCache()
        {
            // Your implementation
        }

        #region ISmoothStreamingCache members
        public IAsyncResult BeginRetrieve(CacheRequest request, AsyncCallback callback, object state)
        {
            // Your implementation
        }

        public CacheResponse EndRetrieve(IAsyncResult ar)
        {
            // Your implementation
        }

        public IAsyncResult BeginPersist(CacheRequest request, CacheResponse response, AsyncCallback callback, object state)
        {
            // Your implementation
        }

        public bool EndPersist(IAsyncResult ar)
        {
            // Your implementation
        }

        public void OpenMedia(Uri manifestUri)
        {
            // Your implementation
        }

        public void CloseMedia(Uri manifestUri)
        {
            // Your implementation
        }
        #endregion

        #region IPlugin members
        public bool IsLoaded { get; private set; }

        public void Load()
        {
            IsLoaded = true;
        }

        public event Action<IPlugin, Microsoft.SilverlightMediaFramework.Plugins.Primitives.LogEntry> LogReady;

        public event Action<IPlugin, Exception> PluginLoadFailed;

        public event Action<IPlugin> PluginLoaded;

        public event Action<IPlugin, Exception> PluginUnloadFailed;

        public event Action<IPlugin> PluginUnloaded;

        public void Unload()
        {
            IsLoaded = false;
        }
        #endregion
    }
} 
```

# git - 多个开发人员处理同一任务的正确 git 工作流程方案

> ID：14865283
> 
> 赞同：59
> 
> 时间：2013-02-13T23:34:11.197
> 
> 标签：git, workflow, bitbucket, branching-and-merging

我是我们 Web 开发公司的团队负责人，我想在我们的团队中实施 Git 工作流程。阅读文档和文章，我发现以下结构对我们有好处：

我们在 Bitbucket 中有一个存储库。**Master**分支被认为只包含稳定的代码。每个开发人员都必须创建自己的分支并在自己的分支中实现功能/错误**修复**。一旦他决定，他的代码已经准备好了，他就会创建一个不错的分支历史记录（使用 rebase、amend、cherry-pick 等）并将其推送到 Bitbucket，在那里创建一个到 master 分支的拉取请求。QA 验证功能并批准（或不批准）它，然后我正在验证代码，如果没问题，我将他的工作合并到 master 中（通过快进或 rebase 以获得更好的提交历史）。

但是这种方案仅在单个开发人员在分支上工作的情况下才有效。在我们的例子中，一个分支几乎总是有两个开发人员，因为一个开发人员在*服务器端*(PHP) 工作，而另一个开发人员在*客户端*(HTML/CSS/JS) 工作。这两者应该如何以某种方式协作，使 master 中的提交历史保持干净？

服务器开发创建 HTML 文件的基本结构，客户端开发需要获取此结构。从逻辑上讲，服务器开发者创建一个分支，客户端开发者根据服务器开发者分支创建自己的分支。但这意味着，该服务器开发人员需要在 Bitbucket 中*发布*他的分支，这将使他*无法重新设置或更改*已发布的提交。

另一种选择是等待，直到服务器开发人员完成他的工作，发布具有良好提交历史的分支并忘记它，并且只有在客户端开发人员开始在该分支中工作之后，但这会导致时间延迟，这会更糟。

您如何处理工作流程中的此类协作？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-02-14T07:04:56.227

我无法真正谈论您帖子中描述的方法的优点，但我可以描述我们如何解决我们在工作中使用的工作流程中的协作编码。

我们使用的工作流程是众多分支之一。因此，我们的结构是：

师父是金；只有合并大师会触及它（稍后会详细介绍）。

有一个 dev 分支，最初取自 master，所有开发人员都可以工作。我们不是为每个开发人员创建一个分支，而是从 dev 中创建功能或票证分支。

对于每个谨慎的功能（错误、增强等），都会从 dev 创建一个新的本地分支。开发人员不必在同一个分支上工作，因为每个功能分支的范围仅限于单个开发人员正在处理的内容。这就是 git 的廉价分支派上用场的地方。

一旦功能准备就绪，它会在本地合并回 dev 并推送到云端（Bitbucket、Github 等）。每个人都通过经常拉动开发来保持同步。

我们是每周发布计划，所以每周，在 QA 批准 dev 分支后，会创建一个发布分支，名称中包含日期。那是生产中使用的分支，取代了上周的发布分支。

一旦发布分支在生产环境中由 QA 验证，发布分支就会合并回 master（和 dev，只是为了安全起见）。这是我们唯一一次接触主人，确保它尽可能干净。

这对我们有 12 人的团队很有效。希望对我们有所帮助。祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-04-29T15:38:41.630

我认为仍然没有人真正回答有关如何在主题分支中进行协作以保持干净历史的原始问题。

正确的答案是*对不起，你不能把所有这些放在一起*。你只能修饰你的私人本地历史，在你为其他人发布一些东西之后，你应该在此基础上工作。

在服务器开发不关心客户端开发更改的特定情况下，您可以做的最好的事情是在本地从开发/功能分支中分叉客户端分支，并在完成功能之前将该部分重新设置在服务器工作之上 - 或放松您的约束并像您一样切换到不同的工作流程；）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-01-19T23:00:03.190

我们有一个主存储库，每个开发人员都有一个分支。

创建一个分支 principal/some_project，然后在每个开发者的 fork 上创建相同的分支名称，fork/some_project。

（我们使用smartgit，并且我们还有一个政策，即遥控器被命名为'principal'和'fork'而不是'origin'和'upstream'，这只会让新用户感到困惑）。

每个开发人员还有一个名为 some_project 的本地分支。

开发人员本地分支 some_project 跟踪远程分支 principal/some_project。

开发人员在分支 some_project 上进行本地工作并推送到他们的 fork/some_project，他们不时创建拉取请求，这就是每个开发人员的工作如何合并到 principal/some_project 中的方式。

通过这种方式，开发人员可以自由地在本地拉/变基并推送到他们的分叉 - 这几乎是标准的分叉工作流程。通过这种方式，他们获得了其他开发人员的提交，并且可能不时需要解决奇怪的冲突。

这很好，现在需要的只是一种合并出现在 principal/master 中的持续更新的方法（例如在 some_project 完成之前交付的紧急修复或其他项目）。

为了实现这一点，我们指定了一个“分支负责人”，他们的角色是使用 SmartGit 中的合并（而不是拉取，变基）将来自 master 的更新本地合并到 some_project 中。这有时也可能产生冲突，必须解决这些冲突。完成此操作后，开发人员（分支负责人）强制推送到他们的 fork/some_project 分支，然后创建一个拉取请求以合并到 principal/some_project。

合并该拉取请求后，principal/master 上的所有新提交现在都出现在 principal/some_project 分支上（并且没有任何内容被重新定位）。

因此，下次每个开发人员都在 some_project 上并拉取（回想一下，他们跟踪的分支是 principal/some_project）时，他们将获得所有更新，其中包括从 principal/master 合并的内容。

这听起来可能很啰嗦，但实际上相当简单和健壮（每个开发人员也可以从主体/主服务器本地合并，但如果一个人这样做会更整洁，团队的其他成员生活在一个简单的世界中，就像单个开发人员的工作流程一样） .

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-14T04:38:21.667

> 这将使他无法更改已发布的提交或更改提交。

这取决于你的听众。“服务器开发”可以将“基本结构”推送到 Bitbucket，以便“客户端开发”可以访问它。**是的，这确实可能**意味着其他人将有权访问这些“临时”提交。

**然而，只有当另一个用户在这些提交被重新定位之前**从其中一个提交中分支时，这才会是一个问题。在较小的项目/较小的用户群中，即使在变基发生之前，这些临时提交也可能永远不会被注意到，从而消除了风险。

如果有人从这些临时提交分支的风险太大，则由您决定。如果是这样，那么您可能需要为这些私有更改创建第二个私有 Bitbucket 存储库。另一种选择是[**合并提交**](http://github.com/dchelimsky/rspec/wiki/Topic-Branches) 而不是变基，但这也不理想。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-08-17T07:31:10.460

要记住的规则是：

*   有 1 个`master`和 1 个`develop`分支
*   让功能分支从分支`develop`产生
*   每次您准备好供**QA**测试的版本时，合并到`develop`
*   让发布分支从分支`develop`产生
*   在发布分支中进行错误修复
*   当您准备好供**QA**测试的版本时，合并到`develop`
*   **当您为PRODUCTION**准备好版本时，合并到`master`并为其创建标签

下图是世界各地团队遵循的靶心策略（图片来源：取自[这里](https://nvie.com/posts/a-successful-git-branching-model/)）：

[![在此处输入图像描述](../Images/6c41b5a12ac66f610485a0eebe959174.png)](https://i.stack.imgur.com/H25de.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-04-07T04:09:53.113

对于确切的问题，多个开发人员在同一任务上，简短的回答是该任务是在该任务的集成分支中完成的。该“任务”分支被视为通常 Git 工作流程中的“主”或“开发”分支（正如此处提供的大多数答案）。此集成分支在其他地方详细说明的“Git 功能分支工作流程”中处理。

该任务分支是处理该任务的开发人员使用普通 Git 命令共享代码的地方。

**例子**

要开发新的启动画面，首席开发人员（或某人）会

```
git co master
git co -b feature-splash
git push origin feature-splash 
```

每个致力于此功能的开发人员都会：

```
git co master
git pull
git co feature-splash
git co -b my-feature-splash  // they can name their branch whatever 
```

现在，每个开发人员都将在他们的分支上进行开发，并在中央 Git 存储库服务器（如 GitHub）上的功能飞溅上创建合并请求。就像为神圣的“主”分支所做的那样。

功能完成后，功能飞溅将合并到主控中。当然，这个特性飞溅必须与 master 上的新代码保持同步。功能飞溅可以使用基于 master 的 rebase 吗？

这不是我最初的想法。我在不同的地方读到过这个。请注意，在许多工作流文章中，这个特定于任务的分支并不是一个真正的概念。例如，在一篇文章中，我们有“功能分支通常仅存在于开发者存储库中，而不存在于原始库中。” 也许需要多个开发人员的任务总是被分解为子任务？我想如果你知道未来并且知道需要什么。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-06-04T18:09:34.203

让我告诉你当多个开发人员在同一个项目上工作时我们在这里做什么（甚至有时在同一个控制器/模型/视图上工作）。

首先，我们的团队负责人创建了带有两个分支的 git-project

1.  大师（被保护了，除了领队，没有人能推到这里）
2.  开发（所有开发者都可以在这里推送）

他们告诉我们在本地环境中工作，并在我们完成一项分配的任务时创建提交。

现在在晚上（或者说关闭时间 - 离开），我们这样做：

1.  Git 拉取

每个在同一个项目上工作的开发人员将当前的开发分支拉到他们的本地（早上做同样的事情 - 当一天开始时）。

然后团队负责人告诉开发人员提交所有代码并一一推送，然后一拉。

例如。

*   dev1 创建提交并推送到服务器
*   dev2 再次拉取并创建提交和推送
*   dev3 再次拉取并创建提交和推送
*   等等..

现在的问题是冲突：

*   有时，当从开发分支中提取代码时，git 会通知我们自动合并了所有冲突——这意味着 git 自动应用了另一个开发人员所做的新更改
*   但有时 SAME git 告诉自动合并失败并显示一些文件名
*   然后团队领导角色出现了——他所做的是：“他审查所有列出的文件（在自动合并失败的过程中）并手动合并冲突并创建提交并推送到服务器。

现在如何手动合并：GIT 只需更新冲突文件，所有内容如下：

```
<<< HEAD
New lines from server that you don't have is here shown
=====
Your current changes....
>>> [commit id] 
```

团队领导在分析后更新该文件：

```
 New lines from server that you don't have is here shown
 Your current changes 
```

并创建提交和推送。

早上我们再次拉动（只是为了确保我们没有错过前一天的任何东西），这就是我们在这里工作的方式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-14T07:19:28.223

您可能会看到[Git-flow](https://github.com/nvie/gitflow)这可能会对您有所帮助

[http://nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)

# geometry - 从一个点查找给定半径的所有像素，限制在弧内

> ID：14865284
> 
> 赞同：1
> 
> 时间：2013-02-13T23:34:12.757
> 
> 标签：geometry, pixel, computational-geometry, geometric-arc

我正在研究一个部分通过超声波接近传感器导航的自主漫游车。在我们实现硬件之前，我们想用我现在正在编写的模拟器对我们的算法进行一些测试。

我遇到麻烦的一项任务是超声波传感器具有 60 度的视野。如果检测到对象，则该半径处沿该 60 度弧的任何点都*可能*有对象，但该半径以下的所有点都*保证*没有对象。

我需要做的是编写一个函数，该函数具有 (x,y) 坐标和方位角（我现在将其限制为 4 个基数）并让它返回给我一个半径内的像素列表和一个该半径处的像素列表。通过从多个位置和方位重复扫描，可以找到所有对象。

我最初的想法是迭代地工作。从传感器前面的行开始，以逐渐加宽的扫描（1、1、3、3、5、5、7、7 等）来回扫描。然而最终半径停止与行对齐。我的新搜索路径是弄清楚如何用像素绘制弧线，然后将半径逐步提高到第一次碰撞。

这个问题提出了一个类似的问题，但只对特定点感兴趣，所以我认为这是一个根本不同的问题。

[如何从给定点（经度，纬度）计算给定半径内的所有点（经度，纬度）？](https://stackoverflow.com/questions/10868501/how-to-calculate-all-pointslongitude-latitude-within-a-given-radius-from-given)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T05:36:48.597

您可以使用任何[Floodfill 方法](http://en.wikipedia.org/wiki/Flood_fill)来获取扇区中的所有整数点。预先计算起始角和结束角为

```
S_Angle = Center_Bearing - Pi/6
E_Angle = Center_Bearing + Pi/6 
```

重要价值观：

```
S_Cos = Cos(S_Angle)
S_Sin = Sin(S_Angle)
E_Cos = Cos(E_Angle)
E_Sin = Sin(E_Angle) 
```

扇区填海的边界条件：

```
(x-x0)*S_Sin-(y-y0)*S_Cos >= 0  //point is left to starting ray
(x-x0)*E_Sin-(y-y0)*E_Cos <= 0  //point is right to ending ray
(x-x0)^2+(y-y0)^2 <= R^2        //point is in the range 
```

（可能您可能需要在第一个不等式对中交换 >= 和 <=）

# mule - mule studio 多个项目运行连接被拒绝

> ID：14865287
> 
> 赞同：1
> 
> 时间：2013-02-13T23:34:55.270
> 
> 标签：mule, mule-studio

我在 Mule 工作室做一些开发。我在 2 个不同的项目中有 2 个 REST 服务，并希望在我的环境中运行它们。当我独立运行它们时，它们运行正常。

8081 端口上的服务 A 正在调用 8083 端口上的服务 B（帐户）。

我在端口 8081 上为服务 A 运行作为 Mule 应用程序，然后在端口 8083 上为服务 B 执行相同的操作。

当流程转到服务 BI 的标注时，会出现以下错误。

谢谢您的帮助。

```
`ERROR 2013-02-13 16:03:05,213 [[OpportunityAccountByOpportunityId].connector.http.mule.default.receiver.02] org.mule.exception.DefaultMessagingExceptionStrategy: 
********************************************************************************
Message               : Failed to route event via endpoint: DefaultOutboundEndpoint{endpointUri=http://`localhost`:8083/Account/1_0/AccountReadById?id=0013000000HQY30AAH, connector=HttpConnector
{
  name=connector.http.mule.default
  lifecycle=start
  this=6c22e349
  numberOfConcurrentTransactedReceivers=4
  createMultipleTransactedReceivers=true
  connected=true
  supportedProtocols=[http]
  serviceOverrides=<none>
}
,  name='endpoint.http.`localhost`.8083.Account.1.0.AccountReadById.id.0013000000HQY30AAH', mep=REQUEST_RESPONSE, properties={id=0013000000HQY30AAH, http.method=GET}, transactionConfig=Transaction{factory=null, action=INDIFFERENT, timeout=0}, deleteUnacceptedMessages=false, initialState=started, responseTimeout=10000, endpointEncoding=UTF-8, disableTransportTransformer=false}. Message payload is of type: GetMethod
Code                  : MULE_ERROR--2
--------------------------------------------------------------------------------
Exception stack is:
1\. Connection refused: connect (java.net.ConnectException)
  java.net.PlainSocketImpl:-2 (null)
2\. Failed to route event via endpoint: DefaultOutboundEndpoint{endpointUri=http://`localhost`:8083/Account/1_0/AccountReadById?id=0013000000HQY30AAH, connector=HttpConnector
{
  name=connector.http.mule.default
  lifecycle=start
  this=6c22e349
  numberOfConcurrentTransactedReceivers=4
  createMultipleTransactedReceivers=true
  connected=true
  supportedProtocols=[http]
  serviceOverrides=<none>
}
,  name='endpoint.http.`localhost`.8083.Account.1.0.AccountReadById.id.0013000000HQY30AAH', mep=REQUEST_RESPONSE, properties={id=0013000000HQY30AAH, http.method=GET}, transactionConfig=Transaction{factory=null, action=INDIFFERENT, timeout=0}, deleteUnacceptedMessages=false, initialState=started, responseTimeout=10000, endpointEncoding=UTF-8, disableTransportTransformer=false}. Message payload is of type: GetMethod (org.mule.api.transport.DispatchException)
  org.mule.transport.http.HttpClientMessageDispatcher:155 (http://www.mulesoft.org/docs/site/current3/apidocs/org/mule/api/transport/DispatchException.html)
--------------------------------------------------------------------------------
Root Exception stack trace:
java.net.ConnectException: Connection refused: connect
      at java.net.PlainSocketImpl.socketConnect(Native Method)
      at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
      at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
    + 3 more (set debug level logging or '-Dmule.verbose.exceptions=true' for everything)
********************************************************************************` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T11:16:35.653

[从这个jira](http://www.mulesoft.org/jira/browse/STUDIO-2458)可以看出，目前不可能同时运行多个应用程序。

要克服这个问题，您有 2 个选择：

1.  创建一个单独的集成测试项目，该项目依赖于两个 mule 应用程序，并在[功能测试用例中一起运行所有流程](http://www.mulesoft.org/documentation/display/current/Functional+Testing)
2.  使用[org.mule.MuleServer](https://mulesoft.com/docs/site/3.3.0/apidocs/org/mule/MuleServer.html)主类将您要加载的所有配置文件传递给它

# java - 更改 TableModel 结构

> ID：14865297
> 
> 赞同：0
> 
> 时间：2013-02-13T23:35:36.697
> 
> 标签：java, swing, jtable, tablemodel, defaulttablemodel

所以情况是我有一个 JTable，其中有许多 JComboBox 作为单元格。在选择 JComboBox 的元素时，需要改变表模型的结构。我下面还有一个“输出表”，它监听 JComboBox 的选择并相应地重新验证，因此，我需要保持查询表的模型相同，以便它可以重用监听器。如何更改表模型的结构？

```
DefaultTableModel QueryTableModel = new DefaultTableModel(dropDownUserSelection, resultsListHeadings );     
queryTable.setModel(QueryTableModel);

JComboBox box = new JComboBox(boxModel);      
queryTable.getColumnModel().getColumn(i).setCellEditor(new DefaultCellEditor(box)); 
```

如果我要问一个已经在其他地方问过的问题，我很抱歉，但是我四处逛逛，找不到我要找的东西。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:57:30.457

有`TableModel`责任通知父表（或任何收听的人）模型的更改。

可用的一般事件是数据更改、单元格更新、行插入/删除和结构更改。

“结构已更改”告诉父表表模型的结构（列数和/或列名和/或类型已更改）并且应该完全更新自身。

有多种方法可以实现这一目标。您可以让现有的表模型相应地自行更改并触发“结构更改”事件，或者您可以构建一个新的表模型并将其应用于`JTable`，具体取决于您的需要。

# git - 使用分支增量提取子树

> ID：14865305
> 
> 赞同：12
> 
> 时间：2013-02-13T23:36:34.693
> 
> 标签：git, git-subtree

我`git-subtree`用来从我的项目中提取目录。

```
git subtree split --prefix=src/SubProject --branch=SubProject origin/master 
```

鉴于这就是我希望开始项目的方式（特别是 no ），我如何才能在连续运行时`--rejoin`仅将更改从`origin/master`to拆分？`SubProject`

对于较小的项目，这一直运行良好。我可以忍受大约 5 秒的时间来拆分项目。但在较大的存储库上，这可能需要相当长的时间。我已经看到每次拆分最多需要五分钟。我想合作的一些项目在一个存储库中有超过 45 个子项目。

我尝试了很多我认为可能有效的方法，但每一种都以某种方式失败了。我的要求是：

*   不得以任何方式弄乱`origin/master`（所以大多数情况`--rejoin`下是不可能的）
*   它不能添加额外的合并提交（想想：`--ff-only`当从 获取新更改时`origin/master`）
*   存储库`SubProject`必须具有稳定的提交 ID。这意味着在对 进行一次或多次增量更新后`SubProject`，如果我重新运行本文顶部的原始命令，它的历史记录中应该具有相同的提交 ID。
*   它必须是自动化的，不需要人工干预

我不害怕复杂的解决方案，但它需要自动化。因为历史改变而失败是好的；此时脚本可以退回以从头开始构建整个事物。在这种情况下，用户知道他们做了什么，所以他们可以从头开始经历一个非常漫长的重建过程。:)

### --重新加入

我尝试使用`--rejoin`并保留一个额外的`origin/master`around副本，作为`--rejoin`. 我在这里遇到的问题是我无法干预`git rebase origin/master`或`git merge --ff-only origin/master`不干预。我需要能够以自动化的方式做到这一点，所以这是不可接受的。

### 合并提交

我能够让它按我的意愿工作，`git merge origin/master`但它导致了合并提交。由于此合并提交永远不会上游，因此我认为无法预测未来的历史，因此`git subtree split`原始环境中的新鲜事物将无法重现相同的确切历史。*我可能错了。如果是这样，请向我解释这将如何安全。:)*

### 提交范围

我尝试使用提交范围，并且能够创建一个新的子树拆分，`SubProject`其中仅包含从某个时间点到`HEAD`. 这可能会起作用，除非它看起来好像生成了一组新的提交 ID，所以我认为这不是一个选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-07T02:10:54.993

实施[了一个补丁](https://gist.github.com/vi/5529807)来`subtree split`简化玩这个。现在，您可以显式指定在没有其他父级时填充的父级：

```
$ git init
$ for i in {1..100}; do
   echo $i >q
   git add q
   git commit -m $i
   mkdir -p qqq
   echo $i > qqq/w
   git add qqq/w
   git commit -m "qqq/$i"
done

$ # let's do full split
$ /home/vi/src/git/git/contrib/subtree/git-subtree.sh split \
    --prefix=qqq --branch qqq HEAD
...7/200 (6)...58/200 (57)...142/200 (141)...176/200 (175)...
Created branch 'qqq'
f5120d3e676e2966802c8829b13a34c8d0c2dac4

$ # now let's do partial split
$ /home/vi/src/git/git/contrib/subtree/git-subtree.sh split \
    --prefix=qqq --branch qqq2 HEAD~100
...20/100 (19)...
Created branch 'qqq2'
3632fb9fc5c7a7f0b4bf8c6743e2cd372a6d8e52

$ # Now let's "continue the work" on qqq2
$ /home/vi/src/git/git/contrib/subtree/git-subtree.sh split \
   --prefix=qqq --branch qqq2 \
   --graft-parent=3632fb9fc5c7a7f0b4bf8c6743e2cd372a6d8e52 \
   HEAD~100..HEAD
Grafting 3632fb9fc5c7a7f0b4bf8c6743e2cd372a6d8e52\n
...10/100 (9)...
Updated branch 'qqq2'
f5120d3e676e2966802c8829b13a34c8d0c2dac4 
```

# drupal-7 - 在 Drupal 中创建 Web 表单时看不到表单字段

> ID：14865310
> 
> 赞同：0
> 
> 时间：2013-02-13T23:37:02.947
> 
> 标签：drupal-7, drupal-webform

我正在尝试使用 Drupal 7 中的 Webform 3.18 创建问卷。但是，当我创建表单时，我看不到任何要添加的表单字段。我不知道该怎么做。有人有什么建议吗？我还附上截图。

![](../Images/a5c38651b5c9d4771bb04902ed19a0f0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-03T13:59:20.137

我的情况是表单生成器和 Webform 的版本。如果使用 Form Builder 7.x-1.6 和 Webform 7.x-4.2，症状如下所示。如果使用 Webform 7.x-4.1 或 7.x-3.21 和 Form Builder 7.x-1.5（不适用于 7.x-1.6），一切正常。似乎可能与[https://www.drupal.org/node/2383285有关](https://www.drupal.org/node/2383285)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T17:03:45.970

好的，所以我想通了。启用了一个名为“表单生成器 Webform UI”的模块，这导致了问题。禁用它可以解决问题。

# powershell - 在路径更改时执行 PowerShell 函数

> ID：14865313
> 
> 赞同：2
> 
> 时间：2013-02-13T23:37:13.587
> 
> 标签：powershell

是否可以在 PowerShell 控制台或 ISE 中的当前路径更改时执行某些代码（例如函数、脚本块、cmdlet 等）？

我正在考虑的方案是根据当前文件夹修改一些环境变量并点源一些特定于位置的 PowerShell 函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T01:23:46.910

你有几个选择。您可以删除“cd”别名，然后编写“cd”函数并添加所需的逻辑。这种方法的缺点是，如果有人使用 Set-Location，您的功能就会被绕过。另一种选择是为 Set-Location 创建代理命令。[谢伊（和柯克）在这里](http://blogs.microsoft.co.il/blogs/scriptfanatic/archive/2012/03/30/leveraging-proxy-functions-in-powershell.aspx)有一个关于如何做到这一点的视频。这种方法的好处是更改目录（cd 和 Set-Location）的内置方法将通过您的代理命令。

# iphone - 如何通过 Xcode 在我的设备上运行发布配置

> ID：14865314
> 
> 赞同：2
> 
> 时间：2013-02-13T23:37:25.030
> 
> 标签：iphone, ios, xcode

我可以在模拟器中很好地测试发布配置，但它在我的设备上不起作用。我可以很好地将应用程序包安装到设备上，但它不会直接从 xcode 运行。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:39:02.440

进入该目标的构建设置并将 Code Signing Identity for Release: Any iOS SDK 更改为开发人员配置文件而不是分发。这将允许您在调试器中运行发布配置。请记住在提交时将其恢复为分发！

# asp.net-mvc - ASP Web 应用程序是否可能具有不同的背景颜色，具体取决于托管应用程序的服务器

> ID：14865315
> 
> 赞同：0
> 
> 时间：2013-02-13T23:37:26.823
> 
> 标签：asp.net-mvc

我有一个 MCV 应用程序。我有一个在本地 PC 上运行的工作副本，一个位于我的应用程序服务器上的生产副本。为了快速测试小修订，我希望办公室另一端的用户在我更新服务器上的文件之前访问我的本地副本。但我不希望用户能够将 mypc/myapp 与 myserver/mypp 混淆。为此，我想也许我在某处有一些配置，上面写着：如果托管在“myserver”上，则背景颜色为黑色；否则背景颜色为红色，或其他东西。

这可能吗，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:14:58.430

有很多方法可以做到这一点。

最快和最简单的方法就是在您的 web.config 中有一个密钥，在您的生产服务器上设置为 true。

```
<appSettings>
<add key="production" value="true" />
</appSettings> 
```

为您的开发背景颜色添加一个新的 CSS 类到您的样式表

```
.development-bg {
background-color: #FF49F2;
} 
```

然后在 _Layout.cshtml 的顶部（假设您使用的是 razor 视图引擎）

```
@{       
    if(System.Configuration.ConfigurationManager.AppSettings["production"] != "true")
    {
        ViewBag.BackgroundColorCssClass = "development-bg";   
    }
} 
```

然后修改_Layout.cshtml中的body标签

```
<body class="@ViewBag.BackgroundColorCssClass"> 
```

或者，如果您不想拥有 web.config 值，您可以尝试以下操作

```
@{
    if(HttpContext.Current.Server.MachineName == "your machine name")
    {
        ViewBag.BackgroundColorCssClass = "development-bg";    
    }
} 
```

就像我说的，有很多方法可以做到这一点。这种方式非常简单，但可能适合您的需求。

# mongodb - mongoDB 集名称不匹配

> ID：14865316
> 
> 赞同：8
> 
> 时间：2013-02-13T23:37:27.433
> 
> 标签：mongodb, replication, database

我的机器上运行了 3 个 mongod 演示复制服务器。我使用以下命令创建复制服务器：

```
F:\>mongod --replSet test2 --dbpath 2 --port 27112 --oplogSize 50 --logpath log.2 --logappend
all output going to: log.2 
```

像这样，我在 27111 端口上有 test1，在 27112 端口上有 test2，在 27113 端口上有 test3。然而在配置我得到一个错误：

```
cfg = {
        "_id" : "test1",
        "members" : [
                {
                        "_id" : 0,
                        "host" : "localhost:27111"
                },
                {
                        "_id" : 1,
                        "host" : "localhost:27112"
                },
                {
                        "_id" : 2,
                        "host" : "localhost:27113"
                }
        ]
}
> rs.initiate( cfg )
{
        "errmsg" : "couldn't initiate : set name does not match the set name host localhost:27112 expects",
        "ok" : 0
} 
```

现在我该怎么做才能使它匹配？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T17:14:13.163

我将运行的所有集合都应该具有相同的名称。例如，如果我运行

```
mongod --replSet test2 --dbpath 2 --port 27112 --oplogSize 50 --logpath log.2 --logappend
all output going to: log.2 
```

然后我打算在该集合中的其他 mongo 服务器应该具有相同的名称`test2`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-17T01:05:20.493

中使用的名称或变量 `"cfg" = { "_id":="test1" }`

应使用以下用于`replSet`该复制集中所有成员的参数的名称进行确认。

然后一切都会为你顺利进行

```
"start mongod --replSet "test1" --logpath "1.log" --dbpath C:\Replica\rs01 --port 27017 --oplogSize 64 
```

祝你好运

饶

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T00:21:11.053

尝试使用您的机器名称或 127.0.0.1。最佳做法是使用 DNS 名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-18T15:58:41.350

MongoDB 副本集不接受`localhost`. 在将节点添加到副本集时尝试使用实际的机器名称，如下所示：

```
rs.add("MY_MACHINE_NAME:27017"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-17T14:11:54.663

添加副本集时，所有三个的 --replset 应该相同。例如，如果主要是“rs01”，那么其他两个也应该相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-22T03:46:40.993

以下步骤对我有用：

```
mongod --port 27017 --dbpath "C:\MongoDB\data01" --replSet rs0 --bind_ip localhost
mongod --port 27018 --dbpath "C:\MongoDB\data02" --replSet rs0 --bind_ip localhost 
```

这两行在不同的端口启动了两个不同的 mongo 实例。在第二个实例中，我在 mongod.conf 中添加了 replSet=rs0。

然后通过以下命令在 rs0 节点中添加辅助节点：

```
rs.add("localhost:27018") 
```

# iphone - 硬件音量按钮更改应用程序音量

> ID：14865317
> 
> 赞同：1
> 
> 时间：2013-02-13T23:37:27.623
> 
> 标签：iphone, ios, objective-c, cocos2d-iphone, volume

因此，在我的应用程序中，我想通过使用硬件按钮来更改应用程序内的音量级别以进行警报，但是每当我使用按钮调高或调低音量时，它只会更改“铃声”音量，这不会影响我的在应用程序中。

在“设置”->“声音”下，“使用按钮更改”开关处于打开状态，如果我将其关闭，一切正常，但大多数用户也希望将其打开。因此，当我在我的应用程序中时，我希望音量按钮更改应用程序音量而不是铃声音量。

希望有意义

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:51:48.033

默认情况下，硬件按钮将更改警报音量，除非您在使用按钮时打开音频会话。我建议打开一个 AVAudioSession 让他们改变它，或者在你的应用程序的某个地方放置一个音量滑块让他们改变音量。

这是一个很难完美解决的问题，因为用户没有被告知哪里出了问题，而且很多时候也看不到铃声音量正在被改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:14:01.317

使用[MPVolumeView](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPVolumeView_Class/Reference/Reference.html)！

如果您添加一个（`MPVolumeView`您`UIWindow`可以将其隐藏），`MPVolumeView`它将自动为您接管硬件按钮。硬件按钮现在将影响您的应用程序的音量级别，而不是系统的。

```
MPVolumeView *volumeView = [[MPVolumeView alloc] initWithFrame:CGRectZero];
volumeView.showsRouteButton = NO;
volumeView.hidden = YES;
[self.window addSubview:volumeView]; 
```

# python - 无论绘制的类型如何，如何删除 matplotlib 的通用内容

> ID：14865319
> 
> 赞同：1
> 
> 时间：2013-02-13T23:37:31.507
> 
> 标签：python, matplotlib

我环顾四周，发现了许多从情节中删除内容的巧妙方法。

例如 lines = blah, del lines[0], line 消失了。

但这显然不适用于直方图，例如 imshow。

有没有办法清除绘图区域（即不使用 clf()）而不必重新生成整个图形。这要求您对当前绘制的内容没有严格的了解，但仍然能够将其删除。我正在开发一个使用相同区域进行绘图的应用程序，我想要一种通用方法来删除我想要显示的不同类型图形的内容。一些线条，一些分散，一些组织等。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:50:35.230

您可以在 an 上显示的所有内容`axes`都是 的子类`Artist`并具有成员函数`remove` [(doc)](http://matplotlib.org/api/artist_api.html#matplotlib.artist.Artist.remove)。所有绘图函数（应该）返回它们添加到轴的`artist`（或列表）。`artists`前任：

```
ln, = ax.plot(...) # adds a line
img = ax.imshow( ) # adds an image
ln.remove()        # removes the line
img.remove()       # removes the image 
```

在更改可见之前，您必须重新绘制画布（`plt.draw()`或）。`ax.figure.canvas.draw()`

您可以获得给定的所有艺术家的`axes`列表

```
artist_list = ax.get_children() 
```

如果要从轴上删除所有内容，

ax.cla()

# arrays - 哪个库可以有效地处理 R 中的角落解决方案？

> ID：14865322
> 
> 赞同：0
> 
> 时间：2013-02-13T23:37:53.743
> 
> 标签：arrays, r, minimization

目前我正在尝试在 R 中进行最小化（优化）问题，其中我有一个向量 X1，我想通过矩阵 X2 的加权平均值和权重向量 w 来近似它。这意味着我想最小化

```
wg <- function(w)
{
    t(X1 - X2 %*% w) %*% (X1 - X2 %*% w)
} 
```

权重的约束是 w[i]>= 0 和 sum(w) = 1 。

目前我正在使用 DEoptim 包进行优化，但我觉得它不能很好地处理角落解决方案。

我正在复制经济学论文中使用的一种方法，在那篇论文中几乎所有的权重都为零。在我的案例中，我预计会有类似的结果（我想通过其他州的加权平均值来模拟亚利桑那州），尤其是由于经济形势的异质性。

目前，我觉得 DEoptim 包的问题比我的方法问题更大，而且我不太相信结果。我可以使用哪些其他软件包，最好是那些在寻找角落解决方案方面更强大的软件包？

我的 DEoptim 设置如下：

```
controlDE <- list(reltol=.0000000001,steptol=150, itermax = 5000,trace = 250)
#control parameters

outDEoptim <- DEoptim(fn = wg, lower = rep(0, N), upper = rep(1, N), 
    control = controlDE) 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T10:38:25.943

随机求解器（例如`DEoptim`will 本质上）难以在低维子集（例如由 定义的子集）上找到最优解`sum(w) = 1`。

有一种第一种但不完全正确的方法是通过设置将问题减少到 (n-1) 维`w <- c(w, 1-sum(w))`。最后一个分量可能小于 0，但通常不会。现在申请`DEoptim`或`optim`：

```
set.seed(1357); m <- 4; n <- 5
X2 <- round(matrix(runif(20), m, n), 2)
X1 <- X2 %*% c(0, 1, 0, 0, 0)               # solution c(0,1,0,0,0)

wg <- function(w) {                         # length(w) == 4
    w <- c(w, 1 - sum(w))
    t(X1 - X2 %*% w) %*% (X1 - X2 %*% w)    # sum((X1 - X2 %*% w)^2)
}

w0 <- rep(1/n, n-1)                         # initial point (1/n, ..., 1/n)
optim(w0, wg, lower = rep(0, n), upper = rep(1, n),
        method = "L-BFGS-B", control = list(factr = 1e-8))
## $par
## [1] 0 1 0 0                              # wmin = c(0,1,0,0,0) 
```

或者，您在 R 中应用可以处理等式约束的求解器之一，例如`Rdonlp2`（在 R-Forge 上）、`auglag`包 alabama 或`slsqp`包 nloptr 中。但我觉得这会有点过头了。

# iphone - 无需旋转即可立即使视图变为纵向

> ID：14865328
> 
> 赞同：1
> 
> 时间：2013-02-13T23:38:15.747
> 
> 标签：iphone, ios, xcode, rotation, uiinterfaceorientation

目前，我在所有视图中都有此代码，我不想进入横向，除了一个：

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
// You do not need this method if you are not supporting earlier iOS Versions
return [self.selectedViewController shouldAutorotateToInterfaceOrientation:interfaceOrientation];
}

-(NSUInteger)supportedInterfaceOrientations
{
if (self.selectedViewController)
    return [self.selectedViewController supportedInterfaceOrientations];

return UIInterfaceOrientationMaskPortrait;
}

-(BOOL)shouldAutorotate
{
return YES;
} 
```

这是我的标签栏控制器中的代码：

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
// You do not need this method if you are not supporting earlier iOS Versions
return [self.selectedViewController shouldAutorotateToInterfaceOrientation:interfaceOrientation];
}

-(NSUInteger)supportedInterfaceOrientations
{
if (self.selectedViewController)
    return [self.selectedViewController supportedInterfaceOrientations];

return UIInterfaceOrientationMaskPortrait;
}

-(BOOL)shouldAutorotate
{
return YES;
} 
```

最后是我想要进入横向的视图控制器中的代码（因为有一个视频）：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return YES;
}

- (BOOL)shouldAutorotate
{
return YES;
}

- (NSInteger)supportedInterfaceOrientations
{
return UIInterfaceOrientationMaskAllButUpsideDown;
} 
```

视图都像我想要的那样旋转，唯一的问题是当带有视频的视图控制器旋转时，然后您单击另一个视图，该视图将保持在横向，我想要发生的是这个视图直接旋转成纵向无需用户将设备旋转为纵向。有人知道我需要什么代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:57:59.687

这可能是一个难以优雅地解决的问题。强制方向可能会违反人机界面规则规则，或者过去只需要调用私有 API

我建议尝试一种过去对我有用的不同方法。当用户旋转显示视频的一个视图控制器时，允许其旋转，但此时删除用户可以导航离开的任何方式，然后在他们将设备旋转回纵向时返回这些导航控件。对我来说，它只是隐藏导航栏，直到他们返回肖像。我喜欢这个，因为用户很清楚他们必须在继续前进之前将手机恢复为纵向，并且他们不会对导航到神奇的另一个方向的其他地方感到惊讶。

# java - 部署使用数据库的 Swing 应用程序

> ID：14865330
> 
> 赞同：0
> 
> 时间：2013-02-13T23:38:33.913
> 
> 标签：java, swing, netbeans

我在 NetBeans IDE 中创建了一个带有数据库的 Java Swing 应用程序。我有一个直接在 NetBeans 中创建的数据库。如何安排安装此应用程序以在 NetBeans IDE 之外运行？例如在 Windows 中。当我有没有数据库的应用程序时，这很容易；但数据库我不知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T21:13:20.483

您需要安装一个数据库，例如：

*   mysql、微软 sql、sqlite 等

您还可以获得这些只需要解压缩并运行的可移植版本（例如 xampp 中的 mysql）。

您将需要创建一个脚本（在您的程序中或手动执行）来创建必要的模式和所需的表。

您的应用程序必须为您的数据库以及来自 java 的请求具有相同的凭据。

如果您手动进行安装，您通常会手动完成以上所有操作。数据库不必在同一台计算机上，但可以在同一网络上或互联网上 - 但它必须在某个地方，除非您使用像 sqllite 这样的便携式设备。

如果您创建一个自动安装脚本，您应该在您的问题中定义它。

# c++ - 使用此指针检查对象的相同实例？

> ID：14865336
> 
> 赞同：0
> 
> 时间：2013-02-13T23:38:59.157
> 
> 标签：c++, this, instance

我有一个`std::vector`包含一些对象的。我如何使用内存地址（我想`this`为此目的使用指针吗？）来检查我是否正在对同一个对象做某事？

例如：

```
void particle::calcFrc(std::vector<particle>& particles)
{
    vector3d tRel;
    mFrc.reset();
    for(unsigned int j = 0; j < particles.size(); j ++){

        if(... what goes here? ...){

            tRel = particles.at(j).mPos - mPos;

            if(tRel != zero()){
                // do stuff
            }
        }
    }
} 
```

我想检查`if`语句以查看是否`particles.at(j)`引用了调用此方法的同一对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T04:12:52.533

```
if(... what goes here? ...){ 
```

我认为您正在寻找的是：

```
if (this != &particles[j]) { 
```

...并且测试将正常工作，假设该对象实际上是传递给方法的向量中的对象之一（而不仅仅是其中一个的临时副本）。

# c++ - 写入文件和 mkdir 竞争条件 C

> ID：14865338
> 
> 赞同：0
> 
> 时间：2013-02-13T23:39:05.150
> 
> 标签：c++, linux, race-condition, mkdir

我做了一个函数，试图创建一个目录，然后写一个简单的文件：

```
buffer = "Hello world!";
string url = "a/b/c/d/";
string tmp = "";
string done = "";
while((tmp = GetBaseDir(url)).compare("")!=0){
    done+=tmp;
    mkdir(done.c_str(), 0777);
} // GetBaseDir returns "a/", and changes url to "b/c/d/"
ofstream file;
file.open((url+"file.txt").c_str(),ios::trunc);
file << buffer;
file.close(); 
```

如您所见，它只会尝试，如果出现故障，它只会继续进行。

我读到如果另一个进程以写权限打开同一个文件，“打开”将失败。但是，这是真的吗？
如果我同时运行此代码的多个实例，mkdir 和写入操作会发生什么情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-23T17:08:42.190

当目录已经存在时，手册页说明 mkdir 失败。它返回 -1 而不是 0。如果你忽略它，你的代码通常可以正常工作，只要 a/b/c/d 实际上是目录。竞争过程可能会将它们创建为其他东西，从而导致错误。不清楚为什么要使用 0777 模式，因为将 0700 甚至 0770 与特殊组一起使用会好得多。如果您确定它们将始终是目录，那么代码的每个实例都将确保 dir 路径存在，并且唯一的争用将是创建文件。

```
NAME
   mkdir -- make a directory file
SYNOPSIS
   #include <sys/stat.h>
   int mkdir(const char *path, mode_t mode);
RETURN VALUES
   A 0 return value indicates success.  A -1 return value indicates an
   error, and an error code is stored in errno.
ERRORS
     Mkdir() will fail and no directory will be created if:
   ...
   [EEXIST]           The named file exists. 
```

# c++ - 在 GLUT 中使用非成员方法作为回调

> ID：14865339
> 
> 赞同：0
> 
> 时间：2013-02-13T23:39:07.287
> 
> 标签：c++, oop, opengl

我正在尝试将一个函数传递给 GLUT 回调 glutSpecialFunc。

当我尝试将静态函数（specialKeyProcessor）传递给它时，它工作得很好。

当我将此函数移至专门处理键盘相关函数的类（KeyBoardMovement）时，它似乎不起作用：

.... 键盘移动键盘；.... glutSpecialFunc(keyboard.specialKeyProcessor);

错误弹出：必须调用非静态成员函数的引用。

我不理解这个错误，因为我看不出放置在不同位置的相同功能之间有任何区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:49:13.980

该`glutSpecialFunc`函数设置每个窗口的回调。如果您使用的是 OpenGLUT，它还允许您使用`glutSetWindowData`.

因此，您可以像这样创建一个全局 shim 函数：

```
void specialKeyProcessor(int key, int x, int y) {
    KeyboardMovement *keyboard = static_cast<KeyboardMovement *>(glutGetWindowData());
    keyboard->specialKeyProcessor(key, x, y);
} 
```

并使用以下方法关联您的键盘处理程序`glutGetWindowData`：

```
glutSetWindowData(static_cast<void *>(&keyboard)); 
```

如果您需要存储多条窗口数据，您可以存储一个指向特定于窗口的指针，`struct`其中包含每个特定于窗口的数据的字段。

* * *

如果您不使用 OpenGLUT，则可以考虑`std::map`将窗口 ID 映射到全局数据。然后，您可以采用与上述类似的方法来获取特定于窗口的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:40:29.217

C++ 不支持闭包，这意味着它不能将类实例连同方法一起转换为函数指针，调用该函数指针时将执行类实例的方法。

不幸的是，GLUT 不支持数据感知回调，就像大多数其他 C 回调 API 一样。所以它要么编写一个包装函数，它将调用你的类的全局实例，要么使用一个名为“ffcall”的库使用一些非常肮脏的技巧，它实际上可以在运行时创建新函数，可以参数化并充当一个可以传递给 GLUT 的闭包。但这确实是黑暗的东西，正确的做法是抛弃 GLUT。

# sqlalchemy - sqlalchemy：撤消 MetaData.remove(table)

> ID：14865342
> 
> 赞同：3
> 
> 时间：2013-02-13T23:39:26.557
> 
> 标签：sqlalchemy

对于一些相当复杂的单元测试环境，我们希望动态更改元数据中包含的表。`.remove(table)`使用or 甚至支持从中删除表`.clear()`。但是以后如何重新添加这样的表呢？

MetaData中有一个`_add_table(name, schema)`方法，但这似乎不是官方的方法。`Table._set_parent(metadata)`如果必须走“使用内部方法”路线，这似乎更合适。

还有一个是`Table.tometadata(metadata)`创建一个附加新元数据的新表实例。所以我可以创建一个完整的新元数据并附加所有“现在需要”的表。但这意味着所有剩余的代码都需要了解与新元数据相关联的新表实例。我不想走这条路。

更新：我们现在正在考虑 fork/multiprocessing 仅在子进程（隔离环境）中加载表，以便只有该子进程被“污染”并且下一个测试不会受到伤害。为了完整起见，我在这里注意到这一点，它与主要问题没有严格的关系，但可能会帮助其他找到这个问题的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T18:05:10.227

`MetaData`几乎不支持以非附加方式对对象进行突变，总体而言，您不应该在其之上构建用例。`MetaData`在特定场景中使用包含您正在寻找的模式的新对象效果最好。

# php - 搞砸了 HTML/CSS 设计

> ID：14865345
> 
> 赞同：-4
> 
> 时间：2013-02-13T23:40:00.310
> 
> 标签：php, html, css

![在此处输入图像描述](../Images/04166e2b25f3a2433cf51182c8fcb467.png)

我只是在检查其他人的作品并修复这个设计，我似乎不知道如何修复它。我不想从 css 中改变任何东西，所以可以将它安排在 html 上吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Clinical Module</title>
<link href="style.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="inc/style.css" type="text/css">

</head>
<body>
<form action='' method='POST'><center>
<input type="text" placeholder="Patient Number" name="search" > <input type="submit" Value="Check" name='submit'> <br>

<?php

mysql_connect("localhost","root","");
mysql_select_db("invoices");
$search = 0;
$search=$_POST['search'];
if (isset($_POST['submit'])){

    $query = "select * from `patient` where `clientid` = $search ";
    $result=mysql_query($query);

while($row = mysql_fetch_array($result)){ ?>

First name:<br>
</td>
      <td valign="top" align="left">
&nbsp;<input type="text" size="20" name="first_name" value="<?php echo $row["first_name"]?>" ></td>
      <td valign="top" width="10%" rowspan="13">
      </td>
   </tr>
   <tr>

      <td valign="top" align="right">
      Middle name:</td>
       <td valign="top" align="left">
&nbsp;<input type="text" size="20" name="middle_name" value="<?php echo $row["middle_name"]?>" ></td>

      </td>
   </tr>
    <tr>
      <td valign="top" align="right">
Last Name:
</td>
      <td valign="top" align="left">
&nbsp;<input type="text" name="last_name" size="20" value="<?php echo $row["last_name"]?>"></td>
   </tr>
 <tr>
      <td valign="top" align="right">
Birthdate
</td>
      <td valign="top" align="left">
&nbsp;<input type="text" name="Birthdate" size="20" value="<?php echo $row["birthdate"]; ?>"></td>
   </tr>
 <tr>
      <td valign="top" align="right">
Age
</td>
      <td valign="top" align="left">
&nbsp;<input  readonly type="text" name="age" size="20" value="<?php echo $row["age"]?>" placeholder="YYYY-MM-DD"></td>
   </tr>

   <tr> 
    <td valign="top" align="right"> Gender:</td>

      <td valign="top" align="left"><select name="gender">
      <? if ($row["gender"]==Male) { ?>
      <option value="Male" selected>Male</option>
      <option value="Female">Female</option> 
      <? }else if ($row["gender"]==Female) { ?>
      <option value="Male" >Male</option>
      <option value="Female" selected>Female</option>  <?php }?>      
    </select></tr>
        </td><tr> 
    <td valign="top" align="right"> Civil Status:</td>
      <td valign="top" align="left"><select name="civil_status">
      <? if ($row["civil_status"]==Single) { ?>
      <option value="Single" selected >Single</option>
      <option value="Married">Married</option> 
      <option value="Separatede">Separated</option>
      <option value="Widowed">Windowed</option>
      <? }else if ($row["civil_status"]==Married) { ?>
      <option value="Single" >Single</option>
      <option value="Married" selected>Married</option> 
      <option value="Separated">Separated</option>
      <option value="Widowed">Windowed</option>
     <? }else if ($row["civil_status"]==Separated) { ?>
      <option value="Single" >Single</option>
      <option value="Married">Married</option> 
      <option value="Separated" selected>Separated</option>
      <option value="Widowed">Windowed</option>
<? }else if ($row["civil_status"]==Widowed) { ?>
      <option value="Single" >Single</option>
      <option value="Married">Married</option> 
      <option value="Separated">Separated</option>
      <option value="Widowed" selected>Windowed</option>      <?php }?>
     </select> 
         </td>
    </tr>    
 <tr>
      <td valign="top" align="right" nowrap>
Address:</td>
      <td valign="top" align="left">
<input type="text" name="address" value="<?php echo $row["address"]?>" size="31"></td>
      </tr>   

        <tr>
      <td valign="top" align="right">
Tel. no.:</td>
      <td valign="top" align="left">
<input
 type="text" size="20" name="telno" placeholder="###-####" value="<?php echo $row["telno"]?>"></td></tr>
 <tr>
      <td valign="top" align="right">
Occupation:</td>
      <td valign="top" align="left">
<input
 type="text" size="20" name="occ" value="<?php echo $row["occ"]?>"></td></tr>
 <tr>
      <td align="right">
Spouse:</td>
      <td >
<input
 type="text" size="20" name="spo" value="<?php echo $row["spo"]?>"></td></tr><tr>
  <td align="right">
Occupation:</td>
      <td >
<input
 type="text" size="20" name="occ2" value="<?php echo $row["occ2"]?>"></td></tr>

 <tr>
      <td align="right" width="20">
Contact Person(in case of emergency):</td>
      <td >
<input
 type="text" size="20" name="cp" value="<?php echo $row["cp"]?>"></td></tr><tr>
  <td align="right">
Tel. no:</td>
      <td >
<input
 type="text" size="20" name="tel2" value="<?php echo $row["tel2"]?>"></td></tr>

      <tr>
      <td valign="top" align="right" nowrap>
Reffered By:</td>
      <td valign="top" align="left">
<input type="text" name="reff" value="<?php echo $row["reff"]?>" size="31" ></td>
      </tr>

          <tr>
      <td class=topHeadrow1 valign="middle" width="50%" colspan="2">
Past Medical History:</td>
      </tr>
    <tr>
      <td valign="top" align="right" nowrap>
Allergy:</td>
      <td valign="top" align="left">
<input type="text" name="all" value="<?php echo $row["all"]?>" size="31"></td>
      </tr> 
      <tr>
      <td valign="top" align="right" nowrap>
Previous illness:</td>
      <td valign="top" align="left">
<input type="text" name="ill" value="<?php echo $row["ill"]?>" size="31"></td>
      </tr>

    <tr>
     <td class=topHeadrow1 valign="middle" width="50%" colspan="2">
<b><font size="4">
Heredo-Familial Diseases:</font></b></td>
      </tr>
    <tr>
      <td valign="top" align="right" nowrap>
Maternal:
     </td>
      <td valign="top" align="left">
<input type="text" name="mat" value="<?php echo $row["mat"]?>" size="20"></td>
      </tr>
    <tr>
      <td valign="top" align="right" nowrap>
Fraternal:
     </td>
      <td valign="top" align="left">
<input type="text" name="frat" value="<?php echo $row["frat"]?>" size="20"></td>
      </tr>

<?  }
}
?>

</center>
</form>
| 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:51:37.593

我不确定这是否是您所指的，因为您没有指定大量信息...

然而，

*   您似乎没有此表单上的实际`<table>`或`</table>`标签...
*   不，打开`<tr>`标签（正如下面的 Tim Medora 所指出的那样......谢谢！）......
*   `<td valign="top" align="right">`在你之前也没有开始`First name:<br>`

* * *

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Clinical Module</title>
<link href="style.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="inc/style.css" type="text/css">

</head>
<body>
<form action='' method='POST'><center>
<input type="text" placeholder="Patient Number" name="search" > <input type="submit" Value="Check" name='submit'> <br>

<table>
<?php

mysql_connect("localhost","root","");
mysql_select_db("invoices");
$search = 0;
$search=$_POST['search'];
if (isset($_POST['submit'])){

    $query = "select * from `patient` where `clientid` = $search ";
    $result=mysql_query($query);

while($row = mysql_fetch_array($result)){ ?>

<tr>
<td valign="top" align="right">
First name:<br>
</td>
      <td valign="top" align="left">
&nbsp;<input type="text" size="20" name="first_name" value="<?php echo $row["first_name"]?>" ></td>
      <td valign="top" width="10%" rowspan="13">
      </td>
   </tr>
   <tr>

      <td valign="top" align="right">
      Middle name:</td>
       <td valign="top" align="left">
&nbsp;<input type="text" size="20" name="middle_name" value="<?php echo $row["middle_name"]?>" ></td>

      </td>
   </tr>
    <tr>
      <td valign="top" align="right">
Last Name:
</td>
      <td valign="top" align="left">
&nbsp;<input type="text" name="last_name" size="20" value="<?php echo $row["last_name"]?>"></td>
   </tr>
 <tr>
      <td valign="top" align="right">
Birthdate
</td>
      <td valign="top" align="left">
&nbsp;<input type="text" name="Birthdate" size="20" value="<?php echo $row["birthdate"]; ?>"></td>
   </tr>
 <tr>
      <td valign="top" align="right">
Age
</td>
      <td valign="top" align="left">
&nbsp;<input  readonly type="text" name="age" size="20" value="<?php echo $row["age"]?>" placeholder="YYYY-MM-DD"></td>
   </tr>

   <tr> 
    <td valign="top" align="right"> Gender:</td>

      <td valign="top" align="left"><select name="gender">
      <? if ($row["gender"]==Male) { ?>
      <option value="Male" selected>Male</option>
      <option value="Female">Female</option> 
      <? }else if ($row["gender"]==Female) { ?>
      <option value="Male" >Male</option>
      <option value="Female" selected>Female</option>  <?php }?>      
    </select></tr>
        </td><tr> 
    <td valign="top" align="right"> Civil Status:</td>
      <td valign="top" align="left"><select name="civil_status">
      <? if ($row["civil_status"]==Single) { ?>
      <option value="Single" selected >Single</option>
      <option value="Married">Married</option> 
      <option value="Separatede">Separated</option>
      <option value="Widowed">Windowed</option>
      <? }else if ($row["civil_status"]==Married) { ?>
      <option value="Single" >Single</option>
      <option value="Married" selected>Married</option> 
      <option value="Separated">Separated</option>
      <option value="Widowed">Windowed</option>
     <? }else if ($row["civil_status"]==Separated) { ?>
      <option value="Single" >Single</option>
      <option value="Married">Married</option> 
      <option value="Separated" selected>Separated</option>
      <option value="Widowed">Windowed</option>
<? }else if ($row["civil_status"]==Widowed) { ?>
      <option value="Single" >Single</option>
      <option value="Married">Married</option> 
      <option value="Separated">Separated</option>
      <option value="Widowed" selected>Windowed</option>      <?php }?>
     </select> 
         </td>
    </tr>    
 <tr>
      <td valign="top" align="right" nowrap>
Address:</td>
      <td valign="top" align="left">
<input type="text" name="address" value="<?php echo $row["address"]?>" size="31"></td>
      </tr>   

        <tr>
      <td valign="top" align="right">
Tel. no.:</td>
      <td valign="top" align="left">
<input
 type="text" size="20" name="telno" placeholder="###-####" value="<?php echo $row["telno"]?>"></td></tr>
 <tr>
      <td valign="top" align="right">
Occupation:</td>
      <td valign="top" align="left">
<input
 type="text" size="20" name="occ" value="<?php echo $row["occ"]?>"></td></tr>
 <tr>
      <td align="right">
Spouse:</td>
      <td >
<input
 type="text" size="20" name="spo" value="<?php echo $row["spo"]?>"></td></tr><tr>
  <td align="right">
Occupation:</td>
      <td >
<input
 type="text" size="20" name="occ2" value="<?php echo $row["occ2"]?>"></td></tr>

 <tr>
      <td align="right" width="20">
Contact Person(in case of emergency):</td>
      <td >
<input
 type="text" size="20" name="cp" value="<?php echo $row["cp"]?>"></td></tr><tr>
  <td align="right">
Tel. no:</td>
      <td >
<input
 type="text" size="20" name="tel2" value="<?php echo $row["tel2"]?>"></td></tr>

     <tr>
      <td valign="top" align="right" nowrap>
Reffered By:</td>
      <td valign="top" align="left">
<input type="text" name="reff" value="<?php echo $row["reff"]?>" size="31" ></td>
      </tr>

          <tr>
      <td class=topHeadrow1 valign="middle" width="50%" colspan="2">
Past Medical History:</td>
      </tr>
    <tr>
      <td valign="top" align="right" nowrap>
Allergy:</td>
      <td valign="top" align="left">
<input type="text" name="all" value="<?php echo $row["all"]?>" size="31"></td>
      </tr> 
      <tr>
      <td valign="top" align="right" nowrap>
Previous illness:</td>
      <td valign="top" align="left">
<input type="text" name="ill" value="<?php echo $row["ill"]?>" size="31"></td>
      </tr>

    <tr>
     <td class=topHeadrow1 valign="middle" width="50%" colspan="2">
<b><font size="4">
Heredo-Familial Diseases:</font></b></td>
      </tr>
    <tr>
      <td valign="top" align="right" nowrap>
Maternal:
     </td>
      <td valign="top" align="left">
<input type="text" name="mat" value="<?php echo $row["mat"]?>" size="20"></td>
      </tr>
    <tr>
      <td valign="top" align="right" nowrap>
Fraternal:
     </td>
      <td valign="top" align="left">
<input type="text" name="frat" value="<?php echo $row["frat"]?>" size="20"></td>
      </tr>

<?  }
}
?>

</table>
</center>
</form> 
```

# php - 循环中的唯一标识符如何

> ID：14865346
> 
> 赞同：0
> 
> 时间：2013-02-13T23:40:05.040
> 
> 标签：php, loops, foreach, identifier

我正在尝试对循环中的每个项目应用唯一标识符。下面是我的循环中的示例，我正在使用它来展示 fancybox 灯箱。

```
<?php function my_feed() {

          $feed = fetch_feed( 'http://somewhere.com/feed' );
      if ( ! is_wp_error( $feed) ):

      // Get a maximum of 5 items

      $maxitems = $feed->get_item_quantity( 5 );

      $items = $feed->get_items( 0, $maxitems );

      foreach ( $items as $item ):

      ?>

      <div id="listing" class="twelve columns">

          <div class="four columns">

                <img src="#" height="200" width="200" /> <br/>

          </div>

          <div class="eight columns border">

              <!-- need this to be #more-info1\. #more-info2, and so on -->
              <a href="#more-info" class="fancybox"><?php echo $item->get_title(); ?></a>

              <span class="rss-date"><?php echo $item->get_date( 'F j, Y' ); ?></span>

          </div>

      </div>

      <!-- this will coincide with the anchor so the id should be more-info1, more-info2, and so on -->
      <div id="more-info" style="display:none;width:auto;">
          <h3><?php echo $item->get_title(); ?></h3>
          <p>

              <?php echo $item->get_date( 'F j, Y' ); ?>

          </p>
          <p>
           <?php echo $item->get_description(); ?>
           <?php echo '<a href="'. $item->get_permalink().'>Link Here</a>'; ?>
           </p>
      </div>

      <?php

      endforeach;

      else: // Returned WP_Error, unable to fetch the feed. ?>

      <p>There was an error</p>

      <?php endif; ?>

      <?php
      }  ?> 
```

因此，当我希望在“#more-info”之后有一个唯一编号时，锚标签中的 href 像“#more-info1”和“#more-info2”等锚标签。然后它将有一个匹配的 div，其 id 为“more-info1”和“more-info2”等等。我知道它应该运行类似 $myvariable++ 的东西，但老实说，我无法让它工作，也不知道该怎么做。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:44:09.030

尝试这个：

```
$i = 1;
foreach ( $items as $item ):
?>
<a href="#more-info<?php echo $i++; ?>" class="fancybox">
<?php
endforeach; 
```

# android - 通过 NDEF 发送两个 Textfield 的内容

> ID：14865347
> 
> 赞同：0
> 
> 时间：2013-02-13T23:40:12.253
> 
> 标签：android, nfc, ndef

我有一个 Android 应用程序，它有两个文本字段，名称为 Peter Smith，编号为 123456。我想通过 NFC 发送这个。我的问题是我只得到名字而不是号码。如果您不介意请看一下我的代码，也许我犯了一个我看不到的小错误。

```
public class MainActivity extends Activity implements CreateNdefMessageCallback,
        OnNdefPushCompleteCallback {
    NfcAdapter mNfcAdapter;
    TextView beamMsg;
    TextView beamMsg2;
    private static final int MESSAGE_SENT = 1;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        beamMsg = (TextView) findViewById(R.id.msg);
        beamMsg2 = (TextView) findViewById(R.id.msg_ID);
        beamMsg.setText("Peter Smith");
        beamMsg2.setText("123456");

        // Check for available NFC Adapter
        mNfcAdapter = NfcAdapter.getDefaultAdapter(this);
        if (mNfcAdapter == null) {
            beamMsg = (TextView) findViewById(R.id.msg);
            beamMsg2= (TextView) findViewById(R.id.msg_ID);

            beamMsg.setText("NFC is not available on this device.");
            beamMsg2.setText("NFC is not available on this device.");
        } else {
            // Register callback to set NDEF message
            mNfcAdapter.setNdefPushMessageCallback(this, this);
            // Register callback to listen for message-sent success
            mNfcAdapter.setOnNdefPushCompleteCallback(this, this);
        }
    }

    public void submitClicked(View v)
    {
        Toast toast = Toast.makeText(getApplicationContext(), R.string.info,
                Toast.LENGTH_LONG);
        toast.show();
    }
    /**
     * Implementation for the CreateNdefMessageCallback interface
     */
    @Override
    public NdefMessage createNdefMessage(NfcEvent event) {
        NdefMessage msg = new NdefMessage(NdefRecord.createMime(
                beamMsg.getText()  .toString(), null));

        return msg;

    }

    public NdefMessage createNdefMessage_two(NfcEvent event) {
        NdefMessage msg2 = new NdefMessage(NdefRecord.createMime(
                beamMsg2.getText()  .toString(), null));

        return msg2;

    }

    /**
     * Implementation for the OnNdefPushCompleteCallback interface
     */
    @Override
    public void onNdefPushComplete(NfcEvent arg0) {
        // A handler is needed to send messages to the activity when this
        // callback occurs, because it happens from a binder thread
        mHandler.obtainMessage(MESSAGE_SENT).sendToTarget();
    }

    /** This handler receives a message from onNdefPushComplete */
    private final Handler mHandler = new Handler() {
        @Override
        public void handleMessage(Message msg) {
            switch (msg.what) {
            case MESSAGE_SENT:
                Toast.makeText(getApplicationContext(), "Message sent!", Toast.LENGTH_LONG).show();
                break;
            }
        }
    };

    @Override
    public void onResume() {
        super.onResume();
        // Check to see that the Activity started due to an Android Beam
        if (NfcAdapter.ACTION_NDEF_DISCOVERED.equals(getIntent().getAction())) {
            processIntent(getIntent());
        }
    }

    @Override
    public void onNewIntent(Intent intent) {
        // onResume gets called after this to handle the intent
        setIntent(intent);
    }

    /**
     * Parses the NDEF Message from the intent and prints to the TextView
     */
    void processIntent(Intent intent) {
        Parcelable[] rawMsgs = intent.getParcelableArrayExtra(
                NfcAdapter.EXTRA_NDEF_MESSAGES);
        // only one message sent during the beam
        NdefMessage msg = (NdefMessage) rawMsgs[0];
        NdefMessage msg2 = (NdefMessage) rawMsgs[0];
        // record 0 contains the MIME type, record 1 is the AAR, if present
        beamMsg.setText(new String(msg.getRecords()[0].getPayload()));
        beamMsg2.setText(new String(msg.getRecords()[1].getPayload()));
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // If NFC is not available, we won't be needing this menu
        if (mNfcAdapter == null) {
            return super.onCreateOptionsMenu(menu);
        }
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.options, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case R.id.menu_settings:
                Intent intent = new Intent(Settings.ACTION_NFCSHARING_SETTINGS);
                startActivity(intent);
                return true;
            default:
                return super.onOptionsItemSelected(item);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T15:15:41.050

您只需使用 createNdefMessage(...) 方法将一条 ndef 记录添加到 ndef 消息。因此，尽管您的代码读取了两条记录，但仍然只发送了一条。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-30T10:41:17.990

只是用一些东西分开记录，比如';' 并在接收时修剪？
还有一些用于 NDEF 交换的示例代码：

```
public class MainActivity extends AppCompatActivity implements NfcAdapter.CreateNdefMessageCallback {

private NfcAdapter mNfcAdapter;
TextView tv;
private PendingIntent mPendingIntent;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    tv = (TextView) findViewById(R.id.textViewReceivedMessage);

    NfcManager nfcManager = (NfcManager) getSystemService(NFC_SERVICE);
    mNfcAdapter = nfcManager.getDefaultAdapter();

    mPendingIntent = PendingIntent.getActivity(this, 0, new Intent(this, getClass())
            .addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP), 0);
}

private static NdefMessage getTestMessage() {
    byte[] mimeBytes = "application/com.android.cts.verifier.nfc"
            .getBytes(Charset.forName("US-ASCII"));
    byte[] id = new byte[] {1, 3, 3, 7};
    byte[] payload = "CTS Verifier NDEF Push Tag".getBytes(Charset.forName("US-ASCII"));
    return new NdefMessage(new NdefRecord[] {
            new NdefRecord(NdefRecord.TNF_MIME_MEDIA, mimeBytes, id, payload)
    });
}

@Override
protected void onResume() {
    super.onResume();

    mNfcAdapter.enableForegroundDispatch(this, mPendingIntent, null, null);
    mNfcAdapter.setNdefPushMessageCallback(this, this);
}

// sending message
@Override
public NdefMessage createNdefMessage(NfcEvent event) {
    return getTestMessage();
}

private NdefMessage[] getNdefMessages(Intent intent) {
    Parcelable[] rawMessages = intent.getParcelableArrayExtra(NfcAdapter.EXTRA_NDEF_MESSAGES);
    if (rawMessages != null) {
        NdefMessage[] messages = new NdefMessage[rawMessages.length];
        for (int i = 0; i < messages.length; i++) {
            messages[i] = (NdefMessage) rawMessages[i];
        }
        return messages;
    } else {
        return null;
    }
}

static String displayByteArray(byte[] bytes) {
    String res="";
    StringBuilder builder = new StringBuilder().append("[");
    for (int i = 0; i < bytes.length; i++) {
        res+=(char)bytes[i];
    }
    return res;
}

// displaying message
@Override
protected void onNewIntent(Intent intent) {
    super.onNewIntent(intent);

    NdefMessage[] messages = getNdefMessages(intent);
    tv.setText(displayByteArray(messages[0].toByteArray()));
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-27T14:12:04.113

对于那些关心的人（因为问题很旧）而不是双重 createNdefMessage

```
@Override
    public NdefMessage createNdefMessage(NfcEvent event) {
        NdefMessage msg = new NdefMessage(NdefRecord.createMime(
                beamMsg.getText()  .toString(), null));

        return msg;

    }

    public NdefMessage createNdefMessage_two(NfcEvent event) {
        NdefMessage msg2 = new NdefMessage(NdefRecord.createMime(
                beamMsg2.getText()  .toString(), null));

        return msg2;

    } 
```

只需这样做

```
@Override
    public NdefMessage createNdefMessage(NfcEvent event) {
        NdefMessage msg = new NdefMessage(
              NdefRecord.createMime(beamMsg.getText().toString(), null), 
              NdefRecord.createMime(beamMsg2.getText().toString(), null)
        );

        return msg;

    } 
```

我希望这可以帮助别人

# sql - Authorization::Roles 在 Catalyst 应用程序中不起作用

> ID：14865348
> 
> 赞同：1
> 
> 时间：2013-02-13T23:40:16.200
> 
> 标签：sql, perl, authorization, roles, catalyst

我尝试在我的 Catalyst 应用程序中使用 Authorization::Roles。身份验证工作正常，但是当我使用它时，`$c->check_user_roles("admin");`它总是返回 false。怎么了？

一些配置：

```
store => {
    class => 'DBIx::Class',
    user_model => 'Mymodel::User',
    id_field => 'name',
    role_field => 'rolename', # in my table there is the same column
                             # name undoubtedly
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:44:08.397

如果您的角色存储在用户表中，请使用该`role_column`选项。如果您的角色存储在单独的表中，请使用`role_relation`and`role_field`选项。`role_field`本身是无效的。

# php - 尝试遍历 xml 文件以匹配用于登录的 xml 文件的结果

> ID：14865350
> 
> 赞同：0
> 
> 时间：2013-02-13T23:40:17.923
> 
> 标签：php, xml, xml-parsing, xml-serialization, iteration

我有两个 xml 文件，多亏了 Lawrance，我能够将登录用户的 xml 详细信息解析到 admin_panel 现在我正在尝试迭代第二个 xml 文件，该文件仅共享 unique_ref 作为参考，因为我是 PHP 和 xml 的新手我正在努力获得我想要的结果。xml中的登录是

```
<MYData>
    <login_details>
        <unique_ref>1-61</unique_ref>
        <login_name>tomme</login_name>
        <login>me</login>
        <password>me</password>
        <file1>Test</file1>
        <file2/>
        <file3/>
        <file4/>
    </login_details>
    <login_details>
        <unique_ref>1-63</unique_ref>
        <login_name>tony</login_name>
        <login>tony</login>
        <password>tony</password>
        <file1>Test1</file1>
        <file2/>
        <file3/>
        <file4/>
    </login_details>
</MYData> 
```

和用户图像的第二个 xml 文件

```
<MYData>
<mydata_images>
<unique_ref>1-61</unique_ref>
 <image1>IMG_0125.JPG</image1>
 <image2>IMG_0122.JPG</image2>
 <stat_date>2013-02-03</stat_date>
 <path_file>C:\DATA\\documents\page_1.pdf</path_file>
</mydata_images>
<mydata_images>
<unique_ref>1-61</unique_ref>
 <image1>IMG_0127.JPG</image1>
 <image2>IMG_0128.JPG</image2>
 <stat_date>2013-04-03</stat_date>
 <path_file>C:\DATA\\documents\page_3.pdf</path_file>
</mydata_images>
<mydata_images>
<unique_ref>1-63</unique_ref>
 <image1>2.THEMOUNT.JPG</image1>
 <image2>1.THE-MOUNT.JPG</image2>
 <stat_date>2013-01-03</stat_date>
 <path_file>C:\DATA\\documents\page_2.pdf</path_file>
</mydata_images>
<mydata_images>
<unique_ref>1-61</unique_ref>
  <image1>IMG_0109.JPG</image1>
  <image2>IMG_0112.JPG</image2>
 <stat_date>2013-05-03</stat_date>
 <path_file>C:\DATA\\documents\page_4.pdf</path_file>
</mydata_images>
</MYData> 
```

我想显示登录用户的图像和我尝试使用 array_intersect 的 pdf 图像，但我一直收到错误，这是我一直在玩的 admin_panel

```
<?php
session_start();
//logout
$mydata2 = simplexml_load_file("xml/mydata_images.xml");
if(isset($_GET['logout'])){unset($_SESSION['logged_in']);session_destroy();}

//check login
if(isset($_SESSION['logged_in']) && $_SESSION['logged_in']==true){
    //json decode user details from session into an array
    $user_details = json_decode($_SESSION['user_details'],true);
    $id = json_decode($_SESSION['id'],true);
    //debug your values
    $unique_ref =$mydata2->mydata_images;
    echo $unique_ref;
    $result = array_intersect($user_details,$unique_ref );
    $unique_ref =$user_details["unique_ref"];
    //foreach ($mydata2 as $unique_ref => $result){
        //print "$unique_ref = $result\n";
       // print_r($result);
    //}
    echo '<pre>'.print_r($user_details,true).'</pre>';
    echo $id;
    echo $user_details["login"];
    echo $unique_ref;
    echo $result;
    /*
    Array
    (
        [unique_ref] => 1-61
        [login_name] => tomme
        [login] => me
        [file1] => Test
        [file2] => Array
            (
            )

        [file3] => Array
            (
            )

        [file4] => Array
            (
            )

    )
    */

    echo '<a href="?logout">logout</a>';
}else{
    exit(header("Location: ./login.php"));
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:50:05.360

我建议使用 xpath 来选择包含您的图像的正确元素

```
$mydata_images = $mydata2->xpath('/MYData/mydata_images[unique_ref="1-61"]'); 
```

现在将包含与您的 ref 元素匹配的 simplexml 结果

# r - 将 Zip3 和 zip5 级别的 shapefile 转换为 xy 坐标

> ID：14865352
> 
> 赞同：0
> 
> 时间：2013-02-13T23:40:24.607
> 
> 标签：r, gis, microstrategy

我不知道如何开始这个，因为我在 R 中玩的 GIS 一直是使用 ggplot2 和其他使用 latlong 坐标的包来绘制东西。我现在需要做的是在 Microstrategy 中使用可视化组件，该组件使用 HTML 文件形式的 shapefile，其中包含绘图的 xy 坐标（即左上角为 0,0）。状态级文件的一个示例是：

```
<HTML><HEAD><TITLE>untitled</TITLE></HEAD><BODY>
<IMG SRC="" USEMAP="#myMap" WIDTH="812" HEIGHT="713" BORDER="0" />
<MAP NAME="myMap">
<AREA SHAPE="POLY" HREF="#" ALT="Texas" COORDS="299,363,299,360,....." />
</MAP></BODY></HTML> 
```

“坐标”中列出的点是相对于 812 x 713 的“图像”的 X 和 Y 点，该图像是动态绘制和着色的。

我有来自[http://www.vdstech.com/usa-data.aspx](http://www.vdstech.com/usa-data.aspx)的 Zip3 和 Zip5 的 shp、shx、dbf 文件，但我不确定从哪里开始转换！我不介意手动格式化 HTML 文件的繁重工作，这是我坚持的 XY 转换（生锈，很长一段时间没有碰过 GIS）：

以下代码将 shapefile 导入 R

```
library(rgdal)
zip3 <- readOGR(dsn = '/Users/adempsey/Downloads/zip3'), layer = 'zip3') 
```

之后我被卡住了，目前正在寻找如何将 zip3 + xy 坐标提取到数据框中的教程，然后我可以用它来创建我的最终文件

更新 2

使用以下内容，我可以转换为数据框，但我无法提取关联的 zip3 代码，该代码似乎存储在关联的 dbf 文件中

```
Row long      lat order  hole piece group id
1 -151.0604 70.41873     1 FALSE     1   0.1  0
2 -150.7620 70.49722     2 FALSE     1   0.1  0 
```

是的，这超出了我目前生锈的 R

update3 此代码将邮政编码转储到数据框 zip3.codes <- as.data.frame(zip3) 应该可以与 zip3.df <- fortify(zip3@polygons[[1000]]) 之类的东西组合，其中 1000将替换为与特定 zip3 关联的所有行 zip3.codes

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T04:07:19.640

您可以使用[fastshp](http://rforge.net/fastshp)包来加载数据：

```
 install.packages("fastshp",,"http://rforge.net")
 library(fastshp)
 s <- read.shp("zip5.shp", format="polygon") 
```

`s`现在是所有 ZIP 形状的列表。您对`x`和`y`组件感兴趣-例如，要绘制第一个 ZIP，只需使用类似

```
 plot(s[[1]]$x, s[[1]]$y, asp=1.25)
 polygon(s[[1]]$x, s[[1]]$y, col="#eeeeee") 
```

要匹配名称，请使用`read.dbf`from `foreign`：

```
 library(foreign)
 d <- read.dbf("zip5.dbf", as.is=TRUE)
 names(s) <- d$ZIP5 
```

有关`?read.shp`可用格式的更多详细信息，请参阅。“多边形”`NA`用于分隔单个多边形，“列表”使用索引为您提供零件。

顺便说一句，数据集有些可疑，您可能想查看 TIGER/Line 人口普查 ZCTA5 数据（最近的是 2010 年）。

# iphone - 即使正确调用该方法，也没有在 NSNotification 处理程序方法中执行任何代码

> ID：14865359
> 
> 赞同：0
> 
> 时间：2013-02-13T23:41:16.713
> 
> 标签：iphone, ios, xcode, nsnotificationcenter

我有奇怪的问题。在`ViewController.m`，我在成功保存后发布通知并执行 Segue 到`ListViewController`. 在`ListViewController.m`中，我设置了观察者`viewDidLoad`并声明了处理方法。

问题是调用了处理程序方法但没有执行内部代码！知道为什么吗？

```
// ViewController.m
if (success) {
    [[NSNotificationCenter defaultCenter] postNotificationName:kAHPlistSavedSuccessfully object:self];
    [self performSegueWithIdentifier:kAHDetailToListSegue sender:self];
}

// ListViewController.m
- (void)viewDidLoad
{
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(plistSavedSuccessfully:) name:kAHPlistSavedSuccessfully object:nil];
}

- (void)plistSavedSuccessfully:(NSNotification *)notification
{
    NSLog(@"notification %@", notification);
    [self someMethod]; // not called !
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:50:08.047

我可以发现一些可能有问题的地方。

首先，您在执行 segue 到列表视图控制器之前发布通知，因此有可能在列表视图控制器将自身添加为通知的观察者之前发布通知。（不太可能是因为正在打印日志语句，但在某些情况下仍然可能）。

第二件事是在与发布它们的队列相同的队列中接收通知。是否有可能在与主队列不同的队列上调用您的发布通知代码？`someMethod`如果对非线程安全的代码进行任何工作，这可能会导致问题。您应该验证在哪个队列上调用您的发布通知代码，并确保在主队列上调用它，或者在您的处理程序中，`someMethod`使用`dispatch_async`.

# elasticsearch - 在 ElasticSearch 中是否有可能拥有与子级相同类型的 _parent 映射？

> ID：14865360
> 
> 赞同：1
> 
> 时间：2013-02-13T23:41:38.250
> 
> 标签：elasticsearch

基本上，有可能做到这一点吗？

```
curl -XPOST http://esdev1-sn1:9200/test/tracking/_mapping -d '
{
  "tracking": {
    "_parent": {
      "type": "tracking"
    }
  }
}
' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T03:04:14.073

从理论上讲，没有什么能阻止你这样做。实际上，弄清楚路由可能是一个问题。Elasticsearch 要求所有子项都在与父项相同的分片中进行索引。因此，在您的情况下，如果您的索引包含多个分片，那么对于任何给定文档，其所有祖先和后代都必须使用相同的`_routing`值进行索引。

# haskell - 模式 Haskell 中的解析错误

> ID：14865362
> 
> 赞同：0
> 
> 时间：2013-02-13T23:41:53.930
> 
> 标签：haskell, pattern-matching, operator-precedence, parse-error

为什么我在此代码中收到解析错误？

```
data One = H| I deriving (Read,Show,Eq)
data E = A | B deriving (Read,Show,Eq)
type L = [E]

fun1 :: One -> E -> One
-- function for fun1 is here

fun2 :: One -> L -> One
fun2 a [] = a
fun2 a x:xs = fun2 (fun1 a x) xs    --<<< I am getting error here 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:44:32.990

尝试：

```
fun2 a (x:xs) = fun2 (fun1 a x) xs 
```

# android - android.os.TransactionTooLargeException - 活页夹缓冲区

> ID：14865365
> 
> 赞同：3
> 
> 时间：2013-02-13T23:42:03.447
> 
> 标签：android, performance

我正在使用 Parcelable 类在活动之间传递数据。正如[文档](http://developer.android.com/reference/android/os/TransactionTooLargeException.html)所建议的那样，我将所有事务保持在相对较小（100kb）的范围内，因为 Binder 事务缓冲区的容量为 1Mb。问题是，如果我多次重复一个小事务，缓冲区达到那个大小并且操作系统抛出**android.os.TransactionTooLargeException**。

我的感觉是在事务之间没有立即释放缓冲区。有没有办法检查活页夹缓冲区的大小？

# javascript - 如何通过 Javascript 获取 Magento baseUrl，然后在 jquery.hello-lightbox.min 中使用它？

> ID：14865367
> 
> 赞同：8
> 
> 时间：2013-02-13T23:42:05.493
> 
> 标签：javascript, magento, base-url

我正在尝试通过 head.phtml 文件中的 javascript 获取 Magento BaseUrl，然后在 jquery.hello-lightbox.min 文件中使用它，我需要 baseUrl 来获取一些图像。

这是我在 head.phtml 文件中的内容：

```
<?php $baseUrl = $this->getBaseUrl() ; ?>

<script type="text/javascript">

var baseUrl = <?php echo $baseUrl ; ?>

function getBaseUrl(baseUrl)

</script> 
```

然后在 /js/jquery.hello-lightbox.min 我有：

```
(function($){

function getBaseUrl(baseurl)
{
var domain = baseurl
}

var urrl = 'http://'+domain+'/skin/frontend/default/customtheme/images/lightbox/';

  $.fn.lightBox=function(settings)settings=jQuery.extend({overlayBgColor:'#000',overlayOpacity:0.8,fixedNavigation:false,imageLoading: urrl+'lightbox-ico-loading.gif',imageBtnPrev:urrl+'lightbox-btn-prev.gif', . . . . . . . . . . 
```

但这不起作用。实际上，似乎我什至无法将 php 变量 $baseUrl 传递给 head.phtml 中的 var baseUrl

你有什么想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T10:51:15.010

您的主代码中有语法错误。我认为您想要的是定义一个返回基本 URL 的函数，如下所示：

```
<?php $baseUrl = $this->getBaseUrl() ; ?>

<script type="text/javascript">

function getBaseUrl() { return '<?php echo $baseUrl; ?>'; } 

</script> 
```

然后在 JavaScript 中使用它：（摆脱`function getBaseUrl(baseurl) ...`那里的东西）

```
var urrl = 'http://'+getBaseUrl()+'/skin/frontend/default/customtheme/images/lightbox/'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-24T13:14:41.943

您可以通过这些简单的步骤在整个商店中的每个 javascript / php 文件中调用基本 url。

打开你的主题 **页面/html/head.phtml**并在最后一行的**HEAD**标记中添加以下代码：

```
<script type="text/javascript">
   var BASE_URL = '<?php echo  Mage::getBaseUrl(); ?>';
</script> 
```

现在，您可以在主题文件中的每个 javascript 代码中使用 BASE_URL 变量来获取 javascript 中的 magento 基本 url。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T23:45:43.543

尝试在您通过 php echo 设置的 JS var 周围加上引号：

`var baseUrl = '<?php echo $baseUrl ; ?>'`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-08T09:39:36.063

如果您不想使用内联 Javascript，您始终可以将其作为属性添加到 div 或类似的东西。

例如，我会经常添加这样的 html 元素：

```
<div class="my-class" data-storeurl="<?php echo  Mage::getBaseUrl(); ?>">
....
</div> 
```

然后在我的 Javascript（在本例中为 jQuery）中，我将添加如下内容：

```
var current_store = $('.store-redirect').attr('data-storeurl'); 
```

对于要在正确商店的 url 上运行调用的 AJAX 调用，这很方便。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T23:58:19.467

编辑：

Javascript 不会像这样在文件之间传递变量。在这种情况下，您不需要使用 PHP，只需执行以下操作：

```
var urrl = 'http://'+window.location.host+'/skin/frontend/default/customtheme/images/lightbox/'; 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2013-06-19T13:31:39.967

Magento : 获取 Base Url 、 Skin Url 、 Media Url 、 Js Url 、 Store Url 和 Current Url：

1.  获取基本网址`:Mage::getBaseUrl();`
2.  获取皮肤网址`:Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_SKIN);`
    1.  不安全的皮肤网址`:$this->getSkinUrl('images/imagename.jpg');`
    2.  安全皮肤网址`:$this->getSkinUrl('images/imagename.gif', array('_secure'=>true));`
3.  获取媒体网址`:Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_MEDIA);`
4.  获取 Js 网址`:Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_JS);`
5.  获取商店网址`:Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_WEB);`
6.  获取当前网址`:Mage::helper('core/url')->getCurrentUrl();`

在 cms 页面或静态块中获取 Url：

1.  获取基本网址`:{{store url=""}}`
2.  获取皮肤网址`:{{skin url='images/imagename.jpg'}}`
3.  获取媒体网址`:{{media url='/imagename.jpg'}}
4.  获取商店网址`:{{store url='mypage.html'}}`

# c# - 使用 Visual Studio 2012 部署时删除 ConnectionString

> ID：14865379
> 
> 赞同：4
> 
> 时间：2013-02-13T23:43:12.353
> 
> 标签：c#, iis, visual-studio-2012, web-config, publishing

我正在开发一个包含 2 个 Web 应用程序的项目，一个作为长时间运行的进程（使用 appfabric）托管，另一个只是一个普通的 MVC 应用程序。它们共享相同的数据上下文，因此共享相同的连接字符串。appfabric 应用程序部署为主应用程序的子应用程序，利用 web.config 继承（我们不希望连接字符串在 web 配置中重复）

我的问题是，使用新的 Visual Studio 2012 发布向导，connectionString 会自动添加，即使我取消选中“在运行时使用此连接字符串”框也是如此。

我也尝试像这样使用网络配置转换：

```
 <connectionStrings>
      <add xdt:Transform="RemoveAll" />
  </connectionStrings> 
```

但发布后连接字符串仍在我的网络配置中。

有什么建议么 ？我正在考虑完全删除该子应用程序的 Web 配置，但这并不理想。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T03:34:06.473

答案可以在这里找到： [Web Deploy / Publish is added a unknown connection string？](https://stackoverflow.com/questions/12966449/web-deploy-publish-is-adding-a-unknown-connection-string)

通过编辑 XML 将此项目属性添加到 .csproj 文件：

```
<Project>
    <PropertyGroup>

         <AutoParameterizationWebConfigConnectionStrings>false</AutoParameterizationWebConfigConnectionStrings>

   ...
    </PropertyGroup>
...
</Project> 
```

# mysql - 选择列中字符串的一部分

> ID：14865382
> 
> 赞同：0
> 
> 时间：2013-02-13T23:43:29.983
> 
> 标签：mysql

我有一个查询，我通过向查询提供信息来过滤结果。我有基本的 SELECT ，然后我有：

`AND db_schedules.daysofweek = '0'";`

`daysofweek`但是，这会在列中自行搜索 0 的存在。我怎样才能告诉它在字符串中而不是自己寻找它？就像如果列是 1340 之类的东西，那么查询将在搜索结果中返回该记录，因为查询在字符串中找到了 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:44:32.933

只需使用`LIKE`：

```
AND db_schedules.daysofweek LIKE '%0%'"; 
```

# sql - 额外的连接会降低性能

> ID：14865383
> 
> 赞同：1
> 
> 时间：2013-02-13T23:43:36.927
> 
> 标签：sql, sql-server, join

我有下面的 sql 语句，最多在 5 分钟内运行。当我向它添加任何连接时，sql 语句会一直运行直到超时。我想知道您是否可以让我知道为什么添加到 sql 语句会导致这种情况？这些是我添加到基本 SQL 的连接：

***将此语句添加到 Base SQL***

```
inner join ahsrelate.dbo.ahs_encounter ahs_encounter_1
on AHS_Encounter_1.PatientID=AHS_Patient.ID 
```

***或将此语句添加到基本 SQL***

```
inner join AHS_Medication
on ahs_medication.patientid=AHS_Patient.ID 
```

***基础 SQL***

```
SELECT distinct
    AHS_Patient.FullName, 
    AHS_Patient_Iorg.OrganizationMrn, 
    AHS_Patient.SexName, 
    AHS_Patient.DateOfBirth, 
    Finding1.NumericResult, 
    Finding2.NumericResult, 
    AHS_Problem.ICD9DiagnosisCode, 
    AHS_Encounter.EncounterDTTM, 
    AHS_Encounter.EncounterTypeName, 
    AHS_Result.EntryCode, 
    AHS_Result_1.EntryCode, 
    AHS_Result.NumericResult, 
    AHS_Result_1.NumericResult, 
    AHS_Result.ClinicalDTTM, 
    AHS_Result_1.ClinicalDTTM, 
    AHS_Provider.FullName, 
    AHS_Problem.Problem, 
    AHS_Problem.ProblemStatusName, 
    AHS_Encounter.ApptLocationName, 
    AHS_Encounter.AppointmentStatusName
FROM AHSRelate.dbo.AHS_Patient AHS_Patient 
      INNER JOIN AHSRelate.dbo.Finding1 Finding1 
        ON AHS_Patient.ID=Finding1.PatientID
          AND Finding1.EntryMnemonic='BP SYS'    
      INNER JOIN AHSRelate.dbo.Finding2 Finding2 
        ON AHS_Patient.ID=Finding2.PatientID 
        AND Finding2.EntryMnemonic='BP DIAS' 
      INNER JOIN AHSRelate.dbo.AHS_Result AHS_Result 
        ON AHS_Patient.ID=AHS_Result.PatientID
         AND AHS_Result.EntryCode IN ('D5353078', 'Q25015900') 
      INNER JOIN AHSRelate.dbo.AHS_Result AHS_Result_1 
        ON AHS_Patient.ID=AHS_Result_1.PatientID
          AND AHS_Result_1.EntryCode IN ('D5353037', 'Q25003000')
      INNER JOIN AHSRelate.dbo.AHS_Encounter AHS_Encounter 
        ON AHS_Encounter.PatientID=AHS_Patient.ID
        AND AHS_Encounter.AppointmentStatusName='Pending' 
          AND AHS_Encounter.EncounterTypeName='Appointment'
          and AHS_Encounter.EncounterDTTM >= getdate()-1
          and AHS_Encounter.EncounterDTTM <= getdate()+1            
      INNER JOIN AHSRelate.dbo.AHS_Problem AHS_Problem 
        ON AHS_Patient.ID=AHS_Problem.PatientID
      INNER JOIN AHSRelate.dbo.AHS_Patient_Iorg AHS_Patient_Iorg 
        ON AHS_Patient.ID=AHS_Patient_Iorg.PersonID
      inner JOIN AHSRelate.dbo.AHS_Provider AHS_Provider 
        ON AHS_Encounter.Provider2ID=AHS_Provider.ID
    ORDER BY 
    AHS_Patient.FullName, 
    AHS_Result.ClinicalDTTM DESC, 
    AHS_Result_1.ClinicalDTTM DESC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:11:46.157

我在不知道您的数据结构细节的情况下进行猜测，但根据我自己之前在医疗保健数据库方面的工作做出有根据的猜测。我看看这个，然后看看你的查询：

```
inner join AHS_Medication
on ahs_medication.patientid=AHS_Patient.ID 
```

首先想到的是您有一个患者，他可能有多个问题、多次遭遇和多种药物，结果是您将不相关的事物连接在一起，因此产生的记录远多于说得通。5 分钟的查询时间已经很长了，我敢打赌，相对而言，药物表相当庞大，因此您将显着增加运行时间。

考虑您的患者：

```
Patient1
Patient2
Patient3 
```

加入遭遇（假设每个患者有两次遭遇）：

```
Patient1  Encounter1
Patient1  Encounter2
Patient2  Encounter3
Patient2  Encounter4
Patient3  Encounter5
Patient3  Encounter6 
```

这很好，但随后您加入药物，该药物要么不在同一层次结构中，要么您遗漏了将药物与开处方的遭遇相关的加入标准（medication.PatientId && drug.EncounterWhichPrescibed）。如果 Patient1 有三种药物，则每次遇到都会重复，因为 Encounter 和 Medication 之间没有关系（或者至少您没有在加入标准中使用它）。

```
Patient1  Encounter1  MedicationA
Patient1  Encounter1  MedicationB
Patient1  Encounter1  MedicationC
Patient1  Encounter2  MedicationA
Patient1  Encounter2  MedicationB
Patient1  Encounter2  MedicationC
Patient2  Encounter3  MedicationD
Patient2  Encounter3  MedicationE
Patient2  Encounter3  MedicationF
Patient2  Encounter4  MedicationD
Patient2  Encounter4  MedicationE
Patient2  Encounter4  MedicationF
Patient3  Encounter5  MedicationG
Patient3  Encounter5  MedicationH
Patient3  Encounter5  MedicationI
Patient3  Encounter6  MedicationG
Patient3  Encounter6  MedicationH
Patient3  Encounter6  MedicationI 
```

这种问题也可能发生在其他连接上，因此每个无意义的连接都在几何上增加了运行时间（即，使用单个连接可以轻松地将 5 分钟延长到 50 分钟）。

# facebook - 如何绕过 Facebook 之类按钮的 opengraph 标签并改用 data-href

> ID：14865388
> 
> 赞同：0
> 
> 时间：2013-02-13T23:43:57.897
> 
> 标签：facebook, facebook-like

我在标签`fb-root`之后安装了带有 div的 javascript 代码`<body>`。

我的网站标题中有一个赞按钮，可以点赞该网站。

但是对于每篇文章，网站上都有更多按钮。有时同一页面上有多个。

因此，按照 facebook 的文档说明，我在标签中添加了一个`data-href=""`属性。`fb-like`没用。然后我添加了一个`ref=""`属性，其中包含文章的 slug。以为会有帮助。

具有 data-href 和 ref 属性的按钮显示的点赞数与网站标题的点赞数相同。当我点击它们时，它们都喜欢相同的 url，而不是我在`data-href`. 任何按钮总是使用`opengraph`标签中的数据并完全忽略我在标签中指定的内容。（应该是相反的）

所以问题是：有没有办法绕过`OG`标签并强制 URL`data-href`用于按钮？（它应该这样工作，但我完全忽略了为什么它不这样做）。

这是我使用的代码：

紧接着：

```
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=MY_API_KEY>";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

然后在标题中：

```
<div class="fb-like" data-send="false" data-layout="button_count" data-width="100" data-show-faces="false" data-font="arial" data-colorscheme="light"></div> 
```

然后在一篇文章中：

```
<div class="fb-like" data-href="URL_OF_THE_ARTICLE" data-send="false" data-layout="button_count" data-width="175" data-show-faces="false" data-font="arial" data-colorscheme="light"></div> 
```

顺便说一下，我尝试同时使用 fb: 和 div 标签。这应该非常简单，就像 Twitter 和 Google+ 一样。

有人知道这有什么问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:55:02.130

喜欢按钮的 data-href 参数应该指向你想要喜欢/分享的内容的 URL -

该 URL 应包含元标签，告诉 Facebook 显示什么标题等，并将这些标签返回给 Facebook 的爬虫

[您可以使用Facebook 的调试工具](https://developers.facebook.com/tools/debug)查看 facebook 在该 url 检测到 的内容- 仔细检查您没有通过更改`og:url`标签、使用规范元标签等来重定向爬虫

# c - 用于 CPU 使用的 Linux C API

> ID：14865393
> 
> 赞同：1
> 
> 时间：2013-02-13T23:44:30.800
> 
> 标签：c, linux, api, cpu

我知道在 Linux 系统上有 getrusage() API 用于查找当前进程的 CPU 使用率。是否有类似的 API 用于以百分比形式获取系统 CPU 使用率？还是我应该简单地选择[https://unix.stackexchange.com/a/21564](https://unix.stackexchange.com/a/21564)中讨论的解决方案，在该解决方案中手动读取 /proc/stat？htop 和 top 之类的软件用什么来查找用户、系统、空闲等？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T00:24:07.860

top 询问 /proc/stat，据我所知，没有 API 可以满足您的要求。

# html - WordPress 中板球的 Html/CSS 结果页面/记分卡

> ID：14865396
> 
> 赞同：0
> 
> 时间：2013-02-13T23:44:38.407
> 
> 标签：html, css, wordpress, html-table

我是网页设计新手，正在创建一个基于 WordPress 平台的体育网站。

该网站将涵盖的一项运动是板球。我的网站快完成了，但我被一些非常重要的 CSS/Html 数据表困住了。如果这里有人可以指导/帮助我如何创建类似于下面链接中的表格，或者是否有人可以从现有站点复制 html/css 并对其进行样式设置，我将不胜感激。

[我只需要表格的副本，不需要排序选项](http://www.dpltwenty20.com/results#.URgKm6WzKSo)

[尽可能轻的类似记分卡会很棒](http://www.pcb.com.pk/match/24717.html)

在 Wordpress 中使用 CSS/html 是否可以实现这些事情，或者这些表格是否有更好的选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:06:07.980

以下是您可以使用的两种解决方案：

**解决方案 #1：** [TabPress 插件](http://tablepress.org/demo/)

通过图形面板，您可以完全自定义您的表格。你可以设置你自己的 CSS，你可以有 colspan、rowspan 或所有在一起。查看[演示](http://tablepress.org/demo/)。如果您不想在编码上花费太多时间，请尝试一下。

**解决方案#2：** [WP_List_Table](http://codex.wordpress.org/Class_Reference/WP_List_Table)

它从 WordPress 3.1 开始可用。WP 3.1 使用它来构建您可以在管理面板中看到的表格。例如，显示帖子的表使用此类。但是，您可以禁用某些功能，例如排序、批量操作等。

这是取自我的一个博客的示例代码。我想显示一个没有排序选项的统计表。调用`ff_show_stats()`以显示您的 PHP 代码中的表格。

```
if( ! class_exists( 'WP_List_Table' ) ) {
    require_once( ABSPATH . 'wp-admin/includes/class-wp-list-table.php' );
}

class FFStatsTable extends WP_List_Table {
    function __construct(){

    }

    function get_columns(){
        $columns = array(
            'id' => 'ID',
            'creation' => 'Creation',
            'country' => 'Country'
            // Add as much column as you want
            // 'column_name_in_query' => 'Displayed column name' 
        );
        return $columns;
    }

    function column_default( $item, $column_name ) {
        switch( $column_name ) { 
        case 'id':
        case 'creation':
        case 'country':
            return $item[ $column_name ];
        default:
            return print_r( $item, true ) ; //Show the whole array for debugging purposes
        }
    }

    function prepare_items() {
        global $wpdb;

        $columns = $this->get_columns();
        $hidden = array();
        $sortable = array();//Empty array for disabling sorting
        $this->_column_headers = array($columns, $hidden, $sortable);

        $this->items = $wpdb->get_results(
            "SELECT id,creation,country FROM wp_my_table WHERE my_condtion=TRUE",
            ARRAY_A 
        );
    }    
}

function ff_show_stats() {
    $myListTable = new FFStatsTable();

    echo '<div class="wrap"><h2>Stats</h2>'; 
    $myListTable->prepare_items(); 
    $myListTable->display(); 
    echo '</div>'; 
} 
```

您可以在这里获得更详细的示例代码：http: [//plugins.svn.wordpress.org/custom-list-table-example/tags/1.2/list-table-example.php](http://plugins.svn.wordpress.org/custom-list-table-example/tags/1.2/list-table-example.php)

# apache - 将子域重定向到域：意外结果

> ID：14865397
> 
> 赞同：2
> 
> 时间：2013-02-13T23:44:38.580
> 
> 标签：apache, .htaccess, redirect

我使用这个 .htaccess 将我的论坛从子域重定向到 /forum/ 文件夹

```
#REDIRECT FORUM
RewriteCond %{HTTP_HOST} ^forum\.example\.com$
RewriteRule ^ http://www.example.com/forum/%{REQUEST_URI} [R=301,L] 
```

一切都很好，但我的请求得到了意想不到的结果：

```
http://forum.example.com/forum/10  =>  http://www.example.com/forum/10 
```

不得不

```
http://forum.example.com/forum/10  =>  http://www.example.com/forum/forum/10 
```

哪里有错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:54:34.503

尝试这个：

```
#REDIRECT FORUM
RewriteCond %{HTTP_HOST} ^forum\.example\.com$
RewriteRule ^/(.*) http://www.example.com/forum/forum/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T10:49:13.487

您的 .htaccess 几乎没有错误。我将您的 .htaccess 的更正版本放在这里：

```
# OPTIONS
DirectoryIndex index.php index.htm index.html
AddDefaultCharset utf-8

RewriteEngine On
RewriteBase /

# REDIRECT FORUM
RewriteCond %{HTTP_HOST} ^forum\.sathyasai\.ru$ [NC]
RewriteRule ^ http://www.sathyasai.ru/forum%{REQUEST_URI} [R=301,L]

# RUN OLD_SITE
RewriteCond %{REQUEST_URI} !^/v2
RewriteCond %{DOCUMENT_ROOT}/v2%{REQUEST_URI} -f
RewriteRule (.*) /v2/$1 [L]

# RUN NEW_SITE
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule . /index.php [L] 
```

# python - 在 Python 中的文件中的列中写入行

> ID：14865404
> 
> 赞同：0
> 
> 时间：2013-02-13T23:45:05.857
> 
> 标签：python, file, row

我有句子，以字符串的形式，看起来像这样：

第一句话

```
 hund                    
barked      4.51141770734e-07
bit         0.0673737226603
dog         0.932625826198 
```

第二句

```
 hyi                     
biid        6.12323423324e-07
bok         0.0643253
dyfs        0.514586321 
```

我想将它们写入列到这样的文件中：

```
 hund                                    hyi     
barked      4.51141770734e-07           biid        6.12323423324e-07
bit         0.0673737226603             bok         0.0643253
dog         0.932625826198              dyfs        0.514586321 
```

而不是让他们像这样：

```
 hund                    
barked      4.51141770734e-07
bit         0.0673737226603
dog         0.932625826198

            hyi                     
biid        6.12323423324e-07
bok         0.0643253
dyfs        0.514586321 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:56:26.730

假设您有两个行列表，`lines1`并且`lines2`. 如果您有一个包含多个换行符的字符串，您可以通过调用`.split('\n')`.

然后，您可以使用字符串格式将它们格式化为并行列：

```
lines = ['{:<40}{:<40}'.format(s1, s2) for s1, s2 in zip(lines1, lines2)] 
```

例子：

```
a = '''            hund                    
barked      4.51141770734e-07
bit         0.0673737226603
dog         0.932625826198'''.split('\n')
b = '''            hyi                     
biid        6.12323423324e-07
bok         0.0643253
dyfs        0.514586321'''.split('\n')
lines = ['{0:<40}{1:<40}'.format(s1, s2) for s1, s2 in zip(a,b)]
print '\n'.join(lines) 
```

输出：

```
 hund                                    hyi                         
barked      4.51141770734e-07           biid        6.12323423324e-07           
bit         0.0673737226603             bok         0.0643253                   
dog         0.932625826198              dyfs        0.514586321 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:51:55.200

如果它是您所追求的字符串格式，您可能希望看起来像[str.ljust](http://docs.python.org/2/library/string.html#string.ljust)以使字符串具有一定的长度。

# javascript - 按特定顺序检查数组中的多个值

> ID：14865406
> 
> 赞同：0
> 
> 时间：2013-02-13T23:45:17.570
> 
> 标签：javascript, arrays

我有这个数组（如下），我正在尝试检查它是否具有特定值。

```
var a = [ true, "lipsum" ]; 
```

我需要做的是检查是否`a[0]`为真以及是否`a[1]`为“lipsum”

我可以分别检查这两个值：

```
a[0] === true && a[1] === 'lipsum' // true 
```

...为了缩短代码，我尝试这样做：

```
a === [ true, 'lipsum'] // false 
```

**为什么上面的代码示例是错误的，还有另一种方法可以实现我想要做的事情吗？**

* * *

我可以这样做：

```
a.join() === 'true,lipsum' // true 
```

虽然我不禁觉得有更好的方法..？

* * *

*   [jsfiddle](http://jsfiddle.net/lollero/q5DvG/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:00:40.893

只检查两个元素的直接方法似乎最好，但我假设您出于维护原因想要这样做，因为最终您可能有几个条件要检查（不仅仅是两个）。如果是这样，您可以执行以下操作，这对于仅两个条件而言似乎很冗长，但随着您开始添加更多条件，它会更合理，因此这里有一个示例，需要检查 5 个条件：

```
// set a constant somewhere for your truth condition
var COND = [1, 'a', 5, 'b', 0];

// check `a` against the constant array using `every` (Thanks Bergi)
if (a.every(function(v, i){ return COND[i] === v; })) {
    // all array elements the same
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:53:20.880

每个数组都是一个单独的对象，因此不能使用相等运算符来比较它们。假设您要对已知参数进行严格比较，那么您使用的第一种方法是最好的。

如果您有另一个原始数组必须包含的参数数组，则必须使用循环，尽管您可以抽象它：

```
Array.prototype.contains = function (array) {
    for (var x = 0; x < array.length; x++) {
        if (this.length < x || this[x] !== array[x]) {
            return false;
        }
    }
    return true;
} 
```

[http://jsfiddle.net/q5DvG/1/](http://jsfiddle.net/q5DvG/1/)

# background-color - 带圆角和重叠背景颜色的 CSS 选择

> ID：14865408
> 
> 赞同：1
> 
> 时间：2013-02-13T23:45:21.017
> 
> 标签：background-color, css

我在具有背景颜色的选择元素上应用边框半径。背景颜色不是跟随边界的曲线，而是与曲线重叠并出现在一个方框中。我不知道我必须使用什么 css 属性来解决这个问题。

```
background-color: #FF0;
border-radius: 24px;
border: 4px solid #F09; 
```

这是jsfiddle：http: [//jsfiddle.net/JsgnR/](http://jsfiddle.net/JsgnR/)

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:37:54.800

您可以包装`<select>`元素`<span></span>`并将所需的属性添加到 css for

这个解决方案：http: [//jsfiddle.net/JsgnR/5/](http://jsfiddle.net/JsgnR/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:56:31.207

我对此的感觉是，要让它在每个常见的浏览器中工作，你将不得不用 JS 重建选择......不幸的是，像 divbox 这样的 css 样式选择仍然不像你所期望的那样是可能的。在最新的 Firefox 中，您的代码在浏览器中看起来不错，因为 Firefox 决定让边框与选择重叠，在最新的歌剧中，边框将在选择下方，因为他们决定这样做。

您在选项上看到，尝试通过 css 设置样式，您无法做到，而且它们看起来很丑

# javascript - 使用 CKEditor 4 在 CTRL/CMD + S 上调用自定义函数

> ID：14865410
> 
> 赞同：1
> 
> 时间：2013-02-13T23:45:31.453
> 
> 标签：javascript, jquery, ckeditor

我有一个自定义的 ajax 函数 save()，当我按下 CTRL/CMD + S 时我会在表单上调用它：

```
document.addEventListener("keydown", function(e) {
  if (e.keyCode == 83 && (navigator.platform.match("Mac") ? e.metaKey : e.ctrlKey)) {
    e.preventDefault();   
    save();
  }
}, false); 
```

我将 CKEditor 4 用于我的 textarea 字段：

```
CKEDITOR.replace('content',{ height: '250px' }); 
```

如果焦点不在 CKEditor textarea 上，按 CTRL/CMD + S 调用从“keydown”侦听器触发的 save() 函数。

但是，如果焦点位于 CKEditor 文本区域，按 CTRL/CMD + S 会调用我的浏览器“将页面另存为”对话框（注意：我在 Chrome FWIW 上）。

即使焦点位于 CKEditor 文本区域上，如何确保执行 save() 函数？

非常感激任何的帮助。

谢谢，

巴迪

# bash - 此 bash 脚本中的错误

> ID：14865414
> 
> 赞同：2
> 
> 时间：2013-02-13T23:45:46.057
> 
> 标签：bash

我想制作一个构建链脚本，如果编译过程中出现错误，我不希望它执行到最后。

这是我第一次在 bash 中编写更“详细”的脚本，但它不起作用：

1.  它没有回显错误，尽管我在其中有带有错误一词的行
2.  无论 testError 的值是多少，脚本都会挂在行中

这是代码：

```
testError=false

output=$(scons)
while read -r line; do
    if [[ $line == .*[eE]rror.* ]] ; then echo 'ERROR' ; $testError = true ; fi #$testError = true fi
done

echo $testError
if  $testError  ; then exit ; fi;

... other commands 
```

**编辑：**按照所有海报的答案和[Bash 在循环内设置全局变量并保留其值 - 或处理假人的替代](https://stackoverflow.com/questions/9012841/bash-setting-a-global-variable-inside-a-loop-and-retaining-its-value-or-proce)以及[如何在 bash 脚本中使用正则表达式？](https://stackoverflow.com/questions/304864/how-do-i-use-regular-expressions-in-bash-scripts)，这是代码的最终版本。有用：

```
testError=false

shopt -s lastpipe
scons | while read -r line; do
  if [[ $line =~ .*[eE]rror.* ]] ; then
    echo -e 'ERROR' 
    testError=true 
  fi 
  echo -e '.'
done

if  $testError  ; then
    set -e 
fi 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:00:54.250

`testError`您在管道诱导的子外壳中设置 的值。当该子外壳退出时（在管道的末端），您所做的任何更改都会消失。试试这个：

```
while read -r line; do
   if [[ $line == .*[eE]rror.* ]] ; then
     echo -e 'ERROR' 
     testError=true 
   fi #$testError = true fi
done < <( scons ) 
```

或者，如果您不想或不能使用进程替换，请使用临时文件

```
scons > tmp
while read -r line; do
  if [[ $line == .*[eE]rror.* ]] ; then
    echo -e 'ERROR' 
    testError=true 
  fi #$testError = true fi
done < tmp 
```

这消除了管道，因此更改`testError`在 while 循环之后持续存在。

而且，如果您的 bash 版本足够新（4.2 或更高版本），则有一个选项允许管道末尾的 while 循环在当前 shell 中执行，而不是在子 shell 中执行。

```
shopt -s lastpipe
scons | while read -r line; do
  if [[ $line == .*[eE]rror.* ]] ; then
    echo -e 'ERROR' 
    testError=true 
  fi #$testError = true fi
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T23:47:03.077

你应该试试

```
set -e 
```

如果命令以非零状态退出，这将停止脚本继续

或更好

```
error_case() { # do something special; }
trap 'echo >&2 "an error occurs"; error_case' ERR 
```

`error_case`每次命令以非零状态退出时运行此函数

见[http://mywiki.wooledge.org/BashFAQ/105](http://mywiki.wooledge.org/BashFAQ/105)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T23:48:11.770

您是否正在尝试解析 scons 的输出？

这：

```
output=$(scons)
while read -r line; do
    if [[ $line == .*[eE]rror.* ]] ; then 
        echo 'ERROR' 
        testError=true
    fi
done 
```

不这样做。也许你想要：

```
scons | while read -r line; do ... ; done 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T23:53:11.843

另一个错误是作业中有空格。并跳过`$`

```
$testError = true 
```

应该

```
testError=true 
```

*编辑*

testerror 在子shell 中更改。尝试

```
testerror=$(
    scons | while read -r line; do
        if [[ $line == .*[eE]rror.* ]] ; then
            echo true 
        fi #$testError = true fi
    done
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T00:48:10.893

我回答也是因为其他答案没有注意到：应该以这种方式使用正则表达式，使用`=~`而不是`==`：

```
if [[ $line =~ .*[eE]rror.* ]] ; then
... 
```

cf[如何在 bash 脚本中使用正则表达式？](https://stackoverflow.com/questions/304864/how-do-i-use-regular-expressions-in-bash-scripts)

# java - java.lang.AssertionError：在 Mockito 中。如何解决？

> ID：14865415
> 
> 赞同：1
> 
> 时间：2013-02-13T23:45:52.717
> 
> 标签：java, maven, intellij-idea, mockito

```
public void someMethod() throws Exception {
        // null 
        when(request.getParameter("abc")).thenReturn(null);

        try {
            abc.manageIncome(request, response, nancy, null);
            fail();
        } catch(IllegalArgumentException ex) {}

        verify(nancy.manageIncome(request, response, nancy, "abc"));
    } 
```

我收到以下错误：`java.lang.AssertionError`。

如何解决？我正在使用 Mockito。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T02:27:02.837

我无法告诉您这是否与您的 相关`AssertionError`，但您正在滥用该`verify`方法，该方法（与 不同`when`）应该只包装有问题的模拟，而不是整个方法调用。

```
/* BAD */  verify(nancy.manageIncome(request, response, nancy, "abc"));
/* GOOD */ verify(nancy).manageIncome(request, response, nancy, "abc"); 
```

（为什么？基本上，`when`只有在mock上的方法返回之后才被调用，所以mock可以将它未来的存根建立在刚刚发生的调用上。`verify`需要在mock上调用方法之前调用，所以它不会混淆通过来自被测系统的实际调用进行验证，并根据需要抛出或返回。）

# solr - 在多值字段上使用 Solr4 的自动完成功能

> ID：14865417
> 
> 赞同：3
> 
> 时间：2013-02-13T23:45:54.713
> 
> 标签：solr, autocomplete, solr4

我看过关于跨多个字段执行自动完成但没有在多值字段上执行自动完成的帖子。

我的自动完成功能适用于非多值字段。

我的问题是，当我在多值字段上运行查询时，只要文档与该查询匹配，则该文档的多值字段中的*所有*字段都会在构面结果中返回。

下面是我的架构，类似于 Solr 4 Cookbook 中提出的架构。

```
 <fieldType name="text_autocomplete" class="solr.TextField" positionIncrementGap="100">
  <analyzer type="index">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.EdgeNGramFilterFactory" minGramSize="1" maxGramSize="25" />
  </analyzer>
  <analyzer type="query">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
  </analyzer>
</fieldType>

<field name="publisherText-str" type="string" indexed="true" stored="false" multiValued="true"/>
<field name="publisherText-ac" type="text_autocomplete" indexed="true" stored="true" required="false" multiValued="true"/> 
```

如您所见，publisherText 是一个多值字段。我执行这样的查询来测试自动完成功能：

```
/select?q=publisherText-ac:new&facet=true&facet.field=publisherText-str&facet.mincount=1&rows=0 
```

查询是“新的”，它匹配一组文档。但是，构面结果集包含每个匹配文档的其他 publisherText 值（包含在多值字段中）。

**更新**：查询“new”时，结果集应包括“New York Times”和“Times New Roman”但不需要解决中缀问题：“Knewton Gazette”不需要在结果集中。

有没有办法让构面结果只包含与查询匹配的值？或者是否有不同的（更好的？）方式来支持更优雅地处理多值字段的完整自动完成功能？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:35:32.683

我认为最理想的方法是创建一个单独的集合或核心（取决于您是否使用云）并以某种方式对您的数据进行索引，以便查询所需的查询结果。当然，在某些情况下这可能是不可能的，但如果是你的情况，那就去吧。在这样的核心中，您将只有与您的自动完成相关的字段和数据，因此在大多数情况下，它会比原始核心更小，更少的术语，这应该会导致更快的查询。除此之外，此类核心或集合针对自动完成查询进行了优化，您将获得更多性能。

但是，如果您不能采用多核/集合方法，那么如果您需要过滤，突出显示可能是最好的方法。在这种情况下，您可能希望打开术语验证器并使用 FastVectorHighlighting 以获得更好的 Solr 突出显示性能 ( [http://solr.pl/en/2011/06/13/solr-3-1-fastvectorhighlighting/](http://solr.pl/en/2011/06/13/solr-3-1-fastvectorhighlighting/) )。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T13:02:38.917

到目前为止，我已经使用了这两种方法：

(A) 坚持使用构面并接受您必须通过正则表达式或 String.startsWith 来减少结果。如果你使用像 YUI3 Autocomplete 插件这样的前端组件，它实际上可能并没有那么糟糕，它已经提供了这个功能，而你不必做太多的事情。

(B) 通过添加到您的查询来使用突出显示：

```
&hl=true&hl.fl=publisherText-ac 
```

对于每个命中，高亮组件将返回匹配值，包括高亮标签（默认情况下`<em>`）。如果您的自动完成字段来自多个输入字段并且您不想搜索结果以找出哪个字段包含匹配值，这将更加有用。但是，结果列表可能包含重复项。

我正在使用这两种方法，(A) 用于单个字段的自动完成，(B) 从多个字段采购自动完成时。我试图摆脱`<em>`突出显示结果中包含的标签，但事实证明这是不可能的（您只能更改它们，但不能完全删除它们）。

（在这里使用 SOLR 4.0）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T18:52:49.683

您可以只使用`facet.prefix=new`参数并让 solr 为您过滤掉这些条目。我还要考虑的是避免在这里制作 ngram。制作一个方面并使用`facet.prefix`它已经可以解决问题了。希望您不会有太多独特的术语，并且性能会很好。

# c - C：将预编译的代码编译为内联

> ID：14865418
> 
> 赞同：-1
> 
> 时间：2013-02-13T23:46:02.853
> 
> 标签：c, gcc, inlining, lto

由于一些相当复杂的原因，我有一组文件，我想单独编译然后链接，但是这样一个中的函数被内联放置在第二个中。这是因为我希望它们在 GCC 中使用不同的标志进行编译。我知道我可以通过研究如何解决这个问题来解决这个问题，但我想知道这是否可能。

编辑1：如果没有，是否可以将“外部”函数编译成我可以包含在另一个文件中的程序集形式。是的，疯狂但也很酷……

快速浏览一下，这很可能是一个选择。我想自动编译它是不可能的，所以有人可以给我一些关于汇编的信息吗？我只使用了基本的 ARM 程序集。我已经用`-S`GCC 中的标志编译成玩具函数。如何将寄存器与变量链接？它们会始终保持相同的顺序吗？该功能将得到高度优化。我应该什么时候开始和结束提取？我应该`.cfi_startproc`在开头和`.cfi_def_cfa 7, 8`结尾都包含吗？#

编辑 2： [这篇文章](https://stackoverflow.com/questions/5987020/can-the-linker-inline-functions)详细介绍了 gcc 如何使用`-flto`. 遗憾的是，这仅适用于 4.5 版，我没有也没有能力安装它，因为我没有需要在其上编译它的机器的 root 访问权限。另一种可能的解决方案是解释如何将不同版本的 GCC 安装到 unix 机器上的文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T12:04:58.473

据我所知，gcc 不会进行[链接时间优化](http://en.wikipedia.org/wiki/Link-time_optimization)（特别是内联），至少对于标准 ld 链接器（可能是新的[黄金](http://sourceware.org/cgi-bin/cvsweb.cgi/~checkout~/src/gold/README?rev=1.5.2.1&content-type=text/plain&cvsroot=src)链接器会这样做，但我真的不这么认为）。[Clang](http://clang.llvm.org/)原则上应该能够做到这一点，因为它依赖于[LLVM](http://llvm.org/)，[它支持链接时间优化](http://llvm.org/docs/LinkTimeOptimization.html)（不过，您的问题似乎是 gcc 空间的）。

不过，从您的问题来看，您似乎正在寻找一种在编译后合并目标文件的方法，而不一定是通过内联它们包含的函数。这可以通过多种方式完成：

1.  使用 ar 将它们归档到静态库中：例如`ar libfoo.a obj1.o obj2.o`.
2.  将它们组合成第三个可重定位对象（ld 的 --relocatable 选项）。`gcc -Wl,--relocatable -o obj3.o obj1.o obj2.o`
3.  将它们放入共享库（请注意，这需要使用 -fPIC 编译对象），例如`gcc -shared -o libfoo.so obj1.o obj2.o`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-13T23:58:27.113

您可以使用 -c 选项进行编译以创建一组 .o 文件，甚至可以创建一个 .so 文件。然后在 gcc 的链接阶段使用你喜欢的顺序。

# r - 无法使用 write.dbf 处理矩阵/数组列

> ID：14865419
> 
> 赞同：1
> 
> 时间：2013-02-13T23:46:02.423
> 
> 标签：r, gis, spatial, shapefile, dbf

希望我把所有东西都放在一起解决这个问题。对我来说是第一次，描述起来有点棘手。

我想向 dbf 文件添加一些属性，然后将其保存以在 qgis 中使用。其关于选举和数据是来自11个政党的绝对值和相对值的投票。我为此使用了 shapefiles 包，但也简单地使用了外文进行了尝试。

我的系统：RStudio 0.97.311、R 2.15.2、shapefile 0.7、外国 0.8-52、ubuntu 12.04

尝试#1 => 没问题

```
shpDistricts <- read.shapefile(filename)
shpDataDistricts <- shpDistricts$dbf[[1]]
shpDataDistricts <- shpDataDistricts[, -c(3, 4, 5)] # delete some columns
shpDistricts$dbf[[1]] <- shpDataDistricts
write.shapefile(shpDistricts, filename)) 
```

尝试#2 =>“get 中的错误（“write.dbf”，“package:foreign”）（dbf$dbf，out.name）：无法处理矩阵/数组列”

```
shpDistricts <- read.shapefile(filename)
shpDataDistricts <- shpDistricts$dbf[[1]]
shpDataDistricts <- shpDataDistricts[, -c(3, 4, 5)] # delete some columns
shpDataDistricts <- cbind(shpDataDistricts, votesDistrict[, 2]) # add a new column
names(shpDataDistricts)[5] <- "SPOE"
shpDistricts$dbf[[1]] <- shpDataDistricts
write.shapefile(shpDistricts, filename)) 
```

写入函数返回“get("write.dbf", "package:foreign")(dbf$dbf, out.name) 中的错误：无法处理矩阵/数组列”

因此，只需向 data.frame 添加一列（整数），write.dbf 函数就无法再写出。我现在在这个简单的问题上调试了 3 个小时。通过打开 shapefile 和 dbf 文件尝试使用 shapefiles 包，一直都是同样的问题。

当我直接使用外部包时（read.dbf）。

如果我在没有投票数据的情况下保存 dbf 文件（仅使用步骤 1+2 中的小调整），那没问题。它必须与与投票数据的合并有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T16:40:46.910

在使用 rgdal 处理 R 中的 shapefile 时，我收到了相同的错误消息（“get("write.dbf"...) 中的错误。我在 shapefile 中添加了一个列，然后尝试保存输出并得到错误。我将该列作为数据框添加到 shapefile 中，**当我通过 as.factor() 将其转换为因子时，错误消失了**。

shapefile$column <- as.factor(additional.column)

writePolyShape（形状文件，文件名）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-08T01:32:41.227

**问题是 write.dbf 无法将数据框写入属性表。所以我尝试将其更改为字符数据**。

我最初的**错误代码**是：

```
d1<-data.frame(as.character(data1))
colnames(d1)<-c("county") #using rbind should give them same column name
d2<-data.frame(as.character(data2))
colnames(d2)<-c("county")
county<-rbind(d1,d2)
dbfdata$county <- county
write.dbf(dbfdata, "PANY_animals_84.dbf") **##doesn't work** 
##Error in write.dbf(dataname, ".bdf")cannot handle matrix/array columns 
```

然后我将所有内容都更改为字符，它起作用了！**正确的代码**是：

```
d1<-as.character(data1)
d2<-as.character(data2)
county<-c(d1,d2)
dbfdata$county <- county
write.dbf(dbfdata, "filename") 
```

希望能帮助到你！

# session - 外部重定向后 Spring 3 MVC 会话丢失

> ID：14865423
> 
> 赞同：3
> 
> 时间：2013-02-13T23:46:49.340
> 
> 标签：session, redirect, spring-mvc, cookies, session-cookies

我有一个 Spring 3 MVC 应用程序，该应用程序的一部分需要重定向到第三方支付网站，并且该支付网站在完成后重定向回我的应用程序。问题是 Spring 似乎创建了一个新会话而不是使用旧会话，并删除了之前存储在会话中的所有数据。这给我的应用程序带来了巨大的问题，我想知道是否有办法在外部重定向后保留会话？

此外，在我的浏览器上启用了 cookie，并且我确实验证了 cookie 中的 jsessionid 值在重定向后发生了变化，表明新会话覆盖了旧会话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:40:52.823

Can you provide the following info:

1.  After coming back from the 3rd party site, does your app use a different domain/sub domain from what it uses before redirecting to the 3rd party site?
2.  Is there a possibility that your session timeout value is so low that the session expires by the time the user returns to your app?
3.  Does your app use frames having onunload events that invalidate the session?

# ios - 在 iOS 6 中拍摄和保存照片

> ID：14865424
> 
> 赞同：0
> 
> 时间：2013-02-13T23:46:52.047
> 
> 标签：ios, cocoa-touch, ios6

我第一次需要使用相机感应 iOS 6，好像有些东西已经被弃用了。做了一些研究，找不到任何东西，但我知道它在那里。我只需要拍照，或者从相机胶卷中获取并将其保存到图像视图中。感谢任何提供有用信息的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:52:55.337

所有有用的信息都在 Apple 文档中。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html)

包括不推荐使用的东西（参见附录 A）。

更高级的概述是相机编程主题指南：

[http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/CameraAndPhotoLib_TopicsForIOS/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010400](http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/CameraAndPhotoLib_TopicsForIOS/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010400)

# java - 否则如果问题 java

> ID：14865431
> 
> 赞同：0
> 
> 时间：2013-02-13T23:47:15.307
> 
> 标签：java

我有一个 else if 循环，循环搜索文件扩展名以查看它是否匹配，如果不匹配，我希望它打印出消息，我尝试了 print 和 println，但它从不打印出消息，任何想法我做错了什么，除此之外，循环工作得很好

```
 if (extension.equals("txt"))
        {
            psInFormat = DocFlavor.INPUT_STREAM.AUTOSENSE;
        } else if (extension.equals("jpeg")) {
            psInFormat = DocFlavor.INPUT_STREAM.JPEG;
        } else if (extension.equals("png")) {
            psInFormat = DocFlavor.INPUT_STREAM.PNG;
        } else if (extension.equals("gif")) {
            psInFormat = DocFlavor.INPUT_STREAM.GIF;
        } else if (extension.equals("pdf")) {
            psInFormat = DocFlavor.INPUT_STREAM.PDF;
        } else if (extension.equals("html")) {
            psInFormat = DocFlavor.INPUT_STREAM.TEXT_HTML_HOST;
        } else { 
            System.out.print ("Sorry the printer does no support your file type, sorry") ;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:58:07.050

代码没有问题，可以查看以下

*   `extension`是一个带有默认实现的`String`ie`equals()`
*   您提供的扩展名不是`txt,jpeg,png,gif,pdf and html`，因此可以打印消息

你会更好地做你的比较，以避免可能的`NullPointerException`和区分大小写的比较

```
if("txt".equalsIgnoreCase(extension)){
   //...
 } 
```

最后，您可以尝试在任何条件**之外**打印调试语句，看看您是否可以在`console`

# android - 覆盖 onDraw() 或 draw()？

> ID：14865434
> 
> 赞同：22
> 
> 时间：2013-02-13T23:47:38.410
> 
> 标签：android, draw, surfaceview, ondraw

我的项目是基于 surfaceView 的，到目前为止，我已经在 onDraw 中进行了所有渲染，我将其覆盖。一切似乎都很好。

但是，我刚刚更新了我的 SDK，现在它给了我一个错误，告诉我：

> 可疑的方法调用；可能应该叫“draw”而不是“onDraw”

有人可以解释这两者之间的区别吗？

我在网上阅读了一些类似的问题，但没有找到我理解的解释。

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-05-28T08:10:28.043

I tried cleaning my project and it did solve the problem. Try it.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-14T00:14:56.327

[SurfaceView.draw()](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/view/SurfaceView.java#SurfaceView)基本上调用[View.draw();](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/view/View.java#View.draw%28android.graphics.Canvas%29) 如果你想实现你的绘图，你应该在[View.onDraw()](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/view/View.java#View.onDraw%28android.graphics.Canvas%29)中进行，这是供你实现的，甚至在源代码注释中也有说明。

> 这个方法被 ViewGroup.drawChild() 调用来让每个子视图自己绘制。这个 draw() 方法是一个实现细节，不打算被覆盖或从除 ViewGroup.drawChild() 之外的任何其他地方调用。

至于它们之间的区别：
draw()：

```
13416        /*
13417         * Draw traversal performs several drawing steps which must be executed
13418         * in the appropriate order:
13419         *
13420         *      1\. Draw the background
13421         *      2\. If necessary, save the canvas' layers to prepare for fading
13422         *      3\. Draw view's content
13423         *      4\. Draw children
13424         *      5\. If necessary, draw the fading edges and restore layers
13425         *      6\. Draw decorations (scrollbars for instance)
13426         */ 
```

onDraw() 为空。它由你来实施。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-09-05T08:53:59.113

我一直有这个问题。

我是这样处理的：

1) 声明如下方法。

```
@SuppressLint("WrongCall")
public void drawTheView() {
    theCanvas = null;

    try{
        theCanvas = getHolder().lockCanvas();
        if(theCanvas != null) {
            onDraw(theCanvas);
        }
    } finally {
        getHolder().unlockCanvasAndPost(theCanvas);
    }
} 
```

2) 现在可以修改 onDraw() 方法：

```
@Override
public void onDraw(Canvas canvas) {
    //Do some drawing

} 
```

您可以从任何地方调用 drawTheView() 方法，并以这种方式调用 onDraw() 方法而不会出现错误...

我认为这是一种实用的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-12T12:55:37.883

请注意，在绘图的情况下，当 ViewGroup 想要在其子视图上绘制内容时，通常会使用覆盖**draw()**并调用**super.draw 。****onDraw**中绘制的内容会出现在 children 下。﻿</p>

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-16T04:46:18.937

正如friiky所说，`@SuppressLint("WrongCall")`解决了我的问题。但是它必须在方法名称的前面，而不是上面。

我所做的是将鼠标放在错误代码上，右键单击并选择`Add @SuppressLint("WrongCall")`

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2013-02-14T00:03:46.760

`onDraw`给你一个画布来绘制到屏幕上。

`draw()`允许您手动将画布绘制到屏幕上（您必须自己制作画布）。

# r - “else”错误中出现意外的“else”

> ID：14865435
> 
> 赞同：61
> 
> 时间：2013-02-13T23:47:38.257
> 
> 标签：r, if-statement

我收到此错误：

> 错误：“else”中出现意外的“else”

从这个`if, else`声明：

```
if (dsnt<0.05) {
     wilcox.test(distance[result=='nt'],distance[result=='t'],alternative=c("two.sided"),paired=TRUE) }
else {
      if (dst<0.05) {
wilcox.test(distance[result=='nt'],distance[result=='t'],alternative=c("two.sided"),paired=TRUE) }
   else {
         t.test(distance[result=='nt'],distance[result=='t'],alternative=c("two.sided"),paired=TRUE)       } } 
```

这有什么问题？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2013-02-13T23:56:13.830

您需要重新排列大括号。您的第一个语句是完整的，因此 R 将其解释为这样并在其他行产生语法错误。您的代码应如下所示：

```
if (dsnt<0.05) {
  wilcox.test(distance[result=='nt'],distance[result=='t'],alternative=c("two.sided"),paired=TRUE)
} else if (dst<0.05) {
  wilcox.test(distance[result=='nt'],distance[result=='t'],alternative=c("two.sided"),paired=TRUE)
} else {
  t.test(distance[result=='nt'],distance[result=='t'],alternative=c("two.sided"),paired=TRUE)       
} 
```

更简单地说，如果你有：

```
if(condition == TRUE) x <- TRUE
else x <- FALSE 
```

然后 R 读取第一行，因为它是完整的，所以完整地运行它。当它进入下一行时，它会出现“Else？Else what？” 因为这是一个全新的声明。要让 R 将 else 解释为前面 if 语句的一部分，您必须使用花括号来告诉 R 您尚未完成：

```
if(condition == TRUE) {x <- TRUE
 } else {x <- FALSE} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-13T23:51:43.177

我建议阅读一下语法。[看这里。](http://cran.r-project.org/doc/manuals/R-lang.html#if)

```
if (dsnt<0.05) {
  wilcox.test(distance[result=='nt'],distance[result=='t'],alternative=c("two.sided"),paired=TRUE) 
} else if (dst<0.05) {
    wilcox.test(distance[result=='nt'],distance[result=='t'],alternative=c("two.sided"),paired=TRUE)
} else 
  t.test(distance[result=='nt'],distance[result=='t'],alternative=c("two.sided"),paired=TRUE) 
```

# haskell - 在 Haskell 中 (== " ") 是什么意思？

> ID：14865442
> 
> 赞同：8
> 
> 时间：2013-02-13T23:48:20.050
> 
> 标签：haskell, syntax, boolean

对于那些可能会说“在你的教科书中查找”或“Hoogle it”的秃鹰，我做到了。

我看到了声明

`recipe = (== "000001")`

对我来说，它看起来像是某种布尔值，但我不确定。我已经尝试在 GHCi 中以不同的方式对其进行测试，但我无法找出任何可行的方法。有人能解释一下这是什么意思吗，这个问题将是下次有人谷歌*Haskell时的结果（==""）*

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-13T23:55:16.013

这是一个[部分](http://www.haskell.org/haskellwiki/Section_of_an_infix_operator)。它等价于`recipe = \x -> x == "000001"`（又与 相同`recipe x = x == "000001"`）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-13T23:55:16.060

你可以用`GHCI`这个来解决这个问题。

在`GHCI`，放入`let recipe = (== "000001")`。现在我们可以看到它是如何工作的。试试看`:t recipe`是什么类型。返回`recipe :: [Char] -> Bool`，所以看起来这是一个接受`Char`s (a `String`) 列表并返回 a的函数`Bool`。

如果你测试它，你会发现它会返回`False`任何输入，除了`"000001"`.

由于`==`is 是一个运算符，因此您可以将其部分应用于一个参数，它将返回一个函数，该函数接受另一个参数并返回结果。因此，这里`== "000001"`返回一个函数，该函数接受一个参数来填充 the 的另一侧`==`并返回结果。

* * *

编辑：如果定义是`recipe = ((==) "000001")`这个解释是正确的。

要理解这一点，您应该查找[partial application](http://www.haskell.org/haskellwiki/Partial_application)。该`==`函数的类型是`a -> a -> Bool`，一个接受两个相同类型的参数并返回一个 的函数`Bool`。

但它也是一个类型的函数`a -> (a -> Bool)`，它接受一个类型的参数`a`并返回一个带有签名的新函数`a -> Bool`。这就是这里发生的事情。我们为 提供了一个参数`==`，因此它返回了一个类型为 的新函数`a -> Bool`，或者`[Char] -> Bool`在这种特殊情况下。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-13T23:55:03.617

对于二元运算符`@`，表达式`(@ x)`意味着`(\y -> y @ x)`.

在你的情况下，它将是`(\y -> y == "000001")`ie。接受 String 并判断它是否等于的函数`"000001"`。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-13T23:55:11.800

`(== arg)`or`(arg ==)`是一个运算符部分（它也适用于其他运算符 - 不仅仅是`==`）。它的作用是将运算符部分应用于给定的操作数。所以`(== "foo")`是一样的`\x -> x == "foo"`。

# php - 带有 JSON 调用的 Div onClick 不起作用

> ID：14865445
> 
> 赞同：0
> 
> 时间：2013-02-13T23:48:29.563
> 
> 标签：php, jquery, json, html, alert

我有一个调用 php 文件 onkeyup 的搜索功能。现在在 JQuery 中，我有一个 onClick 函数，当您从同一个 JSON 调用中单击一个 div 时，它会发出警报，也许从下面的代码中更容易理解：

```
<?php
$Connect = new mysqli("localhost", "root", "", "Data");
$Val = $_POST['Val'];

if($Val)
{
    $Search = 'SELECT * FROM Users WHERE ';
    $Term = explode(" ", $Val);

    foreach($Term as $Key)
    {
        $I = 0;
        $I++;
        if($I == 1)
        {
            $Search .= 'Username LIKE "'.$Key.'%" LIMIT 0, 10 ';
        }
        else
        {
            $Search .= 'OR Username LIKE "'.$Key.'%" LIMIT 0, 10 ';
        }
    }

    if($Result = $Connect->query($Search))
    {
        while($Row = $Result->fetch_assoc())
        {
            $User = $Row['Username'];

            $USearch['S'][] = '<div class="Result"><label class="TText" style="cursor:pointer;">' . $User . '</label></div>';
        }
    }
}
echo json_encode($USearch);
?> 
```

现在，如您所见，一旦用户在一个框中键入一个 div，就会显示一个显示用户的所有 LIKE 记录的 div，一旦单击该 div，什么都不会发生。

```
$('.Result').click(function()
{
    alert('Hi');
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T02:01:18.090

当 ajax 调用返回成功状态时，您可以使用例如 jquery 绑定方法。（有关更多信息，请参见此处[http://api.jquery.com/bind/](http://api.jquery.com/bind/)）

```
 function myAjaxFunct(val){

   $.ajax(
    {
        type: "POST",
        url: myPhpFile.php,
        datatype: "jsonp",
        data: {val: val},
        success: function (result) {

            $("#jsonResultDisplay").text(result);

            $('.Result').bind('click', function() {
               alert('hi');
            }); 
        }
    });

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T01:44:56.607

您正在动态创建元素，这就是它不起作用的原因。

使用`on()`方法。

检查一个例子：

[http://jsfiddle.net/pZQ8T/](http://jsfiddle.net/pZQ8T/)

# methods - 使用条目删除方法时出现 Tkinter 错误

> ID：14865449
> 
> 赞同：0
> 
> 时间：2013-02-13T23:49:12.427
> 
> 标签：methods, tkinter, typeerror, tkinter-entry

在我的游戏中，我有一个`__init__`函数可以创建一组七个输入框，如下所示：

```
self.string1 = StringVal()
self.entry1 = Entry(frame, textvariable = self.string1).grid(row = 4, column = 1, sticky = W) 
```

这被复制了六次。这行得通。但是，在游戏结束时，我想删除条目框的文本，使用此代码我在网上找到了几个地方：

```
self.entry1.delete(0, END) 
```

我还尝试使用我发现的其他东西：

```
if self.entry1.get():
    self.entry1.delete(0, END) 
```

这些都说 that`self.entry1`是一个`NoneType`对象，并且没有方法`.get()`或`.delete()`. 只是为了尝试一下，我用`self.entry1.get()`和`self.entry1.delete(0,END)`替换了`self.string1.get()`等等。我也尝试用`.delete(0, END)`替换`.delete(0.0, END)`。这些都不起作用。我不明白我做错了什么。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:32:35.170

当你做这样的事情时：

```
self.foo = Button(...).grid(...) 
```

...然后存储的`self.foo`是对`grid()`. 这将永远是`None`。您需要将小部件创建与布局分开，以便保存对已创建小部件的引用。

# php - 将php变量传递给外部javascript

> ID：14865454
> 
> 赞同：0
> 
> 时间：2013-02-13T23:49:21.803
> 
> 标签：php, javascript

如何将 php 变量传递到外部 javascript 文件中？我发现了很多关于此的问题，但无论如何我都无法弄清楚。

在 HTML 文件中，我有这个链接

```
<script type="text/javascript" src="myscript.php"></script> 
```

这是我一直试图输出为 javascript 文件的 myscript.php 文件：

```
<?
Header("content-type: text/javascript");
?>

$(document).ready(function() {

$("#validate_form").validate({
    rules: {
        page_title: "required",
        seo_url: "required"
    },

    messages: {
        page_title: "<?=$page_title?>",
        seo_url: "<?=$seo_url?>"
    }
 }); 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:51:27.987

使用查询字符串附加它们：

```
<script type="text/javascript" src="myscript.php?page_title=whatever&seo_url=whatever"></script>

<?
Header("content-type: text/javascript");
?>

$(document).ready(function() {

$("#validate_form").validate({
    rules: {
        page_title: "required",
        seo_url: "required"
    },

    messages: {
        page_title: "<?=$_GET['page_title'];?>",
        seo_url: "<?=$_GET['seo_url'];?>"
    }
 }); 
}); 
```

# objective-c - 索引 1 超出范围的错误

> ID：14865464
> 
> 赞同：0
> 
> 时间：2013-02-13T23:50:02.927
> 
> 标签：objective-c, nsmutablearray

如下代码，我想将 matrix1Col 和 matrix2Col 发送到 multiply 方法。

但索引 1 超出范围是错误的。

从 UIButton 代码内部

```
double kk[2][2] = {{1,2},{5,6}};
double t [2][1] = {1,2};`

if (!matrix1Col) {
    matrix1Col = [NSMutableArray array];
}

for (unsigned int i=0; i<2; i++) {
    matrix1Row = [NSMutableArray new];
    for (unsigned int j=0 ; j<2; j++) {
        [matrix1Row addObject:@(kk[i][j])];
    }
    [matrix1Col addObject:matrix1Row];
}

if (!matrix2Col) {
    matrix2Col = [NSMutableArray array];
}

for (unsigned int i=0; i<2; i++) {
    matrix2Row = [NSMutableArray new];
    for (unsigned int j=0; j<1; j++) {
        [matrix2Row addObject:@(t[i][j])];
    }
    [matrix2Col addObject:matrix2Row];
}
NSMutableArray *resultMultiply = [self multiply:matrix1Col :matrix2Col]; 
```

ViewController.m 中的另一个方法：

```
-(NSMutableArray*)multiply:(NSMutableArray*)matrix1 :(NSMutableArray*)matrix2{
int matrix1RowCount = [matrix1 count];
int matrix2RowCount = [matrix2 count];
int matrix2ColCount = [[matrix2 objectAtIndex:0] count];

NSMutableArray *multiplyMatrix = [NSMutableArray arrayWithCapacity:matrix1RowCount];
for (int i=0; i< matrix1RowCount; i++) {
    NSMutableArray *matrixInRow = [NSMutableArray arrayWithCapacity:matrix2ColCount];
    for (int j=0; j<matrix2RowCount; j++) {
        double valueTotal = 0;
        for (int k=0; k<matrix2ColCount; k++) {
            double value1 = [[[matrix1 objectAtIndex:i] objectAtIndex:k] doubleValue];
            double value2 = [[[matrix2 objectAtIndex:k] objectAtIndex:j] doubleValue];
            valueTotal += value1*value2;
        }
        [matrixInRow addObject:[NSNumber numberWithDouble:valueTotal]];
    }
    [multiplyMatrix addObject:matrixInRow];
}
return multiplyMatrix;
} 
```

这是错误代码：

```
2013-02-14 06:26:06.595 matrixMutableArray[21578:c07] *** Terminating app due to                     uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 1 beyond bounds [0 .. 0]'
*** First throw call stack: 
```

我找不到错误的地方。

谢谢你的评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:38:05.497

此行发生错误：

```
double value2 = [[[matrix2 objectAtIndex:k] objectAtIndex:j] doubleValue]; 
```

当错误发生时 k=0 且 j=1。matrix2 的 objectAtIndex:0 只有一个对象，因此出现错误。

# sql - 如何优化 T-SQL 查询？

> ID：14865467
> 
> 赞同：0
> 
> 时间：2013-02-13T23:50:07.693
> 
> 标签：sql, sql-server, optimization

我正在尝试优化以下查询以提高性能，尤其是联接。我将不胜感激任何建议和帮助。非常感谢。我正在考虑使用 CTE 而不是子查询

询问：

```
Select  year(dtb.tbDATE) as YearR, 
     `CONVERT(VARCHAR(12),dtb.tbDATE,110) as DateR,
     (case when dtb.l_grp_no= 7 then COMPANY_B else COMPANY_A end ) as Portfolio,
     (case when dtb.past_days between 5 and 30 then '5-30'
          when dtb.past_days between 31 and 60  then'31-60'
          when dtb.past_days between 61 and 90  then '61-90'
          when dtb.past_days >= 91 then '91+' 
          when dtb.past_days <5 then 'Current' else 'Dis_po' end) 'Qdel',
     case when lsc.SStatusC is not null and dtb.tbDATE> ls.eff_date 
          then lsc.SStatusC else 'XX'end as 'LStatus',
     count(dtb.refaccno) as lcount,
     sum (dtb.P_bal) as Lbal
from sln.[dbo].[table_dtb] as dtb
     --left outer join sln.dbo.acct_l la on dtb.accrefno = la.accrefno
     left outer join (select stat_acct_l.* from sln.dbo.stat_acct_l
     inner join 
         (select refaccno, max(row_id) as MaxRow_id
          from sln.dbo.stat_acct_l
          group by refaccno) as maxStatus 
        on stat_acct_l.refaccno = maxStatus.refaccno 
            and stat_acct_l.row_id = maxStatus.MaxRow_id) as ls 
        on ls.refaccno = dtb.refaccno
     left outer join dw.dbo.AccSt_C lsc on lsc.Stat_C_ID= ls.status_code_no
where dtb.l_grp_no in (7,4,8,15)and dtb.tbDATE > '2010-06-31'
     and dtb.P_bal+dtb.l_C_bal >0
group by year(dtb.tbDATE), CONVERT(VARCHAR(12),dtb.tbDATE,110),
     case when dtb.past_days between 5 and 30 then '5-30'
          when dtb.past_days between 31 and 60  then'31-60'
          when dtb.past_days between 61 and 90  then '61-90'
          when dtb.past_days >= 91 then '91+' 
          when dtb.past_days <5 then 'Current' else 'Dis_po' end
     case when dtb.l_grp_no= 7 then COMPANY_B else COMPANY_A end,
          case when lsc.SStatusC is not null 
                    and dtb.tbDATE> ls.eff_date Yearthen 
           lsc.SStatusC else 'XX'
      end
order by year(dtb.tbDATE), CONVERT(VARCHAR(12),dtb.tbDATE,110),
      case when dtb.l_grp_no= 7 then COMPANY_Belse COMPANY_A end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T10:31:37.097

我会尝试将您的案例陈述封装到 UDF 中。与常规 case 语句相比，这些应该作为 UDF 更快地计算。这也将使您的查询更易于分析和维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T03:15:43.830

您可以从`GROUP BY`子句中删除的列越多越好。根据您正在处理的行数，根据您的选择列表创建一个临时表或表变量可能是值得的，该列表包含一个名为“past_days_group”的列以容纳 5-30、31-60 等。 .`CASE`插入临时表时执行当前在您的group by子句中的逻辑，然后您可以从“past_days_group”分组的临时表中选择您的查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T00:10:39.883

我注意到了几件事。首先，如果您首先查看您的数据，您可以优化您的案例结构。然后对您的案例进行排序，以便首先查看最有可能返回 true 的案例。你可能已经这样做了，很难说。

接下来，将更多过滤从 where 子句移至 join 子句。例如，这个：

```
left outer join dw.dbo.AccSt_C lsc on lsc.Stat_C_ID= ls.status_code_no
WHERE dtb.l_grp_no in (7,4,8,15)and dtb.tbDATE > '2010-06-31' 
and dtb.P_bal+dtb.l_C_bal >0 
```

可能会像这样运行得更快：

```
left outer join dw.dbo.AccSt_C lsc on lsc.Stat_C_ID= ls.status_code_no
AND dtb.l_grp_no in (7,4,8,15)and dtb.tbDATE > '2010-06-31' 
and dtb.P_bal+dtb.l_C_bal >0 
```

另外，不要选择不需要的字段。你真的需要这里的每一列吗？

```
left outer join (select stat_acct_l.* from sln.dbo.stat_acct_l 
```

也许这些会有所帮助。

# html - 使用 CSS 动态控制两个内部 div 的大小

> ID：14865469
> 
> 赞同：1
> 
> 时间：2013-02-13T23:50:12.960
> 
> 标签：html, css, css-tables

我有一个 div 容器，它有一些固定大小的“pre”和“post”内容，主要内容夹在中间——主要内容基本上由一个标签和一个数字组成。这是一个带有示例的[jsfiddle 链接](http://jsfiddle.net/ZDU2V/2/)（代码也在下面复制 - 我添加颜色只是为了可见对比）。

线框模型：

```
------------------------------------------
| A | Variable Sized Content | 123   | B |
------------------------------------------ 
```

`A`并且`B`是前后内容；文本和数字的大小是可变的，如果没有足够的空间，内容将缩小并用省略号截断：

```
---------------------------------
| A | Variable Siz... | 123 | B |
--------------------------------- 
```

如果空间很大，多余的空格会出现在数字和 之间`B`：

```
-----------------------------------------------------
| A | Variable Sized Content | 123              | B |
----------------------------------------------------- 
```

我现在让它工作的方式是`outerDiv`在 Javascript 中设置一个调整大小`max-width`的侦听器来设置`member-text`类的。这还管理内容 div 的最小大小，以便进一步缩小也将省略数字。

我遇到的问题是试图在**没有**Javascript 的情况下使这项工作 -`max-width`不断更改所有元素相当笨拙/缓慢（示例仅显示两个项目，但在生产中这是在许多项目的列表中），并且它使结构不便于用作其他小部件的子组件。我可以重构它以使其工作，但这需要一些时间，而且似乎“更正确”的解决方案是尽可能使用 CSS。

我最接近模拟的方法是设置`max-width`为`member-text`100% 和85% 左右，这`max-width`对于`member-token`默认值 (230-290ish) 附近的 outerDiv 宽度范围看起来不错，但除此之外它会崩溃（间距太大/太小在错误的部分）。

**编辑：**我现在也尝试使用`display: table`( 和`table-row`/ `table-cell`，`table-layout: fixed`在根 div 上使用 div - 通过在除一列之外的所有列上指定宽度，该列可以动态调整大小。如果只有一个具有变量的 div，这将很有用大小的内容（文本），但在这种情况下，有两个（气泡文本，由模型中的数字表示），但这种策略似乎不允许多个动态大小的列。

**这导致了我的问题 - 甚至可以用 CSS 来做这种事情吗？如果是这样，怎么办？** 即使假设数字是固定宽度以简化问题，如果没有 Javascript，这似乎也不可能......

这是代码示例（演示问题的简化示例）

**HTML：**

```
<div class="outerDiv">
  <div class="post-mark"></div>
  <div class="pre-mark"></div>
  <div class="member">
        <div class="member-token">
            <label class="member-text">Very Long Text Purple Monkey Dishwasher</label>
        </div>
        <div class="member-bubble">
            <span class="member-bubble-text">500</span>
        </div>
  </div>
</div>

<div class="outerDiv">
  <div class="post-mark"></div>
  <div class="pre-mark"></div>
  <div class="member">
        <div class="member-token">
            <label class="member-text">Purple Monkey Dishwasher</label>
        </div>
        <div class="member-bubble">
            <span class="member-bubble-text">500</span>
        </div>
  </div>
</div> 
```

**CSS：**

```
.outerDiv {
      width: 280px;
      height: 100px;
      background-color: lightgrey;
  }

  .post-mark {
      display: inline-block;
      height: 100%;
      margin-right: 8px;
      position: relative;
      width: 18px;
      float: right;
      background-color: cyan;
  }

  .pre-mark {
      height: 100%;
      margin-left: 4px;
      position: relative;
      width: 18px;
      float: left;
      background-color: pink;
  }

  .member {
      margin-left: 22px;
      height: 22px;
      overflow: hidden;
      position: relative;
      white-space: nowrap;
      background-color: cadetblue;
  }

  .member-token {
      float: left;
      height: 20px;
      margin-left: 2px;
      padding: 0 3px;
      background-color: darksalmon
  }

  .member-text {
      display: inline-block;
      line-height: 20px;
      max-width: 193px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      background-color: goldenrod;
  }

  .member-bubble {
      display: block;
      height: 100%;
      overflow: hidden;
      padding: 0 4px;
      position: relative;
      background-color: burlywood
  }

  .member-bubble-text {
      top: 4px;
      -moz-box-sizing: border-box;
      background-color: #F2F2F2;
      border-radius: 3px 3px 3px 3px;
      display: inline-block;
      line-height: 14px;
      max-width: 100%;
      padding 0 4px;
      position: relative;
      vertical-align: top;
      color: #666666;
      font-size: 11px;
      font-weight: bold;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T03:43:53.770

我知道对于非表格数据，通常应该避免使用表格，但是，在这种情况下，我认为这可能是您最好的选择。

通过使用表格，我能够通过简单的 HTML/CSS 获得您想要的行为。
这里的关键技巧是具有可变大小的内容单元格位置：相对，并且在其中有一个绝对定位的跨度固定到所有四个角以便它伸展。

HTML：

```
<table>
<tr>
    <td class="pre">
        A
    </td>
    <td class="shrinking">
        <span>
            Very Long Text Purple Monkey Dishwasher
        </span>
    </td>
    <td class="expanding">
        <span>500</span>
        <span class="post"> B</span>
    </td>
</tr> 
```

CSS：

```
table {
    background: lightgrey;
    width:300px;
}
td {
    border: 1px red solid;
    white-space:nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
td.pre {
    width: 25px;
    min-width: 25px;
    text-align: center;
}
td.shrinking {
    max-width: 280px;
    width: 280px;
    position: relative;
}
td.shrinking span {
    white-space:nowrap;
    display: inline-block;
    overflow: hidden;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    text-overflow: ellipsis;
}
td.expanding {
    min-width: 80px;
}
.post {
    float:right;
    border: 1px red solid;
    width: 25px;
    text-align: center;
} 
```

你可以在这里看到它，[http://jsfiddle.net/ijoukov/xMf8L/](http://jsfiddle.net/ijoukov/xMf8L/)

# javascript - 引导弹出链接不起作用

> ID：14865475
> 
> 赞同：2
> 
> 时间：2013-02-13T23:50:31.213
> 
> 标签：javascript, html, twitter-bootstrap

我正在处理一个涉及共享按钮的页面，单击该按钮时会弹出一个 twitter 引导弹出窗口，其中包含共享链接。

```
var content = '<a href="http://www.facebook.com/share.php?u='+link+'">Post to facebook</a><br>';
  content += '<a href="http://twitter.com/home?status='+link+'">Post to twitter</a><br>';
  $('.sharelist').popover({
      'title': 'Share this Playlist', 
      'placement': 'bottom', 
      'html': true, 
      'content': content
  }); 
```

它几乎做到了这一点。东西弹出，链接在那里并且是蓝色的，将鼠标悬停在它们上面会将光标变成一只小手，但是当我点击时，什么也没有发生！我可以右键单击以在新选项卡中打开，并且链接再次起作用。

为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:06:49.010

更新：

```
在您的链接中添加一个名为“post-popover”的类和
```

```
$(document).ready(function() {
  $('.post-popover').popover({
    placement: 'bottom',
    title: 'Share this Playlist',
    content: 'content',
    html: true, 
    trigger: 'click'
  }); 
```

});

# css - 将 CSS 定位推向左侧的 Safari 6.0 问题

> ID：14865477
> 
> 赞同：0
> 
> 时间：2013-02-13T23:50:35.093
> 
> 标签：css

好的，这是我遇到的一个问题，但尽我所能让它听起来不那么本地化，因为这实际上可能与 Safari 有关......

在我的网站[http://s361608839.websitehome.co.uk/101d/html_new/index.html](http://s361608839.websitehome.co.uk/101d/html_new/index.html)上，我们有一个样式为 ozo_button 的按钮，其内部跨度为 btn_arrow_right ，它在除 Safari 之外的所有浏览器中看起来都是正确的形式：

![在此处输入图像描述](../Images/5d015ee3be5d0eed4a2f44bf360f160c.png)

是什么导致 CSS 使按钮在 Safari 6.0 中看起来像这样（下图），其中箭头位于文本后面？

![在此处输入图像描述](../Images/78716175bb491a40d9944a4192e48ccf.png)

**HTML：**

```
<a class="ozo_button" href="https://console.101distribution.com?v=register" style="width:200px;cursor:pointer;"><span class="btn_arrow_right ozo_button_icon">icon</span><span class="ozo_button_label">Sign-Up &amp; Get Started</span></a> 
```

**CSS：**

```
a.ozo_button {
font-family: Verdana;
font-weight: bold;
font-size:13px;
width:75px;
text-decoration:none;
display:block;
padding:5px 15px 5px 0px;
border:1px solid #999999;
text-align:center;
-moz-border-radius:5px;
-webkit-border-radius:5px;
-o-border-radius:5px;
border-radius:5px;
color:#333;
border:1px solid #DDD;
background:#FFFFFF;
background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#FFFFFF), to(#EEE));
background:-moz-linear-gradient(0% 90% 90deg, #EEE, #FFF);  
-webkit-transition: all .2s ease-in-out;
-moz-transition: all .2s ease-in-out;
-o-transition: all .2s ease-in-out;
transition: all .2s ease-in-out;
}

a.ozo_button span.ozo_button_icon {
vertical-align:middle;
margin-left: 0px;
float: left;
}
a.ozo_button span.ozo_button_label{
vertical-align:middle;
padding-left:25px;
}
.btn_arrow_right{
text-indent:-9999px;
position:absolute;
height: 35px;
width: 35px;
background:url(../images/arena_sprite.png) -263px -80px no-repeat transparent;
float: left;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:57:12.630

如果您正在使用，请尝试`display:inline-block;`或`display:block;`根据要求也使用`float:left;``display:block;`

# c# - 获取对调用方法的对象的引用？

> ID：14865478
> 
> 赞同：7
> 
> 时间：2013-02-13T23:50:46.127
> 
> 标签：c#, .net-4.0

我有一个 dll，其中包括：

```
public abstract class Module
{
   internal int ID;

   public abstract void ModuleStart();

}

public void function1() {}
public void function2() {}
//etc... 
```

然后我有另一个引用上述 dll 的 dll 并具有：

```
class MyModule : Module
{
   public override void ModuleStart()
   {
      function1();

   }

} 
```

我想做的是让 function1 知道调用模块 ID 的值，而不是传入它。有没有办法做到这一点？基本上我要做的是，加载主模块 DLL，运行加载第二个 dll 的方法，使用反射确保它具有模块的子级，为其分配一个 ID 并运行 ModuleStart。然后 MyModule 可以做它需要做的事情，从第一个 dll 调用函数以访问内部受保护的内存，但是当函数被调用时，它们需要知道调用它们的模块的 ID。这可能吗？MyModule 不知道其 ID，也无法更改它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-13T23:59:22.370

.NET 4.5 添加了一些功能来使用[`CallerMemberNameAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.callermembernameattribute.aspx). 这是文档中的示例：

```
public void TraceMessage(string message,
        [CallerMemberName] string memberName = "",
        [CallerFilePath] string sourceFilePath = "",
        [CallerLineNumber] int sourceLineNumber = 0)
{
    Trace.WriteLine("message: " + message);
    Trace.WriteLine("member name: " + memberName);
    Trace.WriteLine("source file path: " + sourceFilePath);
    Trace.WriteLine("source line number: " + sourceLineNumber);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T03:13:41.863

一些人建议使用调用堆栈来获取模块信息。如果您想获取进行调用的对象的*类型*，那还不错。不幸的是，没有可行的（即：简单、可移植和实用的）方法从调用堆栈中的数据中提取*实例*信息。有几个原因，包括优化内联方法的问题，然后不会显示在堆栈上......这也会干扰调用*类型*检测。

鉴于这一事实，简短的回答是您必须提供一个`Module`对象作为您在 DLL 中调用的方法的参数。@pswg 建议的方法是实现此目的的一种方法，但缺点是可能会污染`Module`类的符号空间。这可以通过让`Module`类实现一个受保护的或公共的 API 成员来解决，该成员公开您要提供的功能：

```
public abstract class Module
{
    internal int ID;

    public class APIWrapper
    {
        Module module;

        public APIWrapper(Module module)
        {
            this.module = module;
        }

        public void method1() { apiimpl.method1(this.module); }
        public int method2() { return apiimpl.method2(this.module); }
    }

    public readonly APIWrapper API;

    public Module()
    {
        ID = generate_module_identity();
        API = new APIWrapper(this);
    }

    public abstract void ModuleStart();
}

internal static class apiimpl
{
    public static void method1(Module module) { ... }
    public static int method2(Module module) { ... }
} 
```

然后其他开发人员可以这样使用它：

```
class MyModule : Module
{
    public override void ModuleStart()
    {
        API.method1();
    }
} 
```

`Module`这封装了您的 DLL 公开的方法，而不会对类层次结构的符号空间造成太多污染。

[意见类型=“我的”价值=“YMMV”]

但是，我建议您认真重新考虑使用这种类型的抽象。如果您正在调用的方法需要有关正在调用它们的特定实例的一些信息`Module`，则应在方法的参数中明确说明。鼓励您的团队遵循导致清晰的指导方针可能比找到抽象出小细节的方法更重要。

[/观点]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T00:45:59.157

如果您真正想要的只是`ID`在运行时检索 ，而不将任何参数传递给`function1`，则可以使用继承的方法：

```
public abstract class Module
{
    internal int ID;
    public abstract void ModuleStart();

    protected void function1()
    {
        System.Console.WriteLine ("function1 called from module {0}", this.ID);
    }
} 
```

然后，从您的其他模块中，调用`function1`看起来像这样简单：

```
class MyModule : Module
{
   public override void ModuleStart()
   {
      this.function1();    // the 'this.' is not required
   }
} 
```

但是，我从您的评论中了解到您希望将这些函数与您的`Module`类分开，因为您经常添加新函数。[您可以使用扩展方法](http://msdn.microsoft.com/en-us/library/bb311042.aspx)执行几乎完全相同的操作，以保持不传递任何参数的*外观：*

```
public abstract class Module
{
   internal int ID;
   public abstract void ModuleStart();
}

public static class ModuleExtensions
{
   public static void function1(this Module module)
   {
       innerFunction1(module.ID);
   }

   internal static void innerFunction1(int ID)
   {
        System.Console.WriteLine ("function1 called from module {0}", ID);
   }
} 
```

然后，从您的其他模块中，调用`function1`看起来像这样简单：

```
class MyModule : Module
{
   public override void ModuleStart()
   {
      this.function1();     // the 'this.' is required
   }
} 
```

# c++ - 引用动态分配的对象（“在运行时”）

> ID：14865481
> 
> 赞同：1
> 
> 时间：2013-02-13T23:50:56.713
> 
> 标签：c++, reference, initialization

本质上，我有很多代码是假设文件级静态是一个结构而编写的。所以所有的引用都像**struct.member**。

我不得不更改此代码并将其设为**静态结构 ***并在运行时分配此结构。

我想创建一个参考**struct& ref = *myStatic**因为我很懒，不想将 struct.member 的 TON 更改为struct- **>** **member**。

但是引用需要在声明时进行初始化（对吗？），我只知道我希望它在运行时引用什么。这可能吗？

*（以防它令人困惑..我使用 struct 代替我的实际结构名称，而不是作为文字 c++ struct 关键字）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:10:03.317

***“引用需要在声明时初始化（对吗？）”***

将初始化引用的对象必须在创建引用时存在 [1]，在这种情况下存在：

```
MyStruct* s = new MyStruct;
MyStruct& ref = *s; 
```

this 为 type 的对象动态分配内存`MyStruct`，然后构造此对象，最后创建`ref`对该对象的引用。只要您小心`s`. `s`一旦驻留的内存被释放，引用就会失效。

尽管决定是否使用引用不应该基于您是否懒得替换`.`为`->`.

* * *

[1] C++03 标准**8.3.2 §4**：*“应初始化引用以引用有效的对象或函数。”*

# c++ - 在 C++ 中将单个字符串元素转换为其十进制等价物

> ID：14865486
> 
> 赞同：0
> 
> 时间：2013-02-13T23:51:37.810
> 
> 标签：c++, string, decimal, ascii

我有一个字符串`str ( "1 + 2 = 3" )`。我想以十进制值（不是 ASCII ）获取字符串的各个数字。我试过`atoi`和`c_str()`. 但它们都要求整个字符串只包含数字。我正在用 C++ 编写我的代码。

任何帮助都会很棒。

我的挑战是评估前缀表达式。我正在从每行包含一个前缀表达式的文件中读取。我用于标记和存储变量的代码片段如下所示。文件的每一行都包含数字和运算符（`+`, `-`, `*`），它们之间用空格分隔。

前任 -`line = ( * + 2 3 4);`

```
 ifstream file;
    string line;

    file.open(argv[1]);
    while(!file.eof())
    {
            getline(file,line);
            if(line.length()==0)
                    continue;
            else
            {
                    vector<int> vec;
                    string delimiters = " ";
                    size_t current;
                    size_t next = -1;
                    do
                    {
                            current = next + 1;
                            next = line.find_first_of( delimiters, current );
                            if((line[next] <=57)&&(line[next] >=48))
                                   vec.push_back(atoi((line.substr( current, next - current )).c_str()));
                    }while (next != string::npos);
                    cout << vec[0] << endl;
            }
    }
    file.close(); 
```

在这种情况下`vec[0]`打印`50`not `2`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T23:59:03.923

您需要学习分隔字符串。您的分隔字符将是数学运算符（即：

[C：从分隔的源字符串创建字符串数组](https://stackoverflow.com/questions/2170319/c-creating-array-of-strings-from-delimited-source-string)

[http://www.gnu.org/software/libc/manual/html_node/Finding-Tokens-in-a-String.html](http://www.gnu.org/software/libc/manual/html_node/Finding-Tokens-in-a-String.html)

对于第二个链接，您可以执行以下操作：

```
const char delimiters[] = "+-="; 
```

有了这些知识，您可以创建一个字符串数组，并在每个字符串上调用 atoi() 以获取等效的数字。然后您可以使用每个分隔符的地址（数组索引）来确定存在哪个运算符。

对于像加法和减法这样的事情，这将非常简单。如果你想要运算顺序和乘法、括号等，你的流程逻辑会更复杂。

有关更深入的示例，请参阅此最终链接。一个简单的 C 命令行计算器。这应该让它一清二楚。

[http://stevehanov.ca/blog/index.php?id=26](http://stevehanov.ca/blog/index.php?id=26)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T03:40:02.177

[不要`fin.eof()`用来控制循环](https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong)。该功能仅在读取失败后才有用。

[有多种方法可以`int`从 a 中获取 s`std::string`](https://stackoverflow.com/questions/5577874/is-there-a-stl-or-boost-function-to-determine-if-a-string-is-numeric) ，在这种情况下，我[**`std::stoi()`**](http://en.cppreference.com/w/cpp/string/basic_string/stol)从 C++11 标准中进行选择。

```
#include <fstream>
#include <iostream>
#include <iterator>
#include <sstream>
#include <string>
#include <vector>

typedef std::vector<int> ints;

bool is_known_operator(std::string const& token)
{
    static char const* tokens[] = {"*", "/", "+", "-"};
    return std::find(std::begin(tokens), std::end(tokens), token) != std::end(tokens);
}

ints tokenise(std::string const& line)
{
    ints vec;
    std::string token;
    std::istringstream iss(line);

    while (iss >> token)
    {
        if (is_known_operator(token))
        {
            std::cout << "Handle operator [" << token << "]" << std::endl;
        }
        else
        {
            try
            {
                auto number = std::stoi(token);
                vec.push_back(number);
            }
            catch (const std::invalid_argument&)
            {
                std::cerr << "Unexpected item in the bagging area ["
                    << token << "]" << std::endl;
            }
        }
    }
    return vec;
}

int main(int, const char *argv[])
{
    std::ifstream file(argv[1]);
    std::string line;
    ints vec;

    while (std::getline(file, line))
    {
        vec = tokenise(line);
    }

    std::cout << "The following " << vec.size() << " numbers were read:\n";
    std::copy(vec.begin(), vec.end(), std::ostream_iterator<int>(std::cout, "\n"));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T01:11:38.887

你不会落入你的`if`，因为你的下一个位置将在一个分隔符。

```
 string delimiters = " ";
                ...
                        next = line.find_first_of( delimiters, current );
                        if((line[next] <=57)&&(line[next] >=48))
                        ... 
```

由于您的`delimiters`组成`" "`, then`line[next]`将是一个空格字符。

根据您的问题描述，您缺少可以节省操作员的代码。没有代码可以尝试查找运算符。

您不必假设 ASCII 来测试数字。您可以使用`is_digit()`例如，也可以与`'9'`and进行比较`'0'`。

当你打印你的向量元素时，你可能会不恰当地访问向量，因为可能没有任何项目被插入到数组中。

# python - 如何在Python中检查图形的两个顶点之间是否存在边？

> ID：14865491
> 
> 赞同：0
> 
> 时间：2013-02-13T23:51:52.767
> 
> 标签：python, graph

我有一个简单的图，想要创建一个方法“get_edge”，它将两个顶点作为参数，如果存在则返回它们之间的边，否则返回 None。这是我尝试过的一个片段。它不起作用，因为它当前创建一个对象，而不是检查是否已经存在一个对象。编写 get_edge() 的最简单方法是什么？

> ```
> def add_edge(self, e):
>     """Adds and edge to the graph by adding an entry in both directions.
> 
>     If there is already an edge connecting these Vertices, the
>     new edge replaces it.
>     """
>     v, w = e
>     self[v][w] = e
>     self[w][v] = e
> 
> def get_edge(self, v1, v2):
>     try:
>         Edge(v1, v2)
>         print 'Edge exists'
>     except:
>         print 'Edge does not exist'
>         return None 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:01:39.183

我怀疑你想要类似的东西：

```
def get_edge(self, v1, v2):
    try:
        e = self[v1][v2] # order shouldn't matter
        print("edge exists")
        return e
    except KeyError:
        print("edge does not exist")
        return None 
```

我假设您的类派生自`dict`或具有有效的方法，并且如果您要求不存在的密钥，`__getitem__`则会引发 a 。`KeyError`如果您不需要这些`print`语句（也就是说，它们只是用于调试），您可以取消`e`变量并直接返回结果。

# php - 通过 PHP LDAP 在 Active Directory 中管理/设置权限

> ID：14865493
> 
> 赞同：0
> 
> 时间：2013-02-13T23:52:05.350
> 
> 标签：php, permissions, active-directory, ldap

在我的 PHP LDAP 代码中，我能够进入并创建 OU（组织单位）、组以及 Active Directory 中的用户。我什至可以进去并将用户添加到组中。

现在，我需要为特定的 OU 设置安全权限，以允许其他组具有某些权限，例如：读取成员和写入成员。在 Active Directory 中，这是通过右键单击 OU -> 属性 -> 安全 -> 高级，然后添加具有所需权限的特定组来完成的。

这样做的目的是允许与特定组关联的用户有权在 OU 中添加新用户、将用户添加到组等。基本上代表域/服务器管理员管理 OU。换句话说，当我作为“Admin”组成员的用户登录时，如何允许该用户将用户添加到此 OU 而不会出现“访问不足”错误？

我添加 OU 的代码是这样的：

```
$dn = "OU=Groups,OU=TEST1,OU=Clients,DC=EQC,DC=local";
$entry["objectclass"][0] = "top";
$entry["objectclass"][1] = "organizationalUnit";
$entry["OU"] = "Groups";

if( ldap_add($con,$dn, $entry) !== false) {
    echo 'Awesome Sauce! The OU was added.';
} else {
    echo ldap_error($con);
} 
```

如何管理/设置允许上述功能所需的权限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T14:34:59.910

看起来这对 PHP 来说是不可能的。但是，我们能够创建一个 shell 脚本来运行并检查 Active Directory 是否有新的安全组，然后更新委派权限。

# php - 解析 RSS - 但遵循其中的链接，从链接页面获取图像

> ID：14865494
> 
> 赞同：0
> 
> 时间：2013-02-13T23:52:46.323
> 
> 标签：php, parsing, rss

我正在学习 RSS 解析——事实上我对它很陌生。我想知道在 php 中接收 RSS 提要的概念。但随后使用该项目的 RSS 链接转到新页面，然后解析该页面以查找与其关联的图像（假设图像编号不同，但后续页面上的 html 没有）

这样的事情可能吗？没关系，我不要求您提供细节/为我做这件事。只是对这个概念进行一些简短的教育。

比如说这个网站： [http ://www.bulettings.com/](http://www.bulettings.com/)

它有一个 RSS 源： [http ://www.bulettings.com/propertyrss](http://www.bulettings.com/propertyrss)

对每个项目说：

```
<item>
<title>
House Let @ &#163;2,400 per month, Chatsworth Rd, Charminster, BH8
</title>
<link>
http://www.bulettings.com/property/chatsworth-rd-charminster-bh8/buni-000690/1
</link>
<description>
<a href="http://www.bulettings.com/property/chatsworth-rd-charminster-bh8/buni-000690/1"><img src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5lor.jpg" width="150" alt="" align="left" border="0" /></a>STUDENT HOUSE - Large modernised seven bedroom House in Charminster with partial double glazing. Also has garden off road parking and bike storage.
</description>
<guid isPermaLink="true">
http://www.bulettings.com/property/chatsworth-rd-charminster-bh8/buni-000690/1
</guid>
<pubDate>Mon, 04 Feb 2013 14:02:13 GMT</pubDate>
<enclosure length="29" url="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5lor.jpg" type="image/jpg"/>
</item> 
```

我得到了这些信息，但随后我说“转到”，这会将我带到一个页面，其中来源是：

```
<script type="text/javascript">
    if(document.images){ 
 currentphoto=1; 
 maxphotos=7; 
    photo = new Array(7); 
    Imagetext = new Array(7); 
photo[1]=new Image();
photo[1].src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5lor.jpg";
Imagetext[1] ="Photo 1";
photo[2]=new Image();
photo[2].src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5svv.jpg";
Imagetext[2] ="Photo 2";
photo[3]=new Image();
photo[3].src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5j86.jpg";
Imagetext[3] ="Photo 3";
photo[4]=new Image();
photo[4].src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5vc2.jpg";
Imagetext[4] ="Photo 4";
photo[5]=new Image();
photo[5].src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3pd0xwvp9.jpg";
Imagetext[5] ="Photo 5";
photo[6]=new Image();
photo[6].src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5gq9.jpg";
Imagetext[6] ="Photo 6";
photo[7]=new Image();
photo[7].src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5qhr.jpg";
Imagetext[7] ="Photo 7";
photo[8]=new Image();
photo[8].src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3mr0yds1e.jpg";
Imagetext[8] ="Photo 8";

 }
</script> 
```

或者在页面下方：

```
<ul>

<li><img src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5lor.jpg" width="1024" height="768" onmouseover="document.images['photoview'].src = this.src;" alt="Photo 4" title="Photo 4"/></li>
<li><img src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5svv.jpg" width="1024" height="768" onmouseover="document.images['photoview'].src = this.src;" alt="Photo 7" title="Photo 7"/></li>
<li><img src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5j86.jpg" width="1024" height="768" onmouseover="document.images['photoview'].src = this.src;" alt="Photo 3" title="Photo 3"/></li>
<li><img src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5vc2.jpg" width="1024" height="768" onmouseover="document.images['photoview'].src = this.src;" alt="Photo 8" title="Photo 8"/></li>
<li><img src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3pd0xwvp9.jpg" width="1024" height="768" onmouseover="document.images['photoview'].src = this.src;" alt="Photo 2" title="Photo 2"/></li>
<li><img src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5gq9.jpg" width="1024" height="768" onmouseover="document.images['photoview'].src = this.src;" alt="Photo 2" title="Photo 2"/></li>
<li><img src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3nm0z5qhr.jpg" width="1024" height="768" onmouseover="document.images['photoview'].src = this.src;" alt="Photo 6" title="Photo 6"/></li>
<li><img src="http://www.estateagentslive.net/pchomesdata/BOURNEMOUTHUNI/PHOTOS/buni-000690-p-w-3mr0yds1e.jpg" width="1024" height="768" onmouseover="document.images['photoview'].src = this.src;" alt="Photo 1" title="Photo 1"/></li>
</ul> 
```

因此，它会从 rss 中获取该信息以及有关它的信息，将其放在某个地方并删除所有垃圾，然后将其与图像链接一起保留。然后继续下一个项目。

可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:13:16.590

我会使用 simplepie 将提要分成可访问的部分。它非常易于使用。

[get_enclosure](http://simplepie.org/api/class-SimplePie_Enclosure.html)可能是您想要关注的内容。

[这是一个“入门”示例](http://simplepie.org/wiki/tutorial/how_to_display_a_single_feed_item)，展示了它的易用性。

# javascript - 在表格上调整窗口大小

> ID：14865499
> 
> 赞同：0
> 
> 时间：2013-02-13T23:53:21.653
> 
> 标签：javascript, jquery, css

我目前正在处理自定义日历，我非常喜欢谷歌日历调整大小以更好地适应当前屏幕尺寸的方式，我查看了谷歌但似乎无法找到他们是如何做到的。他们是调整整个页面的大小还是只调整表格 div 的大小？有没有办法用纯CSS来实现这一点？我的印象是，您可以使用 javascript 和/或 jquery 计算分辨率并从中重做 css，但如果可以使用良好的旧 css，那就更好了。这不是其中之一。GIIME TE CODES 帖子。但是对这个功能背后的机制的一个很好的解释将比我相信的更多的好处，荣誉:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:59:23.433

对我来说，纯 CSS 是实现这一目标的最简单方法。您应该查看[媒体查询](http://css-tricks.com/css-media-queries/)和流畅的页面布局。这些用于[响应式网页设计](http://coding.smashingmagazine.com/2011/01/12/guidelines-for-responsive-web-design/)，以根据浏览器窗口的大小更改页面布局。

据我所见，谷歌日历只是改变了日历每一列的宽度，所以一点也不难。

在我看来，您可以使用媒体查询和流畅的布局来实现这一点，甚至可能比谷歌取得的结果更好，因为当您的窗口尺寸非常小时，谷歌日历就不能很好地工作！

希望这会有所帮助:)

# javascript - JS平均计算器

> ID：14865500
> 
> 赞同：0
> 
> 时间：2013-02-13T23:53:37.153
> 
> 标签：javascript, css, calculator

我不能让一切都集中。这就是我得到的：

```
xxx    xxx    xxx   xxx   xxx 
```

我想要的是

```
 xxx  
xxx  
xxx  
xxx  
xxx 
```

在网页中水平居中

我也无法让普通功能正常工作。我不知道我哪里出错了。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Average Calculator</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<h1 style="text-align:center;">My Average Calculator</h1>
<script type="text/javascript">
function getTotal() {
var form = document.getElementById('number');
var numb1 = parseInt(form.numb1.value);
var numb2 = parseInt(form.numb2.value);
var numb3 = parseInt(form.numb3.value);
var numb4 = parseInt(form.numb4.value);
var numb5 = parseInt(form.numb5.value);
var total = document.getElementById('total');
var average = document.getElementById('average');
if (!numb1) {
    numb1 = 0;
}

if (!numb2) {
    numb2 = 0;
}

if (!numb3) {
    numb3 = 0;
}

if (!numb4) {
    numb4 = 0;
}
if (!numb5) {
    numb5 = 0;
}

total.innerHTML = 'Total: ' + (numb1 + numb2 + numb3 + numb4 + numb5);
average.innerHTML = 'Average: ' + (total / 5);
}
</script>
</head>
<form id="number">   
<body>
First Number: <input type="text" name="numb1" onkeyup="getTotal ();" />
Second Number: <input type="text" name="numb2" onkeyup="getTotal();" />
Third Number:  <input type="text" name="numb3" onkeyup="getTotal();" />
Fourth Number: <input type="text" name="numb4" onkeyup="getTotal();" />
Fifth Number:  <input type="text" name="numb5" onkeyup="getTotal();" />
    <div id="total">Total:     </div>
    <div id="average">Average: </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:01:30.383

`total / 5`，`total`您通过 ID 获取的元素在哪里。难怪它不起作用；）

此外，您可能想了解循环。而不是`numb1`通过`numb5`，迭代。

像这样的东西可以很好地工作：

```
<fieldset id="numbers"><legend>Numbers</legend>
    First number: <input type="number" onkeyup="getTotal();" onchange="getTotal();" /><br />
    Second number: <input type="number" onkeyup="getTotal();" onchange="getTotal();" /><br />
    Third number: <input type="number" onkeyup="getTotal();" onchange="getTotal();" /><br />
    Fourth number: <input type="number" onkeyup="getTotal();" onchange="getTotal();" /><br />
    Fifth number: <input type="number" onkeyup="getTotal();" onchange="getTotal();" />
</fieldset>
<div id="total">Total: --</div>
<div id="average">Average: --</div>
<script type="text/javascript">
    function getTotal() {
        var inputs = document.getElementById('numbers').getElementsByTagName('input'),
            count = inputs.length, i, total = 0;
        for( i=0; i<count; i++) total += parseInt(inputs[i].value || "0",10);
        document.getElementById('total').firstChild.nodeValue = "Total: "+total;
        document.getElementById('average').firstChild.nodeValue = "Average: "+(total/count);
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:06:01.510

`<br/>`在每个输入标签的末尾添加 BR 标签并更改它

```
average.innerHTML = 'Average: ' + ((numb1 + numb2 + numb3 + numb4 + numb5) / 5); 
```

# cuda - CUDA 共享内存写入会导致无法解释的长延迟

> ID：14865501
> 
> 赞同：2
> 
> 时间：2013-02-13T23:53:39.097
> 
> 标签：cuda, shared-memory

这一直让我发疯。我有一个 1D 块的 3D 网格。每个块包含 272 个线程。每个线程对两个向量进行点积，并将其结果存储在**共享**内存数组中的相应位置，该数组大小为 [272]，线程数相同。主线程正在调用多个内核，我正在加起来执行它们所花费的时间。当我注释掉写入共享内存的行时，我得到大约 2,401 毫秒的执行时间。当我取消注释共享内存写入行时，我得到了非常长的时间，比如 450,309 毫秒。我尝试使用 int 值而不是双精度值。我还尝试使用 if(threadIdx.x ==0) 语句只让一个线程进行写入，以避免可能的银行冲突。似乎没有任何效果。这是调用线程代码：

```
 double theta=0;
int count=0;
cudaEventRecord(start,0);
while(theta <180)
{
theta+=0.18;

calc_LF<<<gridDim, blockDim>>>(ori_dev, X_dev, Y_dev, Z_dev, F_dev, F_grad_dev, g_oriD, r_vD, LF);
calc_S<<<gridDim, 272>>>(g_traD, LF, Ci, C);
count++;
}
cudaEventRecord( stop, 0 );
cudaEventSynchronize( stop );
cudaEventElapsedTime( &elapsedTime, start, stop );
err = cudaGetLastError();
if ( cudaSuccess != err )
    {
    fprintf( stderr, "Cuda error in file '%s' in line %i : %s.\n",
         __FILE__, __LINE__, cudaGetErrorString( err) );
    }
else
    {
    fprintf( stderr, "\n \n Cuda NO error in file '%s' in line %i : %s.\n",
         __FILE__, __LINE__, cudaGetErrorString( err) );
    printf("\n %d orientation updates: Total Time = %3.10f ms\n", count, elapsedTime);
    } 
```

有问题的内核是 calc_S 内核，其代码是：

```
__global__ void calc_S(double* g_traD, double* LF, double* Ci, double* C)
{

__shared__ double G[H];
int myTRA[W];
int tx= threadIdx.x;

for(int j=0; j<W; j++)
{
    myTRA[j]= getElement(g_traD, tx, j, W);
}
double sum;
for(int j=0; j<W; j++)
{
     sum += myTRA[j] * LF[j];
}       

// Write your sum to shared memory
    G[threadIdx.x]=sum;
     //__syncthreads();
} 
```

我正在使用带有 CUDA 4.2 的 MS Visual Studio 2008 和计算能力为 2.0 的 GPU（即 GeForce GTX 580）。注意：每个块 272 个线程。硬件线程限制：1,536 / 272 = 最多 5 个块 共享内存限制：双精度的 G[272] = 需要 2,176 个字节。48K / 2176= 最多 22 个块（这永远不会发生，但我们知道共享内存没有限制）寄存器根本不是问题。所以，应该是可以同时执行5个block。

谢谢你的帮助。

麦

编辑：

这是整个代码的缩短版本。整个代码可以在 MatrixMul Nvidia SDK 示例中运行。

在文件“MatrixMul.cu”中

```
 int main(int argc, char** argv)
    {
    // reading data from Matlab into double arrays
    //CUDA begins here:
if(shrCheckCmdLineFlag(argc, (const char**)argv, "device"))
    {
      cutilDeviceInit(argc, argv);
     }
   else
   {
     cutilSafeCall( cudaSetDevice(cutGetMaxGflopsDeviceId()) );
   }
  int devID;
  cudaDeviceProp props;

// get GPU props
cutilSafeCall(cudaGetDevice(&devID));
cutilSafeCall(cudaGetDeviceProperties(&props, devID));

printf("Device %d: \"%s\" with Compute %d.%d capability\n", devID, props.name, props.major, props.minor);

//Declare Device memory for matrices read from Matlab
 double *X_dev;    // size 19 x 1
 double *Y_dev;    // size 19 x 1
 double *Z_dev;    // size 17 x 1
 double *r_vD;     // size 544 x 3
 double *g_oriD;   // size 544 x 3
 double *g_traD;   // size 272 x 544
 double *cov_D;    // size 272 x 272
 double *cov_i_D;  // size 272 x 272

err= cudaMalloc((void**)&X_dev, sizeX*sizeof(double));
errorCheck(err);

err= cudaMalloc((void**)&Y_dev, sizeY*sizeof(double));
errorCheck(err);

err= cudaMalloc((void**)&Z_dev, sizeZ*sizeof(double));
errorCheck(err);

err= cudaMalloc((void**)&r_vD, sizeR_V*sizeof(double));
errorCheck(err);

err= cudaMalloc((void**)&g_oriD, sizeG_ori*sizeof(double));
errorCheck(err);

err= cudaMalloc((void**)&g_traD, sizeG_tra*sizeof(double));
errorCheck(err);

err= cudaMalloc((void**)&cov_D, sizeCov*sizeof(double));
errorCheck(err); 

err= cudaMalloc((void**)&cov_i_D, sizeCov_i*sizeof(double));
errorCheck(err); 

   //Transfer Xs, Ys, and Zs to GPU Global memory
cudaMemcpy(X_dev,dipole_x_coords, sizeX*sizeof(double), cudaMemcpyHostToDevice);
errorCheck(err);

cudaMemcpy(Y_dev,dipole_y_coords, sizeY*sizeof(double), cudaMemcpyHostToDevice);
errorCheck(err);

cudaMemcpy(Z_dev,dipole_z_coords, sizeZ*sizeof(double), cudaMemcpyHostToDevice);
errorCheck(err);

    // Transfer r_v, g_ori, and g_tra to GPU memory
cudaMemcpy(r_vD, r_v, sizeR_V*sizeof(double), cudaMemcpyHostToDevice);
errorCheck(err);

cudaMemcpy(g_oriD,g_ori, sizeG_ori*sizeof(double), cudaMemcpyHostToDevice);
errorCheck(err);

cudaMemcpy(g_traD,g_tra, sizeG_tra*sizeof(double), cudaMemcpyHostToDevice);
    errorCheck(err);

    // Transfer cov, and cov_i to GPU memory
cudaMemcpy(cov_D, cov_post, sizeCov*sizeof(double), cudaMemcpyHostToDevice);
errorCheck(err);

cudaMemcpy(cov_i_D,cov_post_i, sizeCov_i*sizeof(double), cudaMemcpyHostToDevice);
  //Specify dimensions of block and grid
dim3 gridDim(sizeX, sizeY, sizeZ);   // 19 x 19 x 17
int numThreads=(int) sizeR_V/3;      // numThreads = 544
dim3 blockDim(numThreads,1,1);       // 544 x 1 x 1 

//call Cuda wrapper
float cf = runB(X_dev, Y_dev, Z_dev, r_vD, g_oriD, g_traD, cov_i_D, cov_D, blockDim, gridDim, sizeG_tra, tra_W, tra_H);

int c=0;
scanf("%d", c);
return 0;

}

    float runB(double* X_dev, double* Y_dev, double* Z_dev, 
double* r_vD, double* g_oriD, double* g_traD, double* Ci, double* C,
dim3 blockDim, dim3 gridDim, int sizeG_tra, int tra_W, int tra_H)
    {  
   cudaError err;

   // Calculate the size of thread output in global memory
   size_t size_F = gridDim.x * gridDim.y * gridDim.z * blockDim.x;
   size_t size_F_grad = gridDim.x * gridDim.y * gridDim.z * blockDim.x * 3;

   // Make global memory space for F and F_grad 
double* F_dev;
double* F_grad_dev;
err= cudaMalloc((void**)&F_dev, size_F*sizeof(double));
errorCheck(err); 
err= cudaMalloc((void**)&F_grad_dev, size_F_grad*sizeof(double));
errorCheck(err); 

    //Allocate Device memory for LF 
double *LF;
err= cudaMalloc((void**)&LF, 544*sizeof(double));
errorCheck(err); 

    cudaEvent_t start, stop;
    float elapsedTime;

    cudaEventCreate(&start);
    cudaEventCreate(&stop);

double theta=0;
cudaEventRecord(start,0);
while(theta <180)
{
theta+=0.18;
calc_LF<<<gridDim, blockDim>>>(ori_dev, X_dev, Y_dev, Z_dev, F_dev, F_grad_dev, g_oriD, r_vD, LF);
   calc_S<<<gridDim, 272>>>(g_traD, LF, Ci, C);
   count++;
   }
   cudaEventRecord( stop, 0 );
   cudaEventSynchronize( stop );
cudaEventElapsedTime( &elapsedTime, start, stop );
err = cudaGetLastError();
if ( cudaSuccess != err )
    {
    fprintf( stderr, "Cuda error in file '%s' in line %i : %s.\n",
         __FILE__, __LINE__, cudaGetErrorString( err) );
    }
else
    {
    fprintf( stderr, "\n \n Cuda NO error in file '%s' in line %i : %s.\n",
         __FILE__, __LINE__, cudaGetErrorString( err) );
    printf("\n 180 orientation updates: Total Time = %3.10f ms\n",elapsedTime);
    }
     return 0;

   } 
```

在文件“MatrixMul_kernel.cu”中

```
 #define HDM_DIM 3 
      __global__ void calc_LF(double* ori_dev, double* X_dev, double* Y_dev, double* Z_dev, double* F_dev, double* F_grad_dev, 
                    double* g_oriD, double* r_vD, double* LF)
        { 
        // Get this block's global index 
     int blockId= blockIdx.x + gridDim.x*blockIdx.y + gridDim.x*gridDim.y*blockIdx.z;
     int tx= threadIdx.x;
    // This thread's global index
     int gtx= blockId*blockDim.x + threadIdx.x;
    double r_v[3];
    double g_ori[3];

// Each thread reads 1 row (3 values) of r_vD 
    r_v[0] = getElement(r_vD, tx, 0, HDM_DIM);
    r_v[1] = getElement(r_vD, tx, 1, HDM_DIM);
    r_v[2] = getElement(r_vD, tx, 2, HDM_DIM);
// Each thread reads 1 row (3 values) of g_oriD (which contains grad.ori data)
    g_ori[0] = getElement(g_oriD, tx, 0, HDM_DIM);
    g_ori[1] = getElement(g_oriD, tx, 1, HDM_DIM);
    g_ori[2] = getElement(g_oriD, tx, 2, HDM_DIM);

    //fetch d_ori from global memory
    double d_ori[3];
    for(int i=0; i< 3; i++){
       d_ori[i]= ori_dev[3*gtx+i];
    }   
   //read this block's X, Y, Z location
    double x= X_dev[blockIdx.x];
    double y= Y_dev[blockIdx.y];
    double z= Z_dev[blockIdx.z];     

    double c2[HDM_DIM];
    c2[0]= d_ori[1]*z - d_ori[2]*y;
    c2[1]= d_ori[2]*x - d_ori[0]*z;
    c2[2]= d_ori[0]*y - d_ori[1]*x;

    // Fetch F and F_grad from global memory
    double F = F_dev[gtx];
    double F_grad[3];
    for(int j=0; j<3; j++)
    {
        F_grad[j] = F_grad_dev[gtx*3+j];
    }

    double c1[HDM_DIM];
    c1[0]= F* c2[0];
    c1[1]= F* c2[1];
    c1[2]= F* c2[2];

    double d3= c2[0]*r_v[0] + c2[1]*r_v[1] + c2[2]*r_v[2];

    double s2[HDM_DIM];
    for(int j=0; j<HDM_DIM; j++)
    {
        s2[j] = d3*F_grad[j];
    }

    double s1[HDM_DIM];
    for(int j=0; j<HDM_DIM; j++)
    {
        s1[j] = c1[j] - s2[j];
    }

    double b_v[HDM_DIM];
    for(int j=0; j<HDM_DIM; j++)
    {
        b_v[j] = (10^-7)/(F*F) * s1[j]; 
    }   

    double sum=0;
    for(int j=0; j<HDM_DIM; j++)
    {
        sum += b_v[j]*g_ori[j];
    }   

// Write this thread's value to global memory
    LF[tx]= sum;

     } 
```

值得一提的是，这个 calc_LF 内核用于将其最终结果写入共享内存，这将执行时间从大约 500+ ms 增加到大约 2,500 ms（即仅共享内存写入行大约将时间乘以 5）。

```
 __global__ void calc_S(double* g_traD, double* LF, double* Ci, double* C)
{
__shared__ double T[H];
__shared__ double G[H];

   // Get this block's global index 
  int blockId= blockIdx.x + gridDim.x*blockIdx.y + gridDim.x*gridDim.y*blockIdx.z;
  int tx= threadIdx.x;
// This thread's global index
   int gtx= blockId*blockDim.x + threadIdx.x;

int myTRA[W];
double my_LF[W];
for (int i=0; i<W; i++){
   my_LF[i]= LF[gtx];
}

for(int j=0; j<W; j++){
    myTRA[j]= getElement(g_traD, tx, j, W);
        }
    double sum;
    for(int j=0; j<W; j++)
    {
         sum += myTRA[j] * my_LF[j];
    }       

// Write your sum to shared memory
    G[tx]=sum;
    __syncthreads();
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T06:51:19.437

您看到的效果是编译器优化的结果。获取基本内核代码的可编译版本：

```
#define H (128)
#define W (128)

__device__
double getElement(const double *g, int t, int j, int w)
{
    return g[t + j*w];
}

__global__ 
void calc_S(double* g_traD, double* LF, double* Ci, double* C)
{
    __shared__ double G[H];

    // Get this block's global index 
    int blockId= blockIdx.x + gridDim.x*blockIdx.y + 
                   gridDim.x*gridDim.y*blockIdx.z;
    int tx= threadIdx.x;
    // This thread's global index
    int gtx= blockId*blockDim.x + threadIdx.x;

    int myTRA[W];
    double my_LF[W];
    for (int i=0; i<W; i++){
        my_LF[i]= LF[gtx];
    }

    for(int j=0; j<W; j++){
        myTRA[j]= getElement(g_traD, tx, j, W);
    }
    double sum;
    for(int j=0; j<W; j++)
    {
        sum += myTRA[j] * my_LF[j];
    }       

    // Write your sum to shared memory
    G[tx]=sum;
    __syncthreads();
} 
```

并用 CUDA 5 编译它给出了这个：

```
$ nvcc -m64 -arch=sm_20 -cubin -Xptxas="-v"  dead_code.cu 
dead_code.cu(13): warning: variable "G" was set but never used

dead_code.cu(13): warning: variable "G" was set but never used

ptxas info    : 0 bytes gmem
ptxas info    : Compiling entry function '_Z6calc_SPdS_S_S_' for 'sm_20'
ptxas info    : Function properties for _Z6calc_SPdS_S_S_
    1536 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 23 registers, 1024 bytes smem, 64 bytes cmem[0] 
```

有一个关于共享内存变量`G`没有被使用的警告，但编译器尊重它并发出消耗 23 个寄存器的代码。所以现在，如果我注释掉`G[tx]=sum`内核末尾的 ，它会像这样编译：

```
$ nvcc -m64 -arch=sm_20 -cubin -Xptxas="-v"  dead_code.cu 
dead_code.cu(13): warning: variable "G" was declared but never referenced

dead_code.cu(13): warning: variable "G" was declared but never referenced

ptxas info    : 0 bytes gmem
ptxas info    : Compiling entry function '_Z6calc_SPdS_S_S_' for 'sm_20'
ptxas info    : Function properties for _Z6calc_SPdS_S_S_
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 2 registers, 64 bytes cmem[0] 
```

现在只使用了两个寄存器，工具链发出了这个：

```
$ cuobjdump -sass dead_code.cubin 

    code for sm_20
        Function : _Z6calc_SPdS_S_S_
    /*0000*/     /*0x00005de428004404*/     MOV R1, c [0x1] [0x100];
    /*0008*/     /*0xfc1fdc03207e0000*/     IMAD.U32.U32 RZ, R1, RZ, RZ;
    /*0010*/     /*0xffffdc0450ee0000*/     BAR.RED.POPC RZ, RZ;
    /*0018*/     /*0x00001de780000000*/     EXIT; 
```

IE。四个组装说明。你所有的代码都不见了。

这种影响的根本来源是编译器死代码删除。编译器足够聪明，可以确定对全局或共享内存输出没有影响的代码是不需要的并且可以删除。在这种情况下，一个写入`G`被删除，整个内核实际上是没有意义的，编译器只是优化了整个事情。[您可以在此处](https://stackoverflow.com/a/14659837/681865)和[此处](https://stackoverflow.com/q/10494326/681865)查看其他一些死代码删除及其影响的示例。后者在 OpenCL 中，但同样的机制也适用。

# ruby - 在 Ruby Rake 任务中解析平面文本文件

> ID：14865502
> 
> 赞同：0
> 
> 时间：2013-02-13T23:53:42.573
> 
> 标签：ruby, ruby-on-rails-3, text

好的，我正在试一试。有大量的 SO 问题可以回答我的问题，但没有一个可以解决我的问题。

我正在创建一个 rake 任务来解析 RoR 中的平面文本文件。该文件有一个标题，但除了空格之外没有任何分隔符。所以我打算使用空格作为分隔符，但它不起作用。这是文本文件的示例：

姓名 生日 比尔 12/25/86 约翰·史密斯 1/1/87

如果我使用 ' ' 作为分隔符，我会得到第一个条目的正确结果，但不是第二个，因为日期之前有 2 个字符串，而不仅仅是一个。这是我一直在尝试的方法：

```
File.open(file, "r").each do |line|
  name, birthdate = line.strip.split("")
  user = User.new(user_name: name, birth_date: birthdate)
  user.save
end 
```

我不知道如何处理第一个“字段”可能是也可能不是一个词的事实。最终我宁愿要求 csv 然后我的问题就不存在了。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:01:27.420

如果可能的话，您可能想更改格式，但是使用您的两个示例，您可以执行以下操作

```
components = line.split(' ')
date = components.pop
name = components.join(' ') 
```

# java - Java：正确关闭多个线程

> ID：14865503
> 
> 赞同：0
> 
> 时间：2013-02-13T23:53:43.300
> 
> 标签：java, multithreading, sockets

我正在制作一个简单的服务器，它将产生多个线程来处理多个客户端。我想知道在服务器终止时关闭和关闭所有各种流和线程的正确方法。

我添加了一个shutdownHook，它运行一个告诉服务器关闭的方法。反过来，服务器将关闭调用广播到它已打开的所有线程，这将每个线程中的“isClosed”布尔值设置为 true。

我所期待的是，每个线程在到达 run() 方法的末尾并再次循环时，都会遇到 while(!isClosed) 条件，从而通过关闭所有正确的套接字/流并返回来正确终止自己。

但是，我不知道这是否会正确关闭所有内容，因为程序应该在 shutdownhook 完成后终止。它完成得相当早，因为它所做的只是传播结束消息。这是否意味着某些线程没有足够的时间正确关闭？

如果是这样，最好的方法是让shutdownhook手动关闭每个线程，确保它们已经关闭，然后再返回？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T04:33:39.923

shutdownHook 在循环中发生得太晚，无法以这种方式使用。预计它会很快完成，并且 JVM 已经处于关闭状态，如果它们是守护进程，它可能会占用现有线程。

我只想在连接线程上设置一个读取超时，比如 15-30 秒。如果发生超时`(SocketTimeoutException)`，关闭套接字并退出线程。客户当然必须处理掉线的连接，但他们必须已经这样做了。然后，当您想关闭时，只需停止接受新连接（例如关闭`ServerSocket`并让其接受线程正确处理产生的异常）。当所有现有的连接线程都退出时，JVM 将退出，这实际上应该不会超过超时时间加上最长事务的长度。确保连接线程不是守护进程。

如果您不介意客户在交易过程中被砍掉，请致电`System.exit().`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:00:35.690

使用 an`ExecutorService`是现代的做法。它从代码中消除了很多繁琐的部分。

[这](https://stackoverflow.com/a/8358133/823393)是一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T00:04:07.653

您是正确的，如果服务器终止，线程可能没有足够的时间正确终止。但是，根据您要执行的操作，这可能是也可能不是问题。如果不需要清理工作，那么您可能不需要担心它，因为让线程突然终止不会导致任何问题。

但是，如果需要完成清理工作（例如写入数据库），那么您需要做一些其他的事情。最好的方法（在 Java 中）是使用 Executor/ExecutorService 和相关项目（[http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Executors.html](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Executors.html)）。这些可以很好地解决您的问题，另外您还可以获得一些不错的免费赠品，例如线程池管理，因此扩展更加容易。例如，如果您为每个客户端生成一个新线程，那么稍后尝试扩展时就会遇到大问题，因为您不能每分钟创建一百万个线程。

如果您习惯使用原始线程，则使用 E​​xecutor 的东西有点调整，但值得研究。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T12:29:32.820

你有没有考虑过让你的线程守护线程。只需添加 t.setdaemon(true); 在调用线程的 start 方法之前。如果这些线程应该在程序结束时结束，那么一旦所有其他非守护线程结束，使它们成为守护进程就会杀死它们。线程池中使用的线程是应该是守护进程的线程的好例子。我真的认为它对你有用。

# jquery - 使用 jQuery 添加新输入

> ID：14865504
> 
> 赞同：-2
> 
> 时间：2013-02-13T23:53:52.953
> 
> 标签：jquery

我的表单上有一个名为 roomfac1 的下拉菜单，我希望在用户单击“**添加**”按钮时添加*roomfac2*、*roomfac3 ...（重复的下拉菜单）。*如何使用 jQuery 完成此任务？除此之外，我还希望用户动态删除新创建的输入。

 **我在这里上传了我的代码：http: [//jsfiddle.net/ecRXP/2/](http://jsfiddle.net/ecRXP/2/)

```
<select name="roomFac1" id="roomFac1">
  <option selected="selected">Any</option>
</select>
<input type="button" value="Add" class="pmbtn" id="addFac"/>
<input type="button" value="Remove" class="pmbtn" id="removeFac"/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:14:10.567

```
$(document).ready(function(){
    $('#addFac').click(function(){
        var $objs = $('select[name*=roomFac]');
        var n = $objs.size() + 1;
        var $obj = $objs.first().clone();
        $obj.attr('name', 'roomFac'+n).attr('id', 'roomFac'+n);
        $obj.appendTo($('body'));
    });
    $('#removeFac').click(function(){
        var $objs = $('select[name*=roomFac]');
        if($objs.size() > 1){
           $objs.last().remove();
        }
    });
}); 
```

这是小提琴：http: [//jsfiddle.net/kfm5b/2/](http://jsfiddle.net/kfm5b/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:17:51.980

[jsFiddle 上的示例](http://jsfiddle.net/htmled/smefh/)。

HTML：

```
<form>
    <div class="add">
        <a href="#" id="add">Add</a>
    </div>
    <div class="row">
        <select name="roomFac1" id="roomFac1">
            <option selected="selected">Any</option>
        </select>
    </div>
</form> 
```

JS：

```
var $form = $("form"),
    $firstRow = $(".row:first"),
    totalRows;

$("form").on("click", ".delete", function (e) {
    e.preventDefault();

    $(this).closest("div").remove();
});

$("#add").on("click", function (e) {
    var $clonedRow = $firstRow.clone(),
        totalRows = "1",
        newNum;

    e.preventDefault();

    totalRows = $(".row").length;
    newNum = parseInt(totalRows, 10) + 1;

    $clonedRow.find("select").attr("name", "roomFac" + newNum);
    $clonedRow.find("select").attr("id", "roomFac" + newNum);
    $clonedRow.append('<a href="#" class="delete">Delete</a>');
    $form.append($clonedRow);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T00:31:16.970

我认为您可以`.clone`像这样使用：

```
var roomFacCount = 1;

$('#addFac').on('click', function() {
    var $lastRoomFac = $('#roomFac' + roomFacCount);
    roomFacCount++;
    $lastRoomFac.after($lastRoomFac.clone(true, true).attr('id', 'roomFac' + roomFacCount));
});

$('#removeFac').on('click', function() {
    if (roomFacCount > 1) {
        var $lastRoomFac = $('#roomFac' + roomFacCount);
        roomFacCount--;
        $lastRoomFac.remove();
    }
}); 
```

[jsfiddle 上的演示](http://jsfiddle.net/john_s/HGCSC/)**

# r - 如何在 R::lattice::layerplot 上显示投影地图？

> ID：14865507
> 
> 赞同：1
> 
> 时间：2013-02-13T23:54:26.260
> 
> 标签：r, plot, maps, lattice, netcdf

**摘要：**我可以在 a 上显示经纬度图`lattice::layerplot`，并且可以在 a 上显示 Lambert 保角圆锥 (LCC) 图`spam::image`。如何在 上显示 LCC 地图`lattice::layerplot`？如何不这样做的示例如下 - 修复方面的帮助表示赞赏（甚至只是调试）。

**细节：**

我一直在使用格子图形（通过`latticeExtra`和`rasterVis`）成功地显示未投影的经纬度全球大气数据，效果很好（尽管我肯定对`ggplot`/很感兴趣`ggmap`）。特别是，我可以用地图覆盖这些地块，这对于我正在做的工作来说是必不可少的。但是，我目前无法`lattice::layerplot`用于某些*区域*数据投影 LCC：数据绘图，但我无法获得要叠加的地图。我可以通过更粗略的方式做到这一点，但更愿意知道如何在`lattice/rasterVis`或类似的情况下做到这一点（例如，`ggplot/ggmap`）。下面是两个几乎独立的示例……但是如果您已经知道如何执行此操作，请告诉我，我将跳过调试。（我在一个项目上落后了。）

netCDF 数据 ,`ozone_lcc.nc`随[CRAN package=M3](http://cran.r-project.org/web/packages/M3/) ... 除了 M3 将其提供为

```
system.file("extdata/ozone_lcc.ncf", package="M3") 
```

并且该文件扩展名 ( `.ncf`) 当前会导致[CRAN package=raster](http://cran.r-project.org/web/packages/raster/)出现问题（请参阅[此帖子](https://stat.ethz.ch/pipermail/r-sig-geo/2013-February/017454.html)）。您可以重命名该文件（并将其放入某个当前工作目录），或者您可以[只下载该文件](https://bitbucket.org/tlroche/mozart-global-to-aqmeii-na/downloads/ozone_lcc.nc)(270 kB)，或者您可以从[M3 压缩包](http://cran.r-project.org/src/contrib/M3_0.3.tar.gz)中获取它（但请记住重命名它！）。

然后，您可以运行以下任何示例（前提是（IIRC）您没有运行 Windows，package=`M3`不会在其上构建（但 ICBW）），根据需要更改常量以适应您的系统。示例 1 生成了一个我知道（根据以前的经验）将与 a `raster`in a一起使用的类型的映射`levelplot`；但是，在这种情况下，地图和数据/栅格的坐标值不匹配。示例 2 使用旧式基本图形，实际上绘制了数据和地图；不幸的是，我不知道如何制作它在`levelplot`. 因为我想让这段代码与一堆使用`raster`and的其他代码一起工作，所以`levelplot`这是一个问题。

**示例 1：**产生类似的输出![这](../Images/8b6329b5205f0c273de84ee96fe21176.png)

```
##### start example 1 #####

library("M3")        # http://cran.r-project.org/web/packages/M3/
library("rasterVis") # http://cran.r-project.org/web/packages/rasterVis/

## Use an example file with projection=Lambert conformal conic.
# lcc.file <- system.file("extdata/ozone_lcc.ncf", package="M3")
lcc.file <- "./ozone_lcc.nc" # unfortunate problem with raster::raster
lcc.proj4 <- M3::get.proj.info.M3(lcc.file)
lcc.proj4   # debugging
# [1] "+proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +a=6370000 +b=6370000"
# Note +lat_0=40 +lat_1=33 +lat_2=45 for maps::map@projection (below)
lcc.crs <- sp::CRS(lcc.proj4)
lcc.pdf <- "./ozone_lcc.example1.pdf" # for output

## Read in variable with daily ozone.
# o3.raster <- raster::raster(x=lcc.file, varname="O3", crs=lcc.crs)
# ozone_lcc.nc has 4 timesteps, choose 1 at random
o3.raster <- raster::raster(x=lcc.file, varname="O3", crs=lcc.crs, level=1)
o3.raster@crs <- lcc.crs # why does the above assignment not take?
# start debugging
o3.raster
summary(coordinates(o3.raster)) # thanks, Felix Andrews!
M3::get.grid.info.M3(lcc.file)
#   end debugging

# > o3.raster
# class       : RasterLayer 
# band        : 1 
# dimensions  : 112, 148, 16576  (nrow, ncol, ncell)
# resolution  : 1, 1  (x, y)
# extent      : 0.5, 148.5, 0.5, 112.5  (xmin, xmax, ymin, ymax)
# coord. ref. : +proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +a=6370000 +b=6370000 
# data source : .../ozone_lcc.nc 
# names       : O3 
# z-value     : 1 
# zvar        : O3 
# level       : 1 
# > summary(coordinates(o3.raster))
#        x                y         
#  Min.   :  1.00   Min.   :  1.00  
#  1st Qu.: 37.75   1st Qu.: 28.75  
#  Median : 74.50   Median : 56.50  
#  Mean   : 74.50   Mean   : 56.50  
#  3rd Qu.:111.25   3rd Qu.: 84.25  
#  Max.   :148.00   Max.   :112.00  
# > M3::get.grid.info.M3(lcc.file)
# $x.orig
# [1] -2736000
# $y.orig
# [1] -2088000
# $x.cell.width
# [1] 36000
# $y.cell.width
# [1] 36000
# $hz.units
# [1] "m"
# $ncols
# [1] 148
# $nrows
# [1] 112
# $nlays
# [1] 1

# The grid (`coordinates(o3.raster)`) is integers, because this
# data is stored using the IOAPI convention. IOAPI makes the grid
# Cartesian by using an (approximately) equiareal projection (LCC)
# and abstracting grid positioning to metadata stored in netCDF
# global attributes. Some of this spatial metadata can be accessed
# by `M3::get.grid.info.M3` (above), and some can be accessed via
# the coordinate reference system (`CRS`, see `lcc.proj4` above)

## Get US state boundaries in projection units.
state.map <- maps::map(
  database="state", projection="lambert", par=c(33,45), plot=FALSE)
#                  parameters to lambert: ^^^^^^^^^^^^
#                  see mapproj::mapproject
state.map.shp <-
  maptools::map2SpatialLines(state.map, proj4string=lcc.crs)
# start debugging
# thanks, Felix Andrews!
class(state.map.shp)
summary(do.call("rbind",
  unlist(coordinates(state.map.shp), recursive=FALSE)))
#   end debugging

# > class(state.map.shp)
# [1] "SpatialLines"
# attr(,"package")
# [1] "sp"
# >     summary(do.call("rbind", 
# +       unlist(coordinates(state.map.shp), recursive=FALSE)))
#        V1                  V2         
#  Min.   :-0.234093   Min.   :-0.9169  
#  1st Qu.:-0.000333   1st Qu.:-0.8289  
#  Median : 0.080378   Median :-0.7660  
#  Mean   : 0.058492   Mean   :-0.7711  
#  3rd Qu.: 0.162993   3rd Qu.:-0.7116  
#  Max.   : 0.221294   Max.   :-0.6343  
# I can't see how to relate these coordinates to `coordinates(o3.raster)`

pdf(file=lcc.pdf)
rasterVis::levelplot(o3.raster, margin=FALSE
) + latticeExtra::layer(
  sp::sp.lines(state.map.shp, lwd=0.8, col='darkgray'))

dev.off()
# change this for viewing PDF on your system
system(sprintf("xpdf %s", lcc.pdf))
# data looks correct, map invisible

## Try again, with lambert(40,33)
state.map <- maps::map(
  database="state", projection="lambert", par=c(40,33), plot=FALSE)
#                  parameters to lambert: ^^^^^^^^^^^^
#                  see mapproj::mapproject
state.map.shp <-
  maptools::map2SpatialLines(state.map, proj4string=lcc.crs)
# start debugging
summary(do.call("rbind", 
  unlist(coordinates(state.map.shp), recursive=FALSE)))
#   end debugging

# >     summary(do.call("rbind", 
# +       unlist(coordinates(state.map.shp), recursive=FALSE)))
#        V1                  V2         
#  Min.   :-0.2226344   Min.   :-0.9124  
#  1st Qu.:-0.0003149   1st Qu.:-0.8295  
#  Median : 0.0763322   Median :-0.7706  
#  Mean   : 0.0553948   Mean   :-0.7752  
#  3rd Qu.: 0.1546465   3rd Qu.:-0.7190  
#  Max.   : 0.2112617   Max.   :-0.6458  
# no real change from previous `coordinates(state.map.shp)`

pdf(file=lcc.pdf)
rasterVis::levelplot(o3.raster, margin=FALSE
) + latticeExtra::layer(
  sp::sp.lines(state.map.shp, lwd=0.8, col='darkgray'))

dev.off()
system(sprintf("xpdf %s", lcc.pdf))
# as expected, same as before: data looks correct, map invisible

#####   end example 1 ##### 
```

**示例 2：**产生类似的输出![这](../Images/470cb393b072b2b97eaf10063d1e9274.png)

```
##### start example 2 #####

# Following adapted from what is installed in my
# .../R/x86_64-pc-linux-gnu-library/2.14/m3AqfigExampleScript.r
# (probably by my sysadmin), which also greatly resembles
# https://wiki.epa.gov/amad/index.php/R_packages_developed_in_AMAD
# which is behind a firewall :-(

## EXAMPLE WITH LAMBERT CONIC CONFORMAL FILE.

library("M3")
library("aqfig") # http://cran.r-project.org/web/packages/aqfig/

## Use an example file with LCC projection: either local download ...
lcc.file <- "./ozone_lcc.nc"
## ... or as installed by package=M3:
# lcc.file <- system.file("extdata/ozone_lcc.ncf", package="M3")
## Choose the one that works for you.
lcc.pdf <- "./ozone_lcc.example2.pdf" # for output

##  READ AND PLOT OZONE FROM FILE WITH LCC PROJECTION.

## Read in variable with daily ozone. Note that we can give dates
## rather than date-times, and that will include all time steps
## anytime during those days.  Or, we can give lower and upper bounds
## and all time steps between these will be taken.
o3 <- M3::get.M3.var(
  file=lcc.file, var="O3", hz.units="m",
  ldatetime=as.Date("2001-07-01"), udatetime=as.Date("2001-07-04"))
# start debugging
class(o3)
summary(o3)
summary(o3$x.cell.ctr)
#   end debugging

# > class(o3)
# [1] "list"
# > summary(o3)
#            Length Class   Mode     
# data       66304  -none-  numeric  
# data.units     1  -none-  character
# x.cell.ctr   148  -none-  numeric  
# y.cell.ctr   112  -none-  numeric  
# hz.units       1  -none-  character
# rows         112  -none-  numeric  
# cols         148  -none-  numeric  
# layers         1  -none-  numeric  
# datetime       4  POSIXct numeric  
# > summary(o3$x.cell.ctr)
#     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
# -2718000 -1395000   -72000   -72000  1251000  2574000 

# Note how these grid coordinates relate to the IOAPI metadata above:
# min(o3$x.cell.ctr)      == -2718000
# == -2736000 + (36000/2) == x.orig + (x.cell.width/2)

## Get colors and map boundaries for plot.
library("fields")
col.rng <- tim.colors(20)
detach("package:fields")

## Get state boundaries in projection units.
map.lines <- M3::get.map.lines.M3.proj(
  file=lcc.file, database="state", units="m")
# start debugging
class(map.lines)
summary(map.lines)
summary(map.lines$coords)
#   end debugging

# >     class(map.lines)
# [1] "list"
# >     summary(map.lines)
#        Length Class  Mode     
# coords 23374  -none- numeric  
# units      1  -none- character
# >     summary(map.lines$coords)
#        x                  y           
#  Min.   :-2272238   Min.   :-1567156  
#  1st Qu.:   94244   1st Qu.: -673953  
#  Median :  913204   Median :  -26948  
#  Mean   :  689997   Mean   :  -84644  
#  3rd Qu.: 1744969   3rd Qu.:  524531  
#  Max.   : 2322260   Max.   : 1265778  
#  NA's   :168        NA's   :168       

## Set color boundaries to encompass the complete data range.
z.rng <- range(as.vector(o3$data))

## Make a color tile plot of the ozone for the first day (2001-07-01).
pdf(file=lcc.pdf)
image(o3$x.cell.ctr, o3$y.cell.ctr, o3$data[,,1,1],
      col=col.rng, zlim=z.rng,
      xlab="x-coord (m)", ylab="y-coord (m)")

## Put date-time string and chemical name (O3) into a format I can use
## to label the actual figure.
date.str <- format(o3$datetime[1], "%Y-%m-%d")
title(main=bquote(paste(O[3], " on ", .(date.str), sep="")))

## Put the state boundaries on the plot.
lines(map.lines$coords)

## Add legend to right of plot. NOTE: YOU CANNOT ADD TO THE PLOT
## AFTER USING vertical.image.legend(). Before making a new plot,
## open a new device or turn this device off.
vertical.image.legend(zlim=z.rng, col=col.rng)

dev.off() # close the plot if you haven't already, ...
# ... and change the following to display PDFs on your system.
system(sprintf("xpdf %s", lcc.pdf))
# data displays with state map

#####   end example 2 ##### 
```

但是我看不到如何从返回的简单矩阵（等，但不多）中获得想要`M3::get.map.lines.M3.proj` 的`SpatialLines`东西`sp::sp.lines`，更不用说想要的东西了`latticeExtra::layer`。（我是一个新手，发现格子文档相当难以理解。）此外，我更愿意避免手动进行上面的 IOAPI 转换（尽管我当然更愿意这样做而不是跳过旧式图形的箍）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T22:26:42.467

做到这一点的一种方法虽然丑陋，但使用线性 IOAPI 变换“修复”`state.map`从 获得的坐标。`maps::map`例如，

**示例 3：**产生类似的输出![这](../Images/2320dff1707ab3687b248900f2630d1f.png)

```
##### start example 3 #####

library("M3")        # http://cran.r-project.org/web/packages/M3/
library("rasterVis") # http://cran.r-project.org/web/packages/rasterVis/

## Use an example file with projection=Lambert conformal conic.
# lcc.file <- system.file("extdata/ozone_lcc.ncf", package="M3")
# See notes in question regarding unfortunate problem with raster::raster,
# and remember to download or rename the file (symlinking alone will not work).
lcc.file <- "./ozone_lcc.nc"

lcc.proj4 <- M3::get.proj.info.M3(lcc.file)
lcc.proj4   # debugging
# [1] "+proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +a=6370000 +b=6370000"
# Note +lat_0=40 +lat_1=33 +lat_2=45 for maps::map@projection (below)
lcc.crs <- sp::CRS(lcc.proj4)
lcc.pdf <- "./ozone_lcc.example3.pdf" # for output

## Read in variable with daily ozone.
# o3.raster <- raster::raster(x=lcc.file, varname="O3", crs=lcc.crs)
# ozone_lcc.nc has 4 timesteps, choose 1 at random
o3.raster <- raster::raster(x=lcc.file, varname="O3", crs=lcc.crs, level=1)
o3.raster@crs <- lcc.crs # why does the above assignment not take?
# start debugging
o3.raster
summary(coordinates(o3.raster)) # thanks, Felix Andrews!
M3::get.grid.info.M3(lcc.file)
#   end debugging

# > o3.raster
# class       : RasterLayer 
# band        : 1 
# dimensions  : 112, 148, 16576  (nrow, ncol, ncell)
# resolution  : 1, 1  (x, y)
# extent      : 0.5, 148.5, 0.5, 112.5  (xmin, xmax, ymin, ymax)
# coord. ref. : +proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +a=6370000 +b=6370000 
# data source : .../ozone_lcc.nc 
# names       : O3 
# z-value     : 1 
# zvar        : O3 
# level       : 1 

# > summary(coordinates(o3.raster))
#        x                y         
#  Min.   :  1.00   Min.   :  1.00  
#  1st Qu.: 37.75   1st Qu.: 28.75  
#  Median : 74.50   Median : 56.50  
#  Mean   : 74.50   Mean   : 56.50  
#  3rd Qu.:111.25   3rd Qu.: 84.25  
#  Max.   :148.00   Max.   :112.00  

# > M3::get.grid.info.M3(lcc.file)
# $x.orig
# [1] -2736000
# $y.orig
# [1] -2088000
# $x.cell.width
# [1] 36000
# $y.cell.width
# [1] 36000
# $hz.units
# [1] "m"
# $ncols
# [1] 148
# $nrows
# [1] 112
# $nlays
# [1] 1

# The grid (`coordinates(o3.raster)`) is integers, because this
# data is stored using the IOAPI convention. IOAPI makes the grid
# Cartesian by using an (approximately) equiareal projection (LCC)
# and abstracting grid positioning to metadata stored in netCDF
# global attributes. Some of this spatial metadata can be accessed
# by `M3::get.grid.info.M3` (above), and some can be accessed via
# the coordinate reference system (`CRS`, see `lcc.proj4` above)

## Get US state boundaries in projection units.
state.map <- maps::map(
  database="state", projection="lambert", par=c(33,45), plot=FALSE)
#                  parameters to lambert: ^^^^^^^^^^^^
#                  see mapproj::mapproject

# replace its coordinates with
metadata.coords.IOAPI.list <- M3::get.grid.info.M3(lcc.file)
metadata.coords.IOAPI.x.orig <- metadata.coords.IOAPI.list$x.orig
metadata.coords.IOAPI.y.orig <- metadata.coords.IOAPI.list$y.orig
metadata.coords.IOAPI.x.cell.width <- metadata.coords.IOAPI.list$x.cell.width
metadata.coords.IOAPI.y.cell.width <- metadata.coords.IOAPI.list$y.cell.width
map.lines <- M3::get.map.lines.M3.proj(
  file=lcc.file, database="state", units="m")
map.lines.coords.IOAPI.x <-
  (map.lines$coords[,1] - metadata.coords.IOAPI.x.orig)/metadata.coords.IOAPI.x.cell.width
map.lines.coords.IOAPI.y <-
  (map.lines$coords[,2] - metadata.coords.IOAPI.y.orig)/metadata.coords.IOAPI.y.cell.width
map.lines.coords.IOAPI <- 
  cbind(map.lines.coords.IOAPI.x, map.lines.coords.IOAPI.y)
# start debugging
class(map.lines.coords.IOAPI)
summary(map.lines.coords.IOAPI)
#   end debugging

# >     class(map.lines.coords.IOAPI)
# [1] "matrix"
# >     summary(map.lines.coords.IOAPI)
#  map.lines.coords.IOAPI.x map.lines.coords.IOAPI.y
#  Min.   : 12.88           Min.   :14.47           
#  1st Qu.: 78.62           1st Qu.:39.28           
#  Median :101.37           Median :57.25           
#  Mean   : 95.17           Mean   :55.65           
#  3rd Qu.:124.47           3rd Qu.:72.57           
#  Max.   :140.51           Max.   :93.16           
#  NA's   :168              NA's   :168        

coordinates(state.map.shp) <- map.lines.coords.IOAPI # FAIL:
> Error in `coordinates<-`(`*tmp*`, value = c(99.0242231482288, 99.1277727928691,  : 
>   setting coordinates cannot be done on Spatial objects, where they have already been set

state.map.IOAPI <- state.map # copy
state.map.IOAPI$x <- map.lines.coords.IOAPI.x
state.map.IOAPI$y <- map.lines.coords.IOAPI.y
state.map.IOAPI$range <- c(
  min(map.lines.coords.IOAPI.x),
  max(map.lines.coords.IOAPI.x),
  min(map.lines.coords.IOAPI.y),
  max(map.lines.coords.IOAPI.y))
state.map.IOAPI.shp <-
  maptools::map2SpatialLines(state.map.IOAPI, proj4string=lcc.crs)
# start debugging
# thanks, Felix Andrews!
class(state.map.IOAPI.shp)
summary(do.call("rbind",
  unlist(coordinates(state.map.IOAPI.shp), recursive=FALSE)))
#   end debugging

# > class(state.map.IOAPI.shp)
# [1] "SpatialLines"
# attr(,"package")
# [1] "sp"

# > summary(do.call("rbind",
# +   unlist(coordinates(state.map.IOAPI.shp), recursive=FALSE)))
#        V1               V2       
#  Min.   : 12.88   Min.   :14.47  
#  1st Qu.: 78.62   1st Qu.:39.28  
#  Median :101.37   Median :57.25  
#  Mean   : 95.17   Mean   :55.65  
#  3rd Qu.:124.47   3rd Qu.:72.57  
#  Max.   :140.51   Max.   :93.16  

pdf(file=lcc.pdf)
rasterVis::levelplot(o3.raster, margin=FALSE
) + latticeExtra::layer(
  sp::sp.lines(state.map.IOAPI.shp, lwd=0.8, col='darkgray'))
dev.off()
# change this for viewing PDF on your system
system(sprintf("xpdf %s", lcc.pdf))

#####   end example 3 ##### 
```

# macos - 如何在 OSX 中更新 monodevelop3.0.6 并保留 mono3.0.3？

> ID：14865508
> 
> 赞同：6
> 
> 时间：2013-02-13T23:54:25.333
> 
> 标签：macos, f#, mono, monodevelop

Xamarin 更新将我的单声道版本恢复为 2.10.9。我不希望这样，因为我需要单声道 >= 3.0。F# 项目不会在单声道 2.10.9 下加载。我在下面解释更多。这个问题更加突出，因为我想*更新*monodevelop 但不是 mono，但我无法选择要安装的 Xamarin 更新。[我尝试了更新，希望它会注意到我当前的单声道版本更高；但实际上它删除了 mono3.0.3 和 f# 3.0 并且我的 f# 项目不再加载]

我在那里错过了什么吗？除了手动下载和安装之外，还有一种管理更新的方法，因为它似乎对我来说自动更新被破坏了？我现在恢复了更新：有没有办法使用我现有的 monodevelop，或者是否有必要重新安装它（即使安装了 mono 3.0.3 后同样的问题仍然存在）？

我当前的设置似乎有效：

在 OSX Snow Leopard 上运行 mono 3.0.3 mre（测试版）和 monodevelop 3.0.6。

为什么依赖单声道 3.0.3？因为我的项目需要 fsharpbinding，并且在需要 f# 3.0 并且（至少在 osx 上）需要 mono 3.0.3 的最新 monodevelop 中。我查看了其他 so/sx 问题，但它们与 mono/develop 的早期版本有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T08:31:07.227

> 这个问题更加突出，因为我想更新 monodevelop 但不是 mono，但我无法选择要安装哪些 Xamarin 更新。

更新对话框似乎不允许您选择要更新的特定包。关于自动删除 Mono 运行时，这是一个已在[此处](https://bugzilla.xamarin.com/show_bug.cgi?id=8693)报告的已知错误。

> 我在那里错过了什么吗？除了手动下载和安装之外，还有一种管理更新的方法，因为它似乎对我来说自动更新被破坏了？

`Applications`我通常会手动更新：下载最新的 MonoDevelop 并覆盖文件夹中的旧版本。它需要点击几下，但更安全。我也对 FSharpBinding 进行了类似操作：转到`Add-in Manager --> F# Language Binding`并单击`Update`。

> 我现在恢复了更新：有没有办法使用我现有的 monodevelop，或者是否有必要重新安装它（即使安装了 mono 3.0.3 后同样的问题仍然存在）？

假设自动更新为您提供了新的 MonoDevelop 并删除了 Mono 3.0.3。重新安装 Mono 3.0.3 后，您需要设置`Preferences --> .NET runtimes --> Mono 3.0.3`为默认值，并可能再次删除并安装 FSharpBinding。您不必再次重新安装 MonoDevelop。

也就是说，请谨慎使用自动更新功能。除非您确定所有更新（Mono、MonoDevelop、FSharpBinding）都是正确的，否则不要这样做。

# css - 隐藏的滚动条不允许页面滚动。(CSS)

> ID：14865511
> 
> 赞同：2
> 
> 时间：2013-02-13T23:54:40.930
> 
> 标签：css, scrollbar

使用代码后：

```
body{
    overflow:hidden;
} 
```

滚动条从页面的右侧消失，但结果是，我无法再向上或向下滚动页面，除非我单击鼠标上的滚轮并朝我希望滚动的方向拖动。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:20:35.400

的目的`overflow: hidden;`不是隐藏滚动条 - 这是实际发生的结果，即 - 所有超出“可见”区域的内容都被剪裁（隐藏）。

您基本上是在寻找*不是*目的的东西（隐藏滚动条）`overflow: hidden;`

# installation - Aptana 错误，readyState=3？

> ID：14865515
> 
> 赞同：1
> 
> 时间：2013-02-13T23:55:13.113
> 
> 标签：installation, aptana

我刚开始使用 Aptana Studio。我习惯于使用 Eclipse 作为 Flex 的 IDE。创建一个新的 HTML/JS 项目我运行示例样板 index.html 并收到以下错误。

> 错误：[代理] 套接字错误：[对象事件]；就绪状态=3。也许 Helper 没有在 ws://127.0.0.1:6258/2 上运行或正在关闭？

它预览正常，但事件似乎每秒触发一次左右。建议？

# java - 如何在 Java 中从 XML 中提取子元素和文本

> ID：14865519
> 
> 赞同：0
> 
> 时间：2013-02-13T23:55:23.940
> 
> 标签：java, xml, xpath, xml-parsing

我有以下 XML，我想使用 Java 和可能的 XPath 提取en-note 元素下的*所有*内容，包括文本和子元素？

源 XML：

```
<en-note style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
  A little test note…
  <div><br/></div>
  <div>
    <ul>
      <li>blah</li>
    </ul>
  </div>
</en-note> 
```

我要提取的内容：

```
 A little test note…
  <div><br/></div>
  <div>
    <ul>
      <li>blah</li>
    </ul>
  </div> 
```

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:01:35.560

您需要与 String.indexOf 和 String.substring() 成为最好的朋友

我自己不做就可以给你的最好答案是告诉你用 indexOf 找到一个点，然后用 substring 解析它

# cuda - 我如何知道是否可以使用 CUDA？

> ID：14865520
> 
> 赞同：2
> 
> 时间：2013-02-13T23:55:30.660
> 
> 标签：cuda, gpu

假设我编译了一个使用 CUDA Toolkit 的程序，并且我在不支持所需计算能力或者甚至没有支持 CUDA 接口的 NVIDIA GPU 的硬件上运行该程序，我如何从编程中知道 -等级？为了回退到 CPU 程序或显示错误消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T00:14:04.273

如果您已经安装了带有示例的 CUDA 工具包，我建议您查看 deviceQuery 项目。这显示了有关如何查询设备的属性（例如 Capability Major/Minor 版本号）的示例。

附上短片：

```
 cudaSetDevice(dev);
    cudaDeviceProp deviceProp;
    cudaGetDeviceProperties(&deviceProp, dev);

    printf("\nDevice %d: \"%s\"\n", dev, deviceProp.name);

    // Console log
    cudaDriverGetVersion(&driverVersion);
    cudaRuntimeGetVersion(&runtimeVersion);
    printf("  CUDA Driver Version / Runtime Version          %d.%d / %d.%d\n", driverVersion/1000, (driverVersion%100)/10, runtimeVersion/1000, (runtimeVersion%100)/10);
    printf("  CUDA Capability Major/Minor version number:    %d.%d\n", deviceProp.major, deviceProp.minor); 
```

至于系统是否没有 GPU，您可以使用下面的代码片段，尽管我相信您此时需要拥有静态库。

```
int deviceCount = 0;
cudaError_t error_id = cudaGetDeviceCount(&deviceCount);

if (error_id != cudaSuccess)
{
    printf("cudaGetDeviceCount returned %d\n-> %s\n", (int)error_id, cudaGetErrorString(error_id));
    exit(EXIT_FAILURE);
}

// This function call returns 0 if there are no CUDA capable devices.
if (deviceCount == 0)
{
    printf("There are no available device(s) that support CUDA\n");
}
else
{
    printf("Detected %d CUDA Capable device(s)\n", deviceCount);
} 
```

# sql - 如何通过 T-SQL 获取数据库的“生成脚本”

> ID：14865521
> 
> 赞同：1
> 
> 时间：2013-02-13T23:55:42.127
> 
> 标签：sql, sql-server, tsql

我知道如何使用 SQL 管理生成脚本以在 SQL 中创建整个数据库。

我需要获得相同的脚本，但使用 T-SQL。

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:12:49.323

如果我没记错的话，那是 SQL IDE 的一个功能。要复制这一点，您必须自己进行大量反省。也许您使用过第三方工具？

要进行自省，您需要查看架构中的表和视图`INFORMATION_SCHEMA`以`sys`确定每个对象的功能，然后自己编写脚本。

有一些帮助存储过程`sp_helptext`，您可以利用它们来简化这项工作。

# python - 如何在 Tkinter 中拥有可扩展的小部件？

> ID：14865523
> 
> 赞同：1
> 
> 时间：2013-02-13T23:56:02.933
> 
> 标签：python, widget, tkinter

**问题**

到目前为止，我已经创建了几个 GUI 项目，但它们都有一个致命的错误。当我缩小一个窗口时，（通常只使用一个`frame.`）几个小部件将消失。有没有办法让小部件“知道”它们框架的大小？

**到目前为止我尝试过的**

我试过用这个：

```
w, h = root.winfo_screenwidth(), root.winfo_screenheight() 
```

指定窗口的大小，但由于许多小部件使用像素以外的值，因此它永远不会起作用。我也不确定它是不断更新还是仅在生成窗口时更新。（`Text`使用字符的大小......等）

**眼镜**

Python 2.7.3

Windows 7/ Mac OSX 狮子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:18:23.203

这通常很容易，而且通常只是默认发生。这完全取决于您如何使用`pack`和`grid`. 如果没有看到您的代码，就很难为您提供有用的信息。

您能否向我们展示一个非常小的程序来说明问题并准确指示您如何布置 GUI？

# validation - 在 Scala 2.10 中验证和扩展构造函数参数的最佳方法

> ID：14865528
> 
> 赞同：2
> 
> 时间：2013-02-13T23:56:27.367
> 
> 标签：validation, scala, scala-2.10

我想要一个具有多个字段的类，例如字符串、布尔值等，并且在构造该类时，我希望有一个与每个字段相关联的字段名并验证该字段（对字符串使用正则表达式）。理想情况下，我只想在构造函数中指定参数需要满足某些条件。

一些示例代码：

```
case class Data(val name: String ..., val fileName: String ...) {
  name.verify
  // Access fieldName associated with the name parameter.
  println(name.fieldName) // "Name"
  println(fileName.fieldName) // "File Name"
}

val x = Data("testName", "testFile")
// Treat name as if it was just a string field in Data
x.name // Is of type string, does not expose fieldName, etc 
```

有没有一种优雅的方式来实现这一目标？

编辑：我认为我无法清楚地了解我所追求的。我有一个带有许多字符串参数的类。这些参数中的每一个都需要以特定方式进行验证，并且我还希望有一个与每个参数关联的字符串 fieldName。但是，我仍然希望能够将参数视为普通字符串（参见示例）。

我可以将逻辑编码到 Data 中，并作为每个参数的 Data 伴随对象的应用方法，但我希望有更通用的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:12:59.417

将逻辑（例如参数验证）放入构造函数是可疑的。从构造函数中抛出异常是双重的。

通常这种创建模式最好使用一个或多个工厂方法或某种构建器。

对于基本工厂，只需定义一个带有您想要的工厂方法的伴侣。如果您想要相同的速记构造符号（`new`-free），您可以重载预定义的符号`apply`（尽管您可能不会替换其签名与`case class`构造函数完全匹配的符号）。

如果您想在验证失败时让您的客户端代码免于处理异常的混乱，您可以返回`Option[Data]`或`Either[ErrorIndication, Data]`代替。或者你可以使用 ScalaZ's `Validation`，我将任意声明它超出了这个答案的范围（因为我对它不够熟悉......）

但是，您不能拥有在它们所呈现的属性上有所不同的实例。甚至子类也不能从公共 API 中减去。如果您需要能够做到这一点，您将需要更精细的构造，例如`trait`用于公共部分的 a 和`case class`用于变体和/或扩展的单独 es。

# jquery - Jquery Validation 和 asp.net UpdatePanel 似乎发回了两次？

> ID：14865532
> 
> 赞同：1
> 
> 时间：2013-02-13T23:57:02.150
> 
> 标签：jquery, asp.net

我目前有一个包含两个文本框和一个提交按钮的表单。我在两个文本框上使用 jquery 验证，但由于我使用 asp.net UpdatePanel 将数据发送到使用 AJAX 的服务器，所以我在验证时遇到了一些麻烦。

发生的事情是我已经使用以下代码进行了验证：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="Register.ascx.cs" Inherits="CapcoControls.Register" %>
<div id="register">    
    <form id="Form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="btnSubmit" EventName="Click" />
        </Triggers>
        <ContentTemplate>
        <asp:Panel id="pnlWrapper" ClientIDMode="Static" runat="server">
            <asp:TextBox ID="txtName" runat="server" MaxLength="200" TabIndex="1" ClientIDMode="Static" title="NAME"></asp:TextBox>
            <asp:TextBox ID="txtEmail" runat="server" MaxLength="200" TabIndex="2" ClientIDMode="Static" title="EMAIL ADDRESS"></asp:TextBox>
            <asp:ImageButton ID="btnSubmit" runat="server" 
                ImageUrl="~/images/btn_submit.png" ClientIDMode="Static" 
                onclick="btnSubmit_Click" TabIndex="3" />
        </asp:Panel>
        </ContentTemplate>        
    </asp:UpdatePanel>
    </form>
</div>
<script type="text/javascript">
    Sys.WebForms.PageRequestManager.getInstance().add_initializeRequest(initializeRequestHandler);

    function initializeRequestHandler(sender, args) {
        if (args.get_postBackElement().id == '<%= btnSubmit.ClientID %>' && $("#Form1").valid() !== true) {
             args.set_cancel(true);
         }
     }

    $(document).ready(function () {
        $("#Form1").validate({            
            rules: {
                <%= txtName.UniqueID %>: {
                    required: true,
                    checkDefaultValue: true
                },                
                <%= txtEmail.UniqueID %>: {
                    required: true,
                    email: true,
                    checkDefaultValue: true
                }
            },
            messages: { },
            errorPlacement: function(error, element) { }            
        });        
    });        
</script> 
```

问题是，一旦用户输入有效数据，服务器端点击事件就会被调用**两次**，但我不知道为什么？有人有什么主意吗？

我的直觉是这与我的 jquery validate 即有关。该按钮默认发回，然后由于 jquery 验证，我以某种方式再次提交表单。

有谁知道我在这里哪里出错了？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:07:58.767

尝试将所有内容都放在`pageLoad`
链接中：[http ://encosia.com/document-ready-and-pageload-are-not-the-same/](http://encosia.com/document-ready-and-pageload-are-not-the-same/)

# ruby-on-rails - Rails 的控制器设置有很多直接关系

> ID：14865534
> 
> 赞同：0
> 
> 时间：2013-02-13T23:57:11.013
> 
> 标签：ruby-on-rails, controller, has-many-through

[我对这个例子](https://stackoverflow.com/questions/2219559/multiple-associations-to-same-model)有类似的问题。我是新手，已经阅读了几个小时来了解如何获得这个答案，但一直没有得到答案，非常感谢您的帮助！我按照 Kikito 的回答设置了以下模型：用户、照片、位置、照片关系。我的路线文件包含：

```
resources :users 
resources :locations do
  resources :photos
end
resources :photo_relationships 
```

我能够将照片保存到我的应用程序中的正确位置，但我无法通过 Photo_Relationships 模型将多个用户（特别是照片的创建者）分配给照片。

```
class CreatePhotoRelationshipsTable < ActiveRecord::Migration
  def change
    create_table :photo_relationships do |t|
        t.integer :photo_id
        t.integer :user_id
        t.integer :role_id

        t.timestamps
    end 
```

**照片控制器**

```
 def create
    @location = Location.find(params[:location_id])
    @photo = @location.photos.new(params[:photo])
    @photo.create_photo_relationship(@photo, current_user, 0)
    if @photo.save
        flash[:notice] = "Successfully added your photo"
        redirect_to [@mountain, @photo]
    else
        render :action => 'new'
    end
  end 
```

**Photo_Relationships 控制器**

```
def create
  @relationship = photo_relationships.new(params[:photo][:location])
  @photo.create_photo_relationship()
end 
```

我当前的错误是未定义的方法“photo_relationship”。非常感谢某人能够提供的任何帮助或指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:03:27.807

类的名称`PhotoRelationship`不是`photo_relationships`。

您的控制器行应为：

```
@relationship = PhotoRelationship.new(params[:photo][:mountain]) 
```

# android - 在写入文件时理解 logcat 输出

> ID：14865538
> 
> 赞同：2
> 
> 时间：2013-02-13T23:57:19.850
> 
> 标签：android, logcat, android-logcat

我有一个日志猫，它被输出到一个文本文件，但找不到每个部分的含义。例如，我有以下内容：

```
W/Trace   (  857): Unexpected value from nativeGetEnabledTags: 0

E/ActivityThread(  565): Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d35408 that was originally bound here

E/ActivityThread(  565): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d35408 that was originally bound here

E/ActivityThread(  565):    at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969) 
```

我不确定每个部分的含义，我假设 W/ 表示警告，E/ 表示错误。但不确定文本是否在斜线之后。我也不确定括号中的数字是多少。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-16T04:39:38.410

这可以通过简单地将 logcat 的输出与 DDMS 中显示的输出进行比较来理解。这是一个例子：

日志输出：

```
E/QC-DSS-LIB(   74): unrecognized ifi_index 15
D/wpa_supplicant(19367): RTM_NEWLINK: operstate=0 ifi_flags=0x11003 ([UP][LOWER_UP])
D/wpa_supplicant(19367): RTM_NEWLINK, IFLA_IFNAME: Interface 'eth0' added
D/wpa_supplicant(19367): Wireless event: cmd=0x8c02 len=27
D/wpa_supplicant(19367): RTM_NEWLINK: operstate=0 ifi_flags=0x11003 ([UP][LOWER_UP])
D/wpa_supplicant(19367): RTM_NEWLINK, IFLA_IFNAME: Interface 'eth0' added
D/wpa_supplicant(19367): Wireless event: cmd=0x8c02 len=33
D/WifiStateTracker(  123): Reset connections and stopping DHCP 
```

DDMS 截图： ![在此处输入图像描述](../Images/811e82a38b35d0833d76ae9ef99ee1ed.png)

从截图的第一行分析：

*   “E”是日志级别
*   QC-DSS-LIB 是标签
*   “74”是进程 ID

如果您还希望从 logcat 中获取时间戳，请使用如下`-v`开关：

```
logcat -v time 
```

这将以这种格式给出输出：

```
02-16 09:58:21.446 E/QC-DSS-LIB(   74): unrecognized ifi_index 15 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T02:34:22.337

您看到的是堆栈跟踪。在顶部，您拥有应用程序运行的最后一个已知位置。你在第 857 行，你忘了在那里施放或做其他事情。

散列后的文本只是您正确假设的错误或警告消息。括号中的数字是行。

# jquery - 从 iframe 更改父元素不起作用？

> ID：14865541
> 
> 赞同：2
> 
> 时间：2013-02-13T23:57:32.963
> 
> 标签：jquery

当我点击链接时，谁能告诉我为什么这段代码不起作用？

该链接位于 iframe 中，我希望该链接在主页中切换菜单。

```
<script>
$(document).ready(function() {
 quickout = 0;
 $("#scrollsetting").click(function(){
    if (quickout==0){
    window.parent.document.getElementById('quickmenu').show(300);
    quickout = 1;
    } else {
    window.parent.document.getElementById('quickmenu').hide(300);
    menuout=0;
    }
 })
});
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T01:02:26.753

jQuery 选择器不会自然地选择其他窗口中的元素，您必须访问其他窗口中的 jQuery 以查询其 DOM 或传递对其他窗口文档的引用，以便 jQuery 找到您要查找的内容。

`iframe`第一种方法，使用 jQuery 中的 jQuery 查询 's 窗口中的元素`iframe`，使用父窗口的 jQuery 查询父窗口中的元素：

```
$(document).ready(function () {
    $("#scrollsetting").click(function () {
        window.parent.$('#quickmenu').toggle(300);
    });
}); 
```

[**小提琴**](http://jsfiddle.net/ae5YB/9/)

虽然，并不总是需要加载 jQuery 两次，所以假设您刚刚将它加载到父窗口中，然后您可以使用父窗口的 jQuery 和[上下文选择器](http://api.jquery.com/jQuery/#jQuery1)将其设置为 current `document`，而它仍然默认为父窗口的文档省略时：

```
var $ = window.parent.$;
$(document).ready(function () {
    $("#scrollsetting", document).click(function () {
        $('#quickmenu').toggle(300);
    });
}); 
```

[**小提琴**](http://jsfiddle.net/ae5YB/11/)

同样，如果出于某种原因您只在子窗口中使用 jQuery，请在引用父窗口的文档时使用上下文选择器：

```
$("#scrollsetting").click(function () {
    $('#quickmenu', window.parent.document).toggle(300);
}); 
```

[**小提琴**](http://jsfiddle.net/ae5YB/10/)

附言。别介意我的`inject`包装。`iframe`这只是一种在将其文本以 IIFE 形式注入之前以可读方式编写代码的方法——我的字符串连接隐式调用[`Function.toString()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/toString)。

当然，如果您有其他绝对需要在框架页面中包含 jQuery 的依赖项/插件，您可以使用最简单的第一个解决方案，或者您认为更合适的任何一个解决方案。

ps2。如果任何读者在您的页面中尝试此代码时遇到问题，请记住`iframe`s 受[同源警察](http://en.wikipedia.org/wiki/Same_origin_policy)的约束。`iframe`也就是说，当它`src`的域、协议或端口与父文档不匹配时，您将无法访问它，反之亦然。

# wcf - 在 WCF WIF 管道中处理 REST SWT 令牌不起作用

> ID：14865542
> 
> 赞同：1
> 
> 时间：2013-02-13T23:57:42.227
> 
> 标签：wcf, rest, azure, wif, acs

我在主题行中提到的设置上苦苦挣扎，想知道是否有人可以帮助我。

本质上，我拥有的是 WCF 服务，我希望用户可以使用自定义登录页面（使用带有 ACS 所需信息的 javascript）对 ACS 进行身份验证。

之后，用户应该使用提供的 SWT 令牌重定向到 WCF 服务。我使用 SimpleWebTokenHandler 作为 SWT 令牌处理的基础，但我不确定它在其中扮演什么角色。

这是我正在运行的 Web.config

```
<configuration>
    <configSections>
        <section name="system.identityModel" type="System.IdentityModel.Configuration.SystemIdentityModelSection, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
        <section name="system.identityModel.services" type="System.IdentityModel.Services.Configuration.SystemIdentityModelServicesSection, System.IdentityModel, Version=4.0.0.0, Culture=neutral" />
    </configSections>
    ...
    <system.serviceModel>
        <diagnostics>
        </diagnostics>
        <services>
            <service name="WcfWifSwtAcs.Service1">
                <endpoint address="xmlService" binding="webHttpBinding" bindingConfiguration="" behaviorConfiguration="restPoxBehaviour" name="xmlServiceEndpoint" contract="WcfWifSwtAcs.IService1" />
            </service>
        </services>
        <behaviors>
            <endpointBehaviors>
                <behavior name="restPoxBehaviour">
                    <webHttp helpEnabled="true" />
                </behavior>
            </endpointBehaviors>
            <serviceBehaviors>
                <behavior>
                    <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
                    <serviceDebug includeExceptionDetailInFaults="true" />
                    <serviceCredentials useIdentityConfiguration="true">
                        ...
                    </serviceCredentials>
                </behavior>
            </serviceBehaviors>
        </behaviors>
        <protocolMapping>
            <add scheme="http" binding="ws2007FederationHttpBinding" />
        </protocolMapping>
        <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
        <bindings>
            <ws2007FederationHttpBinding>
                <binding name="">
                    <security mode="Message">
                        <message 
                            issuedTokenType="http://schemas.xmlsoap.org/ws/2009/11/swt-token-profile-1.0">
                            <issuerMetadata address="https://xxxx.accesscontrol.windows.net/v2/wstrust/13/certificate/mex" />
                        </message>
                    </security>
                </binding>
            </ws2007FederationHttpBinding>
        </bindings>
    </system.serviceModel>
    <system.webServer>
    ...
    </system.webServer>
    <system.identityModel>
        <identityConfiguration>
            <audienceUris>
                <add value="http://localhost:56782/Service1.svc" />
            </audienceUris>
            <issuerNameRegistry type="System.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
                <trustedIssuers>
                    <add thumbprint="XXX" name="xxx.accesscontrol.windows.net" />
                </trustedIssuers>
            </issuerNameRegistry>
        <issuerTokenResolver type="SimpleWebToken.CustomIssuerTokenResolver, WcfWifSwtAcs" />
            <securityTokenHandlers>
                <clear/>
                <add type="SimpleWebToken.SimpleWebTokenHandler, WcfWifSwtAcs"/>
            </securityTokenHandlers>
        </identityConfiguration>
    </system.identityModel>
</configuration> 
```

现在我可以看到，身份验证发生并且浏览器被重定向到服务的主体。我还可以看到 SimpleWebToken 处理程序已实例化，并且正在请求令牌类型 URI。但这几乎就是所有发生的事情。没有实际的令牌处理验证，并且正在发生任何事情。

这是发送到服务的令牌（解析后）。

```
wa=wsignin1.0&
wresult=
<t:RequestSecurityTokenResponse 
xmlns:t="http://schemas.xmlsoap.org/ws/2005/02/trust">
<t:Lifetime>
    <wsu:Created 
        xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">2013-02-13T23:14:30.159Z</wsu:Created>
    <wsu:Expires
        xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">2013-02-13T23:24:30.159Z</wsu:Expires>
</t:Lifetime>
<wsp:AppliesTo 
    xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">
    <EndpointReference
        xmlns="http://www.w3.org/2005/08/addressing">
        <Address>http://localhost:56782/Service1.svc</Address>
    </EndpointReference>
</wsp:AppliesTo>
<t:RequestedSecurityToken>
    <wsse:BinarySecurityToken 
        wsu:Id="uuid:58e2fb15-dd1a-40bd-8ff0-ae24e22e6efe" 
        ValueType="http://schemas.xmlsoap.org/ws/2009/11/swt-token-profile-1.0"
        EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary"
        xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"          xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
        BASE64 DATA==
    </wsse:BinarySecurityToken>
</t:RequestedSecurityToken>
<t:TokenType>http://schemas.xmlsoap.org/ws/2009/11/swt-token-profile-1.0</t:TokenType>
<t:RequestType>http://schemas.xmlsoap.org/ws/2005/02/trust/Issue</t:RequestType>
<t:KeyType>http://schemas.xmlsoap.org/ws/2005/05/identity/NoProofKey</t:KeyType>
</t:RequestSecurityTokenResponse> 
```

服务本身非常简单，带有以下签名。

```
[OperationContract]
[WebInvoke(UriTemplate = "/GetData/{id}", RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json)]
string GetData(string id); 
```

有任何想法吗？我一直在验证 uri、主机名、指纹等是否都有效。此外，服务跟踪并没有真正显示与令牌处理或令牌验证中的异常相关的任何内容。

不知何故，令牌似乎甚至没有传递给处理程序。至少缺少所有声明和其他身份验证信息（空）。

如果有人指出我可以在哪里调试或者我遗漏了一些非常明显的东西（也可能总是如此），我将不胜感激。

PS 我知道我可以使用自定义身份验证模块来实现它，无论如何，我宁愿让它与 WIF 一起运行（它变得越来越重要，因为我已经花了更多时间在这上面，因为我真的很想要，而且我很固执：p）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:54:41.987

Soo，奉献精神会带来一个解决方案。虽然我最初认为这不能做到，但很明显它实际上可以。我会把解决方案放在这里，因为也许还有其他人觉得它有用。

首先，WCF REST 服务正在使用`webHttpBinding`，根据 MS 文档，它不支持 Windows Identity Foundation 和管道中的声明处理。实际上确实如此。不在 WCF 管道中，而是作为 Web 身份验证流中的 IIS 模块。

首先，您需要将以下模块添加到 Web.config 文件中。

```
<system.webServer>
    <modules runManagedModulesForAllRequests="true">
        <add name="WSFederationAuthenticationModule" type="System.IdentityModel.Services.WSFederationAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" preCondition="managedHandler" />
        <add name="SessionAuthenticationModule" type="System.IdentityModel.Services.SessionAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" preCondition="managedHandler" />
    </modules>
 </system.webServer> 
```

有一个警告。你仍然需要`<configSections>`我原来的帖子。问题是您需要在 VisualStudio 中将`System.IdentyModel*`程序集标记为**CopyLocal**项（在属性窗口中）。否则，您将得到一些无法为配置部分加载程序集的神秘异常。注意！仅当您正在加载这两个模块时才会发生这种情况，并且不会在未加载这些模块时发生。没有任何进一步调查那件事的意愿，也许有人更清楚那里的原因是什么。

接下来，如果出于任何原因您打算使用 MS WIF 代码中的 SWT 令牌处理示例，则需要修复几个错误，否则令牌解析将不会发生，或者您将从令牌中获得无效签名确认。

**SimpleWebToken.cs**您需要修复 SwtBaseTime，因为它初始化不正确，之后安全令牌创建失败：

从 public static DateTime SwtBaseTime = new DateTime( 1970, 1, 1, 0, 0, 0, 0 ); // 每 SWT psec 到

```
public static DateTime SwtBaseTime = new DateTime( 1970, 1, 1, 0, 0, 0, 0, DateTimeKind.Utc ); // per SWT psec 
```

**SimpleWebTokenHandler.cs**你需要修复以下值的大小写：

从

```
const string BinarySecurityToken = "binarySecurityToken";
const string ValueType = "valueType"; 
```

到

```
const string BinarySecurityToken = "BinarySecurityToken";
const string ValueType = "ValueType"; 
```

**CustomIssuerTokenResolver.cs**您需要修复使用 UTF8 字节初始化时创建的密钥，但它实际上应该使用解码的 Base64 字节进行初始化：

从

```
key = new InMemorySymmetricSecurityKey(UTF8Encoding.UTF8.FromBase64String(base64Key)); 
```

到

```
key = new InMemorySymmetricSecurityKey(System.Convert.FromBase64String(base64Key)); 
```

在您解决所有这些问题后，一切都已就位。验证器和授权器被调用，瞧，突然你有一个暴露为 REST 端点的 WCF 服务，所有声明等也都在工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:17:38.503

我认为您的问题可能与此示例中的 SWTTokenHandler 相关：http: [//code.msdn.microsoft.com/vstudio/Custom-Token-ddce2f55](http://code.msdn.microsoft.com/vstudio/Custom-Token-ddce2f55)

在 CanReadToken() 中，它检查令牌是否是 SWT 类型的 BinarySecurityToken：

```
if ( reader.IsStartElement( BinarySecurityToken )
&& ( reader.GetAttribute( ValueType ) == SimpleWebTokenConstants.ValueTypeUri ) ) 
```

但是常量 BinarySecurityToken 定义为：

```
const string BinarySecurityToken = "binarySecurityToken"; 
```

注意小写的“b”。XML 元素区分大小写，实际元素是带有大写 B 的“BinarySecurityToken”。这将导致处理程序在 CanReadToken() 中返回 false，从而导致 WIF 认为它没有为此令牌类型注册的处理程序。

# visual-studio-2012 - 可用于 VSTO 开发的最低 office 2013 版本是多少？

> ID：14865547
> 
> 赞同：2
> 
> 时间：2013-02-13T23:58:08.033
> 
> 标签：visual-studio-2012, vsto

我只需要开发Excel和word，那么在开发机器上安装Office Home版就足够了吗？或 Professional 是可用于开发的最低要求？

我正在使用 Visual Studio 2012。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:12:12.407

如果您想使用这些扩展（并且您**确实**想使用这些扩展），您需要购买**任何**商业版本。

但是，如果您对试用版持开放态度，则始终可以选择安装虚拟机（当然是出于测试目的）。

另外 - 你写了*最低限度的办公室 2013 版*这是一个错字吗？我假设您指的是VS。正确的？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T11:05:01.810

您可以在以下位置注册 Office 365 开发人员站点：msdn。

面包屑：开始为 Office 和 SharePoint 构建应用程序 > 注册 Office 365 开发人员网站

他们将为您提供“1 年 Office 365 开发人员订阅作为一项权益”，以便为 Office 和 SharePoint 商店构建和测试应用程序。

或者，您可以购买 Office 365 开发人员订阅（带有一个用户许可证）。此订阅费用为每年 99.00 美元。

希望这可以帮助。

# javascript - 谷歌地图 - 画布自定义叠加缩放

> ID：14865550
> 
> 赞同：0
> 
> 时间：2013-02-13T23:58:20.653
> 
> 标签：javascript, google-maps, google-maps-api-3, browser

如您所见： [http ://rolls.mit.edu/](http://rolls.mit.edu/)

我正在执行以下操作：

1.  创建地图

    ```
    map = new google.maps.Map(mapContainer, options); 
    ```

2.  添加叠加层

    ```
    overlay = new google.maps.OverlayView();
    overlay.draw = function() {};
    overlay.setMap(map); 
    ```

3.  将画布添加到叠加层

    ```
    overlay.getPanes().overlayLayer.appendChild(canvas); 
    ```

一切都很好，除了当我缩放时，画布保持相同的大小。放大/缩小时是否可以缩放画布？任何指向示例的指针？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:24:57.690

你几乎必须为你想要支持的任何谷歌缩放级别渲染一个新的画布。我解决这个问题的方法是在地图的“空闲”事件上设置一个监听器。一旦地图在缩放或平移后空闲，这将触发。然后您可以确定缩放级别是否发生变化并采取相应措施。

```
var map = new google.maps.Map(mapContainer, options);
var zoomLevel = 6; //some defaut

var handleBoundsChanged = function(){
   var oldZoom = zoomLevel;
   var zoomLevel = map.getZoom();
   if( zoomLevel != oldZoom){
       rebuildOverlayForZoom(zoomLevel)
     }
}

google.maps.event.addListener (map, 'idle', handleBoundsChanged); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:13:36.623

您需要监听[google.maps.Map](https://developers.google.com/maps/documentation/javascript/reference#Map) zoom_changed 事件，从地图中获取新的缩放级别（使用 map.getZoom()），然后适当地调整或修改您的画布元素。

如果您只想画一条线，请查看具有内置缩放功能的[google.maps.Polyline叠加层。](https://developers.google.com/maps/documentation/javascript/reference#Polyline)

# javascript - 将 jqPlot 图保存到图像文件

> ID：14865556
> 
> 赞同：2
> 
> 时间：2013-02-13T23:59:03.150
> 
> 标签：javascript, image, save, jqplot, mouseclick-event

我正在使用 jqPlot 在某些网页上显示许多图形。我希望能够将这些图表保存到图像文件中。

做这个的最好方式是什么？是否可以在图形上有一个右键单击菜单选项，可以将图形保存到图像文件中？

这是我的一张图表的一些代码：

```
var plotCogsLineGraph = $.jqplot('FinancialsLineGraph', [[30,31,34,40,45], [34,38,31,42,38]], 
{ 
            axes:
            {
                xaxis:
                {
                      ticks: ['5','4','3','2','1']
                },
                yaxis:
                {
                    label:'%',
                    pad: 1.05,
                    ticks: ['0','15','30','45','60']
                }
            },

            width: 480, height: 270,
            legend:{show:true, location: 's', placement: 'insideGrid', renderer: $.jqplot.EnhancedLegendRenderer},
    seriesDefaults: 
    {
                rendererOptions: {smooth: true}
    },
    series:[ 
                {
                    lineWidth:1, 
                    label:'COGS',
                    markerOptions: { size:1, style:'dimaond' }
                }, 
                {
                    lineWidth:1, 
                    label:'Wages',
                    markerOptions: { size: 1, style:"dimaond" }
                }
                ]
    }
); 
```

需要在上面的代码中添加什么才能将图形保存到图像文件中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-01T07:11:28.690

尝试这个：

```
$('#FinancialsLineGraph').jqplotSaveImage() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T07:33:47.157

假设您的情节正在绘制带有“情节”ID 的 div。您必须应用本机`jqplotToImageStr({})`功能才能将绘图转换为图像。然后您可以填充另一个 div（例如 id = 'graphicImage'）以显示这个新生成的图像：

```
var graphicImage = $('#graphicImage');
if(graphicImage.html() == ""){ //If the image was even generated, don't generate it again
  var divGraph = $('#plot').jqplotToImageStr({});
  var divElem  = $('<img/>').attr('src', divGraph);
  graphicImage.html(divElem);
} 
```

为了下载图像，您可以执行以下操作：

```
 open(divGraph.toDataURL("image/png")); 
```

就我而言，它不能很好地工作，因为我电脑上下载的图像已损坏。如果您找到保存它的方法，我会很高兴听到它。

无论如何，一旦你完成了这个答案的第一部分（用jqplot对应的图像填充'#graphicImage' div），你可以通过右键单击它来保存它......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-28T07:11:55.583

`$('#GraphName').jqplotSaveImage()` 但请注意，如果您在刻度上应用了一些自定义样式，则不会将其保存到图像

# node.js - node.js - 立即结束请求？

> ID：14865559
> 
> 赞同：0
> 
> 时间：2013-02-13T23:59:07.673
> 
> 标签：node.js

所以我有以下代码 -

```
var http = require('http');

http.createServer(function (req, res) {

console.log("Connected!");
res.writeHead(200);

req.on('data', function(data) {
    res.write(data);
});

}).listen(5000); 
```

但是当我写入chrome`localhost:5000`时它只是加载页面，然后它说服务器没有发送任何数据..

我发现如果我`req.end();`在数据事件之后写，它会完美地加载页面。
但是，我不想立即结束请求。

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:12:12.440

你必须`res.end()`在某个时候打电话，但你可以等待`req` [to `'end'`first](http://nodejs.org/api/http.html#http_event_end)：

```
req.on('end', function () {
    res.end();
}); 
```

# php - 如何使用 foreach 循环仅获取一种类型的元素？

> ID：14865562
> 
> 赞同：1
> 
> 时间：2013-02-13T23:59:36.337
> 
> 标签：php

有谁知道如何使用 FOREACH 循环仅获取所有颜色或仅获取所有水果？

```
$article = array(
  array( 'color'=>'green','fruit'=>'apples'),
  array( 'color'=>'orange','fruit'=>'oranges '),
  array( 'color'=>'red','fruit'=>'cherry')
); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:09:51.413

你基本上想要一个枢轴操作；这种骇人听闻的方法将做到这一点：

```
$articles = array(
  array( 'color'=>'green','fruit'=>'apples'),
  array( 'color'=>'orange','fruit'=>'oranges '),
  array( 'color'=>'red','fruit'=>'cherry')
);

foreach ($articles as $article) {
  foreach ($article as $type => $value) {
    ${$type}[] = $value;
  }
}

print_r($fruit);
print_r($color); 
```

[**演示**](http://codepad.viper-7.com/zeXyMb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:04:18.790

[`array_map`](http://php.net/array-map)会更适合这个：

```
$colors = array_map(function($a) {return $a['color'];},$article);
$fruits = array_map(function($a) {return $a['fruit'];},$article); 
```

# xcode - XCode 4.5 中的分布式构建？

> ID：14865563
> 
> 赞同：6
> 
> 时间：2013-02-13T23:59:38.833
> 
> 标签：xcode, xcode4.5, distributed

我想启用“分布式构建”，这样我的 Mac 就可以将构建移植到办公室中的其他空闲 Mac 上，以加快构建时间。显然，在旧版本的 XCode 中，Preferences 中曾经有一个“分布式构建”选项，如本博客顶部附近的屏幕截图所示：

[http://blog.mundue.net/2010/12/distributed-builds/](http://blog.mundue.net/2010/12/distributed-builds/)

但在最新的 XCode 中没有这样的东西。在 XCode 4.5 中，分布式构建甚至不再是一种选择吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-13T22:08:14.367

我相信分布式构建在 Xcode 4.3 中被删除了。感到羞耻，因为它是一个很棒的功能！

# java - 如何延迟加载 uibinded GWT 编辑器

> ID：14865564
> 
> 赞同：1
> 
> 时间：2013-02-13T23:59:53.867
> 
> 标签：java, gwt, editor, lazy-loading

我想解释 GWT 编辑器的时间太长（而且尝试起来可能不准确）。另外，因为我认为自己对编辑器的机制有初步的了解。所以请不要因为简洁而责备我。

这是我将编辑器变量绑定到 uibinder 模板的代码，

```
@Path("canon.doer") 
@UiField ShenandoerEditor shanonEditor; 
```

由于@path 规范，似乎不可能延迟加载编辑器。

为了演示这个问题，即使没有延迟加载，但像这样解耦构造，

```
@UiFactory ShenandoerEditor mkShanonEditor{
    return new ShenandoerEditor();
} 
```

在 GWT.create 期间导致错误

> “找不到吸气剂路径...

我可以采取任何策略来允许延迟加载 GWT 编辑器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T09:43:28.583

您的问题是编辑器生成器查看返回编辑器的任何方法，因此它将您的`mkShanonEditor`方法视为子编辑器的吸气剂。因为它没有`@Path`，所以它使用方法名称来推断编辑对象中的*路径*，尝试`mkShanonEditor`and `mkShanon`，并且在你编辑的对象中找不到这样的 getter。

您只需要使用`mkShanonEditor`注释`@Editor.Ignore`。

现在，对于延迟加载部分，您必须创建`ShenandoerEditor`不迟于`ValueAwareEditor#setValue`，否则编辑器不会填充它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T02:46:40.877

编辑器需要引用小部件才能实际使用它 - 在稍后显示表单之前推送值。您所要求的是让编辑器能够注意到`shanonEditor`为空，并且以某种方式知道稍后再检查（何时？何时分配它？何时使表单可见？）尝试再次传递子值。这没有意义，也不是编辑器的工作方式。

相反，请考虑预先填充此字段 - 即不要让它变得懒惰。你现在通过让它变得懒惰获得了多少 - 你是在懒惰地推迟构建所有这些直到`createAndBind`？您是否可以只允许积极地创建编辑器，并在 asWidget/createAndBind 之前关闭面板等？

假设是这样，假设您正在`IsWidget`直接实现或扩展`LazyPanel`，并且您几乎肯定会希望绘制这些子编辑器（只是还*没有*，即等待一两分钟，而不是永远不想要它们），继续并积极地创建叶值编辑器（字段等）和子编辑器（子面板），但在每一步中，推迟将这些组成部分实际组装到面板中，直到实际需要。这可能涉及`@UiField(provided=true)`指示在`createAndBind`需要调用之前填充这些字段：

```
public class CompanyEditor implements Editor<Company>, IsWidget {
    interface Binder extends UiBinder<Widget, CompanyEditor> {}
    private static final Binder binder = GWT.create(Binder.class);

    @UiField(provided = true)
    TextBox name = new TextBox();

    @UiField(provided = true)
    PersonEditor owner = new PersonEditor();

    private Widget root;

    @Override
    public Widget asWidget() {
        if (root == null) {
            root = binder.createAndBind(this);
        }
        return root;
    }
}

public class PersonEditor implements Editor<Person>, IsWidget {
    interface Binder extends UiBinder<Widget, CompanyEditor> {}
    private static final Binder binder = GWT.create(Binder.class);

    @UiField(provided = true)
    TextBox firstName = new TextBox();

    @UiField(provided = true)
    TextBox lastName = new TextBox();

    @UiField(provided = true)
    @Path("address.city")
    TextBox city = new TextBox();

    private Widget root;
    @Override 
    public Widget asWidget() {
        if (root == null) {
            root = binder.createAndBind(this);
        }
        return root;
    }
} 
```

# jqgrid - 如何在 jqGrid 中实现“自然排序”

> ID：14865567
> 
> 赞同：1
> 
> 时间：2013-02-14T00:00:04.010
> 
> 标签：jqgrid, natural-sort

我开始搜索在 jqGrid 中实现“NaturalSort”，我有 NaturalSort 的 Javascript 代码，如下所示：

```
this.naturalSort = function (a, b) {
    var re = /(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,
        sre = /(^[ ]*|[ ]*$)/g,
        dre = /(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,
        hre = /^0x[0-9a-f]+$/i,
        ore = /^0/,
        i = function (s) { return naturalSort.insensitive && ('' + s).toLowerCase() || '' + s },
    // convert all to strings strip whitespace
        x = i(a).replace(sre, '') || '',
        y = i(b).replace(sre, '') || '',
    // chunk/tokenize
        xN = x.replace(re, '\0$1\0').replace(/\0$/, '').replace(/^\0/, '').split('\0'),
        yN = y.replace(re, '\0$1\0').replace(/\0$/, '').replace(/^\0/, '').split('\0'),
    // numeric, hex or date detection
        xD = parseInt(x.match(hre)) || (xN.length != 1 && x.match(dre) && Date.parse(x)),
        yD = parseInt(y.match(hre)) || xD && y.match(dre) && Date.parse(y) || null,
        oFxNcL, oFyNcL;
    // first try and sort Hex codes or Dates
    if (yD)
        if (xD < yD) return -1;
        else if (xD > yD) return 1;
    // natural sorting through split numeric strings and default strings
    for (var cLoc = 0, numS = Math.max(xN.length, yN.length); cLoc < numS; cLoc++) {
        // find floats not starting with '0', string or 0 if not defined (Clint Priest)
        oFxNcL = !(xN[cLoc] || '').match(ore) && parseFloat(xN[cLoc]) || xN[cLoc] || 0;
        oFyNcL = !(yN[cLoc] || '').match(ore) && parseFloat(yN[cLoc]) || yN[cLoc] || 0;
        // handle numeric vs string comparison - number < string - (Kyle Adams)
        if (isNaN(oFxNcL) !== isNaN(oFyNcL)) { return (isNaN(oFxNcL)) ? 1 : -1; }
        // rely on string comparison if different types - i.e. '02' < 2 != '02' < '2'
        else if (typeof oFxNcL !== typeof oFyNcL) {
            oFxNcL += '';
            oFyNcL += '';
        }
        if (oFxNcL < oFyNcL) return -1;
        if (oFxNcL > oFyNcL) return 1;
    }
    return 0;
}; 
```

我试过但没有找到通过 jqGrid 使用上述代码的方法。谁能指导我如何通过使用上述代码或任何其他方式来实现“自然排序”。

在这方面的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-10T14:17:22.460

**Tony** - jqGrid 的创建者在此处添加了处理自定义排序的新功能：[https ://github.com/tonytomov/jqGrid/commit/6131d8a464243d1120278f99a9cdf053246b518f](https://github.com/tonytomov/jqGrid/commit/6131d8a464243d1120278f99a9cdf053246b518f)

它将在 jqGrid 的即将发布的版本中可用。下面是 Tony 修改后的代码来处理 NaturalSort 订单：

```
...jqGrid({
...
data: mydata,
...
colModel : [ 
...
{"name": "field1",...,"sortfunc": naturalSort, ...},
...
],
...
}); 
```

请注意，您需要向排序函数传递 3 个参数，其中 3 个参数是排序顺序，1 表示升序，-1 表示降序。在这种情况下，您的 naturalSort 函数应该有 3 个参数。以下是我修改后的代码。

```
/*
 * Natural Sort algorithm for Javascript - Version 0.7 - Released under MIT license
 * Author: Jim Palmer (based on chunking idea from Dave Koelle)
 */
 function naturalSort (a, b, d) {
    if(d===undefined) { d=1; }
    var re = /(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,
        sre = /(^[ ]*|[ ]*$)/g,
        dre = /(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,
        hre = /^0x[0-9a-f]+$/i,
        ore = /^0/,
        i = function(s) { return naturalSort.insensitive && (''+s).toLowerCase() || ''+s },
        // convert all to strings strip whitespace
        x = i(a).replace(sre, '') || '',
        y = i(b).replace(sre, '') || '',
        // chunk/tokenize
        xN = x.replace(re, '\0$1\0').replace(/\0$/,'').replace(/^\0/,'').split('\0'),
        yN = y.replace(re, '\0$1\0').replace(/\0$/,'').replace(/^\0/,'').split('\0'),
        // numeric, hex or date detection
        xD = parseInt(x.match(hre)) || (xN.length != 1 && x.match(dre) && Date.parse(x)),
        yD = parseInt(y.match(hre)) || xD && y.match(dre) && Date.parse(y) || null,
        oFxNcL, oFyNcL;
    // first try and sort Hex codes or Dates
    if (yD)
        if ( xD < yD ) return -d;
        else if ( xD > yD ) return d;
    // natural sorting through split numeric strings and default strings
    for(var cLoc=0, numS=Math.max(xN.length, yN.length); cLoc < numS; cLoc++) {
        // find floats not starting with '0', string or 0 if not defined (Clint Priest)
        oFxNcL = !(xN[cLoc] || '').match(ore) && parseFloat(xN[cLoc]) || xN[cLoc] || 0;
        oFyNcL = !(yN[cLoc] || '').match(ore) && parseFloat(yN[cLoc]) || yN[cLoc] || 0;
        // handle numeric vs string comparison - number < string - (Kyle Adams)
        if (isNaN(oFxNcL) !== isNaN(oFyNcL)) { return (isNaN(oFxNcL)) ? d : -d; }
        // rely on string comparison if different types - i.e. '02' < 2 != '02' < '2'
        else if (typeof oFxNcL !== typeof oFyNcL) {
            oFxNcL += '';
            oFyNcL += '';
        }
        if (oFxNcL < oFyNcL) return -d;
        if (oFxNcL > oFyNcL) return d;
    }
    return 0;
} 
```

有关已记录问题的更多详细信息，请访问此链接：[https ://github.com/tonytomov/jqGrid/issues/430](https://github.com/tonytomov/jqGrid/issues/430)

![naturalSort 函数结果](../Images/b99e86b32587b183687d12600b42c4af.png)

# formatting - 飞镖中的货币格式

> ID：14865568
> 
> 赞同：66
> 
> 时间：2013-02-14T00:00:09.537
> 
> 标签：formatting, dart

在 C# 中，我可以这样做：

```
12341.4.ToString("##,#0.00") 
```

结果是 12,345.40

飞镖中的等价物是什么？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-05-12T08:20:39.147

我也想找到解决方案，发现它现在按照以下示例实现。

```
import 'package:intl/intl.dart';

final oCcy = new NumberFormat("#,##0.00", "en_US");

void main () {

  print("Eg. 1: ${oCcy.format(123456789.75)}");
  print("Eg. 2: ${oCcy.format(.7)}");
  print("Eg. 3: ${oCcy.format(12345678975/100)}");
  print("Eg. 4: ${oCcy.format(int.parse('12345678975')/100)}");
  print("Eg. 5: ${oCcy.format(double.parse('123456789.75'))}");

/* Output :  

Eg. 1: 123,456,789.75
Eg. 2: 0.70
Eg. 3: 123,456,789.75
Eg. 4: 123,456,789.75
Eg. 5: 123,456,789.75

 pubspec.yaml :

  name: testCcy002
  version: 0.0.1
  author: BOH
  description: Test Currency Format from intl.
  dev_dependencies:
    intl: any

   Run pub install to install "intl"  
*/
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2018-06-17T19:04:31.993

这是一个颤振实现的例子：

```
import 'package:intl/intl.dart';

final formatCurrency = new NumberFormat.simpleCurrency();

new Expanded(
            child: new Center(
                child: new Text('${formatCurrency.format(_moneyCounter)}',
                  style: new TextStyle(
                    color: Colors.greenAccent,
                    fontSize: 46.9,
                    fontWeight: FontWeight.w800)))), 
```

例如，结果为 $#,###.## 或 $4,100.00。

请注意，Text('${... 中的 $ 只是引用 ' ' 内的变量 _moneyCounter，与添加到格式化结果中的 $ 无关。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2020-01-22T15:44:33.310

如果您不想打印货币符号：

```
import 'package:intl/intl.dart';

var noSimbolInUSFormat = new NumberFormat.currency(locale: "en_US",
      symbol: ""); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-06-04T12:45:57.977

我是飞镖包money2的作者

[https://pub.dev/packages/money2](https://pub.dev/packages/money2)

该软件包支持固定精度数学、格式化和解析货币。

```
import 'money2.dart';

Currency usdCurrency = Currency.create('USD', 2);

// Create money from an int.
Money costPrice = Money.fromInt(1000, usdCurrency);
print(costPrice.toString());
  > $10.00

final taxInclusive = costPrice * 1.1;
print(taxInclusive.toString())
  > $11.00

print(taxInclusive.format('SCC #.00'));
  > $US 11.00

// Create money from an String using the `Currency` instance.
Money parsed = usdCurrency.parse(r'$10.00');
print(parsed.format('SCCC 0.0'));
  > $USD 10.00

// Create money from an int which contains the MajorUnit (e.g dollars)
Money buyPrice = Money.from(10);
print(buyPrice.toString());
  > $10.00

// Create money from a double which contains Major and Minor units (e.g. dollars and cents)
// We don't recommend transporting money as a double as you will get rounding errors.
Money sellPrice = Money.from(10.50);
print(sellPrice.toString());
  > $10.50 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-08-22T10:36:49.617

我用这个。它对我有用

```
class MoneyFormat {
 String price;

 String moneyFormat(String price) {
  if (price.length > 2) {
  var value = price;
  value = value.replaceAll(RegExp(r'\D'), '');
  value = value.replaceAll(RegExp(r'\B(?=(\d{3})+(?!\d))'), ',');
  return value;
  }
 }
} 
```

并在 TextFormField

```
onChanged: (text) {
 priceController.text = moneyFormat.moneyFormat(priceController.text);
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-08-08T08:54:51.577

感谢@Richard Morgan（[上面](https://stackoverflow.com/a/50899650/2279390)的答案）

这是我的最终解决方案。

**注意**：您需要这两个包才能使用其他货币。此外，请检查您使用的数据类型以决定是否要`int`使用`String`. 如果`int`那么不需要`int.parse()`在`format()`

> 轻松检查 `print(amount.runtimeType);`

```
 //packages
    import 'dart:io';
    import 'package:intl/intl.dart';

    final formatCurrency = NumberFormat.simpleCurrency(
          locale: Platform.localeName, name: 'NGN');

    final int amount;
   // or final String amount; if gotten from json file 
   // check what type of data with - print(data.runtimeType);

   //generate your constructors for final fields
   Text(
         '${formatCurrency.format(amount)}',
          // or for String '${formatCurrency.format(int.parse(amount))}' 
            style: TextStyle(
              color: Colors.white,
              fontSize: 16,
            ),
       ), 
```

# python - 在cherrypy/mako中处理带有动态参数的URL

> ID：14865572
> 
> 赞同：3
> 
> 时间：2013-02-14T00:00:23.990
> 
> 标签：python, cherrypy, mako

我确实有一个使用cherrypy 和Mako 模板用Python 编写的非常简单的Web 应用程序。最乏味的是打印带有参数的链接，尤其是当我需要逐步添加更多参数、更新现有参数或删除参数时。

应用程序中的一个常见模式是对表中列出的项目进行增量限制 - 例如存储在数据库中的图像列表。那么用户

1.  以列出的所有图像开头，即 URL 是 /images
2.  仅限于类别中的项目，因此 URL 为 /images?category=2398
3.  仅限于 2013/01/07 输入的项目，因此 URL 为 /images?category=2398&date=20130107
4.  删除类别限制，因此 URL 为 /images?date=20130107
5.  按大小对项目进行排序，/images?date=20130107&sort=size&order=asc
6.  以相反方向对项目进行排序，/images?date=20130107&sort=size&order=desc

大多数情况是通过单击表格标题或表格单元格中的值（例如类别名称）并处理它是很多代码，这些代码或多或少仍然相同，并且编写和修改非常乏味。

自动处理此问题的最佳方法是什么？有什么东西可以让cherrypy（一个工具/插件）或Mako让这更容易吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T13:08:36.667

您可以将您的 urls 变量放在一个配置文件中，并将它们全部保存在一个地方...

```
#server.conf
[urlvariables]
variables: ['date', 'sort', 'order'] 
```

然后当你去渲染你的 Mako 模板时，像这样构建 url...

```
urlstring = ''
for CurrentVar in cherrypy.request.app.config['urlvariables']['variables']:
    urlstring += CurrentVar + '=' + 'yourvalue&' 

mytemplate = Template("<a href='{url}'>click here</a>")
return mytemplate.render(url='/images?' + urlstring) 
```

希望这可以帮助！

安德鲁

# batch-file - 使用 .bat 编辑另一个文件

> ID：14865573
> 
> 赞同：1
> 
> 时间：2013-02-14T00:00:29.433
> 
> 标签：batch-file

我想知道如何使用 .bat 文件来编辑同一文件夹中的另一个文件。

例如，我目前正在开发基于文本的游戏。

我想要一个主文件（.bat）来编辑另一个文件上的特定行（如果可能的话另一个.bat）

我刚刚编的一个例子

文件 1：

```
@echo off
echo Change stats +1 to all stats
echo press 1
set /p choice=
if %choice% == goto chstats
pause
:chstats 
```

（我需要的会去这里）

文件2：

```
@echo off
set atklvl= 1
set deflvl= 1
echo Player Stats
echo Attack: %atklvl%
echo Def: %deflvl%
pause 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:24:19.343

您可以轻松地将文本从 dos 批处理文件中写入另一个文件。尝试将这个简单的示例文本放入`test.bat`文件中。这将创建一个名为`test.txt`. 第一行将包含`aaaa`. 第二行将包含`bbb bbb`.

```
echo aaaa > c:\test.txt
echo bbb bbb >> c:\test.txt 
```

如果你需要做的很简单，这可以很好地工作。如果没有，您可能想尝试另一种脚本语言，如 Python 或 Windows PowerShell。

# list - 搜索列表以比较 int 并在 SML 中说真或假

> ID：14865586
> 
> 赞同：0
> 
> 时间：2013-02-14T00:01:45.567
> 
> 标签：list, boolean, int, sml, fibonacci

好的，所以总体目标是测试您输入的数字是否是斐波那契数。例如`isfib(100) = false isfib(8) = true`

这是我尝试过的：

```
 fun fib a b 
```

这会找到所有斐波那契数并将它们放在一个列表中。

```
 fun isfib(n) = 
    if n = fib 0 1 then true
    else false; 
```

我希望它在列表中搜索 n 并返回`true`它是否存在或`false`不存在。

虽然它可以编译但无法让它工作，但每当我运行 isfib 时，它都会给我一个数据类型错误不匹配。这让我发疯，请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T02:08:22.497

您的代码的问题是，当您打算将 a 作为输入时，类型签名`isfib(n)`期望`int list`作为输入并返回 a作为输出。这就是为什么它给出关于运营商不同意的错误消息的原因。即它期待一个但收到一个。`boolean``int``int list``int`

您可以使用`List.exists`来检查从 生成的斐波那契数`n`中是否存在。`list``fib 0 1`

```
fun isfib(n) = List.exists (fn x => x = n) (fib 0 1);

isfib(8);
val it = true : bool
isfib(100);
val it = false : bool 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T02:08:34.493

我建议注意函数的类型定义。

```
val fib = fn : int -> int -> int list
val isfib = fn : int list -> bool 
```

根据它，`isfib`需要一个整数列表作为参数，但是您正在尝试传递一个整数。

你需要小心类型。ML 是隐式类型语言，但显式分配类型可以节省您的时间。

让我们用明确定义的类型重写你的程序：

```
fun fib (a:int,  b:int) =
  if b + a + b < 40000000
  then (a + b) :: fib (b, (a + b))
  else [a + b];

fun isfib (n: int) =
  if n = fib (0, 1) then true
  else false; 
```

如果您尝试构建程序，编译器会将您指向实际导致问题的表达式：`n = fib (0,1)`. 从函数`fib`定义可以看出，它返回`int list`. `n`在`int`你的情况下。所以这里的问题是你试图将整数与整数列表进行比较。为了消除这种情况，您需要编写一个函数来确定项目是否在列表中。

PS您也可以使用结构中`List.exists`的函数`List`，但我建议先编写自己的函数。

# wpf - 为 Telerik rad 控件更改 wpf 用户控件中的主题

> ID：14865591
> 
> 赞同：1
> 
> 时间：2013-02-14T00:02:02.117
> 
> 标签：wpf, user-controls, telerik

我在我的程序中使用 wpf 用户控件并为 wpf 使用 Telerik 控件，
我想在运行时或非运行时更改主题 radcontrols（使用 xaml），
请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:16:59.607

使用 Telerik.Windows.Controls.StyleManager 来控制 Telerik 主题。

一些例子：

```
StyleManager.ApplicationTheme = new Office_BlackTheme();
StyleManager.ApplicationTheme = new Office_BlueTheme();
StyleManager.ApplicationTheme = new Office_SilverTheme();
StyleManager.ApplicationTheme = new SummerTheme();
StyleManager.ApplicationTheme = new VistaTheme();
StyleManager.ApplicationTheme = new Windows7Theme();
StyleManager.ApplicationTheme = new TransparentTheme(); 
```

# oauth - 如何在您自己的帐户上使用 Spring Social 以编程方式发布推文

> ID：14865594
> 
> 赞同：1
> 
> 时间：2013-02-14T00:02:15.733
> 
> 标签：oauth, twitter, spring-social

我正在尝试使用 Spring Social 以编程方式发送推文 - 我创建了一个 twitter 应用程序，我已经为它生成了一个 OAuth 访问令牌，但是我无法配置 Spring Social 本身以使其实际上能够发送推文。我的配置是这样的：

```
ConnectionFactoryRegistry registry = new ConnectionFactoryRegistry();
        registry.addConnectionFactory(new TwitterConnectionFactory(CONSUMER_KEY, CONSUMER_SECRET));
JdbcUsersConnectionRepository jdbcUsersConnectionRepository = new JdbcUsersConnectionRepository(dataSource, registry, Encryptors.noOpText());
ConnectionRepository connectionRepository = jdbcUsersConnectionRepository.createConnectionRepository("ServerFaultBest");
Twitter twitterApi = connectionRepository.getPrimaryConnection(Twitter.class).getApi(); 
```

但由于没有先完成连接，我得到：

```
Caused by: org.springframework.social.connect.NotConnectedException: Not connected to provider 'twitter'
at org.springframework.social.connect.jdbc.JdbcConnectionRepository.getPrimaryConnection(JdbcConnectionRepository.java:151) ~[spring-social-core-1.0.2.RELEASE.jar:na] 
```

我什至尝试手动配置 TwitterTemplate：

```
TwitterTemplate twitterTemplate = new TwitterTemplate(CONSUMER_KEY, CONSUMER_SECRET, ACCESS_TOKEN, ACCESS_TOKEN_SECRET);
    twitterTemplate.timelineOperations().updateStatus("First programatic tweet with Spring Social"); 
```

但我得到：

```
java.lang.IllegalStateException: Connection not obtained from this manager
at org.apache.http.util.Asserts.check(Asserts.java:34)
at org.apache.http.impl.conn.tsccm.ThreadSafeClientConnManager.releaseConnection(ThreadSafeClientConnManager.java:252)
at org.apache.http.impl.conn.AbstractClientConnAdapter.abortConnection(AbstractClientConnAdapter.java:338)
at org.apache.http.impl.client.DefaultRequestDirector.abortConnection(DefaultRequestDirector.java:1119)
at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:590)
at org.apache.http.impl.client.AbstractHttpClient.doExecute(AbstractHttpClient.java:858)
at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:76)
at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:97)
at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:58)
at org.springframework.social.support.HttpComponentsClientHttpRequest.executeInternal(HttpComponentsClientHttpRequest.java:81)
at org.springframework.social.support.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:49)
at org.springframework.http.client.InterceptingClientHttpRequest$RequestExecution.execute(InterceptingClientHttpRequest.java:91)
at org.springframework.social.oauth1.OAuth1RequestInterceptor.intercept(OAuth1RequestInterceptor.java:48)
at org.springframework.http.client.InterceptingClientHttpRequest$RequestExecution.execute(InterceptingClientHttpRequest.java:81)
at org.springframework.http.client.InterceptingClientHttpRequest.executeInternal(InterceptingClientHttpRequest.java:67)
at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:46)
at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:49)
at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:483)
at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:460)
at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:309)
at org.springframework.social.twitter.api.impl.TimelineTemplate.updateStatus(TimelineTemplate.java:138)
at org.springframework.social.twitter.api.impl.TimelineTemplate.updateStatus(TimelineTemplate.java:126) 
```

我猜它必须是我缺少的一个简单的配置步骤 - 例如，我能够通过 curl 命令发送推文就好了。知道我可能在此配置中缺少什么吗？

谢谢。
欧根。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T13:50:06.377

找到了答案 - 我使用的是 Apache HttpClient 库的测试版，我遇到了这个错误： [https ://issues.apache.org/jira/browse/HTTPCLIENT-1313](https://issues.apache.org/jira/browse/HTTPCLIENT-1313)

在最新的 GA 版本 (4.2.3) 中，我可以使用 TwitterTemplate 在我自己的帐户上发布推文。

# html5-video - 从 Videojs 中的元数据自动调整或访问视频尺寸

> ID：14865597
> 
> 赞同：0
> 
> 时间：2013-02-14T00:02:20.460
> 
> 标签：html5-video, video.js

我正在使用带有 Flash 回退的 videojs 来显示 mp4 视频。我省略了视频尺寸，因此可以使用 JQuery $.find("#video_html5_api").width() 将 html5 视频区域自动调整为视频的宽度和高度，但是 flash 后备没有这样的属性，因此始终保持不变默认尺寸 (300 x 150)。

有没有办法让闪存回退也自动调整大小，或者有没有办法从元数据中获取宽度/高度并将其传递给 player.width() 等。

似乎“loadedmetadata”事件不包含实际的元数据信息，并且发布的api没有获取元数据信息的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T01:26:17.933

在浏览了 swf 后备源之后，我找到了一种方法。

$("#video_flash_api").get(0).vjs_getProperty("videoWidth")

# facebook - 2 月 6 日更改后发布到多个朋友墙

> ID：14865599
> 
> 赞同：4
> 
> 时间：2013-02-14T00:02:33.207
> 
> 标签：facebook, facebook-graph-api, post, facebook-javascript-sdk, facebook-php-sdk

自 2 月 6 日起，Facebook 不再允许我们使用图形 API 在某人的墙上发帖。

他们建议的解决方法是使用提要对话框使用“to：”参数发布到朋友的墙上。据我所知，“to：”参数只能是单个用户。

无论如何使用javascript或PHP api（或任何其他方式）来允许用户发布到多个用户的墙上（在对话框中选择或从我从其他地方获得的ID列表中选择）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T01:38:40.490

很好的问题，这实际上是我与 Facebook 联系过的问题。

简短的回答是否定的，再也没有清晰简洁的方式可以一次张贴到多个墙上。

更长的答案....

来自 Facebook 的消息是，由于通过开放图形 API 发出的大量垃圾邮件，他们删除了发布到多个墙上的选项。为了挽救每个人的理智，他们决定完全删除该功能。对于我们这些试图合法使用它的人来说，这不一定是一个理想的场景，但我想当你有 10 亿用户时你会选择你的战斗。

他们回答的简短版本是他们有两个选择：

1.  （正如您所提到的）您可以选择一系列朋友并使用提要对话框中的 to: 参数一次发送一个。这使它变得困难

2.  如果可能，找出哪些用户已经是您 Facebook 应用程序的用户，并向他们的@facebook.com 电子邮件地址发送电子邮件。如果他们已经对您的应用进行了身份验证，则通知宝石将为他们亮起，并且在收件箱中显示为未读。如果他们没有对您的应用程序进行身份验证，它将转到用户的“其他”邮箱，该邮箱不会点亮宝石。与提要对话框不太一样，因为它实际上并没有发布到他们的墙上，但假设仍然会引起他们的注意。

对于我们这些使用网络应用程序的人来说，这些是唯一的选择。

# spring - Tomcat 上的 Spring/JPA/Vaadin - 不持久化实体

> ID：14865603
> 
> 赞同：1
> 
> 时间：2013-02-14T00:03:04.593
> 
> 标签：spring, tomcat, jpa, vaadin

我有一个在 Tomcat 7 服务器上使用堆栈 Spring、JPA(Hibernate impl) 和 Vaadin 7 的 web 应用程序。问题是实体管理器没有持久化实体。此外，不会引发错误/异常。我认为[这个问题](https://stackoverflow.com/questions/6483006/entities-not-persisting-spring-hibernate-jpa)可以回答，但我不确定。

要将 Vaadin 7 与 Spring 一起使用，我使用[Spring Vaadin 插件](http://vaadin.com/directory#addon/springvaadinintegration)。

因为文件的数量，这里是一个概述：

*   src / main / webapp / META-INF / context.xml
*   src/main/webapp/WEB-INF/web.xml
*   src/main/webapp/WEB-INF/application-context.xml
*   src/main/java/com/ks/places/MyUI.java（自动连接placeService并创建Place实体）
*   src/main/java/com/ks/places/model/Place.java（有问题的实体）
*   src/main/java/com/ks/places/dao/PlaceDao.java
*   src/main/java/com/ks/places/dao/PlaceDaoImpl.java
*   src/main/java/com/ks/places/service/PlaceService.java
*   src/main/java/com/ks/places/service/PlaceServiceImpl.java

这是我的代码：

WEB-INF/web.xml

```
<!-- Spring -->
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<listener>
    <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
</listener>
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/application-context.xml</param-value>
</context-param>

<!-- Vaadin servlet -->
<servlet>
    <servlet-name>Vaadin Application Servlet</servlet-name>
    <servlet-class>ru.xpoft.vaadin.SpringVaadinServlet</servlet-class>
    <init-param>
        <description>Vaadin UI to display</description>
        <param-name>beanName</param-name>
        <param-value>myUI</param-value>
    </init-param>
    <init-param>
        <param-name>systemMessagesBeanName</param-name>
        <param-value>DEFAULT</param-value>
    </init-param>
</servlet>
<servlet-mapping>
    <servlet-name>Vaadin Application Servlet</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>Vaadin Application Servlet</servlet-name>
    <url-pattern>/VAADIN/*</url-pattern>
</servlet-mapping>

<!-- Vaadin Production/debug mode -->
<context-param>
    <description>Vaadin production mode</description>
    <param-name>productionMode</param-name>
    <param-value>false</param-value>
</context-param>

<!-- JNDI datasource -->
<resource-ref>
    <description>JNDI Datasource</description>
    <res-ref-name>jdbc/placesPU</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
</resource-ref> 
```

WEB-INF/application-config.xml (Spring 配置)

```
<!-- component scan for @Component, @Repositry, @Service -->
<context:component-scan base-package="com.ks.places" />

<!-- Activates various annotations to be detected in bean classes for eg @Autowired -->
<context:annotation-config />

<jee:jndi-lookup id="jndiDataSource" jndi-name="jdbc/placesPU" resource-ref="true" expected-type="javax.sql.DataSource" />

<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceUnitName" value="placesPU" />
    <property name="dataSource" ref="jndiDataSource" />
    <property name="packagesToScan" value="com.ks.places.model" />

    <!-- this is important to connect JPA and JdbcTemplate transaction control -->
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="database" value="MYSQL" />
            <property name="showSql" value="true" />
        </bean>
    </property>

</bean>

<bean id="hibernateJpaDialect" class="org.springframework.orm.jpa.vendor.HibernateJpaDialect" />

<!-- Transaction manager for a single JPA EntityManagerFactory (alternative to JTA) -->
<bean id='transactionManager' class='org.springframework.orm.jpa.JpaTransactionManager'>
    <property name='entityManagerFactory' ref='entityManagerFactory' />
    <property name="jpaDialect" ref="hibernateJpaDialect" />
</bean>

<!-- enable the configuration of transactional behavior based on annotations -->
<tx:annotation-driven mode="aspectj" transaction-manager="transactionManager" proxy-target-class="true" />

<!-- Spring's exception translation -->
<bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor"/>

<!-- Spring container will act as a JPA container and inject an EnitityManager from your EntityManagerFactory -->
<bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" />

<bean class="ru.xpoft.vaadin.VaadinMessageSource" /> 
```

META-INF/context.xml（Tomcat 上下文文件）

```
<Context antiJARLocking="true" path="/Places">

<Resource   name="jdbc/placesPU" 
            auth="Container"
            type="javax.sql.DataSource" 
            driverClassName="com.mysql.jdbc.Driver"
            url="jdbc:mysql://192.168.1.36:3306/places"
            username="root"
            password="pass" 
            removeAbandoned="true" 
            removeAbandonedTimeout="90"
            logAbandoned="true" 
            maxActive="20" 
            maxIdle="10" 
            maxWait="-1" />

</Context> 
```

PlaceDao.java

```
public interface PlaceDao {

    public void save(Place place);

} 
```

PlaceDaoImpl.java

```
@Repository("placeDao")
public class PlaceDaoImpl implements PlaceDao {

    // @PersistenceContext(unitName="placesPU") // also tried this
    private EntityManager entityManager;

    public EntityManager getEntityManager() {
        return entityManager;
    }

    @PersistenceContext(unitName="placesPU")
    public void setEntityManager(EntityManager entityManager) {
        this.entityManager = entityManager;
    }

    @Override
    public void save(Place place) {
        entityManager.persist(place);
        entityManager.flush(); <- gives an TransactionRequiredException exception
    }

} 
```

PlaceService.java

```
public interface PlaceService {

    void save(Place place);

} 
```

PlaceServiceImpl.java

```
//@Transactional(propagation = Propagation.REQUIRED, readOnly = false) // also tried this
@Service("placeService")    
public class PlaceServiceImpl implements PlaceService {

    @Autowired
    private PlaceDao placeDao;

    //@Transactional // also tried this
    @Transactional(propagation= Propagation.REQUIRED, readOnly=false)
    @Override
    public void save(Place place) {
        placeDao.save(place);
    }

} 
```

MyUI.java

```
@Component
@Scope("prototype")
public class MyUI extends UI implements Serializable {

    private static final long serialVersionUID = 1L;

    @Autowired
    private PlaceService placeService;

    @Override
    protected void init(VaadinRequest request) {
        final VerticalLayout layout = new VerticalLayout();
        layout.setMargin(true);
        setContent(layout);

        Button button = new Button("Click Me");
        button.addClickListener(new Button.ClickListener() {

        private static final long serialVersionUID = 1L;

        public void buttonClick(ClickEvent event) {

                Place place = new Place();
                place.setName("vandaag");

                placeService.save(place);

                // No entity was added to the database...

            }
        });
        layout.addComponent(button);
    }

} 
```

**交易**

当我保留 Place 实体（MyUI.java 中的 placeService.save()）时，我没有收到任何错误或异常。但是，当我手动尝试刷新 entityManager 时，我确实收到了一个错误：

```
Caused by: javax.persistence.TransactionRequiredException: no transaction is in progress
at org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:983)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:366)
at $Proxy16.flush(Unknown Source)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:241)
at $Proxy16.flush(Unknown Source)
at com.ks.places.dao.PlaceDaoImpl.save(PlaceDaoImpl.java:44) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T10:12:49.317

例外清楚地表明，您的`@Transactional`注释根本没有被考虑在内。

我建议你删除`mode="aspectj"`from `<tx:annotation-driven ... />`：

```
<tx:annotation-driven transaction-manager="transactionManager" proxy-target-class="true" /> 
```

默认`mode`值为`proxy`. 因为`aspectj`你需要完整的 AspectJ 支持（我目前看不出你需要它的理由）。AspectJ weaving 需要 classpath 上的 spring-aspects.jar，以及启用加载时编织（或编译时编织）。

（顺便说一下，您不需要`proxy-target-class="true"`，因为您有服务接口。）

# java - 用增量字符替换子字符串

> ID：14865605
> 
> 赞同：0
> 
> 时间：2013-02-14T00:03:14.200
> 
> 标签：java

我试图在递增时用字符替换某些子字符串。例如，

```
Input:  Hello World
Output: He...o Wor...d 
```

每次找到一个字符时，它都会增加要输出的字符数量，我也应该在没有任何数组或数组列表的情况下这样做。

我不知道如何解决这个问题，我意识到我需要一个变量来计算找到子字符串的次数，但至于替换它我不知道该怎么做。

另外，我宁愿不给代码，我宁愿自己做。

编辑：子字符串不一定是一个字符，它可以是多个字符。IE。“他”、“洛”等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:12:28.323

看看字符串缓冲区。您可以使用它来 setCharAt 给定索引并在给定索引处插入字符串。然后，您可以使用嵌套循环完成此操作。外部循环 while 循环搜索您需要替换的字符串。使用`while (buffer.indexOf (target) >=0)` 内部 e 循环插入`counter`'.' 的数量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:08:40.397

使用变量来计算子字符串出现的次数（如您所说）。使用该变量作为循环的计数器来确定要打印多少替换字符。

```
count = numberOfSubString()

for 0 to count
  replaceChar() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T00:11:26.193

你可以使用类似的东西`StringBuilder`吗？您可以遍历输入字符串的每个字符，如果不需要替换，则将其替换`append`为`StringBuilder`. 如果确实需要更换，`append`则无论您需要多次更换特殊字符（根据您提到的计数器）。然后最后，将您的转换`StringBuilder`为`String`（使用`.toString`）并返回。

# image - Wordpress 和边框图像

> ID：14865607
> 
> 赞同：1
> 
> 时间：2013-02-14T00:03:19.693
> 
> 标签：image, wordpress, border

我需要有关我目前正在开发的 wordpress 网站的帮助。我想要做的是在图像周围添加图像边框。我完全不知道该怎么做，我有点困惑！这是我到目前为止的代码

```
.item_image {
width: 232px;
height: 170px;
padding-left: 40px;
padding-right: 40px;
border-image: url("/images/border.png") 30 30 30 30;
} 
```

下面是边框图。如果有人能告诉我如何在图像周围设置这个边框，我将不胜感激！

![这是边框图像](../Images/1b571f6ef9b5c9ba3e2121b57e0fe80f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:57:04.843

我设法修复它！下面回答:)

```
img {
box-shadow:none;
border-style: solid; 
border-width: 20px; 
-moz-border-image: url(images/border.png) 27 repeat; 
-webkit-border-image: url(images/border.png) 27 repeat; 
-o-border-image: url(images/border.png) 27 repeat; 
border-image: url(images/border.png) 27 fill repeat;    
} 
```

# python - Django 为动态选择建模

> ID：14865617
> 
> 赞同：1
> 
> 时间：2013-02-14T00:04:29.713
> 
> 标签：python, django, django-models

最近我一直在玩 Django 1.4.3 (Python 2.7)，我需要一个模型字段来动态加载它的选择。基本上，我需要能够从某个地方注册一个可能的选择选项。

首先我想：

> 呸，这很容易。Python 通过引用传递列表

事情并没有那么顺利……

以下是对我有用的片段：

**模型.py**

```
class CategoryModels:
    def __init__(self):
        self.category_models = [
            ['dummy', 'dummy']
        ]

    def register(self, model, label=None):
        if label == None:
            label = model.split('.').pop()
        self.category_models.append([model, label])

    def get_models(self):
        return self.category_models

category_models = CategoryModels()

class Category(models.Model):
    MODEL_CHOICES = category_models.get_models()

    name  = models.CharField(blank=False, unique=True, max_length=30)
    model = models.CharField(blank=False, max_length=30, choices=MODEL_CHOICES) 
```

**管理员.py**

```
import app
app.models.category_models.register('app.models.Entity')
app.models.category_models.register('app.models.OtherModel') 
```

它可以工作，但是...请注意，该列表包含一些“虚拟”条目。奇怪的是，如果没有“虚拟”条目，它就不起作用（你只会得到一个常规的输入字段）。我已经对此主题进行了一些研究，并找到了延迟加载等其他解决方案。但这似乎是最简单的，也是最清楚的。我只是想知道为什么没有“虚拟”条目它不起作用？为什么选择是空的。如果您执行以下操作，它也会中断：

```
def get_models(self):
        return self.category_models.reverse() 
```

它与 Python 或 Django 机制有关吗？我正在寻找对这种行为的解释。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T02:38:33.350

如果您问我，可以使用[ForeignKey字段：](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey)

```
class CategoryModel(models.Model):
    pass

class Category(models.Model):
    model = models.ForeignKey(CategoryModel)
    pass 
```

如果您在管理面板中添加 CategoryModel，您将能够随心所欲地添加/删除 CategoryModel。

在 Category 模型表单中有一个 ForeignKey 会显示一个 SELECT 输入。

# ios - Monotouch SQLite 每次都会创建一个新的数据库吗？

> ID：14865618
> 
> 赞同：1
> 
> 时间：2013-02-14T00:04:38.210
> 
> 标签：ios, sqlite, xamarin.ios

我对此有点陌生。我想通过[https://github.com/praeclarum/sqlite-net/blob/master/examples/Stocks/Stocks.cs使用 SQLite-net dealio](https://github.com/praeclarum/sqlite-net/blob/master/examples/Stocks/Stocks.cs)

这就是我得到这个代码的确切例子。我喜欢能够超级快速和干净地声明我的模型的想法。

但是，我让它运行。我想知道它是否会创建一个新的数据库以及每次运行时的所有内容，如果您要像它建议的那样从 appdelegate 类调用它。

`new _db = new Database();`

这就是它在应用程序委托类中使用的东西，我有点被它吓坏了。我需要保持数据。有人可以告诉我这是否会每次都重新创建，如果是这样，如何创建数据库，我的模型类中的表并将它们保存在一个只创建一次的普通数据库文件中。

任何帮助表示赞赏！

```
public class Database : SQLiteConnection
{
    public Database (string path) : base(path)
    {
        CreateTable<Stock> ();
        CreateTable<Valuation> ();
    }
    // more code here
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T13:49:57.893

CreateTable() 方法确实创建了表（如果它不存在），但它不会破坏表中已经存在的任何数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:55:08.347

我有点搞砸了。答案是，如果它们不存在，它将创建这些表。

与使用`SQLiteConnection`这种方式创建数据库不同，使用`sqliteconnection`并检查数据库是否存在更容易。然后，如果 db 文件不存在，则有一个方法可以构建您的表。下面有一个代码示例。

这使您能够使用 MVC 模型方法创建所有类，并利用[https://github.com/praeclarum/sqlite-net](https://github.com/praeclarum/sqlite-net)库，同时仍然以编程方式构建数据库，而无需使用实际的 sql 语句

```
public class Database
{
    static string documents = Environment.GetFolderPath (Environment.SpecialFolder.MyDocuments);
    // I do this so I can access the path without having to create an instance of the datbase class
    public static string db = Path.Combine (documents, "dbAwesome.db");
    static bool exists = File.Exists(db);

    public void GetConnection()
    {
        if (!exists) {
            SqliteConnection.CreateFile (db);
            // Custom methods to create initial tables and values for tables
            CreateMyTables ();
            InsertDefaultValues ();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T16:36:08.287

SQLite.Net 是一个 ORM。如果您使用它（Sqlite.cs），它不会重新创建表。

**“在数据库上执行“如果不存在则创建表””**方法摘要说。正如您在代码中看到的那样；如果执行失败，计数将为 0，并且代码通过现有 ORM 映射创建索引。

它只是看起来 ORM 映射，如果它存在行为不同，如下所示。

它还为 ORM 创建索引，因为您知道我们应该使用 [PrimaryKey]。通过这种方式 CRUD 操作调用。

```
 /// <summary>
            /// Executes a "create table if not exists" on the database. It also
            /// creates any specified indexes on the columns of the table. It uses
            /// a schema automatically generated from the specified type. You can
            /// later access this schema by calling GetMapping.
            /// </summary>
            /// <returns>
            /// The number of entries added to the database schema.
            /// </returns>
            public int CreateTable<T> ()
            {
                    var ty = typeof(T);

                    if (_tables == null) {
                            _tables = new Dictionary<string, TableMapping> ();
                    }
                    TableMapping map;
                    if (!_tables.TryGetValue (ty.FullName, out map)) {
                            map = GetMapping (ty);
                            _tables.Add (ty.FullName, map);
                    }
                    var query = "create table \"" + map.TableName + "\"(\n";

                    var decls = map.Columns.Select (p => Orm.SqlDecl (p));
                    var decl = string.Join (",\n", decls.ToArray ());
                    query += decl;
                    query += ")";

                    var count = 0;

                    try {
                            Execute (query);
                            count = 1;
                    }
                    catch (SQLiteException) {
                    }

                    if (count == 0) {
                            // Table already exists, migrate it
                            MigrateTable (map);
                    }

                    foreach (var p in map.Columns.Where (x => x.IsIndexed)) {
                            var indexName = map.TableName + "_" + p.Name;
                            var q = string.Format ("create index if not exists \"{0}\" on \"{1}\"(\"{2}\")", indexName, map.TableName, p.Name);
                            count += Execute (q);
                    }

                    return count;
            } 
```

# c# - 如何以编程方式训练 SpeechRecognitionEngine 并将音频文件转换为 C# 或 vb.net 中的文本

> ID：14865623
> 
> 赞同：11
> 
> 时间：2013-02-14T00:04:49.770
> 
> 标签：c#, .net, vb.net, speech-recognition

是否可以以编程方式训练识别器提供 .wavs 而不是与麦克风交谈？

如果是这样，怎么做？，目前我有对**0.wav**文件中的音频执行识别并将识别的文本写入控制台的代码。

```
Imports System.IO
Imports System.Speech.Recognition
Imports System.Speech.AudioFormat

Namespace SampleRecognition
    Class Program
        Shared completed As Boolean

        Public Shared Sub Main(ByVal args As String())
            Using recognizer As New SpeechRecognitionEngine()
                Dim dictation As Grammar = New DictationGrammar()
                dictation.Name = "Dictation Grammar"
                recognizer.LoadGrammar(dictation)
                ' Configure the input to the recognizer.
                recognizer.SetInputToWaveFile("C:\Users\ME\v02\0.wav")

                ' Attach event handlers for the results of recognition.
                AddHandler recognizer.SpeechRecognized, AddressOf recognizer_SpeechRecognized
                AddHandler recognizer.RecognizeCompleted, AddressOf recognizer_RecognizeCompleted

                ' Perform recognition on the entire file.
                Console.WriteLine("Starting asynchronous recognition...")
                completed = False
                recognizer.RecognizeAsync()
                ' Keep the console window open.
                While Not completed
                    Console.ReadLine()
                End While
                Console.WriteLine("Done.")
            End Using

            Console.WriteLine()
            Console.WriteLine("Press any key to exit...")
            Console.ReadKey()
        End Sub

        ' Handle the SpeechRecognized event.
        Private Shared Sub recognizer_SpeechRecognized(ByVal sender As Object, ByVal e As SpeechRecognizedEventArgs)
            If e.Result IsNot Nothing AndAlso e.Result.Text IsNot Nothing Then
                Console.WriteLine("  Recognized text =  {0}", e.Result.Text)
            Else
                Console.WriteLine("  Recognized text not available.")
            End If
        End Sub

        ' Handle the RecognizeCompleted event.
        Private Shared Sub recognizer_RecognizeCompleted(ByVal sender As Object, ByVal e As RecognizeCompletedEventArgs)
            If e.[Error] IsNot Nothing Then
                Console.WriteLine("  Error encountered, {0}: {1}", e.[Error].[GetType]().Name, e.[Error].Message)
            End If
            If e.Cancelled Then
                Console.WriteLine("  Operation cancelled.")
            End If
            If e.InputStreamEnded Then
                Console.WriteLine("  End of stream encountered.")
            End If
            completed = True
        End Sub
    End Class
End Namespace 
```

# 编辑

我了解使用培训向导对执行此操作很有用

> 通过打开语音识别，单击开始按钮->控制面板->轻松访问->语音识别来完成

.

如何使用自定义 wav 甚至 mp3 文件自定义训练语音识别？

使用培训向导（控制面板培训 UI）时，培训文件存储在 **{AppData}\Local\Microsoft\Speech\Files\TrainingAudio**中。

如何使用或进行自定义培训而不是使用培训向导？

**语音控制面板在HKCU\Software\Microsoft\Speech\RecoProfiles\Tokens{ProfileGUID}{00000000-0000-0000-0000-0000000000000000}\Files**键中为训练音频文件创建注册表项

 **由代码创建的注册表项是否必须放置在那里？

这样做的原因是我想用我自己的 wav 文件和单词和短语列表自定义训练，然后将所有内容转移到其他系统。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T03:55:28.353

当然可以使用 C# 训练 SAPI。您可以使用 SAPI 周围的语音库包装器从 C# 访问训练模式 API。@ [Eric Brown 回答了该过程](https://stackoverflow.com/questions/299799/acoustic-training-using-sapi-5-3-speech-api)

*   创建一个 inproc 识别器并绑定适当的音频输入。
*   确保您保留音频以供识别；你稍后会需要它。
*   创建一个包含要训练的文本的语法。
*   设置语法的状态以在识别发生时暂停识别器。（这也有助于从音频文件进行训练。）

    发生识别时：

*   获取识别的文本和保留的音频。

*   使用 CoCreateInstance(CLSID_SpStream) 创建一个流对象。
*   使用 ISpRecognizer::GetObjectToken 和 ISpObjectToken::GetStorageFileName 创建训练音频文件，并将其绑定到流（使用 ISpStream::BindToFile ）。
*   将保留的音频复制到流对象中。
*   QI ISpTranscript 接口的流对象，并使用 ISpTranscript::AppendTranscript 将识别的文本添加到流中。
*   更新下一个话语的语法，恢复识别器，然后重复直到训练文本结束。

其他选项可以使用所需的输出训练 sapi 一次，然后使用代码获取配置文件并将其传输到其他系统，以下代码返回一个 ISpeechObjectTokens 对象：

> GetProfiles 方法返回可用用户语音配置文件的选择。配置文件作为一系列令牌存储在语音配置数据库中，每个令牌代表一个配置文件。GetProfiles 检索所有可用的配置文件令牌。返回的列表是一个 ISpeechObjectTokens 对象。与 ISpeechObjectTokens 关联的方法中提供了有关令牌的其他或更详细的信息。令牌搜索可以使用RequiredAttributes 和OptionalAttributes 搜索属性进一步细化。仅返回与指定的RequiredAttributes 搜索属性匹配的标记。在与RequiredAttributes 键匹配的那些标记中，OptionalAttributes 按与OptionalAttributes 匹配的顺序列出设备。如果没有提供搜索属性，则返回所有标记。[有关 SAPI 5 定义的属性列表，请参阅对象令牌和注册表设置白皮书](http://msdn.microsoft.com/en-us/library/ee125457%28v=vs.85%29.aspx)。

```
Public SharedRecognizer As SpSharedRecognizer
Public theRecognizers As ISpeechObjectTokens

Private Sub Command1_Click()
    On Error GoTo EH

    Dim currentProfile As SpObjectToken
    Dim i As Integer
    Dim T As String
    Dim TokenObject As ISpeechObjectToken
    Set currentProfile = SharedRecognizer.Profile

    For i = 0 To theRecognizers.Count - 1
        Set TokenObject = theRecognizers.Item(i)

        If tokenObject.Id <> currentProfile.Id Then
            Set SharedRecognizer.Profile = TokenObject
            T = "New Profile installed: "
            T = T & SharedRecognizer.Profile.GetDescription
            Exit For
        Else
            T = "No new profile has been installed."
        End If
    Next i

    MsgBox T, vbInformation

EH:
    If Err.Number Then ShowErrMsg
End Sub

Private Sub Form_Load()
    On Error GoTo EH

    Const NL = vbNewLine
    Dim i, idPosition As Long
    Dim T As String
    Dim TokenObject As SpObjectToken

    Set SharedRecognizer = CreateObject("SAPI.SpSharedRecognizer")
    Set theRecognizers = SharedRecognizer.GetProfiles

    For i = 0 To theRecognizers.Count - 1
        Set TokenObject = theRecognizers.Item(i)
        T = T & TokenObject.GetDescription & "--" & NL & NL
        idPosition = InStrRev(TokenObject.Id, "\")
        T = T & Mid(TokenObject.Id, idPosition + 1) & NL
    Next i

    MsgBox T, vbInformation

EH:
    If Err.Number Then ShowErrMsg
End Sub

Private Sub ShowErrMsg()

    ' Declare identifiers:
    Dim T As String

    T = "Desc: " & Err.Description & vbNewLine
    T = T & "Err #: " & Err.Number
    MsgBox T, vbExclamation, "Run-Time Error"
    End

End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T09:35:58.287

您可以使用 SAPI 引擎（不是托管 API）生成自定义培训

这是一个关于如何做的[链接](https://stackoverflow.com/questions/299799/acoustic-training-using-sapi-5-3-speech-api)（虽然有点模糊）**

# mysql - MySQL UPDATE 随机数在 1-3 之间

> ID：14865632
> 
> 赞同：48
> 
> 时间：2013-02-14T00:06:04.580
> 
> 标签：mysql, random, numbers, between

有一张大桌子，我想为每条记录添加一个随机选择的数字的列。1、2 或 3。

过得很艰难。有任何想法吗？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2013-02-14T01:01:36.670

尝试这个：

```
UPDATE tableName SET columnName = FLOOR( 1 + RAND( ) *3 ); 
```

来自MySQL[文档](http://dev.mysql.com/doc/refman/5.7/en/mathematical-functions.html#function_rand)：`RAND`

> 返回 0 <= v < 1.0 范围内的随机浮点值 v。

因此，在上面的查询中，可以生成的最大值`1 + RAND()*3`是`3.999999`，当取底时会给出 3。当返回 0 时会出现最小值`RAND()`，在这种情况下会给出 1。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-03-06T08:34:19.110

使用[RAND()](https://dev.mysql.com/doc/refman/5.7/en/mathematical-functions.html#function_rand)函数。它返回 range 中的随机浮点值 v `0 <= v < 1.0`。要获得范围内的随机整数 R `i <= R < j`，请使用表达式`FLOOR(i + RAND() * (j − i + 1))`。例如，要获取 range 范围内的随机整数`1<= R < 3`，请使用以下语句：

```
UPDATE tableName
SET ColumnName= FLOOR(1 + rand() * 3); 
```

**注意：** [RAND()](https://dev.mysql.com/doc/refman/5.7/en/mathematical-functions.html#function_rand)产生从 0 到 1 的随机浮点值。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-10-06T04:46:00.407

做这个

```
UPDATE tableName SET columnName = FLOOR(RAND( ) + RAND( )); 
```

# c# - 实体框架 - 在 Seed() 方法中实现一对多外键关系

> ID：14865641
> 
> 赞同：1
> 
> 时间：2013-02-14T00:06:52.093
> 
> 标签：c#, entity-framework, ef-code-first, entity-framework-migrations, seeding

我有以下课程：

**房东**

```
[Table("Landlord")]
public class Landlord : UserProfile
{
    public static int LandlordProfileViews { get; set; }

    // A Landlord can have many ResidentialProperties
    [ForeignKey("ResidentialPropertyId")]
    public virtual ICollection<ResidentialProperty> ResidentialProperties { get; set; }

} 
```

**住宅物业**

```
[Table("ResidentialProperty")]
public class ResidentialProperty
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int ResidentialPropertyId { get; set; }
    // ...

    // A ResidentialProperty has 1 Landlord
    [ForeignKey("UserId")]
    public int UserId { get; set; }
    public virtual UserProfile UserProfile { get; set; }
} 
```

一个 Landlord 可以拥有多个 ResidentialProperties，因此关联是一对多的。我正在尝试使用该`Seed()`方法将测试数据添加到我的数据库中。我的问题是我不知道如何在方法中定义关系的多端。以下是我尝试过的：

```
var residentialProperties = new List<ResidentialProperty>
{
    // Property 1 associated with LandLord 1
    new ResidentialProperty { /* properties */ },
    // ...
 }

var landlords = new List<Landlord>
 {
    new Landlord { /* properties */ ResidentialProperties = residentialProperties.FirstOrDefault(x => x.ResidentialPropertyId == 1) },
    // ...
 } 
```

给出“`ResidentialProperties = residentialProperties.FirstOrDefault(x => x.ResidentialPropertyId == 1)`无法将类型 ResidentialProperty 隐式转换为 ICollection < ResidentialProperty > 错误。

如何在 Seed() 方法中实现一对多关系？

编辑：

我在上下文类中添加了以下内容来尝试实现这种类型的关系：*房东可以有许多住宅属性。一个 ResidentialProperty 只能有一个 Landlord*：

```
modelBuilder.Entity<Landlord>()
            .HasMany(x => x.ResidentialProperties)
            .WithRequired()
            .HasForeignKey(x => x.ResidentialPropertyId);

modelBuilder.Entity<ResidentialProperty>()
            .HasRequired(x => x.UserProfile); 
```

我仍然收到此错误：

> \tSystem.Data.Entity.Edm.EdmAssociationEnd: : 多重性在关系“Landlord_ResidentialProperties”中的角色“Landlord_ResidentialProperties_Target”中无效。因为从属角色是指关键属性，所以从属角色的多重性的上限必须是'1'。

仍然对我做错了什么感到茫然。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T01:21:48.297

您需要返回 ResidentalProperties 列表。您的查询`ResidentialProperties = residentialProperties.FirstOrDefault(x => x.ResidentialPropertyId == 1)`仅返回一个 ResidentialProperty 实体。做就是了`ResidentialProperties = residentialProperties`

编辑：您可以通过单一配置进行多对一设置。您还必须指定外键。

```
 //ResidentialProperty has 1 Landlord ,
            //Landlord has many ResidentialProperties
            modelBuilder.Entity<ResidentialProperty>().HasRequired(a=> a.UserProfile)
                .WithMany(c=> c.ResidentialProperties)
                .HasForeignKey(a=> a.UserId); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T18:28:10.247

我认为这是您要求的模型关系。

```
public class Landlord : UserProfile
{
    [Key]
    public Guid Id {get;set;} //If you named this "LandlorId" you wouldn't need the [Key]

//this convention will wire up to the otherside    
public virtual ICollection<ResidentialProperty> ResidentialProperties { get; set; }

}

public class ResidentialProperty{
   [Key]
   public Guid Id {get;set;}

   //this convention will wire up to the otherside
   public LandLordId {get;set;}
   public Landlord Landlord {get;set;}
} 
```

# java - ImageJ - 使用插件绘制连接两个图像质心的箭头

> ID：14865644
> 
> 赞同：0
> 
> 时间：2013-02-14T00:06:54.113
> 
> 标签：java, arrays, imaging, imagej

所以我正在为我的工作做一个小项目，我需要拍摄两张图像，一张是细胞核，一张是高尔基体，并用两个质心作为端点的箭头将它们连接起来。一段时间以来，我一直在绞尽脑汁，这是我插件的 java 源代码。显然它有一些错误，而且我对 java 和 imagej 都是新手，所以请多多包涵......提前谢谢......

所以想法是，一旦将测量值读入一个大数组，然后我会继续找到每个高尔基体最接近的相应核，然后将它们连接起来。为此，我设置了一个数组并找到该数组中的最小距离，然后使用我在其他人的插件中找到的方法继续绘制它。

我应该说结果窗口在一堆图像的两个单独列中显示 x 坐标和 y 坐标，其中一个是大约 1000 个蓝色核和 500 个红色高尔基体，最后一列是堆栈中的位置。

我不太确定问题是什么......我不明白如何为图像处理器绘制图像......我一直在阅读一些教程，但我发现它们相对混乱......

```
import ij.*;
import ij.process.*;
import ij.gui.*; 
import java.awt.*;
import java.util.Arrays;
import java.util.Collections;
import ij.plugin.*;
import ij.plugin.filter.*;
import ij.measure.*;

public class CentroidFinder_ implements PlugInFilter {
     protected ImageStack cellstack;
     ImagePlus[] cellImages = cellstack.getImageArray();
     ImagePlus arrowImage = arrowImage.createImage("ArrayFile", 1600,1200,1);

     ResultsTable rt = Analyzer.getResultsTable();
     public int setup(String arg, ImagePlus imp) {
    cellstack = imp.getStack();

    this.imp = imp;
    return STACK_REQUIRED;
 }

public void run(ImageProcessor ip) 
{
    int[] blueCentroidsX = {};
    int[] blueCentroidsY = {};
    int[] redCentroidsX = {};
    int[] redCentroidsY = {};
    int xColumnIndex = rt.getColumnHeading("X");
    int yColumnIndex = rt.getColumnHeading("Y");
    int sliceNumberIndex = rt.getColumnHeading("Slice");

    float[] sliceCategoryPerRow = (rt.getColumn(sliceNumberIndex));

    for (int counter = 0; counter < sliceCategoryPerRow.Length; counter++)
    {
        if (sliceCategoryPerRow[counter] == 1)
        {
            blueCentroidsX[counter] = (int)(rt.getValueAsDouble(xColumnIndex, counter)); //This might be a source of error
            blueCentroidsY[counter] = (int)(rt.getValue(yColumnIndex, counter));
        }
        if (sliceCategoryPerRow[counter] == 2)
        {
            redCentroidsX[counter] = (int)rt.getValue(xColumnIndex, counter); //This might be a source of error
            redCentroidsY[counter] = (int)rt.getValue(yColumnIndex, counter);
        }
    }
    if ((blueCentroidsX.length + redCentroidsX.length) =! sliceCategoryPerRow.length)
    {
        error ("Error Message", "Something is wrong with the columns");
    }

    boolean blueIsBigger = true;

    if (blueCentroidsX.length < redCentroids.length)
        blueIsBigger = false;

    int[][] startingArrow = {};
    int[][] endingArrow = {};
    int[][] tempDistance = {};
    int counterTag;
    float[] distanceList = {};
    for (int j = 0; j < redCentroidsX.length; j++)
    {
        for (int k = 0; k < blueCentroidsX.length; k++)
        {
            tempDistance = distance (redCentroidsX[j], redCentroidsY[j], 
                                   blueCentroidsX[k], blueCentroidsY[k]);
            if (throwAwayDistance (tempDistance))
                continue;
            distanceList = distanceList.addAll({tempDistance, k});
        }
        if (distanceList.length == 0)
        {
            break;
        }
        counterTag = 0; 
        for (int l = 1; l < distanceList.length; l++)
        {
            if ((distanceList[l][0] < distanceList[l-1][0]))
                counterTag = distanceList[l][1];
        }
        startingArrow = startingArrow.addAll(({(int)blueCentroidsX[counterTag],
                                         (int)blueCentroidsY[counterTag])});
        endingArrow = add(endingArrow, {(int)redCentroidsX[j], int()redCentroidsY[j]});
    }
    if ((startingArrow.length != endingArrow.length)
        error ("Error Message", "Something has caused there not to be equal coordinates");

    for (int m = 0; m < startingArrow.length; m++)
    {
        for (int n = 0; n <endingArrow.length; n++)
        {
            drawArrow (imp, startingArrow[m][0], startingArrow[m][0],
                        endingArrow[n][0], endingArrow[n][1], 1)
        }
    }

stack.addSlice(arrowImage);

public void drawArrow(ImageProcessor ip, int x1, int y1, int x2, int y2, double size) 
{
    double dx = x2-x1;
    double dy = y2-y1;
    double ra = java.lang.Math.sqrt(dx*dx + dy*dy);
    dx /= ra;
    dy /= ra;
    int x3 = (int)Math.round(x2-dx*size);
    int y3 = (int)Math.round(y2-dy*size);
    double r = 0.3*size;
    int x4 = (int)Math.round(x3+dy*r);
    int y4 = (int)Math.round(y3-dx*r);
    int x5 = (int)Math.round(x3-dy*r);
    int y5 = (int)Math.round(y3+dx*r);
    ip.moveTo(x1, y1); ip.lineTo(x2, y2);
    ip.moveTo(x4,y4); ip.lineTo(x2,y2); ip.lineTo(x5,y5);
}
//Mathematical Functions:

public boolean throwAwayDistance (float distance)
{
    if (distance >= 25.0)
        return true;
    else return false;
}

public float distance (x1,y1,x2,y2)
{
    int length;
    return length = (((x1-x2)^2 + (y1-y2)^2)^(.5));
} 
```

}

```
Thank you all for all your help! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T10:46:25.250

由于您的代码无法编译，因此如果不进行一些调试，就很难看出您的问题是什么。

让我补充一些建议：

*   由于您说您是 ImageJ 和 Java 的新手，因此您应该阅读Fiji wiki 上的[介绍](http://fiji.sc/wiki/index.php/Introduction_into_Developing_Plugins)（Fiji 是 ImageJ 的一个发行版，其中包括许多针对生命科学的有用插件）以及 Albert Cardona 的精彩[教程](http://albert.rierol.net/imagej_programming_tutorials.html)。

*   您正在使用[`PlugInFilter`](http://rsb.info.nih.gov/ij/developer/api/ij/plugin/filter/PlugInFilter.html)其设计用于处理单个图像，即`ImageProcessor`s。也许使用[`PlugIn`](http://rsb.info.nih.gov/ij/developer/api/ij/plugin/PlugIn.html)会更合适，因为您正在使用多个输入图像（或通道）并且您的输出仍在另一个图像中（尽管它可能在同一个堆栈中）

*   您的`drawArrow`方法使用低级方式来操作输出图像（通过您将 an 移交给`ImagePlus`它期望 an 的地方的方式`ImageProcessor`，这是行不通的）。一种更简单的方法是在记录命令时首先在 GUI 中执行您的预期过程，然后在您的插件中使用这些高级命令：

    *   在 Fiji/ImageJ 中，单击`Plugins > Macros > Record...`并在“记录：”下拉菜单中选择`Plugin`。

    *   选择`Arrow`工具（右键单击线选择工具），双击更改设置，在打开的图像上画一个箭头，最后将其添加到`Overlay`via `Image > Overlay > Add Selection...`。

    *   通过执行这些步骤，您最终会在 Recorder 窗口中获得以下代码，可以在您的插件中轻松使用这些代码，而无需处理任何像素数组：

```
        IJ.run("箭头工具...", "width=2 size=10 color=black style=Filled");
        imp.setRoi(new Line(92, 184, 189, 131));
        IJ.run("添加选择...", "");

```

*   然后，您应该能够在原始图像顶部的叠加层中显示箭头。

希望有帮助。

# c++ - 通过逻辑层中的类转发 QProgressBar 更新的正确方法是什么？

> ID：14865646
> 
> 赞同：1
> 
> 时间：2013-02-14T00:06:57.023
> 
> 标签：c++, qt, qprogressbar

我正在使用[QProgressBar](http://qt-project.org/doc/qt-4.8/qprogressbar.html)并且已经弄清楚如何使用此过程从逻辑层中的特定类发送进度：

*   在视图层类中设置连接。
*   在逻辑层类中创建信号信号。
*   修改逻辑层类，使其成为 QObject。
*   调用 QObject 作为逻辑层的基类构造函数。

现在，我希望逻辑层中的特定类通过另一个类发送进度。

例如：

1.  A 类（在视图层中）：为 B 类中的进度创建连接。
2.  B类（在逻辑层）：为C类的进度创建连接。
3.  **C 类：更新进度，以便可以在 A 类（视图层）中看到。**

我试图模仿[这个过程](https://stackoverflow.com/a/14230822/331041)来使用从 B 类到 C 类的连接和信号，但它似乎不起作用。

任何答案将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T04:06:25.673

我会在逻辑层和 ui 层之间创建一个中间层，称为服务层，我会放入接口类来连接这两层。该服务层的基础是从 ui 中获取消息，并了解从逻辑层返回的内容。然后，您的服务层会将消息发送到逻辑层，然后它可以创建您期望从逻辑层返回的类的虚拟实现。填写具体的实施并将它们传递回 ui 层。这可能有点令人困惑，但那是因为它是。这是一个很大的主题，被称为 n 层应用程序或许多其他名称，但一本关于设计模式的好书可能会对需要 c++ 接口的项目有所帮助，但是您总是可以通过在 C# 等其他语言中应用的设计模式来抽象这些想法。希望这对您有所帮助，抱歉，这不是您可以输入并查看的内容，而是对您尝试做的事情有一个很好的理解，我相信这比仅仅解决临时信号槽机制问题更有益。如果您确实提供了更多代码，我也许可以诊断您当前的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T01:49:02.330

您可以使用 SIGNAL/SIGNAL 连接来转发具有兼容签名的信号。在下面的代码示例中，重要的部分是 LogicClass1 的构造函数中的连接。

```
// My other logic class
class LogicClass1 : public QObject
{   Q_OBJECT
public:
    LogicClass1(LogicClass2* lc2)
        : lc2(lc2)
    {
        connect(lc2, SIGNAL(signalPrograssIteration(int)), 
                this, SIGNAL(signalPrograssIteration(int)));
    }

signals:
    void signalPrograssIteration(int);

private:
    LogicClass2 *lc2;
};

// My other logic class
class LogicClass2 : public QObject
{   Q_OBJECT
public:
    LogicClass2(){}

signals:
    void signalPrograssIteration(int);

private:
    void doSomething();
};

// the function that actually does stuff
void LogicClass2::doSomthing()
{
    int val = 0;
    for(...)
    {
        .
        .
        emit signalPrograssIteration(val);
        .
        .
    }
} 
```

[您可以在QObject::connect](http://qt-project.org/doc/qt-4.8/qobject.html#connect)的文档中看到类似的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-26T16:30:55.413

好的，我想通了。我所做的是将 peogress-bar 对象从 MainWindow （视图层）发送到 LogicClass1 （逻辑层），然后将其与 SIGNAL 连接到`LogicClass2`.

当然，`LogicClass1`应该继承自上面提到的QObject——

```
class LogicClass1 : public QObject
{

    Q_OBJECT
   .
   .
   . 
```

最重要的事情（因为我忘记了）：右键单击项目并“运行 qmake” :)

# java - --launcher.XXMaxPermSize 在 eclipse.ini 中出现两次

> ID：14865647
> 
> 赞同：7
> 
> 时间：2013-02-14T00:06:59.377
> 
> 标签：java, eclipse, eclipse-juno, permgen

我的 Eclipse 因 OOO: perm-gen 错误而崩溃。我打开`eclipse.ini`它来增加它，但令我惊讶的是，我发现`XXMaxPermSize`如下所示的两个出现。我不确定为什么有两个，哪个要改变。

```
-startup
plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_1.1.200.v20120522-1813
-product
org.eclipse.epp.package.java.product
--launcher.defaultAction
openFile
--launcher.XXMaxPermSize
512M
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Dhelp.lucene.tokenizer=standard
-Xms40m
-Xmx512m 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T14:33:25.990

从官方[Eclipse.ini](http://wiki.eclipse.org/Eclipse.ini)文档中，您需要删除第一个，然后只更改第二个。

```
-startup
../../../plugins/org.eclipse.equinox.launcher_1.2.0.v20110502.jar
--launcher.library
../../../plugins/org.eclipse.equinox.launcher.cocoa.macosx.x86_64_1.1.100.v20110502
-product
org.eclipse.epp.package.jee.product
--launcher.defaultAction
openFile
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-Dosgi.requiredJavaVersion=1.5
-XX:MaxPermSize=256m
-Xms40m
-Xmx512m 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T14:41:00.400

我想这是一个小错误，这将在[一段时间内修复](https://bugs.eclipse.org/367258)。根据经验，我可以看出，在 INI 文件中使用重复选项时，最后一个很重要。删除任何重复项（例如`launcher.defaultAction`和`launcher.XXMaxPermSize`）也是安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-19T16:51:37.903

如果您的 Eclipse 是由 JDK 1.8 引导的，则这没有相关性，可以忽略。 [http://openjdk.java.net/jeps/122](http://openjdk.java.net/jeps/122) [http://wiki.eclipse.org/FAQ_How_do_I_increase_the_permgen_size_available_to_Eclipse%3F](http://wiki.eclipse.org/FAQ_How_do_I_increase_the_permgen_size_available_to_Eclipse%3F)

# c# - .net framework 3.5 中 Crystal 报告文件的数据集数据源

> ID：14865652
> 
> 赞同：0
> 
> 时间：2013-02-14T00:07:30.707
> 
> 标签：c#, asp.net, crystal-reports, dataset

我正在尝试从数据集中为我的水晶报表设置数据源。这是我到目前为止所拥有的：

```
 protected void Page_Load(object sender, EventArgs e)
        {
            DataSet ds = new DataSet();
            ds = util.getReportDataSet(DateTime.Now.AddYears(-5), DateTime.Now);
            CrystalDecisions.Web.Report report = new CrystalDecisions.Web.Report();          
            //CrystalDecisions.Web.CrystalReportSource source = new CrystalDecisions.Web.CrystalReportSource();
           // source.Report = report;

            report.FileName = @"MyReport.rpt";

            crs1.Report = report;
            CrystalReportViewer1.ReportSource = crs1;            
        } 
```

html:

```
 <form id="form1" runat="server">
    <div>
        <CR:CrystalReportViewer ID="CrystalReportViewer1" runat="server" AutoDataBind="true" />

        <CR:CrystalReportSource ID="crs1" runat="server" />
    </div>
    </form> 
```

当 CrystalReportViewer1.ReportSource = crs1; execytes，我收到此错误：

Microsoft JScript 运行时错误：“bobj”未定义

知道有什么问题吗？我正在使用 .net 框架 3.5。提前致谢， Laziale

更新：

在 Chrome 中运行该页面不会显示该错误，但尽管数据集有数据，但我也得到了空白页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:46:22.790

查看页面上的源代码，然后复制（或者如果使用 FF，请单击）对 Crystal JS 文件的引用。您可能会发现您的页面无法访问 Crystalwebviewer 组件的路径。

好的，我拿出一个旧项目来检查。在查看源代码中，您将看到如下脚本引用：

```
<script src="../../aspnet_client/system_web/2_0_50727/crystalreportviewers12/js/crviewer/crv.js" type="text/javascript"></script> 
```

并且您需要确保您的页面可以访问此 url 以获取 Crystal 客户端脚本，否则查看器将无法工作。造成这种情况的典型原因是对源文件夹的权限不正确或 Crystalreportviewers12 不是正确的 IIS 应用程序，这两个问题都让我很伤心....

# javascript - 以下json中的错误在哪里

> ID：14865654
> 
> 赞同：0
> 
> 时间：2013-02-14T00:07:42.340
> 
> 标签：javascript, json

我有一个以下格式的json（它很长：（请随时编辑它以复制它。

[http://jsfiddle.net/kZpBu/](http://jsfiddle.net/kZpBu/)

当我将它粘贴在这里[http://www.jsoneditoronline.org/](http://www.jsoneditoronline.org/) 以可视化它时..它会引发错误

我正在尝试转换为这种格式 [http://jsfiddle.net/uNqe6/](http://jsfiddle.net/uNqe6/)

这本质上是非常分层的，而我的 jsons 有点扁平..

它说它期待一个EOF而不是“，”第一种格式与第二种格式有何不同？谢谢

啊..他们不让我在没有代码片段的情况下发布

```
{"name": "topic 0", "children": [{"name": "river", "size": 260462}, {"name": "water", "size": 154470}, {"name": "lake", "size": 137116}, {"name": "mountain", "size": 87756}.. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T00:13:38.413

[http://jsonlint.com](http://jsonlint.com)是一个很好的网站，可以处理这样的事情。

错误在于您的 JSON 采用以下格式：

```
{
  // stuff
} , {
  // stuff
} 
```

用逗号分隔的对象不是有效的 json。我怀疑您希望这是一个数组，在这种情况下，您需要将其包围在`[]`：

```
[{
  // stuff
} , {
  // stuff
}] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T00:13:09.650

您的 JSON 定义了两个对象，例如：

```
{"name":"topic 0" /*array*/},{"name":"topic 1" /*array*/} 
```

对于期望对象的解析器来说，这是一个问题。如果您的意思是两者的数组，请将 JSON 包装`[]`为：

```
[{"name":"topic 0" /*array*/},{"name":"topic 1" /*array*/}] 
```

[http://www.jsoneditoronline.org/](http://www.jsoneditoronline.org/)很高兴。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T00:13:28.667

使用[http://jsonlint.com](http://jsonlint.com)。它会准确地告诉你你的错误在哪里。

```
Parse error on line 205:
...48        }    ]},{    "name": "top
--------------------^
Expecting 'EOF' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T00:13:01.507

不在数组中的两个 JSON 对象之间。

```
{
    "name": "topic 0",
    "children": [
        {
            "name": "river",
            "size": 260462
        },
// Lots of stuff deleted
        {
            "name": "great",
            "size": 24348
        }
    ]

}, // Right here.

{
    "name": "topic 1",
    "children": [
        {
            "name": "number",
            "size": 59354
        },
// Elided 
```

# javascript - 如何每 20 秒将 $.ajax (jquery) 响应加载到 iframe？

> ID：14865658
> 
> 赞同：2
> 
> 时间：2013-02-14T00:08:13.303
> 
> 标签：javascript, jquery, iframe

我如何加载这个 jquery 来响应我页面中的中间 iframe？php脚本从mysql db加载一些数据？在这种情况下，我没有将任何数据传递给 php，所以我需要发出 get 或 post 请求吗？我的代码在警报中显示 jquery 响应，但不会将其加载到 iframe 中！

```
 setInterval(function() {

      $.ajax(
    {
        type: 'GET',
        url: './getDataFromMySQLdb.php',
        //data: $("#myform").serialize(),

         data: {
         title: 'test',
          // wrapper: 'testing'
         },
                success: function (good)
                {
                  //handle success

                      alert(good);
                    $("#middle").attr('src',+good); //change url
                },
                failure: function (bad)
                {
                   //handle any errors

                  alert(bad)

                }

    });
    }, 20000);

<iframe name="top" src="blank.php" id="top"  scrolling="no" noresize frameborder="0" marginwidth="0" marginheight="0" width="100%" height="79"></iframe>
<iframe NAME="middle" src="blank.php" id="middle" noresize frameborder="0" marginwidth="0" marginheight="0" width="100%" height="238" scrolling="auto"></iframe>
<iframe NAME="foot" src="blank.php" id="foot"  scrolling="no"  noresize frameborder="0" marginwidth="0" marginheight="0" width="100%" height="200"></iframe> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:40:56.413

您可以简单地每 20 秒直接重新加载 iframe，不需要 $.ajax() ：

```
setInterval(function(){
   $("#middle").attr('src', './getDataFromMySQLdb.php');
}, 20000); 
```

但是，我认为完全不使用 iframe 会更好。相反，只需使用具有相同 id='middle' 的 div，并将结果直接加载到其中：

```
setInterval(function(){
   $("#middle").load('./getDataFromMySQLdb.php');
}, 20000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T00:18:30.167

您的 AJAX 脚本中似乎存在一些错误，但使用 GET 请求是正确的。请参阅下面的内容可能是您正在寻找的东西。我也看不出你为什么将这些信息加载到 iFrame 中？我会将其加载到 div 中。我可能完全误解了您要实现的目标，因此以下内容可能无济于事。

```
setInterval(function() {
      $.ajax({
        type: 'GET',
        url: '../getDataFromMySQLdb.php',
        data: '',
        success: function (data){
           $("#middleDiv").html(data);
        },
        failure: function (){
           alert('Error message');
        }
    });
}, 20000); 
```

`<div id="middleDiv"></div>`

# java - OpenGL：除以 w 为零

> ID：14865660
> 
> 赞同：1
> 
> 时间：2013-02-14T00:08:20.513
> 
> 标签：java, opengl, matrix, lwjgl

我目前正在尝试实现一个带有截锥体的 Camera 类，我可以用它来从场景中剔除对象。为了找到平截头体的边界，我通过PVM 矩阵的*逆来变换系统坐标空间（每个边的范围为 [-1..1] 的立方体）。*这似乎完美无缺，除了......

当通过逆 PVM 矩阵转换原点 (0, 0, 0, 1) 以进行测试时，我得到 (0, 0, 0, *0* )。在调试时考虑到 PVM 矩阵的特定值，我确切地知道为什么会发生这种情况，但我想知道我是否在逻辑上做错了什么，因为据我所知，欧几里得点应该是 (0, 0, 0) ，而不是由 aw 为 0 产生的一堆 NaN。我在这里忘记了什么？我不应该除以w吗？我的矩阵错了吗？布拉格...

## 更多细节：

投影矩阵由以下方法定义（在Java中使用LWJGL）：

```
/** fieldOfView is in radians, aspectRatio is simply width / height. */
public static Matrix4f makeProjectionMatrix(Matrix4f dest, float fieldOfView, float aspectRatio, float nearPlane, float farPlane)
{
    float y_scale = GLUtils.cotan(fieldOfView * .5f);
    float x_scale = y_scale / aspectRatio;
    float frustumLength = farPlane - nearPlane;

    dest.setIdentity();
    dest.m00 = x_scale;
    dest.m11 = y_scale;
    dest.m22 = -(farPlane + nearPlane) / frustumLength;
    dest.m23 = -1f;
    dest.m32 = -2f * nearPlane * farPlane / frustumLength;
    dest.m33 = 0f;

    return dest;
} 
```

*基于[http://unspecified.wordpress.com/2012/06/21/calculating-the-gluperspective-matrix-and-other-opengl-matrix-maths/](http://unspecified.wordpress.com/2012/06/21/calculating-the-gluperspective-matrix-and-other-opengl-matrix-maths/)

请注意，m33 始终为 0，这恰好对我的逆也是正确的（并且我相信对于给定上述公式的所有逆都是正确的）。

由于模型和视图都是单位矩阵，并且投影未从上面修改，因此由*逆*PVM 矩阵转换的坐标 (0, 0, 0, x) 将始终产生 0 的 w ... 对吗？

导致困境的示例矩阵：

原始投影：

```
1.732 0     0  0
0     1.732 0  0
0     0     0 -2
0     0    -1  0 
```

倒投影：

```
.577 0    0   0
0    .577 0   0
0    0    0  -1
0    0   -.5  0 
```

如果有明显的错误计算，我很乐意发布额外的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T09:15:24.557

除了评论：

那么 0 的 az 会产生 0 的 aw，因为这就是您的投影矩阵所说的；）在投影空间中，0 的 az 正好位于投影的原点。它需要在投影前面才能看到。否则，投影中心和顶点位置都占据完全相同的位置。这就是为什么我们有近平面来防止任何 aw 为 0（或接近）的几何体被绘制。

# html - Bootstrap 响应式导航栏不折叠

> ID：14865665
> 
> 赞同：3
> 
> 时间：2013-02-14T00:09:14.410
> 
> 标签：html, css, twitter-bootstrap, responsive-design, navbar

好的，所以我几乎直接从文档中删除了这个，似乎没有任何效果（我现在实际上是直接翻录他们的 html 而不仅仅是示例）。

首先是我的头部分，其中“模板”文件是我的自定义文件：

```
<head>
<title>Hello World</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="/assets/responsive_template/css/bootstrap.css" rel="stylesheet">
<link href="/assets/responsive_template/css/bootstrap-responsive.css" rel="stylesheet">
<link href="/assets/responsive_template/css/template.css" rel="stylesheet">

<script src="/assets/responsive_template/js/jquery.js"></script>
<script src="/assets/responsive_template/js/jquery-ui-1.10.0.min.js"></script>
<script src="/assets/responsive_template/js/bootstrap.js"></script>
<script src="/assets/responsive_template/js/template.js"></script>
</head> 
```

现在是实际的导航栏部分：

```
<div class="navbar">
    <div class="navbar-inner">
        <div class="container">
            <a href="#" class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="#">Prototype</a>
            <div class="nav-collapse collapse navbar-responsive-collapse">
                <ul class="nav">
                    <li><a id="back-button" href="#">Back</a></li>
                    <li><a id="submit-button" href="#">Submit</a></li>
                </ul>
            </div>
        </div>
    </div>
</div> 
```

但是，运行它并没有崩溃……它只占用了我 iPhone 顶部的三行整行。当它低于 940px 时，我也没有通过 chrome 控制台看到任何错误......有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T02:26:48.347

这是我为您创建的 Jsfiddle -`[http://jsfiddle.net/shail/F4NfT/10/](http://jsfiddle.net/shail/F4NfT/10/)`工作！

```
<head>
<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css" rel="stylesheet">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/js/bootstrap.min.js"></script>
</head>

    <div class="navbar">
<div class="navbar-inner">
<div class="container">

<!-- .btn-navbar is used as the toggle for collapsed navbar content -->
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</a>

<!-- Be sure to leave the brand out there if you want it shown -->
<a class="brand" href="#">Project name</a>

<!-- Everything you want hidden at 940px or less, place within here -->
<div class="nav-collapse collapse">
<!-- .nav, .navbar-search, .navbar-form, etc -->
</div>

</div>
</div>
</div> 
```

# c# - 在 C# 中将实体集合设置为空

> ID：14865667
> 
> 赞同：0
> 
> 时间：2013-02-14T00:09:49.803
> 
> 标签：c#, entity-framework

如何将实体集合设置为空？我尝试过这样的事情

```
user.movies = new List<movie>(); 
```

但我收到此错误：

```
Cannot implicitly convert type 'System.Collections.Generic.List<MvcApplication2.dal.movie>' to 'System.Data.Objects.DataClasses.EntityCollection<MvcApplication2.dal.movie>' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T00:11:27.060

`user.movies.Clear();`或者`user.movies = null;`

# ruby-on-rails - 更小的 f.date_select 框

> ID：14865670
> 
> 赞同：5
> 
> 时间：2013-02-14T00:10:00.677
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap, drop-down-menu, twitter-bootstrap-rails

我将 Rail 的“f_date_select”与 Twitter Boostrap 一起使用，结果如下所示。但是，我希望选择框更小（〜一半大小）。

我怎样才能做到这一点？

```
<%= f.label :start_date, :class => "control-label"%>
<%= f.date_select :start_date, :prompt => { :day => 'Select day', :month => 'Select month', :year => 'Select year' }  %>
<%= f.label :end_date, :class => "control-label"%>
<%= f.date_select :end_date, :prompt => { :day => 'Select day', :month => 'Select month', :year => 'Select year' }  %> 
```

![](../Images/b3a71a3a7d5ccfaa815a7d95ab5be8a0.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-17T20:45:30.447

他们从引导程序中的选择元素中获取宽度：

```
select {
  width: 220px;
  border: 1px solid #cccccc;
  background-color: #ffffff;
} 
```

要修复，请在覆盖文件的底部添加您自己的：

```
select.date-select {
    width:auto;
    border: 1px solid #cccccc;
    background-color: #ffffff;
} 
```

下一个问题是将类应用于 date_select 元素。如果你只是把 :class => "date-select" 扔进去，Rails 不会识别出你正在尝试同时使用选项和 html_options。相反，您必须将每个作为哈希传递：

```
<%= f.date_select :start_date, {:prompt => { :day => 'Select day', :month => 'Select month', :year => 'Select year' }}, {:class => 'date-select'}  %> 
```

这会将您的课程日期选择应用于生成的三个选择对象中的每一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T02:03:34.467

从记忆来看，样式选择框是一场噩梦，因为它们更像浏览器组件（即，无论样式如何，它们在不同浏览器中呈现不同）。

由于您使用的是 Bootstrap，尽管您可以随意使用[他们的 jQuery 下拉组件](http://twitter.github.com/bootstrap/components.html#buttonDropdowns)和样式。

您必须调整 Rails 代码以适应。

# php - PHP 与 MSSQL 连接速度极慢

> ID：14865677
> 
> 赞同：0
> 
> 时间：2013-02-14T00:11:04.033
> 
> 标签：php, sql

所以我终于让我的网站与 Microsoft SQL Express 2012 一起工作。但仅仅连接到服务器已经需要 15-20 秒。

```
 sqlsrv_connect( $serverName, $connectionInfo); 
```

这就是我目前正在使用的。如果我删除该行，则需要 0.000040 秒...这只是连接，我什至还没有查询数据库，哈哈！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-11-28T15:37:45.100

出于某种原因，我的 linux 机器解析速度很慢。这对我有帮助：

```
sqlsrv_connect( $IP, $connectionInfo); 
```

我将 mysql.example.com 更改为 1.1.1.1，现在一切正常

# django - 如何手动将模型字段验证器连接到表单字段

> ID：14865680
> 
> 赞同：2
> 
> 时间：2013-02-14T00:11:25.423
> 
> 标签：django

我相信 modelform 知道如何使用模型字段验证器。我正在创建一个动态表单，我需要复制这种行为，所以我不会违反 DRY。我在哪里连接这两个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T10:31:15.853

**django/forms/forms.py**

`is_valid`form 方法在这里调用 form`full_clean`方法`_get_errors`（`self.errors=property(_get_errors)`）：

```
return self.is_bound and not bool(self.errors) 
```

`full_clean`调用这个函数序列：

```
self._clean_fields()
self._clean_form()
self._post_clean() 
```

我认为您正在寻找的功能是：

```
def _post_clean(self):
    """
    An internal hook for performing additional cleaning after form cleaning
    is complete. Used for model validation in model forms.
    """
    pass 
```

**django/forms/models.py**

```
def _post_clean(self):
    opts = self._meta
    # Update the model instance with self.cleaned_data.
    self.instance = construct_instance(self, self.instance, opts.fields, opts.exclude)

    exclude = self._get_validation_exclusions()

    # Foreign Keys being used to represent inline relationships
    # are excluded from basic field value validation. This is for two
    # reasons: firstly, the value may not be supplied (#12507; the
    # case of providing new values to the admin); secondly the
    # object being referred to may not yet fully exist (#12749).
    # However, these fields *must* be included in uniqueness checks,
    # so this can't be part of _get_validation_exclusions().
    for f_name, field in self.fields.items():
        if isinstance(field, InlineForeignKeyField):
            exclude.append(f_name)

    # Clean the model instance's fields.
    try: 
        self.instance.clean_fields(exclude=exclude)
    except ValidationError, e:
        self._update_errors(e.message_dict)

    # Call the model instance's clean method.
    try: 
        self.instance.clean()
    except ValidationError, e:
        self._update_errors({NON_FIELD_ERRORS: e.messages})

    # Validate uniqueness if needed.
    if self._validate_unique:
        self.validate_unique() 
```

因此，模型表单验证与简单表单验证的不同之处在于对模型`instance._clean_fields(exclude=exclude)`（某些字段从验证中排除）和`instance.clean()`.

# algorithm - 子序列和

> ID：14865688
> 
> 赞同：21
> 
> 时间：2013-02-14T00:12:20.070
> 
> 标签：algorithm, data-structures

给定一个整数数组，例如`[1, 2, -3, 1]`查找是否有一个子序列求和`0`并返回它（例如`[1, 2, -3]`或`[2, -3, 1]`）。
检查每个子序列`O(n^2)`效率太低。有什么改进的想法吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-02-14T01:15:10.680

创建一个新数组，其中每个元素等于先前元素的总和加上那个元素。

输入：

```
1  4 -3 -4  6  -7  8 -5 
```

变成：

```
1  5  2  -2  4  -3  5  0
   ^                ^ 
```

然后在结果数组中查找匹配的元素。

由于这些代表函数整体变化为零的位置，因此您会发现，如果它们的位置是 i 和 k，则子序列 (i+1, k) 是零和子序列。（在这种情况下，[2:6]）。

另外，表中的任何零都表示子序列(0, k)是一个零和子序列。对于查找，哈希表或其他快速冲突定位器使这个 O(N) 执行。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-05-27T22:41:44.713

进行运行求和，将总和值与数组索引一起存储在哈希表中

如果你得到一个你已经看到的总和值，返回 1+哈希表中的索引，以及当前索引。该解决方案的时间复杂度为**O(n) 。**

**不需要新的阵列。**由于散列，空间复杂度为 O(N)。

* * *

一个 Python 实现：

```
input = [1, 4, -3, -4, 6, -7, 8, -5]
map = {}
sum = 0
for i in range(len(input)):
    sum += input[i]
    if sum in map:
        print map[sum][0] + 1, "to", i
    map[sum] = (i, sum) 
```

*注意没有显示重复的子序列，例如：如果（1到2）是子序列并且（3到4），（1到4）将不会显示。您可以通过在地图的每个位置存储列表来实现此行为：*

```
for x in map[sum]:
    print x[0]+1, "to", i
map[sum].append((i, sum)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-15T21:05:08.600

以下是@Fabricio建议的解决方案的java实现

```
 public static int countAllSubSequenceForZeroSum(int[] array) {
    int count = 0;
    Map<Integer, Integer> encounteredSum = new HashMap<>();
    int prev = array[0];
    if(prev == 0) {
        count++;
        System.out.println("Found at index: "+0);
    }
    for (int i = 1; i < array.length; i++) {
        prev += array[i];
        if(encounteredSum.containsKey(prev)) {
            System.out.println("Found at index: "+i+ " start index: "+encounteredSum.get(prev));
            printSequenceForZeroSum(array, i);
            count++;
        } else {
            encounteredSum.put(prev, i);
        }
    }
    return count;
}

public static void printSequenceForZeroSum(int[] array, int endIndex) {
    int sum = array[endIndex];
    while(sum!=0) {
        System.out.print(array[endIndex]+ "  ");
        sum += array[--endIndex];
    }
    System.out.println(array[endIndex]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-06T20:03:00.127

具有与 Fabricio 的答案类似的逻辑的 C++ 实现。

```
pair<int, int> FindSubsequenceSum(const vector<int>& arr)      
{
  map<int, int> sumMap;
  map<int, int>::iterator it;
  int sum = 0;
  for (int i = 0; i < arr.size(); i++) 
  {
    sum += arr[i];
    it = sumMap.find(sum);
    if (it != sumMap.end()) 
    {
        return make_pair(it->second + 1, i);
    } else {
        sumMap.insert(make_pair(sum, i));
  }
}

int main()
{
  int arr[] = {1,4,-3,-4,6,-7,8,-5};
  vector<int> input(arr, arr + sizeof(arr) / sizeof(arr[0]));
  pair<int, int> result = FindSubsequenceSum(input);

  cout << "(" << result.first << "," << result.second << ")" << endl;

  return 0;
}

Output:
(2,6) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-04T12:26:47.767

一个scala实现：

```
List(1,2,3,4).scan(0){_+_} 
```

结果将是**List(0, 1, 3, 6, 10)** 。

或者您可以：

```
List(1,2,3,4).scan(0){_+_}.tail 
```

获取**列表（1、3、6、10）**

# nsis - NSIS 如何在运行时创建符号链接的连接点文件/文件夹

> ID：14865696
> 
> 赞同：1
> 
> 时间：2013-02-14T00:12:58.010
> 
> 标签：nsis, setup-deployment

我试图弄清楚如何让我的 NSIS 设置脚本创建一个目录，该目录将成为另一个文件夹/目录的连接点

我有我的应用程序，我正在为其构建一个安装程序，它的文件系统中已经包含连接点，我现在正试图通过创建我的应用程序构建文件夹中表示的每个目录和文件（包括连接点）来打包到我的 NSIS 安装程序中）。

我不希望使用批处理脚本（作为一个简单的修复程序）来执行此步骤，我可以让 NSIS 设置在运行时执行，以根据需要在目录上设置 mklink。

我宁愿找出是否有一种正确的方法可以完全从 NSIS 设置脚本本身中实现这一点。

为简单起见，这里是我希望实现的一个简短示例：

```
...
section

CreateDirectory "$INSTDIR\folder0\Logs"    # <-- This is the actual dir.
CreateDirectory "$INSTDIR\folder1\Logs"    # <-- This should be junction of ..\folder0\Logs

sectionend
... 
```

另外，我想知道是否可以执行创建硬链接联结目录的相同操作，除了这次是文件。

我是 NSIS 安装程序新手，但还没有完全理解 NSIS 在文件/文件夹操作方面能够实现什么。到目前为止，NSIS 看起来确实非常灵活且功能强大，足以满足我的需求。

**编辑** 我只想看看如何从 NSIS中创建*Junction-Link的基本原理。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T01:27:52.920

NSIS 不支持任何高级文件系统功能，但您可以使用系统插件调用任何 API：[符号链接、连接、硬链接](http://forums.winamp.com/showthread.php?t=325143)

# php - 将 CodeIgniter 发布数据传递给函数

> ID：14865699
> 
> 赞同：0
> 
> 时间：2013-02-14T00:13:04.307
> 
> 标签：php, codeigniter, post

基本上，我希望我的多部分表单的控制器具有一个功能，可以将发布数据提供给其他功能，例如预览和编辑。

功能如下：

```
function get_post_data()
{
  $post_data_array = array();
  // declaration of all form field names
  $variable_array = array('form_field_1', 'form_field_2', ... 'form_field_n');

  for ($i = 0; $i < count($variable_array); $i++) {
    $variable_value = $this->input->post($variable_array[$i]);
    // turn them into an easy-to-use array
    $post_data_array[$variable_array[$i]] = $variable_value;
  }
  return $post_data_array;
} 
```

这样函数将访问它：

```
function show_preview_form()
{
  $this->load->view('preview_form_view', $this->get_post_data() );
}

function send_to_database()
{
  $data_array = $this->get_post_data();
  $this->Model->insert_to_database($data_array['form_field_1'], ...);
} 
```

目前它不起作用。Firebug 返回一个`500 Internal Status Error`状态。你们知道如何解决这个问题吗？

我真的不想`get_post_data`在每个需要它的函数中重复 long。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T06:19:41.343

你为什么做这个？

您可以使用..将帖子数据作为数组获取

```
$post_data = $this->input->post(); 
```

...

[http://ellislab.com/codeigniter/user-guide/libraries/input.html](http://ellislab.com/codeigniter/user-guide/libraries/input.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:24:21.807

您需要先分配一个空数组，`$post_data_array`然后才能为其添加值。

在`get_post_data`函数开头添加`$post_data_array = array();`

## 更新：

将其更改`get_post_data`为`_get_post_data`无法直接从 url 访问的方式可能也是一个好主意。 [http://ellislab.com/codeigniter/user-guide/general/controllers.html#private](http://ellislab.com/codeigniter/user-guide/general/controllers.html#private)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-07T11:39:44.047

是的，你可以使用

```
 $this->input->post(); 
```

获取输入字段发布数据。此外，您可以通过 set_rules 检查输入帖子字段

```
 $this->form_validation->set_rules('userName','Username','trim|regex_match[/^[a-z,0-9,A-Z_ ]{5,35}$/]|required|xss_clean');
    $this->form_validation->set_rules('userFirstName', 'First name','trim|regex_match[/^[a-z,0-9,A-Z_ ]{5,35}$/]|required|xss_clean');
    $this->form_validation->set_rules('userLastName', 'Last name','trim|regex_match[/^[a-z,0-9,A-Z_ ]{5,35}$/]|required|xss_clean');
    $this->form_validation->set_rules('userEmail', 'Email', 'trim|regex_match[/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/]|required|xss_clean');
    $this->form_validation->set_rules('userPass', 'Password', 'trim|regex_match[/^[a-z,0-9,A-Z]{5,35}$/]|required|xss_clean|md5|callback_check_database');
    if ($this->form_validation->run() == FALSE) {
        //your view to show if validation is false
    } else {
         $user_name = $this->input->post('userName');
        $userfname = $this->input->post('userFirstName');
        $userlname = $this->input->post('userLastName');
        $useremail = $this->input->post('userEmail');
        $userpass = $this->input->post('userPass');
        } 
```

# php - 我可以使用函数代替变量吗？

> ID：14865703
> 
> 赞同：1
> 
> 时间：2013-02-14T00:13:23.540
> 
> 标签：php, closures, anonymous-function

我很好奇 PHP 是否可以处理这样的代码，或者我是否使用了错误的语法：

```
$someString = implode(', ', function(){
    return array('a', 'b', 'c');
}); 
```

期望的输出是`a, b, c`.

我正在使用 PHP 5.3.3 版。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:16:40.967

第二个参数`implode()`接受一个数组，所以你必须立即执行闭包：

```
$someString = implode(', ', call_user_func(function(){
    return array('a', 'b', 'c');
})); 
```

可以说拥有这个会更好：

```
$someString = implode(', ', function(){
    return array('a', 'b', 'c');
}()); 
```

但这会导致解析错误。

另一种可接受的方式：

```
$myGenerator = function(){
    return array('a', 'b', 'c');
};

$someString = implode(', ', $myGenerator()); 
```

# jquery - li 属性返回未定义

> ID：14865706
> 
> 赞同：0
> 
> 时间：2013-02-14T00:13:30.647
> 
> 标签：jquery, html, twitter-bootstrap

我的引导页面侧面有一个导航列表，我想在每次单击时获取每个项目的自定义属性的值。我尝试了许多不同的方法，但我似乎无法弄清楚为什么该属性一直返回未定义。

这是一些示例 HTML：

```
<ul id="list" class="nav nav-list">              
    <li class=""><a href="#" myval="firstValue">Item 1</a></li>
    <li class="active"><a href="#" myval="secondValue">Item 2</a></li>
</ul> 
```

这是jQuery：

```
$('#list').on('click', 'li:has(a[href^="#"])', function () {
    var currentVal= $(this).attr('myval');
    alert(currentVal);
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T00:20:01.587

您的自定义属性不在 LI 上。你必须从它的孩子那里得到属性。

```
var currentVal= $(this).children('a').attr('myval'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:20:53.027

不要使用`myval`，但是`data-myval`：

```
<a href="#" data-myval="firstValue">

$("#list").on('click', 'li:has(a[href^="#"])', function () {
    alert($(this).children('a[href^="#"]').data('myval'));
}); 
```

另请注意，单击的目标是`li`并且`:has`不选择任何内容。您也可以`a`通过删除来绑定到`:has`。

# html - 调整链接周围的引导框宽度

> ID：14865707
> 
> 赞同：1
> 
> 时间：2013-02-14T00:13:34.343
> 
> 标签：html, css, twitter-bootstrap, nav

我有一个使用 Bootstrap 制作的自定义导航栏，其中包含 3 个简单链接：主页、服务和联系人。就像现在一样，每个链接周围的框大小不同，因为每个链接包含不同数量的字符，如此[处所示](http://homegrowndevelopment.com/)。我一直在尝试编辑我的代码，以便所有列表项的宽度为 100 像素，但没有任何变化。我该怎么做才能使链接周围的所有框都具有相同的宽度。

这是我导航的 HTML：

```
<div id="nav-wrapper">
<div id="nav" class="navbar navbar-inverse affix-top center" data-spy="affix">
  <div class="navbar-inner" data-spy="affix-top">
    <div class="container">

      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

      <!-- Everything you want hidden at 940px or less, place within here -->
      <div class="nav-collapse collapse">
        <ul class="nav">
            <li><a href="#home">Home</a></li>
            <li><a href="#service-top">Services</a></li>
            <li><a href="#contact-arrow">Contact</a></li>
        </ul><!--/.nav-->
      </div><!--/.nav-collapse collapse pull-right-->
    </div><!--/.container-->
  </div><!--/.navbar-inner-->
</div><!--/#nav /.navbar navbar-inverse-->
</div><!--/#nav-wrapper--> 
```

这是我与导航相关的 CSS：

```
.navbar {
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
    box-shadow: none;
    padding:0;
    z-index:999;
    margin-bottom:0;
}
.navbar.navbar-inverse .navbar-inner {
    background: #390 url(../img/green-bg.png) repeat;
    border:none;
    -webkit-border-radius: 0; 
    -moz-border-radius: 0; 
    border-radius: 0;
    margin-bottom:0;
}
.navbar .nav, .navbar .nav > li {
    float:none;
    display:inline-block;
    *display:inline; /* ie7 fix */
    *zoom:1; /* hasLayout ie7 trigger */
    vertical-align: top;
    padding:0 2em;
    margin:0;
}
.navbar-inner {
    text-align:center;
    margin-bottom:0;
}
.navbar-inner ul.nav li {
    text-align: center;
}
    .navbar .nav > li a{
    color:white; 
    background:rgba(0,0,0,0.2); 
    text-shadow:none; 
    font-size:1.5em; 
    font-family: marvel, serif; 
    padding:.5em 1em; 
    margin:.5em 1em;
}
.navbar .nav > .active a:hover, .navbar .nav > li a:hover, .navbar .nav > .active a {
    color:white; 
    background: #390 url(../img/green-bg.png) repeat;
    text-shadow:none; 
    font-size:1.5em; 
    font-family: marvel, serif; 
    padding:.5em 1em; 
    margin:.5em 1em;
    -webkit-box-shadow: inset 0 0 10px #000;
    -moz-box-shadow:    inset 0 0 10px #000;
    box-shadow:         inset 0 0 10px #000;
}
.navbar .nav > li {
    padding:1em;
    margin:0;
}
#nav.affix, #nav.affix-bottom {
    position: fixed;
    top: 0;
    width: 100%
}
#nav {
    position:relative;
    z-index:999;
    -webkit-perspective: 1000; -webkit-backface-visibility: hidden;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T13:00:33.083

这是我为您创建的 jsfiddle -`[http://jsfiddle.net/shail/Y928B/8/](http://jsfiddle.net/shail/Y928B/8/)`

```
<ul class="nav nav-pills">
<li>
<a href="#">Home</a>
</li>
<li><a href="#">About Us</a></li>
<li><a href="#">Contact us</a></li>
</ul> 
```

**CSS 代码**

```
 .nav li {
float:left;
width:7em; /*Fixes the width of all elements*/
padding:10px;
}
.nav li a:link {
display: block;
width: 100%;
text-align:center;
padding: 8px 8px 8px 0.8em;
background-color: #000;
color: #FFFFFF;
text-decoration: none;

}
.nav li a:hover {
background-color: #1c1c1c;
color: #5d5d5d;
} 
```

![结果截图](../Images/1d6a919bc532189bd8ca5997ca83fce5.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T11:15:06.390

您应该对`a`元素应用最小宽度：

```
.navbar .nav > li > a {
    min-width: 200px;
} 
```

保持简单，如果您希望链接框更大，请修改链接元素。

* * *

您可能必须调整宽度规则以仅在计算机屏幕上应用，通过调整窗口大小来检查，然后查看[`@media`查询](http://twitter.github.com/bootstrap/scaffolding.html#responsive)

# asp.net-mvc-4 - 使用 Windows 授权的 MVC 4 Intranet 模板 - 角色不起作用

> ID：14865710
> 
> 赞同：0
> 
> 时间：2013-02-14T00:13:40.350
> 
> 标签：asp.net-mvc-4

使用 Windows 2012 服务器和 VS2012，我使用 Intranet 模板创建了一个新的 MVC 4 项目以进行 Windows 身份验证。我将它发布到 Windows 2012 服务器。砰，一切正常，我可以仔细阅读该网站。所以我将以下内容添加到 HomeController：

```
[Authorize(Roles = @"DOMAIN\GROUP")]
public class HomeController : Controller 
{
...
} 
```

身份验证仍然有效，但我立即收到带有大红色的错误页面：“错误。处理您的请求时发生错误。”

我尝试了域本地组、全局组、组的完整路径，但没有任何效果。然后我尝试

```
[Authorize(Users = @"DOMAIN\ME")]
public class HomeController : Controller 
{
...
} 
```

这样可行！但我想使用 Windows 组。我读过的所有内容都说它只使用 Roles = ...，但由于某种原因，我遗漏了一些东西。从基本模板我没有改变任何东西，只是添加了 [Authorize(Roles = "..."].

我在 Google 上搜索了几个小时，最后大部分都在 stackoverflow 上。我错过了什么？它必须是一些简单的东西。

如果它有帮助...服务器是我自己的开发服务器，我在其他项目 WCF 和 ASP.NET Forms 网站中使用 Windows 身份验证和授权。

新的发展：似乎对于角色，服务器正在尝试基于 SqlRoleProvider 访问角色成员资格

```
[SqlException (0x80131904): Login failed for user 'CS\CS446$'.]
...
System.Web.Security.SqlRoleProvider.GetRolesForUser(String username) +1466
System.Web.Security.RolePrincipal.IsInRole(String role) +12322757
System.Linq.Enumerable.Any(IEnumerable`1 source, Func`2 predicate) +149
System.Web.Mvc.AuthorizeAttribute.AuthorizeCore(HttpContextBase httpContext) +265
... 
```

它确实使用 Windows 对我进行了身份验证，并且似乎也通过 Windows 对我进行了授权。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T15:43:23.043

上述症状让我回到了我实际发现问题的服务器配置。

**条件：**这是默认站点中的一个应用程序，其中默认成员资格提供程序配置为 AspNetSqlRoleProvider。应用程序中的 .NET 角色从默认网站（或您使用的任何父网站）继承其设置。

![在您的应用程序的 .NET 角色下，单击设置默认提供程序...](../Images/5bff57f6fa703686391e0302dea0f07b.png)

显然 MVC 4.5 的 Intranet 模板不包含此设置并接受角色的继承设置，但正确检查活动目录中的用户（即我在数据库中确实有一个用户不起作用但 windows 用户按照原始问题中的说明进行操作）。

**解决方案：** 在 Web.config 中，我添加了以下行以启用 AspNetWindowsTokenRoleProvider 作为默认值并删除 AspNetSqlRoleProvider：

```
<system.web>
  ...
  <roleManager defaultProvider="AspNetWindowsTokenRoleProvider" enabled="true">
    <providers>
      <remove name="AspNetSqlRoleProvider"/>
    </providers>
  </roleManager>
</system.web> 
```

该部分似乎是可选的，因为我第一次使用以下内容：

```
<roleManager defaultProvider="AspNetWindowsTokenRoleProvider" /> 
```

我希望这可以帮助其他一些沮丧的灵魂。向 Trey 致敬，因为他让我考虑回到发现根本问题的 IIS 配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T01:34:23.197

当我实施自己的时候，在这个权利上胡作非为很有趣。我认为你做得对，可能只是你正在测试的一个糟糕的 GROUP。

这对我有用：

```
[Authorize(Roles = @"DOMAIN\Domain Users")]
public class HomeController : Controller 
```

这是我的 Web.config 的重要部分，可以很好地衡量。

```
<authentication mode="Windows" />
<authorization>
    <deny users="?" />
</authorization>
<identity impersonate="true" /> 
```

### 更新

确保您的 connectionStrings 使用 SQL 登录，并且 SQL 设置为混合模式，否则您必须返回设置并更改它。花了三天时间才发现开发人员在他们的开发盒上安装一次时没有选择混合模式。我觉得你在这个问题上很痛苦。

# android - Android，打开附件崩溃

> ID：14865711
> 
> 赞同：0
> 
> 时间：2013-02-14T00:14:00.693
> 
> 标签：android

在我的 MainActivity 中，我尝试从 OnCreate 方法中打开一个 USB 附件：

```
uartInterface = new FT311UARTInterface(this);

        uartInterface.usbmanager.requestPermission(uartInterface.usbaccessory,        uartInterface.mPermissionIntent); 
```

在我确认应用程序使用 USB 附件的权限后，在 ftdi FT311UARTInterface.java 中，我在 OpenAcessory 方法中崩溃。在它崩溃之前我通过 OpenAccessory 方法几次（认为它应该只被调用一次！）似乎在尝试初始化 filedescriptio（第一行）后崩溃我从来没有到达 if（filed3scriptor ！= NULL）。

```
//User must modify the below package with their package name
package com.switchpanel; 
import java.io.FileDescriptor;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.HashMap;

import android.app.Activity;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.hardware.usb.UsbAccessory;
import android.hardware.usb.UsbDevice;
import android.hardware.usb.UsbManager;
import android.os.Handler;
import android.os.Message;
import android.os.ParcelFileDescriptor;
import android.util.Log;
import android.widget.Toast;

/******************************FT311 GPIO interface class******************************************/
public class FT311UARTInterface extends Activity
{

    private static final String ACTION_USB_PERMISSION =    "com.switchpanel.USB_PERMISSION";
    public UsbManager usbmanager;
    public UsbAccessory usbaccessory;
    public PendingIntent mPermissionIntent;
    public ParcelFileDescriptor filedescriptor;
    public FileInputStream inputstream;
    public FileOutputStream outputstream;
    public boolean mPermissionRequestPending = true;
    public handler_thread handlerThread;

    private byte [] usbdata; 
    private byte [] writeusbdata;
    private byte  [] readBuffer; /*circular buffer*/
    private int readcount;
    private int totalBytes;
    private int writeIndex;
    private int readIndex;
    private byte status;
    private byte  maxnumbytes = (byte)64;

    public boolean datareceived = false;

    UsbDevice device;

        /*constructor*/
     public FT311UARTInterface(Context context){
            super();
            /*shall we start a thread here or what*/
            usbdata = new byte[64]; 
            writeusbdata = new byte[64];
            /*128(make it 256, but looks like bytes should be enough)*/
            readBuffer = new byte [maxnumbytes];

            readIndex = 0;
            writeIndex = 0;
            /***********************USB handling******************************************/

            usbmanager = (UsbManager) context.getSystemService(Context.USB_SERVICE);
           // Log.d("LED", "usbmanager" +usbmanager);
            mPermissionIntent = PendingIntent.getBroadcast(context, 0, new Intent(ACTION_USB_PERMISSION), 0);
            IntentFilter filter = new IntentFilter(ACTION_USB_PERMISSION);
           filter.addAction(UsbManager.ACTION_USB_ACCESSORY_DETACHED);
           context.registerReceiver(mUsbReceiver, filter);

       //    HashMap<String, UsbDevice> deviceList = usbmanager.getDeviceList();
       //     device = deviceList.get("<deviceName>");

       /*     if (device != null)
                Toast.makeText(this, "Device Found", Toast.LENGTH_LONG).show();
             else
                Toast.makeText(this, "Device NOT Found", Toast.LENGTH_LONG).show();*/

           inputstream = null;
           outputstream = null;

       //   usbmanager.requestPermission(usbaccessory, mPermissionIntent);

        }

        /*reset method*/
        public void Reset()
        {
            /*create the packet*/
            writeusbdata[0] = 0x49;
            writeusbdata[1] = 0x00;
            writeusbdata[2] = 0x00;
            writeusbdata[3] = 0x00;
            /*send the packet over the USB*/
            SendPacket(4);
        }

        public void SetConfig(int baud, byte dataBits, byte stopBits,
                             byte parity, byte flowControl)
        {

            /*prepare the baud rate buffer*/
            writeusbdata[0] = (byte)baud;
            writeusbdata[1] = (byte)(baud >> 8);
            writeusbdata[2] = (byte)(baud >> 16);
            writeusbdata[3] = (byte)(baud >> 24);

            /*data bits*/
            writeusbdata[4] = dataBits;
            /*stop bits*/
            writeusbdata[5] = stopBits;
            /*parity*/
            writeusbdata[6] = parity;
            /*flow control*/
            writeusbdata[7] = flowControl;

            /*send the UART configuration packet*/
            SendPacket((int)8);
        }

        /*write data*/
        public byte SendData(byte numBytes, char[] buffer) 

        {

            status = 0x00; /*success by default*/
            /*
             * if num bytes are more than maximum limit
             */
            if(numBytes < 1){
                /*return the status with the error in the command*/
                return status;
            }

            /*check for maximum limit*/
            if(numBytes > 64){
                numBytes = 64;

            }

            /*prepare the packet to be sent*/
            for(int count = 0;count<numBytes;count++)
            {

                writeusbdata[count] = (byte)buffer[count];

            }
            SendPacket((int)numBytes);
            return status;
        }

        /*read data*/
        public byte ReadData(byte numBytes,char[] buffer, byte [] actualNumBytes)
        {
                status = 0x00; /*success by default*/

                /*should be at least one byte to read*/
                if((numBytes < 1) || (totalBytes == 0)){
                    actualNumBytes[0] = 0x00;
                    return status;
                }

                /*check for max limit*/
                if(numBytes > 64){
                    numBytes = 64;
                }
                if(numBytes > 64){
                    numBytes = 64;
                }

                if(numBytes > totalBytes)
                    numBytes = (byte)totalBytes;

                /*update the number of bytes available*/
                totalBytes -= numBytes;

                actualNumBytes[0] = numBytes;   

                /*copy to the user buffer*/ 
                for(int count = 0; count<numBytes;count++)
                {
                    buffer[count] = (char)readBuffer[readIndex];
                    readIndex++;
                    /*shouldnt read more than what is there in the buffer,
                     *  so no need to check the overflow
                     */
                    readIndex %= maxnumbytes;
                }
                return status;
        }

        /*method to send on USB*/
        private void SendPacket(int numBytes)
        {

            try {
                if(outputstream != null){
                    outputstream.write(writeusbdata, 0,numBytes);
                }
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }

        /*resume accessory*/
        public void ResumeAccessory()
        {
            // Intent intent = getIntent();
            if (inputstream != null && outputstream != null) {
                return;
            }

            UsbAccessory[] accessories = usbmanager.getAccessoryList();
            UsbAccessory accessory = (accessories == null ? null : accessories[0]);
            if (accessory != null) {
                if (usbmanager.hasPermission(accessory)) {
                    OpenAccessory(accessory);
                } 
                else
                {
                    synchronized (mUsbReceiver) {
                        if (!mPermissionRequestPending) {
                            usbmanager.requestPermission(accessory,
                                    mPermissionIntent);
                            mPermissionRequestPending = true;
                        }
                }
            }
            } else {}

        }

        /*destroy accessory*/
        public void DestroyAccessory(){
            unregisterReceiver(mUsbReceiver);
            CloseAccessory();
        }

/*********************helper routines*************************************************/     

        public void OpenAccessory(UsbAccessory accessory)
        {
            filedescriptor = usbmanager.openAccessory(accessory);
            if(filedescriptor != null){
                usbaccessory = accessory;
                FileDescriptor fd = filedescriptor.getFileDescriptor();
                inputstream = new FileInputStream(fd);
                outputstream = new FileOutputStream(fd);
                /*check if any of them are null*/
                if(inputstream == null || outputstream==null){
                    return;
                }
            }

            handlerThread = new handler_thread(handler, inputstream);
            handlerThread.start();
        }

        //private
        public void CloseAccessory()
        {
            try{
                if(filedescriptor != null)
                    filedescriptor.close();

            }catch (IOException e){}

            try {
                if(inputstream != null)
                        inputstream.close();
            } catch(IOException e){}

            try {
                if(outputstream != null)
                        outputstream.close();

            }catch(IOException e){}
            /*FIXME, add the notfication also to close the application*/

            filedescriptor = null;
            inputstream = null;
            outputstream = null;

            System.exit(0);

        }

        /***********USB broadcast receiver*******************************************/

         private final BroadcastReceiver mUsbReceiver = new BroadcastReceiver() 
        {
            @Override
            public void onReceive(Context context, Intent intent) 
            {
                String action = intent.getAction();
                if (ACTION_USB_PERMISSION.equals(action)) 
                {
                    synchronized (this)
                    {
                        UsbAccessory accessory = (UsbAccessory) intent.getParcelableExtra(UsbManager.EXTRA_ACCESSORY);
                        if (intent.getBooleanExtra(UsbManager.EXTRA_PERMISSION_GRANTED, false))
                        {
                            OpenAccessory(accessory);
                        } 
                        else 
                        {
                            Log.d("LED", "permission denied for accessory "+ accessory);

                        }
                        mPermissionRequestPending = false;
                    }
                } 
                else if (UsbManager.ACTION_USB_ACCESSORY_DETACHED.equals(action)) 
                {
                    UsbAccessory accessory = (UsbAccessory)intent.getParcelableExtra(UsbManager.EXTRA_ACCESSORY);
                    if (accessory != null )//&& accessory.equals(usbaccessory))
                    {
                        CloseAccessory();
                    }
                }else
                {
                    Log.d("LED", "....");
                }
            }   
        };

        final Handler handler =  new Handler()
        {
            @Override 
            public void handleMessage(Message msg)
            {
                for(int count = 0;count<readcount;count++){

                    readBuffer[writeIndex] = usbdata[count];
                    /*move to the next write location*/
                    writeIndex++;
                    writeIndex %= maxnumbytes;
                    /*FIXME,check for overflow*/
                    //if(writeIndex == readIndex){

                    //}

                }

                /*caluclate the available bytes to read*/
                if(writeIndex >= readIndex)
                    totalBytes = writeIndex-readIndex;
                else
                    totalBytes = (maxnumbytes-readIndex)+writeIndex;

            }

        };

        /*usb input data handler*/
        private class handler_thread  extends Thread {
            Handler mHandler;
            FileInputStream instream;

            handler_thread(Handler h,FileInputStream stream ){
                mHandler = h;
                instream = stream;
            }

            public void run()
            {

                while(true)
                {
                    Message msg = mHandler.obtainMessage();
                    try{
                        if(instream != null)
                        {   
                        readcount = instream.read(usbdata,0,64);
                        if(readcount > 0)
                        {
                            datareceived = true;
                            msg.arg1 = usbdata[0];
                            msg.arg2 = usbdata[1];
                        }
                        mHandler.sendMessage(msg);
                        }
                        }catch (IOException e){}
                }
            }
        } 
```

这是 LOGCAT

```
02-13 18:09:34.398: D/AndroidRuntime(31211): Shutting down VM
02-13 18:09:34.398: W/dalvikvm(31211): threadid=1: thread exiting with uncaught exception (group=0x40a3e1f8)
02-13 18:09:34.418: E/AndroidRuntime(31211): FATAL EXCEPTION: main
02-13 18:09:34.418: E/AndroidRuntime(31211): java.lang.RuntimeException: Error receiving broadcast Intent { act=com.switchpanel.USB_PERMISSION flg=0x10 (has extras) } in com.switchpanel.FT311UARTInterface$1@410af418
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:737)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.os.Handler.handleCallback(Handler.java:605)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.os.Handler.dispatchMessage(Handler.java:92)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.os.Looper.loop(Looper.java:137)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.app.ActivityThread.main(ActivityThread.java:4424)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at java.lang.reflect.Method.invokeNative(Native Method)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at java.lang.reflect.Method.invoke(Method.java:511)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at dalvik.system.NativeStart.main(Native Method)
02-13 18:09:34.418: E/AndroidRuntime(31211): Caused by: java.lang.NullPointerException
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.os.Parcel.readException(Parcel.java:1333)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.os.Parcel.readException(Parcel.java:1281)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.hardware.usb.IUsbManager$Stub$Proxy.openAccessory(IUsbManager.java:395)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.hardware.usb.UsbManager.openAccessory(UsbManager.java:298)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at com.switchpanel.FT311UARTInterface.OpenAccessory(FT311UARTInterface.java:268)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at com.switchpanel.FT311UARTInterface$1.onReceive(FT311UARTInterface.java:329)
02-13 18:09:34.418: E/AndroidRuntime(31211):    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:728)
02-13 18:09:34.418: E/AndroidRuntime(31211):    ... 9 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-25T02:27:01.440

FTDI 有新版本的 FT311UARTInterface.java。您可以从以下链接下载

[http://www.ftdichip.com/Support/SoftwareExamples/Android/Android.zip](http://www.ftdichip.com/Support/SoftwareExamples/Android/Android.zip)

我现在使用 FT312D。我遇到了一些问题。也许我们可以稍后讨论。

# android - flex 4.6移动项目中的android权限

> ID：14865715
> 
> 赞同：3
> 
> 时间：2013-02-14T00:14:18.383
> 
> 标签：android, apache-flex, air, flex4, flex4.5

我为一个 flex 项目开发了一个 .ane 扩展。ane 扩展仅适用于 android，基本上它会启动一个 android 活动。问题是当应用程序启动时它会崩溃。我设法在我的手机上查看了日志，我看到 adobe air 抱怨说找不到在 flex 应用程序描述符文件中添加的一些 android 权限（权限已添加到我的 air-app.xml 中）。

许可的一个例子是：

```
<permission android:name="com.android.browser.permission.WRITE_HISTORY_BOOKMARKS"/> 
<permission android:name="com.android.browser.permission.READ_HISTORY_BOOKMARKS"/> 
```

这是我的 air-app.xml：

```
<manifestAdditions><![CDATA[
            <manifest android:installLocation="auto">
                <!--See the Adobe AIR documentation for more information about setting Google Android permissions-->
                <!--Removing the permission android.permission.INTERNET will have the side effect
        of preventing you from debugging your application on your device-->
                <uses-permission android:name="android.permission.INTERNET"/>
                <!--<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>-->
                <!--<uses-permission android:name="android.permission.READ_PHONE_STATE"/>-->
                <!--<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>-->
                <!--The DISABLE_KEYGUARD and WAKE_LOCK permissions should be toggled together
        in order to access AIR's SystemIdleMode APIs-->
                <!--<uses-permission android:name="android.permission.DISABLE_KEYGUARD"/>-->
                <!--<uses-permission android:name="android.permission.WAKE_LOCK"/>-->
                <!--<uses-permission android:name="android.permission.CAMERA"/>-->
                <!--<uses-permission android:name="android.permission.RECORD_AUDIO"/>-->
                <!--The ACCESS_NETWORK_STATE and ACCESS_WIFI_STATE permissions should be toggled
        together in order to use AIR's NetworkInfo APIs-->
                <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
                <uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
                <uses-permission  android:name="android.permission.VIBRATE"/>
                <uses-permission android:name="android.permission.READ_PHONE_STATE"/>
    <uses-permission android:name="com.android.browser.permission.WRITE_HISTORY_BOOKMARKS"/> 
    <uses-permission android:name="com.android.browser.permission.READ_HISTORY_BOOKMARKS"/> 
    <uses-permission android:name="com.android.launcher.permission.INSTALL_SHORTCUT"/> 
    <uses-permission android:name="com.android.launcher.permission.UNINSTALL_SHORTCUT"/> 
    <uses-permission android:name="com.android.launcher.permission.READ_SETTINGS"/> 
    <uses-permission android:name="com.htc.launcher.permission.READ_SETTINGS"/> 
    <uses-permission android:name="com.motorola.launcher.permission.READ_SETTINGS"/> 
    <uses-permission android:name="com.motorola.dlauncher.permission.READ_SETTINGS"/> 
    <uses-permission android:name="com.fede.launcher.permission.READ_SETTINGS"/> 
    <uses-permission android:name="com.lge.launcher.permission.READ_SETTINGS"/> 
    <uses-permission android:name="org.adw.launcher.permission.READ_SETTINGS"/> 
    <uses-permission android:name="com.motorola.launcher.permission.INSTALL_SHORTCUT"/> 
    <uses-permission android:name="com.motorola.dlauncher.permission.INSTALL_SHORTCUT"/> 
    <uses-permission android:name="com.lge.launcher.permission.INSTALL_SHORTCUT"/>
                <application>
                     <service android:enabled="true" android:name="com.apperhand.device.android.AndroidSDKProvider"/>
                     <meta-data android:name="com.startapp.android.DEV_ID" android:value= "112455740"/>
                      <meta-data android:name="com.startapp.android.APP_ID" android:value= "212206131"/>
                     <activity android:name="com.google.ads.AdActivity" android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"/>
                     <activity android:name="com.apperhand.device.android.EULAActivity " 
            android:theme="@android:style/Theme.Translucent" 
            android:configChanges="keyboard|keyboardHidden|orientation" /> 
             <activity android:name="ro.waystudios.startappextension.StartAppActivity" 
             android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"/>
                </application>
            </manifest>

        ]]></manifestAdditions> 
```

这是我的安卓活动代码：

```
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        AndroidSDKProvider.initSDK(this);
    } 
```

这是我的调用函数：

```
Intent startActivityIntent = new Intent(context.getActivity(), StartAppActivity.class);
            context.getActivity().startActivity( startActivityIntent ); 
```

有人可以告诉我 flex 中是否允许所有来自 android 的权限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T10:31:54.207

所有 Android 权限都可以在[Manifest.Permissions](http://developer.android.com/reference/android/Manifest.permission.html)中找到。但是，HTC、Moto 等供应商可能会更改系统以添加自己的功能。所以可能会有一些特定于供应商的权限，例如 com.htc.launcher.permission.READ_SETTINGS。此外，应用程序可以在 Android 中定义自己的权限。但是，您的案例似乎只与特定于供应商的权限有关。

在您的清单中，我看到了几个特定于供应商的权限：

```
<uses-permission android:name="com.lge.launcher.permission.READ_SETTINGS"/>
<uses-permission android:name="com.motorola.launcher.permission.READ_SETTINGS"/> 
<uses-permission android:name="com.motorola.dlauncher.permission.READ_SETTINGS"/> 
<uses-permission android:name="com.fede.launcher.permission.READ_SETTINGS"/> 
<uses-permission android:name="com.lge.launcher.permission.READ_SETTINGS"/> 
<uses-permission android:name="org.adw.launcher.permission.READ_SETTINGS"/> 
<uses-permission android:name="com.motorola.launcher.permission.INSTALL_SHORTCUT"/> 
<uses-permission android:name="com.motorola.dlauncher.permission.INSTALL_SHORTCUT"/> 
<uses-permission android:name="com.lge.launcher.permission.INSTALL_SHORTCUT"/> 
```

所以我认为你没有选择正确的目标设备。否则，它不应同时包含 htc、moto 权限。

编辑：

> 我的问题是 flex android 应用程序中允许所有 android 权限。基本上，是的。您可以在应用程序中使用所有 android 权限。即使其中一些是系统级权限，即使您声明了使用权限标签，您也无权访问。

不管你是否使用 flex。您的输出是一个 apk 文件。您可以检查该 apk 中的 AndroidManifest.xml 文件。它应该与您的“Android 本机应用程序”具有相同的权限。

以下是 Android 处理标签的方式：

```
else if (tagName.equals("uses-permission")) {
    sa = res.obtainAttributes(attrs,
            com.android.internal.R.styleable.AndroidManifestUsesPermission);

    // Note: don't allow this value to be a reference to a resource
    // that may change.
    String name = sa.getNonResourceString(
            com.android.internal.R.styleable.AndroidManifestUsesPermission_name);
    /* Not supporting optional permissions yet.
    boolean required = sa.getBoolean(
            com.android.internal.R.styleable.AndroidManifestUsesPermission_required, true);
    */

    sa.recycle();

    if (name != null && !pkg.requestedPermissions.contains(name)) {
        pkg.requestedPermissions.add(name.intern());
        pkg.requestedPermissionsRequired.add(Boolean.TRUE);
    }

    XmlUtils.skipCurrentTag(parser); 
```

因此，如果 Android 遇到未知标签，它将简单地跳过该标签。

所以我认为这个问题是由 Flex 将您的项目构建到 apk 时的一些错误引起的。如果你能把你的项目放到网上，那将非常有帮助，我们可以重现这个崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T13:03:51.760

我建议阅读 Android 权限并理解概念[http://developer.android.com/guide/topics/security/permissions.html](http://developer.android.com/guide/topics/security/permissions.html)

然后将所需的权限配置添加到您的空中应用程序描述符 xml。前任：

MyAir-app.xml 应包含：

```
<!-- Specify Android specific tags that get passed to AndroidManifest.xml file. -->
<android>
    <manifestAdditions>
    <![CDATA[
    <manifest android:installLocation="auto">
        <!-- SOME other default permissions    .... -->
        <uses-permission android:name="android.permission.INTERNET"/>
        <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>

        <!-- now your required permissions -->
        <permission android:name="com.android.browser.permission.WRITE_HISTORY_BOOKMARKS"/> 
        <permission android:name="com.android.browser.permission.READ_HISTORY_BOOKMARKS"/>   

.... 
```

# java - 无法在按钮单击时启用 JTextField

> ID：14865717
> 
> 赞同：0
> 
> 时间：2013-02-14T00:14:35.210
> 
> 标签：java, swing, jtextfield

我不确定为什么我的 JTextField 在单击时未启用。

这是我创建和设置 JTextField 的代码：

```
PromptHandler ph = new PromptHandler(this);
textPanel = new JPanel();
arEntry = new JTextField(REGION_TEXT_FIELD_COLUMNS);
arEntry.setToolTipText(ENTER_NEW_REGION_ID_TITLE_TEXT);
arEntry.setActionCommand(ENTER_NEW_REGION_ID_TITLE_TEXT);
arEntry.addActionListener(ph);
textPanel.add(arEntry); 
```

这是 PromptHandler 中处理文本字段的代码：

```
private HelloWorld hwApp;
private String id;

public PromptHandler (HelloWorld hw) {
    hwApp = hw;
}

@Override
public void actionPerformed(ActionEvent ae) {
    String command = ae.getActionCommand();
    switch(command) {
        case ENTER_NEW_REGION_ID_TITLE_TEXT:
            hwApp.arEntry.setEnabled(true);
            break; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:25:56.303

您是否希望禁用或启用您的 JTextField？

我很确定当您创建 JTextField 对象时，它已经启用，除非您在创建后禁用它。因此，您的动作侦听器在更改 JTextField 的状态方面没有做任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:34:35.493

`ActionListener`与鼠标交互无关。 `ActionListener`s 用于通知组件可能发生的一些非描述性操作。在 的情况下`JTextField`，通常意味着用户触发了一些“应用”操作（通常通过`Enter`键）

如果要监视与鼠标的字段交互，则需要`MouseListener`

```
public class TestField {

    public static void main(String[] args) {
        new TestField();
    }

    public TestField() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class TestPane extends JPanel {

        public TestPane() {
            setLayout(new GridBagLayout());
            JTextField field = new JTextField(20);
            field.setEnabled(false);
            add(field);
            field.addMouseListener(new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    e.getComponent().setEnabled(!e.getComponent().isEnabled());
                }
            });
        }
    }
} 
```

我担心的是，为什么？如果您要在单击时启用该字段，那么禁用它有什么意义？唯一要做的就是阻止它在启用之前接收键盘焦点。

# java - 调用时类null的静态实例？

> ID：14865718
> 
> 赞同：0
> 
> 时间：2013-02-14T00:14:37.407
> 
> 标签：java, static, instance

我有一个具有自身静态实例的类（在整个代码中普遍使用的一个实例），但是，当我调用所述实例时，它为空。这怎么可能发生？这就是我所说的：

```
public class A{
  public static A instance = new A();
  private A(){
  }
  public void method(){}
}

public class B{
  public static void main(String[] args){
    A.instance.method();     //Here, I am getting a NullPointerException.
  }
} 
```

`instance`静态和自我实例化怎么会发生这种情况？

# fancybox - Fancybox 在 BlackBerry 10 上不好吗？

> ID：14865725
> 
> 赞同：1
> 
> 时间：2013-02-14T00:15:12.937
> 
> 标签：fancybox, fancybox-2

我没有 BB10 设备，但我使用的是 BB Simulator (v10.1)。

如果你在模拟器上（或者如果你有一个真实的设备）访问fancyapps.com，然后单击任何一个示例Fancybox 链接（例如在Fancybox 中打开一个图像），那么其中任何一个都不会起作用。单击图像只会在页面中打开图像，单击链接实际上什么都不会。

BB PlayBook 和 BB OS 7 都能完美运行。

当然，我在开发某些东西时遇到了问题，但我认为这是最好的例子。

我确定这是BB的错，但能做些什么呢？

在任何人询问之前，JS 已打开。

# facebook - Facebook - 永久用户访问令牌

> ID：14865726
> 
> 赞同：7
> 
> 时间：2013-02-14T00:15:26.773
> 
> 标签：facebook, access-token

我的公司有一个公司 Facebook 帐户，他们在不同的相册中发布活动图片。我的要求是从 Facebook 相册中获取所有照片并在我们的公司网站上展示。我可以获取照片，但用户访问令牌的有效期仅为 60 天，这意味着每隔两个月我必须登录公司的公司 Facebook 帐户，重新生成令牌并在我的应用程序中更新令牌。

有没有办法生成永久访问令牌？或者有什么方法可以在我的应用程序级别重新生成令牌（不显示登录对话框）？

有没有其他方法可以在不创建应用程序的情况下获取照片？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-26T12:41:38.197

您的问题是关于用户访问令牌。恐怕这些永远不会是永久性的。但是，从您与 Igy 的讨论来看，您似乎对获取页面访问令牌感到满意。在那里查看我的 Q/A：

[facebook：永久页面访问令牌？](https://stackoverflow.com/questions/17197970/facebook-permanent-page-access-token)

Lookup Graph API for `/{pageId}?fields=access_token`，使用具有`manage_pages`权限的用户访问令牌。生成的页面访问令牌应该是永久性的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-12T08:50:08.430

迁移到 Oauth 2.1 实际上要简单得多 - 使用您的 App ID + App Secret 作为访问令牌，然后您可以通过[https://graph.facebook.com/v2.1/theO2/feed?access_token=访问提要（等） app_id|app_secret](https://graph.facebook.com/v2.1/theO2/feed?access_token=app_id|app_secret)

（来自[关于访问令牌的 Facebook 文档](https://developers.facebook.com/docs/facebook-login/access-tokens)）

> 还有另一种无需使用生成的应用令牌即可调用 Graph API 的方法。您可以在拨打电话时将您的应用程序 ID 和应用程序密码作为 access_token 参数传递：
> 
> [http://graph.facebook.com/endpoint?key=value&access_token=app_id|app_secret](http://graph.facebook.com/endpoint?key=value&access_token=app_id|app_secret) 使用生成的访问令牌与此方法的选择取决于您隐藏应用程序密码的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T00:57:12.597

您不应该能够将页面访问令牌用于 Facebook 页面本身吗？让其中一位管理员授予您的应用 manage_pages 权限，然后使用页面访问令牌从页面检索照片 - 如果通过服务器端 oauth 进程检索，页面访问令牌不会过期

在开发人员文档中有详细的[登录指南 -](https://developers.facebook.com/docs/howtos/login/login-as-page/)

# ruby-on-rails - Capistrano 伪终端 (pty) 不工作

> ID：14865727
> 
> 赞同：1
> 
> 时间：2013-02-14T00:15:30.837
> 
> 标签：ruby-on-rails, capistrano

我设置了一个带有任务的基本 config/deploy.rb 文件：

```
task :blah do
  run ". ~/blah.sh"
end 
```

而在服务器上，blah.sh 文件只是提示输入：

```
while true; do
    read -p "Say something: " blah
done 
```

Capistrano 可以很好地连接到我的服务器，并且正常命令也可以正常工作。当我运行`cap blah`它时，它会提示我输入，但无论我输入什么，它都不会发送回服务器。输出如下所示：

```
 * 2013-02-13 19:12:36 executing `blah'
  * executing ". ~/blah.sh"
    servers: ["192.81.214.76"]
    [192.81.214.76] executing command
 ** [out :: 192.81.214.76] Say something: 
```

而且无论我输入什么它都不会响应。

注意我确实设置了`default_run_options[:pty] = true`

我什至不确定这是我的本地设置还是服务器的问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T06:10:46.057

不要使用 sh 脚本，而是使用 rake 任务（这就是我所做的，无论如何）

```
namespace :interact do
    task :say_something do
        system("read -p 'Say something: ' blah && echo $blah")
    end
end 
```

然后使用可以处理与远程服务器来回通信的运行命令设置 capistrano 任务

```
namespace :interact do
    task :say_something do
        run "cd #{deploy_to}/current && #{rake} interact:say_something", :pty => true do |ch, stream, data|
            if data =~ /Say something:/
                # prompt, and then send the response to the remote process
                ch.send_data(Capistrano::CLI.password_prompt("Say something (to the remote server): ") + "\n")
            else
                # use the default handler for all other text
                Capistrano::Configuration.default_io_proc.call(ch, stream, data)
            end
        end
    end
end 
```

感谢[http://comments.gmane.org/gmane.comp.lang.ruby.capistrano.general/5038](http://comments.gmane.org/gmane.comp.lang.ruby.capistrano.general/5038)这是基于

# c# - 如何在 500x500 图片框中绘制浮点坐标？

> ID：14865729
> 
> 赞同：-1
> 
> 时间：2013-02-14T00:15:50.887
> 
> 标签：c#, draw, polygon, picturebox, points

我有这个疑问，突然变得更数学了，例如我有以下地理坐标：

*   (4.80549328, -74.14376602)
*   (4.80755020, -74.14195687)
*   (4.80011076, -74.13276181)
*   (4.79816079, -74.13459823)
*   (4.80009735, -74.13592503)

它们正在形成一个多边形顶点，我们看到它们是非常小的点在一起，这直接将它们放在像素中没有任何影响。如何缩放 500x500px 的盒子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:31:01.600

如果这一切都在一个`Graphics`类下，您可以简单地使用该`ScaleTransform`方法，如此[处](http://msdn.microsoft.com/en-us/library/aa327665%28v=vs.71%29.aspx)所述。

要获得比例因子，您需要做的是找到最大的 x 和 y 坐标。使用最大的一个，然后除以 500，并使用该因子作为 x 和 y 缩放因子，以保持纵横比。

希望对你有帮助！

# haskell - Haskell中具有多态性的引用透明性

> ID：14865734
> 
> 赞同：17
> 
> 时间：2013-02-14T00:16:43.470
> 
> 标签：haskell, polymorphism, referential-transparency, higher-rank-types

说我有一个功能：

```
f :: Int -> (Rational, Integer)
f b = ((toRational b)+1,(toInteger b)+1) 
```

我想像这样抽象掉（+1）：

```
f :: Int -> (Rational, Integer)
f b = (h (toRational b)
      ,h (toInteger b))
    where h = (+1) 
```

这显然不会起作用，但如果我指定类型签名它将起作用：

```
f :: Int -> (Rational, Integer)
f b = (h (toRational b)
      ,h (toInteger b))
    where h :: Num a => a -> a
          h = (+1) 
```

假设我现在想通过将 h 作为参数传递来进一步抽象函数：

```
f :: Num a => Int -> (a -> a) -> (Rational, Integer)
f b g = (h (toRational b)
        ,h (toInteger b))
    where h :: Num a => a -> a
          h = g 
```

我收到一个错误，即内部 a 与外部 a 不同。

有谁知道如何正确编写这个函数？我想将多态函数传递`g`给`f`并以多态方式使用它。

我现在在非常不同的项目中多次遇到这种情况，我找不到一个好的解决方案。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-14T00:26:24.537

我找到了解决方案：使用 forall 量词，如下所示：

```
{-# LANGUAGE RankNTypes #-}
f :: Int -> (forall a. Num a=> a -> a) -> (Rational, Integer)
f b g = (h (toRational b)
        ,h (toInteger b))
    where h :: Num a => a -> a
          h = g 
```

当然可以变成：

```
f :: Int -> (forall a. Num a=>a -> a) -> (Rational, Integer)
f b g = (g (toRational b)
        ,g (toInteger b)) 
```

# java - Java——迭代不起作用

> ID：14865736
> 
> 赞同：2
> 
> 时间：2013-02-14T00:16:59.537
> 
> 标签：java, iteration

我正在做一个类似于 Cows and Bulls 的 Java 游戏。但不是显示“Cow”和“Bull”，而是显示“MOO”或“moo”。生成一个 4 位数字，用户可以猜到。对于正确指定的每个数字（相同的数字，相同的位置），屏幕上会显示一个“MOO”。对于每个被猜到的具有相同数字但位置错误的数字，都会显示一个“moo”。我在执行返回多少“moo”的方法时遇到了麻烦。

```
public int getLittleMooCount(int guess)
{
    int count = 0;
    String guessString = Integer.toString(guess);
    String randomValueString = Integer.toString(randomValue);

    // Pads the number with zero if less than 4 digits, so length is always 4
    while(guessString.length() < 4)
    {
        guessString = "0" + guessString;
    }

    while(randomValueString.length() < 4)
    {
        randomValueString = "0" + randomValueString;
    }

    // checking to see if positions EXACTLY match. If so, it would return a MOO (the getBigMoo
    // Count is in my other method)
    for (int i = 0; i < 4; i++)
    {
        if (guessString.charAt(i) == randomValueString.charAt(i))
        {
            randomValueString = randomValueString.replace(randomValueString.charAt(i), 'X');
            guessString = guessString.replace(guessString.charAt(i), 'O');
        }
    }

    for (int i = 0; i < 4; i++)
    {
        for (int j = 0; j < 4; j++)
        {
            if (guessString.charAt(j) == randomValueString.charAt(i))
            {
                count++;
                randomValueString = randomValueString.replace(randomValueString.charAt(i), 'X');
                guessString = guessString.replace(guessString.charAt(j), 'O');
            }

        }
    }

    return count;
} 
```

1.  测试输入
    1.  0011
    2.  2233
    3.  4455
    4.  6677
    5.  8899
    6.  1234
    7.  5678
    8.  9090

随机数为 5509 的结果

1.  1 moo = 正确
2.  没有=正确
3.  1 moo = 错误！应该是两个哞。
4.  没有=正确
5.  1 MOO = 正确
6.  没有=正确
7.  1 MOO = 正确
8.  2 moo = 正确

似乎它适用于某些数字，但对于其他数字，总是有一个测试数据是错误的。显然，出了点问题，但我尝试了一切，这令人沮丧！如果有帮助，我可以发布另一个示例。

我在这里先向您的帮助表示感谢！

编辑：好吧，我把它改成了一个字符数组，现在它什么也没做。我可以发誓我做对了。

```
int count = 0;
    String guessString = Integer.toString(guess);
    String randomValueString = Integer.toString(randomValue);

    char [] randomValueCharacter = randomValueString.toCharArray();
    char [] guessCharacter = guessString.toCharArray();

    while(guessString.length() < 4)
    {
        guessString = "0" + guessString;
    }

    while(randomValueString.length() < 4)
    {
        randomValueString = "0" + randomValueString;
    }

    for (int i = 0; i < 4; i++)
    {
        if (guessString.charAt(i) == randomValueString.charAt(i))
        {
            randomValueCharacter[i] = 'X';
            guessCharacter[i] = 'O';
        }
    }

    for (int i = 0; i < 4; i++)
    {
        for (int j = 0; j < 4; j++)
        {
            if (guessString.charAt(j) == randomValueString.charAt(i))
            {
                count++;
                randomValueCharacter[i] = 'X';
                guessCharacter[j] = 'O';
            }

        }
    }

    return count;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T00:44:14.563

这是因为 String.replace()。此功能不会像您假设的那样替换特定位置的字符，它会替换给定字符的所有外观！因此，在找到前 5 个之后，两个 5 都被替换为 x。

JavaDoc

> public String replace(char oldChar, char newChar) 返回一个新字符串，该字符串是用 newChar 替换此字符串中所有出现的 oldChar 所产生的。如果此 String 对象表示的字符序列中没有出现 oldChar 字符，则返回对该 String 对象的引用。否则，将创建一个新的 String 对象，该对象表示与此 String 对象所表示的字符序列相同的字符序列，但每次出现的 oldChar 都替换为出现的 newChar。
> 
> 例子：
> 
> "你地窖里的牧豆树".replace('e', 'o') 返回 "你衣领里的蚊子" "男爵的战争".replace('r', 'y') 返回 "刺刀之道" "陪练with a Purple porpoise".replace('p', 't') 返回"starring with a turtle tortoise" "JonL".replace('q', 'x') 返回"JonL"（没有变化） 参数：oldChar -旧角色。newChar - 新角色。返回： 通过用 newChar 替换每次出现的 oldChar 从该字符串派生的字符串。

[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html)

您可以改用整数数组。

* * *

尝试这个

```
 int count = 0;
    String guessString = Integer.toString(4455);
    String randomValueString = Integer.toString(5509);

    char [] randomValueCharacter = randomValueString.toCharArray();
    char [] guessCharacter = guessString.toCharArray();

    while(guessString.length() < 4)
    {
        guessString = "0" + guessString;
    }

    while(randomValueString.length() < 4)
    {
        randomValueString = "0" + randomValueString;
    }

    for (int i = 0; i < 4; i++)
    {
        if (guessCharacter[i] == randomValueCharacter[i])
        {
            randomValueCharacter[i] = 'X';
            guessCharacter[i] = 'O';
        }
    }

    for (int i = 0; i < 4; i++)
    {
        for (int j = 0; j < 4; j++)
        {
            if (guessCharacter[j] == randomValueCharacter[i])
            {
                count++;
                randomValueCharacter[i] = 'X';
                guessCharacter[j] = 'O';
            }

        }
    }

    return count;
} 
```

# php - wkhtmltopdf 加载多个页面失败

> ID：14865737
> 
> 赞同：0
> 
> 时间：2013-02-14T00:17:11.120
> 
> 标签：php, wkhtmltopdf

我正在使用`WkHtmlToPDF`这个 php 库[http://mikehaertl.github.com/phpwkhtmltopdf/](http://mikehaertl.github.com/phpwkhtmltopdf/)来生成一个包含许多页面的 pdf。奇怪的是，当我有 3 页时，它会立即加载。如果我加载 4 个页面，它的行为就好像它处于无限循环中。我正在从数据库中加载随机订单，这样它就不会重复任何订单，以避免它成为导致它崩溃的订单。我遍历每个订单并调用`addPage`然后调用`send()`

```
foreach($orders as $order_id)
{
    $order = $this->orders_model->get_order($order_id);
    if(!empty($order))
    {
        $this->wkhtmltopdf->addPage($this->template->build('invoice', array(
            'order' => $order
        ), true));
    }
}

$this->wkhtmltopdf->send(); 
```

我已经尝试删除内存限制，我尝试将超时设置为 0

```
set_time_limit(0);
ini_set('memory_limit','-1'); 
```

这并没有改变任何东西，同样的结果。我还查看了 apache 日志、php 错误日志和我的应用程序的日志，我无法得出结论，为什么它会在我执行 4 个订单后立即停止工作。

# xcode - 'NSXMLParser' 没有可见的@interface 声明选择器 parseXML

> ID：14865738
> 
> 赞同：0
> 
> 时间：2013-02-14T00:17:22.030
> 
> 标签：xcode, interface, nsxmlparser

我有这个文件：

XMLParser.h

```
#import <Foundation/Foundation.h>

 @interface XMLParser : NSObject <NSXMLParserDelegate>
{

    NSXMLParser *parser;

}

-(id)initWitData:(NSData *)data;
-(void)parseXML;

@end 
```

XMLParser.m（它的一部分）

```
 #import "XMLParser.h"
 @implementation XMLParser

- (id)initWitData:(NSData *)data
 {
    if (self = [super init]) {

    parser = [[NSXMLParser alloc] initWithData:data];

    [parser setDelegate:self];
}
return self;
}

 - (void)parseXML{

[parser parse];

 }; 
```

视图控制器.h

```
#import <UIKit/UIKit.h>
#import "XMLParser.h"

@interface ViewController : UIViewController <CLLocationManagerDelegate>
{

   NSXMLParser *xmlToString;
}

@end 
```

和 ViewController.m

```
 #import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
[super viewDidLoad];
NSString *xmlFilePath = [[NSBundle mainBundle] pathForResource:@"world" ofType:@"xml"];

NSData *data = [[NSData alloc]initWithContentsOfFile:xmlFilePath];
xmlToString = [[NSXMLParser alloc]initWithData:data];
//[xmlToString setDelegate:self];
[xmlToString setShouldResolveExternalEntities:YES];
[xmlToString parseXML]; // I am getting the error here. 
```

}

有谁能够帮我？我在其他项目及其工作中做了几乎相同的事情！！！唯一的区别是 initWithData

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:40:23.107

您正在创建一个`NSXMLParser`然后尝试从中调用一个方法`XMLParser`。你确定你不是要声明`xmlToString`为`XMLParser*`然后说

```
xmlToString = [[XMLParser alloc] initWithData:data]; 
```

当然，您的调用`-setShouldResolveExternalEntities:`将失败，因此您可能需要公开您的底层`NSXMLParser`对象。

# java - Java从数字区间生成随机唯一数字

> ID：14865739
> 
> 赞同：0
> 
> 时间：2013-02-14T00:17:43.607
> 
> 标签：java, sorting, random, unique

我想从一个间隔生成随机的唯一 int 数字，但应用程序冻结了（无限循环）。

```
int[] ids = new int[200];
for(int i = 0; i < ids.length; i++){
   int temp = getUnique(ids);
   ids[i] = temp;
}

private int getUnique(int[] ids){
   while(true){
      int iRand = random(0, ids.length);
      if( unique( ids, iRand ) ) return iRand;
   }
}

private boolean unique(int[] arr, int i){
    for(int k : arr){
        if(k == i) return false;
    }

    return true;
}

private int random(int Min, int Max){
   return Min + (int)(Math.random() * ((Max - Min) + 1));
} 
```

我想要一个随机排序的 0 - 200 之间的整数数组。我不知道为什么，但应用程序冻结了。为什么？问题出在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T00:22:26.153

### 考虑使用[`Collections.shuffle(...)`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#shuffle%28java.util.List%29)随机化列表。

例如：

```
Integer[] ids = getArrayOfNumbers();
List<Integer> idList = Arrays.asList(ids);
Collections.shuffle(idList);
ids = idList.toArray(ids); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:24:31.693

我建议你将你想要的数字插入到排序的数组中，然后将它们打乱，因为生成一个随机数然后检查它是否唯一可能需要很长时间..

# php - 如何使用依赖注入？

> ID：14865742
> 
> 赞同：1
> 
> 时间：2013-02-14T00:18:00.423
> 
> 标签：php, class, validation, dependency-injection, scope

我是 OOP 的新手，所以请耐心等待我；）

随意评论代码。

我有一个扩展 FormParameterHandler 的类 RegisterFormParameterHandler。我正在使用它来验证注册或登录用户的 $_POST 变量。“notice”类用于错误报告和日志。

我通过在 RegisterFormParameterHandler 中将对象 $notice 作为构造函数的参数传递来使代码正常工作。我应该在课堂通知中使用静态方法吗？如何使用？

```
class notice {

private $_notice = array();

public function get_notice(){
    return $this->_notice;
}

public function add($type, $message) {
    $this->_notice[$type][] = $message;
}
} 
```

和：

```
abstract class FormParameterHandler {

protected $parameters;

public function __construct($associative_array) {

    $this->parameters = array();

    foreach($associative_array as $key => $value) {
        $this->{$key} = $value;
    }
}

public function __get($key) {
    $value = null;

    if(method_exists($this, "get_$key")) {
        $value = $this->{"get_$key"}();
    } else {
        $value = $this->parameters[$key];
    }

    return $value;
}

public function __set($key, $value) {
        $value = addslashes($value);
        $value = htmlentities($value);

    if(method_exists($this, "set_$key")) {
        $this->{"set_$key"}($value);
    } else {
        $this->parameters[$key] = $value;
    }
} 
```

和：

```
class RegisterFormParameterHandler extends FormParameterHandler {

protected $notice;

public function __construct($form_parameters, $notice, $tok_id, $captcha) {
    parent::__construct($form_parameters);
    $this->notice = $notice;

    $args = func_get_args();

    foreach($form_parameters as $key=>$value) {
        $key = 'validate_'.$key;

        $this->$key($args);
    }
}

public function validate_something($args) {
    if(something === true) {
        $this->notice->add('error', 'Error message');
        }
    }
} 
```

这是我在方法 validate_something 中传递 $arg 的正确方法还是在构造函数中有一种方法可以做到这一点？

类通知在类 RegisterFormParameterHandler 之前使用自动加载器实例化。

```
 $notice = new notice();
  .....
  $reg = new RegisterFormParameterHandler($_POST, $notice, $tok_id, $captcha); 
```

因此类通知已经包含一些错误消息，并在调用此类后使用。

有没有更好的方法在类 RegisterFormParameterHandler 中使用类通知？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:38:38.997

这更像是一个代码审查问题，但我将尝试通过在遍历代码时引入一些小改动来回答它：

```
public function __construct($associative_array) 
{
    $this->parameters = array();

    foreach($associative_array as $key => $value) {
        $this->{$key} = $value;
    }
} 
```

这通常不是必需的，因为您可以使用以下属性来模拟属性`__get()`，并且`__set()`您已经实现了这些属性：

```
public function __construct($associative_array) 
{
    $this->parameters = array();
} 
```

我想谈谈你的神奇`__set`方法：

```
public function __set($key, $value) 
{
    $value = addslashes($value);
    $value = htmlentities($value);

    if(method_exists($this, "set_$key")) {
        $this->{"set_$key"}($value);
    } else {
        $this->parameters[$key] = $value;
    }
} 
```

为什么`addslashes()`和`htmlentities()`？那些不应该在那里，因为逃避不是班级的关注点。

到`RegisterFormParameterHandler`.

```
public function __construct($form_parameters, $notice, $tok_id, $captcha) 
{
    parent::__construct($form_parameters);
    $this->notice = $notice;

    $args = func_get_args();

    foreach($form_parameters as $key=>$value) {
        $key = 'validate_'.$key;

        $this->$key($args);
    }
} 
```

首先，构造函数中的参数超过三个，如果你引入一个单独的`validate()`方法，它们中的大多数都不是必需的。

让我们完全删除构造函数并编写一个`validate()`方法：

```
final public function validate($notice, $tok_id, $captcha)
{
    foreach ($this->parameters as $key=>$value) {
        call_user_func_array(array($this, "validate_$key"), func_get_args());
    }
} 
```

现在，依赖`$notice`和其他两个参数仅对`validate()`方法是本地的。我在`call_user_func_array()`这里使用将参数代理到其他验证方法，以便您可以获得一些 IDE 代码洞察力：

```
public function validate_something(notice $notice, $tok_id, $captcha) 
{
    if(something === true) {
        $notice->add('error', 'Error message');
    }
} 
```

# codeigniter - CodeIgniter：选择 id 对应于另一个表中不同值的行

> ID：14865743
> 
> 赞同：1
> 
> 时间：2013-02-14T00:18:02.727
> 
> 标签：codeigniter, distinct

我的数据库中有三个单独的表。一个带有列表，`companies`另一个带有列表`company_categories`。和最后一个类似的`categories`。`companies`and表中的所有行`categories`都有一个唯一的 ID。表中没有唯一 ID `company_categories`。

这是我的`companies`表格的示例：

```
company_id | company_name     |  logo     |  ....
-----------+------------------+-----------+--------
     5     |  Co 5            |  123.jpg  |  ....
     6     |  Company 6       |  123.jpg  |  ....
     7     |  7's a company   |  234.jpg  |  ....
     8     |  EightCo         |  345.jpg  |  .... 
```

这是我的`categories`表格的示例：

```
category_id | category_name 
------------+-----------
      1     |  Blue
      2     |  Red
      3     |  Green
      4     |  Yellow 
```

我的`companies_categories`样子：

```
company_id | category_id
-----------+-----------
     5     |  2
     5     |  3
     6     |  1
     6     |  2
     7     |  1 
```

注意：company_id 和 category_id 在它们的相关表中都有外键

我要做的是列出所有具有特定类别的公司。例如，如果选择了类别 2，则应返回公司 5 和 6。如果选择类别 4，则不应显示任何内容。公司 8 永远不应显示（因为它没有与之关联的类别）

我试图通过在活动记录中使用 codeigniter 的 distinct() 函数来解决这个问题：

```
$this->db->from('company_categories')
->distinct()
->where('category_id', $category_id)
->join('companies', 'companies.company_id = company_categories.company_id')
->select('companies.company_id as co_id companies.logo as co_logo, companies.name as co_name')
->get()->result(); 
```

但这实际上所做的是变得不同`company_id`,`company_logo`和`company_name`。因此，如果一家公司（如公司 5 和 6）具有相同的徽标，则结果中只会返回其中一家公司。我希望两者都展示。这可以使用codeigniter的活动记录来完成吗？

如果不是，如何在 SQL 查询中完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T01:39:07.237

正如@Rick 所说，您不需要`distinct`. 此外，您应该从中选择，而不是`companies`反过来加入。`company_categories`

您的 SQL 应如下所示：

```
SELECT * FROM companies 
JOIN companies_categories 
ON companies.company_id=companies_categories.company_id 
WHERE category_id = 2 
```

更新 sqlfiddle：[http ://www.sqlfiddle.com/#!2/d1f24/16/0](http://www.sqlfiddle.com/#!2/d1f24/16/0)

在代码点火器中：

```
$this->db->select('companies.company_id as co_id, companies.logo as co_logo, companies.name as co_name')
$this->db->where('display_flg',true);
$this->db->join('company_categories', 'companies.company_id = company_categories.company_id');
$query = $this->db->get('companies'); 
```

# python - 将 django 部署到 heroku

> ID：14865745
> 
> 赞同：0
> 
> 时间：2013-02-14T00:18:13.890
> 
> 标签：python, django, deployment, heroku

嗨，伙计们，所以我按照指南在这里在 heroku 上部署 django

[https://devcenter.heroku.com/articles/django](https://devcenter.heroku.com/articles/django)

但是我的服务器不断在 heroku 上崩溃并出现此错误，非常感谢任何想法或方向。

```
2013-02-12T19:27:40+00:00 app[web.1]:   File "/app/.heroku/python/lib/python2.7/site-  packages/django/utils/importlib.py", line 35, in import_module
2013-02-12T19:27:40+00:00 app[web.1]:     __import__(name)
2013-02-12T19:27:40+00:00 app[web.1]:   File "/app/eduudle/settings.py", line 15, in   <module>
2013-02-12T19:27:40+00:00 app[web.1]:     DATABASES = { 'default': {dj_database_url.config()}}
2013-02-12T19:27:40+00:00 app[web.1]: TypeError: unhashable type: 'dict'
2013-02-12T19:27:41+00:00 heroku[web.1]: Process exited with status 1
2013-02-12T19:27:41+00:00 heroku[web.1]: State changed from starting to crashed 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:25:07.783

[文档](https://devcenter.heroku.com/articles/django#database-settings)建议数据库的 格式应该是

`DATABASES['default'] = dj_database_url.config()`

不是

`DATABASES['default'] = {dj_database_url.config()}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:50:39.527

发现该文件已过时的问题，因此根据此文件将无法正常工作

[https://github.com/heroku/heroku-buildpack-python/issues/45](https://github.com/heroku/heroku-buildpack-python/issues/45)

我原本可以工作，但我添加了太多的大括号

所以而不是

```
 DATABASES = { 'default': {dj_database_url.config()}} 
```

采用

```
 DATABASES = { 'default': dj_database_url.config()} 
```

# sql - 没有父/子关系的递归实体

> ID：14865747
> 
> 赞同：2
> 
> 时间：2013-02-14T00:18:18.327
> 
> 标签：sql, recursion, recursive-query

我试图在 RDBMS 中表示以下递归关系：

![在此处输入图像描述](../Images/fe58fb28729636bad67dae02c04f506a.png)

作为一个基本示例，我们有以下字段：

```
1 - computer science
2 - computer engineering
3 - electrical engineering
4 - mathematics 
```

我想将相似的领域相互联系起来。我可以使用第二个表将字段相互关联。理想情况下，我可以想象它看起来像这样：

```
+----------+----------+
| field1   | field2   |
+----------+----------+
|    4     |    1     | (math -> comp sci)
|    4     |    2     | (math -> comp eng)
|    4     |    3     | (math -> elect eng)
|    2     |    1     | (comp eng -> comp sci)
|    2     |    3     | (comp eng -> elect eng)
+----------+----------+ 
```

但是，如果键是 (field1, field2)，我可以看到两个潜在问题：

1.  元组可以重复，尽管是无序的
2.  如果哪个字段在哪个列中不重要，它可能会使查询不必要地复杂化（正如**sgeddes**指出的那样，查询两个列并过滤掉重复项）

例如：

```
+----------+----------+
| field1   | field2   |
+----------+----------+
|    1     |    4     | (comp sci -> math)
|    4     |    3     | (math -> elect eng)
|    4     |    2     | (math -> comp eng)
|    3     |    4     | (elect eng -> math)
|    2     |    1     | (comp eng -> comp sci)
|    3     |    2     | (elect eng -> comp eng)
|    1     |    2     | (comp sci -> comp eng)
+----------+----------+ 
```

**我应该如何处理非层次递归关系？**

我是否应该继续故意复制每个元组，就像在第二个表中一样？还是我忽略了另一种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:39:58.250

我已经多次看到这种方法。老实说，我从来都不是一个超级粉丝，因为我不得不查询两个字段的匹配项并过滤掉重复的结果。那么超过 2 个相似的字段呢？可能会变得相当混乱。

使用上面的示例，另一种方法是引入 SimilarField 表。它将存储 SimilarId 和 FieldId（有些人会争论第三个 Identity 字段，SimilarFieldId）。因此，如果英语和文学是相似的领域，那么您可以：

```
SimilarId   FieldId
1           1         (English)
1           2         (Literature) 
```

这种方法允许您在字段与其相似字段之间建立 1-n 关系。

**- 编辑 -**

针对您的评论，不确定您的示例如何不起作用：

```
SimilarId   FieldId
1           1         (English)
1           2         (Literature)
1           3         (Reading)
2           2         (Literature)
2           4         (History)
3           4         (History)
3           5         (Art History) 
```

您可以根据需要拥有尽可能多的分组相似字段。

例如，要获取与文学相关的所有字段，您的查询可能如下所示：

```
SELECT DISTINCT F.FieldId, F.FieldName
FROM Field F JOIN 
      SimilarField S ON F.FieldId = S.FieldId
WHERE S.SimilarId IN (
      SELECT SimilarId 
      FROM SimilarField
      WHERE FieldId = 2 
   ) 
```

这是一个示例[SQL Fiddle](http://sqlfiddle.com/#!3/dbc83/1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T01:21:21.823

解决重复问题的一种常见方法是确保`field1`始终包含元组中的最低 id，并结合`UNIQUE`两列上的键。那么你的条件`SELECT`就可以了`WHERE field1 = @id OR field2 = @id`。

# java - 单击按钮时不显示对话框 - Android

> ID：14865751
> 
> 赞同：1
> 
> 时间：2013-02-14T00:19:12.890
> 
> 标签：java, android, dialog

我正在尝试`dialog`显示一个框。现在程序没有崩溃，所以没有 LogCat 可以显示。单击按钮时，什么也看不到。我是否缺少一行代码阻止该`dialog`框显示？

**Java代码：**

```
public class Results extends Activity {

    Button detailsBtn;
    final Context context = this;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.resultsmain);

        detailsBtn = (Button)findViewById(R.id.detailsBtn);
        detailsBtn.setText("Details");

        detailsBtn.setOnClickListener(new OnClickListener() {
            public void onClick(View arg0) {

                final Dialog dialog = new Dialog(context);
                dialog.setContentView(R.layout.resultsdetailsdisplay);
                dialog.setTitle("Detailssss - TESTING");

                TextView title = (TextView)dialog.findViewById(R.id.title);
                title.setText("TITLE - TESTING");

                Button close = (Button)dialog.findViewById(R.id.close);

                close.setOnClickListener(new OnClickListener() {
                    public void onClick(View arg0) {
                        dialog.dismiss();
                    }
                });
            }
        });
    }
} 
```

结果详细信息显示.xml：

```
<RelativeLayout 
    xmlns:tools="http://schemas.android.com/tools" 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/scroll" >

    <TextView
        android:id="@+id/title"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textSize="12sp"
        android:layout_centerHorizontal="true"
        android:gravity="center" />
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:21:18.900

这可能是因为你没有`show()`为你的`dialog`. 添加

```
dialog.show(); 
```

# php - HTML 页面正在打印我的 php 结束语法

> ID：14865756
> 
> 赞同：-2
> 
> 时间：2013-02-14T00:20:09.253
> 
> 标签：php, html

我正在尝试将 PHP 放入我的 html 代码中，但是当我在浏览器中运行它时，列出了关闭语法，这是代码的高度简化版本

```
<html>
<body>
    <h1>
    <?php
        $names = ('TOM');
        echo $names .'<br/>';
    ?>

    </h1>
</body> 
```

当我运行它时，页面打印（';？>）即使我只是尝试回显一个跳过变量的简单字符串，我也会遇到同样的问题，因为 html 无法识别 php 开始标签有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:43:25.433

从您的评论中可以明显看出..您不能只将作为服务器端代码的 php 放入 .html 文件中，并让服务器将其评估为 php 。据我所知，解析器会搜索 .php 文件，然后采取相应的行动。如果没有某种模板引擎，您所做的将无法正常工作。可以说...

将您的文件更改为`.php`，而不是`.html`，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:45:32.483

尝试使用单个文件：

```
<?php phpinfo(); ?> 
```

如果这不起作用，您的服务器没有正确处理 php 文件。在这种情况下，您需要提供有关文件名和正在使用的服务器的更多信息（或者您只是在本地计算机上执行此操作并双击文件以在默认浏览器中打开？其中万一它不起作用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T00:47:52.307

您可能需要设置 php.ini 来解析 php 的 html 文件。这样做的缺点是它可以使用更多的系统资源。如果它只是您的测试服务器，那么我只需编辑 ini 并添加扩展名。

最聪明的做法是将 php 放在一个单独的文件中，然后将其包含在 html 中。在你的 html 中，你会这样做：

```
< !--#include virtual="phpfile.php" --> 
```

它会加载你的 php 并正确解析它。

# java - 空指针异常错误，即使尝试捕获空值

> ID：14865760
> 
> 赞同：0
> 
> 时间：2013-02-14T00:20:30.920
> 
> 标签：java, null, nullpointerexception, integer, break

我正在使用 Bukkit 的 API，但我会从中剪掉一些代码，因为它不是 API（因为它没有在我正在做的事情中引入）。因此，我不断收到“空指针异常”，在搜索 Google 之后，我似乎无法将任何修复与我的代码联系起来。所以这是我的代码：

```
Integer tier = null;
    for(Integer i = 1; i <= 5;) 
    {
        if (p.hasPermission("flyp.fly." + i.toString())){
            tier = i - 1;
            break;
        }
        i++;
    }

if(tier == null) 
    {
            p.sendMessage(ChatColor.RED + "You lack the permission to do this!");
            return true;
    } 
```

使用此代码时，（当我使用“/fly on”事件时）我得到一个“空指针异常”，它指向“if（tier == null）”行。最后，我在清理“旧”代码，这部分是我朋友写的，我似乎联系不上-_-。

感谢您的帮助，AhellHound

# php - strrcr 仅在斜杠后显示字符串中的项目

> ID：14865761
> 
> 赞同：0
> 
> 时间：2013-02-14T00:20:34.230
> 
> 标签：php, string, strchr, strrchr

我正在引用一个数组，这仅显示斜线后的字符串部分。我如何也显示它之前的字符。

```
#Check for bio
        if ($biosDisplayed == $y) {
            $positionTitle = strpos($bios[$i], " /");
            $positionTitle = substr($bios[$i], 0, $positionTitle);
            echo "<br /><b>Position Title: </b>" . $positionTitle;

            #Company Name
            $position = strrchr($bios[$i], " /");
            echo "<br /><b>Bio: </b>" . strchr($position, " ");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:40:19.503

试试这个：

```
if ($biosDisplayed == $y) {
        $fields = explode(" / ", $bios[$i]);

        echo "<br /><b>Position Title: </b>" . $fields[0];
        echo "<br /><b>Bio: </b>" . $fields[1]);
} 
```

# java - java中if语句的问题

> ID：14865765
> 
> 赞同：-1
> 
> 时间：2013-02-14T00:20:52.230
> 
> 标签：java, arrays, if-statement

大家好，我是java的菜鸟，所以不确定它的怪癖，但这在C#中有效吗？使用这段代码获得相同的结果时遇到了一些麻烦：

```
 for (int i = 0; i < 50; i++){

        ar1 = array[i][0];
        ar2 = array[i][1];
        ar3 = array[i][2];
        ar4 = array[i][3];
        ar5 = array[i][4];
        ar6 = array[i][5];

        if (ar1 == rs1 || ar1 == rs2 || ar1 == rs3 || ar1 == rs4 || ar1 == rs5 || ar1 == rs6)
            M++;

        if (ar2 == rs1 || ar2 == rs2 || ar2 == rs3 || ar2 == rs4 || ar2 == rs5 || ar2 == rs6)
            M++;

        if (ar3 == rs1 || ar3 == rs2 || ar3 == rs3 || ar3 == rs4 || ar3 == rs5 || ar3 == rs6)
            M++;

        if (ar4 == rs1 || ar4 == rs2 || ar4 == rs3 || ar4 == rs4 || ar4 == rs5 || ar4 == rs6)
            M++;

        if (ar5 == rs1 || ar5 == rs2 || ar5 == rs3 || ar5 == rs4 || ar5 == rs5 || ar5 == rs6)
            M++;

        if (ar6 == rs1 || ar6 == rs2 || ar6 == rs3 || ar6 == rs4 || ar6 == rs5 || ar6 == rs6)
            M++;

        if (M == 3)
            w3++;

        if (M == 4)
            w4++;

        if (M == 5)
            w5++;               

        if (M == 6)
            w6++;

    }
    lbl3.setText(String.valueOf(w3));
    lbl4.setText(String.valueOf(w4));
    lbl5.setText(String.valueOf(w5));
    lbl6.setText(String.valueOf(w6)); 
```

在 for 循环中：

1.  将 ar(N) 设置为数组的一部分

2.  检查 rs(N) 然后如果为真则增加 M

3.  检查 M 以查看其 3、4、5、6 是否为真，然后增加 w(N)

4.  最后在标签上显示 w(N) 的所有总数，例如 lbl3、10 lbl4、22 lbl5、12 lbl6、6

但我得到的只是一个标签给出的总数为 1 或所有的标签为 1！尝试用 {} 括起来并使用（否则如果），数组已满，所以我很难过！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:26:21.210

除非对象是原始类型，否则使用 .equals 而不是 ==

另外，假设您的类型是字符串，我会将 rs 放入 Set 中，然后执行 contains。

```
Set<String> ares = new HashSet<String>();
ares.add(r1);
...
ares.add(rN);

for (int i = 0; i < 50; i++) {
    for (int j = 0; j <= 5; j++) {
       if (ares.contains(array[i][j])
           M++;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:40:17.700

首先，您不需要分配这么多变量。如果您简化事情，它可以使调试更容易。

```
for (int i = 0; i < 50; i++){
    for (int j = 0; j < 6; j++){
        value = array[i][j];
        if(value == rs1 through 6){//check to see if value equals all of the rs1, rs2, etc... variables   
            M++;    
        }
    }
 # assign W variables...
} 
```

如果您仍然没有得到您期望的变量，您可以将间歇性打印语句放入循环中，以查看值在循环的不同迭代中。但是，我建议您使用设置断点的调试程序，以便在执行期间可以预期变量。希望这可以帮助。

# jquery - 如果 td 与同一行上的另一个 td 不同，则 jQuery 突出显示 td

> ID：14865766
> 
> 赞同：1
> 
> 时间：2013-02-14T00:20:53.747
> 
> 标签：jquery, indexing, html-table

如果里面的数据与同一行的第三列 td 内的数据匹配，我需要做的是向第一列 td 添加一个类。

[http://jsfiddle.net/rUssu/](http://jsfiddle.net/rUssu/)

html表格

```
<table border="1">
   <tr><th>first</th><th>second</th><th>third</th></tr>
   <tr><td>0</td><td>1</td><td>2</td></tr>
   <tr><td>3</td><td>4</td><td>3</td></tr>
   <tr><td>6</td><td>7</td><td>9</td></tr>
 </table> 
```

javascript/jquery

```
var cPrice = $('th').filter(':contains("first")');
var cDefault = $('th').filter(':contains("third")');

cp = cPrice.index() + 1;
cd = cDefault.index() + 1;

$('table td:nth-child(' + cp + ')').filter(function () {
   //alert($(this).text());
   var temp = $(this).index() + 2;
   //alert(temp);

   return $(this).text() != $('table td:eq('+ temp +')').text();
}).addClass("boom"); 
```

css

```
th{padding:5px;}
td{text-align:center;}
.boom{color:red;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:24:50.230

[http://jsfiddle.net/rUssu/1/](http://jsfiddle.net/rUssu/1/)

```
return $(this).text() != $(this).nextAll().eq(1).text(); 
```

您的选择器正在获取所有 TD 的临时 TD，而不仅仅是当前行中的那些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T00:26:59.133

您可以单独遍历每一行并将单元格 1 与单元格 3 进行比较，类似于：

```
$('table tr').each(function () {
    var $firstCell = $('td:eq(0)', this);
    var $thirdCell = $('td:eq(2)', this);

    if($firstCell.text() === $thirdCell.text()){
        $firstCell.addClass('boom');
    }
}) 
```

**编辑**

再次查看您的代码后，我相信使用当前单元格的[**兄弟姐妹（）**](http://api.jquery.com/siblings/)也应该可以工作，类似于：

```
$('table td:nth-child(' + cp + ')').filter(function () {
      return $(this).text() === $(this).siblings().eq(1).text();
}).addClass("boom"); 
```

* * *

[**演示**](http://jsfiddle.net/8SHqU/)- 将当前单元格与第二个下一个兄弟单元进行比较

* * *

# java - Spring Roo 中资源文件的物理位置在哪里？

> ID：14865769
> 
> 赞同：0
> 
> 时间：2013-02-14T00:21:44.743
> 
> 标签：java, spring, spring-roo

我正在测试 Spring Roo，一切正常。但我似乎无法找到 dojo.js、Spring.js、tundra.css 等资源文件的物理位置。

即使使用“执行包”创建 WAR 文件，资源文件也不在 WAR 文件中。

但是当将应用程序部署到 Tomcat 并尝试访问类似 server/myproject/resources/dojo/dojo.js 的内容时，我可以看到并查看 JS 文件本身。

这里到底发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:15:12.913

上次我使用 Roo 时，它们是从 Spring Webflow 借来的并包含在 jar 中`spring-js-resources-x.y`。

我的 Spring-MVC 配置文件`webmvc-config.xml`包含这一行：

```
<mvc:resources location="/, classpath:/META-INF/web-resources/" mapping="/resources/**"/> 
```

它说`resources/*`将首先在文件系统中查找，然后在类路径中查找。

如果您需要修改这些文件，您可以将它们提取到 web 目录中。

# notepad++ - 使用 Tidy2 记事本++

> ID：14865770
> 
> 赞同：8
> 
> 时间：2013-02-14T00:21:45.610
> 
> 标签：notepad++, tidy

当我尝试在我的 html 页面上使用[Tidy2时，发生了一些非常奇怪的事情。](https://github.com/w3c/tidy-html5/tree/68a9e74)HTML 实体从这个`&nbsp;`变为这个 xA0（[截图](https://dl.dropbox.com/u/3260616/screen.gif)）

我在配置文件中尝试了不同的设置，但没有任何帮助。请给点建议

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-10-07T13:17:11.293

您需要将保留实体设置为 1

[http://tidy.sourceforge.net/docs/quickref.html#preserve-entities](http://tidy.sourceforge.net/docs/quickref.html#preserve-entities)

只需添加到配置文件的末尾

```
preserve-entities: 1 
```

打开配置文件：Plugins > Tidy2 > Edit config *n*

来源：[https ://stackoverflow.com/a/6669947/2455951](https://stackoverflow.com/a/6669947/2455951)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-10T02:24:41.403

1.  如果您使用 Tidy2，请转到：Plugins->Tidy2->Show Config Help

在那里您将找到如何进行配置。每个关键词都有其对应的原因。

我只是尝试更改默认配置以实现我的目的。当我的代码是`'&apos;'`. （可能是你的问题）

最后的问题是设置。

```
 quote-marks: no 
```

我在“显示配置帮助”文件中找到的原因是：

此选项指定 Tidy 是否应该按照某些编辑环境的首选输出“字符为”。撇号字符 ' 写成 ' 因为许多 Web 浏览器还不支持 '。

1.  我正在使用 HTML5 并在 latin1 中使用编码：

2.1 我用Plugins->Tidy2->Edit config1

2.2 我用 Plugins->Tidy2->tidy (config 2) 应用它

我的配置文件是这样的：

```
indent: auto
indent-spaces: 2
wrap: 132
markup: yes
output-html: yes
numeric-entities: yes
quote-marks: no
quote-nbsp: yes
quote-ampersand: no
break-before-br: no
uppercase-tags: no
uppercase-attributes: no
new-inline-tags: cfif, cfelse, math, mroot, 
  mrow, mi, mn, mo, msqrt, mfrac, msubsup, munderover,
  munder, mover, mmultiscripts, msup, msub, mtext,
  mprescripts, mtable, mtr, mtd, mth
new-blocklevel-tags: cfoutput, cfquery
new-empty-tags: cfelse
char-encoding: latin1
output-encoding: no
input-encoding: no 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-13T07:57:03.167

我遇到了同样的问题。经过搜索和实验，我发现UTF-8编码和这些设置不会改变**'** （最终设置是数字实体：否）：

```
indent: auto  
indent-spaces: 2  
wrap: 132  
markup: yes  
output-html: yes  
numeric-entities: no  
quote-marks: no  
quote-nbsp: yes  
quote-ampersand: no   
break-before-br: no  
uppercase-tags: no  
uppercase-attributes: no  
new-inline-tags: cfif, cfelse, math, mroot,  
mrow, mi, mn, mo, msqrt, mfrac, msubsup, munderover,  
munder, mover, mmultiscripts, msup, msub, mtext,  
mprescripts, mtable, mtr, mtd, mth  
new-blocklevel-tags: cfoutput, cfquery  
new-empty-tags: cfelse 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-07T23:47:32.093

快速解决：

主菜单 -> 编码 -> ANSI 编码

默认配置文件是好的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T10:19:13.170

我相信这与您的编码设置有关。

检查您是否有`char-encoding: raw`或`output-encoding: raw`。在这种情况下，您需要将其更改为您需要的任何编码（例如 utf8）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-30T09:09:12.890

如果您在没有 bom 的情况下对 utf8 进行编码，请将其转换为 utf8

我的配置是：缩进：自动缩进空格：2 安静：是输入编码：utf8 输出编码：utf8

# php - Doctrine Query Builder 不适用于 CodeIgniter

> ID：14865773
> 
> 赞同：0
> 
> 时间：2013-02-14T00:22:16.270
> 
> 标签：php, codeigniter, doctrine, query-builder

我的一个控制器的函数中有以下代码：

```
$qb = $this->doctrine->em->createQueryBuilder();
$query = $qb->select('username, password, level')
    ->from('User', 'u');
        // ->where('user.username = :username')
        // ->setParameter('username', 'userTest');
$users = $query->getResult(); 
```

这会导致*某些事情*默默地失败。没有错误消息，我从页面得到的唯一信息是 500 服务器错误。如果我注释掉`$users = $query->getResult()`页面加载的行就好了，所以查询生成器似乎在这里不起作用。我不知道为什么。我需要以某种方式将它加载到我的 Doctrine.php 库文件中吗？我不这么认为。

我发现的另一件奇怪的事情是，如果我尝试通过将`getRepository`DQL 语句打印到页面输出的方法来检索条目，就像该方法本身出于某种原因打印出 DQL 语句一样。我不会把它的结果打印出来。

知道这里发生了什么吗？我的用户类非常简单。不幸的是，我不知道出了什么问题，因为没有报告错误。丁：

```
<?php
namespace Entities;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 */
class User {
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue
     */
    private $id;

    /**
     * @ORM\Column(type="string")
     */
    private $username;

    /**
     * @ORM\Column(type="string")
     */
    private $password;

    /**
     * @ORM\Column(type="integer")
     */
    private $level;

    /**
     * @ORM\OneToMany(targetEntity="EmailAddress", mappedBy="user")
     */
    private $emails;
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T08:55:27.110

你漏了一步！

查看[学说文档](http://docs.doctrine-project.org/en/2.0.x/reference/query-builder.html#executing-a-query)。

尝试 ：`$users = $query->getQuery()->getResult();`

并改变：`$qb->select('u.username, u.password, u.level')`

# sql - 支付周期 ID 按周分组

> ID：14865775
> 
> 赞同：0
> 
> 时间：2013-02-14T00:22:31.887
> 
> 标签：sql, datetime

如何让 sql 识别我的支付期？我有一个表，其中包含支付周期 ID 列表，每年 26 个。2012的最后一个支付周期是201226，2013的第一个支付周期是201301，我有没有办法让sql计算201226 + 1 = 201301，201226 + 2 = 201302？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:44:59.690

如果您想保留当前的设计，您可以简单地添加另一个字段，它是一个递增的序列号。使用序列号和当前字段的组合，您可以到达下一个或上一个支付期

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T02:03:11.570

像这样的东西应该适合你。我包括了 2 个额外的字段`Year`，`Period`以防您需要它们：

```
WITH CTE AS (
  SELECT 
    PayPeriodId,
    ROW_NUMBER() OVER (ORDER BY PayPeriodId) RN,
    Left(PayPeriodId, 4) as Year, 
    Right(PayPeriodId, 2) as Period 
  FROM PayPeriods
  ) 
SELECT NextPeriod.PayPeriodId
FROM CTE CurrentPeriod
  JOIN CTE NextPeriod ON CurrentPeriod.RN + 1 = NextPeriod.RN
WHERE CurrentPeriod.PayPeriodId = '201226' 
```

这是一些[Fiddle](http://sqlfiddle.com/#!3/21e6d/1)示例。

# java - javaFX 水平方向的tableview

> ID：14865777
> 
> 赞同：3
> 
> 时间：2013-02-14T00:22:59.720
> 
> 标签：java, javafx-2, tableview

有没有办法在 JavaFX 中创建一个水平方向的 TableView？所以相同类型的数据应该排成一行。如果不可能，是否有任何其他容器代替 TableView？

# mysql - 使用选项值设置搜索条件的变量

> ID：14865778
> 
> 赞同：0
> 
> 时间：2013-02-14T00:23:03.553
> 
> 标签：mysql

在 .class.php 文件中，我有这个查询。

```
public function findschedules($arricao, $depicao, $airline, $aircraft)   {
    $query = "SELECT db_schedules.*, db_aircraft.name AS aircraft, db_aircraft.registration
            FROM db_schedules, db_aircraft
            WHERE db_schedules.depicao LIKE '$depicao'
            AND db_schedules.arricao LIKE '$arricao'
            AND db_schedules.code LIKE '$airline'
            AND db_schedules.aircraft LIKE '$aircraft'
            AND db_aircraft.id LIKE '$aircraft'
            AND db_schedules.enabled = '1'
            AND db_schedules.daysofweek LIKE '%{$day}%'";
    return DB::get_results($query);
} 
```

执行搜索时使用公共功能。但是，该文件链接到一个`$this->show('airport_search.tpl');`包含所有 HTML 代码的模板文件，其中包含选择框。

```
<select style="border:1px solid #DCDCDC; color:#003663; font-size:11px;" class="search" name="day" id="day">
                <option value="0">Sunday</option>
                <option value="1">Monday</option>
                <option value="2">Tuesday</option>
                <option value="3">Wednesday</option>
                <option value="4">Thursday</option>
                <option value="5">Friday</option>
                <option value="6">Saturday</option>
            </select> 
```

下面的行旨在搜索表格`daysofweek`列中的部分字符串`db_schedules`。我正在尝试从中的选择框中为其分配一个变量`airport_search.tpl`。理想情况下，我希望从中获取变量`option value=""`并在查询中分配它。

```
AND db_schedules.daysofweek LIKE '%{$day}%'"; 
```

此外，`daysofweek`column 是一个 varchar(7) 类型字段，默认值为`0123456`. 它们代表天数，0 是星期日，1-6 是星期一至星期六。因此查询的预期输出是查找用户在选择框中给出的日期。

如何根据另一个文件中选择框中的用户输入将选项框中的变量分配到查询中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:25:31.523

```
$day = $_POST['day']; 
```

提交后，您只需`value`从表单的选定选项中获取属性。

但是，不要使用`$day`. 使用 mysqli/PDO 并编写参数化查询，如下所示：

```
$stmt = $pdo->prepare("...AND daysofweek LIKE ?");
$stmt->execute("%$day%"); 
```

# maven - 是否可以在单台机器上设置 Storm API

> ID：14865780
> 
> 赞同：1
> 
> 时间：2013-02-14T00:23:33.490
> 
> 标签：maven, installation, local, apache-storm

我试图弄清楚是否可以在一台机器上设置整个[风暴项目](http://storm-project.net/about/simple-api.html)以用于测试和模拟目的，所以这个问题主要针对那些尝试过这个的人。我知道使用 Hadoop（这是 Storm 的基础) 允许模拟集群的能力。我已经阅读了一些关于 Maven 以及如何使用它在本地运行 Storm，但不确定 Maven 是什么以及它如何真正工作。我希望这里有人可以帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T01:47:42.970

是的，这是可能的。你可以为 Storm 建立一个“单节点集群”来运行，它可以全部在一台机器上。这将模拟真实集群的样子，但您将有 1 台机器托管整个堆栈（ZooKeeper 和 Storm）。Nimbus 服务器本质上是您的工作服务器。配置它与在此处遵循本指南相同： [https](https://github.com/nathanmarz/storm/wiki/Setting-up-a-Storm-cluster) ://github.com/nathanmarz/storm/wiki/Setting-up-a-Storm-cluster 。基本上一切都将是您的本地主机机器。

Maven 是一个构建工具，用于从源代码构建软件（它也可以做其他事情，比如部署和发布它）。在这种情况下，我建议[从 github 获取storm-starter 项目，](https://github.com/nathanmarz/storm-starter)并使用它来让你的脚被风暴弄湿。在获得启动项目后运行的 maven 命令将是这样的：

```
$ mvn -f m2.pom compile exec:java -Dexec.classpathScope=compile -Dexec.mainClass=com.some.package.name.YourMainTopologyClass 
```

请注意，您也可以轻松地使用 lein 来启动它。

所以，总结一下：

1.  是的，您可以建立 Storm 的“单节点集群”，并使用它来发送拓扑以运行。
2.  是的，您可以使用 Maven 来执行 Storm 拓扑。请注意，storm-starter 确实是您应该使用的，以了解其工作原理。请注意，在某些示例中，他们构建和使用的拓扑最终会提交到`LocalCluster`. 这是拓扑开发和测试的理想选择，[基本上为您模拟了一个](https://github.com/nathanmarz/storm/wiki/Local-mode)进程中的风暴集群。

# javascript - jCarousel 0.3.0 不工作

> ID：14865781
> 
> 赞同：3
> 
> 时间：2013-02-14T00:23:40.747
> 
> 标签：javascript, jquery, jcarousel

我正在尝试使用此处的文档实现一个简单的轮播：

[http://sorgalla.com/jcarousel/docs/index.html](http://sorgalla.com/jcarousel/docs/index.html)

我已经让 jQuery 正常工作，我已经下载并引用了 jCarousel 0.3.0，并根据文档 ( [http://sorgalla.com/jcarousel/docs/reference/installation.html](http://sorgalla.com/jcarousel/docs/reference/installation.html) )。我添加了所需的最少 CSS（根据此处[http://sorgalla.com/jcarousel/docs/reference/installation.html#reference-installation-setup](http://sorgalla.com/jcarousel/docs/reference/installation.html#reference-installation-setup)）我有这个设置（带有有效的实际链接，加载 JPG） ：

```
<div style="height:114px" id="sidebarcarousel">       
    <ul>
        <li><img src="http://path-to-file.jpg" /></li>
        <li><img src="http://path-to-file.jpg" /></li>
        <li><img src="http://path-to-file.jpg" /></li>
        <li><img src="http://path-to-file.jpg" /></li>
        <li><img src="http://path-to-file.jpg" /></li>
        <li><img src="http://path-to-file.jpg" /></li>
        <li><img src="http://path-to-file.jpg" /></li>
    </ul>            
 </div> 
```

在我的 JavaScript 中：

```
$(document).ready(function(e){
    $("#sidebarcarousel").jcarousel();
}); 
```

但是当我打开网页时绝对没有任何反应。文档的 ready 方法被正确调用，并且没有任何 JS 或 CSS 文件的断开链接。可能是什么原因？我已经用轮播注释掉了代码，没有任何改变。此外，在 JavaScript 控制台中也没有发现问题。我在最新的 Safari、Firefox 和 Chrome 中都试过了。

可能是什么原因？我正在使用 0.3.0（所以不要携带与旧版本相关的文档，因为它们可能无法正常工作，因为 0.3.0 是一项重大更改）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T07:28:15.050

您确定包含正确版本的 jQuery 和 jCarousel javascript 文件吗？

```
<script src="scripts/jquery-1.10.1.min.js" type="text/javascript"></script>
<script src="scripts/jquery.jcarousel.min.js" type="text/javascript"></script> 
```

此时您只看到旋转木马。除非您添加代码使其滑动，否则它不会做任何事情。您可以使用代码使其自动滑动，也可以按照[此处](http://sorgalla.com/jcarousel/docs/reference/usage.html)的说明简单地添加导航按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T01:18:28.460

您没有为您的课程添加任何课程，`<ul>`您必须将该 id 提供给 your `<ul>`，而不是 div。

在你的情况下：`<ul id="sidebarcarousel" class="jcarousel-skin-tango">`

为什么？因为它在 .js 插件代码中使用该结构和类来操作`<ul>`元素。

jQuery 调用：

```
jQuery(document).ready(function() {
     jQuery('#sidebarcarousel').jcarousel();
}); 
```

HTML：

```
<ul id="sidebarcarousel" class="jcarousel-skin-tango">
   <li><img src="http://path-to-file.jpg" /></li>
   <li><img src="http://path-to-file.jpg" /></li>
   <li><img src="http://path-to-file.jpg" /></li>
   <li><img src="http://path-to-file.jpg" /></li>
   <li><img src="http://path-to-file.jpg" /></li>
   <li><img src="http://path-to-file.jpg" /></li>
   <li><img src="http://path-to-file.jpg" /></li>
</ul> 
```

请在这里查看我为您制作的示例：http: [//jsfiddle.net/UCgEU/2/](http://jsfiddle.net/UCgEU/2/)

PS：我为这个例子添加了外部插件资源。您可以在左侧的“管理资源”下找到它们。

# arrays - 在对象中创建对象数组 - Powershell

> ID：14865783
> 
> 赞同：1
> 
> 时间：2013-02-14T00:23:59.920
> 
> 标签：arrays, object, powershell

我希望在日历中创建一系列事件。事件和日历都是对象。我找不到任何关于在对象中创建简单数组的文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T01:04:35.560

How about something like this -

```
$cal = New-Object -Type PsObject -Prop @{
    Year = 2013
    Events = @()
}

$event = New-Object -Type PsObject -Prop @{
    Date = [DateTime] "2013-02-14"
    Name = "Valentines Day"
}

$cal.Events += $event 
```

If you have a predefined calendar objects which doesn't have a property to store events you can use `Add-Member` to attach a new property and store an array in there.

# ios - UIImageView 开始/完成动画后更改图像

> ID：14865790
> 
> 赞同：0
> 
> 时间：2013-02-14T00:24:32.023
> 
> 标签：ios, cocoa-touch, core-animation, quartz-graphics

我需要我的图像视图在每个动画的开头和结尾更改其 .image 。

这是动画：

```
- (void)performLeft{

    CGPoint point0 = imView.layer.position;
    CGPoint point1 = { point0.x - 4, point0.y };

    CABasicAnimation *anim = [CABasicAnimation animationWithKeyPath:@"position.x"];
    anim.fromValue    = @(point0.x);
    anim.toValue  = @(point1.x);
    anim.duration   = 0.2f;
    anim.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn];

    // First we update the model layer's property.
    imView.layer.position = point1;
    // Now we attach the animation.
    [imView.layer  addAnimation:anim forKey:@"position.x"];
} 
```

我知道我可以打电话...

```
[anim animationDidStop:(CAAnimation *)theAnimation finished:(BOOL)]; 
```

但我不知道如何使用动画来更改图像`imView`？那么如何使用动画来改变`.image`我的图像视图呢？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:37:30.610

简短的回答是您不能使用 Core Animation 来更改图像视图的图像。Core Animation 在图层上运行，而不是视图。此外，Core Animation 只创建变化的外观。底层实际上根本没有改变。

我建议使用 UIView 动画而不是 CAAnimation 对象。然后您可以使用您的完成方法来更改图像。

UIImage 动画更容易做，它确实改变了你正在制作动画的图像的属性。

基于 UIImage 动画的代码看起来像这样：

```
- (void)performLeft
{
  CGFloat center = imView.center;
  center.x = center.x - 4;
  imView.image = startingImage;  //Set your stating image before animation begins
  [UIView animateWithDuration: 0.2
  delay: 0.0
  options: UIViewAnimationOptionCurveEaseIn
  animations: 
  ^{
     imView.center = center;
  }
  completion:
  ^{
  imView.image = endingImage;  //Set the ending image once the animation completes
  }
  ];
} 
```

# c - 为什么这个简单的 C 示例以段错误结尾？

> ID：14865793
> 
> 赞同：1
> 
> 时间：2013-02-14T00:24:49.980
> 
> 标签：c, segmentation-fault

以下简单示例在尝试访问`m`inside的第一个元素时会导致分段错误`main`。

为什么会这样？

如何修复它，但仍保持代码的整体结构相同？

谢谢。

```
#include <stdio.h>
#include <stdlib.h>

double *array(int cols) {
  return malloc(cols*sizeof(double));
}

void create_and_modify_array(double *m) {
  m = array(10);
  m[0] = 123;
}

void main() {
  double *m;
  create_and_modify_array(m);
  printf("%f\n", m[0]);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T00:28:44.917

这里的问题是 C 总是按值传递。按值传递意味着函数参数是调用它们的变量的*副本*。这意味着当你这样做时：

```
m = array(10); 
```

在里面`create_and_modify_array(double *m)`，你只是改变函数的本地副本`m`点的位置。`m`来自 main 方法的指针不受影响（并且保持未初始化，因此崩溃）。

要解决此问题，您可以将指针传递给`main()`'`m`指针：

```
void create_and_modify_array(double **m) {
  *m = array(10); // change the pointer that `m` points to
  (*m)[0] = 123;  // assign something to the first element of what `m` points to
} 
```

`main()`并将's的地址传入`m`：

```
void main() {
  double *m; // make a pointer to a double
  create_and_modify_array(&m); // pass a pointer to the pointer to the double
                               // or, in alternative wording: 
                               // pass the address of the pointer to the double 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T00:28:47.433

因为在中创建的指针与在中`create_and_modify_array`声明和使用的地址不同`main()`。你可以这样做

```
double *create_and_modify_array(double *m) {
  m = array(10);
  m[0] = 123;
  return m;
}

void main() {
  double *m = create_and_modify_array(m);
  printf("%f\n", m[0]);
  free (m);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T00:35:29.113

它是段错误，因为 m inside`create_and_modify_array`是一个局部变量，所以 m inside`main`仍然是未初始化的。

更明确地说，代码流是：

开头`main` `m`是一个随机的、未分配的内存地址。然后它`create_and_modify_array`用那个内存地址调用。在内部创建`create_and_modify_array`了一个名为的新变量`m`，它具有传入的随机、未分配的内存地址。然后您调用`array`并将其中的变量分配给您分配的内存。`m``create_and_modify_array`

问题是该值`m`never 被传递回`m`in `main`。

为此，您需要将指向 main 的指针传递`m`到`create_and_modify_array`：

```
void create_and_modify_array (double **m) {
    double *tmp = array(10);
    tmp[0] = 123;
    *m = tmp; // This passes the value of tmp back to the main function.
              // As m in this function is actually the address of m in main
              // this line means put tmp into the thing that is at this address
}

void main () {
    double *m;
    create_and_modify_array (&m); // This passes the address of the variable m
                                  // into create_and_modify_array
    printf ("%f\n", m[0]);
} 
```

# r - 对于在时间 1 和时间 2 之间没有发生任何变化的情况，删除所有 id 的情况

> ID：14865798
> 
> 赞同：5
> 
> 时间：2013-02-14T00:25:40.043
> 
> 标签：r, data-management

我有两个包含一系列案例的数据框。一个来自时间 1，一个来自时间 2。我正在寻找一种方法来快速识别时间 1 和时间 2 之间发生变化的情况，但我有点卡住了。

这是一个例子。所以，我有一个从时间 1 开始的数据框，

```
df.t1 <- data.frame(id = c(1,1,1,2,2,3,3,5,5,6), ABC = LETTERS[1:10], Num = 101:110) 
```

它看起来像这样，

```
df.t1
   id ABC Num
1   1   A 101
2   1   B 102
3   1   C 103
4   2   D 104
5   2   E 105
6   3   F 106
7   3   G 107
8   5   H 108
9   5   I 109
10  6   J 110 
```

时间两滚

```
df.t2 <- df.t1 
```

并且发生了一些变化，

```
df.t2[3,3] <- 104
df.t2[2,2] <- "H"
df.t2[8,3] <- 999
df.t2[10,3] <- NA
df.t2[11,] <- c(3, "J", 107) 
```

这是时间 2，

```
df.t2
   id ABC  Num
1   1   A  101
2   1   H  102
3   1   C  104
4   2   D  104
5   2   E  105
6   3   F  106
7   3   G  107
8   5   H  999
9   5   I  109
10  6   J <NA>
11  3   J  107 
```

我现在正在寻找一种快速删除案例的方法，所有 id，对于在时间 1 和时间 2 之间的案例（任何行）中没有发生任何变化的情况。在具体示例中，只有 id #2 没有变化发生在时间 1 和时间 2 之间。

我正在寻找一个看起来像这样的最终结果，

```
(df <- subset(df.t2, id != 2))
   id ABC  Num
1   1   A  101
2   1   H  102
3   1   C  104
6   3   F  106
7   3   G  107
8   5   H  999
9   5   I  109
10  6   J <NA>
11  3   J  107 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:52:54.000

我认为这会奏效。使用的解决方案`data.table`：

```
require(data.table)
dt1 <- data.table(df.t1)
dt2 <- data.table(df.t2)
# your conversion made them characters
dt2[, `:=`(id = as.numeric(id), Num = as.numeric(Num))]
setkey(dt1, "id", "ABC")
setkey(dt2, "id", "ABC")
dt <- dt1[dt2]
dt2[id %in% dt[, !(all(Num == Num.1)) | any(is.na(c(Num, Num.1))), by=id][V1 == TRUE]$id]

#    id ABC Num
# 1:  1   A 101
# 2:  1   C 104
# 3:  1   H 102
# 4:  3   F 106
# 5:  3   G 107
# 6:  3   J 107
# 7:  5   H 999
# 8:  5   I 109
# 9:  6   J  NA 
```

或者，在获得后`dt = dt1[dt2]`：

```
dt2[id %in% dt[, ctr := Num %in% Num.1, by=1:nrow(dt)][ctr == FALSE, unique(id)]] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T01:12:07.337

如何使用 data.table 和所有的键控`id`，`ABC`和`NUM`

```
require(data.table)
dt1 <- data.table(df.t1)
dt2 <- data.table(df.t2)
# your conversion made them characters
dt2[, `:=`(id = as.numeric(id), Num = as.numeric(Num))]
setkey(dt1, "id", "ABC", "Num")
setkey(dt2, "id", "ABC", "Num")
# then it is just

dt2[dt2[!dt1][,list(unique(id))]]

   id ABC Num
1:  1   A 101
2:  1   C 104
3:  1   H 102
4:  3   F 106
5:  3   G 107
6:  3   J 107
7:  5   H 999
8:  5   I 109
9:  6   J  NA 
```

这在 dt2 和 dt1 之间使用非连接，从中选择唯一的 id 值，然后`dt2`适当地对数据进行子集化。

关于键中的 NA 值有问题的警告....

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T00:40:05.330

试试这个：

```
df.t1$interact <- with(df.t1, interaction(id, ABC, Num))
df.t2$interact <- with(df.t2, interaction(id, ABC, Num))

change.ids <- unique(df.t2$id[!df.t2$interact %in% df.t1$interact])
new.df <- df.t2[df.t2$id %in% change.ids,] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-14T03:30:34.790

我真的很喜欢@alexwhan 在这里的回答[https://stackoverflow.com/a/14865931/210673](https://stackoverflow.com/a/14865931/210673)，但听起来组合很慢，因为有很多列和长字符串。我想知道在数字上为每个组合获取一个唯一的数字是否会更快。

```
# get a matrix of unique integers for each column (stacking the two data frames)
ms <- do.call(cbind, lapply(seq_len(ncol(df.t1)), function(ni) {
  xi <- c(as.character(df.t1[[ni]]), as.character(df.t2[[ni]]))
  match(xi, unique(xi))
}))
# convert to base max(ms) to get a single unique identifying number
us <- as.vector(ms %*% max(ms)^c(0:(ncol(ms)-1)))
u2 <- us[(nrow(df.t1)+1):length(us)]
u1 <- us[1:nrow(df.t1)]
# now get changed values and proceed as in alexwhan's answer
ch <- unique(df.t2$id[! u2 %in% u1])
df.t2[df.t2$id %in% ch,] 
```

这是获取`us`变量的一种稍微不同的方法，我希望它会慢一点，但更注意将所有内容保留为整数而不是浮点数字，因此应该保证唯一性，我相信任何浮点溢出都会导致警告。（我也减去了一个，`ms`因为它仍然是独一无二的，而且一切都小了一点。）

```
base <- as.integer(max(ms)^c(0:(nrow(ms)-1)))
us <- apply((ms-1L) * base, 2, sum) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-14T01:45:12.493

好的，这是一个带有一些循环的替代方案。我还没有尝试过更复杂的示例，但请看一下：

```
no.change <- vector()
#identifies rows which don't change
for(i in 1:nrow(df.t2)) { 
    for(k in 1:nrow(df.t1)) {
    if(all(df.t2[i,]==df.t1[k,],na.rm=TRUE)) #na.rm gets rid of error
   no.change <- c(no.change, i)
  }
}
# gets ids from all the other rows
id.change <- df.t2$id[-no.change]
df <- df.t2[df.t2$id %in% id.change,] 
```

# image - 如何将图像添加到标题的末尾？

> ID：14865800
> 
> 赞同：0
> 
> 时间：2013-02-14T00:25:44.370
> 
> 标签：image, wordpress, widget

我有一个 wordpress 网站，我需要在每个标题的末尾添加一张图片。问题是这些是小部件，所有文本都被 wordpress 中的小部件替换。有没有办法可以将图像硬编码到标题的末尾，这样它就不会被删除？

```
<div class="grid_4 widget">
<?php if ( !function_exists('dynamic_sidebar') || !dynamic_sidebar('Footer 1') ) : ?>
<h2 class="beeh2">Widgetized Area 1</h2>
<p>Go to Appearance - Widgets section to overwrite this section. Use any widgets that fits you best. This is called <strong>Bottom Left</strong>.</p>
<?php endif; ?> 
<div class="clear"></div>
</div>

<div class="grid_4 widget">
<?php if ( !function_exists('dynamic_sidebar') || !dynamic_sidebar('Footer 2') ) : ?>
<h2 class="beeh2">Widgetized Area 2</h2>
<p>Go to Appearance - Widgets section to overwrite this section. Use any widgets that fits you best. This is called <strong>Bottom Middle</strong>.</p>
<?php endif; ?> 
<div class="clear"></div> 
```

我还注意到，当我查看网站时，我创建的 h2 类也不存在。这似乎也被覆盖了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T05:19:51.617

Inside of your functions.php (or file included there) you should see "register_sidebar". Footer 1 and Footer 2 are custom sidebars and are probably overwriting the code you are placing in the widget. Look for something like the code below.

```
register_sidebar( array(
    'name'          => 'Footer 1',
    'id'            => 'footer-1',
    'before_widget' => '',
    'after_widget'  => '',
    'before_title'  => '',
    'after_title'   => '',
) ); 
```

The 'before_title' and 'after_title probably contain your h2\. Using html you can add your image in the 'after_title'.

Hope that helps!

# java - Java 向下移动数组元素

> ID：14865802
> 
> 赞同：2
> 
> 时间：2013-02-14T00:26:02.380
> 
> 标签：java, arrays, sorting, shift

我目前正在努力编写一个循环，该循环从 an 中的某个点开始`Array`并将其向下推到正确的一个位置，以便可以在现有值所在的位置放置一个新值，即插入排序。

到目前为止，我有一个循环可以找到值所在的位置：

```
int hold=0;
 for (int j = 0; j < nElements; j++)   
 {
    int temp = list[j];
    if (temp <= value)
    {
       hold = j;  
    }

 } 
```

我现在正在写 for 循环来改变一切。我有：

```
for (int j = hold; j >= numElements; j--)
 {
     int temp = list[j];
     list[j] = value;

     list[j+1] = temp;

    } 
```

nElements 是我存储在数组中的当前整数的数量。

所有这一切只是在我调用将整数添加到数组的方法时在点 0 中插入第一个数字。当再次调用该方法时，根本不会添加该数字。

我也不能使用预定义的方法，例如`System.arraycopy()`. 我需要对循环进行编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:27:40.480

你应该使用`System.arrayCopy()`.

实际上，您并没有复制任何内容，因为您是从 while 开始`hold`并循环，而`j >= nElements`这永远不会发生。

为了腾出空间，你需要使用类似的东西：

```
System.arrayCopy(list, hold, list, hold+1, nElements - hold - 1); 
```

**现在添加**我们发现我们不能使用系统调用：

或者，如果`arrayCopy`不允许，您将需要一个循环，例如：

```
for ( int i = nElements - 1; i > hold; i-- ) {
  list[i] = list[i-1];
} 
```

请注意，此代码故意未经测试，因为此问题可能是家庭作业。

# javascript - d3 不产生任何输出

> ID：14865804
> 
> 赞同：0
> 
> 时间：2013-02-14T00:26:17.847
> 
> 标签：javascript, d3.js

我的数据是非常耀眼的形式，除了一些小的变化..

其格式如下：

```
[
  {"name":"topic_1","children":[{"name":"foo",size:1},{"name":"bar",size:2}]},
  {"name":"topic_2","children":[{"name":"foob",size:12},{"name":"bbar",size:2}]}
] 
```

我正在尝试进行这种可视化

```
 http://bl.ocks.org/4063530 
```

其余代码完全相同

但它不起作用，我的意思是我没有看到任何可视化。

任何建议将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T11:07:40.877

JSON 文件中没有根节点。它应该看起来像...

```
{
  "name": "flare",
  "children": [
      {"name":"topic_1","children":[{"name":"foo","size":1},{"name":"bar","size":2}]},
      {"name":"topic_2","children":[{"name":"foob","size":12},{"name":"bbar","size":2}]}
    ]
} 
```

* * *

**或者，如果您只粘贴了 JSON 文件的摘录**

由于文件已加载，`XMLHttpRequest`因此它必须通过 HTTP。如果文件是本地文件并且没有由 Web 服务器提供，您的数据将永远不会加载，并且会`XMLHttpRequest cannot load file:///..... Cross origin requests are only supported for HTTP.`在 JavaScript 控制台中看到

# php - 将数据库表划分为时间范围（例如年）是否重要？

> ID：14865807
> 
> 赞同：0
> 
> 时间：2013-02-14T00:26:28.597
> 
> 标签：php, database, database-design, normalization

我刚刚开始制作一个 mySQL 数据库，我想弄清楚的问题之一是，“是否有必要将更新我的表划分为时间范围？”。否则，如果 5 年后我进行查询，我将从一个更大的表中查询。我不确定 SQL 究竟是如何执行查询的，我不知道如果让表保持原样会不会有任何重大的失败......

实际上，我的表有一个日期列，是候选键的一部分，并且我已经实现了日期范围查询，但是将所有内容都放在一个表中是一件坏事吗？（我确实有多个至少 3NF-4NF 形式的表）

我也看了看[这个](https://stackoverflow.com/questions/14140899/create-a-new-database-table-every-year)问题的答案，尽管我发现答案不是很详细，除了它是一个相对受支持的答案外，没有给出太多解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:50:48.230

关于这个问题有一些关键点和过程。我将尝试回顾一些主要的架构模式。

SQL 的问题从大约 5M 或更多的大行数开始。问题通常是慢查询，如果您的数据库需要不断更新，比如说每秒 2000-3000 次点击，这可能会使您的服务器崩溃。

为了避免繁重的慢查询，您需要映射公共表函数并将它们一般划分为 SELECT 和 INSERT/UPDATE。

对于 SELECT，我建议使用 INNODB 表来避免表锁定，并考虑运行 Chron 过程（将在您的服务器上自动运行的脚本），这将创建一个较小的表，该表将比生命周期表保存更短的时间段。这将确保一个小尺寸的桌子可以快速工作。

如果您计划制作大量热门歌曲。我建议这个想法将主表大小保持在 15GB 以下，确定从此时起将有一个存档数据库的时间范围。每天以小块从主表复制到存档。确保存档不受大小限制（选择正确的服务，例如亚马逊的 S3 可以很好地存储 SQL 转储文件。但这不是您无法打开的 SQL 服务器，您需要将其解压缩到 SQL这可能需要很长时间。因此存档需要是 SQL 服务器）存档模式 - 使用具有大量 RAM（128-256 GB）4-8 CPU 的 SQL 服务器，将表格分成表格以获取时间框架。尝试将其保持在 20M 行中。

. 创建一个到主表的复制过程 - >一个只有读取用户许可的从数据库。现在，此设置将确保您的表可以被点击，它有一个备份，并且您将所有数据保存在一个存档中。另一个很棒的功能是现在您可以将所有 SELECT QUERIES 发送到从数据库。它将确保您的 SQL 不会卡住，您可以使用它来创建 YEAR、MONTH、DAY 聚合查询，而无需考虑表大小。

这个计划适用于任何免费版本的 MYSQL 和我知道的每台服务器。

如果您想要更强大的解决方案并且时间不是您系统的主要问题，我推荐 GOOGLE 应用引擎\亚马逊云。无限的存储和计算。

您可以通过慢查询日志检查您的性能，并修改您的数据库以保存更多表以加快您的 SQL。如果您将为多个用户使用同一张表，我认为您可以查看 Memcash 解决方案，这些解决方案非常适合反复显示数据并节省连接和查询数据库的时间。

关于主从关系的几点说明：

因为你不能从你的奴隶（读取用户）中删除，为了删除数据，你必须从主表中清除它。也许以前不清楚，但是当将数据放入存档时，您从从属设备中选择数据（同样不要加载大量选择）并复制它，然后从主表中删除这些数据。复制过程也会从从属设备中删除它。因此，当存档过程发生时，主要和从属几乎一直都是相同的。另一点是流量成本..如果从属服务器和主服务器在同一台服务器上，它会更便宜，但如果服务器出现故障..所以你把它们放在一起。希望您将存档放在不同的服务器上。如果流量较少，您可以在不同的服务器上使用从属服务器，并随时进行完整备份以显示数据。

希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:31:35.610

除非您正在处理非常大的数据集或 5 年内不会被触及的系统......当您遇到问题并且必须进一步对数据进行分片/分区时，您很可能已经更改了数据库引擎。

这是在不知道您的数据集的上下文的情况下...

# jquery - jQuery 选项卡淡入淡出

> ID：14865808
> 
> 赞同：0
> 
> 时间：2013-02-14T00:26:40.420
> 
> 标签：jquery, html, tabs

我只需要在我的标签中添加淡入淡出效果。我试过这个：但没有用。

代码如下：

[http://jsfiddle.net/Chead/8cgR7/](http://jsfiddle.net/Chead/8cgR7/)

```
<script type="text/javascript">
            var $k = jQuery.noConflict()

            $k(function() {
               $k('#full-tab').tabs({
                 fx: {
                opacity:'toggle'   
                    }
                    });
                });
</script> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:56:08.830

```
$('#full-tab').tabs('option', 'fx', { opacity: 'toggle', duration: 'fast' }); 
```

当然，您必须使用 jquery-ui。

# c - 使用文件数组时如何更改生成的文件名？

> ID：14865811
> 
> 赞同：1
> 
> 时间：2013-02-14T00:26:51.770
> 
> 标签：c

我是编程新手，我有一个问题，我需要制作许多文件以写入 >15，所以我不想手动执行，我使用了文件数组。这很好用，但是当我需要给出每个文件的位置并且通过使用“for cyclus”我无法更改目标中的文件名时，问题就开始了，这是代码的一部分......

```
#include <stdio.h>
main()
{
int i;
FILE *files[14];
for(i=0;i<15;i++)
files[i]=fopen("C:\\File.txt" ,"w");
}
for(i=0;i<15;i++)
fclose(files[i]);
getch();
} 
```

问题出在 fopen 函数上，因为它只打开第一个文件，而不打开其他文件...如果您需要更多解释，请询问将尝试尽可能多地证明...谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:33:22.797

您只提供一个名称，因此您不是尝试打开 15 个文件，而是尝试打开一个文件 15 次。除非您指定共享模式，否则将失败（至少对于 Windows 上的大多数编译器，这似乎是您正在使用的）。

我的猜测是你想打开 15 个不同的文件，在这种情况下你需要指定 15 个不同的文件名。这样做的一种可能性是合成包含索引的名称。由于您似乎正在使用 C（尽管有`c++`标签），所以我暂时坚持使用 C。

```
int i;
FILE *f[15];

for (i=0; i<15; i++) {
    char name[32];

    sprintf(name, "File%d.txt", i);
    f[i] = fopen(name, "w");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:32:10.507

您需要做的是首先定义您将使用的文件数组。

因此，当您声明 FILE *files[14] 时，您需要实际指定每个文件是什么。

您应该首先声明一组字符串，而不是使用特定的文件名，然后循环遍历它们。

另外，你的 for 循环是错误的，应该是

```
for(i = 0; i < 14; i++) {
...
} 
```

您需要从 0 开始索引，并在 13 停止索引。

# javascript - 如何使用 curl.js 加载对象？

> ID：14865820
> 
> 赞同：0
> 
> 时间：2013-02-14T00:27:26.833
> 
> 标签：javascript, module, requirejs, amd, curl.js

[卷曲 0.7.3](https://github.com/cujojs/curl)

我从这里得到了一些 AMD/CommonJS 适配器代码： [同时支持 CommonJS 和 AMD](https://stackoverflow.com/questions/13673346/supporting-both-commonjs-and-amd)

```
(function (name, definition) {
      if (typeof module != 'undefined') {
        module.exports = definition();
      }
      else if (typeof define == 'function' && typeof define.amd == 'object') {
        define(name, [], definition);
      }
      else {
        this[name] = definition();
      }
    }('modXyz', {
          sayHi:function (name) {
            console.log('Hi ' + name + '!');
          }
        }
    )); 
```

我想将该代码与[Curl](https://github.com/cujojs/curl)一起使用，以使我的所有代码与 AMD/CommonJS 兼容。我期望能够做到的是：

```
greeter = curl(['modXyz']); 
greeter.sayHi("Gracie"); 
```

但是`curl`返回的对象不是我期望的对象。我能得到的最接近的是：

```
curl(['modXyz'], function(mod) { window.greeter = mod; }); 
greeter.sayHi("Gracie"); 
```

这似乎违背了 AMD 的目的。curl 有能力做这样的事情吗？我必须使用[require.js](http://requirejs.org/docs/whyamd.html)来实现它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:20:24.580

因为浏览器远离它的资源，它要么在获取这些资源时阻塞主线程，要么必须异步获取它们。由于我们不应该阻塞主线程（实际上使浏览器无响应），我们必须异步获取资源。（任何 AMD loader、RequireJS、dojo 等都一样）

因此，像下面这样的事情是行不通的：

```
var foo = require('lib/foo'); 
```

好吧，它不能在您可能习惯于在浏览器中使用的通常的全局空间中工作。但是，它*可以*在受控环境中工作，例如在 AMD 模块内部。

**第 1 步：在模块内编写代码。**

**第 2 步：编写一个引导模块来启动您的应用程序。**

```
<script src="lib/curl/src/curl.js"><script>
<script src="myapp/run.js"><script> 
```

在 run.js 内部：

```
// curl 0.7.x requires a named module here ('myapp/run')
define('myapp/run', ['curl'], function (curl) {
    curl.config(
        baseUrl: '',
        packages: [ /* configure your 3rd-party packages */ ],
        paths: { /* configure any non-package 3rd-party libs here */ },
        preloads: [ /* put modules that *must* be loaded first here (e.g. shims) */ ],
        main: 'myapp/main'
    });
}); 
```

“myapp/main”可能看起来像这样：

```
define(function (require) {
    var view1 = require('myapp/view1/controller');
    view1.render();
    view1.placeAt('body');
}); 
```

在主模块（或任何 AMD 模块）内部，`require`行为更像我认为您所期望的。请注意，这是一个特殊的 AMD 签名。您不能在 中指定依赖项`define`并期望 具有这样的`require`行为。您必须*仅以*一种方式指定您的依赖项。这将不起作用：

```
define(['myapp/view1'], function (view1) {
    var foo = require('foo');
}); 
```

希望这可以帮助。

- 约翰

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T07:33:56.203

CurlJS 和 RequireJS 都支持 AMD**和**CommonJS 的 require 调用模式：

CJS 和 AMD 之间的区别在于使用 Array 作为依赖项列表的包装器。另请注意，在 CurlJS 的配置中，您可以使用别名`curl`来`require`使您的代码与 AMD 规范完全兼容。观察：

CJS 需要调用模式：

```
var a = require('name') 
```

**只有**CurlJS AMD 需要调用模式：

```
var promise = require(['name'])
promise.then(callbackFunction) 
```

这通常可以缩短为：

```
require(['name']).then(callbackFunction) 
```

注意，CurlJS 返回一个 Promise 对象不是 AMD 规范的一部分。AMD 规范似乎没有规定 AMD 风格的 require 调用的返回值。

RequireJS 和 CurlJS 都支持标准的 AMD 要求调用模式：

```
require(['name'], callbackFunction) 
```

同样，请注意使用 Array 作为标志，这是 AMD 风格的要求。这会触发返回值的不同逻辑。

为了让你的东西按你的意愿工作，在 CurlJS 上，你的代码必须在一个被包装的模块中，就像它是一个 CommonJS 模块一样，使用：

```
define(function(require) { ... }); 
```

有人告诉我，在这种情况下，`require`你得到的行为类似于 CommonJS 风格`require`- 同步。实际上，幕后发生的事情是加载器扫描工厂函数以查找您需要的东西，并将它们折叠到该定义的需求列表中。然后，在工厂内部，您可以执行以下操作：

```
var greeter = require('modXyz'); 
greeter.sayHi("Gracie"); 
```

请注意，“同步”行为仍然是一种错觉，因为实际发生的是预加载检测到的所需资源。

在 RequireJS 上，甚至 global`require`也可以称为 CJS style: `var resource = require('resource/path')`，但前提是您**之前**已经加载了它。

换句话说，在工厂函数运行之前，CurlJS 和 RequireJS 中的加载总是异步进行的，但是在 RequireJS 中，您几乎可以在任何地方使用它，而在 CurlJS 中，这是非常小众的场景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T00:50:54.063

curl 函数是异步的，并返回一个承诺。因此，您只能将结果作为传递给 curl 的回调，或者通过传递给 then 的回调（一旦 promise 被实现就调用。

```
curl(['dep1', 'dep2', 'dep3' /* etc */], callback); 
```

或者

```
curl(['dep1', 'dep2', 'dep3' /* etc */])
    .then(callback, errorback); 
```

# javascript - 奇怪：函数未定义

> ID：14865822
> 
> 赞同：0
> 
> 时间：2013-02-14T00:28:01.880
> 
> 标签：javascript, html, xml, dom

我在我的元素中写了以下内容：

```
<form name="myform" method="POST" id="location">
<input type="text" name="URL" maxlength="255" size="100" value="" />
<br />
<input type="button" onclick="loadXML(this.form)" name="submit" value="Submit Query" />
</form> 
```

然后我在 ; 部分定义了我的函数 loadXML() 但每次我尝试运行这个 html，firefox 都会显示：

ReferenceError:loadXML 未定义 loadXML(this.form)

我检查了我的代码很多次，我确定没有拼写错误，这是怎么发生的？我该如何纠正？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:34:16.743

`loadXML`仅在 IE 中可用。否则，您要使用该[`DOMParser`](https://developer.mozilla.org/en-US/docs/DOM/DOMParser)对象。事实上，我会首先依赖*现有*的：

```
if (typeof DOMParser !== 'undefined') {
    var dom = new DOMParser();
    dom.parseFromString(this.form, "application/xml");
}
else {
    loadXML(this.form);
} 
```

# java - 初学者 Java 挑战

> ID：14865823
> 
> 赞同：3
> 
> 时间：2013-02-14T00:28:05.490
> 
> 标签：java

有没有我可以去的网站，对不同级别的编码员有相当多的挑战？我希望每个经验级别都有一个庞大的列表，但我现在正在寻找适合初学者挑战的列表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T00:29:57.143

[codingbat.com](http://codingbat.com/)是我个人的最爱之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T00:31:33.033

我会查看[Top Coder](http://community.topcoder.com/tc?module=ProblemArchive)。您可以浏览过去比赛中的所有问题档案并进行练习。它们都分为从相当简单到相当困难的 3 个难度级别。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T00:32:18.770

即使我用 Python 编程，这也可以为你工作。在网上寻找 Python 程序，然后尝试用 Java 做同样的事情。这让我一开始就走得很远，试图学习如何做简单的猜谜游戏和纸牌游戏。

# java - 遍历正则表达式查找

> ID：14865826
> 
> 赞同：8
> 
> 时间：2013-02-14T00:28:48.307
> 
> 标签：java, regex

```
输入-> 输入！RC + 计算！R[1]C[1]

```

在输出中我想对这些进行操作：

```
RC 和 R[1]C[1]

```

我的尝试：

```
私人静态无效findMatch（字符串公式）{
         匹配器 m = Pattern.compile("\\W(R(\\[(.+?)\\])?C(\\[(.+?)\\]))")
         .matcher(公式);
        // 匹配器 m = Pattern.compile(
        // "\\W(R(\\[(.+?)\\])?C) | \\W(R(\\[(.+?)\\])?C(\\[( .+?)\\]))")
        // .matcher(公式);
        for (; m.find(); m.reset(公式)) {
            System.out.println(m.group(3));
        }

    }

```

它也不会寻找第二种模式，它会进入无限循环。

这有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T00:39:58.870

尝试以下操作：

```
String formula = "Input!RC + Calc!R[1]C[1]";
Matcher m = Pattern.compile("\\W(R(\\[(.+?)\\])?C(\\[(.+?)\\])?)").matcher(formula);
while (m.find()) {
    System.out.println(m.group(1));
} 
```

输出：

```
RC
R[1]C[1] 
```

这里的主要变化是循环的工作方式，我上面所说的是迭代模式匹配的典型方式。我也在打印`m.group(1)`而不是`m.group(3)`因为它是第一个包含整个匹配项的组，除了`!`，我认为这是你想要的。

此处对正则表达式的唯一更改是`?`在第二`(\\[(.+?)\\])`组之后添加以使其可选。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T00:40:04.843

如果你看这段代码：

```
for (; m.find(); m.reset(formula)) {
    System.out.println(m.group(3));
} 
```

对于每个循环，它会依次调用`m.reset(formula)`，重置匹配器，使其从 0 开始，然后`m.find()`，它会在字符串中查找下一个匹配项。既然你`reset()`之前打过电话，下一场比赛就是第一场比赛。因此，您有一个无限循环。

如果要查找字符串中的所有匹配项，只需编写：

```
while(m.find()) {
    System.out.println(m.group(1));
} 
```

# java - JUnit Class Path和ContextClassLoader不一致还是我的误解

> ID：14865831
> 
> 赞同：0
> 
> 时间：2013-02-14T00:28:59.390
> 
> 标签：java, junit, classloader

我想要做的是从 jar 加载 .class 文件（编译的类文件）作为资源流。此尝试是从 JUnit 测试用例内部进行的。

1.  测试用例编译并运行没有问题所以：AFAIK资产类应该在类路径中可用
2.  完整的类名需要与其在文件结构中的位置一致 SO：我们可以用目录分隔符替换包名中的点来获取类文件位置
3.  我们可以使用 getResourceAsStream 方法访问当前类路径中的所有内容。

让我提供一些代码以便更好地理解。

```
package org.jboss.shrinkwrap.impl.nio.file;    
import org.jboss.shrinkwrap.api.asset.Asset;

public class FileStoreTestCase {
// (...)
@Test
public void usedSpace(){    
    final Class<?> classToAdd = Asset.class;
    final String pathToClass = new StringBuilder(classToAdd.getName().replace('.', File.separatorChar)).append(
            ".class").toString();

    final InputStream in = Thread.currentThread().getContextClassLoader().getResourceAsStream(pathToClass);

} 
```

问题是在上面的代码中，“in”变量总是空的。你知道为什么吗？我怎样才能让它工作？

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:59:55.937

尝试使用 replace('.', '/') 即使用 '/' 而不是 File.separatorChar

# jquery - jQM调用后var不更新？

> ID：14865832
> 
> 赞同：0
> 
> 时间：2013-02-14T00:29:12.443
> 
> 标签：jquery, jquery-mobile

我在 jQuery Mobile 中工作。

当您点击 Page1 时，我正在使用 PHP 将页面 ID 设置为隐藏输入。

```
<input type="hidden" name="frmlid" id="frmlid" value="<?=$page_id;?>" /> 
```

当我单击一个按钮时，它会执行一些 jQuery，它会获取 frmlid 的值并发出警报。这工作正常。

```
$(btnShowComments).bind('touchstart mousedown', function(e){
    e.preventDefault();

    var frmlid = $("#frmlid").val();
    alert(frmlid);
}); 
```

现在，假设我从 Page1 上的链接导航到 Page2。jQM 做它的事情并加载它所做的任何花哨的 ajax 东西。Page2 和 Page1 一样，通过 PHP 设置输入值。

这次单击 btnShowComments 时，它会提醒上一个 page_id (Page1) 而不是 Page2。

当 jQM 加载新页面时，如何让它不断更新？如果我右键单击并查看 Page2 上的源代码，输入的值实际上是 Page2。但似乎我的 jQuery 代码没有更新/获取新值。

有小费吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T02:45:25.453

使用 jqm 当您打开第一页时，所有页面实际上都在加载，因此无论您在哪个页面，所有页面都已加载并呈现，但它只显示您所在的页面。

所以首先你不能（最好不要）在所有页面中都有一个具有相同 id 的输入，而是使用 class 。

第二个假设您在每个页面上都有一个按钮，并且靠近它的隐藏输入，您必须获得最接近 tuched 按钮的输入，即与按钮在同一页面中的输入

您还可以找到按钮的父 div，然后在该 div 中找到输入

```
<input type="hidden" name="frmlid" class="frmlid" value="<?=$page_id;?>" /> 
```

和jq代码

```
$(btnShowComments).bind('touchstart mousedown', function(e){
    e.preventDefault();

    var frmlid = $(this).closest('.frmlid').val();
    alert(frmlid);
}); 
```

# jquery - 将光标更改为圆形？

> ID：14865833
> 
> 赞同：1
> 
> 时间：2013-02-14T00:29:14.753
> 
> 标签：jquery, css, canvas, cursor

我正在建立一个网站，其中一部分我有一个白板功能（基本上是一个画布）。我正在尝试为白板实现橡皮擦功能，并且我希望光标在选择橡皮擦时改变形状，以便它与擦除发生的方式相匹配（此时我正在尝试擦除呈圆形）。到目前为止，我已经尝试过：

```
$('#canvasDiv').css('cursor','url(https://example.com/eraser_cursor.png)'); 
```

然而，这不起作用有两个原因：

1.  虽然光标的图像是一个圆圈，但它并没有以光标为中心，所以看起来用户正在擦除其他东西。

2.  一旦用户开始擦除并按住“单击”，光标就会变为不同的形状。

有没有办法解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:34:12.937

1.  还有“x y”选项 - `cursor: url() x y`（据我所知仅适用于 FF/Chrome）

2.  我认为`!important`应该解决它

# ruby-on-rails - 使用 Sorcery 注册的用户登录

> ID：14865835
> 
> 赞同：1
> 
> 时间：2013-02-14T00:29:33.037
> 
> 标签：ruby-on-rails, sorcery

我有使用 Sorcery 的身份验证。当用户注册时，我想自动让他们登录。

用户控制器

```
def create
@user = User.new(params[:user])

if @user.save
  flash[:success] = "Welcome to Christian"
  redirect_to root_url
else
  render :new
end 
```

结尾

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T00:58:45.897

`auto_login(user)`应该做的伎俩：

```
...

if @user.save
  auto_login(@user)
  flash[:success] = "Welcome to Christian"
  redirect_to root_url

... 
```

# sql - SQL 和外键：如何正确链接这两个表？

> ID：14865836
> 
> 赞同：4
> 
> 时间：2013-02-14T00:29:38.823
> 
> 标签：sql, firebird

我正在为我的大学创建一个 Delphi 应用程序，但现在我陷入了困境。该程序是关于数据库的，我使用 FireBird 2.1 作为数据库服务器。我的数据库和应用程序是关于 Linux 发行版的。

我正在尝试链接我的 Firebird 数据库中的两个表。第一个表提供有关分发的信息，第二个表提供有关桌面环境的信息。我要链接两个字段：分布表中的默认桌面环境和 DEs 表中的桌面环境名称。

一个发行版只能有一个默认桌面环境，即安装光盘上的（或用户在安装过程中选择的）。在 DEs 表中，有一个唯一字段，描述了 DE 的名称，因此它应该链接到 Distributions 的 Default DE 字段。

**但是，一个 DE 可以被多个**发行版用作默认 DE ，这就是冲突所在：发行版表中的默认 DE 字段必须是唯一的，但事实并非如此。我想要达到的是参照完整性：使 DEs 表依赖。

另外，我尝试创建仅包含 DISTR_NAME 和 ENV_NAME 字段的第三个表，但我唯一能做到的就是使第三个表依赖于 DISTROS 和 DES 表，但这是错误的。DES 表应该依赖于 DISTROS 表，我不知道该怎么做。所以任何帮助将不胜感激！如何正确链接这两个表？

所以我创建了这两个表：

```
CREATE TABLE DISTROS (
    DISTR_NAME  VARCHAR(50) NOT NULL,
    ARCHITECT   VARCHAR(50) NOT NULL,
    DEFAULT_DE  VARCHAR(50) NOT NULL,
    LASTSTABLE  VARCHAR(50) NOT NULL,
    PACKMANAGE  VARCHAR(50) NOT NULL
); 
```

和

```
CREATE TABLE DES (
    ENV_NAME    VARCHAR(50) NOT NULL,
    USED_LANG   VARCHAR(50) NOT NULL,
    LASTSTABLE  VARCHAR(50) NOT NULL,
    SUPPORT_3D  SMALLINT,
    FILEMANAGE  VARCHAR(50) NOT NULL
);
ALTER TABLE DES ADD CONSTRAINT PK_DES PRIMARY KEY (ENV_NAME);
ALTER TABLE DES 
   ADD CONSTRAINT FK_DES_1 FOREIGN KEY (ENV_NAME) REFERENCES DISTROS (DE); 
```

我不知道如何解决这个问题：分布表必须是父表，而 DEs 表必须是子表。分布表应该有主键（DISTR_NAME 字段），而 DEs 表应该有外键（ENV_NAME 字段，与分布表的 DE 字段链接）。

但我不能这样做，因为 SQL 要求分布表的 DE 字段作为主键。并且主键必须是唯一的。但是，一个桌面环境可以被许多 Linux 发行版使用，所以这个字段不可能是唯一的。而且我只是不知道如何正确链接这两个表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T12:26:26.850

正如您所描述的，*发行版*具有默认的*桌面环境*。这意味着从`DISTROS`to的外键`DES`，但是相反，您可以反过来建模外键。外键的目的地需要`PRIMARY KEY`or `UNIQUE CONSTRAINT`，因此您当前的解决方案存在问题。

`DES`解决方案是从to中删除外键`DISTROS`并将其替换为：

```
ALTER TABLE DISTROS 
   ADD CONSTRAINT FK_DISTROS_DES FOREIGN KEY (DE) REFERENCES DES (ENV_NAME); 
```

我建议重新研究 SQL 和关系建模，因为这些是您在使用 SQL 和（关系）数据库时真正需要了解的基础知识。

此外，我知道 Firebird 中标识符的 31 个字符限制可能是个问题，但您应该尝试使用更长的描述性名称（尤其是`DES`和`DE`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T00:41:41.527

你所描述的听起来像是多对多的关系。听起来你几乎是自己一个人在那里。如您所述，M2M 关系中始终存在第三张表。你的最终结构看起来像这样。

```
**DISTROS**
DISTR_NAME - PK/Unique

**DISTROS_TO_DES** (PK contains both fields which are collectively unique)
DISTR_NAME FK to Distros.DISTR_NAME 
ENV_NAME  FK to DES.ENV_NAME

**DES**
ENV_NAME  - PK/Unique 
```

还有一点建议。您确实不希望可能经常更改的主键值，因此 varchar 字段通常是一个糟糕的选择。我建议在 DES 和 DISTROS 表中添加一个自动递增（或身份）ID 字段以用作 PK。

# vb.net - 从源代码（Visual basic 2008 express）生成论坛？

> ID：14865838
> 
> 赞同：0
> 
> 时间：2013-02-14T00:29:46.187
> 
> 标签：vb.net

我以前从未使用过 Visual Basic，也从未使用过任何 GUI 编程语言（我只编写过控制台应用程序），而且我最近将源代码提供给另一个程序员的 Visual Basic 程序（带有 GUI）进行调试，现在在编写 C++ 控制台时应用程序我只是将源代码复制到编译器中，对其进行编辑和编译，但是当尝试使用 Visual Basic 代码执行此操作时，我将源代码复制到编译器中（源代码包含在 Microsoft Word 文档中），并且代码无法编译，“设计者”也根本无法直观地设计程序形式（我也有已编译程序的副本）。

我很困惑为什么将源代码复制到编译器中不会自动生成表单（程序的视觉方面），当我将源代码提供给实际上具有 GUI 的程序时，以及为什么它给了我一系列错误并且根本无法编译（我假设这些错误与我将源代码复制到编译器时未生成的 GUI 有关，因为它们是“事件处理程序”类型的错误）。

我知道这是一个非常简单的问题，但我找不到任何答案，因为这不是我所知道的编程的正统方式，也不是一个容易表达的问题，但这是我被要求做的我很茫然，因为我从来没有用 GUI 编程过，那么我错过了什么？生成GUI的源代码是独立于程序源代码的吗？

我将非常感谢任何帮助，感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T04:33:58.557

如果您拥有的源包含一个“.vbproj”文件，请在 Visual Studio 中打开该文件，它应该加载其余的项目文件，然后从那里运行项目。

但是，如果您没有源的项目文件，您可以随时创建一个新的 VB 项目并相应地复制/粘贴源。

# java - 发出在java中异步上传文件的HTTP请求的最简单方法是什么？

> ID：14865841
> 
> 赞同：1
> 
> 时间：2013-02-14T00:30:07.710
> 
> 标签：java, http, file-upload, asynchronous

在.Net中，如果我想异步上传文件，我只需要调用 System.Net.WebClient 类的 UploadFileAsync() 实例方法，阻塞主线程，直到它接收到来自我传递给 UploadFileAsync() 的等待句柄的信号方法，然后在文件上传后调用的事件处理程序过程中，使用相同的等待句柄向主线程发出信号。以这种方式上传文件的好处是，它还可以订阅一个事件处理程序，每次文件上传进度发生变化时都会调用该程序。

在 Java 中，是否有使用 java.net.URLConnection 类（或类似的东西）实现类似功能的直接方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:32:30.990

是的，使用[`ExecutorService`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html)并提交[`Callable`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Callable.html)对象，然后等到[`future.get()`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html#get%28%29)返回结果。例如：

```
ExecutorService executor = Executors.newSingleThreadExecutor();
Future<Foo> future = executor.submit(new Callable<Foo>()
{
    @Override
    public Foo call() throws Exception
    {
        // ...

        return someFoo;
    }
});

Foo result = future.get(); // result is the same as someFoo, both should refer to the same object 
```

再次注意，`future.get()`在后台线程完成执行之前会一直阻塞`call()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:39:27.637

似乎有[一个优秀的 Apache Http Client 的异步版本](http://hc.apache.org/httpcomponents-asyncclient-dev/examples.html)。我自己没用过，但看起来很有希望。

[Jersey 客户端](http://jersey.java.net/nonav/documentation/latest/client-api.html)还内置了异步请求支持，可以满足您的需求。有一个[测试类](https://svn.atlassian.com/svn/public/atlassian/vendor/jersey/trunk/jersey-tests/src/test/java/com/sun/jersey/impl/client/AsyncHttpMethodTest.java)来演示它的使用。

Jersey 客户端至少提供了请求完成的回调，但我不确定文件上传的进度回调。

# wcf - SignalR WebRequest 正在中止

> ID：14865843
> 
> 赞同：0
> 
> 时间：2013-02-14T00:30:11.677
> 
> 标签：wcf, signalr, system.net.webexception

我在 WCF Web 服务中有一个函数，负责在每次创建 Evento 条目时通过 SignalR 发送通知，它还会检查与 Evento 条目相关的集群在过去一小时内是否有三个或更多条目，如果是的话，然后发送另一个通知。

该函数如下所示：

```
public static void SendEvento(string dispositivoId, Eventos evento)
    {
        Connection conn = new Connection("http://localhost:65097/Index");
        Model1Container context = new Model1Container();
        try
        {
            conn.Start().Wait();
            context.Database.Connection.Open();
            Dispositivos dispositivo = DispositivosDao.GetDispositivo(dispositivoId);
            Pin pin = new Pin(dispositivo.Latitud, dispositivo.Longitud, evento.Fecha, evento.IntensidadMax, dispositivo.UniqueId, dispositivo.Alias);
            List<Pin> lista = new List<Pin>();
            lista.Add(pin);
            var json = new JavaScriptSerializer().Serialize(lista);
            //send the notification
            conn.Send(json).Wait();
            Clusters cluster = ClustersDao.GetCluster(dispositivo.ClustersClusterId);
            List<Dispositivos> dispositivos = cluster.Dispositivos.ToList();
            var cont = 0;
            List<Eventos> listaEventosCluster = new List<Eventos>();
            for (var i = 0; cont < 3 && i < dispositivos.Count(); i++)
            {
                listaEventosCluster.AddRange(dispositivos.ElementAt(i).Eventos.ToList<Eventos>());
            }
            if (listaEventosCluster.Count() > 0)
            {
                listaEventosCluster.OrderByDescending(e => e.Fecha);
                DateTime endHour = evento.Fecha;
                DateTime startHour = endHour.AddHours(-1);
                var inHour = listaEventosCluster.Where(o => o.Fecha >= startHour && o.Fecha <= endHour);
                int count = inHour.Count();
                if (count >= 2)
                {
                    //send another notification if there're 3 or more entries in the last hour
                    json = new JavaScriptSerializer().Serialize(new { Alerta = "Sismo" });
                    conn.Send(json).Wait();
                }
            }
        }
        catch (Exception ex)
        {
            Debug.WriteLine("Error " + ex.Message + " \n Inner Exception " + ex.InnerException + " \n Stack Trace " + ex.StackTrace);
        }
        finally
        {
            conn.Stop();
            conn.Disconnect();
        }
    } 
```

我发送通知没有问题，但是在过去一小时内有 3 个或更多条目时会抛出异常。

这是我得到的异常输出：

```
iisexpress.exe Error: 0 : SignalR exception thrown by Task: System.AggregateException: One or more errors occurred. ---> System.Net.WebException: The request was aborted: The request was canceled.
   at System.Net.ConnectStream.EndRead(IAsyncResult asyncResult)
   at Microsoft.AspNet.SignalR.Infrastructure.StreamExtensions.<>c__DisplayClass4.<ReadAsync>b__1(IAsyncResult ar)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
   --- End of inner exception stack trace ---
---> (Inner Exception #0) System.Net.WebException: The request was aborted: The request was canceled.
   at System.Net.ConnectStream.EndRead(IAsyncResult asyncResult)
   at Microsoft.AspNet.SignalR.Infrastructure.StreamExtensions.<>c__DisplayClass4.<ReadAsync>b__1(IAsyncResult ar)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)<---

iisexpress.exe Error: 0 : SignalR exception thrown by Task: System.AggregateException: One or more errors occurred. ---> System.AggregateException: One or more errors occurred. ---> System.Net.WebException: The request was aborted: The request was canceled.
   at System.Net.ConnectStream.EndRead(IAsyncResult asyncResult)
   at Microsoft.AspNet.SignalR.Infrastructure.StreamExtensions.<>c__DisplayClass4.<ReadAsync>b__1(IAsyncResult ar)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
   --- End of inner exception stack trace ---
   --- End of inner exception stack trace ---
---> (Inner Exception #0) System.AggregateException: One or more errors occurred. ---> System.Net.WebException: The request was aborted: The request was canceled.
   at System.Net.ConnectStream.EndRead(IAsyncResult asyncResult)
   at Microsoft.AspNet.SignalR.Infrastructure.StreamExtensions.<>c__DisplayClass4.<ReadAsync>b__1(IAsyncResult ar)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
   --- End of inner exception stack trace ---
---> (Inner Exception #0) System.Net.WebException: The request was aborted: The request was canceled.
   at System.Net.ConnectStream.EndRead(IAsyncResult asyncResult)
   at Microsoft.AspNet.SignalR.Infrastructure.StreamExtensions.<>c__DisplayClass4.<ReadAsync>b__1(IAsyncResult ar)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)<---
<--- 
```

我不明白为什么会抛出这个异常，即使我的服务的性能没有被篡改，我担心它可能会导致问题。我怎样才能摆脱这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T08:05:20.193

调用 Connection.Stop() 将中止任何挂起的 HTTP 请求，这是设计使然。还有其他方法可以彻底终止正在运行的 http 请求。

# ios - iOS比较功能

> ID：14865850
> 
> 赞同：0
> 
> 时间：2013-02-14T00:31:17.273
> 
> 标签：ios, objective-c, compare

我试图了解编写比较函数的标准方法是什么。

如果我有一个`Person`具有属性的对象`age`并想编写自己的比较函数。我想使用它，以便 Person 对象从低年龄到高年龄排序。

IE

```
Person *young = [[Person alloc] initWithAge:10];
Person *old = [[Person alloc] initWithAge:80]; 
```

如果我现在运行`[young compare:old]`应该返回`NSOrderedDescending`还是`NSOrderedAscending`？

我不确定哪个对象从哪个对象上升或下降（如果有道理的话）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:35:27.490

最简单的方法是依靠现有的实现

```
- (NSComparisonResult)compare:(Person *)other;
{
  return [@(self.age) compare:@(other.age)];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T01:36:19.203

的结果：

```
[obj1 compare:obj2] 
```

应该：

*   `NSOrderedAscending`如果写为 'obj1, obj2' 时，对象按升序排列；
*   `NSOrderedDescending`如果写为 'obj1, obj2' 时，对象按降序排列；
*   `NSOrderedSame`除此以外。

所以你应该看到：

```
[@2 compare:@3] == NSOrderedAscending
[@"b" compare:@"a"] == NSOrderedDescending 
```

等等。记住它的方法是考虑从左到右阅读正在调用的人。

# ios - 使一台设备上的洗涤器与另一台设备上播放的视频保持同步

> ID：14865851
> 
> 赞同：0
> 
> 时间：2013-02-14T00:31:25.300
> 
> 标签：ios, bluetooth, gamekit, avplayer

我有两台 iOS 设备，并且都有相同视频的副本。两台设备都通过蓝牙进行通信。视频仅在一个设备上播放，而另一个是遥控器。“远程控制”设备需要一个显示视频在持续时间中的位置的擦洗器。

使洗涤器与视频播放保持同步的最佳方法是什么？

我使用 AVPlayer 播放视频，使用 Gamekit 进行蓝牙连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:46:20.643

呵呵，好吧，开始工作会很有趣。延迟是你总会得到的东西，所以你需要一些缓解策略。我建议看看人们处理滞后的某些方式。我可以建议的一件事是将您的两种消息类型分为关键和非关键。例如，停止/暂停/播放/重启命令对我来说很重要。您希望该消息通过，并且您将继续尝试直到它通过。

诸如在两个方向（玩家到遥控器，遥控器到玩家）上改变擦洗器位置的消息是非关键的。您正在发送它们，但您不应该浪费时间来确认响应或确保它们已送达。有点类似于UDP和TCP之间的区别。这些只会通过连接发送，我基本上不会让包比（scrubberposition，position_as_time，identifier_number）更复杂。记录您获得的最后一个标识符号（标识符号是一个单调递增的数字）并丢弃任何低于此数字的消息，并更新到任何更高数字的位置，并更新您存储的 identifier_number。

我希望这有意义/有帮助，如果我需要进一步解释，请告诉我，祝你好运

# haskell - 从一个元组中的两个列表中求和对应的对 - 在 Haskell 中

> ID：14865855
> 
> 赞同：3
> 
> 时间：2013-02-14T00:31:36.063
> 
> 标签：haskell, map, sum, tuples, transpose

我有一个包含两个数字列表的元组 - ([1,2,3,4],[5,6,7,8])

我需要将每个列表中相应的数字对加在一起。即 (1+5)、(2+6) 等。输出列表即 [6,8,10,12]。它也应该适用于列表中的任何数量的元素（2 个 5 个列表、2 个 6 个列表等）。

我一直在尝试使用“map sum . transpose”的函数，但似乎无法获得正确的类型（因为它在元组中）。我在这里找到了一段代码，它适用于列表列表，但不知道如何对列表元组执行相同的操作（可能吗？）。当我尝试更改“a”的类型或使用 Int 时，我编译为类型不匹配错误。

```
tupSums :: Num a => [[a]] -> [a]
tupSums = map sum . transpose 
```

我对使用 Haskell 还很陌生，所以我不太了解我遇到的错误，如果这个问题看起来很愚蠢，我很抱歉。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-14T00:35:38.987

这是一个很好的候选`zipWith`，它接受两个列表并使用特定的运算符组合列表中的相应元素。以下应该有效：

```
tupSums :: Num a => ([a],[a]) -> [a]
tupSums = uncurry $ zipWith (+) 
```

`zipWith (+)`计算为一个接受两个参数的函数，每个参数都是列表，并返回成对和的列表。`uncurry`接受两个 args 的函数并将其转换为接受单个元组的函数。所以`uncurry $ zipWith (+)`计算一个函数，该函数接受一个列表元组并返回一个带有成对和的列表。

# mspec - MSpec 上下文之间如何共享/设置静态对象状态？

> ID：14865859
> 
> 赞同：3
> 
> 时间：2013-02-14T00:32:13.330
> 
> 标签：mspec

在编写一些 MSpec BDD 测试时，我遇到了一个场景，即我期望失败的测试通过了，但只有在我运行所有测试时才通过。当我单独运行测试时，它按预期失败了。经过一番调查，我发现在第二次测试运行之前，之前测试中设置的某些状态没有被重置，这导致第二次测试在我预期失败时通过。以下人为的代码重现了该场景：

```
public class ContextBase
{
    protected static object state;
}

public class Context_a : ContextBase
{
    Establish context = () => { state = new object(); };

    It should_set_state = () => state.ShouldNotBeNull();
}

public class Context_b : ContextBase
{
    Establish context = () => {  };

    It should_set_state = () => state.ShouldNotBeNull();
} 
```

这两个测试都通过了，因为 Context_a 在 Context_b 之前执行，并且在执行 Context_B 时，在 Context_A 中设置的状态仍然设​​置。如果您单独运行 Context_B，则测试失败，因为尚未设置状态。有趣的是，如果您从 Context_B 中删除空的建立语句，那么 Context_B 将始终按预期失败。

我对 MSpec 比较陌生，这种行为让我感到惊讶。我假设这样的状态会在执行每个上下文之间被重置。也许我错过了一些东西......我是否正确构建了这些测试？如果 MSpec 没有在上下文之间自动重置这样的状态，那么我应该使用什么策略来确保在我的示例中的情况下重置状态？我应该在将所有状态字段设置为空的 ContextBase 类上放置一个建立 lambda 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T08:46:00.850

MSpec 不会在执行上下文之间“重置”静态状态。它遵循您从普通静态变量中了解的行为，即它们不会在应用程序（即测试运行）运行时重新初始化，除非您手动执行此操作。最好初始化`Establish`每个上下文中的所有字段。

另一种选择是在您的基类上添加一个额外`Establish`的内容，但这会在您的上下文中隐藏重要信息 - 您必须导航到基类才能看到某个字段已使用特定值初始化。但是 DRY 通常不适用于测试：我更喜欢使用`protected static`从派生上下文调用的方法的基类（请参阅[此答案](https://stackoverflow.com/a/2842244/149264)以获取示例）。

# r - 如何使用 R 找到重叠的社区结构？

> ID：14865863
> 
> 赞同：3
> 
> 时间：2013-02-14T00:32:28.633
> 
> 标签：r, networkx, igraph

我有两个问题：

1-我想知道是否可以使用 igraph 在 R 中发现重叠的社区结构？

2-我发现 LinkComm 包可以做类似的事情（找到重叠的社区结构）但它不能接受 igraph 网络，是否可以将 LinkComm 函数应用于 igraph 图？

提前致谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T07:23:57.437

`linkcomm`这是将包与`igraph`对象一起使用的（相当肮脏的）技巧。困难在于`linkcomm`使用`igraph0`包并且`igraph`直接使用对象的字段，这*不*建议。他们的方法适用于`igraph0`包，但不适用于`igraph`包，因为它`igraph`定义了`[[`igraph 图的索引运算符。

无论如何，以下只是覆盖`linkcomm`包中的一个函数。它适用于包版本 1.0-6 (2011-05-27)，并且几乎肯定不会适用于任何其他版本。正确的解决方法是`linkcomm`由其作者更新包。

```
library(linkcomm)

# This will result a long warning about masked objects, because igraph 
# defines almost all names igraph0 defines, and linkcomm loads igraph0.
# But we are fine if we load igraph after linkcomm, because by default
# the igraph functions will be used
library(igraph)

# Modify the function from the linkcomm package, we create a new 
# function called 'lc'
lc <- as.list(getLinkCommunities)
lc[[11]][[10]][[3]] <- call("get.edgelist", quote(x), names=FALSE)
lc <- as.function(lc)

# Get some test data
karate <- nexus.get("karate")

# Use the newly defined 'lc' function on the test data
karcomm <- lc(get.data.frame(karate), check.duplicates=FALSE) 
```

![结果图](../Images/a8510593df607a67026336eb618d2a70.png)

# codeigniter - CodeIgniter PHP 错误登录表单

> ID：14865865
> 
> 赞同：1
> 
> 时间：2013-02-14T00:32:33.700
> 
> 标签：codeigniter, login, php

我正在使用代码点火器处理登录表单。我可以让表单正常显示，但是当我单击登录时，我会显示以下错误：

```
A PHP Error was encountered

Severity: Notice

Message: Undefined property: CI_DB_mysql_driver::$query

Filename: models/membership_model.php

Line Number: 8 
```

这是 m members_model.php 文件

```
 class Membership_model extends CI_Model{

    function validate(){
        $this->db->where('username', $this->input->post('username'));
        $this->db->where('password', md5($this->input->post('password')));
        $this->$query = $this->db->query->get('members');

        if($query->num_rows != 0){
            return true;
        }
    }

} 
```

这是我的 login.php 文件，它是我的主控制器。

```
class Login extends CI_CONTROLLER{

function index()
{
    $data['main_content'] = 'login_form';
    $this->load->view('includes/template', $data);
}

function validate_credentials()
{
    //load model to query db
    $this->load->model('membership_model');
    $query = $this->membership_model->validate();

    if($query){ //if credentials validated
        $data = array(
            'username' => $this->input->post('username'),
            'is_logged_in' => true

            );

            $this ->session->set_userdata($data);
            redirect('site/members_area');
    }

    else{ //if not validated load login form again.
        $this->index();

    }

} 
```

这是我收到的错误消息的屏幕截图

![显示错误信息的屏幕](../Images/e0ea6b9c3cad532fe0328073dac625a3.png)

有什么想法可能会出错吗？我一点头绪都没有！我在互联网上看过，但似乎没有任何帮助。有没有人遇到过这个问题。我一直在关注这个教程视频，但它使用的是旧版本的代码点火器，所以我一直在进行更改。

[http://www.youtube.com/watch?v=-fLtTRYQX0M](http://www.youtube.com/watch?v=-fLtTRYQX0M) [http://net.tutsplus.com/tutorials/php/codeigniter-from-scratch-day-6-login/](http://net.tutsplus.com/tutorials/php/codeigniter-from-scratch-day-6-login/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T01:08:16.233

```
function validate(){
    $this->db->where('username', $this->input->post('username'));
    $this->db->where('password', md5($this->input->post('password')));
    $this->$query = $this->db->query->get('members');

    if($query->num_rows != 0){
        return true;
    }
} 
```

应该：

```
function validate()
{
    $array = array(
        'username' => $this->input->post('username'), 
        'password' => md5($this->input->post('password')));
    $query = $this->db->get_where('members', $array); 
    if ($query->num_rows() > 0)
    {
        return true;
    }
} 
```

注意：如果您使用的是旧版本的 CI，`get_where()`可能会调用`getwhere()`

顺便说一句，您不应该使用 MD5 来散列您的密码。您应该使用 BCrypt，因为 MD5 不安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T01:17:42.400

首先很明显，您是否正在加载数据库库？

其次，为什么要在 query() 之后附加 get()？

IE

```
$this->db->query->get('members'); 
```

query() 是一个独立函数，其示例表明它应该像这样使用：

```
$query = $this->db->query('YOUR QUERY HERE'); 
```

而 get() 是活动记录的一部分。

```
$query = $this->db->get('mytable'); 
```

或者在你的情况下：

```
$query = $this->db->get('members'); 
```

# ruby-on-rails - 会议桌和八达通宝石

> ID：14865868
> 
> 赞同：1
> 
> 时间：2013-02-14T00:32:41.317
> 
> 标签：ruby-on-rails, octopus

我遇到章鱼复制问题。我使用基于表的会话，当用户登录时，会话是在我的主表中创建的，但下一个请求尝试从从属数据库读取会话数据，但由于会话数据未在第二个之前复制到从属数据库而失败提出请求。如何告诉章鱼从/向同一张表读取和写入会话记录？我没有会话模型，我应该创建一个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T20:27:21.547

您可以像这样指定要使用的数据库：

```
Model.using(:master).find(id) 
```

或者

```
Model.using(:slave_name).find(id) 
```

# email - 所有电子邮件提供商都忽略@前面的句点吗？

> ID：14865869
> 
> 赞同：49
> 
> 时间：2013-02-14T00:32:46.850
> 
> 标签：email

我知道 gmail 允许用户在@符号之前的电子邮件地址中插入任意数量的句点。Gmail 还允许用户像这样附加电子邮件地址：userName+anyStringHere@gmail.com。所有这些“不同”的电子邮件地址本质上是相同的地址。[（链接到描述这些“功能”的谷歌博客）](http://gmailblog.blogspot.com/2008/03/2-hidden-ways-to-get-more-from-your.html)

我想防止用户使用本质上相同的电子邮件地址创建多个帐户。我决定将电子邮件地址存储在我的数据库中，其中包含这些句点以及后面的任何内容（包括 + sing），但现在我想知道：忽略电子邮件提供商主要关注的 @ 符号前面的句点是否是标准？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-14T00:41:34.820

这确实是 gmail 特有的，但这也适用于域的 google 应用程序，因此您只能为 @gmail.com 执行此操作

我不会这样做，这只会疏远您的诚实用户，并且不会阻止任何人决心创建多个帐户。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2016-03-21T07:42:11.407

在过去的几天里，我遇到了同样的问题。在网上研究并检查了一些东西后，我发现：

*   关键点：Microsoft Outlook、Yahoo Mail、Apple iCloud ID
*   点不重要：Gmail、Facebook ID
*   严禁点：推特

来源：[一篇关于 Slate 的文章](http://www.slate.com/blogs/future_tense/2013/08/01/dots_in_gmail_addresses_what_happens_if_you_leave_out_the_period.html)

我得出的结论是，大多数用户使用微软、谷歌或雅虎提供的服务。所以我可以有一个像这样的特定于应用程序的正则表达式。

```
var eml_exp = /^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@(gmail.com)$/i;
if(eml_exp.test("email@addrss"))
//if it's a gmail address, then remove periods from local part and also anything
// after `+` sign . Then compare the address in your existing user table,
// if you find it unique or unused then let the user to register. 
```

您也可以阅读其他已知服务的手册并根据它们进行实施。

“不要忘记开源你的工作：p”

**更新**

根据这个 SO questionAdding [+ text before the @ in an email](https://stackoverflow.com/questions/25716709/adding-text-before-the-in-an-email?rq=1)，您可能会阻止使用`+`符号您的整个问题，我的问题将得到解决。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-07-15T02:05:07.867

> “我想阻止用户创建多个帐户”

也许，就像这里的其他人说的那样，*这*不是忽略句号的好理由。

然而，一个很好的理由是防止用户*意外*创建不同的帐户。假设最近安装了一个网络应用程序，但尚未配置为与 Gmail OpenAuth 一起使用。因此，人们手动输入地址，以使用本地电子邮件 + 密码帐户进行注册。

稍后，Web 应用程序会配置 OpenAuth 和*使用 Gmail 登录*按钮。现在有 gmail 地址的人，单击该按钮进行登录。而且......在某些情况下，人们在手动输入时不小心手动输入了*没有**点*、点或*不同*点的地址（嗯，键盘）之前。

 **现在，应用程序认为地址不同，并自动为用户创建一个新帐户。她/他然后想知道：*“我所有的旧东西在哪里？我以前用这个帐户创建的？我用相同的电子邮件地址登录！”*

发生这种情况的真实示例：[https ://meta.discourse.org/t/discourse-creates-new-users-if-dots-are-present-absent-in-google-email-address-when-logging-in -使用-谷歌/66151](https://meta.discourse.org/t/discourse-creates-new-users-if-dots-are-present-absent-in-google-email-address-when-logging-in-using-google/66151)

我认为对于非技术人员来说，忽略 Gmail 地址中的点是*用户友好的*方法。

要让技术人员使用相同的 Gmail 地址创建多个帐户（出于测试目的），您可以选择考虑`whatever+with-tags@gmail`使用不同的地址。— 每个人都很高兴 :-) （Astroturfing 和垃圾邮件过滤器可以考虑到这一点`bob@gmail.com`并且`bob+with-a-tag@gmail.com`是同一个人。）**

# qt - PySide，连接按钮错误

> ID：14865871
> 
> 赞同：0
> 
> 时间：2013-02-14T00:33:11.467
> 
> 标签：qt, pyside

我正在尝试在 PySide 中制作一个简单的测试应用程序，但我真的不明白我缺少什么。这是到目前为止的代码：

```
 import sys
from PySide import QtCore, QtGui

class IPTest(QtGui.QMainWindow):
    def __init__(self):
        super(BartonTest, self).__init__()
        self.initUI()

    def initUI(self):
        lblAddress = QtGui.QLabel("IP Address", self)
        lineAddress = QtGui.QLineEdit(self)
        lblPort = QtGui.QLabel("Port Number", self)
        linePort = QtGui.QLineEdit(self)
        btnSend = QtGui.QPushButton("Send", self)
        btnReceive = QtGui.QPushButton("Receive", self)

        lblAddress.move(30, 20)
        lblPort.move(30, 60)
        lineAddress.move(130, 20)
        linePort.move(130, 60)
        btnSend.move(30, 100)
        btnReceive.move(130, 100)

        self.setGeometry(200, 200, 275, 150)
        self.setWindowTitle('Send/Receive TCP Test Program')
        self.show()

    def sendData(self):
        fileName, _ = QtGui.QFileDialog.getOPenFileName(self, 'Open CNC Program')
        self.data = open(fileName, 'r')

def main():
    app = QtGui.QApplication(sys.argv)
    bt = IPTest()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

现在我想做的只是将一个事件连接到按钮。Qt 的文档告诉我我需要做的就是：

```
btnSend.clicked.connect(self.sendData) 
```

PyCharm 说它在 clicked 中找不到引用，我得到的异常是

```
TypeError: native Qt signal is not callable 
```

我很（容易）难倒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:42:27.103

以下对我来说是正确的：

```
import sys
from PySide import QtCore, QtGui

class IPTest(QtGui.QMainWindow):
    def __init__(self):
        super(IPTest, self).__init__()
        self.initUI()

    def initUI(self):
        lblAddress = QtGui.QLabel("IP Address", self)
        lineAddress = QtGui.QLineEdit(self)
        lblPort = QtGui.QLabel("Port Number", self)
        linePort = QtGui.QLineEdit(self)
        btnSend = QtGui.QPushButton("Send", self)
        btnReceive = QtGui.QPushButton("Receive", self)

        lblAddress.move(30, 20)
        lblPort.move(30, 60)
        lineAddress.move(130, 20)
        linePort.move(130, 60)
        btnSend.move(30, 100)
        btnReceive.move(130, 100)

        btnSend.clicked.connect(self.sendData)
        self.setGeometry(200, 200, 275, 150)
        self.setWindowTitle('Send/Receive TCP Test Program')
        self.show()

    def sendData(self):

        fileName, _ = QtGui.QFileDialog.getOpenFileName(self, 'Open CNC Program')
        if len(fileName) > 0:
            self.data = open(fileName, 'r') 
```

# c - 对 32 位地址空间使用 64 位整数迭代器？

> ID：14865873
> 
> 赞同：0
> 
> 时间：2013-02-14T00:33:15.940
> 
> 标签：c, memory, integer, compiler-warnings

我正在编写一些代码（在 FPGA 上运行），将模式写入由其基地址和最高地址指定的内存块。数据宽度为 64 位，地址空间为 32 位。在我的系统中，long 是 32 位，long long 是 64 位。代码看起来像这样：

```
unsigned long base_addr = 0xC0000000;
unsigned long high_addr = 0xFFFFFFFF;
unsigned long long i;

for(i = base_addr; i <= high_addr; i += 4){
    *((unsigned long *) i) = some_pattern; 
} 
```

一切正常，但我从编译器收到“从不同大小的整数转换为指针”警告。如果我使用 32 位迭代器变量，代码将无限循环，因为迭代器达到 0xFFFFFFFC，然后再次溢出回 0。

有一个更好的方法吗？我知道有很多方法可以毫无问题地使用 32 位迭代器（检测/预测溢出，从 high_addr 中减去 3），但我认为这段代码是最简单和最易读的。编写带有已知编译器错误的代码是否被认为是不好的风格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:43:34.927

我对一个更好的方法的想法：

```
unsigned long long *base_addr = (unsigned long long *)0xC0000000;
unsigned long long *high_addr = (unsigned long long *)0xFFFFFFFF;
unsigned long long *i;

for (i = base_addr; i < high_addr; ++i) {
    *i = some_pattern;
} 
```

可能需要小心指针 (i) 环绕，如果`i < base_addr`也中止 for 循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T00:36:14.837

你为什么声明`i`为`unsigned long long`？那有什么意义呢？

正如您自己所说，您平台上的地址是 32 位的。声明`i`为`unsigned long`，就像`base_addr`and一样`high_addr`。警告应该消失。

同时，“数据宽度为64位”是什么意思？如果数据（和模式）实际上是 64 位，那么你应该这样做

```
for (i = base_addr; i <= high_addr; i += 8){ /* or i += sizeof(unsigned long long) */
    *((unsigned long long *) i) = some_pattern; 
} 
```

另外，请注意，例如，如果在迭代期间`i`变得等于`high_addr`，您的循环体仍将执行，访问 7 个额外的字节`high_addr`。那是意图吗？

# c# - C# - 使用 foreach 循环加载文本框

> ID：14865875
> 
> 赞同：-1
> 
> 时间：2013-02-14T00:33:26.670
> 
> 标签：c#

我正在寻找有关如何将我的数组加载到某些文本框中的解决方案。前几天我发布了一个类似的问题。提供的答案很好，但是现在我遇到了我认为在代码中定位的问题。这就是我所拥有的：

```
 private void btnQuickPlayNumbers_Click(object sender, EventArgs e)
    {
        int randCheck = 0;

        Random rand = new Random();

        int[] powerball5 = new int[5];

        for (int i = 0; i < powerball5.Length; )
        {
            randCheck = rand.Next(0, 60);

            while (!(powerball5.Contains(randCheck)))
            {
                powerball5[i] = randCheck;

                foreach (Control x in this.Controls)
                {
                    if (x is TextBox)
                    {
                        ((TextBox)x).Text = powerball5[i].ToString();                            
                    }
                }

                i++;
            }                
        }
    } 
```

现在这会加载我论坛上的所有文本框，这很好，但是它在所有文本框中加载了相同的数字。这是一个强力球程序，我需要将我的数组加载到盒子中：

文本框1 = 强力球5[0]；文本框2 = 强力球5[1]；等等，等等。

我一共有 5 个要加载的盒子。我们得出的结论是，将相同的数字加载到所有这些中的原因是 foreach 循环的位置不允许加载数组和增加计数器。我尝试过移动它，甚至制作自己的方法，但是当我按照自己的方法进行操作时，我得到一个索引超出范围错误。所以我有点不知道该怎么做。任何帮助将不胜感激。如果您需要更多信息，我会尽力更新，以满足每个人的需求。再次感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T03:35:08.857

我以前见过这个，随机类使用在主机上生成的随机数字，但是它大约每 20-30 毫秒刷新一次，所以你的“for”循环移动得如此之快以至于随机数不会刷新，尝试添加一个' `system.threading.thread.sleep(25);`' 进入你的 for 循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:53:17.477

此代码将相同的数字加载到每个文本框中 5 次，因此您只能获得最后一个数字。

```
 foreach (Control x in this.Controls)
            {
                if (x is TextBox)
                {
                    ((TextBox)x).Text = powerball5[i].ToString();                            
                }
            } 
```

您可能应该将其结构更像这样：

```
int[] whiteNumbers = DrawPowerballWhites();

// should be in its own function -- DisplayPowerballNumbers(int[] whites, int powerball)
var whiteTextboxes = this.Controls
                         .OfType<TextBox>()
                         .Where(t => IsWhiteTextbox(t))
                         .Select((textbox,index) => new {textbox, index});

foreach(var indexedTextBox in whiteTextboxes)
{
   indexedTextbox.textbox.Text = whiteNumbers[indexedTextbox.index];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T01:01:18.670

要匹配您的代码，您可以使用以下命令：

```
 int randCheck = 0;

    Random rand = new Random();

    int[] powerball5 = new int[5];
    TextBox[] textboxes = new TextBox[5];
    int count = 0;

    for (int i = 0; i < powerball5.Length; i++)
    {
        randCheck = rand.Next(0, 60);

        do
        {
            randCheck = rand.Next(0, 60);
        } while (Array.IndexOf(powerball5, randCheck) != -1);
        powerball5[i] = randCheck;
    }

    foreach (TextBox x in this.Controls)
    {
            x.Text = powerball5[count].ToString();
            count++;
    } 
```

# php - Mysql 获得相同字符串的完全匹配，但使用不同的特殊字符键入

> ID：14865876
> 
> 赞同：1
> 
> 时间：2013-02-14T00:33:32.173
> 
> 标签：php, mysql, special-characters, turkish

嘿，伙计们，我遇到了一个有趣的情况！

在土耳其语中，我们有 ı,ç,ğ,ö,ş 和它们的大写字母。我还有一个巨大的带有土耳其标题的线程表。

就像在这个例子中：

```
mysql> select id,title from xr_threads where title = 'birinci';
+--------+---------+
| id     | title   |
+--------+---------+
|     67 | birinci |
|  34635 | bırıncı |
| 322727 | birinçi |
+--------+---------+
3 rows in set 
```

我的函数中的查询总是抓住第一个。但是，如果我使用 title = 'bırıncı' 再次运行此查询，则 mysql 会再次获取这 3 个结果。我希望 mysql 只获得 34635 id 但无论我输入什么，它总是得到这 3 个结果。为什么它没有得到匹配的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:40:33.077

尝试：

```
mysql> select id,title from xr_threads where title = BINARY 'birinci'; 
```

[有关在 MySQL 文档页面http://dev.mysql.com/doc/refman/5.0/en/charset-binary-op.html](http://dev.mysql.com/doc/refman/5.0/en/charset-binary-op.html)上使用 BINARY 运算符的更多信息

# wcf - WCF 和嵌套数据协定

> ID：14865877
> 
> 赞同：0
> 
> 时间：2013-02-14T00:33:33.220
> 
> 标签：wcf

对 WCF 来说是全新的。真的可以使用一些帮助。

我有一个 (100) 个对象的列表，其中包含 4 个数据成员。DM1、DM2、DM3、DM4

我有一堆数据合同

```
DC1
 List<DC2>

DC2
 <DM1 Value=n> (n could be any number below 5, so there could be up to 5 DC2 inside the List in DC1)
 List<DC3>

DC3
 <DM2 value=n> (n could be any number below 10, so up to 10 DC3 inside the List in DC2)
 List<DC4>

DC4
 <DM3>
 <DM4> 
```

需要遍历原始对象列表，并根据原始对象列表的数据成员中的不同值，使用各种嵌套数据合约创建一个数据合约（DC1）。

例如：

```
<DC1>
  <DC2>
    <DM1 value = "a">
    <DC3>
      <DM2 value = 1>
      <DC4>
        <DM3>
        <DM4>
      <DM2 value = 2>
      <DC4>
        <DM3>
        <DM4>
      <DC4>
        <DM3>
        <DM4>
    </D3>
  </DC2>
  <DC2>
    <DM1 value = "b">
    <DC3>
      <DM2 value = 1>
      <DC4>
        <DM3>
        <DM4>
      <DM2 value = 2>
      <DC4>
        <DM3>
        <DM4>
      <DC4>
        <DM3>
        <DM4>
    </D3>
  </DC2>
<DC1> 
```

这样做的最佳方法是什么？

谢谢！

这是 DataContracts 以及使用 DC1 传递信息的服务合同：

```
[DataContract]
public class DC1
{
    [DataMember]
    public string string { get; set; }

    [DataMember]
    public List<DC2> LDC2{ get; set; }
} 
```

[DataContract] public class DC2 { [DataMember] public string Type{ get; 放; }

```
 [DataMember]
    public List<DC3> DC3s{ get; set; } 
```

[DataContract] public class DC3 { [DataMember] public decimal num { get; 放; }

```
 [DataMember]
    public List<DC4> DC4s{ get; set; } 
```

[DataContract] public class DC4 { [DataMember] public int num2 { get; 放; }

```
 [DataMember]
    public decimal Val{get; set;} 
```

服务契约：[ServiceContract(Namespace = Constants.Namespace)] public class Service {

```
 [OperationContract]
    DC1 GetMethod(int num); 
```

数据集：

是以下对象的 LIST<>：

```
[Serializable]
public class Data
{
    public string Type { get; set; }
    public double Num { get; set; }
    public double Num2{ get; set; }
    public decimal Val{ get; set; }

} 
```

此列表中可以有 100 个（或更多）这些对象。最多5种，Num最多10种，Num2最多5种。

感谢您的回复，并希望这可以澄清！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T02:52:43.700

可能有比让 LINQ 完成所有工作更有效的方法。但是，这似乎是一个关于如何将非规范化数据转换为规范化对象的问题，因此 GroupBy 作为一种易于编码的解决方案跳出来了。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.ServiceModel;
using System.Runtime.Serialization;

namespace WcfTestService
{
    [ServiceContract]
    public interface ISoapService
    {
        [OperationContract]
        DC1 GetDC1();
    }

    public class SoapService : ISoapService
    {
        public DC1 GetDC1()
        {
            // Example dataset
            var dataset = new List<Data>()
            {
                new Data() { Type = "a", Num = 1, Num2 = 1, Val = 41.00m },
                new Data() { Type = "a", Num = 2, Num2 = 1, Val = 42.00m },
                new Data() { Type = "a", Num = 2, Num2 = 2, Val = 43.00m },
                new Data() { Type = "b", Num = 1, Num2 = 1, Val = 44.00m },
                new Data() { Type = "b", Num = 2, Num2 = 1, Val = 45.00m },
                new Data() { Type = "b", Num = 2, Num2 = 2, Val = 46.00m },
            };

            // Process dataset into data contract objects
            return new DC1()
            {
                DC2s = dataset.GroupBy(x => x.Type).Select(typeGrouping => new DC2()
                {
                    DM1 = typeGrouping.Key,
                    DC3s = typeGrouping.GroupBy(x => x.Num).Select(numGrouping => new DC3()
                    {
                        DM2 = Convert.ToDecimal(numGrouping.Key),
                        DC4s = numGrouping.Select(x => new DC4()
                        {
                            DM3 = Convert.ToInt32(x.Num2),
                            DM4 = x.Val
                        }).OrderBy(x => x.DM3).ToList()
                    }).OrderBy(x => x.DM2).ToList()
                }).OrderBy(x => x.DM1).ToList()
            };
        }
    }

    [Serializable]
    public class Data
    {
        public string Type { get; set; }
        public double Num { get; set; }
        public double Num2 { get; set; }
        public decimal Val { get; set; }
    }

    [DataContract]
    public class DC1
    {
        [DataMember]
        public List<DC2> DC2s { get; set; }
    }

    [DataContract]
    public class DC2
    {
        [DataMember]
        public string DM1 { get; set; }
        [DataMember]
        public List<DC3> DC3s { get; set; }
    }

    [DataContract]
    public class DC3
    {
        [DataMember]
        public decimal DM2 { get; set; }
        [DataMember]
        public List<DC4> DC4s { get; set; }
    }

    [DataContract]
    public class DC4
    {
        [DataMember]
        public int DM3 { get; set; }
        [DataMember]
        public decimal DM4 { get; set; }
    }
} 
```

GetDC1() 的输出应该非常接近您的示例输出，但都是 WCF'ified。

# c# - 在 .NET 中将单词与文本分开的最快选择是什么？

> ID：14865878
> 
> 赞同：1
> 
> 时间：2013-02-14T00:33:42.980
> 
> 标签：c#, regex, text, semantics

我的任务是对文本（800MB txt 文件）进行简单的语义分析。对于小文件，一切都进行得很快。我逐行阅读了这个文件和那些工作。文件读取需要 9s。但是，一旦您开始分析并将单词添加到字典中并将它们的位置存储在文本处理中，就会花费太长时间。

你能告诉我更好的变化或解决问题的更好方法吗？在处理文本和程序的语义分析问题时，我会提出任何意见。你的。

```
public List<string> SplitWords(string s)
    {
        s = s.ToLower();
        arrayWords = Regex.Split(s, @"\W+");
        listWords = arrayWords.OfType<string>().ToList();

        for (int i = 0; i < listWords.Count; i++)
        {
            if (Array.BinarySearch(stopwords, listWords[i]) >= 0 || listWords[i].Length < 2)
            {
                listWords.RemoveAt(i);
                i--;
            }

        }
        return listWords;
    } 
```

分隔单词的代码

```
 public void AddToDictonary(List<string> arrayWords)
        {
            for (int i = 0; i < arrayWords.Count; i++)
            {
                if (!dictonary.ContainsKey(arrayWords[i]))
                {
                    dictonary.Add(arrayWords[i], new List<int>() { i });
                }
                else
                {
                    dictonary[arrayWords[i]].Add(i);
                }
            }
        } 
```

添加到字典的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:44:34.347

[您可以使用我在此处](https://stackoverflow.com/questions/10239518/how-do-i-split-a-phrase-into-words-using-regex-in-c-sharp/10240108#10240108)发布的正则表达式来标记您的句子

# javascript - 关于如何避免在我的旋转木马中进行昂贵的重绘的建议？

> ID：14865884
> 
> 赞同：2
> 
> 时间：2013-02-14T00:34:10.860
> 
> 标签：javascript, css, webkit, css-transitions, css-transforms

我正在编写一个轮播脚本，该脚本使用网络转换来滑动图像。

这是一个非常简化的关于它如何工作的小提琴。 [http://jsfiddle.net/tUhZe/6/](http://jsfiddle.net/tUhZe/6/)

我想知道是否有人可以对如何减少每次过渡开始时发生的昂贵重绘有任何好主意？

我尝试将 50 张图片添加到此轮播中，但它导致了性能上的重大问题。

```
 window.setInterval( function () {
        var element = $('#container'),
            active = $('.active'),
            next = active.next('.slide');
        if (!next.length) {
            next = element.find('.slide:eq(0)');
        }

        // Move next image into position, ready to slide
        next.addClass('next');

        // Slight delay for next image to move into position
        window.setTimeout( function () {
            // Start moving active image out
            active.addClass('prev');

            // Start moving next image in
            next.addClass('active')
                .removeClass('next')
                .bind('webkitTransitionEnd', function () {

                    next.unbind('webkitTransitionEnd');

                    // Move offscreen
                    active.removeClass('active prev next');

                    // Reassign active
                    active = next;
                });
        }, 100);

    }, 2000); 
```

简而言之，这就是脚本的工作方式：

1.  活动图像在视图中（给定类“活动”）。所有其他图像（没有“活动”类）都在屏幕外（顶部：9999px）。
2.  下一个图像移动到活动图像旁边，为过渡做准备。
3.  活动图像类和下一个图像类被更改，这会触发两者同时从左向右滑动。
4.  在过渡结束时，活动图像位于屏幕外。

    提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T22:51:08.927

可悲的事实是，许多浏览器/计算机硬件组合还没有完全准备好一次将 50 个全屏图像加载到窗口中。

但是我最近构建了一个类似的轮播，发现通过巧妙地使用背景图像和简单的逻辑可以完全避免性能问题。

当屏幕上有太多图像被隐藏或以其他方式显示时，浏览器会出现问题吗？因此，因此，如果我们简单地使用带有背景图像的 span，这些背景图像仅在包含 的元素处于活动状态或前/后元素时才加载。

我不太会说话，所以让我告诉你；

[http://jsfiddle.net/DUWMy/](http://jsfiddle.net/DUWMy/)

```
<div class="slideshow">

    <span class="image-1 active"></span>
    <span class="image-2"></span>
    <span class="image-3 prev"></span> 

</div>

.slideshow .prev.image-1,
.slideshow .active.image-1{ background-image:url('http://lorempixel.com/output/technics-q-c-400-300-7.jpg'); }
.slideshow .prev.image-2,
.slideshow .active.image-2{ background-image:url('http://lorempixel.com/output/nightlife-q-c-400-300-5.jpg'); }
.slideshow .prev.image-3,
.slideshow .active.image-3{ background-image:url('http://lorempixel.com/output/city-q-c-400-300-7.jpg'); } 
```

在上面的小提琴中，我刚刚制作了一个快速幻灯片，需要注意的重要一点是，在 css 中，除非存在 active 或 prev 类，否则不会应用背景图像。

[http://jsfiddle.net/DUWMy/1/](http://jsfiddle.net/DUWMy/1/)

上面的小提琴简单地显示了屏幕上的所有元素，你可以看到一旦一个元素失去了 prev 类并激活它就会失去背景图像。这意味着屏幕上的图像更少，而且您不应该遇到所有额外的延迟。

您可能已经找到了另一种解决方案，但请记住这是一种方便的方法。也适用于响应式布局。

# java - 尝试在 App Engine 中使用 JAXB 解组外部页面时出现“AccessControlException”

> ID：14865890
> 
> 赞同：1
> 
> 时间：2013-02-14T00:34:37.480
> 
> 标签：java, google-app-engine, jaxb

因此，我想阅读 Facebook 的语言环境页面并将其存储在数据存储中，以供我们在 Google 的 App Engine 上运行的应用程序使用。

我创建一个这样的 URL：

```
URL facebookXmlUrl = new URL( "https://www.facebook.com/translations/FacebookLocales.xml" ); 
```

我像这样创建我的解组器：

```
JAXBContext jaxb = JAXBContext.newInstance( FacebookLocales.class );
Unmarshaller unmarshaller = jaxb.createUnmarshaller(); 
```

（注意：**FacebookLocales**类很好地反映了它们的 XML 和编组看起来就像它。）

当我真正尝试解组时：

```
FacebookLocales fbLocales = ( FacebookLocales ) unmarshaller.unmarshal( facebookXmlUrl ); 
```

我收到以下错误（甚至/尤其是在本地开发应用程序引擎上）：

```
java.security.AccessControlException: access denied ("javax.xml.bind.JAXBPermission" "setDatatypeConverter") 
```

我用谷歌搜索了我的小心脏，但没有找到任何帮助。

# php - iOS 推送通知的消息格式

> ID：14865893
> 
> 赞同：1
> 
> 时间：2013-02-14T00:34:58.460
> 
> 标签：php, ios, push-notification, apple-push-notifications

我成功发送推送通知，但某些字符未正确呈现。

例如我发送这个词

> 情人节

但它在通知消息中呈现不同，它看起来像这样

> 瓦伦丁2019s

我使用 PHP 发送推送通知，什么是确保消息干净利落的最佳方式？

# django - Django MPTT，递归添加子节点，给出错误的get_ancestors（）结果

> ID：14865903
> 
> 赞同：0
> 
> 时间：2013-02-14T00:36:34.280
> 
> 标签：django, recursion, mptt

我得到以下代码以递归方式将数据从旧表迁移到 MPTT

```
def traverse_design_idea(parent_id=1, parent=None):
    for _cat in OldTablefilter(parent=parent_id):
        cat = DesignCategory(name=_cat.category, old_id=_cat.sbt_id, parent=parent)
        cat.save()
        traverse_design_idea(_cat.sbt_id, cat)   
traverse_design_idea()

cat = DesignCategory.objects.get(pk=100)
cat.get_ancestors() //give wrong parents 
```

关系设置正确，但 get_ancestors() 提供错误信息，我已阅读有关更新父节点的信息，但无法使其正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:43:39.063

好的，刚刚发现我可以简单地`DesignCategory.objects.rebuild()`在递归函数之后运行

# java - 从超类返回扩展类的新实例

> ID：14865905
> 
> 赞同：1
> 
> 时间：2013-02-14T00:37:13.520
> 
> 标签：java, android

我正在构建一个具有多个扩展“模型”类的类的 Android 应用程序。

这是我现在的代码：

```
public class Model {

    protected int mId;

    public int getId() { return mId; } 

    public Model(JSONObject json) {
        try {
            mId = json.getInt("id");
        } catch (JSONException e) {
            e.printStackTrace();
        }
    }

    public Class<? extends Model> getBy(String property, String value) {
        // should return new instance of extending class
        return null;
    }

}

public class Song extends Model {

    protected String mName;
    protected String mArtist;
    protected int mDuration;

public String getName() { return mName; }
public String getArtist() { return mArtist; }
public int getDuration() { return mDuration; }

    public Song(JSONObject json) {
        super(json);

        try {
            mName = json.getString("name");
            mArtist = json.getString("artist");
            mDuration = json.getInt("duration");
        } catch (JSONException e) {
            e.printStackTrace();
        }
    }

} 
```

我正在尝试在 Model 类中创建一个方法来返回扩展它的类的新实例。

这个想法是多个类可以扩展模型类，即艺术家、专辑。这些类应该有一个“getBy”方法，该方法将返回不是模型类的实例，而是艺术家、专辑等类的实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T01:03:18.953

Here you go:

```
public <T extends Model> T getBy(Class<T> clazz, JSONObject json) throws Exception
{
    return clazz.getDeclaredConstructor(json.getClass()).newInstance(json);
} 
```

Then use it like:

```
Model model = ...;
Song song = model.getBy(Song.class, someJson); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:42:00.507

您需要实现“工厂模式”。

制作一个静态方法：

```
public class Song extends Model {

...
    public static Song createSong() {
       return new Song(...);
}
} 
```

# artificial-intelligence - 是否有任何用于 AI 的公共聊天数据库？

> ID：14865906
> 
> 赞同：7
> 
> 时间：2013-02-14T00:37:31.047
> 
> 标签：artificial-intelligence, chat, social, instant-messaging

我正在编写一个“聊天机器人”，它通过阅读一组真实的人类聊天来工作，并根据人类输入分析中最可能的答案来响应输入，但我需要大量的现实生活中的聊天分析。

我的个人聊天记录还不够，因为我需要更多数据来进行概率分析

是否有任何以任何形式向公众开放的现实生活聊天的公共资源？

或者，如果您不介意，您可以捐赠自己的个人聊天记录？为科学而做！

谢谢

注意：我在开放的聊天室中发现了很多数据，人们使用公共聊天室只是为了写随机的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T06:59:04.217

[你可以在这里](http://goo.gl/lC6m8)找到相当多的 FalconBot 聊天记录，如果你想更多地使用 Google (dork) 的力量，我使用 google dork “ [ai bot chat logs filetype:txt](https://www.google.com/search?q=ai%20bot%20chat%20logs%20filetype%3atxt) ” 找到它；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:40:26.807

Try finding a way to collect information from public forums. This allows you to not only control the input type based on what type of forums you use but to also get very realistic and unfiltered/uncensored human conversations with a variaty of contributors. Reddit could be interesting but also provide some "interesting" data.

If you have a facebook or friends with facebook. See if they would be willing to let you gather data from public comments on posts. This could also provide data from seemingly short and trivial conversations.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T08:17:12.870

我来帮忙。当然 Rafael，首先检查一下 Wallice 博士在 AIMLbot 中的出色工作。找到 AAA 列表。接下来转到潘多拉机器人。你需要的很多东西都在那里。然后查看 Verbot。深入挖掘，但他们也有一些好东西。霍尔很奇怪，他的答案是基于用户推荐的输出。如果我能提供更多帮助，请与我联系。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-10-03T13:53:10.273

你可能会对这本书感兴趣，它讲述了一种使用数据库制作 AI 的新方法。可从[http://twasack.tripod.com/lou/lou.htm](http://twasack.tripod.com/lou/lou.htm)免费获得， 还有一个聊天机器人演示该技术，包括源代码

# google-app-engine - GQL 选择（包括 ID） 按 ID 过滤

> ID：14865907
> 
> 赞同：2
> 
> 时间：2013-02-14T00:37:32.940
> 
> 标签：google-app-engine, python-2.7, gql, gqlquery

我正在寻找在 GQL 中可以选择除 ID 之外的属性并按 ID 过滤的示例。

我想要完成的伪代码是这样的：

```
myResults = db.GQLQuery("select __KEY__, ATTR1, ATTR2 from MyTABLE" 
                            "WHERE __key__ > KEY('MyTable',:LAST_ID)
                            "order by ID DESC LIMIT 100") 
```

我看到了一些获取密钥的示例，但我需要遍历密钥才能获取记录。

有没有办法让我根据 KEY/ID 标准获取记录集合？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:24:03.153

您使用的方式`__key__`意味着新记录的所有键都大于以前创建的键（事实并非如此）。如果要按创建时间过滤，则需要为此添加一个字段，在创建记录时设置。

# web-services - 关于应用程序可扩展性的最佳现代指南是什么？

> ID：14865911
> 
> 赞同：0
> 
> 时间：2013-02-14T00:38:26.220
> 
> 标签：web-services, web-applications, scalability, web-hosting

我听说过很多关于应用程序扩展性的信息，但有很多相互矛盾的信息。一方面，每个网络主机都声称通过在负载增加时添加更多服务器来使扩展变得轻而易举，这似乎很简单。但是随后出现了其他服务，它们声称可以在已经自动缩放的网络主机上为您扩展您的应用程序（例如 heroku 上的 heroscale）。如果需要这些服务，那么 Web 主机本身就不可能 100% 可扩展。而且您仍然会在新闻中听到有关应用程序在一夜之间爆炸并最终崩溃或几乎崩溃并破坏其所有流量的新闻，因为它们的扩展性不够好。显然，这些大型应用程序的开发人员听说过流行的“可扩展”网络主机，例如 heroku，所以如果他们只需要使用它们，那么就不会有问题。

是否有任何摘要、指南等。那里解释了为什么会发生所有这些，当前的解决方案以及这些解决方案的可扩展性如何？我应该从哪里开始寻找？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T01:56:43.193

应用程序必须能够利用它获得的额外服务器/资源。这听起来比它更容易。一个常见的问题是数据库。假设您有一台带有数据库的服务器，并且在某个时间点您看到太多负载/太多连接。现在您想启动第二个 db-server，但您的应用程序不支持多个 db-server，因此扩展将失败。

以下是 wooga（社交游戏开发商）关于该主题的介绍： [http ://www.slideshare.net/wooga/20121130scalable-game-servers](http://www.slideshare.net/wooga/20121130scalable-game-servers)

# php - 保护特定请求类型、restful API、Laravel

> ID：14865914
> 
> 赞同：2
> 
> 时间：2013-02-14T00:38:42.793
> 
> 标签：php, rest, laravel

我只想保护对我的索引的 POST 请求，我该怎么做？

```
public $restful = true;

public function __construct()
{
    parent::__construct(); 
            //this does not work
    $this->filter('before', 'auth')->only(array('post_index'));
}

public function get_index()
{
            //I do not want to protect this
    return Response::eloquent(Model::all()); 
}

public function post_index()
{
            //I want to protect only this call
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T00:49:37.040

您快到了！如果您只想保护 POST 请求，请结合使用`only()`和`on()`方法。尝试：

```
$this->filter('before', 'auth')->only('index')->on('post'); 
```

这是供参考的[api页面。](http://laravel.com/api/class-Laravel.Routing.Filter_Collection.html#_on)

# xml - 如何降低 svg 滤镜中 Alpha 层的不透明度？

> ID：14865915
> 
> 赞同：37
> 
> 时间：2013-02-14T00:38:49.497
> 
> 标签：xml, svg, adobe-illustrator, svg-filters

我正在尝试将徽标创建为 SVG。我从 Illustrator 导出了文件。徽标上有一个阴影。我正在查看 XML 并找到了过滤器节点

```
<filter  filterUnits="objectBoundingBox" width="200%" height="160%" x="-15%" y="-15%" id="AI_Shadow_2">
<feGaussianBlur  stdDeviation="2" result="blur" in="SourceAlpha"></feGaussianBlur>
<feOffset  result="offsetBlurredAlpha" in="blur" dy="0" dx="0"></feOffset>
<feMerge>
    <feMergeNode  in="offsetBlurredAlpha"></feMergeNode>
    <feMergeNode  in="SourceGraphic"></feMergeNode>
</feMerge> 
```

有没有办法改变生成的 offsetBlurredAlpha 的 alpha？我不希望它从纯黑色开始，我希望它从 50% 黑色开始，以便对象周围的阴影效果足够亮。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-02-14T09:13:04.060

一种方法是添加一个`feComponentTransfer`过滤器原语，如下所示：

```
<filter id="dropshadow">
  <feGaussianBlur in="SourceAlpha" stdDeviation="3"/> 
  <feOffset dx="2" dy="2"/>
  <feComponentTransfer>
    <feFuncA type="linear" slope="0.2"/>
  </feComponentTransfer>
  <feMerge> 
    <feMergeNode/>
    <feMergeNode in="SourceGraphic"/> 
  </feMerge>
</filter> 
```

可以在[这里](http://xn--dahlstrm-t4a.net/svg/filters/arrow-with-dropshadow-lighter.svg)看到一个活生生的例子。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-08-18T20:00:15.863

一种方法是简单地使用`opacity: 0.5`. 为此，不要创建将阴影与顶部原始源合并的过滤器，而是**仅为**阴影创建一个过滤器，并将其应用于`<use>`引用源形状的标签。

这种方法还有其他优点。例如，现在您可以对阴影应用单独的样式。

```
#arrow-shadow {
	opacity:0.5;
}
g:hover #arrow-shadow {
	opacity:0.7;
}
```

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-50 -50 200 200" width="400px">
	<defs>
		<filter id="dropshadow" height="130%">
			<feGaussianBlur in="SourceAlpha" stdDeviation="3" /> 
			<feOffset dx="2" dy="2" result="offsetblur" />
		</filter>
	</defs>
	<g fill="#EEE">
		<use id="arrow-shadow" xlink:href="#polygon" filter="url(#dropshadow)"></use>
		<polygon id="polygon"
				points="58.263,0.056 100,41.85 58.263,83.641 30.662,83.641 62.438,51.866 0,51.866 0,31.611 62.213,31.611 30.605,0 58.263,0.056"/>

	</g>
</svg>
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-10-17T06:40:03.287

设置 alpha 值的另一种方法是使用`feColorMatrix`过滤器原语。使用它，您可以同时设置 alpha 值和阴影的颜色。

下面的过滤器将 alpha 值乘以，`0.2`同时将阴影的颜色设置为红色。

```
<filter id="dropshadow">
  <feGaussianBlur in="SourceAlpha" stdDeviation="3"/> 
  <feOffset dx="2" dy="2"/>
  <feColorMatrix values="0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/>
  <feMerge> 
    <feMergeNode/>
    <feMergeNode in="SourceGraphic"/> 
  </feMerge>
</filter> 
```

但如果您只需要更改 alpha 值，则`feComponentTransfer`过滤器原语可能是更好的选择。

# c++ - 正确的（资源处理）零规则在哪里？

> ID：14865919
> 
> 赞同：11
> 
> 时间：2013-02-14T00:39:03.607
> 
> 标签：c++, c++11, raii, unique-ptr

这是一篇关于名为[Rule of Zero](http://flamingdangerzone.com/cxx11/2012/08/15/rule-of-zero.html)的成语的文章。

这是一段摘录：

```
class module {
public:
    explicit module(std::wstring const& name)
    : handle { ::LoadLibrary(name.c_str()), &::FreeLibrary } {}

    // other module related functions go here

private:
    using module_handle = std::unique_ptr<void, decltype(&::FreeLibrary)>;

    module_handle handle;
}; 
```

它重用`unique_ptr`了 RAII 功能，因此您无需关心实现令人生畏且冗长的五规则包装器。

以这种方式呈现（以这种方式管理基于句柄的资源`unique_ptr`），它对我来说看起来像是一个黑客，而不是它试图解决的最佳解决方案。隐含的假设太多：

*   一个人能够对等并使用`#define`(or `typedef`)`HANDLE`所基于的基本类型。对我来说，这应该是隐藏的知识，并且解决方案完全基于界面提供的内容：`HANDLE`.
*   句柄，可以是任何东西，它们不需要是指针类型。

我想使用这个成语，但在我偶然发现的许多情况下它都不够用。

这个以*句柄为中心的 RAII 包装器*是否已经完成并可以在一些很酷的库中使用？每个人都在使用这样的工具，我不知道吗？（我认为拥有这样的工具不仅适用于一种，而且适用于许多类型的所有权）

## 编辑 1

这与平台特定的资源句柄无关，例如，`glGenLists`返回一种句柄，它是`GLuint`，您应该调用`glDeleteLists`它。如前所述，资源句柄不需要是指针类型，也不应该假设这种假设。

## 编辑 2

在前一个示例中，零规则通过使用已经存在的工具`unique_ptr`，显示为句柄管理的一个很好的快捷方式。它需要的额外假设使其不足。正确的假设是您有一个*句柄*，并且您有一个*资源破坏函数，该函数会破坏**句柄*给出的资源。句柄是 a `void *`、 a`GLuint`还是什么都无关紧要，更糟糕的是，甚至不需要对等`HANDLE`内部类型。出于管理句柄 RAII 方式的目的，如果成语告诉它有好处，并且不能适用于这种情况，我觉得它不好，最后使用给定的工具。

## 编辑 3

一个说明性的情况是，假设您负责使用新的第 3 方 C 库。它包含一个`FooHandle create_foo()`和一个`void destroy_foo(FooHandle)`。所以你想，“让我们通过使用零规则来使用 FooHandle”。好的，您可以使用 a `unique_ptr`, a`unique_ptr`来回答您自己的问题吗？是`FooHandle`指针吗？，这样你就可以使用 a `unique_ptr`to`FooHandle`的**不暴露**的基本类型了吗？它是一个`int`？，以便您可以直接使用它，还是更好地（重新）`typedef`像@NicolBolas 在他的回答中所做的事情。对我来说，似乎很清楚，即使在如此微不足道的情况下，`unique_ptr`也已经显示出不*适合*管理资源句柄。

**免责声明：**

我试图重新表述并更好地表达自己：

*   [是否有适用于“把手”的适当“所有权在一个包中”？](https://stackoverflow.com/q/14878121/1000282)

## 编辑 4

我找到了我要找的东西，我把它作为重新制定的问题的答案：[https](https://stackoverflow.com/a/14902921) ://stackoverflow.com/a/14902921 。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-14T00:58:05.967

## 背景：零规则

首先，这篇文章是关于一个更笼统的想法，而不仅仅是它提到的资源句柄包装器示例。

关键是，每当一个类包含具有“非平凡”所有权语义的成员时，该类**不**应该负责确保包含类的正确值语义（复制、分配、移动、破坏）的**机制**。相反，每个组成部分本身都应该适当地实现“Rule-Of-3+”，以便复合类可以利用编译器默认的特殊成员。

此外，新的标准智能指针类型极大地简化了为包含类型实现这一点的任务。在大多数情况下，需要注意的成员是指针：std::unique_ptr、shared_ptr、weak_ptr 解决了这里的需求。

对于自定义资源类型，您可能必须编写 Rule-Of-3+ 包装类，但只需编写**一次**。您的其他课程将受益于零规则。

* * *

子弹：

> *   一个能够对等并使用 #define（或 typedef）HANDLE 所基于的基本类型。对我来说，这应该是隐藏的知识，并且解决方案完全基于界面提供的内容，HANDLE。

答：90% 的时间您可以（并且应该）使用`std::unique_ptr<>`自定义删除器。清理的知识和责任仍然在分配者身上。它应该的方式。

在其余情况下，您必须为您的特定资源编写一个包装类，否则不支持。

> *   句柄，可以是任何东西，它们不需要是指针类型。

他们能。你会看看例如 boost::optional。或者写那个包装器。关键是，您希望它为资源**隔离**。您不想使碰巧拥有/包含此类资源的类复杂化。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-14T01:11:13.700

> 这个以句柄为中心的 RAII 包装器是否已经完成并可以在一些很酷的库中使用？

对于您的情况，它被称为`unique_ptr`. 观察：

```
struct WndLibDeleter
{
  typedef HANDLE pointer;

  void operator()(HANDLE h) {::FreeLibrary(h);}
};

using WndLibrary = std::unique_ptr<HANDLE, WndLibDeleter>;

WndLibrary LoadWndLibrary(std::wstring const& name)
{
  return WndLibrary(::LoadLibrary(name.c_str()));
} 
```

使用删除器，`unique_ptr`可以服务存储和服务任何类型的 NullablePointer 对象。`HANDLE`是一个 NullablePointer，所以你可以为它服务。

对于不是 NullablePointers 的对象，您必须使用其他东西。零规则的要点是使“其他东西”*尽可能小*。它只不过是类型的 RAII 包装器，仅提供对它的访问和移动支持。因此，绝大多数代码不需要显式的复制/移动构造函数；只是那几个叶子类。

# string - 更改计数字符的时间顺序

> ID：14865920
> 
> 赞同：0
> 
> 时间：2013-02-14T00:39:09.237
> 
> 标签：string, count, character, python-2.x

我的代码目前从文件中获取一个巨大的字符串。它计算特定字符串“GCAA”的出现次数并返回它出现的次数。然后，它通过 maptrans 替换某些字符。然后它重新计算字符串“GCAA”出现的次数。最后，它反转整个文件/内容。我现在的问题是，我想改变一些正在发生的事情的顺序，但我似乎做不到。我想先反转内容。然后像这样替换字母。最后，在反向+替换后重新计算“GCAA”。（在任何事情发生之前仍然保持第一次计数）。

[编辑]：想通了！！

当前代码：

```
# Code to count occurrence of 'GCAA' before letter switching
g = open("filename.txt", "r")
input2 = g.read()
print(input2.count('GCAA'))
g.close()

# Code to SWITCH all the letters AND count occurence of 'GCAA' after
from string import maketrans
table = maketrans("GCTA", "CGAT")
f = open("filename.txt", "r")
input = f.read()
print(input.translate(table))

result = input.translate(table)
print(result.count('GCAA'))

# Reverse the whole thing
print(result[::-1] )

f.close() 
```

基本上，保持第一部分相同。但后来我想先反转。然后因为它被反转，然后替换字母。在这两项都做完之后，最后再重新计数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T03:32:17.573

我能够弄清楚；我编辑了上面的问题/评论并指出了这一点。感谢所有可能发布最终答案的人。

# javascript - Flexslider 100% 宽度创建水平滚动条

> ID：14865921
> 
> 赞同：6
> 
> 时间：2013-02-14T00:39:13.380
> 
> 标签：javascript, jquery, html, css, flexslider

[http://dl.dropbox.com/u/29703851/js/demo/index.html](http://dl.dropbox.com/u/29703851/js/demo/index.html)

这是示范。

我想使用 100% 宽度的 flexslider，但是当鼠标光标位于 flexslider 之外时，我会得到奇怪的额外宽度和水平滚动条。

当我越过 flexslider 时，水平滚动消失了。有什么建议吗？

我使用演示代码，没有更改 css，没有更改 js。刚刚删除了周围的所有 div，只留下了一个带有 flexslider 类的 div。

100％宽度有合适的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T02:23:31.903

溢出为我解决了问题：隐藏；在 .flexslider

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-23T16:26:15.920

如果你这样做，那也会隐藏“寻呼机”点。我通过添加溢出来解决它：隐藏；到父容器。我正在使用响应式布局，因此父级也在设置宽度。

# jakarta-ee - 在 java EE 中，我应该将哪些 jars 放在库目录中？

> ID：14865923
> 
> 赞同：12
> 
> 时间：2013-02-14T00:39:24.247
> 
> 标签：jakarta-ee, maven, classpath, ear, maven-ear-plugin

我有一个 Java EE 项目。该项目是使用 maven 构建到 .ear 存档中的。有一个包含 JPA 2 持久性单元的库 jar，它位于 ear 的库目录中（因此多个其他模块可以使用它）。

在此持久性单元中添加 Shiro 的 Permission 接口的实现作为实体时，我无法正确部署耳朵，因为 shiro 类在持久性单元中不可用。我最终发现我需要将库 jar 的所有依赖项（也适用于传递 deps）放在库目录中以使其部署。

所以最终的布局大概是这样的：

```
ear
`- lib
   `- persistence-unit.jar
    - shiro-core.jar
    - slf4j-api.jar
 - module1
 - moduleN
 - library1.jar
 - libraryN.jar 
```

现在，对于问题：

1.  是否有关于应该在库目录中放置什么的指导方针，我的解决方案是否普遍可以接受？
2.  为什么耳朵根目录下的库对 lib 目录中的 jar 不可用？
3.  为什么 Maven 不自动解决这个问题？

编辑：耳朵的 pom.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <artifactId>ear</artifactId>
    <packaging>ear</packaging>

    <parent>
        <groupId>com.example</groupId>
        <artifactId>project</artifactId>
        <version>1.0-SNAPSHOT</version>
    </parent>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-ear-plugin</artifactId>
                <version>2.7</version>
                <configuration>
                    <modules>
                        <webModule>
                            <!-- ... -->
                        </webModule>
                        <ejbModule>
                            <!-- ... -->
                        </ejbModule>
                        <jarModule>
                            <groupId>com.example</groupId>
                            <artifactId>persistence-unit</artifactId>
                            <bundleDir>lib</bundleDir>
                        </jarModule>

                        <-- I added these to get the deployment working -->
                        <jarModule>
                            <groupId>org.apache.shiro</groupId>
                            <artifactId>shiro-core</artifactId>
                            <bundleDir>lib</bundleDir>
                        </jarModule>
                        <jarModule>
                            <groupId>org.slf4j</groupId>
                            <artifactId>slf4j-api</artifactId>
                            <bundleDir>lib</bundleDir>
                        </jarModule>
                    </modules>
                </configuration>
            </plugin>
        </plugins>
    </build>

    <dependencies>
        <dependency>
            <groupId>com.example</groupId>
            <artifactId>persistence-unit</artifactId>
        </dependency>
        <dependency>
            <!-- ... -->
            <type>war</type>
        </dependency>
        <dependency>
            <!-- ... -->
            <type>ejb</type>
        </dependency>

        <dependency>
            <groupId>org.apache.shiro</groupId>
            <artifactId>shiro-core</artifactId>
        </dependency>
    </dependencies>
</project> 
```

对于持久性单元：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <artifactId>persistence-unit</artifactId>
    <packaging>jar</packaging>

    <parent>
        <groupId>com.example</groupId>
        <artifactId>project</artifactId>
        <version>1.0-SNAPSHOT</version>
    </parent>

    <dependencies>
        <dependency>
            <groupId>org.jboss.spec</groupId>
            <artifactId>jboss-javaee-6.0</artifactId>
            <type>pom</type>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.shiro</groupId>
            <artifactId>shiro-core</artifactId>
        </dependency>
    </dependencies>
</project> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T10:41:39.050

> 是否有关于应该在库目录中放置什么的指导方针，我的解决方案是否普遍可以接受？

您几乎已经搞定了，应该对所有 EAR 模块都可用的 JAR 应该放在这里。

> 为什么耳朵根目录下的库对 lib 目录中的 jar 不可用？

它通常以相反的方式工作，`lib`文件夹中的 JAR 可供根目录中的 JAR 使用。但是，我相信您可以通过以下方式实现此目的`<includeInApplicationXml>`：

```
<jarModule>
    <groupId>org.nisse</groupId>
    <artifactId>hue</artifactId>
    <includeInApplicationXml>true</includeInApplicationXml>
</jarModule> 
```

> 为什么 Maven 不自动解决这个问题？

我假设您的意思是 maven 不会自动将所有传递依赖项放入`lib`? 我相信它应该这样做，而且确实——你能不能显示你的 POM 的相关部分？

**编辑：**您的 EAR 模块应该只引用 EJB JAR 和 WAR 作为依赖项。任何传递依赖项都应该自动包含在 EAR 中，默认情况下在顶层 - 这可以用`<defaultLibBundleDir>`ear-plugin 中的标签覆盖`<configuration>`：

```
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-ear-plugin</artifactId>
<version>2.7</version>
<configuration>
    <defaultLibBundleDir>lib</defaultLibBundleDir>
    <archive>
        <manifest>
            <addClasspath>true</addClasspath>
        </manifest>
    </archive>
    <modules>
       ... etc. 
```

`<archive>`/部分还应`<addClasspath>`确保正确设置 MANIFEST 类路径。也许这正是您所缺少的？

干杯，

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-14T23:38:57.593

我不会评论 Maven 的配置，而只是评论库应该去哪里。

在 EAR 的模块之间共享库有两种主要机制 -**捆绑库**（在[Java EE 6 规范](http://jcp.org/aboutJava/communityprocess/final/jsr316/index.html)中的 EE.8.2.1 中描述）和**已安装库**(EE.8.2.2)。

**已安装的库**与 EAR 分开安装，因此在应用程序服务器上的许多 EAR 之间共享。

**捆绑库**可以安装在`lib`（默认库目录）、由`library-directory`EAR 的部署描述符的元素指定的目录和/或任何要被模块的`Class-Path`清单标头引用的目录中（或由模块引用的 jar turn 定义了一个传递库）。

我对 Java EE 6 规范的理解是`Class-Path`可以在 EAR 中的任何位置引用任何库，但是 jar 的内容会变成非 Java EE 模块。这意味着`persistence.xml`在部署时不考虑这一点，并且文件中定义的潜在持久性上下文不会在运行时生效。

在您的情况下，`persistence-unit.jar`似乎包含持久性单元配置并使它们可用于其他模块，它应该放在`lib`目录中。其他两个 jar -`shiro-core.jar`并且`slf4j-api.jar`- 可以在 EAR 中的任何位置（包括`lib`用于简单部署的目录 - 不需要`Class-Path`在任何引用库/模块中包含元素）。

将其包装起来，以简化部署，`lib`除非`Class-Path`使用并指向另一个目录，否则将您的库放在目录中。在这种情况下，您宁愿检查引用的 jar 文件是否不是具有持久性单元定义的 Java EE jar，因为它不会被正确部署（并且 PU 对模块不可用）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-01T22:56:47.583

[这篇文章](http://www.developer.com/java/ejb/article.php/10931_3670496_2/Packaging-EJB-3-Applications.htm)有一个很好的表格来解释事情：

> 表 2 标准档案可以加载打包在其中的类，也可以从它所依赖的任何其他档案中加载类。

```
Module      Code Sources
EAR 
            All JARs in the /lib directory of the EAR
            Manifest Class-Path of any JARs in 1
EJB-JAR 
            EJB-JAR file itself
            JARs referenced by manifest Class-Path of EJB-JAR
            JARs referenced by manifest Class-Path of above JARs (in 2)
WAR 
            WEB-INF/classes
            JARs in WEB-INF/lib
            JARs referenced by manifest Class-Path of WAR
            JARs referenced by manifest Class-Path of JARs in 2 and 3 
```

# javascript - 如果文档包含元素，如何禁用功能

> ID：14865925
> 
> 赞同：0
> 
> 时间：2013-02-14T00:39:49.520
> 
> 标签：javascript, jquery, if-statement, keyboard, lightbox

所以，我有一个使用箭头键从左到右滚动的网站。我还有一个灯箱，它也使用箭头键浏览每个图像。附加灯箱后，有没有办法让该功能不触发？

像这样的东西：

```
$('body').keydown( function(e) {
    if(e.keyCode == 37) {
if ($("body").has("#lightbox").length< 0) { do nothing }
else {
    {
    do something
    }
    }); 
```

需要明确的是：元素 #lightbox 仅在点击灯箱触发元素后才会存在/被附加

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:50:04.470

```
$('body').keydown( function(e) {
    if(e.keyCode == 37) {
if ($("body").has("#lightbox").length > 0) { do something }
else {
{
do nothing
}
}); 
```

?

# android - Android：动态添加按钮时重新排列按钮

> ID：14865926
> 
> 赞同：1
> 
> 时间：2013-02-14T00:39:56.437
> 
> 标签：android, android-layout, android-button

用图表可以更好地解释我的问题，但总体思路如下：

我正在向布局中动态添加按钮。在整个用户交互过程中添加按钮。如果有一个按钮，我希望它位于父级的中心。

```
|...............[Button 1]...............| 
```

对于两个按钮，我希望它们彼此相邻居中。

```
|..........[Button 1][Button 2]..........| 
```

这种模式将一直持续到一定数量的按钮（以免它们全部聚集在同一行/行）。因此，假设每行/行的最大按钮数为 4。因此，对于任何数量大于 4 的按钮，我希望它们在以下行/行上均匀拆分。所以对于 5 个按钮，它看起来像这样：

```
|.....[Button 1][Button 2][Button 3].....|
|..........[Button 4][Button 5]..........| 
```

基本上我希望能够以编程方式在行/行中布局按钮，以便每行包含尽可能相同（或接近相同）数量的按钮，因此它们分布均匀。

* * *

目前我的按钮以网格格式布局，在调用之前是不可见的，但它看起来很难看。所以它看起来像这样：

```
|[Button 1][Button 2]....................| 
```

或者如果有 5 个按钮，它看起来像这样：

```
|[Button 1][Button 2][Button 3][Button 4]|
|[Button 5]..............................| 
```

这只是看起来丑陋/俗气，所以我希望它们像我在顶部部分中解释的那样以编程方式布局。

* * *

有可能做我要求的吗？如果是这样，我将如何去做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T07:38:22.213

你可以这样做：

1/ 使用 a`RelativeLayout`作为所有这些的根`ViewGroup`。

2/`LinearLayout`对 的每一行使用 a `Buttons`，将其设置为具有唯一 ID，并为其宽度和高度`RelativeLayout.LayoutParams`设置为。用作规则，当您添加一行（第 2、3、4 等，即不是第 1 行）时，另外添加 rule ，并`WRAP_CONTENT`使用它应该在下面的行的 id。`CENTER_HORIZONTAL``BELOW`

3/ 要确定 a`Button`是否适合一行，请使用 . 获取行的宽度和`RelativeLayout`（在步骤 1 中）的宽度`getMeasuredWidth()`。使用那些你可以检查是否`Button`适合 - 假设它们使用固定宽度。

编辑

示例（不包括第 3 步）：

在您的 Activity 中添加一个成员变量`ViewGroup list`，然后在 Activity.onCreate() 中：

```
list = new RelativeLayout(this);
list.setLayoutParams(new FrameLayout.LayoutParams(MATCH_PARENT, MATCH_PARENT));
setContentView(list); 
```

添加方法来添加按钮。

```
private void addButton(String btnTitle)
{
    // find out how many rows we have in our relative layout  
    int rowCount = list.getChildCount();

    int buttonCount = MY_MAX_BUTTONS_PER_ROW;

    // find out how many buttons are in the last row
    if (rowCount > 0) buttonCount = ((ViewGroup)list.getChildAt(rowCount-1)).getChildCount();

    final ViewGroup row;

    // do we have no rows, or is there no room for another button?
    if (rowCount == 0 || buttonCount >= MY_MAX_BUTTONS_PER_ROW)
    {
        // create a row 
        LinearLayout newRow = new LinearLayout(this);
        newRow.setId(rowCount+1);
        RelativeLayout.LayoutParams rowLP = new RelativeLayout.LayoutParams(WRAP_CONTENT, WRAP_CONTENT);
        rowLP.addRule(CENTER_HORIZONTAL);
        if (rowCount > 0) rowLP.addRule(BELOW, rowCount);

        list.addView(newRow, rowLP);

        rowCount++;  

        row = newRow;
    }
    // .. there's room, so add it to the last row
    else 
    {
        row = (ViewGroup)list.getChildAt(rowCount-1);
    }

    // create one of your buttons
    // ...

    button.setLayoutParams(new LinearLayout.LayoutParams(WRAP_CONTENT, WRAP_CONTENT));
    row.addView(button);
} 
```

# android - Qt 网络服务器与移动浏览器

> ID：14865933
> 
> 赞同：3
> 
> 时间：2013-02-14T00:40:06.753
> 
> 标签：android, qt, http, webserver, opera

我在 qt 中为非常特定的需求创建了一个非常简单的网络服务器。就这么简单，让我们有一个 http 请求： GET /cover.png HTTP 1.1

响应完美地到达台式计算机。当我尝试从移动设备获取图像时（我尝试了更多，但可以说是 android+opera），图像不会加载。在 Opera 中，它只加载大约 1/3 的图片，而在服务器端 qt 声称所有字节都发送正常。

我注意到这取决于图像的大小：~4k 是可以的，但 12k 是“太多”

我知道 android 上的歌剧可以加载更大的图像，所以我必须在响应中搞砸一些东西。但同时，在我的桌面上，所有主流浏览器都很好。

我注意到在显示部分加载的图像后，opera 会打开一个新的 tcp 连接到我的服务器，但什么也没发送！它是否试图分块加载图像？http中有这样的东西吗？

我真的迷失了这里的东西......

更新：如果文件足够大，它将无法在桌面环境中运行！经验限制：桌面：最大。65339 字节移动：最大。12834 字节

由于限制根本不一样，我认为它与 Qt 无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T04:03:42.447

第 241 行有一个错字：

```
int len = 4096; 
```

应该：

```
int len = 32768; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:39:11.003

我设法弄清楚：图像的下载停止，因为我的服务器过早地关闭了 tcp 连接。这很奇怪，因为我发送这样的回复：

```
socket->write( message );
if( !socket->waitForBytesWritten( 5000 ) )
{ puts( "Timed out!" ); }
emit sent(); 
```

这种方式行不通。QTcpSocket 是一个缓冲的 IODevice，所以如果发送超时它应该打印。也许我对 waitForBytesWritten() 有误解。所以事实证明这毕竟是一个 Qt 问题。如果我在发送后不删除套接字，它就可以了。桌面和移动浏览器的大小限制差异在于它们可以达到的速度（在我删除套接字之前它可以接收多少字节）。

那么如何确定所有字节何时真正发送到客户端呢？

# python - Scipy 稀疏行/列点积

> ID：14865935
> 
> 赞同：2
> 
> 时间：2013-02-14T00:40:11.573
> 
> 标签：python, scipy, readability, code-readability

使用 scipy 计算稀疏矩阵的两列或两行之间的点积的可读且有效的方法是什么？假设我们要取两个向量`x`和的点积`y`，两列稀疏矩阵`A`，那么我目前正在做：

```
 x = A.getcol(i)
    y = A.getcol(j)
    dot = (x.transpose() * y)[0,0] 
```

`A`以形式存储`csc`以提高效率。有没有更易读的方法来获得点积而不牺牲效率？

注意：使用 Python 2.7.2 和 scipy 0.11.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T01:15:15.633

稀疏矩阵有一个`dot`方法，所以你也可以用

```
dot = x.T.dot(y)[0, 0] 
```

但我个人觉得你的代码至少和上面的一样好。

# ruby-on-rails - 从 CSV 导入，对象无意中保存了多次

> ID：14865942
> 
> 赞同：0
> 
> 时间：2013-02-14T00:40:37.090
> 
> 标签：ruby-on-rails, csv, hash, import, ruby-on-rails-3.2

我正在尝试向我的应用程序添加“通过 CSV 导入”功能。我一直在玩弄代码来弄清楚它是如何工作的。在我的应用程序 a`User has_many :websites`和 a`Website has_many :links`中。这是我目前拥有的：

```
def create
  file = params[:file]
  @hash = {} 
  CSV.foreach(file.path, headers: true) do |row|
    hash = row.to_hash.slice("link", "project", "comment", "email")
    site = row["website"]
    @hash.has_key?(site) ? @hash[site] << hash : @hash.merge!(site => [hash])
    @hash.keys.each { |key| create_site(key, @hash[key]) }
  end
  flash[:success] = "File imported successfully! Links are currently being processed."
  redirect_to new_import_site_path
end

private

def create_site(site_link, links_array)
  website = current_user.websites.build(link: site_link)
  links_array.each do |link|
    website.links.build(page: link["link"], validation_id: current_user.id)
  end
  website.save
end 
```

该代码正在生成正确的哈希，例如：

```
{"http://google.com"=>[{"link"=>"http://stackoverflow.com", "project"=>"Test", "comment"=>"this is a comment", "email"=>"email@gmail.com"}, {"link"=>"http://golf.com", "project"=>nil, "comment"=>"this is a comment", "email"=>"email@gmail.com"}], "http://yahoo.com"=>[{"link"=>"http://bing.com", "project"=>"Test", "comment"=>"this is a comment", "email"=>"email@gmail.com"}]} 
```

如果我使用上面的哈希在 Rails 控制台中运行代码，它只会按预期创建 2 个网站和 3 个链接，但是在我的应用程序中它会创建 5 个网站和 6 个链接：

```
Website             ID   Associated Link            ID
http://yahoo.com  | 406  http://bing.com          | 1223
http://google.com | 405  http://golf.com          | 1222
http://google.com | 405  http://stackoverflow.com | 1221
http://yahoo.com  | 404  http://bing.com          | 1220
http://google.com | 403  http://stackoverflow.com | 1219
http://google.com | 402  http://stackoverflow.com | 1218 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T02:24:12.933

对于 CSV 文件中的每一行，您都在重新创建在前几行中看到的所有网站。我不认为这是你的意图。

答案是将罪魁祸首的代码行移出循环，以便您只在完成链接数组之后才创建每个站点一次。

```
def create
  file = params[:file]
  @hash = {} 
  CSV.foreach(file.path, headers: true) do |row|
    hash = row.to_hash.slice("link", "project", "comment", "email")
    site = row["website"]
    @hash.has_key?(site) ? @hash[site] << hash : @hash.merge!(site => [hash])
  end

  # moved this out
  @hash.keys.each { |key| create_site(key, @hash[key]) }

  flash[:success] = "File imported successfully! Links are currently being processed."
  redirect_to new_import_site_path
end 
```

# smlnj - 检查输入是否为斐波那契数

> ID：14865945
> 
> 赞同：0
> 
> 时间：2013-02-14T00:40:57.900
> 
> 标签：smlnj, ml

```
fun isfib(a) =
   findfib(a,1,1)

and
findfib(b,x,y) =
   val z = x + y
   if b <= 1 then true
   else if z > b then false
   else if z = b then true
   else fib(b,y,z) 
```

我在程序中输入了一个输入，并递归地尝试找出这个输入是否是一个 fib 数字。我可以在 2 行的单独程序中计算 fib 的第 x 个位置。但是这种“输入，检查是否等于 fib，将 fib 设为无穷大或破产”的逻辑让我非常困惑。我还在第 7.1 行遇到错误，例如“用 ANDALSO 替换 AND”和“插入 ORELSE”，即 B<=1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:05:06.530

I mean that you should use `and` for cases where you need mutual recursion, in this case it doesn't seems like you really do, for example, you could try something like this:

```
fun fib 0 = 1
    | fib 1 = 1
    | fib n = (fib (n-1)) + (fib (n-2));

fun isfib a = 
    let
        fun eval a b = if a = (fib b) then true else if a < (fib b) then false else eval a (b+1)
    in
        eval a (1)
end; 
```

Try running `isfib 5` and `isfib 6` for example. No infinity required.

# php - 如何使用 php 检查文本版本的 github 文件

> ID：14865946
> 
> 赞同：0
> 
> 时间：2013-02-14T00:41:07.947
> 
> 标签：php, github

我的问题很简单！
我可以在模式下看到文本上的 github 文件如何？
我只需要比较包含的 github 文件。

你知道怎么用ph​​p吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:54:29.103

当涉及到原始文件时，Github 有非常简单的 url。看这个例子：

> [https://raw.github.com/libgit2/libgit2/development/CMakeLists.txt](https://raw.github.com/libgit2/libgit2/development/CMakeLists.txt)

所以只要知道 github 项目中文件的路径，就可以使用特殊的`raw.github.com`主机名，从 PHP 中读取内容。

# sql-server - “for XML Explicit”查询的输出根据连接更改货币列的尾随零

> ID：14865947
> 
> 赞同：2
> 
> 时间：2013-02-14T00:41:23.420
> 
> 标签：sql-server, for-xml, for-xml-explicit

我有一个 Microsoft SQL Server 查询，它建立一个临时表，然后使用“for XML Explicit”语法输出 XML，如下所示：

```
select * from @XMLOutput order by 
  [UaarSale!1!NodeOrder!hide], [UaarSale!1!NestingId!hide], Tag  
for XML Explicit 
```

这都包含在存储过程中。我们只需运行传入我们的 Id 的存储过程来获取 XML 文档。

查询本身运行良好，并且已经运行了好几年。但是，我们现在发现 XML 输出根据谁调用存储过程而发生变化的情况。我们的输出包含大量的货币数据类型。在某些情况下，货币类型中不包含尾随零。在其他情况下，类型始终显示 4 个有效数字。

在我的测试环境中，我在 SQL Server 2008 R2 数据库上复制了它。

例如，我的主程序（与旧的 SQLOLEDB 提供程序连接）获取不包含尾随零的 XML。

```
<node value="12.34" /> 
```

但是，当我从 SQL Server Management Studio 运行相同的存储过程时，我总是得到 4 个位置。

```
<node value="12.3400" /> 
```

我还有一个客户端使用相同的 SQLOLEDB 提供程序与我的应用程序连接，该提供程序正在获得额外的零。

我处理 XML 文件以生成报告。那些并不期待额外的零。由于我在两个不同的程序之间看到不同的输出，我猜测（希望）有一个数据库选项、连接字符串选项或额外的命令参数来控制货币类型如何转换为 XML 输出的字符串。

这样的事情是否存在，如果存在，我该如何设置该值以保持输出一致？最好没有额外的零。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:21:46.090

我所做的是用来`CONVERT(VARCHAR, xxx)`解决这个问题。

这是在 SQL Server 2008 R2 中测试的示例：

```
DECLARE @foo MONEY
SELECT @foo = 15.95

SELECT @foo AS 'foo' FOR XML PATH('')
SELECT CONVERT(varchar, @foo) AS 'fee' FOR XML PATH('') 
```

# java - 将字符串转换为表示日期的整数

> ID：14865953
> 
> 赞同：0
> 
> 时间：2013-02-14T00:42:21.827
> 
> 标签：java

我需要将表示日期的字符串转换为日期。

日期构造如下：

```
private int m;
private int d;
private int y;

public Date(int month, int day, int year) {
      if (isValidDate(month, day, year)) {
          m = month;
          d = day;
          y = year;  
      } else {
          System.out.println("Error: not a valid date");
          System.exit(0);
      }
  } 
```

需要转换为该日期对象的字符串格式为：

```
"month/day/year" 
```

月份为 1 或 2 个字符，日为 1 或 2 个字符，年份可以为 1 - 4 个字符。

我的想法是遍历字符串并找到字符`/`出现的时间，但我觉得有更好的方法来处理它。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:51:02.000

你可以这样做：

```
String date = "14/02/2013";
String [] splitDate = date.split("/");
Date date = new Date(Integer.parseInt(splitDate[0]),
                     Integer.parseInt(splitDate[1]),
                     Integer.parseInt(splitDate[2])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:45:48.517

使用`String.split("/")

它为每个标记返回字符串数组，然后您只需将每个标记解析为整数并创建日期对象。`

您可能还想查看 DateFormat 类。它可能能够为您解析字符串。

编辑：

而是使用静态工厂方法。

```
public static Date asDate(String s) { 
    String[] dateStrings = s.split("/"); 
    int m = Integer.parseInt(dateStrings[0]); 
    int d = Integer.parseInt(dateStrings[1]); 
    int y = Integer.parseInt(dateStrings[2]); 
    return new Date(m, d, y);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T01:10:43.503

也许这段代码可以帮助你。

```
public class TestDate {

    private int m;
    private int d;
    private int y;

    public static void main(String[] args) {
        String date = "02/14/2013";
        String[] splitDate = date.split("/");
        TestDate td = new TestDate();
        td.Date(Integer.parseInt(splitDate[0]),
                Integer.parseInt(splitDate[1]), 
                Integer.parseInt(splitDate[2]));
        System.out.println(td.m +"/"+td.d+ "/"+td.y);
    }

    public void Date(int month, int day, int year) {
        if (isValidDate(month, day, year)) {
            m = month;
            d = day;
            y = year;
        } else {
            System.out.println("Error: not a valid date");
            System.exit(0);
        }
    }

    private static boolean isValidDate(int month, int day, int year) {
        String stDate = month + "/" + day + "/" + year;
        SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");
        sdf.setLenient(false);
        try {
            sdf.parse(stDate);
            return true;
        } catch (ParseException e) {
            e.printStackTrace();
            return false;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-14T00:51:38.323

也许您可以使用字符串类的方法来获取您的子字符串，或者使用某种字符串标记器（我不太了解 java，所以无法帮助您提供确切的名称）。但是“在幕后”这些函数也必须遍历字符串，没有办法绕过它。所以我认为你的想法很好。这只是您是否想掌握 Java 中内置的可能性的问题，或者您只是想快速完成它:)

# jquery - jQuery 声明错误

> ID：14865955
> 
> 赞同：1
> 
> 时间：2013-02-14T00:42:35.883
> 
> 标签：jquery

我在页面中的 jQuery 声明显然有问题：

[http://www.northernvirginiapaintingcontractor.com](http://www.northernvirginiapaintingcontractor.com) 点击“绘制事实”

错误：“$.fn”为空或不是对象

指这一行：

```
$.fn.accordion = function () { 
```

我正在将此声明用于另一个网站并且工作正常。

但是对于这个网站 - 这不能正常工作。

在网站上的一个单独页面中：GeneralContact jQuery 声明设置如下：

```
jQuery(document).ready(function ($) { 
```

我没有足够的jQuery经验来调试这个，如果有人能看到问题，我将非常感激！

看来这个脚本在几个地方引用了 $： moredetail_click() hidedetail_click() based_set()

我不确定所有“$”引用是否有解决方法，或者我是否应该以某种方式重新编写它？

```
 $.fn.accordion = function () {
        return this.each(function () {
            $container = $('#FactsLeftColumn');
            $container.find("dt").each(function () {
                var $header = $(this);
                var $selected = $header.next();

                $header.click(function () {
                    $('.active').removeClass('active');
                    $(this).addClass('active');
                    if ($selected.is(":visible")) {
                        $selected.animate({
                            height: 0
                        }, {
                            duration: 300,
                            complete: function () {
                                $(this).hide();

                                var id = $(this).attr("id");

                                var num;
                                if (id.length < 3) {
                                    num = id;
                                } else {
                                    num = id.substring(2, id.length);
                                }
                                $('#hidden_' + num).hide();
                                $('#more' + num).show();

                            }
                        });
                    } else {
                        $unselected = $container.find("dd:visible");
                        $selected.show();
                        var newHeight = heights[$selected.attr("id")];
                        var oldHeight = heights[$unselected.attr("id")];

                        $('<div>').animate({
                            height: 1
                        }, {
                            duration: 300,
                            step: function (now) {
                                var stepSelectedHeight = Math.round(newHeight * now);
                                $selected.height(stepSelectedHeight);
                                $unselected.height(oldHeight + Math.round((newHeight - oldHeight) * now) - Math.round(newHeight * now));
                                if ($unselected.attr("id") != null) {
                                    var id = $unselected.attr("id");

                                    var num;
                                    if (id.length < 3) {
                                        num = id;
                                    } else {
                                        num = id.substring(2, id.length);
                                    }
                                    $('#hidden_' + num).hide();
                                    $('#more' + num).show();
                                }
                            },
                            complete: function () {
                                $unselected.hide().css({
                                    height: 0
                                });
                            }
                        });
                    }
                    return false;
                });
            });

            var heights = new Object();

            $container.find("dd").each(function () {
                $this = $(this);
                $this.css("overflow", "hidden");
                heights[$this.attr("id")] = $this.height();

                $this.hide().css({
                    height: 0
                });
            });
        });
    };

    function moredetail_click(ddnum) {
        $('#view_' + ddnum).hide();
        $('#hidden_' + ddnum).show();
        var newHeight = $('#hidden_' + ddnum).height() + 2;
        if (ddnum < 5) {
            $('#' + ddnum).height(newHeight);
        } else {
            $('#Dd' + ddnum).height(newHeight);
        }
    }

    function hidedetail_click(ddnum) {
        $('#hidden_' + ddnum).hide();
        $('#view_' + ddnum).show();

        var newHeight = $('#view_' + ddnum).height() + 1;
        if (ddnum < 5) {
            $('#' + ddnum).height(newHeight);
        } else {
            $('#Dd' + ddnum).height(newHeight);
        }
    }

    function according_set() {
        $("#FactsLeftColumn").accordion();
    }

    $(document).ready(function () {
        $("#featured > ul").tabs({ fx: { opacity: "toggle"} }).tabs("rotate", 5000, true);

        var idnum = 1;
        var ddnum = 1;

        $.getJSON('FaqsJson.ashx?factType=1', function (datas) {
            var str_one = "";
            str_one = "<dl>"

            var array_len = datas.length;
            var each_num = 1;

            var answer = "";
            var split_str;
            var len, i, start_pos;

            $.each(datas, function () {
                if (this['Answer'].length > 200) {
                    split_str = this['Answer'].split(". ");
                    len = split_str.length;

                    answer = "<div id='view_" + ddnum + "'>";
                    if (split_str[0].length < 150) {
                        answer += split_str[0] + ". " + split_str[1] + ".   <a href='javascript:;' id='more" + ddnum + "' onclick='moredetail_click(" + ddnum + ")' class='moredetail'>Read More</a>";
                        start_pos = 2;
                    }
                    else {
                        answer += split_str[0] + ".   <a href='javascript:;' id='more" + ddnum + "' class='moredetail' onclick='moredetail_click(" + ddnum + ")'>Read More</a>";
                        start_pos = 1;
                    }
                    answer += "</div>";
                    answer += "<div id='hidden_" + ddnum + "' style='display:none;width:534px;'>";
                    answer += this['Answer'];
                    answer += "   <a href='javascript:;' id='more" + ddnum + "' class='moredetail' onclick='hidedetail_click(" + ddnum + ")'>Read Less</a>";
                    answer += "</div>";
                }
                else {
                    answer = this['Answer'];
                }

                str_one += "<dt class=\"glossquestion\"><a href=\"javascript://\" class=\"questionLink\">" + this['Question'] + "</a></dt>";
                if (idnum < 5)
                    str_one += "<dd id=\"" + ddnum + "\" class=\"glossanswer\" style=\"right-margin:5px;width:544px;\"><div class=\"answerbox\" style=\"width:536px;\">" + answer + "</div></dd>";
                else
                    str_one += "<dd id=\"Dd" + ddnum + "\" class=\"glossanswer\" style=\"right-margin:5px;width:544px;\"><div class=\"answerbox\" style=\"width:536px;\">" + answer + "</div></dd>";
                idnum++;
                ddnum++;
                each_num++;

                str_one += "</dl>";
            });

            $("#glossary_first").html(str_one);

            window.setTimeout(according_set, 2000);
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:49:21.717

您可以尝试这种格式，这样`$`将与全局范围分开，其他库不会冲突

```
jQuery.noConflict();
(function( $ ){
    $.fn.accordion = function () { ... };
})( jQuery ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T01:06:59.327

当您将 jQuery 与其他库一起使用时，请使用 jQuery.noConflict(); 防止冲突的方法。

# selenium - 使用具有唯一 ID 的 selenium RC 填充表单

> ID：14865956
> 
> 赞同：0
> 
> 时间：2013-02-14T00:42:46.573
> 
> 标签：selenium, webdriver

我正在尝试使用 Selenium RC 填充表单。表单字段具有唯一的 ID，即我无法在我的 RC 代码中指定它们。我可以将以下内容与 webdriver 一起使用：

```
driver.findElements(By.tagName("input")); 
```

我可以为 selenium RC 寻找类似的东西，还是应该考虑由 webdriver 支持的 RC？谢谢

# php - 可以在对象上使用 IF 语句吗？

> ID：14865959
> 
> 赞同：1
> 
> 时间：2013-02-14T00:43:30.627
> 
> 标签：php

如果我陈述错误或使用了不正确的术语，我深表歉意。但我试图弄清楚如何在对象上使用 if 语句。

这工作得很好，据我了解，@ 抑制错误。

```
if (@mail("$receiver_email", "$subject", "$message", "$headers")) { } 
```

但是，如果我这样做，它会失败：

```
if (@$mail->send('email@gmail.com', "$receiver_email", "$subject", "$message")) {} 
```

具有讽刺意味的是，电子邮件通过但 IF 失败。如何修复 IF 语句以使其正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:46:31.360

第一：尽量避免@，这通常是一种不好的做法..

为什么 if 失败不取决于发送是否成功。只有当`mail()`任何类`$mail`中的函数实际上返回一些东西（如真或假）时，你才能用它做一些事情。

由于这不是一个内置的 PHP 类，您应该要求您的类的作者（或您自己，如果您编写了它）在成功时返回 true。

简而言之：这不是你可以解决的，编写`send`函数的人可以解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:46:42.213

首先，不要使用`@`. 这是不好的做法，最好使用错误处理程序来处理；另请参阅：[错误记录，以流畅的方式](https://stackoverflow.com/questions/10331084/error-logging-in-a-smooth-way/10476589#10476589)

从你的代码我只能猜测你的代码是这样的：

```
public function send($from, $to, $subject, $message)
{
    // your code here
} 
```

如果该函数没有返回值，则默认为`null`并且计算`false`结果为 IF “失败”的原因。

您应该从您的`send()`方法返回一个成功值。

# python - 遍历命名空间

> ID：14865961
> 
> 赞同：18
> 
> 时间：2013-02-14T00:43:37.917
> 
> 标签：python, namespaces

我有一个如下所示的名称空间：

> 命名空间(aTQ=None, bE=None, bEQ=None, b=None, bQ=None, c=None, c=None, cJ=None, d=None, g=None, jR=['xx', ' 015']，lC=无，l=无）

如何遍历它，以便找到并替换“jR”键的“xx”值？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-14T01:09:27.477

我不确定您事先知道什么（名称`jR`，或只有一个名称有`not None`值），但您可以尝试使用`vars()`which，就像`__dict__`应该是一个将名称空间中的名称作为其键的字典。因此，如果您在`'jR'`某处有字符串，

```
vars()['jR'] = vars()['jR'][0] 
```

同样，您可以使用`namespace.__dict__`而不是获得相同的字典`vars()`

将为您留下第一个值`['xx','015']`作为 的唯一值`jR`。

编辑：要清楚，因为`vars()`和`__dict__`都返回字典，你可以遍历它们：

```
for k in namespace.__dict__:
    if namespace.__dict__[k] is not None:
        <<do something>> 
```

# c# - 将文件保存到 MyDocuments + App 文件夹

> ID：14865963
> 
> 赞同：11
> 
> 时间：2013-02-14T00:43:45.103
> 
> 标签：c#, file, append, savefiledialog, appsettings

我正在尝试将我的 .NET 应用程序设置文件保存到用户的 %MyDocument%\MyApplication 文件夹，但我不知道如何检查现有文件夹\文件，并在保存时创建或附加文件夹\文件。我不想打开 saveFileDialog 因为我需要文件在所有用户计算机上的同一个位置。这是我到目前为止所拥有的，但它不起作用。任何帮助，将不胜感激：

```
var saveSettings = settingsList.text;  //assign settings to a variable
saveSettings = Regex.Replace(saveSettings, @"\s+", "").Trim() + Environment.NewLine; //remove any extra spaces and add a carriage return so that each setting is on a new line            

var fileName = string.Format("{0}\\{1}", Environment.SpecialFolder.MyDocuments + "\\MyApp\\", "settings.dat");  //generate path to settings.dat
File.AppendAllText(fileName, saveSettings);  //save settings.dat 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-14T00:57:09.993

```
string path = System.IO.Path.Combine(Environment.GetFolderPath(
    Environment.SpecialFolder.MyDoc‌​uments),"MyApp","settings.dat");

if(Directory.Exists(path))
{
    //Exists
}
else
{
    //Needs to be created
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-22T19:50:41.163

System.IO.Directory.CreateDirectory(Server.MapPath(path)); //你不需要先检查它是否存在

# cakephp-2.3 - cakephp 2.3 定义数据模型

> ID：14865964
> 
> 赞同：0
> 
> 时间：2013-02-14T00:43:44.870
> 
> 标签：cakephp-2.3

在我的数据模型中，主要实体是职位空缺（工作）、公司和学生

公司创建了一个空缺，所以我有一个 belongsTo 关系，这很好

一个学生可以申请多个职位空缺，所以为了存储这个我有一个链接表 openings_students

id|opening_id|user_id

在开放模型类中，我有 HABTM 关联

```
 public $hasAndBelongsToMany = array(
    'Applicants' => array(
        'className' => 'Student',
        'joinTable' => 'openings_students',
        'foreignKey' => 'opening_id',
        'associationForeignKey' => 'user_id',
        'unique' => 'true',
        'conditions' => '',
        'fields' => '',
        'order' => '',
        'limit' => '',
        'offset' => '',
        'finderQuery' => '',
        'deleteQuery' => '',
        'insertQuery' => ''
    )
); 
```

这就是我所需要的，还是我需要与学生建立另一个 HABTM 关系？

只是开始进入框架，所以任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T04:45:56.717

你扔的最好的文件是 cakephp 2.0

[http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasandbelongstomany-habtm](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasandbelongstomany-habtm)

我在这里有一个问题，您正在使用学生表并且您的外键是 user_id，您是否有两个表用户、学生或单表学生，其外键是 user_id？你能澄清一下吗？

# javascript - jQuery find() 方法在 AngularJS 指令中不起作用

> ID：14865965
> 
> 赞同：45
> 
> 时间：2013-02-14T00:43:45.247
> 
> 标签：javascript, angularjs, angularjs-directive

我在使用 angularjs 指令查找带有注入的 angular 元素的子 DOM 元素时遇到问题。

例如，我有一个这样的指令：

```
myApp.directive('test', function () {
    return {
        restrict: "A",
        link: function (scope, elm, attr) {
            var look = elm.find('#findme');
             elm.addClass("addedClass");
            console.log(look);
        }
    };
}); 
```

和 HTML，例如：

```
<div ng-app="myApp">
    <div test>TEST Div
        <div id="findme"></div>
    </div>
</div> 
```

我可以访问通过向其添加类来提供的元素。但是，尝试访问子元素会在 var 外观中产生一个空数组。

[JSFiddle 演示在这里](http://jsfiddle.net/raygarner/FZGKA/7/)。

为什么如此微不足道的事情不能正常工作？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-02-14T00:52:28.010

从上的[文档`angular.element`](http://docs.angularjs.org/api/angular.element)：

> `find()`- 仅限于按标签名称查找

因此，如果您没有将 jQuery 与 Angular 一起使用，而是依赖于其 jqlite 实现，那么您将无法使用`elm.find('#someid')`.

您确实可以访问`children()`、`contents()`和`data()`实现，因此您通常可以找到解决方法。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2015-06-23T17:08:59.470

您可以通过 2 个步骤轻松解决该问题：

1-使用 querySelector 到达子元素，如下所示： `var target = element[0].querySelector('tbody tr:first-child td')`

2-通过执行以下操作再次将其转换为`angular.element`对象： `var targetElement = angular.element(target)`

然后，您将可以访问该`targetElement`变量的所有预期方法。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-03-04T22:45:51.007

在 jQuery 出现之前，您会使用：

```
 document.getElementById('findmebyid'); 
```

如果这一行将为您节省整个 jQuery 库，那么使用它可能是值得的。

对于那些关心性能的人：以 ID 开头的选择器总是最好的，因为它使用原生函数 document.getElementById。

```
// Fast:
$( "#container div.robotarm" );

// Super-fast:
$( "#container" ).find( "div.robotarm" ); 
```

[http://learn.jquery.com/performance/optimize-selectors/](http://learn.jquery.com/performance/optimize-selectors/)

jsPerf [http://jsperf.com/jquery-selector-benchmark/32](http://jsperf.com/jquery-selector-benchmark/32)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-09-12T07:26:21.820

`find()`- 仅限于按标签名称查找，您可以查看更多信息 [https://docs.angularjs.org/api/ng/function/angular.element](https://docs.angularjs.org/api/ng/function/angular.element)

您也可以通过姓名或 ID 访问或致电以下示例：

```
angular.element(document.querySelector('#txtName')).attr('class', 'error'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-23T13:36:05.557

我用了

```
elm.children('.class-name-or-whatever') 
```

获取当前元素的子元素

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2016-01-21T18:44:24.303

如果有人想从“控制器作为”元素中获取范围，那么......就像这样：

```
<div id="firstctrl" ng-controller="firstCtrl as vm"> 
```

使用以下内容：

```
var vm = angular.element(document.querySelector('#firstctrl')).scope().vm; 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2015-06-24T13:28:46.880

你可以这样做：

```
 var myApp = angular.module('myApp', [])
  .controller('Ctrl', ['$scope', function($scope) {
     $scope.aaa = 3432
 }])
 .directive('test', function () {
    return {
       link: function (scope, elm, attr) {
           var look = elm.children('#findme').addClass("addedclass");
           console.log(look);
        }
   };
});

<div ng-app="myApp" ng-controller="Ctrl">
   <div test>TEST Div
      <div id="findme">{{aaa}}</div>
   </div>
</div> 
```

[http://jsfiddle.net/FZGKA/133/](http://jsfiddle.net/FZGKA/133/)

# intellij-idea - 被智能类型完成覆盖的实时模板快捷方式

> ID：14865970
> 
> 赞同：1
> 
> 时间：2013-02-14T00:44:26.483
> 
> 标签：intellij-idea

在以前的 IntelliJ 版本中，我总是为 JUnit 测试方法设置自己的实时模板。像这样：

```
@Test
public void should$DO_WHAT_NOW$() {
    $END$
} 
```

然后我会将它映射到关键字`test`，当我输入 test+TAB 时，它会扩展到模板中。它奏效了。

但是，在 v12 中，IDE 似乎更喜欢在选项卡上扩展为一种类型。例如，我键入`test`+TAB，IDE 将其更改为它可以找到的第一个模糊匹配类型。例如`BusinessWidgetTest`。我似乎无法为我的用户模板启用实时模板功能。

发生了什么变化？我究竟做错了什么？

编辑：我已经为 Java 启用了“适用于”上下文，但它没有任何效果。我什至启用了“无处不在”作为测试，但这也不起作用。

编辑：我`expand with`从更改`Default (tab)`为`Enter`并开始工作。然后我将其改回`Default (tab)`并继续工作。也许这是一个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T02:28:54.773

我相信 IDEA 12 改变了您选择模板“适用于”的方式，默认情况下，它们似乎什么都不适用。在“模板文本”区域下，您应该看到“没有适用的上下文”。或“适用于 <某事>。” 连同一个链接，让您选择模板应该应用的上下文（即文件类型或语言部分）。如果您想要，请确保选择“Java”或其中的某个部分。

# javascript - 如何创建一个不可见的 div 来触发 dragEnter 上的事件？

> ID：14865971
> 
> 赞同：0
> 
> 时间：2013-02-14T00:44:26.940
> 
> 标签：javascript, html, backbone.js, drag-and-drop

我有一个 div 用作触发 ondragEnter 事件以在屏幕底部打开一个窗格的区域。当我将 HTML5 可拖动对象拖入此 dnd 容器时，它将打开底部窗格。问题是，dnd-container 区域中的可拖动元素无法被拖动，这将触发 ondragEnter 事件（因为 ondragStart 事件已经在 dnd-container 内发生）。我必须在 dnd-container 之外才能成功地将元素拖到 dnd-container 中，这会打开显示放置区的底部窗格。有什么想法吗？也许我正在以错误的方式解决这个问题。

代码片段：

应用程序.html

```
<div id="card-container"></div> <!--contains some objects that are draggable="true"-->
<div id="dnd-container"></div>
<div id="bp-container"></div> 
```

布局.js

```
define(...{
    var AppLayout = Marionette.Layout.extend({
       template : tmpl,
       events : {
         'dragenter #dnd-container' : 'toggleBot',
       },
       toggleQB : function(){
          x.publish('toggleQB'); //just opens and closes the bottom pane
       },
   });
 return AppLayout;
}); 
```

样式.css

```
#dnd-container {
    position: fixed;
    right: 0px;
    bottom: 28px;
    left: 0px;
    top: 70%;
    z-index: -1;
}

#bp-container {
    width : 100%;
    height: 275px;
    margin-left:auto;
    background-color: 000000;
    margin-right:auto;
   -moz-border-radius: 0px;
   -webkit-border-radius: 7px 7px 0px 0px;
    border-radius: 7px 7px 0px 0px; 
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T02:28:58.437

我建议您摆脱 dnd-container，只在`dragstart`事件底部显示拖放区窗格，并将其隐藏在`dragend`事件中。

`dragend`如果您将其拖放到窗格中、无法拖放的地方，或者即使您在拖动时按下了退出键，该事件也会触发。

然后在您的拖放区窗格中，处理该`drop`事件。

# wordpress - 在 Wordpress 上使用简码

> ID：14865973
> 
> 赞同：0
> 
> 时间：2013-02-14T00:44:34.993
> 
> 标签：wordpress, wordpress-theming

我最近下载了一个名为 The Gossip 的 Wordpress 主题，这个主题有一个简码功能，可以帮助您创建不同的东西，例如，让我说我想在我的侧边栏上显示来自 Gadgets 类别的最后 5 个帖子，所有我必须做，就是粘贴那个代码

```
[posts cats="gadgets" images="true" image_width="80" image_height="80" title="true" per_page="5" cols="1" image_wrap="true" pagination="false" meta="false" read_more="false" title_size="14" name='"sidebardog" content="post" content_display="excerpt" excerpt_length="0" spacing="spacing-small"] 
```

剩下的就是主题了，我的问题是，如何编写代码来显示来自当前帖子同一类别的最后 5 个帖子。我试图将**cats="gadgets"**替换为**cats="the_category();"** 或**cat=""**但它没有用。

有人对如何正确地做到这一点有任何想法吗？非常感谢您的关注，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:49:25.777

在functions.php中，您应该找到以下行：

```
add_shortcode( 'posts', 'YOUR_SHORTCODE_FUNCTION_NAME' ); 
```

那么您只需要搜索 YOUR_SHORTCODE_FUNCTION 并在其中使用全局 $post 变量获取类别

# python - Python：按姓氏排序元组并处理小写首字母

> ID：14865974
> 
> 赞同：1
> 
> 时间：2013-02-14T00:44:36.227
> 
> 标签：python

```
>>> from operator import itemgetter
>>> l = [(1.23, 'Smith'), (2.34, 'Jones'), (3.45, 'de la Smith')]
>>> ol = sorted(l, key=itemgetter(1))
>>> ol
[(2.34, 'Jones'), (1.23, 'Smith'), (3.45, 'de la Smith')] 
```

如何使用多个列表推导获得以下列表而不会产生一些混乱？

```
[(3.45, 'de la Smith'), (2.34, 'Jones'), (1.23, 'Smith')] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T00:47:49.453

您可以提供任何功能作为键。`itemgetter`仅对非常简单的情况有用

```
>>> L = [(1.23, 'Smith'), (2.34, 'Jones'), (3.45, 'de la Smith')]
>>> sorted(L, key=lambda x:x[1].lower())
[(3.45, 'de la Smith'), (2.34, 'Jones'), (1.23, 'Smith')] 
```

对于更复杂的排序，您可能希望以通常的方式编写函数

```
def item_to_sort_key(item):
    n, name = item
    return name.lower()

sorted(L, key=item_to_sort_key) 
```

把它写出来的一个好处是它更容易为不寻常的名字编写测试用例。如果您必须开始处理特殊情况，它也会很方便。

如果您的 Python 足够新，您将拥有[`str.casefold`](http://docs.python.org/dev/library/stdtypes.html#str.casefold)应该使用的 Python，而不是`str.lower`因为它正确处理 unicode

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T00:48:07.530

```
>>> l = [(1.23, 'Smith'), (2.34, 'Jones'), (3.45, 'de la Smith')]
>>> sorted(l, key=lambda tup: tup[1].lower())
[(3.45, 'de la Smith'), (2.33, 'Jones'), (1.23, 'Smith')] 
```

# r - R 包无法用 gcc 编译

> ID：14865976
> 
> 赞同：1
> 
> 时间：2013-02-14T00:44:47.900
> 
> 标签：r, gcc, gfortran, bioconductor

我下载了 bioconductor 并尝试安装一个成功安装的软件包（“limma”），但是当我尝试更新 bioconductor 时，我不断收到与无效编译器选项有关的错误。它似乎特定于 gcc，gfortran 包安装没有问题。

这是输出：

```
[xxx]$ su -c 'R'
Password: 

R version 2.15.2 (2012-10-26) -- "Trick or Treat"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> source("http://bioconductor.org/biocLite.R")
Bioconductor version 2.11 (BiocInstaller 1.8.3), ?biocLite for help
> biocLite("BiocUpgrade")
BioC_mirror: http://bioconductor.org
Using Bioconductor version 2.11 (BiocInstaller 1.8.3), R version 2.15.
Old packages: 'Biobase', 'foreign', 'IRanges', 'lattice', 'MASS', 'Matrix',
  'mvtnorm', 'nlme', 'rpart', 'survival', 'waveslim', 'wavethresh'
Update all/some/none? [a/s/n]: a
trying URL 'http://bioconductor.org/packages/2.11/bioc/src/contrib/Biobase_2.18.0.tar.gz'
Content type 'application/x-gzip' length 1913386 bytes (1.8 Mb)
opened URL
==================================================
downloaded 1.8 Mb

trying URL 'http://cran.fhcrc.org/src/contrib/foreign_0.8-52.tar.gz'
Content type 'application/x-gzip' length 318387 bytes (310 Kb)
opened URL
==================================================
downloaded 310 Kb

trying URL 'http://bioconductor.org/packages/2.11/bioc/src/contrib/IRanges_1.16.5.tar.gz'
Content type 'application/x-gzip' length 699291 bytes (682 Kb)
opened URL
==================================================
downloaded 682 Kb

trying URL 'http://cran.fhcrc.org/src/contrib/lattice_0.20-13.tar.gz'
Content type 'application/x-gzip' length 367715 bytes (359 Kb)
opened URL
==================================================
downloaded 359 Kb

trying URL 'http://cran.fhcrc.org/src/contrib/MASS_7.3-23.tar.gz'
Content type 'application/x-gzip' length 472005 bytes (460 Kb)
opened URL
==================================================
downloaded 460 Kb

trying URL 'http://cran.fhcrc.org/src/contrib/Matrix_1.0-11.tar.gz'
Content type 'application/x-gzip' length 1676392 bytes (1.6 Mb)
opened URL
==================================================
downloaded 1.6 Mb

trying URL 'http://cran.fhcrc.org/src/contrib/mvtnorm_0.9-9994.tar.gz'
Content type 'application/x-gzip' length 322279 bytes (314 Kb)
opened URL
==================================================
downloaded 314 Kb

trying URL 'http://cran.fhcrc.org/src/contrib/nlme_3.1-108.tar.gz'
Content type 'application/x-gzip' length 694594 bytes (678 Kb)
opened URL
==================================================
downloaded 678 Kb

trying URL 'http://cran.fhcrc.org/src/contrib/rpart_4.1-0.tar.gz'
Content type 'application/x-gzip' length 808365 bytes (789 Kb)
opened URL
==================================================
downloaded 789 Kb

trying URL 'http://cran.fhcrc.org/src/contrib/survival_2.37-2.tar.gz'
Content type 'application/x-gzip' length 1714302 bytes (1.6 Mb)
opened URL
==================================================
downloaded 1.6 Mb

trying URL 'http://cran.fhcrc.org/src/contrib/waveslim_1.7.1.tar.gz'
Content type 'application/x-gzip' length 703759 bytes (687 Kb)
opened URL
==================================================
downloaded 687 Kb

trying URL 'http://cran.fhcrc.org/src/contrib/wavethresh_4.6.1.tar.gz'
Content type 'application/x-gzip' length 525390 bytes (513 Kb)
opened URL
==================================================
downloaded 513 Kb

* installing *source* package ‘Biobase’ ...
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c Rinit.c -o Rinit.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
Rinit.c:1: error: bad value (generic) for -mtune= switch
make: *** [Rinit.o] Error 1
ERROR: compilation failed for package ‘Biobase’
* removing ‘/usr/lib64/R/library/Biobase’
* restoring previous ‘/usr/lib64/R/library/Biobase’
* installing *source* package ‘foreign’ ...
** package ‘foreign’ successfully unpacked and MD5 sums checked
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c R_systat.c -o R_systat.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
R_systat.c:1: error: bad value (generic) for -mtune= switch
make: *** [R_systat.o] Error 1
ERROR: compilation failed for package ‘foreign’
* removing ‘/usr/lib64/R/library/foreign’
* restoring previous ‘/usr/lib64/R/library/foreign’
* installing *source* package ‘IRanges’ ...
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c AEbufs.c -o AEbufs.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
AEbufs.c:1: error: bad value (generic) for -mtune= switch
make: *** [AEbufs.o] Error 1
ERROR: compilation failed for package ‘IRanges’
* removing ‘/usr/lib64/R/library/IRanges’
* restoring previous ‘/usr/lib64/R/library/IRanges’
* installing *source* package ‘lattice’ ...
** package ‘lattice’ successfully unpacked and MD5 sums checked
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c init.c -o init.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
init.c:1: error: bad value (generic) for -mtune= switch
make: *** [init.o] Error 1
ERROR: compilation failed for package ‘lattice’
* removing ‘/usr/lib64/R/library/lattice’
* restoring previous ‘/usr/lib64/R/library/lattice’
* installing *source* package ‘MASS’ ...
** package ‘MASS’ successfully unpacked and MD5 sums checked
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c MASS.c -o MASS.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
MASS.c:1: error: bad value (generic) for -mtune= switch
make: *** [MASS.o] Error 1
ERROR: compilation failed for package ‘MASS’
* removing ‘/usr/lib64/R/library/MASS’
* restoring previous ‘/usr/lib64/R/library/MASS’
* installing *source* package ‘mvtnorm’ ...
** package ‘mvtnorm’ successfully unpacked and MD5 sums checked
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c miwa.c -o miwa.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
miwa.c:1: error: bad value (generic) for -mtune= switch
make: *** [miwa.o] Error 1
ERROR: compilation failed for package ‘mvtnorm’
* removing ‘/usr/lib64/R/library/mvtnorm’
* restoring previous ‘/usr/lib64/R/library/mvtnorm’
* installing *source* package ‘rpart’ ...
** package ‘rpart’ successfully unpacked and MD5 sums checked
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c anova.c -o anova.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
anova.c:1: error: bad value (generic) for -mtune= switch
make: *** [anova.o] Error 1
ERROR: compilation failed for package ‘rpart’
* removing ‘/usr/lib64/R/library/rpart’
* restoring previous ‘/usr/lib64/R/library/rpart’
* installing *source* package ‘survival’ ...
** package ‘survival’ successfully unpacked and MD5 sums checked
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c agexact.c -o agexact.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
agexact.c:1: error: bad value (generic) for -mtune= switch
make: *** [agexact.o] Error 1
ERROR: compilation failed for package ‘survival’
* removing ‘/usr/lib64/R/library/survival’
* restoring previous ‘/usr/lib64/R/library/survival’
* installing *source* package ‘waveslim’ ...
** package ‘waveslim’ successfully unpacked and MD5 sums checked
** libs
gfortran -m64   -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-    protector --param=ssp-buffer-size=4  -m64 -mtune=generic -I/usr/lib64/gfortran/modules  -c     bell-p-w.f -o bell-p-w.o
bell-p-w.f:131.15:

         MAXIT=(K+3)*ROOTN                                              
               1
Warning: Possible change of value in conversion from REAL(8) to INTEGER(4) at (1)
bell-p-w.f:344.18:

      INTEGER N, I, L, K, IFAULT                                        
                  1
Warning: Unused variable 'i' declared at (1)
bell-p-w.f:345.36:

      DOUBLE PRECISION V(N), RN, STD, DSUM, DWSUM, ZERO, ONE,           
                                    1
Warning: Unused variable 'std' declared at (1)
bell-p-w.f:346.18:

     * TWO, ZFLOAT                                                      
                  1
Warning: Unused variable 'zfloat' declared at (1)
bell-p-w.f: In function ‘dpss’:
bell-p-w.f:203:0: warning: ‘sum’ may be used uninitialized in this function [-Wmaybe-    uninitialized]
bell-p-w.f:207:0: warning: ‘ssnorm’ may be used uninitialized in this function [-Wmaybe-    uninitialized]
bell-p-w.f:203:0: warning: ‘diff’ may be used uninitialized in this function     [-Wmaybe-    uninitialized]
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c dwt.c -o dwt.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
dwt.c:1: error: bad value (generic) for -mtune= switch
make: *** [dwt.o] Error 1
ERROR: compilation failed for package ‘waveslim’
* removing ‘/usr/lib64/R/library/waveslim’
* restoring previous ‘/usr/lib64/R/library/waveslim’
* installing *source* package ‘Matrix’ ...
** package ‘Matrix’ successfully unpacked and MD5 sums checked
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG -DNTIMER -I./SuiteSparse_config -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-    protector --param=ssp-buffer-size=4  -m64 -mtune=generic  -c CHMfactor.c -o CHMfactor.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
CHMfactor.c:1: error: bad value (generic) for -mtune= switch
make: *** [CHMfactor.o] Error 1
ERROR: compilation failed for package ‘Matrix’
* removing ‘/usr/lib64/R/library/Matrix’
* restoring previous ‘/usr/lib64/R/library/Matrix’
* installing *source* package ‘nlme’ ...
** package ‘nlme’ successfully unpacked and MD5 sums checked
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include   -fvisibility=hidden -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector     --param=ssp-buffer-size=4  -m64 -mtune=generic  -c corStruct.c -o corStruct.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
corStruct.c:1: error: bad value (generic) for -mtune= switch
make: *** [corStruct.o] Error 1
ERROR: compilation failed for package ‘nlme’
* removing ‘/usr/lib64/R/library/nlme’
* restoring previous ‘/usr/lib64/R/library/nlme’
* installing *source* package ‘wavethresh’ ...
** package ‘wavethresh’ successfully unpacked and MD5 sums checked
** libs
gcc -m64 -std=gnu99 -I/usr/include/R -DNDEBUG  -I/usr/local/include    -fpic  -O2 -g -pipe     -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4      -m64 -mtune=generic  -c WAVDE.c -o WAVDE.o
cc1: error: unrecognized command line option "-fstack-protector"
cc1: error: invalid parameter `ssp-buffer-size'
WAVDE.c:1: error: bad value (generic) for -mtune= switch
make: *** [WAVDE.o] Error 1
ERROR: compilation failed for package ‘wavethresh’
* removing ‘/usr/lib64/R/library/wavethresh’
* restoring previous ‘/usr/lib64/R/library/wavethresh’

The downloaded source packages are in
        ‘/tmp/RtmpKXUsRY/downloaded_packages’
Updating HTML index of packages in '.Library'

Making packages.html  ... done
There were 13 warnings (use warnings() to see them) 
```

我正在运行：Linux fedora 3.6.8-2.fc17.x86_64 gcc-4.7.2-2.fc17.x86_64 R 2.15.2 但是我在 /usr/bin 中看到的只是 gcc34，所以我不确定。我必须用 sudo 启动 R，因为除了包 data.tables 之外，它无权安装在目录中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-04-20T18:19:19.617

我在 Ubuntu 上尝试在 R 中安装 mvtnorm 时遇到了类似的问题。我收到了错误：

```
gcc: error: unrecognized command line option "-fstack-protector-strong" 
```

我查看了默认使用哪个版本的 gcc

```
which gcc
/home/ralien/anaconda3/bin/gcc 
```

事实证明，出于某种原因，Anaconda 使用了一个非常旧的 gcc、g++ 和 gfortran 编译器：版本 4.8.5。此版本似乎不支持 -fstack-protector-strong 参数。

我检查了 /usr/bin 中的 gcc、g++ 和 gfortran 版本，发现我的系统编译器要新得多，大约为 5.4。诀窍是通过创建来强制 R 使用新的编译器

```
~/.R/Makevars 
```

并将所有编译器的路径更改为系统版本。因此 Makevars 文件将包含以下条目：

```
CC=/usr/bin/gcc
CXX=/usr/bin/g++
FC=/usr/bin/gfortran
F77=/usr/bin/gfortran 
```

然后，您可以使用 R CMD INSTALL 使用新版本的 gcc、g++ 和 gfortran 编译包。

或者至少这对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T01:11:33.713

修改您的 PATH 以确保找到比 gcc 3.2 更新的 gcc 编译器。

如有必要，创建一个指向最近的链接（假设您仍想保留 gcc 3.2）：

```
mkdir $HOME/bin
ln -s /usr/bin/gcc-VERSION $HOME/bin/gcc
export PATH=$HOME/bin:$PATH
# proceed to your normal installation 
```

VERSION 表示您系统中通常使用的编译器的 gcc 版本

# php - 防止 PHP 在源代码中解释字符串中的新行

> ID：14865979
> 
> 赞同：2
> 
> 时间：2013-02-14T00:45:26.477
> 
> 标签：php, string, coding-style, string-formatting, code-formatting

我经常必须将大字符串分配给变量。在源代码中，我最好将我的行保持在 80 个字符以内。

理想情况下，我希望能够将这些文字字符串放在多行上。

我要避免的是使用连接或函数调用（例如`preg_replace()`）将多个字符串连接在一起。我不喜欢我必须调用语言特性来改进我的代码风格的想法。

我想要的例子：

```
 $text = <<<TEXT
Line 1
Line 2
Line 3
TEXT;
    echo($text); 
```

这应该输出：

```
Line1Line2Line3 
```

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:53:15.447

有几个选项：

1.  只需连接（首选）

2.  使用`array`构造

3.  采用`sprintf()`

**只需连接：**

```
echo 'long long line1'
    . 'another long line 2'
    . 'the last very long line 3'; 
```

> 效率呢？

上面的代码编译成以下操作码（这是运行的）：

```
5    0  >   CONCAT      ~0      'long+long+line1', 'another+long+line+2'
     1      CONCAT      ~1  ~0, 'the+last+very+long+line+3'
     2      ECHO        ~1 
```

如您所见，它通过连接前两行和最后一行来构建字符串；最终`~0`被丢弃。在内存方面，差异可以忽略不计。

这是单个`echo`语句的样子：

```
3    0  >   ECHO                'long+long+line1another+long+line+2the+last+very+long+line+3' 
```

从技术上讲它更快，因为没有中间步骤，但实际上你根本不会感觉到这种差异。

**使用`array`：**

```
echo join('', array(
    'line 1',
    'line 2',
    'line 3',
)); 
```

**使用`sprintf()`：**

```
echo sprintf('%s%s%s',
    'line 1',
    'line 2',
    'line 3'
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:50:42.690

```
$text = 'Line1'.
        'Line2'.
        'Line3';

var_dump($text); 
```

这样，您的代码将分成几行，但数据本身是一行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T01:16:14.480

有很多方法可以连接字符串，但问题不在于字符串的长度，也不在于您将大量标记与 php 混合使用的格式。

IMO 真的，如果您的应用程序的核心逻辑包含大量 html，那么您或许应该考虑将其移出逻辑并从外部文件加载，这样可以提高代码的可读性。

**./your_view.php**

```
<h1>This is my view, I only want small amounts of PHP here, values will be passed to me</h1>
<p><?php echo $somevar;?></p> 
```

现在在您的核心逻辑中，您可能会有一个全局函数来加载您的视图并将数据传递给它。然后您可以控制新行的删除。

**index.php（或此类逻辑文件）**

```
<?php
function load_view($path,$data,$minify=false) {
    if (file_exists($path) === false){
        return false;
    }
    extract($data);
    ob_start();
    require($path);
    $out = ob_get_contents();
    ob_end_clean();
    //you can remove all the new lines here
    if($minify===true){
        return preg_replace('/^\s+|\n|\r|\s+$/m', '', $out);
    }else{
        return $out;
    }
}

$data = array('somevar'=>'This is some data that I want to pass to a block of html');

echo load_view('./your_view.php',$data,true);
?> 
```

# python - Python 模块不会安装

> ID：14865990
> 
> 赞同：15
> 
> 时间：2013-02-14T00:46:34.190
> 
> 标签：python, setuptools, distutils

这是我的`setup.py`文件

```
#!/usr/bin/env python

from setuptools import setup
from sys import path

setup(name= 'conundrum',
    version= '0.1.0',
    author= 'elssar',
    author_email= 'elssar@altrawcode.com',
    py_modules= ['conundrum'],
    url= 'https://github.com/elssar/conundrum',
    license= 'MIT',
    description= 'A framework agnostic blog generator.',
    long_description= open(path[0]+'/README.md', 'r').read(),
    install_requires= [
        'PyYAML >= 3.0.9',
        'Markdown >= 2.2.0',
        'requests >= 1.0.4',
        ],
) 
```

我试过同时使用`setuptools`and `distutils`，但这不会安装我的模块。相反，我得到

```
file module.py (for module module) not found 
```

这是我的目录结构

```
/module
|--/test
|--README.md
|--license.txt
|--module.py
|--setup.py 
```

需要明确的是，模块是根目录。

谁能告诉我我做错了什么？

这是我尝试安装时的输出

```
elssar@elssar-laptop:/usr/local/src/conundrum$ sudo python /home/elssar/code/conundrum/setup.py install
/usr/lib/python2.6/distutils/dist.py:250: UserWarning: 'licence' distribution option is deprecated; use 'license'
  warnings.warn(msg)
running install
running bdist_egg
running egg_info
writing requirements to conundrum.egg-info/requires.txt
writing conundrum.egg-info/PKG-INFO
writing top-level names to conundrum.egg-info/top_level.txt
writing dependency_links to conundrum.egg-info/dependency_links.txt
warning: manifest_maker: standard file 'setup.py' not found
file conundrum.py (for module conundrum) not found
reading manifest file 'conundrum.egg-info/SOURCES.txt'
writing manifest file 'conundrum.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
file conundrum.py (for module conundrum) not found
file conundrum.py (for module conundrum) not found
warning: install_lib: 'build/lib.linux-x86_64-2.6' does not exist -- no Python modules to install
creating build/bdist.linux-x86_64/egg
creating build/bdist.linux-x86_64/egg/EGG-INFO
copying conundrum.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO
copying conundrum.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying conundrum.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying conundrum.egg-info/requires.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying conundrum.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
zip_safe flag not set; analyzing archive contents...
creating 'dist/conundrum-0.1.0-py2.6.egg' and adding 'build/bdist.linux-x86_64/egg' to it
removing 'build/bdist.linux-x86_64/egg' (and everything under it)
Processing conundrum-0.1.0-py2.6.egg
removing '/usr/local/lib/python2.6/dist-packages/conundrum-0.1.0-py2.6.egg' (and everything under it)
creating /usr/local/lib/python2.6/dist-packages/conundrum-0.1.0-py2.6.egg
Extracting conundrum-0.1.0-py2.6.egg to /usr/local/lib/python2.6/dist-packages
conundrum 0.1.0 is already the active version in easy-install.pth

Installed /usr/local/lib/python2.6/dist-packages/conundrum-0.1.0-py2.6.egg
Processing dependencies for conundrum==0.1.0
Searching for requests==1.0.4
Best match: requests 1.0.4
Adding requests 1.0.4 to easy-install.pth file

Using /usr/local/lib/python2.6/dist-packages
Searching for Markdown==2.2.0
Best match: Markdown 2.2.0
Processing Markdown-2.2.0-py2.6.egg
Markdown 2.2.0 is already the active version in easy-install.pth
Installing markdown_py script to /usr/local/bin

Using /usr/local/lib/python2.6/dist-packages/Markdown-2.2.0-py2.6.egg
Searching for PyYAML==3.10
Best match: PyYAML 3.10
Adding PyYAML 3.10 to easy-install.pth file

Using /usr/local/lib/python2.6/dist-packages
Finished processing dependencies for conundrum==0.1.0 
```

为了确保我的系统没有问题，我从 github 下载了两个类似的软件包`setup.py`并安装了它们。安装没有任何问题。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-14T03:26:26.610

我无法`setup.py`从其他目录运行。它需要从它所在的目录运行。这就是这里的问题。

固定的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T01:10:20.813

如果我理解您的布局，问题是您使用的是默认值`package_dir`，这意味着顶级模块`module`需要位于根目录中 as `module.py`，而不是 as `module/module.py`。

所以，添加这个：

```
package_dir = {'': 'module'} 
```

现在，它会寻找`module`as `module/module.py`。

（PS，如果您的模块或其子目录或理想情况下两者都被称为“模块”以外的其他名称，那么讨论这一切都会变得不那么混乱。此外，如果您使用更标准的格式来绘制目录树。）

这在[列出整个包](http://docs.python.org/2/distutils/setupscript.html#listing-whole-packages)中进行了解释。（我意识到您列出的是单个模块，而不是整个包，但该部分的文档只是说“再次，您可以使用 package_dir 选项覆盖包/目录对应关系”，参考我链接的部分。和[参考](http://docs.python.org/2/distutils/apiref.html?highlight=package_dir)for`package_dir`的帮助更小；它只是说“包到目录名称的映射”。）

# .net - .net 的布局引擎，支持 html5 等

> ID：14865997
> 
> 赞同：0
> 
> 时间：2013-02-14T00:47:11.277
> 
> 标签：.net, layout, browser, webkit, geckofx

我正在寻找最新的布局引擎，例如 geckofx 或 webkit.net！我命名的两个已经过时了很长时间！是否有任何替代甚至更新命名的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:15:12.740

> 我命名的两个已经过时了很长时间！

好消息。GeckoFX 在这里活得很好：[https](https://bitbucket.org/geckofx/) ://bitbucket.org/geckofx/ 。请注意，每个新版本的 Firefox 都会导致一个新的 GeckoFX 分支，因此您必须决定要使用哪个版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-16T01:36:19.713

还要记住 HTML5 还没有正式设计——没有浏览器是 100% 兼容的，因为没有人完全同意 HTML5 的属性。

# c++ - g++ 不编译我的源代码。也许一些模板错误？

> ID：14865998
> 
> 赞同：0
> 
> 时间：2013-02-14T00:47:23.057
> 
> 标签：c++

我有这个模板类：

```
#include <utility>
#include <boost/locale.hpp>
#include <boost/range/iterator.hpp>
#include <boost/range/iterator_range.hpp>
#include <boost/range/algorithm_ext/insert.hpp>
#include <boost/icl/interval_set.hpp>
#include <boost/container/flat_set.hpp>
#include <boost/container/list.hpp>
#include <boost/container/vector.hpp>
#include <boost/container/string.hpp>
#include <boost/foreach.hpp>

template<typename IntType>
class IntervalSet {
private:
    boost::icl::interval_set<IntType> impl;
    bool readonly;

    bool doIchangeReadOnly() {
        if(readonly){
            // ERROR MESSAGE
        }

        return false;
    }
public:
    IntervalSet(const boost::icl::interval_set<IntType> &c) : impl(c), readonly(false) {}
    IntervalSet(){}

    static const IntervalSet EMPTY_SET;

    static IntervalSet of(IntType a) {
        IntervalSet r;
        r.add(a);
        return r;
    }

    // Create a set with all ints within range [a..b] (inclusive)
    static IntervalSet of(IntType a, IntType b) {
        IntervalSet r;
        r.add(a, b);
        return r;
    }

    // Add element el to the set.
    void add(IntType el) {
        if(doIchangeReadOnly()) return;

        impl += el;
    }

    // Add interval; i.e., add all integers from a to b to set.
    //  If b<a, do nothing.
    //  Keep list in sorted order (by left range value).
    //  If overlap, combine ranges.  For example,
    //  If this is {1..5, 10..20}, adding 6..7 yields
    //  {1..5, 6..7, 10..20}.  Adding 4..8 yields {1..8, 10..20}.
    void add(IntType a, IntType b) {
        if(doIchangeReadOnly() || b<a) return;

        impl.add(boost::icl::interval<int>::type(a, b));
    }

    const boost::icl::interval_set<IntType>& data() const{
        return impl;
    }

    void clear() {
        if(doIchangeReadOnly()) return;

        impl.clear();
    }

    // Remove element el from the set.
    void remove(IntType el) {
        if(doIchangeReadOnly()) return;

        impl -= el;
    }

    // Add all elements from incoming set to this set.
    // Return "this" so we can chain calls.
    IntervalSet<IntType>& addAll(const IntervalSet<IntType> &set) {
        if(doIchangeReadOnly()) return *this;

        impl += set.impl;
        return *this;
    }

    // Return the intersection of this set with the argument, creating a new set.
    IntervalSet<IntType> and(IntervalSet<IntType> a) const {
        a.impl &= impl;
        return a;
    }
};

template<typename IntType>
const IntervalSet<IntType> IntervalSet<IntType>::EMPTY_SET = IntervalSet<IntType<(); 
```

当我删除最后一个方法定义（`IntervalSet<IntType>`和`(IntervalSet<IntType> a) const`）时，g++ 只编译我的源代码。

我的问题：我到底做错了什么？

来自 g++ 的错误消息：

```
 \m.cpp     137     error: expected ')' before 'a'
 \m.cpp     137     error: 'a' does not name a type 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:49:36.807

至少一个错误是：

```
IntervalSet<IntType<();
                   ^^? 
```

应该：

```
 IntervalSet<IntType>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T08:00:59.497

现在我知道了错误：

该代码无法编译，因为 and 被 gcc 视为关键字：

改变

```
IntervalSet<IntType> and(IntervalSet<IntType> a) const { 
```

至

```
IntervalSet<IntType> AND(IntervalSet<IntType> a) const 
```

它工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T01:05:26.127

It looks like you are defining a template function in a cpp file.

Template functions must be defined and implemented in header files. There are several questions concerning this on Stack Overflow, e.g. [Why can templates only be implemented in the header file?](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file)

# ios - Instruments 自动化工具：脚本在未明确关闭此测试的情况下结束

> ID：14865999
> 
> 赞同：1
> 
> 时间：2013-02-14T00:47:23.047
> 
> 标签：ios, instruments, ios-ui-automation, xcode-instruments

我今天正在使用 Instruments 中的自动化工具，但在编写工作测试时遇到了问题。以下示例将退出`Issue: Script ended without explicting closing this test`。是的，该消息确实说*显式*。我认为这是最近版本的 Xcode 中引入的一个错字。这是我第一次尝试使用这个工具。设置`cellCount`为 6 会导致通过，但任何东西都会给我“脚本结束”消息。我做错了还是自动化工具有错误。

```
UIALogger.logStart("Start Simple Test");
var target = UIATarget.localTarget();
var cellCount = 7;

UIALogger.logMessage("cell count: " + cellCount);

if (cellCount != 6) {
    UIALogger.logFail("Failed");
}

UIALogger.logPass("Passed"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T02:01:33.397

我认为发生的事情是您错误地关闭了日志组。当您说 时`logStart()`，您在仪器中开始了一个日志组，之后您使用`logMessage()`或`logError()`将包含在该组中的所有内容都包含在该组中。

您关闭了与您尝试执行的任何一个`logFail()`或`logPass()`其中一个的组，但您只能调用其中一个或另一个。你需要一个 else 子句来这样调用`logPass()`：

```
if (cellCount != 6) {
    UIALogger.logFail("Failed");
} else {
    UIALogger.logPass("Passed");
} 
```

奇怪的是，当我将您的代码片段粘贴到 UI 自动化中时，我没有收到您提到的问题错误。它只是将两个日志组打印到跟踪日志中。尝试使用我上面提到的 else 子句，看看它是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-14T06:19:53.550

我在这里发现了真正的问题。这基本上是说您的应用程序不处于可用模式，无法在指定点进行进一步测试。所以请在这个地方通过/失败或添加适当的延迟。

因此，避免这种情况的最简单解决方案是在每个页面导航后设置一个 2 秒的延迟功能。在 pano 上获取和显示数据后，这将在每个页面中加载数据。脚本将顺利运行。

//Step:1 导航/点击

```
UIATarget.localTarget().delay(2); 
```

//确认

//步骤：2 导航/点击

```
UIATarget.localTarget().delay(2); 
```

//确认

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T22:44:30.747

多么奇怪。我遇到了与上述完全相同的问题，并且我也在使用该`else`子句。

另外，我尝试了上面提到的双重记录方法，就在我`if`记录通过或失败的语句之前：

```
UIALogger.logMessage("My Story Title: " + titleDisplayed);
UIALogger.logMessage("Innocuous Message."); 
```

并得到了一个失败，这很好——我想要除了“ `Issue`”结果和“ `script ended without expliciting`”消息之外的任何东西。因此，我随后评论`//`了第二`logMessage`条语句并重新运行了测试，这次又得到了“ `Issue`”和“ `script ended without explicating`”。

因此，他的上述提示已被验证为真实。

我正在运行 Xcode 和 Instruments 版本 4.6，而 iPhone Emulator 作为 6.1 项目运行。

- -更新 -

无论我做什么，我都无法通过/失败正常工作。在一次运行`Issue: Script ended without explicating`中，我在日志中收到了令人愤怒的“”消息，然后如果我对脚本进行任何更改——即使只是添加一个额外的空格，并保存它然后再次运行——我会得到一个良好的通过或失败结果。

但是，如果我随后立即再次运行测试而不进行任何更改，我将收到“ `Issue: Script ended without explicating`”消息，并且在我对脚本进行无意义的更改并保存然后再次运行之前，这不会消失，然后可能此时我可能会得到一个不错的通过/失败结果（并不总是发生），但如果我再次运行脚本，我会再次得到“ `Issue: Script ended without explicating`”。

有没有搞错？我实际上已经花时间重新安装 Xcode 4.6，但没有运气改变行为。我深感沮丧。这似乎是仪器中的一个错误。有没有办法向苹果报告这个？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-10T14:26:50.257

我也有这个问题。您还必须在 logPass 或 logFail 方法中将您放在 logStart 方法中的字符串 - 仅此而已！例如，这意味着：

```
UIALogger.logStart("Add to Whishlist");
//here comes your automation code
UIALogger.logPass("Add to Whishlist"); 
```

您可以使用打开另一个测试并使用方法`logStart()`关闭它`logPass()`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-28T13:35:15.947

我发现，如果您在不同消息之间放置延迟，它们实际上会显示并评估问题。我开始的问题是，两个连续的 logMessage 没有正确显示（最后一个被删除）

```
UIALogger.logMessage("This is some text");
UIALogger.logMessage("This is some text");
//UIATarget.localTarget().delay(1); 
```

只显示了一条输出线。取消注释显示两个......这似乎有点......不一致 - 还有更多：（这属于 Wulf）

```
UIALogger.logStart("Add to Whishlist");
UIALogger.logMessage("My Story Title: ");
//UIATarget.localTarget().delay(1);
UIALogger.logMessage("Innocuous Message.");
//UIATarget.localTarget().delay(1);
if (true)
    UIALogger.logPass("Add to Whishlist");
else
    UIALogger.logFail("Add to Whishlist"); 
```

在这里，我遇到了一个“*问题*”。取消注释有助于解决这个问题。我知道，这不是解决办法。但它对我来说是一种解决方法。

logStart、logFail 或 logPass 中的“字符串”实际上对我来说并不重要。