# StackOverflow 问答 12847000-12847999

# sql - 得到一个返回与类别和子类别相关的项目的查询？

> ID：12847000
> 
> 赞同：1
> 
> 时间：2012-10-11T19:23:12.507
> 
> 标签：sql, relational-database, left-join, relation

我想得到一个查询，它返回属于一个类别和子类别的所有项目。

这是设置：

```
CREATE TABLE [dbo].[CategoriasProductos](
    [IdCategoria] [int] IDENTITY(1,1) NOT NULL,
    [IdGrupo] [int] NULL,
    [Nombre] [varchar](50) NULL,
    [Estado] [varchar](20) NULL,
    [Descripcion] [text] NULL,
    [IdCategoriaPadre] [int] NULL,
    [Nivel] [nchar](10) NULL,
 CONSTRAINT [PK_CategoriasProductos] PRIMARY KEY CLUSTERED 
(
    [IdCategoria] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

CREATE TABLE [dbo].[Productos](
    [IdProducto] [int] IDENTITY(1,1) NOT NULL,
    [IdGrupo] [int] NULL,
    [IdCategoria] [int] NULL,
    [IdAlmacen] [varchar](50) NULL,
    [Codigo] [varchar](50) NULL,
    [Nombre] [varchar](50) NULL,
    [Descripcion] [varchar](max) NULL,
    [Cantidad] [int] NULL,
    [Imagen] [varchar](max) NULL,
    [StockMin] [int] NULL,
    [StockMax] [int] NULL,
    [Ancho] [varchar](50) NULL,
    [Alto] [varchar](50) NULL,
    [Largo] [varchar](50) NULL,
    [Peso] [varchar](50) NULL,
    [Volumen] [varchar](50) NULL,
    [Color] [varchar](50) NULL,
    [Material] [varchar](50) NULL,
    [Presentacion] [varchar](50) NULL,
    [bitPrecioVentaUnico] [int] NULL,
    [PrecioCompra] [money] NULL,
    [DescuentoCompra] [float] NULL,
    [PrecioVenta] [money] NULL,
    [DescuentoVenta] [float] NULL,
    [Estado] [varchar](20) NULL,
 CONSTRAINT [PK_Productos] PRIMARY KEY CLUSTERED 
(
    [IdProducto] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

现在添加一些数据（至少仅针对类别）

```
SET IDENTITY_INSERT [dbo].[CategoriasProductos] ON
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (1, 1, N'0')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (2, 1, N'1')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (3, 1, N'1')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (4, 2, N'2')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (5, 2, N'2')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (6, 4, N'3')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (7, 4, N'3')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (10, 5, N'3')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (11, 5, N'3')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (14, 3, N'2')
INSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (15, 3, N'2')
SET IDENTITY_INSERT [dbo].[CategoriasProductos] OFF 
```

（我只插入了我知道查询将需要或可能需要的数据。此外，我的原始数据库中有更多行，但插入的行更少，只是为了不再使这变得复杂）

现在，我暂时尝试了这个查询：

```
SELECT Productos.Codigo, Productos.Nombre, Productos.Descripcion, A.Nombre AS Categoria
FROM Productos LEFT OUTER JOIN
CategoriasProductos AS A ON Productos.IdCategoria = A.IdCategoria LEFT OUTER JOIN
CategoriasProductos AS B ON B.IdCategoriaPadre = A.IdCategoria LEFT OUTER JOIN
CategoriasProductos AS C ON C.IdCategoriaPadre = B.IdCategoria LEFT OUTER JOIN
CategoriasProductos AS D ON D.IdCategoriaPadre = C.IdCategoria
WHERE (A.IdCategoria = 1) 
```

还有一张我如何构建查询的图片：http: [//imageshack.us/a/img841/7029/pruebau.jpg](http://imageshack.us/a/img841/7029/pruebau.jpg)

现在......在查询中，它指出如果 A.IdCategoria = 1，（在这种情况下）它应该显示其 IdCategoria 等于 1 或等于以某种方式链接到 IdCategoria 1 的所有产品（在 Categoria桌子）。

另一个示例是，如果我改为键入 WHERE B.IdCategoria = 2... 那么它应该只显示 IdCategoria 为 2、4、5、6、7、10 或 11 的产品。

我尝试使用此查询，但没有成功。也许我没有以正确的方式使用连接......

我想知道是否有人可以告诉我我在这里做错了什么，或者我必须添加到查询中以使其工作......

我希望你能帮助我提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T11:57:03.250

`LEFT OUTER JOIN`不会为您的结果集带来*额外的行。*这将允许您引入*额外的列*。

你所拥有的是分层类别。SO和DBA.SE上有很多关于如何处理分层类别的问题。SQL 不擅长处理层次结构，因此人们经常使用[访问数字](https://stackoverflow.com/search?q=user:659653%20visitation%20numbers)等技巧（另请参见[嵌套集](http://en.wikipedia.org/wiki/Nested_set_model)）。我已经多次使用这种技术并取得了巨大的成功。

这里有一个关于 SO 的[wiki](https://stackoverflow.com/questions/4048151/what-are-the-options-for-storing-hierarchical-data-in-a-relational-database)，它提供了一组非常好的链接，指向人们用来处理分层数据的许多其他方法的文章。请记住，每一项都涉及某种形式的妥协。你只需要选择一个在你的情况下最有利的权衡。

# jsf - JSF 自定义复合组件与自定义经典组件有什么区别

> ID：12847003
> 
> 赞同：5
> 
> 时间：2012-10-11T19:23:24.857
> 
> 标签：jsf, jakarta-ee, jsf-2, custom-component, composite-component

我想构建一个自定义 JSF 组件。现在我从 oracle 阅读了一些文档并看到了一些代码示例。问题是我有点困惑：

似乎有两种方法可以使用 JSF 2.0+ 构建自定义组件。据我了解，自 JSF 2.0 以来，我可以使用这些复合组件来构建我自己的组件。

但是与“经典”组件相比，它们有什么缺点吗？

当我使用 Compisite Components 时，我的组件会相当复杂，我是否会丢失任何东西（除了向下兼容性）？

例如，我的组件将在 java 中有一些工作要做，复合组件可以做到这一点吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-12T01:45:36.563

如果您想通过纯 XML 方式将一堆密切相关*的现有*标签/组件/HTML 表示为单个且可重用的组件，则复合组件非常有用。

当**没有**可用的标准 JSF 标记/组件来实现需求时，自定义组件将是唯一的方法。例如`<input type="file">`，`<input type="range">`等。请注意，这样的自定义组件可以在需要的时候依次用于组合中。

完全有道理，对吧？

您可以创建一个所谓的“支持组件”类扩展`UINamingContainer`（或至少实现`NamingContainer`）并将其绑定到组合`<cc:interface componentType>`。[您可以在我的答案中找到几个示例](https://stackoverflow.com/search?tab=votes&q=user%3a157882%20%5bcomposite-component%5d%20componenttype)。

但是请注意，有时复合组件不适合，您需要创建一个标记文件。例如，当您想要一个自定义且可重复使用的`<h:column>`.

### 也可以看看：

*   [何时使用 <ui:include>、标记文件、复合组件和/或自定义组件？](https://stackoverflow.com/questions/6822000/when-to-use-uiinclude-tag-files-composite-components-and-or-custom-componen)

# asp.net - 在 IIS 6 上托管 WCF REST 服务，该服务还将 webHttpRelayBinding 公开给服务总线

> ID：12847005
> 
> 赞同：0
> 
> 时间：2012-10-11T19:23:35.120
> 
> 标签：asp.net, wcf, rest, azure, servicebus

我有一个 WCF REST 服务，它通过 webHttpRelayBinding 和 Azure 服务总线在“本地”和云中公开。

这在我的 IIS 7.5 Express 实例上非常有效，但是当我将它部署到 Windows Server 2003 / IIS 6 环境时，我开始收到以下错误：

> 该服务无法激活，因为它不支持 ASP.NET 兼容性。为此应用程序启用了 ASP.NET 兼容性。在 web.config 中关闭 ASP.NET 兼容模式，或将 AspNetCompatibilityRequirements 属性添加到服务类型，并将 RequirementsMode 设置为“允许”或“必需”。

我读过我需要完全删除对 ASP.NET 的任何依赖项才能解决此问题（请参阅[此处](http://blogs.msdn.com/b/avkashchauhan/archive/2011/11/17/wcf-rest-http-application-connecting-azure-service-bus-using-webhttprelaybinding-causes-aspnetcompatibilityenabled-error.aspx)）。我已经重构了我的代码，以便包含服务定义的程序集没有对 System.Web 的任何引用，但我仍然收到错误消息。

所以我认为这意味着我根本无法在 IIS 中托管服务。如果是这种情况，我唯一的选择是让 Windows 服务进行托管吗？WAS 在 Win2k3 上不可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:16:05.300

您是否尝试从 web.config 中的 serviceHostingEnvironment 元素中删除 aspNetCompatibilityEnabled 属性？

WAS 本身在 Win2k3 上可用（这就是 webhosted WCF 服务的工作方式），但 IIS 的应用程序池和激活模型与较新版本的稍有不同。

# javascript - 在 html5 中创建用于单击图像的鼠标事件

> ID：12847010
> 
> 赞同：1
> 
> 时间：2012-10-11T19:23:54.940
> 
> 标签：javascript, html5-canvas, dom-events

我是 Javascript 新手，我在 Dreamweaver 编辑器中使用 HTML5 画布。我看过其他关于鼠标事件的帖子，但似乎没有一个能解决我的问题。

我正在创建一个名为“仅单击玉米气泡”的游戏，其中物品掉落并且玩家移动鼠标以单击玉米气泡，但如果他们单击其他任何内容，则游戏结束。

到目前为止，我使用过：

```
window.addEventListener("keydown",eventKeyDown,false);  
window.addEventListener("keyup",eventKeyUp,false);  
window.addEventListener("mousedown",onDown,false);  
window.addEventListener("mouseup",onUp,false);  
window.addEventListener("mousemove",onMove,false); 
```

我如何称呼这些，以便它们是真实的？另外，如何使它们可点击，以便在图像掉落时可以单击它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:46:34.447

可能这会有帮助。

```
 document.addEventListener('click',mouseClick,false);
 function mouseClick(e)
 {  
   mouseX = e.pageX - canvas.offsetLeft;
   mouseY = e.pageY - canvas.offsetTop;
   //Now mouseX and mouseY contains the x and y location of mouse click event but w.r.t. your canvas location .
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:13:11.293

首先，我们需要以某种方式找到鼠标光标所在的位置。这是一个获取鼠标坐标的函数：

```
function getMousePosition(e) {
    var x, y;        

    x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft - canvas.offsetLeft;
    y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop - canvas.offsetTop;

    return {
        get x() { return x },
        get y() { return y }
    }
}

HTMLCanvasElement.prototype.getMousePosition = getMousePosition; 
```

然后我们需要测试鼠标是否被点击，如果是，定位鼠标和图像坐标。如果鼠标坐标与图像坐标重叠，则执行某些操作。我们可以通过以下方法测试条件：

```
var isMouseDown = false;
function onDown(e) {
    var pos = {x:0, y:0 };
    isMouseDown = true;
    var mouseCoordinate = getMousePosition(e);
    for (var i = 0; i < images.length; i++) {
        var bubble = images[i];
        if (( mouseCoordinate.x > image.x && // get the image most left position 
            mouseCoordinate.x < image.x + image.size) && // get image most right position
            ( mouseCoordinate.y > image.y &&
                mouseCoordinate.y < image.y + image.size)) {
            index = image.indexOf(image, 0);
            pos.x = mouseCoordinate.x;
            pos.y = mouseCoordinate.y;
            break;
        }
    }
}

if (isMouseDown &&
    pos.x < image[index].x + image[index].size &&
    pos.x > image[index].x &&
    pos.y < image[index].y + image[index].size &&
    pos.y > image[index].y)
// if the condition is true, then do something        

function onUp(e) {
    isMouseDown = false;
} 
```

您可以在此处查看实时示例：http: [//hellopixel.net/experiments/404/404.html](http://hellopixel.net/experiments/404/404.html)

# ios - iOS 中从包复制到缓存文件夹的文件具有编译的 CreationDate 和 ModifiedDate

> ID：12847015
> 
> 赞同：3
> 
> 时间：2012-10-11T19:24:09.507
> 
> 标签：ios, copy, nsdate, nsfilemanager

我猜我的问题可能是设计使然，但我希望有一个解决方法。

我的应用程序基本上是一个文档阅读器。一堆 PDF 文件在编译时被拉入并与应用程序捆绑在一起。当应用程序第一次运行时，它们被复制过来（供用户添加注释等等），我为 UITableView 生成一个字典（使用 PDF 元数据填充标题等内容）。当应用程序的新版本发布时，我希望在升级过程中更聪明地复制文件。目前我能做的最好的事情就是清除所有内容并重新复制。

问题是，当 Xcode 在编译时将文件复制到包中时， NSFileCreationDate 和 NSFileModificationDate 似乎都重置为编译应用程序时。这基本上使整个日期检查无用。

```
2012-10-11 15:19:29.254 handouts[5131:707] File attributes of source: {
NSFileCreationDate = "2012-10-11 19:19:10 +0000";
NSFileExtensionHidden = 0;
NSFileGroupOwnerAccountID = 501;
NSFileGroupOwnerAccountName = mobile;
NSFileModificationDate = "2012-10-11 19:19:10 +0000";
NSFileOwnerAccountID = 501;
NSFileOwnerAccountName = mobile;
NSFilePosixPermissions = 420;
NSFileProtectionKey = NSFileProtectionNone;
NSFileReferenceCount = 1;
NSFileSize = 466028;
NSFileSystemFileNumber = 2754117;
NSFileSystemNumber = 234881027;
NSFileType = NSFileTypeRegular; 
```

}

我目前正计划同时使用文件大小和日期，但我想象它会变得非常混乱，非常快。而且我必须自己跟踪一堆元数据。难道我做错了什么？有没有办法让 Xcode 尊重它正在复制的文件的时间戳？

我想在深入`if...then`我可能要写的代码汤之前先检查一下。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:27:41.117

AFAIK 没有办法让 XCode 保留日期。我遇到了类似的问题，并想出了一个 shell 脚本来制作一个 plist 文件，其中包含目录中文件的修改日期（递归）。然后我将它包含在我的包中，并在我复制文件以设置修改日期时阅读它。您可以修改它以处理创建或访问日期或与某些工作相结合。

这是 bash 脚本：（我还是 bash 的新手，所以欢迎任何关于如何使它更好的评论）

```
#!/bin/bash
#First parameter is the folder to recurse into, defaults to current directory
#Second parameter is the full path to a pList file without the extension, defaults to
#<CURRENT DIRECTORY>/fileInfo
#if you don't specify /'s in the parameter it will be treated as a domain instead and
#the pList will be elsewhere...

pinfoLoc=${2:-`pwd`/fileInfo}

#Useful for debugging
#echo Source: ${1:-.}
#echo Destination: $pinfoLoc

for i in ${1:-.}/*; do

  #Format: %Sa = last access, %Sm = last modified, %Sc = created
  date=`stat -f "%Sm" $i`

  #Uncomment below to see each file and date used
  #echo $i - $date

  #Write the data to the pList
  defaults write $pinfoLoc "$i" -date "$date" 

  #Recurse into directories, not sure if there's a better way to do this
  if [ -d "$i" ]; then
    bash $0 $i $pinfoLoc
  fi
done 
```

基本上我有一个名为“assets”的文件夹，它位于项目之外并链接到它，XCode 会为我将该文件夹复制到包中。这是我从捆绑包中复制每个文件*后*更新每个文件的修改日期的代码。

```
//Update file properties
NSString *file, *dstPath, *srcPath;
NSDictionary *fAttribs;
NSData *fInfoData = [fm contentsAtPath:[[NSBundle mainBundle] pathForResource:@"fileInfo" ofType:@"plist"]];
NSPropertyListFormat format;
NSDictionary *fileInfo = (NSDictionary *)[NSPropertyListSerialization
                                          propertyListWithData:fInfoData
                                          options:NSPropertyListMutableContainersAndLeaves
                                          format:&format
                                          error:&error];
NSString * resPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"assets"];
NSDirectoryEnumerator *dirEnum = [fm enumeratorAtPath:resPath];
while (file = [dirEnum nextObject])
{
    NSLog(@"Directory Enum File: %@", file);
    dstPath = [NSString pathWithComponents:@[[appInfo appSupportPath], @"res", file ]];
    srcPath = [@"assets" stringByAppendingPathComponent:file];
    fAttribs = @{ NSFileModificationDate: [fileInfo valueForKey:srcPath]};
    [fm setAttributes:fAttribs ofItemAtPath:dstPath error:&error];
    if (error)
    {
        NSLog(@"Error setting attribute to file: %@ - %@", file, error.localizedDescription);
        [error release];
        error = nil;
    }
} 
```

这是在我的复制文件方法之后，有一些你看不到的变量。即`fm`只是来自的默认管理器`NSFileManager`，`error`是一个未初始化的`NSError`，`[appInfo appSupportPath]`是一个静态方法，它返回我在设备上存储东西的目录（因为你不能修改捆绑包）。

此外，我已经硬编码了保存日期的 plist 的位置，以及我将文件复制到的目录，我稍后可能会在我的代码中更新它。

我做的下一件事是设置 XCode 以自动运行我的脚本并包含 fileInfo.plist。后者很容易，一旦你运行了脚本，你可以将它拖放到 Xcode 中并作为参考，棘手的部分是让它在每次构建时运行脚本。

1.  将上面的 bash 脚本复制/粘贴到文件中
2.  在项目导航器中单击您的项目
3.  如果尚未选择，请在 Targets 下选择您的目标（应用程序名称）
4.  单击构建阶段选项卡
5.  在右下角单击 Add Build Phase -> Add Run Script
6.  新阶段将是最后一件事，不幸的是，**在**它将文件复制到包之后，包括我们正在生成的那个。因此，将阶段拖动到“复制捆绑资源”上方
7.  对于我放置 /bin/bash 的 shell，/bin/sh 也可以工作......
8.  在下面的行中，我把这个：

    ```
    pushd $PROJECT_DIR/..
    /PATH/TO/BASH/FILE/ABOVE.sh assets
    popd 
    ```

    这`pushd $PROJECT_DIR/..`是需要的，因为资产目录比我的项目高一级，我可以硬编码要转到的目录，并且可能会更清楚。

9.  如果您现在尝试构建，您可能会收到权限错误，因为脚本文件没有执行权限。我不知道在 Mac 上设置这个比打开终端并运行更简单的方法`chmod +x <BASH FILE NAME>`是的，我意识到这允许每个人执行它，如果你担心它然后玩权限，我不确定如果 XCode 构建为不同的用户或什么。

希望至少其中一些有所帮助。我使用这个修改后的日期来查看 Web 服务器上是否有更新的文件，然后只下载我需要的文件。

# android - 在适用于 Android 的 Titanium Mobile 上获取 AudioPlayer 状态

> ID：12847021
> 
> 赞同：0
> 
> 时间：2012-10-11T19:24:50.840
> 
> 标签：android, titanium, appcelerator, titanium-mobile, appcelerator-mobile

我正在为 android 开发的广播流媒体应用程序遇到了一些麻烦。除了这一点之外，应用程序中的所有内容都运行良好，因此非常令人沮丧。

我希望能够捕获 AudioPlayer 的当前播放状态，以便我的应用程序可以在发生缓冲/网络更改时采取行动。

例如，今天我的连接从 3G 更改为 Wi-Fi，导致播放器停止死机，然后卡住。有时它会停止一两秒钟然后继续 OK。

我在事件侦听器中添加了一些代码以进行如下更改，以尝试捕获它：

```
player.addEventListener('change',function(e){

    if(e.state == player.STATE_WAITING_FOR_DATA){
            lblStatus.text = 'Reconnecting in 10s';
        setTimeout(reconnect,10000); // This fires a reconnect function further down in my code.
    }

}); 
```

但是，更改事件根本不会被触发。这几乎就像等待数据流的过程导致更改事件不触发一样。

所以我认为另一种方法是设置一个间隔，每 1 秒调用一次流检查函数，就像这样。

```
setInterval(checkStream,1000);

function checkStream(){
    if(player.state == player.STATE_WAITING_FOR_DATA){
        // Add reconnect code here
    }
} 
```

这也不起作用。当我添加一个调试警报以显示它的值`player.state`一直为空时，即使在播放时也是如此。在 Titanium Studio IDE 中，它说这个属性在 android 上不可用。但是在网站上的 API 文档中它说它们是。我相信IDE。

作为最后的手段，我决定捕获 Ti.Network 的更改事件，并在检测到连接重新联机后运行重新连接代码。但是，有时这不是必需的，并且在实际不需要时断开并重新连接流。

有没有其他方法可以捕获 AudioPlayer 的状态，或者只是坚持网络更改事件是解决这个问题的唯一方法？

提前致谢，

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:33:40.187

由于我使用 AudioPlayer 功能来滚动我自己的播放列表，因此检测曲目何时完成非常重要，以便我可以请求下一个曲目。Android 和 iOS 都会引发这些事件，[但实际的 STATE 在 Android (3.0 SDK) 上不可用](http://docs.appcelerator.com/titanium/3.0/#!/api/Titanium.Media.AudioPlayer-property-state)。在 Android 上不是一个非常有用的事件。这是我的选择：

```
var nextTrackIfEnd = function() { 

    if (Ti.Platform.name === 'android')
    {
        $.debug.text = "isPlaying: " + audioPlayer.isPlaying();
        if(!audioPlayer.isPlaying() && hasStarted)
        {
            nextTrack();
        }
    }
    else
    {
        $.debug.text = "state: " + audioPlayer.state;
        if(audioPlayer.state == 0)
        {
            nextTrack();
        }
    }
};
setInterval(nextTrackIfEnd, 500); 
```

# spring - 如何使用弹簧集成在电子邮件正文中附加文件

> ID：12847022
> 
> 赞同：2
> 
> 时间：2012-10-11T19:24:51.947
> 
> 标签：spring, email, integration, jakarta-mail

我有一种情况，我需要在电子邮件正文中而不是在标题中附加文件。例如，在 Microsoft Outlook 中，如果消息类型设置为富文本，则可以将文件作为附件拖放到电子邮件正文中。我如何使用 Spring Integration MessageBuilder 做到这一点？到目前为止，这是我用来发送附件，但文件附件在标题而不是正文中的电子邮件。

```
Message<?> msg = MessageBuilder.withPayload("")
.setHeader(MailHeaders.SUBJECT, subject )
.setHeader(MailHeaders.ATTACHMENT_FILENAME, args[0].toString())
.build(); 
```

如果有人给我代码示例会很有帮助！提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T04:58:51.237

您的代码显示您忽略了消息本身的关键部分，即`payload`

1.  将您的出站消息适配器与`JavaMailSender`（您可能已经拥有）
2.  `MimeMessage`使用`org.springframework.mail.javamail.JavaMailSender`你连线的 and构造一个正则`org.springframework.mail.javamail.MimeMessageHelper`，如

    ```
     public void sendEmail(){
     MimeMessage message = mailSender.createMimeMessage(); //mailSender is an instance of             JavaMailSender from 1.
    try{
    MimeMessageHelper helper = new MimeMessageHelper(message,true);
    //set the fields
    helper.setFrom("J'onn Doe");
    helper.setTo("SpamRecce");
    helper.setSubject("")
    helper.setText("Text goes here")
    //load attachment file using spring's help. Basic interface is called a Resource and there       are many implementations. Here, I've used the ClassPathResource which means your attachment file must be in your classpath
    ClassPathResource theAttachment = new ClassPathResource("My File.Doc");
    helper.addAttachment("Add the desired filename here.doc",theAttachment);
        }
    catch(MessagingException me){
    Logger.getAnonymousLogger.info("Something bad happened!);
    me.printStacktrace();
         }
    mailSender.send(message);
     } 
    ```

我不知道您的实施细节，但我相信发送电子邮件的端点应该是终止端点，即可以直接从该端点发送电子邮件，您不需要发送到另一个通道。

但是，如果您仍然需要将消息刷新到另一个通道，则需要重写您要阅读的代码：

```
 Message<MimeMessage> msg = MessageBuilder.withPayload(message)
          .setHeader(MailHeaders.SUBJECT, subject )
          .setHeader(MailHeaders.ATTACHMENT_FILENAME, args[0].toString())
          .build(); 
```

# java - Seat Reservation 二维数组

> ID：12847024
> 
> 赞同：0
> 
> 时间：2012-10-11T19:24:54.147
> 
> 标签：java, multidimensional-array

我正在做一个用于维度数组的简单座位预订。程序应要求用户输入座位号并将**保留**的座位号替换为0，并且不允许用户保留先前保留的座位，并应显示“座位已被占用”。我有二维数组表（感谢其他帮助我解决这个问题的 stackoverflow 成员），现在我不知道如何将座位号更改为 0。你们能给我一些想法如何解决这个问题。谢谢！

这是我的代码：

```
package newtable;

import java.io.*;

public class Newtable {

    public static void printRow(int[] row) {
        for (int i : row) {
            System.out.print(i);
            System.out.print("\t");
        }
        System.out.println();
    }

    public static void main(String[] args) throws Exception {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        int twoDm[][] = new int[5][7];
        int i, j, k = 1;
        int ans;

        for (i = 0; i < 5; i++) {
            for (j = 0; j < 7; j++) {
                twoDm[i][j] = k;
                k++;
            }
        }

        for (int[] row : twoDm) {
            printRow(row);
        }
        System.out.print("Enter a Seat number to reserve: ");
        ans = Integer.parseInt(br.readLine());

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:42:28.450

我认为这就是你想要的：

```
 package newtable;
    import java.io.*;
    public class Newtable {

    public static void printRow(int[] row) {
         for (int i : row) {
            System.out.print(i);
            System.out.print("\t");
        }
        System.out.println();
    }

     public static void main(String[] args)throws Exception {
     BufferedReader br=new BufferedReader(new InputStreamReader(System.in));   
     int twoDm[][]= new int[5][7];
        int i,j,k=1;
        int ans;

        for(i=0;i<5;i++) {
            for(j=0;j<7;j++) {
                twoDm[i][j]=k;
                k++;
            }
        }

        for(int[] row : twoDm) {
            printRow(row);
        }

        //this loop repeats the reserving process (and printing seats) 5 times
        for (int l = 0; l < 5; l++) {
            System.out.print("Enter a Seat number to reserve: ");
            ans = Integer.parseInt(br.readLine());
            k = 1;
            for(i=0;i<5;i++) {
                for(j=0;j<7;j++) {
                    if (k == ans) {
                        //here we check if the seat has already been reserved
                        if (twoDm[i][j]== 0) {
                            System.out.println("That seat has already been reserved");
                        }
                        //if its not reserved then reserve it
                        else {
                             twoDm[i][j]= 0;
                        }
                    }
                    k++;
                }
            }
            //print updated array of seats
            for(int[] row : twoDm) {
                printRow(row);
            }
       }

  } 
```

此代码搜索刚刚从控制台输入的座位号，并将其设置为 0；

```
 k = 1;
    for(i=0;i<5;i++) {
       for(j=0;j<7;j++) {
           if (k == ans) {
              twoDm[i][j]= 0;
           }
           k++;
       }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:43:07.200

First of all, I would use `1` or any other value to define if a seat is taken, since `int` values are by default initialized to 0\. If you insist in using 0 you'll have to initialize your whole two dimentional array to a value different than `0`.

Also, if your seats are defined by a number from 1 to 35 and you only define if a seat is taken or not, I suggest you use an array (not a table) of booleans. They take the values `true` and `false` and are easier to use in this kind of situations.

```
boolean reservations[] = new boolean[35]; 
```

with that in mind, just do:

```
reservations[seat] = true; 
```

And the value will be assigned to the element represented by the index. Then, to consult if a seat is already taken:

```
if(reservations[seat]) {
    //The seat is taken because the value stored with the indexes
    //is 0\. Do whatever you think is correct (printing a value, for example)
    //here.
} 
```

If you trylly want to use ints, I'll still encourage you to use 1 as the "taken" value.

```
int reservations[] = new int[35]; 
```

So you set a reserved value like this

```
reservations[seat] = 1; 
```

To check if a seat is taken, the process is slightly different. You'll need to use `==`. In this case (primitives) It'll check if both values are the same. (Later, when you use objects you'll want to use `equals()` instead).

```
if(reservations[seat] == 1) {
    //The seat is taken because the value stored with the indexes
    //is 0\. Do whatever you think is correct (printing a value, for example)
    //here.
} 
```

In all of the cases, `seat` is the `int` that represents the user's input.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-18T03:42:59.467

YOU COULD USE MY SOLUTION (ie using STRING):

```
public class MatrixDemo {

    static Scanner input = new Scanner(System.in);
    static String arrS[][] = new String[5][5];
    static String cName[] = {"A","B","C","D","E"};

    static int i, j;            // Loop Control Variables

    static void dispData() {    // Method that will display the array content
        for (i=0; i<5; ++i) {
            for (j=0; j<5; ++j) {
                System.out.print(arrS[i][j] + "\t");
            }
            System.out.println();
        }
        System.out.println();
    }

    static boolean chkData(String vData) {  // Method that will check for reservation availability
        for (i=0; i<5; ++i) {
            for (j=0; j<5; ++j) {
                if ((arrS[i][j]).equalsIgnoreCase(vData)) {
                    arrS[i][j]="X";
                    return true;
                }
            }
        }
        return false;
    }

    static boolean chkFull() {  // Method that will check if all reservations were occupied
        for (i=0; i<5; ++i) {
            for (j=0; j<5; ++j) {
                if (!(arrS[i][j]).equals("X")) {
                    return false;
                }
            }
        }
        return true;
    }

    public static void main(String eds[]) throws IOException {  // the MAIN method program
        String inData = new String("");
        for (i=0; i<5; ++i) {                                   // Initialized array with constant data
            for (j=0; j<5; ++j) {
                arrS[i][j] = new String((i+1) + cName[j]);
            }
        }

        do {                                                    // Loop until user press X to exit
            dispData();
            if (chkFull())
            {
                System.out.println("Reservation is FULL");
                inData="X";
            }
            else 
            {
                System.out.print("Enter Seat Reservation: ");
                inData = input.next();
                if (chkData(inData))
                    System.out.println("Reservation Successful!");
                else
                    System.out.println("Occupied Seat!");
            }       
        } while (!inData.equalsIgnoreCase("X"));

    }   
}

// Source Code took 30 mins to finished, needs review to be able to solve faster
// Sample practice probles and codes for students. 
```

# c++ - 可比类和二叉搜索树

> ID：12847025
> 
> 赞同：1
> 
> 时间：2012-10-11T19:24:55.593
> 
> 标签：c++, binary-search-tree

我需要创建一个抽象的“可比较”类。从此类继承的任何类都将实现 compare_to 方法。

```
/* returns 1 if this class > rhs, 0 if equal, -1 if this class < rhs */    
int compare_to(const Comparable& rhs); 
```

创建一个存储“可比较”对象而不是整数的二叉搜索树类。

我遇到的麻烦是了解二叉搜索树类的外观以及我们如何在其中存储 Comparable 对象。

我们可以使用模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T22:08:34.503

不要这样做，不要制作任何通用界面。这有很多缺点。如果从 IComparable 派生的两个类不能相互比较——比如 Int 和 String，该怎么办？

你说你可以使用模板。使用它们 - 并提供 Comparator 作为第二个模板参数：

```
template <class T, class Comparator>
class BSTree  {
public:
   bool present(const T& value)
   {
       int res = comparator(value, root->value);
       switch(res) {
         case 0: return true;
         case -1: return find(root->left, value);
         case 1: return find(root->right, value);
       }
   }
private:
  struct Node {
  ...
  };
  Node* root;
  Comparator comparator;
}; 
```

典型的比较器是：

```
template <class T>
class RawComparator {
public:
    int operator()(const T& l, const T& r) 
    {
       if (l < r) return -1;
       else if (l > r) return 1;
       else return 0;
    }

}; 
```

你的 int 的二叉搜索树：

```
typedef BSTree<int, RawComparator<int>> BSTreeInt; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:42:38.030

我相信您将不得不为二叉搜索树创建类模板。类模板看起来像

```
template <typename Comparable>
class BSTNode
{
public:
BSTNode const Comparable & theElement = Comparable( ),BSTNode *lt = NULL, BSTNode *rt = NULL);
int size( BSTNode *t ) ;
int height( BSTNode *t);
void printPostorder( ) ; 
void printInOrder( ) ; 
void printPreOrder( ) ;
bool operator<(const Comparable&,const Comparable &); 
BSTNode *duplicate() ;

public:

Comparable element;
BSTNode *left;
BSTNode *right;

}; 
```

然后您可以重载以添加类型对象`operator<`的比较方法。`Comparable`

# iphone - 如何获取设备令牌？

> ID：12847029
> 
> 赞同：7
> 
> 时间：2012-10-11T19:25:13.147
> 
> 标签：iphone, objective-c, ios, xcode

我将用户名、密码和设备令牌的值发布到 .net 网络服务。但它没有获得任何设备令牌值。我正在使用下面的代码。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
{ 
    [[UIApplication sharedApplication] setApplicationIconBadgeNumber:0]; 
    [[UIApplication sharedApplication] registerForRemoteNotificationTypes:UIRemoteNotificationTypeBadge|UIRemoteNotificationTypeAlert ]; 
}

- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken 
{    
   NSLog(@"didRegisterForRemoteNotificationsWithDeviceToken: %@", deviceToken); 
   NSString *dt = [[deviceToken description] stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@"<>"]]; 
   dt = [dt stringByReplacingOccurrencesOfString:@" " withString:@""]; 
   self.DeviceToken=dt; 
   NSLog(@"~~~~devToken(dv)=%@",deviceToken);
}

- (void)application:(UIApplication*)application didFailToRegisterForRemoteNotificationsWithError:(NSError*)error
{      
    NSLog(@"Failed to get token, error: %@", error);
} 
```

但在控制台中它显示

> 获取令牌失败，错误：错误域 = NSCocoaErrorDomain 代码 = 3000 “找不到应用程序的有效 'aps-environment' 权利字符串” UserInfo=0x1a0810 {NSLocalizedDescription=找不到应用程序的有效 'aps-environment' 权利字符串

任何的想法？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:36:00.873

您是否在临时文件中启用了推送通知？

浏览[教程](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12)以检查您是否做对了

首先尝试从您的 Mac 向设备发送推送通知，如教程中所述。您将需要一个服务器端的 pem 文件，您需要从 iOS 门户创建该文件 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:32:33.277

我假设您正在设备上运行/调试，因为您在尝试从模拟器注册推送令牌时会遇到不同的错误。只是想摆脱它。

话虽如此，通常导致您看到的错误是您选择的配置文件中未启用推送通知。现在，您可能已经进入 iOS 配置门户并为您的 App ID 启用了推送（还要注意是否为您的开发或分发配置文件启用了推送）。但是，在这样做之后，您必须进入并“弄脏”供应门户的供应配置文件，以生成一个包含推送权利的新供应配置文件。

通过“弄脏”它，我的意思是进入并更改配置文件的某些设置以强制重新创建。如果当您返回配置文件列表时，状态会暂时更改为“待处理”几秒钟，然后再次变为“活动”并允许您下载它，您就会知道您是否“弄脏”了它。

哦，我刚刚发现这个也回答了这个问题（如果我把它链接错了，请有人帮忙）：[Bundle Identifier and push certificate... aps-environment entitlement error](https://stackoverflow.com/questions/5681172/bundle-identifier-and-push-certificate-aps-environment-entitlement-error)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T07:14:35.747

```
- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken 
{    
   NSLog(@"didRegisterForRemoteNotificationsWithDeviceToken: %@", deviceToken); 
   NSString *dt = [[deviceToken description] stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@"<>"]]; 
   dt = [dt stringByReplacingOccurrencesOfString:@" " withString:@""]; 
   self.DeviceToken=dt; 

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-22T11:06:56.927

要获取设备令牌，**请在设备中运行应用程序**。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    // Let the device know we want to receive push notifications
    [[UIApplication sharedApplication] registerForRemoteNotificationTypes:
        (UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound | UIRemoteNotificationTypeAlert)];

    return YES;
}

- (void)application:(UIApplication*)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData*)deviceToken
{
    NSLog(@"My token is: %@", deviceToken);
}

- (void)application:(UIApplication*)application didFailToRegisterForRemoteNotificationsWithError:(NSError*)error
{
    NSLog(@"Failed to get token, error: %@", error);
} 
```

# dart - pub install dart-web-components 失败

> ID：12847031
> 
> 赞同：5
> 
> 时间：2012-10-11T19:25:31.523
> 
> 标签：dart, dart-webui, dart-pub

在 dart-web-components 上运行 pub install 会报错：

```
Pub install fail, HttpParserException: Connection closed before full header was received

/dart-web-components/build.dart --changed=packages\args\args.dart --changed=packages\args\src\utils.dart --changed=packages\logging\...
Failed with error code 255
Unable to open file: C:/dartapps/dart-web-components/packages/web_components/component_build.dart'file:///C:/dartapps/dart-web-components/build.dart': Error: line 8 pos 1: library handler failed 
```

导入“包：web_components/component_build.dart”；^

在 build.dart 文件中有一个字符串

```
import 'package:web_components/component_build.dart'; 
```

编辑器显示错误

```
Cannot find referenced source: package:web_components/component_build.dart 
```

component_build.dart 包含错误

```
Cannot find referenced source: package:args/args.dart
Cannot find referenced source: package:web_components/dwc.dart 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T09:36:03.057

我解决了这个问题。似乎缓存文件夹（Pub）已损坏。

我已删除文件夹缓存：

> C:\Users\<*用户名*>\AppData\Roaming\Pub

然后我从命令行运行`pub install`它可以工作。

我的操作系统是 Windows 7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:46:39.107

我试过很多次。我现在将 dart-web-components 放到默认的 package-root 目录中。酒吧安装现在产生

```
Pub install fail, Package "html5lib" doesn't have a pubspec.yaml file. 
```

但是，编辑器显示相同的错误

```
Cannot find referenced source: package:web_components/component_build.dart
Cannot find referenced source: package:args/args.dart 
```

等等在几乎每个 *.dart 文件中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T21:58:49.467

在 pubscpec.yams 中添加了这个

html5lib: git: git://github.com/dart-lang/html5lib.git

现在我又得到了

```
Pub install fail, HttpParserException: Connection closed before full header was received 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T03:03:02.510

您是否使用代理访问互联网？DartEditor 无法设置代理，因此无法访问 pub 包。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-12T16:40:51.867

好的，所以看看你的输出：

```
Pub install fail, HttpParserException: Connection closed before full header was received 
```

这是真正的问题。

```
/dart-web-components/build.dart --changed=packages\args\args.dart --changed=packages\args\src\utils.dart --changed=packages\logging\...
Failed with error code 255
Unable to open file: C:/dartapps/dart-web-components/packages/web_components/component_build.dart'file:///C:/dartapps/dart-web-components/build.dart': Error: line 8 pos 1: library handler failed 
```

这些只是第一个问题引起的红鲱鱼。

我看到你在 Windows 上。有一个已知问题，HTTP 内容有一些间歇性的非确定性故障。我还在调查，但很难追查。

每次尝试都会出现此错误吗？你做了多少次尝试？

很抱歉在这里给您带来麻烦。

# android - 在适用于 Android 的 Google Chrome Mobile 中禁用滑动到新标签手势

> ID：12847033
> 
> 赞同：5
> 
> 时间：2012-10-11T19:25:43.643
> 
> 标签：android, google-chrome

如果用户在屏幕右边缘的左侧附近滑动，则适用于 Android 的 Google Chrome Mobile 导航到下一个或上一个选项卡。这破坏了我的网络应用程序的功能，该应用程序具有全屏滑动浏览图像。有没有办法完全或在特定元素上禁用此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:37:49.297

目前无法禁用滑动标签手势

# grails - 从战争运行时，grails 占位符未在外部配置文件中解析

> ID：12847038
> 
> 赞同：1
> 
> 时间：2012-10-11T19:26:09.500
> 
> 标签：grails, configuration, properties

在我的 grails 应用程序（grails 1.3.7）中，我`Config.groovy`使用`grails.config.locations`. 外部位置之一是使用属性占位符的属性文件，例如

```
myprop=${base.dir}/some/other/stuff 
```

这在运行时有效`grails run-app`，但是当我部署到战争时，我收到一条错误消息`Could not resolve placeholder 'base.dir'`。

关于为什么这会在开发模式下运行而不是来自战争的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T00:47:25.507

我假设你这样做：

```
grails -Dgrails.env=myenv war myfile.war 
```

然后部署到 myenv 中的应用程序容器并获取 base.dir 问题..

尝试在 Config.groovy 中手动设置 base.dir

```
environments {
    myenv {
        base.dir = 'expected/base/dir'
    }
} 
```

希望这可以帮助..

# java - 在布局中挖洞或动态遮挡视图的一部分

> ID：12847041
> 
> 赞同：3
> 
> 时间：2012-10-11T19:26:19.903
> 
> 标签：java, android, android-layout, user-interface, android-animation

![在此处输入图像描述](../Images/84c7b785787beb5b0c70498b111af2b3.png)

*当活动开始时，用户应该看到左侧*

*   即顶部的绿色视图被裁剪，只有它的底部可见
*   并且下面的红色视图以交互方式可见，例如用户可以按下红色按钮
*   并且在绿色视图的顶部注册的任何触摸事件都不应工作（在顶部不可见）

*当用户触摸绿色视图的底部时，整个绿色视图应该变得可见*

*   现在为什么我不能为绿色视图设置一个上边距（类似于此图像的生成方式） - 原因是绿色视图在它包含手势检测并以某种方式响应这些手势的意义上是特殊的这高度依赖于它的全尺寸 - 所以我无法调整绿色视图的大小，而我仍然需要使它的一部分不可见（在用户触摸底部之前）

*有什么建议么？*

## 右侧的 XML，如何在不调整绿色视图大小的情况下获得左侧

*绿色视图实际上不是一个 TextView，而是一个自定义视图组，其外观具有手势驱动的动画*

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent">
    <RelativeLayout
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_marginTop="20dp"
            android:layout_marginLeft="20dp"
            android:layout_marginRight="20dp"
            android:layout_marginBottom="20dp"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content">
        <RelativeLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentTop="true"
                android:layout_alignParentLeft="true"
                android:layout_alignParentRight="true"
                android:layout_alignParentBottom="true"
                android:background="@drawable/border_red">
            <Button
                    android:background="@drawable/btn_red"
                    android:text="View Below Visible"
                    android:textSize="20sp"
                    android:layout_centerInParent="true"
                    android:layout_width="260dp"
                    android:layout_height="60dp"/>
        </RelativeLayout>
        <TextView
                android:layout_alignParentTop="true"
                android:layout_alignParentLeft="true"
                android:layout_alignParentRight="true"
                android:layout_alignParentBottom="true"
                android:background="@drawable/btn_green"
                android:text="View with Special Gesturing"
                android:textColor="@color/white"
                android:textSize="20sp"
                android:gravity="bottom"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"/>
    </RelativeLayout>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T21:40:23.353

将绿色视图包裹在 LinearLayout 中，并在其上方放置一个加权透明视图。就像是：

```
 <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">
        <View
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_weight="7"/>
        <WhateverCustomViewGroup
            android:background="@drawable/btn_green"
            android:text="View with Special Gesturing"
            android:textColor="@color/white"
            android:textSize="20sp"
            android:gravity="bottom"
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_weight="1"/>
    </LinearLayout> 
```

将手势检测器附加到 LinearLayout 而不是绿色视图，因此它在折叠时仍然可以响应。要扩展，只需`setVisibility(GONE)`在空视图上，绿色视图将扩展至其完整大小。

# php - 解析 HTML 文件以获取 CSS 引用

> ID：12847043
> 
> 赞同：0
> 
> 时间：2012-10-11T19:26:31.650
> 
> 标签：php, css

我有一个脚本，它假设从定义的 url 或页面收集所有 css。我已经尝试了所有方法，但由于某种原因它无法检测到链接的样式表，例如

```
<link rel="stylesheet" href="css/typography.css" /> 
```

我已经尝试了我能想到的一切。这是我在页面 css 和导入上收集的代码。添加链接系统的任何帮助都会很棒。

```
function scan($page_content){
    $i = 0;
    if(ereg("<style( *[\n]*.*)>\n*(.\n*)*<\/style>", $page_content)){
        if(preg_match_all("/(@\s*import\s* (url((\"|')?)?((\"|')?)|(\"|'){1}).+(\"|')?\)?)/", $page_content, $ext_stylesheets)){
            foreach($ext_stylesheets[0] as $stylesheet){
                $css_content[$i] = preg_replace("/(@\s*import\s*)|(url\(?((\"|')?))|(\"|'){1}|\)?(\"|')?;|(\s)/", "", $stylesheet);
                $i++;
            }
            $array = 1;
        }
        $inline_notused = $this->check_file($page_content, $page_content);
    }
    else die("No page styles, sorry!".$this->helptext);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T05:58:46.370

这是一个不错的 DOM/XPath 方式（[**演示**](http://viperpad.com/tY3u69)）：

```
function scan($html) {
    $dom = new DOMDocument;
    $dom->loadHTML($html);
    $path = new DOMXPath($dom);
    $nodes = $path->query('//style|//link');
    $style = '';
    foreach($nodes as $node) {
        if($node->tagName === 'style') {
            $style .= $node->nodeValue;
        } elseif($node->tagName === 'link') {
            $style .= "@import url('{$node->getAttribute('href')}')";
        } else {
            // Invalid
        }
        $style .= PHP_EOL;
    }
    return $style;
} 
```

# objective-c - 在目标 C 中的 Setter 中保留和释放

> ID：12847046
> 
> 赞同：1
> 
> 时间：2012-10-11T19:26:37.220
> 
> 标签：objective-c, ios, memory-management

这里的初学者问题：

我试图了解一些基本的内存管理。如果我要重写一个 setter 方法，以下是否足以处理传入字符串的内存管理？

```
- (void)setMyString:(NSString *)string
{
    if (_myString != string){
        [string retain];
        [_myString release];
        _myString = string;
    }
} 
```

我的逻辑是，一旦我们进入那个 if 语句，我想获得传入字符串的所有权，因此保留。接下来我释放 _myString 对象。然后我将 _myString 对象设置为字符串对象。这是我困惑的根源：此时我是否需要保留 myString 对象？还是由于将其设置为等于字符串对象，我已经拥有它的所有权？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:31:32.630

你写的都是正确~~的，除了最后的`return _myString`陈述~~。

当您在字符串上调用保留时，您将该实例的引用计数加一。将 string 的值赋值为`_myString`不会改变实际实例（现在由`string`and指向`_myString`），所以第二次保留是不必要的，而且是不正确的。

说了这么多，你所拥有的有点多余。检查的原因`if (_myString != string)`是，如果你的 setter 是用你已经拥有的同一个对象调用的，你不想在你有机会保留它之前释放那个对象。在这种情况下程序会崩溃，因为你释放它，它被释放，但你保留对它的引用并继续使用它（向它发送消息）。由于对象是相同的，如果函数的参数与实例变量的当前值相同，则只需不执行任何操作即可避免此问题。但是，在释放实例变量之前保留参数是完成完全相同的事情的另一种方法。

因此，您可以执行以下任一操作：

```
- (void)setMyString:(NSString *)string
{
    if (_myString != string) {
        [_myString release];
        _myString = [string retain];
    }
} 
```

或这个：

```
- (void)setMyString:(NSString *)string
{
    [string retain];
    [_myString release];
    _myString = string;
} 
```

我倾向于支持第一种方法，因为如果值相同，它会（*非常*稍微）更快，并且在写出时会更简单一些。但实际上，这取决于个人喜好，您原始问题中的形式也很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:21:35.593

不要再使用保留和释放。只需使用ARC，它将为您省去很多麻烦。您不必处理内存泄漏、编写大量保留/释放等。

And it will work with iOS 4, and since the current iOS version is 6, you're good to use ARC now than last year when ARC was new.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:58:11.987

还有一个更短的形式：

```
- (void)setFoo:(NSString *)aFoo {
  [_foo autorelease];
  _foo = [aFoo copy];
} 
```

此外，来自 google objective-c styleguide 的提示：

> 永远不要只保留字符串。这样可以避免来电者在您不知情的情况下更改它。不要因为你接受一个 NSString 而假设它实际上不是一个 NSMutableString。

# java - 光标无法解析错误

> ID：12847048
> 
> 赞同：0
> 
> 时间：2012-10-11T19:26:44.657
> 
> 标签：java, eclipse, google-app-engine

任何人都遇到过以下错误：

```
The type com.google.appengine.api.datastore.Cursor cannot be resolved. It is indirectly referenced from required .class files 
```

我已经完成了项目清理，但我的 Eclipse 项目仍然存在此错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:35:08.857

执行`ctrl+shift+t com.google.appengine.api.datastore.Cursor`并查看是否`Cursor`可以在您的 Eclipse 中访问。如果没有，请通过在类路径中添加 jar 使其可用。如果是，请检查路径并确保其仅显示您项目的路径。

# .net - 使用 Sub() 异步行为的并行调用

> ID：12847049
> 
> 赞同：1
> 
> 时间：2012-10-11T19:26:47.437
> 
> 标签：.net, parallel-processing, invoke

我正在尝试使用 System.Threading.Tasks 库以 100% 异步方式触发 WCF 服务调用。当我在下面的代码示例中调用 HandleChange 方法时，它似乎仍然要等到客户端服务调用完成才能继续前进。我想做这样的事情，但不是“暂停演出”——这意味着我希望调用它的方法在客户端调用完成之前移动到下一行代码。我可能只是错误地处理了这个问题，所以如果有人能提供关于我做错了什么的见解，或者我如何能在这里实现我的目标，我将不胜感激。

```
Imports System.Threading.Tasks

Public Class ChangeWrapper

        Public Shared Sub HandleChange(ByVal orgEntity As MainObjectBase, ByVal newEntity As MainObjectBase)

            Parallel.Invoke(Sub()
                                Using client As New EventQueueService.EventQueueClient

                                    client.QueueDecision(orgEntity, newEntity)

                                End Using
                            End Sub)

        End Sub

    End Class 
```

**编辑：反映我根据 SLaks Answer 所做的更改**

```
Imports System.Threading.Tasks

Public Class ChangeWrapper

        Public Shared Sub HandleChange(ByVal orgEntity As MainObjectBase, ByVal newEntity As MainObjectBase)

            Task.Factory.StartNew(Sub()
                                      Using client As New EventQueueService.EventQueueClient

                                          client.QueueDecision(orgEntity, newEntity)

                                      End Using
                                  End Sub)

        End Sub

    End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:28:25.547

该类`Parallel`用于并行但同步地运行事物。

要异步运行某些东西，请使用`Task`该类。
你想要`Task.Factory.StartNew()`。

# php - MySQL 列转换为 PHP 数组错误

> ID：12847054
> 
> 赞同：0
> 
> 时间：2012-10-11T19:27:04.410
> 
> 标签：php, mysql, stdclass

我在将 MySQL 列放入 php 数组变量时遇到问题，以便进一步`foreach()`循环。

这是我的代码：

```
$files=array();
$filesFetch = "SELECT FileName FROM articledata";
$rs=mysql_query($filesFetch);
while($rd=mysql_fetch_object($rs))
{
$files[]=$rd->files;
}

if (!$files) {
    die('getting filenames failed');
}
foreach ($files as $key => $id) 
{  //... do the stuff } 
```

我没有停止这种`die`情况，但我的错误说：

> 注意：未定义的属性：stdClass::$files

我认为格式存在问题，因为此错误通知重复：“rowCountTimes”

该行也出现此错误。

```
$files[]=$rd->files; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:28:32.693

您的对象具有基于列名的属性；你需要使用：

```
$files[]=$rd->fileName; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:28:56.517

您正在获取 FileName，因此您必须在对象中使用它：

```
$files[]=$rd->FileName; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:29:50.197

它应该是

```
$rd->FileName 
```

而不是`$rd->files`因为您的列名是`FileName`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:33:27.497

你写的代码肯定没有意义。您正在获取一个保存在变量中的对象`$rd`。然后您尝试访问属性`files`，但当然这是未定义的，因为您只获取了名为 FileName 的列。

所以改用： `$files[] = $rd->FileName;`

# ios - 如果宽度小于屏幕大小，则 UITableViewCell 无法正确设置动画

> ID：12847057
> 
> 赞同：0
> 
> 时间：2012-10-11T19:27:26.673
> 
> 标签：ios, animation, uitableview

我有一个 UITableViewCell 的子类，我想在事件发生时提供一些自定义动画。我一直在努力弄清楚为什么我一直收到相同的动画（我假设 UITableViewRowAnimationFade，单元格会消失并且它下面的单元格会向上滑动），我最终决定深入研究这个问题。我发现当我将单元格的大小设置为小于 320 时（或者我假设完全等于您当前所在屏幕的大小），它将回退到这个默认动画。

我的自定义单元格就像一个浮动框（我每个部分有 1 个单元格，有很多部分），我像这样设置它

```
self.frame = CGRectMake(5, self.frame.origin.y, 310, self.frame.size.height);
self.contentView.frame = CGRectMake(0, 0, 310, self.frame.size.height); 
```

但我每次都得到默认动画。如果我将其更改为

```
self.frame = CGRectMake(5, self.frame.origin.y, 320, self.frame.size.height);
self.contentView.frame = CGRectMake(0, 0, 320, self.frame.size.height); 
```

不同的动画效果很好。

有谁知道为什么会这样？我想知道它是否打算以这种方式工作，我需要更改我的单元的设置方式，或者是否有解决方法。

谢谢。

编辑：屏幕截图

![在此处输入图像描述](../Images/f0f7071cbfdc50db496f1e3f8f8fbc61.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T11:26:14.930

您使 contentView.background 颜色清晰，因此单元格本身是完全透明的。然后，您将一个视图添加到具有背景颜色的 contentView - 一个带有框架的视图，该框架将其插入到左侧和右侧（可能还有顶部和底部）。[我现在正在做几乎完全相同的事情 - 为我的应用程序在商店中的一个新功能]。让我们将此视图称为 containerView（因为它将包含所有其他视图）。您可能想要设置 clipsContentsToBounds 属性，这样您的任何子视图都不可能“伸出”它。

然后，您可以将其他视图添加到容器视图。由于我总是回收我的单元格，因此您希望在所有容器子视图上设置标记值，以便您可以轻松找到它们并设置适当的属性（图像、文本、颜色等）。

# actionscript-3 - AS3 - 通过 For 循环添加动态 MovieClips 的 hitTestObject

> ID：12847059
> 
> 赞同：2
> 
> 时间：2012-10-11T19:27:40.277
> 
> 标签：actionscript-3

我一直在尝试在我最近从事的一个项目中设置一个 hitTestObject 函数，但遇到了一些困难。

这是因为我正在尝试使用通过 For 循环动态添加的 MovieClip 实例来执行此操作。添加的影片剪辑被称为“方形”，当我左键单击鼠标时，我将一系列这些影片剪辑添加到舞台。我的问题是我想听一个'square'的hitTestObject拦截'square'以及随后添加相同的MovieClip。

我已经设置了一个数值变量，每次通过左键单击将“方形”电影剪辑组添加到舞台时，该变量递增 1，并且我已经分配了这个数字以及一个字符串以组合在一起以创建一个 square.name实例。

在我的情况下，添加的第一组 MovieClip 将有一个名为“Square 1”的 .name 实例，然后在第二次鼠标单击时具有“Square 2”，依此类推。

我还添加了每个名称并将其推送到容器数组中以供以后引用。

那么如何使用我的 .name 实例和数组在 hitTestObject 参数中实际引用这些动态名称？

我确信这很明显，并且我已经完成了基础工作，因此任何向我指出这一点的帮助都会非常感激。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T22:46:01.133

这是一种可能的方法，假设您尝试在时间轴中执行此操作，并且您在名为“Square”的库中有一个 MovieClip 子类。请注意在执行 hitTests 时修改数组。如果要删除正方形，请等到所有测试完成后，或制作正方形数组的副本。

```
var squares: Array = [];

function addSquares(n: int): void {
    var square: MovieClip;

    for (var i: int = 0;
    i < n;
    i++) {
        square = new Square();
        square.name = "square" + i;
        addChild(square);
        squares.push(square);
    }
}

function checkHits(): void {
    var square: MovieClip;
    var checkSquare: MovieClip;

    for (var i: int = 0;
    i < squares.length;
    i++) {
        square = squares[i];

        for (var j: int = i + 1;
        j < squares.length;
        j++) {
            checkSquare = squares[j];

            if (square.hitTestObject(checkSquare)) {
                squaresHit(square, checkSquare);
            }
        }
    }
}

function squaresHit(square1, square2): void {
    // do something
    trace("squaresHit:" + square1.name + "," + square2.name);
}

addSquares(4);
checkHits();

//squaresHit:square0,square1
//squaresHit:square0,square2
//squaresHit:square0,square3
//squaresHit:square1,square2
//squaresHit:square1,square3
//squaresHit:square2,square3 
```

# html - 执行位置时使 div 图像可点击：absolute

> ID：12847060
> 
> 赞同：3
> 
> 时间：2012-10-11T19:27:40.940
> 
> 标签：html, css

我需要在我的站点上放置一个站点皮肤，其中主内容区域左侧有一个 336x768px 图像，主内容区域右侧有另一个图像。

我能够正确定位它，但我无法使图像可点击。我相信它与容器的 z-index 有关，但我没有任何运气来调整它们。

我创建了一个 jsfiddle 来演示和展示我的代码：http: [//jsfiddle.net/puTEe/](http://jsfiddle.net/puTEe/)

通过单击左侧和右侧的图像，您应该单击指向 google/yahoo 的链接。

CSS：

```
.site-skin {
    width: 96px;
    height: 76px;
    position: absolute;
    z-index: -1;
}

#skin-right {
    right: 0;
}

#main-container {
    width: 96px;
    height: 60px;
    margin: auto;
} 
```

的HTML：

```
<div class="site-skin">
      <a href="http://google.com">
          <img src="http://placehold.it/96x76">
      </a>
  </div>

  <div class="site-skin" id="skin-right">
      <a href="http://yahoo.com">
          <img src="http://placehold.it/96x76">
      </a>
  </div>

  <div id="main-container">
      main content
  </div>​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:31:08.810

为什么要使用负 z-index？那是你的问题。使它们成为非负数，它们可以正常工作。

请注意，负 z-index 值是允许的，但是由于您`#main-container`没有设置 z-index，它默认为零，并且实际上位于页面一侧的其他 div 之上。如果您在`#main-container`（并定位它）上设置较低的负 z-index，这也将解决您的问题，尽管在我看来，将您现在拥有的负 z-index 更改为正数更有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:30:44.853

您需要有一个正的 z-index 值。这应该有效。

[工作版](http://jsfiddle.net/puTEe/1/)

# java - 如果实体的祖先不存在，是否会创建它（Java API）？

> ID：12847062
> 
> 赞同：1
> 
> 时间：2012-10-11T19:27:53.297
> 
> 标签：java, google-app-engine, google-cloud-datastore

我正在尝试设计我的应用程序引擎数据存储区代码，并且已经想到了一个潜在问题，并且无法在文档中找到有关在给定情况下会发生什么的任何具体信息。

当我去存储一个具有祖先的实体时，在存储它之前我检查以确保它的祖先存在于一个事务中，如果它不存在，我创建祖先。接下来，我开始另一个存储实体的事务，使用在上一步中找到或创建的祖先键创建它。在使用单个用户或极少数用户进行测试时，这永远不会成为问题，因为并发修改的机会最少，但是一旦部署，我担心的是在第一个事务之间的时间（创建/检索祖先) 和第二个事务（添加一个实体作为祖先的后代）另一个用户可能会删除祖先。

我最初的想法是让这一切作为一个事务发生，但在祖先不存在并且必须创建的情况下，检查我要创建的实体是否存在的祖先查询将失败，因为快照隔离模型数据存储。但是，我不确定这是否正确。

有人对此事有任何了解吗？如果祖先被删除，实体提交是否仍然可以使用现在不引用任何内容的父键？这会重新创建父级，以便将来对其进行检查将返回相同的密钥吗？我会测试这种情况，但我无法设计出一种切实可行的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T07:51:28.103

一种可能的解决方案是尝试直接获取祖先（而不是查询），如果对象为空，则在事务中同时创建祖先和后代。这将模拟跨组事务（XG 事务），因为这两个实体在创建时将不属于同一个实体组。

有关 XG 交易的更多信息，请查看：

*   [Java 中的事务](https://developers.google.com/appengine/docs/java/datastore/transactions)
*   [Python 中的事务](https://developers.google.com/appengine/docs/python/datastore/transactions)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-20T20:16:02.387

我相信答案是：“**是**的，它仍然会被创建”。

此行为不应特定于 Python 或 Java API。我尝试创建一个实体，其中密钥具有不存在的祖先，并且它似乎在 Google Cloud Datastore 中工作。

我猜这背后的逻辑是基于 Datastore 回答问题的过程：“这个键属于哪个实体组？” 我假设该决定是通过检查“顶级”祖先来做出的，这意味着是否存在*仅*具有顶级祖先的 Key 无关紧要。

也就是说，如果`Key.from_path('Kind1', 'parent')`两者`Key.from_path('Kind1', 'parent', 'Kind1', 'child')`都放在同一个实体组中（彼此独立），那么它们添加的顺序是无关紧要的，第一个的存在与第二个所在的组无关。

一些示例代码：

```
from gcloud.datastore import demo
from gcloud.datastore.entity import Entity
from gcloud.datastore.key import Key

dataset = demo.get_dataset()
entity = Entity()
key = Key.from_path('Person', 'parent', 'Person', 'child').dataset(dataset)
entity = entity.key(key)
entity.save() 
```

请注意，没有“父级”（`kind='Person', key_name='parent'`不存在的实体）。

# c# - 接口的调度程序实现的 Ninject 绑定

> ID：12847070
> 
> 赞同：10
> 
> 时间：2012-10-11T19:28:21.957
> 
> 标签：c#, .net, dependency-injection, ninject, ioc-container

我有一个界面：

```
public interface IService
{
    void DoStuff(int parm1, string parm2, Guid gimmeABreakItsAnExampleK);
} 
```

我想配置 Ninject (v3) 绑定，以便我可以有一个“调度程序” shuffle 方法调用多个实例`IService`，如下所示：

```
public sealed class DispatcherService : IService
{
    private IEnumerable<IService> _children;

    public DispatcherService(IEnumerable<IService> children)
    {
        this._children = children.ToList();
    }

    public void DoStuff(int parm1, string parm2, Guid gimmeABreakItsAnExampleK)
    {
        foreach(var child in this._children)
        {
            child.DoStuff(parm1, parm2, gimmeABreakItsAnExampleK);
        }
    }
} 
```

然而，我的绑定，看起来像这样，最终在运行时抛出一个异常，指示循环依赖：

```
this.Bind<IService>().To<DispatcherService>();

this.Bind<IService>().To<SomeOtherService>()
    .WhenInjectedExactlyInto<DispatcherService>();
this.Bind<IService>().To<YetAnotherService>()
    .WhenInjectedExactlyInto<DispatcherService>(); 
```

这可能吗？如果是这样，我做错了什么？忍者能否逃脱这种周期性依赖的厄运？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T03:36:21.943

如果您的调度程序是将IService 列表作为参数的*唯一IService，那么这确实有效（我测试过）：*

```
kernel.Bind<IService>().To<DispatcherService>().When(x => x.IsUnique);
this.Bind<IService>().To<SomeOtherService>()
    .WhenInjectedExactlyInto<DispatcherService>();
this.Bind<IService>().To<YetAnotherService>()
    .WhenInjectedExactlyInto<DispatcherService>(); 
```

该`When`子句适用于这种情况的原因是，当您的构造函数调用单个服务实例时，该`IsUnique`字段`IRequest`被设置为。`true`由于您`DispatcherService`需要一个`IEnumerable`，因此该值是`false`激活`DispatcherService`. 这可以防止循环依赖的发生。

实际上，告诉内核不要尝试将 DispatcherService 注入自身的任何正确方法都可以工作（这只是一个潜在有用的示例）。

编辑：简单地短路循环依赖的更明确的方法似乎是这样的：

```
kernel.Bind<IService>().To<DispatcherService>().When(
   request => request.Target.Member.DeclaringType != typeof (DispatcherService)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T15:39:50.263

为什么不把DispatcherService中的IService去掉，取名为IDispatcherService，让被调用的服务（接收者）实现IService呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T21:39:28.263

我必须承认我对 Ninject API 不是很熟悉，但我认为这样可以解决问题：

```
kernel.Bind<IService>().To<DispatcherService>();   

kernel.Bind<IEnumerable<IService>>().ToMethod(() => new IService[]
{
    kernel.Get<SomeOtherService>(),
    kernel.Get<YetAnotherService>(),
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T09:22:29.993

您可以通过将其中一个子集设置为命名绑定来将两个子集（调度程序或接收者）隔离开，然后使用名称作为将一个子集提供给另一个子集的一种方式（通过 a`NamedAttribute`或在您的接线中）

# c# - ASP.net 在长任务前显示消息

> ID：12847078
> 
> 赞同：3
> 
> 时间：2012-10-11T19:28:30.867
> 
> 标签：c#, jquery, asp.net, database, asynchronous

我正在尝试完成一些看起来不应该太难的事情，但我似乎找不到有效的方法。

我正在从 asp.net 页面调用数据库上的存储过程。该过程可能需要一些时间，具体取决于那里的数据量。

我想做的只是显示一条消息，说请在任务完成时稍候。

问题是，在使用消息更新页面后，我无法找到调用该过程的方法。无论我做什么，页面更新总是被数据库调用阻塞。

我首先尝试使用多视图。用户单击一个按钮，我将视图更改为等待消息。从这一点开始，我无法等待页面重新发布和更新，然后调用数据库过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:34:25.977

您有几个选项，您可以使用`AJAX Control Toolkit`和 UpdateProgress 控件，或者您可以使用`jQuery`和调用数据库调用`WebMethod`或`Web Service`。

**`AJAX Control Toolkit`**

[http://www.asp.net/ajax/documentation/live/overview/UpdateProgressOverview.aspx](http://www.asp.net/ajax/documentation/live/overview/UpdateProgressOverview.aspx)

**`jQuery implementation`**

```
[WebMethod]
public void PerformDatabaseOperation() {
    // Your database code here
} 
```

要向您的 执行请求`Web Method`：

```
$.ajax({
  type: "POST",
  url: "./YourPage.aspx/PerformDatabaseOperation",
  error: function(XMLHttpRequest, textStatus, errorThrown){
      alert(textStatus);
  },
  success: function(result){
     alert("success");
  }
}); 
```

您必须有一个`div`作为消息的占位符：

```
<div id="LoadingMessage">
   Please wait....
</div>

$('#LoadingMessage').hide()  
.ajaxStart(function() {
    $(this).show();
})
.ajaxStop(function() {
    $(this).hide();
}); 
```

每次执行数据库调用时，您都会看到加载消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:35:33.833

UpdateProgress 控件简介

[http://msdn.microsoft.com/en-us/library/bb386421%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/bb386421%28v=vs.100%29.aspx)

In this tutorial you will use UpdateProgress controls to display the progress of partial-page updates. If a page contains UpdatePanel controls, you can also include UpdateProgress controls to keep users informed about the status of partial-page updates. You can use one UpdateProgress control to represent the progress of partial-page updates for the whole page. Alternatively, you can include an UpdateProgress control for every UpdatePanel control. Both of these patterns are shown in this tutorial.

# javascript - 如何在 IE 9 控制台/或 VS 中查看 xml 对象

> ID：12847080
> 
> 赞同：1
> 
> 时间：2012-10-11T19:28:38.027
> 
> 标签：javascript, jquery, html, internet-explorer

```
var log = Function.prototype.bind.call(console.log, console);  

jQuery.get("metadata.xml", function(metadata){  
            xmlCols = $(metadata).find('UXView');//'.find('ListDefintion').find('uxv\\:Column');
        log.apply(console, [xmlCols]);
}); 
```

console.log 在 chrome 中工作得非常好，但这个解决方法（在 IE 9 中获得 console.log 等效项，如stackoverflow 本身的[这篇文章](https://stackoverflow.com/questions/5472938/does-ie9-support-console-log-and-is-it-a-real-function)中所建议的那样），在 IE 中显示 [object object] 在控制台中。当我尝试在手表中查看它时，它会显示整个对象及其所有属性，我不知道如何在其中查看实际的 xml？

如果有办法在 Visual Studio 中查看它（使用调试器命令），我可以使用它，但直到现在它在那里也显示相同的东西。谢谢...

# android - jQuery Mobile 图标在 Android 上是白色而不是黑色

> ID：12847081
> 
> 赞同：7
> 
> 时间：2012-10-11T19:28:40.883
> 
> 标签：android, jquery-mobile

我在使用默认 jQuery Mobile 图标时遇到问题。在 Android 设备（任何浏览器，检查默认浏览器、FireFox 和 Chrome）上，图标是白色的，但应该是黑色的。在其他设备（iPhone、Windows Phone、台式电脑）上，图标应该是黑色的。我正在使用最新的稳定 jQuery Mobile 1.2.0。如果有人遇到这样的问题，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-18T23:05:40.140

我有同样的问题。我使用主题滚轮 - [http://jquerymobile.com/themeroller](http://jquerymobile.com/themeroller)

生成 CSS 文件时可能存在小错误。第 789 行是：

```
background-image: url(images/icons-36-white.png); 
```

但应该是：

```
background-image: url(images/icons-36-black.png); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T07:07:03.957

很抱歉我之前没有看到过这个问题，但是您可以尝试将类添加`ui-icon-alt`到要变成黑色的图标中。

对于所有图标：

```
$('.ui-icon').addClass('ui-icon-alt'); 
```

# google-apps-script - Docslist 配额：如何在迁移时避免它？

> ID：12847087
> 
> 赞同：2
> 
> 时间：2012-10-11T19:29:02.940
> 
> 标签：google-apps-script, quota

我正在为上传的文档创建一个包含 1700 个文件夹的文件夹树，并且已达到 Docslist 配额限制。在这种情况下等待一天左右就可以了，但是为了将未来的客户迁移到 Google Apps，我想要一个比 var newfolder = DocsList.getFolderById(parent).createFolder(name); 更好的方法。直到失败

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:35:40.787

在我看来，谷歌的力量在于搜索。所以也许你的第一个问题应该是我需要这么多文件夹。

解决方案：使用多个管理员帐户进行大迁移。

并利用您的 API 迁移数据

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T09:20:54.720

对我来说，答案肯定是在应用程序之外建立文件夹结构并通过 chrome 上传。添加我的空文件夹树需要几秒钟，而在 Apps 脚本中添加 200 个文件夹需要几分钟。

# ios - 以编程方式执行 segue

> ID：12847088
> 
> 赞同：1
> 
> 时间：2012-10-11T19:29:03.997
> 
> 标签：ios, uistoryboardsegue

我只是在玩桌子视图。我需要以编程方式分配一个segue。我的代码是

```
[self preformSegueWithIdentifier:@"showDetail" sender:tableview]; 
```

它说一个ARC问题是：

> “MasterViewController”没有可见界面声明选择器“preformSegueWithIdentifier：sender：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:53:12.043

替换`preformSegueWithIdentifier`为`performSegueWithIdentifier`。

# mootools - 单个页面上的多个 Mootools 轮播

> ID：12847089
> 
> 赞同：1
> 
> 时间：2012-10-11T19:29:09.403
> 
> 标签：mootools, carousel

我一直在网上寻找一个 MooTools 轮播插件，它可以让我在一个页面上拥有多个。

我目前有[一个](http://tbela99.github.com/carousel/Demos/horizontal.html)成功地为单个轮播工作，但它似乎不允许在一个页面上使用多个。

是我提到的插件做错了什么，还是某处存在推荐的插件？

# opengl - 我的用于 OpenGL 的 Go 矩阵函数（透视/截锥和观察矩阵）有什么问题？

> ID：12847094
> 
> 赞同：3
> 
> 时间：2012-10-11T19:29:23.827
> 
> 标签：opengl, matrix, go, glsl, vertex-shader

首先，这是非常简单的“新手标准”顶点着色器：

```
in vec3 aPos;
uniform mat4 uMatModel; uniform mat4 uMatView; uniform mat4 uMatProj;

void main () {
    gl_Position = uMatProj * uMatView * uMatModel * vec4(aPos, 1.0);
} 
```

现在我渲染的是一个简单的 6 面立方体。36 个顶点坐标中没有应用或固有的旋转。标准教程风格的 -0.5..+0.5 东西。我会在这里为您省去顶点数组，但请放心，就这么简单。

*   **uMatModel**现在只是单位矩阵，还没有缩放/平移/旋转
*   **uMatView**是一个*LookAt 矩阵*（下面的 Go 代码），用 pos={ 0.1, 0.1, -3.0 }, target={ ​​0.1, 0.1, 0.1 }, up={ 0, 1, 0 } 调用（记住立方体顶点坐标都是所有维度都在 -0.5 和 0.5 之间，因此 0.1 应该“几乎在中心”）
*   **uMatProj**是一个*透视矩阵*（下面的 Go 代码），以 fov=45 aspect=winwidth/winheight near=0.1 far=100 调用

理论上，“相机”应该在正对着它的立方体“后面”大约 2-3 个单位。相反，我得到...

![在此处输入图像描述](../Images/77e069c4d6aeb2d062674756aaae3a3b.png)

我想知道轮换是从哪里来的……我什至还没有实施轮换。

因此，总而言之，我尝试在 Go 中自己实现所需的矩阵函数，并解决数学问题。但我一定在某个地方出了问题。**任何人都可以在我的以下代码中发现任何矩阵理论问题吗？**

```
type Mat4x4 [4][4]float64

func (me *Mat4x4) Identity () {
    me[0][0], me[0][1], me[0][2], me[0][3] = 1, 0, 0, 0
    me[1][0], me[1][1], me[1][2], me[1][3] = 0, 1, 0, 0
    me[2][0], me[2][1], me[2][2], me[2][3] = 0, 0, 1, 0
    me[3][0], me[3][1], me[3][2], me[3][3] = 0, 0, 0, 1
}

func (me *Mat4x4) Frustum (left, right, bottom, top, near, far float64) {
    me[0][0], me[0][1], me[0][2], me[0][3] = (near * 2) / (right - left), 0, 0, 0
    me[1][0], me[1][1], me[1][2], me[1][3] = 0, (near * 2) / (top - bottom), 0, 0
    me[2][0], me[2][1], me[2][2], me[2][3] = (right + left) / (right - left), (top + bottom) / (top - bottom), -(far + near) / (far - near), -1
    me[3][0], me[3][1], me[3][2], me[3][3] = 0, 0, -(far * near * 2) / (far - near), 0
}

func (me *Mat4x4) Perspective (fovY, aspect, near, far float64) {
    var top = near * math.Tan(fovY * math.Pi / 360)
    var right = top * aspect
    me.Frustum(aspect * -top, right, -top, top, near, far)
}

func (me *Mat4x4) LookAt (eyePos, lookTarget, worldUp *Vec3) {
    var vz = eyePos.Sub(lookTarget)
    vz.Normalize()
    var vx = worldUp.Cross(&vz)
    vx.Normalize()
    var vy = vz.Cross(&vx)
    vy.Normalize()
    me[0][0], me[0][1], me[0][2], me[0][3] = vx.X, vy.X, vz.X, 0
    me[1][0], me[1][1], me[1][2], me[1][3] = vx.Y, vy.Y, vz.Y, 0
    me[2][0], me[2][1], me[2][2], me[2][3] = vx.Z, vy.Z, vz.Z, 0
    me[3][0], me[3][1], me[3][2], me[3][3] = -((vx.X * eyePos.X) + (vx.Y * eyePos.Y) + (vx.Z * eyePos.Z)), -((vy.X * eyePos.X) + (vy.Y * eyePos.Y) + (vy.Z * eyePos.Z)), -((vz.X * eyePos.X) + (vz.Y * eyePos.Y) + (vz.Z * eyePos.Z)), 1
} 
```

注意，这里的**Vec3**是同一个包中的自定义类型，我这里没有包含。现在我假设 Vec3 函数是正确的（也更容易验证）并怀疑我以某种方式弄乱了矩阵结构中的*LookAt*和/或*Perspective*算法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:03:36.617

这是（大概）度到弧度的转换好吗？

```
func (me *Mat4x4) Perspective (fovY, aspect, near, far float64) {
        var top = near * math.Tan(fovY * math.Pi / 360)
        var right = top * aspect
        me.Frustum(aspect * -top, right, -top, top, near, far)
} 
```

也许应该有：

```
 top := near * math.Tan(fovY * 2 * math.Pi / 360) 
```

# c# - 使用 Google Maps API 绑定到 .ADO 模型时出错

> ID：12847095
> 
> 赞同：2
> 
> 时间：2012-10-11T19:29:24.770
> 
> 标签：c#, asp.net-mvc-3, razor, google-maps-api-2

**为什么我会收到此错误？**

> 编译器错误消息：CS1061：“System.Collections.Generic.IEnumerable”不包含“lat”的定义，并且找不到接受“System.Collections.Generic.IEnumerable”类型的第一个参数的扩展方法“lat”（您是否缺少 using 指令或程序集引用？）

**.Ado 模型** int, lat, lng, 内容

**控制器**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using MapApp.Models;

namespace MapApp.Controllers
{
    [HandleError]
    public class HomeController : Controller
    {
        mapEntities _db = new mapEntities();

        public ActionResult Index()
        {
            return View(_db.river);
        }

        public ActionResult About()
        {
            return View();
        }
    }
} 
```

**看法**

```
@model IEnumerable<MapApp.Models.river>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h2> Index</h2>
<script type="text/javascript">
@foreach (var item in Model)
{
    <text>
      var markerlatLng = new google.maps.LatLng(@(Model.lat), @(Model.lng));
      var contents = '@(Model.contents)';

      var infowindow = new google.maps.InfoWindow({
          content: contents
      });

      var marker = new google.maps.Marker({
          position: markerlatLng,
          title: contents,
          map: map,
          draggable: false
      });

      google.maps.event.addListener(marker, 'click', function () {
          infowindow.open(map, marker);
      });

   </text>
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:41:34.283

`Model`是`river`s 的一个 Enumerable。您似乎正确地循环穿过河流，但您在循环内错误地引用了每个项目。

尝试：

```
var markerlatLng = new google.maps.LatLng(@(item.lat), @(item.lng));
var contents = '@(item.contents)'; 
```

这应该够了吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T09:09:18.857

修好了！

**控制器**

```
public class HomeController : Controller
{
    mapEntities _db = new mapEntities();

    public ActionResult Index()
    {
        return View(_db.river.ToList());
    }
} 
```

**看法**

```
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">

$(function () {
    var latLng = new google.maps.LatLng(52.379397, 4.889644); // Amsterdam
    var map = new google.maps.Map(document.getElementById('map-canvas'), {
        zoom: 15,
        center: latLng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    function addMarker(latitude, longitude, title)
    {
        var markerLatLng = new google.maps.LatLng(latitude, longitude);
        var title = title;

        var marker = new google.maps.Marker({
            position: markerLatLng,
            title: title,
            map: map,
            draggable: false
        });
    };

   @foreach (var item in Model)
   {  
     @:addMarker(@item.latitude, @item.longitude, "@item.title");
   }

}); 

</script>
<div id="map-canvas">
</div> 
```

# apache-flex - flex中的datagrid提前水平滚动时背景颜色消失

> ID：12847099
> 
> 赞同：1
> 
> 时间：2012-10-11T19:29:58.667
> 
> 标签：apache-flex

我正在尝试使用“setStyle”功能在数据网格中的 3 列中设置颜色，并且我能够成功地做到这一点。但是一旦我水平滚动背景颜色就会消失。

在图像“beforeScroll.PNG”中，3 列 header1、header2 和 header3 的背景颜色为灰色，这很好。但是当我水平滚动数据网格（参见“after-1st-Hscroll.PNG”）时，header2 中的颜色消失了，第二次滚动时（参见“after-2st-Hscroll.PNG”），标题 3 中的颜色也消失了。

我正在使用 SDK 4.6.0

![beforeScroll](http://C:/Documents and Settings/p102808/Desktop/New Folder (2)/beforeScroll.PNG)

![after-1st-Hscroll](http://C:/Documents and Settings/p102808/Desktop/New Folder (2)/after-1st-Hscroll.PNG)

![after-2st-Hscroll](http://C:/Documents and Settings/p102808/Desktop/New Folder (2)/after-2nd-Hscroll.PNG)

请在下面找到我的代码：

```
<?xml version="1.0" encoding="utf-8"?>
    <s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
                   xmlns:s="library://ns.adobe.com/flex/spark" 
                   xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600"
                   creationComplete="onComplete()">
        <fx:Declarations>
            <!-- Place non-visual elements (e.g., services, value objects) here -->
        </fx:Declarations>
        <fx:Script>
            <![CDATA[
                import mx.controls.advancedDataGridClasses.AdvancedDataGridColumn;
                private function onComplete():void{
                    var colsArr:Array=new Array();
                    var column1:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column1.headerText="Header1";
                    column1.setStyle("backgroundColor","0xcccccc");
                    colsArr.push(column1);
                    var column2:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column2.headerText="Header2";
                    column2.setStyle("backgroundColor","0xcccccc");
                    colsArr.push(column2);
                    var column3:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column3.headerText="Header3";
                    column3.setStyle("backgroundColor","0xcccccc");
                    colsArr.push(column3);
                    var column4:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column4.headerText="Header4";
                    colsArr.push(column4);
                    var column5:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column5.headerText="Header5";
                    colsArr.push(column5);
                    sampleDG.columns=colsArr;
                    var column6:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column6.headerText="Header6";
                    colsArr.push(column6);
                    sampleDG.columns=colsArr;
                    var column7:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column7.headerText="Header7";
                    colsArr.push(column7);
                    sampleDG.columns=colsArr;
                    var column8:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column8.headerText="Header8";
                    colsArr.push(column8);
                    sampleDG.columns=colsArr;
                    var column9:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column9.headerText="Header9";
                    colsArr.push(column9);
                    sampleDG.columns=colsArr;
                    var column10:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column10.headerText="Header10";
                    colsArr.push(column10);
                    sampleDG.columns=colsArr;
                    var column11:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column11.headerText="Header11";
                    colsArr.push(column11);
                    sampleDG.columns=colsArr;
                    var column12:AdvancedDataGridColumn=new AdvancedDataGridColumn();
                    column12.headerText="Header12";
                    colsArr.push(column12);
                    sampleDG.columns=colsArr;
                }
            ]]>
        </fx:Script>
        <mx:Box horizontalAlign="center" width="100%">

        <mx:AdvancedDataGrid id="sampleDG" rowCount="3" width="70%" horizontalScrollPolicy="on" height="300"/>
        </mx:Box>
    </s:Application> 
```

# css - Twitter Bootstrap 网格垂直对齐底部

> ID：12847103
> 
> 赞同：4
> 
> 时间：2012-10-11T19:30:09.310
> 
> 标签：css, twitter-bootstrap

所以我一直在这似乎永远无法弄清楚。由于图像，我有一个包含不同高度内容的网格，我试图让它们全部对齐底部，但没有运气。我已经尝试过我在这里看到的东西，但是没有，在我的 jsfiddle 中评论

[http://jsfiddle.net/qXT6K](http://jsfiddle.net/qXT6K)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T20:00:02.160

这是您想要的（我认为的）小提琴的更新版本：http: [//jsfiddle.net/qXT6K/34/](http://jsfiddle.net/qXT6K/34/)

你在正确的轨道上`position: absolute; bottom: 0;`; 这只是让偏移量正确的问题。

我给容器 div 一个高度只是为了显示底部对齐。你确实需要给它一个高度，否则它的所有孩子都绝对定位，它将默认为 0。

要使容器 div 居中（使其所有子项都居中），您需要使用`margin-left: auto`and `margin-right: auto`（简写`margin: 0 auto`），加上 div 上的设置宽度（`span8`在我的示例中通过类应用），以及删除`float`捆绑的属性到所有`span-`分类的元素中。您还需要`padding-right: 40px`将容器的子项居中，`margin-left: 20px`这也适用于`.span-`s。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:40:48.527

这是你想要的吗？[http://jsfiddle.net/UxYnV/](http://jsfiddle.net/UxYnV/)

**现在更新** 元素居中：http: [//jsfiddle.net/UxYnV/2/](http://jsfiddle.net/UxYnV/2/)

# mysql - 子选择或连接？有没有更好的方法来编写这个 mysql 查询？

> ID：12847116
> 
> 赞同：1
> 
> 时间：2012-10-11T19:30:50.527
> 
> 标签：mysql, sql, query-optimization, sql-optimization

我知道总有更好的方法来做某事，但我不确定如何做？优化此查询的最佳方法是什么？我应该使用联接、单独的查询等吗？我知道这不是一个复杂的查询……只是想扩展我的知识。

任何建议，将不胜感激！

```
SELECT
  community_threads.id AS thread_id,
  community_threads.title AS thread_title,
  community_threads.date AS thread_date,
  community_threads.author_id AS author_id,
  `user`.display_name AS author_name,
  `user`.organization AS author_organization,
  (SELECT date FROM community_replies replies WHERE replies.thread_id = community_threads.id ORDER BY date DESC LIMIT 1) AS reply_date,
  (SELECT   count(id) FROM community_replies replies WHERE replies.thread_id = community_threads.id ORDER BY date DESC LIMIT 1) AS total_replies
FROM
  community_threads
INNER JOIN `user` ON community_threads.author_id = `user`.id
WHERE
  category_id = '1'
ORDER BY
  reply_date DESC
LIMIT 0, 5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:35:27.983

这可以通过`JOIN`针对获取聚合`COUNT()`per`thread_id`和聚合的子选择来改进`MAX(date)`。而不是评估每一行的子选择，派生表应该为整个查询只评估一次，并与来自`community_threads`.

```
SELECT
  community_threads.id AS thread_id,
  community_threads.title AS thread_title,
  community_threads.date AS thread_date,
  community_threads.author_id AS author_id,
  `user`.display_name AS author_name,
  `user`.organization AS author_organization,
  /* From the joined subqueries */
  maxdate.date AS reply_date,
  threadcount.num AS total_replies
FROM
  community_threads
  INNER JOIN `user` ON community_threads.author_id = `user`.id
  /* JOIN against subqueries to return MAX(date) (same as order by date DESC limit 1) and COUNT(*) from replies */
  /* number of replies per thread_id */
  INNER JOIN  (
    SELECT thread_id, COUNT(*) AS num FROM replies GROUP BY thread_id
  ) threadcount ON community_threads.id = threadcount.thread_id
  /* Most recent date per thread_id */
  INNER JOIN (
    SELECT thread_id, MAX(date) AS date FROM replies GROUP BY thread_id
  ) maxdate ON community_threads.id = maxdate.thread_id
WHERE
  category_id = '1'
ORDER BY
  reply_date DESC
LIMIT 0, 5 
```

`LIMIT 0, 5`如果将其放在`reply_date`子查询中，您可能会获得更好的性能。这只会拉取子查询中最近的 5 个，并且`INNER JOIN`将丢弃所有`community_threads`不匹配的内容。

```
/* I *think* this will work...*/
SELECT
  community_threads.id AS thread_id,
  community_threads.title AS thread_title,
  community_threads.date AS thread_date,
  community_threads.author_id AS author_id,
  `user`.display_name AS author_name,
  `user`.organization AS author_organization,
  /* From the joined subqueries */
  maxdate.date AS reply_date,
  threadcount.num AS total_replies
FROM
  community_threads
  INNER JOIN `user` ON community_threads.author_id = `user`.id
  INNER JOIN  (
    SELECT thread_id, COUNT(*) AS num FROM replies GROUP BY thread_id
  ) threadcount ON community_threads.id = threadcount.thread_id
  /* LIMIT in this subquery */
  INNER JOIN (
    SELECT thread_id, MAX(date) AS date FROM replies GROUP BY thread_id ORDER BY date DESC LIMIT 0, 5
  ) maxdate ON community_threads.id = maxdate.thread_id
WHERE
  category_id = '1'
ORDER BY
  reply_date DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:42:06.457

据我所知，这对于一个团体来说似乎是一个很好的机会。

```
SELECT 
    community_threads.id AS thread_id,
    community_threads.title AS thread_title,
    community_threads.date AS thread_date,
    community_threads.author_id AS author_id,
    `user`.display_name AS author_name,
    `user`.organization AS author_organization,
    MAX(replies.date) AS reply_date,
    COUNT(replies.id) AS total_replies
FROM community_threads
INNER JOIN `user` ON community_threads.author_id = `user`.id
INNER JOIN community_replies AS replies ON replies.thread_id = community_threads.id
WHERE category_id = 1
GROUP BY thread_id, thread_title, thread_date, author_id, author_name, author_organization)
ORDER BY reply_date DESC
LIMIT 0, 5 
```

希望这可以帮助。

# c# - 从委托构建 SQL Where 查询

> ID：12847119
> 
> 赞同：2
> 
> 时间：2012-10-11T19:31:09.357
> 
> 标签：c#, linq, expression-trees

我正在开发一个用于从数据库中添加、编辑和删除对象的小帮手，add 方法现在正在工作，并且给定一个类型为 t 的对象，它会检查属性、值并生成一个 SQL 查询来插入数据到表中（假设表名是对象的类型，但也可以手动设置）

我现在想做的是一个方法

```
public bool Update<T>(T obj, Func<T, bool> predicate) 
```

所以给定一个 T **obj**和一个 lambda 函数**predicate**，如果 predicate 是

```
(o => o.Id = 1) 
```

我要生成

```
WHERE Id = 1 
```

我见过一些类似的问题，我认为[表达式树](http://blogs.msdn.com/b/charlie/archive/2008/01/31/expression-tree-basics.aspx)可能是一个很好的起点，但我所看到的只是如何手动创建表达式，而不是如何从委托创建表达式。

有没有办法从委托中生成该 SQL？

编辑：我终于可以做我想做的事了，我在[这里](http://gosukiwi.blogspot.com.ar/2012/10/converting-c-anonymous-functions-to-sql.html)发了一个小帖子。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T19:32:38.057

您应该直接使用表达式：

```
public bool Update<T>(T obj, Expression<Func<T, bool>> predicate) 
```

你会这样称呼它：

```
Update(obj, o => o.Id = 1); 
```

这将为您提供完整的表达式树，然后您可以对其进行解密并转换为您的 SQL。编译器将从 lambda 构建表达式树，就像它对`Func<T,bool>`委托所做的那样。

一旦你有了表达式树，在你的情况下，你应该能够创建一个[ExpressionVisitor](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expressionvisitor.aspx)来解析树，并[找到所有的 Where 语句](https://stackoverflow.com/a/4515615/65358)来转换为你的`WHERE Id = 1`结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:32:18.447

从委托创建表达式树是完全不可能的。

相反，您需要更改方法以获取表达式树。
编译器将允许调用者将 lambda 表达式作为参数传递，该参数将编​​译为表达式树。

# svn - 使用 CruiseControl.net 时将参数传递给 svn

> ID：12847121
> 
> 赞同：2
> 
> 时间：2012-10-11T19:31:20.680
> 
> 标签：svn, cruisecontrol.net, cruisecontrol

我想在使用 CruiseControl.net 时将参数传递给 SVN。我的 ccnet.config 文件中有以下源代码控制块：

```
<sourcecontrol type="svn" username="username" password="password">
    <trunkUrl>https://www.example.com/blah/blah/blah</trunkUrl>
    <workingDirectory>C:\Subversion\blah\</workingDirectory>
</sourcecontrol> 
```

无论如何我可以更改源控制块，以便将一些参数传递给 svn？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T20:11:58.430

我找到了自己的答案。显然，我能弄清楚如何做到这一点的唯一方法是通过添加可执行参数和我这样编写的批处理文件来更改我的源代码控制块：

```
<sourcecontrol type="svn" username="username" password="password" executable="C:\Subversion\blah\mysvn.bat">
    <trunkUrl>https://www.example.com/blah/blah/blah</trunkUrl>
    <workingDirectory>C:\Subversion\blah\</workingDirectory>
</sourcecontrol> 
```

然后在 mysvn.bat 我有：

```
svn %* --trust-server-cert 
```

`--trust-server-cert`我想添加的论点在哪里

# google-apps-script - Web 应用程序正在使用谁的配额？

> ID：12847127
> 
> 赞同：1
> 
> 时间：2012-10-11T19:31:37.287
> 
> 标签：google-apps-script

楼上的大家好，

将 Google Apps 脚本发布为 Web 应用程序时，以访问该应用程序的用户身份执行该应用程序，其配额正在使用中？

我的意思是，正在使用的配额属于谁，属于脚本所有者还是属于访问应用程序的用户？

我只确定 ScriptDb 配额来自脚本所有者，因为 ScriptDb 附加到脚本，但不确定是否有任何其他配额正在使用。

有任何想法吗？

谢谢，福斯托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T19:27:44.977

取决于您要使用 Web 应用程序做什么。如果您的请求用户文件是用户的配额。

如果您使用 scriptDb 它是脚本所有者。

# c# - ASP.net 错误 INSERTING INTO SQL 表

> ID：12847130
> 
> 赞同：0
> 
> 时间：2012-10-11T19:31:48.450
> 
> 标签：c#, asp.net, sql-server-2012

好吧，我已经到了不知道该怎么做的地步了，我之前发布过一个问题，结果是-3 投票结束了这个问题，并且害怕再次发生这种情况让我一直在寻找谷歌搜索直到被抢购......我尝试了很多代码，每次我得到一个错误......

我今天创建了大约 6/7 次数据库并不断更改连接字符串...

我有一个包含 3 个表的数据库，1 个表被调用`Company`，现在我想做的是我想使用 2 个代表`CompName`密码的文本框和一个代表业务类型的下拉列表。

我想用这些在表格中输入信息，有人可以帮我吗

这是我的代码：

```
using System;
using System.Text;
using System.Collections.Generic;
using System.Linq;
using System.Data;
using System.Data.Sql;
using System.Data.SqlClient;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class CompanyLogin : System.Web.UI.Page
{
    protected void Button1_Click(object sender, EventArgs e)
    {
        string ConnectionString =     System.Configuration.ConfigurationManager.ConnectionStrings["MyConncetionString"].ConnectionString;

        string sql = "INSERT INTO company (CompName, BusinessType, Pword) VALUES('" + txtCompName.Text + "','" + DropDownList1.Text + "', '" + txtPassword + "')";
        using (SqlConnection sqlconn = new SqlConnection(ConnectionString))
        {
            sqlconn.Open();

            using (SqlCommand command = new SqlCommand(sql, sqlconn))
            {
                command.ExecuteNonQuery();
            }
        }
    }
} 
```

错误：

> *System.NullReferenceException：对象引用未设置为对象的实例。*

在线的：

```
string ConnectionString = System.Configuration.ConfigurationManager.ConnectionStrings["MyConncetionString"].ConnectionString; 
```

`web.config`：

```
<?xml version="1.0"?>
<configuration>
  <connectionStrings>
     <add name="Varsity_College.tempsConnectionString" 
          connectionString="Data Source=JAUN-   PC\SQLEXPRESS;Initial Catalog=Varsity_College.temps;Integrated Security=True"
          providerName="System.Data.SqlClient" />
  </connectionStrings>
  <system.web>
       ...... (irrelevant) ......
  </system.web>
  <system.webServer>
     <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

我的错误一直指向

> *第 17 行：*
> *字符串 ConnectionString = System.Configuration.ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString;* *

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:35:35.560

你有不匹配

MyConncetionString => 替换为`MyConnectionString`

您可以使用

```
 cmd.CommandText =  "insert into company(CompName, BusinessType, Pword) Values(@CompName,@BusinessType,@Pword);"

    cmd.Parameters.AddWithValue("@CompName", txtCompName.Text);    
    cmd.Parameters.AddWithValue("@BusinessType",DropDownList1.Text);    
    cmd.Parameters.AddWithValue("@Pword",txtPassword );    

    cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:36:36.197

您正在尝试将整个密码文本框传递给它。

```
string sql = "INSERT INTO company (CompName, BusinessType, Pword) VALUES('" +    txtCompName.Text + "','" + DropDownList1.Text + "', '" + txtPassword + "')"; 
```

应该是`txtPassword.Text`或者`txtPassword.Password`如果您使用的是密码字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:47:49.593

您的连接字符串`web.config`称为：

```
<connectionStrings>
   <add name="Varsity_College.tempsConnectionString"  ..... /> 
```

那么这行代码显然**不会**在以下位置找到任何连接字符串`web.config`：

```
string ConnectionString = ConfigurationManager.ConnectionStrings["MyConncetionString"].ConnectionString; 
```

因此，这个表达式是`NULL`：

```
ConfigurationManager.ConnectionStrings["MyConncetionString"] 
```

并尝试访问该表达式的`.ConnectionString`属性`NULL`会导致您看到的错误。

这些名字需要排队！

所以改用这个：

```
string ConnectionString = ConfigurationManager.ConnectionStrings["Varsity_College.tempsConnectionString"].ConnectionString; 
```

然后您应该将在您的 C# 代码中定义的连接***字符串***`web.config`！

**另外：总是**检查可以为空的东西是一个很好的原则- 例如：

```
string ConnectionString = string.Empty;

// get the entry from the config file
var entry = ConfigurationManager.ConnectionStrings["MyConncetionString"];

// **CHECK** if entry is NOT NULL ......
if (entry != null)
{
   // only when sure that it's not NULL - **THEN** access the entry....
   ConnectionString = entry.ConnectionString;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:49:14.197

正如我在评论中所说，您需要在 web.config 的配置标签中添加 ConnectionStrings 标签。

```
<add name="MyConnectionString" connectionString="Data Source=SQLServerNameOrIP;Initial Catalog=DatabaseName;User ID=user;password=****;Network=IDontKnow" providerName="System.Data.SqlClient"/> 
```

一些可能（或可能没有）有用的参考： [web.config 的示例 asp.net 连接字符串](http://www.google.com/url?sa=t&rct=j&q=webconfig%20connectionstrings%20example&source=web&cd=2&cad=rja&ved=0CCcQFjAB&url=https://support.gearhost.com/KB/a317/sample-aspnet-connection-string-for-webconfig.aspx&ei=bSJ3UMm7J4W7iwL2roDwCw&usg=AFQjCNHT6ibTL2hqcg7m1BWDGV1CUbcGog)
[如何：从 Web.config 文件中读取连接字符串](http://msdn.microsoft.com/en-us/library/ms178411%28v=vs.100%29.aspx)

编辑：
这看起来像一个更好的链接：[Storing Database Connection String in Web.Config](http://www.marten-online.com/net/storing-database-connection-string-in-webconfig.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T19:35:46.303

您尝试加载的连接字符串似乎不存在。

你这里有错字`MyConncetionString`吗？（也许是`MyConnectionString`）

# javascript - 在线查找对 CORS 友好的图像

> ID：12847133
> 
> 赞同：1
> 
> 时间：2012-10-11T19:31:52.477
> 
> 标签：javascript, image, cross-domain, webgl, cors

WebGL 只允许使用托管网络服务器明确[允许使用跨域的](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)图像作为纹理。

是否有可以与我的 WebGL 一起使用的图像数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T10:31:25.677

您可以使用支持 CORS 请求的 Google Picasa（来源：[WebGL 启动和运行](https://rads.stackoverflow.com/amzn/click/com/144932357X)第 163 页）。

# vba - 使用 VBA 在 Livelink 中创建文件夹

> ID：12847136
> 
> 赞同：0
> 
> 时间：2012-10-11T19:32:02.440
> 
> 标签：vba, ms-access, outlook, livelink

我正在寻找使用 VBA 在 Livelink 中创建文件夹的最简单、最快的方法。我正在使用 Microsoft Access 2003。例如，我想在`Livelink\Enterprise\folder1\folder2\`. `folder2 LivelinkID`我的Access 数据库中也存储了（7 位数字）。每次我 ping 它时，Livelink 服务器大约需要 1-2 秒来响应。

在我的 VBA 项目中将文件夹创建到 Livelink 中的最佳方法是什么？Livelink 版本是 9.7.1.0.814，带有 Livelink Explorer (Connect) 4.8.2.397，使用 Outlook 2003。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:07:21.563

最后让它与 WebDAV 一起工作。它也可以与 MAPI 一起使用，但是要到达一个深的父文件夹（每次一个文件夹一个文件夹）真的很长。

这是我得到的功能：

```
Public Function CreateFolderToLLFolder(parentId As String, folderName As String) As String
    Dim dav As New ADODB.Record
    Dim elements As ADODB.Recordset
    Dim fields(1) As Variant
    Dim values(1) As Variant

    dav.Open URL_WEBDAV & parentId, "", adModeReadWrite, , , LLUser, LLPassword
    Set elements = dav.GetChildren

    fields(0) = "RESOURCE_PARSENAME"
    values(0) = folderName 

    fields(1) = "RESOURCE_ISCOLLECTION"
    values(1) = True

    elements.addnew fields, values

    elements.Close
    Set elements = dav.GetChildren
    dav.Close

    elements.MoveFirst
    Do Until elements.EOF
        If elements("RESOURCE_DISPLAYNAME") = folderName Then
            Exit Do
        End If
        elements.MoveNext
    Loop
    If Not elements.EOF Then
        dav.Open elements
        CreateFolderToLLFolder = dav("urn:x-opentext-com:ll:properties:nodeid")
    Else
        CreateFolderToLLFolder = -1
    End If

    dav.Close
    elements.Close
Exit Function 
```

URL_WEBDAV 是例如`http://livelink.yourserver.com/livelinkdav/nodes/`. 如果需要，也可以使用`LLUser`和。`LLPassword`

# java - 用于共享计数的 Java 库/API（点赞数、推文数、+1 数）

> ID：12847138
> 
> 赞同：2
> 
> 时间：2012-10-11T19:32:10.773
> 
> 标签：java, facebook, twitter

我见过查询推文计数、分享计数等的个别解决方案：有些是客户端，有些是服务器端，但它们都非常简单，并且使用公共 JSON / REST API

例如

[如何使用图形 API 获取共享计数](https://stackoverflow.com/questions/5699270/how-to-get-share-counts-using-graph-api)

[用于查找推文计数的 jquery 插件或例程](https://stackoverflow.com/questions/5016082/jquery-plugin-or-routine-to-find-tweet-count)

有这个[GitHub 项目](https://github.com/vitobotta/share_counts)，但它是在 Ruby 中的（不幸的是，我需要 Java，尽管我可以使用 JRuby 作为最后的手段）并且在 2 年内也没有更新（就公共 API 而言，这已经是很长时间了，例如 Twitter）

是否有任何 Java 库可以为您提供任何给定 URL 的分享/投票/喜欢/推文计数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T22:33:24.757

使用您选择的语言发出 HTTP GET 请求，如下所示：

[https://graph.facebook.com/fql?q=SELECT%20url,normalized_url,share_count,like_count,comment_count,total_count,commentsbox_count,comments_fbid,click_count%20FROM%20link_stat%20WHERE%20url='http://www.facebook](https://graph.facebook.com/fql?q=SELECT%20url,normalized_url,share_count,like_count,comment_count,total_count,commentsbox_count,comments_fbid,click_count%20FROM%20link_stat%20WHERE%20url=) _ .com/诺基亚

或任何网址：

[https://graph.facebook.com/fql?q=SELECT%20url,normalized_url,share_count,like_count,comment_count,total_count,commentsbox_count,comments_fbid,click_count%20FROM%20link_stat%20WHERE%20url='http://nokia.com](https://graph.facebook.com/fql?q=SELECT%20url,normalized_url,share_count,like_count,comment_count,total_count,commentsbox_count,comments_fbid,click_count%20FROM%20link_stat%20WHERE%20url=) _ '

然后解析 JSON。

将该链接粘贴到浏览器，您将看到 JSON 数据

# php - 多维数组（父母和孩子）

> ID：12847142
> 
> 赞同：0
> 
> 时间：2012-10-11T19:32:22.020
> 
> 标签：php, multidimensional-array, nested

我在带有父母​​和孩子的 MySQL 数据库中有一个类别系统。数据库仅存储其直接父级的 id（如果在 root 上，则为 0）。由于系统允许多个子类别，因此存在多个子类别的情况。

例如

```
[98] Storage
    [1] External
        [3] Pendrives
        [4] Portable hhdds
    [2] Internal
        [5] Sata hhdd
        [6] IDE hhdd
[...]
[99] Clothing 
```

数据库将是

```
id    parent_id    name
1     98           External
2     98           Internal
3     1            Pendrives
4     1            Portable
5     2            Sata
6     2            IDE
98    0            Storage
99    0            Clothing 
```

我还有一个带有类别 ID 的产品表，我需要获取第一级类别中所有产品的列表。

例如：

```
Product   Category
 A          3
 B          4
 C          5
 D          6
 E          74 
```

应该返回 98：A、B、C、D 99：X、Y、Z...

我被卡住了，我想不出以这种方式检索它的逻辑。

我首先通过以下方式获取所有不在第一级的类别的 ID：

```
while ($row = mysql_fetch_assoc($result)) {
    if ($row['parent_id'] != 0) {
        $level1[$i]['name'] = utf8_encode($row['categories_name']);
        $level1[$i]['id'] = $row['categories_id'];
    }

    $i++;
} 
```

但我已经精疲力竭了，想不出一种可以让它们嵌套的方法。我想过一段时间，但它是无限的：P

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:55:04.490

使用递归函数获取所有子类别：

```
//fetch category structure data
$childCategories = array();
$result = mysql_query("SELECT id, parent_id FROM categories");
while ($row = mysql_fetch_assoc($result)) {
    if ($row['parent_id']) {
        if (!isset($childCategories[$row['parent_id']])) $childCategories[$row['parent_id']] = array();
        $childCategories[$row['parent_id']][] = $row['id'];
    }
}

function getRecursiveCategories($id, $childCategories) {
    $ret = array();
    if (!isset($childCategories[$id])) return $ret;
    foreach ($childCategories[$id] as $childId) {
        $ret[] = $childId;
        $ret = array_merge($ret, getRecursiveCategories($childId, $childCategories));
    }
    return $ret;
}

$cateoryIds = getRecursiveCategories(98, $childCategories);

//now you can query the products
"SELECT * FROM products WHERE category_id IN (".implode(',', $cateoryIds).")"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:56:33.143

递归函数调用怎么样？例如：

```
$allItems = Array();
function getAllItems($category) {
    global $allItems;
    $query = mysql_query("SELECT `id` FROM `categories` WHERE `parent_id` = '".$category."' ");

    if(mysql_num_rows($query)) {
        while($cat = mysql_fetch_assoc($query)) {
            $itemQuery = mysql_query("SELECT * FROM `items` WHERE `category` = '".$cat['id']."' ");
            if(mysql_num_rows($itemQuery)) {
                while($item = mysql_fetch_assoc($itemQuery)) {
                    $allItems[$item['id']] = $item; //using $item['id'] to avoid duplicating items if they are in several categories
                }
            }
            $checkSubCatQuery = "SELECT `id` FROM `categories` WHERE `parent_id` = '".$cat['id']."' LIMIT 1");
            if(mysql_num_rows($checkSubCatQuery)) { //Checking to see if we have a sub category
                getAllItems($cat['id']); //Calling agait to get all items from sub cattegory of the current category
            }
        }
    }
} 
```

当然，它总是可以优化的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:47:44.087

我知道一篇关于如何正确执行此操作并在 mysql 中具有良好性能的完美[文章（](http://php.vrana.cz/traverzovani-kolem-stromu-prakticky.php)*我不能相信这个想法，我只是从捷克语翻译它*）。

![数据库布局](../Images/85a5da6ea7bca476bb9f50c3c531c7e9.png)

你需要这样的树结构：

```
categories (
    id,
    lft,  -- index on "left iteration" - number on the left
    rgt,  -- index on "right iteration" - number on the right
    depth,
) 
```

### 如何显示完整的树：

```
$result = mysql_query("SELECT * FROM categories ORDER BY lft");
while ($row = mysql_fetch_assoc($result)) {
    echo str_repeat("- ", $row["depth"]) . htmlspecialchars($row["data"]) . "<br />";
}
mysql_free_result($result); 
```

如果您需要打印一整棵树，只需将其排序`lft`并写下来即可。如果您只需要显示树的一部分，您可以限制两者`lft`并且`rft`确实大于当前节点值。

### 显示在有序列表中：

```
$result = mysql_query("SELECT * FROM categories ORDER BY lft");
$depth = -1;
while ($row = mysql_fetch_assoc($result)) {
    if ($depth < $row["depth"]) {
        echo "<ul>";
    } else {
        echo str_repeat("</li></ul>", $depth - $row["depth"]) . "</li>";
    }
    echo "<li>\n" . htmlspecialchars($row["data"]);
    $depth = $row["depth"];
}
echo str_repeat("</li></ul>", $depth + 1) . "\n";
mysql_free_result($result); 
```

在有序列表（具有多个级别）中显示时，您必须检测当前节点`depth`和下一个项目之间的连接。

### 将其用于“面包屑导航”：

```
$row = mysql_fetch_assoc(mysql_query("SELECT * FROM categories WHERE id = " . intval($_GET["id"])));
$result1 = mysql_query("SELECT * FROM categories WHERE lft < $row[lft] AND rgt > $row[rgt] ORDER BY lft");
while ($row1 = mysql_fetch_assoc($result1)) {
    echo "<a href='?id=$row1[id]'>" . htmlspecialchars($row1["data"]) . "</a> &gt; ";
}
mysql_free_result($result1);
echo htmlspecialchars($row["data"]); 
```

### 将孩子添加到列表的末尾：

```
mysql_query("INSERT INTO categories (lft, rgt, depth, data)
    SELECT IFNULL(MAX(rgt), 0) + 1, IFNULL(MAX(rgt), 0) + 2, 0, '" .         
    mysql_real_escape_string($_POST["data"]) . "' FROM categories"); 
```

### 将子节点添加到您需要的任何位置

```
mysql_query("START TRANSACTION");
$row = mysql_fetch_assoc(mysql_query("SELECT * FROM categories WHERE id = " . intval($_GET["rodic"]) . " FOR UPDATE"));
mysql_query("UPDATE categories SET lft = lft + 2 WHERE lft > $row[rgt]");
mysql_query("UPDATE categories SET rgt = rgt + 2 WHERE rgt >= $row[rgt]");
mysql_query("INSERT INTO categories (lft, rgt, depth, data) VALUES ($row[rgt], $row[rgt]+1, $row[depth]+1, '" . mysql_real_escape_string($_POST["data"]) . "')");
mysql_query("COMMIT"); 
```

### 删除完整的孩子

```
mysql_query("START TRANSACTION");
$row = mysql_fetch_assoc(mysql_query("SELECT * FROM categories WHERE id = " . intval($_GET["id"]) . " FOR UPDATE"));
mysql_query("DELETE FROM categories WHERE lft >= $row[lft] AND rgt <= $row[rgt]");
$rozdil = $row["rgt"] - $row["lft"] + 1;
mysql_query("UPDATE categories SET lft = lft - $rozdil WHERE lft > $row[rgt]");
mysql_query("UPDATE categories SET rgt = rgt - $rozdil WHERE rgt > $row[rgt]");
mysql_query("COMMIT"); 
```

[如果您知道此算法的更多信息（或名称），请告诉我]

*我建议使用 PDO 编写此内容。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T21:34:20.920

遵循以下步骤应该可以解决问题（可以改进算法以提高效率）：

*   首先根据初始类别 ID 进行选择。类似于`SELECT id, parent_id FROM categories`将结果存储在数组中，例如：

    ```
    $catArr = array(
       array(1,98),
       array(2,98),
       ...
      ); 
    ```

*   针对以下函数运行它（注意：$start=98）

    ```
    function getSubsets($catArr, $start) {
       $rtn = array();
       foreach($catArr as $cat) {
          if($cat[1] == $start) { 
             $rtn[] = $cat[0];
             $subcats = getSubsets($catArr,$cat[0]);
             foreach($subcats as $subcat) { $rtn[] = $subcat; }
          }
       }
       return $rtn;
    }

    note: never have a category be its own parent or any other similar 
    conditions that would cause an infinite loop. 
    ```

*   现在你的最终 SQL 可以像这样生成

    ```
     $sql = "SELECT * FROM products WHERE category IN (".implode(',', $rtn).")"; 
     Note: this assumes category is a number 
    ```

最后说明：您只运行两个 SQL 查询 :)

# c# - C# Parallel foreach - System.AggregateException：发生一个或多个错误。---> System.IndexOutOfRangeException

> ID：12847145
> 
> 赞同：4
> 
> 时间：2012-10-11T19:32:39.213
> 
> 标签：c#, multithreading, parallel.foreach

找到了答案，...代码中的错误是我将数据添加到错误的列表中

* * *

我知道这已被问过几次，但我根本无法弄清楚为什么这会出现异常，我是否在某处丢失了锁？

```
var sendsToday = new List<TSend>();

var threads = _maxNumberOfThreads;
if (threads <= 0)
    threads = 1;

Parallel.ForEach(_subscribers,
    new ParallelOptions { MaxDegreeOfParallelism = threads },
    () => new ContentSendLocalStorage<TSend, TMedium>(_contentServices, _logService),
    (subscriber, loopState, localStorage) =>
    {
        localStorage.LogService.Warning(string.Format("Choosing content for subscriber {0}", subscriber.SubscriberId));
        foreach (var newsletterId in subscriber.SubscribedNewsletterIds)
        {
            localStorage.LogService.Warning(string.Format("Choosing content for newsletter {0}", newsletterId));
            var clicks = StateBag.Get<LookupList>(StateKeys.LookupList).Clicks.Where(c => c.Subscriber.SubscriberId == subscriber.SubscriberId).Select(c => c.Content.ContentId).ToArray();

            foreach (var contentService in _contentServices.Where(contentService => contentService.Contents.Count != 0))
            {
                subscriber.UrlsClicked = contentService.Contents
        .Where(c => clicks.Contains(c.ContentId))
        .GroupBy(g => g.Page.Url)
        .ToDictionary(k => k.Key, v => 1);

                var best = contentService.GetBestForSubscriber(subscriber, new TMedium { MediumId = int.Parse(newsletterId) });
                if (best != null)
        sendsToday.Add(best);
            }
        }

        localStorage.LogService.Warning(string.Format("Done choosing content for subscriber {0}", subscriber.SubscriberId));
        return localStorage;
    },
    finalStorage =>
    {
        lock (ContentSendLock)
        {
            sendsToday.AddRange(finalStorage.SubscriberSends);
        }
    }); 
```

我不断收到以下异常：

```
System.AggregateException: One or more errors occurred. ---> System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at System.Collections.Generic.List`1.Add(T item)
   at WFM.Newsletter.Business.CORE.OptimizationEngine`2.<>c__DisplayClassd.<Start>b__4(Subscriber subscriber, ParallelLoopState loopState, ContentSendLocalStorage`2 localStorage)
   at System.Threading.Tasks.Parallel.<>c__DisplayClass21`2.<ForEachWorker>b__1a(Int32 i, ParallelLoopState state, TLocal local)
   at System.Threading.Tasks.Parallel.<>c__DisplayClassf`1.<ForWorker>b__c()
   at System.Threading.Tasks.Task.InnerInvoke()
   at System.Threading.Tasks.Task.InnerInvokeWithArg(Task childTask)
   at System.Threading.Tasks.Task.<>c__DisplayClass7.<ExecuteSelfReplicating>b__6(Object )
   --- End of inner exception stack trace ---
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)
   at System.Threading.Tasks.Parallel.ForWorker[TLocal](Int32 fromInclusive, Int32 toExclusive, ParallelOptions parallelOptions, Action`1 body, Action`2 bodyWithState, Func`4 bodyWithLocal, Func`1 localInit, Action`1 localFinally)
   at System.Threading.Tasks.Parallel.ForEachWorker[TSource,TLocal](TSource[] array, ParallelOptions parallelOptions, Action`1 body, Action`2 bodyWithState, Action`3 bodyWithStateAndIndex, Func`4 bodyWithStateAndLocal, Func`5 bodyWithEverything, Func`1 localInit, Action`1 localFinally)
   at System.Threading.Tasks.Parallel.ForEachWorker[TSource,TLocal](IEnumerable`1 source, ParallelOptions parallelOptions, Action`1 body, Action`2 bodyWithState, Action`3 bodyWithStateAndIndex, Func`4 bodyWithStateAndLocal, Func`5 bodyWithEverything, Func`1 localInit, Action`1 localFinally)
   at System.Threading.Tasks.Parallel.ForEach[TSource,TLocal](IEnumerable`1 source, ParallelOptions parallelOptions, Func`1 localInit, Func`4 body, Action`1 localFinally)
   at WFM.Newsletter.Business.CORE.OptimizationEngine`2.Start()
   at WFM.Newsletter.Business.CORE.OptimizationService.Start(IEnumerable`1 subscribers, IEnumerable`1 newsletters, LookupList lookupList, LocalConfig config, ILogging logService, Int32 maxNumberOfThreads, String subscriberClicksSourceTableName)
---> (Inner Exception #0) System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at System.Collections.Generic.List`1.Add(T item)
   at WFM.Newsletter.Business.CORE.OptimizationEngine`2.<>c__DisplayClassd.<Start>b__4(Subscriber subscriber, ParallelLoopState loopState, ContentSendLocalStorage`2 localStorage)
   at System.Threading.Tasks.Parallel.<>c__DisplayClass21`2.<ForEachWorker>b__1a(Int32 i, ParallelLoopState state, TLocal local)
   at System.Threading.Tasks.Parallel.<>c__DisplayClassf`1.<ForWorker>b__c()
   at System.Threading.Tasks.Task.InnerInvoke()
   at System.Threading.Tasks.Task.InnerInvokeWithArg(Task childTask)
   at System.Threading.Tasks.Task.<>c__DisplayClass7.<ExecuteSelfReplicating>b__6(Object )<---

---> (Inner Exception #1) System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at System.Collections.Generic.List`1.Add(T item)
   at WFM.Newsletter.Business.CORE.OptimizationEngine`2.<>c__DisplayClassd.<Start>b__4(Subscriber subscriber, ParallelLoopState loopState, ContentSendLocalStorage`2 localStorage)
   at System.Threading.Tasks.Parallel.<>c__DisplayClass21`2.<ForEachWorker>b__1a(Int32 i, ParallelLoopState state, TLocal local)
   at System.Threading.Tasks.Parallel.<>c__DisplayClassf`1.<ForWorker>b__c()
   at System.Threading.Tasks.Task.InnerInvoke()
   at System.Threading.Tasks.Task.InnerInvokeWithArg(Task childTask)
   at System.Threading.Tasks.Task.<>c__DisplayClass7.<ExecuteSelfReplicating>b__6(Object )<---

---> (Inner Exception #2) System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at System.Collections.Generic.List`1.Add(T item)
   at WFM.Newsletter.Business.CORE.OptimizationEngine`2.<>c__DisplayClassd.<Start>b__4(Subscriber subscriber, ParallelLoopState loopState, ContentSendLocalStorage`2 localStorage)
   at System.Threading.Tasks.Parallel.<>c__DisplayClass21`2.<ForEachWorker>b__1a(Int32 i, ParallelLoopState state, TLocal local)
   at System.Threading.Tasks.Parallel.<>c__DisplayClassf`1.<ForWorker>b__c()
   at System.Threading.Tasks.Task.InnerInvoke()
   at System.Threading.Tasks.Task.InnerInvokeWithArg(Task childTask)
   at System.Threading.Tasks.Task.<>c__DisplayClass7.<ExecuteSelfReplicating>b__6(Object )<--- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:04:48.180

在您的内部 foreach 中，您将添加到作为 List<> 的 sendToday。这发生在每个线程上。

```
if (best != null)
    sendsToday.Add(best);
} 
```

尝试使用[System.Collections.Concurrent](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.aspx "System.Collections.Concurrent")实现之一（例如 ConcurrentBag），而不是使用 List<>。它为您在内部处理所有锁定，并且专为线程而设计。

```
var sendsToday = new ConcurrentBag<TSend>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T21:39:02.930

找到了答案，我既不需要改变我的逻辑来引入 ConcurrentBag，也没有大容量插入的问题。

代码中的错误是我将数据添加到错误的列表中，即 sendToday.Add(best);

相反，我不得不将它添加到“localstorage”中，由.Net 本身在我的最终存储中使用锁来处理。

所以而不是

```
 if (best != null)
        sendsToday.Add(best); 
```

正确的代码是

```
if (best != null)
localStorage.SubscriberSends.Add(best); 
```

最终存储最终将每个与锁定机制合并。

无论如何感谢所有的支持！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T20:05:18.917

由于生成异常的方法是`List<T>.Add()`我的猜测异常在这里抛出：

```
sendsToday.Add(best); 
```

在列表周围添加一个`lock`访问权限，看看是否有帮助。

# java - 在生产环境中设置 -XX:+DisableExplicitGC：会出现什么问题？

> ID：12847151
> 
> 赞同：46
> 
> 时间：2012-10-11T19:33:08.743
> 
> 标签：java, tomcat, garbage-collection

我们刚刚召开了一次会议，以解决用于计算保险费率的 Web 应用程序中的一些性能问题。计算在 C/C++ 模块中实现，该模块也用于其他软件包。为了使其作为 Web 服务可用，实现了一个 Java 包装器，它公开了一个基于 XML 的接口并通过 JNI 调用 C/C++ 模块。

测量表明，Java 部分内的每个计算都花费了几秒钟。所以我的第一个建议是在 VM 中启用垃圾收集日志记录。我们可以立即看到制作了许多 stop-the-world 的完整 GC。谈到这一点，java 部分的开发人员告诉我们，他们曾`System.gc()`多次“确保内存在使用后被释放”。

好的，我将不再详细说明该声明... ;-)

然后，我们也添加了上述`-XX:+DisableExplicitGC`VMs 参数并重新运行测试。每次计算增加了大约 5 秒。

由于在发布过程中此时我们无法通过剥离所有这些`System.gc()`调用来更改代码，因此我们正在考虑`-XX:+DisableExplicitGC`在生产中添加，直到可以创建一个新的 Jar。

现在的问题是：这样做会有任何风险吗？关于我能想到的唯一一件事是`System.gc()`重新部署时在内部使用tomcat，但这只是一个猜测。前方是否还有其他危险？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-11T19:42:35.997

`-XX:+DisableExplicitGC`通过设置标志来修复 stop-the-world GC 事件的并不孤单。不幸的是（尽管文档中有免责声明），许多开发人员认为他们比 JVM 更清楚何时收集内存并准确引入此类问题。

我知道许多`-XX:+DisableExplicitGC`改进生产环境的实例和零个有任何负面影响的实例。

安全的做法是在负载下运行您当前的生产代码，并在压力测试环境中设置该标志并执行正常的 QA 周期。

如果你不能这样做，我建议在大多数情况下设置标志的风险小于不设置它的成本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-02T16:51:30.600

我一直在努力解决同样的问题，根据我能找到的所有信息，肯定存在一些风险。根据@millimoose 以及[https://bugs.openjdk.java.net/browse/JDK-6200079](https://bugs.openjdk.java.net/browse/JDK-6200079)对您的原始帖子的评论，如果 NIO 直接设置 -XX:+DisableExplicitGC 似乎不是一个好主意正在使用缓冲区。看来它们正在我们正在使用的 Websphere 8.5 应用服务器的内部实现中使用。这是我在调试时能够捕获的堆栈跟踪：

```
3XMTHREADINFO      "WebContainer : 25" J9VMThread:0x0000000006FC5D00, j9thread_t:0x00007F60E41753E0, java/lang/Thread:0x000000060B735590, state:R, prio=5
3XMJAVALTHREAD            (java/lang/Thread getId:0xFE, isDaemon:true)
3XMTHREADINFO1            (native thread ID:0x1039, native priority:0x5, native policy:UNKNOWN)
3XMTHREADINFO2            (native stack address range from:0x00007F6067621000, to:0x00007F6067662000, size:0x41000)
3XMCPUTIME               CPU usage total: 80.222215853 secs
3XMHEAPALLOC             Heap bytes allocated since last GC cycle=1594568 (0x1854C8)
3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at java/lang/System.gc(System.java:329)
4XESTACKTRACE                at java/nio/Bits.syncReserveMemory(Bits.java:721)
5XESTACKTRACE                   (entered lock: java/nio/Bits@0x000000060000B690, entry count: 1)
4XESTACKTRACE                at java/nio/Bits.reserveMemory(Bits.java:766(Compiled Code))
4XESTACKTRACE                at java/nio/DirectByteBuffer.<init>(DirectByteBuffer.java:123(Compiled Code))
4XESTACKTRACE                at java/nio/ByteBuffer.allocateDirect(ByteBuffer.java:306(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/buffermgmt/impl/WsByteBufferPoolManagerImpl.allocateBufferDirect(WsByteBufferPoolManagerImpl.java:706(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/buffermgmt/impl/WsByteBufferPoolManagerImpl.allocateCommon(WsByteBufferPoolManagerImpl.java:612(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/buffermgmt/impl/WsByteBufferPoolManagerImpl.allocateDirect(WsByteBufferPoolManagerImpl.java:527(Compiled Code))
4XESTACKTRACE                at com/ibm/io/async/ResultHandler.runEventProcessingLoop(ResultHandler.java:507(Compiled Code))
4XESTACKTRACE                at com/ibm/io/async/ResultHandler$2.run(ResultHandler.java:905(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/util/ThreadPool$Worker.run(ThreadPool.java:1864(Compiled Code))
3XMTHREADINFO3           Native callstack:
4XENATIVESTACK               (0x00007F61083DD122 [libj9prt26.so+0x13122])
4XENATIVESTACK               (0x00007F61083EA79F [libj9prt26.so+0x2079f])
.... 
```

当使用 NIO 直接字节缓冲区时，设置 -XX:+DisableExplicitGC 的全部后果对我来说尚不完全清楚（这是否会导致内存泄漏？），但至少看起来确实存在一些风险那里。如果您使用的是 Websphere 以外的应用服务器，您可能需要在禁用它之前验证应用服务器本身没有通过 NIO 调用 System.gc()。我有一个相关的问题，希望能澄清对 NIO 库的确切影响[：使用 NIO 直接缓冲区时设置 -XX:+DisableExplicitGC 的影响](https://stackoverflow.com/questions/32912702/impact-of-setting-xxdisableexplicitgc-when-nio-direct-buffers-are-used)

顺便说一下，Websphere 在启动过程中似乎也多次手动调用 System.gc()，通常在应用服务器启动后的前几秒钟内调用两次，在前 1-2 分钟内调用第三次（可能是在应用程序启动时）正在部署）。在我们的案例中，这就是我们首先开始调查的原因，因为看起来所有 System.gc() 调用都直接来自应用服务器，而不是来自我们的应用程序代码。

还需要注意的是，除了 NIO 库，RMI 分布式垃圾回收的 JDK 内部实现也调用 System.gc(): [Unexplained System.gc() calls due to Remote Method Invocation](http://www-01.ibm.com/support/docview.wss?uid=swg21173431) [System.gc() call by core蜜蜂](https://stackoverflow.com/questions/6941802/system-gc-calls-by-core-apis)

我也不清楚启用 -XX:+DisableExplicitGC 是否也会对 RMI DGC 造成严重破坏。我能找到的唯一参考，甚至解决了这个问题是上面的第一个参考，它指出

> “但是，在大多数情况下，常规 GC 活动足以实现有效的 DGC”

那个“在大多数情况下”限定符对我来说听起来非常不切实际，所以再一次，似乎至少有一些风险只是关闭所有 System.gc() 调用，你最好修复你的调用尽可能编写代码，并且仅将它们完全关闭作为最后的手段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T19:50:26.890

如果您使用`-XX:+DisableExplicitGC` **和**使用 CMS，您可能还想使用`-XX:+CMSClassUnloadingEnabled`以及限制完全 GC 的另一个原因（即 PermGen 已满）。除此之外，我在使用该选项时没有遇到任何问题，尽管我已经切换到 using `-XX:+ExplicitGCInvokesConcurrentAndUnloadsClasses`，因为我显式 GC 的唯一原因是 RMI，而不是应用程序代码。

# android - Android：将文本复制到 API < 11 的剪贴板

> ID：12847152
> 
> 赞同：8
> 
> 时间：2012-10-11T19:33:18.497
> 
> 标签：android, text, copy, clipboard

我在将文本复制到剪贴板时遇到问题。我尝试这样复制：

```
android.content.ClipboardManager clipboard = ( android.content.ClipboardManager ) getSystemService(Context.CLIPBOARD_SERVICE ); 
android.content.ClipData clip = android.content.ClipData.newPlainText( "text label", "text to clip" );
clipboard.setPrimaryClip( clip ); 
```

但问题出在编译器中，它抛出：

```
Call requires API level 11 (current min is 7): android.content.ClipboardManager#setPrimaryClip line 245 Android Lint Problem. 
```

如何在 android API < 11 上将文本复制到剪贴板？如果我在复制之前尝试检查 android 的 API 版本 - 我的代码甚至无法编译。也许有人知道这个问题的答案？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-11T20:09:47.070

参考：[如何在我的 Android 应用程序中以编程方式复制文本](https://stackoverflow.com/a/11012443/801437)

```
int sdk = android.os.Build.VERSION.SDK_INT;
if(sdk < android.os.Build.VERSION_CODES.HONEYCOMB) {
    android.text.ClipboardManager clipboard = (android.text.ClipboardManager) getSystemService(Context.CLIPBOARD_SERVICE);
    clipboard.setText("text to clip");
} else {
    android.content.ClipboardManager clipboard = (android.content.ClipboardManager) getSystemService(Context.CLIPBOARD_SERVICE); 
    android.content.ClipData clip = android.content.ClipData.newPlainText("text label","text to clip");
    clipboard.setPrimaryClip(clip);
} 
```

**补充：** 您可能需要清理和构建您的项目:)

# ajax - ASP MVC 嵌套数组模型绑定

> ID：12847154
> 
> 赞同：2
> 
> 时间：2012-10-11T19:33:24.947
> 
> 标签：ajax, asp.net-mvc, asp.net-mvc-3

我有以下简单模型：

```
public class MainModel
{
    public int Id {get;set;}
    public List<Question> Questions {get;set;}
}

public class Question
{
    public string Text {get;set;}
    public List<Answer> Answers {get;set;}
}

public class Answer
{
    public byte No {get;set;}
    public string Text {get;set;}
    public bool Correct {get;set;}
} 
```

我有 MainModel 的强类型视图，它允许用户为每个问题添加自定义数量的问题和答案（并删除它们）。

我正在使用添加隐藏索引字段的方法，它适用于问题级别（动态添加的问题包含在 POST 中）。但是，当涉及到动态添加的答案时，它无法正常工作。这是我渲染的 HTML：

```
<div class="answer">
<input type="hidden" value="1" name="Questions[2].Answers.Index">
<input type="checkbox" data-checkbox-for="Questions[2].Answers[1].Correct" checked="checked">
<input type="hidden" value="1" name="Questions[2].Answers[1].No">
<input type="text" value="2.1" name="Questions[2].Answers[1].Text">
<input type="hidden" value="true" name="Questions[2].Answers[1].Correct">
<span class="remove-answer link">Remove</span>
</div> 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:17:16.653

你从零索引开始吗？

```
 <div class="answer">
<input type="hidden" value="1" name="Questions[2].Answers.Index">
<input type="checkbox" data-checkbox-for="Questions[2].Answers[0].Correct" checked="checked">
<input type="hidden" value="1" name="Questions[2].Answers[0].No">
<input type="text" value="2.1" name="Questions[2].Answers[0].Text">
<input type="hidden" value="true" name="Questions[2].Answers[0].Correct">
<span class="remove-answer link">Remove</span> 
```

如果你不从 0 开始计数，你将不会得到任何 post 值，因为 mvc 想要索引 0 在索引 1 之前

并且以下属性不在您的模型中，是吗？

```
<input type="hidden" value="1" name="Questions[2].Answers.Index"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-29T18:05:50.693

这是解决这个问题的方法：

[模型绑定到 ASP.NET MVC 中的对象列表](http://www.binaryintellect.net/articles/b1e0b153-47f4-4b29-8583-958aa22d9284.aspx)

确保使用*某种*`randomness`. 这样，您可以在各种索引值之间产生“间隙”。

像这样的东西：

```
var random = new Random(10);
var rnd = random.Next();

@Html.Hidden("Questions[" + (i) + "].Answers.Index", i + j + rnd)
@Html.TextBox("Questions[" + (i) + "].Answers[" + (i + j + rnd) + "].Text", Model.Questions[i].Answers[j].Text, new { @class = "form-control" }) 
```

# wpf - WPF TextBox 如何“知道” KeyDown 事件已被处理

> ID：12847157
> 
> 赞同：3
> 
> 时间：2012-10-11T19:33:46.000
> 
> 标签：wpf, textbox, event-bubbling

我注意到当一个窗口正在处理由其中的文本框引发的 KeyDown 事件并将事件 Handled 标志设置为 true 时，文本框会忽略按下的键并且不会将其添加到其内容中。

根据我对事情如何工作的理解，PreviewKeyDown 事件如果首先从窗口隧道到 TextBox，然后 KeyDown 事件从 TextBox 冒泡到窗口。当窗口的事件处理程序开始设置 Handled 事件时，该事件不再由 TextBox 处理，但我确实看到它有效果，并且按下的键不会添加到 TextBox。

有人可以解释这是如何工作的吗？

（这是一个普遍的问题，但在我看到我们正在使用的第三方控件中的类似行为后提出，这给我带来了问题，因为我希望控件处理事件但阻止它向上冒泡。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:42:14.673

好吧，实际上，无论是否处理，这些事件总是会冒泡/隧道。只是大多数事件处理程序都没有注册以接收“已处理”事件。

例如，可以选择订阅 KeyDown 事件并接收“呼叫”，即使它是在某个地方处理的。

但是，是的，事件的顺序通常是从顶部（隧道）开始，然后隧道回到元素并冒泡。

如果您有更多问题，请告诉我。

# c++ - CRichEditCtrl 和箭头键

> ID：12847168
> 
> 赞同：0
> 
> 时间：2012-10-11T19:34:33.220
> 
> 标签：c++, mfc

有没有办法在派生的 CRichEditCtrl 类中捕获箭头键？我请求所有键并捕获 OnGetCode() 和 OnChar() 命令。

```
UINT MyRichEditCtrl::OnGetDlgCode()
{
   return CRichEditCtrl::OnGetDlgCode() | DLGC_WANTALLKEYS;
} 
```

和

```
void MyRichEditCtrl::OnChar(UINT nChar, UINT nRepCnt, UINT nFlags)
{
   CRichEditCtrl::OnKeyDown(nChar, nRepCnt, nFlags);
   ...    
} 
```

我在消息映射中匹配它们..

```
BEGIN_MESSAGE_MAP(MyRichEditCtrl, CRichEditCtrl)
   ON_WM_CHAR()
   ON_WM_GETDLGCODE()
END_MESSAGE_MAP() 
```

我得到了大多数键，但没有箭头键。我对 OnKeyDown 和 OnKeyUp 事件也得到了相同的结果。还有其他方法可以获取方向键吗？

具体来说，我有兴趣知道当前光标位置的字符是否是括号。用户可以通过键入字符、用鼠标单击编辑控件中的某处或用箭头键移动光标位置来更改光标位置。我在想是否可以检测到箭头键，然后我可以找出光标是否在括号中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:07:29.537

您的示例代码似乎错误。`OnChar`应该打电话`CRichEditCtrl::OnChar`。我猜你是在你的真实代码中做到这一点的。

无论如何，`OnKeyDown`这就是您要查找的内容（箭头键不是字符）。因此，添加`ON_WM_KEYDOWN()`到您的消息映射并覆盖`OnKeyDown`. 寻找例如`VK_LEFT`和`VK_RIGHT`。

但是......你的方法是错误的。你需要的是[CharFromPos](http://msdn.microsoft.com/en-us/library/kfbzb9hb%28v=vs.100%29.aspx)：

```
CPoint pt = GetCaretPos();
int wordLocation = CharFromPos(pt); 
```

# visual-studio - StyleCop 拼写规则和超链接

> ID：12847170
> 
> 赞同：7
> 
> 时间：2012-10-11T19:34:45.703
> 
> 标签：visual-studio, coding-style, stylecop

有没有办法禁用 StyleCop 对超链接的拼写检查？我真的很喜欢规则功能，但它抱怨我的很多超链接中的单词拼写错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T05:46:02.440

我为此找到了两种可能的解决方法：

**1) 尝试使用 CamelCase 您的超链接。**

我对这种方法有几个问题。首先，如果可能的话，我喜欢我所有的超链接都是小写的；我对此有强迫症。其次（更重要的是），某些超链接的案例很重要。所以这样做是为了克服样式错误，但可能会破坏你的超链接。

**2）将您的超链接放入`<see href=""/>`标签内。**

我发现 StyleCop 在这种情况下不会尝试强制执行它的拼写检查功能。

# java - 在任何文本字段上按回车键返回按钮单击

> ID：12847172
> 
> 赞同：1
> 
> 时间：2012-10-11T19:34:57.770
> 
> 标签：java, swing, jbutton, key-bindings, keystroke

我有一个带有登录按钮的简单 jFrame，我试图通过按 enter 键来触发我的 ActionPerformed 事件。我不想先按“标签”来聚焦按钮，但只要有人按下回车键，它就会触发。我在这里想念什么？

编辑：如果这样做更容易，它也可能在焦点位于“PasswordField”时触发事件，因为这是按下登录按钮之前具有焦点的最后一个字段

根据要求。下面是 loginGUI 的完整代码：

```
package unive.facturatie.boundary;

import java.awt.event.KeyEvent;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JRootPane;
import javax.swing.KeyStroke;
import unive.facturatie.control.LoginManager;

/**
 *
 * @author Forza
 */
public class LoginGUI extends javax.swing.JFrame {

JFrame frame = new JFrame();
JRootPane rootPane = frame.getRootPane();
//JButton inloggenButton = new JButton("Login");
//frame.getRootPane().setDefaultButton(inloggenButton);

/**
 * Creates new form LoginGUI
 */
public LoginGUI() {
    frame.getRootPane().setDefaultButton(inloggenButton);
     try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(LoginGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(LoginGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(LoginGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(LoginGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }

    initComponents();
    this.setLocation(320, 160);
}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">
private void initComponents() {

    inlogLabel = new javax.swing.JLabel();
    gebruikersnaamLabel = new javax.swing.JLabel();
    wachtwoordLabel = new javax.swing.JLabel();
    gebruikersnaamTextField = new javax.swing.JTextField();
    wachtwoordPasswordField = new javax.swing.JPasswordField();
    inloggenButton = new javax.swing.JButton();

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
    setTitle("Facturatie inlogscherm");

    inlogLabel.setFont(new java.awt.Font("Tahoma", 0, 36)); // NOI18N
    inlogLabel.setText("Inloggen");

    gebruikersnaamLabel.setText("Gebruikersnaam:");

    wachtwoordLabel.setText("Wachtwoord:");

    wachtwoordPasswordField.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            wachtwoordPasswordFieldActionPerformed(evt);
        }
    });

    inloggenButton.setText("Inloggen");
    inloggenButton.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            inloggenButtonActionPerformed(evt);
        }
    });
    inloggenButton.addKeyListener(new java.awt.event.KeyAdapter() {
        public void keyPressed(java.awt.event.KeyEvent evt) {
            inloggenButtonKeyPressed(evt);
        }
    });

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addContainerGap()
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(inlogLabel)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(inloggenButton)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(gebruikersnaamLabel)
                            .addComponent(wachtwoordLabel))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(gebruikersnaamTextField, javax.swing.GroupLayout.DEFAULT_SIZE, 171, Short.MAX_VALUE)
                            .addComponent(wachtwoordPasswordField)))))
            .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addContainerGap()
            .addComponent(inlogLabel)
            .addGap(18, 18, 18)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(gebruikersnaamLabel)
                .addComponent(gebruikersnaamTextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(wachtwoordLabel)
                .addComponent(wachtwoordPasswordField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
            .addComponent(inloggenButton)
            .addContainerGap(25, Short.MAX_VALUE))
    );

    pack();
}// </editor-fold>

private void inloggenButtonActionPerformed(java.awt.event.ActionEvent evt) {                                               
    //frame.getRootPane().setDefaultButton(inloggenButton);
    boolean isValid = false;
    String username = gebruikersnaamTextField.getText();
    String password = wachtwoordPasswordField.getText();

    LoginManager loginManager = new LoginManager();
    isValid = loginManager.Inloggen(username, password);
    if (isValid == true)
    {
        new MainGUI().setVisible(true);
        dispose();
    }
    else
    {
        JOptionPane.showMessageDialog(frame, "Gebruikersnaam en/of wachtwoord onjuist!", "Insane error", JOptionPane.ERROR_MESSAGE);
    }
}                                              

private void inloggenButtonKeyPressed(java.awt.event.KeyEvent evt) {                                          
      //frame.getRootPane().setDefaultButton(inloggenButton);
      //inloggenButton.registerKeyboardAction(inloggenButton.getActionForKeyStroke(
      //KeyStroke.getKeyStroke(KeyEvent.VK_SPACE, 0, false)),
      //KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0, false),
      //JButton.WHEN_IN_FOCUSED_WINDOW);

      //inloggenButton.registerKeyboardAction(inloggenButton.getActionForKeyStroke(
      //KeyStroke.getKeyStroke(KeyEvent.VK_SPACE, 0, true)),
      //KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0, true),
      //JButton.WHEN_IN_FOCUSED_WINDOW);

}                                         

private void wachtwoordPasswordFieldActionPerformed(java.awt.event.ActionEvent evt) {
    // TODO add your handling code here:
}

// Variables declaration - do not modify
private javax.swing.JLabel gebruikersnaamLabel;
private javax.swing.JTextField gebruikersnaamTextField;
private javax.swing.JLabel inlogLabel;
private javax.swing.JButton inloggenButton;
private javax.swing.JLabel wachtwoordLabel;
private javax.swing.JPasswordField wachtwoordPasswordField;
// End of variables declaration
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T20:02:36.510

这很简单：

```
JFrame frame = new JFrame();
JButton btn = new JButton("Login");
frame.getRootPane().setDefaultButton(btn); 
```

而已。您不需要`KeyListener`, *registerKeyBoardAction*或*getKeyStroke* ...只需`ActionEvent`为您的按钮设置一个并将该按钮设置为默认值。窗口打开时按**Enter**将激活默认按钮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T22:30:03.583

Here's **A** problem...

Your class extends from `JFrame`

```
public class LoginGUI extends javax.swing.JFrame { 
```

But then you create ANOTHER frame within it...

```
JFrame frame = new JFrame();
JRootPane rootPane = frame.getRootPane(); 
```

Then in the constrcutor, you register your button against the "fake" reference

```
public LoginGUI() {
    frame.getRootPane().setDefaultButton(inloggenButton); 
```

**UPDATED**

This works just fine...

```
public class TestDefaultButton {

    public static void main(String[] args) {
        new TestDefaultButton();
    }

    public TestDefaultButton() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestForm());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    protected class TestForm extends JPanel {

        private JButton myDefault;
        private JTextField myText;

        public TestForm() {
            myDefault = new JButton("By Default");
            myDefault.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    JOptionPane.showMessageDialog(TestForm.this, "By default");
                }
            });

            myText = new JTextField(12);

            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.insets = new Insets(8, 8, 8, 8);

            add(myText, gbc);

            gbc.gridy++;
            add(myDefault, gbc);
        }

        @Override
        public void addNotify() {
            super.addNotify();
            SwingUtilities.getRootPane(this).setDefaultButton(myDefault);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-19T09:42:43.397

在我的项目中，我使用 netbeans 使用这个简单的代码：

```
 private void txt_passwordKeyPressed(java.awt.event.KeyEvent evt)
    {                                    
        if (evt.getKeyCode()==KeyEvent.VK_ENTER){
        btn_login.doClick();
        }
    } 
```

# java - 拖放移位

> ID：12847175
> 
> 赞同：3
> 
> 时间：2012-10-11T19:35:10.967
> 
> 标签：java, android, drag-and-drop, imageview

我一直在使用拖放编写一个简单的应用程序，除了一些细节外，效果很好。当我第一次持有包含拖动操作的 ImageView 时，DragShadowBuilder 将微型视图放置在错误的位置。最奇怪的是，后来它自己修复了，并且运行得很好。这是显示行为的图像（我拿着联系人应用程序图标，看看缩略图在哪里）

![流离失所](../Images/2b29ea8e98d50809e68b533318f251a8.png)

这是我使用的代码

```
 View v = inflater.inflate(R.layout.recent_entry, null);
        ImageView img = (ImageView)v.findViewById(R.id.recent_icon);

        img.setOnTouchListener(new View.OnTouchListener(){

            @Override
            public boolean onTouch(View view, MotionEvent me) {
                if (me.getAction() == MotionEvent.ACTION_DOWN){
                    DragShadowBuilder shadowBuilder = new View.DragShadowBuilder(view);
                    view.startDrag(null, shadowBuilder, null, 0);
                    mLaunchIntent = holder.getLaunchIntent();
                    mSelectedItem = view;
                    mRecentDetails.setVisibility(View.GONE);
                }
                return true;
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T02:45:03.140

纯粹是猜测，但您不应该使用拖动源的位置，而不是包含拖动内容的视图吗？

# variables - 用委托定义全局变量

> ID：12847182
> 
> 赞同：1
> 
> 时间：2012-10-11T19:35:31.473
> 
> 标签：variables, delegates, global

是否可以在 Javascript 中声明全局变量并填充到委托函数中？我有一个指向委托函数的函数。问题是不能在委托函数中引用或填充全局变量。在此示例中，userName 始终为 null。调用 getUserInfo 可以正常工作并在警报中正确显示，但永远不会填充变量。

```
var userName = null;

function getUserInfo() 
{         
clientContext = new SP.ClientContext.get_current()        
oWeb = clientContext.get_web();        
user = oWeb.get_currentUser();        
clientContext.load(user);        
clientContext.executeQueryAsync(Function.createDelegate(this,   this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));    
}     
function onQuerySucceeded() 
{        
    var message = "User Information";        
    message += "\n User Name: " + user.get_title();     
    userName = user.get_title();
    message += "\n Login Name: " + user.get_loginName();                   
}     
function onQueryFailed(sender, args) 
{        
    alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());    
} 
```

# java - APT 如何处理嵌套注释类的注释

> ID：12847187
> 
> 赞同：6
> 
> 时间：2012-10-11T19:35:48.813
> 
> 标签：java, annotations, nested, apt, annotation-processing

我正在尝试使用 java 编写注释处理器。该注释处理器需要识别注释类中的注释嵌套类，如下所示。我将首先处理带注释的类，然后处理它们的内部注释。这是在编译时执行的，我将不知道正在处理的类。Foo 中可以有多个嵌套类。如何处理所有这些嵌套类的注释。

```
@MyAnnotation(value="Something important")
public class Foo
{
    private Integer A;

    @MyMethodAnnotation(value="Something Else")
    public Integer getA() { return this.A; }

    @MyAnnotation(value="Something really important")
    private class Bar
    {
        private Integer B;

        @MyMethodAnnotation(value="Something Else that is very Important")
        public Integer getB() { return this.B }     
    }
} 
```

如何在处理过程中访问嵌套的 Bar 类、注释“MyAnnotation”及其“MyMethodAnnotation”？下面的代码只打印出关于类 Foo 的信息。如何处理有关 Bar 的信息？

```
for (Element element : env.getElementsAnnotatedWith(MyAnnotation.class)) {
    if ( element.getKind().equals(ElementKind.CLASS) )
    {
        System.out.println(element.getKind().name() + " " + element.getSimpleName() );
        processInnerClassElement(element);
    }
    else
    {
        System.out.println(element.getKind().name() + " " + element.getSimpleName() );
    }    
}

...

private void processInnerClassElement(Element element)
{
    for (Element e : element.getEnclosedElements() )
    {
        if ( e.getKind().equals(ElementKind.CLASS) )
        {
            System.out.println(e.getKind().name() + " " + e.getSimpleName() );
            processInnerClassElement(e);
        }
        else
        {
            System.out.println(e.getKind().name() + " " + e.getSimpleName()  );
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T23:14:34.403

我想这取决于这些注释如何相互关联。

您可以简单地在 @SupportedAnnotationTypes 中声明所有注释，并在流程方法中有几个块，例如：

```
for (Element element : roundEnv.getElementsAnnotatedWith(MyAnnotation.class)) {
    MyAnnotation myAnnotation = element.getAnnotation(MyAnnotation.class);
    if (myAnnotation != null) {
        doSomething(myAnnotation, element);
    }
}

for (Element element : roundEnv.getElementsAnnotatedWith(MyMethodAnnotation.class)) {
    MyMethodAnnotation myMethodAnnotation = element.getAnnotation(MyMethodAnnotation.class);
    if (myMethodAnnotation != null) {
        doSomething(myMethodAnnotation, element);
    }
} 
```

否则，您可能能够使用`element.getEnclosedElements()`并`element.getEnclosingElement()`实现您想要的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-11T20:02:15.527

您将需要一些方法[`Class`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html)来[`Method`](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Method.html)执行此操作，特别是获取在 中声明的`Foo`类、这些类上的注释、这些类中声明的方法以及这些方法上的注释。这是一个简单的例子：

```
public static void main(String... args) {
    for (Class<?> declaredClass : Foo.class.getDeclaredClasses()) {
        MyAnnotation myAnnotation = declaredClass.getAnnotation(MyAnnotation.class);
        // Process value of class annotation here
        for (Method method : declaredClass.getDeclaredMethods()) {
            MyMethodAnnotation myMethodAnnotation = method.getAnnotation(MyMethodAnnotation.class);
            // Process value of method annotation here
        }
    }
} 
```

阅读有关 Java 反射的文档可能会很有见地：http: [//docs.oracle.com/javase/tutorial/reflect/index.html](http://docs.oracle.com/javase/tutorial/reflect/index.html)

# r - 制作成对的倒置直方图

> ID：12847196
> 
> 赞同：4
> 
> 时间：2012-10-11T19:36:16.630
> 
> 标签：r, ggplot2

我想在一组不同的测试中为两组制作成对的点图直方图，两组在 y 轴上以相反的方向显示。使用这个简单的数据集

```
dat <- data.frame(score = rnorm(100), group = rep(c("Control", "Experimental"), 50), test = rep(LETTERS[1:2], each=50)) 
```

我可以像这样制作多面点图

```
ggplot(dat, aes(score, fill=group)) + facet_wrap(~ test) + geom_dotplot(binwidth = 1, dotsize = 1) 
```

![多面点图示例](../Images/bf90e94e87fd5bba3ea83f306895a222.png)

但我希望控制点指向下方而不是向上。使用[这个问题和答案](https://stackoverflow.com/questions/7579995/facet-grid-of-back-to-back-histogram-failing)，我可以制作一个看起来或多或少像我想要的直方图版本

```
ggplot() + 
  geom_histogram(data=subset(dat, group=="Experimental"), aes(score, fill="Experimental", y= ..count..)) +
  geom_histogram(data=subset(dat, group=="Control"), aes(score, fill="Control", y= -..count..)) +
  scale_fill_hue("Group") 
```

![成对的倒置直方图](../Images/a5795c8909c334fd18db86878d1210a2.png) 但现在刻面消失了。我知道我可以使用 手动进行刻面`grid.arrange`，但这会很费力（我的实际数据集有很多测试，而不仅仅是 2 个），有没有更优雅的解决方案？

两个后续问题：

1.  `geom_histogram`给我一个警告，上面写着“当 ymin != 0 时堆叠定义不明确”。有谁知道它是如何“定义不明确”的？换句话说，这是我应该关心的事情吗？
2.  我更喜欢使用点图而不是直方图，但反转似乎不适用于点图。这是为什么？任何想法如何让它工作？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:20:02.453

仔细阅读`geom_dotplot`会带来好处：

```
ggplot() +
  facet_wrap(~test) +
  geom_dotplot(data=subset(dat, group=="Experimental"), aes(score, fill="Experimental")) +
  geom_dotplot(data=subset(dat, group=="Control"), aes(score, fill="Control"),stackdir = "down") +
  scale_fill_hue("Group") 
```

![在此处输入图像描述](../Images/7e88633490b2af57443a2a395c995065.png)

我不知道`stackdir`我头脑中的争论。我必须查一下！

# javascript - 如果输入具有带有文本缩进的隐藏文本，则jQuery滚动鼠标滚轮

> ID：12847199
> 
> 赞同：0
> 
> 时间：2012-10-11T19:36:28.573
> 
> 标签：javascript, jquery

我有

```
<input type="text" readonly="readonly" style="width: 50px" value="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus viverra ullamcorper tellus, in varius erat mollis in. Suspendisse condimentum turpis sit amet tortor bibendum cursus lobortis enim posuere." /> 
```

文本比输入宽度长，查看它的唯一方法是选择隐藏的文本。

有没有办法检测鼠标滚轮的向上/向下滚动并更改`text-indent`？

我不希望这影响选择文本的能力，例如我想复制/粘贴一个单词“Phasellus”。

如果这适用于触摸屏设备也很好。

[jsFiddle](http://jsfiddle.net/v4g8X/)

1.  如果文本隐藏（长于输入宽度+填充+边框），它只需要文本缩进
2.  使其不可能滚动太多并且文本完全隐藏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:45:54.047

您可以使用 jquery 鼠标滚轮事件。你可以使用[这个](http://brandonaaron.net/code/mousewheel/demos)插件来上下鼠标滚轮

```
$("input").on('mousewheel', function(event, delta) {
        var dir = delta > 0 ? 'Up' : 'Down',
            vel = Math.abs(delta);
        $(this).text(dir + ' at a velocity of ' + vel);
        return false;
 }); 
```

# ruby - Ruby SFTP 返回“Net::SSH::Disconnect: disconnected: Failed to read binary packet data!(2)”

> ID：12847202
> 
> 赞同：2
> 
> 时间：2012-10-11T19:36:45.233
> 
> 标签：ruby, ssh, ftp, sftp, net-sftp

我在 ruby​​ 1.9.3 中有这个：

```
Net::SFTP.start(ENV['SFTP_HOST'], ENV['SFTP_USERNAME'], password: ENV['SFTP_PASSWORD'], key_data: [ENV['SFTP_KEY']], keys_only: true) do |sftp|
  sftp.upload!(StringIO.new("testing"), "/text.txt")
end 
```

它似乎正确地执行了身份验证步骤（我可以列出目录等中的文件）但是当我执行`upload!`上面的命令时它返回：

```
Net::SSH::Disconnect: disconnected: Failed to read binary packet data! (2)
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-ssh-2.5.2/lib/net/ssh/transport/session.rb:176:in `block in poll_message'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-ssh-2.5.2/lib/net/ssh/transport/session.rb:166:in `loop'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-ssh-2.5.2/lib/net/ssh/transport/session.rb:166:in `poll_message'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-ssh-2.5.2/lib/net/ssh/connection/session.rb:451:in `dispatch_incoming_packets'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-ssh-2.5.2/lib/net/ssh/connection/session.rb:213:in `preprocess'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-ssh-2.5.2/lib/net/ssh/connection/session.rb:197:in `process'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-ssh-2.5.2/lib/net/ssh/connection/session.rb:161:in `block in loop'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-ssh-2.5.2/lib/net/ssh/connection/session.rb:161:in `loop'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-ssh-2.5.2/lib/net/ssh/connection/session.rb:161:in `loop'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-sftp-2.0.5/lib/net/sftp/session.rb:802:in `loop'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-sftp-2.0.5/lib/net/sftp/operations/upload.rb:195:in `wait'
from /Users/barmstrong/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/net-sftp-2.0.5/lib/net/sftp/session.rb:103:in `upload!' 
```

我也试过

```
 # open and write to a pseudo-IO for a remote file
    sftp.file.open("/test.txt", "wb") do |f|
      f.puts "testing"
    end 
```

尝试编写二进制文件，但没有运气。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T01:42:33.443

好吧，我找到了一个解决方案，但我不知道它为什么会起作用。

只是在玩`sftp.dir.foreach("/") {|e| puts e.name }`之前我添加了`upload!`它，它起作用了！

所以它现在看起来像这样。

```
Net::SFTP.start(ENV['SFTP_HOST'], ENV['SFTP_USERNAME'], password: ENV['SFTP_PASSWORD'], key_data: [ENV['SFTP_KEY']], keys_only: true) do |sftp|
  sftp.dir.foreach("/") {}
  sftp.upload!(StringIO.new("testing"), "/text.txt")
end 
```

做一个`dir`不应该有任何影响，但出于某种原因它确实。如果有人对此有一些见解，我会很好奇。谢谢！

顺便说一句，ftp 服务器将自己标识为“SSH-2.0-Maverick_SSHD”，因为它的价值。

# android - 使用 Google API 是否会限制 Android 设备支持？

> ID：12847209
> 
> 赞同：2
> 
> 时间：2012-10-11T19:37:19.910
> 
> 标签：android

我的公司有一个在 Android 上运行的企业客户端/服务器应用程序。我正在添加一个包含 MapView 的功能。我正在尝试决定是否应该使用谷歌地图或其他地图服务。

我对 Google Maps 的担忧是它需要 Google API。这些 API 似乎包含在所有 Google 批准的 Android 版本中，但这对我们来说可能过于局限。我们不希望一项功能限制我们可以支持的设备。我特别担心亚马逊可能会远离谷歌地图。这可能会阻止我们在 Kindle Fire 上运行。

我看过 OpenStreetMap，但质量似乎比谷歌低一两个档次。

总而言之，我正在寻找以下方面的指导：

1.  我认为 Google API 可能会限制我们可以支持的 Android 设备是否正确？
2.  我可以将 Google API 与我们的 Android 应用程序捆绑在一起，从而确保它们存在于设备上吗？这是其他第 3 方软件的模型。
3.  谁能建议一个合理的替代谷歌地图的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:03:48.460

1.  是的，Google 地图无法在 kindle fire 上运行
2.  你不能捆绑它们，但你可以使用 webview 打开谷歌地图的 webview？不过我之前没试过。
3.  我一个都不知道。根据您的应用程序，您可以让服务器端组件切出您正在使用的地图的一部分，并在需要的位置添加图钉。不管怎样，这对你来说都不是一个好的解决方案。

[编辑]找到一个选项..你可以去这里：[amazon map api signup](http://www.amazon.com/gp/html-forms-controller/maps-signup)

然后在您的应用程序中，您必须基本上创建两个活动或视图，一个使用每种方法，然后根据设备上安装的内容启动适当的一个。您可以查询地图是否可用，如此[处所示](https://stackoverflow.com/questions/9082784/installation-error-install-failed-missing-shared-library-on-kindle-fire/9082870#9082870)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T22:23:49.120

我们在当前项目中一直在使用 Sygic GPS SDK。我意识到该产品的主要目的是提供 GPS 导航，我也不认为许可证具有成本效益，但它在导航方面做得很好，您还可以显示地图视图。

除此之外，其他人已经在 SO 上汇总了[地图 api 列表。](https://stackoverflow.com/questions/4151593/alternatives-to-google-maps-api)也许其中之一会帮助你。

# php - 矩形在边界之外是什么意思

> ID：12847210
> 
> 赞同：4
> 
> 时间：2012-10-11T19:37:24.340
> 
> 标签：php, google-chrome

PPB_Graphics2D.PaintImageData: Rectangle is outside bounds 是什么意思？我几乎在我检查的每一段代码中都看到了它。最新的代码是

```
define("my consumer key");
define("my consumer secret");

$oauth = new OAuth(my consumer key, my consumer secret);

//The first item of business is getting a request token
$request_token_response = $oauth->getRequestToken('https://api.linkedin.com/uas/oauth/requestToken');

if($request_token_response === FALSE) {
        throw new Exception("Failed fetching request token, response was:"
        . $oauth->getLastResponse());
} else {
        $request_token = $request_token_response;
}

print "Request Token:\n";
printf("    - oauth_token        = %s\n", $request_token['oauth_token']);
printf("    - oauth_token_secret = %s\n", $request_token['oauth_token_secret']);
print "\n"; 
```

我很想知道这个错误是什么意思以及如何摆脱它

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-12T10:25:59.947

这似乎是最新版本的 Google Chrome 的错误。我们在我们的网站以及许多其他具有 Flash 内容的网站上都看到了这个问题。

例如

*   [http://www.bbc.co.uk/news/](http://www.bbc.co.uk/news/)
*   [http://edition.cnn.com/](http://edition.cnn.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:04:16.107

然后错误是页面上的 Javascript 而不是 PHP。您正在查看完全错误的代码。

# ios - -[UITableView reloadData] 仅在滚动后显示更改

> ID：12847212
> 
> 赞同：2
> 
> 时间：2012-10-11T19:37:57.843
> 
> 标签：ios, uitableview, ios5.1

我更新了`UITableView`计时器。我更改数组中的数据，然后调用`-[UITableView reloadData]`. 但是在我滚动表格或在标签栏中切换标签之前，什么都没有改变。发生了什么？我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:44:58.070

不要在非主线程上重新加载表

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-11T19:52:12.660

问题在于：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^(void){
    self.newList = [self loadData];
    [self.delegate list:self didUpdate:self.newList];
}); 
```

委托调用在后台线程上。如果你想更新 UI，你应该在主线程上做。

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^(void){
    self.newList = [self loadData];

    dispatch_async(dispatch_get_main_queue(), ^{
        [self.delegate list:self didUpdate:self.newList];
    });
}); 
```

# objective-c - iOS中的串行通信

> ID：12847214
> 
> 赞同：2
> 
> 时间：2012-10-11T19:38:04.120
> 
> 标签：objective-c, ios, serial-port

我正在开发我的第一个应用程序。这个应用程序是使用我从 RedPark 获得的电缆与外部硬件通信。他们提供了一个库，该库具有几个易于使用的功能。现在我需要一个 9*9 的表，其中包含浮点数，方法是发送一个命令来请求它。

一个名为 (void)readBytesAvailable 的函数用于读取，它是事件驱动的。起初，我使用 NSMutableArray 来放置表格：

```
 for (int i=0; i<81; i++) {
        NSNumber *number = [NSNumber numberWithFloat:rxLoopBuffer[i]];
        [self.arrayRead addObject:number];
        NSLog(@"%f",[number doubleValue]);
    } 
```

但从控制台，它只得到了 11 个数字，其余 70 个都是 0。我想也许我需要先获取所有 81 个字节，然后将它们推送到数组中，所以我做了一些更改：

```
 NSMutableData *dataRead = [[NSMutableData alloc]initWithBytes:&rxLoopBuff length:81];
    unsigned char buffer[100];
    [dataRead getBytes:buffer];
    if (!self.arrayRead) {
    [self.arrayRead removeAllObjects];
    }
    for (int i=0; i<81; i++) {
    NSNumber *number = [NSNumber numberWithFloat:buffer[i]];
    [self.arrayRead addObject:number];
    NSLog(@"%f",[number doubleValue]);
    } 
```

但它仍然有 11 个数字。

有人可以给我一些建议吗？提前非常感谢。

更新：通过调试，我看到 read 方法一次最多只能读取 16 个字节。我正在下载同一家公司提供的新版本库，看看我能做什么。方法代码部分：

```
 - (void) readBytesAvailable:(UInt32)numBytes
   {
    int bytesRead; 
    BOOL res = NO;

// Read the data out
bytesRead = [rscMgr read:(rxLoopBuff+loopbackCount) length:numBytes];
rxCount += bytesRead;

    //NSLog(@"Read %i, total=%i\n", bytesRead, rxCount);
    if (this is the package I need)
    {
       //do something;
    }

   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T14:07:12.583

*免责声明 - 我没有这条电缆，所以我无法测试它，也许代码不起作用。但这只是盲目的演示我该怎么做。这是启用 ARC 的代码。*

**SerialPortCommunication.h**

```
#import <Foundation/Foundation.h>

@interface SerialPortCommunication : NSObject

- (void)readBytes:(UInt32)numberOfBytes
          success:(void(^)( NSData *data ))success
          failure:(void(^)( NSData *dataReadSoFar, NSError *error ))failure;

@end 
```

**SerialPortCommunication.m**

```
#import "SerialPortCommunication.h"
#import "RscMgr.h"

#define BUFFER_SIZE 128

@interface SerialPortCommunication() < RscMgrDelegate > {
  RscMgr *_rscMgr;           // Resource Manager
  BOOL _portAvailable;       // Can we use port?
  NSMutableData *_data;      // Buffer for data
  UInt32 _totalBytesToRead;  // Number of total bytes to read

  // Success block to call
  void(^ _successBlock )( NSData *data );

  // Failure block to call
  void(^ _failureBlock )( NSData *dataReadSoFar, NSError *error );

  UInt8 *_buffer;
}

@end

@implementation SerialPortCommunication

#pragma mark - Lifecycle

- (void)dealloc {
  free( _buffer );
}

- (id)init {
  self = [super init];
  if ( self ) {
    _rscMgr = [[RscMgr alloc] init];
    [_rscMgr setDelegate:self];

    _buffer = malloc( BUFFER_SIZE * sizeof( UInt8 ) );
    // DO SERIAL PORT CONFIGURATION HERE
  }
  return self;
}

#pragma mark - Public

- (void)readBytes:(UInt32)numberOfBytes
          success:(void(^)( NSData *data ))success
          failure:(void(^)( NSData *dataReadSoFar, NSError *error ))failure {
  if ( ! _portAvailable ) {
    if ( failure ) {
      // Create some NSError that port is not available
      failure( nil, nil );
      return;
    }
  }

  if ( _data ) {
    if ( failure ) {
      // Create some NSError that port is in use
      failure( nil, nil );
      return;
    }
  }

  _failureBlock = failure;
  _successBlock = success;
  _totalBytesToRead = numberOfBytes;

  _data = [NSMutableData data];
  // Now we're waiting for delegate methods
}

#pragma mark - RscMgrDelegate

- (void)cableConnected:(NSString *)protocol {
  // From now on you can use serial port
  _portAvailable = YES;
  [_rscMgr open];
}

- (void)cableDisconnected {
  // From now on you can't user serial port
  _portAvailable = NO;

  // Ouch, we can't read, fire failure
  if ( _failureBlock ) {
    // Create NSError which describes cable disconnection
    _failureBlock( _data, nil );
  }

  // Our task ends here
  _successBlock = nil;
  _failureBlock = nil;
  _data = nil;
  _totalBytesToRead = 0;
}

- (void)portStatusChanged {
  // Check status if everything's alright and you can still user serial port
  // Set _portAvailable accordingly

  // Replace if ( NO ) with condition if port is still alright and we can read
  if ( NO ) {
    if ( _failureBlock ) {
      // Create NSError which describes status change and we can't use serial port
      _failureBlock( _data, nil );
    }

    // Our task ends here
    _successBlock = nil;
    _failureBlock = nil;
    _data = nil;
    _totalBytesToRead = 0;

    _portAvailable = NO;
  } else {
    _portAvailable = YES;
  }
}

- (void)readBytesAvailable:(UInt32)length {
  if ( ! _data ) {
    // Here no one's interested in received data
    // So you can decide if you want to save them for later use or trash them
    // We are going to trash them
    [_rscMgr read:_buffer length:MIN( BUFFER_SIZE, length )];
    return;
  }

  UInt32 bytesToRead;

  // First of all, we can't read more than our buffer size
  bytesToRead = MIN( BUFFER_SIZE, length );

  // Also it's enough to read only what user requested
  UInt32 remainingBytes = _totalBytesToRead - _data.length;
  bytesToRead = MIN( bytesToRead, remainingBytes );

  // Now read bytes
  UInt32 bytesRead = [_rscMgr read:_buffer length:bytesToRead];
  if ( bytesRead > 0 ) {
    [_data appendBytes:_buffer length:bytesRead];
  }

  if ( _data.length == _totalBytesToRead ) {
    if ( _successBlock ) {
      _successBlock( _data );
    }

    _successBlock = nil;
    _failureBlock = nil;
    _data = nil;
    _totalBytesToRead = 0;
  }
}

@end 
```

**串口使用**

这就是我将如何使用我的课程。

```
#import "SerialPortUser.h"
#import "SerialPortCommunication.h"

@interface SerialPortUser() {
  SerialPortCommunication *_serial;
}

@end

@implementation SerialPortUser

- (id)init {
  self = [super init];
  if ( self ) {
    _serial = [[SerialPortCommunication alloc] init];
  }
  return self;
}

- (void)getData {
  [_serial readBytes:81
             success:^(NSData *data) {
               // Here you have NSData with 81 bytes for sure
             }
             failure:^(NSData *dataReadSoFar, NSError *error) {
               // Here you have NSData with dataReadSoFar.length bytes only
               // read so far, because an error happens
               // And error is in NSError *error
             }];
}

@end 
```

# javascript - 是否可以将显示模块模式实例传递给回调函数？

> ID：12847218
> 
> 赞同：1
> 
> 时间：2012-10-11T19:38:32.097
> 
> 标签：javascript, revealing-module-pattern

我有一些使用显示模块模式的 javascript，如下所示。它接受一个稍后调用的回调函数。我希望该回调函数能够调用类中定义的函数，但它不起作用。

```
window.MyClass = function() {
  var self = this,

  start = function (callback) {
    callback(self);
  },

  cancel = function() {
    console.log('Cancel invoked');
  };

  return {
    start: start,
    cancel: cancel
  };
};

var myCallbackFunction = function(instance) {
  instance.cancel(); // Error: instance.cancel is not a function
};

var obj = new window.MyClass();
obj.start(myCallbackFunction); 
```

我可以将这个示例重新设计为 Revealing Prototype Pattern 并且它可以按预期工作，所以我的问题是我可以使用 RMP 来实现这个工作，还是只是这个模式的一个限制？

谢谢，罗杰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:43:05.347

```
window.MyClass = function() {
  var self = this;

  this.start = function (callback) {
    callback(self);
  };

  this.cancel = function() {
    console.log('Cancel invoked');
  };

  return {
    start: this.start,
    cancel: this.cancel
  };
}; 
```

然后，它既是一个实例方法，又可以通过返回值使用。

但是对于这么简单的事情（例如没有私有变量），我会使用直接原型（“原型模式”）。

顺便说一句，如果你正在阅读[这个系列](http://weblogs.asp.net/dwahlin/archive/2011/07/31/techniques-strategies-and-patterns-for-structuring-javascript-code.aspx)，你应该知道这些并不是真正的标准术语。

他还表示，“虽然 JavaScript 在设计时没有像 C# 或 Java 那样考虑类或面向对象编程的概念，但只需稍加工作即可获得类似的结果。” 事实上，JavaScript 是为面向对象编程而设计的，但它是基于原型的。如您所见，它也足够灵活，可以允许替代方案；在某些情况下，这些替代方案肯定更好。

您甚至不需要 self，因为您的对象保持绑定。

所以：

```
window.MyClass = function(){};

window.MyClass.prototype = {
    start: function (callback) {
        callback(this);
    },

    cancel: function () {
        console.log('Cancel invoked');
    }
};

var myCallbackFunction = function(instance) {
  instance.cancel();
};

var obj = new window.MyClass();
obj.start(myCallbackFunction); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:58:00.160

永远不要从构造函数返回对象。这是那些奇怪的 JS 怪癖之一。

你没有得到 的实例`MyClass`，你得到的是一个普通的对象。当构造函数返回一个对象时，该对象将被返回，*而不是*本应返回的实例。

```
// good!
function MyClass() {};
new MyClass().constructor // returns: function MyClass() {}
new MyClass().constructor == MyClass // true

// bad!
function MyClass() { return {a:123}; };
new MyClass().constructor // returns: function Object() { [native code] }
new MyClass().constructor == MyClass // false 
```

简而言之，古典风格和暴露模块风格并不能很好地融合在一起。

在您的情况下，分配给 的属性的任何功能`this`都是您将该功能透露给外部。所以也许你想要这个。

```
window.MyClass = function() {
  var self = this;

  var start = function (callback) {
    callback(self);
  };

  var cancel = function() {
    somePrivateFn();
    console.log('Cancel invoked');
  };

  var somePrivateFn = function() {
    console.log('private function!');
  };

  this.start = start;
  this.cancel = cancel;
}; 
```

* * *

但是如果你不需要任何私有的东西（你的例子揭示了一切，所以没有什么是私有的）使用像 Matthew 建议的基于原型的方法，这在所有方面都更快更简单。

# objective-c - UIPickerView viewForRow UILabel 忽略框架

> ID：12847219
> 
> 赞同：1
> 
> 时间：2012-10-11T19:38:33.743
> 
> 标签：objective-c, ios, uipickerview

我正在使用 UILabel 作为我的 UIPickerView 的自定义视图，并且我试图将标签从左侧填充 10px 左右。但是，无论我将 UILabel 设置为哪个框架，它都会被忽略。

我基本上是在尝试制作一个日期选择器，在年份组件中有一个“未知”选项。我是 iOS 开发的新手。子类化 UIDatePicker 并添加“未知”选项是否可能/会更优雅？

这是我的代码：

```
- (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view
{
    UILabel* tView = (UILabel*)view;

    if (!tView)
    {
        tView = [[UILabel alloc] initWithFrame:** Any CGRect here **];

        tView.backgroundColor = [UIColor redColor];
        tView.font = [UIFont boldSystemFontOfSize:16.0];

        if (component == 0)
        {
            tView.textAlignment = NSTextAlignmentCenter;
        }
    }

    // Set the title
    NSString *rowTitle;

    if (component == 0)
    {
        rowTitle = [NSString stringWithFormat:@"%d", (row + 1)];
    }
    else if (component == 1)
    {
        NSArray *months = [[NSArray alloc] initWithObjects:@"January", @"February", @"March", @"April", @"May", @"June", @"July", @"August", @"September", @"October", @"November", @"December", nil];
        rowTitle = (NSString *) [months objectAtIndex:row];
    }
    else if (component == 2)
    {
        if (row == 0)
        {
            rowTitle = @"- Unknown -";
        }
        else
        {
            NSDateFormatter *currentYearFormat = [[NSDateFormatter alloc] init];
            currentYearFormat.dateFormat = @"YYYY";
            NSInteger currentYear = [[currentYearFormat stringFromDate:[NSDate date]] intValue];

            rowTitle = [NSString stringWithFormat:@"%d", (currentYear - row)];
        }
    }

    tView.text = rowTitle;

    return tView;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T20:15:48.003

不要`UILabel`直接使用。对你来说最简单的方法是...

通过...定义宽度/高度

*   `pickerView:widthForComponent:`
*   `pickerView:rowHeightForComponent:`

...而不是基于创建自定义类`UIView`并返回此对象。在您的自定义`UIView`中，添加`UILabel`子视图并移入`UILabel`您`layoutSubviews`的班级。像这样的东西...

```
// MyPickerView.h
@interface MyPickerView : UIView
  @property (nonatomic,strong,readonly) UILabel *label;
@end

// MyPickerView.m
@interface MyPickerView()
  @property (nonatomic,strong) UILabel *label;
@end

@implementation MyPickerView
  - (id)initWithFrame:(CGRect)frame {
    self = [super initWithFrame:frame];
    if ( self ) {
      _label = [[UILabel alloc] initWithFrame:CGRectZero];
    }
    return self;
  }

  - (void)layoutSubviews {
    CGRect frame = self.bounds;
    frame.origin.x += 10.0f;
    frame.size.width -= 20.0f;
    _label.frame = frame;
  }
@end 
```

...并返回您`MyPickerView`的`pickerView:viewForRow:forComponent:reusingView:`.

# javascript - 免费的蜘蛛图 API

> ID：12847222
> 
> 赞同：0
> 
> 时间：2012-10-11T19:38:51.240
> 
> 标签：javascript, jquery, charts

我正在寻找一个免费的 api 来制作蜘蛛图。我注意到谷歌图表没有它们。

这是一个[例子](http://www.highcharts.com/demo/polar-spider)

到目前为止我发现的所有这些都需要您购买许可证

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:40:54.673

ExtJs 有蜘蛛图：

这是你在说什么：[http ://dev.sencha.com/deploy/ext-4.0.0/examples/charts/RadarFill.html](http://dev.sencha.com/deploy/ext-4.0.0/examples/charts/RadarFill.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:43:47.450

Flot 似乎有一个插件：[http ://code.google.com/p/flot/issues/detail?id=138](http://code.google.com/p/flot/issues/detail?id=138)

我没有使用过它，也不太了解它，但我已经广泛使用了 Flot 并且喜欢它。

# php - 将两个克隆的数据库合并回主数据库 (MSSQL)

> ID：12847227
> 
> 赞同：1
> 
> 时间：2012-10-11T19:39:38.767
> 
> 标签：php, sql, sql-server, database, merge

数据库类型是 MSSQL。网站技术是 PHP。

场景：我在办公室有一个主数据库。它被克隆了两次，并被送到世界各地的两个不同的活动中。数据被更改，新数据被添加，两个克隆数据库中的一些数据被删除。

活动结束，两个克隆的数据库都返回办公室。我现在的任务是将数据库合并回一个主数据库。

我理解的事情：

1.  如果在两个克隆上都修改了同一行的数据，则需要做出（人工）决定来决定采取哪一个。

2.  这个Master，clone和back to master会是常事。

3.  因为有很多表，所以里面有很多引用。我需要确保将数据注入主数据库时引用保持不变。

**我能得到一些关于如何处理这种情况的建议吗？**

*请注意，让各种活动地点直接访问主数据库并不是我的奢侈品。我必须假设每个事件都是离线的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T23:09:15.493

这是您在发送数据库之前应该问的问题类型。

您需要查看的主要考虑因素之一是您的主 id 数据类型。我建议在自动递增整数上使用 GUID，因为这样在两个数据库中创建的新记录不会共享 id。这将使您的生活更加轻松。

**在发送数据库之前**您应该查看的另一件事是在所有行中包含时间戳列。这也将使您的生活更加轻松。

使用 guid 和时间戳来查找跨 2-3 个数据库的表中的所有修改记录是一件简单的事情。

使用 guid 在多个数据库的表中查找所有新记录是一件简单的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T21:07:19.597

这正是 Merge-Replication 旨在处理的情况类型。在这里查看我的文章系列：[SQL Server 复制的阶梯](http://www.sqlservercentral.com/stairway/72401/)

# jstl - 无法访问会话属性

> ID：12847232
> 
> 赞同：2
> 
> 时间：2012-10-11T19:39:56.683
> 
> 标签：jstl

我是java的新手。

我试图在 servlet 中为 session 设置一个属性，然后在两个不同的 jsps 中访问它。但是我得到了第二个 jsp 的空指针异常。

我的小服务程序：

```
 HttpSession session = request.getSession(true);

    if (null == session.getAttribute("username")) {
        response.sendRedirect("login.jsp");
    } else {
        EdsStudentForm eds = (EdsStudentForm) form;
        try {
            List<UserApplication> userList = uaDAO.searchUser(eds);
            if (!userList.isEmpty()) {
                request.getSession().setAttribute("userList", userList);
                action_forward = SRCHSUCCESS;
            } else {
                action_forward = SRCHFAILURE;
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

JPS I : sTbl.jsp 我的第一个 JSP 没有问题

```
 <html:form method="post">
        <table border="1" width="400" align="center" class ="sample">

            <tr>
                <td class ="divheader">Student Code</td>
                <td class ="divheader">First Name</td>
                <td class ="divheader">Last Name</td>
            </tr>
            <c:set var ="sStudt" value="${userList}" scope="session" />
                <c:forEach items="${userList}" var ="uList">
                    <tr> 
                        <td class ="divheader"><a href="searchSuccess.jsp?"><c:out value="${uList.studentCode}"></c:out></a></td>
                        <td class="divheader"><c:out value="${uList.firstName}"></c:out></td>
                        <td class ="divheader"><c:out value="${uList.lastName}"></c:out></td>
                        </tr> 
                </c:forEach>
      </html:form> 
```

我的第二个 JSP：searchSuccess.jsp

```
 <html:form method="post">
        <p class ="sample">Personal Information</p>
        <table class ="table1">

            <c:if test="${not empty sStudt}">
                <c:forEach var="sList" items="${sessionScope.sStudt}">
            <tr>
                <td>Student Code:</td>
                <td><c:out value="${sList.studentCode}"/><td>
            </tr>
           <tr>
                <td>Title:</td>
                <td><c:out value="${sList.title}"/></td>
                <td>First Name:</td>
                <td><c:out value="${sList.firstName}"/></td>
                <td>Last Name:</td>
                <td><c:out value="${sList.lastName}"/></td>
            </tr> 
            <tr>
                <td>Street Number:</td>
                <td><c:out value="${sList.streetNumber}"/></td>
                <td>Street Name:</td>
                <td><c:out value="${sList.streetName}"/></td>
                <td>#Suite/Apt.:</td>
                <td><c:out value="${sList.suite}"/></td>
            </tr>
            etc..etc... 
```

我得到一个 java.lang.NullPointerException

你能告诉我我做错了什么吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T07:31:57.773

尝试更改您的 c:if 条件以检查该变量在会话中是否可用，如下所示

```
<c:if test="${not empty sessionScope.sStudt}"> 
```

我想这应该解决你的问题

# tfs - 如果我销毁一个 TFS 项目，我以后可以创建一个同名的新项目吗？

> ID：12847233
> 
> 赞同：1
> 
> 时间：2012-10-11T19:40:00.057
> 
> 标签：tfs

我正在继承一个 TFS 系统，其中已经创建了一堆未使用的项目，目前不需要它们，将来也不需要它们。他们没有创建工作项或签入源代码，所以我想销毁它们以摆脱开销和浪费的空间。不过，我想确定一下，如果以后出于某种原因我们需要一个与其中一个名称相同的新项目，我可以创建它吗？还是我以后不需要记住这个列表并稍微更改名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:48:01.783

首先，如果您想摆脱所有 TFS 和项目，您可以像普通程序一样先卸载 TFS，然后删除 de TFS 数据库。并重新安装所有。它对我有用：D

# javascript - 纯 JavaScript MVC 框架

> ID：12847236
> 
> 赞同：0
> 
> 时间：2012-10-11T19:40:10.263
> 
> 标签：javascript, model-view-controller, web-applications, frameworks, single-page-application

我最近使用 Backbone 作为我们公司开发的**单页 Web 应用程序的****MVC 框架。**我发现 Backbone 缺少一些对于大型应用程序非常重要的功能（**例如 ui 绑定、CommmonJS 中的模块概念**），模型定义不佳）。

 ****在我研究能填补这些空白的 JavaScript-MVC 框架时，我只发现框架需要**额外的服务器软件、编译**等。

没有任何纯 JS-MVC 框架吗？

提前致谢 ：）

最良好的祝愿

狮子座

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:50:50.807

### 就模块而言：

您可以相当简单地将模块引入基于 Backbone 的应用程序。我会推荐 AMD 而不是 CommonJS（使用[RequireJS](http://requirejs.org/)）作为要使用的模块模式。您可以选择为它构建一个“构建”系统，但不是必须的。

可能是以下情况：

*   型号在`js/myapp/models/`
*   中的视图`js/myapp/views/`
*   ETC..

每个模型/视图都包含在对 RequireJS`define()`函数的调用中。

在您的主脚本中，您可以使用 RequireJS 的`require()`函数来获取视图/模型。

### 用户界面绑定：

单独使用 Backbone：它们不一定是“绑定”，但您可以在视图中监听模型更改事件并更新视图中显示模型值的位置。

使用一个插件，比如[backbone.modelBinding](https://github.com/derickbailey/backbone.modelbinding) ，你可以更接近真正的绑定。****

# asp.net - 编辑模式下的DetailView项目更新功能

> ID：12847237
> 
> 赞同：1
> 
> 时间：2012-10-11T19:40:20.650
> 
> 标签：asp.net

我在编辑模式下的 DetailsView 中有一个下拉菜单。我在后端数据库中有大约 10 个字段，但在我的 DetailView 中只使用了 4 个字段。我遇到的问题是我只能在第一次进行更新并且它保存在我的表中，但是如果我回去尝试再次进行更改，那么它不会让我这样做。我在这里做错了什么？我到处搜索，但找不到解决方案。请帮助我或向我展示一些示例，因为我是编码新手。谢谢

这是我的代码：

```
protected void DV_Mgr_Appr_ItemUpdating(object sender, DetailsViewUpdateEventArgs e)
{
    DropDownList DDList = (DropDownList)((DetailsView)sender).FindControl("DDList");
    //SqlDataSource2.UpdateParameters["Sex"].DefaultValue = rblGender.SelectedValue; 
    DV_ManagerApp_DS.UpdateParameters["Approved1"].DefaultValue = DDList.SelectedValue;
} 
```

# asp.net - 发布链接时如何以编程方式选中“无缩略图”复选框

> ID：12847239
> 
> 赞同：8
> 
> 时间：2012-10-11T19:40:24.593
> 
> 标签：asp.net, json, facebook-graph-api

我们的应用程序允许我们的用户向 Facebook 发布消息。如果用户想要在消息中发布诸如[http://yahoo.com](http://yahoo.com)之类的链接，则会在帖子中显示带有链接的图像。

直接在 Facebook 上发布带有链接的消息时，您可以选择选中“无缩略图”框，以便不显示图像。如何使用 以编程方式执行此操作`graph.facebook.api`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:54:55.953

如果您只是想从您的网站发布链接，那么就不要传递其他参数，只需传递`message`您的链接的字段，它只会发布没有任何其他字段的链接。

但是，如果您想发布完整消息但没有缩略图，则不要传递`picture`参数。

如果您可以共享您的代码会更好，以便我们可以建议您正确的解决方案，如果上述内容对您没有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:51:40.370

我认为你应该看看这个[https://developers.facebook.com/bugs/190261237768904](https://developers.facebook.com/bugs/190261237768904)。这是一个现已修复的错误。它指向一种方法，您可以指定图片参数但将其值留空。

# php - 致命错误：调用非对象代码点火器 $query->num_rows()==1) 上的成员函数 where()

> ID：12847242
> 
> 赞同：4
> 
> 时间：2012-10-11T19:40:51.880
> 
> 标签：php, mysql, database, codeigniter

> **可能重复：**
> [CodeIgniter - 在非对象上调用成员函数 select()](https://stackoverflow.com/questions/8322124/codeigniter-call-to-a-member-function-select-on-a-non-object)

我是codeigniter的新手，遇到了一些问题。

**错误消息：** **致命错误：调用第 12 行 C:\xampp\htdocs\moi\CI\application\models\model_users.php 中非对象的成员函数 where()**

我的模型：

```
class Model_users extends CI_Model {

 function __construct(){
    parent::__construct();
}

public function can_log_in() {

    $this->db->where('email', $this->input->post('email'));
    $this->db->where('pass', md5($this->input->post('password')));
    $query = $this->db->get('users');

    if ($query->num_rows()==1) {
        return TRUE;
    } else {
        return FALSE;
    } 
```

我的控制器：

```
class Main extends CI_Controller {

public function index() {
    $this->login();
}

//Auslagern der Funktionen
public function login() {
    $this->load->view('login');
}

public function login_validation() {

    $this->load->library('form_validation');

    $this->form_validation->set_rules('email', 'email', 'required|valid_email|xss_clean|callback_username_check');
    $this->form_validation->set_rules('password', 'password', 'required|md5');

    if ($this->form_validation->run()) {
        redirect('main/members');
    } else {
        $this->load->view('login');
    }
}

public function username_check() {
    $this->load->library('form_validation');
    $this->load->model('model_users');
    if ($this->model_users->can_log_in()) {
        return TRUE;
    } else {
        $this->form_validation->set_message('username_check', 'incorect User or Passwort.');
        return FALSE;
    }
}

} 
```

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:50:00.197

**See below URL**

[CodeIgniter - Call to a member function select() on a non-object](https://stackoverflow.com/questions/8322124/codeigniter-call-to-a-member-function-select-on-a-non-object)

**Try it**

```
class User_model extends CI_Model { 

     public function __construct() 
     {
           parent::__construct(); 
           $this->load->database();
     }

     public function can_log_in() {

        $this->db->select('*');
        $this->db->from('user');
        $this->db->where('username', $this->input->post('username'));
        $this->db->where('password', md5($this->input->post('password')));
        $validate_user = $this->db->get();

       if ($query->num_rows()==1) {
         return TRUE;
       } else {
         return FALSE;
      }

}

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:48:24.067

`$this->db`似乎没有定义。似乎您的模型中没有属性名称`$db`。

你用过：`$this->load->database();`来初始化你的数据库吗？

试试下面的代码：

```
class Model_users extends CI_Model {

    function __construct(){
        parent::__construct();
        $this->load->database();
    } 
```

信息
示例： http: [//maestric.com/doc/php/codeigniter_models](http://maestric.com/doc/php/codeigniter_models)
用户指南：[http ://ellislab.com/codeigniter/user_guide/database/examples.html](http://ellislab.com/codeigniter/user_guide/database/examples.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T19:57:29.060

The problem you have is not that much related to Codeigniter in specific nor to the database.

It is first of all a standard PHP error, for the general info please see

*   [PHP Error Reference: Fatal error: Call to a member function ... on a non-object](https://stackoverflow.com/questions/12769982/reference-what-does-this-error-mean-in-php/12769983#12769983)

In your cases - just forget Codeigniter for a moment - this means that `$this` does bot have any `->db` or `->load` member, lines of code that fail:

```
$this->db->where('email', $this->input->post('email'));
$this->load->database(); 
```

It's obvious that this needs further debugging. Why aren't those libraries loaded? Why isn't it even possible to load the database?

Well actually this requires further debugging. It makes no sense in my eyes that you ask in comments further on, the other users can only give as good answers as you provide good information in your question. But asking a question is always limited as well, sure.

Maybe first of all post the complete code of your model class. It might just be the model class itself already screws it. Something a fresh pair of eyes here is faster to spot.

But there is no guarantee for that, just a possibility. You can break that also in other places. These are hard to reach, so you best do that using a step-debugger like Xdebug in your development environment.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:46:41.660

你有自动加载的数据库吗？如果没有，您可能需要将此代码添加到构造函数中：

```
$this->load->database(); 
```

# jsp - 在 Spring MVC 中不显示图像

> ID：12847247
> 
> 赞同：8
> 
> 时间：2012-10-11T19:41:38.453
> 
> 标签：jsp, spring-mvc

我知道这个问题已经被问过很多次了，但我无法弄清楚问题是什么。我在 src/main/webapp 文件夹下有 images 文件夹（这是一个 maven web 项目）。我在 src/main/webapp/WEBINF/views 文件夹中有 index.jsp。

我正在尝试访问图像和其他资源，如 css 和 js，如下所示：

`<img src="/images/left_arrow.png" alt="" />`

但是图像没有显示出来。

这是 web.xml 文件

```
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
version="3.0">

<servlet>
    <servlet-name>mvc-dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>mvc-dispatcher</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>
</web-app> 
```

这是 WEB-INF/mvc-dispatcher-servlet.xml 文件

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
    http://www.springframework.org/schema/beans     
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<context:component-scan base-package="com.ravi.WebApp" />

<bean
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix">
        <value>/WEB-INF/views/</value>
    </property>
    <property name="suffix">
        <value>.jsp</value>
    </property>
</bean>

</beans> 
```

这里是控制器包com.ravi.WebApp；

```
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
public class HelloController {

@RequestMapping("/")
public String printWelcome(Model model) {
    return "index";

}

} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-11T19:49:50.070

尝试将以下资源声明添加到您的 Spring 配置中：

```
<!-- Handles HTTP GET requests for /images/** by efficiently serving up static resources in the ${webappRoot}/images directory -->
<resources mapping="/images/**" location="/images/" /> 
```

或者，更常见的是，拥有一个`resources`包含所有资源（图像、css、js 等）的文件夹，并按子目录进行细分。

您的配置将如下所示：

```
<!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
<resources mapping="/resources/**" location="/resources/" /> 
```

您的资源将被引用如下：

```
<link rel="stylesheet" type="text/css" href="<c:url value="/resources/css/screen.css" />" />
<script type="text/javascript" src="<c:url value="/resources/js/jquery-1.6.4.min.js" />"></script>
<img src="<c:url value="/resources/images/left_arrow.png" />" alt="" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-20T09:24:53.717

如果使用注释，请确保用户

```
<mvc:annotation-driven/> 
```

有资源

```
<mvc:resources mapping="/images/**" location="/images/" /> 
```

否则注释控制器将不起作用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-09T16:58:54.253

您只需要在 Spring MVC 配置文件中添加一个引用您的图像文件夹

WEB-INF/spring-context.xml：

```
<mvc:resources mapping="/images/*" location="/images/" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-19T16:14:10.987

请按照这张图片中的步骤.. :)

第 1 步：在 webapp 中创建一个文件夹，但不在 WEB-INF 中创建一个文件夹

> 创建资源然后图像然后存储您的图像。webapp/resources/images/fileName.jpg

第 2 步：现在您已经创建了文件夹

> 让我们映射您在处理路径映射的 servlet 配置文件中创建的路径添加以下代码： `<mvc:resources mapping="/resources/*" location="/resources/" />`

步骤 3：添加用于从您在步骤 1 中创建的位置访问图像资源的代码： `<img src="/attendance/resources/images/logo.png" width="100px" height="100px">`

[![JSP中的Spring MVC访问Image](../Images/35754250be78dc9864182ad9febf2993.png)](https://i.stack.imgur.com/8O59D.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T20:03:39.143

如果要将静态资源保留在 Web 根目录中的 WEB-INF 文件夹之外，并希望容器处理静态资源请求，则应将其添加到应用程序上下文文件中：

```
<mvc:default-servlet-handler /> 
```

@BeauGrantham 添加资源映射的建议也将起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-18T21:04:44.517

上述建议也对我有用。但是，如果其他人对关联的命名空间有疑问，我必须将 mvc 部分添加到`mvc-dispatcher-serlvet.xml`

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:mvc="http://www.springframework.org/schema/mvc" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
    http://www.springframework.org/schema/beans     
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/mvc 
    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd ">

...

<mvc:annotation-driven /> 
<mvc:resources mapping="/images/**" location="/images/" /> 
```

# javascript - $.post 数据数组

> ID：12847253
> 
> 赞同：1
> 
> 时间：2012-10-11T19:42:07.767
> 
> 标签：javascript, jquery, asp.net-mvc

我正在尝试将一些数据数组发布到控制器。我的观点是：

```
<script>
   $.post("/",{
       person: [
           { id: 1, name: "a" },
           { id: 2, name: "b" }
       ]
   });
</script> 
```

在我的控制器中：

```
[HttpPost]
public ActionResult Index(List<Person> person)
{
    //something
} 
```

当我检查发送的 http 数据时，我看到数据是：

```
person[0][id]
person[0][name]
person[1][id]
person[1][name] 
```

但默认模型绑定器的正确方法是：

```
person[0].id
person[0].name
person[1].id
person[1].name 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:01:02.100

您无法在`$.post`需要使用的情况下执行此操作，`$.ajax`因为您需要将其设置`contentType`为`'application/json'`使 mobel binder 对您无法使用的操作感到满意`$.post`

```
$.ajax({
        url: '/',
        type: 'POST',
        data: JSON.stringify({
            person: [
                { id: 1, name: "a" },
                { id: 2, name: "b" }
            ]
        }),
        contentType: 'application/json'
    }); 
```

而且您还需要`JSON.stringify`您的数据以使其与模型绑定器一起使用。

# heroku - heroku：“没有工人这样的类型”

> ID：12847254
> 
> 赞同：5
> 
> 时间：2012-10-11T19:42:08.610
> 
> 标签：heroku

在 Heroku 上，我正在尝试设置一个仅限工人（无网络）的测功机。

我的个人资料有：

```
worker: python common/elections_updater.py 
```

但是在我推动并尝试扩展之后，我得到了这个：

```
$heroku scale web=0 worker=1
Scaling web processes... done, now running 0
Scaling worker processes... failed
! No such type as worker 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:48:07.470

我有同样的问题。事实证明，虽然工头不在乎，但如果您的进程类型和配置文件中的进程命令之间没有空格，Heroku 不喜欢它。以下没有工作：

```
worker:python myapp.py 
```

而以下确实有效：

```
worker: python myapp.py 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T06:08:26.187

你说你的 Profile 有这样那样的，但必须是 Procfile

# javascript - JavaScript 和 JSON，如何解析？

> ID：12847258
> 
> 赞同：1
> 
> 时间：2012-10-11T19:42:20.740
> 
> 标签：javascript, json, zendesk

好的，所以我在创建与 Zendesk 一起使用的应用程序时遇到了很多麻烦。基本上我需要做的是搜索数据库中的所有票并计算每个最终用户有多少票。最终用户是每张工单中的一个文本字段。

所以这就是我所在的位置：

'/api/v2/tickets.json' - 这是 JSON 格式的所有票证的列表 - 它被放入我之后使用的变量'tickets' - 我认为'tickets' 将是一个数组，但现在我没有'不认为是，那么如何遍历它呢？

现在 - 我如何访问此票证文件中的值？例如，如何使用 JavaScript 访问“最终用户”值？

我查看了 Zendesk 的 API 文档，找不到任何有用的东西来让它工作，而且他们的论坛有些死了。希望你们能帮助我，因为我是 JavaScript 的初学者。

好的，这是 JSON 记录的示例：

```
{"tickets":[{"url":"https://company.zendesk.com/api/v2/tickets/1.json","id":1,"external_id":null,"via":{"channel":"web","source":{"from":{},"to":{},"rel":null}},"created_at":"2012-10-01T16:06:33Z","updated_at":"2012-10-05T19:21:55Z","type":"incident","subject":"This is a sample ticket requested and submitted by you","description":"This is the first comment. Feel free to delete this sample ticket.","priority":"high","status":"closed","recipient":null,"requester_id":270249903,"submitter_id":270249903,"assignee_id":270249903,"organization_id":22242373,"group_id":20363013,"collaborator_ids":[],"forum_topic_id":null,"problem_id":null,"has_incidents":false,"due_at":null,"tags":["sample","zendesk"],"fields":[{"id":21717236,"value":"10/4/2012"}],"custom_fields":[{"id":21717236,"value":"10/4/2012"}],"satisfaction_rating":null},{"url":"https://company.zendesk.com/api/v2/tickets/2.json","id":2,"external_id":null,"via":{"channel":"email","source":{"from":{"address":"noreply@zendesk.com","name":"Zendesk"},"to":{"address":"support@company.zendesk.com","name":"Binary Stream Helpdesk"},"rel":null}},"created_at":"2012-10-01T16:33:58Z","updated_at":"2012-10-05T17:09:37Z","type":null,"subject":"Tudor Hofnar, here is the test ticket you requested","description":"        Hello! This is a Zendesk ticket. We are going to go through the basic support ticket operation in Zendesk.\n\n        If you are in your email reading this, please click on the link in the header that starts with Ticket #.\n\n        If you are in your Zendesk reading this, you will see the ticket number, the customer who sent this ticket in, and drop down menus that allow you to set things like status and priority. You'll also notice a blank text box below this comment. That is for you to respond. Let's do that:\n\n        1\. Write: \"Thanks for this information, please tell me more.\"\n        2\. Change the drop-down field labeled Status to \"Pending\"\n\n        If you follow these instructions, you'll get an email response back from us shortly.  You can also always see ticket updates by going back into your unsolved ticket view (click view in the top menu bar).\n","priority":null,"status":"closed","recipient":null,"requester_id":270263553,"submitter_id":270263553,"assignee_id":270249903,"organization_id":null,"group_id":20363013,"collaborator_ids":[],"forum_topic_id":null,"problem_id":null,"has_incidents":false,"due_at":null,"tags":[],"fields":[{"id":21717236,"value":"10/4/2012"}],"custom_fields":[{"id":21717236,"value":"10/4/2012"}],"satisfaction_rating":null},{"url":"https://company.zendesk.com/api/v2/tickets/3.json","id":3,"external_id":null,"via":{"channel":"email","source":{"from":{"address":"tudor@binarystream.com","name":"Tudor Hofnar"},"to":{"address":"support@company.zendesk.com","name":"Binary Stream Helpdesk"},"rel":null}},"created_at":"2012-10-01T17:08:37Z","updated_at":"2012-10-05T18:15:01Z","type":null,"subject":"test","description":"test\n\nTudor Hofnar","priority":null,"status":"closed","recipient":"support@company.zendesk.com","requester_id":270249903,"submitter_id":270249903,"assignee_id":270249903,"organization_id":22242373,"group_id":20363013,"collaborator_ids":[],"forum_topic_id":null,"problem_id":null,"has_incidents":false,"due_at":null,"tags":[],"fields":[{"id":21717236,"value":"10/4/2012"}],"custom_fields":[{"id":21717236,"value":"10/4/2012"}],"satisfaction_rating":null},{"url":"https://company.zendesk.com/api/v2/tickets/5.json","id":5,"external_id":null,"via":{"channel":"web","source":{"from":{},"to":{},"rel":null}},"created_at":"2012-10-01T20:26:34Z","updated_at":"2012-10-06T22:39:09Z","type":"incident","subject":"Window for adding account not opening","description":"The add account window is not opening and it is causing a lot of trouble for our team etc....","priority":"normal","status":"closed","recipient":null,"requester_id":271853958,"submitter_id":271853958,"assignee_id":270249903,"organization_id":22284363,"group_id":20363013,"collaborator_ids":[],"forum_topic_id":null,"problem_id":null,"has_incidents":false,"due_at":null,"tags":["2_2_2","4","ared","end_user_1","var_2"],"fields":[{"id":21704983,"value":"1"},{"id":21708732,"value":"tried this"},{"id":21708742,"value":"1"},{"id":21713331,"value":"10/2/2012"},{"id":21717086,"value":"ared"},{"id":21717236,"value":"10/4/2012"},{"id":21717357,"value":"2_2_2"}],"custom_fields":[{"id":21704983,"value":"1"},{"id":21708732,"value":"tried this"},{"id":21708742,"value":"1"},{"id":21713331,"value":"10/2/2012"},{"id":21717086,"value":"ared"},{"id":21717236,"value":"10/4/2012"},{"id":21717357,"value":"2_2_2"}],"satisfaction_rating":null},{"url":"https://company.zendesk.com/api/v2/tickets/6.json","id":6,"external_id":null,"via":{"channel":"web","source":{"from":{},"to":{},"rel":null}},"created_at":"2012-10-02T21:14:59Z","updated_at":"2012-10-09T18:22:04Z","type":"incident","subject":"Test Ticket","description":"this is a test ticket","priority":"normal","status":"closed","recipient":null,"requester_id":271853958,"submitter_id":271853958,"assignee_id":270249903,"organization_id":22284363,"group_id":20363013,"collaborator_ids":[],"forum_topic_id":null,"problem_id":null,"has_incidents":false,"due_at":null,"tags":["2_2_2","arcb","end_user_1","var_2"],"fields":[{"id":21704983,"value":"1"},{"id":21708732,"value":"tried this"},{"id":21708742,"value":"1"},{"id":21713331,"value":"10/2/2012"},{"id":21717086,"value":"arcb"},{"id":21717236,"value":"10/2/2012"},{"id":21717357,"value":""},{"id":21728942,"value":null},{"id":21732321,"value":"Test End-User"}],"custom_fields":[{"id":21704983,"value":"1"},{"id":21708732,"value":"tried this"},{"id":21708742,"value":"1"},{"id":21713331,"value":"10/2/2012"},{"id":21717086,"value":"arcb"},{"id":21717236,"value":"10/2/2012"},{"id":21717357,"value":""},{"id":21728942,"value":null},{"id":21732321,"value":"Test End-User"}],"satisfaction_rating":null},{"url":"https://company.zendesk.com/api/v2/tickets/7.json","id":7,"external_id":null,"via":{"channel":"web","source":{"from":{},"to":{},"rel":null}},"created_at":"2012-10-09T20:09:50Z","updated_at":"2012-10-11T18:19:42Z","type":"question","subject":"Testing bookmarks","description":"this is a bookmark test\n","priority":"normal","status":"open","recipient":null,"requester_id":270249903,"submitter_id":270249903,"assignee_id":270249903,"organization_id":22242373,"group_id":20363013,"collaborator_ids":[],"forum_topic_id":null,"problem_id":null,"has_incidents":false,"due_at":null,"tags":["2010","psm"],"fields":[{"id":21704983,"value":"0"},{"id":21708732,"value":null},{"id":21708742,"value":"1"},{"id":21713331,"value":"10/9/2012"},{"id":21717086,"value":"psm"},{"id":21717236,"value":"10/31/2012"},{"id":21717357,"value":"2010"},{"id":21728942,"value":"Var 1"},{"id":21732321,"value":"End User 2"}],"custom_fields":[{"id":21704983,"value":"0"},{"id":21708732,"value":null},{"id":21708742,"value":"1"},{"id":21713331,"value":"10/9/2012"},{"id":21717086,"value":"psm"},{"id":21717236,"value":"10/31/2012"},{"id":21717357,"value":"2010"},{"id":21728942,"value":"Var 1"},{"id":21732321,"value":"End User 2"}],"satisfaction_rating":null}],"next_page":null,"previous_page":null,"count":6} 
```

*不知道如何格式化此代码...*

现在这是我的 JS 代码，我知道我试图用“票”做的事情是错误的，但我不知道如何访问它......

```
(function() {

  return {
    // Here we define AJAX calls
    requests: {
      fetchTickets: function() {
        return {
          url: '/api/v2/tickets.json',
          type: 'GET'
        };
      }
    },
    // Here we define events such as a user clicking on something
    events: {
      'app.activated': 'requestTickets',

      'fetchTickets.always': function(data) {
        this.countEndUserTickets((data || {}).tickets);
      }
    },
    // Below this point, you're free to define your own functions used by the app   
    requestTickets: function() {
      this.ajax('fetchTickets');
    },

    countEndUserTickets: function(tickets) {
      var endUser = this.ticket().customField("End-User"); //this will get the end-user of the current ticket that is open in Zendesk
      var ticketCounter = 0;

      //this is where I have no idea how to access the 'tickets' array or whatever it is
      for (var i = 0; i <= tickets.length; i++) {
        if (tickets[i].customField("End-User") == endUser){
          ticketCounter = ticketCounter + 1;
        }
      }

      alert(endUser);

      this.switchTo('list', {
        ticketCounter: this.ticketCounter
      });
    }
  };  
}()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:03:50.117

根据[他们的文档](http://www.zendesk.com/support/api/rest-introduction)，Zendesk 支持 JSONP：

> 您可以通过将“?callback=your_call_back_function”附加到 GET URL 来指定回调

因此，您可以将您的 url 更改为`'/api/v2/tickets.json?callback=fetchTicketsCallback'`并将`fetchTicketsCallback`被调用，并传入一个完全解析的 JavaScript 对象。

**编辑：**实际上，根据[这个文档](http://developer.zendesk.com/documentation/apps/example.html)（看起来很像您发布的代码），Zendesk ajax 处理程序接收完全解析的 JavaScript 对象，而不是原始 JSON 字符串。因此，根本没有理由更改网址。只需通过标准点或方括号表示法访问成员。因此，要使用 of 获取字段的`id`值`21732321`：

```
ticket.fields.filter(function(field) {
    return field.id == 21732321;
})[0].value; 
```

看起来你想要：

```
function countTickets(user) {
    var count = 0;
    response.tickets.forEach(function(ticket) {
        var filteredFields = ticket.fields.filter(function(field) {
            return field.id == 21732321;
        });
        if (filteredFields.length > 0 && filteredFields[0].value == user) {
            count++;
        }
    });
    return count;
} 
```

[http://jsfiddle.net/azRJM/](http://jsfiddle.net/azRJM/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:44:58.107

jQuery 让 jQuery.parseJSON 变得非常简单 这是一个简单的例子：[http ://api.jquery.com/jQuery.parseJSON/](http://api.jquery.com/jQuery.parseJSON/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T19:49:29.790

试试这个：

```
var json = '{ "url":"https://test.zendesk.com/api/v2/tickets/6.json", "id":6, "external_id":null, "via":{ "channel":"web", "source":{ "from":{}, "to":{}, "rel":null } }, "created_at":"2012-10-02T21:14:59Z", "updated_at":"2012-10-09T18:22:04Z", "type":"incident", "subject":"Test Ticket", "description":"this is a test ticket", "priority":"normal", "status":"closed", "recipient":null, "requester_id":271853958, "submitter_id":271853958, "assignee_id":270249903, "organization_id":22284363, "group_id":20363013, "collaborator_ids":[], "forum_topic_id":null, "problem_id":null, "has_incidents":false, "due_at":null, "tags":["2_2_2","arcb","end_user_1","var_2"], "fields":[ {"id":21704983,"value":"1"}, {"id":21708732,"value":"tried this"}, {"id":21708742,"value":"1"}, {"id":21713331,"value":"10/2/2012"}, {"id":21717086,"value":"arcb"}, {"id":21717236,"value":"10/2/2012"}, {"id":21717357,"value":""}, {"id":21728942,"value":null}, {"id":21732321,"value":"Test End-User"}], "custom_fields":[{"id":21704983,"value":"1"}, {"id":21708732,"value":"tried this"}, {"id":21708742,"value":"1"}, {"id":21713331,"value":"10/2/2012"}, {"id":21717086,"value":"arcb"}, {"id":21717236,"value":"10/2/2012"}, {"id":21717357,"value":""}, {"id":21728942,"value":null}, {"id":21732321,"value":"Test End-User"}], "satisfaction_rating":null }';

var obj = JSON.parse(json);
$('body').append('<div>Tags value: ' + obj.tags + '</div><br>');
var len = obj.custom_fields.length;

for(n = 0; n < len; n++)
{
    $('body').append('<div>Custom field value: ' + obj.custom_fields[n].value + '</div>');
} 
```

​</p>

看看它在行动：http: [//jsfiddle.net/7nbpq/5/](http://jsfiddle.net/7nbpq/5/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:45:50.963

尝试在服务器端返回使用 json_encode()，和/或在客户端接收数据时使用 jQuery.parseJSON()。这应该允许您获取数组中的数据，这将有很大帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T19:48:37.760

首先，您应该使用 $.getJSON - 它是[$.ajax function 的简写](http://api.jquery.com/jQuery.getJSON/)，专门用于检索 JSON：

```
$.getJSON('myfile.json', function(json) {

    // do something with json here 
}); 
```

其次，一旦有了 json，就可以使用点运算符访问它 - 无需解析它，因为它已经是一个对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-18T04:01:36.073

这可能会帮助您进行 JSON 检索和访问结果对象

[**在此处**](http://www.quirkscode.com/flat/forumPosts/src/getJSON/getJSON.html)尝试 使用控制台查看 console.log() 输出（在 Chrome 中按 F12，或在 FireFox 中使用 FireBug 等）：

JavaScript：

```
$(document).ready(function () {
    "use strict";
    $.getJSON("getJSON.json", function (data) {
        $("#look").on('click', function () {
            var $output = $("#output");
            var index, id = $("#input").val();
            var filtered = data.custom_fields.filter(function (element) {
                return element.id.toString() == id;
            });
            $output.empty();
            for (index in filtered) {
                $output.append("Value: " + filtered[index].value);
            }
            console.log(filtered);
        });
        console.log(data);
    });
}); 
```

HTML：

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
</head>
<body>
    Pleased input a custom field ID:  <input id="input" type="text" value="21732321" />
    <button id="look">Look Up By ID</button>
    <p id="output"></p>
<script type="text/javascript" src="getJSON.js"></script>
</body>
</html> 
```

JSON（这是您[**在此处**](http://jsonlint.com/)验证和格式化的 JSON ）：

```
{
    "url": "https://test.zendesk.com/api/v2/tickets/6.json",
    "id": 6,
    "external_id": null,
    "via": {
        "channel": "web",
        "source": {
            "from": {},
            "to": {},
            "rel": null
        }
    },
    "created_at": "2012-10-02T21:14:59Z",
    "updated_at": "2012-10-09T18:22:04Z",
    "type": "incident",
    "subject": "Test Ticket",
    "description": "this is a test ticket",
    "priority": "normal",
    "status": "closed",
    "recipient": null,
    "requester_id": 271853958,
    "submitter_id": 271853958,
    "assignee_id": 270249903,
    "organization_id": 22284363,
    "group_id": 20363013,
    "collaborator_ids": [],
    "forum_topic_id": null,
    "problem_id": null,
    "has_incidents": false,
    "due_at": null,
    "tags": [
        "2_2_2",
        "arcb",
        "end_user_1",
        "var_2"
    ],
    "fields": [
        {
            "id": 21704983,
            "value": "1"
        },
        {
            "id": 21708732,
            "value": "tried this"
        },
        {
            "id": 21708742,
            "value": "1"
        },
        {
            "id": 21713331,
            "value": "10/2/2012"
        },
        {
            "id": 21717086,
            "value": "arcb"
        },
        {
            "id": 21717236,
            "value": "10/2/2012"
        },
        {
            "id": 21717357,
            "value": ""
        },
        {
            "id": 21728942,
            "value": null
        },
        {
            "id": 21732321,
            "value": "Test End-User"
        }
    ],
    "custom_fields": [
        {
            "id": 21704983,
            "value": "1"
        },
        {
            "id": 21708732,
            "value": "tried this"
        },
        {
            "id": 21708742,
            "value": "1"
        },
        {
            "id": 21713331,
            "value": "10/2/2012"
        },
        {
            "id": 21717086,
            "value": "arcb"
        },
        {
            "id": 21717236,
            "value": "10/2/2012"
        },
        {
            "id": 21717357,
            "value": ""
        },
        {
            "id": 21728942,
            "value": null
        },
        {
            "id": 21732321,
            "value": "Test End-User"
        }
    ],
    "satisfaction_rating": null
} 
```

# ffmpeg - ffmpeg video-concatenation - 音频/视频轨道同步

> ID：12847262
> 
> 赞同：2
> 
> 时间：2012-10-11T19:42:46.183
> 
> 标签：ffmpeg, concatenation, audio-video-sync

我想连接随机格式的不同视频文件。首先，我将它们转换为 flv，将每个视频的帧速率调整为最低的相关视频。下一步是对它们进行解码并删除标题（但不是序列中第一个视频的标题，然后我将它们与 cat 连接，最后对结果序列进行编码。

但是从序列部分到序列部分，视频和音频轨道越来越不同步。

很高兴有任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T01:26:24.677

然后，您的问题是在进行 concat 过程时保持同步。经验法则，步骤越少越好。这应该可以解决您的问题。首先，使用 mpg 而不是 flv 作为中间格式。其次，将 -copyts 添加到每个命令（复制时间戳以保持同步）。此外，无需转到最低帧速率。您可以通过此过程保留最高视频的质量。尝试这个：

```
$ ffmpeg -i a.mp4 -qscale:v 1 -copyts a.mpg
$ ffmpeg -i b.flv -qscale:v 1 -copyts b.mpg 
```

现在你应该有两个（大）兼容视频质量的中间文件（变量：）`-qscale:v 1`。您已准备好将它们粘合在一起。

```
$ ffmpeg -i concat:"a.mpg|b.mpg" -c copy all.mpg 
```

如果你在 Windows 上，你会没事的。在 UNIX 风格上，您需要在管道之前添加一个反斜杠。（在我的版本中，我遇到了大量`buffer underflow / packet too large, ignoring buffer limits to mux it`错误。它们似乎是无害的。）现在您可以转换为您想要的任何更有用的格式，并且质量更逼真。

```
$ ffmpeg -i all.mpg -qscale:v 2 -copyts all.mp4 
```

我已经成功地使连接的视频保持同步，但质量似乎不如应有的好。也许调整中间文件参数。

# java - 在 JdbcCursorItemReader 中使用作业参数作为准备好的语句参数

> ID：12847266
> 
> 赞同：4
> 
> 时间：2012-10-11T19:43:05.287
> 
> 标签：java, spring, spring-batch

我有一份工作必须使用不同的工作参数多次运行。我想设置一个 JdbcCursorItemReader 来执行作业查询，itemReader 配置如下：

```
<bean id="tpsItemReader" 
    class="org.springframework.batch.item.database.JdbcCursorItemReader">
    <property name="dataSource" ref="myDataSource"/>
    <property name="sql" value="#{sqlQueries['tps.findStuffforSomeSubset']}"/>
    <property name="preparedStatementSetter">
        <bean class="com.initech.reports.tps.ParameterSetter">
            <!-- can't hardcode this, I want a job parameter here -->
            <constructor-arg value="A"/> 
        </bean>
    </property>
    <property name="rowMapper">
        <bean class="com.initech.reports.tps.CustomerRowMapper"/>
    </property>
</bean> 
```

并且作业配置如下：

```
<batch:job id="tpsReportJob">
    <batch:step id="tpsReportJob.generateReport">
        <batch:tasklet>
            <batch:chunk reader="tpsItemReader" 
            processor="tpsItemProcessor" 
            writer="tpsItemWriter" commit-interval="100000"/>
        </batch:tasklet>
    </batch:step>
</batch:job> 
```

parameterSetter 非常小：

```
package com.initech.reports.tps;

import java.sql.PreparedStatement;
import java.sql.SQLException;

import org.springframework.jdbc.core.PreparedStatementSetter;

public class ParameterSetter implements PreparedStatementSetter {

    private final String x;

    public ParameterSetter(String x) {this.x = x;}

    @Override
    public void setValues(PreparedStatement ps) throws SQLException {
        ps.setString(1, x);
    }
} 
```

这是使用spring-batch 2.1.8。

如何将作业参数放入查询中？

我想我已经接近了，我尝试将参数设置器配置更改为：

```
 <bean class="com.initech.reports.tps.ParameterSetter">
            <constructor-arg value="#{jobParameters['myParam']}"/>
        </bean> 
```

但我收到此错误：

```
Caused by: org.springframework.expression.spel.SpelEvaluationException: EL1008E:(pos 0): Field or property 'jobParameters' cannot be found on object of type 'org.springframework.beans.factory.config.BeanExpressionContext'
    at org.springframework.expression.spel.ast.PropertyOrFieldReference.readProperty(PropertyOrFieldReference.java:208)
    at org.springframework.expression.spel.ast.PropertyOrFieldReference.getValueInternal(PropertyOrFieldReference.java:72)
    at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:52)
    at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:93)
    at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:88)
    at org.springframework.context.expression.StandardBeanExpressionResolver.evaluate(StandardBeanExpressionResolver.java:139)
    ... 51 more 
```

我发现[了一个非常相似的问题](https://stackoverflow.com/q/6078009/217324)，这个问题和这个问题的区别在于我没有要注释的阅读器类，我只有 xml 条目，因为我想避免创建自己的 itemReader。（我可以尝试覆盖 jdbcCursorItemReader 类只是为了能够对其进行注释......）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T20:48:29.263

只需将 scope 属性添加到 parameterSetter 类：

```
 <bean class="com.initech.reports.tps.ParameterSetter"
        scope="step">
        <constructor-arg value="#{jobParameters['myParam']}"/>
    </bean> 
```

# node.js - 通过 VNC 连接安卓模拟器

> ID：12847271
> 
> 赞同：6
> 
> 时间：2012-10-11T19:43:18.383
> 
> 标签：node.js, canvas, android-emulator, vnc, vnc-viewer

我们如何在[noVNC](http://kanaka.github.com/noVNC/noVNC/vnc.html)的帮助下使用 javascript 通过 VNC 连接到 Android 模拟器？我想在我的浏览器上渲染模拟器。怎么做。谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-20T20:06:00.697

您可以在控制台上启动模拟器`emulator -avd <the avd name>`并添加 qemu 的选项，`-qemu`在您的情况下`-qemu -vnc :2`将启动在 Port 侦听的 VNC 服务器`5902`。如果你得到一个错误，你的 keymap 没有找到，你可以创建一个符号链接`android-sdks/tools/keymaps`到你本地 qemu 安装的 keymaps 文件夹。

直到现在我才知道如何将鼠标转发到 VNC 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-22T12:57:36.163

*在*模拟器中运行 vnc 服务器可能会更好。

在你的模拟器上安装一个 vnc 服务器（[Fastdroid](https://code.google.com/p/fastdroid-vnc/)很好）。

现在，您可以在没有窗口的情况下使用

```
emulator -avd avd_name -no-window -qemu 
```

# c++ - 不允许对自定义类型进行多次隐式转换？

> ID：12847272
> 
> 赞同：17
> 
> 时间：2012-10-11T19:43:19.960
> 
> 标签：c++, type-conversion, implicit-conversion

```
class C {
public:
    C() { }
};

class B {
public:
    B(C c) { }
    B() { }
};

class A {
public:
    A(bool b) { }
    A(B b) { }
};

int main() {
    A a1 = true; // bool -> A        is allowed
    A a2 = B();  // B -> A           is allowed

    A a3 = 7;    // int -> bool -> A is allowed
    A a4 = C();  // C -> B -> A      isn't allowed
} 
```

为什么我可以使用两步隐式转换`bool`但不能使用它`C`？描述多步隐式转换的一般规则是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-11T19:44:28.310

没有多步*用户定义的*隐式转换。

```
int -> bool -> A 
```

是允许的，因为`int->bool`转换不是用户定义的。

### 12.3 转换 [class.conv]

> 1 类对象的类型转换可以由构造函数和转换函数指定。这些转换称为用户定义的转换，用于隐式类型转换（第 4 条）、初始化（8.5）和显式类型转换（5.4、5.2.9）。
> 
> 2 用户定义的转换仅适用于明确的情况（10.2、12.3.2）。转换遵守访问控制规则（条款 11）。在歧义解决（3.4）之后应用访问控制。
> 
> 3 [注：有关在函数调用中使用转换的讨论以及下面的示例，请参见 13.3。——尾注]
> 
> **4 最多一个用户定义的转换（构造函数或转换函数）隐式应用于单个值。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T21:08:04.600

由于这种结构是完全合法的

```
A a4((C())); 
```

问题是，您使用复制初始化。真的，你的例子等于

```
A a4((A(C())); 
```

8.5/16

> 初始化器的语义如下。目标类型是正在初始化的对象或引用的类型，源类型是初始化表达式的类型。如果初始化器不是单个（可能是带括号的）表达式，则未定义源类型。
> 
> 如果目标类型是（可能是 cv 限定的）类类型：
> 
> — 否则（即，对于剩余的复制初始化情况），可以从源类型转换到目标类型或（当使用转换函数时）到其派生类的用户定义转换序列被枚举，如 13.3 中所述.1.4，并且通过重载决议（13.3）选择最好的一个。

13.3.1.4/1

> 在 8.5 中指定的条件下，作为类类型对象的复制初始化的一部分，可以调用用户定义的转换来将初始化表达式转换为正在初始化的对象的类型。
> 
> 重载解析用于选择要调用的用户定义转换。假设“cv1 T”是被初始化对象的类型，T是类类型，候选函数的选择如下： — T的转换构造函数（12.3.1）是候选函数。
> 
> — 当初始化表达式的类型是类类型“cv S”时，考虑 S 及其基类的非显式转换函数。

13.3.3.1/4

> 但是，当考虑构造函数或用户定义转换函数的参数时，当在类复制初始化的第二步中被调用以复制/移动临时对象时，13.3.1.3 为候选者，当传递时由 13.3.1.7初始化器列表作为单个参数，或者当初始化器列表只有一个元素并且对某个类 X 的转换或对（可能是 cv 限定的）X 的引用被认为是 X 的构造函数的第一个参数时，或由**13.3.1.4**、13.3.1.5 或 13.3.1.6 在所有情况下，**仅考虑标准转换序列和省略号转换序列。**

在这种情况下，不考虑您的用户定义转换 (C -> B)。

# objective-c - 何时调用 [super viewDidLoad] 和 [super viewDIdUnload]？

> ID：12847273
> 
> 赞同：1
> 
> 时间：2012-10-11T19:43:20.147
> 
> 标签：objective-c, ios, viewdidload, viewdidunload

在我的大部分代码中，我对 viewDidLoad 和 viewDidUnload 进行了以下设置：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    //do stuff...
}

- (void)viewDidUnload
{
    [super viewDidUnload];

    //do stuff...
} 
```

但是，我想知道...调用 viewDidLoad 和 viewDidUnload 是否重要？每个人应该在我“做事”之前还是之后？

换句话说，每个人应该在方法的开始还是结束？

编辑：更复杂的是，这是 Apple 的默认 viewDidUnload 方法，“似乎”建议`[super viewDidUnload]`首先调用它......

```
- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:48:33.607

我确实在*destructors*`super`中调用last ，在*constructors*中调用first 。是一种*析构函数*，所以我会最后调用它。但在这种情况下，这是品味问题。**`viewDidUnload`**

 ***此外，请注意 -`viewDidUnload`自 iOS 6 以来已弃用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-09T07:18:21.493

假设您有 2 个班级，一个父母和一个孩子。子继承自父。他们有一个名为 greet 的方法，它返回一个字符串。

下面是父方法的样子：

代码：

```
-(NSString *)greet {
     return @"Hello";
 } 
```

我们希望孩子向父母学习。所以我们用 super 来表达妈妈的问候方式，但也有我们自己的小补充。

代码：//从父级继承

```
 -(NSString *)greet {
     NSString *parentGreeting = [super greet];
     return [parentGreeting stringByAppendingString:@", Mommy"]
   } 
```

所以现在父母打招呼“你好”，孩子打招呼“你好，妈妈”。稍后，如果我们将父母的问候语更改为只返回“Hi”，那么两个类都会受到影响，您将有“Hi”和“Hi, Mommy”。

super 用于调用超类定义的方法。它用于访问已被子类覆盖的方法，以便类可以将自己的代码包装在其父类实现的方法周围。如果您要进行任何类型的继承，这将非常方便。***

# ruby-on-rails-3 - 如何正确测试使用未读 gem 的模型（在 rspec 中）？

> ID：12847278
> 
> 赞同：0
> 
> 时间：2012-10-11T19:43:35.800
> 
> 标签：ruby-on-rails-3, testing, gem, rspec2, factory-bot

我有一个应用程序使用[未读 gem](https://github.com/ledermann/unread)将某些模型标记为用户已读或未读。这颗宝石非常甜美，可以在应用程序中完美运行。不幸的是，在进行一些涉及模型的 Rspec 测试时，我遇到了一些奇怪的错误，`act_as_readable`而我一生都无法弄清楚下一步该去哪里。我希望令人惊叹的 StackOverflow 社区可以帮助我。以下是必要的细节：

## 模型方法

```
def unread_subscriptions
    reviews = Array.new
    subscriptions = Subscription.where(user_id: self.id)

    unless subscriptions.empty?
        subscriptions.each do |subscription|
            subscription_reviews = Review.where(user_id: subscription.subscription_user_id)

            unless subscription_reviews.empty?
                subscription_reviews.each do |subscription_review|
                    if subscription_review.unread?(self)
                        reviews << subscription_review
                    end
                end
            end
        end
    end

    reviews.sort_by(&:created_at).reverse
end 
```

*这段代码有一些明显的地方可以改进或重构，这正是我为它编写测试的原因，所以请让我们继续讨论手头的错误。*

## Rspec 测试块

```
describe "#unread_subscriptions", focus: true do
    context "when subscriptions and subscription reviews are not empty" do
        let(:subscription_user) { FactoryGirl.create(:user) }
        let(:reviews) { FactoryGirl.create_list(Review, 3, user: subscription_user) }

        before(:each) {
            subscription_double = double(Subscription)
            subscription_double.stub(:where)
                                .with(user_id: user.id)
                                .and_return(
                                    FactoryGirl.create(:subscription, 
                                        user_id: user.id, 
                                        subscription_user_id: subscription_user.id))
            review_double = double(Review)
            review_double.stub(:unread_by).with(user).and_return(reviews)
            review_double.stub(:unread?).with(user).and_return(true)
            review_double.stub(:where).with(user_id: subscription_user.id).and_return(reviews)
        }

        its(:unread_subscriptions) { should be_instance_of(Array) }
        its(:unread_subscriptions) { should_not be_empty }
    end
end 
```

以上所有代码似乎都可以正常工作。由`subscription_user`FactoryGirl 正确创建并具有 id。`reviews`FactoryGirl 生成的数组是`create_list`合法的并且已`user_id`正确填写。从上面的代码中可以看出，我已经尝试将类中`unread`gem的方法存根，`Review`但它们似乎不能正常工作。

## 审查工厂

```
FactoryGirl.define do
    sequence :created_at do |n|
        n.minutes.ago
    end
    factory :review do
        user
        bar
        body "MyText"
        rating 3
        created_at
    end
end 
```

我运行这些测试`rspec spec/models/user_spec.rb -f d`并获得以下输出：

```
Run options: include {:focus=>true}

User
  #unread_subscriptions
    when subscriptions and subscription reviews are not empty
      unread_subscriptions
        example at ./spec/models/user_spec.rb:231 (FAILED - 1)
      unread_subscriptions
        example at ./spec/models/user_spec.rb:232 (FAILED - 2)

Failures:

  1) User#unread_subscriptions when subscriptions and subscription reviews are not empty unread_subscriptions 
     Failure/Error: its(:unread_subscriptions) { should be_instance_of(Array) }
     ActiveRecord::StatementInvalid:
       Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AND read_marks.timestamp     >= reviews.created_at WHERE `reviews`.`id` = 1 AND ' at line 4: SELECT  1 FROM `reviews` LEFT JOIN read_marks ON read_marks.readable_type  = 'Review'
                                                         AND read_marks.readable_id    = reviews.id
                                                         AND read_marks.user_id        = 
                                                         AND read_marks.timestamp     >= reviews.created_at WHERE `reviews`.`id` = 1 AND (read_marks.id IS NULL) ORDER BY created_at DESC LIMIT 1
     # ./app/models/user.rb:217:in `block (2 levels) in unread_subscriptions'
     # ./app/models/user.rb:216:in `block in unread_subscriptions'
     # ./app/models/user.rb:212:in `unread_subscriptions'
     # ./spec/models/user_spec.rb:231:in `block (4 levels) in <top (required)>'

  2) User#unread_subscriptions when subscriptions and subscription reviews are not empty unread_subscriptions 
     Failure/Error: its(:unread_subscriptions) { should_not be_empty }
     ActiveRecord::StatementInvalid:
       Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AND read_marks.timestamp     >= reviews.created_at WHERE `reviews`.`id` = 4 AND ' at line 4: SELECT  1 FROM `reviews` LEFT JOIN read_marks ON read_marks.readable_type  = 'Review'
                                                         AND read_marks.readable_id    = reviews.id
                                                         AND read_marks.user_id        = 
                                                         AND read_marks.timestamp     >= reviews.created_at WHERE `reviews`.`id` = 4 AND (read_marks.id IS NULL) ORDER BY created_at DESC LIMIT 1
     # ./app/models/user.rb:217:in `block (2 levels) in unread_subscriptions'
     # ./app/models/user.rb:216:in `block in unread_subscriptions'
     # ./app/models/user.rb:212:in `unread_subscriptions'
     # ./spec/models/user_spec.rb:232:in `block (4 levels) in <top (required)>'

Finished in 8.88 seconds
2 examples, 2 failures

Failed examples:

rspec ./spec/models/user_spec.rb:231 # User#unread_subscriptions when subscriptions and subscription reviews are not empty unread_subscriptions 
rspec ./spec/models/user_spec.rb:232 # User#unread_subscriptions when subscriptions and subscription reviews are not empty unread_subscriptions 
```

由于某种原因，`readmarks`查询没有获得评论的用户 ID（即使评论有关联的用户）。我对这里发生的事情完全不知所措，真的需要有人的天才来让我指出正确的方向。感谢任何人都可以提供的任何帮助。为了完整起见，以下是有关我的环境的一些事实：

*   **操作系统**：Mac OSX 10.7.5
*   **Ruby 版本**：ruby 1.9.3p194（2012-04-20 修订版 35410）[x86_64-darwin11.4.0]
*   **Rails 版本**：Rails 3.2.3
*   **RVM 版本**：rvm 1.15.8（稳定）
*   **RSpec 版本**：2.11.1
*   **未读宝石版本**：0.1.1
*   **factory_girl_rails 版本**：4.1.0

**额外**：我也在[这个线程](https://github.com/ledermann/unread/pull/12)中使用关于该`wait`方法的共享宏的建议。它没有修复错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T08:53:23.457

我没有详细检查您的代码，但在我看来，您正在使用带有无效参数的范围“unread_by”。它必须是持久用户（具有 ID）。

我刚刚在 gem 中添加了改进的参数检查并更新了 0.1.2，因此请使用最新版本测试您的代码。

# javascript - .net 的 javascript 中的 string.format()

> ID：12847279
> 
> 赞同：-2
> 
> 时间：2012-10-11T19:43:42.660
> 
> 标签：javascript, jquery

> **可能重复：**
> [JavaScript 等价于 printf/string.format](https://stackoverflow.com/questions/610406/javascript-equivalent-to-printf-string-format)
> [等价于 JQuery 中的 String.format](https://stackoverflow.com/questions/1038746/equivalent-of-string-format-in-jquery)

是否有任何内置的 javascript 或 jquery 函数在 string.format() 中表现得像 .net 的？

或者像javascript的console.log字符串reclament？

console.log('aString %s', 'valueToReplace')

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:46:03.270

没有本机解决方案，但这里是许多部分解决方案之一：http: [//monocleglobe.wordpress.com/2010/01/12/everybody-needs-a-little-printf-in-their-javascript/](http://monocleglobe.wordpress.com/2010/01/12/everybody-needs-a-little-printf-in-their-javascript/)

# php - PHP通过拖放合并PDF

> ID：12847284
> 
> 赞同：0
> 
> 时间：2012-10-11T19:44:19.773
> 
> 标签：php, pdf, drag-and-drop, merge

我需要一种方法来集成这两个功能。一个实体[的单击和拖动示例单击并拖动](http://skfox.com/jqExamples/SortableSelectable.html) 和 PDFMerger [PDFMerger](http://pdfmerger.codeplex.com/)

我正在使用 PDFMerger，效果很好

```
<?php 
```

包括“PDFMerger.php”；

$pdf = 新 PDFMerger;

$pdf->addPDF('testFile5.pdf', 'all') ->addPDF('testFile57.pdf', 'all')

```
->merge('download', 'samplepdfs/TEST2.pdf');
?> 
```

它很容易结合2个pdf。问题是我需要结合这两个功能。我需要用户能够选择他们想要组合的 pdf，我希望通过上面的链接进行这种 VIA 拖放操作。任何人都可以在正确的方向上轻推我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:00:37.743

您只需要将数据发布到您的 php 脚本。在您的 jQuery 示例中，您的该字段带有逗号分隔值，通常是隐藏的。确保它在表单内。然后，您只需使用提交按钮发布表单。

我相信你可以自己编写html代码，php脚本应该是这样的：

```
<?php
include 'PDFMerger.php';
$files = explode(",", $_POST['postOrder']); //or your name of the field

$pdf = new PDFMerger;

foreach ($files as $file) {
    $pdf->addPDF($file, 'all') 
}

$pdf->merge('download', 'samplepdfs/TEST2.pdf');
?> 
```

当然，您需要做更多的检查以确保安全。

# javascript - 修改函数以传递图像

> ID：12847287
> 
> 赞同：1
> 
> 时间：2012-10-11T19:44:44.940
> 
> 标签：javascript, html, canvas

我正在使用我们作为作业的一部分提供的模板制作 Javascript html 游戏。我对 Javascript 完全陌生，但我设法将我的所有游戏元素都包含在内，除了我的导弹。我想从下面的代码（因为它使用彩色矩形）而不是实际图像中更改导弹，以便我的玩家可以从 png 中发射导弹。导弹有一个数组，但函数本身使用的是 rgb 颜色。如何将图像传递给函数？

我也有一个附加到游戏文件的外部显示对象。任何建议都会很好，因为我被卡住了。

导弹功能：

```
function Missile ( x,y, width, height, dx, dy) { //dx and dy is the direction the bullet will fire.

    //no image because we will overright the draw method to use canvas drawing.
    DisplayObject.call(this,'missile', undefined, x,y, width, height);

    //declare private variables

    var alive = true;

    var facingX = dx;
    var facingY = dy;

    var hue = 0;
    var sat = 1.0;
    var lightness = 0.5;

    // public functions

    this.update = function () {
        //move missile
        hue+=0.06;
        if(hue>1) hue=0;
        this.x += facingX*15;
        this.y += facingY*15;
    }

    this.draw = function (context) {

        for(var i = 0; i<4; i++) {

            var h = hue-(i*0.06);
            if(h<0) h+=1.0;
            var rgb = hslToRgb(h,sat,lightness);
            context.fillStyle = "rgb("+Math.round(rgb[0])+","+Math.round(rgb[1])+","+Math.round(rgb[2])+")";
            context.fillRect(this.x-(facingX*i*5),this.y-(facingY*i*5),5,5);
        }
    }

    this.kill = function () {
        alive = false;
    }

    this.isDead = function () {
        return !alive;
    }
}

Missile.prototype = new DisplayObject();

function hslToRgb(h, s, l){
    var r, g, b;

    if(s == 0){
        r = g = b = l; // achromatic
    }else{
        function hue2rgb(p, q, t){
            if(t < 0) t += 1;
            if(t > 1) t -= 1;
            if(t < 1/6) return p + (q - p) * 6 * t;
            if(t < 1/2) return q;
            if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;
            return p;
        }

        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        var p = 2 * l - q;
        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);
    }

    return [r * 255, g * 255, b * 255];
} 
```

显示对象：

```
Image.prototype.draw = function draw (context,x,y, w,h) {
    if(context) context.drawImage(this,x,y,w || this.width, h || this.height);
};

//define rectangle object that DisplayObject will inherit from.
var Rect2d = function (x,y,width,height) {
    this.x = x || 0;
    this.y = y || 0;
    this.width = width || 1;
    this.height = height || 1;
};

var DisplayObject = function (name, image, x,y, width, height) {
    if(image) Rect2d.call(this,x,y,width || image.width, height || image.height);
    else Rect2d.call(this,x,y,width,height);
    this.name = name || '';
    this.img = image;
    this.alpha = 1.0;
};

DisplayObject.prototype = new Rect2d(); 
//if you do not use new here then anything you add to DisplayObject.prototype is added to Rect2d            

//add functions to Display object. Because these are added to the prototype 
//they are not visible if you use the hasOwnProperty method on a DisplayObject.
DisplayObject.prototype.setImage = function (img) {
    this.img = img;
    return this;
};

DisplayObject.prototype.scaleToImage = function () {
    if(this.img) {
        this.width = this.img.width;
        this.height = this.img.height;
    }
    return this;
};

//this function wraps our new Image draw() method
DisplayObject.prototype.draw = function (context) {
    //var tmp_alpha = context.globalAlpha;
    //context.globalAlpha = this.alpha;
    this.img.draw(context, this.x,this.y,this.width,this.height);
    //context.globalAlpha = tmp_alpha;
    return this;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:15:37.907

根据 DisplayObject 的定义方式，可以像添加参数一样简单：

```
function Missile ( x,y, width, height, dx, dy, image) {     
    DisplayObject.call(this,'missile', image, x,y, width, height);

    ...
} 
```

然后您只需删除覆盖的`draw`方法。

如果您发布 DisplayObject 的代码，我也许可以给您一个更好的答案。

# regex - 如何选择除图案以外的所有文本

> ID：12847289
> 
> 赞同：0
> 
> 时间：2012-10-11T19:44:49.027
> 
> 标签：regex

我有一个文本文件，我想从中获取所有已翻译的字符串。

所有的翻译都是这样的：

`_('string')`

所以我有这个正则表达式：

`(_\(['"].+['"]\))`

哪个找到了我所有的翻译......现在我该如何反转它以便删除其他所有内容？

我最终做了：

`egrep "_\('.+?)" ~myfile.py -o >> ~/Desktop/translations.txt`

`egrep '_\(".+?)' ~myfile.py -o >> ~/Desktop/translations.txt`

我什至无法一口气完成，因为我不知道如何在 shell 中转义单引号 :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:51:08.243

Negating a regular expression is often pretty complicated. Instead of deleting everything else with regular expressions, you are much better off finding all matches of your current regex and then joining the matches together to create a string of only the matches.

# c# - GetAllUsers 信息（来自 SimpleMembership 给出的 UserProfile 和成员资格表）与实体框架？

> ID：12847291
> 
> 赞同：0
> 
> 时间：2012-10-11T19:44:54.833
> 
> 标签：c#, asp.net-mvc, entity-framework, simplemembership

首先，我对 .NET 框架和周围的所有东西都很陌生。我想做的是为我的 n 层 MVC4 应用程序构建我的管理部分，其中安全性处理 SimpleMembership。（默认）

关于标准 MVC4 模板，为了创建我的 GetAllUsers 方法，我决定使用 EF 逆向工程代码优先工具在我的域项目中创建我的成员实体（UserProfile、Membership、OAuthMembership 和 Roles）并生成我的上下文和我的存储库我的 DAL 项目的 T4 模板。

我很惊讶 Membership Table 没有与 UserProfile 链接（正如您在架构中看到的那样），我很高兴知道为什么（？第一个问题）

![会员模式](../Images/c05a89ae71535ff0324a464d23598855.png)

在控制台“测试”应用程序中，（最终目标是创建一个网格视图，我可以在其中将成员资格表和 UserProfile 表信息链接在一起）我创建了一种方法，以便为我的用户获取共享的成员资格和 UserProfile 信息（我的服务项目尚未设置）。

这是正确的方法吗？（第二个问题）

```
 private static void GetAllUsers()
    {
        using (var MembershipRepository = new MembershipRepository())
        {
            var i = 1;
            foreach (var member in MembershipRepository.All)
            {
                Console.Write("{0}: {1} ", i, member.UserId);
                using (var UserProfileRepository = new UserProfileRepository())
                {
                    Console.WriteLine("{0}", UserProfileRepository.Find(member.UserId).UserName);
                }
                i += 1;
            }
        }
        WaitConsole();
    } 
```

（注意：我还没有使用 UnitOfWork 和 IoC，但我打算这样做）

非常感谢我知道我是否走在正确的轨道上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T06:57:47.580

我真的建议您不要使用默认的成员资格模式。它的设计很糟糕，您不需要其中的大部分数据。而是创建您自己的数据库并定义您自己的成员资格和角色提供者，因为它似乎适合您。

看看我之前的回答：[https ://stackoverflow.com/a/10067020/1241400](https://stackoverflow.com/a/10067020/1241400)

# ios - UIScrollView 中缺少 UIToolBar

> ID：12847294
> 
> 赞同：0
> 
> 时间：2012-10-11T19:44:59.887
> 
> 标签：ios, xcode, cocoa-touch

我将 UIToolBar 添加到我的 UITextField 使用：

```
- (void)viewDidLoad {

    [super viewDidLoad];

    self.email.delegate = self;
    self.password.delegate = self;

    UIToolbar* toolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, self.view.bounds.size.width, 44)];

    UIBarButtonItem* previous = [[UIBarButtonItem alloc] initWithTitle:@"Anterior" style:UIBarButtonItemStyleBordered target:self action:@selector(move:)];
    UIBarButtonItem* next = [[UIBarButtonItem alloc] initWithTitle:@"Próximo" style:UIBarButtonItemStyleBordered target:self action:@selector(move:)];
    UIBarButtonItem* space = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:(UIBarButtonSystemItemFlexibleSpace) target:nil action:nil];
    UIBarButtonItem* ok = [[UIBarButtonItem alloc] initWithTitle:@"Ok" style:UIBarButtonItemStyleBordered target:self action:@selector(ok:)];

    [toolbar setItems:[[NSArray alloc] initWithObjects:previous, next, space, ok, nil]];

    [toolbar setTranslucent:YES];
    [toolbar setTintColor:[UIColor blackColor]];

    for (UIView* view in self.view.subviews) {
        if ([view isKindOfClass:[UITextField class]]) {
            [(UITextField*)view setInputAccessoryView:toolbar];
        }
    }

} 
```

现在我将 UIScrollView 添加到我的 UIViewController 并且我的 UIToolBar 不再显示。我错过了什么？我想我将工具栏添加到视图而不是滚动视图，并且因为滚动视图位于视图上方，所以我看不到工具栏。我该如何解决？我需要添加到滚动视图以将内容移动到键盘后面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:34:09.350

您说您已将 UIScrollView 添加到 UIViewController。我认为这意味着`self.email`and`self.password`现在是此滚动视图的子视图，而不是主 UIViewController 的子视图`view`。因此，遍历`view`属性子视图的代码将找不到您的 UITextFields。

所以你的代码：

```
for (UIView* view in self.view.subviews) { 
```

应该看起来像（我假设 scrollView 是一个属性）：

```
for (UIView* view in self.scrollView.subviews) { 
```

处理此问题的另一种方法是使用您的 UITextFieldDelegate 方法添加`inputAccessoryView`属性以响应开始编辑。例如，

```
- (void) textFieldDidBeginEditing:(UITextField *)textField{
    [textField setInputAccessoryView:keyboardToolbar];
} 
```

# c# - int 到未知到双重转换问题

> ID：12847295
> 
> 赞同：0
> 
> 时间：2012-10-11T19:44:59.710
> 
> 标签：c#, .net, user-interface, dll, type-conversion

我创建了一个程序来读取/写入来自另一个程序的数据。我在程序中设置了一个值 7（类型为 memory real），然后当我在 Visual Studio 中读取该值时，它给了我一个 string `7.0000000000000`。所以我创建了这个转换片段，它适用于 int 类型的数据，它也在 VS 中给了我一个字符串。我不知道这两种数据类型之间的区别，但从逻辑上讲，如果两种数据类型都给我一个**字符串**，我应该能够运行这段代码。为什么内存真实数据在这里跳过if？

```
 if (Regex.IsMatch(value, "^[0-9 ]+$"))
                {
                    ValueBox.Text = Double.Parse(value).ToString();
                }
                else
                {
                    ValueBox.Text = value;
                } 
```

编辑：我使用 2 个给定的 dll，我相信 dll 中存在转换问题，但我的代码应该*仍然*可以工作。

编辑 2：此代码是我程序的一部分，值和其他变量已经定义

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T19:53:03.640

跳过正则表达式并使用 TryParse

[Double.TryParse 方法](http://msdn.microsoft.com/en-us/library/994c0zb1.aspx)

[Int32.TryParse 方法](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)

或者可以只格式化“N0”

d.ToString("N0")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:48:58.863

在数字范围之后，您的正则表达式中有一个额外的空间，但这应该不是什么大问题。它的编写方式，您的正则表达式将匹配任何数字或空格序列。

这将只匹配一个整数字符串：

```
if (Regex.IsMatch(value, "^[0-9]+$"))
... 
```

我不确定这是否是基于初始化的问题`value`，但它肯定不会匹配整数字符串。

如果您需要在正则表达式中考虑十进制值：

```
if (Regex.IsMatch(value, "^[0-9]+(\.[0-9]+)?$"))
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:03:54.643

你的问题没有清楚地描述`value`来自哪里。

我怀疑您应该使用其中一种重载`.ToString()`方法将原始数据类型转换为`value`.
然后转换`ValueBox.Text`回使用`Convert.ToDouble()`（或所需输出类型的适当方法）。您也可以使用`Double.TryParse()`我喜欢的（或适当的类型）。

参考： [Double.ToString 方法 (String)](http://msdn.microsoft.com/en-us/library/kfsatb94%28v=vs.100%29.aspx)
[标准数值格式字符串](http://msdn.microsoft.com/en-us/library/dwhawy9k%28v=vs.100%29.aspx)
[自定义数值格式字符串](http://msdn.microsoft.com/en-us/library/0c899ak8%28v=vs.100%29.aspx)
[Double.TryParse 方法 (String, Double%)](http://msdn.microsoft.com/en-us/library/994c0zb1.aspx)

# ajax - 将 knockoutjs 视图模型传递给多个 ajax 调用

> ID：12847297
> 
> 赞同：3
> 
> 时间：2012-10-11T19:45:01.130
> 
> 标签：ajax, html, knockout.js

我有一个函数可以进行 ajax 调用以获取初始数据并将其保存到视图模型中。然后，我将返回的视图模型（对数据进行字符串化）传递给另一个函数，该函数进行另一个 ajax 调用，依此类推。每个函数都绑定到 onclick 按钮事件。当我将初始视图模型放在 document.ready 中时，我只能将它传递给其他函数。我从每个函数中获得的数据都是 100% 正确的。但是，每当我绑定视图模型时，它都会覆盖以前的绑定并且值不成立。下面是代码：

# JavaScript

```
<

script type="text/javascript" language='javascript'>
        var MyProject = {};
        var viewModel;
        MyProject.viewModel = "";
        var invoiceModel;
        $(document).ready(function InitializeInvoice() {
                    $.ajax({
                        type: "Post",
                        url: "Default.aspx/InitializeModel",
                        data: {},
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        async: false,
                        success: initializesinvoice
                    });
                function initializesinvoice(msg) {
                    var defaultdata = msg.d.Data;
                    invoiceModel = defaultdata;
                    MyProject.viewModel = ko.mapping.fromJS(invoiceModel);
                    ko.applyBindings(MyProject.viewModel)
                };
            })
            function GetVendorInvoiceDefaults() {
                MyProject.viewModel = JSON.stringify(invoiceModel);
                var data = '{invoice:' + MyProject.viewModel + '}';
                $.ajax({
                    type: "Post",
                    url: "Default.aspx/GetVendorInvoiceDefaults",
                    data: data,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: GetVendorInvoiceDefaultsSuccess
                });
            }
            function GetVendorInvoiceDefaultsSuccess(msg) {
                var defaultdata = msg.d.Data;
                invoiceModel = defaultdata;
                MyProject.viewModel = ko.mapping.fromJS(invoiceModel);
                ko.applyBindings(MyProject.viewModel)
            };

             function GetVendorCode() {
                var vendormodel = JSON.stringify(invoiceModel);
                var data = '{invoice:' + vendormodel + '}';
                $.ajax({
                    type: "Post",
                    url: "Default.aspx/GetVendorCode",
                    data: '{invoice:' + vendormodel + '}',
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: GetVendorCodeSucess
                });
            }

            function GetVendorCodeSucess(msg) {
                var defaultdata = msg.d.Data;
                MyProject.viewModel = ko.mapping.fromJS(defaultdata);
                ko.applyBindings(MyProject.viewModel)
            };
#HTML#
    <p> Invoice Description <asp:TextBox ID="txtdesc" runat="server" data-bind="value:InvoiceDescription"> </asp:TextBox></p>    
    <p> Distribution Code <asp:TextBox ID="txtdistcode" runat="server" data-bind="value:DistributionCode"></asp:TextBox></p>
    <p> Vendor Code <asp:TextBox ID="txtvendor" runat="server" data-bind="value:VendorCode" ></asp:TextBox></p>
    <p> <button onclick="InitializeInvoice()">InitializeInvoice</button></p>
    <p><button id="btndefaults" onclick="GetVendorInvoiceDefaults()">GetVendorInvoiceDefaults</button></p>
    <p><button id="btnvendor" onclick="GetVendorCode()">GetVendorCode</button><p>
</pre>

#ASPX file#
    namespace WebApplication9
    {

    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected override void OnLoad(EventArgs e)
        {
            if (IsPostBack)
            {

                clientSideIsPostBack.Value = "Y";
            }

            else
                    clientSideIsPostBack.Value = "N";

                base.OnLoad(e);
        }

        [WebMethod]
        public static JsonResult  InitializeModel()
        {

            var Invoice = new Invoice() { InvoiceNumber = "1235", InvoiceDescription = "Hello World", DistributionCode = "" };
            JsonResult r = new JsonResult();
            r.Data = Invoice;
            return r;    //serializer.Deserialize(Invoice, typeof(Invoice)) as JsonResult;
        }

        [WebMethod]
        public static JsonResult GetVendorInvoiceDefaults(Invoice invoice)
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            invoice.DistributionCode = "HELLO WORLD";
            JsonResult r = new JsonResult();
            r.Data = invoice;
            return r;
            //return new JsonResult() { Data = invoice };
        }

        [WebMethod]
        public static JsonResult GetVendorCode(Invoice invoice)
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            invoice.VendorCode = "AHM";
            JsonResult r = new JsonResult();
            r.Data = invoice;
            return r;
        }

    }

    public class Invoice
    {
        private string distributionCode;
        private string vendorcode;

        public string InvoiceNumber { get; set; }
        public string InvoiceDescription { get; set; }
        public string DistributionCode 
        {
            get
            {
                return distributionCode ?? string.Empty;
            }
            set
            {
                distributionCode = value;
            }
        }
        public string VendorCode 
        {
            get
            {
                return vendorcode ?? string.Empty;

            }
            set 
            {
                vendorcode = value;

            }
        }

    }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T02:57:35.463

因此，您永远不应该在多个地方或不止一次（每个 div）进行此调用`ko.applyBindings(MyProject.viewModel).`

一旦应用了视图模型的绑定，它们就会被应用。**你永远不会重复这个步骤！**这个非常重要。当`MyProject.viewModel`更新中的值时，绑定会自动更新 HTML。这就是重点。当您`applyBindings`多次调用时，您将创建各种意想不到的行为。

设置您的 viewModel，applyBindings 一次，然后让所有其他代码正确更新 viewmodel。我建议在执行任何其他操作*之前*`document.ready`在处理程序中执行此操作，例如连接 ajaxy 的东西。

 *其次，当使用 KO Mapping 插件时，[根据文档](http://knockoutjs.com/documentation/plugins-mapping.html)，您可以像这样更新整个视图模型：每次`ko.mapping.fromJS(data, viewModel);`调用都会覆盖您的视图模型。`MyProject.viewModel = ko.mapping.fromJS(invoiceModel);`

这是 Knockout 的另一个关键方面。因为 observables 是**函数**，你可以通过将新值作为参数传递来更新它们，而不是像普通变量一样覆盖它们。

对：

`viewModel.observable(newValue)`

错误的：

`viewModel.observable = newvalue`*

# c# - 将 IEnumerable 拆分为两个

> ID：12847298
> 
> 赞同：12
> 
> 时间：2012-10-11T19:45:03.300
> 
> 标签：c#, linq

我想将一个列表分成两个列表，一个可以直接处理，另一个是剩余的，它将沿着链传递给其他处理程序。

输入：

*   一份物品清单
*   一种过滤方法，用于确定将项目包含在哪个列表中。

输出：

*   一份“真实”的清单
*   “虚假”列表

这已经存在了吗？也许是我目前没有想到的 Linq 方法？否则，有没有人有一个好的 C# 示例？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-11T19:49:36.230

这是一种简单的方法。请注意，`ToLookup`热切地评估输入序列。

```
List<int> list = new List<int> { 1, 2, 3, 4, 5, 6 };

var lookup = list.ToLookup(num => num % 2 == 0);

IEnumerable<int> trueList = lookup[true];
IEnumerable<int> falseList = lookup[false]; 
```

您可以使用`GroupBy`惰性求值输入序列，但它不是*很*漂亮：

```
var groups = list.GroupBy(num => num % 2 == 0);

IEnumerable<int> trueList = groups.Where(group => group.Key).FirstOrDefault();
IEnumerable<int> falseList = groups.Where(group => !group.Key).FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:55:46.887

经过一番考虑和一些相当垃圾的想法，我得出了结论：不要试图让 LINQ 为你做这件事。

有几个简单的循环来消耗您的输入序列，将每个元素传递给第一个可以处理它的“处理程序”，并确保您的最后一个处理程序捕获所有内容，或者在最坏的情况下返回 a`List`而不是 a `IEnumerable`。

```
public static void Handle(
    IEnumerable<T> source,
    Action<T> catchAll,
    params Func<T, bool>[] handlers)
{
    foreach (T t in source)
    {
        int i = 0; bool handled = false;
        while (i < handlers.Length && !handled)
            handled = handlers[i++](t);
        if (!handled) catchAll(t);
    }
}

// e.g.
public bool handleP(int input, int p)
{
    if (input % p == 0)
    {
        Console.WriteLine("{0} is a multiple of {1}", input, p);
        return true;
    }
    return false;
}

Handle(
    source,
    i => { Console.WriteLine("{0} has no small prime factor"); },
    i => handleP(i, 2),
    i => handleP(i, 3),
    ...
    ); 
```

这具有处理输入顺序中的每个元素的优点，而不是将它们分成组并在您随后执行任何操作之前丢失排序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-12T14:08:52.243

我同意 Servy 的回答，但是在发表评论之后，我认为这种方法可能很有趣：

```
static class EnumerableExtensions
{
    public static IEnumerable<TSource> Fork<TSource>(
        this IEnumerable<TSource> source,
        Func<TSource, bool> filter,
        Action<TSource> secondary)
    {
        if (source == null) throw new ArgumentNullException("source");
        //...

        return ForkImpl(source, filter, secondary);
    }

    private static IEnumerable<TSource> ForkImpl<TSource>(
        this IEnumerable<TSource> source,
        Func<TSource, bool> filter,
        Action<TSource> secondary)
    {
        foreach(var e in source)
            if (filter(e))
                yield return e;
            else
                secondary(e);
    }
} 
```

这可以像这样使用：

```
var ints = new [] { 1,2,3,4,5,6,7,8,9 };

// one possible use of the secondary sequence: accumulation
var acc = new List<int>();

foreach (var i in ints.Fork(x => x % 2 == 0, t => acc.Add(t)))
{
    //...
}

// later on we can process the accumulated secondary sequence
process(acc); 
```

在这里，我们对二级序列进行累积（“假”值），但也可以对二级序列进行实时处理，因此只需对源进行一次枚举。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T20:02:33.207

尽可能使用 LINQ：

```
public IEnumerable<T> Filter(IEnumerable<T> source, Func<T, bool> criterium, out IEnumerable<T> remaining)
{
    IEnumerable<T> matching = source.Where(criterium);
    remaining = source.Except(matching);

    return matching;
} 
```

# file-type - 无法在我的 iOS 应用程序中使用“在 MyApp 中打开”以处理 PNG 或 JPG 邮件附件

> ID：12847299
> 
> 赞同：2
> 
> 时间：2012-10-11T19:45:05.113
> 
> 标签：file-type, ios

以下是我的应用程序的 info.plist 文件的相关内容：

```
<key>CFBundleDocumentTypes</key>
<array>
    <dict>
        <key>CFBundleTypeIconFiles</key>
        <array>
            <string>icon_72x72.png</string>
        </array>
        <key>CFBundleTypeName</key>
        <string>MyApp File</string>
        <key>CFBundleTypeRole</key>
        <string>Viewer</string>
        <key>LSHandlerRank</key>
        <string>Owner</string>
        <key>LSItemContentTypes</key>
        <array>
            <string>com.myapp.export</string>
            <string>com.myapp.backup</string>
            <string>com.adobe.pdf</string>
            <string>public.comma-separated-values-text</string>
            <string>public.jpeg</string>
            <string>public.png</string>
            <string>com.microsoft.excel.xls</string>
        </array>
    </dict>
</array> 
```

当我尝试点击并按住 Mail 中的 XLS、CSV 或 PDF 附件时，会显示“在 MyApp 中打开”选项，并且在我的应用程序委托的 openURL 方法被触发时一切正常。但是，当我在 Mail 中点击并按住 PNG 或 JPG 附件时，我没有在我的应用程序中打开的选项。

为了在我的应用程序中打开图像，我是否需要更改其他一些设置？对于为什么某些内容类型有效而有些无效，我感到非常困惑。

我已经看过很多 Apple 文档和其他 SO 问题和博客文章，但仍然无法使其正常工作，因此请不要只指出类似的未回答的 SO 问题或 Apple 文档。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T20:06:48.457

你不是一个人。在我看来，这是邮件应用程序的一个问题。照片应用程序也有同样的问题。您也不能选择使用任何 3rd 方应用在照片应用中打开照片。我不明白为什么苹果会做出这个决定。

我建议您在 bugreporter.apple.com 提交增强请求。

# android - Ashmem 保留政策

> ID：12847301
> 
> 赞同：2
> 
> 时间：2012-10-11T19:45:09.153
> 
> 标签：android, linux, android-ndk, shared-memory, ashmem

所以在 Android 上既没有 POSIX 共享内存也没有 SysV 共享内存，但是有`ashmem`. 我想用它从本地子系统的崩溃中收集一些事后信息（就像在[这里](https://stackoverflow.com/questions/11588474/quincykit-plcrashreporter-provide-description-before-the-crash)）。问题 - 当持有它们的句柄的进程死亡时，我可以让一个 ashmem 区域持续存在吗？ashmem 记录在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T21:26:21.030

看起来没有内置的方法可以使区域保持不变。所以我构建了一个进程外服务，我将一个描述符传递给一个区域，并希望该服务比主进程寿命长。众所周知，Android 上的后台服务没有终身保证。

该服务有一个静态变量类型`ParcelFileDescriptor`并支持两个绑定命令 - GET 和 SET。它们分别在响应包中返回所述描述符并从请求包中分配它，关闭当前持有的描述符（如果有）。

# windows - 批处理文件列出Windows 7中目录中的所有文件

> ID：12847302
> 
> 赞同：5
> 
> 时间：2012-10-11T19:45:08.637
> 
> 标签：windows, batch-file

我正在尝试列出目录中的所有文件，然后使用批处理文件将其写入文本文件。我认为应该是这样的

```
dir / (some flags here) >> files.txt 
```

这将包含一个列表，如

```
a.exe
b.exe
c.exe 
```

等等等等

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T19:49:33.467

您必须使用`/b`开关（仅写入文件列表，没有标题和其他信息）。

```
dir /b >> list.txt 
```

那么如果你需要在完整的命令中列出所有`.exe`文件是：`c:\windows`

```
dir c:\windows\*.exe /b >> list.txt 
```

请注意，这`>>`会将列表**附加**到文件中。不要忘记您可以使用多种搜索模式，例如：

```
dir *.jpg;*.png /b > list.txt 
```

它会将所有`.jpg`和`.png`文件（仅名称，没有路径或任何其他信息）写入文件`list.txt`（如果文件之前确实存在，则覆盖该文件）。

如果您需要排除目录，您可以依靠`/a`switch（根据属性包含/排除项目）。在您的情况下，您想排除目录，那么您必须使用`-d`：

```
dir /b /a-d >> list.txt 
```

最后不要忘记`dir`可以与`/s`switch 递归使用（列出在给定目录和所有子目录中与搜索模式匹配的文件）并使用`/o`选项排序。使用`dir /?`以获取更多详细信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T19:51:11.447

你几乎已经把它放下了。如果您只想列出该目录中的文件，那么

```
dir /A-D >> somefile.txt 
```

或者

```
dir /A-D > somefile.txt    

dir / 
```

*   `>>`追加
*   `>`创建新的或覆盖现有的

    目录 /AD /ON > somefile.txt

这将按名称排序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T19:50:31.227

干得好

```
dir C:\ /s /b >files.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-12T01:54:02.260

您还可以将树用于目录树中的递归列表文件

对于转储到文本文件，您可以使用以下命令：

> C:\tree "D:\我的目录" > "D:\dump file.txt"

# joomla - JCE 可能会剥离我的 html 代码

> ID：12847303
> 
> 赞同：1
> 
> 时间：2012-10-11T19:45:11.923
> 
> 标签：joomla

我的 JCE 和 Joomla 安装有问题。

**问题**

*   每当我在编辑器中编写 HTML 代码时，它会在我保存文章时不断剥离代码。
*   如果我将编辑器更改为默认编辑器，HTML 代码会保留吗？！

**我试过的**

*   我试图将全局设置中的文本过滤器更改为不过滤，但这并没有解决它。
*   我也尝试在 JCE 配置文件编辑器中启用 java 脚本并禁用 HTML 验证，但没有工作。

我正在使用 Joomla 2.5.7 和 JCE 2.2.8.2

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T20:20:01.087

它正在剥离什么样的 html 代码？当然不是`p`or`h`标签？你想放任何 iframe 吗？

JCE 编辑器对允许的内容有特殊设置。进入 JCE Editor Profiles -> Plug-in Parameters -> Media Support 并确保您启用了所需的设置。

所有这些，以及标准的 Joomla 过滤。

# mysql - MySql Update Join 两个表 SET CASE 无效组函数

> ID：12847304
> 
> 赞同：0
> 
> 时间：2012-10-11T19:45:16.013
> 
> 标签：mysql, join, sql-update, case

尝试通过连接两个表并使用 CASE 语句来更新表。
我得到旧的**错误代码：1111 Invalid use of group function**。关于如何解决的任何想法？

```
UPDATE table1 JOIN table2 ON (table1.ITEM = table2.ITEM)
SET table1.TURNOVERSCORE=CASE
WHEN ((COUNT(table2.ORDER_NUMBER))/12) < 1 AND table1.CAT = 'E' THEN .05
WHEN ((COUNT(table2.ORDER_NUMBER))/12) >= 1 AND ((COUNT(table2.ORDER_NUMBER))/12) < 4 AND table1.CAT = 'E' THEN .5
WHEN ((COUNT(table2.ORDER_NUMBER))/12) >= 4 AND table1.CAT = 'E' THEN 1
WHEN ((COUNT(table2.ORDER_NUMBER))/12) <= 5 AND table1.CAT != 'E' THEN .05
WHEN ((COUNT(table2.ORDER_NUMBER))/12) >= 6 AND ((COUNT(table2.ORDER_NUMBER))/12) < 11 AND table1.CAT != 'E' THEN .25
WHEN ((COUNT(table2.ORDER_NUMBER))/12) >= 11 AND ((COUNT(table2.ORDER_NUMBER))/12) < 21 AND table1.CAT != 'E' THEN .5
WHEN ((COUNT(table2.ORDER_NUMBER))/12) >= 21 AND table1.CAT != 'E' THEN 1 END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T21:18:54.260

我猜您正在创建一个交叉连接产品，我认为在进行更新时不允许这样做。

也许先尝试聚合表 2，如下所示：

```
UPDATE table1 
JOIN (SELECT count(*) as cnt, item FROM table2 GROUP BY item) t2 
ON table1.item = t2.item

SET table1.TURNOVERSCORE=CASE
WHEN t2.cnt/12 < 1 AND table1.CAT = 'E' THEN .05
WHEN t2.cnt/12 >= 1 AND t2.cnt/12 < 4 AND table1.CAT = 'E' THEN .5
WHEN (t2.cnt/12) >= 4 AND table1.CAT = 'E' THEN 1
WHEN (t2.cnt/12) <= 5 AND table1.CAT != 'E' THEN .05
WHEN (t2.cnt/12) >= 6 AND (t2.cnt/12) < 11 AND table1.CAT != 'E' THEN .25
WHEN (t2.cnt/12) >= 11 AND (t2.cnt/12) < 21 AND table1.CAT != 'E' THEN .5
WHEN (t2.cnt/12) >= 21 AND table1.CAT != 'E' THEN 1 END 
```

# php - 使用一个 mysql 表构建嵌套菜单

> ID：12847305
> 
> 赞同：-1
> 
> 时间：2012-10-11T19:45:19.820
> 
> 标签：php, mysql

可以用一个 mysql 表构建一个嵌套菜单吗？我一直在制作具有以下结构的表，但在构建查询时遇到问题

```
ID | Menu  | parent | position | active

 1   test      0         1         1

 2   test2     1         2         1 
```

……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T21:10:28.940

在存储分层数据方面，MySQL 并不是最好的数据库。它并没有真正的原生支持。因此，您可以在 php 中编写一个递归函数，根据需要将每个嵌套菜单拉出（如果只有几个，则可以，否则到数据库的持续往返确实会降低应用程序的性能），或者您可以执行以下操作：

[http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/](http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/)

# sql-server - 使用第三方驱动程序在 SQL Server 中获取/setClientInfo()

> ID：12847306
> 
> 赞同：1
> 
> 时间：2012-10-11T19:45:22.223
> 
> 标签：sql-server, jdbc

我工作的组织让我们的 Java 应用程序连接到 SQL Server 数据库，每个数据库都有自己唯一的应用程序 ID。但是，应用程序本身的个人用户（网站用户等）都将通过这个单一的应用程序 ID 访问数据库，使得审计变得困难（例如，我们无法分辨哪个 Java 应用程序用户删除了一行，只是有人使用了应用程序做到了）。

我已经查看`setClientInfo()`了`getClientInfo()`JDBC Connection 类。显然，Microsoft 当前的 JDBC 驱动程序当前不支持此功能。

这是否意味着 SQL Server 本身也不支持此功能？（我目前正在试验来自 DataDirect 的第三方驱动程序，据称它确实支持它，但我不知道信息是否真的被传播到数据库和/或被数据库记录）。
如果支持，那么`setClientInfo()`在 DBMS 中存储/记录的 ClientUser 信息（由 设置）在哪里？

我感谢任何想法或反馈。

# javascript - 命名空间回调函数

> ID：12847315
> 
> 赞同：1
> 
> 时间：2012-10-11T19:46:12.940
> 
> 标签：javascript, jquery, callback

我有以下情况

然后我有检查以下条件的功能：

```
var callback = $input.data('callback');
if(callback){
     // I want to do something like this:
     window[callback].call(this);

 } 
```

但由于命名空间，我不能这样做。这种情况的最佳做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:55:35.220

拆分`"."`，解析以 window 开头的每个段，然后调用`()`：

```
foo = {
  bar: {
    baz: function() {
      console.log("foo.bar.baz()");
    }
  }
};

"foo.bar.baz".split(".").reduce((o, n) => o[n], window)();
```

[注意：为简单起见，我使用了. 对于较旧的浏览器，有一个[polyfill](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce#Polyfill)可用。`Array.prototype.[reduce()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce)`]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T12:15:00.253

```
window.foo = {
    bar: function () {
        alert(this.val);
    },
    val: "foobar!"
}

var callback = "foo.bar";

if (callback) {
    var segments = callback.split('.'), 
        context = window;
    for (var i = 0; i < segments.length-1; i++) {
        context = context[segments[i]];
    }
    context[segments[i]]();
}​ 
```

# ruby - 获取此 URL 特定部分的 ruby 正则表达式是什么？

> ID：12847316
> 
> 赞同：1
> 
> 时间：2012-10-11T19:46:13.750
> 
> 标签：ruby, regex, string, url

我正在尝试获取一些亚马逊商品的 ASIN。我发现了一个模式：ASIN 总是在“/dp/”之后。如何从该字符串中提取 ASIN (B003CP0V6S)？我正在使用红宝石

```
url = "http://www.amazon.it/Calvin-Klein-Deluxe-K0S21120--Orologio/dp/B003CP0V6S/ref=lp_1597641031_1_8?ie=UTF8&qid=1349983393&sr=1-8" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T19:50:01.873

```
str = "http://www.amazon.it/Calvin-Klein-Deluxe-K0S21120--Orologio/dp/B003CP0V6S/ref=lp_1597641031_1_8?ie=UTF8&qid=1349983393&sr=1-8"
(match = str.match(/\/dp\/([^\/]*)/)) && match[1]
# => "B003CP0V6S" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T20:28:25.543

有些人喜欢在编写用于 URL 的 Ruby 正则表达式时使用替代语法，因为斜线字符的所有转义都会妨碍可读性。将正则表达式括在`%r{}`其中可以使正斜杠不转义。

```
 str = "http://www.amazon.it/Calvin-Klein-Deluxe-K0S21120--Orologio/dp/B003CP0V6S/ref=lp_1597641031_1_8?ie=UTF8&qid=1349983393&sr=1-8"
  (str =~ %r{/db/(.+?)/} && $1) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T21:35:47.313

```
url.split("/dp/").last.split("/", 2).first 
```

应该做。

# jquery - 使用 jQuery 读取存储在 Web 服务器上的 CSV 文件

> ID：12847317
> 
> 赞同：0
> 
> 时间：2012-10-11T19:46:20.613
> 
> 标签：jquery

我正在尝试这个

```
$(document).ready(function() {
    $("button").click(function() {
        $.get('m.csv', function(result) {
            $("div").html(result);
        });
    });
});​ 
```

单击按钮时，它会将网页上的文本替换为 csv 文件中的文本。它适用于存储在本地计算机上的文件，但是当我用`m.csv`存储在 Web 服务器上的 csv 文件（例如[http://www.abc.com/a.csv](http://www.abc.com/a.csv)）替换它时，它不起作用。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:47:41.847

您的问题是您正在尝试读取从另一个域发出的文档，该操作现在已被[Same origin policy](http://en.wikipedia.org/wiki/Same_origin_policy)阻止。[除非服务器通过添加CORS headers](https://developer.mozilla.org/en-US/docs/HTTP_access_control)明确允许，否则这将无法工作。

如果您不能要求服务器的所有者设置您需要的标头，您唯一的解决方案是让这些文件显示为您的服务器提供的文件，

*   通过下载它们
*   或通过在您的服务器上使用代理。

# ios - （iOS，Xcode）有没有办法覆盖“点击状态栏向上滚动”行为？

> ID：12847320
> 
> 赞同：1
> 
> 时间：2012-10-11T19:46:26.530
> 
> 标签：ios, xcode, uiscrollview, uitextview

iOS 中的标准手势之一是，通过点击状态栏（屏幕顶部的状态栏，显示您的信号级别、电池强度等），将自动滚动任何内容（例如，在表格视图、滚动视图中）等）到顶部。

我正在编写一个与聊天服务器交互的应用程序。当收到新的聊天消息时，它们会被添加到 UITextView 的底部。用户当然可以回滚查看以前的聊天记录。

是否可以覆盖“点击状态栏”快捷方式，而不是滚动到顶部，而是可以调用我自己的方法之一？（我的视图控制器中有一个方法可以自动将聊天窗口滚动到底部）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:14:30.737

这就是我想出的。关键是覆盖`scrollViewShouldScrollToTop:`方法。并返回 NO 以防止默认行为。
要注意的一件事是，`scrollViewShouldScrollToTop:`如果滚动视图的内容已经在滚动视图的顶部，则不会调用它。请参阅下面代码中的技巧。

```
@interface ViewController ()
<UIScrollViewDelegate>
@property (weak, nonatomic) IBOutlet UIScrollView *scrollView;

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.scrollView.contentSize = CGSizeMake(self.view.bounds.size.width,
                                             self.view.bounds.size.height * 2);

    // if the scrollView contentOffset is at the top
    // (0, 0) it won't call scrollViewShouldScrollToTop
    self.scrollView.contentOffset = CGPointMake(0, 1);
}

- (BOOL)scrollViewShouldScrollToTop:(UIScrollView *)scrollView
{
    // call your custom method and return YES
    [self scrollToBottom:scrollView];
    return NO;
}

- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    // be sure that when you are at the top
    // the contentOffset.y = 1
    if (scrollView.contentOffset.y == 0)
    {
        scrollView.contentOffset = CGPointMake(0, 1);
    }
}

- (void)scrollToBottom:(UIScrollView *)scrollView
{
    // do whatever you want in your custom method.
    // here it scrolls to the bottom
    CGRect visibleRect = CGRectMake(0, scrollView.contentSize.height - 5, 1, 1);
    [scrollView scrollRectToVisible:visibleRect animated:YES];
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:51:48.590

Try this:

```
- (void)myMethod {

    [myScrollableObject setScrollsToTop:NO];
} 
```

Any object inheriting UIScrollView should have this property.

[Reference](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/occ/instp/UIScrollView/scrollsToTop)

# javascript - 这可能吗 - 加载页面后更改显示在 div 中的文本值？

> ID：12847323
> 
> 赞同：2
> 
> 时间：2012-10-11T19:46:33.300
> 
> 标签：javascript, jquery

这可能是一个奇怪的想法，希望它是可能的。我有一个脚本可以动态加载具有不同文本值的 div（这是一个给定的变量，这里不能更改任何内容）。页面加载后是否可以更改这些值？这是我的想法：

1.  页面已加载
2.  脚本加载带有文本的 div（例如，一个短语是“欢迎来到这里”
3.  新脚本更改了一些显示的值（例如，前一个变为“你好吗？欢迎！”

有任何想法吗？

编辑

以下是代码示例：

```
<div id="one" class="one">First text
<div class="two">Second text
<label class="three">Third text</label>
<option value="1">ValueOne</option>
<a>Link text</a>
</div>
</div> 
```

如您所见，涉及到不同类型的选择器，而有些短语没有任何选择器（这只是代码的一部分）。页面加载完成后，应该如下所示：

```
<div id="one" class="one">FirstTextChanged
<div class="two">SecondTextChanged
<label class="three">ThirdTextChanged</label>
<option value="1">ValueOneChanged</option>
<a>LinkTextChanged</a>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T19:51:18.497

[http://jsfiddle.net/UPhUb/1/](http://jsfiddle.net/UPhUb/1/)

waits 5 seconds after page loads, then changes the text. Simple.

```
changeText = function(text, newText){
    var currentText = $('#welcome').html();  

    $('#welcome').html(currentText.replace(text,newText));
};

window.setTimeout(function(){changeText('Welcome.', 'How are you?')}, 5000); 
```

Updated per your comment: now when you call `changeText` you pass two arguments, the text you want swapped out and the new text you want in. Without seeing your code, this is as close as I think I can get.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:49:24.767

是的：

在 JavaScript 中

```
 document.getElementById('div1').innerHTML = "New html"; 
```

在 jQuery 中

```
$("#div1").html("New html"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:49:47.823

使用 jQuery 非常容易。这是一个例子：http: [//jsfiddle.net/gromer/r5uaV/1/](http://jsfiddle.net/gromer/r5uaV/1/)

现在，如果您想做某件特定的事情，请发布一些 HTML 以及您想做的事情，我们可以提供更多帮助。我刚刚发布了一个如何使用 jQuery 完成的一般示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T20:09:10.553

[http://jsfiddle.net/r5uaV/12/](http://jsfiddle.net/r5uaV/12/)如果我没记错，这就是你正在尝试的吗？

# datetime - Grails比较一个日期时间来获得小时的差异

> ID：12847326
> 
> 赞同：0
> 
> 时间：2012-10-11T19:46:45.377
> 
> 标签：datetime, grails, jodatime, date-comparison

我在下面有以下代码，我正在尝试***使用 Joda 比较两个日期***，所以我可以得到***hours 的差异***。这适用于**同一天**的两个日期（*参见下面的测试 1*）。但是，如果我比较两个**不在**同一天的日期，它只会给出错误的结果（*见下面的测试 2*）

```
DateTime end = new DateTime(event.endTime)
DateTime start = new DateTime(event.startTime)

Period p = new Period(start, end);

long hours = p.getHours();
long minutes = p.getMinutes();

System.out.println("Task title :"+ event.getTitle()+ " ...The differnce in hours is : "+hours+"  The differnce in minutes is : "+minutes) 
```

两次测试的打印结果。

第*一个是***同一天**的任务，相差3小时。

第二*个是在***第二天**结束的任务 ......它并没有像之前的任务测试那样正确地给出差异

```
This is the END TIME :2012-10-12 14:15:00.0... This is the START TIME :2012-10-12 10:30:00.0
Task title :Test 1 ...The differnce in hours is : 3  The differnce in minutes is : 45

This is the END TIME :2012-10-12 22:00:00.0... This is the START TIME :2012-10-11 22:00:00.0
Task title :Test 999 ...The differnce in hours is : 0  The differnce in minutes is : 0 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:08:47.107

以前从未使用过 Jodatime，也没有测试过，但我确实发现了一些东西：

首先，Jodatime Period 有一个 toStandardHours() 方法，这可能是您想要的，而不是 .getHours()。而 .getHours() 为您的第二次测试返回 0，因为 .getDays() 将返回 1，而 .toStandardHours() 应返回 24。 [http://joda-time.sourceforge.net/apidocs/org/joda/time/Period .html](http://joda-time.sourceforge.net/apidocs/org/joda/time/Period.html)

此外，您可以使用 Hours 函数“hoursBetween”：

```
 static Hours   hoursBetween(ReadableInstant start, ReadableInstant end) 
```

检查 API：http: [//joda-time.sourceforge.net/apidocs/org/joda/time/Hours.html](http://joda-time.sourceforge.net/apidocs/org/joda/time/Hours.html)

# bash - bash ascii 到十六进制

> ID：12847328
> 
> 赞同：29
> 
> 时间：2012-10-11T19:46:49.167
> 
> 标签：bash, hex, ascii

想知道是否有人可以帮助我将 bash 中的 ascii 转换为十六进制。示例代码：

```
#!/bin/bash 
STR = "hello"
#Convert to hex
HEXVAL = $STR #(in hex here?) 
```

我希望 hexval 具有值：68656C6C6F（十六进制的你好）

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-11T19:50:41.460

```
$ str="hello"
$ hex=$(xxd -pu <<< "$str")
$ echo "$hex"
6C6C6568A6F 
```

Or:

```
$ hex=$(hexdump -e '"%X"' <<< "$str")
$ echo "$hex"
6C6C6568A6F 
```

Careful with the `'"%X"'`; it has both single quotes and double quotes.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-11T19:56:44.610

你有几个选择

```
$ printf hello | xxd
0000000: 6865 6c6c 6f                             hello 
```

另请参阅： [bash 中的 Ascii/Hex 转换](https://stackoverflow.com/questions/5724761/ascii-hex-convert-in-bash)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-19T10:32:47.303

这是一个班轮（有点复杂但工作正常）：

```
#!/bin/bash

echo '0x'"`echo $1 | hexdump -vC |  awk 'BEGIN {IFS="\t"} {$1=""; print }' | awk '{sub(/\|.*/,"")}1'  | tr -d '\n' | tr -d ' '`" | rev | cut -c 3- | rev 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-18T03:15:17.400

```
xxd -p -u <<< "$STR" | sed 's/\(..\)/0x&, /g; s/, $//;' 
```

> 0x68、0x65、0x6C、0x6C、0x6F、0x0A

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-08T12:21:13.220

纯 BASH 将字符串转换为可打印的十六进制序列并返回

```
str2hex_echo() {
    # USAGE: hex_repr=$(str2hex_echo "ABC")
    #        returns "0x410x420x43"
    local str=${1:-""}
    local fmt="0x%x"
    local chr
    local -i i
    for i in `seq 0 $((${#str}-1))`; do
        chr=${str:i:1}
        printf  "${fmt}" "'${chr}"
    done
}

hex2str_echo() {
    # USAGE: ASCII_repr=$(hex2str_echo "0x410x420x43")
    #        returns "ABC"
    echo -en "'${1:-""//0x/\\x}'"
} 
```

**解释**

ASCII->hex：从字符高效转换为其底层 ASCII 码的秘诀`printf`在于，使用非字符串格式说明符，将前导字符作为单引号或双引号作为生成底层 ASCII 码的顺序下一个符号。此行为记录在[GNU BASH 参考中，但也与 Greg（也称为](https://www.gnu.org/software/bash/manual/bashref.html#index-printf)[GreyCat](http://mywiki.wooledge.org/GreyCat)的）wiki 页面[BashFAQ/071](http://mywiki.wooledge.org/BashFAQ/071)中的许多其他精彩实用程序一起详细公开，专门用于 char-ASCII 转换。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-21T05:26:42.943

仅十六进制线输出。经过测试，两个系统都经过验证。

Linux：

```
$ echo 'hello' | hexdump -ve '/1 "%02x"'
68656c6c6f0a 
```

苹果电脑：

```
$ echo 'hello' | xxd -p -c 256
68656c6c6f0a 
```

# opencv - 使用 Eclipse IDE 为 Windows7 上的 C/C++ 开发人员配置 OpenCV

> ID：12847332
> 
> 赞同：1
> 
> 时间：2012-10-11T19:47:08.137
> 
> 标签：opencv, windows-7, eclipse-cdt

我正在使用 Eclipse IDE for C/C++ Developers (Juno) 并打开 cv. 我试图通过互联网关注文档。他们中的大多数都在linux机器周围。我的操作系统是 Windows7。请指导我配置open cv。

问候， 普里扬克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:06:49.920

基本上，您必须：

1.  安装日食
2.  为eclipse安装cdt插件
3.  安装 mingw
4.  构建和安装opencv
5.  设置项目

谷歌搜索词组明显：**eclipse windows opencv**

# javascript - 在 JavaScript 正则表达式中包含阿拉伯字符？

> ID：12847333
> 
> 赞同：20
> 
> 时间：2012-10-11T19:47:25.373
> 
> 标签：javascript, regex, arabic

所以我在我的脚本上使用 jquery 验证只允许某些字符。我已经请求允许脚本也使用阿拉伯字符。我该怎么做？

这是我当前的代码：

```
 $.validator.addMethod(
    "legalname",
    function(value, element) {
        return this.optional(element) || /^[a-zA-Z0-9()._\-\s]+$/.test(value);
    },
    "Illegal character. Only points, spaces, underscores or dashes are allowed."
); 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-11T19:59:29.710

通过[这个站点](http://kourge.net/projects/regexp-unicode-block)，您可以轻松地为多种语言创建 unicode 正则表达式：

阿拉伯：

```
[\u0600-\u06FF] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-11T19:56:05.627

尝试这个：

```
function HasArabicCharacters(text)
{
    var arregex = /[\u0600-\u06FF]/;
    alert(arregex.test(text));
} 
```

有关更多信息，请查看此处[阿拉伯语 Unicode 块](http://en.wikipedia.org/wiki/Arabic_Unicode_block)

# tsql - 如何在 TSQL 中生成随机格式化字符串

> ID：12847336
> 
> 赞同：3
> 
> 时间：2012-10-11T19:47:42.973
> 
> 标签：tsql, random, common-table-expression

根据[Martin Smith](https://stackoverflow.com/users/73226/martin-smith)[在此处](https://stackoverflow.com/a/4558578/604648)的回答，我一直在尝试使用一种非常相似的技术来创建 10000 个以两个字符（AZ）开头的随机字符串，然后是两个数字（0-9），然后是两个字符（AZ）。任何人都知道如何使用相同的技术来做到这一点，或者不可能，在此先感谢保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:20:42.053

```
select CHAR(RAND()*24+65) + CHAR(RAND()*24+65) + 
right('0'+CAST(CAST(RAND()*100 as int) as varchar(2)),2) + 
CHAR(RAND()*24+65) + CHAR(RAND()*24+65) 
```

You may want to put a seed value in the RAND functions depending on your needs.

I guess to truly get 10000 of these...

```
select top 10000 CHAR(RAND()*24+65) + CHAR(RAND()*24+65) + 
right('0'+CAST(CAST(RAND()*100 as int) as varchar(2)),2) + 
CHAR(RAND()*24+65) + CHAR(RAND()*24+65) 
from sys.all_objects a cross join sys.all_objects b 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:45:08.097

[对原文](https://stackoverflow.com/a/4558578/604648)稍作修改：

```
DECLARE @Numbers  TABLE
(
n INT PRIMARY KEY
);

WITH E00(N) AS (SELECT 1 UNION ALL SELECT 1),   --2
        E02(N) AS (SELECT 1 FROM E00 a, E00 b), --4
        E04(N) AS (SELECT 1 FROM E02 a, E02 b), --16
        E08(N) AS (SELECT 1 FROM E04 a, E04 b), --256
        E16(N) AS (SELECT 1 FROM E08 a, E08 b)  --65,536
INSERT INTO @Numbers
SELECT TOP 1000 ROW_NUMBER() OVER (ORDER BY (SELECT 0))
FROM E16

/* 
 1\.  Build a table variable of numbers
 2\.  For each row in the table (up to row 1000)
 3\.  Get the top 2 numbers from the table variable
 4\.  For each number, get the absolute value of the checksum of a GUID
 5\.  This value will always be a positive integer
 6\.  Get the remainder of that integer when divided by 26
 7\.  This will always be a number between 0 and 25
 8\.  If the absolute value number is divisible by 2, add 65 to the number (uppercase)
 9\.  Otherwise, add 97 to the number (lowercase)
 10\. Use that number as an ASCII value and get the character representation
 11\. Use FOR XML PATH to convert the two characters in the subquery to a string
 12\. Repeat the same logic for 2 numbers (use %9 to get two numbers between 0 and 9) 
 13\. Repeat the same logic from previous steps to get two more alphabetic characters
*/

SELECT CAST((SELECT TOP 2 CHAR(CASE
                                  WHEN Abs(Checksum(Newid()))%2 = 0 THEN 65
                                  ELSE 97
                                END + Abs(Checksum(Newid()))%26)
             FROM   @Numbers n1
             WHERE  n1.n >= -n2.n 
             FOR XML PATH('')) AS CHAR(2)) + 
       CAST((SELECT TOP 2 Abs(Checksum(Newid()))%9
             FROM   @Numbers n1
             WHERE  n1.n >= -n2.n 
             FOR XML PATH('')) AS CHAR(2)) +             
       CAST((SELECT TOP 2 CHAR(CASE
                                  WHEN Abs(Checksum(Newid()))%2 = 0 THEN 65
                                  ELSE 97
                                END + Abs(Checksum(Newid()))%26)
             FROM   @Numbers n1
             WHERE  n1.n >= -n2.n /*So it gets re-evaluated for each row!*/
             FOR XML PATH('')) AS CHAR(2))
FROM   @Numbers n2 
```

# java - 杰克逊反序列化间歇性具有数组的 JSON

> ID：12847339
> 
> 赞同：1
> 
> 时间：2012-10-11T19:47:52.363
> 
> 标签：java, json, jackson

我正在从 Web 服务中检索 JSON。有时 JSON 中的属性会作为对象返回，有时它是对象的数组。如何编写要反序列化的 Java 类，以便使用 Jackson's 正确反序列化此属性`ObjectMapper`？我可以使用 ObjectMapper 来帮助解决这个问题吗？

**带有对象的 JSON**：

```
"results": {
  "account": {
     "expiration": "2012-11-16"
  }
} 
```

**带有集合的 JSON**

```
"results": {
  "account": [{
    "expiration": "2012-11-16"
  }]
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T23:19:47.437

您需要将属性标记为 Java 数组或`Collection`，并启用功能 ACCEPT_SINGLE_VALUE_AS_ARRAY：

```
ObjectMapper mapper = new ObjectMapper();
mapper.enable(DeserializationFeature. ACCEPT_SINGLE_VALUE_AS_ARRAY);
ResultOb ob = mapper.readValue(jsonInput, ResultOb.class); 
```

如果遇到单个 JSON 对象，则将其视为单元素 JSON 数组。

# sql - 通过 shellscript 将 CSV 导入 SQLite，主键问题和重复数据

> ID：12847340
> 
> 赞同：2
> 
> 时间：2012-10-11T19:47:55.403
> 
> 标签：sql, sqlite, shell, csv

我有两个像这样的简单 CSV 文件，它们都非常简单且格式相同：

```
NAME,NUMBER
abcd,1
qwerty,2
oiujkl,5 
```

csv1 和 csv2 中的许多名称是相同的，但也有仅存在于 csv1 或仅存在于 csv2 中的名称。csv1 和 csv2 中的数字，例如 1,2,3,4,5,6... 存在于两个文件中，但每个文件中只有一次。

我想将这两个文件以“name,number-from-csv1,number-from-csv2”的格式导入到一个 SQLite db。这听起来很简单，但我无法让它工作。最后我想得到这样一张桌子：

```
NAME,NUMBER-FROM-CSV1,NUMBER-FROM-CSV2
abcd,1,1
qwerty,2,5
oiujkl,5,10
lkjsie,,99
wero,234, 
```

我缺少 SQL 逻辑 :( 我创建了 SQLite 表，如下所示：

```
CREATE TABLE IF NOT EXISTS testdb (name TEXT PRIMARY KEY, number-from-csv1 INTEGER UNIQUE, number-from-csv2 INTEGER UNIQUE) 
```

我的 shell 脚本如下所示：

```
while IFS=',' read -r name number-from-csv1; do
    echo "INSERT INTO testdb (name, number-from-csv1) VALUES('$name', '$number-from-csv1');" 
done < file1.csv 
```

我这样称呼这个脚本：“./import.sh | sqlite3 asinfo.sqlite”。这适用于导入一个文件。如果我只是将“1”更改为“2”来导入 file2，它只会导入 file1 中未列出的名称。然后我尝试运行这个 SQL 查询：

```
UPDATE testdb SET number-from-csv2='$number-from-csv2' WHERE name='$name'; 
```

但这不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:58:29.510

考虑将每种文件类型上传到自己的表中。然后使用连接或视图来生成您想要的表。

将数据从 csv1 上传到名为 t1 的表中。t1 具有名称和值列。将 csv2 上传到 t2。t2 具有列名称和值。

现在做类似的事情

```
select t1.name, t1.value v1, t2.value v2
  from t1
  join t2 on t1.name = t2.name
 order by name; 
```

您可以从此查询创建视图。

# c++ - 在 C++ 中，为什么编译大量小文件比编译大文件需要更长的时间？

> ID：12847341
> 
> 赞同：7
> 
> 时间：2012-10-11T19:47:56.873
> 
> 标签：c++, gcc

我最近将我的 c++ 项目中的一些非常大的文件拆分为许多较小的文件（基本上每个类一个文件）。这使编译时间增加了一倍多，并将生成的可执行文件从 1.6mb 扩大到 2.4mb。为什么这会产生如此巨大的差异？

这是必须在大量文件中包含一些标题而不是仅仅几个的直接结果吗？

**编译器选项：**

g++ -Wall -Wextra -g -ggdb -std=c++0x

我指的可执行文件大小是在运行 strip -s 可执行文件之后。

**尺寸：**

使用调试符号之前：16MB

使用调试符号后：26MB

没有调试符号之前：1.5MB

没有调试符号后：2.4MB

**附加问题：**

我已经通过将头文件放在 pch.hpp 中，然后在我的 g++ 标志中使用 -include pch.hpp 选项来使用预编译头文件。这是使用 gcc 执行此操作的最佳方法吗？它似乎对编译时间的影响非常小。目前唯一没有被预编译的头文件是项目的一部分，并且随着项目的大量开发而可能发生变化。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-11T19:50:37.177

There are several reasons why this could happen, here's a braindump:

*   slower disk access (probably not the cause for such a big increase)
*   multiple translation units including the same headers means those headers are pasted in every one of them. The headers are also pre-processed every time. (**most likely cause**)
*   static variables or functions defined in headers are duplicated in each translation unit
*   symbols for templates are generated for each translation unit that specialize them

Here's some things that can help you out - keep multiple files but reduce compilation time:

*   precompiled headers
*   **bulk builds** - exclude `cpp` files from the build but include them in a different implementation file that is compiled.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:50:31.740

This typically because you are compiling lots of system headers during every compilation unit. There is also a minor overhead associated with linking all the object files together.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:34:35.730

使用构建系统（例如 CMake 或 GNU Make）来执行增量构建，而不是在进行更改时重新编译整个 shebang。

由于类的私有成员， [Pimpl](http://www.gotw.ca/gotw/024.htm)习惯用法可以帮助减少需要包含在头文件中的“辅助”头文件的数量。我不认为这个习惯用法会减少完全重建的时间，但是当您更改类的私有成员时，它应该有助于减少增量构建的时间。

我喜欢将 Pimpl 用于作为库或包的可见接口一部分的类。对于“内部”类或充当值类型的类，我不会为 Pimpl 烦恼。

# ruby - Rails 3控制台引发错误

> ID：12847347
> 
> 赞同：0
> 
> 时间：2012-10-11T19:48:17.090
> 
> 标签：ruby, ruby-on-rails-3, console

我正在将 Rails 2.3.8 应用程序升级到 Rails 3.0.17 并在 mac osx Lion 环境中使用 RVM (Ruby 1.9.3)。（已经在使用捆绑器）。

我的应用程序运行正常，但是 rails 控制台给了我错误：（在任何数据库调用中）

```
User.first
NoMethodError: You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.[]
    from /Users/franklin/rails_apps/myapp/app/models/user.rb:84:in `<class:User>'
    from /Users/franklin/rails_apps/myapp/app/models/user.rb:1:in `<top (required)>'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:458:in `load'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:458:in `block in load_file'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:597:in `new_constants_in'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:457:in `load_file'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:344:in `require_or_load'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:491:in `load_missing_constant'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:183:in `block in const_missing'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:181:in `each'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:181:in `const_missing'
    from (irb):7
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.17/lib/rails/commands/console.rb:44:in `start'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.17/lib/rails/commands/console.rb:8:in `start'
    from /Users/franklin/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.17/lib/rails/commands.rb:23:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T22:10:41.370

在用户模型上更正回形针配置后，一切正常。感谢您的建议。

# eclipse - 为什么我最近导入的 maven 项目的默认导出选项是 .ear

> ID：12847348
> 
> 赞同：0
> 
> 时间：2012-10-11T19:48:17.027
> 
> 标签：eclipse, ear

所以我这里有一个空的 Eclipse，对吧？空了！

![在此处输入图像描述](../Images/a080971c47424b243d9413aebdc49353.png)

现在我已经导入了我的 Maven 项目。它的 POM 说它应该被打包为 .jar

![在此处输入图像描述](../Images/7795abc9d246a2756f66ebf4b7180f8d.png)

然而，默认的导出操作是 .ear，亲爱的朋友们！

![在此处输入图像描述](../Images/204a579041a5c821d230811bf149fc42.png)

怎么了？

我提前谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:58:39.710

这可能与直觉相反，但您应该使用 Run As... / Maven 包（或安装）菜单。

# ruby-on-rails - Rails：“状态”未正确插入参数？

> ID：12847349
> 
> 赞同：0
> 
> 时间：2012-10-11T19:48:18.793
> 
> 标签：ruby-on-rails

嗨，我目前收到表单提交错误。我的应用程序基本上是一个包含用户、相册、图片（用于图片上传）的应用程序。但是，当我尝试创建新专辑时，它给了我错误：

ActiveRecord::RecordNotFound in AlbumsController#show

找不到 id=123 的专辑 [WHERE "album_users"."user_id" = 29 AND (status = 'accepted')]

问题是每个相册可以有多个所有者，因此在创建相册的表单中有一个复选框部分，您可以在其中突出显示您的朋友姓名并“邀请他们”成为所有者。这就是为什么我的创建函数看起来有点奇怪的原因。这里的问题是让 :status => 'accepted' 正常插入。请帮忙！

专辑控制器

```
def create
  @user = User.find(params[:user_id])
  @album = @user.albums.build(params[:album], :status => 'accepted')
  @friends = @user.friends.find(params[:album][:user_ids])
  for friend in @friends
    params[:album1] = {:user_id => friend.id, :album_id => @album.id, :status => 'pending'}
    AlbumUser.create(params[:album1])
  end
      #the next line is where the error occurs. why???
  if @user.save
    redirect_to user_album_path(@user, @album), notice: 'Album was successfully created.'
  else
    render action: "new"
  end
end

def show
  @user = User.find(params[:user_id])
  @album = @user.albums.find(params[:id]) #error occurs on this line
end 
```

用户模型：

```
class User < ActiveRecord::Base

has_secure_password
attr_accessible :email, :name, :password, :password_confirmation, :profilepic
validates_presence_of :password, :on => :create

validates_format_of :name, :with => /[A-Za-z]+/, :on => :create
validates_format_of :email, :with => /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/i, :on => :create
validates_length_of :password, :minimum => 5, :on => :create
# validates :album, :uniqueness => true

has_many :album_users
has_many :albums, :through => :album_users, :conditions => "status = 'accepted'"
has_many :pending_albums, :through => :album_users, :source => :album, :conditions => "status = 'pending'"
accepts_nested_attributes_for :albums

has_many :friendships, :dependent => :destroy
has_many :friends, :through => :friendships, :conditions => "status = 'accepted'"
has_many :requested_friends, :through => :friendships, :source => :friend, :conditions => "status = 'requested'", :order => :created_at
has_many :pending_friends, :through => :friendships, :source => :friend, :conditions => "status = 'pending'", :order => :created_at

has_attached_file :profilepic

before_save { |user| user.email = email.downcase }

def name_with_initial
  "#{name}"
end

private

  def create_remember_token
    self.remember_token = SecureRandom.urlsafe_base64
  end 
```

结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:19:13.677

该行：

```
@album = @user.albums.build(params[:album], :status => 'accepted') 
```

没有任何意义。只会`params[:album]`被尊重。使用 Hash#merge 组合`:status`和`params[:album]`（不修改最后一个）：

```
@album = @user.albums.build(params[:album].merge(:status => 'accepted')) 
```

**谨防！**

您已在`albums`关联中指定了条件：

```
has_many :albums, :through => :album_users, :conditions => "status = 'accepted'" 
```

但制作相关专辑时不会考虑（如`@user.album.build`）。您必须**像哈希一样**指定它：

```
has_many :albums, :through => :album_users, :conditions => {status: 'accepted'} 
```

受到尊重。`:status`这样，您将不需要传递`build`呼叫。的值`:status`将自动设置为`'accepted'`。

# vb.net - 无法让 OpenPrinter 工作

> ID：12847352
> 
> 赞同：0
> 
> 时间：2012-10-11T19:48:36.583
> 
> 标签：vb.net

我正在使用我从网上下载的这段代码。

我正在尝试将 txt 文件发送到 Intermec PM4i 标签打印机，该打印机获取 RAW 数据并打印出标签。我已经加载了驱动程序并在机器上设置了打印机。我可以进入打印机和传真选择打印机并进入属性并将文件发送到打印机，它将打印出标签。所以我知道它有效。但是当我运行这段代码时，它会从一个对话框开始，要求输入 txt 文件。选择文件后，将打开另一个对话框，您可以在其中选择打印机。所有这些似乎都正常工作。但是当代码进入 SendBytesToPrinter() 函数并到达 OpenPrinter(szPrinterName.Normalize(), hPrinter, IntPtr.Zero) 时，szPrinterName.Normalize() 具有正确的打印机名称。hPrinter 和 IntPtr.Zero 的值都为零。从这一行开始，它直接转到 If bSuccess = False Then dwError = Marshal。GetLastWin32Error() End If And Marshal.GetLastWin32Error() 的值为 87。就是这样，没有打印任何内容。请让我知道发生了什么事？谢谢

```
Imports System
Imports System.Collections.Generic
Imports System.ComponentModel
Imports System.Data
Imports System.Drawing
Imports System.Linq
Imports System.Text
Imports System.Windows.Forms
Imports System.Drawing.Printing
Imports System.Runtime.InteropServices
Imports System.IO

Public Class Form1

    ' Structure and API declarions:
    <StructLayout(LayoutKind.Sequential, CharSet:=CharSet.Ansi)> _
    Public Class DOCINFOA
        <MarshalAs(UnmanagedType.LPStr)> _
        Public pDocName As String
        <MarshalAs(UnmanagedType.LPStr)> _
        Public pOutputFile As String
        <MarshalAs(UnmanagedType.LPStr)> _
        Public pDataType As String
    End Class
    <DllImport("winspool.Drv", EntryPoint:="OpenPrinterA", SetLastError:=True, CharSet:=CharSet.Ansi, ExactSpelling:=True, CallingConvention:=CallingConvention.StdCall)> _
    Public Shared Function OpenPrinter(<MarshalAs(UnmanagedType.LPStr)> ByVal szPrinter As String, ByVal hPrinter As IntPtr, ByVal pd As IntPtr) As Boolean
    End Function

    <DllImport("winspool.Drv", EntryPoint:="ClosePrinter", SetLastError:=True, ExactSpelling:=True, CallingConvention:=CallingConvention.StdCall)> _
    Public Shared Function ClosePrinter(ByVal hPrinter As IntPtr) As Boolean
    End Function

    <DllImport("winspool.Drv", EntryPoint:="StartDocPrinterA", SetLastError:=True, CharSet:=CharSet.Ansi, ExactSpelling:=True, CallingConvention:=CallingConvention.StdCall)> _
    Public Shared Function StartDocPrinter(ByVal hPrinter As IntPtr, ByVal level As Int32, <[In](), MarshalAs(UnmanagedType.LPStruct)> ByVal di As DOCINFOA) As Boolean
    End Function

    <DllImport("winspool.Drv", EntryPoint:="EndDocPrinter", SetLastError:=True, ExactSpelling:=True, CallingConvention:=CallingConvention.StdCall)> _
    Public Shared Function EndDocPrinter(ByVal hPrinter As IntPtr) As Boolean
    End Function

    <DllImport("winspool.Drv", EntryPoint:="StartPagePrinter", SetLastError:=True, ExactSpelling:=True, CallingConvention:=CallingConvention.StdCall)> _
    Public Shared Function StartPagePrinter(ByVal hPrinter As IntPtr) As Boolean
    End Function

    <DllImport("winspool.Drv", EntryPoint:="EndPagePrinter", SetLastError:=True, ExactSpelling:=True, CallingConvention:=CallingConvention.StdCall)> _
    Public Shared Function EndPagePrinter(ByVal hPrinter As IntPtr) As Boolean
    End Function

    <DllImport("winspool.Drv", EntryPoint:="WritePrinter", SetLastError:=True, ExactSpelling:=True, CallingConvention:=CallingConvention.StdCall)> _
    Public Shared Function WritePrinter(ByVal hPrinter As IntPtr, ByVal pBytes As IntPtr, ByVal dwCount As Int32, ByVal dwWritten As Int32) As Boolean
    End Function

    ' SendBytesToPrinter()
    ' When the function is given a printer name and an unmanaged array
    ' of bytes, the function sends those bytes to the print queue.
    ' Returns true on success, false on failure.
    Public Shared Function SendBytesToPrinter(ByVal szPrinterName As String, ByVal pBytes As IntPtr, ByVal dwCount As Int32) As Boolean
        Dim dwError As Int32 = 0, dwWritten As Int32 = 0
        Dim hPrinter As New IntPtr(0)
        Dim di As New DOCINFOA()
        Dim bSuccess As Boolean = False
        ' Assume failure unless you specifically succeed.
        di.pDocName = "My C#.NET RAW Document"
        di.pDataType = "RAW"

        Try
            ' Open the printer.
            If OpenPrinter(szPrinterName.Normalize(), hPrinter, IntPtr.Zero) Then
                ' Start a document.
                If StartDocPrinter(hPrinter, 1, di) Then
                    ' Start a page.
                    If StartPagePrinter(hPrinter) Then
                        ' Write your bytes.
                        bSuccess = WritePrinter(hPrinter, pBytes, dwCount, dwWritten)
                        EndPagePrinter(hPrinter)
                    End If
                    EndDocPrinter(hPrinter)
                End If
                ClosePrinter(hPrinter)
            End If
        Catch ex As Exception
            MsgBox("error")
        End Try

        ' If you did not succeed, GetLastError may give more information
        ' about why not.
        If bSuccess = False Then
            dwError = Marshal.GetLastWin32Error()
        End If
        Return bSuccess
    End Function

    Public Shared Function SendFileToPrinter(ByVal szPrinterName As String, ByVal szFileName As String) As Boolean
        ' Open the file.
        Dim fs As New FileStream(szFileName, FileMode.Open)
        ' Create a BinaryReader on the file.
        Dim br As New BinaryReader(fs)
        ' Dim an array of bytes big enough to hold the file's contents.
        Dim bytes As [Byte]() = New [Byte](fs.Length - 1) {}
        Dim bSuccess As Boolean = False
        ' Your unmanaged pointer.
        Dim pUnmanagedBytes As New IntPtr(0)
        Dim nLength As Integer

        nLength = Convert.ToInt32(fs.Length)
        ' Read the contents of the file into the array.
        bytes = br.ReadBytes(nLength)
        ' Allocate some unmanaged memory for those bytes.
        pUnmanagedBytes = Marshal.AllocCoTaskMem(nLength)
        ' Copy the managed byte array into the unmanaged array.
        Marshal.Copy(bytes, 0, pUnmanagedBytes, nLength)
        ' Send the unmanaged bytes to the printer.
        bSuccess = SendBytesToPrinter(szPrinterName, pUnmanagedBytes, nLength)
        ' Free the unmanaged memory that you allocated earlier.
        Marshal.FreeCoTaskMem(pUnmanagedBytes)
        Return bSuccess
    End Function

    Public Shared Function SendStringToPrinter(ByVal szPrinterName As String, ByVal szString As String) As Boolean
        Dim pBytes As IntPtr
        Dim dwCount As Int32
        ' How many characters are in the string?
        dwCount = szString.Length
        ' Assume that the printer is expecting ANSI text, and then convert
        ' the string to ANSI text.
        pBytes = Marshal.StringToCoTaskMemAnsi(szString)
        ' Send the converted ANSI string to the printer.
        SendBytesToPrinter(szPrinterName, pBytes, dwCount)
        Marshal.FreeCoTaskMem(pBytes)
        Return True
    End Function

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        If True Then
            ' Allow the user to select a file.
            Dim ofd As New OpenFileDialog()
            If DialogResult.OK = ofd.ShowDialog(Me) Then
                ' Allow the user to select a printer.
                Dim pd As New PrintDialog()
                pd.PrinterSettings = New PrinterSettings()
                If DialogResult.OK = pd.ShowDialog(Me) Then
                    ' Print the file to the printer.

                    SendFileToPrinter(pd.PrinterSettings.PrinterName, ofd.FileName)
                End If
            End If
        End If

    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:17:55.747

我有一些 OpenPrinter 的 C# 代码，应该很容易翻译。

```
[DllImport("winspool.drv", EntryPoint = "OpenPrinter", SetLastError = true)]
internal static extern bool OpenPrinter(string pPrinterName, ref IntPtr phPrinter, PRINTER_DEFAULTS pDefault);

[DllImport("winspool.drv", EntryPoint = "ClosePrinter", SetLastError = true)]
internal static extern int ClosePrinter(IntPtr hPrinter);

[StructLayout(LayoutKind.Sequential)]
public class PRINTER_DEFAULTS
{
    public string pDatatype;
    public IntPtr pDevMode;
    public int DesiredAccess;
}

public struct OpenPrinterAccessCodes
{
    public const int DELETE = 0x10000; // DELETE - Allowed to delete printers
    public const int READ_CONTROL = 0x20000; // READ_CONTROL - Allowed to read printer information
    public const int WRITE_DAC = 0x40000; // WRITE_DAC - Allowed to write device access control info
    public const int WRITE_OWNER = 0x80000; // WRITE_OWNER - Allowed to change the object owner
    public const int SERVER_ACCESS_ADMINISTER = 0x1;
    public const int SERVER_ACCESS_ENUMERATE = 0x2;
    public const int PRINTER_ACCESS_ADMINISTER = 0x4;
    public const int PRINTER_ACCESS_USE = 0x8;
    public const int STANDARD_RIGHTS_REQUIRED = 0xF0000;
    public const int PRINTER_ALL_ACCESS = (STANDARD_RIGHTS_REQUIRED | PRINTER_ACCESS_ADMINISTER | PRINTER_ACCESS_USE);
    public const int SERVER_ALL_ACCESS = (STANDARD_RIGHTS_REQUIRED | SERVER_ACCESS_ADMINISTER | SERVER_ACCESS_ENUMERATE);

    public const int MAX_PORTNAME_LEN = 64;
    public const int MAX_NETWORKNAME_LEN = 49;
    public const int MAX_SNMP_COMMUNITY_STR_LEN = 33;
    public const int MAX_QUEUENAME_LEN = 33;
    public const int MAX_IPADDR_STR_LEN = 16;

    public const int ERROR_INSUFFICIENT_BUFFER = 122;
    public const int ERROR_INVALID_FLAGS = 1004;
}
    public IntPtr OpenPrinterHandle(string printerName)
    {
        var def = new PRINTER_DEFAULTS { pDatatype = null, pDevMode = IntPtr.Zero, DesiredAccess = OpenPrinterAccessCodes.PRINTER_ALL_ACCESS };
        var hPrinter = IntPtr.Zero;
        if (!OpenPrinter(printerName, ref hPrinter, def))
        {
            var lastWin32Error = new Win32Exception(Marshal.GetLastWin32Error());
            Logger.Log("Failed open Printer: " + lastWin32Error.Message);
            throw lastWin32Error;
        }
        return hPrinter;
    }

    public void ClosePrinterHandle(IntPtr hPrinter)
    {
        ClosePrinter(hPrinter);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-20T18:09:04.167

[Win32 错误代码](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681382%28v=vs.85%29.aspx)87 (0x57) 是 ERROR_INVALID_PARAMETER，“参数不正确。” 换句话说，您调用 OpenPrinter 的参数之一是错误的。

[OpenPrinter 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162751%28v=vs.85%29.aspx)的 Win32 API 参考告诉我们是哪一个：

> *pDefault* [in] 指向 PRINTER_DEFAULTS 结构的指针。该值可以为 NULL。

您在调用中已将此设置为`InPtr.Zero`，但[.NET Framework 参考](http://msdn.microsoft.com/en-us/library/system.intptr.zero.aspx)声明 InPtr.Zero “表示已初始化为零的指针或句柄”，并继续特别警告它*不*等同于`Nothing`.

因此，对 OpenPrinter 的正确调用是：

`OpenPrinter(szPrinterName.Normalize(), hPrinter, Nothing)`

# visual-studio-2010 - 这个 Visual Studio 插件/选项是什么？

> ID：12847355
> 
> 赞同：0
> 
> 时间：2012-10-11T19:48:46.650
> 
> 标签：visual-studio-2010

我一直在观看一些关于 C# 的视频，并且讲师有某种类型的插件或选项集，可以让他做一些非常巧妙的事情。

这是正在发生的事情的屏幕截图。 ![在此处输入图像描述](../Images/e1dcdc327353c2bc8169d6a9ea081753.png)

基本上，它就像更高级的自动完成或智能感知。此外，我看到它的另一个功能是，如果他点击圆圈中的图标，他只需点击一下就可以将课程更改为公开。

我知道我对此听起来很陌生，因为我是（VS 菜鸟）。如果有人知道这是什么神奇的巫术，我很想知道。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:50:29.180

这是DevExpress[的](http://devexpress.com)[code rush](http://devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/)和/或[refactor pro](http://devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/refactor_pro.xml)。

这个领域的另一个大玩家是JetBrains 的[Resharper](http://www.jetbrains.com/resharper/)。

两者都是 Visual Studio 的商业插件，尽管许多重构和代码生成助手都内置在 Visual Studio 中（如屏幕截图中的“实现抽象类”）。

# facebook-graph-api - 为什么 Graph Api Explorer 比具有相同范围访问令牌的应用程序对用户信息的访问更多？

> ID：12847363
> 
> 赞同：4
> 
> 时间：2012-10-11T19:49:05.507
> 
> 标签：facebook-graph-api, facebook-javascript-sdk

我正在尝试获取一些公共信息，例如家乡和当前位置。为此，我只需要一个有效的访问令牌，无论其范围如何。

当我在没有访问令牌的情况下在 Graph Api Explorer 上查询我不是朋友的用户时，我看不到此信息。但是当我获得访问令牌时，我得到的信息恰到好处。

现在，我用我的应用程序尝试了同样的事情，但尽管改变了访问令牌的范围，但还是没有运气。

有没有办法通过我的应用程序中的图形 API（我正在使用 Javascript SDK）访问这种公共信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:55:29.117

这是关于您的问题的 facebook 文档

> 这样的 Graph API 允许您轻松访问有关对象的所有公共信息。例如， [https](https://graph.facebook.com/btaylor) ://graph.facebook.com/btaylor (Bret Taylor) 返回所有关于 Bret 的公开信息。例如，用户的名字、姓氏和个人资料图片是公开的。
> 
> 要获取有关用户的其他信息，您必须首先获得他们的许可。概括地说，您需要获取 Facebook 用户的访问令牌。

要从用户那里获取私人信息，您必须获得他们的许可，这将为您提供该用户的访问令牌。

** 编辑 - 为了解释我的回答，您的应用访问令牌不会使您可以访问有关用户的私人信息。只有他们拥有的公共信息才会公开。这适用于其他用户和应用程序。只有他们想让外界看到的，外界才能看到。

# android - ListView 在长按时不再动画？

> ID：12847366
> 
> 赞同：0
> 
> 时间：2012-10-11T19:49:24.440
> 
> 标签：android, listview, animation

[之前有人问过这个问题，](https://stackoverflow.com/questions/1840721/listview-long-click-animation)但没有一个对我有用的答案（显然是另一个给出了对接受/唯一答案的评论）。

我有一个`ListView`并且我已经为列表中的每个项目实现了长按复制。我正在用我自己的适配器填写列表，它设置了`OnLongClickListener`并且它运行良好，除了当我触摸并按住一个项目时，它根本不会突出显示并且不会褪色。我没有设置任何事件，也没有设置我从适配器返回的`ListView`其他事件。`View`

我已经阅读了一些修复，例如不使用`wrap_content`、将 clickable 设置为 false 或将其完全从 XML 中删除。没有任何影响。我注意到，如果我删除了我的 Long Click Listener，它会为点击设置动画，但不会为褪色的长点击设置动画。

我可以做些什么来保留我的 ListView 项目上的长点击褪色动画？

仅供参考：该应用程序针对 Gingerbread (2.3.3)

编辑：

我正在写一个简单的哈希计算器。它有一项活动如下：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
    <EditText
        android:id="@+id/Input"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:ems="10"
        android:inputType="text">
        <requestFocus/>
    </EditText>
    <Button
        android:id="@+id/Hash"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_below="@id/Input"
        android:onClick="StartHashes"
        android:text="@string/HashButtonText"/>
    <ListView
        android:id="@+id/HashList"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_below="@id/Hash">
    </ListView>
</RelativeLayout> 
```

我的 onCreate 方法中的相关代码：

```
 Adapter = new HashEntryAdapter(this, Entries);// Entries is Vector<HashEntry>
    ListView list = (ListView)findViewById(R.id.HashList);
    list.setAdapter(Adapter); 
```

`HashEntry`只是一个包含 2 个字符串的类：散列的名称和散列的结果输出，分别称为`Name`和`Value`。`HashEntryAdapter`如下：

```
public class HashEntryAdapter extends ArrayAdapter<HashEntry> {

    private Context context;

    public HashEntryAdapter(Context context, List<HashEntry> objects) {
        super(context, R.layout.hashitem, objects);
        this.context = context;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        //data from your adapter
        HashEntry entry = getItem(position);
        //we want to reuse already constructed row views...
        if(convertView == null) {
            convertView = LayoutInflater.from(context).inflate(R.layout.hashitem, null);
            convertView.setOnLongClickListener(new OnLongClickListener() {
                @Override
                public boolean onLongClick(View v) {
                    HashEntry entry = (HashEntry)v.getTag();
                    ClipboardManager clipboard = (ClipboardManager)v.getContext().getSystemService(Context.CLIPBOARD_SERVICE);
                    clipboard.setText(entry.Value);
                    Toast.makeText(context, entry.Name + " copied to clipboard", Toast.LENGTH_SHORT).show();
                    return true;
                }
            });
        }
        convertView.setTag(entry);

        TextView Name = (TextView)convertView.findViewById(R.id.HashName);
        TextView Value = (TextView)convertView.findViewById(R.id.HashValue);

        Name.setText(entry.Name);
        Value.setText(entry.Value);

        return convertView;
    }
} 
```

最后是 hashitem.xml，一个简单的布局，将灰色的哈希名称放在黑色的哈希值上：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
    <TextView
        android:id="@+id/HashName"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:text="@string/HashNameFiller"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textColor="@color/DarkGray"/>
    <TextView
        android:id="@+id/HashValue"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/HashName"
        android:layout_centerHorizontal="true"
        android:text="@string/HashValueFiller"
        android:textAppearance="?android:attr/textAppearanceMedium"/>
</RelativeLayout> 
```

vikki 的 OnCreateContextMenu：

```
 list.setOnCreateContextMenuListener(new OnCreateContextMenuListener() {
        @Override
        public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:31:37.977

当您想删除对话线程时，您可以像在 ICS 中使用股票消息应用程序一样使用 onCreateContextMenu。如果将 ContextMenuInfo 转换为 AdapterContextMenuInfo，则可以像在 onLongClickListener 中一样获取 id 和位置

```
import android.widget.AdapterView.AdapterContextMenuInfo

...

list.setOnCreateContextMenuListener(new OnCreateContextMenuListener() {
    @Override
    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
        AdapterContextMenuInfo contextInfo = (AdapterContextMenuInfo) menuInfo;
        int position = contextInfo.position;
        long id = contextInfo.id;
        // the child view who's info we're viewing (should be equal to v)
        View view = contextInfo.targetView;
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T21:19:58.657

在listview上设置onlongclicklistener，在你声明的listview上设置它，在你的适配器之外

因此，不是适配器中的每个单元格都有一个 onlongclicklistener，而是 listview

```
listview.setOnLongClickListener(){new OnLongClickListener.... 
```

# vaadin - 如何将 javascript 注入 Vaadin 以支持插件

> ID：12847368
> 
> 赞同：1
> 
> 时间：2012-10-11T19:49:27.280
> 
> 标签：vaadin

某些 Vaadin 插件，例如 Invient Charts (https://vaadin.com/directory#addon/invient-charts)，需要包含 javascript 库才能运行。

如何在不必为 Vaadin 应用程序创建自定义 Servlet 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T23:59:42.937

没有将自定义资源添加到页头的扩展点。

无论如何，你可以添加一个内容模式为 CONTENT_RAW 的标签和任何自定义内容，如 JS / CSS。如果需要，您可以将内容添加到头部

`document.getElementsByTagName("head")[0].appendChild()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:53:47.777

使用 Scaladin 插件和 Scala 语言，这是通过应用程序的 init() 方法中的以下代码完成的：

```
override def init() {
  super.init()

  // bring in javascript needed for addons
  val jqsrc = io.Source.fromInputStream(getClass.getResourceAsStream("/js/jquery-1.4.4.min.js"))
  val hcsrc = io.Source.fromInputStream(getClass.getResourceAsStream("/js/highcharts.js"))
  val xpsrc = io.Source.fromInputStream(getClass.getResourceAsStream("/js/modules/exporting.js"))
  mainWindow.executeJavaScript((jqsrc ++ hcsrc ++ xpsrc).mkString)
  jqsrc.close(); hcsrc.close(); xpsrc.close() } 
```

请注意，作为 InputStreams 打开的 javascript 文件必须位于类路径中。要使用 SBT 执行此操作，请在 src/main 目录下创建一个资源目录，并将 /js 目录和 .js 文件放入其中。这些将在构建 war 文件时放入 WEB-INF/classes 目录中。当您从 xsbt Web 插件使用 container:start 时，它们也会出现在类路径中，因此相同的代码允许在制作 .war 文件之前进行测试。

这种方法应该能够在没有 Scala 的情况下工作（但需要更多的 Java 代码），但这有什么乐趣呢？

一种更有效的方法是将 JavaScript 代码加载到对象中保存的字符串中，以避免重复读取它：

```
object Script {
  val js = Seq("/js/jquery-1.4.4.min.js", "/js/highcharts.js", "/js/modules/exporting.js") map { f =>
    val in = io.Source.fromInputStream(getClass.getResourceAsStream(f))
    val s = in.mkString
    in.close()
    s
  }
} 
```

然后在 Vaadin 应用程序中：

```
class MyApp extends Application(title = "My App", applicationTheme = "reindeer")  {
  override def init() {
    super.init()

    // bring in javascript needed for addons
    Script.js foreach mainWindow.executeJavaScript
  }
.
.
. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T07:06:41.117

在 Vaadin 6 中，您有两种选择：

1.  您已经提到的选项：扩展 Vaadin servlet

2.  将文件包含到已编译的小部件集中：

在包含 .gwt.xml 文件和客户端目录的文件夹下创建一个名为 public 的目录。在此处将要包含的文件复制到小部件集中。这些文件很可能是 js 和 css 文件，也可能是一些图片。该目录下的所有文件都将被复制到已编译的小部件集中。

如果您希望将 js 文件包含到您的 Vaadin 应用程序中，请将以下行添加到 .gwt.xml 文件中（src 相对于公共文件夹）：

```
<script src="jquery/jquery.js" /> 
```

# java - SWT - 在我的 TableViewer 中使用 EditingSupport

> ID：12847374
> 
> 赞同：1
> 
> 时间：2012-10-11T19:49:46.700
> 
> 标签：java, swt, jface, tableviewer

在我的主要 dailog 中，我有一个 JFace TableViewer。表格的最后一列是 ComboBoxCellEditor。他们可以选择“否”、“是”、“两者”。这一切都按设计工作。

但这是我的问题。

1.  如果用户选择两者作为值。
2.  我需要运行一个从数组中获取当前行数据的方法
3.  将值从两者更改为否
4.  制作数据副本，然后将值更改为是
5.  将两者都添加回数组
6.  刷新表

表格示例

从 -

```
1002 | 001   | sss   |  part | both(user changed from default) 
```

到 -

```
1002 |  001  |  sss  |  part |  No

1002 |  001  |  sss  |  part | Yes 
```

我试图弄清楚两者都被选中后如何运行该方法来完成其余的工作。我假设它必须是某种听众。请查看我的 EditingSupport 代码并告诉我从哪里开始我的方法来完成其余的工作。

```
public class OptionEditingSupport extends EditingSupport 
{
    private ComboBoxCellEditor cellEditor;

    public OptionEditingSupport(ColumnViewer viewer) {
        super(viewer);
        cellEditor = new ComboBoxCellEditor(((TableViewer)viewer).getTable(), new String[]{"No", "Yes", "Both"}, SWT.DROP_DOWN);
        //cellEditor.setValue(0);
    }
    protected CellEditor getCellEditor(Object element) {
        return cellEditor;
    }
    protected boolean canEdit(Object element) {
        return true;
    }
    protected Object getValue(Object element) {
        return 0;
    }
    protected void setValue(Object element, Object value) 
    {
        if((element instanceof AplotDatasetData) && (value instanceof Integer)) {
            Integer choice = (Integer)value;
            //String option = (choice == 0? "Yes":"No":"Both");
            String option = ((AplotDatasetData)element).getMarkupValue();;
            if(choice == 0) {
                option = "No";
            }    
            else if(choice == 1) {
                option = "Yes";
            }    
            else {
                option = "Both";
            }    
            ((AplotDatasetData)element).setMarkupValue(option);
            getViewer().update(element, null);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T09:31:24.180

据我了解您的问题，您想复制一个对象，将其添加到您的模型中并刷新查看器。

当用户`"both"`在组合框中进行选择时，所有这些都应该发生。你已经知道，当这种情况发生时。你最终会在你的方法的`else`情况下。`setValue`然后你可以在那里做你必须做的事情：

```
protected void setValue(Object element, Object value) 
{
    if((element instanceof AplotDatasetData) && (value instanceof Integer)) {
        Integer choice = (Integer)value;

        String option = ((AplotDatasetData)element).getMarkupValue();

        if(choice == 0) {
            option = "No";
        }    
        else if(choice == 1) {
            option = "Yes";
        }    
        else {
            option = "Both";

            // create a copy of your element
            // add it to your model
            // update the viewer
        }

        getViewer().update(element, null);
    }

} 
```

# python - Hooking -> changing Data forever

> ID：12847396
> 
> 赞同：0
> 
> 时间：2012-10-11T19:50:41.960
> 
> 标签：python, c++, windows, hook

Well I'm working now on a project that took me more time than I thought. I stuck at hooking; I want to change a program ( it's a simple qvm file that is provided by a freeware game that's based on the quake 3 engine) using C++... with HOOKS!

So there's where I stuck. I don't know how to do this or if there is any way that makes it even possible (I'm using C++ and Python on Windows ). I simply don't know what to do, no idea :(.

I hope you know how to make it.

# c++ - 对 std::map 进行排序

> ID：12847398
> 
> 赞同：0
> 
> 时间：2012-10-11T19:50:45.483
> 
> 标签：c++, c++11

我有一张时间戳地图和一些数据 `map<string,double> mymap;` ，我如何按时间戳对其进行排序，以便一切都按时间顺序排列？继承人的样本数据集里面有什么，我有什么。

```
 < timestamp           ,         data>

"2011-02-04 14:14:51"             1
"2010-09-24 07:45:13"             2
"2011-10-28 11:10:32"             3
"2008-10-27 11:10:32"             4
"2008-10-27 11:10:33"             5 
```

期望的结果

```
"2008-10-27 11:10:32"             4
"2008-10-27 11:10:33"             5
"2010-09-24 07:45:13"             2
"2011-02-04 14:14:51"             1
"2011-10-28 11:10:32"             3 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T19:55:51.270

您实际上很幸运，因为您的时间戳是 YMD H:M:S (ISO 8601)，时间排序顺序将与字符串排序顺序相同。因此，因为`std::string`有一个，如果您遍历它`operator<()`，您将已经按日期顺序排列。`std::map`您所要做的就是填写地图，它会自行排序。

当然，以数字或日期对象格式存储日期确实是个好主意，`boost::posix_time::ptime`例如。这在内存和处理方面肯定会更高效，因为昂贵的字符串比较将被廉价的整数比较所取代。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T19:56:18.403

[`std::map`](http://www.cplusplus.com/reference/stl/map/)应始终排序：

> 在内部，`map`按照在构造上设置的特定严格的弱排序标准，从低到高的键值对元素进行排序。

我唯一能想到的是它没有正确比较字符串。使用整数或旨在存储日期的格式可能会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T20:18:59.187

只需按自然顺序打印出来，如下所示：

```
#include <map>
#include <iostream>

int main () {
  std::map<std::string, double> map;

  map["2011-02-04 14:14:51"] = 1;
  map["2010-09-24 07:45:13"] = 2;
  map["2011-10-28 11:10:32"] = 3;
  map["2008-10-27 11:10:32"] = 4;
  map["2008-10-27 11:10:33"] = 5;

  std::map<std::string, double>::iterator it(map.begin()), end(map.end());
  while(it != end) {
    std::cout << '"' << it->first << '"' << "     " << it->second << "\n";
    ++it;
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T19:56:03.097

您可以存储日期的 64 位表示形式并使用它对项目进行排序或编写一个比较器，在比较之前将字符串转换为日期

希望对你有用。

# python - 为什么 subprocess.call("""scp foo""") 坏了？

> ID：12847399
> 
> 赞同：0
> 
> 时间：2012-10-11T19:50:45.543
> 
> 标签：python, shell, subprocess, os.system

**成功：**

```
>>> scp_cmd = r"sudo scp -i /home/backup/.ssh/id_rsa /opt/backups/*conf backup@a-hostname.local:/opt/backups/"
>>> subprocess.call(scp_cmd, shell=True)
1eadmin1.conf                                                  100%   83KB  83.5KB/s   00:00
1stflr_1.conf                                                  100% 2904     2.8KB/s   00:00
>>> scp_cmd = """sudo scp -i /home/backup/.ssh/id_rsa /opt/backups/*conf backup@a-hostname.local:/opt/backups/"""
>>> os.system(scp_cmd)
1eadmin1.conf                                                  100%   83KB  87.3KB/s   00:00
1stflr_1.conf                                                  100% 2904     3.4KB/s   00:00 
```

**失败：**

```
>>> scp_cmd = r"""sudo scp -i /home/backup/.ssh/id_rsa /opt/backups/*conf backup@a-hostname.local:/opt/backups/"""
>>> subprocess.call(scp_cmd, shell=True)
/opt/backups/*conf: No such file or directory
1
>>> subprocess.call(scp_cmd.split(' '))
/opt/backups/\*conf: No such file or directory
1
>>>
>>> subprocess.call(shlex.split(scp_cmd))
/opt/backups/*conf: No such file or directory
1 
```

我很困惑为什么三引号在我使用时失败`subprocess.call()`，但在我使用时通过`os.system()`。为什么处理三引号字符串之间`subprocess.call()`和处理时有区别？`os.system()`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T19:55:09.510

我很确定您正在做其他不同的事情；三重引用在这里根本没有什么区别：

```
>>> a = r"sudo scp -i /home/backup/.ssh/id_rsa /opt/backups/*conf backup@a-hostname.local:/opt/backups/"
>>> b = r"""sudo scp -i /home/backup/.ssh/id_rsa /opt/backups/*conf backup@a-hostname.local:/opt/backups/"""
>>> a == b
True
>>> b
'sudo scp -i /home/backup/.ssh/id_rsa /opt/backups/*conf backup@a-hostname.local:/opt/backups/'
>>> a
'sudo scp -i /home/backup/.ssh/id_rsa /opt/backups/*conf backup@a-hostname.local:/opt/backups/' 
```

使用三引号只是指定 python 字符串文字的*一种方法。*不保留您如何指定该文字（带或不带`r`原始前缀，带单引号或三引号，使用单引号`'`或双引号）。`"`

当您包含换行符时，三重引号*确实会有所不同：*

```
>>> foo = '''
... '''
>>> foo
'\n' 
```

但是您的示例根本不包含任何换行符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:35:10.177

对 Martijn 所说的一切 +1，我想我可能知道发生了什么。这个输出：

```
>>> subprocess.call(scp_cmd.split(' '))
/opt/backups/\*conf: No such file or directory 
```

在我看来很可疑。 **为什么那里有反斜杠？**

尽我所能匹配您的命令，我得到类似 [仅抑制用户名] 的内容：

```
>>> import subprocess, shlex
>>> 
>>> subprocess.call(r"scp -i /home/user/.ssh/id_rsa /tmp/*conf user@localhost:/tmp/save", shell=True)
aconf                                    100%    4     0.0KB/s   00:00    
bconf                                    100%    9     0.0KB/s   00:00    
0
>>> subprocess.call(r"""scp -i /home/user/.ssh/id_rsa /tmp/*conf user@localhost:/tmp/save""", shell=True)
aconf                                    100%    4     0.0KB/s   00:00    
bconf                                    100%    9     0.0KB/s   00:00    
0 
```

这是有效的，因为正如解释的那样，它们是相同的字符串。但是说你不小心在里面放了一个反斜杠？你会得到

```
>>> subprocess.call(r"""scp -i /home/user/.ssh/id_rsa /tmp/\*conf user@localhost:/tmp/save""", shell=True)
/tmp/*conf: No such file or directory
1
>>> subprocess.call(r"""scp -i /home/user/.ssh/id_rsa /tmp/\*conf user@localhost:/tmp/save""".split(" "))
/tmp/\*conf: No such file or directory
1
>>> subprocess.call(shlex.split(r"""scp -i /home/user/.ssh/id_rsa /tmp/\*conf user@localhost:/tmp/save"""))
/tmp/*conf: No such file or directory
1 
```

与您的输出完全匹配 - 输出中没有反斜杠 for `shell=True`or `shlex.split()`，但有 for `.split(" ")`. 为了比较，如果没有反斜杠，您应该得到错误消息

```
>>> subprocess.call(r"""scp -i /home/user/.ssh/id_rsa /tmp/*conf user@localhost:/tmp/save""".split(" "))
/tmp/*conf: No such file or directory
1 
```

因此，在我看来，`scp_cmd`您发布的内容很可能不是您的输出实际对应的内容，并且您的真实内容很可能带有反斜杠。

# arrays - How to use `getBounds' with STArray?

> ID：12847400
> 
> 赞同：4
> 
> 时间：2012-10-11T19:50:50.150
> 
> 标签：arrays, haskell, random, shuffle

I'm trying to write a Fisher-Yates shuffle algorithm using STArray. Unlike all the other examples I've found on the net, I am trying to avoid using native lists. I just want to shuffle an array, in-place.

This is what I have:

```
randShuffleST arr gen = runST $ do
    _ <- getBounds arr
    return (arr, gen) 
```

`arr` is the STArray and `gen` will be a generator state of type (RandomGen g).

I was hoping I could rely on the `(MArray (STArray s) e (ST s))` [instance declaration](http://hackage.haskell.org/packages/archive/array/0.4.0.1/doc/html/Data-Array-MArray.html) defined in MArray for being able to use MArray's `getBounds` but GHCi cannot infer the type of `randShuffleST`. It fails with:

```
Could not deduce (MArray a e (ST s))
  arising from a use of `getBounds'
from the context (Ix i)
  bound by the inferred type of
           randShuffleST :: Ix i => a i e -> t -> (a i e, t)
  at CGS/Random.hs:(64,1)-(66,25)
Possible fix:
  add (MArray a e (ST s)) to the context of
    a type expected by the context: ST s (a i e, t)
    or the inferred type of
       randShuffleST :: Ix i => a i e -> t -> (a i e, t)
  or add an instance declaration for (MArray a e (ST s))
In a stmt of a 'do' block: _ <- getBounds arr
In the second argument of `($)', namely
  `do { _ <- getBounds arr;
        return (arr, gen) }'
In the expression:
  runST
  $ do { _ <- getBounds arr;
         return (arr, gen) } 
```

Interestingly, if I remove the call to `runST' like so:

```
randShuffleST arr gen = do
    _ <- getBounds arr
    return (arr, gen) 
```

it compiles fine, with the type signature

```
randShuffleST :: (Ix i, MArray a e m) => a i e -> t -> m (a i e, t) 
```

. I'm using GHC 7.4.2 on Arch Linux.

Please give explicit type signatures in your responses to help me understand your code, thank you.

EDIT: I really like Antal S-Z's answer, but I cannot select it because frankly I do not fully understand it. Maybe once I understand my own problem better I'll answer my own question in the future... thanks.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T21:13:57.597

你可能不应该`runST`在你的函数中使用。`runST`应该在一些内部使用突变但具有纯接口的计算之外使用一次。您可能希望您的 shuffle 函数就地对数组进行随机播放，具有类似的类型`STArray s i e -> ST s ()`（或者可能是更通用的类型），然后`runST`如果需要，则具有用于呈现纯接口的不同函数（该函数不过可能需要复制值）。一般来说，目标`ST`是`STRef`s 和`STArray`s 永远不能从一个`runST`调用中逃脱并在另一个调用中使用。

为您的函数推断的类型没有`runST`问题，只是更具有多态性（它适用于 IO 数组、ST 数组、STM 数组、未装箱数组等）。但是，如果您指定显式类型签名，您将更容易处理推理错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-12T01:03:02.703

发生这种情况是因为 rank-2 类型`runST`阻止您为 . 提供有意义的类型`randShuffleST`。（编写的代码存在第二个问题：可变 ST 数组不能有意义地存在于`ST`monad 之外，因此`runST`不可能从内部返回一个，并且构造一个传递给纯函数的可能性充其量是不可能的。这是“无趣的”，但最终可能会让人感到困惑；有关如何解决它，请参阅此答案的底部。）

那么，让我们看看为什么不能写下类型签名。值得一提的是，[我同意 shachaf](https://stackoverflow.com/a/12848618/237428)关于编写您正在编写的函数的最佳方法：留在内部`ST`，并且`runST`在最后只使用一次。如果您这样做，那么我在答案的底部包含了一些示例代码，显示了如何成功编写代码。但是我认为理解为什么会出现错误是很有趣的；像您遇到的错误是您不想以这种方式编写代码的一些原因！

首先，让我们先看一下产生相同错误消息的函数的简化版本：

```
bounds arr = runST (getBounds arr) 
```

现在，让我们尝试给`bounds`. 显而易见的选择是

```
bounds :: (MArray a e (ST s), Ix i) => a i e -> (i,i)
bounds arr = runST (getBounds arr) 
```

我们知道它`arr`必须是 an`MArray`并且我们不关心它有什么元素或索引类型（只要它的索引在 中`Ix`），但我们知道它必须存在于`ST`monad 中。所以这应该有效，对吧？没那么快！

```
ghci> :set -XFlexibleContexts +m
ghci> :module + Control.Monad.ST Data.Array.ST
ghci> let bounds :: (MArray a e (ST s), Ix i) => a i e -> (i,i)
ghci|     bounds arr = runST (getBounds arr)
ghci| 
<interactive>:8:25:
    Could not deduce (MArray a e (ST s1))
      arising from a use of `getBounds'
    from the context (MArray a e (ST s), Ix i)
      bound by the type signature for
                 bounds :: (MArray a e (ST s), Ix i) => a i e -> (i, i)
      at <interactive>:7:5-38
    ... 
```

等一下：？这是哪里来的？我们在任何地方都没有提到过这样的类型变量！答案是它来自的定义。一般来说，有类型（为方便起见重命名一些类型变量）；当我们在这里使用它时，我们将它限制为 type 。这里发生的是，就像一个 lambda（实际上，它*是*一个 lambda），在括号内进行本地绑定。因此，当返回 type 的东西时，我们可以与--- 统一，但我们*不能*将与统一，因为不在范围内。在 GHC 中，类型变量为`Could not deduce (MArray a e (ST *s1*))``s1``runST``bounds``runST``runST :: (forall σ. ST σ α) -> α``(forall σ. ST σ (i,i)) -> (i,i)``forall`*`σ``getBounds arr``ST s (i,i)``α``(i,i)`*`σ``s``σ``runST`是`s`and `a`， not `σ`and `α`，所以它重命名`s`为 to`s1`以消除歧义，您看到的是*这种类型的变量。***

 **所以这个错误是公平的：我们声称对于某些特定`s`的 ,`MArray a e (ST s)`成立。但`runST`需要对*每个* `s`. 但是，该错误非常不清楚，因为它引入了一个您实际上无法引用的新类型变量（因此“可能的修复”是没有意义的，尽管它无论如何都没有帮助）。

现在，显而易见的问题是，“那么我可以写一个正确的类型签名吗？” 答案是“……有点”。（但您可能不想这样做。）所需的类型如下所示：

```
ghci> :set -XConstraintKinds -XRank2Types
ghci> let bounds :: (forall s. MArray a e (ST s), Ix i) => a i e -> (i,i)
ghci|     bounds arr = runST (getBounds arr)
ghci| 
<interactive>:170:25:
    Could not deduce (MArray a e (ST s))
      arising from a use of `getBounds'
    from the context (forall s. MArray a e (ST s), Ix i)
... 
```

这个约束表示*每个 都*`MArray a e (ST s)`成立，但我们仍然会遇到类型错误。似乎[“GHC 不支持箭头左侧的多态约束”](http://hackage.haskell.org/trac/ghc/ticket/7019#comment:3) ——事实上，在谷歌搜索试图找到该信息时，我[在“主要是通常是一个函数”上找到了一篇很棒的博客文章](http://mainisusuallyafunction.blogspot.com/2010/09/higher-rank-type-constraints.html)，它遇到了与您相同的问题，解释错误，并提供以下解决方法。（他们还会收到更高级的错误消息“malformed class assertion”，这清楚地表明这样的事情是不可能的；这可能是由于不同的 GHC 版本。） *`s`*

 *当我们想要从 GHC 的内置系统中获得更多的类型类约束时，这个想法很常见，通过（ab）使用 GADT 来为这种类型类的存在提供明确的证据：

```
ghci> :set -XNoFlexibleContexts -XNoConstraintKinds
ghci> -- We still need -XRank2Types, though
ghci> :set -XGADTs
ghci> data MArrayE a e m where
ghci|   MArrayE :: MArray a e m => MArrayE a e m
ghci| 
ghci> 
```

现在，只要我们有一个 type 的值`MArrayE a e m`，我们就知道这个值一定是用`MArrayE`构造函数构造的；只有当有可用的约束时才能调用此构造函数`MArray a e m`，因此模式匹配`MArrayE`将使该约束再次可用。（唯一的另一种可能性是您的该类型的值未定义，这就是为什么实际上需要模式匹配的原因。）现在，我们可以将其作为`bounds`函数的显式参数提供，因此我们将其称为`bounds MArrayE arr`：

```
ghci> :set -XScopedTypeVariables 
ghci> let bounds :: forall a e i.
ghci|               Ix i => (forall s. MArrayE a e (ST s)) -> a i e -> (i,i)
ghci|     bounds evidence arr = runST (go evidence)
ghci|       where go :: MArrayE a e (ST s) -> ST s (i,i)
ghci|             go MArrayE = getBounds arr
ghci|   
ghci> -- Hooray! 
```

请注意我们必须将主体分解为它自己的功能并在那里进行模式匹配的奇怪之处。发生的情况是，如果您在`bounds`的参数列表中进行模式匹配，则`s`from`evidence`过早地固定为特定值，因此我们需要将其推迟；并且（我认为因为使用更高级别的类型进行推断很困难）我们还需要为 提供一个显式类型`go`，这需要作用域类型变量。

最后，返回您的原始代码：

```
ghci> let randShuffleST :: forall a e i g. Ix i => (forall s. MArrayE a e (ST s))
ghci|                                           -> a i e
ghci|                                           -> g
ghci|                                           -> (a i e, g)
ghci|     randShuffleST evidence arr gen = runST $ go evidence
ghci|       where go :: MArrayE a e (ST s) -> ST s (a i e,g)
ghci|             go MArrayE = do _ <- getBounds arr
ghci|                             return (arr, gen)
ghci| 
ghci> -- Hooray again!  But... 
```

* * *

现在，正如我一开始所说，还有一个问题需要解决。在上面的代码中，永远不会有一种方法可以构造一个 type 的值`forall s. MArrayE a e (ST s)`，因为`forall s. MArray a e (ST s)`constraint 约束是不可满足的。出于同样的原因，在您的原始代码中，`randShuffleST`即使没有遇到类型错误，您也无法编写代码，因为您无法编写返回`STArray`外部`ST`.

这两个问题的原因是一样的：[an`STArray`的第一个参数是它所在的状态线程](http://hackage.haskell.org/packages/archive/array/latest/doc/html/Data-Array-ST.html#t:STArray)。的`MArray`实例`STArray`是`instance MArray (STArray s) e (ST s)`，因此您将始终拥有 form 的类型`ST s (STArray s i e)`。因为`runST :: (forall s. ST s a) -> a`，跑步会以非法的方式`runST mySTArrayAction`“泄漏”出来。`s`调查

[`runSTArray :: Ix i => (forall s. ST s (STArray s i e)) -> Array i e`](http://hackage.haskell.org/packages/archive/array/latest/doc/html/Data-Array-ST.html#v:runSTArray)

和它未装箱的朋友

[`runSTUArray :: Ix i => (forall s. ST s (STUArray s i e)) -> UArray i e`](http://hackage.haskell.org/packages/archive/array/latest/doc/html/Data-Array-ST.html#v:runSTUArray).

你也可以使用

[`unsafeFreeze :: (Ix i, MArray a e m, IArray b e) => a i e -> m (b i e)`](http://hackage.haskell.org/packages/archive/array/latest/doc/html/Data-Array-MArray.html#v:unsafeFreeze)

做同样的事情，只要你保证这是你在可变数组上调用的最后一个函数；该[`freeze`](http://hackage.haskell.org/packages/archive/array/latest/doc/html/Data-Array-MArray.html#v:freeze)函数放宽了这个限制，但必须复制数组。同样，如果您想将数组而不是列表传递给函数的纯版本，您可能还想要

[`thaw :: (Ix i, IArray a e, MArray b e m) => a i e -> m (b i e)`](http://hackage.haskell.org/packages/archive/array/latest/doc/html/Data-Array-MArray.html#v:thaw);

using[`unsafeThaw`](http://hackage.haskell.org/packages/archive/array/latest/doc/html/Data-Array-MArray.html#v:unsafeThaw)在这里可能会是灾难性的，因为您正在传递一个您无法控制的不可变数组！这一切都会给我们带来类似的东西：

```
ghci> :set -XNoRank2Types -XNoGADTs
ghci> -- We still need -XScopedTypeVariables for our use of `thaw`
ghci> import Data.Array.IArray
ghci> let randShuffleST :: forall ia i e g. (Ix i, IArray ia e)
ghci|                   => ia i e
ghci|                   -> g
ghci|                   -> (Array i e, g)
ghci|     randShuffleST iarr gen = runST $ do
ghci|       marr  <- thaw iarr :: ST s (STArray s i e)
ghci|       _     <- getBounds marr
ghci|       iarr' <- unsafeFreeze marr
ghci|       return (iarr', gen)
ghci| 
ghci> randShuffleST (listArray (0,2) "abc" :: Array Int Char) "gen"
(array (0,2) [(0,'a'),(1,'b'),(2,'c')],"gen") 
```

这需要*O* ( *n* ) 时间来复制输入的不可变数组，但是通过优化 - 需要*O* (1) 时间来冻结输出的可变数组，因为`STArray`和`Array`在引擎盖下是相同的。

特别是将此应用于您的问题，我们有以下内容：

```
{-# LANGUAGE FlexibleContexts #-}
import System.Random
import Control.Monad
import Control.Applicative
import Control.Monad.ST
import Data.Array.ST
import Data.STRef
import Data.Array.IArray

updateSTRef :: STRef s a -> (a -> (b,a)) -> ST s b
updateSTRef r f = do
  (b,a) <- f <$> readSTRef r
  writeSTRef r a
  return b

swapArray :: (MArray a e m, Ix i) => a i e -> i -> i -> m ()
swapArray arr i j = do
  temp <- readArray arr i
  writeArray arr i =<< readArray arr j
  writeArray arr j temp

shuffle :: (MArray a e (ST s), Ix i, Random i, RandomGen g)
        => a i e -> g -> ST s g
shuffle arr gen = do
  rand           <- newSTRef gen
  bounds@(low,_) <- getBounds arr
  when (rangeSize bounds > 1) .
    forM_ (reverse . tail $ range bounds) $ \i ->
      swapArray arr i =<< updateSTRef rand (randomR (low,i))
  readSTRef rand

-- Two different pure wrappers

-- We need to specify a specific type, so that GHC knows *which* mutable array
-- to work with.  This replaces our use of ScopedTypeVariables.
thawToSTArray :: (Ix i, IArray a e) => a i e -> ST s (STArray s i e)
thawToSTArray = thaw

shufflePure :: (IArray a e, Ix i, Random i, RandomGen g)
            => a i e -> g -> (a i e, g)
shufflePure iarr g = runST $ do
  marr  <- thawToSTArray iarr
  g'    <- shuffle marr g
  iarr' <- freeze marr
  return (iarr',g')

shufflePure' :: (IArray a e, Ix i, Random i, RandomGen g)
             => a i e -> g -> (Array i e, g)
shufflePure' iarr g =
  let (g',g'') = split g
      iarr'    = runSTArray $ do
                   marr <- thaw iarr -- `runSTArray` fixes the type of `thaw`
                   void $ shuffle marr g'
                   return marr
  in (iarr',g'') 
```

同样，您可以将 freeze 替换为`Data.Array.Unsafe.unsafeFreeze`in `shufflePure`; 这可能会产生加速，因为如果它是一个`Array i e`. 该`runSTArray`函数安全地包装`unsafeFreeze`，所以这不是`shufflePure'`. （两者是等价的，以一些关于拆分 PRNG 的细节为模。）

我们在这里看到了什么？重要的是，只有可变代码会引用可变数组，并且它保持可变（*即*，返回内部的东西`ST s`）。由于`shuffle`进行了就地洗牌，因此不需要返回数组，只需返回 PRNG。为了构建一个纯接口，我们`thaw`将一个不可变数组转换为一个可变数组，就地打乱*该*`freeze`数组，然后将生成的数组重新转换为一个不可变数组。这很重要：它可以防止我们将可变数据泄漏回纯粹的世界。您不能直接可变地打乱传入的数组，因为它是不可变的；相反，您不能直接将可变混洗数组作为不可变数组返回，因为它是可变的，如果有人可以改变它怎么办？

这不会与我们在上面看到的任何错误发生冲突，因为所有这些错误都来自对`runST`. 如果我们限制我们对 的使用`runST`，只有在我们组装了一个纯结果后才运行它，所有内部状态线程都可以自动发生。由于`runST`是唯一具有 rank-2 类型的函数，因此它是唯一可以产生严重类型怪异的地方；其他一切都只需要您标准的基于类型的推理，尽管可能需要更多考虑以保持`s`状态线程参数的一致性。

你瞧：

```
*Main> let arr10 = listArray (0,9) [0..9] :: Array Int Int
*Main> elems arr10
[0,1,2,3,4,5,6,7,8,9]
*Main> elems . fst . shufflePure arr10 <$> newStdGen
[3,9,0,5,1,2,8,7,6,4]
*Main> elems . fst . shufflePure arr10 <$> newStdGen
[3,1,0,5,9,8,4,7,6,2]
*Main> elems . fst . shufflePure' arr10 <$> newStdGen
[3,9,2,6,8,4,5,0,7,1]
*Main> elems . fst . shufflePure' arr10 <$> newStdGen
[8,5,2,1,9,4,3,0,7,6] 
```

成功，终于！（真的太久了。对不起这个答案的长度。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T22:45:12.680

下面是实现就地 Fisher-Yates 的一种方法（我认为这称为 Durstenfeld 或 Knuth Shuffle）。请注意，`runST`它从未被调用，而是`runSTArray`被调用一次。

```
import Data.Array
import Data.Array.ST
import Control.Monad.ST
import Control.Monad
import System.Random

fisherYates :: (RandomGen g,Ix ix, Random ix) => g -> Array ix e -> Array ix e
fisherYates gen a' = runSTArray $ do
  a <- thaw a'
  (bot,top) <- getBounds a
  foldM (\g i -> do
    ai <- readArray a i
    let (j,g') = randomR (bot,i) g
    aj <- readArray a j
    writeArray a i aj
    writeArray a j ai
    return g') gen (range (bot,top))    
  return a 
```

请注意，尽管该算法是就地执行的，但该函数首先复制输入中给定的数组（使用函数的结果`thaw`），然后再对副本执行算法。为了避免复制数组，您至少有两个选项：

1.  Use `unsafeThaw`，它（顾名思义）是不安全的，只有在您
    确定输入数组永远不会再次使用时才能使用。由于惰性评估，这并不是一件容易的事。

2.  让我们`fisherYates`拥有类型`(RandomGen g,Ix ix, Random ix) => g -> STArray s ix e -> ST s (STArray s ix e)`并执行需要在 monad 内就地 Fisher-yates 算法的整个操作，`ST`并且只给出最终答案`runST`。***

# php - How can I set default input value to 0.00 in php?

> ID：12847402
> 
> 赞同：0
> 
> 时间：2012-10-11T19:51:05.203
> 
> 标签：php

> **Possible Duplicate:**
> [PHP: show a number to 2 decimal places](https://stackoverflow.com/questions/4483540/php-show-a-number-to-2-decimal-places)

How can I format an input number to be 0.00 if it has not any value? I tried (double) but it prints 0 only.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:52:53.283

干得好 ：）

```
echo number_format($var,2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:52:22.723

如果您希望它打印特定的编号。小数点，使用`number_format`.

```
 $float_var = number_format($var, 2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T19:56:03.343

```
$var = number_format($number, 2, '.', ''); 
```

这将强制小数点后 2 点，将小数点设置为句点。您也可以放弃最后两个，因为它默认为它；

注意：第三个值是您的小数分隔符，第四个值是千分位分隔符。

```
$var = number_format($number, 2); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T20:15:43.590

如果未设置值，也许您应该先检查它

```
if(!isset($variableName))
{
   // then set
   $variableName = "0.00"; // => string

   //or like this
   $variableName = number_format(0,2); // => this result is also string
}
echo "value: ",$variableName; 
```

结果

```
0.00 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T20:07:41.953

对于直接输出：

```
 printf('%0.2f',$var); 
```

输出到变量：

```
 $outVar = sprintf('%0.2f',$var); 
```

此语句将 $var 类型转换为浮点数并使用 2 个十进制符号打印

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-11T19:53:59.763

如果您尝试格式化值，我建议您使用 meioMask 插件。因此，您将您的字段定义为数字，并且即使您将值设置为“0”，插件也可以解决问题

# html - -moz-transition 在我的 CSS 中不起作用

> ID：12847408
> 
> 赞同：1
> 
> 时间：2012-10-11T19:51:22.700
> 
> 标签：html, css, css-transitions

> **可能重复：**
> [CSS 关键帧仅适用于 Chrome](https://stackoverflow.com/questions/12622598/css-keyframes-only-works-in-chrome)

我的网站使用 css 过渡来淡入三个图标（facebook、twitter、电子邮件）上的新图像。过渡在 Chrome 上运行良好，但在 Firefox 上不行。这是css狙击手：

```
.link-button > div{height:79px; width:79px; display:inline-block; zoom: 1; *display:inline; 
transition: 0.5s;
-moz-transition: 0.5s;
-webkit-transition: 0.5s;
-o-transition: 0.5s;}

.link-button .facebook{background:url(../img/bt_facebook.png) center center no-repeat transparent;}
.link-button .facebook:hover{background-image:url(../img/bt_facebook_over.png);}
.link-button .twitter{background:url(../img/bt_twitter.png) center center no-repeat transparent;}
.link-button .twitter:hover{background-image:url(../img/bt_twitter_over.png);}
.link-button .email{background:url(../img/bt_email.png) center center no-repeat transparent;}
.link-button .email:hover{background-image:url(../img/bt_email_over.png);} 
```

我假设我的错误直接与 -moz-transition 相关，因为 :hover 状态有效，但不是过渡。我已经从 w3 school 复制了转换代码，所以我知道这不是错误的，但是我的 Firefox 正确地触发了在互联网上找到的 css 转换，所以我知道这不是我的浏览器有问题。这一定是我忽略的一些基本问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:59:57.307

[CSS3 规范](http://www.w3.org/TR/css3-background/#the-background-image)说`background-image`不能动画。Chrome 中的`background-image`转换是非标准的。

# .net - EPPlus with MemoryStream as email attachment -- file is empty

> ID：12847412
> 
> 赞同：23
> 
> 时间：2012-10-11T19:51:45.160
> 
> 标签：.net, epplus

I'm building a console app that moves data into an excel file (using EPPlus library). I'm saving the ExcelPackage as a MemoryStream, and I want to attach it to an email. However, when I receive the email, the Excel file is empty -- 0 bytes.

Thoughts?

```
 MemoryStream outputStream = new MemoryStream();
        using (ExcelPackage package = new ExcelPackage(outputStream)) {

                // export each facility's rollup and detail to tabs in Excel (two tabs per facility)
                ExcelWorksheet facilityWorksheet = package.Workbook.Worksheets.Add(row["facility_id"].ToString());
                ExcelWorksheet facilityDetail = package.Workbook.Worksheets.Add(row["facility_id"].ToString() + "-detail");

                facilityWorksheet.Cells.LoadFromDataTable(rollupData, true);
                facilityDetail.Cells.LoadFromDataTable(rawExceptions, true);

                package.Save();
        } 
```

Here's the code for creating the email attachment:

```
Attachment attachment = new Attachment(outputStream, "ECO_exceptions.xlsx", "application/vnd.ms-excel"); 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-11T20:51:18.587

经过一番搜索，我找到了解决方案。显然，在将 MemoryStream 作为附件传递之前，我需要明确设置它的起始位置。以下代码行成功了：

```
outputStream.Position = 0; 
```

# adobe - CQ5 中的组件样式选项卡中缺少下拉菜单

> ID：12847414
> 
> 赞同：0
> 
> 时间：2012-10-11T19:51:50.897
> 
> 标签：adobe, aem

在 TextImage 组件中，样式选项卡丢失了在编辑组件时显示的 CSS 选择下拉菜单。它现在只显示一个空白区域。它应该有一个用于图像对齐的下拉菜单（左或右是您的选择）。这不再出现。

这个选项卡是 xtype *componentstyles* (String)，所以我不知道它在哪里引用下拉值的源。我的 CQ5 本地实例工作得很好。

我不能只添加一个 xtype 选择并为其提供值，因为添加到 JSP 代码中的 css 在组件的 .jsp 特定页面之外

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T00:29:22.963

看起来***componentstyles*** xtype 是由与页面关联的 CQ 设计驱动的。设计存储在 /etc/designs 下，并通过页面的页面属性对话框（cq:designPath 属性）分配

让我们看一下 Geometrixx 网站上的一个例子。如果您导航到英文主页@ **/content/geometrixx/en.html**并将TextImage 组件的实例添加到页面，您会注意到组件对话框中的样式选项卡是空的。现在导航到“发现 Geometrixx”页面@/ **geometrixx** /en/company/discover_geometrixx.html并检查 TextImage 组件的两个预先存在的实例之一。样式选项卡具有您提到的图像下拉菜单！

那么“发现页面”和“主页”页面上的实例有什么区别？答案在设计定义中。如果您打开 CRXDE Lite 并导航到内容页面模板的 Geometrixx 设计页面（“发现 Geometrixx”页面采用该模板），您将看到以下节点：

```
/etc/designs/geometrixx/jcr:content/contentpage/par/textimage
/etc/designs/geometrixx/jcr:content/contentpage/par/textimage/cq:styles
/etc/designs/geometrixx/jcr:content/contentpage/par/textimage/cq:styles/imagealign
/etc/designs/geometrixx/jcr:content/contentpage/par/textimage/cq:styles/imagealign/image_left
/etc/designs/geometrixx/jcr:content/contentpage/par/textimage/cq:styles/imagealign/image_right 
```

主页模板（“主页”页面采用）的设计缺少此定义。

如果您想继续使用开箱即用的 TextImage 组件，您似乎需要在该组件可以使用的所有段落系统和模板上设置此设计配置。因此，例如，如果您希望这些样式在 TextImage 组件被添加到 Homepage 模板的**par**段落系统时可用于该组件，您可以将类似的样式节点添加到：

```
/etc/designs/geometrixx/jcr:content/homepage/par/textimage/cq:styles 
```

或者，您可以覆盖组件和/或创建自己的组件。然后对于这个自定义组件，您可以创建自己的独立于设计的样式对话框。您可以通过检查保存的 JCR 属性并在渲染脚本中设置适当的 CSS 类名称来模拟开箱即用的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:16:11.717

问题是设计路径变量丢失了。我们不知道为什么或如何，但解决方案如下。

*   打开内容存储库

*   转到 /content/-sitefolder-/ 并展开

*   点击 jcr:content 并查看属性

*   检查属性 cq:designPath 及其值 /etc/designs/-sitefolder-; 如果不存在则添加到属性

# r - main=paste( substitute(...), substitute(...) ) in R_hist_title

> ID：12847415
> 
> 赞同：1
> 
> 时间：2012-10-11T19:51:55.553
> 
> 标签：r, title

I'm trying to assemble a title for a histogram plot in R. The title I want derives from two sources, first a vector (death.cause) specifying, er, cause-of-death, and second a field from a data.frame, into which I index using a list, deathratecols, to get at the field.

```
> death.cause 

> [[1]] [1] "Heart Attack"
> 
> [[2]] [1] "Heart Failure"
> 
> [[3]] [1] "Pneumonia"

> deathratecols

> [1] 11 17 23 
```

I want to assemble title like: Heart Attack (x-bar = 7.63763) , where x-bar is the mean of the data column. I can get the two parts to work separately as below.

```
> main=substitute(x, list(x=death.cause[[i]]) )) # gives title "Heart Attack" 

> main=substitute(bar(X)==k, list(k=mean(outcome[, deathratecols[i] ], na.rm=TRUE   ) )) # gives title x-bar=7.63763 
```

But my efforts to put the two together using paste() have failed.

? someone point out the error of my ways please

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:06:00.753

提前用`sprintf`语句格式化标题并将其传递给`main`. 简单的例子：

```
a <- "foo"
b <- "bar"
title <- sprintf("This combines %s and %s", a, b)
hist(rnorm(10), main = title) 
```

也许是这样的（但可能不起作用，因为你没有提供一个可以使用的例子）：

```
title <- sprintf("%s, (x-bar = %s)", death.cause[[i]], mean(outcome[, deathratecols[i]]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-13T07:44:49.507

您可以像下面一样组合替换（）和粘贴（）：

```
hist(outcome[, deathratecols[i]], 
     main=substitute(paste(death.cause[[i]], "(", bar(X), "=", k, ")"), list(k=mean(outcome[, deathratecols[i]], na.rm=TRUE)))) 
```

它对我有用。

# javascript - Minifier with GAE + Angular JS

> ID：12847417
> 
> 赞同：0
> 
> 时间：2012-10-11T19:52:08.043
> 
> 标签：javascript, google-app-engine, google-closure-compiler, angularjs

Can you explain, or point to good resource on how to setup a minifier (preferably google closure) to work with Google App Engine.

I use AngularJS for client side. So have bunch of JS files, and like to serve it as one, minified during production. Without manually editing index.html for which files to server, and not having trouble with GAE setup, how can I achieve this?

thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T16:18:58.667

借助 Page Speed 服务，您可以让 App Engine 为您完成优化工作，您可以从管理控制台设置页面启用该服务：

[https://developers.google.com/appengine/docs/adminconsole/performancesettings#pagespeed](https://developers.google.com/appengine/docs/adminconsole/performancesettings#pagespeed)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T22:30:04.487

[modernizr](http://modernizr.com/) has an ant build script that searches your html files for js and css, minifies and concatenates etc, etc creating a published version of your code. You will probably want to tweak it to ensure that things like jquery and angularjs get put in the right place. I hadn't used ant for awhile and it was pretty comprehensible. I imagine you could replace whatever js minifier is there with something like closure.

Just as an aside, make sure that you use $inject [dependency injection](http://docs.angularjs.org/guide/di) so the minifier doesn't mess up your angular code.

hope this helps

--dan

# events - 当用户单击该多边形的边界时，如何在谷歌地图 v3 中向已创建的多边形添加一个点

> ID：12847419
> 
> 赞同：2
> 
> 时间：2012-10-11T19:52:14.117
> 
> 标签：events, google-maps, border, polygon

在用户在我的地图上绘制多边形后，我希望他们能够在需要时向其添加点。也许有某种悬停事件来显示它们何时越过界限并可以添加一个点会很好（但这不是必需的）。我唯一能想到的就是为每条边添加单独的线。看着 api 我希望找到某种点击的边框，但没有想出任何东西。

除了我上面提到的那个之外，还有其他人遇到过这个问题并找到了一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T05:49:46.807

最简单的解决方案是使 Polygon 可编辑：

[https://developers.google.com/maps/documentation/javascript/overlays#editable](https://developers.google.com/maps/documentation/javascript/overlays#editable)

# eclipse - 有没有办法在 Eclipse 中打开文件浏览器视图？

> ID：12847421
> 
> 赞同：0
> 
> 时间：2012-10-11T19:52:29.213
> 
> 标签：eclipse, eclipse-plugin, customization, eclipse-juno

我正在使用 Eclipse 作为基本文件编辑器，没有安装 Java 工具所带来的所有堆问题。我下载了没有插件的平台版本，并为我希望开发的代码添加了一些编辑工具。

我不打算在这个 Eclipse 中创建新项目，而只是编辑单个文件。理想情况下，我可以从 Eclipse 中的文件资源管理器视图中打开这些（见图）。是否有一个我可以下载的插件允许我这样做，或者是否有一个简单的黑客来添加这个功能？

![在此处输入图像描述](../Images/024bf93843fda4ec9f92831d1f32a860.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:26:12.643

我找到了解决方案。不幸的是，它增加了近 30MB，我真的希望有一个更轻量级的解决方案（我不会选择这个作为答案，如果发布的话）。[Target Management 插件](http://www.eclipse.org/tm/)提供了一个插件（将此 url 添加到 Eclipse 的*Install New Software...*对话框： http: [//download.eclipse.org/tm/updates/3.4/](http://download.eclipse.org/tm/updates/3.4/)），允许浏览远程和本地文件系统。打开*远程系统*视图将允许您打开本地文件系统并从内部打开文件，这些文件出现在主编辑器窗口中。

# mysql - 两个日期之间的列的正确语法是什么？

> ID：12847422
> 
> 赞同：2
> 
> 时间：2012-10-11T19:52:34.763
> 
> 标签：mysql, sql

我试图在日期之间

```
SELECT y.*, x.id as customerNumber
FROM table1 y
LEFT JOIN table2 x
    ON x.id = y.id
WHERE y.date_created BETWEEN ('2011-12-06','yyyy-mm-dd') AND  y.date_created('2011-12-07','yyyy-mm-dd'); 
```

这给了我错误

> 代码：1241。操作数应包含 1 列

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:54:19.150

您`y.date_created`在 的右侧重复，并在两侧`BETWEEN`传递两个字符串值：`()`

```
 y.date_created between '2011-12-06' AND  '2011-12-07'; 
```

格式中的日期文字`YYYY-mm-dd`本身就足够了。通过传递`('2011-12-06', 'yyyy-mm-dd')`到`BETWEEN`，它在左侧看到两个操作数并出错。然后在右侧，您可以`y.date_created()`像函数一样使用语法，这也不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:55:34.047

```
WHERE y.date_created between '2011-12-06' AND '2011-12-07' 
```

就那么简单

请注意，`between '2011-12-06' AND '2011-12-07'`等于`between '2011-12-06 00:00:00' AND '2011-12-06 23:59:59'`，而不是`2011-12-07 23:59:59`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:59:28.493

在您的代码中： y.date_created between ('2011-12-06','yyyy-mm-dd') AND y.date_created('2011-12-07','yyyy-mm-dd');

我认为在两者之间您不需要再次使用和短语重复字段名称：

```
y.date_created between ('2011-12-06','yyyy-mm-dd') AND ('2011-12-07','yyyy-mm-dd'); 
```

# google-chrome - 什么网络错误可能导致状态（失败）并在 Chrome 中输入待处理？

> ID：12847427
> 
> 赞同：6
> 
> 时间：2012-10-11T19:52:54.773
> 
> 标签：google-chrome, http-headers, wireshark, varnish

我维护的网站有时会在某些资源上收到失败的 GET 请求。状态返回为 (failed)，类型为 Pending。标头仅包含请求本身，没有任何响应。

服务器正在运行 Drupal 和 Varnish。

关于导致失败的原因或从哪里开始调试的任何想法？

![Chrome 开发工具中的 GET 请求失败](../Images/06727574e9ad249e766338cbdde56f52.png)

这可能与[Chrome 在“Status = (failed)”和“Type = undefined”时遇到什么样的网络错误](https://stackoverflow.com/questions/10125784/what-kind-of-network-error-is-chrome-encountering-when-status-failed-and)有关，即使类型返回不同的消息。有人可以证实这一点吗？如果是这样，我该如何调试呢？

提前致谢

**编辑，我刚刚安装了wireshark 来尝试调试更多。**

这是失败请求的全部后续内容

![Wireshark 截图](../Images/8eaa7783188d8b7d91bfa91bdb638e97.png)

**94645、94651、94686 和 94688 的转储**

```
No.     Time        Source                Destination           Protocol Length Info
  94645 211.219995  192.168.0.101         85.134.37.196         HTTP     1192   [TCP Retransmission] GET /sites/default/files/css/css_4PXz_aZSHtm7FWHqYsMdm7sl9C4802BFn9tXlePfpJU.css HTTP/1.1 

Frame 94645: 1192 bytes on wire (9536 bits), 1192 bytes captured (9536 bits)
    Arrival Time: Nov  7, 2012 22:55:18.002267000 EET
    Epoch Time: 1352321718.002267000 seconds
    [Time delta from previous captured frame: 0.006199000 seconds]
    [Time delta from previous displayed frame: 0.815800000 seconds]
    [Time since reference or first frame: 211.219995000 seconds]
    Frame Number: 94645
    Frame Length: 1192 bytes (9536 bits)
    Capture Length: 1192 bytes (9536 bits)
    [Frame is marked: True]
    [Frame is ignored: False]
    [Protocols in frame: eth:ip:tcp:http]
    [Coloring Rule Name: Bad TCP]
    [Coloring Rule String: tcp.analysis.flags]
Ethernet II, Src: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f), Dst: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
    Destination: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
        Address: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
        .... ..0\. .... .... .... .... = LG bit: Globally unique address (factory default)
    Source: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
        Address: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
        .... ..0\. .... .... .... .... = LG bit: Globally unique address (factory default)
    Type: IP (0x0800)
Internet Protocol Version 4, Src: 192.168.0.101 (192.168.0.101), Dst: 85.134.37.196 (85.134.37.196)
    Version: 4
    Header length: 20 bytes
    Differentiated Services Field: 0x00 (DSCP 0x00: Default; ECN: 0x00: Not-ECT (Not ECN-Capable Transport))
        0000 00.. = Differentiated Services Codepoint: Default (0x00)
        .... ..00 = Explicit Congestion Notification: Not-ECT (Not ECN-Capable Transport) (0x00)
    Total Length: 1178
    Identification: 0x4e23 (20003)
    Flags: 0x02 (Don't Fragment)
        0... .... = Reserved bit: Not set
        .1.. .... = Don't fragment: Set
        ..0\. .... = More fragments: Not set
    Fragment offset: 0
    Time to live: 64
    Protocol: TCP (6)
    Header checksum: 0xabe3 [correct]
        [Good: True]
        [Bad: False]
    Source: 192.168.0.101 (192.168.0.101)
    Destination: 85.134.37.196 (85.134.37.196)
Transmission Control Protocol, Src Port: 51714 (51714), Dst Port: http (80), Seq: 1, Ack: 1, Len: 1126
    Source port: 51714 (51714)
    Destination port: http (80)
    [Stream index: 5205]
    Sequence number: 1    (relative sequence number)
    [Next sequence number: 1127    (relative sequence number)]
    Acknowledgement number: 1    (relative ack number)
    Header length: 32 bytes
    Flags: 0x018 (PSH, ACK)
        000\. .... .... = Reserved: Not set
        ...0 .... .... = Nonce: Not set
        .... 0... .... = Congestion Window Reduced (CWR): Not set
        .... .0.. .... = ECN-Echo: Not set
        .... ..0\. .... = Urgent: Not set
        .... ...1 .... = Acknowledgement: Set
        .... .... 1... = Push: Set
        .... .... .0.. = Reset: Not set
        .... .... ..0\. = Syn: Not set
        .... .... ...0 = Fin: Not set
    Window size value: 229
    [Calculated window size: 14656]
    [Window size scaling factor: 64]
    Checksum: 0xb15e [validation disabled]
        [Good Checksum: False]
        [Bad Checksum: False]
    Options: (12 bytes)
        No-Operation (NOP)
        No-Operation (NOP)
        Timestamps: TSval 30409363, TSecr 1723048723
            Kind: Timestamp (8)
            Length: 10
            Timestamp value: 30409363
            Timestamp echo reply: 1723048723
    [SEQ/ACK analysis]
        [Bytes in flight: 1126]
        [TCP Analysis Flags]
            [This frame is a (suspected) retransmission]
                [Expert Info (Note/Sequence): Retransmission (suspected)]
                    [Message: Retransmission (suspected)]
                    [Severity level: Note]
                    [Group: Sequence]
            [The RTO for this segment was: 1.480371000 seconds]
            [RTO based on delta from frame: 92823]
Hypertext Transfer Protocol
    GET /sites/default/files/css/css_4PXz_aZSHtm7FWHqYsMdm7sl9C4802BFn9tXlePfpJU.css HTTP/1.1\r\n
        [Expert Info (Chat/Sequence): GET /sites/default/files/css/css_4PXz_aZSHtm7FWHqYsMdm7sl9C4802BFn9tXlePfpJU.css HTTP/1.1\r\n]
            [Message: GET /sites/default/files/css/css_4PXz_aZSHtm7FWHqYsMdm7sl9C4802BFn9tXlePfpJU.css HTTP/1.1\r\n]
            [Severity level: Chat]
            [Group: Sequence]
        Request Method: GET
        Request URI: /sites/default/files/css/css_4PXz_aZSHtm7FWHqYsMdm7sl9C4802BFn9tXlePfpJU.css
        Request Version: HTTP/1.1
    Host: www.snellman.fi\r\n
    Connection: keep-alive\r\n
    User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4\r\n
    Accept: text/css,*/*;q=0.1\r\n
    Referer: http://www.snellman.fi/sv\r\n
    Accept-Encoding: gzip,deflate,sdch\r\n
    Accept-Language: en-US,en;q=0.8\r\n
    Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3\r\n
    [truncated] Cookie: v_tid=82524dc4552b4cd4a22d1fa4e7e78d72; Drupal.toolbar.collapsed=0; ctools-collapsible-state=views-ui-advanced-column-uusimmat_reseptit%3A1%2Cviews-ui-advanced-column-Related%3A1; Drupal.tableDrag.showWeight=0; SESS4049
    \r\n
    [Full request URI: http://www.snellman.fi/sites/default/files/css/css_4PXz_aZSHtm7FWHqYsMdm7sl9C4802BFn9tXlePfpJU.css]

---------------------------------------------------------------------------------------------------------------------------------------------------------

No.     Time        Source                Destination           Protocol Length Info
  94651 211.228592  85.134.37.196         192.168.0.101         TCP      66     [TCP Dup ACK 92860#3] http > 51714 [ACK] Seq=1 Ack=1 Win=14592 Len=0 TSval=1723049571 TSecr=1723044620

Frame 94651: 66 bytes on wire (528 bits), 66 bytes captured (528 bits)
    Arrival Time: Nov  7, 2012 22:55:18.010864000 EET
    Epoch Time: 1352321718.010864000 seconds
    [Time delta from previous captured frame: 0.001166000 seconds]
    [Time delta from previous displayed frame: 0.008597000 seconds]
    [Time since reference or first frame: 211.228592000 seconds]
    Frame Number: 94651
    Frame Length: 66 bytes (528 bits)
    Capture Length: 66 bytes (528 bits)
    [Frame is marked: True]
    [Frame is ignored: False]
    [Protocols in frame: eth:ip:tcp]
    [Coloring Rule Name: Bad TCP]
    [Coloring Rule String: tcp.analysis.flags]
Ethernet II, Src: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4), Dst: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
    Destination: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
        Address: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
        .... ..0\. .... .... .... .... = LG bit: Globally unique address (factory default)
    Source: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
        Address: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
        .... ..0\. .... .... .... .... = LG bit: Globally unique address (factory default)
    Type: IP (0x0800)
Internet Protocol Version 4, Src: 85.134.37.196 (85.134.37.196), Dst: 192.168.0.101 (192.168.0.101)
    Version: 4
    Header length: 20 bytes
    Differentiated Services Field: 0x00 (DSCP 0x00: Default; ECN: 0x00: Not-ECT (Not ECN-Capable Transport))
        0000 00.. = Differentiated Services Codepoint: Default (0x00)
        .... ..00 = Explicit Congestion Notification: Not-ECT (Not ECN-Capable Transport) (0x00)
    Total Length: 52
    Identification: 0x8b62 (35682)
    Flags: 0x02 (Don't Fragment)
        0... .... = Reserved bit: Not set
        .1.. .... = Don't fragment: Set
        ..0\. .... = More fragments: Not set
    Fragment offset: 0
    Time to live: 58
    Protocol: TCP (6)
    Header checksum: 0x790a [correct]
        [Good: True]
        [Bad: False]
    Source: 85.134.37.196 (85.134.37.196)
    Destination: 192.168.0.101 (192.168.0.101)
Transmission Control Protocol, Src Port: http (80), Dst Port: 51714 (51714), Seq: 1, Ack: 1, Len: 0
    Source port: http (80)
    Destination port: 51714 (51714)
    [Stream index: 5205]
    Sequence number: 1    (relative sequence number)
    Acknowledgement number: 1    (relative ack number)
    Header length: 32 bytes
    Flags: 0x010 (ACK)
        000\. .... .... = Reserved: Not set
        ...0 .... .... = Nonce: Not set
        .... 0... .... = Congestion Window Reduced (CWR): Not set
        .... .0.. .... = ECN-Echo: Not set
        .... ..0\. .... = Urgent: Not set
        .... ...1 .... = Acknowledgement: Set
        .... .... 0... = Push: Not set
        .... .... .0.. = Reset: Not set
        .... .... ..0\. = Syn: Not set
        .... .... ...0 = Fin: Not set
    Window size value: 114
    [Calculated window size: 14592]
    [Window size scaling factor: 128]
    Checksum: 0xd246 [validation disabled]
        [Good Checksum: False]
        [Bad Checksum: False]
    Options: (12 bytes)
        No-Operation (NOP)
        No-Operation (NOP)
        Timestamps: TSval 1723049571, TSecr 1723044620
            Kind: Timestamp (8)
            Length: 10
            Timestamp value: 1723049571
            Timestamp echo reply: 1723044620
    [SEQ/ACK analysis]
        [TCP Analysis Flags]
            [This is a TCP duplicate ack]
        [Duplicate ACK #: 3]
        [Duplicate to the ACK in frame: 92860]
            [Expert Info (Note/Sequence): Duplicate ACK (#3)]
                [Message: Duplicate ACK (#3)]
                [Severity level: Note]
                [Group: Sequence]

---------------------------------------------------------------------------------------------------------------------------------------------------------

No.     Time        Source                Destination           Protocol Length Info
  94686 211.305208  85.134.37.196         192.168.0.101         TCP      66     http > 51714 [FIN, ACK] Seq=1 Ack=1 Win=14592 Len=0 TSval=1723049647 TSecr=1723044620

Frame 94686: 66 bytes on wire (528 bits), 66 bytes captured (528 bits)
    Arrival Time: Nov  7, 2012 22:55:18.087480000 EET
    Epoch Time: 1352321718.087480000 seconds
    [Time delta from previous captured frame: 0.000026000 seconds]
    [Time delta from previous displayed frame: 0.076616000 seconds]
    [Time since reference or first frame: 211.305208000 seconds]
    Frame Number: 94686
    Frame Length: 66 bytes (528 bits)
    Capture Length: 66 bytes (528 bits)
    [Frame is marked: True]
    [Frame is ignored: False]
    [Protocols in frame: eth:ip:tcp]
    [Coloring Rule Name: HTTP]
    [Coloring Rule String: http || tcp.port == 80]
Ethernet II, Src: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4), Dst: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
    Destination: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
        Address: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
        .... ..0\. .... .... .... .... = LG bit: Globally unique address (factory default)
    Source: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
        Address: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
        .... ..0\. .... .... .... .... = LG bit: Globally unique address (factory default)
    Type: IP (0x0800)
Internet Protocol Version 4, Src: 85.134.37.196 (85.134.37.196), Dst: 192.168.0.101 (192.168.0.101)
    Version: 4
    Header length: 20 bytes
    Differentiated Services Field: 0x00 (DSCP 0x00: Default; ECN: 0x00: Not-ECT (Not ECN-Capable Transport))
        0000 00.. = Differentiated Services Codepoint: Default (0x00)
        .... ..00 = Explicit Congestion Notification: Not-ECT (Not ECN-Capable Transport) (0x00)
    Total Length: 52
    Identification: 0x8b63 (35683)
    Flags: 0x02 (Don't Fragment)
        0... .... = Reserved bit: Not set
        .1.. .... = Don't fragment: Set
        ..0\. .... = More fragments: Not set
    Fragment offset: 0
    Time to live: 58
    Protocol: TCP (6)
    Header checksum: 0x7909 [correct]
        [Good: True]
        [Bad: False]
    Source: 85.134.37.196 (85.134.37.196)
    Destination: 192.168.0.101 (192.168.0.101)
Transmission Control Protocol, Src Port: http (80), Dst Port: 51714 (51714), Seq: 1, Ack: 1, Len: 0
    Source port: http (80)
    Destination port: 51714 (51714)
    [Stream index: 5205]
    Sequence number: 1    (relative sequence number)
    Acknowledgement number: 1    (relative ack number)
    Header length: 32 bytes
    Flags: 0x011 (FIN, ACK)
        000\. .... .... = Reserved: Not set
        ...0 .... .... = Nonce: Not set
        .... 0... .... = Congestion Window Reduced (CWR): Not set
        .... .0.. .... = ECN-Echo: Not set
        .... ..0\. .... = Urgent: Not set
        .... ...1 .... = Acknowledgement: Set
        .... .... 0... = Push: Not set
        .... .... .0.. = Reset: Not set
        .... .... ..0\. = Syn: Not set
        .... .... ...1 = Fin: Set
            [Expert Info (Chat/Sequence): Connection finish (FIN)]
                [Message: Connection finish (FIN)]
                [Severity level: Chat]
                [Group: Sequence]
    Window size value: 114
    [Calculated window size: 14592]
    [Window size scaling factor: 128]
    Checksum: 0xd1f9 [validation disabled]
        [Good Checksum: False]
        [Bad Checksum: False]
    Options: (12 bytes)
        No-Operation (NOP)
        No-Operation (NOP)
        Timestamps: TSval 1723049647, TSecr 1723044620
            Kind: Timestamp (8)
            Length: 10
            Timestamp value: 1723049647
            Timestamp echo reply: 1723044620

---------------------------------------------------------------------------------------------------------------------------------------------------------

No.     Time        Source                Destination           Protocol Length Info
  94688 211.305660  192.168.0.101         85.134.37.196         TCP      66     51714 > http [FIN, ACK] Seq=1127 Ack=2 Win=14656 Len=0 TSval=30409384 TSecr=1723049647

Frame 94688: 66 bytes on wire (528 bits), 66 bytes captured (528 bits)
    Arrival Time: Nov  7, 2012 22:55:18.087932000 EET
    Epoch Time: 1352321718.087932000 seconds
    [Time delta from previous captured frame: 0.000264000 seconds]
    [Time delta from previous displayed frame: 0.000452000 seconds]
    [Time since reference or first frame: 211.305660000 seconds]
    Frame Number: 94688
    Frame Length: 66 bytes (528 bits)
    Capture Length: 66 bytes (528 bits)
    [Frame is marked: True]
    [Frame is ignored: False]
    [Protocols in frame: eth:ip:tcp]
    [Coloring Rule Name: HTTP]
    [Coloring Rule String: http || tcp.port == 80]
Ethernet II, Src: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f), Dst: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
    Destination: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
        Address: D-LinkIn_2f:a4:a4 (14:d6:4d:2f:a4:a4)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
        .... ..0\. .... .... .... .... = LG bit: Globally unique address (factory default)
    Source: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
        Address: HonHaiPr_e7:39:2f (38:59:f9:e7:39:2f)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
        .... ..0\. .... .... .... .... = LG bit: Globally unique address (factory default)
    Type: IP (0x0800)
Internet Protocol Version 4, Src: 192.168.0.101 (192.168.0.101), Dst: 85.134.37.196 (85.134.37.196)
    Version: 4
    Header length: 20 bytes
    Differentiated Services Field: 0x00 (DSCP 0x00: Default; ECN: 0x00: Not-ECT (Not ECN-Capable Transport))
        0000 00.. = Differentiated Services Codepoint: Default (0x00)
        .... ..00 = Explicit Congestion Notification: Not-ECT (Not ECN-Capable Transport) (0x00)
    Total Length: 52
    Identification: 0x4e24 (20004)
    Flags: 0x02 (Don't Fragment)
        0... .... = Reserved bit: Not set
        .1.. .... = Don't fragment: Set
        ..0\. .... = More fragments: Not set
    Fragment offset: 0
    Time to live: 64
    Protocol: TCP (6)
    Header checksum: 0xb048 [correct]
        [Good: True]
        [Bad: False]
    Source: 192.168.0.101 (192.168.0.101)
    Destination: 85.134.37.196 (85.134.37.196)
Transmission Control Protocol, Src Port: 51714 (51714), Dst Port: http (80), Seq: 1127, Ack: 2, Len: 0
    Source port: 51714 (51714)
    Destination port: http (80)
    [Stream index: 5205]
    Sequence number: 1127    (relative sequence number)
    Acknowledgement number: 2    (relative ack number)
    Header length: 32 bytes
    Flags: 0x011 (FIN, ACK)
        000\. .... .... = Reserved: Not set
        ...0 .... .... = Nonce: Not set
        .... 0... .... = Congestion Window Reduced (CWR): Not set
        .... .0.. .... = ECN-Echo: Not set
        .... ..0\. .... = Urgent: Not set
        .... ...1 .... = Acknowledgement: Set
        .... .... 0... = Push: Not set
        .... .... .0.. = Reset: Not set
        .... .... ..0\. = Syn: Not set
        .... .... ...1 = Fin: Set
            [Expert Info (Chat/Sequence): Connection finish (FIN)]
                [Message: Connection finish (FIN)]
                [Severity level: Chat]
                [Group: Sequence]
    Window size value: 229
    [Calculated window size: 14656]
    [Window size scaling factor: 64]
    Checksum: 0x3c7e [validation disabled]
        [Good Checksum: False]
        [Bad Checksum: False]
    Options: (12 bytes)
        No-Operation (NOP)
        No-Operation (NOP)
        Timestamps: TSval 30409384, TSecr 1723049647
            Kind: Timestamp (8)
            Length: 10
            Timestamp value: 30409384
            Timestamp echo reply: 1723049647
    [SEQ/ACK analysis]
        [This is an ACK to the segment in frame: 94686]
        [The RTT to ACK the segment was: 0.000452000 seconds] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-29T19:09:49.350

就我而言，Adblock 拒绝了该请求（因为这是一个 Twitter 请求，而我屏蔽了大多数 Twitter 内容）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T16:08:23.183

通过从 Varnish 3.0.2 升级到 3.0.3 解决了我的具体问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T08:34:22.723

我在 Chrome 中遇到了这个确切的问题，对我来说，是离线缓存造成了麻烦。

我有一个 asp.net html5 应用程序，专为具有离线支持的移动使用而设计。所以我有这样的清单属性：

```
<html manifest="Manifest.ashx"> 
```

而且我有一个 ashx 处理程序，它可以动态地为清单文件提供服务。为了开发，我删除了主页上的清单属性，但我有另一个很少使用的页面，它具有清单属性。项目中的最新文件（一个图像和两个 js 文件）尚未添加到清单中。当我访问另一个页面并返回主页时，清单中缺少的文件开始在日志中失败，没有友好的错误消息，只需键入：挂起和“失败”。这只是在桌面上的 Chrome 上测试，没有离线。

将文件添加到清单列表中解决了我的问题。

# jquery - 更改 img 显示 processing.gif 的 src 后，直到真正的 img 加载

> ID：12847432
> 
> 赞同：-1
> 
> 时间：2012-10-11T19:53:19.773
> 
> 标签：jquery, image

> **可能重复：**
> [如何在通过 JavaScript 加载图像时显示微调器](https://stackoverflow.com/questions/51352/how-to-show-a-spinner-while-loading-an-image-via-javascript)

我有一个 img，下一个 btn 和上一个 btn

下一个按钮将下一个图像加载为

```
crntSrc=$("img").attr('src');
nextSrc=(crntSrc+1);
$("img").attr('src',nextSrc); 
```

但我想显示 process.gif 图像，直到 nextSrc 完全加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:57:09.430

您可以尝试在 css 中将 process.gif 设置为图像的背景：

```
​img{
 background:url('process.gif') no-repeat center;   
} 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:57:32.207

你可以这样做：

```
function preload(src, cb)
{
    var img = new Image();
    img.load = cb;
    img.src = src;
}

var newImage = "/foo/foo.jpg";

// Function is called after image is loaded into memory.
preload(newImage, function(){
    $("#afterloadimg").attr("src", this.src);
}); 
```

# sql - SQL Server 的 INNER JOIN 与 IN 语句

> ID：12847433
> 
> 赞同：1
> 
> 时间：2012-10-11T19:53:25.047
> 
> 标签：sql, sql-server-2008

> **可能重复：**
> [SQL JOIN 与 IN 性能？](https://stackoverflow.com/questions/1200295/sql-join-vs-in-performance)

我们由 SQL Server 2008 提供支持。我们有一个应用程序，用户可以在其中选择要搜索的项目列表，然后他们会根据这些项目获取所有项目。我们使用的两种技术是：

```
SELECT * FROM mytable WHERE myval IN ('A', 'B', 'C') 
```

和

```
INSERT INTO tempTable (tempvalue) ('A'), ('B'), ('C')
SELECT * FROM mytable m INNER JOIN tempTable t WHERE m.myval = t.tempvalue 
```

当然，第一个选项更容易，但是一旦用户选择了超过 50 个值，性能就会很糟糕。到了我们谈论废弃IN的地步，因为性能迅速下降。

那么，为什么 IN 表现那么差呢？这是典型的还是我们的设置特定的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T21:58:58.030

这些只是总体上改进 SQL 查询的想法。

*   我个人更喜欢第一种方法，而不是将选定的字段保存到表中，这可能比第一种方法有更多的开销。

*   确保您已经为您的主表创建了相关索引。根据最常用的搜索字段创建索引是一种很好的做法，例如，如果您在员工表中搜索employee_name，则可以为该字段创建索引，这将缩短查询执行时间。您可以使用 SQL Profiler 进行尝试。

# html - 在 XSLT 之前操作 xsl 属性

> ID：12847434
> 
> 赞同：1
> 
> 时间：2012-10-11T19:53:26.113
> 
> 标签：html, xslt

给定 xsl 文件以更改颜色

```
 <xsl:if test="!colorChanges()">
    <StaticLabel style="{StaticLabel/@style}">                                                                                                      
      <Caption>
    <xsl:value-of select="$StaticLabel/Caption"/>                               
      </Caption>                                                          
      <PreviewCaption>
         <xsl:value-of select="$StaticLabel/Caption"/>
       </PreviewCaption>                                                                                                                  
     </StaticLabel>
  </xsl:if> 
```

鉴于此 xml 数据

```
 <StaticLabel style="font-family:Arial;color:#000000;font-size:9pt">
    <Caption><![CDATA[FoodType]]></Caption>
    <Name><![CDATA[French]]></Name>
 </StaticLabel>
</xsl:if> 
```

**xslt 之后的当前结果**

```
<StaticLabel style="font-family:Arial;color:#000000;font-size:9pt">                                                  
   <Caption>Food Type</Caption>                                                 
   <PreviewCaption>French</PreviewCaption>                                              
</StaticLabel> 
```

无论如何在不更新xml文件的情况下执行xslt之前*只*更改颜色同时保留其他样式属性？

**预期结果：**

```
<StaticLabel style="font-family:Arial;color:#CCCCCC;font-size:9pt">                                                  
   <Caption>Food Type</Caption>                                                 
   <PreviewCaption>French</PreviewCaption>                                              
</StaticLabel> 
```

**可能的 XSL 解决方案**

```
<xsl:if test="colorChanges()">
    <StaticLabel>       
      <xsl:attribute name="style">                                                        
        //other style attributes stay same and ONLY edit color 
    <xsl:text>color:#CCCCCC"</xsl:text>
  </xsl:attribute>                                                                                              
      <Caption>
    <xsl:value-of select="$StaticLabel/Caption"/>                               
      </Caption>                                                          
      <PreviewCaption>
         <xsl:value-of select="$StaticLabel/Caption"/>
       </PreviewCaption>                                                                                                                  
     </StaticLabel>
  </xsl:if> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:56:12.437

**一、XSLT 1.0解决方案：**

**这种*通用*转换**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pStyle" select="'font-size:12pt'"/>

 <xsl:variable name="vStyleName"
      select="concat(';',substring-before($pStyle, ':'),':')"/>

 <xsl:variable name="vCurrentStyleValue" select=
 "substring-before(substring-after(concat(';', /*/@style, ';'), $vStyleName),
                   ';')"/>

  <xsl:variable name="vCurrentStyle"
       select="concat($vStyleName,$vCurrentStyleValue)"/>
 <xsl:template match="node()|@*" name="identiy">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="/*/@style">
  <xsl:attribute name="style">
   <xsl:variable name="vprecStyles" select=
   "substring-before(concat(';',., $vCurrentStyle), $vCurrentStyle)"/>
   <xsl:value-of select="substring($vprecStyles, 2)"/>
   <xsl:if test="$vprecStyles">;</xsl:if>
   <xsl:value-of select="$pStyle"/>
   <xsl:value-of select="substring-after(concat(';',.), $vCurrentStyle)"/>
  </xsl:attribute>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<StaticLabel style="font-family:Arial;color:#000000;font-size:9pt">
   <Caption>Food Type</Caption>
   <PreviewCaption>French</PreviewCaption>
</StaticLabel> 
```

**产生想要的正确结果**：

```
<StaticLabel style="font-family:Arial;color:#CCCCCC;font-size:9pt">
   <Caption>Food Type</Caption>
   <PreviewCaption>French</PreviewCaption>
</StaticLabel> 
```

**当我们将`$pStyle`参数更改为**：

```
 <xsl:param name="pStyle" select="'font-family:Courier'"/> 
```

**然后再次产生所需的正确结果：**

```
<StaticLabel style="font-family:Courier;color:#000000;font-size:9pt">
   <Caption>Food Type</Caption>
   <PreviewCaption>French</PreviewCaption>
</StaticLabel> 
```

**如果我们将`$pStyle`参数更改为**：

```
 <xsl:param name="pStyle" select="'font-size:12pt'"/> 
```

**我们再次得到正确的结果**：

```
<StaticLabel style="font-family:Arial;color:#000000;font-size:12pt">
   <Caption>Food Type</Caption>
   <PreviewCaption>French</PreviewCaption>
</StaticLabel> 
```

**最后，如果我们将`$pStyle`参数更改为：**

```
 <xsl:param name="pStyle" select="'line-height:15pt'"/> 
```

**我们再次得到正确的、想要的结果**：

```
<StaticLabel style="font-family:Arial;color:#000000;font-size:9pt;line-height:15pt">
   <Caption>Food Type</Caption>
   <PreviewCaption>French</PreviewCaption>
</StaticLabel> 
```

**这是非常防错的——观察**：

```
<StaticLabel style="font-family:Arial;background-color:#ffffff;color:#000000;font-size:9pt">
   <Caption>Food Type</Caption>
   <PreviewCaption>French</PreviewCaption>
</StaticLabel> 
```

**我们`$pStyle`再次将参数设置为：**

```
 <xsl:param name="pStyle" select="'color:#CCCCCC'"/> 
```

**我们仍然得到正确的结果（不会被其他以“color”结尾的 CSS 属性混淆）：**

```
<StaticLabel style="font-family:Arial;background-color:#ffffff;color:#CCCCCC;font-size:9pt">
   <Caption>Food Type</Caption>
   <PreviewCaption>French</PreviewCaption>
</StaticLabel> 
```

* * *

**二、XSLT 2.0 解决方案——更简单**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pStyle" select="'color:#CCCCCC'"/>

 <xsl:variable name="vStyleName" select=
                  "substring-before($pStyle, ':')"/>

 <xsl:variable name="vcurStyles"
      select="tokenize(/*/@style, ';')"/>

 <xsl:variable name="vnewStyles" select=
  "if($vcurStyles[substring-before(.,':') eq $vStyleName])
     then ($vcurStyles[substring-before(.,':') ne $vStyleName],
           $pStyle)
     else ($vcurStyles, $pStyle)
  "/>

 <xsl:template match="node()|@*" name="identiy">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="/*/@style">
  <xsl:attribute name="style" select="string-join($vnewStyles, ';')">
  </xsl:attribute>
 </xsl:template>
</xsl:stylesheet> 
```

# spring - 将 bean 自动装配到 JSF 托管 bean 时的空指针

> ID：12847436
> 
> 赞同：4
> 
> 时间：2012-10-11T19:53:28.797
> 
> 标签：spring, jsf-2, dependency-injection, autowired, managed-bean

我已经使用 Spring Java 邮件和 Velocity 模板开发了一个电子邮件服务，如下所示。

电子邮件.java

```
@Component
public class Email {    

        private JavaMailSender mailSender;      
        private VelocityEngine velocityEngine;  

         @Autowired
        private ApplReviewService applReviewService;

       @Autowired
        private UserService userService;

        public void setUserService(UserService userService ) {
            this.userService=userService;
        }

        public UserService getuserService() {
            return userService;
        }

        @Autowired
        @Required
        public void setMailSender(JavaMailSender mailSender) {
            this.mailSender = mailSender;
        }

        public VelocityEngine getVelocityEngine() {
            return velocityEngine;
        }

        @Autowired
        @Required
        public void setVelocityEngine(VelocityEngine velocityEngine) {
            this.velocityEngine = velocityEngine;
        } 
```

// 发送电子邮件的方法。}

我的 Spring.xml

```
<context:component-scan base-package="com.test.common"/>

    <bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
           </bean>

   <bean id="velocityEngine" class="org.springframework.ui.velocity.VelocityEngineFactoryBean">
      <property name="velocityProperties">
         <value>
            resource.loader=class
            class.resource.loader.class=org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader
         </value>
      </property>
   </bean>

@ManagedBean(name="person")
@SessionScoped
Public class Person{

@Autowired
private Email email ; // getter and setter for this.

} 
```

我正在尝试将我的电子邮件类自动装配到 Jsf managedBean 中，但我得到了空指针异常。我要去哪里错了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T23:55:39.080

您不能在 JSF 托管 bean 中注入这样的 Spring bean。将其更改为

```
@ManagedBean(name="person")
@SessionScoped
Public class Person{

@ManagedProperty(value="#{email}")
private Email email ; // getter and setter for this.

} 
```

也可以看看：

*   [@Scope（“请求”）不起作用](https://stackoverflow.com/questions/12470512/scoperequest-not-working)

# google-apps-script - 拥有 ServerHandler.addCallbackElement 方法的背景是什么？

> ID：12847441
> 
> 赞同：0
> 
> 时间：2012-10-11T19:53:47.590
> 
> 标签：google-apps-script

经常 GAS 用户（[我也是](https://stackoverflow.com/questions/12722806/safe-getelementbyid-or-try-to-determine-if-id-exists-in-gui/12722984#12722984)）不使用[ServerHandler.addCallbackElement](https://developers.google.com/apps-script/class_serverhandler#addCallbackElement)方法或以不涵盖所有控件的方式使用。

有这种方法的背景是什么？为什么 GAS 开发者要引入它？将所有输入小部件值作为参数传递给所有服务器处理程序是否更简单？

[文档](https://developers.google.com/apps-script/class_serverhandler#addCallbackElement)没有提供这些问题的答案。

我看到以下原因

1.  在处理不同控件集的多个处理程序的情况下，添加小部件作为回调元素可以减少浏览器和 GAS 服务器之间的流量。这是一个问题。它节省了多少流量？我认为最多几千字节，通常是数百字节。考虑到现代互联网连接速度，甚至移动连接，是否值得。
2.  表单包含带有多个按钮的类似表格的编辑控件，并且可以轻松处理具有相同名称的行元素。这个问题很容易通过使用来避免`tags`。请参阅以下示例。如果标签用于其他目的，解析源按钮 id 并提取行号不是问题。
3.  幕后使用的技术限制。如果有这样的限制，那么它们是什么？

```
function doGet(e) {
  var app = UiApp.createApplication();
  var vPanel = app.createVerticalPanel();
  var handler = app.createServerHandler("onBtnClick");
  var lstWidgets = [];
  for (var i = 0; i < 10; i++) {
    var hPanel = app.createHorizontalPanel().setTag('id_' + i);
    var text = app.createTextBox().setName("text_" + i);
    text.setText(new Date().valueOf());
    var btn = app.createButton("click me").addClickHandler(handler);
    btn.setTag(i).setId('id_btn' + i);
    var lbl = app.createLabel().setId("lbl_" + i);
    hPanel.add(text);
    hPanel.add(btn);
    hPanel.add(lbl);
    lstWidgets.push(text);
    lstWidgets.push(btn);
    vPanel.add(hPanel);
  }
  // The addCallbackElement calls simulate situation when all widgets values are passed to a single server handler.
  for (var j = 0; j < lstWidgets.length; j++) {
    handler.addCallbackElement(lstWidgets[j]); 
  }
  app.add(vPanel);
  return app;
}

function onBtnClick(e) {
  var app = UiApp.getActiveApplication();
  var i = e.parameter[e.parameter.source + '_tag'];
  var lbl = app.getElementById("lbl_" + i);
  lbl.setText("Source ButtonID: " + e.parameter.source + ', Text: ' + e.parameter["text_" + i]);
  return app;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:51:59.057

好问题。

“它节省了多少流量？” 我想我们还不知道，但我希望随着时间的推移它会变得更有效率。[这是关于性能的另一个讨论。](http://productforums.google.com/forum/#!msg/apps-script/xxXjRKDPhl0/ZKhl_ia9Rt0J)只有来自 Google 的广泛测试和改进才能真正让我们确定最佳实践，目前我只能说 ClientHandlers 显然会尽可能地优于 ServerHandlers。

作为 JavaScript 开发人员，我认为我们主要习惯于在客户端做事，然后我们将 PHP/ASP 视为服务器端工具。到目前为止，我的理解是，我们的 GAS 代码实际上同时在客户端和服务器端运行（至少它正在调用服务器端功能），但似乎服务器端发生的事情比我们意识到的要多，而且在客户端这似乎导致了一些“编译”的代码。从我的 Java 经验中，我有点认识到这种多层部署。

由于有很多方法可以做同样的事情，谷歌可以利用我们的代码不是直接解释（由任何一方）的事实来做如果我们手工编写代码不一定有意义的事情。这就是为什么我认为它最终会比其他解决方案更有效，但可能还没有。现在，如果您担心性能，我建议您避开 GAS。也许只是为了好玩尝试在运行时查看客户端 Web 应用程序的源代码（查看源代码）。因此，为了让他们最有效地做事，我想他们会因为让我们以非常高层次的方式定义事物而受益。这使他们在解释我们的代码方面具有最大的灵活性。

为了具体解决您的第二个问题，我个人认为处理函数 onBtnClick() 在服务器端运行，而您引用的标签（以及大多数 doGet）将在客户端的浏览器引擎中。如果他们提前知道处理特定事件/请求需要多少内存，我可以看到该功能在服务器端将如何更加灵活（高效和强大）。（很明显，如果每个 getElementById() 调用都运行一个单独的请求，那就像每次单击一个指向新迷你网页的链接一样。）

所以现在的问题是为什么我的处理程序不能只使用我在处理程序函数中使用的东西自动创建参数？我们首先提出这个问题的唯一原因是因为 UiApp 中有一些东西似乎在两端都可用。UiApp 已经在 doGet 和 onClick 的范围内，但 doGet 中定义的变量不在，因此这些值需要是

*   像 ScriptProperties.setProperty() 或
*   将 UiApp 放入带有 Id 的某处或
*   使用 addCallbackElement() 显式赋予 Handler 函数

请注意您必须如何添加CallbackElement(lstWidget)，因为它不是使用 UiApp 对象中的 app.create... 构造函数创建的。我的猜测是 GAS 正在对 Google 端的 Web 服务实现符合 XML 的 SOAP 调用，我们可以通过真正研究客户端源代码来解决这个问题。重申一下，我们也可以使用 setProperty() 这并不重要，甚至可以通过 JDBC 保存它们，然后从您的处理程序函数中使用另一个连接检索它们，但不知何故，数据需要从客户端传递到服务器，反之亦然-反之亦然。

从编程的角度来看，您的客户端 doGet 函数范围内有很多可用的东西，您可能永远不想传递给服务器，或者服务器端 doClick() 范围内可能有函数与客户端上的函数同名，但它们实际上可能是对完全不同的库函数的调用，甚至可能在完全不同的硬件上（即使从开发人员的角度来看它们的工作方式相同）。

也许谷歌团队还没有真正决定 UiApp 的真正运作方式，否则他们只会强制或至少允许我们把所有东西放在那里。当我们根据它的名称调用 UiApp.getActiveApplication() 时，另一个观察结果看起来不像是构造函数，而是从 UiApp 对象返回私有实例的方法。（对象是一个先前已实例化并假定在某处初始化的类。）我可能没有 100% 回答您的问题，但我确实尝试过，社区的任何进一步见解显然将不胜感激。

现在我可能跑题了，但我也想象实际产品会继续改变，因为他们会做更多的事情来提高长期性能，如果我们仍然觉得我们正在作为开发人员编写客户端代码，那么对谷歌来说是成功的。现在，如果我说错了，请纠正我，我最近才开始使用这些工具，并计划随着我了解的更多细节来跟进这个问题，但到目前为止，这是我最好的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T19:38:38.443

如果您使用表单面板，所有子元素都将发送到您的 dopost 函数。以按钮为源。你的 UIapp 将被清理。

如果您不希望使用回调来指定将发送的元素和兄弟姐妹。

这就是 UIapp 的设计方式。

# c++ - C++ 默认函数参数

> ID：12847456
> 
> 赞同：6
> 
> 时间：2012-10-11T19:55:09.723
> 
> 标签：c++

我想实现这一点：

```
- second parameter by default set to first argument 
```

就像是：

```
int foo (int a, int b = a); 
```

但是怎么做呢？

非常感谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-11T19:56:34.020

这是禁止的：

### 8.3.6 默认参数 [dcl.fct.default]

> 9) 每次调用函数时都会评估默认参数。未指定函数参数的评估顺序。 **因此，函数的参数不应在默认参数表达式中使用，即使它们没有被评估。**在默认参数表达式之前声明的函数的参数在范围内，可以隐藏命名空间和类成员名称。[ 例子：
> 
> `int a;`
> 
> **`int f(int a , int b = a); / / error: parameter a`**
> 
> `/ / used as default argument`
> 
> `typedef int I;`
> 
> `int g( float I , int b = I (2)); / / error: parameter I found`
> 
> `int h(int a , int b = sizeof (a )); / / error, parameter a used`
> 
> `/ / in default argument`
> 
> —结束示例]

**另一种方法**是重载：

```
int foo(int a, int b);

int foo(int a)
{
   return foo(a,a);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T20:39:06.273

不允许这样做的原因已经得到解决，但是@Vyktor 的另一个解决方案是使用`boost::optional`而不是幻数（这与创建重载相比有利有弊）：

```
int foo(int a, boost::optional<int> b = boost::none)
{
    if(!b) b = a;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T20:00:41.560

[我建议按照Luchian Grigore 的建议](https://stackoverflow.com/a/12847480/1149736)对这个特定任务使用重载，但通常的做法是保留一些值来表示“这是默认值”。例如

```
int foo( int a, int b = -1)
{
    if( b == -1){
       b = a;
    }
} 
```

使用对象（不是标量值）可以很好地实现（通过创建保留的新交付类来表示默认值），但是使用 int 你必须这样做。

请注意，您必须 100% 确定`b`无法获得价值`-1`（或任何您保留的价值）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T20:53:25.120

这是一个有点有趣的答案 - 但有效：

```
#define TWO_FROM_ONE(a) (a),(a)

f(TWO_FROM_ONE(12)); 
```

一个缺点是这将调用某些函数两次（一个已知的宏缺点）：

```
f(TWO_FROM_ONE(sin(123 / PI))); 
```

# ruby-on-rails - Windows 上的 Rails 应用程序 - 无法远程访问

> ID：12847457
> 
> 赞同：0
> 
> 时间：2012-10-11T19:55:10.413
> 
> 标签：ruby-on-rails, windows, ruby-on-rails-3

我在我们的网络（Windows）中的一台机器上部署了一个 Rails 应用程序。它在端口 80 上运行：

rails server -p 80 -e 生产

如果我调用 localhost，应用程序加载正常。

但是，如果我从网络上的另一台机器调用它，它不会解析：http: [//192.168.1.XXX](http://192.168.1.XXX)

有什么想法吗？

# oauth - oauth2.0 redirect_uri, oauth1.0 oauth_callback 保护

> ID：12847464
> 
> 赞同：0
> 
> 时间：2012-10-11T19:55:39.693
> 
> 标签：oauth, google-api, oauth-2.0, dropbox, dropbox-api

我正在处理 Google api(oauth2.0) 和 DropBox api (oauth1.0)，

只是想知道如何保护只能由谷歌服务器调用的redirect_uri和只能由Dropbox服务器调用的oauth_callback。

我检查他们的 ip 吗？由于 url 始终是公开的，如果没有对其进行保护，可能有人会在没有任何服务器通知的情况下找到 uri 并进行攻击。

有没有我错过的指导方针？

[编辑]我错了，redirect_uri 和 oauth_callback 实际上是由客户端调用的，而不是身份验证服务器。所以我应该检查最终用户的 ip 以确保他们是同一个请求令牌的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T04:02:16.927

我认为您不会通过检查 IP 来防止任何攻击。普通用户不会泄露他们的代币，所以你不应该得到你获得的代币的虚假秘密。如果攻击者控制了您用户的计算机并获得了令牌，他们也可以使用该计算机向您的 redirect_uri 发出请求，因此 IP 检查将通过。

另一方面，您应该确保`https`用于 OAuth 流，以便保护令牌免受网络嗅探。

# twitter-bootstrap - Rails Boostrap table-striped 无法为条纹行添加额外的背景

> ID：12847465
> 
> 赞同：0
> 
> 时间：2012-10-11T19:55:41.397
> 
> 标签：twitter-bootstrap, ruby-on-rails-3.2

我想有一个 twitter-bootstrap 已经提供的条纹表，然后另外将背景图像添加到某些行。图像将在整行中重复。问题是背景图像没有显示在条纹行中。然后我将图像添加到行的每个 td 内的 div 中。这几乎完美地工作，因为图像很小，因此您仍然可以看到条纹行中的阴影，因此仍然可以判断该行是条纹的。这种方法的问题是图像会在单元格的末尾被截断，然后在下一个单元格中重新开始，因此看起来非常不稳定。如果你好奇图像是什么，那只是我设计的一个箭头（尽管图像将来可能会改变）。因此，我试图让箭头反复穿过整行。

**有没有办法同时使用条纹表并将背景图像添加到行中？如果没有，有没有一种简单的方法来手动做条带表？**

这是我尝试并为图像工作的方法，但我不得不只使用`table`而不是使用`table-striped`，因此丢失了我的交替条纹行：

```
<table class="table">
    <% @sessions.each do |session| %>
        <% if session.status == 0 %>
           <% classname = "active"  %>
        <% else %>
           <% classname = "noactive" %>
        <% end %>

        <tr class= <%= classname %> >
            <td><%= link_to session.name, "session_path"%></td>
            <td><%= link_to session.user, edit_user_path(session.user)%></td>
            <td><%= link_to "Details", details_path, :class => "btn btn-mini" %></td>
        </tr>
    <% end %>
</table> 
```

这是尝试在 td 级别添加：

```
<table class="table table-striped">
    <% @sessions.each do |session| %>
        <% if session.status == 0 %>
           <% classname = "active"  %>
        <% else %>
           <% classname = "noactive" %>
        <% end %>

        <tr >
            <td><div class= <%= classname %>><%= link_to session.name, "session_path"%></div></td>
            <td><div class= <%= classname %>><%= link_to session.user, edit_user_path(session.user)%></div></td>
            <td><div class= <%= classname %>><%= link_to "Details", details_path, :class => "btn btn-mini" %></div></td>
        </tr>
    <% end %>
</table> 
```

我的CSS看起来像这样：

```
.active {
  background-image:url(/assets/my_arrow.gif);
  background-repeat: repeat-x, no-repeat;
  background-position: center;
}
.noactive {} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:02:08.563

这是因为 Bootstrap 表条带化规则 -- `.table-striped tbody tr:nth-child(odd) td`-- 比您的`.active`规则更具体。你可以：

*   使`.active`规则更具体（另外，考虑使其适用于`td`，因为我似乎记得工作比设置 a 更规律`tr`），
*   `.table-striped`从表中删除并添加您自己的条带化规则，或
*   `!important`如果您想对此进行核对，请添加。

网上有很多关于这方面的资源，例如[理解 CSS 中的样式优先级：特异性、继承和级联](http://www.vanseodesign.com/css/css-specificity-inheritance-cascaade/)。

至于手工条纹，是的，很容易。这是整个 Bootstrap`.table-striped`定义：

```
.table-striped tbody tr:nth-child(odd) td,
.table-striped tbody tr:nth-child(odd) th {
  background-color: #f9f9f9;
} 
```

# visual-studio-2010 - 升级到 Visual Studio 2010 Team Edition 并从 Visual Intercept Manager 迁移存储库

> ID：12847477
> 
> 赞同：0
> 
> 时间：2012-10-11T19:56:18.303
> 
> 标签：visual-studio-2010, bug-tracking, issue-tracking

我们有一个名为 Visual Intercept Manager 的工具，用于跟踪所有问题和事件。我们使用它来存储所有应用程序更改、增强功能和更改请求。对于熟悉 Visual Intercept Manager 的人，请随意跳入并继续阅读。

因此，我的问题是了解将存储库从 Visual Intercept Manager 移动到 Visual Studio Team Foundation Server 所需的过程。你有什么成功吗？有哪些在线材料可以开始使用它。也许，如果你有时间，你能描述一下它是如何完成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:01:03.587

看来您需要将 VI 项导出为 excel 并将它们导入 TFS。

[http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/81a3237e-5118-4d60-9a91-c266e135afce/](http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/81a3237e-5118-4d60-9a91-c266e135afce/)

# objective-c - 如何将 Facebook 应用程序与现有 Facebook 页面连接？

> ID：12847478
> 
> 赞同：1
> 
> 时间：2012-10-11T19:56:22.253
> 
> 标签：objective-c, ios, facebook, facebook-apps, facebook-page

我的一个应用程序有一个 Facebook 粉丝页面（创建于 2011 年底）。我正在向应用程序添加 Facebook SDK 支持，以允许用户将照片发布到他们的新闻提要。

我想要做的是将 FACEBOOK APP 与现有的 FACEBOOK PAGE 连接起来。

我假设您可以进入 Facebook 页面设置并将应用程序链接到页面。但我似乎找不到任何东西。我也查看了应用程序设置，其中有 Canvas 页面、页面选项卡，但看起来并不完全正确。

**我真正想做**的就是让我的用户从我的应用程序中将照片发布到他们的新闻源中。然后这些照片链接到 Enscripted 粉丝页面。因此，如果我遗漏了什么，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T00:31:20.117

要将应用程序添加到 Facebook 页面，您需要将页面选项卡添加到您的页面。本文档将帮助您：[https ://developers.facebook.com/docs/appsonfacebook/pagetabs/](https://developers.facebook.com/docs/appsonfacebook/pagetabs/)

# android - ormlite 将日期读取为 'yyyy-MM-dd'

> ID：12847484
> 
> 赞同：8
> 
> 时间：2012-10-11T19:57:02.250
> 
> 标签：android, sqlite, ormlite

我需要阅读给我的 sqlite 数据库，因此我无法更改表中的日期格式 (yyyy-MM-dd)。当我尝试使用 ormlite 为我生成对象时，使用以下注释：

```
@DatabaseField(columnName = "REVISION_DATE", dataType = DataType.DATE_STRING)
public Date revisionDate; 
```

它给了我以下错误：

```
java.sql.SQLException: Problems with column 3 parsing date-string '2012-05-01'
      using 'yyyy-MM-dd HH:mm:ss.SSSSSS' 
```

有什么地方可以告诉 ormlite 我想使用“yyyy-MM-dd”作为日期字符串？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-11T20:01:41.410

如果您查看有关[日期格式的](http://ormlite.com/docs/date-formats)[ORMLite](http://ormlite.com/)文档，您会看到它提到了该[字段](http://ormlite.com/docs/format-field)。以下[是](http://ormlite.com/javadoc/ormlite-core/com/j256/ormlite/field/DatabaseField.html#format%28%29). 这允许您设置格式。[`@DatabaseField.format`](http://ormlite.com/docs/format-field)[`format`](http://ormlite.com/javadoc/ormlite-core/com/j256/ormlite/field/DatabaseField.html#format%28%29)`Date`

以下应该有效：

```
@DatabaseField(columnName = "REVISION_DATE", dataType = DataType.DATE_STRING,
      format = "yyyy-MM-dd")
public Date revisionDate; 
```

# python - 在多功能python脚本中使用--verbose

> ID：12847485
> 
> 赞同：0
> 
> 时间：2012-10-11T19:57:06.120
> 
> 标签：python, verbosity

我想在我的 python 脚本中添加一个详细的选项，但我不确定解决这个问题的最佳方法。我的 main() 函数调用 parse_cmdline() 函数，然后调用 process() 函数。我想为我的详细选项创建一个函数。我不确定我应该在哪里定义我的详细函数。我是否必须将详细选项从我的 parse_cmdline() 传递给我的 process() 函数？我正在寻找解决此问题的最佳方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:34:43.177

# 日志记录

您基本上需要一个日志记录模块来根据所需的详细程度过滤掉输出。也就是说，每条输出消息都会被赋予一个严重级别（如`debug`或`warning`），然后您可以决定要显示的消息的最低严重级别是多少。

您只需使用解析的参数来决定所需的严重级别（基本上，最低严重级别越高，程序越不冗长）。

# 日志

我只能推荐很棒的 [`logbook`](http://packages.python.org/Logbook/)模块。使用将[`handler`](http://packages.python.org/Logbook/api/handlers.html)日志`level`设置为您需要的最低严重性的 a 将轻松解决您的问题（例如仅显示`notice`和更高...）。

`print`然后，您必须将脚本中的调用替换为[记录调用](http://packages.python.org/Logbook/quickstart.html#quickstart) `logbook.debug`，`logbook.info`等等。

中有很多更高级的功能`logbook`，请随意查看文档。

* * *

请注意，默认情况下，[`logbook`注册 a`StderrHandler`](https://github.com/mitsuhiko/logbook/blob/master/logbook/__init__.py#L45)并将其推送到应用程序，您可以使用 轻松撤消它`logbook.default_handler.pop_application()`。

[正如文档](http://packages.python.org/Logbook/quickstart.html#registering-handlers)所建议的，还有其他解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:03:59.807

你调查[过 argh](http://packages.python.org/argh/tutorial.html)吗？

首次导入

```
import argh 
```

然后你会使用这样的东西来添加选项

```
@argh.arg('--verbose', default=False, help='Be more verbose') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:01:39.530

解析您的选项`argparser`并传递它们或将它们放入`global`

请注意，`global`当您想要分配给全局范围内的某个名称时，您只需要使用关键字，而不是当您只想读取值时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T20:04:14.733

看看[`plac`](http://plac.googlecode.com/hg/doc/plac.html)。`argparse`在我看来，它是一个很棒的命令行解析包，比内置的更直观。

# bash - 交织两个文件 bash 脚本

> ID：12847488
> 
> 赞同：2
> 
> 时间：2012-10-11T19:57:26.687
> 
> 标签：bash, sed, awk

我试图交织两个每行包含一个句子的文件。我将第一个文件的行间距加倍（`sed G`），我想将第二个文件的内容合并到那些空行中。

如何交织两个文件，使文件 B 的第一行低于文件 A 的第一行，文件 B 的第二行低于文件 A 的第二行，直到它到达末尾？

示例：[行号|句号|句子]

```
1  1 fileA
2   
3  2 fileA
4  
5  3 fileA
6  
7  4 fileA 
```

预期结果：

```
1  1 fileA
2  1 FILEB
3  2 fileA
4  2 FILEB
5  3 fileA
6  3 FILEB
7  4 fileA 
```

这是一个 bash 脚本：可以用`sed`or完成`awk`吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T20:08:59.783

这可能对您有用（GNU sed）：

```
sed 'R fileB' fileA 
```

您不需要先将文件空间加倍。

如果你想替换空行：

```
sed -e '/./!{R fileB' -e ';d}' fileA 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T20:40:32.640

如果您有原始的未加空格的文件，则可以使用`paste`plus (GNU) `sed`。我假设`Control-A`您的句子中没有 ^A ( ) 字符：

```
paste -d'^A' fileA fileB | sed 's/^A/\n/' 
```

该`paste`命令连接两个文件中的行，然后`sed`用换行符替换标记 ^A。这适用于 GNU `sed`；BSD 不太好`sed`。您还可以使用`awk`：

```
paste -d'^A' fileA fileB | awk '{sub(/^A/, "\n"); print}' 
```

请记住在脚本`Control-A`中出现的位置键入。`^A`

您也可以使用 Perl 轻松完成，它只需要一个进程而不是这里的两个进程。

* * *

我还想到您可以使用 转换控制字符`tr`，这可以说更简单：

```
paste -d'^A' fileA fileB | tr '\001' '\012'  # octal escapes for ^A and NL 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T14:32:50.703

如果您将第一个文件取消双倍空间（例如使用`sed -n 1~2p`），则可以使用`paste`换行符分隔符（使用 GNU 粘贴测试）：

```
paste -d'\n' file1 file2 
```

*使用Birei*回答中的文件进行测试：

```
fileA 1
fileB 1
fileA 2
fileB 2
fileA 3
fileB 3 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T20:23:49.087

使用`awk`：

假设**fileA**有数据：

```
fileA 1
fileA 2
fileA 3 
```

和**fileB**：

```
fileB 1
fileB 2
fileB 3 
```

运行以下脚本：

```
awk 'FNR < NR { exit; } { getline lineB <ARGV[ARGC-1]; printf "%s\n%s\n", $0, lineB; }' fileA fileB 
```

这会产生：

```
fileA 1
fileB 1
fileA 2
fileB 2
fileA 3
fileB 3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-11T21:04:40.953

另一个例子：

**文件 1**

```
fileA 1
fileA 2
fileA 3 
```

**文件2**

```
fileB 1
fileB 2
fileB 3 
```

**命令：**

```
awk '{getline a < "file2" split(a, b, FS); print NR, $2, $1 "\n" NR+++1, b[2], b[1] }' file1 
```

**结果：**

```
$ awk '{getline a < "file2" split(a, b, FS); print NR, $2, $1 "\n" NR+++1, b[2], b[1] }' file1
1 1 fileA
2 1 fileB
3 2 fileA
4 2 fileB
5 3 fileA
6 3 fileB 
```

# javascript - 模拟没有任何插件或 UI 的滚动条 - 可能与否？

> ID：12847494
> 
> 赞同：0
> 
> 时间：2012-10-11T19:57:48.117
> 
> 标签：javascript, jquery, scroll, scrollbar

我有一个`div`里面的列表。`div`设置`overflow:hidden`为。旁边`div`我有一个小把手，用来控制滚动。

首先，我想知道是否可以根据手柄是向上还是向下滚动该列表。但我想在没有`overflow:scroll`、没有任何插件和没有 jQuery UI 的情况下做到这一点。

仅使用纯 JavaScript/Jquery。我没有在互联网上找到任何东西。那一定是可能的，对吧？

我不需要它来向上或向下滚动键。我不需要向上滚动，向下滚动按钮。只有一个小把手。我什至不需要它用鼠标滚轮滚动。

可能的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T23:13:43.063

如果你想自己做，它会是这样的：

您定义了一些样式：

```
* { padding:0; margin:0; }
.container { padding:0 10px; margin:0; background-color:#444; width:400px; height:400px; overflow:hidden; }
.scrollable { background-color:#5a5; width:100%; height:800px; position:relative; top:0; }
p { margin:0 0 30px 0; } 
```

然后是html：

```
<div class="container">
    <div class="scrollable">
        <p>Line 1</p>
        <p>Line 2</p>
        <p>Line 3</p>
        <p>Line 4</p>
        <p>Line 5</p>
        ...
    </div>
</div> 
```

您可以使用 Jquery 更改元素的“顶部”位置：

```
function scroll(target, x)
{
    $(target).animate({ top: x, duration: 2000});
} 
```

您可以从鼠标滚动、正在移动的处理程序或其他一些事件中调用这样的函数：

```
scroll(".scrollable", "50%"); 
```

但是，正如其他人指出的那样，根据您的要求，使用现有的库可能会更好。

# javascript - javascript, three.js - 如何补间相机的 FOV

> ID：12847496
> 
> 赞同：2
> 
> 时间：2012-10-11T19:57:52.330
> 
> 标签：javascript, webgl, three.js

我正在尝试遵循本教程：

[http://learningthreejs.com/blog/2011/08/17/tweenjs-for-smooth-animation/](http://learningthreejs.com/blog/2011/08/17/tweenjs-for-smooth-animation/)

在three.js中补间相机的视野，但该值似乎没有更新。知道我做错了什么吗？这是我的代码：

```
 var fov = 70;
    var zoomFov = 100;

    function onDocumentMouseUp( event ) {
        castRay(); 
    }

    function castRay(){
        var vector = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1, - ( event.clientY / window.innerHeight ) * 2 + 1, 0.5 );
        projector.unprojectVector( vector, camera );
        var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );
        var intersects = ray.intersectObjects( objects );
        if ( intersects.length > 0 ) {
            var camObj = intersects[0].object;
            camTween = new TWEEN.Tween( fov ).to( zoomFov,500 ).easing( camEase );
            camTween.start();
            camTween.onUpdate(function(){
                updateCam(fov);
            });
        }
    }

    function updateCam(fov){
       console.log(fov); //MH - outputs 70 every time
    }

function animate() {

    requestAnimationFrame( animate );
    render();
    TWEEN.update();

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T21:59:14.650

我用下面的代码解决了这个问题。似乎补间类需要对象的属性才能正确更新（？）

```
var fov = 70, zoomFov = 10, currentFov, camTween;

function castRay(){
    var vector = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1, - ( event.clientY / window.innerHeight ) * 2 + 1, 0.5 );
    projector.unprojectVector( vector, camera );
    var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );
    var intersects = ray.intersectObjects( objects );
    if ( intersects.length > 0 ) {
        setupTween();
    }
}

function setupTween(){
    var update = function(){=
        camera.projectionMatrix.makePerspective( currentFov.fov, window.innerWidth / window.innerHeight, 1, 1100 );
        render();
    }

    currentFov = { fov: 70};
    TWEEN.removeAll();
    camTween = new TWEEN.Tween( currentFov ).to( {fov: zoomFov},500 ).easing( camEase ).onUpdate(update);
    camTween.start();
}

function animate() {

    requestAnimationFrame( animate );
    render();
    TWEEN.update();

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:02:30.573

我认为问题是你`camTween.update()`从来没有打电话。如果您的代码中的某处没有渲染循环，则类似以下的内容可能能够修复它：

```
setInterval(function(){ 
    camTween.update(); 
}, 50); 
```

否则我会`camTween.update()`在你的渲染循环中调用。

# c# - 使用未知 dll 从字符串写入字节数组

> ID：12847498
> 
> 赞同：0
> 
> 时间：2012-10-11T19:58:06.120
> 
> 标签：c#, dll, file-io

我有以下代码：

```
 int BufSize = 60000000;
    int BufSizeM1M = BufSize - 1000000;
    byte[] ByteBuf = new byte[BufSizeM1M];
    byte[] ByteBufVer = new byte[BufSizeM1M];
    using (WinFileIO WFIO = new WinFileIO(ByteBuf))
    {
        WFIO.OpenForWriting(path);
        Byte[] BytesInFiles = GetBytes(content);
        WFIO.WriteBlocks(BytesInFiles.Length);
    } 
```

**编辑：** 这是我正在使用的原始代码，尝试自己修改它似乎失败了，所以我想你们可能会看看：

```
 int BufSize = 60000000;
  int BufSizeM1M = BufSize - 1000000;
  byte[] ByteBuf = new byte[BufSizeM1M];
  byte[] ByteBufVer = new byte[BufSizeM1M];
  int[] BytesInFiles = new int[3]
  using (WinFileIO WFIO = new WinFileIO(ByteBuf))
      WFIO.OpenForWriting(path);
      WFIO.WriteBlocks(BytesInFiles[FileLoop]);
  } 
```

`FileLoop`介于`int`0-3 之间（代码循环运行），用于测试写入速度。如何更改它以编写字符串的实际内容？

WFIO dll 是在没有说明的情况下提供给我的，我似乎无法让它工作。上面的代码是我能得到的最好的，但它写入了一个用空格填充的文件，而不是`content`变量中的实际字符串。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:01:07.930

您似乎只向该组件传递了一个长度（字节数），因此它可能不知道要写什么。您的`ByteBuf`数组被初始化为一个空字节数组，您可能会写出-s的`BytesInFiles.Length`数量。`0`您将转换后的内容放入其中`BytesInFiles`，但您从不使用该缓冲区进行写入 - 您只使用它的长度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:04:25.197

我想你可能在这里错过了一步。完成后：

```
Byte[] BytesInFiles = GetBytes(content); 
```

你不需要做点什么`BytesInFiles`吗？目前，您似乎正在编写 的块`BytesInFiles`，当您创建它时，这些块将被初始化为包含全零。

**编辑：**这样的东西有帮助吗？

```
Byte[] BytesInFiles = GetBytes(content); 

using (WinFileIO WFIO = new WinFileIO(BytesInFiles)) 
{ 
    WFIO.OpenForWriting(path);        
    WFIO.WriteBlocks(BytesInFiles.Length); 
} 
```

# python - 如何使用 mutagen.py 清除 mp3 元数据？

> ID：12847501
> 
> 赞同：2
> 
> 时间：2012-10-11T19:58:19.287
> 
> 标签：python, mp3, metadata, mutagen

我想清除 MP3 文件中的所有元数据，并且我已经在我的项目中使用了 Mutagen。有没有办法可以简单地清除文件中的所有元数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T20:31:01.300

看起来您可以使用对象的`delete`方法`MP3`：

```
mp3 = MP3(fname)
mp3.delete()
mp3.save() 
```

来源：[从 MP3 文件中删除 ID3 标签](http://code.activestate.com/recipes/577139-remove-id3-tags-from-mp3-files/)

# php - for 循环 vs while 循环 vs foreach 循环 PHP

> ID：12847502
> 
> 赞同：22
> 
> 时间：2012-10-11T19:58:22.973
> 
> 标签：php, performance, loops, nested-loops, control-structure

第一关我是 PHP 新手。我一直在脚本中使用 for 循环、while 循环、foreach 循环。我想知道

*   哪一个对性能更好？
*   选择循环的标准是什么？
*   当我们在另一个循环中循环时应该使用哪个？

我一直想知道要使用哪个循环的代码。

```
for($i=0;$i<count($all);$i++)
{
 //do some tasks here
 for($j=0;$j<count($rows);$j++)
 {
  //do some other tasks here 
 }
} 
```

很明显，我可以使用 while 编写上述代码。希望有人能帮助我找出应该更好地使用哪个循环。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-11T20:00:56.483

> 哪一个对性能更好？

没关系。

> 选择循环的标准是什么？

如果您只需要遍历对象或数组的所有元素，请使用`foreach`. 您*需要* `for`的案例包括

*   当您明确需要对数字索引执行操作时，例如：
*   当您需要在迭代中使用上一个或下一个元素时
*   当您需要在迭代期间更改计数器时

`foreach`更方便，因为它不需要您设置计数，并且可以通过任何类型的成员工作 - 无论是对象属性还是关联数组元素（a`for`不会捕获）。它通常最适合可读性。

> 当我们在另一个循环中循环时应该使用哪个？

两者都很好；在您的演示案例中，`foreach`是最简单的方法。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-10-11T20:01:15.343

> 哪一个对性能更好？

谁在乎？这不会很重要。曾经。如果这些微小的优化很重要，那么您就不会使用 PHP。

> 选择循环的标准是什么？

选择最容易阅读并且将来最不可能出错的那个。当你遍历整数时，`for`循环很棒。当您像数组一样循环遍历集合时，`foreach`这很棒，当您只需要循环直到“完成”时，`while`这很棒。

这也可能取决于风格规则（例如，在 Python 中，您几乎总是希望使用 foreach 循环，因为这是“在 Python 中完成的方式”）。我不确定 PHP 的标准是什么。

> 当我们在另一个循环中循环时应该使用哪个？

无论哪种循环类型最有意义（参见上面的答案）。

在您的代码中，`for`循环对我来说似乎很自然，因为您有一个定义的开始和停止索引。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-11T20:01:43.373

检查[http://www.phpbench.com/](http://www.phpbench.com/)以获得一些 PHP 基准测试的良好参考。

for 循环通常非常快。不要在 for 本身中包含您的 count($rows) 或 count($all) ，请在外面这样做：

```
$count_all = count($all);
for($i=0;$i<$count_all;$i++)
{
    // Code here
} 
```

将 count($all) 放在 for 循环中使其为每个循环计算此语句。首先计算值，然后在循环中使用计算使其只运行一次。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-11T20:01:27.913

*   对于性能而言，选择循环`for`还是`while`循环并不重要，迭代次数决定了执行时间。
*   如果您知道正手的迭代次数，请选择一个`for`循环。如果要在某个条件下运行和停止，请使用`while`循环

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-11T20:03:56.297

*   当您提前知道要执行多少次迭代时，for 循环更合适
*   While 循环用于相反的情况（当你不知道需要多少次迭代时）
*   当您必须迭代集合时，For-Each 循环是最好的。

据我所知，while 循环和 for 循环之间几乎没有性能差异我不知道 for-each 循环

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-09-17T22:05:09.963

***性能：*** 很容易测试。如果您正在做机器学习或大数据之类的事情，那么您应该真正查看已*编译*或*组装*而不是*解释*的东西；如果周期*真的很*重要。[以下是各种编程语言之间的一些基准。](https://blog.famzah.net/2016/09/10/cpp-vs-python-vs-php-vs-java-vs-others-performance-benchmark-2016-q3/)看起来`do-while`循环是使用`PHP`这些示例在我的系统上的赢家。

```
$my_var = "some random phrase";

function fortify($my_var){
    for($x=0;isset($my_var[$x]);$x++){
        echo $my_var[$x]." ";
    }
}

function whilst($my_var){
    $x=0;
    while(isset($my_var[$x])){
       echo $my_var[$x]." ";
       $x++;
    }
}

function dowhilst($my_var){
    $x=0;
    do {
       echo $my_var[$x]." ";
       $x++;
    } while(isset($my_var[$x]));
}

function forstream(){
    for($x=0;$x<1000001;$x++){
        //simple reassignment
        $v=$x;
    }
    return "For Count to $v completed";
}

function whilestream(){
    $x=0;
    while($x<1000001){
        $v=$x;
        $x++;
    }
    return "While Count to 1000000 completed";
}

function dowhilestream(){
    $x=0;
    do {
        $v=$x;
        $x++;
    } while ($x<1000001);
    return "Do while Count to 1000000 completed";
}

function dowhilestream2(){
    $x=0;
    do {
        $v=$x;
        $x++;
    } while ($x!=1000001);
    return "Do while Count to 1000000 completed";
}

$array = array(
    //for the first 3, we're adding a space after every character.
        'fortify'=>$my_var,
        'whilst'=>$my_var,
        'dowhilst'=>$my_var,
   //for these we're simply counting to 1,000,000 from 0
   //assigning the value of x to v 
        'forstream'=>'',
        'whilestream'=>'',
        'dowhilestream'=>'',
   //notice how on this one the != operator is slower than
   //the < operator
        'dowhilestream2'=>''
        );

function results($array){
    foreach($array as $function=>$params){

      if(empty($params)){
        $time= microtime();
        $results = call_user_func($function);  
      } elseif(!is_array($params)){
        $time= microtime();  
        $results = call_user_func($function,$params);
      } else {
        $time= microtime();  
        $results = call_user_func_array($function,$params);
      }
      $total = number_format(microtime() - $time,10);
      echo "<fieldset><legend>Result of <em>$function</em></legend>".PHP_EOL;
      if(!empty($results)){
          echo "<pre><code>".PHP_EOL;
          var_dump($results);
          echo PHP_EOL."</code></pre>".PHP_EOL;
      }
      echo "<p>Execution Time: $total</p></fieldset>".PHP_EOL;
    }
}

results($array); 
```

***标准：*** [while](http://php.net/manual/en/control-structures.while.php)、 [for](http://php.net/manual/en/control-structures.for.php)和[foreach](http://php.net/manual/en/control-structures.foreach.php)是大多数人在 PHP 中使用的主要控制结构。[do-while](http://php.net/manual/en/control-structures.do.while.php)比`while`我的测试更快，但在 web 上的大多数 PHP 编码示例中基本上没有得到充分利用。

`for`是计数控制的，因此它会迭代特定的次数；尽管我自己的结果比使用 a`while`来做同样的事情要慢。

`while`当某些东西可能以 开头时很好`false`，因此它可以防止某些东西运行和浪费资源。

`do-while`至少一次，然后直到条件返回`false`。它比我的结果中的循环快一点`while`，但它至少会运行一次。

`foreach`有利于遍历`array`or `object`。即使您可以`for`使用数组语法通过语句循环遍历字符串，但在 PHP 中却不能使用 foreach 来执行此操作。

***控制结构嵌套：***这实际上取决于您在做什么来确定嵌套时使用的控制结构。在某些情况下，例如面向对象编程，您实际上希望（单独）调用包含您的控制结构的函数，而不是使用包含许多嵌套控件的过程风格的大量程序。这可以使其更易于阅读、调试和实例化。

# c - 结构数组的典型模式？

> ID：12847503
> 
> 赞同：2
> 
> 时间：2012-10-11T19:58:25.373
> 
> 标签：c

我有一个要添加的 somestruct_t 数组，但事先不知道它需要多少元素。所以我首先分配了 5 个空间槽，但我需要将它封装在另一个结构中，以保存数组边界和到目前为止使用的内容，这样我就不会溢出。如果它看起来会溢出，我会重新分配。

```
typedef struct {
  somestruct_t[] *data;
  uint32_t max_size;
  uint32_t used;
} something_box_t; 
```

这是惯用的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:04:45.423

您可以看到这通常由[链表](http://en.wikipedia.org/wiki/Linked_list)完成（在 C 中，例如在内核模式 Windows 驱动程序中），这是一个如何实现您自己的[示例。](http://www.macs.hw.ac.uk/~rjp/Coursewww/Cwww/linklist.html)

C++ 为您提供模板以使列表更加灵活。

C++ 还为您提供 stl 容器（如`std::vector`），但[bames53 已经建议使用](https://stackoverflow.com/a/12847525/1149736).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T20:00:16.927

有时在 C 中完成的一件事是在结构的末尾使用零长度数组，并为可变数量的元素分配额外的空间。我不确定零长度数组在 C 中是否合法（它们不在 C++ 中），但它通常受到支持。

```
struct something_box_t {
  uint32_t max_size;
  uint32_t used;
  somestruct_t data[];
};

something_box_t *box = malloc(sizeof(something_box_t) + N*sizeof(somestruct_t));
box.max_size = N;
box.used = 0;

box.data[0] = ...;
box.data[1] = ...; 
```

当然，如果您可以切换到 C++，您就不必自己拼凑解决方案。你可以做`std::vector<somestruct_t> box;`一个更容易使用的解决方案，即使不是更高性能，也更可靠，比你可能用 C 编写的解决方案更可靠。

# php - 显示文件夹的内容

> ID：12847513
> 
> 赞同：0
> 
> 时间：2012-10-11T19:59:13.037
> 
> 标签：php, ftp

我有以下 PHP 代码来显示我网站中目录的内容：

```
<?php
$conn = ftp_connect("host") or die("Could not connect");
ftp_login($conn,"username","password");

if ($_GET['dir'] != null) {
    ftp_chdir($conn, "logs/{$_GET['dir']}");
}
else
{
    ftp_chdir($conn, "logs");
}

$files = ftp_nlist($conn,"");

foreach($files as $value) {
    echo "<a href=\"test.php?dir={$value}\">{$value}</a>";
}

ftp_close($conn);
?> 
```

[这是我的网页](http://ahstpc.6te.net/site/test.php)

当我点击 subdirectory1 或 subdirectory2 时，我会得到它的内容（一些图像）。然后当我点击其中一张图片时，我会得到我网站根目录的内容。

当访问者点击它时，如何只显示图像？请注意，我不想下载它或任何东西 - 我只想在访问者点击它时在浏览器中显示它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T22:48:31.503

您需要确定哪些返回的项目是文件，哪些是目录。为此，您最好使用[ftp_rawlist](http://php.net/manual/en/function.ftp-rawlist.php)，因为它允许提取更多数据。然后为每个案例创建链接，以便您可以适当地处理它们。这是一个可能的实现：

```
$ftpHost = 'hostname';
$ftpUser = 'username';
$ftpPass = 'password';
$startDir = 'logs';

if (isset($_GET['file'])) {
    // Get file contents (can also be fetched with cURL)
    $contents = file_get_contents("ftp://$ftpUser:$ftpPass@$ftpHost/$startDir/" . urldecode($_GET['file']));

    // Get mime type (requires PHP 5.3+)
    $finfo = new finfo(FILEINFO_MIME);
    $mimeType = $finfo->buffer($contents);

    // Set content type header and output file
    header("Content-type: $mimeType");
    echo $contents;
}
else {
    $dir = (isset($_GET['dir'])) ? $_GET['dir'] : '';

    $conn = ftp_connect($ftpHost) or die("Could not connect");
    ftp_login($conn, $ftpUser, $ftpPass);

    // change dir to avoid ftp_rawlist bug for directory names with spaces in them
    ftp_chdir($conn, "$startDir/$dir");

    // fetch the raw list
    $list = ftp_rawlist($conn, '');

    foreach ($list as $item) {
        if(!empty($item)) {
            // Split raw result into pieces
            $pieces = preg_split("/[\s]+/", $item, 9);

            // Get item name
            $name = $pieces[8];

            // Skip parent and current dots
            if ($name == '.' || $name == '..')
                continue;

            // Is directory
            if ($pieces[0]{0} == 'd') {
                echo "<a href='?dir={$dir}/{$name}'><strong>{$name}</strong></a><br />";
            }
            // Is file
            else {
                echo "<a href='?file={$dir}/{$name}'>{$name}</a><br />";
            }
        }
    }

    ftp_close($conn);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:32:36.727

您需要添加一个函数来检查我们正在处理的文件类型。如果是目录，则显示常规链接（您现在正在使用的链接），如果是图像，则显示带有图像路径的链接。

因为`$value`包含您可以`end(explode('.',$value));`用来查找分机的文件的名称。文件（php、jpg、gif、png）。对这条信息使用另一个条件，您可以识别它是否是图片。

为了构建`path`图像，您需要使用`$_GET['dir']`变量的值。例如：

```
<a href='<?=$_GET['dir']?>/Flower.gif'>Flower.gif</a> 
```

我希望你明白了。

# html - HTML 表单：提交带有换行符的文本输入

> ID：12847520
> 
> 赞同：2
> 
> 时间：2012-10-11T19:59:43.047
> 
> 标签：html, forms

> **可能重复：**
> [如何将用户输入的换行符从 TEXTAREA 保存到数据库？](https://stackoverflow.com/questions/498461/how-to-save-user-entered-line-breaks-from-a-textarea-to-a-database)

我在这里错过了一些简单的解决方案吗 - 我正在创建一个带有文本输入的表单。我希望这与任何换行符一起提交。用户实际上在 textarea 中写入，javascript/jquery 在提交之前将其复制到隐藏的文本输入中。

我已经看到了 javascript 用一些已知的中断字符替换 /n 等的解决方案。这是唯一的出路吗？然后我必须再次将其翻译回服务器端。我真的希望 /n 以 /n 的形式提交。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T20:15:38.647

您可以使用 a`<textarea style="display:none;"></textarea>`而不是 hidden `<input type="text">`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T20:25:43.867

当提交带有普通文本区域的普通表单时，用户输入的任何换行符都会作为数据的一部分传输。它们被规范化为 CR LF 对。如果将 textarea 元素的值复制到隐藏字段，则会保留换行符。

所以问题在别处。可能您的服务器端表单处理程序没有准备好处理换行符。或者，它使用数据的方式可能会使换行符失去意义，或者完全丢失。一个常见的新手错误是将接收自表单的值写入 HTML 文档——即使保留了换行符，当它们作为内容出现在普通元素中时（与 eg`textarea`或`pre`）。

*默认情况下，由浏览器自动*换行而不是由用户操作创建的任何换行符都会丢失。通常没有理由保留它们，但如果您希望这样做，请使用元素`wrap=hard`中的属性。`textarea`（该属性是非标准的，但被广泛支持。=

# django - 按创建日期显示 Django 对象

> ID：12847523
> 
> 赞同：0
> 
> 时间：2012-10-11T20:00:11.943
> 
> 标签：django, datetime, django-queryset

我为一家食品配送公司建立了一个电子商务网站。他们每天晚上 7 点至凌晨 2 点进行送货。

我想建立一个页面，他们可以在其中查看从一开始的所有订单，按每个日期划分。但是 10 月 8 日的一天交付将包括 10 月 8 日晚上 7 点至 11:59 的交付以及 10 月 9 日凌晨 12:00 至凌晨 2 点的交付。

我对如何按“创建日期”过滤对象有一个大致的想法，但我不确定如何聚合所有不同的日期并以有组织的方式显示它们。

我也在使用 python 2.6，所以我不能将每天的订单存储在有序的字典中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:04:36.403

**已编辑**

也许您正在寻找[查询范围](https://docs.djangoproject.com/en/dev/ref/models/querysets/#range)来选择数据的一部分。样本：

```
start_date = datetime.datetime(2012, 2, 17, 19, 00, 00, 00)
end_date = datetime.datetime(2012, 2, 23, 59, 00, 00, 00)
Deliveries.objects.filter(deliveries_date__range=(start_date, end_date)) 
```

（未测试）

但是，重新阅读您的问题也许您的问题在于表示层，然后，在您的模板中，您应该按天“剪切”数据。[`ifchange`您可以使用块标签](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#ifchanged)检查模板中的某些字段是否更改：

```
{% for deliver in deliveries %}
    {% ifchanged deliver.deliveries_date.date %} 
            {{ deliver.deliveries_date.date }} 
    {% endifchanged %}
    ...
{% endfor %} 
```

# javascript - 如何使用 Socket.io 调试 Node.js

> ID：12847526
> 
> 赞同：3
> 
> 时间：2012-10-11T20:00:18.230
> 
> 标签：javascript, node.js, websocket, socket.io

我正在使用 Eclipse 的 Google Chrome Developer Tools 插件来调试我的 Node.js 服务器。该服务器使用 Socket.io 作为我的 Web 客户端和服务器之间的 websocket 连接。当我在服务器中设置断点并开始单步执行代码时，问题就出现了。客户端很快就决定服务器不再存在，因为不再有心跳或任何通信，所以它断开连接。同时，当我逐步完成时，我的代码尝试对套接字做一些事情，然后它死了，因为套接字现在已关闭。尝试像这样进行调试有点棘手。

所以问题是，如何使用打开的 websocket 连接调试这样的服务器而不关闭连接？我不知道有什么好的解决方案，但我想我会把它放在那里，看看是否有人有天才的想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T17:27:18.843

在做了更多研究之后，我发现了几个看起来很有希望的不同项目，即“node-inspector”和“node-codein”。但是，node-inspector 不适用于最新版本的 node，并且 node-codein 有很多错误。此外，两者都没有真正维护，它们都只适用于 Chrome。因此，我编写了自己的解决方案，称为[Node Monkey](https://github.com/jwarkentin/node-monkey)，它使用起来非常简单，并且适用于 Firefox 或 Chrome。它只是捕获记录到 Node 应用程序中控制台的内容，并将该输出重定向到浏览器控制台。您可以通过运行安装它：

```
npm install node-monkey 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-11T20:03:10.807

即使听起来有点讨厌和陈旧，但在这种情况下（实际上是调试客户端->服务器环境）我经常在服务器端使用标准输出，就像`console.log()`and `console.debug`.

如果您需要调试客户端脚本，如果您不想丢失服务器连接，也*可以这样做。**除了重新配置socket.IO*的心跳超时基本上更高之外，我实际上没有看到任何其他解决方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-11T22:37:40.993

我知道这是很久以后的事了，但我发现另一个非常适合快速 socket.io 完整性检查的选项是[socket-io-tester](https://github.com/AppSaloon/socket.io-tester)。

我在这里提到它，因为这个答案是谷歌上的第一个结果，我花了更多的时间去寻找这个工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-25T05:03:51.540

**为此，您可以遵循 socket.io 的官方文档**

> [https://socket.io/docs/v3/logging-and-debugging/index.html](https://socket.io/docs/v3/logging-and-debugging/index.html)

就我而言，我在 package.json 中做了这个

```
"scripts": {
 "test": "echo \"Error: no test specified\" && exit 1",
 "start": "DEBUG=engine,socket.io* nodemon src/server.js"}, 
```

我希望它对您有所帮助，如果您有任何疑问，请随时问我

# ruby-on-rails - Rails 将 .svg 用作 html

> ID：12847527
> 
> 赞同：0
> 
> 时间：2012-10-11T20:00:25.933
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我在我的应用程序中使用 rqrcode-rails3 gem。我想生成 SVG 或 PNG 格式的二维码。我正在使用带有 Ruby 1.8.7 的 Rails 3.0.7。我遇到的问题是，rails 通过使用应用程序布局来呈现它，从而强制 .svg 文件呈现为 html 而不是 xml。

我在带有 rails 3.2.3 的测试应用程序中测试了 gem，它可以工作。但在我的实际应用程序中，我无法让它工作。

知道如何让它工作吗？

这是我的控制器中的内容：

```
 respond_to do |format|
      format.html
      format.svg { render :qrcode => request.url, :level => :l, :unit => 10 }
      format.png { render :qrcode => request.url }
    end
end 
```

# html - 使用 rel=next/prev 标签进行正确分页

> ID：12847529
> 
> 赞同：3
> 
> 时间：2012-10-11T20:00:31.533
> 
> 标签：html, seo

我的网站有两种基本类型的页面：

1.  列表页面，包含项目列表。每个项目都驱动到#2，一个详细信息页面。
2.  详细信息页面。部分内容，例如“新闻”或“博客文章”。有时，这些详细信息页面是分页的，例如“长列表的第 1 页”。

我对如何实现 rel=next/prev 感到非常困惑。

1.  我是否应该使用 prev/next 向 Google 显示页面是“所有博客文章的第 1 页”而“下一个”是“所有博客文章的第 2 页”？或者我应该将它们从我的列表页面中排除？
2.  对于单页详细信息页面，我应该使用 rel=prev/next 链接到集合中的下一个和上一个详细信息页面吗？
3.  对于多页详情页面，我知道我应该用 prev/next 标签链接页面，但最后一页应该有什么？似乎在分页详细信息页面的最后一页上使用 next/prev 可能会误导爬虫。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T10:00:52.690

1.  可能你根本不需要做任何事情。如果该系列中的内容倾向于保持不变，URL 被编号等，Google 可能会自行解决。

2.  不要在单页页面之间使用 prev/next。prev/next 的想法是将跨越多个页面的单个内容视为一个整体，因此将其应用于单个页面的内容，即使它们可以被视为某个组或集合的一部分，也会对他们不利。

3.  系列的第一页只有`"next"`标签，最后一页只有`"prev"`标签。其余的都有。

顺便说一句，如果您的分页是使用参数完成的，您还有一个替代方案，您可以使用 Google 网站管理员工具来通知 Googlebot 如何处理您的分页。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-12T08:50:50.217

如果您在文章（下面的链接）中发现任何令人困惑的地方，请告诉我们。而且，如果您完全理解文章和有关“查看全部”的文章（文章中的链接），那么我认为您的问题就解决了。

[使用 rel='next' 和 rel='prev' 进行分页](http://googlewebmastercentral.blogspot.in/2011/09/pagination-with-relnext-and-relprev.html)

# python - 如何从 setup.py 文件中获取构建基础

> ID：12847536
> 
> 赞同：1
> 
> 时间：2012-10-11T20:00:57.857
> 
> 标签：python

我想知道是否有一种方法可以从分发 setup.py 文件中获取构建基础（因为默认值可以被 -b 或 --build-base 选项覆盖），而不是解析参数。

# android - 强制使用 3g over Wi-Fi Android

> ID：12847537
> 
> 赞同：2
> 
> 时间：2012-10-11T20:01:01.207
> 
> 标签：android, wifi, 3g

我为 Android 2.3.3 开发的应用程序有问题。

它连接到 Wi-Fi 接入点，同时它应该下载一些数据，但这必须使用 3G 完成。

我尝试搜索此内容，并找到了一些相关的东西，但无法使其正常工作。我检查了`setNetworkPreference`ConnectivityManager 的方法，即使设置为使用 3G，它也不会下载数据并最终通过 Wi-Fi 下载数据。

在不断开 Wi-Fi 接入点的情况下如何做到这一点的任何其他想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T06:26:28.860

I literally just came across this on another forum. It looks like the solution to your question.

ICS tends to automatically add proxys to APN info which sometimes makes apps not work on 3G.

Thread says the following...

"This helped a couple of people on a Dutch forum, don't know if it's provider or country-related and if there even are users here that have these issues, but still wanted to let you know:

I have just fixed why some apps work only with WiFi but not on 3G. ICS apparently automatically added Proxy-settings to your APN, in my case Vodafone (NL). This is not necesarry to even make use of mobile internet, and it also prevents some apps from accessing the internet. I removed the Proxy-settings et voila, it works perfectly again!

Fix: Settings -> Press 'Mobile Network' (not Off-On!) -> Names accespoints -> Click your provider -> Remove 'Proxy' and 'Port'"

Hope it helps.

# image - iOS Colorwithpattern - 使用自定义 iPhone5 图像

> ID：12847541
> 
> 赞同：6
> 
> 时间：2012-10-11T20:01:14.513
> 
> 标签：image, uiview, background, ios6

对于我的应用程序的加载屏幕和启动屏幕，我使用了两种不同的方法来正确显示我的 iPhone 3、iPhone 4 和 iPhone 5 图像。

对于加载屏幕，只需在图像中添加 -568h@2x 即可支持 iPhone5。

对于闪屏，我使用了一系列（如果 height == ）案例来检查 UIScreen 边界的高度，并将适当的图像提供给图像视图。在我看来，-568h 并没有被普遍认为是 iPhone 5 的图像。它仅适用于加载屏幕。

现在，在我的 AppDelegate 中，我正在设置背景图像。我所有的子视图都有一个透明的背景，所以它们应该显示到背景图像。但是，我在这里设置背景图像时遇到了最大的麻烦。

简单地传入“Background.png”将 -568h@2x 添加到文件名的末尾是行不通的。它将执行非视网膜和 3.5 英寸视网膜显示器，但不会为 4 英寸显示器拾取。

IE：

```
self.window.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]]; 
```

如果我使用上面的代码片段，则使用 iPhone4 图片而不是 iPhone5 图片，这不是我想要的。

我开始尝试做与启动画面相同的事情。我有一堆 if 案例：

```
CGFloat height = [UIScreen mainScreen].currentMode.size.height;

if ( height == 1136 )
{
     //Choose image here
}
else if (height == 960)
{
     //Choose image here
}
else if (height == 480)
{
     //Choose image here
}
self.window.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:chosenImage]]; 
```

但是 colorWithPatternImage 函数认为 selectedImage 增加了 1 个点 = 1 个像素。所以我最终得到了一张非视网膜图片，试图适应 iPhone 5 的屏幕。它看起来像什么？看起来只有我想要的图像的左上象限显示在整个 iPhone 5 屏幕上。看起来没有应用视网膜缩放。

我需要 iPhone 识别出我有一张适合视网膜的 iPhone 5 图片用作背景。我该怎么做呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T21:20:40.033

[我在这里](http://alexanderwong.me/post/32365780864/iphone-5-retina-4-detection-and-asset-modifiers)找到了这段代码，也许它可以帮助你：

```
UIImage *tmpImage = [UIImage imageNamed:@"background-568h@2x.png"];
UIImage *backgroundImage = [UIImage imageWithCGImage:[tmpImage CGImage]
                                               scale:2.0
                                         orientation:UIImageOrientationUp];
self.window.backgroundColor = [UIColor colorWithPatternImage:backgroundImage]; 
```

# matlab - 在 Matlab 中读取和分析 .txt 文件

> ID：12847543
> 
> 赞同：2
> 
> 时间：2012-10-11T20:01:14.857
> 
> 标签：matlab, for-loop, nested-loops

我是 matlab 新手，在使用示例时遇到了一些麻烦。

科罗拉多河流域流域覆盖了西部七个州的部分地区。在科罗拉多河及其支流上建造了一系列水坝，以储存径流水并产生低成本的水力发电。调节水流的能力使这些干旱沙漠州的农业和人口增长成为可能。即使在长期干旱期间，基地州也有稳定、可靠的水和电来源。鲍威尔湖是这些水库之一。lake_powell.txt 包含 2000 年至 2007 年八年的水库水位数据。

a) 使用嵌套的 for 循环一次将一个水位值读入lake_powell 矩阵。

```
lake_powell(month,year) = fscanf(fileID, '%f', 1); 
```

打印带有标题和年份列标题的lake_powell 矩阵。

b) 使用平均值来确定每年的平均水位高度和收集数据的八年期间的总体平均值。

c) 使用查找和长度来确定每年有多少个月超过八年期间的总体平均值。

d) 创建一份报告，列出超过总体平均值的每个月份的月份（数字）和年份。例如，六月是第 6 个月。使用查找。

e) 确定并打印八年期间每个月的平均水位。使用平均值。

f) 绘制lake_powell 中的水位值，使用

```
date=2000:1/12:2008-1/12;
plot(date,lake_powell(:))
xlabel('Year')
ylabel('Water level, ft') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T15:18:00.483

听起来您应该使用 textscan 而不是 fscanf。

testscan 逐行读取分隔文件，其中每一行具有一致的格式。

阅读 textscan 的文档，你应该有你的解决方案。

# spring - 为什么 Mockito 认为这个自动装配的 bean 是空的？

> ID：12847545
> 
> 赞同：0
> 
> 时间：2012-10-11T20:01:21.870
> 
> 标签：spring, junit, mockito

我有这个类叫做restTemplate。它是 Spring Framework 中的 RestTemplate 对象。我试图在我的 Mockito 测试的设置方法开始时重置它，但我得到了异常：

```
org.mockito.exceptions.misusing.NotAMockException: Argument should be a mock, but is null! 
```

那么我做错了什么？我在下面列出了正确的包

```
<context:component-scan base-package = "..."/> 
```

它自动装配到我的测试类中，并列在我的 applicationContext-test.xml 文件中。我应该首先看什么？
编辑：

```
<bean id="restTemplate" class="org.mockito.Mockito" factory-method="mock">
    <constructor-arg value="org.springframework.web.client.RestTemplate" />
</bean> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T21:40:50.013

根据 API：[Mockito.mock](http://mockito.googlecode.com/svn/branches/1.6/javadoc/org/mockito/Mockito.html#mock%28java.lang.Class%29)接受一个实例，`Class<?>`但在您的 spring 配置中，您传递的`String`是一个类的完全限定名称，但它不是一个`Class<?>`实例。

它引出了一个问题，为什么要在 Spring 配置中设置模拟？为什么不在您的测试中实例化被测类并在那里创建模拟。模拟是为您设计的单元测试。如果您正在加载上下文，您可能正在接近集成测试。并不是说在 JUnit 测试中加载上下文是一件坏事，而是在其中使用 Mocks 似乎是混合了一些东西。

但是，如果您真的想尝试它，您可以尝试使用[Class.forName](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#forName%28java.lang.String%29)作为工厂方法来声明一个作为类实例的 bean。就像是：

```
<bean id="classInstance" class="java.lang.Class" factory-method="forName">
    <constructor-arg value="org.springframework.web.client.RestTemplate" /> 
</bean>

<bean id="restTemplate" class="org.mockito.Mockito" factory-method="mock">
    <constructor-arg ref="classInstance" /> 
</bean> 
```

# sql - Oracle/SQL - 在另一个表中查找或为空或可能不存在或为空的记录

> ID：12847549
> 
> 赞同：0
> 
> 时间：2012-10-11T20:01:36.400
> 
> 标签：sql, oracle

我要做的是返回我的persons表中不存在或确实存在的所有记录，但前提是它们在两个特定字段之一中具有空值。所以给定下表

```
person_id   ....
----------------
123         ....
456         ....
789         ....

p_id    colA    colB
--------------------
456     aadl
789     023j    ljlj 
```

我会得到以下

```
person_id   ....
----------------
123         ....
456         .... 
```

这是因为辅助表中不存在人员 123。也将返回人员 456，因为它们存在，但两列之一为空。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:05:52.607

你可以写：

```
SELECT *
  FROM persons
 WHERE person_id NOT IN
        ( SELECT p_id
            FROM secondary_table
           WHERE colA IS NOT NULL
             AND colB IS NOT NULL
        )
; 
```

# redirect - 子域和 url 重写

> ID：12847551
> 
> 赞同：1
> 
> 时间：2012-10-11T20:01:38.733
> 
> 标签：redirect, rewrite, subdomain

早上好，我有一个问题，我没有找到解决方案。我需要将多个域指向同一个文件夹，但是当我创建子域时我的主机指向与子域同名的文件夹。

我想要的结果是：

`demo.domainname.tld/index.php`将指向`www.domainname.tld/shop/index.php?username=demo` `demo.domainname.tld/product.php?id=100`将指向`www.domainname.tld/shop/product.php?id=100&username=demo`

`test.domainname.tld/index.php`将指向`www.domainname.tld/shop/index.php?username=test` `test.domainname.tld/product.php?id=100`将指向`www.domainname.tld/shop/product.php?id=100&username=test`

在 url 中保留子域地址。

我正在创建一个电子商务平台，我想使用独特的电子商务并通过保留子域中的用户名来加载不同的内容。

有可能的？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:09:14.313

只要所有的`*.domainname.tld`DNS 条目都指向同一个 IP`www.domainname.tld`并且它们都共享同一个文档根目录，您可以将这些规则添加到文档根目录中的 htaccess 中：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTP_HOST} ^([^.]+)\.domainname\.tld$ [NC]
RewriteRule ^/?index\.php$ /shop/index.php?username=%1 [L,QSA]

RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTP_HOST} ^([^.]+)\.domainname\.tld$ [NC]
RewriteRule ^/?product.php$ /shop/product.php?username=%1 [L,QSA] 
```

如果您想实际进行重定向，从而更改浏览器地址栏中的 URL，请`R`在方括号中包含一个标志，使其看起来像：`[L,QSA,R]`或`[L,QSA,R=301]`永久重定向。

# javascript - 使用 javascript 在 android 中获取选择文本

> ID：12847553
> 
> 赞同：1
> 
> 时间：2012-10-11T20:01:39.317
> 
> 标签：javascript, android, range

如何在 Android 中选择文本并使用 Javascript 检测 Android 浏览器？

一个例子：

```
<script>
function select(){
    var sel = window.getSelection();
    alert(sel);
}
</script>

<div onmouseup="select();">

it is a example 

<div> 
```

range 上的功能是否与 Android 兼容？

# php - 将多个数组连接在一起

> ID：12847563
> 
> 赞同：1
> 
> 时间：2012-10-11T20:02:06.993
> 
> 标签：php, arrays

我有一个看起来像这样的表格：

```
<form method="POST">
    <p>Model 1</p>
        <input name="data_quantity[]">
        <input name="data_consignment[]">
        <input name="data_price[]">

    <p>Model 2</p>
        <input name="data_quantity[]">
        <input name="data_consignment[]">
        <input name="data_price[]">

    <p>Model 3</p>
        <input name="data_quantity[]">
        <input name="data_consignment[]">
        <input name="data_price[]">

    ...
</form> 
```

现在。当我在 PHP 上读取数据时，我在 POST 数组 ( `$_POST`) 中有三个数组：`$_POST['data_quantity'], $_POST['data_consignment'], $_POST['data_price']`...

我需要将它们合并在一起，所以我计算一个数组中的总数，然后我做了一个`for`，然后我用帖子中每个数组中的值重新创建数组。快速示例：

```
public function build_Lineitems($Quantity=array(), $Consignment=array(), $TransferFrom=array(), $TransferTo=array(), $Price=array(), $Attributes=array()){
    ...

    #   On va boucler sur un des 6 tableaux...
    $Lineitems = array();

    foreach($Quantity as $ModelID => $Lineitem){
        #   Entrée dans le tableau
        if(isset($Lineitems[$ModelID]) === FALSE){
            $Lineitems[$ModelID] = array();
        }

        #   Est-ce que c'est un tableau
        if(is_array($Lineitem) === TRUE){
            foreach($Lineitem as $Entry => $Clone){
                $Lineitems[$ModelID][] = array(
                    'qty'       => (isset($Quantity[$ModelID][$Entry]) === TRUE ? $Quantity[$ModelID][$Entry] : array()),
                    'con'       => (isset($Consignment[$ModelID][$Entry]) === TRUE ? $Consignment[$ModelID][$Entry] : array()),
                    'xferfrom'  => (isset($TransferFrom[$ModelID][$Entry]) === TRUE ? $TransferFrom[$ModelID][$Entry] : array()),
                    'xferto'    => (isset($TransferTo[$ModelID][$Entry]) === TRUE ? $TransferTo[$ModelID][$Entry] : array()),
                    'price'     => (isset($Price[$ModelID][$Entry]) === TRUE ? $Price[$ModelID][$Entry] : array()),
                    'attr'      => (isset($Attributes[$ModelID][$Entry]) === TRUE ? (empty($Attributes[$ModelID][$Entry]) === FALSE ? explode(',', $Attributes[$ModelID][$Entry]) : array()) : array())
                );
            }
        } else {
            #   Okay
            $Lineitems[$ModelID] = array(
                'qty'       => (isset($Quantity[$ModelID]) === TRUE ? $Quantity[$ModelID] : array()),
                'con'       => (isset($Consignment[$ModelID]) === TRUE ? $Consignment[$ModelID] : array()),
                'xferfrom'  => (isset($TransferFrom[$ModelID]) === TRUE ? $TransferFrom[$ModelID] : array()),
                'xferto'    => (isset($TransferTo[$ModelID]) === TRUE ? $TransferTo[$ModelID] : array()),
                'price'     => (isset($Price[$ModelID]) === TRUE ? $Price[$ModelID] : array()),
                'attr'      => array()
            );
        }
    }

    #   On renvoie
    return $Lineitems;
} 
```

我的问题，有没有更清洁的方法来做到这一点？谢谢。（this：多个数组的合并部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:21:13.980

You can post the values multi-dimensional in the first place:

```
<input name="data[quantity][]"> 
```

Or in a different hierarchical order (while counting up `$i`):

```
<input name="data[<?php echo $i; ?>][quantity]"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:18:59.683

你有没有想过[array_merge](http://php.net/manual/en/function.array-merge.php)或者它的递归兄弟也会合并里面的所有东西？尽管您应该小心不要直接在 $_POST 上使用它，以免获得不需要的数据

# php - PHP\HTML dynamic dropdown listing with auto filed population from PostgreSQL database

> ID：12847564
> 
> 赞同：0
> 
> 时间：2012-10-11T20:02:07.057
> 
> 标签：php, html, postgresql, gis

I have updated this script. The dynamic dropdown portion of the script requirement has been achieved with contributions from the good members of this forum. Now I am working on getting some of the fields on the form to auto populate when an item is selected from the dropdown list. For instance if I select pipeno and wallthickiness from my dropdown, I would like to have the corresponding tuples of DJoint, pipeno2, Heatno1 and heatno 2 on the record to automatically populate their various fields in the form from the database The field I am looking to auto-populate are the ones Im echoing in the php scipt but I think something is not very right with my script as I keep getting this error on the last line of the script. I will really appreciate some contributions and help with this issue

> Parse error: syntax error, unexpected end of file in C:\Users\imasha\Documents\My Web Sites\Personal Site1\dropdown2.php on line 63

Here is my updated script

```
 <?php
         // Php Code to connect to postgresqldatabase
         include ("connection.php");

        $query = 'select * from fieldtally order by pipeno asc'; 
        $result = pg_query($db_handle,$query); 
        while ($row = pg_fetch_row($result))
        {

       // Creates Arrays to use in dropdowns
            $pipeno_array[] = $row[0];
            $wallthickness_array[] = $row[1];
        } 

        // Declare dropdown functions for the HTML form
        function dropdown($field_name, $num){

        // Creates the Dropdown
            echo "<select name=\"".$field_name."\" id=\"".$field_name.$num."\"\n";
            echo "<option value=\"\"> --- Select --- </option>\n";
            // Chooses which array to use for Dropdown options
            global $pipeno_array, $wallthickness_array;
            $name_array = ($field_name == 'pipeno') ? $pipeno_array : $wallthickness_array;
            // Creates the Dropdown options based off the array above
            foreach($name_array as $k){
                echo "<option value=\"$k\">$k</option> \n"; }
            // Ends the Dropdown
             echo "</select>\n"; 
             if($field_name == 'pipeno'){
                $wallthickness = 'wallthickness';
                echo $formValue->DJNo($DJno);
                echo $formValue->Heatno1($pipeweight);
                echo $formValue->pipeno2($pipeno2);
                echo $formValue->Heatno2($pipegrade);
        }
        ?>

        <html>
        <head><title>UG Pipeline Fiedl Data Capture</title>
        </head>
        <body>
        <p></p>
        <form action="<?php echo $PHP_SELF; ?>" method="post">
        <table width="600" cellpadding= "10" cellspacing="1" border="2">
        <tr align="center" valign="top">
        <td align="center" colspan="1" rowspan="1" bgcolor="#64b1ff">
        <h3>Input Field Tally Information</h3>
        Select Pipe No:<?php dropdown('pipeno', 1); ?>  Select Wall Thickness:<?php dropdown('wallthickness', 1); ?><br /><br />

     DJ No:<input type="text" name="jointno" value="<?php $DJno = "jointno"; echo $formValue->DJNo($DJno);?>"> 

    HeatNo1: <input type="text" name="pipeweight" value="<?php $pipeweight = "pipeweight"; echo $formValue->Heatno1($pipeweight); ?>"><br><br>

    pipeno2: <input type="text" name="loadtally" value="<?php $pipeno2 = "loadtally"; echo $formValue->pipeno2($pipeno2);?>"> 

    HeatNo2: <input type="text" name="pipeweight" value="<?php $pipeweight = "pipegrade"; echo $formValue->Heatno2($pipegrade); ?>"><br><br>

    Input Serial No: <input type="text" name="serialno"><br><br> 

    Input measured Length: <input type="text" name="measuredlength"><br><br>

    <input type="Submit" name="submit" value="Submit">

    </td></tr></table>
    </form>

<p>
<form action="fieldbend.php" method="post">
<table width="600" cellpadding="10" cellspacing="1" border="2">
<tr align="center" valign="top">
<td align="center" colspan="1" rowspan="1" bgcolor="#ff9d9d">
<h3>Input Field Bend Information</h3>
Select Pipe No:<?php dropdown('pipeno', 2); ?>  Select Wall Thickness:<?php dropdown('wallthickness', 2); ?><br /><br />
Input Measured Distance: <input type="text" name="measureddistance"><br /><br /> Input Bend Angle: <input type="text" name="benddegree"><br><br>
Input Bend Type: <input type="text" name="bendtype"><br><br>
<input type="Submit" name="submit" value="Submit">
</td></tr></table>
</form></P>

<p>
<form action="apptally.php" method="post">
<table width="600" cellpadding="10" cellspacing="0" border="2">
<tr align="center" valign="top">
<td align="center" colspan="1" rowspan="1" bgcolor="#66CC66">
<h3>Input App. Tally Information</h3>
 Input Type: <input type="text" name="type">   Input Serial No: <input type="text" name="serialno"><br><br>
Input Reference ID: <input type="text" name="referenceid"><br><br>
<input type="Submit" name="submit" value="Submit">
</td></tr></table>
</form></P>
     </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T22:02:23.287

I notice a few issues in your code.

The first one, pointed out by Mauricio, is that your `<options></options>` are not inside your `<select name="education"></select>` tags. Also why is your select name `education`, when the options are `$row['pipeno']`, and you are getting `$_POST['pipeno']`?

The second issue is when you are echoing the `<options></options>`.

```
//<option> value="<?=$row["pipeno"]; ?>"><?=$row["pipeno"]; ?></option>
        print ("<option> $row[0]</option>"); 
```

You are commenting out the `<option>` opening tag, the `value` is outside the `<option>` tag as you already closed it, and it looks like you are echoing each option twice with `<option value="<?=$row["pipeno"]; ?>"><?=$row["pipeno"]; ?></option>` & `print ("<option> $row[0]</option>");`

**EDIT** this is updated to match your edited code in your question

After looking over this again, I think your problem is how you are creating your dropdown. Try putting this at the top, as a function, and then you just call it later wherever you need it. You can then specify if the dropdown is for `pipeno` or `wallthickness` and then just specify what # of dropdown, so it can create a unique `id`.

Try changing the code to-

```
<?php
 $PGHOST = "localhost:25376";
 $PGDATABASE = "Pipeline";
 $PGUSER = "postgres";
 $PGPASSWORD = "Casa2009";
 $PGPORT = 5432;
 $db_handle = pg_connect("dbname=$PGDATABASE user=$PGUSER password=$PGPASSWORD");
 if ($db_handle) {
 echo 'Connection attempt succeeded.';
 } else {
 echo 'Connection attempt failed.';
 }

$query = 'select * from fieldtally order by pipeno asc '; 
$result = pg_query($db_handle,$query); 
while ($row = pg_fetch_row($result))
{
    // Creates Arrays to use in dropdowns
    $pipeno_array[] = $row[0];
    $wallthickness_array[] = $row[1];
} 

 // This function creates dropdowns that can be used in your forms
function dropdown($field_name, $num){
    // Creates the Dropdown
    echo "<select name=\"".$field_name."\" id=\"".$field_name.$num."\"\n";
    echo "<option value=\"\"> --- Select --- </option>\n";
    // Chooses which array to use for Dropdown options
    global $pipeno_array, $wallthickness_array;
    $name_array = ($field_name == 'pipeno') ? $pipeno_array : $wallthickness_array;
    // Creates the Dropdown options based off the array above
    foreach($name_array as $k){
        echo "<option value=\"$k\">$k</option>\n"; }
    // Ends the Dropdown
    echo "</select>\n";
}
?>

<html>
<head><title>UG Pipeline Fiedl Data Capture</title>
</head>
<body>
<p></p>
<form action="<?php echo $PHP_SELF; ?>" method="post">
<table width="600" cellpadding= "10" cellspacing="1" border="2">
<tr align="center" valign="top">
<td align="center" colspan="1" rowspan="1" bgcolor="#64b1ff">
<h3>Input Field Tally Information</h3>
Select Pipe No:<?php dropdown('pipeno', 1); ?>  Select Wall Thickness:<?php dropdown('wallthickness', 1); ?><br /><br />
Input Joint No: <input type="text" name="jointno"> Input measured Length: <input type="text" name="measuredlength"><br><br>
Input Serial No: <input type="text" name="serialno"><br><br> 
<input type="Submit" name="submit" value="Submit">
</td></tr></table></form> 

<p>
<form action="fieldbend.php" method="post">
<table width="600" cellpadding="10" cellspacing="1" border="2">
<tr align="center" valign="top">
<td align="center" colspan="1" rowspan="1" bgcolor="#ff9d9d">
<h3>Input Field Bend Information</h3>
Select Pipe No:<?php dropdown('pipeno', 2); ?>  Select Wall Thickness:<?php dropdown('wallthickness', 2); ?><br /><br />
Input Measured Distance: <input type="text" name="measureddistance">  Input Bend Angle: <input type="text" name="benddegree"><br><br>
Input Bend Type: <input type="text" name="bendtype"><br><br>
<input type="Submit" name="submit" value="Submit">
</td></tr></table>
</form></P>

<p>
<form action="apptally.php" method="post">
<table width="600" cellpadding="10" cellspacing="0" border="2">
<tr align="center" valign="top">
<td align="center" colspan="1" rowspan="1" bgcolor="#66CC66">
<h3>Input App. Tally Information</h3>
 Input Type: <input type="text" name="type">   Input Serial No: <input type="text" name="serialno"><br><br>
Input Reference ID: <input type="text" name="referenceid"><br><br>
<input type="Submit" name="submit" value="Submit">
</td></tr></table>
</form></P>

</body>
</html> 
```

Here is my sample `fieldtally` table -

![<code>fieldtally</code> table](../Images/24d4d5e8c322d856d931cee9b641e20f.png)

Here is what the forms look like - ![html forms](../Images/0a5cb1e25461aad51f9aa7b166cf8278.png)

note: I used select size="3" to show multiple lines for this image, but left it as standard 1 row in the code above.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:27:27.507

and its here:

```
Select Pipe No: <select name="education"> </select>  Select Wall Thickness: <input type="text" name="wallthickness"><br><br> 
```

You are openning the tag select and closing in the same line, and after you are putting the elements. To solve that, correct this lines:

Change:

```
Select Pipe No: <select name="education"> </select>  Select Wall Thickness: <input type="text" name="wallthickness"><br><br> 
```

to:

```
Select Wall Thickness: <input type="text" name="wallthickness"><br><br>
Select Pipe No: <select name="education"> 
```

and close select tag before close body like this:

```
</select>
</body> 
```

Here you are putting the elements in the tag select. Try that

# php - 一致性组合框

> ID：12847566
> 
> 赞同：0
> 
> 时间：2012-10-11T20:02:10.613
> 
> 标签：php, javascript, html

我的程序中有三个组合框...

看起来像这样 -->

盒子1

```
number
letter 
```

盒子2

```
1 -
2 -
3 -
4 -
5 - 
```

盒子3

```
1 -
2 -
3 -
4 -
5 - 
```

我怎样才能在这个解决方案中工作？

例如...在box1中我选择了“数字”然后在box2和box3中加载相同的值但在box2中当我被选中时

'1' ..... 然后我打开 box3 我不会看到我在 box2 上选择了 '1'。

请问有解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:11:23.717

你可以用 jQuery 很容易地做到这一点。当用户在“驱动程序”中选择一个选项`<select>`并将其他两个设置`<select>`为具有相同值的选项时，以下代码将进行监听。

```
<select name="driver">
    <option value="opt1"></option>
    <option value="opt2"></option>
</select>

<select name="slave1">
    <option value="opt1"></option>
    <option value="opt2"></option>
    <option value="opt3"></option>
    <option value="opt4"></option>
</select>

<select name="slave2">
    <option value="opt1"></option>
    <option value="opt2"></option>
    <option value="opt3"></option>
    <option value="opt4"></option>
</select>

<script>
$(function() {
    $('select[name="driver"]').on('change', function(e) {
        var value = $(e.target).val();

        $('select[name="slave1"], select[name="slave2"]').val(value);
    });
});
</script> 
```

# c# - 分配给列表项时具有值的参数变为空

> ID：12847567
> 
> 赞同：0
> 
> 时间：2012-10-11T20:02:11.427
> 
> 标签：c#, asp.net-mvc

我有一个传入参数的方法，所有参数都保存一个值，但是当我将它们分配给我的 viewModel 时，其中一个变为空，不知道为什么：

```
[HttpPost]
    [ValidateInput(false)]
    public ActionResult Create(VisitViewModel viewModel, Guid[] associatedCasesSelected, Guid[] selectedParties)
    {
        if (!ModelState.IsValid)
        {
            viewModel.Time = _timeEntryHelper.Value;
            AddLookupsToViewModel(viewModel);
            return View(viewModel);
        }
        var visitEntry = Mapper.Map<VisitViewModel, VisitEntry>(viewModel);
        visitEntry.VisitDate = _timeEntryHelper.AddTimeToDate(visitEntry.VisitDate);
        visitEntry.UserId = _currentUser.UserId;
        visitEntry.OfficeId = _currentUser.OfficeId;
        viewModel.AssociatedCasesSelected = associatedCasesSelected;
        viewModel.PartiesSelected = selectedParties;
        try
        {
            _visitEntryService.Create(visitEntry, associatedCasesSelected, selectedParties);
            this.FlashInfo(string.Format(Message.ConfirmationMessageCreate, Resources.Entities.Visit.EntityName));
        }
        catch (RulesException ex)
        {
            ex.CopyTo(ModelState);
        }
        if (ModelState.IsValid)
            return RedirectToAction("Edit", "Case", new { caseId = viewModel.CaseId });
        AddLookupsToViewModel(viewModel);
        return View(viewModel);
    } 
```

这是行：

```
viewModel.PartiesSelected = selectedParties; 
```

selectedParties 应该保持一个值，但是当我将其分配给partySelected 时-它在调试时显示了PartiesSelected = null;

这是在我的 viewModel 中选择的party：

```
public IList<Guid> PartiesSelected { get; set; } 
```

# weblogic - WebLogic Portal VCR IllegalMonitorStateException 连接到 JSR-170 存储库

> ID：12847573
> 
> 赞同：1
> 
> 时间：2012-10-11T20:02:27.377
> 
> 标签：weblogic, portal, jackrabbit

我们最近从 WebLogic Portal 9.2.3 升级到了 10.3.5。我们有一个通过 Day Software JSR-170 VCR-JCR 提供程序连接的 JackRabbit 存储库。这在 9.2.3 上一切正常，但在 10.3.5 上，当我们尝试检索内容时，我们得到了 IllegalMonitorStateException。我们在 JackRabbit 之上有自己的外观，它实现了 JCR-170。这是从服务器调试出来的：

```
[com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.initializeSessionState():1215] com.bea.content.federated.internal.delegate.RepositoryManagerDelegate@2b70161: (re)initializing all repo sessions for username: <WLS Kernel>
[com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.initializeSessionState():1215] com.bea.content.federated.internal.delegate.RepositoryManagerDelegate@2bf2311: (re)initializing all repo sessions for username: <WLS Kernel>
[com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.initializeSessionState():1215] com.bea.content.federated.internal.delegate.RepositoryManagerDelegate@2fa5952: (re)initializing all repo sessions for username: <anonymous>
[com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.ensureConnectedToRepository():801] com.bea.content.federated.internal.delegate.RepositoryManagerDelegate@2fa5952: no session found for repoName=indhold; need to connect
[com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.ensureConnectedToRepository():821] com.bea.content.federated.internal.delegate.RepositoryManagerDelegate@2fa5952: connect write lock acquired for repoName=indhold
[com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.connectToRepository():875] com.bea.content.federated.internal.delegate.RepositoryManagerDelegate@2fa5952: connecting to repositoryName= indhold
[com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.getRepositoryClass():1503] invoking Class.forName(repoClassName)
[com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.getRepository():1403] com.bea.content.federated.internal.delegate.RepositoryManagerDelegate@2fa5952: Ticket authentication error for: indhold java.lang.IllegalMonitorStateException
at java.util.concurrent.locks.ReentrantReadWriteLock$Sync.tryReleaseShared(ReentrantReadWriteLock.java:363)
at java.util.concurrent.locks.AbstractQueuedSynchronizer.releaseShared(AbstractQueuedSynchronizer.java:1317)
at java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.unlock(ReentrantReadWriteLock.java:745)
at com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.getRepositoryClass(RepositoryManagerDelegate.java:1537)
at com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.getRepository(RepositoryManagerDelegate.java:1327)
at com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.connectToRepository(RepositoryManagerDelegate.java:893)
at com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.ensureConnectedToRepository(RepositoryManagerDelegate.java:832)
at com.bea.content.federated.internal.delegate.RepositoryManagerDelegate.connect(RepositoryManagerDelegate.java:1160)
at com.bea.content.federated.internal.delegate.RepositoryHelper.checkCapability(RepositoryHelper.java:759)
at com.bea.content.federated.internal.CapabilityManagerImpl.checkRepositoryCapability(CapabilityManagerImpl.java:57)
at com.bea.content.federated.internal.ManagerImplCapabilityHelper.checkCapability(ManagerImplCapabilityHelper.java:80)
at com.bea.content.federated.internal.ManagerImplCapabilityHelper.verifyCapability(ManagerImplCapabilityHelper.java:54)
at com.bea.content.federated.internal.NodeManagerImpl.getNode(NodeManagerImpl.java:432)
at dk.skat.portal.front.helper.ContentHelper.getNode(ContentHelper.java:1591) 
```

似乎 authenticationn 失败了，但是如果我尝试在存储库中的登录方法中设置断点（我们的 Facade，它不做任何身份验证挑战，只是包装 JackRabbit，并登录同一个用户 - “默认“ - 对于所有访问），我们永远不会被调用。在 Manage Repositories 页面上设置用户名和密码，似乎没有任何效果。另一方面，如果我转到门户管理控制台，并尝试管理或浏览存储库，一切正常，并且实际调用了登录方法，并且服务器可以很好地连接到存储库。这似乎很奇怪。在某些情况下（碰巧随机发生，我们可以让服务器突然访问存储库，但在服务器重新启动时，它又回到失败状态）。

我尝试将存储库的用户名/密码设置为 weblogic 用户，但这似乎没有任何效果，我仍然收到错误消息。此外，当我进入 PAC 并注销、关闭浏览器、重新打开浏览器或完全不同的浏览器时，进入 PAC 似乎会激活存储库以使其在线（尽管这不是稳定的或不希望的）。

请建议，如果 WebLogic 中存在错误（似乎它试图解锁（） ReadLock 太多次，导致提到的异常 - 它是否应该在该异常上失败？？，是否应该在之前检查锁定计数解锁？），或者如果 w 做错了什么？我可以读到 10.3.5 的 eclipse 工具中有一个已知的错误，正是这个错误。

此外，我们在 9.2.3 中似乎没有遇到任何问题，那么 10.3.5 中发生了什么变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-03T16:08:55.140

有同样的问题，在这里找到解决方案[https://forums.oracle.com/forums/thread.jspa?messageID=10984645](https://forums.oracle.com/forums/thread.jspa?messageID=10984645)

简而言之，这是一个产品错误，请向 Oracle 请求以下补丁：

```
WLP Version: 10.3.5
Patch Name/Patch Number/Bug Number: 14377862
Smart Update Patch ID: HPV8 
```

# drupal - 实体引用和视图：如何实现“引用实体”关系

> ID：12847574
> 
> 赞同：0
> 
> 时间：2012-10-11T20:02:29.643
> 
> 标签：drupal, drupal-7, drupal-views

我有一个**主要的内容类型：“比赛”**，以及**一些免费的内容类型，例如“新闻”**、“评委”、“参与者”。

一条新闻可能与一个或多个锦标赛有关，也可能与任何锦标赛无关。

```
Node type: News
Has field: Relevant Tournament(s)
                ↓
Node type: Tournament 
```

创建新闻时应设置锦标赛和新闻之间的关系：您编写新闻标题，新闻内容并勾选相关锦标赛。**所以它是具有实体引用字段的免费节点类型**。

**在每个锦标赛的页面上应该有一个显示与所显示锦标赛相关的新闻的块。**

我尝试了什么：

*   创建了一个块视图并将其放入锦标赛页面。
*   添加了一个上下文过滤器，用于从 URL 中检索锦标赛的 Nid。
*   添加了 EntityReference 关系（“引用”或“引用”）。
*   将格式样式设置为无格式 + 渲染实体。
*   将任一关系附加到呈现的实体格式样式。
*   还尝试将关系附加到上下文过滤器。

但我未能达到预期的结果。

我找到了可能与我的问题相关的[指南。](http://drupal.org/node/1465920)但我无法理解它，因为它涉及 PHP-hacking 并且是非常特定于 Commerce 的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T09:39:11.893

好的，我明白了。

当我使用“渲染实体”格式样式时它不起作用。

当我更改为“内容”格式样式时，它开始工作。

可以在此处找到反向视图实体参考的完整配方：http: [//drupal.org/node/1724396#comment-6406274](http://drupal.org/node/1724396#comment-6406274)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-13T23:35:27.823

您还可以查看[http://drupal.org/project/content_dependency](http://drupal.org/project/content_dependency) 它提供了不同实体类型的自动反向引用预览。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T07:55:38.197

也许是一个明显的问题/答案：

您是否在视图字段中添加了“内容：渲染节点”字段？您可以在此字段中引用您的实体引用关系（“引用”或“引用”）。这可能会成功。否则，祝你好运！

# javascript - 根据元素的属性过滤 dom 树的最有效方法是什么？

> ID：12847576
> 
> 赞同：1
> 
> 时间：2012-10-11T20:02:30.477
> 
> 标签：javascript, jquery, html, dom

我一直在玩几个选项，包括 jQuery 过滤器和我自己的递归下降函数，到目前为止，我对我的结果并不满意。

我将深入研究，看看我可以如何高效地编写我的代码；不过，我敢打赌，其他人已经做到了这一点，并且做得很好。

那么，对我来说搜索 dom 树最有效的方法是什么？比如说，我想找到所有具有匹配 ( `/.*google.*/`)的 src 属性的元素

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T20:05:15.640

像这样的东西。

```
$("[src*='/google/']", "#rootnode") 
```

或者

```
$("#rootnode [src*='/google/']") 
```

查看这个测试用例（根据统计数据，第一个选择器的速度是第二个选择器的 14 倍，使用完全相同的选择器）
[http://jsperf.com/test-selectorfidd123](http://jsperf.com/test-selectorfidd123)

想知道为什么？如果你使用第二个选择器，jQuery 必须循环遍历它可以找到的每个元素。如果您使用第一个，jQuery 将寻找`root`它将使用层次结构的最高节点的节点。并且不会遍历所有其他`DIVS`cus 这不是必需的。

几个月前，我又做了一些测试。如果您使用能够在 CSS 中运行的选择器。jQuery 能够`querySelector`从本机库中使用。但是如果你使用像`:selected`or这样的特殊选择器，`:nth-child`那么 jQuery 必须使用 Javascript 来循环遍历这些元素。在这种情况下，最好执行以下操作：（其中 jQuery 将`querySelector`用于第一部分，JS 用于`.find`

```
$("#native").find(":selected"); is faster than $("#native :selected"); 
```

信息：
[属性包含选择器](http://api.jquery.com/attribute-contains-selector/)
[Selector API](http://api.jquery.com/category/selectors/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:07:41.207

我认为今天超过 90% 的浏览器都支持原`document.querySelectorAll(..)`生`document.querySelector(..)`代码。您应该能够使用：

```
document.querySelectorAll('[src*="/google/"]'); 
```

这应该比从 JavaScript 代码本身编写的任何东西都要快。如果它也可用，jQuery 应该使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:18:46.030

取决于你所说的高效。如果您的意思是“优雅”，如易于阅读，那么 Niels 是对的。如果您的意思是在速度方面高效，那么您使用 jQuery 是错误的。

是的，提到的其他方法也可以，但它们可能是更好的方法。也许您的页面上只有十几个元素，这很好。但是当有 100 或 1,000 人时，你会怎么做？搜索所有这些元素非常昂贵。

这是你应该问的问题：

这些元素是如何创建的？在创建它们时，我如何标记我以后需要的那些。

# winforms - 当 windows 设置为 120 dpi 时，为什么表单标题文本没有出现在 FixedToolWindow 中

> ID：12847593
> 
> 赞同：0
> 
> 时间：2012-10-11T20:03:40.237
> 
> 标签：winforms, dpi

在 Windows 7 的显示屏幕中，我将计算机设置为 125% 文本大小 (120dpi)。但是我所有的 FormBorderStyle.FixedToolWindow 样式的表单在它们的标题栏（表单的 this.Text 属性）中都没有标题文本，而它们通常以 96dpi 显示。

我正在使用 AutoScaleMode.Font。

如果我将表单样式设置为 FormBorderStyle.FixedSingle，则应该存在的文本会返回。

有人知道解决方法吗？我依附于 FixedToolWindow 的窗口样式，我想让它们看起来像那样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-18T18:19:03.987

看起来像是 .Net Framework 4.5 中修复的错误。

这个错误[也可以在 WPF](https://stackoverflow.com/questions/4922891/title-is-missing-on-a-wpfs-tool-window-when-dpi-setting-125-150)中使用

```
<Window ... ResizeMode="NoResize" WindowStyle="ToolWindow" ... > 
```

另一个有趣的事情是，如果您通过 Visual Studio（F5 热键）运行程序，您可能不会注意到这个错误。直接运行您的可执行文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:14:12.963

FormBorderStyle.SizeableToolWindow 看起来几乎相同并且有文本。除了现在我必须找出如何禁用调整大小。

# c# - 如何在 C# 中实现外观模式并物理隐藏子系统

> ID：12847596
> 
> 赞同：3
> 
> 时间：2012-10-11T20:03:45.827
> 
> 标签：c#, .net, visual-studio-2010, design-patterns, facade

在 Java 中实现外观模式时，我可以通过使用 package-private 修饰符轻松隐藏外观的子系统。结果，只有一个小接口可以从外观/包外部访问，子系统的其他类不可见。

如您所知，C# 中没有 package-private 修饰符，但有一个类似的修饰符，称为 internal。根据文档，***定义为 internal 的类只能在同一个 assembly 中访问***。

据我了解，我必须创建至少两个程序集（实际上是两个 .exe/.dll 文件）才能在物理上隐藏外观的子系统。在物理上，我的意思是类 a) 不能从外部实例化，并且 b) 不会由外观外的智能感知显示。

1.  我真的必须将我的小项目拆分为一个 .exe 和一个 .dll（用于外观），以便 internal 关键字起作用吗？我的门面子系统只包含 2 个类，一个自己的 .dll 似乎是矫枉过正。
2.  如果是，Visual Studio 中将我的外观外包给它自己的程序集的最佳实践方式是什么？

不要误会我的意思，我没有真正需要将我的程序分成几个程序集。我只想从 IntelliSense 隐藏我的外观后面的一些类，并防止从外部实例化。但如果我没记错的话，没有比这更简单的方法了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:21:07.447

使用单独的项目是一般首选方法。事实上，您经常在实现和 UI 程序集都引用的第三个程序集中具有接口或外观。

也就是说，您可以使用嵌套的私有子类在单个程序集中完成此操作。

```
public interface IMyService {}

public static class MyServiceBuilder
{
    public static IMyService GetMyService()
    {
        //Most likely your real implementation has the service stored somewhere
        return new MyService();
    }

    private sealed class MyService : IMyService
    {
        //...
    }
} 
```

外部类有效地成为隐私范围的“包”。您可能不想为大型“包裹”执行此操作；在这些情况下，将代码移动到单独的程序集并使用 internal 会更干净。

请注意，如果您对多个程序集的主要反对是部署，您实际上可以[合并多个程序集](http://www.codeproject.com/Articles/9364/Merging-NET-assemblies-using-ILMerge)以创建更简单的可执行文件或库部署。通过这种方式，您可以保留多个项目/程序集的绝缘优势，而不必为可能独立分发或版本控制的多个文件而烦恼。

# php - 创建可以运行php的Web服务器

> ID：12847599
> 
> 赞同：0
> 
> 时间：2012-10-11T20:03:49.303
> 
> 标签：php, webserver

我用 Java 创建了一个基本的 Web 服务器。它还可以运行php代码。

我执行：

```
php - f <file> 
```

获取结果并将其发送回客户端。它很好用，但是当我想使用 phpinfo(); 函数，它也返回[手册](http://php.net/manual/en/function.phpinfo.php)中所写的纯文本。如何像 Apache 一样获得 HTML 格式的结果？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T20:07:18.977

恐怕这是在 PHP 的二进制文件中硬编码的。它检测它是否正在运行 Apache 模块或 CLI 二进制文件。由于您没有调用 Apache 模块，因此它使用 CLI 模块。从手册页：

> **phpinfo()**在使用 CLI 模式时输出纯文本而不是 HTML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T22:15:12.057

您可能想尝试通过 php-cgi 界面运行该文件（应该是一个名为 php-cgi 或类似名称的可执行文件）。这是您可以在 apache 下运行 php 的一种方式。（其他选择是 mod php 或fcgi)

Raidence，你为什么要创建一个依赖于 apache 的 http 服务器，你没有得到冗余？

# c - 如何将文本文件逐位拆分为两个文件

> ID：12847600
> 
> 赞同：0
> 
> 时间：2012-10-11T20:03:53.707
> 
> 标签：c, file

如何将一个文本文件一点一点地拆分成另外两个文件。我需要文件 A 中的所有偶数位和 B 中的所有奇数位。换句话说，如果文件 X 是：

0101010111110000

那么文件 A 将是：00001100 和 B 将是：11111100

然后我需要将它们保存为 .txt 文件。之后，我需要将它们重新合并在一起以再次获得 X。

我正在使用 c。我到目前为止的代码如下：

```
#include <stdio.h>

void printchar( unsigned char to_print )
{
    unsigned char mask = 0x80;
    for( int i = 0; i < 8; ++i )
    {
       if( (mask & to_print) > 0 )
       {
           printf( "%d", 1 );
       }
       else
       {
           printf( "%d", 0 );
       }
        mask = mask >> 1;
    }
    printf( "\n" );
}

void split( unsigned char * left, unsigned char * right, unsigned char input1, unsigned char input2 )
{
    unsigned char mask = 0x80;
    for( int i = 0; i < 4; ++i )
    {
        (*left) |= ( (input1 & mask) << i );
        (*left) |= ( (input2 & mask) >> (4-i) );

        mask = mask >> 1;

        (*right) |= ( (input1 & mask) << (i+1) );
        (*right) |= ( (input2 & mask) >> (3-i) );

        mask = mask >> 1;

    }
}

int main (int argc, const char * argv[])
{
    unsigned char left = 0;
    unsigned char right = 0;
    unsigned char input1 = 0xA6;
    unsigned char input2 = 0xB5;

    split( &left, &right, input1, input2 );
    printchar( left );
    printchar( right );
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:18:03.927

逐字符读取

在您的代码中构建两个缓冲区字符，一个带有偶数位，另一个带有奇数位以完全构建 2 个字符当您从输入文件中读取 4 个字符时，您需要从文件中读取 2 个字符您可以写入您已构建的 2 个字符等等

部分采用相同的方法，但相反。您应该注意读取/写入偶数/奇数位的顺序

# entity-framework - .NET 4.5 中的“无法将 lambda 表达式转换为类型‘字符串’，因为它不是委托类型”

> ID：12847609
> 
> 赞同：1
> 
> 时间：2012-10-11T20:04:19.103
> 
> 标签：entity-framework

我正在测试机器上尝试 VS2012 中现有的 .NET 4.0 解决方案（仅安装了 VS2012 和 SQL Server 2008），当我尝试将 lambda 语法与 Include 扩展方法一起使用时出现上述错误。

现有版本的解决方案有一个EntityFramework.dll的引用，这是我使用Include方法必须添加的，但是我在VS2012中看的升级版没有这个引用，也找不到该名称的 DLL 在另一台机器上的位置。System.Data.Entity 的 using 语句显示为灰色，因为 ReSharper 认为不需要它。不知道为什么。

示例代码：这是现有解决方案中的内容......

```
using (var context = new RSSFeedsEntities()) {  
  WebSite someSite = context.WebSites.Include(w => w.Feeds).FirstOrDefault(w => w.WebSiteID == 1);  
} 
```

知道如何解决这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T22:18:12.350

啊哈！找到了答案。

微软以他们的智慧做出了（在我看来）愚蠢的决定，不像开发机架的其他部分一样安装 Entity Framework，而是将最新版本仅作为 NuGet 包提供。他们到底为什么这样做超出了我的理解，因为我现在必须为每个解决方案单独安装 EF，而不是安装它并立即使用它。

无论如何，我使用 NuGet 包管理器安装 EF 5.0，错误就消失了。

希望这可以帮助某人。

# c - 需要在 C 中使用 mod 输出分钟数的帮助？

> ID：12847611
> 
> 赞同：-1
> 
> 时间：2012-10-11T20:04:34.717
> 
> 标签：c, time, floating-point, codeblocks, modulus

> **可能重复：**
> [为什么十进制数不能用二进制精确表示？](https://stackoverflow.com/questions/1089018/why-cant-decimal-numbers-be-represented-exactly-in-binary)

```
#include <stdio.h>

int main(void)
{
    int temperature, time;
    float minutes;

    printf("What is the Fahrenheit temperature?\n");
    scanf("%d",&temperature);

    time = (5 - (temperature - 90) / 5);
    minutes = ((5 % time) * 60);

    if (temperature >= 90)
        printf("It will rain at approximately %d hours and %f minutes after noon.\n", time, minutes);

    else
        printf("It will not rain today.\n");

    system("PAUSE");
    return 0;

} 
```

我正在使用 C 编程语言。这是作业，但只要不是整个代码，就可以使用网络上的一些位。无论如何，如果当前温度是 93f `time = 4.4`所以我想输出：

`It will rain approximately 4 hours and 24 minutes after noon`但输出是：

`It will rain at approximately 5 hours and 0.000000 minutes after noon`

编辑：我现在收到一个错误，指出二进制 % 的操作数无效（有 int 和 float）请耐心等待我正在尝试学习的 LOL。

```
#include <stdio.h>

int main(void)
    {
    int current_temp;
    float remaining_minutes, time;

    printf("What is the temperature in Fahrenheit?\n");
    scanf("%d",&current_temp);

    time = (5 - (current_temp - 90) / 5);
    ERROR**** remaining_minutes = ((5 % time) * 60);

    if (current_temp >= 90)
        printf("It will rain at approximately %d hours and %f minutes after noon.\n", time);

    else
        printf("It will not rain today.\n");

    system("PAUSE");
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:07:04.283

您还需要定义您的时间`float`。现在，您正在将整数除以整数，因此您只能得到整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:08:10.130

分钟=（时间％1）* 60怎么样？

编辑：或 mins = (time*10 % 10) * 6\. 在我的手机上，所以无法真正测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:08:19.870

`time`是一个`int`。你不能指望它保存一个浮点数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T20:10:22.747

时间 = (5 - (温度 - 90) / 5);

time,5,90 是整数，所以 time = 5 - 0 ...wich 是 5

尝试使用浮动时间和

```
time = (5.0 - (float)(temperature - 90) / 5); 
```

# nhibernate - Nhibernate Throws Found 对集合的共享引用

> ID：12847615
> 
> 赞同：9
> 
> 时间：2012-10-11T20:04:38.787
> 
> 标签：nhibernate, fluent-nhibernate

我已经阅读了许多与此类似的其他问题 - 但是对于 Nhibernate 来说是新手，它们似乎都没有回答我的问题，即 Inhibernate 为什么会向以下代码：

```
 VendorOrderNotificationAcknowledgement ICheckoutVendorService.SendOrderNotification(VendorOrderNotification request)
{
        OrderRepository repo = new OrderRepository();
        var order =(AbstractOrder) repo.FindByCartId(request.OrderNotification.CartOrderId);

        ShippingAddress billingAddress = order.ShippingAddresses[0];
        var itemsFromDb = billingAddress.Items;
        order.ClearAllShippingAddresses();
        wcfFactory.UpdateOrder(order); //NO ERROR THROWN HERE!
        ShippingAddress shippingAddress = orderHelper.CreateShippingAddress(request.ShippingDetails);
        shippingAddress.Items = itemsFromDb;
        order.AddShippingAddress(shippingAddress);

        order.SourceCode = _sourceCode;
        order.TaxAmount = 0;
        order.GiftCertificateAmount = 0;
        order.Status = StatusCode.Approved;
        order.CreatedAt = request.OrderNotification.OrderTime.Year >2010
            ? request.OrderNotification.OrderTime
            : DateTime.Now;
        order.PurchasedDate= 
                                  request.OrderNotification.OrderTime.Year>2010
            ? request.OrderNotification.OrderTime
            : DateTime.Now;
        order.UpdatedAt = DateTime.Now;

        if (request.OrderNotification.OrderCharges != null)
        {
            order.ShippingAmount = request.OrderNotification.OrderCharges.Shipping;
            order.TaxAmount = request.OrderNotification.OrderCharges.DutyAndTaxes;
        }
        else
        {
            order.ShippingAmount = 0;
            order.TaxAmount = 0;
        }
        order.UseGiftWrap = false;
        order.SourceCode = _sourceCode;
        UpdateEshopWorldOrder(order); // THROWS FOUND SHARED REFERENCES TO A COLLECTION: ORDER.SHIPPINGADDRESS.ITEMS

        var orderDto = orderHelper.CreateOrderDto(billingAddress, orderHelper, order);
        var dtoShippingAddresses = orderHelper.CreateDtoShippingAddresses(order);
        orderDto.ShippingAddresses = dtoShippingAddresses;

        ShippingMethodDto shippingMethodDto = 0;

        var mine = wcfFactory.SendOrder(orderDto);

        //More Code below here ...

}

public OrderDto CreateOrderDto(ShippingAddress billingAddress, OrderHelper orderHelper, AbstractOrder order)
{
    OrderDto orderDto = new OrderDto();
    orderDto.AlternateOrderId = order.Id.ToString();
    orderDto.ConfirmationNumber = order.ConfirmationNumber;
    orderDto.Coupons = new string[0];
    orderDto.DiscountAmount = order.DiscountAmount;
    orderDto.GiftCardAmount = order.GiftCertificateAmount;
    orderDto.PurchaseDate = order.PurchasedDate;
    orderDto.ShippingAmount = order.ShippingAmount;
    orderDto.SourceCode = order.SourceCode;
    orderDto.TaxAmount = order.TaxAmount;
    orderDto.UseGiftWrap = order.UseGiftWrap;
    var customerDto = orderHelper.CreateCustomerDto(billingAddress);
    orderDto.SoldTo = customerDto;
    return orderDto;
}

public void UpdateEshopWorldOrder(AbstractOrder order)
{
    try
    {
        //Session.Update(order);
       // transaction.Commit();
          Session.Flush();
    }
    catch (Exception ex)
    {
       _logger.Debug("order saved failed with an error of " + ex.Message);
       _logger.Error(ex);
       throw;
         }
} 
```

任何见解表示赞赏.... thnx

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-11T21:57:52.093

我认为问题在于，您的`itemsFromDB`集合对象`shippingAddress`被`billingAddress`.

两个实体都需要自己的集合对象。然而，这两个集合都可能包含对相同地址对象的引用。

所以我假设用`shippingAddress.Items = itemsFromDb;`类似的东西代替

`shippingAddress.Items.AddRange(itemsFromDb)`

或者

`shippingAddress.Items = new List<ShippingAddress>(itemsFromDb)`应该做的伎俩

# ruby-on-rails - 不指定 ID 的资源路径

> ID：12847620
> 
> 赞同：3
> 
> 时间：2012-10-11T20:05:07.277
> 
> 标签：ruby-on-rails, ruby, routes

如果我的路径位于特定资源上，我想呈现部分内容，但我不想指示资源的 ID。

`<head>`如果路径在任何视频资源上，我想加载在我的标签之间部分保存的元数据标签：

```
<head>
  <%= render 'layouts/partial_name' if request.fullpath == video_path(params[:id]) %>
</head> 
```

但是，这仅在我请求视频资源时才有效，例如`'/videos/92'`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:09:38.040

你可以试试`request.full_path.starts_with? videos_path`，或者`request.full_path =~ /^\/video/`。

但是，有一个更好的方法可以做到这一点。在您的布局中：

```
<head>
  <!-- ... -->
  <%= yield :head %>
</head> 
```

在要添加元标记的视图中：

```
<% content_for :head do %>
<%= render :partial => 'meta_tags' %>
<% end %>
<!-- ... --> 
```

此用法是该方法的[典型示例](http://guides.rubyonrails.org/layouts_and_rendering.html#using-the-content_for-method)`content_for`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:12:11.250

我相信这就是你要找的...

```
<%= render 'layouts/partial_name' if params[:controller] == "videos"  && params[:action] == "show" %> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-11T20:10:33.357

理想情况下，您需要为负责视频资源的控制器自定义布局。可以在此 railscast [http://railscasts.com/episodes/7-all-about-layouts](http://railscasts.com/episodes/7-all-about-layouts)了解有关布局的更多信息。

对于快速而肮脏（非常非常肮脏）的解决方案，您可以检查 request.fullpath 是否包含“videos”字符串。例如。

```
<%= render 'layouts/partial_name' if request.fullpath =~ /videos/ %> 
```

# symfony - 从哪里运行`$ php vendor install`？

> ID：12847621
> 
> 赞同：1
> 
> 时间：2012-10-11T20:05:08.953
> 
> 标签：symfony

我是 Symfony 的新手，需要运行许多命令行，但我不知道在哪里运行这些命令。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T20:11:44.610

在安装 Symfony 的目录中。应该有一些子目录：`app`, `src`, `bin`, `vendors`... 你应该运行的命令是`php bin/vendors install`.

请注意，此命令适用于 Symfony 2.0.x。如果你安装了最新的 symfony 版本（2.1.x）你不应该使用这个命令而使用 Composer。

# wcf - 添加客户端端点后 WCF 地址已在使用中

> ID：12847622
> 
> 赞同：2
> 
> 时间：2012-10-11T20:05:10.410
> 
> 标签：wcf, exception, configuration, wcf-binding

我有一个自托管并通过另一个服务启动的 WCF 服务。在 Visual Studio 中调试，它们工作得很好，直到我`app.config`为服务客户端添加端点配置。此服务的一些客户端将是本地的，而其他客户端将是远程的。我尝试只为命名管道设置客户端端点，如果有一个客户端端点指向该服务，以及一个使用该端点的客户端（即使它甚至不应该在服务尝试启动时被实例化）我得到一个异常告诉我 0.0.0.0:8524 正在使用中。下面是相关配置：

```
<service name="EventService.EventPublishingService">
        <clear />
        <endpoint binding="netTcpBinding" address="net.tcp://localhost:8524/EventPublishingService" contract="EventService.Contracts.IEventPublishService">
        </endpoint>
        <endpoint address="net.tcp://localhost:8524/EventPublishingService/mex" binding="mexTcpBinding" contract="IMetadataExchange">
        </endpoint>
        <endpoint address="net.pipe://localhost/EventPublishingServicePipe"
           binding="netNamedPipeBinding" contract="EventService.Contracts.IEventPublishService"
           listenUriMode="Explicit">
        </endpoint>
        <host>
        </host>
     </service> 
```

对于客户端端点，我都尝试过

```
<endpoint address="net.tcp://localhost:8524/EventPublishingService"
            binding="netTcpBinding" bindingConfiguration="NetTcpBinding_IEventPublishService"
            contract="AGX.Atlas.EventService.Contracts.IEventPublishService" name="NetTcpBinding_IEventPublishService">
         </endpoint> 
```

和

```
<endpoint address="net.pipe://localhost/EventPublishingServicePipe"
        binding="netNamedPipeBinding" bindingConfiguration="NetNamedPipeBinding_IEventPublishService"
        contract="AGX.Atlas.EventService.Contracts.IEventPublishService" name="NetNamedPipeBinding_IEventPublishService">
     </endpoint> 
```

在删除客户端绑定时，我已经从服务中删除了 net.pipe 绑定，以确保它没有做一些奇怪的事情。还是同样的问题。

这是绑定配置：

```
 <netNamedPipeBinding>
        <binding name="NetNamedPipeBinding_IEventPublishService" closeTimeout="00:01:00"
           openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
           transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
           hostNameComparisonMode="StrongWildcard" maxBufferPoolSize="524288"
           maxBufferSize="65536" maxConnections="10" maxReceivedMessageSize="65536">
           <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
              maxBytesPerRead="4096" maxNameTableCharCount="16384" />
           <security mode="Transport">
              <transport protectionLevel="EncryptAndSign" />
           </security>
        </binding>
     </netNamedPipeBinding>
     <netTcpBinding>
        <binding name="NetTcpBinding_IEventPublishService" closeTimeout="00:01:00"
           openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
           transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
           hostNameComparisonMode="StrongWildcard" listenBacklog="10"
           maxBufferPoolSize="524288" maxBufferSize="65536" maxConnections="10"
           maxReceivedMessageSize="65536">
           <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
              maxBytesPerRead="4096" maxNameTableCharCount="16384" />
           <reliableSession ordered="true" inactivityTimeout="00:10:00"
              enabled="false" />
           <security mode="Transport">
              <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
              <message clientCredentialType="Windows" />
           </security>
        </binding>
        <binding name="NetTcpBinding_IEventSubscriptionService" closeTimeout="00:01:00"
           openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
           transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
           hostNameComparisonMode="StrongWildcard" listenBacklog="10"
           maxBufferPoolSize="524288" maxBufferSize="65536" maxConnections="10"
           maxReceivedMessageSize="65536">
           <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
              maxBytesPerRead="4096" maxNameTableCharCount="16384" />
           <reliableSession ordered="true" inactivityTimeout="00:10:00"
              enabled="false" />
           <security mode="Transport">
              <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
              <message clientCredentialType="Windows" />
           </security>
        </binding>
     </netTcpBinding> 
```

# xml - 如何将 SQL Server 2008 XML 结果拆分为 SSIS 中的单个文件

> ID：12847625
> 
> 赞同：1
> 
> 时间：2012-10-11T20:05:23.690
> 
> 标签：xml, sql-server-2008, ssis

源查询在一个变量中返回我需要的 XML。在 SSIS 中，我如何获取 OLE 适配器返回的变量并将其拆分到每个顶级叶上的文件中。对于我的示例数据，我想为提交类型标签创建一个新文件，但文件名将是日期和患者 ID。所以每个病人都有一个新文件。

样本数据。

```
<submission type="HOSPITAL" data="CLINICAL" version="1.0" action-code="ADD">
    <provider>
        <provider-id>120129</provider-id>
        <patient>
            <birthdate>07-26-1925</birthdate>
            <sex>F</sex>
            <race>1</race>
            <ethnic>N</ethnic>
            <postal-code>32142</postal-code>
            <episode-of-care measure-set="PN">
                <admit-date>09-13-1987</admit-date>
                <discharge-date>09-14-1988</discharge-date>
                <pthic/>
                <patient-id>7228</patient-id>
                <detail answer-code="3" row-number="0" question-cd="ANOTHERINF"/>
                <detail answer-code="Y" row-number="0" question-cd="ANTIALLERGY"/>
            </episode-of-care>
        </patient>
    </provider>
</submission>
<submission type="HOSPITAL" data="CLINICAL" version="1.0" action-code="ADD">
    <provider>
        <provider-id>168729</provider-id>
        <patient>
            <birthdate>07-26-1835</birthdate>
            <sex>F</sex>
            <race>1</race>
            <ethnic>N</ethnic>
            <postal-code>39142</postal-code>
            <episode-of-care measure-set="PN">
                <admit-date>09-13-1986</admit-date>
                <discharge-date>09-14-1987</discharge-date>
                <pthic/>
                <patient-id>888</patient-id>
                <detail answer-code="3" row-number="0" question-cd="ANOTHERINF"/>
                <detail answer-code="Y" row-number="0" question-cd="ANTIALLERGY"/>
            </episode-of-care>
        </patient>
    </provider>
</submission> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T00:33:55.117

警告：这个答案在这一点上都是[理论上](http://www.bidn.com/blogs/MikeDavis/ssis/148/ssis-for-each-node-list-enumerator)的。今晚我会尝试自己做，因为我发现这个问题很有趣，而且我可以看到未来我们自己的项目可能需要做类似的事情。另外，我喜欢学习 SSIS 的新方法。

无论如何，这是我的理论。

Foreach 循环容器

*   将集合的枚举器更改为 Foreach NodeList 枚举器
*   将文档源更改为您的 XML（以变量的形式，或查询结果或其他形式）
*   将 OuterXPathString 更改为 //Submission
*   让循环通过数据流将 xml 的内部内容传递到平面文件目标
*   还需要`Sumission`沿途提取元素属性

就像我说的，这是理论上的——可能有一些我没有想到的问题，但我会在接下来的 24 小时左右返回一个工作原型（除非其他人提供更好的答案）。

# javascript - 为什么 jQuery dataTables 不能解析我的 JSON？

> ID：12847627
> 
> 赞同：5
> 
> 时间：2012-10-11T20:05:39.760
> 
> 标签：javascript, jquery, json, datatables

我正在尝试按如下方式填充[数据表：](http://datatables.net/index)

```
$("#my-datatable").dataTable( {
    "sAjaxSource" : "/someURLOnMyServer",
    "bDestroy" : true,
    "fnServerParams" : function(serverParams) {
        serverParams.push(
            {
                "name" : "widget",
                "value" : token
            }
        );
    }
}); 
```

以及它正在填充的 HTML 表：

```
<table id="my-datatable">
    <thead>
        <tr>
            <th>Type</th>
            <th>Value</th>
            <th>ID</th>
            <th>Fizz</th>
            <th>Buzz</th>
        </tr>
    </thead>
    <tbody></tbody>
</table> 
```

根据 Firebug，从服务器返回的 JSON 是：

```
[
   {
      "id":1,
      "attributeType":{
         "id":1,
         "name":"test1",
         "tag":"test-type",
         "is-dog":false
      },
      "attributeValue":{
         "id":null,
         "name":"blah",
         "tag":"BLAH"
      },
      "buzz":1,
      "fizz":"53abc"
   }
] 
```

但 Firebug 在其控制台中抛出以下 JavaScript 错误：

```
TypeError: aData is undefined
[Break On This Error]   

for ( i=0 ; i<aData.length ; i++ ) --> jquery.dataTables.js (line 2541) 
```

谁能发现出了什么问题？要么我没有`dataTable`正确设置我的对象，要么返回的 JSON 与它试图填充的 HTML 表的“模式”不匹配。不管怎样，我迷路了。提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T20:16:29.577

数据表需要特定格式的结果。如果您不使用该格式，则必须声明所有内容。

```
$('#my-datatable').dataTable( {

    "sAjaxSource": "/url/here",

    "fnServerData": function ( sSource, aoData, fnCallback ) {
            aoData.push( { "name": "widget", "value": "token" } );

            request = $.ajax({
              "dataType": 'json', 
              "type": "GET", 
              "url": sSource, 
              "data": aoData, 
              "success": fnCallback
            });
      },

      "aoColumns": [
            { "mDataProp": "id"},
            { "mDataProp": "fizz"},
            { "mDataProp": "name"},
            { "mDataProp": "tag"},
            { "mDataProp": "tag"},
            { "mDataProp": "attributeValue.name"},
            { "mDataProp": "attributeValue.tag"},
        ],

    }); 
```

这是格式：[http ://datatables.net/release-datatables/examples/server_side/post.html](http://datatables.net/release-datatables/examples/server_side/post.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:12:06.183

尝试将您的 JSON 对象包含在以下内容中`aaData`：

```
{"aaData" : 

[{"id":1,"attributeType":{"id":1,"name":"test1","tag":"test-type","is-dog":false},"attributeValue":{"id":null,"name":"blah","tag":"BLAH"},"buzz":1,"fizz":"53abc"}]

} 
```

# c# - Monotouch 中的 NSTimer

> ID：12847628
> 
> 赞同：1
> 
> 时间：2012-10-11T20:05:45.060
> 
> 标签：c#, xamarin.ios, nstimer

如何使用`NSTimer`Monotouch 中的从某个数字倒数到 0？

我一直在网上搜索这个，但我找不到任何示例或教程

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T12:44:30.103

```
NSTimer.CreateScheduledTimer(new TimeSpan(0, 0, 10),delegate 
{
    alert.DismissWithClickedButtonIndex (1,true);
}); 
```

在上面的代码中，NsTimer 将在 10 秒内关闭，因为我在警报中自动提到它会在 10 秒后单击确定按钮。试试这个，希望对你有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-12T18:30:30.083

如果 .NET 为您提供了可能更方便的一切，为什么还要使用本机 NSTimer？

*   System.Windows.Forms.Timer
*   System.Timers.Timer
*   System.Threading.Timer

有关何时使用哪一个的详细信息，请参见此处（例如）：http: [//msdn.microsoft.com/en-us/magazine/cc164015.aspx](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)

# scipy - 是否可以将 cython 函数作为参数传递给 scipy 函数？

> ID：12847632
> 
> 赞同：8
> 
> 时间：2012-10-11T20:06:03.160
> 
> 标签：scipy, cython

Scipy 有许多函数可以接受 python 可调用来执行某些操作。特别是，我正在使用一个数学优化函数`scipy.optimize.leastsq`，该函数接受 Python 可调用作为目标函数参数。`leastsq`在最小化过程中可以多次调用此目标函数。

我的分析表明，很多时间都花在了这个目标函数上。我已经使用 Cython 加速了该功能的某些部分。但是，该函数本身仍然是一个 Python 函数，并且重复调用它（就像`leastsq`这样）有一些开销。

`cdef`我认为如果该函数是 Cython 函数（使用而不是） ，我可以进一步提高速度`def`。所以我把我的电话`leastsq`放在 Cython 扩展里面，并把一个 Cython 目标函数传递给它。但是当我这样做时，我在**调用时****遇到编译错误：** `leastsq`

 **```
Cannot convert 'object (object, object, object)' to Python object 
```

**有没有办法将 Cython 函数作为参数传递给这些需要 python 可调用对象的 Scipy 函数？**

或者，就我而言，**有没有办法访问底层** `leastsq` **实现并将 Cython 目标函数传递给它？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T15:06:16.740

`cdef`目前无法传递函数。将回调函数传递给底层 Fortran 代码也是不可能的，因为它是用不知道 Cython 的 f2py 包装的。

你可以做的是：

*   把你的函数写成 Cython 的`def`函数。这些可以传递给所有 Scipy 的例程。这不会消除使用 Python 的回调机制带来的额外函数调用开销（这可能并不重要！），但是您**可以**加快函数的实现，这可能就足够了。`cdef`像往常一样编写 Cython 代码时，请记住出现的变量。

*   从 Scipy 或 netlib.org 复制 MINPACK 源代码，然后自己直接使用它们。这通过将 Python 函数回调机制替换为低级机制来消除剩余的函数调用开销。

（已经讨论过为此目的添加一个协议来传递低级函数指针，任何需要它的基于 Python 的系统都可以采用该协议，但是 AFAIK 的设计尚未完成，也未在Cython 和 Scipy。）**

# php - strip_tags 和 trim 无法正常工作

> ID：12847634
> 
> 赞同：0
> 
> 时间：2012-10-11T20:06:10.500
> 
> 标签：php

我正在制作一个模因生成器，Imagick 生成图像。我的问题是，即使我对用于图像的字符串进行了一些操作，输出也不正确。

举例：

```
$_POST['text_top'] = " test test<br>"; //(starts with a space) 
```

然后我做：

```
$text_top = strip_tags(trim($_POST['text_top'])); 
```

但是在 $text_top 的显示上，将变量粘贴到图像上后，我得到：

```
&nbsptest test&lt;br&gt; 
```

如果我调用 strip_tags 和 trim，为什么会发生这种情况，从我看到的情况来看，是正确的并且像往常一样？

全部采用 UTF8 编码。

谢谢！

编辑：（完整代码）

```
function wordWrapAnnotation(&$image, &$draw, $text, $maxWidth)
{
$words = explode(" ", $text);
$lines = array();
$i = 0;
$lineHeight = 0;
while($i < count($words) )
{
    $currentLine = $words[$i];
    if($i+1 >= count($words))
    {
        $lines[] = $currentLine;
        break;
    }
    //Check to see if we can add another word to this line
    $metrics = $image->queryFontMetrics($draw, $currentLine . ' ' . $words[$i+1]);
    while($metrics['textWidth'] <= $maxWidth)
    {
        //If so, do it and keep doing it!
        $currentLine .= ' ' . $words[++$i];
        if($i+1 >= count($words))
            break;
        $metrics = $image->queryFontMetrics($draw, $currentLine . ' ' . $words[$i+1]);
    }
    //We can't add the next word to this line, so loop to the next line
    $lines[] = $currentLine;
    $i++;
    //Finally, update line height
    if($metrics['textHeight'] > $lineHeight)
        $lineHeight = $metrics['textHeight'];
}
return array($lines, $lineHeight);
}

$text_top = strip_tags(trim($_REQUEST['text_top']));
$text_bottom = strip_tags(trim($_REQUEST['text_bottom']));
$id_base = trim($_REQUEST['id_base']);

/* Création d'un nouvel objet imagick */
$im = new Imagick($_REQUEST['image']);

/* Création d'un nouvel objet imagickdraw */
$draw = new ImagickDraw();

/* Définition de la taille du texte à 52 */
$draw->setFontSize(52);
$draw->setTextAlignment(2);
$draw->setFont("impact.ttf");
$draw->setFillColor('white');
$draw->setStrokeColor("black");
$draw->setStrokeWidth(1);

/* Ajout d'un texte */
//$draw->annotation($im->getImageWidth()/2, 50, $text);
list($lines, $lineHeight) = wordWrapAnnotation($im, $draw, stripslashes($text_top), $im->getImageWidth());
$posY= 50;
for($i = 0; $i < count($lines); $i++){
$draw->annotation($im->getImageWidth()/2, $posY + $i*$lineHeight, $lines[$i]);
}

$im->drawImage($draw); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T20:11:11.967

你可以试试这个？

```
$text_top = strip_tags(trim(html_entity_decode($_POST['text_top'], ENT_QUOTES, 'UTF-8'), "\xc2\xa0")); 
```

您的字符串似乎是 html 编码的。

**编辑**

添加了对 UTF-8 编码的支持。这样，不间断的空间会被正确修剪，而不是给出`?`.

来自 PHP 的`html_entity_decode`文档：

> 笔记：
> 
> > 你可能想知道为什么 trim(html_entity_decode(' ')); 不会将字符串缩减为空字符串，这是因为 ' ' 实体不是 ASCII 码 32（由 trim() 剥离）而是默认 ISO 8859-1 编码中的 ASCII 码 160 (0xa0)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:25:50.257

尝试使用这个小解决方案：

```
$str = trim($_POST['text_top']);
$clean = preg_replace("/[^a-zA-Z0-9\/_|+ -]/", '', $str); 
```

如果拳头不能正常工作，试试这个：

```
$str = trim($_POST['text_top']);
$clean = iconv('UTF-8', 'ASCII//TRANSLIT', $str);
$clean = preg_replace("/[^a-zA-Z0-9\/_| -]/", '', $clean);
$clean = strtolower(trim($clean, '-'));
$clean = preg_replace("/[\/_| -]+/", '-', $clean); 
```

# c# - LINQ 按一个字段分组并按另一个字段排序

> ID：12847636
> 
> 赞同：0
> 
> 时间：2012-10-11T20:06:15.233
> 
> 标签：c#, linq, microsoft-metro

我正在尝试为 Windows 8 Metro 风格的应用程序创建一个分组的 ListView。Linq 对我来说有点新。我了解基础知识并且熟悉 mySQL，但我正在为这个语法而苦苦挣扎。

我有一个包含（除其他外）字符串“Date”和一个int“epochTime”的类。日期字符串是 epochTime 的表示形式，但格式为“2012 年 4 月 23 日”，例如 - 忽略事件的时间。

所以我想按日期字符串分组，并按纪元时间对组和组的内容进行排序。到目前为止我最接近的是这个

```
var result =
                from fixture in items
                group fixture by new { fixture.Date, fixture.epochTime } into g
                orderby g.Key.epochTime
                select g; 
```

但是这个分组在 date 和 epochTime 上，所以我得到了在同一天但在他们自己的组中不同时间的事件。谁能指出我正确的方向？

谢谢是提前

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:12:16.357

~~好吧，linq可能无法*保证*~~，但您可以尝试在分组之前对列表进行排序：

```
from fixture in items.OrderBy(i => i.epochTime)
            group fixture by fixture.Date into g
            select g; 
```

**编辑**根据[MSDN](http://msdn.microsoft.com/en-us/library/bb534501.aspx)，分组后保留顺序：

> IGrouping 对象的生成顺序基于 source 中生成每个 IGrouping 的第一个键的元素的顺序。分组中的元素按照它们在源中出现的顺序产生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:13:36.240

可以做：

```
from fixture in items 
group fixture by fixture.Date into g 
orderby g.First().eepochTime
select g; 
```

# c# - 抛出一个新的异常最佳实践

> ID：12847637
> 
> 赞同：2
> 
> 时间：2012-10-11T20:06:19.150
> 
> 标签：c#, .net, exception, exception-handling

以下是良好的做法吗？如果不是，应该怎么做？

```
catch(Exception e)
{
     throw new Exception(e.Message, e);
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-11T20:07:44.177

不，如果您使用相同的消息引发另一个完全相同类型的异常，这不是一个好习惯。这样做会使堆栈跟踪复杂化，并使调试更加痛苦。

如果你要抛出一个新的异常，它应该与原来的有一些显着的不同。例如，它应该是另一种类型，或者以其他方式（如更具体的错误消息）阐明异常的原因。如果您不能做任何这些事情，那么只需使用`throw;`.

或者，更好的是，根本不要抓住它。重新抛出实际上也会稍微弄乱堆栈跟踪（当前帧的错误位置设置为重新抛出点，而不是发生异常的位置），所以如果你没有任何事情需要你亲自处理异常，然后放手——让它传播并让调用者处理它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-11T20:08:24.717

只需重新抛出捕获的异常，无需创建新异常。

```
catch(Exception e)
{
    // Do some logging...
    throw;
} 
```

一些关于重新抛出异常和对其堆栈跟踪的影响的阅读：http: [//msdn.microsoft.com/en-us/library/ms182363 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms182363(v=vs.100).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T20:11:38.853

这取决于你想要做什么。那个确切的代码是没有意义的，但是像

```
catch(Exception ex)
{
    throw new ApplicationSpecificException("Error while doing something specific: " + contextualData, ex);
} 
```

在调试时将有很大帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T20:12:27.943

如果您需要在重新抛出异常之前对其进行处理，请执行以下操作：

```
catch(Exception e)
{
     // Additional handling here
     throw;
} 
```

`Throw`本身只是重新抛出当前异常。如果您不需要在这里处理它，请不要一开始就抓住它。

此外，在您的示例中，您正在捕获任何类型的异常，但在其位置抛出了一个泛型`Exception`- 可能不是很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T20:18:49.570

如果代码真的只是：

```
try
{
  // something
}
catch(Exception e)
{
  throw new Exception(e.Message, e);
} 
```

只需删除 try/catch，它不会做任何有成效的事情。交换`throw;`更好*，*`throw new...`但仍然没有生产力。

 *如果还有其他事情发生，请按照 Gromer 的详细信息进行操作，然后使用`throw;`*

# javascript - 将 jQuery 与 WinJS 绑定元素一起使用

> ID：12847639
> 
> 赞同：1
> 
> 时间：2012-10-11T20:06:29.413
> 
> 标签：javascript, jquery, html, windows-8, winjs

我正在创建一些 Windows 8 应用程序，并且我正在使用 jQuery 进行很多事件处理。问题是，虽然 jQuery 选择器似乎对常规 DOM 元素工作正常，但当我尝试做一个`$('.listItem').click()`事件时，选择器实际上并不能工作。我认为这是因为`.listItem`是在运行时从 WinJS 库创建的元素，并且由于某种原因 jQuery 无法识别它们。

有人知道我在做什么错吗？

谢谢马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T21:30:13.880

列表视图通过 iteminvoked 事件引发点击 - 列表视图项目不会看到点击。

如果您有其他交互式元素是列表视图项上的子项，则可以将类添加`win-interactive`到要从中查看事件的元素。

# tokenize - 斯坦福 nlp 分词器

> ID：12847643
> 
> 赞同：6
> 
> 时间：2012-10-11T20:06:44.573
> 
> 标签：tokenize, stanford-nlp

如何使用斯坦福解析器标记 Java 类中的字符串？

我只能找到 documentProcessor 和 PTBTokenizer 从外部文件中获取文本的示例。

```
 DocumentPreprocessor dp = new DocumentPreprocessor("hello.txt");
   for (List sentence : dp) {
    System.out.println(sentence);
  }
  // option #2: By token

   PTBTokenizer ptbt = new PTBTokenizer(new FileReader("hello.txt"),
          new CoreLabelTokenFactory(), "");
  for (CoreLabel label; ptbt.hasNext(); ) {
    label = (CoreLabel) ptbt.next();
    System.out.println(label);
  } 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T20:09:30.507

PTBTokenizer 构造函数需要一个 java.io.Reader，然后你可以使用 StringReader 来解析你的文本

# ruby-on-rails-3 - 在不丢失默认路由的情况下向资源添加路由

> ID：12847649
> 
> 赞同：0
> 
> 时间：2012-10-11T20:07:16.137
> 
> 标签：ruby-on-rails-3

我对在rails中路由感到困惑。我在一个名为 UsersController 的控制器上有自定义操作，例如“登录”。

如果我这样做，在我的 routes.rb 中：

```
resource :users do
  collection do
    get  'login'
    post 'login'
    get  'logout'
  end
end 
```

我可以链接到 UsersController 的操作登录没有问题，但然后转到*localhost:3000/users*给我错误：

> 找不到没有 ID 的用户

但如果我这样做

> 资源：用户

*localhost:3000/users*给了我预期的清单。

我尝试将两者都放入，但只有文件中存在的第一个版本才能按预期工作。

如何将路由添加到默认路由？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:18:33.310

您的路线中有错字。

尽量`resources`不要`resource`。（`resource`不创建 #index 操作）

看看[说明书](http://guides.rubyonrails.org/routing.html#singular-resources)

# sql - 选择多个总和如何正确按日期过滤

> ID：12847653
> 
> 赞同：1
> 
> 时间：2012-10-11T20:07:27.637
> 
> 标签：sql, date, select, sum, between

这是我目前没有按 createdDate 过滤任何内容的内容。

```
SELECT [employeeID]
      ,employeeName
      ,isnull((SELECT SUM(case when clientID != 10 then timeSpent else 0 end)),0) as 'billable'

      ,isnull((SELECT SUM(case when clientID = 10 then timeSpent else 0 end)),0) as 'nonBillable'
FROM [myDB].[dbo].[myTable]
group by employeeID,employeeName 
```

输出：

```
employeeID employeeName billable nonbillable
---------- ------------ -------- -----------
1          tom          5230     2302
2          dick         25       8439
3          harry        2430     9433 
```

准确的输出将是相似的，但值的总和仅在日期范围内：

```
employeeID employeeName billable nonbillable
---------- ------------ -------- -----------
1          tom          35       5
2          dick         25       15
3          harry        2        48 
```

[myTable] 有以下字段：employeeID,employeeName,clientID,timeSpent,createdDate

我需要能够在每个 select sum 语句中添加一个过滤器，类似于以下内容： WHERE createdDate BETWEEN ('2012-10-01') AND ('2012-10-07')

以下变体都会因 SQL 错误或输出不准确而失败：

```
SELECT [employeeID]
      ,employeeName
      ,isnull((SELECT SUM(case when clientID != 10 then timeSpent else 0 end)),0) as 'billable'
      ,isnull((SELECT SUM(case when clientID = 10 then timeSpent else 0 end)),0) as 'nonBillable'
FROM [myDB].[dbo].[myTable]
WHERE createdDate BETWEEN ('2012-10-01') AND ('2012-10-07')
group by employeeID,employeeName

SELECT DISTINCT [employeeID]
      ,employeeName
      ,isnull((SELECT SUM(case when clientID != 10 then timeSpent else 0 end)),0) as 'billable'
      ,isnull((SELECT SUM(case when clientID = 10 then timeSpent else 0 end)),0) as 'nonBillable'
FROM [myDB].[dbo].[myTable]
WHERE createdDate BETWEEN ('2012-10-01') AND ('2012-10-07')
group by employeeID,employeeName

SELECT [employeeID]
      ,employeeName
      ,isnull((SELECT SUM(case when clientID != 10 then timeSpent else 0 end)WHERE createdDate BETWEEN ('2012-10-01') AND ('2012-10-07')),0) as 'billable'
      ,isnull((SELECT SUM(case when clientID = 10 then timeSpent else 0 end)WHERE createdDate BETWEEN ('2012-10-01') AND ('2012-10-07')),0) as 'nonBillable'
FROM [myDB].[dbo].[myTable]
group by employeeID,employeeName,createdDate 
```

任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:13:57.393

第一个查询应该给你正确的结果

```
SELECT [employeeID] 
      ,employeeName 
      ,isnull((SELECT SUM(case when clientID != 10 then timeSpent else 0 end)),0) as 'billable' 
      ,isnull((SELECT SUM(case when clientID = 10 then timeSpent else 0 end)),0) as 'nonBillable' 
FROM [myDB].[dbo].[myTable] 
WHERE createdDate BETWEEN '2012-10-01' AND '2012-10-07'
group by employeeID,employeeName 
```

但是，如果`createdDate`是日期时间类型，则它只会返回 '2012-01-01 00:00' 和 '2012-10-07 00:00' 之间的值 - 2012-10-07 00:01 之后没有任何值。理想情况下，您会将过滤日期指定为日期，而不是字符串。

# hexagonal-tiles - 没有五边形的球体上的六边形网格

> ID：12847654
> 
> 赞同：11
> 
> 时间：2012-10-11T20:07:35.157
> 
> 标签：hexagonal-tiles

我想在球体上制作一个基于瓷砖的世界。我想用六边形的瓷砖，不过据我所知，你也需要在里面放五边形才能让它合适。

所以，我的问题是，是否可以在不使用五边形的情况下在球体上制作六边形网格？六边形不必是正六边形，如果它们都接近正则就足够了。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-11T20:11:43.283

不可能的。这是数学定理。我猜只有不精确的方法存在。

[http://en.wikipedia.org/wiki/Platonic_solid](http://en.wikipedia.org/wiki/Platonic_solid)

[http://en.wikipedia.org/wiki/Semiregular_polyhedron](http://en.wikipedia.org/wiki/Semiregular_polyhedron)

[用六角地图瓷砖覆盖地球](https://stackoverflow.com/questions/749264/covering-earth-with-hexagonal-map-tiles)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-06T00:37:17.273

这篇文章的作者遇到了类似的问题，写了前面提到的关于这个主题的文章，还有一些 JavaScript 源代码。

基本上，这个想法是，由于在数学上不可能移除五边形，唯一有效的解决方案是修改和扭曲你的六边形网格，以使偶尔出现的五边形不那么突出。使奇数瓷砖成为正常现象。他通过在 icosphere 而不是直六边形网格上创建一个 voronoi 图来做到这一点，并在这些点上反复运行 Lloyd 松弛算法，直到它们或多或少在五边形到八边形的范围内。

# asp.net-mvc-4 - MVC 视图模型错误

> ID：12847659
> 
> 赞同：0
> 
> 时间：2012-10-11T20:08:06.380
> 
> 标签：asp.net-mvc-4, asp.net-mvc-viewmodel

目标：创建一个可重复使用的下拉菜单，列出我网站的管理员、经理和代理。这些类型的用户由 .NET Simplemembership pages_Roles 和 pages_UsersInRoles 表定义。

到目前为止：我的数据库中有一个 UserProfile 表，它有 25 列。我有一个相应的同名域模型，可以从我的 UsersContext() EF 访问。

下拉菜单只需要列出用户的 FirstName、LastName 和 UserId，因此我没有使用完整的域模型，而是创建了以下 ViewModel：

```
namespace MyModels.Models.ViewModels
{
    public class AdminsAndAgentsListVM
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public int UserId { get; set; }
    }
} 
```

然后我将以下内容添加到我的帐户控制器中（注意我还没有使用部分视图）：

```
public ActionResult AdminsAndAgentsList()
{
   UsersContext _db = new UsersContext(); //provides me access to UserProfiles data
   var admins = Roles.GetUsersInRole("Admin"); //gets users with this role

   var viewModel = _db.UserProfiles
       .Where(x => admins.Contains(x.UserName)); //Selects users who match UserName list
    return View(viewModel);
} 
```

然后，我搭建一个列表视图并将其基于强类型 ViewModel：

```
 @model IEnumerable<MyModels.Models.ViewModels.AdminsAndAgentsListVM>

@{
    ViewBag.Title = "AdminsAndAgentsList";
}

<h2>AdminsAndAgentsList</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table>
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.FirstName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.LastName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.UserId)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.FirstName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.LastName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.UserId)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { /* id=item.PrimaryKey */ }) |
            @Html.ActionLink("Details", "Details", new { /* id=item.PrimaryKey */ }) |
            @Html.ActionLink("Delete", "Delete", new { /* id=item.PrimaryKey */ })
        </td>
    </tr>
}

</table> 
```

我做了一个成功的构建，当我运行网页时，我收到以下错误：

> 传入字典的模型项的类型为“System.Data.Entity.Infrastructure.DbQuery `1[My.Models.UserProfile]', but this dictionary requires a model item of type 'System.Collections.Generic.IEnumerable`1[My.Models.ViewModels.AdminsAndAgentsListVM]”。

如果我重新创建视图但在 UserProfile 中强烈键入它，它工作正常。那么如何重新工作，以便我可以对我的 ViewModel 进行强类型输入呢？如果可能，请提供示例。我是 C# 和 MVC 的新手，亲眼目睹代码确实让我受益匪浅。非常感谢帮助！

编辑 ------------------ 这是 UserProfile 的对象：

```
public class UsersContext : DbContext
{
    public UsersContext()
        : base("DefaultConnection")

    {
    }

    public DbSet<UserProfile> UserProfiles { get; set; }
}

[Table("UserProfile")]
public class UserProfile
{

    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }

    [Required]
    [ReadOnly(true)]
    [DisplayName("SubscriberID")]
    public int? SubscriberId { get; set; } //Foreign key

    [StringLength(50, ErrorMessage = "The {0} must be at least {2} characters long.")]
    [Display(Name = "First Name")]
    public string FirstName { get; set; }

    [StringLength(50, ErrorMessage = "The {0} must be at least {2} characters long.")]
    [Display(Name = "Last Name")]
    public string LastName { get; set; }

    //public DateTime DOB { get; set; }
    [DataType(DataType.Date)]
    public DateTime? DOB { get; set; } //This allows null

    public bool? Gender { get; set; }

    [Required]
    [MaxLength(250)]
    [EmailAddress]
    public string Email { get; set; }

    [MaxLength(250)]
    [EmailAddress]
    [NotEqualTo("Email", ErrorMessage = "Alt Email and Email cannot be the same.")]
    public string AltEmail { get; set; }

    [MaxLength(250)]
    [EmailAddress]
    public string FormEmail { get; set; }

    public Address Address { get; set; }

    [MaxLength(20)]
    public string Telephone { get; set; }

    [MaxLength(20)]
    public string Mobile { get; set; }

    [Required]
    [DataType(DataType.Date)]
    public DateTime DateAdded { get; set; }

    [DataType(DataType.DateTime)]
    public DateTime? LastLoginDate { get; set; }

    public bool? OffersOptIn { get; set; } //any offers we may have with us or partners

    public bool? NewsOptIn { get; set; } //newsletter

    public bool? SubscriptionOptIn { get; set; } //account, technical, renewal notices, pp invoices, pp receipts

    public bool? OrderOptIn { get; set; } //orders - workflow notices

    [DataType(DataType.DateTime)]
    public DateTime? LastUpdatedAccountDate { get; set; } //Last time user updated contact info
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T22:09:37.670

试试这个。它会将您的查询投射到您的视图模型中。

```
var viewModel = _db.UserProfiles
       .Where(x => admins.Contains(x.UserName))
       .Select(x => new AdminsAndAgentsListVM { 
                        FirstName = x.FirstName,
                        LastName = x.LastName,
                        UserId = x.UserId}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:18:10.383

您传递的是您的查询视图，而不是您的模型。

按您的方式执行查询

```
var query = _db.UserProfiles
           .Where(x => admins.Contains(x.UserName)); 
```

然后实例化并填充您的视图模型

```
var viewModels = new List<AdminsAndAgentsListVM>();
foreach (var item in query)
{
var viewModel = new AdminsAndAgentsListVM();
     viewodel.FirstName = item.FirstName;
     viewodel.LastName = item.LastName;
     viewodel.UserId = item.UserId;
viewModels.Add(viewModel);
}

  return View(viewModels); 
```

当然，这假设 UserProfile 和 AdminsAndAgentsListVM 具有匹配的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:11:13.187

将您的退货行更改为：

`return View(viewModel.AsEnumerable());`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T20:11:38.040

您没有选择 ViewModel。您需要在查询中执行 Select(x => new AdminsAndAgentsListVM。我也会在那里执行 ToList()。

# regex - 匹配“articles”但不匹配“articles-main”的正则表达式？

> ID：12847663
> 
> 赞同：3
> 
> 时间：2012-10-11T20:08:16.060
> 
> 标签：regex, expressionengine

我将如何编写一个正则表达式来匹配包含该段`"articles"`后跟任何其他段的任何 URL，但不将 URL 与该段匹配`"articles-main"`？

所以它会匹配这些：

```
www.mysite.com/articles
www.mysite.com/articles/tinman 
```

但不是这些：

```
www.mysite.com/articles-main
www.mysite.com/articles-main/tinman 
```

如果重要的话，这是在 ExpressionEngine 中使用的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T20:09:30.847

使用所谓的**负前瞻**：

```
articles(?!-main) 
```

或更准确地说：

```
mysite.com/articles(?!-main) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:15:29.457

与@Regexident 的建议背道而驰，我建议采取积极的前瞻性`articles(?=$|\/)`。

这就是说要匹配`articles`，看看它后面是一个`/`字符还是字符串的结尾。这样，无论您是匹配`"articles-main"`还是`"articlessomethingelse"`.

这*不会*检查文章是否是它自己的目录。的值`http://example.com/some-articles`将匹配，这可能是不可接受的。

如果您不关心`/`字符是否包含在匹配中，您可以使用正则表达式，如下所示：

```
\/articles(?=\/|$) 
```

如果您确实关心并且正在使用 PHP 的 pcre 函数，则可以使用积极的后向 ( `(?<=)`)：

```
(?<=\/)articles(?=\/|$) 
```

[有关这些正则表达式断言的更多信息可以在 php.net 网站上找到。](http://www.php.net/manual/en/regexp.reference.assertions.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:11:04.017

寻找“文章/”。对于您的示例，正​​则表达式可能有点矫枉过正。

# php - 显示最后三个帖子的 Wordpress 功能 -> 摘录效果不佳

> ID：12847670
> 
> 赞同：0
> 
> 时间：2012-10-11T20:08:51.443
> 
> 标签：php, wordpress, post, posts

我有一个 php 函数，应该打印最后三个帖子：标题和摘录。

对于打印的第一篇文章，没有摘录。

这是代码：

```
 $posts = wp_get_recent_posts( array('numberposts' => 3, 'post_status' => 'publish')  );
  foreach ($posts as $post)
  {
    setup_postdata($post);
    echo "<h2 style='font-size:18px'>".$post['post_title']."</h2>";
    if($post['post_excerpt']) 
         echo $post['post_excerpt']." <a href='".get_permalink($post['ID'])."'     style='font-size: 17px;'><b>Continue...</b></a>";
    else echo 'no excerpt';
    echo "<br><br />";
  } 
```

我也想为第一篇打印的文章（最后一篇）摘录。我的代码有什么问题？为什么它不适用于打印的第一篇文章？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:55:36.880

你的循环很奇怪。为什么不只使用常规[`WP_Query()`](http://codex.wordpress.org/Class_Reference/WP_Query)循环？

```
<?php

// The Query
$the_query = new WP_Query( 'posts_per_page=3' );

// The Loop
while ( $the_query->have_posts() ) : $the_query->the_post();
    echo '<li>';
    the_title();
    the_excerpt();
    echo '</li>';
endwhile;

// Reset Post Data
wp_reset_postdata(); 
```

或者，如果您已与您的人结婚，`var_dump( $posts )`请查看包含您要查找的字符串的变量。

# asp.net - 报表查看器控件 (Web) 显示空白报表

> ID：12847671
> 
> 赞同：17
> 
> 时间：2012-10-11T20:08:52.800
> 
> 标签：asp.net, sql-server, reporting-services, webforms, reportviewer

我有一个包含 ReportViewer 控件和 DIV 元素的 Web 表单，因此我可以看到页面实际呈现。我看到我的页面正确加载，我看到在 Fiddler 中访问了报告服务，但从来没有显示任何内容。

目前，我正在使用带有静态文本的报告，没有对其进行查询，以确保我隔离了问题。

我的页面如下：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="ReportViewer.aspx.cs" Inherits="PeopleNet.Web.Views.Reports.ReportViewer" %>

<%@ Register Assembly="Microsoft.ReportViewer.WebForms, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
    Namespace="Microsoft.Reporting.WebForms" TagPrefix="rsweb" %>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
        <asp:ScriptManager ID="ScriptManager1" runat="server">
            <Scripts>
                <asp:ScriptReference Path="~/scripts/jquery-1.7.2.js" />
                <asp:ScriptReference Path="~/scripts/fixReportViewer.js" />
            </Scripts>
        </asp:ScriptManager>

        <div>
            This is the report viewer page...
        </div>
        <rsweb:ReportViewer ID="ReportViewer1" runat="server"></rsweb:ReportViewer>
    </form>
</body>
</html> 
```

显示报告的代码是：

```
protected void Page_Load(object sender, EventArgs e)
{
    this.ReportViewer1.ServerReport.ReportServerUrl = ConfigurationFacade.ReportServerUri;
    this.ReportViewer1.ServerReport.ReportPath = { path to report name };
    this.ReportViewer1.ServerReport.ReportServerCredentials = new ReportServerCredentials(); // custom class implementing IReportServerCredentials as described in various places around the web, including SO
    this.ReportViewer1.ServerReport.Refresh();
} 
```

我的 web.config 文件根据需要配置了 HttpHandlers：

```
<system.web>
    <!-- abbreviated... -->
    <httpHandlers>
        <add path="Reserved.ReportViewerWebControl.axd" verb="*" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" validate="false" />
    </httpHandlers>
</system.web> 
```

和 ：

```
<system.webServer>
    <!-- abbreviated... -->
    <handlers>
        <add name="ReportViewerWebControlHandler" preCondition="integratedMode" verb="*" path="Reserved.ReportViewerWebControl.axd" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    </handlers>
</system.webServer> 
```

该服务器运行 Windows 2008 和 SQL Server 2008 R2。

我正在使用查看器的 SQL Server 2012 版本，因为我们正在将环境更新到 2012。

我已经反复验证可以从 ReportManager 访问该报告，没有任何问题。

我一直在尝试在 IE9 中访问它，并看到其他浏览器说明的各种问题。

我目前（仅用于测试）将我的凭据作为报表服务器凭据传递。我是 Reporting Services 管理员，也是服务器上服务器管理员组的成员。

我检查了事件日志和 ReportServerService 日志，没有发现任何问题。

**更新：**看起来当将 AsyncRendering 更改为 false 并确保我不尝试使用空集合“SetParameters”时，这大部分都被清除了：

```
this.ReportViewer1.AsyncRendering = false; 
```

我在这里的配置/代码中缺少什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-03-11T18:07:23.403

我对此问题的解决方案与尝试将报表查看器高度设置为 100% 有关。这导致没有报告显示。将高度更改为 px 值（即 900px）使报表查看器正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-01T12:22:07.370

我有完全相同的症状：报表呈现为完全空白页。对我来说，生产环境就是这种情况，但它在开发环境中工作。

该报告有两个参数，并且在 RDL 中都没有指定默认值。在后面的 aspx 代码中调用报表时，我不小心只传递了一个参数。第二个参数在开发机器的报表服务器上设置了默认值，但在生产中没有。（是的，报表服务器允许独立于 RDL 文件中的默认设置指定参数默认值。）因此，报表在开发中呈现，但在生产中不呈现。

我通过使用 Fiddler 查看响应 XML 发现了这一点。它包含一个元素，告诉我参数值无效。不幸的是，报告查看器本身并没有显示任何关于缺少参数的错误消息，而只是显示一个空白页面——这使得问题的根源难以找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T15:28:42.480

MSDN 上有[这篇博客文章](http://blogs.msdn.com/b/brianhartman/archive/2010/01/21/asyncrendering-and-all-the-baggage-that-comes-with-it.aspx)讨论了异步渲染的工作原理。

此外，它提到（如评论中所述）同步渲染将内容嵌入页面中，而异步渲染将内容渲染在框架中。框架的大小是“难以计算的”，并且忽略了 SizeToReportContent 属性。

由于除非同步呈现报表，否则报表不会显示，因此问题必须出在框架的使用上。

在评论中提到[的文章](http://msdn.microsoft.com/en-US/library/ms252090%28v=VS.80%29.aspx)中，如果使用相对高度，则异步呈现报表会将控件高度折叠为零像素。这可以解释为什么什么都没有显示。您可以尝试为控件指定高度。那篇文章中还有其他建议。

假设您的问题出在 SQL Server 2008 R2 SSRS 版本中，我相信它来自 VS 2008。我认为 SQL Server 2012 SSRS 借鉴了 VS 2010，它不应该有这些问题，所以当你完成升级时，这个问题可能会消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-29T22:44:25.167

我的报告也显示为空白。我玩了这些属性，它终于出现了。

在 aspx 页面中更改 ReportViewer 控件上的 ProcessingMode 属性对我有用：

```
<rsweb:ReportViewer ID="ReportViewer1" runat="server" 
    Width="100%"  ProcessingMode="Remote">
</rsweb:ReportViewer> 
```

这就是我所拥有的：

```
<rsweb:ReportViewer ID="ReportViewer1" runat="server" ZoomMode="PageWidth"
    Font-Names="Verdana" Font-Size="8pt" Width="100%" ProcessingMode="Remote"
    ShowParameterPrompts="False" ShowToolBar="True"  ShowCredentialPrompts="False" 
    ShowFindControls="False" ShowZoomControl="False" CssClass="ReportViewer">
</rsweb:ReportViewer> 
```

网络配置：

```
<configuration>
  <connectionStrings>
    <add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient"/>
  </connectionStrings>
  <system.web>

    <httpHandlers>
      <add path="Reserved.ReportViewerWebControl.axd" verb="*" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" validate="false" />
    </httpHandlers>

    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        <add assembly="Microsoft.ReportViewer.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        <add assembly="Microsoft.Build.Framework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        <add assembly="System.Management, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
      </assemblies>
    </compilation>
    <authentication mode="Forms">
      <forms loginUrl="~/Account/Login.aspx" timeout="2880"/>
    </authentication>
    <membership>
      <providers>
...
      </providers>
    </roleManager>
  </system.web>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <handlers>
      <add name="ReportViewerWebControlHandler" preCondition="integratedMode" verb="*" path="Reserved.ReportViewerWebControl.axd" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
    </handlers>
  </system.webServer>
</configuration> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-21T13:37:42.737

当您得到空白报告时有几个问题：

1.  IIS 管道；IIS 6 与 IIS7 及更高版本确保您已正确注册 HttpHandler

**IIS7 设置**

```
 <system.webServer>
    <handlers>
      <add name="ReportViewerWebControlHandler" preCondition="integratedMode" verb="*" path="Reserved.ReportViewerWebControl.axd" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    </handlers> 
```

[更多细节](https://msdn.microsoft.com/en-us/library/ms228090.aspx)

如果错过了正确的注册，您可以尝试将 IIS 应用程序池切换到`Classic`模式 [![托管管道模式](../Images/9f42d7d786c30ac72b7d550a69b1821f.png)](https://i.stack.imgur.com/UVvE8.png)

如果您的注册没问题，您应该可以使用`Integrated`模式

2.  另一个 Handler 干扰 ReportViewer

就我而言，它是[Glimpse](http://getglimpse.com/)。Glimpse 是一个非常强大的工具，它可以在开发人员机器上与 ReporViewer 一起正常工作，但在部署的客户服务器上存在问题。解决方案很简单，只需从 web.config 中删除所有 glimse 设置

# php - PHP MySQL外部数据库连接超时

> ID：12847678
> 
> 赞同：0
> 
> 时间：2012-10-11T20:09:33.280
> 
> 标签：php, mysql, connection-timeout

当我尝试通过以下代码连接到外部（与此代码所在的服务器不同）数据库时，连接超时。我知道数据库的设置设置正确，登录信息也很好，因为我可以使用 HeidiSQL 从我的计算机正常登录。如果有人可以看到此代码有问题，谢谢。

```
function database_connect(){
$link = @mysql_connect("xx.xxx.xxx.xx:3306","root","pass"); 
$sql_error = mysql_error();

if (!$link) { 
    echo "Connection with the database couldn't be made.<br>";
    echo "$sql_error"; 
    exit;
}

if (!@mysql_select_db("databasename")) {
    echo "The database couldn't be selected.";
    exit;
}
return $link;
}
database_connect(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:47:36.297

您是否尝试将托管该脚本的 IP 地址添加到“**远程数据库访问主机”**？如果您在 cPanel 上，则需要允许可以远程访问 datase(mysql) 的 IP 地址。如果你不是，那么这只是一个做什么的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T21:23:46.097

现在已知问题。

我的虚拟主机不允许连接到外部数据库。

# r - 计算数据框的 R 中的平均值、标准误差和百分比

> ID：12847690
> 
> 赞同：0
> 
> 时间：2012-10-11T20:10:27.947
> 
> 标签：r, plyr

我有一个具有以下结构的数据框`dput(scoreDF)`：

```
scoreDF <- structure(list(ID = c(1, 2), Status = structure(c(2L, 1L),
  .Label = c("Fail", "Pass"), class = "factor"), Subject_1_Score = c(100, 25),
  Subject_2_Score = c(50, 76)), .Names = c("ID", "Status", "Subject_1_Score",
  "Subject_2_Score"), row.names = c(NA, -2L), class = "data.frame") 
```

现在，我需要得出通过和失败的学生百分比，通过和失败的学生的平均值，相同的标准错误。

对于标准错误，我定义了一个函数如下：

```
stdErr <- function(x) {sd(x)/ sqrt(length(x))} 
```

我希望`x`是一个需要计算其标准误差的向量。

我已经看过文档`ddply`，但我无法弄清楚如何计算上面数据框的 % ie（通过次数）/（总计数）和标准错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:30:45.910

您可以使用 tapply 计算组统计信息。如果您的数据框被称为学生，那么通过通过/失败计算平均值，您将指定：

```
tapply(students$Subject_1_Score, students$Status, FUN=mean) 
```

对于标准错误，将您的 stdErr 函数替换为平均值。

如果你想跨多列计算一些东西，你可以索引 x：

```
tapply(students[,2:3], students$Status, FUN=mean) 
```

要计算通过的学生百分比：

```
dim(students[students$Status == "Pass" ,])[1] / dim(students)[1] 
```

或按分数：

```
dim(students[students$Subject_1_Score >= 65 ,])[1] / dim(students)[1] 
```

以上是使用索引的此类向量语句的数据框示例：

```
length(x[x == "Pass"]) / length(x) 
```

要跨行或列计算函数，您可以使用`apply`.

# vb.net - 从 Windows 服务调用 Web 服务时绕过代理

> ID：12847697
> 
> 赞同：1
> 
> 时间：2012-10-11T20:11:05.413
> 
> 标签：vb.net, web-services, windows-services, web-reference

我有一个 Windows 服务正在调用 Web 服务、传递字符串并返回成功或错误消息。

在我的所有测试和开发中一切都运行良好......直到我尝试在具有代理服务器的网络上内部推出它。Web 服务地址不是内部的，但它们需要绕过代理服务器才能正常工作。如果我断开我的机器与我们的网络的连接并直接访问互联网，它可以正常工作并且可以访问 Web 服务，但如果我连接到公司网络，它就会失败。

我可以很好地添加服务引用，因为它使用了我的用户的代理设置，并且此地址设置为绕过代理。我尝试使用我的用户凭据运行该服务，但它仍然无法正常工作。

这就是我用来调用 Web 服务的方法：

```
 Dim results As String
    Dim objJob As CheckValidationKey.ImportProjectInfo = New CheckValidationKey.ImportProjectInfo
    objJob.Credentials = System.Net.CredentialCache.DefaultCredentials

    results = objJob.CheckValidationKey(ValidationKey) 
```

我似乎无法弄清楚如何绕过代理。我已经尝试了 app.config 中的选项，但没有任何运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T14:30:10.610

我没有得到答案，仍然想要一个，但是，这个特定问题不再是问题。事实证明，代理甚至不是问题，而是我试图使用的特定网段阻止了肥皂请求。所有这些时间！

# cmd - Notepad++ NppExec 在 cmd 中运行

> ID：12847699
> 
> 赞同：5
> 
> 时间：2012-10-11T20:11:12.613
> 
> 标签：cmd, console, notepad++, nppexec

如何让我的命令在 NppExec 中运行在 cmd 中运行，而不是内置控制台，它不适用于诸如“按任意键继续”之类的东西，它只在您按 Enter 时有效？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T05:10:46.170

你想看看 cmd /? 输出和[http://ss64.com/nt/](http://ss64.com/nt/)。使用`start`with`cmd /c`将提供一个外部窗口，使用`cmd /k`会将其保留在 nppexec 控制台中。我不喜欢该`/k`选项的一件事是它确实不是真的，因为“任何键”都不能解决问题并且需要使用 Enter。

用`cmd /k pause`和进行测试`start cmd /c pause`。

请注意，该`start`选项关闭了窗口，因此任何历史记录也将消失。如果这很重要，那么在完成时替换`/k`和`/c`使用`exit`。

# batch-file - 根据一系列文件批量创建文件夹并移动到子目录

> ID：12847701
> 
> 赞同：1
> 
> 时间：2012-10-11T20:11:16.530
> 
> 标签：batch-file, dos

我在网上找到了这个批处理脚本，它采用文件名并根据文件名创建一个文件夹，然后将文件移动到该文件夹​​中：

```
for %%f in (*) do @(md "%%~nf"&move "%%f" "%%~nf")>nul 2>&1&1 
```

我想获取相似的文件并将它们移动到同一个文件夹中，所有多个文件最后都有 001 002 003... 等，所以我只想根据除了最后的数字之外的所有内容对它们进行排序和移动。我做了一些挖掘，我认为我需要在该脚本中使用 %%var:~start,end%% ，但不是 100% 确定如何配置它。

所以如果我有：

```
render001.png
render002.png
render003.png 
```

和

```
txt001.png
txt002.png
txt003.png 
```

我只想要两个名为“render”和“txt”的文件夹，并将文件移到那里

任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T11:27:45.617

这是我的建议：

```
@Echo Off
:: List all files and call :move_2_subfolder -function one file at a time. 
FOR %%a IN (*.png) DO Call :move_2_subfolder "%%~a"
GoTo :End

:move_2_subfolder
:: Save the name of the file [without extension] to sub_folder_name -variable.
Set sub_folder_name=%~n1
:: Strip the numbers off. 
Set sub_folder_name=%sub_folder_name:0=%
Set sub_folder_name=%sub_folder_name:1=%
Set sub_folder_name=%sub_folder_name:2=%
Set sub_folder_name=%sub_folder_name:3=%
Set sub_folder_name=%sub_folder_name:4=%
Set sub_folder_name=%sub_folder_name:5=%
Set sub_folder_name=%sub_folder_name:6=%
Set sub_folder_name=%sub_folder_name:7=%
Set sub_folder_name=%sub_folder_name:8=%
Set sub_folder_name=%sub_folder_name:9=%
:: Create folder, if necessary.
If not exist "%sub_folder_name%" md "%sub_folder_name%\" 
:: Move the file.
Move "%~1" "%sub_folder_name%\"
:: Return to For -command. 
GoTo :EOF

:End
If Defined sub_folder_name Set sub_folder_name=
@Echo Off 
```

这不起作用：

```
For /L %%a IN (0,1,9) DO Set sub_folder_name=%sub_folder_name:%%~a=%* 
```

这也不会：

```
...
For /L %%a IN (0,1,9) DO Call :strip_numbers "%%~a"

:strip_numbers
Set sub_folder_name=%sub_folder_name:%~1%
GoTo :EOF 
```

出于某种原因，*Set* -command 不接受*%%~a*或*%~1*变量。

# sql - sql concat 查询无法正常工作

> ID：12847704
> 
> 赞同：0
> 
> 时间：2012-10-11T20:11:34.517
> 
> 标签：sql

SQL concat 查询无法正常工作

```
UPDATE product
SET    pimg_mid1=concat('.jpg', pimg_mid1) 
WHERE  pid>=21 
```

表列由 命名`img_mid1`，目前它包含`xxxxx`21 行之后的类型值（21 行是正确的）。但需要的是`xxxxx.JPG`.

除前 21 行外，所有行都不正确。这些行应命名为`xxxxx.JPG`（后缀 .JPG）

什么是正确的 sql 查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T20:13:45.950

看起来您需要反转[`concat()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)数据（参见[SQL Fiddle With Demo](http://sqlfiddle.com/#!2/34efa/1)）——*我假设 MySQL 语法*：

```
update product
set pimg_mid1=concat(pimg_mid1,'.jpg')
where pid>=21 
```

# c++ - 如何暂停 Boost 单元测试？

> ID：12847709
> 
> 赞同：1
> 
> 时间：2012-10-11T20:11:39.287
> 
> 标签：c++, unit-testing, boost

我正在为我创建的计时器编写单元测试，并且遇到了在其他项目中经常遇到的问题。我想创建一个单元测试来启动我的计时器，等待片刻，然后在计时器运行后检查我的计时器的值。然后我可以测试我的计时器中的所有功能。

有没有办法做到这一点？我在文档中看不到任何内容。如果这不是一个好习惯，请告知我应该怎么做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T20:23:49.473

如果您正在对任何涉及时间的内容进行单元测试，您可能希望虚拟化您的时间概念，以便您可以手动更改它。根据您为计时器使用的内容，这可能更容易或更难（或内置），但一旦完成，您就可以使用“setVirtualTime(time)”之类的东西编写单元测试。

这种方法的一些优点：

1.  单元测试的运行时间不取决于有问题的计时器有多长时间（一旦你有以小时/天为单位的计时器，这变得很重要）
2.  您的单元测试是确定性的，不会因线程调度的变幻莫测而随机失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:16:47.927

也许在你的单元测试中调用[sleep() ？](http://www.kernel.org/doc/man-pages/online/pages/man3/sleep.3.html)

# parameters - SSRS 报告级联参数

> ID：12847713
> 
> 赞同：1
> 
> 时间：2012-10-11T20:11:50.617
> 
> 标签：parameters, reporting-services, cascading

在我的 SSRS 报告中有 3 个参数，位置，有书，作者

位置将始终被选中，并且是一个多值下拉列表，它有自己的数据集。
有书是真还是假，值也来自数据集。作者是一个下拉菜单，它允许多个值并拥有自己的数据集。

What I need to set is that when false is chosen the author parameter does not need a value and when true is chosen it allows author drop down to be chosen.

他们是否像我可以在作者数据集中使用的 if 条件，或者是否有人知道另一种选择来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:17:42.363

无法通过通常的 SSRS 界面更改参数是否需要。最简单的解决方法是将参数设置为始终需要并向该参数的数据集添加一个值（例如`<Not Required>`。）然后在适当时有条件地将其设置为参数的默认值。

这可以在 sql 语句中完成：

```
SELECT
  field1
  field2
FROM
  myTable
WHERE
  mycondition = whatever

UNION ALL
SELECT
   '<Not Required>',
   1 
```

# php - 后编译php 5.4 curl安装

> ID：12847714
> 
> 赞同：2
> 
> 时间：2012-10-11T20:11:53.730
> 
> 标签：php, linux, curl, installation, centos

我最近从源代码编译了 php 5.4。我有 Centos 6。我使用了这个配置：

```
# ./configure --with-apxs2=/usr/local/apache2/bin/apxs --with-mysql
# make
# make install
# cp php.ini-dist /usr/local/lib/php.ini 
```

我现在意识到我没有安装 cURL。我不知道如何在编译安装 php 后安装 cURL。使用`yum install php-curl`为 php 5.3 安装 cURL。我已经尝试过重启 apache，但它没有出现在我的 phpinfo 文件中。

在这些情况下如何安装 cURL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:40:04.440

如果您使用以下方式安装 php：

```
yum install php 
```

然后可以通过以下方式将 curl 添加到 php：

```
yum install php-curl 
```

但是，由于您是从源代码编译 php，因此您必须重新编译 php 并添加 --with-curl 标志。

您最好只为您安装 yum 并更新 php，除非有特定原因您想从源代码编译它。

# html - ASP.NET 重定向到创建的 HTML 页面，返回错误 404

> ID：12847715
> 
> 赞同：0
> 
> 时间：2012-10-11T20:11:56.683
> 
> 标签：html, asp.net, redirect

我正在编写一个 ASP.NET 网页来接收来自用户的文件，使用 fileUpload，然后调用 .exe 文件以基于该文件创建 HTML。HTML 包含文件名、文件长度等。

在程序中，我使用了：

```
var proc = Process.Start(path, arg);
proc.WaitForExit(); 
```

并且：

```
while(!File.Exists("my file path")); 
```

我尝试使用像“”这样的物理路径`C:\myWesite\CreateHTML\new.HTML`，以及像“”这样的 URL `Mywebsite\CreteHTML\new.html`。如果我在浏览器中键入它们，它们都应该将我带到新页面。

当我使用`Response.Redirect()`. 如果不是，那么 while 循环将永远持续下去，不能继续执行`Response.Redirect()`命令。

问题是，在重定向之后，它抛出了“404 - 找不到文件或目录”。错误。但是，在我刷新它之后，即使 URL 相同，新页面也可以正常工作。因此，每次我使用该网站时，我都需要刷新才能看到它。

我也试过`Server.Transer()`了，但它没有显示正确的页面。

我使用另一台装有 IIS 的 PC 作为服务器。我使用 webmatrix 在另一台 PC 上开发网页。

# matlab - 带 NI 板的 DAQ：Matlab 和 Win64

> ID：12847717
> 
> 赞同：1
> 
> 时间：2012-10-11T20:12:00.377
> 
> 标签：matlab, win64, nidaqmx

在不知不觉中，我决定我的新数据采集计算机将是运行 win7 的 x64。我在计算机上运行 matlab 2012a，并使用 NI PCIe6363 卡进行数据采集。我的问题是关于新的 daq.Session 界面以及如何在后台收集数据（我实验的一个关键组成部分）。

我包括一些示例代码。我将尝试解释我认为代码应该做什么。而实际发生的事情......

代码：

```
function runSessionDAQ
s = daq.createSession ('ni'); s.addAnalogInputChannel('Dev1', 0, 'Voltage');
s.IsContinuous = true; s.Rate = 10000;
timeDuration = 5;
s.NotifyWhenDataAvailableExceeds = s.Rate*timeDuration-1; %trigger 'DataAvailable' before the last sample is collected
lh = s.addlistener('DataAvailable', @(src,events)collectAndSaveData(src,events));

function collectAndSaveData(src,event)
    fprintf('here\n');
    t = event.TimeStamps; data = event.Data;
    save('C:\Users\ephys-data\Desktop\data.mat','t','data');
end

tic;
startT = toc;
stopT = startT+timeDuration;
stop = false;
s.startBackground();
while ~stop
    if toc>stopT;
        stop = true;
        s.ScansAcquired
        s.stop();
        fprintf('stopping....\n');
    else
        if s.ScansAcquired == 0
%             keyboard
        end
        fprintf('continuing...\n')
    end
    WaitSecs(0.5);
end
delete(lh);
end 
```

预期功能：从卡中连续记录数据约 5 秒。就在扫描最后几个数据点之前，将数据保存在适当的位置。然后停止采集。

实际结果：

```
>>runSessionDAQ
continuing...
continuing...
continuing...
continuing...
continuing...
continuing...
continuing...
continuing...
continuing...
continuing...

ans =

                0

stopping.... 
```

没有数据存储在适当的位置。实际上声称 ScansAcquired 的数量为零。就停下来。

怎么了？我应该如何设计我的听众？

=========

\开始{咆哮}

我不敢相信 matlab 网站对于基于会话的 DAQ 的记录是多么糟糕。并且没有定时数字 I/O？嘘！

\结束{咆哮}

=========

-bas

# javascript - 如何修改此脚本以根据 ID 使用不同的替换数组？

> ID：12847718
> 
> 赞同：1
> 
> 时间：2012-10-11T20:12:03.483
> 
> 标签：javascript, jquery

我在下面有这个脚本。我想要做的是修改它，以便它使用一组不同的替换值，具体取决于 document.getElementById('something') 是什么。

因此 ('Headline') 将使用与 ('Body') 等不同的一组替换字符。

提前致谢

```
function DeGlyph(element) {
// List of replacement rules. 
     replacements= [
        //Single Quote Characters
        ['\u0027', '\''],
        ['\u2018', '\''],
        ['\u2019', '\''],
        ['\u201A', '\''],
        ['\u201B', '\''],
        //Double Quote Characters
        ['\u0022', '"'],
        ['\u201C', '"'],
        ['\u201D', '"'],
        ['\u201E', '"'],
        ['\u201F', '"'],
        ['\u301D', '"'],
        ['\u301E', '"'],
        ['\u301F', '"'],
        //Other Characters      
        ['\u00BC', '1/4'],
        ['\u00BD', '1/2'],
        ['\u00BE', '3/4'],
        ['\u2122', '<sup>TM</sup>'],        
        ['\u2013', '-'],
        ['\u2014', '&mdash;'],
        ['\u00A9', '&copy;'],
        ['\u00AE', '&reg;']         

    ];

// Only attempt to use replacer behaviour if we can retain the cursor
// position. Setting value by default moves the cursor to the end of the
// input, which is too irritating.
//
    if (getInputSelection(element)!==null) {
        element.onkeyup= function() {
            value= element.value;
            for (var i= 0; i<replacements.length; i++) {
                value= value.split(replacements[i][0]).join(replacements[i][1]);
            }
            if (value!=element.value) {
                var s= getInputSelection(element);
                element.value= value;
                setInputSelection(element, s);
            }
        };
    }
}

// Cross-browser (as much as possible anyway) cursor positioning
//
function getInputSelection(element) {
    if (element.selectionStart!==window.undefined) {
        return [element.selectionStart, element.selectionEnd];
    } else if (document.selection) {
        var BIG= 1000000;
        var range= document.selection.createRange();
        if (range.moveStart===window.undefined)
            return [0, 0];
        var start= -range.moveStart('character', -BIG);
        var end= -range.moveEnd('character', -BIG);
        return [start-1, end-1];
    } else return null;
}
function setInputSelection(element, s) {
    if (element.selectionStart!==window.undefined) {
        element.selectionStart= s[0];
        element.selectionEnd= s[1];
    } else if (document.selection) {
        var range= element.createTextRange();
        range.collapse(true);
        range.moveEnd('character', s[1]);
        range.moveStart('character', s[0]);
        range.select();
    }
}

new DeGlyph(document.getElementById('Headline')); 
new DeGlyph(document.getElementById('Body')); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T21:04:15.700

嗯，这很“有趣”——就像 Chris 所说，只需将函数替换为您想要使用的替换数组，而不是对其进行硬编码。

这是一个简单的问题：(a) 稍微改变查找表的格式 (b) 改变 DeGlyph 的函数 sig 以包含替换数组 (c) 添加一个计算要传递给 DeGlyph 的变量的函数。

试试这个大小（是否需要在输入中选择文本，除了失去然后重新获得对浏览器窗口更新的关注吗？我认为它不起作用，直到我选择了原始文本然后返回 alt-tab 并浏览器和另一个程序之间的第四次）

```
<!DOCTYPE html>
<html>
<head>
<script>

var mArray = 
    [
        {
                     forId : 'headline', 
            replacements : [
                                //Single Quote Characters
                                ['\u0027', '\''],
                                ['\u2018', '\''],
                                ['\u2019', '\''],
                                ['\u201A', '\''],
                                ['\u201B', '\'']
                            ]
        },

        { 
                     forId : 'body',
            replacements : [
                                ['\u0022', '"'],
                                ['\u201C', '"'],
                                ['\u201D', '"'],
                                ['\u201E', '"'],
                                ['\u201F', '"'],
                                ['\u301D', '"'],
                                ['\u301E', '"'],
                                ['\u301F', '"']
                            ]
        },

        { 
                     forId : 'mTest',
            replacements : [
                                ['1', 'one'],
                                ['2', 'two'],
                                ['3', 'three'],
                                ['4', 'four'],
                                ['5', 'five']
                            ]
        }
    ];

function mDeGlyph(idStr, mDataBank)
{
    var element = document.getElementById(idStr);
    if (element == null)
    {
        alert('no element with that id="'+idStr+'" found');
        return;
    }
    var i, n = mDataBank.length, replacements, found=false;
    for (i=0; i<n; i++)
    {
        if (mDataBank[i].forId == idStr)
        {
            replacements = mDataBank[i].replacements;
            found = true;
            break;
        }
    }
    if (found == true)
    {
        DeGlyph(element, replacements);
    }
    else
        alert("no apparent entry for that id-string");
}

function DeGlyph(element, replacements) 
{
// Only attempt to use replacer behaviour if we can retain the cursor
// position. Setting value by default moves the cursor to the end of the
// input, which is too irritating.
//
    if (getInputSelection(element)!==null) {
        element.onkeyup= function() {
            value= element.value;
            for (var i= 0; i<replacements.length; i++) {
                value= value.split(replacements[i][0]).join(replacements[i][1]);
            }
            if (value!=element.value) {
                var s= getInputSelection(element);
                element.value= value;
                setInputSelection(element, s);
            }
        };
    }
}

// Cross-browser (as much as possible anyway) cursor positioning
//
function getInputSelection(element) {
    if (element.selectionStart!==window.undefined) {
        return [element.selectionStart, element.selectionEnd];
    } else if (document.selection) {
        var BIG= 1000000;
        var range= document.selection.createRange();
        if (range.moveStart===window.undefined)
            return [0, 0];
        var start= -range.moveStart('character', -BIG);
        var end= -range.moveEnd('character', -BIG);
        return [start-1, end-1];
    } else return null;
}
function setInputSelection(element, s) {
    if (element.selectionStart!==window.undefined) {
        element.selectionStart= s[0];
        element.selectionEnd= s[1];
    } else if (document.selection) {
        var range= element.createTextRange();
        range.collapse(true);
        range.moveEnd('character', s[1]);
        range.moveStart('character', s[0]);
        range.select();
    }
}

// just displays the list of repoklacements that we have for assorted ids.
function mInit()
{

//  mDeGlyph('Headline');
//  mDeGlyph('Body');
    mDeGlyph('mTest', mArray);
}

</script>
<style>

</style>
</head>
<body onload='mInit();'>
    <input id='mTest' value='1 3 5' />
</body>
</html> 
```

# gcc - 将 gcc 生成的对象与 g++ 的共享对象库链接起来有什么好处吗？

> ID：12847729
> 
> 赞同：0
> 
> 时间：2012-10-11T20:13:01.893
> 
> 标签：gcc, g++, shared-libraries

我最近遇到了一个项目，它通过将 gcc 生成的对象文件（使用`CC`gnu makefile 宏）与 g++ 链接来创建它的共享对象库。

除了（可能）确保源代码被封装在`#ifdef __cplusplus / extern "c" { / #endif`结构中以避免名称修改问题之外，还有什么理由会......更好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T11:52:02.777

如果他们只*链接*`g++`然后添加预处理器检查并且没用`extern "C"`，那只会在已经完成的链接阶段影响预处理和编译。

他们可能希望确保异常可以通过他们的 C 库传播，但要做到这一点，他们只需要链接到 libgcc 而不是 libstdc++。

也许他们只是希望共享库依赖于 libstdc++，这样库的用户也将依赖于 libstdc++，并且不必显式链接到它，尽管这可能不会像他们预期的那样工作。

所以简而言之，不，如果所有代码都是 C 代码而不是 C++ 代码，我想不出任何好的理由。

**然而**，仅仅因为某些东西被编译`gcc`并不意味着它是 C 代码，您可以使用`gcc`可执行文件来编译 C++ 代码，它会调用 C++ 前端 ( `cc1plus`) 而不是 C 前端 ( `cc1`)。如果 C++ 代码使用标准库，那么您需要链接`-lstdc++` **或**使用`g++`链接（自动链接`-lstdc++`）。所以也许答案是它是 C++ 代码，而他们编译对象的事实并`gcc`没有`g++`让你认为它是 C 代码。

# profiling - 在 CentOS Linux 下分析 C 程序

> ID：12847734
> 
> 赞同：0
> 
> 时间：2012-10-11T20:13:22.883
> 
> 标签：profiling, centos

在 CentOS 下，什么命令行会分析我的 C 程序，包括系统调用所花费的时间？我需要用 yum 安装哪些程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T21:07:21.313

安装oprofile：`yum install oprofile`

初始化oprofile：

```
opcontrol --no-vmlinux #If you have vmlinux set this option differently
opcontrol --init
opcontrol --reset
opcontrol --separate=lib
opcontrol --callgraph=0    # clear callgraph in case it was used recently
opcontrol --start 
```

现在运行要分析的程序。运行足够长的时间后，请执行以下操作：

```
opcontrol --dump
opreport --symbols /path/to/executable 
```

有关其他一些示例输出，请参见[此处](http://oprofile.sourceforge.net/examples/)。

# perl - MIME::Parser - 无法保存二进制附件

> ID：12847739
> 
> 赞同：0
> 
> 时间：2012-10-11T20:13:35.120
> 
> 标签：perl

我正在使用 Perl 来阅读消息、查找和保存附件。附件将始终是二进制 pdf 文档，并且永远不会有多个附件。我需要阅读主题，检查附件（如果存在）并将复制消息保存到文件夹以进行临时存储。

阅读、打印、复印功能都可以正常工作。我用 MIME::Parser 尝试了很多不同的场景（我安装了 MIME::Tools），但要么得到一个空白文件，要么得到一个包含 1 个或 2 个字符的文件。我还想知道如何确定/设置文件扩展名，而不是盲目地重命名为 .pdf。

```
#!/usr/bin/perl

use Net::IMAP::Simple::SSL;
use Email::Simple;
use MIME::Parser;

print "Content-type: text/html\n\n";

$server = new Net::IMAP::Simple::SSL('xxx');
$server->login('xxx','xxx');

my $folder='inbox';

my ($unseen, $recent, $total) = $server->status($folder);
my $newm = $server->select('INBOX');

my $tmp=($total-9); #limit for testing

my $outputdir = "./temp";
my $parser = new MIME::Parser;
$parser->output_dir($outputdir);

for (my $i = $tmp; $i <= $total; $i++) {

        if ($server->seen($i)) {
        print "Message #$i has been seen before...<br />";
        } else {

        my $es=Email::Simple->new(join '', @{$server->top($i)});
        print $es->header('Subject')." on ";
        print $es->header('Date')."<br />";
        print "You've just seen message #$i<br />" if $server->see($i)."<br />";
        $msg = $server->get($i);
        $parser->parse_data($msg);
        $server->copy($i,'dump');

        }

    }

 $server->quit();

 exit; 
```

错误

> parse_data：错误的参数引用类型：Net::IMAP::Simple::_message at mailextract.pl line x

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:45:48.583

不知道你为什么使用两个不同的解析器......

```
my $entity = $parser->parse_data($message);
my $from = $entity->head->get('From');
my $subject = $entity->head->get('Subject');
my $timestamp = $entity->head->get('Date');

for my $part ($entity->parts()) {
  if ( $part->mime_type eq 'application/pdf' ) { ### Few different types in use, see what your
                                                 ###  messages get sent with
    my $filename = $part->bodyhandle->path;
    ...
    ### Do whatever
  }
} 
```

编辑：并且您的错误正在发生，因为您没有提供要解析的正确内容，即 Net::IMAP::Simple::_message 而不是：

> 解析数据数据
> 
> ```
> Instance method. Parse a MIME message that's already in core. This internally creates an "in memory" filehandle on a Perl scalar value 
> ```
> 
> 使用 PerlIO
> 
> ```
> You may supply the DATA in any of a number of ways...
> 
>     A scalar which holds the message. A reference to this scalar will be used internally.
> 
>     A ref to a scalar which holds the message. This reference will be used internally.
> 
>     DEPRECATED
> 
>     A ref to an array of scalars. The array is internally concatenated into a temporary string, and a reference to the new 
> ```
> 
> 字符串在内部使用。
> 
> ```
>  It is much more efficient to pass in a scalar reference, so please consider refactoring your code to use that interface instead. 
> ```
> 
> 如果你绝对必须传递一个数组，你最好在调用代码中使用 IO::ScalarArray 来生成一个文件句柄，然后将该文件句柄传递给 parse()

试试`$parser->parse($server->getfh($i))`；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T11:40:21.193

```
#!/usr/bin/perl

use Net::IMAP::Simple::SSL;
use MIME::Parser;

print "Content-type: text/html\n\n";

$server = new Net::IMAP::Simple::SSL('xxx');
$server->login('xxx','xxx');

my $newm=0;
   $newm = $server->select('INBOX');

if ($newm==0) {
  $server->quit();
  print "No New Messages.";
  exit;
  }

my $outputdir = "./temp";
my $parser = new MIME::Parser;
$parser->output_dir($outputdir);

for (my $i = 1; $i <= $newm; $i++) {

  my $entity = $parser->parse($server->getfh($i));
  my $from = $entity->head->get('From');
  my $subject = $entity->head->get('Subject');
  my $timestamp = $entity->head->get('Date');

  print "#$i $from / $subject / $timestamp<br />";

  for my $part ($entity->parts()) {
    print " / ".$part->mime_type;
    if ( $part->mime_type eq 'application/octet-stream' || $part->mime_type eq 'application/pdf' ) {
      my $filename = $part->bodyhandle->path;
      print " / $filename";
      }
    print "<br />";
    }
  $server->copy($i,'dump');
  $server->delete($i);
  }
$server->quit(); 
```

# java - 无法从命令行运行 Selenium 测试（java）

> ID：12847753
> 
> 赞同：0
> 
> 时间：2012-10-11T20:14:02.487
> 
> 标签：java, command-line, selenium

我正在使用 Selenium 对一些 html 进行测试。我在 Eclipse 下使用 java 并通过 Junit 运行测试。一切都很好。但是当我开始使用命令行（Dos 提示符下的 javac/java）编译/运行测试时遇到了问题。对于这个 java 项目，我有一堆类，每个类代表一个测试，而每个类都位于自己的 java 文件中。所有这些文件都在一个名为“testSuite”的包/文件夹下。每个测试文件都会导入一堆 jar 文件。而且他们还从另一个导入全局类 问题，编译没问题。但我让它运行。我先编译 global.java 然后编译`PolicyFilter.java`然后尝试运行该类，下面是我得到的：

```
Exception in thread "main" java.lang.NoClassDefFoundError: \testsuite\PolicyFilter (wrong name: testSuite/PolicyFilter)
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:17:08.477

请使用`java -cp requiredClassfiles/folders/jars classToExecute`.

我希望你有 Selenium RC Jar 可用并使用 command 启动它`java -jar selenium-server-standalone-<version-number>.jar`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T07:02:22.270

确保将注释@Test 放在测试上，清理项目文件夹中的文件夹目标，然后重新启动eclipse。希望它有效:))

# jquery - Fancybox 2 是否可以使用链接从幻灯片中导航

> ID：12847754
> 
> 赞同：1
> 
> 时间：2012-10-11T20:14:04.880
> 
> 标签：jquery, fancybox

我有一个画廊 (rel="gallery)，我正在使用 Fancybox 2 在幻灯片之间导航。

我想知道如何使用自定义链接从每张幻灯片中导航幻灯片。

幻灯片.html

```
<article class="slide">
    <nav>
      <a href="#slide0" class="prev">PREVIOUS</a> | <a href="slide1" class="next">NEXT</a>
    </nav>
    <img src="image.jpg">
</article> 
```

js

```
$slide.find('.next').fancybox.next();
$slide.find('.prev').fancybox.prev(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:23:30.283

试试这个：

```
$(".fancybox-next").click(); // for next button
$(".fancybox-prev").click(); // for prev button 
```

所以如果你有自己的按钮，你会喜欢：

```
$(".next").click(function(){
  $(".fancybox-next").click(); 
}) 
```

然后你可以隐藏原生的下一个和上一个按钮`$(".fancybox-next").hide();`

# c - C调整动态数组的大小

> ID：12847756
> 
> 赞同：2
> 
> 时间：2012-10-11T20:14:09.100
> 
> 标签：c, arrays, resize, malloc, free

我正在为 C 类创建一个动态数组数据结构。我已经实现了几乎所有的东西，现在我正在测试它。它目前在调整大小时卡住了。我已经使用 printf 来解决这个问题。看起来调整大小正在工作，但是当我去添加我的下一个项目后调整大小时，它就停在那里了。

我认为这可能与我的内存分配或我在调整大小期间指向和释放数组的方式有关。我是 C 新手，所以这些是我的症结所在。

```
#include <assert.h>
#include <stdlib.h>
#include "dynArray.h"
#include <stdio.h>

struct DynArr
{
    TYPE *data;     /* pointer to the data array */
    int size;       /* Number of elements in the array */
    int capacity;   /* capacity of the array */
};

/* ************************************************************************
    Dynamic Array Functions
************************************************************************ */

/* Initialize (including allocation of data array) dynamic array.

    param:  v       pointer to the dynamic array
    param:  cap     capacity of the dynamic array
    pre:    v is not null
    post:   internal data array can hold cap elements
    post:   v->data is not null
*/
void initDynArr(DynArr *v, int capacity)
{
    assert(capacity > 0);
    assert(v!= 0);
    v->data = (TYPE *) malloc(sizeof(TYPE) * capacity);
    assert(v->data != 0);
    v->size = 0;
    v->capacity = capacity; 
}

/* Allocate and initialize dynamic array.

    param:  cap     desired capacity for the dyn array
    pre:    none
    post:   none
    ret:    a non-null pointer to a dynArr of cap capacity
            and 0 elements in it.       
*/
DynArr* newDynArr(int cap)
{
    assert(cap > 0);
    DynArr *r = (DynArr *)malloc(sizeof( DynArr));
    assert(r != 0);
    initDynArr(r,cap);
    return r;
}

/* Deallocate data array in dynamic array. 

    param:  v       pointer to the dynamic array
    pre:    none
    post:   d.data points to null
    post:   size and capacity are 0
    post:   the memory used by v->data is freed
*/
void freeDynArr(DynArr *v)
{
    if(v->data != 0)
    {
        free(v->data);  /* free the space on the heap */
        v->data = 0;    /* make it point to null */
    }
    v->size = 0;
    v->capacity = 0;
}

/* Deallocate data array and the dynamic array ure. 

    param:  v       pointer to the dynamic array
    pre:    none
    post:   the memory used by v->data is freed
    post:   the memory used by d is freed
*/
void deleteDynArr(DynArr *v)
{
    freeDynArr(v);
    free(v);
}

/* Resizes the underlying array to be the size cap 

    param:  v       pointer to the dynamic array
    param:  cap     the new desired capacity
    pre:    v is not null
    post:   v has capacity newCap
*/
void _dynArrSetCapacity(DynArr *v, int newCap)
{   
    DynArr* newArr = newDynArr(newCap);     //Create new array with new cap
    int x;
    for(x = 0; x < sizeDynArr(v); x++){
        addDynArr(newArr, v->data[x]);      //copy data
    }
    freeDynArr(v);                  //free old v
    v->capacity = newCap;
    v->size = newArr->size;
    v = newArr;                 //point v to new array
}

/* Get the size of the dynamic array

    param:  v       pointer to the dynamic array
    pre:    v is not null
    post:   none
    ret:    the size of the dynamic array
*/
int sizeDynArr(DynArr *v)
{
    return v->size;
}

/*  Adds an element to the end of the dynamic array

    param:  v       pointer to the dynamic array
    param:  val     the value to add to the end of the dynamic array
    pre:    the dynArry is not null
    post:   size increases by 1
    post:   if reached capacity, capacity is doubled
    post:   val is in the last utilized position in the array
*/
void addDynArr(DynArr *v, TYPE val)
{
    /* Check to see if a resize is necessary */
    printf("size: %d\tcap: %d\n", v->size, v->capacity);
    if(v->size >= v->capacity) {
        printf("in resize..");
        _dynArrSetCapacity(v, 2 * v->capacity);
    }
    v->data[v->size] = val;         //after a resize this doesn't happen.
    v->size++;
}

/*  Get an element from the dynamic array from a specified position

    param:  v       pointer to the dynamic array
    param:  pos     integer index to get the element from
    pre:    v is not null
    pre:    v is not empty
    pre:    pos < size of the dyn array and >= 0
    post:   no changes to the dyn Array
    ret:    value stored at index pos
*/

TYPE getDynArr(DynArr *v, int pos)
{
    /*returns data element at specified position within the array*/

    assert(pos < sizeDynArr(v) && pos >= 0);        //value is between zero and size
    return v->data[pos];                            //returns deferenced int value at position
}

/*  Remove the element at the specified location from the array,
    shifts other elements back one to fill the gap

    param:  v       pointer to the dynamic array
    param:  idx     location of element to remove
    pre:    v is not null
    pre:    v is not empty
    pre:    idx < size and idx >= 0
    post:   the element at idx is removed
    post:   the elements past idx are moved back one
*/
void removeAtDynArr(DynArr *v, int idx)
{
    int i;
    assert(idx < sizeDynArr(v) && idx >= 0);

    for (i = idx; i < sizeDynArr(v)-1; i++){
        v[i].data = v[i+1].data;
    }
    v->size--;
}

/* ************************************************************************
    Stack Interface Functions
************************************************************************ */

/*  Returns boolean (encoded in an int) demonstrating whether or not the 
    dynamic array stack has an item on it.

    param:  v       pointer to the dynamic array
    pre:    the dynArr is not null
    post:   none
    ret:    1 if empty, otherwise 0
*/
int isEmptyDynArr(DynArr *v)
{
    return (sizeDynArr(v) == 0);
}

/*  Push an element onto the top of the stack

    param:  v       pointer to the dynamic array
    param:  val     the value to push onto the stack
    pre:    v is not null
    post:   size increases by 1
            if reached capacity, capacity is doubled
            val is on the top of the stack
*/
void pushDynArr(DynArr *v, TYPE val)
{
    addDynArr(v, val);
}

/*  Returns the element at the top of the stack 

    param:  v       pointer to the dynamic array
    pre:    v is not null
    pre:    v is not empty
    post:   no changes to the stack
*/
TYPE topDynArr(DynArr *v)
{
    return getDynArr(v, sizeDynArr(v)-1);
}

/* Removes the element on top of the stack 

    param:  v       pointer to the dynamic array
    pre:    v is not null
    pre:    v is not empty
    post:   size is decremented by 1
            the top has been removed
*/
void popDynArr(DynArr *v)
{
    removeAtDynArr(v, sizeDynArr(v)-1);
}

int main(int argc, char* argv[]){
    DynArr* myD = newDynArr(5);
    int x;

    addDynArr(myD, 1);
    addDynArr(myD, 2);
    //printf("top: %d", sizeDynArr(myD));
    //printf("size: %d\ttop: %d\n", sizeDynArr(myD), topDynArr(myD));

    for(x = 0; x <= 5; x++){
        addDynArr(myD, x);
        //printf("size: %d\ttop: %d\n", sizeDynArr(myD), topDynArr(myD));
        pushDynArr(myD, x * 2);
        //printf("size: %d\ttop: %d\n", sizeDynArr(myD), topDynArr(myD));
    }

    printf("HI");

    deleteDynArr(myD);

    return 0;   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:21:02.600

```
v = newArr;                 //point v to new array 
```

该行只是分配`newArr`给接收到的指针的*副本*`_dynArrSetCapacity`，它不会修改调用函数中的指针。

为此，您应该传递指针的地址并`_dynArrSetCapacity`接收到`DynArr**`.

```
void _dynArrSetCapacity(DynArr **v, int newCap)
{   
    DynArr* newArr = newDynArr(newCap);     //Create new array with new cap
    int x;
    for(x = 0; x < sizeDynArr(*v); x++){
        addDynArr(newArr, (*v)->data[x]);      //copy data
    }
    freeDynArr(*v);                  //free old v
    // v->capacity = newCap;  These are superfluous, since we change the pointer itself
    // v->size = newArr->size; 
    *v = newArr;                 //point v to new array
} 
```

但更好的解决方案是只重新分配数组，

```
void _dynArrSetCapacity(DynArr *v, int newCap)
{   
    TYPE *temp = realloc(v->data,newCap * sizeof *temp);
    if (!temp) { // alloc failure
        exit(EXIT_FAILURE);
    }
    v->data = temp;
    v->capacity = newCap;
    v->size = newArr->size;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T20:21:08.367

您的功能`_dynArrSetCapacity`无法按预期工作，问题出在以下几行：

```
 v->capacity = newCap;
    v->size = newArr->size;
    v = newArr;                 //point v to new array
} 
```

最后一条指令基本没用。`v`是一个指针。更改不会影响`_dynArrSetCapacity`. 因此`v->data`，您将遇到分段错误`0`：`addDynArr`

```
 _dynArrSetCapacity(v, 2 * v->capacity);
}
v->data[v->size] = val;         //after a resize this doesn't happen. 
```

改为使用`v->data = newArr->data`或使用指针上的指针。

# java - 有没有办法从在同一台服务器上运行的代码中获取服务器指纹？

> ID：12847762
> 
> 赞同：0
> 
> 时间：2012-10-11T20:15:12.253
> 
> 标签：java, x509certificate

我想从服务器本身正在执行的 java 代码中获取服务器指纹。我已经阅读了一些内容，似乎每个人都建议从证书本身中提取它。有没有办法在不使用证书的情况下获得它，比如打开 httpconnection/httprequest 之类的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:19:15.503

1.  使用 SSL 连接从服务器下载证书。[这是一个例子](http://www.xinotes.org/notes/note/1088/)。
2.  计算指纹（哈希）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:21:48.707

我试图使用一个新的 TrustManager 并且它在那里崩溃了。我删除了它并使用了其余的代码并且它有效。

```
static X509TrustManager tm = new X509TrustManager()
{

    @Override
    public void checkClientTrusted(X509Certificate[] arg0, String arg1)
            throws CertificateException
    {
        // TODO Auto-generated method stub
    }

    @SuppressWarnings("synthetic-access")
    @Override
    public void checkServerTrusted(X509Certificate[] arg0, String arg1)
            throws CertificateException
    {

    }

    @Override
    public X509Certificate[] getAcceptedIssuers()
    {
        // TODO Auto-generated method stub
        return null;
    }

    // public static X509Certificate[] getChain() { return chain; }

};

TrustManager[] tm1 = { tm };
SSLContext sslContext = SSLContext.getInstance("TLS");
sslContext.init(null, tm1, new SecureRandom());
sslFactory = sslContext.getSocketFactory();

sslSocket = (SSLSocket) sslFactory.createSocket("localhost", port);
// timeout: 10secs
sslSocket.setSoTimeout(10 * 1000); 
sslSocket.startHandshake();

// add certificate to keystore
X509Certificate[] vCenterServerCert = chain;

 for (int i = 0; i < vCenterServerCert.length; i++) {
            MessageDigest md = MessageDigest.getInstance("SHA-1");
            byte[] der = vCenterServerCert[i].getEncoded();
            md.update(der);
            byte[] digest = md.digest();

            System.out.print("-----BEGIN CERTIFICATE-----\n");
            System.out.print(hexify(digest));
            //System.out.print(new sun.misc.BASE64Encoder().encode(servercerts[i].getEncoded()));
            System.out.print("\n-----END CERTIFICATE-----\n");

        } 
```

# lisp - 稳定联合 lisp

> ID：12847764
> 
> 赞同：1
> 
> 时间：2012-10-11T20:15:31.977
> 
> 标签：lisp

需要在 lisp 中编写一个联合函数，该函数将两个列表作为参数并返回一个列表，该列表是两个列表的并集，没有重复。顺序应与输入列表的顺序一致

例如：如果输入是 '(abc) 和 '(ecd)，结果应该是 '(abced)

这是我到目前为止所拥有的

```
(defun stable-union (x y)
  (cond
   ((null x) y)
   ((null y) x))
  (do ((i y (cdr i))
       (lst3 x (append lst3 
                       (cond
                        ((listp i) 
                         ((null (member (car i) lst3)) (cons (car i) nil) nil))
                        (t (null (member i lst3)) (cons i nil) nil)))))
        ((null (cdr i)) lst3))) 
```

我的错误是段中有一个“非法函数对象”（null（member（car i）lst3））

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T23:46:57.303

该错误是因为您正在尝试执行评估的结果`(null (member (car i) lst3))`。在您的**cond**表达式中，如果**i**是一个列表，那么它会尝试评估该表达式

```
((null (member (car i) lst3)) (cons (car i) nil) nil)) 
```

并返回结果。表达式中的第一个元素应该是一个函数，但是

```
(null (member (car i) lst3)) 
```

将返回一个布尔值。因此失败。您的代码结构需要注意。你错过的是你需要一个内在的**cond**，那里。

顺便说一句，如果您递归地执行它，这将是一个更清洁的功能。

我是一个计划者而不是一个 Lisper，但我有一点考虑。这是递归实现的框架：

```
(defun stable-union (x y)
  (cond
    ((null x) y)
    ((null y) x)
    ((listp y)
     (cond 
       ((member (car y) x) (stable-union ??? (???))) 
       (t (stable-union (append x (??? (???))) (cdr y)))))
    ((not (member y x)) (append x (list y)))
    (t x))) 
```

（编辑以纠正倒数第二行中的简单输入错误，感谢 Will Ness 发现它）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:57:08.277

你把你的括号都弄乱了：

```
(defun stable-union (x y)
  (cond
   ((null x) y)
   ((null y) x)  )     END OF COND form - has no effect

  (do ((i y (cdr i))
      ^^
       (lst3 x (append lst3 
                       (cond
                        ((listp i) 
                         (  (null (member (car i) lst3)) 
                         ^^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ called as a function
                             (cons (car i) nil)           with two arguments
                             nil  ) )
                                 ^^ 
                        (t                         NEXT 3 forms have no effect
                           (null (member i lst3))
                           (cons i nil)
                           nil           )))) )
                                             ^^
        ((null (cdr i)) lst3))) 
```

这是您可能想要的代码，带有更正的括号并`if`在需要的地方添加了一些 s：

```
(defun stable-union (x y)
  (cond
   ((null x) y)
   ((null y) x)
   (t
    (do ((i y (cdr i))
         (lst3 x (append lst3 
                   (cond
                     ((listp i) 
                       (if (null (member (car i) lst3))
                           (cons (car i) nil)
                           nil))
                     (t 
                       (if (null (member i lst3))
                           (cons i nil)
                           nil))))))
        ((null (cdr i)) lst3))))) 
```

这段代码仍然存在问题。你的逻辑是错误的，如果它只包含一个元素`do`，它会跳过第一个元素。无论是否需要`y`，您都会一直打电话。`append`请注意，调用`(append lst3 nil)`会复制 中的顶级 cons 单元格`lst3`，这完全是多余的。

您那里的长语句通常放在正文中，而不是放在局部变量`do`的更新表单中。`do`

* * *

`do`但是您可以在适当的情况下使用更专业的 形式。这里很自然地使用`dolist`. 遵循[“wvxvw”关于使用哈希表进行成员资格测试的指导](https://stackoverflow.com/a/12863735/849891)，我们写道：

```
(defun stable-union (a b &aux (z (list nil)))
  (let ((h (make-hash-table))
        (p z))
    (dolist (i a)
      (unless (gethash i h)
        (setf (cdr p) (list i) p (cdr p))
        (setf (gethash i h) t)))
    (dolist (i b (cdr z))
      (unless (gethash i h)
        (setf (cdr p) (list i) p (cdr p))
        (setf (gethash i h) t))))) 
```

使用我称之为“head-sentinel”的技术（`z`变量预初始化为单例列表）可以极大地简化自上而下列表构建的代码，但代价是分配一个额外的`cons`单元格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T21:39:16.503

```
(remove-duplicates (append '(a b c) '(e c d)) :from-end t) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T16:54:23.967

因为您从 开始`do`，并且因为递归解决方案会更糟，所以您可以这样做：

```
(defun union-stable (list-a list-b)
  (do ((i list-b (cdr i))
       filtered back-ref)
      ((null i) (append list-a back-ref))
    (unless (member (car i) list-a)
      (if back-ref
          (setf (cdr filtered) (list (car i))
                filtered (cdr filtered))
          (setf back-ref (list (car i))
                filtered back-ref))))) 
```

这仍然是二次时间，并且行为是这样的，如果第一个列表有重复项，或者第二个列表有重复项，它们不在第一个列表中 - 它们将保留。我不确定将此函数称为“联合”是否公平，但如果列表有重复项，则必须先定义如何处理列表，然后再尝试统一它们。

如果您对结果感兴趣，而不仅仅是锻炼，这就是您可能会做的事情。请注意，它将确保元素是唯一的，即使元素在输入列表中重复。

```
(defun union-stable-hash (list-a list-b)
  (loop for c = (car (if list-a list-a list-b))
     with back-ref
     with hash = (make-hash-table)
     for key = (gethash c hash)
     with result
     do (unless key
          (if back-ref
              (setf (cdr result) (list c)
                    result (cdr result))
              (when (or list-a list-b)
                (setf back-ref (list c)
                      result back-ref)))
          (setf (gethash c hash) t))
     do (if list-a (setf list-a (cdr list-a))
            (setf list-b (cdr list-b)))
     do (unless (or list-a list-b)
          (return back-ref)))) 
```

# pointers - 汇编中的星号指针 (I32 / x86)

> ID：12847770
> 
> 赞同：4
> 
> 时间：2012-10-11T20:15:56.387
> 
> 标签：pointers, assembly, x86, gdb, att

违规行：

```
 8048f70:   ff 24 85 00 a4 04 08    jmp    *0x804a400(,%eax,4) 
```

位置 804a400 的反汇编代码中没有指令（我的列表以 804a247 结尾）

当我检查该内存位置的内容时，我得到：

```
(gdb) x/c 0x804a40c
0x804a40c:  -103 '\231'

(gdb) x/t 0x804a40c
0x804a40c:  10011001

(gdb) x/s 0x804a40c
0x804a40c:   "\231\217\004\b\222\217\004\b\211\217\004\b\202\217\004\bw\217\004\b\002"

(gdb) x/3x 0x804a40c
0x804a40c:  0x99    0x8f        0x04 
```

这个 jmp 语句到底想做什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T20:31:27.753

该指令是间接跳转。这意味着指定的内存地址不是跳转目标，而是指向跳转目标的指针。

首先，指令加载内存地址处的值：

```
*0x804a400(,%eax,4) 
```

更明智地写成：

```
0x804a400 + %eax * 4  // %eax can be negative 
```

然后将 %eip 设置为该值。

解读这些信息的最佳方法是使用英特尔程序员参考手册。第 2A 卷中的表 2-2 提供了 ModR/M 字节的细分，在这种情况下还提供了 SIB 字节。

# nginx - 使用 proxy_pass 配置 Nginx

> ID：12847771
> 
> 赞同：16
> 
> 时间：2012-10-11T20:15:56.583
> 
> 标签：nginx, reverse-proxy, proxypass

我正在尝试将 Nginx 配置为代理子域上的内容：dev.int.com

我希望将 dev.int.com 代理到 IP:8080，并将 dev.int.com/stash 代理到 IP:7990

这是我当前的配置文件

```
server {
listen   80;
server_name  dev.int.com;
access_log off;
location / {
    proxy_pass http://IP:8080;
    proxy_set_header    Host            $host;
    proxy_set_header    X-Real-IP       $remote_addr;
    proxy_set_header    X-Forwarded-for $remote_addr;
    port_in_redirect off;
    proxy_redirect   http://IP:8080/jira  /;
    proxy_connect_timeout 300;
    location ~ ^/stash {
        proxy_pass http://IP:7990;
        proxy_set_header    Host            $host;
        proxy_set_header    X-Real-IP       $remote_addr;
        proxy_set_header    X-Forwarded-for $remote_addr;
        port_in_redirect off;
        proxy_redirect   http://IP:7990/  /stash;
        proxy_connect_timeout 300;
    }
}

    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
    root   /usr/local/nginx/html;
    }
} 
```

但是，/stash 重定向将转到 /。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-11T20:56:36.320

试试这个...

```
server {
    listen   80;
    server_name  dev.int.com;
    access_log off;
    location / {
        proxy_pass http://IP:8080;
        proxy_set_header    Host            $host;
        proxy_set_header    X-Real-IP       $remote_addr;
        proxy_set_header    X-Forwarded-for $remote_addr;
        port_in_redirect off;
        proxy_redirect   http://IP:8080/jira  /;
        proxy_connect_timeout 300;
    }

    location ~ ^/stash {
        proxy_pass http://IP:7990;
        proxy_set_header    Host            $host;
        proxy_set_header    X-Real-IP       $remote_addr;
        proxy_set_header    X-Forwarded-for $remote_addr;
        port_in_redirect off;
        proxy_redirect   http://IP:7990/  /stash;
        proxy_connect_timeout 300;
    }

    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/local/nginx/html;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-28T19:42:36.800

Nginx 更喜欢基于前缀的位置匹配（不涉及正则表达式），这就是为什么在您的代码块中，/stash 重定向将转到 /。

Nginx 用于选择要使用的位置的算法在此处详细描述：[https ://www.digitalocean.com/community/tutorials/understanding-nginx-server-and-location-block-selection-algorithms#matching-location-块](https://www.digitalocean.com/community/tutorials/understanding-nginx-server-and-location-block-selection-algorithms#matching-location-blocks)

# iphone - 我可以使用自定义播放器 (MPMoviePlayerController) 播放 YouTube 电影吗？

> ID：12847772
> 
> 赞同：0
> 
> 时间：2012-10-11T20:15:56.893
> 
> 标签：iphone, youtube-api, media-player, media

我想构建一个自定义播放器并用它来播放 YouTube 电影。

可能吗？

我是否需要以某种方式解析 YouTube 链接，然后将其传递给播放器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T21:06:52.887

以任何不违反 YouTube 服务条款的方式获取 YouTube 流是不可能的。我建议您做两件事来构建自定义播放器。您可以使用无铬播放器。这将允许您构建一个具有最少的 YouTube 品牌和几乎没有控件的播放器。

[https://developers.google.com/youtube/flash_api_reference](https://developers.google.com/youtube/flash_api_reference)

您还可以使用 iframe 嵌入和几个参数。这种方式可能会更好，因为您将获得 HTML5 和 Flash 选项。您应该设置`modestbranding=1`并`controls=0`获得最少的镀铬和品牌。然后，您可以使用 YouTube js api 构建您自己的控件和功能。这是 iframe 的外观示例。

```
<iframe id="player" type="text/html" width="640" height="390"
  src="http://www.youtube.com/embed/video_id?enablejsapi=1&origin=http://example.com&modestbranding=1&controls=0"
  frameborder="0">
</iframe> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T21:15:21.217

对的，这是可能的。

SO 成员 hellozimi使用`HCYoutubeParser`它来检索可用的 URL。

[https://github.com/hellozimi/HCYoutubeParser](https://github.com/hellozimi/HCYoutubeParser)

# c# - 如何在 VisualStudio 2008 中进行 UnitTest 从数据集中查找记录（通过读取二进制文件创建）

> ID：12847773
> 
> 赞同：0
> 
> 时间：2012-10-11T20:15:57.557
> 
> 标签：c#, unit-testing, visual-studio-2008, binaryfiles

我正在编写一个单元测试，以了解如何从选定的记录中构建检索字符串。我想初始化我的测试方法，以便它可以从数据源获取记录。但是，我的应用程序不使用 SQL。它是一个桌面 C# .NET 应用程序，可从二进制文件创建 DataTable。除了单元测试之外，我是否应该找到其他方法来测试构建检索字符串？应用程序总是通过读取文件来创建 DataTable。我们没有 SQL 数据库。我应该创建一个进行测试吗？那么，如果我无法读取单元测试中的文件，如何测试 DataSource 是否创建正确？以及所有运行单元测试的开发人员如何获得相同的文件（在哪里部署 SQL 文件和/或用于创建它的二进制文件）。

# javascript - Javascript/jquery，获取 (x,y) 处的所有 div 位置。转发触摸？

> ID：12847775
> 
> 赞同：8
> 
> 时间：2012-10-11T20:16:05.513
> 
> 标签：javascript, jquery, click, touch, event-propagation

> **可能重复：**
> [如何获取位于单击点的所有元素的列表？](https://stackoverflow.com/questions/3735278/how-to-get-a-list-of-all-elements-that-resides-at-the-clicked-point)

我知道我可以通过使用`document.elementFromPoint(x,y)`.

问题是我需要获取包含触摸事件位置的每个 div。

**如何将触摸传播到下面的元素？**

我已经看到了一些 hacky 解决方案，它们在重新生成事件时显示/隐藏元素，或者使用 css 的指针事件样式，但是我不能使用这些，它们可能会导致闪烁......

下图说明了我需要做的事情：

![](../Images/b67ba2495fd1a3d252035db77281a2b7.png)

如果紫色、绿色和蓝色框代表 div 元素，而红点是触摸位置，我需要一个返回“div3, div2, div1”的函数。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-11T20:32:07.917

这段代码没有闪烁：

```
$("body").click(function(e){
    var x = e.pageX, y = e.pageY;
    var res = [];

    var ele = document.elementFromPoint(x,y);
    while(ele && ele.tagName != "BODY" && ele.tagName != "HTML"){
        res.push(ele);
        ele.style.display = "none";
        ele = document.elementFromPoint(x,y);
    }

    for(var i = 0; i < res.length; i++){
        res[i].style.display = "";
    }
    console.log(res);
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T20:23:14.077

怎么办：

```
 $(document).click(function(e) { 
    var pageX = e.pageX;
    var pageY = e.pageY;
    $('*').each(function(index) {
        var offset = $(this).offset();
        var left = offset.left;
        var right = offset.right;
        var width = $(this).width();
        var height = $(this).height();
        if(pageX > left && pageX < left + width) {
             if(pageY > top && pageY < top + height) {
                  //Handle the div
             }
        }
    });
}); 
```

# facebook - 如何在不提交应用的情况下在 Facebook 应用上测试邀请好友

> ID：12847776
> 
> 赞同：1
> 
> 时间：2012-10-11T20:16:06.523
> 
> 标签：facebook

我创建了一个 Facebook 应用程序，可以根据他们的网络（大学、高中、专业工作场所等）邀请您的朋友。但是，在我提交应用程序（添加徽标、图像、描述等）之前，我不希望我的朋友看到​​仍在开发中的应用程序的邀请。

此外，我希望能够测试发送超过 50 人的能力，即发送前 50 人，将他们标记为“已发送”，发送下一批 50 人等。

所以我的问题是，您如何测试该功能？

我的假设是我可以创建多达 500 个测试用户并使他们成为彼此的朋友。所以我可能可以这样测试。

但是，我的团队中想要用自己的（真实）帐户试用该功能的人呢？在应用程序提交到应用程序中心之前，您如何使用真实用户的帐户进行测试而不向您的朋友发送垃圾邮件？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T13:01:29.097

你的假设是正确的。我就是这样做的。

您可以根据需要创建尽可能多的用户......让他们成为彼此的朋友并尝试使用它进行测试。您可以设置测试用户的凭据（用户名/密码），以便您可以在您喜欢的机器上登录 facebook。如果你喜欢别人做测试给它凭据。

# facebook - 为什么对象调试器说我的 URL 是 facebook URL 并且不是“可抓取的”

> ID：12847777
> 
> 赞同：0
> 
> 时间：2012-10-11T20:16:16.510
> 
> 标签：facebook, debugging, facebook-graph-api

在尝试为我的第一个 facebook 应用程序创建一个“对象”页面时，我遇到了一些困难。我几乎完全按照[Facebook 的 Open Graph Tutorial进行操作。](https://developers.facebook.com/docs/opengraph/tutorial/)

在使用适当的标签创建“对象”html页面后，`<meta property="og:...`我尝试按照教程中的建议通过[调试器工具运行 URL，但出现以下错误：](https://developers.facebook.com/tools/debug)

“**此调试器无法抓取 Facebook URL。试试你自己的。** ”

这个页面和canvas页面在我公司的linux机器上的同一目录中，当然*不是*“Facebook URL”。如果重要的话，我使用的是 IP 而不是域名：`xx.x.x.xxx/app/obj.html`

...

无论如何我继续教程，但最终它似乎不想发布一个新的`action/object`（*这是否正确*？）。然而，我确实设法得到*了一些*工作，就像几个小时前`app timeline view`我显然是`actioned`其中之一。`objects`我假设这发生在我将`curl POST`命令粘贴到终端时。

我对整个开放图和 facebook API 等都很陌生，所以我可能在某种错误的假设下进行操作，而且我一直在尝试不同的东西，但这个错误对我来说似乎很奇怪我似乎无法解决它。

**更新**

我只是把对象页面放在我自己的个人共享主机帐户上。调试器在它上面工作（莫名其妙地）很好，但我不能走得太远，因为它与我的应用程序授权的域不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:32:15.667

确保`og:url`您的 html 页面内部没有指向 facebook。

另外，请务必查看[开放图形协议](https://developers.facebook.com/docs/opengraphprotocol/)页面（以查看您正确格式化了 og 标签。

此外，请确保每个人都可以访问该页面，而不仅仅是您自己。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:31:05.727

在不知道 URL 的情况下很难确定，但很可能您的 URL 要么包含`og:url`指向 facebook.com 地址的标签，要么包含指向 Facebook 的 HTTP 301/302 重定向

# javascript - D3、SVG 和 Javascript：需要为动态创建的节点分配唯一的图像

> ID：12847783
> 
> 赞同：2
> 
> 时间：2012-10-11T20:16:35.427
> 
> 标签：javascript, svg, d3.js, nodes, force-layout

我正在使用以下 Javascript + SVG + D3 代码。
[http://bl.ocks.org/1095795](http://bl.ocks.org/1095795)

代码在这里：
[https ://gist.github.com/1095727](https://gist.github.com/1095727)

简而言之，我需要每个节点的唯一图像（而不是现在拉的重复的笑脸图像），但我不够精明，无法实现它。任何帮助，将不胜感激。

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="http://mbostock.github.com/d3/d3.js"></script>
<script type="text/javascript" src="http://mbostock.github.com/d3/d3.layout.js"></script>
<script type="text/javascript" src="http://mbostock.github.com/d3/d3.geom.js"></script>
<style type="text/css">
.link { stroke: #ccc; }
.nodetext { pointer-events: none; font: 10px sans-serif; }
</style>
</head>
<body>
<script type="text/javascript">

var w = 960,
    h = 500

var nodes = [],
    links = [];

var vis = d3.select("body").append("svg:svg")
    .attr("width", w)
    .attr("height", h);

var force = self.force = d3.layout.force()
    .nodes(nodes)
    .links(links)
    .gravity(.05)
    .distance(100)
    .charge(-100)
    .size([w, h]);

force.on("tick", function() {
    var node = vis.selectAll("g.node")
        .data(nodes, function(d) { return d.id;} )
    var link = vis.selectAll("line.link")
        .data(links, function(d) { return d.source.id + ',' + d.target.id})
  link.attr("x1", function(d) { return d.source.x; })
      .attr("y1", function(d) { return d.source.y; })
      .attr("x2", function(d) { return d.target.x; })
      .attr("y2", function(d) { return d.target.y; });
  node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });
});

function recalc() {
    var link = vis.selectAll("line.link")
                  .data(links, function(l) { return l.source.id + '-' + l.target.id; });

    link.enter().append("svg:line")
                .attr("class", "link")
                .attr("x1", function(d) { return d.source.x; })
                .attr("y1", function(d) { return d.source.y; })
                .attr("x2", function(d) { return d.target.x; })
                .attr("y2", function(d) { return d.target.y; });

    link.exit().remove();

    var node = vis.selectAll("g.node")
              .data(nodes, function(d) { return d.dpid;}).call(force.drag);

      var nodeEnter = node.enter().append("svg:g")
        .attr("class", "node")
        .call(force.drag);

    nodeEnter.append("svg:image")
        .attr("class", "circle")
        .attr("xlink:href", "https://d3nwyuy0nl342s.cloudfront.net/images/icons/public.png")
        .attr("x", "-8px")
        .attr("y", "-8px")
        .attr("width", "16px")
        .attr("height", "16px");

    nodeEnter.append("svg:text")
        .attr("class", "nodetext")
        .attr("dx", 12)
        .attr("dy", ".35em")
        .text(function(d) { return d.id });

    node.exit().remove();

    force.start();

}

/* Scenario */

/* step 1: add three nodes and three links */
function step1() {
    var nA = {id: 'aaa'};
    var nB = {id: 'bbb'};
    var nC = {id: 'ccc'};
    nodes.push(nA);
    nodes.push(nB);
    nodes.push(nC);

    var lAB = {source: nA, target: nB};
    var lAC = {source: nA, target: nC};
    var lBC = {source: nB, target: nC};
    links.push(lAB );
    links.push(lAC);
    links.push(lBC);

    recalc();
}

/* step 2: node B disappears with links */
function step2() {
    nodes = nodes.filter(function(n) { return n.id !== 'bbb'; });
    links = links.filter(function(l) { return (l.source.id !== 'bbb' && l.target.id !== 'bbb'); });

    recalc();
}

/* step 3: node B reappears with links */
function step3() {
    var nB = {id: 'bbb'};

    nodes.push(nB);

    /* find exiting nodes for links */
    var nA = nodes.filter(function(n) { return n.id === 'aaa'; })[0];
    var nC = nodes.filter(function(n) { return n.id === 'ccc'; })[0];

    var lAB = {source: nA, target: nB};
    var lBC = {source: nB, target: nC};
    links.push(lAB);
    links.push(lBC);

    recalc();
}

window.setTimeout(step1, 2000);
window.setTimeout(step2, 4000);
window.setTimeout(step3, 6000);

force.start();
recalc();

</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T17:59:26.643

看起来您正在尝试为每个节点添加不同的图像，而不是在此处添加的一个图像：

```
nodeEnter.append("svg:image")
    .attr("class", "circle")
    .attr("xlink:href", "https://d3nwyuy0nl342s.cloudfront.net/images/icons/public.png") 
```

这会在节点创建时添加图像，这听起来足以满足您的目的。您需要做的就是为相关`.attr()`调用提供一个函数而不是字符串。如果你有一组图片 URL 可以使用，你可以像这样按顺序获取它们：

```
nodeEnter.append("svg:image")
    .attr("class", "circle")
    .attr("xlink:href", function(d, i) {
        // d is the node data, i is the index of the node
        return myImages[i];
    }) 
```

或者，如果您在节点数据本身中有图像 URL：

```
nodeEnter.append("svg:image")
    .attr("class", "circle")
    .attr("xlink:href", function(d, i) {
        // d is the node data, i is the index of the node
        return d.nodeImageUrl;
    }) 
```

# c# - ListView 自定义排序逻辑

> ID：12847793
> 
> 赞同：0
> 
> 时间：2012-10-11T20:17:17.167
> 
> 标签：c#, listview, sorting

我知道如何实现 ListView 排序，我已经实现了；但是，我想为我的一个专栏做这种自定义排序的逻辑时遇到问题。我曾尝试寻找示例，但似乎找不到任何适合我正在寻找的东西，甚至找不到正确的逻辑方向。

该列可以包含 4 个内容“Dupe”、“Possible Dupe”、“Safe”和“None”。我希望能够根据项目的*状态*对它们进行排序，以便在某个时间点 4 中的任何一个都可以位于 ListView 的顶部，因此典型的 SortOrder.Ascending/SortOrder.Descending 不会工作。

我真的很感激任何帮助，我似乎无法想出这样做的逻辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:37:16.463

我将创建一个字典来包含状态及其排序顺序，以及一个用于设置排序顺序的 UI。然后将数据源（List、DataTable 等）连接到该字典的键（状态）并按字典的值排序（排序顺序）。

# c# - 如何在 C# Windows 窗体应用程序中使用“for”设置一组按钮的背景图像

> ID：12847794
> 
> 赞同：-2
> 
> 时间：2012-10-11T20:17:16.330
> 
> 标签：c#, winforms

每次加载表单时，我想使用轮子更改（例如）30 个按钮的背景图像。

我不能使用这个：

```
for(int i=1;i<=30;i++)
{
    button i .backgroundimage=image.fromfile("URL");
} 
```

我应该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:32:51.830

您的问题有多种可能的解释。为什么你不能使用你的代码？您的问题也有不同的解决方案。

例如：

```
 public Form1() // Constructor
    {
        InitializeComponent(); // Ensure all controls are created.

        List<Button> buttons = new List<Button>(30);

        buttons.Add(mybutton1)
        buttons.Add(mybutton2)
        // Go futher with all your buttons.
    }

    private void Form1_Load(object sender, System.EventArgs e) // Create a load event
    {
       foreach(Button button in buttons)
       {
          button.BackgroundImage = Image.FromFile(path);
          // Note: The file remains locked until the Image is disposed!
       }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:28:55.413

好吧，假设此代码在 Form_Load 中执行并且按钮父控件是您的表单，您可以使用类似的东西。请记住，您应该提供要设置为背景图像的图像的真实路径

```
string path = "rootNameOfTheImage";
int counter = 0;
foreach(Control ctrl in this.Controls)
{
    if(ctrl is Button)
    {
        Button btn = (Button)ctrl;
        if(/* test if this button should be used */)
        {
            btn.BackgroundImage=Image.FromFile(path + counter++.ToString() + ".jpg");
        }
    }
} 
```

# php - 如何获取符号链接文件以查看非符号链接目录

> ID：12847796
> 
> 赞同：1
> 
> 时间：2012-10-11T20:17:21.337
> 
> 标签：php, include, symlink

我有一批文件

```
/home/***/construct/ 
```

我已将其符号链接到子域“http://sampleaccount.mywebsite.com”，以便“/constuct/”目录出现在该子域的特定目录树中。

'/construct/' 中的文件是包含 PHP 的母版页面布局文件，包含在 'sampleaccount' 子域中的 '/bodyCopy/' 目录中。例如：

```
<?php include("bodyCopy/copy-content.php"); ?> 
```

但...

我的网页上不断出现错误，表明 PHP 正在 /home/ *** /construct/ （不存在）的 '/bodyCopy/' 目录中搜索 'copy-content.php' 文件，而不是在'/bodyCopy/' 目录位于 'http://sampleaccount.mywebsite.com' 中，如...

```
http://sampleaccount.mywebsite.com/bodyCopy/copy-content.php 
```

因此，如何使符号链接的母版页布局文件搜索它们链接的当前目录在“sampleaccount”子域中搜索“/bodyCopy/”目录而不是搜索根目录？

需要注意的是，根目录中的“/construct/”目录将符号链接到多个子域帐户，每个帐户都有自己的“/bodyCopy/”目录，因此我不能在母版页布局文件中使用硬链接。

提前感谢您提供的任何解决方案。-- 喷气机

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:20:18.167

```
 <?php include("/rootfoldername/bodyCopy/copy-content.php"); ?> 
```

or

```
 <?php include("../bodyCopy/copy-content.php"); ?> 
```

# javascript - 围绕表单垂直居中页面

> ID：12847798
> 
> 赞同：1
> 
> 时间：2012-10-11T20:17:31.130
> 
> 标签：javascript, jquery, html, css

我知道 CSS 中的垂直中心一开始很痛苦，但我只是让它变得更复杂了一点。在我的页面上，我有：

```
<ul id="complete">
</ul>

<form id="new_item_form">
  <input type="text" id="add_item" placeholder="Type some tasks here"/>
</form>

<ul id="incomplete">
</ul> 
```

这是一个基本的任务列表。任务被添加到不完整的 ul 中，完成后移动到完整的 ul。我想通过 css 做的是让文本字段垂直居中在页面上并留在那里，两个列表靠在它上面。我一直在研究各种垂直对齐方式（在这里找到的表格摘要：http: [//blog.themeforest.net/tutorials/vertical-centering-with-css/](http://blog.themeforest.net/tutorials/vertical-centering-with-css/)）但我似乎找不到方法我可以弄清楚如何适应以允许我需要的东西。我将如何完成这种固定位置居中的风格？

编辑：这是我正在寻找的图像：[https ://www.dropbox.com/s/i0oit3v84j93b5g/Screen%20Shot%202012-10-11%20at%204.27.16%20PM.png](https://www.dropbox.com/s/i0oit3v84j93b5g/Screen%20Shot%202012-10-11%20at%204.27.16%20PM.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:50:36.083

[这是你想要得到的](http://jsfiddle.net/Xz8Zg/2/)吗？

当然，我的代码有点粗略（在 tds 上使用 height 属性！不要骂我*太多*）。但你明白了。

如果表格的高度不知道也不固定，但它的父高度是已知的，它就不起作用（[参见这个例子](http://jsfiddle.net/Xz8Zg/1/)），你必须把它分解。

如果您根本不知道任何高度，那么很难对齐...

[进一步阅读垂直对齐](http://phrogz.net/CSS/vertical-align/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:59:37.040

我想不出用 CSS 做这件事的任何方法，但用 JavaScript/jQuery 做这件事相当容易。这是一个[有效的 jsFiddle](http://jsfiddle.net/6q68L/1/)，它可以在文档加载时执行您想要的操作。当然，如果您更改了列表，您会再次调用代码。

首先，您将列表和表单包含在一个 div 中。我称之为 id="ciddle"。然后您使用 CSS 将 ciddle div 设置为 position: relative。然后使用 JavaScript 代码获取封闭窗口或框架高度，计算窗体的中心，然后减去上部列表高度以获得正确的 div 位置：

```
$(document).ready(function(e) {
    // To work with frames, too
    function getParentDocHeight($ele) {
        for (;;) {
            if (!$ele || !$ele.length) {
                return $(window).height();
            }
            $ele = $ele.parent();
            if ($ele.is("frame") || $ele.is("window")) {
                return $ele.height();
            }
        }
    }
    var $cm = $("#cmiddle");
    var formHeight = $("#new_item_form").outerHeight();
    var viewHeight = getParentDocHeight($cm)
    var formTop = (viewHeight - formHeight) / 2;
    var divTop = formTop - $("#complete").outerHeight();
    $cm.css("top", divTop);
}); 
```

**编辑**：Kraz 很好地添加了将列表项添加到两个列表并再次调用代码进行重新计算的模拟。他的[jsFiddle 在这里](http://jsfiddle.net/6q68L/3/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:23:39.567

嗯，我不确定你在说什么

但一般来说，把 line-height = div 的高度。如有必要，我将围绕它创建一个 div

如果有一些非常特殊的情况，我会做一些数学来手动将其居中

因此，如果您想将 1 件事居中，请使用 line-height = div 的高度创建一个 div，然后使 div 位置：absolute, width, height, ....

希望这可以帮助

# jquery - JQuery inArray 返回真

> ID：12847804
> 
> 赞同：2
> 
> 时间：2012-10-11T20:17:52.193
> 
> 标签：jquery, arrays

```
var arr = [ "One", "Two", "Three" ];

$('select[name="class"]').change(function() {
    if (jQuery.inArray("blah blah", arr)) {
        alert("OK");
    }
}); 
```

这是警告“OK”，但“blah blah”不在数组中......我做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T20:20:48.257

该`jQuery.inArray`函数总是返回一个值：

> 描述：在数组中搜索指定值并返回其索引（如果未找到则返回 -1）。

文档：[http ://api.jquery.com/jQuery.inArray/](http://api.jquery.com/jQuery.inArray/)

将您的代码更改为：

```
if (jQuery.inArray('blah blah', arr)) >= 0) {
    alert('Ok');
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T20:20:24.637

尝试 ：

```
if (jQuery.inArray("blah blah", arr) >-1) { 
```

代替 ：

```
if (jQuery.inArray("blah blah", arr)) { 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T20:20:34.577

如果未找到该项目，jQuery.inArray 返回 -1。不幸的是，-1 在 JavaScript 中是一个真实的值。

检查-1，你很好。

# java - Java MongoDB 访问对象子节点

> ID：12847808
> 
> 赞同：0
> 
> 时间：2012-10-11T20:18:12.063
> 
> 标签：java, mongodb

我将以下文档从 MongoDB 拉入 Java：

```
{
    "_id": {
        "$oid": "5076371389d22e8906000000"
    },
    "item": {
        "values": [
            {
                "value1": [
                    4958,
                    3787,
                    344
                ],
                "value2": [
                    4,
                    13,
                    23
                ]
            }
        ], 
        "name": "item1"
    }
} 
```

使用

```
M mongo = new M("database", "collection");
String query = "{\"item.name\":\"item1\"}";
DBCursor cur = mongo.collection.find(mongo.query(query));
while(cur.hasNext()) {
    System.out.println(cur.next().toString());
    // I need to access value1 array. 
} 
```

我需要访问 value1 数组，我还需要提取整个文档，所以我不能只要求 Mongo 为我返回这个。就像我在拉这个文件一样，需要做一个计算并再次使用该文件。我了解此结果可以转换为地图。但是，由于它是一个多维对象，我将如何浏览它。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:42:57.893

试试这个：

```
 //try catch omitted
  Mongo mongo = new Mongo("localhost", 27017);
  DB db = mongo.getDB("db");

  BasicDBObject query = new BasicDBObject("item.name","item1");
  DBCursor cur = db.getCollection("items").find(query);
  while(cur.hasNext()) {
      BasicDBObject object = (BasicDBObject) cur.next();
      BasicDBObject item =  (BasicDBObject) object.get("item");
      BasicDBList valueslist = (BasicDBList) item.get("values");
      BasicDBObject values = (BasicDBObject) valueslist.get(0);
      BasicDBList value1 = (BasicDBList) values.get("value1");
      System.out.println(value1); 
  } 
```

你可以优化它，但我希望你明白这一点，它会有所帮助。干杯

# ruby-on-rails - Rails路线约束不起作用

> ID：12847809
> 
> 赞同：3
> 
> 时间：2012-10-11T20:18:15.583
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, routes

我想匹配所有以 开头的 URL `/company/`，所以我有这条路线：

```
match '/*id' => 'high_voltage/pages#show', :constraints => { id: /^company\/.*/ } 
```

但是约束没有做任何事情。URL`/abc`也匹配此路由并`PagesController`引发错误。

我应该如何指定这个？

我需要`id`参数包含`company/`在开头，所以请不要说只做路由`match '/company/*id'`。这将为控制器提供一个`id`没有`company/`.

***更新***：我确实在普通的 Ruby 中尝试了上面的正则表达式，它可以工作。我也试过没有 ^ 在公司前​​面（虽然我确实需要公司作为第一个词），但没有运气。

***更新2***：问题似乎出在通配符上，通配符路由是否适用于约束？当路线中有通配符时，我无法获得任何约束。

***更新 3***：原来这只是[Ruby on Rails 中的一个错误](https://github.com/rails/rails/issues/7924#issuecomment-9421227)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T19:12:31.173

如更新中所述，这是 Rails 中的一个错误。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-11T20:28:46.347

看起来像语法错误。尝试使用`:constraints => {:id => /^company/.*/}`

编辑：我只是假设 ruby​​ v 1.9.2

# html - 如何使用纯 CSS 按钮标记？

> ID：12847815
> 
> 赞同：0
> 
> 时间：2012-10-11T20:18:33.723
> 
> 标签：html, css

出于我的好奇心，给定一个像这样的纯 CSS 按钮标记：[http ://www.cssbutton.me/ryanjohnson_me/4fea99463f2df0f605000043，可以使用以下方法](http://www.cssbutton.me/ryanjohnson_me/4fea99463f2df0f605000043)*直观地*创建一个按钮：

```
<div class="button">Click</div> 
```

但是我们如何才能真正让它*发挥作用*呢？例如，让它链接到其他页面，所以当用户点击它时，她会被重定向。

我尝试将 a 包裹在`<a href>`内`<div>`，但按钮文本显示为链接，这是不可取的。我还尝试了相反的方法-将`<div>`内部包装 a `<a href>`，这似乎可行，但有人告诉我这不是有效的 html 代码。

还有什么建议吗？

PS 目标浏览器将是 IE8+、chrome 14+、Firefox 11+、Safari 5+ 和 Opera 11+，如果这有什么不同的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:26:31.643

你试过改变

`<div class="button">Click</div>`

进入`<a class="button" href="#your_link">Click</a>`？

它应该作为普通链接工作，并具有 css 按钮样式和预期行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T20:22:11.627

使用 JavaScript 将操作绑定到按钮。

```
function addEventHandler(elem,eventType,handler) {
     if (elem.addEventListener)
         elem.addEventListener (eventType,handler,false);
     else if (elem.attachEvent)
         elem.attachEvent ('on'+eventType,handler); 
}

addEventHandler(document.getElementById('yourButton'), 'click', function(e) {
    document.location.href = "newpage.html";
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T20:25:50.530

添加到CSS：

```
a.button { text-decoration: none; } 
```

要创建按钮链接：

```
<a class="button" href="/somewhere.html">Somewhere</a> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-11T20:27:19.600

使用 JavaScript，特别是[jQuery](http://jquery.com/)，你可以做到

```
 <div class="button" id="myButton">Click</div>

  $("#myButton").click(function()
  {
       location.href = "mypage.htm";
  }); 
```

# r - 重构 r 和 ggplot2 的 csv 数据

> ID：12847816
> 
> 赞同：5
> 
> 时间：2012-10-11T20:18:36.030
> 
> 标签：r, ggplot2

我是 R 和 ggplot2 的新手。我有一个包含饮料消费数据的 csv 文件。第一列是年份，然后接下来的 9 列是饮料类型，如咖啡、茶、苏打水等，其值为该行的年份值的消费金额。数据涵盖了 41 年的时间。我一直在研究这个并尝试了很多事情。我可以使用 ggplot 轻松为任何一种饮料创建点图。

但是，我想为每个图在 x 轴上创建带有年份的水平堆叠点图。所以，会有一个情节用于咖啡，然后在它的正下方，一个用于茶等。我想我想使用构面。我还在想我想要重组我的数据，使其有 3 列：一列用于年份，一列用于“类别”（即咖啡、茶、苏打水等），最后一列用于价值。我的想法是，一旦我以这种形式获得数据，那么使用刻面应该是直截了当的。

问题是，我似乎无法弄清楚如何以那种形式获取我的数据。以下是前几行数据的外观：

```
Year    Whole Milk  Other Milk  Total Milk  Tea Coffee  Diet Soda   Regular Soda    Total Soda  Juice
1970    25.5    5.8 31.3    6.8 33.4    2.1 22.2    24.3    5.5
1971    25  6.3 31.3    7.2 32.2    2.2 23.3    25.5    5.8
1972    24.1    6.9 31  7.3 33.6    2.3 23.9    26.2    6 
```

有人能帮我吗？

`dput`的数据是：

```
structure(list(Year = 1970:1972, `Whole Milk` = c(25.5, 25, 24.1
), `Other Milk` = c(5.8, 6.3, 6.9), `Total Milk` = c(31.3, 31.3, 
31), Tea = c(6.8, 7.2, 7.3), Coffee = c(33.4, 32.2, 33.6), `Diet Soda` = c(2.1, 
2.2, 2.3), `Regular Soda` = c(22.2, 23.3, 23.9), `Total Soda` = c(24.3, 
25.5, 26.2), Juice = c(5.5, 5.8, 6)), .Names = c("Year", "Whole Milk", 
"Other Milk", "Total Milk", "Tea", "Coffee", "Diet Soda", "Regular Soda", 
"Total Soda", "Juice"), class = "data.frame", row.names = c(NA, 
-3L)) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T20:26:14.110

我有一句我经常用于 ggplot2 的说法，“当有疑问时，融化”。在 reshape 包中有一个函数 melt()，它就是这样做的。

```
tmp <- structure(list(Year = 1970:1972, `Whole Milk` = c(25.5, 25, 24.1
), `Other Milk` = c(5.8, 6.3, 6.9), `Total Milk` = c(31.3, 31.3, 
31), Tea = c(6.8, 7.2, 7.3), Coffee = c(33.4, 32.2, 33.6), `Diet Soda` = c(2.1, 
2.2, 2.3), `Regular Soda` = c(22.2, 23.3, 23.9), `Total Soda` = c(24.3, 
25.5, 26.2), Juice = c(5.5, 5.8, 6)), .Names = c("Year", "Whole Milk", 
"Other Milk", "Total Milk", "Tea", "Coffee", "Diet Soda", "Regular Soda", 
"Total Soda", "Juice"), class = "data.frame", row.names = c(NA, 
-3L))

library(reshape) 

melt(tmp, id.vars="Year")

 Year     variable value
1  1970   Whole Milk  25.5
2  1971   Whole Milk  25.0
3  1972   Whole Milk  24.1
4  1970   Other Milk   5.8
5  1971   Other Milk   6.3
6  1972   Other Milk   6.9
7  1970   Total Milk  31.3
8  1971   Total Milk  31.3
9  1972   Total Milk  31.0
10 1970          Tea   6.8
11 1971          Tea   7.2
12 1972          Tea   7.3
13 1970       Coffee  33.4
... 
```

# c - 读取任意内存位置使程序崩溃

> ID：12847818
> 
> 赞同：0
> 
> 时间：2012-10-11T20:18:37.920
> 
> 标签：c, pointers, negative-number

我正在尝试使用以下 c 代码读取随机内存位置的值

```
 main()
 {
   int a,*b;
   printf("enter the value of a");
   scanf("%d",&a);
   b=a;
   printf("%d\n%d\n",a,*b);
   getch(); 
  } 
```

但是，`negative values`当通过. 我做错了什么？指针没有负值吗？`zero``a``scanf`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:28:58.787

问题是你可能在一个现代的、全方位服务的操作系统上运行，它提供了一个比大多数 c 编程书籍介绍中描述的更复杂的抽象机器。

特别是，操作系统对访问任意地址施加了限制。当您查看与标准变量关联的地址时，您不会注意到这一点，因为您*确实*有权使用堆栈和数据段，并且`alloc`函数族负责确保您有权访问堆的各个部分他们交给你。

因此，您正在做的是访问您没有权限的内存，这会导致在大多数操作系统上出现称为“分段错误”的故障，并且*会*突然结束您的程序。

* * *

你能为这个做什么？

在堆上分配一个*大块*，通过调用`char *p = malloc(1000000);`然后找到类似的起始和结束地址，`printf("start:\t%p\nend\t%p\n",(void*)p,(void*)(p+1000000));`并且只输入该范围内的数字。

请注意，说明`%p`符打印说明符以十六进制输出，因此您可能希望以相同的基数*输入*地址。标准库函数`strtol`在这方面会有所帮助。

一种更复杂的方法是使用操作系统的 API 请求对任意地址的访问权限，但对于某些值，操作系统可能会简单地拒绝。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T20:24:59.553

我在这里看到了一些混乱，只是想要一个指针。

首先，您向用户询问一个值。这可以。然后将该值指定为指针的位置`b`。这*可能*很好，但可能不会。

想一想，*(-500) 是什么意思？*(0) 是什么意思？

一般来说，您永远不能在不先检查或操作它的情况下只接受用户输入并使用它。这是安全漏洞的来源之一。

如果您想尝试取消引用内存，请首先对一些值进行硬编码。在调试器中加载程序，看看会发生什么。

```
int c;
b = 500;
c = *b; // what happens?
b = 0;
c = *b; // what happens?
b = -100;
c = *b; // what happens? 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T20:39:33.793

让我为你大大简化...

在几乎所有具有大多数操作系统的现代计算机中，机器中很少有内存可以由您的程序直接寻址。你不能拿一个指针，把它指向某个东西，然后尝试阅读它。它几乎总是会失败。

一般会出现以下三种情况：

*   内存不存在你指向的地方。指针可以保存大范围的值，并不是所有的值都意味着什么。这就像邮政地址中的门牌号。从技术上讲，你可以在信封上放任何你想要的东西。只有一些是有效的。
*   记忆存在，但不是你的。计算机中的绝大多数内存都由操作系统“拥有”，如果您触摸它，它将终止您的程序。这是为了您的安全。
*   您尝试寻址的内存是有效的，在正确的范围内，但不是完全正确的类型。在前面的示例中，您可能有一个合理的门牌号码，但该位置没有房子。或者地址真的是一个公寓，只是一个数字是不行的。

在 1980 年代具有完整 64k 内存的旧 8 位计算机中，您可以读取任何您想要的位置，这很好。没有那么多了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T20:38:43.513

理论上，您有权读取虚拟地址空间内的任何地址（例如，32 位机器上的 0 到 0xFFFFFFFF）。0 和负数不是问题——一旦将它们分配给指针，它们就会被转换为非负值。

在实践中，它是行不通的。操作系统将保护自己（和您）免受此影响 - 它不会让您从不真正属于您的地址中读取。也就是说，如果你没有分配内存页面并且没有在那里写东西，操作系统不会让你从那里读取。

此外，您并不真正拥有整个地址空间 - 它的下半部分归内核等人所有，因此操作系统不会让您访问它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T20:30:15.497

根据我所听到的，指针完全是积极的。0（NULL 指针）保证不指向任何东西，并且会导致程序停止。此外，操作系统（如果我没记错的话甚至是硬件）提供内存保护。这就是为什么程序过去能够相互崩溃的原因，但现在这种情况已经不太常见了。当您运行程序时，操作系统会决定它可以访问哪些内存，如果您尝试访问不属于您的内存，则会引发段错误。

再说一次，也许你只是想要`b = &a`？这将`b`指向与`a`存在相同的位置，因此，当您`*b`将其等同于存储在`a`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-14T12:53:59.590

如我所见，您将 b 声明为指针，因此执行 a=b 是错误的。你会得到分段错误。指针只显示指针而不是整数、浮点数或字符的值。或者你可以做 b = &a，这意味着 b 显示到 a 的内存地址。因此，您可以打印存储在 a 中的值。

# c# - C# - 总和列表

> ID：12847822
> 
> 赞同：1
> 
> 时间：2012-10-11T20:18:48.623
> 
> 标签：c#, vb.net, string, list, sum

假设你有一个 list<string[]>

```
 List<string[]> lst = new List<string[]>();

  lst.Add(new string[] { "A", "100.10" });
  lst.Add(new string[] { "B", "250.49" }); 
```

如何获得列表中第二个数组项的总和？

需要将第二个数组项转换为 double 并将它们相加。预期结果是**350.59**。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-11T20:19:57.913

你可以使用：

```
double sum = lst.Sum(i => double.Parse(i[1])); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T20:20:47.843

你可以这样做列出这个：

```
lst
.Select(item => Decimal.Parse(item[1]))
.Sum() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T20:20:43.490

```
double total = 0;

foreach(string[] stringArray in lst)
{
    total += Convert.ToDouble(stringArray[1]);
} 
```

# ios - iOS iPhone 5 CMMotion deviceMotionUpdateInterval 问题

> ID：12847832
> 
> 赞同：3
> 
> 时间：2012-10-11T20:19:14.857
> 
> 标签：ios, ios4, cmmotionmanager

我已经在 iOS 6.0 和第 4 代 iPhone 和 iPod touch 上成功使用了 CMMotionManager。新 iPhone 5 的更新间隔似乎是指定的两倍。如果 kTIME_INTERVAL 为 0.0125，我看到的实际间隔约为 0.021。

当我将间隔设置为 0.0125 / 2.0 时，实际的计时器间隔接近 0.013，这正是我想要的。

有人在 iPhone 5 上看到与 CMMotionManager 类似的行为吗？

```
CMMotionManager *motion;

motion.deviceMotionUpdateInterval = kTIME_INTERVAL; // iPhone 4 and 4th gen devices

if (isDevice5thGeneration) {
    // iPhone 5 iOS 6 seems to run motion at twice the update interval (half as fast), so need to set interval at half to get desired interval
    motion.deviceMotionUpdateInterval = motion.deviceMotionUpdateInterval / 2.0; // iPhone 5 KLUDGE 
}
NSLog(@"Start motion recording deviceMotionUpdateInterval: %f", motion.deviceMotionUpdateInterval);

NSOperationQueue *queue = [[NSOperationQueue currentQueue] retain];

CMDeviceMotionHandler motionHandler = ^(CMDeviceMotion *deviceMotion, NSError *error) {
    //NSLog(@"motion handler");
    if (isRecordingMotion) {
        [self processMotion:deviceMotion];
    }
};
[motion startDeviceMotionUpdatesToQueue:queue withHandler:motionHandler]; 
```

提前致谢！

# mysql - 使用 SQL 将 wordpress 自定义字段内容插入 wordpress 帖子

> ID：12847833
> 
> 赞同：0
> 
> 时间：2012-10-11T20:19:21.853
> 
> 标签：mysql, wordpress

我需要一个 sql 查询，它允许我获取 Wordpress 自定义字段的内容并将它们插入现有帖子 (post_content)。我有数千条记录需要处理。

我有限的 SQL 知识不足以解决这个问题，因为自定义字段存储在“wp_postmeta”表中，而帖子内容存储在“wp_posts”表中。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:57:46.967

你不需要（而且你绝对不想）使用 SQL 来做你想做的事。

由于您实际上还没有尝试过任何东西，如果您想确保所有表格都正确填充，并且根据 Wordpress 的标准正确引用所有内容，则应该查看[Update Post Meta 。](http://codex.wordpress.org/Function_Reference/update_post_meta)

如果您在编写实际代码来处理此问题时遇到任何问题，请打开一个新问题并向我们展示您的尝试。

祝你好运。

# r - 编写一个接受两个参数 x 和 n 并返回 h(x, n) 的函数。使用 FOR 循环

> ID：12847834
> 
> 赞同：1
> 
> 时间：2012-10-11T20:19:22.567
> 
> 标签：r

我正在尝试在 R 中编写一个函数，它接受两个参数 x 和 n，并返回 h(x, n); x=1 有谁知道如何使用 for 循环来做到这一点？

我正在使用的函数是：x^0 + x^1 + x^2...x^n

我已经为此工作了一段时间，不确定我是否正确执行此操作。谁能给我一些关于如何解决这个问题的指导。

这是我所拥有的..

```
n = seq(1,6, by = 1)
x = 1
h = function (x,n){
    for (i in 0:n){
        for( i in 1:n){
        sum = sum +x^i
    {
}} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T20:33:37.193

```
h <- function( x, n ) sum( x^c(0:n) ) 
h( 1, 6 ) 
```

1.  在 R 中最好避免循环。首先，您可以在许多情况下使用向量；然后，学会使用`apply`和朋友（`sapply`等`lapply`）。
2.  帮自己一个忙，`<-`而不是`=`在作业中使用。从长远来看，这是有回报的。
3.  与其他编程语言一样，无需在函数*外部*声明变量（无论如何，由于 n 是函数的参数，因此您的第一次赋值对函数没有影响）
4.  不要`seq()`在简单的地方使用`k:n`。

# sql-update - 如何在不覆盖以前数据的情况下更新数据库中的行

> ID：12847835
> 
> 赞同：0
> 
> 时间：2012-10-11T20:19:22.843
> 
> 标签：sql-update

我有一个数据库表，用于存储患者信息以及图像和 Word 文档等文件。更新此表时，它会覆盖以前存储的数据。我该如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:33:18.367

根据您的评论，首先您需要将旧值备份到具有相同列数据类型的其他表中：

```
insert into backup_table ( column1 , column2 , ... )
SELECT  column1 , column2 , ...
FROM    orginal_table 
```

然后更新语句应如下所示：

```
UPDATE orginal_table
SET column1=form_value1, column2=form_value2 ,...
WHERE some_column=some_value 
```

# rspec - rspec 为会话分配失败

> ID：12847836
> 
> 赞同：0
> 
> 时间：2012-10-11T20:19:33.537
> 
> 标签：rspec

我的测试失败并在测试报告上说

> 失败/错误：assigns(:items).should eq(item) expected: [# Item id: 756, product_name: "Item 1", product_price: 310.25, product_balance: 3, active: 1, created_at: "2012-10- 11 20:10:23”，更新时间：“2012-10-11 20:10:23”] 得到：[]

你能告诉我测试失败的原因是什么吗？

cart_controller.rb 文件

```
class CartController < ApplicationController
  def index
    @cart = session[:cart] || {}

    @items = Item.where( id: @cart.keys )

    @cart_cost = 0
    @items.each do | item |
      @cart_cost += @cart[ item.id.to_s ]*item.product_price
    end
  end
end 
```

cart_controller_spec.rb

```
describe CartController do
  context "when user is logged in" do

    before (:each) do
      v = Visitor.create! :username => 'John Doe', :password => '123456'
      session[:logged_in] = 'logged_in'

      session[:cart] = {}
      @cart = session[:cart]

      @normal_item = Item.create! :product_name => 'Item 1',
:product_price => '310.25', :product_balance => '3', :active => '1'
    end

    describe "GET 'index'" do
      it "assigns session cart variable as @cart" do
        get :index
        @cart[ @normal_item.id ] = 1

        assigns(:cart).should eq(session[:cart])

        item = Item.where( id: @cart.keys )
        assigns(:items).should eq(item)
      end
    end

  end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T03:47:24.120

尝试将会话值作为第二个参数传递给`:get`，例如：

```
get :index, {}, { :cart => {}, :logged_in => 'logged_in' } 
```

[这在测试 Rails 应用程序的指南](http://guides.rubyonrails.org/testing.html#functional-tests-for-your-controllers)中有更详细的描述

# visual-studio-2010 - Visual Studio 2010 命令类别

> ID：12847841
> 
> 赞同：1
> 
> 时间：2012-10-11T20:19:54.113
> 
> 标签：visual-studio-2010

在 Visual Studio 2010 Customize->Add Command 对话框中，我可以从一个类别中选择一个命令。给定一个命令名称，我如何知道要查看哪个类别？我想将“选择格式”添加到我的代码窗口上下文菜单中，但我似乎无法在任何地方找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:23:40.523

我不知道你可以使用什么过程来找出它在哪里。

我确实知道它在**编辑**类别中。

# jquery - How get the current latitude, longitude, and zoom in jquery gmap3

> ID：12847843
> 
> 赞同：1
> 
> 时间：2012-10-11T20:19:58.010
> 
> 标签：jquery, google-maps

> **Possible Duplicate:**
> [get current latitude and longitude from gps enabled device](https://stackoverflow.com/questions/3452217/get-current-latitude-and-longitude-from-gps-enabled-device)

I use the gmap3 of [http://gmap3.net](http://gmap3.net). I want to get the latitude, longitude, and zoom on the change event. This api has a get:

[http://gmap3.net/api/get.html](http://gmap3.net/api/get.html)

But i try `$('.gmap_widget').gmap3('get','map');`

and returns a doom node '.gmap_widget'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T21:32:06.693

`$('.gmap_widget').gmap3('get','map');`是错的

正确的形式是`$('.gmap_widget').gmap3({action:'get',name:'map'});`

代码是：

```
 map=$('.gmap_widget').gmap3({action:'get',name:'map'});
   center=map.getCenter();
   lat=center.lat();
   lng=center.lng();
   zoom=map.getZoom(); 
```

新 API 将使用以下内容：

```
var map = $(".gmap_widget").gmap3({ 
  get: {
    name:'map',
    callback: function(map){ 
       center=map.getCenter();
       lat=center.lat();
       lng=center.lng();
       zoom=map.getZoom();  
  }} 
}); 
```

# vbscript - VBScript that Moves modified files to another folder

> ID：12847847
> 
> 赞同：1
> 
> 时间：2012-10-11T20:20:03.107
> 
> 标签：vbscript, move, datecreated, modified-date

Basically, I need a script to move files to another folder that have been accessed and modified.

I'm new to scripting, so this may be a simple problem, but I'm stumped. Here's the error I'm getting:

Script: C:\Users\bmcwilliams\Desktop\pssitest.vbs

Line: 17

Char: 10

Error: File already exists

Code: 800A003A

Source: Microsoft VBScript runtime error

The destination folder is empty, so I'm not sure what's going on.

Below is the code I have. It's modified from the code listed in this post:

[How to move files from a directory to another directory based on file size](https://stackoverflow.com/questions/7030565/how-to-move-files-from-a-directory-to-another-directory-based-on-file-size)

```
' use a default source path
dim sourcepath: sourcepath = "C:\users\bmcwilliams\Desktop\TestUncompleted"

' use a default destination path
dim destinationpath: destinationpath = "C:\users\bmcwilliams\Desktop\TestCompleted"

dim fso: set fso = CreateObject("Scripting.FileSystemObject")
dim sourcefolder: set sourcefolder = fso.GetFolder(sourcepath)

' loop through each file in the directory, compare size property against
' the limit and copy as appropriate
dim file, count: count = 0
for each file in sourcefolder.Files
    dim createDate: createDate = file.DateCreated
    dim modifyDate: modifyDate = file.DateLastModified
    if createDate <> modifyDate Then
         file.Move destinationpath
         count = count + 1
    end if
next

WScript.Echo("complete: " & count & " file(s) moved") 
```

Any ideas? Any input is greatly appreciated. Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:31:59.847

您正在复制到新位置，但不提供文件的新名称。要解决此问题，请将 \ 和文件名附加到目标路径。

```
file.Move destinationpath +"\" + file.name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:36:10.703

如果移动文件的目标路径是文件夹而不是完整路径（包括目标文件名），则它必须有一个尾随反斜杠：

```
destinationpath = "C:\users\bmcwilliams\Desktop\TestCompleted\" 
```

否则，该`Move`操作将检测到目标（文件夹）已经存在，因此会失败。

# java - Strange exception on activity start when android application was updated via Google Play

> ID：12847848
> 
> 赞同：3
> 
> 时间：2012-10-11T20:20:13.613
> 
> 标签：java, android

Strange exception.

Caused by: android.content.res.Resources$NotFoundException: File res/drawable-xhdpi/top_button_bg.png from drawable resource ID #0x7f020032

But this resource definitely exists. Only some users has this problem.

Help me! :(

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{ru.spchat.android.informer/ru.spchat.android.informerActivity}: android.view.InflateException: Binary XML file line #8: Error inflating class <unknown>
 at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
 at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
 at android.app.ActivityThread.access$2300(ActivityThread.java:125)
 at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
 at android.os.Handler.dispatchMessage(Handler.java:99)
 at android.os.Looper.loop(Looper.java:123)
 at android.app.ActivityThread.main(ActivityThread.java:4627)
 at java.lang.reflect.Method.invokeNative(Native Method)
 at java.lang.reflect.Method.invoke(Method.java:521)
 at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
 at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
 at dalvik.system.NativeStart.main(Native Method)
Caused by: android.view.InflateException: Binary XML file line #8: Error inflating class <unknown>
 at android.view.LayoutInflater.createView(LayoutInflater.java:513)
 at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
 at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:563)
 at android.view.LayoutInflater.rInflate(LayoutInflater.java:618)
 at android.view.LayoutInflater.inflate(LayoutInflater.java:407)
 at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
 at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
 at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:201)
 at android.app.Activity.setContentView(Activity.java:1647)
 at ru.spchat.android.informerActivity.onCreate(informerActivity.java:110)
 at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
 at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
 ... 11 more
Caused by: java.lang.reflect.InvocationTargetException
 at android.widget.LinearLayout.<init>(LinearLayout.java:115)
 at java.lang.reflect.Constructor.constructNative(Native Method)
 at java.lang.reflect.Constructor.newInstance(Constructor.java:446)
 at android.view.LayoutInflater.createView(LayoutInflater.java:500)
 ... 22 more
Caused by: android.content.res.Resources$NotFoundException: File res/drawable-xhdpi/top_button_bg.png from drawable resource ID #0x7f020032
 at android.content.res.Resources.loadDrawable(Resources.java:1714)
 at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
 at android.view.View.<init>(View.java:1897)
 at android.view.View.<init>(View.java:1846)
 at android.view.ViewGroup.<init>(ViewGroup.java:291)
 ... 26 more
Caused by: java.lang.IllegalArgumentException: width and height must be > 0
 at android.graphics.Bitmap.nativeCreate(Native Method)
 at android.graphics.Bitmap.createBitmap(Bitmap.java:481)
 at android.graphics.Bitmap.createBitmap(Bitmap.java:437)
 at android.graphics.Bitmap.createScaledBitmap(Bitmap.java:342)
 at android.graphics.BitmapFactory.finishDecode(BitmapFactory.java:498)
 at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:472)
 at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:325)
 at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:697)
 at android.content.res.Resources.loadDrawable(Resources.java:1709)
 ... 30 more 
```

This resource used only in layout xml, so, this is not my code error, I think...

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/main_background_color"
    android:orientation="vertical" >

    <Button
        android:id="@+id/top_button"
        android:textColor="@color/second_text_color"
        android:textSize="16dp"
        android:textStyle="bold"
        android:background="@drawable/top_button_bg"
        android:layout_width="fill_parent"
        android:layout_height="40dp"
        android:layout_gravity="top"
        android:shadowColor="@color/text_shadow"
        android:shadowDx="1"
        android:shadowDy="1"
        android:shadowRadius="1"
        android:text="@string/alarmclock" />

    <ListView
        android:id="@+id/top_list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:clickable="true"
        android:divider="@drawable/second_background_color"
        android:dividerHeight="0.5dp"
        android:longClickable="true" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T02:57:52.013

你可以试试这个：

1.  试着让你`top_button_bg.png`变小；
2.  `android:background="@drawable/top_button_bg"`从 xml 文件中删除，然后`setBackground`在 Java 中删除；
3.  你可以检查用户手机的内存，可能内存不够大

# javascript - 将三元运算符与字符串连接一起使用

> ID：12847853
> 
> 赞同：54
> 
> 时间：2012-10-11T20:20:24.797
> 
> 标签：javascript

```
alert("test: "+(1==2)?'hello':'world'); 
```

这应该`'world'`在屏幕上显示我，因为 1 不等于 2。

怎么会报警`'hello'`？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-10-11T20:22:01.503

尝试将您的括号包裹在操作周围

```
alert("test: "+ (1 == 2 ? 'hello' : 'world')); 
```

演示：http: [//jsfiddle.net/hunter/K3PKx/](http://jsfiddle.net/hunter/K3PKx/)

* * *

这是在做什么：

```
alert("test: "+(1==2)?'hello':'world'); 
```

正在评估`"test: " + (1==2)`哪些`true`输出`'hello'`

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-10-11T20:43:41.140

提交的两个答案都是正确的，您需要添加括号。我想我会简单谈谈原因。

```
alert("test: "+(1==2)?'hello':'world'); 
```

当解析器遇到一个语句时，它将开始递归地将其分解为越来越小的块。

在这种情况下，它首先遇到的是一个函数：`alert`. 解析器将立即查看`alert`的参数，并开始单独解析每个参数。这个函数只有一个参数，`"test: "+(1==2)?'hello':'world'`，使它成为一个简单的第一步。

在这个级别上，我们可以将我们的陈述分解成一系列的二元比较。Javascript 解析器从左到右形成二进制对（当操作值的顺序相同时）。我们的潜在候选人是`"test: "`,`(1==2)`和with 运算符,`'hello'`和。解析器将首先尝试添加和。为此，它必须首先评估语句（评估为）。该运算符导致与字符串的连接，并强制所有原始变量也尝试将自己表示为字符串。 计算为创建语句的字符串。`'world'``+``?``:``"test: "``(1==2)``(1==2)``false``+``false``"false"``"test: false"`

解析器现在已准备好评估三元的第一部分：`"test: false"?`。在 Javascript 中，所有非空字符串都计算为`true`，通过三元运算符的测试并选择第一个选项`"hello"`。

通过在原始语句中添加一些额外的括号：

```
alert("test: " + ((1 == 2) ? 'hello' : 'world')); 
```

我们告诉解析器我们要在连接之前评估三元运算符。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-08-25T15:00:12.723

# 运算符优先级

所有运算符都有所谓的[优先级。](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Operator_Precedence)这就是语言决定[操作顺序的方式](https://en.wikipedia.org/wiki/Order_of_operations)。优先级较高的运算符将在优先级较低的运算符之前进行评估。操作顺序是允许表达式以正确顺序执行的原因。

例如，

```
1 + 2 * 3 == 1 + 6 == 7 
```

因为`*`具有比 更高的优先级`+`。没有优先权，你会得到

```
1 + 2 * 3 == 3 * 3 == 9 
```

* * *

## `+`对比`?:`

在 JavaScript 中，[`+`运算符的优先级高于`?:`运算符。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_Precedence#Table)这意味着连接将在评估三元组中的条件之前发生。这可能会导致一些奇怪的结果。

*注意：运算符的关联性和优先级可以在语言之间改变。例如，在 JavaScript 中，`?:`运算符是右关联的，但[在 PHP 中是左关联的](http://php.net/manual/en/language.operators.precedence.php)。这些相同的比较将在这些语言之间产生不同的结果。*

```
var variable, str;

// Equality operators have higher precedence than ?: but lower than +
// so the below expression breaks down like this:
//   ("A" + variable) !== undefined ? "B" : ("C" + "D")
//   "Aundefined" !== undefined ? "B" : "CD"
//   true ? "B" : "CD"
//   "B"
str = "A" + variable !== undefined ? "B" : "C" + "D";
console.log(str);

// For the same reason as above, you get a strange result here.
// Here's how we break it down:
//   ("A" + variable) === undefined ? "B" : ("C" + "D")
//   "Aundefined" === undefined ? "B" : "CD"
//   false ? "B" : "CD"
//   "CD"
str = "A" + variable === undefined ? "B" : "C" + "D";
console.log(str);
```

无论条件如何，都会发生同样类型的问题：

```
// Check for undefined
var animal;
// Expected: "The animal does not exist", actual: undefined
console.log("The animal " + animal === undefined ? "does not exist" : animal);

// Expected: "The animal undefined", actual: "does not exist"
console.log("The animal " + animal !== undefined ? "does not exist" : animal);

// Check for null
animal = null;
// Expected: "The animal does not exist", actual: null
console.log("The animal " + animal === null ? "does not exist" : animal);

// Expected: "The animal null", actual: "does not exist"
console.log("The animal " + animal !== null ? "does not exist" : animal);

// Check for property
animal = {};
// Expected: "This animal doesn't have a type", actual: undefined
console.log("The animal " + animal.hasOwnProperty('type') ? animal.type : "doesn't have a type");

animal.type = 'is a dog';
// Expected: "This animal is a dog", actual: "is a dog"
console.log("The animal " + animal.hasOwnProperty('type') ? animal.type : "doesn't have a type");
```

# 解决方案

使用这些相同的优先级规则，我们知道括号 ( `( ... )`) 具有任何其他运算符的最高优先级。通过在括号内对操作进行分组，将首先评估这些操作。这以递归方式工作，允许您在更深的括号集中进一步分组操作。

鉴于此，您可以在括号内编写三元表达式以获得所需的结果。

```
var animal;
console.log( "The animal " + (animal === undefined ? "does not exist" : animal) );
console.log( "The animal " + (animal !== undefined ? "does not exist" : animal) );

animal = null;
console.log( "The animal " + (animal === null ? "does not exist" : animal) );
console.log("The animal " + (animal !== null ? "does not exist" : animal) );

animal = {};
console.log( "The animal " + (animal.hasOwnProperty('type') ? animal.type : "doesn't have a type") );

animal.type = 'is a dog';
console.log( "The animal " + (animal.hasOwnProperty('type') ? animal.type : "doesn't have a type") );
```

一般来说，最好也将您的条件用括号括起来。这样，在使用较低优先级的运算符生成条件时，您将获得正确的值。

```
// Assignment without parentheses
var x = 0;
console.log( x += 2 ? 'x is 2' : 'x is not 2' );

// Assignment with parentheses
x = 0;
console.log( (x += 2) ? 'x is 2' : 'x is not 2' );
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-11T20:21:53.390

您需要添加一些额外的括号：

```
alert("test: " + ((1 == 2) ? "hello" : "world")); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-01-10T09:27:30.513

使用 ES6，您可以使用[Template Literals](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals)：

```
alert(`test: ${1 === 2 ? 'hello' : 'world'}`);
```

# javascript - javascript setTimeout和一堆圆圈的问题

> ID：12847856
> 
> 赞同：0
> 
> 时间：2012-10-11T20:20:38.353
> 
> 标签：javascript

我有一个我应该编写的小程序，它可以在画布上制作一个弹力球。我可以得到一个球弹跳的线框，但似乎根本无法触发 setTimeout。我已经阅读，阅读并阅读了有关该功能的信息，但无法弄清楚（新）。

```
<!DOCTYPE HTML>
<html>
   <head>
      <title>basic Canvas</title>
      <style>
         #canvas1{
            border:1px solid #9C9898;
         }
         body{
            margin:0px;
            padding:0px;
        }
      </style>
      <script>
         function drawMe(){
            //Set x,y,radius
            var x = 60;
            var y = 60;
            var radius = 70;
            drawLoop(x,y,radius);
         }

         function drawLoop(x,y,radius){
            var canvas2=document.getElementById("canvas1");
            var ctx=canvas2.getContext("2d");
            for(i=1;i<100;i++){

                    if(y + radius >= canvas2.height){
                        d = 1;
                    }
                    if(y - radius <= 0){
                        d = 0;
                    }
                    if (d==0){
                        x = x + 10;
                        y = y + 10;
                    }
                    else if (d==1){
                        x = x + 10;
                        y = y - 10;
                    }
                    draw(x,y,radius);
                    window.setTimeout(function() {draw(x,y,radius)},3000);
                }
         }

         function draw(x,y,radius){
                    var canvas2=document.getElementById("canvas1");
                    var ctx=canvas2.getContext("2d");

                    ctx.beginPath();
                    ctx.arc(x,y,radius,0,2*Math.PI,false);
                    var gradient = ctx.createRadialGradient(x, y, 1, x, y, radius);
                    gradient.addColorStop(0,"blue");
                    gradient.addColorStop(1,"white");
                    ctx.fillStyle=gradient;
                    ctx.lineWidth=1;
                    ctx.strokeStyle="blue";
                    ctx.fill();
                    ctx.stroke();
         }
      </script>
   </head>
   <body onload="drawMe()">
      <canvas id="canvas1" width=1000" height="400">

      </canvas>
   </body>
</html> 
```

一个名为“drawMe()”的小函数设置 x、y 和半径，然后调用一个小绘图循环，该循环触发 100 次以绘制弹力球（“drawLoop”）。在函数drawLoop的底部，我调用draw，它实际上绘制了圆圈。根据我的阅读，'setTimeout(function(){draw(x,y,radius)};,3000); 应该每三秒调用一次绘图函数。但事实并非如此。我到底做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:53:15.163

setTimeouts are counted from the time they are created. The loop runs almost instantly and creates the setTimeouts at almost the same time. They are then all ran 3 seconds later.

One way to get around this is in the solution below. This does not increment the loop until the current timeout has been completed. [http://jsfiddle.net/x8PWg/14/](http://jsfiddle.net/x8PWg/14/)

This is only one of the many potential solutions to this.

# javascript - javascript 不适用于 doctype

> ID：12847861
> 
> 赞同：0
> 
> 时间：2012-10-11T20:20:44.810
> 
> 标签：javascript, html, doctype

```
<!DOCTYPE html>
<html>
<head>

</head>
<body>
 <img src="nove.png" alt="" width="352" height="277" id="imageResize"  />
<div id="result"></div>
<script>

o = document.getElementById("imageResize");

o.style.padding = 500;
document.getElementById("result").innerHTML=o.style.width;
</script>

</body>
</html> 
```

这是简单的网页。在有和没有`<!DOCTYPE html>`. 为什么不一样？为什么 javascript 无法使用`<!DOCTYPE html>`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:24:23.673

CSS padding 属性的*长度*不是整数。

```
500 + 'px' 
```

如果没有 Doctype，浏览器将进入[Quirks 模式](http://en.wikipedia.org/wiki/Quirks_mode)并模拟古老的、有缺陷的浏览器，这些浏览器不强制执行规范的该部分。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-11T20:35:49.790

这很可能是浏览器的行为

首先，它正在工作，尝试提醒一些东西并且它有效

我不知道为什么其余代码在 HTML5 doctype 中不起作用但是当你删除 doctype 时，也许浏览器会尝试用其他实际适用于 js 代码的东西来弥补 html5 doctype

# android - Android: Bluetooth activity launch

> ID：12847862
> 
> 赞同：0
> 
> 时间：2012-10-11T20:20:47.297
> 
> 标签：android, bluetooth

I am building a piece of code that imitates an activity when the phone receives an active Bluetooth connection. This is to run as a service so it can be picked up on in the moment.

Here is the code I am working with. Right now its not launching the intent but its not failing either. How do I get this to run properly?

```
import android.app.Service;
import android.bluetooth.BluetoothDevice;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.IBinder;

public class detectService extends Service{

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

private BroadcastReceiver ConnectListener = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) 
    {
        String action = intent.getAction();
        if (BluetoothDevice.ACTION_ACL_CONNECTED.equals(action)) 
        {
                intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);
            //Start Second Activity
                Intent secondIntent = new Intent(detectService.this, otherClass.class);
                intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                startActivity(secondIntent);
        }
     }
};
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:33:32.970

您需要注册使用创建的接收器

```
registerReceiever(ConnectListener, intentFilter); 
```

在您的情况下，意图过滤器将是蓝牙连接过滤器，例如

```
IntentFilter intentFilter = new IntentFilter(BluetoothDevice.ACTION_ACL_CONNECTED); 
```

有关更完整的示例，请查看其他[帖子](https://stackoverflow.com/questions/4715865/how-to-programmatically-tell-if-a-bluetooth-device-is-connected-android-2-2)

# sql - SQL : Is it possible to break on two fields (ordered by one field)?

> ID：12847866
> 
> 赞同：0
> 
> 时间：2012-10-11T20:20:51.913
> 
> 标签：sql, formatting, sqlplus

I just started taking a database class and we're learning SQL.

I have a table that has several columns. The last two columns are the first name and the last name of a person. No two people have the same last name, and I want to sort the table by the person's name (first and last) and show something like :

```
Trainee FirstName || Trainee LastName || Trainer FirstName || Trainer LastName || 
AAA               || BB               || Tom               || Banks            ||
Test              || Test             ||                   ||                  ||
CCC               || DD               ||                   ||                  ||
Another           || PERSON           || Susan             || Lee              || 
```

... etc.

I can get it so the duplicate last names don't show up by doing : `break on lastname;` `select .... order by T.lastname,` but I can't figure out how to get the first names to not duplicate as well. Help would really be appreciated, I've looked around online and I've been able to do a lot of the other exercises, but I can't figure out how to do this one.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:30:58.710

您是否应该通过限制输出或首先防止重复项进入数据库来解决此问题？

如果您试图限制输出，请查看`DISTINCT`.`SELECT`

# android - OpenGL ES 1.0 Photoshop Overlay Blend On Opaque Texture For Android

> ID：12847869
> 
> 赞同：0
> 
> 时间：2012-10-11T20:21:06.403
> 
> 标签：android, opengl-es, photoshop

Is it possible to achieve the photoshop overlay blending mode with an opaque jpeg texture using just OpenGL ES 1.0?

I am aware this can be achieved with later versions of OpenGL ES on android but would like to support as early a version of OpenGL as possible for maximum compatibility and exposure on the android platform.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T21:30:27.663

我的想法可能不是。

Photoshop 将叠加公式定义为：

> 根据基色对颜色进行倍增或筛选。图案或颜色覆盖现有像素，同时保留基色的高光和阴影。基色不会被替换，而是与混合色混合以反映原始颜色的明暗。

所以你在这里真正得到的是两种独立的混合模式（乘法和屏幕），根据基础层颜色进行选择。我不知道有什么方法可以根据基础层颜色动态切换混合模式。

正如在[这个问题](https://stackoverflow.com/questions/818230/photoshop-blending-mode-to-opengl-es-without-shaders)中所回答的那样，即使在 OpenGL 中实现屏幕和乘法也不是一件容易的事，所以我怀疑有没有一种方法可以同时进行它们。

# firefox - JQuery UI dialog popup not clickable after closing and reopening in Firefox

> ID：12847875
> 
> 赞同：1
> 
> 时间：2012-10-11T20:21:25.810
> 
> 标签：firefox, user-interface, dialog, clickable

On a website I am working on, there is a popup that loads a user control. It has three textboxes and a button. The first time I open up the dialog box, it works just fine. But if a user closes and reopens it, it is no longer clickable. The dialog shows up, but nothing inside it is clickable.

This dialog box works just fine on IE, Chrome, and Safari when it is closed and reopened, but Firefox doesn't let you do anything when it is opened after a second time.

Here is my javascript code that opens it.

```
 var $dialogRSVPShortForm;

if( ($dialogRSVPShortForm == null)  ||  ($dialogRSVPShortForm == undefined) || ($dialogRSVPShortForm == "undefined") ) {
    $dialogRSVPShortForm = $j("<div id='rsvpShortFormDlgDivId'></div>")
        .load('/controls/RSVPForm/RSVPShortForm.aspx' + strQS + ' #content')
        .dialog({
            autoOpen: false,
            modal: true,
            draggable: false,
            resizable: false,
            width: 430,
            dialogClass: 'popUpContainer',
            title: $link.attr('title'),
            open: function () {
                jQuery('.ui-widget-overlay').bind('click', function () {
                    jQuery($dialogRSVPShortForm).dialog('close');
                })
            }
        });
    }
    else {
        $j("#rsvpShortFormDlgDivId").load('/controls/RSVPForm/RSVPShortForm.aspx' + strQS + ' #content');
 }
    $dialogRSVPShortForm.dialog('open');
     } 
```

Briefly, $dialogRSVPShortForm is assigned the new instance of the dialog box the first time the user opens the dialog. Any time after that, it goes to the else part and just opens it again, reloading the control rather than creating a new instance of the dialog. Creating an instance each time caused many problems in the past and we don't want to go back to doing that.

And here is the control that gets loaded in the dialog box.

```
 <h2>R.S.V.P. For Event</h2>
<table class="rsvpShortForm">
    <tr>
        <td class="label">
            <div class="required">*</div><label for="<%=txtEmail.clientID%>">Email</label>
        </td>
        <td class="field">
            <asp:TextBox ID="txtEmail" runat="server" TextMode="SingleLine" Width="230px"
            onFocus = "if (this.value == 'Email ex: my@email.com') {this.value = ''; this.style.color = '#000';}"
            onBlur = "if (this.value == '') {this.value = 'Email ex: my@email.com'; this.style.color = '#CCC';}"
            value = "Email ex: my@email.com" CssClass = "ghostText" TabIndex="1"/>
             <span class="errorMsg" id="errEmail" style="display: none">Email is required.</span>
            <span class="errorMsg" id="errLegitEmail" style="display: none">Email needs to be valid.</span>
        </td>
    </tr>
    <tr>
        <td class="label">
            <div class="required">*</div><label for="<%=txtPhone.clientID%>">Phone</label>
        </td>
        <td class="field">
            <asp:TextBox ID="txtPhone" runat="server" TextMode="SingleLine" Width="230px" onFocus="if (this.value == 'Phone Number (XXX)-XXX-XXXX') {this.value = ''; this.style.color = '#000';}"
            onBlur="if (this.value == '') {this.value = 'Phone Number (XXX)-XXX-XXXX'; this.style.color = '#CCC';}"
            value="Phone Number (XXX)-XXX-XXXX" CssClass="ghostText" TabIndex="2"/>
            <span class="errorMsg" id="errPhone" style="display: none">Phone is required.</span>
            <span class="errorMsg" id="errValidPhone" style="display:none">Valid phone number required.
            </span>
        </td>
    </tr>
    <tr>
        <td class="label">
            <label for="<%=txtCompany.clientID%>">Company</label>
        </td>
        <td class="field">
            <asp:TextBox ID="txtCompany" runat="server" TextMode="SingleLine" Width="230px" onFocus="if (this.value == 'Your Company') {this.value = ''; this.style.color = '#000';}"
            onBlur="if (this.value == '') {this.value = 'Your Company'; this.style.color = '#CCC';}"
            value="Your Company" CssClass="ghostText" TabIndex="3"/>
        </td>
    </tr>
    <tr>
        <td colspan="2">
            <div class="clearbutton"><input type="button" class="globalBTN" ID="btnSubmit" /></div>
     </td>
    </tr>
</table> 
```

I appreciate any help I can get.

# liferay - Liferay Error in Staging: MethodInvocationException

> ID：12847877
> 
> 赞同：1
> 
> 时间：2012-10-11T20:21:33.653
> 
> 标签：liferay, liferay-6, staging

I modified settings for a Community Site inside Liferay. Trying to poke and play with Liferay's CMS. Added this setting= Staging: Remote Live

And now I get this error:

> javax.servlet.jsp.JspException: org.apache.velocity.exception.MethodInvocationException: Invocation of method 'runtime' in class com.liferay.taglib.util.VelocityTaglib threw exception org.apache.jasper.JasperException: javax.servlet.ServletException: javax.servlet.jsp.JspException: ServletException in '/html/portlet/staging_bar/view.jsp': com.liferay.portal.NoSuchLayoutSetBranchException: No LayoutSetBranch exists with the key {groupId=13309, privateLayout=false, master=true} at VM_liferay.vm[line 91, column 24]

Can anyone help with what can I change programmatically to be able to get into the app again? I cannot even get to localhost:8080, it gives me this error.

I'm still using the default HSQL database.

think it might be related to this: [http://issues.liferay.com/browse/LPS-18606](http://issues.liferay.com/browse/LPS-18606)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T07:48:11.610

它看起来像我们前一段时间的那个。

网站在控制面板中修改设置后崩溃。经过一番调查，我们发现设置 branchingPublic=true 影响了这一点。

首先，找出您修改了哪个站点（社区）。例如它是“community1”。

在数据库中找到该站点的行：

```
SELECT * FROM group_ WHERE friendlyurl like '%community1%' 
```

并检查它在列中的设置：“排版”。我建议复制它们以进行备份。

我们已更改`branchingPublic=true`为`branchingPublic=false`. 并重新启动 Liferay 门户。

它有助于重新开始跑步。

尽管 Liferay Support 没有复制此内容，但我相信它可能会对您或其他人有所帮助。

如果这没有帮助，请尝试使用其他设置，也许其他一些会影响崩溃。最后，您可以尝试将它们全部删除。只是给你一个想法！

亲切的问候！

# scala - 这个主要方法定义正确吗？

> ID：12847881
> 
> 赞同：2
> 
> 时间：2012-10-11T20:21:40.720
> 
> 标签：scala

在下面的课程中，我的主要方法没有正确定义吗？当我尝试从 Eclipse 运行它时，我没有选择将它作为 scala 程序运行。当我删除时，`filesEnding(".txt")`我可以运行该程序。

```
object FileMatcher {

  private def filesHere = (new java.io.File(".")).listFiles()

  private def filesMatching(matcher: String => Boolean) = 
    for(file <- filesHere; if matcher(file.getName))
        yield file

  def filesEnding(query: String) = filesMatching(_.endsWith(query))

  def main(args:Array[String]) = {
      filesEnding(".txt")
  }

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T20:25:54.267

Main 必须返回类型`Unit`。但`filesEnding`不返回`Unit`，它返回文件。最简单的解决方法是删除 ，`=`因此该方法的返回值默认为`Unit`.

```
def main(args: Array[String]) {
// ...
} 
```

# c# - TFS 2012 API Set TeamSettings Programmatically

> ID：12847885
> 
> 赞同：6
> 
> 时间：2012-10-11T20:21:47.047
> 
> 标签：c#, tfs, tfs-sdk

Is it possible to set the TeamSettings Programmatically?

```
var teamConfig = _tfs.GetService<TeamSettingsConfigurationService>();
                var css = _tfs.GetService<ICommonStructureService4>();

                var configs = teamConfig.GetTeamConfigurationsForUser(new[] { _selectedTeamProject.Uri });
                var team = configs.Where(c => c.TeamName == "Demo").FirstOrDefault() as TeamConfiguration; 
```

The above code gives me the Team Configuration for the team Demo. Look at the TeamSettings, it contains the property BacklogIterationPath, CurrentIterationPath, IterationPaths. **How can these be set programmatically?**

![enter image description here](../Images/84d73ca0face556539ee4c93a7315bdb.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T23:51:48.517

我想我自己已经解决了。

```
 // Set up default team sprint date and time
        var teamConfig = _tfs.GetService<TeamSettingsConfigurationService>();
        var css = _tfs.GetService<ICommonStructureService4>();

        string rootNodePath = string.Format("\\{0}\\Iteration\\Release 1\\Sprint 1", _selectedTeamProject.Name);
        var pathRoot = css.GetNodeFromPath(rootNodePath);

        css.SetIterationDates(pathRoot.Uri, DateTime.Now.AddDays(-5), DateTime.Now.AddDays(7));

        var configs = teamConfig.GetTeamConfigurationsForUser(new[] { _selectedTeamProject.Uri });
        var team = configs.Where(c => c.TeamName == "Demo").FirstOrDefault();

        var ts = team.TeamSettings;
        ts.BacklogIterationPath = string.Format(@"{0}\Release 1", _selectedTeamProject.Name);
        ts.IterationPaths = new string[] { string.Format(@"{0}\Release 1\Sprint 1", _selectedTeamProject.Name), string.Format(@"{0}\Release 1\Sprint 2", _selectedTeamProject.Name) };

        var tfv = new TeamFieldValue();
        tfv.IncludeChildren = true;
        tfv.Value = _selectedTeamProject.Name;
        ts.TeamFieldValues = new []{tfv};

        teamConfig.SetTeamSettings(team.TeamId, ts); 
```

这设置，

```
1\. Iteration Start and Finish Date for an Iteration
2\. Backlog Iteration Path for the team Demo
3\. Sets up Iteration Paths for the team Demo
4\. Sets up the default Area Path for the team Demo 
```

HTH 干杯，塔伦

# ruby-on-rails - 在 Rails 中捕获 UTM 参数

> ID：12847889
> 
> 赞同：3
> 
> 时间：2012-10-11T20:21:56.697
> 
> 标签：ruby-on-rails, google-analytics, analytics

我试图在 URL 中捕获 UTM 参数以将源、活动等添加到用户帐户。
可悲的是，我似乎无法弄清楚如何捕捉这些参数。据了解，我关注博客文章[http://www.matthuggins.com/articles/tracking-new-user-registrations-by-source-search-terms](http://www.matthuggins.com/articles/tracking-new-user-registrations-by-source-search-terms)

因此，在我的应用程序控制器中，我有以下内容：

```
ApplicationController.class_eval do
  before_filter :capture_referrer

  protected
    def capture_referrer
      session[:referrer] = request.env['HTTP_REFERER'] if !session[:referrer]
    end
end 
```

在用户控制器的创建动作中

```
@user.referrer = session[:referrer] 
```

在用户模型本身：

```
 def set_traffic_source
  if self.referrer
    url = URI.parse(self.referrer)
    self.source ||= uri.host.downcase.gsub(/^www\./, '')
    self.traffic_keywords ||= search_termins(uri)
  end
end 
```

这一切都很好，可以捕获引用者 - 但我实际上想读出 URI 传递的 UTM。我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T20:34:07.787

用于`params`访问它们：

```
params[:utm_source]
params[:utm_campaign]
params[:utm_medium] 
```

# ruby-on-rails - 具有多个验证的重复闪存错误消息

> ID：12847893
> 
> 赞同：1
> 
> 时间：2012-10-11T20:22:01.147
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我目前正在使用以下代码验证我的模型：

```
validates :price, :presence => true, :numericality => {:greater_than => 0} 
```

这很好用，除了当我没有在此字段中输入任何值时，我得到 2 个错误 - “价格不能为空白”和“价格不是数字”。

我可以理解为什么会发生这种情况 - 显然它没有通过两项测试。但是我想知道是否有一种方法可以在一次测试后停止验证，因为如果根本没有数字，那么如果数字大于 0，就没有必要进行测试？

谢谢！

编辑：为了清楚起见，我不想让该字段为空白，我只是不想在它为空白时运行数值测试，以避免出现 2 个错误消息，因为实际上是 1 个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:28:58.633

不确定它是否会起作用，但您可以尝试：

```
validates :price, :presence => true, :numericality => {:greater_than => 0, :allow_blank => true } 
```

# jasper-reports - Sub-reports overlapping "Last Page Footer" band

> ID：12847895
> 
> 赞同：2
> 
> 时间：2012-10-11T20:22:06.057
> 
> 标签：jasper-reports, ireport, subreport

I have tried every combination of band configuration and layouts.

I have a master report and (currently) 2 *subreports*. The printout is a workorder and each work order must have X number of repair items and Y number of detailed parts used to repair the component. Sometimes there are only a few of each other times there are over 50 each.

Header of the report looks great. I have two bands where I place my *subreports*. Originally I had them both in the same band and specified the second *subreport* as "float" which resulted in the same effect as having each in separate bands.

The *subreports* display fine however on occasion the parts list will overlap the details I have specified in *Last Page Footer* band. This does not appear to happen when I place the labels in the *Summary* band however these labels are mostly boxes for signatures so alignment with the bottom of the page is required and summary seems to add labels and such at end of content.

Resizing the bands the *subreports* are in seems to work - kinda. However I need both *subreports* to start immediately after each other. So resizing bands isn't an option otherwise there is a bunch of white space between them and single page printing when only a few parts and repairs are selected does not happen.

Anyone have any ideas? Wisdom to share? Experience? This reminds me of working in HTML and sticky footers ugh :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-23T16:54:15.863

我知道这个问题已经很老了，但是由于我遇到了这个问题并且我已经找到了解决方案，所以我会将它发布给将来可能需要它的人。

就我而言，问题是我选中了**带有页眉和页脚的摘要**复选框。一旦我把它设为假，它就像一个魅力。

# java - Substring to remove everything before first period and after second

> ID：12847896
> 
> 赞同：0
> 
> 时间：2012-10-11T20:22:09.927
> 
> 标签：java, substring

So I have a filename that looks like this:

myFile.12345.txt

If I wanted to end up with just the "12345" how would I go about removing that from the filename if the 12345 could be anywhere between 1 and 5 numbers in length?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T20:23:32.647

`.`如果你确定肯定会有 2 个时期

```
String fileName = string.split("\\.")[1] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T20:44:18.957

你可以用这个

```
String s="ghgj.7657676.jklj";
String p = s.substring(s.indexOf(".")+1,s.lastIndexOf(".")); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T20:23:47.917

假设您要提取所有数字，您可以使用简单的正则表达式来删除所有非数字字符：

```
String s = "myFile.12345.txt";
String numbers = s.replaceAll("[^\\d]","");
System.out.println(numbers); //12345 
```

注意：它不适`file12.12345.txt`用于例如

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-11T20:24:48.007

```
static final Pattern P = Pattern.compile("^(.*?)\\.(.*?)\\.(.*?)$");
...
...
...
Matcher m = P.matcher(input);
if (m.matches()) {
  //String first = m.group(1);
  String middle = m.group(2);
  //String last = m.group(3);
  ...
} 
```

# django-models - Can't access model attribute from other model in Django

> ID：12847900
> 
> 赞同：0
> 
> 时间：2012-10-11T20:22:32.037
> 
> 标签：django-models

I need to access an attribute from a related model (to use as a filter attribute in an admin), but I get this error: `'EventTimeAdmin.list_filter[1]' refers to field 'event__sites' that is missing from model 'EventTime'.`

Here is are the relevant classes from models.py:

```
class Event(models.Model):
    title = models.CharField(max_length=100)
    short_description = models.CharField(max_length=250, blank=True)
    long_description = models.TextField(blank=True)
    place = models.ForeignKey(Place, related_name="events", default=0, blank=True, null=True)
    one_off_place = models.CharField('one-off place', max_length=100, blank=True)
    phone = models.CharField(max_length=40)
    cost_low = models.DecimalField('cost (low)', max_digits=7, decimal_places=2, blank=True, null=True)
    cost_high = models.DecimalField('cost (high)', max_digits=7, decimal_places=2, blank=True, null=True)
    age_lowest = models.PositiveSmallIntegerField('lowest age', blank=True, null=True, help_text='Use 0 for "all ages". Leave blank if no age information is available') # Not every event submits info about age limits
    priority = models.ForeignKey(EventPriority)
    ticket_website = models.URLField('ticket Web site', blank=True)
    posted_date = models.DateTimeField('date entered', default=datetime.datetime.now())
    updated_date = models.DateTimeField('date updated', editable=False, blank=True)
    small_photo = models.ImageField(upload_to='img/events/%Y', blank=True)
    teaser_text = models.TextField(max_length=1000, blank=True)
    is_ongoing_indefinitely = models.BooleanField(db_index=True, help_text="If this box is checked, the event won't be displayed by default in the event search. Users will have to manually select \"Display ongoing events\" in order to display it.")
    is_national_act = models.BooleanField('is a national marquee touring act')
    categories = models.ManyToManyField(EventCategory, related_name="events")
    bands = models.ManyToManyField(Band, related_name="events", blank=True)
    sites = models.ManyToManyField(Site)
    related_links = generic.GenericRelation(RelatedLink)
    generic_galleries = generic.GenericRelation(GalleryRelationsPiece)
    staff_photographer_attending = models.BooleanField('Staff Photographer will be attending')

    index = EventIndex()

    class Meta:
        ordering = ('title',)

    def __unicode__(self):
        return self.title

    def save(self, *args, **kwargs):
        self.updated_date = datetime.datetime.now()
        super(Event, self).save(*args, **kwargs)

    def get_absolute_url(self):
        if self.is_recurring():
            return reverse('ellington_events_ongoing_detail', args=[self.id])
        else:
            next = self.get_next_time()
            if next:
                return next.get_absolute_url()
            else:
                try:
                    last = self.event_times.order_by("-event_date", "start_time")[0]
                    return last.get_absolute_url()
                except IndexError:
                    return reverse('ellington_events_todays_events', args=[])

    @property
    def _sites(self):
        """A property used for indexing which sites this object belongs to."""
        return [s.id for s in self.sites.all()]

    # def start_time(self):
    #     return self.event_times.start_time

    # TODO: Redundant
    def get_absolute_url_recurring(self):
        "Returns the absolute URL for this event's recurring-event page"
        return reverse('ellington_events_ongoing_detail', args=[self.id])

    def is_recurring(self):
        """Returns ``True`` if this event is a recurring event."""
        return bool(self.recurring_event_times.count())

    def get_cost(self):
        "Returns this event's cost as a pretty formatted string such as '$3 - $5'"
        if self.cost_low == self.cost_high == 0:
            return 'Free'
        if self.cost_low == self.cost_high == None:
            return ''
        if self.cost_low == 0 and self.cost_high == None:
            return 'Free'
        elif self.cost_low == None and self.cost_high == 0:
            return 'Free'

        if self.cost_low == self.cost_high:
            cost = '$%.2f' % self.cost_low
        elif self.cost_low == 0 or self.cost_low == None:
            cost = 'Free - $%.2f' % self.cost_high
        elif self.cost_high == 0 or self.cost_high == None:
            cost = '$%.2f' % self.cost_low
        else:
            cost = '$%.2f - $%.2f' % (self.cost_low, self.cost_high)
        return cost.replace('.00', '')

    def get_age_limit(self):
        "Returns this event's age limit as a pretty formatted string such as '21+'"
        if self.age_lowest is None:
            return 'Not available'
        if self.age_lowest == 0:
            return 'All ages'
        return '%s+' % self.age_lowest

    def get_place_name(self):
        "Returns this event's venue, taking into account the one_off_place field."
        if self.one_off_place:
            return self.one_off_place
        if self.place is not None:
            return self.place.name
        else:
            return ""

    def get_next_time(self):
        """
        Return the next (in the future) ``EventTime`` for this ``Event``.
        Assumes the event is not recurring. Returns ``None`` if no next time is
        available.
        """
        now = datetime.datetime.now()
        for et in self.event_times.filter(event_date__gte=now.date()).order_by("event_date", "start_time"):
            try:
                dt = datetime.datetime.combine(et.event_date, et.start_time)
            except TypeError:
                return None
            if dt >= now:
                return et
        return None
        # TODO: proprietary
    def get_lj_category(self):
        """
        Returns either 'Nightlife', 'Music', 'Theater', 'Misc.' or
        'Museums and Galleries' for this event.
        """
        MAPPING = (
            ('Activities', 'Misc.'),
            ('Art', 'Museums and Galleries'),
            ('Children', 'Misc.'),
            ('Community', 'Misc.'),
            ('Culinary', 'Misc.'),
            ('KU calendar', 'Misc.'),
            ('Lectures', 'Misc.'),
            ('Museums', 'Museums and Galleries'),
            ('Performance', 'Misc.'),
        )
        # "Performance | Theater" is a special case.
        for c in self.categories.all():
            if str(c) == "Performance | Theater":
                return 'Theater'

        parent_categories = [c.parent_category for c in self.categories.all()]
        for parent_category, lj_category in MAPPING:
            if parent_category in parent_categories:
                return lj_category

        # Failing that, we must be in either 'Music', which can be either
        # 'Music' or 'Nightlife', depending on the venue.
        if self.one_off_place:
            return 'Music'

        # If it's downtown, it's 'Nightlife'. Otherwise, it's 'Music'.
        if "downtown" in self.place.neighborhood.lower():
            return 'Nightlife'

        return 'Music'

class EventTime(models.Model):
    event = models.ForeignKey(Event, related_name="event_times")
    event_date = models.DateField('date')
    start_time = models.TimeField(blank=True, null=True)
    finish_time = models.TimeField(blank=True, null=True)

    objects = EventTimeManager()

    def long_desc(self):
        return self.event.long_description

    # def sites(self):
    #     return self.event._sites

    # def sites(self):
    #     return self.event.sites

    # @property
    # def _sites(self):
    #     """A property used for indexing which sites this object belongs to."""
    #     return [s.id for s in self.event.sites.all()]

    # def _sites(self):
    #     """A property used for indexing which sites this object belongs to."""
    #     return [s.id for s in self.event.sites.all()]

    # def _sites(self):
    #     """A property used for indexing which sites this object belongs to."""
    #     return [s.id for s in event.sites.all()]

    class Meta:
        ordering = ('event_date', 'start_time')

    def __unicode__(self):
        return u"%s -- %s at %s" % (self.event.title, self.event_date.strftime("%m/%d/%y"), self.event.get_place_name())

    def get_absolute_url(self):
        year = self.event_date.strftime("%Y")
        month = self.event_date.strftime("%b").lower()
        day = self.event_date.strftime("%d")
        return reverse('ellington_events_event_detail', args=[year, month, day, self.event.id])

    def get_time(self):
        "Returns this event's time as a pretty formatted string such as '3 p.m. to 5 p.m.'"
        if self.start_time is not None and self.finish_time is not None:
            return '%s to %s' % (dateformat.time_format(self.start_time, 'P'), dateformat.time_format(self.finish_time, 'P'))
        elif self.start_time is not None:
            return dateformat.time_format(self.start_time, 'P')
        return 'time TBA'

    def get_part_of_day(self):
        """
        Returns a string describing the part of day this event time is taking
        place -- either 'Morning', 'Afternoon', 'Evening' or 'Night'.
        """
        if self.start_time is None:
            return 'Time not available'
        if 3 < self.start_time.hour < 12:
            return 'Morning'
        elif 12 <= self.start_time.hour < 18:
            return 'Afternoon'
        elif 18 <= self.start_time.hour < 21:
            return 'Evening'
        return 'Night'

    def is_in_the_past(self):
        return self.event_date < datetime.date.today()

    def happens_this_year(self):
        return datetime.date.today().year == self.event_date.year

    def get_other_event_times(self):
        "Returns a list of all other EventTimes for this EventTime's Event"
        if not hasattr(self, "_other_event_times_cache"):
            self._other_event_times_cache = [et for et in self.event.event_times.order_by("event_date", "start_time") if et.id != self.id]
        return self._other_event_times_cache

    # TODO: proprietary
    def get_weather_forecast(self):
        "Returns a weather.forecast.DayForecast object for this EventTime"
        try:
            from ellington.weather.models import DayForecast
        except ImportError:
            return None
        if not self.event.place.is_outdoors:
            raise DayForecast.DoesNotExist
        if not hasattr(self, "_weather_forecast_cache"):
            self._weather_forecast_cache = DayForecast.objects.get(full_date=self.event_date)
        return self._weather_forecast_cache

DAY_OF_WEEK_CHOICES = (
    (0, 'Sunday'),
    (1, 'Monday'),
    (2, 'Tuesday'),
    (3, 'Wednesday'),
    (4, 'Thursday'),
    (5, 'Friday'),
    (6, 'Saturday'),
) 
```

The thing is, `event__title` is accessed from `EventTimeAdmin`:

```
 class EventTimeAdmin(admin.ModelAdmin):
        list_display = ('event', 'event_date', 'start_time', 'finish_time','long_desc')
        list_filter = ('event_date','event__sites')
        search_fields = ('event__title', 'event_date')
        ordering = ('-event_date',)

        class Meta:
            model = EventTime 
```

But `event__sites` is not accessible... why is that?

Edit: You can see my attempts (commented out) to define `sites` in models.py above. None of these worked.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T06:06:20.033

`event__sites`是一个`ManyToManyField`

您可以尝试以下方法：

**管理员.py**

```
def get_sites(self):
   sites = self.event.sites.all()
   result = u''
   for site in sites:
       result = u'%s - %s' % (result, site.name) # unsure about NAME - is it a valid field of Sites Model?
   return result

get_sites.short_description = u'Sites'

class EventTimeAdmin(admin.ModelAdmin):
    list_filter = ('event_date', get_sites)

admin.site.register(EventTime, EventTimeAdmin) 
```

希望能帮助到你。

# sql - Oracle SQL，使用 &input 的 SELECT 子句

> ID：12847901
> 
> 赞同：2
> 
> 时间：2012-10-11T20:22:54.797
> 
> 标签：sql, oracle, plsqldeveloper

我有一个非常简单的查询

```
SELECT id FROM table where ID in &data 
```

当我运行此 SQL 时，系统会提示我输入一些值到`&data`.

我希望能够使用它来选择几个 id。即 &data = "11,12,13"

但后来我得到一个错误`ORA-00933`。

我试过了：

```
11,12,13
'11,12,13' -> ORA-01722
'11','12','13' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T20:26:53.003

尝试添加`()`：

```
SELECT id FROM table where ID in (&data) 
```

输入值应该是`'11,12,13'`

或尝试添加`('')`：

```
SELECT id FROM table where ID in (&data) 
```

输入值应该是`11,12,13`

# java - RegEx 模式不匹配 php，但在 c#/java/etc

> ID：12847903
> 
> 赞同：0
> 
> 时间：2012-10-11T20:23:04.467
> 
> 标签：java, php, regex

我对 php 中的正则表达式有疑问。

得到以下模式：`^\s*(\d{8})\s+(.+?)\s+(\d+,\d{2})\s.?\s(.*)$`

我的搜索字符串是这样的： ![搜索字符串示例](../Images/def6301f35ad48fecb98bf0946ea45bd.png) 12345678 这是一个带有一些特殊字符的产品描述，例如 ® 16,00 € 也许这里有一些文字

我使用这个 php 代码：

```
$regex = '/^\s*(\d{8})\s+(.+?)\s+(\d+,\d{2})\s.?\s(.*)$/';
echo preg_match($regex, $input); 
```

但是没有匹配！

java 或 c# 中的相同正则表达式模式有效！你能解释一下我做错了什么吗？

这里有一些在线正则表达式测试器：

PHP：[http ://regexp-evaluator.de/evaluator/d721ca1ed32d76db960262ba7298cff3/#ergebnis](http://regexp-evaluator.de/evaluator/d721ca1ed32d76db960262ba7298cff3/#ergebnis)

Java：[http ://www.regexplanet.com/advanced/java/index.html](http://www.regexplanet.com/advanced/java/index.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T20:29:31.597

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:28:00.593

如果不在多行模式下，$ 仅匹配完整字符串的结尾。如果 $input 中有换行符或更多数据，这可能是原因。在这种情况下，只需在最后的分隔符后面加上一个“m”。

此外，我想知道 (.+?) 是否正确。您是否尝试过 (.*) ？

BurninLeo

# java - 双击 JTree 节点并获取其名称

> ID：12847904
> 
> 赞同：10
> 
> 时间：2012-10-11T20:23:04.903
> 
> 标签：java, actionlistener, jtree

如何双击 JTree 节点并获取其名称？

如果我调用`evt.getSource()`它，返回的对象似乎是一个 JTree。我不能将它转换为 DefaultMutableTreeNode。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-11T20:30:19.907

From the [Java Docs](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTree.html)

> If you are interested in detecting either double-click events or when a user clicks on a node, regardless of whether or not it was selected, we recommend you do the following:

```
final JTree tree = ...;

MouseListener ml = new MouseAdapter() {
    public void mousePressed(MouseEvent e) {
        int selRow = tree.getRowForLocation(e.getX(), e.getY());
        TreePath selPath = tree.getPathForLocation(e.getX(), e.getY());
        if(selRow != -1) {
            if(e.getClickCount() == 1) {
                mySingleClick(selRow, selPath);
            }
            else if(e.getClickCount() == 2) {
                myDoubleClick(selRow, selPath);
            }
        }
    }
};
tree.addMouseListener(ml); 
```

To get the nodes from the `TreePath` you can walk the path or simply, in your case, use [`TreePath#getLastPathComponent`](http://docs.oracle.com/javase/7/docs/api/javax/swing/tree/TreePath.html#getLastPathComponent%28%29).

This returns an `Object`, so you will need to cast back to the required node type yourself.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-02-17T16:29:48.680

以下代码适用于我。

```
tree.addMouseListener(new MouseAdapter() {
        public void mouseClicked(MouseEvent e) {
            if (e.getClickCount() == 2) {
                DefaultMutableTreeNode node = (DefaultMutableTreeNode)
                       tree.getLastSelectedPathComponent();
                if (node == null) return;
                Object nodeInfo = node.getUserObject();
                // Cast nodeInfo to your object and do whatever you want
            }
        }
    }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-12T00:11:56.570

MadProgrammer 几乎涵盖了所有内容。要获取您可以调用的对象

```
DefaultMutableTreeNode selectedNode =
   ((DefaultMutableTreeNode)selPath.getLastPathComponent()).
   getUserObject(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-22T08:12:47.603

我的例子。我们可以检测到有延迟的双击。

```
public class TreeListener extends MouseAdapter{
    private JTree _Tree;
    private boolean singleClick  = true;
    private int doubleClickDelay = 300;
    private Timer timer;    

    public TreeListener(JTree tree)
    {
        this._Tree = tree;
        ActionListener actionListener = new ActionListener() {

            public void actionPerformed(ActionEvent e) {                
                timer.stop();
                if (singleClick) {
                    singleClickHandler(e);
                } else {
                    try {
                        doubleClickHandler(e);
                    } catch (ParseException ex) {
                        Logger.getLogger(ex.getMessage());
                    }
                }
            }
        }; 
        timer = new javax.swing.Timer(doubleClickDelay, actionListener);
        timer.setRepeats(false);
    }

    public void mouseClicked(MouseEvent e) { 
        if (e.getClickCount() == 1) {
            singleClick = true;
            timer.start();
        } else {
            singleClick = false;
        }
    }

     private void singleClickHandler(ActionEvent e) {
        System.out.println("-- single click --");
    }

     private void doubleClickHandler(ActionEvent e) throws ParseException {         
        System.out.println("-- double click -- id=");      

    }     
} 
```

# jsf-2 - JBoss 7.1.1Final 上的 J2EE 应用程序的性能问题

> ID：12847906
> 
> 赞同：2
> 
> 时间：2012-10-11T20:23:07.590
> 
> 标签：jsf-2, jboss7.x, jboss-weld

最近我们在 JBoss 7.1.1Final 上部署了 J2EE 应用程序。此应用程序使用 CDI（焊接实现）、JSF 2.1 (Mojarra)、Seam 3 和 Hibernate 4。当我们遇到更高的负载时，应用程序会变慢。即使在负载下降一点之后，响应能力仍然较差。在 8 核机器上 CPU 利用率约为 300%。所以看起来CPU不是瓶颈。我还检查了数据库或 IO 是否可能是瓶颈，但事实并非如此。还有足够的内存，JVM 在提供的 3GB 中最多使用 2GB。我真的不知道还能去哪里看。当服务器具有高 CPU 利用率时，我转储了使用 CPU 最多的线程，似乎 Weld 或 JSF 存在一些问题，以下是响应性较低时经常发生的一些线程转储：

```
 java.lang.Thread.State: RUNNABLE
    at java.lang.ThreadLocal.get(ThreadLocal.java:143)
    at org.jboss.weld.context.cache.RequestScopedBeanCache.isActive(RequestScopedBeanCache.java:37)
    at org.jboss.seam.faces.environment.SeamExternalContext$Proxy$_$$_WeldClientProxy.getInitParameter(SeamExternalContext$Proxy$_$$_WeldClientProxy.java)
    at javax.faces.component.UIComponent.popComponentFromEL(UIComponent.java:1944)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2218)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.doPostAddProcessing(UIComponentBase.java:1883)
    at javax.faces.component.UIComponentBase.setParent(UIComponentBase.java:400)
    at javax.faces.component.UIComponentBase$ChildrenList.add(UIComponentBase.java:2635)
    at javax.faces.component.UIComponentBase$ChildrenList.add(UIComponentBase.java:2607)
    at com.sun.faces.facelets.tag.jsf.ComponentSupport.addComponent(ComponentSupport.java:574)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.addComponentToView(ComponentTagHandlerDelegateImpl.java:311)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:211)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)
    at com.sun.faces.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:93)
    at com.sun.faces.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:86)
    at com.sun.faces.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:308)
    at com.sun.faces.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:367)
    at com.sun.faces.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:346)
    at com.sun.faces.facelets.impl.DefaultFaceletContext.includeFacelet(DefaultFaceletContext.java:199)
    at com.sun.faces.facelets.tag.ui.DecorateHandler.apply(DecorateHandler.java:145)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.applyNextHandler(DelegatingMetaTagHandler.java:137)
    at org.richfaces.view.facelets.html.BehaviorsAddingComponentHandlerWrapper.applyNextHandler(BehaviorsAddingComponentHandlerWrapper.java:53)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:195)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)

 java.lang.Thread.State: RUNNABLE
    at java.lang.Thread.currentThread(Native Method)
    at java.lang.ThreadLocal.get(ThreadLocal.java:143)
    at org.jboss.weld.bean.proxy.InterceptionDecorationContext.pop(InterceptionDecorationContext.java:43)
    at org.jboss.weld.bean.proxy.InterceptionDecorationContext.endInterceptorContext(InterceptionDecorationContext.java:93)
    at org.jboss.seam.faces.environment.SeamExternalContext$Proxy$_$$_WeldClientProxy.getInitParameter(SeamExternalContext$Proxy$_$$_WeldClientProxy.java)
    at javax.faces.component.UIComponent.pushComponentToEL(UIComponent.java:1860)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2200)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
    at javax.faces.component.UIComponentBase.doPostAddProcessing(UIComponentBase.java:1883)
    at javax.faces.component.UIComponentBase.setParent(UIComponentBase.java:400)
    at javax.faces.component.UIComponentBase$ChildrenList.add(UIComponentBase.java:2635)
    at javax.faces.component.UIComponentBase$ChildrenList.add(UIComponentBase.java:2607)
    at com.sun.faces.facelets.tag.jsf.ComponentSupport.addComponent(ComponentSupport.java:574)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.addComponentToView(ComponentTagHandlerDelegateImpl.java:311)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:211)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.applyNextHandler(DelegatingMetaTagHandler.java:137)
    at org.richfaces.view.facelets.html.BehaviorsAddingComponentHandlerWrapper.applyNextHandler(BehaviorsAddingComponentHandlerWrapper.java:53)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:195)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at com.sun.faces.facelets.tag.ui.DefineHandler.applyDefinition(DefineHandler.java:107)
    at com.sun.faces.facelets.tag.ui.CompositionHandler.apply(CompositionHandler.java:178)
    at com.sun.faces.facelets.impl.DefaultFaceletContext$TemplateManager.apply(DefaultFaceletContext.java:395)
    at com.sun.faces.facelets.impl.DefaultFaceletContext.includeDefinition(DefaultFaceletContext.java:366)
    at com.sun.faces.facelets.tag.ui.InsertHandler.apply(InsertHandler.java:112)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.applyNextHandler(DelegatingMetaTagHandler.java:137)
    at org.richfaces.view.facelets.html.BehaviorsAddingComponentHandlerWrapper.applyNextHandler(BehaviorsAddingComponentHandlerWrapper.java:53)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:195)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at com.sun.faces.facelets.tag.jsf.core.ViewHandler.apply(ViewHandler.java:182)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at com.sun.faces.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:93)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at com.sun.faces.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:86)

   java.lang.Thread.State: RUNNABLE
at java.lang.ThreadLocal$ThreadLocalMap$Entry.<init>(ThreadLocal.java:276)
at java.lang.ThreadLocal$ThreadLocalMap.set(ThreadLocal.java:443)
at java.lang.ThreadLocal$ThreadLocalMap.access$100(ThreadLocal.java:261)
at java.lang.ThreadLocal.setInitialValue(ThreadLocal.java:164)
at java.lang.ThreadLocal.get(ThreadLocal.java:150)
at org.jboss.weld.bean.proxy.InterceptionDecorationContext.push(InterceptionDecorationContext.java:58)
at org.jboss.weld.bean.proxy.InterceptionDecorationContext.startInterceptorContext(InterceptionDecorationContext.java:97)
at org.jboss.seam.faces.environment.SeamExternalContext$Proxy$_$$_WeldClientProxy.getInitParameter(SeamExternalContext$Proxy$_$$_WeldClientProxy.java)
at javax.faces.component.UIComponent.pushComponentToEL(UIComponent.java:1860)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2200)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.publishAfterViewEvents(UIComponentBase.java:2206)
at javax.faces.component.UIComponentBase.doPostAddProcessing(UIComponentBase.java:1883)
at javax.faces.component.UIComponentBase.setParent(UIComponentBase.java:400)
at javax.faces.component.UIComponentBase$ChildrenList.add(UIComponentBase.java:2635)
at javax.faces.component.UIComponentBase$ChildrenList.add(UIComponentBase.java:2607)
at com.sun.faces.facelets.tag.jsf.ComponentSupport.addComponent(ComponentSupport.java:574)
at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.addComponentToView(ComponentTagHandlerDelegateImpl.java:311)
at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:211)
at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)
at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
at com.sun.faces.facelets.tag.jsf.core.ViewHandler.apply(ViewHandler.java:182)
at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
at com.sun.faces.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:93)
at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
at com.sun.faces.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:86)
at com.sun.faces.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:308)
at com.sun.faces.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:367) 
```

任何想法可能是什么问题？

谢谢

# php - PHP 脚本抛出一个不可能的错误 - 在一台服务器上，而不是在另一台服务器上

> ID：12847907
> 
> 赞同：2
> 
> 时间：2012-10-11T20:23:08.853
> 
> 标签：php, object, webserver

我遇到了一个小错误，没有找到从哪里开始的提示......

> [2012 年 10 月 11 日 22:01:45] PHP 致命错误：在第 545 行的 /var/www/web1/html/inc/ProjectCache.php 中的非对象上调用成员函数 getVariableIndices()

听起来很简单，但这里是代码（带行号）

```
525 $itemData = $queryItems->fetchRows();
525 foreach ($questionData as $qData) {
526     $qp = QuestionPack::createWithData($qData, $itemData);
<snip>
538     $question = $qp->createGenerator(null);
539     if (!is_object($question)) {
540         trigger_error('Could not initialize generator ...', E_USER_WARNING);
541         continue;
542     }
543             
544     // Question variables
545     $vix = $question->getVariableIndices();
<snip>
597     $question->destroy();
598 } 
```

createGenerator() 方法应该总是返回一个对象。出于调试原因，我添加了后续的 IF 语句 - 永远不知道我的想法是否完全错误......

destroy 方法将一些实例变量（对其他对象的引用）设置为 null，以便垃圾收集器不会停留在循环引用中。

此问题仅发生在生产系统（Debian，PHP 5.3.3-7+squeeze14）上大约 10.000 个项目中的一个中。使用相同的脚本和数据库中的相同数据，我无法在我的 Windows 开发人员系统 (PHP 5.3.1) 上复制它。

我应该注意到，在脚本到达此语句之前，已经完成了数千次方法调用（大约 14 秒的处理时间，因为在此运行期间初始化了缓存）。

我现在最好的解释是，在几兆字节的 PHP 脚本中的任何地方，我都会触发缓冲区溢出或误导垃圾收集器，以便对象在仍在使用时被释放。但是，错误总是在同一个项目中触发，总是在同一行（如果我之前放置其他调试代码，它会随着这个语句移动）。这对我的想法来说听起来很不典型。

重新启动网络服务器（当然）没有帮助。删除以前的缓存文件也无济于事。这就是我卡住的地方。其他人觉得这很奇怪吗？任何有想法从哪里开始的人？

谢谢

BurninLeo

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T22:16:03.317

我相信我在 php 5.3.2 中解决了一个类似的奇怪问题，方法是通过添加禁用垃圾收集器：zend.enable_gc = Off 到 php.ini。（当然还有重新启动 apache 或任何正在解析 php 的应用程序服务器）

如果这不起作用，我建议将您的 phpinfo() 从工作服务器与有问题的服务器进行比较。最好将 linux 与 linux 或 windows 与 windows 进行比较。也许配置中的某些东西会跳出来。

我还将提高错误级别以包含通知。

最后我会在 $question 不是对象时使用 gettype 和 get_class 来查看它是什么。 [http://www.php.net/manual/en/function.gettype.php](http://www.php.net/manual/en/function.gettype.php) http://www.php.net/manual/en/function.get-class.php

发生错误时也可能调用 debug_backtrace。 [http://php.net/manual/en/function.debug-backtrace.php](http://php.net/manual/en/function.debug-backtrace.php)

祝你好运！

# vim - 维姆 绑定在终端中不起作用

> ID：12847922
> 
> 赞同：3
> 
> 时间：2012-10-11T20:23:45.530
> 
> 标签：vim, terminal

我有一个`nmap <A-k> :wincmd k<CR>`在 gui vim 中有效的映射，但在终端中无效。如何使此映射在终端模式下工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T21:15:18.130

许多终端无法“获取”`Alt`密钥，必须对其进行配置才能使其工作，而 Vim 自身的`Alt`密钥存在一些长期存在的问题。

我的建议是使用适用于任何地方的映射：GUI 和 CLI。`<leader>`非常适合，请参阅`:help leader`。

```
nnoremap <leader>k :wincmd k<CR> 
```

# c# - 如何使用 DRY 主体重构此 代码？

> ID：12847924
> 
> 赞同：-1
> 
> 时间：2012-10-11T20:23:47.513
> 
> 标签：c#, generics, dry

我有两个要使用泛型组合的功能。

```
 static public DataTable GetDataTable(SqlParameterHash parameters, string sql,
        string connectionString, CommandType commandType = CommandType.StoredProcedure)
    {
        var da = new SqlDataAdapter(sql, connectionString);
        da.SelectCommand.CommandType = commandType;
        da.SelectCommand.CommandTimeout = 0;

        foreach (SqlParameter Parameter in parameters)
        { da.SelectCommand.Parameters.Add(Parameter); }

        DataTable dt = new DataTable();
        da.Fill(dt);
        return dt;
    }

    static public DataSet GetDataSet(SqlParameterHash parameters, string sql,
        string connectionString, CommandType commandType = CommandType.StoredProcedure)
    {
        var da = new SqlDataAdapter(sql, connectionString);
        da.SelectCommand.CommandType = commandType;
        da.SelectCommand.CommandTimeout = 0;

        foreach (SqlParameter Parameter in parameters)
        { da.SelectCommand.Parameters.Add(Parameter); }

        DataSet ds = new DataSet();
        da.Fill(ds);
        return ds;
    } 
```

这就是我想出的：

```
 static private T GetDataX<T>(T container
        , SqlParameterHash parameters, string sql, string connectionString
        , CommandType commandType = CommandType.StoredProcedure
        ) where T : System.ComponentModel.MarshalByValueComponent, new()
    {
        var da = new SqlDataAdapter(sql, connectionString);
        da.SelectCommand.CommandType = commandType;
        da.SelectCommand.CommandTimeout = 0;

        foreach (SqlParameter Parameter in parameters)
        { da.SelectCommand.Parameters.Add(Parameter); }

        da.Fill(container); // ERROR: cannot convert from 'T' to 'System.Data.DataTable'
        return container;
    } 
```

但我得到了上面显示的错误。

如果我将容器更改为动态它会编译。但这似乎是一个黑客行为。结合这两个功能的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:38:31.967

您可以添加一个`Action`参数来为您想要支持的每种类型进行填充：

```
static private T GetDataX<T>(SqlParameterHash parameters, string sql, string connectionString, Action<T, SqlDataAdapter> fillAction, CommandType commandType = CommandType.StoredProcedure) 
    where T : System.ComponentModel.MarshalByValueComponent, new()
{
    SqlConnection connection = new SqlConnection(connectionString);
    connection.Open();

    SqlDataAdapter da = new SqlDataAdapter(sql, connection);
    da.SelectCommand.CommandType = commandType;
    da.SelectCommand.CommandTimeout = 0;

    foreach (SqlParameter Parameter in parameters)
    { da.SelectCommand.Parameters.Add(Parameter); }

    T container = new T();
    fillAction(container, da);
    da.SelectCommand.Parameters.Clear();
    return container;
} 
```

然后你可以根据这个编写你的其他方法：

```
static public DataTable GetDataTable(SqlParameterHash parameters, string sql,
        string connectionString, CommandType commandType = CommandType.StoredProcedure)
{
    return GetDataX<DataTable>(parameters, sql, connectionString, (dt, adapter) => { adapter.Fill(dt); }, commandType);
}

static public DataSet GetDataSet(SqlParameterHash parameters, string sql,
        string connectionString, CommandType commandType = CommandType.StoredProcedure)
{
    return GetDataX<DataSet>(parameters, sql, connectionString, (ds, adapter) => { adapter.Fill(ds); }, commandType);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:36:39.317

因为`DataSet`and`DataTable`是完全独立的类，并且您必须为`SqlDataAdapter.Fill`它们中的每一个使用不同的重载，您将无法使用泛型方法将您的两个方法简化为一个。但是，您可以使用一个方法来减少重复代码，该方法接受一个委托，该委托定义`SqlDataAdapter`在方法执行过程中如何处理。

```
public static DataTable GetDataSet(
    SqlParameterHash parameters, string sql, string connectionString,
    CommandType commandType = CommandType.StoredProcedure
)
{
    DataSet ds = new DataSet();
    UseDataAdapter(
       parameters, sql, connectionString,
       da => da.Fill(ds), commandType
    );
    return ds;
}

public static DataTable GetDataTable(
    SqlParameterHash parameters, string sql, string connectionString,
    CommandType commandType = CommandType.StoredProcedure
)
{
    DataTable dt = new DataTable();
    UseDataAdapter(
       parameters, sql, connectionString,
       da => da.Fill(dt), commandType
    );
    return dt;
}

public static void UseDataAdapter(
    SqlParameterHash parameters, string sql, string connectionString,
    Action<SqlDataAdapter> adapterAction,
    CommandType commandType = CommandType.StoredProcedure
)
{
    SqlConnection connection = new SqlConnection(connectionString);
    connection.Open();

    SqlDataAdapter da = new SqlDataAdapter(sql, connection);
    da.SelectCommand.CommandType = commandType;
    da.SelectCommand.CommandTimeout = 0;

    foreach (SqlParameter Parameter in parameters)
    { da.SelectCommand.Parameters.Add(Parameter); }

    adapterAction(da);

    da.SelectCommand.Parameters.Clear();
    return dt;
} 
```

# python - 在类外使用 wxPython 元素？

> ID：12847927
> 
> 赞同：1
> 
> 时间：2012-10-11T20:23:55.713
> 
> 标签：python, wxpython

我正在尝试用类外的 wx 元素做一些事情：

```
def doStuff(uselessVariableIsUseless):
    myListbox.Set(myList)

class myWindow(wx.Frame):
    def __init__(self, parent, id):
        myListbox = wx.ListBox(parent = self, pos = (320, 30), size = (300, 500)) 
```

我也尝试过全球化 myListbox 内部`def __init__()`，并使用`myWindow.myListbox`等，但我仍然得到`NameError: global name 'myListbox' is not defined`. 这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:26:52.703

您需要分配给以`self.myListbox`使其成为实例的属性。然后，您可以将实例传递给`doStuff`方法并通过以下方式访问它`<object>.myListbox`：

```
def doStuff(win):
    win.myListbox.Set(myList)

class myWindow(wx.Frame):
    def __init__(self, parent, id):
        self.myListbox = wx.ListBox(parent = self, pos = (320, 30), size = (300, 500))

my_win = myWindow(0, 0)
doStuff(my_win) 
```

# iphone - 模态视图的限制是什么？

> ID：12847928
> 
> 赞同：1
> 
> 时间：2012-10-11T20:24:04.480
> 
> 标签：iphone, objective-c, ios

我意识到我可以分层呈现模态视图。使用下面列出的选择器呈现多个模式视图时

> presentModalViewController：动画：

（结构的层次应该是A->B->C->D->F........）

假设我创建了很多模态视图，每个视图都有相当多的内容。我怎么知道我是否达到了内存的极限？如果应用程序处于“挂起”状态并收到内存不足警告。

如果用户重新启动应用程序会发生什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T01:03:18.440

处理一个模态视图控制器并放置另一个模态视图控制器的方法是仅对最后一个进行动画处理：

```
[self dismissModalViewControllerAnimated:NO];
[self presentModalViewController:controllerB
   animated:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:30:04.693

There's no limit of modal views (I'm not aware of it) - just memory. And you can't check if you have enough memory or not. System will tell you when you reach your limit with memory warning.

What do you mean with relaunch? Suspend & resume? If yes, nothing. Kill & fresh start? No modal views unless you present them again.

The best way to accomplish this task is to release all objects that can be recreated in A when you do display B. Release in B when you do display in C and so on. But it depends on what do you want to display in them (in other words, amount of memory used by each view controller).

# java - 如何在具有一组字符串的图形中移动

> ID：12847929
> 
> 赞同：-1
> 
> 时间：2012-10-11T20:24:18.630
> 
> 标签：java, algorithm, graph

我在让这段代码正常工作时遇到了一些麻烦。我应该获取一个单行文件并在图表中移动并输出特定输入数字的每个状态。 ![在此处输入图像描述](../Images/7844a92b70c3997b2a939c98266624b1.png)

示例文件将具有以下内容：开始；1个；0; 1个；1个；0; 1

输出将是：

输入 = 1; 状态 = ArraySet[开始]

输入 = 0; state = ArraySet[开始，接近]

输入 = 1; state = ArraySet[开始，结束]

输入 = 1; 状态 = ArraySet[开始]

输入 = 0; state = ArraySet[开始，接近]

输入 = 1; 状态 = ArraySet[开始，结束]

我完成了下面的代码。

```
public class NDFA {

  public static void main(String[] args) {

  Map<String, Map<String,Set<String>>> mainMap = new ArrayMap<String, Map<String,Set<String>>>();

  TypedBufferReader input = new TypedBufferReader("Enter Non-Deterministic Finite Automaton Description File: ");

  for (;;) {
     try {
          String line = input.readLine();
          StringTokenizer st = new StringTokenizer(line, ";");
          String  state = st.nextToken();

          Map<String,Set<String>> transitions = mainMap.get(state);

          transitions = new ArrayMap<String, Set<String>>();
          Set<String> stateSet = new ArraySet<String>();

          while (st.hasMoreTokens()) {
              String intStateInput = st.nextToken();
              String inputState = st.nextToken();
              stateSet.add(inputState);
              transitions.put(intStateInput, stateSet);
          }
        mainMap.put(state, transitions);
     } catch (EOFException e) { break;}
  }

//sort
List<String> mapList = new ArrayList<String>(mainMap.keys());
Collections.sort(mapList);
System.out.println("Non-Deterministic Finite Automaton");
for (String s : mapList) {
    Map<String, Set<String>> tempMap = mainMap.get(s);
    System.out.println(s + " transitions = " + tempMap.toString());
}

//Process one line file.
  TypedBufferReader oneLineInput = new TypedBufferReader("Enter start state/inputs file: ");

  try {
      String oneLine = oneLineInput.readLine();
      StringTokenizer st = new StringTokenizer(oneLine,";");
      String currentState = st.nextToken();
      System.out.println("Initial state = " + currentState);
      String inputNum = "";

      Set<String> inputSet;

             //stuck while storing inputNums in a set.
      while (st.hasMoreTokens()) {
          inputNum = st.nextToken();
          inputSet.add(inputNum);
          Map<String,Set<String>> transitions = mainMap.get(currentState);
          currentState = transitions.get(inputSet.values());
          System.out.println("input = " + inputNum + "; new state = " + currentState) ;
      }
      System.out.println("Final state = " + currentState);
  } catch (EOFException e) {}

  }

} 
```

我无法让当前状态输出任何正确的集合。我可以轻松验证输入数字，但从头到尾让我感到困惑，我无法输出正确的 ArraySet。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T21:28:19.970

我以前在 python 中做过类似的事情。不确定这是否对您的 java 有帮助。

```
>>> g = {}
>>> g['start'] = {1: ['start'], 0: ['start', 'near']}
>>> g['near'] = {1: ['end']}
>>> g['end'] = {}
>>> data = [1, 0, 1, 1, 0, 1]
>>> states = ['start']
>>> while data:
...     x = data.pop(0)
...     new_states = []
...     for s in states:
...         reach = g[s]
...         if x in reach:
...             new_states += reach[x]
...     states = list(set(new_states))
...     print states
...
['start', 'near']
['start', 'end']
['start']
['start', 'near']
['start', 'end'] 
```

# drupal - 按发布日期过滤节点

> ID：12847933
> 
> 赞同：1
> 
> 时间：2012-10-11T20:24:30.070
> 
> 标签：drupal, drupal-views

如何显示所有节点，但使用 Views 发布的最新节点除外？到目前为止，我只能按特定日期过滤它们，这不好。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T21:46:19.263

如果您可以按发布日期以降序对内容进行排序，您可以将 View pager offset 设置为 1 以排除第一个项目，即最新项目。

# python - Tornado IOStream.read_until_close 无法正常工作

> ID：12847937
> 
> 赞同：2
> 
> 时间：2012-10-11T20:24:55.420
> 
> 标签：python, networking, asynchronous, tornado

## 代码

使用 Tornado IOStream.read_until_close 读取 http 响应。

```
from tornado import ioloop
from tornado import iostream
import socket    

class Client(object):
    def __init__(self, domen, uri):
        self.uri = uri
        self.domen = domen

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0)
        self.stream = iostream.IOStream(s)

    def open(self):
        self.stream.connect((self.domen, 80), self.send_request)

    def on_chunk_read(self, chunk):
        print "chunk\n", chunk

    def on_close(self, res):
        print "res\n", res
        self.stream.close()
        ioloop.IOLoop.instance().stop()

    def send_request(self):
        self.stream.write(
            "GET %s HTTP/1.0\r\nHost: %s\r\n\r\n" % (self.uri,  self.domen))
        self.stream.read_until_close(self.on_close, self.on_chunk_read)

client = Client("www.google.com", "/")
client.open()

ioloop.IOLoop.instance().start() 
```

## 输出

```
res
HTTP/1.0 302 Found
Location: http://www.google.ru/
...
<HTML>
...
</HTML> 
```

## 文档[tornado.iostream](http://www.tornadoweb.org/documentation/iostream.html#tornado.iostream.IOStream.read_until_close)

```
read_until_close(callback, streaming_callback=None)
Reads all data from the socket until it is closed.

If a streaming_callback is given, it will be called with chunks of data as they 
become  available, and the argument to the final callback will be empty.

Subject to max_buffer_size limit from IOStream constructor if a 
streaming_callback is not used. 
```

## 结论

未调用代码'print "chunk\n", chunk'。调用回调，但未调用 streaming_callback。

是bug吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T06:06:34.903

我认为这不是一个错误，取决于流的长度，作为一个或块发送给你。

```
def on_chunk_read(self, chunk):
    print "chunk\n", len(chunk)

def on_close(self, res):
    print "res\n", len(res)
    self.stream.close()
    ioloop.IOLoop.instance().stop() 
```

1.one，重定向，只有标题的短内容。

```
client = Client("www.google.com", "/") 
```

输出

```
res
1279 
```

2.块，

```
client = Client("www.google.ru", "/")

chunk
4837
chunk
1418
chunk
1418
chunk
1418
...
chunk
1418
res
1093 
```

# url-rewriting - url 重写为外部 url

> ID：12847938
> 
> 赞同：4
> 
> 时间：2012-10-11T20:24:58.353
> 
> 标签：url-rewriting

我正在尝试使用 URL 重写和应用程序请求路由来重写到外部 URL。我设置了以下规则：

```
<rewrite>
  <rules>
    <rule name="RewriteExternal" enabled="true" stopProcessing="true">
      <match url="patternToMatch/(.*)" />
      <action type="Rewrite" url="http://100.100.100.100/{R:1}" appendQueryString="false" logRewrittenUrl="false" />
    </rule>
  </rules>
</rewrite> 
```

在规则中，“patternToMatch”是我试图匹配的模式，而 100.100.100.100 服务器是我试图重写的外部服务器（在我们的防火墙之外）。我已打开日志记录并看到模式匹配，URL 被适当地重写，但随后我看到 IP 地址为 100.100.100.100 的“ARR_WEBFARM_NOT_ROUTED”。然后该请求被重写回原始请求并且请求失败。

我知道对于内部重定向，我可以将内部服务器添加到网络场，但这不适用于外部服务器。是否可以重写到外部服务器？如果是这样，我如何绕过使用网络场并避免“ARR_WEBFARM_NOT_ROUTED”错误？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-23T21:24:47.780

仅供参考，我知道这很旧，但这是我的两分钱：**ARR_WEBFARM_NOT_ROUTED**可能是“误报”，因为在我的情况下，我有两个本地 IIS 站点，它们的反向代理规则相同，一个有效，一个无效。我认为这两个站点都有 ARR_WEBFARM_NOT_ROUTED 条目，因为它们都没有任何实际的网络场条目，只有外部站点（尽管我正在重写的站点也是本地 IIS 站点）。

此外，OP 说“重写”，这在我的工作和非工作站点日志中也是如此，这意味着它也可能不是确凿的证据。

原来我的问题实际上是 ARR 和 MVC 之间的冲突。我会认为 ARR 在 MVC 之前的管道中更高，但不知何故 MVC 插手并尝试路由原始的预重写 URL，从而导致 404。我不确定确切的原因，但一种解决方法是告诉 MVC 忽略重写 URL（在 global.asax.cs 或 RouteConfig.cs 中）：

```
routes.IgnoreRoute("rewrite_path_here/{*pathInfo}"); 
```

希望对某人有所帮助。

# sql - 对象数据源更新

> ID：12847942
> 
> 赞同：1
> 
> 时间：2012-10-11T20:25:15.590
> 
> 标签：sql, gridview, objectdatasource, templatefield

我有一个启用编辑的 gridview (CustomerDetails)。当我单击编辑按钮并更新 5/6 字段之一（我将所有字段更改为模板字段，然后将编辑模板设置为我不想编辑的字段的标签）时，我收到一个错误：

“ObjectDataSource 'ObjectDataSource1' 找不到具有参数的非泛型方法 'UpdateCustomerAddressZip'：CustomerID、CustomerAddressOne、CustomerAddressTwo、CustomerZip、original_CustomerID”

对象数据源代码是

```
 <asp:ObjectDataSource ID="ObjectDataSource1" runat="server" InsertMethod="InsertCustomer"
        OldValuesParameterFormatString="original_{0}" SelectMethod="CustomerDetails" UpdateMethod="UpdateCustomerAddressZip"
        TypeName="Enterprise.CustomerEntityLayer">
        <InsertParameters>
            <asp:Parameter Name="CustomerID" Type="Int32" />
            <asp:Parameter Name="CustomerAddressOne" Type="String" />
            <asp:Parameter Name="CustomerAddressTwo" Type="String" />
            <asp:Parameter Name="CustomerZip" Type="String" />
        </InsertParameters>
        <UpdateParameters>
        <asp:Parameter Name="CustomerID" Type="Int32" />
        <asp:Parameter Name="CustomerAddressOne" Type="String" />
        <asp:Parameter Name="CustomerZip" Type="String" />
        </UpdateParameters>
        <SelectParameters>
            <asp:ControlParameter ControlID="Gridview1" DbType="Int32" Name="CustomerID" PropertyName="SelectedValue" />
        </SelectParameters>
    </asp:ObjectDataSource> 
```

而我在实体层的方法是：

```
Public Function UpdateCustomerAddressZip(ByVal CustomerID As Integer, ByVal CustomerAddressOne As String, ByVal CustomerZip As Integer)
                Dim dt As New CustomerDataTable
                Dim C_row As CustomerRow = dt.NewCustomerRow

                    C_row.CustomerID = CustomerID
                    C_row.CustomerAddressOne = CustomerAddressOne
                    C_row.CustomerZip = CustomerZip

                Adapter.UpdateCustAddZip(CustomerID, CustomerAddressOne, CustomerZip)
            End Function 
```

随着 SQL 是

```
UPDATE Customer
SET CustomerAddressOne = @CustomerAddressOne,
CustomerZip = @CustomerZip
WHERE CustomerID=@CustomerID 
```

谁能告诉我哪里出错了？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T10:23:52.523

简单的答案：将**OldValuesParameterFormatString="original_{0}"** 更改为**OldValuesParameterFormatString="{0}"**

从错误中可以看出：

> “ObjectDataSource 'ObjectDataSource1' 找不到具有参数的非泛型方法 'UpdateCustomerAddressZip'：CustomerID、CustomerAddressOne、CustomerAddressTwo、CustomerZip、original_CustomerID”

还有一个附加参数：**original_CustomerID**

如果您想实现乐观并发，以确保您在数据库上执行的更新不会与其他人的更改发生冲突。

Scott Mitchell[在本教程中对它](http://www.asp.net/web-forms/tutorials/data-access/editing,-inserting,-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb)进行了精美的解释。为方便起见，我在这里报告相关部分：

> 使用向导配置 ObjectDataSource 的一个副作用是 Visual Studio 将 OldValuesParameterFormatString 属性设置为 original_{0}。此属性值用于包含正在编辑的数据的原始值，在两种情况下很有用：
> 
> *   如果在编辑记录时，用户能够更改主键值。在这种情况下，必须同时提供新的主键值和原始主键值，以便找到具有原始主键值的记录并相应更新其值。
>     
>     
> *   使用乐观并发时。乐观并发是一种确保两个同时用户不会覆盖彼此的更改的技术，并且是未来教程的主题。
>     
>     
> 
> OldValuesParameterFormatString 属性指示基础对象的原始值的更新和删除方法中的输入参数的名称。当我们探索乐观并发时，我们将更详细地讨论这个属性及其用途。然而，我现在提出它，因为我们 BLL 的方法不期望原始值，因此删除这个属性很重要。当数据 Web 控件尝试调用 ObjectDataSource 的 Update() 或 Delete() 方法时，将 OldValuesParameterFormatString 属性设置为默认值 ({0}) 以外的任何值都会导致错误，因为 ObjectDataSource 将尝试同时传入 UpdateParameters 或DeleteParameters 指定以及原始值参数。
> 
> 如果此时还不是很清楚，请不要担心，我们将在以后的教程中检查此属性及其实用性。**现在，只需确保从声明性语法中完全删除此属性声明或将值设置为默认值 ({0})。**
> 
> 注意：如果您只是简单地从设计视图的属性窗口中清除 OldValuesParameterFormatString 属性值，该属性将仍然存在于声明性语法中，但被设置为空字符串。不幸的是，这仍然会导致上面讨论的相同问题。因此，要么从声明性语法中完全删除该属性，要么从“属性”窗口将值设置为默认值 {0}。

**但是**，它也与[SqlDataSource.ConflictDetection 属性有关](http://msdn.microsoft.com/it-it/library/system.web.ui.webcontrols.sqldatasource.conflictdetection.aspx)

如前所述，仅当**ConflictDetection**设置为***CompareAllValues***时，应将附加参数添加到 Update Method 调用中（并且原始值的参数的确切名称取决于 OldValuesParameterFormatString 属性。）

> 默认情况下，**ConflictDetection**属性设置为***OverwriteChanges***，这意味着数据源控件将覆盖在数据源控件第一次从行中读取数据到更新行之间对数据行所做的任何更改。主键用于定位将要更新或删除的数据行，但不执行其他数据比较。但是，如果将数据源控件配置为使用 CompareAllValues 选项，则该控件将传递 Update 和 Delete 方法的 oldValues 集合中的原始数据，以便您可以编写逻辑以仅当这些值与当前值匹配时才更新或删除数据在数据存储中。匹配值表明数据自读取后未发生变化。

所以这对我来说并不完全清楚......似乎如果默认情况下 ConflictDetection 属性设置为 OverwriteChanges，则不应向 UpdateMethod 添加额外的 *original_{0}* 参数！

# ruby-on-rails-3 - 无法使用 postgres 在 Rails 3.2 中创建测试数据库

> ID：12847945
> 
> 赞同：5
> 
> 时间：2012-10-11T20:25:24.343
> 
> 标签：ruby-on-rails-3, unit-testing, rspec-rails, rails-postgresql, pg

这是一件极其奇怪的事情。我试图做一个简单的`rake db:test:clone`或创建的，无论我做什么，从清除 gemset 到尝试各种 database.yml 配置，我都会遇到最奇怪的错误：

```
LINE 1: CREATE DATABASE "tdt_test"0.0 
```

有没有人见过这样的东西？WTF 那是“0.0！？” 我正在运行 Rails 3.2、RSpec 和 pg gem 0.14.1

```
 04:15 PM ~/projects/dmvcs (feature/helpdesk) => RAILS_ENV=test rake db:create
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require': iconv will be deprecated in the future, use String#encode instead.
  Notice: for 10x faster LSI support, please install http://rb-gsl.rubyforge.org/
  PG::Error: ERROR:  syntax error at or near "0.0"
  LINE 1: CREATE DATABASE "tdt_test"0.0
                                    ^
  : CREATE DATABASE "tdt_test"0.0
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:654:in `async_exec'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:654:in `block in execute'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `block in log'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:653:in `execute'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:768:in `create_database'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:107:in `rescue in create_database'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:51:in `create_database'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:40:in `block (3 levels) in <top (required)>'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:40:in `each'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:40:in `block (2 levels) in <top (required)>'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
  /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `load'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `<main>'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/bin/ruby_noexec_wrapper:14:in `eval'
  /Users/jlippiner/.rvm/gems/ruby-1.9.3-p194@dmvcs/bin/ruby_noexec_wrapper:14:in `<main>'
  Couldn't create database for {"adapter"=>"postgresql", "encoding"=>"unicode", "database"=>"tdt_test", "username"=>"jlippiner", "pool"=>5, "password"=>nil}
  /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/test/unit.rb:167:in `block in non_options': file not found: db:create (ArgumentError)
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/test/unit.rb:146:in `map!'
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/test/unit.rb:146:in `non_options'
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/test/unit.rb:207:in `non_options'
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/test/unit.rb:52:in `process_args'
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/minitest/unit.rb:891:in `_run'
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/minitest/unit.rb:884:in `run'
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/test/unit.rb:21:in `run'
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/test/unit.rb:326:in `block (2 levels) in autorun'
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/test/unit.rb:27:in `run_once'
    from /Users/jlippiner/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/test/unit.rb:325:in `block in autorun' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T21:35:55.927

这是一种特殊情况，但它可能对其他人有所帮助。

原来该死的分类器 gem 正在重写 Array.sum 方法。一旦我删除它，一切都很好。

# jquery - 在 Accordion 和外部上传按钮中使用 Uploadify

> ID：12847946
> 
> 赞同：0
> 
> 时间：2012-10-11T20:25:35.000
> 
> 标签：jquery, flash, accordion, uploadify

我有一个带有 3 个元素的 jQuery UI Accordion 和第一个元素上的 uploadify 上传按钮。Uploadify 的 Auto 选项设置为 false，因此 uploadify 仅在调用 startupload 时上传。

现在开始上传的按钮位于手风琴的第二个元素上。

当我按下它时，我在开发人员控制台中收到错误“调用 StartUpload 失败”。

我认为这是由于手风琴隐藏了第一个元素，里面有 flash 上传按钮，并且 flash 在隐藏时停止工作。

那么有什么方法可以使这种情况起作用吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:55:17.407

`startUpload`不是上传的方法，它是一种方法，`SWFUpload`因此您不能直接从“上传”输入组件中调用它。

（我认为您在实际代码中的拼写是正确的。它既不是startupload，也不是StartUpload。）

在第 531 行（jquery.uploadify.js v3.2）的某处，您可以阅读以下内容：

```
 var $this        = $(this),
       swfuploadify = $this.data('uploadify');

   ...

   swfuploadify.startUpload(); 
```

相反，如果您想为正在排队的文件激活上传，您可以调用

```
$('#file_upload').uploadify('upload'); 
```

详情：[http ://www.uploadify.com/documentation/uploadify/upload/](http://www.uploadify.com/documentation/uploadify/upload/)

导致这个问题的不是 jQuery UI 手风琴控件。在我们的项目中，我们在对话框、手风琴中使用了这个控件，没有任何问题。

顺便说一句，我建议你也看看这个补丁： [https ://stackoverflow.com/a/11918925/1268910](https://stackoverflow.com/a/11918925/1268910)

# c# - 获取出口 在 MEF 中不返回 AllowMultiple = True 的元素

> ID：12847947
> 
> 赞同：0
> 
> 时间：2012-10-11T20:25:35.637
> 
> 标签：c#, export, mef, containers, ioc-container

我不确定 MEF 是如何工作的。我创建了一个自定义属性`AllowMultiple=true`。这里是：

```
public interface IQuestionFactoryMetadataView
{
    IQuestionFactoryMetadata[] Metadatas { get; }
}

public interface IQuestionFactoryMetadata
{
    Levels Difficulty { get; }
    int Quantity { get; }
}

[MetadataAttribute]
[AttributeUsage(AttributeTargets.Class, AllowMultiple = true)]
public class ExportQuestionFactoryAttribute : ExportAttribute, IQuestionFactoryMetadata
{
    public ExportQuestionFactoryAttribute(Type type, Levels difficulty, int quantity)
        : base(type.Namespace, typeof(IQuestionFactory))
    {
        this.Difficulty = difficulty;
        this.Quantity = quantity;
    }

    public Levels Difficulty { get; private set; }
    public int Quantity { get; private set; }
}

// 
[ExportQuestionFactory(typeof(NonConcreteQuestionFactory), Levels.Beginner, 10)]
[ExportQuestionFactory(typeof(NonConcreteQuestionFactory), Levels.Medium, 20)]
[ExportQuestionFactory(typeof(NonConcreteQuestionFactory), Levels.Expert, 30)]
[ExportQuestionFactory(typeof(NonConcreteQuestionFactory), Levels.Master, 40)]
public class NonConcreteQuestionFactory : QuestionTemplateFactory
{
    ...
} 
```

如果我使用弱类型元数据，我的导出会突然得到满足：

```
 var exports = container.GetExports<IQuestionFactory, IDictionary<string, object>>(typeof(PEMDAS.Core.TimesTables.WorksheetTemplate).Namespace); 
```

但是如果我使用强类型，我的导出变量是空的。

```
 var exports = container.GetExports<IQuestionFactory, IQuestionFactoryMetadataView>(typeof(PEMDAS.Core.TimesTables.WorksheetTemplate).Namespace); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T02:21:46.103

我没有看到 QuestionFactoryMetadataView 你能显示那种类型吗？

做

```
var exports = container.GetExports<IQuestionFactory, IQuestionFactoryMetadata>(...) 
```

工作？

# c# - 使用反射 C# 的常见 CRUD 函数

> ID：12847952
> 
> 赞同：0
> 
> 时间：2012-10-11T20:25:55.997
> 
> 标签：c#, mysql, system.reflection

这是我的情况，我必须创建一个用于将值插入 MySQL 数据库的通用函数。到目前为止，我有以下方法。当另一个类中没有复合类时，此代码可以正常工作。如果我们在实体中有导航属性，那么这段代码就会中断，我就被困在这里了。

（ ORM - 我们不能使用它，因为它的客户要求）

```
public string create(object entity){
    var sql = new OdbcCommand();
        var d = new StringDictionary();
        var dd = new StringDictionary();
        try
        {
            var objectType = entity.GetType();
            var properties = objectType.GetProperties();
            var tableName = objectType.GetCustomAttributes(false).Select(x => (x as TableAttribute).Name).FirstOrDefault();
            foreach (var prop in properties)
            {
                if (prop.DeclaringType != typeof (BasicRequest)) // BasicRequest is base class
                {
                    if (
                        prop.GetCustomAttributes(false).Where(y=>y is ColumnAttribute).Select(x => (x as ColumnAttribute)).FirstOrDefault().IsPrimaryKey)
                    {
                        continue;
                    }
                    if (prop.PropertyType.IsGenericType) // here comes the problem
                    {
                        // the problem is if a class has List of its child 
                          objects then how to insert them since here parent 
                          is not yet inserted.
                    }
                    if (prop.GetCustomAttributes(false).Where(y => y is ColumnAttribute).Select(x => (x as ColumnAttribute)).FirstOrDefault().IsParent)
                    {
                         // same problem here also but this time this object is
                         parent object of the entity
                        /*parentObject = prop.GetValue(entity, null);
                        CreateNew(parentObject);
                        */

                        continue;
                    }
                    d[prop.GetCustomAttributes(false).Where(y => y is ColumnAttribute).Select(x => (x as ColumnAttribute).Name).FirstOrDefault()] = DBUtil.FixSQLString(Convert.ToString(prop.GetValue(entity, null)));
                }
                else
                {
                    continue;
                }
            }
            Connection coxn = ConnectionPool.GetInstance().GetCoxn(Constants.MyName,ConnectionPool.WriteServer,"db_name");
            sql.Connection = coxn.odbcConnection;
            sql.CommandType = CommandType.Text;
            sql.CommandText = DBUtil.CreateInsert(tableName, d);
            int affected = sql.ExecuteNonQuery();

            if (affected != 1)
            {
                ErrorMessage = "Insert Failed Unexpectedly";
                return "0";
            }
            return "1";

        }
        catch (Exception ex)
        {
            ErrorMessage = ex.Message;
            return "0";
        }
} 
```

让我们来一个实体（这种设计不在我手中，这些类已经存在我无法更改这个实体）

```
[Table(Name="person")]
public class Person
{
    [Column(Name="id",IsPrimaryKey=true)] // Column is my custom attribute
    public int Id{get;set;}
    [Column(Name="name",IsPrimaryKey=true)]
    public string Name{get;set;}
   // this is where i'm not able get it how do i insert
   // child class with the function i wrote above 
    [Column(IsChild=true)]
    public List<Contact> contact{get;set;} // Navigation property
    //Same problem with this property also 
    // how do i do insert for parent
    [Column(IsParent=true)]
    public User user{get;set;}

}

// i'll call that insert method as
Common c = new Common();
c.Create(Person p); // p will be passed as argument from controller 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:52:27.630

请允许我建议使用 micro-orm，而不是手写所有这些功能。

我会推荐[Dapper](http://code.google.com/p/dapper-dot-net/)或[PetaPoco](http://www.toptensoftware.com/petapoco/)（您可以将它们作为单个文件添加到您的应用程序中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:53:37.343

看起来您正在尝试创建自己的 ORM 实现。这将非常复杂，绝对不值得为客户项目付出努力。

您可以使用代码生成工具从数据库结构生成数据访问层。例如CodeSmith [http://www.codesmithtools.com/ 。](http://www.codesmithtools.com/)

# facebook - “FBRequest requestForMe”无法识别的选择器

> ID：12847953
> 
> 赞同：1
> 
> 时间：2012-10-11T20:25:56.653
> 
> 标签：facebook, ios6

第一次发帖。

昨天（2012 年 10 月 10 日）刚刚下载了 FB iOS SDK

[我已经完成了https://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/3.1/](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/3.1/)中列出的入门步骤

我正在尝试调用 [FBRequest requestForMe]

作为此测试代码的一部分

```
if (FBSession.activeSession.isOpen) 
    {
        [[FBRequest requestForMe]startWithCompletionHandler:^(FBRequestConnection *connection, id result, NSError *error) {}];
    } 
```

测试代码在现有项目中实现。代码编译/构建良好；没有链接器错误。它位于通过按下按钮打开的视图控制器内的 viewDidAppear 方法中。

我在 [FBRequest requestForMe] 调用中收到此运行时错误：[FBRequest requestForMe]: unrecognized selector sent to class 0x667bb0 0x667bb0 is FBRequest。

我确信我可以提供更多信息，我不确定还有什么帮助。让我知道，我会回复。

问题：什么会使 requestForMe 选择器无法识别，知道编译和链接根本不会抱怨该行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T01:57:45.490

所以，我的第一篇文章很棒……我正在处理的遗留代码有 Facebook 的先前实现。它已经有一个 FBRequest.h/m。不知何故，链接器感到困惑，但从未对我大喊大叫？

我从构建目标中删除了旧的 FBRequest 文件，现在一切都很好。谢谢阅读！

# java - 如何使用反射从 POJO 中获取属性名称和值？

> ID：12847954
> 
> 赞同：7
> 
> 时间：2012-10-11T20:25:56.323
> 
> 标签：java, json, generics, reflection

所以我正在编写一个“POJO to JSON”转换器。我希望能够传入一个`List<T>`对象并转换为 JSON。

希望这会有意义

```
/**
 *
     * NOT COMPLETE!!!  OBVIOUSLY!!!
 */
public abstract class Jsonator<T> implements Serializable {

    private Class<T> entityClass;
    private JSONObject json;
    private JSONArray jsonArray;

    public Jsonator(Class<T> entityClass) {
        this.entityClass = entityClass;
    }

    public void convert(List<T> paObjectList) throws IllegalArgumentException, IllegalAccessException {
        json = new JSONObject();
        jsonArray = new JSONArray();

        try {

            for (Object obj : paObjectList) {
                JSONObject objJson = new JSONObject();

                Class<?> kls = obj.getClass();

                Field[] fields = kls.getFields();
                for (Field field : fields) {
                    objJson.put(field.getName(), (T) field.get(obj));
                }

                jsonArray.add(objJson);
            }

            json.put("results", jsonArray);

        }
        catch (Exception ex) {
        }
    }

    public String error() {
        return "ERROR";
    }

    public String results() {
        if (json != null) {
            return json.toJSONString();
        }

        return "[]";
    }
} 
```

当我到达该`Object obj`部分时，我`obj`是正确的。我可以调试它并查看类的名称和值。

假设这个类是这样的：

```
public class User {
    private firstName;
    private lastName;

    ... getters....setters....etc...

} 
```

所以现在，`obj`是一个站点。好的，然后我尝试获取字段名称（firstName，lastName），但字段对象为空。

我究竟做错了什么？

谢谢

**编辑**

我让它工作了！这不是完成的代码，但它正在做我现在想要的。我读过谷歌和杰克逊也会这样做。如果有人可以提供一个关于如何从 POJO 中选择性地选择属性的良好链接，那么我会全神贯注。

或者更好的是，我想知道**为什么**我不应该这样做，这样？

谢谢！

**Jsonator（未完成）**

```
import java.io.Serializable;
import java.lang.reflect.Field;
import java.util.List;
import org.json.simple.JSONArray;
import org.json.simple.JSONObject;

/**
 *
 * @author Cecil.Meeks
 */
public abstract class Jsonator<T> implements Serializable {

    private Class<T> entityClass;
    private JSONObject json;
    private JSONArray jsonArray;

    public Jsonator(Class<T> entityClass) {
        this.entityClass = entityClass;
    }

    public void convert(List<T> paObjectList) throws IllegalArgumentException, IllegalAccessException {
        json = new JSONObject();
        jsonArray = new JSONArray();

        try {

            for (Object obj : paObjectList) {
                JSONObject objJson = new JSONObject();

                Class<?> kls = obj.getClass();

                Field[] fields = kls.getDeclaredFields();
                for (Field field : fields) {
                    field.setAccessible(true);
                    objJson.put(field.getName(), field.get(obj));
                }

                jsonArray.add(objJson);
            }

            json.put("results", jsonArray);

        }
        catch (SecurityException ex) {
            ex.printStackTrace();
        }
        catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public String error() {
        return "ERROR";
    }

    public String results() {
        if (json != null) {
            return json.toJSONString();
        }

        return "[]";
    }
} 
```

**站点类**

```
import java.io.Serializable;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Table;
import org.hibernate.annotations.GenericGenerator;

@Entity
@Table(name = "Sites")
public class Site implements Serializable {

    private String siteKey;
    private String site;
    private String siteType;
    private String address1;
    private String address2;
    private String city;
    private String zipCode;
    private String createdBy;
    private String glCode;

    public Site() {
    }

    @Id
    @GenericGenerator(name = "generator", strategy = "guid", parameters = {})
    @GeneratedValue(generator = "generator")
    public String getSiteKey() {
        return siteKey;
    }

    public void setSiteKey(String siteKey) {
        this.siteKey = siteKey;
    }

    @Column(name = "Site", unique = true, length = 125, nullable = false)
    public String getSite() {
        return site;
    }

    public void setSite(String site) {
        this.site = site;
    }

    @Column(name = "SiteType", unique = false, length = 8, nullable = true)
    public String getSiteType() {
        return siteType;
    }

    public void setSiteType(String siteType) {
        this.siteType = siteType;
    }

    @Column(name = "Address1", unique = false, length = 125, nullable = true)
    public String getAddress1() {
        return address1;
    }

    public void setAddress1(String address1) {
        this.address1 = address1;
    }

    @Column(name = "Address2", unique = false, length = 125, nullable = true)
    public String getAddress2() {
        return address2;
    }

    public void setAddress2(String address2) {
        this.address2 = address2;
    }

    @Column(name = "City", unique = false, length = 125, nullable = true)
    public String getCity() {
        return city;
    }

    public void setCity(String city) {
        this.city = city;
    }

    @Column(name = "ZipCode", unique = false, length = 50, nullable = true)
    public String getZipCode() {
        return zipCode;
    }

    public void setZipCode(String zipCode) {
        this.zipCode = zipCode;
    }

    @Column(name = "CreatedBy", unique = false, length = 125, nullable = true)
    public String getCreatedBy() {
        return createdBy;
    }

    public void setCreatedBy(String createdBy) {
        this.createdBy = createdBy;
    }

    @Column(name = "GLCode", unique = false, length = 11, nullable = true)
    public String getGlCode() {
        return glCode;
    }

    public void setGlCode(String glCode) {
        this.glCode = glCode;
    }

} 
```

**例子**

```
public class SiteJsonator extends Jsonator<Site> {

    public SiteJsonator() {
        super(Site.class);
    }

}

@Controller
@RequestMapping(value = "/sites")
public class SitesController {

    @Autowired
    private SiteService siteService;

    @RequestMapping(value = "/", method = RequestMethod.GET, headers = "Accept=application/json")
    @ResponseBody
    public String index(ModelMap map) {

        SiteJsonator list  = new SiteJsonator();;
        try {
            list.convert(siteService.getAll());
            return list.results();
        }
        catch (Exception ex) {
            return list.error();
        } 
    }
} 
```

**更新 2**

`Jsonator`对于那些感兴趣的人来说，这里是更好的：

[https://gist.github.com/3893242](https://gist.github.com/3893242)

您可以传入一个“排除” String[] 并且它不会包含那些。另外，它有一个标准的“结果、消息等”，我们喜欢在我们的 AJAX 请求中传递回去。适合 ExtJS。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T20:38:44.167

您需要使用[`#getDeclaredFields()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getDeclaredFields%28%29)包含私有字段，[`#getFields()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getFields%28%29)仅列出公共字段。

对于`private`字段，您还会遇到访问限制问题，因此您可能还想研究该[`Field#setAccessible()`](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/AccessibleObject.html#setAccessible%28boolean%29)方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:43:59.903

Instead of kls.getfields you could need to use kls.getDeclaredFields() . And if Jason object is your concern I had recommend you a Jackson Codhaus library . In which you can get or set JsonString from your POJO... HTH

# sql - 使用暂存表更新多列避免暂存表中的空值

> ID：12847955
> 
> 赞同：2
> 
> 时间：2012-10-11T20:25:58.570
> 
> 标签：sql, oracle, sql-update

我想从 Table1 表中更新 Table2 表中的多个列。临时表中可能有空值。我只想更新在 Table1 表中具有值的数据 - 而不是 NULL 值。

请指教

例如

```
Table 1                             Table 2
ID    col11   col2     col3         ID1      col1       col2       col3
3     test    xxxx     (null)       3        (null)   jjj        ffffff
5     (null)  yyyyy    zzzzzz       5        dddd     (null)     lllllllll 
```

输出

```
ID      col1      col2      col3
3        test     xxxx      ffffff
5        dddd     yyyyy     zzzzzz 
```

如果表 1 中的值为空，则不应更新表 2 中的值。

我现在的做法是

```
UPDATE  Table2 
SET ( col1 ,col2,col3)  
      =  (SELECT NVL(col1 ,col11), NVL(col2,col22), NVL(col3,col33)  
          FROM Test1  
          WHERE ID = ID1 ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:35:48.680

`COALESCE`使用暂存值和现有目标值更新每一列，假设列是相同或相似的类型。

这与这个简单的案例没有什么不同`NVL`，尽管有一些[差异](https://stackoverflow.com/questions/950084/oracle-differences-between-nvl-and-coalesce)值得了解，尤其是可移植性，在更复杂的案例中，还有性能。

虽然每列都在技术上进行更新对您来说似乎很浪费，但事实并非如此。一旦更新数据库行，就会产生成本。您可以使用动态 SQL 进行更复杂的查询，该查询会执行多次更新，每个可能的列组合都更新一次，但该解决方案会非常慢，而且显然更难维护。

# ruby - 在 Ruby 中显示 HTTP 请求的标头和正文文本

> ID：12847956
> 
> 赞同：11
> 
> 时间：2012-10-11T20:25:59.210
> 
> 标签：ruby, request

我确信这很容易，但我已经进行了相当广泛的搜索，但无法找到答案。我`Net::Http`在 Ruby 中使用该库，并试图弄清楚如何显示 HTTP GET 请求的完整主体？类似于以下内容：

```
GET /really_long_path/index.html?q=foo&s=bar HTTP\1.1
Cookie: some_cookie;
Host: remote_host.example.com 
```

我正在寻找原始的**REQUEST**，而不是要捕获的**RESPONSE 。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-11T22:35:46.857

请求对象的 #to_hash 方法可能很有用。这是一个构建 GET 请求并检查标头的示例：

```
require 'net/http'
require 'uri'

uri = URI('http://example.com/cached_response')
req = Net::HTTP::Get.new(uri.request_uri)

req['X-Crazy-Header'] = "This is crazy"

puts req.to_hash # hash of request headers
# => {"accept"=>["*/*"], "user-agent"=>["Ruby"], "x-crazy-header"=>["This is crazy"]} 
```

还有一个 POST 请求设置表单数据并检查标题和正文的示例：

```
require 'net/http'
require 'uri'

uri = URI('http://www.example.com/todo.cgi')
req = Net::HTTP::Post.new(uri.path)

req.set_form_data('from' => '2005-01-01', 'to' => '2005-03-31')

puts req.to_hash # hash of request headers
# => {"accept"=>["*/*"], "user-agent"=>["Ruby"], "content-type"=>["application/x-www-form-urlencoded"]}

puts req.body # string of request body
# => from=2005-01-01&to=2005-03-31 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T21:28:45.687

Net::HTTP 有一个名为[set_debug_output](http://www.ensta-paristech.fr/~diam/ruby/online/ruby-doc-stdlib/libdoc/net/http/rdoc/classes/Net/HTTP.html#M000665)的方法......它将打印您正在寻找的信息。

```
http = Net::HTTP.new
http.set_debug_output $stderr
http.start { .... } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:54:39.407

我认为您指的是请求标头，而不是请求正文。

要访问它，您可以查看 Net::HTTPHeader 的文档（[http://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTPHeader.html](http://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTPHeader.html)）。该模块包含在 Net::HTTPRequest 对象中，可以直接访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-16T00:23:04.703

如果您想对来自请求（调用）的响应做一些更复杂的事情，`GET`这个例子展示了如何`GET`从响应中执行和读取标头：

```
 access_token = API::TokenManager.valid_token
  config = Rails.configuration.my_web_app["api"]
  uri = URI("#{config.fetch("base_url")}/api_endpoint?access_token=#{access_token}")
  response = Net::HTTP.get_response(uri)
  puts response.to_hash["x-app-usage"]["call_count"] 
```

=> `{"call_count":48,"total_cputime":0,"total_time":80}`

Where the response is something like this (notice the headers of the response):

```
{"etag"=>["\"123\""], "x-app-usage"=>["{\"call_count\":48,\"total_cputime\":0,\"total_time\":80}"], "content-type"=>["application/json; charset=UTF-8"], "api-version"=>["v3.3"], "strict-transport-security"=>["max-age=15552000; preload"], "pragma"=>["no-cache"], "x-api-rev"=>["1002669385"], "access-control-allow-origin"=>["*"], "cache-control"=>["private, no-cache, no-store, must-revalidate"], "x-api-trace-id"=>["AD5Ou+tTNzs"], "x-api-request-id"=>["xxx"], "expires"=>["Sat, 01 Jan 2000 00:00:00 GMT"], "x-api-debug"=>["xxxxxxx=="], "date"=>["Wed, 16 Sep 2020 00:11:13 GMT"], "alt-svc"=>["h3-29=\":443\"; ma=3600,h3-27=\":443\"; ma=3600"], "connection"=>["keep-alive"], "content-length"=>["53"]} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-11T20:31:13.887

这是最基本的 Net::HTTP 示例：

```
require "net/http"
require "uri"

uri = URI.parse("http://google.com/")

# Will print response.body
Net::HTTP.get_print(uri)

# OR
# Get the response
response = Net::HTTP.get_response(uri)
puts response.body 
```

[您可以在Net:HTTP 备忘单](https://github.com/augustl/net-http-cheat-sheet)上找到这些和其他很好的示例。

# python - 在 manage.py shell 中将 POST 或 GET 请求数据设置为 QueryDict

> ID：12847957
> 
> 赞同：0
> 
> 时间：2012-10-11T20:26:01.550
> 
> 标签：python, django

中的`django.http.HttpRequest`对象`manage.py shell`没有`GET`or`POST`属性。真的没有办法设置与我的 Django 视图中的相同`POST`或数据，从它的一个 url到?`GET``QueryDict``manage.py shell`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:31:01.190

你能粘贴你正在输入的内容吗？我能够将数据添加到`GET`字典中。

```
(stackoverflow)➜  my_project  python ./manage.py shell
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole)
>>> from django.http import HttpRequest
>>> req = HttpRequest()
>>> print req
<HttpRequest
path:,
GET:{},
POST:{},
COOKIES:{},
META:{}>
>>> req.GET['test'] = 'hello world'
>>> print req
<HttpRequest
path:,
GET:{'test': 'hello world'},
POST:{},
COOKIES:{},
META:{}>
>>> 
```

# c# - 在 C# 控制台应用程序中居中文本仅适用于某些输入

> ID：12847960
> 
> 赞同：7
> 
> 时间：2012-10-11T20:26:11.613
> 
> 标签：c#, c#-4.0, console-application, centering

我在 C#.NET4 控制台应用程序中将文本居中时遇到问题。

这是我将文本居中的方法：

```
private static void centerText(String text)
{
    int winWidth = (Console.WindowWidth / 2);
    Console.WriteLine(String.Format("{0,"+winWidth+"}", text));
} 
```

但是，我只是得到输出，因为它本来可以正常输出。但是，如果我使用此行：

```
Console.WriteLine(String.Format("{0,"+winWidth+"}", "text")); 
```

“文本”应该居中。

我`centerText`用这两种方法打电话：

```
private static void drawStars()
{
    centerText("*********************************************");
}
private static void title(string location)
{
    drawStars();
    centerText("+++ Du er nu her: " + location + "! +++");
    drawStars();
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-11T20:29:21.677

试试这个：

```
private static void centerText(String text)
{
    Console.Write(new string(' ', (Console.WindowWidth - text.Length) / 2));
    Console.WriteLine(text);
} 
```

您的初始代码的问题是您的文本*从*屏幕中心开始。您希望文本的中心在那里。

如果你想打印这样居中的整个段落，你需要做更多的工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-02-12T20:55:41.263

我有自己的调用控制台标头的方法：

```
public static void Header(string title, string subtitle = "", ConsoleColor color = ConsoleColor.White)
{
    int windowWidth = 90 - 2;
    string titleContent = String.Format("║{0," + ((windowWidth / 2) + (title.Length / 2)) + "}{1," + (windowWidth - (windowWidth / 2) - (title.Length / 2) + 1) + "}", title, "║");
    string subtitleContent = String.Format("║{0," + ((windowWidth / 2) + (subtitle.Length / 2)) + "}{1," + (windowWidth - (windowWidth / 2) - (subtitle.Length / 2) + 1) + "}", subtitle, "║");

    Console.WriteLine("╔════════════════════════════════════════════════════════════════════════════════════════╗");
    Console.WriteLine(titleContent);
    if (!string.IsNullOrEmpty(subtitle))
    {
        Console.WriteLine(subtitleContent);
    }
    Console.WriteLine("╚════════════════════════════════════════════════════════════════════════════════════════╝");
} 
```

然后你这样称呼它`YourStaticClass.Header("Test", "Version 1.0");`

它应该是这样的：

```
╔════════════════════════════════════════════════════════════════════════════════════════╗
║                                          Test                                          ║
║                                      Version 1.0                                       ║
╚════════════════════════════════════════════════════════════════════════════════════════╝ 
```

您可以将`90`in`windowsWidth`替换为`Console.WindowWidth`

**更新**- 2019 年 2 月 - 代码清理并动态大小

```
/// <summary>
/// Application header, also sets the console title
/// </summary>
/// <param name="title">Title of application</param>
/// <param name="subtitle">Subtitle of application</param>
/// <param name="foreGroundColor">Foreground color</param>
public static void Header(string title, string subtitle = "", ConsoleColor foreGroundColor = ConsoleColor.White, int windowWidthSize = 90)
{
    Console.Title = title + (subtitle != "" ? " - " + subtitle : "");
    string titleContent = CenterText(title, "║");
    string subtitleContent = CenterText(subtitle, "║");
    string borderLine = new String('═', windowWidthSize - 2);

    Console.ForegroundColor = foreGroundColor;
    Console.WriteLine($"╔{borderLine}╗");
    Console.WriteLine(titleContent);
    if (!string.IsNullOrEmpty(subtitle))
    {
        Console.WriteLine(subtitleContent);
    }
    Console.WriteLine($"╚{borderLine}╝");
    Console.ResetColor();
}

/// <summary>
/// Align content to center for console. Can be used with decoration if used inside menu or header
/// </summary>
/// <param name="content">Content to center</param>
/// <param name="decorationString">Left and right decoration, default is empty/none</param>
/// <returns>Center aligned text</returns>
public static string CenterText(string content, string decorationString = "", int windowWidthSize = 90)
{
    int windowWidth = windowWidthSize - (2 * decorationString.Length);
    return String.Format(decorationString + "{0," + ((windowWidth / 2) + (content.Length / 2)) + "}{1," + (windowWidth - (windowWidth / 2) - (content.Length / 2) + decorationString.Length) + "}", content, decorationString);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T20:32:25.283

传入的文本可能有空格，例如`\r\n`，然后在调用 write 之前将其删除，例如

```
string textClean = Regex.Replace(text, @"([\r\n])", string.Empty);

// Then center on text clean 
```

# objective-c - 从字典中查找最近的日期

> ID：12847964
> 
> 赞同：-1
> 
> 时间：2012-10-11T20:26:19.363
> 
> 标签：objective-c, ios, nsdictionary

我在这个基本设置中有一本字典：

```
->Root
--->Monday
------->Date 1
------->Date 2
--->Tuesday
------->Date 1
------->Date 2
--->Wednesday
------->Date 1
------->Date 2
--->Thursday
------->Date 1
------->Date 2
--->Friday
------->Date 1
------->Date 2 
```

如何从这本字典中找到所有这些值的最早日期？

假设日期正在改变当前值是（`[NSDate date]`）我需要做什么才能找到循环遍历每一天，当天是第一个循环遍历的日期，并找到最接近当前日期的日期。

我希望我已经说清楚了。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:36:20.240

您是否有带有星期几键的根字典。一周中的每一天都指向一个对象，该对象是“日期 1”和“日期 2”的字典（我所说的不一定是你所拥有的，这适用于任何结构）。我将使用“快速枚举”，但也可以使用块枚举。

首先创建一个 NSDate 对象并将其设置为“现在”。

```
NSDate *date = [NSDate date];

for(NSString *key1 in root) {
  NSDictionary *dates = [root objectForKey:key1];
  for(NSString *key2 in dates) {
    NSDate *otherDate = [dates objectForKey:key2];

    date = [date earlierDate:otherDate];
  }
} 
```

在结束日期将是最早的日期。

# python - scrapy - 解析分页的项目

> ID：12847965
> 
> 赞同：30
> 
> 时间：2012-10-11T20:26:23.920
> 
> 标签：python, scrapy

我有一个形式的网址：

```
example.com/foo/bar/page_1.html 
```

总共有 53 页，每页大约有 20 行。

我基本上想从所有页面中获取所有行，即~53*20 项。

我的 parse 方法中有工作代码，它解析单个页面，并且每个项目还深入一页，以获取有关该项目的更多信息：

```
 def parse(self, response):
    hxs = HtmlXPathSelector(response)

    restaurants = hxs.select('//*[@id="contenido-resbus"]/table/tr[position()>1]')

    for rest in restaurants:
      item = DegustaItem()
      item['name'] = rest.select('td[2]/a/b/text()').extract()[0]
      # some items don't have category associated with them
      try:
        item['category'] = rest.select('td[3]/a/text()').extract()[0]
      except:
        item['category'] = ''
      item['urbanization'] = rest.select('td[4]/a/text()').extract()[0]

      # get profile url
      rel_url = rest.select('td[2]/a/@href').extract()[0]
      # join with base url since profile url is relative
      base_url = get_base_url(response)
      follow = urljoin_rfc(base_url,rel_url)

      request = Request(follow, callback = parse_profile)
      request.meta['item'] = item
      return request

  def parse_profile(self, response):
    item = response.meta['item']
    # item['address'] = figure out xpath
    return item 
```

问题是，我如何抓取每个页面？

```
example.com/foo/bar/page_1.html
example.com/foo/bar/page_2.html
example.com/foo/bar/page_3.html
...
...
...
example.com/foo/bar/page_53.html 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-10-11T20:33:46.577

您有两种选择来解决您的问题。一般的一种是用来`yield`生成新的请求，而不是`return`. 这样，您可以从单个回调发出多个新请求。检查[http://doc.scrapy.org/en/latest/topics/spiders.html#basespider-example](http://doc.scrapy.org/en/latest/topics/spiders.html#basespider-example)上的第二个示例。

在您的情况下，可能有一个更简单的解决方案：只需从这样的模式生成 start urs 列表：

```
class MySpider(BaseSpider):
    start_urls = ['http://example.com/foo/bar/page_%s.html' % page for page in xrange(1,54)] 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-08T19:36:58.903

您可以使用 CrawlSpider 代替 BaseSpider 并使用 SgmlLinkExtractor 提取分页中的页面。

例如：

```
start_urls = ["www.example.com/page1"]
rules = ( Rule (SgmlLinkExtractor(restrict_xpaths=('//a[@class="next_page"]',))
                , follow= True),
          Rule (SgmlLinkExtractor(restrict_xpaths=('//div[@class="foto_imovel"]',))
                , callback='parse_call')
    ) 
```

第一条规则告诉 scrapy 遵循 xpath 表达式中包含的链接，第二条规则告诉 scrapy 调用 parse_call 到 xpath 表达式中包含的链接，以防你想解析每个页面中的某些内容。

有关更多信息，请参阅文档：[http ://doc.scrapy.org/en/latest/topics/spiders.html#crawlspider](http://doc.scrapy.org/en/latest/topics/spiders.html#crawlspider)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-10-20T05:57:42.557

'scrapy - 解析分页的项目'可以有两个用例。

**一个）。我们只想在表中移动并获取数据。这是相对简单的。**

```
class TrainSpider(scrapy.Spider):
    name = "trip"
    start_urls = ['somewebsite']
    def parse(self, response):
        ''' do something with this parser '''
        next_page = response.xpath("//a[@class='next_page']/@href").extract_first()
        if next_page is not None:
            next_page = response.urljoin(next_page)
            yield scrapy.Request(next_page, callback=self.parse) 
```

观察最后 4 行。这里

1.  我们从“下一页”分页按钮获取下一页链接表单下一页 xpath。
2.  if 条件检查它是否不是分页的结尾。
3.  使用 url join 将这个链接（我们在步骤 1 中得到的）与主 url 连接起来
4.  `parse`对回调方法的递归调用。

**B）我们不仅要跨页面移动，而且还希望从该页面中的一个或多个链接中提取数据。**

```
class StationDetailSpider(CrawlSpider):
    name = 'train'
    start_urls = [someOtherWebsite]
    rules = (
        Rule(LinkExtractor(restrict_xpaths="//a[@class='next_page']"), follow=True),
        Rule(LinkExtractor(allow=r"/trains/\d+$"), callback='parse_trains')
    )
    def parse_trains(self, response):
    '''do your parsing here''' 
```

在这里，请注意：

1.  我们正在使用父类的`CrawlSpider`子类`scrapy.Spider`

2.  我们已设置为“规则”

    a) 第一条规则，只是检查是否有“next_page”可用并遵循它。

    b）第二条规则请求页面上所有格式的链接，例如`/trains/12343`然后调用`parse_trains`执行和解析操作。

3.  **重要提示**：请注意，我们不想`parse`在这里使用常规方法，因为我们正在使用`CrawlSpider`子类。这个类也有一个`parse`方法，所以我们不想重写它。请记住将您的回调方法命名为`parse`.

# javascript - 在 xslt 文件中使用 javascript

> ID：12847969
> 
> 赞同：1
> 
> 时间：2012-10-11T20:26:31.157
> 
> 标签：javascript, debugging, xslt-2.0

我正在尝试使用这个脚本

```
function padNumber(num, len){
    var str = ''+num;
    while(str.length < len){
      str = '0' + str;
      }
      return str;
} 
```

在我的 xlst 文件中，但在尝试调试时出现此错误。

> XslLoadException ---------------- XSLT 编译错误。
> 
> XmlException ------------ 名称不能以 ' ' 字符开头，十六进制值 0x20。第 522 行，第 27 位。

第 522 行是

```
while(str.length < len){ 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T01:44:39.657

为方便起见，您还可以将 Javascript 代码放在 CDATA 部分中。在这种情况下，您不需要更改 JS 代码。

但是，CDATA 部分中的文本不得包含字符串`"]]>"`。如果是这样，则必须在两个连续的 CDATA 部分之间拆分此字符串。

我相信典型的 JS 代码不太可能包含该字符串，但必须意识到这种可能性，无论它有多小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T22:23:33.247

`<`是一个 xml/xslt 元字符...它不能在任何一种类型的文档中出现未编码。它应该是`&lt;`

# javascript - 使用 JSON 使用 jQuery 填充 UL

> ID：12847972
> 
> 赞同：8
> 
> 时间：2012-10-11T20:26:45.730
> 
> 标签：javascript, jquery, html, asp.net-mvc, json

这是我的 JSON 数据

```
[
    {"CountyId":2,"Name":"Snohomish","StateId":1,"State":null,"Plans":null},    
    {"CountyId":1,"Name":"Whatcom","StateId":1,"State":null,"Plans":null}
] 
```

我正在尝试使用此数据在我的网页上填充 UL。

```
function loadSavedCounties() {
    $.post("/Plans/GetPlanCounties/",
        { planId: $("#PlanId").val() },
        function (data) {
            populateSavedCounties($("#SavedCounties"), data);
        }
    );
}
function populateSavedCounties(select, data) {
    select.html('');
    var items = [];
    $.each(data, function (id, option) {
        items.push('<li>' + option.Name + '</li>');
    });  
    select.append(items.join(''));
} 
```

我知道我正在成功调用 ，`loadSavedQueries()`因为我的 UL 正在被调用清除`select.html('')`。但是没有物品被放回 UL。

### 更新...

在明显的修复和更改不起作用之后，我在控制器中发现了一个问题，该问题没有引发错误，但基本上返回了空的 JSON 对象。一旦我发现这一点，数据就开始向下流动，建议的更改就成功了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-11T20:31:10.267

您可以在最后设置 UL 的 html - 无需先将其清除：

```
function populateSavedCounties(select, data) {
    var items = [];
    $.each(data, function (id, option) {
        items.push('<li>' + option.Name + '</li>');
    });  
    select.html(items.join(''));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:36:41.300

这个很简单，我先写代码，然后再回去解释。

> **脚本**

```
// You obviously know how to use .post
$.post("/Plans/GetPlanCounties/", { planId: $("#PlanId").val() }, function(data) {
    // out of simplicity, i did not create a seperate function, however you seem to know how to move functions around
    // below of course i simply assign a variable for reuse to the element you want
    var $this = $("#SavedCounties").empty();
    // instead of .each, I went on the premise that your data is returned exactly as stated above,
    // in which case, a simple old school for statement is easiest
    for (x in data) {
        // this is real simple, the first part creates a jQuery object of a List Element
        // the text part adds the text too it (aka, html you were wanting)
        // the last part appends the Li to the END of the UL
        $("<li />").text(data[x].Name).appendTo($this);
    };
}); 
```

> ***最终结果没有评论，很短很甜***

```
$.post("/Plans/GetPlanCounties/", { planId: $("#PlanId").val() }, function(data) {
    var $this = $("#SavedCounties").empty();
    for (x in data) {
        $("<li />").text(data[x].Name).appendTo($this);
    };
}); 
```

# wordpress - 获取 Wordpress 分类页面的根词条 ID

> ID：12847978
> 
> 赞同：0
> 
> 时间：2012-10-11T20:26:59.287
> 
> 标签：wordpress, wordpress-theming, taxonomy

我在archive.php 页面上，我想查找层次分类法的根父项的术语ID。这样我就可以打印出与该父项相关的所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T23:28:40.437

无需创建自定义循环。只需使用[Get Ancestors](http://codex.wordpress.org/Function_Reference/get_ancestors)：

```
<?php
$cat = get_query_var('cat'); //Only works if on Archive page
$ancestors = get_ancestors($cat->term_id, 'category');
$root = end($ancestors);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T21:20:52.140

你可以试试：

```
global $wp_query;
$cat_obj = $wp_query->get_queried_object();
$this_cat = $cat_obj->term_id;
$this_cat = get_category($this_cat);
if($this_cat->category_parent!=0){
    do{
        $this_cat = get_category($this_cat->category_parent);
    }while($this_cat->category_parent!=0);
}
$root_term = $this_cat->term_id; 
```

# php - 转换为 mp4 时出现 ffmpeg 错误 打开输出流 #0.0 的编码器时出错

> ID：12847980
> 
> 赞同：2
> 
> 时间：2012-10-11T20:27:03.687
> 
> 标签：php, ffmpeg

我正在尝试将各种文件类型转换为 mp4 以使用 ffmpeg 显示，但我不断收到错误消息：

> 打开输出流 #0.0 的编码器时出错 - 可能是不正确的参数，例如 bit_rate、rate、width 或 height

另一个看起来很重要的部分是：

> [libx264 @ 0x93caef0] 检测到损坏的 ffmpeg 默认设置
> 
> [libx264 @ 0x93caef0] 使用编码预设（例如 -vpre 介质）
> 
> [libx264 @ 0x93caef0] 预设用法：-vpre -vpre
> 
> [libx264 @ 0x93caef0] 速度预设列在 x264 --help
> 
> [libx264 @ 0x93caef0] 配置文件是可选的；x264 默认为高

我正在运行的最新代码是：

> ffmpeg -i source -s 320x240 -r 30000/1001 -b 200k -bt 240k -vcodec libx264 -coder 0 -bf 0 -refs 1 -flags2 -wpred-dct8x8 -level 30 -maxrate 10M -bufsize 10M -acodec libfaac -ac 2 -ar 48000 -ab 192k 目的地

我见过其他一些人遇到这个问题，但他们的修复由于某种原因没有奏效。

以防万一：最终这将在 php 中使用，尽管我试图通过 putty 让它首先工作

编辑:: 这是所要求的全部内容（使用 wmv，已测试 wmv 和 flv）：

```
 ~ >> ffmpeg -i path.wmv -s 320x240 -r 30000/1001 -b 200k -r 29.97 -bt 240k -vcodec libx264 -coder 0 -bf 0 -refs 1 -flags2 -wpred-dct8x8 -level 30 -maxrate 10M -bufsize 10M -acodec libfaac -ac 2 -ar 48000 -ab 192k path.mp4
FFmpeg version SVN-r26076, Copyright (c) 2000-2011 the FFmpeg developers
  built on Aug 28 2012 17:55:47 with gcc 4.1.2 20080704 (Red Hat 4.1.2-52)
  configuration: --enable-version3 --enable-gpl --enable-nonfree --enable-shared --enable-postproc --enable-avfilter --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libvpx --enable-libfaac --enable-libmp3lame --enable-libtheora --enable-libvorbis --enable-libx264 --enable-libxvid --disable-ffplay --disable-indevs --disable-outdevs --disable-demuxer=v4l --disable-demuxer=v4l2 --disable-mmx
  libavutil     50.36\. 0 / 50.36\. 0
  libavcore      0.16\. 1 /  0.16\. 1
  libavcodec    52.108\. 0 / 52.108\. 0
  libavformat   52.93\. 0 / 52.93\. 0
  libavdevice   52\. 2\. 3 / 52\. 2\. 3
  libavfilter    1.74\. 0 /  1.74\. 0
  libswscale     0.12\. 0 /  0.12\. 0
  libpostproc   51\. 2\. 0 / 51\. 2\. 0

Seems stream 1 codec frame rate differs from container frame rate: 1000.00 (1000/1) -> 29.97 (30000/1001)
Input #0, asf, from 'path.wmv':
  Metadata:
    SfOriginalFPS   : 299
    WMFSDKVersion   : 11.0.6001.7000
    WMFSDKNeeded    : 0.0.0.0000
    IsVBR           : 0
    title           : Wildlife in HD
    artist          :
    copyright       : Â© 2008 Microsoft Corporation
    comment         : Footage: Small World Productions, Inc; Tourism New Zealand | Producer: Gary F. Spradling | Music: Steve Ball
  Duration: 00:00:30.09, start: 8.000000, bitrate: 6977 kb/s
    Stream #0.0(eng): Audio: wmav2, 44100 Hz, 2 channels, s16, 192 kb/s
    Stream #0.1(eng): Video: vc1, yuv420p, 1280x720, 5942 kb/s, 29.97 tbr, 1k tbn, 1k tbc
File 'path.mp4' already exists. Overwrite ? [y/N] y
[buffer @ 0x9ce9eb0] w:1280 h:720 pixfmt:yuv420p
[scale @ 0x9ce8f70] w:1280 h:720 fmt:yuv420p -> w:320 h:240 fmt:yuv420p flags:0x4
[libx264 @ 0x9ce9ef0] broken ffmpeg default settings detected
[libx264 @ 0x9ce9ef0] use an encoding preset (e.g. -vpre medium)
[libx264 @ 0x9ce9ef0] preset usage: -vpre <speed> -vpre <profile>
[libx264 @ 0x9ce9ef0] speed presets are listed in x264 --help
[libx264 @ 0x9ce9ef0] profile is optional; x264 defaults to high
Output #0, mp4, to 'path.mp4':
    Stream #0.0(eng): Video: libx264, yuv420p, 320x240, q=2-31, 200 kb/s, 90k tbn, 29.97 tbc
    Stream #0.1(eng): Audio: libfaac, 48000 Hz, 2 channels, s16, 192 kb/s
Stream mapping:
  Stream #0.1 -> #0.0
  Stream #0.0 -> #0.1
Error while opening encoder for output stream #0.0 - maybe incorrect parameters such as bit_rate, rate, width or height 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T22:36:22.583

声明每个 libx264 选项都已折旧。如控制台输出所示，请改用编码预设。有关更多信息和一些最新示例，请参阅[FFmpeg 和 x264 编码指南](https://ffmpeg.org/trac/ffmpeg/wiki/x264EncodingGuide)和[FFmpeg：终极视频和音频操作工具。](http://blog.superuser.com/2012/02/24/ffmpeg-the-ultimate-video-and-audio-manipulation-tool/)另请注意，`-bt`它已与 libx264“断开连接”，因此它对您没有任何作用。

其次，你的 ffmpeg 是旧的。FFmpeg 使用 Git 而不是 SVN，并且自 r26076 以来已经有数千次额外的提交（截至目前大约 19202 次）和错误修复。有关编译说明，请参阅[在 CentOS 上编译 FFmpeg，](https://ffmpeg.org/trac/ffmpeg/wiki/CentosCompilationGuide)或参阅[FFmpeg 下载](http://ffmpeg.org/download.html)页面以获取一些静态构建的链接。

# javascript - 用于上传/预览多个图像的 jQuery 插件

> ID：12847984
> 
> 赞同：1
> 
> 时间：2012-10-11T20:27:33.403
> 
> 标签：javascript, jquery

有谁知道我可以用来上传多个图像并在提交之前预览它们的 jQuery 插件？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:31:24.670

有一个非常好的： http: [//blueimp.github.com/jQuery-File-Upload/](http://blueimp.github.com/jQuery-File-Upload/)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-26T12:31:16.120

我通过简单地使用 jQuery 表单插件解决了这个问题。我使用这个插件（使用 ajax）提交表单，上传图像，取回并显示它。

# python - Python Popen 冻结

> ID：12847991
> 
> 赞同：1
> 
> 时间：2012-10-11T20:28:07.700
> 
> 标签：python, powershell, subprocess, popen

由于某种原因，在调用 Powershell 脚本并且命令的输出不是动态的之后，Popen 无法退出。

我是否遗漏了代码中的某些内容：

```
sCmd = "powershell -file somefile.ps1"
process = subprocess.Popen(sCmd.strip(), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

while True:
    p = process.communicate()
    sys.stdout.write(p[0])
    sys.stderr.write(p[1])

    sys.stdout.flush()
    if(len(p[0]) == 0 and isinstance(process.poll(), int)):
        break

if(process.wait() != 0):
    os._exit(1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:38:05.013

验证您的 powershell 命令是否确实正确退出。挂起的 powershell 进程很容易导致此问题。

你也不应该有`shell=True`. 这是一个巨大的安全风险。它也可能是为什么进程挂起的原因。如果您的 powershell 脚本无法运行，除非`shell=True`修复那将是一个很好的关注点。

# html - 文字装饰：换行在 IE 上不起作用？

> ID：12847993
> 
> 赞同：2
> 
> 时间：2012-10-11T20:28:15.870
> 
> 标签：html, css, internet-explorer

我有这个

```
.strike{
    text-decoration: line-through;
} 
```

每次`disable()`调用 my 时，它都会禁用`<option>`my 中的 s`<select>`并添加此类，但它在 IE 上不起作用。是的，我`<option>`的 s 被禁用得很好，但 IE 上的文本装饰失败。解决方法是什么？谢谢。

编辑：我刚刚发现 text-decoration: line-through 在 Chrome 上也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T21:16:04.593

一般来说，`option`元素在样式方面有很多限制，因为它们的渲染仍然主要基于系统中的内置例程，而这些例程通常不能用 CSS 控制。Overstriking 通常不起作用，因为您可以使用简单的静态示例进行测试`<select><option style="text-decoration: line-through">Hello world</select>`。（出于好奇，Firefox 使用 line through，但不是在初始状态下最初选择的选项上。）

考虑使用替代方法。如果无法选择一个选项，为什么不直接删除它呢？（我的意思是用 JavaScript 删除元素。用 CSS 隐藏它效果不好。）

或者，将其`disabled`属性设置为`true`。这将阻止它被选中，并在流行的浏览器上使用灰色文本显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T21:08:31.827

`select`样式元素的选择很少。这是一个[支持网格](http://www.electrictoolbox.com/style-select-optgroup-options-css/)，显示了您的可用选项（和限制）。

您最好以其他方式模拟“选择”（[例如](http://cssglobe.com/custom-styling-of-the-select-elements/)），而不是尝试使用 CSS 设置选择表单控件的样式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-03T07:58:04.973

我的问题是 text-decoration: line-through; 不在IE中工作。我使用简写在单个声明中设置一个或多个单独的文本装饰值（例如文本装饰：通过虚线蓝色的线）。我发现它还不支持。 [https://developer.mozilla.org/en-US/docs/Web/CSS/text-decoration](https://developer.mozilla.org/en-US/docs/Web/CSS/text-decoration)

如果您需要下划线/穿线的另一种颜色，请使用额外的 span 元素。

```
<span style="color:red; text-decoration: line-through;"><span style="color: blue; text-decoration: none">Try this!</span></span>
```

不确定这是否会对您的情况有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T20:40:52.190

您可能会变得棘手并为文本 div 添加一个像素背景。这至少是面向未来的并且适用于所有浏览器。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-11T21:11:48.360

在这里，试试这个：

```
<p>Bla bla bla <span class="strike">RAAAAAA!</span></p> 
```

和：​</p>

```
span.strike{
    position: relative;
    text-align: center;
    z-index: 1;    
}

span.strike:before {
    border-top: 1px solid #000;
    content:"";
    width: 100%;
    position: absolute;
    top: 50%; 
    z-index: -1;
} 
```

编辑：哦，它是一个选择。没关系。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2014-08-21T16:55:08.597

来，试试这个

```
<select>
    <option selected> Size - </option>
    <option class="disabledoption">Short Option</option>
    <option class="disabledoption">This Is </option>
    <option class="disabledoption">dssdsd Is </option>
    <option class="disabledoption">yes </option>
    <option class=>ertyu </option>
    <option class=>gsdgsdf </option>
</select>

<script type="text/javascript">
jQuery(document).ready(function() {
    uni = '\u0336';
    jQuery('.disabledoption', this).each(function(index, element) {
        uni = '\u0336';
        var result = strikeString(jQuery(this).html(), uni);
        jQuery(this).html(result);
    });
    });
    function strikeString(str, strikeKind) {
        var result = '';
        for (var i = 0; i < str.length; i++) {
            var c = str.charAt(i);
            var r = c+strikeKind;
            result += r;
        }
    return result;
}
</script> 
```

# c++ - C++ 中的信号处理（在方法中使用实例变量）

> ID：12847996
> 
> 赞同：0
> 
> 时间：2012-10-11T20:28:27.180
> 
> 标签：c++, variables, static, signals

我对 C++ 不是很熟练，所以我觉得这很棘手。

我有一个看起来与这个非常相似的类：[Is it possible to use signal inside a C++ class?](https://stackoverflow.com/questions/343219/is-it-possible-to-use-signal-inside-a-c-class) .，但在信号处理方法中，我必须使用实例变量。

我尝试的第一件事是将变量设置为静态，但它没有帮助。我应该怎么办？谢谢海尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:34:17.850

如果您想使用实例变量，那么您将需要一个类实例，因为您无法从静态方法访问实例变量。您的下一个问题将是如何获取类实例，对此有几个选项。您可以创建一个通常不受欢迎的全局变量，也可以考虑创建一个[Singleton](http://en.wikipedia.org/wiki/Singleton_pattern)。您引用的问题的已接受答案的选项 2 中使用的方法类似于单例，因此这也可能是一种选择。

如果您查看静态方法和属性，这可能会更清楚。Bruce Eckel 的[Thinking in C++](http://www.mindview.net/Books/TICPP/ThinkingInCPP2e.html)是一本出色的免费在线 C++ 书籍，应该会有所帮助。

# c# - 在应用程序启动时首次抛出 COMException 但无法中断以找出它发生的位置/原因

> ID：12847997
> 
> 赞同：3
> 
> 时间：2012-10-11T20:28:28.507
> 
> 标签：c#, visual-studio

使用：Visual Studio 2012、.NET Framework 4、Windows 7 x64

有时，在调试模式下启动我的应用程序时，我会在输出窗口中看到以下行：

> Microsoft.VisualStudio.HostingProcess.Utilities.dll 中出现了“System.Runtime.InteropServices.COMException”类型的第一次机会异常

这大约在每 10 次启动中发生一次，并且似乎是随机的（没有更改代码，我可以启动、停止、启动、停止等，直到我在输出中看到错误）。

我想知道是什么导致了这个第一次机会异常。我禁用了“**工具->选项->调试->常规->启用我的代码**”选项，并启用了“**调试->异常...->通用语言运行时异常->System.Runtime.InteropServices- >System.Runtime.InteropServices.COMException** ”选项（见下面的截图），以便在收到异常时中断，但 Visual Studio 没有中断，所以我不知道问题出在哪里。

我尝试在我的代码中放置随机断点，但似乎每当我实际设置了断点时，异常就不会发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T21:14:30.517

听起来错误是在 Visual Studio 尝试托管进程时发生的。应用程序可以捕获和处理 First Chance 异常，而不会出现进一步的问题。输出窗口只是显示它已经发生。我不会担心的。也许将来对 Visual Studio 的更新将解决此问题。

我不希望它发生在 Visual Studio 主机进程之外的运行时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:01:45.667

我知道这篇文章已经很老了，但我想分享我的解决方案，以防它对其他人有所帮助。

更新到 Visual Studio 2012 Update 1 后，我开始遇到这个问题。只有我的问题是每次都出现。我可以创建一个新项目并运行一个空白表单，然后就会出现消息。每次运行都会变慢。

While trying to find help online I stumbled upon a site talking about running a VS 2012 Command Prompt in Administrator mode (in the tools folder of your Visual Studio 2012 Start Menu)

Unfortunately, I can't remember if I actually performed the ResetSkipPkgs so check for the error before running the second option.

```
 devenv /Resetsettings
    devenv /ResetSkipPkgs 
```

This resolved my issue. (of course, you will lose any settings you had made to your IDE)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-20T19:40:58.090

Just had same issue using VS 2012; this started yesterday for no apparent reason. No environment changes that I'm aware of at least none that I made and no other users on this machine.

So created simple Hello-World Console app and sure enough, would not run and received same error. Could not step into any code. Targeted framework was 4.5, default for VS 2012, so changed to 4.0 and everything magically worked.

Then changed back to 4.5 and magic continued. Did same with all projects in my solution. Everything seems happy again.

Wish I had backed up my VS settings for MS... If it happens again, I'll do that.