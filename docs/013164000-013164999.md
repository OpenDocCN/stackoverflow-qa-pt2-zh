# StackOverflow 问答 13164000-13164999

# php - 调整目录中所有图像的大小/缩放并保存它们

> ID：13164000
> 
> 赞同：1
> 
> 时间：2012-10-31T18:00:17.640
> 
> 标签：php, gd

我正在制作一个小脚本，它遍历目录中的所有图像，检查它们的宽度，如果它们不是这个宽度 - 调整大小。

我到目前为止是这样的：

```
$files = glob("*.{png,jpg,jpeg}", GLOB_BRACE);

foreach ($files as $file) 
{
  // get the image size
  $imagesize = getimagesize($file);
  $width_orig = $imagesize[0];
  $height_orig = $imagesize[1];

  $dst_w = 900;

  if($width_orig != $dst_w)
  {

    $dst_h_multiplier = $dst_w / $width_orig;
    $dst_h = $dst_h_multiplier * $height_orig;

    $dst = imagecreatetruecolor($dst_w, $dst_h);
    $image = imagecreatefromjpeg($file);
    imagecopyresampled($dst, $image, 0, 0, 0, 0, $dst_w, $dst_h ,$width_orig, $height_orig);

    imagejpeg($dst,null,100);  
  }
} 
```

看起来脚本执行正常 - 但执行此脚本的同一目录中的图像文件未修改。

我在这里想念什么？我该如何调试呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:02:43.123

您不应将 null 作为第二个参数传递。传递你的文件名

```
 imagejpeg($dst,$file.'edited',100); 
```

# c++ - 有没有办法拥有两个返回不同类型的重载运算符副本？

> ID：13164001
> 
> 赞同：1
> 
> 时间：2012-10-31T18:00:22.487
> 
> 标签：c++, operators, overloading

所以我的 Vector 类有这两个重载运算符，点积和叉积，我假设你不能这样做，我应该有一个交叉函数。

```
inline T operator *(const Vector3<T> &v)
{
    return value[0]*v[0]+value[1]*v[1]+value[2]*v[2];
}

inline Vector3<T> operator *(const Vector3<T> &v)
{
    Vector3<T> result;
    result[0] = value[1]*v[2] - value[2]*v[1]; 
    result[1] = value[2]*v[0] - value[0]*v[2];
    result[2] = value[0]*v[1] - value[1]*v[0];
    return result;
} 
```

万一有办法做到这一点会很棒，这有可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T18:09:45.290

简短回答：不可能

长答案：你可以做类似的事情

```
template<class T>
class Product
{
public:
   Product (const Vector3<T> &v1, const Vector3<T> &v2)
       : v1_ (v1), v2_(v2) {}

   operator T () const {/*calc and return a dot product*/}
   operator Vector3<T> () const {/*calc and return a cross product*/}

private:
   const Vector3<T> &v1_;
   const Vector3<T> &v2_;
};

template<class T>
class Vector3
{
...
public:
    inline Product<T> operator *(const Vector3<T> &v)
    {
         return Product<T> (*this, v);
    }
};

// usage
Vector3<int> v1 = {...};
Vector3<int> v2 = {...};

int dot = v1 * v2;
Vector3<int> cross = v1 * v2; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-31T18:13:17.323

您不能重载返回类型。

你有几个选择：

*   使用免费功能`dot(v1, v2)`；
*   滥用另一个对您的类没有意义的二元运算符（例如`v1 ^ v2`）作为点或交叉运算符（请注意，优先级可能不是您想要的）；
*   滥用成对的运算符和对象来构造适当的语法（例如`v1 <dot> v2`，使用`<`and`>`运算符和全局`dot`对象）。

# regex - 正则表达式匹配两个 con

> ID：13164003
> 
> 赞同：3
> 
> 时间：2012-10-31T18:00:33.590
> 
> 标签：regex

我得到了一些我解析的平面文件提要。其中一个提要有一个经常包含双引号的评论字段。

这没什么大不了的，除了文件是管道分隔的双引号限定文件这一事实！

下面我概述了我得到的字符串。

```
0|0.9|""|"M"|"X"|"0.2"|"This is the string with the "double" double quotes" 
```

这是我想要的字符串。

```
0|0.9|""|"M"|"X"|"0.2"|"This is the string with the double double quotes" 
```

我的想法是使用一个简单的正则表达式 `"(?!\|)(?<!\|)"`

但是，这仍然匹配构成空字段的两个连续双引号。

我也试过

`\|*"\|*`

我认为它会匹配任何不与管道相邻的双引号。

但这捕获了所有的双引号。

这似乎应该很容易，但我被卡住了。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:16:19.610

这在一般情况下显然是不可能的——如果评论是`You need to use a pipe ("|") rather than < and >`怎么办？——但对于 99% 的情况，你可以这样写：

```
(?<!\|)"(?!\|) 
```

匹配一个既不在管道之前也不在管道之后的双引号，或者更好：

```
(?<!\||^)"(?!\||$) 
```

还要求它不与字符串的任一端相邻。

# jquery-ui - 如何将子div设置为可拖动而不是父div

> ID：13164004
> 
> 赞同：1
> 
> 时间：2012-10-31T18:00:34.160
> 
> 标签：jquery-ui, jquery-ui-draggable

我正在尝试动态创建可以拖动的 div。但我发现，整个父 div 也随之移动。如果我创建多个子 div，它们也会与父级一起移动。我究竟做错了什么？这是我的代码：

```
$(function() {
    $( "button#new-child" )
        .button()
        .click(function( event ) {
            event.preventDefault();
            $("#creation-box").append("<div class='draggable  ui-widget-content'><p>Drag me around</p></div>").draggable();

        });
}); 
```

和html

```
<body>
<div id="toolbar">
<div class="header"> <h3>Toolbar</h3></div>
<button id="new-child">New Child</button>
</div>

<div id="creation-box">
<div class="header"><h3>Creation Box</h3></div>
</div>

</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:34:52.017

因为您将父级设置为可拖动。仅在创建后将新元素设置为可拖动。

顺便说一句，`.append()`没有回调，所以只需添加`.draggable`after 元素创建。

```
$(function() {
    $( "button#new-child" )
        .button()
        .click(function( event ) {
            event.preventDefault();
            $("#creation-box").append("<div id='new-element-with-unique-id' class='draggable ui-widget-content'><p>Drag me around</p></div>");

            $("#new-element-with-unique-id").draggable();

        });
}); 
```

# git - GitHub 恢复已删除的代码块

> ID：13164011
> 
> 赞同：1
> 
> 时间：2012-10-31T18:00:55.997
> 
> 标签：git, version-control, github, repository, git-extensions

我正在做一个项目，我们有一个文件，其中一些代码块在不同的时间间隔被删除了几个提交。我只需要恢复其中一些块并将它们放入我正在制作的其他东西中。有没有办法查看已提交的旧块并复制它们，而不会在行之前/周围有所有垃圾（比如当你用 Git Extensions 或 GitHub 查看它时。我基本上只是希望能够获取一些旧代码手动阻止以用于不在存储库中的另一个项目。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:05:24.583

在 github 中，您可以查看提交列表，只需单击该代码仍然存在的提交旁边的“查看代码”。然后，您可以浏览到包含所需代码的文件，然后单击“原始”以查看文件，而不会“拥有所有垃圾”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T10:30:47.970

一般的想法是：

*   用于`git log -SFoo -- path_containing_change`检测您添加的提交，或者更重要的是，*删除*了某行：请参阅“[如何在 git 历史记录中 grep（搜索）提交的代码？](https://stackoverflow.com/questions/2928584/how-to-grep-search-committed-code-in-the-git-history) ”。`git grep <regexp> $(git rev-list --all)`也可以提供帮助（虽然可能会慢一些）

*   对于每个相关的提交，为正确的文件打一个补丁（如“ [“<code>git format-patch”等效于单个文件？](https://stackoverflow.com/questions/4462854/git-format-patch-equivalent-for-a-single-file) ”）

*   将这些补丁应用到您的其他 repo 项目。

# php - 数据库连接到类

> ID：13164017
> 
> 赞同：0
> 
> 时间：2012-10-31T18:01:15.150
> 
> 标签：php, class, mysqli

使用这个：

```
$db = mysqli_connect
(
    $db_host,
    $db_user,
    $db_pwd
) or die ("FATAL ! : The server ".$db_host." is not responding to ".$db_user."!"); 
```

如何将**$db**值获取到此类中（来自包含“class.php”） - 没有错误;-)

```
class User
{
    public $db;
    public $id;

    public function getUser()
    {
        if($this->id)
        {
            $sql = "
            SELECT
                users.*
            FROM
                users
            WHERE
                users.u_id='".$this->id."'
            ";
            $res = mysqli_query($db, $sql) or die(mysqli_error($db));
            $user_row = mysqli_fetch_object($db, $res);
            return $user_row;
        }
        else
        {
            return false;
        }
    }
    } // end class User 
```

我得到的只是——好吧，什么都没有。除了我的主页加载为空......如果我停止使用该类，一切都很好（除了没有显示用户的数据;-)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:05:36.973

您必须实例化您的类，并且您必须使用`$this`运算符来访问类成员。此外，最好在构造和使用时注入参数：

```
class User
{
    private $db;

    public function __construct($db)
    {
       $this->db = $db;
    }

    public function getUser($id)
    {
        if($id)
        {
            $sql = "
            SELECT
                users.*
            FROM
                users
            WHERE
                users.u_id=" . (int)$id ;

            $res = mysqli_query($this->db, $sql) or die(mysqli_error($this->db));
            $user_row = mysqli_fetch_object($this->db, $res);
            return $user_row;
        }
        else
        {
            return false;
        }
    }
 } 
```

用法：

```
$user = new User($db);
$userdata = $user->getUser(2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T18:03:37.210

当你实例化类（用户）时，如果你已经分配了变量（$db）......你可以做

```
$user = new User;
$user->db = $db;
$user->getUser(); 
```

是的，当你从类的方法中引用类的属性时，在你的类内部，使用`$this`符号......即更改`$db`为`$this->db`

那应该工作。你提到了一些关于抑制错误的事情，这是一个不同的问题。我不确定您的目标是什么，但是在类实例化之前进行正常的异常处理就足够了。

# python - 使用 Boto 在 Amazon DynamoDB 中进行分页

> ID：13164026
> 
> 赞同：8
> 
> 时间：2012-10-31T18:01:47.850
> 
> 标签：python, boto, amazon-dynamodb

如何使用 Boto python 库对来自 DynamoDB 的结果进行分页？从 Boto API 文档中，我无法确定它是否支持分页，尽管 DynamoDB API 确实支持分页。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T18:20:10.867

Boto 确实支持使用“ExclusiveStartKey”和“Limit”组合的“分页”行为。例如，对`Scan`.

这是一个应该按 10 个块解析整个表的示例

```
esk = None

while True:
    # load this batch
    scan_generator = MyTable.scan(max_results=10, exclusive_start_key=esk)

    # do something usefull
    for item in scan_generator:
        pass  # do something usefull
    # are we done yet ?
    else:
        break;

    # Load the last keys
    esk = scan_generator.kwargs['exclusive_start_key'].values() 
```

编辑：

正如@garnaat 所指出的，我可能误解了您的实际目标。上述建议允许您提供分页，例如 SO 对问题所做的那样。每页不超过 15 个。

如果您只需要一种方法来加载由给定生成的整个结果集`Scan`，那么 Boto 是一个很棒的库，并且已经为您抽象了它，而无需像我的回答中那样使用黑魔法。在这种情况下，您应该遵循他 (@garnaat) 的建议。顺便说一句，他是 Boto 的作者，因此是 Boto 相关问题的一个很好的参考 :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-01T13:38:13.797

也许我误解了这个问题，但我认为你让它变得比它需要的更困难。如果您在 boto（默认）中使用 layer2 DynamoDB 接口，它会为您处理分页。

所以，如果你想做一个查询操作，你只需这样做：

```
import boto

c = boto.connect_dynamodb()
t = c.get_table('mytable')
for item in t.query(hash_key='foo'):
    print item 
```

这将自动处理来自 DynamoDB 的结果的分页。这同样适用于扫描请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-26T12:19:53.567

你很有可能想要这样的东西：

```
qms = tms.query(hash_key=415772421368583351, max_results=2, exclusive_start_key=None)
for i in qms:
    print i
lek = qms.last_evaluated_key
qms = tms.query(hash_key=415772421368583351, max_results=2, exclusive_start_key=lek)
for i in qms:
  print i 
```

当然，这是一个愚蠢的演示示例。
这里的关键是不要`last_evaluated_key`使用`exclusive_start_key`

# complexity-theory - 图灵机上欧几里得最大公约数算法的复杂性

> ID：13164033
> 
> 赞同：1
> 
> 时间：2012-10-31T18:02:28.847
> 
> 标签：complexity-theory, big-o, time-complexity, turing-machines, greatest-common-divisor

考虑 Euclid 算法的这种实现：

```
function gcd(a, b)
    while b ≠ 0
       t := b
       b := a mod b
       a := t
    return a 
```

[维基百科](http://en.wikipedia.org/wiki/Euclidean_algorithm#Worst-case_number_of_steps)上的一个很好的证明表明，该算法“总是需要少于 O(h) 的除法，其中 h 是较小数字 b 中的位数”。

然而，在图灵机上，计算 mod b 的过程的时间复杂度为 O(a+b)。我的直觉和一些大型测试告诉我，欧几里德算法的复杂度在图灵机上仍然是 O(a+b)。

关于如何证明这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:01:23.590

如果我在图灵机上对二进制数实现 GCD，我将实现以下算法。我看不出它会比 O((ln a + ln b)^2) 小多少。我认为最有效的表示方法是在第 2 步之后按位交错两个值。

1.  令 s1 = a 的最低有效位中的零数。删除这些底部 s1 零位。
2.  令 s2 = b 的最低有效位中的零数。删除这些底部 s2 零位。
3.  让 s = min(s1,s2)
4.  现在 a 和 b 都是奇数。如果 b < a 则交换 a 和 b。
5.  b >= a。设置 b = b - a，然后从 b 中删除所有最低有效零位。
6.  如果 b != 0，转到 4。
7.  在 a 的末尾添加 s 个零位。这就是结果。

# xquery - xquery 错误：使用 where 子句时

> ID：13164044
> 
> 赞同：0
> 
> 时间：2012-10-31T18:03:15.260
> 
> 标签：xquery

```
{
    for $movie in distinct-values(doc("movies.xml")/movies/movie)
    where count(doc("movies.xml")/movies/movie[title=$movie/title]) = count(distinct-values(doc("movies.xml")/movies/movie/source))
    return
    <title> {$movie/title} </title> 
} 
```

在这个特定的查询中，我尝试：查找“电影”文档中所有来源提供的电影标题。我在 where 子句的行上遇到错误。错误是：'/'的第一个操作数的必需项类型是节点（）；提供的值具有项目类型 xs:anyAtomicType

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:08:09.573

问题是`distinct-values()`返回不同的字符串值，因此您尝试在字符串上使用 xpath 表达式。`$movie/title`评估`(xs:string)/title`哪个无效并引发异常。

但是按照我理解您的目标的方式，我认为该查询不会返回您想要的结果。试试这个解决方案来返回所有来源提供的电影标题：

```
let $sources-distinct-all := count(distinct-values(doc("movies.xml")/movies/movie/source))
for $title in distinct-values(doc("movies.xml")/movies/movie/title) 
let $sources-distinct-movie := count(distinct-values(doc("movies.xml")/movies/movie[title eq $title]/source))
where ($sources-distinct-all eq $sources-distinct-movie)
return $title 
```

# c# - 如何直观地更新 UI 中绑定到 WPF c# 中布尔 isChecked 变量的复选框？

> ID：13164045
> 
> 赞同：0
> 
> 时间：2012-10-31T18:03:15.303
> 
> 标签：c#, wpf, binding, checkbox, inotifypropertychanged

所以我有一个 TreeView，它具有层次结构的数据模板，在最低层有 CheckBoxes。这些 CheckBox 绑定到 ViewModel 中的“isChecked”布尔值。我一直在尝试做的是加载各种变量，向我指示要检查哪些复选框，将模型中的布尔值 isChecked 更改为 true，从而导致 TreeView 中的特定 CheckBoxes 在视觉上更新。这是我的参考代码：

XAML：（我正在使用的 TreeView）

```
<DockPanel Name="test1" Margin="10,10,0,10" VerticalAlignment="Stretch" Grid.Row="3" Grid.RowSpan="7" Grid.Column="0">
        <DockPanel.Resources>
            <local:CheckBoxCommand x:Key="cbc"></local:CheckBoxCommand>
            <src:TreeViewFilter x:Key="MyList" />

            <HierarchicalDataTemplate DataType="{x:Type src:TreeViewParent}" ItemsSource="{Binding Path=OrderAttributes}">
                <TextBlock Text="{Binding Path=NameAndCount}" FontSize="24"/>
            </HierarchicalDataTemplate>

            <HierarchicalDataTemplate DataType="{x:Type src:OrderAttribute}" ItemsSource="{Binding Path=OrderAttributes}">
                <StackPanel Name="test" Orientation="Horizontal" VerticalAlignment="Center">
                    <CheckBox Command="{StaticResource cbc}"
                              CommandParameter="{Binding Path=NameAndParent}" Visibility="{Binding Path=CheckBoxVisible}" IsChecked="{Binding Path=isChecked, Mode=TwoWay}" VerticalAlignment="Center">
                    </CheckBox>
                    <TextBlock Text="{Binding Path=NameAndCount}" FontSize="16"/>
                    </StackPanel>
            </HierarchicalDataTemplate>

        </DockPanel.Resources>
        <TreeView Name="treeView1" BorderThickness="2" ItemsSource="{Binding Source={StaticResource MyList}, UpdateSourceTrigger=PropertyChanged}" TreeViewItem.Selected="filterByBatchStatus"/>
    </DockPanel> 
```

ViewModel 中的 C# 代码（与问题有关）：

```
public event PropertyChangedEventHandler PropertyChanged2;

protected void FirePropertyChanged2(string CheckBoxChecked)
    {
        if (PropertyChanged2 != null)
        {
            PropertyChanged2(this, new PropertyChangedEventArgs(CheckBoxChecked));
        }
    }

public static bool cbc;

public bool CheckBoxChecked
    {
        get { return (bool)GetValue(CheckBoxCheckedProperty); }
        set { SetValue(CheckBoxCheckedProperty, value); }
    }

public static readonly DependencyProperty CheckBoxCheckedProperty =
        DependencyProperty.Register("CheckBoxChecked", typeof(bool), typeof(OrderAttribute), new UIPropertyMetadata((bool)false));

bool _isChecked;
    public bool isChecked
    {
        get { return _isChecked; }

        set
        {
            if (_isChecked != value)
            {
                _isChecked = value;
                FirePropertyChanged2("CheckBoxChecked");
            }
        }
    } 
```

如果我加载值，更新布尔值，然后展开树（这样我可以直观地看到它们），就会选中正确的复选框并且一切正常。当我最初在视觉上看到第一个加载的复选框后加载不同的复选框时，问题就出现了，更改布尔值，然后复选框不会相应更改（根本不更改）。

让我难过的部分是，如果我进行多次加载，一遍又一遍地更改布尔值，而不展开树并视觉看到框，然后展开树，则检查正确的框。只要我可以直观地展开并看到复选框，任何帖子加载都不会更新复选框，无论我是否展开或取消展开树。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:27:24.407

哇...你这里有一些严重的问题。首先，正如我在上一个问题中所说，[DependencyProperties 不属于 ViewModels](http://kentb.blogspot.com.ar/2009/03/view-models-pocos-versus.html)。其次，您的 CheckBox 位于为 Type src:OrderAttribute 定义的 HierarchicalDataTemplate 内，因此那里的所有绑定都将搜索该类型的属性。第三，我不清楚您使用什么字符串参数调用 PropertyChanged 事件，但它应该是您的类中与 UI 绑定的 CLR 属性的名称。我强烈建议您在尝试执行复杂的分层表示层之前，先看看[This WPF Tutorial](http://www.wpftutorial.net/Home.html) 以至少了解 MVVM、INotifyPropertyChanged 和 DataTemplating 的基础知识。

编辑：从 OrderAttribute 类中删除 DependencyProperty，并使用常规 bool 属性，然后在调用 PropertyChanged 时，通过传递包含该属性名称的字符串参数来执行此操作：

```
public bool MyBool 
{ 
   get { return _mybool; }
   set {
         _mybool = value;
         NotifyPropertyChanged("MyBool");
       }
}

public void NotifyPropertyChanged(string propertyName)
{
   if (PropertyChanged != null)
       PropertyChanged(this, new PropertyChangedEventArgs(propertyName);
} 
```

# c++ - 用 C++ 编写一个简单的排序算法，以及一个伪代码版本

> ID：13164047
> 
> 赞同：0
> 
> 时间：2012-10-31T18:03:27.710
> 
> 标签：c++, sorting, pseudocode

我正在尝试用 C++ 编写排序算法，然后用伪代码编写它，然后用伪代码编写它并不算太糟糕，但是把它记在我的脑海里却变成了一场斗争，所以我向你们提出的问题：

我正在寻找一种算法，该算法采用一个未排序的数组，以及两个整数（比方说 B 和 C）并输出 TRUE，如果 A 包含一个既大于 B 又小于 C 的元素，否则它返回 FALSE。

```
For J <-- 1 to Length[A]
       Count <-- j+1
              while Count =< Length[A] 
```

这是我的伪代码开始，因为这似乎是合乎逻辑的事情，然后在 c++ 中实现它，但是我发现自己在循环创建循环，并没有取得太大进展。希望我所说的一切都有意义，并且有人可以将它们放在一起以创建某种形式的解决方案。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:09:25.133

我从 Steve McConnell 的*Code Complete*中回忆起，你的伪代码在理想情况下应该看起来更像英语而不是它。在我的拙见中，你跳得太快了。

那这个呢：

```
for each element in array
    check to see if element is between B and C
    if element is between B and C
        return TRUE
    else
        continue loop
next

return FALSE 
```

这就是我从你的陈述中收集到的：

> 我正在寻找一种算法，该算法采用一个未排序的数组，以及两个整数（比方说 B 和 C）并输出 TRUE，如果 A 包含一个既大于 B 又小于 C 的元素，否则它返回 FALSE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T18:11:02.447

我将从一个检查您关心的条件的函数开始：给定一个数字，它是否在指定范围内：

```
boolean function in_range(A, B, C) {
    return (A > B) and (A < C);
} 
```

从那里开始，扫描数组并调用函数，将数组的每个元素作为`A`（以及作为`B`and`C`提供的`B`and `C`）传递，就变成了一件简单的事情。如果函数`true`在任何时候返回，您可以停止扫描并且外部函数也返回 true（对于它的价值，C++11 提供`std::any_of`了这种情况）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T18:33:15.747

您只是在数组中搜索与条件 x > B && x < C 匹配的 x。线性搜索可以 - 如果您只进行一次搜索。如果必须多次进行搜索（除了 log（数组大小）之外的任何内容），那么首先排序然后进行二进制搜索是有意义的。

```
bool InRangeSearch(low, high)
{
  index = upper_bound(array, low);
  if(index==-1)
    return false;

  index2 = lower_bound(array, high);
  if(index2==-1)
    return true;

  return ((index2-1)>index);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T19:18:25.560

伪代码：

```
Quicksort(A as array, low as int, high as int)
    if (low < high)
        pivot_location = Partition(A,low,high)
    Quicksort(A,low, pivot_location - 1)
    Quicksort(A, pivot_location + 1, high)

Partition(A as array, low as int, high as int)
     pivot = A[low]
     leftwall = low

     for i = low + 1 to high
         if (A[i] < pivot) then
             leftwall = leftwall + 1
             swap(A[i], A[leftwall])

     swap(A[low],A[leftwall])

    return (leftwall) 
```

程序代码：

```
#include <stdio.h>

void quickSort( int[], int, int);
int partition( int[], int, int);

int  main() 
{
    int a[] = { 7, 12, 1, -2, 0, 15, 4, 11, 9};

    int i;
    printf("\n\nUnsorted array is:  ");
    for(i = 0; i < 9; ++i)      printf(" %d ", a[i]);

    quickSort( a, 0, 8);

    printf("\n\nSorted array is:  ");
    for(i = 0; i < 9; ++i)      printf(" %d ", a[i]);

    printf("\n\n " );
    return 0;

}

void quickSort( int a[], int l, int r)
{
   int j;

   if( l < r ) 
   {

        j = partition( a, l, r);
       quickSort( a, l, j-1);
       quickSort( a, j+1, r);
   }

}

int partition( int a[], int l, int r) {
   int pivot, i, j, t;
   pivot = a[l];
   i = l; j = r+1;

   while( 1)
   {
    do ++i; while( a[i] <= pivot && i <= r );
    do --j; while( a[j] > pivot );
    if( i >= j ) break;
    t = a[i]; a[i] = a[j]; a[j] = t;
   }
   t = a[l]; a[l] = a[j]; a[j] = t;
   return j;
} 
```

# html - 文本框输入高度

> ID：13164048
> 
> 赞同：16
> 
> 时间：2012-10-31T18:03:28.463
> 
> 标签：html, css

我把盒子的尺寸变大了。它在 Dream Weaver 设计视图中看起来更大，但似乎在浏览器中不起作用。

```
<input type="text" **height="60%"**  name=" item" align="left" /> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-31T18:07:12.903

如果要增加输入字段的*高度*，可以为输入字段指定`line-height`css 属性。

```
input {
    line-height: 2em; // 2em is (2 * default line height)
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-12-06T14:15:02.783

我来这里是为了寻找实际上是多行的输入。原来我不想要输入，我想要一个文本区域。您可以设置其他答案指定的高度或行高，但它仍然只是文本框的一行。如果您想要实际的多行，请改用 textarea。下面是一个宽度为 500px 的 3 行 textarea 的示例（应该是页面的一个很好的部分，不需要设置它，必须根据您的要求进行更改）。

```
<textarea name="roleExplanation" style="width: 500px" rows="3">This role is for facility managers and holds the highest permissions in the application.</textarea> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-01T11:50:31.113

您可以为输入字段定义一个`class`或。`id`

或者

```
input {
    line-height: 20px;
} 
```

希望这对您有所帮助。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-31T18:06:53.123

使用 CSS：

```
<input type="text" class="bigText"  name=" item" align="left" />

.bigText {
    height:30px;
} 
```

Dreamweaver 是一个糟糕的测试工具。它不是浏览器。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-31T18:08:36.107

只需使用 CSS 来增加它的高度：

```
<input type="text" style="height:30px;" name="item" align="left" /> 
```

或者，通常，您想通过使用填充而不是指定精确高度来增加它的高度：

```
<input type="text" style="padding: 5px;" name="item" align="left" /> 
```

# android - ViewHolder - 好习惯

> ID：13164054
> 
> 赞同：10
> 
> 时间：2012-10-31T18:03:54.697
> 
> 标签：android, android-viewholder

一个小新手问题。为什么我们要初始化`ViewHolder`in `getView()`？为什么我们不能在构造函数中初始化它？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-31T18:40:56.933

您将有多个`ViewHolder`对象存在。

A`ListView`本质上不会`View`为其每一行创建新实例。这样一来，如果您有`ListView`一百万个事物中的一个，则不需要存储一百万个事物的布局信息。那么你需要存储什么？只是屏幕上的东西。然后，您可以一遍又一遍地重用这些视图。这样，`ListView`一百万个对象中可能只有 10 个子视图。

在您的自定义数组适配器中，您将拥有一个`getView()`看起来像这样的函数：

```
public View getView(int position, View convertView, ViewGroup parent) {
    //Here, position is the index in the list, the convertView is the view to be
    //recycled (or created), and parent is the ListView itself.

    //Grab the convertView as our row of the ListView
    View row = convertView;

    //If the row is null, it means that we aren't recycling anything - so we have
    //to inflate the layout ourselves.
    if(row == null) {
          LayoutInflater inflater = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
          row = inflater.inflate(R.layout.list_item, parent, false);
    }

    //Now either row is the recycled view, or one that we've inflated. All that's left
    //to do is set the data of the row. In this case, assume that the row is just a
    //simple TextView
    TextView textView = (TextView) row.findViewById(R.id.listItemTextView);

    //Grab the item to be rendered. In this case, I'm just using a string, but
    //you will use your underlying object type.
    final String item = getItem(position);

    textView.setText(item);

    //and return the row
    return row;
} 
```

这会起作用，但请花点时间看看你是否能发现这里的低效率。想想上面哪些代码会被冗余调用。

问题是我们`row.findViewById`一遍又一遍地调用，即使在我们第一次查找之后，它也永远不会改变。虽然如果您的列表中只有一个简单`TextView`的，它可能还不错，但如果您有一个复杂的布局，或者您有多个要为其设置数据的视图，您可能会浪费一些时间一遍又一遍地找到您的视图再次。

那么我们如何解决这个问题呢？好吧，在我们查找它之后将它存储在某个地方是有意义的。所以我们引入了一个名为 a 的类`ViewHolder`，它“持有”视图。所以在适配器内部，引入一个像这样的内部类：

```
private static class ViewHolder {
    TextView textView;
} 
```

这个类是私有的，因为它只是适配器的缓存机制，而且它是静态的，所以我们不需要对适配器的引用来使用它。

这将存储我们的视图，这样我们就不必多次调用`row.findViewById`。我们应该在哪里设置它？当我们第一次放大视图时。我们在哪里存储它？视图有一个自定义的“标签”字段，可以用来存储关于视图的元信息——正是我们想要的！然后，如果我们已经看过这个视图，我们只需要查找标签而不是查找行中的每个视图。

所以里面的if语句`getView()`就变成了：

```
//If the row is null, it means that we aren't recycling anything - so we have
//to inflate the layout ourselves.
ViewHolder holder = null;
if(row == null) {
    LayoutInflater inflater = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    row = inflater.inflate(R.layout.list_item, parent, false);
    //Now create the ViewHolder
    holder = new ViewHolder();
    //and set its textView field to the proper value
    holder.textView =  (TextView) row.findViewById(R.id.listItemTextView);
    //and store it as the 'tag' of our view
    row.setTag(holder);
} else {
    //We've already seen this one before!
    holder = (ViewHolder) row.getTag();
} 
```

现在，我们只需要更新 holder.textView 的文本值，因为它已经是对回收视图的引用！所以我们最终的适配器代码变成了：

```
public View getView(int position, View convertView, ViewGroup parent) {
    //Here, position is the index in the list, the convertView is the view to be
    //recycled (or created), and parent is the ListView itself.

    //Grab the convertView as our row of the ListView
    View row = convertView;

    //If the row is null, it means that we aren't recycling anything - so we have
    //to inflate the layout ourselves.
    ViewHolder holder = null;
    if(row == null) {
        LayoutInflater inflater = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        row = inflater.inflate(R.layout.list_item, parent, false);
        //Now create the ViewHolder
        holder = new ViewHolder();
        //and set its textView field to the proper value
        holder.textView =  (TextView) row.findViewById(R.id.listItemTextView);
        //and store it as the 'tag' of our view
        row.setTag(holder);
    } else {
        //We've already seen this one before!
        holder = (ViewHolder) row.getTag();
    }

    //Grab the item to be rendered. In this case, I'm just using a string, but
    //you will use your underlying object type.
    final String item = getItem(position);

    //And update the ViewHolder for this View's text to the correct text.
    holder.textView.setText(item);

    //and return the row
    return row;
} 
```

我们完成了！

需要考虑的一些事情：

1.  如果您想要更改一行中有多个视图，这将如何变化？作为一个挑战，制作一个 ListView ，其中每行有两个`TextView`对象和一个`ImageView`
2.  在调试您的 ListView 时，请检查几件事，以便您可以真正了解发生了什么：
    1.  ViewHolder 的构造函数被调用了多少次。
    2.  `holder.textView.getText()`在你更新它之前的值是什么`getView()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T18:15:00.627

当我们每次填充行并为每一行创建新的行视图时滚动列表时，我们需要初始化视图持有者。就像我有两个 TextView 一样，

```
 static class ViewHolder {
        protected TextView title;
        protected TextView type;

    }

     public View getView(int position, View convertView, ViewGroup parent) {
            View view = null;
            if (convertView == null) {
                LayoutInflater inflator = context.getLayoutInflater();
                view = inflator.inflate(R.layout.feeds_rowview, null);
                final ViewHolder viewHolder = new ViewHolder();
                view.setTag(viewHolder);
                viewHolder.title = (TextView) view.findViewById(R.id.Title);
                viewHolder.type = (TextView) view.findViewById(R.id.Type);

            } else {
                view = convertView;
            }

            ViewHolder holder = (ViewHolder) view.getTag();
            holder.title.setText(list.get(position).getTitle());
            holder.type.setText(list.get(position).getType());

            return view;
     } 
```

# reference - 如何在 jcr 中引用属性

> ID：13164060
> 
> 赞同：2
> 
> 时间：2012-10-31T18:04:15.563
> 
> 标签：reference, nodes, jcr

假设我在 JCR 中有一个节点，该节点以英文提供电影的属性，例如标题、导演和演员。然后我有另一个节点存储相同的属性，但使用另一种语言，比如法语。有没有办法让法语节点引用英语节点，这样只有需要翻译的属性才会实际存储在第二个节点上。前任：

-englishNode Properties Title: The Sword in the Stone 导演: Wolfgang Reitherman 演员: Sebastian Cabot

-frenchNode 属性标题：Merlin L'Enchanteur

但是导演和演员属性将从英文节点中检索，因为它们不需要翻译。但是，调用 frenchNode.getProperty("director") 需要从englishNode 检索属性。

我知道我可以使法语节点成为英语节点的子节点并继承其属性，但我需要一个结构，其中所有英语电影都位于英语节点下，所有法语电影都位于法语节点下，所以是法国电影不能是英国人的兄弟姐妹，而是“表亲”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T19:11:57.723

我知道 JCR 中没有任何东西可以直接适应这种情况。但我能想到几种可能的选择。每个都有自己的好处，一种解决方案可能在一种情况下效果很好，而在另一种情况下则很糟糕。

**本地特定子节点** 将一种语言作为主要语言（例如，无论备用或更流行的本地语言可能是什么），并将本地特定属性放在该节点下的本地特定子节点上。因此，如果英语是主要语言，那么电影属性可能会存储在电影节点上。法语属性可能存储在“fr”子节点上，德语属性存储在“de”子节点上，等等。一个优点是您的应用程序只需要加载它使用的语言环境。

**后备引用** 创建从一个节点到“后备”的引用属性，并让您的逻辑在检索属性时考虑到这一点。如果该属性不在该节点上，则从回退中获取它，在该处可以使用 检索回退节点`movie.getProperty("fallback").getNode()`。（请注意，使此递归非常容易，其中回退可能有回退。）这允许将节点存储在不同的位置。但是，请注意循环后备引用（英语的后备是法语，法语的后备是英语）；这是可以处理的，但它需要跟踪一些状态。同样，您的应用程序仅根据需要加载具有特定于语言环境的属性的节点。

**本地特定属性** 在电影节点上存储所有属性，包括英文、法文和任何其他语言的标题。在属性名称上使用后缀或前缀来表示语言环境（例如，`en-title`和`fr-title`）。加载单个节点往往会加载所有属性的所有语言环境变量。因此，这适用于较少的语言、较少的本地特定属性和较少的整体属性。

**每个“属性”的子节点** 将每个“属性”（例如“标题”）放置为子节点，每个特定于语言环境的值都存储为属性。同样，由于加载节点会加载所有语言环境的值，因此这对于较少数量的语言和特定于语言环境的值会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T08:38:04.260

我也不认为 JCR 提供了开箱即用的东西。

在[Apache Sling](http://sling.apache.org/)中，我们使用类似的机制来允许“用户”脚本覆盖“系统”脚本：处理给定的请求 Sling 可能会发现 /libs/foo/foo.esp 中的脚本是一个很好的候选者，但是如果 /apps/foo/foo.esp 有另一个脚本，它将被使用。

如果后者存在，您可以通过使用 /content/books/fr/title 覆盖说 /content/books/en/title 属性来做同样的事情。您必须在应用程序级别执行此操作，但这种“并行路径”结构清晰且易于理解和管理，您只需定义路径的哪一部分代表内容的区域设置。

# css - 使用引导网格时使段落看起来更好

> ID：13164062
> 
> 赞同：-1
> 
> 时间：2012-10-31T18:04:25.830
> 
> 标签：css, twitter-bootstrap, position

您好，我正在使用引导网格并尝试这样做：

[![图片](../Images/8680ba4173c6e54f982771fd43ee9837.png)](https://i.stack.imgur.com/BXwdJ.png)
[（来源：[gyazo.com](http://gyazo.com/8bf865ea19bb09408e7dd214f1887d24.png)）]

这就是我用来尝试得到这样的东西：

顺便说一句，代码在引导容器中，

```
<div class="headers">

    <li class="span3">
    <div id="icon-1"></div>
    <span class="head">Experienced</span>
    <p class="paragraph">Brought to you by a well-knowledged developer and designer, that are ready to serve. We deliver one Hell of a product so strap yourself down to your chair and get ready.</p>
    </li>
    <li class="span3">
    <div id="icon-2"></div>
    <span class="headweb">Web Development</span>
    </li>
    <li class="span3">
    <div id="icon-3"></div>
    <span class="head">UI/UX Design</span>
    </li>
</div> 
```

结果是这样的：

[![图2](../Images/80ed29f742f17d23e09394a3fe8a2aad.png)](https://i.stack.imgur.com/k2ow3.png)
[（来源：[gyazo.com](http://gyazo.com/351f69ce5b85c9b66a38de96c393750e.png)）]

如您所见，该段落看起来与第一段不同，那是因为引导网格跨度类编号太短，但如果我使用跨度 4，则图标只会弄乱到底部。

我怎样才能让段落看起来有点像第一张图片中的样子？这里有什么问题？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:33:44.153

Your text looks a larger than the orig, but that's too simple. Try making a new class, .span3wide and in your stylesheet increase the size, reduce the padding/margin. Also, add margin:0 auto; to #icon-1 to centre.

# ruby-on-rails - rails中的文件下载链接

> ID：13164063
> 
> 赞同：66
> 
> 时间：2012-10-31T18:04:27.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3, hyperlink, download, link-to

我想为访问者提供下载一些 pdf 的选项。我试过了：

```
<%= link_to "abc", "/data/abc.pdf"%>

<%= link_to "abc", "/data/abc.pdf", :format => 'pdf' %> 
```

和一些变化，但它们似乎不起作用。我不断得到`No route matches [GET] "/data/abc.pdf"`

我有一个名为 data 的文件夹中的 pdf 文件，该文件夹位于 assets 文件夹中。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-10-31T18:13:46.397

**导轨 4：**

在路线：

```
get "home/download_pdf" 
```

在控制器中（已经有pdf）：

```
def download_pdf
  send_file(
    "#{Rails.root}/public/your_file.pdf",
    filename: "your_custom_file_name.pdf",
    type: "application/pdf"
  )
end 
```

在控制器中（需要生成pdf）：

```
require "prawn"
class ClientsController < ApplicationController

  def download_pdf
    client = Client.find(params[:id])
    send_data generate_pdf(client),
              filename: "#{client.name}.pdf",
              type: "application/pdf"
  end

  private

  def generate_pdf(client)
    Prawn::Document.new do
      text client.name, align: :center
      text "Address: #{client.address}"
      text "Email: #{client.email}"
    end.render
  end
end 
```

鉴于：

```
<%= link_to 'Download PDF', home_download_pdf_url %> 
```

**导轨 3**

这样做的方法：

```
def download
  send_data pdf,
    :filename => "abc.pdf",
    :type => "application/pdf"
end 
```

你应该去这个选择

**导轨 < 3**

**公共文件夹中的文件**

这可能是您的答案：[如何从 Rails 应用程序下载文件](https://stackoverflow.com/questions/6392003/how-to-download-a-file-from-rails-application)

您应该将文件放在公用文件夹中，这就是诀窍。

正确放置文件时应该可以工作。

如果您无法将文件移动到公用文件夹，请告诉我。

**通过控制器下载**

创建一个具有下载操作的控制器，`link_to`它

```
 def download
    send_file '/assets/data/abc.pdf', :type=>"application/pdf", :x_sendfile=>true
  end 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2013-12-25T09:10:09.817

导轨 4：

在路线：

```
get "home/download_pdf" 
```

在控制器中（已经有pdf）：

```
def download_pdf
  send_file(
    "#{Rails.root}/public/your_file.pdf",
    filename: "your_custom_file_name.pdf",
    type: "application/pdf"
  )
end 
```

在控制器中（需要生成pdf）：

```
require "prawn"
class ClientsController < ApplicationController

  def download_pdf
    client = Client.find(params[:id])
    send_data generate_pdf(client),
              filename: "#{client.name}.pdf",
              type: "application/pdf"
  end

  private

  def generate_pdf(client)
    Prawn::Document.new do
      text client.name, align: :center
      text "Address: #{client.address}"
      text "Email: #{client.email}"
    end.render
  end
end 
```

鉴于：

```
<%= link_to 'Download PDF', home_download_pdf_url %> 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2016-07-11T19:54:07.297

如果文件是静态的（意味着它们不会更改），请将它们放在公用文件夹中。

然后你可以下载喜欢

```
<a href="file.pdf" download>PDF</a> 
```

或与 ERB

```
<%= link_to 'PDF', 'file.pdf', download: '' %> 
```

并给文件另一个名称以供下载，只需将该名称传递给下载选项

```
<%= link_to 'PDF', 'file.pdf', download: 'data' %> 
```

这将下载文件`data.pdf`而不是`file.pdf`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-02-15T14:19:47.443

你可以像这样简单地调用你的控制器动作

```
<%= link_to "Download", download_file_path, class: "btn btn-sm btn-default", target: "_blank" %> 
```

在你的控制器中

```
def download_file
 redirect_to paperclip_attachment.file.url
end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-10T13:12:30.450

我努力寻找从公共目录自动下载某些文件的简单方法。最后我想出了这个解决方案。例如：我将我的文件放在公共目录内的 SVG 文件夹中。

```
Public/svg/Test1.xlsx 
```

现在，当我尝试访问它时，它会加载它并使用回形针给出路径，它会给出问题。即使当我尝试完整路径时，它也会出现问题，因此我们可以使其成为动态路径。首先获取主机的路径，以便可以轻松重定向。<% url = request.original_url.chomp(request.fullpath) %>

现在我们可以访问公共文件夹中的任何文件，如下所示并通过 id 和下载选项。下载选项重命名您要下载的任何文件。

```
<%= link_to 'Database File', "#{url}/svgs/Test1.xlsx", download: 'Data.xlsx',id: "Link_to_Downlaod" %> 
```

现在可以点击链接已准备就绪，我们可以点击上面的链接下载文件。使用以下脚本自动下载文件。

```
 <script type="text/javascript">
    window.onload = document.getElementById('Link_to_Downlaod').click();
  </script>
</div> 
```

对于 PDF 或任何其他文件类型，只需更改文件扩展名。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-16T17:19:33.110

对我来说，链接到 pdf 文件的最佳解决方案是通过以下简单步骤：

1-将您的pdf文件添加到公共文件夹中

2- `<%= link_to "/nameofthefile.pdf",target: "_blank" do %>pdf 文件<% end %>

这是通过详细信息向您展示的视频[https://www.youtube.com/watch?v=bNZ6FJrZ_lo&t=64s](https://www.youtube.com/watch?v=bNZ6FJrZ_lo&t=64s) `

# ruby-on-rails-3 - 过期日期错误的 Rails cookie

> ID：13164064
> 
> 赞同：2
> 
> 时间：2012-10-31T18:04:33.300
> 
> 标签：ruby-on-rails-3, cookies

最近我试图设置一个 cookie 以验证 Rails 3.2 应用程序中的会话。

cookie 应该在第二天开始时过期，这样我会强制用户再次登录（强制）

首先，我将应用程序的时区更改为我期望处理的时区：

```
config.time_zone = 'Caracas' 
```

之后，我按如下方式创建了 cookie：

```
cookies[:remember_token] = {value: user.remember_token, 
                            expires: 1.day.from_now.beginning_of_day} 
```

cookie 的创建没有任何问题，但过期日期错误。在 Chromium 中，日期设置为今天晚上 19​​:30（尽管我的机器时区是根据应用程序设置的）。

当我将 cookie 的定义更改为：

```
cookies[:remember_token] = {value: user.remember_token, 
                            expires: 1.day.from_now} 
```

如果我仅将 cookie 设置为从今天起 1 天，那么过期日期将正确设置为从现在起正好 24 小时。

任何想法为什么 begin_of_date 没有正确设置日期？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:42:10.923

这取决于执行的顺序。计算一天的开始后应用时区。例如，我在 UTC 时区，我可以在以下时间执行以下操作`rails console`：

```
irb(main):019:0> 1.day.from_now.in_time_zone(Time.zone).beginning_of_day
=> Thu, 01 Nov 2012 00:00:00 UTC +00:00
irb(main):020:0> 1.day.from_now.beginning_of_day.in_time_zone(Time.zone)
=> Thu, 01 Nov 2012 00:00:00 UTC +00:00
irb(main):021:0> Time.zone.now.tomorrow.beginning_of_day 
=> Thu, 01 Nov 2012 00:00:00 UTC +00:00
irb(main):022:0> 1.day.from_now.beginning_of_day.in_time_zone('Caracas')
=> Wed, 31 Oct 2012 19:30:00 VET -04:30
irb(main):023:0> 1.day.from_now.in_time_zone('Caracas').beginning_of_day
=> Thu, 01 Nov 2012 00:00:00 VET -04:30 
```

因此，如果您将 cookie 计算更改为以下内容，它应该可以工作：

```
cookies[:remember_token] = {value: user.remember_token, 
                            expires: 1.day.from_now.in_time_zone(Time.zone).beginning_of_day} 
```

# jquery - jQuery 1.8.0 1.8.1 1.8.2 - 为什么 $('%') 会引发异常？

> ID：13164065
> 
> 赞同：0
> 
> 时间：2012-10-31T18:04:37.847
> 
> 标签：jquery

我认为如果选择器无效，它将返回一个空集以保持可链接性，但在这种情况下，它会引发异常：

未捕获的错误：语法错误，无法识别的表达式：%

还：

```
$('aaa % bbb'); // raises exception. 
```

但：

```
$('aaa % <a>bbbb</a>'); // does NOT raise an exception. 
```

有人可以解释一下吗？

它曾经在 1.7.2 中工作

# split - 如何在 Vim 中自动调整当前拆分的大小？

> ID：13164071
> 
> 赞同：2
> 
> 时间：2012-10-31T18:05:01.307
> 
> 标签：split, vim, vim-plugin

是否有一个插件或函数可以自动调整当前拆分的大小以恰好有 80 列？

并允许触发该功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T18:34:45.570

如果您的意思是当前窗口，那么这只是

```
function ToggleResize()
    if exists('#AutoResize80')
        augroup AutoResize80
            autocmd!
        augroup END
        augroup! AutoResize80
    else
        augroup AutoResize80
            autocmd! BufEnter * :vertical resize 80
        augroup END
    endif
endfunction 
```

# javascript - 如何在javascript中制作图像滑块

> ID：13164078
> 
> 赞同：2
> 
> 时间：2012-10-31T18:05:42.600
> 
> 标签：javascript, jquery, css

我`image slider`在 javascript/jquery 中实现一个。

演示应该像这样工作。 [http://londatiga.net/tutorials/scrollable/](http://londatiga.net/tutorials/scrollable/)
无论如何我不会不依赖 jquery.tools.min.js 因为这个库已经过时了（最后一次更新大约是 8 个月前）。
我决定自己做js代码。

单击下一个或上一个按钮时，我想移动一个项目/图像列表中的图像。该脚本移动了项目，但显示非常糟糕，因为没有显示下一个项目。

该列表由 4 个图像组成。一开始只显示前两个图像，然后单击下一步按钮时，我想显示第二个和第三个图像。

实际上，即使我单击下一个按钮，脚本也只显示第一张和第二张图像。

这是演示： http: [//jsfiddle.net/xRQBS/5/](http://jsfiddle.net/xRQBS/5/) 这是代码（1）

任何提示我应该如何解决它？谢谢

(1)

```
/*global jQuery */
(function ($) {

    var imgs = [
    'https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcSsarNmO4Vdo5QwHfznbyxPmOyiYQ-KmBKUFsgEirvjW6Kbm7tj8w',
    'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRfIAfLXj3oK1lso1_0iQploSKsogfJFey3NnR0nSD9AfpWjU7egA',
    'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR1dO4FVDDitdS85aLOCsOpQyHHTysDhD4kHQ749bMtNxaj5GMKnA',
    'https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcRAPO77sVu-Xk80S_txagySoTq8gKHgeiS63a9TYtKbPpGYVI5X'
    ];

    var $list = $('.list-images');

    var $slider = $('.slider');

    var slideImage = function (direction) {
        var unit = 150;
        var left = parseInt($slider.attr('left'), 10) || 0;

        left = (direction === 'prev') ? left - 150 : left + 150; 

        $slider.css('left', left + 'px'); 

    };

    $(function () {
        $.each(imgs, function (i, img) {
            $list.append($('<li>').append($('<img>').attr('src', img)));
        });

        $('body').on('click', '.direction', function () {
            slideImage($(this).attr('data-tid'));
        });
    });

}(jQuery));
​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:16:46.293

使用动画功能：

```
$slider.animate({'left': left + 'px'}, 1000); 
```

[http://jsfiddle.net/xRQBS/6/](http://jsfiddle.net/xRQBS/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T18:17:20.367

我假设您希望这种转变更像是一种动画。如果是这样，请查看 jQuery 的动画。像这样的东西：

```
$slider.animate({left: left + 'px'}); 
```

这会给它一个滑动效果，我假设你想要:)

# iphone - 尝试编写一个简单的应用程序以允许用户拖动图像

> ID：13164080
> 
> 赞同：0
> 
> 时间：2012-10-31T18:06:02.200
> 
> 标签：iphone

我正在尝试编写一个应用程序来允许一个人在地球图像周围拖动。

`touchesmoved`当用户开始拖动他的脚时调用该方法，但从`[[ event allTouches] anyObject]`不返回`earth`对象，因此它永远不会被拖动，

```
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

    UITouch *touch=[[ event allTouches] anyObject];

    if ( [touch view] == earth )
    {
        CGPoint location = [ touch locationInView: self.view];
        earth.center=location;          
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:32:58.627

用于触摸使用`UITouch *touch=[touches anyObject];`

改变你的`touchesMoved:`喜欢：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
 {

    UITouch *touch=[ touches anyObject];

    if ( [touch view] == earth )
    {
        CGPoint location = [ touch locationInView: self.view];
        earth.center=location;          
    }
} 
```

# javascript - 将不同内的所有数字相乘 然后总结一下

> ID：13164086
> 
> 赞同：2
> 
> 时间：2012-10-31T18:06:33.757
> 
> 标签：javascript, jquery, html

我有一个购物车页面，显示在购物车页面上的每个产品都在一个 div 框内。

每个 div 框都有这样显示的价格`<p id="price">599<p>`

我怎样才能抓住这些里面的所有数字

然后总结并在另一个中显示总数`<p></p>`？

根据购物车中有多少产品，会生成许多 div 框。假设我们有 2 个产品，这意味着 2 个 div 框：

```
<div id="holder@(model.ProductId)" class="holder">  
             <img src="@Html.DisplayFor(modelItem => item.Image)" alt="" />
               <div class="productinfo">
               <h2>Bike</h2> 
               <p>It will take 24 hours to deliver</p>    
               </div>
                <div class="productprice">     
                <p class="price">599<p>                                    
               </div> 
```

第二个：

```
<div id="holder@(model.ProductId)" class="holder">  
             <img src="@Html.DisplayFor(modelItem => item.Image)" alt="" />
               <div class="productinfo">
               <h2>car</h2> 
               <p>It will take 24 hours to deliver</p>    
               </div>
                <div class="productprice">     
                <p class="price">1599<p>                                     
               </div> 
```

这是应该触发此功能的按钮：

```
<input type="button" value="Update" class="a" /> 
```

我怎么能用 Jquery 做到这一点，不知何故我需要检查有多少`<p class="price"><p>`，然后 eval() 它们，然后将它们相乘并将总数存储在不同的`<p></p>`？

任何形式的帮助表示赞赏

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T18:11:23.683

```
var total = 0;
$("p.price").each(function(i){
   total += parseFloat($(this).text(), 10);
}); 
```

**[例子](http://jsfiddle.net/3tMfr/6/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T18:13:03.470

```
$(document).ready(function(){
  $('.a').click(function(){
   var total = 0;
   $('.price').each(function(){
    total += parseInt($(this).text());
   });

   //update total

  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T18:20:10.320

Chase 解决方案的替代方案：

```
var total = 0;
$("p.price").each(function(i){
    total += !isNaN(c = +$(this).text())?c:0;
}); 
```

[例子](http://jsfiddle.net/3tMfr/3/)

# android - 是否有适用于 Android 的开源工作 RDP 客户端？

> ID：13164088
> 
> 赞同：5
> 
> 时间：2012-10-31T18:06:50.577
> 
> 标签：android, open-source, rdp

是否有任何完全实现的 RDP 客户端，它们是为 android 开源的？我尝试了一些，发现它们不完整/不起作用。这是我尝试过的一些。

1.) [http://code.google.com/p/desktoid/](http://code.google.com/p/desktoid/) ...似乎自 2009 年以来被放弃，从未完全实施

2.) [http://code.google.com/p/connectoid/](http://code.google.com/p/connectoid/) .. 这是desktoid的基础，自2009年以来也被放弃，没有完全实现。（据我所知）

3.）Omindesk（我找不到链接）......也没有完全实现。

有没有人找到任何适用于 android 的 RDP 客户端，或者任何易于使用的 RDP 客户端？...或者也许，其中一些确实有效，而我只是在错误地使用它们。我对android开发很陌生。

非常感谢任何建议=)。AtDhVaNkCsE !!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T20:21:31.620

这是你要找的吗？：[FreeRDP：远程桌面协议实现](http://www.freerdp.com/)

> FreeRDP 是远程桌面协议 (RDP) 的免费实现，在 Apache 许可下发布。在一个互操作性最终可以解放您的计算体验的世界中，享受随时随地以您想要的方式使用您的软件的自由。

[Thinstuff Android 客户端发布](http://www.freerdp.com/2013/01/29/thinstuff-android-client-released/)

> Thinstuff 自豪地宣布 FreeRDP Android 客户端 aFreeRDP 现在可以在 git master 中使用。
> 
> aFreeRDP 已经相当成熟，并带有许多不错的功能：
> 
> *   内置触控笔和手势帮助
> *   用于在会话中更轻松地进行用户输入的触摸指针
> *   用于常见输入任务的手势，如滚动、缩放等。
> *   用于高级用户输入的自定义键盘视图（即 Win+E 等常用快捷键）
> *   灵活的连接管理 UI 允许快速连接到主机以及处理具有多个预定义连接的大型列表
> 
> 该构建无缝集成到 FreeRDPs 构建系统中——您只需安装 Android NDK/SDK 和 ant。有关如何构建 FreeRDP 的详细说明，请参阅 docs/README.android。

# html - XSL 禁用输出转义不起作用

> ID：13164090
> 
> 赞同：1
> 
> 时间：2012-10-31T18:06:53.173
> 
> 标签：html, xslt

我正在从数据库中提取参数

```
<xsl:param name="theMessage"></xsl:param> 
```

提取的 html 数据如下：

```
<style type="text/css">#container {width:100%; margin-top:20px; text-align:center; font-family: Verdana, arial; font-size:100%; font-weight:normal; }</style><div id="container"><b>Text here</b></div> 
```

XSL：

```
<xsl:value-of select="$theMessage" disable-output-escaping="yes" /> 
```

它显示为代码而不是所需的输出。关于我哪里出错的任何想法？它是在 xsl 端还是我需要数据库中的 CDATA 等？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:51:13.020

如果将元素作为参数传递，则需要使用**xsl:copy-of**而不是**xsl:value-of**

```
<xsl:copy-of select="$theMessage" /> 
```

所有**xsl:value-of**都会输出元素的文本，而不是元素本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T17:36:36.637

虽然过去输出转义对我有用，但它在这串数据上没有这样做，因为数据包含需要转义的 ' 标记。

所以字符串就是这样（在java中）。

```
returnStr = returnStr.replace("'","\\'"); - this escaped those pesky tic marks, or single quotes 
```

returnStr 等于：`<style type="text/css">#container {width:100%; margin-top:20px; text-align:center; font-family: Verdana, arial; font-size:100%; font-weight:normal; }</style><div id="container"><b>Text here</b></div>`...加上更多的 html 代码和文本

xsl 参数是相同的：

```
<xsl:param name="theMessage"></xsl:param> 
```

在样式表上，新代码如下所示：

```
<div id="bilbo"></div>
    <script type="text/javascript">
    var outputString = '<xsl:value-of select="$theMessage" />'
    document.getElementById('bilbo').innerHTML = outputString;
    </script> 
```

从数据库中提取数据，去掉单引号，将字符串设置为 xsl 参数，将参数设置为 js 变量，然后将其作为所需的 html 放入 div 中 - 作为输出。

# php - 通过 php 卷曲文件时获取 XSRF 检查失败

> ID：13164094
> 
> 赞同：1
> 
> 时间：2012-10-31T18:07:00.863
> 
> 标签：php, curl, jira

我有以下代码尝试将附件上传到 Jira 问题：

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_USERPWD, "username:password");
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
    'Content-Type: multipart/form-data;'
));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_URL, 'https://jira.example.com/rest/api/2/issue/JT-1/attachments');
curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'POST');
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
// same as <input type="file" name="file_box">
$post = array(
    "file"=>"@/tmp/Screen_Shot_2012_10_18_at_2.58.33_PM.png",
);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post); 
$response = curl_exec($ch);

var_dump($response);
var_dump(curl_error($ch));

curl_close($ch); 
```

但是我收到一条错误消息：

```
XSRF check failed 
```

我该怎么做才能防止出现此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:18:13.457

发现我需要添加标题：

```
X-Atlassian-Token: nocheck 
```

应我的要求。

# guava - 停止收听自己的事件？

> ID：13164101
> 
> 赞同：2
> 
> 时间：2012-10-31T18:07:20.843
> 
> 标签：guava

订阅某个事件类的类是否可以在不监听的情况下触发相同的事件类型？

例子：

```
Class A {

  EventBus bus = new EventBus();
  public A() {
     bus.register(this);
     bus.post ( new String("event!"));
  }

  @Subscribe public void consume(String event) {
     System.out.println("Got event: "+event);
  }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:28:44.373

您可以让您的事件类包含事件的源（发布事件的对象），然后忽略源为 的任何事件`this`。不过，我建议尝试让您的班级始终如一地处理事件，而不管来源如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:29:33.687

不，没有。EventBus 如何首先确定事件的起源？

如果要忽略某些事件，则必须在事件对象本身中包含足够的信息以确定是否应忽略该事件。

# xml - 用开始和结束标记将相同 XML 标记的组括起来

> ID：13164103
> 
> 赞同：0
> 
> 时间：2012-10-31T18:07:23.890
> 
> 标签：xml, insert, tags

如何在 XML 文档中围绕一组相同的 xml 标签插入结束和结束标签？例如，如果我的原始 XML 如下所示：

```
<recordImport OperatorID="ABC123">
     <patients>
        <patient roomNo=1 name="George Washington" addressID="1">
            <address ID="1" street="123 Credibility Street" city="Boston" state="MA"/>
            <address ID="1" street="456 Aqualung Avenue" city="Seattle" state="WA"/>
        </patient>
        <patient roomNo=2 name="Thomas Jefferson" addressID="2">
            <address ID="2" street="5 Famous Street" city="Burbank" state="CA"/>
        </patient>
     </patients>
 </recordImport> 
```

我如何插入“地址”标签，如下所示：

```
<recordImport OperatorID="ABC123">
    <patients>
        <patient roomNo=1 name="George Washington" addressID="1">
           <addresses>
              <address ID="1" street="123 Credibility Street" city="Boston" state="MA"/>
              <address ID="1" street="456 Aqualung Avenue" city="Seattle" state="WA"/>
           </addresses>
        </patient>
        <patient roomNo=2 name="Thomas Jefferson" addressID="2">
            <addresses>
              <address ID="2" street="5 Famous Street" city="Burbank" state="CA"/>
            </addresses>              
        </patient>
    </patients>
</recordImport> 
```

我更喜欢非 LINQ 解决方案，但如果归根结底，我会使用它。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:33:34.113

在这个特定的示例中，您只需包含一个`<addresses>`元素作为 every 的子元素`<patient>`，这对于使用 XSLT 来说是微不足道的。大概一般情况更复杂。

使用 XSLT 2.0 的一般解决方案是：

```
<xsl:template match="*[address]">
  <xsl:for-each-group select="*" group-adjacent="node-name()">
    <xsl:choose>
      <xsl:when test="self::address">
         <addresses><xsl:copy-of select="current-group()"/></addresses>
      </xsl:when>
      <xsl:otherwise>
        <xsl:copy-of select="current-group()"/>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:for-each-group>
</xsl:template> 
```

结合身份模板复制其他内容不变。

# android - 如何制作 Android Sensor SensorEvent 对象的副本

> ID：13164107
> 
> 赞同：1
> 
> 时间：2012-10-31T18:07:36.707
> 
> 标签：android, android-sensors, sensormanager

我有一个备用数组，我用它来存储和批处理 SensorEvents，方法是按住每个传感器 typeId 和 SensorEvent 对象，直到计时器触发。

```
 SparseArray<SensorEvent> sensorEventMap   = new SparseArray<SensorEvent>();

  public void onSensorChanged(SensorEvent event) {
    synchronized (this) {
        sensorEventMap.put(event.sensor.getType(), event);
    }
} 
```

在我的计时器触发之前，我遇到了 SensorEvent 在数组中被覆盖的问题，因此我想制作 SensorEvent 的副本并将副本存储在数组中。

如何制作 SensorEvent 的副本？

我需要整个 SensorEvent，而不仅仅是数据值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:22:34.193

不可能，因为它是一个系统类，您将无法使其实现可克隆接口。最好只创建自己的克隆类并自己复制它。

# java - 在 catalina.bat 中合适的地方设置 JAVA_OPTS

> ID：13164115
> 
> 赞同：7
> 
> 时间：2012-10-31T18:08:10.233
> 
> 标签：java, tomcat

我收到以下错误

```
"java.lang.OutOfMemoryError: PermGen space" 
```

在我的`catalina.bat`文件中，输入`set JAVA_OPTS`参数的合适位置在哪里？文件底部还是其他地方？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-31T18:17:30.400

请阅读：[**OutOfMemory 错误**](http://wiki.apache.org/tomcat/OutOfMemory)并确保您的应用程序没有内存泄漏和过多的内存使用。

要更改设置，请创建一个名为`setenv.bat`windows 或`setenv.sh`Linux 的文件，其条目如下：

视窗：

```
set JAVA_OPTS="-Xms256m -Xmx512m" 
```

Linux：

```
export JAVA_OPTS="-Xms256m -Xmx512m" 
```

只需将此（setenv.bat/setenv.sh）文件放在`%CATALINA_HOME%\bin\`文件夹中。您的命令文件 ( `catalina.bat/catalina.sh`) 已经有如下语句：

视窗：

```
 if exist "%CATALINA_HOME%\bin\setenv.bat" call "%CATALINA_HOME%\bin\setenv.bat" 
```

Linux：

```
 if [ -r "$CATALINA_BASE/bin/setenv.sh" ]; then
     . "$CATALINA_BASE/bin/setenv.sh"
  elif [ -r "$CATALINA_HOME/bin/setenv.sh" ]; then
     . "$CATALINA_HOME/bin/setenv.sh"
  fi 
```

这将照顾其余的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-31T18:12:54.680

正确的位置是在 catalina.bat 旁边的 Tomcat /bin 目录中创建一个新文件，命名`setenv.bat`并在`set JAVA_OPTS=...`那里放置一个。

在 *nix 系统上它会是`setenv.sh`

catalina.bat/catalina.sh 负责运行 setenv.bat/setenv.sh（如果存在）。[这在此处](http://tomcat.apache.org/tomcat-7.0-doc/RUNNING.txt)的第 3.4 节中有所说明

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-31T18:39:07.463

就像其他人已经建议您需要使用`JAVA_OPTS`set 一样： `JAVA_OPTS="-XX:MaxPermSize=98m"`. 仅此一项，可能会解决问题，但是如果您要重新部署很多次并且您的 war/jar 很大，您也会达到此内存限制。

对于最后一种情况，在测试/开发机器上是正常的，我建议使用：

`-XX:+CMSClassUnloadingEnabled -XX:+UseConcMarkSweepGC`

此选项将启用卸载未使用的类。

看[这里](http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang)更多细节，尤其是评论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T18:11:07.550

发生这种情况是因为您多次重新部署。你可以增加你的烫发空间，但这只会延迟不可避免的错误。

您只需要重新启动服务器。我不知道解决方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T18:11:29.890

在你的环境中。我们可以创建一个设置 JAVA_OPTS 的包装脚本，然后调用 catalina 脚本。

# css - 如果有一个 --> .content p, .content ul, .content li, .content a，那么 SASS 方法要求干燥这样的东西是什么？

> ID：13164118
> 
> 赞同：0
> 
> 时间：2012-10-31T18:08:29.393
> 
> 标签：css, sass, css-selectors

什么是 SASS 方式要求干燥这样的东西：

```
.content p, .content ul, .content li, .content a 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T18:12:34.757

所有这 4 个元素都有共同的风格吗？

```
.content {
    p, ul, li, a {
        // styles they all share
    }
} 
```

# jquery - jquery mouseover 和 mouseout 在多个内容和按钮上

> ID：13164125
> 
> 赞同：1
> 
> 时间：2012-10-31T18:09:11.023
> 
> 标签：jquery, mouseover, mouseout

尝试了很多东西，但无法让它发挥作用。当用户将鼠标悬停在第一个按钮上时，将显示第一个内容。我的代码现在正在运行，但是当我将鼠标移出按钮时，页面中的所有内容都消失了。

另外，当我将鼠标移出按钮时，我希望显示一些默认内容。

```
<div class="parent">
    <div class="button"></div>
    <div class="button"></div>
    <div class="content-container">
        <div class="content"></div>
    </div>
</div>
<div class="parent">
    <div class="button"></div>
    <div class="button"></div>
    <div class="content-container">
        <div class="content"></div>
    </div>
</div> 
```

我的 javascript

```
$(".button").mouseover(function(){      
    $(".content-container").eq(depends on parent number).append("<div class='content'>" + value + '</div>');
}).mouseout(function(){$(".content").remove();}); 
```

让我的问题清楚。当用户鼠标事件到 .parent 之一中的按钮时，它只会删除内容或将内容添加到父级容器中。

而且我还需要一个解决方案来在鼠标移出时设置默认内容，否则内容 div 将为空白。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:19:06.577

我不确定我是否理解这个问题，但这里有几件事可能会有所帮助：

使用类进行样式设置，而不是标识。

如果您有要更改的 html 部分，请放在

```
<div id="my_default_content">..some content...</div> 
```

现在假设您有一个按钮，并且您想要删除内容：

```
<button onclick="function() {$('#my_default_content').css('visibility', 'none')}">Clear</button> 
```

或者，您可以通过将“可见性”设置为“可见”来使内容再次可见。如果您希望 div 不占用空间，请将“display”设置为“none”。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T18:21:29.680

```
$(".button").on({
    mouseenter: function() {
        var content = $('<div />', {text: this.value, 'class': 'content'});
        $(this).siblings('.content-container').html(content);
    },
    mouseleave: function() {
        var default = $('<div />', {text: 'Hello Kitty'});
        $(this).siblings('.content-container').html(default);
    } 
}); 
```

# asp.net - 如何使用带有 SQL Membership Provider 的 ASP.NET4.5 登录表单？

> ID：13164129
> 
> 赞同：0
> 
> 时间：2012-10-31T18:09:26.693
> 
> 标签：asp.net, vb.net, membership-provider

我在 ASP.NET 4.5 网络表单中使用新的登录控件，需要根据我的 SQL 成员资格提供程序检查用户名和密码。我已经设置了成员资格和角色，并通过 Web 应用程序工具创建了我的用户。

当我尝试登录时，我的用户名和密码未针对会员提供者进行身份验证。以下是 web.confgi 中的相关条目：

```
 <membership defaultProvider="DefaultMembershipProvider">
  <providers>
    <add connectionStringName="WebTrendsConnectionString" enablePasswordRetrieval="false"
      enablePasswordReset="true" requiresQuestionAndAnswer="false"
      requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6"
      minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
      applicationName="/" name="DefaultMembershipProvider" 
      type="System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, 
      Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </providers>
</membership>
<roleManager enabled="true" defaultProvider="DefaultRoleProvider">
  <providers>
    <add connectionStringName="DefaultConnection" applicationName="/"
      name="DefaultRoleProvider" type="System.Web.Providers.DefaultRoleProvider, 
      System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </providers>
</roleManager> 
```

更新：仍然无法使用 WSAT 中创建的用户名和密码登录。这是我的连接字符串和提供者：

```
<connectionStrings>
<remove name="LocalSqlServer"/>
<add name="LocalSqlServer" connectionString="Data Source=PKFDB0;Initial Catalog=WebTrends; 
Integrated Security=False; User ID=*****; Password=******;" 
providerName="System.Data.SqlClient"/> 
```

```
 <membership>
  <providers>
    <add connectionStringName="LocalSqlServer" enablePasswordRetrieval="true"
      enablePasswordReset="true" requiresQuestionAndAnswer="false"
      requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6"
      minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
      applicationName="/" name="DefaultMembershipProvider" 
      type="System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, 
      Version=1.0.0.0, 
      Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </providers>
</membership>
<roleManager enabled="true">
  <providers>
    <add connectionStringName="LocalSqlServer" applicationName="/"
      name="DefaultRoleProvider" type="System.Web.Providers.DefaultRoleProvider, 
      System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </providers>
</roleManager> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T19:43:09.753

Your membership and roleManager should use same connection string, unless you are validating against two databases - user db and role db - which is not common.

```
connectionStringName="WebTrendsConnectionString"

connectionStringName="DefaultConnection" 
```

**Updated:** Can you explicitly set your application name such as `applicationName="WebTrends"`? Then verify that you can create role and user using [`ASP.Net Configuraton`](http://www.asp.net/web-forms/tutorials/moving-to-aspnet-20/membership).

![enter image description here](../Images/d1a4faaea7ce5f40bda823753a11e07a.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:39:38.933

1: Are you getting any errors or just invalid login?

2: Add in the providers section of both Membership and Roles:

```
 <membership defaultProvider="DefaultMembershipProvider">
  <providers>
    <clear/>
    ......
  </providers>
</membership> 
```

3: Make sure you have set the defaultProvider for both Membership and Roles.

4: After making above changes, create a brand new user and try login.

5: **EDIT:** Make sure you don't have an empty structure for Login Authenticate event.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T18:46:37.203

该`Login`控件是[在 ASP.NET 2.0 中添加的](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login%28v=vs.80%29.aspx)，默认情况下使用成员资格提供程序：

> The Login control uses a membership provider to obtain user credentials. Unless you specify otherwise, the Login control uses the default membership provider defined in the Web.config file. To specify a different provider, set the [MembershipProvider property](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.membershipprovider%28v=vs.100%29.aspx) to one of the membership provider names defined in your application's Web.config file. For more information, see [Membership Providers](http://msdn.microsoft.com/en-us/library/sx3h274z%28v=vs.80%29.aspx).
> 
> If you want to use a custom authentication service, you can use the [OnAuthenticate](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.onauthenticate%28v=vs.100%29.aspx) method to call the service.

If you've already set up the membership provider, you should be able to simply add a `Login` control to the page; you won't need any code to validate the login.

# ckeditor - 从工具栏中删除上传按钮

> ID：13164134
> 
> 赞同：0
> 
> 时间：2012-10-31T18:09:42.620
> 
> 标签：ckeditor, ckfinder

我已将 ckeditor 与 ckfinder 集成。我想从工具栏中删除上传按钮。当您从 ckeditor 单击图像/链接时，将打开一个文件浏览器，然后单击“浏览服务器”按钮。当您可以浏览文件夹时，它会打开另一个浏览器。在顶部有一个工具栏部分，我们可以在其中找到“设置、帮助和上传”按钮。我必须删除那个上传按钮。我正在使用 JavaScript。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-21T04:26:34.050

要删除 ckfinder 上传按钮，您需要在 ckfinder config.js 中添加一些代码

```
CKFinder.config.toolbar_Full = [['Refresh', 'Settings', 'Maximize']]; 
```

希望它有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-09T20:08:02.557

在主 config.js（ckfinder 3 根文件夹）上设置：

```
config.removeModules = 'UploadFileButton'; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-27T19:59:43.077

使用这种自定义工具栏的方式

```
editor_edit = CKEDITOR.replace( 'e_notification', {
uiColor: '#888888',
height: '250px',
filebrowserBrowseUrl : 'http://localhost/SUServer1/ckfinder/ckfinder.html',
filebrowserImageBrowseUrl : 'http://localhost/SUServer1/ckfinder/ckfinder.html?type=Images',
filebrowserFlashBrowseUrl : 'http://localhost/SUServer1/ckfinder/ckfinder.html?type=Flash',
filebrowserUploadUrl : 'http://localhost/SUServer1/ckfinder/core/connector/php/connector.php?command=QuickUpload&type=Files',
filebrowserImageUploadUrl : 'http://localhost/SUServer1/ckfinder/core/connector/php/connector.php?command=QuickUpload&type=Images',
filebrowserFlashUploadUrl : 'http://localhost/SUServer1/ckfinder/core/connector/php/connector.php?command=QuickUpload&type=Flash',
filebrowserWindowWidth : '1000',
filebrowserWindowHeight : '700',
toolbar :
[
    { name: 'document', items : [ 'Source','-','Templates' ] },
    { name: 'clipboard', items : [ 'Cut','Copy','Paste','PasteText','PasteFromWord','-','Undo','Redo' ] },
    '/',
    { name: 'basicstyles', items : [ 'Bold','Italic','Underline','Strike','Subscript','Superscript','-','RemoveFormat' ] },
    { name: 'paragraph', items : [ 'NumberedList','BulletedList','-','Outdent','Indent','-','Blockquote','CreateDiv',
    '-','JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock','-','BidiLtr','BidiRtl' ] },
    { name: 'links', items : [ 'Link','Unlink','Anchor' ] },
    { name: 'insert', items : [ 'Image','Table','HorizontalRule','Smiley','SpecialChar','Iframe' ] },
    '/',
    { name: 'styles', items : [ 'Styles','Format','Font','FontSize' ] },
    { name: 'colors', items : [ 'TextColor','BGColor' ] }
]
}); 
```

# jquery - 自动完成组合框选定的值

> ID：13164137
> 
> 赞同：0
> 
> 时间：2012-10-31T18:10:19.360
> 
> 标签：jquery

我从自动完成组合框 jquery 小部件获取选定值时遇到问题。

虽然我一直在改变一些东西，但最初的代码演示是[这个](http://jqueryui.com/autocomplete/#combobox). 根据代码，写入/验证的值应该存储在`ui.item.option`但似乎我无法访问它并将其存储在标签/隐藏字段中以供以后在代码隐藏中使用。

```
<script type="text/javascript">
$(document).ready(
    function() {
        $('select[name=combobox]').change(
        function(){
            var newText = $('ui.item.option', this).text();
            $('#MyLabel').text(newText);
        }
    );
}
);
</script> 
```

`combobox`是 aspx 页面中值列表的 ID/名称

打不开，有救吗？谢谢。

**编辑**

这是列出的项目（使用演示示例）

```
<select id="combobox" name="combobox">
    <option value="">Select one...</option>
    <option value="ActionScript">ActionScript</option>
    <option value="AppleScript">AppleScript</option>
    <option value="Asp">Asp</option>
    <option value="BASIC">BASIC</option>
    <option value="C">C</option>
    <option value="C++">C++</option>
    <option value="Clojure">Clojure</option>
    <option value="COBOL">COBOL</option>
    <option value="ColdFusion">ColdFusion</option>
    <option value="Erlang">Erlang</option>
    <option value="Fortran">Fortran</option>
    <option value="Groovy">Groovy</option>
    <option value="Haskell">Haskell</option>
    <option value="Java">Java</option>
    <option value="JavaScript">JavaScript</option>
    <option value="Lisp">Lisp</option>
    <option value="Perl">Perl</option>
    <option value="PHP">PHP</option>
    <option value="Python">Python</option>
    <option value="Ruby">Ruby</option>
    <option value="Scala">Scala</option>
    <option value="Scheme">Scheme</option>
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:27:57.167

不要使用 JS 事件更改。创建自动完成时设置 UI 事件：

```
$('select[name=combobox]').autocomplete({
   change : function(event, ui){
             $('#MyLabel').text(ui.item.option);
            }
}); 
```

我现在明白了。我不确定这是开始的最佳示例，但您的选择:) 您需要创建小部件事件并调用它（我只给您一小部分演示代码，因为太大了）：

为选择创建默认事件：

```
$.widget( "ui.combobox", {
            select : function(event, ui){ alert (ui.item.value);},
            _create: function() { 
```

如果定义了事件，请尝试调用它：

```
select: function( event, ui ) {
                            if(that.options.select != null){
                                that.options.select(event, ui);
                            }
                            ui.item.option.selected = true;
                            that._trigger( "selected", event, {
                                item: ui.item.option
                            });
                        }, 
```

创建组合框时覆盖您的默认选择方法：

```
$( "#combobox" ).combobox({select : function(event, ui){ $('#MyLabel').text(ui.item.value); }}); 
```

试试这个 ：）

编辑//

查看完整代码。这个对我有用：

```
<script>
    (function( $ ) {
        $.widget( "ui.combobox", {
            select : function(event, ui){ alert (ui.item.value);},
            _create: function() {
                var input,
                    that = this,
                    select = this.element.hide(),
                    selected = select.children( ":selected" ),
                    value = selected.val() ? selected.text() : "",
                    wrapper = this.wrapper = $( "<span>" )
                        .addClass( "ui-combobox" )
                        .insertAfter( select );

                function removeIfInvalid(element) {
                    var value = $( element ).val(),
                        matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( value ) + "$", "i" ),
                        valid = false;
                    select.children( "option" ).each(function() {
                        if ( $( this ).text().match( matcher ) ) {
                            this.selected = valid = true;
                            return false;
                        }
                    });
                    if ( !valid ) {
                        // remove invalid value, as it didn't match anything
                        $( element )
                            .val( "" )
                            .attr( "title", value + " didn't match any item" )
                            .tooltip( "open" );
                        select.val( "" );
                        setTimeout(function() {
                            input.tooltip( "close" ).attr( "title", "" );
                        }, 2500 );
                        input.data( "autocomplete" ).term = "";
                        return false;
                    }
                }

                input = $( "<input>" )
                    .appendTo( wrapper )
                    .val( value )
                    .attr( "title", "" )
                    .addClass( "ui-state-default ui-combobox-input" )
                    .autocomplete({
                        delay: 0,
                        minLength: 0,
                        source: function( request, response ) {
                            var matcher = new RegExp( $.ui.autocomplete.escapeRegex(request.term), "i" );
                            response( select.children( "option" ).map(function() {
                                var text = $( this ).text();
                                if ( this.value && ( !request.term || matcher.test(text) ) )
                                    return {
                                        label: text.replace(
                                            new RegExp(
                                                "(?![^&;]+;)(?!<[^<>]*)(" +
                                                $.ui.autocomplete.escapeRegex(request.term) +
                                                ")(?![^<>]*>)(?![^&;]+;)", "gi"
                                            ), "<strong>$1</strong>" ),
                                        value: text,
                                        option: this
                                    };
                            }) );
                        },
                        select: function( event, ui ) {
                        if(that.options.select != null){
                            that.options.select(event, ui);
                            }
                            ui.item.option.selected = true;
                            that._trigger( "selected", event, {
                                item: ui.item.option
                            });
                        },
                        change: function( event, ui ) {                         
                            if ( !ui.item )
                                return removeIfInvalid( this );

                        }
                    })
                    .addClass( "ui-widget ui-widget-content ui-corner-left" );

                input.data( "autocomplete" )._renderItem = function( ul, item ) {
                    return $( "<li>" )
                        .data( "item.autocomplete", item )
                        .append( "<a>" + item.label + "</a>" )
                        .appendTo( ul );
                };

                $( "<a>" )
                    .attr( "tabIndex", -1 )
                    .attr( "title", "Show All Items" )
                    .tooltip()
                    .appendTo( wrapper )
                    .button({
                        icons: {
                            primary: "ui-icon-triangle-1-s"
                        },
                        text: false
                    })
                    .removeClass( "ui-corner-all" )
                    .addClass( "ui-corner-right ui-combobox-toggle" )
                    .click(function() {
                        // close if already visible
                        if ( input.autocomplete( "widget" ).is( ":visible" ) ) {
                            input.autocomplete( "close" );
                            removeIfInvalid( input );
                            return;
                        }

                        // work around a bug (likely same cause as #5265)
                        $( this ).blur();

                        // pass empty string as value to search for, displaying all results
                        input.autocomplete( "search", "" );
                        input.focus();
                    });

                    input
                        .tooltip({
                            position: {
                                of: this.button
                            },
                            tooltipClass: "ui-state-highlight"
                        });
            },

            destroy: function() {
                this.wrapper.remove();
                this.element.show();
                $.Widget.prototype.destroy.call( this );
            }
        });
    })( jQuery );

    $(function() {
        $( "#combobox" ).combobox({select : function(event, ui){ alert(ui.item.value); }});
        $( "#toggle" ).click(function() {
            $( "#combobox" ).toggle();
        });
    });
    </script> 
```

# jquery - 单击/悬停时在 div 中显示缩略图

> ID：13164141
> 
> 赞同：0
> 
> 时间：2012-10-31T18:10:37.020
> 
> 标签：jquery

只想在单击或悬停时在 .fullsizeimage 中显示 .thumbimage - 不幸的是 .attr 函数没有运气。

[http://jsfiddle.net/CUZBa/](http://jsfiddle.net/CUZBa/) - 小提琴以防万一！

```
 <div class="row">  
        <div class="fullsizeimage">
            <img src="https://www.houseplans.com/img/980e/461-2p1-2520_plan-detail.jpg" />
        </div>

    <div class="thumbimage"><a href="#"><img src="https://www.houseplans.com/img/85cd/461-2e-2520_plan-detail.jpg" width="100" height="100"></a></div>
    <div class="thumbimage"><a href="#"><img src="https://www.houseplans.com/img/872d/461-2alt1-2520_plan-detail.jpg" width="100" height="100"></a></div>
    <div class="thumbimage"><a href="#"><img src="https://www.houseplans.com/img/230e/461-2alt2-2520_plan-detail.jpg" width="100" height="100"></a></div>
</div>

<script src="" type="text/javascript">
$('.thumbimage a').on('click hover',function(){
    $('.fullsizeimage img').attr('src',$(this).attr('src'));
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:18:21.707

从您的标签中删除该`src=""`属性。`<script>`

[http://jsfiddle.net/CUZBa/6/](http://jsfiddle.net/CUZBa/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T18:20:56.577

1.  选择 jquery 框架。
2.  从代码中删除脚本标签

# android - AppWidget 在 onDisabled 中崩溃

> ID：13164149
> 
> 赞同：0
> 
> 时间：2012-10-31T18:11:11.437
> 
> 标签：android, widget, android-appwidget

我正在制作小部件，它将由 Intent.ACTION_TIME_TICK 更新。

所以我注册了接收者（我的 AppWidgetProvider）：

```
private IntentFilter intentFilter = new IntentFilter(Intent.ACTION_TIME_TICK);

@Override
    public void onEnabled(Context context) {
        super.onEnabled(context);
        context.getApplicationContext().registerReceiver(this, intentFilter);   
    } 
```

一切正常。但是当我尝试注销接收者时，应用程序崩溃：

```
@Override
public void onDisabled(Context context) {   
    context.getApplicationContext().unregisterReceiver(this);  
    super.onDisabled(context);
} 
```

它抛出

```
java.lang.IllegalArgumentException: Receiver not registered:
com.holoware.holoclock.HoloClockWidgetProvider@41a3a3e8 
```

日志：

```
D/AndroidRuntime( 3937): Shutting down VM
W/dalvikvm( 3937): threadid=1: thread exiting with uncaught exception (group=0x4
19e8300)
E/AndroidRuntime( 3937): FATAL EXCEPTION: main
E/AndroidRuntime( 3937): java.lang.RuntimeException: Unable to start receiver co
m.holoware.holoclock.HoloClockWidgetProvider: java.lang.IllegalArgumentException
: Receiver not registered: com.holoware.holoclock.HoloClockWidgetProvider@41d616
20
E/AndroidRuntime( 3937):        at android.app.ActivityThread.handleReceiver(Act
ivityThread.java:2362)
E/AndroidRuntime( 3937):        at android.app.ActivityThread.access$1500(Activi
tyThread.java:142)
E/AndroidRuntime( 3937):        at android.app.ActivityThread$H.handleMessage(Ac
tivityThread.java:1284)
E/AndroidRuntime( 3937):        at android.os.Handler.dispatchMessage(Handler.ja
va:99)
E/AndroidRuntime( 3937):        at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime( 3937):        at android.app.ActivityThread.main(ActivityThrea
d.java:4931)
E/AndroidRuntime( 3937):        at java.lang.reflect.Method.invokeNative(Native
Method)
E/AndroidRuntime( 3937):        at java.lang.reflect.Method.invoke(Method.java:5
11)
E/AndroidRuntime( 3937):        at com.android.internal.os.ZygoteInit$MethodAndA
rgsCaller.run(ZygoteInit.java:791)
E/AndroidRuntime( 3937):        at com.android.internal.os.ZygoteInit.main(Zygot
eInit.java:558)
E/AndroidRuntime( 3937):        at dalvik.system.NativeStart.main(Native Method)

E/AndroidRuntime( 3937): Caused by: java.lang.IllegalArgumentException: Receiver
 not registered: com.holoware.holoclock.HoloClockWidgetProvider@41d61620
E/AndroidRuntime( 3937):        at android.app.LoadedApk.forgetReceiverDispatche
r(LoadedApk.java:654)
E/AndroidRuntime( 3937):        at android.app.ContextImpl.unregisterReceiver(Co
ntextImpl.java:1166)
E/AndroidRuntime( 3937):        at android.content.ContextWrapper.unregisterRece
iver(ContextWrapper.java:378)
E/AndroidRuntime( 3937):        at com.holoware.holoclock.HoloClockWidgetProvide
r.onDisabled(HoloClockWidgetProvider.java:53)
E/AndroidRuntime( 3937):        at android.appwidget.AppWidgetProvider.onReceive
(AppWidgetProvider.java:91)
E/AndroidRuntime( 3937):        at com.holoware.holoclock.HoloClockWidgetProvide
r.onReceive(HoloClockWidgetProvider.java:63)
E/AndroidRuntime( 3937):        at android.app.ActivityThread.handleReceiver(Act
ivityThread.java:2355)
E/AndroidRuntime( 3937):        ... 10 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:43:36.583

确保您`onDisabled()`没有被呼叫两次还检查您是否正在以其他方法取消注册接收器...

尝试将取消注册代码放入 try catch 中，如下面的代码..

```
@Override
    public void onDisabled(Context context) {       
        try{
                context.getApplicationContext().unregisterReceiver(this);
         } catch(Exception e){}
        super.onDisabled(context);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:33:34.403

问题是，`onEnabled()`仅在添加第一个小部件时才调用。如果小部件已经被添加并且您启动了您的应用程序，`onEnabled()`则不会被调用。这就是接收器未注册的原因，而您在取消注册时会遇到异常。我建议你`Intent`这样创建：

```
 Intent intent = new Intent(context, YourAppWidgetProvider.class);
    intent.setAction(action); 
```

# android - OBD2 - ELM327 蓝牙模拟器

> ID：13164150
> 
> 赞同：21
> 
> 时间：2012-10-31T18:11:16.640
> 
> 标签：android, bluetooth, simulator, obd-ii

我正在开发用于通过蓝牙连接到汽车单元的 ELM327 的 Android 应用程序。是否有任何模拟器，通过蓝牙在 Windows 7 上模拟 ELM327？所以我可以在没有汽车的情况下测试我的应用程序。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-11T19:53:44.207

毕竟我找到了一个工作。它被称为[Obdsim](http://icculus.org/obdgpslogger/obdsim.html)。它也可以在带有蓝牙的 Windows 上运行。
例如，只需在您的蓝牙中设置某个端口上的传入蓝牙，`COM4`然后从您的命令行启动模拟器：
`obdsim.exe -g gui_fltk -w COM4`

这是一个很好的工作模拟器，有很多选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-29T15:35:57.807

如果您认真开发这样的应用程序，请使用 OBD2 硬件模拟器，您可以在其中插入您的 OBD2 蓝牙适配器，例如[DIAMEX OBD2 模拟器](http://www.diamex.de/dxshop/Diamex-OBD2-Profi-Simulator-alle-Protokolle)。这是一个真正的节省时间，值得每一欧元。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-11T08:57:21.833

我刚刚为此找到了 Android 应用程序，但是我不会对其进行测试，因为它非常昂贵[https://play.google.com/store/apps/details?id=unistep.elm327_emulator](https://play.google.com/store/apps/details?id=unistep.elm327_emulator)

# android - 将 FireFox 与 Android WebView 一起使用

> ID：13164160
> 
> 赞同：1
> 
> 时间：2012-10-31T18:11:42.730
> 
> 标签：android, xml, android-webview

我正在为我的客户创建一个简单的 WebView 应用程序，该应用程序将 Web 门户拉入应用程序。.apk 已编译并适用于旧版本的 Android；但是，我遇到任何操作系统版本 3.xx 或更高版本的问题；本机 Android 浏览器返回的位置：“ERROR 500 HTTP Web Server: Invalid POST Request Exception”。

要在任何应用程序之外绕过此错误，FireFox 浏览器会按预期工作而不会返回任何错误。

**问题**- 有没有一种简单的方法可以强制 WebView 应用程序从 FireFox 而不是本机浏览器检索？

我找到了一个[线程](https://stackoverflow.com/questions/6788395/in-android-how-can-i-force-open-a-uri-using-a-specific-browser-without-popping "在 android 中，如何强制使用特定浏览器打开 URI，而不弹出“选择浏览器”列表？")，其中列出了调用更改，如下所示：

```
String packageName = "com.android.browser";  
String className = "com.android.browser.BrowserActivity";  
Intent internetIntent = new Intent(Intent.ACTION_VIEW); 
internetIntent.addCategory(Intent.CATEGORY_LAUNCHER);  
internetIntent.setClassName(packageName, className);  
startActivity(internetIntent); 
```

作为“编码”场景的新手，我很茫然，因为我的清单文件中没有任何可以以这种方式编辑的调用（脚本？）。

任何想法或想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:57:40.240

您需要实现自己的`WebView`使用 Firefox 的渲染引擎，这将[非常困难](https://stackoverflow.com/questions/6352654/use-firefox-as-render-engine-for-android-webview)。如果您对服务器端（Web 门户）有一定的控制权并且可以查看日志，那么最好的做法可能是了解服务器拒绝来自运行 Android 3.x 及更高版本的设备的 POST 请求的原因。

# graph - 图表：提取人脸

> ID：13164161
> 
> 赞同：0
> 
> 时间：2012-10-31T18:11:43.430
> 
> 标签：graph

> **可能重复：**
> [如何在图网络中找到闭环](https://stackoverflow.com/questions/7022082/how-to-find-closed-loops-in-graph-networks)

我有一个关于图表的问题。我需要提取图形的所有面（想象一个我必须提取所有“块”的街道网络）。如果您想到一个典型的棋盘格图案（例如曼哈顿），大多数面都有 4 条边和 4 个节点，但整个事情也应该适用于其他可能性（例如，面有超过 4 条边）。

我怎样才能做到这一点？我想到了各种各样的东西并试图用谷歌搜索，但我没有找到令人满意的答案。

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T02:48:49.527

您可能正在寻找所有长度的循环`n`。以某些条件为模，所有此类循环的集合将对应于您寻找的“面孔”。

如果您使用这种方法，那么无论您的图表是否有向，都会变得很重要。

# java - 画布对象未显示，但位置在 Java Applet 中正确更新

> ID：13164162
> 
> 赞同：3
> 
> 时间：2012-10-31T18:11:44.417
> 
> 标签：java, applet, awt, paint, java-canvas

我的基本弹跳球 Applet 应该有一个球根据`loc`变量中的值四处移动，但什么也没有出现。打印出来`loc`表明，移动它和跳出边界背后的数字/数学确实可以正常工作，但什么也没显示。在线查看示例，我不明白为什么我的绘图/绘画代码没有按预期工作。这就是我所拥有的，问题可能集中在`Ball`对象所在位置的一半左右。我发布了大部分程序，因为如果有人会运行它，它会编译/运行。

```
import java.awt.*;
import java.applet.*;
import java.awt.event.*;

public class Bounce2 extends Applet implements ActionListener, AdjustmentListener, Runnable
{
    //runtime variables
    boolean running = false;
    boolean kill = false;

    //buttons
    Button runbutton = new Button("Run"); 
    Button pausebutton = new Button("Pause");
    Button quitbutton = new Button("Quit");

    //text
    Label speedlabel = new Label("Speed");
    Label sizelabel = new Label("Size");

    //scrollbars
    private final int barHeight = 20, SLIDER_WIDTH = 10, MAXSPEED = 110, MINSPEED = 0, MAX_SIZE = 110, MIN_SIZE = 10;
    Scrollbar speedbar = new Scrollbar(Scrollbar.HORIZONTAL, MAXSPEED/2, SLIDER_WIDTH, MINSPEED, MAXSPEED);
    Scrollbar sizebar = new Scrollbar(Scrollbar.HORIZONTAL, MAX_SIZE/2, SLIDER_WIDTH, MIN_SIZE, MAX_SIZE);

    //drawn objs
    Ball ball;
    int size = 50;  
    private Graphics obj;
    Image offscreen = null;
    Point loc = new Point(100,100); //location of the ball
    private Thread ballThread;

    //boundaries
    int boundx = 640;
    int boundy = 400;

    //directions
    int dx = 1; //1 = left, -1 = right
    int dy = 1; //1 = up, -1 = down

    //speed
    int speed = speedbar.getValue();
    int delay;

    //initialize the applet and draw everything
    public void init()
    {
        double colWeight[] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};//15 cols
        double rowWeight[] = {1,1,1,1,1,1,1,1,1,1}; //10 rows
        int colWidth[] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};//15 cols
        int rowHeight[] = {1,1,1,1,1,1,1,1,1,1}; //10 rows
        GridBagConstraints c = new GridBagConstraints();
        GridBagLayout gbl = new GridBagLayout();
        gbl.rowHeights = rowHeight;
        gbl.rowWeights = rowWeight;
        gbl.columnWeights = colWeight;
        gbl.columnWidths = colWidth;
        c.anchor = GridBagConstraints.CENTER;

        setBounds(0,0,480,640);
        setLayout(new BorderLayout());
        Panel controlpanel = new Panel();
        controlpanel.setLayout(gbl);
        controlpanel.setSize(640,80);

        Panel drawingpanel = new Panel(null);
        drawingpanel.setSize(640,400);
        ball = new Ball();
        drawingpanel.add(ball);
        drawingpanel.setVisible(true);

        //speed scrollbar
        c.weightx = 1;
        c.weighty = 1;
        c.gridwidth = 3;
        c.gridheight = 1;
        c.gridx = 1;
        c.gridy = 7;
        c.fill= GridBagConstraints.HORIZONTAL;
        gbl.setConstraints(this.speedbar,c);

        //run button
        c.weightx = 1;
        c.weighty = 1;
        c.gridwidth = 2;
        c.gridheight = 1;
        c.gridx = 5;
        c.gridy = 7;
        c.fill= GridBagConstraints.HORIZONTAL;
        gbl.setConstraints(this.runbutton,c);

        //pause button
        c.weightx = 1;
        c.weighty = 1;
        c.gridwidth = 2;
        c.gridheight = 1;
        c.gridx = 8;
        c.gridy = 7;
        c.fill= GridBagConstraints.HORIZONTAL;
        gbl.setConstraints(this.pausebutton,c);

        //size scrollbar
        c.weightx = 1;
        c.weighty = 1;
        c.gridwidth = 3;
        c.gridheight = 1;
        c.gridx = 11;
        c.gridy = 7;
        c.fill= GridBagConstraints.HORIZONTAL;
        gbl.setConstraints(this.sizebar,c);

        //speed text label
        c.weightx = 1;
        c.weighty = 1;
        c.gridwidth = 3;
        c.gridheight = 1;
        c.gridx = 1;
        c.gridy = 8;
        c.fill= GridBagConstraints.HORIZONTAL;
        gbl.setConstraints(this.speedlabel,c);

        //size text label
        c.weightx = 1;
        c.weighty = 1;
        c.gridwidth = 3;
        c.gridheight = 1;
        c.gridx = 11;
        c.gridy = 8;
        c.fill= GridBagConstraints.HORIZONTAL;
        gbl.setConstraints(this.sizelabel,c);

        //quit button
        c.weightx = 1;
        c.weighty = 1;
        c.gridwidth = 3;
        c.gridheight = 1;
        c.gridx = 6;
        c.gridy = 9;
        c.fill= GridBagConstraints.HORIZONTAL;
        gbl.setConstraints(this.quitbutton,c);

        //add to the screen
        controlpanel.add(this.speedbar);
        controlpanel.add(this.runbutton);
        controlpanel.add(this.pausebutton);
        controlpanel.add(this.sizebar);
        controlpanel.add(this.speedlabel);
        controlpanel.add(this.sizelabel);
        controlpanel.add(this.quitbutton);

        //add listners
        speedbar.addAdjustmentListener(this);
        runbutton.addActionListener(this);
        pausebutton.addActionListener(this);
        sizebar.addAdjustmentListener(this);
        quitbutton.addActionListener(this);

        //add the panels
        add("South", controlpanel);
        add("Center", drawingpanel);

        //drawing paramaters
        obj = drawingpanel.getGraphics();
        loc = new Point(loc.x+dx, loc.y+dy);

        setVisible(true);
        validate();
    }

    public void start()
    {
        if (ballThread == null)
        {
            ballThread = new Thread(this);
            ballThread.start();
            repaint();
        }
    }

    public void run()
    {
        Thread.currentThread().setPriority(Thread.MAX_PRIORITY);
        while (!kill)
        {
            if (running)
            {
                repaint();
            }
            try
            {
                Thread.sleep(delay);
            }
            catch(InterruptedException e){System.err.println("Interrupted.");}
        }
        stop();
    }

    //class to handle animations
    class Ball extends Canvas 
    {
        public void move()
        {
            //if it will hit the right or left, flip the x direction and set it 
            if (loc.x+size >= boundx || loc.x <= 0)
            { dx *= -1; }
            loc.x += dx;
            //if it will hit the top or bottom, flip the y direction and set it
            if (loc.y+size >= boundy || loc.y <= 0)
            { dy *= -1; }
            loc.y += dy;
            setBounds(dx,dy,size,size);
        }   

        public void paint(Graphics g)
        {
            update(g);
        }

        public void update(Graphics g)
        {
            Graphics buffer;
            if (offscreen == null);
            {
                offscreen = createImage(boundx, boundy);
                buffer = offscreen.getGraphics();
            }

            buffer.setColor(getBackground());
            buffer.fillRect(loc.x,loc.y,boundx, boundy);
            //update loc
            move();

            //draw
            buffer.setColor(Color.black);
            buffer.drawOval(loc.x, loc.y, size, size);
            buffer.fillOval(loc.x, loc.y, size, size);

            //draw rectangles out of vector 
            super.paint(g);
            g.drawImage(offscreen, loc.x, loc.y, null);
        }
    }

    public void actionPerformed(ActionEvent e)
    {
        Object source = e.getSource();
        if (source == this.runbutton)
        {
            running = true;
        }
        else if (source == this.pausebutton)
        {
            running = false;
        }
        else if (source == this.quitbutton)
        {
            //kill processes
            kill = true;
            //remove listeners
            stop();
        }
    }

    public void adjustmentValueChanged(AdjustmentEvent e)
    {
        Object source = e.getSource();
        //set the new size. 
        if (source == sizebar)
        {
            //check for clipping
            int newsize = sizebar.getValue();

            // x
            if (loc.x+newsize >= boundx)
            { 
                newsize = boundx - loc.x - 1;
                sizebar.setValue(newsize);
            }

            // y
            if (loc.y+newsize >= boundy + 100)
            {
                newsize = boundy+100 - loc.y - 1;
                sizebar.setValue(newsize);
            }
            size = newsize;
        }
        if (source == speedbar)
        {
            speed = speedbar.getValue();
            delay = MAXSPEED - speedbar.getValue();
        }
    }

    public void stop()
    {
        this.speedbar.removeAdjustmentListener(this);
        this.runbutton.removeActionListener(this);
        this.pausebutton.removeActionListener(this);
        this.sizebar.removeAdjustmentListener(this);
        this.quitbutton.removeActionListener(this);
        Thread.currentThread().setPriority(Thread.MIN_PRIORITY);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T20:22:05.757

我对您的代码进行了以下更改，并且可以正常工作-

首先我将球的初始位置设置为

```
Point loc = new Point(10,10); 
```

初始化后`ball = new Ball();`添加 -

```
drawingpanel.setLayout(new BorderLayout());
            drawingpanel.add("Center",ball); 
```

在 run() 方法中重新绘制球 -

```
if(running){
ball.repaint(); 
} 
```

在 move() 方法中删除/注释该行 -

```
//setBounds(dx,dy,size,size); 
```

在 update(Graphics g) 方法中删除/注释行 -

```
//buffer.setColor(Color.black);
//buffer.fillRect(loc.x,loc.y,boundx, boundy); 
```

这 ; if (offscreen == null); 没有任何意义，所以我评论了它-

```
 //if (offscreen == null); 
```

宾果游戏，一切正常！如果你能做到，请告诉我，否则我将发布更新的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T20:23:46.523

这是正在运行的代码的修改版本。

```
import java.awt.*;
import java.applet.*;
import java.awt.event.*;

public class Bounce2 extends Applet implements ActionListener, AdjustmentListener, Runnable
{
  //runtime variables
  boolean running = false;
  boolean kill = false;

  //buttons
  Button runbutton = new Button("Run");
  Button pausebutton = new Button("Pause");
  Button quitbutton = new Button("Quit");

  //text
  Label speedlabel = new Label("Speed");
  Label sizelabel = new Label("Size");

  Panel drawingpanel;

  //scrollbars
  private final int barHeight = 20, SLIDER_WIDTH = 10, MAXSPEED = 110, MINSPEED = 0, MAX_SIZE = 110, MIN_SIZE = 10;
  Scrollbar speedbar = new Scrollbar(Scrollbar.HORIZONTAL, MAXSPEED/2, SLIDER_WIDTH, MINSPEED, MAXSPEED);
  Scrollbar sizebar = new Scrollbar(Scrollbar.HORIZONTAL, MAX_SIZE/2, SLIDER_WIDTH, MIN_SIZE, MAX_SIZE);

  //drawn objs
  Ball ball;
  int size = 50;
  private Graphics obj;
  Image offscreen = null;
  Point loc = new Point(100,100); //location of the ball
  private Thread ballThread;

  //boundaries
  int boundx = 640;
  int boundy = 400;

  //directions
  int dx = 1; //1 = left, -1 = right
  int dy = 1; //1 = up, -1 = down

  //speed
  int speed = speedbar.getValue();
  int delay = 3000;

  //initialize the applet and draw everything
  public void init()
  {
    double colWeight[] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};//15 cols
    double rowWeight[] = {1,1,1,1,1,1,1,1,1,1}; //10 rows
    int colWidth[] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};//15 cols
    int rowHeight[] = {1,1,1,1,1,1,1,1,1,1}; //10 rows
    GridBagConstraints c = new GridBagConstraints();
    GridBagLayout gbl = new GridBagLayout();
    gbl.rowHeights = rowHeight;
    gbl.rowWeights = rowWeight;
    gbl.columnWeights = colWeight;
    gbl.columnWidths = colWidth;
    c.anchor = GridBagConstraints.CENTER;

    setBounds(0,0,480,640);
    setLayout(new BorderLayout());
    Panel controlpanel = new Panel();
    controlpanel.setLayout(gbl);
    controlpanel.setSize(640,80);

    drawingpanel = new Panel();
    drawingpanel.setSize(640,400);
    ball = new Ball();
    drawingpanel.setLayout(new BorderLayout());
    drawingpanel.add("Center",ball);

    //speed scrollbar
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 1;
    c.gridy = 7;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.speedbar,c);

    //run button
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 2;
    c.gridheight = 1;
    c.gridx = 5;
    c.gridy = 7;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.runbutton,c);

    //pause button
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 2;
    c.gridheight = 1;
    c.gridx = 8;
    c.gridy = 7;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.pausebutton,c);

    //size scrollbar
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 11;
    c.gridy = 7;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.sizebar,c);

    //speed text label
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 1;
    c.gridy = 8;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.speedlabel,c);

    //size text label
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 11;
    c.gridy = 8;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.sizelabel,c);

    //quit button
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 6;
    c.gridy = 9;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.quitbutton,c);

    //add to the screen
    controlpanel.add(this.speedbar);
    controlpanel.add(this.runbutton);
    controlpanel.add(this.pausebutton);
    controlpanel.add(this.sizebar);
    controlpanel.add(this.speedlabel);
    controlpanel.add(this.sizelabel);
    controlpanel.add(this.quitbutton);

    //add listners
    speedbar.addAdjustmentListener(this);
    runbutton.addActionListener(this);
    pausebutton.addActionListener(this);
    sizebar.addAdjustmentListener(this);
    quitbutton.addActionListener(this);

    //add the panels
    add("South", controlpanel);
    add("Center", drawingpanel);

    //drawing paramaters
    loc = new Point(loc.x+dx, loc.y+dy);
  }

  public void start()
  {
    if (ballThread == null)
    {
      ballThread = new Thread(this);
      ballThread.start();
    }
  }

  public void run()
  {
    Thread.currentThread().setPriority(Thread.MAX_PRIORITY);
    while (!kill)
    {
      if (running)
      {
        ball.invalidate();
        ball.repaint();
      }
      try
      {
        Thread.sleep(delay);
      }
      catch(InterruptedException e){System.err.println("Interrupted.");}
    }
    stop();
  }

  public void paint(Graphics g){
    super.paint(g);

  }

  //class to handle animations
  class Ball extends Canvas
  {
    public void move()
    {
      //if it will hit the right or left, flip the x direction and set it
      if (loc.x+size >= boundx || loc.x <= 0)
      { dx *= -1; }
      loc.x += dx;
      //if it will hit the top or bottom, flip the y direction and set it
      if (loc.y+size >= boundy || loc.y <= 0)
      { dy *= -1; }
      loc.y += dy;
    }

    public void update(Graphics g)
    {
      super.update(g);
      Graphics buffer;
      if (offscreen == null)
      {
        offscreen = createImage(getWidth(), getHeight());
      }
      buffer = offscreen.getGraphics();
      mypaint(buffer);
      g.drawImage(offscreen, 0, 0, this);

    }

    public void mypaint(Graphics g)
    {
      g.setColor(getBackground());
      g.fillRect(loc.x,loc.y,boundx, boundy);

      //update loc
      move();

      //draw
      g.setColor(Color.BLACK);
      g.drawOval(loc.x, loc.y, size, size);
      g.fillOval(loc.x, loc.y, size, size);

      //draw rectangles out of vector
    }
  }

  public void actionPerformed(ActionEvent e)
  {
    Object source = e.getSource();
    if (source == this.runbutton)
    {
      running = true;
    }
    else if (source == this.pausebutton)
    {
      running = false;
    }
    else if (source == this.quitbutton)
    {
      //kill processes
      kill = true;
      //remove listeners
      stop();
    }
  }

  public void adjustmentValueChanged(AdjustmentEvent e)
  {
    Object source = e.getSource();
    //set the new size.
    if (source == sizebar)
    {
      //check for clipping
      int newsize = sizebar.getValue();

      // x
      if (loc.x+newsize >= boundx)
      {
        newsize = boundx - loc.x - 1;
        sizebar.setValue(newsize);
      }

      // y
      if (loc.y+newsize >= boundy + 100)
      {
        newsize = boundy+100 - loc.y - 1;
        sizebar.setValue(newsize);
      }
      size = newsize;
    }
    if (source == speedbar)
    {
      speed = speedbar.getValue();
      delay = MAXSPEED - speedbar.getValue();
    }
  }

  public void stop()
  {
    this.speedbar.removeAdjustmentListener(this);
    this.runbutton.removeActionListener(this);
    this.pausebutton.removeActionListener(this);
    this.sizebar.removeAdjustmentListener(this);
    this.quitbutton.removeActionListener(this);
    Thread.currentThread().setPriority(Thread.MIN_PRIORITY);
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T19:06:14.777

将布局管理器添加到绘图面板：

```
drawingpanel.setLayout(new BorderLayout());
drawingpanel.add("Center",ball); 
```

然后，调用`ball.repaint();`该`run()`方法以进入您的自定义更新方法。

最后，从您的方法中删除该`setBounds(dx,dy,size,size);`语句。`move()`

最终的代码是这样的：

```
import java.awt.*;
import java.applet.*;
import java.awt.event.*;

public class Bounce2 extends Applet implements ActionListener, AdjustmentListener, Runnable
{
//runtime variables
boolean running = false;
boolean kill = false;

//buttons
Button runbutton = new Button("Run"); 
Button pausebutton = new Button("Pause");
Button quitbutton = new Button("Quit");

//text
Label speedlabel = new Label("Speed");
Label sizelabel = new Label("Size");

//scrollbars
private final int barHeight = 20, SLIDER_WIDTH = 10, MAXSPEED = 110, MINSPEED = 0, MAX_SIZE = 110, MIN_SIZE = 10;
Scrollbar speedbar = new Scrollbar(Scrollbar.HORIZONTAL, MAXSPEED/2, SLIDER_WIDTH, MINSPEED, MAXSPEED);
Scrollbar sizebar = new Scrollbar(Scrollbar.HORIZONTAL, MAX_SIZE/2, SLIDER_WIDTH, MIN_SIZE, MAX_SIZE);

//drawn objs
Ball ball;
int size = 50;  
private Graphics obj;
Image offscreen = null;
Point loc = new Point(100,100); //location of the ball
private Thread ballThread;

//boundaries
int boundx = 640;
int boundy = 400;

//directions
int dx = 1; //1 = left, -1 = right
int dy = 1; //1 = up, -1 = down

//speed
int speed = speedbar.getValue();
int delay;

//initialize the applet and draw everything
public void init()
{
    double colWeight[] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};//15 cols
    double rowWeight[] = {1,1,1,1,1,1,1,1,1,1}; //10 rows
    int colWidth[] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};//15 cols
    int rowHeight[] = {1,1,1,1,1,1,1,1,1,1}; //10 rows
    GridBagConstraints c = new GridBagConstraints();
    GridBagLayout gbl = new GridBagLayout();
    gbl.rowHeights = rowHeight;
    gbl.rowWeights = rowWeight;
    gbl.columnWeights = colWeight;
    gbl.columnWidths = colWidth;
    c.anchor = GridBagConstraints.CENTER;

    setBounds(0,0,480,640);
    setLayout(new BorderLayout());
    Panel controlpanel = new Panel();
    controlpanel.setLayout(gbl);
    controlpanel.setSize(640,80);

    Panel drawingpanel = new Panel(null);
    drawingpanel.setSize(640,400);
    ball = new Ball();
    drawingpanel.setLayout(new BorderLayout());
    drawingpanel.add("Center",ball);
    drawingpanel.setVisible(true);

    //speed scrollbar
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 1;
    c.gridy = 7;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.speedbar,c);

    //run button
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 2;
    c.gridheight = 1;
    c.gridx = 5;
    c.gridy = 7;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.runbutton,c);

    //pause button
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 2;
    c.gridheight = 1;
    c.gridx = 8;
    c.gridy = 7;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.pausebutton,c);

    //size scrollbar
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 11;
    c.gridy = 7;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.sizebar,c);

    //speed text label
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 1;
    c.gridy = 8;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.speedlabel,c);

    //size text label
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 11;
    c.gridy = 8;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.sizelabel,c);

    //quit button
    c.weightx = 1;
    c.weighty = 1;
    c.gridwidth = 3;
    c.gridheight = 1;
    c.gridx = 6;
    c.gridy = 9;
    c.fill= GridBagConstraints.HORIZONTAL;
    gbl.setConstraints(this.quitbutton,c);

    //add to the screen
    controlpanel.add(this.speedbar);
    controlpanel.add(this.runbutton);
    controlpanel.add(this.pausebutton);
    controlpanel.add(this.sizebar);
    controlpanel.add(this.speedlabel);
    controlpanel.add(this.sizelabel);
    controlpanel.add(this.quitbutton);

    //add listners
    speedbar.addAdjustmentListener(this);
    runbutton.addActionListener(this);
    pausebutton.addActionListener(this);
    sizebar.addAdjustmentListener(this);
    quitbutton.addActionListener(this);

    //add the panels
    add("South", controlpanel);
    add("Center", drawingpanel);

    //drawing paramaters
    obj = drawingpanel.getGraphics();
    loc = new Point(loc.x+dx, loc.y+dy);

    setVisible(true);
    validate();
}

public void start()
{
    if (ballThread == null)
    {
        ballThread = new Thread(this);
        ballThread.start();
        repaint();
    }
}

public void run()
{
    Thread.currentThread().setPriority(Thread.MAX_PRIORITY);
    while (!kill)
    {
        if (running)
        {
            repaint();
            ball.repaint();
        }
        try
        {
            Thread.sleep(delay);
        }
        catch(InterruptedException e){System.err.println("Interrupted.");}
    }
    stop();
}

//class to handle animations
class Ball extends Canvas 
{
    public void move()
    {
        //if it will hit the right or left, flip the x direction and set it 
        if (loc.x+size >= boundx || loc.x <= 0)
        { dx *= -1; }
        loc.x += dx;
        //if it will hit the top or bottom, flip the y direction and set it
        if (loc.y+size >= boundy || loc.y <= 0)
        { dy *= -1; }
        loc.y += dy;
//            setBounds(dx,dy,size,size);
    }   

    public void paint(Graphics g)
    {
        update(g);
    }

    public void update(Graphics g)
    {
        Graphics buffer;
        if (offscreen == null);
        {
            offscreen = createImage(boundx, boundy);
            buffer = offscreen.getGraphics();
        }

        buffer.setColor(getBackground());
        buffer.fillRect(loc.x,loc.y,boundx, boundy);
        //update loc
        move();

        //draw
        buffer.setColor(Color.black);
        buffer.drawOval(loc.x, loc.y, size, size);
        buffer.fillOval(loc.x, loc.y, size, size);

        //draw rectangles out of vector 
        super.paint(g);
        g.drawImage(offscreen, loc.x, loc.y, null);
    }
}

public void actionPerformed(ActionEvent e)
{
    Object source = e.getSource();
    if (source == this.runbutton)
    {
        running = true;
    }
    else if (source == this.pausebutton)
    {
        running = false;
    }
    else if (source == this.quitbutton)
    {
        //kill processes
        kill = true;
        //remove listeners
        stop();
    }
}

public void adjustmentValueChanged(AdjustmentEvent e)
{
    Object source = e.getSource();
    //set the new size. 
    if (source == sizebar)
    {
        //check for clipping
        int newsize = sizebar.getValue();

        // x
        if (loc.x+newsize >= boundx)
        { 
            newsize = boundx - loc.x - 1;
            sizebar.setValue(newsize);
        }

        // y
        if (loc.y+newsize >= boundy + 100)
        {
            newsize = boundy+100 - loc.y - 1;
            sizebar.setValue(newsize);
        }
        size = newsize;
    }
    if (source == speedbar)
    {
        speed = speedbar.getValue();
        delay = MAXSPEED - speedbar.getValue();
    }
}

public void stop()
{
    this.speedbar.removeAdjustmentListener(this);
    this.runbutton.removeActionListener(this);
    this.pausebutton.removeActionListener(this);
    this.sizebar.removeAdjustmentListener(this);
    this.quitbutton.removeActionListener(this);
    Thread.currentThread().setPriority(Thread.MIN_PRIORITY);
}
} 
```

# javascript - 在某些情况下，表单属性“未定义”错误，但在其他情况下则不然

> ID：13164165
> 
> 赞同：2
> 
> 时间：2012-10-31T18:11:51.157
> 
> 标签：javascript, forms, firefox, greasemonkey

我创建了以下greasemonkey 脚本来自动跳过蒸汽时代检查页面：

```
// ==UserScript==
// ...
// @include     http://store.steampowered.com/agecheck/*
// ==/UserScript==

//Mini script for doing steam age checks automatically
if( document.URL.indexOf('agecheck') > -1 )
{
    var form = document.getElementById('agegate_box').getElementsByTagName('form')[0];
    form.ageDay.value = 18;
    form.ageMonth.value = 'August';
    form.ageYear.value = 1987;
    form.submit();
} 
```

这种页面的一个例子是：[http](http://store.steampowered.com/agecheck/app/16730/) ://store.steampowered.com/agecheck/app/16730/ 。请注意，如果您设置了“生日”cookie，此页面将自动跳至游戏`store.steampowered.com`，因此您可能必须先将其删除。

当在 Windows XP 上运行的 Firefox 17.0 (beta) 上安装这个greasemonkey 脚本时，它可以正常工作。

然后，我在运行最新 FF (16) 的 Windows 7 机器上安装了该脚本。在这台机器上，脚本在访问 form.ageDay 时中断。错误控制台显示：

```
Error: form.ageDay is undefined 
```

更奇怪的是，如果我只是将我的脚本粘贴到 Firefox Scratchpad (Shift+F4) 并执行它，它就可以找到并提交表单。

怎么可能在 XP 上 GM 脚本有效，而在 Win7 中，脚本在暂存器中有效，但在 Win7 上，脚本在 GM 中无效？

另一个奇怪的是，在Win7机器上，如果我激活Firebug，`var form`显然有一个'ageDay'属性，但手表表达式返回未定义？

![在此处输入图像描述](../Images/b69e95f98960979a0e5d82b39d4c1c61.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:30:10.540

该代码在 Windows XP 或 Windows 7 上都不适用于我。也不应该。GM 脚本不能（通常）使用这样的命名表单对象。请参阅[Greasemonkey 陷阱：命名表单和表单元素](http://commons.oreilly.com/wiki/index.php/Greasemonkey_Hacks/Getting_Started#Pitfall_.233%3a_Named_Forms_and_Form_Elements)。

使用沙盒安全（和更强大）的方法来获取这些表单元素。例如，`querySelector()`。此脚本在您链接的页面上适用于我：

```
// ==UserScript==
// @name        _delme 677
// @include     http://store.steampowered.com/agecheck/*
// @grant       GM_xmlhttpRequest
// ==/UserScript==

//Mini script for doing steam age checks automatically
if (/agecheck/i.test (location.pathname) ) {
    var ageForm = document.querySelector ("#agegate_box form");
    ageForm.querySelector ("[name='ageDay']").value     = 18;
    ageForm.querySelector ("[name='ageMonth']").value   = 'August';
    ageForm.querySelector ("[name='ageYear']").value    = 1987;
    ageForm.submit ();
} 
```

* * *

笔记：

1.  Firefox Scratchpad 之所以有效，是因为它没有被 GM 沙箱隔离。
2.  至于为什么它似乎可以在 Win XP 上运行，这很可能是侥幸——它在 XP 上对我不起作用，也不应该。

    在某些`@grant none`情况下，这种代码可能会起作用。（`@grant none`在许多情况下默认应用；请参阅文档。）

    或者可能有多个版本的脚本在运行，甚至 FF 已损坏并需要重新启动。

    最重要的是，不要那样编码。

3.  至于`but the watch expression returns undefined?`...这只是工作中的沙盒隔离，在我看来，它在 XP 上看起来是一样的。

4.  像上面这样使用的代码`querySelector()`几乎可以在用户可能遇到的每个页面上工作，而且**它肯定在这个问题的参数范围内工作**。但它目前不适用于某些*可能的*HTML5 表单和一些据称用于某些网站的***无效HTML。***

    在这两种情况下，我在上面给出的陷阱链接中提到的代码都可以工作，尽管存在某些无效的 HTML 或最新的 HTML5 提议的功能。

    具体来说，这种代码虽然不如 灵活，但`querySelector`适用于更广泛的场景（即使它们是无效的 HTML）：

    ```
    if (/agecheck/i.test (location.pathname) ) {
        var ageForm = document.querySelector ("#agegate_box form");
        ageForm.elements.namedItem ('ageDay').value     = 18;
        ageForm.elements.namedItem ('ageMonth').value   = 'August';
        ageForm.elements.namedItem ('ageYear').value    = 1987;
        ageForm.submit ();
    } 
    ```

# powershell - 脚本正在输出一个额外的 0

> ID：13164166
> 
> 赞同：1
> 
> 时间：2012-10-31T18:11:52.300
> 
> 标签：powershell

我有以下绑定到活动目录 OU 并列出计算机的 powershell 脚本。它似乎工作正常，只是它输出了一个额外的 0 - 我不知道为什么。任何人都可以帮忙吗？

```
 $strCategory = "computer"

 $objDomain = New-Object System.DirectoryServices.DirectoryEntry("LDAP://          OU=Computers,OU=datacenter,DC=ourdomain,DC=local")

 $objSearcher = New-Object System.DirectoryServices.DirectorySearcher($objDomain)
 $objSearcher.Filter = ("(objectCategory=$strCategory)")

  $colProplist = "name"
  foreach ($i in $colPropList){$objSearcher.PropertiesToLoad.Add($i)}

 $colResults = $objSearcher.FindAll()

 foreach ($objResult in $colResults)
 {
 $objComputer = $objResult.Properties; 
 $objComputer.name
 } 
```

输出： **0** Server1 Server2 Server3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T18:14:19.317

您需要捕获（或忽略）PropertiesToLoad.Add 方法的输出，否则您将获得 $colPropList 中每个属性的值。

```
foreach ($i in $colPropList){[void]$objSearcher.PropertiesToLoad.Add($i)} 
```

您可以简化和缩短脚本并在一次调用中加载一堆属性，而无需使用 foreach 循环。AddRange 方法的另一个好处是它不输出请求属性的长度，因此无需捕获任何内容。

```
$strCategory = "computer"
$colProplist = "name","distinguishedname"

$searcher = [adsisearcher]"(objectCategory=$strCategory)"
$searcher.PropertiesToLoad.AddRange($colProplist)
$searcher.FindAll() | Foreach-Object {$_.Properties} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T18:17:09.583

我怀疑您的 foreach 循环在调用 PropertiesToLoad.Add 时正在输出结果。

尝试管道到[out-null](http://technet.microsoft.com/library/hh849716.aspx)，如下所示：

```
foreach ($i in $colPropList){
    $objSearcher.PropertiesToLoad.Add($i) | out-null
} 
```

# java - 使用多个 java 概念的箭头悲伤游戏

> ID：13164169
> 
> 赞同：1
> 
> 时间：2012-10-31T18:12:03.503
> 
> 标签：java, swing, awt

这是我的简单箭头排序应用程序的代码。

它生成一个大小为 4 的随机序列，包括向上、向下、向左和/或向右箭头键，并一次显示一个。如果他们用户正确地重复该序列，它会显示另一个 5 个键的序列。只要用户输入正确的序列，序列的大小就会不断增加，但如果输入了无效的序列，则序列的大小就会减小。

我遇到的问题是，第一次执行完美无缺，它甚至第二次显示序列，但在第二次迭代期间它不接受我的键盘输入。

为了更好地理解问题，我将其分解为主要动作执行块和完整的代码以及最后。

***序列生成***

```
for(int flag=1;flag<size;flag++)
    {
    random = randomGenerator.nextInt(4);
    generated[flag]=random;
    setVisible(true);
    switch(random)
        {
            case 0:
            left();
            break;
            case 1:
            up();
            break;
            case 2:
            right();
            break;
            case 3:
            down();
            break;
        }
        delaybig();     
    } 
```

***用户输入序列***

```
public void keyPressed(KeyEvent e)
{
    if(cflag<=size) 
    {
        if(e.getKeyCode()==37)
            {
                entered[cflag]=0;
                cflag++;
                Keys.setText("LEFT");
                left();
            }
        else if(e.getKeyCode()==38)
            {
                entered[cflag]=1;
                cflag++;
                Keys.setText("UP");
                up();
            }
        else if(e.getKeyCode()==39)
            {
                entered[cflag]=2;
                cflag++;
                Keys.setText("RIGHT");
                right();
            }
        else if(e.getKeyCode()==40)
            {
                entered[cflag]=3;
                cflag++;
                Keys.setText("DOWN");
                down();
            }
    else
        {
            Keys.setText("INVALID");
        }
    } 
```

***使用 Arrays.equals 进行序列比较***

```
if(cflag==size)
    {
        boolean check = Arrays.equals(generated, entered);
        if(check)
            {
                delaysmall();
                Keys.setText("PERFECT");
                size++;
                cflag=1;
                delaysmall();
                Keys.setText("GO AGAIN");
                delaybig();
                restart();  
            }
        else
            {
                delaysmall();
                Keys.setText("FAILED");
                if(size>5)
                    {
                        delaybig();
                        restart();
                        size--;
                        cflag=1;
                    }
            }
    } 
```

***循环线程***

```
public void restart() 
{ 
    Thread goagain =  new Thread() 
    {
        @Override
        public void run()
             {
                launchframe();
             }
        };
        goagain.start();
} 
```

我在这上面花了很长时间都无济于事，所以这里是完整的代码，以防你怀疑错误喜欢其他地方。

```
import java.io.*;
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;
import java.util.Random;
import java.util.Arrays;

class ArrowSorrow extends Frame implements KeyListener{

int flag;
Image img;
int random;
int cflag=1,size=5;
boolean ShowImage=true;
int entered[]=new int[50];
int generated[]=new int[50];
TextField Keys=new TextField(8);
Random randomGenerator = new Random();
MediaTracker mt = new MediaTracker(this);

public ArrowSorrow(String title)
    {
        super(title);
    }

public void restart() 
    { 
        // Create a new thread
    Thread goagain =  new Thread() 
    {
        // Override run() to provide the running behavior of this thread.
        @Override
        public void run()
             {
                launchframe();
             }
        };
        goagain.start();
}
public void launchframe()
{
    for(int flag=1;flag<1;flag++)
        generated[flag]=0;
    for(int flag=1;flag<1;flag++)
        entered[flag]=0;
            splash();
    add(Keys);
            delaybig();
    setSize(400,400);
    Keys.setEditable(false);
    Keys.setText("MEMORIZE");
    Keys.addKeyListener(this);      
    setBackground(Color.black);
    setLayout(new FlowLayout());
for(int flag=1;flag<size;flag++)
        {
        random = randomGenerator.nextInt(4);
        generated[flag]=random;
        setVisible(true);
        switch(random)
            {
                case 0:
                left();
                break;
                case 1:
                up();
                break;
                case 2:
                right();
                break;
                case 3:
                down();
                break;
            }
            delaybig();     
        }
        String sequence=new String("");
        for(flag=1;flag<size;flag++)
            {
                sequence=sequence+(Integer.toString(generated[flag]));
            }
            Keys.setText(sequence);
            delaysmall();
            Keys.setText("REPEAT");
            delaysmall();
            setVisible(true);

            addWindowListener(new WindowAdapter()
                {
                    public void windowClosing(WindowEvent we)
                        {
                            dispose();
                        }
                });
    }
public void splash()
    {
    img = ToolKit.getDefaultToolkit().getImage("image address for splashscreen.jpg");
    mt.addImage(img,0);
    repaint();
    setVisible(true);
}

public void left()
{
    img = Toolkit.getDefaultToolkit().getImage("image address for left.jpg");
    mt.addImage(img,0);
    repaint();
    setVisible(true);
}

public void right()
{
    img = Toolkit.getDefaultToolkit().getImage("image address for right.jpg");
    mt.addImage(img,0);
    repaint();
    setVisible(true);
}

public void up()
{
    img = Toolkit.getDefaultToolkit().getImage("image address for up.jpg");
    mt.addImage(img,0);
    repaint();
    setVisible(true);
}

public void down()
{
    img = Toolkit.getDefaultToolkit().getImage("image address down.jpg");
    mt.addImage(img,0);
    repaint();
    setVisible(true);
}
//minor delay
public void delaysmall()
{
    try 
        {
            Thread.sleep(600);
        } 
    catch(InterruptedException ex) 
        {
            Thread.currentThread().interrupt();
        }   
}
//major delay
public void delaybig()
{
    try 
        {
            Thread.sleep(1200);
        } 
    catch(InterruptedException ex) 
        {
            Thread.currentThread().interrupt();
        }   
}

public void paint(Graphics g)
{
super.paint(g); 
if(img != null)
    g.drawImage(img,70,70, this);
else
    g.clearRect(0, 0, getSize().width, getSize().height);
}

public void keyPressed(KeyEvent e)
{
    if(cflag<size)  
    {
        if(e.getKeyCode()==37)
            {
                entered[cflag]=0;
                cflag++;
                Keys.setText("LEFT");
                left();
            }
        else if(e.getKeyCode()==38)
            {
                entered[cflag]=1;
                cflag++;
                Keys.setText("UP");
                up();
            }
        else if(e.getKeyCode()==39)
            {
                entered[cflag]=2;
                cflag++;
                Keys.setText("RIGHT");
                right();
            }
        else if(e.getKeyCode()==40)
            {
                entered[cflag]=3;
                cflag++;
                Keys.setText("DOWN");
                down();
            }
    else
        {
            Keys.setText("INVALID");
        }
    }
//comparing generated sequence and user input sequence      
if(cflag==size)
    {
        boolean check = Arrays.equals(generated, entered);
        if(check)
            {
                delaysmall();
                Keys.setText("PERFECT");
                size++;
                cflag=1;
                delaysmall();
                Keys.setText("GO AGAIN");
                delaybig();
                restart();  
            }
        else
            {
                delaysmall();
                Keys.setText("FAILED");
                if(size>5)
                    {
                        delaybig();
                        restart();
                        size--;
                        cflag=1;
                    }
            }
    }
}
public void keyTyped(KeyEvent e){}
public void keyReleased(KeyEvent e){}
}

class ArrowSorrowLaunch{
public static void main(String args[])
    {
        ArrowSorrow instance=new ArrowSorrow("Arrow Sorrow");
        instance.launchframe();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:17:42.690

1.  更改`Thread.sleep(int)`为[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)，否则您会为[Swing 中的 Concurency烦恼](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)

2.  `Thread.sleep(int)`冻结`Swing GUI`直到结束，在此睡眠期间，任何`Mouse`或`Key`事件都不会被调度或消耗

3.  不要`paint`直接到`JFrame`，放在那里`JPanel`或`JComponent`

4.  用于 `JPanel`或`JComponent`必须使用`paintComponent`而不是`paint()`

5.  不要使用`KeyListener`，使用`Keybinding`s 代替，否则必须`setFocusable()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T18:23:53.273

您调用`launchFrame`开始游戏的每次迭代。但是，您正在做很多工作`launchFrame`，应该只做一次。您应该将该初始化代码移出`launchFrame`并只执行一次。特别是您不应重复调用`Keys.addKeyListener(this);`或添加多个窗口侦听器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-12T15:35:06.160

*OP的解决方案。*

修复，感谢 Ted Hopp。

***通过将它们移出 launchframe() 创建了这个新方法***

```
void oneTime()
{
    add(Keys);
    setSize(400,400);
    Keys.requestFocus();
    Keys.setEditable(false);
    Keys.setText("MEMORIZE");
    Keys.addKeyListener(this);      
    setBackground(Color.black);
    setLayout(new FlowLayout());
    launchframe();
} 
```

***更换***

```
 instance.launchframe();//this
    instance.oneTime();//with this in main 
```

# css - 按照速度测试中的建议，我如何用后代选择器标记这个 css？

> ID：13164173
> 
> 赞同：0
> 
> 时间：2012-10-31T18:12:19.877
> 
> 标签：css, stylesheet

[我最近在GMetrix](http://gmetrix.com)上为我的 asp.net 站点进行了速度测试，它一直抱怨我应该**用 3 个后代选择器标记键，而用标记过度限定的类**。

例如，我的样式表中有这个：

```
div.menu ul li a, div.menu ul li a:visited
{
background-color: #465c71;
border: 1px #4e667d solid;
color: #dde4ec;
display: block;
line-height: 1.35em;
padding: 4px 20px;
text-decoration: none;
white-space: nowrap;
border-radius: 3px; 
z-index:20;
}

div.menu ul li a:hover
{
background-color: #bfcbd6;
color: #465c71;
text-decoration: none;
z-index:20;
}

div.menu ul li a:active
{
background-color: #465c71;
color: #cfdbe6;
text-decoration: none;
z-index:20;
} 
```

或者，例如，速度测试还为此推荐了**3 个后代选择器**：

```
/* Top level menu links style */
.sidebarmenu ul li a{
display: block;
overflow: auto; /*force hasLayout in IE7 */
color: #dde4ec;
text-decoration: none;
padding: 6px;
border: 1px #4e667d solid;
border-bottom: 1px solid #4e667d;
border-right: 1px solid #4e667d;
border: 0px solid #800000;
}

.sidebarmenu ul li a:link, .sidebarmenu ul li a:visited, .sidebarmenu ul li a:active{
background-color: #465c71; /*background of tabs (default state)*/
border: 0px solid #800000;
}

.sidebarmenu ul li a:visited{
border: 0px solid #800000;
}

.sidebarmenu ul li a:hover{
background-color: #bfcbd6;
color: #465c71;
border: 0px solid #800000;
} 
```

我对CSS一无所知。有人可以解释一下我如何在这里使用**后代选择器**，我认为这意味着结合这些东西吗？感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:16:58.047

我想这是说这个声明是过度限定的

```
.sidebarmenu ul li a 
```

所以你也可以使用它来简单地给你的`<a>`元素一个类，例如说`.menu_link`

现在你可以简单地在你的样式表中使用它

```
a.menu_link {
   display: block;
   overflow: auto; /*force hasLayout in IE7 */
   color: #dde4ec;
   text-decoration: none;
   padding: 6px;
   border: 1px #4e667d solid;
   border-bottom: 1px solid #4e667d;
   border-right: 1px solid #4e667d;
   border: 0px solid #800000;
}

a.menu_link:link, a.menu_link:visited, a.menu_link:active{
   background-color: #465c71; /*background of tabs (default state)*/
   border: 0px solid #800000;
}

a.menu_link:visited{
   border: 0px solid #800000;
}

a.menu_link:hover{
   background-color: #bfcbd6;
   color: #465c71;
   border: 0px solid #800000;
} 
```

# excel - excel显示截断的数字而不是完整格式

> ID：13164176
> 
> 赞同：0
> 
> 时间：2012-10-31T18:12:37.147
> 
> 标签：excel

我正在尝试将一个 excel 文件导出到 csv 并将这个数字导出：680001010091945 为：6.8E+14 如何让它显示完整的数字而不是截断的数字？有什么帮助吗？谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:16:13.513

将列格式化为带有 0 个十进制数字的数字。

# asp-classic - tag instead of Server.CreateObject in ASP Classic negates the use of set variable = nothing? SO, I learned that in old school ASP Classic if you use the tag it provides a performance improvement over using set rs = Server.CreateObject("ADODB.Recordset") However, all was lost when I tried to execute. set rs = nothing Is this the intended behavior? does that tag make asp handle disposing of object better? If you are including this object declaration directly in your asp page (not global.asax) then it terminates itself once the page request ends. You can also include these in your global.asa file if you want them to persist over the session or application scope. Note the SCOPE attribute. This loads the recordset into an application variable (can be set to either "session" or "application" depending on your use case). You can easily destroy session variables in your scripts like this: Session.Abandon Or if you want to kill the session variable but leave the session open, just terminate the session variable like this: Set Session("rsCustomers") = Null If you just want the RS object for the page, then leave out the scope attribute, and include the object declaration in the page itself. The id will be available as a regular variable as though you declared it in a vbscript codeblock directly in the page. Just remember to do a .close to close the object, and the object will terminate on its own as soon as the page load is complete (e.g. when the page scope is complete). Hope this helps. asp-classicvbscriptado 4 1 回答 1 This answer is useful 1 如果您将这个对象声明直接包含在您的 asp 页面（不是 global.asax）中，那么它会在页面请求结束后自行终止。 如果您希望它们在会话或应用程序范围内持续存在，您还可以将它们包含在您的 global.asa 文件中。 注意SCOPE属性。这会将记录集加载到应用程序变量中（可以根据您的用例设置为“会话”或“应用程序”）。您可以像这样轻松地销毁脚本中的会话变量： Session.Abandon 或者，如果您想终止会话变量但保持会话打开，只需像这样终止会话变量： Set Session("rsCustomers") = Null 如果您只想要页面的 RS 对象，则省略范围属性，并在页面本身中包含对象声明。 id 将作为常规变量提供，就像您直接在页面中的 vbscript 代码块中声明它一样。只需记住.close关闭对象，一旦页面加载完成（例如，当页面范围完成时），对象将自行终止。 希望这可以帮助。 于 2012-11-02T13:31:52.240 回答 Related 1 svn - svn:externals 用于单个文件不起作用 3 java - 在捕获组中转义正则表达式 1 c# - 在 WP7 的 WebBrowser 控件中加载 HTML 脚本和视频播放 3 parsing - 在hadoop中使用mapreduce程序解析pdf文件 2 javascript - 如何知道在表格中点击的元素？ 3 asp.net - 仅更改一个数据字段时更新日期完整列 23 version-control - 在版本控制下使用 IPython / Jupyter Notebooks 1 varray - 我想在 PL/SQL 中将表的列值插入到 varray 集合中 5 java - 动态更改 Listview/ArrayAdapter 的图像 1 c# - 在 XNA 中快速绘制多个 2D 纹理 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：13164178
> 
> 赞同：3
> 
> 时间：
> 
> 标签：asp-classic, vbscript, ado

SO, I learned that in old school ASP Classic if you use the

`<object runat="server" id="somename" progid="ADODB.Recordset"></object>`

tag it provides a performance improvement over using

```
set rs = Server.CreateObject("ADODB.Recordset") 
```

However, all was lost when I tried to execute. `set rs = nothing` Is this the intended behavior? does that tag make asp handle disposing of object better?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T13:31:52.240

如果您将这个对象声明直接包含在您的 asp 页面（不是 global.asax）中，那么它会在页面请求结束后自行终止。

如果您希望它们在会话或应用程序范围内持续存在，您还可以将它们包含在您的 global.asa 文件中。

```
<OBJECT ID=rsCustomers PROGID="ADODB.Recordset" RUNAT="Server" SCOPE="Application"></OBJECT> 
```

注意`SCOPE`属性。这会将记录集加载到应用程序变量中（可以根据您的用例设置为“会话”或“应用程序”）。您可以像这样轻松地销毁脚本中的会话变量：

`Session.Abandon`

或者，如果您想终止会话变量但保持会话打开，只需像这样终止会话变量：

`Set Session("rsCustomers") = Null`

如果您只想要页面的 RS 对象，则省略范围属性，并在页面本身中包含对象声明。

id 将作为常规变量提供，就像您直接在页面中的 vbscript 代码块中声明它一样。只需记住`.close`关闭对象，一旦页面加载完成（例如，当页面范围完成时），对象将自行终止。

希望这可以帮助。

# np-complete - 是否可以证明 NP 完全问题不存在多项式算法？

> ID：13164183
> 
> 赞同：0
> 
> 时间：2012-10-31T18:13:16.310
> 
> 标签：np-complete, np, np-hard

我似乎无法真正理解说问题是 NP-Complete 的真正含义。谁能帮我解决以下问题？

*NP完全问题是可以证明不存在在多项式时间内解决它的算法的问题。陈述是真的吗？*

我想说这个说法是不正确的，因为任何人都可以*真正*证明对于任何 NP-Complete 问题都不存在这样的算法吗？通过环顾各种来源，我了解到*对于*任何 NP-Complete 问题都没有多项式时间算法；但是，无法证明。

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:18:41.350

在某些情况下，可以证明不存在优于某个限制的算法。

例如，`O(n log n)`比较排序的界限已被[证明](http://en.wikipedia.org/wiki/Comparison_sort#Number_of_comparisons_required_to_sort_a_list)。无论我们将来变得多么聪明，我们可以肯定没有人会发明`O(n)`比较分类。

但在这种情况下，没有人找到证据。但这并不意味着它不能被证明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-09T00:30:25.527

该陈述从根本上是错误的：有些问题无法在多项式时间内解决，这比 NP 问题要困难得多。NP 完备性的点是存在的多项式时间解等价于 P=NP（这另外意味着不存在的解意味着 P!=NP）。

# mod-rewrite - 包含“？”的 RewriteRule 域

> ID：13164187
> 
> 赞同：1
> 
> 时间：2012-10-31T18:13:37.553
> 
> 标签：mod-rewrite, redirect, url-rewriting

我想要 RewriteRule 域的 /page/test 或 /page/test/ 去 www.domain.com。仅针对这两个示例。我尝试：

```
RewriteRule ^/page/test/?$ http://www.domain.com [R=301,L,NC] 
```

这会很好，但我还有其他页面，例如 /page/test/?D_test，当我放置 RewriteRule 时，还会重定向 /page/test/?D_test。问题是“？”。我应该如何编写规则以不将其他页面重写为 www.domain.com ？例如

```
/page/test/?D_test /page/test/(.*) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:27:42.440

我不确定我是否理解你的问题。您要么问我如何将包括查询字符串在内的所有流量重定向到域并取消查询字符串。在这种情况下，我通常这样做：

```
RewriteRule ^/page/test/?$ http://www.domain.com? [R=301,L,NC] 
```

如果你想让它在有查询字符串时不会重定向，那么你必须使用重写条件。

```
RewriteCond %{QUERY_STRING} ^$
RewriteRule ^/page/test/?$ http://www.domain.com? [R=301,L,NC] 
```

# django - Django 生成表名不同的 sql，然后在元 db_table 中指定

> ID：13164189
> 
> 赞同：0
> 
> 时间：2012-10-31T18:13:54.930
> 
> 标签：django, oracle, django-models, cx-oracle

我正在使用带有 oracle 后端的 django 1.4

在我的 models.py 中，我有：

```
 class ProteinTherapeutics(models.Model):
#...
    class Meta:
        db_table = 'mnowotka\".\"protein_therapeutics'
        managed=False 
```

和这个：

```
ProteinTherapeutics.objects.exists() 
```

产生这个 SQL：

```
SELECT *
FROM
  (SELECT ROWNUM AS "_RN",
          "_SUB".*
   FROM
     (SELECT (1) AS "A"
      FROM "MNOWOTKA"."PROTEIN_THERAPEFB7C") "_SUB"
   WHERE ROWNUM <= 1)
WHERE "_RN" > 0  [1.99ms] 
```

你能帮我吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-31T21:45:03.333

我想问题出在表名长度上。我不知道 django，但我认为它试图将名称**mnowotka"."protein_therapeutics**（31 个字符）缩短为 30 个字符。也许有一些用于模式的元，例如

```
class ProteinTherapeutics(models.Model):
#...
    class Meta:
        db_table = 'protein_therapeutics'
        schema = 'mnowotka'
        managed=False 
```

# c++ - goto 优化重构

> ID：13164195
> 
> 赞同：4
> 
> 时间：2012-10-31T18:14:13.610
> 
> 标签：c++, c, goto

我有一个“MyFunction”，我一直在纠结是否应该在上面使用 goto 以及在类似（希望很少见）的情况下。所以我正在努力为这种情况建立一个硬性的习惯。做或不做。

```
int MyFunction()
{   if (likely_condition)
    {
    condition_met:
        // ...
        return result;
    }
    else /*unlikely failure*/
    {   // meet condition
        goto condition_met;
    }
} 
```

我打算将失败的条件跳转指令的好处用于可能的情况。但是，如果没有这样的事情，我看不出编译器如何知道要简化哪个案例概率。

1.  它工作正常吗？
2.  这些好处值得混淆吗？
3.  是否有更好的（不那么冗长、更结构化、更具表现力）的方法来实现这种优化？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T18:22:13.270

在我看来，您尝试做的优化大多已经过时了。大多数现代处理器都内置了分支预测，因此（假设它已经足够注意到）它们跟踪分支被采用的频率，并根据其过去的被采用模式预测分支是否可能被采用. 在这种情况下，速度主要取决于预测的准确程度，而不是预测是接受还是不接受。

因此，您最好使用更简单的代码：

```
int MyFunction() {   
    if (!likely_condition) {
        meet_condition();
    }
    // ...
    return result;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T18:20:12.423

1.  看起来只要`condition_met:`不跳过变量初始化，代码就应该像您期望的那样工作。

2.  不，你甚至不知道混淆版本会编译成更优化的代码。编译器优化（和处理器分支预测）最近变得非常聪明。

3.

```
int MyFunction()
{
    if (!likely_condition)
    {
        // meet condition
    }

    condition_met:
        // ...
    return result;
} 
```

或者，如果它有助于您的编译器（检查程序集）

```
int MyFunction()
{
    if (likely_condition); else
    {
        // meet condition
    }

    condition_met:
        // ...
    return result;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-31T18:21:54.920

如果现代 CPU 做出正确的分支预测，它将以相同的性能采用该分支。因此，如果这是在一个内部循环中，那么 的性能`if (unlikely) { meet condition } common code;`将与您所写的相匹配。

此外，如果您在两个分支中拼出公共代码，编译器将*生成*与您编写的代码相同的代码：将为`if`子句发出常见情况，而`else`子句将`jmp`发送给公共代码。你总是会在更简单的终端案例中看到这一点，比如`*out = whatever; return result;`. 调试时很难分辨出`return`你在看哪个，因为它们都被合并了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T18:45:26.187

我强烈建议`__builtin_expect()`对您的特定 C++ 编译器使用宏 (GCC) 或类似的东西（请参阅[便携式分支预测提示](https://stackoverflow.com/questions/3702903/portable-branch-prediction-hints)），而不是使用`goto`：

```
int MyFunction()
{   if (__builtin_expect(likely_condition))
    {
        // ...
        return result;
    }
    else /*unlikely failure*/
    {   // meet condition
    }
} 
```

正如其他人也提到`goto`的那样，它容易出错，而且从骨子里是邪恶的。

# android - FragmentManager 给我错误的片段

> ID：13164196
> 
> 赞同：2
> 
> 时间：2012-10-31T18:14:13.667
> 
> 标签：android, android-fragments, android-viewpager

我正在使用这一行来显示当前片段：

```
Item myFragment = (Item) getSupportFragmentManager().findFragmentById(R.id.pager); 
```

这是我的 ViewPager 的一个例子

> | 一个 | 乙| C | D | E | F |

显示的第一个片段是 A，但 myFragment 是 B 当我转到 B 时，myFragment = B ... 当我转到 F 时，myFragment = E 你可以在这里看到代码：-> [TabsActivity.java](https://github.com/guitoun3/SortirSurBordeaux/blob/master/Sortir%20sur%20bordeaux/src/com/guillaumedesbieys/sortirsurbordeaux/activity/TabsActivity.java)

有人已经遇到这个问题了吗？为什么显示的片段与 myFragment 的值之间存在偏移？

谢谢

[编辑] 我添加了一个 Log() 现在这是我的 TabsActivity 的一部分

```
class TabsAdapter extends FragmentStatePagerAdapter  {

    public TabsAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int position) {
        Log.e("POSITION", position + "");
        return Item.newInstance(CONTENT.get(position % CONTENT.size()));
    }

    @Override
    public CharSequence getPageTitle(int position) {
        return CONTENT.get(position % CONTENT.size());
    }

    @Override
    public int getCount() {
      return CONTENT.size();
    }
} 
```

当我启动我的应用程序时，我的记录器显示： POSITION 0 POSITION 1

正常吗？它不应该只显示“POSITION 0”吗？当我滑动时，“位置 1”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T18:46:54.660

首先，您要求基于 ID 的片段。ID`R.id.pager`只是一些随机数，与任何事物相关联`R.id.pager`。在提供的代码中，您没有为任何片段分配 ID，因此您得到任何东西是幸运的。

如果要从 Viewpager 中检索 Fragment，则需要遵循此问题中回答的标准：[Update data in ListFragment as part of ViewPager](https://stackoverflow.com/questions/7379165/update-data-in-listfragment-as-part-of-viewpager)

其次，你得到“POSITION 0 POSITION 1”的原因是因为`ViewPager`检索当前页面**加上它附近没有的任何其他页面**。这意味着它正在调用`getItem()`当前页面、上一页和下一页。在位置 0，没有上一页，但有下一页。如果您滑动，您只会看到`POSITION 2`因为 ViewPager 需要创建`POSITION 2`以准备下一次滑动。如果您要跳到第 4 项，您会看到`POSITION 2 POSITION 3 POSITION 4`.

# asp.net - Sitefinity 中的自定义内容块

> ID：13164201
> 
> 赞同：0
> 
> 时间：2012-10-31T18:14:42.423
> 
> 标签：asp.net, sitefinity

我想在 Sitefinity 中创建一个自定义内容块，这样我就可以在它周围包裹一个标签并获取我的 CSS。

我创建了一个自定义小部件，但我不确定如何使其成为内容块。我找不到这方面的文档，但我确信这是很常见的情况。基本上，我想要一个这样做的内容块：

```
<aside>
[code for content block]
</aside> 
```

我不知道如何在 .net 中生成 [内容块] 代码。我是.net 开发的新手。我正在使用 VB，但可以使用 C#。

任何帮助将不胜感激。谢谢你。

玛丽亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-23T12:40:28.723

您可以创建一个自定义布局控件，该控件可以与其他控件（例如内容块）一起使用。

若要创建布局控件，请在 Visual Studio 中打开您的项目并在 WebApp 项目中创建一个新的控件 (.ascx) 文件。我通常把我的放在我创建的 ~/LayoutControls 文件夹中。在该控制文件中，输入如下内容：

```
<div runat="server" class="sf_cols">
    <aside>
        <div id="Div1" runat="server" class="sf_colsIn"></div>
    </aside>
</div> 
```

您会注意到，除了您想要的`aside`标记、标签之外，我还有另外两个带有一些细节的 div。这些是必需的，因此 Sitefinity 可以将其视为控件，并能够动态地将内容注入其中。

具有类的 div`sf_cols`对所有控件都是通用的，具有类`sf_colsIn`(id="Div1") 的 div 是您拖放到布局控件上的控件所在的位置。所以有一个外包装 div、你的标记和一个内部 div。这是您的内容所在的内部 div。

保存文件，编译项目，然后在 Sitefinity 中注册控件。

为此，请登录到后端，然后导航到管理 | 设置 | 高级设置 | 工具箱 | 工具箱 | 页面布局 | 部分。我通常会添加一个具有以下属性的新部分：

name=Custom,Title=Custom,Description=Custom Layouts,Global resourceClassId=PageResources

然后选择您的新部分，选择工具，然后选择新建。Name、Title、Description 对你来说是有意义的。控制 CLR 类型应该是`Telerik.Sitefinity.Web.UI.LayoutControl, Telerik.Sitefinity`，布局模板应该是 ascx 文件的路径，即`~/LayoutControls/AsideBlock.ascx`. 其他属性可以具有默认值（大多数只是空白）。然后保存。

现在，当您编辑页面时，单击右侧栏中的“布局”按钮，您将看到包含您的控件的“自定义”部分。将其拖到页面上，然后返回到“内容”编辑（使用右侧栏中的按钮）。您将看到您的布局控件并将内容块拖放到它上面。

正常添加内容。当页面呈现时，内容将被包装在 side 标记中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:30:02.623

最简单的方法是使用内容块的外部模板。您想要的模板是 ContentBlock.ascx 并且在 SDK 中。

将此文件复制到您的项目中，然后在**contentHtml**文字控件（呈现控件的实际内容）周围添加包装标签。

然后打开要使用此模板的内容块小部件的高级设置并指定 LayoutTemplatePath。它应该具有类似于“~/SFRES/Telerik.Sitefinity.Resources.Templates.Backend.GenericContent.ContentBlock.ascx”的默认值。

只需将其更改为您创建的模板的虚拟路径，然后保存并发布页面。

内容块将使用您添加的任何标记呈现您的模板，而不是默认模板。

我希望这是有帮助的！

我将创建一个更详细的博客文章来介绍此过程，并在完成后将其链接到此处。谢谢你给我灵感！

# magento - 覆盖 Magento 模板

> ID：13164208
> 
> 赞同：0
> 
> 时间：2012-10-31T18:15:06.997
> 
> 标签：magento, module, overriding

我正在制作一个需要覆盖 top.phtml 的块/模板的模块，所以我在模块的布局中添加了这段代码。

```
<?xml version="1.0" encoding="UTF-8"?>
<layout version="0.1.0">
     <default translate="label" module="page">  
           <reference name="top.menu">
                 <action method="setTemplate"><template>navigationmenu/navigationMenu.phtml</template></action>
    </reference>
  </default>
  </layout> 
```

它不起作用，但是如果我尝试引用标题块它会更改模板，我不知道是否必须在我的 xml 中设置其他任何内容。

编辑：这是 page.xml 中的结构

```
<block type="page/html" name="root" output="toHtml" template="page/3columns.phtml">
 <block type="page/html_header" name="header" as="header">
  <block type="core/text_list" name="top.menu" as="topMenu" translate="label">
    <label>Navigation Bar</label>
  </block> 
 </block>
</block> 
```

我意识到我不需要 setTemplate 因为我需要使用我的自定义块 可以将我的引用放在默认标签下吗？我需要再做一个参考吗？

如果有帮助，我也在运行 Magento EE 1.9.1.1

# c# - 一些静态内容加载非常缓慢

> ID：13164210
> 
> 赞同：3
> 
> 时间：2012-10-31T18:15:17.633
> 
> 标签：c#, asp.net-mvc, iis, asp.net-mvc-2

我正在尝试将 MVC 2 Web 应用程序安装到我们的生产服务器。此应用程序已在多个测试服务器上运行和测试，但在生产中，一些静态内容（最显着的是 JavaScript 文件）加载非常非常缓慢（有时 60 多秒）。然而，有趣的是，并非所有静态内容都是如此——在典型的页面加载周期中，除了一个 JS 文件之外的所有 JS 文件都将成功传输到客户端，但一个会“粘住”，有时永远不会下载。

奇怪的是，如果我直接进入静态内容，它会立即加载。

我调查了处理程序映射，并将 IIS 配置与我们的测试环境进行了比较，一切都相似。什么会导致这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T01:52:19.593

尝试在 webconfig 文件中为静态内容设置此项，它将压缩文件并导致页面快速呈现

```
 <system.webServer>

<httpProtocol allowKeepAlive="true"/>
<httpCompression directory="%SystemDrive%\inetpub\temp\IIS Temporary Compressed Files">
  <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll"/>
  <dynamicTypes>
    <add mimeType="text/*" enabled="true"/>
    <add mimeType="message/*" enabled="true"/>
    <add mimeType="application/javascript" enabled="true"/>
    <add mimeType="*/*" enabled="false"/>
  </dynamicTypes>
  <staticTypes>
    <add mimeType="text/*" enabled="true"/>
    <add mimeType="message/*" enabled="true"/>
    <add mimeType="application/javascript" enabled="true"/>
    <add mimeType="*/*" enabled="false"/>
  </staticTypes>
</httpCompression>
<urlCompression doStaticCompression="true" doDynamicCompression="true"/>

<validation validateIntegratedModeConfiguration="false" />
<modules runAllManagedModulesForAllRequests="true" /> 
```

# c# - C# 中的计划操作，可立即选择 FullStop

> ID：13164212
> 
> 赞同：1
> 
> 时间：2012-10-31T18:16:02.043
> 
> 标签：c#, events, timer

我需要在一定的时间间隔内进行一些操作（例如，从 5 到 5 分钟循环），但需要能够在我想要的任何时候完全停止事情（按下按钮）。

我正在考虑使用[Timer类，但](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)[即使在计时器停止后](http://msdn.microsoft.com/en-us/library/system.timers.timer.stop.aspx)事件也可能会触发。

我怎样才能让一些代码在计时器上运行，并且仍然能够**立即**使一切完全停止？

就像我正确理解的那样：完全停止是指事件停止并且我可以处理计时器本身等对象。我不是在问如何避免在计时器停止后触发的意外事件产生副作用！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T18:28:51.393

这个问题的答案很大程度上取决于您的操作类型。

最好的方案是运行一个带有循环的线程并监听 abort 事件。

```
static AutoResetEvent abort = new AutoResetEvent();
Thread worker = new Thread(WorkerThread);

void MainThread()
{
  worker.Start();
  Thread.Sleep(30000);
  abort.Set();
}    

void WorkerThread()
{
  while(true)
  {
     if(abort.WaitOne(5000)) return;
     // DO YOUR JOB
  }
} 
```

当您`abort.Set()`从另一个线程调用时，这个线程将退出。

但是，如果您的代码长时间运行，则在工作完成之前您将无法退出。要立即退出，您将不得不中止线程，但由于资源消耗，这不太明智。

或者，如果您的操作长时间运行（假设您正在处理长数组），您可以像这样不时检查“中止”事件状态（例如，每次循环迭代）`abort.WaitOne(0)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T19:27:36.250

计时器的竞争条件是不可避免的，因为正如您所说，回调是从线程池执行的。但是，我相信即使它仍在执行事件，您也可以安全地处置计时器。一个可能有帮助的选项是如果您考虑使用`System.Threading.Timer`而不是，如果您需要知道计时器事件何时完成执行`System.Timers.Timer`，您可以调用[Timer.Dispose(WaitHandle) 。](http://msdn.microsoft.com/en-us/library/b97tkt95.aspx)这将防止在您还需要处理一些其他资源的情况下出现竞争条件 - 事件使用者函数将尝试使用的资源。

至于“立即”要求，最直接的可能是使用某种同步原语来停止执行的东西。例如考虑这个：

```
static System.Timers.Timer timer;

static void Main(string[] args)
{
    var cancelSource = new CancellationTokenSource();

    timer = new System.Timers.Timer(200);

    timer.Elapsed += new SomeTimerConsumer(cancelSource.Token).timer_Elapsed;
    timer.Start();

    // Let it run for a while
    Thread.Sleep(5000);

    // Stop "immediately"
    cancelSource.Cancel(); // Tell running events to finish ASAP
    lock (timer)
        timer.Dispose();

}

class SomeTimerConsumer
{
    private CancellationToken cancelTimer;

    public SomeTimerConsumer(CancellationToken cancelTimer)
    {
        this.cancelTimer = cancelTimer;
    }

    public void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
    {
        lock (timer)
        {
            // Do some potentially long operation, that respects cancellation requests
            if (cancelTimer.IsCancellationRequested)
                return;
            // More stuff here
        }
    }
} 
```

这是一个玩具示例，但它说明了我的观点。执行“立即停止”的 3 行具有以下特点：

*   到`Dispose`调用返回时，任何`// More stuff here`代码都不会再次执行。
*   由于锁的原因，在处置计时器时，没有任何`// More stuff here`代码可以执行。
*   前两个特性需要锁，但它们阻止计时器“立即”停止，因为在进入锁时，它需要等待所有计时器事件调用完成（如果它们已经启动）。出于这个原因，我添加了取消作为中止当前正在执行的事件的最快方法，同时仍然保证它们不会在计时器处置期间执行。

Note: if you need multiple timer events to execute simultaneously, consider using a `ReaderWriterLockSlim` instead of a monitor.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T18:23:05.223

我会考虑以下两种选择之一：

1.  对需要执行的事件进行安全检查。类似于数据库标志的东西。因此，即使 Timer 未能停止，事件也会在安全检查失败时退出。

2.  使用[Quartz.Net 之](http://quartznet.sourceforge.net/)类的东西进行调度。这真的很重，但它会做你想做的事。

# vb.net - 整合 VB.NET 中的冗余代码

> ID：13164214
> 
> 赞同：0
> 
> 时间：2012-10-31T18:16:06.517
> 
> 标签：vb.net, refactoring

有没有更优雅或更有效的方式来编写我的一些代码？

特别是，我的所有表单上都有一个工具条。每个表单都有自己的一组方法，它们本质上是在做同样的事情。有没有办法删除所有方法保存一个，然后将其包含在我的表单特定变量的 switch 语句中？

我正在谈论的一个例子：

```
'Form 1
Private Sub ExitToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ExitToolStripMenuItem.Click
    Application.Exit()
End Sub

'Form 2
Private Sub ExitToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ExitToolStripMenuItem.Click
    Application.Exit()
End Sub 
```

我可以删除其中一个，然后将另一个移动到一个单独的模块并让它同时为 form1 和 form2 工作吗？

```
 Private Sub ExitToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles [myWholeDangProject].ExitToolStripMenuItem.Click
    Application.Exit()
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:50:56.483

无法将 WithEvents 事件定向到共享模块。不过，就像您说的那样，共享类或 VB.NET 模块可以包含可以从两个控件事件处理程序调用的子例程。

您*可以*创建一个共享事件处理程序，但您必须使用[AddHandler](http://msdn.microsoft.com/en-us/library/7taxzxka.aspx)关键字将代码实际附加到事件中，尽管在大多数简单情况下，直接调用 sub 会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T18:55:19.333

是的，当表单初始化时，使用 Addhandler 和 AddressOf 连接事件。

```
AddHandler ExitToolStripMenuItem.Click, AddressOf MyModule.ExitHandler 
```

和

```
Public Sub ExitHandler(ByVal sender As System.Object, ByVal e As System.EventArgs) 
    Application.Exit()
End Sub 
```

# mysql - 在 MYSQL 中显示没有数据类型的列名

> ID：13164215
> 
> 赞同：1
> 
> 时间：2012-10-31T18:16:08.813
> 
> 标签：mysql, sql

`show columns from table_name;`

上面的 MYSQL 命令，在一个表中显示所有具有数据类型的列名。我只想要没有其他信息的列名。

任何形式的帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T18:17:51.207

```
SELECT column_name
FROM information_schema.columns
WHERE table_schema = 'db_name'
AND table_name = 'your_table' 
```

[SQLFiddle 示例](http://sqlfiddle.com/#!2/8f033/2)

# javascript - Enyo 自定义属性

> ID：13164216
> 
> 赞同：1
> 
> 时间：2012-10-31T18:16:12.357
> 
> 标签：javascript, properties, enyo

我尝试在 enyo 中创建自己的类型

```
enyo.kind(
{
    name: "DeviceButton",
    kind: "Button",
    caption: "",
    published: { userAgent: "" },
    flex: 1,
    onclick: "butclick",
    butclick: function() { console.log("User agent changed to " + this.userAgent) }
}) 
```

但是当我点击时没有显示任何内容

如果我刚刚

```
onclick: console.log("User agent changed to " + this.userAgent) 
```

打印出 this.userAgent 未定义

我究竟做错了什么？

顺便说一句，是否可以通过 onclick 发送参数（以便响应点击的函数获取变量）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T20:55:19.063

您在这里遇到的问题是 onclick 属性实际上是为 Enyo 提供事件处理程序的名称，以便在收到点击时将事件发送到。“butclick”事件不会发送到 DeviceButton，而是发送到其父级。

如果您想完全在您的同类中处理事件，那么您需要将其设置为“处理程序”。在 Enyo 2.x 中，您可以这样做：

```
enyo.kind(
{
    name: "DeviceButton",
    kind: "Button",
    caption: "",
    published: { userAgent: "" },
    flex: 1,
    handlers {
      onclick: "butclick"
    },
    butclick: function() { console.log("User agent changed to " + this.userAgent) }
}) 
```

在 Enyo 1.x 中，您只需将处理函数命名为“onclickHandler”。我提到 Enyo 1 解决方案是因为我看到您的定义中有“flex: 1”。Enyo 2 不支持 Flexbox，我们有一个“Fittable”系统来代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T01:18:51.250

我为您做了一个小例子，enyo 如何处理与自定义类型之间的发送和接收值。我还在代码中添加了一些简短的注释。

[http://jsfiddle.net/joopmicroop/K3azX/](http://jsfiddle.net/joopmicroop/K3azX/)

```
enyo.kind({
    name: 'App',
    kind: enyo.Control,
    components: [
        {kind:'FittableRows', components:[
            // calls the custom kind by it's default values
            {kind:'DeviceButton',name:'bttn1', classes:'joop-btn',ontap:'printToTarget'},
            // calls the custom kind and pass the variables to the DeviceButton kind
            {kind:'DeviceButton', name:'bttn2', btnstring:'Get Agent', useragent:'chrome', classes:'joop-btn', ontap:'printToTarget'},
            {tag:'div', name:'targetContainer', content:'no button clicked yet', classes:'joop-target'},
        ]},                
    ],
    printToTarget:function(inSender, inEvent){
        // inSender = the button that was pressed
        this.$.targetContainer.setContent(inSender.name+' has used the value: "'+inSender.getUseragent()+'" and sends the value of: "'+inSender.getValueToPrint()+'" back.');  
    },

});

enyo.kind({
    name:'DeviceButton',
    kind:enyo.Control,
    components:[
        {kind:'onyx.Button',name:'btn', ontap:'printUsrAgent'}
    ],
    published:{
        btnstring:'default btnstring', // value that will be received
        useragent:'default useragent',  // value that will be received
        valueToPrint:'default valueToPrint' // value that will be used 
    },
    rendered:function(){
        this.inherited(arguments);
        this.$.btn.setContent(this.btnstring);
    },
    printUsrAgent:function(inSender,inEvent){
        // set a parameter with the value that was received of if not received use the default value (normaly would do some calculations with it first)
        this.valueToPrint = this.useragent+' after changes'; 
    },
});
​ 
```

# python - Python：使用 dict 派生类 - self={ 的奇怪行为

> ID：13164218
> 
> 赞同：2
> 
> 时间：2012-10-31T18:16:14.187
> 
> 标签：python, class, dictionary, self

A级和B级有什么区别？

自己怎么了？

为什么我需要逐行声明self？

```
class A(dict):
  def __init__(self):
    self={1:"you", 2:"and me"}
    print "inside of class A",self
class B(dict):
  def __init__(self):
    self[1]="you"
    self[2]="and me"
    print "inside of class B",self

a=A()
print "outside of class A",a
b=B()
print "outside of class B",b 
```

**结果：**

```
inside of class A {1: 'you', 2: 'and me'}
outside of class A {}
inside of class B {1: 'you', 2: 'and me'}
outside of class B {1: 'you', 2: 'and me'} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T18:18:26.577

```
 def __init__(self):
    self={1:"you", 2:"and me"} 
```

这不会修改作为 传递的对象`self`，而是将局部变量重新绑定`self`到新的字典。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T18:27:10.303

正如其他人所说，分配给`self`是没用的，因为它只会更改局部变量的值，而不会影响正在构造的字典。你想要的是这样的：

```
self.update({1:"you", 2:"and me"}) 
```

甚至：

```
dict.__init__(self, {1:"you", 2:"and me"}) 
```

如果您真的想控制您的类构造函数返回*哪个*实例（例如，实现实例缓存），[请查找`__new__`](http://www.python.org/download/releases/2.2/descrintro/#__new__).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T18:18:35.413

在 A 类中，您正在分配给局部`self`变量。当`__init__`被调用时，`self`包含一个引用所以构造的对象。您正在将其完全重新分配给其他东西；*这根本不会改变 A 类的实例*。

事实上，如果你在类 A 上定义一个新方法，你会注意到你分配给的 dict 在`self`那里甚至不可见。`__init__`它在返回的那一刻变得没有参考。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T18:34:46.117

just adding to the other good answers. you can see the difference in the Byte-code:

**Byte-code of `A`:**

```
Disassembly of __init__:
  3           0 BUILD_MAP                2
              3 LOAD_CONST               1 ('you')
              6 LOAD_CONST               2 (1)
              9 STORE_MAP           
             10 LOAD_CONST               3 ('and me')
             13 LOAD_CONST               4 (2)
             16 STORE_MAP           
             17 STORE_FAST               0 (self)  # stores values in local variable
                                                   # i.e not changing the object at all

  4          20 LOAD_CONST               5 ('inside of class A')
             23 PRINT_ITEM          
             24 LOAD_FAST                0 (self)
             27 PRINT_ITEM          
             28 PRINT_NEWLINE       
             29 LOAD_CONST               0 (None)
             32 RETURN_VALUE        

None 
```

**Byte-code of `B`:**

```
Disassembly of __init__:
  8           0 LOAD_CONST               1 ('you')
              3 LOAD_FAST                0 (self)  #loads self, i.e instance of dict
              6 LOAD_CONST               2 (1)
              9 STORE_SUBSCR                       #store value in it   

  9          10 LOAD_CONST               3 ('and me')
             13 LOAD_FAST                0 (self)
             16 LOAD_CONST               4 (2)
             19 STORE_SUBSCR        

 10          20 LOAD_CONST               5 ('inside of class B')
             23 PRINT_ITEM          
             24 LOAD_FAST                0 (self)
             27 PRINT_ITEM          
             28 PRINT_NEWLINE       
             29 LOAD_CONST               0 (None)
             32 RETURN_VALUE        

None 
```

# debugging - shell脚本执行顺序

> ID：13164219
> 
> 赞同：1
> 
> 时间：2012-10-31T18:16:16.193
> 
> 标签：debugging, shell

我正在调试一个 shell 脚本，所以我在开头添加了 set -x 代码片段如下

```
tcpdump -i $interface host $ip_addr and 'port 80' -w flash/flash.pcap &
sudo -u esolve firefox /tor_capture/flash.html &
sleep $capture_time 
```

但我注意到执行顺序如下

```
++ sleep 5
++ sudo -u esolve firefox /tor_capture/flash.html
++ tcpdump -i eth0 host 138.96.192.56 and 'port 80' -w flash/flash.pcap
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes 
```

所以执行顺序与脚本中的命令顺序相反这是什么问题以及如何处理？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:29:28.080

由于这些行是后台运行的，我认为输出来自`set -x`为运行程序而生成的子shell，并且主shell`sleep`在子shell继续生成输出之前获取命令。这可以解释为什么该`sleep`命令首先出现。至于另外两个，我想你可能偶尔也会以另一个顺序得到它们，因为两者之间没有同步 - 取决于你有多少 CPU，系统有多忙等等，时间子壳之间是伪非确定性的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T18:20:57.187

您需要前 2 行作为后台进程运行吗？

如果没有，请`&`在最后删除并重试。

# unit-testing - 在 IIS 服务器上运行“单元”测试的实用选择

> ID：13164222
> 
> 赞同：1
> 
> 时间：2012-10-31T18:16:19.977
> 
> 标签：unit-testing, iis, integration-testing, web-based

我有几个集成测试表示为 Microsoft 单元测试框架下的测试类。这是因为我的公司还没有决定使用（其他）集成测试框架。这些“单元”测试检查诸如证书安装在正确的位置、防火墙的渗透性等。在开发机器上运行它们当然很容易，但重要的是它们在登台和生产服务器上的行为。所以我需要的是一个适合这些环境的单元测试运行器。以下是一些选项：

1.  使用 MSTest.exe 从命令行运行它们。缺点：不想在登台和生产服务器上安装 VS20xx。
2.  使用 Maven。缺点：还没有爬上它最初的学习曲线。也许不是正确的用例开始（尽管例如故障安全插件）。Pro：似乎有足够的范围来（也）涵盖各种集成场景。
3.  我最初最喜欢的（实用的）选择如下：在 IIS 中安装一个充当单元测试运行器的服务。它应该提供一个基于 Web 的 UI，用于指向带有测试类等的 DLL，并用于可视化测试结果。可以说是“瘦”的、基于 Web 的单元测试运行器（包装器），主要用于部署和错误分析时。

我的问题是：你知道这样的野兽（对于微软单元测试框架）是否存在，如果存在，你能推荐一个特定的（或更好的方式来解决这个问题）吗？感谢您的关注。

# c# - 将xml导入mdb

> ID：13164223
> 
> 赞同：-1
> 
> 时间：2012-10-31T18:16:26.770
> 
> 标签：c#, asp.net

我现在正在尝试将 SQL-Server 查询导出到 XML 文件，并且我想将该文件导入 Access。我不明白该怎么做。

这是我用来生成 XML 的代码：

```
protected void Button1_Click(object sender, EventArgs e) {
    SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["SqlSconn"].ConnectionString);
    con.Open();

    string strSQL = "select * from dbo.table_"+test.Text.ToString()+"";
    SqlDataAdapter dt = new SqlDataAdapter(strSQL, con);

    DataSet ds = new DataSet();
    dt.Fill(ds, "" + test.Text.ToString() + "");
    ds.WriteXml(Server.MapPath("temp.xml"));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T16:05:10.670

这可能是一个开始。

```
static void SaveToMDB(DataSet ds, string strMDBFile)
{
    OleDbConnection cAccess = new OleDbConnection(
        "Provider=Microsoft.Jet.OLEDB.4.0;Data source=" + strMDBFile);
    cAccess.Open();

    foreach (DataTable oTable in ds.Tables)
    {
        OleDbCommand oCommand = new OleDbCommand(
            "DROP TABLE [" + oTable.TableName + "]", cAccess);
        try
        {
            oCommand.ExecuteNonQuery();
        }
        catch (Exception) { }

        string strCreateColumns = "";
        string strColumnList = "";
        string strQuestionList = "";
        foreach (DataColumn oColumn in oTable.Columns)
        {
            strCreateColumns += "[" + oColumn.ColumnName + "] VarChar(255), ";
            strColumnList += "[" + oColumn.ColumnName + "],";
            strQuestionList += "?,";
        }
        strCreateColumns = strCreateColumns.Remove(strCreateColumns.Length - 2);
        strColumnList = strColumnList.Remove(strColumnList.Length - 1);
        strQuestionList = strQuestionList.Remove(strQuestionList.Length - 1);

        oCommand = new OleDbCommand("CREATE TABLE [" + oTable.TableName
            + "] (" + strCreateColumns + ")", cAccess);
        oCommand.ExecuteNonQuery();

        OleDbDataAdapter da = new OleDbDataAdapter(
            "SELECT * FROM [" + oTable.TableName + "]", cAccess);
        da.MissingSchemaAction = MissingSchemaAction.Add;
        da.FillLoadOption = LoadOption.OverwriteChanges;

        da.InsertCommand = new OleDbCommand(
            "INSERT INTO [" + oTable.TableName + "] (" + strColumnList
            + ") VALUES (" + strQuestionList + ")", cAccess);
        foreach (DataColumn oColumn in oTable.Columns)
        {
            da.InsertCommand.Parameters.Add(
                oColumn.ColumnName,
                OleDbType.VarChar,
                255,
                oColumn.ColumnName
                );
        }

        foreach (DataRow oRow in oTable.Rows)
            oRow.SetAdded();
        da.Update(oTable);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T23:09:45.263

此数据仅适用于 ID 和名称，使用系统：使用 System；使用 System.Collections.Generic；使用 System.Linq；使用 System.Web；使用 System.Web.UI；使用 System.Web.UI.WebControls；使用 System.Data.Sql；使用 System.Data.SqlClient；使用 System.Configuration；使用 System.Data；使用 System.IO；使用 System.Xml.Linq；

//将SelectiveDatabaseBackup.xml导入test9表

```
 string connectionString = ConfigurationManager.ConnectionStrings["ApplicationServices3"].ConnectionString;
        SqlConnection sqlConnection1 = new SqlConnection(connectionString);
        SqlCommand cmd = new SqlCommand();
        cmd.CommandType = CommandType.Text;

        DataSet ds = new DataSet();

        ds.ReadXml(XDocument.Load("c:/d/SelectiveDatabaseBackup.xml").CreateReader());

        foreach (DataTable table in ds.Tables)
        {

            //Create table

            foreach (DataRow row in table.Rows)
            {

                string name = row[1].ToString();
                string id = row[0].ToString();
                cmd.CommandText = "INSERT  test9  VALUES ('"+ id +"','"+ name + "')";
                cmd.Connection = sqlConnection1;
                sqlConnection1.Open();
                cmd.ExecuteNonQuery();
                sqlConnection1.Close();

            }
        }

        //-------------------------- 
```

# objective-c - Objective c 类扩展标头 - xcode 中的新功能

> ID：13164225
> 
> 赞同：1
> 
> 时间：2012-10-31T18:16:44.197
> 
> 标签：objective-c, ios, class, exception, objc-category

我试图使用 Xcode 中新的目标 c 类扩展标头（仅 .h）模板。我不知道该怎么做。好吧，我做了文件-> 新文件-> 目标 c 类扩展标头，并给它起了一个名字“UICodeButton”，它继承自 UIButton。现在在那个 .h 文件中我写了 @property (read write) NSInteger * cID; 就在执行的下面。所以像这样：

```
#import <UIKit/UIKit.h>

@interface UIButton ()
@property (readwrite) NSInteger * codeID;
@property (readwrite) NSInteger * pID;
@property (readwrite) NSString * cDesc;
@property (readwrite) NSString *pDesc;
@end

@implementation UIButton

@synthesize codeID;
@synthesize pID;
@synthesize cDesc;
@synthesize pDesc;
@end 
```

我在 viewcontroller 类中使用它。所以我有（ViewCP.h 和 ViewCP.m）文件。在 .m 文件中，我正在导入 #import "UIButton_UICodeButton.h" 在此文件中，我在视图中写入确实加载了以下内容

```
- (void)viewDidLoad
{
NSInteger tt = (NSInteger) S_B_T;
NSLog(@" the value is %d",tt);
 self.btnJobType.pID = &(tt);
} 
```

输出：值为555

我在定义中将 S_B_T 设置为 555。当它碰到 self.btnJobType.pID= &(tt); 它抛出一个错误 ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：'-[UIRoundedRectButton setPID:]：无法识别的选择器已发送到实例。所以我没有用它写正确的东西。我应该在哪里写 pID 的设置方法？我认为合成 pID 可以解决问题。但显然不是。那么我该如何进行呢？我搜索了“目标 c 类扩展”的示例。但找不到任何示例。如果需要更多信息，请告诉我。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T18:29:42.923

禁止`@interface SOMEClass ()`您在未实现的类上创建类延续（例如 ）。因此，您不能将字段/属性添加到框架类。当然，您可以使用类别来添加类方法或实例方法。

相反，您将创建一个子类并在那里添加您的属性/变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-04T08:00:18.510

您还可以在另一个用例中的现有类上编写类别。对于某些类，禁止创建子类。类别（如`@interface SOMEClass (MyCategory)`）可以工作，但需要非常小心地实现，因为您不应该更改继承的行为，只需添加即可。

# javascript - KineticJS .toImage() 从区域/组创建图像的正确方法

> ID：13164226
> 
> 赞同：1
> 
> 时间：2012-10-31T18:16:45.007
> 
> 标签：javascript, canvas, kineticjs

在 KineticJS 中使用 .toImage() 方法时，我似乎总是得到一个比实际需要大得多的图像，而我只需要占据数据图像的左上角。我的舞台根据窗口大小和预定义的初始大小进行缩放（在窗口调整大小时，调用调整大小的舞台函数来设置容器的比例和大小）。当我使用 toImage() 来弥补这一点时，我应该设置某种裁剪吗？看图，整体图好像是需要的大小的两倍左右，我需要的那块大概是我需要的大小的一半，当时比例尺在0.5左右（舞台大概是一半大小，因为我使用 Chrome 并在底部打开开发人员栏以进行调试）。

这是我现在使用的：

```
desc.toImage({
    width: sideW / cvsObj.scale,
    height: sideH / cvsObj.scale,
    callback: function(img) {
        desc.hide();
        sideImg.transitionTo({x : sideW / 2, width : 0, duration : 0.25, callback : function() {
            // add image to emulate content
            var params = {name : 'descimg', width : sideW, height : sideH, image : img, x : sideW / 2, y : 0};
            var image = new Kinetic.Image(params);
            side.add(image);
            image.setWidth(1);
            sideImg.hide();
            image.transitionTo({x : 0, width : sideW, duration : 0.25, callback : function() {
                side.add(desc);
                desc.show();
                image.hide();
                cvsObj.page.draw();
            }});
        }});
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:28:57.457

我在两个半月前发布了这个问题，直到今天才收到回复。我一直在了解 KineticJS 的最新信息——甚至添加了我自己的错误报告和代码建议。然而，最近我重新审视了这段特定的代码，并提出了一些更好的东西——我得到的图像现在被正确裁剪，可以按原样插入到我的画布层中。这是代码：

```
// grp = kinetic group, iw = image width, ih = image height, rimg = returned image array for a deferred function, cvsobj.scale is a global stage scale variable (i scale the stage to fit the window)
getImage : function(grp, iw, ih, rimg) {
    var dfr = $.Deferred();
    var gp = grp.getAbsolutePosition();
    grp.toImage({
        width: iw * cvsObj.scale,
        height: ih * cvsObj.scale,
        x : gp.x,
        y : gp.y,
        callback: function(img) {
            rimg.push(img);
            dfr.resolve(rimg);
        }
    });
    return dfr.promise();
} 
```

这是一个扩展的原型功能 - 用于将整个图层或图层的一部分转换为专门用于在动画序列中操作的图像的子部分功能的一部分。希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T16:51:51.670

随着时间的推移，KineticJs 得到了改进，现在功能以“更好”的方式工作。尝试新的 KineticJS 4.3：

```
 http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.3.0.min.js 
```

# java - Java库特征值浮点数

> ID：13164228
> 
> 赞同：-3
> 
> 时间：2012-10-31T18:16:46.943
> 
> 标签：java, android, shared-libraries, eigenvalue, jama

嗨，我有 Jama 图书馆，但这个图书馆只适用于双数字..而且速度很慢。对于Android应用程序..最后我不需要如此高精度的eig decomp ..所以是否有一些带有浮点数的JAva libaray ......在语法上与jama相似？因为...我不想重新编写我的 440 行代码，谢谢。伊格。转置，逆等基本线性代数运算..

或存在相同的 java 库特征值。用线程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:22:51.503

我知道一个名为[*la4j*](http://la4j.org)的库，您可能有兴趣研究它。我应该提一下，一般来说，如果您打算进行许多矩阵操作/计算（我自己已经尝试过并且遇到了死胡同），我认为 Java 不是一个好的选择，您最好还是研究一下 Python ( [NumPy](http://numpy.scipy.org/) ) 或 C++ ( [Armadillo](http://arma.sourceforge.net/) ) 用于此类项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T18:20:26.153

或者你正在寻找这样的东西？

```
 import java.util.Arrays;

public class Matrix {

protected int rows;

protected int cols;

double[][] values;

public Matrix(int rows, int cols) {
    this.rows = rows;
    this.cols = cols;

    values = new double[rows][cols];

    for (int i = 0; i < rows; i++)
        for (int j = 0; j < cols; j++)
            values[i][j] = 0;

}

public Matrix(int[][] M) {
    this.rows = M.length;
    this.cols = M[0].length;

    values = new double[rows][cols];

    for (int i = 0; i < rows; i++)
        for (int j = 0; j < cols; j++)
            values[i][j] = M[i][j];
}

public Matrix(double[][] M) {
    this.rows = M.length;
    this.cols = M[0].length;

    values = new double[rows][cols];

    for (int i = 0; i < rows; i++)
        for (int j = 0; j < cols; j++)
            values[i][j] = M[i][j];
}

public void setToEye() {
    for (int i = 0; i < rows; i++)
        for (int j = 0; j < cols; j++)
            values[i][j] = (i == j) ? 1 : 0;

}

public static int[] matrixSize(Matrix M) {
    int[] size = new int[2];
    size[0] = M.rows;
    size[1] = M.cols;
    return size;
}

public static double vectMul(double[] A, double[] B) {
    double suma = 0;
    for (int i = 0; i < A.length; i++)
        suma += A[i] * B[i];

    return suma;
}

public static Matrix matrixTranspose(Matrix M) {
    int[] size = matrixSize(M);
    double[][] Mt = new double[size[0]][size[1]];

    for (int i = 0; i < size[0]; i++)
        for (int j = 0; j < size[1]; j++)
            Mt[i][j] = M.getValue(j, i);

    return new Matrix(Mt);
}

public static Matrix matrixMul(Matrix A, Matrix B) {
    int m1 = matrixSize(A)[0];
    int n1 = matrixSize(A)[1];
    int m2 = matrixSize(B)[0];
    int n2 = matrixSize(B)[1];
    double[][] rez;

    if (n1 != m2) {
        System.err.println("Inner matrix dimensions must agree!");
        return null;
    }

    rez = new double[m1][n2];
    for (int i = 0; i < m1; i++)
        for (int j = 0; j < n2; j++)
            rez[i][j] = vectMul(A.getRow(i), B.getColumn(j));

    Matrix r = new Matrix(rez);
    return r;
}

public static Matrix matrixMulWithMod(Matrix A, Matrix B, double mod) {
    int m1 = matrixSize(A)[0];
    int n1 = matrixSize(A)[1];
    int m2 = matrixSize(B)[0];
    int n2 = matrixSize(B)[1];
    double[][] rez;

    if (n1 != m2) {
        System.err.println("Inner matrix dimensions must agree!");
        return null;
    }

    rez = new double[m1][n2];
    for (int i = 0; i < m1; i++)
        for (int j = 0; j < n2; j++)
            rez[i][j] = vectMul(A.getRow(i), B.getColumn(j)) % mod;

    Matrix r = new Matrix(rez);
    return r;
}

public String toString() {
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < this.rows; i++) {
        sb.append(Arrays.toString(values[i]));
        sb.append('\n');
    }

    String str = sb.toString();
    return str;
}

public double[][] getValues() {
    return values;
}

public void setValues(double[][] values) {
    this.values = values;
}

public void setValues(int[][] values) {
    for (int i = 0; i < rows; i++)
        for (int j = 0; j < cols; j++)
            this.values[i][j] = (double) values[i][j];
}

public double getValue(int row, int col) {
    return values[row][col];
}

public void setValue(int row, int col, double value) {
    values[row][col] = value;
}

public double[] getRow(int row) {
    double[] temp = new double[cols];
    for (int i = 0; i < temp.length; i++)
        temp[i] = values[row][i];
    return temp;

}

public double[] getColumn(int col) {
    double[] temp = new double[rows];
    for (int i = 0; i < temp.length; i++)
        temp[i] = values[i][col];
    return temp;
}

public double[] toDoubleArray() {
    double[] temp = new double[rows * cols];
    for (int i = 0; i < rows; i++)
        for (int j = 0; j < cols; j++)
            temp[i * (rows + 1) + j] = values[i][j];
    return temp;
}

public int[] toIntArray() {
    int[] temp = new int[rows * cols];
    for (int i = 0; i < rows; i++)
        for (int j = 0; j < cols; j++)
            temp[i * (rows + 1) + j] = (int) values[i][j];
    return temp;
}

public int getRowCount() {
    return this.rows;
}

public int getColumnsCount() {
    return this.cols;
}

public static double getMatrixDet(Matrix M) {
    int m = M.getRowCount();
    int n = M.getColumnsCount();

    double D = 0;

    if (m != n) {
        System.err.println("Matrix must be square!");
        System.exit(0);
    }

    if (n > 1) {
        Matrix I = new Matrix(m - 1, n - 1);

        for (int i = 1; i < m; i++)
            for (int j = 1; j < n; j++)
                I.setValue(i - 1, j - 1, M.getValue(i, j));

        D = M.getValue(0, 0) * getMatrixDet(I);
    } else
        D = M.getValue(0, 0);

    // za niz , kopira iz niza a elemente 0:i-1 i+1:n sredi za matrcu 
    Matrix I = new Matrix(m - 1, n - 1);
    for (int i = 1; i < n; i++) {
        I = M.withoutIthRowAndJthCol(i, 0);
        D = D + Math.pow((-1), i) * M.getValue(i, 0) * getMatrixDet(I);
    }
    return D;

}

public Matrix transpose() {
    Matrix temp = new Matrix(this.values);

    for (int i = 0; i < this.rows; i++)
        for (int j = 0; j < this.cols; j++)
            this.values[i][j] = temp.getValue(j, i);

    return this;
}

private Matrix withoutIthRowAndJthCol(int row, int col) {
    Matrix temp = new Matrix(this.rows - 1, this.cols - 1);
    int k = 0, l = 0;
    for (int i = 0; i < this.getRowCount(); i++) {
        if (i == row)
            continue;
        for (int j = 0; j < this.getColumnsCount(); j++) {
            if (j == col)
                continue;

            temp.setValue(k, l, this.values[i][j]);
            l++;
        }
        l %= 2;
        k++;
    }
    return temp;
}

public static Matrix getMatrixAdj(Matrix M) {
    int m = M.getRowCount();
    int n = M.getColumnsCount();

    Matrix A = new Matrix(m, n);

    if (m != n) {
        System.err.println("Matrix must be square!");
        System.exit(0);
    }

    for (int i = 0; i < m; i++)
        for (int j = 0; j < n; j++) {
            A.setValue(i, j, Math.pow((-1), i + j)
                    * getMatrixDet(M.withoutIthRowAndJthCol(i, j)));
        }
    A.transpose();
    return A;
}

public static Matrix matrixDiv(Matrix M, double n) {
    Matrix temp = M;

    for (int i = 0; i < M.getRowCount(); i++)
        for (int j = 0; j < M.getColumnsCount(); j++)
            temp.setValue(i, j, (M.getValue(i, j) / n));

    return temp;
}

public static Matrix getMatrixInv(Matrix M) {
    Matrix I = new Matrix(M.getRowCount(), M.getColumnsCount());

    if (M.getRowCount() != M.getColumnsCount()) {
        System.err.println("Matrix must be square!");
        System.exit(0);
    }
    if (getMatrixDet(M) == 0) {
        System.err.println("Matrix is singular!");
        System.exit(0);
    }
    I = matrixDiv(getMatrixAdj(M), getMatrixDet(M));
    return I;
}
} 
```

如果这是你想要的，不客气。

# android - Android 手机上 Ubuntu 上的 vim R 插件安装问题

> ID：13164229
> 
> 赞同：1
> 
> 时间：2012-10-31T18:16:47.683
> 
> 标签：android, vim, ubuntu

vim-R-plugin 上有另一个线程，但由于它有点旧，我开始了这个新线程。我的情况也有点不同，因为我在移动设备上尝试这个，三星振动。

我按照[本网站](http://www.lepem.ufc.br/jaa/r-plugin.html#r-plugin-installation)中的说明进行操作：

我在安装一个名为*vimcom*的 R 包时遇到了困难。无论我如何尝试，它总是会出现错误：

```
.onLoad failed in loadNamespace()for 'vimcom', details:.......
........................ 
```

Ubuntu 版本特立独行：10.14
R-version 2.11

我能做些什么来解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-18T23:16:25.070

帖子有点旧，但我也遇到了一些问题。我正在使用：

*   Ubuntu 14.04.02 LTS
*   维姆 7.4.273
*   Vim-R-Plugin-1.2-3
*   Vimcom-1.2-3

不幸的是，在升级所有二进制文件后，默认的 R 版本为 3.2.0

```
sudo apt-get update; 
sudo apt-get upgrade;

R --version 
3.2.0 
```

所以在删除 R 包后使用 Ubuntu

```
sudo apt-get remove --auto-remove r-recommended r-base r-base-core 
```

apt-cache 搜索工具来查找可用的旧包：

```
sudo apt-cache showpkg r-base-core 
```

其中有 3.1.3-1trusty0 的选项。因此，可以通过以下方式安装上一代：

```
sudo apt-get install r-base-core=3.1.3-1trusty0
sudo apt-get install r-recommend=3.1.3-1trusty0 
sudo apt-get install r-base=3.1.3-1trusty0 
```

因此 vimcom 可以通过标准方法安装，并且一切正常。PS 只是一个注释，我不小心认为删除 r-base 就足够了，但事实并非如此 - 你需要删除 r-base-core 否则你将保持在 3.2.0。希望对某人有所帮助。

# javascript - Raphael 的 `getFont` 方法不起作用（？）

> ID：13164230
> 
> 赞同：4
> 
> 时间：2012-10-31T18:16:47.870
> 
> 标签：javascript, svg, raphael

我在使用*Raphael.js*的`print`方法创建文本时遇到了一些问题。更准确地说，方法所需`getFont`的`print`方法返回一个`undefined`值。[**我在这里**](http://jsfiddle.net/WbL26/)整理了一个非常简单的小提琴，试图找到问题的根源，但到目前为止还没有运气。相同的小提琴代码如下：

```
<div id="canvas" style="width:500px; height:300px; outline: 1px solid #000;"></div>​ 
```

和 JavaScript：

```
var canvas, font, text;

canvas = new Raphael(document.getElementById("canvas", 500, 300));
font = canvas.getFont("Arial");
text = canvas.print(0, 0, "Some text", font, 24).attr({ "fill": "#C00" });​ 
```

画布被创建，甚至路径被绘制（尽管*字体*的值是未定义的），但字体对象返回未定义。我也尝试过使用“Arial”字体。毕竟这两个是标准的，所以我们不是在谈论自定义字体。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-01T08:50:18.583

Raphael 的`print`方法要求您使用 Cufon-font-files。从上的文档`getFont`：

> 通过给定的参数在注册字体中查找字体对象。

并进一步阅读`registerFont`：

> 将给定字体添加到 Raphaël 的已注册字体集。应该用作来自 Cufón 字体文件的内部调用。

有点扭曲......

因此，如果您想/需要使用`print`必须以正确格式转换和提供字体文件的方法，请在**[此处](http://cufon.shoqolate.com/generate/)**阅读有关 cufon 的信息。

如果您想使用系统字体（或*webfonts*），您可以使用**[`Paper.text()`](http://raphaeljs.com/reference.html#Paper.text)**非常容易使用的方法，您可以使用 CSS 等设置文本样式。

# jquery - Twitter Bootstrap - 在选项卡“显示”事件上执行操作

> ID：13164239
> 
> 赞同：15
> 
> 时间：2012-10-31T18:17:39.517
> 
> 标签：jquery, twitter-bootstrap

我需要根据引导 jQuery 选项卡部分中的选定选项卡“重置”一些页面信息。

文档显示了这个事件，这正是我需要的：http: [//twitter.github.com/bootstrap/javascript.html#tabs](http://twitter.github.com/bootstrap/javascript.html#tabs)

```
$('a[data-toggle="tab"]').on('shown', function (e) {
  e.target // activated tab
  e.relatedTarget // previous tab
}) 
```

我需要获取 and 的 'href' 属性`e.Target`，`e.relatedTarget`它唯一地标识这 2 个选项卡和它们链接到的 2 个选项卡内容窗格。

这是我的问题：`e`对象是一些我不期望或不习惯的对象。我不能使用任何 jQuery 方法，例如`e.target.attr('href')`——我以前使用的所有普通 jquery 方法都消失了。我尝试像原始对象属性一样访问它——`e.href`但`https://127.0.0.1/test?action=view#tab-a"`没有`#tab-a`

我可以编写一个解决方法 - 但我显然做错了什么。应该有一种简单的方法可以直接从中获取`#tab-a`-`e.target`但我无法弄清楚。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-31T18:34:26.417

Try `$(e.target).attr('href')` instead.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-13T16:52:37.383

迟到的派对是我的看法：

```
$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {

    e.currentTarget ...

}); 
```

e.currentTarget 是刚刚点击的当前锚点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-03T11:41:52.443

如果有人需要知道当前选择了哪个**选项卡索引，而不需要在 DOM 中手动计算它。**

**用例：**当#hrefs 动态更新并且您可以在选项卡索引上进行中继时。

jQuery 函数[`.index()`](http://api.jquery.com/index/)返回*整数，指示 jQuery 对象中第一个元素相对于其兄弟元素的位置*。

```
var el = jQuery('#some .thing'); // some DOM node that contains tab html structure
var tab_list = el.find('.tabbable').first().find('a[data-toggle="tab"]');
// event namespace ".bs.tab" is important in some versions of Bootstrap 
tab_list.on('shown.bs.tab', function(e){

    // zero based index
    // jQuery function `.index()` returns zero-based DOM "order" index
    tab_index = $(e.target).parent().index();

    // store this index to cookie or somwhere
    // so that you can show that tab again when user comes back to page
    // or makes a page refresh (F5)
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-07T17:12:06.950

这些都应该工作。

1.  `$(e.target).attr('href');`
2.  `e.target.hash;`
3.  `$(this).attr('href');`
4.  `this.hash`

# asp.net-mvc-3 - 在asp.net mvc中下载excel文件

> ID：13164243
> 
> 赞同：1
> 
> 时间：2012-10-31T18:17:49.887
> 
> 标签：asp.net-mvc-3, download, filecontentresult, fileresult

我试图实现的是让用户能够在文件保存对话框的帮助下将网格数据导出到 excel 文件并下载它。

这是我现在的编码方式 -

### 在 Javascript -

```
$.post("/irn/Identifier/Download", { "columnValues": columnValues }); 
```

### 在标识符控制器下载动作 -

```
public FileResult Download(string columnValues)
{
    DTData headlineRows = (DTData)Newtonsoft.Json.JsonConvert.DeserializeObject(columnValues, typeof(DTData));
    var e = new Services.DownloadToExcel();
    return File(e.WriteData(headlineRows), "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "testfile.xlsx");
} 
```

### 在 DownloadToExcel 类中，在 WriteData 函数中我有 -

```
//Here, I'm using the EPPlus library to write the column data to an excel file and then i'm returning the data as a byte array -

//Some code that writes the data
return packages.GetAsByteArray(); 
```

当我运行此代码时，我希望在浏览器中看到一个文件保存对话框，但没有任何反应。C# 或 JavaScript 端没有任何错误。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T11:39:51.780

有点晚了，但我遇到了类似的问题。为了解决这个问题，我在客户端使用 JSON.stringify(columnValues) 将我的数据转换为 json 字符串，然后再将其发送到控制器。

然后而不是使用

```
$.post("/irn/Identifier/Download", { "columnValues": columnValues }); 
```

尝试

```
var columnValuesString = JSON.stringify(columnvalues);
window.location = '/irn/Identifier/Download?columnvalues=" + columnValuesString'; 
```

将 $.post() 更改为 window.location 使其工作。

然后你可以反序列化控制器中的 json 字符串，点击链接后应该会出现打开/保存对话框。

我希望这对其他人有帮助。让我知道，如果需要，我可以发布我的代码。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T19:52:32.643

如果您在 Internet Explorer 中测试该站点，请尝试以下操作：

*   打开 Internet 选项 -> 高级。单击重置。您还可以选择恢复高级设置。

*   打开 Internet 选项 -> 安全。如果区域已被更改，请单击“将所有区域重置为默认级别”。

对这些设置的更改可能会影响 Internet Explorer 是否接受文件下载。

更多信息在这里： [http ://answers.microsoft.com/en-us/ie/forum/ie8-windows_other/ie-8-will-not-let-me-download-any-files-music-pdf/bc59ba24- 866b-4dbf-93f2-85ebb9912c2c](http://answers.microsoft.com/en-us/ie/forum/ie8-windows_other/ie-8-will-not-let-me-download-any-files-music-pdf/bc59ba24-866b-4dbf-93f2-85ebb9912c2c)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-21T10:01:20.777

您应该使用 IFrame 来帮助下载文件。

```
function postToIframe( url,data) {
    var target = "downloadIFrame";
    $('<iframe  name="' + target + '" style="display:none"/>').appendTo('body');
    $('body').append('<form action="' + url + '" method="post" target="' + target + '" id="postToIframe"></form>');
    $.each(data, function (n, v) {
        $('#postToIframe').append('<textarea name="' + n + '">' + v + '</textarea>');
    });
    $('#postToIframe').submit().remove();
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-15T20:29:03.830

我解决了这个问题，但忘了在这里更新 -

这有效 -

### 在我的课堂上——

```
private const string MimeType = "application/vnd.openxmlformats- 
officedocument.spreadsheetml.sheet";

private ExcelPackage package = new ExcelPackage();

private FileContentResult excelFile;

Write data using EPPlus

 ...

 ...

 ...

excelFile = File(package.GetAsByteArray(), MimeType, FileName);

 return excelFile; 
```

# python - Python 和使用 shelve.py 冻结应用程序

> ID：13164245
> 
> 赞同：2
> 
> 时间：2012-10-31T18:17:50.773
> 
> 标签：python, wxpython, cx-freeze, shelve

我正在尝试冻结涉及使用搁置模块的应用程序。为了冻结它，我使用 GUI2EXE python 代码并利用 cx_freeze 部分（如果我删除搁置部分，一切都很好）。

当我去运行我编译的应用程序时，它抱怨

```
File "anydbm.pyc", line 62, in ?
ImportError: no dbm clone found; tried ['dbhash', 'gdbm', 'dbm',
'dumbdbm'] 
```

我四处寻找答案。他们中的大多数人说要将此添加到脚本中：

```
for i in ['dbhash', 'gdbm', 'dbm', 'dumbdbm']:
    try: eval('import '+i)
    except: pass 
```

但是，这对我没有任何作用。如果我包含 dbhash 模块，则会收到与不存在 bsddb 模块相关的错误。我似乎无法解决这个问题。我是否错误地执行了上述操作？我错过了什么吗？

PS，我需要使用 cx_freeze - 其他（py2exe，pyinstaller）不能很好地与我程序的其他部分一起使用。另外，我真的很想使用 shelve——就像我说的，没有它，它可以编译并正常工作。

谢谢！

**编辑**

根据 Mike 的要求，我附上了安装脚本。是的，我尝试包含模块（未显示），但它不起作用。我什至在我的主脚本中包含了 anydbm 和 dbhash。这似乎也不起作用。

另外，如果您知道比搁置更好的方式来存储我的变量/列表/字典/等，我很想知道。我尝试了 ZODB（也没有构建好）。目前，我确实找到了 pdict（使用 PersistentDict），并且在我冻结应用程序时效果很好。但是，我发现搁置更快。如果可能的话，想搁置工作......

我的设置脚本：

```
from cx_Freeze import setup, Executable

includes = []
excludes = ['_gtkagg', '_tkagg', 'bsddb', 'curses', 'email', 'pywin.debugger',
            'pywin.debugger.dbgcon', 'pywin.dialogs', 'tcl',
            'Tkconstants', 'Tkinter']
packages = []
path = []

for i in ['dbhash', 'gdbm', 'dbm', 'dumbdbm']:
    try: 
        eval('import '+i)
    except: 
        pass

GUI2Exe_Target_1 = Executable(
    # what to build
    script = "myscript.py",
    initScript = None,
    base = 'Win32GUI',
    targetDir = r"dist",
    targetName = "myscript.exe",
    compress = True,
    copyDependentFiles = False,
    appendScriptToExe = False,
    appendScriptToLibrary = False,
    icon = None
    )

setup(

    version = "0.1",
    description = "No Description",
    author = "No Author",
    name = "cx_Freeze Sample File",

    options = {"build_exe": {"includes": includes,
                             "excludes": excludes,
                             "packages": packages,
                             "path": path
                             }
               },

    executables = [GUI2Exe_Target_1]
    ) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T13:33:44.010

`eval('import foo')`总是会失败： eval 用于表达式，但 import 是一个语句。您应该避免`except:`使用未指定异常类型的子句——它们隐藏了代码中的真正错误。

尝试这样的事情：

```
for dbmodule in ['dbhash', 'gdbm', 'dbm', 'dumbdbm']:
    try:
        __import__(dbmodule)
    except ImportError:
        pass
    else:
        # If we found the module, ensure it's copied to the build directory.
        packages.append(dbmodule) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T13:29:33.560

您可以使用 pickle 而不是 shelve 来存储您的数据。或者您可以使用 ConfigObj 创建包含大部分信息的文本文件：[http ://www.voidspace.org.uk/python/configobj.html](http://www.voidspace.org.uk/python/configobj.html)

我想你甚至可以使用 SQLite 来存储你的大部分数据。如果您尝试保存 wxPython GUI 的状态，请参阅 PersistentManager：http: [//xoomer.virgilio.it/infinity77/Phoenix/lib.agw.persist.persistencemanager.PersistenceManager.html](http://xoomer.virgilio.it/infinity77/Phoenix/lib.agw.persist.persistencemanager.PersistenceManager.html)

# php - Flex - 从 PHP 中检索和存储变量

> ID：13164258
> 
> 赞同：0
> 
> 时间：2012-10-31T18:19:03.737
> 
> 标签：php, spring, apache-flex, flex4, flex-mobile

**编辑**- 看起来您无法在不通过 XML 的情况下解析来自 PHP 的数据。使用 JSON 将是最好的方法。[来源](http://www.vipercreations.com/tutorials.php?t=28&page=3&c=Adobe%20Flex)

我对 Flex 非常陌生，已经使用了 2.5 天。我的 Flex 应用程序访问计算两个数字的 PHP 脚本。该脚本按原样工作，但我想从 PHP 脚本中检索多个变量，这样我不仅可以得到加法的答案，还可以得到乘法等的答案......

我希望我有一些意义......

**柔性：**

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
        xmlns:s="library://ns.adobe.com/flex/spark"
        title="Adding Numbers">

    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
        <s:HTTPService id="srvCalc" url="http://192.168.0.3/flex/flex-phpexample/calc.php"
                   resultFormat="text"
                   method="POST">

        <s:request xmlns="">
            <number1>{txtNumber1.text}</number1>
            <number2>{txtNumber2.text}</number2>
        </s:request>

    </s:HTTPService>
    </fx:Declarations>

    <fx:Script>
        <![CDATA[
            private function btnCalc_Click(event:MouseEvent):void
            {
                srvCalc.send();
            }
        ]]>
    </fx:Script>

    <s:VGroup width="400" horizontalCenter="0" verticalCenter="0">
        <s:Label id="txtAnswer" text="{srvCalc.lastResult}" />

        <s:Label text="First Number:" />
        <s:TextInput id="txtNumber1"
                     width="100%"/>

        <s:Label text="Second Number:"/>
        <s:TextInput id="txtNumber2"
                     width="100%"/>

        <s:Button id="btnCalc"
                  label="Calculate"
                  click="btnCalc_Click(event)"/>
    </s:VGroup>

</s:View> 
```

**PHP：**

```
<?php
    $number1 = $_POST['number1'];
    $number2 = $_POST['number2'];

    print($number1 + $number2);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:23:07.950

最简单的方法是让 php 返回一个 JSON 编码的块，然后使用[http://flexjson.sourceforge.net/](http://flexjson.sourceforge.net/)在 flex 中对其进行解码。您可以使用其他一些方法，但这是最简单和最结构化的方法。

# android - 以安全的方式从相机捕获全分辨率图像（如果可能，不存储到磁盘）

> ID：13164261
> 
> 赞同：1
> 
> 时间：2012-10-31T18:19:22.130
> 
> 标签：android, security, android-camera, android-camera-intent

我正在开发一个应用程序，它允许用户捕获安全文档的图像并将这些图像上传到服务器（我正在尝试做的一个很好的例子是银行应用程序，它允许用户为支票拍照。）

出于安全原因，我不希望图像在任何时候都物理存储在磁盘上，如果可能的话。

当我尝试使用 MediaStore.ACTION_IMAGE_CAPTURE 意图执行此操作时，它可以工作......但分辨率非常低。我认为这是为了防止过度使用 RAM。我四处寻找解决方案，但我发现的所有解决方案都涉及将图像存储在 SD 卡或内部 NAND 存储上。我不想那样做。

如果无法避免存储照片，有没有办法将图像存储到我的应用程序才能访问的位置？然后我会在上传后删除文件。如果我必须这样做，有没有办法在存储照片时对其进行加密？

这是我当前代码的简化，以防万一有帮助：

```
 Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
    startActivityForResult(intent,requestCode); 
```

和

```
protected void onActivityResult(int requestCode, int resultcode, Intent data)
{
    if (resultcode == RESULT_OK)
    {
        Bitmap bmp = getBitmapFromIntent(data);
    }
}
private Bitmap getBitmapFromIntent(Intent intent)
{
    Bundle extras = intent.getExtras();
    return (Bitmap) extras.get("data");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:37:59.380

您可以将文件直接保存在设备的内部存储中。默认情况下，保存到内部存储的文件对您的应用程序是私有的，其他应用程序无法访问它们（用户也不能）。当用户卸载您的应用程序时，这些文件将被删除。

```
String file_path = "/data/data/com.packagename/cache/";
            File dir = new File(file_path);
            if (!dir.exists())
                dir.mkdirs();
            File file = new File(dir, "1" + ".jpg");

            try {
                FileOutputStream fos = new FileOutputStream(file);
                fos.write(data); // data in byte format
                fos.close();
            } catch (FileNotFoundException e) {
                Log.e("Not Found", "File not found: " + e.getMessage());
            } catch (IOException e) {
                Log.e("Not Found", "Error accessing file: " + e.getMessage());
        } 
```

# junit - 如何在 Mockito 的 void 方法中忽略几个 void 方法调用

> ID：13164262
> 
> 赞同：23
> 
> 时间：2012-10-31T18:19:22.317
> 
> 标签：junit, mockito

我正在测试一个 void 方法，它碰巧在一个类中调用了其他几个 void 方法（所有这些方法都在同一个类中）。该方法是沿着这些思路...

```
public void methodToTest() {
   methodA();
   methodB();
}

void methodA() {
   methodA1();
   methodA2();
   methodA3();
} 
```

我想做的是让`methodA()`上面什么都不做。也就是说，我想`methodA()`基本上是这样的：

```
void methodA() { } 
```

我都试过了，`doThrow()`但无济于事。就好像这两个都被完全忽略了。`doAnswer()``methodA()`

我尝试过的一个例子......

```
doThrow(new RuntimeException()).when(mockedClass).methodA(); 
```

有没有办法只使用 Mockito 来做到这一点？我无权更改正在修改的课程。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-31T18:57:08.743

如果您希望 methodB 仍然执行，而 methodA 什么都不做。这将做到这一点：

```
TestClass spy = spy(new TestClass());
doNothing().when(spy).methodA();
spy.methodToTest(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-07-23T09:09:58.873

```
 @Mock
 ApplicationClass applicationClass; 

 Mockito.doNothing().when(applicationClass).myMethod(Matchers.any(Object.class)); 
```

# javascript - 为什么我的线程自动缓冲器不工作？

> ID：13164264
> 
> 赞同：-1
> 
> 时间：2012-10-31T18:19:39.227
> 
> 标签：javascript

它所做的是等到页面加载，找到快速回复按钮，单击它，找到文本区域，将其值更改为“bump”，单击快速回复按钮顺便说一句，问题不在 getElementsByAttribute 函数中，我复制了它来自我的另一个脚本，它在其中工作

```
window.onload=function(){

var t1=setTimeout(function(){getElementsByAttribute("src", "http://assets.bodybuilding.com/forum/bodybuilding/buttons/reply.gif")[0].click();},3000);

var t2=setTimeout(function(){getElementsByAttribute("class", "cke_source cke_enable_context_menu")[0].value = "bump";},3000);

var t3=setTimeout(function(){getElementsByAttribute("value", "Post Quick Reply")[0].click();},3000);

}

document.getElementsByAttribute = function( attrib, value, context_node, tag ) {
    var nodes = [];
    if ( context_node == null )
        context_node = this;
    if ( tag == null ) 
        tag = '*';
    var elems = context_node.getElementsByTagName(tag);

    for ( var i = 0; i < elems.length; i += 1 ) {
        if ( value ) {
            if ( elems[i].hasAttribute(attrib) && elems[i].getAttribute(attrib) == value )
                nodes.push(elems[i]);
        } else {
            if ( elems[i].hasAttribute(attrib) )
                nodes.push(elems[i]);
        }
    }
    return nodes;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:30:54.660

它们具有相同的超时值，因此它们将按照它们列出的顺序触发..您尝试单击回复，然后单击快速回复..交换顺序，它可能会起作用。

# telerik - 加载项管理器忽略我的取消选中/取消选择

> ID：13164269
> 
> 赞同：0
> 
> 时间：2012-10-31T18:19:50.813
> 
> 标签：telerik, visual-studio-2012, visual-studio-addins, justcode

每次启动 Visual Studio 时，我都会收到来自 JustCode 和 JustTrace 的唠叨屏幕。即使在转到工具 | 之后 加载项管理器并取消选择它们（列表中仅有的两个项目），仍然显示 nag 屏幕！我回到工具 | 加载项管理器并看到它们再次被选中 - 甚至 Startup 复选框，JustCode 的启动复选框甚至不允许我取消选择它。

我不知道这是 Visual Studio 的问题还是 Telerik 的问题，但它很烦人——我怎样才能一劳永逸地赶走这些不法之徒？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T09:20:04.457

对于 JustTrace，您没有停止检查更新的直接选项。但是您可以通过在自动更新对话框中取消选中“检查更新时包含内部构建”复选框并按推迟来减少它的出现。这将使 JustTrace 仅提示少数主要版本和服务包。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-02T09:02:53.743

您会更具体一些，并指定您认为哪些对话框很烦人吗？可能截图会有所帮助。到目前为止，我认为更新对话框会在开始时弹出，如果我是对的，您可以禁用它们。对于 JustCode，您将在 JustCode 菜单 > 选项 > 常规 > 更新中找到一个选项。去那里并禁用自动检查更新设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T18:29:18.053

做了一些挖掘并为您找到了这个：[http ://devcomponents.com/blog/?p=653](http://devcomponents.com/blog/?p=653)

当然，它不是同一个组件，但对于插件，行为通常是通用的。

右键单击 VS 图标并选择“以管理员身份运行”，以管理员身份运行 VS。这将允许取消选中复选框并保存您的首选项。

# php - 可定制的夏令时规则

> ID：13164280
> 
> 赞同：2
> 
> 时间：2012-10-31T18:20:29.290
> 
> 标签：php, coding-style, timezone, dst

**任务是什么？**
根据项目规范，我需要计算特定时区偏移的 DST 规则。规则**不能通过**标准工具应用，`date_default_timezone_set()`因为我们不能依赖软件配置，如果某些 DST 规则将被更改，也无法更新它。

**是）我有的？**
在 DST 切换日期在上周且上周的切换日在下个月的情况下，我需要减少上周的数字。现在我只有一个**丑陋**的解决方案：

```
 $week = 5;
 if (
     (1 + 7 * ($week - 1)) 
     + $start['day_of_week'] 
     - date('w', mktime(0, 0, 0, $start['month'], 1, date('Y', $start['timestamp']))) 
     > 
     date('t', $start['month'])) 
 {
     $week--;
 } 
```

**我在找什么？**
我正在寻找最简单的解决方案的任何想法，或链接=）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T08:17:07.640

您可以使用系统范围的时区数据库并对其进行自定义更新。

[IANA 的官方 TZ 数据库存储库](http://www.iana.org/time-zones)

它可以作为源文件提供，您可以在需要时对其进行修改并重新编译成可供时间函数使用的二进制文件，`glibc`因此所有使用这些时间函数的程序也可以使用。如果您的发行版执行此类更新，您可能需要找到一种方法来禁用对该数据库的任何自动更新，否则您将丢失自定义更改。

我不确定 PHP 是否真的遵循系统范围的 TZ 数据库。PECL`timezonedb`包似乎表明它是 IANA 数据库的单独重新编译版本，因此它可能*不会*观察到系统范围数据库的变化。

如果 PHP 忽略系统范围数据库中的更改，您可以通过调用任何使用`glibc`时区感知时间函数并支持返回时区偏移量的外部程序来检索时区偏移量，例如：

```
putenv('TZ=America/New_York');
$offset = exec('date +%z'); 
```

`$offset`将是 format `±HHMM`，因此需要进行一些额外的解析。

您还可以找到与当前时间不同的特定时间戳的正确偏移量：

```
$unix_timestamp = 1350757594;
$offset = exec('date +%z --date=@'.$unix_timestamp); 
```

当然，`escapeshellarg`如果时间戳来自不受信任的来源，则需要进行适当的过滤。

**更新：这是单个 DST 规则集的解决方案；不使用外部资源**

```
function calculate_offset($ts) {
    static $standard_offset = 2;    // = +2:00
    static $dst_offset      = 3;    // = +3:00
    static $dst_start       = 'last Sunday of March %d 1:00';
    static $dst_end         = 'last Sunday of October %d 1:00';

    date_default_timezone_set('UTC');

    $y = idate('Y', $ts);
    $start = strtotime(sprintf($dst_start, $y));
    $end = strtotime(sprintf($dst_end, $y));

    if ($start < $end) {
        // Northern hemisphere, DST starts earlier in the year than it ends
        $offset = ($ts >= $start && $ts < $end)? $dst_offset: $standard_offset;
    } else {
        // Southern hemisphere, DST ends earlier in the year than it starts
        $offset = ($ts >= $end && $ts < $start)? $standard_offset: $dst_offset;
    }
    $utc_time = strftime('%Y/%m/%d %H:%M:%S', $ts);
    $local_time = strftime('%Y/%m/%d %H:%M:%S', $ts + $offset * 60 * 60);
    printf("TS: %d; Offset: +%02d:00; UTC: %s; Local: %s\n", $ts, $offset, $utc_time, $local_time);
} 
```

示例代码使用标准欧洲 DST 规则和东欧时间偏移。您将需要找到一种方法来以以下格式表示您的 DST 开始和结束规则[`strtotime`](http://php.net/manual/en/function.strtotime.php)：[相对格式](http://php.net/manual/en/datetime.formats.relative.php)。您的 DST 开始/结束规则中的A`%d`将被您的时间戳所在的年份所取代，因此每月工作日规则将找到特定年份的正确日期。所有计算均以 UTC 时间完成，因此您的规则应参考 UTC 中的 DST 开始/结束时间。

# ios - iOS 中主/详细视图中的子视图管理（使用 ARC）

> ID：13164281
> 
> 赞同：0
> 
> 时间：2012-10-31T18:20:45.777
> 
> 标签：ios, uiview, master-detail

我的应用程序有一个主从控制器。主控制器是一个 UITabBarController，每个选项卡都是一个包含不同类型数据的 UITableViewController。

我计划在主细节视图上有一个主标题/图像，但随后需要向主细节视图添加不同的子视图，以根据我使用的选项卡详细说明特定信息。

我目前正在我的

`- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath`

像这样的功能：

```
UIViewController *subview = [[UIViewController alloc] initWithNibName:@"ItemNotFoundViewController" bundle:nil];
subview.view.frame = CGRectMake(20, 160, subview.view.frame.size.width, subview.view.frame.size.height);  
[self.detailViewController.view addSubview:subview.view]; 
```

但是，我认为这是一种糟糕的做事方式 - 每次有人单击表格单元格时，都会在先前添加的子视图堆栈顶部抛出另一个子视图，从而产生内存问题。

我想知道的是，ARC 会为我解决这个问题吗？我的方法可以通过吗？即使它是可以通过的，有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:56:11.720

首先，不。ARC 不会为您处理这些问题。这样做不是目的，即使它是，它怎么知道你不再想要以前添加的子视图？您必须自己删除这些子视图，**然后**ARC 将负责解除分配它们（如果没有其他对它们的引用）。

无论如何，这不是您应该使用`UISplitViewController`（主从视图控制器）的方式。正如您注意到的，拆分视图控制器处理其他两个视图控制器。master- 和 detailViewController。在大多数情况下，主视图控制器在应用程序运行时不会发生变化（它的内容会发生变化，但通常由容器视图控制器处理，就像`UINavigationController`分配为 masterViewController 一样），但细节视图控制器会。

与其将子视图添加到现有的 detailViewController 中，不如将其**替换**为新的。因此，您应该为要在详细信息部分中显示的所有视图控制器创建单独的 XIB（显然您已经完成了）。并将您的代码修改为

```
self.detailViewController = newDetailViewController; //newDetailViewController would be the vc you called subview in your code 
```

代替

```
[self.detailViewController.view addSubview:subview.view]; 
```

编辑：请注意，这假定您的`detailViewController`属性在设置它的值时会做“正确的事情”。默认情况下，`UISplitViewController`唯一有一个名为的属性`viewControllers`，`NSArray`其中第一个对象是 masterVC，第二个是 detailVC。

查看[MultipleDetailViews](http://developer.apple.com/library/ios/#samplecode/MultipleDetailViews/Introduction/Intro.html#//apple_ref/doc/uid/DTS40009775)以了解如何管理它的示例。

由于您希望在所有详细视图控制器中都有一个标题视图，因此您有多种选择来实现它（这可能适用于您的情况，也可能不适用，具体取决于您的设计）：

*   将标题视图添加到每个详细信息 vc 的 XIB
*   而不是为所有detailVCs创建许多XIB，而是创建一个新的自定义`UIViewController`子类，根据你给它的一些参数修改它的内容，即用户点击了哪个tableViewCell
*   创建一个自定义容器视图控制器，该控制器管理两个子视图控制器，一个用于标题，一个用于其上方的内容。

更多关于`UISplitViewController`和自定义容器视图控制器的信息，请参考：

[查看控制器基础知识](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/AboutViewControllers/AboutViewControllers.html#//apple_ref/doc/uid/TP40007457-CH112-SW10)

[创建自定义容器视图控制器](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T18:39:23.717

不，ARC 不会为您处理这个，因为 detailViewController.view 将保留对其子视图的引用。如果不更多地了解您对这些视图所做的工作，很难说哪种方法最好。最好只显示新的视图控制器——如果你没有指向它的属性，它将在它被解除后被释放。

# macos - 如何消除主题演讲以幻灯片模式占据整个屏幕

> ID：13164290
> 
> 赞同：3
> 
> 时间：2012-10-31T18:21:24.670
> 
> 标签：macos, slideshow, fullscreen, keynote

我们正在构建一个桌面应用程序，它必须以幻灯片模式自动激活桌面上的主题应用程序。

问题是幻灯片正在占据整个屏幕。

有没有办法在幻灯片模式下控制主题窗口的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T06:09:12.230

可以试试SIMBL包，钩住全屏相关的窗口功能。您可以使用类转储来了解 Keynote 应用程序中发生了什么。但是，您会遇到另一个问题 - 您的窗口仍然没有菜单，您将被迫处理调整大小事件等。

# objective-c - 暂时禁用实例处理消息 - ios

> ID：13164297
> 
> 赞同：1
> 
> 时间：2012-10-31T18:21:36.607
> 
> 标签：objective-c, ios, methods, messages

我有一个继承`UICollectionViewCell`. 在这个类中，我实现了`touchesBegan`和`touchesMoved`选择器。这使我能够实现单元格的拖动。

后来我决定在另一个托管另一个 CollectionView 的视图中使用相同的单元格实现。单元格的行为完全相同，但应该禁用触摸处理，因为我希望允许在`didSelectItemAtIndexPath`用户点击此视图中的单元格时调用 CollectionView 委托（而不是像上一个视图中那样自定义拖动） .

在`touchesBegan/Moved`函数内部设置 if 不是一个选项，因为存在这些方法的事实“窃取”了消息，并且它们不再触发`UICollectionView`....

我试图将消息转发到视图，但它是一团糟......

我正在寻找的是以某种方式动态设置我的单元格实例不对“ `touchesBegan/Moved`”消息做出反应

我看到了[这个](https://stackoverflow.com/questions/1315169/how-do-i-remove-instance-methods-at-runtime-in-objective-c-2-0)，但它不完全一样......

# delphi - Delphi XE2 TZipFile：替换zip存档中的文件

> ID：13164299
> 
> 赞同：8
> 
> 时间：2012-10-31T18:21:43.300
> 
> 标签：delphi, zip, delphi-xe2, delphi-xe3

我想用 Delphi XE2/XE3 标准 System.Zip 单元替换 zip 存档中的文件（= 删除旧文件并添加新文件）。但是没有替换/删除方法。有没有人知道如何在不需要提取所有文件并将它们添加到新存档的情况下实现它？

我有这段代码，但如果它已经存在，它会再次添加“document.txt”：

```
var
  ZipFile: TZipFile;
  SS: TStringStream;
const
  ZipDocument = 'E:\document.zip';
begin
  ZipFile := TZipFile.Create; //Zipfile: TZipFile
  SS := TStringStream.Create('hello');
  try
    if FileExists(ZipDocument) then
      ZipFile.Open(ZipDocument, zmReadWrite)
    else
      ZipFile.Open(ZipDocument, zmWrite);

    ZipFile.Add(SS, 'document.txt');

    ZipFile.Close;
  finally
    SS.Free;
    ZipFile.Free;
  end;
end; 
```

注意：我以前使用过 TPAbbrevia（完成了这项工作），但我现在想使用 Delphi 的 Zip 单元。所以请不要回答“使用另一个库”之类的问题。谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T19:07:51.887

我推荐 Abbrevia，因为我有偏见 :)，你已经知道了，而且它不需要任何 hack。除此之外，这是你的黑客：

```
type
  TZipFileHelper = class helper for TZipFile
    procedure Delete(FileName: string);
  end;

{ TZipFileHelper }

procedure TZipFileHelper.Delete(FileName: string);
var
  i, j: Integer;
  StartOffset, EndOffset, Size: UInt32;
  Header: TZipHeader;
  Buf: TBytes;
begin
  i := IndexOf(FileName);
  if i <> -1 then begin
    // Find extents for existing file in the file stream
    StartOffset := Self.FFiles[i].LocalHeaderOffset;
    EndOffset := Self.FEndFileData;
    for j := 0 to Self.FFiles.Count - 1 do begin
      if (Self.FFiles[j].LocalHeaderOffset > StartOffset) and
         (Self.FFiles[j].LocalHeaderOffset <= EndOffset) then
        EndOffset := Self.FFiles[j].LocalHeaderOffset;
    end;
    Size := EndOffset - StartOffset;
    // Update central directory header data
    Self.FFiles.Delete(i);
    for j := 0 to Self.FFiles.Count - 1 do begin
      Header := Self.FFiles[j];
      if Header.LocalHeaderOffset > StartOffset then begin
        Header.LocalHeaderOffset := Header.LocalHeaderOffset - Size;
        Self.FFiles[j] := Header;
      end;
    end;
    // Remove existing file stream
    SetLength(Buf, Self.FEndFileData - EndOffset);
    Self.FStream.Position := EndOffset;
    if Length(Buf) > 0 then
      Self.FStream.Read(Buf[0], Length(Buf));
    Self.FStream.Size := StartOffset;
    if Length(Buf) > 0 then
      Self.FStream.Write(Buf[0], Length(Buf));
    Self.FEndFileData := Self.FStream.Position;
  end;
end; 
```

用法：

```
ZipFile.Delete('document.txt');
ZipFile.Add(SS, 'document.txt'); 
```

# regex - 如何仅替换找到的文本的一部分？

> ID：13164312
> 
> 赞同：25
> 
> 时间：2012-10-31T18:22:42.903
> 
> 标签：regex, notepad++, replace

我有一个文件，其中包含一些逗号分隔的名称和一些逗号分隔的帐号。
名称将永远是类似的东西和类似`Dow, John`的数字`012394,19862`。

使用*Notepad++*的“正则表达式查找”功能，我想用管道替换数字之间的逗号`|`。

基本上 ：

```
turn:  Dow,John      into:  Dow,John
       12345,09876          12345|09876
       13568,08642          13568|08642 
```

我一直在用`[0-9],`它来*查找*逗号，但我无法让它正确地留下数字的最后一位数字并*只替换逗号*。

有任何想法吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-31T18:27:52.853

搜索`([0-9]),`并将其替换为`\1|`. 那样有用吗？

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-31T18:26:31.300

使用这个正则表达式

```
(\d),(\d) 
```

并将其替换为

```
$1|$2 
```

或者

```
\1|\2 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T18:27:26.293

`(?<=\d),`应该管用。奇怪的是，这仅在我使用全部替换时才有效，但在我使用替换单时无效。作为替代方案，您可以使用`(\d),`并替换为`$1|`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-26T09:52:31.353

**关于只替换部分比赛的一般想法**

为了替换匹配的一部分，您需要 1) 使用正则表达式模式中的捕获组和对替换模式中保留的组值的反向引用，或 2) 环视，或 3)`\K`丢弃左手的运算符语境。

所以，如果你有一个类似的字符串`a = 10`，并且你想`a =`用，比如，替换后面的数字`500`，你可以

*   查找`(a =)\d+`并替换为`\1500`/ `${1}500`（如果你使用`$n`反向引用语法并且后面跟着一个数字，你应该用大括号括起来）
*   查找`(?<=a =)\d+`并替换为`500`（因为`(?<=...)`是一种非消耗性的正向后向模式，并且它匹配的文本不会添加到匹配值中，因此不会被替换）
*   查找`a =\K\d+`并替换为`500`(where`\K`使正则表达式引擎“忘记”文本已匹配到该`\K`位置，使其类似于后视解决方案，但允许任何量词，例如即使之间有任何零个或多个水平空格也`a\h*=\K\d+`将匹配和）。`a =``a``=`

**当前问题解决方案**

为了替换两位数之间的任何逗号，您应该使用环视：

**查找内容**：`(?<=\d),(?=\d)`
**替换为**：`|`

*详情*：

*   `(?<=\d)`- 一个积极的向后看，需要一个数字紧挨当前位置的左边
*   `,`- 一个逗号
*   `(?=\d)`- 正向前瞻，需要在当前位置右侧立即有一个数字。

请参阅带有设置的演示屏幕截图：

[![在此处输入图像描述](../Images/6a82d6938fb074d2b3a07ca8d7e9fc65.png)](https://i.stack.imgur.com/PVloV.png)

请参阅[正则表达式演示](https://regex101.com/r/P0orfZ/1)。

*变化*：

**查找内容**：`(\d),(?=\d)`
**替换为**：`\1|`

**查找内容**：`\d\K,(?=\d)`
**替换为**：`|`

注意：如果有逗号分隔的*单个*数字，例如`1,2,3,4`你不能使用`(\d),(\d)`，因为这只会匹配奇数出现（见[我的意思](https://regex101.com/r/P0orfZ/2)）。

# security - 如果我对网站使用 Google 身份验证，我可以判断用户是否有 2 步身份验证吗？

> ID：13164314
> 
> 赞同：1
> 
> 时间：2012-10-31T18:22:47.260
> 
> 标签：security, authentication, google-authentication

我想对网站使用 Google 身份验证，但想强制使用 Google 2 步身份验证。有没有办法让我知道用户是否打开了这个？我想引导不使用它的用户。

请注意，这是针对非 Google 网站的，因此我无法使用 Google Apps 允许的强制执行功能。

# ruby-on-rails-3 - 在某些情况下使选择框成为必填字段

> ID：13164316
> 
> 赞同：0
> 
> 时间：2012-10-31T18:22:58.160
> 
> 标签：ruby-on-rails-3

我有一个表格，其中有一个带有类别的选择框。如果选择了特定类别，则会向用户显示另一个选择框/下拉列表。选择此类别时，我需要将第二个下拉列表作为必填字段。

我无法添加`validates :course, :presence => {:message => 'Course cannot be blank.'}`到模型中，因为此字段并不总是必需的，我需要一些其他方法来使其仅在第一个保管箱中选择某个类别时才需要。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:31:35.087

您可以尝试使用`if`to 的参数`validates`，如下所示：

```
validates :course, :presence => {:message => "Course cannot be blink."}, :if => Proc.new { |u| u.first_dropdown_value == 'value_that_you_validate_courses_for' } 
```

有关更多信息，请查看[有关条件验证的 Rails 文档](http://guides.rubyonrails.org/active_record_validations_callbacks.html#conditional-validation)。

# c# - Linq 奇怪的行为与字典

> ID：13164317
> 
> 赞同：4
> 
> 时间：2012-10-31T18:22:59.187
> 
> 标签：c#, linq, dictionary

我遇到了 Linq 的一个奇怪行为：使用两个看起来相同的 linq 表达式，我得到了不同的结果！如果我循环一次得到相同的结果，但在上面什么也找不到。

这是代码：

```
 Dictionary<String, String> mainDico = new Dictionary<String, String>();
        mainDico.Add("key1", "value1");
        mainDico.Add("key2", "value2");

        List<Dictionary<String, String>> ls = new List<Dictionary<String, String>>();

        Dictionary<String, String> fistDico = new Dictionary<String, String>();
        fistDico.Add("key1", "value1");
        fistDico.Add("key2", "value2");

        Dictionary<String, String> secondDico = new Dictionary<String, String>();
        secondDico.Add("key1", "other");
        secondDico.Add("key2", "other");

        ls.Add(fistDico);
        ls.Add(secondDico);

        IEnumerable<Dictionary<String, String>> failQuery = from p in ls
                                                            select p;

        IEnumerable<Dictionary<String, String>> successfulQuery = from p in ls
                                                            select p;

        String[] items = new String[] { "key1","key2" }; // with one element it works

        foreach (var item in items)
        {
            String temp = mainDico[item];
            failQuery = failQuery.Where(p => p[item] == temp);
            successfulQuery = successfulQuery.Where(p => p[item] == mainDico[item]);
        }

        Console.WriteLine(successfulQuery.SingleOrDefault() != null);//True
        Console.WriteLine(failQuery.SingleOrDefault() != null);//False 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T18:33:29.177

问题是您正在关闭循环变量。

有问题的代码部分就在这里：

```
foreach (var item in items)
{
    String temp = mainDico[item];
    failQuery = failQuery.Where(p => p[item] == temp);
    successfulQuery = successfulQuery.Where(p => p[item] == mainDico[item]);
} 
```

您正在创建一个`item`在第二种情况下关闭的 lambda（也是第一种情况；您应该真正解决该问题），并且直到 foreach 循环结束后才评估查询；这意味着`item`它将始终是 foreach 循环中的最后一项，而不是当前项。这可以通过创建一个新的局部变量来轻松解决，这就是您在第一种情况下所做的，这就是它起作用的原因。

这是一个[相关链接](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)，更详细地讨论了这个问题。（您可以通过搜索“关闭循环变量”找到更多信息。

请注意，[这在 C# 5.0 中已更改，](https://stackoverflow.com/questions/8898925/is-there-a-reason-for-cs-reuse-of-the-variable-in-a-foreach)因为它经常导致混淆和错误。（这可能是某些人无法重现该问题的原因。）

还值得注意的是，这与字典无关。在您的查询`item`中，实际上始终是 中的最后一项`foreach`，而不是当前项，这就是它失败的原因。您所做的任何`item`依赖于当前值的操作都不会达到您想要的效果。

# java - 同步块中的并发操作

> ID：13164324
> 
> 赞同：1
> 
> 时间：2012-10-31T18:23:41.270
> 
> 标签：java, multithreading, thread-safety

在我的应用程序中有一个场景，其中一个线程在其运行方法 while(true) 条件下执行此操作。

在其 while true 条件下，它不断地从外部数据源（Memcache）中获取信息，根据新登录或注销的用户添加/删除内容，最后将其更新回 Memcache。

一些代码片段

```
public class MonitoringThread extends Thread 
{
public void run() {
while(true)
String  response = Memcache.get("USERINFO");
// Some checks will be made on response and builds a new response and updates back to Memcache .
synchronized (response)
{
Memcache.set("USERINFO" , response) ;
}
}
} 
```

我的问题是

1.  **我在 set 操作中保留了 Synchronized 块（这是正确的）还是应该在执行 get 操作时完成？**

2.  **以及传递给 Synchronied 块的参数，这应该是 this（类本身）还是 String 响应**

更多信息。

我们的应用程序在由负载均衡器控制的 5 个 Web 服务器实例上运行。（所有这 5 个实例都会返回操作和更新数据）

请分享你的想法。

感谢阅读，祝您有美好的一天。

**编辑部分**

感谢您的回复，

我已经更改了同步块参数，请在下面告诉我什么是可行的方法

**选项1**

在线程中使用同步块

```
synchronized (Memcache.class)
{
Memcache.set("USERINFO" , response) ;
}

class Memcache
{
public static boolean set(String key, Object value) {
MemcacheClient.set(key, 0, value);
} 
```

或者

在 Memcache 类本身中使用同步块

```
class Memcache
{
synchronized (Memcache.class)
{
public static boolean set(String key, Object value) {
MemcacheClient.set(key, 0, value);
} 
```

// 其他方法 }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:29:48.487

锁定字符串不太可能有用，因为您每次都锁定不同的对象。 `Memcache`应该执行它需要的任何锁定，如果不需要，你需要锁定同一个对象，例如`Memcache.class`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T18:32:08.820

我不知道你想用这个同步块做什么，以及为什么你首先需要同步。您想使用同步块保护的共享状态是什么？

无论如何，可以肯定的是这个片段没有多大意义。`synchronized(response)`意味着如果两个线程都从缓存中接收到相同的 String 实例（相同的对象，而不仅仅是相同的字符），它们将无法执行同步块。这不太可能，并且可能不是您想要的。

# php - 这个 perl 正则表达式的 PHP 等价物是什么

> ID：13164325
> 
> 赞同：2
> 
> 时间：2012-10-31T18:23:45.687
> 
> 标签：php, regex, perl, translation

如何使用 PHP 编写这个 perl 代码？

```
$var =~ tr/[A-Za-z,.]/[\000-\077]/; 
```

编辑 007 应该是 077

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T18:36:47.157

php has the [strtr](http://www.php.net/strtr) function that uses array key=>value pairs where instances of key in a string are replaced with value. Other than that, like @Rocket said, you can use preg_replace_callback to get your replace value. the matched character is passed in to a function and is replaced with whatever the functions returns.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T19:19:56.763

你可以使用`preg_replace_callback` Perl

```
my $var = 'ABCDEFGHIJKLMNOPQRSTUVWXWZabcdefghijklmnopqrstuvwxyz1234567890,.';
$var =~ tr/[A-Za-z,.]/[\000-\077]/;
print unpack("H*", $var), "\n"; 
```

[PERL 现场演示](http://codepad.org/qxKKj4YE)

PHP

```
$string = 'ABCDEFGHIJKLMNOPQRSTUVWXWZabcdefghijklmnopqrstuvwxyz1234567890,.';
$replace = preg_replace_callback("/[A-Za-z,.]/", function ($m) {
    $n = 0;
    if (ctype_punct($m[0])) {
        $m[0] == "," and $n = - 8;
        $m[0] == "." and $n = - 7;
    } else {
        $n = ctype_upper($m[0]) ? 65 : 71;
    }
    return chr(ord($m[0]) - $n);
}, $string);
print(bin2hex($replace)); 
```

[PHP 现场演示](http://codepad.viper-7.com/QTZQAa)

两个输出

```
000102030405060708090a0b0c0d0e0f101112131415161716191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f30313233313233343536373839303435 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T21:10:07.753

有人说 PHP 没有等价物`tr///`（尽管我现在看到它是 as `strtr`）。如果是这样，

```
$var =~ tr/A-Za-z,./\000-\077/; 
```

可以写成如下替代：

```
my %encode_map;
my $i = 0;
$encode_map{$_} = chr($i++) for 'A'..'Z', 'a'..'z', ',', '.';

$var =~ s/([A-Za-z,.])/$encode_map{$1}/g; 
```

这应该更容易翻译成 PHP，但不幸的是我不知道 PHP。

（我假设`[]`in`tr///`不应该在那里。）

# kml - 谷歌地球插件上的扩展功能

> ID：13164326
> 
> 赞同：0
> 
> 时间：2012-10-31T18:23:50.637
> 
> 标签：kml, google-earth, google-earth-plugin

我们正在开发这个网络应用程序：[http](http://projects.igre.emich.edu/iccarsp/) ://projects.igre.emich.edu/iccarsp/ 现在我们正在尝试执行以下操作：

1.  在查看器上上传图像
2.  将图像（*移动、旋转等*）调整到其准确位置
3.  测量图像区域的面积（*或者可能将其数字化以测量图像的框架*）
4.  将结果（*背景和上传的图像*）输出为 KML

我做了研究，似乎我们可以在谷歌地球桌面版中完成所有这些，所以我们试图在网络插件上做同样的事情，但谷歌没有发布这些功能的代码（对*吗？*）

所以我想知道是否还有其他方法可以在 Google Earth Plugin 中执行网络上的功能。任何建议都会有所帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:48:33.663

关于面积计算，您仍然可以查看 GEarthExtensions： [http ://code.google.com/p/earth-api-utility-library/](http://code.google.com/p/earth-api-utility-library/)

geo.Path 对象的区域可通过 geo.Path.signedArea_ 访问您只需要在图像周围定义一个 geo.Path 但有一些限制：“该方法对于大区域不准确，因为没有考虑地球的曲率。” （来自 extensions-0.2.1.js）

希望这可以开始有所帮助:-)

# colors - 使用 wxPython 来自位图或 wxImage 的像素信息

> ID：13164328
> 
> 赞同：1
> 
> 时间：2012-10-31T18:23:55.783
> 
> 标签：colors, bitmap, wxpython, pixel

我有一个关于从位图中获取单个像素颜色信息的问题。我搜索了这些论坛以及演示和教程，虽然我相信我在理论上了解我需要做的事情，但实际上我无法做到。

这是我的代码示例（我已经缩短了它，但这是一个工作示例）：

```
import os, sys
import wx
import wx.lib.plot as plot
import Image

class MyFrame(wx.Frame):
    def __init__(self, parent, id, title):
        wx.Frame.__init__(self, parent, id, title, size=(500, 500))

        HolderPanel = wx.Panel(self, wx.ID_ANY)

        panel2 = MyPanel_2(HolderPanel, wx.ID_ANY)

        framesizer = wx.BoxSizer(wx.HORIZONTAL)
        framesizer.Add(panel2, 1, wx.EXPAND | wx.BOTTOM | wx.TOP | wx.RIGHT, 2)

        HolderSizer = wx.BoxSizer(wx.VERTICAL)
        HolderSizer.Add(framesizer, 1, wx.EXPAND)

        HolderPanel.SetSizer(HolderSizer)
        self.Show()

class MyPanel_2(wx.Panel):

    def __init__(self, parent, id):
        wx.Panel.__init__(self, parent, id, style=wx.SIMPLE_BORDER)
        self.SetBackgroundColour('grey')

        # Create main image holder
        self.img_1 = wx.EmptyImage(300,300)        
        self.imageCtrl_1 = wx.StaticBitmap(self, wx.ID_ANY, wx.BitmapFromImage(self.img_1)) # Starting with an EmptyBitmap, the real one will get put there by the call onView
        self.PhotoMaxSize_1 = (300)
        self.imageCtrl_1.Bind(wx.EVT_LEFT_DOWN, self.onMouseClick_img1)

        # Create the browse button
        brwsBtn = wx.Button(self, wx.ID_ANY, 'Browse', (10, 10))
        brwsBtn.Bind(wx.EVT_BUTTON, self.onBrowse)

        # Set up the text box
        self.photoTxt = wx.TextCtrl(self, size=(200,-1))

        # Create the sizers
        vsizer1 = wx.BoxSizer(wx.VERTICAL)
        hsizer3 = wx.BoxSizer(wx.HORIZONTAL)
        vsizer_MAIN = wx.BoxSizer(wx.VERTICAL)

        # -----------------------------------------------------------------------------------------------------------
        vsizer1.Add(self.imageCtrl_1, proportion = 0, flag= wx.ALIGN_CENTRE | wx.ALL, border=10)

        # -----------------------------------------------------------------------------------------------------------
        hsizer3.Add(brwsBtn, proportion = 0, flag = wx.ALIGN_CENTRE_VERTICAL | wx.LEFT | wx.RIGHT, border=10)
        hsizer3.Add(self.photoTxt, proportion = 1, flag = wx.ALIGN_CENTRE_VERTICAL | wx.LEFT | wx.RIGHT, border = 10)

        # -----------------------------------------------------------------------------------------------------------
        vsizer_MAIN.Add(vsizer1, proportion = 1, flag = wx.EXPAND)
        vsizer_MAIN.Add(hsizer3, proportion = 1, flag = wx.EXPAND)

        # -----------------------------------------------------------------------------------------------------------
        self.SetSizer(vsizer_MAIN)

    def onBrowse(self, event):
        """ 
        Browse for file
        """
        wildcard = "pictures (*.jpg, *.jpeg, *.png)|*.jpg;*.jpeg;*.png"
        dialog = wx.FileDialog(None, "Choose a file", wildcard=wildcard, style=wx.OPEN)

        if dialog.ShowModal() == wx.ID_OK:
            self.photoTxt.SetValue(dialog.GetPath())
        dialog.Destroy() 
        self.onView()

    def onView(self):

        self.filepath = self.photoTxt.GetValue()

        self.img_1 = wx.Image(self.filepath, wx.BITMAP_TYPE_ANY)
        # scale the image, preserving the aspect ratio
        W = self.img_1.GetWidth()
        H = self.img_1.GetHeight()
        if W > H:
            NewW = self.PhotoMaxSize_1
            NewH = self.PhotoMaxSize_1 * H / W
        else:
            NewH = self.PhotoMaxSize_1
            NewW = self.PhotoMaxSize_1 * W / H
        self.img_1 = self.img_1.Scale(NewW,NewH)

        self.imageCtrl_1.SetBitmap(wx.BitmapFromImage(self.img_1)) # Converts the scaled image to a wx.Bitmap and put it on the wx.StaticBitmap
        self.Refresh()

    def onMouseClick_img1(self, event):

        im = Image.open(self.filepath)
        pos = event.GetPosition()
        pix = im.load()
        print pix[pos.x, pos.y]

app = wx.App()
MyFrame(None, -1, 'Current Build')
app.MainLoop() 
```

这允许我浏览并导入图像，调整图像大小，然后选择单个像素以访问其颜色信息。但是，此代码存在一个问题：颜色信息与实际图像不匹配（在某些情况下，存在与超出图像范围有关的错误）。我回去检查这个并意识到

```
 im = Image.open(self.filepath) 
```

正在引用图像的实际路径，这就是`event.GetPosition()`正在读取的内容（因为调整大小的图像大小不同，我的代码没有读取呈现的内容）。我意识到我可以获取像素的颜色信息，因为我正在查看的是 a`wxImage`而不是原始图像的转换位图。通过将`onMouseClick_img1`事件调整为：

```
 def onMouseClick_img1(self, event):

        pos = event.GetPosition()

        print pos 
```

我可以读取空 StaticBitMap 或已加载、已调整大小且已转换为位图的图像上任何点的位置。但是，我无法提取所选像素的颜色信息。经过搜索，我找到[了这个页面](https://groups.google.com/forum/?fromgroups=#!topic/wxpython-users/ncGKIAUh7Kk)

并尝试了两种方法，但最终都出现了错误。由于我想使用该`wx.Image`方法，所以我尝试了这个：

```
 def onMouseClick_img1(self, event):

        img = wx.ImageFromBitmap(self.img_1)

        pos = event.GetPosition()
        print (img.GetRed(pos), img.GetGreen(pos), img.GetBlue(pos)) 
```

但我收到此错误消息：

> 回溯（最近一次调用最后）：文件“/Users/Documents/[用户名]/Eclipse_workspace/builder/src/GUI/Maybe.py”，第 254 行，onMouseClick_img1 img = wx.ImageFromBitmap(self.img_1) 文件“ /usr/local/Cellar/python/2.7.3/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/wx/_core.py”，第 3750 行，在 ImageFromBitmap val = *core* .new_ImageFromBitmap (*args, **kwargs) 类型错误：在方法“new_ImageFromBitmap”中，预期参数 1 类型为“wxBitmap const &”

我认为我需要做的就是在调整位图大小后将位图转换回图像，然后从中提取像素信息，但我显然在某处做错了什么。任何帮助将不胜感激。这是我第一次尝试真正的 GUI，而且我是新手`wxPython`，所以如果您发现更一般的错误，请随时告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-03T19:01:08.430

所以，我找到了一种方法来完成这项工作。也许我一开始并没有完全理解我需要做什么（也许我在这里仍然缺少关键想法），但我所做的工作有效。可能是我得到这个工作的方式是丑陋或低效的......但它有效。我有没有提到我认为这行得通？

我没有尝试从显示的位图中提取任何信息，或者将位图转换为另一种格式并显示，而是在 StaticBitmap 中显示调整大小的图像并使用另一种方法来提取像素信息：

```
 def onView(self):
    """ 
    This is pulling in the image and resizing it, maintaining its original ratio; if the image is square, this is fine as long as the image boxes are square; the ratios
    are getting messed up depending on the size of the picture; I would imagine that the images we're going to be importing are going to be pretty uniform.
    """        

    # Code imports and resizes the image
    self.filepath = self.photoTxt.GetValue()

    self.img_1 = wx.Image(self.filepath, wx.BITMAP_TYPE_ANY)
    # scale the image, preserving the aspect ratio
    W = self.img_1.GetWidth()
    H = self.img_1.GetHeight()
    if W > H:
        NewW = self.PhotoMaxSize_1
        NewH = self.PhotoMaxSize_1 * H / W
    else:
        NewH = self.PhotoMaxSize_1
        NewW = self.PhotoMaxSize_1 * W / H
    self.img_1 = self.img_1.Scale(NewW,NewH)

    self.imageCtrl_1.SetBitmap(wx.BitmapFromImage(self.img_1)) # Converts the scaled image to a wx.Bitmap and put it on the wx.StaticBitmap
    self.Refresh()

    # Code creates an image using wxImage to pull pixel information from
    self.img_1_IMAGE = Image.open(self.filepath)
    self.img_1_IMAGE_r = self.img_1_IMAGE.resize((NewW, NewH))

def onMouseClick_img1(self, event):

    im = self.img_1_IMAGE_r
    pos = event.GetPosition()
    pix = im.load()
    print pix[pos.x, pos.y] 
```

关键的区别似乎是（至少对我而言）我没有将此图像转换为位图并将其分配给我的 StaticBitmap。这允许我在调用 onMouseClick_img1 时访问调整大小图像的像素信息。由于我对每个图像使用相同的调整大小参数，因此尺寸应该匹配（而且他们似乎这样做），允许我在从调整大小的图像中提取像素信息时看到显示的 StaticBitmap 中的图像。

如果有人对此有任何意见或疑虑，请随时告诉我。我只是想发布我发现的内容，以防其他人遇到类似问题。

# jsf-2 - JSF，复合组件：以默认属性值作为参数的方法调用

> ID：13164330
> 
> 赞同：3
> 
> 时间：2012-10-31T18:24:07.223
> 
> 标签：jsf-2, composite-component

我是 JSF 的新手，还在学习。我尝试为下面描述的特定问题寻找解决方案，但我找不到任何东西。如果是因为我在寻找错误的东西，请指出我正确的方向，但希望这是尚未回答的问题，答案可以使每个人受益。

以下示例说明了我遇到的问题。该示例被简化以关注问题并隐藏发生问题的实际项目的复杂性。

考虑以下页面/类：

1.  /resources/test/custom.xhtml；
2.  /test/CharsetProvider.java;
3.  /test/CharsetHello.java;
4.  /testWith.xhtml;
5.  /testWithout.xhtml;

**/resources/test/custom.xhtml**

这是具有一个属性和默认值的复合组件。该组件只需获取属性值并将其作为参数传递给下面描述的 CDI bean 以获得用于输出的模型对象。

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:cc="http://java.sun.com/jsf/composite"
      xmlns:h="http://java.sun.com/jsf/html">

    <cc:interface>
        <cc:attribute name="charset"
                      default="#{charsetProvider.defaultCharset}"
                      type="java.nio.charset.Charset" />
    </cc:interface>

    <cc:implementation>
        <h:outputText value="#{charsetProvider.createCharsetHello(cc.attrs.charset).hello}"/>
    </cc:implementation>
</html> 
```

**测试/CharsetProvider.java**

这是一个 CDI bean，它只包含一个在整个应用程序中使用的默认值，并具有一个创建用作组件模型的对象的方法。我使用 CDI bean 而不是支持 bean 的原因是因为在我的特定项目中，默认值需要在运行时注入，但支持 bean 不是注入的候选者。

```
package test;

import java.nio.charset.Charset;
import javax.annotation.PostConstruct;
import javax.faces.bean.SessionScoped;
import javax.inject.Named;

@Named
@SessionScoped
public class CharsetProvider {

    private Charset defaultCharset;

    @PostConstruct
    protected void postConstruct() {
        this.defaultCharset = Charset.forName("UTF-8");
    }

    public Charset getDefaultCharset() {
        return defaultCharset;
    }

    public Charset getCharsetForName(String name) {
        return Charset.forName(name);
    }

    public CharsetHello createCharsetHello(Charset cs) {
        return new CharsetHello(cs);
    }
} 
```

**测试/CharsetHello.java**

这是“模型”对象。它只是转换“Hello world！” 到一个字节数组并使用给定的字符集返回。

```
package test;

import java.nio.charset.Charset;

public class CharsetHello {

    private static final String HW = "Hello World!";
    private final byte[] data;
    private final Charset cs;

    public CharsetHello(Charset cs) {
        this.cs = cs;
        this.data = CharsetHello.HW.getBytes(this.cs);
    }

    public String getHello() {
        return new String(this.data, this.cs);
    }
} 
```

**testWith.xhtml**

这是一个测试页面，它通过指定组件属性的值来使用上面定义的复合组件。页面正确呈现，即“Hello World！” 打印在屏幕上。

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:test="http://java.sun.com/jsf/composite/test">
    <h:head>
        <title>Test</title>
    </h:head>
    <h:body>
        <test:custom charset="#{charsetProvider.getCharsetForName('UTF-16')}" />
    </h:body>
</html> 
```

**testWithout.xhtml**

这是一个测试页面，没有将自定义值传递给组件的属性，打算使用默认值。

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:test="http://java.sun.com/jsf/composite/test">
    <h:head>
        <title>Test</title>
    </h:head>
    <h:body>
        <test:custom />
    </h:body>
</html> 
```

上面的页面会导致一个带有以下消息的 JSF 错误页面：

```
/resources/test/custom.xhtml @14,94 value="#{charsetProvider.createCharsetHello(cc.attrs.charset).hello}": Cannot convert UTF-8 of type class java.lang.String to class java.nio.charset.Charset 
```

似乎在最后一种情况下，默认值在传递给方法之前被转换为 java.lang.String 。

首先，这是预期的行为吗？为什么？

如果这是预期的行为，您能否建议不同的实现？

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T17:06:52.117

此问题与此问题具有完全相同的基础：[FacesConverter forClass don't work with Composite Componet](https://stackoverflow.com/questions/13177911/facesconverter-forclass-dont-work-with-composite-componet)。复合属性值类型在 Mojarra 中被错误地评估为`java.lang.Object`而不是实际模型类型。

它被报告为[Mojarra 问题 2568](http://java.net/jira/browse/JAVASERVERFACES-2568)。它适用于 MyFaces 2.1.9。