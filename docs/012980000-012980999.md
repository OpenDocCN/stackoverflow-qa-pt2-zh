# StackOverflow 问答 12980000-12980999

# mysql - SELECT DISTINCT 没有做我希望它做的事情

> ID：12980002
> 
> 赞同：2
> 
> 时间：2012-10-19T18:08:38.193
> 
> 标签：mysql, sql

我正在尝试带回属性列表。属性可以有许多“通行证”。我想带回一个独特属性的列表，但如果它们有多个传递，我想要一个具有最大 pass_id 的传递。这是我到目前为止所拥有的：

```
select * from passes
inner join properties on properties.prop_id = passes.prop_id
where pass_id NOT IN (select pass_id from queue where user_id = 1)

+---------+---------+---------+---------+------------------+--------------+-------+
| pass_id | prop_id | user_id | prop_id | full_street_name | house_number | zip   |
+---------+---------+---------+---------+------------------+--------------+-------+
|      18 |      21 |       1 |      21 |  N KEELER AVE    |         6200 | 60646 |
|      20 |      21 |       1 |      21 |  N KEELER AVE    |         6200 | 60646 |
|      21 |      21 |       1 |      21 |  N KEELER AVE    |         6200 | 60646 |
|      22 |      22 |       1 |      22 |  E CHESTNUT ST   |          111 | 60611 |
+---------+---------+---------+---------+------------------+--------------+-------+ 
```

我希望它只返回 pass_id 21 和 22，因为 18 和 20 是 21 的重复属性。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:15:05.640

因为您使用的是 mysql，所以您可以使用这个 mysql-only 简洁的解决方案：

```
select * from (
    select * from passes
    inner join properties on properties.prop_id = passes.prop_id
    where pass_id NOT IN (select pass_id from queue where user_id = 1)
    order by pass_id desc) x
group by prop_id 
```

此查询只是您的原始查询，但按 排序`pass_id desc`，然后按 分组`prop_id`。

在我知道的所有其他数据库中，这会导致 SQL 语法异常，因为有些列没有被分组，也没有被聚合。但是，在 mysql 中，它不会给出错误，而是返回每个组的*第一*行。在这种情况下，第一行是最大`pass_id`的，因为数据是这样排序的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:16:20.040

尝试：

```
 Select * From passes p
 Where Pass_Id =
     (Select Max(pass_Id) From Passes
      Where Prop_Id = p.Prop_Id) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:02:29.050

试试这个？

```
Select * From passes p  
Where Pass_Id in
  (Select [Max] = MAX(Pass_ID) OVER(PARTITION BY Prop_Id) 
   From Passes) 
```

# javascript - 使用 jQuery 以自由格式将数字输入到屏蔽的输入字段中

> ID：12980011
> 
> 赞同：3
> 
> 时间：2012-10-19T18:09:08.857
> 
> 标签：javascript, jquery

我想使用掩码插件构建一个表单输入，它将更改条目的时间特征，以允许用户以自由格式格式输入数字，系统将使用 jQuery 将输入的数字转换为适当的时间显示.

**示例：**用户输入“135”，系统将其转换为“01:35”</p>

面具的代码是：

```
$("input.time").mask("99:99"); 
```

到目前为止，我有以下代码：

```
$(document).ready(function() {
$('#awareness-hour').blur(function() {
    if(!$('#awareness-hour').val().match(/([0-1][0-9]|2[0-3]):[0-5][0-9]/)){
        alert('invalid');           
    }else{
        return true;
    };
});
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:13:45.217

这将更正您提到的场景并仅在根据您的第二个正则表达式是有效时间时更新输入。希望你明白了，这很有效：

```
$("input.time").blur(function() {       
    var userInput = $(this).val().replace(/^([0-9])([0-9]):([0-9])_$/, "0$1:$2$3");     
    if(!userInput.match(/([0-1][0-9]|2[0-3]):[0-5][0-9]/)){
        alert('invalid');           
    }else{
        $(this).val(userInput);
        return true;
    };
}).mask("99:99"); 
```

# bing-maps - 如何使用必应地图自定义仪表板

> ID：12980016
> 
> 赞同：1
> 
> 时间：2012-10-19T18:09:41.703
> 
> 标签：bing-maps

我有

```
showDashboard : true 
```

它在左上角创建地图导航器。

我在那里有一个侧边栏。我想将导航器向右移动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-27T05:49:15.380

覆盖 Bing 地图导航栏的默认 CSS：

```
.OverlaysTL {
    left: auto !important;
    right: 160px !important;
} 
```

# ios - iOS 照片上传到服务器

> ID：12980017
> 
> 赞同：0
> 
> 时间：2012-10-19T18:09:49.667
> 
> 标签：ios, image, api, upload

几天来，我一直在尝试如何将图像上传到 API。那里有一个像这样的 cURL 示例。

```
curl "http://address.com/api/" -F "parameter[name]=My Upload" -F "parameter[description]=this is my upload" -F "parameter[other]=additional info" -F "parameter[image]=@wake_2560x1600.jpg;type=image/jpg" 
```

我将如何使用它通过 NSMutableURLRequest 和 NSURLConnection 上传到服务器？我尝试了几种不同的方法，但都没有成功。有人有想法么？

编辑：

我目前正在尝试 ASIFormDataRequest

```
NSData *imageData = UIImageJPEGRepresentation(image, 0.9);
ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
[request setDelegate:self];
[request addRequestHeader:@"User-Agent" value:@"iOS App"];
[request addPostValue:@"name" forKey:@"parameter[name]"];
[request addPostValue:@"description" forKey:@"parameter[description]"];
[request addPostValue:@"other" forKey:@"parameter[other]"];
[request addData:imageData withFileName:[NSString stringWithFormat:@"jpeg_%d.jpg", rand()] andContentType:@"image/jpeg" forKey:@"param[image]"];
[request startAsynchronous]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T08:14:53.057

粗略的做法。

PHP 脚本。

```
<?php
$target_path  = "./";
$target_path = $target_path . basename( $_FILES['uploadedfile']['name']);
if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {
 echo "The file ".  basename( $_FILES['uploadedfile']['name']).
 " has been uploaded";
} else{
 echo "There was an error uploading the file, please try again!";
}
?> 
```

IOS代码

```
- (void)upload:(UIImage *)image {
    NSData *imageData = UIImageJPEGRepresentation(image, 80);
    NSString *urlString = @"http://www.upload.com/upload.php"; // URL of upload script.

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];

    NSString *boundary = @"---------------------------14737809831466499882746641449";
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
    [request addValue:contentType forHTTPHeaderField:@"Content-Type"];

    NSMutableData *body = [NSMutableData data];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[@"Content-Disposition: form-data; name=\"uploadedfile\"; filename=\"test.jpg\"\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[@"Content-Type: application/octet-stream\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[NSData dataWithData:imageData]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [request setHTTPBody:body];

    NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
    NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];
    NSLog(@"returnString: %@", returnString);
} 
```

只需确保您使用的变量名相同，在这里我对 php 和 ioscode 都使用“uploadedfile”

php

```
if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) 
```

IOS

```
[body appendData:[@"Content-Disposition: form-data; name=\"uploadedfile\"; filename=\"test.jpg\"\r\n" dataUsingEncoding:NSUTF8StringEncoding]]; 
```

// 虽然现在我使用[https://github.com/samvermette/SVHTTPRequest](https://github.com/samvermette/SVHTTPRequest)

如果您在代码中导入该库，那么上传将像这样简单

```
[SVHTTPRequest POST:@"http://www.upload.com/upload.php"
            parameters:[NSDictionary dictionaryWithObjectsAndKeys:imageData, @"uploadedfile", nil]
              progress:^(float progress) {
                  progressLabel.text = [NSString stringWithFormat:@"Uploading (%.0f%%)", progress*100];
              }
            completion:^(id response, NSHTTPURLResponse *urlResponse, NSError *error) {
                progressLabel.text = @"Upload complete";
            }]; 
```

# scala - 同一个Scala源文件可以编译成包含不同@ScalaSignature注解的类文件吗？

> ID：12980022
> 
> 赞同：0
> 
> 时间：2012-10-19T18:10:25.707
> 
> 标签：scala

我有两个类文件，我试图证明它们是从同一个 Scala 源生成的。

将类文件反编译成 Java 后，我得到了两个语义完全相同的 Java 文件。但是，它们内部有不同的 @ScalaSignature 注释。在类文件上运行“javap -verbose”时得到以下输出：

```
...
SourceFile: "ABC.scala"
ScalaSig: length = 0x3
 05 00 00
Signature: #140                         // <T:Ljava/lang/Object;>Lcom/xyz/ABC;Lscala/ScalaObject;Lscala/Product;
Lscala/Serializable;
RuntimeVisibleAnnotations:
  0: #141(#142=s#143)
minor version: 0
major version: 49
flags: ACC_PUBLIC, ACC_SUPER
--- 
```

从一个文件和另一个文件：

```
...
SourceFile: "ABC.scala"
ScalaSig: length = 0x3
 05 00 00
Signature: #140                         // <T:Ljava/lang/Object;>Lcom/xyz/ABC;Lscala/ScalaObject;Lscala/Product;
Lscala/Serializable;
RuntimeVisibleAnnotations:
  0: #141(#142=s#143)
minor version: 0
major version: 49
flags: ACC_PUBLIC, ACC_SUPER
... 
```

这两个类文件是否有可能从同一个 Scala 源获得，使用相同的 ScalaSig、Signature 等进行注释，但具有不同的 @ScalaSignature 注释？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:57:57.240

两个 scala 源文件可能以相同的字节码结束（sig 除外）。事实上，正是信号告诉您原始源文件不同。所以不，不可能证明两个类文件来自同一个 scala 源。

例如，如果两个类具有相同的方法但具有不同的类型参数，那么您将获得相同的字节码，但不同的信号。

作为一个简单的例子，看看下面的类：

```
class Foo {
  def fn1(t: String) = "" + t
  def fn2[T <: String](t : T) = "" + t
} 
```

这两种方法生成的字节码完全相同，但信号会不同：

```
public java.lang.String fn1(java.lang.String);
  Code:
   Stack=1, Locals=2, Args_size=2
   0:   aload_1
   1:   invokestatic    #12; //Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
   4:   areturn
  LineNumberTable:
   line 2: 0

  LocalVariableTable:
   Start  Length  Slot  Name   Signature
   0      5      0    this       LFoo;
   0      5      1    t       Ljava/lang/String;

  Signature: length = 0x2
   00 12

public java.lang.String fn2(java.lang.String);
  Code:
   Stack=1, Locals=2, Args_size=2
   0:   aload_1
   1:   invokestatic    #12; //Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
   4:   areturn
  LineNumberTable:
   line 3: 0

  LocalVariableTable:
   Start  Length  Slot  Name   Signature
   0      5      0    this       LFoo;
   0      5      1    t       Ljava/lang/String; 
```

# c# - 捆绑在 asp.net mvc 4.0 中不包括所有 jquery 库？

> ID：12980024
> 
> 赞同：2
> 
> 时间：2012-10-19T18:10:27.767
> 
> 标签：c#, asp.net-mvc-4

总体而言，在我的应用程序中，运行对话框内容时出现**jquery ui 错误。**我在我的 Visual Studio 解决方案资源管理器中看到 jquery 1.8.2 和 Modernizer 2.6.2 已加载到 Windows Internet Explorer 中。

但是为什么其余的没有像对话框的 jquery ui 一样包含在内？

这是默认的 asp.net mvc 4.0 项目代码：

```
bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
                        "~/Scripts/jquery-{version}.js"));

            bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
                        "~/Scripts/jquery-ui-{version}.js"));

            bundles.Add(new ScriptBundle("~/bundles/jqueryval").Include(
                        "~/Scripts/jquery.unobtrusive*",
                        "~/Scripts/jquery.validate*"));

            // Use the development version of Modernizr to develop with and learn from. Then, when you're
            // ready for production, use the build tool at http://modernizr.com to pick only the tests you need.
            bundles.Add(new ScriptBundle("~/bundles/modernizr").Include(
                        "~/Scripts/modernizr-*"));

            bundles.Add(new StyleBundle("~/Content/css").Include("~/Content/site.css"));

            bundles.Add(new StyleBundle("~/Content/themes/base/css").Include(
                        "~/Content/themes/base/jquery.ui.core.css",
                        "~/Content/themes/base/jquery.ui.resizable.css",
                        "~/Content/themes/base/jquery.ui.selectable.css",
                        "~/Content/themes/base/jquery.ui.accordion.css",
                        "~/Content/themes/base/jquery.ui.autocomplete.css",
                        "~/Content/themes/base/jquery.ui.button.css",
                        "~/Content/themes/base/jquery.ui.dialog.css",
                        "~/Content/themes/base/jquery.ui.slider.css",
                        "~/Content/themes/base/jquery.ui.tabs.css",
                        "~/Content/themes/base/jquery.ui.datepicker.css",
                        "~/Content/themes/base/jquery.ui.progressbar.css",
                        "~/Content/themes/base/jquery.ui.theme.css")); 
```

**更新**

```
<!DOCTYPE html>
<html lang="en">
<head>
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/modernizr")        

    <script type="text/javascript">

    </script>
</head>
<body>
    <div id="logo" />
    <div id="NavigationPanel">     

    </div>
    <div id="ContentPanel">
        @RenderBody()
    </div>   
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T18:22:12.567

正如我所怀疑的那样，您似乎没有在 _layout 文件中引用您的 jqueryui 包。您将需要再次调用 @Scripts 助手：

```
@Scripts.Render("~/bundles/jqueryui") 
```

以及对 jquery ui css 文件的引用：

```
@Styles.Render("~/Content/themes/base/css") 
```

# android - 在应用小部件更新时替换 RemoteViewsFactory

> ID：12980025
> 
> 赞同：7
> 
> 时间：2012-10-19T18:10:28.823
> 
> 标签：android, android-appwidget

我的应用小部件以多种模式运行。对于这些模式中的每一种，我都创建了一个`RemoteViewsFactory`. 为了在模式之间切换，我向我的`AppWidgetProvider`. 收到后，我创建了's`RemoteViews`并将其传递给`AppWidgetManager`'s `updateAppWidget()`。要`RemoteViewsFactory`为集合视图设置 a，我调用`RemoteViews`' `setRemoteAdapter()`：

```
rv.setRemoteAdapter(appWidgetId, R.id.widget_view_flipper, intent); 
```

`R.id.widget_view_flipper`是集合视图，`intent`是为了`RemoteViewsService`构建合适的工厂。

**编辑：**我编辑了这个问题，因为我发现了最初描述的问题。现在是当我更改工厂时，更改`getViewAt()`后会调用新工厂，但集合视图中的元素根本不会更新！那怎么会发生？

现在我唯一想到的是，我可以在工厂更换后延迟调用 AppWidgetManager 的 notifyAppWidgetViewDataChanged，它会导致视图中的元素更新为丑陋的闪烁。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-22T18:25:42.097

经过半天的挖掘，我想出了一个解决方法。

当我需要更新一个小部件并替换一个工厂时，在 AppWidgetProvider 中执行以下操作：

```
appWidgetManager.updateAppWidget(appWidgetIds[i], null);
appWidgetManager.updateAppWidget(appWidgetIds[i], rv); 
```

其中 rv 是新的 RemoteViews。

旧的 RemoteViews 缓存在 AppWidgetHostView 中，这样我们就可以摆脱缓存的数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-01-06T22:48:06.967

就我而言，我不需要调用它两次，但我发现我的 listView 项目没有相应地更新。我必须调整小部件的大小才能看到更改。因此，除了进行上述调用之外，我还对列表进行了以下更新

```
int[] widgetIds = mAppWidgetManager.getAppWidgetIds(mComponentName);
mAppWidgetManager.notifyAppWidgetViewDataChanged( widgetIds, R.id.widget_listview ); 
```

# perl - 什么可能导致 perl 中的打印错误？

> ID：12980026
> 
> 赞同：7
> 
> 时间：2012-10-19T14:56:26.037
> 
> 标签：perl

我有一个长时间运行的脚本，每小时打开一个文件，打印到它并关闭文件。我最近很少发现，打印失败，不是因为我正在测试打印本身的状态，而是因为在系统实际重新启动之前文件中缺少条目！

我确实捕获了文件打开失败，并在发生这种情况时向 syslog 写入一条消息，但我没有看到任何打开失败，所以我现在猜测它可能是打印失败。我没有捕获打印失败，我怀疑大多数人没有，但现在要更新那个打印。

同时，我的问题是，有没有人知道当有大量磁盘存储并且没有争用已在附加模式下成功打开的文件时，哪些类型的情况会导致打印语句失败？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T15:44:31.347

您可能内存不足 (ENOMEM) 或超过文件大小限制 (E2BIG 或 SIGXFSZ)。您可能会遇到老式的 I/O 错误 (EIO)。如果脚本同时运行或通过 NFS 访问文件，您可能会遇到竞争条件。而且，当然，您可能会在要打印其值的表达式中出现错误。

我曾经看到的一个奇异原因是 CPU 散热器故障可能导致 sprintf 虚假失败，从而导致一些令人惊讶的结果，包括将垃圾写入文件描述符。

最后，我提醒您 print 通常会将其内容写入 I/O 缓冲区。这意味着两件事。(1) 您还需要检查 close() 的结果。(2) 如果您打印但您没有立即 close() 或 flush() 那么您的数据可以被缓冲并且直到很久以后才真正写入（或者如果进程可怕地死亡则根本不会写入）。

# java - Oracle Hotspot JVM：一般来说，哪些操作特别耗费 CPU？

> ID：12980029
> 
> 赞同：4
> 
> 时间：2012-10-19T18:10:37.443
> 
> 标签：java, performance, jvm, jvm-hotspot

我想了解哪些类型的操作对 CPU 负载的贡献不成比例，并对常见操作的相对成本有一个直觉。为了尽量减少泛化，请假设 Oracle 7 HotSpot JVM。

例如：

*   构造大量对象会消耗 CPU（我知道它会消耗内存:-)）吗？
*   满足显示器成本CPU？即，如果我们有多个线程试图进入同一个同步块，阻塞的线程是否也会消耗 CPU 周期？
*   上述操作的相对成本？例如，“新建单个对象与迭代 X 元素数组所消耗的 CPU 相同”

关于开发典型操作的相对 CPU 成本直觉的任何提示？

您可以推荐有关该主题的任何好读物吗？

谢谢你，

**澄清**

感谢您的早期回复，但请注意我：

*   我不是在问“为什么我的应用程序很慢”
*   了解使用分析器将有助于识别特定应用程序中的问题，例如，GC 会占用 CPU，或者 GC 的终身代比 Eden 空间更昂贵
*   了解大多数操作只有在大量执行时才会变得昂贵（即，如果谨慎使用，几乎没有任何操作是昂贵的）

相反，我正在寻找*相对*CPU 成本的指导，尤其是上述操作（让我们假设一个“网络规模”应用程序使用所有提到的相同数量的操作 - 很多）。

例如，我现在已经：

*   长方法调用链不会显着增加 CPU 负载（因此通常可以自由地使用方法委托）
*   抛出异常比使用条件更昂贵（因此后者通常首选用于高度性能敏感代码中的流控制）

...但是实例化新对象或满足监视器呢？这些操作中的任何一个是否会对大规模 CPU 负载（假设我不关心延迟或堆大小）产生重大（主要？）贡献者？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:44:17.247

一次操作总是很快的。一个可测量的 CPU 负载，一个操作被执行几千次甚至一百万或十亿次。因此，您要注意各种循环和大量递归调用。

通常，执行一百万次并不明显，因为明显的循环只执行了一百次。但是它调用了一个执行一百次的函数，其中包含另一个执行一百次操作的函数。这样你最终会得到运行一百万次的东西。在 Web 应用程序中，它乘以并发请求的数量。

由于发现真正的热点并不容易，您可能希望使用专门的 Java 性能分析工具来调查您的应用程序。通过这种方式，您可以了解哪些模式是 CPU 密集型的，哪些模式不是。

Java 中的另一件事是，如果您分配了大量无法快速释放的内存（无论是大块还是小块），那么垃圾收集可能会占用 CPU。使用大量字符串（例如在处理 XML 时）可能是这样的原因。

但最好的事情真的是使用分析工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:16:02.057

我认为你们中写的相对CPU消耗如下：

1) 数组的索引；它很快; 它只是解决

2) 监控——速度较慢；挂起和等待线程不消耗CPU，切换消耗CPU很少，但比索引多

3）如果一个对象很复杂并导致创建子对象，创建一个对象可能会很慢；创建一个`new Object()`比线程切换稍慢一点；但可能是我错了，它是一样的；反正可比

4) 抛出/捕获异常非常慢；比创建对象慢 10-100 倍

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T11:17:40.453

抛出异常可能非常便宜。昂贵的部分通常只是异常对象的创建，因为 this 调用`fillInStackTrace()`，这是昂贵的。如果你忽略它，其余的会很快（它可以和 C 中的 goto 一样快）。

来源：[https ://blogs.oracle.com/jrose/entry/longjumps_considered_inexpensive](https://blogs.oracle.com/jrose/entry/longjumps_considered_inexpensive)

这是一个[包含有关 OpenJDK JVM 的内部信息的页面，其中列出了有关性能](https://wikis.oracle.com/display/HotSpotInternals/PerformanceTechniques)的信息以获取更多信息。

# sql-server - SQL Server - 表元数据

> ID：12980032
> 
> 赞同：6
> 
> 时间：2012-10-19T18:10:43.160
> 
> 标签：sql-server, database, metadata, database-administration, database-table

我在 SQL Server 数据库中有 1000 个表。

如果我想简要说明每个表在我的应用程序中的作用，我是否应该创建另一个表来维护该信息？或者有更好的方法吗？

例如 ; 如果有一张表`[PurchaseOrdersConcrete]`，我想指出 -*该表存储来自财富 500 强公司的所有采购订单。*

我应该为此目的创建另一个元数据表，还是`Notes`在 SQL Server 中的某个地方已经有一个 - - 列 ...（比如 in `sys.tables`）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-19T18:13:51.967

您可以通过扩展属性做到这一点。[可以在此处找到有关它们用法的](http://msdn.microsoft.com/en-us/library/ms190243%28v=SQL.105%29.aspx)msdn 概述。我已将它们用于您上面描述的确切目的。

管理它们的***最简单***方法是直接在 SSMS 中右键单击对象并选择属性。但是您也可以通过 tsql 在您的应用程序中使用它们。

要添加新的扩展属性，请使用[sp_addextendedproperty](http://msdn.microsoft.com/en-us/library/ms180047%28v=sql.105%29.aspx)。

要检索现有的扩展属性，一种典型的方法是查询[::fn_listextendedproperty](http://msdn.microsoft.com/en-us/library/ms179853%28v=sql.105%29.aspx)，如下面的示例所示。

```
SELECT   objType, objName, Type, Value
FROM   ::fn_listextendedproperty (null, 'user',
 'dbo', 'table','<your table>', null, null) 
```

[通过使用sp_updateextendedproperty](http://msdn.microsoft.com/en-us/library/ms186885%28v=sql.105%29.aspx)和[sp_dropextendedproperty](http://msdn.microsoft.com/en-us/library/ms178595%28v=sql.105%29.aspx)可以对它们进行更新和删除操作

* * *

此外，SSMS 将它们用于它自己的一些元数据。一种查看它们的实际效果的方法是查看您`views`在 SSMS 中的一个。右键单击它并选择属性。然后单击“扩展属性”。您可能会看到一个关于`MS_DiagramPane???`. 这是 MS 存储视图布局的地方，因此每次在设计模式下打开视图时，它看起来与上次离开时​​的方式相同。

[这些早在 SQL2000](http://www.simple-talk.com/sql/sql-tools/towards-the-self-documenting-sql-server-database/)就已经可用，但最近才得到广泛使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:42:23.910

正如 RTHomas 建议的那样，使用扩展属性，甚至更好地使用 RedGates SQLDoc 工具，这将使您可以轻松地填充和维护这些字段：

[http://www.red-gate.com/products/sql-development/sql-doc/](http://www.red-gate.com/products/sql-development/sql-doc/)

完成后，它甚至会为您生成打印和/或 Web 文档。很棒的工具。

# phpunit - 带有 Zend Framework 2 模块的 PHPUnit

> ID：12980033
> 
> 赞同：3
> 
> 时间：2012-10-19T18:10:49.917
> 
> 标签：phpunit, zend-framework2

我正在努力让 PHPUnit 测试与 ZF2 一起使用。

我的目录结构如下

```
project
- src
  - config, data, module, public, vendor
  - init_autoloader.php
- test
  - bootstrap.php
  - SimpleTest.php 
```

应用程序本身运行良好。

现在为了运行 PHPUnit 测试，我的 bootstrap.php 如下所示

```
putenv('ZF2=../src/vendor/zendframework/zendframework/library');
$loader = include '../src/vendor/autoload.php';
include '../src/init_autoloader.php'; 
```

这适用于 ZF2 相关的东西，但找不到我的模块。然后我读到我必须将以下行添加到我的 bootstrap.php

```
Zend\Mvc\Application::init(include '../src/config/application.config.php'); 
```

但现在我收到以下错误：

```
PHP Fatal error:  Uncaught exception 'Zend\ModuleManager\Exception\RuntimeException' with message 'Module (Mymodule) could not be initialized.' in /Users/_/src/vendor/zendframework/zendframework/library/Zend/ModuleManager/ModuleManager.php:139 
```

不幸的是，我无法解决这个问题。我做错什么了？我怎样才能做到这一点？

非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T12:29:00.463

与此同时，我能够使用[http://robertbasic.com/blog/unit-testing-zend-framework-2-modules](http://robertbasic.com/blog/unit-testing-zend-framework-2-modules)`set_include_path()`中`spl_autoload_register()`的描述来解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-19T10:55:34.080

我也有这个问题。

我通过使用以下参数**从 ZF2 项目的根目录运行 phpunit**解决了这个问题：

```
 ./vendor/bin/phpunit
  --bootstrap ./module/Rest/test/Bootstrap.php
  ./module/Rest/test/RestTest/Controller/RestControllerTest.php 
```

我的

```
<zf2_project_root>/module/Rest/test/TestConfig.php.dist 
```

设置为测试我的**Rest**模块，如下所示：

```
<?php
return array(
    'modules' => array(
        'Rest' // <- my 'Rest' module is the one I test here.
    ),
    'module_listener_options' => array(
        'config_glob_paths'    => array(
            '../../../config/autoload/{,*.}{global,local}.php',
        ),
        'module_paths' => array(
            'module',
            'vendor',
        ),
    ),
); 
```

当然，我的**./composer.json**包含对 phpunit 的引用，如下所示：

```
{
    "require" : {
        ...,
        "phpunit/phpunit" : "3.7.*",
        ...,
    }
} 
```

**笔记：**

phpunit 也可以仅通过引导类调用（即，不指定测试套件类）。还使用*--colors*标志使 phpunit 输出更具可读性：

```
 ./vendor/bin/phpunit
  --colors
  --bootstrap ./module/Rest/test/Bootstrap.php 
```

# oracle - ORA-00932: 不一致的数据类型: 预期 - 得到 CLOB

> ID：12980038
> 
> 赞同：77
> 
> 时间：2012-10-19T18:10:55.883
> 
> 标签：oracle, clob

考虑到这`TEST_SCRIPT`就是`CLOB` 我在 Oracle 上从 SQL*PLUS 运行这个简单查询时出现错误的原因：

```
ORA-00932: inconsistent datatypes: expected - got CLOB 
```

我一直在阅读很多关于相同错误的问题，但没有一个是从 SQLPLUS 运行直接查询

```
 UPDATE IMS_TEST 
       SET TEST_Category  = 'just testing'  
     WHERE TEST_SCRIPT    = 'something'
       AND ID             = '10000239' 
```

完整示例：

```
SQL> create table ims_test(
  2  test_category varchar2(30),
  3  test_script clob,
  4  id varchar2(30)
  5  );

Table created.

SQL> insert into ims_test values ('test1','something','10000239');

1 row created.

SQL> UPDATE IMS_TEST
  2  SET TEST_Category  = 'just testing'
  3  WHERE TEST_SCRIPT    = 'something'
  4  AND ID             = '10000239';
WHERE TEST_SCRIPT    = 'something'
      *
ERROR at line 3:
ORA-00932: inconsistent datatypes: expected - got CLOB 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-10-19T18:46:41.443

您不能将 CLOB 放在 WHERE 子句中。从[文档](https://docs.oracle.com/en/database/oracle/oracle-database/21/sqlrf/Comparison-Conditions.html)中：

> 比较条件不支持大对象 (LOB)。但是，您可以使用 PL/SQL 程序对 CLOB 数据进行比较。

如果您的值始终小于 4k，则可以使用：

```
UPDATE IMS_TEST 
   SET TEST_Category           = 'just testing'  
 WHERE to_char(TEST_SCRIPT)    = 'something'
   AND ID                      = '10000239'; 
```

无论如何，用 CLOB 搜索是很奇怪的。你不能只用 ID 列搜索吗？

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2015-11-20T12:54:53.477

做的时候也会出现同样的错误`SELECT DISTINCT ..., <CLOB_column>, ...`。

如果此 CLOB 列在所有适用行中包含短于 VARCHAR2 限制的值，您可以使用`to_char(<CLOB_column>)`或连接多次调用的结果`DBMS_LOB.SUBSTR(<CLOB_column>, ...)`。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-06-24T19:38:34.693

获取 CLOB 的 substr，然后将其转换为 char：

```
UPDATE IMS_TEST 
  SET TEST_Category           = 'just testing' 
WHERE to_char(substr(TEST_SCRIPT, 1, 9))    = 'something'
  AND ID                      = '10000239'; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-30T06:20:35.620

我刚刚跑过这个，我偶然发现 CLOB 可以在类似查询中使用：

```
 UPDATE IMS_TEST 
   SET TEST_Category  = 'just testing'  
 WHERE TEST_SCRIPT    LIKE '%something%'
   AND ID             = '10000239' 
```

这也适用于大于 4K 的 CLOB

性能不会很好，但在我的情况下这没问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-10-29T05:38:42.093

我发现`clob`在 CTE 中选择一列会导致这种爆炸。IE

```
with cte as (
    select
        mytable1.myIntCol,
        mytable2.myClobCol
    from mytable1
    join mytable2 on ...
)
select myIntCol, myClobCol
from cte
where ... 
```

大概是因为 oracle 无法处理临时表中的 clob。

因为我的值超过 4K，所以我不能使用`to_char()`.
我的工作是从决赛中选择它`select`，即

```
with cte as (
    select
        mytable1.myIntCol
    from mytable1
)
select myIntCol, myClobCol
from cte
join mytable2 on ...
where ... 
```

如果这会导致性能问题，那就太糟糕了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-12-14T11:51:53.417

问题可能在于选择的空值与 CLOB 类型的列相结合。

```
select valueVarchar c1 ,
       valueClob c2 ,
       valueVarchar c3 ,
       valueVvarchar c4
of Table_1
union
select valueVarchar c1 ,
       valueClob c2 ,
       valueVarchar c3 ,
       null c4
of table_2 
```

我重新设计了光标。第一个游标由四个非空列组成。第二个游标选择三个非空列。空值被注入到 cursorForLoop 中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-19T08:31:24.793

在我的情况下，我使用的是 EntityFramework 并且我尝试使用的列被称为`value`- 即 oracle 的保留关键字。

# r - Add geom with its own scales and legend

> ID：12980039
> 
> 赞同：1
> 
> 时间：2012-10-19T18:11:06.773
> 
> 标签：r, ggplot2, legend

This is arguable a follow up to these questions:

[Add legend to ggplot2 line plot](https://stackoverflow.com/questions/10349206/add-legend-to-ggplot2-line-plot)

[Add vline to existing plot and have it appear in ggplot2 legend?](https://stackoverflow.com/questions/12545322/add-vline-to-existing-plot-and-have-it-appear-in-ggplot2-legend)

I wish to add a geom to a plot that would have its own independent data, scale and legend elements.

I realize this may violate some of the grammar of graphics principles but I often find myself wanting such elements as vertical or horizontal lines, single points, arrows etc that would appear in the legend.

There seems to be added difficulty when scales are already used in other geom mappings.

Here is not so pretty example using iris:

```
p<-qplot(data=iris, x=Petal.Width,
         y=Sepal.Width,
         colour=Species,
         shape=as.factor(round(Petal.Length)),
         linetype=as.factor(round(Sepal.Length)),
         geom=c("line", "point"))

p<-p+geom_vline(xintercept=0.75, aes(linetype="Setosa vs Versicolor"))
p<-p+geom_vline(xintercept=1.75, aes(linetype="Versicolor vs Virginica"))

print(p) 
```

Which currently produces, missing linetype of vline and associate legend.

![enter image description here](../Images/2df7d326b96e2a8274c058c6d7019873.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:06:39.017

Change your `geom_vline` calls to include both `xintercept` and `linetype` in the `aes` call. Right now, the `linetype` is not having any effect (not just not showing up in the legend).

```
qplot(data=iris, x=Petal.Width,
      y=Sepal.Width,
      colour=Species,
      shape=as.factor(round(Petal.Length)),
      linetype=as.factor(round(Sepal.Length)),
      geom=c("line", "point")) +
geom_vline(aes(xintercept=0.75, linetype="Setosa vs Versicolor")) +
geom_vline(aes(xintercept=1.75, linetype="Versicolor vs Virginica"))

## Warning messages:
## 1: The shape palette can deal with a maximum of 6 discrete values because
## more than 6 becomes difficult to discriminate; you have 7\. Consider
## specifying shapes manually. if you must have them. 
## 2: The shape palette can deal with a maximum of 6 discrete values because
## more than 6 becomes difficult to discriminate; you have 7\. Consider
## specifying shapes manually. if you must have them. 
## 3: Removed 4 rows containing missing values (geom_point). 
## 4: The shape palette can deal with a maximum of 6 discrete values because
## more than 6 becomes difficult to discriminate; you have 7\. Consider
## specifying shapes manually. if you must have them. 
```

![enter image description here](../Images/6dbe7be54bf046b3f4a13a59666221ea.png)

# java - JSch：在一个命令中设置的变量在下一个命令中不可见（相同的会话）

> ID：12980041
> 
> 赞同：0
> 
> 时间：2012-10-19T18:11:26.013
> 
> 标签：java, ssh, jsch

我能够使用 JSch 从 Java 成功连接到远程 Unix 主机并运行一些基本命令和查看文件等。

问题从设置环境开始......当我在一个命令中导出一个 var 时，它在下一个命令中不可见，就好像它们在单独的 shell 中运行一样。我想做的是模拟在同一个 shell 中运行的多个命令。

这是我的**executeCommand**方法。它需要一个以前创建的 com.jcraft.jsch.Session 由**openHostSession**创建（如下）：

```
 public static void executeCommand(Session sess, String cmd, PrintStream pstream)
    {
        System.out.println("About to execute <" + cmd + ">");

        try
        {
            ChannelExec chnl = (ChannelExec)sess.openChannel("exec");     

            chnl.setInputStream(null);      

            chnl.setErrStream(System.err);  

            chnl.setCommand(cmd);      

            InputStream in = chnl.getInputStream();      

            chnl.connect();      

            byte[] tmp=new byte[1024];      

            while(true)
            {        
                while(in.available() > 0)
                {          
                    int i = in.read(tmp, 0, 1024); 

                    if(i < 0) break;          

                    pstream.print(new String(tmp, 0, i));        
                }        

                if(chnl.isClosed())
                {          
                    pstream.println("exit-status: " + chnl.getExitStatus());   

                    break;        
                }        

                try
                {
                    Thread.sleep(1000);
                }

                catch(Exception ee){}      
            }      

            chnl.disconnect();
        }
        catch(Exception ex)
        {
            ex.printStackTrace();
        }

    } 
```

这是**openHostSession**：

```
public static Session openHostSession(String host, String user, String passwd)
    {
        JSch jsch=new JSch();
        Session rslt = null;

        try
        {
            rslt = jsch.getSession(user, host, 22);
            rslt.setConfig("StrictHostKeyChecking", "no"); 
            rslt.setPassword(passwd);
            rslt.connect(30000);   
        }
        catch(JSchException jschEx)
        {
            jschEx.printStackTrace();
        }

        return rslt;
    } 
```

客户代码

```
cmd = "export XVAR=abc";
SshUtil.executeCommand(sess, cmd, System.out);

cmd = "echo $XVAR";
SshUtil.executeCommand(sess, cmd, System.out); 
```

输出：

```
About to execute <export XVAR=abc>
exit-status: 0
About to execute <echo $XVAR>

exit-status: 0 
```

我可以看到系统级环境变量，例如：

```
cmd = "echo $SHELL";
SshUtil.executeCommand(sess, cmd, System.out); 
```

返回

```
About to execute <echo $SHELL>
/bin/ksh 
```

退出状态：0

当我获取我的 .profile ( 时会发生类似的事情，`cmd = ". ./.profile";)`.profile 中设置的变量在下一个命令中不可见。这些命令共享相同的会话，但每个都打开自己的频道。我尝试共享频道，但没有这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:39:19.700

这就是 exec 通道的工作方式。它针对 SSH 服务器执行单个命令，并且每个命令执行独立于下一个命令。就像你做了类似的事情：

```
# ssh machine 'VAR=tmp; echo $VAR'
foo
# ssh machine 'echo $VAR' 
```

这些是两个单独的命令执行，因此环境变量 VAR 的设置将不存在于第二个命令的上下文中（因为它们是两个被执行的 shell）。如果您想使用 JSch 流式传输一系列命令，您可能应该查看 ChannelShell 类。您可以通过调用来利用它：

```
ChannelShell chnl = (ChannelShell)sess.openChannel("shell"); 
```

这将打开一个长期存在的交互式 shell，您可以在其中执行一系列命令，并使第一个命令的结果影响第二个命令。使用它确实增加了相当多的复杂性，因此它不是“exec”的直接替代品。我建议查看 JSch 发行版附带的各种示例。他们中的许多人使用 openChanell("shell") 技术，他们可能会帮助你。

# scala - Java / Scala中的内存olap /数据透视表中是否有数据结构/库？

> ID：12980043
> 
> 赞同：8
> 
> 时间：2012-10-19T18:11:43.640
> 
> 标签：scala, data-structures, olap

## 相关问题

这个问题非常相关，但已有 2 年历史：[In memory OLAP engine in Java](https://stackoverflow.com/questions/4510343/in-memory-olap-engine-in-java)

## 背景

我想在内存中从给定的表格数据集中创建一个类似数据透视表的矩阵

例如，按婚姻状况计数的年龄（行是年龄，列是婚姻状况）。

*   **输入**：人员列表，包括年龄和一些布尔属性（例如已婚），

*   **期望的输出**：人数，按年龄（行）和已婚（列）

## 我尝试过的（Scala）

```
case class Person(val age:Int, val isMarried:Boolean)

...
val people:List[Person] = ... //

val peopleByAge = people.groupBy(_.age)  //only by age
val peopleByMaritalStatus = people.groupBy(_.isMarried) //only by marital status 
```

我设法以幼稚的方式做到这一点，首先按年龄分组，然后按婚姻状况`map`进行 分组`count`，并输出结果，然后我`foldRight`进行汇总

```
TreeMap(peopleByAge.toSeq: _*).map(x => {
    val age = x._1
    val rows = x._2
    val numMarried = rows.count(_.isMarried())
    val numNotMarried = rows.length - numMarried
    (age, numMarried, numNotMarried)
}).foldRight(List[FinalResult]())(row,list) => {
     val cumMarried = row._2+ 
        (if (list.isEmpty) 0 else list.last.cumMarried) 
     val cumNotMarried = row._3 + 
        (if (list.isEmpty) 0 else l.last.cumNotMarried) 
     list :+ new FinalResult(row._1, row._2, row._3, cumMarried,cumNotMarried) 
}.reverse 
```

我不喜欢上面的代码，效率不高，难以阅读，而且我确信有更好的方法。

## 问题

我如何按“两者”分组？以及如何对每个子组进行计数，例如

> 有多少人正好30岁结婚？

另一个问题，是我如何做一个总计，来回答这个问题：

> 30岁以上结婚的有多少？

* * *

**编辑：**

谢谢你所有的好答案。

只是为了澄清，我希望输出包含一个带有以下列的“表”

*   年龄（升序）
*   已婚
*   未婚人数
*   运行总已婚
*   跑步总未婚

不仅要回答这些特定的查询，还要生成一份报告，以便回答所有此类问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:02:58.643

你可以

```
val groups = people.groupBy(p => (p.age, p.isMarried)) 
```

进而

```
val thirty_and_married = groups((30, true))._2
val over_thirty_and_married_count = 
  groups.filterKeys(k => k._1 > 30 && k._2).map(_._2.length).sum 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-20T03:31:15.707

这是一个更冗长的选项，但以通用方式而不是使用严格的数据类型来执行此操作。你当然可以使用泛型来使它更好，但我想你明白了。

```
/** Creates a new pivot structure by finding correlated values 
  * and performing an operation on these values
  *
  * @param accuOp the accumulator function (e.g. sum, max, etc)
  * @param xCol the "x" axis column
  * @param yCol the "y" axis column
  * @param accuCol the column to collect and perform accuOp on
  * @return a new Pivot instance that has been transformed with the accuOp function
  */
def doPivot(accuOp: List[String] => String)(xCol: String, yCol: String, accuCol: String) = {
  // create list of indexes that correlate to x, y, accuCol
  val colsIdx = List(xCol, yCol, accuCol).map(headers.getOrElse(_, 1))

  // group by x and y, sending the resulting collection of
  // accumulated values to the accuOp function for post-processing
  val data = body.groupBy(row => {
    (row(colsIdx(0)), row(colsIdx(1)))
  }).map(g => {
    (g._1, accuOp(g._2.map(_(colsIdx(2)))))
  }).toMap

  // get distinct axis values
  val xAxis = data.map(g => {g._1._1}).toList.distinct
  val yAxis = data.map(g => {g._1._2}).toList.distinct

  // create result matrix
  val newRows = yAxis.map(y => {
    xAxis.map(x => {
      data.getOrElse((x,y), "")
    })
  })

 // collect it with axis labels for results
 Pivot(List((yCol + "/" + xCol) +: xAxis) :::
   newRows.zip(yAxis).map(x=> {x._2 +: x._1}))
} 
```

我的 Pivot 类型非常基本：

```
class Pivot(val rows: List[List[String]]) {

  val headers = rows.head.zipWithIndex.toMap
  val body    = rows.tail
  ...
} 
```

为了测试它，你可以做这样的事情：

```
val marriedP = Pivot(
  List(
    List("Name", "Age", "Married"),
    List("Bill", "42", "TRUE"),
    List("Heloise", "47", "TRUE"),
    List("Thelma", "34", "FALSE"),
    List("Bridget", "47", "TRUE"),
    List("Robert", "42", "FALSE"),
    List("Eddie", "42", "TRUE")

  )
)

def accum(values: List[String]) = {
    values.map(x => {1}).sum.toString
}
println(marriedP + "\n")
println(marriedP.doPivot(accum)("Age", "Married", "Married")) 
```

产生：

```
Name     Age      Married  
Bill     42       TRUE     
Heloise  47       TRUE     
Thelma   34       FALSE    
Bridget  47       TRUE     
Robert   42       FALSE    
Eddie    42       TRUE     

Married/Age  47           42           34           
TRUE         2            2                         
FALSE                     1            1 
```

好处是您可以使用柯里化来传递任何函数的值，就像在传统的 excel 数据透视表中一样。

更多可以在这里找到：[https ://github.com/vinsonizer/pivotfun](https://github.com/vinsonizer/pivotfun)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T18:55:53.047

我觉得直接用s`count`上的方法会更好`List`

对于问题 1

```
people.count { p => p.age == 30 && p.isMarried } 
```

对于问题 2

```
people.count { p => p.age > 30 && p.isMarried } 
```

如果您还想要符合这些谓词的实际人群使用过滤器。

```
people.filter { p => p.age > 30 && p.isMarried } 
```

您可能可以通过只进行一次遍历来优化这些，但这是一个要求吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T19:13:27.183

您可以使用元组进行分组：

```
val res1 = people.groupBy(p => (p.age, p.isMarried)) //or
val res2 = people.groupBy(p => (p.age, p.isMarried)).mapValues(_.size) //if you dont care about People instances 
```

你可以这样回答这两个问题：

```
res2.getOrElse((30, true), 0)
res2.filter{case (k, _) => k._1 > 30 && k._2}.values.sum
res2.filterKeys(k => k._1 > 30 && k._2).values.sum // nicer with filterKeys from Rex Kerr's answer 
```

您可以使用 List 上的方法计数来回答这两个问题：

```
people.count(p => p.age == 30 && p.isMarried)
people.count(p => p.age > 30 && p.isMarried) 
```

或使用过滤器和大小：

```
people.filter(p => p.age == 30 && p.isMarried).size
people.filter(p => p.age > 30 && p.isMarried).size 
```

编辑：您的代码稍微干净的版本：

```
TreeMap(peopleByAge.toSeq: _*).map {case (age, ps) =>
    val (married, notMarried) = ps.span(_.isMarried)
    (age, married.size, notMarried.size)
  }.foldLeft(List[FinalResult]()) { case (acc, (age, married, notMarried)) =>
    def prevValue(f: (FinalResult) => Int) = acc.headOption.map(f).getOrElse(0)
    new FinalResult(age, married, notMarried, prevValue(_.cumMarried) + married, prevValue(_.cumNotMarried) + notMarried) :: acc
  }.reverse 
```

# python - 我需要填充颜色来读取 Python 中的值

> ID：12980045
> 
> 赞同：3
> 
> 时间：2012-10-19T18:11:51.143
> 
> 标签：python, function

我正在设置两个定义，我希望从 drawBar 中读取填充颜色。程序未读取与该值对应的正确颜色。

```
import turtle

wn = turtle.Screen()             # Set up the window
wn.bgcolor("white")

tess = turtle.Turtle()  
tess.penup()
tess.goto(-100,-75)
tess.pendown()

def drawBar(t, height):
    """ Get turtle t to draw one bar, of height. """
    t.left(90) 
    t.begin_fill()# Point up
    t.forward(height)
    # Draw up the left side
    t.right(90)
    t.forward(40)            # width of bar, along the top
    t.right(90)
    t.forward(height) 
    t.end_fill()# And down again!
    t.left(90)   

def drawColor(t, height):
    drawBar(t, height)
    if height >= 200:
         return tess.fillcolor("red")
    elif height  < 200 and v >= 100:
         return tess.fillcolor("yellow")
    elif height < 100: 
         return tess.fillcolor("green")

xs = [48, 117, 200, 240, 160, 260, 220]

for v in xs:                 # assume xs and tess are ready
    drawColor(tess, v) 
```

我不知道为什么这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:21:17.530

更改`drawColor`为：

```
def drawColor(t, height):    
    if height >= 200:
         t.fillcolor("red")
    elif height  < 200 and height >= 100:
         t.fillcolor("yellow")
    elif height < 100: 
         t.fillcolor("green")
    drawBar(t, height) 
```

这样，您首先根据当前高度设置正确的颜色，然后绘制条形图。在您的原始代码中，您正在绘制一个具有当前颜色的条（从默认颜色黑色开始），然后更改要绘制的颜色，因此每个新条都以最后一个应该具有的颜色绘制。

在您的原始代码中也存在一些其他问题。您不使用传递的 turtle 对象`t`，而是使用全局对象`tess`。也不需要返回`fillcolor`调用的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:19:14.577

我认为您在提及`height`测试时可能有错字：

```
elif height  < 200 and v >= 100:
     return tess.fillcolor("yellow") 
```

应该是：

```
elif 100 <= height < 200:
     return tess.fillcolor("yellow") 
```

`v`可能是在全局范围内找到的，而不是您想要测试的。

此外，您正在传递对海龟对象的引用，但您没有使用它：

```
def drawColor(t, height):
    drawBar(t, height)
    if height >= 200:
         # return tess.fillcolor("red")
         return t.fillcolor("red")
    ... 
```

# objective-c - shouldOptimizeForNetworkUse 实际上做了什么？

> ID：12980047
> 
> 赞同：27
> 
> 时间：2012-10-19T18:11:58.230
> 
> 标签：objective-c, ios, avfoundation, avassetwriter, avassetexportsession

从[Apple文档](http://developer.apple.com/library/ios/DOCUMENTATION/AVFoundation/Reference/AVAssetWriter_Class/Reference/Reference.html#//apple_ref/occ/instp/AVAssetWriter/shouldOptimizeForNetworkUse)中它只是说：

> 当此属性的值为 YES 时，将写入输出文件，即只需下载少量文件即可开始播放。

但实际发生了什么？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-01-09T19:22:27.537

当 shouldOptimizeForNetworkUse 设置为 YES 时，调用 finishWriting 会将 MP4 moov atom（电影原子）从文件末尾移动到文件开头。moov atom 包含有关电影文件的信息，例如时间刻度和持续时间。moov 还包含“子原子”，其中包含轨道、文件中的数据偏移等信息。

只能使用 moov atom 中的信息进行播放，并且当它位于文件的开头而不是文件的末尾时，电影播放器​​可以开始播放文件，即使它只加载了文件的开头。

在实践中，现代浏览器将使用 HTTP/1.1 Range 标头从文件末尾获取 moov atom 以加载 moov atom，即使它位于文件末尾。

将 shouldOptimizeForNetworkUse 设置为 YES 也有一些副作用：

*   完成电影需要更长的时间，因为必须修改文件以及原子中的偏移量。
*   输出文件被锁定且不可访问，因为完成写入需要修改整个文件（移动和更新原子）。当设置为 NO 时，movieFragmentInterval 设置写入输出视频文件的刷新间隔，使文件在写入期间可读，因为片段以其最终形式刷新到文件中。finishWriting 只需要将 moov 原子附加到文件的末尾，而不是触及已经写入的片段。

# python - 在 python 中调用程序

> ID：12980049
> 
> 赞同：0
> 
> 时间：2012-10-19T18:12:11.507
> 
> 标签：python, python-2.7

有没有办法让一个程序在 python 中调用另一个程序？

让我解释一下我的问题：

1.  我正在构建一个应用程序（程序 1），我还在编写一个调试器来捕获程序 1 `{ a typical try : except: }`代码块中的异常（程序 2）。现在我想发布程序 2，这样对于像 prog 1 这样的任何应用程序，prog 2 都可以处理异常（让我的工作更轻松）。我只希望 prog 1 使用一段简单的代码，例如：

    ```
    import prog2 
    ```

2.  我的困惑源于这样一个事实，即我该如何做这样的事情，如何在 prog 1 中调用 prog 2，即它应该像 prog 1 中的所有代码都应该在`{try: (prog 1) , except:}`prog 2 try 块中运行一样运行。

任何关于我如何做到这一点的指示或开始的方向，我们将不胜感激。

注意：我使用 python 2.7 和 IDLE 作为我的开发工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:22:53.533

我认为您需要考虑类而不是脚本。

那这个呢？

```
class MyClass:
    def __init__(self, t):
        self.property = t
        self.catchBugs()

    def catchBugs(self):
        message = self.property
        try:
            assert message == 'hello'
        except AssertionError:
            print "String doesn't match expected input"

a = MyClass('hell') # prints 'String doesn't match expected input' 
```

## 更新

我猜你的目录中有这样的东西：

*   `program1.py`（主程序）
*   `program2.py`（调试器）
*   `__init__.py`

### 程序1

```
from program2 import BugCatcher

class MainClass:    
   def __init__(self, a):       
      self.property = a

obj = MainClass('hell') 
bugs = BugCatcher(obj) 
```

### 程序2

```
class BugCatcher(object):
    def __init__(self, obj):
        self.obj = obj
        self.catchBugs()

    def catchBugs(self):
        obj = self.obj
        try:
            assert obj.property == 'hello'
        except AssertionError:
            print 'Error' 
```

在这里，我们将 program1 的整个对象传递给 program2 的 BugCatcher 对象。然后我们访问该对象的一些属性来验证它是否是我们所期望的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:15:22.270

试过`execfile()`了吗？阅读有关如何从脚本执行另一个脚本的信息。

# c++ - 查看数组中的指针是否为空（c++）

> ID：12980051
> 
> 赞同：3
> 
> 时间：2012-10-19T18:12:15.000
> 
> 标签：c++, visual-c++, pointers

我有一个指向名为 cPlayer 的类的指针数组。

编译器：Visual C++ 2010 Express

**在里面**

```
cPlayer* players[MAX_PLAYERS]; 
```

Max_Players 是一个定义值 10。定义在一个名为“OnlineData”的类中，在一个标题中。

**检查**

```
if (players[a]){
   // some code here
} 
```

无论我尝试过什么，它仍然可以通过 //some code here

**玩家被删除是这样的：**

```
players[player->id]=0;
delete player; 
```

**问题**

我想检查 player 数组中位置 a 的项目是否有值。我正在使用它来处理播放器列表（碎片整理）

该数组在添加内容时正常工作，直到我尝试执行上述操作

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T18:13:50.737

将指针初始化为空指针，可以这样完成：

```
cPlayer* players[MAX_PLAYERS] = {}; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-19T18:14:07.287

要初始化全局或本地数组，您将使用：

```
cPlayer* players[MAX_PLAYERS] = {}; 
```

但是，由于您的数组是类成员，因此您不能这样做（直到 C++11 引入了类内初始化，但 VS2010 不支持此功能）。相反，您必须编写代码在构造函数主体（或 init 函数或其他）中单独初始化每个成员：

```
struct S {
    cPlayer *players[MAX_PLAYERS];

    S() {
        for (int i=0; i<MAX_PLAYERS; ++i) {
            players[i] = NULL;
        }
    }
}; 
```

或者比使用显式循环更好的是使用来自 的东西`<algorithm>`，例如`std::fill`or `std::fill_n`：

```
std::fill_n(players, MAX_PLAYERS, NULL); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-19T18:14:42.777

初始化数组：- cPlayer* player[MAX_PLAYERS] = {};

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T18:28:29.517

将数组的所有值初始化为 NULL（在 处找到`<cstdlib>`）。然后，当您想为数组的某个位置分配一个值时，请编写：`players[i]=new cPlayer(...)`。要检查一个位置`a`是否为空，只需检查 if `players[a]==NULL`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T18:28:12.023

采用

`std::fill_n(players, 10, 0)`

将所有成员初始化为0..

# objective-c - Objective-C 中是否已经定义了“复数”？

> ID：12980052
> 
> 赞同：10
> 
> 时间：2012-10-19T18:12:19.380
> 
> 标签：objective-c, real-datatype

对于以下代码，

-Objective-C 怎么知道在复数上加一个“i”？当我在 Complex.m 文件中将“实数”和“虚数”定义为双精度值时，我认为 Xcode 只会知道“实数”和“虚数”是双精度值。

- 如果我在 main.m 文件中的复数末尾添加“i”，例如，如果我打开“myComplex.imaginary = 7;” 进入“myComplex.imaginary = 7i;” 该行的输出变为 0.00000i，如果我添加任何其他字母，程序将根本无法运行，这是为什么呢？

基本上，在我看来，Xcode 已经知道“真实”和“想象”的含义，我正在关注的书没有具体说明这一点，所以我有点困惑。

另外，我应该注意，我没有创建以下代码，因为我自己无法找出问题所在，此代码是从我的图书论坛的成员那里复制的。

```
//  Complex.h

#include <Foundation/Foundation.h>

@interface Complex : NSObject
@property double real, imaginary;
-(void) print;
-(Complex *) add: (Complex *) complexNum;
-(Complex *) subtract: (Complex *) complexNum;
-(Complex *) multiply: (Complex *) complexNum;
-(Complex *) divide: (Complex *) complexNum;
@end

//  Complex.m

#import "Complex.h"

@implementation Complex
@synthesize real, imaginary;

-(void) print
{
    NSLog(@"%f + %fi", real, imaginary);
}
-(Complex *) add: (Complex *) complexNum
{
    Complex *result = [[Complex alloc]init];
    result.real = real + complexNum.real;
    result.imaginary = imaginary + complexNum.imaginary;
    return result;
}
-(Complex *) subtract: (Complex *) complexNum
{
    Complex *result = [[Complex alloc]init];
    result.real = real - complexNum.real;
    result.imaginary = imaginary - complexNum.imaginary;
    return result;
}
-(Complex *) multiply: (Complex *) complexNum
{
    Complex *result = [[Complex alloc]init];
    result.real = real * complexNum.real;
    result.imaginary = imaginary * complexNum.imaginary;
    return result;
}
-(Complex *) divide: (Complex *) complexNum
{
    Complex *result = [[Complex alloc]init];
    result.real = real / complexNum.real;
    result.imaginary = imaginary / complexNum.imaginary;
    return result;
}
@end

//
//  main.m
//  Complex

#include <Foundation/Foundation.h>
#import "Complex.h"

int main(int argc, const char *argv[]) {

    @autoreleasepool {
        Complex *myComplex = [[Complex alloc]init];
        Complex *totalComplex = [[Complex alloc]init];
        Complex *yourComplex = [[Complex alloc]init];

        myComplex.real = 5.3;
        myComplex.imaginary = 7;
        [myComplex print];
        NSLog(@"+");

        yourComplex.real = 2.7;
        yourComplex.imaginary = 4;
        [yourComplex print];
        NSLog(@"=");

        totalComplex = [myComplex add: yourComplex];
        [totalComplex print];
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-19T18:21:50.257

复数类型在[C99](http://en.wikipedia.org/wiki/C99)中定义，现代版本的 Objective-C 是它的超集。[实际语法如下](http://ideone.com/ZjHeC)：

```
#include <complex.h>

...

complex double z = 2.7 + 3.4*I;
complex double w = 4.5 - 1.7*I;
complex double t = z*w;
printf("%g + %gi", creal(t), cimag(t)); 
```

该`i`后缀是[来自 GCC 的扩展](http://gcc.gnu.org/onlinedocs/gcc/Complex.html)。Xcode 使用的编译器（clang）大部分功能都兼容 GCC，因此您可以编写`3.4i`并且没有错误。

* * *

对于你的问题，

> *   Objective-C 怎么知道在复数上加一个“i”？

如果您指的是输出，那么没有 Objective-C 不知道添加“i”。它打印“i”只是因为你告诉它

```
-(void) print
{
    NSLog(@"%f + %fi", real, imaginary);
//                 ^
} 
```

> *   如果我打开“myComplex.imaginary = 7;” 进入“myComplex.imaginary = 7i;” 该行的输出变为 0.00000i

因为 7i 是一个虚数，并且`myComplex.imaginary`是一个“双”，所以是一个*实*数。C 标准建议，在实数和虚数之间进行转换时，您将得到零（C99 §G.4.2/1）。因此，您所写的内容实际上是`myComplex.imaginary = 0.0;`.

> *   如果我添加任何其他字母，程序将根本无法运行，这是为什么呢？

实际上，您可以编写类似`7.0if`. 同样，这是一个 C 的东西，Objective-C 已经适应了。您可以添加一个`f`将十进制数从默认类型“double”转换为“float”，并且 GCC 添加了一个额外的功能，您可以添加一个`i`将实数转换为虚数的功能。其他足够`7.0x`的东西会导致编译器停止，因为它不知道是什么`x`意思。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-19T18:25:03.977

C99 添加了对复数的原生支持，因此现在它们与普通浮点数或整数一样易于处理。不再有丑陋的结构！据推测，通过对数字的浮点表示进行技巧，the`_Complex_I`和等效的`I`宏具有一个值，当乘以实数时，会产生一个数字类型`double complex`或`float complex`(`complex`是一个新的类型修饰符关键字，也在 C99 中引入) . 因此，有了这个新的便利功能，您可以像在 C 中一样轻松地执行复数计算

```
#include <complex.h>

double complex z1 = 2.0 + 3.0 * I;
double complex z2 = 1.5 - 2.0 * I;
double complex prod = z1 * z2;

printf("Product = %f + %f\n", creal(prod), cimag(prod)); 
```

请同时查看[GNU 解释](http://www.gnu.org/software/libc/manual/html_node/Complex-Numbers.html)。

后缀是 C99 语言的`i`GNU 扩展，因此它是非标准的。尽管如此，Xcode 使用的两个编译器（GCC 和 Clang）都实现了这个扩展。

（旁注：Xcode**对此一无所知**。请不要将 IDE 与编译器混淆。Xcode 本身不执行编译 - 它背后的编译器执行。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T13:17:40.417

这是我为我的项目开发的复数操作类。可能对某人有用。它包含标准的加法、减法、乘法和除法方法。此外，它还具有计算模数和复数自变量的方法。最后，它具有计算转向因子（复指数）的类方法，这对于处理快速傅里叶变换时的“蝴蝶”算法很有用

```
#import <Foundation/Foundation.h>

@interface Complex : NSObject
@property double re, im;
-(Complex *)add :(Complex *) n;
-(Complex *)sub :(Complex *) n;
-(Complex *)mul :(Complex *) n;
-(Complex *)div :(Complex *) n;
+(Complex *)wkn :(int) k :(int) n;
-(double)mod;
-(double)arg;
@end

#import "Complex.h"

@implementation Complex
@synthesize re, im;
// Addition of two complex numbers
-(Complex *)add:(Complex *)n
{
    Complex *res = [[Complex alloc]init];
    res.re = re + n.re;
    res.im = im + n.im;
    return res;
}
// Subtraction of two complex numbers
-(Complex *)sub:(Complex *)n
{
    Complex *res = [[Complex alloc]init];
    res.re = re - n.re;
    res.im = im - n.im;
    return res;
}
// Multiplication of two complex numbers
-(Complex *)mul:(Complex *)n
{
    Complex *res = [[Complex alloc]init];
    res.re = re * n.re - im * n.im;
    res.im = re * n.im + im * n.re;
    return res;
}
// Division of two complex numbers
-(Complex *)div: (Complex *)n
{
    Complex *res = [[Complex alloc]init];
    double A = (pow(n.re, 2.0) + pow(n.im, 2.0));
    res.re = (re * n.re - im * n.im) / A;
    res.im = (im * n.re - re * n.im) / A;
    return res;
}
// Modulus of complex number
-(double)mod
{
    double res = sqrt(pow(re, 2.0) + pow(im, 2.0));
    return res;
}
// Argument of complex number
-(double)arg
{
    double res; int quad;
    if (re == 0 && im > 0) res = M_PI_2;
    else if (re == 0 && im < 0) res = 3 * M_PI_2;
    else
    {
        if (re > 0 && im >= 0) quad = 1;
        else if (re < 0 && im >= 0) quad = 2;
        else if (re < 0 && im < 0) quad = 3;
        else if (re > 0 && im < 0) quad = 4;
        double temp = atan(im / re);
        switch (quad)
        {
            case 1:
                res = temp;
                break;
            case 4:
                res = 2 * M_PI + temp;
                break;
            case 2: case 3:
                res = M_PI + temp;
                break;
        }
    }
    return res;
}
// Turning factor calculation for "butterfly" FFT algorithm
+(Complex *)wkn:(int)k :(int)n
{
    Complex *res = [[Complex alloc]init];
    res.re = cos(2 * M_PI * k / n);
    res.im = -sin(2 * M_PI * k / n);
    return res;
}

@end 
```

谢谢你的耐心 ）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T21:23:36.773

类 Complex 的实现有两个严重的错误——复数以绝对错误的方式相乘和除法！仅仅将两个复数的实部和虚部相乘或相除是绝对不够的。在这种情况下你必须使用乘法和除法公式，我认为谷歌包含很多关于它的条目。现在它是错误的代码，必须重写。

对于乘法，它必须是这样的

```
-(Complex *)mul:(Complex *)n
{
    Complex *res = [[Complex alloc]init];
    res.re = re * n.re - im * n.im;
    res.im = re * n.im + im * n.re;
    return res;
} 
```

# stata - 将值存储在宏变量中

> ID：12980061
> 
> 赞同：2
> 
> 时间：2012-10-19T18:12:47.620
> 
> 标签：stata, stata-macros

我正在使用该`levelsof`命令来识别变量的唯一值并将它们粘贴到宏中。然后稍后我想使用宏中的这些值从我将加载的另一个数据集中选择记录。

我想到的是以下几点：

```
keep if inlist(variable, "`macrovariable'") 
```

那样有用吗？还有其他更有效的选择吗？我可以在 R 中轻松做到这一点（因为向量比宏更容易使用），但这个项目需要 Stata。

* * *

**澄清：**

如果我有一个具有三个唯一值和的变量`a`，我想将它们存储在一个宏变量中，以便稍后获取另一个数据集并选择与其中一个值匹配的观察值。`b``c`

通常可以使用该`inlist`函数手动执行此操作，但我想对其进行软编码，以便我可以使用不同的值集运行程序。而且我无法使该`inlist`功能与宏一起使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-21T00:33:56.440

```
* the source data
levelsof x, local( allx )
* make it -inlist-friendly
local allxcommas : subinstr local allx  " " ", ", all
* bring in the new data
use using blah.dta if inlist(x, `allxcommas') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-18T16:21:26.667

`levelsof`我怀疑您使用with生成的宏的困难`inlist`在于您忘记使用该`separate(,)`选项。我也不相信你可以使用这个`inlist`函数`keep if`——你需要添加额外的步骤来定义一个新的指标。

在下面的示例中，我使用了 1978 年的汽车数据并创建了一个`make_abb`汽车制造商（或制造商）变量，该变量仅采用少数不同的值（道奇的“Do”等）。

然后，我使用该`levelsof`命令生成制造商的本地宏，该宏的制造商具有维修记录不佳的车型（该变量`rep78`是分类维修记录变量，其中 1 为不良，5 为良好）。该选项`separate(,)`是将逗号添加到宏中并允许 inlist 稍后读取它。

最后，如果我想删除没有不良维修记录的制造商*，*我会生成一个名为“keep_me”的虚拟变量并使用 inlist 函数填充它。

```
*load some data
sysuse auto 
*create some make categories by splitting the make and model string
gen make_abb=substr(make,1,2)
lab var make_abb "make abbreviation (string)"
*use levelsof with "local(macro_name)" and "separate(,)" options
levelsof make_abb if rep78<=2, separate(,) local(make_poor)
*generate a dummy using inlist and your levelsof macro from above
gen keep_me=1 if inlist(make_abb,`make_poor')
lab var keep_me "dummy of makes that had a bad repair record"
*now you can discard the rest of your data
keep if keep_me==1 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-20T17:10:54.617

这似乎对我有用。

```
* "using" data
clear
tempfile so
set obs 10
foreach v in list a b c d {
    generate `v' = runiform()
}
save `so'

* "master" data
clear
set obs 10
foreach v in list e f g h {
    generate `v' = runiform()
}

* merge
local tokeepusing a b
merge 1:1 _n using `so', keepusing(`tokeepusing') 
```

产量：

```
. list

     +------------------------------------------------------------------------------------------+
     |     list          e          f          g          h          a          b        _merge |
     |------------------------------------------------------------------------------------------|
  1\. | .7767971   .5910658   .6107377   .7256517    .357592   .8953723   .0871481   matched (3) |
  2\. |  .643114   .6305301   .6441092   .7770287   .5247816   .4854506   .3840067   matched (3) |
  3\. | .3833295    .175099   .4530386   .5267127    .628081   .2273252   .0460549   matched (3) |
  4\. | .0057233   .1090542   .1437526   .3133509    .604553   .9375801   .8091199   matched (3) |
  5\. | .8772233   .6420991   .5403687   .1591801   .5742173   .8948932   .4121684   matched (3) |
     |------------------------------------------------------------------------------------------|
  6\. | .6526399   .5137199    .933116   .5415702   .4313532   .8602547   .5049801   matched (3) |
  7\. | .2033027   .8745837      .8609   .0087578   .9844069   .1909852   .3695011   matched (3) |
  8\. | .6363281   .0064866   .6632325    .307236   .9544498   .6267227   .2908498   matched (3) |
  9\. |  .366027   .4896181   .0955155   .4972361   .9161932   .7391482    .414847   matched (3) |
 10\. | .8637221   .8478178   .5457179   .8971257   .9640535    .541567   .1966634   matched (3) |
     +------------------------------------------------------------------------------------------+ 
```

这回答了你的问题了吗？如果没有，请发表评论。

# asp.net - 如何将子文件夹指向 asp.net 网站

> ID：12980062
> 
> 赞同：1
> 
> 时间：2012-10-19T18:12:51.700
> 
> 标签：asp.net, iis, subdomain, subdirectory

简单来说：我有一个网站（iis 7.5 上的 asp.net 4），我们称之为 mysite.com。我开发了自己的博客，这也是一个 asp.net 4 网站解决方案（不是 Web 应用程序）。为了 SEO，我希望搜索引擎和访问者在地址栏中看到 mysite.com/blog。

您会发现很多帖子都说子文件夹解决方案更适合子域，但没有一个说明如何实现它。

我发现的一种解决方案涉及反向代理并在例如安装博客。博客/mysite.com。这反过来又需要我的主机 (unoeuro.com) 不提供的应用程序请求路由。

有谁做过同样的练习并有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:21:14.483

好的。没有简单的解决方案，但我现在已经完成了我的[博客引擎](http://wblogengine.net/ "博客")。您可以免费下载它（带有源代码）。它可以作为独立博客安装在子域和/或子文件夹中，无需任何额外设置。

顺便说一句，它在 Visual Basic 中。

# php - 如何使用 API 安全地与两个 Web 应用程序进行黑白通信？

> ID：12980066
> 
> 赞同：0
> 
> 时间：2012-10-19T18:13:04.613
> 
> 标签：php, api, oauth

我有一个主网站（包含所有数据）和多个从主网站获取数据的客户网站。每个客户网站都可以访问主网站上的不同数据集。我想为此创建一个基于 PHP 的 Web API。这是我的第一个 API，所以我不确定什么是最好和最安全的方法。

经过一番谷歌搜索后，我发现 OAuth 是 API 最常见的身份验证方法。但是在我的情况下，我希望客户端网站配置一次，然后通信应该是自动的，即通信应该在后台进行，没有任何用户干预。这种情况是否需要 OAuth？

或者我可以在这里实施任何其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:25:10.507

oauth 是一种复杂的实现方式来满足您的需求。

如果您使用的是休息，我建议在标头中使用基本身份验证并使用 SSL，以便您的通信被加密。

您可以制作一个小的 SecurityFilter 来检查任何带有 url 模式**/api/**的请求是否基本身份验证是正确的并且它使用 SSL ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:27:43.683

这实际上取决于您如何公开 API。

如果您使用的是 REST，则基于 HTTPS 的 HTTP Basic Auth 就足够了。当提供的方法足够时，我看到很多人尝试实施自己的解决方案。

如果您使用的是 SOAP，则可以使用一种基于 SOAP 的方法：WS-Security（它只是一个使用从 SAML 断言到 OAuth 令牌的任何东西的标准）。

如果通过 HTTPS 传递基本身份验证凭据对您来说过于“开放”，因为凭据保存在客户端服务器的某个配置中，那么 OAuth2 可能是最好的解决方案。在服务器端执行 OAuth 不需要任何用户交互。您只需将令牌存储在服务器配置中，然后让 OAuth 库处理其余的事情。PHP 有一个用于此[PHP OAuth 库的库](http://www.php.net/manual/en/oauth.examples.fireeagle.php)。有很多用于 PHP 的 OAuth2 库。只需谷歌它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:57:20.307

经过更多的谷歌搜索和研究，我找到了我的问题的答案：

我解释的场景是 2-legged oauth 的示例（可以找到很多关于 2-legged 和 3-legged oauth 的文章）

此外，OAuth 实现起来并不难，事实上对于熟悉 API 和 Auth 系统的开发人员来说非常容易。

这是一个非常好的 php OAuth 库的链接，带有示例代码[http://code.google.com/p/oauth-php/](http://code.google.com/p/oauth-php/)

# php - jQuery ajax 调用在 Mac Safari 和 Chrome 浏览器上返回空错误

> ID：12980068
> 
> 赞同：7
> 
> 时间：2012-10-19T18:13:07.840
> 
> 标签：php, jquery, ajax

几天来，我一直在寻找解决方案并尝试修复，但没有任何变化。

老板在一台 Mac 上，而我没有，所以我让他尝试重复修复并将输出转发给我。到目前为止还没有运气。

因此，当前设置是，我有一个包含用户名和密码输入的表单，在通过验证后提交。验证是一个 ajax 调用，它验证用户名和密码，然后提交表单。

只有在 Mac Chrome 和 Safari (webkit) 上，我从 ajax 调用中得到一个错误响应，它是空白的。

我已经剥离了执行验证的 php 函数以简单地回显“hello”，这样我就知道不是 php 导致了问题。

因此，一旦单击目标元素，我就会获取用户名和密码值并发送 ajax 请求。（这应该打我的 php 文件，只是回显你好）。然而，它返回并没有任何消息的错误。我的意思是 xhr responseText 和 throwedError 都只是空白/空。

所以这里是代码：（HTML）

```
<form id="signin_form" method="POST" action="index.php?cmd=Signin">
        <table id="welcomeSignin">
            <tr>
            <td>
                    <div class="welcome"><span class="signin-title-text f-xxlarge-or-link-goth">Welcome Back!</span></div>
                    <div id="error_msg"></div>
                    <table id="input_field_table">
                        <tr>
                                <td class="input-field-cell">
                                    <div class="singin-titles f-medium-gr-bold">Username</div>
                                </td>
                                <td class="input-field-cell">
                                    <div class="signin-inputs"><input class="signin styled" type="text" name="user_name"></div>
                                </td>
                        </tr>
                        <tr>
                            <td class="input-field-cell">
                                <div class="singin-titles f-medium-gr-bold">Password</div>
                            </td>
                            <td class="input-field-cell">
                                <div class="signin-inputs"><input class="signin styled" type="password" name="user_pass"></div>
                                <div class="forgot"><a href="" class="forgot-password f-small-or-link">Forgot your password?</a></div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <input type="hidden" name="post_type" value="signin">
                                <span id="create"><span class="f-medium">Don't have an account? <a href="" class="create"><span class="f-medium-or-link">click here</span></a></span></span> &nbsp;
                                <span class="active-login"><input type="checkbox" class="signin-radio" name="active_login"> <span class="f-medium"> Keep me signed in</span></span>
                                <div id="sign_in"><span class="signin-submit-button"><img src="../images/ready-create-icon.png"></span> <span class="signin-submit-text f-xxxlarge-gr-title-link">Sign In!</span></div>
                            </td>
                       </tr>
                    </table>
                </td>
            </tr>
    </table> 
```

那里没什么特别的。这是jquery片段：

```
$('#sign_in').click(function(){
    var url = window.location.href;
    $('#error_msg').html('');
    var username = $('input[name="user_name"]').val();
    var password = $('input[name="user_pass"]').val();
    var err = '';
    $.ajax({
        url: ajaxUrl+'validate_signin',
        type: 'GET',
        cache: false,
        data: { username: encodeURIComponent(username), password: encodeURIComponent(password)},
        success: function(data, status, xhr){
            if(data !== 'OK'){
                err = data;
                $('#error_msg').html(err);
                return false;
            }else{
                $('#signin_form').submit();
                return false;
            }
        },
        error: function(xhr, ajaxOptions, thrownError){
            var tmp_err = "";
            tmp_err = ":: "+xhr.responseText+" :: "+xhr.responseXML+" :: ";
            alert(tmp_err);
            alert(xhr.responseText);
            alert(thrownError);
            window.location.href = url;
            }
        });
        return false;
}); 
```

php 文件只是： echo "hello"; 出口; 只是为了避免任何测试错误。

这里有几件事，我添加了 encodeURIComponent() ，因为我确实看到了一篇描述特殊字符和空格问题的帖子。（没有工作）成功：我包含了 status 和 xhr vars 只是为了正常调试我只是有数据。

现在出错了：这是每次都会出现的情况，但是所有响应都是空白或未定义的。我希望得到某种体面的错误，但我什么也没得到。现在这仅适用于最近升级到 Mountian Lion 的 Mac 和 Webkit (Chrome/Safari) 浏览器。

我尝试在不使用 jQuery 的情况下只做 XMLHttpRequest，但我得到了同样的结果。

这适用于 PC 上的 IE、Firefox、Chrome 和 Safari，也适用于 Mac 上的 FireFox。

最后这对他有用，我相信在他升级之前。

任何帮助都会很棒。我正在拔头发，我在 jQuery 上比 php 更环保，所以希望你们中的一个可以帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T15:32:35.000

这是一个配置问题。如果输入的域没有前导 www，则会出现问题。在域名上。

添加 header('Access-Control-Allow-Origin: *'); 到 php 文件解决了这个问题。您可以指定特定域以允许或使用 *.

# c# - 处理 Hwnd IntPtr 的正确方法

> ID：12980072
> 
> 赞同：4
> 
> 时间：2012-10-19T18:13:40.167
> 
> 标签：c#, memory-leaks, handle

我试图弄清楚以下情况是否会产生内存泄漏。

我从 WebBrowser 控件获取窗口句柄（这是有原因的）

```
IntPtr p = webBrowser1.FindForm().Handle; 
```

稍后，我将在重写的 dispose 方法中释放该句柄

```
 protected override void Dispose(bool disposing)
    {
        hwnd = IntPtr.Zero;
        base.Dispose(disposing);
    } 
```

我的`Dispose`方法背后是否有一些邪恶的东西可能导致内存泄漏？

这对某些人来说可能很明显，但我正在寻找内存泄漏，所以我正在尝试验证每一行代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T18:37:30.147

将 HWND 设置为 IntPtr.Zero 没有任何意义。

IntPtr 是一种值类型，因此该变量中的值对任何内容都没有影响。它不会使任何对象保持活动状态。这只是一个您设置为 0 的数字。

如果您从现有窗口获得 HWND，则不应复制任何句柄，并且您不必释放它。当表单关闭时，HWND 将被销毁。

# mysql - 在mysql中使用多个外键连接表

> ID：12980075
> 
> 赞同：2
> 
> 时间：2012-10-19T18:13:51.107
> 
> 标签：mysql, sql, database, foreign-keys

我有一个包含以下信息的数据库表：

```
owner.primaryitowner, 
owner.secondaryitowner, 
owner.primarybusinessowner, 
owner.secondarybusinessowner 
```

问题是所有者仅存储为电子邮件。还有另一个表，我通常在内部加入用户`users.username = owner.primaryitowner`以获取`users.displayname`数据，以便正确读取数据。问题是我需要对所有 4 列执行此操作，并且当我只能弄清楚如何在查询中连接 1 列时。谢谢您的帮助

PS 我不能更改数据库我只是一个报告作者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:17:53.517

假设您想要所有所有者的所有显示名称，请尝试以下操作：

```
select u.displayname
from users u
inner join owners o on
    o.primaryitowner = u.username
    or o.secondaryitowner = u.username
    or o.primarybusinessowner = u.username
    or o.secondarybusinessowner = u.username 
```

# wcf - WCF 返回“动态”gzipstream

> ID：12980079
> 
> 赞同：4
> 
> 时间：2012-10-19T18:13:53.957
> 
> 标签：wcf, stream

我需要创建一个服务，它返回一个由一个或多个文件组成的 GZipStream。文件数量可能有数百个，每个文件可能占用超过 500MB。

是否可以在传输流时以某种方式将文件动态添加到 gzipstream 中？（以避免在需要将文件复制到流中时遇到内存不足异常）

ETC：

1.  将 fileA 复制到正在返回的流中。
2.  客户端开始读取流。
3.  读取 fileA 后（客户端），将 fileB 复制到流（服务器端）。
4.  客户端继续读取流。

...依此类推，直到没有更多文件为止。

顺便提一句。压缩文件并不重要，只需将它们组合成一个 zip 文件，这样客户端只需下载一个文件即可。

所以我的目标是：将多个文件作为一个文件流回客户端，而不在服务器上一次处理所有文件（以避免将所有文件加载到内存中，从而引发内存不足异常）。

这可以通过以某种方式创建自定义流来完成，还是有更简单的方法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:56:19.700

您可以将这些文件组合成磁盘上的单个 zip 文件，然后将该文件流式传输回来。

有关如何将文件组合到 zip 文件，请参阅：[c# sharpziplib 将文件添加到现有存档](https://stackoverflow.com/questions/1356003/c-sharp-sharpziplib-adding-file-to-existing-archive)

这解决了内存不足的问题，但这确实意味着您需要大量的磁盘空间。

# android - 拆包错误 Android

> ID：12980080
> 
> 赞同：2
> 
> 时间：2012-10-19T18:13:54.780
> 
> 标签：android, android-intent, nullpointerexception, parcelable, parcel

我遇到了一个问题，即`Object`从 a 实例化 a`Parcel`会抛出`NullPointerException`. My Class *Contact*实现`Parcelable`，包含一个 CREATOR，并且所有连接似乎都有效。*Contact*对象表示通讯簿中的联系人。使用的变量有以下类型：

```
String firstName, lastName, note;
List<String> emails, phones; 
```

构造函数将所有字符串初始化为 "" 并将所有列表初始化为空列表。和方法`writeToParcel`如下`Contact(Parcel in)`所示：

```
public void writeToParcel(Parcel out, int flags) {
    out.writeString(firstName);
    out.writeString(lastName);

    //If there are emails, write a 1 followed by the list. Otherwise, write a 0
    if (!emails.isEmpty())
    {
        out.writeInt(1);
        out.writeStringList(emails);
    }
    else
        out.writeInt(0);

    //If there are phone numbers, write a 1 followed by the list. Otherwise, write a 0
    if (!phones.isEmpty())
    {
        out.writeInt(1);
        out.writeStringList(phones);
    }
    else
        out.writeInt(0);
    out.writeString(note);
} 
```

...

```
public Contact(Parcel in)
{
    firstName = in.readString();
    Log.i(TAG, firstName);
    lastName = in.readString();
    Log.i(TAG, lastName);
    int emailsExist = in.readInt();
    if (emailsExist == 1)
        in.readStringList(emails);
    else
        emails = new ArrayList<String>();
    int phonesExist = in.readInt();
    if (phonesExist == 1)
        in.readStringList(phones);//Line 80, where this app breaks
    else
        phones = new ArrayList<String>();
    note = in.readString();
} 
```

我目前正在进行的测试提供了有效的名字和姓氏、一个电话号码和一张便条。我在打包这个包裹时得到的相关输出如下：

```
FATAL EXCEPTION: main
java.lang.RuntimeException: Failure delivering result ResultInfo...
...
Caused by: java.lang.NullPointerException
    at android.os.Parcel.readStringList(Parcel.java:1718)
    at com.mycompany.android.Contact.<init>(Contact.java:80) //This is the line marked above
    at com.mycompany.android.Contact$1.createFromParcel(Contact.java:40) //This is inside the CREATOR
    ... 
```

我做错了什么？数字不能写成字符串列表，还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:19:05.357

我只是多戳了几分钟，才意识到我的错误。该`readStringList`方法不能接收*空*参数。我的新`Contact(Parcel in)`方法如下：

```
public Contact(Parcel in)
{
    firstName = in.readString();
    Log.i(TAG, firstName);
    lastName = in.readString();
    Log.i(TAG, lastName);
    int emailsExist = in.readInt();
    emails = new ArrayList<String>();
    if (emailsExist == 1)
        in.readStringList(emails);
    int phonesExist = in.readInt();
    phones = new ArrayList<String>();
    if (phonesExist == 1)
        in.readStringList(phones);          
    note = in.readString();
} 
```

# r - 在 ggplot2 中创建堆叠密度图

> ID：12980081
> 
> 赞同：8
> 
> 时间：2012-10-19T18:13:56.933
> 
> 标签：r, ggplot2

我正在尝试在 ggplot2 中创建堆叠密度图，并且我还试图了解 qplot 相对于 ggplot 的工作原理。

我在网上找到了以下示例：

```
qplot(depth, ..density.., data=diamonds, geom="density", 
  fill=cut, position="stack") 
```

我尝试将其转换为对 ggplot 的调用，因为我想了解它是如何工作的：

```
ggplot(diamonds, aes(x=depth, y=..density..)) + 
  geom_density(aes(fill=cut, position="stack")) 
```

这会创建一个密度图，但不会**堆叠**它。

qplot 正在创建的内容与 ggplot 正在创建的内容有什么不同？

这是一个堆积密度图：

![堆积密度](../Images/be4eab1b964ecac0701381a8d84a1bfe.png)

非堆叠密度图：

![在此处输入图像描述](../Images/cf97f0b45e3bea22a089652254bbcda6.png)

原始示例在[这里](http://docs.ggplot2.org/0.9.2.1/stat_density.html)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-19T19:14:52.723

从@kohske 的评论来看，该职位不是一种审美，因此不应在`aes`通话中：

```
ggplot(diamonds, aes(x=depth, y=..density..)) + 
  geom_density(aes(fill=cut), position="stack") 
```

![在此处输入图像描述](../Images/53dc95b2a8a48bdd670c07dcc15c5905.png)

或使用电影数据（您的示例图表使用）：

```
ggplot(movies, aes(x=rating, y=..density..)) + 
  geom_density(aes(fill=mpaa), position="stack") 
```

![在此处输入图像描述](../Images/4a90967e8e7af4264be3ad334475df22.png)

# sendmail - 如果 sendmail 在主域上，我应该设置 spf 记录吗？

> ID：12980084
> 
> 赞同：0
> 
> 时间：2012-10-19T18:14:03.253
> 
> 标签：sendmail, spam, spf

我在同一个域上有一个 Web 服务器和 sendmail，其中带有确认码的信件被发送给用户。有时这些信件被标记为垃圾邮件，有时甚至没有送达。

由于主域缺少 spf 记录，问题是否存在？我知道这个问题可能很愚蠢..但我不知道为什么信件可以被标记为垃圾邮件:(

PS暂时我已经将谷歌邮件服务器和spf记录（在gmail上有团队邮箱）分配给我的域dns记录，但我相信这不会影响从我的服务器发送的正常邮件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:22:36.763

电子邮件传递有时会很棘手，尤其是人们为阻止垃圾邮件所做的一切。

我会阅读您的邮件服务器日志，看看您是否收到任何消息。有时，您可以通过这种方式检测服务器配置错误（例如，HELO 不正确）。SPF 也可能是其中的一部分。我会正确配置。

另外，我会查看收到并标记为垃圾邮件的邮件。有时，垃圾邮件过滤器会将有关邮件为何被标记为垃圾邮件的信息放在电子邮件标题中。通常它将是一个 [X-SOMETHING] 标头。参见，例如：[http ://www.ipswitch.com/support/imail/guide/2006/imail_server_wh/X_Header_Explanations.htm](http://www.ipswitch.com/support/imail/guide/2006/imail_server_wh/X_Header_Explanations.htm)

另外，我会查看 DNS 黑名单。只需检查您的服务器是否列在黑名单中。你可以看这里： http: [//mxtoolbox.com/blacklists.aspx](http://mxtoolbox.com/blacklists.aspx)

# numpy - Dtype 在 FROM 中工作，但在 IMPORT 中不工作

> ID：12980088
> 
> 赞同：5
> 
> 时间：2012-10-19T18:14:19.593
> 
> 标签：numpy, python-3.x, scipy

我发誓在问这个问题之前我已经阅读了几乎所有的“FROM vs IMPORT”问题。

在浏览我正在使用的 NumPy 教程时：

```
import numpy as np 
```

但是在声明矩阵的 dtype 时遇到了麻烦，例如：

```
a = np.ones((2,3),dtype=int32) 
```

我不断收到“NameError：名称'int32'未定义。” 我正在使用 Python v3.2，并且正在遵循随附的暂定教程。我用了：

```
from numpy import *
a = ones((2,3),dtype=int32) 
```

哪个有效。任何关于为什么会这样的见解将不胜感激。先感谢您！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T20:02:03.067

```
import numpy as np

#this will work because int32 is defined inside the numpy module
a = np.ones((2,3), dtype=np.int32)
#this also works
b = np.ones((2,3), dtype = 'int32') 

#python doesn't know what int32 is because you loaded numpy as np
c = np.ones((2,3), dtype=int32) 
```

回到你的例子：

```
from numpy import *
#this will now work because python knows what int32 is because it is loaded with numpy.
d = np.ones((2,3), dtype=int32) 
```

我倾向于使用字符串定义类型，如数组 b

# r - is.nan() 行为

> ID：12980095
> 
> 赞同：2
> 
> 时间：2012-10-19T18:15:06.763
> 
> 标签：r

创建了一个数据框：

```
simpleDF<- structure(list(vals = c(NA, NaN, 2)), .Names = "vals", row.names = c(NA, 
-3L), class = "data.frame")

> is.na(simpleDF$vals)
[1]  TRUE  TRUE FALSE
> is.nan(simpleDF$vals)
[1] FALSE  TRUE FALSE 
```

现在，当我更改数据框以包含字符串值时：

```
simpleDF <- structure(list(vals = structure(c(NA, 2L, 1L, 3L), .Label = c("2", 
"NaN", "test"), class = "factor")), .Names = "vals", row.names = c(NA, 
-4L), class = "data.frame")

> is.na(simpleDF$vals)
[1]  TRUE FALSE FALSE FALSE
> is.nan(simpleDF$vals)
[1] FALSE FALSE FALSE FALSE 
```

我不明白为什么`NaN`不再认可了`is.nan()`？当然会有解释..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T18:21:41.083

`NaN`是一个仅在数字向量中有意义的值，因此`"NaN"`当它所在的向量的类（显式或隐式）从数字转换为字符或因子时，它会转换为字符串。

```
vals
# [1]  NA NaN   2
as.character(vals)
# [1] NA    "NaN" "2" 
c(vals, "A")
# [1] NA    "NaN" "2"   "A" 
```

# c++ - 想在 Web 应用程序中使用本机 C 库，我有哪些选择？

> ID：12980097
> 
> 赞同：4
> 
> 时间：2012-10-19T18:15:14.813
> 
> 标签：c++, c, html, web-applications, libraries

我有许多用于数值分析和科学计算（例如模拟）的遗留 C 库，我想在我正在构建的 Web 应用程序中使用它们（到目前为止，我只使用 Javascript 来制作用户界面）。在客户端和/或服务器端执行此操作有哪些选择？我听说过将本机客户端与 chrome 一起使用，但我不喜欢客户端必须打开本机客户端标志才能执行此操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:26:08.570

在**服务器端**：

首先，CGI（通用网关接口）是能够在 Web 应用程序中使用本机 C 库的最基本方法 - 其中您委托可执行文件（例如用 C 编写）来生成服务器端 Web 内容。

但是 CGI 非常原始且效率低下。每个命令都可能导致在`Process`服务器上创建一个新命令。因此，这里有其他可行的替代方案：

1.  Apache 模块允许您在 Web 服务器本身内运行第三方软件。
2.  [FastCGI](http://en.wikipedia.org/wiki/FastCGI) - 单个进程处理多个用户请求。
3.  [SCGI](http://en.wikipedia.org/wiki/Simple_Common_Gateway_Interface) - 简单的 CGI

参考：[http ://en.wikipedia.org/wiki/Common_Gateway_Interface#Alternatives](http://en.wikipedia.org/wiki/Common_Gateway_Interface#Alternatives)

在**客户端**：

好消息和坏消息：

您可以在 chrome 中使用 PNaCl（便携式本机客户端）。它将**默认**打开。
但是第一次公开发布*预计*在 2013 年底。[寻找 PNaCl](http://en.wikipedia.org/wiki/Google_Native_Client)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:32:15.377

你不能在客户端做很多事情——你不可能期望客户端拥有这些库，也没有安全的方式来下载和运行它们。

最简单的方法是以任何您想要的方式编写服务器端，并通过 Web 界面访问它们。通常用于服务器端脚本的许多语言都可以访问本机 C 库，或者您甚至可以编写普通的 C 应用程序并将它们作为脚本代理运行。

在“真正异国情调”的类别中，如果您将其嵌入到充分受保护的环境中，则可以在客户端中运行以 C 代码开头的代码。例如，参见关于如何通过嵌入用 java 编写的 mips 模拟器将 sqlite（一个 C 数据库应用程序）变成 100% 纯 java 应用程序的描述。

[http://blog.benad.me/2008/1/22/nestedvm-compile-almost-anything-to-java.html](http://blog.benad.me/2008/1/22/nestedvm-compile-almost-anything-to-java.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T18:26:12.363

看过`Wt`了吗？它非常整洁。

您还可以选择在 cgi（丑陋）中进行编码。

虽然不是 C，但它是用 C++ 编写的。如果您可以忽略该部分：[Wt 为您服务](http://www.webtoolkit.eu/wt)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T18:38:39.363

对于在客户端执行此操作，您可以使用[Emscripten](https://github.com/kripken/emscripten/wiki "授权")。但是，这很可能需要对现有代码进行一些重构以适应 JavaScript 的异步主循环要求。

请注意，Emscripten 不是概念证明或类似的东西。它*非常*强大，并且已经用于将复杂的代码移植到网络上。您可以查看演示（在上面的 URL 中列出），看看可以用它做什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T18:40:25.733

听起来您最好将遗留的 C 库方法表示为服务器端的一种（WEB）服务。对于这种方法来说，原始 CGI 应用程序似乎是一个相当低级的点，但通常是正确的。有 C/C++ 框架可用于创建 Web 服务服务器，以及支持 Web 服务访问和数据表示的客户端库。例如，对于服务器端，您可以使用[gSoap](http://www.cs.fsu.edu/~engelen/soap.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T19:17:22.473

另一种可能性是使用您选择的网络服务器来传输普通文件并使用连接到您的 C 代码的自定义网络服务器（不需要支持完整的 HTTP 规范）与客户端 Javascript 进行通信。

您可以用作基础的两个最小网络服务器是[libuv-webserver](https://github.com/philips/libuv-webserver)和[nweb](https://www.ibm.com/developerworks/systems/library/es-nweb/)。

# mysql - 用户系统 - MySQL 数据库中的多个角色

> ID：12980101
> 
> 赞同：4
> 
> 时间：2012-10-19T18:15:30.480
> 
> 标签：mysql

所以我正在尝试创建一个基本的用户系统，并且在这个系统中我希望用户能够拥有多个角色。

例如，我的角色如下：管理员、活动组织者、捐赠者

将这些多个角色分配给用户然后检查他们是否具有这些角色中的任何一个以显示某些权限的最佳方法是什么。

如果每个人只有一个角色，那么这不是问题，因为我只需分配说管理员 = 10，组织者 = 5 和捐赠者 = 1，然后执行 if 语句来检查 MySQL 数据是否等于任何这三个数字中。

我无法想象有一种方法可以添加一个 MySQL 字段并用“管理员，捐赠者”填充它，因此该用户将同时拥有这两个角色？

这只是我需要创建 3 个单独的字段并在这些字段中放置 0 或 1 并分别检查每个字段的情况吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-19T18:24:01.757

使用多个表并加入它们：

```
User
--------------
id    name
 1    test

Role
--------------
id    name
 1    Donator
 2    Organizer
 3    Administrator

User_Role
--------------
id    user_id    role_id
 1    1          1
 2    1          3

SELECT * FROM User u 
    LEFT JOIN User_Role ur ON u.id = ur.user_id
    LEFT JOIN Role r ON ur.role_id = r.id
WHERE r.name = "Administrator"; 
```

如果您知道自己只有 3 个角色并且它们很容易记住，那么查询会更容易。

```
SELECT * FROM User u LEFT JOIN User_Role ur ON u.id = ur.user_id WHERE ur.role_id = 3; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-19T18:23:01.737

您将有一个**角色**、**用户**和**users_roles**表：

该`roles`表将包含您的用户可以拥有的各种角色。在我的示例数据中，我声明了管理员和捐赠者角色。

```
roles
    id             unsigned int(P)
    description    varchar(15)

+----+---------------+
| id | description   |
+----+---------------+
|  1 | Administrator |
|  2 | Donator       |
| .. | ............. |
+----+---------------+ 
```

当然，您必须存储有关您的用户的信息。

```
users
    id          unsigned int(P)
    username    varchar(32)
    password    varbinary(255)
    etc.

+----+----------+----------+-----+
| id | username | password | ... |
+----+----------+----------+-----+
|  1 | bob      | ******** | ... |
|  2 | mary     | ******** | ... |
| .. | ........ | ........ | ... |
+----+----------+----------+-----+ 
```

最后，您将在`users_roles`表格中将两者联系在一起。在我的示例数据中，您可以看到它`bob`是一个捐赠者，`mary`既是管理员又是捐赠者。`user_id`和`role_id`都是它们各自表的外键，它们共同构成该表的主键。

```
users_roles
    user_id    unsigned int(F user.id)\_(P)
    role_id    unsigned int(F role.id)/

+----+---------+---------+
| id | user_id | role_id |
+----+---------+---------+
|  1 |       1 |       2 |
|  2 |       2 |       1 |
|  3 |       2 |       2 |
| .. | ....... | ....... |
+----+---------+---------+ 
```

这样，用户可以拥有无​​限数量的角色。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-14T19:33:20.107

如果您不想为这么小的东西创建两个新表。您可以使用 MySQL 内置的**SET 数据类型**，也可以将逗号分隔的角色存储在 varchar 中并使用**FIND_IN_SET()**进行查询操作， 例如。

`SELECT * FROM user WHERE FIND_IN_SET('admin', role)>0;`

`+----+----------+----------+----------------+ | id | username | password | role (varchar) | +----+----------+----------+-----------------+ | 1 | bob | ******** | admin | | 2 | mary | ******** | admin,role1 | | .. | ........ | ........ | role1,role2 | +----+----------+----------+-----------------+`

# ios - Parse.com iOS queryWithClassName 适用于某些人而不适用于其他人，为什么？

> ID：12980105
> 
> 赞同：2
> 
> 时间：2012-10-19T18:15:37.223
> 
> 标签：ios, parse-platform

我有几个类，其中一个是用户，另一个是 TestObject。如果我查询用户（我通过试验和错误了解到它应该作为 _User 查询）我得到正确的记录计数，但是如果我查询 TestObject 我得到 0。这发生在某些类上，但不是所有类。这是为什么？

```
PFQuery *query = [PFQuery queryWithClassName:@"_User"];
[query findObjectsInBackgroundWithBlock:^(NSArray *objects, NSError *error) {
             if (error) {
                 NSLog(@"Error: %@ %@", error, [error userInfo]);
             } else {
                 NSLog(@"Successfully retrieved %d scores.",objects.count);
             }
}]; 
```

这将返回：

> 2012-10-19 13:55:03.239 TableViewParseDotCom[5497:10103] 成功检索到 24 个分数。

但是，如果我将行更改为：

> PFQuery *query = [PFQuery queryWithClassName:@"TestObject"];

我得到 0 计数，但我知道我有 45 条记录。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T23:54:52.833

最常见的原因是您查询了您无权访问的对象。仔细检查这些对象是否具有 ACL，您是否以同一用户身份登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T03:35:30.243

除了检查您正在查询的对象的 ACL 之外，您还应该查看 Parse 仪表板中的设置。如果您不想强制用户登录，请确保将“允许匿名用户”设置为“开”。

此外，在 TestObject 对象的数据浏览器中，单击“更多”按钮，然后从下拉列表中选择“权限”。确保您的“查找”和“获取”设置正确 - 设置为公开，没有角色/用户可以帮助您进行调试。这应该确保您可以查询您的 TestObject 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-29T09:39:29.650

Don't forget to set the read permissions. These can be programatically set as below:

```
PFACL * defaultACL = [PFACL ACL];
[defaultACL setPublicReadAccess:YES];
[PFACL setDefaultACL:defaultACL withAccessForCurrentUser:YES]; 
```

I just ran two queries, one on my users and one on another class (imageClass) and they both returned fine.

User query:

```
// Remember for users we can run a user query instead of needing to specify the class
PFQuery * userQuery = [PFUser query];
[userQuery whereKey:@"username" equalTo:currentUser.username];

[userQuery findObjectsInBackgroundWithBlock:^(NSArray * objects, NSError *error) {

}]; 
```

Other class query:

```
PFQuery * imageQuery = [PFQuery queryWithClassName:@"bImageClass"];

[imageQuery findObjectsInBackgroundWithBlock:^(NSArray * objects, NSError *error) {

}]; 
```

Here is a picture of my classes in Parse.

[![parsemenu](../Images/d1010cedc386cd02d112cceb136e8277.png)](https://i.stack.imgur.com/WWbe1.png)

So I would make sure you have the public access set correctly (in my project this is set just before a query runs) as the code you are using for the queries looks fine.

# java - 表单提交时出现 noSuchElementException

> ID：12980108
> 
> 赞同：1
> 
> 时间：2012-10-19T18:15:55.160
> 
> 标签：java, jsf, exception

我们的应用程序使用 JSF 1.2。屏幕上有一个 selectBooleanCheckbox 表示支持 bean 中的一个字段。加载 JSP 时，正确显示该值。页面上有三个命令按钮；调用 backing bean 中的保存函数，然后导航到另一个屏幕。另外两个用于在刷新屏幕之前调用支持 bean 中的实用程序方法。如果未选中该复选框，则所有三个按钮都可以正常工作。如果选中该复选框，则只有第一个按预期工作。

选中复选框时，将初始化支持 bean，但在调用方法之前，从生成的 servlet 抛出 noSuchElementException。该异常有一条空消息并且没有堆栈跟踪，因此它并不是非常有用。

我已经验证每个字段的值与屏幕最初填充的值保持一致。下拉不一致是我以前见过的唯一一次，因此任何有关其他检查内容的指针将不胜感激。不幸的是，我无法在此处发布代码，但如果可以的话，我会回答任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:20:25.500

仔细查看您的按钮，以及工作按钮与非工作按钮有何不同。

# iphone - 滚动视图中的内容偏移

> ID：12980114
> 
> 赞同：0
> 
> 时间：2012-10-19T18:16:12.770
> 
> 标签：iphone, uiscrollview, ios6, contentoffset

我如何设置图像的内容偏移量以跟踪用户打开的图像并选择将其保存到相册。

```
 UIScrollView *imageScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];

imageScrollView.pagingEnabled = YES;

NSInteger numberOfViews = 61;

for (int i = 0; i < numberOfViews; i++) {

CGFloat xOrigin = i * self.view.frame.size.width;

NSString *imageName = [NSString stringWithFormat:@"image%d.png", i];

_image = [UIImage imageNamed:imageName];

_imageView = [[UIImageView alloc] initWithImage:_image];

_imageView.frame = CGRectMake(xOrigin, 0, self.view.frame.size.width, self.view.frame.size.height);

UILongPressGestureRecognizer *gestureRecognizer = [[UILongPressGestureRecognizer alloc]
                                                   initWithTarget:self
                                                   action:@selector(handleLongPress:)];

imageScrollView.userInteractionEnabled = YES;
[imageScrollView addGestureRecognizer:gestureRecognizer];
gestureRecognizer.delegate = self;
[gestureRecognizer release];

[imageScrollView addSubview:_imageView];

imageScrollView.contentSize = CGSizeMake(self.view.frame.size.width * numberOfViews, self.view.frame.size.height); 
```

编辑：

```
imageScrollView.contentOffset = CGPointMake(CGFloat x, CGFloat y); 
```

在 contentoffset 中不确定要放置什么，以便可以跟踪用户所在的图像并选择保存到相册

```
- (void)handleLongPress:(UILongPressGestureRecognizer*)gestureRecognizer{
if (gestureRecognizer.state == UIGestureRecognizerStateBegan){
UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:nil delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"Save Photo", nil];
actionSheet.actionSheetStyle = UIActionSheetStyleBlackTranslucent;
[actionSheet showInView:self.view];
[actionSheet release];

 }}

-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {

switch (buttonIndex) {
case 0:
    [self savePhoto];

   break;

default:
    break;

}

 -(void)savePhoto{

CGPoint location = [gesture locationInView:_imageView];

if  (CGRectContainsPoint(_imageView.bounds, location)){

UIImageWriteToSavedPhotosAlbum(_image, self, @selector(image: didFinishSavingWithError:contextInfo:), nil);
  }}} 
```

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T03:52:19.920

您可以使用此代码（来自用于滚动视图的苹果示例项目之一）来确定滚动视图中当前可见的“页面”是什么。

```
// Calculate which page is visible
CGFloat pageWidth = self.scrollView.frame.size.width;
int page = floor((self.scrollView.contentOffset.x - pageWidth / 2) / pageWidth) + 1; 
```

知道此索引号后，您可以使用它来确定要保存的图像

# performance - 请帮助解决 Http 响应等待时间的瓶颈？

> ID：12980115
> 
> 赞同：0
> 
> 时间：2012-10-19T18:16:15.943
> 
> 标签：performance, http, iis-7.5, windows-server-2008

至于性能问题，服务器运行良好。除了 http 响应等待时间。随着我们在线服务线的发展，这将成为一个更大的问题。在所有条件相同的情况下，我很困惑这台新服务器加载页面的速度不如运行多个网站、日志记录等的旧服务器快……

这是来自[http://www.gtmetrix.com的屏幕截图](http://www.gtmetrix.com)我一直在使用的在线测试工具。无论一天中的什么时间，这些结果都是一致的，这里的数字没有意义。新站点页面缩小了 75%，但其总生存时间仅快了 26 毫秒。在下图中，左侧是 NEW SERVER，右侧是 OLD SERVER 时间线的左侧部分是握手部分。因此，您可以看到，新服务器的速度大致相同。紫色中间部分，代表等待时间。这大约是 OLD SERVER 延迟的 4 倍（以毫秒为单位）。右侧的灰色部分表示下载文件的实际时间。您还会注意到新服务器在下载响应时明显更快，这很可能是由于响应大小减少了 75%。

![GtMetrix 结果](../Images/8a610b432fa727acf3d4d6e000db7930.png)您可以在此处查看新服务器的完整结果。[http://gtmetrix.com/reports/204.193.113.47/Kl614UCf](http://gtmetrix.com/reports/204.193.113.47/Kl614UCf)

这是我知道的差异表，如果您发现可能是罪魁祸首，请告诉我。我忘了把它添加到表中，但是旧服务器正在生产中，现在正在服务请求，当 www.gtmetrix 正在点击它时。相反，对于我的新服务器，它只是我连接和生成请求。

![服务器配置比较](../Images/addccc2da976f64ea51f998b07e753c9.png)

我目前的假设是，速度缓慢是由于服务器被虚拟化、IIS 设置不正确或 32 位和 64 位操作系统之间的差异造成的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:28:36.997

查看完整结果，等待时间的**下限似乎是****115ms**。没有一个请求更快，大部分都在125ms左右，从请求的资源来看，静态资源也很多，所以服务响应应该不会占用很多CPU。即使响应只有 123 个字节，仍然存在这种延迟。

所以它看起来像一个普遍的问题，甚至可能与 IIS 无关。这里有一些想法，我将如何尝试调试它。

*   ping 往返需要多长时间？（即它是一般网络问题，路由等吗？）
*   从服务器端（例如本地主机）完成 HTTP 请求需要多长时间？（如果它们都花费超过 ~100 毫秒，则开始在服务器盒内进行分析）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T11:54:58.347

好的...

服务器在萨拉索塔（？），测试代理在温哥华，因此相距大约 4,356 公里（如乌鸦飞过），因此您希望的最佳往返时间约为 45 毫秒。

鉴于它不是直接路由，并且路由器等会增加延迟，那么您似乎得到的 155 毫秒往返是非常合理的。

查看对 HTML 页面的请求，344 毫秒完成它的时间非常好——基本上是 114 毫秒建立连接，115 毫秒从服务器接收第一个字节，然后 155 毫秒得到完整响应。

除非您减少往返时间，否则这次不会有太大改善 - 您是否尝试过从 gtmetrix 的达拉斯服务器进行测试作为比较？

如果它是一个缓慢的服务器响应，那么像 PAL (http://pal.codeplex.com/) 这样的东西值得作为第一次查看服务器上发生的事情，但我也会看看 SQL 服务器的响应速度有多快到测试页面上使用的查询。

您想稍后在瀑布中看到的几件事...

对于从 ajax.aspnetcdn.net 托管的两个文件，解析它们的 DNS 名称比下载它们需要更长的时间，因此您可能需要考虑自己冲洗它们

对于基于文本的内容，例如 HTML、CSS、JS 等。您应用的 gzip 压缩级别是什么？压缩文件是否缓存在服务器上？（他们的服务器时间看起来有点长）

# c# - 在 LINQ 中将字符串转换为 DateTime

> ID：12980121
> 
> 赞同：10
> 
> 时间：2012-10-19T18:16:46.350
> 
> 标签：c#, linq

我有一个格式如下的表格。

```
PID     ID       Label        Value
------------------------------------------
1       1        First Name    Jenna
1       2        DOB           10/12/1980 
```

我需要检索名字以 J 开头且出生日期为 10 的所有 PID。

在我的代码中，我在 C# 中的 DataTable 中检索这些，然后尝试使用 LINQ 检索我想要的结果。这只是一个例子。这些标签可以是用户定义的任何东西。

使用 LINQ，我能够检索名字以 J 开头的所有 PID，但每次我尝试为 DOB 转换值时，我都会得到 cast not valid 错误。我无法更改数据库中的列类型，因为 Value 可以包含任何类型的信息。

这是我的一段代码。我是 LINQ 的新手，仍在尝试解决它。

```
var resultQuery = from r in query.AsEnumerable()
where (r.Field<string>("Label") == Label  &&
r.Field<DateTime>("Value").Month == 10)
select r.Field<int>("PID"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:21:45.713

由于并非表的 Value 列中的所有项目都可以转换为`DateTime`，因此您所拥有的内容将在无效转换时失败。您可以添加一个子句，首先检查该值是否为 a`DateTime`并且仅当它是时，转换它并检查`.Month`属性。

```
DateTime d;
var resultQuery = from r in query.AsEnumerable()
                  where (r.Field<string>("Label") == Label &&
                      DateTime.TryParse(r.Field<string>("Value"), out d) && 
                      d.Month == 10)
                  select r.Field<int>("PID"); 
```

为了潜在地提高可读性，您还可以将其提取到一个单独的方法中：

```
var resultQuery = from r in query.AsEnumerable()
                  let d = TryGetDate(r.Field<string>("Value"))
                  where (r.Field<string>("Label") == Label &&
                      d != null && 
                      d.Month == 10)
                  select r.Field<int>("PID");

private DateTime? TryGetDate(string value)
{
    DateTime d;
    return DateTime.TryParse(value, out d) ? d : default(DateTime?);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T18:31:14.477

您最终将在内存中进行过滤，这不是很有效。

所以首先选择你的数据

```
var data= from r in query.AsEnumerable(); 
```

然后过滤数据

```
var filtered = from item in data
               where item.Label == "Label"
               && Convert.ToDateTime(item.DOB).Month == 10
               select item.PID; 
```

# ruby - Ruby - 仅删除文件中特定的重复行

> ID：12980122
> 
> 赞同：3
> 
> 时间：2012-10-19T18:16:47.700
> 
> 标签：ruby

我想从文件中删除重复的行，但只删除与特定正则表达式匹配的重复行，而将所有其他重复项留在文件中。这是我目前拥有的：

```
unique_lines = File.readlines("Ops.Web.csproj").uniq do |line|    
  line[/^.*\sInclude=\".*\"\s\/\>$/]
end

File.open("Ops.Web.csproj", "w+") do |file|
  unique_lines.each do |line|
    file.puts line
  end
end 
```

这将正确地对行进行重复数据删除，但只会将符合正则表达式的行添加回文件中。我需要将文件中的所有其他行原样添加回来。我知道我在这里遗漏了一些小东西。想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:28:19.167

尝试这个：

```
lines = File.readlines("input.txt")
out = File.open("output.txt", "w+")
seen = {}

lines.each do |line|
  # check if we want this de-duplicated
  if line =~ /Include/
    if !seen[line]
      out.puts line
      seen[line] = true
    end
  else
    out.puts line
  end
end

out.close 
```

演示：

```
➜  12980122  cat input.txt
a
b
c
Include a
Include b
Include a
Include a
d
e
Include b
f
➜  12980122  ruby exec.rb
➜  12980122  cat output.txt
a
b
c
Include a
Include b
d
e
f 
```

# asp.net - ASP.NET - 从客户端访问网页两次

> ID：12980123
> 
> 赞同：3
> 
> 时间：2012-10-19T18:16:48.620
> 
> 标签：asp.net, vb.net

如果一个用户在第一个页面返回给客户端之前尝试访问 ASP.NET 页面两次会发生什么？看看下面的代码：

```
Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Session("ID") = 1
    End Sub

    Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
        Response.Redirect("Default3.aspx")
    End Sub End Class

Partial Class Default2
    Inherits System.Web.UI.Page
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Session("ID") = 2
    End Sub

    Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
        Response.Redirect("Default3.aspx")
    End Sub
End Class

Imports System.Threading
Partial Class Default3
    Inherits System.Web.UI.Page

    Dim intTest As Integer = 0

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        For intTest = 0 To 10
            Response.Write(Session("ID") & " " & intTest & "<br>")
            Thread.Sleep(1000)
        Next
    End Sub
End Class 
```

从 default.aspx（通过单击按钮）和 default2.aspx（通过单击按钮）同时从同一客户端 (PC) 访问 default3.axpx 会导致会话变量在两个请求上相同（尽管我将变量设置为 1 on第一个请求和第二个请求 2）。是否可以在没有线程的情况下复制这种行为？我相信我在不使用线程的 asp.net 应用程序中有这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:45:34.177

重要的是要了解会话信息存储在应用程序级别，并且实际上与页面没有直接关系。

您可以将其与类中的全局变量进行比较。如果您的所有方法都在读取和写入此变量，则它将始终包含上次更新时的信息。更新多少次或使用哪种方法都没有关系。

为了帮助您在代码中看到这一点，请创建一个具有一个属性的新类。将您的会话变量更改为此类的对象。修改会话逻辑以引用此对象而不是字符串，并更新属性。

最后，在属性的设置器上设置一个断点。

这将让您查看会话变量何时更新，以及更新的值。您还可以查看堆栈跟踪以查看设置它的内容。

-注意，这一切都假设您没有将农场引入其中并且正在从不同的机器访问会话--

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:07:30.640

![在此处输入图像描述](../Images/0f67ea78583804a5fafb6aaa44f3596e.png)

您的问题与多线程无关；它是关于 SessionState 的。

ASP.NET 运行时使用***[锁来避免覆盖相同的会话变量](http://odetocode.com/blogs/scott/archive/2006/05/20/session-state-uses-a-reader-writer-lock.aspx)***，尽管它可以处理多个请求。

这就是为什么您看不到不匹配结果的原因。

还请看——

[ASP.NET 应用程序和页面生命周期](http://www.codeproject.com/Articles/73728/ASP-NET-Application-and-Page-Life-Cycle)

[ASP.NET 应用程序生命周期概述](http://msdn.microsoft.com/en-us/library/ms178473.aspx)

# java - 在 Java 中的类之间传递命令行参数

> ID：12980124
> 
> 赞同：0
> 
> 时间：2012-10-19T18:16:49.090
> 
> 标签：java

我有一个 Java 程序，其中我需要接受数组中的命令行参数作为`main`方法的输入，然后需要将数组传递给同一程序中另一个类的构造函数。我需要知道如何全局声明数组，然后如何传递它并在构造函数中获取它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:20:25.063

```
public class Example{

  Example(String s[])
  { 
   AnotherClass ac = new AnotherClass(s);
  }
  public static void main(String[] args){
  int num=args.length;
  String s[]=new String[num]; 
  Example ex = new Example (s);`
  }
} 
```

你可以创建`AnotherClass`

```
public class AnotherClass{
  AnotherClass(String s[])
  { 
   // array argument constructor
  }
} 
```

您可以使用

`javac Example.java`

`java Example`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:20:42.037

```
class SomeOtherClass{
   public SomeOtherClass(String[] args){
       this.arguments = args;
   }
   private String[] arguments;
}
class YourMainClass{

 public static void main(String[] args){
     SomeOtherClass cl = new SomeOtherClass(args);
    //fanny's your aunt
  }
} 
```

这就是您可以将参数传递给 SomeOtherClass 的构造函数的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T18:21:05.667

在包含 main 方法的类中，您可以有一个类变量，例如：

```
String[] cmdLineArgs; 
```

然后在主要方法中：

```
cmdLineArgs = new String[args.length];
this.cmdLineArgs = args; 
```

然后只需实现一个将返回的getter `cmdLineArgs`。然后调用另一个构造函数：

```
YourObject x = new YourObject(yourFirstClass.getCmdLineArgs()); 
```

（当然，如果您从 main 方法调用此其他构造函数，则不需要所有这些步骤，您可以直接调用构造函数`args`）

# java - JBoss sar 可以依赖于 lib 中的 jar 吗？

> ID：12980128
> 
> 赞同：0
> 
> 时间：2012-10-19T18:17:44.243
> 
> 标签：java, jboss

我有一个运行 4.0.5 的旧 JBoss 服务器。我在 server/myserver/deploy 中有一个 SAR 文件，其中包含一个 jboss-service.xml：

```
<mbean code="com.me.MyStartup" name=":service=MyStartup">
    <depends>jboss.jca:service=RARDeployer</depends>
    <depends>jboss.jca:service=LocalTxCM,name=MyDS</depends>
    <depends>jboss.j2ee:module=myjar1.jar,service=EjbModule</depends>

    <propertytask="com.me.MyClass1" 
        executeOnStart="true" 
        executeOnShutdown="false"
        startupPriority="400"
        alias="MyClass1"/> 
```

MyClass1 类使用位于 server/myserver/lib 中的 MyClass2。启动 JBoss 时，MyClass2 出现 NoClassDefFoundError。我不认为您可以在 lib 文件夹中添加对 jar 的依赖项，所以我不确定解决方案是什么。有人可以帮忙吗（在这个上卡住了 4.0.5，所以任何升级建议都不可行）。

谢谢，保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T11:03:39.683

保罗，

您需要一些东西，META-INF 中的 jboss-deployment-structure.xml，以及对包含 MyClass2 的 jar 的资源引用。

一步一步的方法在[这里](http://middlewaremagic.com/jboss/?p=1081)

# xpath - Xpath 2.0 在线检查器

> ID：12980130
> 
> 赞同：1
> 
> 时间：2012-10-19T18:17:57.130
> 
> 标签：xpath, xpath-2.0

有没有可以检查 Xpath 2.0 功能的插件或软件？

目前我正在使用仅支持 Xpath 1.0 的 Xpath Checker (ff Plugin)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T20:01:36.863

有一个名为[PathEnq](http://www.qutoric.com/xslt/analyser/xpathtool.html)的在线 XPath 2.0 工具可能适合。

![在此处输入图像描述](../Images/12b8c2d7c55607b4d374e9ccf5bc7d20.png)

[该工具通过使用Saxon-CE](http://saxonica.com) XSLT 2.0 处理器（一个 JavaScript 应用程序）作为“主机”并根据您的表达式动态生成 XSLT 在客户端运行。支持 XPath 变量和命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-09T13:38:01.793

我正在使用在线 xpath 测试器[xpather](http://xpather.com/)，它非常好用。

注意：它的 xpath 2.0 支持目前处于测试阶段。

# ruby-on-rails - 在一个 POST 中创建父对象和子对象的最佳方法是什么？

> ID：12980132
> 
> 赞同：6
> 
> 时间：2012-10-19T18:17:58.340
> 
> 标签：ruby-on-rails

我有两个应用程序，App1 和 App2。App1 向 App2 发布一个 JSON 有效负载，其中包括父对象和子对象的数据。如果父对象已经存在于 App2 中，那么我们更新父记录（如果有任何更改）并在 App2 中创建子记录。如果App2中不存在父对象，我们需要先创建它，然后再创建子对象，并将两者关联起来。现在我正在这样做：

```
class ChildController
  def create
    @child = Child.find_or_initialize_by_some_id(params[:child][:some_id])
    @child.parent = Parent.create_or_update(params[:parent])

    if @child.update_attributes(params[:child])
      do_something
    else
      render :json => @child.errors, :status => 500
    end
  end
end 
```

像这样创建/更新父级感觉有些脏。有没有更好的方法来解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T19:02:07.660

作为起点，您需要在模型中创建关联，然后包含`accepts_nested_attributes_for`在您的父级中。

使用在模型中创建的关联，您应该能够非常轻松地操纵关系，因为您会自动获得大量用于管理关系的方法。例如，您的 Parent/Child 模型可能看起来像这样：

在您的父模型中：

```
class Parent < ActiveRecord::Base
  has_many :children
  accepts_nested_attributes_for :children 
```

在您的孩子模型中：

```
class Child < ActiveRecord::Base
  belongs_to :parent 
```

然后，您应该能够像这样在控制器中建立关联：

```
def new
    @parent = Parent.children.build
end

def create
   @parent = Parent.children.build(params[:parent])
end 
```

然后，nested_attributes 属性将允许您通过操作父对象来更新子对象的属性。

这是有关该主题的 Rails API：http: [//api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:24:06.593

用于`accept_nested_attributes_for`处理父子关系。这里有一篇博文可以帮助你[http://currentricity.wordpress.com/2011/09/04/the-definitive-guide-to-accepts_nested_attributes_for-a-model-in-rails-3 /](http://currentricity.wordpress.com/2011/09/04/the-definitive-guide-to-accepts_nested_attributes_for-a-model-in-rails-3/)

# c++ - 在提升线程中读取标志

> ID：12980133
> 
> 赞同：1
> 
> 时间：2012-10-19T18:17:59.307
> 
> 标签：c++, multithreading, boost

我是 Boost 编程的新手。我想要做的是从 main() 创建一个线程，它将连续运行直到 main() 退出。现在，我正在对该线程进行一些操作，完成后它将设置一个布尔标志。main() 将等待这个标志被设置，当它为“真”时，main() 将完成它的工作，重置标志，并等待它再次被设置。另一个线程将连续运行。

谁能提供一组简单的提升线程指令来实现这一目标？

我正在尝试用伪代码做到这一点

```
class Call {
public:
    bool flag, do_it;
    keyboard_callback() {
        if('s' pressed) do_it = true;
    }
    f() { // some callback function
        if(do_it == true) flag=true;
    }
    void func() {
        ...register callback f()
        ...register keyboard_callback()
        ...
        while(some condition) { keep running , exit when 'q'}
        ...
    }
};
main()
{
    Call obj;
    boost::thread th (boost::bind(&Call::func, &obj));
    th.detach();
    while(true) {
        while (obj.flag == false);
        ...do something
    }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:27:51.500

```
// shared variables
boost::mutex mutex;
boost::condition_variable condition;
bool flag = false;

// signal completion
boost::unique_lock<boost::mutex> lock(mutex);
flag = true;
condition.notify_one();

// waiting in main method
boost::unique_lock<boost::mutex> lock(mutex);
while (!flag) {
    condition.wait(lock);
} 
```

# php - 如何在运行前检测异常查询（注入可疑）？

> ID：12980136
> 
> 赞同：0
> 
> 时间：2012-10-19T18:18:16.653
> 
> 标签：php, mysql, string, code-injection

一些黑客可以访问我的数据库，我会找到错误；我无权访问服务器日志。我制作了这段代码以将可疑查询保存在文本文件中：

```
function query($query) {
$file = 'sqllog.txt';
if(/* Which condition should i use to detect? */){
$contents = file_get_contents($file);
$contents.="\r\n";
$contents.=$query;
file_put_contents($file,$contents);
}
$this->theQuery = $query;
return mysql_query($query, $this->link);
} 
```

我应该使用哪种条件来检测 sql 注入可疑查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:20:17.473

您应该在您的代码库中寻找未经处理的输入（即不使用`mysql_real_escape_string`）。理想情况下，在将参数插入查询之前立即调用此函数。

或者，考虑使用 PDO 切换到准备好的语句，SQL 注入将不再是问题。

# heroku - 在mac终端上登录heroku如何

> ID：12980138
> 
> 赞同：4
> 
> 时间：2012-10-19T18:18:28.150
> 
> 标签：heroku

我们是 Heroku 的新手。我已经在 OSx 上安装了工具带。我去显示 MacBook-Pro-de-Francisco-Balarezo 的终端：~ francisco$

我输入 $heroku login 并得到 login: 指的是 mac 用户凭据而不是 heroku。

我知道这是一个基本的东西，我们正在做我们的第一步。任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:11:21.313

从命令行登录 Herok 问题`heroku login`。输入您的 Herkou 电子邮件/用户名。按 Enter，然后按您的 Heroku 密码。

```
macbook-austin:~ aus$ heroku login                                                                                                    
Enter your Heroku credentials.                                                                                                        
Email: heroku.account@email.com                                                                                                      
Password (typing will be hidden): yourpassword                                                                                                    
Authentication successful.   
macbook-austin:~ aus$ 
```

现在您可以运行其他需要身份验证的 heroku 命令。

heroku 要求您提供 OS X 凭据的唯一原因是您正在使用它运行它，`sudo`或者它需要 root 访问权限。这不应该是这样。

# java - 仅绘制和重绘/更新 JPanel 的内容（而不是背景）组件的方法？

> ID：12980143
> 
> 赞同：2
> 
> 时间：2012-10-19T18:19:11.820
> 
> 标签：java, swing, awt, jpanel, panel

我正在创建一个绘图仪，它根据定期更新的数据点绘制（绘制）数据点和线。

我在 JFrame 中使用 JPanel 作为绘图画布。

JPanel 包含线轴和其他信息（比例等）作为**背景**。它还包含更新数据点作为**内容**。

在获取新数据后，我想定期更新 JFrame 的内容。数据点获取部分已完成并且工作正常。

这是我的代码：[http](http://pastebin.com/SAEjNT1R) ://pastebin.com/SAEjNT1R，http : [//pastebin.com/WvPTyEfR](http://pastebin.com/WvPTyEfR)（面板类）。

主要的：

面板对象类：

这是 OraclePinger 包（不是真的需要，以防你想运行）：在 pastebin Wdmd3q1t（连接器类），MycAgyu3（目标类）
最初由 Oracle - 由我修改：docs.oracle.com/javase/1.4.2/ docs/guide/nio/example/Ping.java

我只是对 JPanel 绘图部分感到困惑。我希望能够绘制一次背景，然后定期刷新/清除并重绘内容。

---说如果刷新时无法分离背景和内容..我们只能清除面板中的所有组件。我至少可以拨打类似*panel.clearAllComponents()*的电话吗？*panel.draw(TheBackGround+Content)*（重复）来自 Main

我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:22:42.097

由于与工作相关的防火墙限制，我无法查看链接，但无论如何，由于您正在向志愿者寻求免费建议，您确实应该在此处发布相关代码，以便我们尽可能轻松地为您提供帮助。

话虽如此，在 JPanel 的 paintComponent 方法中显示的 BufferedImage 上绘制图形的不变部分，然后在 JPanel 的 paintComponent 方法中绘制变化部分，可能通过循环遍历数据点的 ArrayList。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T18:29:58.193

如果您正在使用`JFreeChart`，这里有一个使用 a来调整动画速度的相关[示例。](https://stackoverflow.com/a/5048863/230513)`javax.swing.Timer`请注意，`JFreeChart`按设计更新每个增量的整个图。

# maven - 如何将环境变量传递给以 mvn jetty:run 启动的进程？

> ID：12980146
> 
> 赞同：4
> 
> 时间：2012-10-19T18:19:16.637
> 
> 标签：maven, maven-jetty-plugin

maven jetty 插件启动的过程似乎忽略了我指定的任何环境变量。到目前为止，我已经尝试通过命令行添加变量，例如：

```
set myvariable=1 
```

我还尝试将“-Dmyvariable=1”之类的内容添加到 MAVEN_OPTS 变量中。

没有什么帮助。
为了清楚起见，我需要将变量传递给 maven，而不是传递给结果过程，即直接传递给码头服务器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T22:21:52.343

您需要在插件的配置中指定一个[systemProperties部分：](http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin#MavenJettyPlugin-sysprops)

```
<project>
  ...
  <plugins>
    ...
      <plugin>
        <groupId>org.mortbay.jetty</groupId>
        <artifactId>maven-jetty-plugin</artifactId>
        <configuration>
         ...
         <systemProperties>
            <systemProperty>
              <name>myvariable</name>
              <value>1</value>
            </systemProperty>
            ...
         </systemProperties>
        </configuration>
      </plugin>
  </plugins>
</project> 
```

# python - 在一个脚本中使用 Python 的子进程和 Popen 来运行另一个需要用户交互的 Python 脚本（通过 raw_input）

> ID：12980148
> 
> 赞同：8
> 
> 时间：2012-10-19T18:19:32.093
> 
> 标签：python, automation, subprocess, popen

我遇到的问题如下，我会用简单的例子来说明。我编写了一个需要用户交互的 python 脚本，特别是它使用 raw_input() 函数来获取用户的输入。下面的代码只是要求用户连续输入两个数字（在每个数字之间按回车键），然后返回答案（惊喜，惊喜，它被称为“sum_two_numbers.py”）。哼哼！

```
#! /usr/bin/python

#  -------------------
#  sum_two_numbers.py
#  -------------------
#  This script asks the user for two numbers and returns the sum!

a = float(raw_input("Enter the first number:"))
b = float(raw_input("Enter the second number:"))

print a+b 
```

现在，我想编写一个单独的 python 脚本来执行上述脚本并将两个必要的数字“提供”给它。因此，我将此脚本称为“feeder.py”。我尝试使用 Python 的“[子进程](http://docs.python.org/library/subprocess.html)”模块编写此脚本，特别是使用“Popen”类及其相关的“通信”方法。下面是尝试输入数字“5”和“4”的脚本。

```
#! /usr/bin/python

#  ----------
#  feeder.py
#  ----------
import subprocess

child = subprocess.Popen("./sum_two_numbers.py",stdin=subprocess.PIPE)

child.communicate("5")
child.communicate("4") 
```

此代码不起作用，并在执行时返回错误：

```
$ ./feeder.py
Enter the first number:Enter the second number:Traceback (most recent call last):
  File "./sum_two_numbers.py", line 6, in <module>
    b = float(raw_input("Enter the second number:"))
EOFError: EOF when reading a line
Traceback (most recent call last):
  File "./feeder.py", line 8, in <module>
    child.communicate("4")
  File "/usr/lib/python2.7/subprocess.py", line 740, in communicate
    self.stdin.write(input)
ValueError: I/O operation on closed file 
```

我不知道如何编写“feeder.py”以便它可以做我想做的事情，这些错误一直在阻碍我。我怀疑由于文档中的以下注释而出现此错误：

> Popen.communicate（输入=无）
> 
> 与进程交互：将数据发送到标准输入。从 stdout 和 stderr 读取数据，直到到达文件结尾。等待进程终止。

我不知道如何理解这句话，以及它如何帮助我......

谁能帮助我使上述脚本正常工作，即如何正确使用 subprocess 和 Popen ... 我已经尝试过 Pexpect，Expect 但遇到了诸如不输出子代码的输入请求之类的问题，而我通常不知道它在做什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-19T21:12:46.507

您只能调用`communicate`一次。因此，您需要一次传递所有输入，即`child.communicate("1\n1\n")`. 或者，您可以写入标准输入：

```
child = subprocess.Popen("./test.py", stdin=subprocess.PIPE)         

child.stdin.write("1\n")                                                       
child.stdin.write("1\n") 
```

# ios - 在 UIWebView 中嵌入谷歌地图而不要求位置权限并显示谷歌面板

> ID：12980150
> 
> 赞同：0
> 
> 时间：2012-10-19T18:19:38.437
> 
> 标签：ios, google-maps, uiwebview, ios6

我正在使用加载在 UIWebView 中的谷歌地图来显示两个位置之间的方向

这是我在 UIWebView 中加载的 url

```
NSString *routeString = [NSString stringWithFormat:@"http://maps.google.com/maps?saddr=%f,%f&daddr=%f,%f&output=embed",[myData.myLat doubleValue],[myData.myLng doubleValue],[view.annotation coordinate].latitude,[view.annotation coordinate].longitude]; 
```

当我删除 output=ember 参数时，会显示谷歌面板，但 UIWebView 要求获得我已经在我的应用程序中完成的用户位置的权限，

当我添加输出=嵌入时，UIWebView 不要求位置权限，但谷歌面板没有显示。

如何防止 UIWebView 显示位置权限并同时查看谷歌面板？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T13:49:05.130

回答我自己的问题。这是我用来加载地图的网址

```
NSString *routeString = [NSString stringWithFormat:@"http://maps.google.com/maps?saddr=%f,%f&daddr=%f,%f&view=map&output=html",[myData.myLat doubleValue],[myData.myLng doubleValue],[view.annotation coordinate].latitude,[view.annotation coordinate].longitude]; 
```

# c# - asp.net中任何类型控件的内容形式的所有控件

> ID：12980151
> 
> 赞同：0
> 
> 时间：2012-10-19T18:19:48.957
> 
> 标签：c#, asp.net

如何根据asp.net中的某些条件制作Readonly任何类型的控件形式的所有控件我们想要的按钮不应该被禁用但可以是活动的。它应该是通用的方法实际上我有一个母版页我有一个按钮，而我们有其他控件，如中继器和文本框的下拉列表单选按钮列表和内容页面中的复选框列表，

我已经在母版页中使用 foreach 循环来查找内容页面中的控件，但将它们标记为只读，以便 no1 可以更改控件的保存值，只是我不希望按钮应该被禁用但无法实现这一点请帮助我是 asp.net 的新手，我是 java 开发人员，但现在在 asp.net 上工作了几天

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:23:12.373

您可以使用 css 执行此操作。为页面中的所有控件添加一个 css 类。

[一个类似于你的问题的问题。这可能会对您有所帮助。](https://stackoverflow.com/questions/2528462/how-to-set-readonly-property-of-textbox-from-css)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:24:18.663

我假设您希望禁用除按钮之外的控件

```
foreach(WebControl c in Page.Controls)
{
    if(c is TextBox || c is DropdownList)
    {
        c.Enabled = false;
    }
 } 
```

这不会阻止用户从页面更改呈现控件的行为。用户应该仍然可以检查元素并修改属性。

您需要从代码隐藏中检查以忽略您不想编辑的控件中的值。

# css - 图像在悬停时移动 - 铬不透明度问题

> ID：12980153
> 
> 赞同：94
> 
> 时间：2012-10-19T18:19:51.943
> 
> 标签：css, image, google-chrome, hover, opacity

我的页面似乎有问题： [http ://www.lonewulf.eu](http://www.lonewulf.eu)

将鼠标悬停在缩略图上时，图像会向右移动一点，并且仅在 Chrome 上发生。

我的CSS：

```
.img{
    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
    filter:alpha(opacity=50);
    -moz-opacity: 0.5; 
    opacity: 0.5;
    -khtml-opacity: 0.5;
    display:block;
    border:1px solid #121212;
}
.img:hover{
    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
    filter:alpha(opacity=100);
    -moz-opacity: 1; 
    opacity: 1;
    -khtml-opacity: 1;  
    display:block;
} 
```

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2013-05-30T10:15:49.880

另一种解决方案是使用

```
-webkit-backface-visibility: hidden; 
```

在具有不透明度的悬停元素上。背面可见性与 相关`transform`，因此[@Beskow](https://stackoverflow.com/a/15297785/2105015)与它有关。由于它是 webkit 特定的问题，您只需要指定 webkit 的背面可见性。还有其他[供应商前缀](http://www.w3schools.com/cssref/css3_pr_backface-visibility.asp)。

有关更多信息，请参阅[http://css-tricks.com/almanac/properties/b/backface-visibility/](http://css-tricks.com/almanac/properties/b/backface-visibility/)。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-10-21T04:52:25.587

由于某种原因，Chrome 以不同的方式解释不透明度为 1 的元素的位置。如果将 CSS 属性`position:relative`应用于 a.img 元素，则不会再有左/右移动，因为它们的不透明度会有所不同。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-03-08T15:43:08.987

我有同样的问题，我用css transform rotate修复了它。像这样：

```
-webkit-transform: rotate(0);
-moz-transform: rotate(0);
transform: rotate(0); 
```

它在主流浏览器中运行良好。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2016-11-08T17:21:11.467

为我解决此问题的另一个解决方案是添加规则：

```
will-change: opacity; 
```

`translateZ(0)`在我的特殊情况下，这避免了在 Internet Explorer中引入的类似像素跳跃问题，尽管在 Chrome 中修复了一些问题。

此处建议的大多数其他涉及转换（例如`translateZ(0)`, `rotate(0)`,`translate3d(0px,0px,0px)`等）的解决方案都是通过将元素的绘制交给 GPU 来工作的，从而实现更高效的渲染。`will-change`向浏览器提供了一个可能具有类似效果的提示（允许浏览器更有效地呈现过渡），但感觉不那么骇人听闻（因为它明确地解决了问题，而不仅仅是推动浏览器使用 GPU）。

话虽如此，但值得记住的是，[浏览器支持](http://caniuse.com/#search=will-change)并不那么好`will-change`（尽管如果问题仅出在 Chrome 上，那么这可能是一件好事！），并且在某些情况下它可能会引入[自己的问题](http://greensock.com/will-change)，但仍然，这是此问题的另一种可能的解决方案。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-11-15T00:27:30.870

我需要同时应用`backface-visibility`和`transform`规则来防止这种故障。像这样：

```
a     {-webkit-transform: rotate(0);}
a img {-webkit-backface-visibility: hidden;} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2015-09-18T00:45:50.773

我在悬停时遇到了（非不透明）过滤器类似的问题。通过向基类添加规则来修复：

```
filter: brightness(1.01); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-07-15T14:24:42.637

backface-visibility（或 -webkit-backface-visibility）只为我解决了 Chrome 中的问题。为了修复 Firefox 和 Chrome，我使用了上述答案的以下组合。

```
//fixes image jiggle issue, please do not remove
img {
  -webkit-backface-visibility: hidden; //Webkit fix
  transform: translate3d(0px,0px,0px); //Firefox fix
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-01-21T19:50:25.087

我在 Safari 8.0.2 中遇到了类似的问题，图像会随着不透明度的变化而抖动。此处发布的修复均无效，但以下修复有效：

```
-webkit-transform: translateZ(0); 
```

通过[此后续答案获得](https://stackoverflow.com/a/17353755/1762351)[此答案](https://stackoverflow.com/a/15203880/1762351)的所有功劳

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-01-26T23:07:13.850

我在网格中遇到了这个问题，每个图像都嵌套在一个已声明的 display: inline-block 中。Jamland 上面发布的解决方案可以解决 display: inline-block; 时出现的问题。在父元素上声明。

我有另一个网格，其中图像位于无序列表中，我能够声明 display: block; 以及父列表项的宽度并声明 backface-visibility: hidden; 在图像元素上，悬停时似乎没有任何位置偏移。

```
li { width: 33.33333333%; display: block; }
li img { backface-visibility: hidden; } 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-05-28T15:40:06.423

我在这里遇到了所有其他解决方案的问题，因为它们需要更改 CSS，这可能会破坏其他东西—— position:relative 要求我完全重新考虑如何定位我的元素， transform:rotate(0) 可能会干扰现有的当我设置了过渡持续时间时，会转换并给出不稳定的小过渡效果，如果我真的需要背面（并且需要大量前缀），背面可见性将不起作用。

我发现的最懒惰的解决方案是在我的元素上设置一个非常接近但不完全是 1 的不透明度。如果不透明度为 1，这只是一个问题，所以它不会破坏或干扰我的任何其他样式：

```
opacity:0.99999999; 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-04-21T19:51:30.010

解决方案**alpipego**在这个问题上为我服务。使用`-webkit-backface-visibility: hidden;` 这个图像在悬停不透明度过渡中没有移动

```
/* fix error hover image opacity*/
-webkit-backface-visibility: hidden;
-moz-backface-visibility: hidden;
-ms-backface-visibility: hidden;
backface-visibility: hidden; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-02-14T10:38:27.187

将 Rick Giner 的答案标记为正确后，我发现它并没有解决问题。

在我的情况下，我有一个包含在最大宽度 div 中的响应宽度图像。一旦站点宽度超过该最大宽度，图像就会在悬停时移动（使用 css 转换）。

在我的情况下，解决方法是简单地将最大宽度修改为三的倍数，在这种情况下是三列，并且它完美地修复了它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-05-17T00:28:00.577

有同样的问题，我的解决方法是将类放在 img 选项卡中的 src 之前。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-08T10:56:46.650

我注意到您的 CSS 中包含不透明度。我在 Chrome 上遇到了同样的问题（图像在悬停时移动）.. 我所做的只是禁用不透明度，它得到了解决，没有更多的图像移动。

```
.yourclass:hover {
  /* opacity: 0.6; */
} 
```

# android - 从其他视图拖动时检测视图上的触摸事件

> ID：12980156
> 
> 赞同：23
> 
> 时间：2012-10-19T18:20:11.430
> 
> 标签：android, android-view, ontouchlistener

如果用户触摸视图 A 并拖动到视图 B 的底部，我如何检测触摸事件。我想检测视图 B 中的触摸事件。

我在视图 B 中添加了触摸侦听器，但如果用户最初触摸 A 并拖动到 B 上，则不会收到事件。

![在此处输入图像描述](../Images/8d0cf913d0b0e2ac8110ff035e60feb0.png)

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-11-22T02:42:08.810

您可以使用下面的代码来实现您的请求：

**测试视图边界的方法**（在下面的代码中使用）

```
 Rect outRect = new Rect();
    int[] location = new int[2];

    private boolean isViewInBounds(View view, int x, int y){
        view.getDrawingRect(outRect);
        view.getLocationOnScreen(location);
        outRect.offset(location[0], location[1]);
        return outRect.contains(x, y);
    } 
```

**用两个测试`TextView`**

```
 final TextView viewA = (TextView)  findViewById(R.id.textView);
    final TextView viewB = (TextView)  findViewById(R.id.textView2); 
```

**设置视图A**

空`OnClickListener`需要保持`OnTouchListener`活动状态，直到`ACTION_UP`

```
 viewA.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {}
    });

    viewA.setOnTouchListener(new OnTouchListener() {
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            int x = (int)event.getRawX();
            int y = (int)event.getRawY();
            if(event.getAction() == MotionEvent.ACTION_UP){
                if(isViewInBounds(viewB, x, y))
                    viewB.dispatchTouchEvent(event);
                else if(isViewInBounds(viewA, x, y)){
                    Log.d(TAG, "onTouch ViewA");
                    //Here goes code to execute on onTouch ViewA
                }
            }
            // Further touch is not handled
            return false;
        }
    }); 
```

**设置视图B**

仅当您还想按下 viewB 并拖动到 viewA 时才需要这样做

```
 viewB.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {}
    });

    viewB.setOnTouchListener(new OnTouchListener() {
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            int x = (int)event.getRawX();
            int y = (int)event.getRawY();
            if(event.getAction() == MotionEvent.ACTION_UP){
                if(isViewInBounds(viewA, x, y))
                    viewA.dispatchTouchEvent(event);
                else if(isViewInBounds(viewB, x, y)){
                    Log.d(TAG, "onTouch ViewB");
                    //Here goes code to execute on onTouch ViewB
                }
            }
            // Further touch is not handled
            return false;
        }
    }); 
```

问候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:34:06.557

我确定您需要`ViewGroup.dispatchTouchEvent(MotionEvent ev)`在包含视图 A 和 B 的 ViewGroup 中覆盖方法。原始实现在容器接收时定义目标视图`MotionEvent.getAction() == MotionEvent.ACTION_DOWN`，然后将所有以下触摸事件分派到目标视图，直到收到`MotionEvent.getAction() == MotionEvent.ACTION_UP`或`MotionEvent.ACTION_CANCEL`。

在您的情况下，目标视图是 A 或容器本身（取决于您的容器`onInterceptTouchEvent(MotionEvent ev)`方法实现）。因此，您应该覆盖此类行为并将触摸事件不仅发送到目标视图，而且还发送到触摸区域下的所有视图（例如视图 B）。

如果您有兴趣，可以分享代码示例，我会尽力帮助您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T04:53:51.460

如果您从视图 A 的 onTouchEvent 返回 true，则不会传播该事件。在这种特殊情况下，当 A 低于 B 时，从视图 A 的 onTouch 返回 false。

如果您可以发布一些代码，这也会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T18:27:07.477

在`View` *A*中，覆盖`onTouchEvent`如下：

```
@Override
public boolean onTouchEvent(MotionEvent event) 
{

    float x = event.getRawX();
    float y = event.getRawY();
    if ( (B.getLeft() <= x <= B.getRight()) &&
         (B.getTop() <= y <= B.getBottom())
       )
    {
        Log.i("A", "Motion Event is currently above B");
        B.dispatchTouchEvent(event);
    }

    return true;
} 
```

在`View` *B*中，覆盖相同的方法，确保**返回 false**：

```
@Override
public boolean onTouchEvent(MotionEvent event) 
{
    //TODO handle touch event
    return false;//this will allow A to continue using the event
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T18:32:40.193

尝试使用拖放框架。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-15T12:32:47.190

当您在视图 B 上时，`onTouch`手动调用它。

```
if (viewBRect.contains(x, y)) {
    viewBsonTouch(view, motionEvent);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-02T20:23:47.337

当用户从视图 B 抬起手指时，如何调用圆形菜单创建状态。下面是示例代码
circleMenu = findViewById(R.id.circle_menu);

```
 circleMenu.setMainMenu(Color.parseColor("#CDCDCD"), R.color.acik_yesil, 
    R.color.kirmizi)
                .addSubMenu(Color.parseColor("#258CFF"), R.drawable.add)
                .addSubMenu(Color.parseColor("#FF0000"), R.drawable.mul)
                .addSubMenu(Color.parseColor("#6d4c41"), R.drawable.sub)
                .addSubMenu(Color.parseColor("#FF077D8F"), R.drawable.div)
                .setOnMenuSelectedListener(new OnMenuSelectedListener() {
                    @Override
                    public void onMenuSelected(int index) {

                        switch (index) {
                            case 0:
                                Toast.makeText(MainActivity.this, "add", 
      Toast.LENGTH_SHORT).show();
                                break;
                            case 1:
                                Toast.makeText(MainActivity.this, "mul", 
      Toast.LENGTH_SHORT).show();
                                break;
                case 2:
                                Toast.makeText(MainActivity.this, "sub", 
            Toast.LENGTH_SHORT).show();
                                break; 
                case 3:
                                Toast.makeText(MainActivity.this, "div", 
      Toast.LENGTH_SHORT).show();
                                break;
                        }
                    }
                }); 
```

# python - 如何更改 HTTP 响应中的链接 URL？

> ID：12980161
> 
> 赞同：3
> 
> 时间：2012-10-19T18:20:20.937
> 
> 标签：python, http, url

现在我有一个来自网站 A 的 http 响应，我需要将这个 http 响应中的所有链接 url 更改为网站 B 的 url，这样当用户在浏览器中获得这个 http 响应时，点击链接，他们将被定向到网站B 不是 A。

我正在使用python和django。有没有包或工具可以做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:24:30.007

根据您从网站 A 获得的响应的性质、您想用它做什么，以及替换是否有效的重要性，有几种可能的做事方式。我不是 100% 清楚你的情况和你想要达到的目标。

如果来自网站 A 的响应中的链接以网站 A 的主机名开头，那么只需将响应作为字符串获取，然后在将响应`response = response.replace('http://website-a.com', 'http://website-b.com')`呈现给用户之前执行此操作。

如果响应是 HTML，并且链接是相对的，最简单的代码解决方案可能是使用**lxml.rewrite_links**（请参阅[http://lxml.de/lxmlhtml.html#working-with-links](http://lxml.de/lxmlhtml.html#working-with-links)）。*我怀疑这就是你要找的。*

如果您还有其他情况，那么我不知道什么是合适的。也许是一个正则表达式。也许是您自己设计的自定义算法。这取决于您从网站 A 返回的内容类型、您如何识别其中的链接以及您希望如何更改它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:28:58.920

如果您使用 Apache 作为 Web 服务器，您可以使用一个模块来替换响应中的文本，例如[http://mod-replace.sourceforge.net/](http://mod-replace.sourceforge.net/)。这似乎比为每个请求调用 perl 或 python 更合理。但是你必须知道所有的文本都可能被替换——不仅仅是那些有效果的链接。因此，这将是一个非常肮脏的解决方案。

# c# - MySql.Data.MySqlClient C# 控制台应用程序

> ID：12980162
> 
> 赞同：0
> 
> 时间：2012-10-19T18:20:24.407
> 
> 标签：c#, mysql, console

我在用：

```
 string selectString =
                "SELECT username, password " +
                "FROM users " +
                "WHERE username = '" + user + "' AND password = '" + password + "'";

                MySqlCommand mySqlCommand = new MySqlCommand(selectString, Program.mySqlConnection);
                Program.mySqlConnection.Open();
                String strResult = String.Empty;
                strResult = (String)mySqlCommand.ExecuteScalar();
                Program.mySqlConnection.Close();
                if (strResult.Length == 0)
                {
                    responseString = "invalid";
                    InvalidLogin = true;
                } else {
                    InvalidLogin = false;
                } 
```

在 strResult.Length 处，由于某种原因，我得到了 NullReferenceException。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:35:14.767

这就是您的代码的样子：

```
using(var connection = new MySQLConnection(connectionString))
{
    using(var command = connection.CreateCommand())
    {
        command.CommandText = @"
SELECT COUNT(*) 
FROM users
WHERE username = @user AND password = @password";
        command.Parameters.Add(new MySQLParameter("user", user));
        command.Parameters.Add(new MySQLParameter("password", password));

        var total = (int)command.ExecuteScalar();
        if(total == 0)
            InvalidLogin = true;
        else
            InvalidLogin = false;
    }
} 
```

有几件事情需要注意

*   永远不要以你这样做的方式构建你的查询字符串。在 Google 上搜索“sql injection”以了解更多关于你可能发生的事情。始终使用参数。我知道，您写道这是控制台应用程序，但良好的习惯很重要。
*   `using`使用数据库连接和命令时始终使用关键字。
*   从您的代码中，我感觉您有全局 MySQLConnection 对象，对吗？永远不要那样做！ADO.NET 使用连接池，因此为您的操作打开新连接并不是昂贵的操作。确保您没有在连接字符串中禁用连接池。
*   与 ADO.NET 无关，但很重要：您应该散列您的密码。

要回答您的问题，问题出在您正在使用的 ExecuteScalar 中。它返回标量变量（单个值）...在您的查询中，您正在返回用户名和密码，因此您应该使用 ExecuteReader 代替...但我认为我发布的查询中的 COUNT(*) 以及 ExecuteScalar 可能成为更好的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T18:42:56.780

试试这个..

```
string selectString =
                "SELECT username, password " +
                "FROM users " +
                "WHERE username = '" + user + "' AND password = '" + password + "'";

                MySqlCommand mySqlCommand = new MySqlCommand(selectString, Program.mySqlConnection);
                Program.mySqlConnection.Open();
                String strResult = String.Empty;

                if (mySqlCommand.ExecuteScalar()== NULL)
                {
                    responseString = "invalid";
                    InvalidLogin = true;
                } else {
                    InvalidLogin = false;
                }
               Program.mySqlConnection.Close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T18:24:35.453

`ExecuteScalar()`返回单个值。你想要`ExecuteReader()`，因为你要带回用户名和密码

# python - 超类可以从单独的模块中调用子类方法吗？

> ID：12980164
> 
> 赞同：0
> 
> 时间：2012-10-19T18:20:33.083
> 
> 标签：python, inheritance

如果类在不同的模块中，超类可以调用子类方法“执行”吗？我知道如果它们在同一个模块中，这可以工作。

文件2.py

```
import file1
class TestCase(file1.TestBase):

    def execute(self):
        self._pass() 
```

文件1.py

```
class TestBase:

    def _pass(self):
        print "PASS"

testBase = TestBase()
testBase.execute() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:24:18.197

是的，但你确实明确地称呼它：

```
from file1 import TestBase

class TestCase(TestBase):   
    def execute(self):
        TestBase.execute(self) # directly
        super(TestCase, self).execute() # or via super() proxy 
```

# macos - Brew - 节点未构建

> ID：12980166
> 
> 赞同：2
> 
> 时间：2012-10-19T18:20:35.137
> 
> 标签：macos, node.js, homebrew

自制 0.9.3 OSX 10.8.2

我想知道你是否见过这样的事情？

```
==> make install
brew: superenv removed: -O3 -gdwarf-2 -arch x86_64 -Wall -Wendif-labels -W -Wno-unused-parameter
20 errors generated.
make[1]: *** [/private/tmp/node-tiuh/node-v0.8.12/out/Release/obj.target/uv/deps/uv/src/unix/darwin.o] Error 1
make[1]: *** Waiting for unfinished jobs....
make: *** [node] Error 2

Error: node did not build
Logs: /Users/justin/Library/Logs/Homebrew/node/
Help: https://github.com/mxcl/homebrew/wiki/troubleshooting
      https://github.com/mxcl/homebrew/issues/13282 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T21:51:19.703

我有同样的错误。

打开 XCode 转到 XCode->Preferences 转到 Downloads 选项卡并安装命令行工具（或更新它们）如果您没有 Xcode，您也可以单独下载它们

[Xcode 4.4 及更高版本安装命令行工具](https://stackoverflow.com/questions/9329243/xcode-4-4-command-line-tools)

# php - 用 SELECT 的 ID 填充数组

> ID：12980168
> 
> 赞同：-1
> 
> 时间：2012-10-19T18:20:41.737
> 
> 标签：php

我必须使用一个 SELECT 的 POSTED 值创建一个数组。SELECT 一个接一个地选择产品。首先，我选择一个产品并发布它，然后是另一个产品，然后我发布第二个，依此类推.....我想创建一个由 SELECT 发布的产品 ID 的数组，但是这个数组必须增长，而我介绍越来越多的产品。

我用过这个，但它只用我选择的最后一个产品制作阵列。

```
foreach($_POST['idproducto'] as $key => $val) {
$cadenaides = $cadenaides . "$val,";
}
$cadenaides = $cadenaides . 1; 
```

我希望数组包含我在 SELECT 中逐个选择的产品的所有 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:24:06.570

在我看来，您想为每个发布的值分配一个数字。你可以这样做：

```
foreach(...) {
    $cadenaides[] = $val;
} 
```

您的值将存储在一个数组中。您可以使用 . 检查您的阵列`print_r($cadenaides);`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:05:48.923

阅读上面的评论并假设您使用 MySQL，我会建议以下内容：

`SELECT GROUP_CONCAT(id_producto SEPARATOR ',') FROM producto WHERE .... put your conditions here ..;`

这会将所有 ID 连接在一个字符串中，就像`1,2,3,5,8,9...`在一个结果中一样，之后您可以只执行一个 POST 请求。顺便说一句，在许多情况下非常有用。

结果被截断为系统变量给出的最大长度，`group_concat_max_len`其默认值为 1024。可能非常大 - 最大值：`4294967295`对于`32-bit`系统。

# php - PHP - MYSQL 不插入多于一行

> ID：12980177
> 
> 赞同：1
> 
> 时间：2012-10-19T18:21:30.260
> 
> 标签：php, html, mysql

我在 html 中有我的注册表单所有设置和工作，它第一次运行并在 mysql 表中插入一行，但我不能再插入任何行。

我的PHP是： -

```
include "config.php";

$gamerid = $_POST['gamerid_create'];
$email = $_POST['email_create'];
$password = md5($_POST['password_create']);
$country = $_POST ['country_create'];

echo "<pre>";
print_r($_POST);
echo "</pre>";

$insert = "insert into users (gamerid,email,password,country) values('$gamerid','$email','$password','$country')";
mysql_query($insert); 
```

现在，当我在 mysql 中创建表时，我使用了以下代码：-

```
CREATE TABLE users
(
id INT primary key NOT NULL AUTO_INCREMENT,
gamerid varchar (255) NOT NULL,
email varchar (255) NOT NULL,
password varchar (255) NOT NULL,
country varchar (255) NOT NULL
) 
```

为什么不插入更多行？

我的html如下：

```
<form id = "signup_form" method = "POST" action = "http://localhost:8080/quizicle/pages/register.php">
<table id = "signup_form_table" border = "0" class = "signup_table_body">
<tr class = "signup_form_tr_label">
<td class = "signup_form_td"><label for "gamerid" class = "signup_form_label">Create a Gamer ID:</label></td>
<td class = "signup_form_td"><label for "email" class = "signup_form_label">Your Email:</label></td>
<td class = "signup_form_td"><label for "password" class = "signup_form_label">Password:</label></td>
<td class = "signup_form_td"><label for "country" class = "signup_form_label">Country:</label></td>
<td class = "signup_form_td"></td>
</tr>

<tr class = "signup_form_tr">
<td class = "signup_form_td"><input type = "text" name = "gamerid_create" id = "gamerid_create" maxlength="50" class = "signup_form_input"/></td>
<td class = "signup_form_td"><input type = "text" name = "email_create" id = "email_create" maxlength="50" class = "signup_form_input"/></td>
<td class = "signup_form_td"><input type = "password" name = "password_create" id = "password_create" maxlength="50" class = "signup_form_input"/></td>
<td class = "signup_form_td">
<select name = "country_create">                                    <option>Please select a country</option> 
<option>United Kingdom</option> 
</select>
</td>
<td class = "signup_form_td"><input type = "submit" value = "Sign me up!" id = "btn_register" value = "register" class = "signup_form_submit_btn"/></td>
</tr>   
</table>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:34:50.953

```
 <?php

include "config.php";

// INPUT CLEANING FUNCTION
function clean($str)
{
    $cleaned = mysql_real_escape_string(strip_tags($str));
    return $cleaned;
}

$gamerid = clean($_POST['gamerid_create']);
$email = clean($_POST['email_create']);
$password = clean(md5($_POST['password_create']));
$country = clean($_POST ['country_create']);

$insert = "insert into users(gamerid,email,password,country) values('$gamerid' ,'$email',' $password', '$country')";                        
mysql_query($insert);
?> 
```

1.  检查您的 id 字段是否为自动增量
2.  检查输入标签或文本区域标签的属性名称 // 可选建议
3.  使用 php 内置的 filter_var 函数验证电子邮件
4.  验证密码长度和强度
5.  还要考虑一些命名约定
6.  使用框架 CODEIGNITER 或 LARAVEL

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-19T18:31:27.190

这可能与您的主键有关`id`

让我们改变一下sql，看看它是否有效。

```
$insert = "INSERT INTO users (id, gamerid, email, password, country) 
  VALUES (NULL, '{$_POST['gamerid_create']}', '{$_POST['email_create']}', 
  '{$_POST['password_create']}', '{$_POST['country_create']}');"; 
```

在开发 PHP / MySQL 技能时，您应该考虑一些事项：

*   验证并清理您的用户输入。Sql 注入风险。请参阅：mysql_real_escape_string()，在此处获取基本帮助。

*   您应该配置您的表格，确保将字段类型和大小设置为您需要的最小值，如果您不全部填写，VARCHAR(255) 将浪费大量空间。

*   始终使用至少 md5 算法散列密码。

# rest - 在 Couchdb / Cloudant 视图上使用基于 etag 的缓存？

> ID：12980178
> 
> 赞同：2
> 
> 时间：2012-10-19T18:21:33.530
> 
> 标签：rest, http-headers, couchdb, etag, cloudant

我正在使用 Couchdb（由 Cloudant 托管）。Couchdb 的一个很酷的地方是，当您查询文档时，它支持标准的基于 http etag 的缓存（etag 是文档的 _rev 字段）。

但是，我注意到当我请求视图时，每个请求的 etag 都是不同的，即使基础文档没有更改，这违背了使用 etag 来最小化来自数据库服务器的流量的目的。

有没有我需要在某个地方调整的设置来解决这个问题？

编辑：

这是我的设计文档的链接： [https ://codeliberate.cloudant.com/crowdfunder/_design/xLgxNgK_dXEQxHbzmEiCbWE_wackXLk83xDp28ShH8Q_](https://codeliberate.cloudant.com/crowdfunder/_design/xLgxNgK_dXEQxHbzmEiCbWE_wackXLk83xDp28ShH8Q_)

这里是视图输出的链接：[https ://codeliberate.cloudant.com/crowdfunder/_design/xLgxNgK_dXEQxHbzmEiCbWE_wackXLk83xDp28ShH8Q_/_view/xLgxNgK_dXEQxHbzmEiCbWE_wackXLk83xDp28ShH8Q_](https://codeliberate.cloudant.com/crowdfunder/_design/xLgxNgK_dXEQxHbzmEiCbWE_wackXLk83xDp28ShH8Q_/_view/xLgxNgK_dXEQxHbzmEiCbWE_wackXLk83xDp28ShH8Q_)

每次我在 Chrome 中刷新视图并使用网络控制台检查服务器发送的标头时，我都会得到一个不同的 etag（例如，我最近刷新的 3 次分别得到 34c474c51f0beb87fa13755b9594c52a、39da8a25e57ba660da6a905d8374b26f 和 6c5862d81d4a9378d41c19ae）。很确定基础数据在两次刷新之间没有变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-21T13:39:38.213

您所描述的内容非常令人惊讶...只要我不更改文档，我就会永远得到相同的 etag 用于查看。它与“If-None-Match”标题配合得很好。

您确定您使用的是“真实视图”而不是：

*   暂时的看法？
*   一个列表？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-21T15:18:47.300

目前，Cloudant 支持对单个文档（其中 ETag 是文档的`_rev`字段）进行 ETag 缓存，但不支持视图 :(

# haskell - 需要另一个事件处理程序（按下按钮） Gtk2Hs

> ID：12980186
> 
> 赞同：0
> 
> 时间：2012-10-19T18:21:49.613
> 
> 标签：haskell, gtk2hs

我想在 my 中添加一个功能`buttonNewWithLabel`，因此它对按下回车键做出反应，而不仅仅是`onClicked`事件。我找不到怎么做，但不应该有那么简单`onClicked`吗？

我的代码看起来像这样：

```
grt <- labelNew Nothing
str <- entryNew

but <- buttonNewWithLabel "Action"
but `onClicked` function1 str grt 
but `onEnterPushed`function1 str grt  <---  Something like this ? 
```

里面有这样的功能`Gtk2Hs`吗？或者……还有什么我可以用的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T11:49:01.450

我一直在旁边看，并研究小部件焦点，因为它是这样工作的。

答案是在标签上添加一段代码，告诉它在进入时激活。

我的工作是：

```
--Creating label & an entry
grt <- labelNew Nothing
str <- entryNew
str `onEntryActivate` function1 str grt   <-- This works like a charm!

--Create button
but <- buttonNewWithLabel "Action"
but `onClicked` function1 str grt 
```

我对 Haskell 和 Gtk2Hs 了解得越多，我就越喜欢它！:)

//问候

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-21T05:16:41.297

```
import Graphics.UI.Gtk
import Control.Monad.IO.Class (liftIO)

main :: IO ()
main = do
  initGUI
  window <- windowNew
  button1 <- buttonNewWithLabel "button1"
  containerAdd window button1
  button1 `on` buttonPressEvent $ do
      liftIO $ putStrLn "button1 got clicked"   
      return True
  widgetShowAll window
  mainGUI 
```

# ios - 如何在具有自动布局的代码中设置 UIView 之间的标准间距？

> ID：12980194
> 
> 赞同：6
> 
> 时间：2012-10-19T18:22:23.060
> 
> 标签：ios, autolayout

在界面生成器中，我可以通过“固定”获得与“标准”间距匹配的“垂直空间”：

![在此处输入图像描述](../Images/9a102e436e8b4c09be9efea511483c23.png)![在此处输入图像描述](../Images/b7a741b0d8cc21a29e05bdc20f48bdb0.png)

在视觉约束语言中，我可以通过以下方式完成同样的事情：

```
V:[top]-[bottom] 
```

如何在代码中的两个视图之间添加标准间距？

我正在寻找可能出现在 UIViewController 中的类似内容：

```
NSLayoutConstraint *spacing = ???
[self.view addConstraint spacing]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T18:38:28.050

从 iOS 11.0（2017 年发布）开始，有一些使用系统间距的方法：

```
@interface NSLayoutXAxisAnchor (UIViewDynamicSystemSpacingSupport)
/* Constraints of the form,
 receiver [= | ≥ | ≤] 'anchor' + 'multiplier' * system space, 
 where the value of the system space is determined from information available from the anchors.
 The constraint affects how far the receiver will be positioned trailing 'anchor', per the effective user interface layout direction.
 */
- (NSLayoutConstraint *)constraintEqualToSystemSpacingAfterAnchor:(NSLayoutXAxisAnchor *)anchor multiplier:(CGFloat)multiplier __attribute__((warn_unused_result)) API_AVAILABLE(macos(11.0),ios(11.0),tvos(11.0));
- (NSLayoutConstraint *)constraintGreaterThanOrEqualToSystemSpacingAfterAnchor:(NSLayoutXAxisAnchor *)anchor multiplier:(CGFloat)multiplier __attribute__((warn_unused_result)) API_AVAILABLE(macos(11.0),ios(11.0),tvos(11.0));
- (NSLayoutConstraint *)constraintLessThanOrEqualToSystemSpacingAfterAnchor:(NSLayoutXAxisAnchor *)anchor multiplier:(CGFloat)multiplier __attribute__((warn_unused_result)) API_AVAILABLE(macos(11.0),ios(11.0),tvos(11.0));

@end

@interface NSLayoutYAxisAnchor (UIViewDynamicSystemSpacingSupport)
/* Constraints of the form,
 receiver [= | ≥ | ≤] 'anchor' + 'multiplier' * system space, 
 where the value of the system space is determined from information available from the anchors.
 The constraint affects how far the receiver will be positioned below 'anchor'. 
 If either the receiver or 'anchor' is the firstBaselineAnchor or lastBaselineAnchor of a view with text content
 then the spacing will depend on the fonts involved and will change when those do.
 */
- (NSLayoutConstraint *)constraintEqualToSystemSpacingBelowAnchor:(NSLayoutYAxisAnchor *)anchor multiplier:(CGFloat)multiplier __attribute__((warn_unused_result)) API_AVAILABLE(macos(11.0),ios(11.0),tvos(11.0));
- (NSLayoutConstraint *)constraintGreaterThanOrEqualToSystemSpacingBelowAnchor:(NSLayoutYAxisAnchor *)anchor multiplier:(CGFloat)multiplier __attribute__((warn_unused_result)) API_AVAILABLE(macos(11.0),ios(11.0),tvos(11.0));
- (NSLayoutConstraint *)constraintLessThanOrEqualToSystemSpacingBelowAnchor:(NSLayoutYAxisAnchor *)anchor multiplier:(CGFloat)multiplier __attribute__((warn_unused_result)) API_AVAILABLE(macos(11.0),ios(11.0),tvos(11.0));
@end 
```

在 Swift 中，你可以像这样使用它们：

```
let topView: UIView = ...
let bottomView: UIView = ...

bottomView.topAnchor
    .constraint(equalToSystemSpacingBelow: topView.bottomAnchor, multiplier: 1)
    .isActive = true

let leadingView: UIView = ...
let trailingView: UIView = ...

trailingView.leadingAnchor
    .constraint(equalToSystemSpacingAfter: leadingView.trailingAnchor, multiplier: 1)
    .isActive = true 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:28:43.303

混合和匹配视觉格式约束以及更冗长的单一约束创建样式（我认为您在说“代码中”时指的是）很好 - 事实上，在 WWDC 讨论自动布局时，“首选”顺序您创建约束的表述为：

*   界面构建器
*   视觉格式
*   单约束样式

除非您*需要*单一约束样式为您提供的额外功能和灵活性（并且有很多地方视觉格式不起作用，根据我迄今为止的经验），您应该使用视觉格式。听起来您是从下往上而不是自上而下接近上面的列表。

如果您想以标准间距布置视图，并且您没有使用 IB，那么使用视觉格式是有意义的。正如 Rob 所说，没有可用的“标准”间距常量，并且通过坚持对所有内容都使用单一约束，您可以为自己做更多的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-17T22:37:35.517

自发布此问题以来，已发布约束 API 以使用标准系统间距默认值：

*   [`constraint(equalToSystemSpacingAfter:multiplier:)`](https://developer.apple.com/documentation/uikit/nslayoutxaxisanchor/2866112-constraint)
*   [`constraint(greaterThanOrEqualToSystemSpacingAfter:multiplier:)`](https://developer.apple.com/documentation/uikit/nslayoutxaxisanchor/2865871-constraint)
*   [`constraint(lessThanOrEqualToSystemSpacingAfter:multiplier:)`](https://developer.apple.com/documentation/uikit/nslayoutxaxisanchor/2866018-constraint)

Apple 提供了使用此功能的示例代码，即[Creating Self-Sizing Table View Cells](https://developer.apple.com/documentation/uikit/uifont/creating_self-sizing_table_view_cells)。

# javascript - 通过缩略图单击显示手动定义的画廊（fancybox）

> ID：12980204
> 
> 赞同：4
> 
> 时间：2012-10-19T18:22:56.030
> 
> 标签：javascript, jquery, wordpress, fancybox

我正在为 Wordpress 使用一个主题，其中已经包含了 fancybox。一切正常，顺利和干净，就像它应该的那样。现在我想做一些事情，不幸的是我没有这方面的知识：

单击我发表的帖子的第一个缩略图时，会出现一个花式幻灯片并显示所有缩略图。很酷，但我希望这个幻灯片显示的不仅仅是那些缩略图。可能有 10 或 20 个文件，在本地托管。

我相信有办法做到这一点，我在另一个问题上找到了这个代码片段（[Fancy box - how to show slideshow from a single thumbnail](https://stackoverflow.com/questions/8800152/fancy-box-how-to-show-slideshow-from-a-single-thumbnail)）但无论我多么努力都无法让它工作（我可以更多或更少的“读取”代码，但编写它还不是我能做的！）

所以，是的，简单地说，我希望我的“post1”fancybox 显示 X 图片，而不是缩略图。而且，能够用 X 个不同的帖子重复这个技巧，所以我需要找到一种干净的方法来做到这一点，而不仅仅是一些结构技巧。我试图在我的帖子的 html 部分中包含上述代码，但没有奏效。

随意回答！如果您需要更多信息，请告诉我！

我相信这是我的 HTML 帖子中有趣的部分：

```
 `<div id="product-slider">
        <div id="product-slides">
                            <div class="item-slide">
    <a href="http://www.prepadem.fr/wp-content/uploads/2012/10/cheetah-picture1.jpg" rel="gallery" class="fancybox">
        <img src="http://www.prepadem.fr/wp-content/uploads/et_temp/cheetah-picture1-43518_298x226.jpg" alt="" width =298 height=226 />     <span class="overlay"></span>
   </a>
</div> <!-- .item-slide -->
                            <div class="item-slide">
    <a href="http://www.prepadem.fr/wp-content/uploads/2012/10/Angelique_thumb1.jpg" rel="gallery" class="fancybox">
        <img src="http://www.prepadem.fr/wp-content/uploads/et_temp/Angelique_thumb1-724863_267x226.jpg" alt="" width =298 height=226 />        <span class="overlay"></span>
   </a>
</div> <!-- .item-slide -->
                    </div> <!-- #product-slides -->

                    <div id="product-thumbs">
                                    <a href="#" class="active" rel="1">
                        <img src="http://www.prepadem.fr/wp-content/uploads/et_temp/cheetah-picture1-43518_69x69.jpg" alt="" width =69 height=69 />                     <span class="overlay"></span>
                    </a>
                                    <a href="#" class="last" rel="2">
                        <img src="http://www.prepadem.fr/wp-content/uploads/et_temp/Angelique_thumb1-724863_69x69.jpg" alt="" width =69 height=69 />                        <span class="overlay"></span>
                    </a>
                            </div> <!-- #product-thumbs -->
            </div> <!-- #product-slider -->` 

            回答 #1

赞同：0

时间：2012-10-20T13:24:19.010

在阅读了几个问题、外部链接等之后，这就是我发现我的问题的方式，以及我认为它是如何工作的：（对不起，如果这听起来很基本，但我会以我希望阅读的方式解释它它！新手语言：ON）

由于我的 WP 主题已经激活了 fancybox，因此我无需在我的帖子中的 HTML 代码中调用它。在我的帖子中检查我的源代码时（带有 1 个缩略图且未添加代码），我看到生成了以下代码：

```
<div id="product-slider">
        <div id="product-slides">
                            <div class="item-slide">
    <a href="http://www.prepadem.fr/wp-content/uploads/2012/10/cheetah-picture1.jpg" rel="gallery" class="fancybox">
        <img src="http://www.prepadem.fr/wp-content/uploads/et_temp/cheetah-picture1-43518_298x226.jpg" alt="" width =298 height=226 />     <span class="overlay"></span>
   </a>
</div> <!-- .item-slide -->
                    </div> <!-- #product-slides --> 
```

因此，我对幻灯片的“rel”值是“gallery”。现在，我只需要在我的帖子中添加任意数量的文件，幻灯片就可以显示它们，代码如下：

```
<a class="fancybox" rel="gallery" href="image02.jpg"></a>
<a class="fancybox" rel="gallery" href="image03.jpg"></a>
<a class="fancybox" rel="gallery" href="image04.jpg"></a> 
```

就是这样，我可以添加任意数量的图片，而它们都不会显示为缩略图！无论如何，感谢 Toni 和 Janis 的帮助，如果这个答案对其他人没有帮助，至少我很高兴能按照我想要的方式工作！

```

# windows-8 - Windows 8 Metro 应用程序侧负载部署

> ID：12980206
> 
> 赞同：2
> 
> 时间：2012-10-19T18:23:01.943
> 
> 标签：windows-8, microsoft-metro, directx, windows-store, sideloading

我目前正在开发一个 Windows 应用商店应用程序，该应用程序最终将在 ARM 设备可用时针对它们。目前，我一直在台式计算机上使用 Visual Studio 进行开发和测试，一切正常。但是，当我尝试创建一个可以传递给公司内其他人用于测试目的的应用程序包时，该应用程序将无法正常运行。

该解决方案包括两个项目。第一个是设置为构建 dll 文件的 C++ 项目。这样做的目的是公开 C# 项目似乎无法访问的 Direct2D 和 DirectWrite 库。第二个项目是 C# 项目，它引用这个 dll 来绘制函数，并包含一个 XAML 接口和大部分程序逻辑。所有这些都可以在我的开发机器上从 Visual Studio 中完美运行（以及在安装包时）。

当我将包文件发送给公司内的其他人时，使用 PowerShell 脚本安装似乎可以正常工作。磁贴出现在开始屏幕中，程序将启动几秒钟。C# 和 XAML 界面出现，但应用程序的 DirectX 部分不可见，整个应用程序将在几秒钟内关闭。这让我相信 dll 在安装时可能没有正确安装或引用。我检查了包文件，构建过程完成后，dll文件包含在包中。

我已经打包了几个不同的测试程序（MSDN 示例），它们都安装在他们的机器上，但我们得到的结果相同，它们不会运行（同样，在构建它们时，所有示例都在我的开发机器上运行良好）。唯一正常工作的测试项目是一个根本不使用 DirectX 的简单 C# 项目。我尝试的任何 DirectX 示例都失败了（包括根本不使用 C# 的本机 C++ 示例）。

需要明确的是，我用于构建的过程将转到 Project -> Store -> Create App Packages 并选择 No 选项以上传到 Windows Store。

有没有人对构建或安装过程可能出现的问题有任何想法？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T15:40:50.503

Does it work with the [Metro Sideloader](http://gallery.technet.microsoft.com/CompuSight-Metro-App-b31b65da)? I am not sure if it just adds a UI to the Powershell script, but it works for my team and me for testing...

Good luck!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T23:48:43.740

您是否将 DirectX 应用程序的调试版本加载到未安装 Windows SDK 的计算机上？Visual Studio 的默认 DirectX 项目和 MSDN 上的示例在创建 D3D 设备时都请求 D3D11_CREATE_DEVICE_DEBUG 标志。如果运行代码的机器上未安装 Windows SDK，则设备创建将失败。

以下是一些不同的选项，可让您解锁自己。这些中的任何一个都应该给你想要的结果：

*   创建一个发布包并部署它而不是调试包。

*   或 - 转到 DirectXBase.cpp 并从代码中删除 D3D11_CREATE_DEVICE_DEBUG 标志。

*   或 - 在目标计算机上安装 Visual Studio 的远程调试工具。这将安装必要的 SDK 组件以允许创建 D3D 调试设备。关于这个选项的另一个很酷的事情是，一旦你设置好了，你就不必手动创建包并再侧加载它们了。只需告诉 Visual Studio ARM 机器的名称，然后按 F5 即可远程部署它。更多信息在这里：http: [//msdn.microsoft.com/en-us/library/vstudio/bt727f1t.aspx](http://msdn.microsoft.com/en-us/library/vstudio/bt727f1t.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T18:28:52.410

您如何在项目中部署本机 DLL？您是否使用项目到项目的引用？您能否验证您的 DLL 是否在最终包中，在包应用程序目录的根目录中？

我建议使用[Sysinternals Procmon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)来监视目标机器上的应用程序负载。如果它崩溃或失败，您可以查看它试图加载和失败的 DLL 的日志历史记录。通常这将显示为一系列重复的 DLL 加载探测（它将尝试从应用程序目录加载 dll，然后继续尝试许多其他路径）。

# php - 阅读注册商标等特殊字符

> ID：12980207
> 
> 赞同：1
> 
> 时间：2012-10-19T18:23:08.537
> 
> 标签：php, symbols

我使用以下语句来读取值，并且效果很好。

`$PlaceName=$_REQUEST['PlaceName'];`

但这是上述陈述的一个问题。如果我们传递一些特殊类型的字符（如汉堡王®），那么变量 $PlaceName 包含空白值。注意这个问题的原因是注册商标的符号（®）

那么如何通过更正上述语句在 PHP 中读取这种类型的符号呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:27:57.800

你可以试试

```
header('Content-Type: text/html; charset=utf-8');
$PlaceName= "Burger King ®" ;
echo $PlaceName; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:36:56.183

它与您的编码有关，请确保您的输出设置为`utf8`.

我刚刚测试了这段代码，输出是有效的。

```
<form method="post" action="">
    <input type="text" name="name" />
    <input type="submit" />
</form>

<?php
if ($_POST){
    $name = $_POST['name'];
    echo '<pre>';
    var_dump($_POST);
    echo '</pre>';
    echo '<hr />';
    echo $name;
} 
```

# javascript - Bootstrap-Datepicker 不使用 Bootstrap-SASS 显示

> ID：12980213
> 
> 赞同：1
> 
> 时间：2012-10-19T18:23:27.777
> 
> 标签：javascript, coffeescript, ruby-on-rails-3.2, twitter-bootstrap-rails

我正在尝试在我正在创建的表单上使用 Bootstrap Datepicker。我已经阅读了这里的文档：[https](https://github.com/Nerian/bootstrap-datepicker-rails/issues/11) ://github.com/Nerian/bootstrap-datepicker-rails/issues/11并遵循它（或者我认为），但我被卡住了。

```
Gemfile:
gem 'bootstrap-sass', '2.0.4'
gem 'bootstrap-datepicker-rails' 
```

应用程序/资产/javascripts/application.js

```
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require bootstrap-datepicker
//= require_tree . 
```

app/assets/javascripts/orders.js.coffee（我将 javascript 转换为 CoffeeScript）

```
$("[data-behaviour~='datepicker']").datepicker(
  format: "yyyy-mm-dd"
  weekStart: 1
  autoclose: true
).on "changeDate", (e) -> 
```

应用程序/样式表/application.css.scss

```
 *= require_self
 *= require bootstrap-datepicker
 *= require_tree .
 */ 
```

表格（无论如何，相关部分）：

```
<%= form_for [@user, @order] do |order_form| %>

  <%= order_form.label "When would you like us to pick up your stuff?" %>
  <%= order_form.text_field :order_date, placeholder: "yyyy-mm-dd", 'data-behaviour' => 'datepicker' %> 

<% end %> 
```

当我进入控制台时，我可以在一个元素上调用 datepicker() 方法并从那里操作它的属性。但是，无论出于何种原因，页面加载时它都不起作用。并且控制台中没有任何错误。

（根据我在这里读到的内容：[Twitter bootstrap datepicker is not working in rails](https://stackoverflow.com/questions/12084644/twitter-bootstrap-datepicker-is-not-working-in-rails)，我尝试了 require_self 的东西并将 javascript 也放入了 application.js 文件中。它没有用，我不喜欢拥有的想法无论如何，application.js 文件中的 javascript...)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T22:56:12.533

我未能将 Twitter Bootstrap Datepicker 与我的应用程序集成。相反，我使用了一个标准的[jQuery datepicker](http://jqueryui.com/datepicker/)并选择了一个与我的应用程序匹配的主题。我的代码最终看起来像这样：

在表格中：

```
<%= order_form.label "When would you like us to pick up your stuff?" %>
<%= order_form.text_field :order_date, id:"datepicker" %> 
```

咖啡脚本：

```
$ ->
  $("#datepicker").datepicker({
    minDate: +1,
    dateFormat:"yy-mm-dd"
  }) 
```

我将此行添加到我的 custom.css 文件的顶部（`@import bootstrap`行之前）

```
@import url(http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/smoothness/jquery-ui.css); 
```

在 application.css.scss 中（注意我删除了 require_bootstrap-datepicker）

```
 *= require_self
 *= require_tree .
 */ 
```

我从我的 gem 文件中删除了 gem。

我不知道 Twitter Bootstrap 日期选择器看起来会有多么不同，但这个主题非常适合我的应用程序。

# c# - 如何使用服务帐户通过 .NET C# 访问 Google Analytics API V3？

> ID：12980215
> 
> 赞同：16
> 
> 时间：2012-10-19T18:23:28.770
> 
> 标签：c#, .net, oauth-2.0, dotnetopenauth, google-analytics-api

我意识到这个问题之前已经被问过，但示例代码的方式很少，所以我再次问，但至少有一点方向。

经过数小时的搜索，我想出了以下部分实现。

```
namespace GoogleAnalyticsAPITest.Console
{
    using System.Security.Cryptography.X509Certificates;
    using DotNetOpenAuth.OAuth2;
    using Google.Apis.Analytics.v3;
    using Google.Apis.Analytics.v3.Data;
    using Google.Apis.Authentication.OAuth2;
    using Google.Apis.Authentication.OAuth2.DotNetOpenAuth;

    class Program
    {
        static void Main(string[] args)
        {
            log4net.Config.XmlConfigurator.Configure();
            string Scope = Google.Apis.Analytics.v3.AnalyticsService.Scopes.Analytics.ToString().ToLower();
            string scopeUrl = "https://www.googleapis.com/auth/" + Scope;
            const string ServiceAccountId = "nnnnnnnnnnn.apps.googleusercontent.com";
            const string ServiceAccountUser = "nnnnnnnnnnn@developer.gserviceaccount.com";
            AssertionFlowClient client = new AssertionFlowClient(
                GoogleAuthenticationServer.Description, new X509Certificate2(@"7039572692013fc5deada350904f55bad2588a2a-privatekey.p12", "notasecret", X509KeyStorageFlags.Exportable))
            {
                Scope = scopeUrl,
                ServiceAccountId = ServiceAccountId//,ServiceAccountUser = ServiceAccountUser
            };
            IAuthorizationState state = AssertionFlowClient.GetState(client);
            AnalyticsService service = new AnalyticsService(authenticator);
            string profileId = "ga:xxxxxxxx";
            string startDate = "2010-10-01";
            string endDate = "2010-10-18";
            string metrics = "ga:visits";
            DataResource.GaResource.GetRequest request = service.Data.Ga.Get(profileId, startDate, endDate, metrics);
            request.Dimensions = "ga:date";
            GaData data = request.Fetch();
        }
    }
} 
```

我有几个问题。调用会`AssertionFlowClient.GetState(client)`导致“invalid_scope”响应，如 DotNetOpenAuth 日志中所示

> 2012-10-19 13:27:36,272 (GMT-4) [8] 信息 DotNetOpenAuth - DotNetOpenAuth，版本=4.0.0.11165，文化=中性，PublicKeyToken=2780ccd10d57b246（官方）2012-10-19 13:27:36,284（ GMT-4) [8] 调试 DotNetOpenAuth.Messaging.Channel - 准备发送 AssertionFlowMessage (2.0) 消息。2012-10-19 13:27:36,294 (GMT-4) [8] INFO DotNetOpenAuth.Messaging.Channel - 为[https://accounts.google.com/o/oauth2/token](https://accounts.google.com/o/oauth2/token)准备传出 AssertionFlowMessage (2.0) 消息：grant_type : assertion assertion_type: [http://oauth.net/grant_type/jwt/1.0/bearer](http://oauth.net/grant_type/jwt/1.0/bearer) assertion: (一堆编码字符到这里)
> 
> 2012-10-19 13:27:36,296 (GMT-4) [8] 调试 DotNetOpenAuth.Messaging.Channel - 发送 AssertionFlowMessage 请求。2012-10-19 13:27:36,830 (GMT-4) [8] 调试 DotNetOpenAuth.Http - HTTP POST [https://accounts.google.com/o/oauth2/token](https://accounts.google.com/o/oauth2/token) 2012-10-19 13:27:36,954 (GMT-4) [8] 错误 DotNetOpenAuth.Http - 来自[https://accounts.google.com/o/oauth2/token](https://accounts.google.com/o/oauth2/token)的 WebException : { "error" : "invalid_scope" }

我尝试指定 ServiceAccountId 和 ServiceAccountUser 中的一个或两个，但没有成功。

其次，即使我获得了 IAuthorizationState，我也不确定如何获得可以传递给 AnalyticsService 构造函数的 IAuthenticator。

以下是我用来启用 D​​otNetOpenAuth 日志记录的 web.config。

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,log4net, Version=1.2.10.0, Culture=neutral, publicKeyToken=1b44e1d426115821" />
    <!--<section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler" requirePermission="false"/>-->
    <sectionGroup name="dotNetOpenAuth" type="DotNetOpenAuth.Configuration.DotNetOpenAuthSection, DotNetOpenAuth">
      <section name="openid" type="DotNetOpenAuth.Configuration.OpenIdElement, DotNetOpenAuth" requirePermission="false" allowLocation="true"/>
      <section name="oauth" type="DotNetOpenAuth.Configuration.OAuthElement, DotNetOpenAuth" requirePermission="false" allowLocation="true"/>
      <section name="messaging" type="DotNetOpenAuth.Configuration.MessagingElement, DotNetOpenAuth" requirePermission="false" allowLocation="true"/>
      <section name="reporting" type="DotNetOpenAuth.Configuration.ReportingElement, DotNetOpenAuth" requirePermission="false" allowLocation="true"/>
    </sectionGroup>
  </configSections>
  <log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
      <file value="DotNetOpenAuth.log"/>
      <appendToFile value="true"/>
      <rollingStyle value="Size"/>
      <maxSizeRollBackups value="10"/>
      <maximumFileSize value="100KB"/>
      <staticLogFileName value="true"/>
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date (GMT%date{%z}) [%thread] %-5level %logger - %message%newline"/>
      </layout>
    </appender>
    <appender name="TracePageAppender" type="OpenIdProviderWebForms.Code.TracePageAppender, OpenIdProviderWebForms">
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date (GMT%date{%z}) [%thread] %-5level %logger - %message%newline"/>
      </layout>
    </appender>
    <!-- Setup the root category, add the appenders and set the default level -->
    <root>
      <level value="ALL"/>
      <appender-ref ref="RollingFileAppender"/>
      <appender-ref ref="TracePageAppender"/>
    </root>
    <!-- Specify the level for some specific categories -->
    <logger name="DotNetOpenAuth">
      <level value="ALL"/>
    </logger>
  </log4net>
  <dotNetOpenAuth>
    <!-- This is an optional configuration section where aspects of dotnetopenauth can be customized. -->
    <!-- For a complete set of configuration options see http://www.dotnetopenauth.net/developers/code-snippets/configuration-options/ -->
    <!--<messaging clockSkew="00:10:00" lifetime="00:03:00" strict="true">-->
    <!--<messaging>
      <untrustedWebRequest timeout="00:00:30" readWriteTimeout="00:00:01.500" maximumBytesToRead="1048576" maximumRedirections="10">
        <whitelistHosts>
          -->
    <!-- Uncomment to enable communication with localhost (should generally not activate in production!) -->
    <!--
          <add name="localhost"/>            
        </whitelistHosts>
      </untrustedWebRequest>
    </messaging>-->
    <!-- Allow DotNetOpenAuth to publish usage statistics to library authors to improve the library. -->
    <reporting enabled="false"/>
  </dotNetOpenAuth>
  <appSettings>
    <!--<add key="log4net.Internal.Debug" value="true" />-->
  </appSettings>
  <runtime>
  </runtime>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
</configuration> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-22T14:11:44.093

以下代码，从我原来的问题更正，基于 Ian Fraser 在以下位置提供的示例：

[https://groups.google.com/forum/#!msg/google-search-api-for-shopping/4uUGirzH4Rw/__c0e4hj0ekJ](https://groups.google.com/forum/#!msg/google-search-api-for-shopping/4uUGirzH4Rw/__c0e4hj0ekJ)

他的代码解决了三个问题：

1.  似乎 AnalyticsService.Scopes.AnalyticsReadonly 不起作用，至少对我或我这样做的方式不起作用。
2.  出于某种原因，必须将 ServiceAccountUser 分配给 AssertionFlowClient 实例的 ServiceAccountId 属性。
3.  OAuth2Authenticator 提供了我正在寻找的 IAuthenticator。

在您的项目中，包括对以下内容的引用：

*   Lib\DotNetOpenAuth.dll
*   库\Google.Apis.dll
*   Lib\Google.Apis.Authentication.OAuth2.dll
*   服务\AnalyticsService\Google.Apis.Analytics.v3.dll

-

```
namespace GoogleAnalyticsAPITest.Console
{
    using System.Security.Cryptography.X509Certificates;
    using Google.Apis.Analytics.v3;
    using Google.Apis.Analytics.v3.Data;
    using Google.Apis.Authentication.OAuth2;
    using Google.Apis.Authentication.OAuth2.DotNetOpenAuth;
    using Google.Apis.Util;

    class Program
    {
        static void Main(string[] args)
        {
            log4net.Config.XmlConfigurator.Configure();            
            const string ServiceAccountId = "nnnnnnnnnnn.apps.googleusercontent.com";
            const string ServiceAccountUser = "nnnnnnnnnnn@developer.gserviceaccount.com";
            AssertionFlowClient client = new AssertionFlowClient(
                GoogleAuthenticationServer.Description, new X509Certificate2(@"value-privatekey.p12", "notasecret", X509KeyStorageFlags.Exportable))
            {
                Scope = AnalyticsService.Scopes.AnalyticsReadonly.GetStringValue(),
                ServiceAccountId = ServiceAccountUser //Bug, why does ServiceAccountUser have to be assigned to ServiceAccountId
                //,ServiceAccountUser = ServiceAccountUser
            };
            OAuth2Authenticator<AssertionFlowClient> authenticator = new OAuth2Authenticator<AssertionFlowClient>(client, AssertionFlowClient.GetState);            
            AnalyticsService service = new AnalyticsService(authenticator);            
            string profileId = "ga:64968920";
            string startDate = "2010-10-01";
            string endDate = "2010-10-31";
            string metrics = "ga:visits";
            DataResource.GaResource.GetRequest request = service.Data.Ga.Get(profileId, startDate, endDate, metrics);
            request.Dimensions = "ga:date";
            GaData data = request.Fetch();            
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-30T00:15:35.817

我昨天检查了分析 API，注意到它是多么无证，也没有样本等。

无论如何，我创建了一个库，您可以使用它通过几行轻松访问分析，并直接将数据绑定到 DataTables 以获取返回的数据，它在 github 上是开源的，所以请随意贡献:)

[https://github.com/rmostafa/DotNetAnalyticsAPI](https://github.com/rmostafa/DotNetAnalyticsAPI)

用法

```
Analytics.AnalyticsManager manager = new Analytics.AnalyticsManager(Server.MapPath("~/bin/privatekey.p12"), "YOUR_EMAIL");
            manager.LoadAnalyticsProfiles();

List<Analytics.Data.DataItem> metrics = new List<Analytics.Data.DataItem>();
metrics.Add(Analytics.Data.Visitor.Metrics.visitors);
metrics.Add(Analytics.Data.Session.Metrics.visits);
List<Analytics.Data.DataItem> dimensions = new List<Analytics.Data.DataItem>();
dimensions.Add(Analytics.Data.GeoNetwork.Dimensions.country);
dimensions.Add(Analytics.Data.GeoNetwork.Dimensions.city);

System.Data.DataTable table = manager.GetGaDataTable(DateTime.Today.AddDays(-3), DateTime.Today, metrics, dimensions, null, metrics); 
```

所有 Google API 报告命令都有直接的代码映射，其分类方式与 API 相同，因此即使根本不阅读 API 文档，您也可以使用它，因为属性中记录了所有功能，我编写了解析完整 api 文档的代码和资源化了我从物理类生成的 XML 中的 Metrics、Dimensions、Calculated Features，您可以像上面的示例一样直接使用它们，玩起来很有趣 :) 享受

[https://github.com/rmostafa/DotNetAnalyticsAPI](https://github.com/rmostafa/DotNetAnalyticsAPI)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-11T21:47:34.560

```
string scope = Google.Apis.Util.Utilities.GetStringValue(AnalyticsService.Scopes.AnalyticsReadonly); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-20T02:55:40.287

这是我在此处发布的工作示例 [1]：[Automated use of google-api-dotnet-client with OAuth 2.0](https://stackoverflow.com/questions/12429392/automated-use-of-google-api-dotnet-client-with-oauth-2-0/12603329#12603329)我对查找和拼凑代码进行了大量研究，希望这可以节省您一些时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-18T12:31:45.077

关于 Richard Collette 的回答，如果您想在 READONLY 模式下使用 Analytics API，请注意使用他的方法，正确的使用方法是：

```
string Scope = "analytics.readonly" 
```

并不是

```
string Scope = AnalyticsService.Scopes.AnalyticsReadOnly.ToString().ToLower() 
```

正如他似乎告诉有一个错误。事实上，错误在于该`.toString()`方法返回`analyticsreadonly`而不是`analytics.readonly`Google 喜欢的方式。就是这样。

# java - SaveOrUpdate 时出现唯一约束违规错误

> ID：12980217
> 
> 赞同：4
> 
> 时间：2012-10-19T18:23:37.380
> 
> 标签：java, multithreading, hibernate, unique-constraint

我有一个名为客户的休眠实体，其中包含有关客户的信息。在我的方法中，我将客户详细信息作为参数获取，我需要将其插入数据库中。因此，要删除重复的条目，我会检查该客户是否已经存在于数据库中。但问题是，如果在同一时刻使用相同的客户信息对相同的方法进行两次调用，那么我会遇到约束违规错误。我认为 saveOrupdate() 会解决问题，但它没有。有人可以为这种情况提出解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T18:34:01.890

saveOrUpdate 用于完全不同的目的。它用于持久化一个可能已经持久化的实体（具有一个 id 和所有），或者它可能是一个新的 id。它与并发访问无关。

对于您的问题，有两种选择，称为乐观锁定和悲观锁定。

**悲观锁定：**您在检查客户是否存在之前创建一个锁，因此只有当前线程可以继续，它会检查并采取相应的行动。任何其他带有相同数据的线程都必须等到第一个线程的更新或插入完成。如果您在单台机器上运行，可以使用休眠或简单的同步块在数据库中实现锁定。

**乐观锁定：**您只需像现在一样继续前进。但是您放置了一个异常处理程序来处理您在问题中描述的碰撞情况。

悲观锁定使用同步块可能更容易实现，但它会非常糟糕地影响性能和可伸缩性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T18:31:09.930

**`saveOrUpdate`作用于对象中的主键属性值，**例如，如果`0`是新对象的默认值，并且您的新`customer`对象设置了主键属性，`0`那么它将始终尝试保存（插入）并且从不尝试更新。只有当主键属性为非零值时，它才会尝试更新。这就是`saveOrUpdate`没有解决您的问题的原因。

我不确定你能做些什么比处理`unique`约束异常更好。

# plone - 我需要一个合理简单的 Plone 项目目录结构

> ID：12980220
> 
> 赞同：1
> 
> 时间：2012-10-19T18:23:41.863
> 
> 标签：plone

我被要求用 Plone 建立一个网站。我也想为这个项目使用 git 版本控制。理想情况下，我会将我所做的所有工作都存储在一个目录中——我的项目目录——这也将使版本控制变得简单。谁能指出我解释如何做到这一点的资源？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:56:21.410

我们将公司项目框架保存在[https://github.com/niteoweb/niteoweb.skel.plone](https://github.com/niteoweb/niteoweb.skel.plone)。

它有一些我们内部的细节，但应该是可用的。至少作为一个参考点。

# python - Python 压缩运行长度编码

> ID：12980229
> 
> 赞同：3
> 
> 时间：2012-10-19T18:24:09.860
> 
> 标签：python, image, compression, run-length-encoding

我正在尝试了解运行长度编码，但我在网上发现了这个我做不到的挑战。它要求您编写一个名为 compression(strg) 的压缩函数，它将长度为 64 的二进制字符串 strg 作为输入并返回另一个二进制字符串作为输出。输出二进制字符串应该是输入字符串的游程编码。

> > > 压缩（'1010101001010101101010100101010110101010010101011010101001010101'）
> > > 
> > > '1010101001010101*4'

这是我所拥有的，但这没有找到模式：

```
from itertools import *

def compression(strg):
    return [(len(list(group)),name) for name, group in groupby(strg)] 
```

我需要一些帮助来解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T18:42:25.547

我相信您将 RLE 与 Lempel/Ziv 滑动窗口压缩混为一谈。

RLE 严格处理重复字符： `WWWWWWWW`=>`W8`

[LZ](http://en.wikipedia.org/wiki/LZ77)有一个滑动窗口，可以根据您的描述拾取模式。

David MacKay 的[网站](http://www.inference.phy.cam.ac.uk/mackay/python/compress/)有 Python 中的示例压缩代码，包括 LZ

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T01:44:52.530

This is an example of a [longest repeated substring problem](http://en.wikipedia.org/wiki/Longest_repeated_substring_problem). It is classically solved with a [suffix tree](http://en.wikipedia.org/wiki/Suffix_tree) data structure.

For *short* strings, you can use a form of a regex:

```
import re

s1='1010101001010101101010100101010110101010010101011010101001010101'

i=2
l=s1
j=len(l)/2
while i<len(s1):
    m=re.search('^(.{'+str(j)+'})\\1$',l)
    if m:
        l=m.group(1)
        i,j=i+1,len(l)/2
        continue
    else:
        print '{0} * {1} = {2}'.format(l,i,s1)
        break 
```

Prints your output. Note this only works for strings that have complete symmetry from the middle -- a small subset of this type of problem. To compress other types of strings, you would need a representational grammar of how the replaced elements are being substituted.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-09T04:58:43.990

这个问题的答案和详细解释在以下链接中给出：

[使用 run-length codig 通过 def compress(S) 函数进行图像压缩](https://stackoverflow.com/questions/31715376/image-compression-by-def-compresss-function-using-run-length-codig/32463892#32463892)

希望它能让您清楚地了解字符串和二进制压缩的运行长度编码。此编码是在不使用任何 re 和 itertools 的情况下完成的。

# wpf - 将图像添加到工具提示中

> ID：12980236
> 
> 赞同：7
> 
> 时间：2012-10-19T18:24:42.670
> 
> 标签：wpf, image, tooltip, textblock

我有一些带有工具提示的 TextBlocks，我想将图像添加到工具提示中（这意味着，我希望有带有文本和图像的工具提示）。

有谁知道我怎么能以简单的方式做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-19T18:27:43.643

这是处理它的一种方法：

```
<TextBlock>
    <TextBlock.ToolTip>
        <StackPanel Orientation="Horizontal">
            <Image Source="images/Item 2.gif" />
            <TextBlock>My tooltip text</TextBlock>
        </StackPanel>
     </TextBlock.ToolTip>

    Here is my text.
</TextBlock> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:28:42.643

代替

```
<TextBlock ToolTip="Content"/> 
```

你可以做：

```
<TextBlock>
    <TextBlock.ToolTip>
    <!--insert everything you want here-->
        <TextBlock Text="Content"/>
    </TextBlock.ToolTip>
</TextBlock> 
```

# html - 如何从静态页面向 Rails 应用程序提交表单内容？

> ID：12980237
> 
> 赞同：3
> 
> 时间：2012-10-19T18:24:46.757
> 
> 标签：html, ruby-on-rails, ruby

我有一个现有的静态 HTML 页面，我希望添加一个电子邮件注册表单。为了节省时间，我不想将页面重新创建为视图。是否可以使用静态表单向 Rails 控制器提交新电子邮件？

在 HTML 页面上：

```
<form method="POST" action="" class="emails">
<input type="text" class="inputbox">
<input type="submit" value="Sign up" class="button" />
</form> 
```

现有的 Rails 控制器：

```
def create
  @subscription = Subscription.new(params[:subscription])

  respond_to do |format|
    if @subscription.save
      format.html { redirect_to @subscription, notice: 'Subscription was successfully created.' }
      format.json { render json: @subscription, status: :created, location: @subscription }
    else
      format.html { render action: "new" }
      format.json { render json: @subscription.errors, status: :unprocessable_entity }
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:30:28.230

输入上的`name`属性将确定 中的哈希键`params`。

那么那么

```
<input type="text" name="foo"> 
```

将通过

```
params[:foo] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:45:37.493

使用`<input type="text" class="inputbox" name ="subscription[name]">`假设名称是订阅表中的字段。

# ruby-on-rails - 如何在 Capistrano 部署期间放入 shell

> ID：12980238
> 
> 赞同：2
> 
> 时间：2012-10-19T18:25:00.010
> 
> 标签：ruby-on-rails, shell, deployment, capistrano

有时，在 Capistrano 部署期间会发生错误，无法提供足够的输出来进行故障排除。例如：

```
 * executing "cd /apps/my_app/releases/20121019181838 && bundle exec rake RAILS_ENV=dev RAILS_GROUPS=assets assets:precompile"
    servers: ["myserver.com"]
    [myserver.com] executing command
*** [err :: myserver.com] rake aborted!
*** [err :: myserver.com] Connection refused - connect(2)
*** [err :: myserver.com] 
*** [err :: myserver.com] Tasks: TOP => environment
*** [err :: myserver.com] (See full trace by running task with --trace)
    command finished in 2388ms
*** [deploy:update_code] rolling back
  * executing "rm -rf /apps/my_app/releases/20121019181838; true" 
```

在 rake 任务期间出了点问题，看起来它可能与 DB 有关。但是为了解决这个问题，我需要重新创建部署条件；唉，条件已经`rm -rf`制定。

有什么方法可以让 Capistrano 在这里使用 a `before`or `after`hook 掉到（Cap 或 bash）shell 中？`--trace`有没有一种简单的方法可以在不覆盖 Capistrano 类的情况下将 a 插入到该 rake 任务中？其他想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:23:58.407

我通过以下方式处理此类情况：

*   当我可以足够快时，我只需点击`CTR+Z`（它“暂停”上限过程），然后我在现场调查事情（结束`ssh`，或`cap console`）。
*   我在运行任务时设置了 debug ( `cap --debug`) 标志——这使得 cap 在每个远程命令执行之前提示我，所以我可以在每一步之前/之后调查情况。

这两种方式通常足以让我很快处理大多数情况。希望他们也能帮助你。

# c# - 使用互操作查找 Word 文档部分中的页数

> ID：12980242
> 
> 赞同：2
> 
> 时间：2012-10-19T18:25:03.790
> 
> 标签：c#, ms-word, vsto, office-interop

我正在尝试使用 c# 中的 Interop 查找 Word 文档部分中的页数。

主要目标实际上是找出标题是否可见。（例如，文档只有 1 页，`DifferentFirstpageHeaderFooter`已启用，因此`wdHeaderFooterPrimary`存在但技术上未显示（因为只有 1 页而不是 2 页或更多）。）因此，如果您能找到不同的方法来弄清楚如何做到这一点，我也很好。

目前，`WdInformation.wdActiveEndPageNumber`如果文档中只有 1 个部分，但如果有 2 个部分，并且我正在处理第二部分，则可以为我`wdActiveEndPageNumber`提供包括第 1 部分在内的总页数。

```
var section = headerFooter.Parent as Section;
int numOfPages = section.Range.Information[WdInformation.wdActiveEndPageNumber]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-21T14:32:14.580

我没有为此的 C#，但是使用 VBA 语法，“n 节”需要的是

一个。如果`n = 1`那么你看

```
theDocument.sections[1].Range.Information[WdInformation.wdActiveEndPageNumber] 
```

湾。如果`n > 1`你确定第 n 部分存在，那么看看

```
theDocument.sections[n].Range.Information[WdInformation.wdActiveEndPageNumber]-
theDocument.sections[n-1].Range.Information[WdInformation.wdActiveEndPageNumber] 
```

请注意，如果您在第 n 部分的最后一页上有连续的分节符，则案例 (b) 可以返回 0。我不知道这对于您将拥有的标题意味着什么，但我希望这意味着您只有第一页标题。

# javascript - 预加载图像的最佳方式

> ID：12980245
> 
> 赞同：5
> 
> 时间：2012-10-19T18:25:17.217
> 
> 标签：javascript, html, dom

我的页面上有一个 img 标签，该标签从这个数组中提供了不同的来源：

```
 preload_image_object = new Image();
    var images = new Array();
    images[0] = "images/01.jpg";
    images[1] = "images/02.jpg";
    images[2] = "images/03.jpg";
    images[3] = "images/04.jpg";
    images[4] = "images/05.jpg";

    //Preload images for faster page response
    for (var i=0; i < images.length; i++) {
        preload_image_object.src = images[i];
    }; 
```

我一次只显示一张图像，但我发现它们非常大（每个几兆）。我最初需要这些加载，这样当我转到下一张图像时，它就会出现。目前，我正在为其开发的 iPad 有一点延迟。

预加载这些图像的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:42:53.257

您可以尝试纯 CSS 图像预加载：

```
body:after {
  content: url("images/01.jpg") url("images/02.jpg");
  display: none;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:30:41.370

任何形式的预加载图像都将使用与您的方法和 jfriend00 中的方法相同的方法。即使使用 jquery 也会做同样的事情。

您可以优化循环（捕获数组的长度等），但节省了一点。

您会看到更明显的优化图像本身

CSS精灵是一种选择吗？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-19T18:30:26.423

用这个。问你是否有什么不明白的地方。

```
jQuery(document).ready(function () {           
    preload([
        'path to img 1',
        'path to img 2',
        .... array of all images

    ]);

    function preload(images) {
        if (typeof document.body == "undefined") return;
        try {    
            var div = document.createElement("div");
            var s = div.style;
            s.position = "absolute";
            s.top = s.left = 0;
            s.visibility = "hidden";
            document.body.appendChild(div);
            div.innerHTML = "<img src=\"" + images.join("\" /><img src=\"") + "\" />";
            var lastImg = div.lastChild;
            lastImg.onload = function () {
                document.body.removeChild(document.body.lastChild);
            };
        }
        catch (e) {
            // Error. Do nothing.
        }
    }
}); 
```

# nhibernate - Fluent NHibernate 单向关系导致许多更新

> ID：12980246
> 
> 赞同：0
> 
> 时间：2012-10-19T18:25:19.800
> 
> 标签：nhibernate, fluent, relationships

我一般在 StackOverflow 和 google 上进行了一些搜索，但我仍然无法找出为什么会发生这种情况以及如何解决它。我是 NHibernate 和 FluentNHibernate 的新手，所以请保持温和 :)

在做一些集成测试时，我发现如果我只是修改卖家名称，NHibernate 会为所有联系人和登录生成更新脚本，并删除 Contact_Seller 中的所有引用并读取它们。

我觉得我应该在我的地图中执行类似 Inverse() 的操作，但我不知道如何，因为 Contact 和 Login 在我的对象模型中没有对卖家或买家的引用。

这是我的设置（对象、地图和数据库）。如果您需要更多信息，请告诉我，谢谢。

```
class Buyer{
    public int BuyerID {get;set;}
    public Login Login {get;set;}
    public IList<Contact> Contacts  {get;set;}
    ... Other Buyer properties ...

}
class Seller{
    public int SellerID {get;set;}  
    public Login Login {get;set;}
    public IList<Contact> Contacts  {get;set;}
    public string Name {get;set;}
    ... Other Seller properties ...
}
class Login{
    public int LoginID {get;set;}
    public string Username {get;set;}
    public byte[] Password {get;set;}
    public string Email {get;set;}
}
class Contact{
    public int ContactID {get;set;}
    ... Contact Info...
}

public BuyerMap()
{    
    Id(x => x.BuyerID);

    ... Other Seller properties ...

    HasManyToMany(x => x.Contacts).Table("Contact_Buyer").Cascade.All();            
    References(x => x.Login).Cascade.All();

}

public SellerMap()
{    
    Id(x => x.SellerID);

    ... Other Seller properties ...

    HasManyToMany(x => x.Contacts).Table("Contact_Seller").Cascade.All();           
    References(x => x.Login).Cascade.All();

}
public LoginMap()
    {
        Id(x => x.LoginID);

        Map(x => x.Username);
        Map(x => x.Password);
        Map(x => x.Email);

    }

public ContactMap()
{
    Id(x => x.ContactID);

        ... Other Contact properties ...        

}

TABLE Buyer(
    [BuyerID] [int] IDENTITY(1,1) NOT NULL, 
    [LoginID] [int] NULL,
    ... Other Buyer fields ...
    )

TABLE Seller(
    [SellerID] [int] IDENTITY(1,1) NOT NULL,    
    [LoginID] [int] NOT NULL,
    [Name]     [varchar] NOT NULL,
    ... Other Seller fields ...
    )

TABLE Login(
    [LoginID] [int] IDENTITY(1,1) NOT NULL,     
    ... Other Login fields ...
    )

TABLE Contact(
    [ContactID] [int] IDENTITY(1,1) NOT NULL,   
    ... Other Contact fields ...
    )

TABLE Contact_Seller(
    [ContactID] [int] NOT NULL, 
    [SellerID]  [int] NOT NULL, 
    )

TABLE Contact_Buyer(
    [ContactID] [int] NOT NULL, 
    [BuyerID]  [int] NOT NULL,  
    ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:58:14.700

查看您对联系人顺序不感兴趣的映射，但我认为它们应该是唯一的。所以将联系人集合更改为`ICollection<Contact>`和

```
HasManyToMany(x => x.Contacts).AsSet(); 
```

NHibernate 可以优化一些访问，因为它知道链接表包含唯一的对。

# html - 页面加载后插入输入类型密码的神秘样式属性

> ID：12980255
> 
> 赞同：0
> 
> 时间：2012-10-19T18:26:21.600
> 
> 标签：html, firefox, input, passwords, placeholder

页面加载后，神秘的样式属性插入输入类型密码标签！？

```
Page source:
<input type="password" placeholder="password">
Style sheet:
input:-moz-placeholder {
    color: #999999;
}
After Load (Firebug):
<input type="password" placeholder="password" style="font-weight: 500; font-style: normal; color: rgb(0, 0, 0);"> 
```

截图，![黑色占位符而不是灰色](../Images/f0ce61b10dc3915d8d0968a678f1acb4.png)
示例，[http://jsfiddle.net/LaxkL/](http://jsfiddle.net/LaxkL/)
效果，更改占位符颜色，它恰好 type=password only
受影响的浏览器，Firefox 13+（我在 Mac 上使用的第一个版本）在 Mac OS X 上

**问题，我该如何解决这个问题，所以所有输入占位符都具有相同的颜色？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T21:31:41.753

我在 Firefox 16.0.1 上查看此内容，似乎没有问题。随着对占位符属性的支持增加，它可能已修复。

# c++ - for 循环范围问题

> ID：12980256
> 
> 赞同：0
> 
> 时间：2012-10-19T18:26:23.437
> 
> 标签：c++, arduino

我正在使用如下代码：

```
const int NUMBER_OF_FIELDS = 3;
int fieldIndex = 0;
int values[NUMBER_OF_FIELDS];

void setup()
  {
  Serial.begin(9600);
  }

void loop()
  {
   if(Serial.available())
    {
     char ch = Serial.read();
     if(ch>='0' && ch <= '9')
       {
       values[fieldIndex] = (values[fieldIndex]*10 +(ch-'0'));
       }
      else if (ch == ',')
       {
        if(fieldIndex < NUMBER_OF_FIELDS -1)
        fieldIndex++;
       }
      else 
       {
       Serial.print(fieldIndex+1);
       Serial.println("fields recieved:");
       for (int i = 0; i<=fieldIndex; i++);
         {
         //Serial.println(values[i]);
         //values[i]= 0;
         }
        fieldIndex = 0; 
       } 
    } 
  } 
```

但我收到一条错误消息：

'i' 的名称查找已更改为新的 ISO 'for' 范围

我认为我在 for 循环中没有做错任何事情，那么为什么会出现此错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T18:30:12.603

在 for 之后有一个分号，因此仅具有 for 循环范围的 int i 在 for 循环之外无效。

您可能打算执行以下操作。

```
 for (int i = 0; i<=fieldIndex; i++)     // no semicolon
  {
     Serial.println(values[i]);
     values[i]= 0;
  } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T18:30:29.447

您“关闭” for 循环的问题`;`

```
for (int i = 0; i<=fieldIndex; i++); // <----- 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-19T18:30:19.727

```
for (int i = 0; i<=fieldIndex; i++); <----- 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-19T18:31:27.263

问题是你的`for`循环什么都不做：循环的主体在循环之后的分号处结束：

```
for (int i = 0; i<=fieldIndex; i++);
                                   ^ here 
```

也就是说，如果你取消注释`i`循环后面的块中的使用，你会得到一个错误。这在某些编译器中曾经是合法的，即`i`在`for`循环中声明的实际上是在封闭范围内声明的。这在标准化期间发生了变化（对于 C++ 1998）。

# xml - 使用 XPATH 和 XSLT 基于属性值的某些相等条件提取 XML 中相关的不同元素标签

> ID：12980257
> 
> 赞同：3
> 
> 时间：2012-10-19T18:26:25.453
> 
> 标签：xml, xslt, xpath, xslt-2.0, break

我需要使用 XPATH 和 XSLT 以某种特定方式从 XML 中提取数据

```
<data>      
    <person id="p1">         
        <name>User1</name>      
    </person>   
    <person id="p2">         
        <name>User2</name>      
    </person>  
    <person id="p3">         
        <name>User3</name>      
    </person>       
    <employee eid="emp1" pid="p1">         
        <dept>dept1</dept>      
    </employee> 
    <employee eid="emp2" pid="p3">         
        <dept>dept3</dept>      
    </employee>
    <employee eid="emp3" pid="p2">         
        <dept>dept1</dept>      
    </employee>
</data> 
```

从上面的示例中，我需要在输出 xml 中使用 Person 和相应的 Employee 元素创建每个 XML。这两个xml之间的链接是

person.id = 员工.pid

像 XML1：

```
<person id="p1">         
<name>User1</name>      
</person>  
<employee eid="emp1" pid="p1">         
<dept>dept1</dept>      
</employee> 
```

XML2：

```
<person id="p2">         
<name>User2</name>      
</person> 
<employee eid="emp3" pid="p2">         
 <dept>dept1</dept>      
</employee> 
```

XML3：

```
<person id="p3">         
<name>User3</name>      
</person> 
<employee eid="emp2" pid="p3">         
<dept>dept3</dept>      
</employee> 
```

我尝试了很多方法，但无法做到这一点。

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:44:25.467

**XPath 是一种用于 XML 文档的*查询*语言——因此 XPath 表达式的求值不能修改现有文档或创建新的 XML 文档**。

**使用 XSLT 2.0 可以最好地实现您想要的（如果只需要一个结果文档，则使用 XSLT 1.0）：**

```
<xsl:stylesheet version="2.0"   xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:key name="kEmpByPid" match="employee" use="@pid"/>

 <xsl:template match="person">
  <xsl:result-document href="file:///c:/temp/delete/XML{position()}">
      <t>
             <xsl:copy-of select=".|key('kEmpByPid', @id)"/>
         </t>
     </xsl:result-document>
 </xsl:template>
 <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**当此 XSLT 2.0 转换应用于提供的 XML 文档时：**

```
<data>
    <person id="p1">
        <name>User1</name>
    </person>
    <person id="p2">
        <name>User2</name>
    </person>
    <person id="p3">
        <name>User3</name>
    </person>
    <employee eid="emp1" pid="p1">
        <dept>dept1</dept>
    </employee>
    <employee eid="emp2" pid="p3">
        <dept>dept3</dept>
    </employee>
    <employee eid="emp3" pid="p2">
        <dept>dept1</dept>
    </employee>
</data> 
```

在“c:\temp\delete”中创建了以下三个 XML 文档：

**XML1**：

```
<t>
   <person id="p1">
      <name>User1</name>
   </person>
   <employee eid="emp1" pid="p1">
      <dept>dept1</dept>
   </employee>
</t> 
```

**XML2**：

```
<t>
   <person id="p2">
      <name>User2</name>
   </person>
   <employee eid="emp3" pid="p2">
      <dept>dept1</dept>
   </employee>
</t> 
```

**XML3**：

```
<t>
   <person id="p3">
      <name>User3</name>
   </person>
   <employee eid="emp2" pid="p3">
      <dept>dept3</dept>
   </employee>
</t> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T19:55:16.777

对于上面的问题，我有以下解决方案。

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes" />
    <xsl:strip-space elements="*" />

    <xsl:template match="//person">
        <xsl:variable name="ID" select="@id" />
        <xsl:result-document href="file:///c:/temp/delete/XML{position()}">
        <t>
            <xsl:copy-of select=". | //employee[@pid=$ID]" />
        </t>                
        </xsl:result-document>
    </xsl:template>
    <xsl:template match="text()" />
</xsl:stylesheet> 
```

只是想和你分享。

谢谢。

# haskell - 计算一棵树的叶子数量

> ID：12980258
> 
> 赞同：1
> 
> 时间：2012-10-19T18:26:27.757
> 
> 标签：haskell, tree

使用 Haskell，我正在编写一个计算树中叶子总数的函数。我已经将树定义为：

```
data Tree a = Leaf | Node a (Tree a) (Tree a) 
```

我编写了一个通过以下方式执行此操作的函数：

```
countL :: Tree a -> Int
countL Leaf = 1
countL (Node x tL tR) = (countL tL) + (countL tR) 
```

这可行，但我想通过使用 fold 函数做同样的事情来更进一步。我通过以下方式定义的树有一个工作折叠功能：

```
mytFold :: (a -> b -> b -> b) -> b -> Tree a -> b
mytFold f g Leaf = g
mytFold f g (Node a xl xr) = f a (mytFold f g xl) (mytFold f g xr) 
```

我试图包含 fold 函数（也使用了我通过这样做定义的辅助函数：

```
countL' :: Tree a -> Integer
countL' Leaf = 1
countL' = mytFold leafy 0 where
        leafy tL tR = tL + tR 
```

但是我遇到了一些奇怪的错误。有人对出了什么问题有任何见解吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T18:34:22.317

有两个句法/类型问题。首先，每个顶级绑定必须有相同数量的参数，所以

```
countL' Leaf = ..
countL' = .. 
```

无效。一种解决方案是

```
countL' Leaf = ..
countL' tree = mytFold leafy 0 tree 
```

完成此操作后，GHC 会给您一个错误，例如

```
 Couldn't match expected type `Integer -> Integer'
                with actual type `Integer'
    Expected type: Integer -> Integer -> Integer -> Integer
      Actual type: Integer -> Integer -> Integer
    In the first argument of `mytFold', namely `leafy'
    In the expression: mytFold leafy 0 tree 
```

这是因为`mytFold`需要一个 3 参数函数作为它的第一个参数，并且`leafy`只需要 2。通过使用`leafy _ tL tR = tL + tR`.

* * *

但是，一旦你这样做了，你会发现这给出了错误的答案：`countL' (Node 1 Leaf Leaf) == 0`. 一种可能使解决方案清晰的方法是删除`countL' Leaf`案例，并尝试将其写入`countL`折叠。IE

```
countL'' = mytFold f a 
```

你在哪里决定什么`f`和`a`是（提示：你已经有`f == leafy == const (+)`）。考虑`mytFold leafy a Leaf`。

# matlab - 如何计算roc曲线？

> ID：12980259
> 
> 赞同：8
> 
> 时间：2012-10-19T18:26:28.440
> 
> 标签：matlab, classification, threshold, false-positive, roc

我编写了一个分类器（高斯混合模型）来对五种人类行为进行分类。对于每个观察，分类器计算属于一个集群的后验概率。

我想用一个阈值来评估我的系统的性能，阈值从 0 到 100。对于每个阈值，对于每个观察，如果属于某个集群的概率大于阈值，我接受分类器的结果否则我丢弃它。

对于每个阈值，我计算真阳性、真阴性、假阳性、假阴性的数量。

比我计算两个函数：敏感性和特异性为

```
sensitivity = TP/(TP+FN);

specificity=TN/(TN+FP); 
```

在matlab中：

```
plot(1-specificity,sensitivity); 
```

得到 ROC 曲线。但结果不是我所期望的。

这是改变一个动作的阈值的丢弃、错误、纠正、敏感性和特异性的函数图。

![这是改变阈值的丢弃、错误、纠正、灵敏度和特异性的函数图](../Images/a06bf4304cdb6a2991af3aeda73eea4c.png)

这是一个动作的ROC曲线图 ![这是ROC曲线图](../Images/2d0d7a06d0cd85a6f8f91b0b431b6411.png)

这是同一动作的 ROC 曲线的主干 ![在此处输入图像描述](../Images/725e1bc662ff0db5427fde342d7c6f90.png)

我错了，但我不知道在哪里。也许我在计算FP，FN，TP，TN时做错了，特别是当分类器的结果小于阈值时，所以我有一个丢弃。当有丢弃时我必须增加什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-27T17:20:06.077

**背景**

我正在回答这个问题，因为我需要研究内容，而这样的问题是一个很好的借口。谢谢你的好机会。

我使用来自内置 Fisher 鸢尾花数据的数据：http: [//archive.ics.uci.edu/ml/datasets/Iris](http://archive.ics.uci.edu/ml/datasets/Iris)

我还使用 Mathworks 分类教程中的代码片段，以及 plotroc

*   [http://www.mathworks.com/products/demos/statistics/classdemo.html](http://www.mathworks.com/products/demos/statistics/classdemo.html)
*   [http://www.mathworks.com/help/nnet/ref/plotroc.html?searchHighlight=plotroc](http://www.mathworks.com/help/nnet/ref/plotroc.html?searchHighlight=plotroc)

**问题描述**

域内有更清晰的边界来分类“setosa”，但“versicoloir”与“virginica”有重叠。这是一个二维图，并且已经丢弃了一些其他信息来生成它。在这种情况下，分类边界的模糊性是有用的。

```
%load data
load fisheriris

%show raw data
figure(1); clf
gscatter(meas(:,1), meas(:,2), species,'rgb','osd');
xlabel('Sepal length');
ylabel('Sepal width');
axis equal
axis tight
title('Raw Data') 
```

![数据的显示](../Images/3175ef976b320339151f924e18896fe8.png)

**分析**

假设我们想要确定定义“virginica”与“non-virginica”的线性分类器的界限。我们可以查看其他类的“self vs. not-self”，但它们会有自己的

所以现在我们做一些线性判别式并为它们绘制 ROC：

```
%load data
load fisheriris
load iris_dataset

irisInputs=meas(:,1:2)';
irisTargets=irisTargets(3,:);

ldaClass1 = classify(meas(:,1:2),meas(:,1:2),irisTargets,'linear')';
ldaClass2 = classify(meas(:,1:2),meas(:,1:2),irisTargets,'diaglinear')';
ldaClass3 = classify(meas(:,1:2),meas(:,1:2),irisTargets,'quadratic')';
ldaClass4 = classify(meas(:,1:2),meas(:,1:2),irisTargets,'diagquadratic')';
ldaClass5 = classify(meas(:,1:2),meas(:,1:2),irisTargets,'mahalanobis')';

myinput=repmat(irisTargets,5,1);
myoutput=[ldaClass1;ldaClass2;ldaClass3;ldaClass4;ldaClass5];
whos
plotroc(myinput,myoutput) 
```

结果如下所示，尽管它需要删除对角线的重复副本：

![在此处输入图像描述](../Images/0a42b79b1e93b3d95a85d33870548591.png)

您可以在代码中注意到我堆叠“myinput”和“myoutput”并将它们作为输入提供给“plotroc”函数。您应该将分类器的结果作为目标和实际值，并且可以获得类似的结果。这会将分类器的实际输出与目标值的理想输出进行比较。这些是 plotroc 的输入。

所以这会给你“内置的”ROC，这对快速工作很有用，但不会让你详细学习每一步。

此时您可以提出的问题包括：

*   哪个分类器最好？在这种情况下，我如何确定什么是最好的？
*   分类器的凸包是什么？是否存在比任何纯方法都提供更多信息的分类器组合？也许是装袋？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-19T18:46:29.303

您正在尝试根据分类器阈值参数绘制精度与召回率的曲线。准确率和召回率的定义是：

```
Precision = TP/(TP+FP)

Recall = TP/(TP+FN) 
```

您可以在以下网址查看这些参数的定义： [http ://en.wikipedia.org/wiki/Precision_and_recall](http://en.wikipedia.org/wiki/Precision_and_recall)

这里有一些曲线： [http ://www.cs.cornell.edu/courses/cs578/2003fa/performance_measures.pdf](http://www.cs.cornell.edu/courses/cs578/2003fa/performance_measures.pdf)

您是否将数据集划分为训练集、交叉验证集和测试集？（如果你不划分数据，你的precision-recall曲线看起来很奇怪是正常的）

编辑：我认为您的问题有两个可能的来源：

1.  当你为 5 个类训练一个分类器时，通常你必须训练 5 个不同的分类器。一个分类器用于（A 类 = 1 类，B 类 = 2、3、4 或 5 类），然后是（A 类 = 2 类，B 类 = 1、3、4 或 5 类）的第二个分类器，.. . 和第五个 A 级 = 5 级，B 级 = 1、2、3 或 4 级）。

正如您所说，要为“复合”分类器选择输出，您必须将新（测试）数据点通过五个分类器，然后选择概率最大的一个。

然后，您应该有 5 个阈值来定义我优先选择一个分类器而不是其他分类器的加权值。您应该检查 matlab 实现如何使用阈值，但它们的效果是您不会选择概率更大的类，而是选择加权概率更好的类。

2.  正如您所说，您可能没有计算好TP，TN，FP，FN。您的测试数据应该具有属于所有类的数据点。然后你有 testdata(i,:) 和 classtestdata(i) 是数据点 i 的特征向量和“ground truth”类。当你评估分类器时，你得到分类器输出（i）= 1 或 2 或 3 或 4 或 5。然后你应该计算“混淆矩阵”，这是当你有多个类时计算 TP、TN、FP、FN 的方法(> 2): [http://en.wikipedia.org/wiki/Confusion_matrix](http://en.wikipedia.org/wiki/Confusion_matrix) [http://www.mathworks.com/help/stats/confusionmat.html](http://www.mathworks.com/help/stats/confusionmat.html) (注意你是TP, TN, FP, FN之间的关系计算多类问题）

我认为您可以从混淆矩阵中获得每个子分类器的 TP、TN、FP、FN 数据（记住您正在计算 5 个单独的分类器，即使您没有意识到）。我不确定，但您可以为每个子分类器绘制精确召回曲线。

还要检查这些幻灯片：[http ://www.slideserve.com/MikeCarlo/multi-class-and-structured-classification](http://www.slideserve.com/MikeCarlo/multi-class-and-structured-classification)

我不知道 ROC 曲线是什么，我会检查它，因为机器学习对我来说是一个非常有趣的主题。

希望这可以帮助，

# php - 更改 Exec wget 的路径

> ID：12980263
> 
> 赞同：0
> 
> 时间：2012-10-19T18:27:03.643
> 
> 标签：php, exec, wget

```
$get = exec("wget $url > /dev/null 2>&1 &"); 
```

我使用上面的代码在后台执行特定的 url。但是所有转储 URL 都保存在我的根文件夹中。怎么改文件夹？或者，如果你给我代码来自动删除转储，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:57:53.787

`Hmmm noobs always get -1 :D lol – Sunita Shivnani 17 mins ago`因为您应该更频繁地使用查看文档

[WGET 文档](http://www.gnu.org/software/wget/manual/wget.html)

> '-P prefix'
> '--directory-prefix=prefix'<br />设置目录前缀为前缀。目录前缀是所有其他文件和子目录将保存到的目录，即检索树的顶部。默认值为“。” （当前目录）。

例子

```
$get = exec("wget -P /path/directory $url > /dev/null 2>&1 &"); 
```

# c - C 编程 Do while

> ID：12980265
> 
> 赞同：0
> 
> 时间：2012-10-19T18:27:10.540
> 
> 标签：c, function

我刚写了这个，我找不到问题。我使用代码块并编写此问题

```
error: expected 'while' before '{' token
=== Build finished: 1 errors, 1 warnings) 
```

但我不能在那里写，因为它不正确。有人能帮助我吗？对不起我的英语。

```
printf("Put numbers for some reason\n");

int cislo;
int s0,s1,s2,s3,s4,s5,s6,s7,s8,s9;

while(scanf("%d",&cislo)==1){
   if (cislo<0)
      printf ("Cislo %d, je zaporne, takove neberu", cislo);
}

s0=s1=s2=s3=s4=s5=s6=s7=s8=s9=0;

do (cislo/10);
    {
    switch (cislo%10);

    case 0; ++s0;  break;
    case 1; ++s1;  break;
    case 2; ++s2;  break;
    case 3; ++s3;  break;
    case 4; ++s4;  break;
    case 5; ++s5;  break;
    case 6; ++s6;  break;
    case 7; ++s7;  break;
    case 8; ++s8;  break;
    case 9; ++s9;  break;
    }

 while (cislo>0);

 printf("0  %d x \n 1  %d x \n 2  %d x \n 3  %d x \n 4  %d x \n 5  %d x \n 6  %d x \n 7  %d x \n 8  %d x \n 9  %d x \n",s0,s1,s2,s3,s4,s5,s6,s7,s8,s9);

 return 0;
} 
```

在决赛中，它必须打印如下内容：

```
100
Number: 100 include this numbers :
0 ...  2x
1 ...  1x
2 ...  0x
3 ...  0x
4 ...  0x
5 ...  0x
6 ...  0x
7 ...  0x
8 ...  0x
9 ...  0x 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:28:52.283

声明具有`do .. while`以下形式：

```
do statement while (expression) 
```

在您的示例中，您有两个语句：

```
(cislo/10); 
```

和另一个复合语句`{ ... }`。这没有任何意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:29:01.677

`do (cislo/10);`应该

```
do 
{ 
  /* your code */ 
} while (cislo/10); 
```

每个都`case X;`应该`case X:`。

正如 hexist 所指出的，一个开关是这样写的：

```
switch (condition) {
  case X:
    /*something*/
    break;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T18:33:58.977

```
do 
{
cislo /= 10;
switch (cislo%10);

case 0; ++s0;  break;
case 1; ++s1;  break;
case 2; ++s2;  break;
case 3; ++s3;  break;
case 4; ++s4;  break;
case 5; ++s5;  break;
case 6; ++s6;  break;
case 7; ++s7;  break;
case 8; ++s8;  break;
case 9; ++s9;  break;
} 
```

`while (cislo>0);`

试试这个？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T18:30:17.200

消除 ”;” 在 do() 之后。

```
do (cislo/10)
{
switch (cislo%10); 
```

# php - $_POST 带有 DOM 元素的虚线名称

> ID：12980271
> 
> 赞同：0
> 
> 时间：2012-10-19T18:27:35.260
> 
> 标签：php, forms

我有一个名称带有点（例如`name = "select.first"`）的 select 元素，但我无法使用`$_POST['select.first']`. 是因为点名吗？有没有办法在保留虚线名称的同时解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:30:18.160

从 HTML 规范

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

所以它在 HTML 中完全有效。PHP 将名称转换为[文档](http://www.php.net/manual/en/language.variables.external.php)中详述的`.`to 。`_`

> 变量名中的点和空格被转换为下划线。例如变成 $_REQUEST["a_b"]。

这是默认行为，我不确定是否有解决方法，除了在服务器和客户端上使用下划线或`.`在客户端和`_`服务器上使用。为了一致性起见，我会使用前者。

# regex - 如何设置匹配除空字符串和“输入代码”之外的所有内容的输入正则表达式模式

> ID：12980280
> 
> 赞同：0
> 
> 时间：2012-10-19T18:28:11.203
> 
> 标签：regex, html, validation, requiredfieldvalidator

我必须使用旧库来模拟 html5 占位符，而不是实际使用占位符属性。我们正在使用一个 js 库，它通过填充输入的值来模拟这一点，然后在用户单击输入时清除该值。例如，我们有一个临时值为“输入代码”的验证码。我们仍然希望对支持它的浏览器使用 HTML5 工具提示验证。因此，如果提交表单时未填写验证码，则工具提示应显示“请输入代码”。我在验证码文本输入字段上设置了“必需”属性，但是，这不起作用，因为 js 库设置了输入字段的值，使其不为空。无论如何，表格正在提交。

我想在验证码输入字段上指定一个模式，以便字符串“输入代码”无效，也不是空字符串。

我试过了：

```
 <input id="captcha" type="text" required="required" pattern="(?!Enter Code)"> 
```

但这似乎不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:36:43.657

使用正则表达式模式`^(?!Enter Code$).+`

```
<input id="captcha" type="text" required="required" pattern="^(?!Enter Code$).+"> 
```

# javascript - 为 .mp4 添加关闭脚本

> ID：12980281
> 
> 赞同：0
> 
> 时间：2012-10-19T18:28:18.353
> 
> 标签：javascript, html, css, jquery-mobile

请在完成返回**原始页面**后关闭**video.mp4**的脚本？

 **这是示例脚本：

```
 <li><a href="#"><a href="video/aps_production.mp4"><p>Sharing experience video</p></a></li> 
```

它适用于 CSS3、HTML5 和 JS。（jQuery1.8.2）。它适用于 iPhone。

网上搜了，没看到明显的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:32:24.467

看看[这个页面](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Introduction/Introduction.html)有一些信息。
您可以使用[video.js](http://videojs.com/docs/api/)让您的生活更轻松`ended`，您可以绑定一个事件。

遗憾的是，iOS[不](http://caniuse.com/#feat=fullscreen)支持全屏 API。

如果你真的想在`a`这里使用，你可以怎么做。

**html:**

```
<link href="http://vjs.zencdn.net/c/video-js.css" rel="stylesheet">
<script src="http://vjs.zencdn.net/c/video.js"></script>
<video id="video" style="display:none"></video> 
```

**Javascript：**

```
$("a[href$='.mp4']").click(function(ev){
  // use http://videojs.com/docs/api/ do get doc on how to use video.js

  var player = _v_("video");

  player.src($(this).attr('href'));
  player.requestFullScreen();
  $("#video").show();
  player.addEvent("ended", function(){
    // do what you want to do at the end of the video
    player..cancelFullScreen();
    $("#video").hide();
  });

  return false;
}) 
```

[属性选择器的文档](http://api.jquery.com/attribute-ends-with-selector/)

免责声明：我从未使用过 video.js，我希望它能在这种情况下工作，我只是选择了对你来说似乎是最好的工具。我给了你热链接，托管在 CDN 上，如果你正在做一个 PhoneGap 应用程序，用自托管版本替换它们。**

# .net - 将数据项添加到异常但不调用 throw ex

> ID：12980283
> 
> 赞同：3
> 
> 时间：2012-10-19T18:28:21.490
> 
> 标签：.net, vb.net, exception

我扩展了 NLog 以记录 Exception.Data 集合中的所有项目。因此，当我在我的数据访问代码中捕获 SqlException 时，我喜欢向 Exception.Data 字典中添加一些项目以提供更好的日志记录。我并不总是想从捕获中记录，而是让异常冒泡并在以后处理。所以我写了这样的东西：

```
Try
   ...
Catch exception As Exception
   exception.Data.Add("SP", StoreProcedureNameCost)
   exception.Data.Add("Connection", myConnection.ConnectionString)
   Throw
End Try 
```

呼叫只是`Throw`而不是`Throw exception`仍然有我添加的所有数据项吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:33:30.403

是的，它将保留对 Data 属性所做的更改。`throw`和之间的根本区别在于`throw ex`堆栈跟踪不会随着调用而改变，`throw`而它会随着`throw ex`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:33:10.337

我自己试了一下，效果和我希望的一样。只需调用 throw 就可以保留添加到异常中的新数据：

```
Try
   Try
      Throw New NotImplementedException("Hi")
   Catch ex As Exception
      ex.Data.Add("Here", "It is there")
      Throw
   End Try
Catch ex As Exception
   Dim msg As String = ex.Data("Here").ToString()
   Response.Write(msg)
End Try 
```

它起作用并吐出“它就在那里”。

# svn - 限制新开发人员对目录中少数文件的源代码访问 - SVN

> ID：12980286
> 
> 赞同：1
> 
> 时间：2012-10-19T18:28:40.500
> 
> 标签：svn, branch, collaboration, access-control

有一些新的顾问，他们将在软件的某些部分工作，这些部分对整个软件的功能并不重要。该软件不是以模块化方式组织的，所有这些包含非关键功能的源文件都没有隔离在一个目录中。

有没有办法让顾问无法分叉/分支项目，也只能处理文件（非关键功能文件）？

在这种情况下，版本控制软件是 SVN。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:51:59.483

如果您在 Windows 上使用 VisualSVN Server，您可以轻松地设置目录的访问权限（例如只读或无访问权限）。您不能在 SVN 中为每个文件设置任何内容（它旨在对目录进行操作）。其他 SVN 系统可以通过编辑 authz 文件并为每个要保护的目录编辑一个条目来执行相同的操作。

对单个文件设置访问控制将很快成为一场噩梦，因此将要保护的文件移动到几个目录中并对其进行控制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:00:25.233

您可以通过执行以下操作来做到这一点：

1.  将具有非关键功能的源文件移动到存储库中的另一个位置 - 我建议在与主干相同的文件夹级别。
2.  设置顾问对现有存储库的只读访问权限以及对步骤 1 中创建的新目录的读/写访问权限
3.  为您在步骤 1 中移动的文件添加 SVN:Externals。从 SVN 1.6 开始，您可以拥有[单独的文件外部](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-externals.html)

**确保您授予顾问对中继的只读访问权限和对新目录的读写访问权限**

第 3 步比较棘手，所以我将尝试进一步解释。假设您的原始存储库具有这样的文件结构

```
/trunk
  /lib 
    - Non Critical File 1.txt
    - Non Critical File 2.txt
    - Other files.h 
```

完成第 3 步后，您的存储库将如下所示：

```
/trunk 
  /lib
    - SVN: External to Non Critical File 1.txt 
    - SVN: External to Non Critical File 2.txt 
    - Other files.h
/NewDirectory
  - Non Critical File 1.txt
  - Non Critical File 2.txt 
```

对每个非关键文件执行此操作。

这将允许您的顾问仅查看现有存储库中的文件，但仅更新新创建的目录中的文件

要设置 SVN:Externals，请参阅[此堆栈溢出帖子](https://stackoverflow.com/questions/663155/how-to-get-started-with-svnexternals)

# asp.net - 当 UrlRewrite 处于活动状态时，无法访问 Asp.Net PageMethod

> ID：12980294
> 
> 赞同：1
> 
> 时间：2012-10-19T18:29:08.977
> 
> 标签：asp.net, url-rewriting, url-routing, pagemethods

我有一个应用程序，如果我不应用重写规则，它就像一个魅力。当我应用规则（即使它给出相同的地址）时，pagemethod 无法访问。我在 js 文件中调用 pagemethod。它的行为类似于刷新页面并且仅触发 page_load 事件。Page.IsPostback 总是返回 false。

顺便说一句，如果它是相关的，我正在使用母版页。

**Web 配置，urlrewrite 规则**

```
<rewriter>
<rewrite url="~/(.+).aspx" to="~/Forms/$1.aspx" />
</rewriter> 
```

**Http 模块**

```
 <httpModules>
  <add type="Intelligencia.UrlRewriter.RewriterHttpModule, Intelligencia.UrlRewriter" name="UrlRewriter" />
</httpModules> 
```

**试图到达pagemethods的js函数**

```
<script>
PageMethods.displayPages(a, CallSuccess, CallFailed);
</script> 
```

**页面方法**

```
 [System.Web.Services.WebMethod]
public static string displayPages(string a)
{
    response.write(a);
} 
```

这些是我尝试过但没有奏效的方法：

1- 添加 Pagemethods.set_path("/forms/Default.aspx"); 给 Js

2-向 web.config 添加了相同的规则，例如（即使不是那样工作）

```
<rewriter>
<rewrite url="~/Forms/(.+).aspx" to="~/Forms/$1.aspx" />
</rewriter> 
```

3-在母版页的Page_load下添加了代码

```
form1.Action = Context.Request.RawUrl; 
```

任何建议都会很棒。谢谢你的帮助。

# apache-flex - 使用 Ant 创建发布版本不输出所有文件？

> ID：12980296
> 
> 赞同：1
> 
> 时间：2012-10-19T18:29:12.720
> 
> 标签：apache-flex, ant, flex4

我正在尝试创建一个 Ant 任务来创建发布版本，但它只输出一个 SWF 文件，并且 SWF 文件的大小比正常文件小，并且它不会输出普通 Flash Builder 发布版本中的所有正常文件，例如历史文件夹、项目资产、SDK RSL 等。

```
<!-- Build and output the Avenue.swf--> 
<target name="compileFlex" depends="init,compileLib1,compileLib2">
    <mxmlc file="${APP_SRC}/app.mxml" output="output/app.swf">
        <load-config filename="${FLEX_HOME}/frameworks/flex-config.xml"/> 
        <source-path path-element="${FLEX_HOME}/frameworks"/> 
        <include-libraries file="${LIB1_SWC}" append="true"/>
        <include-libraries file="${LIB2_SWC}" append="true"/>
    </mxmlc> 
</target> 
```

它只创建一个 SWF，仅此而已。

这是输出的一部分：

```
[mxmlc] Required RSLs:
[mxmlc]     http://fpdownload.adobe.com/pub/swz/flex/4.5.1.21328/framework_4.5.1.21489.swz with 1 failover.
[mxmlc]     http://fpdownload.adobe.com/pub/swz/tlf/2.0.0.232/textLayout_2.0.0.232.swz with 1 failover.
[mxmlc]     http://fpdownload.adobe.com/pub/swz/flex/4.5.1.21328/spark_4.5.1.21489.swz with 1 failover.
[mxmlc]     http://fpdownload.adobe.com/pub/swz/flex/4.5.1.21328/sparkskins_4.5.1.21328.swz with 1 failover.
[mxmlc]     http://fpdownload.adobe.com/pub/swz/flex/4.5.1.21328/rpc_4.5.1.21328.swz with 1 failover.
[mxmlc]     http://fpdownload.adobe.com/pub/swz/flex/4.5.1.21328/mx_4.5.1.21489.swz with 1 failover.

[mxmlc] /Users/.../output/app.swf (698490 bytes) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-02T18:56:59.010

mxmlc 任务只编译弹性模块。您必须分别管理历史文件夹和项目资产。html-wrapper 任务可以帮助您完成任务，它从 html 模板生成 html 包装器。

# heroku - 如何用 Heroku Toolbelt 替换 Heroku gem？

> ID：12980298
> 
> 赞同：11
> 
> 时间：2012-10-19T18:29:17.560
> 
> 标签：heroku

我知道有与我密切相关的问题，但他们没有帮助我。

我正在学习整个 rails、gem、git、heroku 概念并且非常喜欢它。当我发出 heroku 命令行操作（Ubuntu linux）时，我收到了 gem 已被弃用的警告，我应该安装工具带。我运行了工具带的完整 wget 安装：

```
wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh 
```

但是现在当我使用 heroku 命令行时，我仍然收到不推荐使用的警告。我怀疑我必须摆脱 heroku gem，但我不知道该怎么做？我想确保正确执行此操作，以便以后不会通过捆绑程序再次加载。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T19:13:33.173

卸载命令将删除任何 gem。在这种情况下，您要使用以下内容：

```
gem uninstall heroku 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-08T07:26:36.197

我在让 Toolbelt 工作时遇到问题。我正在运行 OSX，因此我的解决方案可能不适用于您的 Ubuntu linux 设置。我仍然认为我可以分享以防万一。以下是我用来让它工作的步骤：

1.  通过运行删除 heroku gem `gem uninstall heroku`。它确实问我是否愿意`remove executables: heroku`。请务必选择是。

2.  转到 [https://toolbelt.heroku.com/][1] 并下载/安装 Toolbelt 应用程序。

3.  在 Toolbelt 页面上，它提到`/usr/local/heroku/bin`将添加到您的`PATH`. 我没有看到这个，也不确定是不是因为我运行的是 zsh 而不是 bash。我继续打开我的 .zshrc 文件并将其添加到我的`PATH`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-10T22:34:14.433

这对我有用：（当它询问您是否要删除可执行文件时，请务必选择是：heroku）

```
gem uninstall heroku --all 
```

来源（最后评论）：http: [//johntwang.com/blog/2011/09/13/remove-heroku-toolkit/](http://johntwang.com/blog/2011/09/13/remove-heroku-toolkit/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-21T08:06:08.773

您可能只需要重新启动您的外壳。

# html - 用 magento 中的 HTML5 iframe 模块替换显示图像（所有视图）

> ID：12980299
> 
> 赞同：1
> 
> 时间：2012-10-19T18:29:24.260
> 
> 标签：html, magento, iframe

我正在寻找用 HTML5 音乐播放器替换我产品的主要图像，任何人都可以就如何做到这一点提供任何指导吗？目标网站是[http://www.wemakedancemusic.com](http://www.wemakedancemusic.com)

嵌入播放器将是这样的：

```
<iframe width="100%" height="100%" scrolling="no" frameborder="no" src="http://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F63224064&amp;auto_play=false&amp;show_artwork=true&amp;color=ad0606"></iframe> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T20:07:19.680

主图像模板的路径是

```
 /app/design/frontend/base/default/template/catalog/product/view/media.phtml 
```

然后将其复制到本地主题模板文件夹并根据需要使用上述播放器代码进行更新。

（假设您所有的产品页面都将播放相同的曲目）

# python - Python 中的 Hangman - 辅音猜测编码

> ID：12980304
> 
> 赞同：1
> 
> 时间：2012-10-19T18:29:44.503
> 
> 标签：python

**问题**

```
guess_letter:
(str, str) -> str 
```

第一个参数是未猜到的辅音，第二个参数是难度级别。返回辅音以​​供计算机播放器接下来猜测。如果 level 为 EASY，则随机选择要猜测的辅音。如果 level 是 HARD，则猜测 PRIORITY_CONSONANTS 中第一个辅音出现在第一个参数中的辅音。

```
PRIORITY_CONSONANTS = 'tnrslhdcmpfgybwvkqxjz'
EASY = 'E'
HARD = 'H' 
```

总的来说，这个项目将创建一个功能性的刽子手游戏，这是我必须自己编写代码的一个组件。

我不知道如何写这个我做了一个我想解决的小结构。但老实说，我不明白该写什么。

我希望当难度级别很难选择出现在参数未猜测辅音中的优先辅音中的第一个辅音时，我希望任何随机辅音出现

```
guess_letters(unguessed_consonants, difficulty_level):
if difficulty_level == EASY:
if difficulty_level ==HARD: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:38:52.953

```
import random

EASY = 'E'
HARD = 'H'
PRIORITY_CONSONANTS = 'tnrslhdcmpfgybwvkqxjz'
EASY_CONSONANTS = '' # what should be here?

def guess_letters(unguessed_consonants, difficulty_level):
    if difficulty_level == EASY:
        search_set = EASY_CONSONANTS
    elif difficulty_level == HARD:
        search_set = PRIORITY_CONSONANTS

    for con in unguessed_consonants:
        if con in search_set:
             return con 
```

回应 Nadia 的评论：

> kk 效果更好，除非我硬输入 'zk' 它会给我 z 而不是 kk 在 PRIORITY_CONSONANTS 中的 z 之前出现，所以输出应该是 k

在这种情况下，应该首先迭代 search_set：

```
 for con in search_set:
        if con in unguessed_consonants:
             return con 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:57:25.493

我不会在这里给你答案。但是您可以使用 str.index 实现“硬”模式

```
>>> 'abcd'.index('b')
1 
```

查看[文档](http://docs.python.org/library/string.html#string.index)以获取更多文档

# xaml - 主项目之外的 MergedDictionaries

> ID：12980317
> 
> 赞同：3
> 
> 时间：2012-10-19T18:30:20.703
> 
> 标签：xaml, windows-runtime, winrt-xaml

我有 2 个项目的解决方案。第一个是主要应用程序，第二个是其中的控件。在 Generic.xaml 中，在 Silverlight 项目中，可以这样做

```
<ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="/MyLibNamespace;component/Themes/SomeFolder/MyControl.xaml" />
</ResourceDictionary.MergedDictionaries> 
```

这似乎不适用于 Windows 应用商店应用程序类库。ReSharper 希望文件路径为“/Themes/SomeFolder/MyControl.xaml”，但我仍然收到 XamlParseException：无法分配给属性“Windows.UI.Xaml.ResourceDictionary.Source”。[行：7 位置：36]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T21:59:40.347

WinRT 中没有“其他类/程序集中的 Xaml 文件”之类的东西。换句话说：“EmbeddedResource”或“Resource”根本不存在于 WinRT 组件中（是的，这很痛苦）。这也是将 \Themes\Generic.xaml 复制到输出目录的原因）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:55:12.743

[在 msdn 上](http://social.msdn.microsoft.com/Forums/en-GB/winappswithcsharp/thread/bcb480d1-cb7c-4d36-ba92-9c513d95e51a)查看答案

如果您有一个名为“CustomControl”的 dll 和一个名为“Styles.xaml”的 ResourceDictionary，则 App.xaml 应包含

```
 <ResourceDictionary>
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="ms-appx:///CustomControls/Styles.xaml"/>
    </ResourceDictionary.MergedDictionaries>
</ResourceDictionary> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T22:02:07.173

如果`ResourceDictionary` **Source**设置为 XAML（即`UserControl`. 但是，如果引用的 XAML 文件是专用的，则使用**ms-appx:///**`ResourceDictionary`方案访问内部样式没有问题，遵循**ms-appx:///PROJECT_NAME/PATH_TO_XAML.xaml**模式。

 ****如果是这样的话，是否有可能`ResourceDictionary`将其与 分开`UserControl`？****

# windows - 使用 _RTL_USER_PROCESS_PARAMETERS

> ID：12980325
> 
> 赞同：2
> 
> 时间：2012-10-19T18:30:45.497
> 
> 标签：windows, assembly, process, command-line-arguments, windows-process

我正在与 PEB 合作。我设法进入_RTL_USER_PROCESS_PARAMETERS。我的目标-> 仅通过使用二进制文件（.exe 文件）来了解 argc 和 argv 的内存地址。（如果可能的话，它们的值）

我设法通过在 ac 程序中嵌入 asm 来进入它

```
mov eax:fs[0x30]
mov [PEBaddress] , eax

mov ebx, [eax+0x10]
mov [ProcessParameters] , ebx 
```

我通过研究 Windows 调试器下的二进制文件得到了偏移量 0x30 和 0x10

现在在 Processparameters 地址的 0x40 偏移处是字符串命令行，我相信它是一个缓冲区，我进一步相信它保存了 argc 和 argv 的值。

问题：我想读取该缓冲区，并获取 argc 和 argv 的地址值（传递给进程的命令行参数）任何人都可以通过向我提供读取缓冲区的代码（因为它是 Unicode 字符串）和获取所需的地址。

还有其他方法可以完成这项工作吗？（您也可以建议我，不要让我选择在 main 中打印 argc 和 argv 的地址）我想要静态答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:43:37.687

Windows 不会通过`argc`并`argv`进入程序。它以字符串的形式传递完整的文字命令行。如果所讨论的程序甚至是 C 程序，则此解析由嵌入在该程序中的 C 运行时库完成。

# jquery - 执行函数时使用 Apache Cordova 振动 (jQuery Mobile)

> ID：12980326
> 
> 赞同：2
> 
> 时间：2012-10-19T18:30:57.047
> 
> 标签：jquery, api, chat, cordova, vibration

我写了一个简单的聊天室。代码如下。当用户收到消息时，我想使用 apache cordova 使设备振动。我怎样才能实现这个？

[http://pastie.org/5085307](http://pastie.org/5085307)

代码在那个链接。我已经包含了振动代码和聊天室代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:05:57.080

您可能希望在应用程序的第 83 行调用 navigator.notification.vibrate(2000)。您还需要在头中包含cordova 的脚本标签，否则它将不起作用。无需将 navigator.notification.vibrate(2000) 包装在 onDeviceReady 内部的振动函数中。

# xml - 我将什么放入 XML 以从数组中读取？

> ID：12980327
> 
> 赞同：0
> 
> 时间：2012-10-19T18:30:58.323
> 
> 标签：xml, arrays, groovy, soapui

我正在使用soapUI，并且有130 个我想从中选择的ID，并让测试从数组中随机选择一个。

我有一个看起来像这样的 GroovyScript：

```
IDNumbers = [1,2,3,etc.]
rand = new Random();
randomIds = IDNumbers[(rand.nextInt(130))]; 
```

在我的 XML 中，我有以下内容：

```
<FacilityID>${#RandomIDs(This is the test case Groovy Script)#randomIds}</FacilityID> 
```

我什至在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T01:46:02.940

你听起来太接近了。您的 XML 格式不正确。我会像这样构建 groovy 脚本（但我认为你的脚本会按原样工作）：

```
def IDNumbers = [1,2,3]
rand = new Random();
randomIds = IDNumbers[(rand.nextInt(3))];
return randomIds 
```

现在右键单击您的请求，选择获取数据 > RandomIDs > 脚本结果，您应该准备好了。应该是 ${RandomIDs#result}。确保您的 groovy 脚本首先运行。如果您打算在跨测试的许多地方使用它，您应该将它添加为[属性](http://www.soapui.org/Functional-Testing/working-with-properties.html)。

为了好玩，您还可以使用 shuffle

```
def list = [1,2,3,4,5,6,7,8,9,10]
Collections.shuffle(list)

return list[0] 
```

# java - 开发 javaagents 时如何运行测试？

> ID：12980328
> 
> 赞同：8
> 
> 时间：2012-10-19T18:30:59.437
> 
> 标签：java, junit, intellij-idea, jvm, profiling

我正在尝试摆弄[Foursquare 的 HeapAudit](https://github.com/foursquare/heapaudit)，并尝试使用 IntelliJ IDEA 进行设置。使用 pom.xml 中的依赖项，我设法让它构建得很好。

但是，当我实际尝试运行 JUnit 测试时，基本上它们都失败了。我猜这是因为使用 HeapAudit 需要 JVM 以它作为启动`-javaagent`，根据 github：

```
$ java -javaagent:heapaudit.jar MyTest 
```

如果我把这条线放进去，并且引用了`heapaudit.jar`我之前下载/构建的，大概测试会通过。但是，在我看来，如果我更改源代码，我将需要重新打包这个愚蠢的 .jar 文件以查看它是否有效。

有没有什么方法可以在`-javaagent`每个测试周期都通过 compile -> package-into-jar 来运行测试？也许让 IntelliJ在运行测试之前附加新编译的`.class`文件？`-javaagent`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-05-08T02:39:37.513

## 1）有一个罐子只有一个`META-INF/MANIFEST.MF`

清单必须正确配置`Premain-Class`和其他属性。jar 不需要任何其他文件。将此罐与`-javaagent`. 只要代理类在类路径中，代理就会正常启动。

使用`maven-surefire-plugin`with时可能会失败，`forkMode=never`因为默认情况下应用程序类加载到子 ClassLoader 中。

适用于 Eclipse 和 Intellij。

如果这样做，请仔细检查清单语法（曾经我花了很长时间才发现包名是错误的）。

## 2) 使用[ea-agent-loader](https://github.com/electronicarts/ea-agent-loader)

它将允许您在运行时加载代理（任何代理）（它使用`VM.attach()`）。但是，`VM.attach()`有时会中断调试并且断点可能无法触发。

与 forkMode=never 中的万无一失也会有同样的问题

## 3）在运行时加载代理。

编写代码以[在运行时加载代理](https://stackoverflow.com/questions/4817670/how-can-i-add-a-javaagent-to-a-jvm-without-stopping-the-jvm)。并从你的调用它`@BeforeClass`你仍然需要一个 jar（如果你愿意，你可以在运行时生成它）。

只需要调用它（仅一次）：

```
AgentLoader.loadAgentClass(YourAgentClass.class.getName()); 
```

# testing - 发布 apk 后如何测试应用内购买

> ID：12980329
> 
> 赞同：1
> 
> 时间：2012-10-19T18:31:01.097
> 
> 标签：testing, in-app-purchase, apk, publish

所以我们已经发布了我们的第一个应用程序 v1.0，我们正在为 v1.1 做准备。为此，我需要针对此测试购买，但上传新的（测试）apk 会产生 2 个问题：1\. 如果激活了新的 apk v1.1 来测试它，它将踩踏旧版本的 apk 2.新的 (测试）apk 需要激活才能针对它测试购买

目前，我们创建了另一个名为“Test App”的应用程序，我们将在其中上传我们的 QA 测试版本以测试应用内购买。

测试更新等的最佳实践是什么？

# ruby - 范围和它所涵盖的奥秘超出了我的范围

> ID：12980330
> 
> 赞同：4
> 
> 时间：2012-10-19T18:31:05.763
> 
> 标签：ruby, range

我试图了解如何`range.cover?`工作和遵循似乎令人困惑 -

1.  `("as".."at").cover?("ass") # true`和`("as".."at").cover?("ate") # false`

    这个孤立的例子并不令人困惑，因为它似乎是`ass`在.`at``ate`

2.  `("1".."z").cover?(":") # true`

    这个事实似乎是基于 ASCII 值而不是字典样式，因为在字典中我希望所有特殊字符都在偶数之前，而混乱从这里开始。如果我认为是真的，那么如何`cover?`决定采用哪种比较方法，即使用 ASCII 值或基于字典的方法。

3.  以及范围如何与数组一起使用。例如 -

    `([1]..[10]).cover?([9,11,335]) # true`

    这个例子我预计是错误的。但从表面上看，在处理数组时，边界值和`cover?`' 参数都被转换为字符串，并且简单的字典样式比较会产生 true。这是正确的解释吗？

4.  可以处理什么样的物体`Range`？我知道它可以`numbers`（除了复杂的），handle `strings`，能够神秘地使用，`arrays`而`boolean, nil and hash`其他值会导致它提高`ArgumentError: bad value for range`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:52:29.757

# 为什么会`([1]..[10]).cover?([9,11,335])`返回`true`

让我们[看一下源码](https://github.com/ruby/ruby/blob/a251302038d8b4c98d220c4f9843786fb9d8dd10/range.c#L904)。在 Ruby 1.9.3 中，我们可以看到以下定义。

```
static VALUE
range_cover(VALUE range, VALUE val)
{
  VALUE beg, end;

  beg = RANGE_BEG(range);
  end = RANGE_END(range);
  if (r_le(beg, val)) {
    if (EXCL(range)) {
      if (r_lt(val, end))
        return Qtrue;
    }
    else {
      if (r_le(val, end))
        return Qtrue;
    }
  }
  return Qfalse;
} 
```

如果范围的开头不小于或等于给定值，则`cover?`返回`false`。这里*小于或等于是*根据函数确定的，该[`r_lt`](https://github.com/ruby/ruby/blob/a251302038d8b4c98d220c4f9843786fb9d8dd10/range.c#L147)函数使用`<=>`运算符进行比较。让我们看看它在数组的情况下如何表现

```
[1] <=> [9,11,335] # => -1 
```

所以显然`[1]`确实小于`[9,11,335]`。于是我们进入了第一个身体`if`。在内部，我们检查范围是否不包括其结尾并再次使用`<=>`运算符进行第二次比较。

```
[10] <=> [9,11,335] # => 1 
```

因此`[10]`大于`[9,11,335]`。该方法返回`true`。

# 为什么你看到`ArgumentError: bad value for range`

负责引发此错误的函数是[`range_failed`](https://github.com/ruby/ruby/blob/a251302038d8b4c98d220c4f9843786fb9d8dd10/range.c#L26). `range_check`它仅在返回 a时调用`nil`。什么时候发生？当范围的开始和结束无法比较时（是的，再次就我们亲爱的朋友，`<=>`运营商而言）。

```
true <=> false # => nil 
```

`true`并且`false`是无法比拟的。范围不能被创建并且`ArgumentError`被提升。

最后，`Range.cover?`对 的依赖`<=>`实际上是一种预期和记录在案的行为。请参阅[RubySpec](http://rubyspec.org/)的[.`cover?`](https://github.com/rubyspec/rubyspec/blob/356fa4fb3e40/core/range/cover_spec.rb#L42)

# java - Glassfish / PostgreSQL 表与复合（两部分）主键生成 com.sun.jersey.spi.inject.Errors

> ID：12980332
> 
> 赞同：3
> 
> 时间：2012-10-19T18:31:11.647
> 
> 标签：java, postgresql, jpa, netbeans, glassfish

我有一个 PostgreSQL 表`testtable`，它有一个两部分的主键（`ID1`类型为 bigint，`ID2`类型为 bigint）和一个带有时间戳的非键字段。我正在尝试使用“从数据库中新建 RESTful Web 服务”向导生成 RESTful Web 服务，并且包名称（服务）除外，为所有值选择默认值。该向导生成四个文件：

*   AbstractFacade.java
*   测试表.java
*   测试表REST.java
*   测试表PK.java

部署到服务器并选择“Test RESTful Web Services”，测试页面无法加载：

```
例外
javax.servlet.ServletException: PWC1391: Servlet org.netbeans.rest.application.config.ApplicationConfig 的 Servlet.init() 抛出异常

根本原因
com.sun.jersey.spi.inject.Errors$ErrorMessagesException
```

查看 glassfish 事件日志，有两个严重错误：

```
使用资源和/或提供程序类检测到以下错误和警告：
严重：在索引 0 的参数处缺少方法 public void service.TesttableFacadeREST.remove(service.TesttablePK) 的依赖项
严重：方法 public void service.TesttableFacadeREST.remove(service.TesttablePK)，用 DELETE 的资源类 service.TesttableFacadeREST 进行注释，不被识别为有效的资源方法。
严重：在索引 0 的参数处缺少方法 public service.Testtable service.TesttableFacadeREST.find(service.TesttablePK) 的依赖项
严重：方法，公共 service.Testtable service.TesttableFacadeREST.find(service.TesttablePK)，使用资源类 service.TesttableFacadeREST 的 GET 进行注释，未被识别为有效的资源方法。
```

和

```
WebModule[/tabletest]StandardWrapper.Throwable com.sun.jersey.spi.inject.Errors$ErrorMessagesException
    在 com.sun.jersey.spi.inject.Errors.processErrorMessages(Errors.java:170)
    在 com.sun.jersey.spi.inject.Errors.postProcess(Errors.java:136)
    在 com.sun.jersey.spi.inject.Errors.processWithErrors(Errors.java:199)
    在 com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:771)
    在 com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:766)
    在 com.sun.jersey.spi.container.servlet.ServletContainer.initiate(ServletContainer.java:488)
    在 com.sun.jersey.spi.container.servlet.ServletContainer$InternalWebComponent.initiate(ServletContainer.java:318)
    在 com.sun.jersey.spi.container.servlet.WebComponent.load(WebComponent.java:609)
    在 com.sun.jersey.spi.container.servlet.WebComponent.init(WebComponent.java:210)
    在 com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:373)
    在 com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:556)
    在 javax.servlet.GenericServlet.init(GenericServlet.java:244)
    在 org.apache.catalina.core.StandardWrapper.initServlet（StandardWrapper.java:1453）
    在 org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:1093)
    在 org.apache.catalina.core.StandardWrapperValve.invoke（StandardWrapperValve.java:189）
    在 org.apache.catalina.core.StandardContextValve.invoke（StandardContextValve.java:175）
    在 org.apache.catalina.core.StandardPipeline.doInvoke（StandardPipeline.java:655）
    在 org.apache.catalina.core.StandardPipeline.invoke（StandardPipeline.java:595）
    在 org.apache.catalina.core.StandardHostValve.invoke（StandardHostValve.java:161）
    在 org.apache.catalina.connector.CoyoteAdapter.doService（CoyoteAdapter.java:331）
    在 org.apache.catalina.connector.CoyoteAdapter.service（CoyoteAdapter.java:231）
    在 com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    在 com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    在 com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    在 com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    在 com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    在 com.sun.grizzly.http.DefaultProtocolFilter.execute（DefaultProtocolFilter.java:229）
    在 com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    在 com.sun.grizzly.DefaultProtocolChain.execute（DefaultProtocolChain.java:104）
    在 com.sun.grizzly.DefaultProtocolChain.execute（DefaultProtocolChain.java:90）
    在 com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    在 com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    在 com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    在 com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    在 com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    在 com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    在 java.lang.Thread.run(Thread.java:722)
```

在我开始使用 NetBeans 提交错误报告之前，我只是想看看这是否更可能是开发人员错误而不是开发人员工具集的错误。想法？

*   数据库：PostgreSQL 8.4
*   应用服务器：Glassfish 3.1.2.2
*   IDE：NetBeans 7.2
*   JDK：7 更新 7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T14:16:30.073

出现问题是因为 remove 和 find 方法都将 TesttablePK 类型与 @PathParam 结合使用，但 Jersey 找不到将字符串从 url 转换为此类对象的方法。这可以通过修改 TesttablePK 类型来解决。你有两个选择：

*   添加一个接受单个 String 参数的构造函数。
*   或添加一个名为 valueOf 或 fromString 的静态方法，它接受单个 String 参数

因此，您需要决定如何将复合键表示为字符串并将这样的字符串转换为 TesttablePK 类型。

# android - Android - 活动未达到 onSaveInstanceState

> ID：12980338
> 
> 赞同：0
> 
> 时间：2012-10-19T18:31:27.850
> 
> 标签：android, android-activity

我有一个 Android 应用程序，它简单地保存数据并将它们显示在列表视图中，与记事本教程非常相似。不幸的是，我的 Add 活动似乎已经停止工作。当我尝试添加数据并按确认时，它会重新加载活动（屏幕轻微闪烁），并且我输入到字段中的所有数据都会被清除。我已经确认它没有达到 onSaveInstanceState()。我的印象是这个方法是在完成（）时自动调用的，就像我提到的那样，它一次可以工作。也许有人可以发现我在代码中引入了错误的地方？我将粘贴我认为是相关部分的内容：

```
 confirmButton.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {

            //Verify that fields are filled out
            String description = mDescriptionText.getText().toString();
            String amount = mAmountText.getText().toString();
            if(description.length() == 0 || amount.length() == 0) {
                if(description.length() == 0) {
                    Context context = getApplicationContext();
                    CharSequence text = "A description is required";
                    int duration = Toast.LENGTH_SHORT;
                    Toast toast = Toast.makeText(context, text, duration);
                    toast.show();
                }
                else {
                    Context context = getApplicationContext();
                    CharSequence text = "An amount is required";
                    int duration = Toast.LENGTH_SHORT;
                    Toast toast = Toast.makeText(context, text, duration);
                    toast.show();
                }

            }
            else {
                /* Call this to set the result that your activity will return to its caller */
                setResult(RESULT_OK);
                /* Call this when your activity is done and should be closed. The ActivityResult is propagated back to 
                whoever launched you via onActivityResult() */ 

                finish();
            }
        }

    @Override
protected void onSaveInstanceState(Bundle outState) {
    Log.i("expEdit","onSaveInstance State Reached");
    super.onSaveInstanceState(outState);
    saveState();
    outState.putSerializable(EZBudgetDbAdapter.KEY_ROWID, mRowId);
}

 private void saveState() {
    Log.i("expEdit","saveState Reached");
    String description = mDescriptionText.getText().toString();
    String amount = mAmountText.getText().toString();
    Double dAmount = 0.0;
    if(amount != "") {
        dAmount = Double.valueOf(amount).doubleValue();
    }

    if (mRowId == null) {
        long id = mExpDbHelper.createExpenditure(description, dAmount);
        if (id > 0) {
            mRowId = id;
        }

        if (mSaveDesc.isChecked()) {
            // Save the description to the CommonDesc table
            mCommDbHelper = new CommonDescDbAdapter(this);
            mCommDbHelper.open();
            mCommDbHelper.createCommonDesc(description);

        }

    } else {

        mExpDbHelper.updateExpenditure(mRowId, description, dAmount);

        if (mSaveDesc.isChecked()) {
            // Save the description to the CommonDesc table
            mCommDbHelper = new CommonDescDbAdapter(this);
            mCommDbHelper.open();
            mCommDbHelper.createCommonDesc(description);

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:48:28.400

在finish() 之后不调用onSaveInstanceState()。请参阅以下[onSaveInstanceState](http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29)

而且您的代码不干净。永远不要白白复制代码。你应该使用

```
 Context context = getApplicationContext();
    CharSequence text;
    int duration = Toast.LENGTH_SHORT;

    if(description.length() == 0) {                    
        text = "A description is required";                 
    } else {                    
        text = "An amount is required";                    
    }
    Toast toast = Toast.makeText(context, text, duration);
    toast.show(); 
```

# javascript - 使用击键 vanilla javascript 动态移动 div

> ID：12980341
> 
> 赞同：0
> 
> 时间：2012-10-19T18:31:52.473
> 
> 标签：javascript, 2d-games

我正在浏览器中构建一个简单的 Pirates 克隆，并使用没有库的常规 javascript 来尝试学习基础知识。我正在尝试在游戏板的绝对定位 div 内移动一个相对定位的 div，即我的游戏精灵。我有所有代码到实际移动 div 的地步，我只是找不到更改 div 相对位置的命令。

这是我所拥有的：

```
function move(e){
    var x=e.keyCode;
    var keychar=String.fromCharCode(x);
    if (x === "a") {
       // What goes here?
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:33:45.350

您应该能够通过修改`el.style.left`和`el.style.top`where`el`是对您定位的引用来移动它`DIV`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:33:57.143

更改（增加或减少）`divElement.style.left`像素值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T18:35:38.167

首先，你的内部 div 应该有`position: absolute`，而不是`relative`. 外面的也可以有。然后只需设置`style.top`和`style.left`每次击键：

```
function move(e){
    var x=e.keyCode;
    var keychar=String.fromCharCode(x).toLowerCase();
    var div = document.getElementById('mydiv');
    if (x === "a") {
        var currentLeft = parseInt(div.style.left, 10);
        // to move left:
        div.style.left = (currentLeft-5) + 'px';
    }
}; 
```

这应该可行，但是您的精灵可能不会像您期望的那样顺利移动。在这种情况下，您可能需要一个动画循环和一个按键缓冲区。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T18:34:45.827

你可以改变`style.left`和`style.top`

```
var d = document.getElementById("idselector");
d.style.left = "30px";
d.style.top = "40px"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T18:37:13.850

```
var div = document.getElementById("divId");

if(x == "a"){        
    div.position.left = (parseInt(div.style.left) - 10) + "px";
}
else if(x == "d"){
    div.position.left = (parseInt(div.style.left) + 10) + "px";
}

// similar code for other keys with div.style.top 
```

# ios - iOS - 为圆圈设置虚线

> ID：12980349
> 
> 赞同：7
> 
> 时间：2012-10-19T18:32:30.177
> 
> 标签：ios, line

```
CAShapeLayer *circle = [CAShapeLayer layer];

circle.path = [UIBezierPath bezierPathWithRoundedRect:CGRectMake(0, 0, 2.0*radius, 2.0*radius) cornerRadius:radius].CGPath;

// Configure the apperence of the circle
circle.fillColor = [UIColor clearColor].CGColor;
circle.strokeColor = [UIColor whiteColor].CGColor;
circle.lineWidth = 1;      
// Add to parent layer
[[background layer] addSublayer:circle]; 
```

我画了一个圆圈并将其添加为子图层。我不明白的是如何使圆线虚线？我在上面添加了我的圈子代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-19T18:41:23.927

您需要[`lineDashPattern`设置](http://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CAShapeLayer_class/Reference/Reference.html#//apple_ref/doc/uid/TP40008314-CH1-SW10). `circle`例如：

```
circle.lineDashPattern = @[@2, @3]; 
```

# sql-server - 从批处理文件执行存储过程

> ID：12980353
> 
> 赞同：16
> 
> 时间：2012-10-19T18:32:45.013
> 
> 标签：sql-server, stored-procedures, batch-file

您将如何从批处理文件中执行 SQL Server 中的存储过程（使用 Windows 身份验证）？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-19T18:37:00.130

如果您使用的是 Sql Server 2005+，则可以使用[sqlcmd](http://msdn.microsoft.com/en-us/library/ms180944.aspx)实用程序。

例子：

sqlcmd -Q "exec storedProcName" -S YourServer -d YourDatabase -o C:\yourOutput.txt

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-19T18:38:11.900

对于 SQL Server 2005 及更高版本，您可以使用 sqlcmd.exe。有关如何使用它的更多信息：

[http://msdn.microsoft.com/en-us/library/ms170572.aspx](http://msdn.microsoft.com/en-us/library/ms170572.aspx)

[http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=109770](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=109770)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-19T18:39:53.443

您可以使用`sqlcmd.exe` 参见：[MSDN 用法](http://msdn.microsoft.com/en-us/library/ms162773.aspx)

# c++ - 使用引用成员初始化结构的不同方法

> ID：12980357
> 
> 赞同：3
> 
> 时间：2012-10-19T18:33:17.713
> 
> 标签：c++, struct, instantiation

假设我们有这两个结构：

```
struct simple_struct
{
    unsigned int n1;
    unsigned int n2;
};

struct ref_struct
{
    struct simple_struct& st1;
    unsigned int n2;
}; 
```

在 C++中实例化**ref_struct**有多少种方法？（没有为此结构实现构造函数）

我试图实例化 ref_struct 因为我认为了解不同的方法很有趣......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:35:21.750

~~没有任何。（AFAIK，我可能错了）~~

你可以这样做

```
ref_struct x = {{1,1},1}; 
```

如果成员是`const`，即

```
struct ref_struct
{
    const simple_struct& st1;
    unsigned int n2;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:51:58.160

您可以使用预先存在的 simple_struct 实例来初始化 ref_struct 而无需构造函数。

```
simple_struct simple = {1,2};
ref_struct ref = {simple, 3}; 
```

# sql - 在 HAVING 子句 SQL Server 2008 中使用聚合从语句中删除

> ID：12980363
> 
> 赞同：1
> 
> 时间：2012-10-19T18:33:42.093
> 
> 标签：sql, sql-server, sql-delete

我有一个如下所示的表![在此处输入图像描述](../Images/f5eaeb7f6cd9dfcd1c3ce7d1ab337e84.png)

应该是唯一标识符的地方，drg，不是，所以我开始接受修复它的个人挑战。我可以通过多种方式轻松做到这一点，但我正在尝试以不同的方式做一些事情来学习一些新技术。需要从表中删除的是任何 drg**不**唯一且 eff_date **小于 ** max eff_date 的行。

为了找到我需要的东西，我使用了

```
select d1.drg, MAX(d1.eff_date) as maxEffDate,d2.drgdesc
    from drgtable d1
    inner join drgtable d2 on d1.drg=d2.drg 
    group by d1.drg,d2.drgdesc
    having MAX(d1.eff_date) = MAX(d2.eff_date) 
```

我不想将其选择到新表中并删除旧表，而是希望在删除语句中执行此操作。

我对下面看起来很奇怪的查询的处理过程是从我使用的上述查询中找到不在表中的行并删除它们。我接近了，但被卡住了。另外，如果有更简单的方法可以做到这一点，请告诉我。谢谢

-- 这样做的目的是找到 d3 中不在 d4 中的行并删除它们。没那么远

```
delete from 
drgtable
where 
(
select * from drgtable as d3
left join 
(
select d1.drg, MAX(d1.eff_date) as maxEffDate,d2.drgdesc
    from drgtable d1
    inner join drgtable d2 on d1.drg=d2.drg 
    group by d1.drg,d2.drgdesc
    having MAX(d1.eff_date) = MAX(d2.eff_date)

) d4 on d4.drg =d3.drg and d4.maxEffDate = d3.eff_date and d3.drgdesc = d4.drgdesc
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:52:08.727

这应该有效：

```
;WITH cte As
(
    SELECT  *,
            MAX(eff_date) OVER(partition by drg) as MaxEffDate
    FROM    drgtable
)
DELETE 
FROM    cte
WHERE   eff_date <> MaxEffDate 
```

此外，还有很多新技巧供您学习。:-)

（注意：这假设您使用的是 SQL Server 2005 或更高版本）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T18:43:49.787

如果我理解你的正确，你需要这样的东西吗？

```
delete drgtable 
from drgtable as d1
where exists
    (
        select t.*
        from drgtable as t where t.drg = d1.drg and t.eff_date > d1.eff_date
    ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T18:49:31.673

你能试试：

```
delete from  drgtable 
where  DRG+MaxEffDate
not in
(Select drg+maxEffDate as Combo
FROM
  (select d1.drg, 
    MAX(d1.eff_date) as maxEffDate,
    d2.drgdesc     
    from drgtable d1     
    inner join drgtable d2 
    on d1.drg=d2.drg      
    group by d1.drg,d2.drgdesc     
    having MAX(d1.eff_date) = MAX(d2.eff_date) ) as RecordsToKeep
)
-- assuming there are no nulls in the data 
```

? 我意识到这可能有点骇人听闻，并且可能有更多雄辩的解决方案，但这应该可行。

# gwt - gwt 服务器包中的类在被服务类调用时抛出 ClasNotFound 异常

> ID：12980365
> 
> 赞同：0
> 
> 时间：2012-10-19T18:33:47.077
> 
> 标签：gwt, smartgwt

在对我的服务类 ChartService 进行 RPC 调用期间，当创建 CustomChartData 类的对象时，我收到了 ClassNotFoundException。CustomChartData 位于同一项目中名为“server.chart”的包中。ChartService 当然是在项目的“服务器”包中。

我尝试将 CustomChartDataClass 移动到“服务器”包，但这没有用。我一直在寻找类似的问题，但我发现的唯一问题与罐子不在正确的位置有关。

我正在使用 GWT 2.4、Java 1.6 和 Eclipse Juno。

有没有人遇到过这样的事情？有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T19:29:42.997

你在客户端使用 CustomChartData 吗？如果是这样，请尝试将类放在包 shared.chart 中

# php - 如何在将登录另一个站点的站点中创建链接？

> ID：12980366
> 
> 赞同：0
> 
> 时间：2012-10-19T18:33:48.303
> 
> 标签：php, javascript, html, post, request

有一个简单的站点，我们称之为[http://foo.com/ ，它有一个简单的用户/密码表单，它向](http://foo.com/)[http://foo.com/login.php](http://foo.com/login.php)发送一个发布请求以登录用户。

如何在另一个站点中创建一个链接，比如[http://foo_autologin.com/](http://foo_autologin.com/)，它将使用预先确定的密码登录[http://foo.com/](http://foo.com/)并在另一个选项卡中打开它，登录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:39:29.950

您可以`http://foo_autologin.php`（不必是 php，可以是 html）使用 Javascript 打开一个新窗口，该窗口指向一个名为 proxy_login.php 的文件或其他文件。然后使用 CURL 将登录凭据发布到`http://foo.com`. 查看[Curl 文档](http://www.php.net/manual/en/ref.curl.php)并查看示例。

# c# - 在 Visual Studio 中监视某些对象？

> ID：12980373
> 
> 赞同：0
> 
> 时间：2012-10-19T18:34:05.490
> 
> 标签：c#, visual-studio, debugging

我知道我们有 Watch 在 Debug 模式下监控一个变量，你可以将变量更改、删除或分配给另一个对象。

但我的意思是监视内存中的一个对象状态。

假设我有一个方法将接收一个对象并分配给一个变量

IE：

```
void DoSomething(object anObject){
   object tempObject = anObject;
} 
```

此方法将被调用超过 1 次。

如果我在这个 tempObject 上使用 Watch，Watch 中的 tempObject 将在新分配的对象值时不断变化。

我在这里感兴趣的是只看这个 anObject 。说第二次调用这个方法，我发现这个anObject有centtain参数不正确，我想追踪这个对象，看看这个不正确的参数什么时候会变回正确的参数。（甚至超出范围）。

我怎样才能做到这一点？还是可以在 Visual Studio 中做到这一点？

因为现在我遇到了类似的问题，我有一个我看到它被处理掉的 centain 对象，但不知何故又在某个地方被再次使用并且它说没有被处理掉。使用 Watch 我不知道这是否是我一直在看的同一对象。

我希望我说清楚了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:04:39.927

尝试对有问题的对象持有[WeakReference并观察它。](http://msdn.microsoft.com/en-us/library/system.weakreference.aspx)从那里您可以查看 的目标`WeakReference`和所讨论的对象是否实际上是同一个对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:42:30.650

只要有对它的强引用，垃圾收集器就不会丢弃一个对象。某些代码可能在对象上调用 Dispose，或者您可能正在使用弱引用。

使用 Son of Strike 调试扩展，您可以随时跟踪对象的 GC Roots。我不确定我们是否可以收到事件通知。

# actionscript-3 - ActionScript 3 访问动态添加的与其他影片剪辑一起的影片剪辑

> ID：12980375
> 
> 赞同：0
> 
> 时间：2012-10-19T18:34:11.307
> 
> 标签：actionscript-3, movieclip

我将如何访问动态添加到父 MovieClip 的 MovieClip。

例如，假设我有一个影片剪辑（mc_a），并在其中创建了一个像这样的 var：

```
var b:DisplayObject = new mc_b(); 
```

我已经手动将 mc_a 添加到我的舞台并给它“实例名称”：

所以我的问题是我如何访问 b（它是 mc_b 的一个实例），当它在 a 内时（它又是 mc_a 的一个实例）？

**编辑：**

我有以下变量引用位于另一个名为“mc_dock”的影片剪辑的第 1 帧上的影片剪辑：

```
var btn_pause:DisplayObject = new mc_pause(); 
```

我使用以下行访问主时间轴上第 1 帧下的停靠栏：

```
var dock:mc_dock = new mc_dock(); 
```

然后我使用以下两行来查看我是否可以从主时间线访问 btn_pause （两者都不起作用[我的意思是它们返回“null”]）：

```
trace(dock.btn_pause);
trace(dock.getChildByName("btn_pause"); 
```

运行时，我得到两个跟踪语句的空值和以下错误：

> > TypeError：错误 #1009：无法访问空对象引用的属性或方法。在 mc_dock/frame1()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:39:44.140

```
a.getChildByName("instanceNAMEhere") 
```

或者

只需访问变量 b

# jquery - 如何将数组数据传递给 jQuery 对话框并显示？

> ID：12980376
> 
> 赞同：0
> 
> 时间：2012-10-19T18:34:12.827
> 
> 标签：jquery

您好我正在尝试将数组数据传递到 jquery 对话框并显示。我对此没有太多运气，我猜我的整个方法都是错误的。非常感谢任何正确方法的指导。

```
<html>
<div id="confirm"></div>
</html>

<script>
var array_data = ["London", "NewYork", "Miami" , "LosAngeles"];

$('#confirm').html(array_data).dialog({
    autoOpen: false,
    modal: true,
    title: 'Confirmation message',
    buttons: {
          Submit: function () { //Do Something here };
          Cancel: function () { $(this).dialog("close"); }
    },
     width: 850, height: 300
}).dialog('open');

</script> 
```

我无法弄清楚如何将数组对象传递给模态，然后一一打印出数组值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:56:49.273

如果您打算在对话框打开时打印出数组值，则可以将打开事件附加到对话框。您可能想查看：[http ://api.jqueryui.com/dialog/#event-open](http://api.jqueryui.com/dialog/#event-open)

所以在你的情况下，你可以这样做：

```
<html>
<div id="confirm"></div>
</html>

<script>
var array_data = ["London", "NewYork", "Miami" , "LosAngeles"];

$(document).bind("ready", function(){
$('#confirm').dialog({
    autoOpen: true,
    modal: true,
    title: 'Confirmation message',
    buttons: {
          Submit: function () { },
          Cancel: function () { $(this).dialog("close"); }
    },
     width: 850, height: 300,
     open: function(event, ui) {
        $(array_data).each(function(index, data){
           console.log(data);
        });
     }
});
});

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:47:23.923

绝对将数组传递给 dailog 是行不通的，因为它无法解释其中存储的内容。尝试使用 jQuery.each(http://api.jquery.com/jQuery.each) 并提取每个元素并传递给逻辑。

# c# - 在 WPF 中的第一列上设置固定的 GridView 宽度

> ID：12980379
> 
> 赞同：0
> 
> 时间：2012-10-19T18:34:21.753
> 
> 标签：c#, wpf, gridview

我有一个连接到 Dictionary<> 的 GridView。我只想为第一列设置最大宽度。我知道 DataGrid.ColumnWidth 设置了静态列宽，但这是针对所有列的。如何为特定列定义特定宽度？

![网格视图](../Images/bc7d77236d67709c421a730273971524.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:46:32.423

您可以使用 DataGridTemplateColumn 模板：

```
`<DataGrid.Columns>
   <DataGridTemplateColumn Width="300" Header="Test">
//Your control (TextBlock)
   </DataGridTemplateColumn>
</DataGrid.Columns>` 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-20T09:00:30.630

找到了答案：

```
DataGrid.Columns[0].Width = 150; 
```

# java - Hsql重载和

> ID：12980384
> 
> 赞同：0
> 
> 时间：2012-10-19T18:34:42.410
> 
> 标签：java, hsqldb

我正在使用 hsql 和另一个 3rd 方库。为了解决某个问题，我需要编写我的自定义聚合函数。这个页面向我展示了如何做到这一点：http: [//hsqldb.org/doc/2.0/guide/sqlroutines-chapt.html#src_jrt_routines](http://hsqldb.org/doc/2.0/guide/sqlroutines-chapt.html#src_jrt_routines)

但是，其他 3rd 方工具限制我只能使用预定义的聚合函数子集。有没有办法添加一个重载版本，例如 sum 采用预定义类型然后调用我的自定义逻辑？我在想一些与java的方法重载非常相似的东西。不幸的是`create aggregate function custom_sum(...)...`，工作，但`create aggregate function sum(...)...`没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:58:56.210

用户函数不能覆盖内置函数。

您当然可以通过修改 HSQLDB 源来禁用 SUM() 函数。

迫使您提供自己的 SUM() 版本的实际问题是什么？

# php - 覆盖 PHP 配置选项

> ID：12980387
> 
> 赞同：2
> 
> 时间：2012-10-19T18:34:56.653
> 
> 标签：php, apache, .htaccess

我正在尝试使用`.htaccess`文件设置一些 php 配置选项，然后在 php.ini 中获取它们。如果我写`php_value max_execution_time 21`，那么我可以`ini_get('max_execution_time')`在返回 21 的浏览器中运行（使用 CLI 它返回“0”，但我不知道为什么）。

但是，如果我`php_value error_log someValue`使用`ini_get('error_log')`它在浏览器和 CLI 中返回布尔值 false。我的配置有什么问题。我怎样才能获得价值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:40:00.797

CLI 是`PHP Command Line Interface`. 顾名思义，这是在系统命令行中使用 PHP 的一种方式。或者换句话说，它是一种方式`running PHP Scripts that aren't on a web server`（例如 Apache Web 服务器或 Microsoft IIS）

`.htaccess`（超文本访问）是文件是目录级别的配置文件，`works with web servers`如Apache

它们中的两个是 2 种不同的技术，这意味着 PHP 和 .htacess 只能共享变量，如果你在`Web Server`非 via上运行它们`Command line`

# mongodb - MongoDB 可以处理 TB 的数据吗？

> ID：12980389
> 
> 赞同：2
> 
> 时间：2012-10-19T18:35:19.627
> 
> 标签：mongodb, hbase, bigdata

MongoDB 会处理几 TB 的数据吗？我读过帖子说 Mongo 在小于 1TB 的数据方面表现良好，对于更大的数据集，我应该使用 HBase。真的吗？

我需要存储并稍后处理几 TB 的文本数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:11:38.000

您可能会感兴趣：

*   [Wordnik](http://www.10gen.com/customers/wordnik)：>3TB 范围内的数据集
*   [Craiglist](http://www.10gen.com/customers/craigslist)：设计用于支持 10TB 数据的分片集群。

您可以在 10gen 的网站上找到一些额外的[案例研究](http://www.10gen.com/customers)，尽管并非所有案例都提供数据集大小的具体数字。在 Stack Overflow 上也有一些关于这个问题的较早讨论（有关 2010 年 3 月拥有 12TB 数据的用户的简介，[请参见此处），您可能会发现更多案例研究分散在](https://stackoverflow.com/a/2503319/162228)[Speaker Deck](https://speakerdeck.com/)或[Slideshare](http://www.slideshare.net/)上的演示文稿中。简而言之，MongoDB 当然可以处理这么多的数据（今天人们正在使用它），但是您需要注意最佳实践，这是现有演示文稿可以派上用场的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-24T04:48:08.357

**MongoDB**

数以万计的组织使用 MongoDB 大规模构建高性能系统。超过三分之一的财富 100 强企业以及许多最成功和最具创新性的网络公司都依赖 MongoDB。它们已经从单一服务器部署发展为拥有超过 1,000 个节点的集群，每秒对超过 1000 亿个文档和 PB 级数据进行数百万次操作。

可扩展性不仅仅是速度。这大约是 3 个不同的指标，它们经常一起工作：

集群规模。将数据库分布在 100 多个节点上，通常位于多个数据中心

表现量表。维持每秒 100,000 次以上的数据库读取和写入，同时保持严格的延迟 SLA

数据规模。在数据库中存储超过 10 亿个文档有许多 MongoDB 用户正在突破可伸缩性极限的例子。这里有一些，围绕每个缩放维度进行组织。

[您可以在本文](http://s3.amazonaws.com/info-mongodb-com/MongoDB_BI_Analytics.pdf)中找到有关 MongoDB：将在线大数据引入商业智能和分析的参考资料

# qt - 使用 Qt 在 QGraphicsScene 中平滑线

> ID：12980390
> 
> 赞同：0
> 
> 时间：2012-10-19T18:35:20.730
> 
> 标签：qt, curve-fitting, qgraphicsscene, qpainter, mousepress

我需要用 Qt 绘制曲线：用户单击 QGraphicsScene（通过 QGraphicsView），并在用户单击的点之间绘制直线。当用户画完直线（通过点击右键），这组线变成了一条曲线。

为此，我需要使用该[`QPainterPath::cubicTo(...)`](http://qt-project.org/doc/qt-5/qpainterpath.html#cubicTo)方法并使用[`QGraphicsScene::addPath(...)`](http://qt-project.org/doc/qt-5/qgraphicsscene.html#addPath).

问题是我不知道如何计算传递给`cubicTo(...)`.

例如，在下图中，用户通过单击点 AB 和 C 绘制了两条灰线。当她单击右键时，我想使用 绘制红线`cubicTo(...)`：

![预期的线条和曲线](../Images/22dacb5ad11bd5f3a2256d3f9953fa49.png)

我当前的代码仅绘制灰线，因为我已将 、 和 值设置`c1`为用户单击的点位置：`c2``d1``d2`

```
void Visuel::mousePressEvent(QMouseEvent *event)
{
    int x = ((float)event->pos().x()/(float)this->rect().width())*(float)scene()->sceneRect().width();
    int y = ((float)event->pos().y()/(float)this->rect().height())*(float)scene()->sceneRect().height();
    qDebug() << x << y;

    if(event->button() == Qt::LeftButton)
    {
        path->cubicTo(x,y,x,y,x,y);
    }
    if(event->button() == Qt::RightButton)
    {
        if(path == NULL)
        {
            path = new QPainterPath();
            path->moveTo(x,y);

        }
        else
        {

            path->cubicTo(x,y,x,y,x,y);
            scene()->addPath(*path,QPen(QColor(79, 106, 25)));
            path = NULL;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T12:33:51.623

显然控制点 c1、c2、d1、d2 只是图片中 B 点的坐标。在更一般的情况下，点 C 位于 AB 线上，点 D 位于 BC 线上。

在 Qt 代码中可以这样写： Visuel 类应该具有以下属性：

```
QPoint A, B, C;
unsigned int count; 
```

应该在 Visuel 的构造函数中初始化。

```
void Visuel::Visuel()
{
    count = 0;
    // Initialize other stuff as well
} 
```

然后我们要重载 QGraphicsScene::mousePressEvent() 来检测用户的鼠标事件：

```
void Visuel::mousePressEvent(QGraphicsSceneMouseEvent *event)
{
    /* Ignore everything else except left button's press */
    if (event->type() != QEvent::GraphicsSceneMousePress ||
        event->button() != Qt::LeftButton) {
        return;
    }
    switch (count) {
    case 0:
        A = event->scenePos();
        break;
    case 1: {
        B = event->scenePos();

        /* Draw AB line */
        QPainterPath path(A);
        path.lineTo(B);
        scene()->addPath(path, Qt::grey);
        }
        break;
    case 2: {
        C = event->scenePos();

        /* Draw BC line */
        QPainterPath path(B);
        path.lineTo(C);
        scene()->addPath(path, Qt::grey);

        /* Draw ABBC cubic Bezier curve */
        QPainterPath path2(A);
        path2.cubicTo(B, B, C);
        scene()->addPath(path2, Qt::red);
        }
        break;
    default:
        break;
    }
    if (count >= 2) {
        count = 0;
    } else {
        count++;
    }
} 
```

# javascript - 如何在 a 中获取 img src 标签？

> ID：12980401
> 
> 赞同：5
> 
> 时间：2012-10-19T18:36:05.857
> 
> 标签：javascript, jquery

我正在尝试从选定的列表项中获取图像的 src。HTML 如下所示：

```
<li id="player_7">
  <div class="nailthumb-container square-thumb">
    <img src="../photos/files/7/thumb/6c0f1676cdcb1a9a5215db3e12572450.jpeg" />
  </div>
</li> 
```

我目前可以从选定的列表元素中获取玩家 ID，如下所示：

jQuery

```
$('#myDiv').find("li").click(function() {
    var user_id = $(this).attr('id').substr(7);
}); 
```

如何从选定的列表元素中获取 img src？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T18:37:06.770

如果`user_id`对应玩家ID中的数字，则尝试：

```
var src = $("#player_" + user_id + " img").prop("src"); 
```

否则，分别到被点击的列表项：

```
$("#myDiv").find("li").click(function() {
    var src = $("img", this).prop("src");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T18:37:15.917

使用 jQuery 获取图像元素，然后读取其 src 属性。

```
$('#myDiv').find("li").click(function() {
    var user_id = $(this).attr('id').substr(7);
   var src = $("img", this)[0].src;
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T18:58:19.177

我可以问你为什么在应该做的`$("#myDiv").find("li")`时候`"$("#myDiv li")`做就好了吗？然后，在这一点上，以下内容就足够了：

```
$('#myDiv li").click(function() {
    var user_id = $(this).attr('id').substr(7);
    var src = $("img",this).attr('src');
    // ...
}); 
```

就个人而言，我更喜欢在 ID 上使用拆分来获取 user_id，（`.attr('id').split('_')[1]`），但是如果您需要更改前缀或命名约定，则必须以任何一种方式修改您的代码，我不认为那真的很重要。它可能会影响性能（因为 split 似乎总是更快，虽然我不记得为什么），如果你有很多这些要一次解析，但否则，对于一对一的操作， substr 应该工作正好。

# windows - 如何判断命名管道的服务器端是否是管理员？

> ID：12980403
> 
> 赞同：2
> 
> 时间：2012-10-19T18:36:22.673
> 
> 标签：windows, security, named-pipes

我正在尝试在 Windows XP SP2+ 上使用命名管道。管道服务器将是一项服务，以某种管理员/系统级帐户的身份运行。管道客户端可以是任何用户，可能是访客，也可能是管理员。就我而言，我可以让访客帐户成功地与以管理员身份运行的服务进行通信。

在我开始在我的客户端代码中使用管道之前，我想验证管道的另一端是否真正归管理员/系统所有。

我发现了 GetSecurityInfo 函数，我认为我应该能够将它用作解决方案的一部分。但是，我不知道如何从 SID 到“是管理员”检查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T20:47:40.877

由管理帐户（包括系统帐户）创建的所有对象的默认所有者是众所周知的管理员组，您不能将您创建的对象的所有权分配给没有管理权限的其他人。

所以你可以检查如下：

*   使用[GetSecurityInfo](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446654%28v=vs.85%29.aspx)获取管道对象所有者的 SID。

*   使用带有 WinBuiltinAdministratorsSid 选项的[CreateWellKnownSid](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446585%28v=vs.85%29.aspx)为管理员组创建 SID。

*   使用[EqualSid](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446622%28v=vs.85%29.aspx)比较两个 SID。

确保在打开管道时（使用[CreateFile](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)）传递 SECURITY_IDENTIFICATION 标志以确保潜在的恶意服务器无法冒充您。

# java - 文件/扫描仪简单解析问题

> ID：12980407
> 
> 赞同：0
> 
> 时间：2012-10-19T18:36:47.847
> 
> 标签：java, regex, string, file, java.util.scanner

给定一个 File 和一个 Scanner 对象，

```
File simpleFile = ranFi.getSelectedFile();
Scanner text = new Scanner(simpleFile); 
```

以及这两个司空见惯的陈述：

```
 while(text.hasNext())
    {
        String currentLine = text.nextLine(); 
```

我正在尝试在单个 if 语句子句中使用 Scanner/String 类逻辑语句，该语句在给定的匹配正则表达式下读取文件的第一行，例如：

```
String fp100 = "[S][:][A-Ze0-1]";
String fp200 = "[S][:][A-Z0-1][A-Z0-1]";
//other regexes… 
```

然后在同一 if 语句子句中调用适当的 Scanner/String 类方法以读取第二行和后续行/可接受的行。我已经上下阅读了javadoc，但还没有弄清楚。使用 currentLine.matches(regex) 和 text.nextLine().matches(regex)，编译此代码，

```
 if(currentLine.matches(fp100)||currentLine.matches(fp200)||
       currentLine.matches(fp300) && text.nextLine().matches(fp100)||
       text.nextLine().matches(fp101) || text.nextLine().matches(fp200)||
       text.nextLine().matches(fp201) || text.nextLine().matches(fp300)||
       text.nextLine().matches(fp301))
    { 
```

但立即抛出无此类元素异常。我究竟做错了什么？提前感谢您的宝贵时间。**编辑：**我已经包含了堆栈跟踪，但删除了源代码，因为这是与项目相关的。

![堆栈跟踪](../Images/d2fa0d3bda6d62f3609c73035d8b6167.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:40:48.680

`while(text.hasNextLine())`如果您在循环内使用，您的 while 循环应该开始`text.nextLine().matches(regex)`。当心。如果`text.hasNext()`计算结果为真，这并不意味着`text.nextLine()`它将是非空的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:44:51.520

我看到两个问题：

1.  当您执行`if`条件时， `text.nextLine()`可能不可用。

2.  如果你的意思是说，当任何 currentLine 匹配 + 任何 nextLine 匹配为 true 时执行 if 然后将`||`参数包装在大括号中：

    ```
    if((currentLine.matches(fp100)||currentLine.matches(fp200)||
       currentLine.matches(fp300)) && 
       (text.nextLine().matches(fp100)||
        text.nextLine().matches(fp101) || text.nextLine().matches(fp200)||
        text.nextLine().matches(fp201) || text.nextLine().matches(fp300)||
        text.nextLine().matches(fp301))) 
    ```

我想你想写你的`while`循环是这样的：

```
 while(text.hasNextLine()){
           String currentLine = text.nextLine();
           String nextLine = "";
           if(text.hasNextLine())[
               nextLine  = text.nextLine();
           }

           /**ACC conditions*/
           if((currentLine.matches(fp100)||currentLine.matches(fp200)
                || currentLine.matches(fp300)) 
                && (nextLine.matches(fp100)|| nextLine.matches(fp101) 
                     || nextLine.matches(fp200)
                     || nextLine.matches(fp201) || nextLine.matches(fp300)
                     || nextLine.matches(fp301)) {
                                //current line is OK
                                System.out.println(currentLine);
                                output.write(currentLine);
                                output.write("\n");
                                abc1List.add(currentLine);
                                lineOK++;               

                                //next line is OK
                                System.out.println(nextLine);
                                output.write(nextLine);
                                output.write("\n");
                                abc1List.add(nextLine);
                                // <-- not sure if you want OK as 1 or 2 here 
                                lineOK++;           
           } /**REJ conditions*/
           else if(!currentLine.matches(fp100)||!currentLine.matches(fp101)||
                  !currentLine.matches(fp200)||!currentLine.matches(fp201)||
                  !currentLine.matches(fp300)||!currentLine.matches(fp301)){   
                        System.out.println("invalid cfg; terminating....");
                   System.exit(0);
           }
       }//end of while 
```

# c# - 别名冲突命名空间 c#

> ID：12980409
> 
> 赞同：0
> 
> 时间：2012-10-19T18:36:49.057
> 
> 标签：c#

寻找解释。

我在两个不同的程序集中有相同的名称空间。说

```
NsA.xxx.NsB 
```

现在我创建了一个别名来解决这个问题并将其命名为 xxx。
我将“global”作为另一个程序集的别名命名空间。

问题是“xxx”作为别名与“xxx”命名空间部分冲突。我通过将别名命名为“XXX”解决了这个问题。现在没有冲突，每个人都恢复了快乐的想法。

这是出乎意料的（对我来说）。这是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:40:15.720

这不是一个错误。当代码中使用的多个程序集具有相同名称的类时，这就是您解决冲突的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:41:04.903

C# 区分大小写，因此命名空间 xxx 和命名空间别名 XXX 之间存在明显区别。

例子：

```
using Company.People.Employee;
//using Contractor.People.Employee;
using PEOPLE = Contractor.People;

//People.Employee is not the same as PEOPLE.Employee, even though they look very similar 
```

# android - 如何设置wordpress android项目

> ID：12980415
> 
> 赞同：0
> 
> 时间：2012-10-19T18:37:10.427
> 
> 标签：android, wordpress

我是 Android 开发的新手。我在构建项目时遇到问题。

修订版 836，2012 年 10 月 8 日 Eclipse 经典：版本：4.2.0 构建 ID：I20120608-1400

Android SDK：4.1.2 API 16

在我导入了 Wordpress Android 项目之后。我有很多错误。

见这里：[错误截图](http://blackgun.files.wordpress.com/2012/10/eclipse-error.gif)

我设置：

> 默认.properties

```
target=android-16 
```

> AndroidManifest.xml

```
<uses-sdk
android:minSdkVersion=”8”
android:targetSdkVersion=”16” /> 
```

它不起作用。

该错误是由覆盖引起的，所以我猜它没有找到正确的库和类。

如何设置项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:47:23.377

请向我们提供错误输出。检查“Android SDK”安装路径是否在 Eclipse 中正确配置，您可以通过“Window”>“Preferences”>“Android”进行检查

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:03:21.730

检查您的 Java 编译器合规级别，Eclipse 默认为 1.5，它只能覆盖超类方法（这是您的错误日志显示的问题）。如果您的项目覆盖接口方法，那么您需要将其更改为 1.6。

您可以通过以下方式更改：

```
Project>Properties>Java Compiler 
```

# shell - SSH 来自 shell 脚本的另一个 shell 脚本

> ID：12980416
> 
> 赞同：-1
> 
> 时间：2012-10-19T18:37:12.447
> 
> 标签：shell, ssh

我在里面`host1`，我想用 shell脚本在另一台主机`shell1.sh`上执行另一个 shell 脚本。需要 ssh 相同。抱歉，我对这个脚本不太熟悉`shell2.sh``host2`

所以：

```
host1$ sh shell1.sh ----ssh---->  host2$ shell2.sh 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:06:41.137

在你的`shell1.sh`：

```
#!/bin/sh

ssh host2 '/bin/sh /path/to/shell2.sh' 
```

并且，如果`shell2.sh`文件不在`host2`：

```
#!/bin/sh

ssh host2 < /path/to/shell2.sh 
```

在第一种选择中，您将传递给`ssh`第二个参数，它将其解释为要在远程计算机上执行的命令。

来自`man ssh`：

> 如果指定了**command**，它将在远程主机而不是登录 shell 上执行。

在第二个脚本中，命令通过 stdin`shell2.sh`传递给`ssh`命令，然后将它们转发到`host2`的 shell，最后执行它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:27:03.343

你可以这样做：

**本地.sh**：

```
#!/bin/bash
hostname
whoami
ifconfig 
```

然后，使用本地脚本，您可以远程运行它：

```
ssh host < local.sh 
```

远程主机的`STDIN`shell 将*与*本地 shell 脚本连接。

# rally - Rally：每个测试用例的最大测试结果数

> ID：12980433
> 
> 赞同：1
> 
> 时间：2012-10-19T18:38:11.667
> 
> 标签：rally, testcase

我们可以分配给 Rally 中的测试用例的测试用例结果的数量是否有限制。我想每天运行回归测试并添加测试用例结果。会好吗？

谢谢，哈里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:40:01.640

因此没有上限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T14:46:06.263

除非你有数千个测试用例，并且假设它真的每天只有一次，而不是每次构建，那么你应该没有问题。[正如最近一项性能研究](http://www.rallydev.com/resource/alm-performance-study)证实的那样，Rally 继续在许多工件上表现良好。

披露：我是 Rally Software 的分析总监。

# php - Smarty 模板：是否可以扩展基本 {block} 以添加自定义功能？

> ID：12980434
> 
> 赞同：2
> 
> 时间：2012-10-19T18:38:25.637
> 
> 标签：php, smarty, template-engine, smarty3

我对模板有非常具体的任务。我需要扩展标准 Smarty 3 ( 3.1-DEV ) 模板系统以获得自定义 {block} 功能，但保留基本功能（添加/重写、求和等）通常我需要处理每个 {block} 竞争以获得下一个功能：

*   忽略 {block} 之外的每个模板的内容（模板源无关紧要）
*   保留对已处理 {block} 内容的“引用”（我想获取在 smarty 析构函数中“显示”的任何块的缓存内容，但不想将其保留在内存中）
*   具有相同的继承功能（能够获得嵌套块父母等）
*   保留原生 smarty 缓存系统
*   并且不要直接修改 smarty 引擎，通过插件和类扩展来实现

我试图创建自定义块函数，但它失去了原生 {block} 上的继承功能，我无法控制显示/处理的内容并在析构函数中获取它的内容。

主要思想是处理所有`$smarty->display()`和`$smarty->fetch()`调用，收集所有块的内容并保留对其内容的引用，但不会立即显示。

内容必须显示在主 smarty 实例析构函数中。显示的内容必须使用已处理的块进行组装。

可能还有其他一些模板解决方案可以完成这项任务，或者 smarty 中有任何现成的功能，但我找不到。我也不想更改 smarty 模板系统并拒绝使用 php 模板`<? if( $a < $b ): ?> <b>Output</b> <? endif; ?>`，这对我来说太难看了。

**upd**：我想用 Smarty 实现“两步视图”，但要简单易行。

谢谢。

# local-storage - 使用 localStorage 缓存 Kendo UI DataSource 对象

> ID：12980444
> 
> 赞同：4
> 
> 时间：2012-10-19T18:39:21.563
> 
> 标签：local-storage, kendo-ui

我正在使用带有外部 XML 数据源的 Kendo UI ComboBox。这是数据源代码：

```
try
    {
        var csDataSrc = new kendo.data.DataSource(
        {
            transport:
        {
            read: "Data/StateList.xml",
            dataType: "xml",
            create: { cache: true }
        },
        schema:
        {
            type: "xml",
            data: "/States/State",
            model:
            {
                fields:
                {
                    id: "id/text()",
                    name: "name/text()"
                }
            }
        }
    });
    csDataSrc.read();
}
catch (err)
{
    log.error(err.message);
} 
```

这将创建数据源，这是创建剑道组合框的代码：

```
$("#stateList").kendoComboBox(
{
    index: 0,
    placeholder: "Begin typing Coverage State...",
    dataTextField: "name",
    dataValueField: "id",
    filter: "contains",
    dataSource: csDataSrc,
    text: $("#hdnStateName").val(),
    value: $("#hdnStateKey").val(),
    change: function(e)
    {
        $("#hdnStateKey").val(this.value());
        $("#hdnStateName").val(this.text());
    }
}); 
```

这非常有效，但实际列表的数据非常庞大，我想将其存储在本地存储中，如下所示： localStorage.setItem("state_key", csDataSrc); 然后，当页面加载而不是一直从服务器端 xml 构建和读取时，我希望它是这样的：

```
var csDataSrc = localStorage.getItem("state_key");
if(csDataSrc === null)
{
    // create the data source with the above code
    // and store it in localStorage.
} 
```

然后在这里绑定...

```
...kendoComboBox(
{
    ...,
    .dataSource: csDataSrc,
    ...
}); 
```

我很好地创建了数据源，它似乎正确存储在 localStorage 中，但是当您离开页面并返回时，数据源始终为空。我可以使用 Chrome 开发人员工具的资源选项卡看到它，但它不会正确绑定到组合框。任何帮助，或者如果我需要详细说明任何事情以使这一点更清楚，请告诉我

谢谢-s

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-06T22:24:03.483

为此，您可以使用自定义读取方法（[链接](http://docs.kendoui.com/api/framework/datasource#transportread-objectstringfunction)）。

```
transport: {
    read: function(operation) {
        var cashedData = localStorage.getItem("moviesData");

        if(cashedData != null || cashedData != undefined) {
            //if local data exists load from it
            operation.success(JSON.parse(cashedData));
        } else {
            $.ajax({ //using jsfiddle's echo service to simulate remote data loading
                url: '/echo/json/',
                type: "POST",
                dataType: "json",
                data: {
                    json: JSON.stringify(data)
                },
                success: function(response) {
                    //store response
                    localStorage.setItem("moviesData", JSON.stringify(response));
                    //pass the pass response to the DataSource
                    operation.success(response);
                }
            });
        }                 
    }
} 
```

这是一个工作示例：http: [//jsfiddle.net/LnTe7/12/](http://jsfiddle.net/LnTe7/12/)

# javascript - 如何将值从函数设置为数组？在 JavaScript 中

> ID：12980446
> 
> 赞同：0
> 
> 时间：2012-10-19T18:39:39.200
> 
> 标签：javascript, arrays

如何从函数中设置数组的值？问题是因为我必须在使用变量值设置之前更改索引的值。

```
function foo(arr) {
    this.arr=arr;
}

var f = new foo(['a', 'b', 'c']);

// I had thinked in use a function like this one
// Note thta I used index to pass an array wich could
// be greater than 1 dimension.

foo.prototype.setv = function(index, v) {
    this.arr.index = v;
}

// but it does not works like I was expecting
idx = [1];
foo.setv(idx, "Z"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:41:37.367

这：

```
this.arr.index = v; 
```

应该是这样的：

```
this.arr[index] = v; 
```

在您的代码中，您正在将名为“index”的数组属性设置为一个值。这实际上并不使用`index`传递给您的 setter 函数的参数。使用小括号表示法进行设置允许您将`index`参数用作数组的实际索引。

而且，您的预期用法很奇怪：

```
idx = [1];
foo.setv(idx, "Z"); 
```

为什么是`idx`数组？如果要将内部数组的特定索引设置为一个值，则希望只传入索引。因此，简单地说：

```
idx = 1;
foo.setv(idx, "Z"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:41:49.797

```
foo.prototype.setv = function(index, v) {
    this.arr[index] = v;
}

idx = 1;
foo.setv(idx, "Z"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T18:41:20.983

```
foo.prototype.setv = function(index, v) {
    this.arr[index[0]]= v;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T18:52:28.073

您发布的代码中有很多错误：

```
// capitalizing "constructors" is a good standard to follow
function Foo(arr) {
    this.arr = arr;
}

var f = new Foo(['a', 'b', 'c']);

Foo.prototype.setv = function(index, v) {
    // you access array indices via arr[index], not arr.index
    this.arr[index] = v;
}

// idx should be a number, not an array
idx = 1;

// you call the prototype function on the new'd object, not the "class"
f.setv(idx, "Z"); 
```

[http://jsfiddle.net/2mB28/](http://jsfiddle.net/2mB28/)

# php - PHP 上传脚本在 Firefox 中不起作用，但在 Chrome 中不起作用

> ID：12980448
> 
> 赞同：1
> 
> 时间：2012-10-19T18:39:45.100
> 
> 标签：php, firefox, google-chrome, file-upload

我正在尝试使用此 PHP 脚本在上传时检查文件的扩展名。问题是它在 Chrome 中完美运行，但在 Firefox 中，即使扩展名正确，它也总是返回 false，因此总是回显“无效文件”。

```
 $allowedExts = array("mp3", "wma", "wav", "ogg", "aac", "aiff", "amr", "ra");
    $arr = explode(".", $_FILES["file"]["name"]);
    $extension = end($arr);

    if ((($_FILES["file"]["type"] == "audio/mp3")
    || ($_FILES["file"]["type"] == "audio/wma")
    || ($_FILES["file"]["type"] == "audio/wav")
    || ($_FILES["file"]["type"] == "audio/ogg")
    || ($_FILES["file"]["type"] == "audio/aac")
    || ($_FILES["file"]["type"] == "audio/aiff")
    || ($_FILES["file"]["type"] == "audio/amr")
    || ($_FILES["file"]["type"] == "audio/ra"))
    && ($_FILES["file"]["size"] < 20000000)
    && in_array($extension, $allowedExts))
      {
       .
       .
       .
       .
      }
    else
      {
      echo "Invalid file";
      } 
```

谁能告诉 if 部分中它在 Firefox 中不起作用的问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:52:48.780

这是因为文件类型具有音频/类型名称，并且您将其与类型匹配。

尝试使用 in_array 函数并使用 preg_replace 删除音频/

```
$allowedExts = array("mp3", "wma", "wav", "ogg", "aac", "aiff", "amr", "ra");
$allowedSize = 20000000;
$currentType = preg_replace('/(.*)(/)/','',$_FILES['file']['type']);
$currentSize = $_FILES['file']['size'];

if( in_array($currentType,$allowedExts) && $currentSize < $allowedSize ) 
{
    // DO UPLOAD 
    // REFER TO http://php.net/manual/en/function.move-uploaded-file.php
}
else
{
    // ERROR UPLOADING FILE
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:48:08.833

无论浏览器如何，PHP 的工作原理都是一样的。

您需要查看您的 HTML 代码。

这就是问题所在。

# java - 切换选项卡后Java小程序拉伸

> ID：12980449
> 
> 赞同：0
> 
> 时间：2012-10-19T18:39:49.370
> 
> 标签：java, layout, applet

所以基本上，我的 Java 小程序在切换到浏览器的另一个选项卡并返回后变得有弹性。一切都变得不正常并且放大了。你可以像这样复制它：

1.  [http://abirechner.bplaced.net/](http://abirechner.bplaced.net/)
2.  用 1-15 的数字填写每个文本字段
3.  按“weitere Fächer”
4.  按“确定”
5.  用 1-15 的数字填写前两行
6.  按“Prüfungsfächer”
7.  在组合框中选择“Deutsch”、“Englisch”、Geschichte、“Mathematik”或“Musik”
8.  用 1-15 的数字填写文本框。
9.  按“auswerten”
10.  切换标签并返回。

它是用于德语 a-levels 的计算器，是作为学校项目制作的。

该布局使用带有两个 Gridlayouts 的 BorderLayout，其中也包含多个 Gridlayouts。

//编辑：截图： http: [//picturepush.com/public/11206621](http://picturepush.com/public/11206621)

# jquery - 查找一组元素的任何成员是否有一个类

> ID：12980451
> 
> 赞同：1
> 
> 时间：2012-10-19T18:39:58.530
> 
> 标签：jquery, css

我正在尝试查看是否有任何输入具有 JQuery 的“无效”类。

```
$('#formId input').hasClass('invalid'); 
```

正在回归`false`。即使在我使用`.addClass('invalid')`输入并使用 Chrome 的 DOM 检查器验证该类存在之后。

以下建议不起作用。我的标记与表单>输入有点不同。

[http://jsfiddle.net/Jv4tG/](http://jsfiddle.net/Jv4tG/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T18:42:36.847

只需使用类名作为选择器：

```
$('#formId input.invalid'); 
```

这只会对具有该类的元素进行操作，否则，作为条件，您可以使用`length`：

```
if ($('#formId input.invalid').length) {
    // some elements have that class
} 
```

你也可以使用`filter()`：

```
$('#formId input').filter(function(){
    return $(this).hasClass('invalid');
}); 
```

这会将选择器限制为仅*具有*该类的那些元素，或者：

```
$('#formId input').filter(function(){
    return !$(this).hasClass('invalid');
}); 
```

返回那些*没有*无效类名的元素。

# javascript - 阻止 Cassette 缩小 JavaScript 文件

> ID：12980458
> 
> 赞同：2
> 
> 时间：2012-10-19T18:40:11.090
> 
> 标签：javascript, .net, minify, cassette

我正在使用[Cassette](http://getcassette.net/)来缩小我的 JavaScript。我不希望 Cassette 缩小我的 JavaScript 文件之一，因为它会导致错误。我宁愿使用原始库作者提供的已经缩小的版本。

如何在不缩小文件的情况下将 JavaScript 文件添加到 Cassette？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:40:11.090

您可以对 Cassette 1.x 使用以下代码来创建不执行任何缩小的 IAssetTransformer

```
public class NoMinification : IAssetTransformer
{
    public NoMinification() {}

    public Func<Stream> Transform(Func<Stream> openSourceStream, IAsset asset)
    {
        return openSourceStream;
    }
} 
```

然后更新您的 CassetteConfiguration 以将已经缩小的文件放在它自己的包中，因为您必须为单个包中的所有文件设置缩小器。如果此 javascript 文件依赖于另一个文件，该文件将被盒式磁带缩小并最终出现在它自己的包中，您可以使用 .AddReference ，正如我在注释掉的行中显示的那样。

```
public class CassetteConfiguration : ICassetteConfiguration
{
    public void Configure(BundleCollection bundles, CassetteSettings settings)
    {
        //So, we set a no-op minifier for this bundle and force it into it's own bundle.
        bundles.Add<ScriptBundle>("Scripts/already-minified-file.min.js", b => {
            b.Processor = new ScriptPipeline { Minifier = new NoMinification() };
            //b.AddReference("~/Scripts/dependent-scripts.js");
        });
    }
} 
```

# java - 有没有办法用 Java 属性读取 mime 类型文件？

> ID：12980469
> 
> 赞同：0
> 
> 时间：2012-10-19T18:40:54.440
> 
> 标签：java, properties, mime-types

我正在尝试使用 Java 属性读取 mime 类型文件，以根据文件扩展名获取适当的 mime 类型。但是，该文件的布局使我只能获得 mime 类型的文件扩展名，而不是相反。

例如：

```
text/html                   html htm 
```

与所需的格式相反：

```
html htm                    text/html 
```

因此，如果我使用 Properties 对象读取它，如下所示：

```
mimeTypes.getProperty("text/html"); 
```

我会得到 html 和 htm 但如果我在另一轮做：

```
mimeTypes.getProperty("html"); 
```

我不会得到我想要的 text/html。那么，有没有办法通过提供密钥的值来获取密钥呢？

感谢您的帮助，如果问题出现问题或任何问题，我们深表歉意。

干杯

编辑：

不，我不会使用这个：

```
FileNameMap fileNameMap = URLConnection.getFileNameMap();
String mimeType = fileNameMap.getContentTypeFor(filename); 
```

我想走很长的路，因为我是那样的铁杆 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:16:10.973

您可以使用 entrySet() 函数来获取映射（键、值）。然后迭代该集合。我认为集合 api 中没有直接的方法可以从值中获取密钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T16:15:15.400

听起来您想读取 mimetypes 文件，对其进行解析，然后将其放入 extension:type （而不是 type:extensions）的“反向”HashMap 中。您仍然可以使用 Properties 将其读入，只要拥有它，您就需要将其解析为反向 HashMap。我认为这会让你的代码更干净。

# ruby-on-rails - 使用 Rails 和不显眼的 javascript 渲染新视图

> ID：12980471
> 
> 赞同：2
> 
> 时间：2012-10-19T18:41:15.233
> 
> 标签：ruby-on-rails, ruby, unobtrusive-javascript, ujs

我正在尝试使用 UJS 和 Rails 3 简单地呈现视图，但它实际上并没有工作。我已经阅读了很多教程，但似乎无法理解。以下是一些代码片段：

index.js.erb

```
"<%= render user_path(@this_user) %>" 
```

索引.html

```
<%= form_tag users_path, :method => :get, :remote => true do %>
    <%= submit_tag "Test", :name => nil, :class => "btn" %>
<% end %> 
```

users_controller.rb

```
def index
   @users = User.all
   @this_user = User.find(1)
 respond_to do |format|
   format.html # index.html.erb
   format.js
   format.json { render json: @users }
 end
end 
```

每次单击“测试”时，都会得到以下输出：

> 在 2012-10-19 11:31:49 -0700 开始 GET "/users?utf8=%E2%9C%93" for 127.0.0.1 -0700 由 UsersController#index 作为 JS 参数处理：{"utf8"=>"✓" } 用户负载 (0.4ms) SELECT "users".* FROM "users"
> 用户负载 (0.2ms) SELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1 [["id" , 1]] 渲染 users/index.js.erb (1.8ms) Completed 500 Internal Server Error in 6ms
> 
> ActionView::Template::Error（部分名称 (/users/1) 不是有效的 Ruby 标识符；确保您的部分名称以字母或下划线开头，后跟字母、数字或下划线的任意组合。 ): 1: "<%= render user_path(@this_user) %>" app/views/users/index.js.erb:1:in index'`_app_views_users_index_js_erb__2145063269526192522_70203075823780'
> app/controllers/users_controller.rb:9:in`

看来它正在寻找部分；但是我只希望它执行与用户控制器上的“显示”操作关联的视图。所以一个全新的页面。

我究竟做错了什么？第一步是渲染一个全新的视图，但我计划在弄清楚这一点后在“显示”页面中渲染一个局部视图。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:00:53.840

查看 index.js.erb：

```
<%= render user_path(@this_user) %> 
```

那就是告诉 Rails 使用`user_path(@this_user)`.

您查看文件`index.js.erb`需要返回 JavaScript。因此，以下将起作用：

```
alert('The Id of this User Object is: <%= @this_user.id %>'); 
```

将来，您可以通过执行以下操作来呈现部分（包含 JavaScript 代码）：

`$("#popup").html("<%= escape_javascript(render(:partial => 'show_sold_out_popup') %>");`

# asp.net - 热敏打印机网络应用程序

> ID：12980478
> 
> 赞同：0
> 
> 时间：2012-10-19T18:41:46.453
> 
> 标签：asp.net, vb.net

我需要在我的热敏打印机上打印 Shippig 标签。我有一个使用 vb.net 的 Web 应用程序。有没有标准的解决方案？如果无法使用 Web 应用程序进行打印，那么我也可以迁移到 Windows 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T10:41:26.170

另一种选择是使用 java 小程序

jzebra 免费浏览器小程序，用于将原始命令发送到您的打印机 [http://code.google.com/p/jzebra/](http://code.google.com/p/jzebra/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:11:32.983

可能最简单的做法是让您的 Web 应用程序创建一个 pdf，然后将该 pdf 提供/返回给用户 - 然后用户可以使用标准打印对话框使用安装的驱动程序将您完美格式化的结果发送到打印机。

# android - 移轴图像处理效果

> ID：12980479
> 
> 赞同：4
> 
> 时间：2012-10-19T18:41:46.313
> 
> 标签：android, image-processing, graphics

我正在从事某些图像处理项目。

我需要像 Instagram 一样实现移轴效果。我已经使用 android.graphics 包（Bitmap、Canvas、Paint）实现了基本效果，如棕褐色、灰度、各种颜色效果和旋转。

我找到了一些用于模糊整个图像的代码，但我不知道如何定义将被聚焦的圆圈和将被模糊的补充区域。

如何使用 android.graphics 或其他第三方框架来实现它？有没有关于这个主题的文献？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:37:09.153

我从未见过使用圆圈进行模糊/聚焦的倾斜移位，通常称为选择性聚焦。倾斜移位通常沿垂直渐变模糊。为此，您只需将模糊的强度乘以

`pixelY / height`用于底部模糊

`(height - pixelY) / height`用于顶部模糊

或操纵基本公式以获得更多控制，例如：

`Math.abs(pixelY - (height / 2)) / (height / 2)`用于顶部/底部模糊的中心焦点

这是假设您的模糊代码具有强度变量。如果没有，它应该。

通常还有对比度/饱和度调整，但似乎你已经可以做这部分了，因为你列出了颜色效果。

对于一个很好的教程，它涵盖了对倾斜移位效果进行哪些调整，请参阅[此](http://www.tiltshiftphotography.net/tilt-shift-photography-photoshop-tutorial/#.UIGtJSGRyiI)。这是一个 Photoshop 教程，但你可以看到他们采取了哪些步骤。

# facebook - Facebook Open Graph Friend Array 结果有限

> ID：12980481
> 
> 赞同：0
> 
> 时间：2012-10-19T18:41:50.583
> 
> 标签：facebook, facebook-graph-api, pagination

我正在使用开放图形 api 检索一组用户朋友的 ID。

```
 $friends = $facebook->api('/me/friends?limit=2000');
 $friendsList = array();
            foreach ($friends as $key=>$value) 
            {
               foreach ($value as $fkey=>$fvalue) {

                   $friendsList[] = $fvalue[id];
               }

            } 
```

我遇到的问题是，无论我设置什么限制，对于拥有超过 500 个朋友的用户，我最多只能收到 500 个朋友 ID 值。我一直在阅读 Facebook 开发人员信息中的限制和分页，但没有运气。

关于我需要做什么来检索所有用户的朋友 ID 的任何想法？为什么数组中的最后一个值显示为“h”？所有其他值都是 id。

谢谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:20:27.757

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:24:13.440

如果您只需要 facebook id，那么您应该尝试仅使用 id 字段，它应该返回所有朋友的 id。有了这个，我记得我的应用程序已经处理了一个有 1500 个朋友的用户。

```
$friends = $facebook->api('/me/friends?fields=id'); 
```

# android - 尝试编程式 sqlite 数据库修复

> ID：12980482
> 
> 赞同：3
> 
> 时间：2012-10-19T18:41:58.013
> 
> 标签：android, sqlite

我发现当用户从手机中取出电池时，应用程序的数据库可能会损坏。这导致：

> I/Database(1217)：sqlite 返回：错误代码 = 14，msg = 无法在源代码行 25467 打开文件
> 
> E/Database(1217): sqlite3_open_v2("/data/data/com.myapp/databases/mydata.db", &handle, 6, NULL) 失败
> 
> W/dalvikvm(1217)：异常 Landroid/database/sqlite/SQLiteException；初始化 Lcom/myapp/database/SQLhelper 时抛出；
> 
> D/AndroidRuntime(1217)：关闭虚拟机
> 
> W/dalvikvm(1217): threadid=1: 线程以未捕获的异常退出 (group=0x40015560)

**前提**

我读到使用 .dump 可以恢复有用的数据。所以我采取了以下方法......

**执行**

```
final String strDBpath = Application.getContext().getDatabasePath(DB_NAME).getAbsolutePath();

final File fDBsrc = new File(strDBpath);
final File fDBtrgt = new File(strDBpath.replace(".db", "new.db"));

final String strExeCmd = "sqlite3 "+fDBsrc+" .dump | sqlite3 "+fDBtrgt;

boolean bSuccess = true;

try
{
    Log.i(TAG, "executing "+strExeCmd);
    Process process = Runtime.getRuntime().exec(strExeCmd);
    process.waitFor();
} catch (Exception er)
{
    bSuccess = false;
} 
```

**结果** 但是 - 列出 /data/data/com.myapp/databases 并没有显示新的数据库。

这是权限问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T14:39:55.847

.dump 状态的 sqlite 文档 (http://www.sqlite.org/sqlite.html)

使用“.dump”命令将数据库的全部内容转换为单个 ASCII 文本文件。这个文件可以通过管道返回到 sqlite3 来转换回数据库。

所以你需要管道回到 sqlite3 来恢复数据库

如果您需要在您的应用程序中执行此操作，您可以通过 Runtime().getRuntime().exec 调用来执行此操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T22:21:00.863

似乎避免数据库损坏的最佳方法是在数据库处于已知工作状态时对其进行定期快照。有一天，当数据库无法打开时，你会使用这种方法来恢复它......[备份和恢复 SQLite 数据库到 sdcard](https://stackoverflow.com/questions/2170031/backup-and-restore-sqlite-database-to-sdcard)

# php - 为什么我在使用 POST 方法发送值时一直收到 0（零）

> ID：12980483
> 
> 赞同：0
> 
> 时间：2012-10-19T18:42:00.630
> 
> 标签：php, javascript, post, http-post

我得到从 Javascript 发送的变量的 0（零）值

```
$query= "SELECT Name,Lastname FROM %s s, %s v, %s k WHERE s.FK_ID_user=%d AND s.Reg_id=%d AND s.Reg_id=k.Reg_id
     AND v.ID_user= s.FK_ID_user AND DATE(s.Time) BETWEEN '%d-%d-%d' AND '%d-%d-%d'";
$query = sprintf($query,$_SESSION['SESS_MAIN_BASE'],$_SESSION['SESS_USER_BASE'],$_SESSION['SESS_REG_BASE'],$id_user,$reg_id,$d_year1 ,$d_month1,$d_day1,$d_year2,$d_month2,$d_day2); 
```

来自 Javascript：

```
$.ajax({
                  type: 'POST',
                  url: 'history.php',
                  data: {
                  'id_user':$('#select-choice-user').val(),
                  'reg_id':$('#select-choice-reg').val(),
                  'd_year1':$('#select-choice-year1').val(),
                  'd_month1':   $('#select-choice-month1').val(),
                  'd_day1':$('#select-choice-day1').val(),
                  'd_year2':$('#select-choice-year2').val(),
                  'd_month2':   $('#select-choice-month2').val(),
                  'd_day2':$('#select-choice-day2').val()
                  },
                  success: function(data)//callback to be executed when the response has been received
                }); 
```

这是 PHP 部分：

```
$id_user= $_POST['id_user'];
$reg_id= $POST['reg_id'];
$d_year1=$POST['d_year1'];
$d_month1=$POST['d_month1'];
$d_day1=$POST['d_day1'];
$d_year2=$POST['d_year2'];
$d_month2=$POST['d_month2'];
$d_day2=$POST['d_day2']; 
```

问题是使用 POST 值发送的所有值都设置为 0，我可以在 post 方法中看到数据正常发送，值如下所示：

```
id_user:0010282658
reg_id:951
d_year1:2012
d_month1:05
d_day1:7
d_year2:2012
d_month2:10
d_day2:6 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T18:43:29.147

确保您从 $_POST 而不是 $POST 读取

# php - 使用 PHP 检测 mp3 开头的静音结束

> ID：12980487
> 
> 赞同：0
> 
> 时间：2012-10-19T18:42:14.860
> 
> 标签：php, mp3

我有一个脚本，用户上传自己的 MP3 并说明他们的名字。最终我想从 mp3 的开头修剪掉任何死气，这样当你点击播放时，它会立即以用户的声音开始。

**我的问题是**

*我如何获取 MP3 并检测使用 PHP 在录音中的哪个位置发出第一个声音。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:45:53.530

FFMPEG 可能会有所帮助，但不能 100% 确定。PHP 无法自行完成。

**FFMPEG 有两个部分：**

*   称为 FFMPEG 的服务器软件。
*   PHP 扩展名为 FFMPEG-PHP

您可能还需要适当的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-31T15:59:54.040

用 sox 做起来更容易，这里是链接： [http ://digitalcardboard.com/blog/2009/08/25/the-sox-of-silence/](http://digitalcardboard.com/blog/2009/08/25/the-sox-of-silence/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-16T10:53:13.620

*   检查 PHP 执行文档：[这里](http://php.net/manual/en/function.exec.php)
*   下载 sox：[这里](http://sourceforge.net/projects/sox/files/sox/)

运行这个

> sox inputfile.mp3 outputfile.mp3 静音 1 0.1 0.1% 反向静音 1 0.1 0.1% 反向

[来源](https://stackoverflow.com/questions/11834297/how-can-i-remove-silence-from-an-mp3-programmatically)

# python - 我如何在 ruby 中执行范围正则表达式，例如 awk /start/,/stop/

> ID：12980500
> 
> 赞同：4
> 
> 时间：2012-10-19T18:42:57.663
> 
> 标签：python, ruby, regex, awk

我想做一个像这样的 AWK 风格的范围正则表达式：

```
awk ' /hoststatus/,/\}/' file 
```

在 AWK 中，这将打印文件中两个模式之间的所有行：

```
hoststatus {
host_name=myhost
modified_attributes=0
check_command=check-host-alive
check_period=24x7
notification_period=workhours
check_interval=5.000000
retry_interval=1.000000
event_handler=
} 
```

我如何在 Ruby 中做到这一点？

奖励：你会如何在 Python 中做到这一点？

这在 AWK 中非常强大，但我是 Ruby 新手，不知道你会怎么做。在 Python 中，我也找不到解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T20:26:46.323

红宝石：

```
str =
"drdxrdx
hoststatus {
host_name=myhost
modified_attributes=0
check_command=check-host-alive
check_period=24x7
notification_period=workhours
check_interval=5.000000
retry_interval=1.000000
event_handler=
}"
str.each_line do |line|
  print line if line =~ /hoststatus/..line =~ /\}/
end 
```

这就是臭名昭著[的触发器](https://stackoverflow.com/questions/1111286/when-would-a-ruby-flip-flop-be-useful)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:55:48.150

使用 python 将 multiline 和 dotall 标志传递给 re. 这 ？跟随 * 使其不贪婪

```
>>> import re
>>> with open('test.x') as f:
...     print re.findall('^hoststatus.*?\n\}$', f.read(), re.DOTALL + re.MULTILINE) 
```

# c++ - 在 c++11 中检查运算符是否存在的最佳方法

> ID：12980508
> 
> 赞同：3
> 
> 时间：2012-10-19T18:43:46.543
> 
> 标签：c++, c++11, operators, typetraits

我需要检查给定的类是否`<<(cls, ostream)`定义了运算符。如果是这样，我希望我的函数使用它来写入`ostringstream`，否则应该使用样板代码。

我知道以前有人问过这个问题。但是，我通常会发现并不总是适用于我的编译器 (clang++) 的自定义解决方案。经过几个小时的搜索，我终于找到了 boost::type_traits。我以前没有看过那里，因为我认为 c++11 已经复制了 boost 所具有的特征部门的所有内容。

对我有用的解决方案是：

```
template <typename C>
std::string toString(C &instance) {
    std::ostringstream out;
    out << to_string<C, boost::has_left_shift<C, std::ostream>::value>::convert(ctx);
    return out.str();
} 
```

`to_string`定义为：

```
template <typename C, bool>
struct to_string {
    // will never get called
    static std::string convert(LuaContext &ctx) {}
};

template <typename C>
struct to_string<C, true> {
    static std::string convert(LuaContext &ctx) {
        return "convert(true) called.";
    }
};

template <typename C>
struct to_string<C, false> {
    static std::string convert(LuaContext &ctx) {
        return "convert(false) called.";
    }
}; 
```

所以我发布这个有两个原因：

1.  检查这是否是最明智的使用方法，或者看看其他人是否可以提出更好的解决方案（即，这个问题更多是出于对方法的好奇，而不是“这行得通吗？”——它已经对我有用了）

2.  发布此内容以节省其他人的搜索时间，以防她/他也需要做类似的事情。

3.  作为一个更普遍的问题——有时特征类似乎返回 std::true_type 或 std::false_type （嗯，至少对于非增强类）。其他时候它们是布尔值。这种差异有原因吗？如果`boost:has_left_shift`返回一个类型而不是一个`bool`，那么我可能只有一个`to_string`结构。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T20:54:02.157

又快又脏的 C++11 SFINAE：

```
template<typename T,
         typename = decltype(
           std::declval<std::ostream&>() << std::declval<T const&>()
         )
>
std::string toString(T const& t)
{
    std::ostringstream out;
    // Beware of no error checking here
    out << t;
    return out.str();
}

template<typename T,
         typename... Ignored
>
std::string toString(T const& t, Ignored const&..., ...)
{
    static_assert( sizeof...(Ignored) == 0
                 , "Incorrect usage: only one parameter allowed" );
    /* handle any which way here */
} 
```

如果您愿意，您还可以检查返回类型`stream << val`是否确实可以转换为`std::ostream&`：

```
template<typename T,
         typename Result = decltype(
           std::declval<std::ostream&>() << std::declval<T const&>()
         ),
         typename std::enable_if<
             std::is_convertible<Result, std::ostream&>::value,
             int
         >::type = 0
> 
```

至于不是那么快速和肮脏的解决方案，我将介绍一个`is_stream_insertable`特征，该实现可以利用这里使用的相同技巧。

请注意，`std::integral_constant<bool, B>`有一个转换运算符 to `bool`，这可能解释了您观察到的一些事情。我也不建议将 C++11 标准类型和特征与 Boost 混合：不要`std::true_type`与`boost::true_type`! 这并不是说您根本不应该在 C++11 中使用例如 Boost.TypeTraits，而是尽量保持一致，一次只使用两个中的一个。

# python - 日志中的自定义记录器类和正确的行号/函数名称

> ID：12980512
> 
> 赞同：14
> 
> 时间：2012-10-19T18:44:08.557
> 
> 标签：python, logging

我想将 Python 记录器包装在一个自定义类中，以嵌入一些特定于应用程序的功能，并对开发人员隐藏设置细节（设置文件输出、日志记录级别等）。为此，我使用以下 API 创建了一个类：

```
__init__(log_level, filename)
debug(msg)
info(msg)
warning(msg)
error(msg) 
```

Logger.debug/info/warning/etc 调用通常会在日志中写入进行日志调用的函数和行号。但是，使用我的自定义类，写入日志文件的函数和行号始终相同（对应于自定义类中的 debug()/info()/warning()/error() 函数）。我希望它保存记录 msg 的应用程序代码行。那可能吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-28T09:33:36.703

如果您愿意重新实现一点标准日志记录模块，则可以生成日志包装器。诀窍是编写自己的 findCaller() 方法，该方法知道在解释回溯时如何忽略日志记录包装器源文件。

在 logwrapper.py 中：

```
import logging
import os
import sys

from logging import *

# This code is mainly copied from the python logging module, with minor modifications

# _srcfile is used when walking the stack to check when we've got the first
# caller stack frame.
#
if hasattr(sys, 'frozen'): #support for py2exe
    _srcfile = "logging%s__init__%s" % (os.sep, __file__[-4:])
elif __file__[-4:].lower() in ['.pyc', '.pyo']:
    _srcfile = __file__[:-4] + '.py'
else:
    _srcfile = __file__
_srcfile = os.path.normcase(_srcfile)

class LogWrapper(object):
    def __init__(self, logger):
        self.logger = logger

    def debug(self, msg, *args, **kwargs):
        """
        Log 'msg % args' with severity 'DEBUG'.

        To pass exception information, use the keyword argument exc_info with
        a true value, e.g.

        logger.debug("Houston, we have a %s", "thorny problem", exc_info=1)
        """
        if self.logger.isEnabledFor(DEBUG):
            self._log(DEBUG, msg, args, **kwargs)

    def info(self, msg, *args, **kwargs):
        """
        Log 'msg % args' with severity 'INFO'.

        To pass exception information, use the keyword argument exc_info with
        a true value, e.g.

        logger.info("Houston, we have a %s", "interesting problem", exc_info=1)
        """
        if self.logger.isEnabledFor(INFO):
            self._log(INFO, msg, args, **kwargs)

    # Add other convenience methods

    def log(self, level, msg, *args, **kwargs):
        """
        Log 'msg % args' with the integer severity 'level'.

        To pass exception information, use the keyword argument exc_info with
        a true value, e.g.

        logger.log(level, "We have a %s", "mysterious problem", exc_info=1)
        """
        if not isinstance(level, int):
            if logging.raiseExceptions:
                raise TypeError("level must be an integer")
            else:
                return
        if self.logger.isEnabledFor(level):
            self._log(level, msg, args, **kwargs)

    def _log(self, level, msg, args, exc_info=None, extra=None):
        """
        Low-level logging routine which creates a LogRecord and then calls
        all the handlers of this logger to handle the record.
        """
        # Add wrapping functionality here.
        if _srcfile:
            #IronPython doesn't track Python frames, so findCaller throws an
            #exception on some versions of IronPython. We trap it here so that
            #IronPython can use logging.
            try:
                fn, lno, func = self.findCaller()
            except ValueError:
                fn, lno, func = "(unknown file)", 0, "(unknown function)"
        else:
            fn, lno, func = "(unknown file)", 0, "(unknown function)"
        if exc_info:
            if not isinstance(exc_info, tuple):
                exc_info = sys.exc_info()
        record = self.logger.makeRecord(
            self.logger.name, level, fn, lno, msg, args, exc_info, func, extra)
        self.logger.handle(record)

    def findCaller(self):
        """
        Find the stack frame of the caller so that we can note the source
        file name, line number and function name.
        """
        f = logging.currentframe()
        #On some versions of IronPython, currentframe() returns None if
        #IronPython isn't run with -X:Frames.
        if f is not None:
            f = f.f_back
        rv = "(unknown file)", 0, "(unknown function)"
        while hasattr(f, "f_code"):
            co = f.f_code
            filename = os.path.normcase(co.co_filename)
            if filename == _srcfile:
                f = f.f_back
                continue
            rv = (co.co_filename, f.f_lineno, co.co_name)
            break
        return rv 
```

以及一个使用它的例子：

```
import logging
from logwrapper import LogWrapper

logging.basicConfig(level=logging.DEBUG, format="%(asctime)s %(filename)s(%(lineno)d): "
                    "%(message)s")
logger = logging.getLogger()
lw = LogWrapper(logger)

lw.info('Wrapped well, this is interesting') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-11-09T12:21:56.277

基于@Will Ware 的回答。另一种选择是覆盖`findCaller`方法并使用自定义类作为默认记录器：

```
class MyLogger(logging.Logger):
    """
        Needs to produce correct line numbers
    """
    def findCaller(self):
        n_frames_upper = 2
        f = logging.currentframe()
        for _ in range(2 + n_frames_upper):  # <-- correct frame
            if f is not None:
                f = f.f_back
        rv = "(unknown file)", 0, "(unknown function)"
        while hasattr(f, "f_code"):
            co = f.f_code
            filename = os.path.normcase(co.co_filename)
            if filename == logging._srcfile:
                f = f.f_back
                continue
            rv = (co.co_filename, f.f_lineno, co.co_name)
            break
        return rv

logging.setLoggerClass(MyLogger)
logger = logging.getLogger('MyLogger')  # init MyLogger
logging.setLoggerClass(logging.Logger) # reset logger class to default 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T19:10:27.497

是的：`sys._getframe(NUM)`NUM 表示您要查找的当前功能之外的功能数量。返回的框架对象具有 和 之类的`f_lineno`属性`f_code.co_filename`。

[http://docs.python.org/library/sys.html#sys._getframe](http://docs.python.org/library/sys.html#sys._getframe)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-12-26T18:53:45.230

Try `stacklevel`，它计算从原始日志记录调用到记录器的`debug()`、`info()`等调用的调用次数。这是[日志](https://docs.python.org/3/library/logging.html)3.8 中的新功能：

> 第三个可选关键字参数是 stacklevel，默认为 1。如果大于 1，则在计算为日志事件创建的 LogRecord 中设置的行号和函数名称时，会跳过相应的堆栈帧数。这可用于记录助手，以便记录的函数名、文件名和行号不是助手函数/方法的信息，而是其调用者的信息。此参数的名称反映了警告模块中的等效名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-10T03:23:52.317

这是重写的又一次尝试`findCaller`。这使您可以基于每个函数自定义额外的堆栈帧深度。

```
import os
import logging
from contextlib import contextmanager

logging.basicConfig(
    format='%(asctime)-15s  %(levelname)s  %(filename)s:%(lineno)d  %(message)s',
    level=logging.INFO
)

@contextmanager
def logdelta(n, level=logging.DEBUG):
    _frame_stuff = [0, logging.Logger.findCaller]

    def findCaller(_):
        f = logging.currentframe()
        for _ in range(2 + _frame_stuff[0]):
            if f is not None:
                f = f.f_back
        rv = "(unknown file)", 0, "(unknown function)"
        while hasattr(f, "f_code"):
            co = f.f_code
            filename = os.path.normcase(co.co_filename)
            if filename == logging._srcfile:
                f = f.f_back
                continue
            rv = (co.co_filename, f.f_lineno, co.co_name)
            break
        return rv

    rootLogger = logging.getLogger()
    isEnabled = rootLogger.isEnabledFor(level)
    d = _frame_stuff[0]
    try:
        logging.Logger.findCaller = findCaller
        _frame_stuff[0] = d + n
        yield isEnabled
    except:
        raise
    finally:
        logging.Logger.findCaller = _frame_stuff[1]
        _frame_stuff[0] = d

def A(x):
    with logdelta(1):
        logging.info('A: ' + x)    # Don't log with this line number

def B(x):
    with logdelta(2):
        logging.info('A: ' + x)    # or with this line number

def C(x):
    B(x)                       # or this line number

A('hello')                     # Instead, log with THIS line number
C('hello')                     # or THIS line number``` 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-22T18:55:27.303

更改 lineno 和文件名的最佳位置（如果您真的想这样做）是在附加到记录器的过滤器中。这是一个概念验证。最后一行将记录一条带有文件名和最后一行行的自定义消息：

```
import logging
import inspect
from pathlib import Path

class up_stacked_logger:
    def __init__(self, logger, n):
        self.logger = logger

        calling_frame = inspect.stack()[n+1].frame
        trace = inspect.getframeinfo(calling_frame)  

        class UpStackFilter(logging.Filter):
            def filter(self, record):       
                record.lineno = trace.lineno
                record.pathname = trace.filename
                record.filename = Path(trace.filename).name
                return True

        self.f = UpStackFilter()

    def __enter__(self):
        self.logger.addFilter(self.f)
        return self.logger

    def __exit__(self, *args, **kwds):
        self.logger.removeFilter(self.f)

def my_cool_customized_log_function(logger, msg):  

    with up_stacked_logger(logger, n=1) as logger:
        logger.info(f'--> customize {msg}')

logging.basicConfig(level=logging.DEBUG, format="[%(name)s][%(levelname)s]  %(message)s (%(filename)s:%(lineno)d)")
logger = logging.getLogger('some.module.logger')  

my_cool_customized_log_function(logger, 'a message') 
```

# java - 使方法同步会确保它是线程安全的吗？

> ID：12980513
> 
> 赞同：0
> 
> 时间：2012-10-19T18:44:14.047
> 
> 标签：java, database, multithreading

我有一种方法，其中一些数据库插入操作正在使用休眠进行，我希望它们是线程安全的。该方法正在获取参数中的一些数据，并且有时可能会在同一时间点使用相同的数据进行两次调用。

由于性能下降，我无法锁定这些表。任何人都可以建议将方法设为同步将解决问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:46:40.100

同步一个方法将确保它一次只能被一个线程访问。如果此方法是您写入数据库的唯一方法，那么是的，这将阻止两个线程同时写入。但是，您仍然必须处理具有相同数据的多个插入操作的事实。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:50:13.760

您应该让 Hibernate 处理并发，这就是它的本意。不要假设 Hibernate 会锁定任何东西：它支持[乐观事务](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/transactions.html#transactions-optimistic)正是为了这个目的。从上面的链接引用：

> 与高并发和高可扩展性一致的唯一方法是带有版本控制的乐观并发控制。版本检查使用版本号或时间戳来检测冲突更新并防止丢失更新。Hibernate 提供了三种可能的方法来编写使用乐观并发的应用程序代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-20T19:17:41.657

数据库并发由事务处理。事务具有原子一致的隔离持久 (ACID) 属性。它们在同时访问数据库的程序之间提供隔离。在 Spring Framework 的 Hibernate DAO 模板中，有单行方法用于对数据库进行 CRUD 操作。当单独使用时，这些不需要通过方法同步。如果您需要将“您的方法”声明为具有特定传播设置、回滚设置、隔离设置的事务性，Spring 提供了声明式 (XML)、程序化和注释元数据驱动的事务管理。因此，在“您的方法”中，您可以进行多次保存、更新、删除等操作，并且 ORM 将确保使用您在元数据中提供的事务设置执行它。

另一个问题是线程必须锁定所有参与事务的对象。否则事务可能会失败，或者 ORM 将保留陈旧的数据。在另一种情况下，由于锁顺序，它可能导致死锁。我认为这才是真正回答你的问题。

对象 a 和 b 都有一个 Lock 类型的实例变量。布尔标志可用于指示事务的成功。如果失败，客户端代码可以重试相同的事务。

```
 if (a.lock.tryLock()) {
                try {
                    if (b.lock.tryLock()) {
                        try {
                            // persist or update object a and b
                        } finally {
                            b.lock.unlock();
                        }
                    }
                } finally {
                    a.lock.unlock();
                }
            } 
```

使用同步方法的问题在于它锁定了整个 Service 或 DAO 类，使其他服务方法对其他线程不可用。通过在对象上使用单独的锁，我们可以获得细粒度并发的优势。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T22:32:13.853

选择最佳策略取决于架构，有时为了提高性能似乎更容易使用方法同步之类的技巧，但这是一种不好的方法。

毫无疑问，您应该使用事务，如果使用该策略您遇到性能问题，您应该优化您的数据库查询或数据库结构。

请记住，“同步”应该尽可能是原子的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T19:04:47.367

否。此方法可能使用了其他方法和对象，它们可能不是线程安全的。`synchronized`使线程一次只能使用该方法的对象`monitor`一次，因此它使线程安全成为相对于该对象的方法。

如果您确定所有其他线程仅使用此方法使用共享功能，那么使用它`synchronized`可能就足够了。

# .htaccess - 谷歌将所有搜索结果重定向到我的主页

> ID：12980519
> 
> 赞同：-1
> 
> 时间：2012-10-19T18:44:40.210
> 
> 标签：.htaccess, redirect, indexing

我使用以下代码创建了一个 .htaccess 文件：

```
rewriteengine on
rewritecond %{HTTP_HOST} ^example.com$
rewriterule ^hie\/ "http\:\/\/www\.example\.com\/" [R=301,L] #5060c69211a2d
ErrorDocument 404 http://www.example.com/redirect.html 
```

出于某种原因，谷歌正在将我在搜索结果中出现的所有页面重定向到我的主页。

我不确定为什么会发生这种情况，bing 和 yahoo 搜索结果工作正常。我意识到谷歌将我的页面链接为“example.com/siding/example.html”而不是“www.example.com/siding/example.html”。

我不知道为什么，也不知道如何解决它。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T21:02:56.867

您可能希望将规则更改为：

```
rewriterule ^ http://www.example.com%{REQUEST_URI} [R=301,L] 
```

# java - 复制一个或多个文件形成一个 zip 文件，而无需使用 perl 或 java 实际解压缩

> ID：12980525
> 
> 赞同：1
> 
> 时间：2012-10-19T18:44:57.203
> 
> 标签：java, perl, zip, unzip

我有几个包含多个文件和文件夹的 zip 文件。它基本上包含文本文件。说扩展名“a”和“b”。

我想使用 perl 脚本或 java 代码将扩展“a”文件和扩展“b”文件分成单独的 zip 文件。

我可以选择内容并将其放入另一个压缩文件中，而不是解压缩文件。这甚至可能吗？任何帮助都会很棒。

我想知道这一点的原因是我有大量大尺寸的 zip 文件，所以如果可能的话，我的代码将非常有效。

无论是使用 perl 还是 java 的任何评论都将是一个奖励。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:03:26.350

您可以使用[Java ZipFile](http://docs.oracle.com/javase/7/docs/api/java/util/zip/ZipFile.html)类来读取 zip 文件的内容，遍历 zip 中的条目并获取相关条目的输入流。使用[ZipOutputStream](http://docs.oracle.com/javase/7/docs/api/java/util/zip/ZipOutputStream.html)可以直接将文件放入一个新的 zip 文件中——尽管它们之间是解压缩/压缩的。我不知道可以直接复制压缩内容的工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-20T10:45:36.307

这可以使用 Perl[`Archive::Zip`](https://metacpan.org/module/Archive%3a%3aZip)库来完成：

实际的 oneliner 可能如下所示：

```
perl -MArchive::Zip -e 'Archive::Zip->new("test.zip")->extractMember("testx.txt", "foo.txt");' 
```

但我想提供完整的代码，甚至包括一些检查：

```
use Archive::Zip;

my $zip = Archive::Zip->new("test.zip");
my $file_path = "test.txt";

my $PARANOID = 1;
if ($PARANOID) {
    my $file = $zip->memberNamed($file_path);
    unless ($file) {
        die "File '$file_path' not found in the archive";
    }
}

$zip->extractMember($file_path, "extracted_file.txt"); 
```

请注意，您需要`Archive::Zip`安装库：

```
cpan Archive::Zip 
```

或者，如果您对 Perl 生态系统更有信心并[`cpanm`](https://metacpan.org/module/cpanm)安装了闪亮的实用程序：

```
cpanm Archive::Zip 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-10T17:41:42.860

我刚刚发现 Unix 上的 zip 有一个 --copy 选项，可以将文件从一个存档复制到另一个存档。我不相信它会在此过程中解压缩文件，因此它应该正是您（和我）所需要的。

语法是：

```
$ zip source.zip "*.c" --copy --out destination.zip 
```

# css - 表单没有清除自己的默认值？

> ID：12980526
> 
> 赞同：0
> 
> 时间：2012-10-19T18:45:03.830
> 
> 标签：css, forms, html, default-value

*我注意到这是许多*网站上的常见问题，甚至是大公司的网站，所以作为一个申请工作的网络开发人员，我想，*我应该知道如何解决这个问题。*

基本上，例如，用户名字段会显示“用户名”，直到您单击它输入您的用户名，此时它应该清除文本“用户名”。但在大多数情况下，它不会，您最终会在该预先存在的文本中间输入。

我查了一下，发现最好的解决方案是一组 30 多行的 Javascript 函数，它完全符合您的期望：设置一个系统，当用户单击该字段时清除默认值，并且只要他们没有输入任何内容，当他们点击离开时也会把它放回去。

但这并不是我真正想要的，因为我已经知道该怎么做。

我觉得现在，对于 HTML5 和所有，应该有一个更简单的解决方法。而不仅仅是将 JavaScript 简化为更短的 jQuery 脚本。我的意思是更多的嵌入式，固有的修复。

有谁知道阻止这种现象发生的任何方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:47:18.680

只需使用 HTML5`placeholder attribute`

```
<input type="text" placeholder="Whatever" /> 
```

[**小提琴**](http://jsfiddle.net/4XPee/)

跨浏览器信息：某些 Firefox 版本会在单击文本框时清除占位符文本，Chrome 会在用户开始输入后将其清除，但更高版本的 Firefox 就像 chrome，它会在用户开始在输入框中输入时清除占位符文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:47:06.383

您可以使用 HTML5 占位符属性[http://www.w3schools.com/html5/att_input_placeholder.asp](http://www.w3schools.com/html5/att_input_placeholder.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T18:47:46.107

现代浏览器现在支持表单的占位符属性，它可以让你做你所要求的

查看 [http://webdesignerwall.com/tutorials/cross-browser-html5-placeholder-text](http://webdesignerwall.com/tutorials/cross-browser-html5-placeholder-text) 有关使用 modenizr 实现跨浏览器兼容性的文章

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T18:49:11.873

只需使用 HTML5 占位符属性。

```
<input type="text" placeholder="Username" /> 
```

这显然不会完全跨浏览器兼容，因此您仍然需要旧的 Javascript / jQuery 修复。

# javascript - js在nodeList中查找对象？

> ID：12980527
> 
> 赞同：19
> 
> 时间：2012-10-19T18:45:08.993
> 
> 标签：javascript, object, nodes

后备是无关紧要的。请不要图书馆。

我们有一个 dom 对象引用，我们将调用`obj`. 它实际上是一个 event.target。

我们有一个节点列表，我们将调用`nodes`它，它是通过 querySelectorAll 和一个变量选择器获得的。

`nodes`可能有 1 个或多个元素，并且每个元素都可能有子元素。

我们需要确定`obj`是那些节点元素之一，还是那些节点元素的子元素。我们在这里寻找“本机”浏览器功能，我们可以编写自己的`for`循环并完成此任务，我们正在寻找替代方案。

就像是：

`nodes.contains(obj)`或者`nodes.indexof(obj)`

涉及检索要匹配的节点列表的其他方法的解决方案是可以接受的，但我不知道那些可能是什么。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2020-01-25T04:13:20.797

如果 <=IE11 不是问题，那么我认为最干净的是使用[Array.from](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from)

```
Array.from(nodes).find(node => node.isEqualNode(nodeToFind)); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-10-09T13:19:56.140

我不确定这是否会搜索超出 NodeList 的第一级，但您可以递归地使用此表达式来遍历它并检查元素 'obj' 是否在 NodeList 'nodes' 中。

```
[].indexOf.call(nodes, obj) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-05-10T18:08:24.707

我做了这样的事情：

```
Array.prototype.find.call(style.childNodes, function(child) {
  if(child.textContent.includes(drawer.id)) {
    console.log(child);
  }
}); 
```

似乎工作。然后 child 是另一个 html 节点，您可以随意操作它。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-19T18:49:49.897

我认为没有内置的 DOM 方法。您需要递归遍历您的`NodeList`, 并检查与您的元素是否相等。另一种选择是[`Element.querySelectorAll`](https://developer.mozilla.org/en-US/docs/DOM/Element.querySelectorAll)在您的每个第一级元素上使用`NodeList`（例如，寻找元素的 id）。不过，我不确定（客栈）效率如何。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-07T14:14:10.513

除了多米尼克作为函数的回答：

```
function nodelist_contains (nodelist, obj)
{
  if (-1 < Array.from (nodelist).indexOf (obj))
    return true;

  return false;
} 
```

# facebook - iOS Facebook API 不会像 Tweeter 那样显示 iPhone 设置

> ID：12980528
> 
> 赞同：1
> 
> 时间：2012-10-19T18:45:09.503
> 
> 标签：facebook, ios6

我正在使用[DEFacebookComposeViewController](https://github.com/sakrist/FacebookSample)在 Facebook 中发布消息。使用 iOS5 时，用户被重定向到 facebook 页面进行登录，然后返回应用程序，效果很好。但是，在 iOS6 中，服务 API 显示一个 UIAlertView，显示选项“设置”或“取消”

![在此处输入图像描述](../Images/df827048ca3075d0cc7715f2a4aa1e4b.png)

问题是机器人按钮具有相同的效果。两者都取消了对话框（它也发生在 'FacebookSample' [here](https://github.com/sakrist/FacebookSample)中）。

另一方面，Tweeter 框架在 iOS 5 和 6 中都可以正常工作。如果没有配置高音扬声器帐户并且“设置”按钮将您带到“添加帐户”屏幕，则会出现警报。

欢迎所有想法。

谢谢

PD：所有测试在模拟器中的位置。

*编辑：*

这是我正在使用的代码：

```
DEFacebookComposeViewController *facebookComposer = [[DEFacebookComposeViewController alloc] init];
            [facebookComposer setInitialText:@"Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test Test"];

            __block id weakSelf = self;
            [facebookComposer setCompletionHandler:^(DEFacebookComposeViewControllerResult result) {
                [weakSelf dismissModalViewControllerAnimated:YES];
            }];

            [self presentModalViewController:facebookComposer animated:YES];
            [facebookComposer release]; 
```

这是`DEFacebookComposeViewController`课堂上的重要部分；

```
- (id)init
{
    if ([[UIDevice currentDevice].systemVersion floatValue] >= 6) {
        self = [(DEFacebookComposeViewController*)[SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook] retain];
        return self;
    }

    self = [super init];
    if (self) {
        [self facebookComposeViewControllerInit];
    }
    return self;
} 
```

那里。如果 iOS 版本是 6，则 init 方法返回`[SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook]`至极，这是与 facebook 交互的普通 iOS6 方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:57:54.123

在 iOS6 上，尤其是在 iOS6 上使用 Apple 官方提供的 Social framework 怎么样？

前任：

```
SLComposeViewController  *viewController
  = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook]; 

[self presentViewController:viewController animated:YES completion:nil]; 
```

# haskell - Haskell - 在 QuickCheck 的帮助下进行 Parsec 测试

> ID：12980529
> 
> 赞同：8
> 
> 时间：2012-10-19T18:45:09.963
> 
> 标签：haskell, parsec, quickcheck

我想为 Parsec 解析器编写一个测试。这是解析器和数据结构的示例：

```
data Event = Event { keyEvent :: String }
    deriving Show

parseKey :: Parser Event
parseKey = do
             char '<'
             k <- many1 (letter <|> digit <|> oneOf "_")
             char '>'
             return $ Event k 
```

我知道我需要检查`parse = parse . pretty . parse`财产。但是我应该如何生成*正确*和*不正确*的测试用例呢？[一般来说，我应该如何为给定的BNF](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form)生成测试用例？我知道`instance Arbitrary`，但对此没有太大帮助。

如果您为这个简单的解析器提供一个注释良好的生成器示例，我将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-19T20:39:57.900

测试解析器并不完全是微不足道的。（取决于事物的复杂性，与所有测试一样。）

您可以做的一件事是编写一个`Arbitrary`实例，该实例构造所有有效的表达式（或您尝试解析的任何表达式），然后检查您是否漂亮地打印该事物然后解析结果字符串，您会得到什么你开始了。

这样做有几个问题：

*   如果答案是错误的，那是什么坏了？解析器还是打印机？

*   如果你正在解析的东西足够复杂，以至于有可选的括号和东西，你需要检查它在有和没有可选括号的情况下是否有效。通常，您漂亮的打印机只会以一种或另一种方式做到这一点。

*   这不会检查垃圾输入是否确实被拒绝（并且不会被解析为奇怪的东西）。例如，我写了很多 Parsec 解析器，如果语法错误发生在输入的*末尾*，它们会默默地忽略它。

一般来说，我所知道的测试解析器的唯一真正*彻底*的方法就是手动编写大量的手动测试。（并且每次您发现解析错误的内容时，为其添加另一个测试用例。）例如，这基本上就是 GHC 对他们的测试套件所做的事情。

当然，这取决于您的解析器有多复杂，以及您想要多少保证……如果您只是解析 JSON，您可能可以相当轻松地对其进行测试。如果你正在解析 Markdown 之类的东西......我的上帝怜悯你的灵魂！

# jquery - 如何选择以前使用 :not 或 .not() 过滤的后代元素

> ID：12980531
> 
> 赞同：0
> 
> 时间：2012-10-19T18:45:18.930
> 
> 标签：jquery, jquery-selectors

猜测以下 HTML DOM 的正文片段：

```
...
<div class="entry">
    <div class="evil">
        <div class="some-other-class">
            <pre>My foo text</pre>
        </div>
    </div>
</div>
<div class="entry">
    <div class="nice">
        <pre>My nice text</pre>
    </div>
</div>
... 
```

使用 jQuery，我想选择所有`<pre>`属于 type 的父元素`div.entry`并且*不是 a 的后代*的元素`div.evil`。更准确地说：我只想将特定类应用于那些“非邪恶”`<pre>`元素。

在应用类之前，我使用了`:not`选择器过滤器以及`.not()`构建链以选择适当的子集和后代元素的方法，如下所示：

```
$("div.entry div:not(.evil) pre").addClass("pretty"); 
```

或者：

```
$("div.entry").not("div.evil").find("pre").addClass("pretty") 
```

这两种变体*都会匹配所有`pre`元素*，包括带有“邪恶”父 div 的元素！

但是，当我像这样选择直接父级和类时：

```
$("div.entry div:not(.some-other-class) > pre").addClass("pretty"); 
```

它按预期工作。首先，我以为我误解了使用`element1 element2`. 使用链式过滤器方法没有成功，但证明肯定有其他问题。

这个问题本身听起来并不难，但它现在让我发疯了。

如果以及为什么我的选择方式可能是错误的，有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:53:59.927

把事情简单化：

```
$('div.entry pre:not(div.evil pre)'); 
```

给你：[jsfiddle 演示](http://jsfiddle.net/jxvCG/)

**笔记**

所以为什么

```
$("div.entry div:not(.evil) pre"); 
```

不工作？

当你要求 时`div:not(.evil)`，jQuery 的人会返回你`div.some-other-class`以及`div.nice`，所以最终的选择器将是：

```
$("div.entry div.some-other-class pre, div.entry div.nice pre"); 
```

哪个匹配甚至`pre`哪个是坏的后裔，坏的，`div.evil`！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T18:49:45.510

我建议：

```
$('div.entry pre').filter(function(){
    return !$(this).closest('div.evil').length
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/YQarr/)。

对我来说，优点是您只需选择*所有* `pre`元素，然后根据（相当）简单的父评估减少这些元素。替代方法也同样有效，这只是……我个人的偏好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T18:49:58.087

您可以使用`:has`选择器：

```
$("div.entry:not(:has(.evil)) pre").addClass("pretty"); 
```

[http://jsfiddle.net/7BNQN/](http://jsfiddle.net/7BNQN/)

或者：

```
$('div.entry').not(':has(.evil)').find('pre').addClass("pretty"); 
```

# javascript - 如果第一次提交时出现错误，ASP.NET MVC4 将不会提交客户端验证

> ID：12980532
> 
> 赞同：2
> 
> 时间：2012-10-19T18:45:27.260
> 
> 标签：javascript, asp.net-mvc, razor, asp.net-mvc-4

我有一个简单的设置，但无法弄清楚为什么这不起作用。这是我设置的：

*   MVC4
*   启用 Html.EnableUnobtrusiveJavaScript() 和 Html.EnableClientValidation()
*   引用了 jQuery 1.6.2、jquery.validate.min.js 和 jquery.validate.unobtrusive.min.js
*   没有事件绑定到表单或按钮提交

问题是，它似乎在客户端工作，我可以在其中提交表单并显示适当的验证错误。但是，当我正确填写表单并点击提交时，它什么也不做，我之前的最后一条错误消息仍然显示。如果我返回并清除字段，验证似乎仍在工作（验证摘要已适当更新）。如果我第一次提交并正确输入了所有字段，它就可以正常工作。只有当我第一次出现错误时，它才能再次提交。

该模型仅在名字、姓氏和电子邮件中具有 [必需]。没有其他属性。此外，FormFieldFor 只是 EditorFor() 的包装器。

代码如下。有任何想法吗？谢谢。

```
@model AscendOne.CareOne.Mvc.Models.ResourceGuideUserModel

@*Form*@
<form id="guide-download-submit" method="get" action="/leads/" target="_blank">

    @{
        Html.EnableUnobtrusiveJavaScript();   
        Html.EnableClientValidation();
    }

    @Html.ValidationSummary()

    @if (Model.CampaignID != null)
    {<input type="hidden" name="CampaignID" value="@Model.CampaignID" />}
    @if (!String.IsNullOrWhiteSpace(Model.PDFUrl))
    {<input type="hidden" name="RedirectUrl" value="@Model.PDFUrl" />}

    <fieldset>
        @Html.FormFieldFor(m => m.FirstName)
        @Html.FormFieldFor(m => m.LastName)
        @Html.FormFieldFor(m => m.Email)
    </fieldset>

    <button type="submit">Download The Guide</button>

</form>

public class ResourceGuideUserModel
    {
        public string CampaignID { get; set; }
        public string PDFUrl { get; set; }

        [Required]
        [DisplayName("First Name:*")]
        public string FirstName { get; set; }

        [Required]
        [DisplayName("Last Name:*")]
        public string LastName { get; set; }

        [Required]
        [DisplayName("Email Address:*")]
        public string Email { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T12:27:58.977

好吧，事实证明这是我的错。感谢您的回复。似乎另一个深埋的脚本在第一次尝试后杀死了我的表单提交。删除它解决了这个问题。不过再次感谢。

# cuda - 缓存了多少 __constant__ 内存 (CUDA)

> ID：12980535
> 
> 赞同：1
> 
> 时间：2012-10-19T18:45:48.413
> 
> 标签：cuda

> **可能重复：**
> [为什么 CUDA 中的常量内存大小受到限制？](https://stackoverflow.com/questions/10256402/why-is-the-constant-memory-size-limited-in-cuda)

我知道`__constant__`内存有缓存，但我不清楚是否所有`__constant__`内存都被缓存了。

看起来好像`__constant__`数据不会直接进入缓存。文献：只有在被内核读取时才会进入缓存。这意味着缓存大小小于`__constant__`内存大小。我的猜测是`__constant__`mem 只是具有缓存支持的全局内存。（真的？）

如果我的 deviceProp.totalConstMem = 64KB。这是否意味着我有一个支持它的 64KB 缓存？这是 L1 还是 L2 缓存？这个缓存是否与 deviceProp.l2CacheSize 相关？

# google-app-engine - App Engine 和 Bigquery 身份验证

> ID：12980537
> 
> 赞同：4
> 
> 时间：2012-10-19T18:45:54.060
> 
> 标签：google-app-engine, google-bigquery, google-cloud-storage

我们希望借助 Bigquery 和 Cloud Storage 服务实现分析工具。该工具应在 App Engine 上运行并公开 REST 接口，以便所有请求都通过该接口并随后转发到 Bigquery。授权对 Bigquery 的访问应基于 App Engine 服务帐户（App Identity API）。但是，我们还需要对工具客户端进行身份验证。客户端始终是另一个应用程序或服务，因此 OAuth 2.0 和基于 Web 浏览器的身份验证对我们来说是不可接受的。有没有办法我们可以实现这种身份验证并以某种方式将其与 Bigquery 云存储 ACL 绑定？

考虑如下情况。我们域中的客户已获得 Google 帐户。它向我们的 REST 接口发送请求，并提供凭据（电子邮件和密码）以及其他详细信息。该工具对客户端进行身份验证并代表其向 Bigquery（或云存储）发送请求。如果客户端在没有正确权限（通过 Bigquery/Cloud Storage ACL 设置）的情况下尝试访问 Dataset（Bigquery）或 Bucket/Entity（Cloud Storage），则禁止访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T22:15:31.817

我认为我们都需要更多细节。您如何向客户颁发凭据？您是否希望客户端的操作员知道您域上的用户名/密码来验证客户端对您的服务的身份？

一种选择可能是向客户端颁发 OAuth 2.0 刷新令牌，然后他们将该刷新令牌（安全地）放入他们的应用程序配置中，或者您在他们下载应用程序时自动捆绑它。除非被撤销，否则刷新令牌无限期有效。

然后将 OAuth 2.0 刷新令牌直接通过应用引擎应用传递到 BigQuery/Google Cloud Storage。然后可以在 Cloud Storage/BigQuery 中本地处理所有 ACL（哪个客户端有权访问什么）。

您也可以让他们自己在 Web 浏览器中获取令牌，前提是他们有凭据。他们只需在设置应用程序时执行一次，令牌将由应用程序存储。有关将 OAuth 2.0 用于已安装应用程序的指南中的更多信息： [https ://developers.google.com/accounts/docs/OAuth2InstalledApp](https://developers.google.com/accounts/docs/OAuth2InstalledApp)

# php - preg_match_all 没有按预期工作

> ID：12980538
> 
> 赞同：1
> 
> 时间：2012-10-19T18:45:54.953
> 
> 标签：php, regex, html-parsing

我想根据以下正则表达式在网页上获取匹配项：(.*) 我在 regexpal.com（一个在线正则表达式测试工具）上对其进行了测试，它工作正常。但是，当我在 php 中使用它时，我找不到任何匹配项。我在 php 中使用的语句是

```
preg_match_all("/<a href=\"\/title\/.*\/\">(.*)<\/a>/", $content, $matches); 
```

我检查了 $content，它是正确的。那么我的陈述有什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T19:15:23.390

**拜托，拜托...看在上帝的份上，不要将处理 URL 或 HTML 的正则表达式包装在 / 中。**你必须到处逃避它。它是可怕的。看这里：

```
preg_match_all('~<a href="/title/[^">]+/">(.*?)</a>~si', $content, $matches); 
```

1.  **单引号**。不再需要转义双引号。当您没有可扩展的“{$variables}”时，为什么要使用双引号？
2.  **将 RegExp 包装到任何非保留字符**中。对于 URL 和 HTML / 是最糟糕的选择，因为它会拖你逃离冗余地狱。
3.  **在 HTML 中使用 'si' 作为标志**，因为标签可以是多行和 .+? 或者 。*？默认匹配多行。你需要不区分大小写。
4.  **避免使用 .+? 在属性中**。您可以捕获整个标签。也添加中断字符。见我上面的模式......所以如果 HTML 被破坏，你不要过度这样做。

*有更多方法可以改善这一点，但应该这样做。*

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:50:45.590

`?`您需要通过添加>>使您的正则表达式模式变得懒惰（非贪婪）

```
preg_match_all("/<a href=\"\/title\/.*?\/\">(.*?)<\/a>/", $content, $matches); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T18:47:38.150

```
preg_match_all("/<a href\=\"\/title\/.*\/\">(.*?)<\/a>/", $content, $matches); 
```

我会尝试：

```
preg_match_all('/<a href\=".title.*">(.*?)<\/a>/', $content, $matches); 
```

为简洁起见。

# python - 麻烦绘图功能

> ID：12980540
> 
> 赞同：-2
> 
> 时间：2012-10-19T18:46:02.457
> 
> 标签：python

我试图编写一个函数，然后绘制它。我是 python 新手，遇到了一些麻烦。我必须丢失信息，只是不确定在哪里。任何人都可以帮忙吗？

```
xv= arange(-4,5,1)  
def f(x):
    if (x<0):
        return log(x)
    elif (0<=x<2):
        return (-x)
    elif (2<x):
        return x**2/(3-x)

xv= arange(-4,5,1)
y1= log(x)
y2= (-x)
y3= x**2/3-x

fig1=figure()
plot(xv,y1,y2,y3)
show() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:01:00.630

也许您正在尝试执行以下操作：

```
import numpy as np
import matplotlib.pyplot as plt

x = np.arange(-4, 5, 1)
y = np.sin(x)

fig = plt.figure()
ax = fig.add_subplot(1, 1, 1)
ax.plot(x, y)
plt.show() 
```

在您的示例中，您似乎也在尝试采用`log(x)`? 如果是这种情况，请记住，在数学上，`log(x)`如果 是复数`x < 0`。

希望这可以帮助。

# ruby-on-rails - 如何在更远的关联中设置外键？

> ID：12980545
> 
> 赞同：0
> 
> 时间：2012-10-19T18:46:09.897
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个应用程序，其中 a`user`可以有很多`people`，可以有很多`projects`，可以有很多`invoices`。

在我的`invoice`控制器中，我有这个动作：

```
def create
  project = current_user.projects.find(params[:invoice][:project_id])    
  @invoice = project.invoices.build(params[:invoice])
  if @invoice.save
    flash[:success] = "Invoice created."
    redirect_to invoices_path
  else
    render :action => "new"
  end
end 
```

问题是只要没有`project_id`.

我明白这一点并尝试了这样的事情......

```
@invoice = current_user.people.projects.invoices.build(params[:invoice]) 
```

...但我得到一个`undefined method projects`错误。

我只是想确保一个新的`invoice`将自动与正确的关联，`user`并且没有人可以篡改它。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:39:19.117

这是一种实现您想要的方法。我在控制台中对此进行了测试，所以它应该可以工作。我搞砸了人/人的多元化，但你应该明白要点。我为模型提供了虚拟属性以进行测试。

```
class User < ActiveRecord::Base
  attr_accessible :name
  has_many :persons

class Person < ActiveRecord::Base
  attr_accessible :person_name, :user_id
  belongs_to :user
  has_many :projects
  has_many :people_invoices
  has_many :invoices, through: :people_invoices

class Project < ActiveRecord::Base
  attr_accessible :person_id, :project_name, :user_i
  belongs_to :person
  has_many :invoices

class PeopleInvoice < ActiveRecord::Base
  attr_accessible :invoice_id, :person_id
  belongs_to :person
  belongs_to :invoice

class Invoice < ActiveRecord::Base
  attr_accessible :invoice_amount, :person_id
  belongs_to :project
  has_many :people_invoice
  has_many :persons, through: :people_invoices 
```

我为每个模型提供了一些虚拟属性，您可以在上面的 attr_accessible 字段中看到这些属性。

在我的控制台中，我尝试了：

```
@user = User.new(name: "User")
@person = @user.persons.create(person_name: "Employee")
@project = @person.projects.create(project_name: "foo")
@invoice = @project.invoices.create(invoice_amount: 25)
@person_invoice = @person.people_invoices.create(invoice_id:1) 
```

以这种方式使用您的关联，然后您可以调用：

```
@user = User.find(4)
<User id: 4, name: "User", created_at: "2012-10-19 20:18:28", updated_at: "2012-10-19 20:18:28"> 
@user.persons
=> [#<Person id: 5, user_id: 4, person_name: "Employee", created_at: "2012-10-19 20:19:00", updated_at: "2012-10-19 20:19:00">]
@person.invoices
[#<Invoice id: 1, project_id: 2, invoice_amount: 25, created_at: "2012-10-19 19:33:10", updated_at: "2012-10-19 19:33:10">] 
```

由于关联，您应该能够找到与项目和人员相对应的发票，并将它们追溯到特定用户。由于关系是 has_many，因此您将获得返回给您的数组（注意最后两个控制台输出中的括号）。然后，您必须在一个块中循环浏览它们以查看或访问特定值。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-19T19:24:31.163

你应该使用`through`

```
class User < ActiveRecord::Base
    has_many :projects
    has_many :invoices, through: projects
end

class Invoice < ActiveRecord::Base
    has_many :projects
    has_one :user, through: projects
end

class Project < ActiveRecord::Base
    belongs_to :user
    belongs_to :invoice
end 
```

# mercurial - Mercurial 队列：多个队列共享补丁？

> ID：12980549
> 
> 赞同：0
> 
> 时间：2012-10-19T18:46:16.653
> 
> 标签：mercurial, mercurial-queue

我有一个带有两个补丁队列的本地仓库，`patches`并且`myproject`. 一种用于发布分支中的错误修复，一种用于单独项目的工作。

*   补丁：本地配置调试 bugfix1 bugfix2
*   我的项目：本地配置 myproject1 myproject2

我想要一个`local-config`由两个队列共享的补丁副本。一种可能的解决方案是将 patch-myproject/local-config 符号链接到 ../patches/local-config。

有没有更合适的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:59:25.013

我认为您不能轻松或安全地在队列之间共享补丁。您可以考虑使用一个队列并使用`guards`来说明在任何给定时间应该应用哪些补丁。

# java - 如何将多组原生类文件打包到一个 jar 中？

> ID：12980552
> 
> 赞同：2
> 
> 时间：2012-10-19T18:46:17.287
> 
> 标签：java

我有一些为多个平台（Windows、Linux、Mac）构建的外部 C 代码，并希望将它们全部打包在一个 .jar 中，以便无论平台如何，这个 .jar 都可以用作库。

这将允许我使用相同的单个外部库在计算机之间传递 Java 项目。

存在使用 JNI 调用代码的现有类文件，这些类在不同平台上有所不同。在当前状态下，我们用不同的类交换 jar，这些类调用该特定平台的本机函数。

有没有办法以这样的方式打包它们，以便我可以动态加载正确的类文件而无需使用 Ant/Maven 或创建抽象层？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-19T18:50:24.390

您不能将本机文件打包在 jar 中。然而，类文件可以像常规类文件一样。

如果需要，您可以将所有内容打包成一个 zip 文件吗？作为备选。

要加载正确的文件： Class.forName() 就足够了。虽然确保文件落入您的类路径，或[动态修改您的类路径以从 URL 搜索](https://stackoverflow.com/questions/252893/how-do-you-change-the-classpath-within-java)。

# linq - 使用 linq 时在 SQL Server 中自动递增

> ID：12980555
> 
> 赞同：0
> 
> 时间：2012-10-19T18:46:29.863
> 
> 标签：linq, sql-server-2008, auto-increment

我想更新我的数据库表中的三个字段/列。其中之一是主键“id”，我使用 Visual Studio 的设置列属性使其自动递增：

```
Identity Specification: Yes
(Is Identity)         : Yes
Identity Seed         :  1
Identity Increment    :  1 
```

一切正常，但在检查了 2 次后，我清空了表的内容，以便可以重新填充列。但是第一行自动增量列的值是 3。我删除了该行并再次尝试，但在行更新后它变成了 4。我不知道发生了什么。我想我的 linq 代码与它无关，因为它只是插入。

linq背后的代码：

```
//DLCountryies - .dbml filename
// tblcountry - tablename
// CountryName and CountryCode are Column names
//txtCountryName - textbox

using (DLCountryiesDataContext countries = new DLCountryiesDataContext()) 
{                                                                         
            tblcountry country = new tblcountry
            {
                CountryName = txtCountryName.Text.Trim(),
                CountryCode = txtCountryCode.Text.Trim()
            };

            countries.tblcountries.InsertOnSubmit(country);
            countries.SubmitChanges();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:48:32.860

您实际上看到了自动增量列的正确行为。标识值不是通过使用表中的当前值确定的。SQL Server 在别处跟踪标识值。

删除记录后，这些值不会重置。该列只是从最后一个值继续计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:49:07.777

这是正常的阅读`DBCC CHECKIDENT`。`BOL`

这将允许您重新设置主键：

[http://msdn.microsoft.com/en-us/library/ms176057.aspx](http://msdn.microsoft.com/en-us/library/ms176057.aspx)

来自 BOL：

`USE AdventureWorks2012;` `GO` `DBCC CHECKIDENT ("Person.AddressType", RESEED, 0);` `GO`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T11:04:02.980

这是自动增量的正常行为

如果你想重置自动增量种子，你可以这样做

1.  截断表格，
    例如。`TRUNCATE TABLE tblcountries`

2.  使用 DBCC CHECKIDENT
    例如。

    `DELETE FROM tblcountries`

    `DBCC CHECKIDENT('tblcountries',RESEED, 0)`

# java - 如何在...中播放音乐一次？

> ID：12980564
> 
> 赞同：2
> 
> 时间：2012-10-19T18:47:10.337
> 
> 标签：java, android, media-player, listitem

我在共享首选项中有一个想要的复选框：当复选框为真时，这首歌在`activity1`. 打开列表项时，刚刚开始`activity1`。在`activity1`我有一个检查 sharepreferences 并播放歌曲的课程，这样：

打开每个列表项时播放歌曲，打开每个列表项时播放多首歌曲。如何在此活动中只播放一首歌曲。

它要求每个列表项：

```
protected void All()
{
    boolean music = sharedpreferences.getBoolean("musictype", false);
    if (music) { mp1.start(); } else { mp1.stop();}      
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:46:47.177

```
public class Activity1 extends Activity {
    boolean hasPlayed;
    boolean shouldPlayMusic;

    public void onCreate(Bundle savedInstanceState) {
        hasPlayed = false;
        SharedPreferences prefs = PreferenceManager.getDefaultSharePreferences();
        shouldPlayMusic = prefs.getBoolean("musictype", false);
        //other initialization
    }

    protected void All() {
        if(shouldPlayMusic && !hasPlayed) {
            //Should check state of MediaPlayer too
            mp1.start();
            hasPlayed = true;
        }
    }
} 
```

基本上是这样的。保留您是否已经玩过一次的布尔标志，并在玩之前检查它以及偏好值。一旦你玩过它，设置标志，使其不再播放。

# c++ - 顶点/索引缓冲区与 OpenGL 3.3 混淆

> ID：12980570
> 
> 赞同：1
> 
> 时间：2012-10-19T18:47:31.147
> 
> 标签：c++, opengl-3

我正在尝试使用 OpenGL 3.3 渲染一个 3D 立方体。我的代码大致基于[OpenGL 书第 4 章的代码](http://openglbook.com/the-book/chapter-4-entering-the-third-dimension/)

这是我的代码：

```
// Attempt to make a cube in OpenGL 3.3, using GLEW and GLFW
#include <iostream>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <cmath>
// Include GLEW (openGL Extension Wrangler)
#define GLEW_STATIC
#include <GL/glew.h>
// Include GLFW (openGL FrameWork)
#include <GL/glfw.h>
// Define this helper macro to get an array position
#define BUFFER_OFFSET(i) ((char *)NULL + (i))

static const double PI = 3.14159265358979323846;

float radians(float inDeg)
{
    return inDeg * PI/180.0 ;
}

struct Vertex
{ // 64 bytes = 16 x 4 bytes per float
    GLfloat x, y, z ;         // position coordinates
    GLfloat nx, ny, nz ;      // normal coordinates
    GLfloat r, g, b, a ;      // color coordinates for vertex shading
    GLfloat s0, t0 ;          // s and t are the standard texture coordinates
    GLfloat s1, t1 ;          // (just used as padding)
    GLfloat s2, t2 ;          // (just used as padding)
} ;
// Vertex Attributes
GLuint      vertexSize       = sizeof( Vertex ) ;
GLuint      positionOffset   = 0 ;
GLuint      colorOffset      = 24 ;
// Vertex Data - stored dynamically, see BuildCube()
Vertex     *vertexData ;
GLuint     *indexData  ;
GLuint      vertexDataLength = 8  ;
GLuint      indexDataLength  = 36 ;

struct Matrix
{ // 64 bytes = 16 x 4 bytes per float
    GLfloat m[16] ;
} ;
// Matrix Data
Matrix      ModelMatrix ;
Matrix      ViewMatrix  ;
Matrix      ProjMatrix  ;

Matrix IdentityMatrix(void)
{   // set the diagonal values to one
    Matrix out ;
    out.m[0]  =  1.0 ; out.m[1]  =  0.0 ; out.m[2]  =  0.0 ; out.m[3]  =  0.0 ;
    out.m[4]  =  0.0 ; out.m[5]  =  1.0 ; out.m[6]  =  0.0 ; out.m[7]  =  0.0 ;
    out.m[8]  =  0.0 ; out.m[9]  =  0.0 ; out.m[10] =  1.0 ; out.m[11] =  0.0 ;
    out.m[12] =  0.0 ; out.m[13] =  0.0 ; out.m[14] =  0.0 ; out.m[15] =  1.0 ;
    return out ;
}

Matrix ZeroMatrix(void)
{   // set all values to zero
    Matrix out ;
    out.m[0]  =  0.0 ; out.m[1]  =  0.0 ; out.m[2]  =  0.0 ; out.m[3]  =  0.0 ;
    out.m[4]  =  0.0 ; out.m[5]  =  0.0 ; out.m[6]  =  0.0 ; out.m[7]  =  0.0 ;
    out.m[8]  =  0.0 ; out.m[9]  =  0.0 ; out.m[10] =  0.0 ; out.m[11] =  0.0 ;
    out.m[12] =  0.0 ; out.m[13] =  0.0 ; out.m[14] =  0.0 ; out.m[15] =  0.0 ;
    return out ;
}

Matrix Multiply(const Matrix *m1, const Matrix *m2)
{
    // Since these are note REALLY matrixes, we can get away with a shortcut
    Matrix out = IdentityMatrix() ;
    GLuint row, column, row_offset ;
    for (row = 0; row < 4; row++)
    {
        row_offset = row * 4 ;
        for (column = 0; column < 4; column++)
        {
            out.m[row_offset + column] =
            (m1->m[row_offset + 0] * m2->m[column + 0]) +
            (m1->m[row_offset + 1] * m2->m[column + 4]) +
            (m1->m[row_offset + 2] * m2->m[column + 8]) +
            (m1->m[row_offset + 3] * m2->m[column + 12]) ;
        }
    }
    return out ;
}

void Translate(Matrix &inMat, GLfloat dx, GLfloat dy, GLfloat dz)
{
    Matrix TM = IdentityMatrix() ;
    TM.m[3]  =  dx ;
    TM.m[7]  =  dy ;
    TM.m[11] =  dz ;
    inMat = Multiply(&inMat, &TM) ;
}

void Rotate(Matrix &inMat, GLfloat xAng, GLfloat yAng, GLfloat zAng)
{   // rotates a vector or point around the origin at the specified angles
    // create the half-angle values in radians
    GLfloat rad_x_ang = radians(xAng)/2.0 * -1.0 ;      // multiply by -1 to make the rotation right-handed
    GLfloat rad_y_ang = radians(yAng)/2.0        ;
    GLfloat rad_z_ang = radians(zAng)/2.0 ;      // multiply by -1 to make the rotation right-handed
    // compute sin and cos values, so they're not repeated a LOT
    GLfloat cosX = cos(rad_x_ang) ;
    GLfloat sinX = sin(rad_x_ang) ;
    GLfloat cosY = cos(rad_y_ang) ;
    GLfloat sinY = sin(rad_y_ang) ;
    GLfloat cosZ = cos(rad_z_ang) ;
    GLfloat sinZ = sin(rad_z_ang) ;
    // create quaternion vector: Q
    GLfloat q0 = cosZ * cosY * cosX + sinZ * sinY * sinX ;
    GLfloat q1 = sinZ * cosY * cosX - cosZ * sinY * sinX ;
    GLfloat q2 = cosZ * sinY * cosX + sinZ * cosY * sinX ;
    GLfloat q3 = cosZ * cosY * sinX - sinZ * sinY * cosX ;
    // create rotation matrix
    Matrix RM ;
    RM.m[0]  = q0*q0+q1*q1+q2*q2+q3*q3 ; RM.m[1]  = 0.0                     ; RM.m[2]  = 0.0                     ; RM.m[3]  = 0.0                     ;
    RM.m[4]  = 0.0                     ; RM.m[5]  = q0*q0-q1*q1-q2*q2+q3*q3 ; RM.m[6]  = 2*q2*q3 - 2*q0*q1       ; RM.m[7]  = 2*q1*q3 + 2*q0*q2       ;
    RM.m[8]  = 0.0                     ; RM.m[9]  = 2*q2*q3 + 2*q0*q1       ; RM.m[10] = q0*q0-q1*q1+q2*q2-q3*q3 ; RM.m[11] = 2*q1*q2 - 2*q0*q3       ;
    RM.m[12] = 0.0                     ; RM.m[13] = 2*q1*q3 - 2*q0*q2       ; RM.m[14] = 2*q1*q2 + 2*q0*q3       ; RM.m[15] = q0*q0+q1*q1-q2*q2-q3*q3 ;
    // multiply the new rotational matrix with the current incoming matrix
    inMat = Multiply(&inMat, &RM) ;
}

const GLchar* VertexShader =
{
    "#version 330\n"\
    "attribute vec3 in_Position;\n"\
    "attribute vec4 in_Color;\n"\
    "uniform   mat4 ModelMatrix;\n"\
    "uniform   mat4 ViewMatrix;\n"\
    "uniform   mat4 ProjMatrix ;\n"\
    "out       vec4 ex_Color;\n"\
    "void main(void)\n"\
    "{\n"\
    "   gl_Position = (ProjMatrix * ViewMatrix * ModelMatrix) * vec4(in_Position, 1.0);\n"\
    "   ex_Color    = in_Color;\n"\
    "}\n"
};

const GLchar* FragmentShader =
{
    "#version 330\n"\
    "in  vec4 ex_Color ;\n"\
    "out vec4 out_Color ;\n"\
    "void main(void)\n"\
    "{\n"\
    "   out_Color = ex_Color ;\n"\
    "}\n"
};

// Shader Attribute IDs
GLuint      attribute_in_Position ;
GLuint      attribute_in_Color ;
GLuint      uniform_ModelMatrix ;
GLuint      uniform_ViewMatrix ;
GLuint      uniform_ProjMatrix ;
// OpenGL Object IDs
GLuint      VertShaderID ;
GLuint      FragShaderID ;
GLuint      GLSLProgID ;
GLuint      vaoID ;
GLuint      vboID ;
GLuint      iboID ;

// Forward declare functions
void        BuildCube(void) ;
void        CreateShaders(void) ;
void        DestroyShaders(void) ;
void        InitStuff(void) ;
bool        DrawStuff(int) ;
void        KillStuff(void) ;

void BuildCube(void)
{
    vertexData = new Vertex[8] ;   // create a dynamic memory array of 8 vertices
    indexData  = new GLuint[36] ;
    // specify only 8 vertices (ignore texture and normals for now)
    vertexData[0].x  =  0.5 ; vertexData[0].y  =  0.5 ; vertexData[0].z  =  0.5 ;
    vertexData[1].x  = -0.5 ; vertexData[1].y  =  0.5 ; vertexData[1].z  =  0.5 ;
    vertexData[2].x  = -0.5 ; vertexData[2].y  = -0.5 ; vertexData[2].z  =  0.5 ;
    vertexData[3].x  =  0.5 ; vertexData[3].y  = -0.5 ; vertexData[3].z  =  0.5 ;
    vertexData[4].x  =  0.5 ; vertexData[4].y  =  0.5 ; vertexData[4].z  = -0.5 ;
    vertexData[5].x  = -0.5 ; vertexData[5].y  =  0.5 ; vertexData[5].z  = -0.5 ;
    vertexData[6].x  = -0.5 ; vertexData[6].y  = -0.5 ; vertexData[6].z  = -0.5 ;
    vertexData[7].x  =  0.5 ; vertexData[7].y  = -0.5 ; vertexData[7].z  = -0.5 ;
    // specify all triangles
    indexData[0]  = 0 ; indexData[1]  = 1 ; indexData[2]  = 2 ;  // top
    indexData[3]  = 2 ; indexData[4]  = 3 ; indexData[5]  = 0 ;
    indexData[6]  = 4 ; indexData[7]  = 6 ; indexData[8]  = 5 ;  // bottom
    indexData[9]  = 6 ; indexData[10] = 4 ; indexData[11] = 7 ;
    indexData[12] = 2 ; indexData[13] = 1 ; indexData[14] = 5 ;  // left
    indexData[15] = 5 ; indexData[16] = 6 ; indexData[17] = 2 ;
    indexData[18] = 0 ; indexData[19] = 3 ; indexData[20] = 4 ;  // right
    indexData[21] = 3 ; indexData[22] = 7 ; indexData[23] = 4 ;
    indexData[24] = 1 ; indexData[25] = 0 ; indexData[26] = 5 ;  // front
    indexData[27] = 0 ; indexData[28] = 4 ; indexData[29] = 5 ;
    indexData[30] = 3 ; indexData[31] = 2 ; indexData[32] = 6 ;  // back
    indexData[33] = 6 ; indexData[34] = 7 ; indexData[35] = 3 ;
    // specify the colors
    for (unsigned int ii = 0; ii < 8; ii++)
    {   //
        vertexData[ii].r =  vertexData[ii].x + 0.5 ;
        vertexData[ii].g =  vertexData[ii].y + 0.5 ;
        vertexData[ii].b =  vertexData[ii].z + 0.5 ;
        vertexData[ii].a =  1.0 ;
    }
    // end BuildCube()
}

void CreateShaders(void)
{
    GLenum ErrorCheckValue = glGetError();
    // establish vertex shader
    VertShaderID = glCreateShader(GL_VERTEX_SHADER);
    glShaderSource(VertShaderID, 1, &VertexShader, NULL);
    glCompileShader(VertShaderID);
    // establish fragment shader
    FragShaderID = glCreateShader(GL_FRAGMENT_SHADER);
    glShaderSource(FragShaderID, 1, &FragmentShader, NULL);
    glCompileShader(FragShaderID);
    // set the GLSL program ID
    GLSLProgID = glCreateProgram();
        // link the vertex and fragment shaders
        glAttachShader(GLSLProgID, VertShaderID);
        glAttachShader(GLSLProgID, FragShaderID);
    glLinkProgram(GLSLProgID);
    glUseProgram(GLSLProgID);
    // check for errors before continuing
    ErrorCheckValue = glGetError();
    if (ErrorCheckValue != GL_NO_ERROR)
    {
        fprintf(
            stderr,
            "ERROR: Could not create the shaders: %s \n",
            gluErrorString(ErrorCheckValue)
        );
        exit(-1);
    }
}

void DestroyShaders(void)
{
    if (!glfwGetWindowParam(GLFW_OPENED)) { return ; }
    GLenum ErrorCheckValue = glGetError();
    glUseProgram(0);
    glDetachShader(GLSLProgID, VertShaderID);
    glDetachShader(GLSLProgID, FragShaderID);
    glDeleteShader(FragShaderID);
    glDeleteShader(VertShaderID);
    glDeleteProgram(GLSLProgID);
    // check for errors last
    ErrorCheckValue = glGetError();
    if (ErrorCheckValue != GL_NO_ERROR)
    {
        fprintf(
            stderr,
            "ERROR: Could not destroy the shaders: %s \n",
            gluErrorString(ErrorCheckValue)
        ) ;
        exit(-1) ;
    }
}

void InitStuff(void)
{
    // Initialise GLFW extension
    if( !glfwInit() )
    {   // If the extension failed to initialize, then error out and leave.
        fprintf( stderr, "Failed to initialize GLFW\n" ) ;
        return ;
    }
    // Establish OpenGL version 3.3
    glfwOpenWindowHint(GLFW_FSAA_SAMPLES, 4);
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 3);
    glfwOpenWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE);
    glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_COMPAT_PROFILE);    // This compensates for the bug in GLEW
    // Open a window and create its OpenGL context
    if( !glfwOpenWindow( 512, 512, 0,0,0,0, 0,0, GLFW_WINDOW ) )
    {
        fprintf( stderr, "Failed to open GLFW window.\n" ) ;
        glfwTerminate() ;
        exit(-1) ;
    }
    // Initialize GLEW extension
    if (glewInit() != GLEW_OK)
    {
        fprintf(stderr, "Failed to initialize GLEW\n") ;
        exit(-1) ;
    }
    // Set the title on the upper left of the window
    glfwSetWindowTitle("Test Window") ;
    // Ensure we can capture the escape key being pressed below
    glfwEnable( GLFW_STICKY_KEYS ) ;
    // Clear Screen And Depth Buffer
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT) ;

    // Establish the matrixes
    int width, height ;
    glfwGetWindowSize( &width, &height );       // assess window size
    height = height > 0 ? height : 1;           // avoid div/0 error
    // calculate the projection matrix values
    GLfloat     fov_y          = 45.0 ;
    GLfloat     aspect_ratio   = (GLfloat) width / (GLfloat) height ;
    GLfloat     near_plane     = 1.0 ;
    GLfloat     far_plane      = 100.0 ;
    GLfloat     y_scale        = 1.0 / tan( radians(fov_y / 2.0) ) ;
    GLfloat     x_scale        = y_scale / aspect_ratio ;
    GLfloat     frustum_length = far_plane - near_plane ;
    ProjMatrix = ZeroMatrix() ;
    ProjMatrix.m[0]  =   x_scale ;
    ProjMatrix.m[5]  =   y_scale ;
    ProjMatrix.m[10] =  -((far_plane + near_plane) / frustum_length) ;
    ProjMatrix.m[11] =  -1.0 ;
    ProjMatrix.m[14] =  -((2.0 * near_plane * far_plane) / frustum_length) ;

    // Establish the model and view matrixes as identity matrixes
    ModelMatrix = IdentityMatrix() ;
    ViewMatrix = IdentityMatrix() ;

    Translate(ViewMatrix, 0.0, 0.0, -2.0) ;
    // Creat the error enumeration
    GLenum ErrorCheckValue = glGetError();

    // Create the vertex and fragment shaders
    CreateShaders() ;
    // Bind the vertex shader attributes to their IDs
    attribute_in_Position =  glGetAttribLocation(GLSLProgID, "in_Position") ;
    attribute_in_Color    =  glGetAttribLocation(GLSLProgID, "in_Color"   ) ;
    uniform_ModelMatrix   = glGetUniformLocation(GLSLProgID, "ModelMatrix") ;
    uniform_ViewMatrix    = glGetUniformLocation(GLSLProgID, "ViewMatrix" ) ;
    uniform_ProjMatrix    = glGetUniformLocation(GLSLProgID, "ProjMatrix" ) ;

    // upload the projection matrix data to the GPU
    glUniformMatrix4fv(uniform_ModelMatrix, 1, GL_TRUE, ModelMatrix.m);
    glUniformMatrix4fv(uniform_ViewMatrix , 1, GL_TRUE, ViewMatrix.m );
    glUniformMatrix4fv(uniform_ProjMatrix , 1, GL_TRUE, ProjMatrix.m );

    // Build the Cube Geometry
    BuildCube() ;

    // Initialize the Vertex Buffer Object in OpenGL
    glGenBuffers(1, &vboID);
    glBindBuffer(GL_ARRAY_BUFFER, vboID);
    glBufferData(GL_ARRAY_BUFFER, vertexSize * vertexDataLength, NULL, GL_STATIC_DRAW);
    glBufferSubData(GL_ARRAY_BUFFER, 0, vertexSize * vertexDataLength, vertexData);
    glBindBuffer(GL_ARRAY_BUFFER, 0);
    // Initialize the Index Buffer Object in OpenGL
    glGenBuffers(1, &iboID);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, iboID);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(GLuint) * indexDataLength, NULL, GL_STATIC_DRAW);
    glBufferSubData(GL_ELEMENT_ARRAY_BUFFER, 0, sizeof(GLuint) * indexDataLength, indexData);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);

    // Check for errors, then done
    ErrorCheckValue = glGetError() ;
    if (ErrorCheckValue != GL_NO_ERROR)
    {
        fprintf(
            stderr,
            "ERROR: Could not complete initialization: %s \n",
            gluErrorString(ErrorCheckValue)
        ) ;
        exit(-1) ;
    }
    // end InitStuff()
}

bool DrawStuff(int frame)
{
    int width, height ;
    glfwGetWindowSize( &width, &height ) ;   // First, re-assess the window size
    height = height > 0 ? height : 1 ;       // avoid div/0 error
    // for now, vary the background color so we know it's updating
    GLfloat phase_offset = 125.0f ;
    GLfloat speed_mult   = 0.01f ;
    GLfloat bgColorR = 0.5f * ( sin( (frame-0)*speed_mult ) + 1.0f );
    GLfloat bgColorG = 0.5f * ( sin( (frame-phase_offset)*speed_mult ) + 1.0f );
    GLfloat bgColorB = 0.5f * ( sin( (frame-2*phase_offset)*speed_mult ) + 1.0f );
    glClearColor( bgColorR, bgColorG, bgColorB, 0.0f );
    // Handle projection stuff
    glMatrixMode( GL_PROJECTION );
    glLoadIdentity();
    glViewport( 0, 0, width, height );
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    //
    GLenum ErrorCheckValue = glGetError();

    glEnable(GL_DEPTH_TEST) ;
    glDepthFunc(GL_LESS) ;
    glEnable(GL_CULL_FACE) ;
    glCullFace(GL_BACK) ;
    glFrontFace(GL_CCW) ;

    ErrorCheckValue = glGetError();
    if (ErrorCheckValue != GL_NO_ERROR)
    {
        fprintf(
            stderr,
            "ERROR: Could not set OpenGL culling options: %s \n",
            gluErrorString(ErrorCheckValue)
        ) ;
        exit(-1) ;
    }

    // switch to model view mode
    glMatrixMode( GL_MODELVIEW );
    glLoadIdentity();

    // Assume I have multiple VBOs, but streamline for only one for now
    glPushMatrix() ;

        // re-bind the VBO data into the buffer
        glBindBuffer(GL_ARRAY_BUFFER, vboID) ;
        glVertexAttribPointer(attribute_in_Color, 4, GL_FLOAT, GL_FALSE, vertexSize, BUFFER_OFFSET(colorOffset)) ;
        glEnableVertexAttribArray(attribute_in_Color) ;

        glBindBuffer(GL_ARRAY_BUFFER, vboID) ;
        glVertexAttribPointer(attribute_in_Position, 3, GL_FLOAT, GL_FALSE, vertexSize, BUFFER_OFFSET(positionOffset)) ;
        glEnableVertexAttribArray(attribute_in_Position) ;

        // bind the indexes of the vertices to the buffer
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, iboID) ;

        Rotate(ModelMatrix, 0.0, 0.0, 0.5) ;
        glUniformMatrix4fv(uniform_ModelMatrix, 1, GL_TRUE, ModelMatrix.m);

        ErrorCheckValue = glGetError();
        if (ErrorCheckValue != GL_NO_ERROR)
        {
            fprintf(
                stderr,
                "ERROR: Could not prep for draw: %s \n",
                gluErrorString(ErrorCheckValue)
            ) ;
            exit(-1) ;
        }

        glDrawArrays(GL_TRIANGLES, 0, indexDataLength);

        glDisableVertexAttribArray(attribute_in_Color) ;
        glDisableVertexAttribArray(attribute_in_Position) ;
        glBindBuffer(GL_ARRAY_BUFFER, 0) ;
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0) ;

    glPopMatrix();
    // lastly, swap buffers, then return the status
    glfwSwapBuffers();
    return !glfwGetKey(GLFW_KEY_ESC) && glfwGetWindowParam(GLFW_OPENED);
}

void KillStuff(void)
{
    DestroyShaders();
    glfwTerminate();
}

int main()
{
    int     frame = 0 ;
    bool    running = true;
    InitStuff() ;
    while(running)
    {
        frame++;
        running = DrawStuff(frame) ;
    }
    KillStuff() ;
    return 0;
} 
```

结果是大约 3 个部分形成的三角形并没有真正遵循正确的索引。我认为问题出在索引缓冲区中，但我真的可以使用一些帮助来理解我是否错误地使用了索引和顶点缓冲区。我对自己做错了什么感到困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:54:50.463

`glDrawArrays`不读取顶点索引，它只是从您的 GL_ARRAY_BUFFER 中按顺序绘制顶点。如果要使用索引缓冲区，则需要改为使用`glDrawElements`。

同样在未来，请尽量只发布相关的代码部分。如果您不确定某些内容是否相关，则在包含方面犯错，但如果不深入研究矩阵操作函数、着色器链接函数等，很难找到重要的东西。如果您发布简洁的内容，您将获得更好的答案代码。

# html - 无法在具有不同类的按钮中定义不同的 CSS 样式？

> ID：12980571
> 
> 赞同：-1
> 
> 时间：2012-10-19T18:47:35.107
> 
> 标签：html, css

我的网站中有 2 个不同的按钮，我希望它们看起来不同。我不知道如何让它工作。

现在，我的 CSS 代码是：

```
input.button{ } 
```

但是如果我有两个按钮并且我需要它们都具有不同的颜色，那么我这样做：

```
<input type=button class="button1">
<input type button class="button2"> 
```

我不知道如何将其链接到 CSS。我试过了，但什么也没发生：

```
input.button.button1{}
input.button.button2{} 
```

当然，我没有在大括号中添加任何内容，但我确实添加了它们，但它似乎不起作用。不过，如果我删除其中一个，然后也删除“.button1”，那么它们似乎工作正常。但是同样我不能为不同的按钮设置不同的属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T18:49:56.397

你要这个：

```
<input type="button" class="button button1" />
<input type="button" class="button button2" /> 
```

CSS

```
input.button { /* Shared styles here */ }
input.button1 { /* Button 1 specific styles here */ }
input.button2 { /* Button 2 specificstyles here */ } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:48:54.620

您只需要识别类。

```
.button1 { foreground-color: red; }
.button2 { foreground-color: green; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T18:49:07.413

你可以只使用

```
.button1{}

.button2{} 
```

干杯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T18:50:31.723

试试这个来定义你的 CSS 类：

`input .button1{...}` `input .button2{...}`

基本上，您可以根据标签名称、元素 ID 或类，或这三者的组合来定义 CSS。“按钮”在您的代码中没有位置，因为它只是输入标签的属性之一的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T18:52:32.313

对于这个标记：

```
<input type="button" class="button1" value="one">
<input type="button" class="button2" value="two"> 
```

这个 CSS 会产生不同的颜色：

```
input.button1 { color: red; }
input.button2 { color: blue;} 
```

请参阅此[JSFiddle](http://jsfiddle.net/KVJgf/)。

请务必清理 CSS 和 HTML 中的错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T18:53:15.377

这里有两点，首先你没有在你的 css 中准确定义你的按钮，要在 css 中定义一个类型，你可以这样做：

```
input[type="button"] 
```

其次你有一个html错误，这个：

```
<input type button class="button2"> 
```

应该是这样的：

一切都完成了，你的 css 看起来像：

```
input[type="button"].button1{}

input[type="button"].button2{} 
```

如果您不需要如此具体，您也可以这样做：

```
.button1 {}

.button2 {} 
```

# sql - 如何替换a之间的所有空格 和 标签

> ID：12980578
> 
> 赞同：2
> 
> 时间：2012-10-19T18:47:57.433
> 
> 标签：sql, sql-server-2008

我正在浏览大约 5000 条记录，并且需要将`<p> </p>`标签之间的所有空格替换为`&nbsp;`

这行得通吗？

我认为这适用于 SET replace()

```
SELECT *
FROM FMS.[AuditItem] ai
WHERE ai.[NotificationMessage] LIKE '%<p>% %</p>%' 
```

但是我仍然没有办法只选择段落标签之间的空格。正确的？有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T22:49:58.277

先来看看

字符串可以包含其中一些模式

```
 sometext<p>sometext</p>sometext
 sometext<p>sometext</p>
 <p>sometext</p>sometext
 <p>sometext</p>
 sometext</p>
 <p>sometext
 sometext 
```

如果你想降低风险，那么应该考虑以前的模式，这就是例子

```
 declare @mem table(id int identity(1,1), NotificationMessage varchar(80))

  insert into @mem(NotificationMessage)
  select 'that is some text initial<p> one two three four  </p> asdf asdf asdf'

  insert into @mem(NotificationMessage)
  select '<p> one two three four  </p> asdf asdf asdf'

  insert into @mem(NotificationMessage)
  select 'that is some text initial<p> one two three four  </p>'

  insert into @mem(NotificationMessage)
  select '<p> one two three four  </p>'

  insert into @mem(NotificationMessage)
  select 'one two three four  </p>'

  insert into @mem(NotificationMessage)
  select 'one two three four'

  select
  NotificationMessage,
  case 
  when CHARINDEX('<P>',NotificationMessage) > 1  then SUBSTRING(NotificationMessage,1,CHARINDEX('<P>',NotificationMessage)-1)
  else ''
  end as section1,

  REPLACE(SUBSTRING(NotificationMessage,                                                                                                    
                        case when CHARINDEX('<P>' , NotificationMessage) > 0 then
                                    CHARINDEX('<P>' , NotificationMessage) + 3
              else 1
                        end,                                                                                                    
                        case when CHARINDEX('</P>', NotificationMessage) > 0  then
                                    CHARINDEX('</P>' , NotificationMessage)
              else LEN(NotificationMessage) 
                        end 
                        -
                        case when CHARINDEX('<P>' , NotificationMessage) > 0 and CHARINDEX('</P>', NotificationMessage) > 0  then
                                    CHARINDEX('<P>' , NotificationMessage) + 3
              else 1 end) , ' '
   ,'&nbsp;') as section2,

  case 
  when CHARINDEX('</P>',NotificationMessage) > 1 then
   case when len(NotificationMessage) > (CHARINDEX('</P>',NotificationMessage) + 4)  then SUBSTRING(NotificationMessage,CHARINDEX('</P>',NotificationMessage)+4,  len(NotificationMessage) - CHARINDEX('</P>',NotificationMessage)+4 )
   else ''
   end
  else ''
  end as section3,

  case 
  when CHARINDEX('<P>',NotificationMessage) > 1  then SUBSTRING(NotificationMessage,1,CHARINDEX('<P>',NotificationMessage)-1)
  else ''
  end 
  +
  REPLACE(SUBSTRING(NotificationMessage,                                                                                                    
                        case when CHARINDEX('<P>' , NotificationMessage) > 0 then
                                    CHARINDEX('<P>' , NotificationMessage) + 3
              else 1
                        end,                                                                                                    
                        case when CHARINDEX('</P>', NotificationMessage) > 0  then
                                    CHARINDEX('</P>' , NotificationMessage)
              else LEN(NotificationMessage) 
                        end 
                        -
                        case when CHARINDEX('<P>' , NotificationMessage) > 0 and CHARINDEX('</P>', NotificationMessage) > 0  then
                                    CHARINDEX('<P>' , NotificationMessage) + 3
              else 1 end) , ' '
   ,'&nbsp;') 
  +
  case 
  when CHARINDEX('</P>',NotificationMessage) > 1 then
   case when len(NotificationMessage) > (CHARINDEX('</P>',NotificationMessage) + 4)  then SUBSTRING(NotificationMessage,CHARINDEX('</P>',NotificationMessage)+4,  len(NotificationMessage) - CHARINDEX('</P>',NotificationMessage)+4 )
   else ''
   end
  else ''
  end as newstring
  from @mem 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T21:13:10.337

如果列中有一组以上的 p 标签，那么这只会抓取第一个，其余的将被删除。如果没关系，那么这应该可以解决问题

```
UPDATE FMS.[AuditItem]
SET    [NotificationMessage] = REPLACE(SUBSTRING([NotificationMessage]
                                                  ,CHARINDEX('<P>' , [NotificationMessage]) + 3
                                                  ,CHARINDEX('</P>', [NotificationMessage]) - CHARINDEX('<P>', [NotificationMessage]) - 3)
                                       , ' '
                                       ,'&nbsp;')
WHERE  [NotificationMessage] LIKE '%<P>%' AND [NotificationMessage] LIKE '%</P>%' 
```

# php - 使用 PHP if 语句

> ID：12980581
> 
> 赞同：0
> 
> 时间：2012-10-19T18:48:08.697
> 
> 标签：php, html

我的网站上有一个功能，用户可以创建相册以更好地组织他们的照片。他们可以上传新照片，也可以从已上传的照片中进行选择。在我的 PHP 中，如果他们上传了任何新文件，我的代码会遍历他们上传的文件。它工作得很好，但我只希望它在他们实际上传新照片时工作。现在，即使他们选择了已经上传的旧照片，它也会运行。我正在使用 HTML5“multiple”属性，以便他们可以上传多张照片。在我的 PHP 中，如何编写条件 if 语句以仅在他们上传照片时运行此代码？

```
foreach ($_FILES['uploads']['name'] as $key => $file) {
   $time= time();
   $target= UPLOADPATH . $time . $file;
   move_uploaded_file($_FILES['uploads']['tmp_name'][$key], $target);
} 
```

我试过使用：

```
if ($_FILES['uploads']['size'] != 0)
if ($_FILES != 0)
if ($_FILES['upload']['name'] !=0) 
```

但是，到目前为止还没有成功。我能做些什么？我究竟做错了什么？

谢谢

**更新**

我最终将变量设置为 $_FILES 数组中第一个元素的值。

像这样：

```
$file_test= $_FILES['uploads']['size']['0']; 
```

然后我在测试条件下使用它：

```
($file_test != 0) { 
    // run the code;
} 
```

谢谢大家的帮助！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:58:17.230

我猜您将已经上传的照片存储在任何地方，然后您可以使用组合`getimagesize()`功能[（PHP手册）](http://php.net/manual/en/function.getimagesize.php)来检查上传的文件是否为图像。`md5_file()`然后使用该函数[（PHP 手册）](http://php.net/manual/en/function.md5-file.php)将上传文件的 MD5 哈希值与存储的文件进行比较。如果它们存储在数据库中，将每个文件的 MD5 直接存储在一个字段中可能会提高性能，因此您可以轻松地查询数据库以获取现有的 MD5 哈希。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:19:26.530

首先你必须使用这个函数重新排列你的 $_FILES 数组

```
function rearrange( $arr ){
        foreach($arr as $key => $items){
            foreach($items as $i => $val){
                $array[$i][$key] = $val;
            }
        }
        return $array;
}

$files = rearrange($_FILES['uploads']);

//Then do the foreach loop upload

if(!empty($files))
{

    foreach ($files as $file) {
     // Check the file size inside the foreach loop
     if($file['size'] > 0)
     {
       $time= time();
       $target= UPLOADPATH . $time . $file['name'];
       move_uploaded_file($file['tmp_name'], $target);
     }
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T18:52:20.780

```
if(!empty($_FILES)){
    // you've got files?!?!
} 
```

幸运的猜测在这里，真的不明白你的问题。

# ios - UILocationNotfication.fireDate 过去 - 错误？

> ID：12980584
> 
> 赞同：2
> 
> 时间：2012-10-19T18:48:26.197
> 
> 标签：ios, cocoa-touch, uilocalnotification

根据[Apple](http://developer.apple.com/library/ios/#documentation/iphone/Reference/UILocalNotification_Class/Reference/Reference.html)`UILocationNotification.fireDate`文档：

> 如果指定的值为 nil 或者是过去的日期，则立即发送通知。

使用过去的日期时，我没有看到这种行为。是只有我，还是其他人也看到了？

这是我的代码：

```
NSMutableArray *notifications = [NSMutableArray array];
UILocalNotification* alarm = [[UILocalNotification alloc] init];
alarm.fireDate = [NSDate dateWithTimeIntervalSince1970:time(NULL)-5];
alarm.repeatInterval = 0;
alarm.soundName = @"alarm.caf";
alarm.alertBody = @"Test";
alarm.alertAction = @"Launch";
NSMutableDictionary *userInfo = [[NSMutableDictionary alloc] init];
[userInfo setValue:[NSNumber numberWithInt:10] forKey:@"PsID"];
alarm.userInfo = userInfo;
notifications = [NSArray arrayWithObject:alarm];
UIApplication *app = [UIApplication sharedApplication];
app.scheduledLocalNotifications = notifications; 
```

如果我将 time(NULL)-5 更改为 time(NULL)+5，我会在此代码运行 5 秒后收到通知。使用 -5 值，我永远不会收到通知。

我知道这里的好问题需要有一个可能的明确答案，这可能会受到很多“我也是”答案的影响——**所以我正在寻找的是来自 Apple 的官方（引用/链接）说这是预期的行为，或者按照文档所说的那样工作的上述代码的不同版本。**

这对我的应用程序很重要，因为在某些情况下我需要通知用户警报，即使它发生在当天早些时候。我想我可以修改我的代码来检查当前时间并总是给出一个超出几秒的值——但我不确定“超出多少秒”是否真的安全，我希望它尽快发生——如果有更好的方法来获得“记录在案的行为”，也宁愿没有那个黑客。我的真实代码与上面类似，但我发布了几个通知，有些可能是过去的，有些可能是今天晚些时候，有些是明天及以后（这是用于日历应用程序）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T01:51:34.487

@eselk，

我看到与您相同的行为：如果通过在 UIApplication 对象上***设置******属性***`UILocalNotification`来安装它，那么过去具有**fireDate**的新创建的将不会触发。***`scheduledLocalNotifications`***

但是，如果使用 UIApplication 的方法`UILocalNotification`安装相同的对象，***它将***立即触发。`scheduleLocalNotification`

 *在我看来，这是一个基于[scheduleLocalNotifications 文档](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html)的错误，它非常清楚地指出：

> ...当您设置 [scheduledLocalNotifications] 属性时，UILocalNotification 通过调用 cancelLocalNotification: 然后为每个新通知调用 scheduleLocalNotification: 来替换所有现有通知。

鉴于情况似乎并非如此，如果您的应用程序逻辑需要将过去安排的通知呈现给用户，则解决方法是调用 scheduleLocalNotification。

```
UILocalNotification *ln = [[UILocalNotification alloc]init];
[ln setFireDate:[NSDate dateWithTimeIntervalSinceNow:-2]]; // two seconds ago
// ...

// the following line works as expected - the notification fires immediately
[application scheduleLocalNotification:ln];  // Using this line works as expected

// using the following does NOT work as expected - the notification does not fire
//application.scheduledLocalNotifications = [NSArray arrayWithObject:ln]; 
```

（我在 iOS 6 模拟器上测试过）*

# javascript - 嵌入可以通过参数动态更改的股票代码？

> ID：12980586
> 
> 赞同：1
> 
> 时间：2012-10-19T18:48:30.427
> 
> 标签：javascript, html, dynamic, embed, stock

我正在寻找类似[http://finance.yahoo.com/badges](http://finance.yahoo.com/badges)的内容来嵌入我的页面。问题是我希望能够通过使用一些 Javascript 来更改股票代码。有这样的吗？

最初，我尝试将 Google Finance 放在 iframe 中，但他们设置了 X-Frame-Options: SAMEORIGIN 所以我不能。

任何人都可以提出解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-13T15:18:31.093

我一直在寻找完全相同的东西，最终我找到了几乎完美的[简单 PHP Stock Ticker 和 Javascript Marquee 用于有效的 XHTML](http://techblog.shanock.com/articles/9/simple-php-stock-ticker-and-javascript-marquee-for-valid-xhtml) 你将不得不稍微调整它以使 php 工作取决于你的托管（我有一个问题与主机上正确的 .htaccess 文件一起出售），如果您使用任何类型的 cms，则必须在根目录中创建“stockcache”目录而不是任何其他类别，它可以完美运行，您可以选择任何你喜欢的符号

# android - 使用 AnimationDrawable 的 Android 图像动画不起作用

> ID：12980589
> 
> 赞同：2
> 
> 时间：2012-10-19T18:48:42.753
> 
> 标签：android, animation, android-animation

我正在从事一个项目，该项目涉及使用随机生成的图像序列对图像进行动画处理。这是我现在不工作的代码（或者至少它似乎不工作）：

```
/**
 * Method to display the current sequence
 * TODO make an animation for the screen to use
 */
public void displaySeq() {
    ad = new AnimationDrawable();
    int j = 0;
    for(Integer i : sequence) {
        switch(i)
        {
        case Constants.RED:
            System.out.printf("%d - RED\n", j);
            ad.addFrame(resources.getDrawable(R.drawable.red_circle), 500);
            break;
        case Constants.BLUE:
            System.out.printf("%d - BLUE\n", j);
            ad.addFrame(resources.getDrawable(R.drawable.blue_circle), 500);
            break;
        case Constants.GREEN:
            System.out.printf("%d - GREEN\n", j);
            ad.addFrame(resources.getDrawable(R.drawable.green_circle), 500);
            break;
        case Constants.YELLOW:
            System.out.printf("%d - YELLOW\n", j);
            ad.addFrame(resources.getDrawable(R.drawable.yellow_circle), 500);
            break;
        default:
            System.out.printf("%d - bad color: %d\n", j, i);
            ad.addFrame(resources.getDrawable(R.drawable.black_circle), 500);
        }
        j++;
    }
    // add a black circle to the end of the animation
    ad.addFrame(resources.getDrawable(R.drawable.black_circle), 500);
    System.out.println("Number of frames: " + ad.getNumberOfFrames());
    indicator.setBackground(ad);

    indicator.post(new Starter());

}

class Starter implements Runnable {
    @Override
    public void run() {
        ad.start();

    }

} 
```

当我运行应用程序并调用此方法时，我在 LogCat 中看到打印输出，但指示器没有动画。任何想法出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T12:03:51.170

我实际上发现了问题所在。这是由我的 XML 文件中的错误引起的。基本上，当我在 Eclipse 中创建 layout.xml 文件并添加 ImageView ( `indicator`) 时，Eclipse 将`android:src`参数设置为我选择的图像。更改`android:src`以`android:drawable`解决问题。

# c - qsort 似乎改变了值

> ID：12980590
> 
> 赞同：1
> 
> 时间：2012-10-19T18:48:48.710
> 
> 标签：c, qsort

我遇到了以下问题：

```
int sort_compare(const void *x, const void *y) {
    const int *xi = *(const int **) x;
    const int *yi = *(const int **) y;

    for (int i = 0; i < block_size; i++) {
        comp_x[i] = block[(*xi + i) % block_size];
        comp_y[i] = block[(*yi + i) % block_size];
    }

    return memcmp(comp_x, comp_y, block_size);
}

void sort() {
    for (int i = 0; i < block_size; i++) {
        printf("%d,", to_sort[i]);
    }
    puts("");
    qsort(to_sort, block_size, sizeof (int), sort_compare);
    for (int i = 0; i < block_size; i++) {
        printf("%d,", to_sort[i]);
    }
    puts("");
}

values:
    block_size = 5;
    block = "jkldj";
    comp_x, compy_y and to_sort are well allocated

output:
    0,1,2,3,4,
    3,0,1785357420,1,1684826986, 
```

to_sort 包含来自（圆形）字符串的第一个字母，例如

```
qwer
werq
erqw
rqwe 
```

, 表示为 (0,1,2,3) 需要排序为

```
erqw
rqwe
qwer
werq 
```

，表示为 (2,3,0,1)。我似乎得到了非常大的数字，这是为什么呢？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:13:56.577

传入比较器的`x`和是指向数组元素的指针。`y`您的数组元素是`int`s，因此要获取`int`值，您需要将`void`指针转换为`int`指针并取消引用。你的代码中有一个额外的间接层，它应该看起来像这样：

```
int xi = *(const int *) x;
int yi = *(const int *) y; 
```

然后在进行数据比较时直接使用`xi`and而不是and 。`yi``*xi``*yi`

作为一种优化，无需将数据复制到单独的数组中，然后再复制`memcmp`它们——您可以在循环中自己比较它们：

```
for (int i = 0; i < block_size; i++) {
    char data_x = block[(xi + i) % block_size];
    char data_y = block[(yi + i) % block_size];
    if (data_x != data_y)
        return data_x - data_y;
}

return 0; 
```

作为进一步的优化，如果您将`block`数组中的数据加倍（例如，使其具有`"qwerqwer"`而不是只是`"qwer"`），您可以在一次调用中进行比较`memcmp`，因为您不再需要处理环绕。 进行了高度优化，因此如果您有大量数据，使用手写的 for 循环`memcmp`会快得多。`memcmp`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:58:41.467

当你初始化

```
const int *xi = *(const int **) x;
const int *yi = *(const int **) y; 
```

元素的地址`to_sort`被解释为 a `const int**`，然后取消引用以给出`xi`and的值`yi`。这将（如果s 大于s `to_sort`，则可能超出）中的值解释为指针。`int*``int`

您应该只转换`void*`s：

```
const int *xi = (const int *) x;
const int *yi = (const int *) y; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:57:13.017

qsort() 通过给它一个 N 项的线性列表来唱歌，其中任何给定的 item(n) 地址都可以使用基于地址 + 每个“item”的大小来计算。所以从一些简单的东西开始，我所说的简单是指一个指针列表。

首先，可以通过简单地将副本拼接到原始缓冲区来模拟缓冲区的循环性（理想情况下少一个字符，但我不会对一个字节争论不休）。IE

```
"qwer" ==> "qwerqwer" 
```

这可以通过以下方式完成：

```
char *buff = malloc(2 * blocksize);
memcpy(buff, to_sort, blocksize);
memcpy(buff+blocksize, to_sort, blocksize); 
```

现在你有偏移量 0..(blocksize-1)，每个都是一个块大小的字符，可以在没有任何特殊指针数学的情况下相互比较。

接下来，构建要实际排序的指针列表，在这种情况下，

```
char** ptrs = malloc(sizeof(char*) * blocksize); 
for (i=0;i<blocksize;i++)
    ptrs[i] = buff+i; 
```

接下来，一个比较两个“项目”的函数。我们通过地址传递给我们的项目是指向字符串的指针。同样，过去左右的*地址是内存位置，我们将找到两个 char *。*地址本身*不是*char *：

```
int block_compare(const void *left, const void *right)
{
    // memcmp would work for most platforms, but not all, so...
    return strncmp(*(char **)left, *(char **)right, blocksize);
} 
```

最后，将其发送到 qsort() ，如下所示：

```
qsort(ptrs, blocksize, sizeof(char*), block_compare); 
```

最终输出将是一个块大小的指针列表，指向制造的循环缓冲区，每个指针都引用一个块大小的块。上述所有内容的全文如下：

```
#include <stdio.h>
#include <stdlib.h>
#include <memory.h>
#include <string.h>

size_t blocksize = 0;

int block_compare(const void *left, const void *right)
{
    // memcmp would work for most platforms, but not all, so...
    return strncmp(*(char **)left, *(char **)right, blocksize);
}

int main(int argc, char* argv[])
{
    char to_sort[] = "qwer";
    size_t i = 0;

    // set blockize
    blocksize = strlen(to_sort);

    char *buff = malloc(2 * blocksize);
    memcpy(buff, to_sort, blocksize);
    memcpy(buff+blocksize, to_sort, blocksize);

    char ** ptrs = malloc(blocksize * sizeof(char*));
    for (i=0;i<blocksize;++i)
        ptrs[i] = buff+i;

    // now send the pointer list to qsort()
    qsort(ptrs, blocksize, sizeof(*ptrs), block_compare);

    // ptrs is sorted. do with it what you will.
    for (i=0;i<blocksize;i++)
    {
        fwrite(ptrs[i], sizeof(char), blocksize, stdout);
        fwrite("\n", sizeof(char), 1, stdout);
    }
    fflush(stdout);

    free(ptrs);
    free(buff);

    return EXIT_SUCCESS;
} 
```

使用“qwer”会产生：

```
erqw
qwer
rqwe
werq 
```

另一个示例，使用“asubstantiallylongerstringtest”

```
allylongerstringtestasubstanti
antiallylongerstringtestasubst
asubstantiallylongerstringtest
bstantiallylongerstringtestasu
erstringtestasubstantiallylong
estasubstantiallylongerstringt
gerstringtestasubstantiallylon
gtestasubstantiallylongerstrin
iallylongerstringtestasubstant
ingtestasubstantiallylongerstr
llylongerstringtestasubstantia
longerstringtestasubstantially
lylongerstringtestasubstantial
ngerstringtestasubstantiallylo
ngtestasubstantiallylongerstri
ntiallylongerstringtestasubsta
ongerstringtestasubstantiallyl
ringtestasubstantiallylongerst
rstringtestasubstantiallylonge
stantiallylongerstringtestasub
stasubstantiallylongerstringte
stringtestasubstantiallylonger
substantiallylongerstringtesta
tantiallylongerstringtestasubs
tasubstantiallylongerstringtes
testasubstantiallylongerstring
tiallylongerstringtestasubstan
tringtestasubstantiallylongers
ubstantiallylongerstringtestas
ylongerstringtestasubstantiall 
```

伙计，我希望这就是你要找的。（哇）。

# 3dsmax - 不符合 CenterX/Y 的建筑物

> ID：12980600
> 
> 赞同：2
> 
> 时间：2012-10-19T18:49:25.117
> 
> 标签：3dsmax, ryzom

我一直在尝试使用[http://dev.ryzom.com/projects/ryzom/wiki/Adding_Buildings](http://dev.ryzom.com/projects/ryzom/wiki/Adding_Buildings)上的指南放置建筑物，但是我放置的建筑物无法移动 x/y 坐标仅区域有效，即88_BY 更改为 88_BZ 确实将建筑物移动了一个区域

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T04:18:19.167

问题是您不能在 3ds max 插件中使用对象引用，而是使用场景引用。

# facebook - 如何将 facebook 与我的 weebly 网站集成

> ID：12980602
> 
> 赞同：1
> 
> 时间：2012-10-19T18:49:32.923
> 
> 标签：facebook, login, registration

我有一个在 weebly 上开发的网站。我想将我的网站与 facebook 注册和登录集成，以便会员可以通过他们的 facebook 登录信息登录我的网站。Weebly 为我提供了一个自定义 html 的选项，通过它我可以获得代码以允许 facebook 登录到我的网站

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T05:37:36.710

Weebly 不为您提供对 PHP 的访问权限，您唯一的选择是 javascript，我已经为 weebly 网站编写了一个基于 js-sdk 的工作脚本，该脚本将允许用户通过 facebook 登录并自动填写注册用他们的 facebook 数据形成。

# google-maps-api-3 - 具有地标功能的 3D 模型

> ID：12980604
> 
> 赞同：0
> 
> 时间：2012-10-19T18:49:38.900
> 
> 标签：google-maps-api-3, google-api

我正在使用 Google API 和 Sketchup 开发交互式地图。我使用以下代码创建并放置了 3D 对象：

```
var loc = ge.createLocation('');
loc.setLatitude(lookAt.getLatitude());
loc.setLongitude(lookAt.getLongitude());
model.setLocation(loc);

// set up the model's link (must be a COLLADA file).
// this model was created in SketchUp
var link = ge.createLink('');
model.setLink(link);
link.setHref('http://earth-api-samples.googlecode.com/svn/trunk/' +
             'examples/static/splotchy_box.dae');

// create the model placemark and add it to Earth
var modelPlacemark = ge.createPlacemark('');
modelPlacemark.setGeometry(model);
ge.getFeatures().appendChild(modelPlacemark);

// zoom in on the model
lookAt.setRange(300);
lookAt.setTilt(80);
ge.getView().setAbstractView(lookAt);

// persist the placemark for other interactive samples
window.placemark = modelPlacemark; 
```

从这个示例网站：[http ://earth-api-samples.googlecode.com/svn/trunk/demos/interactive/index.html](http://earth-api-samples.googlecode.com/svn/trunk/demos/interactive/index.html)

我正在尝试将常规地标的选项添加到 3D 模型中（因此当鼠标悬停并且可点击时它会改变大小）。

我对 Google API 比较陌生，所以我想知道：如何将这些函数添加到 3D 对象？

我知道如何创建常规地标（来自同一网站），但我不知道如何将 3D 模型制作为地标。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T04:50:38.430

var placemark 是一个全局变量，这是创建一个 3D 模型来代替地标。试试这个代码，它对我有用。我在这里使用了谷歌地球插件。

```
 function createPlacemark() {
        console.log("in create placemark");
        placemark = ge.createPlacemark('');
        placemark.setName('placemark ' + counter);

        var model = ge.createModel('');
        ge.getFeatures().appendChild(placemark);
        var loc = ge.createLocation('');
        model.setLocation(loc);
        var link = ge.createLink('');

        // A textured model created in Sketchup and exported as Collada.
        link.setHref('https://sites.google.com/site/siddharthuit/downloads/crane.dae');
        model.setLink(link);

        var la = ge.getView().copyAsLookAt(ge.ALTITUDE_RELATIVE_TO_GROUND);

        // set location
        loc.setLatitude(la.getLatitude());
        loc.setLongitude(la.getLongitude());

        placemark.setGeometry(model);

        la.setRange(300);
        la.setTilt(45);
        ge.getView().setAbstractView(la);

    } 
```

我还有一个问题，你知道如何根据数据库动态给出的坐标移动地标吗？

# asp.net - 使用 subversion 管理代码部署

> ID：12980607
> 
> 赞同：0
> 
> 时间：2012-10-19T18:49:51.660
> 
> 标签：asp.net, asp.net-mvc, svn, version-control

我在一个集群中有 4 个 Web 服务器，它们都需要有相同的代码，并且将代码推送到每个服务器似乎是一项乏味的任务。我想知道使用颠覆来管理 asp.net 和 MVC 代码部署是好是坏。我的部署将从复制/粘贴文件到每台服务器到仅在每台服务器的 webroot 上进行 svn 更新。有什么好的理由说明这是一个坏主意吗？如果这是这个问题的错误地方，我深表歉意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:55:07.473

是的，您可以使用 SVN 使您的服务器保持最新。但是，我会更进一步并使用[持续集成](http://en.wikipedia.org/wiki/Continuous_Integration#Automate_deployment)。长话短说，您需要设置一个持续集成服务器，例如[CCNet](http://www.cruisecontrolnet.org/projects/ccnet/wiki)或[TeamCity](http://www.jetbrains.com/teamcity/)，它将自动执行您的构建和部署过程，以便您只需单击几下即可将更新发布到所有服务器。

# svn - Subversion - 不可预测的合并行为

> ID：12980609
> 
> 赞同：0
> 
> 时间：2012-10-19T18:49:56.653
> 
> 标签：svn, version-control, versioning

我正在将一些代码从我`<trunk>`的另一个分支合并到 SVN 中。

我第一次这样做是这样的：

```
cd /path-to-code/branches/branch_local
svn merge http://mydomain/svn/code/trunk 
```

我第一次尝试合并时，有几个冲突。事实证明，仅仅接受“他们的冲突”（TC）几次是不够的，因为合并后会出现构建失败。所以，我只是通过 恢复了我的工作副本`svn revert -R .`，并重新尝试了合并。不过，这一次没有检测到冲突，而且似乎 SVN 只是自动使用了“theirs-full”（TF）。这看起来很奇怪，所以我删除了我在本地合并的文件夹/文件，并通过更新我的工作副本`svn up`，同样的事情（他们的完整）再次发生。

我还注意到，当我推迟某些冲突，然后尝试第二次进行 SVN 合并时，第二次合并尝试不会记录冲突（它们似乎“卡在”推迟状态）。

我将如何强制 SVN 回到第 1 步，它会再次通知我冲突，而不是自动忽略它们并使用“theirs-full”来解决冲突？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T07:42:38.403

我考虑了2个版本：

1.  您应该`check out`再次进入另一个目录。
2.  你可以去根你的工作副本并做`svn cleanup`（就在之后`revert`）

我希望它对你有帮助。

# php - PHP SESSION 变量在我声明它之前就给自己赋值？

> ID：12980614
> 
> 赞同：0
> 
> 时间：2012-10-19T18:50:14.560
> 
> 标签：php

我的一个页面中有一个会话变量`$_SESSION['divcontent']`。

我有一个调用 ajax 函数的主页，该函数使用上述变量运行页面。

我有一个`if (!isset)`子句，只有在上述会话变量尚未设置时才应该触发。

然而它根本没有触发。所以我在这个文件的最开始放了一条回显语句来回显变量，它说它的值为0。

我没有在任何其他页面中引用此变量。我更改了 echo 语句以回显一个未在任何地方提及的不同变量，它返回了一个未找到变量的错误，正如它应该的那样。我正在 Dreamweaver 中以实时模式查看页面。每次我运行它时，会话变量都应该重置为未声明，不是吗？

为什么我的变量在值 = 0 时自实例化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:52:58.040

如果您离开任何站点，但浏览器仍处于打开状态（如果没有打开窗口但浏览器进程处于打开状态），仍然可以保持相同的会话。

我喜欢为测试会话变量做的一件事是以隐身模式打开 Chrome 并在那里尝试该站点。

# c++ - 根据属性选择 fstream 或 cout

> ID：12980615
> 
> 赞同：3
> 
> 时间：2012-10-19T18:50:15.603
> 
> 标签：c++, c++11, stream

如果有`argv[1]`我想把一些数据放到新的`ofstream(argv[1])`ie 文件中`argv[1]`。但是，如果没有这样的论点，我想`cout`改用。

我试过了

```
std::ostream& output = argc >= 1 ? std::fstream(argv[0]) : std::cout; 
```

但由于删除了构造函数，它甚至无法编译。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T18:57:18.770

您可以创建一个 fstream 实例并延迟打开它，直到需要。

```
std::fstream file;
if (argc > 1)
    file.open(argv[1]);

std::ostream& output = argc > 1 ? file : std::cout; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T19:42:18.653

这是一个真正的 C++11 解决方案：

```
ostream& out = [=]() -> ostream& {
    if (argc>1) {
        static fstream fs(argv[1]);
        return fs;
    }
    return cout;
}(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T18:57:59.100

~~您不能使用具有不同类型的三元运算符。编译器无法决定结果应该具有什么类型。~~

你可以试试

```
if (argc >= 1)
{
    std::fstream   Output(argv[0]);
    Process_data(Output);
}
else
    Process_data(std::cout); 
```

# jquery - JQUERY 推拉门效果 - 适用于 jsFiddle 但不适用于 chrome

> ID：12980619
> 
> 赞同：2
> 
> 时间：2012-10-19T18:50:42.777
> 
> 标签：jquery, css

我正在尝试使用 jquery 做一个滑动门效果。我已经在 jsFiddle 中模拟了它，它在那里工作正常。我遇到的问题是，当我在本地运行它时，没有任何效果。我已经下载并链接到本地​​的 jquery 库，我还有另一个项目，我什至链接到 API，它工作得很好。我不明白这里发生了什么，据我所知一切正常，但是当我点击链接时没有任何反应。

这是 jsfiddle [http://jsfiddle.net/aosto/kU9HY/的链接](http://jsfiddle.net/aosto/kU9HY/)

编辑：还发现我的代码似乎不起作用。我在关注[如何制作推拉门效果？](https://stackoverflow.com/questions/4207789/how-to-make-a-sliding-door-effect)，由 orbling 提供的方向。但我想我可能把 CSS 搞砸了。不知道如何最初隐藏其他人并使一个可见。任何帮助，将不胜感激。

```
<!doctype html>
<html>
<head>
<title>DBKustoms</title>
<link rel="stylesheet" href="./css/style.css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">    </script>
<script src="./js/include.js"></script>

</head>
<body>

<div id="menu-container">
    <div id="cover"></div>
    <div id="menu-home" class="menu"></div>
    <div id="menu-contact" class="menu">contact</div>
    <div id="menu-services" class="menu"></div>
    <div id="menu-photo" class="menu"></div>
</div>

<div id="buttons">
    <div id="home" class="menu-button">Home</div>
    <div id="contact" class="menu-button">Contact</div>
    <div id="services" class="menu-button">Services</div>
    <div id="photo" class="menu-button">Photo</div>
</div>

</body>
</html> 
```

CSS

```
#menu-container {
    float:left;
    width: 200px;
    height: 300px;
    clip: auto;
    overflow: hidden;
    position: relative;
    }

#cover    {
    width: 100%;
    height: 100%;
    position: absolute;
    top: -200px;
    background: black;
    z-index:1000;    
    }

#menu-home {
    width:100%;
    height:100%;
    background:blue;
    }

#menu-services {
    Height:100%;
    width:100%;
    background:purple;

    }

#menu-contact {
    Height:100%;
    width:100%;
    background:yellow;
    }

#menu-photo {
    Height:100%;
    width:100%;
    background:brown;

}

#buttons {
    float:left;
} 
```

和 JS

```
$('.menu-button').click(function() {
    var cMenuButton = $(this);
    var cMenuID = cMenuButton.attr('id');

    var coverHeight = $('#cover').height();
    var cVisibleMenu = $('.menu:visible');
    var cVisibleHeight = cVisibleMenu.height();

    $('#cover').animate({'height': coverHeight + cVisibleHeight}, 600, 'linear', function() {
        $('.menu').hide();
        $('#menu-' + cMenuID).show();

        var newMenuHeight = $('#menu-' + cMenuID).height();
        var coverHeight = $('#cover').height();

        $('#cover').animate({'height': coverHeight - newMenuHeight}, 600, 'linear');
    }); 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T18:52:45.310

确保将您的代码放在`document.ready`. 在您的 jsfiddle 左侧有一个下拉菜单，其中包含为您包装代码的 onDomReady 选项。在本地你没有，因此它适用于 jsfiddle。

```
$(function(){

  // code here
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:53:15.903

您需要包装 jquery 的东西，以便在 DOM 准备好后加载...

```
$(function(){
    // your js here
}) 
```

JSFiddle 正在为您做到这一点。The problem you encounter locally, is that the javascript runs before the document has loaded, so when the selector is selecting, there is nothing to select. 如果你在 DOM 准备好之后运行，那么它可以正常选择页面上的 HTML 元素。

# javascript - Require.js 单例到 TypeScript

> ID：12980620
> 
> 赞同：4
> 
> 时间：2012-10-19T18:50:44.870
> 
> 标签：javascript, singleton, requirejs, typescript

这是两个淡化的示例文件。这就是目前它们作为 requirejs 模块的工作方式。我在我的要求配置中填充了 api.js 以将导出定义为 API。目标是这些将保持为单例。我正在尝试将它们转换为 TypeScript 等价物，但无法完全弄清楚如何将它们保持为单例并将它们传递给我现在所做的各种模块。

**RequireJS 风格**

*api.js*

```
(function (global) {

    var API = global.API = {};
    API.version = '0.0.1';
    API.env = 'local';
    API.header = '';

} (this)); 
```

*auth.js*

```
define([
    'api',
], function (api) {
        'use strict';

        CommonAuth = {

            maxExpiredAuthorizationRetries: 1,

            getAuthorizationHeader: function () {
                return api.header;
            },

            setAuthorizationHeader: function (val) {
                api.header = val;
            }

        };

        return CommonAuth;

    }
); 
```

**TypeScript/AMD(requirejs) 风格**

到目前为止，我有以下内容，但这显然不是我所追求的。

*auth.ts*

```
// don't know how to fake this without creating a valid api module. requirejs shim is what handles my export
import api = module("api");

export module Common {

    class Auth {

        public maxExpiredAuthorizationRetries: number;

        constructor (maxExpiredAuthorizationRetries: number) {
            this.maxExpiredAuthorizationRetries = maxExpiredAuthorizationRetries;
        }

        public getAuthorizationHeader(): string {
            return api.header();
        }

        public setAuthorizationHeader(val: string): void {
            api.header(val);
        }
    }

    var auth = new Auth(1);
} 
```

编译为*auth.js* ( `tsc auth.ts --module amd`)

```
define(["require", "exports", "api"], function(require, exports, __api__) {
    var api = __api__;

    (function (Common) {
        var Auth = (function () {
            function Auth(maxExpiredAuthorizationRetries) {
                this.maxExpiredAuthorizationRetries = maxExpiredAuthorizationRetries;
            }
            Auth.prototype.getAuthorizationHeader = function () {
                return api.header();
            };
            Auth.prototype.setAuthorizationHeader = function (val) {
                api.header(val);
            };
            return Auth;
        })();        
        var auth = new Auth(1);
    })(exports.Common || (exports.Common = {}));

}) 
```

**更新：**除了接受的答案之外，您还可以直接导出所有成员：

```
export var maxExpiredAuthorizationRetries: number = 1;
export function getAuthorizationHeader(): string { ...
export function setAuthorizationHeader(val: string): string { 
```

然后`import api = module('api');`可以简单地通过说来使用`api.getAuthorizationHeader()`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T02:37:57.183

如果您正在寻找 Singleton，我会在类中使用静态成员。像这样的东西：

在 api.ts

```
class Api {
    static version:string = '0.0.1';
    static header:string = '';
}

export = Api 
```

在 auth.ts

```
import Api = module("api");

class Auth {

    //...

    public getAuthorizationHeader(): string {
        return Api.header;
    }

    public setAuthorizationHeader(val: string): void {
        Api.header = val;
    }
} 
```

# c# - 在 C# 中，为什么使用动态类型允许我在泛型上使用运算符？

> ID：12980622
> 
> 赞同：6
> 
> 时间：2012-10-19T18:50:44.563
> 
> 标签：c#, generics

在课堂上，我们一直在处理泛型，并被要求完成一项作业。

我们创建了一个`Account<T>`具有一个属性的类`private T _balance;`，然后必须编写 credit 和 debit 方法`_balance`。

`Credit method`（部分）从 Main 调用，例如`acc1.Credit(4.6);`：

```
 public void Credit(T credit)
    {
        Object creditObject = credit;
        Object balanceObject = _balance;

        Type creditType = creditObject.GetType();
        Type balanceType = balanceObject.GetType();

        if(creditType.Equals(balanceType))
        {
            if(creditType.Equals(typeof (double)))
            {
                 balanceObject= (double)balanceObject + (double)creditObject;
            }
       ...WITH more else if's on int,float and decimal.
        }
        _balance = (T)balanceObject;   
    } 
```

我不得不进行条件检查和强制转换，`_balance += (T)balanceObject;`因为这会给出错误`"Operator '+' cannot be applied to operand of type 'T'"`

在阅读该主题的过程中，我发现了这种`dynamic`类型。在我的新 Account 类中，我添加了一个新方法并将该`Credit`方法更改为：（由例如 Main 调用`acc1.Credit(4.6);`）

```
 public void Credit(dynamic credit)
    {
        _balance += ConvertType(credit);
    }
    public T ConvertType(object input)
    {
        return (T)Convert.ChangeType(input, typeof(T));
    } 
```

这是我不明白的。credit 方法将对象作为类型接收`dynamic`，`ConvertType(object input)`并将其作为类型返回`T`。为什么使用动态类型允许我在泛型上使用运算符？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T18:55:20.173

使用`dynamic`类型时，解析会延迟到运行时。如果在运行时泛型类型支持`+`运算符，则您的代码将起作用。如果没有，它会抛出异常。

来自[MSDN](http://msdn.microsoft.com/en-us/library/dd264736.aspx)文章`dynamic`：

> 在编译时，假定类型为动态的元素支持任何操作。

# alfresco - 无法使用 CMIS WORKBENCH 对 Alfresco 执行简单查询

> ID：12980624
> 
> 赞同：1
> 
> 时间：2012-10-19T18:50:57.197
> 
> 标签：alfresco, cmis, cmis-workbench

我正在尝试使用 CMIS WORKBENCH 对 Alfresco 执行这个简单的查询，但我遇到了一些错误：

```
SELECT * FROM cmis:document 
```

当我检查日志时，有很多异常。这些是（对我而言）相关的：

> Web 脚本 /alfresco/service/cmis/queries 响应状态为 500 - 内部错误。
> 
> 消息：09180065 包装异常（带有状态模板）：09185424 无法执行脚本'classpath *：alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js'：09185423
> 
> 异常：java.security.cert.CertificateExpiredException - NotAfter：Fri Aug 17 07:34:11 VET 2012 异常：java.security.cert.CertPathValidatorException - 时间戳检查失败异常：org.alfresco.repo.search.impl.lucene.LuceneQueryParserException - 09185423 异常：org.alfresco.scripts.ScriptException - 09185424 无法执行脚本'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js'：异常：org.springframework.extensions。 webscripts.WebScriptException - 09180065 包装异常（带有状态模板）：09185424 无法执行脚本'classpath *：alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js'：09185423

有谁知道这个例外是什么意思？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T12:26:16.263

这是来自 Alfresco 论坛的官方[帖子](https://forums.alfresco.com/en/viewtopic.php?f=45&t=45940)，与此问题有关。

它说默认 SSL 证书（随您的 Alfresco 提供）将于 2012 年 8 月 17 日到期 - 与日志文件中的异常相匹配：

```
Exception: java.security.cert.CertificateExpiredException - NotAfter: Fri Aug 17 07:34:11 VET 2012 
```

该帖子还链接到Alfresco Wiki 中的[一篇文章](http://wiki.alfresco.com/wiki/Alfresco_And_SOLR#Generating_new_SSL_certificates)，其中解释了为 SOLR（处理 CMIS 查询）生成新的 SSL 证书。

此错误是由 Alfresco 引起的，不应与 CMIS 相关。

**附加信息**

关于为 SOLR 创建自签名证书的[博客文章。](http://blogs.alfresco.com/wp/wabson/2012/08/31/creating-self-signed-ssl-certificates-for-solr/)

# vb.net - windows mobile 6.5 vs 6.0 数据网格不工作

> ID：12980626
> 
> 赞同：1
> 
> 时间：2012-10-19T18:51:10.270
> 
> 标签：vb.net, visual-studio-2005, compact-framework

当数据显示在 Windows Mobile 6.0 或 5.0 设备上时，可以控制数据网格列的宽度并且看起来很好。但是，在 Windows Mobile 6.5 设备上运行时，无法控制列宽。列的大小都相同，列中的数据被截断。

有没有人看到这种行为，如果有，你是如何纠正的。

程序是用VS2005编写的vb.net。

谢谢罗恩·贝拉迪尼斯

# php - 提交后如何在页面上保留回显和下拉菜单

> ID：12980630
> 
> 赞同：0
> 
> 时间：2012-10-19T18:51:33.860
> 
> 标签：php, mysqli

在我的主应用程序中，我希望出现以下布局：

1.  当应用程序打开时，它将显示“课程”文本输入和一个提交按钮以提交课程。（这工作正常）

2.  当用户输入课程并提交时，如果成功，它将在回声中显示课程的名称和 ID，并且在回声下方应显示“模块”下拉菜单和提交模块的提交按钮。（这可以）

3.  当用户提交模块时，应发生以下情况：

课程名称的回声应该保留（在用户提交模块后这会消失

提交模块后，模块下拉菜单应保留在页面上（此时消失

从下拉菜单提交模块时，如何获得上述要点。

```
<?php

     // connect to the database
 include('connect.php');

 /* check connection */
 if (mysqli_connect_errno()) {
printf("Connect failed: %s\n", mysqli_connect_error());
die();
}

 $courseid = (isset($_POST['courseid'])) ? $_POST['courseid'] : '';

?>

   <h1>DELETING AN ASSESSMENT</h1>

    <form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
     <p>Course ID: <input type="text" name="courseid" /><input id="courseSubmit" type="submit" value="Submit" name="submit" /></p>      
    </form>

    <?php
  if (isset($_POST['submit'])) {

    $query = "
             SELECT cm.CourseId, cm.ModuleId, 
             c.CourseName,
             m.ModuleName
             FROM Course c
             INNER JOIN Course_Module cm ON c.CourseId = cm.CourseId
             JOIN Module m ON cm.ModuleId = m.ModuleId
             WHERE
             (c.CourseId = ?)
             ORDER BY c.CourseName, m.ModuleId
            ";

$qrystmt=$mysqli->prepare($query);
// You only need to call bind_param once
$qrystmt->bind_param("s",$courseid);
// get result and assign variables (prefix with db)

$qrystmt->execute(); 

$qrystmt->bind_result($dbCourseId,$dbModuleId,$dbCourseName,$dbModuleName);

 $qrystmt->store_result();

$num = $qrystmt->num_rows();

if($num ==0){
    echo "<p>Sorry, No Course was found with this Course ID '$courseid'</p>";
} else { 

    $dataArray = array();

 while ( $qrystmt->fetch() ) { 
      // data array
      $dataArray[$dbCourseId]['CourseName'] = $dbCourseName; 
      $dataArray[$dbCourseId]['Modules'][$dbModuleId]['ModuleName'] = $dbModuleName; 
       // session data
      $_SESSION['idcourse'] = $dbCourseId;
      $_SESSION['namecourse'] = $dbCourseName;

}

 foreach ($dataArray as $courseId => $courseData) {

      $output = ""; 

      $output .= "<p><strong>Course:</strong> " . $courseId .  " - "  . $courseData['CourseName'] . "</p>";

   $moduleHTML = ""; 
   $moduleHTML .= '<select name="modulesDrop" id="modulesDrop">'.PHP_EOL;
   $moduleHTML .= '<option value="">Please Select</option>'.PHP_EOL;      
        foreach ($courseData['Modules'] as $moduleId => $moduleData) {        

        $moduleHTML .= "<option value='$moduleId'>" . $moduleId . " - " .   
    $moduleData['ModuleName'] ."</option>".PHP_EOL;        
  } 
        }
        $moduleHTML .= '</select>';

  echo $output;

    ?>

     <form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
     <p>Module: <?php echo $moduleHTML; ?><input id="moduleSubmit" type="submit" value="Submit" name="modulesubmit" /></p>      
    </form> 

    <?php
}
}

 if (isset($_POST['modulesubmit'])) {

 var_dump($_POST['modulesDrop']);

        $sessionquery = "
             SELECT SessionId, SessionDate, SessionTime, ModuleId
             FROM Session
             WHERE
             (ModuleId = ?)
             ORDER BY SessionDate, SessionTime 
            ";

$sessionqrystmt=$mysqli->prepare($sessionquery);
// You only need to call bind_param once
$sessionqrystmt->bind_param("s",$_POST['modulesDrop']);
// get result and assign variables (prefix with db)

$sessionqrystmt->execute(); 

$sessionqrystmt->bind_result($dbSessionId,$dbSessionDate,$dbSessionTime, $dbModuleId);

 $sessionqrystmt->store_result();

$sessionnum = $sessionqrystmt->num_rows();   

    $dataArraySession = array();

 while ( $sessionqrystmt->fetch() ) { 

 $dataArraySession[$dbSessionId]['SessionDate'] = $dbSessionDate; 
 $dataArraySession[$dbSessionId]['SessionTime'] = $dbSessionTime;

}

foreach ($dataArraySession as $sessionId => $sessionData) {

   $sessionHTML = ""; 
   $sessionHTML .= '<select name="session" id="sessionsDrop">'.PHP_EOL;
   $sessionHTML .= '<option value="">Please Select</option>'.PHP_EOL;           
   $sessionHTML .= "<option value='$sessionId'>" . $sessionId . " - " . $sessionData['SessionDate']. " - " . $sessionData['SessionTime'] ."</option>".PHP_EOL;        
   $sessionHTML .= '</select>';

        }

 if ($sessionnum > 0) {

 ?>

     <form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
     <p>Sessions: <?php echo $sessionHTML; ?><input id="sessionSubmit" type="submit" value="Submit" name="sesionsubmit" /></p>      
    </form>       

<?php

}

else {
 echo "<p>Sorry, You have No Sessions under this Module</p>";
}

}

    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:16:22.780

您的代码有几个问题。您遇到的问题是您没有将信息“$ courseid”从第 1 阶段传递到第 3 阶段。为此，只需将以下内容添加到第 2 阶段

```
<input type="hidden" name="courseid" value="<?=$courseid?>" /> 
```

# c# - FakeItEasy - 是否可以拦截一个方法并用我自己的实现替换它？

> ID：12980631
> 
> 赞同：7
> 
> 时间：2012-10-19T18:51:56.320
> 
> 标签：c#, unit-testing, mocking, fakeiteasy

我有以下界面：

```
public interface IOuputDestination
{
    void Write(String s);
} 
```

在我的单元测试中，我像这样模拟它：

```
var outputDestination = A.Fake<IOutputDestination>(); 
```

我想要做的是拦截 Write 方法，以便它使用我在测试中定义的自定义实现。像这样的东西：

```
String output = "";
A.CallTo(() => outputDestination.Write(A<String>.Ignored)).Action(s => output += s);
              //Is something like this even possible ? ----^ 
```

此处该`Action`方法不存在，但我希望将传入的任何参数`outputDestination.Write`重定向到我的自定义操作。这可以使用 FakeItEasy 吗？如果没有，是否有另一个允许这种行为的模拟框架？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T19:23:41.693

您可以通过以下方式获得该行为`Invokes`：

```
String output = "";
A.CallTo(() => outputDestination.Write(A<String>.Ignored))
    .Invokes((string s) => output += s); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T14:20:31.860

`outputDestination`一旦你创建了它，你并没有真正展示你是如何使用它的。你会把它注入到一些正在测试的方法中吗？如果是这样，那么如果不是创建一个假的，而是创建一个特制的类来实现`IOutputDestination`并包含您所需的实现`Write()`呢？

我想这将取决于你需要验证你的假货的其他行为（如果有的话）。没有更多的上下文很难知道。

# c# - C#如何将流复制到流写入器中

> ID：12980634
> 
> 赞同：3
> 
> 时间：2012-10-19T18:52:02.593
> 
> 标签：c#, stream, windows-phone

我想将 a `Stream`（包含图像）的内容复制到 a `StreamWriter`（我正在编写 webrequest 的地方），到目前为止我无法做到这一点。

我试过`imageStream.CopyTo(streamWriter);`了，但没用，因为它只能将它复制到另一个 Stream 而不是 StreamWriter。

我希望有人能帮助我！

**编辑：添加代码**

```
request.BeginGetRequestStream((requestResult =>
{
    Stream stream = request.EndGetRequestStream(requestResult);
    using (StreamWriter streamWriter = new StreamWriter(stream))
    {
        streamWriter.WriteLine(boundary);
        streamWriter.WriteLine("Content-Disposition: form-data; name=\"json\"");
        streamWriter.WriteLine("Content-Type: text/plain; charset=utf-8");
        streamWriter.WriteLine("Content-Transfer-Encoding: 8bit");

        streamWriter.WriteLine(json);

        streamWriter.WriteLine(boundary);
        streamWriter.WriteLine("Content-Disposition: form-data; name=\"image\"; filename=\"image.jpg\"");
        streamWriter.WriteLine("Content-Type: application/octet-stream");
        streamWriter.WriteLine("Content-Transfer-Encoding: binary");
        streamWriter.WriteLine("");

        streamWriter.Flush();

        image.CopyTo(streamWriter.BaseStream);
        // image.CopyTo(stream); // also not working

        streamWriter.WriteLine("");
        streamWriter.WriteLine(boundary);

        streamWriter.Close();
    }

    ExecuteRequest(this, request);

}), request); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:15:38.173

感谢@decyclone 我必须使用`streamWriter.BaseStream`并且重要的是在此之前使用 Stream.Flush() 否则它将以错误的顺序写入。

```
 request.BeginGetRequestStream((requestResult =>
        {
            using (StreamWriter streamWriter = new StreamWriter(request.EndGetRequestStream(requestResult)))
            {
                streamWriter.WriteLine(boundary);
                streamWriter.WriteLine("Content-Disposition: form-data; name=\"json\"");
                streamWriter.WriteLine("Content-Type: text/plain; charset=utf-8");
                streamWriter.WriteLine("Content-Transfer-Encoding: 8bit");

                streamWriter.WriteLine(json);

                streamWriter.WriteLine(boundary);
                streamWriter.WriteLine("Content-Disposition: form-data; name=\"image\"; filename=\"image.jpg\"");
                streamWriter.WriteLine("Content-Type: application/octet-stream");
                streamWriter.WriteLine("Content-Transfer-Encoding: binary");
                streamWriter.WriteLine("");

                streamWriter.Flush();

                streamWriter.CopyTo(stream.BaseStream);

                streamWriter.WriteLine("");
                streamWriter.WriteLine(boundary);

                streamWriter.Close();
            }

            ExecuteRequest(this, request);

        }), request); 
```

# wordpress - 301 重定向适用于隐藏的 index.php，但不适用于 .php

> ID：12980637
> 
> 赞同：1
> 
> 时间：2012-10-19T18:52:08.113
> 
> 标签：wordpress, .htaccess, http-status-code-301

我正在将客户从自定义开发的 PHP 站点转移到 Wordpress。我现在正在使用 .htaccess 文件中的 301 重定向将旧位置移动到 Wordpress 中的新位置。其中一些正在工作，而另一些则没有（这意味着它提供了“旧”位置）。我在文件中有标准的“漂亮的永久链接”mod_rewrite 部分，然后是所有 301。

因此，具有像目录一样列出的原始位置（重写 index.php）的那些可以工作，而具有明确命名的 php 文件的那些则不能。例子：

这有效：

```
Redirect 301 /about/ http://deanchiropractic.com/about-us/ 
```

这样做（仍然为 dr-jon.php 服务）：

```
Redirect 301 /about/dr-jon.php http://deanchiropractic.com/about-us/dr-jon-dean/ 
```

我尝试过更改顺序，尝试在 mod-rewrite 部分之前和之后使用 301，尝试使用和不使用 DirectoryIndex 行。我还验证了我正在编辑网络服务器根目录中的 .htaccess。

我宁愿让我的 .htaccess 工作，也不愿让 php 在所有未重定向的文件中执行 301 重定向（我已经尝试过，并验证了使用一个文件）。

以下是供参考的全部内容：

```
DirectoryIndex index.php index.html
Redirect 301 /about/dr-dean.php http://deanchiropractic.com/about-us/christophe-dean-dc/
Redirect 301 /about/dr-jon.php http://deanchiropractic.com/about-us/dr-jon-dean/
Redirect 301 /techniques/activator.php http://deanchiropractic.com/chiropractic-techniques/activator-method/
Redirect 301 /techniques/cox-technique.php http://deanchiropractic.com/chiropractic-techniques/cox-technique/
Redirect 301 /techniques/active-release.php http://deanchiropractic.com/chiropractic-techniques/active-release-technique/
Redirect 301 /community/dinner-talk.php http://deanchiropractic.com/get-healthy/
Redirect 301 /community/refer.php http://deanchiropractic.com/get-healthy/
Redirect 301 /resources/forms.php http://deanchiropractic.com/forms/
Redirect 301 /resources/faq.php http://deanchiropractic.com/faq/
Redirect 301 /resources/articles/low-back-pain-relief.php http://deanchiropractic.com/low-back-pain-relief/
Redirect 301 /resources/articles/about-the-activator-method.php http://deanchiropractic.com/achieve-wellness-with-the-activator-method/
Redirect 301 /resources/articles/spinal-disc-treatment.php http://deanchiropractic.com/spinal-disc-treatment/
Redirect 301 /resources/articles/headache-relief-benefits.php http://deanchiropractic.com/headache-relief/
Redirect 301 /resources/articles/carpal-tunnel-relief.php http://deanchiropractic.com/carpal-tunnel-relief/
Redirect 301 /resources/articles/neck-pain-relief.php http://deanchiropractic.com/neck-pain-relief/
Redirect 301 /testimonials.php http://deanchiropractic.com/reviews/
Redirect 301 /contact.php http://deanchiropractic.com/contact-us/
Redirect 301 /about/    http://deanchiropractic.com/about-us/
Redirect 301 /techniques/   http://deanchiropractic.com/chiropractic-techniques/
Redirect 301 /community/    http://deanchiropractic.com/get-healthy/
Redirect 301 /resources/    http://deanchiropractic.com/forms/
Redirect 301 /resources/articles/   http://deanchiropractic.com/category/articles/
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

我在这个网站上进行了广泛的搜索，但找不到与我的确切问题匹配的内容……尽管我在此过程中学到了很多关于 .htaccess 的知识（仍然是 n00b tho）。谢谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:44:00.177

mod_alias 和 mod_rewrite 可能会相互干扰，因为它们都应用于处理管道中的相同 URL。在这种情况下，可能是 URI 已更改，并且 mod_alias （通过`Redirect`指令）标记了重定向，但随后 mod_rewrite 做了它的事情并重写 URI 以通过 路由`index.php`，但 URI 被标记为重定向，所以在在管道的末尾，您有一个作为重定向发送的损坏的 URI。您可以通过仅使用 mod_rewrite 并使用`L`标志来避免这种情况，这样就不会应用 wordpress 规则：

```
RewriteEngine On
RewriteRule ^/?about/dr-dean.php http://deanchiropractic.com/about-us/christophe-dean-dc/ [L,R=301]
RewriteRule ^/?about/dr-jon.php http://deanchiropractic.com/about-us/dr-jon-dean/ [L,R=301]
RewriteRule ^/?techniques/activator.php http://deanchiropractic.com/chiropractic-techniques/activator-method/ [L,R=301] 
```

ETC...

# sql - 如何在 DB2 中执行复合 sql

> ID：12980639
> 
> 赞同：4
> 
> 时间：2012-10-19T18:52:13.423
> 
> 标签：sql, db2, zos, ibm-data-studio

我在尝试理解 DB2 sql 时面临挑战（注意，我来自 MS SQL Server）：P。

这是一个场景，我有 2 个表，一个有 ID 和其他详细信息，第二个有很多与每个 ID 对应的其他信息。

```
 ID              Info for ID
_______      ____> _______
|     |     /      |     |
|  T1 |<---------> |  T2 |
|_____|     \____> |_____| 
```

来自 SQL Server，我习惯于运行以下脚本：

```
Declare @ID  int
Declare @ID1 int

select @ID=ID from T1 where col1 = @ID1

select * from T2 where ID = @ID 
```

这一切都在那里运行良好，并为我提供了一个对应于 ID1 的 ID，该 ID 可进一步用于从 T2 获取有关 ID 的所有信息。

可悲的是，在 DB2 中，这在我面前爆炸了，如果我再执行一次这个查询，我很害怕，它会永远不认我 :(。

我做了一些研究并写了这个（我什至停留在变量声明中）。

```
--#SET TERMINATOR @
BEGIN ATOMIC
DECLARE UID char(30);
END @ 
```

对于其他人来说效果很好，但我收到以下错误：

```
BEGIN ATOMIC
DECLARE UID char(30);
END

ILLEGAL USE OF KEYWORD ATOMIC.  TOKEN  WAS EXPECTED. SQLCODE=-199, SQLSTATE=42601, DRIVER=3.63.108 
```

其他信息：

IBM DB2 for z/OS V9.1 IBM Data Studio V3.1.1.0

[编辑：使用 DECLARE] 我尝试过的另一件事不起作用：

```
CREATE VARIABLE UID CHAR(30) DEFAULT 'USERID'; 
select * from testdb2.T1 A WHERE A.UID=v_UID;
--some other activity goes here
--and here
DROP VARIABLE UID; 
```

TIA，阿比纳夫

* * *

2016 年 5 月 13 日（星期五 13 日）更新

创建存储过程是解决此问题的唯一方法:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-21T02:23:05.040

您的命令在 DB2 10 for LUW 中运行良好。数据工作室版本无关紧要，因为它在 CLP 中的工作方式相同。我在示例数据库中测试了这段代码：

```
BEGIN ATOMIC
 DECLARE UID char(30);
 SET UID = 200280;
 SELECT FIRSTNME, LASTNAME FROM ANDRES.EMPLOYEE WHERE EMPNO = UID;
END @ 
```

您使用的 z/OS 版本可能不支持内联 SQL（Begin atomic）。我不是 zOS DBA，而且我知道 LUW、iSeries 和 zOS 之间存在许多 SQL 差异。

请检查跨平台兼容性。这是一个很好的了解问题的博客：[https ://www.ibm.com/developerworks/mydeveloperworks/blogs/SQLTips4DB2LUW/entry/crossplatformsqlrefv4?lang=en](https://www.ibm.com/developerworks/mydeveloperworks/blogs/SQLTips4DB2LUW/entry/crossplatformsqlrefv4?lang=en)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T08:43:16.387

这是第一种情况的基本语法：

```
create variable id_var  integer;
create variable id_var1 integer;

set id_var = 100;

set id_var1 = (select id from t1 where id = id_var);

select * from t2 where id = id_var1; 
```

但是，在此示例中，您尝试使用变量作为列名：

```
CREATE VARIABLE UID CHAR(30) DEFAULT 'USERID'; 
select * from testdb2.T1 A WHERE A.UID=v_UID;
--some other activity goes here
--and here
DROP VARIABLE UID; 
```

不幸的是，您不能在 DB2 中做到这一点。这样做的唯一方法是构建[动态 sql 语句](http://pic.dhe.ibm.com/infocenter/db2luw/v9r7/index.jsp?topic=/com.ibm.db2.luw.sql.ref.doc/doc/r0000975.html)并执行它。这有点乱：您在字符串中创建一个 sql 命令，然后准备并执行它。`SELECT`并且在动态sql中直接使用也有限制。最好考虑另一种设计来解决您的问题，而不是沿着这条路线走。

# c# - 如何将其他工作表从 DataTable 添加到 Excel

> ID：12980640
> 
> 赞同：3
> 
> 时间：2012-10-19T18:52:18.317
> 
> 标签：c#, .net, excel, vsto

我正在尝试创建一个包含多个工作表的 Excel 报告。这些工作表中的每一个都包含来自 SQL 查询产生的 DataTable 的数据。初始工作表已正确创建，但是，我无法创建第二个工作表。我知道我做错了什么，但我只是不确定如何使用下面的代码添加工作表而不创建新的 Excel 工作簿。

我正在考虑只创建工作簿，然后只添加工作表。但我似乎无法让它全部点击。

这就是我正在尝试的：

```
static void Main(string[] args)
{
        Excel_FromDataTable(testingTable);
        Excel_FromDataTable(testingTable);
    }
}

private static void Excel_FromDataTable(DataTable dt)
{
    var excel = new Microsoft.Office.Interop.Excel.Application();
    var workbook = excel.Workbooks.Add(true);

    int iCol = 0;
    foreach (DataColumn c in dt.Columns)
    {
        iCol++;
        excel.Cells[1, iCol] = c.ColumnName;
    }

    int iRow = 0;
    foreach (DataRow r in dt.Rows)
    {
        iRow++;
        // add each row's cell data...
        iCol = 0;
        foreach (DataColumn c in dt.Columns)
        {
            iCol++;
            excel.Cells[iRow + 1, iCol] = r[c.ColumnName];
        }
    }
    // Global missing reference for objects we are not defining...
    object missing = System.Reflection.Missing.Value;
    // If wanting to Save the workbook...
    workbook.SaveAs(@"C:\MyExcelWorkBook2.xlsx");
    workbook.Close();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:00:22.783

考虑这个

```
Static void Main()
{

    var excel = new Microsoft.Office.Interop.Excel.Application();
    var workbook = excel.Workbooks.Add(true);

    AddExcelSheet(dt1, workbook);
    AddExcelSheet(dt2, workbook);

    workbook.SaveAs(@"C:\MyExcelWorkBook2.xlsx");
    workbook.Close();

}

private static void AddExcelSheet(DataTable dt, Workbook wb)
{    
    Excel.Sheets sheets = wb.Sheets;
    Excel.Worksheet newSheet = sheets.Add();
    int iCol = 0;
    foreach (DataColumn c in dt.Columns)
    {
        iCol++;
        newSheet.Cells[1, iCol] = c.ColumnName;
    }

    int iRow = 0;
    foreach (DataRow r in dt.Rows)
    {
        iRow++;
        // add each row's cell data...
        iCol = 0;
        foreach (DataColumn c in dt.Columns)
        {
            iCol++;
            newSheet.Cells[iRow + 1, iCol] = r[c.ColumnName];
        }
} 
```

# javascript - 将 HTML 映射到 JSON

> ID：12980648
> 
> 赞同：73
> 
> 时间：2012-10-19T18:52:35.280
> 
> 标签：javascript, html, json

我正在尝试将 HTML 映射到结构完整的 JSON 中。是否有任何图书馆可以做到这一点，或者我需要自己编写？我想如果那里没有 html2json 库，我可以从 xml2json 库开始。毕竟，html 只是 xml 的变体，对吧？

**更新：**好的，我应该举个例子。我正在尝试做的是以下内容。解析一串html：

```
<div>
  <span>text</span>Text2
</div> 
```

像这样进入一个json对象：

```
{
  "type" : "div",
  "content" : [
    {
      "type" : "span",
      "content" : [
        "Text2"
      ]
    },
    "Text2"
  ]
} 
```

**注意**：如果您没有注意到标签，我正在寻找 Javascript 中的解决方案

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-10-20T00:19:46.130

我刚刚写了这个函数来做你想要的；试试看，如果它不适合您，请告诉我：

```
// Test with an element.
var initElement = document.getElementsByTagName("html")[0];
var json = mapDOM(initElement, true);
console.log(json);

// Test with a string.
initElement = "<div><span>text</span>Text2</div>";
json = mapDOM(initElement, true);
console.log(json);

function mapDOM(element, json) {
    var treeObject = {};

    // If string convert to document Node
    if (typeof element === "string") {
        if (window.DOMParser) {
              parser = new DOMParser();
              docNode = parser.parseFromString(element,"text/xml");
        } else { // Microsoft strikes again
              docNode = new ActiveXObject("Microsoft.XMLDOM");
              docNode.async = false;
              docNode.loadXML(element); 
        } 
        element = docNode.firstChild;
    }

    //Recursively loop through DOM elements and assign properties to object
    function treeHTML(element, object) {
        object["type"] = element.nodeName;
        var nodeList = element.childNodes;
        if (nodeList != null) {
            if (nodeList.length) {
                object["content"] = [];
                for (var i = 0; i < nodeList.length; i++) {
                    if (nodeList[i].nodeType == 3) {
                        object["content"].push(nodeList[i].nodeValue);
                    } else {
                        object["content"].push({});
                        treeHTML(nodeList[i], object["content"][object["content"].length -1]);
                    }
                }
            }
        }
        if (element.attributes != null) {
            if (element.attributes.length) {
                object["attributes"] = {};
                for (var i = 0; i < element.attributes.length; i++) {
                    object["attributes"][element.attributes[i].nodeName] = element.attributes[i].nodeValue;
                }
            }
        }
    }
    treeHTML(element, treeObject);

    return (json) ? JSON.stringify(treeObject) : treeObject;
} 
```

工作示例： http: [//jsfiddle.net/JUSsf/](http://jsfiddle.net/JUSsf/)（在 Chrome 中测试，我不能保证完全支持浏览器 - 您必须对此进行测试）。

​它会创建一个对象，其中包含您请求的格式的 HTML 页面的树结构，然后使用`JSON.stringify()`它包含在大多数现代浏览器（IE8+、Firefox 3+ .etc）中；如果您需要支持较旧的浏览器，您可以包含[json2.js](http://www.json.org/js.html)。

它可以将 DOM 元素或`string`包含有效的 XHTML 作为参数（我相信，我不确定它是否`DOMParser()`会在某些情况下阻塞，`"text/xml"`或者它是否不提供错误处理。不幸的是`"text/html"`，它很差浏览器支持）。

您可以通过传递不同的值来轻松更改此函数的范围`element`。您传递的任何值都将成为 JSON 映射的根。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-05-31T19:58:39.433

**html2json**

表示复杂的 HTML 文档会很困难并且充满了极端情况，但我只是想分享一些技术来展示如何启动这种程序。这个答案的不同之处在于它使用数据抽象和`toJSON`递归构建结果的方法

下面`html2json`是一个*小*函数，它接受一个 HTML 节点作为输入，并返回一个 JSON 字符串作为结果。特别注意代码是如何非常平坦的，但它仍然有足够的能力构建深度嵌套的树结构——这一切都可以实现，几乎为零的复杂性

```
const Elem = e => ({
  tagName: 
    e.tagName,
  textContent:
    e.textContent,
  attributes:
    Array.from(e.attributes, ({name, value}) => [name, value]),
  children:
    Array.from(e.children, Elem)
})

const html2json = e =>
  JSON.stringify(Elem(e), null, '  ')

console.log(html2json(document.querySelector('main')))
```

```
<main>
  <h1 class="mainHeading">Some heading</h1>
  <ul id="menu">
    <li><a href="/a">a</a></li>
    <li><a href="/b">b</a></li>
    <li><a href="/c">c</a></li>
  </ul>
  <p>some text</p>
</main>
```

在前面的例子中，`textContent`有点被屠杀了。为了解决这个问题，我们引入了另一个数据构造函数，`TextElem`. 我们必须映射`childNodes`(而不是`children`) 并选择基于返回正确的数据类型`e.nodeType`——这让我们更接近我们可能需要的

```
const TextElem = e => ({
  type:
    'TextElem',
  textContent:
    e.textContent
})

const Elem = e => ({
  type:
    'Elem',
  tagName: 
    e.tagName,
  attributes:
    Array.from(e.attributes, ({name, value}) => [name, value]),
  children:
    Array.from(e.childNodes, fromNode)
})

const fromNode = e => {
  switch (e?.nodeType) {
    case 1: return Elem(e)
    case 3: return TextElem(e)
    default: throw Error(`unsupported nodeType: ${e.nodeType}`) 
  }
}

const html2json = e =>
  JSON.stringify(Elem(e), null, '  ')

console.log(html2json(document.querySelector('main')))
```

```
<main>
  <h1 class="mainHeading">Some heading</h1>
  <ul id="menu">
    <li><a href="/a">a</a></li>
    <li><a href="/b">b</a></li>
    <li><a href="/c">c</a></li>
  </ul>
  <p>some text</p>
</main>
```

无论如何，这只是问题的两次迭代。当然，您必须解决出现的极端情况，但这种方法的好处在于，它为您提供了很大的灵活性，可以根据需要在 JSON 中对 HTML 进行编码 -*并且*不会引入太多复杂性

根据我的经验，您可以继续使用这种技术进行迭代并取得非常好的结果。如果这个答案对任何人都感兴趣并且希望我扩展任何内容，请告诉我^_^

相关：[使用 JavaScript 的递归方法：构建您自己的 JSON.stringify 版本](https://stackoverflow.com/a/42690135/633183)

* * *

**json2html**

上面我们从 HTML 到 JSON，现在我们可以从 JSON 到 HTML。当我们可以在不丢失数据的情况下在两种数据类型之间进行转换时，这称为[同构](https://en.wikipedia.org/wiki/Isomorphism)。我们在这里所做的基本上就是写上面每个函数的逆 -

```
const HtmlNode = (tagName, attributes = [], children = []) => {
  const e = document.createElement(tagName)
  for (const [k, v] of attributes) e.setAttribute(k, v)
  for (const child of children) e.appendChild(toNode(child))
  return e
}

const TextNode = (text) => {
  return document.createTextNode(text)
}

const toNode = t => {
  switch (t?.type) {
    case "Elem": return HtmlNode(t.tagName, t.attributes, t.children)
    case "TextElem": return TextNode(t.textContent)
    default: throw Error("unsupported type: " + t.type)
  }
}

const json2html = json =>
  toNode(JSON.parse(json))

const parsedJson =
  {"type":"Elem","tagName":"MAIN","attributes":[],"children":[{"type":"TextElem","textContent":"\n  "},{"type":"Elem","tagName":"H1","attributes":[["class","mainHeading"]],"children":[{"type":"TextElem","textContent":"Some heading"}]},{"type":"TextElem","textContent":"\n  "},{"type":"Elem","tagName":"UL","attributes":[["id","menu"]],"children":[{"type":"TextElem","textContent":"\n    "},{"type":"Elem","tagName":"LI","attributes":[],"children":[{"type":"Elem","tagName":"A","attributes":[["href","/a"]],"children":[{"type":"TextElem","textContent":"a"}]}]},{"type":"TextElem","textContent":"\n    "},{"type":"Elem","tagName":"LI","attributes":[],"children":[{"type":"Elem","tagName":"A","attributes":[["href","/b"]],"children":[{"type":"TextElem","textContent":"b"}]}]},{"type":"TextElem","textContent":"\n    "},{"type":"Elem","tagName":"LI","attributes":[],"children":[{"type":"Elem","tagName":"A","attributes":[["href","/c"]],"children":[{"type":"TextElem","textContent":"c"}]}]},{"type":"TextElem","textContent":"\n  "}]},{"type":"TextElem","textContent":"\n  "},{"type":"Elem","tagName":"P","attributes":[],"children":[{"type":"TextElem","textContent":"some text"}]},{"type":"TextElem","textContent":"\n"}]}

document.body.appendChild(toNode(parsedJson))
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:19:06.060

在阅读 ExtJS 完整框架本身就是 JSON 时，我得到了一些链接。

[http://www.thomasfrank.se/xml_to_json.html](http://www.thomasfrank.se/xml_to_json.html)

[http://camel.apache.org/xmljson.html](http://camel.apache.org/xmljson.html)

在线 XML 到 JSON 转换器：http: [//jsontoxml.utilities-online.info/](http://jsontoxml.utilities-online.info/)

**更新** 顺便说一句，要获得所添加的 JSON，HTML 也需要像这样在其中包含类型和内容标签，或者您需要在进行 JSON 转换时使用一些 xslt 转换来添加这些元素

```
<?xml version="1.0" encoding="UTF-8" ?>
<type>div</type>
<content>
    <type>span</type>
    <content>Text2</content>
</content>
<content>Text2</content> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-26T00:13:47.283

我有一个类似的问题，我想通过以下方式将 HTML 表示为 JSON：

*   对于 HTML 文本节点，使用`string`
*   对于 HTML 元素，使用一个数组：
    *   元素的（标签）名称
    *   一个对象，将属性键映射到属性值
    *   子节点的（内联）列表

例子：

```
<div>
  <span>text</span>Text2
</div> 
```

变成

```
[
   'div',
   {},
   ['span', {}, 'text'],
   'Text2'
] 
```

* * *

我编写了一个函数来处理将 DOM 元素转换为这种 JS 结构。您可以在此答案的末尾找到此功能。该函数是用 Typescript 编写的。您可以使用[Typescript Playground](https://www.typescriptlang.org/play)将其转换为干净的 JavaScript。

* * *

此外，如果您需要将 html 字符串解析为 DOM，请分配给`.innerHtml`：

```
let element = document.createElement('div')
element.innerHtml = htmlString 
```

* * *

此外，这是常识，但如果您需要 JSON 字符串输出，请使用[`JSON.stringify`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).

* * *

```
/**
 * A NodeDescriptor stands for either an (HTML) Element, or for a text node
 */
export type NodeDescriptor = ElementDescriptor | string

/**
 * Array representing an HTML Element. It consists of:
 *
 * - The (tag) name of the element
 * - An object, mapping attribute keys to attribute values
 * - The (inlined) list of children nodes
 */
export type ElementDescriptor = [
   string,
   Record<string, string>,
   ...NodeDescriptor[]
]

export let htmlToJs = (element: Element, trim = true): ElementDescriptor => {
   let convertElement = (element: Element): ElementDescriptor => {
      let attributeObject: Record<string, string> = {}
      for (let { name, value } of element.attributes) {
         attributeObject[name] = value
      }

      let childArray: NodeDescriptor[] = []
      for (let node of element.childNodes) {
         let converter = htmlToJsDispatch[node.nodeType]
         if (converter) {
            let descriptor = converter(node as any)
            let skip = false

            if (trim && typeof descriptor === 'string') {
               descriptor = descriptor.trim()
               if (descriptor === '') skip = true
            }

            if (!skip) childArray.push(descriptor)
         }
      }

      return [element.tagName.toLowerCase(), attributeObject, ...childArray]
   }

   let htmlToJsDispatch = {
      [element.ELEMENT_NODE]: convertElement,
      [element.TEXT_NODE]: (node: Text): string => node.data,
   }

   return convertElement(element)
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-12T02:51:57.640

谢谢@Gorge Reith。解决@George Reith 提供的解决方案，这里有一个功能，它进一步（1）分离出各个“hrefs”链接（因为它们可能有用），（2）使用属性作为键（因为属性更具描述性）， (3) 通过使用 'jsdom' 包，它可以在 Node.js 中使用，而无需 Chrome：

```
const jsdom = require('jsdom') // npm install jsdom provides in-built Window.js without needing Chrome

// Function to map HTML DOM attributes to inner text and hrefs
function mapDOM(html_string, json) {
    treeObject = {}

    // IMPT: use jsdom because of in-built Window.js
    // DOMParser() does not provide client-side window for element access if coding in Nodejs
    dom = new jsdom.JSDOM(html_string)
    document = dom.window.document
    element = document.firstChild

    // Recursively loop through DOM elements and assign attributes to inner text object
    // Why attributes instead of elements? 1\. attributes more descriptive, 2\. usually important and lesser
    function treeHTML(element, object) {
        var nodeList = element.childNodes;
        if (nodeList != null) {
           if (nodeList.length) {
               object[element.nodeName] = []  // IMPT: empty [] array for non-text recursivable elements (see below)
               for (var i = 0; i < nodeList.length; i++) {
                   // if final text
                   if (nodeList[i].nodeType == 3) {
                       if (element.attributes != null) {
                           for (var j = 0; j < element.attributes.length; j++) {
                                if (element.attributes[j].nodeValue !== '' && 
                                    nodeList[i].nodeValue !== '') {
                                    if (element.attributes[j].name === 'href') { // separate href
                                        object[element.attributes[j].name] = element.attributes[j].nodeValue;
                                    } else {
                                        object[element.attributes[j].nodeValue] = nodeList[i].nodeValue;
                                    }

                                }
                           }
                       }
                   // else if non-text then recurse on recursivable elements
                   } else {
                       object[element.nodeName].push({}); // if non-text push {} into empty [] array
                       treeHTML(nodeList[i], object[element.nodeName][object[element.nodeName].length -1]);
                   }
               }
           }
        }
    }
    treeHTML(element, treeObject);

    return (json) ? JSON.stringify(treeObject) : treeObject;
} 
```

# javascript - 使用 JQuery 验证输入框

> ID：12980649
> 
> 赞同：1
> 
> 时间：2012-10-19T18:52:38.493
> 
> 标签：javascript, jquery

你好，这是我第二次尝试用 JQuery 解决这个问题
我需要检查一行输入必须比同一行中的其他输入小，对于“n”行的动态表，在发送我的表单之前......我需要检查使用输入的“ID”属性逐行...

这是我的代码：http: [//jsfiddle.net/cespinoza/bQcu2/36/](http://jsfiddle.net/cespinoza/bQcu2/36/)

```
 <form >
Line 1 Get <input type="val1" name="text1" id="desp" /> from <input type="val1" name="text1" id="cantidad" /><br>
Line 2 Get <input type="val2" name="text2" id="desp" /> from <input type="val2" name="text2" id="cantidad" /><br>
Line 3 Get <input type="val3" name="text3" id="desp" /> from <input type="val3" name="text3" id="cantidad" /><br>

    <button type="submit">Submit</button>

</form> 
```

编辑：添加了原始 JS 代码

```
$('#desp').change(function(){

    if($('#desp').val() == $('#cantidad').val())
    {
     alert("First value is greater than second, sorry")
    return False;
    }
    else
    {

    alert("All ok, push to database")
    return True,
    }

}); 
```

提前致谢。
基督教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:27:06.213

终于可以解决这个问题了，谢谢...

这是解决方案：

```
function validar(obj,i){
        var1=Number(obj.value);
        var2=Number(document.getElementById("saldo"+i).value);

        if (var1>var2) {        
            obj.focus();
            alert("No puede Retirar mas del saldo existente");

            }

}

Line 1 Get <input type="val1" name="text1" id="des1" onblur="validar(this,1);" /> from <input type="val1" name="text1"  value="10" id="saldo1"    /><br>
Line 2 Get <input type="val2" name="text2" id="des2" onblur="validar(this,2);" /> from <input type="val2" name="text2" id="saldo2" value="10" /><br>
Line 3 Get <input type="val3" name="text3" id="des3" onblur="validar(this,3);"/> from <input type="val3" name="text3" id="saldo3" value="10"/><br> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-19T19:01:16.600

```
 <form >
Line 1 Get <input type="val1" name="text1" id="desp1" /> from <input type="val1" name="text1" id="cantidad1" /><br>
Line 2 Get <input type="val2" name="text2" id="desp2" /> from <input type="val2" name="text2" id="cantidad2" /><br>
Line 3 Get <input type="val3" name="text3" id="desp2" /> from <input type="val3" name="text3" id="cantidad3" /><br>

    <button type="submit">Submit</button>
$('#desp').change(function(){
var j;
    for(i=1;i<n;i++){
    if($('#desp'+i).val() == $('#cantidad'+i).val())
    {
     alert("First value is greater than second at line"+i);
    return False;
    }
    else
    {
       j++
    }
}
if(n=j)
{
alert('all is well');
return false;
}

}); 
```

您应该根据行数获得的 n 值

# gridview - 绑定gridview时带有私有字段的GridView控件

> ID：12980655
> 
> 赞同：1
> 
> 时间：2012-10-19T18:52:53.730
> 
> 标签：gridview, private, field

```
enter code herepublic List<VivaClass> ReturnVivaObj() //viva class all field is private
{
    List<VivaClass> Objlst = new List<VivaClass>();
    VivaClass obj = null;
    try
    {
        SqlConnection hookup = new SqlConnection(new ConnectionString().GetConString(("SqlConString")));
        string query = "Select ID,GroupID,StudentName,ProjectName,City,Date,Time,isMake FROM SchedualTB";
        SqlCommand cmd = new SqlCommand(query, hookup);
        hookup.Open();
        SqlDataReader dr = cmd.ExecuteReader();
        while (dr.Read())
        {
            obj = new VivaClass();
            obj.SetGet_ID = Convert.ToInt32(dr["ID"]);
            obj.SetGetStudentObJ.SetGetDGroupID = Convert.ToString(dr["GroupID"]);
            obj.SetGetStudentObJ.SetGetDStudentName = Convert.ToString(dr["StudentName"]);
            obj.SetGetStudentObJ.SetGetDProjectName = Convert.ToString(dr["ProjectName"]);
            obj.SetGetStudentObJ.SetGetDCity = Convert.ToString(dr["City"]);
            obj.SetGetDate = dr["Date"].ToString();
            obj.SetGetDTime = dr["Time"].ToString();
            obj.SetGetDIsMake = Convert.ToBoolean(dr["isMake"].ToString());
            Objlst.Add(obj);
        }
    }
    catch (Exception e)
    {
        throw e;
    }
    return Objlst;
}
enter code herepublic List<VivaClass> ReturnVivaObj()  // this function return the list of viva objec for binding the Gridview control
{
    List<VivaClass> Objlst = new List<VivaClass>();
    VivaClass obj = null;
    try
    {
        SqlConnection hookup = new SqlConnection(new ConnectionString().GetConString(("SqlConString")));
        string query = "Select ID,GroupID,StudentName,ProjectName,City,Date,Time,isMake FROM SchedualTB";
        SqlCommand cmd = new SqlCommand(query, hookup);
        hookup.Open();
        SqlDataReader dr = cmd.ExecuteReader();
        while (dr.Read())
        {
            obj = new VivaClass();
            obj.SetGet_ID = Convert.ToInt32(dr["ID"]);
            obj.SetGetStudentObJ.SetGetDGroupID = Convert.ToString(dr["GroupID"]);
            obj.SetGetStudentObJ.SetGetDStudentName = Convert.ToString(dr["StudentName"]);
            obj.SetGetStudentObJ.SetGetDProjectName = Convert.ToString(dr["ProjectName"]);
            obj.SetGetStudentObJ.SetGetDCity = Convert.ToString(dr["City"]);
            obj.SetGetDate = dr["Date"].ToString();
            obj.SetGetDTime = dr["Time"].ToString();
            obj.SetGetDIsMake = Convert.ToBoolean(dr["isMake"].ToString());
            Objlst.Add(obj);
        }
    }
    catch (Exception e)
    {
        throw e;
    }
    return Objlst;
}
enter code here<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" DataKeyNames="ID" onrowediting="GridView1_RowEditing">
    <Columns>
        <asp:TemplateField HeaderText="Group ID">
        <ItemTemplate>
        <asp:Label ID="lblGroupID" runat="server" Text='<%# Eval("GroupID") %>' ></asp:Label>
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Student ID">
        <ItemTemplate>
        <asp:Label ID="lblUserName" runat="server" Text='<%# Eval("UserName") %>' ></asp:Label>
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Student Name">
        <ItemTemplate>
        <asp:Label ID="lblStudentName" runat="server" Text='<%# Eval("StudentName") %>' ></asp:Label>
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Project Name">
        <ItemTemplate>
        <asp:Label ID="lblProjectName" runat="server" Text='<%# Eval("ProjectName") %>' ></asp:Label>
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField ItemStyle-HorizontalAlign="Right" HeaderText="Status" >
            <ItemTemplate>
                 <asp:ImageButton ID="imgStatus" runat="server" CommandName="Edit" ToolTip="Change User status"  ImageUrl="~/Image/logo/statusActive.png"></asp:ImageButton>
            </ItemTemplate>
            </asp:TemplateField>
    </Columns>
</asp:GridView>
enter code hereprivate void FillGrid() // Error: 'VivaClass' does not contain a property with the name 'ID'
{
    GridView1.DataSource = new StudentIdentity().ReturnVivaObj();
    GridView1.DataBind();

} 
```

我正在尝试绑定数据，但异常抛出 VivaClass 不包含名为“ID”的属性。我不知道如何通过代码进行绑定。任何一次都可以给我任何链接或解决方案。谢谢

# c# - C# DataGridView 单元格在选中时自动清除

> ID：12980658
> 
> 赞同：0
> 
> 时间：2012-10-19T18:53:07.500
> 
> 标签：c#, winforms, datagridview, event-handling

我有一个 Windows 窗体应用程序，其中一部分带有 DataGridView (DGV)。我使用 Visual Studio UI 将列添加到 DGV，然后以编程方式添加具有一些默认值的行。我的问题是一旦添加了行，任何选择的单元格都会自动清空其中的任何值——甚至是只读单元格！

我只处理 DGV 的“CellValueChanged”事件，所做的只是验证行以确保至少存在一个有效的值组合，然后启用按钮。

更令人困惑的是，选定的单元格清除问题并不总是发生。添加行后，除非您进行更改或执行使用行重新加载 DGV 的操作，否则所有单元格都将清除。之后，一些细胞或没有细胞会自行清除。

有没有人遇到过这种情况或知道解决问题的方法？我从谷歌得到的只是“如何使单元格清晰”之类的。

谢谢，

*   马特

*** 更新 ***

向 DGV 添加新行的代码：

```
 metaMapGrd.Rows.Clear();
        ((DataGridViewComboBoxColumn)metaMapGrd.Columns[1]).DataSource = _excel.ListHeaders(worksheetListCmb.SelectedItem.ToString());
        foreach (Field f in _sharePoint.CurrentFieldList)
        {
            // skip the key field matching portion.  These should be for comparison only.
            if (f.Title == spListKeyCmb.SelectedItem.ToString())
            {
                continue;
            }

            DataGridViewRow row = new DataGridViewRow();

            metaMapGrd.Rows.Add(row);

            DataGridViewTextBoxCell spcell = new DataGridViewTextBoxCell();
            spcell.Value = f.Title;
            spcell.ToolTipText = f.TypeAsString;
            row.Cells["spListColumn"] = spcell;

            DataGridViewCheckBoxCell fcell = new DataGridViewCheckBoxCell();
            fcell.Value = true;
            row.Cells["useThisColumn"] = fcell;
        }
        metaMapGrd.CurrentCell = null; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:39:29.797

根据我们的聊天，我建议不要尝试手动处理 DatagridView，而是使用底层的 DataObjects 列表，然后将 DGV 数据绑定到该列表。

使用隐藏列获取有关 SharePoint ColumnType 的信息。

希望这会有所帮助。

# serialization - 在 WinRT 中将 ImageSource 写入文件

> ID：12980663
> 
> 赞同：1
> 
> 时间：2012-10-19T18:53:23.670
> 
> 标签：serialization, bitmap, windows-runtime, imagesource

我想将 ImageSource 的图像缓存到文件中，因此我可以使用 URI 指向它，但找不到执行此操作的调用。问题是我可以在网上找到的所有示例代码都是针对 WPF 的，并且使用的类在 WinRT 中不存在。

Windows.Graphics.Imaging 命名空间中有一些类，但据我通过搜索它们及其方法可以看出，它们都没有满足我的需要。

我有一个 ImageSource。我想将图像写入文件。我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:18:30.570

ImageSource 属性通常是[BitmapImage](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.imaging.bitmapimage)（在 XAML 中使用 URI 指定 ImageSource 时的默认值）。在某些情况下，您可能想要编辑位图的像素 - 这就是您将使用[WriteableBitmap](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.imaging.writeablebitmap.aspx)的地方。然后是[SurfaceImageSource](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.imaging.surfaceimagesource.aspx)和[VirtualSurfaceImageSource](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.imaging.virtualsurfaceimagesource.aspx)如果你想做 DirectX 互操作来绘制一些高质量、高性能的图形。

WinRT XAML Toolkit 是一个开源库，在 Imaging 命名空间中有一些[扩展方法](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/0657c67a93d5#WinRTXamlToolkit/Imaging/WriteableBitmapFromBitmapImageExtension.cs)，可帮助您加载和保存图像。我没有看到一个允许您保存 BitmapImage 的方法，尽管您可以使用它的 UriSource 属性来找出图像的来源并从那里下载，但这听起来很浪费带宽，因为您需要下载两次。

我不确定您的确切情况是什么，但假设您正在从网上下载图像 - 您最好先下载它（例如使用[Net.WebFile.SaveAsync()](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/0657c67a93d5#WinRTXamlToolkit/Net/WebFile.cs)方法，然后基于它创建 BitmapImage . 另一方面，当您打开一个指定网址的 BitmapImage 时，图像应该会自动被缓存（例如，检查“%USERPROFILE%\AppData\Local\Packages\Microsoft.BingNews_8wekyb3d8bbwe\AC\INetCache\”以获取由“新闻”应用程序），因此也许最好只使用 Web URI 打开图像而不是自己管理缓存，这很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-24T17:17:47.210

您也可以使用 FFImageLoading ( [https://github.com/molinch/FFImageLoading/](https://github.com/molinch/FFImageLoading/) )。或者...查看它的来源以了解它是如何实现的。

## 特征

*   Xamarin.iOS（最低 iOS 7）、Xamarin.Android（最低 Android 4）、Xamarin.Forms 和 Windows（WinRT、UWP）支持
*   可配置的磁盘和内存缓存
*   类似下载/加载请求的重复数据删除
*   错误和加载占位符支持
*   图像可以自动下采样到指定大小（更少的内存使用）
*   WebP 支持
*   图像加载淡入动画支持
*   可以重试图片下载（RetryCount、RetryDelay）
*   默认情况下禁用 Android 透明度（可配置）。节省 50% 的内存
*   转换支持
    *   模糊变换
    *   CircleTransformation、RoundedTransformation、CornersTransformation
    *   颜色空间变换、灰度变换、棕褐色变换
    *   翻转变换
    *   支持自定义转换（本机平台 ITransformation 实现）

这很简单：

```
<ff:FFImage Name="image"
    VerticalAlignment="Stretch" 
    HorizontalAlignment="Stretch"
    LoadingPlaceholder="loading.png"
    ErrorPlaceholder="error.png"
    CacheDuration="30"
    RetryCount="3"
    RetryDelay="250"
    DownsampleHeight="300"
    Source="http://lorempixel.com/output/city-q-c-600-600-5.jpg">
</ff:FFImage> 
```

此处的示例项目：[https ://github.com/molinch/FFImageLoading/tree/master/samples/Simple.WinPhone.Sample](https://github.com/molinch/FFImageLoading/tree/master/samples/Simple.WinPhone.Sample)

# php - PHP CURL 在 URL 中传递 UTF-8 字符

> ID：12980666
> 
> 赞同：1
> 
> 时间：2012-10-19T18:53:34.140
> 
> 标签：php, curl, utf-8

当我发送一个包含 UTF-8 字符 é 和 ú 的 URL 时，这些字符使用 PHP 函数 rawurlencode 进行编码。一旦我生成了我的 URL，它就会被传递给一个 CURL 请求到一个返回 XML 数据的 Java Web 服务。

单词 Chébé 的示例编码以 Ch%C3%A9b%C3%A9 形式发送到 Web 服务，据我所知，这是标准格式。我还尝试了 htmlentities 函数将字符串转换为实体，然后使用 rawurlencode 对字符串进行编码。

出于明显的 XML 原因，与查询匹配的示例中的项目名称采用实体形式。

我的问题是 Web 服务在发出请求时似乎因 500 内部错误而失败。所有其他字符串都很好。它仅受 UTF-8 字符影响。当我在浏览器中以 Chébé 之类的实体形式传递 URL 时，服务会响应结果，但是当我以浏览器 URL 编码形式传递时，它也会失败。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:06:09.220

谷歌以相同的方式对其进行编码 q=Ch%C3%A9b%C3%A9 所以......它是正确的。你在处理程序中做什么？假设您也控制处理程序服务，如果所有其他方法都失败，则 Base64 对其进行编码...

# jquery-mobile - Jquery Mobile .blur() 不隐藏键盘

> ID：12980669
> 
> 赞同：3
> 
> 时间：2012-10-19T18:53:52.253
> 
> 标签：jquery-mobile, keyboard, blur

当用户使用 ' $(#elementID).blur(); 搜索某些内容时，我试图隐藏键盘 '

我在登录页面中遇到了 IOS 问题，键盘没有隐藏。IOS 现在没有给我问题，但 Android 是。

在 Android 中，登录页面正确隐藏了键盘，但在搜索页面中，搜索完成后键盘仍然停留在那里。

尝试的解决方案：

*   搜索完成后，我什至模糊了元素。

*   我试过这个，它也没有工作：

    > 文档.activeElement.blur();

任何人都可以提供建议吗？谢谢！

# iphone - 调整框架大小后禁用 uiviews 按钮中的用户操作

> ID：12980670
> 
> 赞同：0
> 
> 时间：2012-10-19T18:53:53.900
> 
> 标签：iphone, objective-c, ios, uiview, uiviewanimation

我确实有一个 UIView 子类，我们称之为 PopupView。在此 PopupView 中，我确实有一个带有自定义 uiview 和 uibutton **(2)**的 NavigationBar 。PopupView 内部还有一个 UIButton **(1) 。**

```
PopupView
  - UIButton (1)
  - UINavigationBar
    - UINavigationItem
      - UIBarButtonItem
        - UIView
          - UIButton (2) 
```

uibutton 中这个 uibutton 疯狂的原因是因为我可以将 capinsets 用于 uibutton 中的背景图像，但不能用于 uibarbuttonitem。

**我的问题：**

我使用 uiview 动画调整 PopupView 的大小，**动画完成后，我无法再单击此 uiview 中的按钮**。

```
[UIView animateWithDuration:0.4f delay:0.0f options:UIViewAnimationCurveEaseOut animations:^{
        CGRect popupFrame = self.frame;
        popupFrame.size.height += 140.0f;
        popupFrame.origin.y = floorf(popupFrame.origin.y - (140.0f / 2));
        self.frame = popupFrame;
    } completion:^(BOOL finished) {
}]; 
```

如果我不使用 uiview 动画并直接设置新框架，也会发生这种情况。我是否通过单击或直接`viewDidLoad`在它的 viewController 上调整它的大小也没关系。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:23:43.170

`recursiveDescription`Heer 是您输出的相关部分：

```
|    | <UIView: 0xaac0480; frame = (0 0; 320 568); tag = 23945; layer = <CALayer: 0xaac04e0>>
|    |    | <MJPopupBackgroundView: 0xaac0710; frame = (0 0; 320 568); tag = 23943; layer = <CALayer: 0xaac07c0>>
|    |    | <UIButton: 0xaac0aa0; frame = (0 0; 320 568); opaque = NO; layer = <CALayer: 0xaac0b60>>
|    |    | <UIView: 0x9d6fea0; frame = (10 204; 300 160); autoresize = W+H; tag = 23942; layer = <CALayer: 0x9d6ff50>>
|    |    |    | <MoviePopupView: 0xab1aaa0; frame = (0 -70; 300 300); clipsToBounds = YES; layer = <CALayer: 0xab1a070>> 
```

0xaac 视图覆盖屏幕。

在 0xaac 视图中，0x9d6 视图的高度为 160 点，并在 0xaac 视图中垂直居中。

在 0x9d6 视图内部，0xab1`MoviePopupView`的高度为 300 点，并且（其 Y 原点为 -70）位于 0x9d6 视图“内部”的中心，但溢出了 0x9d6 视图的顶部和底部边缘。

该`clipsToBounds`属性的默认值为 NO，因此 0x9d6 视图不会在视觉上剪切其 0xab1 子视图的内容。因此按钮仍然在屏幕上可见。

然而，命中测试总是裁剪到视图的边界。因此，当您尝试触摸其中一个按钮时，点击超出了 0x9d6 视图的边界（只有 160 点的高度）。0x9d6 视图在到达其`MoviePopupView`下方的 或 按钮之前拒绝触摸。

[`hitTest:withEvent:`文档](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-BBCCAICB)中提到了这一点：

> 位于接收器边界之外的点永远不会被报告为命中，即使它们实际上位于接收器的子视图之一内。如果当前视图的`clipsToBounds`属性设置为`NO`并且受影响的子视图超出了视图的边界，则可能会发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:11:44.107

由于我们看不到按钮的位置，因此无法确定，但如果您为包含按钮的 UIView 提供背景颜色（或将其设置为剪辑子视图），您可能会发现调整大小导致您的按钮位于框架之外，从而使它们无法点击。

# java - listview（2行）onclick：从单击的项目中检索特定数据（无法访问类似地图的对象）

> ID：12980672
> 
> 赞同：1
> 
> 时间：2012-10-19T18:54:03.483
> 
> 标签：java, android, dictionary

我正在从数据库查询中构建一个列表视图（每个项目有 2 行）。我为每个项目附加了一些数据，但稍后在他们的 onClick 侦听器中再次检索它时遇到了麻烦。

**data**是键/值对的列表，比如*Title、Date 和 ID*

```
List<Map<String, String>> data = new ArrayList<Map<String, String>>(); 
```

我的适配器创建如下所示的列表视图：

```
SimpleAdapter adapter = new SimpleAdapter(this, data,
            android.R.layout.simple_list_item_2,
            new String[] {"title", "date"},
            new int[] {android.R.id.text1, android.R.id.text2});
            itemlist.setAdapter(adapter);
            setListAdapter(adapter); 
```

我像这样附加 onListItemClick 侦听器：

```
protected void onListItemClick(ListView l, View v, int position, long id) {
      super.onListItemClick(l, v, position, id);
      Intent intent = new Intent(this, CtestActivity.class);
      Object obj = this.getListAdapter().getItem(position);
      // here I want to extract the id from obj
      // obj.toString() is {id:7, title: sometitle, date: yesterday}
} 
```

这可能很简单是缺乏java知识。无论哪种方式，我都会很感激有关如何从这个“类似地图”的对象 obj 访问特定值的一些信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:04:57.363

在您的`onListItemClick()`侦听器中，只需将通用对象转换为您的地图：

```
Map<String, String> map = (Map<String, String>) this.getListAdapter().getItem(position);
String id = map.get("id");
String title = map.get("title");
String date = map.get("date"); 
```

# php - 如何更新 sql foreach 输入框

> ID：12980674
> 
> 赞同：0
> 
> 时间：2012-10-19T18:54:14.350
> 
> 标签：php, mysql

我正在尝试更新 mysql 附属 ID，我有一个更新按钮。

我有这样的东西。

```
foreach($_POST['affid'] as $index_id => $value) {
   $key = 'affId_'.$value; 

   $dosql = ("UPDATE dlbprog SET affId='$key' affId =".$value);

   $doupdate = mysql_query($dosql);
} 
```

任何帮助将不胜感激

我不太清楚该怎么做

dlbprog 是数据库名称，affId 是数据库字段，affid 是输入框名称。

有几个输入框，只有一个提交按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:02:26.270

```
<?php

foreach($_POST['affid'] as $id) {

   $id = mysql_real_escape_string(strip_tags($id));
   $aff_id = 'affId_'.$id;

   $sql = "UPDATE dlbprog SET affId='$aff_id' WHERE affId='$aff_id'";

   mysql_query($sql);
}
?> 
```

这适用于复选框或多个选择表单标签。但是，如果您只处理一个附属 ID，则无需循环。如果它与 $_POST['affid'] 不匹配，还要检查您的 name 属性

确保它是一个复选框，并且它的名称属性是 name="affid[]" 而不是 name="affid"

# wordpress - 样式 WordPress 中每个页面的不同当前页面菜单项

> ID：12980675
> 
> 赞同：-2
> 
> 时间：2012-10-19T18:54:18.617
> 
> 标签：wordpress

这是我要复制的内容：在 brit.co，单击菜单项，文本和图标都从白色变为黑色。在 WordPress 中，我可以将 current-menu-item 设置为 ONE 图标，以便 ONE 图标出现在每个活动页面上，但不能在每个页面上做*不同*的图标，如 brit.co 所示

显示的代码有效，但同样，每个页面上的活动图标都是相同的。“当前页面项”不尊重我为每个菜单页面设置的样式。我从来没有在 WP 中看到过这种情况，也许不能单独通过 CSS。

```
#access .menu-style-page-1 a {
background:url('/wp-content/uploads/2012/10/menu-1-white-icon.png') no-repeat 0.5em 0.5em transparent;
padding:0 1.2125em 0 2.2em;
}
#access .menu-style-page-2 a {
background:url('/wp-content/uploads/2012/10/menu-2-white-icon.png') no-repeat 0.5em 0.5em transparent;
padding:0 1.2125em 0 2.2em;
}
/*** current_page_item styles are below ***/
#access .menu-style-page-1 .menu_bar .current_page_item > a, .menu_bar .current-menu-item > a, .menu_bar .current_page_ancestor > a {
background:url('/wp-content/uploads/2012/10/menu-1-black-icon.png') no-repeat 0.5em 0.5em transparent;
padding:0 1.2125em 0 2.2em;
}

#access .menu-style-page-2 .menu_bar .current_page_item > a, .menu_bar .current-menu-item > a, .menu_bar .current_page_ancestor > a {
background:url('/wp-content/uploads/2012/10/menu-2-black-icon.png') no-repeat 0.5em 0.5em transparent;
padding:0 1.2125em 0 2.2em;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:58:19.433

不用太直接地深入研究你的东西，这相当简单。标准菜单类似于

```
<li id="menu-item-1" class="menu-item menu-item-1"><a></a></li>
<li id="menu-item-2" class="menu-item menu-item-2"><a></a></li> 
```

当你点击一个链接时——它都会添加一个类`current-menu-item`

你可以在 CSS 中做这样的事情

```
#menu-item-1.current-menu-item { background: #f00; /*red*/ }
#menu-item-2.current-menu-item { background: #0f0; /*green*/ } 
```

此外，在外观 > 菜单设置中，您可以单击“屏幕选项”并选中“类”框，然后您可以添加自定义类，这样您就可以

```
.aboutus.current-menu-item { background: #f00; /*red*/ }
.contactus.current-menu-item { background: #0f0; /*green*/ } 
```

您需要在外观 > 菜单中为每个菜单项添加一个类。在你的 CSS 中，你需要做

```
.your-class.current-menu-item { background-image: icon1.png no-repeat; }
.other-class.current-menu-item { background-image: icon2.png no-repeat; } 
```

在上面的例子中，.current-menu-item 永远不会有背景图像，只有当它涉及另一个类时。

如果它被覆盖，则意味着您有以下内容：

```
.your-class.current-menu-item { background-image: icon1.png no-repeat; }
.current-menu-item { background-image: BADicon.png no-repeat !important; } 
```

上面的代码将不起作用，因为“CASCADING”样式表规则`.current-menu-item`覆盖了您上面的各个样式。（并且 !important 帮助它覆盖）。

如果您删除个人的任何实例`.current-menu-item`并且只有这样做`.your-class.current-menu-item`才会**起作用**。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-20T11:44:31.183

解决了。不适用于 current-menu-item，因为后续条目会覆盖，按设计假设，并且看起来必须修改 php.ini 文件。

解决方案很简单：使用菜单 id 添加一种样式，使用页面 id 添加每页样式，因此：

菜单：li#menu-item-26 a {background:url('whiteicon.png') no-repeat; 左填充：2em}

菜单如何按页面显示： .page-id-2 li#menu-item-26 {background:url('blackicon.png') no-repeat; 左填充：2em}

# git - 计算 GIT 存储库中特定文件类型的平均代码行数

> ID：12980676
> 
> 赞同：0
> 
> 时间：2012-10-19T18:54:22.263
> 
> 标签：git

有什么方法可以找出 git 存储库中特定文件类型的平均代码行数是多少？
非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:57:12.047

AFAIK对此没有特定于git的功能..您将不得不为此编写自己的方法...

也许看看这里：[Count number of lines in a git repository](https://stackoverflow.com/questions/4822471/count-number-of-lines-in-a-git-repository)

# java - 如何在 Java 中创建一个在您键入时将 URL 转换为超链接的 JTable

> ID：12980677
> 
> 赞同：3
> 
> 时间：2012-10-19T18:54:31.207
> 
> 标签：java, swing, hyperlink, jtable, jtextpane

我需要一个具有多行单元格的 JTable，并将多个（在一个单元格中）URL 转换为可点击的超链接并支持基本样式操作（粗体、斜体、下划线），这意味着我可以在输入文本期间或之后编辑样式。我还需要它能够将样式化的单元格内容保存到数据库中。实现这一目标的最简单方法是什么？

我已经尝试创建一个自定义单元格编辑器（并解决了多行问题），它使用 JTextPane 并向其添加了关键侦听器，该侦听器在“空格”字符被释放时进行侦听，如果最后一个单词以“http://”开头，则删除它从它的文档中再次添加为带有 h​​ref 属性和蓝色的样式文本。我还添加了监听鼠标点击超链接的监听器。这一切都在编辑过程中起作用，但是当单元格失去焦点时，所有文本都变得无样式和黑色。也许是因为我使用了不同的渲染器和编辑器，但我也将关键侦听器添加到渲染器。在关闭和启动应用程序时，我在保存特别是设置表格单元格值时也遇到了巨大的问题。我应该继续尝试让它以这种方式工作，还是应该回去采取不同的方法，比如可能将 JTextPane 的内容类型设置为“text/html”。如果我这样做了，我真的不知道如何在您键入时将 URL 转换为超链接。

顺便说一句，编辑器扩展了 AbstractCellEdit，而渲染器扩展了 JTextPane。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:04:33.947

*   在您的方法中，您还需要一个自定义渲染器。一旦停止编辑，渲染器就会接管，因此渲染器必须支持与编辑器相同的样式选项
*   表格中的可点击超链接并不简单。渲染器组件不是 的一部分`JTable`，它仅用作标记。因此，您附加到组件的所有常规事物（如`MouseListener`、`ActionListener`、`FocusListener`、 ...）都不会被触发，因为组件不是 Swing 层次结构的一部分。如果我没记错的话，SwingX 内置了对`JTable`s 中的超链接的支持，但不确定它们是否可以与样式化的 HTML 文档结合使用
*   当您的编辑器扩展时`JTextPane`使用 a`DocumentListener`而不是 a`KeyListener`
*   保存/加载基本上只是将您转储`TableModel`到持久状态并返回。这看起来像需求的简单部分

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:12:35.147

[罗宾回答](https://stackoverflow.com/a/12980807/572834)了你`JTable`，我会补充一下文字。

如果您不需要真正的 HTML，即带有类似 的链接`<a href="http://example.com">link text</a>`，那么您可以将`DefaultStyledDocument`其用作单元格的模型。要使以 http 为前缀的文本显示为链接，请将颜色设置为蓝色并添加下划线属性。（`DefaultStyledDocument`模型比简单`HTMLDocument`。）

为了保留格式，您应该`Document`在 Swing 中为每个单元格存储文本模型。

无需删除并重新插入文本即可添加样式。您可以将样式应用于文档中已有的文本，使用[`setCharacterAttributes`](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/DefaultStyledDocument.html#setCharacterAttributes%28int,%20int,%20javax.swing.text.AttributeSet,%20boolean%29)方法。

而且您实际上可以重用 Swing 文本组件的渲染引擎来渲染您的单元格。您可以使用[`TextUI.getRootView()`](http://docs.oracle.com/javase/6/docs/api/javax/swing/plaf/TextUI.html#getRootView%28javax.swing.text.JTextComponent%29). 视图层次结构可以呈现您的文本并帮助您将鼠标单击转换为文本`Element`，您可以使用它来启动超链接。

# javascript - Jqueryui 与流星.js

> ID：12980678
> 
> 赞同：4
> 
> 时间：2012-10-19T18:54:46.613
> 
> 标签：javascript, jquery, jquery-ui, meteor

我想进入meteor.js来开发一个令人惊叹的应用程序，并且似乎使Web开发变得如此简单。

问题是该应用程序将有 2 个连接的可排序嵌套列表，我将使用 mjqueryui 对其进行排序。

如果有任何关于将 jqueryui 与流星.js 一起使用的示例或信息，我找不到太多，只有很久以前使用 spark 之前的旧版本流星的少数示例或信息。

谁能告诉我这是如何工作的，推荐的同时使用它们的方法是什么，如果可能的话，可以举一个例子或对此的任何参考。

还建议将它们一起使用，还是我应该使用另一种方式/库？

非常感谢瑞克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T15:35:19.620

Rick，我使用 jquery-ui（以及其他基于 jquery 的插件）和流星就好了。一般来说，当相关模板被渲染时，我会给元素它的 jquery-ui-ness，例如（在咖啡脚本中）：

```
# 'this' references the template
Template.listOne.rendered = ->
  $(this.firstNode).find('ul.connectedSortable').sortable
    connectWith: '.connectedSortable'
Template.listTwo.rendered = ->
  $(this.firstNode).find('ul.connectedSortable').sortable
    connectWith: '.connectedSortable' 
```

或者，您可以在某些事件之后使元素可排序，例如：

```
# 'this' now equals Window, so we must find the list from the event target
Template.listOne.events
  'click button': (e) ->
    $(e.target).parent().find('ul.connectedSortable').sortable
      connectWith: '.connectedSortable' 
```

# asp.net-mvc - 在视图中查看模型和复选框

> ID：12980682
> 
> 赞同：1
> 
> 时间：2012-10-19T18:54:57.070
> 
> 标签：asp.net-mvc, checkbox, viewmodel

我有一个新手问题，过去几天我一直试图理解。希望有人可以帮助我理解编程流程。

假设我有一个模型，信息存储在数据库中：

```
public class Student
{
    public int studentID { get; set; }
    public string studentName { get; set; }
    public strin studentGrade {get; set; }
}

public class StudentDBContext : DbContext
{
    public DbSet<Student> Students { get; set; }
} 
```

我想将它显示到视图中，并带有额外的复选框，以便我可以选择要提升到下一年级的学生。我读到一种方法是放入视图模型：

```
public class StudentViewModel
{
    public bool promoted { get; set; }
    public Student stu { get; set; }
} 
```

但我坚持这是这样做的方式吗？如果是的话，你如何将它放入视图中，它将显示所有学生，旁边有一个复选框。之后，我想更新勾选复选框的学生的所有成绩。例如：

学生 A、学生 B、学生 D 从 1 年级提升到 2 年级。所以我想显示学生，勾选学生 A、B 和 D 并提交以更新成绩。

一步一步的例子将不胜感激。

更新1：

控制器：

```
 [HttpGet]
    public ViewResult CheckBox()
    {
        var studentViewModels = db.Students.Select(m => new StudentViewModel()
        {
            stu = m
        }).ToList();

        return View(studentViewModels);
    }

    [HttpPost]
    public ActionResult CheckBox(IList<studentViewModel> list)
    {

        foreach (var stuUpdate in list.Where(m => m.promoted))
        {
            var stuRow = db.Students.Find(stuUpdate.stu.studentID);
            stuRow.studentName = stuRow.studentName + "1";
            db.Entry(stuRow).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("CheckBox");
        }
        return RedirectToAction("CheckBox");
    } 
```

看法：

```
@model IList<School.ViewModels.StudentViewModel>

@using (Html.BeginForm())
{
<table>
<tr>
    <th>

    </th>
    <th>
        student ID
    </th>
    <th>
        student name
    </th>
    <th>
        student grade
    </th>
</tr>
@foreach (var item in Model) {
    <tr>
        <td>
            @Html.CheckBoxFor(modelItem => item.promoted)
            @Html.HiddenFor(modelItem => item.stu.studentID)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.stu.studentID)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.stu.studentName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.stu.studentGrade)
        </td>
    </tr>
}

</table>
<input type="submit" value="save" />
} 
```

但是目前遇到以下错误：值不能为空。参数名称：来源

```
Source Error:
foreach (var stuUpdate in list.Where(m => m.promoted)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:13:43.287

一个非常基本的“逐步”（在 SO 中完成，所以我可能犯了一些错误，但你明白了）。

你总是有几种方法来做这些事情，所以......只是把它作为一个样本，并找到其他例子来获得其他想法。

好吧，首先，在您的控制器中，您将有一个 GET 操作（查看列表）。

```
[HttpGet]
public ViewResult StudentList() {
   //retrieve all students. With the Select, we create a new instance of StudentViewModel for each student.
  //assuming StudentDbContext being a property of your controller, if it's not, you can instantiate a new one (in a using clause)
   var studentViewModels = StudentDbContext.Students
              .Select(m => new StudentViewModel() {
                   stu = m 
                  //we don't say nothing about promoted : 
                  //it will be there as "false" by default, which is probably what we want.
              }).ToList();
    //now we've got a list of StudentViewModel. This will be the model of our view
    return View(studentViewModels);

} 
```

然后我们有一个视图，StudentList.cshtml

在这个视图中，我们将显示一个表格，每个学生都有一行：studentId（在这种情况下隐藏）、姓名（仅显示）、成绩（仅显示）和一个复选框。

我们需要一个 for 循环（不是 foreach）来获得良好的模型绑定。

```
@model IList<StudentViewModel>

@using (Html.BeginForm()) {
<table>
  <tr>
     <th>Student name</th>
     <th>Student grade</th>
     <th>Promote</th>
  </tr>
  @for (var i = 0; i < Model.Count(); i++) {
   <tr>
      <td>@Html.HiddenFor(m => Model[i].Student.studentID)
          @Html.DisplayFor(m => Model[i].Student.studentName)
      </td>
      <td>@Html.DisplayFor(m => Model[i]Student.studentGrade)</td>
      <td>@Html.CheckBoxFor(m => Model[i].promoted)</td>
  </tr>
  }
</table>
<input type="submit" value="save" />
} 
```

此表单将导致另一个 POST 操作（与 GET 相同，具体取决于您的 POST 操作`Html.BeginForm`）

```
[HttpPost]
public ActionResult StudentList(IList<StudentViewModel> list) {
    //we treat only the lines where checkbox has been checked
    foreach (var studentViewModel in list.Where(m => m.promoted) {
       var student = StudentDBContext.GetById(studentViewModel.Student.studentID);//get student entity instance from context
       student.studentGrade ="<new value>";
       StudentDBContext.SaveChanges();//save changes, you must have such a method somewhere.
    }
    return Action("StudentList");
} 
```

小细节：

尝试尊重一些真正基本的“常规”做法：例如在 c# 中，属性应以大写字母开头（如 StudentGrade、StudentName、Promoted 等）。

# c# - 分布式环境中的中间件应用

> ID：12980689
> 
> 赞同：0
> 
> 时间：2012-10-19T18:55:18.837
> 
> 标签：c#, java, .net, spring-mvc, middleware

我想开发一个应用程序，它将数据从一个应用程序传输到另一个应用程序。现在关键是我的一个应用程序是在 .Net 框架中，而另一个是在 Spring 框架 (Java) 中实现的。

哪种编程技术最适合这种环境？
是的 ！数据将非常庞大，它将包括 BLOB。而且转账的时候有断网的可能，所以一定是交易之类的；因为我当然不想丢失数据。

您如何看待 XML over http？

请建议我应该实施哪种应用程序来传输数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T22:31:40.590

使用 Java，JMS 提供了一种将应用程序与提供数据的传输层分离的方法。通过使用所需提供者的 JNDI 信息，可以使用相同的 Java 类与不同的 JMS 提供者进行通信。这些类首先使用连接工厂连接到队列或主题，然后使用填充和发送或发布消息。在接收端，客户端然后接收或订阅消息。

我使用过[SonicMQ 消息传递系统](http://www.progress.com/en/sonic/index.html)，他们的[Java 消息服务](http://en.wikipedia.org/wiki/Java_Message_Service)非常稳定......你可以在[这里](https://github.com/ivan-iver/jms.publisher)查看一个关于我如何使用它的小示例，并且有一个[.Net 实现](http://www.progress.com/en/sonic/sonicmq-clients.html)

编码可能非常简单：

```
/**
 * 
 * This file is part of Jms.publisher sample.
 * 
 *  Jms.publisher is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 * 
 *  Jms.publisher is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 * 
 *  You should have received a copy of the GNU General Public License
 *  along with Jms.publisher.  If not, see <http://www.gnu.org/licenses/>.
 *  
 * 
 * AccessManager.Java 
 * Create by Iván Jaimes on 03/09/2012
 * 
 */
package sonic;

import javax.jms.JMSException;
import javax.jms.Session;
import javax.jms.TextMessage;
import javax.jms.TopicConnection;
import javax.jms.TopicPublisher;
import javax.jms.TopicSession;
import javax.jms.TopicConnectionFactory;

import config.ConnectionInfo;

public class AccessManager 
{
    private TopicConnection connection = null;
    private TopicSession session = null;
    private TopicPublisher topicPublisher = null;    
    private TopicConnectionFactory connectionFactory = null;
    private ConnectionInfo info = null;

    public AccessManager(ConnectionInfo connectionInfo) throws JMSException
    {
        info = connectionInfo;
    }

    public final void connect() throws JMSException
    {
        connectionFactory = new progress.message.jclient.TopicConnectionFactory(info.getSonicAddress());
        connection = connectionFactory.createTopicConnection(info.getUserName(), info.getPassword());
        connection.start();
        session = connection.createTopicSession(false, Session.AUTO_ACKNOWLEDGE);
        topicPublisher = session.createPublisher(info.getTopic());
        assert (isConnected());
    }

    public void send(String text) throws JMSException  
    {
        TextMessage message = session.createTextMessage(text); // send method
        topicPublisher.publish(message);
    }
    /**
     * Disconnect.
     * @throws JMSException 
     */
    public final void disconnect() throws JMSException 
    {
        if (topicPublisher != null) 
        {
            topicPublisher.close();
            session.close();
            connection.close();
        }

        connection = null;
        session = null;
    }

    /**
     * Checks if is connected.
     * 
     * @return true, if is connected
     */
    public final boolean isConnected() {
        if (session != null) {
            return true;
        }
        return false;
    }
} 
```

有更多关于它的资源：

*   [Java 规范请求](http://jcp.org/en/jsr/detail?id=343)
*   [如何使用 JMS](http://www.iro.umontreal.ca/~dift6802/jade/doc/tutorials/JMSMTP.html)

# c - 显示随机生成的整数的频率

> ID：12980696
> 
> 赞同：-6
> 
> 时间：2012-10-19T18:55:53.377
> 
> 标签：c, random

此代码旨在列出从 1 到 9 的数字，并在每个数字旁边显示它在已生成的 10,000 个随机数中出现的频率。

编码：

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

main()
{
int counts[10];
int i;
int random;
srand(time(0));
for (i = 0; i < 10; i++)
counts[i] = 0;
for (i = 0; i<= 10000; i++)
{
random = (int)(10.0*rand()/(RAND_MAX+1.0));
counts[random]++;
}
for (i = 0; i<10; i++);
printf("%d occurs %f%%\n", i, i/100.0);
return(0);

} 
```

但是，当我运行程序时，我会从 1-9 中得到一个我想要的列表，但它旁边列出了 1-9，但以十进制而不是频率。这是我运行它时得到的：

```
1 occurs 0.010000%
2 occurs 0.020000%
3 occurs 0.030000%
4 occurs 0.040000%
5 occurs 0.050000%
6 occurs 0.060000%
7 occurs 0.070000%
8 occurs 0.080000%
9 occurs 0.090000% 
```

为了获得每个数字的频率，我需要更改什么，当我从终端运行代码时使用`emacs`它列出 1-9 但是当我在 Eclipse 中运行代码时，它只显示 10 在控制台中出现 0.100000%。发生这种情况有什么原因吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:01:18.773

看起来您正确存储了每个数字的频率，只是没有显示它们。您的输出根本不引用`counts`数组。

在这一行：

```
printf("%d occurs %f%%\n", i, i/100.0); 
```

`i/100.0`应该是`counts[i]/10000`。

# jquery - 附加函数/条件 jQuery Dialog autoOpen 参数

> ID：12980698
> 
> 赞同：0
> 
> 时间：2012-10-19T18:55:55.293
> 
> 标签：jquery, jquery-ui, jquery-dialog

我需要检查页面加载的值，以确定对话框是否应该自动打开。我想这将类似于处理关闭的方式，但事实并非如此。

```
$(".x_dialog").dialog({
                autoOpen: function(){ret();}
});

 function ret() {return false;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:01:08.613

autoOpen 只能接受`true`或`false`。在初始化对话框之前计算值

```
var autoOpen = (1 === 2);

$(".x_dialog").dialog({
    autoOpen: autoOpen
}); 
```

或者，您可以将其设置为函数的返回值，但该函数必须返回一个类似布尔值的值。

```
$(".x_dialog").dialog({
    autoOpen: ret() // note the `()`, this means the function gets executed immediately
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:45:39.883

我的方法是错误的。

页面加载后，检查条件，然后调用

```
$("#x_dialog").dialog("open"); 
```

如果合适的话。

# node.js - 检查没有 $in 的数组中的值

> ID：12980702
> 
> 赞同：0
> 
> 时间：2012-10-19T18:56:16.590
> 
> 标签：node.js, mongodb, express, mongoose

假设我有以下文件：

```
{
  title: 'Some title',
  items: [1,5,9,4]
}

{
  title: 'Some title',
  items: [5,7]
}

{
   title: 'Some title',
   items: [1,2]
} 
```

我需要获取项目有 5 的文档。所以我在猫鼬中进行了以下查询：

```
Model.find({items: {$in: [5]}}, function (err, docs) {
   // docs.length == 2
}); 
```

我明白了。但是我发现如果我进行以下查询，那么我会得到相同的结果：

```
Model.find({items: 5}, function (err, docs){
   // docs.length == 2
}); 
```

在我的案例中使用第二种方法查找文档是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:17:10.127

`$in`当您要查找`items`包含一组值中的任何一个的文档时使用；如果您想要`items`包含特定值的文档，请使用简单的查询对象，例如`{items: 5}`.

因此，正如您所发现的，虽然您可以使用`$in`匹配单个值，但它更自然地表示为`Model.find({items: 5}, ...);`

# sql-server - 如何在列侧获取行数据

> ID：12980705
> 
> 赞同：0
> 
> 时间：2012-10-19T18:56:25.400
> 
> 标签：sql-server, sql-server-2008

我有一个员工表，其工资按年数如下：

```
Employee_table
-----------------------------------------------------------------------------
emp_ID -  FirstName- LstName   salary  ...    year -  
001   -   xx     -     yy   -   03212         2000       
001   -   xx     -     yy   -   04212         2001        
002   -   xxx     -    yyy  -   03425         2000         
002   -   xxx     -    yyy  -   04425         2001          
003   -   xxxx    -    yyyy  -  03429         2000         
003   -   xxxx   -     yyyy  -  04429         2001         
------------------------------------------------------------------------------ 
```

我想编写一个查询，它将在列侧为我提供带有年份的员工数据：

```
tblResults
---------------------------------------------------------------------
emp_ID   2000       2001          ....     ....            
---------------------------------------------------------------------
01        03212     04212   
02        03425   - 04425    
03        03429     04429 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:16:28.360

好的，正如@SpectralGhost 所说，您可以使用`PIVOT`. 如果您事先知道需要多少年，那么您可以这样做：

```
SELECT *
FROM (  SELECT emp_ID, salary, [year]
        FROM Employee_Table) AS ET
PIVOT(MIN(salary) FOR [year] IN ([2000],[2001],[2002])) AS PT 
```

如果您不知道有多少年，那么您将需要动态 sql（所以首先，请转到[此链接](http://www.sommarskog.se/dynamic_sql.html)）。然后试试这个：

```
DECLARE @Years NVARCHAR(MAX), @Query NVARCHAR(MAX)

SELECT @Years = STUFF(( SELECT DISTINCT ',' + QUOTENAME([year]) 
                        FROM Employee_Table
                        FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'),1,1,'')

SET @Query = '
SELECT *
FROM (  SELECT emp_ID, salary, [year]
        FROM Employee_Table) AS ET
PIVOT(MIN(salary) FOR [year] IN ('+@Years+')) AS PT'

EXEC(@Query) 
```

# javascript - 未捕获的类型错误：对象函数 (a,b) - Javascript

> ID：12980706
> 
> 赞同：1
> 
> 时间：2012-10-19T18:56:29.257
> 
> 标签：javascript, jquery

在使用名为“Fallr”的模态覆盖 jquery 插件时，我在 Chrome 的控制台中收到以下错误。

> 对象函数 (a,b){return new e.fn.init(a,b,h)} 没有方法 'fallr'

它引用了我拥有的另一个利用 Fallr 框架的 .js 文件的第 43 行，下面是该行之前、期间和之后的几行。第 43 行是第一个实例`$.fallr('show', {`

```
$.ajax({
    type: "POST",
    url: "insert.php",
    data: dataString,
    dataType: 'json',
    success: function(output) {
        if (output.return_val === 1) {
            $.fallr('show', {
                buttons: {},
                content: '<h4>Yay!</h4><p>Your link has successfully been shared.</p>',
                position: 'center',
                autoclose: 3000,
                icon: 'check'
            });

        } else {

            $.fallr('show', {
                buttons: {},
                content: '<h4>Oops!</h4><p>Your link was not posted.</p>',
                position: 'center',
                autoclose: 3000,
                icon: 'error'
            });

        }
    }
});
return false;
});
});​
​ 
```

我该如何解决这个错误？它导致我页面上所有按钮的时间顺序问题，一旦按下某些其他按钮，Fallr 方法就会停止触发一个或两个按钮。

# iphone - UISwipeGestureRecognizer 使应用程序崩溃更改屏幕？

> ID：12980711
> 
> 赞同：0
> 
> 时间：2012-10-19T18:56:42.077
> 
> 标签：iphone, ios, xcode, ipad

我有一个简单的 3 页应用程序，我可以从第 1 页到第 2 页向左滑动。

但是，当我在第 2 页时，我需要添加向右滑动到第 1 页或向左滑动到第 3 页的功能，但它只是不断崩溃。

我怀疑这可能是内存释放问题，但我想知道您是否可以检查下面的代码是否有任何明显的错误？

非常感谢，

```
- (void)viewDidLoad {

    UISwipeGestureRecognizer *swipeLeftRight = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleGesture:)];
    [swipeLeftRight setDirection:(UISwipeGestureRecognizerDirectionRight | UISwipeGestureRecognizerDirectionLeft )];
    [self.view addGestureRecognizer:swipeLeftRight];
    [UISwipeGestureRecognizer release];

}

- (IBAction)swipeLeftDetected:(UISwipeGestureRecognizer *)sender {

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad){
        Page3ViewController *UIViewController =
        [[Page3ViewController alloc] initWithNibName:@"Page3ViewController~ipad" bundle:nil];
        [self presentModalViewController:UIViewController animated:YES];
          [Page2ViewController release];
    }else{

        Page3ViewController *UIViewController =
        [[Page3ViewController alloc] initWithNibName:@"Page3ViewController" bundle:nil];
        [self presentModalViewController:UIViewController animated:YES];
        [Page2ViewController release];
    }

        }

- (IBAction)swipeRightDetected:(UISwipeGestureRecognizer *)sender {

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad){
        ViewController *UIViewController =
        [[ViewController alloc] initWithNibName:@"ViewController_iPad" bundle:nil];
        [self presentModalViewController:UIViewController animated:YES];

        [Page2ViewController release];

    }else{

        ViewController *UIViewController =
        [[ViewController alloc] initWithNibName:@"ViewController_iPhone" bundle:nil];
        [self presentModalViewController:UIViewController animated:YES];

        ViewController *VC = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
        [self presentModalViewController:VC animated:YES];

        [Page2ViewController release];

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:04:04.047

编辑：

您需要实现一个名为的方法，`handleGesture:`因为这是您传递给手势识别器的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T01:24:34.460

已修复，我发现了一个叫 rptwsthi 的人的旧帖子，我用其中的一些来修复它；

改变了 viewDidLoad {

```
 UISwipeGestureRecognizer *rightRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(rightSwipeHandle:)];
    rightRecognizer.direction = UISwipeGestureRecognizerDirectionRight;
    [rightRecognizer setNumberOfTouchesRequired:1];
    [self.view addGestureRecognizer:rightRecognizer];
    [rightRecognizer release];

    //........towards left Gesture recogniser for swiping.....//
    UISwipeGestureRecognizer *leftRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(leftSwipeHandle:)];
    leftRecognizer.direction = UISwipeGestureRecognizerDirectionLeft;
    [leftRecognizer setNumberOfTouchesRequired:1];
    [self.view addGestureRecognizer:leftRecognizer];
    [leftRecognizer release]; 
```

并使用它来切换页面；

```
- (void)rightSwipeHandle:(UISwipeGestureRecognizer*)gestureRecognizer
{
    //Do moving

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad){
        ViewController *UIViewController =
        [[ViewController alloc] initWithNibName:@"ViewController_iPad" bundle:nil];
        [self presentModalViewController:UIViewController animated:YES];

        [Page2ViewController release];

    }else{

        ViewController *UIViewController =
        [[ViewController alloc] initWithNibName:@"ViewController_iPhone" bundle:nil];
        [self presentModalViewController:UIViewController animated:YES];

        ViewController *VC = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
        [self presentModalViewController:VC animated:YES];

        [Page2ViewController release];

    }
}

- (void)leftSwipeHandle:(UISwipeGestureRecognizer*)gestureRecognizer
{
    // do moving

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad){
        Page3ViewController *UIViewController =
        [[Page3ViewController alloc] initWithNibName:@"Page3ViewController~ipad" bundle:nil];
        [self presentModalViewController:UIViewController animated:YES];

    }else{

        Page3ViewController *UIViewController =
        [[Page3ViewController alloc] initWithNibName:@"Page3ViewController" bundle:nil];
        [self presentModalViewController:UIViewController animated:YES];

    }

} 
```

不确定在真正的编码人员看来它有多整洁，但它确实有效，有时你只需要选择正确的方法！:)

# c# - 在任务中捕获异常的最佳方法是什么？

> ID：12980712
> 
> 赞同：87
> 
> 时间：2012-10-19T18:56:46.540
> 
> 标签：c#, .net, task-parallel-library

使用`System.Threading.Tasks.Task<TResult>`，我必须管理可能引发的异常。我正在寻找最好的方法来做到这一点。到目前为止，我已经创建了一个基类来管理调用中所有未捕获的异常`.ContinueWith(...)`

我想知道是否有更好的方法来做到这一点。或者即使这是一个很好的方法。

```
public class BaseClass
{
    protected void ExecuteIfTaskIsNotFaulted<T>(Task<T> e, Action action)
    {
        if (!e.IsFaulted) { action(); }
        else
        {
            Dispatcher.CurrentDispatcher.BeginInvoke(new Action(() =>
            {
                /* I display a window explaining the error in the GUI 
                 * and I log the error.
                 */
                this.Handle.Error(e.Exception);
            }));            
        }
    }
}   

public class ChildClass : BaseClass
{
    public void DoItInAThread()
    {
        var context = TaskScheduler.FromCurrentSynchronizationContext();
        Task.Factory.StartNew<StateObject>(() => this.Action())
                    .ContinueWith(e => this.ContinuedAction(e), context);
    }

    private void ContinuedAction(Task<StateObject> e)
    {
        this.ExecuteIfTaskIsNotFaulted(e, () =>
        {
            /* The action to execute 
             * I do stuff with e.Result
             */

        });        
    }
} 
```

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2012-10-19T19:25:07.900

有两种方法可以做到这一点，具体取决于您使用的语言版本。

# C# 5.0 及以上

您可以使用[`async`](https://msdn.microsoft.com/en-us/library/hh156513.aspx)and[`await`](https://msdn.microsoft.com/en-us/library/hh156528.aspx)关键字来为您简化很多工作。

`async`并被`await`引入语言中以简化使用[Task Parallel Library](https://msdn.microsoft.com/en-us/library/dd460717(v=vs.110).aspx)，使您不必使用[`ContinueWith`](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.continuewith.aspx)并允许您继续以自上而下的方式进行编程。

因此，您可以简单地使用[`try`/`catch`](https://msdn.microsoft.com/en-us/library/0yd65esw.aspx)块来捕获异常，如下所示：

```
try
{
    // Start the task.
    var task = Task.Factory.StartNew<StateObject>(() => { /* action */ });

    // Await the task.
    await task;
}
catch (Exception e)
{
    // Perform cleanup here.
} 
```

请注意，封装上述方法的方法*必须*使用已`async`应用关键字，以便您可以使用`await`.

# C# 4.0 及以下

[您可以使用从枚举](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskcontinuationoptions.aspx)中获取值的[`ContinueWith`重载](http://msdn.microsoft.com/en-us/library/hh194741.aspx)来处理异常，如下所示：[`TaskContinuationOptions`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskcontinuationoptions.aspx)

```
// Get the task.
var task = Task.Factory.StartNew<StateObject>(() => { /* action */ });

// For error handling.
task.ContinueWith(t => { /* error handling */ }, context,
    TaskContinuationOptions.OnlyOnFaulted); 
```

`OnlyOnFaulted`枚举成员`TaskContinuationOptions`表示只有在前面的任务抛出异常*时才应该执行继续。*

当然，您可以多次调用`ContinueWith`关闭同一个先行词，处理非异常情况：

```
// Get the task.
var task = new Task<StateObject>(() => { /* action */ });

// For error handling.
task.ContinueWith(t => { /* error handling */ }, context, 
    TaskContinuationOptions.OnlyOnFaulted);

// If it succeeded.
task.ContinueWith(t => { /* on success */ }, context,
    TaskContinuationOptions.OnlyOnRanToCompletion);

// Run task.
task.Start(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-12-03T12:05:12.970

您可以创建一些自定义任务工厂，它将生成嵌入了异常处理处理的任务。像这样的东西：

```
using System;
using System.Threading.Tasks;

class FaFTaskFactory
{
    public static Task StartNew(Action action)
    {
        return Task.Factory.StartNew(action).ContinueWith(
            c =>
            {
                AggregateException exception = c.Exception;

                // Your Exception Handling Code
            },
            TaskContinuationOptions.OnlyOnFaulted | TaskContinuationOptions.ExecuteSynchronously
        ).ContinueWith(
            c =>
            {
                // Your task accomplishing Code
            },
            TaskContinuationOptions.OnlyOnRanToCompletion | TaskContinuationOptions.ExecuteSynchronously
        );
    }

    public static Task StartNew(Action action, Action<Task> exception_handler, Action<Task> completion_handler)
    {
        return Task.Factory.StartNew(action).ContinueWith(
            exception_handler,
            TaskContinuationOptions.OnlyOnFaulted | TaskContinuationOptions.ExecuteSynchronously
        ).ContinueWith(
            completion_handler,
            TaskContinuationOptions.OnlyOnRanToCompletion | TaskContinuationOptions.ExecuteSynchronously
        );
    }
}; 
```

您可以在客户端代码中忘记从该工厂生成的任务的异常处理。同时，您仍然可以等待此类任务的完成或以“即发即弃”的方式使用它们：

```
var task1 = FaFTaskFactory.StartNew( () => { throw new NullReferenceException(); } );
var task2 = FaFTaskFactory.StartNew( () => { throw new NullReferenceException(); },
                                      c => {    Console.WriteLine("Exception!"); },
                                      c => {    Console.WriteLine("Success!"  ); } );

task1.Wait(); // You can omit this
task2.Wait(); // You can omit this 
```

但老实说，我不确定你为什么想要完成处理代码。无论如何，此决定取决于您的应用程序的逻辑。

# ios - iOS 上的 Safari 在 POST 数据中发送“缓存”表单输入

> ID：12980714
> 
> 赞同：3
> 
> 时间：2012-10-19T18:56:57.337
> 
> 标签：ios, post, safari

我遇到了这样一种情况，即 iOS 6 上的 Safari（尚未测试早期版本）正在发送 POST 数据中的值，这些值在当前页面中不作为表单输入存在，但在以前的 POST 中发送到相同的 URL。

这是场景：

1.  用户被发送到带有一些查询参数的登录页面的 URL，比方说`/login?x=1,y=2`
2.  用户输入了不正确的凭据，再次显示登录页面`x`并`y`作为隐藏输入嵌入到表单中。
3.  用户点击 Safari 中的“返回”按钮，该按钮 GETs `/login`。`x`和的值`y`现在已丢失，并且不包含在隐藏表单输入中。
4.  用户再次输入了错误的凭据，这就是奇怪的地方。通过的 POST 数据包含用户刚刚输入的用户名和密码，**以及**之前提交的`x`, 但不是的值`y`。在这个特定的 Web 应用程序中，`x`没有出现`y`对于这个特定的 POST 来说是一个无效状态并导致错误。

我已经验证 Safari 实际上是在执行 GET，而不是在步骤 3 中使用页面的缓存版本。

对于它的价值，我将 Cache-Control 响应标头设置为`no-cache, no-store, must-revalidate`

**更新：**我继续向 Apple 提交了一个错误，以确保他们知道这一点。如果我收到任何反馈，我会在这里发布。

# sql - 在 SQL 中创建表时，如何设置属性不为空？

> ID：12980715
> 
> 赞同：2
> 
> 时间：2012-10-19T18:57:02.560
> 
> 标签：sql, null

我想在 SQL 中创建一个表，如果我想将属性设置为 NULL，我该怎么做？例如，我想创建一个名为 Courses 的表，其属性“CourseNo”和“Title”不能为空。我在下面创建了一个：

```
CREATE TABLE Courses(
    CourseNo INTEGER CHECK(100<=CourseNo<=999) PRIMARY KEY,
    Title VARCHAR(100),
    )

ALTER TABLE Courses
ALTER COLUMN CourseNo INTEGER NOT NULL
ALTER COLUMN Title VARCHAR(100) NOT NULL 
```

它是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:01:29.923

将其更改`Title VARCHAR(100)`为`Title VARCHAR(100) NOT NULL`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:05:26.723

无论您写什么，一个正确但良好的做法是`not null`在定义表时编写。
这样做：

```
CREATE TABLE Courses(
    CourseNo INTEGER CHECK(100<=CourseNo<=999) PRIMARY KEY,
    Title VARCHAR(100) NOT NULL,
    ) 
```

默认情况下，主键`NOT NULL`始终是主键，因此您无需将其声明为`NOT NULL`

`NOT NULL`当您想稍后更改表的列定义时使用 in alter

# c++ - 创建字符串的共享内存向量

> ID：12980716
> 
> 赞同：9
> 
> 时间：2012-10-19T18:57:05.670
> 
> 标签：c++, boost, shared-memory, boost-interprocess

我正在尝试创建一个管理（std）字符串的共享内存向量的类。

```
typedef boost::interprocess::allocator<std::string, boost::interprocess::managed_shared_memory::segment_manager> shmem_allocator;
typedef boost::interprocess::vector<std::string, shmem_allocator> shmem_vector;

shmem_mgr::shmem_mgr() :
    shmem_(create_only, SHMEM_KEY, SHMEM_SIZE),
    allocator_(shmem_.get_segment_manager())
{
    mutex_  = shmem_.find_or_construct<interprocess_mutex>(SHMEM_MUTEX)();
    condition_ = shmem_.find_or_construct<interprocess_condition>(SHMEM_CONDITION)();
    //buffer_ is of type shmem_vector
    buffer_  = shmem_.construct<shmem_vector>(SHMEM_BUFFER_KEY)(allocator_);
}

void shmem_mgr::run() {
    running_ = true;

    while(running_) {
        scoped_lock<interprocess_mutex> lock ( *mutex_ );

        int size = buffer_->size();

        log_.debug() << size << " queued request(s) found" << std::endl; //LINE 27
        for(int i=0; i<size; i++) {
            log_.debug() << buffer_->at(i); // at() crashes my app
        }

        buffer_->clear(); //so does clear()
        condition_->wait (lock);
    }
} 
```

客户端成功将一个字符串添加到向量中（它也成功地从缓冲区中读取该字符串进行调试），管理器（上面的代码）接收到信号（条件变量），写入向量中有一个字符串（第 27 行)，但是当它试图通过`at()`应用程序获取该字符串时会崩溃。

* * *

**编辑：**我已经想通了，使用`std::string`是不可能的，`string`boost ipc 中有一个容器专门用于这种情况。这并没有改变我需要一个 (boost/std) 字符串向量的事实......

* * *

**问**：**如何跨共享内存传递字符串？**我需要将它们存储在 shmem 中的某个缓冲区（一次能够存储 >1 个）中，然后在第二个进程中获取 - 这就是要求。输入总是`std::string`如此，输出也是，但 shmem 中的内部表示可能不同。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-24T01:57:41.523

从[文档](http://www.boost.org/doc/libs/1_50_0/doc/html/interprocess/allocators_containers.html#interprocess.allocators_containers.containers_explained.where_allocate)。

```
#include <boost/interprocess/managed_shared_memory.hpp>
#include <boost/interprocess/containers/vector.hpp>
#include <boost/interprocess/containers/string.hpp>
#include <boost/interprocess/allocators/allocator.hpp>

int main ()
{
   using namespace boost::interprocess;
   //Typedefs
   typedef allocator<char, managed_shared_memory::segment_manager>
      CharAllocator;
   typedef basic_string<char, std::char_traits<char>, CharAllocator>
      MyShmString;
   typedef allocator<MyShmString, managed_shared_memory::segment_manager>
      StringAllocator;
   typedef vector<MyShmString, StringAllocator>
      MyShmStringVector;

   //Open shared memory
   //Remove shared memory on construction and destruction
   struct shm_remove
   {
      shm_remove() { shared_memory_object::remove("MySharedMemory"); }
      ~shm_remove(){ shared_memory_object::remove("MySharedMemory"); }
   } remover;

   managed_shared_memory shm(create_only, "MySharedMemory", 10000);

   //Create allocators
   CharAllocator     charallocator  (shm.get_segment_manager());
   StringAllocator   stringallocator(shm.get_segment_manager());

   //This string is in only in this process (the pointer pointing to the
   //buffer that will hold the text is not in shared memory).
   //But the buffer that will hold "this is my text" is allocated from
   //shared memory
   MyShmString mystring(charallocator);
   mystring = "this is my text";

   //This vector is only in this process (the pointer pointing to the
   //buffer that will hold the MyShmString-s is not in shared memory).
   //But the buffer that will hold 10 MyShmString-s is allocated from
   //shared memory using StringAllocator. Since strings use a shared
   //memory allocator (CharAllocator) the 10 buffers that hold
   //"this is my text" text are also in shared memory.
   MyShmStringVector myvector(stringallocator);
   myvector.insert(myvector.begin(), 10, mystring);

   //This vector is fully constructed in shared memory. All pointers
   //buffers are constructed in the same shared memory segment
   //This vector can be safely accessed from other processes.
   MyShmStringVector *myshmvector =
      shm.construct<MyShmStringVector>("myshmvector")(stringallocator);
   myshmvector->insert(myshmvector->begin(), 10, mystring);

   //Destroy vector. This will free all strings that the vector contains
   shm.destroy_ptr(myshmvector);
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T22:52:37.150

您需要为您的可共享 stl 类定制分配器。您需要在分配器中定义一个基于自身的指针（ACE 和 boost 有这些）。在相对的两侧，（CONTIGUOUS）共享内存通常位于不同的地址。您还需要一个共享内存分配子系统（堆管理器）（分配器从中分配） - 所有非平凡的低级代码，但绝对是可行的，一旦你拥有它，它就可以在任何地方使用。如果你做了所有这些，你只需要传递非平面结构的位移（从（CONTIGUOUS !!）堆区域的开头）。

您可以创建队列以及您可能想要的所有其他内容 - 前提是对象中的“指针”是基于自身的，并且非平面部分中的不连续部分来自一个大的连续部分。

您不能使用 std::string ，因为除非您控制分配，否则标准字符串中的内存与您的共享内存无关 - 与任何其他 stl 结构相同

也必须（像往常一样）解决/同意所有权问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T09:22:21.427

您可以使用 boost::interprocess::managed_shared_memory。以下程序在 2 个进程之间传递 boost::interprocess::string。在我的机器（Ubuntu Linux）上运行良好。您可以使用 managed_shared_memory 传递向量或对象。boost::interprocess::string 有一个 c_str() 方法。

```
#include <boost/interprocess/managed_shared_memory.hpp>
#include <boost/interprocess/allocators/allocator.hpp>
#include <boost/interprocess/containers/string.hpp>
#include <cstring>
#include <cstdlib>
#include <string>
#include <iostream>

int main(int argc, char *argv[])
{
  using namespace boost::interprocess;
  typedef boost::interprocess::allocator<char, boost::interprocess::managed_shared_memory::segment_manager> CharAllocator;
  typedef boost::interprocess::basic_string<char, std::char_traits<char>, CharAllocator> string;
  if(argc == 1){  //Parent process

      boost::interprocess::shared_memory_object::remove("MySharedMemory");

      //Create a shared memory object.
      managed_shared_memory shm (create_only, "MySharedMemory", 1024);

      string *s = shm.find_or_construct<string>("String")("Hello!", shm.get_segment_manager());
      std::cout << *s << std::endl;

      //Launch child process
      std::string s1(argv[0]); s1 += " child ";
      if(0 != std::system(s1.c_str()))
         return 1;
  }
  else{
      //Open already created shared memory object.
      managed_shared_memory shm (open_only, "MySharedMemory");
      std::pair<string *,std::size_t> ret = shm.find<string>("String");
      std::cout << *(ret.first) << std::endl;
  }
  return 0;
} 
```

# magento - Magento - 获取产品集合的结果视图 HTML

> ID：12980721
> 
> 赞同：4
> 
> 时间：2012-10-19T18:57:31.800
> 
> 标签：magento

我从 Web 服务中获取了 magento id 列表。我将这些加载到和数组`$product_ids`中，所以我有这样的东西：

```
Array
(
    [0] => 1965
    [1] => 3371
    [2] => 1052
) 
```

然后我可以把它变成一个集合：

```
$collection = Mage::getModel('catalog/product')->getCollection()
            ->addIdFilter($product_ids); 
```

使用我的 Magento 检查器，我看到类别页面使用类[`Mage_Catalog_Block_Product_List`](http://docs.magentocommerce.com/Mage_Core/Mage_Core_Block_Abstract.html)来显示产品列表。我想在课堂上做类似的事情。我试过加载：

```
$ProductList = new Mage_Catalog_Block_Product_List();
$ProductList->setCollection($collection); 
```

然后我尝试加载结果的 HTML，如下所示：

```
$CollectionHTML = $ProductList->_toHtml(); 
```

但是`$CollectionHTML`是空的。

我将如何获得您在列表视图中看到的 HTML（即前端/base/default/template/catalog/product/list.phtml 的生成输出，但给定我的集合）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T22:30:47.093

在 Magento 中让代码以正确的方式工作比尝试使用丑陋的遗留代码要容易得多。当您有具体问题时，我很乐意帮助您以正确的方式编写代码。此外，从长远来看，技术债务的成本会更高。

无论如何，回到你的问题。

在 Magento 中，块不像在任何应用程序中那样被实例化`$myvar = new className`......几乎从不。[本教程](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-4-magento-layouts-blocks-and-templates)可以帮助您更好地理解 Magento 的布局和块。

但是，如果您想创建一个块，一种方法是：

```
$block = Mage::getSingleton('core/layout')->createBlock('catalog/product_list') 
```

现在与您的产品集合相关，您应该检查`Mage_Catalog_Block_Product_List::_getProductCollection`实际工作方式，因为它使用分层导航，而不是简单的产品集合。

此外，假设至少您正在使用 Magento 控制器并且您在一个函数中，以下代码将显示指定类别的产品的第一页：

```
//$category_id needs to be set
$layout = Mage::getSingleton('core/layout');
$toolbar = $layout->createBlock('catalog/product_list_toolbar');
$block = $layout->createBlock('catalog/product_list');
$block->setChild('toolbar', $toolbar);
$block->setCategoryId($category_id);
$block->setTemplate('catalog/product/list.phtml');  
$collection = $block->getLoadedProductCollection();
$toolbar->setCollection($collection);
//render block object 
echo $block->renderView(); 
```

显示特定 ID：

*   您将根类别 ID 用于 $category_id 变量（还要确保设置了显示根类别（或包含您的产品 ID 的另一个类别 ID）
*   您可以挂钩`catalog_block_product_list_collection`事件以将您的 ID 过滤器添加到集合中（这在`_beforeToHtml`函数中调用）

但是，所有这些结构并不牢固，还有一些需要注意的地方（其他子块、过滤器等）

# html - 使用flexie在与IE兼容的容器中并排Div

> ID：12980725
> 
> 赞同：0
> 
> 时间：2012-10-19T18:57:44.153
> 
> 标签：html, internet-explorer, google-chrome, css

我目前正在开发一个 css3/html5 项目。由于我之前提出的一个问题，它在 chrome 中完美运行，并且建议使用 flexie（[http://flexiejs.com/](http://flexiejs.com/)）的答案，但在 IE 中甚至没有关闭。下面是它在 Chrome 中的外观屏幕。

![谷歌浏览器截图](../Images/428561ad392c921f0c19841cd716e46e.png)

在 IE 中它看起来像下面

![IE截图](../Images/4e75b1f38a3cdb4270c3b8b643377bc3.png)

如果有帮助，我已将代码添加到[http://jsfiddle.net/Ax6Xr/ 。](http://jsfiddle.net/Ax6Xr/)

我已经添加了下面的 CSS，因为由于某种原因，stackoverflow 不允许我在不发布一些代码的情况下提交，这似乎有点毫无意义，因为我已经链接到 jsfiddle。

```
html, body
{
    padding: 0;
    margin: 0;
    height: 100%;
}

#wrapper
{
    display: -webkit-box;
    -webkit-box-orient: vertical;
    min-height: 100%;
    background-color: purple;
    width: 100%;
    margin-top: 0px;
}

header
{
    width: 100%;
    height: 80px;
    background-color: black;
    color: white;
}

#articleContainer {
    width: 75%;
    margin: auto;
    background-color: blue;
    display: -webkit-box;
    -webkit-box-flex: 1;
}

#articleContent
{
    width: 70%;
    background-color: yellow;
}

#articleSideBar
{
    position: relative;
    width: 28%;
    background-color: green;
    margin-left: 2px;
    margin-right: 2px;
    display: inline;
    margin-top: 0px;
    height: auto;
} 
```

下面是HTML

```
<html>
    <head>
        <title>index</title>
        <link href="ArticleStyleSheet.css" rel="stylesheet" type="text/css" />
        <script src="../scripts/flexie.js" type="text/javascript"></script>
    </head>
    <body>
        <div id="wrapper">
            <header>
                Header
            </header>
            <div id="articleContainer">

                <div id="articleContent" contenteditable>
                    The quick brown fox jumped over the lazy dogs back. All good men must come to the aid of the party
                </div>

                <div id="articleSidebar">
                    Article Sidebar
                </div>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:40:07.293

Flexie 寻找非供应商前缀的属性。例如，它将忽略 -moz-box-pack，但不会忽略 box-pack。为获得最佳结果，请确保在您的前缀属性之外使用非供应商前缀属性。尝试添加：*显示：框；盒子弹性：1；...*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:02:18.097

IE 还不兼容 HTML5。我相信IE10会。

# javascript - jquery/js 运行超过 2000 行时速度太慢

> ID：12980727
> 
> 赞同：2
> 
> 时间：2012-10-19T18:57:45.727
> 
> 标签：javascript, optimization

我有2000行数据如下

```
<div class="rr cf">
    <span>VLKN DR EXP</span>
    <span>01046</span>
    <span>VELANKANNI</span>
    <span>20:30</span>
    <span>DADAR</span>
    <span>10:00</span>
</div> 
```

单击按钮时，我正在检查其中的文本并将每行的显示更新为`block`或`none`。执行此操作的代码是

```
$('.rr').each(function(){
    this.style.display="block";
});

var nodes = $(".rr");
for(var i=0;i < nodes.length; i++) {
     // if data found
         nodes.get(i).style.display="block";
     // else
         nodes.get(i).style.display="none";
} 
```

这似乎可能非常缓慢。我得到 chrome 警告框来杀死页面。

有任何想法吗？我可以在这里做什么优化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:03:26.620

**局部变量和循环**

* * *

> 另一种提高循环性能的简单方法是将迭代器向 0 递减，而不是向总长度递增。根据每次迭代的复杂性，进行这个简单的更改可以节省高达 **50% 的原始执行时间。**

取自：http: [//oreilly.com/server-administration/excerpts/even-faster-websites/writing-efficient-javascript.html](http://oreilly.com/server-administration/excerpts/even-faster-websites/writing-efficient-javascript.html)

*   尝试将 保存`nodes.length`为**局部变量**，这样循环就不必每次都计算它。
*   此外，`nodes.get(i)`如果您经常访问该数据，您可以将其存储到局部变量中以节省一些时间。
*   如果**顺序不重要**，请考虑将 for 循环**递减****到 0**。
*   jQuery 的`each()`循环**也**比自己循环遍历集合要慢一些。你可以看到**[这里](http://jsperf.com/jquery-each-vs-for-loop/148)**有一个明显的区别。

非常简单的**[例子](http://jsfiddle.net/r4zx8/)**

您会在我的示例中看到，我将循环压缩为一个`while`循环：

```
var nodes = $(".rr span");
var i = nodes.length;

while(i--){ 
  if(i%2 === 0){
    nodes.get(i).style.color = "blue";}
}​ 
```

请注意，循环在每次迭代中`while`递减。`i`这样，当 时`i = 0`，循环将退出，因为`while(0)`计算结果为`false`。

* * *

**“分块”阵列**

* * *

> chunk() 函数旨在**处理小块中的数组** （因此得名），并接受三个参数：“待办事项”列表， **处理每个项目的函数****，**以及用于设置值的可选上下文 **变量在 process() 函数**中。计时器用于延迟每个项目的处理（在这种情况下为 100 毫秒，但可以根据您的具体用途随意更改）。每次通过时，数组中的第一项**都会被删除并传递给 process() 函数**。如果还有待处理的项目，则使用另一个计时器**重复该过程**。

 ******看看[这里定义的](http://www.nczonline.net/blog/2009/01/13/speed-up-your-javascript-part-1/)**Nick Zakas**的`chunk`方法，如果您需要分段运行循环以减少浏览器崩溃的机会：

```
function chunk(array, process, context){
    setTimeout(function(){
        var item = array.shift();
        process.call(context, item);

        if (array.length > 0){
            setTimeout(arguments.callee, 100);
        }
    }, 100);
} 
```

* * *

**使用[createDocumentFragment()](https://developer.mozilla.org/en-US/docs/DOM/document.createDocumentFragment)**

* * *

> 由于文档片段在内存中而不是主 DOM 树的一部分，因此将子片段附加到它不会导致页面重排（计算元素的位置和几何形状）。**因此，使用文档片段通常会带来更好的性能。**
> 
> **所有浏览器**都支持 DocumentFragment ，甚至 Internet Explorer 6，因此没有理由不使用它们。
> 
> [回流](https://developer.mozilla.org/en-US/docs/Notes_on_HTML_Reflow)是计算布局引擎格式化对象的几何形状的过程。

由于您正在迭代地更改这些元素的显示属性，因此页面必须为每次更改“重新绘制”窗口。如果您`createDocumentFragment`在那里使用并进行所有更改，然后将它们推送到 DOM，您将大大减少`repainting`必要的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:06:08.257

首先，延迟发生在哪里——在 jquery 代码中，还是在数据检查中？如果是 jquery，您可以尝试从 DOM 中分离数据容器元素（即包含所有 .rr div 的 html 元素），进行更改，然后重新附加它。这将停止浏览器在每次更改后重新处理 DOM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:06:46.207

我会尝试

1) 将所有这些 div 的公共父元素的显示设置为“无”

2）循环遍历div，适当设置显示

3）将父元素显示设置回块

我相信这会有所帮助，因为它让浏览器有机会聚合渲染更新，而不是在每次更改显示属性时强制它完全完成。如果不显示父节点，则所有子节点的可见性都无关紧要，因此浏览器不再需要在每个子节点中呈现更改，直到父节点再次可见。

另外，我看不到您首先循环遍历它们并将它们全部设置为阻塞，然后再次循环并将它们设置为预期值的目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:09:53.220

不要在这里使用 jQuery，jQuery 只会在这里减慢速度。

```
 var elements = document.getElementsByClassName('rr'),
        len = elements.length;

    for(var i = 0; i < len; i++)
    {
        var ele = elements[i];
        if(ele.innerHTML.search(/01046/) != -1)
            ele.style.display = "none";
    } 
```

这应该快得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T09:22:39.507

我在循环大约 1500 个项目时也遇到了性能问题。

正如您可能已经猜到的那样，循环本身并不是瓶颈。问题在于您在其中执行的操作。

所以，我使用 setTimeout 迁移了负载。不是最漂亮的解决方案，但它使浏览器在更新之间做出响应。

```
var _timeout_ = 0;
for(var i=0;i < nodes.length; i++)
{
    setTimeout(
        (function(i)
        {
            return function()
            {
                if(stuff)
                {
                    nodes.get(i).style.display="block";
                }
                else
                {
                    nodes.get(i).style.display="none";
                }
            }
        })(i),
        _timeout_
    );
    _timeout_ += 4;
} 
```

这将使每次更新延迟 4 毫秒，如果操作时间较长，浏览器将变得无响应。如果在您最慢的浏览器上该操作只需要 2 毫秒，您可以将其设置为 3，等等。随便玩玩。******

# css - CSS DropDown Menu：通过二级离开后三级列表不隐藏

> ID：12980737
> 
> 赞同：2
> 
> 时间：2012-10-19T18:58:19.023
> 
> 标签：css, internet-explorer

我对 CSS 下拉菜单有以下标记：

```
<ul>
    <li><a>FieldOne LevelOne</a></li>
    <li><a>FieldTwo LevelOne</a></li>
    <li><a>FieldThree LevelOne</a>
        <ul>
            <li><a>FieldOne LevelTwo</a>
                <ul>
                    <li><a>FieldOne LevelThree</a></li>
                    <li><a>FieldTwo LevelThree</a></li>
                </ul>
            </li>
            <li><a>FieldTwo LevelTwo</a>
                <ul>
                    <li><a>FieldOne LevelOn</a></li>
                </ul>
            </li>
       </ul>
  </ul> 
```

以及以下 CSS：

```
ul ul {
    display: none;
}

ul li {
    list-style: none;
}

ul li:hover > ul {
    display: block;
}

ul
{
    background: #76b800;
    padding: 0 20px;
    margin-left: 5px;
    border-radius: 10px;
    list-style: none;
    position: relative;
    display: inline-table;
}

ul:after {
    content: ""; clear: both; display: block;
}

ul li {
    float: left;
    min-width: 140px;
    text-align: center;
    vertical-align: bottom; 
}

ul li:hover {
    background-color: #4478B7;
}

ul li a
{
    display: block;    
    padding: 10px 40px 10px 40px;
    color: #fff;
    text-decoration: none;
    font-size: 18px;
}

ul ul {
    background: #4478B7; 
    padding: 0;
    position: absolute; 
    top: 100%;
    z-index: 5;
    margin: 0;
}

ul ul li
{
    float: none;
    border-top: 1px solid;
    border-bottom: 1px solid;
    position: relative;
    border-style: solid;
    border-width: 1px;
    border-color: #88AAD2 white #335B8C white;
}

ul ul li:hover
{
    background-color: #396599;
    background-image: none;
}

ul ul li a {
    color: #fff;
    min-width: 140px !important;
    padding: 10px 40px 10px 40px !important;
    font-size: 16px !important;
}   

ul ul li a:hover {
    background: #233F61;
}

ul ul ul {
    position: absolute; 
    left: 100%; 
    top:0;
} 
```

**问题**：当您转到第二级并将鼠标悬停在 LI 上时，会出现第三级列表。如果您在第二级从一个 LI 转到另一个 LI，则嵌套在第一个 LI 内的第三级列表会消失，而嵌套在第二级的列表会出现（如果有的话）。

但

相反，如果您完全离开了二级列表，而没有通过在二级菜单内导航而使三级菜单消失，那么一旦您重新列出二级菜单，最后显示的三级菜单就会出现在旁边它的 LI，但没有内容（没有来自 As 的文本）。列表以样式显示，就好像它们没有被悬停一样。

你可以在这里查看效果：http: [//jsfiddle.net/JE8ZM/](http://jsfiddle.net/JE8ZM/)。如果你在 IE9 或 Chrome 上运行它，它就可以工作。但如果您在 IE7 上运行它，请尝试转到 FieldOne LevelTwo，将鼠标悬停在它上面，然后离开它的左侧，而不进入显示的第三级菜单。然后将鼠标悬停在 FieldThree LevelOne 上，看看我的意思。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:53:21.140

众所周知，如果没有 Javascript 或 jQuery 的帮助，嵌套子导航菜单很难跨浏览器工作。这是我所知道的最好的“纯 CSS”资源，它可以解决您的问题！

[http://www.cssplay.co.uk/menus/final_drop2.html](http://www.cssplay.co.uk/menus/final_drop2.html)

# python - 如何使用代理在 python 中使用 PUT HTTP 方法连接到 REST Web 服务？

> ID：12980740
> 
> 赞同：1
> 
> 时间：2012-10-19T18:58:51.617
> 
> 标签：python, rest, proxy, urllib2, httplib

我有嵌入 python 2.5.2 的*“公司内部工具” 。*这意味着我不能使用任何其他版本或编程语言。因此，HTTPLIB 的代码如下：

```
 connection =  httplib.HTTPSConnection('IP:PORT')
  body_content = '<INPUT><Var1>DATA</Var1></INPUT>/r/n'
  headers = {Authorization':'Basic XXXXXXXXXXXX','Accept':'text/xml','Content-Length':'XX','Host':'host name','Accept-Encoding':'gzip,deflate'}
  connection.request('PUT', '/path/method',body_content, headers)
  result = connection.getresponse() 
```

对于 urllib2 代码如下：

```
 body_content = '<INPUT><Var1>DATA</Var1></INPUT>\r\n'
  opener = urllib2.build_opener(urllib2.HTTPSHandler)
  request = urllib2.Request('https://IP:PORT/path/method', data=body_content)
  request.headers={'Content-length': 'XX', 'Host': 'host', 'Accept': 'text/xml', 'Authorization': 'Basic XXXXXXXXXXXXX', 'Accept-encoding': 'gzip,deflate'}
  request.get_method = lambda: 'PUT'
  url = opener.open(request) 
```

它们都在默认的 python 2.5.2 安装中工作正常。如果我尝试在我得到的工具中使用相同的代码，则会出现以下错误：

HTTPLIB：

```
'module' object has no attribute 'ssl' 
```

URLLIB2：

```
urlopen error unknown url type: https 
```

据我了解，SSL 支持已被删除。顺便说一句：我可以编写自己的库并将它们放置到正确的文件夹中以使它们工作。所以，问题是：如何使用代理连接到网络服务？我找到了以下示例： [http ://www.pha.com.au/kb/index.php/Python_-_Using_a_proxy_for_HTTP_requests](http://www.pha.com.au/kb/index.php/Python_-_Using_a_proxy_for_HTTP_requests)

但在我的情况下它不起作用。你有什么建议可以解决这个问题吗？看起来在python中构建一个单独的代理模块来执行HTTPS查询可以解决这个问题。那么，在这种情况下，连接程序是什么？

# amazon-s3 - 从 ec2 到 s3 的大文件

> ID：12980745
> 
> 赞同：6
> 
> 时间：2012-10-19T18:59:06.710
> 
> 标签：amazon-s3, amazon-ec2, s3cmd

我有一个 27GB 的文件，我正在尝试将它从 AWS Linux EC2 移动到 S3。我已经尝试了“S3put”命令和“S3cmd put”命令。两者都使用测试文件。两者都不适用于大文件。没有给出错误，命令立即返回但没有任何反应。

```
s3cmd put bigfile.tsv s3://bucket/bigfile.tsv 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T23:23:13.703

尽管您可以将最大大小为 5TB 的对象上传到 S3，但 S3 对单个 PUT 操作的大小限制为 5GB。

为了加载大于 5GB 的文件（甚至大于 100MB 的文件），您将需要使用 S3 的分段上传功能。

> [http://docs.amazonwebservices.com/AmazonS3/latest/dev/UploadingObjects.html](http://docs.amazonwebservices.com/AmazonS3/latest/dev/UploadingObjects.html)
> 
> [http://aws.typepad.com/aws/2010/11/amazon-s3-multipart-upload.html](http://aws.typepad.com/aws/2010/11/amazon-s3-multipart-upload.html)

（忽略上述博文中关于 5GB 对象限制的过时描述。当前限制为 5TB。）

Python 的 boto 库支持分段上传，最新的 boto 软件包括一个“s3multiput”命令行工具，可以为您处理复杂性，甚至可以并行化分段上传。

> [https://github.com/boto/boto](https://github.com/boto/boto)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T23:34:52.077

该文件不存在，doh。通过添加 -v 标记以详细模式运行 s3 命​​令后，我意识到了这一点：

```
s3cmd put -v bigfile.tsv s3://bucket/bigfile.tsv 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T17:37:16.840

s3cmd 版本 1.1.0 支持作为“put”命令的一部分的分段上传，但它仍处于测试阶段（目前。）

# cruisecontrol - Fitnesse - 哪个 CI 自动化更适合并行运行 Fitnesse 测试？

> ID：12980746
> 
> 赞同：0
> 
> 时间：2012-10-19T18:59:11.877
> 
> 标签：cruisecontrol, fitnesse

我们正在使用 CruiseControl 运行我们的 CI 循环 - 并且有超过一千个 FitNesse/FitLibrary 测试。至少可以说，这需要一段时间。有些测试必须按顺序运行，但有些可以并行运行（大部分）。有没有人有使用 CruiseControl 配置复杂的 FitNess CI 环境的良好经验？如何？或者 - 让我换个说法 - 在这方面哪个测试自动化控制服务器更好（使用 FitNesse）？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T17:40:00.970

并行运行 FitNesse 服务器的技巧主要是为每次运行保持所有端口分开。因此，每个 FitNesse 服务器都需要使用不同的 -p 参数启动。至于 FitLibrary 部分，如果您确实启动了 FitLibrary 固定装置通过端口与之通信的东西，请确保它们使用不同的。如果您使用的是 SliM，那么至少需要一个端口（SLIM_PORT），您需要为每个并行线程创建不同的敌人。

您可能需要注意的另一件事是从同一源目录启动所有测试。FitNesse 本身应该没有问题，但如果您的固定装置需要处理任何物理文件，这些有时会造成麻烦。如果一个作业正在测试，而另一个作业在 Git/CVS 中启动 svn 更新或类似操作，您也可能在更新文件夹时遇到冲突。

我知道的唯一其他问题是，您正在测试的任何其他库或系统是否会在同时运行多个实例时遇到问题。

我们一直在 Hudson/Jenkins 下运行多个执行线程。每个作业在单独的执行线程中运行。通常使用单独的测试系统来确保与数据库交互的测试不会发生冲突。

如果 CruiseControl 可以并行运行多个构建，它可能也可以运行多个测试。

# jquery - 使用 jquery 调整图像大小 - 延迟和移动

> ID：12980747
> 
> 赞同：0
> 
> 时间：2012-10-19T18:59:37.820
> 
> 标签：jquery, image, resize

```
var hover_effect;
$(document).on("hover", ".card", function (evt) {
    windowWidth = $(window).width();
    var id = $(this).attr('id');
    var offset = $(this).offset();
    var pos = offset.left;

    if (windowWidth - pos < 350) {
        if (evt.type === "mouseenter") {
            hover_effect = setTimeout(function(){
                $('#'+id).css('z-index', '9').animate({
                    marginLeft: '-120',
                    width: '360px',
                    height: '510px'
                }, 300);
            } , 700);
            } 
        else { // mouseleave
            clearTimeout(hover_effect);
            $('#'+id).animate({
                marginLeft: '0',
                width: '240px',
                height: '340px'
            }, 300, function() {
                $('#'+id).css('z-index', '1')
            })
        }
    }
    else if (pos < 260) {
        if (evt.type === "mouseenter") {
            hover_effect = setTimeout(function(){
                $('#'+id).css('z-index', '9').animate({
                    width: '360px',
                    height: '510px'
                }, 300);
            } , 700);
            } 
        else { // mouseleave
            clearTimeout(hover_effect);
            $('#'+id).animate({
                width: '240px',
                height: '340px'
            }, 300, function() {
                $('#'+id).css('z-index', '1')
            })
        }
    }
    else{
        if (evt.type === "mouseenter") {
            hover_effect = setTimeout(function(){
                $('#'+id).css('z-index', '9').animate({
                    marginLeft: '-60',
                    width: '360px',
                    height: '510px'
                }, 300);
            } , 700);
            } 
        else { // mouseleave
            clearTimeout(hover_effect);
            $('#'+id).animate({
                marginLeft: '0',
                width: '240px',
                height: '340px'
            }, 300, function() {
                $('#'+id).css('z-index', '1')
            })
        }
    }
}) 
```

这会检查图像是在页面中间，还是在右侧或左侧，然后相应地将其放大。 `.on`只能返回一个动作，因此`if else`需要返回每个动作。我还使用了回调函数，`.css`这样图像在完全缩小之前不会“变平”。随时查看[http://magic.cardbinder.com/](http://magic.cardbinder.com/)

谢谢戈什！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:02:50.253

我认为它可以以更简单的方式完成。

试试这样的......

[http://jsfiddle.net/35vYZ/](http://jsfiddle.net/35vYZ/)

HTML

```
<div class="wrapper">
<div class="pics"></div>
<div class="pics"></div>
<div class="pics"></div>
<div class="pics"></div>
</div> 
```

CSS

```
.pics {
width: 50px;
height: 50px;
background: blue;
float: left;
margin: 5px;
}
.wrapper {
overflow: auto;
background: green;
float: left;
}​ 
```

jQuery

```
var hover_effect;
$('.pics').hover( function(){
var pics = $(this);
hover_effect = setTimeout(function(){pics.animate({'width' : '60px', 'height' : '60px'}, 300);} , 500);
     }, 
     function(){
         clearTimeout(hover_effect);
         $(this).animate({'width' : '50px', 'height' : '50px'}, {duration: '300', queue: false});
      }); 
```

​</p>

# php - 多对一关联映射到 Doctrine 2 中的类表继承实体

> ID：12980748
> 
> 赞同：1
> 
> 时间：2012-10-19T18:59:48.100
> 
> 标签：php, doctrine, doctrine-orm

我有一个`Author`实体，它是一个包含一个`AuthorUser`和一个的类表继承`AuthorGroup`。

```
/**
 * Author
 *
 * @ORM\Table
 * @ORM\Entity
 * @ORM\InheritanceType("JOINED")
 * @ORM\DiscriminatorColumn(name="type", type="string")
 * @ORM\DiscriminatorMap({"user" = "AuthorUser", "group" = "AuthorGroup"})
 */
class Author {
    // ...
} 
```

`AuthorUser`与我的`User`实体和`AuthorGroup`我的`Group`实体有关。

```
class AuthorUser extends Author
{
    /**
     * @var User
     *
     * @ORM\ManyToOne(targetEntity="User", inversedBy="?????")
     * @ORM\JoinColumn(name="user_id", referencedColumnName="id")
     */
    protected $user;
}

class AuthorGroup extends Author
{
    /**
     * @var Group
     *
     * @ORM\ManyToOne(targetEntity="Group", inversedBy="?????")
     * @ORM\JoinColumn(name="group_id", referencedColumnName="id")
     */
    protected $user;
} 
```

我不知道如何扭转这一点。无论如何，问题是我必须将此 CTI 添加到我的`Article`实体字段中。我如何使用 ManyToOne 与这篇文章实体字段相关联？

```
class Article
{
    /**
     * @var Author
     *
     * @ORM\ManyToOne(targetEntity="Author", inversedBy="?????????")
     * @ORM\JoinColumn(name="author_id", referencedColumnName="id")
     */
    protected $author;
} 
```

我不确定如何使其尽可能透明。当我创建一个新的`Article`时，我需要为该字段提供一个`User`或`Group`对象`author`。我遵循了这种行为，但似乎没有帮助。它变得更加复杂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T09:53:33.290

一种解决方案可能是始终拥有 AuthorGroup，即使只有一位作者。

否则，请查看[https://github.com/FabienPennequin/DoctrineExtensions-Rateable](https://github.com/FabienPennequin/DoctrineExtensions-Rateable)

您也许可以使用该代码来提供类似的 Authored 接口，该接口可以区分 AuthorUser 和 AuthorGroup。

# git - 分支上的 Gitolite 权限

> ID：12980750
> 
> 赞同：11
> 
> 时间：2012-10-19T19:00:16.117
> 
> 标签：git, permissions, gitolite

我在这里真的很茫然。我已经阅读了很多示例，并尝试了所有示例。最基本的工作正常，但每当我尝试转向更复杂的东西时，一切都会崩溃（即使我直接复制示例）。此外，作为记录，我使用的是 gitolite 版本 3，如服务器垃圾邮件所示：

```
 this is gitolite@ubuntuserver running gitolite3 v3.1-2-g3eefc06 on git 1.7.9.5 
```

所有这一切都说明我想要完成的是（我认为）相对简单。我有一群初级开发人员 [@scrubs]，我只希望他们创建和提交新分支，并且能够读取/拉取 master。这样我就可以在合并之前查看他们的代码。

我有一群高级开发人员 [@vets] 我想自由支配。

我的配置文件如下：

```
 @scrubs         = al ted matthew
     @vets           = kevin will guy

     @offlimitbranches = master$

     repo    gitolite-admin
             RW+     =   @vets matthew

     repo    dawebsite
             RW+                     =   @vets
             -   @offlimitbranches   =   @scrubs
             RW+                     =   @scrubs
             R   @offlimitbranches   =   @scrubs
             R                       =   daemon
             option deny-rules = 1

     dawebsite "Owner"               = "This is THE site" 
```

在我添加之前，我注意到否认根本没有任何作用：

```
 option deny-rules = 1 
```

我想我可能在 20 个例子中找到了其中一个（有点咆哮原谅挫败感。

有了这个当前的设置，兽医可以按预期做任何事情。

Scrubs 既不能拉动或推向主分支（我认为这是因为它抓住了它可能匹配的第一条规则？） 磨擦也不能拉动或推向任何非主分支，也不能推新创建的分支。每次尝试都会返回相同的消息“FATAL: [R/W] any dawebsite matthew DENIED by refs/heads/master$”

我尝试使用 master、master$、@offlimitbranches 甚至 refs/heads/master 对分支 ref 无济于事。

如果有人可以帮助我对此有所了解，我将不胜感激。

更新**

玩弄我注意到的东西，如果我从磨砂组中删除马修并尝试直接操纵他

```
 -       master$         =   matthew
    RW+                     =   matthew 
```

如果他搬到一个新的分支并尝试了以下操作：（感谢 VonC 对日志的提醒）

```
git pull origin newBranch
git push origin newBranch 
```

每个返回一个错误

拉：

```
ARGV=matthew    SOC=git-upload-pack 'dawebsite.git'     FROM=172.24.1.198
access(dawebsite, matthew, R, 'any'),-> R any dawebsite matthew DENIED by refs/heads/master$
trigger,Writable,access_1,ACCESS_1,dawebsite,matthew,R,any,R any dawebsite,matthew DENIED by refs/heads/master$
R any dawebsite matthew DENIED by refs/heads/master$<<newline>>(or you mis-spelled the reponame) 
```

推：

```
ARGV=matthew    SOC=git-receive-pack 'dawebsite.git'    FROM=172.24.1.198
access(dawebsite, matthew, W, 'any'),-> W any medehrdev matthew DENIED by refs/heads/master$
trigger,Writable,access_1,ACCESS_1,dawebsite,matthew,W,any,W any dawebsite matthew DENIED by refs/heads/master$
W any dawebsite matthew DENIED by refs/heads/master$<<newline>>(or you mis-spelled the reponame) 
```

似乎我所有的分支都与 ref master$ 匹配，是因为它们都是从 master 产生的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-23T15:39:02.710

我的配置，现在正在工作：

```
@gatekeepers = ustimenko
@developers  = ustimenko user1 user2
@deployers   = puppet

@project     = repo1
@project     = cakephp

repo @project
    RW+                 = @gatekeepers  
    R   master develop  = @developers
    -   master develop  = @developers
    RW+                 = @developers
    R                   = @deployers 
```

* * *

1.  看门人具有完全访问权限。
2.  开发人员可以阅读 master 并开发分支，然后他们拒绝那里的其他操作。
3.  开发人员可以做所有其他事情。
4.  部署者可以阅读所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:11:57.123

嗯，我查看了文档。并在这里尝试过。

**@anything**用于一组用户或其他组。你在那里尝试的不正确。您不能使用**“@”**运算符作为变量符号。[组](http://gitolite.com/gitolite/conf.html#group-definitions)文件

```
repo    dawebsite
    RW+                 =   @vets
    -   branch1         =   @scrubs
    RW+                 =   @scrubs
    R   branch1         =   @scrubs
    R                   =   daemon
    option deny-rules = 1 
```

[Gitolite 权限](http://gitolite.com/gitolite/conf-2.html)

# jquery - 数据绑定到一个选择

> ID：12980751
> 
> 赞同：1
> 
> 时间：2012-10-19T19:00:20.597
> 
> 标签：jquery, select, jquery-mobile, knockout.js

我有一个 jquery 函数从服务中获取所有团队。我如何将它数据绑定到选择框？

```
function GetAvailableTeams() {
        $.support.cors = true; 
        var jqxhr =
        $.getJSON('http://localhost/Service.svc/GetTeamsAll',
          function (data) {
                teamViewModel.clearTeams();
                $.each(data.GetTeamsAllResult, 
                    function (key, val) {
                        teamViewModel.addTeam(val.TeamId, val.TeamName, true);
                    }
              ko.applyBindings(teamViewModel, document.getElementById("teamNameLabel"));
          })
         .success(function () {  })
         .error(function () { alert("Encountered error with the service: GetTeams. "); })
         .complete(function () { });
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:14:17.087

您只需设置选择元素的正确属性，api 将为您完成。

```
<select data-bind="options: ReferenceTypes, optionsText: 'TeamName', 
optionsCaption: 'Select...', optionsValue: 'Id', **value:TeamModel**">
</select> 
```

例如： [knockoutjs 映射选择数据绑定选项](https://stackoverflow.com/questions/9746042/knockoutjs-mapping-select-data-bind-options)

[http://jsfiddle.net/madcapnmckay/Ba5gx/](http://jsfiddle.net/madcapnmckay/Ba5gx/)

# android - 通过 ACTION_SEND 共享：如何使用户的字符串不可变？

> ID：12980756
> 
> 赞同：0
> 
> 时间：2012-10-19T19:00:36.010
> 
> 标签：android, android-intent, immutability, sharing, readonly

有没有办法将字符串移交给 ACTION_SEND 意图，该意图对用户来说是只读的并且不能编辑，只是发送或不发送？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:06:36.090

做不到。

接收方（您无法控制）决定如何处理发送的数据。

根据gameowers评论扩展，如果你想做一些他是对的非常具体的事情，你可能只想将自己的集成编程到FB或Twitter中。

# c++ - 算术 C++ 运算符

> ID：12980757
> 
> 赞同：10
> 
> 时间：2012-10-19T19:00:41.190
> 
> 标签：c++, arithmetic-expressions

我只是在一次技术面试中被问到一个让我有点困惑的问题。

问题如下：

如果

```
int i = -1, int j = -1, and int k = -1, 
```

我们运行以下行：

```
++i && ++j && ++k 
```

i、j 和 k 的新值是多少？我感到困惑的原因是，由于我们没有将这个表达式分配给任何东西，看起来 and 运算符应该没有任何区别（只有增量运算符应该）。然而，运行一个简单的测试程序很快证明我错了。有人可以向我解释一下，因为我以前从未见过这个练习。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-19T19:02:27.130

这里的关键是`&&`短路。

所以，`++i`首先被评估。它递增`i`并返回新值，即`0`，因此不会计算表达式的其余部分。

`0, -1, -1`如果我没记错的话，这些值应该是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:03:40.907

在这种情况下，表达式的值`++i`是`0`false，因此永远不会评估 and 操作快捷方式和后面的表达式。

# wordpress - Wordpress Multisite - 这个网页有一个重定向循环

> ID：12980759
> 
> 赞同：0
> 
> 时间：2012-10-19T19:00:54.633
> 
> 标签：wordpress, redirect, loops

我已经在我的本地主机上安装了一个 Wordpress Multisite，它工作正常，但是当我把它放在服务器上并更改数据库上的所有 URL 内容时，我收到了这个错误：**错误 310 (net::ERR_TOO_MANY_REDIRECTS): There was too many redirects**。

有人知道如何解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T14:18:23.363

问题似乎出在您的 .htaccess 文件中。

如果您已激活多站点，请转到您的网络设置并复制由 wordpress 生成的 .htacces 代码。

将代码粘贴到 .htaccess 中并更新服务器上的文件。

最后刷新你的仪表板并尝试一下！

告诉我这是工作！

# python - mongokit 未找到集合

> ID：12980761
> 
> 赞同：1
> 
> 时间：2012-10-19T19:00:56.963
> 
> 标签：python, mongodb, mongokit

我将 mongokit 与烧瓶一起使用，每次尝试使用我创建的集合时，都会收到错误消息`No collection found`

我在一个单独的文件 models.py 中定义了我的集合。它看起来像这样：

```
from mongokit import Connection, Document
import os
import sys

here = os.path.dirname(os.path.abspath(__file__))
path = os.path.abspath(os.path.join(here, 'settings'))
sys.path.append(path)
from settings import base as settings

connection = Connection()

@connection.register
class Contact(Document):
    __database__ = settings.MONGO_DBNAME
    __collection__ = "Contact"

    structure = {
        "name":unicode,
        "mobile_number":unicode,
    }

    required_fields = ["name"]

@connection.register
class User(Document):
    __database__ = settings.MONGO_DBNAME
    __collection__ = 'User'

    structure = {
        "username":unicode,
        "twitter_access_token":unicode,
        "twitter_token_secret":unicode,
        "contacts":[Contact]
    }
    required_fields = ["username"]
    default_values = {
            "twitter_access_token": "",
            "twitter_token_secret": ""
        } 
```

但后来我尝试了：

```
>>> from models import User
>>> u = User()
>>> u["username"] = "somename"
>>> u.save()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/Users/fernandocezar/.virtualenvs/contacts/lib/python2.7/site-packages/mongokit/document.py", line 404, in save
    self.validate(auto_migrate=False)
  File "/Users/fernandocezar/.virtualenvs/contacts/lib/python2.7/site-packages/mongokit/document.py", line 230, in validate
    (size_limit, size_limit_str) = self._get_size_limit()
  File "/Users/fernandocezar/.virtualenvs/contacts/lib/python2.7/site-packages/mongokit/document.py", line 214, in _get_size_limit
    server_version = tuple(self.connection.server_info()['version'].split("."))
  File "/Users/fernandocezar/.virtualenvs/contacts/lib/python2.7/site-packages/mongokit/document.py", line 622, in __getattribute__
    raise ConnectionError('No collection found') 
mongokit.mongo_exceptions.ConnectionError: No collection found 
```

我按照[本教程](http://namlook.github.com/mongokit/tutorial.html)进行操作，但甚至符号都不起作用`connection.<dbname>.<collection>()`。是的，确实有这样的收藏。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:34:12.607

引用您链接的[教程：](http://namlook.github.com/mongokit/tutorial.html)

> 为了避免重复，让我们在 Document 定义中指定数据库和集合名称：
> 
> ```
> @connection.register
> class BlogPost(Document):
>     __collection__ = 'blog_posts'
>     __database__ = 'blog'
>     structure = {...}
> 
> >>> bp = connection.BlogPost() 
> ```

在shell示例中，模型对象是通过`connection`对象构造的。在你的情况下，你只是在做`user = User()`. `connection`尝试通过您用于注册模型的同一实例创建用户（例如`user = connection.User()`）。

# jquery - 重构 jQuery 动态表单脚本以供通用使用

> ID：12980763
> 
> 赞同：0
> 
> 时间：2012-10-19T19:01:13.173
> 
> 标签：jquery

我有一个简单的表单，用户可以在其中选择一种颜色，然后从该颜色类别中选择一个东西。第二个选择输入基于第一个输入进行更新。

我有一个 jQuery 脚本，它允许我基于 id 定位第一个元素，并在指定它的 id 时相应地更改下一个元素。现在我想把它变成一个可重用的脚本，这样我就可以选择任何选择并相应地更新 NEXT 选择。我可以处理内部逻辑（url、GET 参数）。

在我的 jQuery 脚本中：获取参数），但我不知道如何在选定元素之后定位下一个选择元素（我尝试使用 next() 但它不起作用）。

```
$(document).ready(function () {
    var nextSelect = $('#id_colour');
    nextSelect.change(function () {
        function updateChoices() {
            var selected = nextSelect.val();
            if (selected) {
                // this line shown for completeness - will be refactored
                $.getJSON(url, {
                    colour_id: selected
                }, function (data, jqXHR) {
                    var options = [];
                    for (var i = 0; i < data.length; i++) {
                        output = '<option value="' + data[i].id + '"';
                        if (nextSelect.val() == data[i].id) {
                            output += ' selected="selected"';
                        }
                        output += '>' + data[i].name + '</option>';
                        options.push(output);
                    }
                    $('#id_thing').html(options.join(''));
                });
            }
        }
        updateChoices();
        $('#id_thing').change(updateChoices);
    });
}); 
```

非常感谢任何帮助。

**编辑** 这里是html。所以我希望当一个被改变时，NEXT 将成为目标。我不能依赖 ids 或 classes。

```
<form action="" method="post">
    <!-- colour -->
    <div class="form_div">
        <p><label for="colour">Colour:</label></p>
        <p>
            <select name="colour" id="id_colour">
                <option value="" selected="selected">---------</option>
                <option value="1">Green</option>
                <option value="2">Brown</option>
                <option value="3">Blue</option>
            </select>
        </p>
    </div>  
    <!-- thing -->
    <div class="form_div">
        <p><label for="thing">Thing:</label></p>
        <p>
            <select name="thing" id="id_thing">
                <option value="" selected="selected">---------</option>
                <option value="1">Branch</option>
                <option value="2">Leaf</option>
                <option value="3">Sky</option>
            </select>
        </p>
    </div> 

    <p><input type="submit" value="Submit Choice" /></p>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T22:12:56.530

如果你想制作可重用的代码（可以在其他脚本中使用），你可以创建一个[实用函数](https://stackoverflow.com/questions/6627326/is-there-any-benefit-to-defining-a-utility-function-directly-on-the-jquery-objec)：

只需使用三个参数调用 nextSelect；（1）第一个选择，（2）第二个选择将根据select1改变，（3）你做请求的url。

jQuery（v1.8.2）：

```
// Utility function
$.nextSelect = function(selectOne, selectTwo, url) {
    var s1 = $(selectOne);
    s1.on('change', function() {
        var colourID = s1.val();
        if (colourID) {
            $.getJSON(url, {colour_id: colourID}, function(data, jqXHR){
                $(selectTwo + ' option:selected').removeAttr('selected');
                $(selectTwo + ' option[value="' + data[0].id + '"]').attr('selected', 'selected');
            });
            //Example of what the getJSON might do:
            $(selectTwo + ' option:selected').removeAttr('selected');
            $(selectTwo + ' option[value="' + 1 + '"]').attr('selected', 'selected');
            //End example. Remove/comment example when going live.
        }
    });        
};
//I have left the url empty for now,
//$.nextSelect('#id_colour', '#id_thing', '');
//If you allowed to at least select the container div:
$mySelectedForm = $('.form_div').first();
$.nextSelect("#" + $mySelectedForm.find('select').attr('id'), "#" + $mySelectedForm.next().find('select').attr('id'), ''); 
```

HTML（我只是缩短了它）：

```
<div class="form_div">
    <select name="colour" id="id_colour">
        <option value="" selected="selected">---------</option>
        <option value="1">Green</option>
        <option value="2">Brown</option>
        <option value="3">Blue</option>
    </select>
</div>
<div class="form_div">
    <select name="thing" id="id_thing">
        <option value="" selected="selected">---------</option>
        <option value="1">Branch</option>
        <option value="2">Leaf</option>
        <option value="3">Sky</option>
    </select>
</div> 
```

​这里有一个[小提琴](http://jsfiddle.net/QMzn4/7/)

如果这不是您想要的，请提供反馈，我会调整代码。

干杯!

编辑：

> 这样我就可以选择任何选择并相应地更新 NEXT 选择。

好的，所以如果我理解正确，您希望能够选择第一个“选择”-> 这意味着您需要以某种形式对 id/class 的引用进行硬核。这不需要是选择本身，它可以是一个包装类。第二个选择将被自动选择。

修改了代码和小提琴以适应它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:39:12.003

$(this).next() 对我有用

[http://jsfiddle.net/cWQhg/1/](http://jsfiddle.net/cWQhg/1/)

HTML

```
<div id="parent">
<div class="nextsel">I'm div</div>
<div class="nextsel">I'm div</div>
<div class="nextsel">I'm div</div>
<div class="nextsel">I'm div</div>
<div class="nextsel">I'm div</div>
<div class="nextsel">I'm div</div>
<div class="nextsel">I'm div</div>
</div>
​ 
```

CSS

```
.nextsel {
  margin: 5px;
  border: 1px solid black;    
  height: 40ps;
    width: 100px;
    cursor: pointer;
}
.nextsel.current {
 background: red;    
}
.nextsel.next {
 background: blue;    
} 
```

​ JS

```
var nextsel=$('.nextsel');
nextsel.click(function(e) {
    var t=$(this);
    t.addClass('current');
    t.siblings('.nextsel').removeClass('current');
    nextsel.removeClass('next');
    console.log(t.nextAll('.nextsel').first().addClass('next'));

});
​ 
```

​</p>

* * *

从你的问题样本：

[http://jsfiddle.net/FU7fZ/](http://jsfiddle.net/FU7fZ/)

HTML

```
<form action="" method="post">
    <!-- colour -->
    <div class="form_div">
        <p><label for="colour">Colour:</label></p>
        <p>
            <select name="colour" id="id_colour">
                <option value="" selected="selected">---------</option>
                <option value="1">Green</option>
                <option value="2">Brown</option>
                <option value="3">Blue</option>
            </select>
        </p>
    </div>  
    <!-- thing -->
    <div class="form_div">
        <p><label for="thing">Thing:</label></p>
        <p>
            <select name="thing" id="id_thing">
                <option value="" selected="selected">---------</option>
                <option value="1">Branch</option>
                <option value="2">Leaf</option>
                <option value="3">Sky</option>
            </select>
        </p>
    </div> 
     <!-- next -->
    <div class="form_div">
        <p><label for="thing">Next:</label></p>
        <p>
            <select name="next" id="id_thing">
                <option value="" selected="selected">---------</option>
                <option value="1">Tree</option>
                <option value="2">Nut</option>
                <option value="3">Deep</option>
            </select>
        </p>
    </div> 
```

js

```
var selector='.form_div select';
var changef=function () {
    var t=$(this);

    var n=t.parents('.form_div').nextAll('.form_div').first().find('select').val(t.val()); 
    if (n.length==0) {
        //it is last ....
        n=t.parents('.form_div').siblings().first().find('select').val(t.val())  ;
    }
    //uncomment to change all in recursive way
      /*
    t.addClass('changed');    
    if (!n.hasClass('changed')) {n.trigger('change');return;}
    $(selector).removeClass('changed');
    */
}

$(selector).change(changef);​ 
```

# android - 启动监控失败，没有运行程序。为什么？

> ID：12980767
> 
> 赞同：3
> 
> 时间：2012-10-19T19:01:27.333
> 
> 标签：android, android-emulator, monitoring, galaxy

我上周重新安装了 Windows 7 并解压缩了 Eclipse 并再次重新安装了 SDK，但是我没有在 Eclipse 中运行该程序。当我将 Galaxy 手机连接到我的计算机时，Eclipse 显示错误并经常在控制台选项卡中写入`Failed to start monitoring 0A3C202B1601A00A`。过了一会儿，Eclipse 将显示一个 Android 设备选择器窗口。我无法选择`0A3C202B1601A00A`。

我使用 ADB，并在 cmd 中写入 adb 地址和 adb 设备，cmd 写入守护程序未运行。

当我将手机与计算机断开连接并想用模拟器运行程序时，程序将无法运行，而当我在 cmd 中编写 adb devices 时，cmd 什么也没写。

为什么？请帮我 ：（

![在此处输入图像描述](../Images/4baef67ebff8d70891bfaa750a44a9bd.png)

![在此处输入图像描述](../Images/49fc8fb3b9e9a345830d7c13aed770ad.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-20T05:29:14.707

通过任务管理器杀死 adb 任务。然后，在命令提示符下键入：`adb devices`

这应该重新启动 adb 守护程序，一切都很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:18:57.180

为您的 Galaxy 手机重新安装 Windows 驱动程序。它可能已损坏。我不得不重新安装我的，只是为了让操作系统在不久前检测到我的手机。

还要检查手机使用的 USB 调试模式。有时手机可以进入仅存储模式。

# bash - 有没有一种简洁的方法来测试 bash 中一组命令的退出状态？

> ID：12980779
> 
> 赞同：0
> 
> 时间：2012-10-19T19:02:20.293
> 
> 标签：bash, rsync, exitstatus

我有一个简单的脚本来从远程服务器中提取数据，因为进程使用以下方法生成数据`rsync`：

```
while :
do
    rsync -avz --remove-source-files -e ssh me@remote:path/to/foo* ./

    rsync -avz --remove-source-files -e ssh me@remote:path/to/bar* ./

    rsync -avz --remove-source-files -e ssh me@remote:path/to/baz* ./

    rsync -avz --remove-source-files -e ssh me@remote:path/to/qux* ./

    sleep 900 #wait 15 minutes, try again
done 
```

如果没有文件，则`rsync`返回退出状态 12（显然）。如果上述调用**均未**`rsync`找到任何数据，我想中断循环（生成数据的过程可能已退出）。为了减轻任何混乱，即使有 1 个进程成功，我也**不想中断循环。**`rsync`

在 bash 中是否有一种简洁的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:11:12.117

您可以通过将返回值相加来做到这一点，这样如果它们都返回 12，则总和为 48：

```
while :
do
    rc=0
    rsync -avz --remove-source-files -e ssh me@remote:path/to/foo* ./
    let rc+=$?

    rsync -avz --remove-source-files -e ssh me@remote:path/to/bar* ./
    let rc+=$?

    rsync -avz --remove-source-files -e ssh me@remote:path/to/baz* ./
    let rc+=$?

    rsync -avz --remove-source-files -e ssh me@remote:path/to/qux* ./
    let rc+=$?

    if [[ $rc == 48 ]]; then  # 48 = 4 * 12
         break;
    fi

    sleep 900 #wait 15 minutes, try again
done 
```

请注意，如果您得到另一种返回码总和为 48 的组合，即 0 + 0 + 12 + 36，这可能会受到影响

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T02:47:04.983

受到其他答案的启发，我认为这是迄今为止我能做到的最干净的方式......

```
while :
do
    do_continue=0

    rsync -avz --remove-source-files -e ssh me@remote:path/to/foo* ./ && do_continue=1
    rsync -avz --remove-source-files -e ssh me@remote:path/to/bar* ./ && do_continue=1
    rsync -avz --remove-source-files -e ssh me@remote:path/to/baz* ./ && do_continue=1
    rsync -avz --remove-source-files -e ssh me@remote:path/to/qux* ./ && do_continue=1

    if [[ $do_continue == 0 ]]; then 
       break
    fi

    sleep 900 #wait 15 minutes, try again
done 
```

可以对其进行更多重构以删除 break 语句和相关的条件测试：

```
do_continue=1
while [ do_continue -eq 1 ]; do
    do_continue=0
    rsync -avz --remove-source-files -e ssh me@remote:path/to/foo* ./ && do_continue=1
    #...
    sleep 900
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T00:20:43.573

这种方式计算由于没有文件而导致的失败次数。

```
while :
do
    nofile=0

    rsync -avz --remove-source-files -e ssh me@remote:path/to/foo* ./
    (( $? == 12 )) && let nofile++

    rsync -avz --remove-source-files -e ssh me@remote:path/to/bar* ./
    (( $? == 12 )) && let nofile++

    rsync -avz --remove-source-files -e ssh me@remote:path/to/baz* ./
    (( $? == 12 )) && let nofile++

    rsync -avz --remove-source-files -e ssh me@remote:path/to/qux* ./
    (( $? == 12 )) && let nofile++

    # if all failed due to "no files", break the loop
    if (( $nofile == 4 )); then break; fi

    sleep 900 #wait 15 minutes, try again
done 
```

# java - 如何更改图像的亮度

> ID：12980780
> 
> 赞同：11
> 
> 时间：2012-10-19T19:02:22.093
> 
> 标签：java, swing, image-manipulation, brightness, imageicon

**我的问题：**我希望能够更改资源图像的亮度并将其三个实例作为 ImageIcons。一个亮度为 50%（如此暗），另一个亮度为 75%（稍微亮一点），最后另一个亮度为 100%（与原始图像相同）。我也想保持透明度。

**我试过的：**我四处搜索，看起来最好的解决方案是 using [`RescaleOp`](http://docs.oracle.com/javase/6/docs/api/java/awt/image/RescaleOp.html)，但我就是想不通。我不知道 scaleFactor 和 offset 是什么意思。这是我尝试过的代码。

```
public void initialize(String imageLocation, float regularBrightness, float focusedBrightness, float pressedBrightness, String borderTitle) throws IOException {
  BufferedImage bufferedImage = ImageIO.read(ButtonIcon.class.getResource(imageLocation));
  setRegularIcon(getAlteredImageIcon(bufferedImage, regularBrightness));
  setFocusedIcon(getAlteredImageIcon(bufferedImage, focusedBrightness));
  setPressedIcon(getAlteredImageIcon(bufferedImage, pressedBrightness));
  setTitle(borderTitle);
  init();
}

private ImageIcon getAlteredImageIcon(BufferedImage bufferedImage, float brightness) {
  RescaleOp rescaleOp = new RescaleOp(brightness, 0, null);
  return new ImageIcon(rescaleOp.filter(bufferedImage, null));
} 
```

调用将是这样的：

```
seeATemplateButton.initialize("/resources/templateIcon-regular.png", 100f, 75f, 50f, "See A Template");
//I think my 100f, 75f, 50f variables need to change, but whenever I change them it behaves unexpectedly (changes colors and stuff). 
```

**该代码会发生什么：**图像显示为“不可见” 我知道它在那里，因为它位于带有鼠标单击事件的 JLabel 上，并且效果很好。如果我只是跳过亮度变化部分并说它`setRegularIcon(new ImageIcon(Button.class.getResource(imageLocation));`工作得很好，但显然它并没有更暗。

**我认为我需要的：**一些帮助理解`offset`,`scaleFactor`和`filter`方法的含义/作用，以及因此为亮度变量提供的数字。

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:13:21.920

医生说：

重缩放操作的伪代码如下：

```
for each pixel from Source object {
    for each band/component of the pixel {
        dstElement = (srcElement*scaleFactor) + offset
    }
} 
```

这只是每个像素的线性变换。该转换的参数是`scaleFactor`和`offset`。如果你想要 100% 的亮度，这个变换必须是一个恒等式，即`dstElement = srcElement`. 设置`scaleFactor = 1`并`offset = 0`解决问题。

现在假设你想让图像更暗，就像你说的那样，亮度为 75%。这相当于将像素值乘以 0.75。你想要：`dstElement = 0.75 * srcElement`。所以设置 scaleFactor = `0.75`and`offset = 0`应该可以解决问题。您的值的问题是它们从 0 到 100，您需要使用 0 到 1 之间的值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T20:42:55.367

我建议只用半透明的黑色覆盖图像。

假设你想直接在图像上写：

```
Graphics g = img.getGraphics();
float percentage = .5f; // 50% bright - change this (or set dynamically) as you feel fit
int brightness = (int)(256 - 256 * percentage);
g.setColor(new Color(0,0,0,brightness));
g.fillRect(0, 0, img.getWidth(), img.getHeight()); 
```

或者，如果您只是将图像用于显示目的，请在`paintComponent`方法中执行。这是一个SSCCE：

```
import java.awt.*;
import java.awt.image.*;
import java.io.IOException;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.*;

public class ImageBrightener extends JPanel{

    BufferedImage img;
    float percentage = 0.5f;

    public Dimension getPreferredSize(){
        return new Dimension(img.getWidth(), img.getHeight());
    }

    public ImageBrightener(){
        try {
            img = ImageIO.read(new URL("http://media.giantbomb.com/uploads/0/1176/230441-thehoff_super.jpeg"));
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    public void paintComponent(Graphics g){
        super.paintComponent(g);
        g.drawImage(img, 0, 0, this);
        int brightness = (int)(256 - 256 * percentage);
        g.setColor(new Color(0,0,0,brightness));
        g.fillRect(0, 0, getWidth(), getHeight());
    }

    public static void main(String[] args){
        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new ImageBrightener());
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

**编辑**

假设与上面的代码相同，您可以通过弄乱光栅化器来操作除 Alpha 之外的所有内容。这是一个示例（如果使用此示例，则使用绘画`shadedImage`代替`img`）。请注意，这不会捕获 RGB 值大于 256 且小于 0 的边缘情况。

```
 img = ImageIO.read(new URL("http://media.giantbomb.com/uploads/0/1176/230441-thehoff_super.jpeg"));
        shadedImage = new BufferedImage(img.getWidth(), img.getWidth(), BufferedImage.TYPE_INT_ARGB);
        shadedImage.getGraphics().drawImage(img, 0, 0, this);

        WritableRaster wr = shadedImage.getRaster();
        int[] pixel = new int[4];

        for(int i = 0; i < wr.getWidth(); i++){
            for(int j = 0; j < wr.getHeight(); j++){
                wr.getPixel(i, j, pixel);
                pixel[0] = (int) (pixel[0] * percentage);
                pixel[1] = (int) (pixel[1] * percentage);
                pixel[2] = (int) (pixel[2] * percentage);
                wr.setPixel(i, j, pixel);
            }
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-20T01:51:49.043

再举几个例子供学习：

*   [`AlphaTest`](https://stackoverflow.com/a/5864503/230513)仅在零和一之间重新缩放图像的 alpha 透明度，没有偏移。巧合的是，它还将图像重新采样为四分之三的大小。

*   [`RescaleOpTest`](https://stackoverflow.com/a/5839425/230513)使用固定比例且没有偏移量也一样。

*   [`RescaleTest`](https://stackoverflow.com/a/10208380/230513)在零到二之间缩放图像的*所有波段，没有偏移。*

如[API](http://docs.oracle.com/javase/7/docs/api/java/awt/image/RescaleOp.html)中所述，比例和偏移量分别作为线性函数的斜率和*y*截距应用于每个波段。

```
dstElement = (srcElement*scaleFactor) + offset 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-04T18:52:22.397

基本逻辑是获取每个像素的 RGB 值，为其添加一些因子，再次将其设置为结果矩阵（缓冲图像）

```
 import java.io.*;
    import java.awt.Color;
    import javax.imageio.ImageIO;
    import java.io.*;
    import java.awt.image.BufferedImage;

        class psp{

    public static void main(String a[]){
    try{

    File input=new File("input.jpg");
    File output=new File("output1.jpg");
            BufferedImage picture1 = ImageIO.read(input);   // original
    BufferedImage picture2= new BufferedImage(picture1.getWidth(), picture1.getHeight(),BufferedImage.TYPE_INT_RGB);      
            int width  = picture1.getWidth();
            int height = picture1.getHeight();

    int factor=50;//chose it according to your need(keep it less than 100)
    for (int y = 0; y < height ; y++) {//loops for image matrix
    for (int x = 0; x < width ; x++) {

    Color c=new Color(picture1.getRGB(x,y));

    //adding factor to rgb values
int r=c.getRed()+factor;
    int b=c.getBlue()+factor;
    int g=c.getGreen()+factor;
    if (r >= 256) {
     r = 255;
    } else if (r < 0) {
    r = 0;
    }

    if (g >= 256) {
    g = 255;
    } else if (g < 0) {
    g = 0;
    }

     if (b >= 256) {
    b = 255;
    } else if (b < 0) {
    b = 0;
     }
    picture2.setRGB(x, y,new Color(r,g,b).getRGB());

    }
    }
     ImageIO.write(picture2,"jpg",output);       
    }catch(Exception e){
    System.out.println(e);
    }
     }} 
```

# jquery - 使用 Wikipedia API 在 Wikipedia 页面的信息框中提取第一张图像的选择器是什么

> ID：12980788
> 
> 赞同：1
> 
> 时间：2012-10-19T19:02:47.327
> 
> 标签：jquery, mediawiki-api

我希望使用 Wikipedia/Mediawiki API 提取 infobox 中的第一个图像 - 大多数 Wikipedia 页面上的类名 infobox 的表

这是我迄今为止尝试过的 -

```
$.getJSON("http://en.wikipedia.org/w/api.php?action=mobileview&format=json&page=mumbai&redirect=no&sections=0&prop=text&sectionprop=toclevel%7Clevel%7Cline%7Cnumber%7Cindex%7Cfromtitle%7Canchor&callback=?", function(json) { 
var wikitext = json.mobileview.sections[0].text;
var img = $(wikitext).find('img:first').attr("src");

/*
//how can i make this work?

//selector for element with multiple classes - http://stackoverflow.com/questions/1041344/jquery-multiple-class-selector
  var infoboximg = $(wikitext).find('table.infobox.geography.vcard img:first').attr("src");
console.log(infoboximg);  
*/

$('#pic').append('<img src="http://' + img + '" />');

}
); 
```

你可以在这里试试这个片段 - [http://jsbin.com/erudum/5/](http://jsbin.com/erudum/5/)

如何修复代码以获取具有名称信息框的表格中的第一张图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:10:16.547

您只需要获取 src 吗？为什么不像这样附加img

```
$.getJSON("http://en.wikipedia.org/w/api.php?action=mobileview&format=json&page=mumbai&redirect=no&sections=0&prop=text&sectionprop=toclevel%7Clevel%7Cline%7Cnumber%7Cindex%7Cfromtitle%7Canchor&callback=?", function(json) { 
        var wikitext = json.mobileview.sections[0].text;
        var img = $(wikitext).find('img:first');
        $('#pic').append(img);
    }
); 
```

[http://jsfiddle.net/wirey00/Kr46e/](http://jsfiddle.net/wirey00/Kr46e/)

**编辑**

在查看返回文本之后.. 它实际上是一个返回的 ELEMENTS 数组.. 该表是第 5 个元素，因此您可以使用 jQuery 中的 .eq() 方法获取它

```
$.getJSON("http://en.wikipedia.org/w/api.php?action=mobileview&format=json&page=mumbai&redirect=no&sections=0&prop=text&sectionprop=toclevel%7Clevel%7Cline%7Cnumber%7Cindex%7Cfromtitle%7Canchor&callback=?", function(json) { 
        var wikitext = json.mobileview.sections[0].text;
        var img = $(wikitext).eq(4).find('img:first').attr('src');
        $('#pic').append('<img src="' + img + '"/>');
    }
); 
```

你可以做一个console.log来看看我的意思

```
console.log($(wikitext)); 
```

[http://jsfiddle.net/wirey00/Jp7rn/](http://jsfiddle.net/wirey00/Jp7rn/)

**再次编辑**

我弄清楚了为什么它会以数组的形式返回。文中的引号把它扔掉了。我要做的是将整个内容附加到..可能是隐藏字段或其他内容..然后遍历它并获取 img 文本。然后再次删除整个东西。这是一个例子

```
$.getJSON("http://en.wikipedia.org/w/api.php?action=mobileview&format=json&page=mumbai&redirect=no&sections=0&prop=text&sectionprop=toclevel%7Clevel%7Cline%7Cnumber%7Cindex%7Cfromtitle%7Canchor&callback=?", function(json) { 
    var wikitext = json.mobileview.sections[0].text;
    $('#pic').hide().append(wikitext); // hide the div then append whole string
    var img = $('#pic').find('.infobox img:first').attr('src');// find the src
    $('#pic').show().html('<img src="' + img + '"/>'); // show and append
    }
); 
```

[http://jsfiddle.net/Jp7rn/1/](http://jsfiddle.net/Jp7rn/1/)

# ruby - 为基于 OmniAuth OAuth2 的策略指定令牌选项

> ID：12980791
> 
> 赞同：1
> 
> 时间：2012-10-19T19:02:59.907
> 
> 标签：ruby, oauth, omniauth

我正在为 Nimble.com API 创建自定义策略。当他们使用 OAuth 时，这非常简单。

```
require 'omniauth-oauth2'

module OmniAuth
  module Strategies
    class Nimble < OmniAuth::Strategies::OAuth2
      option :name, "nimble"

      option :client_options, {
        :site => "https://api.nimble.com",
        :authorize_url => '/oauth/authorize',
        :token_url => '/oauth/token'
      }

      # option :access_token_options, {
      #   :mode => :query,
      #   :param_name => :access_token
      # }      

      option :provider_ignores_state, true

      uid { raw_info['email'] }

      info do
        {
          'uid'   => raw_info['email'],
          'name'  => raw_info['name'],
          'email' => raw_info['email']
        }
      end

      extra do
        { 'raw_info' => raw_info }
      end

      def raw_info
        access_token.options[:mode] = :query
        access_token.options[:param_name] = :access_token        
        @raw_info ||= access_token.get('/api/users/myself/', {:parse => :json}).parsed
      end
    end
  end
end 
```

为了传递令牌，他们需要在 URL 中使用 access_token 参数。当我直接在 raw_info 函数中指定选项时，如在示例中 - 没关系。

当我尝试在 access_token_options 哈希中指定此选项时（如在注释部分中） - 参数不会传递给令牌。我在 Ruby 方面不是很好，所以我没有从库源中弄清楚——如何正确地将参数传递给 OmniAuth OAuth2 后代中的 access_token。

我想让它成为“正确的方式”，所以使用正确的选项初始化 access_token，请有人指出正确的方式。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T18:48:24.080

我探索了几种现有的策略（GitHub，4SQ），看起来直接修改访问令牌选项是正常的做法。

所以我会坚持下去:)

# html - HTML5 应用程序缓存 - 缓存文件不会更新，即使清单已更新

> ID：12980792
> 
> 赞同：2
> 
> 时间：2012-10-19T19:03:00.390
> 
> 标签：html, offline, offline-caching, application-cache

我有一个版本化的缓存清单：

```
#version = e5b4271 
```

每次此版本更改时，我的 webapp 都会加载新的清单，但它*永远不会*从服务器加载更新文件。即使我清除了浏览器缓存（不是应用程序缓存本身），或者按 Ctrl+Shift+R 强制它获取新版本，它仍然会从旧的 appcache 加载文件。

我可以让它更新的唯一方法是在设置中清除浏览器的应用程序缓存，但显然这是不可接受的，因为我需要它为普通用户更新。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:10:18.913

刚刚想通了。我正在使用 Flask 的开发服务器，默认情况下（通过 werkzeug）它似乎会为静态文件发送 12 小时的缓存头。将以下内容添加到我的烧瓶配置中解决了这个问题：

```
SEND_FILE_MAX_AGE_DEFAULT = -1 
```

如果其他人遇到此问题，请检查您的服务器配置以确保缓存标头未与静态文件一起发送。您可以在第一次加载文件期间在 chrome 的网络选项卡中检查这一点。

# xcode - QTKit 在查找设备时偶尔会崩溃

> ID：12980799
> 
> 赞同：0
> 
> 时间：2012-10-19T19:03:40.453
> 
> 标签：xcode, macos, cocoa, qtkit

我不确定它只是我的机器还是其他人对 QTKit 有这个问题。这两种方法偶尔会崩溃。有解决方案或解决方法吗？

```
[QTCaptureDevice defaultInputDeviceWithMediaType:QTMediaTypeSound]
[QTCaptureDevice inputDevicesWithMediaType:QTMediaTypeSound] 
```

malloc：*** 对象 0x75703e67 的错误：未分配被释放的指针 ***在 malloc_error_break 中设置断点以进行调试

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:15:17.263

将构建更改为 10.6 为我解决了这个问题。

# c - C 中的 PlaySound 发出哔哔声但不播放 wav 文件

> ID：12980801
> 
> 赞同：3
> 
> 时间：2012-10-19T19:03:51.700
> 
> 标签：c, visual-studio-2010, winapi, playsound

在 C 中，我`PlaySound`没有抛出任何错误......但不是播放我想要的文件，它只是发出哔哔声。

有什么建议么？

我试过了 ：

```
PlaySound("song1.wav", NULL, SND_ALIAS | SND_APPLICATION); 
```

和：

```
PlaySound("song1.wav", NULL, SND_FILENAME); 
```

但我得到了同样的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:16:52.983

而不是像您所做的那样使用相对路径：

```
PlaySound("song1.wav", NULL, SND_FILENAME); 
```

使用绝对路径，例如：

```
PlaySound("F:\\path\\to\\your\\song\\song1.wav", NULL, SND_FILENAME); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T19:17:49.657

引用来自 msdn.microsoft.com 的 PlaySound API 描述：

> `PlaySound`在以下目录中搜索声音文件：当前目录；Windows 目录；Windows系统目录；`PATH`环境变量中列出的目录；以及映射到网络中的目录列表。
> 
> 如果函数找不到指定的声音并且 `SND_NODEFAULT`未指定标志，则`PlaySound`使用默认的系统事件声音代替（在您的情况下为 BEEP）。
> 
> 如果该函数既找不到系统默认入口也找不到默认声音，则不发出声音并返回`FALSE`。

因此，将文件目录路径添加到`PATH`windows 中的环境变量中。那应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-14T07:54:22.907

我遇到了与 OP 相同的情况，并为我找到了解决方案。我的解决方案是消除 wav 文件的元数据。

[邮政（日文）](http://blog.fujiu.jp/2015/08/protools-first-wavplaysound.html?spref=tw)

参考帖子，PlaySound() API 无法播放一些使用著名音频工具导出的 wav 文件。（如 ProTools、CUBASE、StudioOne 等。）

消除元数据使其起作用。在博客文章中，他用[SoundEngine（日语）](http://soundengine.jp/software/soundengine/)打开了一些“麻烦”的波形文件，然后“另存为”新文件以消除 wav RIFF 元信息。

# javascript - Jquery将上下文菜单绑定到动态元素ID

> ID：12980803
> 
> 赞同：1
> 
> 时间：2012-10-19T19:04:04.947
> 
> 标签：javascript, dynamic, contextmenu, bind

基本故事，我有一个动态处理每个 div id 的系统。我决定用我自己的一个来接管上下文菜单，只要元素的 id 是硬编码的，它就可以工作。我一直在尝试编写一个函数，该函数从数组列表中获取元素名称，并且它的抛出错误从左到右。

```
function menuclick()
{
alert("Menuclick Called");
var limen= ["armenu", "ormenu", "prmenu", "apmenu", "auxmenu", "itmenu", "sysmenu"];
var menues= Array();
var men1 = "menu$pf1$topmen$topmen$menul$menuli$";
for (idx=0;idx<6;idx++){
    menues[idx] = "#"+men1+limen[idx];
    $(menues[idx]).bind("contextmenu", this.id, function(e) {
        $('#example-menu').css({
            top: e.pageY+'px',
            left: e.pageX+'px'
        }).show();
return false;
});
    alert(menues[idx]);
}
return;
} 
```

$(menues[idx]).bind 是导致问题的原因，主要是 menues[idx]。但我不知道为什么。有什么建议么？

编辑**忘了提，萤火虫显示的错误是：

> “未捕获的异常：语法错误，无法识别的表达式：$pf1$topmen$topmen$menul$menuli$armenu”

编辑** 这使用 php 从数据库中获取 div id。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:24:08.120

ohhh`.NET`及其愚蠢的约定。您正在尝试引用“名称”而不是“id”。您的菜单标记应如下所示：

```
<div name="menu$pf1$topmen$topmen$menul$menuli$armenu" id="menu_pf1_topmen_topmen_menul_menuli_armenu"> ... </div> 
```

所以，话虽这么说，你有两个选择。

*   1）将你的美元符号改为下划线（推荐）

`var men1 = "menu_pf1_topmen_topmen_menul_menuli_";`

*   2）更改以下代码行：

`menues[idx] = "#"+men1+limen[idx];`

对此：

`menues[idx] = "[name='" + men1 + limen[idx] + "']";`

# c# - GridView CheckBox 如果默认选中但用户取消选中，则回发复选框仍处于选中状态

> ID：12980804
> 
> 赞同：1
> 
> 时间：2012-10-19T19:04:07.117
> 
> 标签：c#, asp.net, gridview

我有一个有 5 个网格的页面。每个网格中的第一个字段是模板内的。在页面加载时，如果不是回发，我会根据从数据库的返回设置此复选框。检查。

如果用户取消选中该复选框，则此 checkeboxed.checked = false 不会在回发时保留。有趣的是，如果用户选中了一个未选中的框，那么该更改确实会在回发时完成。如果有人对如何修复有任何建议，请告诉我。谢谢！

```
<asp:GridView ID="commonAdultClinicReferrals" CssClass="Report" runat="server" AutoGenerateColumns="false"
                            Width="270" AllowPaging="false" AlternatingRowStyle-CssClass="DataAlternateRow"
                            CellPadding="1" CellSpacing="1" HeaderStyle-HorizontalAlign="Center" EmptyDataText="No Results."
                            DataKeyNames="Id,Name,Description,FollowUpList"  OnRowDataBound="GridView_RowDataBound">
                            <Columns>
                                <asp:TemplateField ItemStyle-Width="10">
                                    <ItemTemplate>
                                        <center>
                                            <asp:CheckBox ID="selectedRowCb" runat="server"  />
                                        </center>
                                    </ItemTemplate>
                                </asp:TemplateField>
                                <asp:BoundField DataField="Name" HeaderText="Common Adult Clinic Referrals" ItemStyle-Width="250"
                                    ItemStyle-Wrap="true" />
                            </Columns>
                        </asp:GridView> 
```

班级：

```
public class FollowUp
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public bool FollowUpList { get; set; }
    public bool Selected { get; set; }

    public FollowUp(int id, string name, string description, bool followUpList, bool selected)
    {
        this.Id = id;
        this.Name = name;
        this.Description = description;
        this.FollowUpList = followUpList;
        this.Selected = selected;
    }
} 
```

数据绑定：

```
 protected void Page_Load(object sender, EventArgs e)
{

    if (!Page.IsPostBack)
    {
        hdnWindowClose.Value = string.Empty;

        loadUi();
    }

}

private void loadUi()
{

    _adultServices = GetFollowUps(2, true);
    adultClinicReferrals.DataSource = _adultServices;
    adultClinicReferrals.DataBind(); 
```

}

设置复选框已选中：

```
protected void GridView_RowDataBound(Object sender, GridViewRowEventArgs e)
{

    if (e.Row.RowType == DataControlRowType.DataRow && !Page.IsPostBack)
    {
        CheckBox cb = ((CheckBox)e.Row.FindControl("selectedRowCb"));
        FollowUp fol = (FollowUp)e.Row.DataItem;
        bool selected = fol.Selected;

        cb.Checked = selected;

    }

} 
```

保存时：

```
 protected void saveButton_Click(object sender, EventArgs e)
{
    GetSelectedCodes(followUpAppointments);
    GetSelectedCodes(adultClinicReferrals);
    GetSelectedCodes(commonAdultClinicReferrals);
    GetSelectedCodes(otherAdultClinicReferrals);
    GetSelectedCodes(pediClinicReferrals);

    hdnWindowClose.Value = "yes";

    JavaScriptSerializer js = new JavaScriptSerializer();
    string str = js.Serialize(_selectedServices);

    hdnFollowUp.Value = str;
    SetNotePickCodes();
} 
```

最后在 GetSelectedCodes() 中，如果复选框默认为 true，则 checkbox.check 状态不起作用：

```
private void GetSelectedCodes(GridView gv)
{

    for (int i = 0; i < gv.Rows.Count; i++)
    {
        GridViewRow row = gv.Rows[i];
        bool isChecked = ((CheckBox)row.FindControl("selectedRowCb")).Checked;

        if (isChecked)
        {
            int id = (Int32)gv.DataKeys[i]["Id"];
            string name = gv.DataKeys[i]["Name"].ToString();
            string description = gv.DataKeys[i]["Description"].ToString();
            bool followup = (bool)gv.DataKeys[i]["FollowUpList"];

            _selectedServices.Add(new FollowUp(id,name,description,followup,true));
        }

    } 
```

if (isChecked) 分支正在执行，而我不希望它执行。例如，当用户取消选中复选框时。如果不是 page.postback，我的数据绑定仅在页面加载时完成。

再次非常感谢您的帮助。

谢谢，

周杰伦

# javascript - getAttributes 在嵌套 for 中返回 [function getValue]

> ID：12980805
> 
> 赞同：0
> 
> 时间：2012-10-19T19:04:09.267
> 
> 标签：javascript, google-apps-script

我的第二个示例是返回 [function getValue] 的示例，我正在尝试修复它，但我看不出问题出在哪里。

我一直在 google 脚本中搞乱 xmlparse，我想解析的 xml 将所有相关数据保存在元素的属性中。

这是该 xml 格式的示例：[https ://api.eveonline.com/account/characters.xml.aspx?keyID=1409941&vCode=xagxMH966J2EQinVpoFOBB5H1UidCwsjoTwtBKhhvMVZWqq6Jio4mkiBwv026Olc](https://api.eveonline.com/account/characters.xml.aspx?keyID=1409941&vCode=xagxMH966J2EQinVpoFOBB5H1UidCwsjoTwtBKhhvMVZWqq6Jio4mkiBwv026Olc)

下面是一些有效的代码（通过 log [ctrl]+[enter] 显示）：

```
function dialogDisplay() {
  var xmlstring = Xml.parse('<rowset name="characters" key="characterID" columns="name,characterID,corporationName,corporationID"><row name="Jonah Younbrog" characterID="90131303" corporationName="House of Praetor" corporationID="523373135"/><row name="Mador Younbrog" characterID="90149709" corporationName="House of Praetor" corporationID="523373135"/><row name="Marc Younbrog" characterID="747451028" corporationName="House of Praetor" corporationID="523373135"/></rowset>');
  var attributes = xmlstring.getElement().getAttributes();
  for (var i in attributes) {
    Logger.log(attributes[i].getValue());
  }
} 
```

这是不起作用的代码，它还记录了元素名称（成功）并使用嵌套的 fors 来遍历 xml：

```
function fetchToLogger() {
  var assetURL = "https://api.eveonline.com/account/characters.xml.aspx?keyID=1409941&vCode=xagxMH966J2EQinVpoFOBB5H1UidCwsjoTwtBKhhvMVZWqq6Jio4mkiBwv026Olc";
  var assetstring = UrlFetchApp.fetch(assetURL).getContentText();
  var xmlstring = Xml.parse(assetstring, false);

  var elements = xmlstring.eveapi.result.getElements();
  for (var a in elements) {

    Logger.log(elements[a].getName().getLocalName());

    var attributes = elements[a].getAttributes();
    for (var x in attributes) {

      Logger.log(attributes[x].getValue);
    }

    var subelements = elements[a].getElements();
    for (var b in subelements) {

      Logger.log(subelements[b].getName().getLocalName());

      var subattributes = subelements[b].getAttributes();
      for (var y in attributes) {

        Logger.log(attributes[y].getValue);
      }

    }

  }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:08:45.807

您没有调用实际函数，请更改为：

```
Logger.log(attributes[x].getValue()); 
```

请注意，这`Logger.log(attributes[x].getValue`只是对函数的引用，这就是控制台显示的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:09:01.573

`.getValue`是一个函数。所以你应该使用`.getValue()` 例如：

```
Logger.log(attributes[x].getValue()); 
```

# java - 使用 IBM JVM (AIX) 的 Java UTF-8 文件名

> ID：12980811
> 
> 赞同：9
> 
> 时间：2012-10-19T19:04:42.433
> 
> 标签：java, utf-8, aix, j9

我无法理解 IBM JVM`java.io.File`在 JFS2 文件系统上处理 AIX 上的 UTF-8 的方式。我怀疑我忽略了一个系统属性，但我还没有找到它。

假设我有一个名为`othér`（其中`é`是 U+00E9 或 UTF-8 bytes `0xc3 0xa9`）的文件。文件名以 UTF-8 编码，由 C 程序创建：

```
char filename[] = { 'o', 't', 'h', 0xc3, 0xa9, 'r', 0 };
open(filename, O_RDWR|O_CREAT, 0666); 
```

如果我在 Java 中创建一个代表文件名的 Unicode 字符串，它将无法打开它。此外，如果我`File.listFiles()`在 Java 中使用，它坚持将其视为 Latin1 字符串。例如：

```
String expectedName = new String(new char[] { 'o', 't', 'h', 0xe9, 'r' });
File expected = new File(expectedName);
if (expected.exists())
    System.out.println(expectedName + " exists");
else
    System.out.println(expectedName + " DOES NOT exist");

for (File child : new File(".").listFiles())
{
    System.out.println(child.getName());
    System.out.print("Chars:");
    for (char c : child.getName().toCharArray())
        System.out.print(" 0x" + Integer.toHexString((int)c));
    System.out.println();
} 
```

这个程序的结果是：

```
% java -Dfile.encoding=UTF8 FileTest
othér DOES NOT exist
othÃ©r
Chars: 0x6f 0x74 0x68 0xc3 0xa9 0x72 
```

因此，我的文件名似乎被视为 Latin1。我尝试将[`file.encoding`](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/rzaha/sysprop2.htm)系统属性设置为`UTF8`和[`client.encoding.override`](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/rzatz/51/admin/help/trun_svr_utf.html)系统属性设置`UTF-8`为无济于事。我的`LANG`和`LC_ALL`设置是`en_US.UTF-8`：

```
% echo $LANG
en_US.UTF-8
% echo $LC_ALL
en_US.UTF-8 
```

SMIT 配置的我系统的“主要语言环境”是“ISO8859-1”。我真的不知道此设置的全部影响，但我无法更改它。我怀疑如果我*可以*将其更改为“UTF8 英语”，那么这*可能会*解决问题，但由于 JFS2 以 Unicode 存储文件名，而 Java 在内部以 Unicode 运行，我觉得应该有一个更通用的解决方案来解决这个问题。

无论我的 SMIT 设置如何，我都可以设置 J9 的另一个系统属性来强制它使用 UTF-8 文件名吗？

AIX 版本是 5.2，Java 版本是 IBM J9 (1.5.0)，文件系统是 JFS2：

```
rs6000% uname -a
AIX rs6000 2 5 000A9B7C4C00
rs6000% java -version
java version "1.5.0"
Java(TM) 2 Runtime Environment, Standard Edition (build pap32dev-20091106a (SR11 ))
IBM J9 VM (build 2.3, J2RE 1.5.0 IBM J9 2.3 AIX ppc-32 j9vmap3223-20091104 (JIT enabled)
J9VM - 20091103_45935_bHdSMr
JIT  - 20091016_1845_r8
GC   - 20091026_AA)
JCL  - 20091106
rs6000% mount|grep /home
         /dev/hd1         /home            jfs2   Jun 27 16:02 rw,log=/dev/hd8 
```

更新：这仍然发生在 Java6 上：

```
% java -version
java version "1.6.0"
Java(TM) SE Runtime Environment (build pap3260sr11-20120806_01(SR11))
IBM J9 VM (build 2.4, JRE 1.6.0 IBM J9 2.4 AIX ppc-32 jvmap3260sr11-20120801_118201 (JIT enabled, AOT enabled)
J9VM - 20120801_118201
JIT  - r9_20120608_24176ifx1
GC   - 20120516_AA)
JCL  - 20120713_01 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T17:09:27.963

我找到了答案。我真的想在这里提供帮助。

[这是一篇关于您的实际问题的博客文章。我保证。](http://happygiraffe.net/blog/2009/09/24/java-platform-encoding/)

`-Dsun.jnu.encoding=UTF-8`尝试在设置标志的情况下运行您的程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T17:54:28.507

请参阅此处[http://www.ibm.com/developerworks/java/jdk/aix/118/README.html](http://www.ibm.com/developerworks/java/jdk/aix/118/README.html)以获取有效 AIX 语言环境的列表 我认为您的导出应该如下所示

```
 export LC_ALL=EN_US
  export LANG=EN_US 
```

# objective-c - 获取（外部）显示器的名称

> ID：12980818
> 
> 赞同：1
> 
> 时间：2012-10-19T19:05:11.790
> 
> 标签：objective-c, macos, cocoa, quartz-graphics, core-foundation

我正在尝试使用 Cocoa 或 CoreFoundation 获取连接的外部显示器的名称。“名称”是指编辑显示首选项时出现在系统首选项窗口标题栏中的字符串。

[我在Quartz Display Services](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/Quartz_Services_Ref/Reference/reference.html)[`NSScreen`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSScreen_Class/Reference/Reference.html)中或中找不到任何 API 。

但是必须有一种方法，因为如果我像这样访问显示器的色彩空间：

```
CGColorSpaceRef colorSpace = CGDisplayCopyColorSpace(displayID); 
```

我记录了我得到的色彩空间的描述：

```
<CGColorSpace 0x100113c20>
(kCGColorSpaceICCBased; kCGColorSpaceModelRGB; DELL 2408WFP) 
```

![在此处输入图像描述](../Images/39683ac4921a87ed83e650f57170a60c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:17:16.893

我在[另一个线程](https://stackoverflow.com/questions/1236498/how-to-get-the-display-name-with-the-display-id-in-mac-os-x?rq=1)中找到了解决方案（我想知道为什么我之前没有找到...）。

我将其更新为与 ARC 兼容：

```
- (NSString *)screenNameForDisplay:(CGDirectDisplayID)displayID {
    NSString *screenName = @"";
    NSDictionary *deviceInfo = (__bridge NSDictionary *)IODisplayCreateInfoDictionary(CGDisplayIOServicePort(displayID), kIODisplayOnlyPreferredName);
    NSDictionary *localizedNames = [deviceInfo objectForKey:[NSString stringWithUTF8String:kDisplayProductName]];
    if ([localizedNames count] > 0) {
        screenName = [localizedNames objectForKey:[[localizedNames allKeys] objectAtIndex:0]];
    }
    return screenName;
} 
```

# flowchart - 分析流程图 - 确定指定框中必须包含的数字

> ID：12980822
> 
> 赞同：-3
> 
> 时间：2012-10-19T19:05:32.347
> 
> 标签：flowchart

我在解决以下流程图问题时遇到了很多麻烦。我明天有面试，你能尽快帮我吗？

以下链接中的第四个问题

[http://placement.freshersworld.com/placement-papers/ThoughtWorks/Placement-Paper-Whole-Testpaper-18522](http://placement.freshersworld.com/placement-papers/ThoughtWorks/Placement-Paper-Whole-Testpaper-18522)

我不能问这个问题，因为它有一些在这里无法正确显示的结构。请转到链接。

谢谢，阿琼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:15:41.833

答案是“3”，因为当方框 3 中的数字与方框 8 中的数字相同时，您想停止流动。

**编辑**

如果我们跳到循环的最后一次迭代，步骤是

1.  减：9 - 9。将结果放入方框 6

2.  更改说明 1\. 将框 6 增加 2（至框 8）

3.  方框 8（因为我们在步骤 2 中更改了它）是否等于方框 3？

如果框 8 和框 3 相同，则结束流程。

# mysql - 提高性能或重新设计 'greatest-n-per-group' mysql 查询

> ID：12980823
> 
> 赞同：3
> 
> 时间：2012-10-19T19:05:34.027
> 
> 标签：mysql, performance, greatest-n-per-group, filesort

我正在使用 MySQL5，我目前有一个查询可以获取我需要的信息，但我觉得它可以在性能方面得到改进。

这是我构建的查询（大致遵循[本指南](http://murrayhopkins.wordpress.com/2008/10/28/mysql-left-join-on-last-or-first-record-in-the-right-table/ "http://murrayhopkins.wordpress.com/2008/10/28/mysql-left-join-on-last-or-first-record-in-the-right-table/")）：

```
SELECT d.*, dc.date_change, dc.cwd, h.name as hub
FROM livedata_dom AS d
      LEFT JOIN ( SELECT dc1.*
        FROM livedata_domcabling as dc1
        LEFT JOIN livedata_domcabling AS dc2
        ON dc1.dom_id = dc2.dom_id AND dc1.date_change < dc2.date_change
        WHERE dc2.dom_id IS NULL
        ORDER BY dc1.date_change desc) AS dc ON (d.id = dc.dom_id)
      LEFT JOIN livedata_hub AS h ON (d.id = dc.dom_id AND dc.hub_id = h.id)
WHERE d.cluster = 'localhost'
GROUP BY d.id; 
```

编辑：使用 ORDER BY + GROUP BY 来避免获得多个 dom 条目，以防“domcabling”有一个带有空 date_change 的条目和另一个带有相同“dom”日期的条目。

我觉得我正在用火箭筒杀死一只老鼠。此查询耗时 3 秒以上，“livedata_dom”和“livedata_domcabling”中只有大约 5k 个条目。此外，EXPLAIN 告诉我使用了 2 个文件排序：

```
+----+-------------+------------+--------+-----------------------------+-----------------------------+---------+-----------------+------+----------------------------------------------+
| id | select_type | table      | type   | possible_keys               | key                         | key_len | ref             | rows | Extra                                        |
+----+-------------+------------+--------+-----------------------------+-----------------------------+---------+-----------------+------+----------------------------------------------+
|  1 | PRIMARY     | d          | ALL    | NULL                        | NULL                        | NULL    | NULL            |    3 | Using where; Using temporary; Using filesort |
|  1 | PRIMARY     | <derived2> | ALL    | NULL                        | NULL                        | NULL    | NULL            |    3 |                                              |
|  1 | PRIMARY     | h          | eq_ref | PRIMARY                     | PRIMARY                     | 4       | dc.hub_id       |    1 |                                              |
|  2 | DERIVED     | dc1        | ALL    | NULL                        | NULL                        | NULL    | NULL            |    4 | Using filesort                               |
|  2 | DERIVED     | dc2        | ref    | livedata_domcabling_dc592d9 | livedata_domcabling_dc592d9 | 4       | live.dc1.dom_id |    2 | Using where; Not exists                      |
+----+-------------+------------+--------+-----------------------------+-----------------------------+---------+-----------------+------+----------------------------------------------+ 
```

如何更改此查询以使其更有效？

使用虚拟数据（如下提供），这是预期的结果：

```
+-----+-------+---------+--------+----------+------------+-----------+---------------------+------+-----------+
| id  | mb_id | prod_id | string | position | name       | cluster   | date_change         | cwd  | hub       |
+-----+-------+---------+--------+----------+------------+-----------+---------------------+------+-----------+
| 249 | 47    | 47      |     47 |       47 | SuperDOM47 | localhost | NULL                | NULL | NULL      |
| 250 | 48    | 48      |     48 |       48 | SuperDOM48 | localhost | 2014-04-16 05:23:00 | 32A  | megahub01 |
| 251 | 49    | 49      |     49 |       49 | SuperDOM49 | localhost | NULL                | 22B  | megahub01 |
+-----+-------+---------+--------+----------+------------+-----------+---------------------+------+-----------+ 
```

基本上，每个“dom”条目都需要 1 行，其中

1.  具有最高 date_change 的“domcabling”记录
    *   如果记录不存在，我需要空字段
    *   每个 dom 一个条目可能有一个空的 date_change 字段（空的日期时间字段被认为比任何其他日期时间都早）
2.  '集线器'的名称，当找到'domcabling'条目时，否则为null

为 3 个表创建 TABLE + dummy INSERT：

**livedata_dom**（大约 5000 个条目）

```
CREATE TABLE `livedata_dom` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `mb_id` varchar(12) NOT NULL,
  `prod_id` varchar(8) NOT NULL,
  `string` int(11) NOT NULL,
  `position` int(11) NOT NULL,
  `name` varchar(30) NOT NULL,
  `cluster` varchar(9) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `mb_id` (`mb_id`),
  UNIQUE KEY `prod_id` (`prod_id`),
  UNIQUE KEY `name` (`name`),
  UNIQUE KEY `livedata_domgood_string_7bff074107b0e5a0_uniq` (`string`,`position`,`cluster`)
) ENGINE=InnoDB AUTO_INCREMENT=5485 DEFAULT CHARSET=latin1;

INSERT INTO `livedata_dom` VALUES (251,'49','49',49,49,'SuperDOM49','localhost'),(250,'48','48',48,48,'SuperDOM48','localhost'),(249,'47','47',47,47,'SuperDOM47','localhost'); 
```

**livedata_domcabling**（大约 10000 个条目并且增长缓慢）

```
CREATE TABLE `livedata_domcabling` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `dom_id` int(11) NOT NULL,
  `hub_id` int(11) NOT NULL,
  `cwd` varchar(3) NOT NULL,
  `date_change` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `livedata_domcabling_dc592d9` (`dom_id`),
  KEY `livedata_domcabling_4366aa6e` (`hub_id`),
  CONSTRAINT `dom_id_refs_id_73e89ce0c50bf0a6` FOREIGN KEY (`dom_id`) REFERENCES `livedata_dom` (`id`),
  CONSTRAINT `hub_id_refs_id_179c89d8bfd74cdf` FOREIGN KEY (`hub_id`) REFERENCES `livedata_hub` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5397 DEFAULT CHARSET=latin1;

INSERT INTO `livedata_domcabling` VALUES (1,251,1,'22B',NULL),(2,250,1,'33A',NULL),(6,250,1,'32A','2014-04-16 05:23:00'),(5,250,1,'22B','2013-05-22 00:00:00'); 
```

**livedata_hub**（大约 100 个条目）

```
CREATE TABLE `livedata_hub` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(14) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=98 DEFAULT CHARSET=latin;

INSERT INTO `livedata_hub` VALUES (1,'megahub01'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T22:01:04.300

尝试这种重写（在**[SQL-Fiddle](http://sqlfiddle.com/#!2/97637/5)**中测试：

```
SELECT 
    d.*, dc.date_change, dc.cwd, h.name as hub
FROM 
    livedata_dom AS d
  LEFT JOIN 
    livedata_domcabling as dc
        ON dc.id =
           ( SELECT id
             FROM livedata_domcabling AS dcc
             WHERE dcc.dom_id = d.id 
             ORDER BY date_change DESC 
               LIMIT 1
          ) 
  LEFT JOIN 
    livedata_hub AS h 
        ON dc.hub_id = h.id
  WHERE 
     d.cluster = 'localhost' ; 
```

并且索引`(dom_id, date_change)`将有助于提高效率。

我不确定`d.cluster = 'localhost'`（表中有多少行`livedata_dom`与此条件匹配？）的选择性，但添加索引`(cluster)`也可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T21:38:48.347

```
set @rn := 0, @dom_id := 0;
select d.*, dc.date_change, dc.cwd, h.name as hub
from
    livedata_dom d
    left join (
        select
            hub_id, date_change, cwd, dom_id,
            if(@dom_id = dom_id, @rn := @rn + 1, @rn := 1) as rn,
            @dom_id := dom_id as dm_id
        from
            livedata_domcabling
        order by dom_id, date_change desc
    ) dc on d.id = dc.dom_id
    left join
    livedata_hub h on h.id = dc.hub_id
where rn = 1 or rn is null
order by dom_id 
```

您发布的数据没有 dom_id 249。#250 有一个空日期，所以它排在第一位。所以你的结果不能反映我对你的问题的理解。

# wordpress - 迁移到 WordPress - 第一步

> ID：12980829
> 
> 赞同：1
> 
> 时间：2012-10-19T19:05:55.207
> 
> 标签：wordpress, migration

我想将一个 html 网站迁移到 WordPress。目前我对 WP 不太熟悉，但我读过它在 CMS 方面很容易使用。（另外请注意，我只有 html 和 css 的基本编程技能）

我要迁移的网站非常小，大部分是静态页面，有 2-3 个页面，这些页面会针对事件和新闻文章持续更新（看起来像在线博客更新）。

在大多数情况下，我想保留网站的主题，然后随着网站的发展使用插件进行更新（即包括视频和互动内容）。

有人可以推荐我转换的第一步吗？我目前正在阅读专业的 WordPress，但直到本书结束时才解决迁移问题，我想继续前进（因为我的工作，我必须这样做）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:55:55.583

这是一个很好的概述视频。要了解具体情况，实际上取决于您要迁移的内容，因此我们需要更多细节。

将大规模的旧版 CMS 迁移到 WordPress 而不会失去理智：http: [//vimeo.com/21118033](http://vimeo.com/21118033)

# rrd - 将 RRD 文件导入 cacti

> ID：12980834
> 
> 赞同：1
> 
> 时间：2012-10-19T19:06:10.740
> 
> 标签：rrd, cacti

我有从不同主机收集的 rrd 文件。想将 rrd 文件导入到 cacti 实例中。我按照这里描述的[http://docs.cacti.net/manual:087:8_rrdtool.05_external_rrds](http://docs.cacti.net/manual:087:8_rrdtool.05_external_rrds)从 RRD 文件生成图表。

如何在不覆盖（追加）的情况下更新 rra 目录中的文件？

# ruby - 如何去除无效的字节序列？

> ID：12980843
> 
> 赞同：4
> 
> 时间：2012-10-19T19:06:53.353
> 
> 标签：ruby, utf-8, html-parsing

我正在抓取 html 并遇到“无效的字节序列错误”。我在另一篇文章中遵循了一些建议，并插入了以下两行代码：

```
doc_scores.encode!('UTF-16', :undef => :replace, :invalid => :replace, :replace => "")
doc_scores.encode!('UTF-8') 
```

这有助于显着减少错误，但是，我仍然在大约 10-20% 的时间内得到以下异常（换句话说，每 5 次 html 扫描中大约有 1 次）：

```
Input is not proper UTF-8, indicate encoding !
Bytes: 0xEA 0x20 0x20 0x22 
```

它总是相同的字节序列。任何想法我应该如何去删除这些？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T22:41:21.230

我想出了解决我的问题的方法。事实证明，我正在抓取的 XML 文档的编码是个问题。为了解决这个问题，我现在明确编码选项：

```
doc = Nokogiri::XML::Reader(open(url),nil,'ISO-8859-1') 
```

在我刚刚拥有之前：

```
doc = Nokogiri::XML::Reader(open(url)) 
```

希望这可以帮助某人。

# assembly - 16 位 Thumb-2 汇编指令集中的“更新条件标志”S 是如何编码的？

> ID：12980847
> 
> 赞同：1
> 
> 时间：2012-10-19T19:07:17.957
> 
> 标签：assembly, thumb

所以我需要为类编写一个非常基本的反汇编程序，我很难弄清楚可以附加到 Thumb 指令的 S 是如何编码的。

例如，指令 0x0011 对应如下汇编代码：

```
movs    r1, r2 
```

为什么不只是一个普通的mov？

同样，0x1889 对应于：

```
adds    r1, r1, r2 
```

据我通过阅读参考手册可以看出，这与没有 S 的常规 add 指令的编码相同。是这样吗？更新条件标志的指令是如何发送的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:21:40.087

gnu 汇编器非常烦人并且会弄乱指令集，但那是另一回事了。对于拇指模式，不要放 s 它会抱怨，但由于您别无选择，它总是在那里。只需执行 add r1,r2 assemble 然后反汇编，如果您仔细检查并查看与手册所述内容相关的机器指令，您也会看到添加 r1,r2，它还表明会发生更新标志

0x0011 是一个 lsl immed_5, rm, rn 所以是 lsl r1,r2,#0 不是加法。

0x1889 确实是加法 r1,r1,r2。s 在 thumb 的指令集中一点也不隐含。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T01:33:17.623

Thumb 不`S`为每条指令使用条件字段，因此每条指令都是无条件的（显然，除了条件分支）。从 32 位 ARM 到 16 位 Thumb 的部分减少涉及摆脱它。在我看来，您提供的示例不应该`s`以开头（它们不会在[本手册](http://bear.ces.cwru.edu/eecs_382/ARM7-TDMI-manual-pt3.pdf)中使用）。

Thumb 中的条件代码由您的 ALU 指令（与 ARM 相同）隐式设置，但要访问它们，您需要使用条件分支。

# ffmpeg - 使用 ffmpeg 合成 2 个视频（.mov）文件

> ID：12980851
> 
> 赞同：2
> 
> 时间：2012-10-19T19:08:03.607
> 
> 标签：ffmpeg, composite

ffmpeg 的新手用户，但通过我可以在网上找到的任何文档。

对于当前项目，我需要将 2 个视频合成在一起以创建一个 .flv 文件。

有谁知道执行此操作的命令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-20T02:52:12.917

这对我有用：

```
ffmpeg -i background_file.l -i file_to_overlay.flv -filter_complex overlay=0:0 -acodec aac -strict -2 out.flv 
```

有关详细信息，请参阅[http://ffmpeg.org/ffmpeg.html#overlay-1 。](http://ffmpeg.org/ffmpeg.html#overlay-1)您也可以在过滤器链中添加缩放器并适当地缩放。

执行 ffmpeg -filters 以查看可用的过滤器。

# c# - 使用 .net ajax 和在带有 c# 的 sharepoint web 部件中使用分页时出现意外结果

> ID：12980853
> 
> 赞同：3
> 
> 时间：2012-10-19T19:08:30.043
> 
> 标签：c#, ajax, sharepoint, web-parts, paging

好的，所以当 Web 部件加载时，我从 CreateChildControls() 函数中的列表中提取：

```
String userGroup = GetProfileProperty(SPContext.Current.Web.CurrentUser.LoginName);//get user login's newsgroup // "All";

        if (!string.IsNullOrEmpty(userGroup) && !userGroup.Equals("All"))
        {
            qry.RowLimit = 5;
            camlquery = "<Where><Contains><FieldRef Name='Intended_x0020_Audience' /><Value Type='MultiChoice'>" + userGroup + "</Value></Contains></Where><OrderBy><FieldRef Name='Start_x0020_Date' Ascending='False' /></OrderBy>";
            qry.Query = camlquery;
            items = newsList.GetItems(qry);
            //Print items inside a ajax panel....

        }
        else
        {
            qry.RowLimit = 5;
            camlquery = "<OrderBy><FieldRef Name='Start_x0020_Date' Ascending='False' /></OrderBy>";
            qry.Query = camlquery;
            items = newsList.GetItems(qry);
            ////Print items inside a ajax panel....
        } 
```

我还没有使用分页，但我已将查询列表存储在 var items 中。当用户单击一个按钮时，更新面板会清除当前控件并执行另一个查询以获取新项目，但这次我使用分页。（见下文）

```
 int lastID = items[items.Count - 1].ID;//last news item id of current page

        //Get Web Context
        SPWeb web = SPContext.Current.Web;

        //Clear old panel
        UpdatePanel up = (UpdatePanel)FindControl("Panel");
        up.ContentTemplateContainer.Controls.Clear();//clear container of old news items

        SPQuery qry = new SPQuery();//get query

        qry.RowLimit = 5;
        string camlquery = "<OrderBy><FieldRef Name='Start_x0020_Date' Ascending='False' /></OrderBy>";
        qry.Query = camlquery;
        SPListItemCollectionPosition position = new SPListItemCollectionPosition("Paged=TRUE&p_ID=" + lastID.ToString());
        qry.ListItemCollectionPosition = position;
        items = web.Lists["News Wire"].GetItems(qry);// newsList.GetItems(qry);

        //print items inside ajax panel.... 
```

它确实改变了页面，但它返回了比需要更多的项目。当 web 部件第一次加载时，我会得到 5 个，但是当我单击触发事件以获取更多列表记录的按钮时，我会得到下一页的第一个项目以及第一页的前 3 个项目。注意：我的列表中只有六个项目。我将我的 RowLimit 限制为 5，但是当我加载第二页时，我从第一页得到 4 个项目和 3 个项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:06:11.403

如果您要向前翻页，则可以将[`ListItemCollectionPosition`](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitemcollection.listitemcollectionposition.aspx)第一个查询的*结果*( `SPListItemCollection`) 传递给下一个查询 - 您不必为手动构建它而烦恼。

在获得第一组结果后，您需要将其存储在某处 - 我之前使用过 ViewState，您也可以在更新面板中使用隐藏控件。

当你向后翻页时，你确实需要像你一样创建字符串。您还需要包含一个键/值来指示您要倒退，并且您*需要包含您的排序指示*。（您可能可以从自动生成的转发分页值中获得此信息。）（我认为缺少排序是您的转发分页也不起作用的原因。）

[这](http://charliedigital.com/2010/02/05/paging-with-splistitemcollectionposition/)是我尝试自己进行此操作时使用的资源，尽管现在有点模糊。

# sql-server - Oracle DB：如果第一个查询为空，则返回第二个查询

> ID：12980854
> 
> 赞同：3
> 
> 时间：2012-10-19T19:08:37.813
> 
> 标签：sql-server, oracle, stored-procedures, plsql

我正在编写一个 Oracle 存储过程来返回数据库查询的结果。如果查询未产生任何结果，则必须在其位置运行第二个查询。

在 SQL Server 中，我可以使用类似于以下内容的方法来完成此操作：

```
INSERT INTO @TableVar
SELECT <joinQuery1>;

IF (SELECT COUNT(*) FROM @TableVar) > 0
BEGIN
    SELECT * FROM @TableVar;  -- returns <joinQuery1>
END
ELSE
    SELECT <joinQuery2>;  --returns <joinQuery2>
END 
```

但是，我不知道如何在 Oracle 中完成相同的任务。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T19:39:36.737

您可以利用 WITH 来使其性能更好（并且更易于维护）：

```
WITH query1 as (
    select 1, 2
    from dual
    where 1=0
    connect by level <= 10
),
query2 as (
    select 3, 4
    from dual
    connect by level <= 10
)
select *
from query1
union all
select *
from query2
where not exists (
    select null
    from query1
); 
```

因为这应该从 query2 返回 10 行。如果从 query1 中删除 where 1=0 （导致它实际返回行），您应该从 query1 中获取 10 行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:40:01.133

答案很大程度上取决于您将如何进一步使用查询结果。因此，您应该使用流水线函数，插入 GTT 或返回参考光标。

无论如何，我建议您在 1 个 SQL 语句中执行此操作以实现读取一致性。

所以请考虑类似

```
create procedure test (pCursor out sys_refcursor) is
begin
 open pCursor for
 select <joinQuery1>
 union all
 SELECT <joinQuery2>
 where not exists (select 1 from joinquery1)
 ;
end; 
```

# java - 当我定义的时间或系统时间为下午 12:00 时，GregorianCalendar 更改我的日期

> ID：12980856
> 
> 赞同：1
> 
> 时间：2012-10-19T19:08:43.960
> 
> 标签：java, gregorian-calendar

我正在使用以下代码作为日期时间，但是当我的 startTime="12:00 Pm" 我的 eventDate 移动下一个日期以及系统时间为下午 12:00 时，我的日期也移动到下一个日期。

帮我看看这段代码有什么问题。

```
 Date appt = new Date();
 Calendar apptDate = new GregorianCalendar();
 apptDate.setTime(appt);

 String startTime = "11:00 Pm";

 String[] appointmentHourMinute = startTime.split(":");
 String hour = appointmentHourMinute[0];
 String[] minuteAmPm = appointmentHourMinute[1].split(" ");
 String minute = minuteAmPm[0];
 String amPm = minuteAmPm[1];
 int hourInt = Integer.parseInt(hour);
 int minInt = Integer.parseInt(minute);

 Calendar eventDate = new GregorianCalendar();
 eventDate.set(Calendar.MONTH, apptDate.get(Calendar.MONTH));
 System.out.println("Display Month"+ apptDate.get(Calendar.MONTH));
 eventDate.set(Calendar.DATE, apptDate.get(Calendar.DATE));
 System.out.println("Display Month"+ apptDate.get(Calendar.DATE));
 eventDate.set(Calendar.YEAR, apptDate.get(Calendar.YEAR));
 System.out.println("Display Month"+ apptDate.get(Calendar.YEAR));
 eventDate.set(Calendar.HOUR, hourInt);
 eventDate.set(Calendar.MINUTE, minInt);
 eventDate.set(Calendar.SECOND, 0);      
 if (amPm.equalsIgnoreCase("AM")){
     if(hourInt==12)
         eventDate.set(Calendar.AM_PM,Calendar.PM);
     else
         eventDate.set(Calendar.AM_PM,Calendar.AM);         
 }else{
     if(hourInt==12)
         eventDate.set(Calendar.AM_PM,Calendar.AM);
     else
         eventDate.set(Calendar.AM_PM,Calendar.PM);   
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:00:12.580

首先，您告诉日期您想要 12:00，它解释为 24 小时时间，即中午。接下来你告诉它你想要一个“PM”时间。据了解，“PM”在中午或午夜的使用是模棱两可的，并且可能经常表示中午。但似乎在这种特殊情况下，Java 会将其解释为午夜。一般来说，它假设上午时间是在一天的前半段，所以当你从上午切换到下午时，它可以简单地将 12 添加到小时字段。这会在第二天的 0:00 让你失望。

如果您想避免这种情况，您可能需要先设置时间，然后再设置日期。在您的情况下，这意味着首先读取日期并稍后恢复。作为替代方案，您可以自己处理 +12 小时，在特殊情况下将 24:00 转回 0:00。

# javascript - 迭代字符串数组会产生错误

> ID：12980860
> 
> 赞同：0
> 
> 时间：2012-10-19T19:08:54.803
> 
> 标签：javascript

我传入一组错误消息以进行解析。一个示例输入是：

```
"An item with this x Id already exists.
 An item with this y id already exists.
 An item with this barcode already exists.
" 
```

也就是说，字符串实际上是上面的每一行，由 \n 分隔，最后是 \n。

```
function( msg )
{
  alert( "\"" + msg + "\"" );
  var aLines = msg.split( /\r?\n+/ );

  for ( var i in aLines )
  {
     if ( !aLines[i] ) { alert( "Error!" ); continue; }
     alert( i + ": \"" + aLines[i]  + "\"" );
  }
} 
```

我把它分成几行，然后遍历这些行。在索引 3 处没有行，第一个条件触发器。那不应该是空行吗？例如“”

然后循环实际上又增加了一个元素到 4，并显示了一个函数的内容。

那就是我得到 - 五个警报：

```
0: "An item with this x Id already exists."
1: "An item with this y id already exists."
2: "An item with this barcode already exists."
Error! 
```

最后一个最离奇：

```
hasObject: "function(o) {
    var l = this.length + 1;
    ... more lines ...
} 
```

我不明白这里发生了什么。为什么它要遍历另一个元素？为什么最后一个元素是函数？offset 3 不应该是一个空字符串吗？那就是我不应该警告“错误！” 这里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:13:17.260

[永远不要使用 for...in 循环遍历数组。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in)

> 以任意顺序迭代**object**的可枚举属性。

[为什么在数组迭代中使用“for...in”是个坏主意？](https://stackoverflow.com/questions/500504/javascript-for-in-with-arrays)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:16:46.927

正如 jbabey 所说，`for .. in`在 Javascript 中使用循环是有风险且不确定的（有时是随机顺序）。您最常使用它来解析关联数组中的对象。但是，如果您坚持保留，请用这样的块`for .. in`包裹 的内部：`for``if`

```
for (var i in aLines)
{
    if(aLines.hasOwnProperty(i))
    {
        // ... Do stuff here
    }
} 
```

否则，只需将其更改为经典的增量`for`循环即可消除该错误：

```
for (var i = 0; i < aLines.length; i++)
{
   if ( !aLines[i] ) { alert( "Error!" ); continue; }
   alert( i + ": \"" + aLines[i]  + "\"" );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:21:53.410

您应该对数组使用常规 for 循环，因为 for-in 还将返回 Array 对象中的所有其他属性键。这就是为什么您会看到“hasObject”（在我的浏览器中，之后我会看到更多）：因为您的数组具有函数“hasObject”，所以当您枚举数组的所有属性时，就会出现这种情况。

正确的for循环：

```
 for ( var i = 0, ii = aLines.length; i<ii; i++ )
  {
    if ( !aLines[i] ) { alert( "Error!" ); continue; }
    alert( i + ": \"" + aLines[i]  + "\"" );
  } 
```

这是用 for 循环替换 for-in 循环的代码，它按预期工作：

[http://jsfiddle.net/SamFent/4rzTh/](http://jsfiddle.net/SamFent/4rzTh/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:33:49.190

你`Error!`最后是因为拆分给了你空行`""`，当你用它检查它时，`if(!aLines[i])`它会返回`true`，因为它是空的/空的/什么都没有。您可以在这里检查一下[，](http://jsfiddle.net/amantur/NB3n7/)从末尾删除空行，它不会超过数组 4 次。

我还输入了以下显示警报的代码：

```
 var a="";
    if(!a){
        alert("!a");
    } 
```

# vb.net - 如何从资源文件中填充 ImageList

> ID：12980861
> 
> 赞同：1
> 
> 时间：2012-10-19T19:08:56.507
> 
> 标签：vb.net, imagelist

只是想知道是否有办法从资源文件中填充 ImageList。我在网上四处张望，但一切似乎都来自 2003/2005 年。

任何建议将不胜感激提前感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-15T00:21:57.503

这是一个将资源中的所有图像读入 ImageList 的示例。

```
var dynamicImageList = new ImageList();
var resourceSet = MyResourceClass.ResourceManager.GetResourceSet(CultureInfo.InvariantCulture, true, false);
if (resourceSet != null)
{
   foreach (DictionaryEntry entry in resourceSet)
   {
      var value = entry.Value as Bitmap; //only get images
      if (value != null)
      {
          dynamicImageList.Images.Add((string) entry.Key, value);
      }
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:12:13.353

试试这个

```
 Private m_clsImageList as ImageList

Private Sub Form_Load(ByVal sender As Object, ByVal e As EventArgs)
    m_clsImageList = New ImageList()
    m_clsImageList.Images.Add("add", My.Resources.add) 
    m_clsImageList.Images.Add("cut", My.Resources.cut) 
End Sub 
```

或者

```
resources = new ResourceManager("Icons", assemby-containing-icons.resx);
imageList.Images.Add((Image)resources.GetObject("image-resource-name"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-29T15:40:09.040

你试过循环这个吗？我知道这是一篇旧文章，但你为什么要输入 100 行相同的代码 +- 1 个变量？

# iphone - Cocos2d - 我可以将多个精灵帧加载到帧缓存中吗

> ID：12980868
> 
> 赞同：1
> 
> 时间：2012-10-19T19:09:38.593
> 
> 标签：iphone, objective-c, ios, cocos2d-iphone, sprite-sheet

在 Cocos2d v0.99 中有一个名为 CCSpriteFrameCache 的类。我可以加载所有的精灵帧

```
[[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"images.plist"]; 
```

然后我可以使用那些加载的帧

```
CCSprite *sprite=[CCSprite spriteWithSpriteFrameName:@"img01.png"]; 
```

现在我的问题是：我们是否创建一个大的精灵表来保存我们将用于动画的每一个图像？我的意思是，我想我会有几个用于不同动画对象的精灵表。如果这个问题的答案是“否”，以便我以不同的方式加载每个精灵，那么我的第二个问题是如何引用特定精灵表中的帧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:23:07.900

> 现在我的问题是：我们是否创建一个大的精灵表来保存我们将用于动画的每一个图像？

是的，或者如果你有许多不同的帧图像，你可以有多个精灵表......

> 我的意思是，我想我会有几个用于不同动画对象的精灵表。

这取决于生成的精灵表的大小。原则上在同一张sheet中组织同一个动画的不同帧比较方便，但是如果你的帧占用，比如600x600，你的sprite sheet会和1024x1024的sheet占用相同的内存，所以最好多加一些帧到同一张纸，即使它属于不同的动画。通常，您可以使用图纸尺寸，只要两个尺寸都是 2 的幂，您就不会在内存占用方面效率低下，如果这对您有意义，您可以将框架组织成不同的图纸。

> 如果这个问题的答案是“否”，以便我以不同的方式加载每个精灵，那么我的第二个问题是如何引用特定精灵表中的帧？

由组成精灵表的原始文件名...

希望能帮助到你...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T19:53:19.697

如果可能，将尽可能多的图像塞进尽可能少的纹理图集中。决定因素通常是 z 排序。如果你有两个图集和两个精灵批处理节点，那么每个精灵批处理节点只能按照它们的 z 顺序渲染它们的精灵，而另一个批处理节点中的精灵要么总是在前面，要么总是在后面。

您不需要知道精灵帧来自哪个纹理图集（精灵表）。只需按名称引用它。如果您需要知道帧所指的纹理，请检查精灵帧的纹理属性，并将其与精灵批处理节点的纹理属性进行比较。

# xml - /usr/share/gdb/syscalls 用于什么

> ID：12980870
> 
> 赞同：3
> 
> 时间：2012-10-19T19:09:49.777
> 
> 标签：xml, linux, gdb, system-calls

我在以下位置找到了三个目录`/usr/share/gdb`：

*   `auto-load`：这用于自动加载的脚本；
*   `python`：这用于 gdb python 扩展；
*   `syscalls`：这包含几个 xml 文件，如 amd64-linux.xml，我无法通过谷歌找到任何信息。

顺便说一句：我的操作系统是 Fedora 13。

谁能告诉我这些 xml 文件的用途？谢谢并恭祝安康！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T12:04:31.563

较新的 GDB 可能会中断系统调用：

```
(gdb) help catch syscall
Catch system calls by their names and/or numbers.
Arguments say which system calls to catch.  If no arguments
are given, every system call will be caught.
Arguments, if given, should be one or more system call names
(if your system supports that), or system call numbers. 
```

例子：

```
$ gdb /bin/true
(gdb) catch syscall exit_group 
Catchpoint 1 (syscall 'exit_group' [231])
(gdb) run
Starting program: /usr/bin/true 

Catchpoint 1 (call to syscall exit_group), 0x00000038464baa09 in __GI__exit (status=status@entry=0)
    at ../sysdeps/unix/sysv/linux/_exit.c:33
33        INLINE_SYSCALL (exit_group, 1, status); 
```

XML 文件提供系统调用名称到编号的映射，例如`exit_group`x86-64 Linux 上的系统调用编号为 231。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T19:13:04.907

这是一个非常简单的列表，它告诉 GDB 哪些系统调用号映射到特定系统上的哪些系统调用（因为它们是特定于体系结构的）。

它们是从相应的 Linux 内核头文件生成的（例如`arch/x86/include/asm/unistd_32.h`for `linux-i386`）。

例子：

```
<syscalls_info>
  <syscall name="restart_syscall" number="0"/>
  <syscall name="exit" number="1"/>
  <syscall name="fork" number="2"/>
  <syscall name="read" number="3"/>
  <syscall name="write" number="4"/>
  <syscall name="open" number="5"/>
  ...
</syscalls_info> 
```

# javascript - .parents() 没有 jquery - 或 querySelectorAll 为父母

> ID：12980877
> 
> 赞同：18
> 
> 时间：2012-10-19T19:10:20.103
> 
> 标签：javascript, parent, selectors-api

> **可能重复：**
> [使用matchesSelector js检查event.target.parentElement](https://stackoverflow.com/questions/12977658/check-event-target-parentelement-with-matchesselector-js)

我有一个 dom 对象，我想匹配它的父母，所有父母，反对一个选择器，比如`querySelectAll()`，但对于父母而不是孩子。类似于 jQuery 的`.parents('selector')`方法，但我不需要任何向后兼容性。另外，请不要图书馆。我将 totes 取一个布尔返回值。

我可以自己将其编写为递归函数/for/while 使用`matchesSelector()`. 我正在寻找鲜为人知的方法或更高效的代码。

节省任何处理都是值得的。想想数以万计的匹配检查，甚至更多。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-19T19:35:12.047

您会想要使用`while()`循环，因为我们不知道我们拥有的确切父母数量

**[jsFiddle 演示](http://jsfiddle.net/wtgxry0v/)**

```
function getParents(el, parentSelector /* optional */) {

    // If no parentSelector defined will bubble up all the way to *document*
    if (parentSelector === undefined) {
        parentSelector = document;
    }

    var parents = [];
    var p = el.parentNode;

    while (p !== parentSelector) {
        var o = p;
        parents.push(o);
        p = o.parentNode;
    }
    parents.push(parentSelector); // Push that parentSelector you wanted to stop at

    return parents;
} 
```

### 用法：返回一个“父母”数组

```
// 2nd param optional, bubbles up to document
getParents( document.getElementById('me') ); 

// get all parents starting from -me- up to ID -outerParent-
getParents( document.getElementById('me'), document.getElementById('outerParent') ); 
```

# immutability - 无状态和不可变有什么区别？

> ID：12980884
> 
> 赞同：16
> 
> 时间：2012-10-19T19:10:43.570
> 
> 标签：immutability, stateless

我经常听到术语“无状态”和“不可变”。例如，HTTP 是无状态协议，String 对象是不可变对象。但我很难理解两者之间的区别。当我创建一个无状态对象时，它不会在内部存储任何“状态”数据。如果我创建一个不可变对象，则意味着它永远不会改变。

*   [http://en.wikipedia.org/wiki/State_(computer_science)](http://en.wikipedia.org/wiki/State_%28computer_science%29)
*   [http://en.wikipedia.org/wiki/Immutable_object](http://en.wikipedia.org/wiki/Immutable_object)

这不是同一个意思吗？

由于不可变对象不会改变，根据定义它不能有状态。这就是它永远的样子。如果一个对象没有状态，它就不能被改变（根据定义）。因此，不是所有的无状态对象都是不可变的和不可变的对象是无状态的吗？

什么是可变无状态对象或不可变有状态对象的示例？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T19:13:18.867

上下文很重要，这里有两个*不相关*的概念。

“HTTP 是一种无状态协议”意味着*每个请求对其他请求没有隐含的了解*，包括同一客户端发送的任何先前请求。这与建立连接然后发送不同命令的 FTP 或 SMTP 等协议不同——每个命令/请求都与同一个客户端/连接“关联”。当然状态/跟踪是通过添加回来的。cookie 和跟踪 URI，甚至是流水线——但关键是每个请求在 HTTP 协议中都是“新的”和“独立的”。

“字符串是一个不可变的对象”意味着该*特定对象的数据将始终与它现在在每种可观察方式中的数据相同*（这也意味着*不可*更改的可观察属性）。一些纯粹主义者可能会争辩说它具有比这更深层次的含义，但实际上是关于可观察属性 - 当不可变对象可以“包含”可变对象时，问题变得更加复杂。

（是的，从技术上讲，*没有允许的数据*或状态的对象无法更新，因此是“不可变的”。然而，再一次，*上下文很重要*，谈论大象或树干上的尖牙很奇怪在老虎身上。）

### 编辑：两者之间的区别

> 没有状态的对象是无状态的。所有无状态对象都是不可变的（因为没有什么可以改变的）；这是一个重言式的技术性。一个对象可以有状态并且仍然是不可变的——但是，一个有状态（不可变或其他）的对象不能再被认为是无状态的。根据[对链接答案的评论](https://stackoverflow.com/questions/9735601/what-is-stateless-object-in-java#comment12380374_9735625)：“[一个不可变对象]只有一个状态”，即初始状态。
> 
> ——来自[我的评论](https://stackoverflow.com/questions/12980884/what-is-the-difference-between-stateless-and-immutable#comment17606619_12980923)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-19T19:12:40.677

不，它们的意思不同。

不可变对象永远不会改变。这并不意味着该对象中包含的数据不能指示状态。它只是意味着如果你想表示状态的变化，你需要创建一个新的对象。

无状态意味着没有状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-04T11:32:26.300

我会说在某些情况下这是同一件事，但我们关注的方面略有不同。

当人们说“无状态”意味着它没有状态时，这让我发笑。当然，从某种角度来看，它有一些状态，例如，无状态服务可以由复杂的对象图（依赖注入）支持。问题是网络协议对“状态”的含义略有不同：它取决于先前的请求/响应。但是根据定义，不可变服务也不依赖于先前的调用。

“无状态”并不总是与 HTTP 协议相关，我们可以使用同一个术语来争论您闪亮的 OOP 代码中服务对象中的设置器。在这里您可以看到这两个术语实际上是相同的：不可变服务是无状态服务，反之亦然。

但是，将值对象称为“无状态对象”对我来说很尴尬。听起来很可怕。

回顾：如果是服务（网络或 OOP，没关系），我会说这些术语是可以互换的。

举个例子：

```
interface Logger
{
    public function logWarning(string $message);
    public function logError(string $message);
} 
```

我们调用了多少次`logWarning`或`logError`调用的顺序也无关紧要。因此，我们可以称之为“无状态服务”。

但是这个服务也没有设置器和任何修改器，比如`changeFileName()`-> 它是一个不可变的服务/对象。

可变性使对象有状态。有状态使对象可变。这些术语在服务上下文中是相互依赖的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T19:17:11.233

它们绝对不一样。

不可变对象是永远不会改变的。不可变对象的状态永远不会被修改，不可变对象的别名是无害的，不可变对象不需要别名控制，尽管可能需要别名控制来证明对象实际上是不可变的。

无状态意味着没有状态。HTTP 被称为无状态协议，因为每个命令都是独立执行的，而不知道它之前的命令。它基于请求范例。在此协议中，通信通常通过 TCP/IP 协议进行。

# grails - Buildpack 读取配置

> ID：12980887
> 
> 赞同：1
> 
> 时间：2012-10-19T19:10:53.747
> 
> 标签：grails, heroku, buildpack

我试图从heroku应用程序配置中读取用于战争构建的Grails环境，这可能吗，在这种情况下该怎么做？它是否设置在 ENV 变量中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:30:16.023

不，这是不可能的。Buildpacks 独立于配置运行。（为了说服自己，运行`heroku config:set`并观察输出：没有 slug 编译器。）这与 12-Factor App 的[Build、Release、Run](http://www.12factor.net/build-release-run)方面一致，它将构建（slug 编译器和 buildpack）、发布（附加对其配置的构建）和运行（为给定版本启动 dynos）。

通常的解决方案是让您的 buildpack 发出文件，这些文件读取环境并在运行时适当地采取行动。例如，Rails 从 读取数据库配置`config/database.yml`，而 Heroku 在`ENV['DATABASE_URL']`. 因此，buildpack[使用这个模板](https://github.com/heroku/heroku-buildpack-ruby/blob/master/lib/language_pack/ruby.rb#L442)生成一个文件，它使 Rails 使用配置中指定的数据库，允许在不重新构建整个应用程序的情况下更改配置。

# javascript - 我可以嵌入 Twitter 搜索时间线并动态传递搜索参数吗？

> ID：12980891
> 
> 赞同：14
> 
> 时间：2012-10-19T19:11:12.343
> 
> 标签：javascript, python, search, twitter, timeline

是否可以创建动态时间线？我想嵌入一个搜索时间线，我可以在其中使用一些 javascript 或 python 更改搜索键。如果这是不可能的，有人可以提出解决方法吗？我想我可以使用 GET 搜索并嵌入每条推文......

# memcached - 如何序列化杰克逊的 JsonNode 对象？

> ID：12980892
> 
> 赞同：5
> 
> 时间：2012-10-19T19:11:15.297
> 
> 标签：memcached, jackson

我正在用 memcached 替换内部缓存系统，但 memcached 客户端无法缓存`JsonNode`对象，因为它们没有实现`Serializable`. 有什么方法可以实现`JsonNode`对象的序列化？杰克逊是否提供`Serializable`与此类同等的课程？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-20T00:12:46.010

JSON最好通过将其写为字节来序列化。在杰克逊，它是使用完成`ObjectMapper`的，例如：

```
byte[] raw = objectMapper.writeValueAsBytes(root); 
```

MemCache 并不真正需要 Serializable，因为它都是原始字节；尽管 Java 客户端可能会尝试提供帮助并处理序列化。

# java - 优秀的 Java MVC 安全框架

> ID：12980904
> 
> 赞同：-1
> 
> 时间：2012-10-19T19:12:06.953
> 
> 标签：java, model-view-controller

谁能推荐我一个好的身份验证安全框架，允许用户通过电子邮件地址作为用户名进行身份验证，并允许用户拥有单独的屏幕名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:17:24.730

春季安全。它具有很好的功能，可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:16:14.720

你应该看看 Spring Security： [http ://static.springsource.org/spring-security/site/](http://static.springsource.org/spring-security/site/)

# vb.net - 如何设置零而不是空

> ID：12980906
> 
> 赞同：0
> 
> 时间：2012-10-19T19:12:13.670
> 
> 标签：vb.net, datagrid, datagridview

使用 VB.Net

我想让 datagird 单元格值为零而不是 null

例如

数据网格视图1

```
Id value1 value2 value3

01 null null 0
02 0 null 10
03 100 null 100
... 
```

预期产出

```
Id value1 value2 value3

01 0 0 0
02 0 0 10
03 100 0 100
... 
```

我有超过 80 列和 100 行，而不是一个一个检查单元格，任何其他方法都可用

尝试过的代码

```
 Private Sub dataGridView1_CellFormatting(sender As Object, e As DataGridViewCellFormattingEventArgs)
        If e.ColumnIndex = 0 AndAlso e.Value IsNot Nothing Then
            If CInt(e.Value) = 0 Then
                e.Value = ""
            End If
        End If
    End Sub 
```

上面的代码无法正常工作，当我从数据库中添加 datagridview 中的详细信息时，也显示空单元格。

如何使零而不是空。任何其他方法或建议

需要VB.Net代码帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T19:27:08.827

*   右键单击 DatagridView，然后单击属性。
*   在属性窗口中，找到 DefaultCellStyle
*   单击选项卡
*   在出现的对话框中，指定 NullValue

![在此处输入图像描述](../Images/77b3b122f9e99b8d455a844f40f2a5f3.png)

您也可以从代码中设置它

> **dataGridView1.DefaultCellStyle.NullValue = 0;**
> 
> 获取或设置与 System.DBNull.Value 或 null 的单元格值对应的 System.Windows.Forms.DataGridView 单元格显示值。

# jquery - html 弹出窗口中的 Socket.IO 聊天

> ID：12980910
> 
> 赞同：0
> 
> 时间：2012-10-19T19:12:29.457
> 
> 标签：jquery, node.js, popup, socket.io

我尝试使用生成的私人消息弹出窗口进行 Socket.IO 聊天。我在弹出窗口代码中使用 windows.opener var 来访问主页中的变量和函数。在 Firefox 和 Chrome 中，window.opener.socket.on(...) 函数从弹出窗口代码成功启动，但 IE9 不会。Node.js 服务器在后台发送和接收事件。我使用以下代码：

```
 //in index.php
    var socket = io.connect('http://localhost:8080');
     //other code
    $("#users .user").live('click',function(){
    //other code
    popUpWin[client_id]=window.open('private.php', client_id, 'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbar=no,resizable=no,copyhistory=yes,width=300,height=400,left=' + left + ', top=' + top + ',screenX=' + left + ',screenY=' + top + '');         
    //other code        
    });

    //in private.php
    //other code
    window.opener.socket.emit('popup',window.opener.client_id);//This work!         
    window.opener.socket.on('private_message', function (data) {This not work, private message event is send!
        $("#private_data_recieved").append('<div><b>'+data.nick+':</b> '+parseString(data.message)+'</div>');
        playSound();                        
    }); 
        //other code 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:36:25.503

IE9 不支持原生 websocket。所以 socket.io 库在 xhr-polling 系统上做了一个后备。这会导致 IE 出现一些问题（老实说，我不知道）。

但是，如果您像这样改变解决问题的方法：

在 index.php 中

```
var EVENT = module.exports.EVENT;
var socket = io.connect('http://78.46.135.87:8060');
var win;
socket.on('private_message',function(data) {
    win.receivedPrivate(data);
});

function openPrivate() {
    win =window.open('private.php', 1, 'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbar=no,resizable=no,copyhistory=yes,width=300,height=400');         
}
function popupReady() {
     socket.emit('popup',"1");
}
// and html
<a href="#" onclick="openPrivate()">Open private</a> 
```

在 private.php 中

```
window.receivedPrivate = function(data) {
    $('#private_data_recieved').append(data);
}
window.opener.popupReady(); 
```

它应该有效。`index.php`我将套接字的逻辑移到了逻辑`private.php`视图中。我已经对其进行了测试，并且可以正常工作。

# mysql - 创建 SQL 查询时遇到问题

> ID：12980911
> 
> 赞同：3
> 
> 时间：2012-10-19T19:12:29.677
> 
> 标签：mysql, sql

我一直在考虑如何编写这个 SQL 查询有一段时间了，但是在考虑了几个小时之后，我想我会问 SO 社区，看看他们是否有任何想法。

这是表格相关部分的模型：

## 合同

*   ID
*   日期
*   ar（是/否）
*   学期

## 付款

*   合同编号
*   付款日期

查询的目的是确定每个月我们预期的付款数量与我们收到的付款数量。

**预期付款的条件***如果**为“是”*， 预期付款将在`contracts.term`几个月后开始。预计付款将持续到第一次错过付款后的一个月。`contracts.date`*`contracts.ar`*

这还有一个复杂的问题：*付款可能会延迟，但它们需要显示为好像在预期日期付款一样。*

数据都在那里，但我一直无法理解 SQL 查询。我不是 SQL 专家——我只是有相当多的处理简单查询的经验。如果可能的话，我想避免在代码中过滤结果——但如果没有你的帮助，这可能是我必须做的。

## 预期产出

```
Month    Expected Payments    Received Payments
January  500                    450
February 498                    478
March    234                    211
April    987                    789
... 
```

## SQL小提琴

我创建了一个 SQL Fiddle：[http ://sqlfiddle.com/#!2/a2c3f/2](http://sqlfiddle.com/#!2/a2c3f/2)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:18:44.640

在不写查询的情况下，我可以给你一个大致的想法：在合同表中，`date + term`以月份为单位，并将结果集按月份分组，其中 ar = 'YES'。这为您提供了预期的付款。

使用第二个表，将 payment_date 转换为月数，并按月对收到的付款数进行分组。

然后，您可以按月加入这两个子结果，以在一个结果集中获取两条信息。

# python - Python 脚本破坏了 linux shell

> ID：12980912
> 
> 赞同：3
> 
> 时间：2012-10-19T19:12:36.023
> 
> 标签：python, linux, shell, ssh, subprocess

我有一个使用以下模块的 Python 脚本：

```
import sys, getopt, os, time, subprocess 
```

当我运行这个脚本时，输出会在某些时候开始“tabbing”。

预期输出：

```
line1
line2
line3 
```

我得到的输出：

```
line 1
          line 2
                    line 3 
```

当脚本完成或我退出它时，我的 shell（通过 SSH）会损坏。我看不到我正在输入的内容，并且按 Enter 不会创建新行，而只会创建“选项卡”（按几次 Enter 的输出，然后

```
ps ax | grep [s]sh 
```

，然后再输入几次）：

![问题](../Images/972baaa0e3312aada2e95bdaf4efb181.png) 关于可能导致此问题的原因以及如何解决或调试它的任何想法或想法？

# c# - 尝试从 WinJS 读取 C# WinRT 组件中的空字符串时出现异常

> ID：12980915
> 
> 赞同：13
> 
> 时间：2012-10-19T19:13:02.300
> 
> 标签：c#, windows-runtime, winjs

我有以下场景： C# 中的数据库编译为 Windows 运行时组件。

它的一个类如下所示：

```
public sealed class MyData
{
  string TheGoods { get; private set;}
} 
```

UI 在 WinJS 中，我有以下内容：

```
var b = dataInstance.theGoods; 
```

问题是我得到一个异常并且属性中有以下内容：

System.ArgumentNullException 在 System.StubHelpers.HStringMarshaler.ConvertToNative（字符串托管）

查看 HStringMarshaler.ConvertToNative 的实现，如果字符串为空，它似乎会抛出。

这是否意味着不可能向 WinJS 公开一个空字符串？这是 WinJS 限制还是适用于所有 WinRT？

虽然 string.Empty 确实有效，但它在语义上与 null 不同，并且在某些情况下，empty 是有效的并且与 null 不同。

如果我将属性的类型更改为“对象”，那么它确实可以工作，但是当它真的应该是一个字符串时暴露一个对象似乎很讨厌。有任何想法吗？文档对此非常了解

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-19T19:26:00.287

Windows 运行时字符串类型是一种值类型，没有空值。出于这个原因，.NET 投影禁止跨 Windows 运行时 ABI 边界传递空 .NET 字符串。

Windows 运行时使用的字符串类型就是[`HSTRING`](http://msdn.microsoft.com/en-us/library/br205775.aspx)类型。虽然此类型没有 null 值，但它确实有一个 null*表示形式*（即，在 C++ 中`HSTRING s = nullptr;`是有效的）。具有`HSTRING`null 表示的 an 是一个空字符串。

The .NET projection converts this null representation into an empty string (`String.Empty`) for strings coming in from the ABI boundary, and prohibits actual null .NET strings from being passed back across the ABI boundary.

# php - 在codeigniter中取消设置子视图的视图变量

> ID：12980918
> 
> 赞同：2
> 
> 时间：2012-10-19T19:13:07.977
> 
> 标签：php, codeigniter, codeigniter-2

控制器

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Main extends CI_Controller 
{

    public function index()
    {
        $this->load->model('Event');
        $todays_events = $this->Event->get_todays_events();     

        $data = array(
            'todays_events' => $todays_events
        );
        $this->load->view('main/index', $data);
    }
}
?> 
```

主/索引视图

```
<?php $this->load->view('partial/header'); ?>
<?php $this->load->view('components/calendar/mon_to_wed'); ?>
<?php $this->load->view('partial/footer'); ?> 
```

组件/日历/mon_to_wed

（可以访问 $todays_events，这是为什么呢？）

```
<div id="calendar_today">
    <h1>Whats Happening</h1>
    <?php foreach($todays_events as $event) : ?>
        <?php var_dump($event); ?>
    <?php endforeach; ?>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T22:20:46.073

我已经阅读了 CodeIgniter 核心文件，虽然破解核心可能会解决这个问题，但存在另一种有助于防止在内部视图中定义变量的方法。

在第一个`view`文件中，执行以下指令：

```
foreach ($_ci_vars as $key => $value) $_ci_vars[$key]=NULL;

$this->load->view('your-inner-view', $_ci_vars);
$this->load->view('your-second-inner-view', $_ci_vars);
$this->load->view('your-third-inner-view', $_ci_vars);
// and so on... 
```

如果我找到更好的解决方案，我会更新我的帖子

**更新：**

最后！我找到了真正的解决方案，最好创建自己的`Loader`类而不是使用默认类。执行以下说明：

*   将`Loader.php`课程从复制`/system/core/`到您的`/application/core/`
*   `$this->_ci_cached_vars = array_merge($this->_ci_cached_vars, $_ci_vars);`在第 805 行查找
*   将该行更改/替换为`$this->_ci_cached_vars = $_ci_vars;`

CodeIgniter 有一个变量缓存，一旦你使用`load->view()`方法，变量将被缓存在一个数组中，第二次使用`load->view()`导致合并`cached`变量和`new`变量如果存在，然后将结果缓存为一个新数组（包含旧变量）。

因此，停止使用 of`array_merge()`将是解决方案；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-27T20:33:42.657

给定的答案可能适用于单个视图，当从多个子视图组装视图时，整体视图的任何数据都会被上述修复删除。

对我有用的是将子视图的这些数据项显式设置为`null`不需要它们。

例如，子视图期望`$a`和。`$b``$c`

我们第一次渲染我们传递的子视图`$data['a'=>'whatever', 'b'=>'whatever', 'c'=>'whatever']`并且视图被正确渲染。

第二次通过时`$data['a'=>'whatever']`，$b 和 $c 会在子视图中使用第一次调用的数据进行渲染。相反，如果我们通过`$data['a'=>'whatever', 'b'=>null, 'c'=>null]`，则**b**和**c**不会在子视图中呈现。

这当然是假设您在子视图中使用数据之前检查数据是否为空。

# python - 为什么 matplotlib 的 Slider 只允许 0-7 的范围？

> ID：12980919
> 
> 赞同：1
> 
> 时间：2012-10-19T19:13:08.910
> 
> 标签：python, plot, matplotlib, bit-manipulation

我正在尝试在 1 个字节上绘制按位循环移位的值。我想要一个滑块让我更改原始输入值。我使用 matplotlib 站点上的滑块示例作为参考，但由于某种原因，即使我在运行脚本时将 0-255 作为滑块范围传递，但范围始终为 0-7。我猜想滑块以某种方式被锁定到我的最大 x 值数量，但我不知道如何。如何让滑块让我选择完整的 0-255 范围？

此外，尽管我给了滑块的最小值/最大值，但它会在前面插入一些低于 0 的填充，并在滑块中间随机绘制一条垂直线。我该如何摆脱它？（还有什么用？目的对我来说并不明显）

滑块的图片最多只能达到 7： ![在此处输入图像描述](../Images/c1f19c0e4dbc848140ed2af4ed4eb76e.png)

代码：

```
import matplotlib.pyplot as plt
from matplotlib.widgets import Slider

from numpy import uint8
from numpy import uint16
from numpy import uint32
from numpy import uint64

def sizeof(x):
    return [uint8, uint16, uint32, uint64].index(x) + 1

def rot(x, i):
    return type(x)((x >> i) | (x << (sizeof(type(x))*8 - i))) 

def plotShifts(x):
    origType = type(x)
    maxval = type(x)(-1)

    numrots = sizeof(type(x)) * 8
    vals = [rot(x, i) for i in range(numrots)]

    print vals

    l, = plt.plot(range(numrots), vals, 'ro')

    axcolor = 'lightgoldenrodyellow'
    inputax = plt.axes([0.15, 0.05, 0.65, 0.03], axisbg=axcolor)
    inputsl = Slider(inputax, 'Input', 0, maxval, valinit=0, valfmt="%d")

    def update(x):
        vals = [rot(origType(x), i) for i in range(numrots)]
        l.set_ydata(vals)
        plt.draw()
    inputsl.on_changed(update)

    plt.axis([-0.5, numrots-1 + 0.5, -2, maxval + 2])

plotShifts(uint8(1))
plt.show() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:41:03.120

问题出在最后一行`plt.axis([-0.5, numrots-1 + 0.5, -2, maxval + 2])`，它作用在保持滑块的轴上，而不是作用在带有数据的轴上。

我建议使用 OO 接口`matplotlib`而不是`pyplot`任何编程接口。该`pyplot`界面非常适合交互的东西，但它有很多隐藏状态。

`slider`由于回调的工作方式，您还需要返回对该对象的引用。

```
import matplotlib.pyplot as plt
from matplotlib.widgets import Slider

from numpy import uint8
from numpy import uint16
from numpy import uint32
from numpy import uint64

def sizeof(x):
    return 2 ** [uint8, uint16, uint32, uint64].index(x)

def rot(x, i):
    return type(x)((x >> i) | (x << (sizeof(type(x))*8 - i))) 

def plotShifts(x):
    fig = plt.figure() # make a new figure
    ax = fig.add_axes([0.15, 0.2, 0.65, 0.7]) # add data axes
    origType = type(x)
    maxval = type(x)(-1)

    numrots = sizeof(type(x)) * 8
    vals = [rot(x, type(x)(i)) for i in range(numrots)]

    print vals
    print maxval
    l, = ax.plot(range(numrots), vals, 'ro') # plot to data axes

    axcolor = 'lightgoldenrodyellow'
    inputax = fig.add_axes([0.15, 0.05, 0.65, 0.03], axisbg=axcolor)
    inputsl = Slider(inputax, 'Input', 0, maxval, valinit=0, valfmt="%d")

    def update(x):
        vals = [rot(origType(x), origType(i)) for i in range(numrots)]
        l.set_ydata(vals)
        plt.draw()
    inputsl.on_changed(update)

    ax.set_ylim([-2,maxval +2]) # set ylim on data axes
    ax.set_xlim([-.5,numrots-1+.05]) # set xlim on data axes

    return inputsl

sldr = plotShifts(uint8(1))
plt.show() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:20:39.640

很可能是因为这一行中的 maxval =7

```
inputsl = Slider(inputax, 'Input', 0, maxval, valinit=0, valfmt="%d") 
```

# llvm - pypy 在浏览器中？

> ID：12980920
> 
> 赞同：4
> 
> 时间：2012-10-19T19:13:11.093
> 
> 标签：llvm, pypy, emscripten, google-nativeclient

有谁知道让 pypy 在浏览器中运行的任何尝试？

我问是因为pypy可以针对llvm，目前在浏览器中运行llvm有两种方式：pnacl和emscripten。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T23:41:36.953

没有尝试AFAIK。但是浏览器中的 PyPy 会很棒。我们可以使用 Emscripten 将 PyPy C++ 代码编译成 JavaScript，并在 PyPy 中将 JIT 实现为 JS（它被翻译成 JS，但更重要的是发出 JS）。这实际上可能非常快，因为热代码最终会被 JITed 到 JS 中，然后由 JS VM 进行 JITed。

我在黑客新闻、programming.reddit 等网站上多次提出了这个想法，希望能引起 PyPy 开发者的兴趣并与之合作。到目前为止还没有运气，但希望有一天会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-02T16:49:01.170

考虑到[PNaCl 位码是基于 LLVM 的](https://developers.google.com/native-client/dev/reference/pnacl-bitcode-abi)，问题似乎只是让 RPython 产生正确的位，但[LLVM 似乎不允许](https://rpython.readthedocs.org/en/improve-docs/faq.html#could-we-use-llvm)在运行时修改位码，所以 PyPy JIT 不起作用。

# php - Soundcloud + PHP：在没有 Soundcloud 屏幕的情况下进行身份验证并上传曲目

> ID：12980921
> 
> 赞同：0
> 
> 时间：2012-10-19T19:13:12.350
> 
> 标签：php, oauth, soundcloud

我正在使用 Soundcloud API 构建一个简单的站点，该站点需要执行以下操作：

-- 将曲目上传到单个帐户而不请求用户身份验证（即，在没有 Soundcloud 屏幕的情况下进行身份验证）

-- 在网站和地图上以网格或列表的形式显示这些曲目（我将使用地理标记功能）

我正在使用 PHP，这对于大多数情况来说应该很棒。但是 - 我被困在身份验证和上传部分，并且渴望帮助或示例可能允许我使用 PHP 执行此操作，或者如果我需要使用 Ruby 或 Python，我怎样才能避免重写我已经完成的部分在PHP中到目前为止，并整合了这两个东西？如果有人能指出我如何使用 PHP 来完成，那将是完美的！

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T23:23:06.003

> 将曲目上传到单个帐户而不请求用户身份验证（即，在没有 Soundcloud 屏幕的情况下进行身份验证）

用户必须转到弹出屏幕。这对于登录第三方服务是很常见的（想想它在 Facebook Connect 中的工作原理，甚至对于登录 Stack Overflow）。对于用户来说，这也是一项安全功能：他们实际上是在向您提供他们帐户的密钥，因此应该非常清楚发生了什么。

[http://developers.soundcloud.com/docs/api/guide#authentication](http://developers.soundcloud.com/docs/api/guide#authentication)

> 在网站上的网格或列表中以及在地图上显示这些轨迹（我将使用地理标记功能）

这取决于你所说的“那些曲目”是什么意思：如果你想要他们的所有曲目，那么你可以使用 API 来获取[给定用户的所有曲目](http://developers.soundcloud.com/docs/api/reference#users)（`/users/:user_id/tracks`）。如果只是他们使用您的应用上传的曲目，您有几个不同的选项，具体取决于您想要做什么。

您可以[使用应用程序](http://developers.soundcloud.com/docs/api/reference#apps)( `/apps/:app_id/tracks`) 上传所有公共曲目，但这将包括所有人的曲目，并且仅包括公共曲目。您可以获取当前用户的所有曲目（包括私人曲目），然后通过查找使用您的应用程序创建的曲目在您的应用程序中过滤它们。此信息存储在`"created_with"`属性中。例如：

```
 "created_with": {
        "id": 124,
        "name": "SoundCloud iPhone",
        "uri": "http://api.soundcloud.com/apps/124",
        "permalink_url": "http://soundcloud.com/apps/iphone"
      } 
```

在网格或地图中显示它们，我认为可能是一个不同的问题......

# c++ - 如何使用 LLVM 4.1 忽略 Xcode 中的离线定义错误

> ID：12980931
> 
> 赞同：1
> 
> 时间：2012-10-19T19:13:46.063
> 
> 标签：c++, macos, llvm

我收到 LLVM 4.1 的编译器错误：

```
/Users/vibhor/src/mam/client_daemon/source/core/_osx/UtilSystem_OSX.cpp:261:32: Out-of-line definition of 'what' does not match any declaration in 'std::bad_typeid' 
```

对于以下代码：

```
const char* ::std::bad_typeid::what() const throw() { return NULL; } 
```

有没有办法抑制这种情况？它用 GCC 编译得很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:26:44.120

我最初的答案是尝试使用不同的 stdlib 进行编译，这完全不符合标准。

它看起来像是针对 10.5 SDK 编译的尝试，它的 bad_typeid 与预期不同。解决方法是保护定义：

```
#if defined(MAC_OS_X_VERSION_10_6) && MAC_OS_X_VERSION_MAX_ALLOWED >= MAC_OS_X_VERSION_10_6
const char* ::std::bad_typeid::what() const throw() { return NULL; }
#endif 
```

# c# - 异步方法中的 StringBuilder

> ID：12980932
> 
> 赞同：3
> 
> 时间：2012-10-19T19:13:51.393
> 
> 标签：c#, visual-studio-2010, .net-4.5, async-await

如果我触发多个异步 Web 请求，将结果附加到全局变量是否安全，例如`StringBuilder`? 我知道订单无法保证。

1.  这会导致很多任务阻塞吗？

2.  这安全吗？

```
private static StringBuilder sb = new StringBuilder();

private static async Task AccessTheWebAsync()
{
    HttpClient client = new HttpClient();
    HttpResponseMessage response = await client.GetAsync(@"http://www.google.com/");
    sb.Append(response.StatusCode).Append(Environment.NewLine);        
}

static void Main(string[] args)
{
    List<Task> tasks = new List<Task>();
    for (int i = 0; i < 10; i++)
        tasks.Add(AccessTheWebAsync());
    Task.WaitAll(tasks.ToArray());
    Console.Write(sb.ToString());
    Console.ReadLine();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T19:15:58.893

> 这会导致很多任务阻塞吗？

不会。您将等待所有任务完成，但这是设计使然。否则，这是一种相当有效的编写方式。

> 这安全吗？

这是不安全的。如[StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)中所述：“不保证任何实例成员都是线程安全的。” （在这种情况下，`Append`是一个实例方法。）

由于您在控制台应用程序中运行它，因此 Append 调用将在单独的线程上发生。您需要某种形式的同步，例如在调用`lock`周围使用语句。`Append`

请注意，如果您要在 Windows 窗体或 WPF 应用程序中使用相同的代码，那么之后运行的代码`await`将使用 initial 调度`SynchronizationContext`，这将导致它始终在 UI 线程上运行，因此您不会有线程同步问题。但是，由于它在控制台应用程序中，因此延续将在单独的线程上运行。

# makefile - 来自在另一个文件中重置的变量的 Makefile 依赖项

> ID：12980935
> 
> 赞同：1
> 
> 时间：2012-10-19T19:14:06.117
> 
> 标签：makefile

鉴于此`Makefile`（精简为一个最小示例）：

```
include Makefile2
NAME=bar 
```

第二个`Makefile2`是一些一般规则：

```
NAME=foo
something: $(NAME).txt
    @echo  $(NAME).txt 
```

调用`make something`将取决于`foo.txt`但它会打印`bar.txt`。

是否可以定义一个`Makefile2`依赖于`$(NAME).txt`实际值的`NAME`规则，因此示例规则也将`bar.txt`用作依赖项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T23:04:59.390

这是一个 hack，但它有效：

```
NAME:=foo

something:
    @$(MAKE) -s other OTHERNAME=$(NAME)

other: $(OTHERNAME).txt
    @echo NAME is $(NAME).txt, and this rule depends on $< 
```

# mongodb - ImproperlyConfigured at /port 必须是 int django mongodb 的实例

> ID：12980938
> 
> 赞同：1
> 
> 时间：2012-10-19T19:14:36.273
> 
> 标签：mongodb, pymongo, django-nonrel

试图将 Django-MongoDB 开发环境转移到生产环境

不断从 Web 界面收到以下错误：

```
 ImproperlyConfigured at /
    port must be an instance of int 
```

在终端上，如果我运行

```
 python manage.py syncdb

    File "/home/user/lib/python-environments/djangomongo/local/lib/python2.7/site-packages/pymongo/connection.py", line 209, in __init__
        raise TypeError("port must be an instance of int")
    django.core.exceptions.ImproperlyConfigured: port must be an instance of int 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T02:24:23.267

仔细检查您如何设置您的 pymongo Connection 对象： [http](http://api.mongodb.org/python/current/api/pymongo/connection.html) ://api.mongodb.org/python/current/api/pymongo/connection.html 从错误消息来看，您似乎有一个不正确的端口参数。我还猜测，如果它在开发中而不是在生产中工作，那么您会在 prod.xml 中丢失一些配置值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T04:18:38.487

我还没有 100% 的工作系统，但这里的问题是你的 django-nonrel 版本和 pymongo 之间的不兼容。对于 django 1.3 的 django-nonrel 分支，我需要使用 pymongo 1.11（不确定任何 2.X 的 pymongo 是否可以工作）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-08T08:14:20.367

我在使用环境变量时遇到了这个问题。它们作为字符串注入。您需要将 port 转换为 int 才能开始。

# java - 如何将属性注入到我未实例化的对象中？

> ID：12980939
> 
> 赞同：0
> 
> 时间：2012-10-19T19:14:38.060
> 
> 标签：java, dependency-injection, spring-security

非常简单的场景：我正在使用 Spring 和 Spring Security，并且我试图将一个属性注入到我的 AuthenticationManager 使用的 AuthenticationProvider 中。我只是想到我可以将它连接到 applicationContext 中，但不确定这是否可行。

应用程序上下文.xml：

```
<http use-expressions="true">
    <intercept-url pattern="/" access="permitAll" />
    <intercept-url pattern="/**" access="hasRole('USER')"/>
    <form-login login-page="/index" />
</http>

<authentication-manager alias="authenticationManager">
    <authentication-provider ref="twitterAuthenticationProvider" />
</authentication-manager>

<beans:bean id="twitterAuthenticationProvider" class="com.bottlingday.model.auth.TwitterAuthenticationProvider" /> 
```

TwitterAuthenticationProvider：

```
public class TwitterAuthenticationProvider implements AuthenticationProvider
{
@Autowired
private AppEngineUserStore userStore;

static Log log = LogFactory.getLog(TwitterAuthenticationProvider.class.getName());

public void Test()
{
            //userStore is always null here
    log.info("test");
}
} 
```

在我的控制器中，这失败了，因为 userStore 在 TwitterAuthenticationProvider 中是一个空引用：

```
Authentication authentication = this.authenticationManager.authenticate(authToken); 
```

这是确切的错误：

```
java.lang.NullPointerException
at com.bottlingday.model.auth.TwitterAuthenticationProvider.authenticate(TwitterAuthenticationProvider.java:33)
at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:156)
at com.bottlingday.auth.TwitterAuthController.OauthCallback(TwitterAuthController.java:129) 
```

**编辑：**我正在使用自动装配，它适用于其他事情。如果我在 MVC 控制器中自动装配 AppEngineUserStore，它每次都会在那里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:24:27.527

> ```
> I just had the thought that I might be able to wire it up in the applicationContext, but not sure if that would work. 
> ```

这会奏效。您可以在应用程序上下文中指定属性的连接。但是，这与自动装配不同（这是您的`AuthenticationProvider`.

如果您希望自动装配 AppEngineUserStore，您需要在您的应用程序上下文中注册它并打开自动装配。这可以按如下方式完成：

```
<context:annotation-config /> 
```

如果您使用，Spring 还可以扫描 bean 以自动装配：

```
<context:component-scan base-package="com.my.package" /> 
```

这将自动打开自动装配

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T19:24:52.297

如果您使用的是 autowired，您会说您在 spring-context 中使用注解。

```
<context:annotation-config /> 
```

否则你需要做基于 xml 的 DI。

# c# - 带有私有字段的 GridView 控件。我想绑定 Gridview

> ID：12980944
> 
> 赞同：2
> 
> 时间：2012-10-19T19:15:06.430
> 
> 标签：c#, asp.net, gridview

```
public class VivaClass{
public VivaClass()
{
    StudentObJ = new StudentClass();
    StudentObJ.SetGetDGroupID = "";
    StudentObJ.SetGetDUserName = "";
    StudentObJ.SetGetDProjectName = "";
    StudentObJ.SetGetDCity = "";
    this.Date = "";
    this.Time = "";
    this.isMake = false;
}
public VivaClass(string date, string time, bool isMake, string Gid, string uName, string Prjct, string city)
{
    StudentObJ = new StudentClass(Gid, uName, Prjct, city);
    this.Date = date;
    this.Time = time;
    this.isMake = isMake;
}
public VivaClass(string date, string time, bool isMake, string uName,string city)
{
    StudentObJ = new StudentClass();
    StudentObJ.SetGetDUserName = uName;
    this.Date = date;
    this.Time = time;
    this.isMake = isMake;
    this.SetGetStudentObJ.SetGetDCity = city;
}
private StudentClass StudentObJ;

public StudentClass SetGetStudentObJ
{
    get { return StudentObJ; }
    set { StudentObJ = value; }
}
public int ID;

public int SetGet_ID
{
    get { return ID; }
    set { ID = value; }
}

private string Date;

public string SetGetDate
{
    get { return Date; }
    set { Date = value; }
}
private string Time;

public string SetGetDTime
{
    get { return Time; }
    set { Time = value; }
}
private bool isMake;

public bool SetGetDIsMake
{
    get { return isMake; }
    set { isMake = value; }
} 
```

}

```
public List<VivaClass> ReturnVivaObj()
{
    List<VivaClass> Objlst = new List<VivaClass>();
    VivaClass obj = null;
    try
    {
        SqlConnection hookup = new SqlConnection(new ConnectionString().GetConString(("SqlConString")));
        string query = "Select ID,GroupID,StudentName,ProjectName,City,Date,Time,isMake FROM SchedualTB";
        SqlCommand cmd = new SqlCommand(query, hookup);
        hookup.Open();
        SqlDataReader dr = cmd.ExecuteReader();
        while (dr.Read())
        {
            obj = new VivaClass();
            obj.SetGet_ID = Convert.ToInt32(dr["ID"]);
            obj.SetGetStudentObJ.SetGetDGroupID = Convert.ToString(dr["GroupID"]);
            obj.SetGetStudentObJ.SetGetDStudentName = Convert.ToString(dr["StudentName"]);
            obj.SetGetStudentObJ.SetGetDProjectName = Convert.ToString(dr["ProjectName"]);
            obj.SetGetStudentObJ.SetGetDCity = Convert.ToString(dr["City"]);
            obj.SetGetDate = dr["Date"].ToString();
            obj.SetGetDTime = dr["Time"].ToString();
            obj.SetGetDIsMake = Convert.ToBoolean(dr["isMake"].ToString());
            Objlst.Add(obj);
        }
    }
    catch (Exception e)
    {
        throw e;
    }
    return Objlst;
} 
```

标记

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" DataKeyNames="ID" onrowediting="GridView1_RowEditing">
    <Columns>
        <asp:TemplateField HeaderText="Group ID">
        <ItemTemplate>
        <asp:Label ID="lblGroupID" runat="server" Text='<%# Eval("GroupID") %>' ></asp:Label>
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Student ID">
        <ItemTemplate>
        <asp:Label ID="lblUserName" runat="server" Text='<%# Eval("UserName") %>' ></asp:Label>
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Student Name">
        <ItemTemplate>
        <asp:Label ID="lblStudentName" runat="server" Text='<%# Eval("StudentName") %>' ></asp:Label>
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Project Name">
        <ItemTemplate>
        <asp:Label ID="lblProjectName" runat="server" Text='<%# Eval("ProjectName") %>' ></asp:Label>
        </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField ItemStyle-HorizontalAlign="Right" HeaderText="Status" >
            <ItemTemplate>
                 <asp:ImageButton ID="imgStatus" runat="server" CommandName="Edit" ToolTip="Change User status"  ImageUrl="~/Image/logo/statusActive.png"></asp:ImageButton>
            </ItemTemplate>
            </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

GridView 绑定代码

```
private void FillGrid()
{
    GridView1.DataSource = new StudentIdentity().ReturnVivaObj();
    GridView1.DataBind();

} 
```

我正在尝试绑定数据，但异常抛出 VivaClass 不包含名为“ID”的属性。我不知道如何通过代码进行绑定。任何一次都可以给我任何链接或解决方案。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:20:22.167

我认为您的问题是`ID`实际上试图绑定到`gridView`. 更改`public int ID;`为`public int ID { get;set;}`或绑定`SetGet_ID`到您的`gridView`而不是`ID`.

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T19:20:39.367

In the grid view declaration try providing "SetGet_ID" instead of "ID" as shown below

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" DataKeyNames="SetGet_ID" ...> 
```

Hope this Helps!!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T05:21:09.807

考虑通过类比重写您的代码和标记：

```
public class VivaClass
{
    public VivaClass()
    {
        StudentObJ = new StudentClass();
        StudentObJ.GroupID = "";
        StudentObJ.UserName = "";
        StudentObJ.ProjectName = "";
        StudentObJ.City = "";
        this.Date = "";
        this.Time = "";
        this.isMake = false;
    }

    public VivaClass(string date, string time, bool isMake, string Gid, string uName, string Prjct, string city)
    {
        StudentObJ = new StudentClass(Gid, uName, Prjct, city);
        this.Date = date;
        this.Time = time;
        this.isMake = isMake;
    }
    public VivaClass(string date, string time, bool isMake, string name, string city)
    {
        Student = new StudentClass();
        Student.UserName = name;
        Student.City = city;
        Date = date;
        Time = time;
        IsMake = isMake;
    }

    public StudentClass Student { get; set; }

    public int ID { get; set; }

    public string Date { get; set; }

    public string Time { get; set; }

    public bool IsMake { get; set; }

    public IEnumerable<VivaClass> Vivas()
    {
        using (SqlConnection connection = new SqlConnection(new ConnectionString().GetConString(("SqlConString"))))
        {
            string query = "Select ID,GroupID,StudentName,ProjectName,City,Date,Time,isMake FROM SchedualTB";
            SqlCommand cmd = new SqlCommand(query, connection);
            connection.Open();
            using (SqlDataReader dr = cmd.ExecuteReader())
            {
                while (dr.Read())
                {
                    VivaClass obj = new VivaClass();
                    obj.ID = (int(dr["ID"];
                    obj.Student.GroupID = (string)dr["GroupID"];
                    obj.Student.StudentName = (string)dr["StudentName"];
                    obj.Student.ProjectName = (string)dr["ProjectName"];
                    obj.Student.City = (string)dr["City"];
                    obj.Date = (string)dr["Date"].ToString();
                    obj.Time = (string)dr["Time"];
                    obj.IsMake = (bool)dr["isMake"];
                    yield return obj;
                }
            }
        }
    }    
} 
```

标记：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" DataKeyNames="ID" onrowediting="GridView1_RowEditing">
    <Columns>
        <asp:TemplateField HeaderText="Group ID">
            <ItemTemplate>
                <asp:Label ID="lblGroupID" runat="server" Text='<%# Eval("GroupID") %>' />
             </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Student ID">
            <ItemTemplate>
                <asp:Label ID="lblUserName" runat="server" Text='<%# Eval("UserName") %>' />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Student Name">
            <ItemTemplate>
                <asp:Label ID="lblStudentName" runat="server" Text='<%# Eval("StudentName") %>' />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Project Name">
            <ItemTemplate>
                <asp:Label ID="lblProjectName" runat="server" Text='<%# Eval("ProjectName") %>' />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField ItemStyle-HorizontalAlign="Right" HeaderText="Status" >
            <ItemTemplate>
                 <asp:ImageButton ID="imgStatus" runat="server" CommandName="Edit" ToolTip="Change User status" ImageUrl="~/Image/logo/statusActive.png" />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

# css - 标题顶部的移动导航，但仍定位为静态

> ID：12980945
> 
> 赞同：0
> 
> 时间：2012-10-19T19:15:10.427
> 
> 标签：css, mobile, positioning, responsive-design

前往大多数设备后，我都有导航。它看起来像这样：

```
<header role="banner">
    <hgroup>
        <h1>
            <a href="/" rel="home">Site name</a>
        </h1>
        <h2>subname</h2>
    </hgroup>
    <nav>
        <ul>
            <li><a href="#">Option 1</a></li>
            <li><a href="#">Option 2</a></li>
            <li><a href="#">Option 3</a></li>
            <li><a href="#">Option 4</a></li>
        </ul>
         <a href="#" id="pull">Menu</a>
    </nav>
</header> 
```

在纵向潜水中，我想将 NAV 放在顶部并在单击 MENU 后将其向下滑动。问题是：如何以这样的方式将其置于顶部，在向下滑动后将内容（标题）向下移动。好像“导航”在进入 DOM 之前，但仅适用于面向纵向的智能手机。绝对位置放置在导航上方。我需要在同一个流程中。

# python - 即使 Popen 仍在运行，python 子进程 poll() 也不会返回 None

> ID：12980946
> 
> 赞同：0
> 
> 时间：2012-10-19T19:15:12.567
> 
> 标签：python, timeout, subprocess, pipe, python-2.4

我有一个 python 脚本，它使用 while 循环和 sleep 执行超时的 linux 命令，如下所示

```
fout = tempfile.TemporaryFile()
try:
    p = subprocess.Popen(["/bin/bash","-c", options.command], bufsize=-1, shell=False, preexec_fn=os.setsid, stdin=subprocess.PIPE, stdout=fout, stderr=subprocess.PIPE)
except:
    sys.exit(UNEXPECTED_ERROR)
if options.timeout:
    print "options.timeout = %s" % options.timeout
    elapsed = 0
    time.sleep(0.1) # This sleep is for the delay between Popen and poll() functions
    while p.poll() is None:
        time.sleep(1)
        elapsed = elapsed + 1
        print "elapsed = %s" % elapsed
        if elapsed >= options.timeout:
            # TIMEDOUT
            # kill all processes that are in the same child process group
            # which kills the process tree
            pgid = os.getpgid(p.pid)    
            os.killpg(pgid, signal.SIGKILL)
            p.wait()
            fout.close()
            sys.exit(TIMEOUT_ERROR)
            break
else:
    p.wait()

fout.seek(0) #rewind to the beginning of the file
print fout.read(),
fout.close()
sys.exit(p.returncode)

$ time myScript -c "cat file2" 2>&1 -t 5
options.timeout = 5
elapsed = 1

real    0m11.811s
user    0m0.046s
sys     0m1.153s 
```

我的问题是在上述情况下，即使超时为 5 秒，猫也会继续直到完成。我在这里错过了什么吗？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T22:37:59.650

它在 Ubuntu 上按预期工作：

```
$ /usr/bin/ssh root@localhost -t 'sync && echo 3 > /proc/sys/vm/drop_caches'
$ /usr/bin/time python2.4 myscript.py 'cat big_file'
timeout
done
0.01user 0.63system 0:05.16elapsed 12%CPU 

$ /usr/bin/ssh root@localhost -t 'sync && echo 3 > /proc/sys/vm/drop_caches'
$ /usr/bin/time cat big_file >/dev/null
0.02user 0.82system 0:09.93elapsed 8%CPU 
```

它也适用于 shell 命令：

```
$ /usr/bin/time python2.4 myscript.py 'while : ; do sleep 1; done'
timeout
done
0.02user 0.00system 0:05.03elapsed 0%CPU 
```

假设：

*   `time.time()`由于系统时钟可能发生变化，您无法使用

*   `time.clock()`在 Linux 上不测量儿童时间

*   `time.monotonic()`由于`ctypes`在 Python 2.4 上不可用，我们无法在纯 Python 中模拟Python 3.3

*   在休眠状态下存活是可以接受的，例如，休眠前 2 秒 + 计算机唤醒后 3 秒（如果超时为 5 秒）。

```
#!/usr/bin/env python2.4
import os
import signal
import sys
import tempfile
import time
from subprocess import Popen

class TimeoutExpired(Exception):
    pass

def wait(process, timeout, _sleep_time=.1):
    for _ in xrange(int(timeout * 1\. / _sleep_time + .5)):
        time.sleep(_sleep_time)  # NOTE: assume it doesn't wake up earlier
        if process.poll() is not None:
            return process.wait()
    raise TimeoutExpired  # NOTE: timeout precision is not very good

f = tempfile.TemporaryFile() 
p = Popen(["/bin/bash", "-c", sys.argv[1]], stdout=f, preexec_fn=os.setsid,
          close_fds=True)
try:
    wait(p, timeout=5)
except TimeoutExpired:
    print >>sys.stderr, "timeout"
    os.killpg(os.getpgid(p.pid), signal.SIGKILL)
    p.wait()
else:
    f.seek(0)
    for line in f:
        print line,
f.close()  # delete it
print >>sys.stderr, "done" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T20:23:54.833

除了我在您的代码中看到的问题

*   你`Popen()`用`stdin=subprocess.PIPE`and打电话`stderr=subprocess.PIPE`。但是你永远不会处理这些管道。使用类似的命令`cat file2`，这应该没问题，但它可能会导致问题。

我可以发现一个潜在的不当行为：您可能混淆了缩进（如您的问题的第一个版本）。假设您有以下内容：

```
while p.poll() is None:
    time.sleep(1)
    elapsed = elapsed + 1
    print "elapsed = %s" % elapsed
    if elapsed >= options.timeout:
        # TIMEDOUT
        # kill all processes that are in the same child process group
        # which kills the process tree
        pgid = os.getpgid(p.pid)    
        os.killpg(pgid, signal.SIGKILL)
    p.wait()
    fout.close()
    sys.exit(TIMEOUT_ERROR)
    break 
```

您没有达到超时阈值，但`p.wait()`由于缩进错误而被调用。不要混淆制表符和空格；PEP 8 建议仅使用空格和 4 列的缩进深度。

# forms - Bootstrap-datepicker 未正确发布隐藏值

> ID：12980949
> 
> 赞同：0
> 
> 时间：2012-10-19T19:15:22.357
> 
> 标签：forms, twitter-bootstrap, datepicker

我正在使用 bootstrap-datepicker 并且需要在用户点击提交按钮时发送所选日期和隐藏值。代码是这样的：

```
 <div class='input-append date datepicker' data-date=$today data-date-format='mm-dd-yyyy'>
            <form class='well' action='Update_Birthday.php' method='POST'>  
            <input type='hidden' name='ContactID' value=$ContactID>
            <input class='span5' size='16' type='text' name='date' readonly>
            <span class='add-on'><i class='icon-calendar'></i></span>
            <button type='submit' class='btn'>Submit</button>  
            </form> 
        </div> 
```

如果我在选择日期之前单击提交，则正确发送 ContactID（但日期当然为空）。当我选择一个日期时，“ContactID”和“日期”都是相同的，即用户选择的日期。

如何正确发送日期和隐藏值？

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:06:27.457

使用此代码（基本上是您已经拥有的，在值中添加了引号）：

```
 <div class='input-append date datepicker' data-date='$today' data-date-format='mm-dd-yyyy'>
        <form class='well' id='birthdayForm' action='Update_Birthday.php' method='POST'>  
        <input type='hidden' name='ContactID' value='$ContactID'>
        <input class='span5 dateInput' size='16' type='text' name='date' readonly>
        <span class='add-on'><i class='icon-calendar'></i></span>
        <button type='submit' class='btn'>Submit</button>  
        </form> 
    </div> 
```

`ContactID`当用户选择日期时， 没有理由被覆盖。

至于在选择日期之前阻止表单提交，这将需要一些 JavaScript。我建议只`date`用一个值预填充输入（可能是以前指定的生日，根据您的代码判断？） - 由于该字段是只读的，用户通常无法清空该值，只能更改日期。

如果您希望将其留空，这样的事情应该会有所帮助：

```
$('#birthdayForm').on('submit', function(e) {
    $('.dateInput').each(function() {
        if ($(this).val().length < 1) {
            e.preventDefault();
        }
    });
}); 
```

# spss - 在SPSS中分隔一串逗号分隔值

> ID：12980953
> 
> 赞同：3
> 
> 时间：2012-10-19T18:59:04.427
> 
> 标签：spss

> **可能重复：**
> [分析来自谷歌文档表单的多个响应字段](https://stackoverflow.com/questions/12881079/analyze-multiple-response-field-from-google-doc-form)

数据由 Google Forms 生成。用户可以在多个复选框中检查选项：

*   “钓鱼”
*   “划船”
*   “远足”
*   “攀登”

如果用户检查“钓鱼”和“划船”，我得到的结果格式为：“钓鱼，划船”

如何重新格式化该数据，以便我可以轻松访问特定用户是否选中了每个单独的框？

在 SPSS 中执行此操作的最简单方法是什么？

这个问题出现在： http: [//lesswrong.com/r/discussion/lw/f0r/2012_less_wrong_census_survey_call_for/7nob](http://lesswrong.com/r/discussion/lw/f0r/2012_less_wrong_census_survey_call_for/7nob)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:11:55.340

您可以在 SPSS 中使用字符串数学解析数据。

[http://www.ats.ucla.edu/stat/spss/modules/functions.htm](http://www.ats.ucla.edu/stat/spss/modules/functions.htm)

第 4 节给出了一些例子。这将允许您将它们分解为自己的变量，并将其保留为字符串或将其更改为二进制。

# javascript - Javascript 幻灯片效果 onclick

> ID：12980955
> 
> 赞同：1
> 
> 时间：2012-10-19T19:15:30.373
> 
> 标签：javascript, onclick, mootools, slide, effect

我想使用“onclick”向DIV添加幻灯片和淡入淡出效果，纯Javascript。

代码在这里：http: [//jsfiddle.net/TCUd5/](http://jsfiddle.net/TCUd5/)

必须滑动的 DIV 具有 id="pulldown_contents_wrapper"。此 DIV 包含在 SPAN 中，它也会触发它：

```
<span onclick="toggleUpdatesPulldown(event, this, '4');" style="display: inline-block;" class="updates_pulldown" >
    <div class="pulldown_contents_wrapper" id="pulldown_contents_wrapper"> 
```

而且我认为控制 SPAN onclick 的 JS 代码是：

```
var toggleUpdatesPulldown = function(event, element, user_id) {
  if( element.className=='updates_pulldown' ) {
    element.className= 'updates_pulldown_active';
    showNotifications();
  } else {
    element.className='updates_pulldown';
  }  
} 
```

如果不可能用纯 JS 来实现，你知道我怎么能用 Mootools 来实现吗？（*我只想使用纯 JS 或 Mootols 框架）。

我试图实现以下代码：[Why javascript onclick div slide not working？](https://stackoverflow.com/questions/1702266/why-javascript-onclick-div-slide-not-working) 但没有结果。

非常感谢。

我已经设法用 Mootools 做到了，但我不知道如何添加幻灯片和淡入淡出效果，以及鼠标移出的延迟

```
 window.addEvent('domready', function() {
        $('updates_pulldown').addEvents({
          mouseenter: function(){
            $('updates_pulldown').removeClass('updates_pulldown').addClass('updates_pulldown_active')
            $('pulldown_contents_wrapper').set('tween', {
              duration: 1000,
              physics: 'pow:in:out',
              transition: Fx.Transitions.Bounce.easeOut // This could have been also 'bounce:out'
            }).show();
          },
          mouseleave: function(){
            $('pulldown_contents_wrapper').set('tween', {
                duration: 1000,
                delay: 1000,
                }).hide();
            $('updates_pulldown').removeClass('updates_pulldown_active').addClass('updates_pulldown')
          },
        });
    });

  var toggleUpdatesPulldown = function(event, element, user_id) {
      showNotifications();
  } 
```

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:28:15.260

[jQuery](http://jquery.com/)要容易得多，但使用纯 javascript 你可以做到。

在 CSS 中，您需要使用过渡

```
#thing { position:relative;
  top: 0px;
  opacity: 0.8;
  -moz-transition: top 1s linear, opacity 1s linear;
  -webkit-transition: top 1s linear, opacity 1s linear;
 } 
```

然后在 javascript 中，当您更改元素的位置时，它应该通过 css 转换进行更改。

```
var toggleUpdatesPulldown = function(event, element, user_id) {
  if( element.className=='updates_pulldown' ) {
     element.style.top = someValue; //something like '100px' will slide it down 100px
     element.style.opacity = '1.0'; //will fade the content in from 0.8 opacity to 1.0
     element.className= 'updates_pulldown_active';
    showNotifications(); 
```

**编辑 - 提供的 jQuery 代码**

调用 jQuery 库，最容易从谷歌托管完成

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script> 
```

制作悬停功能

```
$(document).ready(function() {
        $('.updates_pulldown').hover( //first function is mouseon, second is mouseout
            function() {
                $(this).animate({top: '50px'}).animate({opacity: '1.0'});
            },
            function() { //delay 1000 milliseconds, animate both position and opacity
                $(this).delay(1000).animate({top: '0px'}).animate({opacity: '0.5'});
            }
        )
    }) 
```

功能计时将与您在带有过渡标签的 css 中设置的任何时间相同。再次使用“this”而不是类名可确保效果仅发生在悬停的类的特定实例上。我不确定这个动画是否正是你所要求的，但如果我正确理解了这个问题，那么主要功能将为你工作。只需更改数字等以满足您的需求。

# regex - 多个特定电子邮件地址的正则表达式

> ID：12980956
> 
> 赞同：0
> 
> 时间：2012-10-19T19:15:35.573
> 
> 标签：regex

我仍在想办法解决正则表达式，并遇到了我正在尝试解决的问题。如何验证多个特定的电子邮件地址？

例如，我只想允许 testdomain.com、realdomain.com、gooddomain.com 进行验证。不允许使用所有其他电子邮件地址。

```
annie@testdomain.com   OK
aaron1@realdomain.com  OK
amber@gooddomain.com   OK

annie@otherdomain.com NOT OK 
```

但我仍然不清楚如何为正则表达式添加多个特定的电子邮件地址。

任何和所有的帮助将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:17:43.217

您的意思是在一个正则表达式中包含各种合法域吗？

```
\b[A-Z0-9._%-]+@(testdomain|gooddomain|realdomain)\.com\b 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:19:20.347

您没有指定您使用的是哪种语言，但大多数正则表达式实现都有逻辑运算符的概念，因此您的模式的域部分将具有以下内容：

```
(domain1|domain2|domain3) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:18:35.390

```
\b[A-Z0-9._%-]+@(testdomain|realdomain|gooddomain)\.com\b 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:47:02.673

为了使其可扩展到许多域，我可能会捕获域名，然后将捕获的域名与代码中的白名单进行比较。

.+@(.+)

首先，“.+”将匹配任意数量（大于 0）的任意字符，直到字符串中的最后一个“@”符号为止。其次，“@”将匹配“@”符号。第三，“(.+)”将匹配并捕获（由于括号而捕获）“@”符号之后的任何字符串。

然后，根据您使用的语言，您可以获得捕获的字符串。然后您可以查看该捕获的字符串是否在您的域白名单中。请注意，您需要在最后一步中进行不区分大小写的比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T20:04:00.217

官方标准称为[RFC 2822](https://www.rfc-editor.org/rfc/rfc2822#section-3.4.1)。

对您要允许的所有域名使用*OR*运算符。`|`不要忘记`.`在域中逃脱。

```
[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:testdomain\.com|realdomain\.com|gooddomain\.com) 
```

还使用不区分大小写的修饰符/标志来允许地址中的大写字母。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T19:18:16.937

假设以上适用于 testdomain：

```
\b[A-Z0-9._%-]+@(?:testdomain|realdomain|gooddomain)\.com\b 
```

另外，请注意，您必须添加一个不区分大小写的`i`修饰符才能与您的测试用例一起使用，或者使用`[A-Za-z0-9._%-]`而不是`[A-Z0-9._%-]`

看[这里](http://rubular.com/r/awKGjZYbOt)

# sql - 访问作为 SQL Server 问题的前端

> ID：12980961
> 
> 赞同：0
> 
> 时间：2012-10-19T19:15:54.950
> 
> 标签：sql, sql-server, ms-access

我最近将我的 Access (2010) 数据库转换为 SQL server (2008) 并尝试使用 Access 作为前端。我遇到的问题是 Access 中的排序和过滤列。排序基本上不适用于大多数列 - 不会以字母/数字排序的行结束。过滤列也不会始终如一地工作。它有时会正确执行第一个过滤器，但是当我更改条件时它不起作用并且通常显示 0 行。

我环顾四周，但似乎找不到其他人遇到这个问题。此配置是否存在这些已知错误？

此外，还有其他类似于 Access 的替代方案作为 SQL Server 的前端吗？我的用户需要 Access 提供的类似功能 - 筛选、排序、编辑数据，并且他们不想编写任何 SQL 来执行此操作。我不想创建自定义前端，但我开始认为这可能是我唯一的选择。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:18:54.463

警告：我没有将 Access 用作 SQL Server 的前端。

看到[这篇](http://www.techrepublic.com/article/using-access-to-build-a-front-end-for-sql-server/5065669)关于使用 Access 的新功能“Access Data Project”的文章，这可能值得一看。它似乎提供了比 Access 中链接表的传统方法更多的功能。与必须依赖 Access 的本机语言相比，允许更多地使用 SQL Server T-SQL 功能。

# java - 随机方向

> ID：12980972
> 
> 赞同：1
> 
> 时间：2012-10-19T19:16:28.257
> 
> 标签：java, random

您好，我正忙于学习 Java，我正忙于创建一个吃豆人游戏，但现在我需要让鬼魂朝“随机”方向移动，所以这个方向时不时地必须垂直/水平改变，反之亦然

此刻，鬼魂从左到右，从右到左。负责这个动作的代码如下：（忽略pacman绘图部分见下文//ghost运动）

```
 DrawPacMan pacman = new DrawPacMan();
DrawGhost ghost = new DrawGhost();

int g1x = 0;
boolean g1r = true;

public void paintComponent(Graphics g) {

    super.paintComponent(g);
    // pacman movement
    diameter = 25;   
    pacman.drawPacMan(g, getHorPlaats(), getVerPlaats(), diameter, getView(), Color.yellow);

    // ghosts movement
    g1x += ghostSpeed * (g1r? 1 : -1);

    // check direction
    if (g1x >= 500) { g1x = 500; g1r = false; }
    else if (g1x <= 0) { g1x = 0; g1r = true; }

    ghost.drawGhost(g, g1x, 40, diameter, Color.red);

} 
```

现在我不知道如何创建随机方向或使用什么功能。有人可以给我一些提示/帮助，如果可能的话，可以举一个我可以进一步研究的小例子吗？如果您想查看更多代码或其他内容，请询问，我会发布:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:18:55.977

尝试这个：

```
g1x += ghostSpeed * (Math.random() > 0.5? 1 : -1); 
```

甚至更简单：

```
g1x += ghostSpeed * Math.signum(Math.random() - 0.5); 
```

[`Math.random()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#random%28%29)这利用了返回均匀分布值的事实`[0, 1)`。

但你很快就会意识到，这样的算法会导致幽灵从左到右不规律地移动。你需要一些更优雅的东西。例如，如果幽灵向左移动，让他以 75% 的概率继续前进或以 25% 的概率改变方向。我会让你解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T19:29:39.047

对于像这样简单的事情，我会生成一个随机数，0、1、2 或 3。这将为您提供所需的所有方向：上、下、左和右。

```
 import java.util.Random;
 // create a random number generator
 Random randomGen = new Random();
 // generate a random number, between 0 and n-1 (0,1,2,3 in this case)
 int theRandomNumber = randomGen.nextInt(4);

 public void setRandomGhostDirection() {

     switch(theRandomNumber) {
     case 0:
         moveUp();
         break;
     case 1:
         moveLeft();
         break;
     case 2:
         moveRight();
         break;
     case 3:
         moveDown();
         break;
     }

 } 
```

您可以通过将方向编号定义为诸如此类的东西来清理它 `final int DIRECTION_UP = 0`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T19:21:45.030

Math.random() 是您正在寻找的函数。该函数本身会生成一个从 0 到 1 的随机双精度数。

伪代码：

```
double randomDirection = Math.random();

if (direction > 0.25) {
 // move left if possible
} else if (direction > 0.5) {
 // move right if possible
} else if (direction > 0.75) {
 // move down if possible
} else {
 // move up if possible
} 
```

# javascript - 防止 SWF 图表 refreshUrl 中的缓存

> ID：12980974
> 
> 赞同：0
> 
> 时间：2012-10-19T19:16:39.797
> 
> 标签：javascript, html, charts, flash

我正在使用 Flash 图表来显示数据。它有一个属性“refreshUrl”，用于每 60 秒刷新一次数据。问题是 url 总是相同的，它永远不会接收到最新的数据。

在 javascript 中，我知道我们可以将“new Date().getTime()”附加到 url 以防止缓存，但我们将 refreshUrl 设置为不可能将时间附加到 url。

这就是我声明饼图的方式（仅执行一次）：

```
cfm_PieChart = new SWFObject("<%=contextPath%>/cuecharts/piechart.swf?t=" + new Date().getTime(), "alarmCountBySeverityPiechart", "100%", "100%", "9", "#869ca7");

cfm_PieChart.addVariable("chartdefxml", "<chart row='row' labelFormat='pctOutsideParenthesis' enableDataGridView='true' togglePosition='bottom'  useStateColorPalette='true' dataChangeEffect='interpolate' dataChangeEffectDuration='1500' refreshUrl='<%=contextPath%>/pie.jsp' refreshFrequency='60000' ><series><pieseries field='Count' nameField='Severity' stateValueField='StateKey' labelPosition='callout' /></series><legend placement='left' legendItemsDirection='vertical'/></chart>"); 
```

请注意 cfm_PieChart.addVariable() 调用中的“refreshUrl”属性。我尝试了以下方法：

```
refreshUrl:='>%=contextPath%>/pie.jsp?t=javascript:new Date().getTime()' 
```

和

```
refreshUrl:='>%=contextPath%>/pie.jsp?t=new Date().getTime()' 
```

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T16:39:51.263

通过在我的jsp中添加以下内容来修复它：

```
response.setHeader("Cache-Control","no-cache");
response.setHeader("Pragma","no-cache");
response.setDateHeader ("Expires", 0); 
```

# iphone - iPhone 5 CAEAGLLayer 返回错误的边界

> ID：12980977
> 
> 赞同：0
> 
> 时间：2012-10-19T19:16:52.200
> 
> 标签：iphone, opengl-es, retina-display, caeagllayer

出于某种原因，我的 OpenGL 应用程序在 ios6 4 英寸 Retina 模拟器中运行时获得了错误的 CAEAGLLayer 边界信息。

CAEAGLLayer 边界打印为

```
layer bounds are: (0.000000,0.000000), (320.000000,480.000000) 
```

从此代码：

```
- (id)initWithCoder:(NSCoder*)coder {

    if ((self = [super initWithCoder:coder])) {
        // Get the layer
        CAEAGLLayer *eaglLayer = (CAEAGLLayer *)self.layer;

        eaglLayer.opaque = YES;
        eaglLayer.drawableProperties = [NSDictionary dictionaryWithObjectsAndKeys:
                                        [NSNumber numberWithBool:NO], kEAGLDrawablePropertyRetainedBacking, kEAGLColorFormatRGBA8, kEAGLDrawablePropertyColorFormat, nil];

        printf("layer bounds are: (%f,%f), (%f,%f)\n", eaglLayer.bounds.origin.x, eaglLayer.bounds.origin.y, eaglLayer.bounds.size.width, eaglLayer.bounds.size.height );

        context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES1];

        if (!context || ![EAGLContext setCurrentContext:context]) {
            [self release];
            return nil;
        }

        animationInterval = 1.0 / 60.0;
    }
    return self;
} 
```

然后窗口内容向上移动，0,0 不再位于正确的位置。

任何人都知道为什么将 CAEAGLLayer 设置为不正确的宽度/高度？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T19:32:44.207

啊，其他人也有这个问题。之前找的时候没找到。

这是解决方案：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

    self.window.frame = CGRectMake(0, 0, [[UIScreen mainScreen]bounds].size.width, [[UIScreen mainScreen]bounds].size.height);

} 
```

从这里开始：[如何在界面生成器中制作与 4 英寸 iPhone 兼容的 uitableview](https://stackoverflow.com/questions/12406505/how-to-make-a-uitableview-in-interface-builder-compatible-with-a-4-inch-iphone)

# java - 如何检查 JSP 页面上的变量？

> ID：12980979
> 
> 赞同：18
> 
> 时间：2012-10-19T19:16:56.083
> 
> 标签：java, eclipse, jsp

我有一组工作页面，想在 JSP 页面的断点处检查变量。不幸的是，变量的上下文菜单没有像在 Java 文件中那样显示正常的 Inspect/Watch 选项。有任何想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-01-13T11:45:02.800

这是一个对我有用的解决方案：

在 Eclipse 中打开 Display 选项卡视图（Window -> Show View -> Display） 在 Display 选项卡中写入要检查的变量或表达式。选择它并右键单击，您将看到一个带有选项检查的菜单（或者您可以执行 Ctrl + Shift + I），它将显示变量的值。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-22T14:51:28.690

为同样的问题苦苦挣扎，然后查看了 Eclipse 中的变量 View(Window)。所有变量都带有它们的名称和值。

但是右键菜单中确实缺少监视/检查条目。

顺便说一句，我正在使用 Eclipse 开普勒。

# sql-server - SQL 透视列

> ID：12980980
> 
> 赞同：0
> 
> 时间：2012-10-19T19:17:07.613
> 
> 标签：sql-server, tsql, pivot, unpivot

假设我创建了一个临时表并且结构/数据看起来像这样

```
 Type        Lang    N_cnt        Pcnt      T1      T2       T3      T4
============================================================================
ClassroomA      1      165897      1232     6439    1135     4516     1756
ClassroomA      2      175127      1254     6439    1135     1285     1953
ClassroomB      1      179515      1284     6439    1762     3945     1957
ClassroomB      2      159683      2041     6439    1575     4745     1955 
```

我想旋转`T1`, `T2`, `T3`,`T4`列以便得到这个结果

```
 Type       SubType   Lang      N_cnt            P_cnt   
==============================================================
ClassroomA      NULL     1       165897          1232  
NULL            "T1"     1   6439/165897     6439/1232       
NULL            "T2"     1       *calculation*   *calculation*
NULL            "T3"     1       *calculation*   *calculation*
NULL            "T4"     1       *calculation*   *calculation*
ClassroomA      NULL     2       175127          1254  
NULL            "T1"     2       6439/175127     6439/1254       
NULL            "T2"     2       *calculation*   *calculation*
NULL            "T3"     2       *calculation*   *calculation*
NULL            "T4"     2       *calculation*   *calculation* 
```

请注意，它所说的那`calculation`是我将取值`T{x}`并对其进行一些计算的地方（我为第一个做一个例子`T1`）。我还想补充一点，实际上我有大约十个这些`T`变量。

任何想法如何旋转列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:44:39.467

您可以使用类似的东西：

```
select type, 
  case when subtype = 'start' then null else subtype end subtype,
  lang, 
  case when subtype = 'start' then n_cnt else value/(n_cnt * 1.0) end n_cnt,
  case when subtype = 'start' then pcnt else value/(pcnt * 1.0) end pcnt
from
(
  select type, lang, n_cnt, pcnt, 
    T1, T2, T3, T4, 0 as start
  from table1
) x
unpivot 
(
  value 
  for subtype in (T1, T2, T3, T4, start)
) un
order by type, lang, subtype; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/d16a1/43)

# asp.net-mvc-3 - 骨干.js + MVC3。嵌套集合不会被填充

> ID：12980985
> 
> 赞同：0
> 
> 时间：2012-10-19T19:17:16.763
> 
> 标签：asp.net-mvc-3, backbone.js

我在客户端上有一个骨干集合。集合的模型与另一个集合一起具有一些属性

当我`fetch()`在服务器上执行我的操作方法时返回一些数据，集合被填充，所有属性也被填充，除了嵌套集合。

可能是什么原因？

```
var Job = Backbone.Model.extend();
var Jobs = Backbone.Collection.extend({model: Job})

var Foo = Backbone.Model.extend({ 
    initialize:function(){
      this.jobs = new Jobs();
}})
var FooCollection = Backbone.Collection.extend({model: Foo})

var fooCol = new FooCollection()
fooCol.fetch();

fooCol.first().get('name') // => returns name
fooCol.first().jobs.toJSON() // returns nothing
// although this will
fooCol.first().get('jobs') //it will return an array 
```

所以不知何故嵌套的 Backbone 集合变成了一个普通的属性（数组）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:41:38.713

好的 - 有了你的额外信息，我可以给你一个答案。

首先-“get”不会从模型中获取属性。它从模型的属性中获取`attributes`属性。因此，属性可能如下所示：

```
{
    name: 'blah',
    jobs: [{name: 'job1'}, {name: 'job2'}]
} 
```

Backbone 不会自动将数组转换为集合和模型，简单地设置`this.jobs`是行不通的。你需要做的有点复杂。

```
var Foo = Backbone.Model.extend({ 
    initialize:function(){
      this.jobs = new Jobs(this.attributes.jobs));
    }
}); 
```

这会将您的“作业”属性设置为一个新的作业对象，其中包含为作业发送的数据。但是，唉，它不会自动触发 Jobs 集合上的事件，也不会允许您使用类似的助手`this.get('jobs').each(fn);`- 您只能将其用作`Foo.jobs.each(fn)`.

为了让您将属性用作实际集合，您必须做很多更复杂的事情。

```
var Foo = Backbone.Model.extend({ 
    initialize:function(){
      this.createJobs(this.attributes.jobs);
    },
    toJSON: function () {
        var json = Backbone.Model.prototype.toJSON.apply(this);
        json.jobs = this.get('jobs').toJSON();
        return json;
    },
    set: function (key, val) {
        var attributes;
        if(!_.isObject(key)) {
            attributes = {}; attributes[key] = val;
        } else {
            attributes = key;
        }
        safeAttributes = _.omit(attributes, 'jobs');
        Backbone.Model.prototype.set.call(this, safeAttributes);
        if(attributes.jobs) { this.get('jobs').reset(attributes.jobs); }
    },
    clear: function () {
        if(this.get('jobs') && this.get('jobs').destroy) {
            this.get('jobs').off(); 
            this.get('jobs').destroy(); 
        }
        Backbone.Model.prototype.clear.apply(this);
        this.createJobs();
    },
    createJobs: function (jobsArray) {
        var jobsCollection = new Jobs(jobsArray);
        jobsCollection.on('change', function () {this.trigger('change'); }, this);
        this.set('jobs', jobsCollection);
    }
}); 
```

请注意，这完全未经测试，但希望它显示了您执行此操作的一些方式。

# android - Android：CheckBoxPreference 图标未在 <3.0 上显示？

> ID：12980986
> 
> 赞同：1
> 
> 时间：2012-10-19T19:17:19.230
> 
> 标签：android

我正在使用带有图标的 CheckBoxPrefence。该图标在 ICS 上正确显示，但在 2.2 上不正确。我没有正确使用它吗？

集成电路： ![在此处输入图像描述](../Images/5a751e908dd390bda6ac17811cce2711.png)

2.2：

![在此处输入图像描述](../Images/fc720e946baf241b41af42b124f4042f.png)

首选项.xml

```
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
    <CheckBoxPreference
        android:persistent="false"
        android:icon="@drawable/android"
        android:title="check box" 
        android:key="akey">
    </CheckBoxPreference>
</PreferenceScreen> 
```

Temp.java

```
public class Temp extends PreferenceActivity
{
    protected void onCreate(Bundle state)
    {
        super.onCreate(state);

        addPreferencesFromResource(R.xml.pref);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:22:09.273

图标属性在 Android 3.0 之前不存在。

如果您查看[Preference](http://developer.android.com/reference/android/preference/Preference.html#setIcon%28android.graphics.drawable.Drawable%29)（由 CheckBoxPreference 扩展）的文档，它会在 setIcon 方法的右侧显示它是在 API 11（Android 3.0）中引入的。

# ios - 检测来自通知管理器与实时的 didReceiveLocalNotification

> ID：12980990
> 
> 赞同：2
> 
> 时间：2012-10-19T19:17:29.033
> 
> 标签：ios, cocoa-touch, uilocalnotification

当 didReceiveLocalNotification 被调用时，我想知道是因为用户从我的应用程序外部单击了通知，还是因为我的应用程序在警报发生时是前台应用程序而被调用。了解区别很重要，因为在一种情况下，用户已经收到带有某些信息的警报并且不再需要它，在另一种情况下，他们还没有收到该信息。

我目前在 applicationWillEnterForeground 中设置一个标志并在 applicationDidBecomeActive 中清除。如果在调用 didReceiveLocalNotification 时设置了标志，我知道它来自我的应用程序之外，并且用户已经以某种形式看到了系统通知。但是，我只是注意到如果用户收到通知，则不会设置此标志，但尚未单击它（因此它只是在下拉通知区域中），然后在我的应用程序位于时从该区域单击它前景。在这种情况下，我的应用程序已经在前台，因此设置了标志。

理想情况下，我可以在 UILocationNotification 上设置一个属性以获取此信息。

我想我可以使用 fireDate 并说如果它不到 1 或 2 秒，并且未设置标志，那么我会实时收到通知，而不是稍后......但我更喜欢更强大的东西，如果可能的。

编辑：当我点击保存时，我注意到“相关”部分有这个链接：

[iOS - 需要区分应用程序中的 UILocalNotification:didReceiveLocalNotification:](https://stackoverflow.com/questions/11377197/ios-need-to-distinguish-uilocalnotification-in-applicationdidreceivelocalnoti)

很抱歉在没有先搜索更多内容的情况下发布了重复的问题（我确实搜索过！）。希望也许这会得到一个更好的答案，因为那个答案并没有真正的可靠答案——但也许没有。

# java - 用于加密密码的 Java 安装程序

> ID：12980995
> 
> 赞同：0
> 
> 时间：2012-10-19T19:17:46.560
> 
> 标签：java, installation, jasypt

我想为 Java 应用程序创建一个安装程序，并找到了一些很棒的应用程序。问题是我正在使用 Jasypt 加密属性文件中使用的密码。目前用户必须使用 Jasypt 命令行来加密他们的密码，然后在属性文件中输入加密的密码。然后他们必须在 Java 中包含加密密钥，这意味着编辑和重新编译。显然有一种更简单的方法可以做到这一点。我最终希望有一个安装程序来询问密码，对其进行加密，存储密钥，然后安装应用程序。我不是 Java 程序员 :( 更像是一个黑客。:) 谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:45:30.327

使用`Cipher`类来加密/解密密码。

在保存文件之前，使用`ENCRYPT_MODE`加密：

```
String passwordToEncrypt = ....//user entered
byte[] passwordToEncryptBytes = passwordToEncrypt.getBytes();

KeyGenerator keyGen = KeyGenerator.getInstance("AES");
SecretKey mySecretKey = keyGen.generateKey();

Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
cipher.init(Cipher.ENCRYPT_MODE, mySecretKey);
IvParameterSpec ivParameter = 
                    cipher.getParameters().getParameterSpec(IvParameterSpec.class);
byte[] encryptedPasswordData = cipher.doFinal(passwordToEncryptBytes); 
```

使用`encryptedPasswordData`加密文件。

打开文件时，提示输入密码，再次加密并尝试打开文件。如果密码正确，它应该可以通过。

# ruby-on-rails-3 - Rails 模型多次关联另一个模型

> ID：12980998
> 
> 赞同：0
> 
> 时间：2012-10-19T19:18:15.617
> 
> 标签：ruby-on-rails-3

我有一个名为 Pages 的模型，它看起来像这样：

```
title
description
image_id
background_image
logo 
```

我还有一个名为 Images 的模型，它看起来像这样：

```
id
title 
```

我希望能够将这三个字段与图像模型相关联。

```
image_id
background_image
logo 
```

由于 Page 模型关联，image_id 可以完美运行：

```
has_many :images 
```

如何使其与 background_image 和 logo 一起使用？希望我的问题有意义。谢谢

**更新** ![在此处输入图像描述](../Images/2f3960e5bc328ff8d91f36a931c4568d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:12:06.157

在您的`Page`模型中，您需要使用`belongs_to`它来指定它包含一个指向`Image`. 对于第一个，那就是`belongs_to :image`.

但是你想要三个指针。你可以这样做；对于其他每个字段，您将添加一个选项`belongs_to`来指定它指向一个`Image`. 您可以使用该`:class_name`选项执行此操作，如下所示；

```
belongs_to :logo, :class_name => 'Image' 
```

您可能还想`_id`在最后为您的列命名，所以`background_image_id`和`logo_id`- 这样更像是 Railsy。

所有这些都记录在 Rails 指南中；该`:class_name`选项专门[在这里](http://guides.rubyonrails.org/association_basics.html#belongs_to-class_name)。