# StackOverflow 问答 12643000-12643999

# c# - 自定义 UI 程序

> ID：12643003
> 
> 赞同：-1
> 
> 时间：2012-09-28T15:31:22.057
> 
> 标签：c#, visual-studio-2010, user-interface

我必须开始一个项目，该项目涉及制作具有用户友好界面的应用程序。我可以通过制作 ac# 应用程序在 Visual Studio 中完成所有编程，但我不知道如何自定义界面。它必须具有很强的交互性......就像将东西拖到垃圾箱或列表，自定义按钮和菜单（或类似的东西）。

您能否请我参考一个我可以用来实现这一目标的程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:32:50.697

听起来您需要有关 C# 表单的基本操作方法。试试[这个](http://msdn.microsoft.com/en-us/library/bb820885%28v=vs.90%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:33:35.227

您可以使用`WPF Application`

链接： http: [//msdn.microsoft.com/en-us/library/bb820878 (v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/bb820878(v=vs.90).aspx)

在 Visual Studio 中，您可以从创建项目开始

![在此处输入图像描述](../Images/a7e4b596d23adfdf5239bc24ff88b0ca.png)

WPF 应用程序的一些模式（最佳实践）：

`Prism`：[http ://compositewpf.codeplex.com/](http://compositewpf.codeplex.com/)

# preferences - RAD中的JSP模板代码在哪里

> ID：12643004
> 
> 赞同：0
> 
> 时间：2012-09-28T15:31:27.227
> 
> 标签：preferences, rad

任何人都知道 RAD 的 Preferences 中的哪个位置是在选择新的“Web Page”JSP 页面时生成的样板/模板代码？我可以找到 java 代码的代码模板，但找不到 JSP 的东西在哪里。我还可以找到上下文菜单插入设置，但我想要的是在选择制作新 JSP 时自动设置/插入一些样板 HTML 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:36:55.317

窗口 -> 首选项 -> Web -> JSP 文件 -> 编辑器 -> 模板。

(RAD 8.0)

# xml - 如何在 Powershell 中将 CData 添加为 XElement 值？

> ID：12643005
> 
> 赞同：0
> 
> 时间：2012-09-28T15:31:29.103
> 
> 标签：xml, powershell, cdata

我有一个 PS 脚本，它创建一些 XML 并将值分配给 XElement。我需要将 XElement 的值包装在 CData 中。这是使用 System.Xml.Linq 我试过这个：

```
$newNode.Element("details").Value = '<![CDATA[Traceback:'+$_.Exception.toString()+']]>' 
```

但是当我输出 xml 时，它会将“<”和“>”转换为 < 和 >。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:56:49.350

将类型对象添加`XCData`到您的元素

```
[Reflection.Assembly]::LoadWithPartialName("System.Xml.Linq") | Out-Null

[System.Xml.Linq.XCData] $cdata = New-Object -TypeName System.Xml.Linq.XCdata -ArgumentList "data"
[System.Xml.Linq.XElement] $element = New-Object -TypeName System.Xml.Linq.XElement -ArgumentList "test", $cdata 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:10:12.497

试试这个：

```
$cdata = $xml.CreateCDataSection($content)
$parent = $xml.GetElementsByTagName("TagName")[0]
$parent.AppendChild($cdata) 
```

# zend-framework2 - Zend/ZF2/TableGateway mysql_insert_id 替换？

> ID：12643008
> 
> 赞同：3
> 
> 时间：2012-09-28T15:31:41.350
> 
> 标签：zend-framework2, zend-db, lastinsertid, last-insert-id, tablegateway

我正在尝试从 mysql 切换到 Zend / TableGateway 类。

我想知道是否有一种类似于 mysql_insert_id 的方法来获取最后插入的行的自动递增 id。

谷歌搜索，我找到了一些答案，指向 DB-Adapter 的 lastInsertId()，但是，这种方法在 ZF2 中似乎不再可用。另外：插入方法的返回值是返回一个布尔值，而不是 ZF1 中的最后一个 id。

目前我正在使用一个丑陋的解决方法。请看下面的代码。

是否有更好/推荐的获取 ID 的方法？

```
table_1 {
    id: integer, primary key, autoincremented
    content: text
}

table_2 {
    table_1_id: integer
    other_content: text
}

// using mysql
$sql = "INSERT INTO table_1 (content) VALUES ('some text')";
$result = mysql_query($sql);
// check omitted

$id = mysql_insert_id();
$sql = "INSERT INTO table_2 (table_1_id, other_content) VALUES ($id, 'other text')";
$result = mysql_query($sql);

// using Zend - this is the code, I am currently using
//*************************************************************
// get_last_insert_id emulation; works only if content is unique
private function getLastInsertId($tableGateway, $content) {
    $entries = $tableGateway->select(array('content' => $content));
    foreach ($entries as $entry) {
        return $entry->id;
    }

    return null;
}
// another option: get highest ID, must be the last inserted
private function getLastInsertId($tableGateway) {
    // needs a method like 'getRowWithHighestId'
}
//*************************************************************

// ...
table_1_entry = new Table1Entry('some text');
$tableGateway->insert($hydrator->extract($table_1_entry));

//*************************************************************
// using the workaround:
$id = getLastInsertId($tableGateway, $table_1_entry->content);
// 
// there MUST be some Zend method to get this last id.
//*************************************************************

table_1_entry = new Table1Entry('other text', $id);
$tableGateway->insert($hydrator->extract($table_2_entry)); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-07T02:17:22.573

使用魔法属性`$tableGateway->lastInsertValue`获取 Id

```
$id = $tableGateway->lastInsertValue; 
```

该属性在执行插入数据时设置

[资源](https://github.com/zendframework/zf2/blob/1a77505473b0d5add8ced03b20b8fb3e12163ce9/library/Zend/Db/TableGateway/AbstractTableGateway.php#L295)

```
$this->lastInsertValue = $this->adapter->getDriver()->getConnection()->getLastGeneratedValue(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-04T10:46:34.360

```
`enter code here  `$data_add=array(
                'line_1'        =>  $Data1->line_1,
                'line_2'        =>  $Data1->line_2,
                'line_3'        =>  $Data1->line_3,
                'city_id'       =>  $Data1->city_id,
                'state_id'      =>  $Data1->state_id,
                'country_id'    =>  1,
                'is_active'     =>  '1',
        );
            $adapter = $this->tableGateway->getAdapter();
            $otherTable = new TableGateway('address', $adapter);
            $otherTable->insert($data_add);
            $lastInsertValue= $adapter->getDriver()->getConnection()->getLastGeneratedValue();
            print_r('lastInsertId1 :'.$lastInsertValue);
            error_log($lastInsertValue);
        die(); 
```

# regex - 浮点数的正则表达式

> ID：12643009
> 
> 赞同：165
> 
> 时间：2012-09-28T15:32:07.307
> 
> 标签：regex

我有一个任务来匹配浮点数。我为此编写了以下正则表达式：

```
[-+]?[0-9]*\.?[0-9]* 
```

但是，它返回一个错误：

```
Invalid escape sequence (valid ones are  \b  \t  \n  \f  \r  \"  \'  \\ ) 
```

据我所知，我们还需要使用转义字符`.`。请纠正我哪里错了。

* * *

## 回答 #1

> 赞同：359
> 
> 时间：2012-09-28T15:37:00.790

### TL;博士

使用`[.]`代替`\.`和`[0-9]`代替`\d`以避免在某些语言（如 Java）中转义问题。

^(*感谢[无名](https://stackoverflow.com/a/29306314/211627)者最初认识到这一点。*)

**用于匹配**较大字符串中的浮点数的一种相对简单的模式是：

```
[+-]?([0-9]*[.])?[0-9]+ 
```

这将匹配：

*   `123`
*   `123.456`
*   `.456`

^(*查看一个[工作示例](http://regexr.com/3g7p4)*)

如果您还想匹配`123.`（没有小数部分的句点），那么您需要一个稍长的表达式：

```
[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+) 
```

^(*有关此模式的更完整解释，请参见[pkeller 的回答](https://stackoverflow.com/a/42629198/211627)*)

如果您想包含更广泛的数字，包括科学记数法和十六进制和八进制等非十进制数字，请参阅我对[如何识别字符串是否为数字的回答？](https://stackoverflow.com/a/16303109/211627).

如果要**验证**输入是否为数字（而不是在输入中查找数字），则应使用 and 将模式括起来`^`，`$`如下所示：

```
^[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+)$ 
```

### *不规则*正则表达式

在大多数现代语言、API、框架、库等中实现的“正则表达式”是基于在[形式语言理论](https://en.wikipedia.org/wiki/Regular_expression#Formal_language_theory)中开发的概念。但是，软件工程师添加了许多扩展，使这些实现远远超出了正式定义。因此，尽管大多数正则表达式引擎彼此相似，但实际上并没有标准。因此，很大程度上取决于您使用的语言、API、框架或库。

（顺便说一句，为了帮助减少混淆，许多人已经开始使用“ **regex** ”或“ **regexp** ”来描述这些增强的匹配语言。有关更多信息，请参阅 RexEgg.com 上[的 Regex 与正则表达式相同吗？ ）](http://www.rexegg.com/regex-vs-regular-expression.html)

也就是说，大多数正则表达式引擎（实际上，据我所知，所有这些引擎）都会接受`\.`. 最有可能的是，逃逸存在问题。

### 逃跑的麻烦

某些语言具有对正则表达式的内置支持，[例如 JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions)。对于那些不这样做的语言，转义可能是一个问题。

这是因为您基本上是在一种语言中使用一种语言进行编码。例如，Java`\`在其字符串中用作转义字符，因此如果要在字符串中放置文字反斜杠字符，则必须对其进行转义：

```
// creates a single character string: "\"
String x = "\\"; 
```

但是，正则表达式*也*使用`\`字符进行转义，因此如果要匹配文字`\`字符，则必须为正则表达式引擎对其进行转义，然后为 Java 再次转义：

```
// Creates a two-character string: "\\"
// When used as a regex pattern, will match a single character: "\"
String regexPattern = "\\\\"; 
```

在您的情况下，您可能没有在您正在编程的语言中转义反斜杠字符：

```
// will most likely result in an "Illegal escape character" error
String wrongPattern = "\.";
// will result in the string "\."
String correctPattern = "\\."; 
```

所有这些转义都会变得非常混乱。如果您使用的语言支持[原始字符串](https://docs.python.org/2/howto/regex.html#the-backslash-plague)，那么您应该使用它们来减少反斜杠的数量，但并非所有语言都支持（最值得注意的是：Java）。幸运的是，有一个替代方案在某些时候会起作用：

```
String correctPattern = "[.]"; 
```

对于正则表达式引擎，`\.`含义`[.]`完全相同。请注意，这并非在所有情况下都有效，例如换行符 ( `\\n`)、左方括号 ( `\\[`) 和反斜杠 ( `\\\\`or `[\\]`)。

### 关于匹配数字的注意事项

**（提示：这比你想象的要难）**

匹配数字是您认为使用正则表达式很容易的事情之一，但实际上非常棘手。让我们一点一点地看一下您的方法：

```
[-+]? 
```

*匹配一个可选的`-`或`+`*

```
[0-9]* 
```

*匹配 0 个或多个连续数字*

```
\.? 
```

*匹配一个可选的`.`*

```
[0-9]* 
```

*匹配 0 个或多个连续数字*

[首先，我们可以通过对数字使用字符类简写](http://www.regular-expressions.info/shorthand.html)来稍微清理一下这个表达式（请注意，这也容易受到上述转义问题的影响）：

`[0-9]`=`\d`

我将在`\d`下面使用，但请记住，它的含义与`[0-9]`. （好吧，实际上，在某些引擎`\d`中，会匹配所有脚本中的数字，因此它会匹配得更多`[0-9]`，但这在您的情况下可能并不重要。）

现在，如果你仔细看，你会发现**你的模式的每一部分都是可选的**。该模式可以匹配一个长度为 0 的字符串；`+`仅由or组成的字符串`-`；或者，仅由 a 组成的字符串`.`。这可能不是您想要的。

要解决此问题，首先使用所需的最少字符串（可能是单个数字）“锚定”您的正则表达式会很有帮助：

```
\d+ 
```

现在我们想要添加小数部分，但它并没有达到您认为的位置：

```
\d+\.?\d* /* This isn't quite correct. */ 
```

这仍将匹配诸如`123.`. 更糟糕的是，它带有[一丝邪恶的色彩](https://en.wikipedia.org/wiki/ReDoS#Evil_regexes)。句点是可选的，这意味着您有两个并排重复的类 (`\d+`和`\d*`)。如果以错误的方式使用这实际上可能很危险，从而使您的系统容易受到 DoS 攻击。

为了解决这个问题，我们需要将其视为必需（以分隔重复的字符类）而不是将句点视为可选，而是将整个小数部分设为可选：

```
\d+(\.\d+)? /* Better. But... */ 
```

现在看起来好多了。我们需要在第一个数字序列和第二个数字序列之间有一个句点，但是有一个致命的缺陷：我们无法匹配`.123`，因为现在需要一个前导数字。

这实际上很容易解决。我们不需要将数字的“小数”部分设为可选，而是将其视为一个字符序列：1 个或多个可能以 a 为前缀的数字，可能`.`以 0 个或多个数字为前缀：

```
(\d*\.)?\d+ 
```

现在我们只需添加符号：

```
[+-]?(\d*\.)?\d+ 
```

当然，这些斜线在 Java 中很烦人，所以我们可以在我们的长格式字符类中替换：

```
[+-]?([0-9]*[.])?[0-9]+ 
```

### 匹配与验证

这已经在评论中出现了几次，所以我添加了一个关于匹配与验证的附录。

**匹配**的目标是在输入中找到一些内容（“大海捞针”）。**验证**的目的是确保输入是预期的格式。

就其性质而言，正则表达式仅**匹配**文本。给定一些输入，他们要么会找到一些匹配的文本，要么不会。`^`但是，通过使用锚标记（和）将表达式“捕捉”到输入的开头和结尾`$`，我们可以确保找不到匹配项，除非整个输入都与表达式匹配，从而有效地使用正则表达式来**验证**。

上述正则表达式 ( `[+-]?([0-9]*[.])?[0-9]+`) 将**匹配**目标字符串中的一个或多个数字。所以给定输入：

```
apple 1.34 pear 7.98 version 1.2.3.4 
```

正则表达式将匹配`1.34`, `7.98`,`1.2`和.`.3``.4`

要验证给定的输入是一个数字，而只是一个数字，请将表达式“捕捉”到输入的开头和结尾，方法是将其包装在锚标记中：

```
^[+-]?([0-9]*[.])?[0-9]+$ 
```

如果整个输入是浮点数，这只会找到匹配项，如果输入包含其他字符，则不会找到匹配项。因此，给定输入`1.2`，将找到匹配项，但`apple 1.2 pear`不会找到匹配项。

*请注意，某些正则表达式引擎具有`validate`,`isMatch`或类似的功能，它基本上自动执行我所描述的操作，`true`如果找到匹配项并且`false`没有找到匹配项则返回。另请记住，某些引擎允许您设置更改 and 定义的标志`^`，`$`匹配行的开头/结尾而不是整个输入的开头/结尾。这通常不是默认设置，但请注意这些标志。*

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2017-03-06T15:17:39.490

我不认为在撰写本文时此页面上的任何答案都是正确的（SO 上其他地方的许多其他建议也是错误的）。复杂之处在于您必须匹配以下所有可能性：

*   无小数点（即整数值）
*   小数点前后的数字（例如`0.35`, `22.165`）
*   仅小数点前的数字（例如`0.`, `1234.`）
*   仅小数点后的数字（例如`.0`, `.5678`）

同时，您必须确保某处至少有一位数字，即不允许出现以下情况：

*   小数点本身
*   没有数字的有符号小数点（即`+.`或`-.`）
*   `+`或`-`自己
*   一个空字符串

起初这似乎很棘手，但找到灵感的一种方法是查看该`java.lang.Double.valueOf(String)`方法的 OpenJDK 源代码（从[http://hg.openjdk.java.net/jdk8/jdk8/jdk](http://hg.openjdk.java.net/jdk8/jdk8/jdk)开始，单击“浏览”，向下导航`/src/share/classes/java/lang/`并找到`Double`班级）。此类包含的长正则表达式满足了 OP 可能没有考虑到的各种可能性，但为简单起见，忽略了它处理 NaN、无穷大、十六进制表示法和指数的部分，并使用`\d`而不是 POSIX 表示法一个数字，我可以将正则表达式的重要部分减少为没有指数的有符号浮点数：

`[+-]?((\d+\.?\d*)|(\.\d+))`

我认为没有一种方法可以避免`(...)|(...)`构造，而不允许不包含数字的内容，或者禁止小数点前没有数字或小数点后没有数字的可能性之一。

显然，在实践中，您需要在正则表达式本身或使用它的代码中处理尾随或前面的空格。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2019-04-09T12:04:52.597

我想匹配大多数语言认为有效的数字（整数和浮点数）：

*   `'5' / '-5'`

*   `'1.0' / '1.' / '.1' / '-1.' / '-.1'`

*   `'0.45326e+04', '666999e-05', '0.2e-3', '-33.e-1'`

笔记：

*   `preceding sign of number ('-' or '+') is optional`

*   `'-1.' and '-.1' are valid but '.' and '-.' are invalid`

*   `'.1e3' is valid, but '.e3' and 'e3' are invalid`

为了同时支持'1'。和 '.1' 我们需要一个 OR 运算符 ('|') 以确保我们排除 '.' 从匹配。

`[+-]?`+/- sing 是可选的，因为`?`意味着 0 或 1 匹配

`(`因为我们有 2 个子表达式，我们需要将它们放在括号中

`\d+([.]\d*)?(e[+-]?\d+)?`这适用于以数字开头的数字

`|`分隔子表达式

`[.]\d+(e[+-]?\d+)?`这适用于以“。”开头的数字。

`)`表达式的结尾

*   对于以 '.' 开头的数字

`[.]`第一个字符是点（在括号内，否则它是通配符）

`\d+`一位或多位数字

`(e[+-]?\d+)?`这是一个可选的（0 或 1 个匹配，由于结尾 '?'）科学记数法

*   对于以数字开头的数字

`\d+`一位或多位数字

`([.]\d*)?`可选地，我们可以在点字符后面加上零个或多个数字

`(e[+-]?\d+)?`这是一个可选的科学记数法

*   科学计数法

`e`指定指数的文字

`[+-]?`可选指数符号

`\d+`一位或多位数字

**所有这些结合起来：**

```
[+-]?(\d+([.]\d*)?(e[+-]?\d+)?|[.]\d+(e[+-]?\d+)?) 
```

也接受`E`：

```
[+-]?(\d+([.]\d*)?([eE][+-]?\d+)?|[.]\d+([eE][+-]?\d+)?) 
```

（[测试用例](https://regexr.com/557nd)）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-03-27T17:09:21.077

This is simple: you have used Java and you ought to use `\\.` instead of `\.` (search for character escaping in Java).

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-09-28T15:35:50.600

你需要的是：

```
[\-\+]?[0-9]*(\.[0-9]+)? 
```

我转义了“+”和“-”符号，并将小数与其后面的数字分组，因为类似于“1”。不是有效数字。

这些更改将允许您匹配整数和浮点数。例如：

```
0
+1
-2.0
2.23442 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-10-17T13:52:34.910

这个对我有用：

```
(?P<value>[-+]*\d+\.\d+|[-+]*\d+) 
```

您也可以使用这个（没有命名参数）：

```
([-+]*\d+\.\d+|[-+]*\d+) 
```

使用一些在线正则表达式测试器来测试它（例如 regex101 ）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-02-24T10:57:51.857

```
^[+-]?([0-9]{1,})[.,]([0-9]{1,})$ 
```

这将匹配：

1.  1.2
2.  12.3
3.  123.4
4.  1,2
5.  12,3
6.  123,4

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-04-08T06:03:35.773

这将捕获 C/C++ 代码中识别的浮点数：

```
[+-]?((((\d+\.?\d*)|(\.\d+))([eE][+-]?\d+[fF]?)?)|((\d+\.\d*)|(\.\d+))[fF]?) 
```

*   +/- 符号
*   只有数字、数字、.digits 或digits.digits
*   带 e 或 E、+/- 符号和数字的可选指数
*   可选 f 或 F 结尾，但前提是数字包含 a 。或指数

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-09-19T00:59:41.273

```
(\d*)(\.)*(\d+) 
```

这将解析以下内容。

```
11.00
12
.0 
```

必须有一个数字。小数点和小数点前的数字是可选的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-02-01T20:10:26.550

对于 javascript

```
const test = new RegExp('^[+]?([0-9]{0,})*[.]?([0-9]{0,2})?$','g'); 
```

这适用于 1.23 1234.22 0 0.12 12

您可以更改 中的部分`{}`以获得小数长度和小数前面的不同结果。这在输入中用于输入数字并在您键入时检查每个输入，仅允许通过的内容。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-31T13:05:36.353

```
[+/-] [0-9]*.[0-9]+ 
```

试试这个解决方案。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-11-07T17:28:32.997

在 C 语言中，答案是这样的：

```
[+-]?((\d+\.?\d*)|(\.\d+))(([eE][+-]?)?\d+)?[fFlL]? 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-01-14T10:54:11.603

对于那些搜索将**验证***整个输入*的正则表达式的人，该输入应该是用户*键入的每个字符上的有***符号**浮点数。

 *即符号首先出现（应该匹配并且有效），然后是所有数字（仍然匹配并且有效）及其可选的小数部分。

在 JS 中，我们使用`onkeydown`/`oninput`事件来做到这一点 + 以下正则表达式：

```
^[+-]?[0-9]*([\.][0-9]*)?$ 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-11-11T10:22:09.640

```
[+-]?(([1-9][0-9]*)|(0))([.,][0-9]+)? 
```

`[+-]?`- 可选的领先标志

`(([1-9][0-9]*)|(0))`- 不带前导零的整数，包括单个零

`([.,][0-9]+)?`- 可选小数部分

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-03-09T22:00:16.057

在 c 表示法中，浮点数可以以下列形式出现：

1.  123
2.  123.
3.  123.24
4.  .24
5.  2e-2 = 2 * 10 战俘 -2 = 2 * 0.1
6.  4E+4 = 4 * 10 战俘 4 = 4 * 10 000

为了创建浮点正则表达式，我将首先创建“int 正则表达式变量”：

```
(([1-9][0-9]*)|0) will be int 
```

现在，我将编写小块浮点正则表达式 - 解决方案是用符号“|”连接这些块。

块：

```
- (([+-]?{int}) satysfies case 1
- (([+-]?{int})"."[0-9]*)  satysfies cases 2 and 3
- ("."[0-9]*) satysfies case 4
- ([+-]?{int}[eE][+-]?{int}) satysfies cases 5 and 6 
```

最终解决方案（连接小块）：

```
(([+-]?{int})|(([+-]?{int})"."[0-9]*)|("."[0-9]*)|([+-]?{int}[eE][+-]?{int}) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-05-19T02:34:00.267

在 C++ 中使用正则表达式库

答案是这样的：

```
[0-9]?([0-9]*[.])?[0-9]+ 
```

请注意，我不使用符号符号，如果您想要它带有符号符号，它会这样做：

```
[+-]?([0-9]*[.])?[0-9]+ 
```

这也将常规数字或十进制数字分开。*

# java - 在 JDialog 中显示内容的延迟

> ID：12643010
> 
> 赞同：0
> 
> 时间：2012-09-28T15:32:13.017
> 
> 标签：java, swing, user-interface, jlabel, jdialog

请看下面的代码

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.util.List;
import java.util.ArrayList;

public class SendEmailForm extends JDialog {

    private JLabel to, cc, bcc, subject, account;
    private JTextField toTxt, ccTxt, bccTxt, subjectTxt;
    private JTextArea messageTxt;
    private JButton send;
    private JComboBox accountBox;
    private JScrollPane scroll;
    private GridBagLayout gbl;
    private GridBagConstraints gbc;

    public SendEmailForm() {
        //Declaring instance variables
        to = new JLabel("To: ");
        cc = new JLabel("CC: ");
        bcc = new JLabel("BCC: ");
        subject = new JLabel("Subject: ");
        account = new JLabel("Select an Account: ");

        toTxt = new JTextField(20);
        ccTxt = new JTextField(20);
        bccTxt = new JTextField(20);
        subjectTxt = new JTextField(20);

        messageTxt = new JTextArea(20, 50);
        messageTxt.setLineWrap(true);
        scroll = new JScrollPane(messageTxt);
        scroll.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED);
        scroll.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);

        accountBox = new JComboBox();
        accountBox.addItem("Yahoo");
        accountBox.addItem("GMail");
        accountBox.addItem("MSN");
        //accountBox.addItem("Yahoo");
        //accountBox.addItem("Yahoo");

        JPanel buttonPanel = new JPanel();
        buttonPanel.setLayout(new FlowLayout());

        send = new JButton("Send");
        send.addActionListener(new SendButtonAction());
        buttonPanel.add(send);

        //Creating thr GUI
        //GUI CREATION IS REMOVED IN THIS POST

        this.setTitle("Send Emails");
        this.setVisible(true);
        this.pack();
        this.setLocationRelativeTo(null);
        this.validate();
    }

    private class SendButtonAction implements ActionListener {

        public void actionPerformed(ActionEvent ae) {
            ProgressMonitor pm = new ProgressMonitor();
            //Retreiving the user name and password
            List userData = new ArrayList();

            EmailDBConnector emailCon = new EmailDBHandler();
            userData = emailCon.getUserNameAndPassword(
                    accountBox.getSelectedItem().toString().trim());

            String userName = userData.get(0).toString();
            String password = userData.get(1).toString();
            System.out.println(userName);
            System.out.println(password);

            pm.setVisible(true);

            SendEmail sendEmail = new SendEmail(toTxt.getText(), userName.trim(),
                    bccTxt.getText(), ccTxt.getText(), accountBox.getSelectedItem().toString().trim(), messageTxt.getText().trim(),
                    password.trim(), subjectTxt.getText());

            String result = sendEmail.send();
            //pm.dispose();
            JOptionPane.showMessageDialog(null, result);
        }
    }

    private class ProgressMonitor extends JDialog {

        public ProgressMonitor() {
            this.setLayout(new BorderLayout());
            JLabel text = new JLabel("Sending..Please wait...");
            this.add(text, "Center");
            this.pack();
            this.validate();
            this.setLocationRelativeTo(null);
        }
    }
} 
```

首先，这是一个电子邮件程序。在这里，当调用 JDialog 时，它只是作为 100% 空白窗口打开。我添加了一个 JLabel，但它在显示时不存在。无论如何，发送电子邮件需要一些时间，发送电子邮件后，我可以在JDialog中看到JLabel。如果我把我的问题放在一句话中，我在发送电子邮件之前调用了 JDialog，但它显示为空白，发送电子邮件后，它的内容就在那里！为什么是这样？请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:43:25.533

您的代码不是[SSCCE](http://sscce.org/)，那么

1.`SendEmailForm();`

*   消除`this.validate();`

*   `this.setVisible(true);`作为最后一个代码行移动

*   前移`this.pack();`_`this.setVisible(true);`

*   前移`this.setLocationRelativeTo(null);`_`this.setVisible(true);`

2.`public ProgressMonitor() {`可能是

代码

```
 private class ProgressMonitor extends JDialog {

        public ProgressMonitor() {
            setLayout(new BorderLayout());
            JLabel text = new JLabel("Sending..Please wait...");
            add(text, "Center");
            pack();
            setLocationRelativeTo(null);
            SwingUtilities.invokeLater(new Runnable() {

                @Override
                public void run() {
                    setVisible(true);
                }
            });
        }
    } 
```

.

3.rest 不清楚你的问题

*   被`JComponents`添加到可见容器中，那么最后的代码行应该是`(re)validate()`和`repaint()`

*   重`JDialog`用于下一个操作，设置`HIDE_on_CLOSE`为默认关闭操作`JDialog`

*   不要扩展`JDialog`，将此contianer创建为局部变量，然后您只能`(my)JDialog.setVisible(true`在下一个操作（包装在）中调用`invokeLater()`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:50:38.450

您已经*创建*了许多组件，但尚未将它们添加到`JFrame`您的应用程序中。在使用`GrigBagLayout`时，您需要为每个组件设置约束，例如：

```
subject = new JLabel("Subject: ");
gbc.fill = GridBagConstraints.BOTH;
gbc.weightx = 1.0;
gbl.setConstraints(subject, gbc);
add(subject); 
```

也不要忘记先实例化布局和约束：

```
private GridBagLayout gbl = new GridBagLayout();
private GridBagConstraints gbc = new GridBagConstraints(); 
```

# perl - 为什么我在使用 Perl Here-Document 时会出现语法错误？

> ID：12643016
> 
> 赞同：4
> 
> 时间：2012-09-28T15:32:38.383
> 
> 标签：perl, heredoc

我似乎很难让我的 here-document 正常工作。我有一大段文本需要填充到变量中并保持未插值。

这是我所拥有的：

```
my $move_func <<'FUNC';
function safemove
{
    if [[ ! -f $1 ]] ; then echo "Source File Not Found: $1"; return 1; fi
    if [[ ! -r $1 ]] ; then echo "Cannot Read Source File: $1"; return 2; fi
    if [[ -f $2 ]]   ; then echo "Destination File Already Exists: $1 -> $2"; return 3; fi
    mv $1 $2
}
FUNC

# Do stuff with $move_func 
```

这给了我

```
Scalar found where operator expected at ./heredoc.pl line 9, near "$1 $2"
        (Missing operator before $2?)
Semicolon seems to be missing at ./heredoc.pl line 10.
syntax error at ./heredoc.pl line 6, near "if"
syntax error at ./heredoc.pl line 10, near "$1 $2
"
Execution of ./heredoc.pl aborted due to compilation errors. 
```

* * *

但是，以下工作按预期工作：

```
print <<'FUNC';
function safemove
{
    if [[ ! -f $1 ]] ; then echo "Source File Not Found: $1"; return 1; fi
    if [[ ! -r $1 ]] ; then echo "Cannot Read Source File: $1"; return 2; fi
    if [[ -f $2 ]]   ; then echo "Destination File Already Exists: $1 -> $2"; return 3; fi
    mv $1 $2
}
FUNC 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T15:36:58.953

您需要使用赋值运算符对字符串进行赋值，以形成完整的语句：

```
my $move_func = <<'FUNC';
function safemove
{
    if [[ ! -f $1 ]] ; then echo "Source File Not Found: $1"; return 1; fi
    if [[ ! -r $1 ]] ; then echo "Cannot Read Source File: $1"; return 2; fi
    if [[ -f $2 ]]   ; then echo "Destination File Already Exists: $1 -> $2"; return 3; fi
    mv $1 $2
}
FUNC

# Do stuff with $move_func 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-28T15:38:20.340

你错过了这个`=`标志：

```
my $move_func = <<'FUNC'; 
```

# html - 内容为动态时，字段集高度为表格单元格的 100%

> ID：12643017
> 
> 赞同：1
> 
> 时间：2012-09-28T15:32:39.767
> 
> 标签：html, css, internet-explorer, height, fieldset

我有以下结构：

[http://jsfiddle.net/poztin/q9v9j/10/](http://jsfiddle.net/poztin/q9v9j/10/)

我试图让字段集垂直填充它们的父表格单元格。

我的理解是，为了让字段集的高度为 100%，我需要在它的父级上设置一个固定的高度。

但是每个字段集中的内容是动态生成的，因此我无法设置固定高度。

上面的 jsFiddle 适用于 Chrome，但不适用于 IE。

如何在 IE 中实现这一点？我更喜欢 css 解决方案，但也欢迎 jQuery 建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:44:21.323

您已将`td`高度设置为`1px`。我删除了它。这是你想要的？[http://jsfiddle.net/q9v9j/13/](http://jsfiddle.net/q9v9j/13/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-16T16:52:23.280

主要元素“table”必须有 height:100%，然后它就神奇地起作用了。

```
See here: 
```

[http://jsfiddle.net/luissanchezm86/nGCdx/13/](http://jsfiddle.net/luissanchezm86/nGCdx/13/)

# build - 如何在 after_script 命令中获取 Travis-CI build_number

> ID：12643018
> 
> 赞同：9
> 
> 时间：2012-09-28T15:32:41.763
> 
> 标签：build, github, continuous-integration, travis-ci

如何从Travis-CI 的命令中获取*build_number*（和其他构建元数据） ？`after_script`

已经尝试过的内容：

[关于构建配置](http://about.travis-ci.org/docs/user/build-configuration/)的文档在**IRC 通知**部分中说明了这一点：

> 您还可以使用模板自定义将发送到频道的消息：
> 
> ```
> notifications:
>   irc:
>     channels:
>       - "irc.freenode.org#travis"
>       - "irc.freenode.org#some-other-channel"
>     template:
>       - "%{repository} (%{commit}) : %{message} %{foo} "
>       - "Build details: %{build_url}" 
> ```
> 
> 您可以插入以下变量：
> 
> *   *存储库*：您的 GitHub 存储库 URL。
> *   *build_number*：内部版本号。
> *   *分支*：分支构建名称。
> *   *commit* : 缩短提交 SHA
> *   *作者*：提交作者姓名。
> *   *message* : 给构建的 travis 消息。
> *   *compare_url*：提交更改视图 URL。
> *   *build_url*：构建详细信息的 URL。

试图让它在如下`after_script`命令中工作，根本不起作用：

```
language: java
after_script:
  - git commit -a -m "Committed by Travis-CI build number: %{build_number}" 
```

它表现得好像`.travis.yml`文件不存在/无效（即使它确实通过了 Travis-CI YAML 验证[here](http://lint.travis-ci.org/)）。

似乎这应该是可行的，但找不到任何这样做的样本。

有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-28T16:36:13.820

不幸的是，您可以为 IRC 输出执行的字符串替换只能在那里工作。它们通常仅用于通知，自定义输出，但目前仅适用于 IRC。

通过访问 TRAVIS_JOB_ID 环境变量，仍然可以获取当前的内部版本号。如果您将脚本更改为以下行，事情应该会按预期工作：

```
after_success:
  - git commit -a -m "Committed by Travis-CI build number: $TRAVIS_JOB_ID" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-16T08:22:34.377

我在我的部署脚本中使用它：

```
git commit -am "Auto deploy from Travis CI build $TRAVIS_BUILD_ID" 
```

有关[Travis CI 文档](https://docs.travis-ci.com/user/environment-variables/#Default-Environment-Variables)的更多信息。

# scala - 自类型不能访问类型成员

> ID：12643020
> 
> 赞同：2
> 
> 时间：2012-09-28T15:32:49.420
> 
> 标签：scala, abstract-type, self-type

给定一个带有类型参数的特征和一个带有抽象类型成员的特征：

```
trait Foo[A] {
  def schoko(f: A) : Unit
}
trait Bar {
  type A
  def foo: Foo[A]
}

trait X

trait ConcreteBar extends Bar {
  final type A = X
} 
```

是否有任何更改可以使以下任何一项工作：

```
trait Mixin extends ConcreteBar {
  _: Foo[A] => // "not found: type A"
  def foo = this
}

trait Mixin[A] extends Bar {
  _: Foo[A] =>
  def foo = this // "found: Mixin[A] with Foo[A]   required: Foo[Mixin.this.A]"
}

trait Mixin[A1] extends ConcreteBar {
  _: Foo[A1] =>
  type A = A1  // "error: overriding type A in trait ConcreteBar, which equals X"
  def foo = this
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:19:17.133

使用`#`访问类型的语法`A`似乎有效：

```
trait Mixin extends ConcreteBar {
   _: Foo[ ConcreteBar#A ] =>
   def foo = this
} 
```

似乎 的成员`ConcreteBar`不在自我类型声明的范围内，因此您必须显式引用该类型。

# google-tv - 适用于 Google TV 的 Flash Player 调试版

> ID：12643022
> 
> 赞同：0
> 
> 时间：2012-09-28T15:32:57.200
> 
> 标签：google-tv, flashplayer-debug

我想知道是否可以获得用于 Google TV 的 Flash Player Chrome 插件的调试版本？我想远程调试在 Google TV 设备上运行的 Flash 应用程序，但据我了解，这需要播放器的调试版本，以及用于输入调试器所在的远程主机的主机名的机制（例如 Flash Builder）在跑。

我确实在 Adob​​e 网站上找到了[一篇关于 Chrome的文章，但没有提到 Google TV。](http://helpx.adobe.com/flash-player/kb/flash-player-google-chrome.html)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T05:45:52.650

它不可用。Google TV 基于 Android - 对 Android 的[Flash 支持已被弃用](http://blogs.adobe.com/flashplayer/2012/06/flash-player-and-android-update.html)。在撰写本文时，Google TV 基于 Android 3.2 并继续支持 Flash - 预计未来版本不会支持 Flash。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T03:43:59.877

请注意，用户无法在 Google TV 上的当前 Chrome 中更新 Flash，因此无法转到 Flash 的调试版本。开发人员必须在您的 Action 脚本中实现调试代码。鉴于 Flash 支持最终将被逐步淘汰，因此在 Google TV 上寻找与未来版本的 Android/Chrome 更兼容的其他解决方案更有意义。

# html - 我可以自动将 .ppt 转换为 .html 吗？

> ID：12643024
> 
> 赞同：1
> 
> 时间：2012-09-28T15:33:03.363
> 
> 标签：html, vb.net, powerpoint

我一直在尝试找出在 Intranet 上显示电源点的最佳方式。公司的用户不会很技术，可能不会遵循我将描述的流程。

我找到了这个[页面](http://support.microsoft.com/kb/980553)

其中显示了如何将电源点转换为可以查看的 html 页面。我想知道是否有某种方法可以自动化这个过程。例如一个文件观察者观察它将保存的位置，然后一旦看到它就会使用我提供的页面上提供的代码自动将其更改为 html。首选使用的语言是 VB.NET。

我很高兴人们可以提出任何建议。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:38:18.703

您可以尝试使用此代码 - 基于`Microsoft.Office.Interop.PowerPoint.Application`

您有代码示例以尝试功能

查看 Aspx

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="AspNetPowerPointConvertToHTML.aspx.vb" Inherits="AspNetPowerPointConvertToHTML" %>  
<html>  
<head>  
<title>ShotDev.Com Tutorial</title>  
</head>  
<body>  
<form id="form1" runat="server">  
<asp:Label id="lblText" runat="server"></asp:Label>  
</form>  
</body>  
</html> 
```

背后的代码

```
Imports Microsoft.Office.Interop.PowerPoint  
Public Class AspNetPowerPointConvertToHTML  
Inherits System.Web.UI.Page  

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load  

Dim ppApp As New Microsoft.Office.Interop.PowerPoint.Application  
Dim ppName As String = "MySlides.ppt"  
Dim FileName As String = "MyPP/MyPPt"  

ppApp.Visible = True  

ppApp.Presentations.Open(Server.MapPath(ppName))  
ppApp.ActivePresentation.SaveAs(Server.MapPath(FileName), 13)  
ppApp.Quit()  
ppApp = Nothing  

Me.lblText.Text = "PowerPoint Created to Folder <strong> " & FileName & "</strong>"  

End Sub  
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T10:40:50.877

我用过：

```
Imports PowerPoint = Microsoft.Office.Interop.PowerPoint 
```

能够自动将电源点更改为 HTML。我已经使用文件观察器来观察我计算机上的一个目录，以便在它仅设置为 .pptx 的那一刻寻找 power point 演示文稿，但是我会尽快更改它以添加其他格式。该文件Water 位于计算机启动时启动的服务上。然后它会查看是否已创建或修改了 powerpoint 并运行以下代码：

```
Private Shared Sub OnChanged(ByVal source As Object, ByVal e As FileSystemEventArgs)
    'set varaibles so that html can save in correct place
    Dim destinationDirectory As String = e.FullPath.Replace(e.Name.ToString(), "")
    Dim sourceLocation As String
    Dim fileName As String
    'couple of if statements to get rid of unwanted characters
    If e.Name.Contains("~$") Then
        fileName = e.Name.Replace("~$", "")
        fileName = fileName.Replace(".pptx", ".html")
    Else
        fileName = e.Name
        fileName = fileName.Replace(".pptx", ".html")
    End If

    If e.FullPath.Contains(("~$")) Then
        sourceLocation = e.FullPath.Replace("~$", "")
    Else
        sourceLocation = e.FullPath
    End If

    Dim strSourceFile As String = sourceLocation 'set source location after removing unwanted characters
    Dim strDestinationFile As String = destinationDirectory & fileName 'set the destination location with the directory and file name
    'set ppAPP to a power point application
    Dim ppApp As PowerPoint.Application = New PowerPoint.Application
    Dim prsPres As PowerPoint.Presentation = ppApp.Presentations.Open(strSourceFile, MsoTriState.msoTrue, MsoTriState.msoFalse, MsoTriState.msoFalse)
    'Call the SaveAs method of Presentaion object and specify the format as HTML
    prsPres.SaveAs(strDestinationFile, PowerPoint.PpSaveAsFileType.ppSaveAsHTML, MsoTriState.msoTrue)
    'Close the Presentation object
    prsPres.Close()
    'Close the Application object
    ppApp.Quit()

End Sub 
```

这将获取已修改的文件并将其保存为 html 文档。它还将获取运行所需的文件，因此如果保存了任何动画，它也会保留这些文件。

# excel - 防止 Excel 刷新数据透视表，直到 VBA 告知这样做

> ID：12643025
> 
> 赞同：3
> 
> 时间：2012-09-28T15:33:06.223
> 
> 标签：excel, pivot-table, excel-template, vba

我有一个 Excel 模板 (.xlt)，其中包含一个用于报告数据的工作表，以及 4 个带有数据透视表的工作表。

当我们的报告系统创建报告并将模板应用到它时，数据透视表引用的某些字段不存在，因为运行宏来创建它们作为报告系统过程的一部分。

但是，由于这些字段不存在，Excel 会抛出错误（访问组件属性/方法时发生错误：REFRESH。参考无效。）。为了尝试防止这种情况，我取消了所有数据透视表上的选项`Refresh data when opening the file`。

我知道我可以使用 VBA 刷新数据透视表，但是有没有办法防止数据透视表在打开文档网时刷新它们，而是在创建新字段后通过 VBA 刷新它们？谢谢。

```
Function UpdatePivots()
    ActiveWorkbook.Sheets("DJG Marketing - Client List by ").PivotTables("PivotTable1").PivotCache.Refresh
    ActiveWorkbook.Sheets("DJG Marketing - Client List by ").PivotTables("PivotTable2").PivotCache.Refresh
    ActiveWorkbook.Sheets("DJG Marketing - Client List by ").PivotTables("PivotTable3").PivotCache.Refresh
    ActiveWorkbook.Sheets("DJG Marketing - Client List by ").PivotTables("PivotTable4").PivotCache.Refresh
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:03:27.067

这就是你需要的：

```
' Disable automatic calculation
Application.Calculation = xlCalculationManual
' do regular operation here
' Force a calculation
Application.Calculate
' Then remember to run automatic calculations back on
Application.Calculation = xlCalculationAutomatic 
```

取自： [http ://www.zerrtech.com/content/stop-vba-automatic-calculation-using-applicationcalculation-manual](http://www.zerrtech.com/content/stop-vba-automatic-calculation-using-applicationcalculation-manual)

# windows-8 - Chrome 如何侧载“商店应用程序”？

> ID：12643029
> 
> 赞同：7
> 
> 时间：2012-09-28T15:33:34.523
> 
> 标签：windows-8, windows-store

我的任务是为 windows 8 编写一个简单的一次性 Metro/windows 商店/现代 UI（无论你现在想怎么称呼它）应用程序；尝试将其放入商店是不合适的，因为我们只计划将其部署到大约 4 或 5 台设备上。我注意到，当我在机器上安装 Chrome 时，它​​以某种方式设法将自己的 Metro 版本偷偷带入了我的开始菜单。

我**不是**在寻找将 Metro 应用程序部署到另一台机器的方法，我已经可以通过多种方式（包括 add-appxpackage 以及通过 Visual Studio 2012 的远程调试器工具），我只是好奇 Chrome 是如何设法做到的侧载 Metro 应用程序，以及他们使用的过程。

有人有想法么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-28T15:47:25.463

安装 Chrome 时没有旁加载 Windows 应用程序。浏览器得到特殊处理，如果默认浏览器（并且只有默认浏览器）实现了适当的功能，它可以充当 Windows 应用商店应用程序。

在 MSDN 上有一份关于其工作原理的可下载白皮书：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh465413.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465413.aspx)

# c# - C#: (float) (x / y) 和 x / (float) y 有区别吗？

> ID：12643032
> 
> 赞同：2
> 
> 时间：2012-09-28T15:33:44.863
> 
> 标签：c#, casting, floating-point

我想知道以下表达式是否等效（在 C# 中）：

```
float x = ... ;
int y = ... ;

var result = (float) (x / y);

Versus:

var result = x / (float)y; 
```

我在哪里可以阅读有关此特定主题的更多信息？

我感兴趣的是：

1.  这些总是会产生相同的结果吗？
2.  一种选择是否比另一种更有效？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T15:38:49.197

是的，它们的行为方式相同。实际上，您可以使用：

```
var result = x / y; 
```

或者

```
float result = x / y; 
```

C# 4 规范的第 7.8.2 节显示了哪些除法运算符可用 - 并且没有`float operator /(float, int)`运算符。相反，C# 编译器使用从`int`to的隐式转换`float`，并使用`float operator /(float, float)`运算符。

这只是正常的运算符重载决议（规范第 7.3.4 节）和隐式数字转换（规范第 6.1.2 节）。

如有疑问，请参阅规范。我有一个[包含不同版本链接的网页](http://csharpindepth.com/Articles/Chapter1/Specifications.aspx)；C# 5 规范与 VS 2012 捆绑在一起，但现在没有单独的下载。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-28T15:38:22.793

完全没有区别。生成的 IL 代码是相同的：

以下是 IL 反汇编程序为两种变体返回的内容：

```
// Code size       16 (0x10)
.maxstack  2
.locals init ([0] float32 x,
         [1] int32 y,
         [2] float32 result)
IL_0000:  nop
IL_0001:  ldc.r4     1.5
IL_0006:  stloc.0
IL_0007:  ldc.i4.1
IL_0008:  stloc.1
IL_0009:  ldloc.0
IL_000a:  ldloc.1
IL_000b:  conv.r4
IL_000c:  div
IL_000d:  conv.r4
IL_000e:  stloc.2
IL_000f:  ret 
```

# facebook - Facebook Graph Api 访问酒精相关页面

> ID：12643034
> 
> 赞同：0
> 
> 时间：2012-09-28T15:33:51.303
> 
> 标签：facebook, facebook-graph-api

我正在寻找一种解决方案，通过网站或后端服务获取与酒精相关/有年龄限制的 Facebook 品牌页面的提要，以便在该网站中为任何用户显示这些信息。

即：[https](https://graph.facebook.com/JimBeam) ://graph.facebook.com/JimBeam 标准调用导致错误或错误。我知道原因是由于与酒精有关的年龄限制。

如果我连接到 Facebook 并向请求添加 access_token（用户令牌或页面令牌），我会得到我需要的一切，但如果我没有连接，它就不起作用。

如果我使用offline_access 请求页面令牌，当我没有连接到Facebook 时它也不起作用。

我对所有这些令牌类型、offline_access、权限等感到有点困惑。

是否可以获取年龄限制页面的 fb-graph-feed 并将其加载到网站中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:22:30.120

要获得有年龄限制的提要，您需要拥有符合页面标准的用户访问令牌。因此，如果用户正在访问您的网站，他们将需要对您的应用进行身份验证，然后您可以使用生成的访问令牌从该受限页面将信息提取到您的网站。

您不应使用用户的访问令牌向不符合 Facebook 页面限制的其他用户显示内容。

另一个问题是 Facebook 不会通过 API 公开页面的限制，因此在您的 API 请求没有返回数据之前，您无法判断用户是否有权查看该页面。

# .htaccess - 用 .htacces 中的 mod rewrite 替换 Segment

> ID：12643036
> 
> 赞同：1
> 
> 时间：2012-09-28T15:34:03.540
> 
> 标签：.htaccess, mod-rewrite

我正在尝试更改此 URL：

```
domain.com/?ACT=52&id=28 
```

对此：

```
domain.com/site.html 
```

我想将最后一段替换`?ACT=52&id=28`为`site.html`. 没有要考虑的参数。URL`domain.com/?ACT=52&id=28`将始终相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:23:34.037

尝试将其放入文档根目录的 htaccess 文件中：

```
RewriteEngine On
RewriteCond %{QUERY_STRING} ^ACT=52&id=28$
RewriteRule ^/?$ /site.html [L] 
```

这使得当有人去 时`domain.com/?ACT=52&id=28`，他们会在 处获得内容`domain.com/site.html`，但是如果您要更改浏览器 URL 地址栏中的 URL，则需要**REDIRECT**，而不是内部重写，因此在方括号中添加重定向标志：`[L,R]`

# java - GAE Java SDK：appengine-web.xml" 我正在使用 Google App Engine Java SDK 1.7.2 来提供一些静态文件。在 appengine-web.xml 中组合多个<include...元素<static-files>时，我不确定哪些规则将优先。 例 问问题 问问题 2012-09-28T15:34:12.720 1131 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在使用 Google App Engine Java SDK 1.7.2 来提供一些静态文件。在 appengine-web.xml 中组合多个<include...元素<static-files>时，我不确定哪些规则将优先。 例如，我有以下内容： <static-files></static-files>我相信这指定了除了 .php 文件之外的所有内容都应该包含在静态存储中，并且 .swf 和 .jpg 文件应该在未来 365 天设置“缓存控制”和“过期”http 标头。 但是，当使用 Firefox 的 Live HTTP Headers 工具时，我看不到具有长过期时间的静态文件的预期标头： http://localhost:8888/swf/Logo.20120927.swf GET /swf/Logo.20120927.swf HTTP/1.1 Host: localhost:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:15.0) Gecko/20100101 Firefox/15.0.1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-gb,en-us;q=0.7,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: keep-alive Referer: http://localhost:8888/ If-Modified-Since: Thu, 27 Sep 2012 15:49:03 GMT Cache-Control: max-age=0 HTTP/1.1 304 Not Modified Server: Jetty(6.1.x) ---------------------------------------------------------- http://localhost:8888/images/logo-and-buttons.20120927.jpg GET /images/logo-and-buttons.20120927.jpg HTTP/1.1 Host: localhost:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:15.0) Gecko/20100101 Firefox/15.0.1 Accept: image/png,image/*;q=0.8,*/*;q=0.5 Accept-Language: en-gb,en-us;q=0.7,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: keep-alive Referer: http://localhost:8888/ If-Modified-Since: Thu, 27 Sep 2012 15:49:03 GMT Cache-Control: max-age=0 HTTP/1.1 304 Not Modified Server: Jetty(6.1.x) 我的问题是，如果这没有按预期运行，那么如何配置我的<static-files>元素以达到预期的效果？ 干杯， 杰夫。 我已经回答了我自己的问题：我的“缓存控制：最大年龄”值为 0，而我的 HTTP 标头中没有“过期”值的原因是因为我只是在 Firefox 中重新加载页面。在开始新的隐私浏览会话（在进程中重置缓存）并首次加载页面时，我收到了预期的标题。 javagoogle-app-engine 4 1 回答 1 This answer is useful 0 我已经回答了我自己的问题：我的“缓存控制：最大年龄”值为 0，而我的 HTTP 标头中没有“过期”值的原因是因为我只是在 Firefox 中重新加载页面。在开始新的隐私浏览会话（在进程中重置缓存）并首次加载页面时，我收到了预期的标题。 于 2013-02-28T16:11:14.157 回答 Related 1 wpf - WPF 绑定字符串格式 2 javascript - jshint 忽略使用 '!==' 与 '' 进行比较 4 matlab - 从字符串中逐个字符读取到数组中 1 objective-c - NSStringFromSize（[self intercellSpacing]）的不兼容类型？ 1 jsf - Spring Web 流和 JSF 模板 4 javascript - 为什么我的 :nth-child(2) 选择器在我的 jQuery 中不起作用？ 1 python - 为什么要运行 setup.py，我可以只嵌入代码吗？ 1 livecycle - 从 adobe livecycle 工作台调用 shell 脚本？ 2 c# - 冻结部分代码以防止格式化 2 css - CSS 选择器性能问题 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</static-files></include...元素<static-files></include...元素<static-files>

> ID：12643040
> 
> 赞同：0
> 
> 时间：
> 
> 标签：java, google-app-engine

我正在使用 Google App Engine Java SDK 1.7.2 来提供一些静态文件。在 appengine-web.xml 中组合多个`<include...`元素`<static-files>`时，我不确定哪些规则将优先。

例如，我有以下内容：

```
<static-files>
  <include path="/**.swf" expiration="365d"></include>
  <include path="/**.jpg" expiration="365d"></include>
  <include path="/**"></include>    
  <exclude path="/**.php"></exclude>
</static-files> 
```

我相信这指定了除了 .php 文件之外的所有内容都应该包含在静态存储中，并且 .swf 和 .jpg 文件应该在未来 365 天设置“缓存控制”和“过期”http 标头。

但是，当使用 Firefox 的 Live HTTP Headers 工具时，我看不到具有长过期时间的静态文件的预期标头：

```
http://localhost:8888/swf/Logo.20120927.swf

GET /swf/Logo.20120927.swf HTTP/1.1
Host: localhost:8888
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:15.0) Gecko/20100101 Firefox/15.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-gb,en-us;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
DNT: 1
Connection: keep-alive
Referer: http://localhost:8888/
If-Modified-Since: Thu, 27 Sep 2012 15:49:03 GMT
Cache-Control: max-age=0

HTTP/1.1 304 Not Modified
Server: Jetty(6.1.x)
----------------------------------------------------------
http://localhost:8888/images/logo-and-buttons.20120927.jpg

GET /images/logo-and-buttons.20120927.jpg HTTP/1.1
Host: localhost:8888
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:15.0) Gecko/20100101 Firefox/15.0.1
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Accept-Language: en-gb,en-us;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
DNT: 1
Connection: keep-alive
Referer: http://localhost:8888/
If-Modified-Since: Thu, 27 Sep 2012 15:49:03 GMT
Cache-Control: max-age=0

HTTP/1.1 304 Not Modified
Server: Jetty(6.1.x) 
```

我的问题是，如果这没有按预期运行，那么如何配置我的`<static-files>`元素以达到预期的效果？

干杯，

杰夫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:11:14.157

我已经回答了我自己的问题：我的“缓存控制：最大年龄”值为 0，而我的 HTTP 标头中没有“过期”值的原因是因为我只是在 Firefox 中重新加载页面。在开始新的隐私浏览会话（在进程中重置缓存）并首次加载页面时，我收到了预期的标题。

# sql - Oracle 虚拟列引用另一个表

> ID：12643041
> 
> 赞同：8
> 
> 时间：2012-09-28T15:34:18.703
> 
> 标签：sql, oracle, oracle11g

我有一个`TABLE1`带有 column的表`COL_TAB1`。

```
select * from TABLE1:
 COL_TAB1
|    1   |
|    2   |
|    3   | 
```

另一个表`TABLE2`包含`COL_TAB2`并引用第一列`COL_TAB1`

```
select * from TABLE2:
 COL_TAB2  |  COL_TAB1
| val1     |     1
| val2     |     2
| val2     |     3 
```

是否可以在 table1 上添加一个虚拟列，这样我会得到与以下查询相同的结果：

```
select 
    t1.COL_TAB1, 
    (select t2.COL_TAB2 from TABLE2 t2 where t2.COL_TAB1 = t1.COL_TAB1)
from TABLE1 t1 
```

我试过了 ：

```
alter table TABLE1 add (
    SOME_COL_NAME as (select t2.COL_TAB2 from TABLE2 t2 where t2.COL_TAB1 = COL_TAB1)
) 
```

但它给了我`ORA-00936: missing expression`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-28T15:40:21.223

Oracle[关于虚拟列的文档](http://www.oracle-base.com/articles/11g/virtual-columns-11gr1.php)非常清楚地说明了这一点，您只能引用同一张表中的列；

> 虚拟列定义中使用的表达式有以下限制：
> 
> *   它不能按名称引用另一个虚拟列。
> *   ***它只能引用同一个表中定义的列。***
> *   如果它引用确定性的用户定义函数，则不能用作分区键列。
> *   表达式的输出必须是标量值。它不能返回 Oracle 提供的数据类型、用户定义的类型或 LOB 或 LONG RAW。

正如@JoeStefanelli 所说，做你想做的最好的选择是[创建一个视图](http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_8004.htm)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T15:40:29.867

[在这种情况下，创建视图](http://docs.oracle.com/cd/E17952_01/refman-5.1-en/create-view.html)可能是您最好的选择。

```
CREATE VIEW vwTable1and2
AS
    SELECT t1.COL_TAB1, t2.COL_TAB2
        FROM TABLE1 t1
            INNER JOIN TABLE2 t2
                ON t1.COL_TAB1 = t2.COL_TAB1 
```

# android - HUD 摄像机的正确视图矩阵是什么？

> ID：12643045
> 
> 赞同：1
> 
> 时间：2012-09-28T15:34:45.450
> 
> 标签：android, opengl-es-2.0, shader, openscenegraph, hud

我在带有 GLES2 的 Android 中使用 OpenSceneGraph。

我有两台摄像机：一台用于场景，另一台用于 HUD。场景摄像机是我的 osgViewer 中的主摄像机。我的麻烦在于HUD的摄像头。我正在尝试将 OSG 几何图形添加到 2D 场景（HUD 摄像头），但似乎无法显示出来。

我正在使用自定义着色器来操纵几何体的位置。据我了解，投影矩阵是正确的，但我认为问题可能出在视图矩阵上，因为我使用的是两个摄像头。我尝试将 HUD 的视图设置为场景的初始视图，但无济于事。如果我在这方面错了，请纠正我。

```
 // New camera for the HUD
   hud_camera = new osg::Camera;

   // Set the camera's view properties
   hud_camera->setProjectionMatrix(
      osg::Matrix::ortho2D(0, 1280, 0, 696));
   hud_camera->setReferenceFrame(osg::Transform::ABSOLUTE_RF);
   hud_camera->setViewMatrix(osg::Matrix::identity());
   hud_camera->setViewport(0, 0, 1280, 696);

   // Clear the depth buffer
   hud_camera->setClearMask(GL_DEPTH_BUFFER_BIT);

   // Draw the subgraph after the main camera view and don't allow this camera
   // to grab evente focurs from the main camera
   hud_camera->setRenderOrder(osg::Camera::POST_RENDER);
   hud_camera->setAllowEventFocus(false);

   osg::Geode *       geode;
   osg::Geometry *    geom;
   osg::Vec3Array *   vertices;
   osg::Program *     program;

   // Create the geode and geometry to hold the crosshair image
   geode = new osg::Geode;
   geom = new osg::Geometry;
   geode->addDrawable(geom);
   hud_camera->addChild(geode);

   // Set the vertices
   vertices = new osg::Vec3Array;
   vertices->push_back(osg::Vec3(0.0, 0.0, 0.0));
   vertices->push_back(osg::Vec3(1.0, 0.0, 0.0));
   vertices->push_back(osg::Vec3(1.0, 0.0, 1.0));
   vertices->push_back(osg::Vec3(0.0, 0.0, 1.0));
   geom->setVertexArray(vertices);

   // set colors
   osg::Vec4Array* colors = new osg::Vec4Array;
   colors->push_back(osg::Vec4(1.0, 0.0, 0.0, 1.0));
   colors->push_back(osg::Vec4(0.0, 1.0, 0.0, 1.0));
   colors->push_back(osg::Vec4(0.0, 0.0, 1.0, 1.0));
   colors->push_back(osg::Vec4(1.0, 0.0, 1.0, 1.0));
   geom->setVertexAttribArray(7, colors);
   geom->setVertexAttribBinding(7, osg::Geometry::BIND_PER_VERTEX);

   // Set primitive set
   geom->addPrimitiveSet(new osg::DrawArrays(GL_QUADS, 0, 4));
   geom->setUseVertexBufferObjects(true);

   // Vertex Shader
   char vertSource[] =
   "attribute vec4 osg_Vertex;\n"
   "attribute vec4 a_col;"
   "uniform mat4 osg_ModelViewProjectionMatrix;\n"
   "uniform mat4 proj_matrix;\n"
   "uniform mat4 view_matrix;\n"
   "varying vec4 v_col;"
   "void main(void)\n"
   "{\n"
   "gl_Position = view_matrix * proj_matrix * osg_Vertex;\n"
   "v_col = a_col;\n"
   "}\n";

   // Fragment shader
   char fragSource[] =
   "precision mediump float;\n"
   "varying vec4 v_col;"
   "void main(void)\n"
   "{\n"
   "gl_FragColor = v_col;\n"
   "}\n";

   // Set the shaders
   program = new osg::Program;
   program->setName("Crosshair Shader");
   program->addShader(new osg::Shader(osg::Shader::VERTEX, vertSource));
   program->addShader(new osg::Shader(osg::Shader::FRAGMENT, fragSource));
   program->addBindAttribLocation("a_col", 7);

   osg::StateSet* state = geode->getOrCreateStateSet();
   state->addUniform(
      new osg::Uniform("proj_matrix", hud_camera->getProjectionMatrix()));
   state->addUniform(
      new osg::Uniform("view_matrix", hud_camera->getViewMatrix());

   // Add the program shaders
   geode->getOrCreateStateSet()->setAttributeAndModes(
      program, osg::StateAttribute::ON );

   // Needs no lighting or any depth for a 2D image
   geode->getOrCreateStateSet()->setMode(GL_LIGHTING, osg::StateAttribute::OFF);
   state->setMode(GL_DEPTH_TEST, osg::StateAttribute::OFF); 
```

之后，我将**hud_camera**作为孩子附加到场景数据中。除了查看场景中的特定点之外，场景相机也没有做任何特别的事情。

我确实知道正在创建几何图形。通过在顶点着色器中使用它：

**gl_Position = osg_ModelViewProjectionMatrx * osg_Vertex**

我可以在场景的左侧看到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:58:44.660

首先，你不应该表演`view * proj * vertex`，应该表演`proj * view * vertex`。

对于一个平视显示器，我认为根本不需要视图矩阵。我的理解是你只想在屏幕上画一个平面四边形？

如果您的投影矩阵映射 (0,0) 到 (1280,696)，那么您可以在这个坐标系中绘制对象（从 (0,0) 到 (640,696) 的四边形将覆盖屏幕的左半部分，等等）。

或者，如果您想在 (0,0) 到 (1,1) 的空间中绘制事物，则只需覆盖投影矩阵即可映​​射该空间。将视图矩阵用于像 HUD 这样简单的东西对我来说没有多大意义。

# android - android BitmapFactory 总是返回 0

> ID：12643046
> 
> 赞同：3
> 
> 时间：2012-09-28T15:34:50.980
> 
> 标签：android, android-image

我正在使用这个广为人知的代码

```
Display display = this.getWindowManager().getDefaultDisplay();
            float dw = display.getWidth();
            float dh = display.getHeight();

            // load image dimensions, not the image itself
            BitmapFactory.Options bmpFactoryOptions = new BitmapFactory.Options();
            bmpFactoryOptions.inJustDecodeBounds = true;
            Bitmap bmp = BitmapFactory.decodeFile(MyApp.getImageFilePath());

            int heightRatio = (int) FloatMath.ceil(bmpFactoryOptions.outHeight / dh);
            int widthRatio = (int) FloatMath.ceil(bmpFactoryOptions.outWidth / dw);

            if ((heightRatio > 1) && (widthRatio > 1))// if true one side of the image is bigger than the screen
            {
                if (heightRatio > widthRatio) {
                    bmpFactoryOptions.inSampleSize = heightRatio;
                } else {
                    bmpFactoryOptions.inSampleSize = widthRatio;
                }
            }
            // decode it for real
            bmpFactoryOptions.inSampleSize = bmpFactoryOptions.inSampleSize;
            bmpFactoryOptions.inPreferredConfig = Bitmap.Config.ARGB_8888; //http://www.curious-creature.org/2010/12/08/bitmap-quality-banding-and-dithering/
            bmpFactoryOptions.inJustDecodeBounds = false;
            bmpFactoryOptions.inDither = true;
            bmp = BitmapFactory.decodeFile(MyApp.getImageFilePath(), bmpFactoryOptions);

            ImageView photo = (ImageView) this.findViewById(R.id.imageView1); 
```

问题是

```
bmpFactoryOptions.outWidth
bmpFactoryOptions.outHeight
bmpFactoryOptions.inSampleSize 
```

永远有价值`0`。我已经在三种不同的设备上对其进行了测试，我做错了什么？

和设置 `bmpFactoryOptions.inSampleSize = bmpFactoryOptions.inSampleSize + 1;`

没有效果

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:41:51.207

与标题所说的相反，您的 BitmapFactory 正在返回一个 Bitmap 就好了。

您从未`bmpFactoryOptions`在此语句中分配您的句柄。所以查询它应该不会产生任何结果。增加它并没有帮助，因为您从未将它初始化为图像的属性。

```
Bitmap bmp = BitmapFactory.decodeFile(MyApp.getImageFilePath()); 
```

改为执行以下操作：

```
Bitmap bmp = BitmapFactory.decodeFile(MyApp.getImageFilePath(), bmpFactoryOptions); 
```

这会将您的 bmpFactoryOptions 附加到您的 bmp。然后您可以查询选项。请注意，您的 BitmapFactory 正在返回一个非常好的位图，只是一个您对其属性没有任何句柄的位图。

# asp.net-mvc - MVC 中的 IoC：如何处理从控制器到模型的服务对象流？

> ID：12643050
> 
> 赞同：1
> 
> 时间：2012-09-28T15:35:13.347
> 
> 标签：asp.net-mvc, asp.net-mvc-3, dependency-injection, inversion-of-control

我正在使用 MVC3 并已实现 IoC 以通过构造函数参数向控制器提供服务/管理器对象。这些反过来可能会传递给模型。

我遇到的问题是到处传递这些对象会很麻烦。

例子：

```
public CartController(
        ICartManager cartManager,
        IProductManager productManager,
        IUpsellManager upsellManager,
        IAccountManager accountManager,
        ... more ...)
    {
        ... store to class variables ...
    }

    public ActionResult Index()
    {
        ...

        CartModel model = new CartModel(
            cartManager, 
            accountManager, 
            upsellManager, 
            productManager, 
            ... );

        return View(model);
    } 
```

并且购物车模型可能具有必须向其传递参数的子模型。如您所见，这一切都变得非常麻烦。如果你有这么多的构造函数参数，我已经准备好了，你的控制器可能做的太多了，但这是一个复杂的页面，并且该站点将包含许多其他复杂的页面。我不想通过这么多东西，但我怎么能不通过它们并保持控制？

我很想在模型中使用 DependencyResolver，但这违背了目的，并且服务定位器是已知的反模式。

如何在不放弃 IoC 好处的情况下避免传递这么多参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:01:06.707

使用依赖倒置的优点是在应用程序中的各种角色之间强制执行明确的职责分离。控制器实际上只对处理 HTTP 请求和 HTTP 响应感兴趣。所有其他逻辑都在其他地方处理，控制器委托给它所依赖的类型来完成这项工作。然后为系统中的每个功能重复此模式。检测未遵循此模式的一种方法是使用`new`运算符创建类型并将依赖项传递给构造函数。这是您正在使用的 IoC 容器的工作。

我建议交换逻辑并让 CartManager 为视图返回一个 CartModel。这可能是特定于视图的某种 DTO。数据如何放入这个对象是 CartManager 的责任。如果它需要使用其他服务，可以将它们注入到它的构造函数中。

```
public CartController : Controller

private ICartManager _cartManager;

public CartController(ICartManager cartManager) {
     _cartManager = cartManager;
}

[HttpGet]
public ActionResult Index(int userId) {
    var model = _cartManager.CreateCart(int userId);
    return View(model);
}

...

public class CartManager : ICartManager {

   IDbService _dbService;

   public CartManager(IDbService dbService){

       _dbService = dbSerivce;
   }

   CartModel CreateCart(int userId) {

      var user = _dbService.FindTheUser(int user);
      var cartModel = new CartModel { userId = userId, Name = user.Name };
      /* other stuff to map up a cartmodel 

      return cartModel;
   }
} 
```

这个想法不仅特定于 IoC 容器的使用，而且也是创建 MVC 应用程序的良好实践。我还发现 Rob Ashton 的这篇[文章](http://codebetter.com/robashton/2011/06/13/finding-a-balance-with-asp-net-mv/)是一个很好的指南。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:47:56.927

您不应该将所有这些服务传递给您的视图。这意味着您的模板现在必须执行操作来调用此数据，这使事情变得复杂（如您所见）。除了不必要的复杂性之外，它还在视图中创建了这些服务的依赖关系，并将视图与这些服务紧密耦合。如果您更改服务，则必须更改所有使用它的视图。

您需要做的第一件事是创建一个包含视图所需的所有数据的 ViewModel。然后，您需要找到一种方法将您的管理器类返回的数据映射到此视图中。您可以在控制器中手动完成，或使用 AutoMapper 之类的工具进行翻译。

另一种选择是重构 ICartManager 以便它返回所有数据（然后您的 CartManager 类将具有其他服务的构造函数注入）或创建一个不同的服务来聚合它们并构造一个可以映射到您的视图模型的对象。

您永远不必传递这些方法。它们应该始终注入到对象中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:09:19.073

我喜欢在这种情况下使用工厂模式，您需要在类 A (CartController) 中实例化类 B (CartModel)，并且 B 中有一堆 A 不需要的依赖项。

```
public CartController(
    ICartModelFactory factory
    ... more ...)
{
    ... store to class variables ...
}

public ActionResult Index()
{
    ...

    CartModel model = factory.GetInstance(
        ... );

    return View(model);
} 
```

# java - 存储相同类型但仍然收到 ArrayStoreException

> ID：12643053
> 
> 赞同：1
> 
> 时间：2012-09-28T15:35:23.773
> 
> 标签：java

我有奇怪的问题。我有三个班。书（抽象）和两个子类（小说、非小说）。我已经创建了一系列书籍参考。该数组可以包含两个子类的对象。我有以下小说类的代码。

```
public class Fiction extends Book{

public Fiction(String title) {
    super(title);

    setPrice();
}

public void setPrice() {

    super.price = 24.99;

} 
```

}

非小说类的“相同”代码

```
public class Nonfiction extends Book{

public Nonfiction(String title) {
    super(title);

    setPrice();
}

public void setPrice() {

    super.price = 37.99;

} 
```

}

这是主程序。

```
import javax.swing.JOptionPane; 
```

公共类主要{

公共静态无效主要（字符串[]参数）{

```
 Book[] book = new Fiction[6];

    for(int i = 0; i<book.length; i++) {

        if(i<4) {
            String title = JOptionPane.showInputDialog("Enter fiction book, no "+i);
            book[i] = new Fiction(title);

        } else {

            String title = JOptionPane.showInputDialog("Enter non fiction book, no "+i);
            book[i] = new Nonfiction(title);

        }

    }

    for(int x = 0; x<book.length; x++) {

        System.out.println("Book named "+book[x].getTitle()+" costs "+book[x].getPrice());

    }

} 
```

}

出于任何原因，我在这条线上得到了 ArrayStoreException ..

```
book[i] = new Nonfiction(title); 
```

但是相同的代码适用于 Fiction 类。我检查了 java 文档，它说当我尝试将不同的对象存储在数组中（如 String 和 Int ）时会引发此异常，但在这种情况下它们都是相同的对象。两个类都是超类的子类，也就是说，它们属于同一类型。我很困惑。请问这里有一点帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:36:36.357

你不能把 a 放在 a`Nonfiction`中`new Fiction[6]`。

您可以将`Fiction`s 数组分配给类型变量`Book[]`（数组协方差）这一事实误导了您。
正如您所发现的那样，这是不可能的，因为 a`Fiction[]`不能被视为`Book[]`. （可变类型不能是协变的）

这是Java中的设计缺陷。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:38:40.500

替换这个： -

```
Book[] book = new Fiction[6]; 
```

和 ： -

```
Book[] book = new Book[6]; 
```

By using first way of declaration, you are actually telling compiler that `Array` will contain object of type `Fiction` and not any other subtype of `Book`

You have confused yourself between: -

```
Book book = new Fiction(); 
```

and

```
 Book[] books = new Fiction[6]; 
```

# c++ - 函数指针的HashMap（类成员函数）

> ID：12643055
> 
> 赞同：0
> 
> 时间：2012-09-28T15:35:29.087
> 
> 标签：c++, hashmap, containers

我必须创建一个非常基本的函数指针哈希映射。我的要求只是在其中添加值，然后根据键获取它。出于某种政治原因，我不能使用任何标准库。我有一个工作正常的代码。但是，如果我想要一个指向我的类成员函数的函数指针，那么这不起作用。任何建议应该在下面的代码中进行修改。

在此 PING 和 REFRESH 是独立的功能。所以这段代码有效。但是如果我将这些函数移动到 HashMap 类，那么它就会失败。

代码： -

```
#include <iostream> 
#include <cstdlib> 
#include <cstring> 
#include <iomanip> 
using namespace std; 
typedef void (*FunctionPtr)(); 

    void ping(){
    cout<<"ping";
}
void refresh(){
    cout<<"refresh";
}

class HashEntry {
private:
    int key;
    FunctionPtr func_ptr1;;
public:
    HashEntry(int key, FunctionPtr fptr) {
        this->key = key;
        this->func_ptr1 = fptr;
    }
    int getKey() {
        return key;
    }
    FunctionPtr getValue() {    
        return this->func_ptr1;
    }
};

const int TABLE_SIZE = 128;
class HashMap {
private:
        HashEntry **table;
public:
        HashMap() {
            table = new HashEntry*[TABLE_SIZE];
            for (int i = 0; i < TABLE_SIZE; i++)
                  table[i] = NULL;
      }

      FunctionPtr get(int key) {
            int hash = (key % TABLE_SIZE);
            while (table[hash] != NULL && table[hash]->getKey() != key)
                  hash = (hash + 1) % TABLE_SIZE;
            if (table[hash] == NULL)
                  return NULL;
            else
                  return table[hash]->getValue();
      }

      void put(int key, FunctionPtr fptr) {
            int hash = (key % TABLE_SIZE);
            while (table[hash] != NULL && table[hash]->getKey() != key)
                  hash = (hash + 1) % TABLE_SIZE;
            if (table[hash] != NULL)
                  delete table[hash];
            table[hash] = new HashEntry(key, fptr);
      }     

      ~HashMap() {
            for (int i = 0; i < TABLE_SIZE; i++)
                  if (table[i] != NULL)
                        delete table[i];
            delete[] table;
      }
};

void main(){
    HashMap* pHashsMap = new HashMap();
    pHashsMap->put(1,ping);
    pHashsMap->put(2,refresh);
    pHashsMap->put(3,ping);
    pHashsMap->put(4,refresh);
    pHashsMap->put(5,ping);
    pHashsMap->put(6,refresh);

    cout<<" Key 1---"<<pHashsMap->get(1)<<endl;
    pHashsMap->get(1)();
    cout<<" Key 5---"<<pHashsMap->get(5)<<endl;
    pHashsMap->get(5)();
    cout<<" Key 3---"<<pHashsMap->get(3)<<endl;
    pHashsMap->get(3)();
    cout<<" Key 6---"<<pHashsMap->get(6)<<endl;
    pHashsMap->get(6)();

    delete pHashsMap;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:50:49.790

smart-alec 的答案是：检查代码`std::bind`，从中学习，然后创建自己的代码（尽管如此，不使用 STL/boost 并不聪明……）。

更简单的答案：你需要创建一个联合类型来保存你的普通函数指针和一个类成员函数指针，然后存储一个 bool 来指示它是否是一个类指针：

```
class funcbind_t
{
    union
    {
        void (*pf)();
        void (SomeClass::*mfp)();
    };

    bool member;

    funcbind_t(void (*_pf)()) : pf(_pf), member(false)
    {
    }

    funcbind_t(void (SomeClass::*_mpf)()) : mpf(_mpf), member(true)
    {
    }

    void operator ()()
    {
        if(member)
            mfp();
        else
            fp();
    }
}; 
```

如您所见，当您开始需要函数的不同参数时，这将变得一团糟。

# javascript - jQuery/Javascript Cookies 和变量返回值 [object Object]

> ID：12643057
> 
> 赞同：3
> 
> 时间：2012-09-28T15:35:39.493
> 
> 标签：javascript, jquery, cookies

我正在尝试使用 jQuery 为站点设置 cookie，仅当用户来自特定站点时。在这种情况下，让我们使用 -http://referrersite.com- 作为他们必须来自的站点，以便创建 cookie 作为示例。cookie 值存储在一个变量中，到目前为止一切正常。

有一个条件语句检查用户是否来自被推荐的站点、cookie 是否已经存在以及 cookie 是否不存在并且用户不是来自被推荐的站点。如果用户来自被引用的站点，则会创建 cookie 并将其存储在变量中。如果 cookie 已经存在，则将其存储在变量中。如果 cookie 不存在并且用户不是来自所引用的站点，我将为变量分配一个静态字符串 - 这就是问题所在。

当变量从非引用站点发出警报并且没有现有 cookie 时，它​​返回：[object Object]，而不是静态字符串。

我正在使用的代码如下：

```
$(document).ready(function() {

    var referrer = document.referrer;

    if(referrer == "http://referrersite.com") {

        $.cookie("code","123456", { expires: 90, path: '/' });
        cookieContainer = $.cookie("code");
        alert(cookieContainer);

    } else if($.cookie("code")) {

        cookieContainer = $.cookie("code");
        alert(cookieContainer);

    } else if($.cookie("code") == null && referrer != "http://referrersite.com") {

        cookieContainer = "67890";
        alert(cookieContainer);

    }

}); 
```

总之，我的目标是如果用户不是来自被推荐的站点并且不存在，则`cookieContainer`使用字符串进行设置。由于某种原因，它包含一个对象。`"67890"``$.cookie("code")`

请让我知道我是否缺少某些东西，因为我的代码看起来应该可以工作。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:26:56.667

`[Object Object]`简而言之，意味着 cookie 中的数据不是字符串，也不完全是。cookie 中的数据可能更类似于 JSON 字符串/对象的数据。并提醒它，将其打印在屏幕上，或者从长远来看，无论您试图做什么，您都必须对对象进行循环并将其全部打印出来..或者如果您知道哪个属性你想要具体，你将不得不具体调用它。

例如：

```
if(cookieContainer.property_name_whatever)
{
    alert(cookieContainer.property_name_whatever);
} 
```

要找出单个属性，我会说您使用 javascript 最简单的选择是使用 Firefox，安装`Firebug` [http://getfirebug.com/](http://getfirebug.com/)，并在您的代码中而不是`alert(cookieContainer)`do `console.log(cookieContainer)`。使用 firebug 启用控制台后，这将读取整个对象并基于每个属性 => 值显示数据。

某些东西不是您要查找的 cookie 时存在的原因是该网站上的人可能来自另一个网站或搜索引擎。在使用`document.referrer`任何 url 登陆到您的页面时，即使内部结构也可以并且很可能会被视为引荐来源网址，但它最终取决于浏览器本身，尽管所有主要浏览器都支持它，但它们在不同程度上都对其进行了不同的处理。我不会声称完全理解那个特定的对象，因为我自己不经常使用它。但是引用W3

> 定义和使用
> 
> referrer 属性返回加载当前文档的文档的 URL。

提到的 URL 甚至可能是您在同一个站点上通过页面上的链接在页面之间来回跳转（不确定这是否适用于重新加载/刷新，但我想可以）

# .htaccess - 将一个文件夹中的所有请求重写到父文件夹 htaccess

> ID：12643060
> 
> 赞同：0
> 
> 时间：2012-09-28T15:35:53.227
> 
> 标签：.htaccess, mod-rewrite

这让我很困惑，我需要将所有对 javascript 文件夹 (js) 的请求重新写入一个特殊的库处理程序系统。

例如

```
rewrite http://localhost/admin/js/bar.js  --> http://localhost/_lib/=admin/js/bar.js 
```

有任何想法吗？我尝试了以下会产生错误的方法

```
RewriteCond %{REQUEST_URI} ^(.*)$
RewriteRule ^(.*)$ /%1/_lib/$1 [NC]

(36)File name to long: cannot map GET /admin/js/bar.js to file 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:30:07.643

尝试：

```
RewriteRule ^/?admin/js/(.*).js$ /_lib/=admin/js/$1.js [L] 
```

# javascript - jQuery Deferred - 向 Deferred 合约添加回调

> ID：12643065
> 
> 赞同：2
> 
> 时间：2012-09-28T15:36:21.660
> 
> 标签：javascript, jquery, jquery-deferred

我正在尝试在其状态设置为成功之前向现有 Deferred 的合同添加另一个异步调用。与其尝试用英语解释这一点，不如看下面的伪代码：

```
$.when(
    $.ajax({        
        url: someUrl,
        data: data,
        async: true,        
        success: function (data, textStatus, jqXhr) {
            console.log('Call 1 done.')
            jqXhr.pipe(
                $.ajax({        
                    url: someUrl,
                    data: data,
                    async: true,        
                    success: function (data, textStatus, jqXhr) {
                        console.log('Call 2 done.');
                    },       
                })
            );
        },       
    }),
    $.ajax({        
        url: someUrl,
        data: data,
        async: true,        
        success: function (data, textStatus, jqXhr) {
            console.log('Call 3 done.');
        },       
    })
).then(function(){ console.log('All done!'); }); 
```

基本上，调用 2 取决于调用 1 的结果。我希望调用 1 和调用 3 并行执行。完成所有 3 个调用后，我希望执行 All Done 代码。我的理解是，`Deferred.pipe()`应该将另一个异步调用链接到给定的延迟，但实际上，我总是在 All Done 之后完成 Call 2。

有谁知道如何让 jQuery 的 Deferred 做我想做的事？希望该解决方案不涉及将代码进一步撕成块。

谢谢你的帮助。

更新：请参阅我的[后续问题](https://stackoverflow.com/questions/12644372/jquery-deferred-add-callbacks-to-the-deferred-contract-at-runtime)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:39:01.723

您必须调用`.pipe`第一次调用返回的延迟对象`$.ajax`，而不是在其成功回调中（这根本没有任何效果）：

```
$.when(
    $.ajax({        
        // ...      
    }).pipe(function() {
        // return a deferred object from .pipe
        return $.ajax({        
            // ...      
        });
    }),
    $.ajax({        
        // ...       
    })
).done(function(){ console.log('All done!'); }); 
```

`.pipe`返回一个新的延迟对象，该对象仅在原始延迟对象和返回的对象都被解决后才被解决。

# iphone - 从 URL 实时流式传输音频的 RadioKit 替代方案

> ID：12643067
> 
> 赞同：0
> 
> 时间：2012-09-28T15:36:31.283
> 
> 标签：iphone, xcode, ipad, audio, audio-streaming

我正在阅读[RadioKit](http://www.stormyprods.com/products/radiokit.php)

我喜欢他们使用的东西，它适用于我的 ShoutCast 流，但它的价格比我每个应用程序真正能做的要高（99 美元）。有没有什么好的教程可以从 URL 播放器中设置一个简单的流，可以暂停、倒带和显示当前在流上播放的文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T10:01:13.387

看看这个网站..

[http://www.cocoawithlove.com/2009/06/revisiting-old-post-streaming-and.html](http://www.cocoawithlove.com/2009/06/revisiting-old-post-streaming-and.html)

它有点旧，但它至少应该让你起床并开始

# ios - 使用 glReadPixels 时出现内存不足警告

> ID：12643069
> 
> 赞同：0
> 
> 时间：2012-09-28T15:36:43.487
> 
> 标签：ios, opengl-es

我正在将 OpenGL 场景渲染到纹理并尝试将渲染结果保存到 UIImage，然后将其保存到相机胶卷中。

我正在使用[Apple 的方法](http://developer.apple.com/library/ios/#qa/qa1704/_index.html)从这个纹理创建一个 UIImage。这工作正常，但在执行此代码时会占用大量内存。

当我的应用程序运行和渲染时，它使用大约 1MB 的内存空间。当该`glReadPixels`方法启动时，内存使用量跃升至 32 MB，我收到内存警告。当`glReadPixels`准备好执行时，我的内存回落到 1MB。

有没有更好的方法来读取像素？我试图保持与 iOS5 之前的 IOS 版本的兼容性，所以我目前没有使用[这里](https://stackoverflow.com/questions/9550297/faster-alternative-to-glreadpixels-in-iphone-opengl-es-2-0/9704392#9704392)提到的纹理缓存方法。

# mysql - 将子字符串更改为大写

> ID：12643071
> 
> 赞同：0
> 
> 时间：2012-09-28T15:36:49.257
> 
> 标签：mysql

我有这个查询来通过 > 选择子字符串的一部分。

```
SELECT SUBSTRING_INDEX(translation, '>', 1) FROM categorias 
```

我想要的是将子字符串更新为大写。

但是这个查询有一个 sintax 错误

```
UPDATE A.translation
SET A.translation = UPPER(SELECT SUBSTRING_INDEX(A.translation, '>', 1))
FROM categorias as A 
```

有什么帮助吗？

数据示例：

```
Raw Materials & Chemicals > Rubber & Elastomers 
```

应该更新为

```
RAW MATERIALS & CHEMICALS > Rubber & Elastomers 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:38:55.553

我相信您可以删除内部`SELECT`，并且可以将`UPDATE`语法稍微更改为以下内容：

```
UPDATE categorias
SET translation = UPPER(SUBSTRING_INDEX(translation, '>', 1)) 
```

根据您的评论，我认为您需要以下内容：

```
 UPDATE categorias
 SET translation 
  = CONCAT(
          UPPER(SUBSTRING_INDEX(translation, '>', 1)),
          SUBSTRING(translation, INSTR(translation, '>'))); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/d5635/2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T15:38:49.290

`UPDATE`引用表，而不是您正在更新的列，例如：

```
UPDATE categorias 
SET translation = UPPER(SUBSTRING_INDEX(translation, '>', 1)) 
```

另请注意，您不需要使用`SELECT`字符串函数，它们会在没有它的情况下返回结果。

# ruby-on-rails - 检测现有 ActiveRecord 关联的更改

> ID：12643077
> 
> 赞同：0
> 
> 时间：2012-09-28T15:37:17.620
> 
> 标签：ruby-on-rails, ruby, activerecord

我正在编写一个 ActiveRecord 扩展，它需要知道何时修改关联。我知道通常我可以使用 :after_add 和 :after_remove 回调，但是如果关联已经声明了怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T16:48:03.883

您可以简单地覆盖关联的设置器。这也将让您更自由地了解更改，例如在更改之前和之后拥有 assoc 对象。

```
class User < ActiveRecord::Base
  has_many :articles

  def articles= new_array
    old_array = self.articles
    super new_array
    # here you also could compare both arrays to find out about what changed
    # e.g. old_array - new_array would yield articles which have been removed
    #   or new_array - old_array would give you the articles added 
  end
end 
```

这也适用于批量分配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T19:37:58.573

正如您所说，您可以使用`after_add`和`after_remove`回调。另外`after_commit`为关联模型设置过滤器并通知“父”有关更改。

```
class User < ActiveRecord::Base
  has_many :articles, :after_add => :read, :after_remove => :read     

  def read(article)
    # ;-)
  end
end 

class Article < ActiveRecord::Base
  belongs_to :user

  after_commit { user.read(self) }
end 
```

# python - 使用 SciPy 进行贝塞尔曲线拟合

> ID：12643079
> 
> 赞同：28
> 
> 时间：2012-09-28T15:37:25.530
> 
> 标签：python, scipy

我有一组近似二维曲线的点。我想将 Python 与 numpy 和 scipy 一起使用来找到一个近似拟合点的三次贝塞尔路径，我在其中指定两个端点的确切坐标，并返回其他两个控制点的坐标。

我最初认为`scipy.interpolate.splprep()`可能会做我想做的事，但它似乎迫使曲线通过每个数据点（我想你会想要插值）。我会假设我在错误的轨道上。

我的问题与此类似：[如何将贝塞尔曲线拟合到一组数据？](https://stackoverflow.com/questions/6299019/how-can-i-fit-a-bezier-curve-to-a-set-of-data)，除了他们说他们不想使用 numpy. 我的偏好是在 scipy 或 numpy 的某个地方找到我需要的东西。否则，我计划使用 numpy：[一种用于自动拟合数字化曲线的算法](http://inis.jinr.ru/sl/vol1/CMC/Graphics_Gems_1,ed_A.Glassner.pdf)（pdf.page 622）来实现与该问题的答案之一相关联的算法。

感谢您的任何建议！

编辑：我知道三次贝塞尔曲线不能保证通过所有点；我想要一个通过两个给定端点，并且尽可能靠近指定内部点的端点。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-28T17:14:47.720

这是一种用 numpy 做贝塞尔曲线的方法：

```
import numpy as np
from scipy.special import comb

def bernstein_poly(i, n, t):
    """
     The Bernstein polynomial of n, i as a function of t
    """

    return comb(n, i) * ( t**(n-i) ) * (1 - t)**i

def bezier_curve(points, nTimes=1000):
    """
       Given a set of control points, return the
       bezier curve defined by the control points.

       points should be a list of lists, or list of tuples
       such as [ [1,1], 
                 [2,3], 
                 [4,5], ..[Xn, Yn] ]
        nTimes is the number of time steps, defaults to 1000

        See http://processingjs.nihongoresources.com/bezierinfo/
    """

    nPoints = len(points)
    xPoints = np.array([p[0] for p in points])
    yPoints = np.array([p[1] for p in points])

    t = np.linspace(0.0, 1.0, nTimes)

    polynomial_array = np.array([ bernstein_poly(i, nPoints-1, t) for i in range(0, nPoints)   ])

    xvals = np.dot(xPoints, polynomial_array)
    yvals = np.dot(yPoints, polynomial_array)

    return xvals, yvals

if __name__ == "__main__":
    from matplotlib import pyplot as plt

    nPoints = 4
    points = np.random.rand(nPoints,2)*200
    xpoints = [p[0] for p in points]
    ypoints = [p[1] for p in points]

    xvals, yvals = bezier_curve(points, nTimes=1000)
    plt.plot(xvals, yvals)
    plt.plot(xpoints, ypoints, "ro")
    for nr in range(len(points)):
        plt.text(points[nr][0], points[nr][1], nr)

    plt.show() 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-02T16:48:55.540

这是一段用于拟合点的python代码：

```
'''least square qbezier fit using penrose pseudoinverse
    >>> V=array
    >>> E,  W,  N,  S =  V((1,0)), V((-1,0)), V((0,1)), V((0,-1))
    >>> cw = 100
    >>> ch = 300
    >>> cpb = V((0, 0))
    >>> cpe = V((cw, 0))
    >>> xys=[cpb,cpb+ch*N+E*cw/8,cpe+ch*N+E*cw/8, cpe]            
    >>> 
    >>> ts = V(range(11), dtype='float')/10
    >>> M = bezierM (ts)
    >>> points = M*xys #produces the points on the bezier curve at t in ts
    >>> 
    >>> control_points=lsqfit(points, M)
    >>> linalg.norm(control_points-xys)<10e-5
    True
    >>> control_points.tolist()[1]
    [12.500000000000037, 300.00000000000017]

'''
from numpy import array, linalg, matrix
from scipy.misc import comb as nOk
Mtk = lambda n, t, k: t**(k)*(1-t)**(n-k)*nOk(n,k)
bezierM = lambda ts: matrix([[Mtk(3,t,k) for k in range(4)] for t in ts])
def lsqfit(points,M):
    M_ = linalg.pinv(M)
    return M_ * points 
```

通常在贝塞尔曲线上查看 [动画](http://www.jasondavies.com/animated-bezier/)贝塞尔曲线和 [贝塞尔曲线](https://pomax.github.io/bezierinfo)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-07-15T20:07:51.953

@keynesiancross 要求“在 [Roland 的] 代码中对变量是什么进行评论”，而其他人则完全错过了所述问题。Roland 以 Bézier 曲线作为输入（以获得完美匹配）开始，这使得理解问题和（至少对我而言）解决方案都变得更加困难。对于留下残差的输入，与插值的区别更容易看出。这是释义的代码和非贝塞尔输入——以及一个意想不到的结果。

```
import matplotlib.pyplot as plt
import numpy as np
from scipy.special import comb as n_over_k
Mtk = lambda n, t, k: t**k * (1-t)**(n-k) * n_over_k(n,k)
BézierCoeff = lambda ts: [[Mtk(3,t,k) for k in range(4)] for t in ts]

fcn = np.log
tPlot = np.linspace(0\. ,1\. , 81)
xPlot = np.linspace(0.1,2.5, 81)
tData = tPlot[0:81:10]
xData = xPlot[0:81:10]
data = np.column_stack((xData, fcn(xData))) # shapes (9,2)

Pseudoinverse = np.linalg.pinv(BézierCoeff(tData)) # (9,4) -> (4,9)
control_points = Pseudoinverse.dot(data)     # (4,9)*(9,2) -> (4,2)
Bézier = np.array(BézierCoeff(tPlot)).dot(control_points)
residuum = fcn(Bézier[:,0]) - Bézier[:,1]

fig, ax = plt.subplots()
ax.plot(xPlot, fcn(xPlot),   'r-')
ax.plot(xData, data[:,1],    'ro', label='input')
ax.plot(Bézier[:,0],
        Bézier[:,1],         'k-', label='fit')
ax.plot(xPlot, 10.*residuum, 'b-', label='10*residuum')
ax.plot(control_points[:,0],
        control_points[:,1], 'ko:', fillstyle='none')
ax.legend()
fig.show() 
```

这适用于`fcn = np.cos`但不适用于`log`. 我有点期望拟合会使用控制点的 t 分量作为额外的自由度，就像我们通过拖动控制点所做的那样：

```
manual_points = np.array([[0.1,np.log(.1)],[.27,-.6],[.82,.23],[2.5,np.log(2.5)]])
Bézier = np.array(BézierCoeff(tPlot)).dot(manual_points)
residuum = fcn(Bézier[:,0]) - Bézier[:,1]

fig, ax = plt.subplots()
ax.plot(xPlot, fcn(xPlot),   'r-')
ax.plot(xData, data[:,1],    'ro', label='input')
ax.plot(Bézier[:,0],
        Bézier[:,1],         'k-', label='fit')
ax.plot(xPlot, 10.*residuum, 'b-', label='10*residuum')
ax.plot(manual_points[:,0],
        manual_points[:,1],  'ko:', fillstyle='none')
ax.legend()
fig.show() 
```

我猜失败的原因是范数测量曲线上点之间的距离，而不是一条曲线上的点与另一条曲线上最近点之间的距离。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2021-10-04T15:01:17.850

[结果图](https://i.stack.imgur.com/HldDZ.png)

基于@reptilicus 和@Guillaume P. 的答案，下面是完整的代码：

*   从点列表中获取贝塞尔参数，即控制点。
*   从贝塞尔参数（即控制点）创建贝塞尔曲线。
*   绘制原始点、控制点和生成的贝塞尔曲线。

获取贝塞尔参数，即来自一组 X、Y 点或坐标的控制点。需要的另一个参数是近似的度数，得到的控制点将是（度数 + 1）

```
import numpy as np
from scipy.special import comb

def get_bezier_parameters(X, Y, degree=3):
    """ Least square qbezier fit using penrose pseudoinverse.

    Parameters:

    X: array of x data.
    Y: array of y data. Y[0] is the y point for X[0].
    degree: degree of the Bézier curve. 2 for quadratic, 3 for cubic.

    Based on https://stackoverflow.com/questions/12643079/b%C3%A9zier-curve-fitting-with-scipy
    and probably on the 1998 thesis by Tim Andrew Pastva, "Bézier Curve Fitting".
    """
    if degree < 1:
        raise ValueError('degree must be 1 or greater.')

    if len(X) != len(Y):
        raise ValueError('X and Y must be of the same length.')

    if len(X) < degree + 1:
        raise ValueError(f'There must be at least {degree + 1} points to '
                         f'determine the parameters of a degree {degree} curve. '
                         f'Got only {len(X)} points.')

    def bpoly(n, t, k):
        """ Bernstein polynomial when a = 0 and b = 1\. """
        return t ** k * (1 - t) ** (n - k) * comb(n, k)
        #return comb(n, i) * ( t**(n-i) ) * (1 - t)**i

    def bmatrix(T):
        """ Bernstein matrix for Bézier curves. """
        return np.matrix([[bpoly(degree, t, k) for k in range(degree + 1)] for t in T])

    def least_square_fit(points, M):
        M_ = np.linalg.pinv(M)
        return M_ * points

    T = np.linspace(0, 1, len(X))
    M = bmatrix(T)
    points = np.array(list(zip(X, Y)))

    final = least_square_fit(points, M).tolist()
    final[0] = [X[0], Y[0]]
    final[len(final)-1] = [X[len(X)-1], Y[len(Y)-1]]
    return final 
```

给定贝塞尔参数，即控制点，创建贝塞尔曲线。

```
def bernstein_poly(i, n, t):
    """
     The Bernstein polynomial of n, i as a function of t
    """
    return comb(n, i) * ( t**(n-i) ) * (1 - t)**i

def bezier_curve(points, nTimes=50):
    """
       Given a set of control points, return the
       bezier curve defined by the control points.

       points should be a list of lists, or list of tuples
       such as [ [1,1], 
                 [2,3], 
                 [4,5], ..[Xn, Yn] ]
        nTimes is the number of time steps, defaults to 1000

        See http://processingjs.nihongoresources.com/bezierinfo/
    """

    nPoints = len(points)
    xPoints = np.array([p[0] for p in points])
    yPoints = np.array([p[1] for p in points])

    t = np.linspace(0.0, 1.0, nTimes)

    polynomial_array = np.array([ bernstein_poly(i, nPoints-1, t) for i in range(0, nPoints)   ])

    xvals = np.dot(xPoints, polynomial_array)
    yvals = np.dot(yPoints, polynomial_array)

    return xvals, yvals 
```

使用的样本数据（可以替换为任何数据，这是 GPS 数据）。

```
points = []
xpoints = [19.21270, 19.21269, 19.21268, 19.21266, 19.21264, 19.21263, 19.21261, 19.21261, 19.21264, 19.21268,19.21274, 19.21282, 19.21290, 19.21299, 19.21307, 19.21316, 19.21324, 19.21333, 19.21342]
ypoints = [-100.14895, -100.14885, -100.14875, -100.14865, -100.14855, -100.14847, -100.14840, -100.14832, -100.14827, -100.14823, -100.14818, -100.14818, -100.14818, -100.14818, -100.14819, -100.14819, -100.14819, -100.14820, -100.14820]
for i in range(len(xpoints)):
    points.append([xpoints[i],ypoints[i]]) 
```

绘制原始点、控制点和生成的贝塞尔曲线。

```
import matplotlib.pyplot as plt
# Plot the original points
plt.plot(xpoints, ypoints, "ro",label='Original Points')
# Get the Bezier parameters based on a degree.
data = get_bezier_parameters(xpoints, ypoints, degree=4)
x_val = [x[0] for x in data]
y_val = [x[1] for x in data]
print(data)
# Plot the control points
plt.plot(x_val,y_val,'k--o', label='Control Points')
# Plot the resulting Bezier curve
xvals, yvals = bezier_curve(data, nTimes=1000)
plt.plot(xvals, yvals, 'b-', label='B Curve')
plt.legend()
plt.show() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-09T11:19:34.020

简短的回答：你不知道，因为这不是贝塞尔曲线的工作方式。更长的答案：看看 Catmull-Rom 样条曲线。它们很容易形成（除起点和终点外，任何点 P 的切向量都平行于线 {P-1,P+1}，因此它们也很容易编程）并且总是通过定义它们的点，与贝塞尔曲线不同，贝塞尔曲线在所有控制点设置的凸包内“某处”内插。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-28T15:47:36.883

贝塞尔曲线不能保证通过您提供的每个点。控制点是任意的（从某种意义上说，没有特定的算法可以找到它们，您只需自己选择它们）并且只会将曲线*拉*向一个方向。

如果你想要一条穿过你提供给它的每个点的曲线，你需要一个像自然三次样条这样的东西，并且由于这些限制（你必须为它们提供增加的 x 坐标，否则它趋于无穷大） ，您可能需要一个参数化的自然三次样条曲线。

这里有很好的教程：

[三次样条](http://www.vbforums.com/showthread.php?480806-Cubic-Spline-Tutorial)

[参数三次样条](http://www.vbforums.com/showthread.php?481546-Parametric-Cubic-Spline-Tutorial)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-05T23:43:23.690

我遇到了与问题中详述的问题相同的问题。我使用了 Roland Puntaier 提供的代码，并且能够使其工作。这里：

```
def get_bezier_parameters(X, Y, degree=2):
    """ Least square qbezier fit using penrose pseudoinverse.

    Parameters:

    X: array of x data.
    Y: array of y data. Y[0] is the y point for X[0].
    degree: degree of the Bézier curve. 2 for quadratic, 3 for cubic.

    Based on https://stackoverflow.com/questions/12643079/b%C3%A9zier-curve-fitting-with-scipy
    and probably on the 1998 thesis by Tim Andrew Pastva, "Bézier Curve Fitting".
    """
    if degree < 1:
        raise ValueError('degree must be 1 or greater.')

    if len(X) != len(Y):
        raise ValueError('X and Y must be of the same length.')

    if len(X) < degree + 1:
        raise ValueError(f'There must be at least {degree + 1} points to '
                         f'determine the parameters of a degree {degree} curve. '
                         f'Got only {len(X)} points.')

    def bpoly(n, t, k):
        """ Bernstein polynomial when a = 0 and b = 1\. """
        return t ** k * (1 - t) ** (n - k) * comb(n, k)

    def bmatrix(T):
        """ Bernstein matrix for Bézier curves. """
        return np.matrix([[bpoly(degree, t, k) for k in range(degree + 1)] for t in T])

    def least_square_fit(points, M):
        M_ = np.linalg.pinv(M)
        return M_ * points

    T = np.linspace(0, 1, len(X))
    M = bmatrix(T)
    points = np.array(list(zip(X, Y)))
    return least_square_fit(points, M).tolist() 
```

要修复曲线的端点，请忽略函数返回的第一个和最后一个参数并使用您自己的点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-12T22:39:22.250

Mike Kamermans 说的是真的，但我还想指出，据我所知，catmull-rom 样条可以用三次贝塞尔曲线来定义。所以，如果你只有一个可以处理三次的库，你应该仍然可以做 catmull-rom 样条：

*   [http://schepers.cc/getting-to-the-point](http://schepers.cc/getting-to-the-point)
*   [https://github.com/DmitryBaranovskiy/raphael/blob/master/dev/raphael.core.js#L1038](https://github.com/DmitryBaranovskiy/raphael/blob/master/dev/raphael.core.js#L1038)

# android - Android：空指针异常运行时错误

> ID：12643080
> 
> 赞同：0
> 
> 时间：2012-09-28T15:37:33.747
> 
> 标签：android, nullpointerexception

在我尝试包含一个菜单、一个对话框和一个弹出框后，我开始在启动时收到 NullPointerException。我试图注释掉部分代码，只有当我注释类变量和 onCreate 方法下面的所有内容时，程序才有效。我将不胜感激帮助找出导致异常的原因。

```
package com.emailandcontactmanager;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.PopupWindow;

public class MainActivity extends Activity{

EditText title = (EditText) findViewById(R.id.txtTitle);
EditText body = (EditText) findViewById(R.id.txtBody);
View layout = (View) findViewById(R.layout.main);

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button btnSendMenu = (Button) findViewById(R.id.btnSendMenu);
    btnSendMenu.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        Intent sendMenu = new Intent(v.getContext(), SendMenu.class);
        startActivity(sendMenu);
    }
    });

    Button btnContactsMenu = (Button) findViewById(R.id.btnContactsMenu);
    btnContactsMenu.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        Intent contactsMenu = new Intent(v.getContext(), ContactsMenu.class);
        startActivity(contactsMenu);
    }
    });        

    Button btnTemplatesMenu = (Button) findViewById(R.id.btnTemplatesMenu);
    btnTemplatesMenu.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        Intent templatesMenu = new Intent(v.getContext(), TemplatesMenu.class);
        startActivity(templatesMenu);
    }
    });

    Button btnTagsMenu = (Button) findViewById(R.id.btnTagsMenu);
    btnTagsMenu.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        Intent tagsMenu = new Intent(v.getContext(), TagsMenu.class);
        startActivity(tagsMenu);
    }
    });

}//end onCreate

DialogInterface.OnClickListener dialogClickListener = new DialogInterface.OnClickListener() { 
    public void onClick(DialogInterface dialog, int which) { 
        switch (which){ 
        case DialogInterface.BUTTON_POSITIVE: 
            finish();
            break; 

        case DialogInterface.BUTTON_NEGATIVE: 
            //No button clicked 
            break; 
        } 
    } 
}; 

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case R.id.help:     showPopup(this);
                            break;

        case R.id.back:     AlertDialog.Builder builder = new AlertDialog.Builder(this); 
                            builder.setMessage("Are you     sure?").setPositiveButton("Yes", dialogClickListener) 
                            .setNegativeButton("No", dialogClickListener).show(); 
                            break;
    }
    return true;
}

private void showPopup(final Activity context){
    int popupWidth = 200;
    int popupHeight = 150;

    // change title and body based on button
    onHelpClick(layout);

    LinearLayout viewGroup = (LinearLayout) this.findViewById(R.id.popup);
    LayoutInflater layoutInfalter = (LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View layout = layoutInfalter.inflate(R.layout.popup, viewGroup);

    final PopupWindow popup = new PopupWindow();
    popup.setContentView(layout);
    popup.setWidth(popupWidth);
    popup.setHeight(popupHeight);
    popup.setFocusable(true);

    Button close = (Button) layout.findViewById(R.id.close);
            close.setOnClickListener(new OnClickListener() {

                public void onClick(View arg0) {
                    // TODO Auto-generated method stub
                    popup.dismiss();
                }
            });

}

private void onHelpClick(View v) {

    switch(v.getId())
    {
    case R.id.btnSendMenu:
        title.setText("Send Menu");
        body.setText("Opens the send menu where you can send an email.");
        break;
    case R.id.btnContactsMenu:
        title.setText("Contacts Menu");
        body.setText("Opens the contact menu where you can add a contact or select from a list of" +
                "recored contacts to edit or view.");
        break;
    case R.id.btnTemplatesMenu:
        title.setText("Templates Menu");
        body.setText("Opens the templates menu where you can add an email template or select from a list of" +
        " recorded templates to edit or view.");
        break;
    case R.id.btnTagsMenu:
        title.setText("Tags Menu");
        body.setText("Opens the tags menu where you can add a tag used for sorting contacs, or select from a list of" +
        " recorded tags to edit or view.");
        break;
    default:
        throw new RuntimeException("Unknown button ID");
    }

}

}//end Class 
```

logcat 消息是：

```
09-28 15:07:49.205: D/AndroidRuntime(1403): Shutting down VM
09-28 15:07:49.245: W/dalvikvm(1403): threadid=1: thread exiting with uncaught exception (group=0x409961f8)
09-28 15:07:49.365: E/AndroidRuntime(1403): FATAL EXCEPTION: main
09-28 15:07:49.365: E/AndroidRuntime(1403): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.emailandcontactmanager/com.emailandcontactmanager.MainActivity}: java.lang.NullPointerException
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1879)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.app.ActivityThread.access$600(ActivityThread.java:122)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.os.Looper.loop(Looper.java:137)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.app.ActivityThread.main(ActivityThread.java:4340)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at java.lang.reflect.Method.invokeNative(Native Method)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at java.lang.reflect.Method.invoke(Method.java:511)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at dalvik.system.NativeStart.main(Native Method)
09-28 15:07:49.365: E/AndroidRuntime(1403): Caused by: java.lang.NullPointerException
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.app.Activity.findViewById(Activity.java:1794)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at com.emailandcontactmanager.MainActivity.<init>(MainActivity.java:24)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at java.lang.Class.newInstanceImpl(Native Method)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at java.lang.Class.newInstance(Class.java:1319)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
09-28 15:07:49.365: E/AndroidRuntime(1403):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1870)
09-28 15:07:49.365: E/AndroidRuntime(1403):     ... 11 more 
```

告诉我您是否需要其他东西，例如 xml 文件代码或类似的东西。我很感激任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T15:43:12.843

问题是您试图`findViewById`在 Activity 的布局膨胀之前找到视图。在有关活动的 Android 开发者文档中阅读有关活动生命周期的更多[信息](http://developer.android.com/reference/android/app/Activity.html)。

改为这样做：

```
public class MainActivity extends Activity{

    private EditText title;
    private EditText body;
    private View layout;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        title = (EditText) findViewById(R.id.txtTitle);
        body = (EditText) findViewById(R.id.txtBody);
        // also , the line below is incorrect, the findViewById method requires
        // that you use an id(R.id.somthing) and not a layout resource like you do
        layout = (View) findViewById(R.layout.main);

        // Rest of your code. 
```

# asp.net-mvc-3 - 编辑模型 - 复杂类型未正确更新

> ID：12643081
> 
> 赞同：1
> 
> 时间：2012-09-28T15:37:46.863
> 
> 标签：asp.net-mvc-3, entity-framework-4, model-binding

我有这两个对象 - 杂志和作者（MM 关系）：

```
public partial class MAGAZINE
    {
        public MAGAZINE()
        {
            this.AUTHORs = new HashSet<AUTHOR>();
        }

        public long REF_ID { get; set; }
        public string NOTES { get; set; }
        public string TITLE { get; set; }

        public virtual REFERENCE REFERENCE { get; set; }
        public virtual ICollection<AUTHOR> AUTHORs { get; set; }
    }

public partial class AUTHOR
{
    public AUTHOR()
    {  
         this.MAGAZINEs = new HashSet<MAGAZINE>();
    }

            public long AUTHOR_ID { get; set; }
            public string FULL_NAME { get; set; }

            public virtual ICollection<MAGAZINE> MAGAZINEs { get; set; }
        }
} 
```

我的问题是我似乎无法根据杂志更新作者的数量，例如，如果我有 1 位作者名为“Smith, P”。已经存储在一本杂志上，我可以添加另一个名为“Jones, D.”的文章，但在发回编辑控制器后，作者的数量仍然显示为 1 - 即“Smith, PH”。

请不要说我已经成功地将作者的数量绑定回父实体（杂志），它使用自定义模型绑定器来检索作者并绑定到杂志（我认为），但它似乎仍然没有更新适当地。

我更新模型的代码很简单 - 并显示之前和之后的变量值：

```
public ActionResult Edit(long id)
    {
        MAGAZINE magazine = db.MAGAZINEs.Find(id);
        return View(magazine);
    } 
```

*这里是变量预编辑/更新 -*

![在此处输入图像描述](../Images/4763c3ad19f26b4ac62e949a19d80fee.png)

```
[HttpPost]
public ActionResult Edit(MAGAZINE magazine)
   {
       if (ModelState.IsValid)
       {
           db.Entry(magazine).State = EntityState.Modified;
           db.SaveChanges();
           return RedirectToAction("Index");
       }

       return View(magazine);
   } 
```

*...这是添加新作者后的变量...*

我开始怀疑作者实体正在显示，编辑后它没有绑定到任何杂志，我猜这就是为什么它没有被更新回杂志实体 - 但它令人困惑，因为我正在有效地处理同一杂志实体 - 我想这可能与作者的自定义模型活页夹有关。

任何人都可以帮助解决这个问题吗？

为了完整性-我也包含了我的 AuthorModelBinder 类-

```
public class AuthorModelBinder : IModelBinder
    {
        public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
        {
            var values = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);
            if (values != null)
            {
                // We have specified asterisk (*) as a token delimiter. So
                // the ids will be separated by *. For example "2*3*5"
                var ids = values.AttemptedValue.Split('*');

                List<int> validIds = new List<int>();
                foreach (string id in ids)
                {
                    int successInt;
                    if (int.TryParse(id, out successInt))
                    {
                        validIds.Add(successInt);
                    }
                    else
                    {
                        //Make a new author
                        AUTHOR author = new AUTHOR();
                        author.FULL_NAME = id.Replace("\'", "").Trim();
                        using (RefmanEntities db = new RefmanEntities())
                        {
                            db.AUTHORs.Add(author);
                            db.SaveChanges();
                            validIds.Add((int)author.AUTHOR_ID);
                        }
                    }
                }

                 //Now that we have the selected ids we could fetch the corresponding
                 //authors from our datasource
                var authors = AuthorController.GetAllAuthors().Where(x => validIds.Contains((int)x.Key)).Select(x => new AUTHOR
                {
                    AUTHOR_ID = x.Key,
                    FULL_NAME = x.Value
                }).ToList();
                return authors;
            }
            return Enumerable.Empty<AUTHOR>();
        }
    } 
```

![在此处输入图像描述](../Images/f5835e5131677759068b295a0fbdf6bc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:38:28.763

此行`db.Entry(magazine).State = EntityState.Modified;`仅告诉 EF 杂志实体已更改。它没有提到关系。如果您调用`Attach`对象图中的所有实体都附加在`Unchanged`状态中，您必须分别处理它们中的每一个。更糟糕的是，在多对多关系的情况下，[您还必须处理关系本身](https://stackoverflow.com/questions/3635071/update-relationships-when-saving-changes-of-ef4-poco-objects/3635326#3635326)（并且[无法更改 DbContext API 中](http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/192f6f64-df77-4902-901b-c36e2b157ab6)的关系状态）。

我花了很多时间来解决这个[问题并在断开连接的应用程序中进行设计](https://stackoverflow.com/questions/3444377/tracking-changes-in-complex-object-graph)。并且有三种通用方法：

*   您将向您的实体发送附加信息，以查找已更改和已删除的内容（是的，您还需要跟踪已删除的项目或关系）。然后，您将手动设置对象图中每个实体和关系的状态。
*   您将只使用您目前拥有的数据，而不是将它们附加到上下文中，您将加载当前杂志和您需要的每个作者，并在这些加载的实体上重建这些更改。
*   您根本不会这样做，而是使用轻量级 AJAX 调用来添加或删除每个作者。我发现这在许多复杂的 UI 中很常见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T15:57:37.530

当我使用 MVC/Nhibernate 开发博客并且实体是`Post`和`Tag`.

我也有类似这样的编辑操作，

```
public ActionResult Edit(Post post)
{
  if (ModelState.IsValid)
  {
       repo.EditPost(post);
       ...
  }
  ...
} 
```

但与您不同的是，我为`Post`not创建了一个自定义模型绑定器`Tag`。在自定义中`PostModelBinder`，我正在做与您在那里所做的几乎相同的事情（但我并没有`Tag`像您为 s 所做的那样创建新的`Author`s）。基本上，我创建了一个新`Post`实例，从 POST 表单中填充它的所有属性，并`Tag`从数据库中获取 id 的所有 s。请注意，我只`Tag`从数据库中获取 s 而不是`Post`.

我可能会建议您创建一个`ModelBinder`并`Magazine`检查一下。此外，最好使用存储库模式而不是直接从控制器进行调用。

更新：

这是`Post`模型绑定器的完整源代码

```
namespace PrideParrot.Web.Controllers.ModelBinders
{
  [ValidateInput(false)]
  public class PostBinder : IModelBinder
  {
    private IRepository repo;

    public PostBinder(IRepository repo)
    {
      this.repo = repo;
    }

    #region IModelBinder Members

    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
      HttpRequestBase request = controllerContext.HttpContext.Request;

      // retrieving the posted values.
      string oper = request.Form.Get("oper"),
               idStr = request.Form.Get("Id"),
               heading = request.Form.Get("Heading"),
               description = request.Form.Get("Description"),
               tagsStr = request.Form.Get("Tags"),
               postTypeIdStr = request.Form.Get("PostType"),
               postedDateStr = request.Form.Get("PostedDate"),
               isPublishedStr = request.Form.Get("Published"),
               fileName = request.Form.Get("FileName"),
               serialNoStr = request.Form.Get("SerialNo"),
               metaTags = request.Form.Get("MetaTags"),
               metaDescription = request.Form.Get("MetaDescription"),
               themeIdStr = request.Form.Get("Theme");

      // initializing to default values.
      int id = 0, serialNo = 0;
      DateTime postedDate = DateTime.UtcNow;
      DateTime? modifiedDate = DateTime.UtcNow;
      postedDate.AddMilliseconds(-postedDate.Millisecond);
      modifiedDate.Value.AddMilliseconds(-modifiedDate.Value.Millisecond);

      /*if operation is not specified throw exception. 
        operation should be either'add' or 'edit'*/
      if (string.IsNullOrEmpty(oper))
        throw new Exception("Operation not specified");

      // if there is no 'id' in edit operation add error to model.
      if (string.IsNullOrEmpty(idStr) || idStr.Equals("_empty"))
      {
        if (oper.Equals("edit"))
          bindingContext.ModelState.AddModelError("Id", "Id is empty");
      }
      else
        id = int.Parse(idStr);

      // check if heading is not empty.
      if (string.IsNullOrEmpty(heading))
        bindingContext.ModelState.AddModelError("Heading", "Heading: Field is required");
      else if (heading.Length > 500)
        bindingContext.ModelState.AddModelError("HeadingLength", "Heading: Length should not be greater than 500 characters");

      // check if description is not empty.
      if (string.IsNullOrEmpty(description))
        bindingContext.ModelState.AddModelError("Description", "Description: Field is required");

      // check if tags is not empty.
      if (string.IsNullOrEmpty(metaTags))
        bindingContext.ModelState.AddModelError("Tags", "Tags: Field is required");
      else if (metaTags.Length > 500)
        bindingContext.ModelState.AddModelError("TagsLength", "Tags: Length should not be greater than 500 characters");

      // check if metadescription is not empty.
      if (string.IsNullOrEmpty(metaTags))
        bindingContext.ModelState.AddModelError("MetaDescription", "Meta Description: Field is required");
      else if (metaTags.Length > 500)
        bindingContext.ModelState.AddModelError("MetaDescription", "Meta Description: Length should not be greater than 500 characters");

      // check if file name is not empty.
      if (string.IsNullOrEmpty(fileName))
        bindingContext.ModelState.AddModelError("FileName", "File Name: Field is required");
      else if (fileName.Length > 50)
        bindingContext.ModelState.AddModelError("FileNameLength", "FileName: Length should not be greater than 50 characters");

      bool isPublished = !string.IsNullOrEmpty(isPublishedStr) ? Convert.ToBoolean(isPublishedStr.ToString()) : false;

      //** TAGS
      var tags = new List<PostTag>();
      var tagIds = tagsStr.Split(',');
      foreach (var tagId in tagIds)
      {
        tags.Add(repo.PostTag(int.Parse(tagId)));
      }
      if(tags.Count == 0)
        bindingContext.ModelState.AddModelError("Tags", "Tags: The Post should have atleast one tag");

      // retrieving the post type from repository.
      int postTypeId = !string.IsNullOrEmpty(postTypeIdStr) ? int.Parse(postTypeIdStr) : 0;
      var postType = repo.PostType(postTypeId);
      if (postType == null)
        bindingContext.ModelState.AddModelError("PostType", "Post Type is null");

      Theme theme = null;
      if (!string.IsNullOrEmpty(themeIdStr))
        theme = repo.Theme(int.Parse(themeIdStr));

      // serial no
      if (oper.Equals("edit"))
      {
        if (string.IsNullOrEmpty(serialNoStr))
          bindingContext.ModelState.AddModelError("SerialNo", "Serial No is empty");
        else
          serialNo = int.Parse(serialNoStr);
      }
      else
      {
        serialNo = repo.TotalPosts(false) + 1;
      }

      // check if commented date is not empty in edit.
      if (string.IsNullOrEmpty(postedDateStr))
      {
        if (oper.Equals("edit"))
          bindingContext.ModelState.AddModelError("PostedDate", "Posted Date is empty");
      }
      else
        postedDate = Convert.ToDateTime(postedDateStr.ToString());

      // CREATE NEW POST INSTANCE
      return new Post
      {
        Id = id,
        Heading = heading,
        Description = description,
        MetaTags = metaTags,
        MetaDescription = metaDescription,
        Tags = tags,
        PostType = postType,
        PostedDate = postedDate,
        ModifiedDate = oper.Equals("edit") ? modifiedDate : null,
        Published = isPublished,
        FileName = fileName,
        SerialNo = serialNo,
        Theme = theme
      };
    }

    #endregion
  }
} 
```

# python - 在 SqlAlchemy @validates 装饰器中返回自定义消息

> ID：12643084
> 
> 赞同：2
> 
> 时间：2012-09-28T15:37:59.103
> 
> 标签：python, json, exception-handling, sqlalchemy

我对 SQLAlchemy 比较陌生。

我有一个非常简单的使用 sqlalchemy 装饰器`model`的自定义函数：`@validates`

```
class User(db.Model):
  ...
  email = db.Column(db.String(255)) # don't worry about uniqueness for now

  @validates('email')
  def validate_email(self, key, address):
    assert '@' in address # of course a regex is better, I know
    return address 
```

然后：

```
try:
  user = User('fidel#cuba.cu')
  db.session.add(user)
  db.session.commit()
except Exception as e:
  print e.message # returns an empty string '' 
```

我想做的事：

```
...
except Exception as e:
  # json_error is a custom function of my own 
  return json_error(e.message, 400) 
```

所以问题是：如何将自定义错误消息附加到 SQLAlchemy 中的自定义验证规则？也许我需要创建一个包含消息的自定义异常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T13:33:36.327

断言可以接受第二个参数 - 断言失败时使用的消息：

```
class User(db.Model):
  # ... snip ...

  @validates('email')
  def validate_email(self, key, address):
    assert '@' in address, "Invalid email"
    return address 
```

# xamarin.android - Xamarin android 中文件选择器的示例代码

> ID：12643085
> 
> 赞同：2
> 
> 时间：2012-09-28T15:38:10.397
> 
> 标签：xamarin.android, xamarin, xamarin.mobile

谁能告诉我如何使用 Mono 为 Android 实现文件选择器/选择器？

提前致谢， 特里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T15:07:01.767

这个[样本](http://docs.xamarin.com/recipes/android/data/files/browse_files)对你有用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-02T10:15:40.580

如果你想稍后支持更多平台，你还可以使用作为 NuGet 包提供的 Xamarin 插件项目之一。目前维护最积极的包是这个： [https](https://github.com/jfversluis/FilePicker-Plugin-for-Xamarin-and-Windows) ://github.com/jfversluis/FilePicker-Plugin-for-Xamarin-and-Windows （注意：我是该项目的贡献者之一）。

选择文件就像调用`var result = await PickFile()`和检查结果对象一样简单。另请参阅 Github 项目的 README.md 中提到的示例代码。

# java - java hw 需要帮助理解

> ID：12643086
> 
> 赞同：1
> 
> 时间：2012-09-28T15:38:16.780
> 
> 标签：java, uml, adt

我先把整个问题写下来。

> 环是具有对当前项的引用的项的集合。一个操作——我们称之为提前——将引用移动到集合中的下一个项目。当引用到达最后一项时，下一个前进操作会将引用移回第一项。环还具有获取当前项目、添加项目和删除项目的操作。添加项目和删除项目的详细信息由您决定。
> 
> 设计一个 ADT（抽象数据类型）来表示一个对象环。通过说明其目的、描述其参数以及编写其标头的伪代码版本来指定每个操作。然后为环的方法编写一个 Java 接口。在您的代码中包含 javadoc 样式的注释。

那么是不是说 Ring 就像一个具有操作的类，可以通过使用 T = items 之类的引用变量来移动项目？每次调用 Advance 时都会更改 T 以表示不同的项目？类似于 UML 格式的东西....

ADT：环

```
+advance(): T // move T to next item in collection and if T reaches last item, move T back to the first item.

+getCurrItem(): T // return item that T reference.

+addItem(item T): void // add an item in for T, No return.

+removeItem(Item: T): boolean // remove item that T reference and return true | false if it succeed or not. 
```

我是在正确的轨道上还是我应该做其他事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:48:04.463

这对我来说是一个好的开始。现在您必须设计 ADT 以及您将如何存储项目并从头到尾引用。这是一个数据抽象问题，您可以通过多种方式处理实现，但由您决定以有效的方式设计它。

# java - Android简单地保存和读取文件

> ID：12643089
> 
> 赞同：-3
> 
> 时间：2012-09-28T15:38:21.397
> 
> 标签：java, android, file

我想在 Android 设备的内部存储上保存和读取一个字符串。我想（如果文件不存在）写入文件，编辑文件并读取文件。最简单和最好的方法是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:42:39.973

大多数情况下，您将使用标准的 Java I|O，就像您在以前的 Java 项目中所做的那样。

要获取内部存储上的文件，您有两个主要选择：

1.  分别使用`openFileInput()`和`openFileOutput()`获取内部存储根目录中的`InputStream`文件`OutputStream`

2.  用于`getFilesDir()`获取`File`指向内部存储根目录的对象，您可以从中创建子目录、为输入和输出创建流和读取器等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:03:00.360

要写入值：

调用 edit() 以获取 SharedPreferences.Editor。使用 putBoolean() 和 putString() 等方法添加值。使用 commit() 提交新值 要读取值，请使用 SharedPreferences 方法，例如 getBoolean() 和 getString()。

这是一个在计算器中保存静音按键模式首选项的示例：

```
public class Calc extends Activity {
    public static final String PREFS_NAME = "MyPrefsFile";

    @Override
    protected void onCreate(Bundle state){
       super.onCreate(state);
       . . .

       // Restore preferences
       SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
       boolean silent = settings.getBoolean("silentMode", false);
       setSilent(silent);
    }

    @Override
    protected void onStop(){
       super.onStop();

      // We need an Editor object to make preference changes.
      // All objects are from android.context.Context
      SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
      SharedPreferences.Editor editor = settings.edit();
      editor.putBoolean("silentMode", mSilentMode);

      // Commit the edits!
      editor.commit();
    }
} 
```

# javascript - 如何隐藏表单中的文件输入项？

> ID：12643098
> 
> 赞同：0
> 
> 时间：2012-09-28T15:38:47.237
> 
> 标签：javascript, file, input

我正在开发一个允许用户上传字体文件的网页，但要求是在用户选择文件后显示字体名称，然后他可以决定是否上传，字体名称是字体文件中的一个属性，文件名可能是“123.ttf”，但是当你右键单击字体文件并查看它的“标题”preperty时，它被称为“ACME Explosive Bold”，所以我的Javascript应该理想地找到“tilte”属性这种字体，但经过大量研究，我被告知 JS 无法获取此属性，而另一方面，我发现了一段 Java 代码可以获取它。

所以现在我试图在页面上隐藏第二个表单，输入字段的值将是用户从第一个表单中选择的文件，当用户选择一个文件但在他点击第一个表单的提交按钮之前，我的 JS 调用带有用户选择文件的第二个表单，提交并运行一个 servlet 以找到它的“标题”并返回并将其显示在页面上，然后在服务器上删除该文件，因为用户从未正式提交过。

所以我的问题是如何用它自己的输入文件字段和页面上的浏览按钮隐藏第二个表单，我需要表单标签，这样我就可以模拟提交。但我不希望用户看到它？

到目前为止，这是我的代码：

```
![<div class="body">
    <h1>Upload Font</h1>                                                       <%-- \[+\] --%>
    <s:form namespace="/font" action="add" method="POST" enctype="multipart/form-data">
        <div class="dialog">
            <table>
                <tbody>
                    <tiles:insertAttribute name="form" />
                    <tr class="prop">
                        <td valign="top" class="name required">
                            <label for="description">Font File:</label>
                        </td>
                        <td valign="top">
                            <s:file name="file" size="62" theme="simple" id="fname" onchange="fileUpload('/pages/font/getFontTitle.jsp',value,this.files\[0\])"/>
                        </td>
                    </tr> 
                    <tr class="prop">
                        <td>
                            <span class="button"><s:submit/></span>
                        </td>
                    </tr> 
                </tbody>
            </table>
        </div> 
    </s:form>
    <s:form namespace="/font" action="hiddenForm" method="POST" enctype="multipart/form-data">
        <div class="dialog">
            <table>
                <tbody>
                    <tr class="prop">
                        <td valign="top">
                            <s:file name="file" size="62" theme="simple" id="fname_1"/>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div> 
    </s:form>
</div>] 
```

![在此处输入图像描述](../Images/5fec010cc42080b0d8a0696ad08251af.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:53:16.020

您可以使用 CSS 属性可见性隐藏第二个表单：隐藏。

```
<s:form namespace="/font" style ='visibility:hidden' action="hiddenForm" method="POST" enctype="multipart/form-data"> 
```

# c++ - 管理 Make 文件中的依赖复杂性

> ID：12643106
> 
> 赞同：1
> 
> 时间：2012-09-28T15:39:11.013
> 
> 标签：c++, makefile, dependencies, object-files

我正在开发我的第一个开源 C++ 项目：[https](https://github.com/jehugaleahsa/spider-cpp) ://github.com/jehugaleahsa/spider-cpp 。

我正在管理我自己的 Makefile，我有关于如何管理依赖项的“最佳实践”问题。现在，我使每个 .o 文件依赖于 .cpp 文件中包含的每个头文件。所以：

```
code.o: code.cpp code.hpp dep1.hpp de2.hpp
    g++ -c code.cpp 
```

首先，我很确定 Make 支持创建目标文件的简写。如果有人能举个例子，我会很感激的。

接下来，有没有办法避免将每个包含的标头列为依赖项？我想确保如果我更改依赖项，这些更改仍然兼容。列出包含的标题既乏味又容易搞砸。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:10:08.063

操作：

> 首先，我很确定 Make 支持创建目标文件的简写。如果有人能举个例子，我会很感激的。

从[这里](http://scottmcpeak.com/autodepend/autodepend.html)：

```
OBJS := foo.o bar.o

#Your program should have the objects as dependencies, and link them
proggie: $(OBJS)
gcc $(OBJS) -o proggie

# compile
%.o: %.c
    gcc -c $(CFLAGS) $*.c -o $*.o 
```

操作：

> 接下来，有没有办法避免将每个包含的标头列为依赖项

[在同一页的](http://scottmcpeak.com/autodepend/autodepend.html)下方，请参阅以下几行：

```
# pull in dependency info for *existing* .o files
-include $(OBJS:.o=.d)

# compile and generate dependency info
%.o: %.c
    gcc -c $(CFLAGS) $*.c -o $*.o
    gcc -MM $(CFLAGS) $*.c > $*.d 
```

基本上它的作用是使用 gcc 的 -MM 选项来获取头文件列表，现在我们可以依赖它们了。因此，我们将包含此类头文件列表的文件输出到 .d 文件，然后下一次，我们将文件列表添加为依赖项，这就是`-include`命令的作用。`-`如果依赖项 .d 文件尚不存在，则" " 可避免错误。

请注意，您应该修改上述内容以考虑`.cpp`文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:09:26.817

是的，make 支持创建目标文件的简写。这称为规则。是的，有一种方法可以避免将每个包含的标头列为依赖项。g++/gcc 有 -MM 选项，它将生成完整的依赖项列表。

不幸的是，没有关于如何做到这一点的简单解释，我可以把它放在这里。你必须阅读文档并使用 make 实用程序。我发现这本书很有帮助：“使用 GNU Make 管理项目”。GNU 站点上有一个文档，但我发现它有点难以阅读。www.gnu.org/software/make/manual/make.html

# c# - 在 Windows Phone 7 中加载一些图钉后，地图工作缓慢

> ID：12643107
> 
> 赞同：0
> 
> 时间：2012-09-28T15:39:16.067
> 
> 标签：c#, windows-phone-7

我面临一个问题，加载一些图钉地图后工作非常缓慢，甚至有时它没有移动。并且很难使用我们的应用程序。

请帮助我或指导我该怎么做。

提前致谢！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:59:48.107

如果 BitmapCache 不够，您还可以实现图钉集群或限制屏幕上的最大图钉。

[图钉拼接](http://www.scottlogic.co.uk/blog/colin/2011/11/pushpin-clustering-with-the-windows-phone-7-bing-map-control/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:13:35.370

您可能希望将地图的 CacheMode 设置为 BitmapCache，这应该会提高性能，如以下博客文章中所述：-

[http://mindre.net/Article/windows_phone_7__cachemode_and_why_it_matters](http://mindre.net/Article/windows_phone_7__cachemode_and_why_it_matters)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T10:19:46.737

开发 WP7Contrib（在 CodePlex 上）的人写了一篇关于 WP7 的图钉性能的博文。

[http://awkwardcoder.blogspot.co.uk/2011/11/how-many-pins-can-bing-maps-handle-in.html](http://awkwardcoder.blogspot.co.uk/2011/11/how-many-pins-can-bing-maps-handle-in.html)

能给你一些指点吗？

# asp.net-mvc - 是否有用于 asp mvc 4 的脚手架工具？

> ID：12643108
> 
> 赞同：0
> 
> 时间：2012-09-28T15:39:25.530
> 
> 标签：asp.net-mvc

有没有一种工具可以用来为 asp mvc 4 中的模型自动创建 CRUD + ui？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:43:26.533

有**[ASP.NET MVC 脚手架](http://mvcscaffolding.codeplex.com/)**。

这是 Steven Sanderson 关于该软件包[的一系列博客文章](http://blog.stevensanderson.com/2011/01/13/scaffold-your-aspnet-mvc-3-project-with-the-mvcscaffolding-package/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T14:35:33.220

[您可以尝试使用CamoteQ Architecture 之](http://camoteq.com)类的在线工具

# vba - 从工作簿 1 的单元格中的数据“另存为”工作簿 2 的宏

> ID：12643109
> 
> 赞同：1
> 
> 时间：2012-09-28T15:39:30.277
> 
> 标签：vba, excel

我是宏的基本用户，但现在陷入了以下困境。我打开了两本工作簿。我需要“另存为”并使用工作簿 1 中的单元格中的文件名关闭工作簿 2。宏正在从工作簿 1 运行。抱歉，这是我从互联网上所能得到的。我猜最后一行有变化。哦，是的，我也不知道 Dim 是什么意思。

```
Dim FName As String
Dim FPath As String

FPath = "G:"

FName = Sheets("sheet 1").Range("A1").Text

ThisWorkbook.SaveAs Filename:=FPath & "\" & FName 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:46:00.883

Dim 是您如何维度（声明变量），在您的情况下，告诉代码`FName`将引用您分配的字符串值。有关不错的教程，请参阅[此链接](http://www.cpearson.com/excel/DeclaringVariables.aspx)

要使您的代码正常工作，请尝试以下操作：

```
Dim FName As String
Dim FPath As String

FPath = "G:"

FName = ThisWorkbook.Sheets("sheet 1").Range("A1").Text 'use ThisWorkbook since you are running from Workbook1

With Workbooks("Workbook2.xlsx")
    .SaveAs Filename:=FPath & "\" & FName 
    .Close True '-> use false to not save changes
End With
'here you need to tell VBA what specific workbook you want to save
'if you used ThisWorkbook here, you would save the workbook where the code runs from, which is Workbook1 
```

您还可以采取更好的方法，如下所示：

```
Dim FName as String, FPath as String
Dim wkb1 as Workbook, wkb2 as Workbook

Set wkb1 = ThisWorkbook '-> or Set wkb1 = Workbooks("workbook1")

FPath = "G:"
FName = wkb1.Sheets("sheet 1").Range("A1").Text

Set wkb2 = Workbooks("workbook2")
With wkb2
    .SaveAs Filename:=FPath & "\" & FName
    .Close True '-> use false to not save changes
End With 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T20:34:41.730

正如其他人有状态一样， Dim 代表维度。

从历史上看，在各种 BASIC（初学者的通用符号指令代码）编程语言中，您不必声明变量，但必须声明的数组除外。因此，即使是非常古老的 BASIC 语言也有一种声明数组的方法，这是使用“Dim”关键字完成的。当基本语言开始支持声明常规变量时，它们只是借用了已经在使用的关键字 Dim。所以 Dim 代表维度，最初用于指示数组的大小和/或边界，但被接管以声明任何类型的变量。

顺便说一句，随着编程语言的发展，其语言设计者通常不愿引入新关键字，因为这样做通常会破坏现有程序。例如，如果他们引入了“var”关键字，它可能会破坏许多使用“var”作为变量名的现有程序。随着语言的发展，发现现有的关键字或多或少地重新用于增加功能的情况并不少见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T15:48:14.410

你在正确的轨道上。您可以将最后一个留置权更改为此，它会起作用：

```
Workbooks("Workbook2Filename.xls").SaveAs Filename:=FPath & "\" & FName 
```

但是，我推荐以下方法：

```
Dim FName As String
Dim FPath As String

Dim wbBook1 As Workbook
Dim wbBook2 As Workbook

Set wbBook1 = ActiveWorkbook
Set wbBook2 = Workbooks("Workbook2Filename.xls") 'assumed workbook 2 is already open

FPath = "G:"
FName = wbBook1.Sheets("sheet 1").Range("A1").Text

wbBook2.SaveAs Filename:=FPath & "\" & FName

Set wbBook1 = Nothing
Set wbBook2 = Nothing 
```

Dim 代表 Dimension，它是您告诉 VBA 创建一个变量来存储信息的方式。

# java - 我怎样才能在谷歌云端硬盘中只获取“与我共享”文件

> ID：12643111
> 
> 赞同：0
> 
> 时间：2012-09-28T15:39:47.813
> 
> 标签：java, google-drive-api

我想检索“与我共享”标签下的文件，并且仅检索那些文件，以便能够获取新与我共享的文件

我注意到那些没有父母，所以我无法通过 files.children 请求或带 aq 参数的 files.list 请求来获取它们。

我不想检索所有文件然后检查它们是否有父文件。有没有办法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:56:09.297

使用查询：

```
not 'user@example.com' in owners 
```

这将返回当前用户有权访问但不是文件所有者的所有文件。

# wcf - WCF - .Net 4.5 安装后的端点冲突

> ID：12643113
> 
> 赞同：4
> 
> 时间：2012-09-28T15:39:54.797
> 
> 标签：wcf, web-config, .net-4.5

我最近在我们的开发 Web 服务器上安装了 4.5 框架，该服务器在 Windows Server 2008 上运行 IIS 7.5。安装后，两个 Web 服务开始出现相同的错误。这些 Web 服务是使用 MS REST Starter Kit 构建的。这是我得到的错误。

*绑定实例已与监听 URI 相关联。如果两个端点想要共享同一个 ListenUri，它们也必须共享同一个绑定对象实例。两个冲突的端点要么在 AddServiceEndpoint() 调用中指定，要么在配置文件中指定，要么在 AddServiceEndpoint() 和 config 的组合中指定。*

这是我们配置文件的 system.service 模型部分的副本。

```
<system.serviceModel>
   <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />  
    <bindings>
      <webHttpBinding>
        <binding>
          <security mode="Transport" />
        </binding>
      </webHttpBinding>
      <wsHttpBinding>
        <binding name="EnterpriseIdentityBinding" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard"
          maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text"
          textEncoding="utf-8" useDefaultWebProxy="true" allowCookies="false">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <reliableSession ordered="true" inactivityTimeout="00:10:00"
            enabled="false" />
          <security mode="TransportWithMessageCredential">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" negotiateServiceCredential="true"
              algorithmSuite="Default" />
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>

    <client>
      <endpoint address="https://betaapps/EnterpriseIdentity/V1/UserService.svc"
        binding="wsHttpBinding" bindingConfiguration="EnterpriseIdentityBinding"
        contract="UserServiceWCF.IUserService" name="wsSecureUsers" />
      <endpoint address="https://betaapps/EnterpriseIdentity/V1/RoleService.svc"
        binding="wsHttpBinding" bindingConfiguration="EnterpriseIdentityBinding"
        contract="RoleServiceWCF.IRoleService" name="wsSecureRoles" />
    </client>

    <standardEndpoints>
      <webHttpEndpoint>
        <standardEndpoint name="" helpEnabled="true" automaticFormatSelectionEnabled="true"/>
      </webHttpEndpoint>
    </standardEndpoints>

    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceAuthorization principalPermissionMode="Custom">
            <authorizationPolicies>
              <add policyType="Hsmv.Web.Security.IdentityModel.HttpContextWithRolesPolicy, Hsmv.Web.Security" />
            </authorizationPolicies>
          </serviceAuthorization>
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

知道为什么在安装 .Net 4.5 后会出现此错误吗？

我想补充一点，我尝试删除此部分，没有它它确实可以工作。

```
<webHttpBinding>
        <binding>
          <security mode="Transport" />
        </binding>
</webHttpBinding> 
```

我使用它是因为该服务在 ssl 上运行。我听说 WCF 4.5 会尝试为您创建绑定和端点，因此它们不需要在 web.config 中。所以我想知道这部分是否由 WCF 自动构建并且不需要。还是我的想法不正确？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T21:29:06.543

我来自 WCF 团队。感谢您报告此问题。WCF 团队将继续调查此问题以进行修复。在我们进行调查时，您可以通过在配置文件中显式配置 webHttp 端点来解决此问题。服务将与以前一样的行为相同。尝试遵循这些简单的步骤。

（我以您在这篇文章中发布的配置文件为起点）

1.  注释掉配置文件中的 <standardEndpoints> 标记：

    <!--<standardEndpoints>
    <webHttpEndpoint>
    <standardEndpoint name="" helpEnabled="true" automaticFormatSelectionEnabled="true"/>
    </webHttpEndpoint>
    </standardEndpoints>-->

2.  将此端点行为添加到您的列表中，如下所示：

    <behaviors>
    <endpointBehaviors>
    <behavior name="REST">
    <webHttp helpEnabled="true" automaticFormatSelectionEnabled="true" />
    </behavior>
    </endpointBehaviors>
    </behaviors>

3.  像这样在配置文件中显式配置您的服务端点。对于突出显示的属性值，分别替换您的服务类型名称和合同名称（注意：如果您没有为服务定义合同，则在合同=“”中插入服务类型名称）

    <services>
    <service name="WcfRestService1.Service1">
    <endpoint address="" binding="webHttpBinding" contract="WcfRestService1.Service1" behaviorConfiguration="REST" />
    </service>
    </services>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-08T14:48:02.600

就我而言，一旦我`<security/>`从 web.config 中删除了标签，问题就解决了。我将其设置为“无”，因此这可能不适用于您的特定情况。

# php - PHP 和 JavaScript 数组附件

> ID：12643116
> 
> 赞同：0
> 
> 时间：2012-09-28T15:40:05.280
> 
> 标签：php, javascript, arrays, function

我有以下问题：

```
onclick=langedit('".$carray2['example']."','".$carray2['id']."') 
```

`$carray2['example']`是一个包含空格的字符串`"ABOUT US"`，这是 HTML 中的输出：

```
onclick='langedit('Contact" us','9')=""> 
```

我的 PHP 代码：

```
else {
$cquery2 = mysql_query ("SELECT id,example,".$startlan." FROM language WHERE example = '$word'");
$carray2 = mysql_fetch_array($cquery2);
if($carray2[$startlan] == '') {
if($_SESSION['view'] == 'admin' && isset($_SESSION['siteshow'])){
echo  "<span class='langedit' id='langedit".$carray2['id']."' onclick=langedit('".$carray2['example']."','".$carray2['id']."')><img src='images/sys/edit.png' > </span>";
return $carray2['example'];
}else{
return $carray2['example'];
}
} 
```

我不知道发生了什么，因此该`langedit`功能不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:01:39.920

用双引号 覆盖`langedit`调用`onclick`

```
onclick=\"langedit('".$carray2['example']."','".$carray2['id']."')\" 
```

否则，如果`$carray2['example']`是`About Us`，则`onclick`属性变为`onclick=langedit('About`无效函数调用。

# sql - 动态创建列sql

> ID：12643117
> 
> 赞同：31
> 
> 时间：2012-09-28T15:40:06.897
> 
> 标签：sql, sql-server, tsql, pivot, dynamic-pivot

我有一张客户表

```
Customer ID        Name         
   1               John        
   2               Lewis        
   3               Mary 
```

我有另一张桌子 CustomerRewards

```
 TypeID           Description
   1                Bronze
   2                Silver
   3                Gold
   4               Platinum
   5               AnotherOne 
```

还有决赛桌

```
 RewardID          TypeID          CustomerID
    1                1                 1
    2                1                 1
    3                2                 1
    4                2                 2 
```

customerTypes 表是动态的，其中许多类型可以添加和删除。基本上我想要的只是动态生成的列和每个列的计数，比如

```
CustomerName        Bronze        Silver     Gold      Platinum     AnotherOne    total
   John               2             1         0           0             0           3
   Lewis              0             1         0           0             0           1
 Grand TOTAL          2             2         0           0             0           4 
```

像我说的问题是类型是动态的，客户是动态的，所以我需要根据系统中的类型动态列

我已经在 DataGridView 中标记了 c#，因为我需要它

提前致谢

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-09-28T15:59:00.827

您将需要为此使用`PIVOT`函数。如果您有已知数量的列，则可以对这些值进行硬编码：

```
select name, [Bronze], [Silver], [Gold], [Platinum], [AnotherOne]
from
(
  select c.name,
    cr.description,
    r.typeid
  from customers c
  left join rewards r
    on c.id = r.customerid
  left join customerrewards cr
    on r.typeid = cr.typeid
) x
pivot
(
  count(typeid)
  for description in ([Bronze], [Silver], [Gold], [Platinum], [AnotherOne])
) p; 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/25d14/10)。

现在，如果您有未知数量的列，那么您可以使用动态 SQL 来`PIVOT`：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT ',' + QUOTENAME(description) 
                    from customerrewards
                    group by description, typeid
                    order by typeid
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT name,' + @cols + ' from 
             (
                select c.name,
                  cr.description,
                  r.typeid
                from customers c
                left join rewards r
                  on c.id = r.customerid
                left join customerrewards cr
                  on r.typeid = cr.typeid
            ) x
            pivot 
            (
                count(typeid)
                for description in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/25d14/9)

如果需要包含该`Total`列，则可以使用`ROLLUP`（[静态版本演示](http://sqlfiddle.com/#!3/25d14/14)）：

```
select name, sum([Bronze]) Bronze, sum([Silver]) Silver, 
  sum([Gold]) Gold, sum([Platinum]) Platinum, sum([AnotherOne]) AnotherOne
from 
(
  select name, [Bronze], [Silver], [Gold], [Platinum], [AnotherOne]
  from
  (
    select c.name,
      cr.description,
      r.typeid
    from customers c
    left join rewards r
      on c.id = r.customerid
    left join customerrewards cr
      on r.typeid = cr.typeid
  ) x
  pivot
  (
    count(typeid)
    for description in ([Bronze], [Silver], [Gold], [Platinum], [AnotherOne])
  ) p
) x
group by name with rollup 
```

动态版（[Demo](http://sqlfiddle.com/#!3/25d14/17)）：

```
DECLARE @cols AS NVARCHAR(MAX),
    @colsRollup AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT ',' + QUOTENAME(description) 
                    from customerrewards
                    group by description, typeid
                    order by typeid
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

select @colsRollup 
      = STUFF((SELECT ', Sum(' + QUOTENAME(description) + ') as '+ QUOTENAME(description)
                    from customerrewards
                    group by description, typeid
                    order by typeid
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query 
          = 'SELECT name, '+ @colsRollup + '
             FROM
             (
                SELECT name,' + @cols + ' from 
                 (
                    select c.name,
                      cr.description,
                      r.typeid
                    from customers c
                    left join rewards r
                      on c.id = r.customerid
                    left join customerrewards cr
                      on r.typeid = cr.typeid
                ) x
                pivot 
                (
                    count(typeid)
                    for description in (' + @cols + ')
                ) p 
              ) x1
              GROUP BY name with ROLLUP'

execute(@query) 
```

# windows - 远程运行 PowerShell 命令的安全性？

> ID：12643121
> 
> 赞同：0
> 
> 时间：2012-09-28T15:40:19.103
> 
> 标签：windows, powershell, administration, winrm

我是 PowerShell 的新手。我希望在运行 Windows 7 的远程 PC 上运行 PowerShell 命令。

在远程 PC 上，我运行了以下 PowerShell 命令：

```
Enable-PSRemoting -Force
Set-Item WSMAN:\localhost\client\trustedhosts <host_ip>
Restart-Service WinRM 
```

我在主机 PC 上执行了最后两个命令（但使用`<remote_ip>`）。

我确认这适用于：

```
Invoke-Command -ComputerName <name> -Credential <username> -ScriptBlock { Get-ChildItem C:\ } 
```

我的问题：这在公共网络上是否安全？我应该做点别的吗？还是我应该使用 SSL？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:22:45.470

如果在使用 Invoke-Command 时使用默认身份验证，则使用 NTLM 或 Kerberos 在远程主机上对用户进行身份验证。所以我认为你不需要太担心密码在网络上被嗅出。此外，默认情况下，远程端点只能由该计算机上的管理员使用。最后，如果您需要允许非管理员访问，您可以配置一个受限制的远程端点。它可以在可用的 cmdlet 中受到限制，并且可以在语言能力方面受到限制。本[远程处理教程](http://powershell.com/cs/media/p/7257.aspx#how-session-configurations-are-assigned)涵盖了设置受限会话。

# java - 在 BorderPane (JavaFX 2) 中获取中心空间 的宽度和高度

> ID：12643125
> 
> 赞同：3
> 
> 时间：2012-09-28T15:40:41.383
> 
> 标签：java, javafx-2

我有一个简单的`BorderPane`实例，它是我的`Scene`. 边框窗格包括右侧的一个面板，其中包含一些 GUI 控件，包括一个按钮。当我单击此按钮时，我创建了一个`Foo`扩展类 ( )的实例，`StackPane`并将此实例作为边框窗格的中心节点。

我想分别通过调用**从**`Foo`实例中获取边框窗格可用中心空间的宽度和高度值，但它总是返回零？`this.getLayoutBounds.getWidth()``...getHeight()`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T17:50:39.063

将侦听器添加到 StackPane 的 layoutBoundsProperty 或绑定到它的 height 和 width 属性。

JavaFX 将只为 StackPane 的高度和宽度返回零，直到它对其执行布局传递。因为 StackPane 是一个可调整大小的节点，JavaFX 通常不知道它的大小，直到它被添加到场景并显示在舞台上。

如果您只想知道它的初始大小，您可以在调用 stage.Show 后在 StackPane 上调用 getHeight 或 getWidth。

未来的布局通道可能会随着可用区域的变化调整 StackPane 的大小，因此如果您希望始终了解当前窗格的大小，建议使用侦听器或绑定。

# json - 可以将 Github 问题跟踪器导出或迁移到另一个跟踪系统吗

> ID：12643126
> 
> 赞同：3
> 
> 时间：2012-09-28T15:40:54.647
> 
> 标签：json, github, migration, export, issue-tracking

我正在考虑使用 github 问题跟踪器作为实验，但如果我们的开发人员社区发现 github 跟踪器缺少，则保留迁移到更强大的问题跟踪器的选项。[但是，除了这篇博](http://www.lornajane.net/posts/2011/Github-To-Jira-Bug-Migration-Script)文 和[这篇 github 文章](http://developer.github.com/v3/issues/#list-issues-for-a-repository)告诉我如何导出之外，我找不到任何关于这种迁移的信息 ，但没有找到如何将生成的 JSON 导入另一个问题跟踪器。

是否有关于如何做到这一点的具体信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-18T13:51:32.093

特定的导入信息将特定于您要导入的跟踪系统。

但是，一般而言，就像您链接到的 JIRA 示例一样，您可能需要将 Github 提供的 JSON 切换为 CSV 或 XML 文件。某些键可能还需要重命名。所有这一切都应该可以通过编写或找到任务的简短脚本来管理。

# java - 在 jsp 中使用 if 语句从通过 struts 的操作页面的结果中显示警报“此用户名已被使用”

> ID：12643132
> 
> 赞同：0
> 
> 时间：2012-09-28T15:41:18.383
> 
> 标签：java, jsp, struts2

我试图让这个 if 语句显示

```
 <s:hidden id="userNameTest" value="nameTest"></s:hidden>
        <s:if test="userNameTest.value.equals('false')">
                That name is already in use.
        </s:if> 
```

如果这发生在我的操作页面中

```
 public String createUser()
{
    user.set_permission("user");
    if(user.get_userName().matches("^([a-zA-Z0-9]{5,15})$")&&(user.get_password().matches("^((?=.+\\d).{8,20})$")))
    {
        if(manager.checkUserName(user.get_userName()) == false)
        {
            manager.createUser(user);
            valueButton = "userPage";
        }
        else
        {
            valueButton = "createUser";
        }
    }
    else
    {
        nameTest = false;
        valueButton = "createUser";
    }
    return valueButton;
} 
```

我尝试在 jsp onclick 中将隐藏字段设置为 false，如您在上面看到的，我尝试在操作中将其设置为 false。我在其他网站上查找过，但找不到我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:03:30.210

请使用 JSTL 核心标签。作为惯例，前缀将是`<c:>`

`nameTest`解决方案是在您的操作类中设置请求属性：

布尔比较：

```
<c:if test="nameTest eq false">
..
</c:if> 
```

字符串比较：

```
<c:if test="nameTest eq 'false'">
..
</c:if> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T18:51:21.247

如果您的变量`nameTest`是布尔值，那么`<s:if test="!nameTest"> User Name is Taken </s:if>`将起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:48:29.660

1.  首先，为了检查您的值在 JSP 中是否正确，您可以使用`s:debug`或打印它`<s:property value = "nameTest"/>`。

2.  如果要使用 if 条件，可以直接检查 throught

`<s:if test="nameTest =='false'"> User Name is Taken </s:if>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T10:31:24.487

尝试以下。

```
1)
    <s:if test="'${nameTest}'=='false'">   
        That name is already in use.
    </s:if> 
```

2）如果该变量是布尔值，那么试试这个

```
 <s:if test="%{${nameTest} == false}">   
            That name is already in use.
    </s:if> 
```

`nameTest`动作类中必须有 getter 和 setter

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-08T12:54:44.233

由于您使用的是 struts2，因此基于结果显示警报的更通用方法如下（我也在此处使用 Bootstrap 框架，因为它提供了更好的外观、感觉和响应性）：

填写表单并提交后，操作类完成它的工作并返回“成功”或“错误”。然后将其映射到 struts.xml 中，您应该在其中执行此操作 -

```
<action name="the-form-action" class="com.example.action.MyActionClass">
    <result name="success">/result-page.jsp?result=true</result>
    <result name="error">/result-page.jsp?result=false</result>
</action> 
```

在 result-page.jsp（也可以是您的初始表单页面）中添加此代码

```
 //Tags and everything
        <body>
        <%
            String result=request.getParameter("result");
            if (result==null)
                result="";
            if (result.equalsIgnoreCase("true"))
            {
        %>
            <div class="alert alert-success alert-dismissible" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <strong>Success!</strong> Who's the boss?! You're the boss!!
            </div>
        <%
            }
            if (result.equalsIgnoreCase("false"))
            {
        %>
            <div class="alert alert-danger alert-dismissible" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <strong>Oops!</strong> There seems to be an error! You may try the following :<br>
                <ul>
                 <li>Fill the compulsory fields</li>
                 <li>Pray to god</li>
                </ul>
            </div>
        <%
            }
        %>

        //Rest of the body
        </body> 
```

现在警报只会显示成功或失败。

# google-chrome - 更新 Chrome 后，Chrome 开发者工具栏中的搜索行消失了。怎么找回来？

> ID：12643134
> 
> 赞同：4
> 
> 时间：2012-09-28T15:41:24.140
> 
> 标签：google-chrome, web-developer-toolbar

在 Chrome 中，它的控制台中有一个搜索行。这是来自[google.dev.com 页面](https://developers.google.com/chrome-developer-tools/docs/console)的图片：

![在此处输入图像描述](../Images/b53ef9481ed72bad65c02dda911e1e02.png)

这是我的控制台。现在没有任何搜索行：

![在此处输入图像描述](../Images/41de3790b1886d41140c9d54a150eb38.png)

有人遇到过这样的问题吗？我怎样才能找回它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T16:29:30.793

按`Ctrl`+ `F`，它会重新出现在底部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:09:26.900

按“Ctrl”+“Shift”+“F”再按F12，就会出现搜索结果。很烦人。

# ios - 类似于 iPhone 和 iPod Touch 上的 UIPopoverController 的 UIControl

> ID：12643135
> 
> 赞同：0
> 
> 时间：2012-09-28T15:41:31.277
> 
> 标签：ios, uipopovercontroller, uipopover

我正在寻找与[UIPopoverController](https://developer.apple.com/documentation/uikit/uipopovercontroller)模糊相似的东西，以便在 iPhone 和 iPod Touch 上使用。我想用这个对象简单地在一种对话泡泡中显示文本（类似于漫画中的基本对话泡泡）。

我考虑过自己做这个。我会从一个`UIView`具有`UILabel`作为子视图的子类开始。虽然这可能会奏效，但它缺少一些我认为很难做到恰到好处的关键元素。有文本换行，根据字体大小、文本长度、视图的最大宽度和高度等调整视图的大小。还有像其他气泡一样突出的三角形。所以在我重新发明轮子之前，我想看看存在什么。

**`UIPopoverController`在 iPhone 和 iPod Touch 上的工作有哪些替代方案？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:44:21.327

为此，我使用了 FPPopover 的[FPPopoverController](https://github.com/alvises/FPPopover)。但它已经多年没有更新了。

# ruby-on-rails - Rails：向所有表单添加字段

> ID：12643142
> 
> 赞同：0
> 
> 时间：2012-09-28T15:42:09.670
> 
> 标签：ruby-on-rails, monkeypatching

是否可以将隐藏字段添加到所有表单标签？我正在尝试通过以下方式进行操作：

```
module ActionView::Helpers::FormTagHelper

  def form_tag(url_for_options = {}, options = {}, &block)
    html_options = html_options_for_form(url_for_options, options)
    if block_given?
      f = form_tag_in_block(html_options, &block)
    else
      f = form_tag_html(html_options)
    end
    hidden_f = ActiveSupport::SafeBuffer.new "<input name='n' type='hidden' value='v' /><\/form>"
    f.gsub!(/<\/form>/, hidden_f)
    f
  end

end 
```

但是服务器显示错误：

```
ActionView::Template::Error (Could not concatenate to the buffer because it is not html safe.): 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:10:17.143

[`extra_tags_for_form`](https://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/form_tag_helper.rb#L735-753)重新定义用于添加 、 和隐藏字段的方法`_method`可能`utf8`更`authenticity_token`简单。像这样的东西可以工作：

```
module ActionView::Helpers::FormTagHelper
  alias_method :orig_extra_tags_for_form, :extra_tags_for_form

  def extra_tags_for_form(html_options)
    orig_tags = orig_extra_tags_for_form(html_options)
    orig_tags << "<input name='n' type='hidden' value='v' /><\/form>".html_safe
  end
end 
```

由于此建议涉及重新定义私有方法，因此您需要确保在升级 Rails 时仔细测试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:46:11.273

尝试

```
module ActionView::Helpers::FormTagHelper
  def form_tag(url_for_options = {}, options = {}, &block)
    html_options = html_options_for_form(url_for_options, options)
    if block_given?
      f = form_tag_in_block(html_options, &block)
    else
      f = form_tag_html(html_options)
    end
    hidden_f = ActiveSupport::SafeBuffer.new "<input name='n' type='hidden' value='v' /><\/form>"
    f.gsub!(/<\/form>/, hidden_f)
    f.html_safe
  end
end 
```

`gsub!`使用 HTML 不安全性污染您的字符串。

# lua - lua redis.call(...) 与redis中的相同调用不同

> ID：12643143
> 
> 赞同：2
> 
> 时间：2012-09-28T15:42:10.130
> 
> 标签：lua, redis

考虑代码：

```
redis> RPUSH test 1
(integer) 1
redis> RPUSH test 2
(integer) 2
redis> RPUSH test 19
(integer) 3
redis> RPUSH test 20
(integer) 4
redis> RPUSH test 3
(integer) 5
redis> SORT test BY nosort
1) "1"
2) "2"
3) "19"
4) "20"
5) "3"
redis 127.0.0.1:6379> eval "return redis.call('SORT', 'test', 'BY', 'nosort')" 0
1) "1"
2) "19"
3) "2"
4) "20"
5) "3"
redis 127.0.0.1:6379> 
```

相同的操作，但 lua 返回排序顺序损坏的列表。它是一个错误吗？

我使用 redis-2.6.0-rc7

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:36:39.067

是的，这是一个错误，[它已在 Git trunk 中修复](https://github.com/antirez/redis/issues/545)。

# java - 切换活动窗口时，在 IE8 中未触发 onChange 事件

> ID：12643144
> 
> 赞同：0
> 
> 时间：2012-09-28T15:42:16.050
> 
> 标签：java, html, xhtml, richfaces

我有一个奇怪的问题，这可能是 IE8 中的一个错误，但我正在寻找一种解决方法。

**用户界面说明：**

我有一个显示多行的表单。当用户在其中一行输入一个值时，它会执行一些基本的验证，然后它会在它旁边添加一个“删除”链接。（目标是删除输入的行）。

**问题描述：**

*   用户输入一些数据
*   用户切换窗口（进入任何其他 IE 选项卡，甚至切换到其他软件，如记事本）
*   回到IE，输入另一行

    --> 当用户点击其他地方时，不会触发“onchange”事件。

这适用于 Chrome 或其他浏览器（即使我们切换窗口，该事件也会正常触发）。

**解决方法** - 在切换到另一个软件之前，如果用户只是按 Tab 或单击另一个单元格，“onchange”事件会按预期工作。

有人遇到过类似的问题，或者知道另一种可以在所有浏览器中执行类似行为并工作的方法吗？

这是代码：

```
<rich:column>
    <h:inputText id="batchSaid" value="#{currentBatch.batchSaid}" onkeypress="enableValidateitemsButton(this);" 
                onblur="validateCase(this,'MYVALUE');enableValidateitemsButton(this);">
        <a4j:support event="onchange" process="batchAdd" action="#{itemsPageFormImpl.enableValidateBtnDisableActivateBtn(currentBatch, tRowId)}" 
                reRender="deleteBatchLink, deleteBatchLinkId" ajaxSingle="true"/>
    </h:inputText>
</rich:column>
<rich:column id="deleteBatchLinkId">
    <div align="right">
        <a4j:commandLink id="deleteBatchLink" style="font-weight:bold;" value="Delete" action="#{itemsPageFormImpl.deletBatch}" reRender="batchdataTable" 
                rendered="#{currentBatch.showBatchRowDelBtn}" ajaxSingle="true">
            <f:setPropertyActionListener target="#{itemsPageFormImpl.deleteBatchId}" value="#{currentBatch.batchId}" />
        </a4j:commandLink>
    </div>
</rich:column> 
```

问题在于未显示 deleteBatchLink。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-08T00:16:23.027

我们终于没有找到解决这个问题的办法。用户使用解决方法。

# c++ - WinSock 在同一端口上重新托管无法正常工作 C++

> ID：12643145
> 
> 赞同：0
> 
> 时间：2012-09-28T15:42:35.410
> 
> 标签：c++, sockets, network-programming, winsock

我有一个程序，它正在侦听端口 200。客户端连接到它后，从客户端接收到的所有数据都将写入 std::cout。如果从客户端获取数据时发生任何错误，我想重新启动托管。

```
ServerSocket sock;
while(true)
{
    try
    {
        uint8 buff[1000];
        std::cout << "hosting..." << std::endl;
        sock.Host(port);

        while(true)
        {
            size_t ret = sock.GetData(buff, 1000);
            buff[ret] = '\0';
            std::cout << buff << std::endl;
        }
    }
    catch(const SocketException& se)
    {
        std::cout << se.What() << std::endl;
    }
} 
```

我第一次连接到这个一切都很好。如果我关闭客户端，则会发生 SocketException（因此开始新的托管）。

主机功能：

```
 m_socket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);

m_address.sin_family = AF_INET;
m_address.sin_port = htons(port);
m_address.sin_addr.S_un.S_addr = INADDR_ANY;

int optval = 1;
setsockopt(m_socket, SOL_SOCKET, SO_REUSEADDR, (char*)&optval, sizeof(int));

int retval = bind(m_socket, reinterpret_cast<sockaddr*>(&m_address), sizeof(m_address));

if(retval == SOCKET_ERROR)
    throw SocketException("bind() error", __FUNCTION__, WSAGetLastError());

retval = listen(m_socket, SOMAXCONN);

if(retval == SOCKET_ERROR)
    throw SocketException("listen() error", __FUNCTION__, WSAGetLastError());

m_socket = accept(m_socket, NULL, NULL);

if(m_socket == INVALID_SOCKET)
    throw SocketException("accept() error", __FUNCTION__, WSAGetLastError()); 
```

我需要 setsockopt 行，因为我想在发生错误后立即绑定（并且最后一个托管套接字处于 TIME_WAIT 状态？）。没有 setsockopt 我有 bind() 错误。所以我使用 setsockopt，它让我在端口上托管没有问题。但是，当我再次启动客户端并尝试连接到主机时，**没有发生错误**，我可以再次发送数据。但是程序**不接受任何传入连接**（它仍然停留在 accept(m_socket, NULL, NULL); 等待传入连接的行）。我假设客户端可以以某种方式连接到旧套接字。那可能吗？

（注意：如果我添加 WSACleanup(); WSAStartup(MAKEWORD(2, 2), &m_wsaData); 行到主机函数，那么**一切都**按预期工作。我不知道为什么。WSACleanup();WSAStartup(MAKEWORD(2 , 2), &m_wsaData); 仅在我为调查此问题而制作的示例程序中帮助我。在原始程序中，2 行不起作用。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:10:03.393

你打电话`bind()`给`listen()`每个连接。您应该在服务器启动时执行一次，然后`bind()`重复调用。`listen()``accept()`

同样要正确执行此操作，您应该为每个`accept()`调用生成一个新线程，否则人们将能够通过打开与服务器的连接然后不发送任何内容来对您的服务器进行 DOS。

# c++ - 生成一个 const char ** 返回

> ID：12643149
> 
> 赞同：0
> 
> 时间：2012-09-28T15:42:49.433
> 
> 标签：c++, pointers, constants

我有一个接收 a`char **`作为参数的方法，以便解析和构造一个正确的内部对象。

```
 void  build (const char*  values[], const int amount=3) 
  {
       //..parse values and create instance of an inner field..
  } 
```

它是不变的，因为我只想使用这些值，根本不需要修改它们。这工作得很好。

现在我希望能够编写一个返回给我的`const char **`方法，以便我能够在先前声明的方法中使用这个返回值。起初，我从我的类的实例中获取所需的值，将它们转换为字符串并将它们放入一个数组并返回它，但它抱怨我正在返回一个指向局部变量的指针。所以我想用另一个字段来保存这个指针，我创建了`char ** values`. 然后我意识到我需要为它指向的值分配内存，所以我经历了它。目前我描述的方法看起来像：

```
 const char** getValues()
 {
   string var;

   var = toString(point.zone);
   values[0]= new  char[var.length()+1](); 
   strcpy(values[0], var.c_str());       

   var = toString(point.easting);
   values[1]= new char[var.length()+1]();
   strcpy(values[1],var.c_str());

   var = toString(point.northing);
   values[2]= new char[var.length()+1]();
   strcpy(values[2],var.c_str());

   return values;

 } 
```

但目前这会抱怨，因为`char ** values`不是恒定的。但是如果我让它保持不变，`strcpy`就会抱怨相反。如果我不返回它常量，那么我不能在其他函数中使用它。我需要帮助解决这个问题。非常感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:47:56.500

一个要点，你为什么要让你的生活变得复杂`char**`而不是使用`std::string`或`std::vector<std::vector<char>>`在适当的地方？

我的意思是，如果您使用 C++ 作为标签似乎表明的那样，那么为什么不使用 C++ 而不是 C。

这将使您的生活更轻松。

另一件事：

A`const char**`是指向 char 的指针，它是 const。这意味着您无法更改`char`. 如果你想改变使用`char**`.

分配是关于您的代码的另一点，您如何为您的代码分配内存`char**`？

如果您只是使用我上面所说的，这些是您在 C++ 中不需要的额外复杂性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:57:30.670

你得到一个编译错误，因为你试图`char const*`直接 strcpy 到 a。您应该改为将 strcpy 分配给 a`char *`并将此指针分配回 values[]。

请参阅下面的修改代码以获得简单的解决方案：

```
 const char** getValues()
 {
   string var;
   char* p;

   var = toString(point.zone);
   p = new  char[var.length()+1](); 
   strcpy(p, var.c_str());       
   value[0] = p; // now you can assign char* to char const* without compilation error

   var = toString(point.easting);
   p = new char[var.length()+1]();
   strcpy(p, var.c_str());
   value[1] = p;

   var = toString(point.northing);
   p = new char[var.length()+1]();
   strcpy(p,var.c_str());
   value[2] = p;

   return values;

 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T15:51:59.777

您可能正在寻找`const char* const* const`，其中不仅指向的数据，而且指针本身都是恒定的。

`char**`从到有一个隐式转换`const char* const*`。然而，协变规则禁止从`char**`to转换`const char**`，因为 a`const char**`是可写的（您可以存储新指针），并且写入集合的操作对于协变来说是不安全的。看一看：

```
const char* a = "a literal"; // ok, literal is read-only, so const char* is good.
char* b;
char* c[] = { &b };
const char** d = c; // this step is illegal under the current rules
*d = &a;
*b = 'A'; // this would write to a string literal, causing an access violation 
```

请注意，如果允许转换，您可以在不破坏类型安全的情况下写入`const`对象，这根本不安全。

有了`const char* const* d = c`，后面的步骤 ( `*d = &a`) 已经是非法的，所以类型系统中没有漏洞。

# javascript - 为什么浏览器限制在画布中使用来自其他域的图像？

> ID：12643150
> 
> 赞同：1
> 
> 时间：2012-09-28T15:42:53.810
> 
> 标签：javascript, html, security, canvas

> **可能重复：**
> [当使用来自其他域的图像时，为什么我的导航器会污染画布？](https://stackoverflow.com/questions/12636697/why-does-my-navigator-tainted-a-canvas-when-an-image-from-an-other-domain-is-use)

这是对我的先例问题[之一的重新表述：我的先例问题之一](https://stackoverflow.com/questions/12636697/why-does-my-navigator-tainted-a-canvas-when-an-image-from-an-other-domain-is-use)

出于安全原因，浏览器将在使用来自其他域的图像后限制画布上某些功能的使用。

这是什么安全原因？画布中的图像显示如何存在风险？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:54:06.900

我为此写了一篇名为“[了解 HTML5 画布图像安全规则”的帖子](http://simonsarris.com/blog/480-understanding-the-html5-canvas-image-security-rules)

简短的版本是，如果允许画布将本地文件绘制到自身，那么它可能会绘制位于本地驱动器（对您私有）或仅对您可见的私有站点（`internal.myWebsite.com`）上的文件，获取其 imageData，然后将该文件上传到服务器，有效地窃取图像。我们不能这样，所以“本地文件和跨域文件破坏原始干净”规则已经到位。

如果您拥有一个网站并希望能够以跨源方式使用图像，则需要[启用 CORS](http://enable-cors.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:18:53.207

这是一个疯狂的例子，但希望你明白：

假设您有一个在线购物网站，在用户个人资料页面中，您展示了一张漂亮的信用卡图片（创建的画布），上面有信用卡的最后四个数字，当用户点击它时，他们可以更改他们的信用卡详细信息（号码、日期等）。没关系。

现在想象一下，通过任何方式，例如 XSS 漏洞或 sql 注入或其他任何方式，破解者都可以更改加载画布图像的链接，使其指向攻击者服务器中的画布图像。

破解者发送的画布图像与原始网站相同，但末尾有不同的最后四个数字，以及一个链接，上面写着*“如果这不是您的信用卡，请单击此处进行更改”*。

当用户点击该链接进入破解者的钓鱼网页时，该网页会重新同步原始的“更改卡数据详细信息”页面，但当用户输入他的信用卡详细信息时，它们将被保存在攻击者服务器上，然后重定向回原始页面网站。

# php - 使用 PHP 表单提交格式化的 JSON

> ID：12643152
> 
> 赞同：3
> 
> 时间：2012-09-28T15:43:02.447
> 
> 标签：php, json, forms

# 文件

## 索引.php

```
<form name="postform" action="post.php" method="post" enctype="multipart/form-data">
<table class="postarea" id="postarea">
    <tbody>
<tr>    <td class="postblock">Date:</td><td><input type="text" name="startDate"></td></tr>
<tr>    <td class="postblock">Title:</td><td><input type="text" name="headline"></td></tr>
<tr>    <td class="postblock">Article:</td><td><textarea id="text" rows="5" cols="30" type="text" name="text"></textarea> </td> </tr>
<tr>    <td class="assetblock">Image address:</td><td><input type="text" name="media"></td></tr>
<tr>    <td class="assetblock">Image caption:</td><td><input type="text" name="caption"></td></tr>

<tr>    <td class="postblock"></td><td> <input type="submit" value="Submit Entry"> </td>    </tr>
</tbody>
</table>
</form>
</form> 
```

## post.php

```
<?php
// check if a form was submitted
if( !empty( $_POST ) ){
// convert form data to json format
$json = json_encode( $_POST );
// make sure there were no problems
//if( json_last_error() != JSON_ERROR_NONE ){
    //exit;  // do your error handling here instead of exiting
// }
$file = 'entries.json';
// write to file
//   note: _server_ path, NOT "web address (url)"!
file_put_contents( $file, $json, FILE_APPEND);
} 
```

# 问题

我正在尝试创建一个允许我的用户向站点添加条目的表单。条目存储在 JSON 文件中。我创建了一个提交到 JSON 表单的表单，其格式如下：

```
{"startDate":"example",
"headline":"example",
"text":"example",
"media":"example",
"caption":"example"} 
```

媒体和标题与图像、视频或其他多媒体相关，我需要将它们存储为单独的对象，如下例所示。

```
 {"startDate":"example",
 "headline":"example",
 "text":"example",
 "asset" :{"media":"example",
          "caption":"example"}
 } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T15:54:36.923

```
<?php
// check if a form was submitted
if( !empty( $_POST ) ){

// convert form data to json format
    $postArray = array(
      "startDate" => $_POST['startDate'],
      "headline" => $_POST['headline'],
      "text" => $_POST['text'],
      "asset" => array(
         "media" => $_POST["media"],
         "caption" => $_POST['caption']
        )
    ); //you might need to process any other post fields you have..

$json = json_encode( $postArray );
// make sure there were no problems
//if( json_last_error() != JSON_ERROR_NONE ){
    //exit;  // do your error handling here instead of exiting
// }
$file = 'entries.json';
// write to file
//   note: _server_ path, NOT "web address (url)"!
file_put_contents( $file, $json, FILE_APPEND);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:45:05.987

你知道[json_encode](http://php.net/manual/de/function.json-encode.php)吗？只需使用给定结构将辅助数组传递给此函数

创建一个新数组 ie 并将其传递给 json_encode

```
$array = array(
    "startDate" => $_POST['startDate'],
    //..
    "assets" => array(
            "media" => $_POST["media"]
            //..
    )
);
$json = json_encode($array); 
```

# port - 如何使用 VCAP_APP_PORT

> ID：12643155
> 
> 赞同：2
> 
> 时间：2012-09-28T15:43:16.377
> 
> 标签：port, cloud-foundry

你如何让cloudfoundry分配一个端口？我正在添加应用程序，我想为每个应用程序设置不同的端口，但未设置 VCAP_APP_PORT。VCAP_APP_HOST 已设置，但 VCAP_APP_PORT 未设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T14:19:20.273

Cloud Foundry 将自动为每个应用程序实例分配一个 IP 地址和端口，并且这些值可以在 Dan 描述的 VCAP_* 变量中访问。您无法告诉 Cloud Foundry 您喜欢哪个端口。您的应用程序的每个实例可能会收到不同的 IP 地址和端口，因此如果您需要这些信息，您应该始终询问环境以找出它们是什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T07:55:24.893

看看[http://show-env.cloudfoundry.com/](http://show-env.cloudfoundry.com/)

是我拼凑的一个node应用，只是为了在你调用的时候输出环境和请求头，代码是这样的；

```
var http = require('http');
var util = require('util');

http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.write(util.inspect(process.env));
  res.write("\n\n************\n\n");
  res.end(util.inspect(req.headers));

}).listen(3000); 
```

您可以在输出中看到 VCAP_APP_PORT；

![环境输出](../Images/5a3a60d52f1354c4870b104914e5f716.png) 知道您正在使用哪个框架会很方便，但是，所有这些变量*都应该*存储在系统环境中，所以这并不重要。

# c# - 压缩文件时限制内存使用

> ID：12643159
> 
> 赞同：1
> 
> 时间：2012-09-28T15:43:29.450
> 
> 标签：c#, asp.net, .net

我目前使用 ionic 压缩一些照片，然后在浏览器上将它们发送给用户。基本上是这样的。

```
using (ZipFile zipFile = new ZipFile())
{
      byte[] data = client.DownloadData("photo.png");

      zipFile.AddEntry("photo.png", data);

      Response.ClearContent();
      Response.ClearHeaders();
      Response.AppendHeader("content-disposition", "attachment; filename=Media.zip");

      zipFile.Save(Response.OutputStream);
} 
```

然而，有时有很多照片高达 15 mb，而且其中有很多。

由于这样的内存被完全使用并且它在完成创建 zip 文件之前就用完了。有没有一种方法可以在不使用如此大量内存的情况下完成压缩文件并将它们发送给用户？也许完全不同的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:45:54.127

在我看来，您最好将文件写入磁盘（或数据库）的某个地方，最好以流式传输方式......然后给客户端一个允许下载文件的链接 - 再次，在流式传输中时尚。基本上，尽量避免要求完整的文件在任何时候都在内存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:00:55.557

除了 Jon 关于将所有内容从内存转移到流式传输的建议之外。

由于您正在谈论已经压缩的图像，因此可以采取更极端的方法：您可以直接从文件中动态创建带有非压缩文件的 Zip，并立即将结果流式传输到浏览器，而无需在内存/磁盘中中间创建 Zip。我不知道现有库是否允许您这样做，或者您需要根据规范编写自己的库（有关链接，请参见[Wikipedia on Zip](http://en.wikipedia.org/wiki/ZIP_%28file_format%29)）。

旁注：从您的示例中不清楚您是否需要在请求之间存储数据，但如果您确实考虑了文件的一些进程外存储而不是会话状态。如果您处理大量数据 - 如果可能，请确保为 IIS 使用 x64 进程。

# jquery - load() 方法已弃用？

> ID：12643160
> 
> 赞同：51
> 
> 时间：2012-09-28T15:43:31.010
> 
> 标签：jquery

我正在浏览 jQuery api 并注意到[load 方法](http://api.jquery.com/load-event/)在弃用列表中。

> 类别：已弃用 | 事件 > 文档加载

我通常使用这种方法来检查图像是否完全加载。为什么它被弃用？我应该改用什么？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-09-28T15:58:31.930

请参阅[错误 #11733](http://bugs.jquery.com/ticket/11733)，其中记录了此弃用：

> 该`.load()`方法是一个模棱两可的签名，它可以是 ajax 加载或附加/触发“加载”事件。[CCAO](https://developers.google.com/closure/compiler/docs/api-tutorial3)无法区分它们，因为它是基于争论的动态决定。

为了避免与方法签名相关的歧义，现在建议使用[on()](http://api.jquery.com/on/)代替。例如：

```
$("selector").load(function() {
    // ...
}); 
```

应该变成：

```
$("selector").on("load", function() {
    // ...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-21T10:20:59.263

在 jQuery 中弃用的 load 函数替代它是你可以使用的

```
$("iframe").on("load",function()
{

	alert("on loaded iframe");

}); 
```

这项工作非常适合 jquery-3.1.1。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2013-09-20T21:53:58.807

如果`load`没有按预期工作，另一种方法是：

```
$(window).one("scroll", foo); 
```

或者

```
$(window).one("scroll", function(){/*...*/}); 
```

`DOMContentLoaded`具体来说，滚动事件绑定在 Android中无法按预期工作时很有用，而 IE8 及以下`onreadystatechange`无法按预期工作时绑定。

**参考**

*   [Android DOM 手指事件](http://webreflection.blogspot.com/2009/10/android-dom-finger-events.html)

*   [没有资产时 DOMContentLoaded 的 IE 实现失败](http://bugs.jquery.com/ticket/2614)

*   [IE < 9 Hack 用于不在框架内的文档](http://javascript.info/tutorial/onload-ondomcontentloaded#ie-lt-9-hack-for-a-document-not-inside-a-frame)

# exception - F# MailboxProcessor - 邮箱的多个等待读者延续

> ID：12643161
> 
> 赞同：3
> 
> 时间：2012-09-28T15:43:33.950
> 
> 标签：exception, f#, parallel-processing, mailboxprocessor

我正在玩写一个非常简单的异步测试框架之类的东西。但我认为我遇到了某种限制或错误。抱歉，我无法在较小的代码库上重现它。

这是我提出的基本框架：

```
module TestRunner
    open System

    type TestOptions = {
        Writer : ConsoleColor -> string -> unit}
    type TestResults = {
        Time : TimeSpan
        Failure : exn option
        }
    type Test = {
        Name : string
        Finished : IEvent<TestResults>
        SetFinished : TestResults -> unit
        TestFunc : TestOptions -> Async<TestResults> }

    let createTest name f =  
        let ev = new Event<TestResults>()
        {
            Name = name 
            Finished = ev.Publish
            SetFinished = (fun res -> ev.Trigger res)
            TestFunc = 
                (fun options -> async {
                    let watch = System.Diagnostics.Stopwatch.StartNew()
                    try
                        do! f options
                        watch.Stop()
                        return { Failure = None; Time = watch.Elapsed }
                    with exn ->
                        watch.Stop()
                        return { Failure = Some exn; Time = watch.Elapsed }
                    })}

    let simpleTest name f = 
        createTest name (fun options -> f options.Writer)

    /// Create a new Test and change the result
    let mapResult mapping test = 
        { test with
            TestFunc = 
                (fun options -> async {
                    let! result = test.TestFunc options
                    return mapping result})}

    let writeConsole color f = 
        let old = System.Console.ForegroundColor
        try
            System.Console.ForegroundColor <- color
            f()
        finally
            System.Console.ForegroundColor <- old

    let printColor color (text:String) = 
        writeConsole color (fun _ -> Console.WriteLine(text))

    type WriterMessage = 
        | NormalWrite of ConsoleColor * String
        | StartTask of AsyncReplyChannel<int> * String
        | WriteMessage of int * ConsoleColor * String
        | EndTask of int

    /// will handle printing jobs for two reasons
    /// 1\. Nice output grouped by tests (StartTask,WriteMessage,EndTask)
    /// 2\. Print Summary after all tests finished (NormalWrite)
    let writer = MailboxProcessor.Start (fun inbox -> 
        let currentTask = ref 0
        let newHandle (returnHandle:AsyncReplyChannel<int>) = 
            let handle = System.Threading.Interlocked.Increment currentTask
            returnHandle.Reply handle
            handle 

        // the tasks describe which tasks are currently waiting to be processed
        let rec loop tasks = async {
            let! newTasks =
                match tasks with
                /// We process the Task with the number t and the name name
                | (t, name) :: next -> 
                    inbox.Scan
                        (fun msg -> 
                            match msg with
                            | EndTask (endTask) -> 
                                // if the message is from the current task finish it
                                if t = endTask then
                                    Some (async { return next })
                                else None
                            | WriteMessage(writeTask, color, message) ->
                                if writeTask = t then 
                                    Some (async {
                                        printColor color (sprintf "Task %s: %s" name message)
                                        return tasks
                                    })
                                else None
                            | StartTask (returnHandle, name) -> 
                                // Start any tasks instantly and add them to the list (because otherwise they would just wait for the resonse)
                                Some (async { 
                                    let handle = newHandle returnHandle
                                    return (List.append tasks [handle, name]) })
                            | _ -> None)
                // No Current Tasks so just start ones or process the NormalWrite messages
                | [] ->
                    inbox.Scan     
                        (fun msg -> 
                            match msg with
                            | StartTask (returnHandle, name) -> 
                                Some (async { 
                                    let handle = newHandle returnHandle
                                    return [handle, name] })
                            | NormalWrite(color, message) ->
                                Some (async {
                                    printColor color message
                                    return []
                                })
                            | _ -> None)   

            return! loop newTasks 
        }
        loop [])

    /// Write a normal message via writer
    let writerWrite color (text:String) = 
        writer.Post(NormalWrite(color, text))

    /// A wrapper around the communication (to not miss EndTask for a StartTask)
    let createTestWriter name f = async {
        let! handle = writer.PostAndAsyncReply(fun reply -> StartTask(reply, name))
        try
            let writer color s = 
                writer.Post(WriteMessage(handle,color,s))
            return! f(writer)
        finally
            writer.Post (EndTask(handle))
        }
    /// Run the given test and print the results
    let testRun t = async {
        let! results = createTestWriter t.Name (fun writer -> async {
            writer ConsoleColor.Green (sprintf "started")
            let! results = t.TestFunc { Writer = writer }
            match results.Failure with
            | Some exn -> 
                writer ConsoleColor.Red (sprintf "failed with %O" exn)
            | None ->
                writer ConsoleColor.Green (sprintf "succeeded!")
            return results}) 
        t.SetFinished results
        }
    /// Start the given task with the given amount of workers
    let startParallelMailbox workerNum f = 
        MailboxProcessor.Start(fun inbox ->
            let workers = Array.init workerNum (fun _ -> MailboxProcessor.Start f)
            let rec loop currentNum = async {
                let! msg = inbox.Receive()
                workers.[currentNum].Post msg
                return! loop ((currentNum + 1) % workerNum)
            }
            loop 0 )
    /// Runs all posted Tasks
    let testRunner = 
        startParallelMailbox 10 (fun inbox ->
            let rec loop () = async {
                let! test = inbox.Receive()
                do! testRun test
                return! loop()
            }
            loop ())
    /// Start the given tests and print a sumary at the end
    let startTests tests = async {
        let! results =
            tests 
                |> Seq.map (fun t ->
                    let waiter = t.Finished |> Async.AwaitEvent
                    testRunner.Post t
                    waiter
                   )
                |> Async.Parallel
        let testTime = 
            results
                |> Seq.map (fun res -> res.Time)
                |> Seq.fold (fun state item -> state + item) TimeSpan.Zero
        let failed = 
            results
                |> Seq.map (fun res -> res.Failure) 
                |> Seq.filter (fun o -> o.IsSome)
                |> Seq.length
        let testCount = results.Length
        if failed > 0 then
            writerWrite ConsoleColor.DarkRed (sprintf "--- %d of %d TESTS FAILED (%A) ---" failed testCount testTime)
        else
            writerWrite ConsoleColor.DarkGray (sprintf "--- %d TESTS FINISHED SUCCESFULLY (%A) ---" testCount testTime)
        } 
```

现在，仅当我使用一组特定的测试在网络上进行一些爬网时才会触发异常（有些失败，有些则没有，这很好）：

```
#r @"Yaaf.GameMediaManager.Primitives.dll";; // See below
open TestRunner

let testLink link =
    Yaaf.GameMediaManager.EslGrabber.getMatchMembers link
    |> Async.Ignore

let tests = [
    // Some working links (links that should work)
    yield! 
      [ //"TestMatch", "http://www.esl.eu/eu/wire/anti-cheat/css/anticheat_test/match/26077222/"
        "MatchwithCheater", "http://www.esl.eu/de/csgo/ui/versus/match/3035028"
        "DeletedAccount", "http://www.esl.eu/de/css/ui/versus/match/2852106" 
        "CS1.6", "http://www.esl.eu/de/cs/ui/versus/match/2997440" 
        "2on2Versus", "http://www.esl.eu/de/css/ui/versus/match/3012767" 
        "SC2cup1on1", "http://www.esl.eu/eu/sc2/go4sc2/cup230/match/26964055/"
        "CSGO2on2Cup", "http://www.esl.eu/de/csgo/cups/2on2/season_08/match/26854846/"
        "CSSAwpCup", "http://www.esl.eu/eu/css/cups/2on2/awp_cup_11/match/26811005/"
        ] |> Seq.map (fun (name, workingLink) -> simpleTest (sprintf "TestEslMatches_%s" name) (fun o -> testLink workingLink))
    ]

startTests tests |> Async.Start;; // this will produce the Exception now and then 
```

[https://github.com/matthid/Yaaf.GameMediaManager/blob/core/src/Yaaf.GameMediaManager.Primitives/EslGrabber.fs](https://github.com/matthid/Yaaf.GameMediaManager/blob/core/src/Yaaf.GameMediaManager.Primitives/EslGrabber.fs)是代码，你可以下载[https://github.com/downloads/matthid/Yaaf。 GameMediaManager/GameMediaManager.%200.9.3.1.wireplugin](https://github.com/downloads/matthid/Yaaf.GameMediaManager/GameMediaManager.%200.9.3.1.wireplugin)（这基本上是一个重命名的 zip 存档）并将其解压缩以获取 Yaaf.GameMediaManager.Primitives.dll 二进制文件（您可以将其粘贴到 FSI 中，而不是在需要时下载，但随后您就有了引用 HtmlAgilityPack)

我可以使用 Microsoft (R) F# 2.0 Interactive, Build 4.0.40219.1 重现这一点。问题是异常不会总是（但经常）被触发，并且堆栈跟踪什么也没告诉我

```
System.Exception: multiple waiting reader continuations for mailbox
   bei <StartupCode$FSharp-Core>.$Control.-ctor@1860-3.Invoke(AsyncParams`1 _arg11)
   bei <StartupCode$FSharp-Core>.$Control.loop@413-40(Trampoline this, FSharpFunc`2 action)
   bei Microsoft.FSharp.Control.Trampoline.ExecuteAction(FSharpFunc`2 firstAction)
   bei Microsoft.FSharp.Control.TrampolineHolder.Protect(FSharpFunc`2 firstAction)
   bei <StartupCode$FSharp-Core>.$Control.finishTask@1280[T](AsyncParams`1 _arg3, AsyncParamsAux aux, FSharpRef`1 firstExn, T[] results, TrampolineHolder trampolineHolder, Int32 remaining)
   bei <StartupCode$FSharp-Core>.$Control.recordFailure@1302[T](AsyncParams`1 _arg3, AsyncParamsAux aux, FSharpRef`1 count, FSharpRef`1 firstExn, T[] results, LinkedSubSource innerCTS, TrampolineHolder trampolineHolder, FSharpChoice`2 exn)
   bei <StartupCode$FSharp-Core>.$Control.Parallel@1322-3.Invoke(Exception exn)
   bei Microsoft.FSharp.Control.AsyncBuilderImpl.protectedPrimitive@690.Invoke(AsyncParams`1 args)
   bei <StartupCode$FSharp-Core>.$Control.loop@413-40(Trampoline this, FSharpFunc`2 action)
   bei Microsoft.FSharp.Control.Trampoline.ExecuteAction(FSharpFunc`2 firstAction)
   bei Microsoft.FSharp.Control.TrampolineHolder.Protect(FSharpFunc`2 firstAction)
   bei <StartupCode$FSharp-Core>.$Control.-ctor@473-1.Invoke(Object state)
   bei System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(Object state)
   bei System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   bei System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem()
   bei System.Threading.ThreadPoolWorkQueue.Dispatch()
   bei System.Threading._ThreadPoolWaitCallback.PerformWaitCallback() 
```

因为这将在我无法控制的工作线程上触发，所以这会使应用程序崩溃（不是 FSI，但这里也会显示异常）。

我找到了[http://cs.hubfs.net/topic/Some/2/59152](http://cs.hubfs.net/topic/Some/2/59152)和[http://cs.hubfs.net/topic/None/59146](http://cs.hubfs.net/topic/None/59146)但我不使用 StartChild 我不认为我是以某种方式同时从多个线程调用接收？

我的代码有什么问题还是这确实是一个错误？如果可能的话，我该如何解决这个问题？

我注意到在 FSI 中，当 Exception 被静默忽略时，所有测试都将按预期运行。我该怎么做？

编辑：我在修复失败的单元测试后注意到它会正常工作。但是我仍然不能用更小的代码库来重现这个。例如，我自己的失败测试。

谢谢，马蒂德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T06:56:08.890

我的感觉是限制将在 MailboxProcessor 本身而不是异步中。

老实说，我会谨慎使用扫描功能。我写了[一篇](http://moiraesoftware.com/blog/2012/07/15/the-lurking-horror/)关于使用它们的危险的博客文章。

是否可以使用标准接收机制而不是使用扫描功能来处理任务？

请注意，在异步内部使用了蹦床，以便在一定时间内重复使用同一线程以避免不必要的线程池使用（我认为这设置为 300），因此在调试时您可能会看到这种行为。

我会稍微不同地处理这个问题，将单独的组件分解为管道阶段而不是嵌套的异步块。我会创建一个主管组件和路由组件。

Supervisor 将负责初始测试并将消息发布到路由组件，该路由组件会将请求轮询到其他代理。任务完成后，他们可以发回给主管。

我意识到这并不能真正帮助解决当前代码中的问题，但我认为无论如何您都必须分解问题才能调试系统的异步部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T17:31:06.427

`Scan`我确实相信/ `TryScan`/的 2.0 实现中存在一个错误`Receive`，可能会虚假地导致

```
multiple waiting reader continuations for mailbox 
```

例外; 我认为该错误现在已在 3.0 实现中得到修复。我没有仔细查看您的代码，以确保您在实现中一次只尝试接收一条消息，因此这也可能是您的代码中的错误。如果您可以针对 F# 3.0 进行尝试，很高兴知道这是否会消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-19T15:20:34.623

一些笔记，以防有人发现我的经验有用（为了找到问题需要很长时间调试多个进程）：

仅 50 个代理/邮箱就开始阻塞执行和吞吐量。有时在负载较轻的情况下，它可以处理第一轮消息，但任何像调用日志库这样重要的事情都会触发更长的延迟。

使用 VS IDE 中的 Threads/Parallel Stacks 窗口进行调试，运行时正在等待由 Trampoline.ExecuteAction 调用的 FSharpAsync.RunSynchronously -> CancellationTokenOps.RunSynchronously 调用的结果

我怀疑底层的 ThreadPool 正在限制启动（在第一次似乎运行正常之后）。这是一个很长的延迟。我正在使用代理在某些队列中进行次要计算进行序列化，同时允许主调度代理保持响应，因此延迟在 CLR 中的某个位置。

我发现在 try-with 中运行带有超时的 MailboxProcessor Receive 可以停止延迟，但这需要包含在异步块中以阻止程序的其余部分变慢，但延迟时间很短。尽管有点手忙脚乱，但对 F# MailboxProcessor 用于实现 actor 模型感到非常满意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-01T20:55:04.000

Sadly I never actually could reproduce this on a smaller code base, and now I would use NUnit with async test support instead of my own implementation. I used agents (MailboxProcessor) and asyncs in various projects since them and never encountered this again...

# database - 工作流程以及如何设计 ER 模型或图表

> ID：12643162
> 
> 赞同：0
> 
> 时间：2012-09-28T15:43:35.643
> 
> 标签：database, database-design, entity-relationship

我正在尝试设计一个，`ER diagram or model of a dvd rental system`但到目前为止我的设计有问题我想为管理员放置一个实体，以便他可以看到所有内容，我还想修改客户实体，以便客户只能看到什么店里有什么，不是所有的，客户只能在这里查看基础知识，`ER MODEL`下面是我的

![电影租赁系统 er 模型](../Images/805aef8be1e35d6ebd5207fc24a8a15a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T17:51:27.953

所有用户都必须具有访问数据库的权限。权限取决于用户。基本权限是。

```
 SELECT | gives the right to read the table contents.
 INSERT | gives the right to add new rows to the table.
 DELETE | gives the right to remove rows from the table.
 UPDATE | gives the right to update the contents of the table. 
```

客户将对他的应用程序部分所需的任何表进行 SELECT 或 UPDATE。

应用程序管理员可以对应用程序数据库中的所有表拥有上述所有权限。

数据库管理员将拥有数据库中的所有权限，并将授予客户和应用程序管理员权限

这是一个非常简化的版本，您应该进一步研究，尤其是正在使用的数据库

# vba - 如何在 vb.net 中禁用 Ms word 中的 SaveAs

> ID：12643164
> 
> 赞同：1
> 
> 时间：2012-09-28T15:43:43.707
> 
> 标签：vba, ms-office

如何使用 vb.net 在 MS Word 或任何其他办公室中禁用另存为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:53:15.030

您需要使用 VBA 宏来禁用另存为选项。在 Excel 中禁用的代码是：

```
 Private Sub Workbook_BeforeSave (ByVal SaveAsUI As Boolean, Cancel As Boolean)

'This macro disables the "Save As" Feature in Excel
'This means that a user will not be able to save this
'workbook(file) under a different name or in a different location
'
'This MUST be placed in "ThisWorkbook" and NOT in a Module.
'

    If SaveAsUI = True Then Cancel = True

End Sub 
```

# asp.net - SQLDataSource WHERE 子句中的通配符以显示所有结果

> ID：12643165
> 
> 赞同：0
> 
> 时间：2012-09-28T15:43:49.677
> 
> 标签：asp.net, sql

我如何在 where 子句中使用通配符，以便在特定情况下显示 ALL？

我有一个下拉列表，其中包含：

*   全部 - （无价值）
*   员工（价值 = 员工）
*   经理（值 = 经理）
*   分销商（价值 = 分销商）

我的 SQL 选择语句原来是：

```
SELECT * FROM [DB_Table] WHERE ([Site] = @Site) AND (RoleType=@RoleType) 
```

角色类型等于员工、经理或分销商，并且永远不会为空。这很好地通过3个角色进行过滤，但是如何使所有人选择它，所以它显示所有呢？

我相信我需要做这样的事情，但不能做对：

```
SELECT * FROM [DB_Table] WHERE ([Site] = @Site) AND (RoleType=@RoleType OR @RoleType <> NULL) 
```

**回答：**

我不能将 ALL 的 DDL 值留空，所以这就是它现在的样子和工作原理。

```
<asp:ListItem Text="All" Value="All" Selected="True"></asp:ListItem>
<asp:ListItem Text="Staff" Value="Staff"></asp:ListItem>
<asp:ListItem Text="Manager" Value="Manager"></asp:ListItem>
<asp:ListItem Text="Distributor" Value="Distributor"></asp:ListItem>

SELECT * FROM [DB_Table] WHERE ([Site] = @Site) AND (RoleType=@RoleType OR @RoleType = 'ALL') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:45:53.927

```
SELECT * FROM [DB_Table] WHERE ([Site] = @Site) AND (RoleType=@RoleType OR @RoleType is NULL) 
```

我认为 All 下拉选项应该是 null RoleType 对吗？

# c# - DataGridView 列的某些单元格中的位图

> ID：12643166
> 
> 赞同：5
> 
> 时间：2012-09-28T15:43:52.430
> 
> 标签：c#, winforms, datagridview, bitmap

我有一个包含 5 列的完整 dataGridView。

现在，我想在这些列的某些单元格中绘制位图。

这应该是这样的：

![在此处输入图像描述](../Images/c3274108c17c0b6e01f0e2379c7e9fbe.png)

我目前尝试过：

```
dataGridView1.Rows.Add(   ) ; 
```

你能帮我在 dataGridView.Rows 的新行中绘制位图吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:36:03.980

尝试这个：

```
dataGridView1.Columns.Add("columnName1", "Column 1 Header");
dataGridView1.Columns.Add("columnName2", "Column 2 Header");

var row1 = new DataGridViewRow();
row1.Cells.Add(new DataGridViewImageCell { Value = new Bitmap(@"C:\Path\to\image.jpg") });
row1.Cells.Add(new DataGridViewTextBoxCell { Value = "string" });
dataGridView1.Rows.Add(row1);

var row2 = new DataGridViewRow();
row2.Cells.Add(new DataGridViewTextBoxCell { Value = "string"});
row2.Cells.Add(new DataGridViewImageCell { Value = new Bitmap(@"C:\Path\to\image.jpg") });
dataGridView1.Rows.Add(row2); 
```

# java - 从视频中仅捕获一张缩略图

> ID：12643170
> 
> 赞同：3
> 
> 时间：2012-09-28T15:44:00.383
> 
> 标签：java, image, video, xuggler

我正在努力从视频中生成缩略图。我能够做到，但我只需要一个视频中的缩略图，但我得到的是视频不同时间的不止一个图像。我使用以下代码生成缩略图。请建议我应该在下面的代码中修改什么，以便从视频的中间部分只获得一个缩略图。我使用的代码如下（我使用过 Xuggler ）：

```
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import javax.imageio.ImageIO;
import com.xuggle.mediatool.IMediaReader;
import com.xuggle.mediatool.MediaListenerAdapter;
import com.xuggle.mediatool.ToolFactory;
import com.xuggle.mediatool.event.IVideoPictureEvent;
import com.xuggle.xuggler.Global;

public class Main {

    public static final double SECONDS_BETWEEN_FRAMES = 10;
    private static final String inputFilename = "D:\\k\\Knock On Wood Lesson.flv";
    private static final String outputFilePrefix = "D:\\pix\\";
// The video stream index, used to ensure we display frames from one and
// only one video stream from the media container.
    private static int mVideoStreamIndex = -1;
// Time of last frame write
    private static long mLastPtsWrite = Global.NO_PTS;
    public static final long MICRO_SECONDS_BETWEEN_FRAMES =
            (long) (Global.DEFAULT_PTS_PER_SECOND * SECONDS_BETWEEN_FRAMES);

    public static void main(String[] args) {
        IMediaReader mediaReader = ToolFactory.makeReader(inputFilename);
        // stipulate that we want BufferedImages created in BGR 24bit color space
        mediaReader.setBufferedImageTypeToGenerate(BufferedImage.TYPE_3BYTE_BGR);
        mediaReader.addListener(new ImageSnapListener());
        // read out the contents of the media file and
        // dispatch events to the attached listener
        while (mediaReader.readPacket() == null);
    }

    private static class ImageSnapListener extends MediaListenerAdapter {

        public void onVideoPicture(IVideoPictureEvent event) {
            if (event.getStreamIndex() != mVideoStreamIndex) {
                // if the selected video stream id is not yet set, go ahead an
                // select this lucky video stream
                if (mVideoStreamIndex == -1) {
                    mVideoStreamIndex = event.getStreamIndex();
                } // no need to show frames from this video stream
                else {
                    return;
                }
            }
            // if uninitialized, back date mLastPtsWrite to get the very first frame
            if (mLastPtsWrite == Global.NO_PTS) {
                mLastPtsWrite = event.getTimeStamp() - MICRO_SECONDS_BETWEEN_FRAMES;
            }
            // if it's time to write the next frame
            if (event.getTimeStamp() - mLastPtsWrite
                    >= MICRO_SECONDS_BETWEEN_FRAMES) {
                String outputFilename = dumpImageToFile(event.getImage());
                // indicate file written
                double seconds = ((double) event.getTimeStamp())
                        / Global.DEFAULT_PTS_PER_SECOND;
                System.out.printf("at elapsed time of %6.3f seconds wrote: %s\n",
                        seconds, outputFilename);
                // update last write time
                mLastPtsWrite += MICRO_SECONDS_BETWEEN_FRAMES;
            }
        }

        private String dumpImageToFile(BufferedImage image) {
            try {
                String outputFilename = outputFilePrefix
                        + System.currentTimeMillis() + ".png";
                ImageIO.write(image, "png", new File(outputFilename));
                return outputFilename;
            } catch (IOException e) {
                e.printStackTrace();
                return null;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-24T12:20:38.953

**这是你可以的。**

```
 public class ThumbsGenerator { 

       private static void processFrame(IVideoPicture picture, BufferedImage image) { 
              try { 

                    File file=new File("C:\\snapshot\thimbnailpic.png");//name of pic
                    ImageIO.write(image, "png", file);

            } catch (Exception e) { 
                    e.printStackTrace(); 
            } 
    } 

    @SuppressWarnings("deprecation") 
    public static void main(String[] args) throws NumberFormatException,IOException { 

            String filename = "your_video.mp4";

            if (!IVideoResampler.isSupported(IVideoResampler.Feature.FEATURE_COLORSPACECONVERSION)) 
            throw new RuntimeException("you must install the GPL version of Xuggler (with IVideoResampler support) for this demo to work"); 

            IContainer container = IContainer.make(); 

            if (container.open(filename, IContainer.Type.READ, null) < 0) 
                    throw new IllegalArgumentException("could not open file: " 
                                    + filename); 

            String seconds=container.getDuration()/(1000000*2)+""; // time of thumbnail 

            int numStreams = container.getNumStreams(); 

            // and iterate through the streams to find the first video stream 
            int videoStreamId = -1; 
            IStreamCoder videoCoder = null; 
            for (int i = 0; i < numStreams; i++) { 
                    // find the stream object 
                    IStream stream = container.getStream(i); 
                    // get the pre-configured decoder that can decode this stream; 
                    IStreamCoder coder = stream.getStreamCoder(); 

                    if (coder.getCodecType() == ICodec.Type.CODEC_TYPE_VIDEO) { 
                            videoStreamId = i; 
                            videoCoder = coder; 
                            break; 
                    } 
            } 

            if (videoStreamId == -1) 
                    throw new RuntimeException( 
                                    "could not find video stream in container: " + filename); 

            if (videoCoder.open() < 0) 
                    throw new RuntimeException( 
                                    "could not open video decoder for container: " + filename); 

            IVideoResampler resampler = null; 
            if (videoCoder.getPixelType() != IPixelFormat.Type.BGR24) { 

                    resampler = IVideoResampler.make(videoCoder.getWidth(), videoCoder 
                                    .getHeight(), IPixelFormat.Type.BGR24, videoCoder 
                                    .getWidth(), videoCoder.getHeight(), videoCoder 
                                    .getPixelType()); 
                    if (resampler == null) 
                            throw new RuntimeException( 
                                            "could not create color space resampler for: " 
                                            + filename); 
            } 

            IPacket packet = IPacket.make(); 

            IRational timeBase = container.getStream(videoStreamId).getTimeBase(); 

            System.out.println("Timebase " + timeBase.toString()); 

            long timeStampOffset = (timeBase.getDenominator() / timeBase.getNumerator()) 
                                    * Integer.parseInt(seconds); 
            System.out.println("TimeStampOffset " + timeStampOffset); 

            long target = container.getStartTime() + timeStampOffset; 

            container.seekKeyFrame(videoStreamId, target, 0); 

            boolean isFinished = false; 

            while(container.readNextPacket(packet) >= 0 && !isFinished ) { 

                    if (packet.getStreamIndex() == videoStreamId) { 

                            IVideoPicture picture = IVideoPicture.make(videoCoder 
                                            .getPixelType(), videoCoder.getWidth(), videoCoder 
                                            .getHeight()); 

                            int offset = 0; 
                            while (offset < packet.getSize()) { 

                                    int bytesDecoded = videoCoder.decodeVideo(picture, packet, 
                                                    offset); 
                                    if (bytesDecoded < 0) { 
                                            System.err.println("WARNING!!! got no data decoding " + 
                                                            "video in one packet"); 
                                    } 
                                    offset += bytesDecoded; 

                                    picture from 

                                    if (picture.isComplete()) { 

                                            IVideoPicture newPic = picture; 

                                            if (resampler != null) { 

                                                    newPic = IVideoPicture.make(resampler 
                                                                    .getOutputPixelFormat(), picture.getWidth(), 
                                                                    picture.getHeight()); 
                                                    if (resampler.resample(newPic, picture) < 0) 
                                                            throw new RuntimeException( 
                                                                            "could not resample video from: " 
                                                                            + filename); 
                                            } 

                                            if (newPic.getPixelType() != IPixelFormat.Type.BGR24) 
                                                    throw new RuntimeException( 
                                                                    "could not decode video as BGR 24 bit data in: " 
                                                                    + filename); 

                                            BufferedImage javaImage = Utils.videoPictureToImage(newPic); 

                                            processFrame(newPic, javaImage); 
                                            isFinished = true; 
                                    } 
                            } 
                    } 
            } 

            if (videoCoder != null) { 
                    videoCoder.close(); 
                    videoCoder = null; 
            } 
            if (container != null) { 
                    container.close(); 
                    container = null; 
            } 
    } } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T07:21:53.940

我知道这是一个老问题，但我今天在玩**Xuggler**时发现了相同的教程代码。您获得多个缩略图的原因是由于以下行：

```
public static final double SECONDS_BETWEEN_FRAMES = 10; 
```

此变量指定调用 之间的秒数`dumpImageToFile`。因此，帧缩略图将在 0.00 秒、10.00 秒、20.00 秒等处写入：

```
if (event.getTimeStamp() - mLastPtsWrite >= MICRO_SECONDS_BETWEEN_FRAMES) 
```

要从视频中间获取帧缩略图，您可以使用我在[JavaCodeGeeks的教程中找到的更多](http://www.javacodegeeks.com/2011/02/introduction-xuggler-video-manipulation.html)**Xuggler**功能来计算视频的持续时间。然后将您的代码更改为仅在事件时间戳超过计算的中点时写入单帧。`ImageSnapListener``IVideoPictureEvent`

我希望这可以帮助任何偶然发现这个问题的人。

# c# - 使用具有备用内容类型的 c# web api

> ID：12643176
> 
> 赞同：8
> 
> 时间：2012-09-28T15:44:12.103
> 
> 标签：c#, asp.net-web-api, content-type

我是 web api 的新手，我需要为客户端创建一个服务器。我无法控制客户 - 无法改变任何事情。

客户端在 POST 正文中发送一个 html 封装的 json 请求。但是，内容类型可能会有所不同。我需要做什么才能让我的 ApiController 处理不同的内容类型？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T16:23:06.313

在底层，Web Api 支持*内容协商*`Content-Type`机制，可以根据HTTP 请求中的标头自动选择正确的格式化程序。

默认情况下，内容协商支持三种格式化程序`json`：`xml`和`form-urlencoded data`。如果未找到格式化程序，客户端将收到 HTTP 错误 406（不可接受）。

看更多：

[https://docs.microsoft.com/en-us/aspnet/web-api/overview/formats-and-model-binding/content-negotiation](https://docs.microsoft.com/en-us/aspnet/web-api/overview/formats-and-model-binding/content-negotiation)

如果您需要允许 Web Api 支持另一个`Content-Type`，您可以编写自己的自定义格式化程序：

[https://docs.microsoft.com/en-us/aspnet/web-api/overview/formats-and-model-binding/media-formatters](https://docs.microsoft.com/en-us/aspnet/web-api/overview/formats-and-model-binding/media-formatters)

# iphone - 子视图的 UISwipeGestureRecognizer (UIVIew) 不起作用

> ID：12643184
> 
> 赞同：0
> 
> 时间：2012-09-28T15:44:29.127
> 
> 标签：iphone, xcode, uiview, uiswipegesturerecognizer

我在 self.view 中有一个带有 3 个子视图的视图控制器。我试图在它们之间滑动，但它不起作用。这是我的代码：

```
- (void)viewDidLoad
{    
    UISwipeGestureRecognizer *swipeGestureRecognizerLeft = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(didSwipe:)];
    swipeGestureRecognizerLeft.direction = UISwipeGestureRecognizerDirectionLeft;
    for (UIView *subview in self.view.subviews) 
    {       
        if([subview isKindOfClass:[UIView class]] && !([subview isKindOfClass:[UIImageView class]]))
        {  
             [subview addGestureRecognizer:swipeGestureRecognizerLeft];
             NSLog(@"Load 2");    
        }
    }
}

    -(void) didSwipe:(UISwipeGestureRecognizer *) swipeRecognizer {
        NSLog(@"Load swipe");

        if (swipeRecognizer.direction==UISwipeGestureRecognizerDirectionLeft) 
        {
            NSLog(@"swipe Left"); 
            [self SlideToLeft];
        }
    } 
```

我真的看到“Load 2”被打印了 3 次，但是当我尝试滑动时它不起作用。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T15:23:39.813

你在这里使用 UIScrollView 吗？这可能是问题所在。

我认为您可以在这种情况下使用标准的 UIScrollView 委托方法：

```
- (void) scrollViewDidScroll: (UIScrollView *) sender
{
    NSLog(@"Scrolled!");
} 
```

否则[这里](https://stackoverflow.com/questions/10276391/uiswipegesturerecognizer-on-uiview-inside-uiscrollview)，[这里](https://stackoverflow.com/questions/8129334/dragging-an-uiview-inside-uiscrollview-with-gesture-recognizers-enabled-for-sibl)和[这里](https://stackoverflow.com/questions/1481826/dragging-an-uiview-inside-uiscrollview)的这些人也有一些麻烦，也许那里的答案可以帮助你。

如果您在这里不使用 UIScrollView？我应该用一个，为什么不呢？3 个子视图和滑动到下一个听起来就像一个不错的 UIScrollView 示例（使用分页）。

祝你好运！

# gradle - 为什么我的构建脚本的不同部分会看到 project.version 属性的不同值？

> ID：12643188
> 
> 赞同：0
> 
> 时间：2012-09-28T15:44:45.760
> 
> 标签：gradle

我在所有项目部分的 gradle 中执行以下操作...

```
 if (project.hasProperty('myVersion')) {
     project.ext.realVersion = project.myVersion
     project.version = project.myVersion
     println("project version set")
   } else {
     project.ext.realVersion = 'Developer-Build'
     project.version = 'Developer-Build'
     println("project version set to devbuild")
   } 
```

现在，我有一些正确使用 project.version 的代码并且它可以工作，但是还有其他代码也使用相同的属性 project.versoin，结果是“未指定”。如果我将两者都更改为 project.realVersion，它们都可以工作。version 似乎是这个讨厌的特殊属性，似乎并不总是有效。

使用属性的代码如下....（注意我使用 realVersion 的地方，版本不起作用，但它在其他位置工作正常：（）....多么奇怪。

```
task versionFile() << {
    File f = new File('output/version');
    f.mkdirs()
    File v = new File(f, 'version'+project.ext.realVersion)
    println('v='+v.getAbsolutePath())
    v.createNewFile()
}

task myZip(type: Zip) {
    archiveName 'dashboard-'+project.version+'.zip'
    from('..') {
        include 'webserver/run*.sh'
        include 'webserver/app/**'
        include 'webserver/conf/**'
        include 'webserver/play-1.2.4/**'
        include 'webserver/public/**'
        include 'webserver/lib/**'
    }
    from('output/version') {
        include '**'
    }
}
myZip.dependsOn('versionFile')
assemble.dependsOn('myZip') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T18:52:08.423

这个问题与财产无关`version`。构建脚本是按顺序评估的。如果您不能保证在读取*之前*`version`设置了属性，则必须将读取属性推迟到配置阶段结束。否则你将不可避免地遇到问题。一种方法是将读取属性的配置代码放入块中。是另一种方式，但有一个限制，即配置的值不会被考虑进行最新检查。*`gradle.projectsEvaluated {}``task.doFirst {}`*

 *有时有一个更简单的解决方案。例如，对于像 之类的存档任务`Zip`，您可以只设置`baseName`and`extension`而不是`archiveName`. 与往常一样，我鼓励您学习[DSL 参考](http://gradle.org/docs/current/dsl/org.gradle.api.tasks.bundling.Zip.html#org.gradle.api.tasks.bundling.Zip%3aarchiveName)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T07:43:51.130

将以下内容放在 doFirst 中，如下所示：

```
allprojects {
    doFirst {
      if (project.hasProperty('myVersion')) {
        project.ext.realVersion = project.myVersion
        project.version = project.myVersion
        println("project version set")
      } else {
        project.ext.realVersion = 'Developer-Build'
        project.version = 'Developer-Build'
        println("project version set to devbuild")
      }
    }
} 
```*

# vb.net - 在用户在 .net 3.5 中的 datagridview 中输入一行之前是否有事件触发

> ID：12643191
> 
> 赞同：0
> 
> 时间：2012-09-28T15:45:23.477
> 
> 标签：vb.net, winforms, events, datagridview, wrapper

我正在尝试创建一个包装器来用 datagridview 替换 sheridan datagrid actvex 控件。

sheridan datagrid 控件支持一个事件，该事件在用户将要向网格中添加一个名为 BeforeInsert 的行之前触发。

有谁知道 datagridview 控件中的等效事件或我可以编写的其他代码产生相同的效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:25:16.190

我正在查看这里的所有事件，我没有看到添加或插入行的事件，只是添加了。尽管奇怪的是有一个用于删除和删除。我不会假装知道为什么。对于您的问题，用户将如何添加行？您可以尝试使用“AllowUserToAddRowsChanged”事件并在用户想要添加行时以编程方式更改该属性。

# node.js - 当我想要更多/全部时，Mongoose 将查询限制为 1000 个结果（从 2.6.5 迁移到 3.1.2）

> ID：12643195
> 
> 赞同：5
> 
> 时间：2012-09-28T15:45:30.777
> 
> 标签：node.js, mongodb, mongoose

我正在将我的应用程序从 Mongoose 2.6.5 迁移到 3.1.2，并且遇到了一些意外行为。也就是说，我注意到查询结果自动限制为 1000 条记录，而几乎所有其他内容都一样。在我的代码（如下）中，我设置了一个`maxIvDataPoints`限制返回的数据点数量（并最终发送到客户端浏览器）的值，该值在其他地方设置为 1500。我使用计数查询来确定潜在结果的总数，然后一个后续的mod来限制实际的查询结果，使用count和value`maxIvDataPoints`来确定mod的值。我正在运行节点 0.8.4 和 mongo 2.0.4，用 coffeescript 编写服务器端代码。

在安装 mongoose 3.1.x 之前，代码按我的意愿运行，每次返回不到 1500 个数据点。安装 3.1.2 后，我每次都返回 1000 个数据点（假设指定范围内有 1000 多个数据点）。结果被截断，因此数据点 1001 到 ~1500 是不再返回的数据点。

似乎某处可能有一些设置可以控制这种行为，但我在文档、此处或 Google 组中找不到任何内容。我仍然是一个相对的 n00b，所以我可能错过了一些明显的东西。

```
DataManager::ivDataQueryStream = (testId, minTime, maxTime, callback) ->

    # If minTime and maxTime have been provided, set a flag to limit time extents of query
    unless isNaN(minTime)
    timeLimits = true

    # Load the max number of IV data points to be displayed from CONFIG
    maxIvDataPoints = CONFIG.maxIvDataPoints

    # Construct a count query to determine the number if IV data points in range
    ivCountQuery = TestDataPoint.count({})
    ivCountQuery.where "testId", testId

    if timeLimits
        ivCountQuery.gt "testTime", minTime
        ivCountQuery.lt "testTime", maxTime

    ivCountQuery.exec (err, count) ->

        ivDisplayQuery = TestDataPoint.find({})
        ivDisplayQuery.where "testId", testId

        if timeLimits
            ivDisplayQuery.gt "testTime", minTime
            ivDisplayQuery.lt "testTime", maxTime

        # If the data set is too large, use modulo to sample, keeping the total data series
        # for display below maxIvDataPoints
        if count > maxIvDataPoints
            dataMod = Math.ceil count/maxIvDataPoints

            ivDisplayQuery.mod "dataPoint", dataMod, 1

        ivDisplayQuery.sort "dataPoint" #, 1 <-- new sort syntax for Mongoose 3.x
        callback ivDisplayQuery.stream() 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T16:03:37.733

你被两个相关的因素绊倒了：

1.  Mongoose 的默认查询 batchSize[在 3.1.2 更改为 1000](https://groups.google.com/forum/?fromgroups=#!topic/mongoose-orm/lhQTCsPFhRc)。
2.  MongoDB 有一个[已知问题](https://jira.mongodb.org/browse/SERVER-5374)，即需要内存排序的查询对返回的文档数量设置了查询批处理大小的硬限制。

因此，您的选择是放置一个组合索引`TestDataPoint`，允许 mongo`dataPoint`在此类查询中使用它进行排序，或者将[批量大小](http://mongoosejs.com/docs/api.html#query_Query-batchSize)增加到至少您期望的文档总数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-29T00:51:58.710

哇，太可怕了。我将很快发布对 mongoose 的修复，删除 batchSize 默认值（在流式传输大型结果集时很有帮助）。感谢您的指点。

**更新**：3.2.1 和 2.9.1 已随修复程序一起发布（删除了默认的 batchSize）。

# c - 退出c中的线程

> ID：12643198
> 
> 赞同：0
> 
> 时间：2012-09-28T15:45:45.227
> 
> 标签：c, linux, pthreads

我目前正在编写一些 C 代码，对 C 来说非常新，所以如果这是一个有点基本或愚蠢的问题，我深表歉意。

我有以下代码，它使用`pthread_create()`.

```
if (ps.status == completed)
        {
            LOG(LOG_AUDIO, "evsafewait_sm_play_tone:\tPlay tone complete");
            if (e2)
            {
                LOG(LOG_MUST, "Failed to free tone event. Result: %i", e2);
            }

            pccb->playToneComplete = 1;
            LOG(LOG_AUDIO, "Detatching thread ID %x", manageToneParms->toneManagerThread);
            //pthread_detach(manageToneParms->toneManagerThread);

            int retVal;
            pthread_exit(&retVal);
            LOG(LOG_AUDIO, "THREAD TERMINATED WITH RESULT %i", retVal);
            LOG(LOG_AUDIO, "Freeing memory");

            free(manageToneParms->playToneParms);
            free(manageToneParms);
            return 0;
        } 
```

在结构空闲并且方法返回之前，我试图退出线程使用`pthread_exit()`，但是当它被调用时，它下面的所有内容都被跳过，没有错误显示，据我所知。

我试过用 GDB 调试它，当`pthread_exit()`它被调用时，它打印出来的下一件事是`siglongjmp`，我不知道这是什么，我不相信它在 C 代码中，至少不在我所做的更改中它。

我怎样才能退出这个线程？我也尝试过`pthread_exit(NULL)`，`pthread_kill(threadID, SIGKILL)`但这会杀死整个程序而不仅仅是线程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T18:01:25.180

`pthread_exit()`从调用点的线程返回。之后的任何代码`pthread_exit()`都不会被执行。

您应该确保在调用之前释放线程中分配的所有内存`pthread_exit()`。

你有没有尝试过这样的事情：？

```
int retVal;

/* free resources -- make sure all resources allocated in thread 
   function are released 
*/
free(manageToneParms->playToneParms);
free(manageToneParms);

LOG(LOG_AUDIO, "THREAD TERMINATED WITH RESULT %i", retVal);
LOG(LOG_AUDIO, "Freeing memory");
pthread_exit(&retVal); 
```

# windows-services - 使用批处理文件安装 Windows 服务？

> ID：12643199
> 
> 赞同：10
> 
> 时间：2012-09-28T15:45:45.400
> 
> 标签：windows-services, batch-file, installutil

我在 bat 文件中有以下内容：

```
@ECHO OFF

REM The following directory is for .NET 4.0
set DOTNETFX2=%SystemRoot%\Microsoft.NET\Framework\v4.0.30319
set PATH=%PATH%;%DOTNETFX2%

echo Installing IEPPAMS Win Service...
echo ---------------------------------------------------
C:\Windows\Microsoft.NET\Framework\v4.0.30319\InstallUtil My.WindowsService.exe
echo ---------------------------------------------------
pause
echo Done. 
```

问题是即使 bat 文件与 My.WindowsService.exe 位于同一文件夹中，它也会尝试在 C:\Windows\System32 中查找它.....

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-09T08:16:50.303

这是如何解决的：

```
@ECHO OFF

REM The following directory is for .NET 4.0
set DOTNETFX2=%SystemRoot%\Microsoft.NET\Framework\v4.0.30319
set PATH=%PATH%;%DOTNETFX2%

echo Installing IEPPAMS Win Service...
echo ---------------------------------------------------
C:\Windows\Microsoft.NET\Framework\v4.0.30319\InstallUtil "%~dp0My.WindowsService.exe"
echo ---------------------------------------------------
pause
echo Done. 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-28T15:52:52.787

根据我发现的几篇文章，将绝对路径传递给您的服务就是您想要的。例如：

```
{...Path_To_.NET_Framework...}\InstallUtil C:\MyFolder\My.WindowsService.exe 
```

如果您想要动态生成的路径，您可以在批处理文件中使用类似的内容获取当前目录：

```
set CURDIR=%CD%
{...Path_To_.NET_Framework...}\InstallUtil %CURDIR%\My.WindowsService.exe 
```

参考：

*   [如何使用命令提示符安装 Windows 服务](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/d8f300e3-6c09-424f-829e-c5fda34c1bc7/)
*   [安装 Windows 服务](http://www.codeproject.com/Tips/52471/Install-Windows-Service)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-30T15:57:00.017

它太旧了，但对我很有用......我做了一些改变。

我的服务是手动启动的，所以在批处理中我包含了启动命令，然后打开控制台检查已安装的服务。

```
@ECHO OFF

REM The following directory is for .NET 4.0
set DOTNETFX2=%SystemRoot%\Microsoft.NET\Framework\v4.0.30319
set PATH=%PATH%;%DOTNETFX2%

echo Installing MyService Win Service...
echo ---------------------------------------------------
C:\Windows\Microsoft.NET\Framework\v4.0.30319\InstallUtil /i "%~dp0MyService.exe"
net start MyService
services.msc
echo ---------------------------------------------------
pause
echo Done. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-17T05:37:42.027

## 安装和卸载示例

```
 @ECHO OFF

REM The following directory is for .NET 4.0
set DOTNETFX2=%SystemRoot%\Microsoft.NET\Framework\v4.0.30319
set PATH=%PATH%;%DOTNETFX2%

echo Instalar Servicio......
echo ---------------------------------------------------
InstallUtil /i "%~dp0WindowsService1.exe"
echo ---------------------------------------------------
pause
echo Done.

@ECHO OFF

REM The following directory is for .NET 4.0
set DOTNETFX2=%SystemRoot%\Microsoft.NET\Framework\v4.0.30319
set PATH=%PATH%;%DOTNETFX2%

echo Desintalar Servicio...
echo ---------------------------------------------------
InstallUtil /u "%~dp0WindowsService1.exe"
echo ---------------------------------------------------
pause
echo Done. 
```

# c - 为什么 gcc 允许将参数传递给定义为没有参数的函数？

> ID：12643202
> 
> 赞同：75
> 
> 时间：2012-09-28T15:45:57.690
> 
> 标签：c, gcc, compiler-errors

我不明白为什么这段代码会编译？

```
#include <stdio.h>
void foo() {
    printf("Hello\n");
}

int main() {
    const char *str = "bar";
    foo(str);
    return 0;
} 
```

gcc 甚至没有警告我向 foo() 传递了太多参数。这是预期的行为吗？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-09-28T15:56:19.340

在 C 中，使用空参数列表声明的函数在被调用时接受任意数量的参数，这些参数受到通常的算术提升。调用者有责任确保提供的参数适用于函数的定义。

要声明一个带零参数的函数，您需要编写`void foo(void);`.

这是出于历史原因；最初，C 函数没有原型，因为 C 是从无类型语言[B演变而来的。](http://en.wikipedia.org/wiki/B_%28programming_language%29)添加原型后，为了向后兼容，语言中保留了原始的无类型声明。

要让 gcc 对空参数列表发出警告，请使用[`-Wstrict-prototypes`](http://gcc.gnu.org/onlinedocs/gcc-4.4.0/gcc/Warning-Options.html)：

> 如果在未指定参数类型的情况下声明或定义函数，则发出警告。（如果前面有一个指定参数类型的声明，则允许在没有警告的情况下进行旧式函数定义。）

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-09-28T15:54:12.227

由于遗留原因，使用参数列表声明函数`()`本质上意味着“在调用函数时找出参数”。要指定函数没有参数，请使用`(void)`.

编辑：我觉得我在这个问题上因为老了而声名狼藉。只是为了让你们孩子知道编程曾经是什么样的，这是[我的第一个程序](http://edp.org/primes.htm)。（不是 C；它向您展示了我们在此之前必须使用的内容。）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-09-28T16:11:05.790

```
void foo() {
    printf("Hello\n");
}

foo(str); 
```

在 C 中，此代码不违反约束（如果它是在其原型形式中用 定义的`void foo(void) {/*...*/}`）并且由于没有违反约束，编译器不需要发出诊断。

但是根据以下 C 规则，该程序具有未定义的行为：

从：

> (C99, 6.9.1p7) “如果声明器包含参数类型列表，则该列表还指定所有参数的类型；这样的声明器还用作函数原型，以便以后调用同一翻译单元中的同一函数。如果声明符包括标识符列表，142) 参数的类型应在以下声明列表中声明。”

该`foo`函数不提供原型。

从：

> （C99，6.5.2.2p6）“如果表示被调用函数的表达式具有不包含原型的类型 [...] 如果参数的数量不等于参数的数量，则行为未定义。”

`foo(str)`函数调用是未定义的行为。

C 不强制实现为调用未定义行为的程序发出诊断，但您的程序仍然是错误程序。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-07-14T15:50:49.400

C99 标准 (6.7.5.3) 和 C11 标准 (6.7.6.3) 都规定：

> 标识符列表仅声明函数参数的标识符。作为该函数定义的一部分的函数声明器中的空列表指定该函数没有参数。不属于该函数定义的函数声明器中的空列表指定不提供有关参数数量或类型的信息。

由于 foo 的声明是定义的一部分，因此声明指定 foo 接受 0 个参数，因此调用 foo(str) 至少在道德上是错误的。但如下所述，C 中存在不同程度的“错误”，编译器在处理某些“错误”的方式上可能有所不同。

举一个稍微简单的例子，考虑下面的程序：

```
int f() { return 9; }
int main() {
  return f(1);
} 
```

如果我使用 Clang 编译上述内容：

```
tmp$ cc tmp3.c
tmp3.c:4:13: warning: too many arguments in call to 'f'
  return f(1);
         ~  ^
1 warning generated. 
```

如果我使用 gcc 4.8 进行编译，即使使用 -Wall，我也不会收到任何错误或警告。先前的答案建议使用 -Wstrict-prototypes，它正确报告 f 的定义不是原型形式，但这真的不是重点。C 标准允许以非原型形式定义函数，例如上述形式，并且标准明确指出该定义指定函数采用 0 个参数。

现在有一个**约束**（C11 Sec. 6.5.2.2）：

> 如果表示被调用函数的表达式具有包含原型的类型，则参数的数量应与参数的数量一致。

但是，此约束不适用于这种情况，因为函数的类型不包括原型。但这是语义部分中的后续声明（不是“约束”），它确实适用：

> 如果表示被调用函数的表达式的类型不包含原型……如果参数的数量不等于参数的数量，则行为未定义。

因此，函数调用确实会导致未定义的行为（即，程序不是“严格符合”）。但是，该标准仅要求实现在违反实际约束时报告诊断消息，在这种情况下，没有违反约束。因此，gcc 不需要报告错误或警告即可成为“符合要求的实现”。

所以我认为这个问题的答案，为什么 gcc 允许它？，是 gcc 不需要报告任何内容，因为这不是违反约束。此外，gcc 并未声称报告所有类型的未定义行为，即使使用 -Wall 或 -Wpedantic 也是如此。这是未定义的行为，这意味着实现可以选择如何处理它，而 gcc 选择在没有警告的情况下编译它（显然它只是忽略了参数）。

# wordpress - 如果选择了评级，则插入图像

> ID：12643203
> 
> 赞同：1
> 
> 时间：2012-09-28T15:45:59.253
> 
> 标签：wordpress

我有一个 Wordpress 插件，它显示了谷歌的评价片段。1.0 - 5.0，我想在评分之后为所选值添加一个图像，但它没有。

到目前为止，我已经让它加载图像，但它没有显示在我想要的位置，这就是我卡住的地方。

![示例图片在这里](../Images/5f060f07011478d2a7592b2e8aafe67b.png "示例图片在这里")

这是我尝试添加的：

```
if ($rating == "5.0"){ print("<IMG SRC ="stars/5-0.png>");} 
```

这是插件代码：

```
<?php
$prefix = 'pk_rs_';

DEFINE ('PK_RS_DEFAULT_RATING', '-');

DEFINE ('PK_RS_DISPLAY', true);

$pk_rs_meta_box = array(
    'id' => 'pk_rich_snippet_review',
    'title' => 'Google Rich Snippets: Reviews',
    'page' => 'post',
    'context' => 'normal',
    'priority' => 'high',
    'fields' => array(
        array(
            'name' => 'Rating',
            'desc' => 'Product rating, from 1 to 5.',
            'id' => 'rating',
            'type' => 'select',
            'options' => array('-', '1.0', '1.5', '2.0', '2.5', '3.0', '3.5', '4.0', '4.5', '5.0')
        ),  
        array(
            'name' => 'Author',
            'desc' => 'Author display name.',
            'id' => 'author',
            'type' => 'text',
            'std' => ''
        )

    )
);

add_action('admin_menu', 'pk_rich_snippet_add_box');

// Add meta box
function pk_rich_snippet_add_box() {
    global $pk_rs_meta_box;

    add_meta_box($pk_rs_meta_box['id'], $pk_rs_meta_box['title'], 'pk_rich_snippet_show_box', $pk_rs_meta_box['page'], $pk_rs_meta_box['context'], $pk_rs_meta_box['priority']);
}

// Callback function to show fields in meta box
function pk_rich_snippet_show_box() {
    global $pk_rs_meta_box, $post;

    // Use nonce for verification
    echo '<input type="hidden" name="pk_rich_snippet_nonce" value="', wp_create_nonce(basename(__FILE__)), '" />';

    echo '<table class="form-table">';

    foreach ($pk_rs_meta_box['fields'] as $field) {
        // get current post meta data
        $meta = get_post_meta($post->ID, $field['id'], true);

        echo '<tr>',
                '<th style="width:20%"><label for="', $field['id'], '">', $field['name'], '</label></th>',
                '<td>';
        switch ($field['type']) {
            case 'text':
                echo '<input type="text" name="', $field['id'], '" id="', $field['id'], '" value="', $meta ? $meta : $field['std'], '" size="30" style="width:97%" />',
                    '<br />', $field['desc'];
                break;
            case 'textarea':
                echo '<textarea name="', $field['id'], '" id="', $field['id'], '" cols="60" rows="4" style="width:97%">', $meta ? $meta : $field['std'], '</textarea>',
                    '<br />', $field['desc'];
                break;
            case 'select':
                echo '<select name="', $field['id'], '" id="', $field['id'], '">';
                foreach ($field['options'] as $option) {
                    echo '<option', $meta == $option ? ' selected="selected"' : '', '>', $option, '</option>';
                }
                echo '</select>', '<br />', $field['desc'];
                break;
            case 'radio':
                foreach ($field['options'] as $option) {
                    echo '<input type="radio" name="', $field['id'], '" value="', $option['value'], '"', $meta == $option['value'] ? ' checked="checked"' : '', ' />', $option['name'];
                }
                break;
            case 'checkbox':
                echo '<input type="checkbox" name="', $field['id'], '" id="', $field['id'], '"', $meta ? ' checked="checked"' : '', ' />', 
                '<br />', $field['desc'];
                break;
        }
        echo    '<td>',
            '</tr>';
    }

    echo '</table>';
}

add_action('save_post', 'pk_rs_save_data');

// Save data from meta box
function pk_rs_save_data($post_id) {
    global $pk_rs_meta_box;

    // verify nonce
    if (!wp_verify_nonce($_POST['pk_rich_snippet_nonce'], basename(__FILE__))) {
        return $post_id;
    }

    // check autosave
    if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) {
        return $post_id;
    }

    // check permissions
    if ('page' == $_POST['post_type']) {
        if (!current_user_can('edit_page', $post_id)) {
            return $post_id;
        }
    } elseif (!current_user_can('edit_post', $post_id)) {
        return $post_id;
    }

    foreach ($pk_rs_meta_box['fields'] as $field) {
        $old = get_post_meta($post_id, $field['id'], true);
        $new = $_POST[$field['id']];

        if ($new && $new != $old) {
            update_post_meta($post_id, $field['id'], $new);
        } elseif ('' == $new && $old) {
            delete_post_meta($post_id, $field['id'], $old);
        }
    }
}

add_filter('the_content', 'pk_rs_add_rich_snippet_to_content', 20);
function pk_rs_add_rich_snippet_to_content($content){
    if (is_single()&&!is_feed()){
        global $post;
        $rating = get_post_meta($post->ID, 'rating', true); 
        $rating = ( '-' == $rating && '-' != PK_RS_DEFAULT_RATING ) ? PK_RS_DEFAULT_RATING : $rating;  
        if ( '-' != $rating ){
            $title = $post->post_title ;
            $dateTime = date_create( $post->post_date );
            $date = $dateTime->format("Y-m-d");
            $date_only = $dateTime->format("M j");
            $author = get_post_meta($post->ID, 'author', true);
            $author = ( '' == $author ) ? ucfirst(get_the_author_meta('display_name', $post->post_author)) : $author;
            $summary = get_post_meta($post->ID, 'summary', true);
            $description = get_post_meta($post->ID, 'description', true);
            if ( !PK_RS_DISPLAY ) {
                $output = "<div class=\"hreview\" style=\"display:none\">";
                $output .= "<span class=\"item\"><span class=\"fn entry-title\">".$title."</span></span>";
                $output .= "Reviewed by <span class=\"reviewer\">".$author."</span> on <span class=\"dtreviewed\"> ".$date_only."<span class=\"value-title\" title=\"".$date."\"></span></span>";
                $output .= "Rating: <span class=\"rating\">".$rating."</span>";         
                $output .= "<span class=\"summary\">".$summary."</span>";
                $output .= "<span class=\"description\">".$description."</span>";
                $output .= "</div>";
            } else {
                $output = "<div class=\"hreview\" style=\"display:block; margin: 0 0 10px 10px; padding: 10px; background: #F6F6F6; border: 1px solid #DDD; -moz-border-radius: 3px; border-radius: 3px; font-size: 0.8em; width: 30%; float: right;\">";
                $output .= "Title: <span class=\"item\"><span class=\"fn entry-title\" style=\"font-size: 0.8em;font-weight: normal;\">".$title."</span></span><br />";
                $output .= "Reviewed by <span class=\"reviewer\">".$author."</span> on <span class=\"dtreviewed\"> ".$date_only."<span class=\"value-title\" title=\"".$date."\"></span></span><br/>";
                $output .= "Rating: <span class=\"rating\">".$rating."</span><br/>";
                $output .= ( 0 < strlen($summary) ) ? "Summary: <span class=\"summary\">".$summary."</span><br/>" : "";
                $output .= ( 0 < strlen($description) ) ? "<p><span class=\"description\">".$description."</span></p>" : "";
                $output .= "</div>";
            }

            $content = $output.$content ;
        }
    }
    return $content;
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:01:42.230

我会做类似的事情：

```
$imgTag = "<img src = 'stars/$rating.png' />"; 
```

然后修改说：

```
 $output .= "Rating: <span class=\"rating\">".$rating."</span><br/>"; 
```

类似于：

```
$output .= "Rating: <span class=\"rating\">".$rating. $imgTag . "</span><br/>"; 
```

# php - 如何按类从一页到另一页获取列表项？

> ID：12643206
> 
> 赞同：0
> 
> 时间：2012-09-28T15:46:04.173
> 
> 标签：php, class, search, html-lists

这是上一个问题的延续，我尝试了上一个方法，但我不确定我是否正确地执行了它，或者它是否执行了预期的功能。我希望有一种方法可以用 PHP 做到这一点。

[基于列表项类别的搜索](https://stackoverflow.com/questions/12548151/search-based-on-list-item-class)

这次我将提供更详细的解释，以便更好地理解代码的逻辑以及我正在尝试做的事情。

例如：

domain.com/default.html （我要检索的所有项目的页面都在）

以下是我要将这些列表项导出到的页面：

```
domain.com/section/red.html
domain.com/section/blue.html
domain.com/section/green.html 
```

在源页面上，我想用红色、蓝色或绿色类标​​记无序列表中的列表项，并按照它们在源页面上出现的相同顺序发送它们（以及它们在 li 标记中的所有标记），到上面提到的他们各自的页面。所有红色类的列表项将被发送到 red.html，蓝色类到 blue.html，等等。

```
<div id="list">
<ul>
<li class="red"></li> (to red.html)
<li class="green"></li> (to green.html)
<li class="red"></li> (to red.html)
<li class="blue"></li> (to blue.html)
<li class="red"></li> (to red.html)
<li class="green"></li> (to green.html)
</ul>
</div> 
```

另外，我将如何在目标页面上指定从源页面导出的标记放置的位置？

有什么简单的方法可以用 PHP 做到这一点吗？

任何输入或帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:23:25.070

尝试使用此示例。我想这会对你有所帮助。

```
​$("#submit").click(function(e){
  e.preventDefault();
  alert($("ul").find(".red").text());
});​ 
```

提交我添加的表单时，我已经加载了与特定类相关的所有数据。您可以在加载页面时加载它们。

[演示](http://jsfiddle.net/mangalauwu/guevz/)

# ibatis - 我将如何传递参数并在 mybatis 动态查询创建中检查它

> ID：12643207
> 
> 赞同：3
> 
> 时间：2012-09-28T15:46:06.010
> 
> 标签：ibatis, mybatis

我在我的里面写了一个选择查询`mapper.xml`

```
<select id="getCatCount" parameterType="String" resultType="int">
    select count(*) from Categories where status is not null  
    <if test="catTypeId != 0">
    AND cat_type_id = #{catTypeId,jdbcType=INTEGER}
    </if>  
</select> 
```

在 mapper.java 方法中是

```
int getCatCount(int catTypeId); 
```

如何在 if 条件下检查 catTypeId。我知道上面的语句不正确，但我想设置这样的条件，所以我检查 catTypeId 是否不为零，然后只添加 AND 条件。还是我需要传递 Category 类的整个对象？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T16:51:50.830

您不需要通过整个 Category 类。只需按照您的描述进行操作：

```
int getCatCount(int catTypeId); 
```

您的 mapper.xml 应如下所示：

```
<select id="getCatCount" parameterClass="map" resultType="int">
  select count(*) from Categories where status is not null  
   <if test="param1 != 0">
     AND cat_type_id = #{param1,jdbcType=INTEGER}
   </if>  
</select> 
```

请注意，`parameterClass`您需要指定地图。

假设现在，您要传递两个参数：

```
int getCatCount(int catTypeId, int mySecondParam); 
```

在映射器中，您应该使用`param1`和`param2`

看，你需要如何使用“paramX”命名法。但是，假设您希望使用自定义参数名称作为“catTypeId”，而不是使用该命名法。为此，您需要在 Java 代码中执行以下操作：

```
int getCatCount( @Param("cat_type_id ") String cat_type_id); 
```

XML 映射器将是我所说的那个，但使用的`cat_type_id`是`param1`.

# jquery - Jquery - 循环遍历具有特定类的每个 div 并根据其宽度应用一个新类

> ID：12643214
> 
> 赞同：4
> 
> 时间：2012-09-28T15:46:29.620
> 
> 标签：jquery, loops, navigation, width, each

我遇到了一些 jquery 问题，想知道您是否可以提供帮助。

我有一个带有下拉菜单的菜单，并且想根据它是哪个列表项以及下拉菜单的宽度来更改下拉菜单的位置，这就是我到目前为止所拥有的...

```
$(document).ready(function() {
var subnavWidth = $('.sub-nav-wrapper').width();

if(subnavWidth > 900) {
    $('.sub-nav-wrapper').addClass('two-column-offers');
} else if (subnavWidth > 800) {
    $('.sub-nav-wrapper').addClass('one-column-offers');
} else if(subnavWidth > 600) {
    $('.sub-nav-wrapper').addClass('offers');
} else if(subnavWidth > 500) {
    $('.sub-nav-wrapper').addClass('two-column');
} else if(subnavWidth > 300) {
    $('.sub-nav-wrapper').addClass('one-column');

}
}); 
```

但仅考虑菜单中的第一个列表项并将相关类应用于每个子导航。我希望它检查每个子导航的宽度，而不仅仅是第一个，然后将该类应用于该特定的子导航。

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T15:51:24.863

```
$(function() {
    $('.sub-nav-wrapper').each(function(i,elem) {
        var width = $(this).width();
        if(width > 900) {
            $(elem).addClass('two-column-offers');
        } else if (width > 800) {
            $(elem).addClass('one-column-offers');
        } else if(width > 600) {
            $(elem).addClass('offers');
        } else if(width > 500) {
            $(elem).addClass('two-column');
        } else if(width > 300) {
            $(elem).addClass('one-column');
        }
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:49:19.933

您需要将此应用于所有菜单项，因此您想使用 each() 来选择它们；

```
$('.sub-nav-wrapper').each(); 
```

然后，您可以使用异常函数为“每个”编写代码。

```
$('.sub-nav-wrapper').each(function() {
    // YOUR CODE HERE                                       
}); // End each 
```

使用`$(this)`关键字对“每个”项目进行检查。

```
 $('.sub-nav-wrapper').each(function() {
    alert($(this).width()); // for example                                      
 }); // End each 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:01:23.413

```
 $(document).ready(function() {
   $('.sub-nav-wrapper').each(function() {
       var subnavWidth = $(this).width();
   if(subnavWidth > 900) {
      $(this).addClass('two-column-offers');
   } else if (subnavWidth > 800) {
       $(this).addClass('one-column-offers');
   } else if(subnavWidth > 600) {
     $(this).addClass('offers');
   } else if(subnavWidth > 500) {
      $(this).addClass('two-column');
   } else if(subnavWidth > 300) {
      $(this).addClass('one-column');
   }
 });
 }); 
```

# tsql - T-SQL：从字符串转换日期和/或时间时转换失败

> ID：12643216
> 
> 赞同：2
> 
> 时间：2012-09-28T15:46:34.867
> 
> 标签：tsql, triggers

下面是用于捕获 SQL 表上的更新/插入的触发器。我不知道为什么，但是每当更新完成时，从字符串转换日期和/或时间时，我都会收到错误消息转换失败。这是事务日志表的结构：

```
CREATE TABLE [dbo].[TransactionLog](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [TransactionDate] [datetime] NOT NULL,
    [Operator] [varchar](35) NOT NULL,
    [TableName] [varchar](50) NOT NULL,
    [Action] [char](1) NOT NULL,
    [TableString] [nvarchar](255) NOT NULL,
    [UserId] [char](6) NULL,
 CONSTRAINT [PK_TransactionLog] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY] 
```

这是正在更新的表格：

```
CREATE TABLE [dbo].[AgentContEd](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [sNumber] [int] NOT NULL,
    [StateCode] [char](3) NOT NULL,
    [CourseCode] [char](6) NOT NULL,
    [DateTaken] [date] NOT NULL,
    [ExpirationDate] [date] NULL,
    [CourseHours] [smallint] NOT NULL,
    [Method] [varchar](15) NULL,
    [LastChangeOperator] [char](8) NOT NULL,
    [LastChangeDate] [datetime] NOT NULL,
    [ControlId] [int] NULL,
 CONSTRAINT [PK_AgentContEd] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY] 
```

这是导致头痛的触发器......

```
BEGIN
    INSERT INTO dbo.TransactionLog 
    (
        TransactionDate, 
        Operator, 
        TableName, 
        Action, 
        TableString, 
        UserId
    )
    SELECT 
        LastChangeDate,
        'Op',
        @tableName,
        @action,
        CAST(
          'ID:'             + CAST(ISNULL(Id,             'NULL') as char(4))
        + ' SymNum:'        + CAST(ISNULL(sNumber,  'NULL') as char(10))
        + ' StateCode:'     + ISNULL(StateCode,           'NULL')
        + ' DateTaken:'     + CAST(ISNULL(DateTaken,      'NULL') as nvarchar(9))
        + ' ExpDate:'       + CAST(ISNULL(ExpirationDate, 'NULL') as nvarchar(9))
        + ' CourseCode:'    + ISNULL(CourseCode,          'NULL')
        + ' Hours:'         + CAST(ISNULL(CourseHours,    'NULL')  as char(3))
        + ' Mthd:'          + ISNULL(Method,              'NULL')
        As char(255)), 
        LastChangeOperator
    FROM inserted
END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:41:13.147

尝试

```
 + ' DateTaken:'     + ISNULL(CAST(DateTaken as varchar(9)),      'NULL')
    + ' ExpDate:'       + ISNULL(CAST(ExpirationDate as varchar(9)), 'NULL') 
```

我使用`varchar`它似乎毫无意义，如果你无论如何`nvarchar`都要将字符串投射到最后。`char`

此外，您可能需要使用`CONVERT`样式而不是`CAST`存储有用的东西。`SELECT CAST(getdate() as nvarchar(9))`为我返回`Sep 28 20`。

[格式列表在这里](http://www.sql-server-helper.com/tips/date-formats.aspx)

# c++ - 插入向量

> ID：12643218
> 
> 赞同：4
> 
> 时间：2012-09-28T15:46:38.027
> 
> 标签：c++, stl, vector, insertion

我是否认为这个看似无辜的代码相当危险？

```
template<typename T>
void insertLast(std::vector<T>& v)
{
    if(v.empty()) return;  
    v.insert(v.begin(), v.back());
} 
```

阅读一些答案后的一些澄清..

好吧，我并不是真的在问如何将一个元素插入到向量中，而是我做了一个虚拟的情况来质疑一个原则。换句话说，你认为有必要制作一个副本吗（这里创建了一个临时的.. 和一个 const保证对临时的引用）：

```
template<typename T>
void insertLast(std::vector<T>& v)
{
    if(v.empty()) return;  
    v.insert(v.begin(), T(v.back()));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:00:35.620

这对我来说似乎也很危险，因为 vector.back() 返回参考，并且

> 通过将位置和向量末尾之间的所有元素移动到它们的新位置，然后插入新元素（从[这里开始](http://www.cplusplus.com/reference/stl/vector/insert/)）来执行除向量末端以外的位置上的插入

除非我误解了，否则传递给的引用将`insert`变为“无效”（如果没有发生重新分配，它不能包含最后一个元素，而是前一个元素；否则它仍然可能是正确的，但我想它不能保证。

在某些情况下，某些优化器可能会隐藏错误（我猜它永远不会发生在对象上，但可能会发生在原语上），所以你会得到预期的结果，但总的来说我不会依赖这种行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:56:51.993

假设您解决了注释中提到的两点以进行编译，这将运行但每次运行时都会在向量的前面留下一个垃圾值，因为 vector.back() 返回一个**引用**。

看起来这试图做的是以下内容：

```
template<typename T>
void insertLast(std::vector<T>& v)
{
    if(v.empty()) return;  
    v.insert(v.begin(), v.end() - 1, v.end());
} 
```

这将安全地插入向量中的最后一个元素，使其也是第一个元素....假设这是所需的行为。

# android - 设置 sharedPreferences 默认值

> ID：12643220
> 
> 赞同：0
> 
> 时间：2012-09-28T15:47:01.250
> 
> 标签：android, storage, sharedpreferences

我有一个应用程序，当应用程序第一次运行时，我设置了大约 200 个共享首选项。我最初是通过从我的 onCreate 方法调用它来加载所有首选项

```
SharedPreferences pref = getSharedPreferences(CALC_PREFS, MODE_PRIVATE);
settingsEditor = prefs.edit();
settingsEditor.putString("Something", "");
....
settingsEditor.commit(); 
```

它会运行得很好而且相当快。然后我重新设计了我的应用程序，使其具有一个抽象活动类来处理所有使用共享首选项的工作，因为我有 4 个不同的活动访问这些首选项。

```
public abstract class AnActivity extends Activity{

// Shared Preference string
private static final String CALC_PREFS = "CalculatorPrefs";
// Editor to customize preferences
private Editor settingsEditor;
// Shared preference
private SharedPreferences prefs;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);

    prefs = getSharedPreferences(CALC_PREFS, MODE_PRIVATE);
    settingsEditor = prefs.edit();
}

protected void addPref(String key, String value){
    settingsEditor.putString(key, value).commit();
}

protected void addPref(String key, int value){
    settingsEditor.putInt(key, value).commit();
}
//other methods were not posted    
} 
```

我的主要活动没有扩展“AnActivity”类。但是，当我在全新安装上运行我的应用程序或尝试访问任何共享首选项时，实例化所有内容需要 10 秒以上的时间。

How can I set the default values in a clean and efficient manner? Does creating an Abstract class to handle the preferences create more overhead than just calling getSharedPreferences manually?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:51:00.563

Are you commiting each time you add a preference? This is probably your issue, commiting for each entry could be quite expensive, batch together your put's and commit once.

If you don't need to specify the default value, you could always use clear() instead

[http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#clear%28%29](http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#clear%28%29)

# asp-classic - jscript中原型的内存使用情况

> ID：12643221
> 
> 赞同：0
> 
> 时间：2012-09-28T15:47:05.750
> 
> 标签：asp-classic, jscript

我想知道当连接多个用户而不是对函数的引用时，在经典的 asp 服务器上使用 jscript 中的原型是否使用更多的服务器内存，或者是否相同。

例子：

```
function SomeClass(){
  this.someMethod = this.myfunc;
}
SomeClass.prototype.myfunc = function(... 
```

相对于：

```
function SomeClass(){
  this.someMethod = myfunc;
}
function myfunc(... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T02:52:34.237

ASP 服务器通常会创建多个脚本引擎来为多个用户提供服务，因此无论您是否使用原型，内存中总会有方法的多个副本。话虽如此，使用原型将节省每个脚本引擎中的内存。

**参考：**

*   [http://blogs.msdn.com/b/ericlippert/archive/2003/09/18/how-does-active-server-pages-use-the-script-engines.aspx](http://blogs.msdn.com/b/ericlippert/archive/2003/09/18/how-does-active-server-pages-use-the-script-engines.aspx)
*   [Javascript原型操作符性能：节省内存，但更快吗？](https://stackoverflow.com/questions/3493252/javascript-prototype-operator-performance-saves-memory-but-is-it-faster)

* * *

顺便说一句，通常，原型方法被声明为：

```
function SomeClass(){
}
SomeClass.prototype.someMethod = function(... 
```

这可能会节省少量的内存和/或处理时间，因为您没有`someMethod`为每个新`SomeClass`对象创建属性，但我不希望节省太多，因为您只是设置对函数对象的引用.

# python - 来自python的Rsync无法找到路径

> ID：12643222
> 
> 赞同：2
> 
> 时间：2012-09-28T15:47:05.440
> 
> 标签：python, subprocess, rsync

我尝试通过 Popen 和 subprocess.check_call 从 python 运行 rsync，得到了同样的错误：

```
subprocess.check_call(['rsync', '-au', '/opt/catflow/EpressCatalog/*', '/Users/pistacchio/dev/epress/catflow/portal/branches/noscript/frontend/static/repo/usr/2/catalogs/2/builds/ipad'])
rsync: link_stat "/opt/catflow/EpressCatalog/*" failed: No such file or directory (2)
rsync error: some files could not be transferred (code 23) at /SourceCache/rsync/rsync-42/rsync/main.c(992) [sender=2.6.9]
*** CalledProcessError: Command '['rsync', '-au', '/opt/catflow/EpressCatalog/*', '/Users/pistacchio/dev/epress/catflow/portal/branches/noscript/frontend/static/repo/usr/2/catalogs/2/builds/ipad']' returned non-zero exit status 23 
```

似乎问题在于它找不到（或访问）`/opt/catflow/EpressCatalog/*`。它不仅存在，而且从命令行运行它会给出正确的结果。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-09-14T11:02:38.210

该[`subprocess`](https://docs.python.org/3/library/subprocess.html)模块自己处理参数的引用。当一个参数条目中有空格时，默认情况下会引用它。

简化[示例](https://docs.python.org/3/library/subprocess.html?highlight=subprocess#subprocess.Popen)：

```
['-input', 'eggs.txt', '-output', 'spam spam.txt'] 
```

在外壳上被称为

```
-input eggs.txt -output "spam spam.txt" 
```

**安全注意事项**：切勿使用`shell=True`。它打开了外壳注入攻击的风险。有关详细信息，请参阅[官方文档。](https://docs.python.org/3/library/subprocess.html?highlight=subprocess#security-considerations)

# jquery - 使用变量的选择器

> ID：12643223
> 
> 赞同：1
> 
> 时间：2012-09-28T15:47:08.323
> 
> 标签：jquery

通常，当我想检查是否单击了父元素中的任何子元素时，我会使用以下内容：

```
$(document).click(function (e) {
    alert($(e.target).is("#somediv *"));
} 
```

但现在我有`somediv`一个变量。我试过了：

```
var somediv = $(this);
$(document).click(function (e) {
    alert($(e.target).is($(somediv, "*")));
} 
```

但它不起作用。我怎样才能做到这一点？这是检测元素或任何子元素是否被点击的最佳方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:50:40.667

无论`somediv`是 DOM 元素还是选择器，都使用[`.closest` *^([docs])*](http://api.jquery.com/closest/)：

```
if ($(e.target).closest(somediv).length > 0) 
```

这将向上遍历 DOM，从开始`e.target`并测试任何祖先（或元素本身）是否为`somediv`. 如果要排除`e.target`，请从其父级开始：

```
$(e.target).parent().closest(somediv) 
```

* * *

另一种方法，取决于整体上下文，可能是将事件处理程序简单地绑定到`somediv`：

```
somediv.click(function() {
   // click originated from inside the div
}); 
```

* * *

没有简单的方法可以从现有的 DOM 元素创建选择器。如果`somediv`包含*选择器*，那么您可以使用字符串连接来组合它：

```
$(e.target).is(somediv + ' *'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:55:51.377

试试下面，

**演示：http:** [//jsfiddle.net/GUAFW/2/](http://jsfiddle.net/GUAFW/2/)

```
$(function () {
    var somediv = $('#container');
    $(document).click(function (e) {
        alert($(e.target).parent().is(somediv));
        //                   ^__ Just immediate childrens :(
    });
}); 
```

* * *

您可以`e.target != this`在处理程序内部检查它是父元素还是来自子元素。

**一个例子：**

**HTML：**

```
<div id="container">
   <div class="child"></div><div class="child">
</div> 
```

**JS：**

```
$(function () {
    $('#container').click(function (e) {
        alert(e.target != this);
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:48:46.500

假设`someDiv`有元素的字符串文字标识符，它不会以 为前缀`#`，所以：

```
$(document).click(function (e) {
  if ($(e.target).is("#" + somediv + " *")) {
    // some code
  } 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T15:49:08.103

试试这种方法.. 而不是 .is() 尝试使用相等选择器..

```
<div  class="hide"> 
    <span class="green" id="somediv"> YOOO </span>
</div>​

$('div').click(function(e) {
    if (e.target != this) {
        alert(((e.target.id) == 'somediv'));
    }
});​ 
```

[检查小提琴](http://jsfiddle.net/sushanth009/Pv8Cw/1/)

# xcode - Matlab 2012a Mex 在 Mountain Lion 上使用 Xcode 4.5

> ID：12643236
> 
> 赞同：4
> 
> 时间：2012-09-28T15:47:49.293
> 
> 标签：xcode, matlab, osx-mountain-lion, mex

我安装了带有 Xcode 4.5 和 Matlab 2012a 的 Mountain Lion。我安装并运行了 MathWorks 网站上提供的补丁，但仍然收到以下错误：

```
/Applications/MATLAB_R2012a.app/bin/mex: line 305: llvm-gcc-4.2: command not found
/Applications/MATLAB_R2012a.app/bin/mex: line 1326: llvm-gcc-4.2: command not found

mex: compile of ' "hello.c"' failed.
Error using mex (line 206) 
```

有没有已知的解决方案？

> 解决方法：打开Xcode --> Preferences --> Downloads --> Install "Command Line Tools"
> 
> 仍然需要 MathWorks 补丁。为我解决了问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T03:26:08.237

你不需要安装 XCode。我安装了命令行工具，然后编辑文件“/Applications/MATLAB_R2012a.app/bin/mexopts.sh”和

将 CC 从 gcc-4.2 更改为 llvm-gcc-4.2

将 CXX 从 gcc-4.2 更改为 llvm-g++-4.2

将 SDKROOT 设置为“/”

完成。现在，您只需要在 MATLAB 中运行“mex -setup”

为我工作（Mac OSX 10.8.2，命令行工具 - 2012 年 10 月，MATLAB 2012a）

# android - 将 FileTransfer-plugin 与 cordova 2.0 一起使用时出现 EPIPE（断管）错误

> ID：12643238
> 
> 赞同：7
> 
> 时间：2012-09-28T15:47:53.850
> 
> 标签：android, cordova, cordova-2.0.0

我有一个适用于 android 的 cordova 2.0 应用程序。我使用 FileTransfer 插件将一些数据加载到我的服务器。第一次执行上传，一切正常。但后来我收到 EPIPE（断管）错误。如果我只是再次按下上传按钮，它就可以工作。

如何防止错误？

```
09-28 17:31:12.304: W/FileTransfer(29497): Error getting HTTP status code from connection.
09-28 17:31:12.304: W/FileTransfer(29497): java.net.SocketException: sendto failed: EPIPE (Broken pipe)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.io.IoBridge.maybeThrowAfterSendto(IoBridge.java:506)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.io.IoBridge.sendto(IoBridge.java:475)
09-28 17:31:12.304: W/FileTransfer(29497):  at java.net.PlainSocketImpl.write(PlainSocketImpl.java:507)
09-28 17:31:12.304: W/FileTransfer(29497):  at java.net.PlainSocketImpl.access$100(PlainSocketImpl.java:46)
09-28 17:31:12.304: W/FileTransfer(29497):  at java.net.PlainSocketImpl$PlainSocketOutputStream.write(PlainSocketImpl.java:269)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.net.http.ChunkedOutputStream.writeHex(ChunkedOutputStream.java:102)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.net.http.ChunkedOutputStream.writeBufferedChunkToSocket(ChunkedOutputStream.java:128)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.net.http.ChunkedOutputStream.close(ChunkedOutputStream.java:118)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.net.http.HttpEngine.readResponse(HttpEngine.java:804)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.net.http.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:274)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.net.http.HttpURLConnectionImpl.getResponseCode(HttpURLConnectionImpl.java:486)
09-28 17:31:12.304: W/FileTransfer(29497):  at org.apache.cordova.FileTransfer.createFileTransferError(FileTransfer.java:384)
09-28 17:31:12.304: W/FileTransfer(29497):  at org.apache.cordova.FileTransfer.upload(FileTransfer.java:316)
09-28 17:31:12.304: W/FileTransfer(29497):  at org.apache.cordova.FileTransfer.execute(FileTransfer.java:85)
09-28 17:31:12.304: W/FileTransfer(29497):  at org.apache.cordova.api.PluginManager$1.run(PluginManager.java:192)
09-28 17:31:12.304: W/FileTransfer(29497):  at java.lang.Thread.run(Thread.java:856)
09-28 17:31:12.304: W/FileTransfer(29497): Caused by: libcore.io.ErrnoException: sendto failed: EPIPE (Broken pipe)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.io.Posix.sendtoBytes(Native Method)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.io.Posix.sendto(Posix.java:146)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.io.BlockGuardOs.sendto(BlockGuardOs.java:177)
09-28 17:31:12.304: W/FileTransfer(29497):  at libcore.io.IoBridge.sendto(IoBridge.java:473)
09-28 17:31:12.304: W/FileTransfer(29497):  ... 14 more
09-28 17:31:12.319: E/FileTransfer(29497): {"target":"http:\/\/10.100.150.173:8081\/mobile110\/upload","source":"content:\/\/media\/external\/images\/media\/30","code":3}
09-28 17:31:12.319: E/FileTransfer(29497): java.net.SocketException: sendto failed: EPIPE (Broken pipe)
09-28 17:31:12.319: E/FileTransfer(29497):  at libcore.io.IoBridge.maybeThrowAfterSendto(IoBridge.java:506)
09-28 17:31:12.319: E/FileTransfer(29497):  at libcore.io.IoBridge.sendto(IoBridge.java:475)
09-28 17:31:12.319: E/FileTransfer(29497):  at java.net.PlainSocketImpl.write(PlainSocketImpl.java:507)
09-28 17:31:12.319: E/FileTransfer(29497):  at java.net.PlainSocketImpl.access$100(PlainSocketImpl.java:46)
09-28 17:31:12.319: E/FileTransfer(29497):  at java.net.PlainSocketImpl$PlainSocketOutputStream.write(PlainSocketImpl.java:269)
09-28 17:31:12.319: E/FileTransfer(29497):  at libcore.net.http.ChunkedOutputStream.writeHex(ChunkedOutputStream.java:102)
09-28 17:31:12.319: E/FileTransfer(29497):  at libcore.net.http.ChunkedOutputStream.writeBufferedChunkToSocket(ChunkedOutputStream.java:128)
09-28 17:31:12.319: E/FileTransfer(29497):  at libcore.net.http.ChunkedOutputStream.write(ChunkedOutputStream.java:77)
09-28 17:31:12.319: E/FileTransfer(29497):  at java.io.DataOutputStream.write(DataOutputStream.java:98)
09-28 17:31:12.319: E/FileTransfer(29497):  at org.apache.cordova.FileTransfer.upload(FileTransfer.java:261)
09-28 17:31:12.319: E/FileTransfer(29497):  at org.apache.cordova.FileTransfer.execute(FileTransfer.java:85)
09-28 17:31:12.319: E/FileTransfer(29497):  at org.apache.cordova.api.PluginManager$1.run(PluginManager.java:192)
09-28 17:31:12.319: E/FileTransfer(29497):  at java.lang.Thread.run(Thread.java:856)
09-28 17:31:12.319: E/FileTransfer(29497): Caused by: libcore.io.ErrnoException: sendto failed: EPIPE (Broken pipe)
09-28 17:31:12.319: E/FileTransfer(29497):  at libcore.io.Posix.sendtoBytes(Native Method)
09-28 17:31:12.319: E/FileTransfer(29497):  at libcore.io.Posix.sendto(Posix.java:146)
09-28 17:31:12.319: E/FileTransfer(29497):  at libcore.io.BlockGuardOs.sendto(BlockGuardOs.java:177)
09-28 17:31:12.319: E/FileTransfer(29497):  at libcore.io.IoBridge.sendto(IoBridge.java:473)
09-28 17:31:12.319: E/FileTransfer(29497):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T07:08:32.683

我也一直在努力解决随机间歇性 HTTP 状态错误，并采用了一种解决方法，使用 var 来存储重试状态。然后，如果调用了传输失败回调，我会增加这个 var 并重试上传函数最多 3 次（尽管它不需要超过 1 次重试）：

```
var imageRetry = 0; // if upload errors, retry 3 times
...
// file transfer fail callback
function fail(error) {
    if(imageRetry < 3){
         imageRetry++;
         uploadPhoto(); // call upload function again
    }else{
        // normal failure handling
    }
} 
```

注意：服务器被列入白名单，我也尝试禁用 chunkedMode，但没有成功。我也没有使用普通或自签名 SSL。就我而言，用户可以在上传之前过滤照片。如果未应用过滤器，则上传始终成功。如果用户尝试应用任何过滤器，则上传随机失败，错误代码为 3。

（是的，我知道这个解决方案并不完全理想，但它比未恢复的故障要好。）

# html - 提高 CSS3 过渡性能

> ID：12643240
> 
> 赞同：37
> 
> 时间：2012-09-28T15:48:00.667
> 
> 标签：html, css

有没有人有关于如何提高 CSS3 动画流畅度的秘籍或技巧？我正在使用 css 过渡将整个页面向左滑动，这比我想要的要复杂一些。它是一个单一元素，但它包含许多圆角、渐变、阴影等，因为它是一个复杂的页面。

在 flash actionscript 中，有一个方便的属性`cacheAsBitmap`可以在动画开始之前将动画元素转换为位图。这是天赐之物，可以显着加快某些类型的动画。CSS有这样的东西吗？是否还有其他技巧可以在不简化页面设计的情况下提高性能？我正在考虑启用硬件加速或将动画标记为浏览器的高优先级。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-28T15:58:47.483

在[指令之前](https://stackoverflow.com/a/31538886/2190172)[，`will-change`](https://stackoverflow.com/a/31538886/2190172)您不能以与其他语言相同的字面方式执行此操作。浏览器（或者至少是 Webkit）通过绘制不同的层来处理页面的渲染。从理论上讲，它应该足够智能，可以为您计算出层，但有时将某些东西强制到自己的层中是个好主意。

有时这有效，有时无效，具体取决于发生了什么。

反正。

在 CSS 中，将某些东西强制放入图层的一种方法是使用 3D 变换对其进行变换。一个常见的策略是添加：

```
transform: translateZ(0); 
```

或等价物：

```
transform: translate3d(0,0,0); 
```

或者有点疯狂：

```
transform: rotateZ(360deg); 
```

或翻译的结合：

```
-webkit-backface-visibility: hidden;
-webkit-perspective: 1000; 
```

如果事情是闪烁的。

这些创建了一个新层，因为这是规范定义的。来自[http://www.w3.org/TR/css3-transforms/#transform-property](http://www.w3.org/TR/css3-transforms/#transform-property)，

> “除了‘none’之外的任何转换值都会导致堆叠上下文和包含块的创建。”

这些都需要仔细测试，而不是总是在任何可能需要它的东西上塞进去——有时它更好，有时它没有什么不同，有时它更糟！

祝你好运！

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2015-07-21T12:20:27.680

自从

*   铬 36
*   火狐 38
*   歌剧 30
*   安卓浏览器 40
*   适用于 Android 42 的 Chrome

[您可以使用`will-change`](http://caniuse.com/#feat=will-change)通知浏览器为硬件加速元素做准备。

```
.drawer {
    will-change: transform;
} 
```

> 该`will-change`属性允许您提前通知浏览器您可能对元素进行哪些类型的更改，以便它可以在需要之前设置适当的优化，从而避免不小的启动成本这可能会对页面的响应能力产生负面影响。**可以更快地更改和渲染元素，并且页面将能够快速更新，从而带来更流畅的体验。**

有关更多信息，您可以[阅读该](https://dev.opera.com/articles/css-will-change-property/)报价的全文。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-28T16:04:42.770

不幸的是，这受到许多事情的限制，其中许多是您无法控制的：

*   浏览器性能 - 所有浏览器在使用 CSS3 和 Javascript 时表现不同。我发现 Safari 在 CSS3 渲染性能方面名列前茅（令人惊讶？），Chrome 排在第二位，Firefox 排在第三位。
*   GPU 性能 - 一些浏览器现在将动画和过渡操作卸载到 GPU，在这种情况下，速度/性能受到 GPU 的限制。如果您使用的是集成 Intel GPU，与独立的 NVIDIA 或 AMD 显卡相比，它不太可能非常流畅。
*   CPU 性能 - 对于浏览器不卸载到 GPU 的情况，将使用 CPU，在这种情况下，您的 CPU 会成为瓶颈。
*   打开的其他选项卡/窗口的数量 - 许多浏览器跨选项卡共享进程，其他选项卡/浏览器中发生的其他动画或 CPU 消耗操作可能会导致性能下降。

目前提高性能的最佳方法是限制一次动画/过渡的事物的数量。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-28T16:01:46.057

根据我的阅读，阴影是目前最大的性能影响之一。您可以尝试在动画的开始/结束时添加/删除一个类，以暂时禁用所有阴影，并在移动后将它们淡入。

# html - 将网站嵌入另一个网站

> ID：12643246
> 
> 赞同：0
> 
> 时间：2012-09-28T15:48:21.557
> 
> 标签：html, embedding

一位客户要求能够从他的域中调用我的网络应用程序以隐藏我的域名。我记得几年前它被用来使用隐藏的 iframe ......有没有更“现代”的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:57:08.100

唯一更好的解决方案是将站点实际托管在您希望它出现的域上。

如果您不愿意在他的服务器上安装应用程序，他可能会考虑将他的 DNS 设置为指向您服务器的子域。

# box-api - 使用 v2 Box API，我如何获得评论 ID？

> ID：12643249
> 
> 赞同：1
> 
> 时间：2012-09-28T15:48:23.783
> 
> 标签：box-api

如何使用 v2 Box API 获取已创建评论的 id？方法get事件返回源null：

```
"type": "event",
"event_id": "a9051dcb5f7a54e94469d481c2d40efc878953ff",
"created_by": { ...},
"created_at": "2012-09-28T08:07:08-07:00",
"recorded_at": "2012-09-28T08:07:09-07:00",
"event_type": "COMMENT_CREATE",
"session_id": "16727932385065b9e714973",
"source": null 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:21:48.790

谢谢。我们已将此作为错误提交，并将尽快修复。/events 端点中缺少此内容。

# regex - RegEx VBA Excel 复杂字符串

> ID：12643256
> 
> 赞同：0
> 
> 时间：2012-09-28T15:48:51.243
> 
> 标签：regex, excel, vba

我有一个从[这里](https://excelicious.wordpress.com/code-samples/vba/regex-functions/)提取的函数。我的问题是我不知道我需要使用什么 RegEx 模式来拆分以下数据：

```
+1 vorpal unholy longsword +31/+26/+21/+16 (2d6+13)
+1 vorpal flaming whip +30/+25/+20 (1d4+7 plus 1d6 fire and entangle)
2 slams +31 (1d10+12) 
```

我希望它看起来像：

```
+1 vorpal unholy longsword, 31 
+1 vorpal flaming whip, 30 
2 slams, 31 
```

这是执行 RegExp 验证的 VBA 代码：

```
Public Function RXGET(ByRef find_pattern As Variant, _
                        ByRef within_text As Variant, _
                        Optional ByVal submatch As Long = 0, _
                        Optional ByVal start_num As Long = 0, _
                        Optional ByVal case_sensitive As Boolean = True) As Variant
' RXGET - Looks for a match for regular expression pattern find_pattern
' in the string within_text and returns it if found, error otherwise.
' Optional long submatch may be used to return the corresponding submatch
' if specified - otherwise the entire match is returned.
' Optional long start_num specifies the number of the character to start
' searching for in within_text. Default=0.
' Optional boolean case_sensitive makes the regex pattern case sensitive
' if true, insensitive otherwise. Default=true.

Dim objRegex As VBScript_RegExp_55.RegExp
Dim colMatch As VBScript_RegExp_55.MatchCollection
Dim vbsMatch As VBScript_RegExp_55.Match
Dim colSubMatch As VBScript_RegExp_55.SubMatches
Dim sMatchString As String

Set objRegex = New VBScript_RegExp_55.RegExp

' Initialise Regex object
With objRegex
    .Global = False
    ' Default is case sensitive
    If case_sensitive Then
        .IgnoreCase = False
    Else: .IgnoreCase = True
    End If
    .pattern = find_pattern
End With

' Return out of bounds error
If start_num >= Len(within_text) Then
    RXGET = CVErr(xlErrNum)
    Exit Function
End If
sMatchString = Right$(within_text, Len(within_text) - start_num)

' Create Match collection
Set colMatch = objRegex.Execute(sMatchString)
If colMatch.Count = 0 Then ' No match
    RXGET = CVErr(xlErrNA)
Else
    Set vbsMatch = colMatch(0)
    If submatch = 0 Then ' Return match value
        RXGET = vbsMatch.Value
    Else
        Set colSubMatch = vbsMatch.SubMatches ' Use the submatch collection
        If colSubMatch.Count < submatch Then
            RXGET = CVErr(xlErrNum)
        Else
            RXGET = CStr(colSubMatch(submatch - 1))
        End If
    End If
End If
End Function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T17:29:20.220

我不了解 Excel，但这应该可以帮助您开始使用 RegEx：

```
/(?:^|, |and |or )(\+?\d?\s?[^\+]*?) (?:\+|-)(\d+)/ 
```

**注意：**这里有一点警告。`+`如果元素仅以开头（后面没有数字），这也将匹配。

捕获组 1 和 2 包含逗号左右的字符串（如果整个模式的索引为 0）。所以你可以这样做`capture[1] + ', ' + capture[2]`（无论你的语法是什么）。

这是正则表达式的解释：

```
/(?:^|, |and |or )         # make sure that we only start looking after
                           # the beginning of the string, after a comma, after an
                           # and or after an or; the "?:" makes sure that this
                           # subpattern is not capturing
 (\+?                      # a literal "+"
 \d+                       # at least one digit
                           # a literal space
 [^+]*?)                   # arbitrarily many non-plus characters; the ? makes it
                           # non-greedy, otherwise it might span multiple lines
                           # a literal space
 \+                        # a literal "+"
 (\d+)/                    # at least one digit (and the brakets are for capturing) 
```

# jquery - 如果我只有一个类，如何在 div 中显示一个元素？

> ID：12643261
> 
> 赞同：-1
> 
> 时间：2012-09-28T15:49:07.907
> 
> 标签：jquery, function, hover

我有以下代码：

```
$('.my-image').function(){
   $(this + ' div').show();
},
function(){
   $(this + ' div').hide();
}); 
```

我知道它不起作用，因为我请求一个带有 div 的对象，但我不知道我应该如何更明确。

```
<div id='galery'>
   <div class='my-image'><div></div></div>
   <div class='my-image'><div></div></div>
</div> 
```

我应该如何调用 jquery 函数来显示内部 div（子 div）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:50:39.987

`this`是一个 DOM 元素；您不能将其连接到选择器中。

你正在尝试写

```
$(this).find('div') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T15:51:09.750

```
$(this + ' div').show(); 
```

应该

```
$(this).find("div").show(); 
```

或者

```
$("div", this).show() 
```

`this`是一个对象，而不是一个字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:52:52.570

带孩子试试：

```
$('.my-image').function(){
   $(this).children('div').show();
},
function(){
   $(this).children('div').hide();
}); 
```

# ssh - 执行期望命令时出现错误的 spawn_id

> ID：12643264
> 
> 赞同：1
> 
> 时间：2012-09-28T15:49:37.053
> 
> 标签：ssh, expect

我正在编写一个脚本，它将 Valgrind 复制到我们在命令行输入的任何架子上。语法如下：

> vgrindCopy [货架号]

出于某种原因，文件将毫无问题地复制过来，但是在复制完成后会观察到以下错误：

**错误的 spawn_id （进程提前死亡？）在执行“expect”#”时**

以下是相关代码的副本：

```
 function login_shelf {
    expect -c "
    set timeout 15 
    spawn $1 
    expect \"password:\"
    send \"$PW\r\"
    expect \"#\"
    sleep 1
    exit
    "
    }
# login and make the valgrind directory at /sfs/software/shelf/current
set -- /opt/swe/tools/ext/gnu/valgrind-3.7.0/i686-linux2.6/lib/valgrind/*
login_shelf "/opt/corp/projects/shelftools/bin/app rsync -Lau $* $shelf:/shelf/valgrind" 
```

在玩弄了代码之后，我发现如果我删除“ `expect \"#\"`”行，那么程序就不会再复制任何文件了。奇怪的是，我在运行脚本时看到了问题，但同事却没有。

有没有人遇到过类似的问题并确定原因？任何帮助将一如既往地不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:56:33.240

您的代码正在生成`rsync`and 在`expect \"#\"`等待 rsync 输出 a `#`，但它永远不会这样做，因此它退出并`expect`报告错误。

当您删除`expect \"#\"`期望脚本退出时，终止 rsync。

而不是`expect \"#\"`你应该等待 rsync 退出：

```
expect eof
wait 
```

# ruby-on-rails - 将 Devise gem 身份验证与 Mobile (Rails) 一起使用的正确方法是什么

> ID：12643269
> 
> 赞同：3
> 
> 时间：2012-09-28T15:50:04.977
> 
> 标签：ruby-on-rails, devise, titanium-mobile

我在我的应用程序中使用 Devise gem 进行 Web 身份验证。

现在我要为我的应用程序编写一个移动应用程序，其中包括登录/注册过程。

我应该使用什么正确方法来登录用户并验证用户从移动应用程序发出的每个呼叫？

以下哪个策略是正确的？（我不确定采用哪种方法更安全）

![在此处输入图像描述](../Images/0255543ff3227d894022f8c501df220f.png)

**注：上图可以在[http://i.stack.imgur.com/I13uT.png](https://i.stack.imgur.com/I13uT.png)查看（会更清晰）**

**仅供参考：我正在使用 Titanium 开发移动应用程序，我的后端服务器运行 Rails 应用程序**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T17:15:27.807

模型 #1 不安全，您没有在后续请求中通过任何类型的身份验证来验证用户仍然是他们所说的那个人。

我假设您真正想知道的是，登录后验证用户身份的最佳方法[是](https://stackoverflow.com/questions/8836238/exposing-rails-devise-authentication-to-ios-application/8840086#8840086)什么适用于此。

在 Devise 中使用令牌身份验证将匹配模型 #2，并且也是最安全的，因为您将用户名/密码交换为令牌，而不必存储其用户名和密码并在每个请求中重用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T17:32:19.423

我不确定#1 是如何安全的，因为后续请求都没有以任何方式签名。如果有人知道您的应用程序的文件结构，他们可以通过这种方式访问​​它，对吗？

使用 Devise，您可以在`User`模型上设置属性以允许通过令牌对用户进行身份验证：

```
class User < ActiveRecord::Base
  devise :token_authenticatable
  # there are other details and options on this, but this is the relevant piece
end 
```

`before_filter :authenticate_user!`在每个控制器上，您还可以通过在开头包含以下内容来验证用户是否已通过身份验证：

```
class PostsController < ActionController::Base
  before_filter :authenticate_user!
end 
```

从移动应用发出请求时，请在请求中包含 auth_token，以便 Rails 应用可以在响应之前进行身份验证。

除了身份验证之外，您可能还对[CanCan](https://github.com/ryanb/cancan)之类的东西来处理授权感兴趣。

# c# - 如何在错误时停止asp UpdateProgress？

> ID：12643274
> 
> 赞同：0
> 
> 时间：2012-09-28T15:50:18.137
> 
> 标签：c#, asp.net, asynchronous, updateprogress

我有一个带有微调器的更新进度。单击搜索按钮时，微调器会显示，当它得到响应时，微调器会消失。这都是由 listview 和 asp 更新进度控件自动完成的。

但是，我发现如果在此异步回发期间服务器端发生错误，或者回发时间过长，则微调器将无限期地保持旋转。

有没有办法识别是否发生错误或请求是否超时然后卸载更新进度？我可能正在通过脚本管理器识别错误，但迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:04:05.337

请参阅：[http](http://forums.asp.net/t/1266920.aspx) : //forums.asp.net/t/1266920.aspx 它本质上是说您必须通过附加到 Sys.Application.beginRequest 和 endRequest 手动操作元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:04:18.870

如果您还没有尝试使用 PageRequestManager 类的 beginRequest 和 endRequest 事件：http: [//msdn.microsoft.com/en-us/library/bb398821%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/bb398821%28v=vs.100%29.aspx)

我以前使用过这些进度微调器，但没有注意到这个问题。

# matlab - Matlab 3d矩阵

> ID：12643279
> 
> 赞同：7
> 
> 时间：2012-09-28T15:50:45.987
> 
> 标签：matlab, sparse-matrix

我必须创建一个非常大的 3D 矩阵（例如：）`500000x60x60`。在matlab中有什么方法可以做到这一点吗？

当我尝试

```
omega = zeros(500000,60,60,'single'); 
```

我得到一个`out-of-memory`错误。

稀疏函数不是选项，因为它仅适用于 2D 矩阵。那么对于高维矩阵，有什么替代方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T17:56:04.470

Matlab 仅支持稀疏矩阵 (2D)。对于 3D 张量/数组，您必须使用一种解决方法。我能想到两个：

1.  线性索引
2.  元胞数组

## 线性索引

您可以像这样创建一个稀疏向量：

```
A = spalloc(500000*60*60, 1, 100); 
```

其中最后一个条目 ( `100`) 是指最终分配给 的非零的数量`A`。如果您事先知道这个数量，它会提高内存使用`A`效率。如果您事先不知道它，只需使用接近它的一些数字，它仍然可以工作，但最终`A`会消耗比它严格需要的更多的内存。

然后你可以像这样引用元素，就好像它是一个 3D 数组：

```
A(sub2ind(size(A), i,j,k)) 
```

其中`i`和分别是第 1、第 2`j`和`k`第 3 维的索引。

## 元胞数组

将 3D 张量/数组中的每个 2D 页面创建为元胞数组：

```
a = cellfun(@(x) spalloc(500000, 60, 100), cell(60,1), 'UniformOutput', false); 
```

最后一个条目也是如此`spalloc`。然后像这样在 3D 中连接：

```
A = cat(3, a{:}); 
```

那么您可以像这样引用单个元素：

```
A{i,j,k} 
```

其中`i`和分别是第 1、第 2`j`和`k`第 3 维的索引。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-28T17:15:00.047

由于您的矩阵是稀疏的，请尝试使用[ndsparse](http://www.mathworks.com/matlabcentral/fileexchange/29832-n-dimensional-sparse-arrays)（N 维稀疏数组 FEX）

# ios - iOS后台限制是否允许http？

> ID：12643280
> 
> 赞同：1
> 
> 时间：2012-09-28T15:50:46.840
> 
> 标签：ios, cllocationmanager, background-process, multitasking

我想在我的应用程序的后台运行一个进程，获取用户当前的纬度/经度（每隔 5 分钟）并通过 Web 服务调用将其报告回我们的服务器。当我将所需的背景模式添加到我的 info.plist 时，我有以下选项：

`-App plays audio`

`-App registers for location updates`

`-App provides Voice over IP services`

现在在我的情况下，我显然需要列表中的第二个选择，但是一旦我有了位置，我能用它做什么？我可以在后台进行网络服务调用吗？可能还有什么其他限制？

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T17:39:08.447

当您的应用程序处于后台模式时，您无法以通常的方式建立 HTTP 连接。您必须设置一个后台任务，将位置更新发送到您的服务器。

我找到了一个简短的[教程](http://www.mindsizzlers.com/2011/07/ios-background-location/)，它涵盖了您正在寻找的内容（我没有测试过代码）。

**这是它如何工作的摘要**
当您的应用程序在后台运行并且发生位置更改时，iOS 会唤醒您的应用程序并调用`locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation`您的 CLLocationManager 的委托方法。发生这种情况时，请检查您的应用程序是否在后台运行，如果是则设置后台任务。然后后台任务应该将数据发送到您的服务器。

**限制**

*   [文档](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)不清楚这样的后台任务可能需要多长时间才能完成，但我稍微记得最多大约 10 分钟。

*   据我所知，当您的应用程序在后台运行时，您无法更新 UI

# lua - 在 giderous studio 中使用计时器和影片剪辑时的奇怪情况

> ID：12643281
> 
> 赞同：2
> 
> 时间：2012-09-28T15:50:49.027
> 
> 标签：lua, gideros

我目前正在使用 giderous studio 制作一款塔防游戏。但是代码没有按预期运行。

我制作了一个函数，使游戏中的怪物根据 JSON 文件中确定的路线移动。移动过程很顺利，除了第一个怪物被生成了firet，我完全不知道为什么怪物会停下来。（如图所示） ![在此处输入图像描述](../Images/bfc8b2006a620eb7648890ed82bc165d.png)

以下是我的代码：

级别.lua：

```
 level = Core.class(Sprite)

function level:init(levelId)
    local level = dataSaver.load("level");

    --load attributes
    self.lives=level[tostring(levelId)]["lives"];
    self.route=level[tostring(levelId)]["route"];
    self.round=level[tostring(levelId)]["rounds"];
    self.towersAllowed=level[tostring(levelId)]["towers"];

    --some varibles
    self.currentRound=1;
    self.monsterList={};
end

function level:spawnMonster()
    local monsterType=self.round[1]["type"];
    local spawnNumber=self.round[1]["number"];

    --set timer for spawn
    local timer = Timer.new(self.round[1]["spawnInterval"],0);--spawnNumber);
    timer:start();

    --spawn
    timer:addEventListener(Event.TIMER,function()
        local spawnedMonster = monster.new(monsterType);
        spawnedMonster.instance:setPosition(self.route[1]["x"],self.route[1]["y"]);
        self:moveMonster(spawnedMonster);
    end);

    --after spawn finished, wait for next round.
    timer:addEventListener(Event.TIMER_COMPLETE,function()
        local nextRound = Timer.new(self.round[1]["timeUntilNextRound"],1);
        nextRound:start();
        nextRound:addEventListener(Event.TIMER_COMPLETE,function()
            print("nextRound");
        end);
    end);
end

function level:moveMonster(monsterToMove)
    if  (monsterToMove.currentDes<=#self.route) then
        monsterToMove:move(self.route[monsterToMove.currentDes]["x"],self.route[monsterToMove.currentDes]["y"]);
        monsterToMove:addEventListener("monsterMoveDone",function()
            monsterToMove.currentDes=monsterToMove.currentDes+1;
            self:moveMonster(monsterToMove);
        end);
    end
end 
```

怪物.lua：

```
monster = Core.class(Sprite)

function monster:init(type)
    local monstersList = dataSaver.load("monster");
    self.instance = quickImage(monstersList[type]["image"], _W/2, _H/2,monstersList[type]["width"], monstersList[type]["height"]);
    self.speed=monstersList[type]["speed"];
    self.health=monstersList[type]["health"];
    stage:addChild(self.instance);

    ---some varibles...
    self.currentDes=2
end

function monster:move(desX,desY)
    local time=getDistance(math.abs(self.instance:getX()-desX),math.abs(self.instance:getY()-desY))/self.speed
    local mc = MovieClip.new{
        {1, time, self.instance, {x = {self.instance:getX(), desX, "linear"}}},
        {1, time, self.instance, {y = {self.instance:getY(), desY, "linear"}}},
    }
    mc:addEventListener(Event.COMPLETE,function()
        self:dispatchEvent(Event.new("monsterMoveDone"))   
    end);
end 
```

从代码中，quickImage(); 只是制作图像精灵的一个小功能任何想法，我想也许我让内存分配错误。

特别说明。我使用 Wine 在 OpenSUSE 12.2 下运行 Gideros Studio，但我认为这不是问题，因为一切都很顺利。

# javascript - 为什么 href 在本地站点上不起作用？

> ID：12643286
> 
> 赞同：1
> 
> 时间：2012-09-28T15:51:00.873
> 
> 标签：javascript, asp.net, html, permissions

我想将指向本地 html 网站的新链接添加到网站上的菜单列表中。主要网站在 aspx 中，但我正在处理 html 副本。引用的链接指向我本地机器上的一个 html 网站。

```
<li><a href="C:/Users/User/Desktop/Consulting.html"><b>Custom Solutions</b><br />
Custom Software Applications and Solutions</a></li> 
```

如果我将 href 替换为 www.google.com ，则链接指向谷歌。但它不适用于本地网站。`C:/Users/User/Desktop/Consulting.html`是从 aspx 网站下载的网站。

href 是因为权限被拒绝还是因为本地网站来自 aspx 网站而无法工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:53:28.537

那应该是

```
<a href="file:///C:/Users/User/Desktop/Consulting.html"></a> 
```

只有当您正在查看的 HTML 文件在您的本地计算机上时，它才会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:53:45.390

尝试：

```
<li><a href="file:///C:/Users/User/Desktop/Consulting.html"><b>Custom Solutions</b><br />
Custom Software Applications and Solutions</a></li> 
```

# c# - 表单关闭前显示的 MessageBox

> ID：12643288
> 
> 赞同：1
> 
> 时间：2012-09-28T15:51:14.380
> 
> 标签：c#, .net, winforms

为什么在表单关闭之前显示消息框？

```
SomeForm myForm = new SomeForm();
myForm.Show();
MessageBox.Show("Some text"); 
```

我是否需要启动一个新线程并等待它完成？我以前从未遇到过这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:52:43.480

您需要改用[Form.ShowDialog()](http://msdn.microsoft.com/en-us/library/c7ykbedk.aspx)。Form.Show 显示一个非模式窗口，而 Form.ShowDialog 显示一个模式窗体，即用户必须关闭才能继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:05:31.943

如果在显示其他表单时用户无法与主表单交互很重要，那么您可以`myForm.ShowDialog`使用`Show`. `ShowDialog`是一个阻塞函数，所以在另一个表单关闭之前它不会返回。 `Show`，另一方面，只显示另一个表单，然后立即返回，而无需等待表单关闭。

如果故意不以模态方式显示另一个表单，并且您没有（或不能）进行更改，那么您可以使用事件在另一个表单关闭时显示一个消息框。

```
SomeForm myForm = new SomeForm();
myForm.FormClosed += (form, args) =>
{
    MessageBox.Show("Some text");
};
myForm.Show(); 
```

这将添加一个事件处理程序，该处理程序在另一个窗体关闭时触发，并在适当的时间执行所需的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T15:56:01.150

这样做的原因是`myForm.Show();`开始打开一个新窗口，但它不是阻塞调用。它不是一个对话框，它是一个单独的窗口，它自己运行。

如果您希望 SomeForm 显示为 Dialog（阻塞窗口，等待关闭以继续执行），请使用`ShowDialog`. 如果要等到窗口打开再显示 MessageBox，则将 MessageBox 添加到 SomeForm claa 上的 OnLoaded。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T15:53:18.443

您的示例从未真正关闭`myForm`...仅显示它。我希望上面的代码显示`myForm`然后立即显示`MessageBox`.

如果您想`myForm`在显示 MessageBox 之前关闭，您需要`myForm.Close()`在某个时候调用。

# sql-server - 将查询结果传递给存储过程

> ID：12643289
> 
> 赞同：3
> 
> 时间：2012-09-28T15:51:20.007
> 
> 标签：sql-server, stored-procedures

我有一个接受三个参数的存储过程。

是否可以使用查询作为输入来调用此存储过程？

例如，我有`tableA`.

```
SELECT * FROM TABLEA 

| A | B | C |
|---+---+---|
| 1 | 2 | 3 |
| 4 | 5 | 6 | 
```

现在，有没有办法可以打电话

```
EXEC sp_name (SELECT * FROM TABLEA) 
```

以便为每一行执行存储过程？

我背后的原因是我有一个需要为多行调用的存储过程。我可以编写一个脚本来执行此操作，但想知道是否可以使用 TSQL 执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-16T11:24:14.923

此解决方案假设 T-SQL 在 SQL SERVER 2008 及更高版本上运行

1.  创建一个表类型变量，这只需要做一次 `USE YOURDBNAME;` Go `Create TYPE TableAType as Table (A int null,B int null, C int null);` 这将在您当前使用的数据库中的用户定义的表类型中创建一个表类型变量。

2.  在您的存储过程中，声明此表类型的变量。并使用表 A 中的内容填充它。示例：

    ```
    Create Procedure MyStoredProcedure1 AS Declare @TableB as TableAType; 
    Insert into @TableB(A,B,C) Select A,B,C from TableA; 
    ```

3.  创建您的主存储过程

    ```
    Create Procedure MyStoredProcedure2
    @TVP TableAType READONLY
    as 
    EXEC sp_Name @TVP; 
    ```

这应该为您完成工作，如需进一步参考，请参阅下面的链接# [http://msdn.microsoft.com/en-us/library/bb510489%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/bb510489%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:15:52.420

完成此操作的最佳方法是将您的第二个存储过程创建为用户定义的函数。然后你可以这样调用它：

```
SELECT * 
FROM TableA
CROSS APPLY dbo.yourUserFunction(column1, column2, etc) 
```

或者，可能有一种方法可以将两个存储过程组合成一个集合，但我必须看看你调用的第二个存储过程是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:03:25.803

从技术上讲，是的，但是您对 sproc 的调用格式错误。

```
Exec sp_name 'SELECT * FROM TABLEA' 
```

或者

```
Exec sp_name @sql1 = 'SELECT * FROM TABLEA' 
```

也就是说，您尝试做的事情可能不是一个好主意。

# c++ - VS 2012 中的 SQLAPI++

> ID：12643295
> 
> 赞同：0
> 
> 时间：2012-09-28T15:51:59.777
> 
> 标签：c++, visual-studio-2012

我正在尝试使用`SQLapi`Visual Studio 2012 x64 内部的库，但`SQLapi`没有 lib & dll。

Visual Studio 2012 所以我使用了 Visual Studio 2010 dll 和 lib 中的旧版本。

首先，即使对于 Visual Studio 2010 x64，我也没有找到错误`msvcr100d.dll`（我认为它适用于 Visual Studio 2010）。

安装了 Redistributal，我手动添加了调试文件夹，然后我运行程序，我得到了另一个错误。

> 应用程序无法正确启动 (0xc000007b)。单击确定关闭应用程序。

这可能是由于调试模式造成的，所以我将其更改为发布模式，但出现 22 个链接器错误，这是怎么回事？我没有得到确切的问题。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-25T12:56:57.587

SQLAPI 团队在较新版本中解决了这个问题。

# jsf-2 - primefaces 树显示一个列表

> ID：12643296
> 
> 赞同：0
> 
> 时间：2012-09-28T15:52:00.517
> 
> 标签：jsf-2, tree, primefaces

我已经从 primefaces 多选树展示页面复制了 XHTML 和托管 bean 代码（对于基本树展示，我也得到了相同的结果）。

这是我的`index.xhtml`：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Insert title here</title>
</head>
<body>
    <h:form id="form">

        <p:growl id="messages" showDetail="true" escape="false" />

        <p:tree value="#{treeBean.root}" var="node" selectionMode="multiple"
            selection="#{treeBean.selectedNodes}" id="treeMultiple">

            <p:treeNode>
                <h:outputText value="#{node}" />
            </p:treeNode>
        </p:tree>

        <p:commandButton value="Display Selected" update="messages"
            actionListener="#{treeBean.displaySelectedMultiple}" id="btnDisplay" />

    </h:form>

</body>
</html> 
```

这是豆子：

```
package org.primefaces.examples.view;

import java.io.Serializable;

import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;

import org.primefaces.model.DefaultTreeNode;
import org.primefaces.model.TreeNode;

@ManagedBean
public class TreeBean implements Serializable {

    private TreeNode root;

    private TreeNode[] selectedNodes;

    public TreeBean() {
        root = new DefaultTreeNode("Root", null);
        TreeNode node0 = new DefaultTreeNode("Node 0", root);
        TreeNode node1 = new DefaultTreeNode("Node 1", root);
        TreeNode node2 = new DefaultTreeNode("Node 2", root);

        TreeNode node00 = new DefaultTreeNode("Node 0.0", node0);
        TreeNode node01 = new DefaultTreeNode("Node 0.1", node0);

        TreeNode node10 = new DefaultTreeNode("Node 1.0", node1);
        TreeNode node11 = new DefaultTreeNode("Node 1.1", node1);

        TreeNode node000 = new DefaultTreeNode("Node 0.0.0", node00);
        TreeNode node001 = new DefaultTreeNode("Node 0.0.1", node00);
        TreeNode node010 = new DefaultTreeNode("Node 0.1.0", node01);

        TreeNode node100 = new DefaultTreeNode("Node 1.0.0", node10);
    }

    public TreeNode getRoot() {
        return root;
    }

    public TreeNode[] getSelectedNodes() {
        return selectedNodes;
    }

    public void setSelectedNodes(TreeNode[] selectedNodes) {
        this.selectedNodes = selectedNodes;
    }

    public void displaySelectedMultiple(ActionEvent event) {
             if(selectedNodes != null && selectedNodes.length > 0) {
                 StringBuilder builder = new StringBuilder();

            for(TreeNode node : selectedNodes) {
                builder.append(node.getData().toString());
                builder.append("<br />");
            }

  FacesMessage message = new FacesMessage(FacesMessage.SEVERITY_INFO, "Selected",builder.toString());

            FacesContext.getCurrentInstance().addMessage(null, message);
        }
    }
} 
```

我得到的只是一个简单的列表：

> • 节点 0
> • 节点 1
> • 节点 2

看起来缺少 Ajax、CSS 或/和 JavaScript 代码......但没有提到在展示中添加它。谢谢您的帮助！

tomcat 7 eclipse juno webapp 配置：jsf 2.1 动态webapp 3.0 java 6

# objective-c - 在 Objective-C 中获取 NSDecimalNumber 的指数？

> ID：12643297
> 
> 赞同：8
> 
> 时间：2012-09-28T15:52:03.043
> 
> 标签：objective-c, ios

给定一个 NSDecimalNumber，我怎样才能找到指数（比例）？

虽然原则上应该可以通过首先转换为 NSString 然后进行一些丑陋的字符串操作来做到这一点，但我宁愿避免它。

使用 Java BigDecimal，我可以调用[scale()](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html#scale%28%29)方法来获取比例。

NSDecimalNumber 是否存在类似的简洁方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:08:58.057

如果您出于某种原因确实需要指数（除了简单的显示，您可以配置一个数字格式化程序给您），您可以使用该`-doubleValue`方法获取原始双精度值，然后用于`frexp(3)`获取尾数和指数值。

用于执行和存储浮点数学的对象背后的整个设计是您可以更有效地处理计算和精度错误，但是，该设计的限制是一旦您从标量（例如 a`double`或尾数和指数的组合)，您应该留在对象框架内，而不是转换回（可能）不太精确的格式。

我建议使用`-doubleValue`是最好的选择，因为其他答案建议访问可能会更改的私有结构记录，并且使用这些建议没有精度损失，而事实上，很可能存在（如头文件中所述）。转换为双精度时，您和使用/阅读您的代码的人确切地知道可能出现的精度错误，因为该类型已被很好地理解并且有很好的文档记录。

最后，如果您想确定转换是否会导致错误，您可以创建并使用一个[NSDecimalNumberHandler](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumberHandler_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40003645)，它将为您提供有关在转换为双标量类型时可能会出现什么样的舍入/精度错误的信息。

我还建议您使用苹果错误报告器添加一个增强请求，说明您希望直接访问指数以及可能添加更高精度的类型，如`-longDoubleValue`方法。

*编辑包含更多信息*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T16:10:58.977

您可以访问它`NSDecimal`：

```
int exponent = decimalNumber.decimalValue._exponent; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:07:33.423

不，看起来[NSDecimalNumber](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html)没有等价物。我想你可能必须自己写。

但是，如果您不介意深入研究（并忽略文档警告），您可能会查看从中返回的[NSDecimal 结构](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html#//apple_ref/doc/uid/20000018-BAJEJDDJ)[`-decimalValue`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html#//apple_ref/doc/uid/20000179-decimalValue)- 它有许多您可能会得到的字段。这在主观上是否比您的 NSString 操作更好或更差取决于您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-17T16:23:43.187

如果您想让表达式采用 base-10 形式（frexp(3) 似乎只做 base-2），您可以试试这个：

```
double mantissa = [someDecimalNumber doubleValue];
int exp = 0;

if (mantissa >= 1.0f) {
    while (mantissa >= 1.0f) {
        mantissa = mantissa / 10.0f;
        exp++;
    }
} else {
    while (mantissa*10.0f < 1.0f) {
        mantissa = mantissa * 10.0f;
        exp--;
    }
}

NSLog(@"%f = %f x 10^%d", [someDecimalNumber doubleValue], mantissa, exp); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-29T12:02:59.417

您可以将该数字与`NSDecimalNumber`尾数等于 1 的实例进行比较，从而更改指数。它可以像二进制搜索一样工作。

# sql - 带有基本表的小型 SQL 任务

> ID：12643298
> 
> 赞同：0
> 
> 时间：2012-09-28T15:52:03.343
> 
> 标签：sql

好的，所以我们有练习表“员工”，它具有以下属性：fname（名字）、lname（姓氏）、bdate（出生日期）、薪水、dno（部门编号）。

小任务是我列出每个部门的所有员工，按部门分组，并根据最大的年龄为每个部门选择一个领导。

我只能提取每个部门的最低出生日期，但我无法提取部门中年龄最大的家伙的名字和姓氏。我写了这一行：

```
SELECT dno,COUNT(*),MIN(bdate) FROM employees GROUP BY dno; 
```

我不知道如何做到这一点，而不是出生日期，它会写下出生日期最低的员工的名字和姓氏。

你能帮助我吗？我学得很快，但我不能很好地理解手册。我只猜我需要使用 HAVING 功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:55:41.620

```
select e.dno, e.fname, e.lname, em.Count
from employees e
inner join (
    select dno, min(bdate) as minbdate, count(*) as Count
    from employees
    group by dno
) em on e.dno = em.dno and e.bdate = em.minbdate 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:00:49.357

```
select e.dno, total, e.bdate, fname, lname
from (
        SELECT 
            dno,
            COUNT(*) as total,
            MIN(bdate) as bdate,
        from employees
        GROUP BY dno
    ) s
    inner join
    employees e on e.dno = s.dno and e.bdate = s.bdate
order by dno 
```

# url - 如何通过 URL（网络请求）执行 YouTrack 命令？

> ID：12643301
> 
> 赞同：1
> 
> 时间：2012-09-28T15:52:26.810
> 
> 标签：url, webrequest, youtrack

我需要通过网络请求执行一些 YouTrack 命令。
例如，通过在 URL 中加载具有特定参数的页面来更改问题状态。

```
http://YouTrackServer/issues/Issue-12&newState=Fixed 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T19:35:17.570

您可以使用此方法：[http](http://confluence.jetbrains.net/display/YTD4/Apply+Command+to+an+Issue) ://confluence.jetbrains.net/display/YTD4/Apply+Command+to+an+Issue 在您的情况下，请求将是

```
http://YouTrackServer/rest/issues/Issue-12/execute&command=Fixed 
```

请注意，在“命令”参数中，您可以使用可以从 YouTrack 网络用户界面应用的任何命令

# visual-studio - 如何在 Visual Studio 中停止构建？

> ID：12643302
> 
> 赞同：23
> 
> 时间：2012-09-28T15:52:31.337
> 
> 标签：visual-studio

在 Visual Studio 中，如何停止构建？

> 必须先停止构建，然后才能关闭解决方案。

![在此处输入图像描述](../Images/cbde45cbeb5b779746529a89dd00fb2b.png)

我在 MSDN [http://msdn.microsoft.com/en-us/library/bb399140.aspx](http://msdn.microsoft.com/en-us/library/bb399140.aspx)上找到了这篇文章，但它是关于 Team Fortress Server 而不是 Visual Studio

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-28T15:54:37.437

在主菜单中单击构建 -> 取消

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-28T15:54:55.363

您可以在菜单中使用`Ctrl`+`Break`或 Build -> Cancel

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-02T15:45:19.407

Ctrl + Break 主要工作。在某些键盘中，“Break”键可能只有“Pause”字样。

如果构建为“已排队”，请在构建资源管理器的“已排队”选项卡中右键单击正在进行的构建定义名称，然后单击下拉菜单上的“停止”。或者，您可以单击 Build Explorer 的 Queued 选项卡工具栏中的 Stop 图标。

[MSDN 链接](https://msdn.microsoft.com/en-us/library/bb399140(v=vs.90).aspx)

# php - 访问目录时 mod_rewrite 不起作用

> ID：12643303
> 
> 赞同：0
> 
> 时间：2012-09-28T15:52:34.423
> 
> 标签：php, apache, mod-rewrite, url-rewriting

我正在使用 php 开发一个网站。
我想使用 URL 的第一个目录名称作为 php 的参数。

我有以下重写规则：

```
RewriteRule ^([a-z][a-z])/(.*)$ xyz/$2?first-dir=$1 [L] 
```

当我访问`http://example.com/aa/b/`时，
`/xyz/b/index.php`使用参数执行`first-dir=aa`。
并且浏览器地址栏中的 URL 是`http://example.com/aa/b/`（与输入 URL 相同）。

但是当我访问`http://example.com/aa/b`（不拖尾`/`）时，
地址栏中的 URL 变为`http://example.com/xyz/b/?first-dir=aa`.
我不想向用户显示这个重写的 URL。

为什么会这样？
如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T18:19:46.173

这是 mod_dir 并`DirectorySlash`干扰您的 URI。当 Apache 发现您的 URI 指向一个目录但缺少尾部斜杠时，它将 301 将客户端重定向到带有尾部斜杠的相同 URI。正在应用您的规则， mod_dir 看到这`/aa/b`是一个目录，因此它将浏览器重定向到`/aa/b/`. 您只需要检查规则中的尾部斜杠：

```
RewriteRule ^([a-z][a-z])/(.*?)/?$ xyz/$2/?first-dir=$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:31:33.470

如果带有 / 的 URL`index.php`将被执行

修复的错误： `RewriteRule ^([a-z][a-z])/(.*)$ xyz/$2/index.php?first-dir=$1 [L]`

# javascript - 不同文档就绪处理程序之间的区别

> ID：12643304
> 
> 赞同：1
> 
> 时间：2012-09-28T15:52:35.960
> 
> 标签：javascript, jquery, document-ready

N00b 在这里。如果这是一个不好的问题，请提前道歉。

*实际上*，这两个 jQuery 声明之间有什么区别（如果有的话）？

```
$(document).ready(function(){
    alert("I'm so loaded 1.");
}); 
```

和

```
$('document').ready(function(){
    alert("I'm so loaded 2.");
}); 
```

在相关的说明中，为什么这会起作用......

```
$(document).on('ready',function() {
    alert("I'm so loaded 3.");
}); 
```

...但这不是吗？

```
$('document').on('ready',function() {
    alert("I'm so loaded 4.");
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:55:03.400

该`.ready`方法忽略传入的选择器，因为可以调用它的唯一有效对象是文档。不建议使用`.on`或`.bind`与`ready`事件一起使用。此外，您永远不应该使用`'document'`，因为`document`您始终可以直接使用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-28T15:57:16.160

我从未见过它用作

```
$('document').ready(function(){
    alert("I'm so loaded 2.");
}); 
```

之前并从 bjkeefe 的评论和 Kevin B 的回答中收集，这是无效的。

```
$(document).ready(function(){
    alert("I'm so loaded 1.");
}); 
```

意味着一旦页面完全加载，执行该函数。这很有用，因为当页面仍在加载并且特定元素尚未加载时，没有 jQuery 将尝试执行。

```
$(document).on('ready',function() {
    alert("I'm so loaded 3.");
}); 
```

该`on`函数意味着应用于动态创建元素的任何事件仍将正常工作，但我以前从未`on`以这种方式使用过，所以我不能保证它会在这种情况下工作，我通常使用`on`类似的东西`click`，`hover`等等. 因为它的作用是确保应用于动态创建的元素（页面加载后创建的元素）的任何 jQuery 仍然可以正常工作`on`，所以 jQuery 可以正常工作在文档中包含的元素上，但不能正常工作在动态生成的元素上。

# algorithm - Lua 中的 Bentley-Ottmann 算法

> ID：12643305
> 
> 赞同：4
> 
> 时间：2012-09-28T15:52:36.073
> 
> 标签：algorithm, math, lua, polygons

我正在 Lua 中实现 Bentley-Ottmann 算法，以使用位于[此处](http://softsurfer.com/Archive/algorithm_0108/algorithm_0108.htm)的伪代码查找多边形中的交叉点。

我对实现算法比较陌生，所以我无法理解它的所有部分。到目前为止，这是我的代码：

```
local function getPolygonIntersectingVertices( poly )
  -- initializing and sorting X
  local X = {}
  for i = 1, table.getn( poly ) do
    if i == 1 then
      table.insert( X, { x = poly[i].x, y = poly[i].y, endpoint = 'left' } )
    elseif i == table.getn( poly ) then
      table.insert( X, { x = poly[i].x, y = poly[i].y, endpoint = 'right' } )
    else
      table.insert( X, { x = poly[i].x, y = poly[i].y, endpoint = 'right' })
      table.insert( X, { x = poly[i].x, y = poly[i].y, endpoint = 'left' })
    end
  end

  local sortxy = function( a, b )
    if a.x < b.x then return true
    elseif a.x > b.x then return false
    elseif a.y <= b.y then return true
    else return false end
  end
  table.sort( X, sortxy )

  -- Main loop
  local SL = {}
  local L = {}
  local E
  local i = 1
  while next(X) ~= nil do
    E = { x = X[i].x, y = X[i].y, endpoint = X[i].endpoint }
    if E.endpoint == 'left' then
      -- left endpoint code here
    elseif E.endpoint == 'right' then
      -- right endpoint code here
    else
    end
    table.remove( X, i )
  end

  return L
end 
```

我的多边形是使用这种结构的表： { { x = 1, y = 3 }, { x = 5, y = 6 }, ... }

如何确定“ **SL 中 segE 上方的线段；** ”和“ **SL 中 segE 下方的线段；** ”以及如果扫描线 ( **SL** ) 为空怎么办？此外，当将 I 插入 X 时，我是否应该用**endpoint = 'intersect'**标记它并将其附加到末尾，以便当循环到达这部分时进入主循环的“else”语句，或者我已经得到了整个算法错误的？

如果有人可以向我展示一个带有 Python、Ruby 等简单实现的链接，那将是完美的，因为我发现很难遵循伪代码并将其与 C++ 示例相匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T00:02:47.323

Your reference link fails from my location. I will reference [the Wikipedia article](http://en.wikipedia.org/wiki/Bentley%E2%80%93Ottmann_algorithm), which is reasonably good.

> How do I determine "the segment above segE in SL;" and "the segment below segE in SL;"

The algorithm requires a BST for current scan line intersections sorted on a key of y, i.e. in order vertically. So the segment above is the BST successor and the one below is the BST predecessor. Finding the predecessor and successor of a given node in a BST is standard stuff. The predecessor of key K is the rightmost node left of K. The successor is the leftmost node right of K. There are several ways of computing these. The simplest is to use parent pointers to walk back up and then down the tree from K. A stack-based iterator is another.

> what to do if the sweep line (SL) is empty?

Keep processing the event queue. An empty sweep line just means no segments are crossing at its current x location.

> Also when inserting I into X, should I mark it with endpoint = 'intersect' and append it to the end ...?

The event queue must remain sorted on the x-coordinate of points. When you insert an intersection it must be in x-coordinate order, too. It must be marked as an intersection because intersections are processed differently from endpoints. It will be processed in due course when it's the first remaining item in x order.

Note that Bentley Ottman - just as nearly all geometric algorithms - is notoriously subject to horrendous failures due to floating point inaccuracy. Also, the algorithm is normally given with a "general position" assumption, which lets out all the nasty cases of vertical edges, point-edge coincidence, edge-edge overlaps, etc. My strongest recommendation is to use rational arithmetic. Even then, getting a fully robust, correct implementation is a significant achievement. You can tell this by the very small number of free implementations!

# c# - 当调用不存在的方法时，C# Action/Delegate 使 wcf 通道出错

> ID：12643308
> 
> 赞同：1
> 
> 时间：2012-09-28T15:52:50.437
> 
> 标签：c#, wcf, exception, delegates, callback

我在 wcf 中有一个回调服务，如下所示：

```
[ServiceContract(CallbackContract = typeof(IMyCallbacks), Namespace = "MyNamespace")]
public interface IMyService
{
  [OperationContract]
  bool subscribe();

  [OperationContract]
  bool unsubscribe();
}

public interface IMyCallbacks
{
  [OperationContract(IsOneWay=true)]
  void onNewCallback(int iValue);
}

[ServiceBehavior(InstanceContextMode=InstanceContextMode.Single, ConcurrencyMode=ConcurrencyMode.Multiple)]
public class MyService : IMyService
{
    Action<int> DelegateOnNewCallback { get; set; }
    public bool subscribe()
    {
      try
      {
        var wClient = OperationContext.Current.GetCallbackChannel<IMyCallbacks>();
        DelegateOnNewCallback += wClient.onNewCallback;
      }  
      catch (Exception iEx)
      {
        Console.Writeline(iEx.Message);
        return false;
      }
      return true;
    }

    public bool unsubscribe()
    {
      try
      {
        var wClient = OperationContext.Current.GetCallbackChannel<IMyCallbacks>();
        DelegateOnNewCallback -= wClient.onNewCallback;
      }
      catch (Exception iEx)
      {
        Console.Writeline(iEx.Message);
        return false;
      }
      return true;
    }

    // This function is called really often
    public void CallingFunction(int iValue)
    {
       try
       {
         DelegateOnNewCallback(iValue);
       }
       catch (Exception ex)
       {
          Console.Writeline(ex.Message);
       }
    }
} 
```

在客户端，加载后，我订阅回调并打印我收到的值。当客户端关闭时，我调用 unsubscribe 方法。Service 独立于客户端，在此过程中永远不会被销毁。

当客户端进程被销毁并且未调用取消订阅方法时遇到了我的问题。每个后续客户端都不会收到回调，因为 Wcf 通道处于故障状态。每次调用 CallingFunction 时，我都会收到异常：

```
The communication object, System.ServiceModel.Channels.ServiceChannel, cannot be used for communication because it has been Aborted. 
```

我相信这是因为，由于未正确调用取消订阅，DelegateOnNewCallback 仍然尝试调用现在不存在的已破坏客户端的方法。在那种特殊情况下，我希望通过我的 Try/Catch 接收异常，但是，我不希望服务进入故障状态。

我想要的行为是，当调用 CallingFunction 时，它会尝试调用 DelegateOnNewCallback 包含的每个方法，如果某个方法不再存在，则默默地将其从列表中删除并继续调用后续方法。

我怎样才能做到这一点？

# javascript - Javascript在鼠标向下拖动时旋转

> ID：12643310
> 
> 赞同：1
> 
> 时间：2012-09-28T15:52:52.167
> 
> 标签：javascript, html, animation, rotation, drag

当我在它上面拖动鼠标时，我试图让一个旋转的轮子旋转。轮子由 3 个部分组成，因此我独立映射了每个图像，以便定位我想要旋转的轮子部分。现在它工作得很好。唯一的问题是我使用 event.clientX 作为旋转参数，有时它可能有点随机，有时轮子在开始时会移动到随机角度，但在大多数情况下它可以工作。我只想要一个公式来为我的脚本提供更好的旋转参数。这是我目前拥有的代码：

```
var isDragging      = false;

var innerWheelActive    = false;
var middleWheelActive   = false;
var outerWheelActive    = false;

$(document).ready(function() {

    /*------------------------------------------*/

    $("#mapping map #middleArea").mousedown(function() {
            isDragging  = true;
            middleWheelActive   = true;

            return false;
    });

    $("#mapping map #innerArea").mousedown(function() {
            isDragging  = true;
            innerWheelActive    = true;

            return false;
    });

    $("#mapping map #outerArea").mousedown(function() {
            isDragging  = true;
            outerWheelActive    = true;

            return false;
    });

    $(document).mousemove(function(event) {
        if (isDragging) {       

            var rotateCSS = 'rotate(' + event.clientX + 'deg)';
            if(innerWheelActive)
                $('#innerWheel img').css({ '-webkit-transform': rotateCSS });
            else if(middleWheelActive)
                $('#middleWheel img').css({ '-webkit-transform': rotateCSS });
            else if(outerWheelActive)
                $('#outerWheel img').css({ '-webkit-transform': rotateCSS });

            return false;
        }
    });

    $(document).mouseup(function() {
        if (isDragging){
            console.log('stopped');
            isDragging  = false;
            innerWheelActive    = false;
            middleWheelActive   = false;
            outerWheelActive    = false;
            return false;
        }
    });

}); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-28T18:35:05.927

您的逻辑有问题，它仅依赖于 x 坐标，当您旋转物体时，它并不总是增加。

试试这个。它计算我的鼠标从初始点移动的距离，因此同时考虑 x 和 y 坐标。它应该可以正常工作。

```
function getDistance(x1,y1,x2,y2){
    return Math.sqrt((x1-x2) * (x1-x2) + (y2-y1) * (y2-y1));
}
var div = $("#mydiv");
var rotation = 0; 
var isDragging = false;
div.mousedown(function(event) {
    isDragging = true;
    lastX = event.clientX;
    lastY = event.clientY;
}).mouseup(function(event) {
    isDragging = false;
}).mousemove(function(event) {
    if (isDragging) {
        var curX = event.clientX;
        var curY = event.clientY;   
        rotation += getDistance(curX,curY,lastX,lastY); 
        var rotateCSS = 'rotate(' + rotation + 'deg)';
        $(this).css({
            '-webkit-transform': rotateCSS
        });  
        lastX = curX;
        lastY = curY;
    }
}) 
```

​</p>

[演示](http://jsfiddle.net/jashwant/AM5tU/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-28T15:58:01.353

尝试在回调函数中添加 event.preventDefault 和 event.stopPorpagation ：

```
$('img').draggable({
    drag: function(event, ui){
        var rotateCSS = 'rotate(' + ui.position.left + 'deg)';
        $(this).css({ '-webkit-transform': rotateCSS });
        event.preventDefault();
        event.stopPropagation();
    }
}); 
```

# css - 将图像固定在右上角但设置最小页面宽度

> ID：12643312
> 
> 赞同：2
> 
> 时间：2012-09-28T15:52:53.353
> 
> 标签：css, layout

我正在尝试将标注图像附加到页面的右上角，但是一旦屏幕低于某个宽度，我不希望它移动，否则它将开始与其他页面元素重叠。有谁知道最好的方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:56:50.667

标准 CSS 实践告诉我们页面上的每个元素都应该封装为一个块：

```
<div style="float:left;">
    <div style="float:left;">
        <img src="picture.png" />
    </div>
</div> 
```

这种样式允许元素相互堆叠，防止重叠。

在您的情况下，听起来您有一个标题，并且您需要在右上角固定一张图片：

```
<div id="header" style="width:100%;float:left;">
    <div style="float:right;">
        <img src="picture.png" />
    </div>
</div>

<!-- continue stacking elements to build your page -->

<div id="content" style="width:100%;float:left;">
    Hey, this stuff works!
</div> 
```

但是你也提到你的页面应该有一个最小宽度，这样当用户试图缩小宽度时，元素不会水平重叠：

```
<body style="min-width:800px;">

    <div id="header" style="width:100%;float:left;">
        <div style="float:right;">
            <img src="picture.png" />
        </div>
    </div>

    <!-- continue stacking elements to build your page -->

    <div id="content" style="width:100%;float:left;">
        Hey, this stuff works!
    </div>

</body> 
```

# javascript - 方向更改后的javascript最大视口高度Android和iOS

> ID：12643314
> 
> 赞同：15
> 
> 时间：2012-09-28T15:52:57.420
> 
> 标签：javascript, android, html, ios, mobile

## 目标：

找到包括空间在内的设备的最大视口高度，`address bar`以便我们可以动态调整最小主体的大小并将我们的内容向上推送。

## 问题：

移动浏览器以不同的方式处理方向状态，并以不同的方式在方向变化时更新 DOM 属性。

[使用 JavaScript 在浏览器中检测 Android 手机的旋转](https://stackoverflow.com/questions/1649086/detect-rotation-of-android-phone-in-the-browser-with-javascript)

使用 Android 手机，`screen.width`或者`screen.height`随着设备的旋转而更新。

```
|==============================================================================|
|     Device     | Events Fired      | orientation | innerWidth | screen.width |
|==============================================================================|
| iPad 2         | resize            | 0           | 1024       | 768          |
| (to landscape) | orientationchange | 90          | 1024       | 768          |
|----------------+-------------------+-------------+------------+--------------|
| iPad 2         | resize            | 90          | 768        | 768          |
| (to portrait)  | orientationchange | 0           | 768        | 768          |
|----------------+-------------------+-------------+------------+--------------|
| iPhone 4       | resize            | 0           | 480        | 320          |
| (to landscape) | orientationchange | 90          | 480        | 320          |
|----------------+-------------------+-------------+------------+--------------|
| iPhone 4       | resize            | 90          | 320        | 320          |
| (to portrait)  | orientationchange | 0           | 320        | 320          |
|----------------+-------------------+-------------+------------+--------------|
| Droid phone    | orientationchange | 90          | 320        | 320          |
| (to landscape) | resize            | 90          | 569        | 569          |
|----------------+-------------------+-------------+------------+--------------|
| Droid phone    | orientationchange | 0           | 569        | 569          |
| (to portrait)  | resize            | 0           | 320        | 320          | 
```

正因为如此，很明显要找到最大视口高度，无论方向如何，使用单个函数返回设备的最大高度在一系列设备上永远不会保持不变。

**我发现的其他问题不能让这两个发挥得很好：**

*   `window.devicePixelRatio`除以 时，该属性可能会返回不一致的高度`window.outerHeight`。
*   `window.setTimeout(function() {}, time)`需要使用延迟来让 DOM 元素在方向更改后有机会更新。
*   `window.outerHeight`不会针对 iOS 设备的方向更改进行更新。用作`screen.availHeight`后备包括底部导航栏作为总高度。
*   使用`#header`, `#content`,`#footer`结构会强制您动态重新计算 以在 动态更新时向下`#content{min-height}`推。`#footer``body`

## 一个解法：

**首先让我们看一下DIV结构：**

```
<style>
#header,#content,#footer{width:100%;}
</style>

<body>
<div id="header"></div>
<div id="content"></div>
<div id="footer"></div>
</body> 
```

**我们希望防止设备自行扩展：**

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
```

**我们需要帮助才能返回最大视口高度并隐藏 iOS 的地址栏：**

```
<script src="iOS.js" type="text/javascript"></script> 
```

[http://iosjs.com/](http://iosjs.com/)

**然后检测设备是否支持方向更改并使用调整大小作为后备：**

```
var iOS = (navigator.userAgent.match(/(iPad|iPhone|iPod)/i) ? true : false);
var android = (navigator.userAgent.match(/Android/i) ? true : false);
var supportsOrientationChange = "onorientationchange" in window;
var orientationEvent = supportsOrientationChange ? "orientationchange" : "resize"; 
```

**野兽之腹：**

```
function updateOrientation()
{
    var orientation = (window.orientation);

    if(android)
    {
        window.setTimeout(function() {
            window.scrollTo(0,0);
            var size = window.outerHeight/window.devicePixelRatio;
            $('body').css('min-height', size + 'px');
            var headerHeight = $('#header').height();
            var footerHeight = $('#footer').height();
            var contentHeight = size - (headerHeight+footerHeight);
            $('#content').css('min-height', contentHeight + 'px');
            window.scrollTo(0,1);
        }, 200);
    }

    if(iOS)
    {
        window.setTimeout(function(){
            window.scrollTo(0,0);
            var size = iOS_getViewportSize();
            var headerHeight = $('#header').height();
            var footerHeight = $('#footer').height();
            var contentHeight = size.height - (headerHeight+footerHeight);
            $('#content').css('min-height', contentHeight + 'px');
            window.scrollTo(0,1);
        }, 0);
    }
} 
```

**为页面加载和方向事件添加事件侦听器：**

```
if(iOS)
{
    iOS_addEventListener(window, "load", iOS_handleWindowLoad);
    iOS_addEventListener(window, "orientationchange", iOS_handleOrientationChange);
    iOS_addEventListener(window, "resize", iOS_handleReize);
}
addEventListener("load", function() 
{
    updateOrientation();
}, false);
addEventListener(orientationEvent, function() {
    updateOrientation();
}, false); 
```

## 证据在布丁中：

**iPhone 4 & 4s 纵向和横向**

![iPhone 4 & 4s 肖像](../Images/30851ab1f483aa02f1abe8a0c1d7de7f.png) ![iPhone 4 & 4s 横向](../Images/d001d752e4864152ebf65dd29790c5e3.png)

* * *

**Android 纵向和横向**

![安卓肖像](../Images/d18daf7d11ee9f1190767f91bad78cd4.png) ![安卓风景](../Images/87a987f7b5a445142acccb3523605acb.png)

* * *

## 这里的目标是缩小这个解决方案或使其更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-04T08:51:57.177

这是一个简单的解决方案，它将在加载和调整窗口大小时将浏览器的宽度和高度附加到文档正文。

```
jQuery.event.add(window, "load", resize);
jQuery.event.add(window, "resize", resize);

  function resize() 
    {
      var h = jQuery(window).height();
      var w = jQuery(window).width();
      jQuery("body").css({"width": w, "height": h});
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T14:11:59.337

iOS 模拟器中返回的预期值。我目前无法测试 Android。

```
var supportsOrientationChange = "onorientationchange" in window;
var orientationEvent = supportsOrientationChange ? "orientationchange" : "resize";

window.onload = updateOrientation();

window.addEventListener(orientationEvent, function() {
    updateOrientation();
}, false);

function updateOrientation(){
    switch(window.orientation){
    case 0:
    alert(window.outerHeight); // Returns '356' with browser chrome
    break;

    case -90:
    alert('Landscape right');
    break;

    case 90:
    alert(window.outerHeight); // Returns '208' w browser chrome
    break;

    case 180:
    //alert('Portrait view - upside down');
    break;
    }
    var orientation = (window.orientation);
} 
```

（注意：此代码不会在浏览器中测试。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T01:46:09.357

你可以尝试一个自调用闭包，它自己监控方向的变化。像这样的东西：

```
(function () {

    var CurrentHeight;

    (function CheckForOrientationChange() {

        //var NewHeight = window.screen.availHeight / window.devicePixelRatio;
        //var NewHeight = $(window).height();    

        var NewHeight = $('#WidthCheck').width();

        if (CurrentHeight && CurrentHeight!== NewHeight ) {

            alert(NewHeight); // change here
        }

        CurrentHeight = NewHeight;

        setTimeout(CheckForOrientationChange, 1000);

    })();

})(); 
```

只需将其放入文档就绪功能中即可。现在它每秒检查一次，但您可以缩短该间隔。jsfiddle**在[这里](http://jsfiddle.net/VVVgz/4/)**，您可以通过更改浏览器的大小来模拟移动浏览器的更改来测试它，然后您可以调整代码来处理您的操作。

# windows-8 - 多个 WinRT CaptureElements

> ID：12643316
> 
> 赞同：3
> 
> 时间：2012-09-28T15:53:10.973
> 
> 标签：windows-8, winrt-xaml

CaptureElement XAML 控件是一种很酷且简单的技术，可以在应用程序的画布中预览设备上的相机，而无需调用 CameraCaptureUI 对话框。

![在此处输入图像描述](../Images/45249d7fa4690c123b006c53c4622c52.png)

但是......添加多个似乎不起作用。

试试这个：

```
var _MediaCapture = new MediaCapture();
await _MediaCapture.InitializeAsync();
Cap1.Source = _MediaCapture;
Cap2.Source = _MediaCapture;
await _MediaCapture.StartPreviewAsync(); 
```

结果在第二个“源”行：

> {“在意外的时间调用了一个方法。（来自 HRESULT 的异常：0x8000000E）”}

是否有一种技术允许在单个 XAML 画布上使用多个 CaptureElement？

# perl - Perl bidirectional pipe IPC, how to avoid output buffering

> ID：12643325
> 
> 赞同：3
> 
> 时间：2012-09-28T15:53:36.983
> 
> 标签：perl, ipc, pipe, output-buffering, tty

I am trying to communicate with an interactive process. I want my perl script to be a "moddle man" between the user and the process. The process puts text to stdout, prompts the user for a command, puts more text to stdout, prompts the user for a command, ....... A primitive graphic is provided:

```
 User <----STDOUT---- interface.pl <-----STDOUT--- Process
 User -----STDIN----> interface.pl ------STDIN---> Process
 User <----STDOUT---- interface.pl <-----STDOUT--- Process
 User -----STDIN----> interface.pl ------STDIN---> Process
 User <----STDOUT---- interface.pl <-----STDOUT--- Process
 User -----STDIN----> interface.pl ------STDIN---> Process 
```

The following simulates what I'm trying to do:

```
 #!/usr/bin/perl

    use strict;
    use warnings;

    use FileHandle;
    use IPC::Open2;
    my  $pid = open2( \*READER, \*WRITER, "cat -n" );
    WRITER->autoflush(); # default here, actually
    my $got = "";
    my $input = " ";

    while ($input ne "") {
            chomp($input = <STDIN>);
            print WRITER "$input \n";
            $got = <READER>;
            print $got;
    } 
```

DUe to output buffering the above example does not work. No matter what text is typed in, or how many enters are pressed the program just sits there. The way to fix it is to issue:

```
 my  $pid = open2( \*READER, \*WRITER, "cat -un" ); 
```

Notice "cat -un" as opposed to just "cat -n". -u turns off output buffering on cat. When output buffering is turned off this works. The process I am trying to interact with most likely buffers output as I am facing the same issues with "cat -n". Unfortunately I can not turn off output buffering on the process I am communicating with, so how do I handle this issue?

UPDATE1 (using ptty):

```
 #!/usr/bin/perl

    use strict;
    use warnings;

    use IO::Pty;
    use IPC::Open2;

    my $reader = new IO::Pty;
    my $writer = new IO::Pty;

    my  $pid = open2( $reader, $writer, "cat -n" );
    my $got = "";
    my $input = " ";

    $writer->autoflush(1);

    while ($input ne "") {
            chomp($input = <STDIN>);
            $writer->print("$input \n");
            $got = $reader->getline;
            print $got;
    } 
```

~

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T16:43:56.770

There are three kinds of buffering:

1.  Block buffering: Output is placed into a fixed-sized buffer. The buffer is flushed when it becomes full. You'll see the output come out in chunks.
2.  Line buffering: Output is placed into a fixed-sized buffer. The buffer is flushed when a newline is added to the buffer and when it becomes full.
3.  No buffering: Output is passed directly to the OS.

In Perl, buffering works as follows:

*   File handles are buffered by default. One exception: STDERR is not buffered by default.
*   Block buffering is used. One exception: STDOUT is line buffered if and only if it's connected to a terminal.
*   Reading from STDIN flushes the buffer for STDOUT.
*   Until recently, Perl used 4KB buffers. Now, the default is 8KB, but that can be changed when Perl is built.

This first two are surprisingly standard across all applications. That means:

*   `User -------> interface.pl`

    User is a person. He doesn't buffer per say, though it's a very slow source of data. **OK**

*   `interface.pl ----> Process`

    `interface.pl`'s output is block buffered. **BAD**

    Fixed by adding the following to `interface.pl`:

    ```
    use IO::Handle qw( );
    WRITER->autoflush(1); 
    ```

*   `Process ----> interface.pl`

    Process's output is block buffered. **BAD**

    Fixed by adding the following to `Process`:

    ```
    use IO::Handle qw( );
    STDOUT->autoflush(1); 
    ```

    Now, you're probably going to tell me you can't change Process. If so, that leaves you three options:

    *   Use a command line or configuration option provided by tool to change its buffering behaviour. I don't know of any tools that provide such an option.
    *   Fool the child to use line buffering instead of block buffering by using a [pseudo tty](http://search.cpan.org/perldoc?IO::Pty) instead of a pipe.
    *   Quitting.
*   `interface.pl -------> User`

    `interface.pl`'s output is line buffered. **OK** (right?)

# ios - 与iOS开发相比，Web开发中的模型（MVC）有什么区别

> ID：12643326
> 
> 赞同：0
> 
> 时间：2012-09-28T15:53:40.557
> 
> 标签：ios, model-view-controller, design-patterns, model

我来自 Web 开发背景。我无法理解如何在 iOS 开发中使用模型。

Web 开发中的模型是一个单独的文件，控制器文件可以通过以下功能访问它`getMysqlQueryOf(stuff);`

iOS开发是否使用相同的东西？我应该创建一个 MyModel.h 和 MyModel.m 文件并在我的所有视图控制器中包含/导入它并像这样访问模型类中的方法吗？

您能否展示一个模型类的简单示例以及如何从视图控制器访问它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:05:41.023

在我的 iOS 体验中，UIViewController 倾向于充当自己的孤岛。错误的方法是将您要放入模型的所有内容都放入委托类中。我认为您对“模型”的想法是正确的。我将创建一个 someModel.m 和一个头文件，并为每个需要模型的类提供一个指向它的指针，并在委托中初始化核心模型。

IMO，iOS 数据流还有一些不足之处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T17:20:44.403

如果我有一个想要在各种对象之间共享的数据模型，我会创建它以便我可以静态访问它。

例如，下面的代码创建了一个对象 dataHandle，通过包含头文件并调用 [MyData getMyData]，项目中的任何其他对象都可以轻松访问该对象。

我的数据.h

```
@interface MyData : NSObject {
    NSString *dataName; // example data in my object
}
@property (nonatomic, retain) NSString *dataName;
+ (MyData *)getMyData; 
```

我的数据

```
@implementation MyData
@synthesize dataName;

static MyData *dataHandle;
+ (void)initData
{
    dataHandle = [MyData new];
    [dataHandle setDataName:@"DefaultName"];

}

+ (MyData *)getMyData
{
     if (!dataHandle){
         [MyData initData];
     }
     return dataHandle;
} 
```

# objective-c - 如何将此 JSON 响应解析为键值对数组

> ID：12643334
> 
> 赞同：1
> 
> 时间：2012-09-28T15:54:28.420
> 
> 标签：objective-c, json, parsing, nsmutablearray, nsdictionary

有很多这样的问题，我也对 json 格式有经验，但我无法解析下面的响应（在底部）：

我正在使用 NSJSONSerialization 将响应解析为 NSDictionary 但它给出了如下错误：

**我的代码：**

```
 NSString *subURL= sharedDa.ip;
        NSData *data=[NSData dataWithContentsOfURL:[NSURL URLWithString:[NSString stringWithFormat:@"http://192.168.69.230/tsadmin.php?tssearch=%@", subURL]]];

        NSError *error=nil;
        NSDictionary* portsResult=[NSJSONSerialization JSONObjectWithData:data options:
                              NSJSONReadingMutableContainers error:&error];
  NSDictionary * tempPorts;
    NSString *k;

        for(k in [portsResult allKeys]){
            tempPorts = [portsResult objectForKey:k];
            NSLog(@"Temporary ports: %@", tempPorts);
        } 
```

**错误代码如下：**

```
2012-09-28 18:47:37.508 BNTPRO ST Manager[2609:fb03] -[__NSArrayM allKeys]: unrecognized selector sent to instance 0x6b83ed0
2012-09-28 18:47:37.511 BNTPRO ST Manager[2609:fb03] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSArrayM allKeys]: unrecognized selector sent to instance 0x6b83ed0'
*** First throw call stack:
(0x1568022 0x1b20cd6 0x1569cbd 0x14ceed0 0x14cecb2 0x57cd 0x28fa1e 0x28fd11 0x2a18fd 0x2a1aef 0x2a1dbb 0x2a285f 0x2a2e06 0x2a2a24 0x3e59 0x2595c5 0x2597fa 0xaee85d 0x153c936 0x153c3d7 0x149f790 0x149ed84 0x149ec9b 0x245a7d8 0x245a88a 0x1c8626 0x26d2 0x2645 0x1)
terminate called throwing an exception(lldb) 
```

现在我的数据片段是：`[{"k1":{"v":"0"}},{"k2":{"v":"0"}},{"k3":{"v":"0"}},{"k4":{"v":"0"}},{"k5":{"v":"0"}},{"k6":{"v":"0"}},{"k7":{"v":"1"}},{"k8":{"v":"0"}},{"k9":{"v":"1"}},{"k10":{"v":"0"}},{"k11":{"v":"1"}},{"k12":{"v":"0"}},{"k13":{"v":"1"}},{"k14":{"v":"0"}},{"k15":{"v":"0"}},{"k16":{"v":"0"}}]` 但它仍然给出相同的错误..即使我将 iVar 描述为 NSDictionary 为什么它抱怨 nsmutable 数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T17:38:30.697

您正在解析的 JSON 是一个*数组*，而不是一个*对象*。所以结果`[NSJSONSerialization JSONObjectWithData...]`不是一个`NSDictionary *`，而是一个`NSArray *`。

例如，对于 JSON 数据

```
[{"k1":{"v":"0"}}, {"k2":{"v":"0"}}] 
```

您可以使用类似于此代码的内容（现在没有 xcode 来尝试运行它）：

```
NSArray * arr = [NSJSONSerialization JSONObjectWithData:data options:...];
int i;
for (i = 0; i < [arr count]; i++) {
    NSDictionary * dic = [arr objectAtIndex:i];
    NSString * k;
    for (k in [dic allKeys]) {
        NSLog(@"Temporary ports: %@", [dic objectForKey:k]);
    }
} 
```

# ruby-on-rails - Rails 3 个或更多模型关联混淆

> ID：12643340
> 
> 赞同：0
> 
> 时间：2012-09-28T15:54:50.897
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

自从我试图找到解决我的困惑的方法以来已经快一个星期了......这里是：

我有一个`Program`模型。我有一个`ProgramCategory`模型。我有一个`ProgramSubcategory`模型。

让我们更清楚一点：

```
ProgramCategory ======> Shows, Movies, 
ProgramSubcategory ===> Featured Shows, Action Movies
Program ==============> Lost, Dexter, Game of Thrones etc... 
```

我希望能够将这些模型中的每一个相互关联。我有我想做的事情，特别是多对多关联。我有一个`categories_navigation`JOIN 模型/表，我所有的其他表都连接到它。通过这种方式，我可以访问所有这些模型的所有字段。

但...

如你所知，`has_many :through`风格联想总是复数的。没有诸如 has_one :through 或 belongs_to through 之类的东西。但我想玩 SINGULAR 对象，而不是数组。A`Program`只有一个`Subcategory`，只有一个`Category`。我只是使用连接表来仅在这三个之间建立连接。例如，目前我可以访问`program.program_categories[0].title`但我想访问它`program.program_category`，例如。

我怎样才能同时拥有 'has_many :through 的能力但 has_one 的单一用法约定？:|

PS：我之前的问题也是关于这种情况的，但我决定从头开始学习联想哲学。如果你愿意，可以在这里查看我之前的帖子：[如何通过 Rails 中的另一个模型访问关联模型？](https://stackoverflow.com/questions/12608683/how-to-access-associated-model-through-another-model-in-rails/12609575)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:08:09.983

为什么要使用与您有直接关系的连接表？最后，一个程序属于一个子类别，而子类别又属于一个类别。所以不需要连接表。

```
class Program < ActiveRecord::Base
  belongs_to :subcategory   # references the "subcategory_id" in the table
  # belongs_to :category, :through => :subcategory
  delegate :category, :to => :subcategory
end

class Subcategory < ActiveRecord::Base
  has_many :programs
  belongs_to :category    # references the "category_id" in the table
end

class Category < ActiveRecord::Base
  has_many :subcategories
  has_many :programs, :through => :subcategories
end 
```

另一种观点是将类别制作成树，因此您不需要为“2级”类别添加额外的模型，您可以添加任意数量的级别。如果您使用“closure_tree”之类的树实现，您还可以获得所有子类别（在任何级别）、所有超类别等

在这种情况下，您可以跳过 Subcategory 模型，因为它只是一个 depth=2 的类别

```
class Program < ActiveRecord::Base
  belongs_to :category   # references the "category_id" in the table

  scope :in_categories, lambda do |cats|
    where(:category_id => cats)  # accepts one or an array of either integers or Categories
  end
end

class Category < ActiveRecord::Base
  acts_as_tree
  has_many :programs
end 
```

只是一个关于如何使用树按类别过滤的示例。假设您有一个选择框，并从中选择一个类别。您想要检索与其任何子类别相对应的所有对象，而不仅仅是类别。

```
class ProgramsController < ApplicationController

  def index

    @programs = Program.scoped
    if params[:category].present?
      category = Category.find(params[:category])
      @programs = @programs.in_categories(category.descendant_ids + [category.id])
    end

  end

end 
```

树赢！

# asp.net - 多部分标识符“arafa.almahmud08@gmail.com”无法绑定

> ID：12643345
> 
> 赞同：0
> 
> 时间：2012-09-28T15:55:17.617
> 
> 标签：asp.net, sql-server-2008

我已经建立了一个自定义验证器，

我有一个这样的sql查询：

```
protected void custom_serverValidate(object sender, ServerValidateEventArgs e)
    {
        connect();
        string strSQL = "select EmailAddress from Accounts_Users where EmailAddress=" + REmailTextBox.Text;
        SqlCommand cmd = new SqlCommand(strSQL, objConnection);
        if (e.Value.ToString() == cmd.ExecuteScalar().ToString())
        {
            e.IsValid = false;
        }
        else
            e.IsValid = true;
        disConnect();
    } 
```

当我在浏览器和电子邮件地址中执行我的代码并提交它时，我收到标题中提到的错误。如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:59:47.017

您的电子邮件地址周围缺少引号。然而——这是一个等待发生的 SQL 注入攻击。请切换到使用参数。

```
string strSQL = "select EmailAddress from Accounts_Users where EmailAddress = @EmailAddress"

...

cmd.Parameters.AddWithValue("@EmailAddress", REmailTextBox.Text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:56:52.007

你忘了使用单引号。利用：

```
string commandText = "select EmailAddress from Accounts_Users where EmailAddress=@EmailAttress";
SqlCommand cmd = new SqlCommand(commandText, conn);
cmd.Parameters.Add("@EmailAddress", REmailTextBox.Text); 
```

# iphone - 多个图像存储和处理表视图

> ID：12643346
> 
> 赞同：0
> 
> 时间：2012-09-28T15:55:18.193
> 
> 标签：iphone, xcode, image, uitableview

尽管围绕这个主题有很多主题，但在以下情况下我似乎非常沮丧:(

该应用程序下载并解析包含大约 1000 个对象的 JSON，这些对象的属性链接中包含一个小图像。我需要下载（一次）这些图像，将它们存储并在我的 TableView 中用作图标。

存储这么多文件并在显示 TableView 时有效地使用它们的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:48:26.290

我会告诉你我将如何做，但在我想**警告**你从 Internet 下载文件并将它们存储在你的应用程序中之前。

最近我的一个应用程序被 Apple 拒绝了，因为我违反了[App Store 审查指南](https://developer.apple.com/appstore/resources/approval/guidelines.html)中的 2.23 条规则：

> 2.23 应用程序必须遵循[iOS 数据存储指南](https://developer.apple.com/icloud/documentation/data-storage/) ，否则将被拒绝

由于 Apple 最近在使用 iCloud，因此您应该尽量减少每个应用程序上传的流量，因此您的应用程序的 Documents 文件夹中存储的空间不应超过 40MB。他们还说（如果您阅读我提供的链接）：

> 可以再次下载或重新生成的数据应存储在 /Library/Caches 目录中。

并且由于缓存文件夹可以在需要时被 iOS 删除，因此您应该将您的应用程序设计为准备再次下载图像以防它们消失，因此请记住这一点。

现在对于我的解决方案，我认为下载 1000 个文件太多（即使它们是小文件）。我建议您将文件保存在服务器上的 ZIP 文件中，您愿意从该服务器上下载并在下载后将它们解压缩到您的光盘上。这将更容易和更实用。您可以[在这里](https://stackoverflow.com/questions/5029917/zip-and-unzip-a-file-programmatically-in-iphone)查看如何在您的应用程序中压缩和解压缩。

解压缩文件后，我建议有一个小型数据库（SQLite），您可以从中加载文件名，将这些名称存储在一个数组中，然后使用该数组在函数表中填充图像`cellForRowAtIndexPath`。

我希望这可以帮助你。顺便说一句，这是我的做法，但我并不是说这是你问的“最好的方法”:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T17:51:10.483

鉴于您希望保持这些图像/数据的持久性，您现在有两个选择：您可以自己管理它们，或者您可以利用 Core Data 来帮助您做到这一点。我推荐核心数据。

如果你不熟悉 Core Data，你可以从[这里](http://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/iPhoneCoreData01/Introduction/Introduction.html)开始阅读。开始有点令人生畏，但是一旦你完成了一个[教程](http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started)，它就非常简单，会让你的生活更轻松。

如果您想自己存储图像，或者想要更高效的 Core Data 结构，我建议您将所有图像写入您的 Documents 目录，[如下](https://stackoverflow.com/questions/1150911/save-image-to-sandbox-from-uiimage-in-iphone)所示。然后您可以将文件路径字符串存储在您的 CD 结构中或手动存储在您的 plist 中，例如[This](https://stackoverflow.com/questions/6070568/ios-store-two-nsmutablearray-in-a-plist-file)。

最后，为了将它们加载到您的 TableView 中，您可以使用这些存储的图像路径来加载 UIImages：

`[[UIImage alloc] initWithContentsOfFile:filePath];`

这将放置在您的：

`- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`

功能，以便您可以将图像设置在您想要的位置。

# objective-c - 如何在 NSMutableData 中设置一个字节

> ID：12643349
> 
> 赞同：1
> 
> 时间：2012-09-28T15:55:34.520
> 
> 标签：objective-c, arrays, byte, nsmutabledata

如何在 NSMutableData 对象中设置一个字节？我尝试了以下方法：

```
-(void)setFirstValue:(Byte)v{
    [mValues mutableBytes][0] = v;
} 
```

但这会让编译器大声喊叫......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:58:45.227

> 但这会让编译器大声喊叫......

那是因为`mutableBytes*`返回`void*`. 将其转换`char*`为解决问题：

```
((char*)[mValues mutableBytes])[0] = v; 
```

你也可以使用`replaceBytesInRange:withBytes:`

```
char buf[1];
buf[0] = v;
[mValues replaceBytesInRange:NSMakeRange(0, 1) withBytes:buf]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:58:19.140

我把它转换成一个数组

```
 NSMutableData * rawData = [[NSMutableData alloc] initWithData:data];
    NSMutableArray * networkBuffer = [[NSMutableArray alloc]init];

    const uint8_t *bytes = [self.rawData bytes];

    //cycle through data and place it in the network buffer
    for (int i =0; i < [data length]; i++) 
    {
        [networkBuffer addObject:[NSString stringWithFormat:@"%02X", bytes[i]]];
    } 
```

那么当然你可以调整你的networkBuffer中的对象（这是一个nsmutablearray）

# touch - 动态轮播内容不显示

> ID：12643352
> 
> 赞同：0
> 
> 时间：2012-09-28T15:55:49.357
> 
> 标签：touch, extjs, sencha-touch-2, carousel

我已经为此工作了好几天，但我有限的 JS 知识似乎伤害了我。

我正在我的 ST2 应用程序中创建一个动态 Ext.Carousel 组件，该组件基于 Store 文件的内容。

这一切都很好，但无论如何我都会展示代码，这样就没有什么可以想象的了：

```
 Ext.getStore('DeviceStore').load(
            function(i) {

                  Ext.each(i, function(i) {
                        if (i._data.name == 'Audio Ring') {

                            var carousel = Ext.ComponentManager.get('speakerCarousel');

                            var items = [];
                            Ext.each(i.raw.speakers, function(speaker) {

                                items.push({
                                    sci: Ext.create('SmartCore.view.SpeakerCarouselItem', {
                                        speakerId: speaker.speakerid,
                                        speakerName: speaker.speakername,
                                        speakerEnabled: speaker.speakerenabled
                                    })
                                });

                            });
                            carousel.setItems(items);

                        }
                  });
            }) 
```

现在，这会将适当数量的项目添加到轮播中。它们显示，但没有我指定的内容：

这是旋转木马本身：

```
Ext.define('SmartCore.view.SpeakerCarousel', {
    extend: 'Ext.Carousel',
    xtype: 'speakerCarousel',
    config: {
        id: 'speakerCarousel',
        layout: 'fit',
        listeners: {
            activeitemchange: function(carousel, item) {
                console.log(item);

            }
        }

    }
}); 
```

这是项目类，我想将商店中的数据填充到：

```
Ext.define("SmartCore.view.SpeakerCarouselItem", {
    extend: Ext.Panel,

    xtype: 'speakerCarouselItem',

    config: {

        title:'SpeakerCarouselItem',
        styleHtmlContent: true,
        layout: 'fit'

    },

    constructor : function(param) {

        this.callParent(param);
        this.add(
            {
            layout: 'panel',
            style: 'background-color: #759E60;',

            html: 'hello'

            }
        )

    }
}); 
```

同样，正确数量的项目显示在轮播 (11) 中，但内容不可见，背景颜色也未更改。当我在浏览器中检查 console.log(item) 时，项目在轮播对象内显示为 innerItems。

任何帮助是极大的赞赏！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:45:34.547

好吧，我自己修复了它，或者更好的是，我找到了一个似乎是我想要的解决方法。

我最终放弃了构造函数。

相反，我覆盖了“speakerName”键值对的应用方法。

从那里，我可以使用：

`this._items.items[0]._items.items[i].setWhatever(...)`

设置项目内的内容。

如果有人知道这样做的“真实”方法，我仍然非常感谢您的输入！

# ruby-on-rails - Ruby on Rails 3：如何将参数传递给表单中的选择框？

> ID：12643354
> 
> 赞同：0
> 
> 时间：2012-09-28T15:55:52.153
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, forms

我有一个可以有很多**Projects的****Client**模型。

 **这些是我的视图文件：

**编辑.html.erb**

```
<%= form_for(@project) do |f| %>
  <%= render 'fields', :f => f %>
  <%= f.submit Create %>
<% end %> 
```

**_fields.html.erb**

```
<div>
    <%= f.label :name %><br/>
    <%= f.text_field :name %>
</div>
<div>
    <%= f.label :client_id %><br/>
    <%= f.select(:client_id, current_user.client_names) %>
</div> 
```

这很容易而且效果很好。

但是有没有办法从**客户端**视图中创建一个项目呢？

例如，在客户端编辑页面上，最好有一个链接*New Project for this Client*，该链接指向上面的*New Project*表单，但在选择框中预先选择了相应的客户端。

这可以以某种方式完成吗？

我似乎找不到将客户 ID 传递给*新项目*表单的方法。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:20:51.343

这当然是可能的，但需要将客户端 ID 传递给 new_projects_path。这可以通过将路由嵌套在客户端内部的项目中来完成，或者只是附加客户端 ID。不同之处在于 URL 如下所示：

```
/clients/1/projects/new
- or -
/projects/new?client_id=1 
```

在您的项目控制器中，您应该能够使用预选的客户端实例化 @project 变量：

```
@project = Project.new :client_id => params[:client_id] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:13:11.890

是的，你可以这样做。您将在 Client 模型中使用 Accepts_nested_attributes_for :project 。嵌套这将允许您执行类似的操作

```
<%= f.fields_for :project do |p| %>
<fieldset>
<%= p.text_area :content %>
</fieldset>
<% end %> 
```

查看关于嵌套模型表单的 railscasts 第 196 集。**

# html - 调整为移动设备大小时，引导页脚左右间隙

> ID：12643356
> 
> 赞同：0
> 
> 时间：2012-09-28T15:56:04.320
> 
> 标签：html, css, twitter-bootstrap

我在我的 twitter boostrap 网站上添加了一个新的页脚，但是当我调整窗口大小时，窗口的间隙出现在左侧和右侧。

我知道这与这个css代码有关......

```
@media (max-width: 767px) {
 body {
padding-left: 20px;
padding-right: 20px; 
```

}

如果我将填充更改为 0px，则页脚间隙会消失，但整个页面会丢失一个边距。

我已经尝试过了，但是没有用。

```
@media (max-width: 767px) {
 footer {
padding-left: 0px;
padding-right: 0px; 
```

}

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T19:14:48.920

尝试使用负边距，与导航使用的方法相同。我没有尝试过，但是这样的东西应该可以工作：

```
@media (max-width: 767px) {
    footer {
        padding-left: -20px;
        padding-right: -20px;
    }
} 
```

# dos - DOS 如果找到 FINSTR 将变量设置到该行，然后回显变量？

> ID：12643360
> 
> 赞同：0
> 
> 时间：2012-09-28T15:56:20.423
> 
> 标签：dos, batch-file

```
for /f "tokens=3" %%f in ('find /c /i "apples" "test.txt"') do set varMWG=%%f
REM echo %varMWG%

if %varMWG% EQU 1 (
    @echo TRUE
) else (
    @echo FALSE
) 
```

如果找到字符串，我想回显变量行，而不是回显 TRUE 或 FALSE，如果找不到，我仍然回显 FALSE。

test.txt 包含

```
fdgsdf
hgsfrtgyr
apples
fdsgfghs
erwyuweu 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T18:07:13.970

如果您只需要回显匹配的行，或者如果没有行匹配则回显 FALSE（换句话说，您不需要该变量），那么

```
findstr /ilc:"apples" "test.txt" || echo FALSE 
```

请记住，可能有多行与您的搜索匹配。

如果您需要一个包含最后找到的行的变量，则：

```
set "varMWG="
for /f "delims=" %%S in ('findstr /ilc:"apples" "test.txt"') do set "varMWG=%%S"
if defined varMWG (echo %varMWG%) else echo FALSE 
```

注意 - 延迟扩展会更安全。根据 varMWG 的内容，使用常规扩展的 ECHO 可能会失败。

如果您需要包含第一个找到的行的变量，则：

```
set "varMWG="
for /f "delims=" %%S in ('findstr /ilc:"apples" "test.txt"') do (
  set "varMWG=%%S"
  echo %%S
  goto :break
)
:break
if not defined varMWG echo FALSE 
```

最后一个选项永远不需要延迟扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T17:52:41.637

如果“回显变量行”是指回显搜索字符串“apples”，则以下代码就足够了：

```
@echo off
for /f "tokens=* delims= " %%f in (test.txt) do (
if %%f EQU apples (echo %%f
) else echo false
) 
```

* * *

输出：

```
false
false
apples
false
false 
```

# php - 将自定义浮动添加到现有的 wordpress 模板而不会损坏

> ID：12643362
> 
> 赞同：0
> 
> 时间：2012-09-28T15:56:28.327
> 
> 标签：php, html, css, wordpress, wordpress-theming

长话短说。我创建了这个[http://jsfiddle.net/paDmg/368/](http://jsfiddle.net/paDmg/368/)，我想将它添加到最新作品旁边横幅下方右侧的 www.avueduesgins.com/new。

我不使用小部件的原因是因为我没有透明背景。我想如果我能以 3x3 的方式复制样式 div，但它们需要翻转......

我们的 php 人出城 2 周，我想完成这个项目。我在 php 方面的技能非常有限，但是如果方向正确，我确信我可以实现我的目标，我只需要帮助找到前进的方向。

如果有另一种方法可以实现我想要做的事情，我想接受任何建议。谢谢，希望有人可以帮助一个人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T16:26:21.397

为什么不将其添加为小部件，然后使用 CSS 去除背景？如果这是阻止您使用小部件的唯一原因，那么 CSS 比更改侧边栏模板更容易。

#yourwidgetsid {背景：无}

# ruby-on-rails-3 - Ruby On Rails 方法说明

> ID：12643373
> 
> 赞同：0
> 
> 时间：2012-09-28T15:57:08.250
> 
> 标签：ruby-on-rails-3

我得到了这个 ruby​​ 代码来进行概述。我对 ruby​​ on rails 还是很陌生。我来自java背景。

在 User.rb 中：

```
 def last_name=name
    require 'debugger'; debugger
    self[:last_name] = name
  end 
```

并告诉我这是一个setter方法。他们告诉我，这会以这一行的“形式”执行：

```
<%= f.label :last_name%>
<%= f.text_field :last_name %> 
```

行。有人可以澄清这种荒谬的语法如何有效吗？

1) “用户”类的实例永远不会被初始化。该方法甚至是如何调用的？

2) 变量“name”从何而来？它的价值是什么？（变量名在其他地方没有被调用）这个语法代表什么？“def last_name=name” ?? 将尚未初始化的变量传递给方法？它是另一种语法的捷径，只是为了节省再输入 2 个符号？

3）如何以形式调用此方法？我没有看到“User.last_name("David") 或类似的东西。

有人可以澄清一下这些代码吗？并且请不要发布指向教程或其他任何内容的链接。只需澄清这段代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:07:15.220

您描述的代码：

```
<%= f.label :last_name%>
<%= f.text_field :last_name %> 
```

..由默认的 rails 模板引擎使用。这是查看代码。

**1) 提交表单时，可能会初始化并填充用户实例。**

表单动作对应于适当的控制器动作，它可能接受`:last_name`作为参数。当您提交表单时，控制器操作可能会实例化 User 实例。但是，如果没有更多代码，我不能 100% 确定您的应用程序就是这种情况。

**2）变量`name`来自`last_name`方法接受的参数。**

也许，为了帮助您理解该方法，让我们重写它：

```
def last_name= (name)
  require 'debugger'; debugger
  self[:last_name] = name
end 
```

要么 要么`last_name=('John Doe')`将`last_name = 'John Doe'`执行此方法。

**3）我认为我之前的描述应该可以帮助您理解这一点。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:04:06.023

1.  MVC。在操作 new 中，创建了一个新的 User 实例并将其分配给 @user，这将用于表单。

2.  名称来自方法声明`def last_name=name`

3.  表单助手在为该变量分配值并使用 setter 执行此操作时执行 last_name=name。当您编辑对象时，它将使用 getter 在文本字段中显示其值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:07:39.710

您可以使用以下语法更好地理解第 2 点：

```
def last_name=( name )
end 
```

`=`是函数名称的一部分。

C等价物是

```
void last_name_equals( char *name ) {} 
```

剩下的就是 Rails 教程的工作了。

# tfs - 如何请求工作项所有者向工作项添加更多详细信息并保留历史记录？

> ID：12643374
> 
> 赞同：2
> 
> 时间：2012-09-28T15:57:10.753
> 
> 标签：tfs

在 TFS 中，如何向工作项的所有者请求更多信息并使我的请求出现在工作项历史记录中？

例如，用户提交了一个错误，然后我想使用 TFS 请求更多信息，我希望我的请求包含在错误中或附加到错误中。然后希望用户以我可以看到进度的方式更新错误。

同样，有没有办法通知用户我已更新错误（无需明确向他们发送手动电子邮件）？

所以我希望这超出了每日站立会议和更自动化的流程的范围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:04:31.913

您可以添加一个新的状态或原因，使用一个工作流自动将工作项分配回创建者，并在分配给 [我] 的更改时发送电子邮件警报。但是，我通常只是手动将其分配给某人并在历史记录中询问更多详细信息。

# objective-c - QLPreviewController 在 iOS 6 中不起作用

> ID：12643375
> 
> 赞同：11
> 
> 时间：2012-09-28T15:57:14.700
> 
> 标签：objective-c, ios6, qlpreviewcontroller

在 iOS 6 中，QLPreviewController 不再从 URL 加载 PDF。它在 iOS 5 中运行良好。我已经实现了 QLPreviewControllerDataSource 方法，如此[处](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Reference/QLPreviewControllerDataSource_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40009665)所述。

```
#pragma mark - QLPreviewControllerDataSource
- (NSInteger)numberOfPreviewItemsInPreviewController:(QLPreviewController *)controller {
    return 1;
}

- (id <QLPreviewItem>) previewController: (QLPreviewController *) controller previewItemAtIndex: (NSInteger) index;
{
    NSURL *fileURL = [NSURL URLWithString:@"http://www.bliley.net/XTAL/PDF_Instructions/Test_File.pdf"];
    return fileURL;
} 
```

这在 iOS 5 中完美运行，但在 iOS 6 中控制台输出：

```
Couldn't issue file extension for path: /XTAL/PDF_Instructions/Test_File.pdf 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T15:11:47.310

您是否尝试过使用 fileURLWithPath 而不是 URLWithString？我有其他问题通过这样做得到解决。

也不确定 QLPreviewController 是否会处理远程 URL。如果没有，您可以下载文件然后显示它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-13T13:05:57.247

我从远程 url 下载文件并保存在本地，然后使用 QLPreviewController 显示 PDF。在 iOS 6 中它可以工作。

首先，我使用以下代码从远程 url 保存文件：

```
 NSString *local_location;

    NSString *path = [[NSBundle mainBundle] pathForResource:@"sampleData" ofType:@"plist"];
        path = NSTemporaryDirectory();
    local_location= [path stringByAppendingPathComponent:[NSString stringWithFormat:@"My_Invoice.pdf"]];
ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:[NSURL URLWithString: remoteurl]];
        [request setDownloadDestinationPath:local_location];
        [request startSynchronous]; 
```

为了显示 Pdf ：

```
QLPreviewController* preview = [[QLPreviewController alloc] init];
        preview.dataSource = self;
        [self presentModalViewController:preview animated:YES]; 
```

QLPreviewController 委托方法是：

```
- (NSInteger) numberOfPreviewItemsInPreviewController: (QLPreviewController *) controller
{
    return 1;
}

- (id <QLPreviewItem>)previewController:(QLPreviewController *)controller previewItemAtIndex:(NSInteger)index
{

    return [NSURL fileURLWithPath:local_location];

} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-09T15:23:12.190

我遇到了类似的问题，似乎它可能源于对 QLPreviewItem 的文件类型 URL 的更严格执行

```
@property (readonly) NSURL *previewItemURL;
Discussion
This property is used by a Quick Look preview controller to get an item’s URL. In typical use, you would implement a getter method in your preview item class to provide this value.

The value of this property must be a file-type URL.

If the item is not available for preview, this property’s getter method should return nil. In this case, the Quick Look preview controller displays a “loading” view.

Availability
Available in iOS 4.0 and later.
Declared In
QLPreviewItem.h 
```

***更新：我已经向 Apple 提出了一个针对 iOS 6 处理此问题的错误，并且似乎他们已将其视为错误，因此可能会在不久的将来提供修复。我打开的错误与使用自定义 NSURLProtocols 进行预览有关，但也可能适用于其他方面。***

[链接到课堂](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Reference/QLPreviewItem_Protocol_iPhoneOS/Reference/Reference.html#//apple_ref/occ/intf/QLPreviewItem)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-07T06:10:45.153

但请注意 QLPreviewController 需要一个指向本地资源的 URL

您需要先在本地下载并保存 PDF 文件，然后为本地文件创建适当的文件 URL。

# javascript - 如何让 jQuery 记住 Rails 应用程序中的状态？

> ID：12643385
> 
> 赞同：1
> 
> 时间：2012-09-28T15:57:44.367
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3

我非常感谢展示 jQuery 功能记忆状态的代码片段，例如 .slideToggle()。

我已经阅读了有关本地存储、会话存储、ajax 等的信息 - 2012 年首选哪种技术以及 Rails 3.2 中的 Ruby 中的实现如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:48:12.650

RC 上的这一集几乎为我提供了有关如何解决它的所有信息：[http ://railscasts.com/episodes/136-jquery-ajax-revised](http://railscasts.com/episodes/136-jquery-ajax-revised)

我在视图中创建了一个带有 remote: true 的 ajaxed 链接。此链接还呈现从会话中的布尔值检索的动态类。

```
<%= link_to "Click here", {action: 'retain_widget_state'}, id: "switcher", class: "#{session[:switch]}", remote: true %> 
```

我在控制器中添加了一个空动作。然后在retain_widget_state.js.erb 我有下面的代码。在其中我切换会话中的状态，然后通过单击上面的链接运行显示或隐藏元素的 jQuery 代码。

```
<% session[:switch] = true if session[:switch] == nil %>
<% if session[:switch] == false %>
    <% session[:switch] = true %>
    $('.company_view').slideDown(400);
<% elsif session[:switch] == true %>
    <% session[:switch] = false %>
    $('.company_view').slideUp(400);
<% end %> 
```

包裹在 $(document).ready(function() {}); 我在刷新页面时放置了“记住”切换状态的条件代码：

```
if ($('#switcher.true').length) {
    $('.company_view').display();
}
else if ($('#switcher.false').length) {
    $('.company_view').hide();
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T17:27:08.723

有不止一种方法可以做到这一点。要将变量作为参数存储在 url 中（可从 rails 中的 params[] 哈希访问），在您的 javascript 中您可以编写类似的内容（示例取自[这个问题](https://stackoverflow.com/questions/3799860/jquery-ajax-to-rails-3-in-rails-how-to-get-the-varible-passed-via-data)）

```
$.ajax({
    data:{"toggle":state}, # This stores the toggle variable in the
                           # url like so: http://localhost:3000/?toggle=1
    # Other stuff }); 
```

如果你想要一些更耐用的东西，试试饼干。Rails3 中有一个 cookies[] 哈希（不确定 rails2）。session[] 散列默认情况下也存储为 cookie。您可以查看此[railscast 制作](http://railscasts.com/episodes/274-remember-me-reset-password)使用 cookies[] 哈希的“记住我”登录功能。另请参阅[Rails3 中 Cookie 类的文档](http://rubydoc.info/docs/rails/3.0.0/ActionDispatch/Cookies)，它很好地解释了您可用的各种选项和方法。

使用 jQuery，您显然需要一个插件，因为使用 jQuery 读取/写入 cookie 的功能不会自动存在（我很惊讶地发现）。这是github上的一个似乎被推荐并且有一些很好的文档，虽然我没有使用它：[https ://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:08:02.900

如果您希望能够随时检索状态**，**我将为您要保存的案例创建记录。名称、值和可能的页面。然后，您可以在页面创建时检索这些值并使用这些值而不是硬编码值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:11:44.593

HTTP 本身是无状态的，这意味着您必须将数据存储在某个地方（jQuery 不会“记住”任何东西）。根据您的预期用途，切换字段的状态可以存储在后端数据库中，或者隐藏在用户浏览器的 cookie 中。

# javascript - “PUT”请求通过 AJAX 发送，但没有传输数据组件

> ID：12643388
> 
> 赞同：0
> 
> 时间：2012-09-28T15:58:08.330
> 
> 标签：javascript, ajax, jquery

通过 AJAX，您应该支持“PUT”和“DELETE”请求。我有一个通过“PUT”请求发送数据的表单，服务器确认它但没有发送任何参数。“删除”请求也会出现同样的结果。如果我改为“发布”，它工作正常。**IE 9、Firefox 和 Chrome**都产生相同的结果。正在发送放置和删除请求，但没有数据。

```
$("#startButton").click(function(){
                $.ajax({url:"http://localhost:8084/Project/servlet",
                    data:parseFormData("simulatorForm"),
                    cache: "false",
                    dataType: "text",
                    contentType: "application/x-www-form-urlencoded",                
                    type:"put",
                    error:function(xhr){alert(xhr.status + xhr.statusText);} });
            }); 
```

**注意：**如果我更改为“发布”，这可以正常工作。我的表单中的所有参数都会被传输。我在 IE、Chrome 和 Mozilla Firefox 中试过这个。

我尝试用纯 javascript 来做，但我得到了完全相同的结果。

```
var xmlhttp=new XMLHttpRequest();
           xmlhttp.open("PUT","http://localhost:8084/UtilityDashboard/SensorSimulator",true);
           xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
           xmlhttp.send(parseFormData("simulatorForm")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:03:02.217

您使用的是什么网络服务器？关于 PUT/DELETE 请求的特别说明：

默认情况下，IIS 6 不支持 PUT 和 DELETE 动词。要启用此功能，您需要将通配符映射添加到应用程序的虚拟目录，这就像单击站点中通配符应用程序映射或 IIS 管理器中的虚拟目录属性旁边的插入按钮并输入 aspnet_isapi 的路径一样简单。 dll。

# java - 尴尬的可变参数参数

> ID：12643390
> 
> 赞同：0
> 
> 时间：2012-09-28T15:58:11.887
> 
> 标签：java, variadic-functions

假设这段代码：

```
public class Test{

    public static void main(String[] args) {
        Test.testInt(new int[]{2,3});
        Test.testInteger(new Integer[]{2,3});
    }

    public static void testInt(Object... elements){
      System.out.println(elements[0] instanceof int[]);
    }

    public static void testInteger(Object... elements){
      System.out.println(elements[0] instanceof Integer);
    }

} 
```

在这两种情况下，都期望有一个包含 2 和 3 的一维数组。因此，乍一看，预期的输出应该是：

```
false
true 
```

惊喜！真正的输出是：

```
true
true 
```

**更新到这篇文章：**

实际上，这不是一个好问题，因为我还没有意识到这种情况符合 Var-args 规则。

总而言之，即使 Var-args 是参数，int[] 数组也不能自动装箱为 Integer[]；没有特殊待遇。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T15:59:56.453

您不能将原始数组自动装箱到“包装器”数组：数组是完全不同的类型！自动装箱原语有一些非常明确的用例。数组不存在这些用例。

您的方法签名要求至少一个`Object`，并且您提供了一个：`int[]`。您的方法签名还允许您提供一个数组，您可以使用`Integer[]`.

还值得指出的是，所有 varargs 方法都可以使用参数类型的数组调用，这就是您正在使用的`Integer`. 由于`int`is 不是`Object`，因此您的编译器会将**数组**视为`Object`.

# r - 如何删除前导“0”。在数字 R 变量中

> ID：12643391
> 
> 赞同：22
> 
> 时间：2012-09-28T15:58:16.947
> 
> 标签：r, formatting, decimal

如何简洁地更改数字 R 变量（保持数字），例如，“-0.34”变成简单的“-.34”？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-07T00:22:06.293

只有当你输出一个数值时，你才需要选择一个具体的表示（即数字应该如何格式化）。您不能将数值变量从“-0.34”更改为“-.34”；两者都是相同数字的表示。

但是，当您输出一个表达式时`e`，您可以选择它的格式。我不知道有任何内置方法可以去掉前导“0”，但你总是可以手动删除它：

```
> sub("^(-?)0.", "\\1.", sprintf("%.2f", -0.34))
[1] "-.34" 
```

为方便起见，您可以定义一个函数，例如，

```
numformat <- function(val) { sub("^(-?)0.", "\\1.", sprintf("%.2f", val)) } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-01-30T13:17:41.873

除了现有的答案之外，我还想提一下，该包`weights`有一个功能`rd()`，可用于“将数字四舍五入为没有前导零的文本”。当然，结果不是数字而是字符。

```
library("weights")
rd(-0.341, digits=2)
[1] "-.34" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-24T05:41:30.873

我需要将数字显示到小数点后 3 位。如果您想打印到任意小数位并且您不想添加另一个包（即`weights`上面的包），那么这个函数（改编自@stefan 的答案）似乎可以工作：

```
numformat <- function(x, digits = 2) { 
    ncode <- paste0("%.", digits, "f")
    sub("^(-?)0.", "\\1.", sprintf(ncode, x))
} 
```

例如：

```
> numformat(-.232, 2)
[1] "-.23"
> numformat(-.232, 3)
[1] "-.232"
> numformat(-.232, 4)
[1] "-.2320" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-07T14:04:05.407

除了@stefan 的好答案，我偶然发现了以下代码，它完成了同样的事情，但打印出更多的小数位：

```
f = function(X1)gsub("0\\.","\\.", X1) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-07T18:16:45.410

如果它用于 R Markdown 中的报告，我使用 MOTE 包和函数 apa() 和代码：`apa(-0.34, 2, FALSE)`这将在我的文档中返回 -.34。

# c++ - 如何使用 clang++ 在 LLVM 中编译 C++ 程序？

> ID：12643398
> 
> 赞同：3
> 
> 时间：2012-09-28T15:58:32.390
> 
> 标签：c++, c, llvm, clang++

有一个教程 - [http://llvm.org/docs/GettingStartedVS.html](http://llvm.org/docs/GettingStartedVS.html)用纯 C 完成的示例。我可以编译和链接它。没有问题，真的。但我需要 C++，而不是纯 C。困难从这里开始。

对于 clang++，我使用类似的字符串

```
"C:\..> clang++ -c hello.cpp -emit-llvm -o hello.bc" 
```

然后：

```
"C:\..> llc -filetype=obj hello.bc" 
```

和

```
"C:\..> link hello.obj -defaultlib:libcmt -out:hello.exe" 
```

那里有 14 个错误`LNK2001: unresolved external symbol`

所以，我需要一些提示。我做错了什么？

```
//----------------- 
```

你好.cpp：

```
#include < iostream >

int main()

{

    std::cout << "TEST\n" << std::endl;

    return 0;

}

//----------------- 
```

操作系统：Windows7。

UPD：主要问题：如何从 .bc 获取 .exe？（LLVM，Windows7）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T17:25:51.693

你可以使用我的[GCC](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/rubenvb/gcc-dw2-4.6-release/)和[Clang](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/rubenvb/clang-3.1-release/)包：

下载并将它们解压缩到同一目录。Clang 将使用 GCC 4.6.3 的 libstdc++ 和 MinGW-w64 的 CRT。像 gcc 一样调用它。

由于 ABI 问题，Clang/LLVM 目前无法与 MSVC 的 C++ 库一起使用。GCC 的 libstdc++ 运行良好，尽管它在令人惊讶的地方（如`std::to_string`、`<regex>`和`<thread>`）有漏洞。

Clang 的 Windows 支持还可以，但远未完成。不幸的是，您不能例如 dllexport 整个 C++ 类。而且 Win64 代码生成也不足以安装有效的 C++（即使与 GCC 结合使用，例如 32 位）。

# macos - 将文件传输到 Web 服务器时转换 Unicode 分解

> ID：12643402
> 
> 赞同：10
> 
> 时间：2012-09-28T15:58:45.490
> 
> 标签：macos, web, rsync, decomposition, unicode-normalization

我在 OS X 上进行网站开发，并且经常发现自己将实时网站的某些部分（运行 Linux/LAMP）移动到在我自己的机器上运行的开发服务器上。一个这样的例子涉及下载图像（用户生成的内容，例如通过 ftp 下载），以一种或另一种方式处理它们，然后将它们放回生产站点。

所涉及的图像文件是在 Linux 机器中创建的，它们的文件名似乎使用 NFC 分解以 UTF-8 编码。另一方面，OS X 的 HFS+ 文件系统不允许 NFC 分解文件名并转换为 NFD。但是，一旦我完成并想要上传文件，它们的名称现在将使用 NFD 分解，因为 Linux 支持它们。因此，新上传的（在某些情况下是替换的）文件将无法通过预期的 URL 访问。

我正在寻找一种方法来在（最好）或之后（`convmv`看起来是一个不错的选择，~~但我在此服务器上没有足够的权限~~在这种特殊情况下是不可能的）传输期间更改文件的 UTF 分解，因为我猜这是不可能事先做的。我已经尝试使用 Transmit 和 rsync（使用通常使用的部署脚本）进行 FTP 上传，但无济于事。rsync中的`--iconv`选项似乎很理想，但不幸的是，我运行 rsync 2.6.9 的服务器无法识别它。

我猜很多人都有类似的问题，我很高兴听到任何解决方案或解决方法！

**更新：**在这种情况下，我最终将文件同步到运行 Ubuntu 的虚拟机，在那里运行 convmv，然后再次同步到我的登台服务器。虽然这工作得相当好，但它有点耗时。也许可以在 OS X 上挂载一个 ext 文件系统，然后使用它们原来的 NFC 分解文件名将文件存储在那里？

此外，为了在以后的 WordPress 安装中避免这个问题，这是我的用例，你可以在上传任何文件`add_filter('sanitize_file_name', 'remove_accents');` *之前*添加一个简单的，你应该没问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-02T22:16:54.967

这似乎`rsync --iconv`是最好的解决方案，因为您可以一步完成文件的传输和名称的转码。您只需要说服您的主机升级他们的 rsync。鉴于该`--iconv`功能是在 2008 年发布的 rsync 3.0.0 中引入的，您的主机仍在运行 rsync 2.6.9 有点奇怪。

如果您无法说服您的主机安装最新的 rsync，您可以编译自己的 rsync，将其上传`~/bin`到服务器上的某个位置，然后在系统安装 rsync 之前将其添加到您的路径中。然后您应该可以使用该`--iconv`选项。只要您使用 rsync over SSH（默认）而不是 rsync 守护程序，这应该可以工作；因为 rsync over SSH 的工作原理是通过 SSH 连接到远程计算机，并`rsync --server`使用传递给本地 rsync 的相同选项运行。

或者您可以找到一个安装了最新工具和 Perl 的主机。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-09-10T14:10:54.027

目前我正在使用`rsync --iconv`这样的：

给定 Linux 服务器和 OS X 机器：

### 将文件从服务器复制到机器

**您应该从服务器**执行此命令（它不适用于 OS X）：

```
rsync --iconv=UTF-8,UTF-8-MAC /home/username/path/on/server/ 'username@your.ip.address.here:/Users/username/path/on/machine/' 
```

### 将文件从机器复制到服务器

**您应该从机器**执行此命令：

```
rsync --iconv=UTF-8-MAC,UTF-8 /Users/username/path/on/machine/ 'username@server.ip.address.here:/home/username/path/on/server/' 
```

# xml - VBScript 和 Xpath 不包括重复项

> ID：12643405
> 
> 赞同：1
> 
> 时间：2012-09-28T15:58:47.757
> 
> 标签：xml, xpath, vbscript, msxml3

我正在尝试使用 vbscript 从 XML 文档中提取名称。

**XML 文档结构**

```
<Aliases>
    <Alias PartyType="DF" CaseID="000000" NameType=""> Name Name</Alias>
    <Alias PartyType="DF" CaseID="000000" NameType=""> Name Name</Alias>
    <Alias PartyType="DF" CaseID="000000" NameType=""> Name Name</Alias>
    ...
</Aliases> 
```

XML 文件可能有 100 行来自多个不同 CaseID 的具有相同名称的行，因为对于我的 vbscript 的这一部分，我试图从所有案例中提取所有*不同*的名称，但这是问题所在，我不想返回重复项.

有没有办法用 xPath 表达式做到这一点，或者我应该尝试用 VBScript 做到这一点？

**更新**

使用下面的答案我现在收到以下错误

> msxml3.dll：预期的令牌 ')' 找到了 ':'。
> 
> 别名/别名[@PartyType='DF' and not(./text() = previous-sibling-->:<--:*/text())]

我试过

```
Aliases/Alias[@PartyType='DF' and not(./text() = preceding::/*text())] 
```

认为应用程序可能使用的是 MSXML.net 而不是 MSXML3，但它仍然给了我同样的错误。

？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:36:14.830

像这样的东西也许

```
/Aliases/Alias[not(./text() = preceding-sibling::*/text())] 
```

（我没试过，但应该可以）

# tridion - Tridion 2011 Event System 如何防止单页发布？

> ID：12643406
> 
> 赞同：7
> 
> 时间：2012-09-28T15:58:51.617
> 
> 标签：tridion

事件系统处理程序代码：

```
[TcmExtension("My Handler")]
public sealed class EventSystem : TcmExtension
{
    public EventSystem()
    {
        EventSystem.Subscribe<Page, PublishEventArgs>((page, e, phases) => {
            if (shouldTerminatePublishing(page))
            {
                throw new Exception(ex, page);
            }
        }, EventPhases.Initiated, EventSubscriptionOrder.Normal);
    }
} 
```

使用上面的代码，当多个页面被发布并且事件系统仅要阻止其中一个页面（通过抛出异常）时，所有页面也被有效地阻止被发布。“生成可发布内容时忽略故障”复选框不会影响此行为。

如何防止任何给定页面发布，但仍允许发布所有其余页面？

**编辑**

根据 Quirijn 的建议更新代码：

```
public class MyResolver: IResolver
{
    public void Resolve(
        IdentifiableObject item,
        ResolveInstruction instruction,
        PublishContext context,
        ISet<ResolvedItem> resolvedItems)
    {
        var page = item as Page;

        if (null != page && instruction.Purpose == ResolvePurpose.Publish)
        {
            try
            {
                // Evaluate whether publishing is allowed
            }
            catch (Exception ex)
            {
                resolvedItems.Clear();
            }
        }
    }
} 
```

到目前为止的一些反对意见（或者更确切地说是后续问题）：

1.  当项目被排除时，没有明智的方法向用户提供明确的反馈（除了建议检查“显示要发布的项目”选项），是吗？
2.  自定义解析器必须明确说明所有项目类型，即：不仅适用于“页面”，还适用于“结构组”和“出版物”，不是吗？
3.  鉴于评估代码可能很昂贵（Web 服务调用），有没有办法至少在准备“显示要发布的项目”列表和执行实际发布之间缓存它的结果？（在这种情况下，评估至少发生两次）。

**编辑 2**

在研究了标准解析器的实现之后：

1.  是否有必要/最好也实施**IBulkResolver**？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T16:08:45.740

您不应该在事件系统中执行此操作，而应在自定义解析器中执行此操作。这是一段代码，当一个项目被放入发布队列时，它被执行以确定哪些页面/组件应该被有效地发布。在这里，您可以过滤掉您不想发布的任何页面或组件。

请参阅[如何使用 Tridion Resolver 从发布中删除项目？](https://stackoverflow.com/questions/11740622/how-to-remove-items-from-publishing-using-a-tridion-resolver).

# cakephp - 在 CakePHP 2.2 中向分页链接添加类

> ID：12643410
> 
> 赞同：0
> 
> 时间：2012-09-28T15:59:07.800
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1, cakephp-2.2

我可以向不包含链接的链接（上一个或下一个）添加一个类（“myclass”）。（当前页面）我只是在默认类之后添加类：

```
echo $this->Paginator->prev('< ', array(), null, array('class' => 'prev disabled myClass')); 
```

它会生成如下内容：

```
<span class="prev myClass disabled ">prev</span> 
```

但是，当上*一个*或*下一个*链接有链接时，则 i 不会添加该类，它会生成如下内容：

```
<span class="prev">
    <a href="/tickets/tickets/index/page:1?url=tickets" rel="prev">prev</a>
</span> 
```

在这种情况下，如何将类添加到此分页链接？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:22:38.327

[API](http://api20.cakephp.org/class/paginator-helper#method-PaginatorHelperprev "不，真的，API")说第二个参数是链接选项的数组，所以我想你可以这样做：

```
echo $this->Paginator->prev('< ', array('class' => 'myLinkClass'), null, array('class' => 'prev disabled myClass')); 
```

# php - 安装了多个版本的 Apache 并发生冲突

> ID：12643414
> 
> 赞同：1
> 
> 时间：2012-09-28T15:59:35.863
> 
> 标签：php, apache, conflict, versions

我开始尝试在一台旧计算机（以前由另一个程序员使用）上创建一个使用 PHP 的网站。

我想测试我的 PHP 代码而不是每次都上传，所以我下载了 Apache 并安装了它。当我发现这台计算机上已经安装了 Apache 时，我开始设置 Apache。

现在我有多个版本的 Apache，所以我进入了添加/删除程序并摆脱了 Apache（它只在列表中出现过一次）。

不幸的是，windows 决定卸载旧版本并保留我无法正常运行的版本。同样出于某种原因，它似乎保留了旧版本中的一些文件，但还不足以让我以任何方式实际使用它。我相信它只是有一些配置文件。

我以为我会将我的文件从新版本复制到旧版本中，而不是替换任何东西，所以希望我能够在旧配置下运行，但这不起作用。

在这一点上，我只是想减少损失，所以我将所有版本的 Apache 存档，这样计算机就无法使用它们。我还从 Windows 启动中删除了 Apache，并在配置一个新版本的 Apache 副本以运行 PHP 后重新启动计算机。

问题是在启动时我可以立即登录到 localhost 并且 apache 已经在运行。此外，当我从未压缩的文件中手动打开 Apache 时，它​​只给了我启动 Apache 的选项（不是停止或重新启动的选项，表示它没有运行），当我单击它时，它显示“请求的操作已失败的！” 这没什么帮助。

所以无论如何，我只想能够在本地运行 PHP，现在我觉得我什至不能成功卸载并从头开始了。有谁知道我必须做些什么才能让它工作？很抱歉描述太长，我编织了一个如此纠结的结。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:08:55.763

一种解决方法是使用 XAMP（Apache + MySQL + PHP）客户端，如 XAMPP [http://www.apachefriends.org/en/xampp.html](http://www.apachefriends.org/en/xampp.html)将其全部设置好供您使用。冲突问题可能是由任何已经带有 Apache 版本的 IDE（例如 Netbeans）引起的。

尝试配置 Apache 案例的配置文件存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:27:26.700

假设：为开发运行 Windows 操作系统，为生产环境运行 linux。

我的建议是不要将 Windows 和 Linux 世界混为一谈，因为虽然它们可以在大量工作后表现出来，但通常是痛苦多于好处。

相反，作为一个不起眼的 windows 和 linux 用户，下载并安装 Virtualbox [https://www.virtualbox.org/wiki/Downloads]，一个免费的开源虚拟化工具。

然后下载您选择的 linux 发行版并将其安装到新的虚拟机中。

在 linux 中配置 linux 工具，让你的 windows 机器相对保持不变。

一个有用的 linux 服务可以安装是 Samba——windows 文件共享——你可以使用它来使用你选择的任何 IDE 在 windows 中编辑你的代码，同时直接保存到 linux 并通过 linux 进行测试。高兴时，从 linux 系统上传（再次像任何其他文件上传器一样），一切都会好起来的。

如果您在生产服务中部署到基于 linux 的环境，那么这将帮助您避免常见错误，例如区分大小写问题和许多其他错误。

构建和运行这个系统是免费的，它将帮助您更多地了解您正在部署的 linux 环境。

同样，当您没有启动虚拟机时，没有任何服务可以让您的计算机暴露于可能的本地网络威胁和消耗资源 - 而不是在 Windows 上安装 Apache，它会一直使用一些资源。

# c# - 在 CRM Dynamics 中对属性使用别名时如何访问 fetchedXML 中的值？

> ID：12643418
> 
> 赞同：6
> 
> 时间：2012-09-28T15:59:50.263
> 
> 标签：c#, dynamics-crm, dynamics-crm-2011

我正在获取营销列表列表。当我这样做时，根据我使用智能感知的检查，这似乎是一个成功的操作。当我寻找时，`...Entities[0].Attributes["nick"]`我得到一个对象（其中某处有正确的数据）。但是我无法以编程方式访问它（相反，我必须像猴子一样通过加号点击来折叠好东西）。

事实上，我正在使用下面的代码来获取实体。问题是它们不是`Strings`根据计算机。它们是类型的`Microsoft.Xrm.Sdk.AliasedValue`，我不知道如何访问它们内部的实际昵称。

```
new Contact
{
  Name = element.Attributes["nick"] as String,
  Mail = element.Attributes["mail"] as String
} 
```

Intellisense 说它`Value`在那里（它也是正确的值），但我无法通过键入来访问它`.Value`。我怀疑我需要使用“as”或类似的东西，但目前我被卡住了。有什么提示吗？`As`'ing it to `String`，这应该可以工作，给了我`null`......

我已经阅读[了这篇文章](http://msdn.microsoft.com/en-us/library/microsoft.xrm.sdk.aliasedvalue_members.aspx)和其他几篇喜欢它的文章，而且我看到它的方式，我应该能够访问其中所有有趣的东西。我虽然不能...

我注意到下面的代码让我得到了我非常想得到的数据，但这**不可能**是专业的语法，可以吗？！说真的，看起来像一个患有多动症和宿醉的高中生试图这样做......

```
new Contact
{
  Name = ((Microsoft.Xrm.Sdk.AliasedValue)result.Entities[0].Attributes["nick"]).Value,
  Mail = ((Microsoft.Xrm.Sdk.AliasedValue)result.Entities[0].Attributes["mail"]).Value
} 
```

我的意思是，说真的 - 这是一段丑陋的代码......必须有更好的方法！但是，我担心不是因为[这个讨论](http://social.microsoft.com/Forums/en-US/crmdevelopment/thread/e3a4e5a9-1797-481f-8d66-fd2cd4abf560/)似乎也在使用那种语法......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T22:21:28.820

查看[文档](http://msdn.microsoft.com/en-us/library/microsoft.xrm.sdk.attributecollection.aspx "AttributeCollection 类")，对象的`Attributes`属性`Entity`是类型`AttributeCollection`，它派生自`DataCollection<string,Object>`.

> 对于集合中的每个属性，都有一个键/值对。

因此，对于每个键（“nick”、“mail”），都有一个对应`object`的 .NET 类型。您*必须*将对象转换为正确的类型（就像您所做的那样）才能访问您正在寻找的属性（或者使用反射，这肯定会更丑陋，或者我认为在 C# 4.0 中[`dynamic`type](https://stackoverflow.com/a/3647831/684271 "为什么在 c# 中使用动态类型？")，但在那情况下，您将失去编译时检查）；编译器如何才能确定属性是否属于`string`/ `Money`/ `int`/ `AliasedValue`/等类型？

至于[`AliasedValue`](http://technet.microsoft.com/en-us/library/microsoft.xrm.sdk.aliasedvalue_members.aspx "AliasedValue 成员")，CRM 使用这种类型来存储有关返回值的附加信息，并且由于任何属性都可以别名，因此`Value`属性可以是任何类型（`OptionSetValue`、`decimal`、`string`、`Guid`、`EntityReference`等）。然后该`Value`属性也适当地属于 type `object`，因此您也必须对其进行强制转换以获取有关返回值的任何其他信息。

所以没有办法进行强制转换，但是您可以通过`using`在文件顶部添加一条语句并`AliasedValue`在分配给`Contact`. 无论如何，我已经为每种类型的数据检索提供了一个示例；您可以判断哪个在您的项目中更好。

使用铸造：

```
using Microsoft.Xrm.Sdk;

...

var nick = (AliasedValue)result.Entities[0].Attributes["nick"];
var mail = (AliasedValue)result.Entities[0].Attributes["mail"];

var contact = new Contact
{
    Name = nick.Value, //Value is of type object; cast again for a more specific type
    Mail = mail.Value
}; 
```

使用反射：

```
var nick = result.Entities[0].Attributes["nick"]
    .GetType()
    .GetProperty("Value")
    .GetValue(result.Entities[0].Attributes["nick"], null);
var mail = result.Entities[0].Attributes["mail"]
    .GetType()
    .GetProperty("Value")
    .GetValue(result.Entities[0].Attributes["mail"], null);

var contact = new Contact
{
    Name = nick,
    Mail = mail
}; 
```

使用动态：

```
dynamic nick = result.Entities[0].Attributes["nick"];
dynamic mail = result.Entities[0].Attributes["mail"];

var contact = new Contact
{
    Name = nick.Value, //dynamic figures out the right property at runtime
    Mail = mail.Value
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-18T14:25:00.157

我想你想要这样的东西：

```
 //Get Account PrimaryContact details
        public static void GetAccountPrimaryContactDetails(Guid accountId, IOrganizationService orgService)
        {
            var contactFirstName = default(object);
            var contactLastName = default(object);
            var contactFullName = default(object);

            string fetchXML = string.Format(@"<fetch version='1.0' output-format='xml-platform' no-lock='true' mapping='logical'>
                                    <entity name='account'>
                                        <attribute name='name' />                                                                                
                                        <filter type='and'>
                                            <condition attribute='statuscode' operator='eq' value='1' />                                            
                                            <condition attribute='accountid' operator='eq' value='{0}' />
                                        </filter>                                        
                                        <link-entity name='contact' from='contactid' to='primarycontactid' alias='ab'>
                                             <attribute name='fullname' alias='as_fullname' />
                                             <attribute name='firstname' alias='as_firstname' />                                             
                                             <attribute name='lastname' alias='as_lastname' />
                                        </link-entity>
                                    </entity>
                                </fetch>", accountId.ToString());

            var fetchExp = new FetchExpression(fetchXML);

            EntityCollection accountEntity = orgService.RetrieveMultiple(fetchExp);

            if (accountEntity.Entities.Count > 0)
            {
                //Primary Contact Fullname
                AliasedValue avContactFullname = accountEntity.Entities[0].GetAttributeValue<AliasedValue>("as_fullname");
                if (avContactFullname != null)
                    contactFullName = avContactFullname.Value;
                //Primary Contact Firstname
                AliasedValue avContactFirstname = accountEntity.Entities[0].GetAttributeValue<AliasedValue>("as_firstname");
                if (avContactFirstname != null)
                    contactFirstName = avContactFirstname.Value;
                //Primary Contact Lastname
                AliasedValue avContactLastname = accountEntity.Entities[0].GetAttributeValue<AliasedValue>("as_lastname");
                if (avContactLastname != null)
                    contactLastName = avContactLastname.Value; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-20T15:54:51.443

我们定义了一个 GetValue 帮助函数，它为您处理检查别名值

```
public static T GetValue<T>(this Entity entity, string attributeName)
{
     if (entity.Attributes.ContainsKey(attributeName))
    {
        var attr = entity[attributeName];
        if (attr is AliasedValue)
        {
            return GetAliasedValueValue<T>(entity, attributeName);
        }
        else
        {
            return entity.GetAttributeValue<T>(attributeName);
        }
    }
    else
    {
        return default(T);
    }

} 
```

这使用内部额外的辅助方法来获取别名字段值

```
private static T GetAliasedValueValue<T>(this Entity entity, string attributeName)
        {
            var attr = entity.GetAttributeValue<AliasedValue>(attributeName);
            if (attr != null)
            {
                return (T)attr.Value;
            }
            else
            {
                return default(T);
            }

        } 
```

它被定义为 Entity 类的扩展方法，因此您可以像 SDK 提供的 GetAttributeValue 一样使用它 - 您只需要记住使用别名字段名称即可。

```
var myValue = myEntity.GetValue<string>("alias.fieldname") 
```

# php - 在 FuelPHP 中连接到 MSSQL 服务器时 PDO Adaptive Server 连接失败

> ID：12643420
> 
> 赞同：0
> 
> 时间：2012-09-28T16:00:01.040
> 
> 标签：php, sql-server, pdo, fuelphp

当我尝试通过 PDO 连接到 MSSQL 数据库时，FuelPHP 似乎在做一些奇怪的事情。

# 在 FuelPHP 之外工作

我在本地服务器上的普通 PHP 页面中尝试了以下内容：

```
<?php
$mssql = new \PDO('dblib:host=<IP OF HOST>;dbname=<DBNAME>', '<USER>', '<PASS>'); 
```

一切正常。它连接起来，我可以像我期望的那样轻松查询数据库。

# 不在 FuelPHP 内部工作

但是，当我尝试在 config/db.php 中添加具有基本相同信息的连接时，会引发异常。

```
<?php
return array(
  'mssql' => array(
    'connection'  => array(
      'dsn'        => 'dblib:host=<IP OF HOST>;dbname=<DBNAME>',
      'username'   => '<USER>',
      'password'   => '<PASS>',
    ),
    'type'        => 'pdo',
    'table_prefix' => '',
  ),
); 
```

随后尝试在 FuelPHP 中查询数据库，如下所示：

```
$q = \DB::select()
        ->from('table')
        ->limit(5);

$r = $q->execute('mssql'); 
```

抛出以下异常：`Fuel\Core\Database_Exception [ 20002 ]: SQLSTATE[01002] Adaptive Server connection failed (severity 9)`

当我尝试在 FuelPHP 的控制器中进行原始的基本连接时，我得到了相同的错误消息。因此，即使是普通的 PDO 连接，FuelPHP 似乎也会造成严重破坏。

## FuelPHP 控制器中的基本连接尝试示例。

```
<?php

class Controller_Welcome extends Controller
{
  public function action_index()
  {
    $mssql = new \PDO('dblib:host=<IP OF HOST>;dbname=<DBNAME>', '<USER>', '<PASS>');
  }
} 
```

作为参考，我正在使用 PHP 5.3.16 并使用 FreeTDS 从我的 OS X 笔记本电脑进行连接。（这应该不是问题，因为香草版本有效。）

# ios - PushViewController iOS

> ID：12643421
> 
> 赞同：0
> 
> 时间：2012-09-28T16:00:06.003
> 
> 标签：ios, pushviewcontroller

我有三个视图控制器。`MainViewController`, `secondViewController`, `thirdViewController`. 我想知道，一旦我点击`done`按钮`thirdViewcontroller`，

我怎么能直接去哟`MainViewController`而不是回去`secondViewController`然后`MainViewcontroller`使用`pushViewController`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:03:20.790

假设您使用导航控制器，您可以通过调用弹出到根目录：

```
[[self navigationController] popToRootViewControllerAnimated:YES]; 
```

这将带您回到 MainViewController。

# c++ - 这样的演员阵容可以吗？

> ID：12643424
> 
> 赞同：2
> 
> 时间：2012-09-28T16:00:14.857
> 
> 标签：c++, type-conversion

```
int main() {

 class A {
    public:
    static double test_code(const A& a);
  };

   class B : public A {
   public:
   B(int i) { };
   static double test_code2(const B& b);
   };

A::test_code(2);
B::test_code2(2);

return 0;

} 
```

参看：http: [//ideone.com/ilfE8](http://ideone.com/ilfE8)

第一个方法调用不会编译，而第二个会。有没有办法使这种转换工作？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:17:02.143

不，这不能用于隐式类型转换。这有多种原因，更简单的是，如果要让它成为一个选项，编译器必须在调用位置知道所有可能扩展的类型，`A`然后检查它们是否可以从 隐式转换`int`，解决潜在的歧义......请注意，从给定类型扩展的*所有*类型都是一个开放集，可以在当前翻译单元构建*后扩展！*

您可以通过不同的方式实现类似的功能，例如创建一个接受`int`并返回`A`对象的函数，或显式创建`B`. 但是它们都不允许隐式转换（即不修改代码以显式请求转换的路径）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:09:42.170

这编译得很好，

```
int main()
{
    class A {
    public:
        A(int i)
        {}
        static double test_code(const A& a) { return 0.0; }
    };

    class B : public A {
    public:
        B(int i)
            : A(i) {}
        static double test_code2(const B& b) { return 0.0; }
    };

    A::test_code(2);
    B::test_code2(2);

    return 0;
} 
```

# javascript - 给IE浏览器做个条件？

> ID：12643427
> 
> 赞同：1
> 
> 时间：2012-09-28T16:00:25.293
> 
> 标签：javascript

```
 <script language = "javascript">
  if (navigator.appName == "Microsoft Internet Explorer") {
begin = navigator.userAgent.indexOf("MSIE ") +
"MSIE ".length;
if(navigator.userAgent.indexOf(";", begin) > 0) {
end = navigator.userAgent.indexOf(";", begin);
} else {
end = navigator.userAgent.indexOf(")", begin)
+ 2;
}
document.getElementById("targetDiv").innerHTML =
"You are using Internet Explorer " +
navigator.userAgent.substring(begin, end);
}
}
    </script> 
```

为什么在给IE浏览器做条件的时候，加了一个`else`部分？它的意义和作用是什么？谢谢你，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:15:50.460

您不应该使用 Javascript 来嗅探 Internet Explorer。 [欢迎使用 HTML 条件注释](http://www.quirksmode.org/css/condcom.html)：

**检测 IE：**

```
<!--[if IE]>
    <!-- Add IE script file here -->
<![endif]--> 
```

**用于检测除 IE 之外的任何内容：**

```
<!--[if !IE]> -->
    <!-- Add non-IE script file here -->
<!-- <![endif]--> 
```

Javascript 不是浏览器嗅探的好解决方案，因为您应该只将其用作“逐步增强”网站的一种方式。如果您的网站在有人没有启用 Javascript 时会崩溃，那么这是不可接受的。构建您的网站并使用 Javascript 添加必要的效果以创造更好的体验。

如果您已经拥有检测 Internet Explorer 的本机方法，则尤其如此。为什么不使用一种适用于所有浏览器的方法，而不是一种适用于只允许 Javascript 的浏览器的方法？你永远不可能如此确定。

# c# - 在不使用 microsoft.sharepoint dll 的情况下验证 c# 中的共享点链接

> ID：12643428
> 
> 赞同：1
> 
> 时间：2012-09-28T16:00:33.600
> 
> 标签：c#, sharepoint

我正在验证常规 URL，如下所示：

```
private static bool IsUrlAvailable(string url)
    {

        if ((string.IsNullOrEmpty(url.Trim()) == true) ||
            (url.Trim().ToLower().Equals("http://")) ||
            (url.Trim().ToLower().Equals("https://")))
        {
            return false;
        }
        if (!url.ToLower().StartsWith("http://") && !url.ToLower().StartsWith("https://"))
        {
            url = "http://" + url;
        }
        try
        {
            var req = (HttpWebRequest)WebRequest.Create(url);
            req.Timeout = 15000;
            req.Method = "HEAD";
            using (var rsp = (HttpWebResponse)req.GetResponse())
            {
                if (rsp.StatusCode == HttpStatusCode.OK)
                {
                    return true;
                }
            }
        }
        catch (Exception ex)
        {
            // Eat it because all we want to do is return false 
        }

        // Otherwise 
        return false;
    } 
```

但由于我使用的是 WebRequest.Create，因此 Intranet 上经过身份验证的 SharePoint url 验证失败，因为权限被拒绝 (404) 错误。现在我知道我们可以使用`SPSite.Exists`or来验证它，`OpenWeb`但这些仅在 microsoft.sharepoint.dll 中可用，我想知道是否有一种方法可以在不使用此 DLL 的情况下执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:04:08.800

404 不是权限被拒绝...而是找不到文件。所以你可能确实点击了不存在的 URL。

您需要[在请求中传递凭据](http://msdn.microsoft.com/en-us/library/system.net.webrequest.credentials%28v=vs.100%29.aspx)

```
WebRequest request = WebRequest.Create ("http://www.contoso.com/default.html");
// If required by the server, set the credentials.
request.Credentials = CredentialCache.DefaultCredentials;
// Get the response.
HttpWebResponse response = (HttpWebResponse)request.GetResponse (); 
```

旁注：请不要“吃掉所有异常” - 在进行 WebRequest 的情况下，有一小部分异常很有趣，您可以在有关[HttpWebRequest.GetResponse](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.getresponse%28v=vs.100%29.aspx)的文章中找到这些异常（您应该只处理 WebException）。

# php - 在新窗口中执行

> ID：12643432
> 
> 赞同：0
> 
> 时间：2012-09-28T16:00:45.003
> 
> 标签：php, exec

我有一个 php bot 脚本，它会永远加载直到它死掉。所以我想用 exec() 启动其他人的机器人，但他们的机器人可以工作，但我的机器人停止响应。如何在新的 php 窗口中启动机器人，这样我的机器人就不会死机？

我的代码：

```
exec("php ".$input.".php"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:08:44.133

这是一个糟糕的解决方案，但如果你在 Windows 机器上本地运行脚本，你可以使用类似的东西：

`exec('start "Window Title" "php" "script_name.php"');`

从那里开始，其他每个脚本都将在它们自己的分离进程中运行。缺点是您的父脚本将无法“杀死”它们。它们必须自行终止，否则您必须手动终止它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:10:25.523

据说 PHP 没有“新窗口”，这对 Javascript 来说是个问题。您可以使用以下语法在 Javascript 中打开一个新窗口：

```
window.open(URL,name,specs,replace) 
```

我建议在新窗口中打开一个 php 文件，并让该文件包含您的`exec()`命令。 [在此处查看有关此 Javascript 方法细节的更多信息。](http://www.quirksmode.org/js/popup.html)

# sqlite - 如何在潮汐dk/titanium 桌面上使用预填充的数据库

> ID：12643437
> 
> 赞同：2
> 
> 时间：2012-09-28T16:01:06.860
> 
> 标签：sqlite, titanium, desktop-application, tidesdk

在开发带有预填充数据库的桌面应用程序时，我需要一些帮助。[我已经尝试了很多方法来让这个工作，包括在http://tidesdk.multipart.net/docs/user-dev/generated/#!/api/Ti.Database.DB](http://tidesdk.multipart.net/docs/user-dev/generated/#!/api/Ti.Database.DB)和 Titanium Desktops old的 Tidesdk 的 API 中提到的方法API 在这里[http://developer.appcelerator.com/apidoc/desktop/latest/Titanium.Database-module](http://developer.appcelerator.com/apidoc/desktop/latest/Titanium.Database-module)。

虽然后者（使用 Titanium 而不是 Ti）用于在应用程序目录中创建数据库，但它不会安装位于我的应用程序资源文件中的预填充 sqlite 数据库。

我的一些尝试位于下面

```
var db = Titanium.Database.openFile('test_db.sqlite', 'test_db');

var db = Titanium.Database.openFile(Ti.Filesystem.getFile(
                          Ti.Filesystem.getApplicationDataDirectory(), 'test_db.sqlite')); 

var db = Ti.Database.open('test_db'); 
```

如前所述，其中大多数都设法创建一个具有给定名称的数据库，但是当尝试运行像 db.execute(SELECT) 这样简单的东西时，我知道我的预填充数据库中会存在一些东西，我收到一条错误消息

```
 Exception executing: SELECT name, id FROM people ORDER BY name COLLATE NOCASE, Error was: SQL Statement invalid or database missing 
```

我已经到处搜索了一些东西来回答这个问题，但每个人都继续参考上述 API 或移动 API 的 Ti.database.install() 也不起作用。

钛桌面是否可以使用预先填充的 sqlite 数据库，或者我必须在创建它之后填充它？如果是这样，任何方向都会有所帮助（将 .sqlite 文件放置在应用程序中的何处以及调用哪些函数）。

我目前正在使用 Titanium Studio 和 1.2.0.RC4 的 Titanium 桌面 osx SDK，这是按照 titesdk.org 的要求，直到他们在那里发布了开源 sdk。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:35:58.787

这是可能的，我刚刚在最近的一个桌面应用程序中使用了这个功能，成功地将它部署到了 Windows 和 Mac 上。

以我的经验，有时您的数据库文件可能已损坏，例如，如果您使用`Titanium.Database.install`命令，并且找不到要从中预加载的文件（例如，可能是您第一次指定错误的路径），它会自行创建文件，任何后续安装命令都将不起作用，因为它已经认为该数据库已安装。

您是否尝试过清除应用程序数据？这是钛安装数据库的地方。对于 Mac，它位于您的`/User/Library/Application Support/APPNAME`目录中。他们是数据库的目录，删除它并重试。

[此外，这个关于Titanium Q&A 的](http://developer.appcelerator.com/question/3431/basic-question-about-titaniumdatabase#answer-178121)答案可能会有所帮助，它讨论了移动 SDK 的过程，但数据库的东西是一样的。

希望这可以帮助！

# c++ - Win 32 写入文件：访问冲突和错误 1784

> ID：12643441
> 
> 赞同：2
> 
> 时间：2012-09-28T16:01:41.793
> 
> 标签：c++, winapi

下面的代码有两个问题。首先，我一直在搜索这个论坛和其他各种论坛，以寻找我的 1784 错误代码的答案，但我尝试过的一切都失败了。我在 stackoverflow 上检查的两个线程是[WriteFile 返回错误 1784](https://stackoverflow.com/questions/6537416/writefile-returning-error-1784)和[BlockWrite I/O Error 1784](https://stackoverflow.com/questions/11287901/blockwrite-i-o-error-1784)。我已经检查了这个论坛上的其他一些人，但我不记得现在具体是什么了。

我正在尝试将结构数组保存到一个空的二进制文件中。第一个问题是，如果我的大小变量（nNumberOfBytesToWrite 参数）小于 99000 字节，我就会遇到访问冲突。这个数字跳来跳去。有一段时间，当我测试它时，如果它是 99,999 字节而不是 100,000 字节，则会出现访问冲突。当然，我最终想要做的是将大小设置为整个数组的大小。现在要处理的原始代码已被注释掉，因此我可以使用各种尺寸进行测试。

发生的第二件事（如果我没有遇到访问冲突）是我收到错误代码 1784 并且 WriteFile 每次都失败。正如该主题的其他线程所述，这在 MSDN 上被定义为 ERROR_INVALID_USER_BUFFER 并且描述是“提供的用户缓冲区对于请求的操作无效”。我查看了 MSDN 自己的示例来打开这样的文件（[http://msdn.microsoft.com/en-us/library/windows/desktop/bb540534%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb540534%28v=vs.85%29.aspx)）并尝试了一些基于他们的代码的变化，但似乎没有任何效果。

这个问题可能是大量的菜鸟，我确信我忽略了一些简单得可笑的事情，但如果有人有建议，他们将不胜感激。

```
case IDM_SAVE1:
{
    HANDLE hFile = CreateFile("MineSave.mss", GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
    int test_buffer[] = {1,2,3,4,5,6,7,8,9,10};

    if(hFile != INVALID_HANDLE_VALUE)
    {
        BOOL bSuccess;
        DWORD size = 100000; //DWORD size = (((sizeof(tile)) * tiles_total));
        LPDWORD bytes_written = 0;
        bSuccess = WriteFile(hFile, test_buffer, size, bytes_written, NULL);
        if(bSuccess)
        {
            MessageBox(hwnd, "File saved successfully.", "Great Job!", MB_OK);
        }
        else
        {
            DWORD error = GetLastError();
            MessageBox(hwnd, "Could not write to file.", "Error", MB_OK);
        }

        CloseHandle(hFile);
    }
    else
    {
        MessageBox(hwnd, "Could not create file.", "Error", MB_OK);
    }
}
break; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T16:29:34.810

您的缓冲区大小为 10 个整数，在 Windows 上为 40 个字节。您正在尝试从该缓冲区写入 100,000 个字节。那是未定义的行为，缓冲区溢出。因此访问冲突。

您不能将大于 的值传递`sizeof(test_buffer)`给`40`的`nNumberOfBytesToWrite`参数`WriteFile`。

您需要循环写入此文件，一次写入 40 个字节，直到您写入所需的内容为止。也许是这样的：

```
BOOL bSuccess = TRUE;
DWORD bytesRemaining = 100000;
while (bSuccess && bytesRemaining>0)
{
    DWORD bytesToWrite = std::min(sizeof(test_buffer), bytesRemaining);
    DWORD bytesWritten;
    bSuccess = WriteFile(hFile, test_buffer, bytesToWrite, &bytesWritten, NULL);
    bytesRemaining -= bytesToWrite;
}
if (!bSuccess)
{
    //handle error;
} 
```

一次写入 40 个字节非常慢。您会发现每次调用`WriteFile`.

请注意，如果您也传递给，则不允许传递`NULL`给参数，就像您在此处所做的那样。从[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365747.aspx)中：`lpNumberOfBytesWritten``NULL``lpOverlapped`

> *lpNumberOfBytesWritten* [输出，可选]
> 
> ……
> 
> 只有当 lpOverlapped 参数不为 NULL 时，此参数才可以为 NULL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:59:23.780

您**必须**提供一个缓冲区来接收写入的字节数，`lpNumberOfBytesWritten`参数必须为非 NULL，或者`lpOverlapped`参数必须为非 NULL。

您为两者都传递了 NULL，这是非法的并导致访问冲突。

# c# - 更多后退按钮和gridview问题

> ID：12643446
> 
> 赞同：1
> 
> 时间：2012-09-28T16:02:05.563
> 
> 标签：c#, asp.net

我即将使用这个网络应用程序，但仍然有一个明显的问题，即用户使用后退按钮后网格视图中的数据错误。这是另一个主搜索/详细信息类型页面。用户搜索项目，这些项目显示在页面 search.aspx 上的网格视图中。用户可以单击项目进入详细信息页面 itemdetails.aspx。一切正常，直到用户使用后退按钮。

例如，搜索狗，在 search.aspx 上的 gridview 中获取狗的列表。单击狗记录并在 itemdetails.aspx 上查看它们的详细信息。搜索猫，在 search.aspx 中的 gridview 上获取猫的列表。单击猫查看详细信息，使用返回返回到包含猫列表的 search.aspx，单击另一只猫查看详细信息。到目前为止一切都很好。当用户返回几次时，问题就开始了，从猫的详细信息到猫的搜索结果，再回到狗的详细信息，然后再回到狗的搜索结果。现在，如果用户单击搜索结果第 3 行中的狗，则显示的详细信息页面是最近搜索中第 3 行中的猫。

我试过清除缓存，这会强制重新加载网格，但用户总是看到页面过期页面并且必须重新提交数据。我已经尝试过 Server.Transfer 和 Response.Redirect 到搜索页面以尝试重新加载网格，但这使得用户必须单击记录两次（一次重新加载过期的网格，然后再次转到详细信息。）还尝试了重新绑定网格，以及 4-5 天左右的许多其他事情，我不记得全部了。没有任何东西可以解决问题而不产生意想不到的副作用。在这一点上，我只想要一个解决方案，即使我必须重写整个事情。感谢您的任何建议！

public partial class Search : System.Web.UI.Page { public string searchString;//用于在搜索框中输入的信息 public string searchISBN;//在gridview ISBN中保存点击的项目

```
private void GetProducts()
{
    try
    {
        DataSet ds = DataAccess.GetProductsPerCategory(searchString);
        GridView1.DataSource = ds;
        GridView1.DataBind();
    }
    catch (SqlException ex)
    {

        lblSearch.Text = "Cannot get product data." + ex.Message;
    }
}

protected void Button2_Click(object sender, EventArgs e)
    //button in gridview, sends to item detail page
{
    LinkButton btn = (LinkButton)(sender);
    searchISBN = btn.CommandArgument;
    //call product detail page, pass ISBN
    Global.SetISBNData = searchISBN;
    Server.Transfer("ItemDetail.aspx");
}

//when this search page is called from site.master page,
//search criteria passed to GetProducts
protected void Page_Load(object sender, EventArgs e)
{
     if (IsExpired())
    {
        Response.Redirect("Expired.aspx");
    }
    else
    {
       this.SaveTimeStamps();
        searchString = Global.GetSearchData;
        GetProducts();
    }
}

private bool IsExpired()
{
    if (Session["Search_SearchStamp"] == null)
        return false;
    else if (ViewState["SearchStamp"] == null)
        return false;
    else if (ViewState["SearchStamp"].ToString() ==
            Session["Search_SearchStamp"].ToString())
        return false;
    else
        return true;

}

private void SaveTimeStamps()
{
    DateTime dtm = DateTime.Now;
    ViewState.Add("SearchStamp", dtm);
    Session.Add("Search_SearchStamp", dtm);
 } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:18:24.037

答案一直就在我面前，只需要把 2 和 2 放在一起。

我将 page_load 中的语句移动到受保护的覆盖 void OnInit(EventArgs e) 并且它已经清除了一切。

我测试了 5 个级别的搜索，然后使用后退按钮返回到原始搜索。单击原始网格视图（或两者之间的任何位置）中的项目将转到正确的详细记录。感谢所有关于堆栈溢出的信息和提示，这个问题解决了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T18:01:42.040

从 Danger 的建议中，我想出了一个更可靠的解决方案。显然，自从 07 年我在大学学习 asp.net 以来，情况发生了很大变化（想象一下！）无论如何，我发现如果你使用 url 参数，在这种情况下情况会好得多。在 On Init 中使用全局变量和语句时，正确的事件顺序会导致故障。现在使用参数化的 url，在使用后退按钮时，显然网格总是被刷新。从我的 Murach 的书中 - 使用编码超链接的页面总是被处理，就好像它是第一次被请求一样。更新了下面的代码。一个额外的好处是这种方法允许直接链接到我的产品或搜索结果集。

```
//masterpage search button click
protected void btnMasterSearch_Click(object sender, EventArgs e)
    {
        //input is from the user's entry in text box
        string input = txtMasterSearch.Text;
        //result is filtered by regex then added to url for search
        string result = Regex.Replace(input, @"[^\w\.@-]", "");
        try
    {
        if (String.IsNullOrEmpty(result))
        {
            throw new ArgumentException("Null is not allowed");
        }
        else
        {
            Response.Redirect("Search.aspx?search=" + result);
        }
//search.aspx
public partial class Search : System.Web.UI.Page
{
    public string productparam;//product parameter to add to url
    public string searchparam;//search parameter from url
protected void Page_Load(object sender, EventArgs e)
    {
              searchparam = Request.QueryString["search"];
              GetProducts();
    }
private void GetProducts()
    {
        try
        {
            DataSet ds = DataAccess.GetProductsPerCategory(searchparam);
            GridView1.DataSource = ds;
            GridView1.DataBind();
        }
        catch (SqlException ex)
        {
        lblSearch.Text = "Cannot get product data." + ex.Message;
        }
    }
protected void Button2_Click(object sender, EventArgs e)
        //button in gridview, sends to item detail page
    {
        LinkButton btn = (LinkButton)(sender);
        productparam = btn.CommandArgument;
        Server.Transfer("ItemDetail.aspx?product=" + productparam);
    }
//item detail page
public partial class ItemDetail : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        try
        {
            lblISBN.Text = Request.QueryString["product"];
        }
        catch (Exception ex)
        {
        lblISBN.Text = "Cannot get product data." + ex.Message;
        }
    }
 } 
```

# performance - SSAS 2008 R2 与 Sybase OLEDB (ASEOLEDB.1)

> ID：12643452
> 
> 赞同：1
> 
> 时间：2012-09-28T16:02:15.720
> 
> 标签：performance, ssas, sap-ase

我正在使用 Adaptive Server Enterprise 15.7 设计一个大容量数据仓库。该企业已经在使用 SSAS 2008 R2 进行大部分数据分析，并希望在上述数据仓库的基础上继续使用它。

我想知道社区中是否有人以前做过类似的事情并可以分享一些建议。关于这个数据仓库的一些估计如下：

*   尺寸在缓慢变化（每 3 天左右）
*   Facts 每天将获得约 1500 万条新记录（12 项措施）

我最关心的是处理的性能而不是查询。

干杯，

类风湿关节炎

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T16:52:09.460

您是否正在寻找任何具体的建议 - 例如分区、配置、SCD-2 设计等？

有关 SSAS 处理的一些良好的一般指导，请查看：

[http://technet.microsoft.com/en-us/library/cc966525.aspx](http://technet.microsoft.com/en-us/library/cc966525.aspx)

[http://sqlcat.com/sqlcat/b/whitepapers/archive/2011/10/10/analysis-services-2008-r2-performance-guide.aspx](http://sqlcat.com/sqlcat/b/whitepapers/archive/2011/10/10/analysis-services-2008-r2-performance-guide.aspx)

# arrays - JNI设置静态字段字符串数组

> ID：12643453
> 
> 赞同：3
> 
> 时间：2012-09-28T16:02:17.263
> 
> 标签：arrays, string, static, java-native-interface

我正在尝试在我的班级中设置一个字符串数组字段，但遇到了各种问题。这是我到目前为止所拥有的：

```
JNIEXPORT jint JNICALL Java__Names1_GetMyNames(JNIEnv *env, jobject obj)
{
jfieldID myNamesID; /* store the field ID */
int i=0;
jstring myStr;
jobject dev;
char* myNames[] = {"Hello ", "world!"};

// Get a reference to obj’s class 
jclass cls = env->GetObjectClass(obj);
// Get static field ID
myNamesID = env->GetStaticFieldID(cls, "myDevNames", "[Ljava/lang/String;");
// Get the object field
dev = env->GetObjectField(obj,myNamesID);

for (i=0; i<2; i++) {
myStr = env->NewStringUTF(myNames[i]);
env->SetObjectArrayElement(dev,i,myStr);
}
return 0;
} 
```

这是我的字符串：

```
private static String[] myDevNames= new String[12]; 
```

当我尝试编译时，出现以下错误：

错误：从 'jobject {aka _jobject*}' 到 'jobjectArray {aka _jobjectArray*}' 的无效转换 [-fpermissive]

任何想法我做错了什么？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:16:28.497

更新 - 我之前使用 jarray 而不是 jobject 的建议是不正确的。我正在查看旧文档。基于[http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/functions.html](http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/functions.html)这个怎么样？将 dev 重新定义为 jobjectArray，但您还需要对 GetStaticObjectField 的调用进行强制转换。

```
JNIEXPORT jint JNICALL Java__Names1_GetMyNames(JNIEnv *env, jobject obj)
{
jfieldID myNamesID; /* store the field ID */
int i=0;
jstring myStr;
jobjectArray dev;
char* myNames[] = {"Hello ", "world!"};

// Get a reference to obj’s class 
jclass cls = env->GetObjectClass(obj);
// Get static field ID
myNamesID = env->GetStaticFieldID(cls, "myDevNames", "[Ljava/lang/String;");
// Get the object field
dev = static_cast<jobjectArray>(env->GetStaticObjectField(cls,myNamesID));

for (i=0; i<2; i++) {
myStr = env->NewStringUTF(myNames[i]);
env->SetObjectArrayElement(dev,i,myStr);
}
return 0;
} 
```

# javascript - Knockout.js 使用拦截器扩展值绑定

> ID：12643455
> 
> 赞同：8
> 
> 时间：2012-09-28T16:02:30.547
> 
> 标签：javascript, knockout.js, knockout-2.0, knockout-validation

在绑定到输入字段时，这似乎是一种使用淘汰赛清理/验证/格式化数据的常用方法，它创建了一个可重用的自定义绑定，该绑定使用计算的 observable。它基本上扩展了默认值绑定以包含一个拦截器，该拦截器将在写入/读取之前格式化/清理/验证输入。

```
ko.bindingHandlers.amountValue = {
  init: function (element, valueAccessor, allBindingsAccessor) {
    var underlyingObservable = valueAccessor();

    var interceptor = ko.computed({
      read: function () {
        // this function does get called, but it's return value is not used as the value of the textbox.
        // the raw value from the underlyingObservable is still used, no dollar sign added. It seems like 
        // this read function is completely useless, and isn't used at all
        return "$" + underlyingObservable();
      },

      write: function (newValue) {
        var current = underlyingObservable(),
            valueToWrite = Math.round(parseFloat(newValue.replace("$", "")) * 100) / 100;

        if (valueToWrite !== current) {
          // for some reason, if a user enters 20.00000 for example, the value written to the observable
          // is 20, but the original value they entered (20.00000) is still shown in the text box.
          underlyingObservable(valueToWrite);
        } else {
          if (newValue !== current.toString())
            underlyingObservable.valueHasMutated();
        }
      }
    });

    ko.bindingHandlers.value.init(element, function () { return interceptor }, allBindingsAccessor);
  },

  update: ko.bindingHandlers.value.update
}; 
```

jsFiddle 示例：http: [//jsfiddle.net/6wxb5/1/](http://jsfiddle.net/6wxb5/1/)

我错过了什么吗？我已经看到到处都在使用这种方法，但它似乎并没有完全奏效。读取功能似乎完全没用，因为它根本没有被使用..，在写入功能中，输入“23.0000”会将写入的值更改为 23，但文本框的值不会更新。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-28T20:55:06.167

问题来自`update`您的自定义绑定部分。这部分将根据原始模型值更新字段。因此，附加在 中的事件处理程序`init`将通过您的可写计算发送新值，但该字段的更新实际上发生在`update`.

一种选择是从您的`init`函数应用值绑定并跳过该`update`函数，例如：

```
ko.bindingHandlers.amountValue = {
  init: function (element, valueAccessor, allBindingsAccessor) {
    var underlyingObservable = valueAccessor();

    var interceptor = ko.computed({
      read: function () {
        // this function does get called, but it's return value is not used as the value of the textbox.
        // the raw value from the underlyingObservable, or the actual value the user entered is used instead, no   
        // dollar sign added. It seems like this read function is completely useless, and isn't used at all
        return "$" + underlyingObservable();
      },

      write: function (newValue) {
        var current = underlyingObservable(),
            valueToWrite = Math.round(parseFloat(newValue.replace("$", "")) * 100) / 100;

        if (valueToWrite !== current) {
          // for some reason, if a user enters 20.00000 for example, the value written to the observable
          // is 20, but the original value they entered (20.00000) is still shown in the text box.
          underlyingObservable(valueToWrite);
        } else {
          if (newValue !== current.toString())
            underlyingObservable.valueHasMutated();
        }
      }
    });

      ko.applyBindingsToNode(element, { value: interceptor });
  }
}; 
```

更新小提琴：http: [//jsfiddle.net/rniemeyer/Sr8Ev/](http://jsfiddle.net/rniemeyer/Sr8Ev/)

# python - 按一定顺序组合两个 Django 查询

> ID：12643460
> 
> 赞同：0
> 
> 时间：2012-09-28T16:03:01.397
> 
> 标签：python, django, append

在我看来，我有两个 django 查询。它们如下：

```
news = News.objects.all()[:8]
posts = Post.objects.all()[:3] 
```

我需要按以下顺序将这两个查询组合在一起：

```
[news, post, news, news, news, post, news, post, news, news, news] 
```

我很确定我将不得不使用`lambda`或做某种`count`，但在这一点上我有点迷茫。我应该只使用`count`and`append`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:18:47.460

不。

```
def selector(seqs, picks):
  iters = [iter(x) for x in seqs]
  for choice in picks:
    yield next(iters[choice])

print list(selector((news, post), (0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0))) 
```

# android - 将应用程序包含在 ROM 中作为系统应用程序

> ID：12643465
> 
> 赞同：4
> 
> 时间：2012-09-28T16:03:18.747
> 
> 标签：android, android-source

我想从源代码构建一个 rom 并将我的应用程序包含为系统应用程序。我试过的：

1.将我的项目复制到`$SOURCE_DIR/packages/apps/`

2.在我的项目的根文件夹中添加Android.mk：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_STATIC_JAVA_LIBRARIES := android-common
LOCAL_SRC_FILES := $(call all-java-files-under, src)
LOCAL_PACKAGE_NAME := packagename
LOCAL_CERTIFICATE := platform
include $(BUILD_PACKAGE)
include $(call all-makefiles-under,$(LOCAL_PATH)) 
```

3\. 为 maguro 配置构建和：

```
make -j1 otapackage 
```

但是我在输出图像的`/system/app`目录中看不到我的应用程序。

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T20:48:23.923

我在您的 mk 文件中没有看到以下行：

```
LOCAL_MODULE_TAGS := optional 
```

而且我猜您刚刚忘记将您的包`build/target/product/core.mk`包含在该部分下的文件中`PRODUCT_PACKAGES`

# visual-studio - 使调试器跳过包装类中的代码

> ID：12643468
> 
> 赞同：1
> 
> 时间：2012-09-28T16:03:24.927
> 
> 标签：visual-studio, debugging, visual-studio-2012, visual-studio-debugging

如果函数 Foo() 调用调用函数 Baz() 的函数 Bar()，是否有一个属性或我可以添加到 Bar() 以指示调试器忽略 Bar() 中的代码并直接进入 Baz 中的代码() 而不进入 Qux() 中的代码？

```
void Foo(){ 
  Bar(); // If start debugging here...
}

void Bar(){ // I want to skip this function completely...
  Qux();
  Baz();
}

void Baz(){ // And step to here.
  Zab();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:04:38.183

您可以使用[DebuggerStepThroughAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerstepthroughattribute.aspx)来执行此操作。

```
[DebuggerStepThrough]
void Bar()
{ // I want to skip this function completely...
  Qux();
  Baz();
} 
```

# asp.net - 在 GridView 中使用分页保持排序

> ID：12643474
> 
> 赞同：3
> 
> 时间：2012-09-28T16:03:38.233
> 
> 标签：asp.net, vb.net, sorting, gridview, paging

我目前正在尝试编写代码，在更改 GridView 上的页面时保持排序首选项。我当前的代码可以很好地根据用户排序选择对数据进行排序。但是换页时，排序不起作用。我没有收到错误，而是未排序的结果。

这是我的aspx代码：

```
<asp:GridView ID="tblAdministrators" runat="server" AutoGenerateColumns="false" EmptyDataText="No records found" PageSize="75" AllowPaging="True" AllowSorting="True">

  <Columns>
    <asp:BoundField HeaderText="Name" InsertVisible="False" DataField="FULLNAME" SortExpression="FULLNAME"></asp:BoundField>
  </Columns>
  <Columns>
   <asp:BoundField HeaderText="Active" InsertVisible="False" DataField="ACTIVE" SortExpression="ACTIVE"></asp:BoundField>
  </Columns>

</asp:GridView> 
```

这是我的VB代码：

```
Public Class ViewUsers
Inherits SolutionBasePage

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    If Not Page.IsPostBack Then
        tblAdministrators.DataSource = GetData()
        tblAdministrators.DataBind()
    End If

End Sub

Private Const ASCENDING As String = " ASC"
Private Const DESCENDING As String = " DESC"

Private Function GetData() As Data.DataView

    Dim connection As OracleDBConnect = DAL.GetOracleDBConnection()
    Dim request As OracleDBRequest = Nothing
    Dim result As OracleDBResult = Nothing
    Dim trace As OracleDBChronoTrace = Nothing
    Dim status As DBStatus
    Dim sb As New StringBuilder
    Dim dv As DataView
    Dim ds As Data.DataSet = New Data.DataSet

    Try

        With sb
            .Append("SELECT FULLNAME, ACTIVE FROM USERS")
        End With

        request = New OracleDBRequest(sb.ToString, CommandType.Text)

        status = connection.Execute(request, result, trace)

        dv = New DataView(result.DataSet.Tables(0))

        If (ViewState("sortExp") IsNot Nothing) Then
            dv = New Data.DataView(result.DataSet.Tables(0))

            If (GridViewSortDirection = SortDirection.Ascending) Then
                GridViewSortDirection = SortDirection.Descending
                dv.Sort = CType(ViewState("sortExp") & DESCENDING, String)
            Else
                GridViewSortDirection = SortDirection.Ascending
                dv.Sort = CType(ViewState("sortExp") & ASCENDING, String)
            End If
        Else
            dv = result.DataSet.Tables(0).DefaultView
        End If

        Return dv

    Catch ex As Exception

    Finally
        'ds.Dispose()
        'dp.Dispose()
    End Try

End Function

Public Property GridViewSortDirection() As SortDirection
    Get
        If ViewState("sortDir") Is Nothing Then
            ViewState("sortDir") = SortDirection.Ascending
        End If

        Return CType(ViewState("sortDir"), SortDirection)
    End Get

    Set(ByVal value As SortDirection)
        ViewState("sortDir") = value
    End Set

End Property

Protected Sub tblAdministrators_PageIndexChanging(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewPageEventArgs) Handles tblAdministrators.PageIndexChanging

    tblAdministrators.PageIndex = e.NewPageIndex
    tblAdministrators.DataSource = GetData()
    tblAdministrators.DataBind()

End Sub

Protected Sub tblAdministrators_Sorting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewSortEventArgs) Handles tblAdministrators.Sorting

    ViewState("sortExp") = e.SortExpression
    tblAdministrators.DataSource = GetData()
    tblAdministrators.DataBind()

End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:42:48.930

问题是每当您调用 GetData() 函数时，您的代码都会更改数据视图的排序属性，即使它是由 PageIndexChaging 事件调用的。

```
If (GridViewSortDirection = SortDirection.Ascending) Then
    GridViewSortDirection = SortDirection.Descending
    dv.Sort = CType(ViewState("sortExp") & DESCENDING, String)
Else
    GridViewSortDirection = SortDirection.Ascending
    dv.Sort = CType(ViewState("sortExp") & ASCENDING, String)
End If 
```

您可以修改 GetData() 函数以接受 SortDirection。然后，在您的 tblAdministrators_PageIndexChanging 和 tblAdministrators_Sorting 事件中，只需传递 GridViewSortDirection。像这样的东西：

```
Private Function GetData(sort As SortDirection) As Data.DataView
' your code here...
End Function

Protected Sub tblAdministrators_PageIndexChanging(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewPageEventArgs) Handles tblAdministrators.PageIndexChanging
    tblAdministrators.PageIndex = e.NewPageIndex
    tblAdministrators.DataSource = GetData(GridViewSortDirection)
    tblAdministrators.DataBind()
End Sub

Protected Sub tblAdministrators_Sorting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewSortEventArgs) Handles tblAdministrators.Sorting
    ViewState("sortExp") = e.SortExpression
    GridViewSortDirection = If(GridViewSortDirection = SortDirection.Descending, SortDirection.Ascending, SortDirection.Descending)
    tblAdministrators.DataSource = GetData(GridViewSortDirection)
    tblAdministrators.DataBind()
End Sub 
```

# ssrs-2008 - SSRS 页脚未导出到 excel

> ID：12643477
> 
> 赞同：1
> 
> 时间：2012-09-28T16:03:49.707
> 
> 标签：ssrs-2008, reporting-services

> **可能重复：**
> [SSRS 报告页脚未导出到 excel](https://stackoverflow.com/questions/1062199/ssrs-report-footer-not-export-to-excel)

`="Report generatedBy: " & User!UserID.Substring(User!UserID.LastIndexOf("\")+1)`

我在 SSRS 2008 报告的报告页脚的文本框中有上述代码。我将所有数据和页眉导出到 Excel，但页脚没有导出。

我检查了打印预览，在那里我只能看到带有值`Report generatedBy:`但没有其他数据的标签。

我检查了预览模式，我可以正确地看到**生成的报告**及其值。

谁能指出我正确的方向？

# vba - 高效的数据透视/数据比较

> ID：12643478
> 
> 赞同：1
> 
> 时间：2012-09-28T16:03:56.887
> 
> 标签：vba, excel

我对 VBA 很陌生，但是我有编程背景。我正在编写 VBA 来打开两个 Excel 工作簿，复制数据透视表并将特殊值粘贴到临时工作簿中。从那里，我需要比较数据透视数据并输出差异。但是，我不确定从那里去哪里。

**样本数据**

枢轴 1

```
水果之和 YearMon
类别组 201205 201206 201207 201208 201209 ... 201401
苹果绿 1.3 2.1 3.0 ...
               红色 1.0 1.5 2.0 ...
苹果总数.. .. .. ...
浆果吸管 1 1 1.1 2.0 2.1 ...
               黑色 1 1 1.0 0.9 0.9 ...
贝罗斯总计 .. .. .. ...

```

支点 2

```
水果之和 YearMon
类别组 201206 201207 201208 201209 201210 ... 201402
苹果绿 1.5 2.3 3.2 ...
               红色 0.8 1.3 1.9 ...
               黄色 1 0.9 0.9 1 ...
苹果总数.. .. .. ...
浆果吸管 1 1 1.3 1.8 2.1 ...
               黑色 1 1 0.9 0.8 0.8 ...
贝罗斯总计 .. .. .. ...

```

期望的结果*（枢轴 2 - 枢轴 1）*

```
水果之和 YearMon
类别组 201205 201206 201207 201208 201209 201210 ... 201402
苹果绿 -0.6 -0.7 ...
               红色 -0.7 -0.7 ...
苹果总数.. .. .. ...
浆果吸管 0 -0.1 -0.7 -0.3 ...
               黑色 0 0 0 -0.1 ...
浆果总数 .. .. .. ...

```

我的第一个冲动是基于 each放入`YearMon`和放入数组，然后循环遍历它们以删除两个枢轴中都不存在的属性（即，黄色苹果在枢轴 1 中不存在，并且没有数据）。然后我会遍历每个组并进行计算。这听起来太乱了。`Group``Category``201402`

我目前正在考虑为`YearMon`and创建一个范围`Group`，然后垂直和水平地循环遍历该范围，`Category`以比较每个值。我不确定如何准确地找到每个`Category`停止的位置，或者我是否可以使用`VLOOKUP`？还是有一些更简单的方法来比较两个枢轴？

**更新 1**

大多数评论建议我尝试使用数据透视背后的源数据来完成这项任务。我能够获取数据并遵循上面的方案，如下所示：

数据 1

```
类别组 YearMon 值
苹果绿 201207 1.3
苹果绿 201208 2.1
苹果绿 201209 3.0
苹果红 201207 1.0
苹果红201208 1.5
苹果红201209 2.0
浆果吸管 201205 1.0
浆果吸管 201206 1.0
浆果吸管 201207 1.1
浆果吸管 201208 2.0
浆果吸管 201209 2.1
浆果黑 201205 1.0
浆果黑 201206 1.0
浆果黑 201207 1.0
浆果黑 201208 0.9
浆果黑 201209 0.9

```

数据 2

```
类别组 YearMon 值
苹果绿 201208 1.5
苹果绿 201209 2.3
苹果绿 201210 3.2
苹果红 201208 0.8
苹果红201209 1.3
苹果红201210 1.9
苹果黄 201207 1.0
苹果黄 201208 0.9
苹果黄 201209 0.9
苹果黄 201210 1.0
浆果吸管 201206 1.0
浆果吸管 201207 1.0
浆果吸管 201208 1.3
浆果吸管 201209 1.8
浆果吸管 201210 2.1
浆果黑 201206 1.0
浆果黑 201207 1.0
浆果黑 201208 0.9
浆果黑 201209 0.8
浆果黑 201210 0.8

```

按照下面的建议尝试后`SUMIFS`，我似乎需要为每个数据集指定每个标准（类别、组、YearMon）来进行比较。也许还有其他一些可以工作的功能？

**更新 2**

另一个建议是结合数据集来计算与枢轴的差异。在组合这两个数据集之后，我似乎无法找到一种方法来进行差异计算，而不包括另一个标识每个数据集（1 或 2）的列。从那里我可以进行比较。我做错了什么吗？

**更新 3**

按照下面的答案，我只是简单地否定了第二个数据集的值以获得差异。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:09:51.097

这可能会帮助您：

```
=INDEX($B$11:$H$14,MATCH($A18,$A$11:$A$14,0),MATCH(B$17,$B$10:$H$10,0))-(INDEX($B$3:$H$7,MATCH($A18,$A$3:$A$7,0),MATCH(B$17,$B$2:$H$2,0))) 
```

我认为没有任何内置函数可以组合数据透视表。所以一般来说，这个问题似乎并不特定于数据透视表——而只是如何组合/减去/添加两个单独的数据表。

![减去两个表](../Images/e73f1f07275a377b296ff029c1f9eb2a.png)

不确定您是否正在寻找 VBA 解决方案，但这是使用（非常冗长）电子表格公式的一种方法。您也可以使用 Scott 提到的 SUMIF 公式，或者只使用原始数据。祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T23:05:14.823

为了证明我的建议。取您的数据 1，将所有金额乘以 -1，然后将数据 2 添加到其中，为您提供：

![组合数据](../Images/0835e20f7dcf819eee6e47917d611f72.png)

根据该组合数据制作数据透视表可为您提供：

![新数据透视表](../Images/e778f1a0420ad89731631dd72c5e6424.png)

对于您想要的任何行/列组合，数据透视表 SUM 都会为您带来不同。诀窍是将一个数据集乘以-1

*技巧：在新单元格中键入 -1，在该单元格上按 Ctrl-C，然后选择数据 1 组中的所有值，然后执行选择性粘贴并选择“相乘”*

# c - 如何测试 strdup() 是否可用？

> ID：12643487
> 
> 赞同：1
> 
> 时间：2012-09-28T16:04:30.437
> 
> 标签：c, gcc, posix

我正在使用这个：

```
#if !defined(_SVID_SOURCE) || !defined(_BSD_SOURCE) || _XOPEN_SOURCE < 500 || !(_XOPEN_SOURCE && _XOPEN_SOURCE_EXTENDED) \
|| _POSIX_C_SOURCE < 200809L
char * strdup(const char *s)
{
  char *buffer = malloc(strlen(s) + 1);

  if(buffer != NULL)
    strcpy(buffer, s);

  return buffer;
}
#endif 
```

但是是否有可能出现重新声明错误？也许进入一些 gcc 版本或类似 gcc 的编译器？例如，我想让它与没有`strdup()`,的版本（标准）兼容`-ansi`。

另外，我怎样才能使它更便携？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T18:12:29.543

这绝对是功能测试宏的错误使用。实现没有定义功能测试宏来告诉应用程序什么是可用的；它们由应用程序定义，以要求实现提供对特定标准（特定版本）的一致性。

您应该用来测试实现支持的宏在`unistd.h`：

*   `_POSIX_VERSION`- 支持的 POSIX 版本。`200809L`是最新的。
*   `_XOPEN_VERSION`- X/Open Portability Guide 的版本，现在称为 POSIX 的“XSI”选项。最新的是`700`（来自SUSv4）。`600`(SUSv3) 很常见。`500`（SUSv2）严重过时。
*   `_POSIX_THREADS`- pthreads 的版本（应该与 相同`_POSIX_VERSION`；自 POSIX 2008 起强制）
*   ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:32:51.313

Looking in the `string.h` on my platform (linux, gnu libc 2.16) I found :

```
#if defined __USE_SVID || defined __USE_BSD || defined __USE_XOPEN_EXTENDED \
    || defined __USE_XOPEN2K8
/* Duplicate S, returning an identical malloc'd string.  */
extern char *strdup (const char *__s)
     __THROW __attribute_malloc__ __nonnull ((1));
#endif 
```

The `#if`s are slightly different, I don't know the influence between those I found in my header and the ones your are using.
About the second question, you could use the [autotools](http://www.gnu.org/software/autoconf/) to create a `config.h` header describing the capabilities of the compiling platform, and use your own versions of missing functions.
In addition you could also use the [gnulib](http://www.gnu.org/software/gnulib/) "source library" which provides implementation of defective or missing functions (like [`strdup`](http://www.gnu.org/software/gnulib/manual/html_node/strdup.html))
Using autotools should prevent any redeclaration error.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:09:26.700

是的，如果它已经定义，您将在 strdup 上重新声明。我知道解决此类问题的唯一方法是将 strdup 宏定义为其他内容（例如 _strdup），然后使用其他名称定义 strdup。这有点难看，但它完成了工作。

对于您的第一个问题，不，您无法确定预处理器是否存在函数。看到这个[帖子](https://stackoverflow.com/questions/1749233/check-whether-function-is-declared-with-c-preprocessor)。

# c++ - 在 OpenGL 中创建和混合动态纹理

> ID：12643488
> 
> 赞同：2
> 
> 时间：2012-09-28T16:04:31.733
> 
> 标签：c++, opengl, shader, alphablending, render-to-texture

我需要将球体渲染到纹理（使用帧缓冲区对象（FBO）完成），然后将该纹理与后台缓冲区进行 alpha 混合。到目前为止，除了在每一帧开始时清除它之外，我还没有对纹理进行任何处理。

我应该说我的场景只包含一个空旷空间中的行星，球体应该出现在行星旁边或周围（现在有点像月亮）。当我将球体直接渲染到后台缓冲区时，它会正确显示；但是当我执行将其渲染为纹理然后将该纹理与后台缓冲区混合的中间步骤时，球体仅在它位于行星前面时才会显示，不在前面的部分只是“切断” “：

![被行星边缘切断的球体](../Images/68cd4a8d554b87383a2ab29afa19eb01.png)

我使用`glutSolidSphere`绑定到 FBO 的 RGBA8 全屏纹理渲染球体，确保每个球体像素接收 1.0 的 alpha 值。然后，我将纹理传递给片段着色器程序，并使用此代码在 alpha 混合时将全屏四边形（纹理映射到其上）渲染到后缓冲区：

```
glBindFramebuffer(GL_FRAMEBUFFER, 0);
glBlendFunc(GL_SRC_ALPHA,GL_ONE_MINUS_SRC_ALPHA);
glEnable(GL_BLEND);

glDisable(GL_DEPTH_TEST);
glMatrixMode(GL_MODELVIEW);
glPushMatrix();
glLoadIdentity();
glMatrixMode(GL_PROJECTION);
glPushMatrix();
glLoadIdentity();
glBegin(GL_QUADS);
glTexCoord2i(0, 1);
glVertex3i(-1,  1, -1);   // TOP LEFT
glTexCoord2i(0, 0);
glVertex3i(-1, -1, -1);   // BOTTOM LEFT
glTexCoord2i(1, 0);   
glVertex3i( 1, -1, -1);   // BOTTOM RIGHT
glTexCoord2i(1, 1);   
glVertex3i( 1,  1, -1);   // TOP RIGHT
glEnd();
glPopMatrix();
glMatrixMode(GL_MODELVIEW);
glPopMatrix();
glEnable(GL_DEPTH_TEST);

glDisable(GL_BLEND); 
```

这是着色器代码（取自用 Cg 编写的 FX 文件）：

```
sampler2D BlitSamp = sampler_state
{
    MinFilter = LINEAR;
    MagFilter = LINEAR;
    MipFilter = LINEAR;
    AddressU = Clamp;
    AddressV = Clamp;
};

float4 blendPS(float2 texcoords : TEXCOORD0) : COLOR
{
    float4 outColor = tex2D(BlitSamp, texcoords);
    return outColor;
} 
```

我什至不知道这是深度缓冲区的问题还是 alpha 混合的问题，我尝试了很多启用和禁用深度测试（将深度缓冲区附加到 FBO）和 alpha 混合的组合。

编辑：我尝试将一个空白的全屏四边形直接渲染到后台缓冲区，甚至在地球边缘裁剪。出于某种原因，*启用*渲染四边形的深度测试（即删除线`glDisable(GL_DEPTH_TEST)`和`glEnable(GL_DEPTH_TEST) in the code above`）解决了这个问题，但是现在除了行星和球体之外的所有东西都显示为白色：

![白色不正确的白色背景的球体](../Images/dd61f6ea8ecc8f50d24c3dd0dbbf50d6.png)

我确保（并且可以确认）纹理的 alpha 通道在每个像素上都是 0，但球体除外，​​所以我不明白可以在哪里引入白度。（也仍然有兴趣解释为什么启用深度测试会产生这种效果。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T16:14:58.807

我在这里看到两个可能的错误来源：

## 1\. 渲染到 FBO

如果丢失的像素在渲染后甚至不存在于 FBO 中，则必须有某种机制丢弃相应的片段。OpenGL 管道包括四种不同类型的片段测试，这些测试可能导致片段被丢弃：

1.  **剪刀测试**：不太可能是原因，因为剪刀测试只影响屏幕的矩形部分。
2.  **Alpha 测试**：同样不可能，因为您的片段都应该具有相同的 alpha 值。
3.  **模板测试**：也不太可能，除非您在绘制背景行星时使用模板操作并将模板缓冲区从后台缓冲区复制到 FBO。
4.  **深度测试**：与模板测试相同。

所以很有可能渲染到 FBO 不是这里的问题。但为了绝对确定，您应该读回您的颜色附件纹理并将其转储到文件中以供检查。您可以为此使用以下功能：

```
void TextureToFile(GLuint texture, const char* filename) {
  glBindTexture(GL_TEXTURE_2D, texture);
  GLint width, height;
  glGetTexLevelParameteriv(GL_TEXTURE_2D, 0, GL_TEXTURE_WIDTH, &width);
  glGetTexLevelParameteriv(GL_TEXTURE_2D, 0, GL_TEXTURE_HEIGHT, &height);

  std::vector<GLubyte> pixels(3 * width * height);
  glGetTexImage(GL_TEXTURE_2D, 0, GL_RGB, GL_UNSIGNED_BYTE, &pixels[0]);

  std::ofstream out(filename, std::ios::out | std::ios::binary);
  out << "P6\n"
      << width << '\n'
      << height << '\n'
      << 255 << '\n';
  out.write(reinterpret_cast<const char*>(&pixels[0]), pixels.size());  
} 
```

生成的文件是一个[可移植的像素图](http://en.wikipedia.org/wiki/Netpbm_format)(.ppm)。在读回纹理之前，请务必取消绑定 FBO。

## 2.纹理映射

假设渲染到 FBO 中按预期工作，唯一的其他错误来源是在先前渲染的场景上混合纹理。有两种情况：

### a) 碎片被丢弃

碎片被丢弃的可能原因与1中相同：

1.  **剪刀测试**：不，仅影响矩形区域。
2.  **Alpha 测试**：可能不是，被纹素覆盖的球体应该都具有相同的 alpha 值。
3.  **模板测试**：如果您在绘制背景行星时使用模板操作/模板测试并且旧的模板状态仍处于活动状态，则可能是原因。
4.  **深度测试**：可能是原因，但由于您已经禁用它，它确实不应该有任何影响。

所以你应该确保所有这些测试都被禁用，尤其是模板测试。

### b) 混合的错误结果

假设所有片段都到达后台缓冲区，混合是唯一仍然可能导致错误结果的事情。使用您的混合功能`(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA)`，后台缓冲区中的值与混合无关，我们假设纹理中的 alpha 值是正确的。所以我看不出为什么混合应该是这里的根本原因。

## 结论

总之，观察结果的唯一合理原因似乎是模板测试。如果不是，我没有选择:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:31:24.580

我解决了它，或者至少想出了一个解决方法。

首先，白色源于`glClearColor`已设置为的事实`glClearColor(1.0f, 1.0f, 1.0f, 1000.0f)`，因此除了行星之外的所有内容最终都没有被写入。*我现在在渲染球体之前将后台缓冲区的内容（即行星、大气及其周围的空间）复制到纹理中，并在复制/blit 操作之前*渲染大气和空间，因此它们被包括在内在里面。以前，除了行星本身之外的所有东西都是在我的四边形之后渲染的，当使用深度测试时，它显然将所有东西放在了四边形后面，使其不可见。

我试图实现的效果的参考实现在其代码中一直使用这种 blit 操作，但我认为效果没有必要。现在我觉得可能没有别的办法了...

# powershell - 测试是否使用 PowerShell 共享目录？

> ID：12643496
> 
> 赞同：0
> 
> 时间：2012-09-28T16:05:19.993
> 
> 标签：powershell, wmi, powershell-2.0, wmi-query

这似乎是一件很容易做到的事情；但是，我对 WMI 一无所知。我将如何确定一个目录是否在我的一台服务器上通过网络共享（使用 PowerShell）？另外，是否有我可以阅读以熟悉 WMI 的快速入门书？我真的希望能够在编写脚本时使用它，但是大多数资源都没有显示任何使用 PowerShell 的示例。

目前，我正在检查“服务器”服务是否正在运行；另一个检查特定组是否对该目录具有权限。

```
 $serversrvc = Get-Service -Name "Server"
    $dirpath = "C:\My\Path\"
    $pathacl = (Get-Acl -path $dirpath).Access
    $group = "Domain\User"

    # Test if the "Server" service is running
    If ($serversrvc.Status -eq "Running")
    {
        echo '"Server" service is running.'
    }
    Else
    {
        echo '"Server" is NOT running.'
    }

    # Test if the $dirpath exists
    If (Test-Path $dirpath)
    {
        echo "$dirpath exists."
    }
    Else
    {
        echo "$dirpath does not exist."
    }

    # Test if $group has permssions on $dirpath
    foreach ($id in $pathacl)
    {
        If ($id.IdentityReference -eq $group)
        {
            echo "$group has access to $dirpath"
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T16:15:57.320

Win32_Share WMI 类返回计算机上共享文件夹的所有实例。这将为您提供本地计算机上的所有共享文件夹：

```
Get-WmiObject -Class Win32_Share 
```

请注意 Path 属性，您可以使用 Filter 参数（相当于 WQL WHERE 子句）来获取具有特定本地路径的共享，但您还需要将每个斜杠加倍（斜杠是：

```
Get-WmiObject -Class Win32_Share -ComputerName PC1 -Filter "Path='C:\\Windows'" 
```

如果您返回结果，则该文件夹是共享的，否则不是。注意 ComputerName 参数，您可以对远程计算机执行 wmi 命令。

要返回布尔结果，如果文件夹是共享的，则为 true，否则为 false，将命令强制转换为 bool：

```
 [bool](Get-WmiObject -Class Win32_Share -ComputerName PC1 -Filter "Path='C:\\Windows'") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:14:22.743

您可以使用`Get-WmiObject Win32_Share`枚举计算机上的共享。你也可以使用`net share`，但是你必须解析输出，当你有 WMI 输出时，为什么还要为此烦恼。:-)

# jquery - colorbox jquery slideshowstart img而不是文本

> ID：12643498
> 
> 赞同：1
> 
> 时间：2012-09-28T16:05:30.290
> 
> 标签：jquery, colorbox

对于幻灯片，我想使用代表暂停（“||”（和播放（“>”））而不是文本的图标（.png）。我有以下工作（暂停文本实际上看起来相当不错）：

```
$.colorbox.settings.slideshowStart = ">>";
$.colorbox.settings.slideshowStop = "||"; 
```

使用下面的示例：

```
 $.colorbox({slideshowStop: function(){ var url = $(this).attr('href'); return '<a href="' + url + '" target="_blank">Open In New Window</a>'; 
```

我尝试返回“img src="grafix/btn_pause.png" alt="" /' 括在尖括号中，还尝试了“url(grafix/btn_pause)”。如果我不把它放在引号中，cbox 不会发射；但是当我用引号引起来时，我得到的是文本字符串而不是图形。我在 .js 文件中看到 .text，所以我认为只允许使用文本。我知道 html 和 css，但不知道 js。

有没有办法做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:13:09.987

通过在 CSS 中定位按钮来更改按钮会更简单 - 颜色框通常带有样式表，您可以自定义以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:06:39.137

您可以用 HTML 替换当前文本：

`$.colorbox.settings.slideshowStart = "<img src='start.png'/>";`

但是，我的选择与肖恩建议有关。

# delphi - 用于设置默认调用约定的编译器选项？

> ID：12643502
> 
> 赞同：0
> 
> 时间：2012-09-28T16:05:35.267
> 
> 标签：delphi, freepascal, calling-convention

我记得在 Turbo Pascal 或早期的 Delphi 版本中，有一些选项可以使函数调用约定默认不注册，而是任何其他类型。

也许我把它误认为是 {$W+} 或 {$STACKFRAMES ON} 选项，这也会影响函数序言和结尾。

我不想使用帕斯卡预处理器，但如果我可以更改某些单元的默认约定，它可能对我有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T09:13:21.227

Free Pascal 有 $calling 指令：

[http://www.freepascal.org/docs-html/prog/progsu7.html#x13-120001.1.7](http://www.freepascal.org/docs-html/prog/progsu7.html#x13-120001.1.7)

它通常用于修复具有汇编程序例程的旧单元，并假设它们内置了调用约定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:14:53.223

这是不可能的。编译器选项不能修改默认调用约定。

# c# - 如何在其他应用程序中使用新的类方法？

> ID：12643505
> 
> 赞同：1
> 
> 时间：2012-09-28T16:05:40.093
> 
> 标签：c#

我在 C++ 中使用此代码在我的其他应用程序中使用一个类（我之前定义的）。

```
#include class_name ; 
```

如何定义可以在所有应用程序中使用的公共类？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:07:23.470

要从外部程序集访问类，您必须[添加对](http://msdn.microsoft.com/en-us/library/wkze6zky%28v=vs.110%29.aspx)外部程序集的引用。`public`这将允许您从外部程序集中访问类。

要从当前范围之外指定 a `class`，`namespace`您必须在类的类型说明符前面加上其`namespace`名称。为了避免这种开销，您可以`namespace`使用[`using`指令](http://msdn.microsoft.com/en-us/library/sf0df423%28v=vs.110%29.aspx)“包含”外部。

一个程序集中可以存在多个命名空间。

* * *

**组装果实：**

```
namespace Common
{
    public class Strange
    {
       var mystery = new Mystery() // Won't compile, no reference to Mystery.
    }
}

namespace Fruit
{
    public class Orange
    {
    }
} 
```

**组装蔬菜：**

*参考水果*

```
namespace Common
{
    public class Mystery
    {
    }
}

namespace Fungi
{
    public class Mushroom
    {
    }
}

namespace Vegetables
{
    using Common;

    public Class Carrot
    {
        var strange = new Strange() // Compiles correctly.
        var mystery = new Mystery() // Compiles correctly.
        var orange = new Orange() // Won't compile, what's an Orange?
        var orange = new Fruit.Orange() // Compiles correctly.
        var mushroom = new Mushroom() // Won't compile, what's a Mushroom?
        var mushroom = new Fungi.Mushroom() // Compiles correctly.
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T16:06:40.180

您需要创建一个类库项目，该项目可编译为 DLL 文件。

然后，您可以在其他项目中添加对它的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:22:31.140

每个类都在命名空间下创建

```
namespace abc{

public MyClass{
//functionality
}

} 
```

要在不同的应用程序上使用您的类，您需要导入命名空间。

```
using abc;

public class usingClass{

MyClass obj = new MyClass();

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:07:19.083

您必须包括如下命名空间，并且如果在另一个项目中还添加任何引用。

```
using class_namespace; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T16:16:42.157

如果另一个类是`public`或`internal`（如果它们是内部的，则在同一个程序集中），在同一个项目中，并且具有相同的命名空间，那么您根本不需要做任何事情。您将能够通过使用它的类名来引用另一个类。

如果它们在不同的命名空间中，那么您可以使用`using`语句（在文件顶部）将另一个命名空间带入范围，或者您可以在`OuterNamespace.InnerNamespace.ClassName`每次使用该类时使用完全限定名称（即）引用另一个类. （几乎没有人这样做，每个人都只使用`using`语句，因为它们更方便。）

如果该类完全在另一个项目中，那么您将需要通过 Visual Studio 添加对该类的引用。如果您正在创建一个旨在被其他项目引用的项目，那么它的项目类型应该是“类库”。

# google-app-engine - Amazon EC2 或 Google App Engine - 视频上传、转换和服务

> ID：12643506
> 
> 赞同：1
> 
> 时间：2012-09-28T16:05:41.087
> 
> 标签：google-app-engine, amazon-ec2, google-cloud-storage

我正在开始一个新项目，主要涉及以下内容：

*   上传大量视频
*   转换它们
*   为用户提供服务

我正在研究 Google App Engine 并使用新的[Google Cloud Storage API](https://developers.google.com/storage/)来存储视频。

但是 Google Can 存储 API 仍处于[Google App Engine 的实验阶段，](https://developers.google.com/appengine/docs/java/googlestorage/)这有点吓人。

但我想知道亚马逊的 EC2 是否不是更好的选择，因为它更成熟，可能更适合我正在尝试构建的那种服务。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T17:22:27.633

第一选择都不是。

视频转码是相当 CPU 密集型的。您需要使用优化的转码器，该转码器可以利用较新的 CPU 或 GPU 上的转码功能。EC2 或 GAE 都不会让您这样做，因为它们不会透露您正在运行的硬件。您可能会考虑使用基于云的转码服务，而不是自己动手。

在这种情况下，您主要是存储和服务。亚马逊的存储和带宽更便宜。

鉴于我假设您不是转码专家的问题。您不会编写自己的 Go 转码器，因此在这种情况下，亚马逊将是您运行某些开源转码器的唯一选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T09:46:17.420

从记忆中，这是今年 Google IO 的确切演示，使用 App Engine 结合[Google Compute Engine](https://cloud.google.com/products/compute-engine)进行上传 + 转码 + 其他好东西。

[例如，这是](https://www.brightcove.com/en/blog/2012/07/first-look-at-google-compute-engine-for-video-transcoding)一个包含一些详细信息的 blob 帖子。

[这是](http://www.youtube.com/watch?v=ws2VRHq5ars)I/O 的演示之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T15:32:56.967

Amazon Web Services 最近发布了一项名为[Amazon Elastic Transcoder](http://aws.amazon.com/elastictranscoder "亚马逊弹性转码器")的新 Web 服务。

# php - 包含许多部分的大型脚本......我该如何优化它？

> ID：12643507
> 
> 赞同：0
> 
> 时间：2012-09-28T16:05:45.063
> 
> 标签：php

我有一个脚本，它从一个表中获取信息，确定它是否需要为另一个表创建条目（避免重复），然后将信息插入到 pages 表中。问题是，以当前编码的方式查询大约 10,000 个条目会导致性能问题。

我可以通过什么方式对其进行优化以使其运行得更高效、更快？从代码中可以看出，这有很多部分。

```
$eventquery = mysql_query("SELECT * FROM maintable WHERE PCatID != '3' AND PCatID != '4'");
while($event = mysql_fetch_array($eventquery))
{
$querystring = null;
$performer_id = array();
$hasharray = array();
$venue = preg_replace("/ \([fF]ormerly (.+?)\)/", '', $event['Venue']);

$perfquery = mysql_query("SELECT * FROM maintable WHERE EventID = '".$event['EventID']."'");   
while($perf = mysql_fetch_array($perfquery))
    {
        $performer_id[$perf['PerformerID']] = $perf['Performer'];
        $hasharray[] = $perf['id'];
    }

$eventtime = getEventTime($event['DateTime']);
$performer_id = serialize($performer_id);
$hasharray = serialize($hasharray);

if($event['PCatID'] == "2" && $event['CCatID'] != "24")
{
    $request = "buy-".strCleanupForPage($event['Event'])."-concert-tickets/".strCleanupForPage($event['City'])."-".
        strCleanupForPage(stateabb($event['State']))."-".strCleanupForPage($venue)."-".$eventtime['date'];

    $catnum = "202";

    $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray, mainpage) VALUES 
        ('".$request."','".$catnum."','".addslashes($event['Event'])."','".addslashes($performer_id)."',
            '".$event['EventID']."','".$hasharray."','n')";

}
elseif($event['GCatID'] == "32" || $event['GCatID'] == "16" || $event['GCatID'] == "30" || $event['GCatID'] == "19" ||
         $event['GCatID'] == "31" || $event['GCatID'] == "22")
{ 
    if($event['GCatID'] == "32")
        {$catnum = "102";}
    elseif($event['GCatID'] == "16")
        {$catnum = "101";}
    elseif($event['GCatID'] == "30")
        {$catnum = "103";}
    elseif($event['GCatID'] == "19")
        {$catnum = "104";}
    elseif($event['GCatID'] == "31")
        {$catnum = "109";}
    elseif($event['GCatID'] == "22")
        {$catnum = "108";}
    elseif($event['GCatID'] == "17")
        {
            if($event['CCatID'] == "66")
                {$catnum = "106";}
            elseif($event['CCatID'] == "65")
                {$catnum = "105";}
        }

    if(strstr($event['Event']," vs. "))
        {
            $game = true;
            $teams = explode(" vs. ",$event['Event']);
        }
    elseif(strstr($event['Event']," Vs. "))
        {
            $game = true;
            $teams = explode(" Vs. ",$event['Event']);
        }
    else
        {
            $game = false;            
        }

    if($game)
        {           

            $catnum .= "2";
            $homequery = mysql_query("SELECT * FROM sportsteams WHERE fullname LIKE '".$teams[0]."'");  
            $home = mysql_fetch_array($homequery);  
            $awayquery = mysql_query("SELECT * FROM sportsteams WHERE fullname LIKE '".$teams[1]."'");  
            $away = mysql_fetch_array($awayquery);

            if((mysql_num_rows($homequery)) == 0 || (mysql_num_rows($awayquery)) == 0)
            {
                if($catnum == "1012")
                    {$request = "mlb-baseball-tickets";}
                elseif($catnum == "1022")
                    {$request = "nfl-football-tickets";}
                elseif($catnum == "1032")
                    {$request = "nba-basketball-tickets";}
                elseif($catnum == "1042")
                    {$request = "nhl-hockey-tickets";}
                elseif($catnum == "1052")
                    {$request = "ncaa-football-tickets";}
                elseif($catnum == "1062")
                    {$request = "ncaa-basketball-tickets";}
                elseif($catnum == "1082")
                    {$request = "mls-soccer-tickets";}
                elseif($catnum == "1092")
                    {$request = "wnba-basketball-tickets";}
                $eventname = preg_replace("/\([iI]ncludes (.+?)\)/", '', $event['Event']);
                $request .= "/".strCleanupForPage($eventname)."-".strCleanupForPage($event['City'])."-".
                     strCleanupForPage(stateabb($event['State']));
                }
            else
                {
                    $request = strCleanupForPage($home['fullname'])."-tickets-".strCleanupForPage($venue)."/".strCleanupForPage($home['nickname'])."-vs-".strCleanupForPage($away['nickname'])."-".strCleanupForPage($event['City'])."-".
                    strCleanupForPage(stateabb($event['State']))."-".$eventtime['date'];
                    $request = str_replace("-/","/",$request);
                }

        $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray, mainpage) VALUES 
        ('".$request."','".$catnum."','".addslashes($event['Event'])."','".addslashes($performer_id)."',
            '".$event['EventID']."','".$hasharray."','n')";
    }
    else
    {   
        $catnum .= "3";
        if($catnum == "1013")
            {$request = "mlb-baseball";}
        elseif($catnum == "1023")
            {$request = "nfl-football";}
        elseif($catnum == "1033")
            {$request = "nba-basketball";}
        elseif($catnum == "1043")
            {$request = "nhl-hockey";}
        elseif($catnum == "1053")
            {$request = "ncaa-football";}
        elseif($catnum == "1063")
            {$request = "ncaa-basketball";}
        elseif($catnum == "1083")
            {$request = "mls-soccer";}
        elseif($catnum == "1093")
            {$request = "wnba-basketball";}

        $eventname = preg_replace("/\([iI]ncludes (.+?)\)/", '', $event['Event']);
        $request .= "/".strCleanupForPage($eventname)."-".strCleanupForPage($event['City'])."-".
        strCleanupForPage(stateabb($event['State']));

        $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray, mainpage) VALUES 
        ('".$request."','".$catnum."','".addslashes($event['Event'])."','".addslashes($performer_id)."',
            '".$event['EventID']."','".$hasharray."','n')";
    }
}
elseif($event['CCatID'] == "50")
{
    $request = "boxing-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
    $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray) VALUES
        ('".$request."','1142','".addslashes($event['Event'])."','".addslashes($performer_id)."','".$event['EventID']."',
            '".$hasharray."')";
}    
elseif($event['CCatID'] == "67")
{
    $request = "golf-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
    $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray) VALUES
        ('".$request."','1112','".addslashes($event['Event'])."','".addslashes($performer_id)."','".$event['EventID']."',
            '".$hasharray."')";
}    
elseif($event['CCatID'] == "27")
{
    $request = "tennis-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
    $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray) VALUES
        ('".$request."','1102','".addslashes($event['Event'])."','".addslashes($performer_id)."','".$event['EventID']."',
            '".$hasharray."')";
}    
elseif($event['CCatID'] == "101")
{
    $request = "ufc-mma-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
    $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray) VALUES
        ('".$request."','1152','".addslashes($event['Event'])."','".addslashes($performer_id)."','".$event['EventID']."',
            '".$hasharray."')";
}    
elseif($event['CCatID'] == "69")
{
    if(strstr($event['Event'],"NASCAR"))
    {                    
        $request = "nascar-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
        $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray) VALUES
            ('".$request."','1122','".addslashes($event['Event'])."','".addslashes($performer_id)."','".$event['EventID']."',
            '".$hasharray."')";
    }
    elseif($event['GCatID'] == "35")
    {
        $request = "horse-racing-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
        $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray) VALUES
            ('".$request."','1132','".addslashes($event['Event'])."','".addslashes($performer_id)."','".$event['EventID']."',
            '".$hasharray."')";
    }
}
elseif($event['GCatID'] == "26")
{
    $request = "wwe-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
    $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray) VALUES
        ('".$request."','1162','".addslashes($event['Event'])."','".addslashes($performer_id)."','".$event['EventID']."',
            '".$hasharray."')";
}
elseif($event['CCatID'] == "24")
{   
    $catnum = "402";
    $request = strCleanupForPage($event['Event'])."-comedy-tickets/".strCleanupForPage($event['City'])."-".strCleanupForPage(stateabb($event['State'])).
        "-".strCleanupForPage($event['Venue'])."-".$eventtime['date'];
    $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray, mainpage) VALUES 
        ('".$request."','".$catnum."','".addslashes($event['Event'])."','".addslashes($performer_id)."',
            '".$event['EventID']."','".$hasharray."','n')";
}

if($querystring)
{
    $request = str_replace("--","-",$request);
    if(!mysql_query($querystring))
        {
            exit("<br>" . mysql_error());
        }
    else
    {
        if(mysql_affected_rows() != 0)
            {               
                echo date('H:i:s') . ": ";
                echo $request . " entry inserted<br>";
            }
        else
            {
                //echo "<i>" .$request . " entry ignored</i><br>";
            }
    }
}

} 
```

任何帮助是极大的赞赏。先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:24:05.813

如果您正在寻找重构的机会，这里有一些常见的代码气味，它们给出了一个可以改进的区域：

长 if / elseif / else 语句：

```
if () {
    ...
} elseif () {
    ...
} else {
    ...
} 
```

有些人喜欢用`switch`语句替换它们，但面向对象有更强大的工具来处理这个问题。有时，只需一个写得好的方法就可以减少对它们的需求。

我在您的代码中注意到的另一件事是（看似）不同条件下的重复操作：

```
if(strstr($event['Event']," vs. "))
    {
        $game = true;
        $teams = explode(" vs. ",$event['Event']);
    }
elseif(strstr($event['Event']," Vs. "))
    {
        $game = true;
        $teams = explode(" Vs. ",$event['Event']);
    } 
```

如果您进行不区分大小写的比较，您将节省五行几乎相同的代码

```
if(stristr ($event['Event']," vs. "))
{
    $game = true;
    $teams = explode(" vs. ",$event['Event']);
} 
```

您可以通过在函数中反转 if 语句来减少嵌套并提高可读性：

```
if($querystring)
{
    // lots of code here
    // lots of code here
    // lots of code here
    // lots of code here
} 
```

变成

```
if(!$querystring)
{
    return;
}

// lots of code here
// lots of code here
// lots of code here
// lots of code here 
```

这在嵌套 if 语句时特别有用，因为嵌套越多，越难阅读。

在性能方面，您访问数据库的次数越多，您的代码就会越慢。如果您可以批量查询，或者完全避免它们 - 这是您的代码中花费您最多的毫秒数！

关于性能的注意事项：您应该首先优化代码的可读性。使其易于阅读和更改。然后测量它。如果花费的时间太长，请查看性能调优。在每次更改后进行测量，看看它是否真的提高了性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:18:42.087

**EDIT1**：我更新了下面的代码以避免 SQL 注入（它使它更短更容易阅读）。

最大的性能提升将是一次插入多条记录，通过`INSERT INTO ... (fields) VALUES (values1),(values2)...`. 这是一个例子：

```
$eventquery = mysql_query("SELECT * FROM maintable WHERE PCatID != '3' AND PCatID != '4'");
$page_fields = array();
while($event = mysql_fetch_array($eventquery))
{
    $querystring = null;
    $performer_id = array();
    $hasharray = array();
    $venue = preg_replace("/ \(formerly (.+?)\)/i", '', $event['Venue']);

    $perfquery = mysql_query("SELECT * FROM maintable WHERE EventID = '".$event['EventID']."'");   
    while($perf = mysql_fetch_array($perfquery))
        {
            $performer_id[$perf['PerformerID']] = $perf['Performer'];
            $hasharray[] = $perf['id'];
        }

    $eventtime = getEventTime($event['DateTime']);
    $performer_id = serialize($performer_id);
    $hasharray = serialize($hasharray);

    if($event['PCatID'] == "2" && $event['CCatID'] != "24")
    {
        $request = "buy-".strCleanupForPage($event['Event'])."-concert-tickets/".strCleanupForPage($event['City'])."-".
            strCleanupForPage(stateabb($event['State']))."-".strCleanupForPage($venue)."-".$eventtime['date'];

        $catnum = "202";

        $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
    }
    elseif($event['GCatID'] == "32" || $event['GCatID'] == "16" || $event['GCatID'] == "30" || $event['GCatID'] == "19" ||
             $event['GCatID'] == "31" || $event['GCatID'] == "22")
    { 
        if($event['GCatID'] == "32")
            {$catnum = "102";}
        elseif($event['GCatID'] == "16")
            {$catnum = "101";}
        elseif($event['GCatID'] == "30")
            {$catnum = "103";}
        elseif($event['GCatID'] == "19")
            {$catnum = "104";}
        elseif($event['GCatID'] == "31")
            {$catnum = "109";}
        elseif($event['GCatID'] == "22")
            {$catnum = "108";}
        elseif($event['GCatID'] == "17")
            {
                if($event['CCatID'] == "66")
                    {$catnum = "106";}
                elseif($event['CCatID'] == "65")
                    {$catnum = "105";}
            }

        if(strstr($event['Event']," vs. "))
            {
                $game = true;
                $teams = explode(" vs. ",$event['Event']);
            }
        elseif(strstr($event['Event']," Vs. "))
            {
                $game = true;
                $teams = explode(" Vs. ",$event['Event']);
            }
        else
            {
                $game = false;            
            }

        if($game)
            {           

                $catnum .= "2";
                $homequery = mysql_query("SELECT * FROM sportsteams WHERE fullname LIKE '".$teams[0]."'");  
                $home = mysql_fetch_array($homequery);  
                $awayquery = mysql_query("SELECT * FROM sportsteams WHERE fullname LIKE '".$teams[1]."'");  
                $away = mysql_fetch_array($awayquery);

                if((mysql_num_rows($homequery)) == 0 || (mysql_num_rows($awayquery)) == 0)
                {
                    if($catnum == "1012")
                        {$request = "mlb-baseball-tickets";}
                    elseif($catnum == "1022")
                        {$request = "nfl-football-tickets";}
                    elseif($catnum == "1032")
                        {$request = "nba-basketball-tickets";}
                    elseif($catnum == "1042")
                        {$request = "nhl-hockey-tickets";}
                    elseif($catnum == "1052")
                        {$request = "ncaa-football-tickets";}
                    elseif($catnum == "1062")
                        {$request = "ncaa-basketball-tickets";}
                    elseif($catnum == "1082")
                        {$request = "mls-soccer-tickets";}
                    elseif($catnum == "1092")
                        {$request = "wnba-basketball-tickets";}
                    $eventname = preg_replace("/\([iI]ncludes (.+?)\)/", '', $event['Event']);
                    $request .= "/".strCleanupForPage($eventname)."-".strCleanupForPage($event['City'])."-".
                         strCleanupForPage(stateabb($event['State']));
                    }
                else
                    {
                        $request = strCleanupForPage($home['fullname'])."-tickets-".strCleanupForPage($venue)."/".strCleanupForPage($home['nickname'])."-vs-".strCleanupForPage($away['nickname'])."-".strCleanupForPage($event['City'])."-".
                        strCleanupForPage(stateabb($event['State']))."-".$eventtime['date'];
                        $request = str_replace("-/","/",$request);
                    }

            $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
        }
        else
        {   
            $catnum .= "3";
            if($catnum == "1013")
                {$request = "mlb-baseball";}
            elseif($catnum == "1023")
                {$request = "nfl-football";}
            elseif($catnum == "1033")
                {$request = "nba-basketball";}
            elseif($catnum == "1043")
                {$request = "nhl-hockey";}
            elseif($catnum == "1053")
                {$request = "ncaa-football";}
            elseif($catnum == "1063")
                {$request = "ncaa-basketball";}
            elseif($catnum == "1083")
                {$request = "mls-soccer";}
            elseif($catnum == "1093")
                {$request = "wnba-basketball";}

            $eventname = preg_replace("/\([iI]ncludes (.+?)\)/", '', $event['Event']);
            $request .= "/".strCleanupForPage($eventname)."-".strCleanupForPage($event['City'])."-".
            strCleanupForPage(stateabb($event['State']));

            $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
        }
    }
    elseif($event['CCatID'] == "50")
    {
        $request = "boxing-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
        $catnum = '1142';
        $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
    }    
    elseif($event['CCatID'] == "67")
    {
        $request = "golf-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
        $catnum = '1112';
        $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
    }    
    elseif($event['CCatID'] == "27")
    {
        $request = "tennis-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
        $catnum = '1102';
        $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
    }    
    elseif($event['CCatID'] == "101")
    {
        $request = "ufc-mma-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
        $catnum = '1152';
        $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
    }    
    elseif($event['CCatID'] == "69")
    {
        if(strstr($event['Event'],"NASCAR"))
        {                    
            $request = "nascar-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
            $catnum = '1122';
            $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
        }
        elseif($event['GCatID'] == "35")
        {
            $request = "horse-racing-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
            $catnum = '1132';
            $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
        }
    }
    elseif($event['GCatID'] == "26")
    {
        $request = "wwe-tickets/".strCleanupForPage($event['Event'])."-".strCleanupForPage($event['City'])."-".$eventtime['date'];
        $catnum = '1162';
        $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
    }
    elseif($event['CCatID'] == "24")
    {   
        $catnum = "402";
        $request = strCleanupForPage($event['Event'])."-comedy-tickets/".strCleanupForPage($event['City'])."-".strCleanupForPage(stateabb($event['State'])).
            "-".strCleanupForPage($event['Venue'])."-".$eventtime['date'];
        $page_fields[] = array($request, $catnum, $event['Event'], $performer_id, $event['EventID'], $hasharray, 'n');
    }

    if($page_fields)
    {
        $rows = array();
        foreach ($page_fields as $fields) {
            for ($i = 0; $i < count($fields), ++$i) {
                $fields[$i] = sprintf("'%s'", mysql_escape_string($fields[$i]));
            }
            $rows[] = sprintf('(%s)', join(',', $fields));
        }
        $querystring = "INSERT IGNORE INTO pages (request, catnum, name, perfarray, event_id, hasharray, mainpage) VALUES\n"
            . join(",\n", $rows);

        $request = str_replace("--","-",$request);
        if(!mysql_query($querystring))
            {
                exit("<br>" . mysql_error());
            }
        else
        {
            if(mysql_affected_rows() != 0)
                {               
                    echo date('H:i:s') . ": ";
                    echo $request . " entry inserted<br>";
                }
            else
                {
                    //echo "<i>" .$request . " entry ignored</i><br>";
                }
        }
    }

} 
```

当然，如果您达到系统上设置的限制，您可以调整`max_allowed_packet`和/或设置。`bulk_insert_buffer_size`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:17:26.987

一种选择是改变这一点：

```
 $catnum .= "3";
    if($catnum == "1013")
        {$request = "mlb-baseball";}
    elseif($catnum == "1023")
        {$request = "nfl-football";}
    elseif($catnum == "1033")
        {$request = "nba-basketball";}
    elseif($catnum == "1043")
        {$request = "nhl-hockey";}
    elseif($catnum == "1053")
        {$request = "ncaa-football";}
    elseif($catnum == "1063")
        {$request = "ncaa-basketball";}
    elseif($catnum == "1083")
        {$request = "mls-soccer";}
    elseif($catnum == "1093")
        {$request = "wnba-basketball";} 
```

并用开关重写它[`switch`](http://php.net/manual/en/control-structures.switch.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:32:39.523

Your database structure seems terribly strange, however I could be wrong as your code is rather horrible to read.

One problem is that it's not normalized. For the `maintable` you have to do several selects for 1 event. Well, your main table should firstly change name and then hold only events and the data directly related to only the event.

For performers or teams participating you want to query another table (probably with a join for this script) which holds the event id together with the performers data.

Your category IDs should also be in the database and can also be joined in the first query. Any category properties that makes handling different you would also store in this table.

Your problem is not that you have 10k rows, it is the database structure.

Read up on database normalization and especially third normal form. Then give it a good try and feel free to come back and ask about the result.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T16:10:12.480

不是很长吗？如果你想降低代码的复杂性，在大型应用程序中，切换到面向对象的编程。您仍在使用不推荐使用的函数，例如 mysql_query。它的支持尚未删除，但不鼓励使用。切换到更面向对象的方法。PDO 最好

# html - 带锚的 CSS3 过渡

> ID：12643510
> 
> 赞同：1
> 
> 时间：2012-09-28T16:05:58.020
> 
> 标签：html, css, anchor, transition

我无法让这个锚转换工作！请告诉我你的想法。

**这是CSS**

```
a.transition {
    -webkit-transition: all 1s ease-in-out;
    -moz-transition: all 1s ease-in-out;
    -o-transition: all 1s ease-in-out;
    transition: all 1s ease-in-out;
} 
```

**这是HTML**

```
<h1 id="intro">Let's Build Something... </h1>
<h1 id="intro2"><a class="transition" href="#create">Together</a>.</h1>
<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>

<p><a name="create" class="transition">My name is Geoff Phillips, and I'm an innovator. What can I create for you?<a/></p> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T16:20:54.137

我认为您不能仅使用 CSS 来做到这一点。这是一个用 jQuery 实现它的函数：

```
$('a[href^=#]').on("click",function(e){
    var t= $(this.hash);
    var t=t.length&&t||$('[name='+this.hash.slice(1)+']');
    if(t.length){
        var tOffset=t.offset().top;
        $('html,body').animate({scrollTop:tOffset-20},'slow');
        e.preventDefault();
    }
});​ 
```

这适用于任何`<a href="#any-id-or-name">`锚。 **[演示](http://jsfiddle.net/gionaf/2YfzC/)**。

要使其滚动得更快或更慢，请更改`'slow'`为`'fast'`以毫秒为单位的任何数值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-19T10:45:41.163

[您可以使用scrollIntoView](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView) JavaScript 方法滚动到页面的任何元素。它适用于任何元素。 `document.getElementById("yourElement").scrollIntoView();`将滚动到`yourElement`。使用 Firefox，您甚至可以通过添加`{behavior:'smooth'}`作为方法的参数来平滑滚动。不幸的是，这不是跨浏览器。

如果你想要一个跨浏览器的 VanillaJS 库，我会推荐[Smooth-scroll](https://github.com/cferdinandi/smooth-scroll)

# php - Paypal API 退还捕获的授权

> ID：12643512
> 
> 赞同：4
> 
> 时间：2012-09-28T16:06:19.330
> 
> 标签：php, paypal, paypal-ipn, paypal-sandbox

我正在使用 Paypal API 进行授权和捕获，我可以轻松地授权、捕获和取消付款。

问题是一旦付款被捕获，我看不到任何退款方式，因为“RefundTransaction”告诉我无法退还此类付款，而“DoVoid”表示付款已被捕获。

## 有没有办法通过 API 退还捕获的授权？

已解决我使用交易ID进行授权，必须使用捕获时收到的交易ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:13:07.340

查看[RefundTransaction 消息请求](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_nvp_r_RefundTransaction)。但我不确定，通过使用 PayPal 付款来授权人们是否是一种好的方式——除非你想确认他们的付款账户。

# watin - 如何生成随机数、字符串并从 Watin 的下拉列表中选择随机选项？

> ID：12643513
> 
> 赞同：0
> 
> 时间：2012-09-28T16:06:30.077
> 
> 标签：watin

我无法找到在这种情况下使用的正确语法，有人可以帮忙吗？

例如，我想做的事：

```
ieInUse.TextField(Find.ById("Blah")).TypeText("Zzz");   -- I'd like to replace the 'Zzz' with just a random string.

ieInUse.GoTo("http://randomwebsite/Description/11");  -- Replacing the 11 with a random 2 numbers 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:52:39.380

我确实对使用非确定性数据进行测试有一些意见，但由于我不知道背景，所以我会把它们留给自己:)

我不知道任何内置功能，但您可以轻松添加自己的方法来做到这一点；

```
 static string RandomString(int len)
    {
        var random = new Random();
        return new string(Enumerable.Range(1, len)
            .Select(_ => (char)(random.Next() % 95 + 33)).ToArray());
    }

    static string RandomDigits(int len)
    {
        var random = new Random();
        return new string(Enumerable.Range(1, len)
            .Select(_ => (char) (random.Next()%10 + '0')).ToArray());
    } 
```

然后你可以做;

```
ieInUse.TextField(Find.ById("Blah")).TypeText(RandomString(7)); 
ieInUse.GoTo("http://randomwebsite/Description/" + RandomDigits(2)); 
```

# excel - Excel 2007 影响单元格颜色但不影响内容的下拉列表

> ID：12643522
> 
> 赞同：1
> 
> 时间：2012-09-28T16:07:05.197
> 
> 标签：excel, list, drop-down-menu, colors, background

我搜索了这个解决方案，我发现许多下拉列表可以更改单元格的颜色和数据，或者根据输入的数据更改颜色。

我想做的是有一个里面有一个数字的单元格（#'s 1-10），还有一个下拉列表（通过，失败，边缘），这取决于下拉列表中的哪个项目被选中它会将单元格的背景颜色从默认的白色更改为红色、绿色或黄色。

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:30:36.643

您可以使用条件格式来实现相同的目的。对于带数字的单元格添加条件格式

1.  主页 -> 条件格式 -> 新规则
2.  选择`Use a formula to determine which cells to format`。现在你在这里设置一个公式。您可以参考此处的下拉列表值来设置格式。（例如：如果 A 列有数字，B 列有下拉菜单，则可以将公式设置为`=$B1="Marginal"`并设置格式。

希望这可以帮助。

截图供参考： ![在此处输入图像描述](../Images/8feb0e10abe85a7a150082c28b10f46f.png) ![在此处输入图像描述](../Images/8cf7c3fca5ce2677639b454cf0a6d154.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T01:23:19.117

我想我已经找到了这种情况的最佳解决方案：

我有两个并排的牢房。一个带有数据，一个带有下拉框。这两个单元格相邻，因此它们显示为一个单元格（即使它们不是）。然后我在两个单元格上放置了两个单独的条件格式。数据单元格的条件格式根据下拉框单元格的值改变了单元格的背景颜色。下拉框单元格的条件格式根据其自身的值将背景和文本颜色更改为与其他单元格相同的颜色（以混合）。

当两个单元格的边界和间距正确时，它们显示为一个具有一个值的单元格。格式化和所有工作都做了很多工作，但我认为这可能是这种情况下的最佳选择。

再次感谢康斯坦特的帮助。:)

# c++ - 我在 Linux 上可以获得的最佳时间分辨率是多少

> ID：12643535
> 
> 赞同：1
> 
> 时间：2012-09-28T16:07:36.290
> 
> 标签：c++, resolution, timing

我正在尝试测量并行端口上 2 个信号之间的时间差，但首先我要知道我在 SUSE 上的测量系统（AMD Athlon(tm) 64 X2 Dual Core Processor 5200+ × 2）有多准确12.1 x64。

因此，经过一番阅读后，我决定使用clock_gettime()，首先我使用以下代码获取clock_getres() 值：

```
/*
 * This program prints out the clock resolution.
 */
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int main( void )
  {
    struct timespec res;

    if ( clock_getres( CLOCK_REALTIME, &res) == -1 ) {
      perror( "clock get resolution" );
      return EXIT_FAILURE;
    }
    printf( "Resolution is %ld nano seconds.\n",
          res.tv_nsec);
    return EXIT_SUCCESS;
  } 
```

结果是：1纳秒。我很高兴！

但这是我的问题，当我试图用其他代码检查这个事实时：

```
#include <iostream>
#include <time.h>
using namespace std;

timespec diff(timespec start, timespec end);

int main()
{
    timespec time1, time2, time3,time4;
    int temp;
    time3.tv_sec=0;
    time4.tv_nsec=000000001L;
    clock_gettime(CLOCK_REALTIME, &time1);
        NULL;
    clock_gettime(CLOCK_REALTIME, &time2);
    cout<<diff(time1,time2).tv_sec<<":"<<diff(time1,time2).tv_nsec<<endl;
    return 0;
}

timespec diff(timespec start, timespec end)
{
    timespec temp;
    if ((end.tv_nsec-start.tv_nsec)<0) {
        temp.tv_sec = end.tv_sec-start.tv_sec-1;
        temp.tv_nsec = 1000000000+end.tv_nsec-start.tv_nsec;
    } else {
        temp.tv_sec = end.tv_sec-start.tv_sec;
        temp.tv_nsec = end.tv_nsec-start.tv_nsec;
    }
    return temp;
} 
```

这个计算两个clock_gettime调用之间的时间，time3和time4已声明但未在此示例中使用，因为我正在使用它们进行测试。

此示例中的输出在 978 到 1467 ns 之间波动。这两个数字都是 489 的倍数，这让我觉得 489 ns 是我的真实分辨率。与上面获得的 1 ns 相差甚远。

我的问题：有没有办法获得更好的结果？我错过了什么吗？

我的项目确实需要至少 10ns 的分辨率。来吧！GPS可以获得比PC更好的分辨率？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-11-21T01:59:31.773

我意识到这个话题早就死了，但想把我的发现扔进去。这是一个很长的答案，所以我把简短的答案放在这里，有耐心的人可以完成剩下的。这个问题的答案不完全是 700 ns 或 1500 ns，具体取决于您使用的 clock_gettime() 模式。长答案要复杂得多。

作为参考，我做这项工作的机器是一台没人想要的旧笔记本电脑。它是运行 Ubuntu 14.041 LTS 的 Acer Aspire 5720Z。

硬件：
RAM：2.0 GiB // 这是 Ubuntu 在“系统设置”→“详细信息”中报告的方式
处理器：Intel® Pentium(R) Dual CPU T2330 @ 1.60GHz × 2
图形：Intel® 965GM x86/MMX/SSE2

我想在即将到来的项目中准确测量时间，并且作为一个相对较新的 PC 硬件，不管操作系统如何，我想我会在计时硬件的分辨率上做一些实验。我偶然发现了这个问题。

由于这个问题，我认为clock_gettime() 看起来符合我的需求。但是我过去在 PC 硬件方面的经验让我感到不知所措，所以我重新开始做一些实验，看看计时器的实际分辨率是多少。

方法：从clock_gettime() 收集结果的连续样本，并查看分辨率中的任何模式。代码如下。

结果略长摘要：

1.  并不是真正的结果。结构中场的规定分辨率以纳秒为单位。调用clock_getres() 的结果也是tv_sec 0，tv_nsec 1。但以前的经验告诉我们不要只相信结构的分辨率。这是精度的上限，而现实往往要复杂得多。

2.  在我的机器上，我的程序，我的操作系统，在某一天等上，clock_gettime() 结果的实际分辨率对于模式 0 和 1 来说是 70 纳秒。70 ns 并不算太糟糕，但不幸的是，这是不现实，我们将在下一点看到。更复杂的是，使用模式 2 和 3 时的分辨率似乎为 7 ns。

3.  对于模式 0 和 1，clock_gettime() 调用的持续时间更像是 1500 ns。如果需要 20 倍的分辨率才能获得一个值，那么在时间上要求 70 ns 的分辨率对我来说根本没有意义。

4.  clock_gettime() 的某些模式比其他模式更快。模式 2 和 3 显然是模式 0 和 1 的挂钟时间的一半左右。模式 0 和 1 在统计上彼此无法区分。模式 2 和 3 比模式 0 和 1 快得多，模式 3 总体上是最快的。

在继续之前，我最好定义一下模式：哪个模式是哪个？：
模式 0 CLOCK_REALTIME //参考：[http](http://linux.die.net/man/3/clock_gettime)
: //linux.die.net/man/3/clock_gettime 模式 1 CLOCK_MONOTONIC
模式 2 CLOCK_PROCESS_CPUTIME_ID
模式 3 CLOCK_THREAD_CPUTIME_ID

结论：对我来说，如果分辨率小于函数获取时间间隔所需的时间长度，那么谈论时间间隔的分辨率是没有意义的。例如，如果我们使用模式 3，我们知道该函数在 99% 的时间内在 700 纳秒内完成。我们进一步知道，我们返回的时间间隔将是 7 纳秒的倍数。所以 7 纳秒的“分辨率”是调用时间的 1/100。我在 7 纳秒的更改间隔中看不到任何值。分辨率问题有 3 个不同的答案：1 ns、7 或 70 ns，最后是 700 或 1500 ns。我赞成最后一个数字。

毕竟，如果你想衡量某个操作的性能，你需要记住 clock_gettime() 调用需要多长时间——即 700 或 1500 ns。例如，尝试测量需要 7 纳秒的东西是没有意义的。为了争论，假设您愿意忍受性能测试结论的 1% 错误。如果使用模式 3（我想我将在我的项目中使用），您将不得不说您需要测量的时间间隔需要是 100 乘以 700 纳秒或 70 微秒。否则你的结论会有超过1%的错误。所以继续测量你感兴趣的代码，但是如果你在感兴趣的代码中经过的时间少于 70 微秒，

这些说法的理由和一些细节：

先声明3。这很简单。只需多次运行clock_gettime()并将结果记录在一个数组中，然后对结果进行处理。在循环之外进行处理，以使 clock_gettime() 调用之间的时间尽可能短。

这一切意味着什么？见附图。例如，对于模式 0，对 clock_gettime() 的调用在大多数情况下花费的时间不到 1.5 微秒。可以看到mode 0和mode 1基本一样。但是，模式 2 和 3 与模式 0 和 1 非常不同，并且彼此之间也略有不同。与模式 0 和 1 相比，模式 2 和 3 占用的时钟时间大约是时钟时间的一半。另请注意，模式 0 和 1 彼此略有不同 - 与模式 2 和 3 不同。请注意，模式 0 和 1 不同70 纳秒——这是我们将在权利要求 2 中提到的数字。

所附图表的范围限制为 2 微秒。否则，数据中的异常值会阻止图形传达前一点。图表没有说明的是，模式 0 和 1 的异常值比模式 2 和 3 的异常值差得多。换句话说，不仅平均值和统计“模式”（发生的值最大）和所有这些模式的中位数（即第 50 个百分位数）不同，因此最大值和它们的第 99 个百分位数也不同。

所附图表是四种模式中每一种模式的 100,001 个样本。请注意，绘制的测试仅使用处理器 0 的 CPU 掩码。我是否使用 CPU 亲和性似乎对图表没有任何影响。

主张 2：如果您在准备图表时仔细观察收集的样本，您很快就会注意到差异之间的差异（即二阶差异）是相对恒定的——大约为 70 纳秒（至少在模式 0 和 1 之前）。要重复此实验，请像以前一样收集“n”个时钟时间样本。然后计算每个样本之间的差异。现在将差异按顺序排序（例如 sort -g），然后得出个体的独特差异（例如 uniq -c）。

例如：

```
$ ./Exp03 -l 1001 -m 0 -k | sort -g | awk -f mergeTime2.awk | awk -f percentages.awk | sort -g
1.118e-06 8 8 0.8 0.8       // time,count,cumulative count, count%, cumulative count%
1.188e-06 17 25 1.7 2.5
1.257e-06 9 34 0.9 3.4
1.327e-06 570 604 57 60.4
1.397e-06 301 905 30.1 90.5
1.467e-06 53 958 5.3 95.8
1.537e-06 26 984 2.6 98.4
<snip> 
```

第一列中的持续时间之间的差异通常是 7e-8 或 70 纳秒。这可以通过处理差异变得更加清晰：

```
$ <as above> | awk -f differences.awk 
7e-08
6.9e-08
7e-08
7e-08
7e-08
7e-08
6.9e-08
7e-08
2.1e-07 // 3 lots of 7e-08
<snip> 
```

请注意所有差异都是 70 纳秒的整数倍？或者至少在 70 纳秒的舍入误差内。

这个结果很可能取决于硬件，但我实际上不知道此时将其限制为 70 纳秒的原因。也许某处有 14.28 MHz 振荡器？

请注意，在实践中，我使用了更多的样本，例如 100,000，而不是上面的 1000。

相关代码（附）：

'Expo03' 是尽可能快地调用clock_gettime() 的程序。请注意，典型用法类似于：

./Expo03 -l 100001 -m 3

这将调用 clock_gettime() 100,001 次，以便我们可以计算 100,000 个差异。本例中对 clock_gettime() 的每次调用都将使用模式 3。

MergeTime2.awk 是一个有用的命令，它是一个美化的“uniq”命令。问题是二阶差异通常是成对的 69 和 1 纳秒，而不是 70（至少对于模式 0 和 1），因为我让你相信到目前为止。因为没有 68 纳秒或 2 纳秒的差异，所以我将这 69 和 1 纳秒对合并为一个 70 纳秒的数字。为什么会发生 69/1 行为很有趣，但是将它们视为两个独立的数字通常会在分析中增加“噪音”。

在你问之前，我已经重复了这个避免浮点的练习，但同样的问题仍然存在。结果 tv_nsec 作为整数具有这种 69/1 行为（或 1/7 和 1/6），因此请不要假设这是由浮点减法引起的伪影。

请注意，我对 70 ns 和 70 ns 的小整数倍的这种“简化”很有信心，但这种方法在 7 ns 的情况下看起来不太稳健，尤其是当您获得 10 倍于 7 ns 分辨率的二阶差异时。

percents.awk 和 Difference.awk 以防万一。

停止新闻：我无法发布图表，因为我没有“至少 10 的声誉”。对不起。

罗布·沃森 2014 年 11 月 21 日

Expo03.cpp

```
/* Like Exp02.cpp except that here I am experimenting with
   modes other than CLOCK_REALTIME
   RW 20 Nov 2014
*/

/* Added CPU affinity to see if that had any bearing on the results
   RW 21 Nov 2014
*/

#include <iostream>
using namespace std;
#include <iomanip>

#include <stdlib.h> // getopts needs both of these
#include <unistd.h>

#include <errno.h> // errno

#include <string.h> // strerror()

#include <assert.h>

// #define MODE CLOCK_REALTIME
// #define MODE CLOCK_MONOTONIC
// #define MODE CLOCK_PROCESS_CPUTIME_ID
// #define MODE CLOCK_THREAD_CPUTIME_ID

int main(int argc, char ** argv)
{
  int NumberOf = 1000;
  int Mode = 0;
  int Verbose = 0;
  int c;
  // l loops, m mode, h help, v verbose, k masK

  int rc;
  cpu_set_t mask;
  int doMaskOperation = 0;

  while ((c = getopt (argc, argv, "l:m:hkv")) != -1)
  {
    switch (c)
      {
      case 'l': // ell not one
        NumberOf = atoi(optarg);
        break;
      case 'm':
        Mode = atoi(optarg);
        break;
      case 'h':
        cout << "Usage: <command> -l <int> -m <mode>" << endl
             << "where -l represents the number of loops and "
             << "-m represents the mode 0..3 inclusive" << endl
             << "0 is CLOCK_REALTIME" << endl
             << "1 CLOCK_MONOTONIC" <<  endl
             << "2 CLOCK_PROCESS_CPUTIME_ID" << endl
             << "3 CLOCK_THREAD_CPUTIME_ID" << endl;
        break;
      case 'v':
        Verbose = 1;
        break;
      case 'k': // masK - sorry! Already using 'm'...
        doMaskOperation = 1;
        break;
      case '?':
        cerr << "XXX unimplemented! Sorry..." << endl;
        break;
      default:
        abort();
      }
  }

  if (doMaskOperation)
  {
    if (Verbose)
    {
      cout << "Setting CPU mask to CPU 0 only!" << endl;
    }
    CPU_ZERO(&mask);
    CPU_SET(0,&mask);
    assert((rc = sched_setaffinity(0,sizeof(mask),&mask))==0);
  }

  if (Verbose) {
    cout << "Verbose: Mode in use: " << Mode << endl;
  }

  if (Verbose)
  {
    rc = sched_getaffinity(0,sizeof(mask),&mask);
    // cout << "getaffinity rc is " << rc << endl;
    // cout << "getaffinity mask is " << mask << endl;
    int numOfCPUs = CPU_COUNT(&mask);
    cout << "Number of CPU's is " << numOfCPUs << endl;
    for (int i=0;i<sizeof(mask);++i) // sizeof(mask) is 128 RW 21 Nov 2014
    {
      if (CPU_ISSET(i,&mask))
      {
        cout << "CPU " << i << " is set" << endl;
      }
      //cout << "CPU " << i 
      //     << " is " << (CPU_ISSET(i,&mask) ? "set " : "not set ") << endl;
    }
  }

  clockid_t cpuClockID;
  int err = clock_getcpuclockid(0,&cpuClockID);
  if (Verbose)
  {
    cout << "Verbose: clock_getcpuclockid(0) returned err " << err << endl;
    cout << "Verbose: clock_getcpuclockid(0) returned cpuClockID " 
       << cpuClockID << endl;
  }

  timespec timeNumber[NumberOf];
  for (int i=0;i<NumberOf;++i)
  {
    err = clock_gettime(Mode, &timeNumber[i]);
    if (err != 0) {
      int errSave = errno;
      cerr << "errno is " << errSave 
           << " NumberOf is " << NumberOf << endl;
      cerr << strerror(errSave) << endl;
      cerr << "Aborting due to this error" << endl;
      abort();
    }
  }

  for (int i=0;i<NumberOf-1;++i)
  {
    cout << timeNumber[i+1].tv_sec - timeNumber[i].tv_sec
            + (timeNumber[i+1].tv_nsec - timeNumber[i].tv_nsec) / 1000000000.
         << endl;

  }
  return 0;
} 
```

合并时间2.awk

```
BEGIN {
 PROCINFO["sorted_in"] = "@ind_num_asc"
}

{array[$0]++}

END {
  lastX = -1;
  first = 1;

  for (x in array)
  {
    if (first) { 
      first = 0 
      lastX = x; lastCount = array[x]; 
    } else {
      delta = x - lastX;
      if (delta < 2e-9) { # this is nasty floating point stuff!!
        lastCount += array[x]; 
        lastX = x
      } else {
        Cumulative += lastCount;
        print lastX "\t" lastCount "\t" Cumulative
        lastX = x; 
        lastCount = array[x]; 
      }
    }
  }
  print lastX "\t" lastCount "\t" Cumulative+lastCount
} 
```

百分比.awk

```
{ # input is $1 a time interval $2 an observed frequency (i.e. count)
  # $3 is a cumulative frequency
  b[$1]=$2;
  c[$1]=$3;
  sum=sum+$2
} 

END {
  for (i in b) print i,b[i],c[i],(b[i]/sum)*100, (c[i]*100/sum);
} 
```

差异.awk

```
NR==1 {
  old=$1;next
} 
{
  print $1-old;
  old=$1
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T16:15:13.643

据我所知，**在 PC 上运行的**Linux通常无法为您提供纳秒范围内的计时器精度。这主要是由于内核中使用的任务/进程调度器的类型。这既是内核的结果，也是硬件的结果。

如果您需要纳秒级分辨率的计时，恐怕您不走运。但是，您应该能够获得微秒级的分辨率，这对于大多数情况来说应该足够好 - 包括您的并行端口应用程序。

如果您需要纳秒范围内的计时以精确到纳秒，您很可能需要专用的硬件解决方案；具有**非常精确的振荡器**（作为比较，大多数 x86 CPU 的基本时钟频率在乘法器之前的兆赫兹范围内）

最后，如果您希望用您的计算机替换示波器的功能，那么它在相对低频信号之外就无法工作。你最好投资一个示波器——即使[是一个简单的、便携式的、插入你的计算机](http://www.hobbylab.us/p/53/usb-oscilloscope-disco-2)以显示数据的手持式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T16:38:08.060

`RDTSCP`在您的 AMD Athlon 64 X2 上将提供[时间戳计数器](http://en.wikipedia.org/wiki/Time_Stamp_Counter)，其分辨率取决于您的时钟。但是精度与分辨率不同，您需要锁定线程关联并禁用中断（请参阅 IRQ 路由）。

这需要下降到汇编程序或使用[MSVC 2008](http://msdn.microsoft.com/en-us/library/bb385235%28v=vs.90%29.aspx)内在函数的 Windows 开发人员。

带有 RHEL5 的 RedHat 引入了`gettimeofday`用高分辨率`RDTSCP`调用替换的用户空间填充程序：

*   ~~http://developer.amd.com/Resources/documentation/articles/Pages/1214200692_5.aspx~~

*   [https://web.archive.org/web/20160812215344/https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_MRG/1.3/html/Realtime_Tuning_Guide/sect-Realtime_Tuning_Guide-General_System_Tuning-gettimeofday_speedup.html](https://web.archive.org/web/20160812215344/https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_MRG/1.3/html/Realtime_Tuning_Guide/sect-Realtime_Tuning_Guide-General_System_Tuning-gettimeofday_speedup.html)

另外，请检查您的硬件，AMD 5200 的时钟为 2.6Ghz，时钟间隔为 0.4ns，其成本`gettimeofday`为`RDTSCP`221 个周期，最多等于 88ns。

# c# - 有没有办法通过 umbraco 中的 api 返回当前站点节点 ID？

> ID：12643537
> 
> 赞同：0
> 
> 时间：2012-09-28T16:07:43.597
> 
> 标签：c#, api, umbraco

Umbraco 新手当然..

我有一些代码返回给定节点 ID 的特定数据类型内容，详细信息如下：

[umbraco API：尝试获取给定站点节点的文档类型数据](https://stackoverflow.com/questions/12620331/umbraco-api-trying-to-get-the-document-type-data-for-a-given-site-node)

这很好用，但是我必须知道起始节点，即在我的情况下是站点节点 ID（多站点 umbraco 安装）。

我也知道您可以通过以下方式获取主根节点：

[Umbraco - 在 C# 中查找根节点](https://stackoverflow.com/questions/11940537/umbraco-finding-root-node-in-c-sharp)

***我的问题是这个...***

从后端 API，是否有动态获取当前站点节点 ID（第一个链接）？这样我就不必提前知道了。我认为有一个选项可以从查询字符串中获取站点 ID.. Page.Request.QueryString["id"] 但是我猜如果页面是模板页面，则会返回这个，但是这是来自后端类？

到底有没有？或者我叫错树了！??

任何帮助，将不胜感激！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:56:46.883

假设您有一个 Umbraco 安装，其中包含两个站点，它们各自的主页和页面，例如

*   内容 (-1)
    *   主页 1 (1000)
        *   第 1.1 页 (1001)
    *   主页 2 (1002)
        *   第 2.1 页 (1003)

在 C# 中，当前节点可以通过

```
Node currentNode = Node.GetCurrent(); 
```

并且可以找到其对应的主节点

```
Node currentHome = new Node(int.Parse(currentNode.Path.Split(',')[1])); 
```

现在，`currentNode.Path`返回一串以 -1 开头的逗号分隔整数，即根，即您所称的主根，所有主页都在其下“活动”。

例如，页面 2.1 的**路径**值为**"-1,1002,1003"**。在逗号处拆分时，您将得到一个包含 3 个元素的数组，索引为 0,1,2。现在，**索引为 1**的第二个将给出**主节点的 id**。可以看到，最后一个id就是当前节点的id。顺便说一句，索引还告诉节点的级别，所以主页的级别是 1。

我在用于 Intranet/Extranet 并具有受保护页面的模板上使用了以下脚本。当访问者点击指向受保护页面的链接时，他/她将被拒绝访问并被重定向到具有会员登录名的主页。

```
<%@ Master Language="C#" MasterPageFile="~/umbraco/masterpages/default.master" AutoEventWireup="true" %>    

<%@ Import Namespace="umbraco.NodeFactory" %>

<script runat="server" language="CSharp">
    protected void Page_Load(object sender, EventArgs e)
    {
        // prevents template to be run without proper authorisation
        Node currentNode = Node.GetCurrent();
        Node currentHome = new Node(int.Parse(currentNode.Path.Split(',')[1]));
        Boolean HasAccess = umbraco.library.HasAccess(currentNode.Id, currentNode.Path);
        Boolean IsProtected = umbraco.library.IsProtected(currentNode.Id, currentNode.Path);

        if (IsProtected && !HasAccess)
        {
            // redirect to ancestor-or-self::HomePage
            Response.Status = "403 Forbidden";
            Response.Redirect(umbraco.library.NiceUrl(currentHome.Id), true);
        }
    }
</script>      

<asp:Content ContentPlaceHolderID="ContentPlaceHolderDefault" runat="server">
    <!-- redirect to home page -->
</asp:Content> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T23:16:55.183

假设您所有的根节点都属于相同的文档类型，在 razor 中您可以执行以下操作：

> var folderId = @Model.AncestorOrSelf("MyFolderType").Id;

它将从当前节点“向上”或“向后”搜索，直到找到指定类型的节点类型。

这里有另一种方法：

[http://our.umbraco.org/forum/developers/api-questions/20742-Getting-the-home-node-using-c](http://our.umbraco.org/forum/developers/api-questions/20742-Getting-the-home-node-using-c)

# javascript - js设备和方向检测

> ID：12643538
> 
> 赞同：1
> 
> 时间：2012-09-28T16:07:44.273
> 
> 标签：javascript, jquery, mobile

我已经根据我读过的其他脚本编写了这个脚本，并考虑到我是 js / jquery 的新手。

我想在页面加载和方向更改时检测设备的大小和方向。

这样我就可以在每种情况下应用不同的规则。

它在 android 设备上运行良好，但我发现它在 ipad 的纵向模式下不起作用现在我无法弄清楚我做错了什么。即使在 js lint 上，我也知道我的所有脚本都没有设置等等。一点帮助会很好。这是我写的代码。

此代码仅在使用 php 在移动设备上检测到您时才会触发

```
$(document).ready(function(){

var height = $(window).height();
var width = $(window).width();

if ( $(window).width() < 768) {
if(width>height) {
    // Smartphone Landscape Rules
    var orientation = ' Landscape';
}else{
    // Smartphone Portrait Rules
    var orientation = ' Portrait';
    }
alert ('Smartphone '+width+' - '+height+orientation);
}
if ( $(window).width() > 768) {
if(width>height) {
    // Tablet Landscape Rules
    var orientation = ' Landscape';
}else{
    // Tablet Portrait Rules
    var orientation = ' Portrait';
    }
alert ('Tablet '+width+'-'+height+orientation);
}

$(window).resize( function(){
var height = $(window).height();
var width = $(window).width();

alert (width+' - '+height);

if ( $(window).width() < 768) {
    if(width>height) {
    // Smartphone Landscape Rules
    var orientation = ' Landscape';
}else{
    // Smartphone Portrait Rules
    var orientation = ' Portrait';
    }
alert ('Smartphone '+width+'-'+height+orientation);
}
if ( $(window).width() > 768) {
    if(width>height) {
    // Tablet Landscape Rules
    var orientation = ' Landscape';
}else{
    // Tablet Portrait Rules
    var orientation = ' Portrait';
    }
    alert ('Tablet '+width+'-'+height+orientation);
}
});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T09:45:20.467

我发现了我的问题，那就是 if more then 规则必须比 iPad 能够检测到的实际尺寸小 1 px。

如果有人感兴趣，这是代码。只需忽略警报，因为我添加它们以测试所有方向和刷新。

```
var height = $(window).height();
var width = $(window).width();

if ( $(window).width() < 768) {
if(width>height) {
    // Smartphone Landscape Rules
    var orientation = ' Landscape';
}else{
    // Smartphone Portrait Rules
    var orientation = ' Portrait';
    }
alert ('Smartphone '+width+' - '+height+orientation);
}
if ( $(window).width() > 767) {
if(width>height) {
    // Tablet Landscape Rules
    var orientation = ' Landscape';
}else{
    // Tablet Portrait Rules
    var orientation = ' Portrait';
    }
alert ('Tablet '+width+'-'+height+orientation);
}

$(window).resize( function(){
var height = $(window).height();
var width = $(window).width();

if ( $(window).width() < 768) {
    if(width>height) {
    // Smartphone Landscape Rules
    var orientation = ' Landscape';
}else{
    // Smartphone Portrait Rules
    var orientation = ' Portrait';
    }
alert ('Smartphone '+width+'-'+height+orientation);
}
if ( $(window).width() > 767) {
    if(width>height) {
    // Tablet Landscape Rules
    var orientation = ' Landscape';
}else{
    // Tablet Portrait Rules
    var orientation = ' Portrait';
    }
    alert ('Tablet '+width+'-'+height+orientation);
}
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-10T10:30:44.820

我发现 window.orientation 值因 Android 上的设备（平板电脑/手机）而异。我将以下代码用于 Android 上的屏幕模式定义：

```
function isPortraitMode(){ 
   var screenWidth = Math.max(window.innerWidth, window.innerHeight);
   if (typeof window._myScreenWidth === 'undefined' // called at the first time (during the load) and the keyboard is not shown (won't take some height) 
        || window._myScreenWidth < screenWidth){  // sometimes window appears with animation and smaller size can be gathered during the animation at first time
        window._myScreenWidth = screenWidth;
   }
   return (window.innerWidth < window._myScreenWidth);
} 
```

预计在第一次通话期间键盘会被隐藏，因为键盘会更改`window.innerHeight`. `isPortraitMode()`在第一次加载时调用。

在方向更改和调整大小事件期间也会调用该函数。

# actionscript-3 - Flex 4.6 SplitViewNavigator - 显示/隐藏导航器

> ID：12643544
> 
> 赞同：0
> 
> 时间：2012-09-28T16:08:05.377
> 
> 标签：actionscript-3, apache-flex, flash-builder, flex4.6

我刚刚开始了一个新项目，并希望在我的某些屏幕上使用 SplitViewNavigator 布局，因为它非常适合我将要做的事情。

然而，并不是所有的屏幕都应该使用这种布局（homeview 就是其中之一）。所以我首先将侧视图的可见性设置为 false。

```
<s:SplitViewNavigator includeIn="tablet" width="100%" height="100%">
    <s:layout.landscape>
        <s:HorizontalLayout />
    </s:layout.landscape>
    <s:layout.portrait>
        <s:VerticalLayout />
    </s:layout.portrait>
    <s:ViewNavigator width.landscape="35%" height.landscape="100%"
                     width.portrait="100%" height.portrait="30%"
                     firstView="views.TestView" visible="false"/>
    <s:ViewNavigator width="100%" height="100%" height.portrait="100%"
                     firstView="views.OnSiteFormHomeView" />
</s:SplitViewNavigator> 
```

我知道如何访问 SpitViewNavigator 和各个 ViewNavigator。所以我在我的主页视图中做了以下操作（作为测试），但似乎什么也没发生。（另一个导航器保持全屏）。我尝试将代码附加到初始化和创建完成事件。

```
// Create a reference to the SplitViewNavigator.
var splitNavigator:SplitViewNavigator = navigator.parentNavigator as SplitViewNavigator;
// Create a reference to the ViewNavigator for the Detail frame.
var sideNavigator:ViewNavigator = splitNavigator.getViewNavigatorAt(0) as ViewNavigator;
var detailNavigator:ViewNavigator = splitNavigator.getViewNavigatorAt(1) as ViewNavigator;
sideNavigator.visible = true; 
```

我认为我需要以某种方式使其重绘屏幕/导航器。我尝试在 splitviewnavigator 以及各个导航器上调用初始化函数，但似乎没有什么区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T13:36:07.950

回答我自己的问题。我发现它在视图（弹出/推送）之间对我有用，所以我可以执行以下操作（从单个视图屏幕）：

```
sideNavigator.visible = true;
sideNavigator.pushView(SideViewHere);
detailNavigator.pushView(NewMainView); 
```

反过来是：

```
detailNavigator.popView();
sideNavigator.visible = false;
sideNavigator.popView(); 
```

这给了我我需要的一切。

# php - 如何使用 PDO (mysql) 正确调试 Insert 语句？

> ID：12643547
> 
> 赞同：3
> 
> 时间：2012-09-28T16:08:27.230
> 
> 标签：php, mysql, debugging, pdo

```
$PDO_db = new PDO('mysql:host='.DB_HOST.';dbname='.DB_NAME.';charset=UTF-8' , DB_USER, DB_PWD);
$sth = $PDO_db->prepare($insert);   
$arrPar = array(':nome' =>  $nome);         
$r = $sth->execute($arrPar);    
var_dump($arrPar);
print_r($PDO_db->errorInfo());
var_dump($r);
exit(); 
```

假设 $insert statemet 包含一个 SQL 错误，上面的代码我注意到以下内容：

1.  代码 A

    ```
    print_r($PDO_db->errorInfo()); 
    ```

    无论如何都会输出：

    ```
    Array (
        [0] => 00000
        [1] => 
        [2] => 
    ) 
    ```

    但 var_dump($s) 是假的

2.  如果在插入语句中我有一些`placemark`例如`:name`

    ```
    "Insert into mytable (name) VALUE(:name);" 
    ```

    然后在`$arrPar = array(':name' => $value)`with`$value=NULL`

    ```
    print_r($PDO_db->errorInfo()); 
    ```

    将再次输出：

    ```
    Array
    (
        [0] => 00000
        [1] => 
        [2] => 
    ) 
    ```

    但 var_dump($s) 是假的

所以我想知道使用 PDO 调试 MySQL 语句的正确方法**是**什么？

`PDO::errorInfo()`返回错误信息数组"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:27:35.887

奇怪……你确定什么都没有被插入吗？MySQL 的成功返回码*是*0，它`errorInfo`确实返回。但就像@Jack 说的：

```
try
{
    $PDO_db = new PDO('mysql:host='.DB_HOST.';dbname='.DB_NAME.';charset=UTF-8' , DB_USER, DB_PWD);
    $PDO_db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $sth = $PDO_db->prepare($insert);
    echo 'Insert prepared<br/>';
    $arrPar = array(':nome' =>  $nome);//shouldn't this be :name?
    $r = $sth->execute($arrPar);
    echo 'Insert executed<br/>';
    var_dump($r);
}
catch(PDOException $pdoE)
{
    echo $pdoE->getMessage().'<br/>';
    var_dump($pdoE);
}
exit();//? 
```

这应该会给你更多关于发生了什么的线索。此外，您声明（两次） a `var_dump`of`$s`为假，但您将执行调用的返回值分配给`$r`... 我假设这是一个错字，但您永远不知道，因此对`':nome'`.
还要牢记@Clarence 的建议，并将您的 php.ini 错误报告设置`E_ALL | E_STRICT`为另一台机器，或者你升级你的 PHP 版本。无论如何：它不像 PHP 那样严格的语言`E_STRICT`会花费你*大量*的时间来修复警告......

# ios - iPad 强制卷页过渡

> ID：12643549
> 
> 赞同：1
> 
> 时间：2012-09-28T16:08:33.383
> 
> 标签：ios, ipad, uipageviewcontroller, page-curl

我试图在没有任何手势的情况下强制我的 UIPageViews 上的页面卷曲过渡。我希望我的页面自动转换为页面卷曲效果。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-20T08:46:23.643

如果我理解正确，您想自动滑动视图吗？如果是，您可以使用`[NSTimer scheduledTimerWithTimeInterval: target: selector: userInfo: repeats:]`

具有自定义功能：例如：

```
- (void)animateViews {

[UIView transitionWithView:_viewsArray[_selectedPosition]
                      duration:1.5
                       options:UIViewAnimationOptionTransitionCurlDown
                    animations:^ {
                        _viewsArray[_selectedPosition].alpha = .0f;
                        _viewsArray[_selectedPosition + 1 > _viewsArray.count ? 0 : _selectedPosition + 1 ].alpha = 1.0f;
                    }
                    completion:^{
                        _selectedPosition++;
                    }];
} 
```

其中 _viewsArray 是可动画视图的数组，例如图像视图等，_selectedPosition 是显示视图在数组中的位置。

如果使用块，我建议您使用弱参考和强参考。这是一个非常简单的解决方案，因此您可以根据需要对其进行调整。

也许最好使用 UITableView 或 UICollectionView 及其方法 willDisplayCell: 并在此方法中使用页面卷曲动画。

您也可以尝试搜索[CocoaPods](https://cocoapods.org)。至少您可以尝试找到任何使用自定义视图转换的库；-)

# ios - 阅读IOS6中的请勿打扰设置

> ID：12643551
> 
> 赞同：5
> 
> 时间：2012-09-28T16:08:42.647
> 
> 标签：ios, xcode, ios6

有没有办法在 IOS6 中以编程方式读取新的请勿打扰模式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T18:45:16.370

不，不可能使用公共 API。

# java - 如何告诉我的 if 语句只接受整数？

> ID：12643559
> 
> 赞同：0
> 
> 时间：2012-09-28T16:09:01.810
> 
> 标签：java, if-statement, int

我希望我的程序告诉用户，如果他输入了一个非整数，他应该再试一次，而不是像现在这样终止整个 main 方法。问题部分伪代码：

```
int integer = input.nextInt();
If (user types in a non-integer) { 
  ("you have entered a false value, please retry");
  then let's user enter int value
else {
  assign nextint() to integer and continue
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T16:10:06.523

您可以使用[循环`while`重新](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/while.html)执行该部分代码，直到用户输入正确的整数值。

```
do {
    input = read user input
} while(input is not an integer) 
```

看来您正在使用 a `Scanner`，因此您可以[使用该`hasNextInt`方法](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#hasNextInt%28%29)：

```
while (!input.hasNextInt()) {
    let user know that you are unhappy
    input.next(); //consume the non integer entry
}

//once here, you know that you have an int, so read it
int number = input.nextInt(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:24:24.280

这是假设您担心用户在输入时输入的不是整数：

```
public static void main(String[] args) {
    Integer integer = 0;
    Scanner sc = new Scanner(System.in);
    System.out.println("Enter an integer:");
    String line = sc.next();
    integer = tryParse(line);
    while(integer == null){
        System.out.print("The input format was incorrect, enter again:");
        integer = tryParse(sc.next());
    }
    int value = integer.intValue();
}

public static Integer tryParse(String text){
    try{
        return new Integer(text);
    } catch
    (NumberFormatException e){
        return null;
    }
} 
```

# ajax - Ajax Tab 错误 指定的参数超出了有效值的范围。参数名称：值

> ID：12643565
> 
> 赞同：0
> 
> 时间：2012-09-28T16:09:32.467
> 
> 标签：ajax, dynamic, tabs

我正在尝试动态创建 ajax 选项卡并将其 ID 存储在会话中。我收到错误消息“指定的参数超出了有效值的范围。参数名称：值”。我可以通过调用单击按钮事件来创建第一个选项卡。当我单击按钮并在第二次尝试时调用相同的事件时......我得到了错误。似乎我正在引用会话中不再定义或包含的选项卡 ID 或容器\选项卡？

我对此进行了彻底的研究，似乎无法找到答案。任何帮助将不胜感激。

我的 asp 页面上有正确的脚本管理器和程序集引用。这是asp代码和代码片段背后的代码。

```
 <div>
                    <asp:Button ID ="AddTab" Text="Add Tab" OnClick = "addTab_Click" runat="server"/>
                    <AjaxToolkit:TabContainer ID="TabContainerContent" runat="server"  Height="150px" BackColor="White"  AutoPostBack="True" 
                    OnActiveTabChanged="TabContainerContent_OnActiveTabChanged" >
                    </AjaxToolkit:TabContainer>
                    <asp:Label ID="currentTabIndex" runat="server"></asp:Label> 
                    </div>
                    </td> 
```

代码背后

```
 private List<string> dynamicTabIDs;

        protected void Page_Init(Object sender, EventArgs e)
    {
        if (Session["dynamicTabIDs"] != null)
        {

            dynamicTabIDs = (List<string>)Session["dynamicTabIDs"];

            foreach (string tabID in dynamicTabIDs)
            {

                AjaxControlToolkit.TabPanel tab = new AjaxControlToolkit.TabPanel();
                tab.ID = tabID;
                tab.HeaderText = "Tab " + (TabContainerContent.Tabs.Count + 1).ToString();
                Label tabContent = new Label();
                tabContent.ID = "lbl_tab_" + TabContainerContent.Tabs.Count.ToString();
                tabContent.Text = "Tab " + (TabContainerContent.Tabs.Count + 1).ToString();
                tab.Controls.Add(tabContent);

                TabContainerContent.Tabs.Add(tab);
            }

        }//end if
        else
        {

            dynamicTabIDs = new List<string>(); 
        }

    }

     protected void Page_PreRender(object sender, EventArgs e)
     {  

     Session["dynamicTabIDs"] = dynamicTabIDs;  

        }

     protected void TabContainerContent_OnActiveTabChanged(object sender, EventArgs e)
     {

         currentTabIndex.Text = TabContainerContent.ActiveTab.ID; 

     }

    public void addTab_Click(object sender, EventArgs e)
    {

        AjaxControlToolkit.TabPanel tab = new AjaxControlToolkit.TabPanel();
        tab.ID = "tab" + Convert.ToString(TabContainerContent.Tabs.Count);
        tab.HeaderText = "Tab " + (TabContainerContent.Tabs.Count + 1).ToString();
        Label tabContent = new Label();
        tabContent.ID = "lbl_tab_" + TabContainerContent.Tabs.Count.ToString();
        tabContent.Text = "Tab " + (TabContainerContent.Tabs.Count + 1).ToString();
        tab.Controls.Add(tabContent);

        TabContainerContent.Tabs.Add(tab);

        TabContainerContent.ActiveTab = tab;

        dynamicTabIDs.Add(tab.ID); 

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T13:57:59.340

我尝试了一种不同的方法来实现这一点。我创建了静态选项卡并将它们设置为可见的真/假，这取决于它们是否被使用。我无法让动态标签工作。我确实必须使用这种方法将客户数量限制为 15 个订单。

我发现将数据绑定到 Ajax 选项卡中的网格视图非常容易。当然，您需要在 asp 页面中声明的脚本管理器 ajax 引用和对 web.config 文件的 ajax 引用更新。您还需要将 ajax css 样式添加到现有样式表中。我尝试使用单独的，但没有用。

ASP HTML

```
<AjaxToolkit:TabContainer ID="TabContainer1" runat="server" ActiveTabIndex="0" 
                            Visible="false" ScrollBars="Both"
                            CssClass="Tab2" Width="1326px" Height="464px" >

<AjaxToolkit:TabPanel ID="TabPanel1" runat="server" HeaderText="Empty" Enabled="true"    ScrollBars="Both" CssClass="Tab2">

<ContentTemplate>
<div style="overflow:auto;width:1287px; height: 418px;">
 <font color="white" size="1" face="Verdana">

 <asp:GridView ID="SalesOrderView1"     runat="server" BackColor="White"   BorderColor="#DEDFDE"visible="False"BorderStyle="None"      BorderWidth="1px" 
 CellPadding="4" ForeColor="Black" 
 GridLines="Vertical"     HorizontalAlign="Center">
 <AlternatingRowStyle      BackColor="White" />
 <FooterStyle BackColor="#CCCC99" />
 <HeaderStyle BackColor="#6B696B" Font-Bold="True" ForeColor="White" />
 <PagerStyle BackColor="#F7F7DE"    ForeColor="Black" HorizontalAlign="Right" />
 <RowStyle BackColor="#F7F7DE" />
 <SelectedRowStyle BackColor="#CE5D5A" Font-Bold="True" ForeColor="White" />
 <SortedAscendingCellStyle BackColor="#FBFBF2" />
 <SortedAscendingHeaderStyle BackColor="#848384" />
 <SortedDescendingCellStyle BackColor="#EAEAD3" />
  <SortedDescendingHeaderStyle BackColor="#575357" />
 </asp:GridView>
  </div>
  </font>
 </ContentTemplate>
   </AjaxToolkit:TabPanel>
      <AjaxToolkit:TabPanel ID="TabPanel2" runat="server" HeaderText="Empty" ScrollBars="Both" CssClass="Tab2">
 <ContentTemplate >
 </AjaxToolkit:TabContainer> 
```

在单击按钮事件上将数据绑定到 gridview 的 C# 代码。

```
 SalesOrderView1.Visible = true;
                        TabPanel1.Visible = true;
                        TabPanel1.HeaderText = Order_List[multi_order_count]; 
```

# c# - 如何在 DataTable 中使用 GetChanges()

> ID：12643568
> 
> 赞同：0
> 
> 时间：2012-09-28T16:09:40.557
> 
> 标签：c#

我一直在开发一些将 DataGridView 绑定到 DataTable 的应用程序。所以，现在我需要做一件事：用户可以编辑一些字段，当他点击“保存”时，应用程序必须以编程方式更改一些字段。我正在尝试使用此代码，但它不起作用：

```
private void toolStripMenuItemSaveChanges_Click(object sender, EventArgs e)
{   
    try
    {
        dataGridViewPersons.BindingContext[table].EndCurrentEdit();
        //
        DataTable changes = table.GetChanges();
        if (changes != null)
        {
            Console.WriteLine("edited rows=" + table.GetChanges().Rows.Count);

            foreach (DataRow row in changes.Rows)
            {
                row[29] = getRightBody(row, 7, 18);
                row[30] = "-";
                row[31] = getRightBody(row, 23, 25);
                row[32] = getRightBody(row, 26, 28);
            }
        }
        else
        {
            Console.WriteLine("edited rows=0");
        }

        adapter.Update(table);              
    }
    catch (Exception exeption)
    {
        this.Text = exeption.Message;
    }
} 
```

如果存在已编辑的行，则此代码不会更改绑定的 DataTable 中的字段；我认为 GetChanges() 返回 DataTable 与原始 DataTable 的关系，但现在我知道它是错误的。请告诉我决定。先感谢您。

# excel - 如何将公式驱动的数据通过管道传输到单个单元格中的多行？

> ID：12643571
> 
> 赞同：-1
> 
> 时间：2012-09-28T16:09:55.950
> 
> 标签：excel

Excel 允许您在每次希望开始新行时按 Alt + Enter 将多行数据输入到单个单元格中。

不幸的是，对于通过公式驱动的数据，似乎没有办法做到这一点。

我试图简单地将数据从多个单元格传输到单个单元格中的多行。

如果我有以下数据：

```
A     B     C     D     E
1    Mr.  David  Pho
2    Mr.  Lenny Ancio 
```

我尝试使用以下公式，但没有运气。

=B1&" "&C1&" "&D1

=B2&" "&C2&" "&D2

我也尝试为回车添加 ACII 代码，但这似乎也不起作用。

有没有人这样做过？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:13:19.013

您可以`Char(10)`在单元格公式中使用换行符。

**注意：**您*必须*将单元格的“换行文本”属性设置为 true。

要使用您的示例，它将是：

```
=B1 & Char(10) & C1 & Char(10) & D1 
```

# c++ - 如何在标准 C++ 字符串中使用 3 字节和 4 字节 Unicode 字符？

> ID：12643580
> 
> 赞同：13
> 
> 时间：2012-09-28T16:10:17.247
> 
> 标签：c++, string, stl, stdstring, unicode-string

在标准 C++ 中，我们有`char`和`wchar_t`用于存储字符。`char`可以存储*0x00*和*0xFF*之间的值。并且`wchar_t`可以存储 和 之间`0x0000`的值`0xFFFF`。`std::string`使用`char`，因此它只能存储 1 个字节的字符。`std::wstring`使用`wchar_t`，因此它可以存储最多 2 字节宽度的字符。这就是我对 C++ 中字符串的了解。如果我在这一点上说错了，请纠正我。

我在 Wikipedia 中阅读[了有关 UTF-8 的文章，](http://en.wikipedia.org/wiki/UTF-8#Examples)了解到某些 Unicode 字符最多占用 4 字节空间。例如，汉字**有一个 Unicode 代码点**0x24B62**，它占用内存中的 3 字节空间。**

 **是否有用于处理此类字符的 STL 字符串容器？我正在寻找类似的东西`std::string32`。此外，我们有`main()`ASCII 入口点，`wmain()`用于支持 16 位字符的入口点；对于 3 和 4 字节 Unicode 支持的代码，我们使用什么入口点？

你能添加一个小例子吗？

（我的操作系统：Windows 7 x64）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-28T17:59:09.277

首先，您需要更好地理解 Unicode。您的问题的具体答案在底部。

## 概念

您需要一组比入门编程课程中教授的非常简单的文本处理所需的更细微的概念。

*   字节
*   代码单元
*   代码点
*   抽象人物
*   用户感知字符

字节是内存的最小可寻址单元。现在通常是 8 位，能够存储多达 256 个不同的值。根据定义，一个 char 是一个字节。

代码单元是用于存储文本的最小固定大小的数据单元。当您并不真正关心文本的内容而只想将其复制到某个地方或计算文本使用了多少内存时，您就会关心代码单元。否则代码单元没有多大用处。

代码点表示字符集的不同成员。无论字符集中的“字符”是什么，它们都被分配了一个唯一的编号，每当您看到编码的特定数字时，您就知道您正在处理的是字符集中的哪个成员。

抽象字符是在语言系统中具有意义的实体，并且不同于其表示或分配给该意义的任何代码点。

用户感知的字符就是它们听起来的样子；用户在他使用的任何语言系统中认为的字符。

在过去，它`char`表示所有这些东西：a`char`定义为一个字节，在`char*`字符串中，代码单位是`char`s，字符集很小，所以 256 个值`char`可以表示每个成员，而语言系统是支持的很简单，所以字符集的成员大多代表了用户想要直接使用的字符。

但是这个`char`代表几乎所有东西的简单系统不足以支持更复杂的系统。

* * *

遇到的第一个问题是某些语言使用的字符远多于 256 个字符。因此引入了“宽”字符。宽字符仍然使用单一类型来表示上述四个概念，代码单元、代码点、抽象字符和用户感知字符。然而，宽字符不再是单字节。这被认为是支持大型字符集的最简单方法。

代码可能大体相同，只是它会处理宽字符而不是`char`.

然而事实证明，许多语言系统并不是那么简单。在某些系统中，不必让每个用户感知的字符都必须由字符集中的单个抽象字符表示是有意义的。因此，使用 Unicode 字符集的文本有时使用多个抽象字符来表示用户感知的字符，或者使用单个抽象字符来表示多个用户感知的字符。

宽字符还有另一个问题。由于它们增加了代码单元的大小，它们增加了用于每个字符的空间。如果希望处理可以由单字节代码单元充分表示但必须使用宽字符系统的文本，那么所使用的内存量将高于单字节代码单元的情况。因此，希望宽字符不要太宽。同时，宽字符需要足够宽，以便为字符集的每个成员提供唯一值。

Unicode 目前包含大约 100,000 个抽象字符。事实证明，这需要比大多数人愿意使用的宽字符。结果是一个宽字符系统；使用大于一个字节的代码单元来直接存储代码点值是不可取的。

综上所述，最初不需要区分字节、代码单元、代码点、抽象字符和用户感知字符。然而，随着时间的推移，有必要区分这些概念中的每一个。

* * *

## 编码

在上述之前，文本数据很容易存储。每个用户感知的字符都对应一个抽象字符，该抽象​​字符具有代码点值。字符太少了，256 个值就足够了。因此，只需将与所需的用户感知字符相对应的代码点编号直接存储为字节。后来，对于宽字符，对应于用户感知字符的值直接存储为更大尺寸的整数，例如 16 位。

但是由于以这种方式存储 Unicode 文本会使用比人们愿意花费更多的内存（每个字符三个或四个字节）Unicode“编码”存储文本不是通过直接存储代码点值，而是通过使用可逆函数来计算一些为每个代码点存储的代码单元值的数量。

例如，UTF-8 编码可以采用最常用的 Unicode 代码点，并使用单个字节代码单元来表示它们。不太常见的代码点使用两个一字节代码单元存储。使用三个或四个代码单元存储仍然不太常见的代码点。

这意味着通常可以使用 UTF-8 编码存储普通文本，使用比 16 位宽字符方案更少的内存，而且存储的数字不一定直接对应于抽象字符的代码点值。相反，如果您需要知道存储了哪些抽象字符，则必须“解码”存储的代码单元。如果您需要了解用户感知字符，则必须进一步将抽象字符转换为用户感知字符。

有许多不同的编码，为了使用这些编码将数据转换为抽象字符，您必须知道正确的解码方法。如果您不知道使用什么编码将代码点值转换为代码单元，则存储的值实际上毫无意义。

* * *

编码的一个重要含义是您需要知道对编码数据的特定操作是否有效或有意义。

例如，如果您想获取字符串的“大小”，您是在计算字节数、代码单元、抽象字符还是用户感知字符？`std::string::size()`计算代码单元，如果您需要不同的计数，则必须使用另一种方法。

再举一个例子，如果你拆分一个编码字符串，你需要知道你这样做的方式是否使得结果在该编码中仍然有效并且数据的含义没有无意中改变。例如，您可能会在属于同一代码点的代码单元之间进行拆分，从而产生无效的编码。或者，您可能会在代码点之间进行拆分，这些代码点必须组合起来以表示用户感知的字符，从而产生用户认为不正确的数据。

## 答案

今天`char`也`wchar_t`只能算代码单位。只有一个字节的事实`char`并不能阻止它表示占用两个、三个或四个字节的代码点。您只需`char`按顺序使用两个、三个或四个 s。这就是 UTF-8 的工作方式。同样，使用两个字节`wchar_t`表示 UTF-16的平台`wchar_t`在必要时只需连续使用两个字节。`char`和的实际值`wchar_t`并不单独表示 Unicode 代码点。它们表示由编码代码点产生的代码单元值。例如，Unicode 代码点 U+0400 被编码为 UTF-8 -> 中的两个代码单元`0xD0 0x80`。Unicode 代码点 U+24B62 同样被编码为四个代码单元`0xF0 0xA4 0xAD 0xA2`。

所以你可以`std::string`用来保存UTF-8编码的数据。

在 Windows`main()`上，不仅支持 ASCII，还支持任何系统`char`编码。不幸的是，Windows 不像`char`其他平台那样支持 UTF-8 作为系统编码，因此您只能使用 cp1252 等传统编码或您的系统配置使用的任何编码。但是，您可以使用 Win32 API 调用直接访问 UTF-16 命令行参数，而不是使用`main()`s`argc`和`argv`参数。见[`GetCommandLineW()`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms683156(v=vs.85).aspx)和[`CommandLineToArgvW`](https://msdn.microsoft.com/en-us/library/windows/desktop/bb776391(v=vs.85).aspx)。

`wmain()`的`argv`参数完全支持Unicode。`wchar_t`存储在Windows 中的 16 位代码单元是 UTF-16 代码单元。Windows API 本机使用 UTF-16，因此在 Windows 上使用起来非常容易。`wmain()`虽然是非标准的，所以依赖它不会是可移植的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T16:14:46.477

的大小和含义`wchar_t`是实现定义的。正如你所说，在 Windows 上它是 16 位，在类 Unix 系统上它通常是 32 位，但并非总是如此。

就此而言，允许编译器做自己的事情并选择`wchar_t`与系统所说的不同的大小——它只是与系统的其余部分不兼容 ABI。

C++11 提供了`std::u32string`，用于表示 unicode 代码点的字符串。我相信足够新的微软编译器包括它。由于 Microsoft 的系统函数需要 16 位宽字符（又名 UTF-16le），而不是 32 位 unicode 代码点（又名 UTF-32、UCS-4），因此它的用途有限。

不过，您提到了 UTF-8：UTF-8 编码的数据可以存储在常规的`std::string`. 当然，由于它是可变长度编码，因此您无法通过索引访问 unicode 代码点，您只能通过索引访问字节。但是您通常会编写代码而不需要通过索引访问代码点，即使使用`u32string`. Unicode 代码点与可打印字符（“字形”）不对应 1-1，因为在 Unicode 中存在组合标记，所以在学习编程时，您使用字符串玩的许多小技巧（反转它们，搜索子字符串）无论您将 Unicode 数据存储在什么位置，都不会那么轻松地使用它。

正如你所说，这个角色是\u24B62。它被 UTF-8 编码为一系列*四个*字节，而不是三个：F0 A4 AD A2。在 UTF-8 编码数据和 unicode 代码点之间进行转换是很费力的（诚然，不需要大量的工作，库函数会为您完成）。最好将“编码数据”和“Unicode 数据”视为分开的东西。您可以使用任何您认为最方便的表示，直到您需要（例如）将文本呈现到屏幕上。此时，您需要将其（重新）编码为您的输出目的地可以理解的编码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-28T16:20:26.000

Windows 使用[UTF-16](http://en.wikipedia.org/wiki/UTF-16)。U+0000 到 U+D7FF 和 U+E000 到 U+FFFF 范围内的任何代码点将被直接存储；根据 UTF-16 编码规则，这些范围之外的任何值都将被拆分为两个 16 位值。

例如 0x24B62 将被编码为 0xd892,0xdf62。

您可以按照您喜欢的任何方式转换字符串以使用它们，但 Windows API 仍然需要并提供 UTF-16，因此这可能是最方便的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-28T16:26:58.530

> 在标准 C++ 中，我们有 char 和 wchar_t 来存储字符？char 可以存储 0x00 和 0xFF 之间的值。wchar_t 可以存储 0x0000 到 0xFFFF 之间的值

不完全的：

```
sizeof(char)     == 1   so 1 byte per character.
sizeof(wchar_t)  == ?   Depends on your system 
                        (for unix usually 4 for Windows usually 2). 
```

> Unicode 字符最多占用 4 字节空间。

不完全的。Unicode 不是一种编码。Unicode 是一个标准，它定义了每个代码点是什么，并且代码点限制为 21 位。前 16 位定义了代码明文上的字符位置，而后 5 位定义了字符所在的明文。

有几种 unicode*编码*（UTF-8、UTF-16 和 UTF-32 是最常见的）这是您在内存中存储字符的方式。三者之间存在实际差异。

```
    UTF-8：非常适合存储和运输（因为它很紧凑）
             不好，因为它是可变长度的
    UTF-16：几乎在所有方面都很糟糕
             它总是很大并且是可变长度的
             （不在 BMP 上的任何东西都需要编码为代理对）
    UTF-32：非常适合内存表示，因为它是固定大小的
             不好，因为每个字符需要 4 个字节，这通常是多余的

```

就我个人而言，我使用 UTF-8 进行传输和存储，使用 UTF-32 在内存中表示文本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-03T06:37:08.787

`char`并且`wchar_t`不是用于文本字符串的唯一数据类型。C++11 引入了新的`char16_t`和`char32_t`数据类型以及各自的 STL`std::u16string`和`std::u32string`typedef `std::basic_string`，以解决`wchar_t`在不同平台上具有不同大小和编码的类型的模糊性。 `wchar_t`在某些平台上是 16 位，适合 UTF-16 编码，但在其他平台上是 32 位，适合 UTF-32 编码。 `char16_t`特别是 16 位和 UTF-16，`char32_t`特别是 32 位和 UTF-32，在所有平台上。**

# xcode4.5 - Xcode 4.5 - 尾随空格

> ID：12643581
> 
> 赞同：6
> 
> 时间：2012-09-28T16:10:23.920
> 
> 标签：xcode4.5

最新版本的 Xcode (4.5) 应该从源文件中去除尾随空格。

但是当我保存一个在行尾带有一些空格的文件时，它们仍然存在。

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-08T19:11:33.247

好的，这就是问题所在。

如果您在行尾添加空格，Xcode 不会修剪尾随空格，将光标留在该行的末尾然后保存。

您需要将光标移出该行，然后保存。

在保存光标位置的同时修剪空白之间可能存在一些冲突？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-09T19:03:04.867

是的，提交 Xcode 编辑的代码会在 Git 中显示尾随空格。进入 Xcode 首选项 > 文本编辑：编辑（选项卡），您可以选择仅包含空白行。 ![在此处输入图像描述](../Images/e7a5e27504455a63bc81e9fdfb517ebc.png)

值得一提的是我目前的 Xcode 版本 v5.1。

现在，已经在 git 中上传的抱怨空格的代码呢？

好吧，在你的编辑器中找到 4 个空格（默认情况下在 Xcode 首选项 > 文本编辑 > 缩进中，缩进设置为 4 个空格，也可以更改）；并为那些没有任何代码的行手动替换为空字符串。您可以在其他编辑器（例如 TextWrangler）中进一步复制粘贴代码，以查看是否有任何空行只剩下 4 个空格。“Cmd + G”是“查找下一个”的快捷键，有助于迭代。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T07:14:23.503

从 Xcode 4.4 开始，空格将被自动修剪（默认）。我还建议激活 Include whitespace-only lines。

转到 Xcode > 首选项 > 文本编辑 > 编辑时

# javascript - 与共享的父母和孩子一起绘制整齐的图表

> ID：12643585
> 
> 赞同：2
> 
> 时间：2012-09-28T16:10:42.713
> 
> 标签：javascript, git, graph, tree, directed-graph

我正在开发一个 HTML 和 Javascript 应用程序，它将采用 git 树并将提交和合并显示为有向图（如 git log --graph）。我已经阅读了一些关于 Reingold-Tilford 整洁算法的内容，但它似乎不适用于具有共享父子节点的图。所需输出的示例（作为文本，但我正在查看 d3js 和 Raphael 等图形库）：

```
*   - 1 day ago
|
*   - 2 days ago
|\
| * - 3 days ago
|/
*   - 4 days ago
|
*   - 5 days ago 
```

是否有任何图书馆已经处理了这个问题？有没有这样的渲染图的例子（任何语言）？作为最后的手段，我想我会尝试从 git 本身（[https://github.com/git/git/blob/master/graph.c](https://github.com/git/git/blob/master/graph.c)）重现图形，尽管它有点密集。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:26:57.667

首先，查看 ruby​​gem Git：[http](http://rubygems.org/gems/git) ://rubygems.org/gems/git 这将为您节省很多工作。

其次，我尝试使用 d3.js，发现它非常复杂和强大。您打算创建的图表可以很好地使用它，甚至还有一个 d3_rails gem： [http ://rubygems.org/gems/d3_rails](http://rubygems.org/gems/d3_rails)

但是请记住，如果您只需要对几个形状进行简单的图形表示以显示最小的复杂性（没有向下钻取等），您可能会考虑使用 HTML5 的画布。非常易于使用，但缺乏 d3.js 的强大功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:53:09.703

在实现了我自己的相当糟糕的图表一段时间后，我听说了[GitLab](http://gitlabhq.com/)和他们的开源 GitHub 实现。他们有来自 GitHub 的“网络”图的类似实现，可以在他们的[存储库](https://github.com/gitlabhq/gitlabhq)中找到。

一些有问题的文件：

*   lib/gitlab/graph/commit.rb
*   lib/gitlab/graph/json_builder.rb
*   供应商/资产/javascripts/branch-graph.js

通过一些修改，我能够弄清楚他们如何实现他们的网络图，并使用他们的代码版本取得了巨大的成功。

# wcf - 使用 SSL 的传输/消息安全

> ID：12643587
> 
> 赞同：0
> 
> 时间：2012-09-28T16:10:50.723
> 
> 标签：wcf

当我可以为 WCF 服务实现传输/消息加密时，为什么需要 SSL 端口。

我的意思是消息将被加密。那么为什么要有 SSL 加密端口呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:16:56.767

您需要 SSL 安全性（也称为传输安全性）而不是消息级（即 WS-Security）安全性的原因有很多：

*   SSL 由比 WS-Security 协议更多的客户端/服务器实现
*   使用 SSL 不仅消息正文被加密，而且它的其他部分也被加密（例如标头和传输标头
*   一些端点不支持 WS-Security，例如那些使用`webHttpBinding`
*   根据平台的不同，SSL 加密（或其中的一部分）可能会在硬件中实现，从而提高效率
*   在开发过程中，使用 SSL 加密的消息比使用消息加密时更容易检查消息

在许多情况下，消息安全性比传输安全性更有趣，例如端到端加密（SSL 通过逐跳加密工作）。与往常一样，最佳解决方案将取决于您的方案。

# c# - 检查整数状态的回调函数

> ID：12643590
> 
> 赞同：0
> 
> 时间：2012-09-28T16:11:01.507
> 
> 标签：c#, windows-phone-7, callback

我正在为我的编程类制作一个 WP7 应用程序，我想实现一个回调函数来检查整数的状态，而不是调用该函数来显式检查它。整数在按下按钮时进行迭代，当它达到最大输入时，我希望有一个回调函数来检查它，但我不完全确定如何实现它。

```
private void Right_Button_Click(object sender, RoutedEventArgs e)
    {
        if (current_input <= MAX_INPUT)
        {
            user_input[current_input] = 3;
            current_input++;
            display_result();
        }

    }

    #endregion

    void display_result()
    {
        //will move alot of this to the a result page
        DateTime time_end = DateTime.Now;
        TimeSpan difference = time_end.Subtract(timer);
        time_stamp = difference.ToString();
        bool combination_error = true;
        if (current_input == 4)
        {
            for (int i = 0; i < MAX_INPUT; i++)
            {
                if (user_input[i] != combination[i])
                {
                    combination_error = false;
                    break;
                }
            }

            if (combination_error)
            {
                MessageBox.Show("Correct combination The timer is " + time_stamp);
            }
            else
            {
                MessageBox.Show("Wrong combination");
            }
        }
    } 
```

在我增加 current_input 之后，我现在显式调用显示结果我不想做的事情，而是为它创建一个回调函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:51:18.450

您不能真正将回调函数放在整数上，但是，您可以将整数公开为属性并从属性设置器调用函数。看这个例子：

```
private int _myInteger = 0;

private int MyInteger {
    get
    {
         return _myInteger;
    } 
    set 
    {
        _myInteger = value;
        if (_myInteger <= MAX_INPUT)
            MyCallBackFunction();
    }
}

private void Right_Button_Click(object sender, RoutedEventArgs e)
{
    MyInteger = MyInteger + 1;
    // Do your other stuff here
}

private void MyCallBackFunction()
{
    // This function executes when your integer is <= MAX_VALUE
    // Do Whatever here
    display_result();
} 
```

这样做是通过私有财产公开您的整数。只要您通过setter 设置属性（例如使用`MyInteger = MyInteger + 1;`语法），您就可以让setter 检查条件并执行您的回调函数。

# javascript - 如何将 d3.svg.axis 限制为整数标签？

> ID：12643591
> 
> 赞同：40
> 
> 时间：2012-09-28T16:11:01.413
> 
> 标签：javascript, d3.js, axis, labels, axis-labels

是否有可能限制图表上显示的 d3.svg.axis 整数标签的数量？以这张图为例。这里只有 5 种尺寸：`[0, 1, 2, 3, 4]`. 但是，也会显示`.5, 1.5, 2.5`和的刻度`3.5`。

![在此处输入图像描述](../Images/08a6a923488c57f851b2a60660a2bbb4.png)

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-09-28T16:20:58.833

您应该能够使用`d3.format`而不是为此编写自己的格式函数。

```
d3.svg.axis()
    .tickFormat(d3.format("d")); 
```

您还可以`tickFormat`在默认情况下自动使用轴的刻度。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-09-28T16:12:37.717

我已经意识到隐藏这些值就足够了，而不是完全排除。这可以使用`tickFormat`（https://github.com/mbostock/d3/wiki/Formatting#wiki-d3_format）来完成，如下所示：

```
d3.svg.axis()
    .tickFormat(function(e){
        if(Math.floor(e) != e)
        {
            return;
        }

        return e;
    }); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-16T07:46:30.960

as tickFormat的使用`d3.format("d")`可能不适用于所有情况（[请参阅此错误](https://github.com/mbostock/d3/pull/1512)）。在 Windows Phone 设备（可能还有其他设备）上，不精确的计算可能会导致记号不能正确检测为整数的情况，即“3”的记号可能在内部存储为 2.9999999999997，它`d3.format("d")`不是整数。

结果，轴根本不显示。这种行为在高达 10 的刻度范围内尤其明显。

一种可能的解决方案是通过指定 epsilon 值来容忍机器错误。这些值不必是精确的整数，但可能与下一个整数不同，直到 epsilon 范围（应该远低于您的数据错误）：

```
var epsilon = Math.pow(10,-7);

var axis = d3.svg.axis().tickFormat(function(d) {
    if (((d - Math.floor(d)) > epsilon) && ((Math.ceil(d) -d) > epsilon))
        return;
    return d;
} 
```

另一种解决方案，在其他线程中也提到过，是指定一个固定的滴答计数，然后将滴答（现在应该是“几乎”整数）四舍五入到最接近的整数。您需要知道数据的最大值才能使其工作：

```
var axis = d3.svg.axis().ticks(dataMax).tickFormat(d3.format(".0f")) 
```

# android - Android 无线 (OTA) 安装

> ID：12643595
> 
> 赞同：2
> 
> 时间：2012-09-28T16:11:15.250
> 
> 标签：android, installation, ota

我开发了一个 android .apk 文件，我需要把它放在我的网站上进行 OTA 安装（由于某些原因，我不能把它放在 Android Market 上）。这个想法是，我会将带有 .apk 文件链接的短信发送到 android 设备，然后单击应用程序应该开始下载和安装过程。目前，当我尝试时，这是一个两步过程 - 1\. 它下载 .apk 文件 2\. 我需要点击 .apk 文件来安装它。

无论如何要删除第 2 步（单击 .apk 文件进行安装）并通过单击 .apk 文件的 url 来下载并安装它（当然通过询问用户的所有必要许可，因此它不是安全威胁给用户）。

我在 Blackberry/Symbian/Winmo 上做过类似的事情，这只是一个步骤（单击链接下载并运行安装程序）所以我认为在 android 上也应该有一种方法。任何帮助，将不胜感激。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:26:03.323

简单的回答：没有。

如果您已经在用户的设备上运行了一个应用程序，您可以注册一个特殊的 URI 并自己下载并打开该文件。Android 本身没有这样的选项（出于显而易见的原因）。

# outlook - 构建与 Google 日历、Outlook 和 Apple 日历同步的日历 web 应用

> ID：12643597
> 
> 赞同：1
> 
> 时间：2012-09-28T16:11:28.253
> 
> 标签：outlook, sync, google-calendar-api, icalendar

我即将构建一个简单的 web 应用程序，它有几个任务，每个任务都有一个截止日期。

我希望这个 web 应用程序能够自动与 Google 日历、Outlook 和 Apple 日历同步 - 2 向集成将是一个加分项。

webapp 是在 LAMP 服务器上构建的。

从尽可能限制工作量的角度来看，我能解决这个问题的最聪明的方法是什么？

而且，这甚至可能吗？我找不到适用于 Outlook 或 Apple 日历的 API。

CalDev 是答案吗？是否有任何产品/软件可以自动执行此操作，因此我只需要与它同步，其余的就可以完成了吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-04T08:49:28.923

您可以执行以下操作：

*   使用 GCal API 将您的专有日历与 Google 日历同步（使其成为您的“主日历”）；如果您的应用程序可以生成有效的 ICS 文件，那么您可以将其直接导入 Google 日历。由于 Google 已停止使用此功能，您可以使用一些基于 WebDAV 的在线导入/导出服务（我用于此[Synqya](https://synqya.appspot.com)）
*   使用 WebDAV 访问 Google 日历，使用其日历订阅功能将 Outlook 和 Apple 日历与其同步（这是一种同步方式）。如果您需要安全访问 GCal 和 2-way 同步，则需要进一步的步骤。

# c# - 如何在 WinXP 上包含 Microsoft.Interop.Excel 版本 11，在 Win7 上包含版本 12？

> ID：12643600
> 
> 赞同：0
> 
> 时间：2012-09-28T16:11:37.563
> 
> 标签：c#, dll, preprocessor-directive

我知道预处理器指令在这里是合适的，基于这个问题： [Preprocessor directive in C# for importing based on platform](https://stackoverflow.com/questions/1313402/preprocessor-directive-c)

一个简单的复制粘贴

```
#if WIN64
    [DllImport("ZLIB64.dll", CallingConvention=CallingConvention.Cdecl)]
#else
    [DllImport("ZLIB32.dll", CallingConvention = CallingConvention.Cdecl)]
#endif 
```

在我的命名空间的开头没有工作，因为 Visual Studio 抱怨说

> 属性“DLLImport”在此声明类型上无效。它仅对“方法”声明有效

但是，更改`#else`行以`#elif WIN32`使其编译。

我如何将基于操作系统加载不同 DLL 的技术`Microsoft.Office.Interop.Excel`应用于版本 11 与版本 12 的特定情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:23:09.307

如果您想在编译时链接到一个特定版本（如您的示例所示） - 您需要有 2 个项目，这些项目将包含不同版本的 Interop 程序集并引用同一组源文件。

如果您想在运行时执行此操作并使用强类型对象，您需要包装您感兴趣的方法并通过您的自定义类/接口公开它们，因为互操作程序集不共享任何基类（兄弟而不是 11如您所愿，是 12 岁的父母）。

# git - 无法符号链接到 .git 目录

> ID：12643603
> 
> 赞同：2
> 
> 时间：2012-09-28T16:11:57.697
> 
> 标签：git, cygwin, githooks

这可能很愚蠢，但四处搜索我一直无法找到答案。我正在尝试为我的 git 项目设置预提交挂钩，以便脚本可以与源代码一起进行版本控制。

似乎支持符号链接以及实现此目的的方法。当我尝试使用 .git 目录中的任何内容时，我收到错误“没有这样的文件或目录”。.git 目录的设置方式有什么奇怪的吗？我现在正在通过 Windows 上的 cygwin 执行此操作，以防万一。

例如，我用来设置符号链接的脚本如下所示：

```
#/bin/bash

HOOK_NAMES="pre-commit post-commit"
THIS_SCRIPT_DIR=$(dirname $0)
HOOK_DIR=$THIS_SCRIPT_DIR/../.git/hooks

for hook in $HOOK_NAMES; do
    ln -s -f $THIS_SCRIPT_DIR/git-hooks/$hook $HOOK_DIR/$hook
done 
```

谢谢，

====

跟进：这似乎是 Cygwin 的一个问题，尽管我无法找到解释它的文档。这在 Linux 和 OS X 上运行良好。Cygwin 在隐式隐藏文件夹（. 前缀）中创建符号链接时遇到问题。如果有人知道为什么我会很乐意将该解释标记为答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-02-10T18:33:15.427

我不知道为什么这在 Cygwin 中不起作用（对我来说似乎是一个错误），但如果其他人有同样的问题，我可以通过在 .git 文件夹中创建符号链接来解决它。因此，例如，您可以从命令行转到 .git/hooks 文件夹：

```
> cd .git/hooks 
```

然后创建链接

```
> ln -s ../../git-hooks/pre-commit pre-commit 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:42:11.557

您似乎正在尝试从存储库本身符号链接*到*您的。`.git/hooks`我认为 Git 不支持这一点，这可以解释您遇到的错误。

[这个答案](https://stackoverflow.com/questions/2050450/git-hooks-management)提出了其他方法，其中大多数建议采用其他方法（`.git/hooks` *作为*符号链接）。你可能会找到最适合你的。

# java - 不知道表大小时如何在 HQL 中执行限制查询？

> ID：12643606
> 
> 赞同：1
> 
> 时间：2012-09-28T16:12:01.517
> 
> 标签：java, sql, hibernate, hql

> **可能重复：**
> [如何在 HQL 中进行限制查询](https://stackoverflow.com/questions/1239723/how-do-you-do-a-limit-query-in-hql)

我有一张大但未知大小的桌子 A。我需要从表中分批检索结果，即一次 100 个，并对它们执行操作。为此，我有一个变量 m，以便我可以在循环中执行查询“SELECT * from A LIMIT m,100”的 HQL 等效项，该循环将 m 迭代为 1、101、201，... 等等。循环的终止条件是什么？在 m > 表中的行数的条件下执行上述查询会产生什么结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:22:34.127

首先使用 select count(*) 查询，这将为您提供记录总数。现在你编写java代码来相应地设置限制。(count/m) int = x= 完整批次的数量和 count-x*m = 最后批次的行数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:40:52.730

您遇到的问题更多地称为分页。

你的问题是你可以从一个表中检索多少页？

您必须知道页数才能使用分页。

要设置页数，您需要执行具有相同 FROM 子句但只有`SELECT count(*) FROM ...`. 这将永远给你正确的答案。

* * *

如果你不能或不想使用额外的语句。然后你应该作为页面的数据库，直到结果不为空。因此，您对第 1 页、第 2 页、...第 n 页执行语句，直到结果大小小于页面大小。

```
int pageSize = 100;
int page     = 1;  
do {     
  currentPage = loadPage(page, pageSize);
  page++;
} while(currentPage.size() == pageSize); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:29:20.600

我建议使用休眠函数 setFirstResult() 和 setMaxResults() 来实现您想要的结果，例如：

```
 Query query= session.createQuery("SELECT * from A");
    int resultSize = 100;
    List<?> pagedResults = null;
    //use any approriate number for iterations or do a result count first to get the expected result size
    for(int m=0; ; m++){ 
        pagedResults = (List<?>)query.setFirstResult(m*resultSize).setMaxResults((m+1)*resultSize).list();
        //do your processing
        if(pagedResults.isEmpty() || pagedResults.size() <resultSize){
            break; //no further iterations required
        }
    } 
```

setMaxResults() 仅限制结果大小。如果可用记录较少，您将仅在结果中收到这些记录。在“if”条件下添加以避免任何不必要的迭代。

希望这可以帮助！！

# iphone - 改变 ViewController 的过渡方向？

> ID：12643607
> 
> 赞同：2
> 
> 时间：2012-09-28T16:12:07.797
> 
> 标签：iphone, ios, xamarin.ios, monodevelop, monotouch.dialog

> **可能重复：**
> [如何在基于导航的应用程序中更改推送和弹出动画](https://stackoverflow.com/questions/2215672/how-to-change-the-push-and-pop-animations-in-a-navigation-based-app)

使用 MonoTouch 和 MonoTouch.Dialog，我将 a`DialogViewController`推到 a 上 `UINavigationController`，当我这样做时，它会使当前显示的屏幕从右向左移动。我想知道如何扭转这种情况，使当前屏幕从左到右“推开”，就像按下后退按钮一样。我的代码如下，其中 _root 是 RootElement。

```
_viewController = new DialogViewController(_root, false);
_navController.PushViewController(_viewController, true); 
```

编辑：我尝试过使用 _viewController.ModalTransitionStyle ，如果这些信息有帮助，则无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:20:42.373

您可以通过搜索 Stack Overflow 找到答案。例如这里： [如何在基于导航的应用程序中更改推送和弹出动画](https://stackoverflow.com/questions/2215672/how-to-change-the-push-and-pop-animations-in-a-navigation-based-app)

```
MainView *nextView = [[MainView alloc] init];
[UIView animateWithDuration:0.75
                         animations:^{
                             [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
                             [super pushViewController:nextView animated:NO];
                             [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight forView:self.navigationController.view cache:NO];
                         }]; 
```

这很容易在 MonoTouch 中翻译，并会变成类似（未经测试）：

```
UIView.Animate(0.75f, 0f, UIViewAnimationOptions.CurveEaseIn, delegate {
                navController.PushViewController(...);
                UIView.SetAnimationTransition(UIViewAnimationTransition.FlipFromRight, navController.View, false);
            }, null); 
```

# html - 我应该在哪个元素中附上一个 的评论？

> ID：12643608
> 
> 赞同：19
> 
> 时间：2012-09-28T16:12:07.737
> 
> 标签：html, semantic-markup

我正在开发一个实现 Disqus 评论的博客，并且我正在努力尽可能多地使用 HTML5 语义标记。

这是一个例子`<article />`（本身在 a 中`<section />`），相当简单：

```
 <article class="post">
    <header>
      <h2>Title</h2>
      <p class="posted-on">Posted on <time datetime="2012-07-28T13:00:24+01:00">July 28th 2012</time>.</p>
    </header>
    <p>Lorem ipsum dolor sit amet...</p>
    <p>Lorem ipsum dolor sit amet...</p>
    <!-- blog comments -->
  </article> 
```

使用上述结构，我不确定在哪里整合文章的评论。

*   A[`<footer />`](http://dev.w3.org/html5/spec/the-footer-element.html#the-footer-element)显然不合适（“页脚元素没有对内容进行分段；它没有引入新的部分。”）
*   Disqus 使用异步 JavaScript 创建一个`<iframe />`以包含评论小部件，因此 a`<p />`似乎也不合适。

我是否过度思考语义标记的事情：最好将其粘贴到 a 中`<div />`而不用担心它？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-29T00:34:18.893

[HTML5 规范](http://www.w3.org/TR/2013/CR-html5-20130806/sections.html#the-article-element)中有一个带有评论的博客文章的示例。在我看来，这是有道理的。

您的示例可能如下所示：

```
 <article class="post">
    <header>
      <h1>Title</h1>
      <p class="posted-on">Posted on <time datetime="2012-07-28T13:00:24+01:00">July 28th 2012</time>.</p>
    </header>
    <p>Lorem ipsum dolor sit amet...</p>
    <p>Lorem ipsum dolor sit amet...</p>

    <section>
      <h1>Comments</h1>

      <article><!-- comment 1--></article>
      <article><!-- comment 2--></article>
      <article><!-- comment 3--></article>

    <section>

  </article> 
```

* * *

旁注：我认为您的 " `posted-on`" 更适合 a[`footer`](http://www.w3.org/TR/2013/CR-html5-20130806/sections.html#the-footer-element)而不是 a [`header`](http://www.w3.org/TR/2013/CR-html5-20130806/sections.html#the-header-element)。所以你`header`可以省略，因为它只包含标题。因此，您的示例可能如下所示：

```
 <article class="post">

    <h1>Title</h1>

    <footer class="posted-on">Posted on <time datetime="2012-07-28T13:00:24+01:00">July 28th 2012</time>.</footer>

    <p>Lorem ipsum dolor sit amet...</p>
    <p>Lorem ipsum dolor sit amet...</p>

    <section>
      <h1>Comments</h1>

      <article><!-- comment 1--></article>
      <article><!-- comment 2--></article>
      <article><!-- comment 3--></article>

    <section>

  </article> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-28T16:15:26.330

您可以将其`<section>`作为. 但是，如果您使用的是 Disqus，我猜您使用的任何元素都无关紧要。我认为它不属于文章内容。也许一个代替？`<div>``<section>``<article>``<aside>`

请记住，在语义方面，没有任何硬性规定。只要您的文档以有意义的方式进行结构化和概述，这才是最重要的。

# mongodb - 使用 Neo4j 和 MongoDB 的 Spring 数据

> ID：12643609
> 
> 赞同：1
> 
> 时间：2012-09-28T16:12:15.443
> 
> 标签：mongodb, cross-domain, neo4j, spring-data

我快要发疯了，我花了很多时间尝试使用**Neo4J**的 spring-data ，相比之下，使用**MongoDB**的 spring-data 就像在公园里散步一样。

***我的目标：***
1）使用 spring-data 来管理两个数据存储 Mongo、Neo4j。（如果我错了，请纠正我，但是这两个没有 spring-data 跨数据存储支持，这意味着我将为每个存储使用不同的域实体）
2）使用 Neo4J 嵌入式图。
3) 将能够使用一些客户端（如 Web 管理员）监控图形。

所以我从[良好的关系 spring-data 示例](http://static.springsource.org/spring-data/data-neo4j/docs/2.0.0.RELEASE/reference/html/)开始 ，其中使用：

```
 POM
       <dependency>
          <groupId>org.springframework.data</groupId>
           <artifactId>spring-data-neo4j</artifactId>
          <version>2.0.0.RELEASE</version>
       </dependency>
       XML
       <neo4j:config storeDirectory="data/graph.db"/> 
```

所以我的第一个问题是如何在该配置中监控图形，在哪个客户端？
因此，我阅读了更多内容，并使用[Neo4j Web Admin 进行嵌入式图形配置](http://www.cakesolutions.net/teamblogs/2012/05/23/enabling-neo4j-web-admin-tool-on-the-embedded-server-using-spring-data/)

我跟着每一步都试过了，砰！

```
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.haze.server.repository.mongo.ProfileRepository com.haze.server.services.ProfileServices.profileRepository; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'profileRepository': FactoryBean threw exception on object creation; nested exception is java.lang.NoSuchMethodError: org.springframework.data.repository.core.RepositoryMetadata.getDomainClass()Ljava/lang/Class;
at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
... 39 more
 Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'profileRepository': FactoryBean threw exception on object creation; nested exception is java.lang.NoSuchMethodError: org.springframework.data.repository.core.RepositoryMetadata.getDomainClass()Ljava/lang/Class;
at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:149)
at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.getObjectFromFactoryBean(FactoryBeanRegistrySupport.java:102)
at org.springframework.beans.factory.support.AbstractBeanFactory.getObjectForBeanInstance(AbstractBeanFactory.java:1442)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:305)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:876)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:818)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:735)
at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
... 41 more
  Caused by: java.lang.NoSuchMethodError: org.springframework.data.repository.core.RepositoryMetadata.getDomainClass()Ljava/lang/Class;
at org.springframework.data.mongodb.repository.support.MongoRepositoryFactory.getTargetRepository(MongoRepositoryFactory.java:84)
at org.springframework.data.repository.core.support.RepositoryFactorySupport.getRepository(RepositoryFactorySupport.java:137)
at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.getObject(RepositoryFactoryBeanSupport.java:125)
at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.getObject(RepositoryFactoryBeanSupport.java:41)
at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:142)
... 49 more 
```

长话短说，我发现加载弹簧上下文的唯一版本配置是

```
 <spring.data.mongo.version>1.0.4.RELEASE</spring.data.mongo.version>
   <neo4j.version>1.6</neo4j.version>
   <spring-data-neo4j.version>2.0.1.RELEASE</spring-data-neo4j.version> 
```

如果我添加下面的依赖项，如在文章中指定它会崩溃。

```
 <spring-data-commons-core.version>1.3.0.RELEASE</spring-data-commons-core.version> 
```

好的，所以我在使用 neo4j 嵌入式图形和服务器包装器数小时后让它工作，以便使用 mongo 作为我的主要数据存储来监视来自 Web 管理员的图形。

使用旧版本的 neo4j 服务器包装器（1.6 版本是唯一有效的）有点高兴但悲伤的原因，我有动力开始通过 spring-data 使用图表。

所以我得到了最基本的节点实体：

```
@NodeEntity
public class ProfileNode {
@GraphId
private Long id;
@Indexed(unique = true)
private String pid = null;
} 
```

尝试了一些基本操作：

```
 // save node - OK
        ProfileNode node = new ProfileNode();
        node.setPid("44ed79b3ea8a99117aa601b16e916ddr");
        ProfileNode profile = graphRepo.save(node);

        // return NULL
        node = graphRepo.findByPropertyValue("pid",
                "44ed79b3ea8a99117aa601b16e916ddr");
        // throwing exception -    java.lang.UnsupportedOperationException:read only index                 
        graphRepo.delete(profile); 
```

基本上我尝试过的几乎所有基本操作都对我不起作用。

我不知道问题是因为我的混杂配置还是我做错了什么在我的代码中，有人可以帮我配置我的应用程序，或者让我知道为什么通过 spring 数据进行最基本的操作不起作用我？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T08:24:12.900

你真的应该升级到 SDN 2.1.RC4，它会在几周后作为 GA 发布。

其次，这里有一些代码可以帮助您入门：[https ://github.com/SpringSource/spring-data-neo4j/blob/master/spring-data-neo4j/src/test/java/org/springframework/data/neo4j /repository/DerivedFinderTests.java](https://github.com/SpringSource/spring-data-neo4j/blob/master/spring-data-neo4j/src/test/java/org/springframework/data/neo4j/repository/DerivedFinderTests.java) - 如果您不喜欢派生的查找器，您可以为 findByPropertyValue 添加一个测试，但至少使用该单个文件可以开箱即用，即您可以消除 Spring 配置作为错误来源。

对于跨存储：我认为 MongoDB 的跨存储没什么意义，对我来说，跨存储就是跨多个数据源的事务。使用 MongoDB + Neo，我只需构建不同的存储库，在应用程序级别上就足以同时使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T21:55:44.387

如 Lasse 所说，请更新到 2.1.RC4。

关于使用带有 SDN 的嵌入式服务器，[文档](http://static.springsource.org/spring-data/data-graph/snapshot-site/reference/html/#d5e1706)中有描述。

您的存储库是什么样的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T14:31:19.800

你必须有`spring-data-mongodb-1.1.0.RC1`和`spring-data-neo4j-2.1.0.RC4`。两者具有相同的`spring-data-commons-core`依赖关系。

[spring-data 与 neo4j + mongo 版本冲突](https://stackoverflow.com/questions/12698204/spring-data-with-neo4j-mongo-version-conflicts)

# git - 如何漂亮地打印出 git-diff 输出？

> ID：12643615
> 
> 赞同：21
> 
> 时间：2012-09-28T16:12:44.300
> 
> 标签：git, printing, diff, git-diff

对于我即将发表的学士论文，我需要打印出论文附录的 git-diff 输出。我真的很喜欢 的输出`git diff --color-words`，但我完全不知道如何在我的 Mac 上将这个 - 彩色并包含行号 - 带到一张纸上。我知道有像[SourceTree](http://www.sourcetreeapp.com/)这样的工具，但即使使用这些工具，我似乎也无法从单个文件的差异中做出漂亮的打印。

好吧，我很确定我不是唯一一个遇到这个问题的人，我找到了一些建议的 ansi2html 解决方案，但它们似乎不适用于我的 git 版本（1.7.10.2）。我还考虑过简单地打印 Github 提交页面（这真的很漂亮，有点像我需要的），但是当我尝试打印它时，浏览器会自动删除所有颜色和格式。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-12-31T17:50:47.493

使用`aha`. 您可以在 ubuntu 中使用`sudo apt-get install aha`. 另请参阅 [https://github.com/theZiz/aha](https://github.com/theZiz/aha)。

```
$ git diff --color-words | aha > index.html
$ firefox index.html 
```

然后 Firefox 应该能够以彩色打印它。查看`aha --help`其他一些很酷的选项。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-03-17T14:26:38.140

我刚刚尝试了一个托管在 Github 上的 npm 包：[pretty-diff](https://github.com/scottgonzalez/pretty-diff)

您可以通过 npm 安装它并像使用 一样运行它`git-diff`，例如：

```
pretty-diff HEAD^ 
```

将打开一个新的浏览器窗口，您可以将其另存为 html。我试图在不同的浏览器中再次打开它，但仍然显示颜色。您还可以使用您的 github 帐户来创建 Gist 并分享它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-06T18:34:56.070

由于您使用的是带有终端应用程序的 Mac，因此它就像从终端剪切和粘贴到另一个应用程序一样简单。

# mysql - Google Docs 电子表格中的错误“无法建立数据库连接”

> ID：12643617
> 
> 赞同：2
> 
> 时间：2012-09-28T16:13:05.097
> 
> 标签：mysql, google-apps-script, google-docs, xeround

我正在将 xeround 用于 MySQL 数据库，在过去的一年中，我一直在使用 Google Docs 电子表格中的 Google Apps 脚本连接到它。现在突然连不上了。我检查了用户名和密码，并仔细检查了实例信息。我联系了 xeround 以查看 MySQL 数据库是否存在问题，他们说一切正常。我可以使用相同的用户名和密码通过 phpMyAdmin 连接数据库。这是我在 Google Docs 电子表格中的代码：

```
var connectionstring = "jdbc:mysql://instance276.db.xeround.com.:3859/pantalog";
var conn = Jdbc.getConnection(connectionstring, "xxxxxxxxxx", "xxxxxxxxx");
var stmt = conn.createStatement(); 
```

我得到的错误是“无法建立数据库连接。检查连接字符串、用户名和密码。”

Google 是否对 JDBC 进行了一些我不知道的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T08:38:09.670

首先，那个连接字符串中有一个错字，你不应该有那个“。” 在端口号之前...

```
var connectionstring = "jdbc:mysql://instance276.db.xeround.com.:3859/pantalog"; 
```

应该

```
var connectionstring = "jdbc:mysql://instance276.db.xeround.com:3859/pantalog"; 
```

万一这只是一个错字...

我最近也遇到了同样的问题，认为这实际上是一个 DNS 问题！（是的，我知道这听起来是不可能的）。

使用我的 MySQL 服务器的 DNS 条目时，我得到了同样的错误。

然后我使用谷歌的DNS服务器（8.8.8.8）进行nslookup并获取该IP地址，并在连接字符串中使用它......

该 DNS 名称解析为 107.22.255.231

**然后它工作**

奇怪，我知道，但试一试。

另外，我希望这不是您在帖子中的真实用户名和密码 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T14:28:09.573

这个解决方案对我有用。用连接字符串中的 IP 替换主机名可解决此问题。似乎 JDBC 中的解析器已损坏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-25T21:59:43.580

我发现 Google Sheets 中的 JDBC 有很多错误，所以我构建[了 SeekWell](https://seekwell.io/?ref=so)，它可以让您自动将数据从 MySQL 发送到 Sheets，并且还可以将来自 Sheets 的更改同步回数据库。您可以安排每天、每小时或每五分钟刷新一次。

免责声明：我建造了这个。

# spring - 在 Spring AOP 中抛出异常

> ID：12643620
> 
> 赞同：9
> 
> 时间：2012-09-28T16:13:10.057
> 
> 标签：spring, aop, spring-aop

每次阅读 Spring AOP 官方文档（[链接](http://static.springsource.org/spring/docs/3.0.x/reference/aop-api.html)）时，我都会对 RuntimeExceptions 的建议行为感到困惑。有人会检查我对以下建议的理解是否正确吗？

@前

*   Advice throws Exception = Target（未执行） Advice（已执行）
*   Target throws Exception = Target (executed) Advice (executed)

@AfterReturning

*   Advice throws Exception = Target (executed) Advice (executed)
*   Target throws Exception = Target（已执行） Advice（未执行）

@AfterThrowing

*   Advice throws Exception = Target（已执行） Advice（未执行）
*   Target throws Exception = Target (executed) Advice (executed)

@后

*   Advice throws Exception = Target (executed) Advice (executed)
*   Target throws Exception = Target (executed) Advice (executed)

@大约

*   Advice throws Exception = Target (executed) Advice (executed)
*   Target throws Exception = Target (executed) Advice (执行到 point.proceed())

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-28T17:42:38.817

这就是我通常看待它的方式。

```
try {
    //@Before
    method();
    //@AfterReturning
} catch(Throwable t) {
    //@AfterThrowing
} finally {
    //@After
} 
```

`@Around`是一种自己的野兽。由于您选择何时调用目标，因此您可以捕获任何`Exception`它可能`throw`。因此，您可以轻松地将调用包装在 a 中`try-catch-finally`，并可以访问前面提到的任何和所有连接点。

我假设当您说“已执行”时，您的意思是“已执行到引发异常的程度”。

对您来说可能很重要的另一件事是`@Order`注释。较高值`@Order`的 's 首先出现在前面，它们在后面向后工作。在将多个建议组合到同一个目标时，请确保牢记这一点。

# objective-c - 菜单栏应用程序：桌面切换错误

> ID：12643622
> 
> 赞同：0
> 
> 时间：2012-09-28T16:13:10.993
> 
> 标签：objective-c, xcode, macos, cocoa

我已经构建了一个可可 mac 应用程序，它是一个菜单栏应用程序。当你点击它时，它会打开一个 NSWindow。

问题：
1\. 当我在 Desktop1 上打开菜单栏应用程序时。
2.然后转到Desktop2并通过单击菜单栏图标打开应用程序，应用程序打开，但桌面移回Desktop1！

这是一件相当棘手的事情。

我感谢您的帮助 ！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T02:13:59.363

尝试将您的[窗口集合行为](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/doc/uid/20000013-SW24)设置为`NSWindowCollectionBehaviorCanJoinAllSpaces`这样，它不会被限制在单个桌面上。

```
[newWindow setCollectionBehavior:NSWindowCollectionBehaviorCanJoinAllSpaces]; 
```

`NSWindowCollectionBehaviorMoveToActiveSpace`也应该工作，但有点挑剔。

# django - 如何使用 (admin.ModelAdmin) 为投票应用程序创建一个类

> ID：12643629
> 
> 赞同：1
> 
> 时间：2012-09-28T16:13:23.463
> 
> 标签：django

我正在通过[http://lightbird.net/dbe/todo_list.html](http://lightbird.net/dbe/todo_list.html)上的 Django 教程工作。我完成了 Django 的官方教程。当我尝试同步时

```
from django.db import models
from django.contrib import admin

class Item(models.Model):
    name = models.CharField(max_length=60)
    created = models.DateTimeField(auto_now_add=True)
    priority = models.IntegerField(default=0)
    difficult = models.IntegerField(default=0)

class ItemAdmin(admin.ModelAdmin):
    list_display = ["name", "priority", "difficult", "created", "done"]
    search_fields = ["name"]

admin.site.register(Item, ItemAdmin) 
```

终端返回一个错误，说管理员未定义。我究竟做错了什么？我如何定义管理员？

更新：我添加了现在看起来的整个模型文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:33:29.670

[The Django documentation](https://docs.djangoproject.com/en/dev/ref/contrib/admin/) lists multiple steps that need to be done to activate the admin site:

> 1.  **Add 'django.contrib.admin' to your INSTALLED_APPS setting**.
>     
>     
> 2.  The admin has four dependencies - **django.contrib.auth, django.contrib.contenttypes, django.contrib.messages and django.contrib.sessions**. If these applications are not in your INSTALLED_APPS list, add them.
>     
>     
> 3.  Add django.contrib.messages.context_processors.messages to TEMPLATE_CONTEXT_PROCESSORS and MessageMiddleware to MIDDLEWARE_CLASSES. (These are both active by default, so you only need to do this if you’ve manually tweaked the settings.)
>     
>     
> 4.  Determine which of your application’s models should be editable in the admin interface.
>     
>     
> 5.  For each of those models, optionally create a ModelAdmin class that encapsulates the customized admin functionality and options for that particular model.
>     
>     
> 6.  Instantiate an AdminSite and tell it about each of your models and ModelAdmin classes.
>     
>     
> 7.  Hook the AdminSite instance into your URLconf. lists a couple of things that you must do the enable Django's admin site.

If you haven't done the first two items, `syncdb` might complain because it can't find the admin app itself.

# java - 对于 Java 中的大量输入，解析 long 失败

> ID：12643631
> 
> 赞同：1
> 
> 时间：2012-09-28T16:13:32.563
> 
> 标签：java, string, long-integer

我正在尝试将一个非常大的输入读取为字符串，然后将其转换`long`为如下所示：[该程序适用于短输入]

输入是两个`int`用空格隔开，例如：`"1248614876148768372675689568324619856329856295619253291561358926935829358293587932857923857934572895729511 413241"`

我的代码：

```
import java.io.*;
import java.math.*;
import java.util.*;
public class Solution {
    public static void main(String args[] ) throws Exception {
        Solution obj = new Solution();
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        int T = Integer.parseInt(br.readLine());
        String input[]=new String[T];
        for (int i=0;i<T;i++) {
            input[i] = br.readLine();
            }
        for (int i=0;i<T;i++){
            StringTokenizer st = new StringTokenizer(input[i]," ");
                BigInteger N = new BigInteger(st.nextToken());
                BigInteger P = new BigInteger(st.nextToken());
                System.out.println(obj.result(N,P));
            }
        }
    }

    public BigInteger result(BigInteger N, BigInteger P){
        BigInteger temp=1;
        BigInteger c=0;
        for (BigInteger i=0;i<=N;i++){
            //System.out.println(nck(N,i));
            if ((nck(N,i)%P) ==0)
                c++;
        }
    return c;
    }

    public BigInteger nck(BigInteger N, BigInteger k){
        if (k==0)
            return 1;
        else {
            BigInteger temp=1;
            BigInteger y=1;
            BigInteger z=N;
                while(k>=1){
                temp=temp*z/y;
                y++;
                z--;
                k--;
            }
        return temp;
        }
    }
} 
```

我得到一个`java.lang.NumberFormatException`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T16:15:01.717

你不能把这个字符串解析成一个长字符串，它太大了（大于[Long.MAX_VALUE](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Integer.html#MAX_VALUE)），你需要[BigInteger](http://docs.oracle.com/javase/1.4.2/docs/api/java/math/BigInteger.html)：

```
BigInteger bi = new BigInteger(st.nextToken()); 
```

**在您的编辑之后：**

不要尝试迭代 bigInteger ：如果它太大而无法放入 long 中，那么循环对于您的时间来说太长了。将其与合理的限制进行比较，如果它更小，则将其作为 int 获取并进入您的循环：

```
 BigInteger MAX = new BigInteger("1000000");
    if (bi.compareTo(MAX)<0) {
        int N = bi.intValue();
        for (int i=0; i<N; i++) {
            Test...
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T16:14:59.197

如果抛出`NumberFormatException`因为`248614876148768372675689568324619856329856295619253291561358926935829358293587932857923857934572895729511`大于`Long.MAX_VALUE`（即`9223372036854775807`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:17:25.203

值太大，`long`无法保存。[原始数据类型](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)

我想知道你想用这么大的整数做什么，但你可能正在寻找的是一个[`BigInteger`](http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html).

> 不可变的任意精度整数。所有操作的行为都好像 BigIntegers 以二进制补码表示法表示（如 Java 的原始整数类型）。BigInteger 提供了与 Java 的所有原始整数运算符的类似物，以及 java.lang.Math 中的所有相关方法。此外，BigInteger 还提供模算术、GCD 计算、素数测试、素数生成、位操作和一些其他杂项操作的操作。

它提供了数学运算的方法。还应该注意，由于它是不可变的，因此您对 a 执行的任何操作都会`BigInteger`返回一个新的`BigInteger`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:19:17.953

正如其他人指出的那样，值太大了，`long`但是另一个问题是正在转换的字符串中不能有空格。有一篇关于从字符串中删除空格的文章[here](https://stackoverflow.com/questions/5455794/removing-whitespace-from-strings-in-java)

“在（可选）负号和/或基数说明符（“0x”、“0X”、“#”或前导零）之后的字符序列被 Long.parseLong 方法解析为具有指示的基数（10， 16 或 8)。此字符序列必须表示正值，否则将引发 NumberFormatException。如果指定 String 的第一个字符是减号，则结果为否定。String**中不允许有空白字符**。" 从[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Long.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T16:54:00.960

请记住，当从 int 类型更改为 BigInteger 时，您处理的是对象而不是原始类型。BigInteger (String val) 可能是最有用的构造函数。

（IE）`BigInteger temp = new BigInteger("1");`

# ios - iOS 子类化 tableviewcell 返回 nil

> ID：12643635
> 
> 赞同：0
> 
> 时间：2012-09-28T16:13:49.340
> 
> 标签：ios, tableview, subclass, cell, tableviewcell

我正在尝试为我的表子类化 UITableViewCell，但单元格一直返回 nil。有谁知道为什么？谢谢。

**表视图代码：**

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";

TableViewCell *cell = (TableViewCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
JointCAD *currentCall = [[xmlParser calls] objectAtIndex:indexPath.row];

if (cell == nil)
{
    cell = [[TableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    NSLog(@"Nil = YES");
}

cell.callType = currentCall.currentCallType;

return cell;
} 
```

**子类代码：**

```
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
if (self = [super initWithStyle:UITableViewCellStyleDefault reuseIdentifier:reuseIdentifier]) {

    UIView *myContentView = self.contentView;

    label.text = callType;
    label.textColor = [UIColor blackColor];
    [label addSubview:myContentView];

}
return self;
} 
```

# jquery - 将backbone.js 集合与数据表集成

> ID：12643638
> 
> 赞同：0
> 
> 时间：2012-09-28T16:14:06.143
> 
> 标签：jquery, backbone.js, datatables

我正在使用backbone.js 创建一个单页应用程序。该页面将包含一个产品列表，我应该能够对列和多行选择功能进行排序。我想知道是否有一个示例显示如何将数据从骨干集合中输入到数据表中。因此，使用数据表功能我可以执行排序和多行选择。

# mysql - #1054 - 'where 子句'中的未知列'max.ACCESS_DATE_TIME'

> ID：12643639
> 
> 赞同：3
> 
> 时间：2012-09-28T16:14:12.187
> 
> 标签：mysql

为什么这不起作用？

```
SELECT `user_log`.`COMPUTER_NAME`, `user_log`.`LOCATION` 
FROM `user_log`, `user_log_max` as max
WHERE max.`USER_NAME` = `user_log`.`USER_NAME` AND max.`ACCESS_DATE_TIME` = `user_log`.`ACCESS_DATE_TIME` 
```

我收到以下错误：

```
#1054 - Unknown column 'max.ACCESS_DATE_TIME' in 'where clause' 
```

我试过去掉别名：

```
SELECT `user_log`.`COMPUTER_NAME`, `user_log`.`LOCATION` 
FROM `user_log`, `user_log_max`
WHERE `user_log_max`.`USER_NAME` = `user_log`.`USER_NAME` AND `user_log_max`.`ACCESS_DATE_TIME` = `user_log`.`ACCESS_DATE_TIME` 
```

这个错误->

```
#1054 - Unknown column 'user_log_max.ACCESS_DATE_TIME' in 'where clause' 
```

它正在去掉刻度线……为什么？

编辑：

```
user_log_max:
USER_NAME        varchar(20)      
ACCESS_DATE_TIME timestamp 
```

user_log 包含相同的列，以及更多的列，包括 COMPUTER_NAME 和 LOCATION

user_log_max 包含在 user_log 上发出此查询的所有数据

```
SELECT `USER_NAME`, MAX(`ACCESS_DATE_TIME`) FROM `user_log
GROUP BY `USER_NAME` 
```

本质上，我要做的是选择具有 MAX...GROUP BY 的列，而不是我的 GROUP BY 中的列。

编辑2：

这是我创建 user_log_max 的方式->

```
 CREATE TABLE `user_log_max`
SELECT `USER_NAME`, MAX(`ACCESS_DATE_TIME`) FROM `user_log`
GROUP BY `USER_NAME` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:31:34.640

In your `CREATE TABLE` query, you must supply an alias for the `MAX()` aggregate column:

```
 CREATE TABLE `user_log_max`
   SELECT
     `USER_NAME`, 
      /* Alias this calculated value as ACCESS_DATE_TIME */
      MAX(`ACCESS_DATE_TIME`) AS `ACCESS_DATE_TIME` 
   FROM `user_log`
   GROUP BY `USER_NAME` 
```

The way you had done it, the column name should be something like the whole string `MAX(ACCESS_DATE_TIME)`, which is obviously very confusing.

Now, you can query it as you attempted to do:

```
/* The column ACCESS_DATE_TIME now exists in user_log_max, so this will work */
SELECT `user_log`.`COMPUTER_NAME`, `user_log`.`LOCATION` 
FROM `user_log`, `user_log_max`
WHERE `user_log_max`.`USER_NAME` = `user_log`.`USER_NAME` AND `user_log_max`.`ACCESS_DATE_TIME` = `user_log`.`ACCESS_DATE_TIME` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-13T13:52:07.827

`where`将子句更改为`on`

```
SELECT `user_log`.`COMPUTER_NAME`, `user_log`.`LOCATION` 
FROM `user_log`, `user_log_max`
ON `user_log_max`.`USER_NAME` = `user_log`.`USER_NAME` AND `user_log_max`.`ACCESS_DATE_TIME` = `user_log`.`ACCESS_DATE_TIME`; 
```

# django - 您将表单定义放在 Django 中的什么位置？

> ID：12643643
> 
> 赞同：1
> 
> 时间：2012-09-28T16:14:21.820
> 
> 标签：django, django-forms

您“应该”在哪里将表单定义放在 Django 中，放在哪里`models.py`，`views.py`最重要的是为什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-28T16:16:18.280

表单定义应该`forms.py`放在同一个包中，并从那里引用。这是为了代码模块化。

# python - sqlalchemy postgresql 其中 int = 字符串

> ID：12643646
> 
> 赞同：12
> 
> 时间：2012-09-28T16:14:24.883
> 
> 标签：python, sqlite, postgresql, sqlalchemy

我对 postgresql 有 0 经验，并且正在使用 sqlalchemy 将一个用 python 编写的应用程序部署到带有 postgres 的服务器上。

对于开发，我使用了 sqlite 服务器。

事情进展得很顺利，但我遇到了一个不知道如何解决的问题。

我有三张看起来像这样的桌子

```
class Car(db.Model):
     id= db.Column(db.Integer, primary_key=True)
     ...

class Truck(db.Model):
     id= db.Column(db.String(32), primary_key=True)
     ...

class Vehicles(db.Model):
     id= db.Column(db.Integer, primary_key=True)
     type= db.Column(db.String) #This is either 'car' or 'truck'
     value= db.Column(db.String) #That's the car or truck id
     ... 
```

我有一个查询从`Vehicles`哪里选择`type = 'car' AND value = 10` 这是抛出一个错误： `sqlalchemy.exc.ProgrammingError: (ProgrammingError) operator does not exist: integer = character varying`

所以我想这是因为 `Car.id`它是一个 int 并且`Vehicle.value`是一个字符串..

如何在 sqlalchemy 中编写此查询？有没有办法编写它并使其与我的 sqlite 开发环境和 pgsql 生产兼容？

目前看起来像这样

`db.session.query(Vehicle).filter(Car.id == Vehicle.value)`

PS：卡车 id 必须是字符串，汽车 id 必须是 int。我对此没有控制权。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-28T16:26:31.283

只需转换为字符串：

```
db.session.query(Vehicle).filter(str(Car.id) == Vehicle.value) 
```

if`Car.id`是一个 int 的局部变量。

如果您需要在连接中使用它，请让数据库将其转换为字符串：

```
from sqlalchemy.sql.expression import cast

db.session.query(Vehicle).filter(cast(Car.id, sqlalchemy.String) == Vehicle.value) 
```

如果另一列中的字符串值包含数字*和可能的空格*，您可能必须考虑修剪，或者将字符串值转换为整数（并将整数列保留为整数）。

# c# - 在 c++ 中翻译 lambda 表达式 c#

> ID：12643647
> 
> 赞同：-10
> 
> 时间：2012-09-28T16:14:35.243
> 
> 标签：c#, c++, lambda, code-translation

我必须标准化范围 [-1;1] 中的值列表。我在 c# 中找到了这段代码，但我不知道这种语言。有人可以帮我用 C++ 翻译这个吗？

```
List<int> list = new List<int>{-5,-4,-3,-2,-1,0,1,2,3,4,5};
double scaleMin = -1; //the normalized minimum desired
double scaleMax = 1; //the normalized maximum desired

double valueMax = list.Max();
double valueMin = list.Min();
double valueRange = valueMax - valueMin;
double scaleRange = scaleMax - scaleMin;

IEnumerable<double> normalized = 
list.Select (i =>
    ((scaleRange * (i - valueMin))
        / valueRange)
    + scaleMin); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:20:43.450

编码...

```
IEnumerable<double> normalized = list.Select (i => ((scaleRange * (i - valueMin)) / valueRange) + scaleMin); 
```

...可以在没有像这样的 lambda 表达式的情况下重写（在 C# 中）...

```
IEnumerable<double> normalized = new List<double>();
for (var elem in list)
{
    normalized.Add(((scaleRange * (elem - valueMin)) / valueRange) + scaleMin);
} 
```

您应该能够将该算法翻译成您需要的任何语言。

# asp.net - 无法加载文件或程序集“Microsoft.TeamFoundation.WorkItemTracking.Client.Cache”或其依赖项之一

> ID：12643654
> 
> 赞同：20
> 
> 时间：2012-09-28T16:15:10.150
> 
> 标签：asp.net, azure

我正在开发一个与 TFS 交互的 Web 应用程序。当我将应用程序上传到 windows azure cloud 时，我收到此错误消息。

感谢您为解决此问题提供的意见。

下面粘贴的是我收到的错误消息

```
Server Error in '/' Application.
--------------------------------------------------------------------------------

Could not load file or assembly 'Microsoft.TeamFoundation.WorkItemTracking.Client.Cache' or one of its dependencies. An attempt was made to load a program with an incorrect format. 
  Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

 Exception Details: System.BadImageFormatException: Could not load file or assembly 'Microsoft.TeamFoundation.WorkItemTracking.Client.Cache' or one of its dependencies. An attempt was made to load a program with an incorrect format.

Source Error: 

 An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  

Assembly Load Trace: The following information can be helpful to determine why the assembly 'Microsoft.TeamFoundation.WorkItemTracking.Client.Cache' could not be loaded.

WRN: Assembly binding logging is turned OFF.
To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.
Note: There is some performance penalty associated with assembly bind failure logging.
To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog].

Stack Trace: 

[BadImageFormatException: Could not load file or assembly 'Microsoft.TeamFoundation.WorkItemTracking.Client.Cache' or one of its dependencies. An attempt was made to load a program with an incorrect format.]
   System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
   System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks) +567
   System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +192
   System.Reflection.Assembly.Load(String assemblyString) +35
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +123

[ConfigurationErrorsException: Could not load file or assembly 'Microsoft.TeamFoundation.WorkItemTracking.Client.Cache' or one of its dependencies. An attempt was made to load a program with an incorrect format.]
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +11568240
   System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +485
   System.Web.Configuration.AssemblyInfo.get_AssemblyInternal() +79
   System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +337
   System.Web.Compilation.BuildManager.CallPreStartInitMethods() +280
   System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +1167

[HttpException (0x80004005): Could not load file or assembly 'Microsoft.TeamFoundation.WorkItemTracking.Client.Cache' or one of its dependencies. An attempt was made to load a program with an incorrect format.]
   System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +11700976
   System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +141
   System.Web.HttpRuntime.ProcessRequestNotificationPrivate(IIS7WorkerRequest wr, HttpContext context) +4869205

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-30T16:22:52.070

这是因为，您的项目正在尝试在 64 位环境（天蓝色）中使用 32 位 dll

要解决此类问题，请使用以下给定命令创建启动脚本

将下面的启动脚本复制到文本文件并另存为“setup.cmd”。然后将此文件包含到您的 Web 角色项目中，设置“复制本地”=true 然后在 webrole 标记内给定启动命令下方打开您的 ServiceDefinition.csdef

```
<webrole > --your webrole
    <Startup>
              <Task commandLine="setup.cmd" executionContext="elevated" />
          </Startup>
</webrole > 
```

启动脚本粘贴在下面：

```
%windir%\system32\inetsrv\appcmd set config -section:system.applicationHost/applicationPools /applicationPoolDefaults.enable32BitAppOnWin64:"True" /commit:apphost 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-26T13:51:23.800

我通过从我的 asp.net Web 项目的 bin 文件夹中删除相应的 DLL 解决了这个问题。

谢谢并恭祝安康，

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-02-17T23:07:17.870

我通过在站点使用的应用程序池中设置选项来解决这个问题`Enable 32-Bit applications`。`True``Advanced Settings`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-28T16:31:23.547

BadImageFormat 异常几乎总是在 32 位 dll 尝试加载 64 位 dll 或 DLL 或可执行文件作为 64 位程序集加载之间的问题，但它包含 32 位功能或资源。

尝试将您的应用程序编译到 x86，反之亦然，让我知道它是如何工作的

# c# - 管理复合应用程序组件的工具/最佳实践？

> ID：12643659
> 
> 赞同：2
> 
> 时间：2012-09-28T16:15:25.260
> 
> 标签：c#, asp.net-mvc, mef, nuget, composition

我们正在构建一个基于[ASP.NET MVC 4](http://www.asp.net/mvc)和[微软新的轻量级组合容器](http://nuget.org/packages/Microsoft.Composition)的组合应用程序框架。我们的团队将基于此框架交付产品。然后，客户 IT 部门可以自由地将应用程序的某些部分换成他们自己开发的定制部分。在此过程中，客户会将我们的版本升级作为其支持合同的一部分。

我们遇到的困难在于包和依赖管理领域。NuGet 似乎是微软世界的事实上的标准。然而，它似乎专注于设计时的硬设置参考。在我们的场景中，我们几乎没有设计时依赖项，因为一切都是基于接口的。具体实现在运行时才知道，并且可以由客户更改。

是否有管理此类环境的工具或最佳实践？有没有人根据他们对这种情况的经验提出建议？

# c# - 关于 linq to sql lambda 表达式的新手，其中两个之后的语句包括

> ID：12643661
> 
> 赞同：0
> 
> 时间：2012-09-28T16:15:29.520
> 
> 标签：c#, linq, lambda

```
 var Query2 = from x in CoreDatabase.Set<tblPerson>()
                 .Include(a => a.tblApplicationInterface.Select(b => b.tblApplicationName)
                 .Where(c => c.AppplicationName == "MshHumanResources"))

                 select x; 
```

我得到包含路径表达式必须引用在类型上定义的导航属性。对引用导航属性使用虚线路径，对集合导航属性使用 Select 运算符。我只是想写

这里有用的东西：

```
Select * 
From tblPerson a INNER JOIN tblApplicationInterface b 
on a.id = b.id
INNER Join tblApplicationName c
ON b.fkid=c.id
Where b.ApplicationName like 'MshHumanResources' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:22:04.513

这不是如何[`Include`](http://msdn.microsoft.com/en-us/library/bb738708.aspx)工作的。您想[`join`](http://msdn.microsoft.com/en-us/library/bb311040.aspx)改用：

```
var Query2 = from a in CoreDatabase.Set<tblPerson>()
             join b in CoreDatabase.Set<tblApplicationInterface>() on a.id equlas b.id
             join c in CoreDatabase.Set<tblApplicationName>() on b.fkid equals c.id
             where c.AppplicationName == "MshHumanResources"
             select a; 
```

这只是从 A 中选择列 - 如果您想从其他表中选择列，请创建一个类来组合您需要的字段或使用匿名类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:22:54.597

试试这个：

```
var Query2 = CoreDatabase.Set<tblPerson>
                 .Include("tblApplicationInterface")
                 .Include("tblApplicationInterface.tblApplicationName")
                 .Where(x => x.ApplicationName == "MshHumanResources"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:24:22.287

可以直接说

```
var people = CoreDatabase.Set<tblPerson>().Where( p => 
p.tblApplicationInterface.tblApplicationName.ApplicationName == "MshHumanResources" ); 
```

如果我正确理解您的导航属性。这将选择应用界面的应用名称为 MshHumanResources 的人。

# python - 使用 Python 在 Neo4j 中执行批量添加/插入的最快方法？

> ID：12643662
> 
> 赞同：17
> 
> 时间：2012-09-28T16:15:37.377
> 
> 标签：python, neo4j, py2neo

当通过 py2neo for Python 使用 REST API 时，我发现 Neo4j 添加节点和关系/弧/边的速度很慢。我知道这是由于每个 REST API 调用都作为一个独立的事务执行。

具体来说，添加数百对具有它们之间关系的节点需要几秒钟，在 localhost 上运行。

在使用 Python 的同时显着提高性能的最佳方法是什么？

使用bulbflow 和Gremlin 会是构建批量插入事务的一种方式吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T00:48:27.900

有几种方法可以使用[py2neo](http://py2neo.org/)进行批量创建，每种方法只调用一次服务器。

1.  使用该`create`方法在单个批次中构建多个节点和关系。
2.  使用密码 CREATE 语句。
3.  使用新`WriteBatch`类（本周刚发布）手动制作一批节点和关系（这真的只是1的手动版）。

如果您有一些代码，我很乐意查看它并就性能调整提出建议。还有很多测试你可能会从中获得灵感。

干杯，尼日

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-01T15:17:59.720

除非您进行批量插入，否则 Neo4j 的写入性能很慢。

Neo4j 批量导入器 ( [https://github.com/jexp/batch-import](https://github.com/jexp/batch-import) ) 是将数据加载到 Neo4j 中的最快方法。它是一个 Java 实用程序，但您不需要了解任何 Java，因为您只是在运行可执行文件。它处理类型化的数据和索引，并从 CSV 文件导入。

要将其与 Bulbs ( [http://bulbflow.com/](http://bulbflow.com/) ) 模型一起使用，请使用模型`get_bundle()`方法获取数据、索引名称和索引键，为插入做好准备，然后将数据输出到 CSV 文件。或者，如果您不想为数据建模，只需将数据从 Python 输出到 CSV 文件。

这对你有用吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-24T11:20:18.997

网上有很多关于这个问题的旧答案，以至于我花了很长时间才意识到 neo4j 附带了一个导入工具。它非常快，是我能找到的最好的工具。

如果我们要导入学生节点，这是一个简单的示例：

```
bin/neo4j-import --into [path-to-your-neo4j-directory]/data/graph.db --nodes students 
```

学生文件包含如下所示的数据，例如：

> studentID:Id(Student),name,year:int,:LABEL
> 
> 1111，艾米，2000，学生
> 
> 2222，简，2012，学生
> 
> 3333，约翰，2013，学生

解释：

*   标题解释了它下面的数据应该如何被解释。
*   studentID 是 Id(Student) 类型的属性。
*   name 是默认的字符串类型。
*   年份是一个整数
*   :LABEL 是您想要这些节点的标签，在这种情况下它是“学生”

这是它的文档：http: [//neo4j.com/docs/stable/import-tool-usage.html](http://neo4j.com/docs/stable/import-tool-usage.html)

注意：我意识到这个问题特别提到了 python，但另一个有用的答案提到了一个非 python 解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-24T12:13:54.743

好吧，我自己也需要 neo4j 的大规模性能。我最终做了以下事情来提高图形性能。

1.  抛弃了 py2neo，因为它有很多问题。此外，使用 neo4j 提供的 REST 端点非常方便，只要确保使用请求会话即可。
2.  使用原始密码查询进行批量插入，而不是任何 OGM（对象图映射器）。如果您需要高性能系统，这一点非常重要。
3.  性能仍然不足以满足我的需求，因此我结束了编写一个自定义系统，该系统使用 WITH * AND UNION 子句将 6-10 个查询合并在一起。这将性能提高了 3 到 5 倍。
4.  使用具有至少 1000 个查询的更大事务大小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-24T20:17:30.207

以非常高的速度将大量节点插入到 Neo4K

**批量插入器**

[http://neo4j.com/docs/stable/batchinsert-examples.html](http://neo4j.com/docs/stable/batchinsert-examples.html)

就我而言，我正在研究 Java。

# c# - 如何在 C# 中动态分配不同的 facebook og 标签？

> ID：12643666
> 
> 赞同：1
> 
> 时间：2012-09-28T16:15:51.920
> 
> 标签：c#, asp.net, .net, facebook

我在网站的三个不同页面上有三个不同的点赞按钮。有没有办法根据按钮所在的页面动态创建和分配这些 og 标签？

这是我正在使用的代码：

```
protected void Page_Load(object sender, EventArgs e)
{

    // ADD META INFORMATION TO HEADER
    HtmlHead head = (HtmlHead)Page.Header;

    // KEYWORDS
    HtmlMeta hm = new HtmlMeta();
    hm.Name = "keywords";
    hm.Content = this.metaKeywords;
    head.Controls.Add(hm);

    // DESCRIPTION
    hm = new HtmlMeta();
    hm.Name = "description";
    hm.Content = this.metaDescription;
    head.Controls.Add(hm);

    // ************************************************************************

    //      <meta property="og:title" content="Faces of Metastatic Breast Cancer (MBC) Video Wall" />
    //      <meta property="og:type" content="cause" />
    //      <meta property="og:image" content="http://www.facesofmbc.org/images/MBC_Logo.png"/>
    //      <meta property="og:url" content="http://bit.ly/rkRwzx" />
    //      <meta property="og:site_name" content="Faces of Metastatic Breast Cancer (MBC)" />
    //      <meta property="og:description" content="I just viewed the new Faces of Metastatic Breast Cancer (MBC) video wall. For each view, comment or share of the video wall during October, Genentech will donate $1 to MBC initiatives. Watch TODAY!" />
    //      <meta property="fb:admins" content="653936690"/>

    string ogTitle = "";
    string ogType = "";
    string ogImage = "";
    string ogUrl = "";
    string ogSiteName = "";
    string ogDescription = "";
    string ogAdmins = "";

    if (Page.Request.Path.Contains("videoWall.aspx"))
    {
        hm = new HtmlMeta();
        hm.Attributes.Add("property", "og:title");
        hm.Content = "TEST OG TITLE";
        head.Controls.Add(hm);

        hm = new HtmlMeta();
        hm.Name = "og:type";
        hm.Content = "TEST OG TYPE";
        head.Controls.Add(hm);
    }
    // ************************************************************************
} 
```

我知道这是错误的，并且似乎有不同的方法，但我只是向您展示我在做什么以及我前进的方向。注释掉的标签只是作为我需要哪些标签的指南。任何帮助，将不胜感激！

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T17:14:59.993

如果你把你的属性变成一个接口，然后把那个接口扔到使用你的控件的类上怎么办？

您可以创建一个界面，其中包含您尝试获取的所有属性...

```
interface IFaceBookMeta
{
    string ogTitle {get; set;}
    string ogType {get; set;}
    //...... and so on
} 
```

然后将该接口应用到要在其上托管控件的页面。

```
public partial class SomePageThatHasTheControl: System.Web.UI.Page, IFaceBookMeta 
```

然后，在该类中，您现在可以显式设置接口的属性

```
this.ogTitle = "A Random Title";
this.ogType = "A Type"; 
```

现在，您转到控件的代码并执行以下操作：

```
//This is the page that is hosting the control.
IFaceBookMeta meta = (IFaceBookMeta)this.Page;

hm = new HtmlMeta();
hm.Attributes.Add("property", "og:title");
hm.Content = meta.ogTitle;
head.Controls.Add(hm);

hm = new HtmlMeta();
hm.Name = "og:type";
hm.Content = meta.ogType;
head.Controls.Add(hm);
//.... and so on 
```

这样做会阻止您在每次将控件添加到另一个页面时修改控件的代码。相反，您只需在您想要控制的页面上拍打界面，设置属性。

# ruby - 使用 Ruby IRB 和方法合并/代码块上的文件获得不同的结果

> ID：12643670
> 
> 赞同：0
> 
> 时间：2012-09-28T16:16:06.553
> 
> 标签：ruby, merge, block, irb

当我运行这两个 Ruby 脚本时，我得到了两个不同的答案。此外，如果我在 irb 上运行第一个脚本，我会得到与第二个脚本相同的结果（并且我知道第二个脚本和 irb 上的结果是正确的）。我在第一个脚本上遗漏了什么吗？谢谢您的帮助。

### 红宝石版本：1.9.3

### 文本编辑器：TextWrangler

```
h1 = {"n1"=> 00, "n2"=> 44}
h2 = {"n2"=> 66, "n3"=> 88} 
```

### 第一个脚本——结果：`{"n1"=>0, "n2"=>66, "n3"=>88}`

```
puts h1.merge(h2) do |key, old, new|
  if old < new
     old
  else
     new
  end
end 
```

### 第二个脚本——结果：`{"n1"=>0, "n2"=>44, "n3"=>88}`

```
puts h1.merge(h2) {|key,old,new| old < new ? old : new} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:37:23.190

在第一种情况下，Ruby 认为块属于`puts`，而不是`merge`使用`{}`：

```
p h1.merge(h2) { |key, old, new|
  if old < new
   old
  else
   new
  end
} 
```

**更新**：您可以在[Programming Ruby](http://phrogz.net/ProgrammingRuby/language.html#blocksclosuresandprocobjects)书中找到详细信息。

# c# - 获取程序目录.net

> ID：12643671
> 
> 赞同：-4
> 
> 时间：2012-09-28T16:16:13.300
> 
> 标签：c#, .net

如何从 .net 代码中获取已安装应用程序（浏览器）的地址。比如我们要运行opera，所以需要获取他的地址exe。

对于此示例，它必须返回“C:\Program Files (x86)\Opera\opera.exe”。你能告诉我，关于获取widnows上已安装程序地址的api（x32-x64）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:21:13.500

这是关于查找已安装但尚未运行的程序的[MSDN 社交讨论。](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/b13b4124-c06f-40a8-bd9a-cf4e4ad1fba2)

您还可以使用 ID 和文件名列出所有正在运行的进程：

```
Process[] processlist = Process.GetProcesses();

foreach(Process theprocess in processlist){
    Console.WriteLine(“Process: {0} ID: {1} File name: {2}”, theprocess.ProcessName, theprocess.Id, theprocess.StartInfo.FileName);
} 
```

然后，您只需确定哪个是您想要的，然后获取文件名`theprocess.StartInfo.FileName`

我希望这有帮助。

# r - 用不同长度的向量在循环中填充矩阵

> ID：12643674
> 
> 赞同：2
> 
> 时间：2012-09-28T16:16:23.583
> 
> 标签：r, loops, vector, matrix

我在 R 中一直在努力解决这个问题：

假设我有一个`for`运行超过 9 个数据文件的循环。在这个循环中，我从一个较长的向量中提取一个短向量。简单的。

之后，仍然在循环期间，我想用新提取的短向量填充矩阵并将矩阵保存到文件中。不容易，因为没有一个短向量具有相同的长度。为避免该问题，我尝试使用and直接将向量直接保存（仍在循环中）在`.csv`文件中，但是当我想要 9 列时，R 将所有 9 个向量附加到同一列中。有没有类似的东西存在？`write.table()``append=TRUE``by.column=TRUE`

一种或另一种方式，我只想将我的 9 个短向量放在数据文件的 9 列中。在我看来，我对第二种解决方案并不太远。

有谁知道如何最终完成这个小程序？我将不胜感激。

谢谢你的时间米歇尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:05:13.670

我建议你稍微调整一下你的工作流程，做这样的事情：

1.  首先将所有向量收集在一个 R 列表对象中。

2.  仍然在 R 中，将向量列表按摩到矩阵或 data.frame 中。（一旦您提取了所有向量，并且知道最长向量的长度，这将更容易。）

3.  `write.table`只有然后通过一次调用or来写出结果表`write.csv`。

这是一个例子：

```
## Set up your for() loop or lapply() call so that it returns a list structure 
## like 'l'
l <- list(a=1:9, b=1:2, c=1:5)

## Make a matrix from the list, with shorter vectors filled out with ""s
n <- max(sapply(l, length))
ll <- lapply(l, function(X) {
    c(as.character(X), rep("", times = n - length(X)))
})
out <- do.call(cbind, ll)                 

## Then output it however you'd like. (Here are three options.)
# write.csv(out, file="summary.csv")
# write.csv(out, file="summary.csv", quote=FALSE)
# write.table(out, file="summary.txt", row.names=FALSE, quote=FALSE, sep="\t") 
```

# selenium-webdriver - IE XPath 的 Selenium Webdriver - c#

> ID：12643679
> 
> 赞同：1
> 
> 时间：2012-09-28T16:16:46.397
> 
> 标签：selenium-webdriver

我在 IE 上使用 Selenium Webdriver

我无法将点击发送到图像。整个页面都使用了特定的图像-我正在尝试通过 xPath 查找。

html片段：

`<img src='Option.gif' border='0' style="cursor:hand;" onClick="javascript:DropDownOpen('ID_1_0_0_3_0_19');" />`

网络驱动程序代码：

`driver.FindElement(By.XPath("//img[contains(@onClick, \"javascript:DropDownOpen('ID_1_0_0_3_0_19');\"]")).Click();`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T04:08:33.737

您在单击图像时遇到问题，因为您的 xpath 包含单引号。要使用单引号对元素进行 xpath，您需要使用 xpath 的 concat() 函数。你的 xpath 变成

```
//img[@onClick=concat('javascript:DropDownOpen(',"'",'ID_1_0_0_3_0_19',"'",');')] 
```

您会注意到我们`javascript:DropDownOpen(`在单引号中连接，并且每当我们需要定位包含单引号的元素时，我们将它们包裹在双引号中。

快乐 Xpathing！

# c# - 保存背面颜色

> ID：12643681
> 
> 赞同：5
> 
> 时间：2012-09-28T16:16:52.677
> 
> 标签：c#, winforms

如何在 C# Windows 应用程序中更改*和*保存背景颜色，以便当我关闭应用程序并再次运行程序时，新颜色将成为默认的背景颜色？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T16:36:30.173

你可以毫不费力地做到这一点。在设计器中选择表单，在“属性”窗口中打开 ApplicationSettings 节点。选择 (PropertyBinding) 并单击按钮。在弹出对话框中选择背景颜色。单击下拉箭头，然后单击新建。将名称设置为“FormBackColor”。

您唯一需要的另一件事是让用户选择另一种颜色的选项。使用 ColorDialog 类很容易做到：

```
 private void OptionChangeColor_Click(object sender, EventArgs e) {
        using (var dlg = new ColorDialog()) {
            if (dlg.ShowDialog() == DialogResult.OK) {
                this.BackColor = Properties.Settings.Default.FormBackColor = dlg.Color;
                Properties.Settings.Default.Save();
            }
        }
    } 
```

![在此处输入图像描述](../Images/a5a2b575610b5ad659295274b501121a.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:18:30.563

您需要将新颜色保存在启动时加载的某个文件中并应用为背景颜色。

或者使用这样的用户[设置](http://msdn.microsoft.com/en-us/library/aa730869%28v=vs.80%29.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:30:37.713

你可以做一些简单的事情，比如 File.WriteAllText("bg.txt", this.BackColor.ToString()); 当应用程序加载时执行 this.BackColor = Color.FromName(File.ReadAllText("bg.txt"));

当然，将此颜色存储在独立存储或注册表中可能会更好。但你明白了……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:32:44.870

Some time ago there was thread about best practices to do that here on stackoverflow.
Please take look:
[Best practice to save application settings in a Windows Forms Application](https://stackoverflow.com/questions/453161/best-practice-to-save-application-settings-in-a-windows-forms-application)

# java - 如何检查字符串是否包含包含空格的子字符串？

> ID：12643683
> 
> 赞同：3
> 
> 时间：2012-09-28T16:16:56.047
> 
> 标签：java, regex

假设我在 java 中有一个这样的字符串：

“这是{我的字符串：}好的”

请注意，各个字符之间可以有任意数量的空格。如何检查上面的字符串以查看它是否只包含子字符串：

“{我的字符串：}”

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:21:53.160

如果您要查看字符串是否包含另一个特定的字符序列，那么您可以执行以下操作：

```
String stringToTest = "blah blah blah";

if(stringToTest.contains("blah")){
    return true;
} 
```

你也可以使用火柴。有关匹配字符串的正确解释，我建议您查看 Java Oracle 正则表达式教程：

[http://docs.oracle.com/javase/tutorial/essential/regex/index.html](http://docs.oracle.com/javase/tutorial/essential/regex/index.html)

干杯，

杰米

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:28:57.463

如果您的匹配字符串的每个字符之间有任意数量的空格，我认为您最好在搜索之前从您尝试匹配的字符串中删除所有空格。IE ：

```
String searchedString = "this is {my string: } ok";
String stringToMatch = "{my string: }";
boolean foundMatch = searchedString.replaceAll(" ", "").contains(stringToMatch.replaceAll(" ","")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:21:41.343

将它全部放入一个字符串变量中，比如 s，然后执行 s.contains("{my string: }); 如果 {my string: } 在 s 中，这将返回 true。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:26:38.553

为此，您需要使用`String#contains(CharSequence)`.

> 请注意，各个字符之间可以有任意数量的空格。

为此，`String#trim()`方法用于返回字符串的副本，省略了前导和尾随空格。

例如：

```
String myStr = "this is {my string: } ok";
if (myStr.trim().contains("{my string: }")) {
    //Do something.
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T16:29:28.167

最简单的做法是去掉两个字符串中的所有空格。

```
return stringToSearch.replaceAll("\s", "").contains(
  stringToFind.replaceAll("\s", "")); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-28T16:37:31.397

寻找正则表达式

```
\{\s*my\s+string:\s*\} 
```

这匹配任何包含

1.  一个左大括号
2.  零个或多个空格
3.  '我的'
4.  一个或多个空格
5.  '细绳：'
6.  零个或多个空格
7.  右支架

这里的“空格”表示任何空格（制表符、空格、换行符、cr）

# iphone - ios6 视图控制器自动旋转

> ID：12643688
> 
> 赞同：1
> 
> 时间：2012-09-28T16:17:12.127
> 
> 标签：iphone, ios, ios6, autorotate

我最近在应用商店发布了一个应用，在开发它时，在 iOS 5 上，自动旋转运行良好，正如我所愿。当它在应用商店发布时，我下载了它以确保版本正常工作，但这次是 iOS 6，自动旋转全都搞砸了。

经过一番搜索，我发现他们弃用了该`shouldAutorotateToInterfaceOrientation`功能。所以我尝试使用新的`supportedInterfaceOrientations`或`shouldAutorotate`没有任何运气。有谁知道如何解决这个问题，以便我的旋转正常工作。我希望特定的屏幕只能是纵向的，而有些屏幕能够同时进行横向和纵向，这适用于`shouldAutorotateToInterfaceOrientation`，我需要一种适用于 iOS 6 的新方法。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T17:52:17.157

在您的应用程序委托中，您是否将导航控制器的视图添加为 self.window 中的子视图？如果是这样，我发现这在 iOS 版本 6 中无法正常工作。您应该设置 self.window 根视图控制器。以下是一些更具体的内容：

[http://www.dosomethinghere.com/2012/09/24/the-app-delegates-uiwindow-is-finicky/](http://www.dosomethinghere.com/2012/09/24/the-app-delegates-uiwindow-is-finicky/)

# php - 使用 ASP.NET (vb) 将文件发送到 PHP 应用程序

> ID：12643697
> 
> 赞同：0
> 
> 时间：2012-09-28T16:18:01.110
> 
> 标签：php, asp.net, vb.net, dotnetnuke

目前我正在整合 OSTicket 以提供更好的方式来支持客户。

我的客户有一个`DotNetNuke`网站，我必须将一个表单与`OSTicket`.

DotNetNuke 和 OSTicket 托管在不同的站点并具有不同的域。

到目前为止，我可以使用系统创建一个新票（不是直接向 MySql 发送数据），但现在我需要发送带有票的附件

我的主要问题是如何使用带有 asp.net 的 post 将文件发送到 php 以及如何使用 php 处理发送的文件

编辑：我无法创建表单并将其指向 php 文件：

a) 出于某种原因，我在 WebUserControls 上为 DNN 创建的所有表单都消失了 b) 用户永远不必离开网站

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T10:21:00.757

表单消失的原因是 DNN 有一个环绕的表单（并且您不能在表单中拥有一个表单）。

如果您确实需要以这种方式发布，请在 DotNetNuke 中使用 iframe 到独立的 asp.net 页面，这将允许您使用上述解决方案。否则，我会看看是否有更好的 API 集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:23:43.860

只需在 ASP.NET 中输出表单，使用 action="yourfile.php" 和 enctype="multipart/form-data"。在 PHP 中，您现在可以使用 $_FILES 全局变量来访问发布的文件

```
<form action="yourfile.php" method="post" enctype="multipart/form-data">
    <input name="file" type="file">
    <input type="submit" />
</form> 
```

对于 php，请参见： http: [//php.net/manual/de/features.file-upload.post-method.php](http://php.net/manual/de/features.file-upload.post-method.php)

# android - ActionBar 上不存在菜单按钮

> ID：12643701
> 
> 赞同：0
> 
> 时间：2012-09-28T16:18:22.257
> 
> 标签：android, android-actionbar, android-4.0-ice-cream-sandwich

我想在我的应用程序中构建一个带有按钮的 ActionBar，该按钮充当旧硬件菜单按钮的角色。我正在使用 min sdk=8 的 4.0.3 平台工作。问题是我在 ActionBar 中没有菜单按钮，并且总是必须按下模拟器菜单按钮才能显示它。不知道怎么办，肯定有窍门。

菜单：

```
<menu xmlns:android="http://schemas.android.com/apk/res/android">
   <item
        android:id="@+id/menu_settings"
        android:icon="@drawable/ic_action_settings"
       android:showAsAction="always"
        android:title="@string/menu_settings"/>
   <item android:id="@+id/menu_help"
        android:title="Help">
   </item>
</menu> 
```

并像往常一样用 Java 代码准备菜单：

```
 public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return super.onCreateOptionsMenu(menu);
    } 
```

我想要一个显示该菜单的操作栏中的按钮。可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:22:27.037

> 问题是我在 ActionBar 中没有菜单按钮，并且总是必须按下模拟器菜单按钮才能显示它。不知道怎么办，肯定有窍门。

并不真地。

溢出菜单功能只会出现在缺少屏幕外菜单按钮的设备的操作栏中。对于最初搭载 Android 4.0 或更高版本的大多数平板电脑和许多手机来说都是如此。

对于具有专用 MENU 按钮的设备，该按钮用于调出溢出菜单。

# html - 溢出，浮动，高度混乱

> ID：12643706
> 
> 赞同：0
> 
> 时间：2012-09-28T16:18:40.167
> 
> 标签：html, css, height, overflow

我正在使用网站上的导航设计 - [CSSDECK](http://cssdeck.com/labs/flashy-navigation-with-rollover-effect)。

我做了一些修改，[这](http://jsfiddle.net/knoxxs/RAX3a/13/)是我的代码。

**疑问：**

1.  为什么`#siteNav`而`#siteNav ul`不是环绕`li`s。我`height:auto`在`#siteNav`和中使用过`#siteNav ul`。我所知道的是`auto`意味着浏览器会**相应**地决定高度。但这并没有发生。*为什么？*
2.  如果我`overflow:auto or hidden`在任何一个`#siteNav`或`#siteNav ul`. 然后该块将自身包裹在`li`s 周围。为什么`overflow`要这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:23:10.647

这是因为你`li`的 s 是浮动的。如果没有s `overflow: hidden;`，则`li`s 与 s 处于不同的上下文中`ul`，因此s`ul`不会环绕它们。

`overflow: hidden;`是一种通用的、已知的容器调整大小以适应其`float`ed 内容的修复方法，但还有其他方法 - 如需广泛参考，[请参阅此](https://stackoverflow.com/a/1633170/364869).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:24:42.363

只适用`overflow: hidden;`于你的 `#siteNav ul`

```
 #siteNav ul {
overflow: hidden;
} 
```

因为您在使用溢出时建立了一个新的块格式化上下文，然后可见（链接到[w3.org 规范](http://www.w3.org/TR/CSS21/visuren.html#block-formatting)）。***作者：ChristopheD***

[读这个](http://colinaarts.com/articles/the-magic-of-overflow-hidden/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:32:53.060

这是因为 lis 是浮动的。任何包含浮动元素的包装器都不会包装内容，除非溢出：隐藏应用于包装器。这是浮动元素的常见浏览器问题。此外，overflow:hidden 并不能在所有浏览器中解决此问题。搜索“clearfix”以查看针对此问题的跨浏览器修复。

顺便说一句，您不需要 height:auto ，块元素默认具有宽度和高度自动。如果里面没有浮动元素，那么您会看到预期的行为。

# powershell - PowerShell：1234 和 (1234) 有什么区别？

> ID：12643707
> 
> 赞同：6
> 
> 时间：2012-09-28T16:18:40.990
> 
> 标签：powershell, casting, string-formatting, evaluation

我希望有人可以帮助我解决以下问题：

```
Function Get-FormattedNameValuePair([string] $name, [object] $value)
{
    return "$("{0,-24}" -f $name) : $("{0,15:N2}" -f $value)"
}

Write-Output (Get-FormattedNameValuePair -name MyField -value 1234) 
```

以上返回：

```
MyField                  :            1234 
```

然而，我期待：

```
MyField                  :        1,234.00 
```

如果我在 1234 周围添加评估括号，则会正确返回预期结果：

```
Write-Output (Get-FormattedNameValuePair -name MyField -value (1234)) 
```

如果直接调用而不是包装在“Get-FormattedNameValuePair”函数中，格式化也可以在没有评估括号的情况下工作。

```
[string] $name = "MyField"
[object] $value = 1234
Write-Output  "$("{0,-24}" -f $name) : $("{0,15:N2}" -f $value)" 
```

谁能解释上面的行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T16:28:39.350

我无法在 V3 上重现它

```
Function Get-FormattedNameValuePair([string] $name, [object] $value)
{
    return "$("{0,-24}" -f $name) : $("{0,15:N2}" -f $value)"
}

Write-Output (Get-FormattedNameValuePair -name MyField -value 1234)

MyField                  :        1,234.00 
```

但我可以在 V2 上重现这个。如果您将`[object]`演员更改为它，`[int]`它将开始按您的预期工作。将它放在导致问题的对象中是有道理的。可以更简洁地显示此错误，如下所示：

```
function foo([object]$o) { "{0,15:N2}" -f $o }
foo 1234
       1234 
```

在 V2 中，存在许多与 .NET 类型在称为 PSObject 的 PowerShell 扩展类型系统类型中包装相关的已知问题。这似乎与那个问题有关。事实上，它是相关的。看一下这个：

```
function foo([object]$o) { "{0,15:N2}" -f $o.psobject.baseobject }
foo 1234
   1,234.00 
```

如果您打开对象以恢复原始状态，您将获得预期的输出。将此归结为一个 V2 错误，幸运的是，该错误已在 V3 中修复。

# symfony - 使用 Symfony 的 flashBag 会话进行单元测试

> ID：12643714
> 
> 赞同：4
> 
> 时间：2012-09-28T16:18:56.320
> 
> 标签：symfony, phpunit, silex

我正在使用单元测试在 Silex 中创建一个应用程序。

对常规会话处理程序运行单元测试可以正常工作：

```
$app->register(new Silex\Provider\SessionServiceProvider(), array(
    'session.storage.options' => array(
        'cookie_lifetime' => 1209600, // 2 weeks
    ),
)); 
```

并在我的单元测试中设置这个标志：

```
$this->app['session.test'] = true; 
```

如果我没有设置 session.test 标志，我的单元测试会抛出一个 headers already sent 错误并且全部失败。有了它，我的测试运行良好。

问题是我正在尝试使用 flashBag 功能（会话信息只持续到第一个请求然后被删除）：

```
$foo = $app['session']->getFlashBag()->all(); 
```

flashBag 似乎不尊重 session.test 标志，并尝试发送标头，这导致我所有的单元测试都失败：

> 24) Yumilicious\UnitTests\Validator\PersonAccountTest::setConstraintsPassesWithMinimumAttributes RuntimeException: 无法启动会话，因为标头已经发送。
> 
> /webroot/yumilicious/vendor/symfony/http-foundation/Symfony/Component/HttpFoundation/Session/Storage/NativeSessionStorage.php:142 /webroot/yumilicious/vendor/symfony/http-foundation/Symfony/Component/HttpFoundation/Session/Storage /NativeSessionStorage.php:262 /webroot/yumilicious/vendor/symfony/http-foundation/Symfony/Component/HttpFoundation/Session/Session.php:240 /webroot/yumilicious/vendor/symfony/http-foundation/Symfony/Component/HttpFoundation /Session/Session.php:250 /webroot/yumilicious/src/app.php:38 /webroot/yumilicious/tests/Yumilicious/UnitTests/Base.php:13 /webroot/yumilicious/vendor/silex/silex/src/Silex /WebTestCase.php:34 /webroot/yumilicious/vendor/EHER/PHPUnit/src/phpunit/phpunit.php:46 /webroot/yumilicious/vendor/EHER/PHPUnit/bin/phpunit:5

我已经把它缩小到这段代码：[https ://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Session/Storage/NativeSessionStorage.php#L259](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Session/Storage/NativeSessionStorage.php#L259)

具体来说，第 262 行。注释掉那一行可以让我的测试正常工作并且全部通过绿色。

我已经进行了很多搜索以使其正常工作，但没有任何运气。我认为这是因为 flashBag 的东西是新的（https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Session/Session.php#L305）并且旧方法正在被弃用。

任何关于让我的单元测试工作的建议都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-02T17:55:43.793

为了进行测试，您需要`session.storage`用以下实例替换服务`MockArraySessionStorage`：

```
use Symfony\Component\HttpFoundation\Session\Storage\MockArraySessionStorage;

$app['session.storage'] = new MockArraySessionStorage(); 
```

这是因为本机尝试发送一个 cookie，通过`header`该 cookie 在测试环境中当然会失败。

编辑：现在有一个`session.test`参数应该设置为 true。这将自动使会话使用模拟存储。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-14T13:01:53.783

我也发生过这种情况，如果我没有弄错的话，我通过让我的单元测试通过不同的环境运行来修复，至

```
framework:
    test: ~
    session:
        storage_id: session.storage.mock_file 
```

在 config_test.yml 中设置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-14T11:58:43.690

我今天遇到了类似的问题，临时修复将是注释掉代码块

```
\Symfony\Component\HttpFoundation\Session\Storage\NativeSessionStorage 
```

在`start()`方法中

```
 /*
   if (ini_get('session.use_cookies')  && headers_sent()) {
       throw new \RuntimeException('Failed to start the session because headers have already been sent.');
   }
   */ 
```

该解决方案使测试保持“绿色”，并且从外观上看，应用程序会话功能保持不变。

# html - 是否有一种跨浏览器、向后兼容的方式来编码背景渐变？

> ID：12643719
> 
> 赞同：2
> 
> 时间：2012-09-28T16:19:09.503
> 
> 标签：html, css, cross-browser

我一直在寻找适用于现代浏览器和 IE 版本低至 7 的背景渐变的解决方案。如果有人有一个可行的最佳实践，我会很感激这种方法，因为我不断遇到在某个浏览器上中断的解决方案或版本。它至少应该在 IE7-9、Firefox、Safari、Opera 和 Chrome 中工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:21:45.360

这是一个相当完整的渐变生成器 [colorzilla](http://www.colorzilla.com/gradient-editor/)

无论如何，目前在 css 中还没有明确的标准。我们希望它会尽快到达！

如果您想在 Explorer 6-8 中使用类似 CSS3 的方法（例如`linear-gradient(#EEFF99, #66EE33)`，并且不使用 Explorer 专有`filter`）看到一些渐变，您可以尝试 Css PIE。我广泛使用它，它是一款基于 HTML 组件 (.htc) 的令人惊叹的软件，特别适用于按钮，但根据我的经验，当您的页面依赖于许多 ajax 效果时会出现一些问题，特别是如果您重新调整框架的大小时/page，因为并非总是更新按钮/渐变。（无论如何，即使在重要站点中也使用 CSS Pie）

[CSS 饼图](http://css3pie.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:23:01.117

旧浏览器 (< IE7) 不支持 css 渐变属性。您可以使用 css3 制作渐变背景，然后为旧浏览器设置纯色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:23:36.920

没有ie7，但这是一个好的开始

```
 background: -moz-linear-gradient(-45deg, rgba(150,150,150,0.2) 1%, rgba(80,80,50,0.5) 52%, rgba(20,20,20,0.8) 100%); 
         background: -webkit-gradient(linear, left top, right bottom, color-stop(1%,rgba(150,150,150,0.2)), color-stop(52%,rgba(80,80,50,0.5)), color-stop(100%,rgba(20,20,20,0.8))); 
         background: -webkit-linear-gradient(-45deg, rgba(150,150,150,0.2) 1%,rgba(80,80,50,0.5) 52%, rgba(20,20,20,0.8) 100%); 
         background: -o-linear-gradient(-45deg, rgba(150,150,150,0.2) 1%,rgba(80,80,50,0.5) 52%, rgba(20,20,20,0.8) 100%); 
         background: -ms-linear-gradient(-45deg, rgba(150,150,150,0.2) 1%,rgba(80,80,50,0.5) 52%, rgba(20,20,20,0.8) 100%); 
         background: linear-gradient(-45deg, rgba(150,150,150,0.2) 1%,rgba(80,80,50,0.5) 52%, rgba(20,20,20,0.8) 100%); 

         /* FF3.6+ */ 
         /* Chrome,Safari4+ */
         /* Chrome10+,Safari5.1+ */ 
         /* Opera 11.10+ */
         /* IE10+ */ 
         /* W3C */ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T16:21:47.450

使用[此工具](http://www.colorzilla.com/gradient-editor/)生成渐变

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T16:34:12.653

正如其他人所说，CSS3 与 FF、Chrome 等兼容。

对于 IE9，您可以使用他们的官方[CSS Gradient Background Maker](http://ie.microsoft.com/testdrive/graphics/cssgradientbackgroundmaker/default.html)，它将生成内联 SVG 图像，大多数现代浏览器也支持（尽管它在 Safari 上会出现一些问题）。

对于 IE8，您可以使用

```
-ms-filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#FFFFFF, endColorstr=#000000, GradientType=1); 
```

[参考](http://msdn.microsoft.com/en-us/library/ie/ms530752%28v=vs.85%29.aspx)

对于 IE 5.5 - 7：

```
filter: progid:DXImageTransform.Microsoft.gradient(startColorStr=#FFFFFF, endColorStr=#FFFFFF, GradientType=1); 
```

[参考](http://msdn.microsoft.com/en-us/library/ms532997%28v=vs.85%29.aspx)

`startColorStr`并且`endColorStr`非常不言自明。[GradientType](http://msdn.microsoft.com/en-us/library/ms532887%28v=vs.85%29.aspx)用于`1`水平和`0`垂直。在 IE9 之前没有径向渐变或对角渐变之类的东西。

我**强烈**建议您不要使用 htc 解决方案（如 css3pie），因为它们会产生很多副作用。

实现起来并不容易，但如果你需要一个polyfill，那么可以使用[cssSandpaper](http://www.useragentman.com/blog/2010/03/09/cross-browser-css-transforms-even-in-ie/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-28T16:39:51.217

我的回答与 HTML 或 CSS 无关。这是另一种方式，如果您了解使用[MS Paint](http://www.instructables.com/id/Gradients-in-MIcrosoft-Paint/)或[GIMP](http://graphicssoft.about.com/od/gimptutorials/ss/Gradient-Editor.htm)创建渐变图像的基础知识，那么该技术将适用于所有类型的浏览器。

# powershell - 如何打开正在运行的脚本的重定向输出文件？

> ID：12643723
> 
> 赞同：1
> 
> 时间：2012-09-28T16:19:26.400
> 
> 标签：powershell

我在脚本中有以下代码`my.ps1`。

```
....
$attach = New-Object System.Net.Mail.Attachment("c:\my.log")
$msg.Attachments.Add( $attach ) 
```

我想安排它运行为`powershell "& { my.ps1 > c:\my.log }"`.

但是，我收到以下错误。

> 新对象：使用“1”参数调用“.ctor”的异常：“进程无法访问文件 'c:\my.log'，因为它正被另一个进程使用。”

无论如何要实施吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:48:49.087

使用重定向会锁定文件。相反，您需要使用 Out-File 或 Add-Content 等 cmdlet 删除重定向并直接在脚本中写入文件。

# php - 创建一个 Joomla！以编程方式撰写文章

> ID：12643725
> 
> 赞同：2
> 
> 时间：2012-09-28T16:19:32.687
> 
> 标签：php, joomla, content-management-system, joomla2.5

我创建了自己的组件。当我向我的组件添加一条新记录时，我还希望它在 joomla 中创建一篇新文章（即使用 com_content）。

我在堆栈溢出中发现了这一点，以[编程方式向 Joomla 添加了一篇文章](https://stackoverflow.com/questions/7041784/programmatically-adding-an-article-to-joomla)，解释了如何做到这一点。该代码很有意义，并且看起来可以工作。问题是一旦开始调用 com_content 中包含的方法，com_content 中的所有相对 URL 都会崩溃，joomla 会抛出错误。

有谁知道克服这个问题的方法？来自上面链接的评论表明，在包含它之前将当前工作目录更改为 com_content 会起作用，但我不能 100% 确定如何执行此操作。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-28T16:55:08.913

无法更改工作目录，因为它是一个常量。要解决此问题，您可以选择根本不使用 ContentModelArticle 而是仅使用表类：

```
$table = JTable::getInstance('Content', 'JTable', array());

$data = array(
    'catid' => 1,
    'title' => 'SOME TITLE',
    'introtext' => 'SOME TEXT',
    'fulltext' => 'SOME TEXT',
    'state' => 1,
);

// Bind data
if (!$table->bind($data))
{
    $this->setError($table->getError());
    return false;
}

// Check the data.
if (!$table->check())
{
    $this->setError($table->getError());
    return false;
}

// Store the data.
if (!$table->store())
{
    $this->setError($table->getError());
    return false;
} 
```

请注意，上面的代码不会触发之前/之后的保存事件。但是，如果需要，触发这些事件应该不是问题。另外值得注意的是，**published_up**字段不会自动设置，类别内的文章也不会重新排序。

要重新排序类别：

```
 $table->reorder('catid = '.(int) $table->catid.' AND state >= 0'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-02T08:19:52.367

我得到的错误说：

> 找不到文件 /var/www/administrator/com_mynewcomponent/helpers/content.php

我通过在这个位置创建一个空文件来抑制错误消息并手动包含`/var/www/administrator/com_content/helpers/content.php`一个`require_once`语句来解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-04T21:12:54.380

### 支持 Joomla 2.5 和 Joomla 3.0

JTableContent 在 Joomla! 之前不会自动加载！3.0版，所以它需要包括：

```
if (version_compare(JVERSION, '3.0', 'lt')) {
    JTable::addIncludePath(JPATH_PLATFORM . 'joomla/database/table');        
}   
$article = JTable::getInstance('content');
$article->title            = 'This is my super cool title!';
$article->alias            = JFilterOutput::stringURLSafe('This is my super cool title!');
$article->introtext        = '<p>This is my super cool article!</p>';
$article->catid            = 9;
$article->created          = JFactory::getDate()->toSQL();
$article->created_by_alias = 'Super User';
$article->state            = 1;
$article->access           = 1;
$article->metadata         = '{"page_title":"","author":"","robots":""}';
$article->language         = '*';

// Check to make sure our data is valid, raise notice if it's not.

if (!$article->check()) {
    JError::raiseNotice(500, $article->getError());

    return FALSE;
}

// Now store the article, raise notice if it doesn't get stored.

if (!$article->store(TRUE)) {
    JError::raiseNotice(500, $article->getError());

    return FALSE;
} 
```

# c# - 使用新名称复制命名空间

> ID：12643726
> 
> 赞同：0
> 
> 时间：2012-09-28T16:19:37.330
> 
> 标签：c#, visual-studio-2010, visual-studio

在 Visual Studio 中复制命名空间的最佳方法是什么？

我的意思是在解决方案资源管理器中取一个文件夹说'Namespace1'，然后复制它，但在此过程中将文件夹文件中的命名空间重命名为'Namespace2'。

关键是只更新新复制文件夹中的引用和使用。

我现在正在做的是拖放复制解决方案资源管理器中的文件夹，不包括 Project 中的原始文件夹，更改一个文件上的命名空间，然后使用下拉选项“将 Namespace1 重命名为 Namespace2”。问题是更新了我对副本的外部引用，并且在排除它后重新导入原件很烦人。

# android - Android 基于位置的服务

> ID：12643727
> 
> 赞同：1
> 
> 时间：2012-09-28T16:19:45.637
> 
> 标签：android, location, android-location

我是初学者。我想开发一个可以生成基于位置的通知的应用程序。在 android 开发者网站中，我发现为了保持电池寿命和数据交换之间的平衡，应该考虑

1.  新更新的频率
2.  您在其中收听位置更新的窗口。

我知道可以通过调用 requestLocationUpdates() 来控制频率。我的问题是如何控制监听更新的窗口？这是否意味着一旦我从 LocationListener 类的 onLocationChanged() 方法获取位置更新，我应该停止使用 removeUpdates() 侦听更新？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:00:01.217

GPS 设备只有在您注册 requestLocationUpdates() 时才开始工作（并消耗电力）。

理论上，如果更新不是很频繁，GPS 可以在更新之间关闭。例如，假设您每 5 分钟请求一次更新，那么 GPS 可以关闭 4 分钟 30 秒左右。并及时开启以获取下一个位置。如果您将新位置请求设置为每 5 秒一次，则 GPS 不会在更新之间关闭。

我有一个应用程序可以让 GPS 全时保持清醒，并在数据库中记录位置。此应用程序还可以显示地图并绘制记录的轨迹。我的经验是，用于绘制实时更改轨迹的地图的功率远高于 GPS 使用的功率。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:59:36.103

我认为只有在不再需要新位置时才应该停止收听更新。如果您只需要一个新位置，最好立即停止收听。为了获得更多位置（随着用户移动），建议开始监听位置更新**`onResume`**并停止监听**`onPause`**。这意味着**`onLocationChanged`**只有当您的活动在所有其他人面前（可见）时才会调用您。

总之，管理您需要的窗口的活动应该具有上述指定的这些调用。

# ios - 无法在 iphone5 上显示 640x1136 图像

> ID：12643735
> 
> 赞同：0
> 
> 时间：2012-09-28T16:20:30.367
> 
> 标签：ios, retina-display, iphone-5

我在我的应用中添加了一个 Default-568h@2x.png 启动图像。该应用程序需要在“真实”启动图像之后显示*第二个启动图像。*因为 UIImage imageNamed: 方法不会像自动加载视网膜图像那样自动加载更高的图像，所以我添加了一些代码来检测屏幕大小并显示正确的图像：

```
-(void)pickRightImage
{
    CGSize result = [[UIScreen mainScreen] bounds].size;
    UIImageView *imgv = [self loadingImage];

    UIImage *img;

    if(result.height == 480)
    {
        img = [UIImage imageNamed:@"loading_screen.png"];
    } else if([UIScreen mainScreen].scale == 2.f && result.height == 568) {
        // iPhone 5
       img = [UIImage imageNamed:@"loading_screen-568h@2x.png"];       
    }
    [imgv setImage:img];
} 
```

imageView 在名为 MainWindow 的 NIB 中占据了整个屏幕，并且我选择了名为“Full Screen At Launch”的复选框但是，图像从不占据整个屏幕。（尽管启动图像确实如此。）第二张图像是字母加框的，就好像它是一个较小的图像一样，我从未包含过高的启动图像。

无论如何以编程方式在 4 英寸 iphone5 上显示全屏图像？为什么我的图像总是调整大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:30:00.777

`[UIImage imageNamed:]`将负责`@2x`为您添加。所以你应该指定

```
img = [UIImage imageNamed:@"loading_screen-568h.png"]; 
```

同时测试 4" 屏幕和 Retina 标准（比例 = 2）也是没有用的。所有具有 4" 屏幕（568px 高）的设备都是 Retina 显示器，所以你可以假设如果 height == 568，用户有iPhone 5：更换

```
if ([UIScreen mainScreen].scale == 2.f && result.height == 568) 
```

和

```
if ([UIScreen mainScreen].bounds.size.height == 568) 
```

你很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:40:45.360

我在主视图控制器上对此进行了测试。此外，在目标 > 摘要 > 状态栏 > 可见性检查“应用程序启动期间隐藏”。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    UIImageView *iv = [[UIImageView alloc] initWithFrame:self.view.bounds];
    iv.image = [UIImage imageNamed:@"Second-default568h@2x.png"];
    [self.view addSubview:iv];
} 
```

# android - 如何使 ImageButton 仅显示图像？

> ID：12643736
> 
> 赞同：1
> 
> 时间：2012-09-28T16:20:30.860
> 
> 标签：android, button, imageview, imagebutton

我有一个很酷的图像（喜欢圆角）。我想在我的 android 应用程序中实现该图像。单击它时，我希望它变暗一点（就像按下按钮时一样）并启动一个新活动。

我该怎么做，我应该使用什么（ImageView、ImageButton 或只是 Button）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T16:37:20.387

您需要两个版本的酷图片，分别称为 active.png（点击状态，即变暗）和 inactive.png（正常状态）。在`drawable`文件夹中为它们创建一个 Selector 文件，如下所示：`/drawable/cool_button_selector.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:state_pressed="true" android:drawable="@drawable/active"/> 
    <item android:drawable="@drawable/inactive"/>

</selector> 
```

然后像这样使用 ImageButton：

```
<ImageButton
    android:id="@+id/coolImageButton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/cool_button_selector"
    android:background="@null" /> 
```

**添加：** android:background="@null" 到`<ImageButton>`

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:24:10.430

您可以根据您的要求使用上述任何一种。对于类似按钮的行为，您可以使用 ImageButton，这是更改图像 onTouch 的说明

[在android中更改按钮图像](https://stackoverflow.com/questions/4938480/change-button-image-in-android)

您可以类似地更改 ImageView 的图像。

```
ImageView img = (ImageView) getViewById(id-here);
img.setImageResource(R.drawable.my_image); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:27:42.160

您可以使用带有 onClickListener 的普通 Imageview，imageview 的可绘制对象将是一个状态列表可绘制 xml 文件，它带有自己的内置事件侦听器，可以链接到单独的图像资产。

# ajax - MVC3 Razor 版日历扩展器

> ID：12643748
> 
> 赞同：1
> 
> 时间：2012-09-28T16:21:02.710
> 
> 标签：ajax, asp.net-mvc-3, razor, calendarextender

我习惯使用文本框日历扩展器（我喜欢！）。但是，我最新的项目是在 MVC3 razor 中，似乎无法使用 AJAX，或者至少不能以 asp.net 的方式使用。使用 AJAX 日历扩展器的替代方法是什么？我仍然可以通过变通方法使用它吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:28:13.367

jQuery 日期选择器。

```
 $("#myTextBox").datepicker(
            {
                showOn: 'button',
                dateFormat: "mm/dd/yy",
                buttonImageOnly: true,
                buttonImage: '../../../images/cal.gif',
                constrainInput: false
            }); 
```

# jsp - Sublime Text 2 JSP 语法高亮问题

> ID：12643749
> 
> 赞同：5
> 
> 时间：2012-09-28T16:21:04.440
> 
> 标签：jsp, syntax-highlighting, sublimetext2, sublimetext

我对 Sublime Text 2 中 JSP 页面的内置语法突出显示有一些问题。

见第 11/12 行白线后的代码：`<strong>`此处 HTML 标签显示正确。

此行之前的代码未正确着色：第二个 JSP 结束标记 ( `%>`) 为红色，但应该像第一个一样为橙色，并且我认为里面的 HTML 标记被识别为 Java 代码，尽管范围（可见`CTRL+SHIFT+ALT+P`as `text.html.jsp`） 不要换。

![Sublime Text 2 中的 JSP 语法高亮（主题：](../Images/b6bcaa5553d73b3704e05ba2a7ab7fd2.png)

如果我对开始和结束标签执行相同`<?php`操作，则问题不存在，那么所有颜色似乎都是正确的。`<?``?>`

有没有人有同样的问题？我确保将语法设置为 JavaServerPages (JSP)。

[我认为问题与HTML.tmLanguage](https://github.com/trevormorse/sublimepackages/blob/master/HTML/HTML.tmLanguage)文件中的这些行有关（JSP 范围在 HTML 范围内）：

```
<dict>
    <key>embedded-code</key>
    <dict>
        <key>patterns</key>
        <array>
            <dict>
                <key>include</key>
                <string>#ruby</string>
            </dict>
            <dict>
                <key>include</key>
                <string>#php</string>
            </dict>
            <!--
            <dict>
                <key>include</key>
                <string>#smarty</string>
            </dict>
            -->
            <dict>
                <key>include</key>
                <string>#python</string>
            </dict>
        </array>
    </dict> 
```

JSP 没有包含。但我只是猜测......有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T17:48:28.760

我现在设法编辑了`HTML.tmLanguage`和`Java Server Pages (JSP).tmLanguage`文件... ruby​​ 的一些匹配覆盖了 HTML`<script>`标记内的 jsp 范围，我删除了大括号的匹配，另外我在`text.html.jsp`一些范围定义中添加了一些包含。

* * *

我复制了我的`.tmTheme`文件并将其`User`作为`User.tmTheme`. 然后我将这些行添加到该文件的底部：

```
 <dict>
        <key>name</key>
        <string>Embedded Code Punctuation</string>
        <key>scope</key>
        <string>punctuation.section.embedded</string>
        <key>settings</key>
        <dict>
            <key>fontStyle</key>
            <string>bold</string>
            <key>foreground</key>
            <string>#FD971F</string>
        </dict>
    </dict>
    <dict>
        <key>name</key>
        <string>Embedded Java Code Directive</string>
        <key>scope</key>
        <string>punctuation.section.directive</string>
        <key>settings</key>
        <dict>
            <key>foreground</key>
            <string>#FD971F</string>
        </dict>
    </dict>
    <dict>
        <key>name</key>
        <string>Embedded Java Code</string>
        <key>scope</key>
        <string>source.java.embedded.html</string>
        <key>settings</key>
        <dict>
            <key>foreground</key>
            <string>#F8F8F2</string>
        </dict>
    </dict>
    <dict>
        <key>name</key>
        <string>Embedded Java Code String</string>
        <key>scope</key>
        <string>string.quoted.double.java</string>
        <key>settings</key>
        <dict>
            <key>foreground</key>
            <string>#E6DB74</string>
        </dict>
    </dict> 
```

然后我在文件夹中编辑了这两个文件`HTML`，`Java`并注释掉了一些 ruby​​ 包含和东西。

在此处查看文件：

[HTML.tmLanguage](https://gist.github.com/dsine-de/dab215c468d32dd5ee5d)
[Java 服务器页面 (JSP).tmLanguage](https://gist.github.com/dsine-de/3718a5d013a5d2dc4dff)
[JavaScript.tmLanguage](https://gist.github.com/dsine-de/e888aa3c959993c690ab)

# python - 在python中测试返回可迭代的函数

> ID：12643762
> 
> 赞同：8
> 
> 时间：2012-09-28T16:21:54.860
> 
> 标签：python, testing, iterator

我在测试返回可迭代的 python 函数时遇到困难，例如产生的函数或仅返回可迭代的函数，例如`return imap(f, some_iter)`or `return permutations([1,2,3])`。

因此，对于排列示例，我希望函数的输出为`[(1, 2, 3), (1, 3, 2), ...]`. 所以，我开始测试我的代码。

```
def perm3():
  return permutations([1,2,3])

# Lets ignore test framework and such details
def test_perm3():
  assertEqual(perm3(), [(1, 2, 3), (1, 3, 2), ...]) 
```

这不起作用，因为`perm3()`它是可迭代的，而不是列表。所以我们可以修复这个特定的例子。

```
def test_perm3():
  assertEqual(list(perm3()), [(1, 2, 3), (1, 3, 2), ...]) 
```

这很好用。但是如果我有嵌套的迭代呢？那是迭代产生迭代吗？喜欢说表情 `product(permutations([1, 2]), permutations([3, 4]))`。现在这可能没用，但很明显（一旦展开迭代器）它将类似于`[((1, 2), (3, 4)), ((1, 2), (4, 3)), ...]`. 但是，我们不能只环绕`list`我们的结果，因为它只会`iterable<blah>`变成`[iterable<blah>, iterable<blah>, ...]`. 好吧，我当然可以`map(list, product(...))`，但这仅适用于嵌套级别 2。

那么，python 测试社区是否有针对测试迭代的问题的解决方案呢？当然，有些可迭代对象不能以这种方式进行测试，比如如果你想要一个无限的生成器，但这个问题仍然应该足够普遍，以至于有人已经考虑过这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T17:13:51.900

我使用[KennyTM 的 assertRecursiveEq](https://stackoverflow.com/a/3124155/190597)：

```
import unittest
import collections
import itertools

class TestCase(unittest.TestCase):
    def assertRecursiveEq(self, first, second, *args, **kwargs):
        """
        https://stackoverflow.com/a/3124155/190597 (KennyTM)
        """
        if (isinstance(first, collections.Iterable)
            and isinstance(second, collections.Iterable)):
            for first_, second_ in itertools.izip_longest(
                    first, second, fillvalue = object()):
                self.assertRecursiveEq(first_, second_, *args, **kwargs)
        else:
            # If first = np.nan and second = np.nan, I want them to
            # compare equal. np.isnan raises TypeErrors on some inputs,
            # so I use `first != first` as a proxy. I avoid dependency on numpy
            # as a bonus.
            if not (first != first and second != second):
                self.assertAlmostEqual(first, second, *args, **kwargs)                

def perm3():
    return itertools.permutations([1,2,3])

class Test(TestCase):
    def test_perm3(self):
        self.assertRecursiveEq(perm3(),
            [(1, 2, 3), (1, 3, 2), (2, 1, 3), (2, 3, 1), (3, 1, 2), (3, 2, 1)])

if __name__ == '__main__':
    import sys
    sys.argv.insert(1, '--verbose')
    unittest.main(argv = sys.argv) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T20:41:45.087

**1\. 如果结果的顺序无关紧要**

使用[unittest.assertItemsEqual()](http://docs.python.org/library/unittest.html#unittest.TestCase.assertItemsEqual)。这将测试项目是否存在于 self 和 reference 中，但忽略顺序。这适用于您的示例一个嵌套的深层示例。它也适用于我编写的一个 2-deep 示例。

**2\. 如果结果的顺序很重要**

我建议不要将**perm3()**的结果投射到列表中。相反，在迭代时直接比较元素。这是一个适用于您的示例的测试功能。我将它添加到 unittest.TestCase 的子类中：

```
def assertEqualIterables(self, itable1, itable2):
     for ival1, ival2 in zip(itable1, itable2):
         if "__iter__" in dir(ival1):
             self.assertEqualIterables(ival1, ival2)
         else:
             self.assertEquals(ival1, ival2) 
```

像这样使用它：

```
def test_perm3(self):
    reference = [((1, 2), (3, 4)), ((1, 2), (4, 3)), 
                 ((2, 1), (3, 4)), ((2, 1), (4, 3)),]

    self.assertEqualIterables(perm3(), reference) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T17:02:59.350

您可以扩展您的建议以包括`type`（允许您区分列表、元组等），如下所示：

```
def unroll(item):
  if "__iter__" in dir(item):
    return map(unroll, item), type(item)
  else:
    return item, type(item) 
```

例如：

```
got = unroll(permutations([1,2]))
([([(1, <type 'int'>), (2, <type 'int'>)], <type 'tuple'>), ([(2, <type 'int'>), (1, <type 'int'>)], <type 'tuple'>)], <type 'itertools.permutations'>)
# note the final: <type 'itertools.permutations'>
expected = [(1, 2), (2, 1)]
assertEqual(x[0], unroll(expected) ) # check underlying
assertEqual(x[1], type(permutations([]) ) # check type 
```

.

值得一提的`type`是，在区分*对象*时很粗糙，例如`<type 'classobj'>`...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:21:54.860

我不知道 python 程序员测试迭代的任何标准方式，但您可以简单地将您的想法应用`map`到适用`list`于任何嵌套级别的递归函数中。

```
def unroll(item):
  if "__iter__" in dir(item):
    return map(unroll, item)
  else:
    return item 
```

然后你的测试将真正起作用。

```
def test_product_perms():
  got = unroll(product(...))
  expected = [[[1, 2], [3, 4]], [[1, 2], [4, 3]], ...]
  assertEqual(got, expected) 
```

但是，如您所见，这有一个缺陷。当展开某些东西时，它总是会变成一个数组，这对于可迭代对象来说是可取的，但它也适用于元组。因此，我不得不手动将预期结果中的元组转换为列表。因此，您无法区分输出是列表还是元组。

这种幼稚方法的另一个问题是，通过测试并不意味着该功能有效。假设您检查`assertEqual(list(my_fun()), [1, 2, 3])`，而您认为它可能会返回一个迭代，当“列出”时等于`[1, 2, 3]`。可能是它没有返回您想要的可迭代对象，它也可能返回了列表或元组！

# java - 在 Tomcat 中写入临时文件

> ID：12643765
> 
> 赞同：1
> 
> 时间：2012-09-28T16:22:03.183
> 
> 标签：java, tomcat, file-io, temporary-files

我需要创建临时目录，但是当我尝试在临时目录中创建文件时总是被拒绝访问。

```
java.io.FileNotFoundException: C:\tmpDir7504230706415790917 (Access Denied) 
```

这是我的代码：

```
public static File createTempDir() throws IOException {
    File temp = File.createTempFile("tmpDir", "", new File("C:/"));

    temp.delete();
    temp.mkdir();
    return temp;
}

public File createFile(InputStream inputStream, File tmpDir ) {
    File file = null;
    if (tmpDir.isDirectory()) {
        try {
            file = new File(tmpDir.getAbsolutePath());
            // write the inputStream to a FileOutputStream
            OutputStream out = new FileOutputStream(file);

            int read = 0;
            byte[] bytes = new byte[1024];

            while ((read = inputStream.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }

            inputStream.close();
            out.flush();
            out.close();

            System.out.println("New file created!");
        } catch (IOException e) {
            System.out.println(e.getMessage());
        } 
    }
    return file;
} 
```

我正在开发一个 Web 应用程序，并且正在使用 tomcat。有没有办法在tomcat服务器内存上创建临时文件？我知道这很奇怪，但我不知道……也许有可能。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-28T16:41:47.823

您可以使用 Tomcat 的临时文件夹。
如果你使用

```
<%=System.getProperty("java.io.tmpdir")%> 
```

在 JSP 中，您可以获得它的路径。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T16:33:30.943

代码中的这一行表示在目录“C:\”中创建一个名称以文本“tmpDir”开头的文件。那不是你想要的。

```
File temp = File.createTempFile("tmpDir","",new File("C:/")); 
```

操作系统正确地不允许这样做，因为 C:\ 是受保护的目录。请改用以下内容：

```
File temp = File.createTempFile("tmp",null); 
```

这将让 Java 确定适当的临时目录。您的文件将具有简单的前缀“tmp”，后跟一些随机文本。您可以将“tmp”更改为对您的应用有意义的任何内容，以防您需要手动清除这些临时文件并且希望能够快速识别它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:34:21.000

`C:\`由于默认权限设置，您通常无法直接写入。我有时有这样做的许可问题。但是，您可以在用户文件夹中写入临时文件。通常，这是`C:\Documents and Settings\UserName\`在 XP 或vista 和 Windows 7 上。如果您想根据操作系统平台获取主目录，则 Apache Lang`C:\Users\UserName\`的一个名为[SystemUtils的工具非常有用。](https://commons.apache.org/lang/api-2.5/org/apache/commons/lang/SystemUtils.html)

例如：

```
SystemUtils.getUserDir();
SystemUtils.getUserHome(); 
```

**更新**

此外，您创建了一个临时文件对象，但您调用 mkdir 将其放入目录并尝试将文件写入该目录对象。您只能将文件写入目录，但不能写入目录本身。要解决此问题，请不要调用`temp.mkdir();`或将其更改`file=new File(tmpDir.getAbsolutePath());`为`file=new File(tmpDir, "sometempname");`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-03T19:15:21.617

在安装了 tomcat7 的 Linux 上：

因此，如果您正在运行 Web 应用程序，这是 Tomcat 用于创建临时文件的临时目录。

```
TOMCAT_HOME/temp 
```

在我的情况下 TOMCAT_HOME => /usr/share/tomcat7

如果你在没有 tomcat 的情况下运行 Java 程序，默认情况下它使用 /tmp 目录。

不确定它是否会影响，但我也运行了这个命令。

```
chmod 777 on TOMCAT_HOME/temp 
```

# javascript - this.$('.selector') 在 jQuery 中做了什么？

> ID：12643767
> 
> 赞同：8
> 
> 时间：2012-09-28T16:22:07.790
> 
> 标签：javascript, jquery, backbone.js, scope

我在某人的代码中看到了这一点：`this.$('.selector')`我很好奇它的作用。“this”是一个主干视图。那么前缀“这个”是什么。在给定的上下文中，放到一个 jQuery 选择器上，做吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T16:26:06.017

从[文档](http://backbonejs.org/#View-dollar)：

> **$（jQuery 或 Zepto）view.$（选择器）**
> 
> 如果页面中包含 jQuery 或 Zepto，则每个视图都有一个 $ 函数，用于运行视图元素范围内的查询。如果你使用这个作用域的 jQuery 函数，你不必使用模型 ID 作为查询的一部分来提取列表中的特定元素，并且可以更多地依赖 HTML 类属性。相当于运行：`view.$el.find(selector)`

```
ui.Chapter = Backbone.View.extend({
  serialize : function() {
    return {
      title: this.$(".title").text(),
      start: this.$(".start-page").text(),
      end:   this.$(".end-page").text()
    };
  }
}); 
```

简而言之，它用于使用熟悉的语法访问 View 的某些元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T16:24:39.943

它基本上将搜索具有类的元素限制为`selector`您的视图所基于的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:27:10.887

它基本上是将搜索范围从 更改`document`为`this`，这显然是一些元素。

# php - HTTP 客户端类中的单例模式是否会导致竞争条件？

> ID：12643769
> 
> 赞同：1
> 
> 时间：2012-09-28T16:22:21.783
> 
> 标签：php, zend-framework, singleton, race-condition, zend-http-client

我正在使用 Zend HTTP 客户端来实现与第三方服务通信的 Web 客户端。我正在考虑使其成为单例模式，以便每次调用都可以利用服务中的 cookie，这样我们就不需要在每次实例化新版本的客户端时重新登录。

客户端将有多个类与它通信，可能来自代码中的几个不同位置一次尝试。我担心当多个实体尝试一次使用它时，拥有一个单例客户端会导致竞争条件。

这会是 PHP HTTP 客户端中的单例模式的问题吗？如果是这样，有没有其他方法可以让 Zend HTTP 客户端受益，它可以跨多个事务存储和使用 cookie 而不会出现这些问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:26:43.003

由于 PHP 不是多线程的，仅此一项不应该导致竞争条件。

如果同时有多个请求并且您正在使用共享资源（例如服务器上的文件），这是可能的。在这种情况下，您将需要适当的锁定，例如`flock()`.

您还可以为每个会话存储 cookie，即无共享架构；这也应该解决问题。

# git - 避免合并冲突

> ID：12643774
> 
> 赞同：1
> 
> 时间：2012-09-28T16:22:32.203
> 
> 标签：git, git-merge

假设我在 master 分支中有一个文件：

```
Hello World! 
```

我创建了一个新分支 A 并将同一个文件修改为：

```
Hello World!
and a little more 
```

然后我在主分支中修改同一个文件

```
Hello World, the bug is fixed! 
```

有没有办法将两个分支合并为：

```
Hello World, the bug is fixed!
and a little more 
```

无需解决冲突？

ps：对 git 来说是全新的，所以我可能会错过一些明显的东西——我使用 netbeans 作为 IDE 并使用内置的合并功能

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:35:09.577

当两个更改修改代码的同一部分时，就会出现冲突。它无法在没有人工参与的情况下通过机器智能自动解决，因为机器无法准确知道文字合并是否有效。考虑以下示例：

基础版本：

```
char s[200]; 
```

第一个修改版本：

```
char s[100]; // reduce array size 
```

第二个修改版本：

```
char s[200];
s[199] = 0; 
```

如果合并工具按照您的建议执行，结果将是：

```
char s[100]; // reduce array size
s[199] = 0; 
```

显然，结果是错误的。

所以不要指望机器可以为你解决冲突。我们程序员保证在可预见的将来拥有这个特权，:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T16:40:44.783

冲突源于模棱两可，有时是不可避免的。尝试使用像[meld](http://meldmerge.org/)这样的工具来帮助快速解决合并冲突，并减少痛苦的体验。

我还建议您在尝试合并之前先从工作分支执行 rebase 以从 master 中提取更改。最好先在您的分支中本地解决冲突，这样您就可以进行简单的快进合并。

# function - dojo 1.7.2+ 需要自定义模块

> ID：12643778
> 
> 赞同：0
> 
> 时间：2012-09-28T16:22:39.180
> 
> 标签：function, dojo, require

我编写了一个自定义模块，例如它正在打印`"Hello World"`到控制台。

```
require([
    "dojo/_base/declare"
    ],
    function(declare) {

        return [
            declare("Hello", null, {

                printHello : function() {
                    console.log("Hello, World!");
                }
            })
        ];
    }
); 
```

`.js`文件名是“ `Hello.js`”。在我的 html 页面中，我需要这个模块，但是我在加载它时遇到了问题。我的代码：

```
<script type="text/javascript">
    var dojoConfig = {
            async : true,
            parseOnLoad : false,
            isDebug : true,
        packages: [
                   { name: "gui", location: "/scripts/gui" }
         ]
    };
    require([ 
              "gui/common/Hello"
            ],

    function(HelloFunciton) {
        var hello = new Hello();
        hello.printHello();

    });
</script> 
```

但是我在控制台中有一个错误：

```
"NetworkError: 404 Not Found - http://ajax.googleapis.com/ajax/libs/dojo/1.7.2/scripts/gui/common/Hello.js" 
```

它应该来自本地主机的javascript文件......可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:27:53.220

添加`baseUrl: "./"`到您的`dojoConfig`.

还可以通过`./scripts/gui`.

完整的 HTML 文件：

```
<html>
    <head>
        <script>
            var dojoConfig = {
                async: true,
                baseUrl: "./",
                parseOnLoad: false,
                isDebug: true,
                packages: [
                    { name: "gui", location: "./scripts/gui" }
                ]
            }
        </script>
        <script src="http://ajax.googleapis.com/ajax/libs/dojo/1.7.2/dojo/dojo.js"></script>
        <script>
            require(["gui/common/Hello"], function(Hello) {
                var hello = new Hello();
                hello.printHello();
            });
        </script>
    </head>
    <body>
    </body>
</html> 
```

模块文件`./scripts/gui/common/Hello.js`：

```
define([
    "dojo/_base/declare"
], function(
    declare
) {

    return declare([], {
        printHello: function() {
            console.log("Hello world!");
        }
    });

}); 
```

# jquery - 如何使用 jquery 在表中查找 td 的父 tr？

> ID：12643792
> 
> 赞同：16
> 
> 时间：2012-09-28T16:23:18.627
> 
> 标签：jquery

我正在研究 asp.net mvc 3。我有以下结构，

```
<tr data-uid="123">
<td>
<a href="#" id="click">Click Me</a>
</td>
</tr> 
```

现在我想找到标签数据属性值。我试过像，

```
$("a#click").click(function(){
 var i= $(this).parent('td').parent('tr').data('uid');
}); 
```

但对我不起作用。请指导我。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-28T16:48:52.797

[`closest`](https://api.jquery.com/closest/)如果不想在每个级别爬上父级，您可以使用该方法获取查询的选择器的最近父级。

```
$("#click").click(function(e){
    e.preventDefault();

    var $i = $(this).closest('tr').attr('data-uid');
    console.log($i);

    var $j = $(this).closest('tr').data('uid');
    console.log($j);
});​ 
```

`e.preventDefault()`只是为了防止默认操作。如果不需要，可以将其删除。

还要确保您`tr`包含在表格标签内以使其正常工作..

[在这里提琴](http://jsfiddle.net/sushanth009/vmTvV/4/)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-05-23T13:09:15.523

## 回答

```
$("a#click").click(function(e){
    e.preventDefault();
    var i = $(this).closest('tr').attr('data-uid');
    console.log(i);
    var j = $(this).closest('tr').data('uid');
    console.log(j);
}); 
```

**[查看演示](http://jsfiddle.net/g8MKK/)**

* * *

## 如何找到最近的行？

**使用`.closest()`：**

```
var $row = $(this).closest("tr"); 
```

* * *

**使用`.parent()`：**

检查此[`.parent()`](http://api.jquery.com/parent/)方法。这是 a`.prev()`和的替代方案`.next()`。

```
var $row = $(this).parent()             // Moves up from <button> to <td>
                  .parent();            // Moves up from <td> to <tr> 
```

* * *

### 获取所有表格单元格**`<td>`**

```
var $row = $(this).closest("tr"),       // Finds the closest row <tr> 
    $tds = $row.find("td");             // Finds all children <td> elements

$.each($tds, function() {               // Visits every single <td> element
    console.log($(this).text());        // Prints out the text within the <td>
}); 
```

**[查看演示](http://jsfiddle.net/CKEc6/1/)**

* * *

### 只获取特定的**`<td>`**

```
var $row = $(this).closest("tr"),        // Finds the closest row <tr> 
    $tds = $row.find("td:nth-child(2)"); // Finds the 2nd <td> element

$.each($tds, function() {                // Visits every single <td> element
    console.log($(this).text());         // Prints out the text within the <td>
}); 
```

**[查看演示](http://jsfiddle.net/T9uv7/)**

* * *

### 有用的方法

*   [`.closest()`](http://api.jquery.com/closest/)- 获取与选择器匹配的第一个元素
*   [`.parent()`](http://api.jquery.com/parent/)- 获取当前匹配元素集中每个元素的父元素
*   [`.parents()`](http://api.jquery.com/parents/)- 获取当前匹配元素集中每个元素的祖先
*   [`.children()`](https://api.jquery.com/children/)- 获取匹配元素集中每个元素的子元素
*   [`.siblings()`](http://api.jquery.com/siblings/)- 获取匹配元素集中每个元素的兄弟姐妹
*   [`.find()`](http://api.jquery.com/find/)- 获取当前匹配元素集中每个元素的后代
*   [`.next()`](http://api.jquery.com/next/)- 获取匹配元素集中每个元素的紧随其后的兄弟
*   [`.prev()`](https://api.jquery.com/prev/)- 获取匹配元素集中每个元素的前一个兄弟元素

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:24:59.037

您的代码应该按原样工作，但您可以使用 parent('tr') 而不是使用多个 .parent()。[http://api.jquery.com/parents/](http://api.jquery.com/parents/)

```
$(function() {
  $("a#click").click(function(){
    var i= $(this).parents('tr').data('uid');
  });​
}); 
```

演示：http: [//jsfiddle.net/mchambaud/G5jM8/1/](http://jsfiddle.net/mchambaud/G5jM8/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:24:59.540

你试过`.attr()`吗？

```
$("a#click").click(function(){
    var i= $(this).parent('td').parent('tr').attr('data-uid');
    console.log( i );
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T16:26:51.770

用这个：

```
var i= $(this).parent('td').parent('tr').attr('data-uid'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-04T17:17:41.487

`.closest()`- 获取匹配选择器的第一个元素
`.parent()`- 获取当前匹配元素集中每个元素的父元素
`.parents()`- 获取当前匹配元素集中每个元素的祖先 - 获取匹配元素集中
`.children()`每个元素的子元素
`.siblings()`- 获取匹配元素集中每个元素的兄弟
`.find()`- 获取当前匹配元素集中每个元素的后代 - 获取匹配元素集中每个元素
`.next()`的紧随其后的兄弟 - 获取每个元素的
`.prev()`前一个兄弟匹配元素集中的元素

这将帮助你

# android - 有人知道我可以将 twitter 数据加载到带有 Eclipse 列表的 android 中吗？

> ID：12643793
> 
> 赞同：-3
> 
> 时间：2012-09-28T16:23:24.383
> 
> 标签：android, eclipse, listview, twitter

我需要做的是显示一个推特提要，但也能够使用文本框和提交按钮更新我的推特。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T17:47:45.243

此处的示例代码 - [http://codehenge.net/blog/2011/05/android-programming-tutorial-a-simple-twitter-feed-reader/](http://codehenge.net/blog/2011/05/android-programming-tutorial-a-simple-twitter-feed-reader/)

在页面底部下载完整的 java 代码和清单。

```
public ArrayList<Tweet> getTweets(String searchTerm, int page) {
  String searchUrl = 
        "http://search.twitter.com/search.json?q=@" 
        + searchTerm + "&rpp=100&page=" + page;

  ArrayList<Tweet> tweets = 
        new ArrayList<Tweet>();

  HttpClient client = new  DefaultHttpClient();
  HttpGet get = new HttpGet(searchUrl);

  ResponseHandler<String> responseHandler = 
        new BasicResponseHandler();

  String responseBody = null;
  try {
    responseBody = client.execute(get, responseHandler);
  } catch(Exception ex) {
    ex.printStackTrace();
  }

  JSONObject jsonObject = null;
  JSONParser parser=new JSONParser();

  try {
    Object obj = parser.parse(responseBody);
    jsonObject=(JSONObject)obj;
  }catch(Exception ex){
    Log.v("TEST","Exception: " + ex.getMessage());
  }

  JSONArray arr = null;

  try {
    Object j = jsonObject.get("results");
    arr = (JSONArray)j;
  } catch(Exception ex){
    Log.v("TEST","Exception: " + ex.getMessage());
  }

  for(Object t : arr) {
    Tweet tweet = new Tweet(
      ((JSONObject)t).get("from_user").toString(),
      ((JSONObject)t).get("text").toString(),
      ((JSONObject)t).get("profile_image_url").toString()
    );
    tweets.add(tweet);
  }

  return tweets;
} 
```

# c# - .NET 线程问题，TcpClient

> ID：12643794
> 
> 赞同：1
> 
> 时间：2012-09-28T16:23:29.360
> 
> 标签：c#, .net, multithreading, memory-leaks, tcpclient

我的服务的线程数变得疯狂。

每次需要连接时，我都会创建新的 tcpclient。由 taskfactory 处理，具有长时间运行的任务标志。

我使用 2 个并发包和手动重置事件，代码正确处理对象，并且没有任何东西挂起（据我所知）。

问题只出现在windows xp机器上，windows 7没问题。所以我想这不是代码。

有什么方法可以检查 PC 上的线程池有多忙？

我已经在[这里发布了](https://stackoverflow.com/questions/12622114/taskfactory-tcpclient#comment17019767_12622114)

非常感谢任何建议。

![附件截图显示了问题](../Images/78ab7cae9a8f22e936b9704041bb4423.png)

谢谢卢克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T22:53:39.613

尝试从 ThreadPool 获取可用线程：http: [//msdn.microsoft.com/en-us/library/system.threading.threadpool.getavailablethreads%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.getavailablethreads%28v=vs.90%29.aspx)

如果您正在开发一个非业余的解决方案，我建议您不要放弃 ThreadPool。相反，您可能在客户端之间共享了几个（或更多）线程。

# python - 给a里面的句子编号 在 .xml 文件中？

> ID：12643798
> 
> 赞同：1
> 
> 时间：2012-09-28T16:23:50.593
> 
> 标签：python, xml

我是一名初级程序员，我遇到了这个可能很简单的问题：我想自动将数字添加到 .xml 文件的 P 标记中包含的句子中。因此 .xml 文件中的示例段落如下所示：

```
<P>Sentence1\. Sentence2\. Sentence3.</P> 
```

我想将其转换为：

```
<P><SUP>1</SUP>Sentence1.<SUP>2</SUP> Sentence2.<SUP>3</SUP> Sentence3.</P> 
```

然而，只有包含至少 2 个句子的 P 标签才应该编号，如果它只包含 1 个句子，我想保持不变。

到目前为止，这是我使用正则表达式提出的方法：

```
\.\s.*
# Reliably finds the second sentence, Insert <SUP>2</SUP> after it.
<P>[^>]*<SUP>2
# Finds the beginning of the first sentence if a second sentence exists. 
```

但是我觉得这是一种非常尴尬的方法，我真的不知道如何扩展包含 20 个或更多句子的段落，或包含许多段落的 .xml 文档。是否有比正则表达式更好的正则表达式或更好的（Python）工具来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:46:46.797

像这样的东西（非常未经测试）可能会起作用

```
import xml.etree.ElementTree as ET
tree = ET.parse(XML_FILE)
root = tree.getroot()

for p in root.iter('p'):
   sentences = p.text.split('.')
   p.text = ".".join([("<sup>%i<sup>" % count) + sentence for count, sentence in enumerate(sentences)])

tree.write(XML_FILE) 
```

# java - 从 Java 使用外部程序的必要权限

> ID：12643804
> 
> 赞同：1
> 
> 时间：2012-09-28T16:24:13.790
> 
> 标签：java, linux, permissions, external

我编写的 Java 应用程序依赖于小型 C 程序。我决定将该程序的可执行版本放在资源中，当用户启动我的应用程序时，应用程序将创建该程序的临时版本，并在关闭时将其删除。

这是主java程序的构造函数：

```
public RankingCreator(String title) {
    super(title);

    if (!tempJudgeCreated) { // static variable
        try {
            InputStream istream = (InputStream) getClass().getResourceAsStream("/res/IOIJudge");
            byte[] tempJudgeBytes = new byte[SIZE_OF_JUDGE];
            istream.read(tempJudgeBytes);
            istream.close();
            FileOutputStream ostream = new FileOutputStream(JUDGE);
            ostream.write(tempJudgeBytes);
            ostream.flush();
            ostream.close();
            Runtime.getRuntime().exec("chmod 777 " + JUDGE); // this line creates confusion
            tempJudgeCreated = true;
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

当我在 Eclipse 中时，这可以完美地工作，但是当我将它导出到可运行的 JAR 中时，此代码会失败，甚至不会进入 GUI 部分。当我删除 Runtime.getRuntime()... 时，它会进入 GUI，但我没有必要的权限来使用它（临时程序）。

# vb.net - 管理代码的用户配置文件

> ID：12643805
> 
> 赞同：-1
> 
> 时间：2012-09-28T16:24:18.943
> 
> 标签：vb.net, profiling, user-profile

我正在开发一个需要多个客户端同时访问该软件的 VB.NET 项目。但是，这些客户端将在软件上拥有不同级别的权限，例如一些是管理员，一些是经理，一些是用户。

如图所示，用户只能使用该软件的某些功能，而管理员可以完全控制该软件。

我将要求客户在启动软件时表明自己的身份，可能是通过用户名和密码。一旦确定，表单应用程序应该只向他们显示相关的表单和控件。

如何开发我的代码以便可以合并用户分析？是否有任何行业标准的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:55:47.377

我会将基于角色的安全性视为一个很好的起点。这是我发现的一篇文章，给出了一个这样做的例子 - [http://msdn.microsoft.com/en-us/library/aa480723.aspx](http://msdn.microsoft.com/en-us/library/aa480723.aspx) 它有点过时（2006），但我认为这些概念应该是最新的.

高温高压

韦德

# python - 列表未显示

> ID：12643806
> 
> 赞同：0
> 
> 时间：2012-09-28T16:24:19.710
> 
> 标签：python, python-3.x

我的程序的最后一部分没有出现，有人可以帮助我吗？

给定一个数字列表，将列表中的值标准化为 [0,1] 范围内。首先找到列表中的最小值和最大值，min_val 和 max_val。将列表中的每个元素 x 更改为新值 y, st y = (x-min_val)/(max_val-min_val)。打印修改后的列表。例如 list: [2,1,3,4] 变为： [0.3333333333333333, 0.0, 0.6666666666666666, 1.0] 您可以在程序中硬编码示例列表，但解决方案不应依赖它。也就是说，如果我们只修改该列表并重新运行您的程序，它应该会根据新列表产生正确的结果。

```
mylist=[3,1,5,9,2]
n=len(mylist)
newlist=[]
print("orginal list is:",mylist)

min_val=min(mylist)
print("minimum value is:",min_val)

max_val=max(mylist)
print("maximum value is:",max_val)

for x in range(1+n+1,1):
    newlist=((x-min_val)/(max_val-min_val))
print(newlist) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T17:06:56.913

在最后一部分中，您根本不对元素做任何事情`mylist`。

你需要类似的东西

```
newlist = [(x - min_val)/(max_val - min_val) for x in mylist] 
```

使用显式`for`循环，就像您尝试做的那样：

```
newlist = []
for x in mylist: # sic!
    newlist.append((x - min_val) / (max_val - min_val)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T17:10:34.513

首先，您在 for 的每一步都重新分配 newlist。

```
 for x in range(1+n+1,1):
      newlist.append((x-min_val)/(max_val-min_val))
  print(newlist) 
```

然后，您很可能需要修复您的“范围”功能 [如果使用 python2]；最后，您可能需要将这些 int 转换为浮点数以避免整数除法 [如果使用 python2]

```
 for x in mylist:
      newlist.append(float(x-min_val)/(max_val-min_val))
  print(newlist) 
```

# sip - Kamailio 中的自定义 SIP 标头

> ID：12643809
> 
> 赞同：2
> 
> 时间：2012-09-28T16:24:32.690
> 
> 标签：sip, voip, kamailio

我需要通过 Lua 脚本在 Kamailio 3.3.1 中设置自定义标头。我理论上可以像这样在配置脚本中设置一个 -

```
append_hf("X-MyHeader: myvalue\r\n"); 
```

但我不知道如何从 Lua 脚本中调用它，这是我首选的地方。我的 CFG 文件中有以下内容 -

```
modparam("app_lua", "load", "/usr/local/etc/kamailio/lua/kamailio.lua")
modparam("app_lua", "register", "sl")
modparam("app_lua", "register", "rr")
modparam("app_lua", "register", "tm") 
```

并且我的 Lua 脚本运行良好。文档似乎表明 append_hf() 是 textops 模块的一部分，但我看不出有办法将它暴露给 Lua 脚本。

请任何人都可以帮助我理解这一点，或者建议一种替代方法来实现我的目标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T16:37:09.327

完成了。

你需要使用 -

```
sr.hdr.append("header: value\r\n"); 
```

我花了 2 天时间寻找那个。发布后 5 分钟我找到了它。这是我得到答案的网址 -

[http://www.kamailio.org/wiki/embeddedapi/3.2.x/lua](http://www.kamailio.org/wiki/embeddedapi/3.2.x/lua)

# math - 我们如何在计算机体系结构的除法算术中得到余数？

> ID：12643815
> 
> 赞同：2
> 
> 时间：2012-09-28T16:24:49.333
> 
> 标签：math, hardware

我正在按照分步程序学习二进制除法。我被困在其余部分的第一步重复一中。要获得余数，公式为余数 = 余数 - 除数。

我们如何得到余数：11100110？我只是不明白我们如何在寄存器的左半部分有 1110。任何指南或帮助将不胜感激！谢谢：

该示例是使用 8 位 ALU 的 10/5。

我附上了示例的图片以供参考

![在此处输入图像描述](../Images/2c3ef1b7e958d2f58dfda9dc2b3c2389.png)

# iphone - iOS/iPhone：Web 应用程序启动画面未显示

> ID：12643817
> 
> 赞同：22
> 
> 时间：2012-09-28T16:24:55.313
> 
> 标签：iphone, ios, jquery-mobile, media-queries, splash-screen

我的网络应用程序中有以下代码`<head>`，但我的 iPhone 3GS 在加载 DOM 而不是启动屏幕时只是在我的 iPhone 3GS 上得到一个白屏。

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />

<!--STYLES-->

<!--SCRIPTS-->

<!-- iPhone LAUNCHSCREEN-->
<link href="includes/images/apple-launch-480h.png" sizes="320x480" media="(device-height: 480px)" rel="apple-touch-startup-image">
<!-- iPhone (Retina) LAUNCHSCREEN-->
<link href="includes/images/apple-launch-480h2X.png" sizes="640x920" media="(device-height: 480px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
<!-- iPhone 5+ LAUNCHSCREEN-->
<link href="includes/images/apple-launch-568h.png" sizes="640x1136" media="(device-height: 568px)" rel="apple-touch-startup-image"> 
```

**如何让我的启动画面在所有版本的 iPhone 上正确显示？**代码未显示，但我的 Web 应用程序图标在添加到主页时可以正常工作。我正在使用 jQuery Mobile 来构建这个网络应用程序。

我还确认 PNG 图像的大小完全正确，我已经删除了 Web 应用程序图标、刷新并多次重新添加到主屏幕。我在 StackOverflow 上找到的所有解决方案都不适合我。我没有尝试过 JavaScript 解决方案，因为我确信有一个纯 CSS 解决方案。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-10-03T15:03:20.227

该`sizes`属性适用于`apple-touch-icon`s，但不适用于`apple-touch-startup-image`s。定位启动图像的唯一方法是使用媒体查询。亚当的回答很好，但依赖于`<link>`s 的特定顺序，因为媒体查询未指定。以下是完全限定的媒体查询：

```
<!-- iPhone -->
<link href="apple-touch-startup-image-320x460.png"
      media="(device-width: 320px) and (device-height: 480px)
         and (-webkit-device-pixel-ratio: 1)"
      rel="apple-touch-startup-image">
<!-- iPhone (Retina) -->
<link href="apple-touch-startup-image-640x920.png"
      media="(device-width: 320px) and (device-height: 480px)
         and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image">
<!-- iPhone 5 -->
<link href="apple-touch-startup-image-640x1096.png"
      media="(device-width: 320px) and (device-height: 568px)
         and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image">
<!-- iPad (portrait) -->
<link href="apple-touch-startup-image-768x1004.png"
      media="(device-width: 768px) and (device-height: 1024px)
         and (orientation: portrait)
         and (-webkit-device-pixel-ratio: 1)"
      rel="apple-touch-startup-image">
<!-- iPad (landscape) -->
<link href="apple-touch-startup-image-748x1024.png"
      media="(device-width: 768px) and (device-height: 1024px)
         and (orientation: landscape)
         and (-webkit-device-pixel-ratio: 1)"
      rel="apple-touch-startup-image">
<!-- iPad (Retina, portrait) -->
<link href="apple-touch-startup-image-1536x2008.png"
      media="(device-width: 768px) and (device-height: 1024px)
         and (orientation: portrait)
         and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image">
<!-- iPad (Retina, landscape) -->
<link href="apple-touch-startup-image-1496x2048.png"
      media="(device-width: 768px) and (device-height: 1024px)
         and (orientation: landscape)
         and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"> 
```

另请注意，某些视口会导致您的 Web 应用程序在 iPhone 5 上被加黑：

```
<!-- Letterboxed on iPhone 5 -->
<meta name="viewport"
      content="width=device-width">
<meta name="viewport"
      content="width=320">
<!-- Not letterboxed on iPhone 5 -->
<meta name="viewport"
      content="initial-scale=1.0">
<meta name="viewport"
      content="width=320.1"> 
```

[我用一个最小的 iOS 网络应用程序](https://gist.github.com/2222823)维护一个要点，包括启动图像和图标。如果您想要更多评论，我还写[了一篇关于 iPhone 5 启动图像的博客文章](http://taylor.fausak.me/2012/09/20/iphone-5-web-app-startup-image/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T16:28:01.440

以下是要使用的尺寸：

```
<!-- iPhone -->
<link href="http://www.example.com/mobile/images/apple-startup-iPhone.jpg" media="(device-width: 320px)" rel="apple-touch-startup-image">

<!-- iPhone (Retina) -->
<link href="http://www.example.com/mobile/images/apple-startup-iPhone-RETINA.jpg" media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">

<!-- iPhone Tall (Retina) -->
<link href="http://www.example.com/mobile/images/apple-startup-iPhone-Tall-RETINA.jpg" rel="apple-touch-startup-image" sizes="640x1096">

<!-- iPad (portrait) -->
<link href="http://www.example.com/mobile/images/apple-startup-iPad-Portrait.jpg" media="(device-width: 768px) and (orientation: portrait)" rel="apple-touch-startup-image">

<!-- iPad (landscape) -->
<link href="http://www.example.com/mobile/images/apple-startup-iPad-Landscape.jpg" media="(device-width: 768px) and (orientation: landscape)" rel="apple-touch-startup-image">

<!-- iPad (Retina, portrait) -->
<link href="http://www.example.com/mobile/images/apple-startup-iPad-RETINA-Portrait.jpg" media="(device-width: 768px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">

<!-- iPad (Retina, landscape) -->
<link href="http://www.example.com/mobile/images/apple-startup-iPad-RETINA-Landscape.jpg" media="(device-width: 768px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"> 
```

# jquery - 销售管道图

> ID：12643824
> 
> 赞同：2
> 
> 时间：2012-09-28T16:25:19.100
> 
> 标签：jquery, d3.js

我正在尝试使用 d3 创建销售管道图。下面是一个例子。有谁知道我可以开始的任何示例代码？

![http://i.imgur.com/FKoHk.png](../Images/62ee0316e4a2efa4544cf4e4c514d66e.png)

感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T20:26:56.993

对于不同的方法，这里是一个完全使用 CSS 的示例：

```
<div id='chart'>
  <div id='plotA'>&nbsp;</div>
  <div id='plotB'>&nbsp;</div>
  <div id='plotC'>&nbsp;</div>
  <div id='plotD'>&nbsp;</div>
  <div id='plotE'>&nbsp;</div>
</div>

#chart {
  text-align: center;
}
#chart div {
  margin-top: 2px;
}
#plotA {
  border-top: 5px solid #3B5592;
  border-left: 2px solid transparent;
  border-right: 2px solid transparent;
  height: 0; width: 200px;
}
#plotB {
  border-top: 100px solid #BF2E2B;
  border-left: 50px solid transparent;
  border-right: 50px solid transparent;
  height: 0; width: 100px;
}
#plotC {
  margin-left: 50px;
  border-top: 50px solid #8CB638;
  border-left: 25px solid transparent;
  border-right: 25px solid transparent;
  height: 0; width: 50px;
}
#plotD {
  margin-left: 74px;
  border-top: 23px solid #684A94;
  border-left: 16px solid transparent;
  border-right: 16px solid transparent;
  height: 0; width: 18px;
}
#plotE {
  margin-left: 90px;
  border-top: 15px solid #24A4C7;
  border-left: 7px solid transparent;
  border-right: 7px solid transparent;
  height: 0; width: 4px;
} 
```

[带演示](http://cssdesk.com/F24NK)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:36:17.140

[Anna Powell-Smith](http://anna.ps/)在 github 上有一个名为[funnel-plots](https://github.com/annapowellsmith/funnel-plots)的项目，它可以让您抢占先机。您将需要预先建立一些定义来呈现它。有人觉得这张图[有点意思](http://blog.spark59.com/2012/why-not-the-funnel-chart/)（我碰巧觉得有更好的图表），但它们是人们期望看到的，所以这里是你可以解决它们的方法。首先，您需要确定步骤是否具有统一的高度并且它们的宽度是可变的（因此在每个步骤中，您将宽度减小的百分比与绘制值减小的百分比相同）或者最小值和最大值是否由它们的绘制值确定但是调整中间台阶的高度以表示它们的绘制值（使用每个台阶的体积），这是您问题中引用图表的方法。

# android - AndroidManifest.xml 隐含与显式权限（ uses-feature 与 uses-permission ）

> ID：12643825
> 
> 赞同：8
> 
> 时间：2012-09-28T16:25:19.057
> 
> 标签：android, sdk, permissions, android-manifest, filtering

我的应用程序中有一些权限，例如

```
<uses-permission android:name="android.permission.CONTROL_LOCATION_UPDATES" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION" /> 
```

我怀疑它们实际上并不是必需的。

根据Android文档，它们都暗示

```
<uses-feature
    android:name="android.hardware.location"/> 
```

是真实的和必需的。

所以，例如，如果我取出三个命令中的两个，我所有与 A-GPS 相关的调用仍然会以**完全相同的**方式工作吗？

除了人们重复 android 文档之外，似乎并没有太多关于此的文献。

最终，我认为对这么多代码元素暗示 android:required = true 限制了我可以访问的设备数量。

```
 <uses-feature
    android:name="android.hardware.location" android:required="false"/> 
```

将向更多设备开放应用程序，我可以在应用程序中使用条件逻辑来允许执行某些功能。

但我的主要问题是它`android.hardware.location`涵盖了很多`<uses-permission/>`功能。没有`android.hardware.location.ACCESS_MOCK_LOCATION`或`android.hardware.location.CONTROL_LOCATION_UPDATES`，只有`android.hardware.location`

这里有几个假设，但 android 开发人员文档并没有详细说明，只是表明这些单独的`uses-permissions`意味着需要一个`uses-feature`。当它不一定是必需的时，我只想确保我的 android sdk 调用有权运行

问题：

1) 如果我取出其中三个中的两个`uses-permissions`，我的所有与 A-GPS 相关的调用是否仍会像我设置了所有这些单独的权限一样以完全相同的方式工作？

2) 是否`android.hardware.location`变得更具体？我已经看到`android.hardware.location.NETWORK`了，但是我在哪里可以看到所有的可能性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T17:04:52.427

> 所以，例如，如果我取出三个命令中的两个，我所有与 A-GPS 相关的调用仍然会以完全相同的方式工作吗？

那么，这三个权限中的两个应该是不必要的。`ACCESS_MOCK_LOCATION`与 GPS 无关，而是与您自己的模拟位置提供商有关。引用[Cyril Mottier 的话](https://twitter.com/cyrilmottier/status/251423968832131074)：

> 伙计们，在发布您的应用程序之前，请从您的清单中删除 ACCESS_MOCK_LOCATION 权限。遗忘使你成为业余爱好者。

并且普通的 SDK 应用程序无法保存`CONTROL_LOCATION_UPDATES`——这仅适用于使用固件签名密钥签名或安装在固件本身中的应用程序。

因此，一个普通的 SDK 应用程序可以删除这两个用于生产，也可以删除`CONTROL_LOCATION_UPDATES`用于开发。如果您没有在您的应用程序中使用模拟位置提供程序，您也可以`ACCESS_MOCK_LOCATION`在开发中删除。最有可能的是，您一开始就不应该将这两个权限添加到您的应用程序中。

不过，这一切都与此无关`<uses-feature>`。

> 我可以在应用程序中使用条件逻辑来允许执行某些功能。

绝对地。你可以用`hasSystemFeature()`on`PackageManager`看看你有没有`android.hardware.location`，再麻烦处理`LocationManager`。

> 但我的主要问题是 android.hardware.location 涵盖了很多功能。

动词“cover”在这里对我来说毫无意义，或者在某种程度上，你的方向颠倒了。`<uses-permission>`元素可能暗示`<uses-feature>`元素，但不能反过来。

> 如果我取消了其中三个使用权限中的两个，我所有与 A-GPS 相关的调用是否仍会像我设置了所有这些单独的权限一样工作？

往上看。

> 我见过 android.hardware.location.NETWORK

你可能见过`android.hardware.location.network`。

> 我见过 android.hardware.location.NETWORK

在文档中：http `<uses-feature>`: [//developer.android.com/guide/topics/manifest/uses-feature-element.html](http://developer.android.com/guide/topics/manifest/uses-feature-element.html)

# opengl-es - OpenGL ES 2.0 中的非预定义多光源

> ID：12643829
> 
> 赞同：1
> 
> 时间：2012-09-28T16:25:54.907
> 
> 标签：opengl-es, opengl-es-2.0, glsl

[在 GLSL http://en.wikibooks.org/wiki/GLSL_Programming/GLUT/Multiple_Lights](http://en.wikibooks.org/wiki/GLSL_Programming/GLUT/Multiple_Lights)中有一篇关于多个光源的精彩文章
但是在着色器代码中描述的**light0**和**light1**参数，如果必须绘制火​​炬枪射击怎么办，例如每个火炬都有它有自己的位置、颜色和必须照亮周围的环境。我们如何管理其他对象着色器来处理未知（屏幕上的最大耀斑有限制）位置、耀斑颜色？例如，屏幕上最多有 8 个照明弹，我必须通过 8*2 制服，即使它们此时不存在？
或者想象你制作关卡编辑器，用户可以放置灯，其他对象如何“知道”新光源并渲染然后添加了新灯？
我认为必须有聪明的解决方案，但我找不到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T17:15:10.810

照明方程通常依赖于加色。所以输出是光一的颜色加上光二的颜色加上光三的颜色，以此类推。

OpenGL 提供的帧缓冲区内混合模式之一是加法混合。因此，您绘制的任何新内容的颜色输出都将添加到缓冲区中已有的内容中。

因此，最天真的解决方案是编写你的着色器来做一个光。如果您有多个灯光，请多次绘制场景，每次使用不同的指定线。[这是多通道渲染](http://www.excamera.com/articles/1/index.html)的一个例子。

更好的解决方案包括编写着色器来一次做两个、四个、八个或任何灯光，例如，做 15 个灯光作为 8 灯绘制然后是 4 灯绘制然后是 2 灯绘制然后是 1 灯绘制，并且当您通过时，仅包括每个灯光范围内的几何图形。这往往意味着找到智能的方法来按位置对灯光进行分组。

编辑：稍微考虑一下，我应该补充一点，在[deferred shading](http://en.wikipedia.org/wiki/Deferred_shading)中还有另一个选项，尽管由于输出缓冲区的选项有限，目前它在大多数 GL ES 设备上并不完全有用。

假设理论上您可以只渲染一次几何图形并存储每个像素所需的任何内容。因此，您不仅会输出颜色，还会输出 3d 空间中的位置、法线、漫反射颜色、镜面反射颜色和镜面反射指数。然后这些都将位于每个像素的缓冲区中。

然后，您可以通过 (i) 计算出投影到屏幕上时可以占用的最大空间（因此，一个与像素直接相关的 2d 矩形）来渲染每个灯光；(ii) 将光渲染为该大小的单个四边形，每个像素从您刚刚设置的缓冲区中读取相关值并输出适当点亮的颜色。

然后，您只需在场景中执行所有实际几何图形一次，并且每个额外的灯光最多将花费一个全屏四边形。

实际上，您不能真正做到这一点，因为您倾向于能够在 ES 中使用的输出缓冲区提供的存储空间太少。但是您通常可以做的是渲染到带有附加深度缓冲区的 32 位颜色缓冲区。因此，您可以将深度存储在深度缓冲区中，然后根据该值加上相机在光照着色器中的 [uniform] 位置计算出世界 (x, y, z)。您可以将 8 位版本的法线 x 和 y 存储在颜色缓冲区中，以便花费 16 位并在颜色缓冲区中计算 z，因为您知道法线始终是单位长度。然后，随机选择一个具体的例子，也许你可以在剩余空间中存储一个 16 位版本的漫反射颜色，可能在 YCrCb 中，为 Y 提供额外的存储空间。

主要缺点是硬件抗锯齿与透明度和深度缓冲区不太相同。但是，如果您达到了大幅节省照明的地步，那么通过渲染大版本的场景然后在最后一次通过时将其缩小来进行手动抗锯齿仍然是有意义的。

# iphone - 录制红色状态栏上的自定义文本

> ID：12643837
> 
> 赞同：3
> 
> 时间：2012-09-28T16:26:11.240
> 
> 标签：iphone, objective-c, ios, xcode

我的应用程序在 Info.plist 中被标记为 VoiP 和音频，因此当后台发生任何录制时，红色状态栏会出现文本“正在录制”。我想知道是否可以修改此文本。我到处搜索，但在文档中找不到与之相关的参数。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T00:39:56.867

看起来这是不可能的......关闭这个问题。

# mysql - 无法使用视图模块创建视图

> ID：12643838
> 
> 赞同：0
> 
> 时间：2012-09-28T16:26:12.387
> 
> 标签：mysql, drupal, drupal-views

我使用基于默认节点索引的 Views 模块创建了一个视图。但我发现的第一件事是这个错误信息：

> SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的“-1 OFFSET 0”附近使用正确的语法

什么可能导致这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T21:54:36.190

您的 SQL 语法有错误！

查看模块只是用于创建查询的 GUI，因此您确定您的选择是逻辑的以创建查询

# c# - 将 url 从 XML 文件分配给字符串不会转义？

> ID：12643839
> 
> 赞同：1
> 
> 时间：2012-09-28T16:26:24.530
> 
> 标签：c#, .net-4.0, linq-to-xml

我有一个如下所示的 XML 片段：

```
<url>
\\network\folder
<url> 
```

当我使用 将其读入字符串`string url = XElement("url").Value`时，存储在字符串变量中的值是：

`\\\\network\\folder`

如何将其作为逐字网址返回？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:30:31.097

如果您在调试模式下（例如在监视窗口中）看到这一点，没关系：“\\”在 C# 中用于表示“\”。同样，“\t”是制表符，“\n”是回车。

查看[整个单转义序列列表](http://www.jaggersoft.com/csharp_standard/9.4.4.4.htm)。

# linux - 由于软件包损坏，Debian 6.0.5 amd64 上的 Phusion Passenger Nginx 模块安装程序 v3.0.17 问题

> ID：12643845
> 
> 赞同：0
> 
> 时间：2012-09-28T16:26:42.147
> 
> 标签：linux, nginx, debian, passenger

我尝试了默认的Passenger Nginx安装步骤，但没有成功，我是linux和ruby on rails的新手，所以如果我做错了或有什么问题，请帮助我，据我所知，debian 6.0中的某些软件包已损坏.5 或乘客 nginx 模块。

我正在使用 REE

```
ruby 1.8.7 (2012-02-08 MBARI 8/0x6770 on patchlevel 358) [x86_64-linux], MBARI 0x6770, Ruby Enterprise Edition 2012.02 
```

来自[http://rubyenterpriseedition.googlecode.com/files/ruby-enterprise_1.8.7-2012.02_amd64_debian6.0.deb](http://rubyenterpriseedition.googlecode.com/files/ruby-enterprise_1.8.7-2012.02_amd64_debian6.0.deb)

**root@debian:~#passenger-install-nginx-module**

```
Welcome to the Phusion Passenger Nginx module installer, v3.0.17.

This installer will guide you through the entire installation process. It
shouldn't take more than 5 minutes in total.

Here's what you can expect from the installation process:

 1\. This installer will compile and install Nginx with Passenger support.
 2\. You'll learn how to configure Passenger in Nginx.
 3\. You'll learn how to deploy a Ruby on Rails application.

Don't worry if anything goes wrong. This installer will advise you on how to
solve any problems.

Press Enter to continue, or Ctrl-C to abort.

--------------------------------------------

Checking for required software...

 * GNU C++ compiler... found at /usr/bin/g++
 * The 'make' tool... found at /usr/bin/make
 * A download tool like 'wget' or 'curl'... found at /usr/bin/wget
 * Ruby development headers... found
 * OpenSSL support for Ruby... found
 * RubyGems... found
 * Rake... found at /usr/local/bin/rake
 * rack... found
 * Curl development headers with SSL support... not found
 * OpenSSL development headers... not found
 * Zlib development headers... found

Some required software is not installed.
But don't worry, this installer will tell you how to install them.

Press Enter to continue, or Ctrl-C to abort.

Installation instructions for required software

 * To install Curl development headers with SSL support:
   Please run apt-get install libcurl4-openssl-dev or libcurl4-gnutls-dev, whichever you prefer.

 * To install OpenSSL development headers:
   Please run apt-get install libssl-dev as root.

If the aforementioned instructions didn't solve your problem, then please take
a look at the Users Guide:

  /usr/local/lib/ruby/gems/1.8/gems/passenger-3.0.17/doc/Users guide Nginx.html 
```

**root@debian:~# apt-get install libcurl4-openssl-dev**

```
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 libcurl4-openssl-dev : Depends: libssl-dev but it is not going to be installed
                        Depends: libkrb5-dev but it is not going to be installed or
                                 hurd but it is not installable
E: Broken packages 
```

**root@debian:~# apt-get install libssl-dev**

```
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 libssl-dev : Depends: libssl0.9.8 (= 0.9.8o-4squeeze12) but 0.9.8o-4squeeze13 is to be installed
E: Broken packages 
```

**笔记：**

我尝试安装乘客安装步骤建议的所有可能的库（libcurl4-gnutls-dev、libkrb5-dev..），一切都说损坏的包。

**更新：**

我正在使用 REE

ruby 1.8.7（2012-02-08 MBARI 8/0x6770 补丁级别 358）[x86_64-linux]，MBARI 0x6770，Ruby 企业版 2012.02

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T01:43:09.550

我有同样的问题`libcurl4-openssl-dev`。试试`sudo apt-get install libcurl4-gnutls-dev`哪个应该工作得很好。

试一试，如果它不起作用，请告诉我，我将向您展示安装 libcurl4-openssl-dev 的解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:28:51.097

使用 Debian，您可以使用[Dotdeb 存储库](http://www.dotdeb.org/instructions/)并安装

```
nginx-passenger 
```

# algorithm - 从最优子结构到实际算法

> ID：12643846
> 
> 赞同：1
> 
> 时间：2012-09-28T16:26:41.697
> 
> 标签：algorithm, dynamic-programming

随着我对动态规划的理解，我发现在给定情况下开发最优子结构的概念越来越容易。例如，在找到乘以矩阵链的最佳顺序时，我知道（对不起，冗长；它帮助了我）计算 Ai * Ai+1 * ... * Aj 所需的最小乘法数可以找到通过找到 i 和 j 之间的拆分/括号放置点 k，它最小化 Ai*... *Ak 和 Ak+1* ...*Aj 所需的乘法之和，加上实际尺寸带来的成本。换句话说，M(i,j) = mink(M(i,k) + M(k+1,j) + di-1dkdj)。

同样，在找到字符串的最长回文子串时，最佳子结构是索引 i 和 j 之间的最大长度回文的长度 l[i,j] 并且输入数组是 2 + l[i+1, j -1]，当 i 和 j 处的元素相同并因此可以相加时，否则为 l[i+1, j], l[i, j-1] 的最大值（如果我混淆了任何内容，请纠正我...)

但是，在任何情况下，我如何将其转换为算法来找到理想序列的长度，例如上面的，甚至是它的内容？我是否基本上只是运行循环将所有内容制成表格，然后基本上“选择”表格中需要的内容？使用矩阵链，这似乎正是要做什么，但对于回文，我对如何构建循环有点困惑。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:51:41.427

> 我是否基本上只是运行循环将所有内容制成表格，然后基本上“选择”表格中需要的内容？

简而言之，是的。动态编程依赖于两件事：使原始问题更小（在您的问题中有很好的描述）和基本情况：那些（几乎总是很小）解决方案显而易见的情况，不再需要将问题划分为子问题。例如，在您的矩阵乘法示例中，一旦子问题减少到 2 个矩阵，您就不再有选择：您*必须*按原样将它们相乘。在您的回文示例中，我会选择长度为 1 的子串的基本情况，这显然是回文。

因此，一旦您创建了记忆数组/矩阵等，您通常所做的就是在该数组中设置基本情况值，然后让算法运行。结束条件通常是当您到达数组中的正确点时，或者当没有什么可以计算时（此时您从数组/矩阵等中“选择”您需要的内容）

我希望这足够具体以至于有用。

# eclipse - 'org.eclipse.platform.feature.group [3.4.0,4.0.0)' 找不到

> ID：12643852
> 
> 赞同：3
> 
> 时间：2012-09-28T16:26:56.760
> 
> 标签：eclipse, plugins

我正在尝试安装一个我之前安装过几次的内部插件，但这次我收到了这些错误：

这是否意味着它与我正在使用的新 EClipse Juno 不兼容？

```
Cannot complete the install because one or more required items could not be found.
  Software being installed: Maven 2 Tools 2.0.1 (com.Company.engineering.maven.feature.feature.group 2.0.1)

  Missing requirement: Maven 2 Tools 2.0.1 (com.Company.engineering.maven.feature.feature.group 2.0.1) requires 'org.eclipse.platform.feature.group [3.4.0,4.0.0)' but it could not be found 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T18:57:47.563

您的内部插件与基于 Eclipse 4.2 构建的默认 Eclipse Juno 发行版不兼容。您可以在您的插件中看到：(com.Company.engineering.maven.feature.feature.group) 从 [3.4.0, 4.0.0) 开始依赖于 Eclipse 平台。这意味着您的插件将适用于 Eclipse 3.4 到（但不包括）4.0.0。

您在这里有两个选择：

1.  更新你的插件。Eclipse 3.x 和 4.x 之间有一个兼容层，因此您可能只需要更新依赖项中的版本范围。这假设您有权访问 com.Company.engineering.maven.feature.feature.group。

2.  使用 Eclipse 3.8 作为基础。你可以从[http://download.eclipse.org/eclipse/downloads/eclipse3x.html](http://download.eclipse.org/eclipse/downloads/eclipse3x.html)得到这个。但是，这将是基于 3.x 的最后一个 Eclipse 版本，因此您应该考虑尽快更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:52:04.533

Eclipse Juno 是 Eclipse 4.2，因此与您的插件不兼容。[您可以从此页面](http://download.eclipse.org/eclipse/downloads/eclipse3x.html)尝试 Eclipse 3.8.1 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-06T03:36:23.927

我的 Eclipse 是 4.2.2，当我使用链接“ [http://download.eclipse.org/eclipse/updates/4.2](http://download.eclipse.org/eclipse/updates/4.2) ”更新 Eclipse 时，错误消失了。

# ios - 来自 MapView Annotation-iOS 的缩略图

> ID：12643857
> 
> 赞同：0
> 
> 时间：2012-09-28T16:27:10.490
> 
> 标签：ios, uiview, annotations, mkmapview

您如何从 mapView 获取缩略图，如下图红色矩形框所示。![在此处输入图像描述](../Images/324d6e00d596bd65c1742acfa9c53c8b.png)

```
UIView *thumbnailContainer=[[UIView alloc]initWithFrame:CGRectMake(10,10,64,64)];
    thumbnailContainer.clipsToBounds=YES;
    thumbnailContainer.layer.borderColor=[UIColor colorWithWhite:0 alpha:0.5].CGColor;
    thumbnailContainer.layer.cornerRadius=3;
    thumbnailContainer.layer.borderWidth=1;

    Annotation *annotation1=[[Annotation alloc]init];
    annotation1.coordinate = CLLocationCoordinate2DMake(29.7189214,-95.33916);
    annotation1.title = @"University of Houston";
    annotation1.subtitle = @"4800 Calhoun Rd,Houston";
    MKMapView *mapView2=[[MKMapView alloc]initWithFrame:CGRectMake(0, 0, 150, 150)];
    mapView2.userInteractionEnabled=NO;
    mapView2.centerCoordinate=[annotation1 coordinate];
    [mapView2 addAnnotation:annotation1];
    //annPoint=[self.mapView convertCoordinate:annotation1.coordinate toPointToView:self.mapView];

    MKCoordinateRegion region=MKCoordinateRegionMakeWithDistance(mapView2.centerCoordinate, 150, 150);
    mapView2.region=region;
    mapView2.transform=CGAffineTransformMakeScale(0.75, 0.75);
    mapView2.layer.position=CGPointMake(thumbnailContainer.bounds.size.width/2,thumbnailContainer.bounds.size.height/2+10);
    [thumbnailContainer addSubview:mapView2]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:10:23.933

很可能它是地图的截图，因为 iOS 中的任何实时地图都在底角包含 Google 地图徽标（

为此，您需要在地图中计算出图钉所在的矩形，然后使用 UIGraphicsContent() 等函数对视图进行截图。然后，您可以将该图像放入 UIImageView 中，以便用户显示它。

```
UIGraphicsBeginImageContext(mapRect);    
[self.view.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

或者，您可以使用 Google Maps Static API，它允许您使用指定的纬度和经度值接收特定位置的地图图片。

[https://developers.google.com/maps/documentation/staticmaps/](https://developers.google.com/maps/documentation/staticmaps/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T17:16:09.383

使用按比例缩小的地图视图怎么样？我认为从地图视图的渲染层创建缩略图不是一个好的解决方案，因为它需要首先以所需的缩放加载地图，然后，为什么不直接显示此地图而不是制作一个图像出来吗？:D 这是我会使用的代码。

```
 Annotation *yourAnnotation = [[Annotation alloc] init];

UIView *thumbnailContainer = [[UIView alloc] initWithFrame:CGRectMake(10, 10, 64, 64)];
thumbnailContainer.clipsToBounds = YES;
thumbnailContainer.layer.borderColor = [UIColor colorWithWhite:0 alpha:0.5].CGColor;
thumbnailContainer.layer.cornerRadius = 3;
thumbnailContainer.layer.borderWidth = 1;

MKMapView *thumbnailMap = [[MKMapView alloc] initWithFrame:CGRectMake(0, 0, 150, 150)];
thumbnailMap.userInteractionEnabled = NO;
thumbnailMap.centerCoordinate = [yourAnnotation coordinate];
[thumbnailMap addAnnotation:yourAnnotation];

MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(thumbnailMap.centerCoordinate, 150, 150);
thumbnailMap.region = region;
thumbnailMap.transform = CGAffineTransformMakeScale(0.75, 0.75);
//we add 10 pixels on the y coordinate, to center the pin in the view. Moreover it will hide the "legal" label of the map view.
thumbnailMap.layer.position = CGPointMake(thumbnailContainer.bounds.size.width / 2, thumbnailContainer.bounds.size.height / 2 + 10);
[thumbnailContainer addSubview:thumbnailMap]; 
```

它看起来像这样：![在此处输入图像描述](../Images/79c0e5f3f888f5bc9a215371223a3227.png)

# javascript - 确定单击了哪个复选框

> ID：12643858
> 
> 赞同：-1
> 
> 时间：2012-09-28T16:27:11.573
> 
> 标签：javascript, jquery

我的页面上有一组复选框。其中之一的代码：

```
<div>
            <label for="ViewAsWebpage">
                {{#if this.ViewAsWebpage}}
                    <input type="hidden" id="ViewAsWebpage" name="ViewAsWebpage" value="true"/> 
                    <input type="checkbox" class="enable-checkbox" checked /> 
                {{else}}
                    <input type="hidden" id="ViewAsWebpage" name="ViewAsWebpage" value="false"/> 
                    <input type="checkbox" class="enable-checkbox" /> 
                {{/if}}
                <span>View as Webpage</span>
            </label>
        </div> 
```

我正在尝试根据用户点击将值设置为真/假，然后希望在提交表单时发布该值，如下所示：

```
$('input.enable-checkbox').click(function (e) {

                    if ($('input.enable-checkbox').parent().attr("for") == "ViewAsWebpage") {
                        var checked = $('#ViewAsWebpage').is(":checked");
                        $('#ViewAsWebpage').attr("value", checked);

                    } 
```

是否有更好的方法通过识别页面上单击的复选框（有多个）将复选框值设置为 True/False？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:45:40.847

尝试这个

```
$('input.enable-checkbox').on('click', function (e) {
    $(this).closest('label').val(this.checked);   
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:36:45.093

首先，您应该为您的复选框本身提供 ID。然后：

```
$("#idCheckbox1").change(function(){
   if($("#idCheckbox1").attr('checked')){
       $("#ViewAsWebPage").val("true")
   }
}

$("#idCheckbox2").change(function(){
   if($("#idCheckbox2").attr('checked')){
       $("#ViewAsWebPage").val("false")
   }
} 
```

# javascript - 创建 HTML 代码生成器的问题 - 纯文本和预览模式

> ID：12643860
> 
> 赞同：1
> 
> 时间：2012-09-28T16:27:19.127
> 
> 标签：javascript, html, innerhtml

我有一个表单，用户（我公司的一名员工）可以输入一个 URL 和该 URL 的标题以获取生成的 HTML 代码。我知道每个用户都会使用 Internet Explorer 8，所以我不需要担心跨浏览器的兼容性。**我的问题是我似乎无法为代码构建“预览”区域，以便用户在使用代码之前可以看到最终结果。**

```
Enter URL:</td><td><input size="26" type='text' id='userInput' />
Title: <input size="31" type='text' id='urlname' /> 
```

当他们单击提交按钮时，将调用 GetURL() 函数。输入存储在以下变量中：

```
var userInputURL = '&lt;a href&#61;"'+document.getElementById('userInput').value+'"&gt;'+urlName+'&lt;&#47;a&gt;'; 
```

然后将该变量放置在同一页面上使用 innerHTML 的文本区域中，以便用户可以复制/粘贴代码以在需要的任何地方使用。我还希望它作为真正的 HTML 显示在另一个区域中。我希望页面将 URL 转换为超链接，这样他们就可以在使用它之前看到最终结果的样子。

```
document.getElementById('results').innerHTML = userInputURL;
document.getElementById('codepreview').innerHTML = userInputURL; 
```

我不得不使用 ASCII 代码来解决 Internet Explorer 8（用户将使用的唯一浏览器）中的运行时错误。我认为这是搞乱我的代码预览部分的原因。如果我不使用 ASCII 字符，那么当用户点击提交按钮时除了 Javascript 错误之外什么都不会发生。

**有人可以帮我建立一个预览部分吗？**

在此先感谢您的帮助。

# facebook - 使用 facebook oAuth 权限在 wordpress 支持的网站上自动注册用户

> ID：12643861
> 
> 赞同：1
> 
> 时间：2012-09-28T16:27:22.690
> 
> 标签：facebook, wordpress, oauth

我可能在这里完全找错了树，但我似乎找不到任何对我有帮助的东西。

这是交易，我创建了一个 wordpress 网站，该网站设置为分类广告“免费广告”网站。我不打算将其用作网站，仅用作 facebook 中的应用程序。

我已经在 FB 上设置了我的应用程序，查看了各种不同类型的 wordpress 插件等，但找不到我要找的东西。

当用户在 facebook 上添加我的应用程序时，他们会在接受此权限时显示权限对话框“允许此应用程序等等等等”，然后他们会在 iFrame 中看到 teh wordpress 站点，但是我必须运行另一个插件才能启用 facebook 注册/登录。这当然会引发另一个授权对话。

有没有办法只使用初始权限对话框将凭据传递到我的 Wordpress 网站，以便它自动创建一个注册，使用户能够直接进入并使用该应用程序？

抱歉，如果我的技术还不够好，而且，如果有人知道这件事就像他们的手背一样，我有兴趣付钱请人做这件事吗？

谢谢布拉德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:36:23.103

如果您希望绕过 Facebook 的 oAuth 权限，您将无法做到。如果您正在寻找有关如何为您的网站创建 Facebook 登录的某种教程，那么我建议您阅读[Facebook 开发人员网站上的以下文章](https://developers.facebook.com/docs/guides/web/#login)。

如果你不想弄乱这样的代码，那么你总是可以实现 Facebook 自己制作的社交插件。他们有一个[登录](https://developers.facebook.com/docs/reference/plugins/login/)和一个[注册](https://developers.facebook.com/docs/plugins/registration/)插件，它允许您将这些功能添加到您的网站，这比通过上一篇文章编码要容易得多。我的经验是，Facebook API 的官方文档是您最好的资源，而且没有比仅仅阅读文档更好的教程。如果您是后端编程的新手（完全是一个幼稚的假设），那么我强烈建议您阅读文档，否则将很难实现我认为您正在尝试做的事情。

# azure - Azure 服务总线 - SuscriptionClient.BeginAcceptMessageSession() 和 TimeoutException

> ID：12643864
> 
> 赞同：1
> 
> 时间：2012-09-28T16:27:28.320
> 
> 标签：azure, servicebus, azureservicebus

该文档使人们相信，如果超过参数中指定的时间量，`BeginAcceptMessageSession()`将会抛出一个。这似乎并不总是发生。`TimeoutException``serverWaitTime`

那么，如果主题中没有消息，这个东西的行为是否不应该交回 a `MessageSession`（即它等待一段时间，并且在找不到任何消息时，它会抛出`TimeoutException`）？或者，更确切地说，它是否仅在它无法在时间范围内回复时才超时，而不管是否有消息？

我正在对一个空主题和一个空订阅进行非常简单的测试。使用 5 秒超时值，有时它会抛出`TimeoutException`，有时它不会。

是什么赋予了？为什么这件事不一致？何时会或不会抛出 TimeoutException 的规则是什么？我可以`MessageSession`收回空订阅吗？

这些文档非常稀疏。

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T13:36:53.400

是的，无文档是相当令人印象深刻的好吧。

你在你得到它`Close()`的`MessageSession`情况下得到它吗？

请记住，返回的对象代表一个令牌，它授予您从主题中出列的专有权利，直到您返回它或其他人“赢得”它。

# c# - 在 Oracle 中生成 .Net 报价

> ID：12643866
> 
> 赞同：1
> 
> 时间：2012-09-28T16:27:30.967
> 
> 标签：c#, .net, oracle, plsql

有谁知道如何在 PL/SQL 存储过程中生成 .Net DateTime.Ticks，而 Oracle 数据库中没有 .Net 程序集？

我在 .Net 中有一项服务，将 DateTime.Ticks 值存储在 [Oracle 数据库] 列中。现在我必须创建一个存储过程来创建类似的信息，但我必须匹配该特定列中的 .Net 刻度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:45:26.480

使用 Oracle 函数计算从纪元（0001 年 1 月 1 日午夜 12:00:00）开始的秒数，忽略闰秒，乘以 10e6（一千万）得到滴答声。

.NET 时间刻度的定义可在[此处](http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx)找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-03T15:21:29.210

我想出了整个算法并构建了一个函数。它就像一个魅力......

它是这样的：

```
CREATE OR REPLACE FUNCTION GLOBAL.Get_DotNet_Ticks
(
       inTimestamp IN TIMESTAMP
) RETURN NUMBER AS
-- **********************************************************************************
-- File name:         Get_DotNet_Ticks
-- Original Author:   Roberto Lopes
-- Creation Date:     October 2012
-- Description:       Returns the number of ticks for the provided timestamp, based
--                    on the Microsoft .Net algorithm
-- **********************************************************************************
BeginDate TIMESTAMP := TO_TIMESTAMP('0001-01-03', 'YYYY-MM-DD'); --.Net Ticks are counted starting from this date
BEGIN
    RETURN (EXTRACT(DAY FROM(inTimestamp - BeginDate)) * 86400000 + (TO_NUMBER(TO_CHAR(inTimestamp, 'SSSSSFF3'))))*10000;
END Get_DotNet_Ticks; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T17:42:57.567

我不熟悉 Oracle PL/SQL，但以下`DateToTicks()`C# 函数（直接取自 Mono 的开源 DateTime 实现）揭示了在给定 DateTime 值的各个组件的情况下如何计算刻度的详细信息。也许它有帮助。

祝你好运！

```
 public const long TicksPerDay = 864000000000L;
      private static readonly int[] daysmonth = { 0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
      private static readonly int[] daysmonthleap = { 0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };

      private static int AbsoluteDays(int year, int month, int day) {
         int[] days;
         int temp = 0, m = 1;

         days = (IsLeapYear(year) ? daysmonthleap : daysmonth);

         while( m < month )
            temp += days[m++];
         return ((day - 1) + temp + (365 * (year - 1)) + ((year - 1) / 4) - ((year - 1) / 100) + ((year - 1) / 400));
      }

      public static bool IsLeapYear(int year) {
         if( year < 1 || year > 9999 )
            throw new ArgumentOutOfRangeException();
         return ((year % 4 == 0 && year % 100 != 0) || year % 400 == 0);
      }

      internal static bool CalculateTicks(int days, int hours, int minutes, int seconds, int milliseconds, out long result) {
         // there's no overflow checks for hours, minutes, ...
         // so big hours/minutes values can overflow at some point and change expected values
         int hrssec = (hours * 3600); // break point at (Int32.MaxValue - 596523)
         int minsec = (minutes * 60);
         long t = ((long)(hrssec + minsec + seconds) * 1000L + (long)milliseconds);
         t *= 10000;

         result = 0;

         bool overflow = false;
         // days is problematic because it can overflow but that overflow can be 
         // "legal" (i.e. temporary) (e.g. if other parameters are negative) or 
         // illegal (e.g. sign change).
         if( days > 0 ) {
            long td = TicksPerDay * days;
            if( t < 0 ) {
               long ticks = t;
               t += td;
               // positive days -> total ticks should be lower
               overflow = (ticks > t);
            } else {
               t += td;
               // positive + positive != negative result
               overflow = (t < 0);
            }
         } else if( days < 0 ) {
            long td = TicksPerDay * days;
            if( t <= 0 ) {
               t += td;
               // negative + negative != positive result
               overflow = (t > 0);
            } else {
               long ticks = t;
               t += td;
               // negative days -> total ticks should be lower
               overflow = (t > ticks);
            }
         }

         if( overflow ) {
            return false;
         }

         result = t;
         return true;
      }

      public static bool  DateToTicks (int year, int month, int day, int hour, int minute, int second, int millisecond, out long result) {
         return CalculateTicks(AbsoluteDays(year, month, day), hour, minute, second, millisecond, out result);
      } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:35:13.240

[Ticks 属性](http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx)是 a ，`long`因此您需要使用合适的 Oracle 类型：' [Number](http://docs.oracle.com/cd/B28359_01/server.111/b28318/datatype.htm#autoId14) '

# java - GUI ImageIcon 扑克牌

> ID：12643869
> 
> 赞同：1
> 
> 时间：2012-09-28T16:27:41.830
> 
> 标签：java, swing, user-interface

所以我有一个我正在研究的程序，它在框架中显示 3 张带有标签的随机卡片。到目前为止，我已经将一副纸牌分配给 ImageIcons 数组，然后将它们洗牌。我的问题是，我现在如何将它们分配给 JLabels。请原谅我这个愚蠢的问题，因为我知道这很简单，但我对使用 GUI 很陌生，这让我害怕哈哈

到目前为止，这是我的代码：

```
package assignment2;
import javax.swing.*;

import java.awt.*;
public class Assignment2 extends JFrame{
    public Assignment2(){

        setLayout(new GridLayout(3,1,5,5));
        add(new JLabel()); ///display one random card
        add(new JLabel()); ////display another random card
        add(new JLabel()); ////display another random card
    }
    public static void main(String[] args) {

        Assignment2 frame = new Assignment2();
        frame.setTitle("MAIN TO THE FRAME");
        frame.setSize(600,300);
        frame.setResizable(true);
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        final int FINAL_CARDS_NUMBER = 54;

        ImageIcon deckOfCards [] = new ImageIcon [FINAL_CARDS_NUMBER];

        for(int i = 0; i <FINAL_CARDS_NUMBER; i++){
            deckOfCards[i] = new ImageIcon("C:/card/" + (i + 1) + ".png");
        }

        for (int i = 0; i < FINAL_CARDS_NUMBER; i++) {
            int r = i + (int) (Math.random() * (FINAL_CARDS_NUMBER-i));
            ImageIcon t = deckOfCards[r];
            deckOfCards[r] = deckOfCards[i];
            deckOfCards[i] = t;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T16:31:29.427

First, remove the 3 lines where you add the labels:

```
add(new JLabel()); 
```

Then, in the place where you are getting the `ImageIcon`, do this:

```
ImageIcon t = deckOfCards[r];
JLabel label = new JLabel(t);
add(label); 
```

However, I suggest you don't set the layout and add components directly to your `JFrame`. You would better create a new `JPanel` and add that to the content pane of your `JFrame`:

```
JPanel panel = new JPanel();
panel.setLayout(new GridLayout(3, 1, 5, 5));
getContentPane().add(panel); 
```

Then, when you add the labels, add them to the panel.

```
panel.add(new JLabel(t)); 
```

Now that you updated the question, I am updating the answer below. First, declare 3 `JLabel`, instantiate them and add them to the panel as explained above.

```
JLabel card1 = new JLabel();
JLabel card2 = new JLabel();
JLabel card3 = new JLabel(); 
```

Then, after you read the `ImageIcon` for each, you can set the `JLabel` image this way:

```
card1.setIcon(t); 
```

# yii - Yii 验证规则不起作用

> ID：12643871
> 
> 赞同：0
> 
> 时间：2012-09-28T16:27:43.530
> 
> 标签：yii, php

我在我的数据库中创建了一个没有表的文件上传验证规则，所以我所做的只是使用 CFormModel 对其进行了扩展。

这是我的代码：

**控制器**

```
public function actionMaterials($pid)
{
    $projectMaterialFile = new ProjectMaterialFile;
    $this->render('project_materials',array(
        'projectMaterialFile'=>$projectMaterialFile,
    ));
} 
```

**查看（项目材料）**

```
<div id="exportMaterialContent">
    <h4 style="text-align:left;">Export Material Document</h4>
    <?php echo CHtml::form($this->createUrl("project/export"),'post',array('enctype'=>'multipart/form-data')); ?>
    <?php echo CHtml::activeHiddenField( $projectMaterialFile,'idProject',array('value'=>$projectModel->idProject) ); ?>
    <?php echo CHtml::activeFileField($projectMaterialFile, 'document'); ?>
    <?php echo CHtml::submitButton("Export"); ?>
    <?php echo CHtml::endForm(); ?>
</div> 
```

**控制器 - 导出（视图中的表单提交后）**

```
public function actionExport()
{
    $model = new ProjectMaterialFile;
    $model->attributes = $_POST['ProjectMaterialFile'];
    if( $model->validate() ) {
        $model->document = CUploadedFile::getInstance($model,'document');
        $model->document->saveAs(Yii::getPathOfAlias('webroot')."/material_document/".$model->document->name);
        echo "correct";
    } else {
        echo "Invalid!";
    }
} 
```

**模型**

```
class ProjectMaterialFile extends CFormModel
{
    public $document;
    public $idProject;

    public function rules()
    {
        return array(
            array('document','file','types'=>'csv'),
            array('document', 'required'),
        );
    }

    public function attributeLabels()
    {
        return array(
            'document' => 'Project Material Document',
            'idProject' => 'Project ID',
        );
    }
} 
```

所以我在这里所做的是它总是运行到我控制器的 else`actionExport()` 即使我尝试`echo $model->validate();`，它也不会打印任何东西，这就是它总是转到 else 语句的原因。

您的帮助将不胜感激，当然，奖励！

谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:43:11.727

尝试更改模型中的验证规则，如下所示

```
public function rules()
{
   return array(
      array('document','file','types'=>'csv'),
      array('document', 'required'),
      array('document', 'length', 'max'=>200),
      array('idProject', 'length', 'max'=>200),
      array('document, idProject', 'safe'),
      );
} 
```

现在改变你的控制器部分如下

```
$model = new ProjectMaterialFile;
$model->attributes = $_POST['ProjectMaterialFile'];
$model->document = CUploadedFile::getInstance($model,'document');

if( $model->validate() )
{
   $model->document->saveAs(Yii::getPathOfAlias('webroot')
                ."/material_document/".$model->document->name);
    echo "Correct";
}
else
{
    echo "Invalid!";
} 
```

示例链接：[http ://www.yiiframework.com/wiki/2/how-to-upload-a-file-using-a-model/](http://www.yiiframework.com/wiki/2/how-to-upload-a-file-using-a-model/)

# flash - Google TV 支持 Flash 访问

> ID：12643875
> 
> 赞同：0
> 
> 时间：2012-09-28T16:27:58.110
> 
> 标签：flash, google-tv

我目前正在测试一些 Google TV 设备（Sony NSZ-GT1 和 NSZ-GS7）。

我想澄清一下这些设备上随 Google Chrome 提供的 Flash 插件是否支持 Flash Access。

根据[Flash Access 常见问题解答](http://www.adobe.com/products/adobe-access/faq.html)，“Adobe Access 将与 Adob​​e Flash Player 10.1 或更高版本一起使用”。鉴于这些设备中包含的 Flash 版本是 10.1/10.2 混合版本，我希望 Flash Access 能够正常工作。

但是，我进行了各种测试，但无法使其正常工作。

对于第一个测试，我使用了 Flash Access 测试站点，特别是[http://drmtest2.adobe.com/AccessPlayer/player.swf](http://drmtest2.adobe.com/AccessPlayer/player.swf)（不幸的是，player.html 没有加载 Flash 应用程序）

对于这两种设备，我得到了相同的结果 - 当按下 SVP 中的播放图标时，“流状态”报告“正在播放”，“DRM 保护”报告“否”。视频没有播放。

此外，对于这两种设备，当在 TVP 中按下“加载 DRM 元数据”时，我收到了“错误 #1009”。

SVP 报告 NSZ-GT1 的 Flash 版本为 10.2.164.128，NSZ-GS7 的 Flash 版本为 10.2.164.113。

对于第二个测试，我使用了本地构建和本地托管的 OSMF 示例播放器，版本 1.5，配置了来自 Flash Access 测试站点的示例视频。

作为参考，我首先尝试了桌面 PC 浏览器 flash 插件，在这种情况下，我看到了输入用户名和密码的提示；输入这些后，视频播放成功。

但是，当我在两台设备上的 Chrome 浏览器中尝试此操作时，尽管加载了 OSMF 播放器，但我从未收到输入用户名和密码的提示。

由于 Google TV 没有调试 Flash 播放器，因此我无法使用该设备进行进一步调查。

任何有关 Google TV 上 Flash Access 支持的说明或见解都将不胜感激。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T20:42:02.863

当 Google TV 很早之前刚推出时，Adobe 制作了一份关于 Google TV 上 Flash 优化的文档：

[http://www.adobe.com/devnet/devices/articles/video_content_tv.html](http://www.adobe.com/devnet/devices/articles/video_content_tv.html)

他们将 Flash Access 列为众多 DRM 解决方案之一，因此它在 Google TV 上 Flash 10.1 或 10.2 的路线图上。

不幸的是，Adobe 对 Google TV 等 Android 平台的支持并不理想，而且 Flash Access 从未实现过。开发人员可以更好地在 Google TV 上寻找其他（例如 Android）DRM 解决方案。

# c++ - 使用 scipy.weave.inline 将大整数从 Python 传递到 C/C++

> ID：12643877
> 
> 赞同：0
> 
> 时间：2012-09-28T16:27:59.810
> 
> 标签：c++, python, c, scipy, largenumber

我发现我用 python 编写的一部分代码可以在 C 中更快地完成。我使用 scipy.weave.inline 来做到这一点。seek_pos 是我需要传递到我的 C 代码中的整数之一，它（有时）大于 32 位长度可以表示的整数。我可以计算 seek_pos 并获得正确的值（可能是 23 亿），但是当用它做其他事情时，例如将它用作 fseek 或 fseeko64 中的偏移量，它会表现得好像它是 -19 亿（或任何值你' d 从绕过正长整数的范围并绕到负长整数的范围内）。

我的解决方法是在 python y=seek_pos/N，x=seek_pos%N 中分解大整数，传入这些较小的数字并在 C 中重建较大的数字，seek_pos_off = Y*N+X。我是 Weave 和 C/C++ 的新手。我的代码现在可以工作，但我认为这是一种非常荒谬的到达方式。也许我可以为 weave.inline 指定一个预制或自定义类型转换器，但是如何我不清楚这样做。

如果有人可以提出更好的方法，我将不胜感激，但如果没有，我还是想发布这个，以便处理相同问题的人至少可以在搜索时找到我的工作。

这是我的代码的相关部分

```
vtrace = numpy.zeros(len_trace, dtype='short')
c_code = '''
using namespace std;
const char * cc_fpath = filepath.c_str();
FILE * infile;
infile = fopen(cc_fpath, "r");
long seek_pos_off;
long long_multiplier;
long_multiplier = seek_pos_multiplier;
long long_adder;
long_adder = seek_pos_adder;
seek_pos_off = long_multiplier * 2000000000 + long_adder;
fseek(infile, seek_pos_off, SEEK_SET);
for (int n=0; n<len_trace; n++) {
    fread(vtrace+n, data_bytes_per_channel, 1, infile);
    fseek(infile, skip_bytes, SEEK_CUR);
}
fclose(infile);

return_val = 0;
'''
filepath = str(filepath)
seek_pos = int(data_start_pos_in_bytes + start_byte)
seek_pos_multiplier = seek_pos/2000000000
seek_pos_adder = seek_pos%2000000000
weave.inline(c_code, ['vtrace', 'filepath', 'seek_pos_multiplier', 
        'seek_pos_adder', 'len_trace', 'data_bytes_per_channel', 
        'skip_bytes'], headers=['<typeinfo>']) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T17:10:30.377

你有没有尝试过

```
seek_pos = long(data_start_pos_in_bytes + start_byte) 
```

代替

```
seek_pos = int(data_start_pos_in_bytes + start_byte) 
```

可能就是这样。

# c++ - 使用 boost::filesystem::path 获取绝对路径

> ID：12643880
> 
> 赞同：32
> 
> 时间：2012-09-28T16:28:14.397
> 
> 标签：c++, boost, path, filesystems

我当前的工作目录位于`/home/myuser/program`，我创建了一个`boost::filesystem::path`指向它的对象。我附加`/../somedir`了它，所以它变成了`/home/myuser/program/../somedir`. 但我需要得到它解析的绝对路径，即`/home/myuser/somedir`.

我已经尝试了很长时间，但在[他们的参考](http://www.boost.org/doc/libs/1_51_0/libs/filesystem/doc/reference.html)中我没有找到任何方法来做到这一点。有一个名为 的方法`make_absolute`，它似乎应该做我期望的事情，但我必须给它一个“根”路径参数。应该是哪个？我真的需要这样做才能获得真正的绝对路径吗？还有其他方法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-28T16:49:28.850

你说你想要一个绝对路径，但你的例子表明你已经有了一个绝对路径。删除`..`路径组件的过程称为*规范化*。为此，您应该调用[`canonical`](http://www.boost.org/doc/libs/1_51_0/libs/filesystem/doc/reference.html#canonical). 它恰好也执行 的任务`absolute`，所以你不需要先调用`absolute`or `make_absolute`。该`make_absolute`函数需要一个基本路径；`current_path()`如果你没有更好的，你可以通过它。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-12-15T13:54:41.580

更新，因为这似乎仍然是谷歌关于绝对路径的热门话题：

**从 Boost 1.57 开始，一些先前建议的功能已被删除。**

对我有用的解决方案是

```
boost::filesystem::path canonicalPath = boost::filesystem::canonical(previousPath, relativeTo); 
```

（使用在 boost/filesystem/operations.hpp 中定义的独立方法[canonical() ，通过 boost/filesystem.hpp 自动包含）](http://www.boost.org/doc/libs/1_57_0/libs/filesystem/doc/reference.html#canonical)

重要提示：在不存在的路径上调用规范（例如，您要创建文件）将引发异常。在这种情况下，您的下一个最佳选择可能是 boost::filesystem::absolute()。它也适用于不存在的路径，但不会消除路径中间的点（如在 a/b/c/../../d.txt 中）。注意：确保 relativeTo 引用一个目录，在引用文件的路径上调用 parent_path()（例如，打开的文件包含相对于自身的目录或文件路径）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:32:06.903

The [documentation shows](http://www.boost.org/doc/libs/1_51_0/libs/filesystem/doc/reference.html#absolute) that the `make_absolute` has an *optional* second parameter that defaults to your current path:

`path absolute(const path& p, const path& base=current_path());`

Try it without the second parameter and see if it returns the results you're looking for.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T16:32:24.777

> I have to give it a “root” path argument.

[Check the docs:](http://www.boost.org/doc/libs/1_51_0/libs/filesystem/doc/reference.html#absolute) you don't *have* to give it anything; it has a default second parameter. Namely, the current directory.

Relative paths are relative to some directory. Thus, when making a path absolute, you need to know what it should be absolute *relative to*. That's the "root path": the directory it is relative to.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-15T08:26:45.877

```
// input: d:\\tmp\\\\a/../VsDebugConsole.png
// output: d:\\tmp\\VsDebugConsole.png
static std::wstring fix_path(std::wstring path)
{
    //boost::replace_all(path, L"\\\\", L"\\");
    //boost::replace_all(path, L"//", L"/");
    boost::filesystem::path bpath(path);
    bpath = boost::filesystem::system_complete(bpath);

    return bpath.wstring();
} 
```

# asp.net-mvc - 订阅标签页中的“喜欢”按钮

> ID：12643881
> 
> 赞同：0
> 
> 时间：2012-09-28T16:28:23.877
> 
> 标签：asp.net-mvc, facebook, facebook-like

如何订阅在 facebook 标签页中按下 Like 按钮的事件（我猜是这样完成的）？...也许使用 Facebook javascript SDK？

对于开发，我使用 ASP.NET MVC 3，它会干扰 Facebook javascript SDK 的任何内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T17:56:57.563

事实证明，我不需要订阅这个特定事件：每次喜欢或不喜欢标签页时都会重新加载它。因此，可以使用 Facebook 的 C# SDK 来检索有关喜欢状态的信息。

# sql - SQL 连接两个表

> ID：12643888
> 
> 赞同：0
> 
> 时间：2012-09-28T16:29:04.637
> 
> 标签：sql, sql-server, join, left-join

现在我有一张表，可能有也可能没有特定日期的数据。但是，我想返回一个数据集，其中为其他列填充了所有日期和空白数据。我想出了另一个表，其中存储了“所有日期”，而一个视图可以帮助我完成此任务。如果有更好的方法请告诉我。

**表格1**

```
UserId    Date       Value1
1         9/2/2012   10
2         9/15/2012  5
1         9/17/2012  12
1         9/23/2012  4
2         9/25/2012  7 
```

**AllDates**（记录未来 10 年的每个日期）

```
Date
1/1/2012
1/2/2012
1/3/2012
...
...
...
12/31/2020 
```

我想加入这两个表以返回 9 月份的这个数据集，其中 UserId = 1：

```
UserId    Date       Value1
1         9/1/2012   NULL
1         9/2/2012   10
1         9/3/2012   NULL
...
...
...
1         9/16/2012   NULL
1         9/17/2012   12
1         9/18/2012   NULL
...
...
...
1         9/23/2012  4
...
...
...
1         9/29/2012  NULL
1         9/30/2012  NULL 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:31:03.430

```
select a.Date, t.Value1
from AllDates a
left outer join table1 t on a.Date = t.Date and t.UserID = 1
where year(a.Date) = 2012 and month(a.Date) = 9    
order by a.Date 
```

# function - 接口声明

> ID：12643892
> 
> 赞同：0
> 
> 时间：2012-09-28T16:29:25.857
> 
> 标签：function, dll, interface

我有一个带有 GetImage 函数的 DLL (ImageHelp)。我想在不同的类中使用这个函数，所以我定义了一个接口 IImages。可以访问 DLL 的接口中的函数被声明为 Image GetImage()；在我尝试过的课程中：

```
Image image = IImages.GetImage(); 
```

或者

```
Image image = _imagehelp.GetImage(); 
```

在这两种情况下，我都会遇到错误。`classxyz does not implement GetImage.`

任何建议将被认真考虑。

多哥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:37:27.530

您使用 GetImage 的类需要继承 IImages（例如 classxyz 需要继承 IImages）。

# ios - 将 GDAL/OGR 合并到 iOS 项目中 - 快速指南

> ID：12643898
> 
> 赞同：11
> 
> 时间：2012-09-28T16:29:45.360
> 
> 标签：ios, gdal, ogr

这就是问题所在： [GDAL](http://www.gdal.org)是一个出色的开源库，旨在管理复杂的 GIS 数据，包括栅格和矢量。它为[Mac OS](http://www.kyngchaos.com/software/frameworks)（由 William Kyngesburye 提供）和其他平台完全编译，但不适用于 iOS。

浏览网络，您可以找到关于创建 iOS 库主题的点点滴滴（相对较旧的）信息，从3 年前编写的来自[pseudogreen的著名脚本开始。](http://pseudogreen.org/blog/build_autoconfed_libs_for_iphone.html)还有一些关于堆栈溢出的点点滴滴，例如[iPhone 上的 GDAL / OGR，](https://stackoverflow.com/questions/5507688/gdal-ogr-on-the-iphone)它们提供了额外的信息。

本文旨在涵盖我采取的所有步骤，这些步骤使我使用 iOS6 和 XCode 4.5.5 在一个简单的 iOS 应用程序中实现了 GDAL/OGR 的全功能集成

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-28T16:29:45.360

# 笔记

此响应是前段时间编写的，并且更适用于 Xcode 6 及更高版本。请[检查此链接](http://www.hurtsdevelopment.com/blog/uncategorized/gdal-on-ios-it-works/)以获取有关此问题的最新答案。

# 介绍

将 GDAL 整合到您的 iOS 应用程序中需要 5 个步骤：

1.  从 GDAL 网站下载 GDAL 源代码
2.  运行下面给出的配置/构建/安装脚本
3.  将生成的静态库与包含文件一起添加到您的 iOS 项目中
4.  与您的 iOS 项目中的其他库链接
5.  开始编码... GDAL 和 OGR 教程是很好的起点

# 下载GDAL

GDAL 是一个 C++ 开源库，可以从[www.gdal.org 网站](http://www.gdal.org)下载。在撰写本文时，最新版本是 1.9.0。如果可能，您应该下载最新的稳定版本。

# 运行脚本为iOS和模拟器编译GDAL

为了在您的 iOS 项目中使用 GDAL，您需要将源代码编译为静态库 (.a)。使用支持 iOS6 的最新架构，您应该为以下架构创建静态库：

*   i386 用于模拟器
*   适用于 iPhone 3GS 到 iPhone 4S 的 armv7
*   适用于 iPhone 5 的 armv7s

## 为 1 个架构构建的基本脚本

以下脚本改编自[pseudogreen](http://pseudogreen.org/blog/build_autoconfed_libs_for_iphone.html)的脚本，可以为单一架构编译源代码。

将此代码复制粘贴到文本编辑器中，并将其保存为扩展名为 .sh 的文件：例如 build_gdal_ios.sh。

要使用它，请将脚本复制到下载 gdal 源代码的目录中并按如下方式运行它：

*   为模拟器构建库：

    ```
    `sh build_gdal_ios.sh -p "location where you want to save the resulting files" simulator` 
    ```

*   要为设备构建它：

    ```
    `sh build_gdal_ios.sh -p "location where you want to save the resulting files" -a "architecture" device` 
    ```

您也可以键入`sh build_gdal_ios.sh -h`以获得帮助。

```
 #!/bin/bash
    ################################################################################
    #
    # Copyright (c) 2008-2009 Christopher J. Stawarz
    #
    # Permission is hereby granted, free of charge, to any person
    # obtaining a copy of this software and associated documentation files
    # (the "Software"), to deal in the Software without restriction,
    # including without limitation the rights to use, copy, modify, merge,
    # publish, distribute, sublicense, and/or sell copies of the Software,
    # and to permit persons to whom the Software is furnished to do so,
    # subject to the following conditions:
    #
    # The above copyright notice and this permission notice shall be
    # included in all copies or substantial portions of the Software.
    #
    # THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    # EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    # MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    # NONINFRINGEMENT.  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
    # BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
    # ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
    # CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    # SOFTWARE.
    #
    ################################################################################

    # Disallow undefined variables
    set -u

    default_gcc_version=4.2
    default_iphoneos_version=6.0
    default_macos_version=10.8
    default_architecture=armv7
    default_prefix="${HOME}/Documents/iOS_GDAL"

    GCC_VERSION="${GCC_VERSION:-$default_gcc_version}"
    export IPHONEOS_DEPLOYMENT_TARGET="${IPHONEOS_DEPLOYMENT_TARGET:-$default_iphoneos_version}"
    export MACOSX_DEPLOYMENT_TARGET="${MACOSX_DEPLOYMENT_TARGET:-$default_macos_version}"
    DEFAULT_ARCHITECTURE="${DEFAULT_ARCHITECTURE:-$default_architecture}"
    DEFAULT_PREFIX="${HOME}/Documents/iOS_GDAL"

    echo Default architecture: $DEFAULT_ARCHITECTURE

    usage ()
    {
        cat >&2 << EOF
    Usage: ${0##*/} [-ht] [-p prefix] [-a arch] target [configure_args]
        -h  Print help message
        -p  Installation prefix (default: \$HOME/Documents/iOS_GDAL...)
        -t  Use 16-bit Thumb instruction set (instead of 32-bit ARM)
        -a  Architecture target for compilation (default: armv7)

    The target must be "device" or "simulator".  Any additional arguments
    are passed to configure.

    The following environment variables affect the build process:

        GCC_VERSION (default: $default_gcc_version)
        IPHONEOS_DEPLOYMENT_TARGET  (default: $default_iphoneos_version)
        MACOSX_DEPLOYMENT_TARGET    (default: $default_macos_version)
        DEFAULT_PREFIX  (default: $default_prefix)
    EOF
    }

    prefix="${DEFAULT_PREFIX}"

    echo Prefix: $prefix

    while getopts ":hp:a:t" opt; do
        case $opt in
        h  ) usage ; exit 0 ;;
        p  ) prefix="$OPTARG" ;;
        t  ) thumb_opt=thumb ;;
        a  ) DEFAULT_ARCHITECTURE="$OPTARG" ;;
        \? ) usage ; exit 2 ;;
        esac
    done
    shift $(( $OPTIND - 1 ))

    if (( $# < 1 )); then
        usage
        exit 2
    fi

    target=$1
    shift

    case $target in

        device )
        arch="${DEFAULT_ARCHITECTURE}"
        platform=iPhoneOS
        extra_cflags="-m${thumb_opt:-no-thumb} -mthumb-interwork"
        ;;

        simulator )
        arch=i386
        platform=iPhoneSimulator
        extra_cflags="-D__IPHONE_OS_VERSION_MIN_REQUIRED=${IPHONEOS_DEPLOYMENT_TARGET%%.*}0000"
        ;;

        * )
        echo No target found!!!
        usage
        exit 2

    esac

    platform_dir="/Applications/Xcode.app/Contents/Developer/Platforms/${platform}.platform/Developer"
    platform_bin_dir="${platform_dir}/usr/llvm-gcc-${GCC_VERSION}/bin"
    platform_sdk_dir="${platform_dir}/SDKs/${platform}${IPHONEOS_DEPLOYMENT_TARGET}.sdk"
    prefix="${prefix}/${arch}/${platform}.platform/${platform}${IPHONEOS_DEPLOYMENT_TARGET}.sdk"

    echo library will be exported to $prefix

    export CC="${platform_bin_dir}/llvm-gcc-${GCC_VERSION}"
    export CFLAGS="-arch ${arch} -pipe -Os -gdwarf-2 -isysroot ${platform_sdk_dir} ${extra_cflags}"
    export LDFLAGS="-arch ${arch} -isysroot ${platform_sdk_dir}"
    export CXX="${platform_bin_dir}/llvm-g++-${GCC_VERSION}"
    export CXXFLAGS="${CFLAGS}"
    export CPP="${platform_bin_dir}/llvm-cpp-${GCC_VERSION}"
    export CXXCPP="${CPP}"

    ./configure \
        --prefix="${prefix}" \
        --host="${arch}-apple-darwin" \
        --disable-shared \
        --enable-static \
        --with-unix-stdio-64=no \
        "$@" || exit

    make install || exit

    cat >&2 << EOF

    Build succeeded!  Files were installed in

      $prefix

   EOF 
```

请注意，此脚本有一些默认参数，您可以更改这些参数以反映您的偏好或 SDK 或 LLVM Apple 编译器中的更改：

*   default_gcc_version=4.2
*   default_iphoneos_version=6.0
*   default_macos_version=10.8
*   默认架构=armv7
*   default_prefix="${HOME}/Documents/GDALLibrary"

## 现在为多种架构构建

使用前面的脚本`build_gdal_ios.sh`（

以下脚本允许这样做（将其保存为另一个名称，例如 build_gdal_all_ios.sh）：

```
#!/bin/bash
make clean
./build_gdal_ios.sh -p ${HOME}/Documents/GDALLibrary -a armv7 device
make clean
./build_gdal_ios.sh -p ${HOME}/Documents/GDALLibrary -a armv7s device
make clean
./build_gdal_ios.sh -p ${HOME}/Documents/GDALLibrary simulator 
```

运行此脚本后，您的库将保存在 ${HOME}/Documents/GDALLibrary 目录的子文件夹中：

*   ${HOME}/Documents/GDALLibrary/i386/iPhoneSimulator.platform/iPhoneSimulator6.0.sdk/lib
*   ${HOME}/Documents/GDALLibrary/armv7/iPhoneOS.platform/iPhoneSimulator6.0.sdk/lib
*   ${HOME}/Documents/GDALLibrary/armv7s/iPhoneOS.platform/iPhoneSimulator6.0.sdk/lib

您现在可以使用可执行的 lipo（用于吸脂）将 3 个库合并为一个，如下所示：

```
lipo ${HOME}/Documents/GDALLibrary/i386/iPhoneSimulator.platform/iPhoneSimulator6.0.sdk/lib/libgdal.a ${HOME}/Documents/GDALLibrary/armv7/iPhoneOS.platform/iPhoneSimulator6.0.sdk/lib/libgdal.a ${HOME}/Documents/GDALLibrary/armv7s/iPhoneOS.platform/iPhoneSimulator6.0.sdk/lib/libgdal.a -output ${HOME}/Documents/GDALLibrary/libgdal.a -create 
```

......你完成了......

# 将静态库添加到您的 XCode 项目

这一步相当简单：

1.  在 Xcode (4.5) 中创建一个新项目或打开您想要添加 GDAL 的项目
2.  在文件资源管理器中右键单击并选择“将文件添加到项目”
3.  选择上面创建的 libgdal.a 以及包含目录之一中的包含文件（3 个目录包含相同的文件）
4.  将以下库添加到您的 XCode 项目（来自项目框架列表）：
    *   libstdc++.6.0.9.dylib
    *   libz.dylib
    *   libiconv.dylib
    *   libsqlite3.dylib
    *   libxml2.dylib（如果架构 armv7 的未定义符号：“_xmlCatalogResolveSystem”等）

构建您的代码。一切都应该顺利编译。

# 开始编码

这里有一个技巧：您在 Objective-C 环境中使用 C++ 库（和头文件）。如果将 GDAL 头文件之一包含到 .m 文件中，XCode 将抱怨 C++ 语法。

在这里，您有两个解决方案：

1.  将所有 GDAL 代码写入 .mm 文件中，然后 Xcode 将其识别为 Objective-C++ 文件并进行编译
2.  在您的 Objective-C 文件中使用类扩展，如 Phil Jordan 在其出色的文章[Mixing Objective-C++ 和 C++中所述](http://www.philjordan.eu/article/mixing-objective-c-c++-and-objective-c++)

在某一时刻，我将发布一些 GDAL 代码示例......但稍后......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-15T07:54:08.190

也可以使用[lutraconsulting/input-sdk](https://github.com/lutraconsulting/input-sdk)存储库，其中可以下载或构建带有 OSGeo 库的预构建 ios 二进制文件。

# mysql - 正则表达式替换导入文件的字符值

> ID：12643899
> 
> 赞同：1
> 
> 时间：2012-09-28T16:29:44.843
> 
> 标签：mysql, regex, notepad++

我试图找出一个正则表达式搜索并替换文本文件导入。有一些十六进制值需要被 mysql char() 函数包围。

值前面有一个逗号和一个空格，后面紧跟一个逗号。

我在我的文本编辑器 Notepad++ 中使用搜索和替换

输入示例：

```
, 0x31,
, 0x3137,
, 0x333731393831, 
```

期望的结果：

```
, char(0x31),
, char(0x3137),
, char(0x333731393831), 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:37:32.037

替换`, (0x[0-9a-f]+),`为`, char(\1),`, 未选择“匹配大小写”并选择“正则表达式”：

![Notepad++ 查找/替换示例](../Images/61b026c985cc378b39b29ed19140b1be.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:32:41.650

`\b0[xX][0-9a-fA-F]+\b` will match a hexidecimal number. ([Source](http://www.regular-expressions.info/regexbuddy/hex.html))

Just find that and replace it with `"char(" + match + ")";`

I don't know what the exact syntax for doing that in notepad++ is, but I'm sure it can be done.

# html - CKEditor在工具栏中添加两个按钮，其中添加两个自定义html标签/代码

> ID：12643901
> 
> 赞同：0
> 
> 时间：2012-09-28T16:29:50.107
> 
> 标签：html, button, tags, ckeditor, toolbar

我想向工具栏添加两个按钮，将自定义 html-tag/html 代码（如和“”）添加到光标位置。

我阅读了线程[如何将自定义按钮添加到调用 JavaScript 函数的工具栏？](https://stackoverflow.com/questions/1957156/ckeditor-how-to-add-a-custom-button-to-the-toolbar-that-calls-a-javascript-func)但是太难了。

您是否知道我的计划的简单方法，或者是否可以从原始 ckeditor 源代码（如 hr-button）复制代码部分并对其进行自定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:33:42.787

使用这个插件[http://cksource.com/forums/viewtopic.php?f=18&t=25546](http://cksource.com/forums/viewtopic.php?f=18&t=25546)

# javascript - 长度属性在 firefox 和 IE/Chrome 之间的工作方式不同

> ID：12643905
> 
> 赞同：0
> 
> 时间：2012-09-28T16:30:10.273
> 
> 标签：javascript, jquery, json

```
$($.ajax({
    url: 'http://localhost:3606/runs',
    //beforeSend: function (xhr) {
    //    xhr.setRequestHeader("Origin", "http://localhost:2286/");
    //},
    success: function(data) {
        for (var i = 0; i < data.length; i++) {
            var list = $('#runs');
            list.append('<li id="' + data[i].RunId + '">' + data[i].Distance + "</li>");
        }
     }
})) 
```

以下代码在 ie10 和 chrome 22 中正常工作。它在 firefox 15.0.1 中没有。上面的数据变量是从休息服务（web api）返回的。这是它返回的json：

```
HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: application/json; charset=utf-8
Expires: -1
Server: Microsoft-IIS/8.0
Access-Control-Allow-Origin: *
X-AspNet-Version: 4.0.30319
X-SourceFiles: =?UTF-8?B?QzpcVXNlcnNcQnJlbnRcRG9jdW1lbnRzXFZpc3VhbCBTdHVkaW8gMjAxMlxQcm9qZWN0c1xURlNcUnVuTG9nXE1haW5cUnVuTG9nXHJ1bnM=?=
X-Powered-By: ASP.NET
Date: Fri, 28 Sep 2012 16:04:47 GMT
Content-Length: 197

[{"RunId":1,"Date":"2012-09-28T00:00:00","Distance":4.00,"Hours":null,"Minutes":35,"Seconds":null},{"RunId":2,"Date":"2012-09-28T00:00:00","Distance":6.00,"Hours":null,"Minutes":50,"Seconds":null}] 
```

ie & chrome 中的 data.length 为 2。firefox 中的 data.length 为 197。这是 data 变量在 firefox 中的样子：

```
"[{"RunId":1,"Date":"2012-09-28T00:00:00","Distance":4.00,"Hours":null,"Minutes":35,"Seconds":null},{"RunId":2,"Date":"2012-09-28T00:00:00","Distance":6.00,"Hours":null,"Minutes":50,"Seconds":null}]" 
```

在 ie/chrome 中它看起来像：

```
<ul id="runs">
    <li id="1">4</li>
    <li id="2">6</li>
</ul> 
```

在火狐中：

```
<ul id="runs">
   <li id="undefined">undefined</li>
   ...197 times
</ul> 
```

任何人都知道为什么 Firefox 无法正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:39:55.767

我想您需要将数据解析为json。目前它以字符串格式出现，Firefox 将其视为字符串。因此，请尝试以下代码：

```
$($.ajax({
    url: 'http://localhost:3606/runs',
    //beforeSend: function (xhr) {
    //    xhr.setRequestHeader("Origin", "http://localhost:2286/");
    //},
    success: function(data) {
        var result = JSON.parse(data);
        for (var i = 0; i < result.length; i++) {
            var list = $('#runs');
            list.append('<li id="' + result[i].RunId + '">' + result[i].Distance + "</li>");
        }
     }
})) 
```

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:40:40.353

将 dataType-option 添加到 $.ajax-call 中：

```
$($.ajax({
    url: 'http://localhost:3606/runs',
    dataType:'json',
    //beforeSend: function (xhr) {
    //    xhr.setRequestHeader("Origin", "http://localhost:2286/");
    //},
    success: function(data) {
        for (var i = 0; i < data.length; i++) {
            var list = $('#runs');
            list.append('<li id="' + data[i].RunId + '">' + data[i].Distance + "</li>");
        }
     }
})) 
```

# excel - 记录分组时如何过滤 Excel 数据？

> ID：12643906
> 
> 赞同：0
> 
> 时间：2012-09-28T16:30:18.023
> 
> 标签：excel

所以我们都知道，我们可以使用 Excel 中的过滤工具过滤单个列中的数据。

不幸的是，我已将显示如下的记录分组：

```
ID        Total        ItemVal
1224      1,599,879    0
1224      0            15,799
1224      0            1,113,556
1224      0            470,524
1723      4,844,453    4,844,453
2078      155,433      155,433 
```

在这种情况下，我要做的是显示总计大于一百万的所有记录。

如果总数为一百万，则显示该特定 ID 的所有记录。

如果我过滤，我得到的只是行：

```
ID        Total        ItemVal
1224      1,599,879    0
1723      4,844,453    4,844,453 
```

当我真正想要的是：

```
ID        Total        ItemVal
1224      1,599,879    0
1224      0            15,799
1224      0            1,113,556
1224      0            470,524
1723      4,844,453    4,844,453 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:59:06.303

微软访问：

```
SELECT t.ID, t.Total, t.ItemVal
FROM Table t
WHERE t.ID In (
   select ID 
   from table 
   where total >1000000) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:43:01.443

在 Excel 中，最简单的方法是添加一个辅助列，其公式如下，它将返回 True/False，您可以对其进行过滤。

`=sumif(A:A,A2,C:C)>1E6`

# javascript - Spread.NET 和 javascript

> ID：12643910
> 
> 赞同：1
> 
> 时间：2012-09-28T16:30:38.600
> 
> 标签：javascript, spreadsheet, farpoint-spread

我正在尝试添加一个按住 shift-click 功能来选择一系列单元格（默认情况下，这正是 winforms 中的传播功能）。
我想要做的是识别当传播组件在焦点上时第一次按下 shift 键并将单元格坐标保存在隐藏输入中。

出于某种原因，我无法从 ActiveCol 或 ActiveRow 中获取值。他们返回未定义。我尝试使用代码预设一个活动单元格，但它仍然返回未定义。

我还检查了“ss”的值，它正在返回一个元素。

```
 function shiftCheckDown(event)
        {
            var ss = document.getElementById('<%=FpSpread1.ClientID %>');

            //ss.SetActiveCell(0,3);

            if (ss != null) {

                var col = ss.ActiveCol;
                var row = ss.ActiveRow;
  //var col = FpSpread1.ActiveCol;
  //var row = FpSpread1.ActiveRow;

                if (event.keyCode == 16) {

                        alert(row);

                        document.getElementById('RowCoord').value = row;
                        document.getElementById('ColCoord').value = col;
                }           
            }
        } 
```

我正在使用 onkeydown 来调用该函数。

```
<FarPoint:FpSpread onkeydown="shiftCheckDown(event)" ID="FpSpread1" runat="server" ActiveSheetViewIndex="0" . . . 
```

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:24:00.650

`ActiveCol`并且`ActiveRow`仅适用于 IE

对于 Firefox 和其他浏览器，您需要使用`GetActiveRow`和`GetActiveCol`

```
 var col = ss.ActiveCol;
            var row = ss.ActiveRow;

            if (col == undefined) {
                var col = ss.GetActiveCol;
                var row = ss.GetActiveRow;
            } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-04-05T08:09:29.113

实际上是这样的：

```
col = ss.GetActiveCol();
row = ss.GetActiveRow(); 
```

# ruby-on-rails - 重构视图（和继承的变量）

> ID：12643912
> 
> 赞同：0
> 
> 时间：2012-09-28T16:30:53.530
> 
> 标签：ruby-on-rails, ruby-on-rails-3, refactoring

我有这个很难阅读的代码视图，需要一些重构：

```
 <div class="tab-content">
    <% @posts.each_with_index do |post,pi| %>
      <div class="tab-pane fade <%= 'active in' if pi == 0 %>" id="<%= "post_"+ pi.to_s %>">
        <h2><%= post.title %></h2>
        <ul class="thumbnails">
          <% post.assets.each_with_index do |asset, i| %>
            <%= link_to (image_tag (asset.photo.url(:thumb))), "#p"+pi.to_s+"a"+i.to_s, :"data-toggle" => "modal", :class => "thumbnail span2" %>
            <div class="modal hide fade" id="<%= "p"+pi.to_s+"a"+i.to_s %>" >
              <div class="modal-body">
                <div class="carousel slide" id="<%= "carousel_"+"p"+pi.to_s+"a"+i.to_s %>" >
                  <div class="carousel-inner" >
                    <% post.assets.each_with_index do |photo, ai| %>
                      <div class="<%= 'active ' if ai == i %>item">
                        <%= image_tag photo.photo.url(:normal) %>
                        <div class="carousel-caption">
                          <h4><%= post.title %></h4>
                        </div>
                      </div>
                    <% end %>
                  </div>
                  <a class="carousel-control left" href="<%= "#carousel_"+"p"+pi.to_s+"a"+i.to_s %>" data-slide="prev">&lsaquo;</a>
                  <a class="carousel-control right" href="<%= "#carousel_"+"p"+pi.to_s+"a"+i.to_s %>" data-slide="next">&rsaquo;</a>
                </div>
              </div>
            </div>
          <% end %>
        </ul>
        <div><%= mdown(post.content) %></div>
        <p><%= raw post.tags.map(&:name).map { |t| link_to t, tag_path(t) }.join(', ') %></p>
        <p>
          <%= link_to 'Show', post %>
          <%= link_to 'Edit', edit_post_path(post) %>
          <%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %>
        </p>
      </div>
    <% end %>

    <br />

    <%= link_to 'New Post', new_post_path %>
  </div> 
```

基本上它列出了每个帖子，并呈现帖子的每个图像。每个图像都是一个可点击的缩略图，会弹出一个包含轮播的模式。每个轮播再次包含给定帖子的每张照片。

我的想法是将代码从第 8 行移到第 24 行，并将其移到部分中。问题是我收到此错误：

```
undefined local variable or method `pi' for #<#<Class:0x000000023b18f0>:0x007f91ec67c458> 
```

有没有办法让部分继承父级的变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:37:47.723

您可以将局部变量传递给局部视图： [在 RubyOnRails 的指南中，第 3.4.4 节“传递局部变量”](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)

他们的例子：

```
<%= render :partial => "form", :locals => { :zone => @zone } %> 
```

在你的情况下：

```
<%= render :partial => "modal_box", :locals => { :pi => pi } %> 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:58:23.013

将当地人传递给部分...

```
<%= render :partial => 'blah' , :locals => { :var => value} %> 
```

或者

```
<%= render 'blah' , :var => value %> 
```

# android - Lazylist loading same data/images

> ID：12643915
> 
> 赞同：1
> 
> 时间：2012-09-28T16:30:56.497
> 
> 标签：android, android-listview

I am currently using Android's Lazylist at [https://github.com/thest1/LazyList](https://github.com/thest1/LazyList), loading images into my listview.

The problem I faced is that the images and data loaded are correct for the first two pages. Upon reaching the third page, the data and images loaded are the same as the first page yet again, and the problem continues for the subsequent pages.

Example : Page 1

![enter image description here](../Images/ed6b81edad377a1c6c6e5e089928cd3c.png)

And when it reaches page 3,

![enter image description here](../Images/ca60f7e4b27a7a182aae30ba993411d1.png)

Look at the date, and images loaded. It's the same. The data is grabbed off a website, and the website is sending data properly when viewed on a web browser.

Any reason the data loaded is repeated?

MainActivity

```
public class MainActivity extends Activity {
    XMLParser parser;
    Document doc;
    String xml;
    ListView lv;
    ListViewAdapter adapter;
    ArrayList<HashMap<String, String>> menuItems;
    ProgressDialog pDialog;
    int limit = 8;
    boolean loadingMore = false;

    String URL = "http://test.com/5.php";

    // Flag for current page
    int current_page = 1;

    @Override
    public void onPause() {
        super.onPause();
    }

    @Override
    public void onResume() {
        super.onResume();
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {

        lv = (ListView) findViewById(R.id.list);

        menuItems = new ArrayList<HashMap<String, String>>();
        parser = new XMLParser();
        new firstLoad().execute();

        // Getting adapter
        adapter = new ListViewAdapter(this, menuItems);
        lv.setAdapter(adapter);

        lv.setOnScrollListener(new OnScrollListener() {

            public void onScrollStateChanged(AbsListView view, int scrollState) {
            }

            public void onScroll(AbsListView view, int firstVisibleItem,
                    int visibleItemCount, int totalItemCount) {

                int lastInScreen = firstVisibleItem + visibleItemCount;
                if ((lastInScreen == totalItemCount) && !(loadingMore)) {
                    new loadMoreListView().execute();
                }
            }
        });

    /**
     * Async Task that send a request to url Gets new list view data Appends to
     * list view
     * */
    private class loadMoreListView extends AsyncTask<Void, Void, Void> {

        @Override
        protected void onPreExecute() {
            // Showing progress dialog before sending http request
            pDialog = new ProgressDialog(MainActivity.this);
            pDialog.setMessage("Please wait..");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(false);
            pDialog.show();
        }

        protected Void doInBackground(Void... unused) {
            loadingMore = true;
            // increment current page
            current_page += 1;

            // Next page request
            URL = URL + "?page=" + current_page;

            xml = parser.getXmlFromUrl(URL); // getting XML
            doc = parser.getDomElement(xml); // getting DOM element

            NodeList nl = doc.getElementsByTagName(KEY_ITEM);
            // looping through all item nodes <item>
            for (int i = 0; i < nl.getLength(); i++) {
                // creating new HashMap
                HashMap<String, String> map = new HashMap<String, String>();
                Element e = (Element) nl.item(i);

                // adding each child node to HashMap key => value
                map.put(KEY_ID, parser.getValue(e, KEY_ID));
                map.put(KEY_NAME, parser.getValue(e, KEY_NAME));
                map.put(KEY_IMG, parser.getValue(e, KEY_IMG));
                map.put(KEY_DATE, parser.getValue(e, KEY_DATE));
                map.put(KEY_WEBSITEURL, parser.getValue(e, KEY_WEBSITEURL));
                map.put(KEY_IMAGEURL, parser.getValue(e, KEY_IMAGEURL));
                // adding HashList to ArrayList
                menuItems.add(map);
            }

            return (null);
        }

        protected void onPostExecute(Void unused) {
            // closing progress dialog
            runOnUiThread(new Runnable() {
                public void run() {
                    // add things to do here
                    pDialog.dismiss();

                    // get listview current position - used to maintain scroll
                    // position
                    int currentPosition = lv.getFirstVisiblePosition();
                    Toast.makeText(getApplicationContext(), "Current on page " + String.valueOf(current_page), Toast.LENGTH_SHORT).show();
                    // Appending new data to menuItems ArrayList
                    adapter = new ListViewAdapter(MainActivity.this, menuItems);
                    lv.setAdapter(adapter);

                    // Setting new scroll position
                    lv.setSelectionFromTop(currentPosition + 1, 0);
                    loadingMore = false;
                }
            });

        }
    }

    private class firstLoad extends AsyncTask<Void, Void, Void> {

        @Override
        protected void onPreExecute() {
            // Showing progress dialog before sending http request
            pDialog = new ProgressDialog(MainActivity.this);
            pDialog.setMessage("Loading..");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(false);
            pDialog.show();
        }

        protected Void doInBackground(Void... unused) {
            loadingMore = true;
            xml = parser.getXmlFromUrl(URL); // getting XML
            doc = parser.getDomElement(xml); // getting DOM element

            NodeList nl = doc.getElementsByTagName(KEY_ITEM);
            // looping through all item nodes <item>
            for (int i = 0; i < nl.getLength(); i++) {
                // creating new HashMap
                HashMap<String, String> map = new HashMap<String, String>();
                Element e = (Element) nl.item(i);

                // adding each child node to HashMap key => value
                map.put(KEY_ID, parser.getValue(e, KEY_ID));
                map.put(KEY_NAME, parser.getValue(e, KEY_NAME));
                map.put(KEY_IMG, parser.getValue(e, KEY_IMG));
                map.put(KEY_DATE, parser.getValue(e, KEY_DATE));
                map.put(KEY_WEBSITEURL, parser.getValue(e, KEY_WEBSITEURL));
                map.put(KEY_IMAGEURL, parser.getValue(e, KEY_IMAGEURL));
                // adding HashList to ArrayList
                menuItems.add(map);
            }

            // Appending new data to menuItems ArrayList

            return (null);
        }

        protected void onPostExecute(Void unused) {
            // closing progress dialog

            runOnUiThread(new Runnable() {
                public void run() {
                    loadingMore = false;
                    // add things to do here
                    pDialog.dismiss();
                    adapter = new ListViewAdapter(MainActivity.this, menuItems);
                    lv.setAdapter(adapter);
                }
            });

        }
    }
} 
```

Last question :

Is there a code whereby it saves the state of the listview, to prevent the data from being loaded all over again? When the user presses back multiple time to end this app, and when they open it again, the data is being loaded right from page 1\. Any code to save the state so it opens up where the user left off previously?

Thanks!

# c# - common.logging - Redirect found in application configuration file

> ID：12643921
> 
> 赞同：5
> 
> 时间：2012-09-28T16:31:29.327
> 
> 标签：c#, logging, nuget, log4net, common.logging

I added common.logging.log4net to my visual studio 2012 solution via nuget.

common.logging.log4net ver. - 2.0.1 common.logging ver. - 2.0.0 log4net - ver. 1.2.10

When I build/run it locally, I see the following exception via browser:

> Could not load file or assembly 'Common.Logging' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.
> 
> Exception Details: System.IO.FileLoadException: Could not load file or assembly 'Common.Logging' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)
> 
> Stack Trace:
> 
> [FileLoadException: Could not load file or assembly 'Common.Logging' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
> 
> [FileLoadException: Could not load file or assembly 'Common.Logging, Version=2.1.1.0, Culture=neutral, PublicKeyToken=af08829b84f0328e' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)] System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
> System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +210
> System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean forIntrospection) +242
> System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +17 System.Reflection.Assembly.Load(String assemblyString) +35
> System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +122

It is looking for Common.Logging Version=2.1.1.0, which it can't find because it is not loaded. Now when I debug the app, I see the following exception, which is a bit different:

> LOG: This bind starts in default load context.
> 
> LOG: Using application configuration file: C:\Workspaces\FTM\Apps\TM\TM.Web\web.config
> 
> LOG: Using host configuration file: C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet.config
> 
> LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework64\v4.0.30319\config\machine.config.
> 
> LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
> 
> LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/root/e97e0952/56ab271f/Common.Logging.DLL.
> 
> LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/root/e97e0952/56ab271f/Common.Logging/Common.Logging.DLL.
> 
> LOG: Attempting download of new URL file:///C:/Workspaces/FTM/Apps/TM/TM.Web/bin/Common.Logging.DLL.
> 
> LOG: Using application configuration file: C:\Workspaces\FTM\Apps\TM\TM.Web\web.config
> 
> LOG: Using host configuration file: C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet.config
> 
> LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework64\v4.0.30319\config\machine.config.
> 
> LOG: Redirect found in application configuration file: 2.0.0.0 redirected to 2.1.1.0.
> 
> LOG: Post-policy reference: Common.Logging, Version=2.1.1.0, Culture=neutral, PublicKeyToken=af08829b84f0328e
> 
> LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/root/e97e0952/56ab271f/Common.Logging.DLL.
> 
> LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/root/e97e0952/56ab271f/Common.Logging/Common.Logging.DLL.
> 
> LOG: Attempting download of new URL file:///C:/Workspaces/FTM/Apps/TM/TM.Web/bin/Common.Logging.DLL. WRN: Comparing the assembly name resulted in the mismatch: Minor Version ERR: Failed to complete setup of assembly (hr = 0x80131040). Probing terminated.
> 
> Stack Trace:
> 
> [FileLoadException: Could not load file or assembly 'Common.Logging' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
> 
> [FileLoadException: Could not load file or assembly 'Common.Logging, Version=2.1.1.0, Culture=neutral, PublicKeyToken=af08829b84f0328e' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)] System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
> System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +210
> System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean forIntrospection) +242
> System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +17 System.Reflection.Assembly.Load(String assemblyString) +35
> System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +122
> 
> [ConfigurationErrorsException: Could not load file or assembly 'Common.Logging, Version=2.1.1.0, Culture=neutral, PublicKeyToken=af08829b84f0328e' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
> System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +12761078
> System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +503 System.Web.Configuration.AssemblyInfo.get_AssemblyInternal() +142 System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +334
> System.Web.Compilation.BuildManager.CallPreStartInitMethods(String preStartInitListPath) +203
> System.Web.Compilation.BuildManager.ExecutePreAppStart() +152
> System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +1151
> 
> [HttpException (0x80004005): Could not load file or assembly 'Common.Logging, Version=2.1.1.0, Culture=neutral, PublicKeyToken=af08829b84f0328e' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
> System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +12881540 System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +159 System.Web.HttpRuntime.ProcessRequestNotificationPrivate(IIS7WorkerRequest wr, HttpContext context) +12722601
> 
> Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.17929

Not sure why its trying to redirect to 2.1.1.0 (according to the logs)

Tom

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-05T03:46:11.513

我认为这一行暗示了这个问题：

```
LOG: Redirect found in application configuration file: 2.0.0.0 redirected to 2.1.1.0. 
```

检查您的应用程序配置文件 (app.config) 中的程序集重定向，该重定向告诉它在任何请求版本 2.0.0.0 时尝试加载版本 2.1.1.0。

# sql - Oracle Sproc 错误 SQL

> ID：12643924
> 
> 赞同：0
> 
> 时间：2012-09-28T16:31:36.027
> 
> 标签：sql, oracle

我有以下编译得很好的sproc：

```
CREATE OR REPLACE PROCEDURE SSACHDEV.SyncTeleappWithClientinfo
as
mine varchar2(1);
v_teleCaseNbr      number;
v_cashwithappyn varchar2(1);

CURSOR TeleAppCursor
is
    Select 
        distinct casenbr, cashwithappyn
    from TeleApp;

BEGIN
dbms_output.put_line('begin');
open TeleAppCursor;

LOOP
    fetch TeleAppCursor into v_teleCaseNbr, v_cashwithappyn;
    EXIT when TeleAppCursor%NOTFOUND; -- this one has the problem

    Select cashwithappyn into mine from ClientInfo where casenbr = v_teleCaseNbr and trim(cashwithappyn) is null;

END LOOP;
dbms_output.put_line('end');
END; 
```

但是当我尝试使用以下命令运行它时：

```
BEGIN 
  SSACHDEV.SYNCTELEAPPWITHCLIENTINFO;
END; 
```

我收到以下错误：

```
ORA-01403: no data found
ORA-06512: at "SSACHDEV.SYNCTELEAPPWITHCLIENTINFO", line 21
ORA-06512: at line 2 
```

有谁知道为什么？或者我能做些什么来避免这些问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:36:07.707

发生这种情况是因为过程中的第二个`select`语句 ( `Select cashwithappyn into mine from ..`) 没有返回数据。在您的过程中添加`EXCEPTION`部分以处理该异常。

```
CREATE OR REPLACE PROCEDURE SSACHDEV.SyncTeleappWithClientinfo
as
mine varchar2(1);
v_teleCaseNbr      number;
v_cashwithappyn varchar2(1);

CURSOR TeleAppCursor
is
    Select 
        distinct casenbr, cashwithappyn
    from TeleApp;

BEGIN
dbms_output.put_line('begin');
open TeleAppCursor;

LOOP
    fetch TeleAppCursor into v_teleCaseNbr, v_cashwithappyn;
    EXIT when TeleAppCursor%NOTFOUND;

    Select cashwithappyn into mine from ClientInfo where casenbr = v_teleCaseNbr and trim(cashwithappyn) is null;

END LOOP;
dbms_output.put_line('end');

EXCEPTION
  WHEN NO_DATA_FOUND 
  THEN  dbms_output.put_line(' no data found'); -- for example
END; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T18:40:42.910

您是否确定异常部分应该放在循环之外？我宁愿把它放在循环中。至于我，plsql应该看起来像

```
CREATE OR REPLACE PROCEDURE SSACHDEV.SyncTeleappWithClientinfo
as
mine varchar2(1);
v_teleCaseNbr      number;
v_cashwithappyn varchar2(1);

CURSOR TeleAppCursor
is
    Select 
        distinct casenbr, cashwithappyn
    from TeleApp;

BEGIN
dbms_output.put_line('begin');
open TeleAppCursor;

LOOP
    fetch TeleAppCursor into v_teleCaseNbr, v_cashwithappyn;
    EXIT when TeleAppCursor%NOTFOUND;
    begin
       Select cashwithappyn into mine from ClientInfo where casenbr = v_teleCaseNbr and trim(cashwithappyn) is null;
    when no_data_found then dbms_output.put_line('end');
    end;

END LOOP;

END; 
```

但可以肯定的是，应该使用 LEFT JOIN 在游标本身中完成这些工作，以免数据库因循环内的大量小查询而发疯。

# ios - How to prevent Game Center pop-ups to mess up with my landscape-only views' orientations?

> ID：12643926
> 
> 赞同：1
> 
> 时间：2012-09-28T16:31:48.240
> 
> 标签：ios, uinavigationcontroller, rotation, game-center, gamekit

My iPad application is landscape only and supports the Game Center framework.

After the following sequence:

1.  the authentication Game Center popup is shown,
2.  the user decides to create a profile
3.  the detailed account-creation popup managed by the GameKit framework is displayed
4.  the user cancels the operation

my app has messed up views: the views have rotated 90° degrees on the left.

![Description of the messy views](../Images/a0d88f0806b4223485a7c14af36d69fb.png)

At this point, rotating the app won't help, and I need to relaunch my app to get the thing fixed.

Of course, all my low-level view controllers involved (except the root navigation controller which is a basic UINavigationController) are implementing the following method:

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return UIInterfaceOrientationIsLandscape(interfaceOrientation);
} 
```

Any idea why I get such a messy behavior?

# javascript - Toggle visibility of a complex popover-style css menu with jQuery

> ID：12643929
> 
> 赞同：0
> 
> 时间：2012-09-28T16:32:17.850
> 
> 标签：javascript, jquery, css, toggle

I am trying to implement an iOS popover-style menu for a mobile layout [based on this proof of concept](https://forrst.com/posts/CSS3_iPad_style_popover_menu-PJv).

I have tried solutions given on previous answers on this forum, and have narrowed down the toggle function to the simplest 2-line code. This renders the menu items correctly on my page, check out the demo & live code:

[http://jsfiddle.net/vgbn/eU2Zc/](http://jsfiddle.net/vgbn/eU2Zc/)

However, I wasn't able to toggle the visibility with the JS code, and I was wondering whether it's the JS or the CSS that prevents the show/hide div?

Any help would be appreciated, thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:36:42.597

只需更改您的函数以**返回false；**

```
$(function(){
$(".popmenu").click(function() {

    $(".popover").toggle();
  return false;
});
}); 
```

这是[演示](http://jsbin.com/ixuvax/1/edit)

# .net - Create a space filler template using xslt

> ID：12643931
> 
> 赞同：0
> 
> 时间：2012-09-28T16:32:23.147
> 
> 标签：.net, xml, whitespace, xslt-1.0

I need to create two separate templates that fill space. One that occupies 49 spaces and the other fills 549 spaces. I found on template that I thinks may work but I can't really tell what its doing, I'm new to xml.

```
<!-- Template Filler-->
  <xsl:template name="Filler">
    <xsl:param name="fillercount" select="1"/>
    <xsl:if test="$fillercount > 0">
      <table class="tabledetails">
        <tr>
          <td>
            <xsl:value-of select="translate(' ', ' ', '&#160;')"/>
          </td>
        </tr>
      </table>
      <xsl:call-template name="Filler">
        <xsl:with-param name="fillercount" select="$fillercount - 1"/>
      </xsl:call-template>
    </xsl:if>
  </xsl:template> 
```

Is this what I need , and call it with `select="49"` or am I reading it wrong. If this is now what I need how can I achieve this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:45:36.817

你还没有说你想要什么输出。如果您使用参数 49 调用此模板，则输出将包含 49 个表，每个表包含一行和一列，单元格的内容是不间断的空格字符。生成不间断空格字符的方式非常奇怪： translate() 调用将空格字符作为输入，然后通过用不间断空格替换所有空格来处理它。大概它是代码的缩减版本，在某个阶段做了一些更明智的事情。

代码的基本结构是一个递归模板，它接受一个参数，比如 49，输出一个“事物”（在本例中为单例表），然后调用自身再次执行 N-1 次。这是在 XSLT 1.0 中做某事 N 次的合适方法。（在 2.0 中，您可以使用`<xsl:for-each select="1 to $N">`，这对于使用命令式语言的程序员来说更加直观。）

# android - connecting android client to rails server

> ID：12643932
> 
> 赞同：1
> 
> 时间：2012-09-28T16:32:24.130
> 
> 标签：android, ruby-on-rails

I am a rails beginner and just generated scaffolded models. I am trying to connect this rails server to an android client that my co-founder made.

How can I do this? I was wondering if someone can please simplify the process to a beginner so that I can take the necessary steps to getting this done.

Thank you to anyone that helps!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:56:08.693

在这种情况下，Android 应用程序的代码将包括对服务器 API 的调用（通过对由 Rails 路由生成的[http://myapp.com/users](http://myapp.com/users)等 URL 的调用），这将返回来自 Rails 中的数据库的响应带有客户端将显示/评估的数据的应用程序。

您需要与您的联合创始人一起确定客户端需要什么类型的数据，识别那些 RESTful 端点，并在 Rails 中为那些尚不可用的端点创建其他方法和路由。

*   [https://devcenter.heroku.com/articles/ios-photo-sharing-geo-location-service](https://devcenter.heroku.com/articles/ios-photo-sharing-geo-location-service)
*   [https://github.com/CabForward/iOS-on-Rails](https://github.com/CabForward/iOS-on-Rails)
*   [http://pnhoang.tumblr.com/post/24160454924/build-a-rails-backend-api-for-an-iphone-client](http://pnhoang.tumblr.com/post/24160454924/build-a-rails-backend-api-for-an-iphone-client)

那里有大量的“创建 Rails API”文章，所以请四处挖掘。如果您有更具体的问题，请告诉我，我们可以在此处添加详细信息。

# java - SpringMvc java.lang.NullPointerException - 配置是否正确

> ID：12643944
> 
> 赞同：0
> 
> 时间：2012-09-28T16:33:17.073
> 
> 标签：java, web-services, spring-mvc, nullpointerexception, javabeans

关于这个问题的许多回应让我感到压力很大，很多人说我需要使用注释，但我认为这不是这里的问题，也许我的配置有错误。它可能在我的豆子接线中。我在两点遇到错误**1\. 当我从 userName 字段中跳出时 - 因为我当时正在执行 Web 服务，**以及**2\. 当我点击提交按钮并发布数据时。**

我正在尝试检查数据库以查看用户名是否*已经*存在，因此我使用了**Web 服务**，因此当我从该字段中取出时，它会检查数据库。当我将数据发布到服务器时，我也想进行同样的验证，所以我再次调用相同的函数。

该函数返回一个**布尔值**。它是类中的一个函数，接受 String *userName*的参数。也许我错误地连接了 bean。如果我创建一个**工厂 Bean并创建一个新的****applicationContext.xml**实例，它可以工作：

**FactoryBean.java**

```
package com.crimetrack.service;

import org.springframework.context.support.ClassPathXmlApplicationContext;

public final class FactoryBean {

      private static ClassPathXmlApplicationContext context;

      private static ClassPathXmlApplicationContext getContext() {
            if (context == null) {
                context = new ClassPathXmlApplicationContext("applicationContext.xml");
            }
            return context;
        }

      public static OfficerRegistrationValidation getOfficerRegistrationValidation() {
            return (OfficerRegistrationValidation) getContext().getBean("officerRegistrationValidation");
        }

} 
```

然后如果我使用

```
(FactoryBean.getOfficerRegistrationValidation().validateUserNameManager.DoesUserNameExist(officer.getUserName()) == true){ 
```

在**OfficerRegistrationValidation.java**中它可以工作，但我不能在我的应用程序中使用它，因为它会在**applicationContext.xml**中为每个bean 创建一个新实例，这会影响我的应用程序。

下面是我的代码和两个错误日志 1.当我从 userName 字段和 2.当我通过提交按钮发布表单时。我希望这可以很好地说明我正在努力实现的目标：

**office_registration.jsp**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
    <head>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>

        <style>
            <%@ include file="../css/forms.css" %>

        </style>
        <script type="text/javascript">
            <%@ include file="../js/off_reg.js"%>

            $(document).ready(function(){

                $('#userName').blur(function(evt){

                    CheckAvailability();                    
                });
            });         

            function CheckAvailability(){

                $.ajax( {
                      type:'GET', 
                      url:'validateUserName.htm',
                      data:{userName:$('#userName').val()},
                      dataType: 'json',
                      success:function(data) {

                        if (data == true){

                            alert("User Name Already Exists");

                            $("#userNameErr").text("User Name Already Exist");

                        }else if ($("#userName").val() == ""){

                            $("#userNameErr").text(" ");

                        }else if(data == false){

                            $("#userNameErr").text("User Name Valid");

                        }

                         }

                    });

        }   

        </script>

    <title>Officer Registration</title>

    </head>

    <body>
    <form:form method="post" modelAttribute="officers" action="officer_registration.htm">
        <ol>

            <li><label>User Name</label>
                <form:input path="userName"/><form:errors path="userName" id="errors"/><label id="userNameErr"></label></li>
            <li><label>Password</label>
                <form:password path="password"/><form:errors path="password" id="errors"/></li>
            <li><label>Re-Enter Password</label>
                <form:password path="password2"/><form:errors path="password2" id="errors"/></li>
            <li><label>e-Mail Address</label>
                <form:input path="emailAdd"/><form:errors path="emailAdd" id="errors"/></li>

            <br/>
            <li><input type="submit" name= "request" value="Register" />
            <input type="submit" name= "request" value="Update" /></li>         

        </ol>

    </form:form>

    </body>
</html> 
```

**OfficeRegistrationValidation.java**

```
public class OfficerRegistrationValidation implements Validator{

    private final Logger logger = Logger.getLogger(getClass());

    ValidateUserNameManager validateUserNameManager;

    public boolean supports(Class<?> clazz) {

        return Officers.class.equals(clazz);
    }

    public void validate(Object target, Errors errors) {

        Officers officer = (Officers) target;

        if (officer.getUserName() == null){

            errors.rejectValue("userName", "userName.required");

        }else{

            String userName = officer.getUserName();                    

            logger.info("OfficerRegistrationValidation - UserName is not null so going to check if its valid for :" + userName);
            try {

                logger.info("OfficerRegistrationValidation - Just before try.....catch block...userName is :" + userName);  

                logger.info("OfficerRegistrationValidation - about to evaluate if (validateUserNameManager.DoesUserNameExist(officer.getUserName()) == true)" );

                //using a factory bean to instantiate the creation of the bean
                //in some cases you want to use the existing bean and not instantiate

                //if (FactoryBean.getOfficerRegistrationValidation().validateUserNameManager.DoesUserNameExist(officer.getUserName()) == true){
                if (validateUserNameManager.DoesUserNameExist(officer.getUserName())== true){
                    errors.rejectValue("userName", "userName.exist");
                }
            } catch (Exception e) {

                logger.info("OfficerRegistrationValidation - Error Occured When validating UserName");
                logger.error("Message", e);
                errors.rejectValue("userName", "userName.error");
            }

        }

        if(officer.getPassword()== null){
            errors.rejectValue("password", "password.required");
        }

        if(officer.getPassword2()== null){
            errors.rejectValue("password2", "password2.required");
        }

    }

    /**
     * @return the validateUserNameManager
     */
    public ValidateUserNameManager getValidateUserNameManager() {
        logger.info("Getting - ValidateUserNameManager");
        return validateUserNameManager;
    }

    /**
     * @param validateUserNameManager the validateUserNameManager to set
     */
    public void setValidateUserNameManager(
            ValidateUserNameManager validateUserNameManager) {

        logger.info("Setting - ValidateUserNameManager");
        this.validateUserNameManager = validateUserNameManager;
    }       

} 
```

**验证用户名管理器.java**

```
public class ValidateUserNameManager implements ValidateUserNameIFace {

    public ValidateUserNameManager(){}

    private OfficersDAO officerDao;

    private final Logger logger = Logger.getLogger(getClass());

    public boolean DoesUserNameExist(String userName) throws Exception {

        logger.info("Inside ValidateUserNameManager");

        try{

            logger.info("ValidateUserNameManager - UserName is : " + userName);

            if(officerDao.OfficerExist(userName) == true){

                logger.info("ValidateUserNameManager - UserName :" + userName + " does exist");
                return true;

            }else{
                logger.info("ValidateUserNameManager - UserName :" + userName + " does NOT exist");
                return false;
            }

        }catch(Exception e){
            logger.error("Message", e);
            logger.info("ValidateUserNameManager - UserName :" + userName + " EXCEPTION OCCURED " + e.toString());
            return false;
        }       

    }

    /**
     * @return the officerDao
     */
    public OfficersDAO getOfficerDao() {
        logger.info("ValidateUserNameManager - getting officerDAO");
        return officerDao;
    }

    /**
     * @param officerdao the officerDao to set
     */
    public void setOfficerDao(OfficersDAO officerDao) {
        logger.info("ValidateUserNameManager - setting officerDAO");
        this.officerDao = officerDao;
    }

} 
```

**OfficeRegistrationController.java**

```
@Controller
public class OfficerRegistrationController {

    private final Logger logger = Logger.getLogger(getClass());
    private DivisionManager divisionManager;
    private PositionManager positionManager;
    private GenderManager genderManager;
    private Officers officer = new Officers();

    private ValidateUserNameManager validateUserNameManager;

    Map<String, Object> myDivision = new HashMap<String, Object>();
    Map<String, Object> myPosition = new HashMap<String, Object>();
    Map<String, Object> myGender = new HashMap<String, Object>();

    @InitBinder("officers")
    protected void initBinder(WebDataBinder binder){

        //removes white spaces 
        binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));

        //formats date 
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");

        //By passing true this will convert empty strings to null
        binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, true));
        dateFormat.setLenient(false);

        logger.info("Just before initBinder");
        binder.setValidator(new OfficerRegistrationValidation());

    }

     @RequestMapping(value="officer_registration.htm", method = RequestMethod.GET)
        public ModelAndView loadPage(HttpServletRequest request,
                HttpServletResponse response,@ModelAttribute Officers officer, BindingResult result, ModelMap m, Model model) throws Exception {     

         try{           

             logger.debug("In Http method for OfficerRegistrationController");

                myDivision.put("divisionList", this.divisionManager.getDivisions());

                myPosition.put("positionList", this.positionManager.getPositionList());

                myGender.put("genderList", this.genderManager.getGenderList());

                model.addAttribute("division", myDivision);
                model.addAttribute("position", myPosition);
                model.addAttribute("gender", myGender);

             return new ModelAndView("officer_registration");            

         }catch(Exception e){

            request.setAttribute("error",e.getMessage());
            return new ModelAndView("error_page");           
         }       
     }

     @RequestMapping(value="officer_registration.htm", method=RequestMethod.POST)
     public ModelAndView handleRequest(@Valid @ModelAttribute Officers officer, BindingResult result, ModelMap m, Model model)throws Exception{

         if(result.hasErrors()){

             model.addAttribute("division", myDivision);
             model.addAttribute("position", myPosition);
             model.addAttribute("gender", myGender);
             return new ModelAndView("officer_registration");

        }else{

            return null;
        }   

     }

     @RequestMapping(value="validateUserName.htm", method=RequestMethod.GET)

     public @ResponseBody String validateUserName(@RequestParam String userName)throws Exception{
         String results = "false";
         logger.info("Inside OfficerRegistrationController");
         try{

             logger.info("In try ..... catch for OfficerRegistrationController");
            if (validateUserNameManager.DoesUserNameExist(userName)== true){

                results = "true";
                return results;

             }   

         }catch(Exception e){

             logger.debug("Error in validateUserName Controller " + e.toString());
             return results;

         }

            return results;

     }

     public void setDivisionManager(DivisionManager divisionManager){

         this.divisionManager = divisionManager;
     }

     public void setPositionManager(PositionManager positionManager){

         this.positionManager = positionManager;

     }

     public void setGenderManager(GenderManager genderManager){

         this.genderManager = genderManager;
     }

    /**
     * @return the validateUserNameManager
     */
    public ValidateUserNameManager getValidateUserNameManager() {
        return validateUserNameManager;
    }

    /**
     * @param validateUserNameManager the validateUserNameManager to set
     */
    public void setValidateUserNameManager(
            ValidateUserNameManager validateUserNameManager) {
        this.validateUserNameManager = validateUserNameManager;
    }

    /**
     * @return the officer
     */
    public Officers getOfficer() {
        return officer;
    }

    /**
     * @param officer the officer to set
     */
    public void setOfficer(Officers officer) {
        this.officer = officer;
    }

} 
```

**犯罪跟踪-servlet.xml**

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"..............

<!-- __________________________________________________________________________________________________ -->    

     <!-- Supports annotations and allows the use of @Controller, @Required, @RequestMapping -->
    <context:annotation-config/>    

    <context:component-scan base-package="com.crimetrack" />
<!-- __________________________________________________________________________________________________ -->    

    <!-- Forwards requests to the "/" resource to the "login" view -->  
    <mvc:view-controller path="/login" view-name="login"/>

    <!-- Forwards requests to the "/" resource to the "officer_registration" view -->  
    <mvc:view-controller path="/officer_registration" view-name="officer_registration"/>
<!-- __________________________________________________________________________________________________ -->    

    <!--  <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"/> --> 

    <!--  Is used to process method level annotations -->
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"/>    
<!-- __________________________________________________________________________________________________ -->    

    <!-- <bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/>  --> 

     <bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource">
            <property name="basename" value="messages"/>
     </bean>
<!-- __________________________________________________________________________________________________ --> 

     <bean name="/hello.htm" class="com.crimetrack.web.CountryListController">
        <property name="countryManager" ref="countryManager"/>
     </bean>

    <bean name="/login.htm" class="com.crimetrack.web.AuthenticationController">
        <property name="authenticationManager" ref="authenticationManager"/>  
    </bean>

    <bean name="/officer_registration.htm" class="com.crimetrack.web.OfficerRegistrationController">
        <property name="divisionManager" ref="divisionManager" />
        <property name="positionManager" ref="positionManager" />
        <property name="genderManager" ref="genderManager"/>  
    </bean>

<!-- __________________________________________________________________________________________________ -->    

    <bean name="/validateUserName.htm" class="com.crimetrack.web.OfficerRegistrationController">

        <property name="validateUserNameManager" ref="validateUserNameManager"/>    

    </bean>    

<!-- __________________________________________________________________________________________________ -->    

      <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"></property>
        <property name="prefix" value="/WEB-INF/jsp/"></property>
        <property name="suffix" value=".jsp"></property>        
      </bean>

</beans> 
```

**应用程序上下文.xml**

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"...............

<!-- __________________________________________________________________________________________________ -->              

    <bean id="countryManager" class="com.crimetrack.service.CountryManager">
        <property name="countryDao" ref="countryDao"/>
    </bean>
    <bean id="countryDao" class="com.crimetrack.jdbc.JdbcCountryDAO">
        <property name="dataSource" ref="dataSource"/>
    </bean>
<!-- __________________________________________________________________________________________________ -->

    <bean id="authenticationManager" class="com.crimetrack.service.AuthenticationManager">
        <property name="loginDao" ref="loginDao" /> 
    </bean>    
    <bean id="loginDao" class="com.crimetrack.jdbc.JdbcLoginDAO">
        <property name="dataSource" ref="dataSource" />
    </bean>
<!-- __________________________________________________________________________________________________ -->  

    <bean id="divisionManager" class="com.crimetrack.service.DivisionManager">
        <property name="divisionDao" ref="divisionDao"/>
    </bean>    
    <bean id="divisionDao" class="com.crimetrack.jdbc.JdbcDivisionDAO">
        <property name="dataSource" ref="dataSource"/>
    </bean>

<!-- __________________________________________________________________________________________________ -->    

     <bean id="positionManager" class="com.crimetrack.service.PositionManager">
        <property name="positionDao" ref="positionDao"/>
    </bean>    
    <bean id="positionDao" class="com.crimetrack.jdbc.JdbcPositionDAO">
        <property name="dataSource" ref="dataSource" />
    </bean>    

<!-- __________________________________________________________________________________________________ -->    

    <bean id="genderManager" class="com.crimetrack.service.GenderManager">
        <property name="genderDao" ref="genderDao"/>
    </bean>

    <bean id="genderDao" class="com.crimetrack.jdbc.JdbcGenderDAO" >
        <property name="dataSource" ref="dataSource" />
    </bean>

<!-- __________________________________________________________________________________________________ --> 

    <bean id="officerRegistrationValidation" class="com.crimetrack.service.OfficerRegistrationValidation">

            <property name="validateUserNameManager" ref="validateUserNameManager"/>

    </bean>

    <bean id="validateUserNameManager" class="com.crimetrack.service.ValidateUserNameManager">
            <property name="officerDao" ref="officerDao"/>
    </bean>

    <bean id="officerDao" class="com.crimetrack.jdbc.JdbcOfficersDAO" >
            <property name="dataSource" ref="dataSource" />
    </bean>

<!-- __________________________________________________________________________________________________ --> 

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
            <property name="driverClassName" value="${jdbc.driverClassName}"/>
            <property name="url" value="${jdbc.url}"/>
            <property name="username" value="${jdbc.username}"/>
            <property name="password" value="${jdbc.password}"/>
    </bean>
<!-- __________________________________________________________________________________________________ -->    

    <bean id="propertyConfigurer" 
          class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>classpath:jdbc.properties</value>
            </list>
        </property>
    </bean>
<!-- __________________________________________________________________________________________________ -->    

    <bean id="transactionManager" 
          class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource"/>
    </bean>       

  </beans> 
```

**1\. Tab Out Of UserName 字段时的错误日志**

```
1882370 [http-8084-1] DEBUG org.springframework.web.bind.annotation.support.HandlerMethodInvoker  - Invoking request handler method: public java.lang.String com.crimetrack.web.OfficerRegistrationController.validateUserName(java.lang.String) throws java.lang.Exception
1882370 [http-8084-1] INFO  com.crimetrack.web.OfficerRegistrationController  - Inside OfficerRegistrationController
1882370 [http-8084-1] INFO  com.crimetrack.web.OfficerRegistrationController  - In try ..... catch for OfficerRegistrationController
1882370 [http-8084-1] INFO  com.crimetrack.service.ValidateUserNameManager  - Inside ValidateUserNameManager
1882370 [http-8084-1] INFO  com.crimetrack.service.ValidateUserNameManager  - ValidateUserNameManager - UserName is : admin
1882371 [http-8084-1] ERROR com.crimetrack.service.ValidateUserNameManager  - Message
java.lang.NullPointerException
    at com.crimetrack.service.ValidateUserNameManager.DoesUserNameExist(ValidateUserNameManager.java:26)
    at com.crimetrack.web.OfficerRegistrationController.validateUserName(OfficerRegistrationController.java:140)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:436)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:424)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Unknown Source)
1882371 [http-8084-1] INFO  com.crimetrack.service.ValidateUserNameManager  - ValidateUserNameManager - UserName :admin EXCEPTION OCCURED java.lang.NullPointerException 
```

**2.Form POST到Controller时的错误日志：**

```
1135560 [http-8084-1] DEBUG org.springframework.beans.TypeConverterDelegate  - Converting String to [class java.lang.String] using property editor [org.springframework.beans.propertyeditors.StringTrimmerEditor@1983ad7]
1135560 [http-8084-1] INFO  com.crimetrack.service.OfficerRegistrationValidation  - OfficerRegistrationValidation - UserName is not null so going to check if its valid for :admin
1135560 [http-8084-1] INFO  com.crimetrack.service.OfficerRegistrationValidation  - OfficerRegistrationValidation - Just before try.....catch block...userName is :admin
1135560 [http-8084-1] INFO  com.crimetrack.service.OfficerRegistrationValidation  - OfficerRegistrationValidation - about to evaluate if (validateUserNameManager.DoesUserNameExist(officer.getUserName()) == true)
1135560 [http-8084-1] INFO  com.crimetrack.service.OfficerRegistrationValidation  - OfficerRegistrationValidation - Error Occured When validating UserName
1135561 [http-8084-1] ERROR com.crimetrack.service.OfficerRegistrationValidation  - Message
java.lang.NullPointerException
    at com.crimetrack.service.OfficerRegistrationValidation.validate(OfficerRegistrationValidation.java:61)
    at org.springframework.validation.DataBinder.validate(DataBinder.java:725)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.doBind(HandlerMethodInvoker.java:815)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.resolveHandlerArguments(HandlerMethodInvoker.java:367)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:171)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:436)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:424)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T17:05:46.837

当您`new OfficerRegistrationValidation()`在控制器中执行 a 时，您`initBinder`会得到一个为空的实例`validateUserNameManager`，因此是 NPE。Spring 不会自动为您“填充”类字段，您需要提出要求。

**此外，您的控制器似乎将每个用户的内容存储在字段（类级别）上，但是如果两个用户要求相同的页面怎么办。**

我会建议这样的事情：

```
@Controller
public class OfficerRegistrationController {

    private final Logger logger = Logger.getLogger(getClass());

    @Autowire // tells spring to populates that for us.
    private DivisionManager divisionManager;

    @Autowire
    private PositionManager positionManager;

    @Autowire
    private GenderManager genderManager;

    @Autowire
    private OfficerRegistrationValidation officerRegistrationValidation;

    @InitBinder("officers")
    protected void initBinder(WebDataBinder binder){
        //removes white spaces 
        binder.registerCustomEditor(String.class, new StringTrimmerEditor(true));

        //formats date 
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");

        //By passing true this will convert empty strings to null
        binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, true));
        dateFormat.setLenient(false);

        logger.info("Just before initBinder");
        binder.setValidator(officerRegistrationValidation);
    }

    @RequestMapping(value="officer_registration.htm", method = RequestMethod.GET)
    public ModelAndView loadPage(HttpServletRequest request, HttpServletResponse response,@ModelAttribute Officers officer, BindingResult result, ModelMap m, Model model) throws Exception {
        // ... 
    }

    @RequestMapping(value="officer_registration.htm", method=RequestMethod.POST)
    public ModelAndView handleRequest(@Valid @ModelAttribute Officers officer, BindingResult result, ModelMap m, Model model) throws Exception{
        // ...
    }

    @RequestMapping(value="validateUserName.htm", method=RequestMethod.GET)
    public @ResponseBody String validateUserName(@RequestParam String userName) throws Exception{
        // ...
    }
}

@Component
public class OfficerRegistrationValidation implements Validator {

    private final Logger logger = Logger.getLogger(getClass());

    @Autowire
    ValidateUserNameManager validateUserNameManager;

    public boolean supports(Class<?> clazz) {
        return Officers.class.equals(clazz);
    }

    public void validate(Object target, Errors errors) {
        // ...
    }
}

@Service
public class ValidateUserNameManager implements ValidateUserNameIFace {

    private final Logger logger = Logger.getLogger(getClass());

    @Autowire
    private OfficersDAO officerDao;

    public boolean doesUserNameExist(String userName) throws Exception {
        // ...
    }
}

@Repository
public class OfficersDAO {
    // ...
} 
```

注意类上的`@Component`, `@Service`,`@Repository`这告诉 spring 在上下文启动时为这些类创建一个 bean（参见`<context:annotation-config/>`和`<context:component-scan base-package="..." />`文档）。 `@Autowire`告诉 spring 尝试将带注释的字段与一个现有的 bean 匹配（使用它的类型）。

整个想法是有三层：控制器、服务和 daos；

*   控制器使用服务
*   服务使用 daos。

我也建议阅读一些好书:)：

*   [当前的 MVC 文档](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html)
*   [国际奥委会文件](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html)

# scala - Scala：简单的 HelloWorld 在编译为 Java 类后不运行

> ID：12643948
> 
> 赞同：1
> 
> 时间：2012-09-28T16:33:41.813
> 
> 标签：scala

代码：

```
object HelloWorld{
    def main(args: Array[String]){
        println("Hello, world!")
    }
} 
```

环境变量：

在窗户上：

```
JAVA_HOME = C:\Program Files\Java\jdk1.7.0_07
CLASSPATH = .;C:\Program Files\Java\jdk1.7.0_07\lib;C:\Software\scala-2.9.2\lib
PATH = %PATH%;C:\Program Files\Java\jdk1.7.0_07\bin;C:\Software\scala-2.9.2\bin
SCALA_HOME = C:\Software\scala-2.9.2 
```

脚步：

```
scala HelloWorld.scala  //Correctly output Hello,world!
scalac HelloWorld.scala //No Compilation error
java HelloWorld  //Errors shown below 
```

错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: scala/ScalaObject
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(Unknown Source)
        at java.security.SecureClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.access$100(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at HelloWorld.main(HelloWorld.scala)
Caused by: java.lang.ClassNotFoundException: scala.ScalaObject
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        ... 13 more 
```

很抱歉这个菜鸟问题，但我已经尝试了很长时间，但无法让它发挥作用。

试图`scala -save`jar文件并运行`java -jar`；还尝试更改类路径，例如添加`scala-library.jar`，但仍然无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:40:28.960

这对我有用（Linux）：

```
java -cp scala-library-2.9.1.jar:. HelloWorld 
```

[`scala-library-2.9.1.jar`可以在这里找到](http://central.maven.org/maven2/org/scala-lang/scala-library/2.9.1/scala-library-2.9.1.jar)。

在 Windows 上，您必须使用分号作为 CLASSPATH 分隔符：

```
java -cp scala-library-2.9.1.jar;. HelloWorld 
```

基本上，您需要在代码中添加`scala-library-*.jar`JAR*和* `.class`文件。在上面的例子中只是`.`用来表示`.class`当前目录中的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T15:26:10.840

> 如果有数百个，那就太痛苦了:(

不是，您只需将它们放在您的#JRE#/lib/ext 目录中即可

# hadoop - 如何使用命令行选项控制 Hadoop 任务重试策略？

> ID：12643950
> 
> 赞同：2
> 
> 时间：2012-09-28T16:33:48.633
> 
> 标签：hadoop, sqoop

我想使用命令行选项控制 Hadoop 作业重试策略。例如，我想编写以下 Sqoop 作业并让它对 MySQL 中断具有容错能力：

```
sqoop
  GENERIC_SQOOP_OPTIONS
  -Dmap.retry.exponentialBackOff=TRUE
  -Dmap.retry.numRetries=10 
```

对于一般的 Hadoop 作业，它可能看起来像：

```
hadoop job -submit
  GENERIC_JOB_OPTIONS
  -Dmap.retry.exponentialBackOff=TRUE
  -Dmap.retry.numRetries=10 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:34:30.763

是的，Sqoop 支持 hadoop "-D" 参数。然而，它们在命令行上的位置至关重要。它们必须直接出现在“sqoop”之后和任何其他 Sqoop 参数之前：

```
sqoop -Dmap.retry.exponentialBackOff=TRUE -Dmap.retry.numRetries=10 import --connect ... 
```

请注意，不同的定位不会按预期工作。

# ios - iOS - 在 UITableViewCell 中取消突出显示 UIBarButtons？

> ID：12643952
> 
> 赞同：0
> 
> 时间：2012-09-28T16:34:00.770
> 
> 标签：ios, uitableview, uibarbuttonitem, uitoolbar

我有一个包含 2 个 UIBArButton 项的 UIToolbar。工具栏位于 UITableViewCell 内，当用户选择一个单元格时它会淡入。问题是，当单元格突出显示时，它也会在 barButtonItems 上调用突出显示，并且它们会保持突出显示，直到用户手动点击按钮一次，然后它会返回标准突出显示。

有没有办法手动取消突出显示 UIBarButtonItems？

我尝试了覆盖单元格`setSelected:`和`setHighlighted`方法，并尝试同时调用子视图`setSelected:`和`setHighlighted`子视图，如下所示，它似乎不起作用。在 1 个 UIToolbarBackground 和 2 个 UIToolbarTextButtons 上调用突出显示。有任何想法吗？

```
@implementation CustomCell

// I also tried doing this in setHighlighted: & setHighlighted:animated
- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
   [super setSelected:selected animated:animated];

   for (UIView *view in self.toolbar.subviews)
   {
      if ([view respondsToSelector:@selector(setHighLighted:)])
      {
         [view performSelector:@selector(setHighLighted:) withObject:[NSNumber numberWithBool:NO]];
      }  
   }
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:30:37.660

您正在询问工具栏的子视图是否响应选择器`setHighLighted:`，但所有实现此类功能的 UIKit 类都会响应`setHighlighted:`（注意小写的“l”）。这里有一个想法供您尝试，我希望它有效！

```
- (void)setHighlighted:(BOOL)highlighted
{
    [super setHighlighted:highlighted];

    for (UIView *view in self.toolbar.subviews)
    {
        if ([view respondesToSelector:@selector(setHighlighted:)])
        {
            ((UIControl *)view).highlighted = highlighted;
        }
    }
} 
```

我改变了几件事 - 只有`setHighlighted:`在动画方法应该在适当的时间调用它时才被覆盖。还摆脱了 performSelector: 以支持强制转换为`UIControl`. 不是 100% 正确，但应该让我们编译。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T18:22:31.323

终于让它工作了：

类别：

```
@implementation UIToolbar (Additions)

- (void)setHighlighted:(BOOL)highlighted
{
    for (UIView *view in self.subviews)
    {
        for (UIView *subview in view.subviews)
        {
            if ([subview isKindOfClass:[UIButton class]])
            {
                ((UIButton *)subview).highlighted = highlighted;
            }
        }
    }
}

@end 
```

细胞：

```
- (void)setSelected: (BOOL)selected animated: (BOOL)animated
{
    [super setSelected:selected animated:animated];

    [self.toolbar setHighlighted:NO];
} 
```

# objective-c - 如何替换 NSString 中的 \xA0 字符

> ID：12643955
> 
> 赞同：0
> 
> 时间：2012-09-28T16:34:04.190
> 
> 标签：objective-c, cocoa, unicode, nsstring

以下代码不起作用：

```
NSString *importText = [textView.string stringByReplacingOccurrencesOfString:@"\xA0\xA0"
 withString:@" "]; 
```

编译器声称：“输入转换因输入字节不属于输入代码集 UTF8 而停止”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T18:50:38.423

试试 Unicode 转义序列`\u00a0`。

# javascript - Internet Explorer 10 忽略 XMLHttpRequest 'xhr.withCredentials = true'

> ID：12643960
> 
> 赞同：21
> 
> 时间：2012-09-28T16:34:27.410
> 
> 标签：javascript, ajax, internet-explorer, cors

我目前在使用 IE10 进行跨域 ajax 调用时遇到问题（在 IE10 模式下，不兼容）。

情况：我有两个域，`http://a`并且`http://b`. 我有一个 cookie 集`http://b`。我目前在页面上`http://a`。

我想做一个`http://b`使用 XMLHttpRequest 的 CORS 请求（根据[http://blogs.msdn.com/b/ie/archive/2012/02/09/cors-for-xhr-in-ie10.aspx](http://blogs.msdn.com/b/ie/archive/2012/02/09/cors-for-xhr-in-ie10.aspx) ，它应该可以工作)，并在请求中包含 cookie。JS如下：

```
var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://b', true);
xhr.withCredentials = true;
xhr.send(); 
```

这应该确保 cookie 附加到请求中；但是，Fiddler 跟踪显示没有附加 cookie，我得到`401: Access Denied`.

服务器配置为使用 CORS，它包括 Access-Control 标头：

```
Access-Control-Allow-Origin: http://a
Access-Control-Allow-Credentials: true 
```

（这应该没有任何区别，因为没有 OPTIONS 预检请求，并且 IE 发送的第一个请求是 GET，并且 cookie 不存在，因此导致 401）。

此外，JS 片段在 Firefox 和 Opera 中都可以正常工作。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-26T14:02:29.093

这可能是相同的旧 IE P3P 问题。使用 IE 的默认设置，如果设置的 cookie 没有 P3P 标头也出现在响应中，则 cookie 被标记为“仅限第一方”。这意味着在第三方上下文中，例如 iframe 或 CORS 请求，IE 将拒绝发送 cookie。

要修复它，您需要在设置 cookie 时提供 P3P 标头。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms537343%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms537343%28v=vs.85%29.aspx)。

更新：链接现已失效，但您可以在[Internet 档案中看到它](https://web.archive.org/web/20130308142134/http://msdn.microsoft.com/en-us/library/ms537343%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-02-04T14:05:46.193

我们添加了一个标头 Vary : cookie 并且它起作用了..

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-19T13:13:56.013

我遇到了类似的问题，结果是浏览器设置阻止了第三方 Cookie（IE10 > Internet 选项 > 隐私 > 高级 > 第三方 Cookie > 接受）。为了解决这个问题，我检查了“覆盖自动 cookie 处理”、​​“接受”（第三方 Cookie）和“始终允许会话 cookie”。

# joomla - Virtuemart Checkout 页面显示其他人的产品

> ID：12643968
> 
> 赞同：0
> 
> 时间：2012-09-28T16:35:14.140
> 
> 标签：joomla, checkout, virtuemart, shopping

我将 Joomla + Virtuemart 用于我的（即将成为）网上商店。

我现在正在测试，我注意到一个烦人的错误：每次我将产品添加到购物车（在我的 PC 上），然后转到另一台 PC 或智能手机检查页面和购物车时，它都会显示产品那里也有。。

我想尽快推出网站，我认为这是一个非常严重的问题。

我错过了什么？我做错了什么？

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T21:34:02.950

就我而言，问题在于 jotcache 插件。禁用插件恢复了正常行为。

# python - 可以直接使用 Nose Xunit 类输出 Junit XML 吗？

> ID：12643971
> 
> 赞同：3
> 
> 时间：2012-09-28T16:35:21.333
> 
> 标签：python, nose, xunit

我们有一堆我想集成到 Jenkins 中的系统测试。结果，我想我可能会尝试并聪明一点，并使用 Nose 的 Xunit 插件来生成结果文件。我的代码如下所示：

```
 from optparse import OptionParser
from subprocess import call

from nose.plugins.xunit import Xunit as xunit
from nose.config import Config

if __name__ == "__main__":
    p = OptionParser(usage="A simple wrapper for creating JUnit XML")
    p.add_option("-v", "--verbose",
                 action="store_true", dest="verbose", default=False,
                 help="generate extra information")

    # hook in xunit plugin options
    x = xunit()
    x.add_options(p)

    (options, args) = p.parse_args()
    x.configure(options, Config())
    for test in args:
        test_args = test.split(" ")
        test_name = test_args[0]
        if options.verbose: print "running: %s" % (test_name)

        x.startTest(test_name)
        result = call(test_args, shell=True)
        if result == 0:
            x.addSuccess(test_name)
        else:
            x.addFailure(test_name, None)

    x.report() 
```

但是，当我运行时，我遇到了失败：

```
17:24 ajb@sloy/x86_64 [perf_test.git] >./junitify.py -v "/bin/true" "/bin/false"
运行：/bin/true
回溯（最近一次通话最后）：
  文件“./junitify.py”，第 39 行，在
    x.addSuccess(test_name)
  addSuccess 中的文件“/usr/lib/python2.7/dist-packages/nose/plugins/xunit.py”，第 239 行
    self.stats['passes'] += 1
AttributeError: 'Xunit' 对象没有属性 'stats'

```

从查看 xunit 的代码来看，这是因为 self.enabled 没有设置。但是，是否可以以这种方式使用 Xunit 库并不完全清楚。我正在尝试做的事情可能吗？这只是误解了这个库应该如何初始化吗？我应该只使用不同的 python 库来生成输出吗？

这将是一种耻辱，因为我们确实使用鼻子在 Jenkins 下对我们的一大块 python 代码运行 doctest 单元测试。

# jquery - 使 jquery 选项卡更具响应性

> ID：12643972
> 
> 赞同：0
> 
> 时间：2012-09-28T16:35:27.160
> 
> 标签：jquery, jquery-ui

我已经实现了 jQueury UI 选项卡。

如果您过快地移过它们，则鼠标当前所在的选项卡不会激活。

我在下面做了一个 jsFiddle 来证明这一点。由于同时运行的 Javascript 的数量，该问题在网站上更加突出。有没有办法在不自定义 jQuery-UI 代码的情况下根据不同的事件激活当前选项卡？

它是 CDN 和更大框架的一部分。

[**小提琴**](http://jsfiddle.net/ariestattoo/pQqbr/5/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:38:16.513

将持续时间从字符串 ('fast') 更改为表示所需延迟的整数。整数值表示转换应该花费的毫秒数。

**[jsFiddle 示例](http://jsfiddle.net/j08691/pQqbr/10/)**

```
$(".tabs").tabs({
    event: "mouseover",
    fx: {
        opacity: 'toggle',
        duration: 1
    }
}); 
```

从文档：

> 持续时间选项可以是表示三种预定义速度（“慢”、“正常”、“快”）之一的字符串，也可以是运行动画的持续时间（以毫秒为单位）（默认为“正常”）。

# java - JAVA使用三元运算符调用方法

> ID：12643973
> 
> 赞同：17
> 
> 时间：2012-09-28T16:35:28.030
> 
> 标签：java, ternary

我正在尝试使用？决定我想调用哪个方法，但我不需要分配变量。我的问题：有没有办法在不分配变量的情况下使用三元运算符？

```
(something i dont need) = (x == 1)? doThisMethod():doThatMethod() 
```

代替

```
if(x == 1) {
    doThisMethod()
} else {
    doThatMethod()
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-28T16:40:10.337

这不起作用，因为它不是三元运算符的预期用途。

如果你真的希望它是 1 行，你可以写：

```
if (x==1) doThisMethod(); else doThatMethod(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-28T16:43:41.987

我怀疑这是否有效。[JLS §15.25](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.25)定义三元表达式如下：

```
ConditionalExpression:
    ConditionalOrExpression
    ConditionalOrExpression ? Expression : ConditionalExpression 
```

a本身`ConditionalExpression`并不是 a [`Statement`](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.5)。但是，它可以在其他各种地方使用，例如[`Assignment`](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.26)：

```
AssignmentExpression:
    ConditionalExpression
    Assignment

Assignment:
    LeftHandSide AssignmentOperator AssignmentExpression 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:46:05.473

根据[*Java 语言规范*](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.8)[的第 14.8 节“表达式语句”](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.8)*，唯一可以单独用作语句的表达式是：*

 **   作业
*   前增量和后增量以及前减量和后减量
*   方法调用
*   类实例创建表达式（构造函数调用）

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2016-01-08T06:10:37.543

更加多样化，如果在方法调用之后流程中断。可以使用this，但请注意，如果流程在 if 之后没有中断，那么这两个方法都将被执行。

```
if (x==1) 
doThisMethod();
doThatMethod(); 
```*

# php - 当我转到其他页面时，预加载的图像是否保留在浏览器中？

> ID：12643974
> 
> 赞同：1
> 
> 时间：2012-09-28T16:35:35.810
> 
> 标签：php, javascript, image, preloading

我正在用 javascript 制作图像数组来预加载图像。代码如下所示。

```
imageArr[0]=new Image();        
imageArr[0].src='mypath/myimgname.jpg'; 
imageArr[1]=new Image();        
imageArr[1].src='mypath/myimgname.jpg'; 
imageArr[2]=new Image();        
imageArr[2].src='mypath/myimgname.jpg'; 
```

然后我在需要时在可能的代码中使用这个元素。我在每一页的开头声明了这个数组。我们每页都需要这种 150 张大尺寸图像。

所以我的问题是，当我在每一页上写这段代码时。它会在每个页面上一次又一次地加载图像吗？或者它只会在浏览器中加载图像一次。之后，当我在第二页上再次写这个数组时。那么它只是在浏览器中使用它。还是一次又一次地从服务器获取图像？

如果这种方法是错误的，那么正确的方法应该是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:41:56.880

图像（jpg）保留在浏览器的缓存中，但是当您更改页面时，imageArr 不在 Javascript 范围内（如果，正如我想象的那样，您在全局上下文中定义了该数组）所以您需要每次都重新初始化它。我认为您的方法没有任何问题，但我不知道您想要获得什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T16:44:06.870

如果您使用的是 jquery，那么我建议您使用[waitforimages 插件](https://github.com/alexanderdickson/waitForImages)。

不过，你的做法没有错，比较简单，而且图片还是从缓存中取的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:56:51.167

PHP 可以向浏览器发送标头来告诉它缓存内容。看这里：

*   [强制浏览器缓存图像](https://stackoverflow.com/questions/6214965/force-browser-to-cache-images)
*   [如何让浏览器缓存图像，用php？](https://stackoverflow.com/questions/1385964/how-to-get-the-browser-to-cache-images-with-php)

如果您不发送标头，浏览器可能会也可能不会缓存图像，并且所有浏览器的工作方式不会完全相同。如果您确实发送了标头，则无法保证浏览器无论如何都会缓存。浏览器可能会因为各种原因忽略缓存请求，例如用户处于隐私浏览模式。

让我们假设您确实可以在所有浏览器中使用缓存。好吧，一个包含 150 个大图像的页面看起来和性能都很差，没有多少缓存会阻止第一次加载变慢。

您是否考虑过不同的方法？例如显示单个大图像和一组缩略图，如果选择缩略图则换出大图像。这意味着第一个页面视图没有巨大的负载，也不需要任何特殊的修复，比如冗长的缓存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T18:55:44.740

Dena...我一直使用这种方法来预先缓存我的图像，我一直发现它相当有效。创建 Image Obj 并为其分配 Image`src`后，该图像将永久保存在您的缓存中，或者直到您决定将其清除。Array 充当所有图像的容器，并允许您在需要时将图像分配给元素。

一种选择是您可以在“索引/默认”脚本中创建一个数组并创建您需要的所有图像，但这会导致提到的问题 obe6。当您离开页面时，该数组将不再存在（尽管图像仍将被缓存）。如果您想在每个页面上都有一个可用的数组，那么您可以为每个页面创建一个新数组并加载特定于该页面的图像。这是我采用的方法，它看起来更有条理，而且还可以增加加载时间。

正如我上面提到的，每个页面都有一个单独的数组允许您将图像分配给数组中的一个元素。例如，我将使用您的代码：

脚本：

```
var imageArr = new Array();

imageArr[0]=new Image();        
imageArr[0].src='mypath/myimgname.jpg'; 
imageArr[1]=new Image();        
imageArr[1].src='mypath/myimgname.jpg'; 
imageArr[2]=new Image();        
imageArr[2].src='mypath/myimgname.jpg';

var testImage01 = document.getElementById("testImage01");
testImage01.src = imageArr[0].src; 
```

HTML：

```
<table>
    <tr>
        <td>
            <img id="testImage01" src="" alt="Test Image" />
        </td>
    </tr>
</table> 
```

请记住运行 JS `onload`，否则该`img`元素将不可用。您的示例代码中没有任何 jQuery，但`$(document).ready()`如果有，您可以使用。

希望这对您有所帮助，并让您对使用此方法有更好的了解。

# c# - 如何在 Metro 风格应用程序中将值从一个 xaml 页面传递到另一个页面

> ID：12643976
> 
> 赞同：6
> 
> 时间：2012-09-28T16:35:43.153
> 
> 标签：c#, xaml, windows-8, microsoft-metro, winrt-xaml

我有两个 XAML 页面：Menu.xaml 和 Main.xaml。

在 Menu.xaml 上，我有 2 个按钮（简单和困难），当我单击按钮时，我导航到 Main.xaml。

当我单击“简单”或“困难”时，我想传递一些值，以便我可以适当地填充 Main.xaml。

1\. 如何在 C# 中传递值/参数？
2\. 我在哪里检索这些值（例如在 PageLoad 上？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:58:11.467

看看`Frame.Navigate`方法。有一个重载可以让你传入一个参数。

[请参阅此示例](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh771188.aspx)

通常这看起来像这样：

```
private void OnButtonClick(object sender, EventArgs args)
{
    if (sender == easyButton)
      NavigateToDifficulty(DifficultyLevel.Easy);
    else
      NavigateToDifficulty(DifficultyLevel.Hard);
}

private void NavigateToDifficulty(DifficultyLevel difficulty)
{
   this.Frame.Navigate(typeof(DifficultyPage), difficulty)
} 
```

要检索导航参数，请查看`LayoutAwarePage`（包含在示例模板中）`LoadState`方法

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T17:15:20.867

Metro App 中的导航非常简单。

C# 示例：

将此添加到您的点击或任何其他将您带到主页的事件中。

```
this.Frame.Navigate(typeof(Main),myDifficulty); 
```

然后在您要导航到的页面上，您可以在其 OnNavigatedTo 事件中获取参数。

```
protected override void OnNavigatedTo(NavigationEventArgs e) 
{ 
    var myDifficulty= e.Parameter; 
    ...    
} 
```

# c# - C# WinForms ComboBox - 仅从对象中选择值

> ID：12643979
> 
> 赞同：2
> 
> 时间：2012-09-28T16:35:56.270
> 
> 标签：c#, winforms, combobox

我只需要一点确认...

我正在像这样填充我的组合框：

```
myCombo.Items.Add(new ComboBoxInt32Data("Red", 0));
myCombo.Items.Add(new ComboBoxInt32Data("Green", 1));
myCombo.Items.Add(new ComboBoxInt32Data("Yellow", 2));
myCombo.Items.Add(new ComboBoxInt32Data("Blue", 3)); 
```

现在，当我从数据库表中检索值时，我只有整数值。

我覆盖的 Equals 看起来与 msdn 的[建议](http://msdn.microsoft.com/en-us/library/ms173147%28v=vs.80%29.aspx "建议")完全相同：

```
public override bool Equals(object obj)
{
    if (obj == null)
    {
        return false;
    }

    ComboBoxInt32Data data = obj as ComboBoxInt32Data;
    if ((object)data == null)
    {
        return false;
    }

    return (m_Name.ToUpper() == data.Name.ToUpper() && m_Value == data.Value);
} 
```

但是，正如我所提到的，我只有价值。我不想去做以下事情：

```
Int32 DatabaseValue = SomeFunctionThatRetrivedMeThisIntValueFromDB();
string TheValueName = SomeFunctionThatDoesALookUpToGetTheName(DatabaseValue);
myCombo.SelectedIndex = myCombo.Items.IndexOf(new ComboBoxInt32Data(TheValueName, DatabaseValue)); 
```

我宁愿只做以下事情：

```
myCombo.SelectedIndex = myCombo.Items.IndexOf(SomeFunctionThatRetrivedMeThisIntValueFromDB()); 
```

所以，我的确认是，在我的 Equals 中执行以下操作是否可以（如，这是一个可接受的最佳实践）（查找“添加这个”）：

```
public override bool Equals(object obj)
{
    if (obj == null)
    {
        return false;
    }

    // added this
    if (obj is Int32)
    {
        Int32 value = (Int32)obj;
        return m_Value == value;
    }

    ComboBoxInt32Data data = obj as ComboBoxInt32Data;
    if ((object)data == null)
    {
        return false;
    }

    return (m_Name.ToUpper() == data.Name.ToUpper() && m_Value == data.Value);
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:42:24.173

您不需要覆盖`Equal`and `GetHashCode`，简单的方法是*强制转换*并使用 LINQ来`ComboBoxInt32Data`选择项目：

```
myCombo.SelectedItem =  myCombo.Items.Cast<ComboBoxInt32Data>()
                          .SingleOrDefault(item => item.Value == databaseValue); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T16:44:34.303

我不确定我是否只是误解了您的需求，或者我是否真的看到了我认为我看到的东西，但我认为我可以大大简化您的解决方案。让我们举一个非常简单的例子 - 我有一个名为的表`FooTypes`，它包含如下数据：

```
Id        Name                Order
-----------------------------------
1         Type 1              1
2         Type 2              2
3         Type 3              4
4         Type 4              3 
```

现在我想用该数据加载一个组合框，所以我要做这样的事情**：

```
var conn = new SqlConnection("some connection string");
var da = new SqlDataAdapter("SELECT Id, Name FROM FooTypes ORDER BY Order", conn);
var dt = new DataTable();

da.Fill(dt);

comboBox.ValueMember = "Id";
comboBox.DisplayMember = "Name";
comboBox.DataSource = dt;

comboBox.SelectedValue = SomeFunctionThatRetrivedMeThisIntValueFromDB(); 
```

** 请记住，这是一个示例，因此您可以从其他地方获取连接和内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T16:44:23.260

尝试以下操作：

```
var indexToSelect = SomeFunctionThatRetrievedMeThisIntValueFromDB();
var selectedItem = myCombo.Items
    .Cast<ComboBoxInt32Data>()
    .FirstOrDefault(item => item.Value == indexToSelect);
if (selectedItem != null)
{
    myCombo.SelectedItem = selectedItem;
} 
```

# ruby-on-rails - Ruby Money gem 的最佳 rounding_method 是什么？

> ID：12643988
> 
> 赞同：2
> 
> 时间：2012-09-28T16:36:27.090
> 
> 标签：ruby-on-rails, ruby, currency

我们正在使用 Ruby 的 Money gem。在我们的应用程序中，我们也在货币之间进行转换。

因此，当您在货币之间进行转换时，就会出现四舍五入的问题。目前我们正在使用 Ruby 的内置[`Float#round`](http://www.ruby-doc.org/core-1.9.3/Float.html#method-i-round).

然而，这引入了“悬空一分钱”的问题。

```
Money.new(500,'USD').exchange_to('EUR')
#=> #Money cents:385 currency:EUR

Money.new(500,'USD').exchange_to('EUR').exchange_to('USD')
#=> #Money cents:501 currency:USD 
```

所以 5.00 美元在转换为欧元后变为 5.01 美元，然后再返回！这些是我们使用的汇率：

```
{
  "GBP_TO_USD"=>1.6,
  "USD_TO_GBP"=>0.625,
  "GBP_TO_EUR"=>1.2,
  "EUR_TO_GBP"=>0.8333333333333334,
  "EUR_TO_USD"=>1.3,
  "USD_TO_EUR"=>0.7692307692307692
} 
```

是否有可能有一种舍入方法来避免额外或丢失一分钱的问题？这种四舍五入的方法是什么？

或者这是一个数学上无法解决的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:40:50.803

一旦对数字进行四舍五入，信息就会丢失。解决您的问题的最佳方法是停止四舍五入（无论如何您都不应该用钱来做），并且仅在您在某处显示值时才四舍五入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-02T12:07:33.150

最新的 Ruby Money gem 支持小数美分。这将确保当货币对象转换为另一种货币并返回其自身时，其价值将被保留。所以没有遗漏/多余的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-22T05:31:26.663

在现实世界中，这可能不是一个问题，因为“从”和“到”的汇率不会彼此相反。

另一方面，您需要来回转换的场景是什么？我能想到的唯一场景是您正在总结一堆不同货币的 Money 对象：

[1 美元、2 欧元、3 美元]

这将触发从美元到欧元再回到美元的货币兑换。如果是这种情况，请尝试[https://github.com/lulalala/money-collection](https://github.com/lulalala/money-collection)在汇总许多 Money 对象时跳过不必要的货币兑换。

# c++ - 如何使用 Qt QImage 和 QBrush 渲染自定义背景？

> ID：12643997
> 
> 赞同：0
> 
> 时间：2012-09-28T16:36:53.007
> 
> 标签：c++, qt

我正在尝试使用 QImage 为 QT 渲染自定义图像，但到目前为止我的代码没有任何进展。我不想从文件中加载图像，我想使用 QImage 类和 QBrush 类以及这需要什么。我不擅长在 API 中进行渲染，但我将不胜感激。

这是我得到的。我真正得到的唯一东西是图像'm_pImage'对象......

```
m_pImage = new QImage(ImageWidth, ImageHeight, QImage::Format_Indexed8);
m_pImage->setColorCount(255); 
```

另外，我尝试添加一些类似的东西，但这部分不起作用：

```
QBrush* br = new QBrush(Qt::gray, Qt::Dense3Pattern);
br->setTextureImage(*m_pImage);
QPainter* paint = new QPainter(m_pImage);
paint->setPen(Qt::NoPen);
paint->setBrush(*br);
paint->drawRect(0, 0, ImageWidth, ImageHeight);
for(int i = 0; i < m_ulImageWidth; i++)
{
    for(int j = 0; j < ImageHeight; j++)
    {
        m_pImage->setPixel(i, j, qRgb(255, 255, 255));
    }
} 
```

设置背景图像会更好，但在这两种情况下，仅让此图像呈现画笔样式 Dense3Pattern 将是最好的。

这是我一直在使用[QT Reference的文档的链接](http://doc.qt.digia.com/4.7/qimage.html)

提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T17:57:54.260

呃，我现在看到了我的问题。

所以我需要将我想要使用的所有颜色添加到我的 colorTable 中。在我这样做之后，我能够开始使用 QImage::setPixel(...) 进行绘图。

```
for(int i = 0; i < 255; i++)
{
    m_pImage->setColor(i, qRgb(i, i, i));
} 
```

我想这就是它的全部！

# android - Android：我在 layout/custom.xml 中构建了自定义视图 如何知道它的包名

> ID：12643998
> 
> 赞同：0
> 
> 时间：2012-09-28T16:37:02.037
> 
> 标签：android, android-layout

我有 main.xml 和 custom.xml

我希望 custom.xml 像用户控件一样，所以我将 2 个这些标签放入 mail.xml 中，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:background="#FFFFFF" >

     <custom
         xmlns:android="http://schemas.android.com/apk/res/android"
         android:layout_height="wrap_content"
         android:layout_width="fill_parent" />

     <custom
         xmlns:android="http://schemas.android.com/apk/res/android"
         android:layout_height="wrap_content"
         android:layout_width="fill_parent" />

</LinearLayout> 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:41:11.680

请尝试使用包含标签。

```
<include layout="@layout/custom"
    android:id="@+id/custom1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" /> 
```