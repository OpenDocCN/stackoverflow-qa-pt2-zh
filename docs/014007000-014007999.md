# StackOverflow 问答 14007000-14007999

# mysql - 使用来自另一个表的信息更新表并进行修改

> ID：14007003
> 
> 赞同：1
> 
> 时间：2012-12-22T22:13:27.420
> 
> 标签：mysql

我想将数据（经过修改）从一个表移动到另一个表。

```
UPDATE table2 
SET val_new=(SELECT (table1.val_old - SUM(table3.val_2)) as some1 
FROM table3 
INNER JOIN table1 ON table3.id_some=.table1.id_some 
WHERE table3.id_typ<=2 
AND table3.id_status=1 
group by table3.id_some); 
```

我有错误：

```
Error Code: 1242\. Subquery returns more than 1 row 
```

我必须做什么来纠正这个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T22:20:40.537

最简单的修复方法是：

```
UPDATE table2 SET 
val_new=ifnull((
     SELECT (table1.val_old - SUM(table3.val_2)) as some1 
     FROM table3 
     INNER JOIN table1 ON table3.id_some=.table1.id_some 
     WHERE table3.id_typ<=2 
     AND table3.id_status=1 
     WHERE table3.table2_id = table2.id -- ADDED THIS LINE
     group by table3.id_some), val_new); 
```

# json - 用 MOXy 替换 CXF 的 JSONProvider（基于 Jettison）的最佳方法是什么？

> ID：14007006
> 
> 赞同：1
> 
> 时间：2012-12-22T22:14:33.003
> 
> 标签：json, cxf, eclipselink, moxy, jettison

我想知道为什么 MOXy 不提供类似于 JACKSON 的 JSONProvider 类来替换 jax-rs 实现中的默认 JSON 提供程序？

这将是处理某个包中所有类的最简单方法。我最终做的是执行以下操作，因为我觉得自定义上下文解析器或 MessageBodyWriter/Reader 最适合处理某些类，但不适用于处理包中的所有类，特别是如果你有很多类。

我对吗？你怎么认为？在 CXF 中用 MOXy 替换 Jettison 以处理包中所有类的最佳方法是什么？

```
import java.io.IOException;
import java.io.OutputStream;
import java.lang.annotation.Annotation;
import java.lang.reflect.Type;

import javax.ws.rs.WebApplicationException;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.MultivaluedMap;
import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Marshaller;

import org.apache.cxf.jaxrs.provider.json.JSONProvider;
import org.eclipse.persistence.jaxb.MarshallerProperties;
import org.eclipse.persistence.jaxb.JAXBContextFactory;

public class MyJSONProvider<T> extends JSONProvider<T> {
    private static JAXBContext jaxbContext = null;
    static {
        try {
            jaxbContext = JAXBContextFactory.createContext("com.bp.bs", null);
        } catch (JAXBException jaxbe) {
            jaxbe.printStackTrace();
            throw new ExceptionInInitializerError(jaxbe);
        }
    }

    @Override
    public void writeTo(T obj, Class<?> cls, Type genericType,
            Annotation[] anns, MediaType m,
            MultivaluedMap<String, Object> headers, OutputStream os)
            throws IOException, WebApplicationException {
        Marshaller marshaller = null;
        try {
            marshaller = jaxbContext.createMarshaller();
            marshaller.setProperty(MarshallerProperties.MEDIA_TYPE,
                    "application/json");
            marshaller.setProperty(MarshallerProperties.JSON_INCLUDE_ROOT, false);
            marshaller.marshal(obj, os);
        } catch (JAXBException jaxbe) {
            jaxbe.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T13:30:37.853

[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)提供了`org.eclipse.persistence.jaxb.rs.MOXyJsonProvider`可用于将其作为 JSON 提供程序启用的类。

下面是一个 JAX-RS 应用程序类的示例，它配置`MOXyJsonProvider`.

```
package org.example;

import java.util.*;
import javax.ws.rs.core.Application;
import org.eclipse.persistence.jaxb.rs.MOXyJsonProvider;

public class CustomerApplication  extends Application {

    @Override
    public Set<Class<?>> getClasses() {
        HashSet<Class<?>> set = new HashSet<Class<?>>(2);
        set.add(MOXyJsonProvider.class);
        set.add(CustomerService.class);
        return set;
    }

} 
```

`MOXyJsonProvider`在 EclipseLink 2.4.0 中添加。最新版本是 EclipseLink 2.4.1，可以从以下链接下载：

*   [http://www.eclipse.org/eclipselink/downloads/](http://www.eclipse.org/eclipselink/downloads/)

**了解更多信息**

*   [http://blog.bdoughan.com/2012/05/moxy-as-your-jax-rs-json-provider.html](http://blog.bdoughan.com/2012/05/moxy-as-your-jax-rs-json-provider.html)

# objective-c - 确定哪个 UIViewController 先运行

> ID：14007009
> 
> 赞同：-1
> 
> 时间：2012-12-22T22:14:52.843
> 
> 标签：objective-c, ios, delegates, viewcontroller

我开始学习objective-c和ios编程。我有两个视图控制器，分别名为MainViewController和GameViewController，我的项目中还有两个xib文件。我将xib文件与ViewController的连接起来。总而言之，这是我的文件：

视图控制器，

```
 AppDelegate.h
    AppDelegate.m
    MainViewController.h
    MainViewController.m
    GameViewController.h
    GameViewController.m 
```

和xib，

```
 Main.xib
    Game.xib 
```

我在项目选项中选择 Main.xib 作为主界面。我试图理解下面的问题，当我首先运行这个应用程序时 main.m 运行。没关系。

之后 AppDelegate 类是否运行？xcode 如何确定哪个 View Controller 将首先运行？

当我运行这个项目时，只有黑屏。任何人都可以帮助我了解ios应用程序的运行顺序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:21:10.943

Xcode 不会确定任何内容，之后设置 UI 完全取决于您

```
-application:didFinishLaunchingWithOptions:launchOptions 
```

由系统调用。下面是一个`ExampleViewController`先初始化的例子：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    self.viewController = [[ExampleViewController alloc] initWithNibName:@"ExampleViewController" bundle:nil];
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

应用程序初始化流程是：

```
main() -> AppDelegate (or whatever class has been designated the delegate) -> initial view controller 
```

# node.js - 使用 express 和主干正确管理会话

> ID：14007020
> 
> 赞同：2
> 
> 时间：2012-12-22T22:16:18.867
> 
> 标签：node.js, session, backbone.js, express

我想使用 express.js 中的会话，我知道我们可以从 req.session.id 中获取会话 id，而且我也知道这个 id 总是不同的（每次我们访问路由时）：

我看到有些人建议在全局中获取和保存会话，但问题是（除非我错了），如果我在用户以这种方式连接我的应用程序时保存会话：

```
app.get('/init', function(req, res) {                                                                                                                                    
        global.session = req.session;                                                                                                                                                                                                                                                        
    }); 
```

如果 User_1 连接我的应用程序，那么 User_2 连接我的应用程序并且 User_1 仍然存在，那么 global.session 将包含 User_2 会话的值，即使对于 User_1 也是如此，对吗？

如果我是对的，如何正确保存会话？我考虑了一个由 init 路由中的 req.session.id 索引的数组，但由于即使同一个用户访问相同的路由（这是正常的吗？），这总是不同的，所以不可能像这样处理。

您发现管理会话的最佳方式是什么？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:39:58.743

不要将会话保存在全局变量中，因为这意味着该站点的每个后续访问者都将使用和修改相同的变量（您使用相同的 express 实例来处理所有进来的请求。）您可以使用 express 的内置中间件在开发应用程序时将会话存储在内存中。在开始声明路由之前，只需放置以下中间件：

```
app.use(express.cookieParser()); /* Parses cookies. */
app.use(express.cookieSession({ secret: 'yoursecret' })); /* Handles sessions stored in your cookies. */
// ... your other middleware

app.get('/', function(req, res) {
    if (req.session) {
        res.json(req.session);
    } else {
        res.send('You have no session.');
    }
}); 
```

对于生产，建议使用 Redis 之类的东西来存储会话。

# android-wifi - WifiP2pManager.initialize 返回 null

> ID：14007021
> 
> 赞同：0
> 
> 时间：2012-12-22T22:16:27.110
> 
> 标签：android-wifi, wifi-direct

WifiP2pManager.initialize 返回 null。我正在使用 Droid 4，Android 版本 4.0.4，并使用 API 级别 14 构建了我的应用程序。

```
... 
```

_p2pChannel = _p2pManager.initialize(this, getMainLooper(), new WifiP2pManager.ChannelListener() {

```
@Override
public void onChannelDisconnected() {
     Log.e(TAG, "Peer-to-peer manager channel disconnected.");
     //TODO: Manage the re-creation of the channel
     _p2pChannel = null;
}
});

if (_p2pChannel == null) {
    Log.e(TAG, "P2P Manager failed to initialize.");
    return;
}

.... 
```

Android 清单具有：

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.CHANGE_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />
<uses-permission android:name="android.permission.INTERNET" />    

<uses-feature 
    android:name="android.hardware.wifi.direct" 
    android:required="true"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:12:16.317

我猜 Droid4 根本不支持 WiFiDirect。有人可以确认吗？它不在 WiFiDirect 认证设备列表中：[http ://certifications.wi-fi.org/pdf_certificate.php?cid=WFA12854](http://certifications.wi-fi.org/pdf_certificate.php?cid=WFA12854)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-29T11:04:30.013

可能是因为您的模拟器，我遇到了这个问题，并在本机 android 模拟器（android studio）中朗姆我的应用程序，我的问题得到了解决

# php - 使用 javascript 在 php 中动态填充组合框

> ID：14007024
> 
> 赞同：-1
> 
> 时间：2012-12-22T22:16:42.197
> 
> 标签：php, javascript, arrays, combobox

我编写了一个代码，我试图通过从不同的下拉列表中选择选项来填充下拉列表。我用谷歌搜索并发现这可以通过 javascript 实现。`onchange()`但是在第一个组合框的方法中将 php 数组传递给 javascript 时出现错误。数组非常好，它给了我想要的结果，但是当我尝试填充它时会发生错误......它显示未初始化的变量错误......但我无法找到为其设置值的方法。

```
 <?php
    session_start(); // NEVER forget this!
    if(!isset($_SESSION['loggedin']))
    {
        die("To access this page, you need to <a href='main_login.php'>LOGIN</a>"); 
    } 
?>
<html>
 <head>
  <script type="text/javascript">
    function validateForm()
    {
    var name=document.forms["form1"]["name"].value;
    var passno=document.forms["form1"]["passno"].value;
    var applicationno=document.forms["form1"]["applicationno"].value;
    var price=document.forms["form1"]["price"].value;
    var date=document.forms["form1"]["date"].value;
    var reg = /(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d/;
    if ((name=="" || name==null) || (passno=="" || passno==null) || (applicationno=="" || applicationno==null || isNaN(applicationno) ) || (price=="" || price==null || isNaN(price)) || (date=="" || date==null || date=="00-00-0000" || !date.match(reg)))
      {
      alert("Applicant Name, Passport Number, Application Number,Price And Date Must Be Filled Out.\n\n Valid Date Format Is : (dd-mm-yyyy) \n\n Only numbers are allowed for Application Number and Price.");
      return false;
      }
      else {
          return true;

            }
    }
    function fillDate(array1,array2)
    {
        document.form1.subagentname.options.add( new Option(array1,array2) );
        }
  </script>

    <style type="text/css">
    input.uppercase { 
    text-transform: uppercase; 
    }
    </style>
 </head>
 <body>
    <h1 align="center">ADD VISA DETAILS</h1>
    <form id="form1" name="form1" method="post" action="insertvisa.php" onSubmit="return validateForm();">
    <p>
        <label for="name">APPLICANT NAME : * </label>
        <input type="text" name="name" id="name" style="text-transform:uppercase;" onKeyUp="this.value=this.value.toUpperCase()"/>
      </p>

      <p>
        <label for="company">COMPANY : </label>
        <select name="company" id="company">
          <option value="TULIP TOURISM LLC">TULIP TOURISM LLC</option>
          <option value="TULIP TRAVELS LLC">TULIP TRAVELS LLC</option>
          <option value="EXCELLENT MARINA">EXCELLENT MARINA</option>
        </select>
      </p>
      <p>
        <label for="nationality">NATIONALITY : </label>
        <input type="text" name="nationality" id="nationality" style="text-transform:uppercase;" onKeyUp="this.value=this.value.toUpperCase()"/>
      </p>
      <p>
        <label for="passno">PASSPORT NUMBER : * </label>
        <input type="text" name="passno" id="passno" style="text-transform:uppercase;" onKeyUp="this.value=this.value.toUpperCase()"/>
      </p>
      <p>
        <label for="applicationno">APPLICATION NUMBER : * </label>
        <input type="text" name="applicationno" id="applicationno" style="text-transform:uppercase;" onKeyUp="this.value=this.value.toUpperCase()"/>
      </p>
      <p>
        <label for="proctype">PROCEDURE TYPE : </label>
        <select name="proctype" id="proctype">
          <option value="NORMAL">NORMAL</option>
          <option value="URGENT">URGENT</option>
        </select>
      </p>
      <p>
        <label for="visatype">VISA TYPE : </label>
        <select name="visatype" id="visatype">
          <option value="TOURIST">TOURIST</option>
          <option value="SERVICE">SERVICE</option>
          <option value="TT">TT</option>
          <option value="EXTENSION">EXTENSION</option>
          <option value="CANCELLATION">CANCELLATION</option>
        </select>
      </p>
      <p>
        <label for="agent">AGENT : </label>
        <?php 

    $server="localhost";
    $username="root";
    $password="hp";
    $link=mysql_connect($server, $username, $password) or die ("Cannot connect to mysql server: ".mysql_error());

    $dbname = 'apcom_visa_system';
    mysql_select_db($dbname, $link) or die ("Cannot connect to database: ".mysql_error());

    $query="SELECT agent_id,agent_name FROM agent";

    $result = mysql_query ($query) or die ('error submitting');

    echo "<select name='agentname' id='agentname' onChange='return fillData(htmlspecialchars(json_encode($subagentsID), ENT_NOQUOTES),htmlspecialchars(json_encode($subagentsName), ENT_NOQUOTES));'>";
    while($drop=mysql_fetch_array($result)){

    //data stored in $drop
    echo "<option value='$drop[agent_id]'>$drop[agent_name]</option>";
    $agentsID[]=$drop[agent_id];

    }
    echo "</select>"; 

    foreach($agentsID as $values)
    {
        //echo "agents-->".$values;

    $query1="SELECT subagent_id,subagent_name FROM subagent WHERE agent_id=$values";

    $result1 = mysql_query ($query1) or die ('error submitting');

    while($drop1=mysql_fetch_array($result1)){
    $subagentsID[]=$drop1['subagent_id'];
    $subagentsName[]=$drop1['subagent_name'];

        //echo "subagents-->".$drop1['subagent_id'];
    }

        }

    mysql_close($link);
    ?>
      </p>
      <p>
      <label for="subagentname">SUBAGENT : </label>
      <select name="subagentname" id="subagentname"></select>
      </p>

      <p>
        <label for="cost">COST : </label>
        <select name="cost" id="cost">
          <option value="210">210</option>
          <option value="310">310</option>
          <option value="610">610</option>
          <option value="90">90</option>
        </select>
      </p>
      <p>
        <label for="price">PRICE : * </label>
        <input type="text" name="price" id="price" style="text-transform:uppercase;" onKeyUp="this.value=this.value.toUpperCase()"/>
        <label for="currency"></label>
        <select name="currency" id="currency">
          <option value="AED">AED</option>
          <option value="PKR">PKR</option>
        </select>
      </p>
      <p>
        <label for="status">STATUS : </label>
        <select name="status" id="status">
          <option value="APPLICATION NOT POSTED">APPLICATION NOT POSTED</option>
          <option value="APPLICATION POSTED">APPLICATION POSTED</option>
          <option value="APPLICATION INPROCESS">APPLICATION INPROCESS</option>
          <option value="APPLICATION REJECTED">APPLICATION REJECTED</option>
          <option value="APPLICATION APPROVED">APPLICATION APPROVED</option>
          <option value="DOCUMENTS REQUIRED">DOCUMENTS REQUIRED</option>
        </select>
      </p>
      <p>
        <label for="date">APPLICATION DATE : * </label>
        <input type="text" name="date" id="date">
    (DATE FORMAT : dd-MM-yyyy , Example : 11-05-2012) </p>
      <p>
      <p>
      * Required
      </p>
        <input type="submit" name="submit" id="submit" value="Submit" />
        <input type="submit" name="cancel" id="cancel" value="Cancel" onClick="document.location.href='main.php';return false;"/>
      </p>
  </form>
 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T17:07:56.017

不要使用 php 更改第二个下拉列表，而是使用 javascript 更改它。在更改第一个下拉列表时，对页面进行 ajax 调用（这与您现在为获取第二个下拉列表的数据所做的操作相同，而不是将其放在同一页面上创建一个返回选项列表的新页面对于第二个下拉菜单），它为您提供了必须在第二个下拉菜单中显示的选项列表。

# c# - C# 类与结构

> ID：14007025
> 
> 赞同：2
> 
> 时间：2012-12-22T22:16:45.613
> 
> 标签：c#, class, struct

Microsoft 对使用 struct 有以下规则：

> **如果类型的实例很小且通常短暂存在或通常嵌入在其他对象中，请考虑定义结构而不是类。**
> 
> **除非类型具有以下所有特征，否则不要定义结构：**
> 
> 1.  它在逻辑上表示单个值，类似于原始类型（整数、双精度等）。
> 2.  它的实例大小小于 16 字节。
> 3.  它是不可变的。
> 4.  它不必经常装箱。

据我了解，当你想要一个值类型的行为时，你会创建 struct 。当然，这会在分配并将其传递给函数时给您带来复制开销。但是你为什么要遵循#2 和#3 呢？如果您的值类型太大怎么办？此外，我不明白您为什么要将不可变类型设为值类型。如果类型是不可变的，则最好节省通过引用传递它的时间，因为无论如何它都无法更改。

我问的原因是我正在制作一个游戏，其中对象具有 Vector2d 类型的坐标、速度等属性。问题是，我应该制作 Vector2d 不可变结构（这不会需要大量额外的内存吗？）、可变结构（人们说它们是邪恶的）还是只是类（我必须总是调用 vector.Clone() 否则我可能无意中得到两个具有相同向量变量的对象）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:24:00.550

> 此外，我不明白您为什么要将不可变类型设为值类型。

该`int`类型是不可变类型，是您需要不可变值类型的完美示例。

想象一下，如果`int`是引用类型。如果每次使用整数时都必须取消引用，那将非常昂贵。实际上，当您使用“装箱”整数（例如，存储在类型变量中的整数）时，就会发生这种情况`object`。与 Java 相比，.NET 的一项改进是集合可以保存未装箱的整数。

> 如果类型是不可变的，您最好节省通过引用传递它的时间

是的，如果它很大且不可变，那么您可以通过引用传递它来节省时间。这就是为什么指南建议大类型应该是引用类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:28:28.630

16 字节似乎有些随意，但可能与典型 CPU 的高速缓存行大小有关。这比现代 CPU 上的 64 字节高速缓存行小得多。可能是因为你不能明确地将你的结构对齐到一行。

让你再次输入不可变避免了通过引用传递的需要。相反，只需返回一个新实例。跟随引用比使用缓存值要昂贵得多，保持对象小会增加它保留在缓存中的机会。

一般来说，如果您想要引用语义，请将其设为类，否则将其设为结构。我建议您遵循 MS 指南，除非您可以证明使用分析器（或其他一些经验证据）有充分的理由不这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T22:21:11.390

对于＃2，不应轻易复制大型结构，因此大多数时候应该是一个类。此外，这些不是硬性规则，只是经验法则。如果您有充分的理由不遵守规则，请继续。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-22T22:25:59.053

1.  当传递/操作一个结构时，它的整个值必须在堆栈周围复制，而不仅仅是一个引用。一旦它达到一定的大小，16 字节，考虑只使用一个类来避免开销。

2.  不变性更像是一种旨在减少代码错误的模式，而不是硬性规定。如果您的值类型可能是不可变的，那么这样做会很有帮助。

你可能误解了不变性。您的*变量*可以更改值，但值本身不会更改。例如，您可以拥有一个 Datetime 变量并将其设置为任何其他 DateTime 实例，但在实例初始化后您实际上无法更改该实例的字段。

# django - Django 存储网站内容

> ID：14007033
> 
> 赞同：4
> 
> 时间：2012-12-22T22:18:51.950
> 
> 标签：django

我对 Web 开发有点陌生，并且无法理解网站内容的存储方式。即使在看过开源项目之后，我仍然感到困惑。

假设我有一个包含多个段落的网页，我希望最终能够通过 Django 管理页面进行编辑。现在，我已经为页面设置了视图，但我不确定应该如何构建模型。

到目前为止，我有：

```
from django.db import models

class content(models.Model):
    name = models.CharField(max_length=30)
    last_updated = models.DateField(blank=True,null=True)
    content = models.TextField() 
```

“名称”是我的段落将要谈论的内容，“内容”应该是该页面上的所有段落。我的问题：内容字段应该存储在 HTML 中还是应该只存储纯文本？如果它是纯文本，当我将 model.content 字段嵌入到我的模板中时，我将如何添加 HTML 格式？这不会很难看，因为我需要解析纯文本才能做到这一点？

但是，如果我将 HTML 存储在内容字段中，我是否不必在输入内容时使用 HTML 或在管理页面中使用 WYSIWYG 编辑器？

感谢您的任何帮助 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:27:38.347

在管理员中，您可以使用像[TinyMCE](http://code.google.com/p/django-tinymce/)这样的所见即所得编辑器， 这会将内容存储为 HTML。渲染时 - 你可以做`{{content|safe}}`.

查看[django-flatpages](https://docs.djangoproject.com/en/dev/ref/contrib/flatpages/?from=olddocs)。它完全符合您的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:26:41.903

查看[django-tinymce](http://django-tinymce.readthedocs.org/en/latest/)。它是一个很好的包，它提供了一个与前端表单相关联的[小部件](http://django-tinymce.readthedocs.org/en/latest/usage.html#using-the-widget)和一个在管理员中显示为编辑器的[模型字段。](http://django-tinymce.readthedocs.org/en/latest/usage.html#the-htmlfield-model-field-type)`CharField``WYSIWYG`

是的，它将文本内容作为 html 存储在数据库中。

# web-applications - 部署 webapp 授权策略

> ID：14007035
> 
> 赞同：0
> 
> 时间：2012-12-22T22:19:15.133
> 
> 标签：web-applications, permissions, google-apps-script, authorize

我有一个 webapp 脚本，它可以访问一些需要用户授权的资源。我在短圈上更新了这个脚本，并注意到在几次部署之后，用户再次获得授权请求，即使脚本运行所需的资源没有变化（例如文本更改）。

找不到关于授权请求的政策，希望你能帮助我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T10:15:39.520

请参阅 Corey 在[这篇文章](https://stackoverflow.com/questions/12354602/when-does-google-require-re-authentication)中的回答，即使进行了小的更改，某些服务调用也需要重新授权。

# java - AWT-EventQueue-0" java.lang.NullPointerException

> ID：14007041
> 
> 赞同：-2
> 
> 时间：2012-12-22T22:20:55.313
> 
> 标签：java, swing, printing

谢谢你们的帮助，我得到了如下所示的代码，它不是我的全部，但我一直在编辑它以尝试做我想做的事，我快完成了，我只是在最后收到一条错误消息障碍，我收到一条错误消息：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at java.text.AttributedString.<init>(AttributedString.java:127)
    at PrintText.print(PrintText.java:109)
    at sun.print.RasterPrinterJob.printPage(RasterPrinterJob.java:1973)
    at sun.print.RasterPrinterJob.print(RasterPrinterJob.java:1461)
    at sun.print.RasterPrinterJob.print(RasterPrinterJob.java:1277)
    at PrintText.printer(PrintText.java:98)
    at PrintText$1.run(PrintText.java:52)
    at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:251)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:721)
    at java.awt.EventQueue.access$200(EventQueue.java:103)
    at java.awt.EventQueue$3.run(EventQueue.java:682)
    at java.awt.EventQueue$3.run(EventQueue.java:680)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:691)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

上面的错误是在我选择了我要打印的文档之后出现的，在打印机框出现之前，这个错误信息是什么意思？

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.print.*;
import java.text.*;
import java.io.*;
import javax.swing.*;
import java.util.List;
import java.util.ArrayList;

public class PrintText implements Printable {

    private static String mText;

    // Below the code will allow the user to select a file and then print out the contents of the file
    public static void main(String[] args) throws IOException {
        new PrintText();
    }

    public PrintText() {
        EventQueue.invokeLater(new Runnable() {
                @Override
                public void run() {
                    try {
                        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                    } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                    }

                    //selects the file
                    JFileChooser chooser = new JFileChooser();
                    chooser.showOpenDialog(null);
                    File file = chooser.getSelectedFile();
                    String filename = file.getName();
                    //System.out.println("You have selected: " + filename);  testing to see if file seleected was right
                    String path = file.getAbsolutePath();

                    //Reads contents of file into terminal 
                    //FileReader fr = new FileReader("filename");
                    // FileReader fr = new FileReader("D:/Documents/" + "filename")); 

                    BufferedReader br = null;
                    try {
                        br = new BufferedReader(new FileReader(path));
                        List<String> list = new ArrayList<String>();
                        while ((mText = br.readLine()) != null) {
                            //Displays the contents of the file in terminal
                            System.out.println(mText);
                            list.add(mText);
                        }

                        printer();
                    } catch (IOException exp) {
                        exp.printStackTrace();
                    } finally {
                        try {
                            br.close();
                        } catch (Exception e) {
                        }
                    }
                    //fr.close(); 
                }
            });
    }
    //private static final String mText = 
    //    "This is a test to see if this text will be printed "; //This works perfectly fine
    //AttributedString mStyledText = new AttributedString(mText);
    /**
     * Print a single page containing some sample text.
     */
    public void printer() {

        /* Get the representation of the current printer and 
         * the current print job.
         */
        PrinterJob printerJob = PrinterJob.getPrinterJob();
        /* Build a book containing pairs of page painters (Printables)
         * and PageFormats. This example has a single page containing
         * text.
         */
        Book book = new Book();
        book.append(this, new PageFormat());
        /* Set the object to be printed (the Book) into the PrinterJob.
         * Doing this before bringing up the print dialog allows the
         * print dialog to correctly display the page range to be printed
         * and to dissallow any print settings not appropriate for the
         * pages to be printed.
         */
        printerJob.setPageable(book);
        /* Show the print dialog to the user. This is an optional step
         * and need not be done if the application wants to perform
         * 'quiet' printing. If the user cancels the print dialog then false
         * is returned. If true is returned we go ahead and print.
         */
        boolean doPrint = printerJob.printDialog();
        if (doPrint) {
            try {
                printerJob.print();
            } catch (PrinterException exception) {
                System.err.println("Printing error: " + exception);
            }
        }
    }

    /**
     * Print a page of text.
     */
    public int print(Graphics g, PageFormat format, int pageIndex) {
        AttributedString mStyledText = new AttributedString(mText);
        /* We'll assume that Jav2D is available.
         */
        Graphics2D g2d = (Graphics2D) g;
        /* Move the origin from the corner of the Paper to the corner
         * of the imageable area.
         */
        g2d.translate(format.getImageableX(), format.getImageableY());
        /* Set the text color.
         */
        g2d.setPaint(Color.black);
        /* Use a LineBreakMeasurer instance to break our text into
         * lines that fit the imageable area of the page.
         */
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {
            TextLayout layout = measurer.nextLayout(wrappingWidth);
            pen.y += layout.getAscent();
            float dx = layout.isLeftToRight() ? 0 : (wrappingWidth - layout.getAdvance());
            layout.draw(g2d, pen.x + dx, pen.y);
            pen.y += layout.getDescent() + layout.getLeading();
        }
        return Printable.PAGE_EXISTS;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:28:52.923

1.  不要使`print`方法静态。您需要在用户选择文件后调用它，传入文件内容......
2.  不要`PrintText`在`print`this is not 与方法共享文件选择的结果中创建新的实例`print`。
3.  确保您遵守 Swing 的线程规则
4.  如果你打开它，你有责任关闭它。确保你正在关闭你的流/阅读器
5.  您可能想检查用户是否确实选择了一个文件，但我将由您决定。

更多类似...

```
public class PrintText implements Printable {

    private static String mText;

    // Below the code will allow the user to select a file and then print out the contents of the file
    public static void main(String[] args) throws IOException {
        new PrintText();
    }

    public PrintText() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                //selects the file
                JFileChooser chooser = new JFileChooser();
                chooser.showOpenDialog(null);
                File file = chooser.getSelectedFile();
                String filename = file.getName();
                //System.out.println("You have selected: " + filename);  testing to see if file seleected was right
                String path = file.getAbsolutePath();

                //Reads contents of file into terminal 
                //FileReader fr = new FileReader("filename");
                // FileReader fr = new FileReader("D:/Documents/" + "filename")); 

                BufferedReader br = null;
                try {
                    br = new BufferedReader(new FileReader(path));
                    List<String> list = new ArrayList<String>();
                    while ((mText = br.readLine()) != null) {
                        //Displays the contents of the file in terminal
                        System.out.println(mText);
                        list.add(mText);
                    }

                    printer();
                } catch (IOException exp) {
                    exp.printStackTrace();
                } finally {
                    try {
                        br.close();
                    } catch (Exception e) {
                    }
                }
                //fr.close(); 
            }
        });
    }
    //private static final String mText = 
    //    "This is a test to see if this text will be printed "; //This works perfectly fine
    AttributedString mStyledText = new AttributedString(mText);

    /**
     * Print a single page containing some sample text.
     */
    public void printer() {

        /* Get the representation of the current printer and 
         * the current print job.
         */
        PrinterJob printerJob = PrinterJob.getPrinterJob();
        /* Build a book containing pairs of page painters (Printables)
         * and PageFormats. This example has a single page containing
         * text.
         */
        Book book = new Book();
        book.append(this, new PageFormat());
        /* Set the object to be printed (the Book) into the PrinterJob.
         * Doing this before bringing up the print dialog allows the
         * print dialog to correctly display the page range to be printed
         * and to dissallow any print settings not appropriate for the
         * pages to be printed.
         */
        printerJob.setPageable(book);
        /* Show the print dialog to the user. This is an optional step
         * and need not be done if the application wants to perform
         * 'quiet' printing. If the user cancels the print dialog then false
         * is returned. If true is returned we go ahead and print.
         */
        boolean doPrint = printerJob.printDialog();
        if (doPrint) {
            try {
                printerJob.print();
            } catch (PrinterException exception) {
                System.err.println("Printing error: " + exception);
            }
        }
    }

    /**
     * Print a page of text.
     */
    public int print(Graphics g, PageFormat format, int pageIndex) {
        /* We'll assume that Jav2D is available.
         */
        Graphics2D g2d = (Graphics2D) g;
        /* Move the origin from the corner of the Paper to the corner
         * of the imageable area.
         */
        g2d.translate(format.getImageableX(), format.getImageableY());
        /* Set the text color.
         */
        g2d.setPaint(Color.black);
        /* Use a LineBreakMeasurer instance to break our text into
         * lines that fit the imageable area of the page.
         */
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {
            TextLayout layout = measurer.nextLayout(wrappingWidth);
            pen.y += layout.getAscent();
            float dx = layout.isLeftToRight() ? 0 : (wrappingWidth - layout.getAdvance());
            layout.draw(g2d, pen.x + dx, pen.y);
            pen.y += layout.getDescent() + layout.getLeading();
        }
        return Printable.PAGE_EXISTS;
    }
} 
```

# html - Facebook 评论插件在滚动时覆盖我的标题 div

> ID：14007045
> 
> 赞同：2
> 
> 时间：2012-12-22T22:21:24.127
> 
> 标签：html, css, facebook

是的，就像标题一样，**Facebook 评论插件**在滚动时会覆盖我的标题 div。

这是**在**滚动之前： ![在此处输入图像描述](../Images/581efa4b429c485bfe9b5e915e895bb2.png)

这是滚动 **后：**![在此处输入图像描述](../Images/f9b3a0bb554515d1509f53b38728f625.png)

**标题栏样式**：

```
#header {
    height:45px;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    opacity: 0.95;
    background: #2D2D2D;
}
#colorbars {
    border-top: 3px solid #DD5044;
    height:42px;
    border-bottom: 8px solid rgba(40, 40, 40, .2);
}
#headercontainer {
    width: 940px;
    overflow: hidden;
    margin: 0 auto 0 auto;
} 
```

**标题栏的HTML**：

```
<div id="header"><header id="colorbars"><div id="headercontainer">
// content
</div></header></div> 
```

**Facebook插件**的代码是：

```
<fb:comments href="<?php echo $facebook_href; ?>" width="655" num_posts="4"></fb:comments> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T22:28:34.603

设置`z-index`标题有帮助吗？

```
#header {
    /* ... */
    z-index: 9999;
} 
```

# java - 奇怪的事务处理 JavaEE 6

> ID：14007046
> 
> 赞同：2
> 
> 时间：2012-12-22T22:21:28.600
> 
> 标签：java, transactions, java-ee-6, optimistic-locking

目前我正在研究 JavaEE 6 事务处理，但我有点卡住了。

我模拟了一个研讨会预订引擎，有人可以在其中预订一个或多个人参加研讨会。我的实体如下所示：

```
@Entity
@XmlRootElement
public class Seminar {

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    private Long id;

    @Version
    private Long version;

    private Integer freeCapacity;

    ... //getters & setters
} 
```

这是 EJB：

```
@Stateless
public class SeminarBooking {

    @PersistenceContext
    EntityManager em;

    @Inject
    Event<Seminar> txListeners;

    public boolean bookSeminar(Long seminarId, int numberOfPersons) {
        Seminar seminar = em.find(Seminar.class, seminarId);
        Integer freeCapacity = seminar.getFreeCapacity();

        if((freeCapacity - numberOfPersons) >= 0) {
            //setting free capacity after booking 
            seminar.setFreeCapacity(freeCapacity - numberOfPersons);

            txListeners.fire(seminar);
            return true;
        }
        return false;
    }
} 
```

我的事务监听器如下所示：

```
public class TxListener {
    public void onSuccess(@Observes(during=TransactionPhase.AFTER_SUCCESS) Seminar seminar) {
        //omitted retrieving of minute,second,milli
        logger.fine("Successful booking -- " + minute + ":" + second + ":" + milli + " FreeCapacity: "+seminar.getFreeCapacity());
    }
} 
```

问题是，我在后端并行处理 100 个线程并获取如下日志条目：

```
Successful booking -- 24:50:51 FreeCapacity: 9641
Successful booking -- 24:50:61 FreeCapacity: 9641
Successful booking -- 24:50:54 FreeCapacity: 9641
Successful booking -- 24:50:637 FreeCapacity: 9639 
```

怎么会有相同的 freeCapacity 值的成功（已提交）事务？

在我看来，第二个和第三个交易应该抛出一个`OptimisticLockException`，因为第一个交易已经更新了实体的版本字段。因此，第二个和第三个事务应该已经回滚。

我在这里想念什么吗？我怎么解决这个问题？

# javascript - 使用从 URL 变量读取的 JavaScript 加载不同的 CSS 样式表

> ID：14007048
> 
> 赞同：3
> 
> 时间：2012-12-22T22:21:50.817
> 
> 标签：javascript, html, ios, css, wordpress

我试图在我的 wordpress 博客上使用两种不同的样式表，这样当通过 Web 访问页面时使用一个样式表，当通过我们的 iOS 应用程序访问博客内容时使用另一个样式表。现在我们正在将 ?app=true 附加到来自 iOS 应用程序的 URL 请求中，希望在我们的博客中我们可以搜索此字符串并加载不同的样式表。我们正在使用 JSON API 插件，以便我们的 iOS 应用程序可以通过编程方式拉取我们的博客文章并将它们显示在 iOS 应用程序的 Web 视图中。

在我的 wordpress 博客中，我使用了在 URL 中查找 ?app=true 的 JavaScript，如果是，则加载不同的样式表。

```
<script language="javascript" type="text/javascript">
    var currentLocation = window.location.href; 
    if(currentLocation.indexOf('/?app=true') > -1) {        
        document.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"appstyle.css\" />");
    }
</script> 
```

你可以看看[http://blog.meetcody.com](http://blog.meetcody.com)并查看页面源代码。您将在标签之间看到此代码段。

我遇到的问题是上面的代码实际上并没有加载 appstyle.css 样式表。如果你看一下[http://blog.meetcody.com/wp-content/themes/standard/appstyle.css?ver=3.4.2](http://blog.meetcody.com/wp-content/themes/standard/appstyle.css?ver=3.4.2)你可以看到我正在通过设置背景来测试这个：黑色正文 {} 标签

```
body {
background: black;
} 
```

而在[http://blog.meetcody.com/wp-content/themes/standard/style.css?ver=3.4.2](http://blog.meetcody.com/wp-content/themes/standard/style.css?ver=3.4.2)的 style.css 中，主体背景颜色为 #F2F0EB；在正文 {} 标记中

```
body {
    background: #F2F0EB;
} 
```

如何传递 URL 变量，例如 ?app=true，当传递时，我加载不同的样式表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T08:12:28.840

我在您的站点上使用 Firebug 控制台尝试了一些操作。因此，实际起作用的是以下代码：

```
<script type="text/javascript">
if(window.location.href.indexOf('/?app=true') > -1) {
    var fileref=document.createElement("link");
    fileref.setAttribute("rel", "stylesheet");
    fileref.setAttribute("type", "text/css");
    fileref.setAttribute("href", "http://blog.meetcody.com/wp-content/themes/standard/appstyle.css");
    document.getElementsByTagName("head")[0].appendChild(fileref);
}
</script> 
```

（此代码改编自[动态加载外部 JavaScript 或 CSS 文件](http://www.javascriptkit.com/javatutors/loadjavascriptcss.shtml)）。

由于您正在加载其他样式表并且我猜您覆盖了他们的规则，因此您必须在所有其他样式表之后加载此样式表。因此，将此代码放在文档的末尾或`window.onload`事件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:39:40.263

我相信解决问题的最佳方法是采用[响应式网页设计](http://en.wikipedia.org/wiki/Responsive_web_design)技术。这些允许您适当地解决不同的解决方案。

基本的 CSS 如下所示...

```
@media screen and (min-width: 480px) {
    // CSS for iPhone
}

@media screen and (min-width: 768px) {
    // CSS for iPad
}

@media screen and (min-width: 900x) {
    // CSS for desktop
} 
```

要点是您不需要为不同的平台加载不同的样式表。您将拥有一个适用于各种情况的样式表。它甚至可以适用于您没有专门针对的平台。

建造新波士顿环球报网站的团队是我对 RWD 的介绍。以下[是他们所做工作的细目](http://upstatement.com/blog/2012/01/how-to-approach-a-responsive-design/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-27T00:39:21.030

您还可以嗅出用户代理字符串。这样你就不必通过任何东西。在大多数情况下，我通常不会推荐它，但在这种特殊情况下，您无需大量代码就可以安全地做到这一点。

```
// Define what "webview" is
var is_uiwebview = /(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);

// See if this user is coming from it
if (is_uiwebview = true) {
// Your code to make the <link> with a proper href
// Raul's would work perfectly
}; 
```

同样，正如其他人所说，确保它在您的纯 Web 样式表之后加载内容。也不完全确定`= true`是否需要。

# jquery - 如何在拖放中获取本地文件的绝对路径？

> ID：14007049
> 
> 赞同：0
> 
> 时间：2012-12-22T22:21:51.113
> 
> 标签：jquery, html, firefox, drag-and-drop

我试图弄清楚如何获取已放置在网页上特定元素上的文件的本地路径（file:///C:/test.jpg）。这是我需要的唯一信息，但我在互联网上找到的所有信息都是关于上传文件的。

它适用于在本地 WAMP 服务器上运行的基本 PHP 脚本。

是否可以 ？我怎样才能做到这一点？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T22:24:24.730

> 是否可以 ？我怎样才能做到这一点？

不，当然不。出于安全原因，您无法获取客户端计算机上文件的完整路径。作为 Web 开发人员，您绝对不应该对客户端计算机的文件夹结构一无所知。您当然可以获取已放入您网页的文件的内容，但仅此而已。

如果您需要非常了解此文件存储在您的客户端计算机上的什么位置，您可以提供一个输入字段并简单地要求他们提供此信息。但没有他们的明确同意，这是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T22:44:02.747

只需将图像上传到 WAMP 服务器并使用您的 php.ini 设置路径即可。您最终会得到重复的文件，但会解决安全问题

# mysql - 无法在 VPS 上使用 PhpMyAdmin 和 Cpanel 导入数据库？

> ID：14007055
> 
> 赞同：0
> 
> 时间：2012-12-22T22:23:16.010
> 
> 标签：mysql, phpmyadmin, cpanel, vps, whm

我最近用 cPanel 设置了 VPS。

我已经创建了一个用户并创建了一个数据库，现在我想将一个数据库导入到它上面。

但是，当我尝试时，我收到错误消息

**#1044 - 用户 'user'@'localhost' 拒绝访问数据库 'database'**

我怀疑这可以通过 WHM 解决，但我现在还不想试错。我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:34:12.497

当您使用 phpMyAdmin 导入数据库时​​，通常是通过导入带有`.sql`扩展名的文本文件来实现的。这是可能在 .sql 数据库备份中的一段代码。在您的示例中，您尝试导入的数据库名为 database。

```
-- phpMyAdmin SQL Dump
-- version 2.11.9.5
-- http://www.phpmyadmin.net
--
-- Host: localhost
-- Generation Time: Apr 02, 2010 at 08:01 AM
-- Server version: 5.0.81
-- PHP Version: 5.2.6

SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";

CREATE DATABASE database;
-- --------------------------------------------------------
--
-- Table structure for table `table`
--

CREATE TABLE IF NOT EXISTS `table` (
`column1` text NOT NULL,
`column2` text NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1; 
```

使用 phpMyAdmin 尝试导入此类文件时，您将收到类似于以下内容的错误消息：

```
Error

SQL query:

CREATE DATABASE database;

MySQL said: Documentation
#1044 - Access denied for user 'user'@'localhost' to database 'database' 
```

在这种情况下，cPanel 用户名是`user`. 由于 cPanel 的数据库命名约定，所有数据库名称必须以 cPanel 用户名开头，后跟`_`. 使用这种格式，您只能创建一个名为`user_database`.

此导入失败的原因是 .sql 文件中的以下行...

```
CREATE DATABASE database; 
```

同样，您不能创建一个名为 的数据库`database`，但是您可以创建一个名为 的数据库`user_database`。

如果您更改显示的行：`CREATE DATABASE`以便它创建：`user_database`而不是`database`它将再次失败并显示以下消息：

```
Error

SQL query:

CREATE DATABASE user_database;

MySQL said: Documentation
#1044 - Access denied for user 'user'@'localhost' to database 'user_database' 
```

使用 cPanel 时，必须在 cPanel 本身内创建数据库。

以下是纠正此问题的步骤：

1.  `user_database`在 cPanel 中创建数据库
2.  注释掉`CREATE DATABASE`我的 .sql 文件中的命令

    为此，只需更改：

    `CREATE DATABASE database;`

    到

    `-- CREATE DATABASE database;`

    您只需添加`dash-dash-space`到该行的前面以将其注释掉，这样它就不会被执行。

3.  登录 phpMyAdmin，访问`user_database`数据库，然后正常导入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T17:43:24.773

在转储数据库之前，请授予对在 Cpanel 中使用该用户相同密码创建的新数据库用户的完全访问权限： `grant all on database_name.* to database_user@localhost identified by 'password';`

然后你需要修改你的.sql文件（可以使用notepad++），注释掉创建和使用新数据库的部分：

 ``-- Database: `dbname` --
-- CREATE DATABASE IF NOT EXISTS `dbname` DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci;
-- USE `dbname`;`
那么您应该可以将其导入到您的 Cpanel 中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-22T22:58:58.807

为了正式...

您尝试导入的文件可能包含您没有权限的内容。我会检查权限，然后检查您要导入的文件。`

# javascript - Firebug 中神秘的“类型错误：非本地范围对象”

> ID：14007062
> 
> 赞同：1
> 
> 时间：2012-12-22T22:24:30.783
> 
> 标签：javascript, macos, firefox, firebug, swfobject

考虑以下 HTML：

```
<!DOCTYPE html>
<html>
<body>
Test page

<!--Start of Zopim Live Chat Script-->
<script type="text/javascript">
window.$zopim||(function(d,s){var z=$zopim=function(c){z._.push(c)},$=z.s=
d.createElement(s),e=d.getElementsByTagName(s)[0];z.set=function(o){z.set.
_.push(o)};z._=[];z.set._=[];$.async=!0;$.setAttribute('charset','utf-8');
$.src='//cdn.zopim.com/?pTR0FiicfJ4aMcmuHI9HfVAB4uzKeFIT';z.t=+new Date;$.
type='text/javascript';e.parentNode.insertBefore($,e)})(document,'script');
</script>
<!--End of Zopim Live Chat Script-->

<script type="text/javascript" async="">
window.addEventListener('load', function() {
    var b = document.getElementsByTagName("body")[0];
    var o = document.createElement("object");
    o.setAttribute("type", "application/x-shockwave-flash");
    var t = b.appendChild(o);
});
</script>
</body>
</html> 
```

jsFiddle在这里：http: [//jsfiddle.net/V9jtD/](http://jsfiddle.net/V9jtD/)

它包含 Zopim 小部件代码，另一个异步脚本，它只是将“对象”标签添加到 DOM。让上述文件由网络服务器提供服务（您可以使用 jsFiddle：[http](http://fiddle.jshell.net/V9jtD/show/) ://fiddle.jshell.net/V9jtD/show/ ）。在激活了 Firebug 的 MacOSX Firefox 15+ 中打开它。

您将看到以下错误重复多次：

```
TypeError: non-native scope object 
```

如果错误没有出现，只需刷新页面。主要是 Zopim 未能出现（有时出现功能不完整）。我无法在 Firefox/Ubuntu 中重现这一点。（它可能在我无法检查的 Firefox/Windows 中重现）。

但是，在以下情况下，Zopim 可以正常加载：

1.  注释掉“var t = b.appendChild(o);” （即不要将“对象”标签附加到 DOM，或者您可以完全删除第二个脚本标签）。
2.  停用萤火虫。

**我本质上想了解是谁导致了错误，以便调试它。**

**是 Firebug，因为停用它 Zopim 可以正常工作吗？但是在启用 Firebug 的情况下删除第二个脚本标记不会导致错误。**

**它是第二个脚本标签，因为删除它 Zopim 工作正常吗？但随后停用 Firebug 和 Zopim 即使使用第二个脚本标签也能正常工作。**

**还是 Zopim 本身？**

请注意，第二个脚本标记中的内容是 swfobject.js 中函数 testPlayerVersion() 的一部分。当我试图将 Zopim 添加到已经有 swfobject 的页面时，我遇到了这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T22:45:18.143

如果小提琴没有从 Zopim 加载缩小的 JS，可能会更容易解决，但有问题的行（大致美化）是：

```
try {
    (0)()
} catch (v) {
    s = v.arguments ?
        'chrome' : v.stack ?
        'firefox' : window.opera && !('stacktrace' in v) ?
        'opera' : 'other'
} 
```

这看起来像是一种检测浏览器的骇人听闻的方式。我不确定为什么它会导致 Firebug 保释，如果它是可重现的，可能值得向他们提出问题。

# java - 带有 JProgressBar 的 JDialog

> ID：14007066
> 
> 赞同：0
> 
> 时间：2012-12-22T22:25:27.893
> 
> 标签：java, swing, jdialog, jprogressbar

> **可能重复：**
> [Java GUI JProgressBar 未绘制](https://stackoverflow.com/questions/3154847/java-gui-jprogressbar-not-painting)

我有一个在处理动作事件时锁定了 GUI 的 GUI，所以我需要一个进度条来显示。我可以`JDialog`显示，但进度条不会显示。我用过`SwingUtilities.invokeLater()`，`invokeAndWait()`但无济于事。进度条不会显示。任何提示或帮助将不胜感激。

```
pb = new JProgressBar(0, 100);
pb.setPreferredSize(new Dimension(175, 40));
pb.setString("Working");
pb.setStringPainted(true);
JLabel label = new JLabel("Progress: ");
JPanel center_panel = new JPanel();
center_panel.add(label);
center_panel.add(pb);
dialog = new JDialog((JFrame) null, "Working ...");
dialog.getContentPane().add(center_panel, BorderLayout.CENTER);
dialog.pack();
dialog.setLocationRelativeTo(this); // center on screen
dialog.toFront(); // raise above other java windows
SwingUtilities.invokeLater(new Runnable() {

    @Override
    public void run() {
        dialog.setVisible(true);
        pb.setIndeterminate(true);
    }
});
Thread.sleep(5000);
template = AcronymWizardController
    .sharedInstance().readAndDislpayDocx(contdFile);
parseDocxText(contdFile);
pb.setIndeterminate(false);
savedFile.setText(contdFile.toString());
dialog.dispose(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T22:51:36.237

Swing 是单线程 API，也就是说，所有 UI 更新和修改都在单个线程（称为事件调度线程或 EDT）内执行。任何阻塞该线程的东西都会阻止它处理额外的更新，比如重绘。

你有很多选择。您的直接要求是将长期运行的任务从 EDT 中移出。为此，您可以使用 a`SwingWorker`或 a `Thread`。

根据您的描述，a`SwingWorker`会更容易。

举个简单的例子，看看[JProgressBar 不会更新](https://stackoverflow.com/questions/13094666/jprogressbar-wont-update/13095992#13095992)

有关更多信息，您应该查看[Swing 中的并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)

您的其他选择是在此处使用类似`ProgressMonitor`,的[示例](https://stackoverflow.com/questions/13394898/how-create-progress-bar-while-file-transfering/13395076#13395076)

# jquery - 针对 li 元素中的第二个跨度

> ID：14007074
> 
> 赞同：3
> 
> 时间：2012-12-22T22:26:22.823
> 
> 标签：jquery, html

我有以下标记：

```
<li>
<span>Hi</span>
<a href="#">Link</a>
<span>Bye</span>
</li> 
```

我怎样才能瞄准第二个`span`？我不想访问 的第三个孩子`li`，而是访问 中的第二个跨度`li`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:29:00.083

您可以使用 jQuery 的[**eq()**](http://api.jquery.com/eq-selector/)选择器来获取元素`span`中的第二个。`li`

```
$("li span").eq(1) 
```

`eq()`将返回一个引用第二个跨度的 jQuery 对象。所以你可以继续在它上面调用 jQuery 方法。

如果您更愿意获得第二个跨度的 HTML 元素，则可以使用它：

```
$("li span")[1]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T22:31:28.400

使用带有 CSS nth-child 的 jquery 选择器。

```
$('li span:nth-child(2)') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T22:28:23.013

您可以尝试以下选择器：

```
$('li').children('span').eq(1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T22:31:42.167

试一试：添加 jquery 引用并使用此脚本

```
<script>
    $("li span:nth-child(2)").append("<span> - 2nd!</span>");
</script> 
```

# iphone - 谷歌地图无法在 iPhone 模拟器上运行

> ID：14007075
> 
> 赞同：28
> 
> 时间：2012-12-22T22:26:39.593
> 
> 标签：iphone, google-maps, sdk, ios-simulator, google-maps-sdk-ios

我已经逐步实现了“Getting the Google Maps SDK for iOS”

最后模拟器运行正常，没有发现错误，但地图除了标记之外没有任何细节。

如图所示：

![模拟器截图](../Images/5d2b44768abfc64eaef8e6f82b69f2b0.png)

底部的输出也有此消息：

> 2012-12-23 01:06:59.869 GogleMap[3680:c07] GMSZoomTableQuadTree 缺少 >tile 类型 (mapType: 10) 的根缩放表 2012-12-23 01:07:00.042 GogleMap[3680:1b03] Google Maps SDK for iOS 版本：1.0.1.1154 2012-12-23 01:07:00.375 GogleMap[3680:c07] ClientParametersRequest 失败，3 次尝试 > 剩余。Error Domain=DASHConnectionError Code=100 “操作无法完成。（DASHConnectionError 错误 100。）”

请帮助并提前感谢。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-02-22T16:08:50.173

已解决：我认为我们都跳过了这个过程中一个很小但非常重要的步骤。

> 要开始使用，请在 Google API 控制台中启用 Google Maps SDK for iOS 服务以及其他 Google API。

![在此处输入图像描述](../Images/a0f2199807874dc15e49fcf5d6cd6444.png)

[在Google API 控制台](https://code.google.com/apis/console/?pli=1)中启用适用于 iOS 的 GoogleMap SDK 后，您的应用将在下次运行时正确加载图块。祝你好运！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-23T18:16:17.840

@user1924208 我也有同样的问题。我不知疲倦地在互联网上搜索答案，不幸的是，我认为我们不走运。Google API 控制台可能会向您显示 Google Maps v.3 的 API 密钥，它不是 Google Maps iOS API 密钥。因此，当您将其用作 API 密钥时，验证请求将始终失败。

似乎无论出于何种原因，他们都没有为 iOS 版本发布很多 API 密钥。令人沮丧的是，您只需要等到收到他们的电子邮件（不确定什么时候会......）。

您可以确认这一点，因为用任何随机字符串替换当前 API 密钥将产生相同的结果。顺便说一句，这在我测试过的模拟器和真实设备上也会产生相同的结果。

**更新**

我刚刚收到来自 Google 地图的电子邮件，说我的 API 密钥现在可用。我用 GMSServices 关闭了 MKMapKit，一切正常。似乎他们现在对发布 API 密钥感到更自在了，所以希望你很快就会得到你的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-22T06:32:19.257

注意，请确保您还在“服务”选项卡中启用了“Google Maps SDK for iOS”。

在我意识到我只生成了一个 API 密钥但忘记启用该服务之前，我遇到了类似的错误。解决了我的问题。

```
SDKDemos[160:907] ClientParametersRequest failed, 0 attempts remaining (0 vs 5). 
Error Domain=com.google.Maps.GMSDASHConnection Code=100 
"The operation couldn’t be completed. (com.google.Maps.GMSDASHConnection error 100.)" 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-20T19:34:34.163

我遇到了类似的问题，但我确信 API 密钥很好，因为 SDK 包中的示例项目与我在实际应用程序中使用的密钥 - 捆绑 ID 对一起使用。如果您的 API 密钥似乎无效，最新 (1.2) 版本的 sdk 实际上会注销警告。它无法显示地图的原因是我没有在项目设置的目标摘要选项卡中填写内部版本号。事实证明，您绝对需要在 Info.plist 中设置 CFBundleVersion 才能使 google 地图正常工作，否则地图将保持空白，不会显示错误或警告，甚至不会发出 Web 请求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-27T16:40:30.167

我有同样的问题。**我认为问题是我的项目的“捆绑标识符”与我的 Google APIs Console 中的捆绑标识符之一不同**。

因此，我为我的 Google API 控制台添加了更多捆绑标识符：从 Project Navigator 中选择您的项目本身，然后选择您的应用程序的目标。在标签**Summary**中，记住您在**Bundle Identifier**中的字符串。

转到 Google API 控制台页面，在控制台中选择 API 访问窗格，找到 iOS 应用程序的密钥部分，选择编辑允许的 iOS 应用程序...并添加您在上面记得的包标识符。重新运行您的项目并完成！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-12-11T12:06:52.157

只需确保启用位置

模拟器选项 Features->Location->Apple

[![在此处输入图像描述](../Images/477c502b011502206859114db373863a.png)](https://i.stack.imgur.com/XCUWg.jpg)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-28T19:01:19.390

我遇到了同样的问题，然后我去了谷歌控制台并点击“**生成新密钥**”并且新密钥有效！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-29T05:09:13.637

确保你没有改变你的

[**包标识符**]

为应用程序。它应该与您在生成 API 密钥时使用的匹配。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-02-25T15:43:46.430

**重要提示**：如果您想在 iOS 设备上使用谷歌地图进行练习，只需下载**[GoogleMaps.framework](https://developers.google.com/maps/documentation/ios/start#getting_the_google_maps_sdk_for_ios)**。

在不知不觉中，我已经下载了**GoogleMapsM4B.framework**并遇到了诸如“您的密钥可能对您的捆绑包 ID 无效：`com.company.example`”之类的问题

如果您想在您的项目中使用**GoogleMapsM4B.framework**，那么 1.您应该在企业支持门户（Google 的网站）上请求支持 2.您必须在 Google 的控制台网站中启用**Google Maps Mobile SDK for Work**而不是**Google Maps SDK for iOS 。**

如果您想使用**GoogleMaps.framework**而不是**GoogleMapsM4B** (Maps for Business)，那么您不需要请求支持中心，您只需要在 Google 的控制台网站中启用适用于 iOS 的 Google Maps SDK。

[您可以找到适用于 iOS 的 Google Maps SDK 和适用于 Work 的Google Maps Mobile SDK](https://developers.google.com/maps/documentation/business/mobile/ios/) (M4B)之间的主要区别。

并将 GoogleMaps/GoogleMaps.h 导入您的文件并将您的 api 密钥传递给以下方法：

```
[GMSServices provideAPIKey:@“Your API Key“]; 
```

（或者）

如果您有有效的许可证，则下载 GoogleMapsM4B.framework 并将 GoogleMapsM4B/GoogleMaps.h 导入您的文件并将 api 传递给相同的方法`[GMSServices provideAPIKey:@“Your API Key“]` ，但我想您可能只有在购买许可证后才能获得此密钥。

所以我面临的主要问题是......我没有下载**GoogleMaps.framework ，而是下载了****GoogleMapsM4B.framework**并添加到我的项目中。每次我运行我的项目时，它都会给我一个错误提示“您的密钥可能对您的捆绑 ID 无效：com.example.sampleapp”

现在我的项目工作正常。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-12-23T19:26:52.087

从另一个角度跟进：

在更高版本的 Google 地图框架中存在一个错误，如果应用程序在后台，则该错误会阻止地图被实例化/创建/添加到超级视图。

当您这样做时，生成的地图将显示为完全空白，而不是左下角的 Google 徽标。原因是操作系统不允许在后台进行 OpenGL 渲染。他们只需要在前景化后重新启动渲染器。

谷歌**终于**解决了这个问题（大约一年后），所以请升级到最新最好的。

如果您使用 Google for Business：

```
pod 'Google-Maps-iOS-SDK-for-Business', '~> 1.11.1' 
```

对于旧版本，[这里](https://github.com/iwasrobbed/OpenGLBug)有此问题的重现。

视觉再现：

[![OpenGL 错误](../Images/eab9c610ab202de9af732ddadac4d34a.png)](https://i.stack.imgur.com/x398N.gif)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-12-23T14:33:48.113

看起来您没有指定有效的 API 密钥。你是否有一个？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-06T16:28:40.947

此错误表示用于初始化 Google 地图的密钥无​​效：

```
[GMSServices provideAPIKey:@"YOUR_API_KEY"]; 
```

该密钥由 Google 专门为 iOS SDK 发布（显然只发给少数选定的）；Google Maps SDK v2 和 v3 的密钥不适用于 Apple。

确认错误确实是由无效键引起的一种方法是通过显示图钉。Pushpin 不需要有效的键，因此它将在空的地图视图对象上可见。从入门页面[https://developers.google.com/maps/documentation/ios/start#add_a_map](https://developers.google.com/maps/documentation/ios/start#add_a_map)对示例进行编码应该会导致应用程序显示一个空的地图视图（带有黄色背景和中心的图钉）。

确保 pin 可见的最佳方法是对相机和标记使用完全相同的坐标，请参见代码段：

```
GMSCameraPosition *camera = [GMSCameraPosition cameraWithLatitude:43.65
                                                        longitude:-79.45
                                                             zoom:6];

mapView_ = [GMSMapView mapWithFrame:CGRectZero camera:camera];

mapView_.myLocationEnabled = YES;
self.view = mapView_;

GMSMarkerOptions *markerOptions = [[GMSMarkerOptions alloc] init];
markerOptions.position = CLLocationCoordinate2DMake(43.65, -79.45);
markerOptions.title = @"Greater Toronto Area";

[mapView_ addMarkerWithOptions:markerOptions]; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-03-25T10:33:05.057

另一个抬头！确保您的应用程序包标识符与 Google API 控制台中“iOS 应用程序”字段中定义的包 ID 匹配。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-04-18T11:14:55.307

遇到了同样的问题。当然，一切都做对了。问题是您的 API 密钥**需要一些时间才能开始工作**（也许有关它的信息通过谷歌服务器传播，这意味着您最近的服务器尚不知道新的 API 密钥）。

因此，在 API 密钥创建错误停止后的大约 5 分钟内，我拥有了完全正常工作的 API 密钥。（注意，我没有收到任何来自谷歌的电子邮件）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-10-24T00:42:34.870

这帮助了我：（错误拼写 API 密钥，因为 XCode 最初返回错误，除非 API 被 {} [IOS - ObjC Google Maps Api Key](https://stackoverflow.com/questions/18558303/ios-objc-google-maps-api-key)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-01-20T12:39:30.040

我解决了这个问题如下。

1.  转到 Google Maps API 控制台（旧）。启用的服务是适用于 iOS 的 Google Maps SDK 和 Google Street View Image API。
2.  我已禁用 Google Street View Image API。
3.  然后，不再输出错误。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-05-12T07:13:18.843

对我来说，这是因为我的应用程序的包标识符已更改。在为新的捆绑标识符获取新的 API 密钥后，它再次开始工作。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-02-09T12:44:17.727

首先是让你的钥匙是正确的。然后检查您是否启用了适用于 iOS 的 Google Maps SDK。比在设备上运行应用程序，而不是在模拟器上运行。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-03-30T11:44:14.753

尽量不要将 API Key 保存在任何常量上。直接传值。如果它不起作用，请尝试重新生成 API 密钥映射肯定会起作用

```
MapServices.ProvideAPIKey ("AIzaSyAnxfhuAwEqdVhQpoUkGFZpsBukOSXVFr0"); 
```

快乐编码:)

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2012-12-23T06:11:47.567

现在苹果删除了**谷歌**地图并添加了**苹果**地图。

检查以下事项：

1.  减少地图视图中的缩放。

2.  使用什么版本的iOS？如果您使用的是 iOS 6，则谷歌地图无法使用 Apple 地图必须可以使用。

3.  有时模拟器不支持某些核心功能，请检查设备的功能。

4.  确保必须设置委托和数据源。

谢谢。

# performance - 弹性查询的性能

> ID：14007078
> 
> 赞同：3
> 
> 时间：2012-12-22T22:27:04.977
> 
> 标签：performance, caching, elasticsearch

每次执行此查询需要 200+ 毫秒：

```
{
  "filter": {
    "term": {
      "id": "123456",
      "_cache": true
    }
  }
} 
```

但是这个每次在第一次查询后执行只需要 2-3 毫秒：

```
{
  "query": {
    "filtered": {
      "query": {
        "match_all": {}
      },
      "filter": {
        "term": {
          "id": "123456"
        }
      }
    }
  }
} 
```

请注意两个查询中的相同 ID 值。看起来第二个查询使用了第一个查询的缓存结果。但是为什么第一个查询不能使用缓存结果本身呢？从第一个查询中删除`"_cache" : true`不会改变任何内容。

当我使用其他 ID 执行第二个查询时，第一次执行大约需要 40 毫秒，之后每次执行大约需要 2-3 毫秒。因此，第二个查询不仅运行速度更快，而且还缓存了结果并将缓存用于后续调用。

这一切有什么解释吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T03:14:43.727

The top-level `filter` element in the first request has very special function in Elasticsearch. It's used to filter search result without affecting facets. In order to avoid interfering with facets, this filter is applied during collection of results and not during searching, which causes its slow performance. Using top-level `filter` without facets makes very little sense because `filtered` and `constant_score` queries typically provide much better performance. If verbosity of `filtered` query with `match_all` bothers you, you can rewrite your second request into equivalent `constant_score` query:

```
{
  "query": {
    "constant_score": {
      "filter": {
        "term": {
          "id": "123456"
        }
      }
    }
  }
} 
```

# google-chrome-extension - Firebase + Chrome 内容安全策略设置？

> ID：14007080
> 
> 赞同：7
> 
> 时间：2012-12-22T22:27:39.863
> 
> 标签：google-chrome-extension, firebase, content-security-policy

我正在尝试在 Chrome 扩展背景页面中使用 Firebase，但它看起来正在执行内联脚本，由于安全问题，这是不允许的。

我目前已将 CSP 设置为：

```
{"content_security_policy": 
  "script-src 'self' https://cdn.firebase.com https://<my-subdomain>.firebaseio.com; object-src 'self'"} 
```

我能够加载初始 Firebase 脚本，但在调用 new Firebase('my-firebase-url') 时，出现以下错误：

> 拒绝执行内联脚本，因为它违反了以下内容安全策略指令：“。未捕获的 ReferenceError：未定义 pRTLPCB

Firebase 团队（或任何人）是否可以提供任何解决方法或建议，或者解释为什么内联执行脚本？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-23T04:19:02.000

在提出问题时，有一个错误阻止 Firebase 在 Chrome 扩展中工作，但现在已经修复。

正确的 CSP 是：

```
"content_security_policy": "script-src 'self' https://cdn.firebase.com https://*.firebaseio.com; object-src 'self'" 
```

（请注意，域中的通配符很重要，因为 Firebase 可能会在内部连接到其他子域。）

有关使用 Firebase 的示例 chrome 扩展，请参阅：[https](https://github.com/firebase/firebase-chrome-extension) ://github.com/firebase/firebase-chrome-extension 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T23:41:56.577

我有类似的问题；您会看到，Firebase 的构造函数似乎执行了一些 dom 操作以执行一些脚本（模糊，我知道），这会触发 Chrome CSP，因为您不应该这样做。

我什至试图通过[Sandbox Pages](http://developer.chrome.com/apps/sandboxingEval.html)包装构造函数，但没有成功（我得到一个 DOM ERR 18，即使我的清单具有所有权限）。如果您尝试在页面操作/浏览器操作的背景页面或弹出页面中执行此操作，也会发生同样的情况。

选择？您可以将 Firebase 作为内容脚本注入（从清单中执行），并通过[消息传递](http://developer.chrome.com/extensions/messaging.html)将回调作为 Chrome.extension.sendMessage 发送。我现在正在这样做，所以我可以告诉你到目前为止，至少 Firebase 构造函数是如何工作的。

解决方案？James Tampling 阅读并提示 Firebase 团队在此之后查找 :)

**更新：**将 Firebase.js 作为内容脚本注入也不起作用，但好消息是 Firebase 团队（联系 Andrew Lee）正在检查它。

**更新 2** Firebase 团队修复了它，现在它可以从弹出页面（在浏览器弹出窗口或页面操作之一中）工作。您需要在 manifest.json 中添加以下 CSP，但`"content_security_policy": "script-src 'self' 'unsafe-eval' https://cdn.firebase.com https://*.firebaseio.com https://*.firebaseio.com; object-src 'self'; "`之后它会产生奇迹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-10T07:32:01.193

我有一个 cordova js 应用程序，只有以下一个有效：

```
<meta http-equiv="Content-Security-Policy" content="

  default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval';
  script-src  'self' https://www.gstatic.com https://cdn.firebase.com https://*.firebaseio.com; object-src 'self';

  " /> 
```

希望这可以帮助。

# jquery - 表格中每一行的 jQuery .data()

> ID：14007083
> 
> 赞同：0
> 
> 时间：2012-12-22T22:28:13.897
> 
> 标签：jquery, html-table

```
success: function (output) {

    var obj = $.parseJSON(output);

    $("#existcustomers").empty();

    for (var iCnt = 0; iCnt < obj.length; iCnt++) {

        if (obj[iCnt].firstname == null) { obj[iCnt].firstname = ""; }
        if (obj[iCnt].lastname == null) { obj[iCnt].lastname = ""; }
        if (obj[iCnt].address1 == null) { obj[iCnt].address1 = ""; }
        if (obj[iCnt].address2 == null) { obj[iCnt].address2 = ""; }
        if (obj[iCnt].city == null) { obj[iCnt].city = ""; }
        if (obj[iCnt].state == null) { obj[iCnt].state = ""; }
        if (obj[iCnt].zip == null) { obj[iCnt].zip = ""; }
        if (obj[iCnt].phone == null) { obj[iCnt].phone = ""; }
        if (obj[iCnt].email == null) { obj[iCnt].email = ""; }
        if (obj[iCnt].cell == null) { obj[iCnt].cell = ""; }

        var newRow = $("<tr><td>" + obj[iCnt].firstname + "</td><td>" + obj[iCnt].lastname + "</td><td>" + obj[iCnt].address1 + "</td><td>" + obj[iCnt].address2 + "</td><td>" + obj[iCnt].city + "</td><td>" + obj[iCnt].state + "</td><td>" + obj[iCnt].zip + "</td><td>" + obj[iCnt].phone + "</td><td>" + obj[iCnt].email + "</td><td>" + obj[iCnt].cell + "</td></tr>");
        $("#existcustomers").append(newRow);
    }

    $("#existcustomers tr").hover(function () { $(this).addClass("highlight"); }, function () { $(this).removeClass("highlight"); });

    $("#existcustomers tr").click(function () {

        $("input#firstname").val($(this).children(":eq(0)").text());
        $("input#lastname").val($(this).children(":eq(1)").text());
        $("input#address1").val($(this).children(":eq(2)").text());
        $("input#address2").val($(this).children(":eq(3)").text());
        $("input#city").val($(this).children(":eq(4)").text());
        $("input#state").val($(this).children(":eq(5)").text());
        $("input#zip").val($(this).children(":eq(6)").text());
        $("input#phone").val($(this).children(":eq(7)").text());
        $("input#email").val($(this).children(":eq(8)").text());
        $("input#cell").val($(this).children(":eq(9)").text());

        $("input#firstname").attr('disabled', 'disabled');
        $("input#lastname").attr('disabled', 'disabled');
        $("input#address1").attr('disabled', 'disabled');
        $("input#address2").attr('disabled', 'disabled');
        $("input#city").attr('disabled', 'disabled');
        $("input#state").attr('disabled', 'disabled');
        $("input#zip").attr('disabled', 'disabled');
        $("input#phone").attr('disabled', 'disabled');
        $("input#email").attr('disabled', 'disabled');
        $("input#cell").attr('disabled', 'disabled');

        //Here a commit to session script for the current customer will
        // be aded. 

        //end 

        $('#form-main').css('background-color', 'green');
    });
} 
```

我有上面的代码，它是从 ajax 返回的。'obj' 中有一堆 JSON，我的代码循环遍历 JSON 的每个“行”，并使用 jQuery 将“行”数据通过`.append()`. 我想更进一步，用 .data() 存储每行 ID 的键值对。JSON 包含一个字段 ID，它是一个自动递增的主键。我正在尝试将 JSON 中的该字段存储在每一行中，`.data()`以便以后通过另一个调用“.ajax”来检索。我相信你们中的许多人会对如何实现目标有一个更好的心理图景，所以我的意思是得到一些建议。我希望没关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:41:53.413

您可以在创建时将数据添加到新行，如下所示

```
 var newRow = $("<tr>......</tr>").data('id',value); 
```

然后稍后访问它：

```
$("#existcustomers tr").click(function(){
   var rowId=$(this).data('id');

}) 
```

# django - 如何过滤相关对象？

> ID：14007089
> 
> 赞同：0
> 
> 时间：2012-12-22T22:28:39.550
> 
> 标签：django, django-models, django-orm

我有两个模型：

```
class Game(models.Model):
    title = models.CharField(max_length='255', blank=False, db_index=True)

class GameImage(models.Model):

    TYPES = (
        ('small_image', 'Small Image'),
        ('medium_image', 'Medium Image'),
        ('feature_image', 'Feature Image'),
        ('subfeature_image', 'Sub-feature Image'),
        ('sc1', 'Screenshot 1'),
        ('sc2', 'Screenshot 2'),
        ('sc3', 'Screenshot 3'),
    )

    game = models.ForeignKey("Game", related_name="images", editable=False)
    image = ImageField(upload_to=gameimage_storage_path, max_length=255)
    type = models.CharField(max_length=16, choices=TYPES, db_index=True) 
```

如果我做

```
games = Games.objects.prefetch_related('images').all() 
```

如果我这样做，它将附加所有“图像”相关对象：

```
games = Games.objects.prefetch_related('images').filter(images__type__contains='small_image').all() 
```

它将显示具有“small_image”类型图像的游戏，但仍会加载与游戏相关的所有 GameImage 对象。

如何加载游戏列表，其中每个游戏都只有类型='small_image' 的 GameImages 相关对象（它不会加载与游戏相关的其他 GameImage 对象）？我可以通过原始 sql 做到这一点，但如何通过 Django ORM 做到这一点？请帮忙。

**更新。** 这是我想通过 ORM 实现的 SQL 查询：

```
SELECT * FROM game g LEFT JOIN gameimage i ON g.id = i.game_id AND i.type = 'small_image'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T17:08:37.543

### 加入

```
GameImage.objects.filter(img_type='small_image').select_related('game') 
```

### 左加入游戏

```
from django.db.models import Q

GameImage.objects.filter(
    Q(img_type='small_image') | 
    Q(game__isnull=True)
).select_related('game') 
```

### 左加入游戏图片

```
Game.objects.filter(
    Q(images__img_type='small_image') |
    Q(id__isnull=True)
).select_related('images') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:20:05.630

所以你想要所有游戏，但想检查游戏是否有 small_image 而不加载额外的相关图像：

模型.py：

```
from django.core.exceptions import ObjectDoesNotExist

Class Game(models.Model):
    title = models.CharField(max_length='255', blank=False, db_index=True)

    def get_small_image(self):
        try:
            return self.images.get(type='small_image')
        except ObjectDoesNotExist:
            return None 
```

视图.py：

```
games = Game.objects.all()
for game in games:
    small_image = game.get_small_image()
    if small_image:
        print small_image.image.url
    else:
        print 'there is no small image for this game' 
```

# jquery - 打印表格中的行号

> ID：14007092
> 
> 赞同：0
> 
> 时间：2012-12-22T22:28:56.750
> 
> 标签：jquery

我试图在 20 行的表中打印 <tr> 行号。

我不太精通jQuery语法，但这基本上是我需要的

```
var rowIndex = 1;
// for each row increase rowIndex + 1
$('.tablerow').html(rowIndex) 
```

非常感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T22:31:05.590

您可以使用[`.each()`](http://api.jquery.com/jQuery.each/)循环遍历行。如果`.tablerow`是 tr 元素上的一个类，您可以像这样遍历每一行：

```
$('.tablerow').each(function (i) {
   $("td:first", this).html(i);
}); 
```

该示例将索引添加到每行的第一个 td 元素。

[**工作示例**](http://jsfiddle.net/bLVwJ/)

如果您不想将索引添加到第一个 td 元素，则可以使用该[`.eq()`](http://api.jquery.com/eq/)方法通过在 tr 元素（从零开始）中指定其索引来选择所需的任何 td。

```
$('.tablerow').each(function (i) {
   $("td", this).eq(2).html(i);
}); 
```

上面的示例将索引写入每行的第三个 td 元素。

[**工作示例**](http://jsfiddle.net/bLVwJ/1/)

**从一个开始：**

要从 1 而不是 0 开始，您所要做的就是在打印时将索引添加到索引中

```
$('.tablerow').each(function (i) {
   $("td:first", this).html(i + 1);
}); 
```

[**工作示例**](http://jsfiddle.net/bLVwJ/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:30:57.683

您可以使用`.each()`在集合中的每个项目上运行自定义函数。您没有向我们展示您的确切 HTML，因此我们不知道具体是哪个项目`.tablerow`。根据具体情况，这里有两个选项`.tablerow`：

假设`.tablerow`是你的`tr`：

```
$(".tablerow td:first").each(function(index) {
    $(this).html(index);
}); 
```

如果`.tablerow`已经是`td`每行中的第一个，那么它可以是这样的：

```
$(".tablerow").each(function(index) {
    $(this).html(index);
}); 
```

# android - 从服务启动服务

> ID：14007099
> 
> 赞同：0
> 
> 时间：2012-12-22T22:30:41.887
> 
> 标签：android, widget

我有一个由服务更新的小部件。`ImageButton`该服务还为小部件布局中的一个设置 OnClick 事件。我这样做的方法是设置一个应该打开服务的 PendingIntent。

但是，当我单击刷新按钮时，什么也没有发生。

```
public void setRefreshButton(Context context, RemoteViews views) {
    Intent widgetUpdateIntent = new Intent(context, UpdateService.class);
    PendingIntent pendingRefreshIntent = PendingIntent.getActivity(
            context, 0, widgetUpdateIntent, 0);
    }
    views.setOnClickPendingIntent(R.id.widget_button_refresh,
            pendingRefreshIntent);
} 
```

我在服务的第一行有一个日志`onStart()`，但它甚至没有出现在 LogCat 中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:32:51.943

您`PendingIntent`尝试启动一个`Activity`，而不是一个`Service`. 尝试使用`PendingIntent.getService`.

# c# - 如何在不同（但兼容）模型之间转换 lambda 表达式？

> ID：14007101
> 
> 赞同：18
> 
> 时间：2012-12-22T22:30:44.333
> 
> 标签：c#, .net, linq, expression

（基于电子邮件对话，现在记录用于信息共享）我在不同的层使用了两个模型：

```
public class TestDTO {
    public int CustomerID { get; set; }
}
//...
public class Test {
    public int CustomerID { get; set; }
} 
```

以及就我的 DTO 层而言的 lambda：

```
Expression<Func<TestDTO, bool>> fc1 =
   (TestDTO c1) => c1.CustomerID <= 100 && c1.CustomerID >= 10; 
```

如何将该 lambda（在一般情况下）转换为谈论另一个模型：

```
Expression<Func<Test, bool>> fc2 = {insert magic here, based on fc1} 
```

（显然，我们追求相同的测试条件，但使用`Test`类型）

?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-22T22:30:44.333

为此，您必须完全重建表达式树；参数将需要重新映射，并且现在与不同类型对话的所有成员访问都需要重新应用。幸运的是，这门课让很多事情变得更容易了`ExpressionVisitor`。例如（在一般情况下做这一切，而不仅仅是`Func<T,bool>`谓词用法）：

```
class TypeConversionVisitor : ExpressionVisitor
{
    private readonly Dictionary<Expression, Expression> parameterMap;

    public TypeConversionVisitor(
        Dictionary<Expression, Expression> parameterMap)
    {
        this.parameterMap = parameterMap;
    }

    protected override Expression VisitParameter(ParameterExpression node)
    {
        // re-map the parameter
        Expression found;
        if(!parameterMap.TryGetValue(node, out found))
            found = base.VisitParameter(node);
        return found;
    }
    protected override Expression VisitMember(MemberExpression node)
    {
        // re-perform any member-binding
        var expr = Visit(node.Expression);
        if (expr.Type != node.Type)
        {
            MemberInfo newMember = expr.Type.GetMember(node.Member.Name)
                                       .Single();
            return Expression.MakeMemberAccess(expr, newMember);
        }
        return base.VisitMember(node);
    }
} 
```

在这里，我们传入一个参数字典来重新映射，将其应用到`VisitParameter`. 我们还会在 in`VisitMember`中检查我们是否已经切换了类型（如果`Visit`涉及 a`ParameterExpression`或 another `MemberExpression`，随时可能发生这种情况）：如果有，我们将尝试找到另一个同名的成员。

接下来，我们需要一个通用的 lambda 转换重写器方法：

```
// allows extension to other signatures later...
private static Expression<TTo> ConvertImpl<TFrom, TTo>(Expression<TFrom> from)
    where TFrom : class
    where TTo : class
{
    // figure out which types are different in the function-signature
    var fromTypes = from.Type.GetGenericArguments();
    var toTypes = typeof(TTo).GetGenericArguments();
    if (fromTypes.Length != toTypes.Length)
        throw new NotSupportedException(
            "Incompatible lambda function-type signatures");
    Dictionary<Type, Type> typeMap = new Dictionary<Type,Type>();
    for (int i = 0; i < fromTypes.Length; i++)
    {
        if (fromTypes[i] != toTypes[i])
            typeMap[fromTypes[i]] = toTypes[i];
    }

    // re-map all parameters that involve different types
    Dictionary<Expression, Expression> parameterMap
        = new Dictionary<Expression, Expression>();
    ParameterExpression[] newParams =
        new ParameterExpression[from.Parameters.Count];
    for (int i = 0; i < newParams.Length; i++)
    {
        Type newType;
        if(typeMap.TryGetValue(from.Parameters[i].Type, out newType))
        {
            parameterMap[from.Parameters[i]] = newParams[i] =
                Expression.Parameter(newType, from.Parameters[i].Name);
        }
        else
        {
            newParams[i] = from.Parameters[i];
        }
    }

    // rebuild the lambda
    var body = new TypeConversionVisitor(parameterMap).Visit(from.Body);
    return Expression.Lambda<TTo>(body, newParams);
} 
```

这需要一个任意`Expression<TFrom>`的 和 a `TTo`，通过以下方式将其转换为 a `Expression<TTo>`：

*   `TFrom`找出/之间不同的类型`TTo`
*   使用它来重新映射参数
*   使用我们刚刚创建的表达式访问器
*   最后为所需的签名构造一个新的 lambda 表达式

然后，将它们放在一起并公开我们的扩展方法：

```
public static class Helpers {
    public static Expression<Func<TTo, bool>> Convert<TFrom, TTo>(
        this Expression<Func<TFrom, bool>> from)
    {
        return ConvertImpl<Func<TFrom, bool>, Func<TTo, bool>>(from);
    }

    // insert from above: ConvertImpl
    // insert from above: TypeConversionVisitor
} 
```

瞧！通用 lambda 转换例程，具有以下特定实现：

```
Expression<Func<Test, bool>> fc2 = fc1.Convert<TestDTO, Test>(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-22T22:43:58.610

您可以使用[AutoMapper](http://automapper.org/)（无表达式树）：

```
Mapper.CreateMap<Test, TestDTO>();

...

Func<TestDTO, bool> fc1 =
  (TestDTO c1) => c1.CustomerID <= 100 && c1.CustomerID >= 10;

Func<Test, bool> fc2 =
  (Test t) => fc1(Mapper.Map<Test, TestDTO>(t)); 
```

# eclipse - 如何为多个平台定义带有二进制组件的 OSGI/Eclipse 插件

> ID：14007108
> 
> 赞同：1
> 
> 时间：2012-12-22T22:31:07.013
> 
> 标签：eclipse, osgi, native-code, tycho, osgi-fragment

我创建了一个 Eclipse 插件，并且需要一个原生二进制文件来支持它的功能。我已经为 Win 和 Mac 准备好了本机代码。每个平台对native代码的调用是不同的，所以也有一些与native代码相关的插件代码。（实际上本机代码是 JNA 代码，确实非常不同。）目前我有一个扩展点，每个本机支持插件都在那里做出贡献。所以，只要有原生支持，主插件就可以工作了。此外，我对每个原生支持插件都有一个测试片段，用于对功能进行单元测试。

1.  我应该如何设置插件，以便每个人在从更新站点或 p2 存储库下载时都能获得正确的插件？（我注意到例如 SWT 使用片段作为本机代码，所以这是要走的路吗？）

**编辑**：按照答案将插件转换为片段后，我应该如何处理这些插件的单元测试片段？碎片的碎片是不可能的。

1.  如何在 Tycho 中进行设置，以便 Tycho build 运行适合当前平台的测试并忽略其他平台。

**编辑**：我有 Mac 和 Windows 本机代码，两个片段，因此在 pom.xml 中有两个环境。但是后来Tycho抱怨“插件x不能安装在这个环境中，因为它的过滤器不适用”，当然不是，任何时候只能激活Win/Mac中的一个。Tycho 可以自己解决这个问题，还是我需要依赖操作系统的 Maven 配置文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T10:18:48.087

是的，您需要将原生包打包成插件片段。每个片段都应指定平台过滤器，以确保每个平台只有一个片段有效。例如，在 Windows 64 位上，您需要指定 os=win32, ws=win32 arch=x86_64。

如果您的片段是功能的一部分，您还应该在功能定义中指定平台过滤器。

在 Tycho 下，您需要在 pom 文件的目标平台配置的[环境](http://wiki.eclipse.org/Tycho/Reference_Card#Target_runtime_environment)部分下指定所有支持的平台过滤器组合。

Tycho 总是在当前平台下运行测试。将您的片段添加到您的测试运行时 - 请参阅[此处](http://wiki.eclipse.org/Tycho/Packaging_Types#eclipse-test-plugin)，了解向 tycho 测试运行时添加依赖项。Tycho 经常需要帮助来识别要添加到测试运行时的片段。

# java - 仪表重新转换似乎不起作用

> ID：14007115
> 
> 赞同：1
> 
> 时间：2012-12-22T22:31:58.473
> 
> 标签：java, instrumentation, javassist

我只是在试验 Java Instrumentation，因为它非常有趣，我想了解更多。我将它与 javassist 库结合使用，以使字节码操作更容易，以及 JDK 安装中包含的“工具”库。

这是我的主要课程：

```
public class MainClass {
public static boolean first = true;
static{
    AgentClass.initialize();
}
public static void loadAgent(){
    String path = System.getProperty("user.dir") + "\\AgentJar.jar";
    String nameOfRunningVM = ManagementFactory.getRuntimeMXBean().getName();
    int p = nameOfRunningVM.indexOf('@');
    String pid = nameOfRunningVM.substring(0, p);

    try {
        VirtualMachine vm = VirtualMachine.attach(pid);
        vm.loadAgent(path, "");
        vm.detach();
    } catch (Exception e) {
        e.printStackTrace();
        throw new RuntimeException(e);
    }
}
public static void main(String[] args){
   System.out.println("First run-through, code should be modified once.");
    new Hello().hello();
            first = false;
    try {
        AgentClass.getInstrumentation().retransformClasses(Class.forName("test.Hello"));
    } catch (Exception e){
            e.printStackTrace();
    }
    System.out.println("Second run-through, code should be modified twice.");
    new Hello().hello();
}
} 
```

这是“你好”类：

```
public class Hello {
    public void hello(){
            System.out.println("Hello World!");
    }
} 
```

这是 FileTransformer 类：

```
public class FileTransformer implements ClassFileTransformer{
private static boolean first = true;
@Override
public byte[] transform(ClassLoader loader, String className,
        Class<?> classBeingRedefined, ProtectionDomain protectionDomain,
        byte[] classfileBuffer) throws IllegalClassFormatException {
    if (!className.contains("Hello"))
        return null;
    else{
        byte[] result;
        CtClass cc = null;
        try {
            cc = ClassPool.getDefault().get("test.Hello");
            CtMethod method = cc.getDeclaredMethod("hello");
            if (MainClass.first){
            System.out.println("In transformer: first");
            method.insertAfter("System.out.println(\"Modified First Time!\");");
            }else{
                System.out.println("In transformer: second");
                method.insertAfter("System.out.println(\"I modified it again.!\");");
            }
            cc.writeFile();
            result = cc.toBytecode();
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
        return result;
    }

}

} 
```

代理类在另一个 jar 中，它是它的基本实现：

```
public class AgentClass {
protected static Instrumentation inst;
private static boolean added = false;
public static void agentmain(String args, Instrumentation inst){
    AgentClass.inst = inst;
    if (!added)
        inst.addTransformer(new FileTransformer());
}
public static void premain(String args, Instrumentation inst){
    AgentClass.inst = inst;
    inst.addTransformer(new FileTransformer());
    added = true;
}
public static void initialize(){
    if (inst == null){
        MainClass.loadAgent();
    }
}
public static Instrumentation getInstrumentation(){
    return inst;
}
} 
```

当我运行时，我没有遇到任何错误。但是，输出不是我期望的那样。

这是我得到的输出：

```
First run-through, code should be modified once.
In transformer: first
Hello World!
Modified First Time!
Second run-through, code should be modified twice.
Hello World!
Modified First Time! 
```

您可能会注意到没有一行写着“我再次修改了它！”

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-08T11:50:36.440

不确定这里是否还有其他问题，但是如果要重新转换类，则需要使用允许您指定转换*器可以*重新转换的方法注册 ClassFileTransformer 。IE

如果你打电话给仪器。[addTransformer(ClassFileTraIsformer)](http://docs.oracle.com/javase/6/docs/api/java/lang/instrument/Instrumentation.html#addTransformer%28java.lang.instrument.ClassFileTransformer%29)，那么您是在声明转换器**不**支持重新转换。

您需要调用仪器。[addTransformer(ClassFileTraIsformer, true)](http://docs.oracle.com/javase/6/docs/api/java/lang/instrument/Instrumentation.html#addTransformer%28java.lang.instrument.ClassFileTransformer,%20boolean%29)这将使您的变压器启动。

# scheduled-tasks - 报警代码在后台任务中引发无效操作异常

> ID：14007118
> 
> 赞同：0
> 
> 时间：2012-12-22T22:32:29.820
> 
> 标签：scheduled-tasks, windows-phone, alarm

在我的 windows phone 8 应用程序中，我使用 ScheduledTaskAgent 按计划执行一些代码。在任务代码期间，我在开始时立即运行警报。我正在使用下面的代码来做警报

```
Alarm alarm = new Alarm("Test Alarm");
alarm.Content = "My Test alarm";
alarm.BeginTime = DateTime.Now.AddSeconds(2);
alarm.ExpirationTime = alarm.BeginTime.AddSeconds(5);
alarm.RecurrenceType = RecurrenceInterval.None;
alarm.Sound = new Uri("/Assets/Beep.wav", UriKind.RelativeOrAbsolute);

// Add the reminder to the ScheduledActionService 
ScheduledActionService.Add(alarm); 
```

在 scheduleactionservice 添加位置，我得到以下异常：

System.InvalidOperationException：BNS 错误：API 只能从前台应用程序调用。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:55:56.443

您不能从后台代理添加计划任务，只能从应用程序本身添加。您需要从您的 UI 代码中安排警报。

# python - Python UTF8 编码与阿拉伯语

> ID：14007121
> 
> 赞同：3
> 
> 时间：2012-12-22T22:33:06.483
> 
> 标签：python, django, utf-8

我有一个编码问题，当我尝试抓取 youtube（阿拉伯语频道）时：

```
#!/usr/bin/python
# -*- coding: utf8 -*- 
from django.core.management.base import BaseCommand, CommandError
import requests, lxml, re
from lxml import html

class Command(BaseCommand):
    def handle(self, *args, **options):
        r = requests.get("https://www.youtube.com/user/aljazeerachannel/videos?view=0")
        root = lxml.html.fromstring(r.content)

        for data in root.xpath('.//*[@id="branded-page-body"]/div/div/div[1]/div/div[2]/ul/li[1]/span/span/a'):
            print data.text 
```

结果是：

```
[root@vmi9105 buzzbal]# python manage.py youtube

        Ø§ÙØªØ®Ø§Ø¨Ø§Øª Ø§ÙÙØ¬Ø§ÙØ³ Ø§ÙØ¨ÙØ¯ÙØ© ÙÙ Ø³ÙØ·ÙØ© Ø¹ÙÙØ§Ù 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2021-07-30T19:49:50.830

试试这个它解决了我在 python 中的问题：

```
f"{yourString}".encode('latin-1').decode("utf-8") 
```

# ruby-on-rails - 在 rails3 中处理时区

> ID：14007122
> 
> 赞同：0
> 
> 时间：2012-12-22T22:33:10.570
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个 Rails 应用程序，我通过表单从用户那里获取日期和时间，这些都存储在模型中，然后显示给用户。

我位于UTC+2。

当我不以任何方式与时区相关时，我从用户那里得到的时间会稍后显示回来一个 +2 小时的偏移量。

为了保持一致，我必须在什么阶段关联/设置时区？

**更新**

即使在阅读了这篇文章后，我仍然在为此苦苦挣扎。
例如，当用户`20.00`从视图中的下拉菜单输入时，此时已经是本地时间。添加`Zone`到用于转换的日期会增加额外的两个小时（应该已经包括在内）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T19:51:28.173

我认为您必须在 config/application.rb 中将默认时区更改为您的，但首先检查您的时区名称：

```
rake time:zones:all 
```

# asp.net - 隐藏 Div 中的 ASP.NET 表单不起作用

> ID：14007123
> 
> 赞同：1
> 
> 时间：2012-12-22T22:33:14.080
> 
> 标签：asp.net

我在一个隐藏的 DIV 中有一个登录表单`display:none;`，当我单击其他 DIV 时，这个 DIV 使用 CSS 隐藏，我使用 jquery 显示这个 DIV `.slideDown()`，所以我可以使用这个表单。

当我单击按钮时，`OnClick="Login"`它似乎不起作用，当我将此表单从这个隐藏的 div 中删除到身体的另一个位置时，它起作用了。有什么问题？

**ASP.NET：**

```
<div id="userCPContainer">
<form id="loginForm" runat="server">
    <asp:Label ID="Label1" runat="server" Text="Username" class="loginLabels"></asp:Label>
    <br />
    <asp:TextBox ID="usernameField" runat="server" MaxLength="50" class="loginFields"></asp:TextBox>
    <asp:Label ID="Label2" runat="server" Text="Password" class="loginLabels"></asp:Label>
    <br />
    <asp:TextBox ID="passwordField" runat="server" MaxLength="50" 
        TextMode="Password" class="loginFields"></asp:TextBox>

    <asp:Button ID="loginButton" runat="server" Text="Log in" onclick="Loginn" class="loginButton"/>
</form>
</div> 
```

**查询：**

```
function showUserCP() {

    $("#userCPContainer").slideDown(200);
    $(".userCPDiv").css("background-color", "#000000");
    $(".userCPDiv").css("border-color", "#000000");
}

function hideUserCP() {
    $(".userCPDiv").css("background-color", "rgb(43, 147, 206)");
    $(".userCPDiv").css("border-color", "rgb(43, 147, 206)");
    $("#userCPContainer").slideUp(200);

}

$(".userCPDiv").click(function (e) {
        //Either way, hide Main Menu
        hideMainMenu();
        if ($("#userCPContainer").is(":visible")) {
            hideUserCP();
        }
        else {
            showUserCP();
        }
        e.stopPropagation();

    }); 
```

**CSS：**

```
#userCPContainer
{
    overflow:hidden;
    border-style:solid;
    border-top-style:none;
    border-color:rgb(43,147,206);
    border-width:2px;
    position:absolute;
    right:0px;
    top:0px;
    display:none;
    z-index:1;
    width:300px;
    background-color:  #000000;
} 
```

没有什么复杂的...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T05:09:22.367

当您使用 CSS 时`display: none;`，问题是 DIV 内部的所有内容都会从 HTML 文档中完全删除，这会导致 ASP.NET 在您通过 jQuery 显示该元素时无法识别它。我看到了可能的解决方案：

1.  使用`visibility: hidden`而不是`display: none;`，如果这样做，您可能会在 DIV 高度方面遇到一些问题，因为它会占用渲染所需的空间，但它不可见。
2.  使用 a`ScriptManager`和 an`UpdatePanel`并将 div 和表单放在这些元素中，这样服务器就会知道您何时在客户端呈现 Button。另外，请确保您在`ScriptManager`

希望这可以帮助你

# jquery - 我的 jquery 片段中需要一个循环

> ID：14007125
> 
> 赞同：0
> 
> 时间：2012-12-22T22:33:52.810
> 
> 标签：jquery, html

我需要此代码在执行后再次运行`$('.mp3').show();`。

```
$('.mp3').click(function() {
    $(this).toggle(function() {
        $('object').remove();
        $('.mp3-0').show();
    });
});

$('.mp3-0').click(function() {
    $(this).toggle(function() {
        $('#mp3obj').replaceWith('<object width="0" height="0"> <param name="src" value="musicasite.mp3"> <param name="autoplay" value="false"> <param name="controller" value="true"> <param name="bgcolor" value="#FFFFFF"> <embed src="musicasite.mp3" autostart="false" loop="false" width="0" height="0" controller="true" bgcolor="#FFFFFF"></embed> </object>');
        $('.mp3').show();
    });
});​ 
```

这整个片段为我做的是当用户请求时从网站上删除一首歌曲，但如果这个用户想要它，那么音乐会再次播放。

但是，在代码运行了这么长时间之后，它就停止了工作。

我需要的是：需要将整个 HTML 文件设置为单击按钮并运行代码之前的状态。

- - - 编辑 - - -

可以在这里看到一个例子：http: [//dev.webtoad.com.br/toquedemagica/2012/](http://dev.webtoad.com.br/toquedemagica/2012/)
该页面是巴西葡萄牙语，但如果你点击“Parar música”和“Tocar música”，你可以看到我有什么迄今取得。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T01:08:32.583

你犯了两个大错误：

**1.**您没有使用向右切换。您只想切换按钮可见性而不是按钮行为。那应该是`$(this).toggle()`切换功能之外的其余操作。当您认为单击两个不同的按钮时，使用切换甚至没有多大意义，因为它可能会让您陷入意外的显示/隐藏行为。

**2.**在`.mp3-0`单击（第二次单击）上，您要（重新）将`<object>`您在上一次单击中删除的内容添加回内部`#mp3obj`，而不是替换它。这就是代码只运行 3 次点击的原因；

STOP - 删除`<object>`.

START - 替换`#mp3obj`为`<object>`.

停止 -`<object>`再次删除。

开始 - ...找不到`#mp3obj`替换`<object>`（你替换了它！） -*功能停止工作......*

试试这个：

```
$('.mp3').click(function() {
    $(this).hide();
    $('object').remove();
    $('.mp3-0').show();
});

$('.mp3-0').click(function() {
    $(this).hide();
    $('#mp3obj').html('<object width="0" height="0"> <param name="src" value="musicasite.mp3"> <param name="autoplay" value="false"> <param name="controller" value="true"> <param name="bgcolor" value="#FFFFFF"> <embed src="musicasite.mp3" autostart="false" loop="false" width="0" height="0" controller="true" bgcolor="#FFFFFF"></embed> </object>');
    $('.mp3').show();
});​ 
```

# node.js - node.js如何保护文件？

> ID：14007126
> 
> 赞同：-1
> 
> 时间：2012-12-22T22:34:01.717
> 
> 标签：node.js

我有个问题。

保护node.js javascript文件（由服务器而不是客户端运行的文件）的方法是什么。我不希望它们以任何方式对公众可见。

有任何想法吗？权限，身份验证，加密？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T22:35:34.683

客户端无法直接访问在服务器上运行的文件。这应该是足够的保护。客户端永远不能直接访问服务器端脚本，只能访问它们产生的结果，这些结果会发送到他们的浏览器（或他们用来查询服务器的任何东西）。所以你真的不应该担心你的服务器上由 node.js 运行的 javascript 文件。

# jquery - 在 jQuery fullcalendar 月视图上自定义内容

> ID：14007129
> 
> 赞同：0
> 
> 时间：2012-12-22T22:34:52.543
> 
> 标签：jquery, fullcalendar

我正在尝试为我的 android 每日 rom 构建做一个总结。并且构建结果将是“通过”或“失败”

所以我对“通过”和“失败”事件使用不同的颜色和类名，一天内可以有大约 24 个事件（构建），一些是“通过”事件，一些是“失败”事件。

在全日历月视图中，它显示了当天所有事件的标题。我想自定义每日广场内容如下：

```
Fail:4
Pass:22 
```

有什么办法可以做到这一点？非常感谢 ：-）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T09:27:32.580

这不是您想要实现的简单任务。不幸的是，fullcalendar 默认不支持事件分组。

您应该编写自己的解决方案。如果您问我，解决方案是计算“通过”类和“失败”类的对象数量，然后创建新事件并在月视图中用分组事件替换事件。确保将所有事件保存在某处，因为当用户再次单击周视图或日视图时，他/她应该再次看到所有未分组的事件。

这里有几个可能有用的链接： 这个属性告诉你当前 jQuery 选择器中有多少对象：

[http://api.jquery.com/length/](http://api.jquery.com/length/)

例如

```
console.log($(".pass").length); 
```

其他用户一直在尝试实现相同的功能：

[http://code.google.com/p/fullcalendar/issues/detail?id=859](http://code.google.com/p/fullcalendar/issues/detail?id=859)

我也找到了这个答案，但还没有测试出来：

[https://stackoverflow.com/a/3815877/336806](https://stackoverflow.com/a/3815877/336806)

# javascript - 遍历堆栈时javascript中的变量范围

> ID：14007130
> 
> 赞同：-3
> 
> 时间：2012-12-22T22:34:57.990
> 
> 标签：javascript, scope

我很困惑。有人可以向我解释为什么这会产生无限循环吗？

```
var constant = 4;
var stack = new Array();
stack.push(0);
stack.push(1);
loop1();

function loop1(){    
    for(i = 0; i < constant; i++){
        loop2(i);
    }
}

function loop2(num){
    for(i = 0; i < stack.length; i++){
        console.log(i); 
    }
} 
```

​ 小提琴：http: [//jsfiddle.net/elclanrs/tywV9](http://jsfiddle.net/elclanrs/tywV9)

我怀疑它与 Javascript 函数级变量范围有关，但据我的猜测。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:16:35.510

当您不使用`var`关键字声明变量时，该变量是全局的，因此`loop2`使用`loop1`相同的（全局）`i`变量。每次`loop2`调用时，`i`设置为 0，然后递增到`stack.length`，即 2。这意味着每次迭代都`loop1`将以 结束`i=2`，递增到 3，但永远不会达到`constant`4。

如果您将 for 循环更改为`for (var i = 0; ...)`，`for (i = 0; ...)`那么这应该不再无限循环。

# c# - 线程通信

> ID：14007133
> 
> 赞同：2
> 
> 时间：2012-12-22T22:35:10.050
> 
> 标签：c#, multithreading

我有一个带有文本框和按钮的表单。单击按钮时，我正在创建一个线程并为某些操作调用它。一旦线程完成调用的任务，我想用结果更新文本框。

任何人请帮助我如何在没有线程冲突的情况下实现这一目标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:37:35.520

`Task`使用 .NET 4.0 的类要简单得多：

```
private void button_Click(object sender, EventArgs e)
{
    Task.Factory.StartNew( () => 
    {
         return DoSomeOperation();
    }).ContinueWith(t =>
    {
         var result = t.Result;
         this.textBox.Text = result.ToString(); // Set your text box
    }, TaskScheduler.FromCurrentSynchronizationContext());
} 
```

如果您使用的是 .NET 4.5，则可以使用新的异步支持进一步简化此操作：

```
private async void button_Click(object sender, EventArgs e)
{
    var result = await Task.Run( () => 
    {
         // This runs on a ThreadPool thread 
         return DoSomeOperation();
    });

    this.textBox.Text = result.ToString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:38:16.010

您需要使用[`Control.Invoke`](http://msdn.microsoft.com/en-us/library/zyzhdc6b.aspx)它自己的线程来操作您的表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T22:38:44.110

简单地说，在线程操作结束时：

```
/// ... your code here
string newText = ...

textBox.Invoke((MethodInvoker) delegate {
    textBox.Text = newText;
}); 
```

该`Control.Invoke`用法使用消息队列将工作交给 UI 线程，因此执行该`textBox.Text = newText;`行的是 UI 线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T22:39:16.563

使用 a `BackgroundWorker`，将任务分配给`DoWork`事件，并使用事件更新文本框`RunWorkerCompleted`。然后您可以使用 启动任务`RunWorkerAsync()`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T22:39:38.460

您可以使用此处显示的解决方案：

[如何从 C# 中的另一个线程更新 GUI？](https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c)

下次问之前先搜索一下。

# python - Python打印跳过参数

> ID：14007135
> 
> 赞同：1
> 
> 时间：2012-12-22T22:35:19.657
> 
> 标签：python, parameters

我有这段肮脏的短代码打印格式化的日期：

```
print '%f %d' % math.modf(time.time()) 
```

现在 modf 方法返回两个参数，所以 print 函数需要两个参数。为了纯粹这样做，而不是将输出单独放在变量中的简单替代方法；是否有任何现有的方法可以在打印中排除参数，或者有什么方法可以调用特定的参数索引？

例如，我在打印中有 3 个参数：

```
print '%s %d.%f' % 'Money',19,.99 
```

我想跳过解析的第一个字符串参数。有没有办法做到这一点？

这主要是一个想知道是否可能的问题，无需提供替代解决方案：P。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:39:47.167

不在“老派”字符串格式中。

但是`format`strings的方法确实有这个能力。

```
print "{1}".format ("1","2") 
```

以上将跳过“1”，只会打印“2”。

我希望你不介意我给了一个替代方案，尽管你没有要求 :)

# javascript - jQuery load() 不起作用

> ID：14007139
> 
> 赞同：0
> 
> 时间：2012-12-22T22:36:33.287
> 
> 标签：javascript, jquery

我对加载事件的问题是，当我测试页面时它不起作用（不要隐藏预加载器图像），但是当我将函数放在 .ready() 中时，函数会起作用（它隐藏）。

这是代码：

**JAVASCRIPT：**

```
$(document).load(function(){
    $("#loaderHolder").hide("fast");
});
$(document).ready(function(){
    $('#slider').cycle();
    $('.sf-menu').superfish({
        autoArrows: false
    });
    $('.scroll').slimScroll({
        height: '590px',
        wheelStep:5,
        size:'15px',
        width:'590px',
        position: 'left',
        railColor:'#c5c5c5',
        color:'#a2a1a1',
        railVisible:true,
        alwaysVisible:true,
        distance: '565px'
    });
    $('.scroll').css('width','550px');
    $('.gallery').colorbox();
    $('#gallery img').hover(function(){ $(this).fadeTo(500, 0.3)}, function(){$(this).stop().fadeTo(500, 1)})
    $("#home-link").click(function(){
        if ($(".active").length == 0)
        {
            return ;
        }
        else
        {
            var active = $(".active");
            active.css("display","inline-block");
            active.hide("slide",{},700);
            active.attr("class","vanished");

        }
    });
    $("#about-link").click(function(){
        if ($(".active").length == 0)
        {
            var hidden = $("#about");

            hidden.show("slide",{},700);
            hidden.attr("class","active");
        }
        else
        {
            if ($("#about").attr("class") == "active")
            {
                return ;
            }
            else
            {
                var active = $(".active");
                active.css("display","inline-block");
                active.hide("slide",{},700);
                active.attr("class","vanished");
                var hidden = $("#about");

                hidden.show("slide",{},700);
                hidden.attr("class","active");
            }

        }
    })
    $("#starters-link").click(function(){
        if ($(".active").length == 0)
        {
            var hidden = $("#starters");

            hidden.show("slide",{},700);
            hidden.attr("class","active");
        }
        else
        {
            if ($("#starters").attr("class") == "active")
            {
                return ;
            }
            else
            {
                var active = $(".active");
                active.css("display","inline-block");
                active.hide("slide",{},700);
                active.attr("class","vanished");
                var hidden = $("#starters");
                hidden.show("slide",{},700);
                hidden.attr("class","active");
            }

        }
    })
    $("#gallery-link").click(function(){
        if ($(".active").length == 0)
        {
            var hidden = $("#gallery");

            hidden.show("slide",{},700);
            hidden.attr("class","active");
        }
        else
        {
            if ($("#gallery").attr("class") == "active")
            {
                return ;
            }
            else
            {
                var active = $(".active");
                active.css("display","inline-block");
                active.hide("slide",{},700);
                active.attr("class","vanished");
                var hidden = $("#gallery");
                hidden.show("slide",{},700);
                hidden.attr("class","active");
            }

        }
    })
    $("#contacts-link").click(function(){
        if ($(".active").length == 0)
        {
            var hidden = $("#contacts");

            hidden.show("slide",{},700);
            hidden.attr("class","active");
        }
        else
        {
            if ($("#contacts").attr("class") == "active")
            {
                return ;
            }
            else
            {
                var active = $(".active");
                active.css("display","inline-block");
                active.hide("slide",{},700);
                active.attr("class","vanished");
                var hidden = $("#contacts");
                hidden.show("slide",{},700);
                hidden.attr("class","active");
            }

        }
    })
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:39:20.333

尝试：

```
$(window).load 
```

代替

```
$(document).load 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:40:46.640

尝试 $(window).load() 而不是 $(document).load()

```
$(window).load(function () {
  // run code
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T22:44:31.497

我认为 $.load 是实际上在给定 url（第一个参数）上执行 AJAX 请求的方法。如果你想对 document.load 事件做一些事情，你必须使用 $(document).ready()

# controller - 如何在 ZF2 中扩展控制器？

> ID：14007143
> 
> 赞同：0
> 
> 时间：2012-12-22T22:37:12.400
> 
> 标签：controller, zend-framework2, extends

我想通过`ParentController`为每个模块分别指定的不同 s 来扩展我的所有控制器。

而且我不知道，在哪里放置扩展控制器，以及在顶级控制器中写什么。

我想做这样的事情：

**`module/Application/src/Application/Controller/IndexController.php`**

```
namespace Application\Controller;

use Application\Controller\ApplicationHeadController;

class IndexController extends ApplicationHeadController {

    public function indexAction() {

    }

} 
```

**`module/Application/src/Application/ApplicationHeadController`**

```
namespace Application\Controller;

use Zend\Mvc\Controller\AbstractActionController;

class ApplicationHeadController extends AbstractActionController {

    public function init() {
        parent::init();

        // some common code for every controller in this module
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T08:18:03.953

我同意亚历克斯的观点：尽量不要对这类任务使用重载。重载（即使用（抽象）类并用您的特定控制器扩展它们）会在以后产生困难。

例如，如果将来一个控制器不应该执行该公共代码怎么办？您需要使用构造函数中的标志或更丑陋的东西创建逻辑来禁用该公共代码的执行。或者，如果您想创建一个 REST 接口并且一个控制器必须扩展`AbstractRestfulController`而不是`AbstractActionController`?

Zend Framework 2 提供了钩子，您可以在其中更灵活地完成此类工作。“监听器”就是触发“事件”的钩子。控制器发出几个事件，您可以在模块类中收听这些事件。其中之一是“dispatch”，它在您的`fooAction()`方法运行时调用。

```
namespace MyModule;

class Module
{
    public function onBootstrap($e)
    {
        $app = $e->getApplication();
        $em  = $app->getEventManager()->getSharedManager();

        $em->attach('MyModule', 'dispatch', function($e) {
            $controller = $e->getTarget();

            // Here your common code
        });
    }
} 
```

您收听来自 的`dispatch`事件组中的事件`MyModule`。您可以阅读[有关事件管理器](http://framework.zend.com/manual/2.0/en/modules/zend.event-manager.event-manager.html)和[模块类的](http://framework.zend.com/manual/2.0/en/modules/zend.module-manager.module-class.html#the-mvc-bootstrap-event)更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:17:18.047

为什么这么复杂？

```
class A 
{
    public function __construct()
    {
        $this->doSomeFancyStuff();  
    }
}

class B extends A
{
    public function __construct()
    {
        parent::__construct();
        $this->doMoreFancyStuffInChildClassOnly();
    }
} 
```

如果你不需要这样做，`doMoreFancyStuffInChildClassOnly()`那么你不需要覆盖函数，甚至不需要调用`parent::__construct()`，因为它是自动发生的。阅读[PHP5 OOP-Constructs的基础知识](http://php.net/manual/language.oop5.decon.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T00:05:13.447

我想在这种情况下最好使用调度侦听器。你也可以看看[马修的文章](http://mwop.net/blog/2012-07-30-the-new-init.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T10:55:23.527

如果您使用的是 php 5.4，则可能是您所追求的特征。它具有 Sam 的答案的简单性，没有 Jurian 指出的可能问题。

见： http: [//php.net/manual/en/language.oop5.traits.php](http://php.net/manual/en/language.oop5.traits.php)

（注意：特质也有其弱点，特别是如果你开始大量使用它们，但对于正确的工作，它们可能是正确的工具）

# facebook - Facebook：为好友信息请求返回“500（内部服务器错误）”

> ID：14007144
> 
> 赞同：2
> 
> 时间：2012-12-22T22:37:15.663
> 
> 标签：facebook, facebook-graph-api

我已经在我这边和应用程序的权限页面上设置了以下权限：（
注意“read_stream”）

```
<fb:login-button autologoutlink="true" perms="read_stream, user_about_me, user_likes, user_location, user_birthday, user_education_history, user_work_history, friends_about_me, friends_likes, friends_location, friends_birthday, friends_education_history, friends_work_history"></fb:login-button> 
```

请求用户的个人资料效果很好：

```
FB.api('/me/friends', {
            fields: "id,username,name,first_name,last_name,location,link,education,work,statuses.limit(1).fields(message)"
        }, function(res){
            console.log('FRIENDS', res.data);
        }); 
```

但是，为用户的朋友获取相同的信息是行不通的。
它给出“500（内部服务器错误）”，facebook 对象返回“未知错误”。

```
FB.api('/me/friends', {
            fields: "id,username,name,first_name,last_name,location,link,education,work,statuses.limit(1).fields(message)"
        }, function(res){
            console.log('FRIENDS', res.data);
        }); 
```

我已将问题追溯到我请求的字段。该部分`statuses.limit(1).fields(message)`似乎是错误的来源，当删除`/me/friends`返回数据时。
但我不明白错误的原因。

1.  它适用于`/me`.

2.  根据 FB 文档`read_steam`应该同时针对用户的状态和用户的朋友的状态。

3.  使用上述字段，API Explorer 可以毫无问题地让我获得朋友状态。

我做错了什么还是 FB Graph API 错误？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T19:28:19.530

在这里试试这个：

```
$user = $facebook->getUser();
if ($user){ 
           try {
                $queries = array(
                             array('method' => 'GET', 'relative_url' => '/'.$user),
                             array('method' => 'GET', 'relative_url' => '/'.$user.'/friends', 'name' =>  'get-friends'),
                             array('method' => 'GET','relative_url'  => '?ids={result=get-friends:$.data.*.id}'),
                            );

                            // POST your queries to the batch endpoint on the graph.
                            try{
                                $batchResponse = $facebook->api('?batch='.json_encode($queries), 'POST');
                            }catch(Exception $o){
                                    error_log($o);
                            }
                          } 
                        catch (FacebookApiException $e) {
                            error_log($e); //Checks if user is logged out and generate an exception if access token is invalid
                        }
                     }
                     else{
                            $params = array(
                                  'scope' => 'friends_birthday, friends_education_history, read_stream, read_friendlists, user_birthday,   //Requesting User Permissions through Facebook App
                                  'redirect_uri' => 'specify yours here' //User is redirected after Login
                                );

                        } 
 $user_details = json_decode($batchResponse[0]['body'], true);// User Own Info
 $user_friends = json_decode($batchResponse[2]['body'], true);// User's Firend Info 
```

你会得到一个数组对象。

或者您可以在这里使用 FQL：

```
$friends = $facebook->api(array(
                                        'method' => 'fql.query',
                                        'query' => 'SELECT name, pic_big 
                                             FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me())'
                                    )); 
```

[https://developers.facebook.com/docs/reference/fql/friend/](https://developers.facebook.com/docs/reference/fql/friend/)

我正在做类似的事情，在这里：[http ://agbcorplegal.com/profile_filter/](http://agbcorplegal.com/profile_filter/)

# c - “节点”的奇怪行为

> ID：14007149
> 
> 赞同：0
> 
> 时间：2012-12-22T22:38:04.053
> 
> 标签：c, malloc

我很困惑！尝试创建动态链表并希望通过“malloc”函数分配标题。从我下面的代码编译器给出2个错误：

**in main:** [Error] `node' undeclared (first use in this function) and **In function`newnode':** [Error] `node' undeclared (第一次在这个函数中使用)

```
#include <stdio.h>
#include <stdlib.h>

struct node{
    int a,b,c,d;
    struct node *next;
};

struct node * newnode(int, int, int, int);

int main(){
    struct node *header;
    header=(struct node *)malloc(sizeof(node));
    int a,b,c,d;
    a=11;
    b=2;
    c=4;
    d=5;
    header->next=newnode(a,b,c,d);
    printf("\n\n");
    system("PAUSE");
    return 0;
}

struct node * newnode(int aa, int bb, int cc, int dd)
{
    struct node *temp;
    temp=(struct node*)malloc(sizeof(node));
    temp->a =aa;
    temp->b =bb;
    temp->c =cc;
    temp->d =dd;
    temp->next=NULL;
    return temp;
} 
```

我很感激任何建议！谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:41:06.660

没有类型`node`。您有类型`struct node`，这就是您需要传递给`sizeof`操作员的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:45:12.560

首先，正如@icepack 已经指出的那样，该类型被命名为`struct node`，而不是`node`。所以，`sizeof(node)`不编译。除了`struct node`带有`sizeof`.

其次，考虑使用

```
T *p = malloc(n * sizeof *p); /* to allocate an array of n elements */ 
```

内存分配的成语。例如在你的情况下

```
temp = malloc(sizeof *temp); 
```

即不要强制转换结果`malloc`并且更喜欢使用`sizeof`with*表达式*，而不是类型名称。类型名称属于声明。其余代码应尽可能与类型无关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T22:46:33.653

正如前面的答案所提到的，您必须`struct node`在引用您的结构时使用。

但是，如果您只想使用声明性名称节点，您可以执行以下操作：

```
typedef struct _node{
    int a,b,c,d;
    struct _node *next;
}  node; 
```

在这里你不需要`struct`在引用之前使用`node`

编辑：错误的语法

# c++ - 为什么我的 C++ 程序中有无限循环？

> ID：14007150
> 
> 赞同：2
> 
> 时间：2012-12-22T22:38:05.410
> 
> 标签：c++, recursion

我想制作一个单向列表，但我不知道为什么会出现无限循环。问题出在 clearList() 方法中

```
class List
{
private:
  Document document;
  List* nextPtr;
public:
  List()
    :document(), nextPtr(NULL)
  {
    cout << "class List: CONSTRUCTOR (default)\n";
  }

  List(const Document& d)
    :nextPtr(NULL)
  {
    cout << "class List: CONSTRUCTOR (init)\n";
    document = d;
  }

  ~List()
  {
    cout << "class List: DESTRUCTOR\n";
    freeList(this);
  }

  void freeList(List* top)
  {
    if(top != NULL)
      freeList(top->nextPtr);
    delete top;
  }
}; 
```

这是主程序：

```
int main()
{
  List list1;

  return 0;
} 
```

这就是我所拥有的

![在此处输入图像描述](../Images/83f1d35d9c431fdd37f7095f8efa79c2.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T22:44:08.363

当您的`List`对象被销毁时，析构函数将调用`freeList`which will do `delete top`where `top`is `this`，导致自身再次被销毁。然后析构函数将再次调用`freeList`，依此类推。

似乎真的你只想要一个析构函数来做到这一点：

```
~List()
{
  cout << "class List: DESTRUCTOR\n";
  delete nextPtr;
} 
```

`delete`of将`nextPtr`调用 next`List`的析构函数，这将是`delete`其 next`List`的指针，依此类推。`nextPtr`这将在is`NULL`因为`delete NULL;`没有效果时停止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T22:45:22.950

您的`destructor`呼叫`freeList`，然后呼叫`delete`，这将呼叫您的`destructor`。这将是糟糕的结局！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T22:43:04.220

您正在删除一个已经超出范围的对象。

也就是说，`~List()`调用`freeList`with `this`，这`delete`会导致`~List()`再次调用。

您不应该删除堆栈分配的对象。

# algorithm - RRB 树维护什么不变量？

> ID：14007153
> 
> 赞同：24
> 
> 时间：2012-12-22T22:38:33.693
> 
> 标签：algorithm, scala, data-structures, clojure, tree

[松弛基数平衡树](http://infoscience.epfl.ch/record/169879/files/RMTrees.pdf)(RRB-trees) 是不可变向量的泛化（用于 Clojure 和 Scala），具有“有效恒定”的索引和更新时间。RRB 树保持高效的索引和更新，但也允许高效的连接（log n）。

作者以我难以理解的方式呈现数据结构。我不太确定每个节点维护的不变量是什么。

在 2.5 节中，他们描述了他们的算法。我认为他们确保索引到节点只需要在基数搜索之后进行额外的线性搜索步骤。我不明白他们是如何得出额外步骤的公式的，我想也许我不确定每个变量的含义（特别是“总共 p 个子树分支”）。

RRB-tree 连接算法是如何工作的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-23T05:57:59.183

他们确实在第 2.4 节中描述了一个不变量“但是，如前所述，B-Trees 节点不便于基数搜索。相反，我们选择了允许节点大小介于`m` 和之间的初始不变量`m - 1`。这定义了一个平衡树族已知 2-3 棵树、3-4 棵树和（对于 m=32）31-32 棵树。这个不变量保证了平衡并在大多数情况下实现了基数分支搜索。偶尔在基数搜索之后需要进行几步线性搜索以找到正确的分支。更高级别所需的额外步骤会增加。

查看他们的公式，看起来他们已经计算出存储在子树中的最大和最小可能值数量。两者之间的差异是一个点下的最大和最小值之间的最大可能差异。如果将其除以插槽下的值的数量，则当您计算出要查看的插槽以查看它是否包含您正在搜索的索引时，您将获得最大的插槽数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-09-11T22:48:56.540

@mcdowella 是正确的，这就是他们所说的放松节点。但是，如果您要拆分和连接节点，从*m*到*m* -1 的范围意味着您有时必须调整最多*m* -1 ( *m* -2?) 个节点才能从节点中添加或删除单个元素。这似乎非常低效。我认为它们的意思是在*m*和 (2 *m* ) - 1 之间，因为这允许节点在它们变得太大时分成 2 个，或者当它们太小时将 2 个节点合并为一个，而无需更改第三个节点。因此，论文中的“2 *m* ”中缺少“2”是一个错字。 [Jean Niklas L'orange 的硕士论文](http://hypirion.com/thesis.pdf)支持我的观点。

此外，所有严格节点的长度都相同，必须是 2 的幂。原因是 Rich Hickey 的 Clojure PersistentVector 中的优化。好吧，我认为重要的是打包剩下的所有严格节点（稍后会详细介绍），这样您就不必猜测要下降树的哪个分支。但是能够移位和位掩码而不是除法是一个很好的奖励。我没有在宽松的 Scala 向量上计时 get() 操作，但[宽松的 Paguro 向量比严格的向量慢 10 倍](https://docs.google.com/spreadsheets/d/1D0bjfsHpmK7aJzyE2WwArlioI6w69YhZ2f-x0yM6_Z0/edit#gid=1756774656)。因此，它尽一切努力尽可能严格，如果您在 0 处重复插入，甚至会产生 2 个严格级别。

他们的树也有一个均匀的高度——所有的叶子节点到根的距离都是相等的。我认为如果放松的树必须在一个层次之内，它仍然可以工作，比如说，一个另一个层次，虽然不确定那会给你带来什么。

松弛节点可以有严格的子节点，反之则不行。

严格节点必须从左侧（低索引）无间隙地填充。任何非完整的 Strict 节点必须位于树的右侧（高索引）边缘。如果您确实附加到焦点或尾部（更多内容见下文），则所有严格叶节点总是可以满的。

[您可以通过搜索Paguro 实现](https://github.com/GlenKPeterson/Paguro/blob/master/src/main/java/org/organicdesign/fp/collections/RrbTree.java#L123)中的 debugValidate() 方法来查看大部分不变量。那不是他们的论文，但主要是基于它。实际上，论文中也没有提到[Scala 实现中的“显示”变量。](https://github.com/scala/scala/blob/2.12.x/src/library/scala/collection/immutable/Vector.scala)如果你要研究这些东西，你可能想先看看 Clojure [PersistentVector](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/PersistentVector.java)因为 RRB 树里面有一个。它与 RRB Tree 的两个区别是：1\. RRB Tree 允许“松弛”节点；2\. RRB Tree 可能有“焦点”而不是“尾巴”。焦点和尾部都是小缓冲区（可能与严格的叶节点大小相同），不同之处在于焦点可能会定位到向量的最后插入/附加到的任何区域，而尾部始终位于末尾（PerSitentVector 只能追加，不能插入）。这两个区别是允许 O(log n) 任意插入和删除，加上 O(log n) split() 和 join() 操作。

# php - PHP：试图在两个单独的字符串数组中找到一个共同的匹配文本。主要思想：为论坛创建用户组

> ID：14007154
> 
> 赞同：0
> 
> 时间：2012-12-22T22:38:33.583
> 
> 标签：php, string, loops, find, match

对此的简短描述是我创建了自己的论坛。一切都很棒，我自己也对它印象深刻，因为我只学习了 6 个月的 PHP。但是，我正在尝试使用户组正常运行。现在，我可以将一个用户组分配给一个论坛类别，这一切都非常棒。但同样，我只能将一个组添加到论坛。如果我尝试添加更多组，这就是我的代码遇到问题的地方。

首先，让我给你我正在使用的工作代码：

```
function checkgroupstat($group, $user) {
$findme = $group . ":";
$filestring = get_user_data($user, "groups");
$pos = strpos($filestring, $findme);
if ($pos === false) {
return "false";
} else {
return "true";
}
} 
```

如您所知，“get_user_data() 函数将返回用户所属的一组组。例如，它将返回 5:1;6:1;7:1 等......重要的部分是冒号前面的数字和冒号本身，例如：5:，但不是 5:1。一个代表用户拥有的权限，并且是另一个编码页面的一部分，所以它在这里并不重要。

“groups”字符串将返回分配给论坛的组。上面的代码完美运行。如果返回 true，则论坛可见，否则返回 false。

但是，我尝试使它可以将多个组分配给论坛，并且我使用了无法按预期工作的代码：

```
function checkgroupstat($group, $user) {
$groups = explode(',', $group);
$filestring = get_user_data($user, "groups");

for ($i = 0; $i < count($groups); ++$i) {
$findme = $groups[$i] . ":";
$pos = strpos($filestring, $findme);
if ($pos === false) {
$false = "true";
}
else {
$truth = "true";
}
}
if ($truth == "true") {
return "true";
}
if ($truth == "") {

return "false";
}
} 
```

我什至尝试使用 for each loop with break;

有什么建议么？

* * *

编辑：

下面的建议没有奏效。请参阅我的最新回复：传递给 checkgroupstat 的参数是：("1,2,3", 6)。get_user_data() 返回的结果是 5:1;6:1;7:1;8:1;。顺便说一句，这些都不适合我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:46:55.663

您是否正在尝试以下操作？;)

```
function checkgroupstat($group, $user) {
    $groups = explode(',', $group);
    $filestring = get_user_data($user, "groups");

    // iterate over the group array 
    // return true if a group has matched
    for ($i = 0; $i < count($groups); $i++) {
        $findme = $groups[$i] . ":";
        $pos = strpos($filestring, $findme);
        if ($pos !== false) {
            return "true";
        }
    }

    // if no group has matched in the loop above
    // we'll have to return false
    return "false";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:51:06.280

嗯....请给我 checkgroupstat() 传递的参数，以及 get_user_data() 返回字符串。我会写正确的代码。

从现在开始我只写这个：

```
function checkgroupstat($group, $user) {
$aUserGroups = get_user_data($user, "groups");
$aGroups = explode(',',$aUserGroups);
foreach($aGroups as $sGroup) {
    list($iGroup,$iSomething) = explode(':',$sGroup);
    if($group==$iGroup) {
        return true;
    }
}
return false; 
```

}

请 - 如果它工作正常给我反馈:)

# python - NPC AI构建无网格障碍物地图

> ID：14007158
> 
> 赞同：1
> 
> 时间：2012-12-22T22:39:12.017
> 
> 标签：python, artificial-intelligence, 2d-games

出于某些研究目的，我构建了一个小型坦克游戏，其中你有一个由玩家控制的坦克和一个或多个 NPC 坦克。

现在我想让这些 NPC 坦克在他们不知道的领域中导航。如果它们在一定范围内，它们可以检测到障碍物。如果他们检测到这些障碍，他们应该将它们保存在某个易于查询的数据结构中。以便他们在搬家时将其考虑在内。

现在这是我卡住的地方：如果我的领域是一个网格，那对我来说很容易，我只需保存障碍物所在的瓷砖/节点。

但是我并没有真正使用网格，我的坦克只是根据它们的速度向前移动几个像素，所以坦克可以定位在任何像素组合以及障碍物上。

现在我将如何处理这个？碰撞检测超出范围。我是否被迫使用某种网格或航路点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T03:10:27.007

为什么不使用[导航网格](http://en.m.wikipedia.org/wiki/Navigation_mesh)解决方案？看起来正是您正在寻找的东西，一种表示具有任意多边形障碍物的人工智能导航域的方法。

github 目前处于关闭状态，但根据[这个网站](http://code.google.com/p/straightedge/)（值得一试，这是一个有趣的 Java 实现），[这个项目](https://github.com/CBCJVM/python-pathfinding)有一个 python 导航网格实现。

*编辑*

根据您在下面的评论，我认为[分层表示](http://aigamedev.com/open/review/near-optimal-hierarchical-pathfinding/)实际上更接近您正在寻找的答案。本文链接到一篇论文，该论文描述了如何将逐像素网格（具有任意形状的障碍物）抽象为节点边缘图，以提高导航计算的速度。通过将这种类型的层次表示与动态导航算法（如 d*）结合起来（有关动态导航算法的概述，请参阅[此答案](https://cstheory.stackexchange.com/questions/11855/how-do-the-state-of-the-art-pathfinding-algorithms-for-changing-graphs-d-d-l/11866#11866)），您应该能够为您的问题实现解决方案。

# html - 导航菜单中的悬停效果（wordpress）

> ID：14007161
> 
> 赞同：1
> 
> 时间：2012-12-22T22:39:21.833
> 
> 标签：html, css, wordpress

我在 wordpress 中创建网页，我有导航菜单使用 `<?php wp_nav_menu(); ?>`.. 问题是，我想创建悬停效果，显示在封闭的图像中。 [http://s11.postimage.org/gclhor5hv/try.jpg](http://s11.postimage.org/gclhor5hv/try.jpg)

问题是，我不知道如何在悬停列表项的底部创建那个三角形。这是CSS：
`#navHead li a:hover{
background-color: #e00d1d;
border-radius: 5px;
color: #fff!important;
background-repeat: no-repeat;
background-position: 50% 30px;
}`

在 HTML 中：生成导航列表，因此我无法访问和编辑结构，因此必须在 CSS 中完成。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:19:07.007

这个生成器将为 CSS 3 中的气泡生成 css：http: [//cssarrowplease.com/](http://cssarrowplease.com/)

# database - EntityFramework 启用迁移 ArgumentException

> ID：14007169
> 
> 赞同：3
> 
> 时间：2012-12-22T22:40:20.810
> 
> 标签：database, entity-framework, database-design, azure

我是 Microsoft Azure 美丽世界的新手，并创建了我的第一个 hello world 网站。下一步是创建数据库（实体框架），但在从 PackageManagerConsole（PMC）创建数据库时出现异常。我在网上阅读了一些帖子，解释说我需要将 startupprojectname 添加到 PS 命令中，但不幸的是，这并不能解决我的问题。

我的解决方案中有 2 个项目。

*   “partyonwebsite”这是启动项目，显然是我的网站:)。
*   “模型”，我将在其中设计我的模型/实体。

在“模型”项目中，我有“User”和“UsersDb”类。UsersDb 是从 DbContext 继承的类。

现在，当我在 PMC 中执行以下行时：

```
enable-migrations -StartUpProjectName "PartyOnWebsite" -ContextTypeName "Models.Users.UsersDb" 
```

我收到以下（不是很有帮助）错误：

```
System.ArgumentException: The parameter is incorrect. (Exception from HRESULT: 0x80070057 (E_INVALIDARG))
The parameter is incorrect. (Exception from HRESULT: 0x80070057 (E_INVALIDARG)) 
```

我看过 get-help enable-migrations 并玩了一点，但运气不佳。

有人遇到同样的问题吗？或者你能指出我正确的方向来帮助我解决它吗？

提前非常感谢！

巴斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T10:11:17.537

解决了。如果您遇到同样的问题，请确保为您的单独“模型”项目正确设置了 EntityFramework。

*   在解决方案资源管理器中打开“管理解决方案的 NuGet 包”（在解决方案资源管理器中右键单击解决方案）
*   选择“已安装的包”
*   选择“EntityFramework”并单击“管理”
*   检查您的“模型”项目（我检查了我的网站项目和“模型”项目）

再次运行您的 enable-migrations 命令。

我还将我的网站项目中的项目引用添加到模型项目中，我不知道这是否重要。

我在 NuGet 中调整后成功执行的命令：

```
enable-migrations -ProjectName Models -ContextTypeName Models.Users.UsersDb 
```

希望这个答案能帮助另一个迷路的士兵在 Azure 中运行他的第一个应用程序:)。

干杯，

巴斯

# php - 如何从 WP_Post 对象中获取缩略图？

> ID：14007170
> 
> 赞同：5
> 
> 时间：2012-12-22T22:40:25.537
> 
> 标签：php, wordpress

我正在尝试在某个分类下循环一堆页面。循环部分效果很好，我得到了我需要的所有页面（很好地包裹在`WP_Post`对象中）。

但是，现在我面临着另一种问题。我想包含在编辑器中设置的页面缩略图。我试过任何我能想到的 , , , , , ,的组合`get`，但无济于事。`the``thumbnail``featured``image``_``-`

该`WP_Post`对象相当新，并且**[缺乏文档](http://codex.wordpress.org/Class_Reference/WP_Post)**。

谁能解开这个谜团？我的目标是最终显示一堆`<figure>`元素，包括图像、标题和每个对象的简短描述。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-22T23:19:15.993

以下只是简码形式的概念证明。它会转储一个代码块，其中包含所有具有[Featured Image](http://codex.wordpress.org/Post_Thumbnails)的帖子。

函数参考：[`has_post_thumbnail`](http://codex.wordpress.org/Function_Reference/has_post_thumbnail),[`get_the_post_thumbnail`](http://codex.wordpress.org/Function_Reference/get_the_post_thumbnail)

```
add_shortcode( 'all-post-thumbs', 'so_14007170_dump_post_thumbs' );

function so_14007170_dump_post_thumbs( $atts, $content ) 
{
    // Query
    $posts = get_posts( array(
        'post_type'    => 'post',
        'numberposts'  => -1,
        'post_status'  => 'publish'
    ) );

    // Build an array of post thumbnails
    $thumbs = array();
    foreach( $posts as $post)
    {
        if( has_post_thumbnail( $post->ID) )
            $thumbs[] = array( $post->post_title, htmlentities(get_the_post_thumbnail( $post->ID ) ) );
    }

    // Build output and return
    $echo = '<pre>'. print_r( $thumbs, true ) . '</pre>';
    return $echo;
} 
```

**前端结果：**

> ![变量转储](../Images/88d1083f223014b36e1b1e9e67c31a90.png)

**带有特色图片的帖子：**

> ![在此处输入图像描述](../Images/eb868f6144fe9b4b4cd2c0b689865d52.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T23:13:14.690

不知道你想要什么，但如果你想获取某个页面的所有图像，那么你可以使用

```
$parent='your page id';
$args=array(
    'post_parent' => $parent,
    'post_type' => 'attachment',
    'post_mime_type' => 'image',
    'orderby' => 'menu_order',
    'order' => 'ASC',
    'numberposts' => -1 
);
$images = get_children($args); 
```

您可以将此代码粘贴到循环中，如果您提供适当`page_id`的 as`parent`那么您将在 中以数组形式获取所有图像，`$images`并且可以运行循环。

[在 Codex](http://codex.wordpress.org/Function_Reference/get_children)阅读更多信息。

## 更新：

要仅获取您可以使用的特色图片

```
echo get_the_post_thumbnail('page id here', 'thumbnail'); 
```

[在 Codex](http://codex.wordpress.org/Function_Reference/get_the_post_thumbnail)阅读更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T23:18:56.547

```
if ( have_posts() ) : while ( have_posts() ) : the_post();
    // stuff before thumbnail

    $thumbnail_args = array();

    // insert whatever thumbnail args you want

    echo get_the_post_thumbnail();

    // stuff after thumbnail

endwhile; else:

    echo "<h2>Sorry, nothing to see here.</h2>";
endif 
```

不幸的是，WP_Post 方法的命名非常糟糕。大多数与 Post 交互的方法都需要添加一些 '_' 和 'post' 的排列。

# ruby-on-rails - Rails - 如何在某些事件上向用户提供通知消息

> ID：14007172
> 
> 赞同：4
> 
> 时间：2012-12-22T22:40:27.477
> 
> 标签：ruby-on-rails, ruby, polymorphism, alert

我在导轨上有问题。我实际上正在解决它，但我想那里有一个更简单的方法。

我得到了用户/会员/组模型和用户/邀请/事件模型。成员资格加入用户和组。邀请加入用户和事件。

会员制和邀请制是平等的。组和事件确实有一些相同的一些不同的列。会员/邀请模型都有一个布尔列“已接受”，这意味着被邀请加入群组/活动的用户必须在成为成员/参与者之前接受此邀请。

现在，如果用户登录所有组和活动邀请应该出现在列表中。事实上，我想稍后向系统添加更多通知，而事件甚至还没有包含在我的系统中。

我的解决方案是添加一个属于用户的通知模型。所以每个用户都有很多通知。此外，这个模型是多态的，属于会员和邀请。

```
#user model
class User < ActiveRecord::Base
    has_many :memberships, :dependent => :destroy
    has_many :groups, :through => :memberships
    has_many :invitations, :dependent => :destroy
    has_many :events, :through => invitations
    has_many :notifications  

#membership model (equal to invitation model)
class Membership < ActiveRecord::Base
    belongs_to :user
    belongs_to :group
    has_one :notifications, :as => :noticeable

#group model (equal to event model but participants for members and invitation for membership)
class Group < ActiveRecord::Base
    has_many :memberships
    has_many :users, :through => :memberships   
    has_many :members, :through => :memberships, :source => :user,
                :conditions => ['memberships.accepted = ?', true]

#notification model
class Notification  < ActiveRecord::Base
    belongs_to :user
    belongs_to :noticeable, :polymorphic => true 
```

我已经向数据库添加了一些数据并在控制台中对其进行了测试

```
myUser = User.find(6) # will be exchanged with current_user in the actual program 
```

我将在每个通知中运行所有通知...但一开始我会在一个通知上测试所有进一步的操作

```
myNotice = myUser.notifications.first 
```

所以无论 myNotices 的 noticeable_type 是会员还是邀请，在这种情况下，我都会将其呈现为组或事件通知 noticeable_type=membership

```
myGroup = Group.find(Membership.find(myNotice.noticeable_id).group_id) 
```

--> 你想加入组“myGroup.name”吗？是 | 不

是：`Membership.find(myNotice.noticeable_id).accepted = true`

否：`Membership.find(myNotice.noticeable_id).destroy`

和：`myNotice.destroy`

这就是我的想法。这是解决问题的方法吗？

遍历所有通知的“每个执行”将位于视图文件中。这意味着“Group.find(Membership.find(myNotice.noticeable_id).group_id)”必须在视图文件中或部分文件中。是不是有点丑？

我认为我使用了很多“查找”，这意味着很多 SQL 查询。难道没有办法用任何“Ruby on Rails”魔法来减少它们吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-18T09:44:25.043

我的应用需要类似的东西，所以在这里更新答案，以防有人发现它有用。

```
 #user model

   has_many :membership_notices, :through => :notifications, :source => :membership,  :conditions => {"notifications.noticeable_type" => "membership"}

   has_many :event_notices, :through => :notifications, :source => :event ,:conditions => {"notifications.noticeable_type" => "event"} 
```

现在可以通过以下方式访问通知

```
 user.membership_notices
  user.event_notices 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-10T09:06:02.297

最后，我找到了解决这个问题的方法！我再次遇到了这个问题并用谷歌搜索了“反向多态”。我发现了以下帖子： [https ://gist.github.com/runemadsen/1242485](https://gist.github.com/runemadsen/1242485)

> **多态关联反转。** 在 Rails 中进行多态关联非常容易：图片可以属于 BlogPost 或文章。但是，如果您需要相反的关系怎么办？一个图片、一个文本和一个视频可以属于一篇文章，并且该文章可以通过调用@article.media 找到所有媒体。这个例子展示了如何创建一个处理多态关系的ArticleElement 连接模型。要添加所有多态模型共有的字段，请将字段添加到连接模型。

```
 class Article < ActiveRecord::Base
          has_many :article_elements
          has_many :pictures, :through => :article_elements, :source => :element, :source_type => 'Picture'
          has_many :videos, :through => :article_elements, :source => :element, :source_type => 'Video'
        end

        class Picture < ActiveRecord::Base
          has_one :article_element, :as =>:element
          has_one :article, :through => :article_elements
        end

        class Video < ActiveRecord::Base
          has_one :article_element, :as =>:element
          has_one :article, :through => :article_elements 
        end

        class ArticleElement < ActiveRecord::Base
          belongs_to :article
          belongs_to :element, :polymorphic => true
        end

        t = Article.new
        t.article_elements  # []
        p = Picture.new
        t.article_elements.create(:element => p)
        t.article_elements  # [<ArticleElement id: 1, article_id: 1, element_id: 1, element_type: "Picture", created_at: "2011-09-26 18:26:45", updated_at: "2011-09-26 18:26:45">]
        t.pictures # [#<Picture id: 1, created_at: "2011-09-26 18:26:45", updated_at: "2011-09-26 18:26:45">] 
```

# java - 将 TableLayout 中的 TextView 滚动到屏幕的可见区域

> ID：14007173
> 
> 赞同：0
> 
> 时间：2012-12-22T22:40:32.373
> 
> 标签：java, android-widget, scrollview

如果a不是 a 的直接子级，我如何`TextView`通过滚动 a 进入屏幕的可见区域？`ScrollView``TextView``ScrollView`

我有一个顶部有 a 的`LinearLayout`视图，然后是 a和下面的 a ：`TextView``ScrollView``Button`

```
<LinearLayout
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_height="wrap_content"/>

    <ScrollView
        android:id="@+id/s"
        android:layout_height="0dip"
        android:layout_weight="1" >

        <TableLayout
            android:id="@+id/t"
            android:layout_height="wrap_content" >

            <TableRow
                android:id="@+id/r" >

                <TextView
                    android:id="@+id/a"/>

                <TextView
                    android:id="@+id/b"/>

                <TextView
                    android:id="@+id/c"/>

            </TableRow>

        </TableLayout>

    </ScrollView>

    <Button
        android:layout_height="wrap_content"/>

</LinearLayout> 
```

这会生成一个完全填充的屏幕，标签位于顶部边框，按钮位于底部边框，中间有一个表格；根据该表的行数，您可以滚动或不滚动它。

表格的内容是由 Java 代码生成的，我只是添加了一行作为插入内容的示例。

我现在需要确保通过垂直滚动可以看到某一行（不一定是最后一行）。`s`我可以从to访问每个元素`c`，但我根本不知道进行`ScrollView s`滚动的代码。

我尝试过`requestChildRectangleOnScreen`,`scrollBy`和, `scrollTo`，但可能总是使用错误的论点。

现在我不在乎`TextView a`是垂直居中还是在底部或顶部边框，如果它完全可见，那确实很棒。理想情况下，X-scroll 应该保持为 0（即最左边的位置）。

如果这很重要：此函数仅在用户使用特殊 Intent 进入屏幕时调用，该 Intent 告诉屏幕滚动到`TableRow`x（它只是为了显示最新更改）。

如果您需要更多信息，请询问。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T02:07:40.293

问题确实是我直接从`onCreate`. 这意味着布局尚未完成，因此所有滚动都是在元素具有高度之前完成的，因此它滚动了 0 像素。

解决方案是使用`View.post(Runnable r)`：

```
ScrollView s = (ScrollView) findViewById(R.id.s);
TextView a = (TextView) findViewById(R.id.a);
s.post(new Runnable() {
    public void run() {
        int[] location = new int[2];
        a.getLocationInWindow(location);
        int y = location[1];
        s.getLocationInWindow(location);
        s.scrollTo(0, y-location[1]); // or some other calculation
    }
}); 
```

# php - 我似乎无法从 POST 变量中检索值 ($_POST['variable']) 不起作用

> ID：14007178
> 
> 赞同：-1
> 
> 时间：2012-12-22T22:41:00.503
> 
> 标签：php, post

我似乎无法从 HTML 表单中检索 post 变量的值.. 由于某种原因.. 这通常很简单，但是当我转到分数 PHP 文件时.. 没有检索到任何表单值:(

```
<?php
$id = $_GET['id'];    
?>

 <form action="score.php" method ="post">
    <table border="0">
        <tr> 
            <td>
                <input type="radio" name="score" id="<?php echo $id ?>" value="2" />      
                <img style ="position:relative; left:-90;top:-20" src="./images/+2.png" /> 
            </td> 
        </tr>
        <tr>
            <td>
                <input type="radio" name="score" id="<?php echo $id ?>" value="3"/>
                <img style ="position:relative; left:-90;top:-20" src="./images/+3.png" /> 
            </td>
        </tr>                    
        <tr>
            <td>
                <input type="radio" name="score" id="<?php echo $id ?>" value="-1" /> 
                <img style ="position:relative; left:-90;top:-20" src="./images/-1.png" /> 
            </td>
        </tr>
        <tr>
            <td>
                <input type="radio" name="score" id="<?php echo $id ?>" value="-2"/>
                <img style ="position:relative; left:-90;top:-20" src="./images/-2.png" />
            </td>
        </tr> 
        <tr>
            <td>
                <input type="submit" id="mysubmit" value="Submit score"  />
            </td>
        </tr>
    </table>
</form> 
```

下面是 score.php 文件..

```
<?php
require('../madscore/database/connect.php');
?>
<?php
 database_connect();
$id = $_POST['id']; 
$value = $_POST['value'];  
$query = "UPDATE people SET Score= Score +".$value."WHERE ID ='".$id."'";
var_dump($query);exit;
$result = $connection->query($query);
$row_count = $result->num_rows;
var_dump($row_count);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:44:57.193

可能是因为您`name="score"`在所有表单元素中都使用了。将名称元素更改为`name="id"`并`name="value"`查看它是否有效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:48:28.253

我认为你应该使用

```
$value = $_POST['score']; 
```

代替

```
$value = $_POST['value']; 
```

至于 POST 中的 ID：您可以添加一个不可见的输入元素，它包含 GET 给出的 ID 值。这样，它将保存在 POST 中。

```
<input type="hidden" name="id" value="<?php echo $_GET['id']; ?>" /> 
```

# jquery - 使用 jQuery 创建带有样式数字的编号列表？

> ID：14007179
> 
> 赞同：-2
> 
> 时间：2012-12-22T22:41:03.820
> 
> 标签：jquery, css, html-lists

我需要在 Wordpress 站点中创建看起来像带有彩色数字的有序列表。

我知道如何在 html 中手工制作。有几种方法，但假设我通过无序列表创建一个编号项目，例如

`<li><span>1\. </span>Lorem ipsum dolor sit amet</li>`

我会用 CSS list-style:none 简单地删除项目符号。

但是，我在这个站点中有很多这样的列表，不想为每个列表编辑 html；我宁愿用 Wordpress 的标准 OL 来管理它们，这样不懂 HTML 的用户就可以创建它们。

我想我会用左边距和负文本缩进“挂起”数字。

在jQuery中处理这个最有效的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T22:45:21.873

看起来你在 CSS 前端还不错，所以你正在寻找如何将`span`s 放在列表的开头。

如果是这样的话：

```
$("ol > li").each(function() {
    var $this = $(this);
    $this.prepend("<span>" + ($this.index() + 1) + " </span>");
}); 
```

也许还可以在其中添加一个类，这样如果 JavaScript 没有运行，你就会得到无聊的旧数字，但如果是，你会得到样式化的数字。

```
$this.addClass('styled'); 
```

[实例](http://jsbin.com/ulugak/1)| [来源](http://jsbin.com/ulugak/1/edit)

* * *

旁注：如果您可以避免使用`spans`and 使用伪选择器`:before`或类似的方法，那么在支持它的浏览器上可能会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:53:42.710

如果您在一页上有多个 OL（如果只有一个列表也可以）。也适用于嵌套列表：

```
/* loop over each list so indexing of LI is done on per list basis*/
$("ol").each(function(){    
    $(this).children('li').each(function(index) {   
        $(this).prepend("<span>" + (index+ 1) + " </span>");
    });    
}); 
```

# c++ - 麻烦的析构函数，在 boost.python 中用指针调用 python 的对象

> ID：14007181
> 
> 赞同：3
> 
> 时间：2012-12-22T22:41:06.643
> 
> 标签：c++, python, boost-python

当我在boost.python中以指针作为参数调用python函数时，析构函数出现了一些问题。以下是示例代码

C++

```
#include <boost/python.hpp>
#include <boost/python/module.hpp>
#include <boost/python/def.hpp>
#include <string>
#include <iostream>
using namespace boost::python;

class A {
public:
    A() {
        std::cout<< "A start"<<std::endl;
    }
    ~A() {std::cout<< "A end" <<std::endl;}
}
class B {
public:
    B() { aa=new A; }
    ~B() { delete aa; }
    void run(object ct) {
        _obj=ct();              //creat a python object
        _obj.attr("fun1")(aa);  //call a function named "fun1" with a pointer arg
        _obj.attr("fun2")(aa);  //call a function named "fun2" with a pointer arg 
    }
    A *aa;
    object _obj;
}

BOOST_PYTHON_MODULE(ctopy)
{
    class_<A> ("A",init<>())
    ;
    class_<b> ("B",init<>())
    .def("run",&B::run)
    ;
} 
```

Python：

```
import ctopy
class tc:
    def fun1(self,tt):
        print "fun1"
    def fun2(self,tt):
        print "fun2"
bb=ctopy.D()
bb.run(tc) 
```

这个结果：

```
A start
fun1
A end
fun2
A end
A end 
```

# 笔记：

“A end”已经打印了三个。我在“valgrind”中试了一下，有一些错误。我只想运行一次析构函数。怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T02:57:52.307

要了解真正发生的事情，您缺少一个复制构造函数：

```
B()
  A()
B::run()
  A(a)     <- copy construct A to pass by value
    fun1() <- arg passed by value
  ~A()     <- delete copy
  A(a)     <- copy construct A to pass by value
    fun2() <- arg passed by value
  ~A()     <- delete copy
~B()
  ~A() 
```

在您的示例中，`aa`按值传递，这就是副本的来源。不管是否`aa`是指针，boost 都会将其转换为传递给 python 方法的对象。

如果你想避免额外的副本，`A`你可以通过`aa` *引用*而不是*通过值*传递：

```
_obj.attr("fun1")(boost::ref(aa));
_obj.attr("fun2")(boost::ref(aa)); 
```

这将导致：

```
B()
  A()    <- constructed once
B::run()
  fun1() <- arg passed by reference
  fun2() <- arg passed by reference
~B()
  ~A()   <- destroyed once 
```

有关详细信息，请参阅[调用 Python 函数和方法](http://www.boost.org/doc/libs/1_52_0/libs/python/doc/v2/callbacks.html#argument_handling)。

# python - 'NoneType' 对象在 python 中没有属性'append'

> ID：14007182
> 
> 赞同：0
> 
> 时间：2012-12-22T22:41:19.740
> 
> 标签：python

我在python中有以下功能：

```
def find_str(s, m):
    starting_points = find_starting_points(s,m)
    solution = []
    for i in range(0, len(starting_points)):
        position = starting_points[i]
        solution.append([position])
        solution = build_solution(position, s, m, solution)
    return solution
    pass 
```

当我在 ipython 中运行该文件时，出现以下错误：

```
 55     for i in range(0, len(starting_points)):
     56         position = starting_points[i]
---> 57         solution.append([position])
     58         solution = build_solution(position, s, m, solution)
     59     return solution

AttributeError: 'NoneType' object has no attribute 'append' 
```

为什么我会收到这个错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-22T22:43:24.793

您的`build_solution`函数在某些时候会返回`None`. 由于您设置`solution`了此函数的返回，因此您将其设置为无。

除非您显示`build_solution`.

# debugging - 调试微处理器

> ID：14007184
> 
> 赞同：1
> 
> 时间：2012-12-22T22:41:35.767
> 
> 标签：debugging, embedded, microcontroller, jtag

我们的协处理器之一是 8 位微处理器。它的主要作用是控制处理闪存的硬件。我们怀疑它运行的代码效率非常低，因为我们在读取/写入闪存时测量了低速。问题是，我们只有一个连接到主 CPU 的 J-TAG 端口，因此无法调试它。我们所拥有的是一个可从 CPU 获得的寄存器，其中包含微处理器的程序计数器。坏消息是，微处理器的工作频率与 CPU 不同，因此在外部监控它的程序计数器也很困难。测量微处理器内部的时间也非常困难，因为它的寄存器只有 8 位长。不用说，代码是汇编代码并且非常复杂。你将如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T13:04:56.763

> 不用说，代码是汇编代码并且非常复杂。你将如何解决这个问题？

我建议您从（或生成）这部分的需求规范开始，并用 C 重新实现代码（甚至仔细使用 C++ 子集）。如果您认为的“复杂性”仅仅是代码而不是需求，那么设计出来是个好主意——它只会使未来的维护更加复杂、容易出错和昂贵。

使用汇编程序的常见参数之一是大小和性能，但更常见的是，大量的汇编程序代码远非最佳；为了保持一定水平的生产力和可维护性，通常会使用和重用“样板”代码，而不是针对特定情况量身定制，而编译器将分析代码更改并执行系统设计人员所需要的那种“微优化”真的不应该出汗。使您的算法和数据结构高效，并将目标指令集的详细信息留给编译器。

即使没有直接在目标上调试的能力，使用高级语言也将允许在 PC 上进行原型设计和模拟。

即使您保留了汇编代码，如果您的开发工具包含指令集模拟器，这可能是硬件调试的一个很好的替代方案；特别是如果它支持可用于模拟硬件设备行为的调试器脚本。

综上所述，将其视为“黑盒”并得出代码效率低下的结论是有点飞跃。例如，什么样的闪存看起来很慢？它如何与微控制器接口？你是如何衡量这种表现的？闪存本质上很慢——尤其是写入和页面擦除；在对软件性能做出任何结论之前，请检查 Flash 的性能规格。

# ios - 将图像添加到类似于 UITextField 或其他文本输入视图的内容

> ID：14007199
> 
> 赞同：2
> 
> 时间：2012-12-22T22:43:54.097
> 
> 标签：ios, uiwebview, uitextview

我希望在文本输入视图中的文本中散布一些图像。我希望用户能够在任何时候输入文本并点击我提供的相机按钮，该按钮将在该点将图像插入到文本中。然后，用户可以继续输入文本，并再次能够在他们喜欢的时间和地点插入更多图像。

我希望用户能够在此文本/图像混合中的任何位置移动插入点，以选择文本、图像或两者的组合（只要它是连续的），并使用键盘输入更多文本，添加一个图像，删除文本或图像等。基本上，我想要在 iPhone 消息应用程序中找到的功能，因为用户可以输入文本或添加图像。

一旦用户完成，我可以灵活地选择我带走的格式。`NSString`我会对按输入顺序排列的一组对象或对象感到满意`UIImage`。

我已经尝试创建自己的视图，并根据需要添加不同的`UITextField`or`UITextView`和s。`UIImageView`我还尝试使用`UITableView`, 每个文本或图像一行。问题是我没有得到预期的选择或插入符号插入行为。

我正在寻找有关如何执行此操作的建议。

这是它在消息应用程序中的外观： ![这是它在消息应用程序中的外观：](../Images/cbe2ce088d6ba78d8ddab5220a34abcc.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:42:55.347

您可以尝试类似[OmniUI](https://github.com/omnigroup/OmniGroup/tree/master/Frameworks/OmniUI/iPad)的东西。它是一个沉重、强大和复杂的框架。我不确定它是否支持 iPhone。

# java - Android应用程序崩溃，原因是迭代器

> ID：14007203
> 
> 赞同：-1
> 
> 时间：2012-12-22T22:44:03.763
> 
> 标签：java, android, list, arraylist, iterator

我有一个名为 listOfDrills 的列表，其中包含 Iterator DrillIt，这是迭代器没有`next()`价值的一些原因（我很遗憾该列表不是空的，因为它可以正常工作`listOfDrills.get(0)`）。这是代码：

```
package com.simplemathgame;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Iterator;
import java.util.List;
import java.util.Random;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class GamePlayActivity extends Activity {
    int addDrills;
    int subDrills;
    int mulDrills;
    int divDrills;
    int minBound;
    int maxBound;

    TextView drillTextPlace;
    Button nextButton;
    Button backButton;

    List<Drill> listOfDrills = new ArrayList<Drill>();
    Iterator<Drill> drillIt = listOfDrills.iterator();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_game_play);

        //get values from other activity
        Bundle extras = getIntent().getExtras();
        addDrills = extras.getInt("addDrills");
        subDrills = extras.getInt("subDrils");
        mulDrills = extras.getInt("mulDrills");
        divDrills = extras.getInt("divDrills");
        minBound = extras.getInt("minBound");
        maxBound = extras.getInt("maxBound");

        for(int i = 0; i < addDrills; i++){
            AddDrill tmpDrill = new AddDrill(minBound,maxBound);
            listOfDrills.add(tmpDrill);
        }

        for(int i = 0; i < subDrills; i++){
            SubDrill tmpDrill = new SubDrill(minBound,maxBound);
            listOfDrills.add(tmpDrill);
        }

        for(int i = 0; i < mulDrills; i++){
            MulDrill tmpDrill = new MulDrill(minBound,maxBound);
            listOfDrills.add(tmpDrill);
        }

        for(int i = 0; i < divDrills; i++){
            DivDrill tmpDrill = new DivDrill(minBound,maxBound);
            listOfDrills.add(tmpDrill);
        }

        long seed = System.nanoTime();
        Collections.shuffle(listOfDrills, new Random(seed));

        drillTextPlace = (TextView) findViewById(R.id.drill_text);
        nextButton = (Button) findViewById(R.id.next_button);
        backButton = (Button) findViewById(R.id.back_button);

        if(drillIt.hasNext()){
            drillTextPlace.setText((drillIt.next()).printDrill());
        }

        nextButton.setOnClickListener(new OnClickListener(){

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                if(drillIt.hasNext()){
                    drillTextPlace.setText(drillIt.next().printDrill());
                }
            }
        });
    }

} 
```

代码从不输入：

```
if(drillIt.hasNext()){
            drillTextPlace.setText((drillIt.next()).printDrill());
        } 
```

如果我删除该`if`声明并只留下 `drillTextPlace.setText((drillIt.next()).printDrill());` 应用程序崩溃。

为什么会这样？我做错什么了？谢谢！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T22:47:14.710

您应该在填写完列表后创建迭代器。如文档中所示：

> 此类的 iterator 和 listIterator 方法返回的迭代器是快速失败的：如果在创建迭代器后的任何时间对列表进行结构修改，除了通过迭代器自己的 remove 或 add 方法之外的任何方式，迭代器将抛出 ConcurrentModificationException。

[http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)

移动

```
Iterator<Drill> drillIt = listOfDrills.iterator(); 
```

到之前：

```
if (drillIt.hasNext()) {
    drillTextPlace.setText((drillIt.next()).printDrill());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:48:58.857

您太早地创建迭代器，需要在要使用它之前创建它。当它为空时，您正在创建它。即使每次你下次打电话时都能奏效，你也会向前迈进，永远不会后退……

# javascript - jQuery 哈希检测 Internet Explorer

> ID：14007209
> 
> 赞同：0
> 
> 时间：2012-12-22T22:45:12.123
> 
> 标签：javascript, jquery, internet-explorer, hash, tabs

我正在使用 jQuery 构建导航选项卡，并且正在检测 URL 哈希值以用作在页面加载时转到哪个导航选项卡的参考。例如，当有人访问：example.com/profile.php#media 时，“媒体”选项卡会自动切换到。

我的 jQuery 代码适用于 Safari、Firefox、Chrome 和 Opera，但不适用于任何版本的 Internet Explorer（已测试 IE 6 - 10）。我的代码中是否有任何内容使其与 IE 不兼容？

**JavaScript：**

```
$(document).ready(function() {

tab = $('.tab');

function switch_active_tab() {
    tab.removeClass('active_tab');
    $(this).addClass('active_tab');
}

function hash_detect() {
    hash = document.location.hash.replace('#','');
    active_tab_id = $('.active_tab').attr('id').replace('-manager', '');
    // check if hash value is valid
    if( hash == 'pages' || hash == 'media' || hash == 'templates' || hash == 'scripts' ) {
        // if hash is not the same as the active tab
        if( hash !== active_tab_id ) {
            tab.removeClass('active_tab');
            $(document.location.hash+'-manager').addClass('active_tab');
        }
    }
    else {
        document.location = '#pages';
    }

}

function hash_respond() {
    hash = document.location.hash.replace('#','');
    active_tab_id = $('.active_tab').attr('id').replace('-manager', '');
    if( hash !== active_tab_id ) {
        document.location = '#' + active_tab_id.replace('-manager', '');
    }
}

$(document).ready(hash_detect);
$(window).bind('hashchange', hash_detect);
tab.click(switch_active_tab);
tab.click(hash_respond);

}); 
```

**对应的HTML：**

```
<div id="tab_wrapper">
    <div class="tab active_tab" id="pages-manager">Pages</div>
    <div class="tab" id="media-manager">Media</div>
    <div class="tab" id="templates-manager">Templates</div>
    <div class="tab" id="scripts-manager">Scripts</div> 
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:00:55.103

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms952653.aspx)，该`location`对象属于`window`.

我查看了一些使用 IE 的代码，`hash`我只参考`location.hash`了 IE 并且从未遇到过问题。我怀疑您可以尝试使用`window.location.hash`或简单地使用`location.hash`.

我看到的另一个问题是您没有使用`var`关键字声明任何变量。IE 对此非常不满。所有变量都应该像这样声明......

```
var hash; // simple declaration 
```

或者...

```
var hash = window.location.hash.replace('#', ''); // declaration with assignment 
```

IE也有可能遇到完全不相关的问题。我会检查以确保`active_tab_id`获得您期望的价值。

作为最后的手段，您应该使用[IE Developer Tools](http://msdn.microsoft.com/en-us/library/ie/gg589507%28v=vs.85%29.aspx)。调试器并不是全部，但有时它可能很有用。

# java - 使用多种泛型类型在 Java 中实现抽象泛型方法

> ID：14007210
> 
> 赞同：11
> 
> 时间：2012-12-22T22:45:13.417
> 
> 标签：java, generics, parameters

它是关于 java 中具有两种泛型类型（一种用于返回类型，另一种用于形式参数）的泛型方法以及如何实现它。我想我在图片中遗漏了一些东西来让它工作。

事情是这样的...

这是**有效**的：

```
public enum Getter
{
    BillItemsSize {
        @Override
        public Integer get (Object entity) {
            DesiredClass ref = (DesiredClass ) entity; // "Old time" cast
            // do things...
        }
    };

    public abstract <T,K> T get (K entity);        
} 
```

这**不起作用**：

```
public enum Getter
{
    BillItemsSize {
        @Override
        public Integer get (DesiredClass entity) { // no cast at all
            // do things
        }
    };

    public abstract <T,K> T get (K entity);        
} 
```

java编译器对我大喊：

```
<anonymous datasource.db.Getter$1> is not abstract and does not override abstract method <T,K>get(K) in Getter 
```

嗯，情况就是这样。在此先感谢大家！希望它在未来对其他人有所帮助！

PD：这不是枚举类型的问题。它发生在类层次结构中。所以不要费心去责怪枚举，我试过这个但不起作用。

```
public abstract class SuperClass
{
    public abstract <T,E> T pepe (E e);
}

public class SubClass extends SuperClass
{

    @Override
    public Integer pepe(DesiredClass e) // fails... 
    {
        return null;
    }

} 
```

## 更新：

**对于泛型参数**

我们可以制定一个通用规则声明，对于“泛型参数”（其类型是泛型的），方法签名中隐式采用的类型等于该泛型的上限，如果没有指定，则可以是 Object，或者更多如果使用上限，则为特定子类（例如 T 扩展字符串）。

**对于泛型返回类型**

用特定返回类型覆盖泛型方法没有问题，只要返回类型是被覆盖返回类型的子类型。首先返回类型是什么？好吧，它恰好是对象。默认情况下，编译器假定（在方法签名中）泛型类型为 Object 类型。

所以我们必须知道，诀窍是知道任何具有泛型返回类型的方法实际上都具有**Object**返回类型。然后，如果在任何子类中该方法被覆盖并且我们更改他的返回类型，说明返回另一种类型，则不会有问题。因为，除了该方法将返回另一个类的对象之外，返回的对象将不可避免地是 Object 类的子类，并且只要它是原始的子类型，覆盖具有不同返回类型的方法就没有问题。 . 称为协变返回类型的技术允许我们做这样的事情。

```
public abstract class SuperClass
{
    public abstract <T> T operation ();
}

public class SubClass extends SuperClass
{

    @Override
    public Chair operation()
    {
        //bla bla 
    }

} 
```

同时在代码的另一部分......

```
void main ()
{
        SubClass sb = new SubClass();
        Chair chair = sb.operation ();
        // the chair type can be easely replaced by super type (like Object)
        Object object = sb.operation();
} 
```

感谢所有帮助清除此问题的人！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-22T22:53:19.830

```
public abstract <T,K> T get (K entity); 
```

是一种可以将任何内容作为参数的方法，并且可以返回任何内容。

用它覆盖它

```
public Integer get (DesiredClass entity) 
```

不起作用，因为您将可以传递给方法的参数类型限制为 DesiredClass，从而打破了 Liskov 原则。

没有泛型会更容易理解。假设您在 Bar 类中有一个抽象方法：

```
public abstract void fillRecipient(Recipient r); 
```

然后你尝试在 SubBar 中覆盖它

```
public void fillRecipient(Glass glass) {
} 
```

如果上面的代码是合法的，下面的代码会做什么？

```
Bar bar = new SubBar();
bar.fillRecipient(new Mug()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T23:03:00.890

为了完成 JB Nizet 的[回答](https://stackoverflow.com/a/14007261/7595)，当您编写时：

`<K>`

它隐含的意思是：

`<K extends Object>`

该方法必须接受任何对象。将其限制`DesiredClass`在子类上实际上不会覆盖任何内容，就像错误消息所说的那样。

~~被覆盖的方法必须具有完全相同的签名，不允许在参数或返回类型中使用子/超类型。~~

编辑：实际上正如评论中所讨论的那样，`String public foo();`有效地覆盖了`Object public foo();`.

# scribe - Scribe 1.3.3 和 Maven

> ID：14007214
> 
> 赞同：1
> 
> 时间：2012-12-22T22:45:32.233
> 
> 标签：scribe

看起来 maven 中央存储库中可用的最新版本不是最新的（1.3.3），而是以前的（1.3.2）。有没有机会在 Maven 中提供它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T19:09:48.960

刚刚将工件[上传](http://repo1.maven.org/maven2/org/scribe/scribe/1.3.3/)`1.3.3`到中央。抱歉耽搁了

# c - 套接字程序在接受时退出

> ID：14007215
> 
> 赞同：1
> 
> 时间：2012-12-22T22:46:05.957
> 
> 标签：c, sockets

由于某些莫名其妙的原因，这个 C++ 程序在接受套接字时退出。套接字被接受，这反映在客户端，但服务器随后自发爆炸。

完整代码如下：

```
#include <sys/types.h>
#include <stdio.h>
#include <arpa/inet.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/socket.h>
#include <string.h>
#include <errno.h>

#define BUF_SIZE 500
#define BACKLOG 50

int main(int argc, char *argv[])
{
    if (argc < 2)
    {
        printf("Usage %s port\n", argv[0]);
        exit(EXIT_FAILURE);
    }

    struct sockaddr_in addr;
    struct sockaddr_storage theiraddr;
    socklen_t addrlen;
    char buf[BUF_SIZE];

    addr.sin_family = AF_INET;
    addr.sin_port = htons(atoi(argv[1]));
    addr.sin_addr.s_addr = INADDR_ANY;

    theiraddr.ss_family = AF_INET;

    int sockfd = socket(AF_INET, SOCK_STREAM|SOCK_NONBLOCK, 0);

    if (sockfd == -1)
    {
        printf("Sock Error!\n");
        exit(EXIT_FAILURE);
    }

    if (bind(sockfd, (struct sockaddr*)&addr, sizeof(addr)) == -1)
    {
        printf("Bind Error!\n");
        exit(EXIT_FAILURE);
    }

    if (listen(sockfd, BACKLOG) == -1)
    {
        printf("Listen Error!\n");
        exit(EXIT_FAILURE);
    }

    addrlen = sizeof(theiraddr);
    int accepted;

    for ( int i = 0; ; i++ )
    {
        usleep(100000);

        errno = 0;
        printf("pre-accept\n");
        accepted = accept(sockfd, (struct sockaddr *)&theiraddr, &addrlen);
        printf("%i", accepted == -1); //this line does not get executed

        if(errno == EWOULDBLOCK)
        {
            printf("WOULDBLOCK %i\n", i);
            continue;
        }
        else if(accepted == -1)
        {
            printf("TERRIBLE TRAGEDY\n");
        }

        printf("Accepted.\n");

        char msg[] = "You have connected.";

        send(sockfd, msg, sizeof(msg), 0);

        close(accepted);

    }
    close(sockfd);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:13:30.477

您没有看到错误消息，因为`\n`格式字符串的末尾没有 a。 `stdout`是行缓冲的。在任何情况下都`stderr`用于错误输出。

你真正的错误似乎是这个

```
send(sockfd, msg, sizeof(msg), 0); 
```

我猜你的意思是发送提供给你进行通信`accepted`的文件描述符。`accept`

# python - 从python中的字符串中删除前两个字节

> ID：14007216
> 
> 赞同：0
> 
> 时间：2012-12-22T22:46:20.780
> 
> 标签：python, unicode, ascii

我需要从字符串中删除字节顺序标记。我已经有了查找 BOM 的代码，但现在我需要将其从实际字符串中删除。

给你举个例子。BOM`feff`的长度为 2 个字节，这意味着字符串的前两个字节不应出现在最终字符串中。但是，当我使用 Python 字符串剥离时，会从字符串中剥离太多内容。

代码片段：

```
print len(bom)
print as_hex(bom)
print string
print as_hex(string)
string = string[len(bom):]
print string
print as_hex(string) 
```

输出：

```
2
feff
Organ
feff4f7267616e
rgan
7267616e 
```

我希望得到的是：

```
2
feff
Organ
feff4f7267616e
Organ
4f7267616e 
```

该`as_hex()`函数只是将字符打印为十六进制 ( `"".join('%02x' % ord(c) for c in bytes`))。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T23:15:00.663

我认为你有一个 unicode 字符串对象。（如果您使用的是 Python 3，您当然会这样做，因为它是唯一一种字符串。）您的 as_hex 函数不会打印出第一个字符的“fe”和第二个字符的“ff”。它为字符串中的第一个 unicode 字符打印出“feff”。例如（Python 3）：

```
>>> mystr = "\ufeffHello world."
>>> mystr[0]
'\ufeff'
>>> '%02x' % ord(mystr[0])
'feff' 
```

您要么只需要删除一个 unicode 字符，要么将字符串存储在一个`bytes`对象中并删除两个字节。

（这并不能解释为什么 len(bom) 是 2，如果没有看到更多你的代码，我无法分辨。我猜 bom 是一个`list`或一个`bytes`对象，而不是一个 unicode 字符串。）

* * *

我上面的回答假设 Python 3，但我从您的打印语句中意识到您正在使用 Python 2。基于此，我猜这`bom`是一个 ASCII 字符串，`string`而是一个 unicode 字符串。如果你使用它`print repr(x)`而不是`print x`它，你可以分辨出 unicode 和 ASCII 字符串之间的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:26:58.077

使用正确的编解码器，BOM 将为您处理。`utf-8-sig`使用和解码`utf16`将删除前导 BOM（如果存在）。使用它们进行编码将添加 BOM。如果您不需要 BOM，请使用`utf-8`,`utf-16le`或`utf-16be`.

在将文本数据读入程序时通常应该解码为 Unicode，而在写入文件、控制台、套接字等时应编码为字节。

```
unicode_str = u'test'
utf8_w_bom = unicode_str.encode('utf-8-sig')
utf16_w_bom = unicode_str.encode('utf16')
utf8_wo_bom = unicode_str.encode('utf-8')
utf16_wo_bom = unicode_str.encode('utf-16le')
print repr(utf8_w_bom)
print repr(utf16_w_bom)
print repr(utf8_wo_bom)
print repr(utf16_wo_bom)
print repr(utf8_w_bom.decode('utf-8-sig'))
print repr(utf16_w_bom.decode('utf16'))
print repr(utf8_wo_bom.decode('utf-8-sig'))
print repr(utf16_wo_bom.decode('utf16')) 
```

输出：

```
'\xef\xbb\xbftest'
'\xff\xfet\x00e\x00s\x00t\x00'
'test'
't\x00e\x00s\x00t\x00'
u'test'
u'test'
u'test'
u'test' 
```

请注意，`utf16`如果没有 BOM，解码时将采用本机字节顺序。

# ruby - Ruby Active Record 关联 - 从子表中获取列

> ID：14007225
> 
> 赞同：1
> 
> 时间：2012-12-22T22:47:52.277
> 
> 标签：ruby, activerecord

我有以下协会；

```
class Package < ActiveRecord::Base
  has_many : modules
end

class Module < ActiveRecord::Base
  belongs_to : package
end 
```

我用它来从连接中获取记录；

```
@recs = Package.includes(:modules).where( 'name' => 'abc-pkg').all 
```

但结果集`@recs`仅包含父表的（包）列。如何获取子（模块）表的列？

PS：使用 PostgreSQL 9.1 和 gem 'pg' 适配器

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:36:18.853

这实际上是正确的。检查时，您不会在`@recs`变量中看到子列。该`includes`方法的重点是避免在遍历包并请求`package.modules`.

# python - Python：通过套接字在两台计算机之间发送数据

> ID：14007227
> 
> 赞同：9
> 
> 时间：2012-12-22T22:48:04.380
> 
> 标签：python, sockets, tcp, connection

我正在编写一个脚本，该脚本将在两台可以访问互联网的不同计算机之间传输数据。我正在使用 python 的套接字标准模块。当我在单台计算机上同时运行客户端和服务器时它工作正常，但是当它们在不同计算机上运行时我无法使它们工作。

这是我的服务器代码的一部分：

```
import socket, time,os, random

class Server():
  def __init__(self,Adress=('',5000),MaxClient=1):
      self.s = socket.socket()
      self.s.bind(Adress)
      self.s.listen(MaxClient)
  def WaitForConnection(self):
      self.Client, self.Adr=(self.s.accept())
      print('Got a connection from: '+str(self.Client)+'.')

s = Server()
s.WaitForConnection() 
```

这是我的客户端代码的一部分：

```
import socket

class Client():
   def __init__(self,Adress=("Here is the IP of the computer on which the \
                                   server scrip is running",5000)):
      self.s = socket.socket()
      self.s.connect(Adress)

c = Client() 
```

当我在两台具有 Internet 访问权限的不同计算机上运行这些脚本时，客户端无法连接并引发错误，并且服务器将永远等待连接。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T23:39:03.347

这可能与您看起来不错的代码无关。我宁愿认为这是您使用的 IP 地址的问题。

如果计算机位于不同的网络上，您需要确保您传递的 IP 地址是网络可访问的地址。基本上这意味着如果您使用的 IP 以 192.168 开头.?.? 那么你使用了错误的IP。

您可以通过运行以下命令轻松检查：
(windows): ipconfig
(linux): ifconfig

如果您使用的是正确的 IP 地址，那么我会检查我的路由器设置和/或防火墙设置，这很可能会阻止您尝试使用的端口号。

# python - flask.ext.restful -> reqparse

> ID：14007228
> 
> 赞同：6
> 
> 时间：2012-12-22T22:48:05.633
> 
> 标签：python, rest, flask

我正在尝试使用此 reqparse 在烧瓶应用程序中将有意义的验证发送回我的客户。这是代码：

```
class ParserTest(Resource):

    def get(self):
        parser = reqparse.RequestParser();
        parser.add_argument('not_sent_from_client', type=str, required=True,
                help='This field is required',
                location='form')
        args = parser.parse_args()
        return "ok"

restfulApi.add_resource(ParserTest, '/p') 
```

当我`curl -v http://localhost:5000/p` 得到这个回复时：

```
* About to connect() to localhost port 5000 (#0)
*   Trying 127.0.0.1... connected
* Connected to localhost (127.0.0.1) port 5000 (#0) GET /api/v1/p HTTP/1.1 User-Agent: curl/7.21.4 (universal-apple-darwin11.0) libcurl/7.21.4 OpenSSL/0.9.8r zlib/1.2.5 Host: localhost:5000 Accept:
*/*

* HTTP 1.0, assume close after body < HTTP/1.0 400 BAD REQUEST < Content-Type: text/html < Content-Length: 192 < Server: Werkzeug/0.8.3 Python/2.7.1 < Date: Sat, 22 Dec 2012 22:21:33 GMT <  <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"> <title>400 Bad Request</title> <h1>Bad Request</h1> <p>The browser (or proxy) sent a request that this server could not understand.</p>
* Closing connection #0 
```

错误信息去哪儿了？

当我将代码更改为此：

```
def get(self):
        try:
            parser = reqparse.RequestParser();
            parser.add_argument('not_sent_from_client', type=str, required=True,
                help='This field is required',
                location='form')
            args = parser.parse_args()
        except Exception as e:
            pprint.pprint(getmembers(e))
        return 'ok' 
```

当我发出 GET 请求时，这会被转储到标准输出......

```
[('__call__',   <bound method ClientDisconnected.__call__ of <ClientDisconnected '400: Bad Request'>>),  
('__class__', <class 'werkzeug.exceptions.ClientDisconnected'>),  
('__delattr__',   <method-wrapper '__delattr__' of ClientDisconnected object at 0x1065ca230>),  ('__dict__', {'data': {'message': 'This field is required'}}),  
('__doc__',   'Internal exception that is raised if Werkzeug detects a disconnected\n    client.  Since the client is already gone at that point attempting to\n    send the error message to the client might not work and might ultimately\n    result in another exception in the server.  Mainly this is here so that\n    it is silenced by default as far as Werkzeug is concerned.\n\n    Since disconnections cannot be reliably detected and are unspecified\n    by WSGI to a large extend this might or might not be raised if a client\n is gone.\n\n    .. versionadded:: 0.8\n    '),  ('__format__',   <built-in method __format__ of ClientDisconnected object at 0x1065ca230>),  ('__getattribute__',   <method-wrapper '__getattribute__' of ClientDisconnected object at 0x1065ca230>),  ('__getitem__',   <method-wrapper '__getitem__' of ClientDisconnected object at 0x1065ca230>),  ('__getslice__',   <method-wrapper '__getslice__' of ClientDisconnected object at 0x1065ca230>),  ('__hash__',   <method-wrapper '__hash__' of ClientDisconnected object at 0x1065ca230>),  ('__init__',   <bound method ClientDisconnected.__init__ of <ClientDisconnected '400: Bad Request'>>),  ('__module__', 'werkzeug.exceptions'),  ('__new__', <built-in method __new__ of type object at 0x105bd4570>),  ('__reduce__',   <built-in method __reduce__ of ClientDisconnected object at 0x1065ca230>),  ('__reduce_ex__',   <built-in method
__reduce_ex__ of ClientDisconnected object at 0x1065ca230>),  ('__repr__',   <bound method ClientDisconnected.__repr__ of <ClientDisconnected '400: Bad Request'>>),  ('__setattr__',   <method-wrapper '__setattr__' of ClientDisconnected object at 0x1065ca230>),  ('__setstate__',   <built-in method __setstate__ of ClientDisconnected object at 0x1065ca230>),  ('__sizeof__',   <built-in method __sizeof__ of ClientDisconnected object at 0x1065ca230>),  ('__str__',   <bound method ClientDisconnected.__str__ of <ClientDisconnected '400: Bad Request'>>),  ('__subclasshook__',   <built-in method __subclasshook__ of type object at 0x105da42c0>),  ('__unicode__',   <bound method ClientDisconnected.__unicode__ of <ClientDisconnected '400: Bad Request'>>),  ('__weakref__', None),  ('args', ('400 Bad Request',)),  ('code', 400),  ('data', {'message': 'This field is required'}),  ('description',   '<p>The browser (or proxy) sent a request that this server could not understand.</p>'),  ('get_body',   <bound method ClientDisconnected.get_body of <ClientDisconnected '400: Bad Request'>>),  ('get_description',   <bound method ClientDisconnected.get_description of <ClientDisconnected '400: Bad Request'>>),  ('get_headers',   <bound method ClientDisconnected.get_headers of <ClientDisconnected '400: Bad Request'>>),  ('get_response',   <bound method ClientDisconnected.get_response of <ClientDisconnected '400: Bad Request'>>),  ('message', '400 Bad Request'),  ('name', 'Bad Request'),  ('wrap',   <bound method type.wrap of <class 'werkzeug.exceptions.ClientDisconnected'>>)] 
```

但是“好的”被发送给客户端。所以客户端正在断开连接。

我想用它向我的 apis 客户端发回有意义的错误消息，但调用堆栈中似乎发生了另一个错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-12T13:48:39.143

似乎 Werkzeug 几个月前用[https://github.com/mitsuhiko/werkzeug/commit/2723a117e34207f33ff075a9ea6d1f28a33131d3](https://github.com/mitsuhiko/werkzeug/commit/2723a117e34207f33ff075a9ea6d1f28a33131d3)改变了他们的异常逻辑。

因此，flask-restful 有点过时了。我遇到了同样的问题，为了适应新代码，我做了一个快速修改，看看[https://github.com/vojnovski/flask-restful/commit/8bfd1a8427b15df95a6549afdf4ddb4a49d8f29b](https://github.com/vojnovski/flask-restful/commit/8bfd1a8427b15df95a6549afdf4ddb4a49d8f29b)中的变化。

请记住，他也破坏了烧瓶休息的测试，如果您不想测试失败，您也需要修补它们。

# c++ - OpenCV imshow 错误？- 像素颜色

> ID：14007232
> 
> 赞同：2
> 
> 时间：2012-12-22T22:49:31.540
> 
> 标签：c++, image-processing, opencv

我花了半天时间才找到错误。最后我发现了这个奇怪的东西：

在我的代码方法 1 的一部分中，我执行以下操作：

```
Mat prevgray, gray, flow, cflow, frame;
cvtColor(frame1, prevgray, CV_BGR2GRAY);
cvtColor(frame2, gray, CV_BGR2GRAY);
calcOpticalFlowFarneback(prevgray, gray, flow, 0.5, 3, 15, 3, 5, 1.2, 0);
... 
```

在另一部分，method2，我创建了新的 Mat 并尝试显示它：

```
Mat result(480,640, CV_8UC3);
result.at<cv::Vec3b>(y,x)[0] = b;
result.at<cv::Vec3b>(y,x)[1] = g;
result.at<cv::Vec3b>(y,x)[2] = r;
namedWindow( "jojw", CV_WINDOW_AUTOSIZE );
imshow("jojw",result);
waitKey(0); 
```

结果是这个图像：

![在此处输入图像描述](../Images/a776ac005bdd8979326832505fdfcd73.png)

但是，如果我不使用 calcOpticalFlowFarneback 方法。我注释掉它或在代码到达它之前返回。结果图像是好的。

发生了什么？

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:14:46.683

自己解决了。花了 12 个小时才得到这个愚蠢的错误。那是错误吗？我仍然不明白，但解决方案是创建零垫：

```
Mat result = Mat::zeros(480,640, CV_8UC3); 
```

# image-processing - 高斯模糊边缘保持为正方形而不是圆形

> ID：14007233
> 
> 赞同：1
> 
> 时间：2012-12-22T22:49:32.093
> 
> 标签：image-processing, photoshop, blur, gaussian

因此，我通过在处理后的图像上水平然后垂直遍历像素来实现高斯模糊（1D 卷积），以生成最终图像。我使用了出现在 wiki 上的高斯分布公式。

问题是当我试图模糊黑色背景上的一个小白色正方形时，它的边缘仍然看起来像一个正方形，而不是变得更圆（如在 Photoshop 中）。应该是这样吗？我注意到，当我以相同的半径多次使用高斯模糊函数时，不会出现这个问题（它变得更圆），但是它变得太慢了。

我在这里错过了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:56:57.917

尝试增加高斯的方差，它会增加模糊，因为它会给相邻的像素更多的权重。

此外，您需要从高斯中提取至少 5 个样本，只有 3 个样本的蒙版不够模糊

# regex - 将任何不是数字的内容转换为空白

> ID：14007236
> 
> 赞同：6
> 
> 时间：2012-12-22T22:49:51.440
> 
> 标签：regex, r

我有一个数据向量，简化版本如下：

```
x <- c("1234123xcv?","12341534xxx.","hello","goodbye") 
```

我想做的是让它返回以下内容：

```
"1234123" "12341534" "" "" 
```

我知道我可以做这样的事情，我手动指定每个大写/小写字母和我知道的几个特殊字符：

```
grep("[A-Za-z\\?\\.]",x,value=TRUE) 
```

但我不知道该领域中的“其他”是什么，不一定是数字。（而且不能手动查看，因为太大了）

考虑到这一点，我的问题是：有没有办法指定您只希望返回数字`gsub()`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-22T23:08:36.880

```
gsub("\\D","",x) # yada yada yada 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-22T22:54:59.130

括号内，`^`表示没有。所以，这表示用“”替换不是数字的任何东西

```
> gsub("[^0-9]", "", x)
[1] "1234123"  "12341534" ""         "" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-22T22:56:14.833

```
gsub("[^[:digit:]]", "", x) #...... 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-22T22:54:44.380

你需要这样的东西：

```
[^0-9]* 
```

这将匹配任何不是数字的东西，无需指定哪个字符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-23T11:40:04.367

我会说

```
gsub("[^0-9]+", "", x) 
```

[^0-9] 将一次只替换一个字符，而 [^0-9]+ 一个或多个字符会更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-22T22:56:39.600

您可以使用 [\d]。将只返回数字。

# c# - Winform 幻灯片分拣机功能

> ID：14007240
> 
> 赞同：0
> 
> 时间：2012-12-22T22:50:15.250
> 
> 标签：c#, winforms

我正在寻求有关程序的帮助。语言是 c#，它是一个 winform 应用程序。我正在数据库中存储指向缩略图的链接。图像作为单独的文件保存在文件系统中。我需要一种方法来浏览这些文件。

具体来说，我需要一个控件来为我提供类似于 OpenOffice Presenter 和 Microsoft PowerPoint 等演示软件中的幻灯片排序器的功能。似乎任何标准的 Windows 控件都不起作用。如果您不知道，幻灯片分拣机本质上是一个网格。网格由一系列缩略图和这些图像的标签组成。这些图像及其相关标签可以被删除或重新排序。重新排序是通过拖动缩略图并将其放到新位置来完成的。

显然在这里找到了一个解决方案：http: [//bytes.com/topic/c-sharp/answers/269058-need-slide-sorter-functionality](http://bytes.com/topic/c-sharp/answers/269058-need-slide-sorter-functionality)但我不明白。

我在这里找到了一些有用的信息：http: [//flylib.com/books/en/2.255.1.247/1/](http://flylib.com/books/en/2.255.1.247/1/)但是我发现很难拼凑起来。特别是我将如何编号图像并添加拖放支持。

看过这里：[http](http://www.youtube.com/watch?v=qwjvR4tX790) ://www.youtube.com/watch?v=qwjvR4tX790我怀疑我可能需要使用某种布局控制，但会对任何其他方法感兴趣。这种方法在支持我需要的拖放功能方面显得有限。另一种方法可能是克隆项目，如此处所示[克隆控件 - C# (Winform)](https://stackoverflow.com/questions/10266589/clone-controls-c-sharp-winform?rq=1)再次我不确定这将如何与拖放一起工作。

我对代码解决方案和使用特定组件的建议持开放态度——即使我必须购买它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:12:17.630

我肯定会选择

> flylib.com

有一个更改的解决方案我会首先制作一个自定义控件容器，它在 PictureBox 内部和一个标签都以容器为中心，但内部不应该能够获得焦点，因此它们不可点击。然后只需使用您提供的链接中描述的方法并从那里开始工作。

对于鼠标拖放，您可以在[此处连接到本网站另一个问题中描述的鼠标事件](https://stackoverflow.com/questions/8459458/moveable-custom-control)

# jquery - 使用 AJAX 调用数据库

> ID：14007241
> 
> 赞同：-1
> 
> 时间：2012-12-22T22:50:35.133
> 
> 标签：jquery

我想在这里做的是使用这些功能，但是当用户单击元素时，我需要使用单击的 id 调用数据库。

我有大约 6 个我想要实现的按钮，那么我将如何利用一个功能来做到这一点？我正在考虑使用一个需要 id 参数的函数

```
function toggle(id){
  //I'm lost from here. :)
} 
```

另外，我是否需要对启用和禁用切换进行 AJAX 调用，或者我可以使用一个调用吗？

我不确定如何做到这一点。有人可以帮忙吗？

```
 $(".enable").click(function(){
    var parent = $(this).parents('.switch');
    $('.disable',parent).removeClass('selected');
    $(this).addClass('selected');
    $('.checkbox',parent).attr('checked', true);
  });

  $(".disable").click(function(){
    var parent = $(this).parents('.switch');
    $('.enable',parent).removeClass('selected');
    $(this).addClass('selected');
    $('.checkbox',parent).attr('checked', false);
  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:42:08.610

这取决于您使用的构造类型，但该问题的典型解决方案是调用服务器端脚本以从数据库中检索实际数据。

所以客户端你可以打电话

```
function toggle(id)
{
     $.ajax({
         url: "database.php",
         data: { id: id },
         success: function(data) {
             // do something with the response
         }
     });
} 
```

在本例中，database.php 文件进行数据库信息检索

# php - 多文件上传器只发送一个文件

> ID：14007243
> 
> 赞同：0
> 
> 时间：2012-12-22T22:50:47.060
> 
> 标签：php, forms, file-upload, input

我有一个多文件输入，我可以选择多个文件，但是当我在表单操作页面上 var_dump 文件变量时，只有一个文件。

```
<input id="image" type="file" name="images" multiple="multiple"> 
```

这里是垃圾场`var_dump($_FILES);`

```
array(1) { ["images"]=> array(5) { ["name"]=> string(12) "IMG_4511.JPG" ["type"]=> string(10) "image/jpeg" ["tmp_name"]=> string(26) "/private/var/tmp/php8g7CV3" ["error"]=> int(0) ["size"]=> int(730250) } } 
```

这是开始的表单标签：

```
<form enctype="multipart/form-data" method="POST" action="http://localhost.com/item/update" accept-charset="UTF-8"> 
```

我在这里有什么遗漏吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:51:35.077

```
<input id="image" type="file" name="images[]" multiple="multiple"> 
```

应该管用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T21:00:49.533

`name`如果您接受多个文件，请确保您的输入是一个数组：

单次上传：
`<input name="productImage" accept="image/*" type="file" />`

多次上传：
`<input name="productImage[]" accept="image/*" type="file" />`
`<input name="productImage[]" accept="image/*" type="file" />`
... --------------------------------------------------^`[]`表示这是一个数组并允许您为同名提交多个值。

然后你会发现多个值`$_FILES`而不是仅上传的最后一个文件（因为每个文件基本上都覆盖了当前的最后一个文件）

# html - 在 CSS 不工作的情况下垂直对齐图像旁边的文本

> ID：14007253
> 
> 赞同：1
> 
> 时间：2012-12-22T22:51:49.263
> 
> 标签：html, css

好吧，所以我看了一堆其他类似这样的堆栈溢出问题，但似乎没有任何效果。我不知道为什么它不工作一定是我没有抓住的愚蠢的东西。

我的 CSS

```
.how-right {
}
.how-right img {
    float:right;
    margin-left:20px;
    vertical-align:middle;
}
.how-left {
} 
```

我的 HTML

```
<!-- Number 1 -->
<div style="height:259px;" class="how-right">
    <img src="img/how-it-works/num-1.PNG" width="267px" height="259px">
    <span> has a simple system to get you in shape in just 6 weeks.  And it's so easy to follow, even people who have never exercised before can do it.</span>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T22:55:35.183

```
span {
    height: 259px;            
    display: table-cell;
    vertical-align: middle;
} 
```

[演示](http://jsfiddle.net/rVTcv/)

此外，还有[更多](http://css-tricks.com/vertically-center-multi-lined-text/)用于垂直居中多行文本的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T23:00:38.273

您应该垂直对齐`span`标签。您应该使用 CSS 表：`display:table`和`display:table-cell`. 这些不会使元素成为实际的表格，但它只会允许`vertical-align`正确使用（它基本上将所有内容视为内联，而不是块）。

适用`display:table`于父元素（`how-right`在您的情况下为 ）。应用于`display:table-cell`实际`span`标签。

这是CSS：

```
.how-right img {
    float:right;
    margin-left:20px;
    vertical-align:middle;
}
span {
    height: 259px;            
    display: table-cell;
    vertical-align: middle;
} 
```

这是一个 JSFiddle，因此您可以看到最终结果：http: [//jsfiddle.net/zdZYY/](http://jsfiddle.net/zdZYY/)

# ios - 将 NSDate 格式化为当前设备日期、时间和时区

> ID：14007256
> 
> 赞同：0
> 
> 时间：2012-12-22T22:52:28.937
> 
> 标签：ios, nsdate, nsdateformatter

我一直在网上寻找，但人们唯一拥有的是设置，他们将有一个日期格式化程序并将 [NSDate date] 格式化为一个字符串，这样就可以了。然而，我需要的是格式化日期成为 NSDate。我已经尝试格式化为字符串（效果很好），然后返回到 NSDate 但它永远不会出现正确的时区 - 只有 +0000 和 +0000 时区的正确当前时间。

NSDate 总是有 +0000 时区的问题是你不能改变吗？还是我做错了什么？

# python - 将导入的 C DLL 的 stderr 重定向到任意文件

> ID：14007262
> 
> 赞同：3
> 
> 时间：2012-12-22T22:53:22.903
> 
> 标签：python

Python 版本 = 2.7，Windows

你好，

我的 Python 脚本使用共享 C 库，我想重定向脚本的标准 IO 和文件中的共享 C 库，如下例所示（仅限于 stderr 流）

C共享库代码：

```
#include <stdio.h>

void my_print(void)
{
    fprintf(stderr, "This string isn't displayed\n");
} 
```

Python 脚本：

```
import os, sys, ctypes

def test():
    parserDll = ctypes.CDLL("./titi.dll")           # my shared C library
    file_stderr_fds = os.open("./toto.txt", 777)    # file in which redirect the stderr
    saved_stderr_fds = os.dup(2)                    # Backup stderr
    os.dup2(file_stderr_fds, 2)                     # Redirect stderr to file
    print >> sys.stderr, "zozo"                     # Python test redirect for Python script --> Ok
    parserDll.my_print(None)                        # test for the shared C library --> KO

if __name__ == "__main__":
    test() 
```

当我运行这个 Python 脚本时，我在 toto.txt 文件中读取了“zozo”（从 Python 脚本中显示），但没有从共享 C 库中读取。但是，如果我将 os.dup2() 注释掉，两个字符串都会显示在控制台中。为什么？Python 脚本和使用的共享 C 库的标准 IO 不一样吗？在这种情况下，如何将两者重定向到同一个文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T03:17:31.780

当我在 Linux 中运行您的示例时，它工作得很好。

最有可能的是，Windows 实际上并没有使用 POSIX 文件描述符来`stdio`实现它，因此不受您更改它们的影响。我不能说我确切地知道 Windows 是如何`libc`实现 POSIX 文件描述符的，但它可能只是 Windows 原生使用的任何 POSIX 兼容性函数的一些兼容层，并且`stdio`代码可能根本不使用它们。

无论如何，在我看来，在`stdio`. 我认为您可能应该使用`FILE *`C 函数可用于日志记录的显式变量，而是使用来自 Python 的显式调用来切换。

# crystal-reports - Crystal Reports 日期范围 多个字段

> ID：14007266
> 
> 赞同：0
> 
> 时间：2012-12-22T22:54:23.403
> 
> 标签：crystal-reports

我想让用户只输入一个日期参数来查找多个字段。目前，他们必须为每个字段输入一个新参数。有没有办法输入一个范围，如果有任何字段符合该标准，它将显示在报告中？我有六个要查询的字段。我用这个公式只测试了 2 个字段。我遇到的问题是，如果 {field one} 不符合参数，它不会显示 {field 2} 如果它符合参数。

({CUST_ContactsTable1_114806.CUST_Dog1BatteryPlanStartDate_103625984}>={?Start Date} and{CUST_ContactsTable1_114806.CUST_Dog1BatteryPlanStartDate_103625984}<={?End Date})OR ({CUST_ContactsTable1_114806.CUST_Dog2Batteryplanstartdate_070133812}>={?Start Date} and{CUST_ContactsTable1_114806.CUST_Dog2Batteryplanstartdate_070133812}<={ ？结束日期}）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:24:23.243

根据您在此处指定查询的方式，我希望这可以正常工作。

两个想法： 1.您的记录或组选择公式中是否有其他内容可能导致查询返回/不返回行？2\. 你确定Crystal 将数据库字段和这两个参数都视为日期或日期时间吗？如果您没有为数据库使用最好的 DB 驱动程序，有时 Crystal 会感到困惑，并且它会恢复为进行字符串比较与日期比较，如果日期未在 yyyyMMdd“从大到小”中解释，这可能会导致看似奇怪的行为风格的格式。

如果这些似乎不起作用，请粘贴整个 SQL 查询（您可以从“显示 SQL 查询...”下的“报告”菜单中获取）以及您希望返回的一些行的示例以及您希望返回的一些行期望根据某些参数进行过滤。

# html - 如何让我的透明 div 背景在 IE6、7、8 上显示为实心

> ID：14007272
> 
> 赞同：1
> 
> 时间：2012-12-22T22:55:04.183
> 
> 标签：html, css

我正在建立一个网站，看起来我也想要它在所有浏览器上，除了旧的 IE 版本。透明 div 背景是我网站的重要组成部分，我想知道是否有某种方法可以让 IE6 看到：rgba (0,0,0,0.6) 并将其更改为 #000000。

如果您想了解我的意思，请[访问](http://www.surefitmeasures1.appspot.com/Family/family.html)该网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:58:10.707

旧版本的浏览器将默认使用它们可以理解的内容。

```
body {
  background: #000;
  background: rgba(0,0,0,.25);
} 
```

`#000`在现代浏览器中将是透明的，对于旧版本的 IE 等将回退到普通的旧版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T22:58:39.203

只需像这样声明一个后备：

```
div {
   background: #000000; /* the fallback */
   background: rgba(0, 0, 0, 0.6); 
} 
```

不知道 rgba 的浏览器（如 IE6）不会理解第二行，忽略它并改用第一个声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T23:06:12.187

这是我的浏览器独立背景透明度

```
.transparent {
 background:rgb(0,33,66);
 background:rgba(0,33,66,0.7);
 filter:progid:DXImageTransform.Microsoft.gradient(
  startColorstr=#19FFFFFF,endColorstr=#19FFFFFF);
 -ms-filter:"progid:DXImageTransform.Microsoft.gradient(
  startColorstr=#19FFFFFF,endColorstr=#19FFFFFF)";
} 
```

第 1 行在不支持透明度的浏览器上设置为纯色 0,33,66

第 2 行在 70% alpha 处设置相同的颜色

最后两行是 IE hack，因为它们早期支持透明度，它们以某种方式应用了 rgba 中的 .7 alpha 值。

祝你好运

# javascript - Express/NodeJs 中更好的回调 Javascript 代码

> ID：14007273
> 
> 赞同：1
> 
> 时间：2012-12-22T22:55:18.147
> 
> 标签：javascript, node.js, asynchronous, routing, express

```
function DatabaseConnect(req, res) {...}
function CreateNewUser(req, res) {...}

function Go (app, req, res) {

    // If is POST on this URL run this function
    var firstFunction = app.post('/admin/svc/DB', function(res, req) { 
        DatabaseConnect(req, res) 
    });

    // If is POST on this URL run this function
    var secondFunction = app.post('/admin/svc/CREATE', function(res, req) { 
        CreateNewUser(req, res) 
    });

    // Run first all callbacks and after render page
    function Render(firstMe, afterMe) {
        firstMe();
        afterMe();
        app.render('screen');
    }

    Render(firstFunction, secondFunction);

}

Go(); 
```

**我怎样才能运行更多的异步功能。和 Render() 毕竟？**

如果在该 URI 上进行了 POST，则调用 APP.POST。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:47:30.113

根据您的需要，这里有各种不同的方法。如果您只关心完成一定数量的异步函数，一种常见的模式是基本上维护一个计数并`afterAll()`在完成后触发该方法：

```
var count = 0,
    target = 2; // the number of async functions you're running

function afterAll() {
    if (++count === target) {
        // do something
    }
}

doAsync1(function() {
    // some stuff
    afterAll();
});

doAsync2(function() {
    // some stuff
    afterAll();
}); 
```

[Underscore](http://documentcloud.github.com/underscore/)在这里提供了一些有用的实用程序，包括`_.after`：

```
var asyncMethods = [doAsync1, doAsync2, doAsync3],
    // set up the callback to only run on invocation #3
    complete = _.after(asyncMethods.length, function() {
        // do stuff
    });
// run all the methods
asyncMethods.forEach(function(method) {
    // this assumes each method takes a callback
    method(complete);
}); 
```

# javascript - 如何检测类中的哪个元素具有某种样式

> ID：14007274
> 
> 赞同：0
> 
> 时间：2012-12-22T22:55:23.030
> 
> 标签：javascript, dom, if-statement, for-loop, styles

我有一系列`select`共享一个类的列表。它们都在彼此之上，一个有`display: inline`，另一个有`display: none`。我如何使用纯 JavaScript（没有 jQuery）来查找正在显示的列表并检索它`value`？

我在想这样的事情：

```
function retrieve() {
  var value
  elements = document.getElementsByClassName('class');
  for (var i = 0; i < elements.length; i++) {
    if(elements[i].style.display = 'inline') {
      value = elements[i].value;
      break;
    }
  }
  alert(value);
} 
```

但是警报说“未定义”。代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:59:39.360

这一行：

```
if(elements[i].style.display = 'inline') { 
```

应该

```
if(elements[i].style.display === 'inline') {
// change here --------------^ 
```

使用 single `=`，这是一个*assignment*，而不是一个比较。使用`===`，这是一个（[严格](http://www.ecma-international.org/ecma-262/5.1/#sec-11.9.6)的）比较。您也可以使用`==`（[松散的比较](http://www.ecma-international.org/ecma-262/5.1/#sec-11.9.3)）。

# mysql - 某些 SQL 案例语句设置为 NULL

> ID：14007276
> 
> 赞同：2
> 
> 时间：2012-12-22T22:55:42.063
> 
> 标签：mysql, sql, case

嗨，我注意到我的 SQL 案例语句不正确，并且将字段 Age 设置为 NULL 以用于 ids 1-3。我将如何阻止这种情况发生？

谢谢

```
UPDATE table 
SET `Name` = CASE `id`
               WHEN 1 THEN 'Sam'  
               WHEN 2 THEN 'Adam'  
               WHEN 3 THEN 'James'  
               WHEN 4 THEN 'Chris'
             END, 
    `Age` = CASE `id` 
               WHEN 4 THEN '22'
            END  
WHERE `id` IN (1,2,3,4) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T22:57:24.090

添加`ELSE Age`到您的案例表达式：

```
`Age` = CASE `id` WHEN 4 THEN '22' ELSE `Age` END
--                                 ^^^^^^^^^^ 
```

这会导致将年龄设置回其原始值。

完整的查询如下所示：

```
UPDATE `table`
SET `Name` = CASE `id`
                 WHEN 1 THEN 'Sam' 
                 WHEN 2 THEN 'Adam'
                 WHEN 3 THEN 'James'
                 WHEN 4 THEN 'Chris'
             END,
    `Age`  = CASE `id`
                 WHEN 4 THEN '22'
                 ELSE `Age`
             END
WHERE `id` IN (1,2,3,4) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T22:58:53.993

我想你想要这个：

```
UPDATE table 
SET `Name` = 
    CASE `id` 
        WHEN 1 THEN 'Sam'  
        WHEN 2 THEN 'Adam'  
        WHEN 3 THEN 'James'  
        WHEN 4 THEN 'Chris'  
    END, 
    `Age` = 
    CASE `id` 
        WHEN 4 THEN '22' 
        ELSE Age 
    END  
WHERE `id` IN (1,2,3,4) 
```

没有测试过这个，但它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T22:57:34.400

您需要为 1 - 3 添加一个 WHEN... THEN。否则它不会分配任何东西。或添加其他。

# mysql - 如何将 MySQL 用于动态数据透视表或交叉表

> ID：14007284
> 
> 赞同：1
> 
> 时间：2012-12-22T22:57:52.470
> 
> 标签：mysql, pivot, crosstab

我知道这个问题或其变体已被多次询问，我什至尝试过实施解决方案，但我正在努力完成它。

我有一个非常简单的表，其中包含三个数据列：Date1、Report_#、Name。我想将它围绕日期和各种名称作为标题选项卡进行旋转，并让所有报告编号出现在下面。

所以它看起来像这样：

```
Report | Date   | Name                     Date   | Name1 | Name2 | Name3
-----------------------                    ------------------------------
1      | 4-5-12 | Name1                    4-5-12 | 1     | 2     | 3
2      | 4-5-12 | Name2      ----->        4-6-12 | 4     | 5     | 6
3      | 4-5-12 | Name3                    4-7-12 | 7     | 8     | 9
4      | 4-6-12 | Name1                    
5      | 4-6-12 | Name2                    
6      | 4-6-12 | Name3                    
7      | 4-7-12 | Name1
8      | 4-7-12 | Name2
9      | 4-7-12 | Name3 
```

[我能够从http://www.artfulsoftware.com/infotree/queries.php#78](http://www.artfulsoftware.com/infotree/queries.php#78)了解该做什么，但我被卡住了。

我能够手动隔离列名并在每个名称下列出报告#，但我想动态找出不同的名称，使它们成为列名，并列出相应的报告。

所以我创建了一个程序，可以找到不同的名称并输出正确的代码。现在我很难将过程的结果插入到查询中。上面的链接没有任何帮助，（它似乎跳过了那一步）。

所以这里是手动方式的代码：

```
SELECT `DATE`, 
GROUP_CONCAT(CASE `Name` WHEN 'Name1' THEN `Report` END) AS 'Name1', 
GROUP_CONCAT(CASE `Name` WHEN 'Name2' THEN `Report` END) AS 'Name2' 
FROM `report_db` GROUP BY `DATE` ORDER BY `DATE`; 
```

这是动态打印数据库中所有不同名称的 GROUP_CONCAT(... 的代码：

```
DROP PROCEDURE IF EXISTS writecountpivot;
DELIMITER | 
CREATE PROCEDURE writecountpivot( db CHAR(64), tbl CHAR(64), col CHAR(64) ) 
BEGIN 
DECLARE datadelim CHAR(1) DEFAULT '"'; 
DECLARE singlequote CHAR(1) DEFAULT CHAR(39); 
DECLARE comma CHAR(1) DEFAULT ','; 
SET @sqlmode = (SELECT @@sql_mode); 
SET @@sql_mode=''; 
  SET @sql = CONCAT( 'SELECT DISTINCT CONCAT(', singlequote, 
                     ',group_concat(IF(', col, ' = ', datadelim, singlequote, comma, 
                     col, comma, singlequote, datadelim, comma, '`IR NO`,null)) AS `',  
                     singlequote, comma, col, comma, singlequote, '`', singlequote,  
                     ') AS countpivotarg FROM ', db, '.', tbl, 
                     ' WHERE ', col, ' IS NOT NULL' ); 
  -- UNCOMMENT TO SEE THE MIDLEVEL CODE: 
  -- SELECT @sql;  
  PREPARE stmt FROM @sql; 
  EXECUTE stmt; 
  DROP PREPARE stmt; 
  SET @@sql_mode=@sqlmode; 
END
| 
DELIMITER ; 
CALL writecountpivot('database','`report_db`','name'); 
```

上面代码的结果是这样的

```
,group_concat(IF(name = "Name1",`IR NO`,null)) AS `Name1`
,group_concat(IF(name = "Name2",`IR NO`,null)) AS `Name2`
,group_concat(IF(name = "Name3",`IR NO`,null)) AS `Name3` 
```

** 那么我如何获取这段文本并将其插入到我的 SQL 中呢？如何将过程和查询放在一起？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T00:28:40.293

很难准确地说出您要做什么，但是如果您尝试创建一个可以执行任意枢轴的过程，那么您需要为它提供更多参数（例如要枢轴的列以及可以在其中找到值的列）。

此外，您将需要从准备好的语句中创建准备好的语句。最外面的语句将用于根据指定列中的唯一值`GROUP_CONCAT()`构造`GROUP_CONCAT()`要执行的表达式：

```
CREATE FUNCTION SQL_ESC(_identifier VARCHAR(64))
RETURNS VARCHAR(130) DETERMINISTIC
RETURN CONCAT('`',REPLACE(_identifier,'`','``'),'`')//

CREATE PROCEDURE writecountpivot(
  IN _db_nm VARCHAR(64),
  IN _tb_nm VARCHAR(64),
  IN _cl_gp VARCHAR(64),
  IN _cl_pv VARCHAR(64),
  IN _cl_vl VARCHAR(64)
) BEGIN
  SET @sql := CONCAT(
    "SELECT CONCAT('
              SELECT   ",SQL_ESC(_cl_gp),",',
              GROUP_CONCAT(DISTINCT CONCAT(
                'GROUP_CONCAT(IF(",
                   SQL_ESC(_cl_pv),"=',QUOTE(",SQL_ESC(_cl_pv),"),'
                 , ",SQL_ESC(_cl_vl),"
                 , NULL
                 )) AS ',SQL_ESC(",SQL_ESC(_cl_pv),")
              )), '
              FROM     ",SQL_ESC(_db_nm),".",SQL_ESC(_tb_nm),"
              GROUP BY ",SQL_ESC(_cl_gp),"
            ')
     INTO   @sql
     FROM   ",SQL_ESC(_db_nm),".",SQL_ESC(_tb_nm)
  );

  PREPARE stmt FROM @sql; 
  EXECUTE stmt; 
  DEALLOCATE PREPARE stmt;

  PREPARE stmt FROM @sql; 
  EXECUTE stmt; 
  DEALLOCATE PREPARE stmt;
END// 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/7cd76/1/0)上查看。

# javascript - CodeIgniter 视图、HTML、JS 和 CSS 压缩构建工具

> ID：14007286
> 
> 赞同：3
> 
> 时间：2012-12-22T22:58:26.457
> 
> 标签：javascript, html, css, codeigniter, build

是否有任何开源或可修改的构建工具来压缩和最小化 javascript 和 css 文件，以及 CodeIgniter PHP 视图文件？

是否有任何工具可以压缩 HTML、CSS 和 Javascript 代码中使用的 id 和类名？与压缩 Javascript 时类似，您会得到一个单字母变量。

作为最终结果，我希望得到类似 google.com 的来源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:03:29.897

[我在我的视图文件上使用HTML5 Boilerplate](http://html5boilerplate.com/)的构建脚本并启用该`preserve-php`功能

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T13:31:12.430

这不是完整的答案，但它应该能让你走到一半。

[https://github.com/EllisLab/CodeIgniter/wiki/Carabiner](https://github.com/EllisLab/CodeIgniter/wiki/Carabiner)

“它将合并、缩小和缓存资产。” 我已经使用它并且工作得很好。

关于视图查看这篇文章 [http://www.herusetiawan.com/2010/12/minify-or-compress-html-output-with-codeigniter/](http://www.herusetiawan.com/2010/12/minify-or-compress-html-output-with-codeigniter/) 你可以调整它来做一些事情比如缩小类/ID名称

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-03T13:01:13.090

如果你想要一种现代的方法，那么使用 webpack 是前进的方向。这是一个深入的话题，我在这里有一个完整的系列详细介绍：http: [//mstd.eu/index.php/2017/03/02/using-webpack-in-codeigniter-3-step-1-set-向上/](http://mstd.eu/index.php/2017/03/02/using-webpack-in-codeigniter-3-step-1-set-up/)

简而言之，您创建 webpack.config.js 文件，其中包含您希望构建脚本运行的所有命令，然后在您的 package.json 文件中，您在脚本数组中引用 webpack，这样您就可以简单地调用 npm run watch 它会编译在每一个变化。

```
"scripts": {
    "build": "webpack",
    "watch": "npm run build -- --watch"
  }, 
```

# maps - 谷歌地图的替代品

> ID：14007296
> 
> 赞同：5
> 
> 时间：2012-12-22T22:59:41.467
> 
> 标签：maps

因此，我正在建立一个网站，该网站将大量使用地图算法，例如：

*   兴趣点
*   从 A 到 B 然后到 C 的路由
*   交通

但是，Google 每天有 2,500 个 API 请求的限制，我想知道我还有什么其他选择。

因为每个用户的查询都可能会改变路由，所以为每个人调用 google api 可以很快用完分配的 API 插槽。我有什么选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T23:01:11.357

您可以使用“Google Maps API for Business”每天最多发出 100,000 个请求。

**有关的**

*   [谷歌地图 API 许可](https://developers.google.com/maps/licensing)
*   [为什么选择 Google Maps API for Business？](http://www.google.com/enterprise/earthmaps/maps-faq.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T23:06:20.767

你有没有考虑过[开放街道地图](http://www.openstreetmap.org/)？

也许这有帮助： [http ://www.ns-tech.co.uk/blog/2008/08/using-openstreetmap-overview-part-2-javascript-apis/](http://www.ns-tech.co.uk/blog/2008/08/using-openstreetmap-overview-part-2-javascript-apis/)

# web-applications - 在缩小之前如何管理 AngularJS WebApp 的端到端测试？

> ID：14007297
> 
> 赞同：5
> 
> 时间：2012-12-22T22:59:42.450
> 
> 标签：web-applications, angularjs, google-closure-compiler, webstorm, karma-runner

我们正在使用 AngularJS Seed 作为项目模板创建一个 WebApp。有许多控制器、指令、服务，每个都在它自己的 js 文件中。

*   应用程序文件夹的内容将使用 Closure 缩小。
*   所有 lib 依赖项都将通过 CDN 替换为缩小版本。
*   使用 Testacular/Jasmine 进行单元/e2e 测试。

我不确定典型的开发-编译-测试过程是什么，因为我是 AngularJS 和 Javascript WebApps 世界的新手 :-) 我的问题是如何在开发过程中管理应用程序 js 文件，以便 E2E 测试是可调试的。这是我目前的想法；

![](../Images/cdab8f186a577b9b38920e6c06dc6f79.png)

1.  Testacular 监视源文件以进行连续的单元测试。
2.  index.html 页面始终引用连接但未缩小的 js 文件。
3.  必须在应用程序可以运行/e2e 测试之前进行编译。
4.  构建服务器将作为其活动的一部分进行缩小。

这是一个合理的方法吗？它有助于澄清我正在使用 WebStorm、nodejs 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T07:14:34.900

创建单独的配置以测试缩小和非缩小源。

当地的：

```
$ testacular start  
# make some changes
$ minify.sh
$ testacular start testacular-minified.conf.js # you could skip this if you trust your minification 
```

更改时构建服务器：

```
$ testacular start --no-auto-watch # you could skip this if you trust your minification
$ minify.sh
$ testacular start testacular-minified.conf.js 
```

如果你有 Jasmine 测试和 e2e 测试，你需要有四个配置文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:00:00.857

感谢所有提供建议的人，他们都帮助我找到了解决方案。流程图（或多或少）描述了一个有效的构建过程。这里的关键是您需要一个构建工具。应该使用构建工具（在本例中为 GruntJS）来管理多个任务的顺序。顺序将根据目标而有所不同，构建工具允许您在许多不同的场景中重用任务。

对于 AngularJS 应用程序。参考github上的angular-app；

[https://github.com/angular-app/angular-app](https://github.com/angular-app/angular-app)

您将找到一个用于实现 Angular 应用程序的参考应用程序。它包含在 Grunt 中实现的用于持续测试、构建和发布的构建过程。更一般地说，这个参考应用程序是实现高度可管理、易于理解的 javascript 项目的极好指南。

# css - 相同图像和定位的多个实例

> ID：14007299
> 
> 赞同：0
> 
> 时间：2012-12-22T23:00:13.753
> 
> 标签：css, html, position, multiple-instances

我想在同一页面上多次放置相同的图像。我为此图像创建了一个 div，但我不确定每次放置它的最佳方法是什么。我是初学者，我希望这是相对简单的。有没有更好的方法来解决这个问题？我在 html 部分中确实有所有的“箭头”，但它看起来很笨重。谢谢你的帮助！！！顺便说一句，此示例仅显示 1 个实例。

```
div.arrow  
{
width:17px; 
height:16px;
background-image: url("images/resumearrow");
}

<div class="arrow">
<img style= "position:absolute; top:13px; left:-19px; width:17px; height:16px;"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:10:05.813

很难确切地了解您要做什么，但我认为您希望在 [something div] 的每个实例上放置一个箭头。您是否考虑过为要应用此箭头的 div 类设置 background-url？如果是其他东西，如何在页面上设置背景并使其仅在 y 方向上重复。这将每 x 个像素重复一次箭头，其中 x 是图像的高度。

请参阅此内容：[http ://www.techforluddites.com/2010/02/thesis-replacing-list-bullets-with-images-using-css.html](http://www.techforluddites.com/2010/02/thesis-replacing-list-bullets-with-images-using-css.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:15:38.200

您可能会想要使用 CSS 属性`background-image`（和简写`background`）而不是嵌入图像的 div。

这是一个简单的例子：

**HTML**

```
<ul>
    <li>Apples</li>
    <li>Oranges</li>
    <li>Bananas</li>
</ul> 
```

**​CSS**

 **```
li {
    height: 50px;
    padding-left: 60px;
    margin: 10px;
    background: url(http://placehold.it/50x50) no-repeat;       
}​ 
```

[演示](http://jsfiddle.net/ySsAg/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T23:25:05.233

你在那里，但我在这里创建了一个示例，显示了一个工作示例：http: [//jsfiddle.net/u8Bww/2/](http://jsfiddle.net/u8Bww/2/)

该`.arrow`元素应设置为`display:block;`. 由于我在`<div class="arrow">Text</div>`HTML 中有文本，因此我使用了多种技术组合将其隐藏在视图中，以便背景图像通过：`text-indent: -1000px; color: transparent; font-size: 0px;`.

您现在可以在`.arrow`需要显示图像的任何地方使用该类。

至于定位，我已经包含了一些内联 CSS 的示例来执行此操作，尽管您自己的使用可能会有所不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T23:35:08.480

如果您只是在谈论如何更好地“标记”它，您可以为每个图像（或它们周围的 div）添加一个自定义类，然后将 css 添加到外部样式表中。就像是：

```
<div class="arrow arrow1"> 
```

然后使用以下方法选择它：

```
.arrow.arrow1 img{
     top:13px; 
     left:-19px; 
     width:17px; 
     height:16px;
} 
```

目标虽然不是必须使用绝对定位，也不必为每个图像做太多“自定义”的东西，但是当有必要时，您可以使用这种方法将样式保留在 html 之外。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-23T03:34:31.090

我将您的问题解释为您希望在您的图像上添加一个**箭头叠加层，如下所示：**

![](../Images/5ecaf148dcd9b522cf789ea908d3ee84.png)

**HTML：**

```
<div id="thumbnail1" class="clickDiv">Thumbnail 1
    <div class="arrowOverlay" ></div>
    <img src="http://lorempixel.com/200/200/sports/1" class="thumb" />
</div> 
```

**CSS：**

```
.clickDiv {
  position: relative;
  margin: 30px;
    /* The size of the DIV will be the thumnail image size plus borders on EACH side. */
  width: 204px;
  height: 204px;
  float: left;
}

.arrowOverlay {
  position:absolute;
  background:url("http://www.gravatar.com/avatar/106d65dcf622137346a5f164598985fa?s=64&d=identicon&r=PG") no-repeat center center;
  width: 100%;
  height: 100%;
  cursor: hand;
  cursor: pointer;
}

.thumb {
  width:  200px;
  height: 200px;
  /* Reminder: The border attribute as seen provides 2px per EACH side of the DIV. */
  border: 2px solid red;
} 
```

**演示：**

[**jsFiddle 箭头叠加**](http://jsfiddle.net/vUmJy/)**

# mysql - 从 2 个表中选择

> ID：14007304
> 
> 赞同：0
> 
> 时间：2012-12-22T23:01:00.937
> 
> 标签：mysql

我正在使用这段代码：

```
SELECT *
  FROM admins, vips
  WHERE admins.Expired < CURDATE() + INTERVAL 3 DAY
    AND vips.Expired < CURDATE() + INTERVAL 3 DAY 
```

我在第一行有 2 行，在第二行有 2 行。但我在“vips”表中只得到 2 行。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:02:47.287

尝试`*`为两个表指定 ，如下所示：

```
SELECT admins.*, vips.*
FROM admins, vips
WHERE admins.Expired < CURDATE() + INTERVAL 3 DAY
AND vips.Expired < CURDATE() + INTERVAL 3 DAY 
```

编辑：上面的答案没有帮助，你需要一个`UNION SELECT`：

```
SELECT * 
FROM (SELECT * FROM vips
    UNION
    SELECT * FROM admins) derivedTable       -- this is an alias of the subquery
WHERE Expired < CURDATE() + INTERVAL 3 DAY 
```

# windows - 用于测试开源项目的 Windows 云实例？

> ID：14007308
> 
> 赞同：3
> 
> 时间：2012-12-22T23:01:21.560
> 
> 标签：windows, azure, amazon-ec2, scons, buildbot

我使用开源构建工具 SCons (www.scons.org)。我们做测试驱动的开发，我们有一个 buildbot，但我们总是缺少 Windows buildslaves。我们想要（在一个完美的世界中）一个包含不同 python 版本、不同编译器等的大型集合。是否有任何免费或近乎免费的基于云的 Windows 实例可以与 buildbot 一起使用？我看过 Azure 和 Amazon EC2 —— EC2 微型实例目前似乎是我们最好的选择，但我想知道是否有任何真正免费的东西，例如用于开源项目测试的啤酒。有没有人做过类似的事情有经验分享一下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T01:46:14.947

AWS 免费套餐包括每月 750 小时的 Linux 或 Windows 微型实例，为期一年。要留在免费套餐内，请仅使用 EC2 微型实例，这仅适用于一年，但是对于 Windows Azure，除了 90 天免费试用期外，没有免费实例。要直接回答您的问题，Windows Azure 虚拟机实例不是免费的，但是如果您决定选择 XS（超小型）实例，您每月几乎要支付 2 杯啤酒的费用，如下所示：

![在此处输入图像描述](../Images/07bde967351018c2cda51f7807844b88.png)

价格计算器：[https ://www.windowsazure.com/en-us/pricing/calculator/?scenario=virtual-machines](https://www.windowsazure.com/en-us/pricing/calculator/?scenario=virtual-machines)

# php - 如何在 PHP 中获取 JavaScript 变量？

> ID：14007310
> 
> 赞同：3
> 
> 时间：2012-12-22T23:01:49.867
> 
> 标签：php, javascript

我建立了自己的在线 javascript 编辑器，但是当我提交表单时，javascript 不起作用。这是我的代码：

编辑器.php

```
<form action="show.php" method="post" target="window">
HTML code:<br />
<textarea name="html"></textarea><br />
JavaScript code:
<textarea name="javascript"></textarea><br />
<input type="submit" value="Test javascript" />
</form>
<iframe src="show.php" width="880" height="600" name="window"></iframe> 
```

显示.php

```
<html>
<head>
</head>
<body>
<?php
  if(isset($_POST['html'])) echo $_POST['html'];
  echo "<br><br>";
  if(isset($_POST['javascript'])){
    echo "<script>";
    echo $_POST['js'];
    echo "</script>";
  }
?>
</body>
</html> 
```

HTML 运行良好，但是当我在 javascript textarea 中说些什么时，javascript 将无法在 iframe 中运行。请帮我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T23:03:23.870

从您的代码中，我没有看到带有 name 的输入字段`js`，因此我假设以下内容：

```
echo $_POST['js']; 
```

应该：

```
echo $_POST['javascript']; 
```

否则，您的代码应该可以正常工作。

# design-patterns - 存储库是否仅用于单元测试？

> ID：14007312
> 
> 赞同：4
> 
> 时间：2012-12-22T23:02:41.110
> 
> 标签：design-patterns, domain-driven-design, repository-pattern, ddd-repositories

[Ayende](http://ayende.com)前段时间写了一组关于[Repositories 如何成为新的 Singletons](http://ayende.com/blog/3955/repository-is-the-new-singleton)模式的文章。我认为我已经阅读了所有这些内容，并且我同意他的一些观点。大多数时候，我看到有数十个存储库的项目只是为了抽象一个 ORM 的使用，它已经抽象了数据库访问。

在避免它们之后，我开始遇到一些问题来隔离我的 UT 代码，因为一些 ORM 是难以模拟的软件片段，或者至少 EF 是。Ayende 的一些项目使用内存数据库进行了测试，但即使它工作正常，我也不想这样做。

所以，这是我的问题：我不喜欢拥有数十个典型存储库或通用存储库，但是，我希望有一种简单的方法来隔离我的代码。

当前存储库仅对 UT 有用吗？

注意：我说的是数据库访问，而不是抽象其他类型的数据源，如远程服务。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T23:20:17.520

对我来说，存储库（或 DAO）很有用，因为它们将与持久性相关的代码与业务逻辑代码隔离开来。

（期望的）副作用之一是业务逻辑代码和数据访问代码都变得更容易测试。

另一个期望的副作用是，与持久性相关的方法很容易被多个业务逻辑服务重用。

# ruby-on-rails - 在 TODO 列表中显示每个人的所有任务

> ID：14007314
> 
> 赞同：0
> 
> 时间：2012-12-22T23:02:47.163
> 
> 标签：ruby-on-rails

我试图更清楚地问我的问题，因为我认为人们不理解我：

我有一个应用程序：RUBY ON RAILS 中的 TODO LIST。

我想创建类似的东西：

![在此处输入图像描述](../Images/a84b2c6088c2d282e7c971af94572952.png)

我成功创建了第一部分（Tasks Workers），但只有：name、num_of_tasks、num_tasks_left。

现在我想创建：“显示任务”。

当用户按下“任务”的链接时，他将直接进入包含所有任务的页面（带有编辑和删除选项）。

例如，如果用户在一个名为“Alon”的人的行中点击“tasks”链接，他将直接进入一个页面，该页面将显示他的第二部分（Tasks Of Alon）。

为了得到这个输出，我应该添加什么？同时我有一个tasks_controller。

在我解释另一件事之前，我想让你知道第一部分（Tasks Workers）。有一个变量：名称。在每一行中，我打印变量名（他传递了所有数据库）。

为什么我不能执行后续步骤？

1）在tasks_controller中添加一个变量：

```
def show_tasks
    @tasks = Task.where(:name => params[:name])
    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @tasks }
    end
end 
```

2) 定义：show_tasks.html.erb 将显示第二部分（X 的任务）

3) 通过以下方式在 index.html.erb 中创建一个链接：

```
<td><%= link_to 'tasks', show_tasks_path(name) %></td> 
```

然后对于每一行，'name' 变量将被发送到 show_tasks.html.erb。

感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:27:41.797

您应该使用嵌套资源。Google 可以帮助您找到有关它的文档。（或点击这里： http: [//guides.rubyonrails.org/routing.html#nested-resources](http://guides.rubyonrails.org/routing.html#nested-resources)）

基本上，您将有 2 个控制器：TasksController 和 WorkersController（或 TaskWorkersController）

您的 routes.rb 应该包含如下内容：

```
# routes.rb
resources :workers do
  resources :tasks
end 
```

这将生成您需要的路径和助手。请参阅文档，如果您找不到如何操作，我可以为您提供一点帮助，但应该不会太难；）

**一些技巧：**

您的`show_tasks`操作将成为`index`TasksController 的操作，如下所示：

```
@tasks = Task.where(worker_id: params[:id]) # works if your declared Task belongs_to Worker 
```

您显示所有工人（Alon、Dan 等）的`index`操作将是 WorkersController 的操作。

祝你好运！

# magento - Magento 双重产品

> ID：14007322
> 
> 赞同：0
> 
> 时间：2012-12-22T23:03:59.863
> 
> 标签：magento

我正在安装一个带有 2 个网站和一个目录的 magento。一个网站有 2 个商店视图 [罗马尼亚语和英语]，供本地访问者和世界其他地方访问。

事情很简单。当我添加产品时，我只添加一次[作为默认值]，并且不时使用导入/导出功能对其他商店视图进行批量编辑。

现在，我遇到了一些奇怪的问题：一些尚未编辑的产品[英文版]，与其他已经翻译的产品采用了不同的值，并且它们重复了自己。

我会尝试以某种方式“绘制”：

**商店视图 1** [ 与默认值相同 ]      **商店视图 2** [ 英文 ]
Produs Lalala #1 Product Lalala #1
Produs Lalala #2 Product XYZ #1
Produs Lalala #3 Product XYZ #1
Produs Lalala #4 Product XYZ #1
Produs Lalala # 5 产品 XYZ #1

我希望它很清楚，因为我很难以易于理解的方式描述这个问题，即使是用我的母语也是如此。

所以，如果你们中的任何人都经历过类似的事情，或者知道为什么会发生这种情况，我很高兴收到你们的来信。

否则，列出某个商店视图的双重产品名称的最简单方法是什么？

一切顺利！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T07:20:19.150

If a product is visible at the frontend, that means it is created at the backend. So if you say that the product is visible multiple times that means the product is created with different values in the backend. It may be confusing because their names are same. Please check the products that are repeating with different values, you would definitely find the products created and they have those values,please also check the stores they are associated to, it will be easier to find as their names are same.

# javascript - 是否可以在常规 javascript 对象中包含 jQuery 对象？

> ID：14007323
> 
> 赞同：0
> 
> 时间：2012-12-22T23:04:37.740
> 
> 标签：javascript, jquery, object

我最近建立了一个轮播，我一直在尝试通过将所有内容拆分为更小的函数等来清理代码。我一直在尝试将所有变量（也许还​​有函数？）放入一个 Javascript 对象中，以便它与文件中的所有其他代码（它是一个非常大的文件：p）分开。

这是我弄乱的一小段代码

```
$('document').ready(function(){

// an object to hold all of my variables and methods that deal with the infinite carousel
var carouselVars = {
      carouselBgWrapper: $('#carousel_bg_wrapper'),
      carouselItems : $('#carousel_ul li'),                 // a jquery object that holds all the li elements in the carousel ul
      carouselWrapper : $('#carousel_wrapper'),         // a jquery object that holds the carousel wrapper div
      carouselUl : $('#carousel_ul'),                       // a jquery object that holds the carousel ul

      //kept getting firebug error "ReferenceError: carouselWrapper/carouselItems is not defined

              //totalItems : carouselItems.length,
      //itemWidth : carouselItems.eq(1).outerWidth(true),   // size of second item plus its 8px left margin
      //visibleImages : Math.ceil( carouselWrapper.width()/itemWidth ),     // number of items visible at a time ???starting to question this math
      //scrollDistance : itemWidth*visibleImages,                   // number of pixels that need to be animated over when moving left or right
      //neededImages: visibleImages - remainingImages,      // number of images that must be added to the last page to give us a full page

      scrollSpeed : 1200,                                                   // animation duration of the carousel slide (in milliseconds)
      currentPage : 1,                                                      // default current page to 1
      moveRight: function(){
        console.log("move right --- carouselVars");
      }
}

carouselVars.totalItems = carouselNS.carouselItems.length;                                              // the number of li's in the list (will not change)
carouselVars.itemWidth = carouselVars.carouselItems.eq(1).outerWidth(true);                     // width of second item plus its 8px left margin
carouselVars.visibleItems = Math.ceil( carouselVars.carouselWrapper.width()/carouselVars.itemWidth );       // number of items visible at a time
carouselVars.moveDistance = carouselVars.itemWidth*carouselVars.visibleImages;                  // number of pixels to animate over when moving left or right
carouselVars.pages = Math.ceil( carouselVars.totalItems/carouselVars.visibleItems );                // the total number of pages in the carousel
carouselVars.remainingItems = carouselVars.totalItems%carouselVars.visibleItems;                    // number of images that are on last page (might be less than 4)
carouselVars.neededItems = carouselVars.visibleItems - carouselVars.remainingItems;             // number of images that must be added to the last page to give us a full page

carouselNS.carouselBgWrapper.on('click','#carousel_next_item',carouselVars.moveRight());        // move carousel right on mouse click
carouselNS.carouselBgWrapper.on('click','#carousel_prev_item',carouselVars.moveLeft());     // move carousel right on mouse click
}); 
```

对不起，如果代码格式很差。

当我尝试使用此代码时会发生什么，萤火虫吐出以下错误

```
"ReferenceError: carouselItems not defined" 
```

我认为这个问题正在发生，因为我试图获取 ul 中`carouselItems : $('#carousel_ul li')`使用`totalItems = carouselItems.length`.

为了尝试解决这个问题，我尝试将变量单独添加到对象中，看起来我并没有遇到错误，但同时，它对我来说看起来非常臃肿和丑陋。

有没有办法在常规 Javascript 对象中使用 jQuery 对象方法？另外，我正在做的事情是否实用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:26:33.897

这个问题与jQuery无关；这只是因为你想做的事情是不可能的。您不能在初始化期间引用对象。看到这个答案：[https ://stackoverflow.com/a/12789163/551093](https://stackoverflow.com/a/12789163/551093)

但是你可以在之后参考它。例子：

```
var carouselVars = {
      carouselBgWrapper: $('#carousel_bg_wrapper'),
      carouselItems : $('#carousel_ul li'),                 // a jquery object that holds all the li elements in the carousel ul
      carouselWrapper : $('#carousel_wrapper'),         // a jquery object that holds the carousel wrapper div
      carouselUl : $('#carousel_ul'),                       // a jquery object that holds the carousel ul

      ...
}

carouselVars.totalItems = carouselVars.carouselItems.length; 
```

# ruby-on-rails-3 - 仅在 admin 时管理 cancan 中的用户

> ID：14007324
> 
> 赞同：0
> 
> 时间：2012-12-22T23:04:44.847
> 
> 标签：ruby-on-rails-3, cancan

我有这些模型：

公司公司用户用户

CompanyUser 有一个属性 admin 允许他删除该公司的其他用户等。

在cancan，我现在有了这个，但出了点问题：

```
 can [:edit, :update, :read, :destroy, :promote, :demote], CompanyUser, :company_users => { :user_id => user.id, :admin => true } 
```

当他是该公司的管理员时，我只想允许用户编辑，更新，... CompanyUser。我需要如何定义它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T18:52:13.257

此代码应类似于您正在寻找的解决方案：

```
def initialize(user)                                                          
user ||= User.new
can [:manage, :promote, :demote], CompanyUser do |cu|
  user.company_user.admin == true &&            # user is admin and
  user.comany_user.company_id == cu.company_id  # user is in the same company
end 
```

如果与您的具体情况不符，请发布公司、用户和公司用户的型号。

# ruby-on-rails - 在验证中使用嵌套属性中的参数

> ID：14007330
> 
> 赞同：0
> 
> 时间：2012-12-22T23:06:09.157
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我正在构建一个简单的会计应用程序。事务有许多条目，每个条目属于一个事务。每个条目要么是借记条目，要么是贷记条目。所有借方的“金额”字段的总和必须等于每笔交易的所有贷方的总和。所以在我的交易模型中，我有以下内容：

事务.rb

```
attr_accessible :entries_attributes
has_many :entries
accepts_nested_attributes_for :entries

validate :entries_sum_to_zero

private

    def entries_sum_to_zero
        errors.add(:base, "Debits and credits must balance.") unless self.entries.where(:entry_type => 'Credit').sum(:amount) == self.entries.where(:entry_type => 'Debit').sum(:amount)
    end 
```

但这不起作用。它不会抛出错误，但如果不满足条件，它也不会停止事务和所有条目保存到数据库中。我认为这可能与条目模型中的“数量”在条目属性的参数散列中有关。是这样吗？如果是这样，我如何重写上面的代码以在保存交易之前对 entry_attributes 参数哈希中的金额求和？

谢谢。

更新：

我也试过这个，但它似乎也没有工作：

```
before_save :entries_sum_to_zero

private
    def entries_sum_to_zero
       if self.entries.where(:entry_type => 'Credit').sum(:amount) != self.entries.where(:entry_type => 'Debit').sum(:amount)
           errors.add(:base, "Debits and credits must balance.")
           return false
       end
    end 
```

更新 2：

我最终通过将验证移到控制器中来让它工作。但是如何将其移回模型中，以便将验证保存在一个地方？

```
def create
    @company = Company.find(params[:company_id])
    @transaction = @company.transactions.new(params[:transaction])
    sum_of_debits = 0
    sum_of_credits = 0      
    params[:transaction]['entries_attributes'].each do |k,v|
        sum_of_debits += v['amount'].to_i if v['entry_type'] == "Debit"
        sum_of_credits += v['amount'].to_i if v['entry_type'] == "Credit"
    end
    if sum_of_credits != sum_of_debits
        flash[:error] = "Debits and Credits must balance."
        render 'new'
    else        
        if @transaction.save
            flash[:success] = "Transaction added"
            redirect_to company_path(@company)
        else
            render 'new'
        end   
    end       
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:29:12.807

验证方法中的问题。您向数据库询问两个总和并且验证顺利，因为您的新条目尚不存在于数据库中。你必须只检查entry_attributes（因为我们可以假设，那么数据库中的一切都很好）

# c# - 如何将 FileInfo 转换为 FileInfo[]

> ID：14007334
> 
> 赞同：0
> 
> 时间：2012-12-22T23:06:23.737
> 
> 标签：c#, .net, string, linq, system.io.fileinfo

我一直在开发一个程序，该程序需要不同的方法来使用嵌套在另一个中的 try 和 catch 来完成工作`try/catch`。

为此，我不得不将一组文件创建为字符串，然后将它们转换为`FileInfo`.

```
IEnumerable<string> paths = null;
foreach (String fil in paths)
    FileInfo h = new FileInfo(fil); 
```

所以这并不难，但是我需要`FileInfo`以`FileInfo[]`数组的形式继续程序。

```
System.IO.FileInfo[] files = null; 
```

简而言之，将一种类型转换为另一种类型的最佳方法是什么，或者直接从转换`FileInfo`为`FileInfo`数组（`FileInfo[]`）的字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T23:10:09.320

是的，或者创建一个单项数组：

```
FileInfo[] files = new FileInfo[] { info }; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T23:08:31.800

为什么不直接？

```
paths.Select(p => new FileInfo(p)).ToArray(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T23:09:29.060

利用：

```
var result = paths.Select(p => new FileInfo(p)).ToArray(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T23:11:24.010

您可以只使用`Linq`select 来创建您的`FileInfo[]`

```
 IEnumerable<string> paths = null; // assuming you are going to fill this with filenames
 FileInfo[] fileInfos = paths.Select(p => new FileInfo(p)).ToArray(); 
```

# javascript - 服务器通过 Javascript 请求默认文本字段值

> ID：14007336
> 
> 赞同：0
> 
> 时间：2012-12-22T23:06:35.913
> 
> 标签：javascript, jquery, html

根据用户的选择，文本字段框保持隐藏：

```
$("#aForm").on("change", function() { 
if ($(this).val() == "a") 
    $("#textField").hide();
else 
    $("#textField").show(); 
}); 
```

问题是服务器期望`textfield`框中的值。那么，即使文本框被隐藏，我如何才能只插入一个空字符串，然后将其发送到服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:14:15.063

隐藏值仍将值发送到服务器。因此，您可以在切换显示/隐藏时设置默认值。

```
$("#aForm").on("change", function() { 
    if ($(this).val() == "a") {
        $("#textField").hide();
        $("#textField").val("This textbox is hidden and has a default value");
    } else {
        $("#textField").show(); 
        $("#textField").val(""); // reset the value
    }
}); 
```

# ll - LL 语法排除左递归的形式原因

> ID：14007337
> 
> 赞同：1
> 
> 时间：2012-12-22T23:06:46.083
> 
> 标签：ll

我目前在空闲时间阅读《龙书》。该书指出，**当且仅当**对于任何产生式 A -> a|b，语法是 LL，以下两个条件适用。

1) FIRST(a) 和 FIRST(b) 是不相交的。这意味着它们不能都导出 EMPTY

2) 如果 'b' 可以导出 EMPTY，那么 'a' 不能导出任何以 FOLLOW(A) 开头的字符串

我知道 LL 解析器一般不能处理左递归，但是如果我做一个语法

S -> S(S) | 空的，

FIRST(S) = {'('} 和 FOLLOW(S) = {EOF}。这似乎与两条规则中的任何一条都不矛盾，我是否遗漏了什么？

提前谢谢你，迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:33:55.670

已经有一段时间了，但我认为 FOLLOWS(S) = {EOF,')','('}。

# java - ButtonClick 上的 Java 图形重绘（）

> ID：14007338
> 
> 赞同：4
> 
> 时间：2012-12-22T23:06:54.283
> 
> 标签：java, swing

我有这段代码，想在按下按钮时重新绘制我的图形：

```
public class JDraw extends JFrame {

/**
 * Draws a figur in a JFrame.
 * The color of it is random and can get changed by a button.
 */

public static JButton okButton = new JButton("change color");

public JDraw(String newTitel) {
    super.setTitle(newTitel);
}

//Main method
public static void main(String str[]) {
    JDraw window = new JDraw("Graphic");
    window.setSize(300, 450);
    window.setVisible(true);
    window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    window.add(okButton, BorderLayout.SOUTH);

    okButton.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            //JDraw.repaint(); <-- problem
        }
    });
}

@Override
public void paint(final Graphics g) {

    super.paint(g);

    Random rand = new Random();
    int r1 = rand.nextInt(255);
    int b1 = rand.nextInt(255);
    int g1 = rand.nextInt(255);
    g.setColor(new Color(r1, g1, b1));

    //head
    g.drawOval(100, 50, 100, 100);
    g.fillOval(100, 50, 100, 100); // filled
    //more drawing stuff.....

}
} 
```

但是我不知道该怎么做，因为我无法在我的 ActionPerfomed 中进行重绘。错误：无法从静态上下文引用非静态方法 repaint()

我希望有人能帮忙。:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-22T23:13:09.110

您需要在您的`actionPerformed`:

```
window.repaint(); 
```

为了能够`window`从您内部引用`actionPerformed`，您需要使您的窗口变量`final`：

```
final JDraw window = ...; 
```

但是，如果我可以提出一些改进建议：

1.  不要延长`JFrame`
2.  不要`paint(Graphics)`覆盖`JFrame`
3.  而是创建一个扩展`JComponent`或`JPanel`将其设置为`JFrame`
4.  而`paint(Graphics)`不是覆盖，而是覆盖`paintComponent(Graphics)`
5.  你`okButton`不应该`static`。而是将所有代码移动到非静态方法`initUI()`中，例如`new JDraw().initUI();`
6.  将启动 UI 的代码包装在 a 中`SwingUtilities.invokeLater(Runnable)`，以便从事件调度线程正确启动 UI。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-22T23:12:29.370

您不能引用 JDraw 类。您应该改用一个对象。您的情况下的对象是`window`. 所以，使用：

```
window.repaint(); 
```

就像在说：*人类，走到门口。*人是阶级。你不能告诉 Human 做某事，你需要一个 Human 的实例，比如 Obama 或 Santa Claus。在您的情况下：您不能告诉 JDraw 重新绘制，而是 JDraw 类型的对象，即：`window`。

# apache - htaccess 从文件夹而不是子文件夹永久重定向到主页

> ID：14007342
> 
> 赞同：1
> 
> 时间：2012-12-22T23:08:17.987
> 
> 标签：apache, .htaccess, redirect, rewrite

我想将尝试访问 www.mysite.com/folder 或 mysite.com/folder 的用户重定向到主页。但是，如果有人没有访问 www 或 www.mysite.com/folder/subfolder 或者当他们访问没有 www 或 www.mysite.com/folder/awesome-page.html 时，我不希望它适用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:53:51.883

你可以试试这个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_URI} ^/[^/]+/?$
RewriteRule .* / [L,R=301,DPI] 
```

将重定向

`http://www.mysite.com/folder`或`http://mysite.com/folder`_

`http://www.mysite.com`或 to `http://mysite.com`，但绝不会在请求的 URL 有 2 个或更多文件夹时，例如：

`http://www.mysite.com/folder/OtherFolder/...`

# php - 获取父节点及其子节点，其中子节点具有特定文本

> ID：14007344
> 
> 赞同：2
> 
> 时间：2012-12-22T23:08:19.457
> 
> 标签：php, html, xpath

我正在尝试检索父节点及其子节点，其中子节点具有特定文本。

这是我的html：

```
<bod>
    <div>
         <span>something</span>
    </div>
</body> 
```

我正在使用以下方法来抓孩子：

```
 $the_child = $xpath->query('(//*[text()[contains(., "something")]])[1]'); 
```

但我怎么也能抓住他的第一任父母？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T23:09:43.437

一旦你有了这个项目，就得到它的`->parentNode`属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:31:01.847

**纯 XPath 解决方案：**

```
(//*[*[contains(., 'something')]])[1] | (//*/*[contains(., 'something')])[1] 
```

# javascript - 显示 Flash 消息时添加 DOM 膨胀

> ID：14007363
> 
> 赞同：0
> 
> 时间：2012-12-22T23:12:07.890
> 
> 标签：javascript, jquery, ruby-on-rails, ruby, erb

在我的 Rails 应用程序中，当用户保存时，它使用 Ajax 保存帖子，然后执行 update.js.erb 文件。在那个文件中，我有一些 jQuery：

```
$('body').append('<div class="message">Saved</div>'); 
```

因为我有这种方式，所以每次用户保存时，它都会`<div class="message">Saved</div>`在正文中添加更多内容。有没有办法可以阻止它或者没关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:14:48.417

首先，除非保存发生数千次，否则可能无关紧要。请记住，图像非常大，因此与几张图像相比，网页中几 kb 的额外文本显得苍白无力。

其次，您有几个选项可以在 DOM 中只拥有其中一个：

1.  将其展示给用户后，将其从 DOM 中移除（可能在计时器上）。
2.  拥有一条且只有一条消息并在需要时显示/隐藏它（这可能是最简单的）。
3.  查看是否已经在页面中并重复使用它。

例如，要查找以前的消息对象（开始时是隐藏的）并将其显示一小段时间，您可以使用以下命令：

```
$(".message").html("Saved").show().delay(2000).fadeOut(1000); 
```

如果您使用它，您只需将消息对象放在您的页面中一次，无论是在原始页面 HTML 中还是在页面启动代码中附加一次。然后，让 CSS 将其默认为隐藏，以便仅在您希望时显示。

或者，如果你使用基于类名的 CSS3 过渡，你可以只使用 jQuery`addClass()`和`removeClass()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:15:21.477

一种懒惰（但简单）的方法是在显示新消息之前清除其他消息：

```
$('.message').remove();
$('body').append('<div class="message">Saved</div>'); 
```

# clojure - 在 Liberator 中的 201 Created 响应中返回 Location 标头

> ID：14007366
> 
> 赞同：3
> 
> 时间：2012-12-22T23:12:32.607
> 
> 标签：clojure, liberator

我正在尝试使用 Liberator 实现一个集合资源，其中`POST`对集合 URL（例如）的请求`/posts`将创建一个新的博客文章项目。这工作正常。不工作的是使用包含指向新 URL 的标头（例如）`POST`的响应来响应请求。`201 Created``Location``/posts/1`

我可以使用 a 进行响应`201 Created`，但是我无法包含`Location`标头响应，因此客户端将不知道新 URL 是什么，或者我可以设置`:post-redirect? true`，并返回`303 See Other`带有标头的响应`Location`。

有没有办法从 Liberator POST 处理程序返回 a`201 Created` *和*标头？`Location`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:43:22.490

每个处理程序都可以使用 ring-response 返回一个完整的环响应，包括标头：

```
(defresource baz
  :method-allowed? true
  :new? true
  :exists? true
  :post! (fn [ctx] {::location "http://example.com"})
  :post-redirect? false 
  :handle-created (fn [{l ::location }] 
                    (ring-response {:headers {"Location" l}})) 
```

# android - API 14 之前的 Android 网络发现服务 (ish)

> ID：14007372
> 
> 赞同：2
> 
> 时间：2012-12-22T23:13:15.953
> 
> 标签：android, networking, discovery

我需要能够发现本地网络上的服务（假设我正在运行一个聊天应用程序，并且我想发现本地网络上运行此聊天的其他设备），但遗憾的是我需要能够在设备上使用它API < 16（所以我不能使用 android.net.nsd） 我确信这可以在不使用 NSD API 的情况下完成。问题是如何。有什么帮助吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-23T01:28:04.210

至少有三四个选项。

您可以使用

TCP 或 UDP

1.  广播地址
2.  组播地址
3.  遍历网络中的所有地址

HTTP

4 利用外部服务器或 GCM（谷歌云消息）之类的东西

广告 1 和 2

优点：

+易于实现，服务器在特定端口上的子网/网络的广播/多播地址上发送预定义的“hello”消息，客户端正在侦听该端口，当“hello”消息到达时，他会自动知道服务器 IP 地址（包含在包）

+不需要连接到互联网

缺点：

*   一些公共网络会阻止此地址以避免攻击（例如泛洪）。

广告 3。

优点：

当组播和广播被阻止时，您可以做的只是遍历整个子网。这是“蛮力”方法，但有效，特别是在掩码为 /24 的典型家庭/小型网络上 - 只有 255 个地址可以迭代。

也不需要连接到互联网

缺点

当使用掩码 /16 时，迭代所有 IP 将花费大量时间

会导致电池耗尽

并将淹没网络。

广告。4

另一种方法是制作一些外部服务器，作为设备的“定位点”。他们每个人都发送自己的地址，并查看是否有来自同一网络的其他设备的一些条目。

当然需要互联网连接。

所以，我认为从广播和多播开始是个好主意，因为它非常简单并且可以在很多地方工作，但请记住，有些网络是不允许使用的。

可以在这里找到很好的参考[http://docs.oracle.com/javase/tutorial/networking/datagrams/broadcasting.html](http://docs.oracle.com/javase/tutorial/networking/datagrams/broadcasting.html)

您还应该检查这个[http://home.heeere.com/tech-androidjmdns.html](http://home.heeere.com/tech-androidjmdns.html)

# dynamics-crm-2011 - 在执行冗长操作时显示微调器的默认且简单的方法

> ID：14007382
> 
> 赞同：2
> 
> 时间：2012-12-22T23:14:54.090
> 
> 标签：dynamics-crm-2011, dynamics-crm-4, dynamics-crm-online, dynamics-crm-2013

当我的用户使用他们的表单时，我正在传输大量数据。除了尝试优化代码以确保最快的连接外，我还想在表单中间显示一个旋转图像，以通知用户该软件正在为尽快获取信息而出汗。

我想指出以下注意事项。

*   我可以使用任意动画图像（例如 abc.gif）吗？
*   是否可以（甚至建议）使用 CRM 中的默认微调器？
*   这样的解决方案是否也适用于旧版本的 CRM？
*   是否有可能（推荐，也许）使用 jQuery，它的效果很酷？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T10:02:23.670

1.  是的，您可以使用任何动画 gif。在 CRM 2011 中添加为 Web 资源。
2.  您可以采用默认微调器并添加为 Web 资源。我强烈建议您不要尝试直接解决它。
3.  是的，但是您管理脚本的方式较少。没有可在 CRM4 中使用的解决方案或 Web 资源。
4.  绝对地。见下文。

jQuery 插件[BlockUI](http://jquery.malsup.com/block/#download)是最流行的可能长时间运行的 OData 调用之一，您需要从中阻止进一步的 UI 交互。

由于您需要直接附加到 DOM 元素，因此不支持使用它。但是，只要您坚持附加到`<body>`元素并避免深入到 DOM 中，例如在特定表单部分的标记上，您就可以了。

对于 CRM 2011，我们使用我们自己的 Web 资源来包装 BlockUI，它提供了一个非常简单的 API，可以强制对元素进行一致的绑定，该`<body>`元素还检查表单中是否包含 jQuery 和 BlockUI 脚本（Web 资源）。

同样的交易适用于 CRM 4，但脚本管理更多地取决于您的团队当前如何管理自定义和依赖项。

你越容易使用它，团队中的其他开发人员就越不可能离开并尝试自己动手，从而在最终的用户体验中造成可怕的不一致。

# jquery - 多个 JQuery UI Autcomplete 框 - 获取所选框的值

> ID：14007383
> 
> 赞同：1
> 
> 时间：2012-12-22T23:14:57.410
> 
> 标签：jquery, autocomplete, jquery-ui-autocomplete

我在一个页面上有三个 jQuery UI 'Autocomplete' 输入字段：

```
<select id="combobox1"><?php putSome1ValuesHere(); ?></select>
<select id="combobox2"><?php putSome2ValuesHere(); ?></select>
<select id="combobox3"><?php putSome3ValuesHere(); ?></select> 
```

并将它们全部放入组合框可以正常工作：

```
$(function() {
    $( "#combobox1" ).combobox();
    $( "#combobox2" ).combobox();
    $( "#combobox3" ).combobox();
}); 
```

我想做的是根据组合框中选择的值重定向到另一个页面。如果我明确命名其中一个框，这会很好：

```
select: function( event, ui ) {
    ui.item.option.selected = true;
    that._trigger( "selected", event, {
        item: ui.item.option
    });
    window.location.href = $('#combobox1').val() + ".php";
}, 
```

我不能做的是根据单击的组合框的值使其重定向。我无法对其进行硬接线，因为可以单击三个框中的任何一个。但是，我对 jQuery 的了解还不够，无法访问调用“选择”函数的框的值。如果有人能提供任何建议，我将不胜感激。我想我已经在上面包含了足够的信息，但是如果需要任何东西，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:19:21.150

在组合框小部件代码`select`中是已隐藏的选择标记的 jQuery 对象

```
window.location.href = select.val() + ".php"; 
```

演示使用`select.val()` [http://jsfiddle.net/YBFAr/](http://jsfiddle.net/YBFAr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:22:40.437

改变这个

```
select: function( event, ui ) {
  ui.item.option.selected = true;
  that._trigger( "selected", event, {
      item: ui.item.option
 });
 window.location.href = $('#combobox1').val() + ".php";
}, 
```

到

```
select: function( event, ui ) {
    ui.item.option.selected = true;
    that._trigger( "selected", event, {
    item: ui.item.option
    });
    window.location.href = $(this).val() + ".php";
}, 
```

希望这可以帮助

# c# - 为什么我的组合框不允许我向它添加值？

> ID：14007390
> 
> 赞同：0
> 
> 时间：2012-12-22T23:15:45.773
> 
> 标签：c#, windows-8, combobox, winrt-xaml, windows-store-apps

我有这个 WinRT XAML：

```
<ComboBox x:Name="comboxGroupName" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3" Margin="4" Width="200" Height="36" HorizontalAlignment="Left" ></ComboBox> 
```

但是，当我单击它输入新值时，它似乎将自己转换为只读文本框（它丢失了向下箭头并且不允许在其中输入任何内容）。我需要做什么才能允许将值添加到组合框中？还是我需要使用单独的 TextBox 来做到这一点（我认为是这样，但如果可能的话，我想避免这种情况）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:52:23.153

看起来您唯一的选择是使用单独的文本框。有一个[`IsEditable`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.combobox.iseditable.aspx)属性，但它指出：

> 获取一个值，该值指示用户是否可以编辑 ComboBox 的文本框部分中的文本。此属性始终返回 false。

和[`ComboBox`](http://msdn.microsoft.com/en-us/library/windows/apps/br209348.aspx)页面状态：

> 您可以通过将对象直接添加到 Items 集合或将 ItemsSource 属性绑定到数据源来填充 ComboBox。添加到 ComboBox 的项目被包装在 ComboBoxItem 容器中。

# nginx - /etc/nginx/sites-enabled/example.com + HttpUploadProgressModule 中的未知指令“”

> ID：14007391
> 
> 赞同：1
> 
> 时间：2012-12-22T23:15:46.427
> 
> 标签：nginx

我试图理解为什么几乎相同的 nginx/HttpUploadProgressModule 配置在我的本地 Ubuntu 下工作，而在 Linode 服务器上却没有。

长话短说：从源代码配置 nginx 以包含 HttpUploadProgressModule 模块支持（（[http://wiki.nginx.org/HttpUploadProgressModule#Installation](http://wiki.nginx.org/HttpUploadProgressModule#Installation)，[https://github.com/masterzen/nginx-upload-progress-module](https://github.com/masterzen/nginx-upload-progress-module)）

使用相同的 1.2.4 nginx，本地和服务器上的相同虚拟主机配置。现在我在服务器上重新加载 nginx 时出错：

```
Restarting nginx: nginx: [emerg] unknown directive "  " in /etc/nginx/sites-enabled/example.com:12
location ~ (?<upload_form_uri>.*)/x-progress-id:(?<upload_id>\d*) {
#Line 12 below #
rewrite ^ $upload_form_uri?X-Progress-ID=$upload_id; 
# Line 12 above #
} 
```

但它在本地工作得很好。下面是 nginx-V 和`ldd /usr/sbin/nginx`比较，这让我到目前为止也没有谷歌搜索：

![在此处输入图像描述](../Images/74ccc5a481f8070c74eedee97585a147.png)

![在此处输入图像描述](../Images/0db8724d65e7a00b452289433b2298d9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T09:48:05.617

某些东西显然会导致 nginx 配置解析器无法正常工作。

带有命名反向引用的正则表达式引起了我的注意。Nginx 使用 PCRE 库来解析正则表达式，所以这应该是有效的语法

请参阅此内容以了解捕获组和命名/未命名反向引用 [http://regular-expressions.mobi/named.html](http://regular-expressions.mobi/named.html)

试试这个

```
location ~ (.*)/x-progress-id:([0-9]+) {
    set $upload_form_uri $1;
    set $progress_id $2;
    rewrite .* $upload_form_uri?X-Progress-ID=$progress_id;
} 
```

相同的含义，但更基本的语法。如果这没有帮助，则需要进行更多调查。

# windows-8 - 视觉工作室 2012 allegro 5 x64 链接器

> ID：14007394
> 
> 赞同：0
> 
> 时间：2012-12-22T23:16:30.490
> 
> 标签：windows-8, visual-studio-2012, 64-bit, allegro5

我遇到了与[无法在 MSVC 2012 中构建 Allegro 5 解决方案](https://stackoverflow.com/questions/13490085/cant-build-allegro-5-solution-in-msvc-2012)相同的问题，但我的项目是 x64 并且我有 Win8 x64 专业版。当我转向 Win32 时，一切都很好。但是当转向 x64 我有这个：

```
1>------ Build started: Project: test_allegro, Configuration: Debug x64 ------
1>main.obj : error LNK2019: unresolved external symbol al_install_system referenced in function main
1>main.obj : error LNK2019: unresolved external symbol al_rest referenced in function main
1>main.obj : error LNK2019: unresolved external symbol al_map_rgb referenced in function main
1>main.obj : error LNK2019: unresolved external symbol al_create_display referenced in function main
1>main.obj : error LNK2019: unresolved external symbol al_destroy_display referenced in function main
1>main.obj : error LNK2019: unresolved external symbol al_flip_display referenced in function main
1>main.obj : error LNK2019: unresolved external symbol al_clear_to_color referenced in function main
1>D:\Biblioteki\Dropbox\studia\przedmioty\sem_3\aisdi\laboratorium\test_allegro\x64\Debug\test_allegro.exe : fatal error LNK1120: 7 unresolved externals
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

有任何想法吗？我的项目必须是 x64 ...

# r - RS-DBI 驱动程序警告：（作为字符导入的第 1 列中无法识别的 MySQL 字段类型 7）

> ID：14007397
> 
> 赞同：5
> 
> 时间：2012-12-22T23:16:52.293
> 
> 标签：r, rmysql

我正在尝试运行一个适用于 MySQL 或其他 MySQL 连接器 API 的简单查询，

```
SELECT * FROM `table` WHERE type = 'farmer' 
```

我尝试了使用 RMySQL 包的各种方法，它们都得到相同的错误 `RS-DBI driver warning: (unrecognized MySQL field type 7 in column 1 imported as character)`

```
Type = 'farmer'
(Query<-paste0("SELECT * FROM `table` WHERE type = '%",Type,"%'")) 
res<-dbGetQuery(con, Query)

Query<-paste("SELECT * FROM `table` WHERE type = \'farmer\'")

Query<-paste("SELECT * FROM `table` WHERE type = 'farmer'") 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-23T14:37:40.353

“类型”是 MYSQL 中的关键字。用反引号包围它以转义字段名称。

```
SELECT * FROM `table` WHERE `type` = 'farmer' 
```

此外，您的表中可能有一个时间戳列。已知 R 无法识别该列类型。将其转换为 SQL 语句部分中的 unix 时间戳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:21:53.363

看起来 db 模式在列中具有类型 7 的内容——并且 RMySQL 驱动程序似乎不知道该类型。

我尝试在查询中排除第一列，或者将其转换为`select * ...`级别，例如通过类似

```
 select foo as character, bar, bim, bom from 'table' where ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-29T00:52:22.820

需要明确的是，当我遇到此错误消息时，是因为我的数据字段是时间戳。

我通过更改`SELECT created_at FROM ...`导致错误的查询来验证这一点。我还通过更改查询以**不**包括时间戳的列名来验证这一点，然后我没有错误。

还要注意，错误消息从 0 开始计算列（而不是像 R 那样从 1 开始）

恕我直言，答案是您没有做错任何事情，但这是需要在 RMySQL 中修复的问题。

解决方法是在您读入数据后，您需要调用几个可能的字符到日期时间转换函数之一。（哪一个取决于你想对时间戳做什么。）

# c# - 如何创建列表的新深层副本（克隆） ?

> ID：14007405
> 
> 赞同：82
> 
> 时间：2012-12-22T23:18:41.227
> 
> 标签：c#, list, clone, deep-copy

在下面的一段代码中，

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;

namespace clone_test_01
{

    public partial class MainForm : Form
    {

        public class Book
        {
            public string title = "";

            public Book(string title)
            {
                this.title = title;
            }
        }

        public MainForm()
        {
            InitializeComponent();

            List<Book> books_1 = new List<Book>();
            books_1.Add(  new Book("One")  );
            books_1.Add(  new Book("Two")  );
            books_1.Add(  new Book("Three")  );
            books_1.Add(  new Book("Four")  );

            List<Book> books_2 = new List<Book>(books_1);

            books_2[0].title = "Five";
            books_2[1].title = "Six";

            textBox1.Text = books_1[0].title;
            textBox2.Text = books_1[1].title;
        }
    }

} 
```

我使用一个`Book`对象类型来创建一个`List<T>`，并用一些项目填充它，给它们一个唯一的标题（从“一”到“五”）。

然后我创建`List<Book> books_2 = new List<Book>(books_1)`.

从这一点来看，我知道它是 list 对象的克隆，但是来自`book_2`的 book 对象仍然是来自 book 对象的引用`books_1`。通过对 的前两个元素进行更改`books_2`，然后检查 a 中的相同元素来`book_1`证明这一点`TextBox`。

`books_1[0].title and books_2[1].title`确实已更改为 的新值`books_2[0].title and books_2[1].title`。

**现在的问题**

我们如何创建一个新的硬拷贝`List<T>`？这个想法是，`books_1`并且`books_2`变得完全独立于彼此。

我很失望微软没有像 Ruby 那样提供简洁、快速和简单的解决方案`clone()`。

帮助者真正令人敬畏的是使用我的代码并使用可行的解决方案对其进行更改，以便可以编译和工作。我认为这将真正帮助新手了解为这个问题提供的解决方案。

编辑：请注意，`Book`该类可能更复杂并具有更多属性。我试图让事情变得简单。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2012-12-22T23:20:19.890

您需要创建新`Book`对象，然后将它们放入一个新的`List`：

```
List<Book> books_2 = books_1.Select(book => new Book(book.title)).ToList(); 
```

更新：稍微简单...`List<T>`有一个方法调用[`ConvertAll`](http://msdn.microsoft.com/en-us/library/73fe8cwf.aspx)，返回一个新的列表：

```
List<Book> books_2 = books_1.ConvertAll(book => new Book(book.title)); 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-12-22T23:56:22.763

创建一个`ICloneable<T>`您在`Book`类中实现的通用接口，以便该类知道如何创建自身的副本。

```
public interface ICloneable<T>
{
    T Clone();
}

public class Book : ICloneable<Book>
{
    public Book Clone()
    {
        return new Book { /* set properties */ };
    }
} 
```

然后，您可以使用`ConvertAll`Mark 提到的 linq 或方法。

```
List<Book> books_2 = books_1.Select(book => book.Clone()).ToList(); 
```

或者

```
List<Book> books_2 = books_1.ConvertAll(book => book.Clone()); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-12-23T00:19:14.263

> 我很失望微软没有像 Ruby 那样提供简洁、快速和简单的解决方案`clone()`。

除了*不*创建深拷贝外，它会创建浅拷贝。

使用深度复制，您必须始终小心，您究竟想要复制什么。可能的问题的一些例子是：

1.  在对象图中循环。例如，`Book`有一个`Author`并且`Author`有一个他`Book`的列表。
2.  引用一些外部对象。例如，一个对象可能包含`Stream`写入文件的 open。
3.  事件。如果一个对象包含一个事件，几乎任何人都可以订阅它。如果订阅者是 GUI 之类的东西，这可能会变得特别成问题`Window`。

现在，基本上有两种方法可以克隆一些东西：

1.  `Clone()`在需要克隆的每个类中实现一个方法。（也有`ICloneable`接口，但你不应该*使用*它；使用`ICloneable<T>`Trevor 建议的自定义接口是可以的。）如果你知道你所需要的只是为这个类的每个字段创建一个浅表副本，你可以使用[`MemberwiseClone()`](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)它来实现它. 作为替代方案，您可以创建一个“复制构造函数”：`public Book(Book original)`.
2.  使用序列化将您的对象序列化为 a`MemoryStream`然后反序列化它们。这需要您将每个类标记为`[Serializable]`，并且还可以配置应该序列化的确切内容（以及如何）。但这更像是一种“快速而肮脏”的解决方案，而且很可能性能也会降低。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-03-27T12:50:07.543

好，

如果将所有涉及的类标记为可序列化，则可以：

```
public static List<T> CloneList<T>(List<T> oldList)  
{  
BinaryFormatter formatter = new BinaryFormatter();  
MemoryStream stream = new MemoryStream();  
formatter.Serialize(stream, oldList);  
stream.Position = 0;  
return (List<T>)formatter.Deserialize(stream);      
} 
```

来源：

[https://social.msdn.microsoft.com/Forums/en-US/5c9b4c31-850d-41c4-8ea3-fae734b348c4/copy-listsomeobject-to-clone-list?forum=csharpgeneral](https://social.msdn.microsoft.com/Forums/en-US/5c9b4c31-850d-41c4-8ea3-fae734b348c4/copy-listsomeobject-to-clone-list?forum=csharpgeneral)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-04-24T13:55:54.577

你可以使用这个：

```
var newList= JsonConvert.DeserializeObject<List<Book>>(list.toJson()); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-04-16T02:25:03.120

```
List<Book> books_2 = new List<Book>(books_2.ToArray()); 
```

那应该完全符合您的要求。[在这里演示。](https://dotnetfiddle.net/JG9BV0)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2021-01-05T18:26:24.253

C# 9[记录](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-9#record-types)和[with 表达式](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/with-expression)可以使它更容易一些，特别是如果你的类型有很多属性。

你可以使用类似的东西：

```
var books2 = books1.Select(b => b with { }).ToList(); 
```

我以此**为例**：

```
record Book
{
    public string Name { get; set; }
}

static void Main()
{
    List<Book> books1 = new List<Book>()
    {
        new Book { Name = "Book1.1" },
        new Book { Name = "Book1.2" },
        new Book { Name = "Book1.3" }
    };

    var books2 = books1.Select(b => b with { }).ToList();

    books2[0].Name = "Changed";
    books2[1].Name = "Changed";

    Console.WriteLine("Books1 contains:");
    foreach (var item in books1)
    {
        Console.WriteLine(item);
    }

    Console.WriteLine("Books2 contains:");
    foreach (var item in books2)
    {
        Console.WriteLine(item);
    }
} 
```

输出是：（对 Books2 中的对象所做的更改不会影响 Books1 中的原始对象）

> Books1 包含：
> 
> 书{名称=书1.1}
> 
> 书{名称=书1.2}
> 
> 书{名称=书1.3}
> 
> Books2 包含：
> 
> 书{名称=已更改}
> 
> 书{名称=已更改}
> 
> 书{名称=书1.3}

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-01T21:29:00.330

由于`Clone`将返回 Book 的对象实例，因此首先需要将该对象强制转换为 Book，然后才能调用`ToList`它。上面的例子需要写成：

```
List<Book> books_2 = books_1.Select(book => (Book)book.Clone()).ToList(); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-01-29T15:23:58.627

```
public static class Cloner
{
    public static T Clone<T>(this T item)
    {
        FieldInfo[] fis = item.GetType().GetFields(BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic);
        object tempMyClass = Activator.CreateInstance(item.GetType());
        foreach (FieldInfo fi in fis)
        {
            if (fi.FieldType.Namespace != item.GetType().Namespace)
                fi.SetValue(tempMyClass, fi.GetValue(item));
            else
            {
                object obj = fi.GetValue(item);
                if (obj != null)
                    fi.SetValue(tempMyClass, obj.Clone());
            }
        }
        return (T)tempMyClass;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-15T15:12:53.417

如果 Array 类满足您的需求，您还可以使用 List.ToArray 方法，该方法将元素复制到新数组中。

参考： http: [//msdn.microsoft.com/en-us/library/x303t819 (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/x303t819(v=vs.110).aspx)

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2020-02-01T09:44:32.420

直接复制任何通用列表的简单方法：

```
List<whatever> originalCopy=new List<whatever>();//create new list
originalCopy.AddRange(original);//perform copy of original list 
```

# java - 如何使用 OnTouchEvent 多次加载新的 contentView

> ID：14007412
> 
> 赞同：0
> 
> 时间：2012-12-22T23:19:14.867
> 
> 标签：java, android

如何使用 OnTouchEvent 多次加载新的 contentView？我有 4 个启动画面，我想在用户触摸上一个启动画面后显示它们。我正在尝试使用布尔值和 if 语句来加载它们，但它不会让我更改 if 中的布尔值。

非常感谢！

```
public boolean onTouchEvent(MotionEvent e) {
    // TODO Auto-generated method stub
    // return super.onTouchEvent(e);

    if (e.getAction() == MotionEvent.ACTION_UP && intro1() == false) {
        intro1();

    }
    if (e.getAction() == MotionEvent.ACTION_UP && intro2() == false) {
        intro2();
    }
    if (e.getAction() == MotionEvent.ACTION_UP && intro3() == false) {
        intro3();
    }
    return false;
}

public boolean intro1() {

    setContentView(R.layout.splash2);
    return false;
}

public boolean intro2() {

    setContentView(R.layout.splash3);
    return false;
}

public boolean intro3() {

    setContentView(R.layout.splash4);
    return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:44:37.920

像这样的东西怎么样：

```
int splash=0;
public boolean onTouchEvent(MotionEvent e) {
// TODO Auto-generated method stub
// return super.onTouchEvent(e);

if (e.getAction() == MotionEvent.ACTION_UP  {
    switch (splash++) {
     case 1:
      intro1();
      break;
     case 2:
      intro2();
      break;
     case 3:
      intro3();
      break;
      default:
      //do someting else
    }
}

return false; 
```

}

# brainfuck - Brainfuck 修改版本的图灵完备性

> ID：14007414
> 
> 赞同：8
> 
> 时间：2012-12-22T23:19:23.010
> 
> 标签：brainfuck, computability

如果单元格是位，并且 + 和 - 操作只是稍微翻转一下，[Brainfuck Turing 是否完整？](http://en.wikipedia.org/wiki/Brainfuck)是否有一个简单的证据证明类似 Brainfuck 的语言无论单元大小如何都是图灵完备的，还是我需要考虑一个模拟图灵机的程序？如果没有，我怎么知道？

编辑：我找到了问题的答案：Brainfuck with bit cells 被称为[Boolfuck](http://samuelhughes.com/boof/)。普通的 Brainfuck 可以简化为它，所以 Boolfuck 是图灵完备的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-17T21:50:34.343

[这个答案](https://softwareengineering.stackexchange.com/a/132420/93291)应该很适合你；它对使语言图灵完备的特性有一个非常具体的定义。

这是它的要点：

> 一般来说，要使命令式语言成为图灵完备的，它需要：
> 
> 1.  有条件重复或有条件跳转的一种形式（例如`while`, `if`+ `goto`）
>     
>     
> 2.  一种读取和写入某种形式的存储（例如，变量、磁带）的方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-31T15:39:41.763

图灵完备的语言可以“模拟任何单磁带图灵机”。Brainfuck 和 Boolfuck 都是图灵完备的，因为它们遵循规范。

另请注意，如果一个是图灵完备的，那么另一个必须是因为它们几乎相同。使用brainfuck，您以字节为单位移动，但在boolfuck 中，您使用的是构成字节的位。

# jquery - 如何使两个列表可互换，以及选择完成时保存已删除

> ID：14007417
> 
> 赞同：1
> 
> 时间：2012-12-22T23:20:05.347
> 
> 标签：jquery, html, jquery-ui, sorting, drag-and-drop

我正在使用**jQuery**并同时指定两个`selectors`。然后我尝试在这段代码中引用每个变量：

**`UL_HeadersToOmit`**- 是可供选择的列表

**`UL_dropedCols`***- 是作为下一个函数或“阶段*”的引用传递的列表

```
$('#next').click(
function () {

    var dropblUL = $('#UL_dropedCols li');
    alert(dropblUL.length);
});

$('#UL_dropedCols, #UL_HeadersToOmit')
    .sortable({
               connectWith: '#UL_HeadersToOmit, #UL_dropedCols'
             })
    .droppable({

            drop: function (event, ui) {
                     var curUL = $(this);
                    //.. now till here from what i could see in tests 
                    // drop is connected to the first  #dropedCols
                    // so if i wanted to specify same thing for second HeadersToOmit
                   // how will i do it ?

                  }
            }); 
```

我可以看到教程中的人正在连接

```
$(obj).draggable().droppable().sortable() 
```

我想如果他们都引用一个对象，这没关系，但你将如何引用两个？

**我的目标**自然是：保存用户选择的内容......意思`#UL_dropedCols`是在选择结束时（记住用户正在他们两个之间来回播放）然后单击下一步。

## 更新

[http://jsfiddle.net/rhW7C/46/embedded/result/](http://jsfiddle.net/rhW7C/46/embedded/result/)

[http://jsfiddle.net/rhW7C/46/](http://jsfiddle.net/rhW7C/46/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T00:56:11.173

已解决：我错过了`receive`如下所示的事件。

```
$('document').ready(function() {

    var results = [];

    $('#UL_dropedCols, #UL_HeadersToOmit').sortable({
        tolerance: 'pointer',
        connectWith: '#UL_HeadersToOmit, #UL_dropedCols',
        receive: function(event, ui) {
            var draged = ui.item.attr("id");
            results.push(draged);
        }
    });

    $('#next').click(function() {
        var RLength = results.length;
        for (var i = 0; i < RLength; i++) {
            alert(results[i]);
        }
    });

}); 
```

# php - php print inside print - 结果是什么

> ID：14007420
> 
> 赞同：1
> 
> 时间：2012-12-22T23:21:01.653
> 
> 标签：php, echo

> **可能重复：**
> [奇怪的回声，PHP 中的打印行为？](https://stackoverflow.com/questions/3340330/strange-echo-print-behaviour-in-php)

以下 PHP 代码：

```
print (2).(3 * (print 3)); 
```

在输出中显示“ `323`”？它是如何处理的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T23:21:01.653

这是因为括号（操作优先级） -

```
(print 3) 
```

在行尾显示最终输出的第一个数字 (3)，但所有 PHP 打印语句都返回 1。始终（查看[手册](http://php.net/manual/en/function.print.php)）。所以在这之后，我们得到了：

```
print (2).(3 * 1); 
```

这与以下内容相同：

```
print (2).(3); 
```

现在它只是一个简单的连接，将输出“23”。所以我们显示了“323”。

注意

```
print (2).(1 - (print 3)); 
```

将显示“320”。

# coffeescript - AngularJS - 可选的必需元素

> ID：14007425
> 
> 赞同：1
> 
> 时间：2012-12-22T23:21:45.880
> 
> 标签：coffeescript, angularjs

我正在尝试使用自定义指令来制作有条件的必需语句。我添加的第一个条件是“firstInArray”，如果它是选择数组中的第一个元素，则它使元素成为必需元素（对于需要选择至少一个项目的 UI 是必需的，但你可以无限选择多个项目）：

```
 .directive('variableRequired', [
    ()->
      return {
        require: 'ngModel',
        link: (scope, el, attrs, ctrl)->
          vars = attrs.variableRequired.split(',')
          condition = vars[0]
          if condition is 'firstInArray'
            item = vars[1]
            arr = vars[2]
            if scope[item] == scope[arr][0]
              $(el).removeAttr('variable-required')
              $(el).attr('required', 'required')
      }       
  ]) 
```

当我在指令中添加 scope.$apply() 时，应用程序会冻结（似乎是无限递归）。

有没有比自定义指令更好的方法来解决这个问题？如果不是，我的指令有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T01:47:57.670

您也许可以使用[未记录的](https://github.com/angular/angular.js/issues/1202) **ng-required**指令，而不是您自己的自定义指令：

```
<li ng-repeat="itemObj in items">
   <input type="text" ng-model="itemObj.text" ng-required="$first">
</li> 
```

# ios - 无法导入 NYXImagesKit 库

> ID：14007429
> 
> 赞同：0
> 
> 时间：2012-12-22T23:23:05.457
> 
> 标签：ios, xcode, import

我正在尝试将 NYXImagesKit 库导入到我的 iOS 5.1 项目中，但它不会显示为可导入代码。它找不到库。我已将 NYXImagesKit 库拖到项目中并添加了库。我还在构建阶段中添加了以下内容：

![在此处输入图像描述](../Images/28fdec41cc320d985a60108d57e66c34.png)

![在此处输入图像描述](../Images/32ea572c374cfee5bae68457fc0496bb.png)

但是，当我尝试导入它时，我仍然收到一条错误消息，说它找不到 NYXImagesKit.h。

NYXImagesKit 可以从这里找到：[https ://github.com/Nyx0uf/NYXImagesKit](https://github.com/Nyx0uf/NYXImagesKit)

我在以前的项目中使用过它，所以我知道它有效。

.h 文件位置的屏幕截图：

![在此处输入图像描述](../Images/e1ee381c58da38ffb313acc3cb4c3e46.png)

标头搜索路径：

![在此处输入图像描述](../Images/0fd69bf387b4405a8e56264de0154ebf.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:31:51.630

您没有正确“导入”库的问题。（我不想显得迂腐，但图书馆是链接的，而不是导入的）。您遇到的问题是库附带的头文件。

要修复它，您应该确保`NYXImagesKit.h`在项目构建发送中添加路径（搜索标题路径）。这可以在项目设置中的构建选项下找到。

或者，一种更简单的方法是将`NYXImagesKit.h`文件添加到您的项目中（就像任何 .m 文件一样）。然后它会被找到而不需要指定一个标题搜索路径。

编辑：

由于从您报告的内容来看，一切似乎都很好，他唯一的想法是我能想到的是确保为您的目标定义了路径（而不是整个项目）；但我想它已经是这样了。

除此之外，唯一的办法是认为该项目以某种方式损坏了。您可以使用文本编辑器检查 .xcodeproj 文档中的 project.pbxproj 文件，并确保一切正常。

如果一切都失败了，那就从一个新项目重新开始。

# php - 验证访问令牌时出错：会话已在 unix 时间过期

> ID：14007430
> 
> 赞同：2
> 
> 时间：2012-12-22T23:23:17.060
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk, facebook-access-token

> **可能重复：**
> [Facebook offline_access 弃用的含义](https://stackoverflow.com/questions/9798085/implication-of-facebook-offline-access-deprecation)

我在这里发布这个问题是因为我在任何地方都找不到针对我的具体案例的答案。

我创建了一个服务器端 PHP 应用程序，它每周都会在我们的 FB 粉丝页面上自动发布/展示一个指向我们产品之一的链接，随机。

该脚本在 10 天前一直运行良好，现在手动调用脚本时出现以下错误：

```
Fatal error: Uncaught OAuthException: Error validating access token: Session has expired at unix time 1355862507\. The current unix time is 1356217401\. thrown in /home/webadmin/virtualsheetmusic.com/html/facebook/API/base_facebook.php on line 1249 
```

现在，我发现问题出在传递的 access_token 中，但我不知道如何以我在此应用程序中使用的格式生成一个新的。

这是我们迄今为止一直使用的令牌格式：

`$fanpagetoken = '<REMOVED ACCESS TOKEN FROM TEXT>';`

这是我们用于在墙上发布的 PHP 代码：

```
 #Define vars...
$day = strtotime($today);
$day = date("l, F j, Y", $day);

$deadline = strtotime("+1 week");
$deadline = date("l, F j, Y", $deadline);

// Create our Application instance (replace this with your appId and secret).

$facebook = new Facebook(array(
  'appId'  => $appid,
  'secret' => $secret,
));

$attachment = array(
                    'access_token' => $fanpagetoken,

                    'message' => "Sheet Music Showcase for ".$day.":",
                    'name' => $headline,
                    'caption' => "Showcase Expiration: $deadline",
                    'link' => 'http://www.ourwebsite.com/s/'.$createsession,
                    'description' => 'View the complete high quality PDF sheet music file, listen to related audio files and more!',
                    'picture' => 'http://www.virtualsheetmusic.com/images/icons/new_downloadsHome/'.$mainid.'.gif',
                    'actions' => array(array('name' => 'Learn more...', 
                                      'link' => 'http://www.virtualsheetmusic.com/s/'.$createsession))
                    );

$result = $facebook->api('/oursitefanpage/feed/',
                            'post',
                            $attachment); 
```

如何生成该格式的新令牌？

非常欢迎任何帮助！

提前感谢您的任何想法

最好的，法布。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T09:54:17.617

您可以为您的粉丝页面设置一个永不过期的令牌。遵循简单的步骤：

1.  获取管理员（即您的）扩展令牌（有效期为 2 个月）。通过链接获取扩展令牌。完美工作：

    [自offline_access弃用以来如何延长访问令牌的有效性](https://stackoverflow.com/questions/8982025/how-to-extend-access-token-validity-since-offline-access-deprecation/9035036#9035036)

2.  使用此令牌，获取页面/应用程序列表-

    ```
    $facebook->api("/USER_ID/accounts"); 
    ```

3.  获取任何页面的永不过期的访问令牌-

    ```
    $facebook->api("/PAGE_ID?fields=access_token"); 
    ```

（您可以使用[Facebook 的调试工具](https://developers.facebook.com/tools/debug)来检查令牌的有效性。）

# android - 为什么Android listView onitemclicklistner 更新列表中的多个项目？

> ID：14007431
> 
> 赞同：-1
> 
> 时间：2012-12-22T23:23:52.607
> 
> 标签：android, listview, onitemclicklistener

我使用视图持有者在列表视图中保存视图，她使用我的代码

```
public class MyAdapter extends BaseAdapter{
Context context;
private LayoutInflater mInflater;
 ViewHolder holder;

public MyAdapter(Context context/*,List<Music> list*//*,ListView listView*/){
    this.context = context;
}
@Override
public int getCount() {
    return 15;
}

@Override
public Object getItem(int position) {
    return position;
}

@Override
public long getItemId(int position) {
    return position;
}

@Override
public View getView(final int position, View convertView, ViewGroup parent) {
    int p = 0;
    View view = null;
    if(convertView == null){
        holder= new ViewHolder();
        convertView = View.inflate(context, R.layout.item, null);   
        holder.set = (TextView)convertView.findViewById(R.id.set);
        holder.button = (Button)convertView.findViewById(R.id.button1);
        convertView.setTag(holder);
    }
    else{

        holder = (ViewHolder) convertView.getTag();
    }
holder.button.setOnClickListener(new lis(position,holder));

    return convertView;
}
class lis implements OnClickListener{
    private int p;
    private ViewHolder holder;

    public lis(int p,ViewHolder holder){
    this.p = p;
    this.holder = holder;

}
int counter=0;
    @Override
    public void onClick(View v) {
        p++;
        counter++;
        Log.e("counter ",String.valueOf(counter));
        holder.set.setText("" + counter);
    }

}
  static class ViewHolder{
    Button button = null;
    TextView set = null;
} 
```

}

但是，例如，当我单击列表中的一个项目时，我单击项目 1 以将其值增加 +1，但在此代码中，它也会将其他两个项目增加 +1，我的代码中的问题在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T00:06:55.090

这是因为您的数据存储在点击侦听器中。*它不应该。*

该`ListView`组件不会为列表中的每个项目生成视图。所以，在你的情况下不会有`15`他们。屏幕上将有尽可能多的内容。当您滚动列表时，不再可见的旧项目将*被回收*。然后`getView`调用`convertView != null`并且适配器为您提供*更新*此回收项目视图的机会。由于您不更新视图，并且只分配了一个新的单击侦听器，因此该项目*似乎*有一个`count`of `1`，但它只是被回收的旧项目视图。

此外，更新回收视图对您的情况没有帮助，因为在您的点击侦听器中声明了项目数据。将其移到外部，例如在适配器中：

```
private int[] counters = new int[15]; 
```

然后，在点击侦听器中，按位置访问相关项目的计数：

```
@Override
public void onClick(View v) {
    counters[p]++;
    int count = counters[p];
    holder.set.setText(String.valueOf(count));
} 
```

最后，在 中`getView()`，始终更新项目视图以反映当前计数：

```
holder.button.setOnClickListener(new lis(position,holder));
holder.set.setText(String.valueOf(counters[position])); 
```

# mod-rewrite - 带有 301 的新 NICE URL。如何让它们一起工作？

> ID：14007435
> 
> 赞同：0
> 
> 时间：2012-12-22T23:24:30.557
> 
> 标签：mod-rewrite, friendly-url, url-scheme

我有这个旧的网站 URL 结构：

site.com/folder/prod.php?cat=MAIN%20CAT%20&prodid1=123&prodtitle=PROD%20TITLE&subcat=SUB%20CAT

真实的例子是这样的：

site.com/folder/prod.php?cat=CAR%20AUDIO&prodid1=4444&prodtitle=MTX%20AMPS&subcat=AMPS

在这里您可以看到产品页面有 4 个变量：类别、产品 ID、产品标题和子类别。其中一些变量用于打开菜单。是的，URL 使用空格和大小写来提取变量。

新网站网址具有新结构：

site.com/x/product-title-prodid2

一个 rel 示例如下：

site.com/x/mtx-amps-8888

这是通过使用两个变量（友好的 slug + 第二个产品 id：prodid2）和 .htaccess 中的以下代码来完成的

```
<IfModule mod_rewrite.c>
Options +Indexes
Options +FollowSymlinks
RewriteEngine on
RewriteBase /

RewriteRule ^p/(.*)/$ product.php?prodid2=$1
RewriteRule ^p/(.*)$ product.php?prodid2=$1

</IfModule> 
```

如果我们从同一个表中获得 prodid1，我们可以在内部获得 prodid2，但反之则不行。

一切正常，但我们现在必须创建 301 重定向，显然因为旧/新 url 中没有使用相同的变量，所以它变得很棘手，因为显然我们必须为漂亮的 URL 创建和 301s 创建一个规则？

我们尝试将以下内容添加到 htaccess：

```
RewriteCond %{QUERY_STRING} ^cat=CAR%20AUDIO&prodid1=4444&prodtitle=MTX%20AMPS&subcat=AMPS$ [NC]
RewriteRule ite.com/folder/prod.php site.com/x/mtx-amps-8888? [R=301,L] 
```

它仅适用于 1 种产品，但当添加 2 种或更多时，网站会出现故障。我想象这将是一个无限循环？

另一种方法是添加：

```
ErrorDocument 404 /404.php 
```

获取 URL 并重定向到页面，但这对于 SE 来说是丑陋的。

* * *

更新：

对不起，我对这个话题缺乏了解，我对此很陌生。

该产品有 2 个重要的 ID。例如：

如果在 3 个类别中列出 MTX AMP（这是实际产品名称），则将有 1 个重复的 prodid2 和 3 个不同的 prodid1（每个类别 1 个）。它们都驻留在同一张表中。因此，如果我们有一个 prodid1，我们可以在 db 表中获得它旁边的 prodid2。

使用 prodid2 拉取在新站点上获取漂亮 URL 的规则

```
RewriteRule ^p/(.*)$ product.php?prodid2=$1 
```

这带来了存储在数据库中的完整值。例如 mtx-amps-8888 << 这是 slug + prodid2 的混合体

完整的网址是：

```
site.com/p/mtx-amps-888 
```

（p 只是一个虚拟文件夹，我们利用该变量来显示正确的页面模板）

所以 mtx-amps-888 不是 3 个键，它们是在创建产品时生成的，并一起保存在数据库的单个字段中。它们已经包含了分离 - 所以这不是在 htaccess 中完成的。

cat（键）值实际上用于扩展旧站点中使用的菜单，但要创建 301 重定向，我们可能会使用 prodid1，因为我们可以匹配该值以获得 prodid2。prodid2 用作获取新站点中漂亮 URL 的主要查询，其值将带来存储在数据库中的漂亮 URL。

从我的所有研究中有意义的是：

```
<IfModule mod_rewrite.c>
Options +Indexes
Options +FollowSymlinks
RewriteEngine on
RewriteBase /

RewriteRule ^p/(.*)$ product.php?prodid2=$1

RewriteCond %{QUERY_STRING} ^cat=CAR%20AUDIO&prodid1=4444&prodtitle=MTX%20AMPS&subcat=AMPS$ [NC]
RewriteRule ite.com/folder/prod.php site.com/x/mtx-amps-8888? [R=301,L]

RewriteCond %{QUERY_STRING} ^cat=CAR%20AUDIO&prodid1=5555&prodtitle=BOSS%20AMPS&subcat=AMPS$ [NC]
RewriteRule ite.com/folder/prod.php site.com/x/mtx-amps-8888? [R=301,L]

RewriteCond %{QUERY_STRING} ^cat=CAR%20VIDEO&prodid1=6666&prodtitle=ALPINE%20DVDS&subcat=DVD%20PLAYERS$ [NC]
RewriteRule ite.com/folder/prod.php site.com/x/mtx-amps-8888? [R=301,L]

</IfModule> 
```

请注意，我从主要重写规则中删除了一行：

```
RewriteRule ^p/(.*)/$ product.php?prodid2=$1 
```

这只确保用户也可以在 URL 的末尾使用 /：site.com/p/mtx-amps-888/

我还重复了 3 个产品的 301 重定向的重写条件，但我确实有大约 3K 产品要在这里列出。如果我保留 1，它将起作用，但如果我添加 2，我相信会创建一个循环。

希望这是有道理的。你不知道启动和运行它对我来说有多重要，所以我向那些可以提供帮助的人致以最良好的祝愿:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T12:55:06.457

只需重新创建文件`/folder/prod.php`并让 php 进行重定向。这是最简单和最干净的解决方案。

```
<?php
  $prodid1 = $_GET['prodid1'];
  //calculate prodid2 based on prodid1, or use mysql to retreive the prodid2 belonging to prodid1
  $prodid2 = $prodid1;//just for testing
  $newpath = "/p/$prodid2/";

  // redirect using 301
  header("Location: http://{$_SERVER['HTTP_HOST']}{$newpath}");
  header('HTTP/1.1 301 Moved Permanently');
?> 
```

# jquery - textarea 在 jsfiddle 中填充表格单元格，但在实际应用程序中不填充

> ID：14007441
> 
> 赞同：1
> 
> 时间：2012-12-22T23:25:34.170
> 
> 标签：jquery, html, css

这很奇怪，但我有一个 jsfiddle，当用户单击“添加问题”按钮以附加表格行时，在附加行的“问题”列下，此表格单元格中文本区域的高度和宽度是能够填充表格单元格。

[http://jsfiddle.net/LKB9e/12/](http://jsfiddle.net/LKB9e/12/)

但问题是我的应用程序中有完全相同的代码，但在我的应用程序中，textarea 没有填充表格单元格。我的问题是，为什么它在我的应用程序中不起作用？

[应用](http://helios.hud.ac.uk/u0867587/Mobile_app/QandATable4.php)

我的应用程序中唯一不在小提琴中的代码是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>Prepare Questions and Answers</title>
   <link rel="stylesheet" type="text/css" href="QandATableStyle4.css">
        <link rel="stylesheet" type="text/css" href="jquery/ui-lightness/jquery-ui-1.8.16.custom.css"/>
        <script type="text/javascript" src="jquery/jquery-1.7.min.js"></script>
        <script type="text/javascript" src="jquery/jquery-ui-1.8.16.custom.min.js"></script>
        <script type="text/javascript" src="jquery/jquery.simplemodal.js"></script>
        <script type="text/javascript" src="jquery/basic.js"></script>

        <link rel="stylesheet" type="text/css" href="jquery/ui-lightness/jquery-ui-1.8.14.custom.css"/>
        <link rel="stylesheet" type="text/css" href="jquery/ui-lightness/basic.css"/>
        <link rel="stylesheet" type="text/css" href="jquery/ui-lightness/basic_ie.css"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:30:03.043

在主页上，删除 textarea 上的边框：

```
.textAreaQuestion { border: none; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:36:17.413

jsfiddle 使用 css 重置来删除所有元素的边距和填充以及单元格间距以及许多其他调整。这是因为不同的浏览器为各种 css 属性设置了不同的默认值。

您似乎没有使用任何重置，因此您会看到默认的单元格填充以及单元格间距。谷歌条款`CSS reset`或`CSS normalize`将出现大量信息

# c# - 违反 PRIMARY KEY 约束“PK_Calle”。无法在激活自动增量选项的对象中插入重复键

> ID：14007442
> 
> 赞同：1
> 
> 时间：2012-12-22T23:25:35.793
> 
> 标签：c#, sql-server-2008

我正在迁移一个没有身份约束的旧数据库，我正在添加到新数据库，一切正常，但是当我检查我创建的日志文件时，我注意到这个错误，其中奇怪的部分是表具有自动增量为 1 的标识键

我正在使用的代码是这样的：

```
var cmd1 = new SqlCommand();
cmd1.Parameters.Clear();
cmd1.Connection = mySqlConnection;
cmd1.CommandType = CommandType.Text;
cmd1.CommandText = @"INSERT INTO [Tomin].[TominPredial].[Calle]([Nombre],[Id_Colonia]"
                    + ",[Id_User],[Id_Date])"
                    + " VALUES(@Nombre,@Id_Colonia,@Id_User,@Id_Date)";
cmd1.Parameters.AddWithValue("@Nombre", nombreCalle);
cmd1.Parameters.AddWithValue("@Id_Colonia", id_col);
cmd1.Parameters.AddWithValue("@Id_User", "Admin");
cmd1.Parameters.AddWithValue("@Id_Date", DateTime.Now);
cmd1.ExecuteNonQuery(); 
```

我不知道这是怎么回事，因为我没有发送主键，因为我想自动增量会为我设置它，知道发生了什么吗？

引发错误的 ID 值从 1 开始并以 562 结束，当我删除数据时，我使用`DBCC CHECKIDENT('Tomin.TominPredial.Calle', RESEED, 0)`

```
CREATE TABLE TominPredial.Calle (
Id_Calle SMALLINT NOT NULL IDENTITY(1,1) CONSTRAINT PK_Calle PRIMARY KEY,
Nombre NVARCHAR(50) NOT NULL,
Id_Colonia SMALLINT NOT NULL CONSTRAINT FK_Calle_Colonia REFERENCES TominPredial.Colonia (Id_Colonia),
Id_User NVARCHAR(30) NOT NULL CONSTRAINT FK_Calle_User REFERENCES TominUsuario.Usuario (ID),
Id_Date DATETIME2 NOT NULL,
Id_Estatus TINYINT DEFAULT 1 NOT NULL CONSTRAINT FK_Calle_Estatus REFERENCES TominSistema.Estatus (Id_Estatus)
);
GO 
```

# android - android sdk 实时录音

> ID：14007443
> 
> 赞同：3
> 
> 时间：2012-12-22T23:25:36.957
> 
> 标签：android, audiotrack, android-audiorecord

[我使用此代码使用AudioTrack](http://developer.android.com/reference/android/media/AudioTrack.html)和[AudioRecord](http://developer.android.com/reference/android/media/AudioRecord.html)实时录制和播放录制的音频

```
package com.example.audiotrack;

import android.app.Activity;
import android.media.AudioFormat;
import android.media.AudioManager;
import android.media.AudioRecord;
import android.media.AudioTrack;
import android.media.MediaRecorder;
import android.os.Bundle;
import android.util.Log;

public class MainActivity extends Activity {
    private int freq = 8000;
    private AudioRecord audioRecord = null;
    private Thread Rthread = null;

    private AudioManager audioManager = null;
    private AudioTrack audioTrack = null;
    byte[] buffer = new byte[freq];
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        android.os.Process.setThreadPriority(android.os.Process.THREAD_PRIORITY_URGENT_AUDIO);
        final int bufferSize = AudioRecord.getMinBufferSize(freq,
                AudioFormat.CHANNEL_CONFIGURATION_MONO,
                AudioFormat.ENCODING_PCM_16BIT);

        audioRecord = new AudioRecord(MediaRecorder.AudioSource.MIC, freq,
                AudioFormat.CHANNEL_CONFIGURATION_MONO,
                MediaRecorder.AudioEncoder.AMR_NB, bufferSize);

        audioTrack = new AudioTrack(AudioManager.ROUTE_HEADSET, freq,
                AudioFormat.CHANNEL_CONFIGURATION_MONO,
                MediaRecorder.AudioEncoder.AMR_NB, bufferSize,
                AudioTrack.MODE_STREAM);

        audioTrack.setPlaybackRate(freq);
         final byte[] buffer = new byte[bufferSize];
        audioRecord.startRecording();
        Log.i("info", "Audio Recording started");
        audioTrack.play();
        Log.i("info", "Audio Playing started");
        Rthread = new Thread(new Runnable() {
            public void run() {
                while (true) {
                    try {
                        audioRecord.read(buffer, 0, bufferSize);                                    
                        audioTrack.write(buffer, 0, buffer.length);

                    } catch (Throwable t) {
                        Log.e("Error", "Read write failed");
                        t.printStackTrace();
                    }
                }
            }
        });
        Rthread.start();
    }

} 
```

我的问题 ：

1.音频质量不好

2.当我尝试不同频率时，应用程序崩溃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:53:05.917

音频质量可能很差，因为您使用 AMR 编解码器来压缩音频数据。AMR 使用基于声学模型的压缩，因此除了人类语音之外的任何其他声音的质量都会很差

代替

`MediaRecorder.AudioEncoder.AMR_NB`

尝试

```
AudioFormat.ENCODING_PCM_16BIT 
```

AudioRecord 是低级工具，因此您必须自己注意参数兼容性。正如文档中所说，许多频率不能保证工作。

因此，在尝试录制或播放之前，最好检查所有组合并检查其中哪些是可访问的。

在 stackOverflow 上多次提到了不错的解决方案，例如这里的 [Frequency detection on Android - AudioRecord](https://stackoverflow.com/questions/13376780/frequency-detection-on-android-audiorecord)

检查`public AudioRecord findAudioRecord()`方法

# parsing - 使用文本文档更新 windows 中文件的时间戳以供参考

> ID：14007444
> 
> 赞同：0
> 
> 时间：2012-12-22T23:25:38.517
> 
> 标签：parsing, powershell, timestamp

我需要一种使用文本文档作为指向文件的指针将文件的时间戳更新为当前日期的方法。

例如：

目录A结构：

*   A:\Level 1\Level 2\somefile1
*   A:\Level 1\somefile2
*   A:\Level 1\somefile3
*   答：\somefile4

文本文件（FilePointer.txt）内容：

*   A:\Level 1\Level 2\somefile1
*   A:\Level 1\somefile2
*   A:\Level 1\somefile3
*   答：\somefile4

有没有办法解析 FilePointer.txt 文件以获取文件位置，并将其提供给可以更新这些文件的时间戳的东西？使用powershell？其他方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T02:06:16.013

使用 PowerShell 应该很容易：

```
$timestamp = Get-Date # now
Get-Content filepointer.txt | Get-Item | Foreach {$_.LastWriteTime = $timestamp} 
```

[这里](http://www.powershellmagazine.com/2012/12/20/pscxtip-manipulating-file-attributes/)概述了一种更简单的方法。它使用[PowerShell Community Extensions](http://pscx.codeplex.com) Set-FileTime 命令，例如：

```
Get-Content filepointer.txt | Get-Item | Set-FileTime 
```

或使用别名：

```
gc filepointer.txt | gi | touch 
```

# mysql - 你如何强制 mysql LIKE 区分大小写？

> ID：14007450
> 
> 赞同：95
> 
> 时间：2012-12-22T23:26:47.470
> 
> 标签：mysql, sql, case-sensitive, sql-like

> **可能重复：**
> [Mysql Like Case Sensitive](https://stackoverflow.com/questions/8083455/mysql-like-case-sensitive)

Mysql 忽略大小写的 LIKE 比较。

如何强制它执行区分大小写的 LIKE 比较？

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2012-12-22T23:32:00.310

使用`LIKE BINARY`：

```
mysql> SELECT 'abc' LIKE 'ABC';
    -> 1
mysql> SELECT 'abc' LIKE BINARY 'ABC';
    -> 0 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-12-23T01:24:41.277

另一种选择是使用`COLLATE`,

```
SELECT *
FROM table1
WHERE columnName like 'a%' COLLATE utf8_bin; 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/c2c3d/3)

# php - 添加 PHP 包括到我的 Warp JoomlaTemplate

> ID：14007451
> 
> 赞同：1
> 
> 时间：2012-12-22T23:27:06.097
> 
> 标签：php, joomla

我最近从 Code Canyon 购买了这个脚本，我想将它用于我的 Warp Joomla 模板。

[http://www.geertdedeckere.be/shop/thumbsup/help#template-list](http://www.geertdedeckere.be/shop/thumbsup/help#template-list)

我希望这里有人对 Warp 框架有一些经验。我已按照创建者对 T 的说明进行操作，但一直出现白屏。每个 Warp 模板都基于一个 config.php 和 template.config.php 文件。我已尝试添加 YooTheme 支持票上概述的代码：[http](http://www.yootheme.com/support/question/28978) ://www.yootheme.com/support/question/28978无济于事。

我也尝试做一些其他的实验，但是当我等待 YooTheme 可笑的长支持响应时，有没有人知道如何在我的 Warp 模板中调用初始 PHP 函数和 CSS/Javascript 文件？我设法到达 CSS （我不确定是否看到 init.php 调用，即使使用相对路径。创建者的原始命令：

```
<?php echo ThumbsUp::css() ?>  
    <?php echo ThumbsUp::javascript() ?> 
```

给我一个白屏，我认为（我不知道 PHP 内外/但我是技术知识）是因为原始调用没有放在所有其他内容输出之前，由于 joomla 结构问题我不知道（即我将代码放在错误的位置），或者我错误地放置了 echo 命令。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:56:02.150

你还没有提到 Joomla！版本，所以我在我的评论中假设 2.5.x。

*将此类功能放入 Joomla! 模板不是一个好主意，您最好查看[Joomla 的现有扩展之一！提供“评分和评论”功能，](http://extensions.joomla.org/extensions/clients-a-communities/ratings-a-reviews/)包括简单的喜欢/不喜欢选项。大多数是免费的。*

话虽如此，要确定 PHP 问题的根本原因，您需要执行以下操作：

1.  打开“调试系统”（`Site->Global Configuration->System->Debug Settigns`）
2.  将网站的“错误报告”级别提高，( `Site->Global Configuration->Server->Server Settings`)。如果它目前`None`是开始`Simple`并按您的方式工作（除非您完全确信您可以登录`configuration.php`手动修改文件，如果站点在错误报告一直上升后停止工作。

**注意**不要让这些设置超过必要的时间。

从生成的输出中，您应该能够查明错误或问题发生的区域。此时，您可以扩展您的原始问题并向我们提供更多详细信息，例如错误消息、导致错误的代码等。 ..

# jquery - 我自己的点赞按钮：Django + Ajax——如何？

> ID：14007453
> 
> 赞同：12
> 
> 时间：2012-12-22T23:27:33.197
> 
> 标签：jquery, ajax, django, json

所以我一直无法将此视图转换为 Ajax 调用：

```
def company_single(request, slug):
    company = get_object_or_404(CompanyProfile, slug=slug)
    company_list = CompanyProfile.objects.get(slug=slug)

    try:
        tcompany = CompanyLikes.objects.get(company=company_list)
        total_likes = tcompany.likes
        user_liked = CompanyLikes.objects.get(user=request.user)
    except:
        total_likes = 0

    instance, created = CompanyLikes.objects.get_or_create(company=company_list)
    likes_form = CompanyLikesForm(request.POST or None, instance=instance)

    if likes_form.is_valid():
        this = likes_form.save(commit=False)
        try:    
            if user_liked:
                this.likes -=1
                this.user.remove(request.user)
        except:
            this.user.add(request.user)
            this.likes += 1
        this.save()

    return render_to_response('company.html', locals(), context_instance=RequestContext(request)) 
```

我想我需要 jQuery 和 JSON，但我不确定如何在这里实现它来为我的网站制作我自己的“点赞按钮”。有什么想法/建议吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-22T23:45:52.520

我会给你一个例子。您只需从中学习并做出相应的更改。

**myapp.models.py**（简化的公司模型）：

```
from django.db import models
from django.contrib.auth.models import User
from django.template.defaultfilters import slugify

class Company(models.Model):
    name = models.CharField(max_length=255)
    slug = models.SlugField()
    likes = models.ManyToManyField(User, related_name='likes')

    @property
    def total_likes(self):
        """
        Likes for the company
        :return: Integer: Likes for the company
        """
        return self.likes.count()

    def save(self, *args, **kwargs):
        self.slug = slugify(self.name)
        super(Company, self).save(*args, **kwargs) 
```

**myapp.urls.py**（视图的 URL）：

```
url(r'^like/$', 'myapp.views.like', name='like'), 
```

**myapp.views.py**（视图）：

```
from django.http import HttpResponse
try:
    from django.utils import simplejson as json
except ImportError:
    import json
from django.shortcuts import get_object_or_404
from django.contrib.auth.decorators import login_required
from django.views.decorators.http import require_POST

from myapp.models import Company

@login_required
@require_POST
def like(request):
    if request.method == 'POST':
        user = request.user
        slug = request.POST.get('slug', None)
        company = get_object_or_404(Company, slug=slug)

        if company.likes.filter(id=user.id).exists():
            # user has already liked this company
            # remove like/user
            company.likes.remove(user)
            message = 'You disliked this'
        else:
            # add a new like for a company
            company.likes.add(user)
            message = 'You liked this'

    ctx = {'likes_count': company.total_likes, 'message': message}
    # use mimetype instead of content_type if django < 5
    return HttpResponse(json.dumps(ctx), content_type='application/json') 
```

模板：

```
<input type="button" id="like" name="{{ company_slug }}" value="Like" />

<script>
$('#like').click(function(){
      $.ajax({
               type: "POST",
               url: "{% url 'like' %}",
               data: {'slug': $(this).attr('name'), 'csrfmiddlewaretoken': '{{ csrf_token }}'},
               dataType: "json",
               success: function(response) {
                      alert(response.message);
                      alert('Company likes count is now ' + response.likes_count);
                },
                error: function(rs, e) {
                       alert(rs.responseText);
                }
          }); 
    })
</script> 
```

[在模板中使用url](https://docs.djangoproject.com/en/1.8/ref/templates/builtins/#url)标签的一些说明：

*   如果像这样在 URL 名称周围`Django < 1.3`使用`url`不带引号的标签`{% url like %}`
*   如果`Django > 1.3 and < 1.5`那么你应该添加`{% load url from future %} at top level of your template and enclosed your URL name with quotes as I have done in my answer`
*   如果`Django >= 1.5`然后简单地删除`{% load url from future %}`并用引号括起来的 URL 名称，`{% load url from future %}`则标记为已弃用，并将在`Django 1.9`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-06-13T10:36:00.180

在这里写这篇文章是因为我没有足够的声誉来发表评论，并且编辑必须至少有 6 个字符。在新版本的 Django 中，您需要将视图函数的路径或 url 的名称作为字符串传递给 url 模板标签。因此上述模板的第 7 行将是：

```
url: "{% url 'like' %}", 
```

这是支持这一点的[文档](https://docs.djangoproject.com/en/1.7/topics/http/urls/#reverse-resolution-of-urls)的一部分。

# wcf - c# wcf服务使用json.net反序列化json数组

> ID：14007457
> 
> 赞同：1
> 
> 时间：2012-12-22T23:28:32.860
> 
> 标签：wcf, air, json.net, deserialization

我正在开发一个移动空中应用程序。对于通信，我正在使用 wcf 服务。现在我的问题是这个，我正在尝试使用 json.net 反序列化一个数组数组。子数组是类型化的。所以，我在移动端的课程如下：

```
package Model.VO.PHCDATA
{
    [Bindable]
    [RemoteClass(alias="Model.PCHModel.VODadosPHC")]
    public class VoBi
    {
        private var _BIstamp:String;
        private var _ivaincl:Number;
        private var _vendnm:String;
        private var _vendedor:Number;
        private var _iva:Number;
        private var _lordem:Number;
        private var _tabiva:Number;
        private var _txiva:Number;
        private var _familia:String;            
        ....

    }
} 
```

另一个是：

```
package Model.VO.PHCDATA
{
    [Bindable]
    [RemoteClass(alias="Model.PCHModel.VODadosPHC")]

    public class VOBO
    {
        private var _BOstamp:String;
        private var _vendedor:Number;
        private var _vendnm:String;

        ....
    }
} 
```

对应的c#类如下：

```
 [DataContract(Name = "VoBi")]
    public class VoBi
    {
        [DataMember(IsRequired = true, Name = "BIstamp", Order = 0)]
        public string BIstamp { get; set; }
        [DataMember(IsRequired = true, Name = "ivaincl", Order = 1)]
        public decimal ivaincl { get; set; }
        [DataMember(IsRequired = true, Name = "vendnm", Order = 2)]
        public string vendnm { get; set; }
        [DataMember(IsRequired = true, Name = "vendedor", Order = 3)]
        public decimal vendedor { get; set; }
                   ....

    } 
```

另一个：

```
 [DataContract(Name = "VOBO")]
    public class VOBO
    {
        [DataMember(IsRequired = true, Name = "BOstamp", Order = 0)]
        public string BOstamp { get; set; }
        [DataMember(IsRequired = true, Name = "vendedor", Order = 1)]
        public decimal vendedor { get; set; }
        [DataMember(IsRequired = true, Name = "vendnm", Order = 2)]
        public string vendnm { get; set; }
        [DataMember(IsRequired = true, Name = "nmdos", Order = 3)]
        public string nmdos { get; set; }
        [DataMember(IsRequired = true, Name = "ndos", Order = 4)]
        public decimal ndos { get; set; }

        .....

    } 
```

要发送到服务器的相应json字符串是这个：

```
{
    "DADOSBI": [
        {
            "edebito": 0,
            "desconto": 92.121,
            "vendedor": 0,
            "desc2": 222.343,
            "iva": 23,
            "ettdeb": 123.555,
            "lordem": 12,
            "tabiva": 2.1,
           ....
        },
        {
            "edebito": 0,
            "desconto": 92.121,
            "vendedor": 1,
            "desc2": 222.343,
            "iva": 23,
            "ettdeb": 123.555,
            "lordem": 12,
            "tabiva": 2.1,
           ....
        }
    ],
    "DADOSBO": [
        {
            "estab": 123.88,
            "etotaldeb": 123,
            "obs": "",
            "vendedor": 0,
            "statuspda": "qqqqqqqqqqqq",
            "ebo_2tvall": 12,
            "ebo_2tdes1": 12.11,
            ...
        },
        {
            "estab": 123.88,
            "etotaldeb": 123,
            "obs": "",
            "vendedor": 1,
            "statuspda": "qqqqqqqqqqqq",
            "ebo_2tvall": 12,
           ....
        }
    ]
} 
```

我该如何处理？我是否使用 json.net CustomCreationConverter 反序列化数据？并获得用我提到的类填充的相应数组，还是我使用另一种方法？帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T08:20:31.933

假设您的顶级课程如下所示（如果您没有，则创建一个，如果它不那么努力，否则我们需要一个更好的解决方案）

```
internal class TopClass
{

    [JsonProperty("DADOSBI")]
    public IList<VoBi> VOBiList { get; set; }

    [JsonProperty("DADOSBO")]
    public IList<VOBO> VOBOList { get; set; }
} 
```

然后简单地使用反序列化

```
var topClass = JsonConvert.DeserializeObject<TopClass>( json); 
```

如果这不是您正在寻找的答案，请使用更多信息更新问题

# c# - 启动中心表格

> ID：14007458
> 
> 赞同：13
> 
> 时间：2012-12-22T23:28:45.557
> 
> 标签：c#, .net, winforms

我正在使用 C# 开发 Web 浏览器，所以我为它制作了一个启动画面。但是，启动画面在启动时并不位于屏幕的中心。那么有没有办法让表格在启动时居中？

![在此处输入图像描述](../Images/05273b5c0e557ac6d5f12b50fe290d25.png)

工作代码：

```
public splash()
    {
        InitializeComponent();

        StartPosition = FormStartPosition.CenterScreen;
    } 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-22T23:30:50.867

`StartPosition = FormStartPosition.CenterScreen;`

[MSDN FormStartPosition 文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.formstartposition.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-22T23:31:13.977

```
form.StartPosition = FormStartPosition.CenterScreen; 
```

请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.startposition.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-22T23:35:27.253

如果您想从 GUI 执行此操作并使用 Visual Studio，请使用以下步骤：
1\. 在表单设计器中打开您的表单
2\. 导航到表单属性
3\. 将“StartPosition”更改为“CenterScreen”

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-03-11T19:42:42.103

```
namespace WindowsFormsApplication1
{
 public partial class Form1 : Form
 {
    public Form1()
    {
        InitializeComponent();

        //Method 1\. center at initilization
        this.StartPosition = FormStartPosition.CenterScreen;

        //Method 2\. The manual way
        this.StartPosition = FormStartPosition.Manual;
        this.Top = (Screen.PrimaryScreen.Bounds.Height - this.Height)/2;
        this.Left = (Screen.PrimaryScreen.Bounds.Width - this.Width)/2;

    }
  }
} 
```

# html - 如何在悬停时更改嵌套列表的单个列表项的背景颜色（以及全菜单宽度）

> ID：14007460
> 
> 赞同：1
> 
> 时间：2012-12-22T23:28:55.070
> 
> 标签：html, css

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type='text/css'  media='all'>
        #menu {width: 50%;}
        .high {background: #0F0;}
        .list-item :hover {background: #000;}

        /* non essential styles */
        .list-item a{text-decoration: none;}
        .list-item :hover a{color: #FFF;}
    </style>
</head>
<body>
    <div id="menu" >
        <ul>
            <li class="list-item">
                <div class="level-0 high" id="P0">
                    <a href="#">P0</a>
                </div>
                <ul>
                    <li class="list-item">
                        <div class="level-1" id="C0-P0">
                            <a href="#">C0-P0</a>
                        </div>
                    </li>
                    <li class="list-item">
                        <div class="level-1" id="C1-P0">
                            <a href="#">C1-P0</a>
                        </div>
                    </li>
                </ul>
            </li>
            <li class="list-item">
                <div class="level-0" id="P1">
                    <a href="#">P1</a>
                </div>
                <ul>
                    <li class="list-item">
                        <div class="level-1" id="C0-P1">
                            <a href="#">C0-P1</a>
                        </div>
                    </li>
                    <li class="list-item">
                        <div class="level-1" id="C1-P1">
                            <a href="#">C1-P1</a>
                        </div>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
</body> 
```

结构：
P0
__ C0-P0
__ C1-P0
P1
__ C0-P1
__ C1-P1

目前我无法单独选择和更改子项的背景（悬停时）。
但是，如果我尝试使用`first-child`选择器 - 我可以单独选择每个列表项。但是 -
那么父母的选择仅限于锚点宽度而不是完整的菜单宽度。

这是[JSFilldle](http://jsfiddle.net/Uj13/4FZsa/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:32:33.053

目前还不清楚你在问什么，但`:hover`元素之间不应该有空格。

应该`.list-item:hover {...}`不是`.list-item :hover {...}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:33:43.477

更改此行：

```
.list-item :hover {background: #000;} 
```

对此：

```
li .list-item :hover {background: #000;} 
```

这是[jsFiddle](http://jsfiddle.net/mgHZ6/3/) ...

# ruby-on-rails - 文件上传到 box.com 而不写入文件系统

> ID：14007473
> 
> 赞同：3
> 
> 时间：2012-12-22T23:31:28.640
> 
> 标签：ruby-on-rails, box-api

我正在尝试使用其[API](http://developers.box.com/get-started/) REST 调用和 httmultiparty gem 将文件上传到 Box.com。该代码正在运行并上传到 Box.com，但是在将上传的文件写入服务器文件系统后执行此操作，如 f.write(data.read) 然后捕获写入文件的文件路径作为 Box 的输入参数。 com API REST 调用，如：filename => File.new(path)。该应用程序将在 Heroku 上运行，因此我们无法在 Heroku 的服务器上保存任何文件（只读），所以我想直接将文件上传到 Box.com，同时绕过服务器上的文件写入但不能鉴于 Box.com REST 调用需要“文件”类型的对象，请弄清楚这一点。任何帮助表示赞赏。谢谢。

模型和视图代码为：

```
### 
#The Model
###
    class BoxUploader 
      require 'httmultiparty'
      include HTTMultiParty
      #base_uri 'https://api.box.com/2.0'
    end

    class File < ActiveRecord::Base
        attr_accessible :file
        attr_accessor :boxResponse

        FILE_STORE = File.join Rails.root, 'public', 'files'
        API_KEY = @myBoxApiKey
        AUTH_TOKEN = @myBoxAuthToken

        def file=(data) #uploaded file 
          filename = data.original_filename 
          path = File.join FILE_STORE, filename
          #### would like to bypass the file writing step
          File.open(path, "wb")  do |f| 
            f.write(data.read) 
          end
          #############
          File.open(path, "wb")  do |f| 
           boxResponse = BoxUploader.post('https://api.box.com/2.0/files/content', 
                :headers => { 'authorization' => 'BoxAuth api_key={API_KEY&auth_token=AUTH_TOKEN' },
                :body => { :folder_id      => '911', :filename => File.new(path)}
            )
          end  
    end

###
# The View
###
<!-- Invoke the Controller's "create" action -->
<h1>File Upload</h1>
<%= form_for @file, :html => {:multipart=>true} do |f| %>
  <p>
    <%= f.label :file %>
    <%= f.file_field :file %>
  </p>
  <p>
    <%= f.submit 'Create' %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-12T06:27:51.657

要使用 HTTMultiParty 从内存中上传文件，您需要为其提供 UploadIO 对象来代替通常提供的 File 对象。可以使用 StringIO 填充 UploadIO 对象。似乎 HTTMultiParty 以特殊方式处理 UploadIO 对象，因此您不能直接使用 StringIO ：

```
class Uploader
  include HTTMultiParty
  base_uri "http://foo.com"
end

string_io = StringIO.new('some stuff that pretends to be in a file')
upload_io = UploadIO.new(string_io, 'text/plain', 'bar.txt')
Uploader.post("/some/path", query: {file: upload_io}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T13:25:14.880

您的目标是一种不常用的模式，因此您最好的方法是扩展现有的 gem，以提供您需要的功能。

在其 API 的 2.0 版本中，有一个 gem [ruby​​-box可与 Box 服务一起使用。](https://github.com/attachmentsme/ruby-box)gem 得到很好的支持并且非常易于使用。

您需要挖掘源代码并创建一个新的上传方法。

# jquery - 在 jQuery 中使用 POST 方法加载其他函数

> ID：14007474
> 
> 赞同：1
> 
> 时间：2012-12-22T23:31:30.567
> 
> 标签：jquery, click, jquery-post

在控制台中打印“aaa”，但我无法通过单击 $(“#test”) 使其打印“bbb”。

我犯的那个错误？欢迎任何建议。谢谢你。对不起，我的英语不好。

**主.js：**

```
$("#load").click(function () {
    $.post("second.php",function(data){
        $('#result').html(data);
    });
    return false;
}); 
```

**主.html：**

```
...
<div id="result"></div>
... 
```

**second.php 返回：**

```
<script>
$(document).ready(function() {
        try
        {
            console.log("aaa");
            $("#test").click(function () {
                console.log("bbb");
                return false;
            });
        }catch(e){}
    });
</script>

<div>hello</div>
<a id="test" href="#">Test</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:44:50.673

问题是`document.ready`在主页中已经发生了。这意味着即使包装在`document.ready`. 如果代码在它引用的 html 之前，它将在 html 存在之前触发

如果您将代码放在相同的 html 之后，它将起作用。

另一种方法是使用`on()`将事件处理程序委托给页面加载时不存在的未来元素。你可以在主页中使用`on()`并在主页加载时运行它

委托示例

```
$(document).on('click','#test', function(){

   console.log('bbbb');
   return false;
}); 
```

# backbone.js - Backbone.js 模型属性未定义错误

> ID：14007475
> 
> 赞同：0
> 
> 时间：2012-12-22T23:31:33.973
> 
> 标签：backbone.js, backbone.js-collections

我对 Backbone.js 非常陌生，并且正在尝试让这个简单的示例正常工作。基本上，在 jsFiddle 中，当我运行代码时，它告诉我未定义属性“firstname”。

这是小提琴的链接：http: [//jsfiddle.net/cpeele00/YjUBG/16/](http://jsfiddle.net/cpeele00/YjUBG/16/)

```
var User = Backbone.Model.extend({});

var UserList = Backbone.Collection.extend({
   model: User
});

var UserView = Backbone.View.extend({
   el: $('#user-list ul'),
   template: _.template($('#user-list-template').html()),
   render: function() {
       this.$el.html(this.template(this.model.toJSON()));
       return this;
   }
});

var user1 = new User();
user1.set({
   firstname: 'Momo',
   lastname: 'Peele'
});

var user2 = new User();
user2.set({
   firstname: 'Bobo',
   lastname: 'Peele'
});

var users = new UserList([user1, user2]);

var userView = new UserView({model: users});

userView.render(); 
```

​</p>

任何帮助解决这个问题将不胜感激。

视听/视听

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:36:31.153

由于模型实际上是一个集合，因此您需要对其进行迭代，并将模板应用于集合中的每个模型。一种方法是使用下划线扩展`Collection.each`：

```
render: function() {
    // clear the view
    this.$el.empty();

    // save a reference to the view object
    var self = this;

    // iterate over the collection
    this.model.each(function(singleModel) {

        // render the model
        self.$el.append(self.template(singleModel.toJSON()));
    });

    return this;
} 
```

[这是更新的小提琴。](http://jsfiddle.net/Cep3Z/4/)

[（如果您愿意，您也可以将迭代放入模板本身，但我认为通常最好将代码保留在视图中，而不是模板中。）]

# javascript - 匹配一组字符串的任意组合

> ID：14007479
> 
> 赞同：1
> 
> 时间：2012-12-22T23:33:02.097
> 
> 标签：javascript, regex

我正在尝试创建一个匹配任意数量的一组字符串的 JavaScript 正则表达式：例如，一个匹配`onetwothreethreetwoone`或`twotwotwooneoneonethreeonetwo`. 是否有可能以上述方式创建一个匹配单词“一”、“二”和“三”的任意组合的正则表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T23:42:50.493

您可以简单地使用[交替](http://www.regular-expressions.info/alternation.html)和[重复](http://www.regular-expressions.info/repeat.html)。您可能还想使用[锚点](http://www.regular-expressions.info/anchors.html)来确保整个字符串都由这种模式组成。然后您可以简单地使用 Javascript 的内置`test`函数进行检查：

```
if(/^(?:one|two|three)*$/.test(input))
    ... 
```

如果必须至少有一个术语（不允许使用空字符串），请使用`+`代替`*`：

```
if(/^(?:one|two|three)+$/.test(input))
    ... 
```

`?:`抑制[捕获](http://www.regular-expressions.info/brackets.html)并应始终使用（当然，除非您明确需要捕获）。这是一种很好的做法，可以显着提高更复杂模式的性能。

如果要查找符合此模式的输入子字符串，请省略锚（`^`和`$`），使用全局标志`g`并`match`在字符串上使用：

```
var matchArray = input.match(/(?:one|two|three)+/g); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T23:41:38.890

```
/(one|two|three)+/ 
```

组在括号中，`|`里面代表“或”，`+`意思是“一个或多个”。

# ruby-on-rails - NilClass：Class的Rails Ancestry未定义方法`model_name'

> ID：14007481
> 
> 赞同：0
> 
> 时间：2012-12-22T23:33:20.833
> 
> 标签：ruby-on-rails, ancestry

我正在尝试学习如何使用“祖先”宝石。我在 Railscast 中观看了相关的情节并获得了代码。该`message`表工作正常。但我试图用一个名为`locations`. 我已经复制并更改了所有代码的名称（我相信）。

我创建了第一个位置。但是，当我转到 时`localhost:3000/locations`，我得到`undefined method`了 NilClass:Class `for`_form.html.erb` 行的 model_name'：

```
<%= form_for @location do |f| %> 
```

`routes.rb`：

```
 Messenger::Application.routes.draw do
    resources :locations
    resources :messages
    root :to => 'messages#index'
  end 
```

`_form.html.erb`：

```
<%= form_for @location do |f| %>
  <%= f.error_messages %>
  <%= f.hidden_field :parent_id %>
  <p>
  <%= f.label :locname, "New Location" %><br />
  <%= f.text_area :locname, :rows => 8 %>
  </p>
  <p><%= f.submit "Post Location" %></p>
<% end %> 
```

`index.html.erb`：

```
<% title "Locations" %>
<%= nested_locations @locations.arrange(:order => :created_at) %>
<%= render "form" %> 
```

`locations_controller.rb`：

```
class LocationsController < ApplicationController
  def index
    @locations = Location.scoped
  @location = Location.new
end

def show
  @location = Location.find(params[:id])
end

def new
  @location = Location.new(:parent_id => params[:parent_id])
end

def create
  @location = Location.new(params[:location])
  if @location.save
    redirect_to locations_url
  else
  render :new
  end
end

def destroy
  @location = Location.find(params[:id])
  @location.destroy
  redirect_to locations_url
end 
```

结尾

`locations_helper.rb`：

```
 module LocationsHelper
  def nested_locations(locations)
    locations.map do |location, sub_locations|
      render(location) + content_tag(:div, nested_locations(sub_locations), :class => "nested_locations")
   end.join.html_safe
 end
end 
```

# javascript - 在 codemirror 中显示行错误？

> ID：14007482
> 
> 赞同：0
> 
> 时间：2012-12-22T23:33:24.053
> 
> 标签：javascript, codemirror

我刚刚将 CodeMirror 升级到最新版本，现在以下代码中断：

```
 // clear previous errors from editor window
        for (var i = 0; i < layoutCodeEditor.lineCount(); i++) {
            layoutCodeEditor.clearMarker(i);
            layoutCodeEditor.setLineClass(i, null, null);
        }

        var valid = JSLINT(code);
        var jsLintError = "";
        if (!valid) {
            jsLintError = JSLINT.error_report(JSLINT.data());
            _.chain(JSLINT.errors).compact().each(function(e){
                // show markers in the code edit window against lines with Jslint errors
                layoutCodeEditor.setMarker((+e.line) - 1, "●", "errors");
                layoutCodeEditor.setLineClass(+(e.line) - 1, null, "errorLine");                    
            })
        } 
```

似乎 setMarker/clearMarker 和 setLineClass 函数已被删除。他们现在的等价物是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T23:47:22.307

[CodeMirror 站点上的升级到版本 3](http://codemirror.net/doc/upgrade_v3.html)页面中介绍了这些更改以及其他许多更改。

由于移动到多个装订线，标记功能发生了变化：

> # [天沟模型](http://codemirror.net/doc/upgrade_v3.html#gutters)
> 
> 在 CodeMirror 2.x 中，只有一个装订线，使用创建的行标记`setMarker`必须以某种方式与行号共存（如果存在）。[版本 3 允许您通过类名](http://codemirror.net/doc/manual.html#option_gutters)指定一个装订线数组，[`setGutterMarker`](http://codemirror.net/doc/manual.html#setGutterMarker)用于添加或删除单个装订线中的标记，并使用 清除整个装订线[`clearGutter`](http://codemirror.net/doc/manual.html#clearGutter)。装订线标记现在指定为 DOM 节点，而不是 HTML 片段。
> 
> 装订线不再与内容一起水平滚动。删除了 fixedGutter 选项（因为它现在是唯一的行为）。

线类更改更直接：

> # [行 CSS 类](http://codemirror.net/doc/upgrade_v3.html#lineclass)
> 
> 该`setLineClass`方法已被替换为 [`addLineClass`](http://codemirror.net/doc/manual.html#addLineClass)and [`removeLineClass`](http://codemirror.net/doc/manual.html#removeLineClass)，它允许对附加到一行的类进行更多的模块化控制。

# ios - 为应用程序启动和 didEnterForground 实施 pincode 的最佳方法

> ID：14007487
> 
> 赞同：0
> 
> 时间：2012-12-22T23:34:19.540
> 
> 标签：ios, cocoa-touch, delegates, uikit, uitabbarcontroller

我已经构建了一个我想在我的应用程序中实现的 pincode 视图控制器，以保护它免受不需要的手指的影响。

我一直在研究如何最好地实现它，以便它仅在应用程序首次启动时以及在后台返回前台时出现。

appDelegate.m 具有 didFinishLoading 和 applicationWillEnterForeground 但我无法在此处创建视图控制器，因为尚未加载窗口。

我会将它添加到我的视图控制器的 viewDidLoad 方法中，但我使用的是 TabBarController，因此需要对所有任务执行此操作，然后每当用户在它们之间切换时都需要该引脚。

有人对我如何实现这一目标有任何建议/代码示例/最佳实践吗？

非常感谢，詹姆斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:55:23.900

尝试使用您的 AppDelegate 的`- (void)applicationDidBecomeActive:(UIApplication *)application`. 我相信你现在有一个窗口。无论如何，即使还没有窗口，也有简单的解决方法。

# javascript - XML 文档和 XML 字符串有什么区别？

> ID：14007488
> 
> 赞同：1
> 
> 时间：2012-12-22T23:34:31.337
> 
> 标签：javascript, xml

数据之间是否存在内容差异？

也许一个文档可能有其他元数据，如作者、最后编辑日期等？

我试图理解为什么 w3 学校的 domparser 示例有两种完全不同的方法来加载 xml 字符串和 xml 文档。

例如说两个来源都包含`<book><page1>Hello World!</page1></book>`.

提供的第一种方法使用 XMLHttpRequest() 和 responseXML 加载 js 对象 xmlDoc，第二种方法使用 DOMParser() 和 parseFromString()

每种方法创建的 JS 对象有何不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:41:02.937

两种方式的结果是一个表示 xml 结构的对象。

第一种方法是使用 XMLHttpRequest 从远程位置加载（和解析）xml 文档。

第二种方法假设您的脚本中已经有 xml 内容（存储在变量中，不管它是如何到达那里的）。然后将 xml 字符串内容解析为一个对象，以便您可以轻松地对 xml 数据执行操作（这在字符串上是不可能的）

您可以像这样使用生成的 xml 对象：

```
var p = new DOMParser()
xmldoc = p.parseFromString('<book><page1>Hello World!</page1></book>', 'text/xml')

xmldoc.childNodes.item(0) // the <book> tag
xmldoc.childNodes.item(0).childNodes.item(0) // the <page1> tag
xmldoc.childNodes.item(0).childNodes.item(0).textContent // "Hello World!" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T01:24:54.910

xml 文档应以 xml 声明开头：

[http://www.w3.org/TR/REC-xml/#sec-prolog-dtd](http://www.w3.org/TR/REC-xml/#sec-prolog-dtd)

此声明可能不存在于 xml 字符串中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T23:39:26.377

第一个示例从您仍然需要加载的 XML 文件构建 XML 树。它为此使用 XMLHttpRequest，它从网络服务器加载 XML 文件并自动解析它以创建 XML 文档。

第二个示例从您已有的包含 XML 代码的字符串构建 XML 树。

# c - C 哪个 Bit Hack 更好，为什么？

> ID：14007489
> 
> 赞同：1
> 
> 时间：2012-12-22T23:34:35.343
> 
> 标签：c, binary, bit-manipulation

```
int n = 1; //Arbitrary value

for ( int i = 0;i < 8;i++ )
{
    printf( "%d",n & ( 1 << i ) ? 1 : 0 ); //Ternary
    printf( "%d",0 || n & ( 1 << i ) );    //Logical OR
} 
```

在循环中的两个表达式中，哪一个更适合用于打印二进制值的 0 或 1 状态？（基本上打印二进制字符串表示）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-22T23:42:08.983

最好的将是

```
 (n >> i) & 0x1 
```

它比任何其他通过“布尔”转换的方法更可靠地无分支。

在可能且合理的情况下，最好向右移动，以便您感兴趣的位最终位于正确的位置以形成您需要的结果，从而消除任何额外步骤的需要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T23:38:27.787

怎么样`!!(n & (1 << i))`？或者`(n & (1 << i)) != 0`？

我觉得这两个都是比你提出的建议更好的选择（不，我没有自己想出 !! ，我在一些代码中阅读它，并从那里拿起它 - 它经常被使用例如在 Xen 和 Linux 中）

为了使其更具可读性，可以考虑：

```
inline zero_or_one_bit(int n, int i)
{
    return !!(n & (1 << i));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-22T23:39:24.510

与其向左移动，不如向右移动：

```
for (int i = 7; i >= 0; --i)
    printf("%d", (n >> i) & 1); 
```

但是，从某种意义上说，如果是微编码指令，它们可能都效率低下`1 << i`（根据下面的评论，这显然不太可能）。

这是一个仅进行恒定班次的版本：

```
for (int i = 0, n2 = n; i < 8; i++, n2 <<= 1)
    printf("%d", (n2 >> 7) & 1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T17:02:11.433

我喜欢 AndreyT 的回答，但为了完整起见：您可以轻松地从该三元组中获得更多工作（您可能会惊讶 %d 的成本有多大）：

```
putc( (n & ( 1 << i ))!=0 ? '1' : '0', stdout ); 
```

是的，如果愿意的话

```
putc(   ((n>>i) & 1) + '0',  stdout ); 
```

# html - CSS - 在锚点布局中定位背景图像

> ID：14007498
> 
> 赞同：0
> 
> 时间：2012-12-22T23:36:21.767
> 
> 标签：html, css, positioning, background-image

[**jsFiddle**](http://jsfiddle.net/HPF9b/)

我有一个 BG 图像附加到与班级的链接`selectedlink`

图像显示，但当我将其向下放置时，它会在链接的视觉参数之外消失。就像`href`是图像的窗口。

这是代码：

**CSS：**

```
div#intnavIcons a.selectedlink { 
    color: #900404; 
    font-size:11px; 
    font-weight:bold; 
    padding:#FFF; 
    text-decoration:underline; 
    background: url("/images/nav/bg-nav-current.png") no-repeat scroll center bottom transparent;
} 
```

**HTML：**

```
<div id="intnavIcons">
   <a class="selectedlink">This is selected</a>
   <a>This is not selected</a>
   <a>This is not selected</a>
   <a>This is not selected</a>
</div> 
```

谁能看到我的风格是否遗漏了将图像保持在href之上的东西？

为了将它向下移动，我只是添加`background-position: 0px 10px;`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:40:45.903

背景图片仅限于元素的框（具体框视`background-clip`样式而定）。如果你试图将它向下移动，它会在它到达盒子底部时开始消失。

您可能想尝试添加`padding-bottom:10px`.

我也注意到你有`padding:#FFF`，这没有任何意义。你的意思是`background-color`？

# scala - 递归函数溢出，为什么？

> ID：14007499
> 
> 赞同：1
> 
> 时间：2012-12-22T23:36:29.467
> 
> 标签：scala, recursion, overflow

下面的函数溢出了，我不明白为什么。当 x 为 0、y 为 0、dim 为 2 运行时，结果应为 6。但是，我收到一个错误，表明函数中的某个 Long 值（x 或 y）在溢出时为 554。这应该是不可能的，因为 x 和 y 都受暗值的限制，在我的测试中设置为 2。这是代码：

```
def lattice(dim: Long, x: Long, y: Long): Long = { 
  if (x == dim && y == dim) {
    1
  }
  if (x >= dim) {
    lattice(dim,x,y+1L)
  }
  if (y >= dim) {
    lattice(dim,x+1L,y)
  }
  else {
    lattice(dim,x+1L,y) + lattice(dim,x,y+1L)
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T23:41:33.880

你`else`在两个地方失踪了。这意味着您的最后一行即使在 时也会运行`x >= dim`，从而导致 x 超过`dim`。试试这个：

```
if (x == dim && y == dim) {
    1
} else if (x >= dim) {
    lattice(dim,x,y+1L)
} else if (y >= dim) {
    lattice(dim,x+1L,y)
} else {
    lattice(dim,x+1L,y) + lattice(dim,x,y+1L)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T00:16:14.773

克里斯：

Youd 函数不是尾递归的，因为在你的最后一条语句中你有一个总和。碰巧这个总和涉及两次调用`lattice`. 但是，要进行尾递归，您的 last statament 必须是一个常量（就像您在 first 中所做的那样`if`）或只是对函数本身的调用（例如您的 2 `else if`s.

我承认我不知道如何将您的函数更改为尾递归。根据您的算法，也许不可能执行您的函数尾递归。

谢谢，

拉斐尔·阿方索

# r - 异常值上带有名称的多个箱线图

> ID：14007501
> 
> 赞同：0
> 
> 时间：2012-12-22T23:36:35.213
> 
> 标签：r, boxplot, outliers

我有一个看起来像这样的箱线图：

```
Boxplot( ~ km_piste, data=slide, id.method="y", col="orange") 
```

![在此处输入图像描述](../Images/050c51dd4cf004fff801b2230ed44809.png)

显示异常值名称是因为我将第一列设置为：

```
row.names(slide) <- as.character(slide$data_name) 
```

现在我想知道如何制作一个新的多重箱线图。我想在同一张图片上有 2 个箱线图。数据仍在幻灯片数据库中。2列的名称是：

1.  ski_parc (幻灯片$ski_parc)
2.  snow_parc (幻灯片$snow_parc)

我不知道如何将 2 个箱线图放在同一图像上显示：

*   异常值的名称，例如 2 个箱线图的打印屏幕上的每一个
*   每个箱线图下箱线图的名称，以便识别它们

编辑：这是我的数据库[幻灯片的链接](http://pastebin.com/j2DqC22t)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:47:02.157

car::Boxplot 的第二个参数是 'g' 用作分组变量。目前我们无法判断您的数据框是什么样的，而且听起来好像它可能不是 Boxplot 期望的长格式。如果有一列说“area_type”的值为“ski_parc”和“snow_parc”，您可以使用以下格式：

```
Boxplot( ~ km_piste, g= area_type, data=slide, id.method="y", col=c("orange", "red") ) 
```

的使用`na.omit`与点的标记无关。这是使用的选择`id.method="y"`。当有多个组时，x 轴会标有它们的级别。

试试这个：

```
snow_parc <- data.frame(parc =c(slides$snow_parc, slides$ski_parc), 
              type=rep(c("snow_parc", "ski_parc"), each=40))
Boxplot(parc~type, data=snow_parc, id.method = "y") 
```

（没有异常值。）

# c++ - Allegro 5 绘图到缓冲区

> ID：14007503
> 
> 赞同：1
> 
> 时间：2012-12-22T23:37:24.933
> 
> 标签：c++, buffer, draw, allegro5

我正在制作一个程序，该程序将绘制在屏幕上弹跳的球。我目前正在研究绘制球的部分。

我的代码包括以下内容：

1.  BallEngine 类 - 管理所有 Allegro 函数/对象
2.  BallManager 类 - 管理所有的球
3.  球类 - 保存有关球的信息
4.  main.cpp - 游戏循环等。

球引擎.h：

```
#pragma once
#include <allegro5\allegro.h>
#include <allegro5\allegro_font.h>
#include <allegro5\allegro_ttf.h>
#include "BallManager.h"

ALLEGRO_DISPLAY *display;

class BallEngine
{
private:

    bool fullScreen;
    int fps;
    bool running;

public:
    BallManager BManager;
    bool getFullScreen();
    bool getIsRunning();
    void updateFullScreen();
    void setFullScreen(bool value);
    void setIsRunning(bool value);
    int getFPS();

    //Allegro Objects
    ALLEGRO_FONT *deafault_font_12;
    ALLEGRO_EVENT_QUEUE *event_queue;
    ALLEGRO_TIMER *timer;

    //Colors
    ALLEGRO_COLOR RED;
    ALLEGRO_COLOR GREEN;
    ALLEGRO_COLOR BLUE;
    ALLEGRO_COLOR YELLOW;
    ALLEGRO_COLOR PINK;
    ALLEGRO_COLOR LIGHT_BLUE;
    ALLEGRO_COLOR WHITE;
    ALLEGRO_COLOR BLACK;

    //Debug
    bool showDebug;
    void drawBallInfo(int x, int y, int id); //Draws information about a certain ball

    BallEngine(int width, int height);
    ~BallEngine(void);
}; 
```

球引擎.cpp：

```
#include "BallEngine.h"

BallEngine::BallEngine(int width, int height)
{
    running = true;
    showDebug = false;
    fps = 60;
    al_init();
    if(!al_init())
    {
        printf("Failed to initalize Allegro \n");
    }
    al_install_keyboard();
    if(!al_install_keyboard())
    {
        printf("Failed to initalize keyboard \n");
    }
    al_init_font_addon();

    al_init_ttf_addon();

    fullScreen = false;
    updateFullScreen();

    deafault_font_12 = al_load_font("arial.ttf", 12, 0);
    event_queue = al_create_event_queue();
    al_register_event_source(event_queue, al_get_keyboard_event_source());
    timer = al_create_timer(1.0/fps);
    al_register_event_source(event_queue, al_get_timer_event_source(timer));
    display = al_create_display(width, height);

    //Define engine colors
    RED = al_map_rgb(255,0,0);
    GREEN = al_map_rgb(0,255,0);
    BLUE = al_map_rgb(0,0,255);
    YELLOW = al_map_rgb(255,255,0);
    PINK = al_map_rgb(255,0,255);
    LIGHT_BLUE = al_map_rgb(255,255,0);
    WHITE = al_map_rgb(255,255,255);
    BLACK = al_map_rgb(0,0,0);
}

BallEngine::~BallEngine(void)
{
}
bool BallEngine::getFullScreen()
{
    return fullScreen;
}
bool BallEngine::getIsRunning()
{
    return running;
}
void BallEngine::updateFullScreen()
{
    if ( fullScreen == true )   
    {
        al_set_new_display_flags(ALLEGRO_FULLSCREEN);
    }
    else
    {
        al_set_new_display_flags(ALLEGRO_WINDOWED);
    }
}
void BallEngine::setFullScreen(bool value)
{
    fullScreen = value;
}

int BallEngine::getFPS()
{
    return fps;
}

void BallEngine::drawBallInfo(int x, int y, int id)
{
    if(BManager.isBallExist(id))
    {
        al_draw_textf(deafault_font_12, RED, x, y, 0, "X: %i Y: %i Velocity: %i Angle: %i Radius: %i Color %ALLEGRO_COLOR ", BManager.getBall_X(id), BManager.getBall_Y(id), BManager.getBall_Velocity(id), BManager.getBall_Angle(id), BManager.getBall_Radius(id), BManager.getBall_Color(id));
    }
    else
    {
        printf("Failed to draw ball %i information: Ball selceted out of range \n", id);
    }
} 
```

球管理器.h：

```
#pragma once
#include <iostream>
#include <vector>
#include "Ball.h"
#include <allegro5\allegro.h>
class BallManager
{
private:
    std::vector<Ball*> List;
public:
    //Get functions
    int getBall_X(int id);
    int getBall_Y(int id);
    int getBall_Velocity(int id);
    int getBall_Angle(int id);
    int getBall_Radius(int id);
    ALLEGRO_COLOR getBall_Color(int id);

    //Set Functions
    void setBall_X(int id, int value);
    void setBall_Y(int id, int value);
    void setBall_Velocity(int id, int value);
    void setBall_Angle(int id, int value);
    void setBall_Radius(int id, int value);
    void setBall_Color(int id, ALLEGRO_COLOR value);

    bool isBallExist(int id); //Returns true if a ball at index id exists. Else returns false.

    void CreateBall(int x, int y, int velocity, int angle, int radius, ALLEGRO_COLOR color);
    void DeleteBall(int id);

    void drawBall(int id);
    void drawBalls();

    void updateBalls(); //NOT YET DONE

    BallManager(void);
    ~BallManager(void);
}; 
```

BallManager.cpp:

```
#include "BallManager.h"

BallManager::BallManager(void)
{
}

BallManager::~BallManager(void)
{
}
//Get Functions:
int BallManager::getBall_X(int id)
{
    return List[id]->getPos_X();
}
int BallManager::getBall_Y(int id)
{
    return List[id]->getPos_Y();
}
int BallManager::getBall_Velocity(int id)
{
    return List[id]->getVelocity();
}
int BallManager::getBall_Angle(int id)
{
    return List[id]->getAngle();
}
int BallManager::getBall_Radius(int id)
{
    return List[id]->getRadius();
}
ALLEGRO_COLOR BallManager::getBall_Color(int id)
{
    return List[id]->getColor();
}

//Set functions:
void BallManager::setBall_X(int id, int value)
{
    List[id]->setPos_X(value);
}
void BallManager::setBall_Y(int id, int value)
{
    List[id]->setPos_Y(value);
}
void BallManager::setBall_Velocity(int id, int value)
{
    List[id]->setVelocity(value);
}
void BallManager::setBall_Angle(int id, int value)
{
    List[id]->setAngle(value);
}
void BallManager::setBall_Radius(int id, int value)
{
    List[id]->setRadius(value);
}
void BallManager::setBall_Color(int id, ALLEGRO_COLOR value)
{
    List[id]->setColor(value);
}

void BallManager::CreateBall(int x, int y, int velocity, int angle, int radius, ALLEGRO_COLOR color)
{
    Ball* ball = new Ball(x, y, velocity, angle, radius, color);
    List.push_back(ball);
}
void BallManager::DeleteBall(int id) 
{
    if(isBallExist(id))
    {
        delete List[id];
        List.erase(List.begin()+id);
    }
    else 
    {
        printf("Failed to delete ball %i information: Ball selceted out of range \n", id);
    }
}
bool BallManager::isBallExist(int id)
{
    if((id+1) > List.size() || id < 0)
    {
        return false;
    }
    return true;
}
void BallManager::drawBall(int id)
{
    List[id]->Draw();
}
void BallManager::drawBalls()
{
    int total = List.size();
    for(int index = 0; index < total; index++)
    {
        List[index]->Draw();
    }

}
void updateBalls()
{
    //TODO
} 
```

球.h：

```
#pragma once
#include <allegro5\allegro.h>
#include <allegro5\allegro_primitives.h>

class Ball
{
private:    
    int x;
    int y;
    int velocity; //Positive is left side of screen, Negitive is right side of screen
    int angle; // Angle derived from the positive vertical
    int radius;
    ALLEGRO_COLOR color;

public:
    //Get Functions
    int getPos_X();
    int getPos_Y();
    int getVelocity();
    int getAngle();
    int getRadius();
    ALLEGRO_COLOR getColor();

    //Set Functions
    void setPos_X(int value);
    void setPos_Y(int value);
    void setVelocity(int value);
    void setAngle(int value);
    void setRadius(int value);
    void setColor(ALLEGRO_COLOR value);

    //Draws to screen
    void Draw();

    //Constructor
    Ball(int Start_X, int Start_Y, int Start_Velocity, int Start_Angle, int Start_Radius, ALLEGRO_COLOR Start_Color);

    //Desctructor
    ~Ball(void);
}; 
```

球.cpp：

```
#include "Ball.h"

Ball::Ball(int Start_X, int Start_Y, int Start_Velocity, int Start_Angle, int Start_Radius, ALLEGRO_COLOR Start_Color)
{
    x = Start_X;
    y = Start_Y;
    velocity = Start_Velocity;
    angle = Start_Angle;
    radius = Start_Radius;
    color = Start_Color;
}

Ball::~Ball(void)
{
}

//Get functions
int Ball::getPos_X()
{
    return x;
}
int Ball::getPos_Y()
{
    return y;
}
int Ball::getVelocity()
{
    return velocity;
}
int Ball::getAngle()
{
    return angle;
}
int Ball::getRadius()
{
    return radius;
}
ALLEGRO_COLOR Ball::getColor()
{
    return color;
}

//Set functions
void Ball::setPos_X(int value)
{
    x = value;
}
void Ball::setPos_Y(int value)
{
    y = value;
}
void Ball::setVelocity(int value)
{
    velocity = value;
}
void Ball::setAngle(int value)
{
    angle = value;
}
void Ball::setRadius(int value)
{
    radius = value;
}
void Ball::setColor(ALLEGRO_COLOR value)
{
    color = value;
}

void Ball::Draw()
{
    al_draw_filled_circle(x, y, radius, color);
} 
```

主.cpp：

```
#include <allegro5\allegro.h>
#include "BallEngine.h"
int ScreenWidth = 620;
int ScreenHeight = 480;

int main()
{
    BallEngine Engine(ScreenWidth, ScreenHeight);

    //Test balls
    Engine.BManager.CreateBall(10, 20, 0, 0, 5, al_map_rgb(0,0,255));
    Engine.BManager.CreateBall(11, 21, 1, 1, 5, al_map_rgb(0,0,255));
    Engine.BManager.CreateBall(12, 22, 2, 2, 5, al_map_rgb(0,0,255));
    Engine.BManager.CreateBall(13, 23, 3, 3, 5, al_map_rgb(0,0,255));

    ALLEGRO_EVENT events;
    int selected = 0; //Used to show which ball is selected

    al_start_timer(Engine.timer);
    while(Engine.getIsRunning())
    {
        al_wait_for_event(Engine.event_queue, &events);
        if(events.type == ALLEGRO_EVENT_KEY_DOWN)
        {
            //Keyboard Input
            switch(events.keyboard.keycode)
            {
                case ALLEGRO_KEY_ESCAPE:
                    Engine.setIsRunning(false);
                    break;
                case ALLEGRO_KEY_RIGHT:
                    Engine.showDebug = !Engine.showDebug; //Toggles the selected balls info
                    break;
                case ALLEGRO_KEY_UP:
                    selected++;
                    break;
                case ALLEGRO_KEY_DOWN:
                    selected--;
                    break;
                case ALLEGRO_KEY_DELETE:
                    Engine.BManager.DeleteBall(selected); //Deletes a certain ball
                    break;
            }
        }
        else if(events.type == ALLEGRO_EVENT_TIMER)
        {
            //Update

        }

        //Draw
        Engine.BManager.drawBalls();
        //Show debug
        if(Engine.showDebug == true)
        {
            Engine.drawBallInfo(10, 10, selected);
        }

        al_flip_display();
        al_clear_to_color(al_map_rgb(0,0,0));
    }
    return 0;
} 
```

我很难画球。在 allegro 4 中，您将传递一个要在其上绘制的缓冲区，然后将缓冲区绘制到屏幕上。使用上面的代码，我在 Ball 类的 draw() 函数中遇到错误。

错误显示：调试错误！R6010 -abort() 已被调用

我还从命令提示符处获得了一些信息：断言失败：addon_initialized，文件 allegro-git\addons\primitives\primitives.c，第 79 行

我想我收到了一个错误，因为绘图函数没有任何地方可以绘制，因为显示是在 BallEngine 类中创建的，但是我该如何解决呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T05:36:07.087

> 断言失败：addon_initialized，文件 allegro-git\addons\primitives\primitives.c，第 79 行

这正是问题所在。您尚未初始化原语插件。

```
al_init_primitives_addon()
```

此外，您应该使用正斜杠作为路径的一部分（例如，`<allegro5/allegro.h>`），因为它是跨平台的。

# php - 无法为特定视图启动 ZENDx

> ID：14007504
> 
> 赞同：0
> 
> 时间：2012-12-22T23:37:52.813
> 
> 标签：php, jquery-ui, zend-framework, zend-form

我正在尝试在我的应用程序中启用并开始使用 ZENDx。

我已经通过谷歌浏览了大量链接，但它仍然晦涩难懂。

我只想在特定视图中启动和使用 JQuery。例如。当我想使用 jQuery UI 的自动完成或日期选择器时。

我从[http://framework.zend.com/manual/1.8/en/zendx.jquery.view.html开始](http://framework.zend.com/manual/1.8/en/zendx.jquery.view.html)

首先，我将 ZendX 添加到我的库中。然后按照手册进行操作-根本不起作用。

`$view->addHelperPath("ZendX/JQuery/View/Helper", "ZendX_JQuery_View_Helper");` 我在传递我的 $form 之前添加了这段代码：到我的控制器。

然后添加`<?php $this->jQuery(); ?>`到我的头部标签中。

然后，出于测试目的，我将手册中给出的代码粘贴到我的视图中：

```
<?php echo $this->ajaxLink("Show me something", "/hello/world", array('update' => '#content')); ?>

<div id="content"></div>
<form method="post" action="/hello/world">
    Pick your Date: <?php echo $this->datePicker("dp1", '', array('defaultDate' => date('Y/m/d', time()))); ?>
    <input type="submit" value="Submit" /> 
```

PS 请提及如何调用特定版本的 jQuery 和 UI 或者只是在本地调用它们。

发布此问题后，我的代码中有一个错误。上面的代码工作正常，它对我有用，我的错！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T05:38:45.517

请尝试更改您的设置，如下所示。

添加到您的**application.ini：**

```
pluginPaths.ZendX_Application_Resource  = "ZendX/Application/Resource" 
```

并到您的**视图，例如 Layout.phtml**

```
 <?php echo $this->jQuery()->enable(); ?> 
```

# matlab - Matlab中如何获取特定点（即转折点）的坐标

> ID：14007505
> 
> 赞同：1
> 
> 时间：2012-12-22T23:37:57.797
> 
> 标签：matlab, mathematical-optimization, minima

我有一组（X，Y）坐标，绘制时会产生如下图所示的图形。我想要做的是找到用红色圈起来的区域（角点）的坐标。

我一直在努力寻找实现这一目标的方法，因为那些实际的转折点代表了我感兴趣的领域。请注意，我没有这些坐标的实际方程式。

如果有人能给我建议，或者通过使用 Matlab 或什至使用一些 C++ 工具的其他想法，给我一些关于如何去做的指导，我将不胜感激。

![](../Images/c9e8a4de1be958c8c674e2fffb5cad48.png)

![](../Images/d85ecf4d8eb566cd580659c8307cc24b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T13:57:42.953

我设法使用点云库和 Matlab 的组合来解决这个问题。前者帮助我分离线段中的坐标（RANSAC），使用后者，我能够得到每个线段的方程（曲线拟合），并通过一些基本的数学计算简单地计算交点。

# python - pyglet 的形状或场景管理？

> ID：14007509
> 
> 赞同：3
> 
> 时间：2012-12-22T23:38:53.827
> 
> 标签：python, opengl, pyglet

我非常喜欢 pyglet，但抽象的基本单位是坐标向量，这很笨拙，而不是我在设计复杂场景时想要的抽象级别。

是否有任何与 pyglet 一起“常用”的库来管理形状并将它们组合成场景？`Shape`每个人都从头开始编写自己的基类吗？

我可以想象一个系统，它为对象和场景提供了一个易于使用的界面，但在后台使用批处理和向量以相当优化的方式与 Pyglet 交互。本质上：这是否已经存在，还是仍然需要编写？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T00:20:23.573

[Cocos2D](http://cocos2d.org/)是一个建立在 pyglet 之上的面向 sprite 的框架（现在也发展了一个[面向智能手机的版本](http://www.cocos2d-x.org/)）。它提供了一个像基本状态机一样工作的[场景](http://cocos2d.org/doc/programming_guide/scenes.html)抽象，并允许将相关内容组织到一个或多个[层](http://cocos2d.org/doc/programming_guide/layers.html)中。场景和图层都是场景图中的节点，允许在任何点应用过渡和效果，并在该点下分层影响所有内容。

虽然它的重点是 2D，但您应该能够轻松地利用它的场景来处理 3D。

还有[PyGly](http://adamlwgriffiths.github.com/PyGLy/)，我不熟悉，但它似乎提供了一些[场景图](http://adamlwgriffiths.github.com/PyGLy/docs/api_scene_graph.html)支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T13:18:45.210

我用谷歌搜索了“pyglet scenegraph”——只是为了找到一个可疑[的 OOgler](https://github.com/mshaw/OOgler)，这似乎有点被放弃了（最后一次提交 - 3 年前）。似乎没有人对使用**pyglet**创建一个真正复杂的框架感兴趣。尽管您至少可以检查[OOgler](https://github.com/mshaw/OOgler)作为这种尝试的示例。

# c++ - 使用 sin 和 cos 函数迭代时的 Nan 结果

> ID：14007514
> 
> 赞同：3
> 
> 时间：2012-12-22T23:39:49.560
> 
> 标签：c++

我正在使用 Code::Blocks 10.05 编译这个程序，但通常我会完成大约 10 次迭代，然后它开始在每个输出中生成 Nan。我想知道这是否是使用 cos 和 sin 函数引起的问题，是否有适当的工作来避免这种情况？

我必须进行很多迭代，因为我正在为大学做一个项目，所以它也必须准确。我查阅了一些关于如何避免使用 sin 和 cos 的文章，尽管我需要严格遵循一些公式，否则我产生的结果可能不准确，所以我不确定是否要妥协。

```
 struct Particle // Need to define what qualities our particle has
{
   double dPosition;
   double dAngle;

};

Particle Subject;

void M1(double &x, double &y) //Defines movement if particle doesn't touch inner   boundary
{
    x = x + 2*y;
}

double d = 0.25; //This can and will be changed when I need to find a distance between
                // the two cricles at a later stage

void M2(double &x,double &y, double d) //Defines movement of a particle if it impacts the inner boundary
{
    double z = asin(-(sin(y)+d*cos(x + y))/0.35);
    double y1 = y;
    y = asin(-0.35*sin(z) + d*cos(x + y + 2*z));
    x = y + y1 + x + 2*z;
}

int main()
{
    cout << "Please tell me where you want this particle to start positions-wise? (Between 0 and 2PI" << endl;
    cin >> Subject.dPosition;
    cout << "Please tell me the angle that you would like it to make with the normal? (Between 0 and PI/2)" << endl;
    cin >> Subject.dAngle;
    cout << "How far would you like the distances of the two middle circles to be?" << endl;
    double d;
    cin >> d;

    // These two functions are to understand where the experiment begins from.
    // I may add a function to change where the circle starts however I will use radius = 0.35 throughout

    cout << "So position is: " << Subject.dPosition << endl;
    cout << "And angle with the normal is: " << Subject.dAngle <<endl;

    int n=0;
    while (n <= 100) //This is used to iterate the process and create an array of Particle data points
    {               // in order to use this data to build up Poincare diagrams.

    {
        while (Subject.dPosition > 2*M_PI)
            Subject.dPosition = Subject.dPosition - 2*M_PI;
    }
    {
        if (0.35 >= abs(0.35*cos(Subject.dPosition + Subject.dAngle)+sin(Subject.dAngle))) //This is the condition of hitting the inner boundary
            M2(Subject.dPosition, Subject.dAngle, d); //Inner boundary collision
        else
            M1(Subject.dPosition, Subject.dAngle); // Outer boundary collision
    };
    cout << "So position is: " << Subject.dPosition << endl;
    cout << "And angle with the normal is: " << Subject.dAngle <<endl;
    n++;
}
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T23:43:01.673

`Nan`在 c++ 中显示为无限、零除法和不可表示数字的一些其他变体的指示。

**编辑**：

正如 Matteo Itallia 所指出的，`inf`用于无限/零除法。我发现了这些方法：

```
template<typename T>
inline bool isnan(T value) {
    return value != value;
}

// requires #include <limits>
template<typename T>
inline bool isinf(T value) {
    return std::numeric_limits<T>::has_infinity &&
        value == std::numeric_limits<T>::infinity();
} 
```

参考：[http ://bytes.com/topic/c/answers/588254-how-check-double-inf-nan](http://bytes.com/topic/c/answers/588254-how-check-double-inf-nan)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:55:29.437

如果该值在 [-1,+1] 之外并传递给 asin()，则结果将为 nan

如果您需要检查 Nan，请尝试以下操作

```
if( value != value ){
    printf("value is nan\n");
} 
```

# java - 从 Java 方法中检索变量名称

> ID：14007516
> 
> 赞同：-5
> 
> 时间：2012-12-22T23:40:03.803
> 
> 标签：java, variables, reflection, methods

我试图获取变量名称以及使用它们调用的方法，例如调用 callMethodOne 并传递 variableOne。

这些方法在不同的类中，一个类中有几个方法。到目前为止，我已经获得了我需要的其他信息，例如使用反射的类名。下面是如何布置方法的示例。

```
 public class ClassOne extends ClassTwo {

    public void methodOne(){
        String variableOne = rowData.get("variableOne");
        String variableTwo = rowData.get("variableTwo");
        String variableThree = rowData.get("variableThree");
        String variableFour = rowData.get("variableFour");
        String variableFive = rowData.get("variableFive");

        callMethodOne(AnyVariable,variableOne)
        callMethodOne(AnyVariable,variableTwo)
        callMethodTwo(AnyVariable,variableThree)
        callMethodOne(AnyVariable,variableFour)
        callMethodThree(AnyVariable,variableFive)
    }

} 
```

我想知道在java中是否可以获取调用的方法的名称和传入的参数/变量名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:49:49.830

不，您无法在标准 Java 环境中获取传递参数的名称。

# php - PHP脚本头类型图像破坏会话

> ID：14007518
> 
> 赞同：1
> 
> 时间：2012-12-22T23:40:53.610
> 
> 标签：php, image, session, request

我正在尝试编写一个使用会话存储图像文件夹结构的小型 PHP 脚本。每次调用边时，它都会从会话列表中读取下一个图像并将其显示为边的内容类型。当我调用我的脚本时，有时我得到的不是列表中的下一张图像，而是下一张。当我编写一个输出文件来注册每个页面请求时，我看到不止一个请求。但是，如果我查看我的火虫时间线，我看不到一个以上的请求，并且没有运行 javascript。如果我将图像显示为普通 HTML 页面的一部分，则一切正常。那么这里发生了什么。

如果有人可以帮助我，那就太好了...

```
<?php
include("readDir.class.php");

define("IMAGE_SOURCE_PATH","img");

session_start();

//Inititalize new session context
try
{
    if(!isset($_SESSION['id']))
        initSessionConext();
}
catch (Exception $e) 
{
    exit();
}

$fotos = $_SESSION['fotos'];

//Handle wrapp around
try
{
    if($_SESSION['id'] >= count($fotos))
        initSessionConext();
}
catch (Exception $e) 
{
    exit();
}
$foto = $fotos[$_SESSION['id']];
if(strcasecmp($_SERVER['REQUEST_METHOD'],"get") == 0)
     $_SESSION['id'] += 1;

//Error in session context return nothing
if(empty($foto))
    exit(); //

switch(readDir::extension($foto))
{
    case "png":
        header('Content-Type: image/png');
        break;
    case "jpg": //Fall through to jpeg case
    case "jpeg":
        header('Content-Type: image/jpeg');
        break;
}

$fp = fopen("test.txt","a");
fwrite($fp,$foto."\r\n");
fclose($fp);

header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
readfile(IMAGE_SOURCE_PATH."/".$foto);

//echo $foto."<br>";
//echo '<img src="'.IMAGE_SOURCE_PATH."/".$foto.'" />';

//--------------- F U N C T I O N S -------------------------------

function initSessionConext()
{
    $_SESSION['id'] = 0;
    $_SESSION['fotos'] = getNewData(IMAGE_SOURCE_PATH);
}

function getNewData($path)
{
    $extensions = array("jpg","png","jpeg");        //get data out of file system
    $fotos = array();
    $source = new readDir($path);
    if(!$source->check())
         throw new Exception('Could not find source for given path');
    $fotos = $source -> readFilesWithextension($extensions);
    if(!sort($fotos,SORT_STRING))
         throw new Exception('Could not sort foto list in natural order');
    return $fotos;
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:52:00.790

因此，如果我理解正确，您将返回每张图像，每次加载图像时返回一张？

在我看来，浏览器可能两次请求图像：一次是作为 HEAD 请求，第二次是获取内容。这通常用于在盲目下载之前找出`Content-Length`标题之类的东西。

`strcasecmp($_SERVER['REQUEST_METHOD'],"get") == 0`我建议在修改会话之前确保这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T10:57:51.780

至少没有解决请求问题。使用现在时差来区分请求。不好，但开箱即用......

# java - NumberFormatException 发生在不同的区域设置中

> ID：14007523
> 
> 赞同：0
> 
> 时间：2012-12-22T23:41:37.843
> 
> 标签：java, settings, numberformatexception, regional

我正在用 Java 开发一个应用程序并发现了这种奇怪的行为：

如果通过控制面板将区域设置格式设置为匈牙利语（系统默认值），我会收到此异常，但如果我将其设置为英语，则效果很好。也适用于我首先开发程序的虚拟 Mandriva。

这是导致问题的代码片段：

```
public String stattxt(){
    double dt = time_avg();
    double bpm = (Double.compare(dt, 0) == 0) ? 0 : msec2bpm(dt);
    String s = "<html>Number of control points: " + timestamps.size() + "<br>Average dt: " +
        Double.valueOf(new DecimalFormat("#.####").format(dt).toString()) + " ms<br>" +
        "Average BPM: " + Double.valueOf(new DecimalFormat("#.####").format(bpm).toString()) + "<br>&nbsp</html>";
    return s;
} 
```

两者都`time_avg()`返回`msec2bpm`双精度值（绝不是双精度值）。

无论区域设置如何，我如何才能完成这项工作？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:46:31.003

好像你正在使用

```
Double.valueOf(new DecimalFormat("#.####").format(dt).toString()) 
```

将一个数字四舍五入到小数点后 4 位，但这对我来说似乎是一个 hack，并且由于区域化设置而失败（匈牙利可能使用小数点逗号，而不是小数点。）

因此，改为使用以下内容进行双打：

```
rounded = Math.round(original * 10000)/10000.0; 
```

而且，如果要创建一个双舍入到小数点后 4 位的字符串，请使用 String.format()

```
String.format("%.4f", original); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T23:56:20.620

看起来你应该跳过`Double.valueOf`：

```
public String stattxt(){
    double dt = time_avg();
    double bpm = (Double.compare(dt, 0) == 0) ? 0 : msec2bpm(dt);
    String s = "<html>Number of control points: " + timestamps.size() + "<br>Average dt: " +
        new DecimalFormat("#.####").format(dt) + " ms<br>" +
        "Average BPM: " + new DecimalFormat("#.####").format(bpm) + "<br>&nbsp</html>";
    return s;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T23:56:56.377

你为什么要转换`String`为`Double`然后再转换为`String`？像这样做：

```
public String stattxt(){
    double dt=time_avg();
    double bpm=(Double.compare(dt, 0)==0)?0:msec2bpm(dt);
    String s="<html>Number of control points: "+timestamps.size()+"<br>Average dt: "+
        new DecimalFormat("#.####").format(dt).toString()+" ms<br>"+
                "Average BPM: "+Double.valueOf(new DecimalFormat("#.####").format(bpm).toString())+"<br>&nbsp</html>";
    return s;
} 
```

# jquery - 为什么我不能在 jTweetsAnywhere 用户名数组中输入超过 25 个用户名？

> ID：14007534
> 
> 赞同：1
> 
> 时间：2012-12-22T23:43:28.270
> 
> 标签：jquery, arrays, twitter, twitter-anywhere

这个数组有两个：

```
$('#jTweetsAnywhereSample').jTweetsAnywhere({
    username = ['twitterapi', 'ChromiumDev']
}); 
```

当数组超过 25 时，会出现“错误：无效查询”消息。

我不知道这是否与 Twitter 速率限制问题而不是 jTweetsAnywhere 问题有关。我使用的是 1.3.1 版，以及 Firefox 17.0.1 和 IE9。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T00:28:19.120

继续查看它的工作原理，我发现 Twitter 的搜索 API 对查询有一些限制，包括字符和复杂性限制。因此，如果拥有超过 25 个用户，它可能会超过 twitter 设置的 1000 个字符的限制。更多信息在这里： [https ://dev.twitter.com/docs/using-search](https://dev.twitter.com/docs/using-search)

# c# - 如何减少while循环中的MySQL连接延迟？

> ID：14007536
> 
> 赞同：1
> 
> 时间：2012-12-22T23:43:39.607
> 
> 标签：c#, asp.net, mysql, database, console-application

我有一个从 MySQL 数据库中提取数据并将其显示在控制台窗口中的界面。用于显示信息的代码使用 while 循环进行循环。

我遇到的问题是 MySQL 连接在每个循环上打开和关闭，这会导致显示信息的延迟。我曾尝试在循环之前打开一个连接，并在循环退出后关闭它，但我得到一个豁免，告诉我连接需要有效且打开。

所以循环将数据库中的数据添加到`datalist`列表中，然后显示在控制台中。每个循环还会清除列表，因为服务器上的信息可能会因更新而改变。

我想摆脱的另一件事`Thread.Sleep()`是它挂起程序（按照我知道的设计），但我不知道其他解决方案。

这是我的代码；

```
public void Loop()
    {
        public static string loopquery;
        public static List<DataList> datalist;

        var cki = new ConsoleKeyInfo();

        do
        {
            DateTime time = DateTime.Now.AddSeconds(1);

            while ((DateTime.Now < time))
            {
                Console.Clear();
                Travel.data.Clear();

                loopquery = "SELECT * FROM database)";
                Travel();

                Console.WriteLine("Hurray it's a loop!");
                Console.WriteLine(datalist[0].id);
                Console.WriteLine(datalist[0].name);

                if (Console.KeyAvailable)
                {
                    // Waits until the user presses a key, and puts it into our object key.
                    cki = Console.ReadKey(true);

                    if (cki.Key == ConsoleKey.UpArrow)
                    {
                        // Do Something
                    }
                    if (cki.Key == ConsoleKey.DownArrow)
                    {
                        // Do Something
                    }
                    if (cki.Key == ConsoleKey.LeftArrow)
                    {
                        // Do Something
                    }
                    if (cki.Key == ConsoleKey.RightArrow)
                    {
                        // Do Something
                    }
                    if (cki.Key == ConsoleKey.Escape)
                    {
                        break;
                    }
                }
                else
                {
                    Thread.Sleep(1000);
                }

            }
        } while (cki.Key != ConsoleKey.Escape);
    }

public void Travel()
    {
        //Open a connection
        databaseCon.Open();

        //Create Command
        var cmd = new MySqlCommand(Loop.loopquery, databaseCon);

        //Create a data reader and Execute the command
        var dataReader = cmd.ExecuteReader();

        try
        {
            //Read the data and store them in the list
            while (dataReader.Read())
            {
                 var data= new DataList();
                    data.id = (dataReader.GetInt32(0));
                    data.name = (dataReader.GetString(1));

                    Loop.datalist.Add(data);
            }
        }
        catch (MySqlException ex)
        {
            Console.WriteLine("Error: {0}", ex);
            Console.ReadLine();
        }
        finally
        {
            if (dataReader != null)
            {
                //close Data Reader
                dataReader.Close();
            }

            if (databaseCon != null)
            {
                //close Connection
                databaseCon.Close();
            }
        }
    } 
```

有没有更有效的方法来做到这一点？我不想用数百个查询来敲击服务器，因为这个客户端将被许多人使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:00:33.567

正如您所指出的，对于许多客户端来说，直接在循环中对数据库执行数百个查询可能效率不高。

您的应用程序没有具体细节，但避免一堆客户端循环冲击 SQL 服务器的一种方法是在客户端和数据库服务器之间添加一个应用程序层。您可以打开 API 端点（REST 等）供客户端查询。应用层服务器可以周期性地查询数据，并将数据保存在内存中，供所有客户端查询。

当然，这只有在许多客户端访问相同的数据以共享或一组可缓存的数据可以保存在内存中时才有意义。它还取决于数据的潜在性，以确定何时必须从缓存中驱逐数据或更新数据。

另一种选择是创建与套接字服务器之类的双向通信，其中服务器在数据更改时回调客户端。

如果应用层也用于写入，那么还有其他选项可以在更改时使缓存中的数据无效。

# matlab - 将整个 matlab 工作区投射到某个类

> ID：14007539
> 
> 赞同：2
> 
> 时间：2012-12-22T23:44:44.933
> 
> 标签：matlab, casting

我正在寻找一种将 matlab 中的整个工作区转换为某个类（例如`double`）的方法。为简单起见，我们假设工作空间中仅存在“简单”类（没有单元格或结构）。当然，我可以逐行更改每个变量，`x=double(x)`但是如果我有数百个变量，那是不切实际的。这是我到目前为止写的：

```
% # generate some variables of different classes
a1=int32(120);
a2=single(rand(10));
a3=double(rand(20));  
a4=(rand(5)>0.5);  %# logical

% # collect workspace variables using `whos` 
ws=whos;

for ii=1:size(ws,1)
     [ ? ] =   double(eval(ws(ii).name))
end 
```

最后一行`double(eval(ws{1,ii}))`执行转换，但我应该如何将它的输出自动分配给原始变量名称？

如果您能想到一个，也欢迎您提出一种替代方法来转换工作区的所有变量...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:14:30.597

有趣的问题（+1）。那这个呢？

```
ws = whos; %# Obtain workspace
for n = 1:size(ws,1)
    eval([ws(n).name, ' = double(', ws(n).name, ');']); %# Assign to double
end 
```

这在 R2012b 上对我有用。诀窍是更改变量类型并通过一次调用将其分配给`eval`.

# forms - Playframework 表单和两个提交按钮

> ID：14007541
> 
> 赞同：6
> 
> 时间：2012-12-22T23:45:06.133
> 
> 标签：forms, playframework-2.0

我有编辑订单的表格，但我必须添加删除订单的按钮。现在我有两个提交按钮的表单：

```
@helper.form(routes.Order.editOrder,'class -> "form-horizontal") {
   @helper.inputText(
      PlayMagicForJava.javaFieldtoScalaField(editOrderForm("date")),
      '_label -> "Date:",
      '_help -> ""
   )
   @helper.inputText(
      PlayMagicForJava.javaFieldtoScalaField(editOrderForm("place_from")),
      '_label -> "From:",
      '_help -> ""
   )
   <button type="submit" name="edit" id="edit" class="btn btn-primary">Edit Order</button>
   <button type="submit" name="remove" id="remove" value="remove" class="btn">Remove order</button>
} 
```

我在控制器中的功能仅用于编辑：

```
public static Result editOrder(){
 Order user = User.findByEmail(session("email"));
 Form<Order> editOrderFormFilled = editOrderForm.bindFromRequest();
 Order order = Order.findByID(editOrderFormFilled.get().id);
     if(editOrderFormFilled.hasErrors()) {
         return badRequest();
     }
     else if(user.id != order.created_by){
         return badRequest();
     }else{
        return OK();
     }
 } 
```

如何处理提交的按钮？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-23T00:56:01.407

所选按钮的`value`属性作为任何其他字段发送到服务器。因此，在您的控制器内部，您可以在请求正文中访问此值并决定要做什么。

模板：

```
<button type="submit" name="action" value="edit">Edit order</button>
<button type="submit" name="action" value="remove">Remove order</button> 
```

控制器：

```
public static Result myAction() {
  String[] postAction = request().body().asFormUrlEncoded().get("action");
  if (postAction == null || postAction.length == 0) {
    return badRequest("You must provide a valid action");
  } else {
    String action = postAction[0];
    if ("edit".equals(action)) {
      return edit(request());
    } else if ("remove".equals(action)) {
      return remove(request());
    } else {
      return badRequest("This action is not allowed");
    }
  }
}

private static Result remove(Request request) {
  // TODO
  return ok("implement your business here");
}

private static Result edit(Request request) {
  // TODO
  return ok("implement your business here");
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-20T08:03:24.330

为了补充[Julien Lafont](https://stackoverflow.com/questions/14007541/playframework-form-and-two-submit-buttons/14007854#14007854)的回答，您可以在 Scala 控制器中执行以下操作：

```
def handle = Action { implicit request => 
  request.body.asFormUrlEncoded.get("action").headOption match {
    case Some("edit") => Ok("Clicked edit")
    case Some("remove") => Ok("Clicked remove")
    case _ => BadRequest("This action is not allowed")
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-30T12:44:53.183

为了补充[Julien Lafont](https://stackoverflow.com/questions/14007541/playframework-form-and-two-submit-buttons/14007854#14007854)和[OlivierBlanvillain](https://stackoverflow.com/a/17208348/599253)的答案，在表单验证错误的情况下。如果该表单刚刚返回，则操作保持不变。因此，过滤掉该动作会在下一次给出正确的动作。

```
 val postAction: String = request.body.asFormUrlEncoded.get("action").head

  // bind the form request.
  val bindFromRequest: Form[CaseClass] = CaseOriginalForm.bindFromRequest
  bindFromRequest.fold(
    formWithErrors => {
      // filter out the action button data (otherwise the first action comes back)
      val filterNot: Map[String, String] = formWithErrors.data.filterNot(f => f._1 == "action")
      val formWithErrors2= CaseOriginalForm.bind(filterNot)
      BadRequest(views.html.FormPage(formWithErrors2))
    },
    contact => {
        Ok( "Succes page " + postAction)
    }
  ) 
```

# python - 对 AES-NI 的 Python 支持

> ID：14007542
> 
> 赞同：5
> 
> 时间：2012-12-22T23:45:29.990
> 
> 标签：python, aes, aes-ni

有没有办法在 Python 中使用 AES-NI？我确实想通过利用我对 AES-NI 的硬件支持来使 HMAC 更快。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T13:33:20.450

HMAC 使用的是安全加密哈希，而不是对称密码。您可以使“普通”MAC（例如 AES-CMAC）性能更好，但不能使 HMAC 性能更好。

# ios - Box.Net iOS SDK 移动文件和文件夹

> ID：14007543
> 
> 赞同：0
> 
> 时间：2012-12-22T23:45:43.857
> 
> 标签：ios, sdk, box-api

我目前正在开发一个 iOS 应用程序并正在实现 Box.Net SDK。除了移动文件的能力之外，我已经完成了所有工作，这不是 SDK 的本机功能。我试图通过它扭转我的方式。

如果你熟悉 Box.Net 的结构，每个文件/文件夹都有一个自己的 ID 号，以及一个其父级的 ID。据我了解，如果我想移动文件，我应该更改文件上的父 ID 号，将其指向新位置。我似乎无法让它正常工作。我的应用程序似乎一直在崩溃。

这是我到目前为止所概括的。

```
BoxObject *boxObject = [[[Box objectWithID:(ID#ofParent)] children] objectAtIndex:i];
[boxObject parent].boxID = 0; // <-- Problem (causes crash) 
```

我也试过这个。

```
[boxObject setParent:[Box folderWithID:[BoxID numberWithInt:i]]]; 
```

boxObject 变量是我要移动的文件。我将其父 ID 设置为 0，它应该是根文件夹。但是，当我尝试为文件重新分配父 ID 时，我的应用程序崩溃了。关于如何成功移动文件/文件夹的任何想法？任何帮助深表感谢！提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T01:26:53.053

好的。我想没有办法用 SDK 在内部解决这个问题。所以，我不得不发出一个外部 PUT 请求。我使用以下代码来处理移动文件。

```
- (void)moveItem:(BoxObject *)object toParentFolderWithID:(BoxID *)parentID
{
NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"https://api.box.com/2.0/files/%@", object.boxID]];
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
[request setHTTPMethod:@"PUT"];
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSString *auth = [NSString stringWithFormat:@"BoxAuth api_key=%@&auth_token=%@",[Box boxAPIKey],[defaults objectForKey:@"box-api-auth-token"]];

NSString *payload = [NSString stringWithFormat:@"{\"parent\": {\"id\": %@}}", parentID];
[request setHTTPBody:[NSMutableData dataWithData:[payload dataUsingEncoding:NSUTF8StringEncoding]]];
[request setValue:auth forHTTPHeaderField:@"Authorization"];

NSURLConnection *connection = [NSURLConnection connectionWithRequest:request delegate:self];
[connection start];
} 
```

提醒一下，如果您是 Box SDK 的新手，您很可能需要在移动文件后更新/刷新数据。如果不处理，如果文件不存在，您的应用程序可能会崩溃。希望这对任何对此不确定的人有所帮助。

# python - Python Regex 立即替换组

> ID：14007545
> 
> 赞同：146
> 
> 时间：2012-12-22T23:45:57.310
> 
> 标签：python, regex, regex-group

有没有办法使用正则表达式语法直接替换所有组？

正常方式：

```
re.match(r"(?:aaa)(_bbb)", string1).group(1) 
```

但我想实现这样的目标：

```
re.match(r"(\d.*?)\s(\d.*?)", "(CALL_GROUP_1) (CALL_GROUP_2)") 
```

我想从 Regex 刚刚捕获的组中立即构建新字符串。

* * *

## 回答 #1

> 赞同：256
> 
> 时间：2012-12-22T23:48:38.090

看看[`re.sub`](http://docs.python.org/2/library/re.html#re.sub)：

```
result = re.sub(r"(\d.*?)\s(\d.*?)", r"\1 \2", string1) 
```

这是 Python 的正则表达式替换（replace）函数。替换字符串可以填充所谓的反向引用（反斜杠、组号），这些反向引用被替换为组匹配的内容。组的计数与`group(...)`函数相同，即从 开始`1`，从左到右，通过开括号。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2018-06-06T11:02:45.477

接受的答案是完美的。我要补充一点，使用这种语法可能会更好地实现组引用：

```
r"\g<1> \g<2>" 
```

用于替换字符串。这样，您可以解决组后面可能跟一个数字的语法限制。同样，这一切都存在于文档中，没有什么新鲜的，只是有时很难一见钟情。

# android - 意外的 WebView 内容外观

> ID：14007546
> 
> 赞同：0
> 
> 时间：2012-12-22T23:46:13.903
> 
> 标签：android, android-webview

为了获得相同的外观`TextView`和`WebView`内容，我遇到了 Android 4 的强大阻力。

正如`Display` `getWidth()`已弃用的那样，我已经尝试了 Android 4 的硬编码值，但结果是相同的：在`webView`文本变大并且在`textView`减小字体大小的同时出现滚动。

相同显示类型的这种行为对我来说没有任何意义，任何人都可以告诉我是否记录在任何地方吗？

* * *

**解决方案：**`pt` WebView 似乎忽略了，我不得不尽可能地 使用`px`缩放`sp`：

```
((TextView)findViewById(R.id.textView1)).setTextSize(TypedValue.COMPLEX_UNIT_SP,24);

font-size: " + pixelsToSp(this, 24.0f) + "px;

private float scaledPX(Context context, Float px) {
    return TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_PX, px, getResources().getDisplayMetrics());
} 
```

* * *

安卓 2.3 WVGA

![安卓 2.3](../Images/8650a1c05acccec31fc37bc50d90d96d.png)

安卓 4.1 WVGA

![安卓4.1](../Images/9ac96d3352a4602680c42eb9c7c4743d.png)

布局

```
<TextView
    android:id="@+id/textView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="10dp"
    android:text="same text"/>

<WebView
    android:id="@+id/webView1"
    android:layout_width="match_parent"
    android:layout_height="match_parent" /> 
```

代码

```
((WebView)findViewById(R.id.webView1)).getSettings().setLoadWithOverviewMode(true);
((WebView)findViewById(R.id.webView1)).getSettings().setUseWideViewPort(true);
((WebView)findViewById(R.id.webView1)).getSettings().setLayoutAlgorithm(LayoutAlgorithm.SINGLE_COLUMN); // this line was missed when the screenshots was made, it makes the images being scaled correctly

((TextView)findViewById(R.id.textView1)).setTextSize(TypedValue.COMPLEX_UNIT_PX,24);
final String width = Integer.toString(getWindowManager().getDefaultDisplay().getWidth());
final String html = "<html style = 'margin: 0px; padding: 0px;'>"
        + "<head>"
        + "<meta name='viewport' content='width=device-width; user-scalable=no; initial-scale=1.0; minimum-scale=1.0; maximum-scale=1.0; target-densityDpi=device-dpi;'/>"
        + "</head>"
        + "<body style = '"
        + "width: "
        + width
        + "px;"
        + ";'>"
        + "<div style='overflow: hidden; width: 100%; font-size: " + 24 + "px;'>"
        + "same text size"
        + "<img style='max-width: " + width + "px;' src=\"http://upload.wikimedia.org/wikipedia/commons/c/ca/Niobe050905-Siamese_Cat.jpeg\"/>"
        + "</div>"
        + "</body>";

((WebView)findViewById(R.id.webView1)).loadDataWithBaseURL("", html, "text/html", "UTF-8", ""); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:00:47.840

你在什么设备上测试？我怀疑它更多地与基于屏幕的缩放而不是android本身的版本有关。

该`setTextSize(float size)`方法使用缩放像素单位 (sp)。html 使用的是 pt 单位，我认为它不会像 sp 那样考虑显示分辨率。

试试这样：

```
((TextView)findViewById(R.id.textView1)).setTextSize(TypedValue.COMPLEX_UNIT_PT,24); 
```

那应该使用 pt 单位而不是 sp。这*可能*会使文本看起来与 WebView 内部相同。然而，要考虑的另一件事是 WebView 具有缩放因子。即使字体大小相同，WebView 也可以放大/缩小，而默认 TextView 不能，这也会导致屏幕上的字体大小不同。

# php - 下面的“用户名”字段未填充到我的 Mysql 数据库中

> ID：14007548
> 
> 赞同：-2
> 
> 时间：2012-12-22T23:46:25.433
> 
> 标签：php, mysql, codeigniter, activerecord

我正在尝试为我正在为一个大学项目工作的社交网站创建一个图片库，但我似乎无法将“用户名”字段填充到我的数据库中。Galleryimage 字段填充良好，但用户名字段仅显示“0”。我的“画廊”表中有 3 个字段（id、用户名和画廊图像）。我将 MVC 与 CodeIgniter 框架一起使用。我的 Active Record 代码似乎有问题。任何帮助将不胜感激。

以下是我的模型中的 get/set 函数：

```
 private $galleryTable = 'gallery';

          function Gallery()
          {
            parent::__construct();
          } 
```

putProfileGallery 填充了我数据库中的图库表。

```
 function putProfileGallery($username, $image)
          {
            $record = array('username' => $username, 'galleryimage' => $image);

            $this->db->where('username', $username)->insert('gallery', $record);
          } 
```

getProfileGallery 函数循环遍历表并应该输出到屏幕。

```
 function getProfileGallery($username)

          {
            $this->db->select('*')->from('gallery')->where('username', $username);
            $gallerySet = $this->db->get();

            $gallery = array();
            foreach ($gallerySet->result() as $row)
            {       
                $gallery[] = array('username' => $row->username, 'galleryimage' => $row->galleryimage);
            }
            return $gallery;
          }
         } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:16:50.423

你不能结合`where`和`insert`。

`$this->db->where('username', $username)->insert('gallery', $record);`应该只是`$this->db->insert('gallery', $record);`

`update`如果你想更新一行，你应该使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:03:08.483

在调用插入函数之前，您是否尝试过这样做，以确保 $username 具有正确的值

```
var_dump ($username); 
```

除此之外，我看到您在 insert() 之前有一个 where()，这似乎不正确。

# wxpython - 在 Ubuntu 12.04 上安装 wxPython

> ID：14007557
> 
> 赞同：16
> 
> 时间：2012-12-22T23:47:43.197
> 
> 标签：wxpython, installation, debian, ubuntu-12.04

**问题：**我在 Ubuntu 12.04 上安装 wxPython 时遇到问题。*我想找到一种简单直接的方法来做到这一点。*

**到目前为止我做了什么：**到目前为止我能找到的最相关的说明可以在这里找到：[http ://wiki.wxpython.org/InstallingOnUbuntuOrDebian](http://wiki.wxpython.org/InstallingOnUbuntuOrDebian)

这些说明的问题在于 Precise 12.04 没有可用的选择。显示的最新发行版是 Natty 11.4。据我所知，正确的方法是手动构建 debian 包，这里解释：[http ://wiki.wxpython.org/BuildingDebianPackages](http://wiki.wxpython.org/BuildingDebianPackages)

尝试此操作并最终键入命令“fakeroot debian/rules binary”时，出现错误：

> debian/rules:14: /usr/share/quilt/quilt.make: 没有这样的文件或目录
> pyversions: 控制文件中缺少 X(S)-Python-Version，回退到
> debian/pyversions , 回退到支持的版本
> make: *** 没有规则来制作目标 `/usr/share/quilt/quilt.make'。停止。

我似乎无法修复此错误，或找到任何其他适用于我的资源。我会在这里发布更多链接，但由于我是新手，垃圾邮件过滤器阻止了我这样做。

**结论：*有人知道在 Ubuntu 12.04 Precise 上正确安装 wxPython 的简单解决方案吗？***

**更新：**我尝试简单地使用 apt-get 命令“sudo apt-get install python-wxgtk2.8”，我收到了这个（这看起来不错）：

> 正在读取包列表...完成
> 构建依赖树
> 
> 读取状态信息...完成
> python-wxgtk2.8已经是最新版本。
> 以下软件包已自动安装且不再需要：
> language-pack-zh-hans yaml-cpp language-pack-kde-en language-pack-kde-zh-hans language-pack-kde-en-base language-pack -zh-hans-base language-pack-kde-zh-hans-base
> 使用 'apt-get autoremove' 删除它们。
> 0 升级，0 新安装，0 删除，173 未升级。

但是，一旦我尝试运行某些东西，即“python test_gui.py”，我就会收到以下错误：

> Traceback（最近一次调用最后一次）：
> 文件“test_gui.py”，第 1 行，在
> import wx
> ImportError: No module named wx

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-05-23T12:41:18.823

好的。所以我找到了出路只需在终端中运行以下命令：

```
sudo apt-get install python-wxgtk2.8 python-wxtools wx2.8-doc wx2.8-examples wx2.8-headers wx2.8-i18n 
```

瞧！有用！

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-12-23T02:04:36.013

好的，所以我能够弄清楚。事实证明这是一个组合。

1.  首先确保你已经安装了 Python
2.  使用命令安装 wxGTK 2.8，`sudo apt-get install python-wxgtk2.8`
3.  运行命令，`apt-get source -d wxwidgets2.8`
4.  现在运行，`dpkg-source -x wxwidgets2.8_2.8.12.1-6ubuntu2.dsc`
5.  `cd wxwidgets2.8-2.8.12.1`
6.  `cd wxPython`
7.  现在运行命令，`sudo python setup.py install`
8.  wxPython 和 wxWidgets 现已成功安装！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-09-17T00:17:40.867

`sudo apt-get install python-wxgtk2.8 python-wxtools wx2.8-i18n libwxgtk2.8-dev libgtk2.0-dev`为我工作

来源：[http ://wiki.wxpython.org/InstallingOnUbuntuOrDebian](http://wiki.wxpython.org/InstallingOnUbuntuOrDebian)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-04-17T19:22:42.390

您也可以使用**Pip**安装它，但对安装命令*稍作修改。*

**来自 wxPython[网站](https://wxpython.org/pages/downloads/index.html)：**

> 由于 Linux 发行版之间的差异（主要是默认安装的核心库的不同版本，还有平台架构等），不可能在 PyPI 上托管 Linux 的二进制轮文件，除非它们可以在约束范围内工作PEP 513 不幸的是，尝试将 wxPython 钉入 manylinux1 漏洞的尝试并不十分成功。也许 manylinux2 会更合适。同时，如果您有一个与 wxPython Extras linux 文件夹下用于构建轮子的 Linux 足够相似的 Linux，那么您可以使用它们而无需自己构建轮子。
> 
> 由于发行版和 wx 端口（GTK2 或 GTK3）有多种选项，因此文件不能全部位于同一文件夹中，以便通过 pip 轻松访问。这只是意味着您需要更深入地了解要提供给 pip 的 URL。例如，要获得适用于 Ubuntu 16.04（和 16.10、LinuxMint 18 以及可能的其他版本）的 GTK3 wxPython 构建，您可以使用如下 pip 命令：

```
pip install -U -f https://extras.wxpython.org/wxPython4/extras/linux/gtk3/ubuntu-16.04 wxPython 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-20T09:00:06.523

gtk3 应该先安装

```
$sudo apt-get libgtk-3-dev 
```

如果您在 Python3 上安装 wxpython 时遇到问题，请使用此命令安装 wxpython

```
$ pip install -U -f https://extras.wxpython.org/wxPython4/extras/linux/gtk3/ubuntu-16.04 wxPython 
```

通过这个命令你可以安装最新的 wxPython4 版本。如果您使用的是 Windows 或 macOS

```
$ pip install -U wxpython 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-19T15:28:44.480

在 Ubuntu 12.04.5 上，我必须使用所有这些

```
apt-get install python-wxgtk2.8 python-wxtools wx2.8-doc wx2.8-examples wx2.8-headers wx2.8-i18n python-wxversion libwxbase2.8-0 libwxgtk2.8-0 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-11-18T08:23:48.717

我已经按照这种方式成功安装了 wxpython（也是 ubuntu 12.04）：

*   1.  软件包和存储库元数据经过数字签名，因此您需要将密钥导入 apt 的受信任密钥列表中，以免收到有关它的警告。
*   2.  将这些行添加到 /etc/apt/sources.list 文件中
*   3.  运行此命令以更新包元数据的本地副本。

    > sudo apt-get 更新

*   4.  您现在可以使用您最喜欢的包选择工具来安装或升级 wxWidgets 和 wxPython 包。以下是使用 apt-get 的方法：

    > sudo apt-get install python-wxgtk2.8 python-wxtools wx2.8-i18n

参考链接：

[http://wiki.wxpython.org/InstallingOnUbuntuOrDebian](http://wiki.wxpython.org/InstallingOnUbuntuOrDebian)

# android - 使用谷歌地图或通过 Intent 导航

> ID：14007558
> 
> 赞同：1
> 
> 时间：2012-12-22T23:47:43.873
> 
> 标签：android, google-maps

我正在开发一个应用程序，我正在其中启动一个使用谷歌地图导航的意图。现在我的问题是，我是否必须在我的应用程序中包含谷歌地图 API 密钥或谷歌的其他某种许可，或者我可以去吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:53:39.007

如果您使用`ACTION_VIEW`a`geo:` `Uri`来启动 Google 地图，则不需要 Maps API 密钥或任何其他类型的权限。

# php - 从 Google OAuth 2.0 PHP API 获取用户信息

> ID：14007560
> 
> 赞同：25
> 
> 时间：2012-12-22T23:49:24.140
> 
> 标签：php, google-api, oauth-2.0, google-api-php-client

我正在尝试使用 Google Oauth API 来获取用户信息。它非常适用于 Google Plus API，但我正在尝试创建一个备份，以防用户没有 google plus 帐户。身份验证过程是正确的，我什至得到了 $userinfo 对象，但我究竟如何访问这些属性。我试过 $userinfo->get() 但它只返回用户的 ID。

难道我做错了什么？这是我正在使用的代码...

```
require_once '../../src/Google_Client.php';
require_once '../../src/contrib/Google_Oauth2Service.php';

session_start();

$client = new Google_Client();
$client->setApplicationName("Google+ PHP Starter Application");
// Visit https://code.google.com/apis/console to generate your
// oauth2_client_id, oauth2_client_secret, and to register your oauth2_redirect_uri.
 $client->setClientId('*********************');
 $client->setClientSecret('**************');
 $client->setRedirectUri('***************');
 $client->setDeveloperKey('**************');
$plus = new Google_Oauth2Service($client);

if (isset($_REQUEST['logout'])) {
  unset($_SESSION['access_token']);
}

if (isset($_GET['code'])) {
  $client->authenticate($_GET['code']);
  $_SESSION['access_token'] = $client->getAccessToken();
  header('Location: http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF']);
}

if (isset($_SESSION['access_token'])) {
  $client->setAccessToken($_SESSION['access_token']);
}

if ($client->getAccessToken()) 
{
    $userinfo = $plus->userinfo;
    print_r($userinfo->get());

} else 
{
    $authUrl = $client->createAuthUrl();
}
?>
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <link rel='stylesheet' href='style.css' />
</head>
<body>
<header><h1>Google+ Sample App</h1></header>
<div class="box">

<?php if(isset($personMarkup)): ?>
<div class="me"><?php print $personMarkup ?></div>
<?php endif ?>

<?php
  if(isset($authUrl)) {
    print "<a class='login' href='$authUrl'>Connect Me!</a>";
  } else {
   print "<a class='logout' href='?logout'>Logout</a>";
  }
?>
</div>
</body>
</html> 
```

谢谢...

******编辑* *** *** 缺少范围——已添加**

 **```
 $client->setScopes(array('https://www.googleapis.com/auth/userinfo.email','https://www.googleapis.com/auth/userinfo.profile')); 
```

现在工作...

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-23T04:56:37.317

缺少范围

```
$client->setScopes(array('https://www.googleapis.com/auth/userinfo.email','https://www.googleapis.com/auth/userinfo.profile')); 
```

现在就像一个魅力！

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-04-18T02:23:58.453

我不确定它是否有帮助，但由于 Google API PHP 客户端已更新，我以这种方式获取用户信息：

```
 $oauth = new Google_Service_Oauth2($googleClient);

        var_dump($oauth->userinfo->get()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-06T10:13:54.497

[Google API PHP 客户端](https://github.com/google/google-api-php-client)库已更改 -以下是您获取用户信息的方式：

```
<?php

require_once('google-api-php-client-1.1.7/src/Google/autoload.php');

const TITLE = 'My amazing app';
const REDIRECT = 'https://example.com/myapp/';

session_start();

$client = new Google_Client();
$client->setApplicationName(TITLE);
$client->setClientId('REPLACE_ME.apps.googleusercontent.com');
$client->setClientSecret('REPLACE_ME');
$client->setRedirectUri(REDIRECT);
$client->setScopes(array(Google_Service_Plus::PLUS_ME));
$plus = new Google_Service_Plus($client);

if (isset($_REQUEST['logout'])) {
        unset($_SESSION['access_token']);
}

if (isset($_GET['code'])) {
        if (strval($_SESSION['state']) !== strval($_GET['state'])) {
                error_log('The session state did not match.');
                exit(1);
        }

        $client->authenticate($_GET['code']);
        $_SESSION['access_token'] = $client->getAccessToken();
        header('Location: ' . REDIRECT);
}

if (isset($_SESSION['access_token'])) {
        $client->setAccessToken($_SESSION['access_token']);
}

if ($client->getAccessToken() && !$client->isAccessTokenExpired()) {
        try {
                $me = $plus->people->get('me');
                $body = '<PRE>' . print_r($me, TRUE) . '</PRE>';
        } catch (Google_Exception $e) {
                error_log($e);
                $body = htmlspecialchars($e->getMessage());
        }
        # the access token may have been updated lazily
        $_SESSION['access_token'] = $client->getAccessToken();
} else {
        $state = mt_rand();
        $client->setState($state);
        $_SESSION['state'] = $state;
        $body = sprintf('<P><A HREF="%s">Login</A></P>',
            $client->createAuthUrl());
}

?>

<!DOCTYPE HTML>
<HTML>
<HEAD>
        <TITLE><?= TITLE ?></TITLE>
</HEAD>
<BODY>
        <?= $body ?>
        <P><A HREF="<?= REDIRECT ?>?logout">Logout</A></P>
</BODY>
</HTML> 
```

不要忘记 -

1.  [在Google API 控制台](https://console.developers.google.com)获取 Web 客户端 ID 和密码
2.  授权`https://example.com/myapp/`在同一个地方

[您可以在Youtube GitHub 上](https://github.com/youtube/api-samples/tree/master/php)找到官方示例。

**2017 年更新：**

您可以添加要检索的字段：

```
const FIELDS       = 'id,name,image';
$me = $plus->people->get('me', array('fields' => FIELDS)); 
```**

# java - 尽管此循环（readLines）未添加空条目，但我仍然收到 NullPointerException 吗？

> ID：14007562
> 
> 赞同：2
> 
> 时间：2012-12-22T23:49:35.170
> 
> 标签：java

我的代码中出现 NullPointerException 错误，我已将其缩小为导致异常的这段代码

```
AttributedString mStyledText = new AttributedString(mText); 
```

我曾认为 mText 的值将使用以下代码从代码中重新检索：

```
BufferedReader br = null;
                    try {
                        br = new BufferedReader(new FileReader(path));
                        List<String> list = new ArrayList<String>();
                        while ((mText = br.readLine()) != null) {
                            //Displays the contents of the file in terminal
                            System.out.println(mText);
                            list.add(mText);
                        } 
```

但是我仍然得到null错误，我认为值mText会来自上面的代码并被使用但是这似乎没有发生，为什么会这样，整个代码在下面

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.print.*;
import java.text.*;
import java.io.*;
import javax.swing.*;
import java.util.List;
import java.util.ArrayList;

public class PrintText implements Printable {

     private List<String> list;

    // Below the code will allow the user to select a file and then print out the contents of the file
    public static void main(String[] args) throws IOException {
        new PrintText();
    }

    public PrintText() {
        EventQueue.invokeLater(new Runnable() {
                @Override
                public void run() {
                    try {
                        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                    } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                    }

                    //selects the file
                    JFileChooser chooser = new JFileChooser();
                    chooser.showOpenDialog(null);
                    File file = chooser.getSelectedFile();
                    String filename = file.getName();
                    //System.out.println("You have selected: " + filename);  testing to see if file seleected was right
                    String path = file.getAbsolutePath();

                    //Reads contents of file into terminal 
                    //FileReader fr = new FileReader("filename");
                    // FileReader fr = new FileReader("D:/Documents/" + "filename")); 

                    BufferedReader br = null;
                    try {
                        br = new BufferedReader(new FileReader(path));
                        List<String> list = new ArrayList<String>();
                        String line;
                        while ((line = br.readLine()) != null) {
                            System.out.println(line);
                            list.add(line);
                        }

                        printer();
                    } catch (IOException exp) {
                        exp.printStackTrace();
                    } finally {
                        try {
                            br.close();
                        } catch (Exception e) {
                        }
                    }
                    //fr.close(); 
                }
            });
    }
    //private static final String mText = 
    //    "This is a test to see if this text will be printed "; //This works perfectly fine
    //AttributedString mStyledText = new AttributedString(mText);
    /**
     * Print a single page containing some sample text.
     */
    public void printer() {

        /* Get the representation of the current printer and 
         * the current print job.
         */
        PrinterJob printerJob = PrinterJob.getPrinterJob();
        /* Build a book containing pairs of page painters (Printables)
         * and PageFormats. This example has a single page containing
         * text.
         */
        Book book = new Book();
        book.append(this, new PageFormat());
        /* Set the object to be printed (the Book) into the PrinterJob.
         * Doing this before bringing up the print dialog allows the
         * print dialog to correctly display the page range to be printed
         * and to dissallow any print settings not appropriate for the
         * pages to be printed.
         */
        printerJob.setPageable(book);
        /* Show the print dialog to the user. This is an optional step
         * and need not be done if the application wants to perform
         * 'quiet' printing. If the user cancels the print dialog then false
         * is returned. If true is returned we go ahead and print.
         */
        boolean doPrint = printerJob.printDialog();
        if (doPrint) {
            try {
                printerJob.print();
            } catch (PrinterException exception) {
                System.err.println("Printing error: " + exception);
            }
        }
    }

    /**
     * Print a page of text.
     */
    public int print(Graphics g, PageFormat format, int pageIndex) {

        System.out.println("About to obtain an attributed string, list=" + list);
        AttributedString mStyledText = new AttributedString(list);
        // etc
        /* We'll assume that Jav2D is available.
         */
        Graphics2D g2d = (Graphics2D) g;
        /* Move the origin from the corner of the Paper to the corner
         * of the imageable area.
         */
        g2d.translate(format.getImageableX(), format.getImageableY());
        /* Set the text color.
         */
        g2d.setPaint(Color.black);
        /* Use a LineBreakMeasurer instance to break our text into
         * lines that fit the imageable area of the page.
         */
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {
            TextLayout layout = measurer.nextLayout(wrappingWidth);
            pen.y += layout.getAscent();
            float dx = layout.isLeftToRight() ? 0 : (wrappingWidth - layout.getAdvance());
            layout.draw(g2d, pen.x + dx, pen.y);
            pen.y += layout.getDescent() + layout.getLeading();
        }
        return Printable.PAGE_EXISTS;
    }
} 
```

完整的堆栈跟踪：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at java.text.AttributedString.<init>(AttributedString.java:127)
    at PrintText.print(PrintText.java:109)
    at sun.print.RasterPrinterJob.printPage(RasterPrinterJob.java:1973)
    at sun.print.RasterPrinterJob.print(RasterPrinterJob.java:1461)
    at sun.print.RasterPrinterJob.print(RasterPrinterJob.java:1277)
    at PrintText.printer(PrintText.java:97)
    at PrintText$1.run(PrintText.java:51)
    at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:251)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:721)
    at java.awt.EventQueue.access$200(EventQueue.java:103)
    at java.awt.EventQueue$3.run(EventQueue.java:682)
    at java.awt.EventQueue$3.run(EventQueue.java:680)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:691)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T23:52:12.997

这个循环可以退出的唯一方法：

```
while ((mText = br.readLine()) != null) {
    System.out.println(mText);
    list.add(mText);
} 
```

是什么时候`mText`为空。所以可以肯定的是，`mText`稍后在代码中必须为空。

您可以使用`list`变量访问文件的行，但您需要将其作为参数传递给您的方法：

```
public void printer(List<String> list) {
    // etc...
} 
```

或者让它成为你的类的一个字段，以便类中的其他方法可以看到它。

```
public class PrintText implements Printable {
    private List<String> list;
    // etc..
} 
```

* * *

除了减少将来出现类似错误的风险外，我建议您删除静态字段`mText`，而在方法内使用局部变量：

```
String line;
while ((line = br.readLine()) != null) {
    System.out.println(line);
    list.add(line);
} 
```

# c# - Java ME应用程序和C#应用程序之间使用蓝牙的通信

> ID：14007565
> 
> 赞同：1
> 
> 时间：2012-12-22T23:50:27.067
> 
> 标签：c#, java-me, bluetooth, jsr82

我是最近开始使用 Java 的 C# 开发人员，从未在 Java ME 中做过任何事情。我的下一个项目需要使用蓝牙将简单的按键从手机键盘传递到 C# 应用程序，有一些关于通过蓝牙发送/接收文件的示例，但是关于如何在应用程序之间传递消息的文档很少：

我偶然发现了 32feet.NET 库，但提供的示例很差，对我来说更大的谜团是应用程序的 J2ME 方面。

如果有人可以提供任何代码示例或只是解释一些基本的东西和蓝牙通信之间的手机和桌面应用程序的原则：

*   什么蓝牙服务用于传递消息？串行端口？
*   什么类型的数据可以用于通信？
*   连接如何保持活跃？

# c++ - 如何让一个班级有两个名字？

> ID：14007566
> 
> 赞同：6
> 
> 时间：2012-12-22T23:51:28.740
> 
> 标签：c++

我正在使用一个在平台/版本之间只有一个区别的库。一个版本称为 btCollisionObject 类，其他版本称为 btCollisionObjectWrapper。如果我可以让这个类有两个仍然引用该类的名称，那么我的所有问题都将得到解决。我试过了：`#define btCollisionObject btCollisionObjectWrapper;`但它不起作用。在定义类之后给类两个名称的正确方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-22T23:53:02.973

也许

```
typedef btCollisionObjectWrapper btCollisionObject; 
```

最好使用语言工具而不是预处理器来完成。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-23T00:14:44.697

如果我正确理解您的问题，您将不得不找到一种方法来确定您正在为哪个平台编译，因为我不知道您正在使用哪些平台我无法就此提供任何建议，但是可能可以这样做通过宏。

您的问题的解决方案可能看起来有点像这样。

在 C++98 中使用**类型声明**

```
#ifdef __PLATFORM_SPECIFIC_DEFINE
    typedef btCollisionObjectWrapper btCollisionObject;
#endif 
```

在使用**别名声明**的 C++11 中，这具有额外的优势，即它们可以与模板一起使用，但是在您的情况下，您可以使用简单的 typedef。

```
#ifdef __PLATFORM_SPECIFIC_DEFINE
    using btCollisionObject = btCollisionObjectWrapper;
#endif 
```

这将允许您`btCollisionObject`用作使用的平台的类名`btCollisionObjectWrapper`

您当然必须将 替换`__PLATFORM_SPECIFIC_DEFINE`为由使用`btCollisionObjectWrapper`.

# c# - WeakReference 引用委托时 GC 不收集？

> ID：14007569
> 
> 赞同：6
> 
> 时间：2012-12-22T23:51:53.733
> 
> 标签：c#, delegates, weak-references

在我看来，当我在`WeakReference`对象类的委托方法上使用该类时，对象类被 GC 收集，但它的另一个副本仍然存在于`WeakReference`?

我觉得很难用语言来解释。我举个例子。我有以下名为的对象类`TestObject`：

```
class TestObject
{
    public string message = "";

    private delegate string deleg();

    public TestObject(string msg)
    {
        message = msg;
    }

    public Delegate GetMethod()
    {
        deleg tmp = this.TestMethod;
        return tmp;
    }

    public string TestMethod()
    {
        return message;
    }

} 
```

`TestMethod`现在，在我的主应用程序中，我尝试`TestObject`通过`WeakReference`. 目的是`TestObject`当所有硬引用都消失时，GC 可以收集它们。这是我的主要应用程序的样子：

```
static void Main(string[] args)
    {
        var list = new List<WeakReference>();
        var obj = new TestObject("Hello 1");
        list.Add(new WeakReference(obj.GetMethod()));
        Console.WriteLine("Initial obj: " + ((Delegate)list[0].Target).DynamicInvoke());      //Works fine
        obj = null;     //Now, obj is set to null, the TestObject("Hello 1") can be collected by GC
        GC.Collect();   //Force GC
        Console.WriteLine("Is obj null: " + ((obj) == null ? "True" : "False"));
        Console.WriteLine("After GC collection: " + ((Delegate)list[0].Target).DynamicInvoke());
        Console.ReadKey();
    } 
```

这是我运行上述代码时的输出：

![在此处输入图像描述](../Images/ba2be5b0d17b3e1abce6bcdbc6d13a62.png)

这是奇怪的事情。*在第一行*，`obj`可以打印`"Hello 1"`，因为它刚刚初始化并且`obj`持有对`TestObject`. 全部正确。接下来，`obj`被设置为`null`with`obj = null`并且 GC 被强制收集。因此，*在输出的第二行中*，`obj`为`true`空。最后*在最后一行*，由于 GC 已经收集了`obj`它，我希望它要么抛出 a`NullReferenceException`要么在输出上不打印任何内容。但是，它实际上打印了与输出的第一行相同的内容！此时不应该`TestObject`由GC收集吗？！

这引出了一个问题，如果在我将 obj 设置为 null 之后，GC 后来是否收集了`TestObject`最初保存的。`obj`

如果我将整个对象传递给`WeakReference`，即 ，`new WeakReference(obj)`而不是将委托传递给`WeakReference`，它会完美地工作。

不幸的是，在我的代码中，我需要传递`WeakReference`给委托人。如何`WeakReference`让 GC 正常工作，以便 GC 仅通过引用委托来收集对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T00:07:35.357

我认为问题出在您的测试中 - 而不是在框架中。似乎将局部变量设置为 null 并没有达到您的预期。如果我们完全跳过局部变量，我们会在“after”行得到预期的 NullReferenceException：

```
static void Main(string[] args)
{
    var list = new List<WeakReference>();
    //var obj = new TestObject("Hello 1");
    list.Add(new WeakReference(new TestObject("Hello 1").GetMethod()));
    Console.WriteLine("Initial obj: " + ((Delegate)list[0].Target).DynamicInvoke());      //Works fine
    //obj = null;     //Now, obj is set to null, the TestObject("Hello 1") can be collected by GC
    GC.Collect();   //Force GC
    //Console.WriteLine("Is obj null: " + ((obj) == null ? "True" : "False"));
    Console.WriteLine("After GC collection: " + ((Delegate)list[0].Target).DynamicInvoke());
    Console.ReadKey();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T08:05:42.423

实际上，您的示例将按预期运行，因为除了 WeakReference 指代委托之外，您什么都没有，因此即使您注释掉“obj = null”行，GC 也可以收集它！

![这是我的结果](../Images/18955154d1d277546bc56a39b087debd.png)

也许是因为我在一个单独的线程上运行代码（除了主线程）？

# sql - 插入后 24 小时删除记录

> ID：14007572
> 
> 赞同：0
> 
> 时间：2012-12-22T23:52:13.183
> 
> 标签：sql, sql-server, tsql

有没有办法在 Transact-SQL 中创建 24 小时后自动删除行？

我正在制作一个网站（学习体验），用户需要在注册后单击通过电子邮件发送的验证链接。我希望用户在 24 小时内验证自己。

我想我需要的是一个触发器，但我真的不确定语法，甚至是否可能。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-22T23:55:08.853

我不确定您的架构，但我会以不同的方式进行。我将有一个与验证链接对应的数据库记录的日期/时间。当他们单击链接时，验证数据库记录的日期和时间是否在当前时间的 24 小时内。如果是，则允许，否则拒绝。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T23:59:43.683

问：有没有办法在 Transact-SQL 中创建 24 小时后自动删除行？

答：当然。编写“sqlcmd”脚本，将其包装在 .bat 文件中，然后从 Windows 计划任务中调用它：

*   [http://windows.microsoft.com/en-US/windows7/schedule-a-task](http://windows.microsoft.com/en-US/windows7/schedule-a-task)

或者，根据您的版本，您可以从 SQL Server 代理安排相同的 SQL 脚本：

*   [http://msdn.microsoft.com/en-us/library/ms189237.aspx](http://msdn.microsoft.com/en-us/library/ms189237.aspx)

对事物进行不同的旋转：

*   当用户单击您的链接时，您可以检查当前时间（相对于 MSSQL）是否为 >> 24 小时。如果是这样，您将回复“为时已晚”消息（而不是验证条目）。

无论如何-您绝对，完全，完全*不想*使用触发器！

# javascript - 我可以做些什么来验证我的代码错误

> ID：14007575
> 
> 赞同：0
> 
> 时间：2012-12-22T23:52:34.703
> 
> 标签：javascript, firefox, firefox-addon

我可以做些什么来确保我的代码是安全的？我来自 Mozilla 的插件已经过验证，但显然这条线是不安全的：

```
if (p.getElementById("bluebarholder"))
  p.getElementById("top").setAttribute('onclick', 'window.open("http://www.facebook.com","_self")'); 
```

我不知道是什么问题或如何解决，因为他们还没有回复我的消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:56:34.713

这是“eval is evil”的一个例子。
您将字符串作为事件处理程序传递，迫使浏览器启动 Javascript 解析器来评估字符串。

相反，您应该调用`addEventListener`将函数添加为处理程序。

# jquery - 从单独的 .js 文件调用主页中的 jquery 函数。

> ID：14007578
> 
> 赞同：5
> 
> 时间：2012-12-22T23:53:03.403
> 
> 标签：jquery, function

这是我的 HTML 页面：

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>

<script type="text/javascript" src="jquery-1.8.2.min.js"></script>

<script type="text/javascript" src="myscript.js"></script>

<script type="text/javascript">

$(document).ready(function() {
function closecontactform(){
alert("closing the form");
};
});
</script>
</head>
<body>
<p id="elementname">Click me to call function</p>
</body> 
```

这是在 myscripts.js 文件中：

```
$(document).ready(function() {
$('#elementname').click(function() {
alert("click detected");
closecontactform();
}); 
}); 
```

我的实际页面比这要复杂得多，并且包含很多 jquery，但这是仅显示必要代码的基本问题。我希望能够从一个单独的 .js 文件中调用一个函数，而该函数是在主页中定义的。在这个基本的简单版本中，我尝试删除 $(document).ready(function()... 并在这个简单的示例中有所帮助，但是我在更复杂的页面中需要该行，因为删除它似乎会破坏我所做的一切在。

您会看到“检测到的点击”被调用，但“关闭表单”没有。

你能给我任何指示吗？

谢谢，

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-22T23:56:49.173

你有一个范围问题。您不需要将命名函数包装在`$(document).ready()`.

如果包装在`ready`它的范围内，则由于函数内的封闭，它仅在该准备好的函数内可用。

例子：

```
$(document).ready(function() {
    function doAlert() {
        alert('foo');
    } 
    /* can call function since scope in same parent function*/
    doAlert();
}); 
/* function not in scope, is undefined here*/
doAlert(); 
```

重构所以函数是全局可用的，如果从任何地方调用都可以工作。将在以下两种情况下工作：

```
function doAlert() {
    alert('foo');
}

$(document).ready(function() {
    doAlert();
});
doAlert(); 
```

进一步说明：

许多人担心使用 jQuery 选择器和方法的函数必须包装在`$(document).ready()`. 外部的命名函数`ready`可以包含所有 jQuery 代码......但是......它们需要在 DOM 准备好后调用以确保 html 存在

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:56:29.743

你试过搬家吗

```
<script type="text/javascript" src="myscript.js"></script> 
```

`<body>`在-tag下方？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T23:58:57.530

首先，您需要将脚本标签移动到标签的正上方`</body>`。

其次，如果您只是删除准备好的文档，那应该可以在上面工作。问题是您在闭包含义内定义了您的函数，它超出了范围。您的函数不必在文档中准备好，因为它只会在另一个文档准备就绪时被触发（意味着文档已准备好）。

# actionscript-3 - AS3：在加载外部 swf 时无法在 $iinit 访问空对象引用的属性或方法

> ID：14007583
> 
> 赞同：0
> 
> 时间：2012-12-22T23:54:03.583
> 
> 标签：actionscript-3, load, flash, output

我有两个 swf，分别可以完美运行，但是当我尝试将一个加载到另一个时，它显示“无法在 Creator$iinit 访问空对象引用的属性或方法”。

第一个 SWF 是登录屏幕，第二个是注册屏幕。我以这种方式加载它们：

```
var requestA:URLRequest = new URLRequest("Creator.swf");
var loader:Loader = new Loader();
loader.load(requestA);
addChild(loader); 
```

我不知道出了什么问题。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T01:54:48.413

很可能您正在尝试访问在加载和初始化时无法立即使用的内容 - 您需要在 Creator.swf 中添加一些代码，例如：

```
// Somewhere in the first lines of code 
addEventListener(Event.ADDED_TO_STAGE, this.ready);

function ready(e:Event) {
    removeEventListener(Event.ADDED_TO_STAGE, this.ready);

    // ** Do other initialization stuff here

} 
```

正在发生的事情是，您正试图在事物准备好接受它们之前访问舞台或对象。

# c - 指针、野牛和 yacc

> ID：14007588
> 
> 赞同：2
> 
> 时间：2012-12-22T23:54:47.213
> 
> 标签：c, pointers, bison, yacc

我正在学习 bison/yacc（也正在复习一些 c）并尝试将 json 解析器构建为简单的测试项目。

[使用在http://www.json.org/](http://www.json.org/)上找到的术语，我有一个表示字符串/值对的结构对和一个表示具有成员字段的对象的结构对象，该成员字段基本上包含指向对的链接列表的指针.

我有一个简单的 c 函数（create_pair），它返回一个新的对。我注意到一个我无法解释的奇怪行为：

*   如果我从“main”调用这样的函数并打印返回结构的内存地址，它们的地址总是不同的。
*   如果我在野牛“动作”中调用相同的函数，我会看到我的函数返回一个指针，该指针恰好总是驻留在相同的内存地址上。

这有道理吗？

详细信息/代码如下：

这是代码（链接包含指向“项目”中包含的四个不同文件的 4 个 pastebin 链接的列表）：

*   [http://pastebin.com/k272vVb5](http://pastebin.com/k272vVb5)

你可以编译并运行它：

```
lex t.l
yacc -d t.y
cc y.tab.c lex.yy.c t.c
./a.out 
```

如果您启动代码并使用以下输入运行它：

{“名字”：“A”，“姓氏”：“B”}

你会看到：

1）在“main”中执行的代码（检查文件ty），创建四个不同的对对象，然后我打印它们的内存地址，输出类似于（注意不同的地址）：

```
p 0x7fff52476be8 //(<-memory address for pair p)
print pair: P, Hellov
q 0x7fff52476bc8 //(<-memory address for pair q)
print pair: Q, Hellox 
```

2）只要我粘贴上面的 json 示例，我们就两次点击“pair”规则，第一次是“firstName”：“A”，第二次是“lastName”：“B”，我在两种情况并打印内存地址，它们是相同的：

```
Creating pair 0x7fff52475c88
print pair: firstName, A
Creating pair 0x7fff52475c88
print pair: lastName, B 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:33:37.427

你不应该关心 a 的地址`pair`是什么。这与与他们一起执行的工作无关，您看到的地址是偶然的，没有任何后果。

您的函数`create_pair`不返回指针。它是用 声明的`pair create_pair(…)`，因此它`pair`按值返回 a 。

在`main`中，您定义`pair p = create_pair(l, v);`. 这会创建一个自动对象`p`，通常是通过在堆栈上为其留出空间。然后它调用`create_pair`. 的返回值`create_pair`被复制到`p`. 稍后，当您打印时`&p`，您打印的是 的地址`p`，而不是`create_pair`返回的地址。

同样，当您定义 时`pair q = create_pair(l, x);`，您会创建另一个对象`q`。因为这个对象的生命周期与 的生命周期重叠`p`，所以它们必须在不同的地方，所以它们有不同的地址。当您打印时`&q`，您会看到这个不同的地址。

接下来，考虑您放置在 Bison 规则中的代码，`pair p = create_pair($<u_string>1, $<u_value>3);`. Bison 在处理规则时执行此代码。它创建一个自动对象，然后打印它的地址。然后执行离开了这段代码的范围，Bison 无疑会继续做其他事情，并且退出它当前正在进行的处理。自动对象的生命周期结束，堆栈上的数据被弹出。后来，Bison 又回到了这条规则。那时，仅仅因为计算机是机械操作的，堆栈指针的地址与以前相同。所以，当一个新`p`的被创建时，它恰好和旧的在同一个地方`p`。与`p`和`q`不同，因为它们同时存在，所以它们必须在不同的地方，这个旧的`p`和新的`p`只存在于不同的时间，所以它们可能在同一个地方。

这不一定总是发生。如果你的语法更复杂，Bison 可能一次在堆栈中有其他东西，而不是另一个（或者可能没有；Bison 产生的解析机可能不会那样做；我不知道）。或者，如果您在另一个规则中有相同的代码，则在处理该规则时堆栈可能会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:26:02.783

因此，您看到的是堆栈变量的地址发生了变化。这是完全正常的。如果它们都具有相同的地址，您将得到一个值覆盖另一个值，这不会很有用。

编辑：当你调用一个函数（从同一个调用者函数，例如main）时，堆栈变量的地址总是相同的 - 因为在调用时堆栈开始是相同的[通常 - 当然，有时编译器用堆栈做有趣的事情，所以不能 100% 保证]

Edit2：澄清一下，如果调用是相同的调用链，例如从函数 C 从函数 B 调用函数 A，那么无论在 B 或 C 中的哪个位置进行调用，A 中的堆栈通常都是相同的。当然，如果我们从函数 C 从函数 D 调用函数 A，那么关于 A 中局部变量的地址的所有赌注都将失败[嗯，它很可能非常相似，但是如果函数 D 有一些巨大的局部变量，它可能非常不同]。并且这是典型的警告仍然适用。编译器很可能会留下清理堆栈“直到它有足够的麻烦”，而不是清理每个调用，这意味着对函数 A 的三个调用可能会在堆栈上积累一些“垃圾”，这些“垃圾”不会被清理到后来。

我有点困惑，为什么您认为它应该与此不同？

# ruby-on-rails - 具有多个、可选和漂亮参数的路由

> ID：14007593
> 
> 赞同：3
> 
> 时间：2012-12-22T23:55:54.017
> 
> 标签：ruby-on-rails, routes

我有一种情况，我需要构建漂亮的 url 路径。

我有一个 FilesController 需要处理如下 URL：

```
mydomain.com/files/path/dir1/dir2/user/bob
mydomain.com/files/path/dir1/user/bob
mydomain.com/files/path/dir1
mydomain.com/files/user/bob 
```

在控制器中，我想`params[:path]`包含`/path`和`/user`和`params[:user]`之后的所有内容`/user`（假设只有一个用户并且它是可选的）。

我正在寻找最好的方法来做到这一点，最好只在`routes.rb`文件中使用一条语句。我认为最棘手的部分是，在`/path`可能提供文件的实际路径之后，N 倍深。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T00:19:44.670

你想要[路线通配符](http://guides.rubyonrails.org/routing.html#route-globbing-and-wildcard-segments)：

```
match 'files/*path/user/:user' => 'user#files' 
```

对于没有路径的情况，您可能还需要添加额外的路由：

```
match 'files/user/:user' => 'user#files' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T01:39:49.503

感谢[Chris Heald 的回答](https://stackoverflow.com/a/14007710/373522)，我最终选择了这个，它适合这个场景：

```
match 'files/user/:user' => 'files#index'
match 'files/path/*path/user/:user' => 'files#index'
match 'files/path/*path' => 'files#index' 
```

仍然想知道这是否可以用单线处理。

# testing - Arquillian，（嵌入式）Glassfish 和 JMS：如何测试工人？

> ID：14007600
> 
> 赞同：2
> 
> 时间：2012-12-22T23:56:30.450
> 
> 标签：testing, glassfish, jms, jboss-arquillian

我想使用 arquillian（拥有容器服务）测试我的 glassfish 应用程序中包含的 JMS-worker。我的工人看起来如下：

```
package queue.worker;

import javax.ejb.ActivationConfigProperty;
import javax.ejb.MessageDriven;
import javax.jms.MessageListener;

@MessageDriven(mappedName = "java:app/jms/MailQueue", activationConfig = {
    @ActivationConfigProperty(propertyName = "acknowledgeMode", propertyValue = "Auto-acknowledge"),
    @ActivationConfigProperty(propertyName = "destinationType", propertyValue = "javax.jms.Queue") })
public class MailWorker implements MessageListener {

public MailWorker() {
}

@Override
public void onMessage(javax.jms.Message inMessage) {
}
} 
```

这是测试：

```
package queueTest.worker;

import java.io.File;

import javax.inject.Inject;

import org.jboss.arquillian.container.test.api.Deployment;
import org.jboss.arquillian.junit.Arquillian;
import org.jboss.shrinkwrap.api.ShrinkWrap;
import org.jboss.shrinkwrap.api.spec.WebArchive;
import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;

import queue.worker.MailWorker;

@RunWith(Arquillian.class)
public class MailWorkerTest {

@Deployment
public static WebArchive createDeployment() {
    WebArchive archive = ShrinkWrap
            .create(WebArchive.class)
            .addClasses(MailWorker.class)
            .addAsWebInfResource(new File("src/test/resources/WEB-INF/glassfish-resources.xml"),
                    "glassfish-resources.xml")
            .addAsWebInfResource(new File("src/main/webapp/WEB-INF/beans.xml"), "beans.xml");
    return archive;
}

@Inject
protected MailWorker mailWorker;

@Test
public void sendRegisterMail() {
    Assert.assertTrue(true);
}
} 
```

执行此测试，Glassfish-JSM-Queue 已启动 [1]，但出现以下错误：

org.jboss.weld.exceptions.DeploymentException: WELD-001408 在注入点 [[field] @Inject protected queueTest.worker.MailWorkerTest.mailWorker] 具有限定符 [@Default] 的类型 [MailWorker] 的依赖关系不满足

当我在 Mailworker.class 中删除“@MessageDrivern[...]”并将其替换为“@ApplicationScoped”时，例如，一切正常 - 所以 Arquillian 似乎没有问题，但与 JMS 相关。

如何测试 JMS/Queue-Worker？

[1] Dez 23, 2012 12:42:08 AM com.sun.messaging.jms.ra.ResourceAdapter start 信息：MQJMSRA_RA1101：GlassFish MQ JMS Resource Adapter 启动：broker is EMBEDDED, connection mode is Direct Dez 23, 2012 12:上午 42:10 com.sun.messaging.jms.ra.ResourceAdapter 启动信息：MQJMSRA_RA1101：GlassFish MQ JMS 资源适配器已启动：EMBEDDED

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-05-15T07:25:02.633

测试 MDB 比测试通常的 EJB 和 CDI bean 更难，因为它们是异步执行的。即使您能够将它们注入到您的测试中，您也可以通过同步调用来测试 onMessage() 方法。

我的方法使用 MDB 仅捕获消息并提取底层表示（如字符串或对象）。然后将提取的消息传递给具有测试替代方案的单独 CDI bean。

```
@MessageDriven(mappedName = "jms/queue/example", activationConfig = {
        @ActivationConfigProperty(propertyName = "destinationType", 
                propertyValue = "javax.jms.Queue"),
        @ActivationConfigProperty(propertyName = "destination", 
                propertyValue = "jms/queue/example")
})
public class ExampleMDB implements MessageListener {

    @Inject
    private ExampleMessageHandler exampleMessageHandler;

    @Override
    public void onMessage(Message message) {
        if (message instanceof TextMessage) {
            TextMessage textMessage = (TextMessage) message;
            try {
                exampleMessageHandler.doSomething(textMessage.getText());
            } catch (JMSException e) {
                throw new RuntimeException("That was unexpected!", e);
            }
        }
    }
} 
```

ExampleMessageHandler 定义了 doSomething(String text)。

对于测试范围，我们需要一个实现来捕获传递给 doSomething() 的参数并使测试类可以访问它们。您可以使用以下实现对此进行归档：

```
@Alternative
@ApplicationScoped
public class ExampleMessageHandlerTestable implements ExampleMessageHandler {

    private BlockingQueue<String> queue = new LinkedBlockingQueue<String>();

    public void doSomething(String text) {
        queue.add(text);
    }

    public String poll(int secondsUntilInterrupt) throws InterruptedException {
        return queue.poll(secondsUntilInterrupt, TimeUnit.SECONDS);
    }

} 
```

这是生产代码使用的实际实现的 CDI 替代方案。现在让 Arquillian 测试使用这个替代方案。这是测试类：

```
@RunWith(Arquillian.class)
public class ExampleMDBGoodTest {

    @Resource(mappedName = "ConnectionFactory", name = "ConnectionFactory")
    private ConnectionFactory connectionFactory;

    @Resource(mappedName = "jms/queue/example", name = "jms/queue/example")
    private Queue queue;

    @Inject
    private ExampleMessageHandler exampleMessageHandler;

    @Deployment
    public static WebArchive createDeployment() {
        WebArchive archive = ShrinkWrap.create(WebArchive.class, "exampleMDB.war")
                .addPackages(true, ExampleMDB.class.getPackage())
                .addAsWebInfResource("hornetq-jms.xml", "hornetq-jms.xml")
                .addAsWebInfResource("beans-alternative.xml", "beans.xml");
        System.out.println(archive.toString(true));
        return archive;
    }

    @Test
    public void testOnMessage() throws Exception {
        Connection connection = connectionFactory.createConnection();
        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
        MessageProducer producer = session.createProducer(queue);

        TextMessage textMessage = session.createTextMessage("Hello world!");
        producer.send(textMessage);
        session.close();
        connection.close();

        // We cast to our configured handler defined in beans.xml
        ExampleMessageHandlerTestable testHandler = 
                (ExampleMessageHandlerTestable) exampleMessageHandler;
        assertThat(testHandler.poll(10), is("Hello world!"));
    }

} 
```

一些解释这里发生了什么：测试请求一个 JMS ConnectionFactory 和 MDB 侦听的队列。这些创建了被测试的 MDB 使用的 JMS 消息。然后我们创建一个测试部署。hornetq-jms.xml 为测试定义了一个临时队列。通过包含 beans-alternative.xml，我们确保 MDB 使用我们的测试替代方案。

```
<beans xmlns="http://java.sun.com/xml/ns/javaee" 
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="
http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/beans_1_0.xsd">

    <alternatives>
        <class>com.github.mcs.arquillian.mdb.example.ExampleMessageHandlerTestable</class>
    </alternatives>

</beans> 
```

测试用例本身应该是直截了当的。一条新的 JMS 消息被发送到队列。然后，我们在测试备选方案中等待最多 10 秒的新消息。通过使用阻塞队列，我们​​可以定义测试失败的超时时间。但是，只要 MDB 调用替代 bean，测试本身就会立即完成。

我已经上传了一个小型[Maven 示例项目](https://github.com/mcs/arquillian-jms-mdb)，我从中复制了上述代码部分。因为我对 Glassfish 不太了解，所以它使用 JBoss 作为托管容器。根据您可能使用的 JBoss 版本，您需要更改 jboss-as-arquillian-container-managed 的​​版本。

希望对某人有所帮助:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T12:14:04.793

MDB 没有资格注入到其他类中。您不能将它们注入到您的测试用例中。

# ios - 无论方向如何，有什么方法可以让 UIToolbar 始终位于设备的物理顶部？

> ID：14007604
> 
> 赞同：0
> 
> 时间：2012-12-22T23:56:53.120
> 
> 标签：ios, uiviewcontroller, orientation, constraints, uitoolbar

我正在尝试为我的图形应用程序优化屏幕空间，并且我想支持所有方向，但如果我可以将 UIToolbar 留在 iPhone 或 iPad 的物理顶部（通过相机），那就太好了，并且拥有应用程序的其余部分和视图正确处理方向。当我得到一个方向事件时，我会旋转工具栏上的图标，但我希望工具栏和只有工具栏保持不变。

我想使用约束，但不知道如何做到这一点。

任何人？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:11:54.583

约束无法做到这一点，因为它们会将工具栏限制在其超级视图的顶部，而不是设备的顶部，因此如果该超级视图旋转，您的工具栏也会旋转。我认为您可能必须通过使用包含工具栏的非旋转视图控制器来执行此操作，然后只需旋转包含您的图形的子视图。

# google-app-engine - Play Framework 的 Siena 模块在绑定到 Google App Engine 上 Cloud SQL 中的 @Text 字段时出错

> ID：14007606
> 
> 赞同：2
> 
> 时间：2012-12-22T23:57:11.957
> 
> 标签：google-app-engine, playframework, google-cloud-sql, siena

我正在尝试重写 Play！框架的[YABE 教程](http://www.playframework.org/documentation/1.2.5/guide1)，以便它可以使用 Siena 模块在 Google App Engine 上运行。我正在使用以下版本的播放和模块：

*   玩 1.2.5
*   克鲁兹耶纳 2.0.3
*   锡耶纳 2.0.7
*   gae 1.6.0

我已成功设置应用程序，连接到数据库并能够将数据存储/检索到数据库。但是，我遇到了 Siena 模块提供的 @Text 注释的问题。它使用 Post.content 和 Comment.content 数据字段的 MediumText 数据类型正确创建数据库。下面是从 GAE 日志生成的 DDL：

```
# ----------------------------------------------------------------------- 
# Comment 
# ----------------------------------------------------------------------- 

CREATE TABLE Comment
(
    id VARCHAR(255) NOT NULL,
    author VARCHAR(255) NULL,
    postedAt DATETIME,
    content MEDIUMTEXT NULL,
    post VARCHAR(255) NULL,
    PRIMARY KEY (id)
);

# ----------------------------------------------------------------------- 
# User 
# ----------------------------------------------------------------------- 

CREATE TABLE User
(
    id VARCHAR(255) NOT NULL,
    email VARCHAR(255) NULL,
    password VARCHAR(255) NULL,
    fullname VARCHAR(255) NULL,
    isAdmin TINYINT(1) DEFAULT false NOT NULL,
    PRIMARY KEY (id)
);

# ----------------------------------------------------------------------- 
# Tag 
# ----------------------------------------------------------------------- 

CREATE TABLE Tag
(
    id VARCHAR(255) NOT NULL,
    name VARCHAR(255) NULL,
    PRIMARY KEY (id)
);

# ----------------------------------------------------------------------- 
# Post 
# ----------------------------------------------------------------------- 

CREATE TABLE Post
(
    id VARCHAR(255) NOT NULL,
    title VARCHAR(255) NULL,
    postedAt DATETIME,
    content MEDIUMTEXT NULL,
    author VARCHAR(255) NULL,
    PRIMARY KEY (id)
); 
```

我已经用 @Text 注释对我的 Post.content 字段进行了注释，因为我[在一些要使用的板上看到了 Pascal 评论](http://osdir.com/ml/play-framework/2011-07/msg00525.html)。我在下面发布了我的 Post 类以供参考：

```
package models;

import ...

public class Post extends Model {
    ...

    @Text
    @Required
    @MaxSize(10000)
    public String content;

    ...
} 
```

正如我所提到的，一切都部署得很好，但是当我尝试将帖子保存到数据库时，我收到了以下堆栈跟踪：

```
play.Logger niceThrowable: 

@6cm6cpabp
Internal Server Error (500)

Execution exception (In /app/controllers/Application.java around line 28)
RuntimeException occured : Cannot load fixture initial-data.yml: Unexpected Error

play.exceptions.JavaExecutionException: Cannot load fixture initial-data.yml: Unexpected Error
    at play.mvc.ActionInvoker.invoke(ActionInvoker.java:237)
    at play.server.ServletWrapper$ServletInvocation.execute(ServletWrapper.java:561)
    at play.Invoker$Invocation.run(Invoker.java:278)
    at play.server.ServletWrapper$ServletInvocation.run(ServletWrapper.java:552)
    at play.Invoker.invokeInThread(Invoker.java:68)
    at play.server.ServletWrapper.service(ServletWrapper.java:143)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.apphosting.utils.servlet.ParseBlobUploadFilter.doFilter(ParseBlobUploadFilter.java:102)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.runtime.jetty.SaveSessionFilter.doFilter(SaveSessionFilter.java:35)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.handle(AppVersionHandlerMap.java:266)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
    at com.google.apphosting.runtime.jetty.RpcRequestParser.parseAvailable(RpcRequestParser.java:76)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at com.google.apphosting.runtime.jetty.JettyServletEngineAdapter.serviceRequest(JettyServletEngineAdapter.java:146)
    at com.google.apphosting.runtime.JavaRuntime$RequestRunnable.run(JavaRuntime.java:447)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at com.google.apphosting.runtime.ThreadGroupPool$PoolEntry.run(ThreadGroupPool.java:251)
    at java.lang.Thread.run(Thread.java:679)
Caused by: java.lang.RuntimeException: Cannot load fixture initial-data.yml: Unexpected Error
    at play.modules.siena.SienaFixtures.loadModels(SienaFixtures.java:273)
    at controllers.Application.index(Application.java:28)
    at play.mvc.ActionInvoker.invokeWithContinuation(ActionInvoker.java:557)
    at play.mvc.ActionInvoker.invoke(ActionInvoker.java:508)
    at play.mvc.ActionInvoker.invokeControllerMethod(ActionInvoker.java:484)
    at play.mvc.ActionInvoker.invokeControllerMethod(ActionInvoker.java:479)
    at play.mvc.ActionInvoker.invoke(ActionInvoker.java:161)
    at play.server.ServletWrapper$ServletInvocation.execute(ServletWrapper.java:561)
    at play.Invoker$Invocation.run(Invoker.java:278)
    at play.server.ServletWrapper$ServletInvocation.run(ServletWrapper.java:552)
    at play.Invoker.invokeInThread(Invoker.java:68)
    at play.server.ServletWrapper.service(ServletWrapper.java:143)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    ... 1 more
Caused by: play.exceptions.UnexpectedException: Unexpected Error
    at play.modules.siena.SienaModelUtils.edit(SienaModelUtils.java:301)
    at play.modules.siena.SienaModelUtils.create(SienaModelUtils.java:58)
    at play.modules.siena.SienaPlugin.bind(SienaPlugin.java:331)
    at play.PlayPlugin.bind(PlayPlugin.java:68)
    at play.plugins.PluginCollection.bind(PluginCollection.java:579)
    at play.data.binding.Binder.bind(Binder.java:112)
    at play.data.binding.Binder.bind(Binder.java:92)
    at play.data.binding.Binder.bind(Binder.java:88)
    at play.modules.siena.SienaFixtures.loadModels(SienaFixtures.java:207)
    ... 34 more
Caused by: siena.SienaException: java.lang.IllegalArgumentException: Can not set java.lang.String field models.Post.content to com.google.cloud.sql.jdbc.internal.ClientSideClob
    at siena.Util.setField(Util.java:286)
    at siena.jdbc.JdbcMappingUtils.setFromObject(JdbcMappingUtils.java:205)
    at siena.jdbc.JdbcMappingUtils.mapField(JdbcMappingUtils.java:186)
    at siena.jdbc.JdbcMappingUtils.mapObject(JdbcMappingUtils.java:79)
    at siena.jdbc.JdbcMappingUtils.mapObject(JdbcMappingUtils.java:67)
    at siena.jdbc.JdbcMappingUtils.mapList(JdbcMappingUtils.java:92)
    at siena.jdbc.JdbcPersistenceManager.doFetch(JdbcPersistenceManager.java:636)
    at siena.jdbc.JdbcPersistenceManager.fetch(JdbcPersistenceManager.java:728)
    at siena.AbstractPersistenceManager.get(AbstractPersistenceManager.java:71)
    at siena.BaseQuery.get(BaseQuery.java:111)
    at play.modules.siena.SienaModelUtils.edit(SienaModelUtils.java:227)
    ... 42 more
Caused by: java.lang.IllegalArgumentException: Can not set java.lang.String field models.Post.content to com.google.cloud.sql.jdbc.internal.ClientSideClob
    at siena.Util.setField(Util.java:284)
    ... 52 more 
```

本质上，尝试将内容字段从 String 映射到 Google ClientSideClob 类是令人窒息的。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T16:08:24.263

事实证明，这个问题不是在插入数据期间发生的，而是在从数据库中读取数据时发生的。它已[在 github 上的当前 siena master 分支中](http://github.com/mandubian/siena)修复。我克隆了那个 repo，从那个代码库构建了 siena jar，将它从目标目录复制到了 siena 模块 lib 目录。

```
cp ~/projects/siena/source/target/siena-1.0.0-b6.jar modules/siena-2.0.7/lib/ 
```

重新部署并修复了 Google Cloud SQL 中 String 和 mediumtext 字段之间的映射错误。

# iphone - 为 UIButton 设置动画可防止它引起转场

> ID：14007608
> 
> 赞同：1
> 
> 时间：2012-12-22T23:57:54.467
> 
> 标签：iphone, ios, uibutton, uiviewanimation, touch-event

在我的故事板中，我有一个触发模态转场的按钮。当它不触发任何移动它的动画时，它会按预期工作。但是，当它*确实*触发了移动它的动画时，它不会触发 segue。

附加信息：

*   当用户点击`view`按钮的直接超级视图时触发动画
*   动画与键盘事件一起完成，因此`view`“跟随”键盘。转场是通过故事板创建的
*   我也用这个`[UIView beginAnimations:context:]`方法试了一下，还是不行。

代码：

```
[[NSNotificationCenter defaultCenter] addObserverForName:UIKeyboardWillHideNotification object:nil queue:nil usingBlock:^(NSNotification *notification){
    CGRect keyboardFrame = [notification.userInfo[UIKeyboardFrameBeginUserInfoKey] CGRectValue];
    CGRect newFrame = view.frame;
    //newFrame.origin.y += offset > keyboardFrame.size.height  ?  keyboardFrame.size.height  :  keyboardFrame.size.height - offset;
    UIView animateWithDuration:.25 delay:0 options:(UIViewAnimationCurveLinear | UIViewAnimationOptionAllowUserInteraction) animations:^{
        view.frame = newFrame;
    }completion:nil];
}]; 
```

# html - 更改输入标签上的“提交”文本

> ID：14007613
> 
> 赞同：125
> 
> 时间：2012-12-22T23:59:29.080
> 
> 标签：html

我有一个标签，`<input type="submit" class="like"/>`。我想让按钮内的文字说“喜欢”，但现在，它说“提交”。

`class="like"`顺便说一下，是按钮的 CSS。

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2012-12-23T00:00:40.957

-type元素的`value`属性控制显示的文本。`submit``<input>`

```
<input type="submit" class="like" value="Like" /> 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-12-23T00:00:59.643

该`value`属性用于确定提交输入的呈现标签。

```
<input type="submit" class="like" value="Like" /> 
```

请注意，如果控件成功（这不会是因为它没有`name`），这也将是它的提交值。

要获得不同的提交值和标签，您需要使用按钮元素，其中元素内的 textNode 确定标签。您可以包含其他元素（包括`<img>`此处）。

```
<button type="submit" class="like" name="foo" value="bar">Like</button> 
```

`<button>`请注意，在旧版本的 Internet Explorer 中对 的支持是不可靠的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T00:01:42.960

```
<input name="submitBnt" type="submit" value="like"/> 
```

`$_POST`在 php 和 javascript 中使用时 name 很有用as `document.getElementByName('submitBnt')`。您也可以将 name 用作 CS 选择器，例如`input[name="submitBnt"]`; 希望这可以帮助

# javascript - document.getElementById("remember").visibility = "hidden"; 不在复选框上工作

> ID：14007629
> 
> 赞同：17
> 
> 时间：2012-12-23T00:01:52.600
> 
> 标签：javascript, visibility

我无法使`visibility`or`display`属性正常工作。

这是 HTML 页脚：

```
<div id="footer">
  &copy; 
  <strong id="foot" onmouseover="showData();" onmouseout = "hideData()">
    Exquisite Taste 2012
  </strong>
  <input type='checkbox' id="remember" onclick='editCookie()' style="visibility:hidden;" />
</div> 
```

这是可见性部分不起作用的 .js 函数：

```
function showData()
{

  document.getElementById("remember").visiblity="visible";

  document.getElementById("foot").innerHTML = getDate() + "  " + getTime();

  if(cookieValue())
  {
    document.getElementById("remember").checked = true;
  }
} 
```

那一行似乎没有做任何事情：

```
document.getElementById("remember").visiblity="visible"; 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-12-23T00:02:49.190

您的代码中有两个问题：

*   该属性被称为`visibility`而不是`visiblity`。
*   它不是元素本身的属性，而是元素的`.style`属性。

这很容易修复。简单替换这个：

```
document.getElementById("remember").visiblity 
```

有了这个：

```
document.getElementById("remember").style.visibility 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-23T00:02:25.323

这是`style`财产的工作：

```
document.getElementById("remember").style.visibility = "visible"; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-05-27T10:08:12.723

您可以使用

```
style="display:none" 
```

前任：

```
<asp:TextBox ID="txbProv" runat="server" style="display:none"></asp:TextBox> 
```

# git - 推送到 Github 是不可能的

> ID：14007630
> 
> 赞同：3
> 
> 时间：2012-12-23T00:01:55.040
> 
> 标签：git, github, push

我最近在 Github 上创建了我的第一个 gi 存储库，我仔细使用[http://git-scm.com/documentation](http://git-scm.com/documentation)克隆它没有问题。我发现互联网上没有人有同样的问题。我尝试了 2 个不同版本的 Git：首先是 1.7.9.5（来自 apt-get），然后是 1.8.1-rc2（来自源代码），但最后又回到了 1.7.9.5（来自 apt-get）。我尝试了 HTTP 和 SSH（使用[https://help.github.com/articles/generating-ssh-keys](https://help.github.com/articles/generating-ssh-keys)）

通过 HTTPS (git 1.7.9.5) 使用推送时我得到了什么：

```
**$ git push https://github.com/Vulpo/PR3003-2012.git master**
WARNING: gnome-keyring:: couldn't connect to: /tmp/keyring-lsOUEX/pkcs11: No such file or directory
Username for 'https://github.com': Vulpo
Password for 'https://Vulpo@github.com': 
error: RPC failed; result=56, HTTP code = 0
fatal: The remote end hung up unexpectedly
fatal: The remote end hung up unexpectedly
Everything up-to-date 
```

并使用 SSH (git 1.7.9.5)：

```
**$ git push git@github.com:Vulpo/myproject.git master**
Enter passphrase for key '/home/Vulpo/.ssh/id_rsa': 
Counting objects: 19, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (18/18), done.
Writing objects: 100% (18/18), 735.94 KiB, done.
Total 18 (delta 4), reused 0 (delta 0)
Write failed: Connection timed out
Write failed: Broken pipe
fatal: The remote end hung up unexpectedly 
```

使用 HTTPS (git 1.8.1-rc2)：

```
**$ git push origin master**
Username for 'https://github.com': Vulpo
Password for 'https://Vulpo@github.com': 
Counting objects: 21, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (19/19), done.
Writing objects: 100% (19/19), 736.04 KiB, done.
Total 19 (delta 5), reused 0 (delta 0)
error: RPC failed; result=55, HTTP code = 0
fatal: The remote end hung up unexpectedly
fatal: recursion detected in die handler
Everything up-to-date 
```

使用 SHH (git 1.8.1-rc2)：

```
**$ git push git@github.com:Vulpo/myproject.git master**
Enter passphrase for key '/home/renardc/.ssh/id_rsa': 
Counting objects: 21, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (19/19), done.
Writing objects: 100% (19/19), 736.04 KiB, done.
Total 19 (delta 5), reused 0 (delta 0)
Write failed: Broken pipe
fatal: The remote end hung up unexpectedly
fatal: recursion detected in die handler 
```

这是我的**git config -l**：

```
user.name=Vulpo
user.email=vulpo@my.mail
core.autocrlf=input
core.safecrlf=true
core.editor=vim
merge.tool=vimdiff
http.postbuffer=524288000
core.repositoryformatversion=0
core.filemode=false
core.bare=false
core.logallrefupdates=true
remote.origin.fetch=+refs/heads/*:refs/remotes/origin/*
remote.origin.url=https://github.com/Vulpo/myproject.git
branch.master.remote=origin
branch.master.merge=refs/heads/master 
```

网络上似乎没有人以前遇到过这个问题。有人有想法吗？

我后来尝试了（即使我确定这不是因为任何 github 维护），它也没有工作。我可以推送一个非常轻的文件，但不是我真正想要上传的文件（2.3MBytes）。

编辑：它使用我兄弟的电脑工作！（Git 1.8.0.? 在 Windows 上）。但这并不能解决我的问题。至少，它表明问题来自我自己的配置。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-23T00:14:06.877

好吧，看看这个小家伙有什么要说的。

![Github](../Images/3de74626f757af671c9ec94ba0ccf7a4.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T00:27:42.633

GitHub 已关闭。请参阅此站点以查看其服务器状态。 [https://status.github.com/](https://status.github.com/)

# java - 爪哇。string.replaceFirst() 的奇怪行为

> ID：14007634
> 
> 赞同：0
> 
> 时间：2012-12-23T00:02:37.630
> 
> 标签：java, string

我有一个“余额”字符串，前面有一个美元符号。我想修改这个标志，所以我可以将刺痛转换为双倍，但我的代码不起作用。

这是我尝试过的：

```
String balance = "$5.30";
balance = balance.replaceFirst("$", ""); 
```

看起来代码没有任何区别。更奇怪的是，下面的代码正是我所需要的：

```
String balance = "$5.30";
balance = balance.replaceFirst(".", ""); 
```

尽管我可以只使用第二个代码，但我想了解它为什么会导致这个结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-23T00:03:32.317

`$`并且`.`是 Java 正则表达式世界中的特殊字符（元字符），您应该使用反斜杠对其进行转义，以便将其视为普通字符。

```
String balance = "$5.30";
balance = balance.replaceFirst("\\$", "");

String balance = "$5.30";
balance = balance.replaceFirst("\\.", ""); 
```

因此 ：

```
 String balance = "$5.30";
      balance = balance.replaceFirst("\\.", "").replaceFirst("\\$", "");
      System.out.println(balance); 
```

输出：530

只是想在正则表达式中添加更多关于`$`和`.`含义的解释：

1.  `$`用于检查行尾是否跟随
2.  `.`用于匹配任何符号

here's a tutorial for [Regex in java](http://docs.oracle.com/javase/tutorial/essential/regex/literals.html)

# javascript - 与 prefixfree 结合使用时，live.js 不会重新加载 css

> ID：14007639
> 
> 赞同：2
> 
> 时间：2012-12-23T00:03:13.083
> 
> 标签：javascript, html, css, page-refresh, vendor-prefix

我正在编写一个简单的 HTML 页面，并在页面更改时使用[live.js](http://livejs.com/)进行页面和 css 重新加载。但是当我在页面中包含[-prefix-free](http://leaverou.github.com/prefixfree/)时，样式不再自动重新加载。

有没有什么办法解决这一问题？

例子：

**HTML**：

```
<!DOCTYPE html>
<link rel="stylesheet" type="text/css" href="style.css">
<script src="prefixfree.min.js" type="text/javascript"></script>
<script src="live.js" type="text/javascript"></script>
<div id="colored">
   some text
</div> 
```

**CSS**：

```
#colored {
  background: blue;
} 
```

我所做的是改变颜色。它一直有效，直到包含 prefixfree。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-10T09:02:26.027

我基于 yukulélé 代码制作了一个支持无前缀的 LiveJS 分支：P

[https://github.com/newhope/live.js](https://github.com/newhope/live.js)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-05T11:22:44.800

我做了一个支持无前缀的[CSSrefresh分支：](http://cssrefresh.frebsite.nl/)

[https://github.com/yukulele/CSSrefresh](https://github.com/yukulele/CSSrefresh)

# php - 我无法让我的 jquery ajax 帖子连接到我的 php 页面

> ID：14007646
> 
> 赞同：3
> 
> 时间：2012-12-23T00:05:54.103
> 
> 标签：php, jquery, html, ajax

```
php
<?php

include 'connection.php';
echo "reached page";
$stmt = $conn->prepare("INSERT INTO flagged ( ID,URL,COUNT,comment)VALUES ( :id,    :url, :count,:COMMENT )"); 
$stmt->bindParam(':id', $id);
$stmt->bindParam(':url', $url);
$stmt->bindParam(':count', $count);
$stmt->bindParam(':COMMENT', $comment);

$id = NULL;
$url = $_POST['url']);
$count = 1;
$comment = $_POST['data']);
$stmt->execute();

?> 
```

jQuery

```
$(document).ready(function() {
$('#flagForm').submit(function(){
return false;
});
$('#flag').click(function(){
    $('#comment').show();
});
$('body').on('click', '#commentSubmit', function(e) {
    $.post('flag.php',
    {
        data:$('#comment').val(),
        url:(window.location)
    },
    function(response){
        alert(response);
    });
});
}); 
```

html

```
<div id='comment'><h1 ></h1>
    <form id="flagForm" action="flag.php" method="post">
    <textarea id='commentData' placeholder='whats the problem' ></textarea>
    <input type="submit" id='commentSubmit' />
</form>
</div> 
```

我似乎无法让我的帖子到达我的 php 页面。我以前从未遇到过这个问题。对象是用户标记页面。我有另一个发布方法和 php 页面使用相同的连接，所以不可能。任何帮助，将不胜感激。jquery 和 html 还有更多内容，但这就是与问题相关的全部内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:10:47.077

`#comment`是一个 div，你必须`.val()`用数据调用输入/文本区域

```
data:$('#commentData').val(), 
```

我看到你在这里`url:(window.location)`使用了一个非法调用错误`window.location.href`。

`window.location`是 jQuery 无法序列化的对象，因此您会收到该错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T00:14:46.427

你的 PHP 代码有点乱。而不是这个：

```
include 'connection.php';
echo "reached page";
$stmt = $conn->prepare("INSERT INTO flagged ( ID,URL,COUNT,comment)VALUES ( :id,    :url, :count,:COMMENT )"); 
$stmt->bindParam(':id', $id);
$stmt->bindParam(':url', $url);
$stmt->bindParam(':count', $count);
$stmt->bindParam(':COMMENT', $comment);

$id = NULL;
$url = $_POST['url']);
$count = 1;
$comment = $_POST['data']);
$stmt->execute(); 
```

你应该这样做：

```
include 'connection.php';

echo "reached page";

$id = NULL;
$url = $_POST['url']);
$count = 1;
$comment = $_POST['data']);

$stmt = $conn->prepare("INSERT INTO flagged ( ID,URL,COUNT,comment)VALUES ( :id,    :url, :count,:COMMENT )"); 
$stmt->bindParam(':id', $id);
$stmt->bindParam(':url', $url);
$stmt->bindParam(':count', $count);
$stmt->bindParam(':COMMENT', $comment);

$stmt->execute(); 
```

当然，您也不应该将用户输入直接插入数据库，但我认为这不是一个真正的应用程序......

# eclipse - Eclipse JVM 版本问题：System.getProperty("sun.arch.data.model") 返回 32 位但我想要 64

> ID：14007649
> 
> 赞同：2
> 
> 时间：2012-12-23T00:06:36.463
> 
> 标签：eclipse, jvm

如果我运行“java -version”它返回 64 位，我猜这意味着我的默认 JVM 是 64 位？但 Eclipse 使用 32 位，因为 System.getProperty("sun.arch.data.model") 返回“32”。

我无法在 32 位模式下使用我需要的库，自动检测我的平台并错误地尝试加载 32 位 dll 的 jogl。在我的其他问题中查看更多信息：[https ://stackoverflow.com/questions/14007335/eclipsejogl-issue-cant-load-amd-64-bit-dll-on-a-ia-32-bit-platform](https://stackoverflow.com/questions/14007335/eclipsejogl-issue-cant-load-amd-64-bit-dll-on-a-ia-32-bit-platform)

我正在运行 64 位 windows 7、eclipse、java 和 JDK。甚至尝试卸载 Jre 32 位无济于事。

其他人有类似问题但没有给出解决方案：[How to reconfigure eclipse to use a 64 bit JVM](https://stackoverflow.com/questions/8991595/how-to-reconfigure-eclipse-to-use-a-64-bit-jvm)

谁能告诉我如何指定正确的jvm？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:36:41.323

该“技巧”只是 eclipse 的普通配置文件，它用于指定用户想要采用的 VM 的完整路径。

标准 JVM 还提供了`-d64`试图强制采用 64 位内存模型的方法。

如果你想让你的环境尽可能地与那里的库兼容，你应该保留 32 位版本，我这么说是因为我对 java 的经验，而且 32 位版本可能比 32 位版本更稳定64 位版本，尤其是在与外部库交互时（再次以我的经验）。

无论如何请记住，您需要 64 位版本的 Eclipse，否则您将无处可去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:33:00.253

您应该安装 64 位版本的 Eclipse。或者您可以编辑 Eclipse.ini 文件，并更改它用于 java.exe 或 javaw.exe 的路径以启动 eclipse 以指向您的 64 位版本。还要让 Eclipse.ini 选择正确的 JAVA_HOME 环境变量，这可能是在 Windows 中设置的任何值。

Eclipse 有它使用的环境变量，但它从 Windows 中提取了大部分环境变量。如果您在 Windows 中更改了这些值，则需要重新启动 Eclipse 以获取新值。我认为每当您安装新版本时，Java 都会更改 JAVA_HOME 变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T00:51:45.723

也许你可以告诉 eclipse 你在哪里拥有 JDK。

Eidt eclipse 主目录中的 eclipse.ini：

```
-vm
/path/to/jdk64/bin/javaw.exe 
```

* * *

如果你想用 jdk 7 在 eclipse 中编译一个项目，[点击这里](https://stackoverflow.com/questions/7054789/eclipse-and-jdk-7)。

# java - 如何设置所需的位置滚动窗格？

> ID：14007654
> 
> 赞同：0
> 
> 时间：2012-12-23T00:07:44.183
> 
> 标签：java, javafx-2, javafx

`Method sp.setVvalue(app.spvalue.intValue());`不会将 vbox 滚动到所需位置。

```
 mvPane = new VBox();
            mvPane.setStyle("-fx-background-color: #fff;");
            GetPlayList(app,root);

            sp = new ScrollPane();
            sp.setVbarPolicy(ScrollPane.ScrollBarPolicy.AS_NEEDED);
            sp.setContent(mvPane);
            sp.setVvalue(40);
            setCenter(sp);
            sp.getVvalue(); 
```

函数 GetPlayList 添加了许多标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T22:56:32.403

如果您在谈论 JavaFX 2.0 及其 scrollPane，那么 Hvalue 和 Vvalue 属性运行良好，但是看起来它们的值是 [0.0 .. 1.0] 范围内的两倍，因此，当您设置 int 值时，它不能正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T20:28:59.260

这可能是你的问题——我注意到如果你在做`yourScrollPane.setVvalue()`之前尝试做`yourStage.show()`，它不会滚动。但是，如果在舞台已经显示*后*`sp.setVvalue()`执行，它将起作用。不确定这是 ScrollPane 中的错误还是预期行为。希望有帮助。

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-20T18:00:40.400

在这种情况下，问题肯定是数字 40，因为只允许 0 和 1 之间的值。然而，由于不同的原因遇到同样的问题时偶然发现了这个问题。发现 setHvalue() 和 setVvalue 仅在 JFX 线程（又名 Platform.runlater）上执行很重要。否则，在用户驱动的滚动事件启动之前，位置不会明显更新！*

# css - 删除某些输入上 IE10 的“清除字段”X 按钮？

> ID：14007655
> 
> 赞同：774
> 
> 时间：2012-12-23T00:07:48.787
> 
> 标签：css, internet-explorer-10

可以肯定的是，这是一个有用的功能，但是有什么方法可以禁用它吗？
例如，如果表单是单个文本字段并且旁边已经有一个“清除”按钮，那么再有 X 也是多余的。在这种情况下，最好将其删除。

可以做到吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：1303
> 
> 时间：2012-12-23T00:50:33.600

设置盒子的[`::-ms-clear`伪元素](http://msdn.microsoft.com/en-us/library/windows/apps/hh465740.aspx)样式：

```
.someinput::-ms-clear {
    display: none;
} 
```

* * *

## 回答 #2

> 赞同：275
> 
> 时间：2013-02-06T21:25:04.890

我发现最好将`width`and设置`height`为`0px`. 否则，IE10 会忽略该字段上定义的填充`padding-right`——这是为了防止文本键入我覆盖在输入字段上的“X”图标。我猜 IE10 在内部将`padding-right`输入的 应用于`::--ms-clear`伪元素，隐藏伪元素不会将`padding-right`值恢复到`input`.

这对我来说效果更好：

```
.someinput::-ms-clear {
  width : 0;
  height: 0;
} 
```

* * *

## 回答 #3

> 赞同：114
> 
> 时间：2013-08-16T10:00:46.810

我会将此规则应用于文本类型的所有输入字段，因此以后不需要复制：

```
input[type=text]::-ms-clear { display: none; } 
```

甚至可以通过仅使用以下内容变得不那么具体：

```
::-ms-clear { display: none; } 
```

我什至在添加这个答案之前就使用了后者，但认为大多数人更愿意比这更具体。两种解决方案都可以正常工作。

* * *

## 回答 #4

> 赞同：76
> 
> 时间：2014-02-19T01:54:52.537

`::-ms-clear`您应该为( [http://msdn.microsoft.com/en-us/library/windows/apps/hh465740.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465740.aspx) )设置样式：

```
::-ms-clear {
   display: none;
} 
```

`::-ms-reveal`您还可以为密码字段设置伪元素样式：

```
::-ms-reveal {
   display: none;
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-08-02T16:40:07.977

我认为值得注意的是，当页面以兼容模式运行时，所有基于样式和 CSS 的解决方案都不起作用。兼容模式渲染器会忽略 ::-ms-clear 元素，即使浏览器显示 x。

如果您的页面需要在兼容模式下运行，您可能会被 X 显示卡住。

就我而言，我正在使用一些第三方数据绑定控件，我们的解决方案是处理“onchange”事件并在使用 x 按钮清除字段时清除后备存储。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-04T15:40:28.637

要隐藏箭头并在“时间”输入中交叉：

```
#inputId::-webkit-outer-spin-button,
#inputId::-webkit-inner-spin-button,
#inputId::-webkit-clear-button{
    -webkit-appearance: none;
    margin: 0;
} 
```

# objective-c - 如何检索 iTunes 上“Up Next”列表中的曲目

> ID：14007657
> 
> 赞同：2
> 
> 时间：2012-12-23T00:08:20.147
> 
> 标签：objective-c, xcode, macos, cocoa, itunes

我想检索 iTunes 上“Up Next”列表中曲目的名称或 ID。我一直在寻找`iTunes.h`文件，但找不到任何可以执行我想做的事情。
有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:38:10.957

看看这个相关的问题： [Use iTunes' Up Next function with an API](https://stackoverflow.com/questions/13659626/use-itunes-up-next-function-with-an-api)

事实是没有办法。

如果没有复杂且错误的解决方法，您根本无法从 Up Next 中获取歌曲。如果您想尝试，请查找 UI 脚本。Apple 没有在他们的 API 中提供任何有用的东西，老实说，我认为他们永远不会提供。

# php - jQuery JSONP 调用 PHP 后端：没有 HTTP 响应

> ID：14007660
> 
> 赞同：1
> 
> 时间：2012-12-23T00:09:44.460
> 
> 标签：php, jquery, ajax, jsonp

**更新 IV / 当前状态：**我现在通过另一个问题确认文件的字符编码很好，而不是问题的原因。我还针对另一台服务器进行了测试，但错误仍然存​​在。但是，它确实适用于本地主机。 *总结一下：* JSONP 调用适用于 localhost，但是当针对外部域运行时，来自服务器的响应是空的（没有标头/没有 http 响应代码）。复制请求的 URL 并将其直接插入浏览器时，输出正确且格式正确（utf-8 / json）。

**小提琴：http:** [//jsfiddle.net/5SJvp/1/](http://jsfiddle.net/5SJvp/1/)

**更新三：**我现在可以让它在 localhost 上成功运行。但是，对我的生产域使用完全相同的代码（客户端和服务器）仍然失败。服务器的响应是“空的”，意思是说它没有返回 http 状态码。

**更新二：**经过更多调试后，我注意到响应不包含 http 状态代码。这可能是我的问题的原因？我认为这意味着服务器端出了点问题，但我一辈子都看不到在哪里。

**更新 I：**从 jQuery 中截取请求的位置似乎停止了。

```
// Do send the request
// This may raise an exception which is actually
// handled in jQuery.ajax (so no try/catch here)
xhr.send( ( s.hasContent && s.data ) || null ); 
```

参数（来自 Firebug）

```
_   1356655864905
callback    jQuery18308375673194150332_1356655863817
p   0522
pl  12
s   false
secret  ##############################
u   request12341299 
```

请求（来自 Firebug）

```
Accept  text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01
Accept-Encoding gzip, deflate
Accept-Language nb-no,nb;q=0.9,no-no;q=0.8,no;q=0.6,nn-no;q=0.5,nn;q=0.4,en-us;q=0.3,en;q=0.1
Connection  keep-alive
Host    localhost:8888
Referer http://localhost:8888/popup.html
User-Agent  Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:17.0) Gecko/20100101 Firefox/17.0
X-Requested-With    XMLHttpRequest 
```

**原始问题：**

我正在努力解决似乎是一个常见问题，但我还没有找到解决方案。我正在尝试使用 jQuery 执行一个非常简单的 jsonp 调用。问题是要么a）什么都没有发生，要么b）来自服务器的响应是空的。

我尝试了几种不同的方法，同时使用了 $.ajax 方法和 $.getJSON 方法。两者都产生相同的错误结果。使用下面的代码没有任何反应：使用 Chrome 调试器，我可以看到它只是在该方法中途停止执行。但是使用 Wireshark 我可以看到客户端执行了三向握手，因此准备发送数据，但它没有做到这一点。

如果我删除**回调=？**它确实执行了，但是响应格式错误（或者至少，我认为是这样，因为我只能在 Firebug 中看到标有红线的响应）。

```
$.ajax({
     url: "http://mydomain.com/asd.php", //"http://localhost:8888/index.php",
     dataType: 'jsonp',
     type: 'GET',
     data: {p:p, u:u, s:symbols, pl:pl, secret:secret},
     contentType: "application/json; charset=utf-8",
     async: false,
     success: function(data){
        console.log("What " + data.test); 
     }, 
     error: function(data){
         console.log("failed for some reason");
     }
 }); 
```

服务器代码（$callback = $_GET["callback"]

```
<?php header('content-type: application/json; charset=utf-8');
.
.
.
$data = array
(
    "message" => $message,
    "status" => $statuscode,
    "length" => strlen($message)        
);

echo $callback . '('.json_encode($data) .')';
exit;       
?> 
```

这是手动输入的服务器响应。

```
funcName({"message":"!0b7(cb6Gv40","status":"OK","length":12}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T08:18:50.363

没有 jsfiddle/jsbin 很难调试它，所以我最好的建议是尝试让请求使用假的静态数据（只需一个空的 JSON 结构，{}，就可以了）。

似乎问题可能在于您如何使用 json_encode，因为您在添加 callback=? 时编写了该代码。参数响应看起来很混乱。建议的测试可以让您更好地诊断问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T11:19:12.457

嗯，你可以尝试使用'Fiddler'来调试调用吗？也许那个空的服务器响应毕竟不是那么空的。或者您的服务器可能有一些奇怪的安全设置，并检查 REFERRER 标头以阻止外部调用？

如果您可以为您的应用提供完整的 url，我可以为您测试它 =)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T17:18:05.437

从您的代码开始，我在本地进行了设置，一切都按预期工作：

**测试.php：**

```
<?php

$callback = $_GET["callback"];

$data = array
(
    "message" => 'test',
    "status" => 200,
    "length" => strlen('test')        
);

echo $callback . '('.json_encode($data) .')';
exit; 
```

**测试.html**：

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>
$(document).ready(function(){
  $.getJSON("http://localhost/test.php?callback=?",
    {
      whatever: 1,},
    function(data) {
      alert("hmm");
    });
});
</script>
</head>
<body>
</body>
</html> 
```

有两件事可以帮助你：

1.  `callback=?`由于从服务器返回的 JSON 不是有效的 JSON（由于您的 json 数据周围有括号），因此未将其放入您的调用中会失败。`$.getJSON`在这种情况下会默默地失败。如果您想查看错误，请`$.ajax`改用。
2.  您的问题*可能*来自您显然在这里尝试使用 https 的事实。至少在 Chrome 中，向带有无效证书的 https URL 发出 AJAX 请求（我假设您的本地主机或测试域没有有效证书）只会在控制台中出现错误。浏览器从不提示“您确定吗？” 关于证书。

希望能帮助到你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-01T07:46:45.450

所以，有了新的小提琴，工作起来要容易得多。这是您通话的工作示例-

```
var u = "test";

var p = 1234;
var symbols = false;
var pl = 16;
var secret = "c68f39913f901f3ddf44c707357a7d70";

$.ajax({
    url: "https://serve.pin2pass.com/index.php",
    dataType: 'jsonp',
    type: 'GET',
    data: {
        p: p,
        u: u,
        s: symbols,
        pl: pl,
        secret: secret
    },
    contentType: "application/json; charset=utf-8",
    aync:true,
    success: function(data) {
        $('#test').text(data.message);
    },
    error: function(data) {
        console.log("failed for some reason");
    }
});​ 
```

[jsfiddle](http://jsfiddle.net/YeqXN/)

我希望我不会在这里错过任何东西。我必须做的唯一更改是在请求 url 中，从

```
https://serve.pin2pass.com?index.php 
```

到 [https://serve.pin2pass.com/index.php](https://serve.pin2pass.com/index.php)

希望这能解决它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-01T04:34:46.843

如果您没有正确设置 SSL 证书，这显然**不起作用。**

当我将 https 转换为 http 时，这可以正常工作：http: [//jsfiddle.net/eysEe/](http://jsfiddle.net/eysEe/)

```
var u = "test";
var p = 1234;
var symbols = false;
var pl = 16;
var secret = "c68f39913f901f3ddf44c707357a7d70";

$.ajax({
    url: "http://serve.pin2pass.com?index.php",
    dataType: 'jsonp',
    type: 'GET',
    data: {
        p: p,
        u: u,
        s: symbols,
        pl: pl,
        secret: secret
    },
    contentType: "application/json; charset=utf-8",
    async: false,
    success: function(data) {
        $('#test').text(data.message);
    },
    error: function(data) {
        $('#test').text("SDf");
    }
}); 
```

当“https://serve.pin2pass.com?index.php”导致一个有风险的页面时，您可以判断您是否安装了错误的 SSL。也许您从未打算将其置于 https 模式？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-23T00:30:51.027

`callback`是 jsonp 的包装函数名称的通用 GET 参数。当您`callback=?`在 jQuery 请求中使用时，jQuery 会将其解析`?`为带有时间戳的其他内容，因此它始终是唯一值。API 服务器会将 json 包装在这个唯一的函数名中，jQuery 存储该名称以便它可以使用它来解包响应。

一些 API 不灵活，需要它们自己的特定名称，在这种情况下，您可以在其中一个中使用该`jsonpCallback`选项，也可以在其中`$.ajax`全局设置它`$.ajaxSetup`

请参阅`$.ajax` API 文档：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# vb.net - 处理用户控件内部的控制事件

> ID：14007662
> 
> 赞同：0
> 
> 时间：2012-12-23T00:10:00.777
> 
> 标签：vb.net

很快，我请求帮助来读取用户控件内的文本框的属性。
[访问用户控件内部的控件](https://stackoverflow.com/questions/13988186/accessing-to-control-inside-of-usercontrol) 正如我所建议的那样，我创建了一个名为 xTextBox 的非常简单的公共类，并将其用作我的用户控件中的文本框。那工作很好。

```
Public Class xTextBox
    Inherits TextBox
End Class 
```

现在我可以简单地从包含该用户控件的主程序中读取该 xTextbox 上的属性：

```
Dim s As Integer = myUserControl.xTextBox1.SelectionStart 
```

但是现在的问题是我无法在主程序中获取该文本框的事件。也许我可以声明'Shadows Event TextChanged ...'等，但我需要在用户控件所在的不同情况下使用更多事件，并且故意提高每个事件在实际编程方面看起来并不优雅。

如何将那些 xTextbox 的事件获取到主程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T00:40:59.080

如果您的新用户控件只有一个控件并继承文本框，那么您可以像平常一样使用属性编辑器或手动使用 AddHandler 附加事件。如果事情比这更复杂，我可能会创建一个面板并将您的新文本框放入其中，那么访问事件会容易得多。

```
Public Class myUserControl
    Inherits TextBox

End Class

Public Class Form1

    Public Sub New()
        InitializeComponent()
        AddHandler MyUserControl1.TextChanged, AddressOf MyUserControl_textChanged
    End Sub

    Private Sub MyUserControl_textChanged(sender As Object, e As EventArgs)
        Throw New NotImplementedException
    End Sub

End Class 
```

* * *

或者，如果您的 UserControl 中有多个自定义文本框，您可以创建一个自定义事件并在您的 UserControl 上的常见 TextChanged 事件中触发该事件，并在您的主窗体中处理它。

```
Public Class UserControl1
    Public Event TextChange(sender As Object, e As EventArgs)

    Private Sub MyUserControl_TextChanged(sender As System.Object, e As System.EventArgs) Handles MyUserControl1.TextChanged, MyUserControl2.TextChanged
        RaiseEvent TextChange(sender, e)
    End Sub
End Class

Public Class Form1
    Public Sub New()
        InitializeComponent()
End Sub
    Private Sub UserControl11_TextChange(sender As System.Object, e As System.EventArgs) Handles UserControl11.TextChange
        MsgBox(CType(sender, TextBox).Name, MsgBoxStyle.Information)
    End Sub
End Class 
```

# python - 使用 Python 从表中的数据创建数组

> ID：14007664
> 
> 赞同：1
> 
> 时间：2012-12-23T00:10:31.297
> 
> 标签：python, arrays

我想从文本文件中的表中获取数据到 python 数组中。我用作输入的文本文件有 7 列和 31 行。以下是前两行的示例：

```
10672   34.332875   5.360831    0.00004035881220    0.00000515052523    4.52E-07    6.5E-07

12709   40.837833   19.429158   0.00012010938453    -0.00000506426720   7.76E-06    2.9E-07 
```

我尝试编写的代码不起作用，因为它在通过 for 循环时一次没有读取一行。

```
data = []
f = open('hyadeserr.txt', 'r')
while True:
    eof = "no"
    array = []
for i in range(7):
    line = f.readline()
    word = line.split()
    if len(word) == 0:
        eof = "yes"
    else:
        array.append(float(word[0]))
        print array
if eof == "yes": break
data.append(array) 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T00:25:34.967

具有空格分隔值的文件只是经典[逗号分隔值 (CSV)](http://en.wikipedia.org/wiki/Comma-separated_values)文件的一种方言，其中分隔符是一个空格 ( `)，后面跟着更多的空格，可以忽略。`

 `令人高兴的是，Python 附带了一个可以理解[dialect](http://docs.python.org/2/library/csv.html#csv.Dialect)的。[**`csv.reader`**](http://docs.python.org/2/library/csv.html#csv.reader) `class`

你应该使用这个：

## 例子：

```
#!/usr/bin/env python

import csv

csv.register_dialect('ssv', delimiter=' ', skipinitialspace=True)

data = []
with open('hyadeserr.txt', 'r') as f:
    reader = csv.reader(f, 'ssv')
    for row in reader:
        floats = [float(column) for column in row]
        data.append(floats)

print data 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T01:30:28.463

如果你不想在这里使用 cvs，因为你真的不需要它：

```
data = []
with open("hyadeserr.txt") as file:
    for line in file:
        data.append([float(f) for f in line.strip().split()]) 
```

或者，如果您确定唯一的额外字符是空格和行尾`\n`，您可以将最后一行变成：

```
data.append([float(f) for f in line[:-1].split()]) 
````

# php - 在 Wamp 上为 AS3 使用 PHP 套接字服务器：沙盒违规

> ID：14007665
> 
> 赞同：1
> 
> 时间：2012-12-23T00:10:38.037
> 
> 标签：php, actionscript-3, wamp, sandbox, serversocket

我知道这已经被触及了很多，但是，尽管如此，我还是不明白。如果你们能忍受我:(

所以，我有这个代码：

```
import flash.net.*;
import fl.controls.*;
import flash.events.MouseEvent;
import flash.events.DataEvent;
import flash.events.SecurityErrorEvent;

var mySocket = new XMLSocket();
trace(Security.sandboxType)
pushMsg.addEventListener(MouseEvent.CLICK, realsedButton);
//mySocket.connect("192.124.5.2",9999);
mySocket.addEventListener(Event.CONNECT, xmlsocket);
mySocket.addEventListener(Event.CLOSE, xmlsocket);
mySocket.addEventListener(IOErrorEvent.IO_ERROR, xmlsocket);
mySocket.addEventListener(DataEvent.DATA, dataHandler);
mySocket.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityHandler);   

msgArea.htmlText = "Started!";
connectToServer();
function connectToServer()
{
    msgArea.htmlText += "Inside connect To Server";
    mySocket.connect("localhost",9999);
}

function securityHandler(evt: SecurityErrorEvent)
{
    msgArea.htmlText += "SecurityError";
}

function dataHandler(evt:DataEvent)
{
    trace("Inside dataHandler")
    var xml = XML(evt.target.data);
    msgArea.htmlText += xml;
}

function xmlsocket(Event)
{
    msgArea.htmlText += "inside xmlSocket";
    switch(Event.type)
    {
        case 'ioError':
            msgArea.htmlText += "Inside dataHandler";
            msgArea.htmlText += "<b>Server connection failed!</b>";
            break;

        case 'connect':
            msgArea.htmlText +="Inside Connect";
            msgArea.htmlText += "<b>Server connection establed!</b>";
            break;

        case 'close':
            msgArea.htmlText +="Inside Close";
            msgArea.htmlText += "<b>Server connection lost</b>";
            break;
    }
}
function msgGO() 
{
    msgArea.htmlText +="Inside msgGO";
    if (inputMsg.htmlText != "") 
    {
        msgArea.htmlText +="Inside msgGo2";
        mySocket.send(inputMsg.htmlText+"\n");
        inputMsg.htmlText = "";
    }
}

function realsedButton(evt:MouseEvent)
{
    msgArea.htmlText +="Inside ReleasedButton";
    msgGO();
} 
```

我已经做了很多测试，我会尝试整齐地总结一下。

**如果直接从 Flash 运行**(ctrl+enter) 并且**套接字服务器处于离线状态**并且**权限设置为网络**并且 mySocket.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityHandler) 行被**注释掉**

输出如下：

*   开始了！
*   内部连接到服务器
*   在xmlsocket里面
*   内部数据处理程序
*   服务器连接失败

错误 #2044 未处理的安全 error.txt = 错误 #2048 安全沙箱违规文件 ///G|/flash%20Stuff/socketClientNetwork.swf 无法在 socketClientNetwork_fla::maintimeline/frame 1 处从 localhost:9999 加载数据{}

如果**从 SWF 运行**并且**套接字服务器处于 OFFLINE 状态**并且**权限设置为 Network**并且该行（从上面）**没有被注释掉** 输出如下：

*   开始了！

    内部连接到服务器

    安全错误

如果直接从**Flash**运行(ctrl+enter) 并且**套接字服务器处于离线状态**并且权限设置为**本地**并且 mySocket.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityHandler) 行被**注释掉**

输出如下：

*   开始了！
*   内部连接到服务器
*   在xmlsocket里面
*   内部数据处理程序
*   服务器连接失败

错误 #2044 未处理的安全 error.txt = 错误 #2048 安全沙箱违规文件 ///G|/flash%20Stuff/socketClientLocal.swf 无法在 socketClientLocal_fla::maintimeline/frame 1 处从 localhost:9999 加载数据{}

如果从**SWF**和套接字服务器运行并且套接字服务器处于**离线**状态并且权限设置为**本地**并且该行（如上）未**注释**

*   开始了！
*   内部连接到服务器
*   安全错误

SWF :: 在线 :: 本地 :: 已评论

*   开始了！
*   内部连接到服务器
*   安全错误

FLA :: 在线 :: 本地 :: 未注释

*   开始了！
*   内部连接到服务器
*   在xmlsocket里面
*   内部连接到服务器
*   连接已建立

SWF::Online::Network::Commented

*   开始了！
*   内部连接到服务器
*   安全错误

FLA::Online::Network::未注释

*   开始了！
*   内部连接到服务器
*   内部xml套接字
*   内部连接
*   服务器连接建立

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T00:22:16.063

您必须将文件系统上的 swf 移动到本地 Web 服务器的文档根文件夹或其子文件夹，然后在浏览器地址栏中键入：

```
http://localhost/socketClientLocal.swf 
```

代替

```
file:///G|/flash%20Stuff/socketClientLocal.swf 
```

此外，您还必须创建一个名为“socket policy file”的文件`crossdomain.xml`：

```
<?xml version="1.0"?>
<cross-domain-policy>
    <allow-access-from domain="localhost" toports="*"/>
</cross-domain-policy> 
```

在`connect()`Flash Player 上首先尝试加载此文件。如果加载失败或设置限制访问，Flash Player 也会触发您遇到的安全错误。

Flash Player 尝试按`crossdomain.xml`以下顺序加载：

*   您传递到的服务器的端口 843 `connect()`（在您的情况下为 localhost:843）
*   服务器：您传递给的端口`connect()`（在您的情况下为 localhost:9999）

现在你有两个选择：

*   在仅服务 crossdomain.xml 的端口 843 上创建一个附加服务器
*   通过您自己的服务器提供 crossdomain.xml

您会[在这里](http://www.lightsphere.com/dev/articles/flash_socket_policy.html)找到许多有用的信息。您还可以在 Web 上找到现成的套接字策略服务器软件（用于端口 843）。例如Apache 的[mod_socket_policy_server](http://socketpolicyserver.com/)。提示：Google for 'socket policy server'

祝你好运！

# jquery - ie7“对象不支持该属性或方法”

> ID：14007668
> 
> 赞同：3
> 
> 时间：2012-12-23T00:11:15.947
> 
> 标签：jquery, internet-explorer-7

谁能解释为什么这会在 IE7 中引发错误？这表明错误发生在“var newStr.....”行上

它不会在任何其他浏览器中发生。

```
$(document).ready(function() {
    $('a[onclick*="_self"]').each(function() {
        var newOnclick = $(this).attr('onclick');
        var newStr = newOnclick.replace('_self','_parent');
        $(this).attr('onclick', newStr);
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:21:00.163

IE 的（早期版本）无法在您请求时将函数对象强制转换为它的源。因此，字符串不能那么容易地交换。

您可以用新的 _parent 函数替换整个旧的“_self”函数，例如：

```
$('a[onclick*="_self"]').attr('onclick', function() { _parent-stuff }); 
```

或 - 我阅读了您的最后一条评论，第二个解决方案对您不起作用，因为它需要更改正文的 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:29:17.187

尝试这个：

```
$(document).ready(function() {
  $('a[onclick*="_self"]').each(function() {
    var newOnclick = $(this).attr('onclick').toString();
    var newStr = newOnclick.replace('_self','_parent');
    if($.browser.msie && parseFloat($.browser.version) == 7) {
       newStr = newStr.replace('onclick="function anonymous()&#10;{&#10;','onclick="');
       newStr = newStr.replace('}"','"');
    }
    $(this).attr('onclick', newStr);
    //$(this).unbind();
    //$(this).bind('click', function () { eval(newStr); });
  });
}); 
```

# python - Python 工具 Visual Studio 支持 Twisted

> ID：14007670
> 
> 赞同：0
> 
> 时间：2012-12-23T00:12:24.580
> 
> 标签：python, visual-studio-2012, twisted, ptvs

我正在寻找一个 Python 应用程序。Visual Studio 的 Python 工具是否支持第三方库，例如 Twisted？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T04:00:52.107

3rd 方库将运行得很好。要对它们进行智能感知，需要将它们安装在站点包或项目的一部分中。如果在安装 PTVS 后安装它们，则需要运行 Tools->Options->Python Tools->Interpreter Options 并选择您配置的解释器并重新生成完成数据库。或者，您可以将库作为项目的一部分，并实时分析它们。

您似乎也对一些专门的应用程序感兴趣......如果该应用程序是一个纯 Python 应用程序，并且像“python.exe app.py”一样启动，那么您将完全没有问题。您可能需要在 Tools->Options->Python Tools->Interpreter Options 中再次设置一个自定义解释器，如果它是一个特殊的应用程序特定构建，它指向应用程序正在使用的特定 python.exe。

如果该应用程序实际上是一个托管 Python 的 C++ 应用程序，那就有点困难了。在 PTVS 中编辑代码应该没有问题，但调试可能需要通过执行 Debug->Attach to Process 来完成。如果应用程序托管一个普通的 Python 构建并动态链接，这应该可以工作。PTVS 将发现 Python 解释器并将其调试脚本注入到进程中。每次启动后执行附加的工作流程可能有点麻烦，但如果您不经常重新启动它应该不会太糟糕

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T00:15:19.473

PTVS 只是一个 IDE。所以它不需要“支持”任何库——它们只需要在你的*PYTHONPATH*中，这样你的 python 代码就可以导入它们。

但是，PTVS 很有可能无法`twistd`像在命令行上那样使用基于扭曲的守护进程...

# actionscript-3 - AS3：如何启动父母的计时器？

> ID：14007672
> 
> 赞同：0
> 
> 时间：2012-12-23T00:12:49.353
> 
> 标签：actionscript-3

我在一个孩子中有一个函数，它应该在父类中启动计时器。这样做的代码是：

```
MovieClip(this.parent).Investment1Timer.start(); 
```

但是当它试图这样做时，我得到了这个错误：

```
TypeError: Error #1009: Cannot access a property or method of a null object reference. 
```

我可以很好地访问父级的函数和变量，但我无法启动它的任何计时器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T00:26:01.703

这可能是范围问题，并且父项中的 Investment1Timer 是私有的。

它应该是 ：

```
public var Investment1Timer:Timer; 
```

如果您不指定 public 或 private，它将默认为 private，并且在该类代码之外无法访问。

您还应该验证它`this.parent`不是 null 并且实际上是 MovieClip 或从 MovieClip 继承。

我发现调查此类问题的最佳方法是在调试模式下运行，因为您可以检查所涉及的变量以查明什么是空的。调试器是你的朋友！

我还应该注意，您可能已经声明了 Investment1Timer，但您没有创建实例，因此它仍然是 null 吗？

# javascript - 如果我将函数调用推送到数组或分配为属性，它是否会推送/分配返回的值？

> ID：14007674
> 
> 赞同：0
> 
> 时间：2012-12-23T00:13:48.657
> 
> 标签：javascript, arrays, function, object

例子：

```
function SomeCall(){
      return "Bill";
}

var a = [];
a.push(SomeCall());

var obj = {
      name: SomeCall()
};

//is function CALLED here or does this already contain "Bill"?
console.log(obj.name); 
console.log(a[0]); //what about here? 
```

现在，当我访问数组中的对象或项的值时，它是否在那时调用该函数并给我该值？还是在推送/赋值时调用函数并保存返回值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:17:59.283

该函数在使用时被正确调用`()`。所以数组包含函数的返回值。如果您想存储函数本身，只需使用`a.push(SomeCall)`并稍后调用它（`a[0]()`）。如果您总是想使用某些参数调用它，请存储一个包含调用的匿名函数：

```
a.push(function() {
    return SomeCall(your, params);
}); 
```

但是，在现代 JS 引擎中（即不在“旧”IE 版本中），您可以定义*访问器*。这允许您在读取（或写入）某个属性时执行代码：

```
var obj = {};
obj.__defineGetter__("name", SomeCall); 
```

然后任何读取访问都`obj.name`将返回`SomeCall()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T00:16:22.043

JavaScript 是一种非惰性语言，所以当你将一个函数的调用编码成对另一个函数的调用时，效果就是将内部函数调用的**结果**传递给外部函数。

因此：

```
a.push(SomeCall()); 
```

实际上就像：

```
var temp = SomeCall(); // call function, get result
a.push(temp); 
```

类似地，在对象字面量表达式中，属性声明的右侧被求值，求值的结果是属性的值。

# iphone - UIStoryboard 的 instantiateViewControllerWithIdentifier SIGABRT 崩溃

> ID：14007678
> 
> 赞同：2
> 
> 时间：2012-12-23T00:14:14.257
> 
> 标签：iphone, objective-c, ios, xcode, storyboard

# 问题

在检查并仔细检查了通常的解决方案后，`instantiateViewControllerWithIdentifier:`由于超出我经验范围的原因而崩溃。

# 细节

我正在尝试使用情节提要视图控制器进行分页`UIPageViewController`，其中 pagecontroller 是根控制器的子控制器，类似于 Apple 设置基于页面的项目的方式。

我把我的故事板 ViewController 都贴上了标签：

![在此处输入图像描述](../Images/5bd1bb16013e9379e6333111733649fe.png)

我正在初始化它以供分页使用：

```
-(MemoImageViewController *)viewControllerAtIndex:(NSUInteger)index
{
    if (index >= [pageMemories count] || [pageMemories count] ==0) return nil;
    MemoImageViewController * viewController = [_mainBoard instantiateViewControllerWithIdentifier:@"MemoImageViewController"];
    viewController.memory = [pageMemories objectAtIndex:index];
   return viewController;
} 
```

_mainboard = 我使用的主要且唯一的故事板的 UIStoryboard 参考。

然而，该应用程序因 SIGABRT 而崩溃，而对原因的解释为零。当我打开异常断点时，它会引导我进入该`instantiateViewControllerWithIdentifier`方法。

# 我试过的

1.  我尝试从情节提要中启动不同的视图控制器，并且它工作正常。让我相信这与我正在使用的视图控制器有关。
2.  更改身份、标题、故事板 ID 没有任何效果。
3.  我删除了派生数据，快照，清理了我的项目，构建了几种不同的方式，没有用。

我希望这是足够的信息来评估我的问题，很可能我只是将视图控制器切换到 xib，但我想先看看这是否行不通。

谢谢，节日快乐。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-06-04T18:42:22.130

尝试从 _mainboard 更改为 self.storyboard

```
MemoImageViewController * viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"MemoImageViewController"]; 
```

# php - 运行我的 PHP 文件时遇到问题

> ID：14007679
> 
> 赞同：-3
> 
> 时间：2012-12-23T00:14:18.470
> 
> 标签：php, xampp, dreamweaver

> **可能重复：**
> [关于 php 和 dreamweaver 的问题？](https://stackoverflow.com/questions/7330627/question-about-php-and-dreamweaver)

我在运行我的 php 文件时遇到了很多麻烦。我下载了 XAMPP 并运行了 Apache 和 MySQL。我是否需要将文件保存在某个位置，Dreamweaver 显示以下内容是什么意思：

> 要预览包含服务器端代码的页面，您需要一个测试服务器。您现在要指定一个吗？

我在 HTML 和 CSS 方面有足够的知识，并且已经让网站运行，但我似乎无法让 PHP 工作。当我从谷歌浏览器运行代码时，它看起来像这样：

```
"Hello World"
"; phpinfo(); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:25:11.713

您可以将 PHP 文件放入该`xampp/htdocs`文件夹，例如`xampp/htdocs/hello.php`，然后在浏览器中打开它`http://localhost/hello.php`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:19:02.233

`localhost`为了呈现 PHP 页面，URL 必须显示或您设置的任何内容。您还需要确保 PHP 处理程序正常工作并正确解析 PHP 文件。

# ruby - 调试 Sinatra 应用程序

> ID：14007684
> 
> 赞同：3
> 
> 时间：2012-12-23T00:15:07.487
> 
> 标签：ruby, debugging, sinatra, rack

我安装了 pry 并尝试使用它。

```
gem "pry"    

require 'pry'
#..........
binding.pry 
```

但是有3个问题：

*   我不知道去下一个字符串（而不是下一个断点）或观察变量的值。没有关于它的**信息**！
*   有很多不同的撬！pry-debug、pry、pry-db 等等。我应该使用哪一个？
*   它应该停在那里。但我还不知道（也没有找到）如何查看变量的值或如何转到下一行。它总是在几秒钟内给出以下错误：

```
pry(#)> 错误：执行已过期
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:600:in `getbyte'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:600:in `readline'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:600:in `block in readline'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:544:in `handle_read_errors'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:589:in `readline'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:369:in `retrieve_line'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:304:in `block in r'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:301:in `loop'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:301:in `r'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:271:in `re'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:251:in `rep'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:231:in `repl 中的块（3 级）'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:230:in `loop'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:230:in `repl 中的块（2 级）'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:229:in `catch'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:229:in `block in repl'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:228:in `catch'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_instance.rb:228:in `repl'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/pry_class.rb:154:in `start'
/var/lib/gems/1.9.1/gems/pry-0.9.10/lib/pry/core_extensions.rb:22:in `pry'
/home/alex/Documents/ruby/my_projects/controllers/my_controller.rb:24:in `block in '
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:1265:in `call'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:1265:in `block in compile!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `[]'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `block (3 levels) in route!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:851:in `route_eval'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `block (2 levels) in route!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:872:in `block in process_route'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:870:in `catch'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:870:in `process_route'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:834:in `block in route!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:833:in `每个'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:833:in `route!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:936:in `dispatch!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:769:in `block in call!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `block in invoke'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `catch'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `invoke'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:769:in `call!'
/home/alex/Documents/ruby/my_projects/app.rb:21:in `block in '
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:1265:in `call'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:1265:in `block in compile!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `[]'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `block (3 levels) in route!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:851:in `route_eval'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `block (2 levels) in route!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:872:in `block in process_route'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:870:in `catch'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:870:in `process_route'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:834:in `block in route!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:833:in `每个'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:833:in `route!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:936:in `dispatch!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:769:in `block in call!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `block in invoke'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `catch'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `invoke'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:769:in `call!'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:755:in `call'
/var/lib/gems/1.9.1/gems/rack-flash3-1.0.1/lib/rack/flash.rb:120:in `call'
/var/lib/gems/1.9.1/gems/rack-timeout-0.0.3/lib/rack/timeout.rb:16:in `block in call'
/usr/lib/ruby/1.9.1/timeout.rb:68:in `timeout'
/var/lib/gems/1.9.1/gems/rack-timeout-0.0.3/lib/rack/timeout.rb:16:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
/var/lib/gems/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'
/var/lib/gems/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/path_traversal.rb:16:in `call'
/var/lib/gems/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/json_csrf.rb:17:in `call'
/var/lib/gems/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/base.rb:47:in `call'
/var/lib/gems/1.9.1/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/logger.rb:15:in `call'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:129:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/head.rb:9:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/showexceptions.rb:21:in `call'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:99:in `call'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:1389:in `block in call'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:1471：在“同步”中
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:1389:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:134:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/urlmap.rb:64:in `block in call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/urlmap.rb:49:in `each'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/urlmap.rb:49:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/lint.rb:48:in `_call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/lint.rb:36:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/showexceptions.rb:24:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/commonlogger.rb:20:in `call'
/var/lib/gems/1.9.1/gems/sinatra-1.3.3/lib/sinatra/base.rb:136:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/chunked.rb:43:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/content_length.rb:14:in `call'
/var/lib/gems/1.9.1/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `服务'
/usr/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `服务'
/usr/lib/ruby/1.9.1/webrick/httpserver.rb:94:在“运行”中
/usr/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'
撬(#)>

```

好的，我安装

```
gem "debugger" 
```

并添加断点

```
debugger 
```

什么都没有发生。

日志文件不是我要找的。我只想调试一个 Sinatra 应用程序。我怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T00:21:29.103

在您的 Gemfile 中：

```
gem "pry"
gem "pry-nav" 
```

运行捆绑。然后每当脚本遇到`binding.pry`，您将打开一个外壳。你可以看到你在哪里`whereami`，你移动到下一行`next`，继续运行脚本`continue`。如果要检查变量，只需键入其名称。

有关更多信息，请参阅[pry-nav](https://github.com/nixme/pry-nav)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-25T21:43:48.220

撬调试器更好。并且您需要在模块化样式下运行 sinatra 应用程序。

我在 github 创建了一个 repo，它解释了如何使用 pry 进行调试。

![在此处输入图像描述](../Images/a6796c037e3d9d478391bf2cd11dd3c2.png)

这是回购：[https ://github.com/hlee/sinatra_debugger_example](https://github.com/hlee/sinatra_debugger_example)

### pry-debugger 和 pry-nav 的区别

### 撬调试器

如果你检查 pry-debugger 的源代码，你会看到：

```
# pry-debugger.gemspec
# Dependencies
gem.required_ruby_version = '>= 1.9.2'
gem.add_runtime_dependency 'pry', '>= 0.9.10'
gem.add_runtime_dependency 'debugger', '~> 1.3'
gem.add_development_dependency 'pry-remote', '~> 0.1.6' 
```

这意味着，pry-debugger 仅支持 MRI 1.9.2 和 1.9.3。由于它依赖于调试器，Pry-debugger 将支持更快的跟踪、断点等。

### 撬导航

另一方面，这里是 pry-nav 来源：

```
# pry-nav.gemspec
# Dependencies
gem.required_ruby_version = '>= 1.8.7'
gem.add_runtime_dependency 'pry', '~> 0.9.10'
gem.add_development_dependency 'pry-remote', '~> 0.1.6' 
```

这意味着，pry-nav 是一种纯 ruby​​ 方法，不依赖于调试器。将支持 1.8.7，不支持断点和调试器的一些其他功能。

## 断点

```
break SomeClass#run           # Break at the start of `SomeClass#run`.
break Foo#bar if baz?         # Break at `Foo#bar` only if `baz?`.
break app/models/user.rb:15   # Break at line 15 in user.rb.
break 14                      # Break at line 14 in the current file.

break --condition 4 x > 2     # Change condition on breakpoint #4 to 'x > 2'.
break --condition 3           # Remove the condition on breakpoint #3.

break --delete 5              # Delete breakpoint #5.
break --disable-all           # Disable all breakpoints.

break                         # List all breakpoints. (Same as `breakpoints`)
break --show 2                # Show details about breakpoint #2. 
```

## 笔记

pry-nav 和 pry-debugger 不能一起加载。

# python - 在 python/kivy 应用程序中是否有用于分布式消息传递的预制解决方案？

> ID：14007685
> 
> 赞同：2
> 
> 时间：2012-12-23T00:15:11.530
> 
> 标签：python, kivy

比如rabbitMQ这样的程序。但我希望能够将它包含在我的已编译包中。这样，除了运行我的 .exe 或 .dmg 文件之外，对设置没有特殊要求。

我很好奇这样的事情是否已经可行，或者我是否需要自己组装一些东西。

# java - 在 scriptlet <% XY %> 中直接使用 EL ${XY}

> ID：14007689
> 
> 赞同：5
> 
> 时间：2012-12-23T00:16:05.613
> 
> 标签：java, jsp, el, scriptlet

在我的项目中，每次打开 JSP 时我都必须分配一个变量。`<% %>`我在 JSP 和 EL中使用 scriptlet 进行了尝试，它`${}`返回了变量。

但它似乎不起作用。

```
 <% String korrekteAntwort=${frage.korrekteAntwort};%>
 <%session.setAttribute("korrekteAntwort", korrekteAntwort);%> 
```

之后有错误`korrekteAntwort=${}`，难道不能直接在scriptlet中从EL中赋值变量吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-23T00:59:20.550

您正在混合*scriptlet*和 EL，并期望它们“同步”运行。那是行不通的。[一种是编写 JSP 的老式方法，](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files/3180202#3180202)另一种是编写 JSP[的现代方法](https://stackoverflow.com/tags/el/info)。您应该使用其中一个，而不是两者都使用。

回到具体问题，在幕后，EL 通过[`PageContext#findAttribute()`](http://docs.oracle.com/javaee/6/api/javax/servlet/jsp/JspContext.html#findAttribute%28java.lang.String%29). *所以只需在scriptlets*中做同样的事情。

```
Frage frage = (Frage) pageContext.findAttribute("frage");
session.setAttribute("korrekteAntwort", frage.getKorrekteAntwort()); 
```

**然而**，如前所述，这是一种使用 JSP 的老派方式，对于您已经想到的功能需求，不一定是“最佳”方式[，但没有说明任何关于](https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem). 现代 JSP 方式将使用[JSTL](https://stackoverflow.com/tags/jstl/info) `<c:set>`：

```
<c:set var="korrekteAntwort" value="${frage.korrekteAntwort}" scope="session" /> 
```

从该行开始，这将在会话范围内可用`${korrekteAntwort}`，这正是该行*scriptlet*所做的。

# ruby-on-rails - Rails + Capybara-webkit – javascript 代码覆盖率？

> ID：14007695
> 
> 赞同：4
> 
> 时间：2012-12-23T00:16:58.370
> 
> 标签：ruby-on-rails, testing, rcov, jscoverage

我正在研究使用 capybara-webkit 对应用程序进行一些接近现实的测试。这是绝对必要的，因为该应用程序具有非常丰富的基于 JS 的 UI，并且 Rails 部分主要是 API 调用。

问题是：是否有任何工具可以集成到可以检测 Javascript 代码并报告其覆盖率的测试管道中？这里的关键是能够轻松集成到测试工作流中（就像 rcov/simplecov）——我不喜欢自己用 jscoverage 或类似物来做这个想法：）

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-24T16:15:10.247

**更新：**从 JSCover 版本 1.05 开始，不再需要我在之前的答案中概述的技巧。我已经更新了我的答案以反映这一点。

我设法让[JSCover](http://tntim96.github.io/JSCover/)在 Rails + Capybara 管道中工作，但确实需要一些黑客才能让它工作。我建立了一个小 rake 任务：

1.  使用 rails 资产管道生成脚本
2.  调用 java jar 来检测所有文件并在临时目录中生成一个空报告
3.  修补 jscover.js 脚本以在“报告模式”下运行（只需在末尾添加 jscoverage_isReport=true）
4.  将结果复制到 /public/assets 以便测试在不需要任何更改的情况下获取它，因此可以在浏览器中自动打开覆盖率报告

然后我添加了一个设置任务以在测试开始时清除浏览器的 localStorage，并添加一个拆卸任务，在最后写出完成的报告。

```
def setup
  unless $startup_once
    $startup_once=true
    puts 'Clearing localStorage'
    visit('/')
    page.execute_script('localStorage.removeItem("jscover");')
  end
end
def teardown
  out=page.evaluate_script("typeof(_$jscoverage)!='undefined' && jscoverage_serializeCoverageToJSON()")
  unless out.blank? then
    File.open(File.join(Rails.root,"public/assets/jscoverage.json"), 'w') {|f| f.write(out) }
  end
end 
```

无论如何，最终结果很好，这样做的好处是它也适用于无头浏览器，因此它也可以包含在 CI 中。

*** 更新 2：这是一个自动执行步骤的 rake 任务，将其放入 /lib/tasks

```
# Coverage testing for JavaScript
#
# Usage:
# Download JSCover from: http://tntim96.github.io/JSCover/ and move it to
#   ~/Applications/JSCover-1
# First instumentalize the javascript files:
#   rake assets:coverage
# Then run browser tests 
#   rake test
# See the results in the browser
#   http://localhost:3000/assets/jscoverage.html
# Don't forget to clean up instrumentalization afterwards:
#   rake assets:clobber
# Also don't forget to re-do instrumentalization after changing a JS file

namespace :assets do
  desc 'Instrument all the assets named in config.assets.precompile'
  task :coverage do
    Rake::Task["assets:coverage:primary"].execute
  end

  namespace :coverage do
    def jscoverage_loc;Dir.home+'/Applications/JSCover-1/';end
    def internal_instrumentalize

      config = Rails.application.config
      target=File.join(Rails.public_path,config.assets.prefix)

      environment = Sprockets::Environment.new
      environment.append_path 'app/assets/javascripts'
      `rm -rf #{tmp=File.join(Rails.root,'tmp','jscover')}`
      `mkdir #{tmp}`
      `rm -rf #{target}`
      `mkdir #{target}`

      print 'Generating assets'
      require File.join(Rails.root,'config','initializers','assets.rb')
      (%w{application.js}+config.assets.precompile.select{|f| f.is_a?(String) && f =~ /\.js$/}).each do |f|
        print '.';File.open(File.join(target,f), 'w') {|ff| ff.write(environment[f].to_s) }
      end
      puts "\nInstrumentalizing…"
      `java -Dfile.encoding=UTF-8 -jar #{jscoverage_loc}target/dist/JSCover-all.jar -fs #{target} #{tmp} #{'--no-branch' unless ENV['C1']} --local-storage`
      puts 'Copying into place…'
      `cp -R #{tmp}/ #{target}`
      `rm -rf #{tmp}`
      File.open("#{target}/jscoverage.js",'a'){|f| f.puts 'jscoverage_isReport = true' }

    end

    task :primary => %w(assets:environment) do
      unless Dir.exist?(jscoverage_loc)
        abort "Cannot find JSCover! Download from: http://tntim96.github.io/JSCover/ and put in #{jscoverage_loc}"
      end
      internal_instrumentalize
    end

  end

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-15T07:25:59.727

现在已将其添加到 JSCover（在主干中） - JSCover 的相关线程在[这里](https://github.com/tntim96/JSCover/issues/92)。

> 我设法让 JSCover 在 Rails + Capybara 管道中工作，但它确实需要相当多的黑客才能让它工作

这些更改现在位于 JSCover 的主干中，并将成为版本 1.0.5 的一部分。那里也有工作示例（包括 Selenium IDE 记录的示例）和文档。

> 需要做一些额外的工作才能使分支检测正常工作，因为它使用无法轻松序列化为 JSON 的对象

这是一个在新代码中使用的函数。

> 无论如何，最终结果效果很好

我同意。这使得 JSCover 可以被高级工具使用，这些工​​具不能很好地与 iFrame 或通过这种方法避免的多个窗口一起工作。这也意味着可以通过两项调整将代码覆盖率添加到现有的 Selenium 测试中：

1.  使测试通过 JSCover 代理运行
2.  将覆盖率报告保存在测试套件的末尾

有关更多信息，请参阅 JSOver 的文档。包含这些更改的 1.0.5 版应在几天内发布。

# javascript - 如何将滚动表中的列与固定标题匹配

> ID：14007696
> 
> 赞同：0
> 
> 时间：2012-12-23T00:17:12.107
> 
> 标签：javascript, html, css

我正在尝试创建一个带有固定标题的滚动表。问题是 the`<thead>`和 the之间的列`<tbody>`没有正确匹配。我的问题是如何让列在具有固定标题的滚动表中匹配。

下面是小提琴，只需点击“添加问题”按钮 3 次，然后滚动表格：

[http://jsfiddle.net/6rCyH/2/](http://jsfiddle.net/6rCyH/2/)

下面是表格的html：

```
<table id="qandatbl" align="center">
<thead class="tblhead">
<tr>
    <th class="qid">Question No</th>
    <th class="question">Question</th>
    <th class="optandans">Option and Answer</th>

</tr>
</thead>
<tbody class="tblbody">
</tbody>
</table> 
```

下面是控制表格和每一列的主要css：

```
body{
    font-size:85%;  
}           

.extratd{
    border:1px black solid;
    border-collapse:collapse;
}

.qid { 
    min-width:3%;
    max-width:3%;
    font-weight:bold;
    border:1px black solid;
    border-collapse:collapse;
}

.question { 
    min-width:14%;
    max-width:14%;
    border:1px black solid;
    border-collapse:collapse;
}

.question textarea {
    min-width:auto;
    max-width:auto;
    resize:none;
    height:100%;
    font-size:100%;
}

.noofanswers{
    min-width:15%;
    max-width:15%;
    padding-top:5%;
    padding-bottom:5%;
}

.optandans{
    min-width:30%;
    max-width:30%;
    border:1px black solid;
    border-collapse:collapse;
}

.option{
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
}

.answer { 
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
     }   

.tblbody{
    background-color: #ddd;
    height: 400px;
    overflow: auto; 
}

.tblhead, .tblbody {
    display: block;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:24:34.180

从 CSS 末尾删除这部分：

```
.tblhead, .tblbody {
    display: block;
} 
```

示例：http: [//jsfiddle.net/grc4/DC4Ps/1/](http://jsfiddle.net/grc4/DC4Ps/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T04:24:17.027

结果 ![在此处输入图像描述](../Images/c54fe6199b679625f33739ef3a409692.png)

使用以下 CSS

```
<style type="text/css">
        .qid {
            width:15%;
        }

        .question {
            width:30%;
        }

        .extratd {
            /*
             * width will be the remaining of its parent.
             */
        }
        table {
            border-collapse:collapse;
        }
        td, th {
            border:1px solid black;
            /*
             * In case the long word will affect the width of TD
             */
            word-wrap:break-word;
            word-break:break-all;
        }
        thead {
            /*
             * minus the scollbar's width from THEAD
             */
            margin-right:12px;
        }
        thead, tbody {
            /*
             * Override the default display table-head-group, table-row-group.
             * If not, the height will be computed with table layout rendering algorithm
             * by browser
             */
            display:block;
        }
        tbody {
            /*
             * let the TABLE BODY part scroll
             */
            height:400px;
            overflow:scroll;
        }
        tbody td {
            /* In case the children in the TD will change its width which 
             * set by CSS implicitly, such as 15%, 30%
             */
            overflow:hidden;
        }
        textarea {
            /* to override the default width of text area in case it will 
             * go out of TD */
            width:100%;
        }
    </style> 
```

请参阅内联评论。这个方案有个问题，要知道滚动条的宽度，兼容性不好。

```
<table>
        <thead>
            <tr>
                <th class="qid">Question No</th>
                <th class="question">Question</th>
                <th class="extratd">Option and Answer</th>
            </tr>
        </thead>
        <tbody>
            <tr align="center" class="optionAndAnswer">
                <td class="qid">1</td>
                <td class="question">                   
                    <textarea class="textAreaQuestion" name="questionText[]" value=""></textarea>
                </td>
                <td class="extratd">
                <div class="option">
                    1\. Option Type:
                    <br>
                    <input type="text" readonly="readonly" class="gridTxtRow maxRow" name="gridValues[]" value="">
                    <span class="showGrid" href="#">[Open Grid]</span>
                </div>
                <div class="noofanswers">
                    2\. Number of Answers:
                    <br>
                    <span style="display: none;" class="naRow string" name="numberAnswer[]" value="">Only 1 Answer</span>
                    <input type="text" onchange="getButtons()" onkeypress="return isNumberKey(event)" onkeyup="numberKeyUp(this)" style="display: block;" class="numberAnswerTxtRow answertxt" name="numberAnswer[]" value="">
                </div>
                <div class="answer">
                    3\. Answer:
                    <br>
                </div>
                </td>
            </tr>
        </tbody>
    </table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T00:29:56.070

您尝试过吗：问题 textarea { min-width: auto; 最大宽度：自动；调整大小：无；高度：240px；字体大小：100%；边框：无；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T00:36:07.083

你为什么用百分比？如果你使用 px 一切都应该被修复。[http://jsfiddle.net/6rCyH/5/](http://jsfiddle.net/6rCyH/5/)

```
 /*css for QandATable.php*/
body{
    font-size:85%;    
}            

#qandatbl{
    border:1px black solid;
    border-collapse:collapse;
}

#qandatbl td { 
    vertical-align: middle;
}

#qandatbl th{
    border:1px black solid;
    border-collapse:collapse;
    text-align:center;
}

.extratd{
    border:1px black solid;
    border-collapse:collapse;
}

.qid { 
    min-width:76px;
    max-width:3%;
    font-weight:bold;
    border:1px black solid;
    border-collapse:collapse;
}

.question { 
    min-width:177px;
    max-width:177px;
    border:1px black solid;
    border-collapse:collapse;
}

.question textarea {
    min-width:auto;
    max-width:auto;
    resize:none;
    height:100%;
    font-size:100%;
}

.noofanswers{
    min-width:15%;
    max-width:15%;
    padding-top:5%;
    padding-bottom:5%;
}

.optandans{
    min-width:194px;
    max-width:30%;
    border:1px black solid;
    border-collapse:collapse;
}

.option{
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
}

.answer { 
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
     }

.wrapper{
    text-align:left;
    display: inline-block;
}

#question{
    display:inline-block;
    vertical-align:top;    
    min-width:25%;
    max-width:25%;
}

#question th{
    border-collapse:collapse;
    border:1px solid black;    
    position: fixed;
}

#question td{
    border-collapse:collapse;
    border:1px solid black;    
}

#optionAndAnswer{
    display:inline-block;
    vertical-align:top;
    min-width:28%;
    max-width:28%;
}

#optionAndAnswer th{
    border-collapse:collapse;
    border:1px solid black;    
}

#optionAndAnswer td{
    border-collapse:collapse;
    border:1px solid black;    
}

#optionAndAnswer td table td {
    border: 0px;   
}

#answerSection{
    width:100%;
    text-align:center;    
}

#detailsBlock{    
    text-align:center;
}

.numberAnswerTxt{
    background-color: #F2F2F2;
    float:left;
    width:15%;
    font-weight:bold;
    display:none;
    font-size:85%;    
}

.numberAnswerTxtRow{
    background-color: #F2F2F2;
    float:center;
    width:15%;
    font-weight:bold;
    display:none;
    margin:auto;
    font-size:85%;    
}

.answerBtns{
    background-color: #ffffff;
    border: #666666 1px solid;
    color: black;
    font-weight:bold;
    display:none;
    cursor:pointer;
    font-size:85%;    
    }

#addQuestionBtn{
    font-weight:bold;
    height:30px;
    width:150px;    
    cursor:pointer;
    font-size:85%;
}

.questionTextArea{
    width:98%;
    resize:none;
    font-size:100%;
}

.showGrid{
    color:blue;
    text-decoration:underline;    
    cursor:pointer;
    padding-left:2px;
}

.optionTypeTbl{
    display:none;    
    background-color:white;
    position:absolute;  
    border:1px solid black;
    text-align:center;
}

.gridTxt{
    background-color: #F2F2F2;
    border-color: #ddd;
    float:left;
    font-weight:bold;
    width:50%;
    font-size:85%;
}    

.gridTxtRow{
    background-color: #F2F2F2;
    border-color: #ddd;
    float:center;
    font-weight:bold;
    width:50%;
    font-size:85%;
}    

.tblbody{
    background-color: #ddd;
    height: 400px;
    overflow: auto;    
}

.tblhead, .tblbody {
    display: block;
} 
```

​</p>

# iphone - 如何根据条件的满足情况通过按钮单击手动在 Storyboard 之间导航？

> ID：14007697
> 
> 赞同：0
> 
> 时间：2012-12-23T00:17:21.357
> 
> 标签：iphone, ios

我正在构建一个使用三个 UIViewControllers 的应用程序。我正在使用导航控制器进行导航。第一个视图控制器 (v1) 将有两个文本框和一个按钮。在按钮单击时，我有一个检查某些条件的功能，如果满足，那么我移动到第二个视图控制器（v2），否则我想移动到第三个视图控制器（v3）。如何通过代码实现？

最后一件事，我想捕获这些文本框值并在适当的视图控制器中使用它们。这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T04:02:47.813

在以编程方式过渡到情节提要中的另一个场景方面，一般过程是：

*   在视图控制器（不是按钮，而是视图控制器）之间定义一个 segue；

*   给那个segue一个故事板标识符；

*   为进行验证的按钮创建一个`IBAction`，如果成功，则执行

    ```
    [self performSegueWithIdentifier:@"myidentifier"]; 
    ```

请参阅[有关堆栈溢出](https://stackoverflow.com/questions/13982852/launch-a-uitableview-controller-from-uibar-buttons-created-dynamically/13995767#13995767)的答案，其中我详细介绍了个人完成此过程。如果是您的情况，听起来您正在验证数据，并且可能在给定一系列条件的情况下执行一个转场，并在另一系列条件下执行另一个转场。因此，只需为这两个 segues 提供唯一标识符，然后您就可以在`IBAction`代码中执行您想要的任何一个。

就将数据传递到下一个场景而言，您可以在一个单独的方法中执行此操作，`prepareForSegue`iOS 在创建目标控制器之后、呈现之前调用该方法。在这里，您有机会将参数传递给目标控制器。例如，我假设我捕获了个人的名字和姓氏，并希望将其传递给具有名字和姓氏属性的目标控制器：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"myidentifier"])
    {
        MyDestinationController *controller = segue.destinationViewController;
        controller.firstName = self.labelFirstName.text;
        controller.lastName = self.labelLastName.text;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T04:12:45.910

从 iOS 6.0 开始，您可以`-shouldPerformSegueWithIdentifier:sender:`在控制器中实现。比你在 iOS 5 中必须做的要简单得多。

# javascript - 发送 UTF 编码的 POST 请求

> ID：14007698
> 
> 赞同：-5
> 
> 时间：2012-12-23T00:17:23.340
> 
> 标签：javascript, ajax, django, unicode

> **可能重复：**
> [“ascii”编解码器无法解码字节（使用 django 时出现问题）](https://stackoverflow.com/questions/7520882/ascii-codec-cant-decode-byte-problem-when-using-django)

从 Chrome 扩展，我尝试发送一个 POST 请求：

```
var = encodeURIComponent(somevariable);

var parameters = "var=" + var;
mypostrequest.open("POST", "django/page/", true);
mypostrequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
mypostrequest.send(parameters); 
```

当 in 时`somevariable`，有一些 UTF-chars，它会中断

> “ascii”编解码器无法解码位置 14 中的字节 0xc4：序数不在范围内（128）

在 Django 中，我有：

```
some_var = form.cleaned_data['var'].replace('\n','') 
```

结果是错误的，因为`some_var`包含错误的字符：

```
some_var = u"blah blah blah z\u0142o\u017a" 
```

当然，应该是`u"blah blah blah złoź"`，但我真的不知道应该在哪里以及如何更改编码。

* * *

**关闭后更新：**

这个问题不是重复的 - 问题不在消息中。我在谷歌上搜索的次数比你想象的要多。

最重要的事情（我不明白）是

u"ł" 和 u"\u0142" 和 "\u0142"

所有这些意味着**几乎**相同，但并不相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:25:42.817

如果您实际上不使用 Unicode，您是否应该抱怨它？

```
some_var = form.cleaned_data['var'].replace(u'\n', u'') 
```

# java - Android SQLiteDatabase insert() 方法抛出空指针异常

> ID：14007699
> 
> 赞同：0
> 
> 时间：2012-12-23T00:17:39.377
> 
> 标签：java, android, sqlite, nullpointerexception

我写了一个方法，可以让你在数据库中添加一个“单词”。一旦我调用 addWord() 方法，它会在尝试 database.insert() 时引发 Null 指针异常。

```
public class DatabaseControl {

// columns for table
public static final String KEY_ROWID = "_id";
public static final String KEY_SYNID = "synsetID";
public static final String KEY_WORD = "synsetID";
public static final String KEY_DESCRIPTION = "description";
public static final String KEY_POPULARITY = "popularity";

// table name
public static final String DATABASE_TABLE = "wordnet"; // Name of the Database

private Context context;
private SQLiteDatabase database;
private DatabaseHelper dbHelper;

public DatabaseControl(Context context){
    this.context = context;
}

public DatabaseControl open() throws SQLiteException {
    dbHelper = new DatabaseHelper(context);
    database = dbHelper.getWritableDatabase();
    return this;
}

public void close(){
    dbHelper.close();
}

public long addWord (String synId, String word, String description, int popularity) {
    ContentValues setUpVals = createContentValues(synId, word, description, popularity);
    // SEEMS TO THROW NULL POINTER EXCEPTION
    return database.insert(DATABASE_TABLE, null , setUpVals); 
} 
```

我在这里调用这个方法：

```
private void populateDatabase(){
    try {
         long rowId = 0;
         rowId = dbControl.addWord("testSyn","","",1); // Add a row to the database for test
    } 
    catch (SQLiteException e){
      e.printStackTrace();
    } 
```

不太明白为什么会抛出这个错误，而且我不完全理解 insert() 中的第二个参数，所以据我所知可能是这样：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T08:25:07.773

试试这种方式：

```
private void populateDatabase()
{    
    try {
        long rowId = 0;         
        rowId = dbControl.addWord("testSyn",null,null,1); 
    } 
    catch (SQLiteException e){
        e.printStackTrace();
    } 
```

# javascript - 以 javascript 形式从用户输入定位 iframe src

> ID：14007702
> 
> 赞同：4
> 
> 时间：2012-12-23T00:18:00.703
> 
> 标签：javascript, forms, url, iframe, src

我正在尝试从 javascript 表单中定位 iframe 的源。因此，如果有人输入[http://www.reddit.com](http://www.reddit.com) iframe 的源代码将更改为 reddit.com 我已经尝试了一些方法，但您不能在 src 中放置脚本标签，那么有什么办法可以做到这一点用javascript，还是我需要做一个php echo函数？

```
<iframe  src="http://www.stachoverflow.com/"></iframe> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T00:23:44.840

你的意思是这样的吗？

```
<input type="url" placeholder="http://example.com/" /><button id="urlclick">Go</button>
<iframe id="frm"></iframe>

<script type="text/javascript">
  document.getElementById('urlclick').onclick = function() {
    document.getElementById('frm').src = this.previousSibling.value;
    return false;
  }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T10:56:46.713

通过使用jquery，我们可以这样做..

```
<input type="text" id="address">
<button onclick="get_url()"></button>
<iframe id="frm"></iframe>

<script>
function get_url()
{
var adr=$('#address').val();
$('#frm').attr('src', url);
}
</script> 
```

# delphi - Delphi - 位图边缘的渐变

> ID：14007713
> 
> 赞同：3
> 
> 时间：2012-12-23T00:20:07.137
> 
> 标签：delphi, graphics, fade

任何库/代码以渐变方式淡化位图的边缘？

像这样的东西：

![在此处输入图像描述](../Images/701af51ce131b951302a47340e317b86.png)

编辑：最终代码

好的，在您的示例之后提出了此代码，使用扫描线优化后速度提高了约 10 倍。理想情况下，我认为我应该将其转换为使用 32 位位图并修改实际的 alpha 层，但这目前有效，ty！

```
procedure FadeEdges(b: TBitmap; Depth, Start, Col: TColor);
Var f, x, y, i: Integer;
    w,h: Integer;
    pArrays: Array of pRGBArray;
    xAlpha: Array of byte;
    sR, sG, sB: Byte;
    a,a2: Double;
    r1,g1,b1: Double;
    Lx,Lx2: Integer;
procedure AlphaBlendPixel(X, Y: Integer);
begin
  pArrays[y,x].rgbtRed   := Round(r1 + pArrays[y,x].rgbtRed   * a2);
  pArrays[y,x].rgbtGreen := Round(g1 + pArrays[y,x].rgbtGreen * a2);
  pArrays[y,x].rgbtBlue  := Round(b1 + pArrays[y,x].rgbtBlue  * a2);
end;
procedure AlphaBlendRow(Row: Integer; Alpha: Byte);
Var bR, bG, bB, xA: Byte;
    t: Integer;
    s,s2: Double;
begin
  s  := alpha / 255;
  s2 := (255 - Alpha) / 255;

  for t := 0 to b.Width-1 do begin
    bR := pArrays[Row,t].rgbtRed;
    bG := pArrays[Row,t].rgbtGreen;
    bB := pArrays[Row,t].rgbtBlue;
    pArrays[Row,t].rgbtRed   := Round(sR*s + bR*s2);
    pArrays[Row,t].rgbtGreen := Round(sG*s + bG*s2);
    pArrays[Row,t].rgbtBlue  := Round(sB*s + bB*s2);
  end;
end;
begin
  b.PixelFormat := pf24bit;

  // cache scanlines
  SetLength(pArrays,b.Height);
  for y := 0 to b.Height-1 do
   pArrays[y] := pRGBArray(b.ScanLine[y]);

  // pre-calc Alpha
  SetLength(xAlpha,Depth);
  for y := 0 to (Depth-1) do
   xAlpha[y] := Round(Start + (255 - Start)*y/(Depth-1));

  // pre-calc bg color
  sR := GetRValue(Col);
  sG := GetGValue(Col);
  sB := GetBValue(Col);

  // offsets
  w := b.Width-Depth;
  h := b.Height-Depth;

  for i := 0 to (Depth-1) do begin
    a  := xAlpha[i] / 255;
    a2 := (255 - xAlpha[i]) / 255;
    r1 := sR * a;
    g1 := sG * a;
    b1 := sB * a;
    Lx  := (Depth-1)-i;
    Lx2 := i+w;
    for y := 0 to b.Height - 1 do begin
      AlphaBlendPixel(Lx, y); // Left
      AlphaBlendPixel(Lx2, y); // right
    end;
  end;

  for i := 0 to (Depth-1) do begin
    AlphaBlendRow((Depth-1)-i, xAlpha[i]); // top
    AlphaBlendRow(i+(h), xAlpha[i]); // bottom
  end;

  SetLength(xAlpha,0);
  SetLength(pArrays,0);
end; 
```

最终结果：（左 = 原始，右 = 悬停时与 ListView 混合）

![在此处输入图像描述](../Images/d05f792dd8d192259b9c80187322e418.png)

编辑：进一步的速度改进，速度是原始过程的两倍。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T11:30:30.107

我可以给你一些我几年前写的代码来实现这一点。作为指南，它可能很有用。该代码是操作位图的类的一部分，这是将位图的左边缘淡化为白色背景的部分：

```
procedure TScreenShotEnhancer.FadeOutLeft(Position, Start: Integer);
var
  X, Y: Integer;
  F, N: Integer;
  I: Integer;
begin
  BeginUpdate;
  try
    N := Position;
    for I := 0 to N - 1 do begin
      X := Position - I - 1;
      F := Round(Start + (255 - Start)*I/N);
      for Y := 0 to Height - 1 do
        AlphaBlendPixel(X, Y, clWhite, F);
    end;
  finally
    EndUpdate;
  end;
end; 
```

实际工作是在这种方法中完成的：

```
procedure TScreenShotEnhancer.AlphaBlendPixel(X, Y: Integer; Color: TColor;
    Alpha: Byte);

var
  backgroundColor: TColor;
  displayColor: TColor;
  dR, dG, dB: Byte;
  bR, bG, bB: Byte;
  sR, sG, sB: Byte;
begin
  backgroundColor := Bitmap.Canvas.Pixels[X, Y];
  bR := GetRValue(backgroundColor);
  bG := GetGValue(backgroundColor);
  bB := GetBValue(backgroundColor);
  sR := GetRValue(Color);
  sG := GetGValue(Color);
  sB := GetBValue(Color);

  dR := Round(sR * alpha / 255 + bR * (255 - alpha) / 255);
  dG := Round(sG * alpha / 255 + bG * (255 - alpha) / 255);
  dB := Round(sB * alpha / 255 + bB * (255 - alpha) / 255);
  displayColor := RGB(dR, dG, dB);
  Bitmap.Canvas.Pixels[X, Y] := displayColor;
end; 
```

# c# - 复制不支持复制功能的动态对象的最快方法

> ID：14007715
> 
> 赞同：8
> 
> 时间：2012-12-23T00:20:20.850
> 
> 标签：c#, .net, optimization, copy

首先，我们可能都同意最好的方法是在自定义对象/实体中实现 Copy 功能。但是考虑一下这种情况。我们没有这个选项，我们不想编写将精确复制实体的特定函数，因为将来实体将被更改，因此我们的复制函数将失败。

这是当前实体的简化版本：

```
[Serializable]
class MyEntity
{
    public MyEntity()
    { 
    }

    public MyEntity(int id, string name)
    {
        this.Id = id;
        this.Name = name; 
    }

    public int Id { get; set; }

    public string Name { get; set; }

    public MyEntity Copy()
    {
        throw new NotImplementedException();
    }
} 
```

为了满足上述所有要求，我提出了两个解决方案：

```
 //original...
        MyEntity original = new MyEntity() { Id = 1, Name = "demo1" };

        //first way to copy object...
        List<MyEntity> list = new List<MyEntity>() { original};
        MyEntity copy1 = list.ConvertAll(entity => new MyEntity(entity.Id, entity.Name))[0];

        //second way to copy object...
        byte[] bytes = SerializeEntity(original);
        MyEntity copy2 = (MyEntity)DeserializeData(bytes);

    byte[] SerializeEntity(object data)
    {
        byte[] result = null;
        using (MemoryStream ms = new MemoryStream())
        {
            BinaryFormatter formatter = new BinaryFormatter();
            formatter.Serialize(ms, data);
            result = ms.ToArray();
        }
        return result;
    }

    object DeserializeData(byte[] data)
    {
        object result = null;
        using(MemoryStream ms = new MemoryStream(data))
        {
           BinaryFormatter formatter = new BinaryFormatter();
           result = formatter.Deserialize(ms); 
        }
        return result;
    } 
```

现在的问题。幕后最佳解决方案是什么，为什么是第一还是第二？考虑到上述要求，有没有更好的方法来进行精确复制？将大量复制。

**PS注意：** 我知道第一种方式基本上已经是Honza指出的复制功能。我有点像序列化和自定义复制功能一样快的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-23T01:19:04.833

> 首先，我们可能都同意最好的方法是在自定义对象/实体中实现 Copy 功能。

我不同意。我讨厌每次都写这样的方法。这是我使用扩展方法的建议：

```
public static T Copy<T>(this T obj)
    where T : class
{
    using (MemoryStream stream = new MemoryStream())
    {
        BinaryFormatter formatter = new BinaryFormatter();
        formatter.Serialize(stream, obj);

        stream.Seek(0, SeekOrigin.Begin);
        return formatter.Deserialize(stream) as T;
    }
} 
```

这基本上是您的第二个解决方案，但略有优化。无需将 MemoryStream 复制到字节数组，然后从中创建另一个 MemoryStream。

最好的事情是它是通用的，可以与具有该`[Serializable]`属性的每个对象一起使用。而且我很确定它比您必须访问每个属性的第一个解决方案更快（尽管我没有测量）。

**编辑：**

好的，我现在确实做了一些测量。我对性能的第一个假设是完全错误的！

我用随机值创建了 1000000 个 MyEntity 对象，然后复制了它们（我还考虑`Honza Brestan`了关于深拷贝和浅拷贝的提示）：

带二进制格式化程序的
深拷贝：14.727 秒 带复制方法的深拷贝：0.490 秒
带反射的浅拷贝：5.499 秒
带复制方法的浅拷贝：0.144 秒

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T01:45:28.630

第一次尝试和编写自己的 Copy 方法有什么区别？

```
public MyEntity Copy()
{
    return new MyEntity(this.Id, this.Name);
} 
```

对我来说，这看起来比你的收集尝试更好，无论如何它完全一样 - 在这两种情况下你都必须明确命名所有属性。

如果你不能修改实体类本身，你仍然可以创建一个扩展方法（放置在一个你想使用复制逻辑的地方可见的静态类中）

```
public static MyEntity Copy(this MyEntity source)
{
    return new MyEntity(source.Id, source.Name);
} 
```

至于第二次尝试，你考虑过两者的不同吗？它们并不完全相同。第一个创建一个**浅**拷贝，而第二个（假设整个对象树是可序列化的）产生一个**深**拷贝。不同之处在于它的属性是否也被复制，或者原始对象和它的副本都引用相同的对象。这同样适用于 pescolino 的版本，顺便说一句，它看起来非常不错。

所以问题是你想要/需要哪个副本。

对于真正动态（但可能不太有效）的**浅**拷贝方法，我认为您需要使用反射，枚举所有属性并将它们的值从原始对象复制到副本。非完整的演示版本可能如下所示：

```
public static MyEntity Copy(this MyEntity source)
{
    var result = new MyEntity();

    var properties = source.GetType().GetProperties(
          BindingFlags.Instance | BindingFlags.Public);

    foreach (var property in properties)
    {
        var val = property.GetValue(source, null);
        property.SetValue(result, val, null);
    }

    return result;
} 
```

这种方法有其自身的问题，即性能，偶尔需要处理特殊情况（索引器，非公共属性......），但可以完成工作并且也适用于不可序列化的对象。通用版本也很容易做到——这取决于你，你是否需要它。

同样值得注意的是，因为我和 pescolino 都建议使用扩展方法，所以它们可能存在问题。如果您的实体确实包含`Copy`与扩展具有相同签名的方法，编译器将决定使用它而不是扩展。这显然会`NotImplementedException`在调用时抛出。因此，如果是这种情况（而且不仅仅是您的示例代码），它可能是一个严重的“陷阱”。在这种情况下，唯一的解决方案是更改扩展方法的签名，最好是更改其名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T04:28:35.930

您可以尝试使用[AutoMapper](http://automapper.org/)：

```
Mapper.CreateMap<MyEntity, MyEntity>();

...

var copy3 = Mapper.Map<MyEntity, MyEntity>(original); 
```

# android - 在进程运行时在 Asnyctask 中运行进度对话框

> ID：14007716
> 
> 赞同：0
> 
> 时间：2012-12-23T00:20:25.860
> 
> 标签：android, android-asynctask, progressdialog

我正在尝试运行以下代码，但我想在我的进程运行时显示一个进度对话框：

```
public boolean isOnline() {
    cm = (ConnectivityManager) mContext.getSystemService(mContext.CONNECTIVITY_SERVICE);
    netInfo = cm.getActiveNetworkInfo();

    progress_thread = new progress_thread();
    progress_thread.execute();

    isconnected = false;
    if (netInfo != null && netInfo.isConnected()) {
        try{
            URL url = new URL("http://www.google.com");
            HttpURLConnection urlc = (HttpURLConnection) url.openConnection();
            urlc.setConnectTimeout(3000);
            urlc.connect();
            if (urlc.getResponseCode() == 200)  isconnected = true;

        }catch (MalformedURLException e1) {
            e1.printStackTrace();
        }catch (IOException e) {
            e.printStackTrace();
        }
    }

    progress_thread.cancel(true);
    if (!isconnected) Toast.makeText(mContext,"Internet Connexion Error", Toast.LENGTH_LONG).show();

    return isconnected; 
```

```
private class progress_thread extends AsyncTask<Void, Integer, Boolean>{

    protected void onPreExecute() { 

        dialog = new ProgressDialog(mContext); 
        dialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
        dialog.setMessage("Loading Tracker...");
        dialog.setCancelable(false);
        dialog.show();
    }

    protected Boolean doInBackground(Void... params) {
        try {
            Thread.sleep(60000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return true;
    }

    protected void onCancelled() {
        if (dialog.isShowing()) dialog.dismiss();
    }

    protected void onPostExecute(Boolean result_ex) {
        if (dialog.isShowing()) dialog.dismiss();
    }
} 
```

我想要做的是在检查是否有互联网连接时运行进度对话框。但我遇到的问题是 UI 没有刷新，并且进度对话框没有像我想要的那样显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T00:58:15.130

你这样做的方式通过检查互联网连接来占用 UI 线程。这使得窗口管理器无法处理您的`ProgressDialog`.

您应该将此检查连同显示进度对话框一起移至`AsyncTask`，如下所示：

```
private void startOnlineCheck() {
    ProgressThread progress_thread = new ProgressThread();
    progress_thread.execute();
}

private class ProgressThread extends AsyncTask<Void, Void, Void>{
    ProgressDialog dialog;

    protected void onPreExecute() { 
        dialog = new ProgressDialog(Activity.this); 
        dialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
        dialog.setMessage("Loading Tracker...");
        dialog.setCancelable(false);
        dialog.show();
    }

    protected Void doInBackground(Void... params) {
        ConnectivityManager cm = (ConnectivityManager) Activity.this.getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo netInfo = cm.getActiveNetworkInfo();
        if (netInfo != null && netInfo.isConnected()) {
            try{
                URL url = new URL("http://www.google.com");
                HttpURLConnection urlc = (HttpURLConnection) url.openConnection();
                urlc.setConnectTimeout(3000);
                urlc.connect();
                // CODE to run when we're online
                return null;
            }catch (MalformedURLException e1) {
                e1.printStackTrace();
            }catch (IOException e) {
                e.printStackTrace();
            }
        }
        Toast.makeText(Activity.this, "Internet Connexion Error", Toast.LENGTH_LONG).show();
        // CODE to run when there's no connection
        return null;
    }

    protected void onPostExecute(Void result) {
        if (dialog.isShowing()) dialog.dismiss();
    }
} 
```

您还可以将`Context`in 构造函数传递给`ProgressThread`.

请记住，如果`ProgressThread`是 的内部类`Activity`（通常是这种情况），您可以从 的任何方法调用该活动的任何方法`ProgressThread`。

# java - 创建武器类和战斗类

> ID：14007723
> 
> 赞同：2
> 
> 时间：2012-12-23T00:22:28.090
> 
> 标签：java, arrays, class, random

我正在创建一个基于文本的游戏，但我遇到了一些问题。这就是我目前所拥有的。到目前为止，我有一个战斗类，以及两个不同武器的两个类。我正在尝试为武器本身分配生命值。但我最大的问题是在战斗课上。我正在尝试创建它，以便在随机时间随机掉落武器以及随机武器。到目前为止，在战斗课上我有这个：

```
public class Combat {
    final int chanceOfDrop = 3;
    static Weapons[] wepArray = {new M4(), new M16()}
    static boolean[] hasWeapon = {false, true};

    public static int  ranNumberGen(int chanceOfDrop) {
        return (int) (Math.random()*1); 
    }

    private void enemyDead() {
        boolean canDrop = false;
        if(ranNumberGen(chanceOfDrop)==0){
            canDrop = true;

        }

        if(canDrop == true){
            givePlayerWeapon(Weapon[Combat.ranNumberGen(Weapons.length)]);
        }

        private static void givePlayerWeapon(int w) {
            hasWeapon[w] = true;

            for w <(Weapons.length-1) {
                if has weapon[w] {
                    System.out.println(wepArray[w].getWeaponName);
                }
                }
        }
    }

    }
} 
```

我在创建新的 M4() 时遇到问题，新的 M16() 显示类型不匹配：无法将 M4 形式转换为武器。我确实有一个名为 Weapons 的课程，这可能是问题吗？

这是我的 M4 类，M4 和 M16 类是相同的

```
public abstract class M4 {
  private Integer weaponDamage = 5;
  private Integer weaponAmmo = 25;
  private String weaponName = "M4";

  public M4(String name, int ammo, int damage) {
    name = weaponName;
    ammo = weaponAmmo;
    damage = weaponDamage;
  }

  public String getWeaponName() {
    return weaponName;
  }

  public Integer getAmmo() {
    return weaponAmmo;
  }

  public Integer getDamage() {
    return weaponDamage;
  }
} 
```

我不认为我在这里有任何问题。不过，也许我的问题就在于此。虽然，我有一个武器课，但什么都没有。我需要那个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:50:00.163

乍一看要解决的一些问题：

*   创建一个通用的 Weapon 类，它定义了适用于每种武器的一些属性，例如名称、伤害、弹药、范围乘数等……然后为 Weapon 创建子类，例如 M4 和 M16，它们指定属性并最终添加特定于武器特性。
*   将括号添加到此行：

    ```
    System.out.println(wepArray[w].getWeaponName); // Change to getWeaponName() 
    ```

*   从 M4 中删除`abstract`关键字。

*   修复 ranNumberGen 方法，因为它现在总是返回 0。`Math.random()`返回 [0,1[ 范围内的浮点数。这意味着将其转换为 int 将始终导致 0。将其乘以*n以在 [0,* *n* [范围内获得随机 int 。你可能想要这个：

    ```
    public static int ranNumberGen(int max) {
        return (int) (Math.random() * max); 
    } 
    ```

*   更改此行：

    ```
    givePlayerWeapon(Weapon[Combat.ranNumberGen(Weapons.length)]); 
    ```

    至：

    ```
    givePlayerWeapon(wepArray[Combat.ranNumberGen(wepArray.length)]); 
    ```

*   -loop的语法`for`如下：

    ```
    for (variable-initialization; condition; increment) 
    ```

    所以在你的情况下，你想要：

    ```
    for (int i = 0; i < hasWeapon.length; ++i)
    {
        if (hasWeapon[i]) System.out.println(wepArray[i].getWeaponName());
    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T01:10:30.820

在为时已晚之前，您可能需要重新考虑对游戏对象使用继承式层次结构的决定。

在实践中，我发现组件实体模型和/或原型模型更有效。您可以查看我的旧 Java roguelike 游戏 Tyrant 中的代码以获得灵感：

*   武器定义：mikera/tyrant/Weapon.java（Github 现已关闭，因此无法找到确切的链接，但对 Google 来说应该很容易）

这个想法是您通过在类似地图的游戏对象中设置属性/组合组件来制作对象，而不是使用静态继承。

当您想在此模型中创建随机武器时，您只需获取所有可能武器原型的列表，然后随机克隆其中一个以制作新武器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T00:48:23.273

“公共抽象类 M4”中抽象的意思是你不能用这个类创建一个新对象。因此，您可以将武器的所有公共字段放在武器类中，并使 m4 和 m16 扩展武器，您的代码将编译。

# android - Android 权限 - 陀螺仪支持与 OpenGL ES2

> ID：14007725
> 
> 赞同：0
> 
> 时间：2012-12-23T00:23:09.987
> 
> 标签：android, android-manifest, google-play, gyroscope, android-market-filtering

我在我的 Android 清单中添加了一个必需的陀螺仪和 OpenGL ES2 支持，现在市场上似乎淘汰了更多的设备。

有谁知道为什么 ICS 上的 Motorola Droid4 不支持陀螺仪？制造商列出它支持它，并且 ICS 足够高以支持陀螺仪，而不是需要通过磁场和加速度计进行插值的 Froyo

陀螺仪android-market-filtering到底是怎么做的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T01:41:30.463

在清单中添加这一行

```
 <uses-feature android:name="android.hardware.sensor.gyroscope" android:required="false" /> 
```

所以你的应用不会被过滤，如果你的应用在没有陀螺仪的情况下无法运行，你可以在应用描述中添加通知。否则，您对 Google 说这是使用该应用程序所必需的功能，并且所有设备都会根据 Google DB 进行过滤。

顺便说一句，[摩托罗拉 Droid 4似乎](http://www.motorola.com/us/consumers/DROID-4-by-Motorola/88569,en_US,pd.html?selectedTab=tab-2&cgid=mobile-phones#tab) **没有**任何陀螺仪。

> *传感器 接近度、环境光、电子罗盘、电池温度、加速度计*

# c# - CssStyleCollection 类：通过反射访问属性

> ID：14007727
> 
> 赞同：1
> 
> 时间：2012-12-23T00:23:49.193
> 
> 标签：c#, reflection

如何使用反射访问 CssStyleCollection 类属性（最重要的是我对它的键值集合感兴趣）？

```
// this code runns inside class that inherited from WebControl
PropertyInfo[] properties = GetType().GetProperties();

//I'am not  able to do something like this
  foreach (PropertyInfo property in properties)
  {
     if(property.Name == "Style")
     {
        IEnumerable x = property.GetValue(this, null) as IEnumerable;
        ...
     }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T00:33:37.800

`Style`以下是通过反射获取属性的语法：

```
PropertyInfo property = GetType().GetProperty("Style");
CssStyleCollection styles = property.GetValue(this, null) as CssStyleCollection;
foreach (string key in styles.Keys)
{
    styles[key] = ?
} 
```

请注意，[`CssStyleCollection`](http://msdn.microsoft.com/en-us/library/system.web.ui.cssstylecollection.aspx)它没有实现 IEnumerable （它实现了索引运算符），所以你不能将它转换为那个。如果你想获得一个 IEnumerable，你可以使用`styles.Keys`, 和值来提取键：

```
IEnumerable<string> keys = styles.Keys.OfType<string>();
IEnumerable<KeyValuePair<string,string>> kvps 
    = keys.Select(key => new KeyValuePair<string,string>(key, styles[key])); 
```

# php - MySQL - 在输出时使用关系表在表连接上获取重复行

> ID：14007728
> 
> 赞同：0
> 
> 时间：2012-12-23T00:24:11.477
> 
> 标签：php, mysql, join, duplicates

我正在制作一个音乐网站，其中将有一个 CMS 来添加新歌曲，访问者可以在新闻源上查看/播放歌曲或按艺术家/歌曲浏览/搜索。从这里开始，歌曲被称为曲目。

数据库如下所示：

轨道

编号 | 标题 | 艺术家 | 年份 | 路径_mp3 | 路径_ogg | 约会时间

艺术家

编号 | 艺术家（我有这张表，因为我想稍后添加其他艺术家信息。）

track2艺术家

track_id | 艺术家 ID

有些曲目有两个或更多的艺术家，这些艺术家每个人都有自己的独奏曲目。因此，我想将这些艺术家保留为单独的实体，以便用户可以相应地浏览它们，但在适用时，显示多个艺术家对同一首歌曲负责。

当我在包含多个艺术家的新闻提要上输出曲目时，我想链接到一个页面，该页面仅抓取两位艺术家贡献的曲目，如果访问者点击其中一位艺术家，则从该页面转到个人艺术家页面。

[http://www.discogs.com/search?q=cid+inc+and+victor+hugo&type=all](http://www.discogs.com/search?q=cid+inc+and+victor+hugo&type=all)

比如你点击这个链接，选择最上面的搜索结果，就可以看到我要找的效果。艺术家链接在登录页面上是分开的。

我当前的代码得到的是，在 track2artist 表中有多个条目（通过有多个艺术家）的曲目被多次显示。我希望每首曲目只出现一次，但仍然知道是否有多个艺术家，以及他们的 id 是什么。

我已经尝试在 sql 语句的末尾包含“group by tracking.id”，它实际上只选择每个语句一次。但是，这无法在 track2artist 中获取任何多个艺术家 ID 条目，因此当用户单击时我无法传递这些多个艺术家 ID。

我需要新的 SQL 语法还是在我的 PHP 中？我正在尝试尽可能少地调用数据库，因为我知道这是推荐的。

我很感激这方面的任何帮助。这可能在其他地方有所介绍，但是在搜索时，我在尝试理解其他示例时相当困惑。感谢您抽时间阅读。

```
$conn = dbConnect('read');

$sql = "SELECT * FROM tracks INNER JOIN track2artist ON tracks.id = track2artist.track_id";
$result = $conn->query($sql) or die (mysqli_error($conn));
?>
<table id="feed">
    <?php
    while($track = $result->fetch_assoc()) {    
    ?>
        <tr>
        <td><a href="javascript:;" id="playlist-add-track-id-<?php echo $track['id']; ?>">
        <img src="/assets/img/add_track.gif" class="add_track_icon"></a></td>
        <td><?php echo $track['title']; ?> by <a href="/?page=artist&artist_id=<?php echo $track['artist_id']; ?>">
        <?php echo $track['artist']; ?></a></td>
        </tr>

<?php } ?>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:32:56.990

使用`DISTINCT`关键字，加入时不会返回重复项。

```
$sql = "SELECT DISTINCT * FROM tracks INNER JOIN track2artist ON tracks.id = track2artist.track_id"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:49:05.827

由于您在不同的表中有多个作者的歌曲，因此您将不止一次列出这些曲目。[对于使行不同的每条数据一次]

你想要返回的是这样的

```
 track          artist
                artist
                artist

 track          artist
                artist

 track          artist

 track          artist 
```

然而 mysql 只会返回 FULL ROWS 意思是每条数据它会返回一整行信息。为了保持低查询，最好在数据库返回信息后对信息进行分组。

我会说不是立即输出，而是将其作为您的数据库解析循环

```
<?php
 while($track = $result->fetch_assoc()) {
      $tracklist[$track['id']]['title'] = $track['title'];
      $tracklist[$track['id']]['artists'][$track['artist_id']] = $track['artist'];
 } 
```

这会将您的数组压缩成您期望找到的格式，顺便说一句，您还必须在轨道数组中迭代艺术家数组以显示与每个轨道关联的所有艺术家。

# sublimetext2 - 如何设置 Sublime Text 2 状态栏的高度，或获取其历史记录？

> ID：14007731
> 
> 赞同：1
> 
> 时间：2012-12-23T00:24:46.287
> 
> 标签：sublimetext2

我目前正在使用带有 ST2 的[Sublime Code Intel](https://github.com/Kronuz/SublimeCodeIntel)插件。尝试添加额外的 python 路径，但它不起作用。因此，我尝试进行一些调试，并注意到插件在构建索引时打印了 ST2 状态栏中正在搜索的路径。问题是，很多消息传递得太快了。我刚开始使用这个编辑器，到目前为止，我不知道如何扩展状态栏的高度——所以我可以向上滚动一些命令——或者查看某种状态栏历史记录。事实上，我只能看到状态栏中记录的最后一件事，这对于调试我的问题不是很有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T07:17:45.313

The [console](https://sublime-text-unofficial-documentation.readthedocs.org/en/latest/basic_concepts.html?highlight=console#the-python-console-and-the-python-api) provides useful debug info. You can also use it to enter Python commands.

To open: `ctrl` + ```

or

`View>Show Console`

# xml - wordpress 网站提要上的 XML 解析错误？

> ID：14007732
> 
> 赞同：0
> 
> 时间：2012-12-23T00:24:51.137
> 
> 标签：xml, wordpress, rss

[我在wordpress 网站](http://projectsilkworm.com/feed/)上的提要中收到以下错误。这是什么原因造成的，我该如何解决？

`XML Parsing Error: XML or text declaration not at start of entity Location: http://projectsilkworm.com/feed/ Line Number 2, Column 1:`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:27:38.153

xml 提要的开头有一个空行 - Chrome 在打开提要时显示相同的错误。以下行必须是 xml 中文本的第一位：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

您可以在源处修复错误，也可以`trim`在尝试解析数据之前修复它。

问题的根源可能是您的 wordpress 主题或插件。

进入您的主题文件夹并编辑`header.php`文件 - 确保`<!DOCTYPE`声明是第一行，并且之前没有空格。

如果这不起作用，请尝试一一停用任何插件，以查看其中一个是否导致问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-26T05:49:18.233

我有同样类型的问题。我更新了 wordpress 版本，然后它工作正常。您可以更新您的 wordpress 版本。

谢谢

# iphone - 在 GCD 块中绘制图像时卡顿

> ID：14007738
> 
> 赞同：1
> 
> 时间：2012-12-23T00:25:48.670
> 
> 标签：iphone, ios, cocoa-touch, core-animation, grand-central-dispatch

我有以下方法，它需要一些`CAShapeLayers`并将它们转换为`UIImage`. 用于单元格`UIImage`中的 a `UITableView`（很像从您的一个库中选择照片时的照片应用程序）。这个方法是从一个`GCD`块中调用的：

```
-(UIImage*) imageAtIndex:(NSUInteger)index
{
    Graphic *graphic = [[Graphic graphicWithType:index]retain];

    CALayer *layer = [[CALayer alloc] init];
    layer.bounds = CGRectMake(0,0, graphic.size.width, graphic.size.height);
    layer.shouldRasterize = YES;
    layer.anchorPoint = CGPointZero;
    layer.position = CGPointMake(0, 0);

    for (int i = 0; i < [graphic.shapeLayers count]; i++)
    {
        [layer addSublayer:[graphic.shapeLayers objectAtIndex:i]];
    }

    CGFloat largestDimension = MAX(graphic.size.width, graphic.size.height);
    CGFloat maxDimension = self.thumbnailDimension;
    CGFloat multiplicationFactor = maxDimension / largestDimension;
    CGSize graphicThumbnailSize = CGSizeMake(multiplicationFactor * graphic.size.width, multiplicationFactor * graphic.size.height);

    layer.sublayerTransform = CATransform3DScale(layer.sublayerTransform, graphicThumbnailSize.width / graphic.size.width, graphicThumbnailSize.height / graphic.size.height, 1);
    layer.bounds = CGRectMake(0,0, graphicThumbnailSize.width, graphicThumbnailSize.height);

    UIGraphicsBeginImageContextWithOptions(layer.bounds.size, NO, 0);
    [layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *image = [UIGraphicsGetImageFromCurrentImageContext() retain];
    UIGraphicsEndImageContext();

    [layer release];
    [graphic release];

    return [image autorelease];
} 
```

无论出于何种原因，当我滚动`UITableView`并加载图像时，它有点口吃。我知道`GCD`代码很好，因为它以前工作过，所以看起来这段代码中的某些东西导致了口吃。有谁知道那可能是什么？不是`CAAnimation`线程安全的吗？或者有没有人知道更好的方法来获取一堆`CAShapeLayers`并将它们转换成一个`UIImage`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T19:19:15.553

最后我相信：

```
[layer renderInContext:UIGraphicsGetCurrentContext()]; 
```

无法在单独的线程上完成，因此我必须执行以下操作：

```
UIGraphicsBeginImageContextWithOptions(imageSize, NO, 0);
CGContextRef context = UIGraphicsGetCurrentContext();
//draw the mutable paths of the CAShapeLayers to the context
UIImage *image = [UIGraphicsGetImageFromCurrentImageContext() retain];
UIGraphicsEndImageContext(); 
```

[在WWDC2012](https://developer.apple.com/videos/wwdc/2012/)视频“Building Concurrent User Interfaces on iOS”中有一个很好的例子（我学会了这样做）

# android - Android：尝试将 RSA 公钥添加到我的 android apk

> ID：14007745
> 
> 赞同：0
> 
> 时间：2012-12-23T00:27:26.190
> 
> 标签：android

我正在尝试添加当我尝试下载我的 apk 文件时提供给我的 RA 公钥。我得到了以下指示 1\. 左键单击项目名称 2\. 单击导出。

将有一个选项包括安全密钥。

当我这样做时，我只提供了 2 个选项，即 1\. 使用现有的密钥库 2\. 创建新的密钥库。

我没有看到任何包含 RA 公钥的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T03:11:13.610

对不起，我真的很困惑，我认为许可密钥应该用于对它进行编码。

# php - PHP重定向到URL中带有变量的页面

> ID：14007750
> 
> 赞同：1
> 
> 时间：2012-12-23T00:27:52.037
> 
> 标签：php, get, include

我有一个页面，`q.php`即用户提交的由其 id 定义的帖子（例如，将是使用该变量从数据库中提取所有其余信息`q.php?id=1`的某个帖子）。`$id`

我正在尝试在同一页面上编写评论提交，并考虑到用户可能不会在该字段中输入任何内容的事实。如果发生这种情况，我希望页面（例如`q.php?id=1`）再次加载并显示错误消息。

我可以使用一个空变量来执行错误消息，然后由表单激活的 php 文件给出一个值。但是，我在导航回特定帖子时遇到问题。我尝试使用`include('q.php?id=$id)`where $id is set to a number，但我知道这不是它的目的，它不接受变量

我应该改用什么？

**编辑**

answer.php（表单激活的文件）：

```
require 'q.php';
$_GET['id'] = $id;
$_SESSION['error'] = "Please fill in all of the fields."; 
```

q.php：

```
if ($_SESSION['error'] !== 0) {
    echo "<p style='color: #AA1111;'>".$_SESSION['error']."</a>";
    unset($_SESSION['error']); // this isn't happening...
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T00:28:59.200

如果您确实必须包含内联页面，您可以随时修改`$_GET`：

```
$_GET['id'] = $id;
require 'q.php'; 
```

但是错误消息听起来像是可以通过会话变量或重定向来完成。重定向可能类似于：

```
header('Location: q.php?id=' . $id . '&error=The+error');
exit(); 
```

然后，您检查`$_GET['error']`. `q.php`为此使用会话变量将大致相同，除了不是添加`error`为查询字符串参数，而是立即使用`$_SESSION['error']`它`unset`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T00:30:14.303

您可以使用`header("Location: q.php?id=$id"); exit;`，但您需要其他方式来发送错误消息（例如：将其保存在`$_SESSION`）

您也许可以根据需要设置`$_GET`数组 - 在这种情况下，`$_GET = Array("id"=>$id);`然后`include("q.php")`. 但是，这通常被认为是 haxy，如果使用`include_once`不当，可能会导致问题。

# jquery - jQuery UI 对话框将变量返回给 Box

> ID：14007751
> 
> 赞同：0
> 
> 时间：2012-12-23T00:28:06.240
> 
> 标签：jquery, ajax, dialog

我有一个脚本，可以在其中打开一个带有表单的 jQuery 对话框。我通过 ajax 将表单的值发送到 php 脚本。php 脚本将值保存在 mysql 数据库中。

一切正常。但：

在这种情况下，mysql的插入有问题，我会给用户一个信息。但不仅“是错误的”。例如，我想返回“已经存在”、“错误的参数”等。

如何将 php 脚本中的信息返回给 jQuery 对话框？

我的脚本如下所示：

```
 function openmodal() {   
      var $dialogContent = $("#create_mieter"),    
      mieterID = $("#mieterID"),
      snID = $( "#snID" ),
      mietwechsel = $("#datepicker"),
      zahlart = $("#zahlart");

      $dialogContent.dialog({
        height: "auto",
        width: 500,
        modal: true,
        resizable: false,
        title: "Neues Mietverhältnis anlegen",
        close: function() {},
        buttons: {
            Sichern : function() {
                $.ajax({
                type: "POST",
                url: "wohnungen_bearbeiten_mieter_sichern.php?act=create",
                data: "mieterID=" + mieterID.val() + "&snID=" + snID.val() + "&mietwechsel=" + mietwechsel.val() + "&zahlart=" + zahlart.val(),
                        success: function(response) {
                            alert("Show Success");                          
                        },
                        error: function() {
                            alert("Sorry something went wrong");    
                        }
                });
            $( this ).dialog( "close" );
            },
         Abbrechen : function() {  $( this ).dialog( "close" ); }
         }
      }).show();

      $("#ui-datepicker-div").css("z-index", "99999"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T00:40:45.007

都是关于“响应”的，对吗？

例如，您希望它向您显示用户选择的电子邮件已在使用中。因此，在您将通过 ajax 请求的文件中，您应该进行验证，一旦我的“响应”是这样的，我就这样做了：

它验证电子邮件，并查询它以查看它是否正在使用，如果是，则响应将为 1，否则将为 0，如果发生另一种错误，则响应将是错误本身

然后回到 ajax 函数，我会验证响应，它对我有用，希望它对你有用

抱歉英语不好，不是母语;D

# ios - 多语言 NSString 的奇怪错误。也许是编码问题

> ID：14007753
> 
> 赞同：1
> 
> 时间：2012-12-23T00:28:19.870
> 
> 标签：ios, encoding, ios6, nsstring

我认为 NSString 具有多语言支持的奇怪错误。

我在 iOS SDK 6.0 中开发，在模拟器和 iPhone 上都存在同样的问题。

这是我的代码。

```
 NSString* localPath = [documentsPath stringByAppendingPathComponent:filename];
 NSLog(@"%@",localPath);
 NSLog(@"%@",@"/Users/vicjames/Library/Application Support/iPhone Simulator/6.0/Applications/8186A14C-1482-44AB-AD3A-0A88DC40EC89/Documents/Data/해부학/11월 29일/095\. Michael Learns to Rock - 25 Minutes.mp3");

 NSLog(@"localPath Length:%d",[localPath length]);
 NSLog(@"String Length:%d",[@"/Users/vicjames/Library/Application Support/iPhone Simulator/6.0/Applications/8186A14C-1482-44AB-AD3A-0A88DC40EC89/Documents/Data/해부학/11월 29일/095\. Michael Learns to Rock - 25 Minutes.mp3" length]);

 NSLog(@"localPath : URL: %@",[[NSURL fileURLWithPath:localPath] absoluteString]);
 NSLog(@"String URL: %@",[[NSURL fileURLWithPath:@"/Users/vicjames/Library/Application Support/iPhone Simulator/6.0/Applications/8186A14C-1482-44AB-AD3A-0A88DC40EC89/Documents/Data/해부학/11월 29일/095\. Michael Learns to Rock - 25 Minutes.mp3"] absoluteString]); 
```

下面的日志是代码的执行结果。

```
2012-12-23 00:11:57.741 AudioArchive[11702:c07] /Users/vicjames/Library/Application Support/iPhone Simulator/6.0/Applications/8186A14C-1482-44AB-AD3A-0A88DC40EC89/Documents/Data/해부학/11월 29일/095\. Michael Learns to Rock - 25 Minutes.mp3
2012-12-23 00:11:57.741 AudioArchive[11702:c07] /Users/vicjames/Library/Application Support/iPhone Simulator/6.0/Applications/8186A14C-1482-44AB-AD3A-0A88DC40EC89/Documents/Data/해부학/11월 29일/095\. Michael Learns to Rock - 25 Minutes.mp3 
```

两个字符串看起来一样。

```
2012-12-23 00:11:57.742 AudioArchive[11702:c07] localPath Length:194
2012-12-23 00:11:57.742 AudioArchive[11702:c07] String Length:186 
```

但有不同的长度。

```
2012-12-23 00:11:57.743 AudioArchive[11702:c07] localPath : URL: file://localhost/Users/vicjames/Library/Application%20Support/iPhone%20Simulator/6.0/Applications/8186A14C-1482-44AB-AD3A-0A88DC40EC89/Documents/Data/%E1%84%92%E1%85%A2%E1%84%87%E1%85%AE%E1%84%92%E1%85%A1%E1%86%A8/11%E1%84%8B%E1%85%AF%E1%86%AF%2029%E1%84%8B%E1%85%B5%E1%86%AF/095.%20Michael%20Learns%20to%20Rock%20-%2025%20Minutes.mp3
2012-12-23 00:11:57.743 AudioArchive[11702:c07] String URL: file://localhost/Users/vicjames/Library/Application%20Support/iPhone%20Simulator/6.0/Applications/8186A14C-1482-44AB-AD3A-0A88DC40EC89/Documents/Data/%ED%95%B4%EB%B6%80%ED%95%99/11%EC%9B%94%2029%EC%9D%BC/095.%20Michael%20Learns%20to%20Rock%20-%2025%20Minutes.mp3 
```

URL 编码显示了差异。

```
2012-12-23 00:11:57.745 AudioArchive[11702:c07] is Not Equal 
```

NSString 还说两个字符串不相等。

1.  我想知道为什么会发生这种情况。
2.  我应该考虑内部 NSString 编码吗？
3.  如果应该，我该如何转换或处理内部编码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T10:31:35.923

iOS 文件系统名称采用[规范化形式 D](http://unicode.org/reports/tr15/)，而您的字符串文字采用规范化形式 C。

您可以通过首先将其标准化为 C 来获得相同的长度：

```
NSLog(@"localPath Length:%d",[[localPath precomposedStringWithCanonicalMapping] length]); 
```

# mysql - MySQL如何在与他一起工作之前检查所选列是否为空？

> ID：14007762
> 
> 赞同：0
> 
> 时间：2012-12-23T00:30:25.583
> 
> 标签：mysql, select, if-statement, null, case

我正在为我的项目扩展用户配置文件，添加更多信息。当我遇到问题时，我只是在添加国家/地区。这是我选择所需的所有配置文件数据的查询：

```
SELECT c.*, d.username, d.email, e.country_name
    FROM user_profiles c, users d, country e
    WHERE c.user_id = ".$id." AND d.id = ".$id."
    AND e.country_name = (SELECT country_name FROM country WHERE id = c.country_id) 
```

c.* 应该从 user_profiles 中选择所有列。

这`$id`是一个用户选择应该返回的配置文件的 id。问题是，尽可能保持注册简单，我那里没有国家选择器。所以当这个查询起作用时，user_profiles 中的 country_id 列是空的，这意味着当我想返回 country_name 时，查询结果是空的，所以没有返回配置文件数据。

我试图用`CASE`or重写它`LEFT JOIN`，但我认为我遗漏了一些东西。我想查找 country_id 是否不为空，如果不为空，请同时选择`country_name`this `country_id`。有任何想法吗？

感谢您的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T00:34:08.270

您可以使用 a ，但如果您从使用更简洁、更现代的语法`LEFT JOIN`开始，这样做会容易得多：`JOIN`

```
SELECT c.*, d.username, d.email, e.country_name
FROM user_profiles c 
JOIN users d ON d.id = c.id 
JOIN country e ON e.country_id = c.country_id
WHERE c.user_id = 42 
```

现在要解决您的问题，您只需添加`LEFT`：

```
LEFT JOIN country e ON e.country_id = c.country_id 
```

完整查询：

```
SELECT c.*, d.username, d.email, e.country_name
FROM user_profiles c 
JOIN users d ON d.id = c.id 
LEFT JOIN country e ON e.country_id = c.country_id
WHERE c.user_id = 42 
```

**有关的**

*   [为什么 SQL ANSI-92 标准没有比 ANSI-89 更好地采用？](https://stackoverflow.com/questions/334201/why-isnt-sql-ansi-92-standard-better-adopted-over-ansi-89)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-23T00:41:30.857

在我开始考虑您当前的问题之前，我可以指出您当前的查询是一团糟。特别糟糕。它可能会起作用，甚至可能会有效地起作用——但它仍然是一团糟：

```
SELECT c.*, d.username, d.email, e.country_name
FROM user_profiles c, users d, country e
WHERE d.id = ".$id." 
AND d.id = c.user_id
AND e.id = c.country_id; 
```

> 我试图用 CASE 或 LEFT JOIN 重写它

但你不会向我们展示你的代码吗？

一种解决方案是对 user_profiles/users 中的每一行使用子选择：

```
SELECT c.*, d.username, d.email, 
   (SELECT e.country_name
    FROM country e
    WHERE AND e.id = c.country_id LIMIT 0,1) AS country_name
FROM user_profiles c, users d
WHERE d.id = ".$id." 
AND d.id = c.user_id; 
```

或者，使用 LEFT JOIN：

```
SELECT c.*, d.username, d.email, e.country_name
FROM user_profiles c
INNER JOIN users d
   ON d.id = c.user_id
LEFT JOIN country e
   ON e.id = c.country_id
WHERE d.id = ".$id."; 
```

# entity-framework - dbContext 是否等同于 DDD 中的有界上下文？

> ID：14007764
> 
> 赞同：0
> 
> 时间：2012-12-23T00:30:44.153
> 
> 标签：entity-framework, domain-driven-design

实体框架世界中 dbContext 的概念是否等同于 Eric Evans 领域驱动设计世界中的有界上下文？正如 Eric 建议的那样，限界上下文将具有聚合根和存储库。如果我必须对 EF 使用存储库模式，我是否也可以使用与 EF 相同的模式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T02:01:17.760

它们并不完全相等，但您绝对可以使用 DbContext 作为有界上下文的域存储库的映射。严格来说，DbContext 是数据库段的表示，它们也可以在技术上与其他 DbContext 共享表（这不是非常 DDD），但是如果您遵循 DDD，则可以使用 DbContext 表示每个有界上下文的数据。

# css - 在使用 Angular JS 的“必需”时选择提交时的选项样式更改

> ID：14007767
> 
> 赞同：1
> 
> 时间：2012-12-23T00:31:31.267
> 
> 标签：css, validation, angularjs, required

为什么选择选项表单元素在提交表单时会改变样式？

```
HTML:
<div ng-controller="TestController">
    <form name="test" ng-submit="formSubmit()">
        <select name="selectFormItem" ng-options="selectFormItemValue.value as selectFormItemValue.text for selectFormItemValue in selectFormItemValues" ng-required="true" ng-model="testModel" class="selectStyle">
            <option value=""></option>
        </select>
        <button id="testSubmit" type="submit">Submit</button>
    </form>
    <br/><br/>
    <span>{{selectFormItemValues}}</span>
    <br/><br/>
</div>

JS:
    function TestController($scope) {
        $scope.selectFormItemValues = [{'value':0, 'text':'value0'}, {'value':1, 'text':'value1'}];

        $scope.formSubmit = function formSubmit() {
            alert("dummySubmit!");
        }
    }

CSS:
body {
    font-family: Helvetica;
    font-size: 14px;   
}
.selectStyle {
    padding: 5px;
    width: 150px;
} 
```

JSFiddle：http: [//jsfiddle.net/nEzpS/22/](http://jsfiddle.net/nEzpS/22/)

我注意到在选择表单成员上设置“必需”时会发生这种情况。

编辑：在 Chrome 版本中测试：23.0.1271.97、24.0.1312.52

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T16:49:43.027

这似乎是某些 Chrome 版本的错误，因为该问题在其他浏览器中不存在。

# ruby-on-rails - 如何创建一个 ruby 脚本来解析用户上传的文件？

> ID：14007768
> 
> 赞同：0
> 
> 时间：2012-12-23T00:31:41.063
> 
> 标签：ruby-on-rails, parsing, ruby-on-rails-3.1

我希望用户能够上传文件，然后我希望能够解析它们，取出信息片段，然后将它们声明为全局变量，供我的 Web 应用程序的其他部分使用。我知道您可以轻松地放入文件上传表单，但是我将在哪里存储用于解析文件的脚本？它会在模型​​、视图、控制器或其他地方吗？另外，我如何告诉我的应用程序在文件上传后立即运行此脚本。我会把它放在表单的 <% end %> 标记之前的视图中吗？当它解析文件时，如何确保全局声明变量（可能是数组），以便我可以在应用程序的所有其他部分调用这些变量

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T00:57:31.767

使用[EventMachine](http://eventmachine.rubyforge.org/EventMachine.html#watch_class_method)，您可以查看文件夹中的文件操作，然后对其进行处理。
图书馆[rb-inotify](http://rubydoc.info/gems/rb-inotify/0.8.8/frames)也适合。

```
# Create the notifier
notifier = INotify::Notifier.new

# Run this callback whenever the file path/to/foo.txt is read
notifier.watch("path/to/foo.txt", :access) do
  puts "Foo.txt was accessed!"
end

# Watch for any file in the directory being deleted
# or moved out of the directory.
notifier.watch("path/to/directory", :delete, :moved_from) do |event|
  # The #name field of the event object contains the name of the affected file
  puts "#{event.name} is no longer in the directory!"
end

# Nothing happens until you run the notifier!
notifier.run 
```

# statistics - 具有随机梯度下降的内核 SVM 原始

> ID：14007771
> 
> 赞同：2
> 
> 时间：2012-12-23T00:32:49.283
> 
> 标签：statistics, machine-learning

简而言之：我目前正在阅读带有内核的在线学习（[http://books.nips.cc/papers/files/nips14/AA33.pdf](http://books.nips.cc/papers/files/nips14/AA33.pdf)）以获得乐趣，但我无法弄清楚他是如何从等式 6 得到等式 8和 7。

这个想法是：我们希望最小化风险函数

```
$R_stoch\[f,t\]:=c(x_t,y_t,f(x_t))+\lambda\Omega\[f\]$ 
```

如果我们想在 上应用表示定理`f`，将其写为

```
$f(x)=\sum\alpha_i k(x,x_i)$ 
```

我们如何才能进行`STOCHASTIC`梯度下降更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T08:35:14.903

一组*k(x [i] , x)*似乎构成了*H*的基础，并且由于*f*在*H*中，因此*f*可以写成“核函数”的线性组合。

所以假设*k(x [i] , x)*的集合构成*H*的一个基，很明显，如果我们有一些左侧和右侧的线性冲突，并且它们相等，那么它们的基向量系数也应该相等（从线性代数中众所周知，向量相等意味着向量系数（在相同的基础上！）相等）。

# objective-c - 如何在 ARC 中初始化 NSArray？

> ID：14007783
> 
> 赞同：0
> 
> 时间：2012-12-23T00:36:55.593
> 
> 标签：objective-c, ios, xcode, memory-management, nsarray

我尝试初始化数组：

在 .h 文件中

```
 @property (nonatomic, retain) NSArray *accounts; 
```

在 .m 文件中：

```
 @synthesize accounts;

    - (void)viewDidLoad
    {
       [super viewDidLoad];
       NSArray *arrList = [acAccountStore accountsWithAccountType:accountType];  
       // This returns array
       self.accounts = [NSArray arrayWithArray:arrList]; // I tried debug after 
       // this and it gives me data in debugger.  
       // Note array List have 3 data in it.   
       } 
```

现在点击按钮我调用一个方法：

```
- (IBAction) ButtonClicked :(id) sender {
      NSLog(@" data : %@",[self.accounts objectAtIndex:0]); // Breaks at this point. 
      //  When i tried with debug it gives me (no Objective-C description available)
} 
```

数组的初始化是否正确或者如果代码不正确，请告诉我。

主要问题是当我在 viewDidLoad 中进行调试时，self.accounts 会显示正确的值。但是在点击事件之后它是空的并抛出 EXEC_BAD_ACCESS 错误。

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T02:49:38.287

**更新：**

也为您的帐户商店创建一个属性。我最近遇到了这个确切的问题，并且修复了它。

`@property (nonatomic, strong) ACAccountStore *accountStore;`

**原始答案**

因为您正在使用`ARC`，所以您需要将您的属性声明从

```
@property (nonatomic, retain) NSArray *accounts; 
```

至：

```
@property (nonatomic, strong) NSArray *accounts; 
```

使用最新的 LLVM 编译器，您也不需要综合属性。所以你可以删除`@synthesize accounts`.

您也应该始终使用防御性编码，因此在您的`- buttonClicked:`方法中，您应该：

```
- (IBAction)buttonClicked:(id)sender {
    if (self.accounts) {
          NSLog(@"data: %@", [self.accounts objectAtIndex:0]);
    }
} 
```

这确保了指向数组的指针是有效的。

您还可以通过执行以下操作检查以确保数组中的项目存在，然后再尝试读取它：

```
- (IBAction)buttonClicked:(id)sender {
    if (self.accounts.count > 0)
          NSLog(@"data: %@", [self.accounts objectAtIndex:0]);
    }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:41:35.770

嗯看起来不错。那么有几个问题：

您在哪里调用`self.accounts = [NSArray arrayWithArray:arrList];` 我假设在按下按钮之前正在设置数组？

arc 没有真正的理由应该清除变量。你对它设置了强引用还是弱引用？如果你在`self.`变量上使用，你应该有：

```
@property (nonatomic, strong) NSArray *accounts; 
```

或类似于 .h 文件中的内容，然后

```
@synthesize accounts; 
```

在 .m 文件中。

如果你有`weak`，`strong`那么 ARC 可能会清除内存，但它仍然不应该。

# python - 使用 python 脚本进行 Unix `at` 调度：权限被拒绝

> ID：14007784
> 
> 赞同：0
> 
> 时间：2012-12-23T00:37:15.817
> 
> 标签：python, linux, shell, unix

我正在尝试使用 Unix`at`命令创建计划任务。我想运行一个 python 脚本，但很快意识到它`at`被配置为使用运行我给它的任何文件`sh`。为了避免这种情况，我创建了一个包含命令的文件`python mypythonscript.py`并将其传递给`at`。

我已将 python 文件的权限设置为每个人都可以执行（`chmod a+x`），但是当`at`作业运行时，我被告知`python: can't open file 'mypythonscript.py': [Errno 13] Permission denied`.

如果我运行`source myshwrapperscript.sh`，shell 脚本会很好地调用 python 脚本。是否有一些明显的原因导致我遇到权限问题`at`？

**编辑：**我对 python 脚本感到沮丧，所以我继续制作了`sh`我想要运行的东西的脚本版本。我现在发现`sh`脚本返回给我说`rm: cannot remove <filename>: Permission denied`（这是我为存储中间数据而创建的临时文件）。尽管没有 sudo 访问权限，我是否可以使用自己的凭据授权这些操作？当我自己运行它时，所有这些都完美运行，但当我运行它时，一切似乎都变得糟糕透顶`at`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T01:59:59.087

我最近一直在研究服务器和客户端之间的任务调度。我只是抽象出我的调度代码[并将其放在 Github 上](https://github.com/inspectorG4dget/simDistribution)。它的目的是在多台机器上安排多次模拟，这些机器的文件系统中都有所有模拟。这个想法是，由于每台机器都有不同的处理器，它会计算每个模拟，将结果scp回服务器并请求服务器进行下一次模拟。服务器通过在客户端上安排一个任务来运行下一个未运行的模拟来响应

希望这会帮助你。

**注意**：由于我大约 5 分钟前才抽象和上传文件，因此我没有机会测试抽象。但是，如果您遇到任何错误，请告诉我，我会尽快调试。

Github 现在好像挂了。所以这里是你需要的文件：

**在服务器上**：

`serverside`

```
#!/bin/bash

projectDir=~/

minute=`atq | sort -t" " -k1 -nr | head -n1 | cut -d' ' -f4 | cut -d":" -f1,2`
curr=`date | cut -d' ' -f4 | cut -d':' -f1,2`

time=`python -c "import sys; hour,minute=map(int,max(sys.argv[1:]).split(':')); minute += 2; hour, minute = [(hour,minute), ((hour+1)%24,minute%60)][minute>=60]; print '%d:%02d'%(hour, minute)" "$minute" "$curr"`

cat <<EOF | at "$time"
python $projectDir/serverside.py $1

EOF 
```

`serverside.py`

```
import sys
import time
import smtplib
import subprocess
import os
import itertools

IP = sys.argv[1].strip()
PROJECT_DIR = "" # relative path (relative to the home directory) to the root directory of the project, which contains all subdirs containing simulation files

USERS = { # keys are IPs of the clients, values are user names on those clients
        }

HOMES = { # keys are the IPs of clients, values are the absolute paths to the home directories on these clients for the usernames on these clients  identified in USERS
        }
HOME = None # absolute path to the home directory on the server

SMTP_SERVER = ""
SMTP_PORT = None
FROM_ADDR = None # the email address from which notification emails will be sent
TO_ADDR = None # the email address to which notification emails will be sent

def get_next_simulation():
    """ This function returns a list.
        The list contains N>0 elements.
        Each of the first N-1 elements are names of directories (not paths), which when joined together form a relative path (relative from PROJECT_DIR).
        The Nth element is the name of the file - the simulation to be run.
        Before the end user implements this function, it is assumed that N=3.
        Once this function has been implemented, if N!=3, change the code in the lines annotated with "Change code for N in this line"
             Also look for this annotation in clientside.py and clientsideexec """

    pass

done = False
DIR1, DIR2, FILENAME = get_next_simulation() # Change code for N in this line

while not done:
    try:
        subprocess.check_call("""ssh %(user)s@%(host)s 'sh %(home)s/%(project)/clientside %(dir1)s %(dir2)s %(filename)s %(host)s' """ %{'user':USER, 'host':IP, 'home':HOME[IP], 'project':PRJECT_DIR, 'dir1':DIR1, 'dir2':DIR2, 'filename':FILENAME}, shell=True) # Change code for N in this line
        done = True

        os.remove("%(home)s/%(project)/%(dir1)s/%(dir2)s/%(filename)s" %{'home':HOME, 'project':PROJECT_DIR, 'dir1':DIR1, 'dir2':DIR2, 'filename':FILENAME}) # Change code for N in this line

        sm = smtplib.SMTP(SMTP_SERVER, SMTP_PORT)
        sm.sendmail(FROM_ADDR, TO_ADDR, "running %(project)s/%(dir1)s/%(dir2)s/%(filename)s on %(host)s" %{'project':PROJECT_DIR, 'dir1':DIR1, 'dir2':DIR2, 'filename':FILENAME, 'host':IP}) # Change code for N in this line
    except:
        pass 
```

**在客户端**：

`clientside`

```
#!/bin/bash

projectpath=~/
python $projectpath/clientside.py "$@" 
```

`clientside.py`

```
import subprocess
import sys
import datetime
import os

DIR1, DIR2, FILENAME, IP = sys.argv[1:]
try:
    subprocess.check_call("sh ~/cisdagp/clientsideexec %(dir1)s %(dir2)s %(filename)s %(ip)s" %{'dir1':, 'dir2':, 'filename':, ip':IP}, shell=True, executable='/bin/bash') # Change code for N in this line

except:
    pass 
```

`clientsideexec`

```
#!/bin/bash

projectpath=~/
user=''
serverIP=''

SMTP_SERVER=''
SMTP_PORT=''
FROM_ADDR=''
TO_ADDR=''
MESSAGE=''

cat <<EOF | at now + 2 minutes
cd $projectpath/$1/$2  # Change code for N in this line
sh $3

# copy the logfile back to the server
scp logfile$3 $user@$serverIP:$projectpath/$1/$2/
cd $projectpath
python -c "import smtplib; sm = smtplib.SMTP('$SMTP_SERVER', $SMTP_PORT); sm.sendmail('$FROM_ADDR', '$TO_ADDR', '$MESSAGE')"
python clientsiderequest.py
EOF 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:58:31.743

**编辑：**该`at`命令尝试将所有内容作为 shell 命令列表运行。所以你应该像这样开始你的脚本：

```
at now + 1 minute < python mypythonscript.py 
```

在这种情况下，`#!`脚本开头的行是不必要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T01:09:47.193

使用 python 启动脚本而不是实际的脚本名称，例如 : `python path/to/script.py`。

at 尝试将所有内容作为`sh`脚本运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T20:36:53.977

你能试试：`echo 'python mypythonscript.py' | at ...`

# python - 安装 OS X 10.8 macports 后 python pip 无法在 requirements.txt 上工作

> ID：14007785
> 
> 赞同：3
> 
> 时间：2012-12-23T00:37:15.987
> 
> 标签：python, macos, pip, macports, requirements.txt

最近买了一台新的 Mac，正在为 Python 和 iOS 开发设置它。Python 运行良好——尤其是 pip'ing git repos 与很多 requirements.txt 依赖项，直到我安装了 Xcode、macports 和 Apple 的命令行工具。

现在 pip 可以很好地用于个人安装（例如，pip install twilio），但是每当我对 requirements.txt 文件运行 pip 时，它都会失败（有或没有 sudo）：

```
pip install ./requirements.txt
Exception:
Traceback (most recent call last):
  File "/Library/Python/2.7/site-packages/pip-1.2.1-py2.7.egg/pip/basecommand.py", line 107, in main
    status = self.run(options, args)
  File "/Library/Python/2.7/site-packages/pip-1.2.1-py2.7.egg/pip/commands/install.py", line 225, in run
    InstallRequirement.from_line(name, None))
  File "/Library/Python/2.7/site-packages/pip-1.2.1-py2.7.egg/pip/req.py", line 118, in from_line
    return cls(req, comes_from, url=url)
  File "/Library/Python/2.7/site-packages/pip-1.2.1-py2.7.egg/pip/req.py", line 43, in __init__
    req = pkg_resources.Requirement.parse(req)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/pkg_resources.py", line 2510, in parse
    reqs = list(parse_requirements(s))
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/pkg_resources.py", line 2436, in parse_requirements
line, p, specs = scan_list(VERSION,LINE_END,line,p,(1,2),"version spec")
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/pkg_resources.py", line 2404, in scan_list
raise ValueError("Expected "+item_name+" in",line,"at",line[p:])
ValueError: ('Expected version spec in', './requirements.txt', 'at', '/requirements.txt') 
```

我的`$PATH`价值是

```
/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/git/bin 
```

这看起来与“OS X 10.8 升级后 Python pip 损坏”线程不同。我想知道 macports 是否在查看`/System/Libary`和`~/Library`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T23:49:23.010

如果要通过需求文件安装软件包，则需要以下`--requirement/-r`选项：

```
$ pip install -r requirements.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-21T22:53:00.023

$ pip3 install -r requirements.txt

# php - 将许多多级数组插入mysql库

> ID：14007787
> 
> 赞同：-1
> 
> 时间：2012-12-23T00:38:08.050
> 
> 标签：php, mysql

我有一个功能可以分隔我的文件内容。示例文件：

```
001;"text1"
002;"text2"
003;"text3"
999
001;"tekst11" 
```

有时一些索引有几个值：

```
120;"text2"
120;"text3" 
```

我的功能：

```
function parseCSV($file) {
   $lines = file($file);
   $output = array();
   $i = -1;
   foreach($lines as $line) {
      $line = trim($line);
      if($line == "999") {
         $i++;
      } else {
         $ex = explode(";", $line, 2);
         $val = str_replace("\"", "", $ex[1]);
         //$dodaj = mysql_query("INSERT INTO `czynsz` (`$ex[$i]`) VALUES ('$val')");
         if(isset($output[$i][$ex[0]])) {         
            if(is_array($output[$i][$ex[0]])) {

               $output[$i][$ex[0]][] = $val;
            } else {
               $output[$i][$ex[0]] = array($output[$i][$ex[0]], $val);
            }
         } else {
            $output[$i][$ex[0]] = $val;
         }
         $dodaj = mysql_query("INSERT INTO `czynsz` (`$ex[$i]`) VALUES ('$val')");
      }
   }
   return $output;
}
$csvdata = parseCSV("woda.txt");

echo "<pre>\r\n";
print_r($csvdata);
echo "</pre>\r\n"; 
```

上面的脚本使我成为多级数组树，并通过分隔符（999）将数组与它们自身分开，因为在我的文件中有很多数组......当索引有很多值时 - 脚本为他创建了内部树。例如：

```
Array
    (
    [0] => Array
        (
        [001] => 06-001-03-13
        [002] => 06447
        [003] => F
        ...
        [097] =>
        [120] => Array
            (
            [0] => text1
            [1] => text2
            )
        )
    [1] => Array
    ... 
```

**还有我的问题：** 在我的 MySQL 库中保存这个巨型数组时遇到问题。数组中的每个索引在数据库中都相同。当同一个索引有很多值（例如 120）时，它可能是内爆的。衷心感谢您提供任何形式的帮助... :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T01:12:02.553

创建一个 MySQL 表：

```
CREATE TABLE `czynsz` (
  `id` INT NOT NULL ,
  `value` VARCHAR( 255 ) NOT NULL
) ENGINE = InnoDB;

ALTER TABLE `czynsz` ADD UNIQUE `unique` ( `id` ) 
```

然后使用下面的php代码插入数据

```
ini_set('error_reporting', E_ALL); // just for debugging remove later
ini_set('display_erorrs', 1); // just for debugging remove later

function parseCSV($file) {
    $lines = file($file);
    $output = array();
    $i = 0;
    foreach($lines as $line) {
        $line = trim($line);
        if($line == "999") {
           $i++;
           continue;
        }

        list($id, $val) = explode(";", $line, 2);

        $val = str_replace("\"", "", $val);

        $result = mysql_query("
            INSERT INTO `czynsz` (
                id, 
                `value`
            ) VALUES (
                '$id',
                '$val'
            ) ON DUPLICATE KEY UPDATE 
                `value` = CONCAT(`value`, ', ', '$val')"
        );
        if(!$result) {
            die(mysql_error());
        }
        if(isset($output[$i][$id])) {
            if(is_array($output[$i][$id])) {
                $output[$i][$id][] = $val;
            } else {
                $output[$i][$id] = array($output[$i][$id], $val);
            }
        } else {
            $output[$i][$id] = $val;
        }
    }
   return $output;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T01:17:04.357

使用 PHP 大锤解决方案...

假设您只想存储数组并且不需要查询不同的节点，请使用该`serialize`函数将您的数组转换为字符串表示形式。您可以轻松地提取数据，然后用于`unserialize`取回原始数组。

```
$s_arr = serialize($my_array);

$my_array = unserialize($s_arr); 
```

如果您需要访问数据库中的节点，那么由于涉及的复杂性，我认为 MySQL 不是一个好的解决方案。如果你想要一个键值存储，那么你应该看看[Redis](http://redis.io/)之类的 NoSQL 解决方案。

# android - 来自Javascript的Android webview通知

> ID：14007789
> 
> 赞同：0
> 
> 时间：2012-12-23T00:38:40.837
> 
> 标签：android, notifications

如何使 JavaScriptInteface 中的 showToast 调用 CreateNotification？

这是我的代码：

CheckInventoryActivity.java

```
package com.CheckInventory;;

import android.app.Activity;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.view.KeyEvent;
import android.view.WindowManager;
import android.webkit.WebChromeClient;
import android.webkit.WebSettings;
import android.webkit.WebStorage;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.Toast;

@SuppressWarnings("unused")
public class CheckInventory;Activity extends Activity {
    WebView webview;
    String username; 
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
        setContentView(R.layout.main);
        webview = (WebView) findViewById(R.id.webview);
        WebView webView = (WebView) findViewById(R.id.webview);
        webView.setBackgroundColor(0);
        webView.setBackgroundResource(R.drawable.myimage);
        webView.addJavascriptInterface(new JavaScriptInterface(this), "Android");
        WebSettings webSettings = webview.getSettings();
        webSettings.setLoadWithOverviewMode(true);

        webview.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);

        webSettings.setJavaScriptEnabled(true);
        webSettings.setJavaScriptCanOpenWindowsAutomatically(true);
        webSettings.setDatabasePath("/data/data/"+this.getPackageName()+"/databases/");
        webSettings.setDomStorageEnabled(true);
        webview.setWebChromeClient(new WebChromeClient());
        webview.loadUrl("http://192.168.0.124/android");
        webview.setWebViewClient(new HelloWebViewClient());

    }

    public void OnResume(Bundle savedInstanceState) {
        super.onResume();
         CancelNotification();
    }

    private class HelloWebViewClient extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }

        @Override
        public void onReceivedError(WebView view, int errorCode, String description, String failingUrl)
        {
            super.onReceivedError(view, errorCode, description, failingUrl);
            webview.loadUrl("file:///android_asset/nodata.html");
            Toast.makeText(getApplicationContext(),"Not online", Toast.LENGTH_LONG).show();
        }
    }

    public void CreateNotification()
    {
        Toast.makeText(getApplicationContext(),"Notifying", Toast.LENGTH_LONG).show();

        String ns = Context.NOTIFICATION_SERVICE;
        NotificationManager mNotificationManager = (NotificationManager) getSystemService(ns);

        int icon = R.drawable.ic_launcher;              // icon from resources
        long when = System.currentTimeMillis();         // notification time
        Context context = getApplicationContext();      // application Context
        CharSequence tickerText = "Chess";              // ticker-text
        CharSequence contentTitle = "CheckInventory;";      // message title
        CharSequence contentText = "You have an action to take";      // message text

        Intent notificationIntent = new Intent(CheckInventory;Activity.this, CheckInventory;Activity.class);
        PendingIntent contentIntent = PendingIntent.getActivity(CheckInventory;Activity.this, 0, notificationIntent, 0);
        Notification notification = new Notification(icon, tickerText, when);
        notification.setLatestEventInfo(context, contentTitle, contentText, contentIntent);
        notification.flags |= Notification.FLAG_ONLY_ALERT_ONCE | Notification.FLAG_AUTO_CANCEL;    
        mNotificationManager.notify(1234, notification);
    }

    public void CancelNotification()
    {
        Toast.makeText(getApplicationContext(),"Lets get it on!!", Toast.LENGTH_LONG).show();
        String ns = Context.NOTIFICATION_SERVICE;
        NotificationManager mNotificationManager = (NotificationManager) getSystemService(ns);
        mNotificationManager.cancel(1234);
    }
} 
```

JavaScriptInterface.java

```
package com.CheckInventory;

import android.widget.Toast;
import android.content.Context;

public class JavaScriptInterface {
    Context mContext;

    /** Instantiate the interface and set the context */
    JavaScriptInterface(Context c) {
        mContext = c;
    }

    /** Show a toast from the web page */
    public void showToast(String toast) {
        Toast.makeText(mContext, toast, Toast.LENGTH_LONG).show();
    }
} 
```

我是使用 Java 和 Android 的新手，当我尝试调用该方法时，它给了我一个错误，因为它不是静态的。底线我正在寻找 JavaScriptInterface 来创建通知。

由于我是新手，我需要一个与我的问题直接相关的示例代码。

感谢您的帮助！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T01:30:10.713

除了这`CheckInventory;Activity`不是一个有效的类名这一事实之外，其余的似乎都还好。**如果必须**在您的活动中通知用户，这是一种方法。在你`JavaScriptInterface`的`showToast()`电话`CreateNotification`中：

```
((CheckInventoryActivity)mContext).CreateNotification(); 
```

这将转换您的`mContext`变量，因此它是一个`CheckInventoryActivity`然后调用您的`CreateNotification`方法。

如果`mContext`不*总是这样*的实例，`CheckInventoryActivity`您将需要执行以下操作：

```
 if (mContext instanceof CheckInventoryActivity){
      ((CheckInventoryActivity)mContext).CreateNotification();
    } 
```

但是，我不明白您为什么不将通知代码直接放入`JavaScriptInterface`. 您有一个`Context`变量 ( `mContext`)，并且 Notification & Intents 需要一个`Context`变量作为参数之一。简而言之，您似乎拥有从该非活动类显示通知的必要工具。只需确保调用`getSystemService(ns);`as`context.getSystemService(ns);`并删除所有`getApplicationContext()`方法调用。

# php - 列表中的重叠项目

> ID：14007790
> 
> 赞同：-1
> 
> 时间：2012-12-23T00:39:02.183
> 
> 标签：php, html

最近我在尝试创建搜索表单并将结果显示在列表中时遇到了问题

```
 <?php 
        require_once ("Includes/simplecms-config.php"); 
        require_once  ("Includes/connectDB.php");
        include("Includes/header.php");         
     ?>

    <div id="main">
        <div id="searchcontent">
            <?php 
                $querysuccess = FALSE;
                $extsuccess = FALSE;
                if($_GET["query"] != "")
                {
                    echo '<h3>Results for "'.$_GET["query"].'"</h3>';
                    $querysuccess = TRUE;
                }

                if($_GET["ext"] != "*" && $_GET["ext"] != "")
                {
                    echo "<p>Matching extension: *.".$_GET["ext"]."</p>";
                    $extsuccess = TRUE;
                }
                else if($_GET["ext"] == "")
                {
                    echo "<p>No extension specified</p>";
                }
                else
                {
                    $extsuccess = TRUE;
                }

                if($querysuccess == TRUE && $extsuccess == TRUE)
                {
                    doSearch();
                }

                function doSearch()
                {
                    $query = $_GET["query"];
                    $extension = $_GET["ext"];

                    $sql_query = "SELECT * FROM search WHERE";
                    $querycount = 0;

                    $terms = explode(" ", $query);

                    foreach($terms as $word)
                    {
                        $querycount++;
                        if($querycount == 1) {
                            $sql_query .= " description LIKE '%$word%'";
                        }
                        else
                        {
                            $sql_query .= " OR description LIKE '%$word%'";
                        }
                    }

                    if($searchforextension == TRUE)
                    {
                        $sql_query .= "AND extension='$extension'";
                    }

                    mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);
                    mysql_select_db(DB_NAME);

                    $sql_query = mysql_query($sql_query);
                    $numrows = mysql_num_rows($sql_query);
                    if($numrows > 0)
                    {
                        echo "<ul>";
                        while($proc_row = mysql_fetch_array($sql_query))
                        {
                            $script_id = $proc_row["id"];
                            $script_name = $proc_row["name"];
                            $script_description = $proc_row["description"];
                            $script_author = $proc_row["author"];
                            $script_authorURL = $proc_row["authorURL"];
                            $script_pathname = $proc_row["filename"];

                            $search_result = "<li><div class='result'>";
                            $search_result .= " <p class='result_title'>$script_name</p>";
                            $search_result .= " <p>$script_description</p>";
                            $search_result .= " <div class='result_footer'>";
                            $search_result .= "     <a href='$script_authorURL'"." class='result_author'>$script_author</a>";
                            $search_result .= "     <a href='/getscript.php?script=$script_id" . "&". "file=$script_pathname' class='result_download'>View</a>";
                            $search_result .= " </div>";
                            $search_result .= "</div></li><br /><br /><br />";
                            echo $search_result;

                        }
                        echo "</ul>";
                    }
                    else
                    {
                        echo "<br/><h2>Unable to find any results matching your query.</h2>";
                    }

                    mysql_close();
                }
            ?>
        </div>
    </div>

    </div>

    <?php 
        include ("Includes/footer.php");
     ?> 
```

我正在使用 Microsoft WebMatrix 2.0 基于 PHP 入门模板创建此站点，我的问题是当显示超过 1 个对象时，它会与前一个对象重叠并搞砸整个布局！

如果需要，我可以发布我的 CSS 的一部分吗？

**遵循 Wesley Murch 的建议后，我现在有另一个问题**

[现在什么不起作用 http://img21.imageshack.us/img21/4498/screenshotgbf.png](http://img21.imageshack.us/img21/4498/screenshotgbf.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T00:43:08.783

您正在生成无效的 HTML。

在这里，您关闭不正确的`<a>`标签：`</p>`

```
$search_result .= "     <a href='/getscript.php?script=$script_id" . "&". "file=$script_pathname' class='result_download'>View</p>"; 
```

在这里，您将`<br>`标签添加`<ul>`为无效的直接子代：

```
$search_result .= "</div></li><br /><br /><br />"; 
```

`<ul>`a or的唯一有效直接子代`<ol>`是`<li>`。

您还在 HTML 顶部打开 2 个 div，但底部有 3 个结束标记。

无效的 HTML 是破坏布局的主要原因之一。将来使用此工具作为调试 HTML 和/或 CSS 的第一站：

[http://validator.w3.org/](http://validator.w3.org/)

# mysql - 将列从非空设置为空 - mysql

> ID：14007799
> 
> 赞同：0
> 
> 时间：2012-12-23T00:41:41.450
> 
> 标签：mysql, null

出于某种原因，我必须更改 mysql 表中一个参数 'param' 的默认值，我必须将其默认设置为 NULL。我尝试通过 phpmyadmin 对其进行管理，但收到以下错误消息：

```
ALTER TABLE  `mytable` CHANGE  `param`  `param` VARCHAR( 150 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT NULL 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:43:33.997

您不能将`NOT NULL`列设置为具有`DEFAULT NULL`.

在 phpMyAdmin 中，`Null?`编辑时选中该列的框。

# c++ - 将字节复制到字节数组？

> ID：14007800
> 
> 赞同：0
> 
> 时间：2012-12-23T00:41:49.803
> 
> 标签：c++

我正在学习，我想知道如何进行以下数组复制的最佳方法，请考虑以下代码：

```
void Cast1LineSpell(UINT Serial, char *chant)
{
    byte packet[] = { 0x0F, 0x03, 
        (Serial >> 24) & 0xFF, (Serial >> 16) & 0xFF,(Serial >> 8) & 0xFF, Serial & 0xFF, 
        0x9A, 0x92, 0x00, 0x00, 0x00, 0x1A };

    byte prepareSpell[2] = { 0x4D, 0x01 };

    byte chant_length = sizeof(chant) / sizeof(chant[0]);
    byte chant_name[] = { 0x4E, chant_length, }; // <= how can i put the bytes in chant* into the rest of this array, and then append bytes 0x00 and 0x4E on to the end of it?
} 
```

我怎样才能把里面的字节放在里面`*chant`，然后把它们放在末尾，`chant[]`然后附加字节`0x00`，然后再放到它的`0x4E`末尾？

任何人都可以提供解决方案吗？非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T03:51:57.357

根据我的理解，在 C++ 中，所有传递给函数的数组都被视为指针，无论它们是静态分配的还是动态分配的，甚至您将参数写为`char chant[]`, （即只传入第一个元素的地址）。

例子：

```
void f(int value[]){
    cout<<"size in f: "<<sizeof(value)/sizeof(int)<<endl;
}

int main(){
    int arr[] = { 1, 2, 3, 4, 5, 6, 7, 8 };

    cout<<"size in main: "<<sizeof(arr)/sizeof(int)<<endl;

    f(arr);

    return 0;
} 
```

结果是：

```
size in main: 8
size in f: 1 
```

如您所见， in与 相同`f()`，并且是指针的大小。`value[]``value *``sizeof(value)`

当您将数组传递给函数时，您应该（始终）也传递长度。

```
void f(int value[], size_t size){
    cout<<"size in f: "<<size<<endl;
}

int main(){
    int arr[] = { 1, 2, 3, 4, 5, 6, 7, 8 };

    size_t size = sizeof(arr)/sizeof(int);

    cout<<"size in main: "<<size<<endl;

    f(arr, size);

    return 0;
} 
```

输出：

```
size in main: 8
size in f: 8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T00:45:06.983

您正在使用*动态数组*，因此`sizeof(chant)`始终是指针的大小，而`sizeof(chant) / sizeof(chant[0])`不是数组中元素的数量。这只适用于*静态数组*。

此外，您正在重新声明`chant`这只是一个错误。

总之，由于您不知道 中的元素数量`chant`，因此无法做您想做的事情。

# c++ - opengl是跨平台的吗？如果没有，如何移植游戏？

> ID：14007802
> 
> 赞同：18
> 
> 时间：2012-12-23T00:42:37.630
> 
> 标签：c++, opengl, cross-platform, porting

好的，所以说我正在用 opengl 用 c++ 编写游戏。游戏在屏幕上绘制了一些简单的形状，例如正方形。现在说我想在 Windows 上运行“游戏”。我将如何移植它？实际的 c++ 不会是问题，因为它可以重新编译以适应我所理解的环境。但是对 openGL 库的调用会被破坏，不是吗？将包含用于开发的实际 opengl 库将为操作系统编译，这将需要重新下载该库，这将导致对源代码的修改。哪个会破坏原始环境中的程序，对吗？

tl;dr 有没有办法为多个操作系统构建一个 opengl 游戏，而无需将源代码修改为特定于平台或下载外部包装器或库？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-23T00:57:48.050

OpenGL 是平台独立的，而不是跨平台的。它只是一个图形库接口的规范。它与正在实施的平台无关。它只是描述了函数，它们被称为什么以及它们做什么。

OpenGL 库的具体实现可能是跨平台的，也可能不是。例如，[Mesa](http://www.mesa3d.org/)在某种程度上是跨平台的，尽管它主要是为 Linux 开发的。您需要在要编译的每个平台上找到 OpenGL 的实现。

但是，在您开始使用 OpenGL 接口*之前*，需要执行一些代码。此代码用于设置 OpenGL 渲染上下文。你如何做到这一点*是*特定于平台的。例如，在 Linux 上，GLX 是 X Window 系统的扩展，它提供了一个用于创建渲染上下文的接口。这仅适用于运行 X Window 系统的系统。在其他系统上，您将不得不做一些不同的事情来完成同样的工作。

有跨平台库可以为您创建渲染上下文。例如，看看[GLFW](http://www.glfw.org/)。它是称为 GLUT 的库的现代替代品，但不再维护 GLUT。您可以避免在源代码中包含特定于平台的代码，并将该工作交给库来管理。

请注意，OpenGL 仅提供图形库。而已。游戏使用的许多其他库和接口可能与平台无关，例如输入、声音等。如果您的游戏仅包含纯 C++ 并且唯一的库是 OpenGL，则源可能会非常顺利地移植到另一个平台，只要您的 C++ 代码不依赖任何未指定的行为。如果您使用像 GLFW 这样的库，您甚至可能不必更改渲染上下文设置。

还值得一提的是[SFML](http://www.sfml-dev.org/)和[SDL](http://www.libsdl.org/)。这些库是跨平台的，并为各种多媒体提供接口。他们将设置您的 OpenGL 渲染上下文、为您创建窗口、绘制到屏幕、处理 I/O 和声音等等。它们在某些方面可能会受到限制，但它们的强大之处在于它们可以让您很快在所有平台上处于有利位置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-23T00:49:30.387

是的，OpenGL 是跨平台的。创建 OpenGL 渲染上下文、处理输入等的代码通常不会。

# c++ - 这里循环携带的依赖在哪里？

> ID：14007805
> 
> 赞同：12
> 
> 时间：2012-12-23T00:43:51.403
> 
> 标签：c++, visual-c++, compiler-optimization, vectorization, visual-c++-2012

有没有人看到下面的循环代码有什么明显的东西，我没有看到为什么 VS2012 的 C++ 编译器不能自动矢量化它？

编译器给我的只是`info C5002: loop not vectorized due to reason '1200'`当我使用`/Qvec-report:2`命令行开关时。

原因 1200 在 MSDN 中记录为：

> 循环包含阻止矢量化的循环携带的数据依赖性。循环的不同迭代相互干扰，因此对循环进行矢量化会产生错误的答案，并且自动矢量化器无法向自己证明不存在这种数据依赖性。

我知道（或者我很确定）没有任何循环携带的数据依赖关系，但我不确定是什么阻止了编译器实现这一点。

这些`source`和`dest`指针永远不会重叠或别名相同的内存，我试图通过`__restrict`.

`pitch`总是一个正整数值，类似于`4096`，取决于屏幕分辨率，因为这是一个 8bpp->32bpp 渲染/转换函数，逐列操作。

```
byte  * __restrict source;
DWORD * __restrict dest;
int pitch;

for (int i = 0; i < count; ++i) {
    dest[(i*2*pitch)+0] = (source[(i*8)+0]);
    dest[(i*2*pitch)+1] = (source[(i*8)+1]);
    dest[(i*2*pitch)+2] = (source[(i*8)+2]);
    dest[(i*2*pitch)+3] = (source[(i*8)+3]);

    dest[((i*2+1)*pitch)+0] = (source[(i*8)+4]);
    dest[((i*2+1)*pitch)+1] = (source[(i*8)+5]);
    dest[((i*2+1)*pitch)+2] = (source[(i*8)+6]);
    dest[((i*2+1)*pitch)+3] = (source[(i*8)+7]);
} 
```

每个周围的括号`source[]`都是函数调用的残余，我在这里省略了，因为没有函数调用，循环仍然不会以最简单的形式自动矢量化。

**编辑：**

我已将循环简化为最简单的形式：

```
for (int i = 0; i < 200; ++i) {
    dest[(i*2*4096)+0] = (source[(i*8)+0]);
} 
```

这仍然会产生相同的 1200 原因代码。

**编辑（2）：**

这个具有本地分配和相同指针类型的最小测试用例仍然无法自动矢量化。我只是在这一点上感到困惑。

```
const byte * __restrict source;
byte * __restrict dest;
source = (const byte * __restrict ) new byte[1600];
dest = (byte * __restrict ) new byte[1600];
for (int i = 0; i < 200; ++i) {
    dest[(i*2*4096)+0] = (source[(i*8)+0]);
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-23T01:12:13.567

我们只是说阻止这个循环矢量化的不仅仅是几件事......

考虑一下：

```
int main(){
    byte  *source = new byte[1000];
    DWORD *dest   = new DWORD[1000];

    for (int i = 0; i < 200; ++i) {
        dest[(i*2*4096)+0] = (source[(i*8)+0]);
    }
    for (int i = 0; i < 200; ++i) {
        dest[i*2*4096] = source[i*8];
    }
    for (int i = 0; i < 200; ++i) {
        dest[i*8192] = source[i*8];
    }
    for (int i = 0; i < 200; ++i) {
        dest[i] = source[i];
    }
} 
```

编译器输出：

```
main.cpp(10) : info C5002: loop not vectorized due to reason '1200'
main.cpp(13) : info C5002: loop not vectorized due to reason '1200'
main.cpp(16) : info C5002: loop not vectorized due to reason '1203'
main.cpp(19) : info C5002: loop not vectorized due to reason '1101' 
```

* * *

让我们分解一下：

1.  前两个循环是相同的。所以他们给出了`1200`循环携带依赖的原始原因。

2.  第 3 个循环与第 2 个循环相同。然而编译器给出了不同的原因`1203`：

    > > 循环体包括对数组的非连续访问

    好吧...为什么不同的原因？我不知道。但这一次，理由是正确的。

3.  第 4 个循环给出`1101`：

    > > 循环包含一个不可向量化的转换操作（可能是隐式的）

    所以 VC++ 不够聪明，无法发出 SSE4.1`pmovzxbd`指令。

    这是一个非常小众的案例，我没想到任何现代编译器都能够做到这一点。如果可以，您需要指定 SSE4.1。

* * *

所以唯一不同寻常的是为什么初始循环会报告循环携带的依赖项。
嗯，这是一个艰难的决定......我会说编译器只是没有发出正确的原因。（当它真的应该是非连续访问时。）

回到正题，我不希望 MSVC 或任何编译器能够矢量化您的原始循环。您的原始循环具有以 4 块为一组分组的访问 - 这使得它足够连续以进行矢量化。但期望编译器能够识别这一点是一个长期的目标。

所以如果重要的话，我建议手动向量化这个循环。你需要的内在是[`_mm_cvtepu8_epi32()`](http://msdn.microsoft.com/en-us/library/bb531467%28v=vs.90%29.aspx).

* * *

**你原来的循环：**

```
for (int i = 0; i < count; ++i) {
    dest[(i*2*pitch)+0] = (source[(i*8)+0]);
    dest[(i*2*pitch)+1] = (source[(i*8)+1]);
    dest[(i*2*pitch)+2] = (source[(i*8)+2]);
    dest[(i*2*pitch)+3] = (source[(i*8)+3]);

    dest[((i*2+1)*pitch)+0] = (source[(i*8)+4]);
    dest[((i*2+1)*pitch)+1] = (source[(i*8)+5]);
    dest[((i*2+1)*pitch)+2] = (source[(i*8)+6]);
    dest[((i*2+1)*pitch)+3] = (source[(i*8)+7]);
} 
```

**向量化如下：**

```
for (int i = 0; i < count; ++i) {
    __m128i s0 = _mm_loadl_epi64((__m128i*)(source + i*8));
    __m128i s1 = _mm_unpackhi_epi64(s0,s0);

    *(__m128i*)(dest + (i*2 + 0)*pitch) = _mm_cvtepu8_epi32(s0);
    *(__m128i*)(dest + (i*2 + 1)*pitch) = _mm_cvtepu8_epi32(s1);
} 
```

免责声明：这是未经测试的，忽略对齐。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T01:11:57.650

从 MSDN 文档中，会报错 1203 的情况

```
void code_1203(int *A)
{
    // Code 1203 is emitted when non-vectorizable memory references
    // are present in the loop body. Vectorization of some non-contiguous 
    // memory access is supported - for example, the gather/scatter pattern.

    for (int i=0; i<1000; ++i)
    {
        A[i] += A[0] + 1;       // constant memory access not vectorized
        A[i] += A[i*2+2] + 2;  // non-contiguous memory access not vectorized
    }
} 
```

确实可能是索引处的计算与自动矢量化器混淆。有趣的是，显示的错误代码不是 1203。

[MSDN 并行化器和矢量化器消息](http://msdn.microsoft.com/en-us/library/jj658585.aspx)

# jsp - EL 和 Scriptlets 如何获取 pageContext.getAttribute 子项？

> ID：14007809
> 
> 赞同：1
> 
> 时间：2012-12-23T00:44:35.627
> 
> 标签：jsp, el

脚本是否有一种简单的方法可以从结果中访问字段，如下所示？它应该是什么样子？

`${item.options}`不写为`<%= pageContext.getAttribute("item.options") %>`

我知道我可以设置一个新的 pageContext 变量并访问它。但我认为可能有一种更优雅的方式......

我知道小脚本并不理想，但我只是在做原型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:47:55.177

它是[`PageContext#findAttribute()`](http://docs.oracle.com/javaee/6/api/javax/servlet/jsp/JspContext.html#findAttribute%28java.lang.String%29)，你应该`${item}`直接获得它而不是它的`options`属性，它不存储为单独的属性或其他东西。鉴于它是 class 的一个实例，以下`Item`是获取它的方法：

```
Item item = (Item) pageContext.findAttribute("item"); 
```

然后只需调用`getOptions()`它的方法。

### 也可以看看：

*   [我们的 EL wiki 页面](https://stackoverflow.com/tags/el/info)- 还解释了 EL 如何在后台工作

# javascript - javascript 在博客文章中不起作用

> ID：14007810
> 
> 赞同：1
> 
> 时间：2012-12-23T00:44:42.333
> 
> 标签：javascript, blogger

有什么想法可以更改此代码以在博客文章中工作吗？

```
<script language="JavaScript">
    function openWin(){
        var myBars='directories=no,location=no,menubar=no,status=no';
        var myOptions='scrollbars=no,top=200,left=390,width=451,height=345,resizeable=no';
        var myFeatures = myBars + ',' + myOptions;
        var newWin = open('', 'myDoc', myFeatures);
        newWin.document.writeln('<form>');
        newWin.document.writeln('<BODY BGCOLOR="#000000">');
        newWin.document.writeln('<embed src ="http://www.antenna.gr/webtv/images/fbplayer.swf?cid=07_f_y_mfa_y$_a_e=&volx=100&iu=1&telemetry=false" width="426" height="320" allowfullscreen="true"/>');
        newWin.document.writeln('</form>');
        newWin.document.close();
        newWin.focus();
    }
</script>

<form>
    <input type=BUTTON title="Δείτε το Επεισόδιο!" value="01" onClick='openWin()'>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:49:23.743

好吧，首先您将标签写入标签*之前*的`<form>`新窗口，但除此之外......***为什么？****`<body>`*

 **为什么需要弹出窗口？为什么不首先将内容放在主窗口中？为什么不将其加载到当前窗口中？

无论如何，这不是答案中应该包含的内容。我给你的答案是你可能无法在浏览器中打开弹出窗口。例如，某些浏览器会阻止尝试隐藏地址栏的弹出窗口。

如果这没有任何帮助，请尝试更具体地说明“它不起作用”的含义。**

# .net - 多态泛型

> ID：14007816
> 
> 赞同：3
> 
> 时间：2012-12-23T00:45:10.017
> 
> 标签：.net, vb.net, oop, generics, polymorphism

我有一个通用类`Command(Of T)`

命令（部分）定义为：

```
Public Class Command(Of T As BaseType)
    Inherits Command
    Public Property Condition As Func(Of T, Boolean)
End Class 
```

我想创建一个所有命令的列表，然后当我收到一个 object`A`时，拉出所有与我的通用类型相同的命令，`A`调用`Condition(A)`返回 true

我可以

```
Dim B As List(Of BaseType)
B.Add(New DerivedType) 
```

但

```
Dim C As New List(Of Command(Of BaseType))
C.Add(New Command(Of DerivedType)) 
```

引发转换错误。

我可以`Command`从非泛型对象继承（我们称之为`CommandBase`...）

```
Dim C As New List(Of CommandBase)
C.Add(New Command(Of DerivedType)) 
```

哪个有效，但现在我无法回到特定于类型的参考。这将获得正确的命令对象：

```
Dim CommandsOfTypeA = B.Where(function(x) x.GetType.GetGenericArguments(0).FullName = A.GetType.FullName) 
```

但是我现在看不到该怎么做...

```
Dim MatchingCommands = CommandsOfTypeA.Where(function(x) c.Condition(A)) 
```

由于 CommandsOfTypeA`List(Of Command)`不是`List(Of Command(Of DerivedType))`

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T01:09:23.867

问题在于，虽然 的实例`DerivedType`是 的实例`BaseType`，但这并不一定意味着 的实例`Command(Of DerivedType)`是 的实例`Command(Of BaseType)`。默认情况下，泛型类型参数不考虑类型层次结构。

在编程语言理论中，实现这一点的特性称为[协方差](http://en.wikipedia.org/wiki/Covariance_and_contravariance_%28computer_science%29)。

.net 4.0 确实对此提供了一些支持，尽管它只能应用于接口，而不是类。 [这](http://msdn.microsoft.com/en-us/library/dd997386.aspx)是有关该主题的一些文档。

基本上，它看起来像这样：

```
Interface ICovariant(Of Out R)
    Function GetSomething() As R
    ' The following statement generates a compiler error. 
    ' Sub SetSomething(ByVal sampleArg As R) 
End Interface 
```

这仅在您的泛型类型仅用作方法输入、从不输出或`ref`或`output`参数时才有效（如图所示）。

# android - Android Mask 两张Bitmap清除边框

> ID：14007820
> 
> 赞同：1
> 
> 时间：2012-12-23T00:46:25.533
> 
> 标签：android, bitmap, masking

我将掩码与另一个位图一起使用。操作成功，不幸的是，遮罩的结果看到了一个轻微的黑色边框，如图所示：

![在此处输入图像描述](../Images/95cb122dfb55708eff20b700b336d8e0.png)

如何删除此边框？在源图像中不存在。

我将发布我正在使用的代码：

```
public Bitmap mask(Bitmap source) {
    Bitmap targetBitmap = Bitmap.createBitmap(getWidth(),getHeight(),
            Bitmap.Config.ARGB_8888);
    Canvas canvas = new Canvas(targetBitmap);
    Paint paint = new Paint(Paint.ANTI_ALIAS_FLAG);
    paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.DST_IN));
    paint.setAntiAlias(true);
    paint.setDither(true);
    canvas.drawBitmap(source, 0, 0, null);
    canvas.drawBitmap(getMask(), 0, 0, paint);
    paint.setXfermode(null);
    return targetBitmap;        
} 
```

其中 getMask() 返回表示拼图图形的位图。希望能得到大家的帮助，谢谢大家

对不起我的英语不好 ：-）

更新：

黑色边框是我在这张图片中指出的：

![在此处输入图像描述](../Images/337705e6a5e4d65fd4d97ec70e568e7b.png)

更新：

放置变换的顺序。第三幅图像与第一幅图像相同，但没有颜色。问题是拼图的黑边。我希望更清楚：

![在此处输入图像描述](../Images/a4f236257d173439502dbb272058d0cf.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T09:05:44.373

我用蒙版绘制图像的方式与你所做的相反。

```
public Bitmap mask(Bitmap source) {
    Bitmap targetBitmap = Bitmap.createBitmap(getWidth(),getHeight(), Bitmap.Config.ARGB_8888);
    Canvas canvas = new Canvas(targetBitmap);
    Paint paint = new Paint(Paint.ANTI_ALIAS_FLAG);
    paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.SRC_IN));
    // paint.setAntiAlias(true); // you've already set this in the constructor
    paint.setDither(true);
    canvas.drawBitmap(getMask(), 0, 0, null);
    canvas.drawBitmap(source, 0, 0, paint);
    // paint.setXfermode(null); // no need for this
    return targetBitmap;        
} 
```

请注意，PorterDuff.Mode 设置为 SRC_IN（不是 DST_in），并且首先绘制蒙版，然后在该蒙版上绘制图像。使用这种方法，您还可以将先前的源绘制为基本蒙版，添加新的（拼图）蒙版，然后在其上绘制最终的源/图像，并使用 SRC_IN 绘制每次添加新的拼图。如果这不能解决黑色边框，请检查您的蒙版是否没有可能导致这些问题的羽化（透明）边缘。

此外，ANTI_ALIAS_FLAG 对纹理没有任何作用。如果您想要平滑缩放的纹理，请使用 paint.setFilterBitmap(true);

# terminal - 如何在终端上使用谷歌？

> ID：14007823
> 
> 赞同：-1
> 
> 时间：2012-12-23T00:47:00.067
> 
> 标签：terminal

这可能有些荒谬，但有时我需要在服务器上工作并且没有 X 接口。如何在类 Unix 终端中使用 Google 及其搜索结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:49:59.273

如果您要问的话，那里有一堆终端网络浏览器。links2 可能是最著名的。

[http://links.twibright.com/](http://links.twibright.com/)

[这里是终极的一切基于终端的日常生活程序。](http://www.terminally-incoherent.com/blog/2007/05/21/a-day-without-x/)

# php - 目录的基本名称

> ID：14007828
> 
> 赞同：1
> 
> 时间：2012-12-23T00:48:40.790
> 
> 标签：php

```
$f = $_GET['f'];
//f = filename i.e file.mp3
header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename='.basename($f));
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
header('Pragma: public');
header('Content-Length: ' . filesize($f));
ob_clean();
flush(); 
```

如果我将所有 mp3 文件存储在根目录中，则此代码有效，但如果我将它们存储在单独的文件夹中，例如 /files

我尝试更改基本名称并添加路径`$f`但没有运气

有没有办法让这段代码从目录而不是根目录下载文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:54:46.160

那将是因为`basename`明确剥离了文件路径的文件名部分以外的所有内容。所以`basename("foo/bar/baz.mp3")`产生“baz.mp3”。

正如其他人已经提到的那样，你编写 PHP 脚本的方式是一个主要的安全漏洞，因为现在有人可以做类似“www.example.com/index.php?f=index.php”和你的脚本（假设它位于 www.example.com/index.php）将提供自己的源。只要有一点创意，您的脚本可以访问的任何外部文件都可以通过这种方式下载。不好，您确实需要将文件限制在允许路径的*白名单中。*

# python - 用于解析到行尾的词法分析器

> ID：14007832
> 
> 赞同：0
> 
> 时间：2012-12-23T00:49:24.227
> 
> 标签：python, ply

如果我有一个关键字，一旦遇到关键字，我怎么能得到它来获取该行的其余部分并将其作为字符串返回？一旦遇到行尾，返回该行上的所有内容。

这是我正在查看的行：

```
 description here is the rest of my text to collect 
```

因此，当词法分析器遇到描述时，我希望“这是我要收集的其余文本”作为字符串返回

我定义了以下内容，但似乎引发了错误：

```
states = (
     ('bcdescription', 'exclusive'),
)

def t_bcdescription(t):
    r'description '
    t.lexer.code_start = t.lexer.lexpos
    t.lexer.level = 1
    t.lexer.begin('bcdescription')

def t_bcdescription_close(t):
    r'\n'
    t.value = t.lexer.lexdata[t.lexer.code_start:t.lexer.lexpos+1]
    t.type="BCDESCRIPTION"
    t.lexer.lineno += t.valiue.count('\n')
    t.lexer.begin('INITIAL')
    return t 
```

这是返回的错误的一部分：

```
 File "/Users/me/Coding/wm/wm_parser/ply/lex.py", line 393, in token
raise LexError("Illegal character '%s' at index %d" % (lexdata[lexpos],lexpos), lexdata[lexpos:])
ply.lex.LexError: Illegal character ' ' at index 40 
```

最后，如果我想要这个功能用于多个令牌，我该如何实现呢？

谢谢你的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-25T11:27:03.803

你的代码没有大问题，其实我只是复制你的代码并运行它，它运行良好

```
import ply.lex as lex 

states = ( 
     ('bcdescription', 'exclusive'),
)

tokens = ("BCDESCRIPTION",)

def t_bcdescription(t):
    r'\bdescription\b'
    t.lexer.code_start = t.lexer.lexpos
    t.lexer.level = 1 
    t.lexer.begin('bcdescription')

def t_bcdescription_close(t):
    r'\n'
    t.value = t.lexer.lexdata[t.lexer.code_start:t.lexer.lexpos+1]
    t.type="BCDESCRIPTION"
    t.lexer.lineno += t.value.count('\n')
    t.lexer.begin('INITIAL')
    return t

def t_bcdescription_content(t):
    r'[^\n]+'

lexer = lex.lex()
data = 'description here is the rest of my text to collect\n'
lexer.input(data)

while True:
    tok = lexer.token()
    if not tok: break      
    print tok 
```

结果是：

```
LexToken(BCDESCRIPTION,' here is the rest of my text to collect\n',1,50) 
```

所以也许你可以检查你的代码的其他部分

如果我想要这个功能用于多个标记，那么您可以简单地捕获单词，当这些标记中出现一个单词时，开始通过上面的代码捕获其余内容。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-23T20:45:05.610

在没有更多信息的情况下，为什么需要为此使用词法分析器/解析器并不明显。

```
>>> x = 'description here is the rest of my text to collect'
>>> a, b = x.split(' ', 1)
>>> a
'description'
>>> b
'here is the rest of my text to collect' 
```

# jquery - 避免递归调用 .ajax();

> ID：14007837
> 
> 赞同：1
> 
> 时间：2012-12-23T00:50:17.010
> 
> 标签：jquery, ajax, recursion

```
flagUpdateCustomer = 0;
$("input#checknames").click(function () {
    $.ajax({
        url: 'php.scripts/checknames.php',
        data: { firstname: $("input#firstname").val(),
            lastname: $("input#lastname").val(),
            address1: $("input#address1").val(),
            address2: $("input#address2").val(),
            city: $("input#city").val(),
            state: $("input#state").val(),
            zip: $("input#zip").val(),
            phone: $("input#phone").val(),
            email: $("input#email").val(),
            cell: $("input#cell").val()
        },
        type: 'post',
        async: false,
        success: function (output) {
            var obj = $.parseJSON(output);
            $("#existcustomers").empty();
            for (var iCnt = 0; iCnt < obj.length; iCnt++) {
                if (obj[iCnt].firstname == null) { obj[iCnt].firstname = ""; }
                if (obj[iCnt].lastname == null) { obj[iCnt].lastname = ""; }
                if (obj[iCnt].address1 == null) { obj[iCnt].address1 = ""; }
                if (obj[iCnt].address2 == null) { obj[iCnt].address2 = ""; }
                if (obj[iCnt].city == null) { obj[iCnt].city = ""; }
                if (obj[iCnt].state == null) { obj[iCnt].state = ""; }
                if (obj[iCnt].zip == null) { obj[iCnt].zip = ""; }
                if (obj[iCnt].phone == null) { obj[iCnt].phone = ""; }
                if (obj[iCnt].email == null) { obj[iCnt].email = ""; }
                if (obj[iCnt].cell == null) { obj[iCnt].cell = ""; }

                var newRow = $("<tr><td>" + obj[iCnt].firstname + "</td><td>" + obj[iCnt].lastname + "</td><td>" + obj[iCnt].address1 + "</td><td>" + obj[iCnt].address2 + "</td><td>" + obj[iCnt].city + "</td><td>" + obj[iCnt].state + "</td><td>" + obj[iCnt].zip + "</td><td>" + obj[iCnt].phone + "</td><td>" + obj[iCnt].email + "</td><td>" + obj[iCnt].cell + "</td></tr>").data('id',obj[iCnt].id);
                $("#existcustomers").append(newRow);
            }

            $("#existcustomers tr").hover(function () { $(this).addClass("highlight"); }, function () { $(this).removeClass("highlight"); });

            $("#existcustomers tr").click(function () {

                $("#form-main").data('id', $(this).data('id'));

                $("input#firstname").val($(this).children(":eq(0)").text());
                $("input#lastname").val($(this).children(":eq(1)").text());
                $("input#address1").val($(this).children(":eq(2)").text());
                $("input#address2").val($(this).children(":eq(3)").text());
                $("input#city").val($(this).children(":eq(4)").text());
                $("input#state").val($(this).children(":eq(5)").text());
                $("input#zip").val($(this).children(":eq(6)").text());
                $("input#phone").val($(this).children(":eq(7)").text());
                $("input#email").val($(this).children(":eq(8)").text());
                $("input#cell").val($(this).children(":eq(9)").text());

                $("input#firstname").attr('disabled', 'disabled');
                $("input#lastname").attr('disabled', 'disabled');
                $("input#address1").attr('disabled', 'disabled');
                $("input#address2").attr('disabled', 'disabled');
                $("input#city").attr('disabled', 'disabled');
                $("input#state").attr('disabled', 'disabled');
                $("input#zip").attr('disabled', 'disabled');
                $("input#phone").attr('disabled', 'disabled');
                $("input#email").attr('disabled', 'disabled');
                $("input#cell").attr('disabled', 'disabled');

                $("#form-main").data('firstname', $("input#firstname").val());
                $("#form-main").data('lastname', $("input#lastname").val());
                $("#form-main").data('address1', $("input#address1").val());
                $("#form-main").data('address2', $("input#address2").val());
                $("#form-main").data('city', $("input#city").val());
                $("#form-main").data('state', $("input#state").val());
                $("#form-main").data('zip', $("input#zip").val());
                $("#form-main").data('phone', $("input#phone").val());
                $("#form-main").data('email', $("input#email").val());
                $("#form-main").data('cell', $("input#cell").val());

                //I am trying to determine how to call .ajax again to set my $_SESSION in PHP
                //A recursive call to .ajax does not seem to be a good option here
                //I was hoping to see somthing about an onchange or onupdate event in the jQuery docs
                //for .data() however I had no such luck. Perhaps could I use just the onchange()
                //event of #form-main? Essentially once the data is set in #form-main I have to call
                //.ajax again for add.customer.session.php. I am confused right now.

                //????????????????

                //
                //

                $('#form-main').css('background-color', 'green');
            });
        }

    });  

}); 
```

我有一个调用，`.ajax()`并且在该调用的内部设置了一个`$("#existcustomers tr").click()`，并且在该单击内部处理事情的最合乎逻辑的方式将是`.ajax()`对第一个内部的另一个调用，但是我正在寻找另一个选项。我现在想知道是否有一些简单的方法可以将事件挂钩`#form-main`并在`.data()`将数据设置为`#form-main`. 一如既往地提前感谢大家提供与此代码相关的任何建议或评论！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T01:03:09.443

我认为您在这里没有递归问题。您只是链接了 ajax 调用。如果它可以循环并再次调用原始操作，这真的只是一个问题。

由于知道您的第一个 ajax 调用将进行另一个 ajax 调用，因此您可以同时进行异步调用，或者如果您可以控制服务器 API，则允许在一次调用中设置/请求两种类型的数据。

# wpf - 使用模板化的 MenuItem 关闭 ContextMenu

> ID：14007838
> 
> 赞同：5
> 
> 时间：2012-12-23T00:50:18.313
> 
> 标签：wpf, xaml, contextmenu, controltemplate

我创建了一个自定义的上下文菜单，在其中更改了所有项目的外观。这些项目包含不同的控件，如组合框和按钮。现在，如果按下按钮或选择了组合框项，我希望菜单关闭。目前菜单只是保持打开状态。你能给我一个提示吗？

这是一个简化的代码来显示我做了什么：

```
<ContextMenu StaysOpen="False">
    <MenuItem>
        <MenuItem.Template>
            <ControlTemplate>
                <Grid MinWidth="200">
                    <Button Command="{Binding SomeWorkingCommandBinding}">OK</Button>
                </Grid>
            </ControlTemplate>
        </MenuItem.Template>
    </MenuItem>
</ContextMenu> 
```

如前所述，当我点击 OK 按钮时，我想关闭菜单。

**更新**

以下按钮（或任何其他控件）无需 Blend SDK 即可完成任务：

```
<Button.Triggers>
    <EventTrigger RoutedEvent="Button.Click">
        <BeginStoryboard>
            <Storyboard>
                <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(ContextMenu.IsOpen)" Storyboard.Target="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=ContextMenu}}">
                    <DiscreteObjectKeyFrame KeyTime="0:0:0">
                        <DiscreteObjectKeyFrame.Value>
                            <sys:Boolean>False</sys:Boolean>
                        </DiscreteObjectKeyFrame.Value>
                    </DiscreteObjectKeyFrame>
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>
        </BeginStoryboard>
    </EventTrigger>
</Button.Triggers> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T09:11:25.937

单击按钮后，使用[Blend SDK](http://www.microsoft.com/en-us/download/details.aspx?id=10801)`ChangePropertyAction`的一部分更改 ContextMenu 的属性：`IsOpen`

```
<ContextMenu x:Name="MyContextMenu">
  <MenuItem>
    <MenuItem.Template>
        <ControlTemplate>
            <Grid MinWidth="200">
                <Button Command="{Binding SomeWorkingCommandBinding}" Content="OK">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Click">
                            <ei:ChangePropertyAction TargetObject="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=ContextMenu}}" PropertyName="IsOpen" Value="False"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </Button>
            </Grid>
        </ControlTemplate>
    </MenuItem.Template>
  </MenuItem>
</ContextMenu> 
```

您将需要以下命名空间：

```
xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"                  
xmlns:ei="clr-namespace:Microsoft.Expression.Interactivity.Core;assembly=Microsoft.Expression.Interactions" 
```

# objective-c - 我可以从 TWTweetComposeViewController 类中获取推文 ID 吗？

> ID：14007846
> 
> 赞同：0
> 
> 时间：2012-12-23T00:53:13.670
> 
> 标签：objective-c, ios, xcode, twitter

似乎无法从`TWTweetComposeViewController`. 如果是这种情况，我是否应该让用户以其他方式发推文，以便获得推文 ID？

我需要它来创建对推文的回复。

另外，是否可以在推文中添加推文ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T02:41:02.237

该类`TWTweetComposeViewController`仅具有以下公共属性/方法：

```
+ canSendTweet
– setInitialText:
– addImage:
– addURL:
– removeAllImages
– removeAllURLs
completionHandler 
```

[TWTweetComposeViewController 参考](http://developer.apple.com/library/ios/#documentation/Twitter/Reference/TWTweetSheetViewControllerClassRef/Reference/Reference.html)

用户的所有社交帐户信息（Facebook 和 Twitter）都存储在`ACAccount`.

[Apple 帐户参考](http://developer.apple.com/library/ios/#documentation/Accounts/Reference/ACAccountClassRef/Reference/Reference.html#//apple_ref/doc/uid/TP40011019)

# java - 如何在球体周围包裹纹理？

> ID：14007851
> 
> 赞同：1
> 
> 时间：2012-12-23T00:55:30.600
> 
> 标签：java, opengl, geometry, textures, jogl

我用 drawSphere 方法创建了一个类来替换 glutDrawSolidSphere。请参阅下面的代码。

但我想知道，如何在不平铺的情况下将纹理包裹起来？例如，如果我想在上面画一张嘴、眼睛和鼻子，那么我希望它只有一张嘴、两只眼睛和一个鼻子，而不是在球体上铺满 100 个平铺。

我正在将 Jogl 与一些库一起使用。

```
class Shape {

    public void drawSphere(double radius, int slices, int stacks) {
        gl.glEnable(GL_TEXTURE_2D);
        head.bind(gl); //This method is a shorthand equivalent of gl.glBindTexture(texture.getTarget(), texture.getTextureObject());
        gl.glBegin(GL_QUADS);
        double stack = (2*PI)/stacks;
        double slice = (2*PI)/slices;
        for (double theta = 0; theta < 2 * PI; theta += stack) {
            for (double phi = 0; phi < 2 * PI; phi += slice) {
                Vector p1 = getPoints(phi, theta, radius);
                Vector p2 = getPoints(phi + slice, theta, radius);
                Vector p3 = getPoints(phi + slice, theta + stack, radius);
                Vector p4 = getPoints(phi, theta + stack, radius);
                gl.glTexCoord2d(0, 0);
                gl.glVertex3d(p1.x(), p1.y(), p1.z());
                gl.glTexCoord2d(1, 0);
                gl.glVertex3d(p2.x(), p2.y(), p2.z());
                gl.glTexCoord2d(1, 1);
                gl.glVertex3d(p3.x(), p3.y(), p3.z());
                gl.glTexCoord2d(0, 1);
                gl.glVertex3d(p4.x(), p4.y(), p4.z());
            }
        }
        gl.glEnd();
        gl.glDisable(GL_TEXTURE_2D);
    }

    Vector getPoints(double phi, double theta, double radius) {
        double x = radius * cos(theta) * sin(phi);
        double y = radius * sin(theta) * sin(phi);
        double z = radius * cos(phi);
        return new Vector(x, y, z);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T01:00:38.327

您可以将纬度和经度直接映射到纹理坐标。

```
for (double theta = 0; theta < 2 * PI; theta += stack) {
    for (double phi = 0; phi < 2 * PI; phi += slice) { 
```

只需缩放`theta`并`phi`介于 0 和 1 之间。

```
double s0 = theta / (2 * PI);
double s1 = (theta + stack) / (2 * PI);
double t0 = phi / (2 * PI);
double t1 = (phi + slice) / (2 * PI); 
```

并在 texCoord() 调用中使用`s0`, `s1`, `t0`,`t1`代替 0 和 1。

# java - 在我的 Rest 服务中难以实现 PUT 注释

> ID：14007853
> 
> 赞同：0
> 
> 时间：2012-12-23T00:55:58.110
> 
> 标签：java, hibernate, tomcat, maven

我正在使用 Java、Maven、Hibernate 3/JPA、Eclipse 来实现用于填充 Mysql 数据库的 PUT 方法。

这是我的 POJO

```
 import static javax.persistence.GenerationType.IDENTITY;
    import java.util.Date;
    import javax.persistence.Column;
    import javax.persistence.Entity;
    import javax.persistence.GeneratedValue;
    import javax.persistence.Id;
    import javax.persistence.Table;
    import javax.persistence.Temporal;
    import javax.persistence.TemporalType;
    import javax.persistence.UniqueConstraint;

    @Entity
    @Table(name = "Person", catalog = "mydb", uniqueConstraints = {
                        @UniqueConstraint(columnNames = "Person"),})
    public class Person implements java.io.Serializable {
    private static final long serialVersionUID = 1L;
    private Integer id;
    private String Name;
    @Id
    @GeneratedValue(strategy = IDENTITY)
    @Column(name = "id", unique = true, nullable = false)
    public Integer getId() {
    return id;
    }

    public void setId(Integer id) {
    this.id = id;
    }

    @Column(name = "name", unique = true, nullable = false, length = 30)
    public String getName() {
    return flowName;
    }

    public void setName(String Name) {
    this.Name = Name;
    }

    } 
```

这是我的注释类。

```
import javax.ws.rs.Consumes;
    import javax.ws.rs.PUT;
    import javax.ws.rs.Path;
    import javax.ws.rs.Produces;
    import javax.ws.rs.core.MediaType;
    import org.apache.log4j.Logger;
    import org.hibernate.Session;
    import com.google.gson.Gson;
    import com.tracker.domain.Flow;
    import com.tracker.persistence.HibernateUtil;

    public class PersonService {
    private Logger LOG = Logger.getLogger(TrackerService.class);

    String JsonString = "{\"name\":\"John Doe\"}";
    Gson gson = new Gson();
    Person person = gson.fromJson(JsonString,Person.class);

    @PUT
    @Path("")
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    public void processandSaveJson(Person person) {

    Session session = HibernateUtil.getSessionFactory().getCurrentSession();
    String Name = Person.getName();
    person.setName(Name);
    session.beginTransaction();
    session.save(person);
    session.getTransaction().commit();
    }
    } 
```

这是我的 Hibernate.Util。

```
import org.hibernate.SessionFactory;
    import org.hibernate.cfg.AnnotationConfiguration;

    public class HibernateUtil {

    private static final SessionFactory sessionFactory = buildSessionFactory();
    private static SessionFactory buildSessionFactory() {

    try {
    // Create the SessionFactory from hibernate.cfg.xml
    return new AnnotationConfiguration().configure().buildSessionFactory();
    } catch (Throwable ex) {

    // Make sure you log the exception, as it might be swallowed
    System.err.println("Initial SessionFactory creation failed." + ex);
    throw new ExceptionInInitializerError(ex);
    }
    }

 public static SessionFactory getSessionFactory() {
    return sessionFactory;
    }

    public static void shutdown() {
    // Close caches and connection pools
    getSessionFactory().close();
    }
    } 
```

这是我的 SessionFactory 上下文监听器类

```
import javax.servlet.ServletContextEvent;
    import javax.servlet.ServletContextListener;
    import javax.servlet.annotation.WebListener;
    import org.apache.log4j.Logger;
    import org.hibernate.Session;

    @WebListener
    public class SessionFactoryListener implements ServletContextListener {
    private Logger LOG = Logger.getLogger(SessionFactoryListener.class);

    @Override
    public void contextInitialized(ServletContextEvent arg0) {
    if (LOG.isInfoEnabled()) {
    LOG.info("\n\tInside contextInitialized()---\n");
    }

    Session session = HibernateUtil.getSessionFactory().openSession();
    }

    @Override
    public void contextDestroyed(ServletContextEvent arg0) {
    if (LOG.isInfoEnabled()) {
    LOG.info("\n\tInside contextDestroyed()\n");
    }

    HibernateUtil.shutdown();   
    }   

    } 
```

当我尝试使用 Tomcat 服务器运行它时，我收到以下错误。

```
type Status report
message Method Not Allowed
description The specified HTTP method is not allowed for the requested resource. 
```

我对此很陌生。请让我知道我做错了什么。我尝试使用上述值将记录插入 mysql 数据库。请帮帮我。

谢谢，杰克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T11:06:31.097

如评论中所述，您应该提供您的调用代码以及其他代码。但是由于您已经提到您正在使用浏览器发出请求，因此应该提到大多数/没有浏览器在不使用 javadcript 的情况下支持“放置”。你在做什么看起来像一个简单的'get'。因此解决方案是在您的表单提交中使用 javascript，或者丢弃 REST 并使用反映该方法的 Url（例如 /person/new/ 和 /person/{personId}

# java - Java while循环和随机方法

> ID：14007857
> 
> 赞同：0
> 
> 时间：2012-12-23T00:56:50.917
> 
> 标签：java, loops, random

我目前正在学习 Java 并正在学习 while 循环。如何使用 random() 方法生成随机负数？另外，如何使程序打印出仅在某个范围内的值？例如，假设 Java 选择 10 个随机数，我怎样才能让它只显示 0.6 和 0.8 之间的数字？

```
 double randomNumber;
    int counter = 0;

    while(counter <= 99)
    {
        randomNumber = Math.random();
        System.out.println(randomNumber);
         counter++; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T01:01:00.597

`Math.random()`给你一个介于 0.0（含）和 1.0（不包括）之间的数字，因此获取其他范围的传统方法是乘以范围的宽度并将范围的底部添加到它。因此：

```
Math.random() * 0.2 + 0.6 
```

会给你[0.6，0.8）的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-23T01:03:21.907

要*获得*该范围内的随机数：

```
double r = Math.random(); // -> [0, 1)
r = r * 0.2;              // scale     -> [0, 0.2)
r = r + 0.6;              // translate -> [0.6, 0.8) 
```

（可以进行类似的数学运算来创建负数或映射到任意范围。）

如果数字已经在该范围内，则“只做某事”：

```
double r = Math.random(); // -> [0, 1)
if (r >= 0.6 && r < 0.8) {
    // r -> [0.6, 0.8)
} else {
    // r -> not in above range
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T01:00:39.757

不确定您是只想要负数还是组合。仅负数，只需乘以`-1.0d`：

```
double random = Math.random() * -1.0f; // range ]-1, 0] 
```

对于组合，正面和负面，使用：

```
double random = 2.0d * (Math.random() - 0.5d); // range [-1, 1[ 
```

* * *

对于第二个问题，使用简单的 if：

```
double random = 2.0d * (Math.random() - 0.5d);
if (0.6d < random && random < 0.8d)
{
     System.out.println(random);
} 
```

# php - 从 PHP 将 FLAC 发布到 Google Voice Recognition API

> ID：14007868
> 
> 赞同：2
> 
> 时间：2012-12-23T00:59:36.463
> 
> 标签：php, speech-to-text, http-post

我在 PHP 方面非常有经验，但我一直在连接服务器之间遇到问题，例如**"post"**。我有一个需要**发布**到 Google 语音识别 API 服务器的 FLAC 音频文件。我也不知道如何“倾听”它的回应。我想要一个这样的脚本，假设存在这种函数：

```
<?php

   $fileId = $_GET['fileId'];
   $filepath = $fileId . ".flac";
   recognize($filepath);

  function recognize($pathToFile) {

      //It's the following function that I'm looking for 
      $response = $pathToFile->post("http://www.google.com/speech-api/v1/.....&client=chromium"); 

      //The $response would be the short JSON that Google feed back.
      echo $response;

  }

?> 
```

## 编辑

我按照教程创建了一个使用 Wget --post 发布我的 FLAC 文件的 Shell 脚本。我想这样发布，但是在 PHP 中。此外，在命令的末尾，有这一`> answer.ret`行，以便 Google 的答案将写入此文件。我想知道PHP中是否有替代方法。这是命令行：

```
wget -q -U "Mozilla/5.0" --post-file audio1.flac --header="Content-Type: audio/x-flac; rate=16000" -O - "http://www.google.com/speech-api/v1/recognize?lang=fr-fr&client=chromium" > trancription1.ret 
```

## 编辑 2

我想出了如何做到这一点，@hakre 的回答并为好奇的人烘焙了一个小要点。这是：[https](https://gist.github.com/chlkbumper/4969389) ://gist.github.com/chlkbumper/4969389 。不要忘记 FLAC 文件*必须是 16k 比特率的 FLAC*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T01:24:59.270

POST 请求只是一个标准的 HTTP 请求，[只是指定了 POST 方法](https://www.rfc-editor.org/rfc/rfc2616#section-9.5)。HTTP 请求和 HTTP 响应的其余部分几乎相同。

顺便说一句，您会以 HTTP 响应的形式获得请求的响应。这绝对是[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616)中定义的 normaltiv - 仅与本文档相关，它解释了*一切*。

PHP 中发送 HTTP 请求的一个函数是[`file_get_contents`](http://php.net/file_get_contents)，它返回请求响应。这是通过[HTTP 流包装器](http://php.net/wrappers.http)完成的，它提供了一些发送 POST 请求所需的选项（默认为 GET）。请参阅[HTTP 上下文选项](http://php.net/context.http)。

另一个用于发送 HTTP 请求的流行 PHP 扩展是[Curl 绑定](http://php.net/book.curl)。

# java - 用手指画

> ID：14007875
> 
> 赞同：4
> 
> 时间：2012-12-23T01:01:30.067
> 
> 标签：java, android, drawing

我找到了这个小示例代码，用手指画图：http:
[//marakana.com/tutorials/android/2d-graphics-example.html](http://marakana.com/tutorials/android/2d-graphics-example.html)

以下是一些相关代码：

```
List<Point> points = new ArrayList<Point>();

@Override
public void onDraw(Canvas canvas) {
    for (Point point : points) {
        canvas.drawCircle(point.x, point.y, 5, paint);
    }
}

public boolean onTouch(View view, MotionEvent event) {
    Point point = new Point();
    point.x = event.getX();
    point.y = event.getY();
    points.add(point);
    invalidate();
    Log.d(TAG, "point: " + point);
    return true;
} 
```

我正在查看它，看到他们正在向 ArrayList 添加点，然后循环遍历 ArrayList，这似乎不是一种非常优化的方法。有更好的方法还是这是一个好方法？

在我的三星 GS3 上测试后，我用 20 的圆圈大小为整个屏幕上色，越接近全彩色，绘制速度就越慢，然后圆圈之间的距离越来越远。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T06:17:45.867

首先，使用描边（不是圆圈）来画线。二、近似。这是一个摘要：

1.  更改`Paint`为使用带有 的笔划`width=5`。这减少了绘制这么多圆圈的需要。
2.  选择一个阈值，例如，在该阈值`3px`之后您将在 中添加一个点`onTouch()`。

    ```
    if (Math.abs(previousX - event.getX()) < THRESHOLD
            && Math.abs(previousY - event.getY()) < THRESHOLD) {
        return;
    }
    previousX = event.getX();
    previousY = event.getY();
    // drawing update goes here 
    ```

    这应该会减少（不引人注意的）点数。

3.  使用`Picture`or`Path`类画线，并使用`Canvas.drawPath()`or `Canvas.drawPicture()`。这，特别是对于大量的点，将真正加快绘图速度，因为所有绘图命令都将在一次调用中传递给内部绘图函数。

4.  根据需要简化形状。例如，您可以删除最旧的点（这将是使用[循环缓冲区](http://en.wikipedia.org/wiki/Circular_buffer)的完美案例），使用[Ramer-Douglas-Peucker 算法](http://en.wikipedia.org/wiki/Ramer%E2%80%93Douglas%E2%80%93Peucker_algorithm)，该算法非常容易实现，结果良好且复杂度为`O(nlogn)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T01:10:37.613

不，这在这个例子中是有意义的。

他遍历所有他想画的点。这意味着他将每个点都添加到数组中，因此他可以一次循环遍历所有对象。

你会经常在游戏编程中看到这一点。

* * *

这也是非常可扩展的。

1.  您可以根据需要添加任意数量的点
2.  它支持多态性
3.  您不必为多个点创建变量 > 更少的代码

# java - 类方法调用第一次运行良好，但在退出活动并尝试第二次运行计算后非常慢

> ID：14007877
> 
> 赞同：2
> 
> 时间：2012-12-23T01:02:15.943
> 
> 标签：java, android, class, methods, static

好的，那么问题来了：

我正在制作一个随机生成地形的游戏。地形一次生成并保存到磁盘/SD卡。它做得很好:)

为此，我运行一个 SplashScreenActivity，它运行我的初始启动画面、世界创建或世界加载，具体取决于它的启动方式。实际的程序生成是使用 4D Simplex Noise 使用 Stefan Gustavson 编写并由 Peter Eastman 优化的类完成的（并由我自己优化和加速至少 50%，将变量拉出并使它们成为静态......但问题是我'我即将描述这些变化之前发生的事情）。

基本上我使用他们的噪音功能来填充瓷砖的噪音。在我的世界创建循环中，我循环遍历所有图块，并遍历所有像素，调用类的 SimplexNoise4D.noise(x,y,z,w) 函数来填充每个像素（我计划发送一个 xyzw-per-pixel 集合到该类，以便它可以在该类上运行该方法以更快地访问）。

无论如何，这一切都很好。但是当我退出游戏活动并返回主菜单时，如果我尝试再次运行世界创建，访问 SimplexNoise 类方法（.noise 方法及其使用的内部方法）很慢！！！让调用以正常速度运行的唯一方法是退出整个应用程序（使用任务管理器杀死它）并重新启动应用程序。然后，我第一次运行它时，瓷砖的创建速度就达到了应有的速度。使用调试/方法分析等，似乎对 .noise 方法的调用和对 dot 方法的调用在我第二次尝试运行整个世界创建事物时花费了大量时间。

所以，再次，我第一次循环并使用 SimplexNoise.noise(xyzw) 访问时，它运行良好。然而，第二次访问所有图块中的所有像素（在进入游戏之后），并且对类的所有方法调用都需要永远。

有谁知道为什么会发生这种情况以及如何阻止它发生？

- 编辑 - 只是为了清除问题，应用程序的工作方式如下： mainmenuActivity ->chooseWorldSizeActivity->Splashscreen 通过大量调用 SimplexNoise.noise(xywz)->exit splashscreen->start game Activity 创建世界。

这工作正常且速度快。但是，如果我随后退出 gameActivity（进入主菜单），然后 ->selectWordlSizeActivity->splashscreenActivity，现在对 SimplexNoise.noise(xyzw) 的调用需要永远完成。如果我停止整个应用程序（使用 atskkiller），那么世界创建需要正常时间才能再次运行。我真的不知道为什么！-/编辑-

调用循环（在 ASyncTask 的 doInBackground() 中）就是：

```
for(loop over rows of tiles)
    for(loop over column tiles)
        for(each pixel)
             create x, y, z, w;
             SimplexNoise.noise(xyzw); 
```

单纯形噪声类如下所示：

`

```
public final class SimplexNoise4D {  // Simplex noise in 2D, 3D and 4D
  private static final Grad grad3[] = {new Grad(1,1,0),new Grad(-1,1,0),new Grad(1,-1,0),new Grad(-1,-1,0),
                                 new Grad(1,0,1),new Grad(-1,0,1),new Grad(1,0,-1),new Grad(-1,0,-1),
                                 new Grad(0,1,1),new Grad(0,-1,1),new Grad(0,1,-1),new Grad(0,-1,-1)};

  private static final Grad grad4[]= {new Grad(0,1,1,1),new Grad(0,1,1,-1),new Grad(0,1,-1,1),new Grad(0,1,-1,-1),
                   new Grad(0,-1,1,1),new Grad(0,-1,1,-1),new Grad(0,-1,-1,1),new Grad(0,-1,-1,-1),
                   new Grad(1,0,1,1),new Grad(1,0,1,-1),new Grad(1,0,-1,1),new Grad(1,0,-1,-1),
                   new Grad(-1,0,1,1),new Grad(-1,0,1,-1),new Grad(-1,0,-1,1),new Grad(-1,0,-1,-1),
                   new Grad(1,1,0,1),new Grad(1,1,0,-1),new Grad(1,-1,0,1),new Grad(1,-1,0,-1),
                   new Grad(-1,1,0,1),new Grad(-1,1,0,-1),new Grad(-1,-1,0,1),new Grad(-1,-1,0,-1),
                   new Grad(1,1,1,0),new Grad(1,1,-1,0),new Grad(1,-1,1,0),new Grad(1,-1,-1,0),
                   new Grad(-1,1,1,0),new Grad(-1,1,-1,0),new Grad(-1,-1,1,0),new Grad(-1,-1,-1,0)};

  private static final short p[] = {151,160,137,91,90,15,
  131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,
  190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,
  88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,
  77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,
  102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,
  135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,
  5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,
  223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,
  129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,
  251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,
  49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,
  138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180};
  // To remove the need for index wrapping, double the permutation table length
  private static short perm[] = new short[512];
  private static short permMod12[] = new short[512];
  static {
    for(int i=0; i<512; i++)
    {
      perm[i]=p[i & 255];
      permMod12[i] = (short)(perm[i] % 12);
    }
  }

  // Skewing and unskewing factors for 2, 3, and 4 dimensions
  private static final double F2 = 0.5*(Math.sqrt(3.0)-1.0);
  private static final double G2 = (3.0-Math.sqrt(3.0))/6.0;
  private static final double F3 = 1.0/3.0;
  private static final double G3 = 1.0/6.0;
  private static final double F4 = (Math.sqrt(5.0)-1.0)/4.0;
  private static final double G4 = (5.0-Math.sqrt(5.0))/20.0;

  // This method is a *lot* faster than using (int)Math.floor(x)
  private static int fastfloor(double x) {
    int xi = (int)x;
    return x<xi ? xi-1 : xi;
  }

  private static double dot(Grad g, double x, double y) {
    return g.x*x + g.y*y; }

  private static double dot(Grad g, double x, double y, double z) {
    return g.x*x + g.y*y + g.z*z; }

  private static double dot(Grad g, double x, double y, double z, double w) {
    return g.x*x + g.y*y + g.z*z + g.w*w; }

  private static double n0, n1, n2, n3, n4; // Noise contributions from the five corners
  private static double s;// Factor for 4D skewing
  private static int i;
  private static int j;
  private static int k;
  private static int l;
  private static double t; // Factor for 4D unskewing
  private static double X0; // Unskew the cell origin back to (x,y,z,w) space
  private static double Y0;
  private static double Z0;
  private static double W0;
  private static double x0;  // The x,y,z,w distances from the cell origin
  private static double y0;
  private static double z0;
  private static double w0;
  private static int rankx;
  private static int ranky;
  private static int rankz;
  private static int rankw;
  private static int i1, j1, k1, l1; // The integer offsets for the second simplex corner
  private static int i2, j2, k2, l2; // The integer offsets for the third simplex corner
  private static int i3, j3, k3, l3; // The integer offsets for the fourth simplex corner
  private static double x1; // Offsets for second corner in (x,y,z,w) coords
  private static double y1;
  private static double z1;
  private static double w1;
  private static double x2; // Offsets for third corner in (x,y,z,w) coords
  private static double y2;
  private static double z2;
  private static double w2;
  private static double x3; // Offsets for fourth corner in (x,y,z,w) coords
  private static double y3;
  private static double z3;
  private static double w3;
  private static double x4; // Offsets for last corner in (x,y,z,w) coords
  private static double y4;
  private static double z4;
  private static double w4;
  // Work out the hashed gradient indices of the five simplex corners
  private static int ii;
  private static int jj;
  private static int kk;
  private static int ll;
  private static int gi0;
  private static int gi1;
  private static int gi2;
  private static int gi3;
  private static int gi4;

  private static double t0;
  private static double t1;
  private static double t2;
  private static double t3;
  private static double t4;

  // 4D simplex noise, better simplex rank ordering method 2012-03-09
  public static double noise(double x, double y, double z, double w) {

    ////double n0, n1, n2, n3, n4; // Noise contributions from the five corners
    // Skew the (x,y,z,w) space to determine which cell of 24 simplices we're in
    ////double s = (x + y + z + w) * F4; // Factor for 4D skewing
    s = (x + y + z + w) * F4; // Factor for 4D skewing
    /*int i = fastfloor(x + s);
    int j = fastfloor(y + s);
    int k = fastfloor(z + s);
    int l = fastfloor(w + s);
    double t = (i + j + k + l) * G4; // Factor for 4D unskewing
    double X0 = i - t; // Unskew the cell origin back to (x,y,z,w) space
    double Y0 = j - t;
    double Z0 = k - t;
    double W0 = l - t;
    double x0 = x - X0;  // The x,y,z,w distances from the cell origin
    double y0 = y - Y0;
    double z0 = z - Z0;
    double w0 = w - W0;*/
    i = fastfloor(x + s);
    j = fastfloor(y + s);
    k = fastfloor(z + s);
    l = fastfloor(w + s);
    t = (i + j + k + l) * G4; // Factor for 4D unskewing
    X0 = i - t; // Unskew the cell origin back to (x,y,z,w) space
    Y0 = j - t;
    Z0 = k - t;
    W0 = l - t;
    x0 = x - X0;  // The x,y,z,w distances from the cell origin
    y0 = y - Y0;
    z0 = z - Z0;
    w0 = w - W0;
    // For the 4D case, the simplex is a 4D shape I won't even try to describe.
    // To find out which of the 24 possible simplices we're in, we need to
    // determine the magnitude ordering of x0, y0, z0 and w0.
    // Six pair-wise comparisons are performed between each possible pair
    // of the four coordinates, and the results are used to rank the numbers.
    /*int rankx = 0;
      int ranky = 0;
      int rankz = 0;
      int rankw = 0;
      if(x0 > y0) rankx++; else ranky++;
      if(x0 > z0) rankx++; else rankz++;
      if(x0 > w0) rankx++; else rankw++;
      if(y0 > z0) ranky++; else rankz++;
      if(y0 > w0) ranky++; else rankw++;
      if(z0 > w0) rankz++; else rankw++;
      int i1, j1, k1, l1; // The integer offsets for the second simplex corner
      int i2, j2, k2, l2; // The integer offsets for the third simplex corner
      int i3, j3, k3, l3; // The integer offsets for the fourth simplex corner*/
    rankx = 0;
    ranky = 0;
    rankz = 0;
    rankw = 0;
    if(x0 > y0) rankx++; else ranky++;
    if(x0 > z0) rankx++; else rankz++;
    if(x0 > w0) rankx++; else rankw++;
    if(y0 > z0) ranky++; else rankz++;
    if(y0 > w0) ranky++; else rankw++;
    if(z0 > w0) rankz++; else rankw++;
    // simplex[c] is a 4-vector with the numbers 0, 1, 2 and 3 in some order.
    // Many values of c will never occur, since e.g. x>y>z>w makes x<z, y<w and x<w
    // impossible. Only the 24 indices which have non-zero entries make any sense.
    // We use a thresholding to set the coordinates in turn from the largest magnitude.
    // Rank 3 denotes the largest coordinate.
    i1 = rankx >= 3 ? 1 : 0;
    j1 = ranky >= 3 ? 1 : 0;
    k1 = rankz >= 3 ? 1 : 0;
    l1 = rankw >= 3 ? 1 : 0;
    // Rank 2 denotes the second largest coordinate.
    i2 = rankx >= 2 ? 1 : 0;
    j2 = ranky >= 2 ? 1 : 0;
    k2 = rankz >= 2 ? 1 : 0;
    l2 = rankw >= 2 ? 1 : 0;
    // Rank 1 denotes the second smallest coordinate.
    i3 = rankx >= 1 ? 1 : 0;
    j3 = ranky >= 1 ? 1 : 0;
    k3 = rankz >= 1 ? 1 : 0;
    l3 = rankw >= 1 ? 1 : 0;
    // The fifth corner has all coordinate offsets = 1, so no need to compute that.
    /*double x1 = x0 - i1 + G4; // Offsets for second corner in (x,y,z,w) coords
    double y1 = y0 - j1 + G4;
    double z1 = z0 - k1 + G4;
    double w1 = w0 - l1 + G4;
    double x2 = x0 - i2 + 2.0*G4; // Offsets for third corner in (x,y,z,w) coords
    double y2 = y0 - j2 + 2.0*G4;
    double z2 = z0 - k2 + 2.0*G4;
    double w2 = w0 - l2 + 2.0*G4;
    double x3 = x0 - i3 + 3.0*G4; // Offsets for fourth corner in (x,y,z,w) coords
    double y3 = y0 - j3 + 3.0*G4;
    double z3 = z0 - k3 + 3.0*G4;
    double w3 = w0 - l3 + 3.0*G4;
    double x4 = x0 - 1.0 + 4.0*G4; // Offsets for last corner in (x,y,z,w) coords
    double y4 = y0 - 1.0 + 4.0*G4;
    double z4 = z0 - 1.0 + 4.0*G4;
    double w4 = w0 - 1.0 + 4.0*G4;
    // Work out the hashed gradient indices of the five simplex corners
    int ii = i & 255;
    int jj = j & 255;
    int kk = k & 255;
    int ll = l & 255;
    int gi0 = perm[ii+perm[jj+perm[kk+perm[ll]]]] % 32;
    int gi1 = perm[ii+i1+perm[jj+j1+perm[kk+k1+perm[ll+l1]]]] % 32;
    int gi2 = perm[ii+i2+perm[jj+j2+perm[kk+k2+perm[ll+l2]]]] % 32;
    int gi3 = perm[ii+i3+perm[jj+j3+perm[kk+k3+perm[ll+l3]]]] % 32;
    int gi4 = perm[ii+1+perm[jj+1+perm[kk+1+perm[ll+1]]]] % 32;*/
    x1 = x0 - i1 + G4; // Offsets for second corner in (x,y,z,w) coords
    y1 = y0 - j1 + G4;
    z1 = z0 - k1 + G4;
    w1 = w0 - l1 + G4;
    x2 = x0 - i2 + 2.0*G4; // Offsets for third corner in (x,y,z,w) coords
    y2 = y0 - j2 + 2.0*G4;
    z2 = z0 - k2 + 2.0*G4;
    w2 = w0 - l2 + 2.0*G4;
    x3 = x0 - i3 + 3.0*G4; // Offsets for fourth corner in (x,y,z,w) coords
    y3 = y0 - j3 + 3.0*G4;
    z3 = z0 - k3 + 3.0*G4;
    w3 = w0 - l3 + 3.0*G4;
    x4 = x0 - 1.0 + 4.0*G4; // Offsets for last corner in (x,y,z,w) coords
    y4 = y0 - 1.0 + 4.0*G4;
    z4 = z0 - 1.0 + 4.0*G4;
    w4 = w0 - 1.0 + 4.0*G4;
    // Work out the hashed gradient indices of the five simplex corners
    ii = i & 255;
    jj = j & 255;
    kk = k & 255;
    ll = l & 255;
    gi0 = perm[ii+perm[jj+perm[kk+perm[ll]]]] % 32;
    gi1 = perm[ii+i1+perm[jj+j1+perm[kk+k1+perm[ll+l1]]]] % 32;
    gi2 = perm[ii+i2+perm[jj+j2+perm[kk+k2+perm[ll+l2]]]] % 32;
    gi3 = perm[ii+i3+perm[jj+j3+perm[kk+k3+perm[ll+l3]]]] % 32;
    gi4 = perm[ii+1+perm[jj+1+perm[kk+1+perm[ll+1]]]] % 32;

    // Calculate the contribution from the five corners
    /*double t0 = 0.6 - x0*x0 - y0*y0 - z0*z0 - w0*w0;
    if(t0<0) n0 = 0.0;
    else {
      t0 *= t0;
      n0 = t0 * t0 * dot(grad4[gi0], x0, y0, z0, w0);
    }
   double t1 = 0.6 - x1*x1 - y1*y1 - z1*z1 - w1*w1;
    if(t1<0) n1 = 0.0;
    else {
      t1 *= t1;
      n1 = t1 * t1 * dot(grad4[gi1], x1, y1, z1, w1);
    }
   double t2 = 0.6 - x2*x2 - y2*y2 - z2*z2 - w2*w2;
    if(t2<0) n2 = 0.0;
    else {
      t2 *= t2;
      n2 = t2 * t2 * dot(grad4[gi2], x2, y2, z2, w2);
    }
   double t3 = 0.6 - x3*x3 - y3*y3 - z3*z3 - w3*w3;
    if(t3<0) n3 = 0.0;
    else {
      t3 *= t3;
      n3 = t3 * t3 * dot(grad4[gi3], x3, y3, z3, w3);
    }
   double t4 = 0.6 - x4*x4 - y4*y4 - z4*z4 - w4*w4;
    if(t4<0) n4 = 0.0;
    else {
      t4 *= t4;
      n4 = t4 * t4 * dot(grad4[gi4], x4, y4, z4, w4);
    }*/    
    t0 = 0.6 - x0*x0 - y0*y0 - z0*z0 - w0*w0;
    if(t0<0) n0 = 0.0;
    else {
      t0 *= t0;
      n0 = t0 * t0 * dot(grad4[gi0], x0, y0, z0, w0);
    }
   t1 = 0.6 - x1*x1 - y1*y1 - z1*z1 - w1*w1;
    if(t1<0) n1 = 0.0;
    else {
      t1 *= t1;
      n1 = t1 * t1 * dot(grad4[gi1], x1, y1, z1, w1);
    }
   t2 = 0.6 - x2*x2 - y2*y2 - z2*z2 - w2*w2;
    if(t2<0) n2 = 0.0;
    else {
      t2 *= t2;
      n2 = t2 * t2 * dot(grad4[gi2], x2, y2, z2, w2);
    }
   t3 = 0.6 - x3*x3 - y3*y3 - z3*z3 - w3*w3;
    if(t3<0) n3 = 0.0;
    else {
      t3 *= t3;
      n3 = t3 * t3 * dot(grad4[gi3], x3, y3, z3, w3);
    }
   t4 = 0.6 - x4*x4 - y4*y4 - z4*z4 - w4*w4;
    if(t4<0) n4 = 0.0;
    else {
      t4 *= t4;
      n4 = t4 * t4 * dot(grad4[gi4], x4, y4, z4, w4);
    }
    // Sum up and scale the result to cover the range [-1,1]
    return 27.0 * (n0 + n1 + n2 + n3 + n4);
  }

  // Inner class to speed up gradient computations
  // (array access is a lot slower than member access)
  private static class Grad
  {
    double x, y, z, w;

    Grad(double x, double y, double z)
    {
      this.x = x;
      this.y = y;
      this.z = z;
    }

    Grad(double x, double y, double z, double w)
    {
      this.x = x;
      this.y = y;
      this.z = z;
      this.w = w;
    }
  }
} 
```

`

# ruby-on-rails-3 - application_controller 中的 session_id。导轨 3

> ID：14007880
> 
> 赞同：0
> 
> 时间：2012-12-23T01:03:17.143
> 
> 标签：ruby-on-rails-3, actioncontroller

我怎样才能获得 application_controller 中的 session_id。我在这个控制器中创建辅助方法来设置会话并稍后读取它们，并且我能够从 application_controller 读取所有会话变量、cookie 等。唯一的例外是

session[:session_id]（尝试的变体 - session[:id]、session["id"]、session["session_id"] 和 request.session_options[:id]）

但是这些都没有提供 session_id 值。

在我看来 session[:session_id] 工作正常。但是在应用程序控制器中，这是行不通的。

任何帮助，将不胜感激。我显然在这里做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T08:02:08.080

你忘了`before_filter`吗？它对我有用。

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  before_filter :catch_session_id

  def catch_session_id
    binding.pry
  end
end

    14: def catch_session_id
 => 15:   binding.pry
    16: end

[1] pry(#<WelcomeController>)> session[:session_id]
=> "a7eca9eaaf21cff74c0d21713fcaad09" 
```

# actionscript-3 - 类中的 Actionscript 3 实例名称不起作用

> ID：14007883
> 
> 赞同：0
> 
> 时间：2012-12-23T01:04:56.690
> 
> 标签：actionscript-3, flash

我已将 MovieClip 的实例名称设置为 char，当我尝试编译此代码时出现 2 个错误：

```
package com.game
{

import flash.display.MovieClip;
import flash.events.*;

public class game extends MovieClip
{
    var gravity = 0.8;
    var velocity = 0;
    char.addEventListener(Event.ENTER_FRAME,isHitted);

    function isHitted(event:Event):void
    {
        if (char.hitTestObject(level1))
        {
            velocity++;
            char.y -= gravity+velocity;
        }
        else
        {

        }
    } 
```

错误：

```
.../game.as, Line 13    1120: Access of undefined property char.
../game.as, Line 13 1120: Access of undefined property isHitted. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T01:33:41.040

首先，听起来这个类定义是你所指的实例的定义，如果是，你应该使用'this'而不是'char'

此外，您通常不会指定方法调用，例如：

```
char.addEventListener(Event.ENTER_FRAME,isHitted); 
```

声明类时在方法之外。相反，该行代码应该存在于构造函数或在 MovieClip 实例化期间调用的方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T09:05:07.673

您需要先让“游戏”可以访问“字符”，然后才能使用它。

一种方法是在实例化“游戏”时将“字符”作为参数传递。

[在 AS3 中使用组合时，Access caller object](https://stackoverflow.com/questions/14005786/access-caller-object-when-using-composition-in-as3)中@lee-burrows 的回答中描述了两种方法

# java - Java中可靠的声音API，用于简单的数字样本播放

> ID：14007885
> 
> 赞同：7
> 
> 时间：2012-12-23T01:05:17.860
> 
> 标签：java, lwjgl, javasound, openal, alsa

有没有一个好的方法可以在 Java 中获得体面、可靠的数字采样声音播放？

我的请求清单很短：

*   从 .wav 文件之类的文件加载内存中的数字化样本（例如，从 jar 中捆绑的资源）
*   以非阻塞方式播放它们
*   当我同时播放几个样本并且它们及时相交时，它们应该得到适当的混合

拥有以下内容会很好，但事实上我可以没有它：

*   从 .ogg 或类似的压缩格式播放（显然没有在 Java 中实现占用大量 CPU 的解码器）
*   在仍在播放时再次播放相同的样本不应停止给定样本的先前播放，但应开始第二个副本并与第一个正确混合

我尝试过臭名昭著的[Java Sound API](http://docs.oracle.com/javase/7/docs/api/javax/sound/sampled/package-summary.html)，但发现它完全不可靠，而且似乎无法满足我最小的愿望清单。我遇到的问题：

*   在带有 ALSA dmix (OpenJDK 6) 的 Linux 上，让任何其他应用程序在初始化 Java Sound API 时使用音频只会使来自 Java 应用程序的所有声音消失，而不会出现任何错误/警告。

*   在 Linux (OpenJDK 6) 上，列出`MixerInfo`s 并尝试`Clip`使用它们中的任何一个获取对象都会在尝试加载 wav 文件时引发以下异常：

    ```
    java.lang.IllegalArgumentException: Line unsupported: interface Clip supporting format PCM_SIGNED unknown sample rate, 16 bit, stereo, 4 bytes/frame, big-endian 
    ```

    因此，`AudioSystem.getClip(anySortOfMixer)`似乎根本不起作用。只`AudioSystem.getClip()`工作。

*   使用不同的采样率/位/格式加载文件`Clip`失败`LineUnavailableException`。似乎第一次调用`clip.open`将声音系统设置为特定的声音选项，然后调用以加载采样率略有不同的文件（例如，第一个是 44100，第二个是 48000）

*   在 Linux (OpenJDK 6) 上，初始化几个不同`Clip`的 s 并尝试播放它们只会使最后一次加载的声音可以`Clip`听到 - 没有给出错误/警告，但只有`play`在最后一次`Clip`加载时使用才会发出任何声音 - 所有其他人都是沉默的：

    ```
    Clip loadSound(String name) {
        URL url = this.getClass().getResource("/" + name + ".wav");
        Clip clip = AudioSystem.getClip();
        AudioInputStream ais = AudioSystem.getAudioInputStream(url);
        clip.open(ais);
        return clip;
    }

    void playSound(Clip) {
        if (clip.isRunning())
            clip.stop();
        clip.setFramePosition(0);
        clip.start();
    }
    ...
    Clip c1 = loadSound("foo");
    Clip c2 = loadSound("bar");
    ...
    playSound(c1); // silence
    ...
    playSound(c2); // audible 
    ```

    在 Windows 上使用这段代码一切都很好 - 所有剪辑都可以正常听到、播放和混合。没有在 Mac 上测试过。

*   支持的文件格式（用 分析`AudioSystem.getAudioFileTypes`）在 Linux/OpenJDK6 和 Windows/Oracle JDK 7 上返回 wav / au / aif，所以没有 oggs 甚至 mp3s :(

*   似乎没有简单的方法可以同时制作相同`Clip`声音的两个副本而不将第二个副本加载为 distinct `Clip`。

所以，问题是 - 是否有一个好的解决方案/解决方法来补救所有这些东西并使其更可靠？切换到其他音响系统（如[LWJGL OpenAL](http://lwjgl.org/documentation_openal_01.php)或[paulscode.com 音响系统](http://www.paulscode.com/forum/index.php?topic=4.0)）会有帮助吗？或者是否可以将 Java Sound API 包装在一些安全措施中并且它会正常工作？

我做了一个小应用程序来测试以上所有内容，但它有点长，所以我想我会把它作为一个[要点](http://gist.github.com/)发布，但不幸的是，GitHub 现在有一些网络问题。所以，我想，我稍后会发布它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T08:23:23.007

我在 Java-gaming.org 上发布了一个相当简单、有限的混音器，欢迎您在以下网址查看： [http ://www.java-gaming.org/topics/simple-audio-mixer-2nd -pass/27943/view.html](http://www.java-gaming.org/topics/simple-audio-mixer-2nd-pass/27943/view.html)

第一篇文章中列出的 jar 包含源代码和示例用法，我投入了一些精力来制作 javadoc 注释。（98% 的下载是我包含的单个样本 wav。）此外，线程上有很多 api 信息。

它仍然存在Linux问题。但我对你的分析印象深刻，我想知道分享尝试排除故障和解决这个问题的努力！

关于你的观点：

*   我记得听说在某些 Linux 系统中，单个输出是可能的，并且某些应用程序无法公平播放，并在发生争用时将音频释放到 Java。如果这是准确的，那么很难将其称为 Java 问题，而可能是 Linux 操作系统问题？

*   第二点：我还没有尝试在 Linux 中从 Mixer 加载，但我知道有些人已经能够通过我的 Web 应用 Java Theremin 做到这一点。在那个应用程序中（链接在上面的线程中），我包含一个允许用户选择混音器的下拉菜单。至少有一些 Linux 用户在这方面取得了成功。

*   我没有使用过 Big-Endian wavs - 但只有 little endian wavs。您必须翻转 Audacity 中的字节或类似的东西才能使用我目前的混音器。

*   我的系统确实处理并发。您将 wav 加载到 PFClipData 对象中。然后，您可以通过 PFClipShooter（可以处理并发播放——20 或 30，以及不同的音高）或 PFClipLooper（将使用结尾的可选重叠模式循环剪辑以帮助平滑循环点）。所有输出都在幕后汇集到单个 SourceDataLine 中。

*   我还没有实现 ogg 或 mp3，只有 16 位、44100fps 立体声 little-endian wav 文件。

*   如果有其他人愿意分享，我很乐意考虑将其作为一个开源 git 项目。

--我最近在我的 PC 上的双引导分区中成功安装了 Linux（Ubuntu 桌面），并且即将安装声卡，看看我是否重新创建并希望修复一些正在描述的问题。Ubuntu 同时具有 OpenJDK 和 Oracle 的 JDK，所以我希望看看 Java 实现是否可能是问题的一部分。工作正在进行中...

# jquery-ui - JQuery 对话框仅针对表中的第一条记录打开

> ID：14007887
> 
> 赞同：0
> 
> 时间：2012-12-23T01:05:50.573
> 
> 标签：jquery-ui, modal-dialog

我已经看到很多关于这个主题的问题，但没有一个答案/建议似乎对我有用。我对 JQuery 相当陌生，因此非常感谢您的帮助！

我有一张带链接的表格。出于某种原因，我只能打开第一条记录的对话框（我可以多次这样做）。它不适用于任何其他记录。

这是我的代码：

```
 $(document).ready(function() { 

         var dlg=$('#ticketDetails').dialog({
            title: 'Ticket Details',
            resizable: true,
            autoOpen:false,
            modal: true,
            hide: 'fade',
            width:850,
            height:700
         });

        $('#view').click(function(e) {

             //testing with static record
             dlg.load('displayRecord.php?id=215', function(){
                 dlg.dialog('open');
             });

          });

    }); 
```

表中的所有行都有下表链接：

```
echo '<td><a href="#" id="view">View</a> </td>'; 
```

显示对话框的 div：

```
<div id="ticketDetails"> </div> 
```

我还尝试使用不会触发其他记录`alert('1');`的 功能。`$('#view').click`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T02:02:42.350

在您的表格中，每一行都有相同的 id，“view”。id 对于页面上的单个元素应该是唯一的，因此您应该将其更改为一个类：

`<td><a href="#" class="view">View</a></td>`

并相应地更改您的脚本：

`$('.view').click(function(e) { ... });`

在事件处理程序中，您可以使用 event 变量`e`来获取被点击的元素，使用它的 target 属性：

```
$('.view').click(function(e) {
  alert( $(e.target).text() );
}); 
```

# jquery - .show() 后谷歌地图未正确显示

> ID：14007888
> 
> 赞同：3
> 
> 时间：2012-12-23T01:05:54.417
> 
> 标签：jquery, google-maps

大家好，我正在建立一个网站，它有一个复选框，如果选中该框，它将显示谷歌地图，如果没有，它将隐藏它。当我没有加载它`.hide()`并且`.show()`它可以正常工作但是当我使用`hide()`和`show()`方法时它会加载地图的一部分。

编码

```
<!DOCTYPE html>
<html>
<head>
<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=MYKEY&sensor=false"></script>
<script>
 var MAPID = "map";

 function initialize(){
 var loc     = new google.maps.LatLng(23.70656905403075,-53.58581517968753);
 var options = {
 zoom      : 8,
 center    : loc,
 mapTypeId : google.maps.MapTypeId.ROADMAP
};

var map     = new google.maps.Map(document.getElementById(MAPID),options);
var marker  = new google.maps.Marker({
 position  : loc,
 map       : map,
 draggable : true,
 animation : google.maps.Animation.DROP,
title     : "Hello world"
});
google.maps.event.addListener(marker,"dragend",function(e){
updateloc(this.position);
});

marker.setMap(map);
}

function updateloc(loc){
$("#lat").val(loc.lat());
$("#long").val(loc.lng());
}
$(document).ready(function(){
            $("#map_canvas").hide();
            $("#lat").hide();
            $("#long").hide();
            $("#theMap").change(function(){
                    if(this.checked)
                    $("#map_canvas").show();
                    else
                    $("#map_canvas").hide();
                    }); 
            }); 

</script>
</head>
<body onload="initialize();" >
<form>
<input type="checkbox" id="theMap">
<div id="map" style="width:400px;height:400px"></div>
<input id="lat" />
<input id="long" />
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T01:42:16.043

我发现有人有类似的问题[http://www.csie.nctu.edu.tw/~wctang/mapv3test.html](http://www.csie.nctu.edu.tw/~wctang/mapv3test.html) 我做到了`google.maps.event.trigger(map,'resize');`，它解决了问题。

# android - 短月份名称

> ID：14007890
> 
> 赞同：1
> 
> 时间：2012-12-23T01:06:45.803
> 
> 标签：android

我试图通过将月份 int 传递给函数来获得一个简短的月份名称。但它总是返回'Jan'

这是功能：

```
public static String getMonthName_Abbr(int month) {
    Calendar cal = Calendar.getInstance();
    cal.set(Calendar.MONTH, month);
    SimpleDateFormat month_date = new SimpleDateFormat("MMM");
    String month_name = month_date.format(month);
    return month_name; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T01:23:43.467

你只需要传递`cal.getTime()`给你的`format`调用，而不是`month`它本身。

[请参阅http://ideone.com/kKrGY9](http://ideone.com/kKrGY9)上的工作演示

我不确定为什么您的代码按给定的方式工作，看看`format`期望 a`Date`而不是`int`; 然而，如果它以某种方式发生了，也许`month`, 作为一个小整数的值被解释为一个时代（1970 年 1 月 1 日）周围的时间。只是一个想法，但无论如何，您的功能将与这个小改动一起工作。

# c# - SQLite 记录是如何更新的？

> ID：14007891
> 
> 赞同：3
> 
> 时间：2012-12-23T01:07:05.270
> 
> 标签：c#, sqlite, windows-8, windows-store-apps, sqlite-net

接受此代码的语法：

```
public async Task UpdateLocationAsync(SOs_Locations locations)
{
    var db = new SQLiteAsyncConnection(SQLitePath);
    await db.UpdateAsync(locations);
} 
```

...但我不明白 SQLite 引擎在简单地传递类实例时如何知道要更新哪个记录。SQLite 或 SQLite-net 引擎是否会偷看 ID 值并在幕后执行（在 SQLese 中）：

```
UPDATE SOs_Locations
Set Bla = Bla, etc.
WHERE ID = locations.Id 
```

?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T07:48:46.550

这正是它的作用。您可以在[此处](https://github.com/praeclarum/sqlite-net/blob/master/src/SQLite.cs)查看方法的来源：

```
var q = string.Format ("update \"{0}\" set {1} where {2} = ? ", map.TableName, string.Join (",", (from c in cols
        select "\"" + c.Name + "\" = ? ").ToArray ()), pk.Name); 
```

当然，如果您需要更多控制权，您可以随时执行自己的 SQL：

```
db.ExecuteAsync("UPDATE SOs_Locations Set Bla = ?, WHERE ID = ?", bla, id); 
```

# html - 单击时更改字体样式

> ID：14007896
> 
> 赞同：0
> 
> 时间：2012-12-23T01:08:35.163
> 
> 标签：html, css

我刚买了一个 WordPress 主题并稍作调整，在主导航上，投资组合就像第一次点击时变为粗体，然后变为正常重量，当我点击其他 3 个链接中的任何一个时，文本变为正常然后粗体。

[http://adamhuxtable.com](http://adamhuxtable.com)

我希望样式始终具有正常的字体重量。

我浏览了css，但找不到任何可以让它表现得像这样的地方。

在 Mac 上使用 Chrome。

谢谢亚当

# php - 防止 CSRF 和防止垃圾邮件发送者

> ID：14007901
> 
> 赞同：0
> 
> 时间：2012-12-23T01:09:31.700
> 
> 标签：php, security, csrf, spam

编辑：看起来我对 CSRF 实际上是什么感到有些困惑。我已经改写了这个问题

--

所以我知道有很多关于防止 CSRF 的帖子，但是有很多方法可以绕过常用方法：

**CSRF Token** - 在表单上设置 CSRF 令牌，分配具有相同数据的 cookie 并在服务器端进行匹配

**检查用户代理**- 确保所有请求都具有有效用户代理的简单方法。很容易绕过，但仍然是一个简单的检查

**基于 IP**限制 - 根据请求者的 IP 地址限制请求。

--

但这一切都可以*轻松*绕过！还有什么办法可以防止这种事情发生？请不要输入验证码。

假设一个 URL 缩短器的示例站点。

1.  用户提交请求 -> 返回缩短的 URL。
2.  脚本检查有效的引用者（来自原始表单）——很容易被欺骗
3.  基于 IP 地址的检查——代理很容易绕过这个
4.  检查 CSRF 令牌——垃圾邮件发送者可以通过首先访问原始站点并在对站点的请求中使用设置的 cookie + 令牌来轻松绕过这个

我只是不确定还能做什么？即使是 JavaScript 明智的，可以做些什么来防止这种情况发生？为 cookie 分配超时可能会起作用，但垃圾邮件发送者只会通过访问原始页面重新分配 cookie。

如果请求率高于平均水平，可以做的其他事情是向垃圾邮件发送者显示验证码。但我也想要一些不会标记有效用户的东西。是的，强迫用户必须注册一个帐户可以解决这个问题，但不可行。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T01:39:30.823

时间。它通过了。需要存储 CSRF。某处。时光荏苒，这家店也过时了。如果您只留下一个特定的时间跨度并且您保留将时间变成其他秘密的秘密，那么垃圾邮件发送者无法“更新”到当前。

任务完成。你如何传递数据——确定在 HTTP 消息的某个地方，通常在多个地方，例如标题和正文——完全是你的选择。

请注意，您只允许某些可以执行操作的时间范围。

如果您需要更高的安全性，请要求用户身份验证（通过使用凭据登录 - 或通过使用 UA 规范（包括 IP 和请求标头）自动登录）。然后在该会话中，您可以在服务器端保留许多攻击者无法预测的秘密。

例如，保持表单名称和值完全动态。在提交之前使用 javascript 旋转输入值，只接受旋转的值。根据时间更改旋转。允许您的秘密的公共部分在单个当前时间共享以计算轮换。如上所述，取决于您的需求。

在这种情况下，HTTP 的无状态特性可能看起来像是一个弱点。但事实上，并非如此。用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T01:45:34.423

您可以为输入字段生成随机名称，然后让您的脚本识别它们。这类似于 Facebook 所做的，效果很好。

# python - 尝试使用请求库登录航空公司网站时出现 Python 10054 错误

> ID：14007904
> 
> 赞同：1
> 
> 时间：2012-12-23T01:09:56.450
> 
> 标签：python, web-scraping, urllib, python-requests

我正在学习 python，作为我的第一个项目，我想登录几个航空公司网站并获取我的飞行常客里程信息。我已经成功地能够登录并抓取美国航空公司和联合航空公司，但我无法在 Delta、USairways 和 Britishairways 上执行此操作。

我一直在使用的方法是监视来自 Fiddler2、Chrome 或 Firebug 的网络流量。Wireshark 目前似乎太复杂了。

为了让我的脚本与 American 和 United 一起抓取，我所做的只是观察 fiddler2 上的流量，复制 FORM DATA 和 REQUEST HEADER DATA，然后使用 python 3rd 方请求库来访问数据。很简单。很容易。其他航空公司的网站给我带来了很多麻烦。

让我们具体谈谈英国航空公司。下面是我登录虚拟 BA 帐户时从 fiddler 那里获取的 FORM DATA 和 REQUEST HEADER DATA 的图片。我还包括了我一直在使用的测试脚本。我写了两个不同的版本。一种使用 Requests 库，另一种使用 urllib。它们都产生相同的错误，但我认为如果他们没有导入 Requests 库，我会同时提供两者以使某人更容易帮助我。使用你想要的那个。

基本上，当我提出 request.post 时，我得到一个

10054, '现有连接被远程主机强行关闭' 错误。

我不知道发生了什么。找了3天，一无所获。我希望有人能帮助我。下面的代码使用我的虚拟 BA 帐户信息。用户名：python_noob 密码：p4ssword。随意使用和测试它。

这是fiddler2数据的一些图片

[http://i.imgur.com/iOL91.jpg?1](http://i.imgur.com/iOL91.jpg?1)

[http://i.imgur.com/meLHL.jpg?1](http://i.imgur.com/meLHL.jpg?1)

```
import requests

import urllib

def get_BA_login_using_requests ():
    url_loginSubmit1 = 'https://www.britishairways.com/travel/loginr/public/en_us'

    url_viewaccount1 = 'https://www.britishairways.com/travel/viewaccount/public/en_us?eId=106011'
    url_viewaccount2 = 'https://www.britishairways.com/travel/viewaccount/execclub/_gf/en_us?eId=106011'

    form_data = {
        'Directional_Login':'',
        'eId':'109001',
        'password':'p4ssword',
        'membershipNumber':'python_noob',
        }

    request_headers= {
        'Cache-Control':'max-age=0',
        'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
        'Accept-Charset':'ISO-8859-1,utf-8;q=0.7,*;q=0.3',
        'Accept-Encoding':'gzip,deflate,sdch',
        'Accept-Language':'en-US,en;q=0.8',
        'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11',

        'Cookie': 'BIGipServerba.com-port80=997762723.20480.0000; v1st=EDAB42A278BE913B; BASessionA=kDtBQWGclJymXtlsTXyYtykDLLsy3KQKvd3wMrbygd7JZZPJfJz2!-1893405604!clx42al01-wl01.baplc.com!7001!-1!-407095676!clx43al01-wl01.baplc.com!7001!-1; BIGipServerba.com-port81=997762723.20736.0000; BA_COUNTRY_CHOICE_COOKIE=us; Allow_BA_Cookies=accepted; BA_COUNTRY_CHOICE_COOKIE=US; opvsreferrer=functional/home/home_us.jsp; realreferrer=; __utma=28787695.2144676753.1356203603.1356203603.1356203603.1; __utmb=28787695.1.10.1356203603; __utmc=28787695; __utmz=28787695.1356203603.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); fsr.s={"v":-2,"rid":"d464cf7-82608645-1f31-3926-49807","ru":"http://www.britishairways.com/travel/globalgateway.jsp/global/public/en_","r":"www.britishairways.com","st":"","to":3,"c":"http://www.britishairways.com/travel/home/public/en_us","pv":1,"lc":{"d0":{"v":1,"s":false}},"cd":0}',

        'Content-Length':'78',
        'Content-Type':'application/x-www-form-urlencoded',

        'Origin':'https://www.britishairways.com',
        'Referer':'https://www.britishairways.com/travel/loginr/public/en_us',

        'Connection':'keep-alive',
        'Host':'www.britishairways.com',
        }

    print ('Trying to login to British Airways using Requests Library (takes about 1 minute for error to occur)')

    try:
        r1 = requests.post(url_loginSubmit1, data = form_data, headers = request_headers)
    print ('it worked')
    except Exception as e:
        msg = "An exception of type {0} occured, these were the arguments:\n{1!r}"
        print (msg.format(type(e).__name__, e.args))

    return

def get_BA_login_using_urllib():
    """Tries to request the URL. Returns True if the request was successful; false otherwise.
    https://www.britishairways.com/travel/loginr/public/en_us

    response -- After the function has finished, will possibly contain the response to the request.

    """
    response = None
    print ('Trying to login to British Airways using urllib Library (takes about 1 minute for error to occur)')
    # Create request to URL.
    req = urllib.request.Request("https://www.britishairways.com/travel/loginr/public/en_us")

    # Set request headers.
    req.add_header("Connection", "keep-alive")
    req.add_header("Cache-Control", "max-age=0")
    req.add_header("Origin", "https://www.britishairways.com")
    req.add_header("User-Agent", "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11")
    req.add_header("Content-Type", "application/x-www-form-urlencoded")
    req.add_header("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8")
    req.add_header("Referer", "https://www.britishairways.com/travel/home/public/en_us")
    req.add_header("Accept-Encoding", "gzip,deflate,sdch")
    req.add_header("Accept-Language", "en-US,en;q=0.8")
    req.add_header("Accept-Charset", "ISO-8859-1,utf-8;q=0.7,*;q=0.3")
    req.add_header("Cookie", 'BIGipServerba.com-port80=997762723.20480.0000; v1st=EDAB42A278BE913B; BIGipServerba.com-port81=997762723.20736.0000; BA_COUNTRY_CHOICE_COOKIE=us; Allow_BA_Cookies=accepted; BA_COUNTRY_CHOICE_COOKIE=US; BAAUTHKEY=BA4760A2434L; BA_ENROLMENT_APPLICATION_COOKIE=1356219482491AT; BASessionA=wKG4QWGSTggNGnsLTnrgQnMxGMyzvspGLCYpjdSZgv2pSgYN1YRn!-1893405604!clx42al01-wl01.baplc.com!7001!-1!-407095676!clx43al01-wl01.baplc.com!7001!-1; HOME_AD_DISPLAY=1; previousCountryInfo=us; opvsreferrer=functional/home/home_us.jsp; realreferrer=; __utma=28787695.2144676753.1356203603.1356216924.1356219076.6; __utmb=28787695.15.10.1356219076; __utmc=28787695; __utmz=28787695.1356203603.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); fsr.s={"v":-2,"rid":"d464cf7-82608645-1f31-3926-49807","ru":"http://www.britishairways.com/travel/globalgateway.jsp/global/public/en_","r":"www.britishairways.com","st":"","to":5,"c":"https://www.britishairways.com/travel/home/public/en_us","pv":31,"lc":{"d0":{"v":31,"s":true}},"cd":0,"f":1356219889982,"sd":0}')

    # Set request body.
    body = b"Directional_Login=&eId=109001&password=p4ssword&membershipNumber=python_noob"

    # Get response to request.

    try:
        response = urllib.request.urlopen(req, body)
        print ('it worked')
    except Exception as e:
        msg = "An exception of type {0} occured, these were the arguments:\n{1!r}"
        print (msg.format(type(e).__name__, e.args))

    return

def main():
    get_BA_login_using_urllib()
    print()
    get_BA_login_using_requests()
    return

main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T12:21:33.713

顺便说一句，我会说您设法创建了一个格式错误或非法的请求，而另一端的服务器（甚至代理）只是拒绝处理它。

1.  *一定要*使用`requests`图书馆。太棒了。Urllib 已经*过时*了（而且，使用起来一点也不好玩。）

2.  摆脱几乎所有的自定义标题。特别是`Content-Length`,`Keep-Alive`和。前三个您应该让 requests 库处理，因为它们是 HTTP 1.1 协议的一部分。关于: 这也将由库处理，具体取决于您使用会话的方式。（您可能想查阅那里的文档。）如果没有任何以前的 cookie，当您尝试访问该站点时，您可能会得到类似 401 的信息，或者您将（透明地）重定向到登录页面。进行登录将设置正确的 cookie，之后您应该能够重试原始请求。`Connection``Cookie``Cookie``requests`

3.  如果您对发布数据使用字典，则也不需要`Content-Type`标题。您可能想尝试在所述 dict 中使用 unicode-values。我发现这有时会有所作为。

换句话说：尽可能多地删除，然后从那里建立起来。做这样的事情通常不应该花费超过几行代码。现在，抓取网页，这是另一回事：尝试“beautifulsoup”。

**PS：永远**不要在公共论坛上发布 cookie 数据：它们可能包含不正当角色可能滥用的个人或其他敏感数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:17:40.863

似乎 Python 3.3 的 Windows 版本中存在一个错误，这是导致我的问题的原因。我使用了here的答案

[HTTPS 请求导致在 Windows 中使用 Python 3 重置连接](https://stackoverflow.com/questions/13167907/https-request-results-in-reset-connection-in-windows-with-python-3)

在我的脚本的 urllib 版本上取得进展。我想使用请求，所以我需要弄清楚如何使用该模块进行 SSL 降级工作。我将把它作为一个单独的线程。如果有人对此有答案，您也可以在此处发布。谢谢。

# email - 如何使用mailgun拒绝电子邮件？

> ID：14007908
> 
> 赞同：1
> 
> 时间：2012-12-23T01:10:59.577
> 
> 标签：email, cloudmailin, mailgun

有谁知道如何拒绝通过mailgun（mailgun.com）收到的电子邮件？作为比较，类似的服务 cloudmailin 允许您返回 404 或 403 状态码来拒绝电子邮件，并且该电子邮件的发件人将收到递送失败通知。我正在尝试使用 mailgun，但是，一旦收到 404 或 403 状态码，mailgun 将尝试以越来越长的间隔重新发送。

我尝试过的：Mailgun 文档对此没有任何说明。Mailgun 支持没有回复我的电子邮件。

如果我从 mailgun 得到答复，我会将其作为更新发布在这里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T04:41:27.933

您的应用可能会向 mailgun 返回 406 代码以停止重试。我们最近添加了该功能，但尚未更新我们的相关文档。

# image-processing - 图像处理以八度音阶大小的气泡

> ID：14007913
> 
> 赞同：3
> 
> 时间：2012-12-23T01:12:27.270
> 
> 标签：image-processing, opencv, octave

嗨，我想知道是否有人可以就下图中的水面（而不是下面的）气泡大小的潜在方法提供任何指示。如果可能的话，我想使用开源软件（鉴于图像是矩阵，我的想法倾向于八度音阶）。我完全没有图像处理方面的背景，所以欢迎任何想法。显然，作为起点，我知道原始图像中每个像素的大小（该图像是压缩版本），因此以像素为单位计算半径将是完美的。

[![气泡图像](../Images/912734bed8b039c146097ce9ddc37b89.png)](https://i.stack.imgur.com/KLFhv.jpg)

**根据@mmgp 的想法进行编辑**

因此，为了让问题更直接，我使用 Opencv 的开源库吸收了@mmgp 的想法。我以前从未使用过它（实际上也没有直接用 C 或 C++ 编程，但它看起来好像可以满足我的需求，虽然它看起来好像有一个陡峭的学习曲线，但我的经验告诉我那些经常提供最强大功能的解决方案需要花时间学习。所以这是我到目前为止所做的（没有图像处理背景我不确定我使用的功能是否理想，但我认为它可能会促进进一步的思考）。我已将图像转换为灰度，使用二进制阈值，然后对圆圈应用霍夫变换。我在每个阶段生成的图像以及我使用的代码如下。很明显，trackerbars 对于动态调整参数非常有用。然而，我还不够熟练地在我的代码中实现它们（任何指针都会很棒，特别是关于 Hough 变换，其中有一些参数需要调整）。

所以你怎么看？我还可以尝试哪些其他功能？显然，我的尝试远不及@mmgp，但这可能只是调整参数的问题。

这是照片：灰度（为了完整性）： [![灰度图像](../Images/55dc0e47ad63c46e1074b5c70e429505.png)](https://i.stack.imgur.com/7qFuh.jpg) 二进制阈值： [![灰度图像](../Images/f84929d4b5432ea7e1f87a124bf700ca.png)](https://i.stack.imgur.com/uPoak.jpg) 圆形图像： [![灰度图像](../Images/351640823bc98c05647fc5f9fd0e73fa.png)](https://i.stack.imgur.com/sxvAv.jpg)

这是代码：

```
 #include "opencv2/highgui/highgui.hpp"
 #include "opencv2/imgproc/imgproc.hpp"
 #include <iostream>
 #include <stdio.h>

 using namespace cv;

 /** @function main */
 int main(int argc, char** argv)
 {
 Mat src, src_gray, src_bw;

 /// Read the image
 src = imread( argv[1], 1 );

 if( !src.data )
 { return -1; }

 /// Convert it to gray
 cvtColor( src, src_gray, CV_BGR2GRAY );
 imwrite( "Gray_Image.jpg", src_gray );

 /// Threshold the image to make binary
 threshold(src_gray, src_bw, 140, 255, CV_THRESH_BINARY);
 imwrite( "Binary_Image.jpg", src_bw );

 vector<Vec3f> circles;

 /// Apply the Hough Transform to find the circles
 HoughCircles( src_bw, circles, CV_HOUGH_GRADIENT, 5, src_bw.rows/2, 5, 10, 0, 0 );

 /// Draw the circles detected
 for( size_t i = 0; i < circles.size(); i++ )
 {
 Point center(cvRound(circles[i][0]), cvRound(circles[i][1]));
 int radius = cvRound(circles[i][2]);
 // circle center
 circle( src, center, 3, Scalar(0,255,0), -1, 8, 0 );
 // circle outline
 circle( src, center, radius, Scalar(0,0,255), 3, 8, 0 );
 }

 /// Show your results
 namedWindow( "Hough Circle Transform Demo", 0 );
 namedWindow( "Gray", 0 );
 namedWindow( "Binary Threshold", 0 );
 imshow( "Hough Circle Transform Demo", src );
 imshow( "Gray", src_gray );
 imshow( "Binary Threshold", src_bw );
 imwrite( "Circles_Image.jpg", src );
 waitKey(0);
 return 0;
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T06:09:17.370

另一个可能考虑的路径是[模板匹配](http://docs.opencv.org/doc/tutorials/imgproc/histograms/template_matching/template_matching.html)

您只需要创建一个典型气泡的模板图像。

这对于识别由霍夫变换识别的误报可能很有用。

您将需要使用不同大小的模板图像来检测不同大小的气泡。

此外，如果您有气泡出现之前的水图片，您可以将其减去以找到图像中有气泡的区域。

# spring - Spring Profile 不适用于默认活动配置文件

> ID：14007914
> 
> 赞同：2
> 
> 时间：2012-12-23T01:12:46.853
> 
> 标签：spring, profile

我正在尝试在我的应用程序中激活弹簧配置文件。为此，

**我在 web.xml 中添加了一个参数来激活默认配置文件。**

```
<context-param>
<param-name>spring.profiles.active</param-name>
<param-value>dev</param-value>
<context-param> 
```

这是我操纵属性的 jdbc 文件。 **我的 jdbc.context.xml 文件是**

```
<?xml version="1.0" encoding="UTF-8"?>
    <beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xmlns:context="http://www.springframework.org/schema/context"
        xmlns:p="http://www.springframework.org/schema/p" 
        xmlns:mvc="http://www.springframework.org/schema/mvc"
        xsi:schemaLocation="http://www.springframework.org/schema/beans 
                http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                http://www.springframework.org/schema/context
                http://www.springframework.org/schema/context/spring-context-3.1.xsd
                http://www.springframework.org/schema/mvc 
                http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">    
    <context:property-placeholder location="/WEB-INF/classes/jdbc.properties" /> <!-- TODO: config for different profiles, http://www.javacodegeeks.com/2012/06/spring-31-profiles-and-tomcat.html -->
     <beans profile="dev">
        <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">
            <property name="driverClass" value="${jdbc.driverClassName}"/>
            <property name="jdbcUrl" value="${jdbc.url}"/>
            <property name="user" value="${jdbc.username}"/>
            <property name="password" value="${jdbc.password}"/>
            </bean>
        <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
            <property name="dataSource">
                <ref bean="dataSource" />
            </property>
            <property name="packagesToScan" value="com.i2sm.common" />
            <property name="hibernateProperties">
                <props>
                    <prop key="hibernate.dialect">${jdbc.hibernate.dialect}</prop>
                    <prop key="hibernate.show_sql">true</prop>
                </props>
            </property>
        </bean>
  </beans>
</beans> 
```

**但是当我重新启动我的 Tomcat 服务器时，它会抛出以下异常**

```
java.lang.IllegalStateException: ApplicationEventMulticaster not initialized - call 'refresh' before multicasting events via the context: Root WebApplicationContext: startup date [Sun Dec 23 00:57:22 GMT 2012]; root of context hierarchy
        at org.springframework.context.support.AbstractApplicationContext.getApplicationEventMulticaster(AbstractApplicationContext.java:337)
        at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:324)
        at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1030)
        at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:993)
        at org.springframework.web.context.ContextLoader.closeWebApplicationContext(ContextLoader.java:548)
        at org.springframework.web.context.ContextLoaderListener.contextDestroyed(ContextLoaderListener.java:142)
        at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4831)
        at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:5478)
        at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)
        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:160)
        at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
        at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:722)

    Any Suggestion? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T01:57:57.770

我认为您需要指定`spring.profiles.default`为`context-param`而不是`spring.profiles.active`。

```
<context-param>
    <param-name>spring.profiles.default</param-name>
    <param-value>dev</param-value>
</context-param> 
```

看看这个[问题](https://stackoverflow.com/questions/10041410/default-profile-in-spring-3-1)并[参考这个](http://java.dzone.com/articles/using-spring-profiles-and-java)。

# c++ - 如何从 boost::spirit::multi_pass 获取基本迭代器？

> ID：14007916
> 
> 赞同：3
> 
> 时间：2012-12-23T01:12:55.323
> 
> 标签：c++, boost, boost-spirit, multipass

如何访问迭代`multi_pass`器正在使用的底层迭代器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T07:17:49.677

底层迭代器似乎存储在`input_`受保护的迭代器成员的成员中`member`。您可以通过方法访问它`shared`。

```
my_iterator.shared()->input_; 
```

# java - 找不到适合 AttributedString(java.util.List 的构造函数 )

> ID：14007920
> 
> 赞同：1
> 
> 时间：2012-12-23T01:15:31.117
> 
> 标签：java, printing, awt

到目前为止，这个论坛上的各位给了我很大的帮助，我学到了很多东西，但是我确实有一个（希望是）最后一个问题，我的代码无法编译，我收到以下错误：

```
 no suitable constructor found for AttributedString(java.util.List<java.lang.String>) 
constructor java.text.ArributedString(java.text.AttributedCharacterator,int,int,java.text.AttributedCharacterator.Attribute[]) is not applicable (actual and formal argument lists differ in length 
```

当我收到上述错误时，突出显示以下代码行：

```
AttributedString mStyledText = new AttributedString(list); 
```

在另一个线程的帮助下有人建议这是因为我传递的是整个字符串列表而不是单个字符串。

是什么导致了这个错误？更重要的是我如何克服它

代码如下

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.print.*;
import java.text.*;
import java.io.*;
import javax.swing.*;
import java.util.List;
import java.util.ArrayList;

public class PrintText implements Printable {

    private String text; // Constructor argument for AttributedString.

    // Below the code will allow the user to select a file and then print out the contents of the file
    public static void main(String[] args) throws IOException {
        new PrintText();
    }

    public PrintText() {
        EventQueue.invokeLater(new Runnable() {
                @Override
                public void run() {
                    try {
                        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                    } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                    }

                    //selects the file
                    JFileChooser chooser = new JFileChooser();
                    chooser.showOpenDialog(null);
                    File file = chooser.getSelectedFile();
                    String filename = file.getName();
                    //System.out.println("You have selected: " + filename);  testing to see if file seleected was right
                    String path = file.getAbsolutePath();

                    //Reads contents of file into terminal 
                    //FileReader fr = new FileReader("filename");
                    // FileReader fr = new FileReader("D:/Documents/" + "filename")); 

                    BufferedReader br = null;
                    try {
                        br = new BufferedReader(new FileReader(path));
                        StringBuilder stringBuilder = new StringBuilder();
                        String line;
                        while ((line = br.readLine()) != null) {
                            System.out.println(line);
                            stringBuilder.append(line).append("\n");
                        }
                        text = stringBuilder.toString();;

                        printer();
                    } catch (IOException exp) {
                        exp.printStackTrace();
                    } finally {
                        try {
                            br.close();
                        } catch (Exception e) {
                        }
                    }
                    //fr.close(); 
                }
            });
    }
    //private static final String mText = 
    //    "This is a test to see if this text will be printed "; //This works perfectly fine
    //AttributedString mStyledText = new AttributedString(mText);
    /**
     * Print a single page containing some sample text.
     */
    public void printer() {

        /* Get the representation of the current printer and 
         * the current print job.
         */
        PrinterJob printerJob = PrinterJob.getPrinterJob();
        /* Build a book containing pairs of page painters (Printables)
         * and PageFormats. This example has a single page containing
         * text.
         */
        Book book = new Book();
        book.append(this, new PageFormat());
        /* Set the object to be printed (the Book) into the PrinterJob.
         * Doing this before bringing up the print dialog allows the
         * print dialog to correctly display the page range to be printed
         * and to dissallow any print settings not appropriate for the
         * pages to be printed.
         */
        printerJob.setPageable(book);
        /* Show the print dialog to the user. This is an optional step
         * and need not be done if the application wants to perform
         * 'quiet' printing. If the user cancels the print dialog then false
         * is returned. If true is returned we go ahead and print.
         */
        boolean doPrint = printerJob.printDialog();
        if (doPrint) {
            try {
                printerJob.print();
            } catch (PrinterException exception) {
                System.err.println("Printing error: " + exception);
            }
        }
    }

    /**
     * Print a page of text.
     */
    public int print(Graphics g, PageFormat format, int pageIndex) {

        AttributedString mStyledText = new AttributedString(); 
        Graphics2D g2d = (Graphics2D) g;
        g2d.translate(format.getImageableX(), format.getImageableY());
        g2d.setPaint(Color.black);// Sets text colour
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {
            TextLayout layout = measurer.nextLayout(wrappingWidth);
            pen.y += layout.getAscent();
            float dx = layout.isLeftToRight() ? 0 : (wrappingWidth - layout.getAdvance());
            layout.draw(g2d, pen.x + dx, pen.y);
            pen.y += layout.getDescent() + layout.getLeading();
        }
        return Printable.PAGE_EXISTS;
    }
} 
```

将上面的代码更新为我现在正在运行的代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T01:20:28.793

这些是该类的[有效构造函数](http://docs.oracle.com/javase/7/docs/api/java/text/AttributedString.html)：

```
AttributedString(AttributedCharacterIterator text)
AttributedString(AttributedCharacterIterator text, int beginIndex, int endIndex)
AttributedString(AttributedCharacterIterator text, int beginIndex, int endIndex, AttributedCharacterIterator.Attribute[] attributes)
AttributedString(String text)
AttributedString(String text, Map<? extends AttributedCharacterIterator.Attribute,?> attributes) 
```

它们都不接受字符串列表，因此您需要重新考虑传递给它的内容。可能：

```
list.get(0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T01:20:38.523

如果您查看[**AttributedString**](http://docs.oracle.com/javase/7/docs/api/java/text/AttributedString.html)的 API，则没有将 List 作为参数的构造函数。因此，当您尝试将 List 传递给它时会出现编译时错误。

```
AttributedString mStyledText = new AttributedString(list); 
```

以下是唯一允许的构造函数`AttributedString class`

```
AttributedString(AttributedCharacterIterator text)
AttributedString(AttributedCharacterIterator text, int beginIndex, int endIndex)
AttributedString(AttributedCharacterIterator text, int beginIndex, int endIndex, AttributedCharacterIterator.Attribute[] attributes)
AttributedString(String text)
AttributedString(String text, Map<? extends AttributedCharacterIterator.Attribute,?> attributes) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T01:22:28.437

没有接受 a 的构造函数`List<String>`。

考虑到[`AttributedString`](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/AttributedString.html)处理单个字符串值，将列表传递给它没有意义。

也许你想要一个列表，即`List<AttributedString>`？在这种情况下，循环`List<String>`调用`String`构造函数并添加到`List<AttributedString>`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-23T01:24:00.627

使用 StringBuilder 构建单个字符串。

代替

```
private List<String> list; 
```

...

```
 // Wrong: List<String> list = new ArrayList<String>();
                    list = new ArrayList<String>(); //
                    String line;
                    while ((line = br.readLine()) != null) {
                        System.out.println(line);
                        list.add(line);
                    } 
```

经过

```
private String text; // Constructor argument for AttributedString. 
```

...

```
 StringBuilder stringBuilder = new StringBuilder();
                    String line;
                    while ((line = br.readLine()) != null) {
                        System.out.println(line);
                        stringBuilder.append(line).append("\n");
                    }
                    text = stringBuilder.toString(); 
```

# php - 评论系统：安全插入数据库和从数据库读取

> ID：14007927
> 
> 赞同：1
> 
> 时间：2012-12-23T01:19:09.990
> 
> 标签：php, mysql, security, comments, system

> **可能重复：**
> [如何防止 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection)

我正在我的网站上设置评论系统，我想知道这是否已保存。我使用 PHP 和 MySQL。- 不要使用下面的代码，它非常不安全 -

**创建新评论：**

1.  用户写 $comment，提交它
2.  $comment = addlashes($comment);
3.  将 $comment 插入 MySQL 数据库

**阅读评论：**

1.  用户请求评论，数据库交付 $comment
2.  $comment = htmlspecialchars(stripslashes($comment));
3.  回声$评论；

系统应该能够抵御 HTML 操作和 MySQL 注入。以及我不知道的所有其他讨厌的东西。我做对了吗？

*额外问题：我的 MySQL 表中的 $comment 应该使用什么排序规则？*

编辑：哇，我认为我的问题不会引起如此大的讨论。谢谢你的所有回答:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-23T01:28:18.847

考虑从一开始就切换到准备好的语句:-)

它们现在可能看起来有点开销，但你有很多时间担心逃避它回报的每一个参数。

这是一个很好的教程：[http](http://www.kitebird.com/articles/php-pdo.html) ://www.kitebird.com/articles/php-pdo.html 。

在打印出用户定义的内容时，您仍然需要使用`htmlspecialchars`来说明 XSS 的无懈可击性。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-12-23T01:23:21.887

使用`mysql_real_escape_string`（或您的库附带的任何转义函数）而不是`addslashes`.

不要使用`stripslashes`，因为它们已经被 MySQL 解析而被剥离，并且您冒着删除输入中合法反斜杠的风险。

对于排序规则，请使用您喜欢的任何内容。我更喜欢`latin_general_ci`，但如果你想要 unicode，你应该使用 UTF8 兼容的排序规则。

# c# - 来自 AssociationSet 的关系处于“已删除”状态

> ID：14007928
> 
> 赞同：3
> 
> 时间：2012-12-23T01:19:40.603
> 
> 标签：c#, entity-framework

我正在尝试在我的网站上创建一个新帖子，但由于某种原因，EF 抛出以下错误：

> 来自“PostAttributeValue_Definition”AssociationSet 的关系处于“已删除”状态。给定多重约束，相应的“PostAttributeValue_Definition_Source”也必须处于“已删除”状态。

由于我没有尝试删除任何内容，也没有更改或删除任何值，所以我很困惑为什么会收到此错误。

我的数据库上下文包含以下内容：

```
 modelBuilder.Entity<PostAttributeValue>().HasRequired<PostAttributeDefinition>(a => a.Definition).WithOptional().Map(m =>
        {
            m.MapKey("RelatedAttributeDefinitionId");
        }).WillCascadeOnDelete(false);

        /* Category(required) to PostAttributeDefinition(many) */
        modelBuilder.Entity<PostAttributeDefinition>().HasRequired<Category>(a => a.OwnerCategory).WithMany(c => c.AttributeDefinitions).Map(m =>
            {
                m.MapKey("OwnerCategoryId");
            }).WillCascadeOnDelete(true); 
```

我的发布方法如下所示：

```
 //
    // POST: /Post/Publish/5

    [HttpPost]
    [ValidateAntiForgeryToken]
    public ActionResult Publish(int? id, PublishViewModel model)
    {
        if (!id.HasValue || id.Value < 1)
        {
            return HttpNotFound();
        }

        var category = this.categoryService.Find(id.Value);
        if (category == null)
        {
            return HttpNotFound();
        }

        if (ModelState.IsValid)
        {
            List<PostAttributeValue> attributes = new List<PostAttributeValue>();
            foreach (var attribute in model.Attributes)
            {
                attributes.Add(new PostAttributeValue()
                {
                    Definition = attribute.Definition,
                    RawValue = attribute.Value.Serialize()
                });
            }

            Post post = new Post()
            {
                Title = model.Title,
                Description = model.Description,
                City = model.City.City,
                Brokerage = model.Brokerage,
                Location = model.Location,
                RequestedPrice = model.Price.Value,
                ParentCategory = category,
                Attributes = attributes,
            };

            this.postService.PublishPost(post);

            return RedirectToAction("ImageSelection", new { id = post.PostIdentifier });
        }

        return View(model);
    } 
```

错误是从 Repository 类 Add() 方法引发的，如下所示：

```
 public TEntity Add(TEntity entity)
    {
        if (entity == null)
        {
            throw new ArgumentNullException("entity");
        }

        try
        {
            var result = this.Entity.Add(entity);
            this.context.SaveChanges();
            return result;
        }
        catch
        {
            var deletedEntries = context.ChangeTracker.Entries().Where(e => e.State != EntityState.Added && e.State != EntityState.Unchanged);
            throw;
        }
    } 
```

因为异常与处于已删除状态的实体有关，所以我编写了这个 linq 查询来检查未更改或添加的实体，但它返回零结果......我真的不知道为什么我会收到这个错误.

需要注意的是，我正在使用代理实体，从调试器中的检​​查来看，一切似乎都很好——整个值都被填写为例外。

希望有人能帮我弄清楚。谢谢！:)

编辑：

PostAttributeDefinition 模型类，这是一个描述自定义属性定义的类（每个类别可以有不同的自定义属性 - 例如，“TV Shows”可以有自定义属性“Number of episodes”，而 Movies“IMDB rank”，例如)

```
public class PostAttributeDefinition
{
    #region Members

    private Lazy<object> lazyDataValue = null;
    private Lazy<PostAttributeDefinitionValidationRules> lazyValidatorValue = null;
    private Type cachedDataType;

    #endregion

    /// <summary>
    /// The filter name
    /// </summary>
    [Key]
    public int DefinitionId { get; set; }

    /// <summary>
    /// The owner category
    /// </summary>
    [Required]
    public virtual Category OwnerCategory { get; set; }

    /// <summary>
    /// The filter title
    /// </summary>
    [Required]
    public string Title { get; set; }

    /// <summary>
    /// Metadata enum that provides extra data about the data type
    /// </summary>
    public PostAttributeTypeMetadata TypeMetadata { get; set; }

    /// <summary>
    /// Bitwise metadata that provides data about the object in display mode
    /// </summary>
    public PostAttributeDisplayModeMetadata DisplayModeMetadata { get; set; }

    public PostAttributeEditorType EditorType { get; set; }

    /// <summary>
    /// The attribute raw default value
    /// </summary>
    [Required]
    public byte[] RawDataValue { get; set; }

    /// <summary>
    /// The attribute raw associated validation attributes
    /// </summary>
    /// <remarks>
    /// This field is used only by EF.
    /// YES - It's against DDD rules, and I need to seperate it. setting it in TODO.
    /// </remarks>
    public byte[] RawValidationRules { get; set; }

    /// <summary>
    /// Is this field required
    /// </summary>
    /// <remarks>
    /// This field does not relate to the validation rules since we should check it
    /// only in creation / modification of the post and not in search for example.
    /// </remarks>
    public bool IsRequired { get; set; }

    /// <summary>
    /// The attribute validators
    /// </summary>
    public PostAttributeDefinitionValidationRules ValidationRules
    {
        get
        {
            if (lazyValidatorValue == null)
            {
                lazyValidatorValue = new Lazy<PostAttributeDefinitionValidationRules>(() =>
                {
                    if (this.RawValidationRules == null || this.RawValidationRules.Length == 0)
                    {
                        return new PostAttributeDefinitionValidationRules();
                    }

                    return this.RawValidationRules.Deserialize() as PostAttributeDefinitionValidationRules;
                });
            }

            return lazyValidatorValue.Value;
        }
        set
        {
            this.RawValidationRules = value.Serialize();
            this.lazyValidatorValue = null;
        }
    }

    /// <summary>
    /// Get the stored object data type
    /// </summary>
    public Type ValueDataType
    {
        get
        {
            //  Make sure we've loaded the serialized value
            if (lazyDataValue == null)
            {
                RetriveDataValue();
            }

            return cachedDataType;
        }
    }

    #region Value content

    /// <summary>
    /// Store the attribute default value
    /// </summary>
    /// <typeparam name="TType">The default value type</typeparam>
    /// <param name="value">The default value</param>
    /// <returns>Fluent style writing - returning the same object</returns>
    public PostAttributeDefinition StoreDataValue<TType>(TType value)
    {
        //  In case of empty value, we need to defaultize it
        if (value == null)
        {
            value = value.DefaultizeNullableValueForSerialize<TType>();
        }

        //  Store as bytes
        RawDataValue = value.Serialize<TType>();

        //  Reset the lazy cached value
        lazyDataValue = null;

        //  Fluent style returned value
        return this;
    }

    /// <summary>
    /// Retrive the item default value
    /// </summary>
    /// <typeparam name="TType">The item default value data type</typeparam>
    /// <returns>The item default value</returns>
    /// <exception cref="InvalidOperationException">Thrown in case the raw value is null or empty.</exception>
    public TType RetriveDataValue<TType>()
    {
        return (TType)RetriveDataValue();
    }

    /// <summary>
    /// Retrive the item default value
    /// </summary>
    /// <returns>The item default value</returns>
    /// <exception cref="InvalidOperationException">Thrown in case the raw value is null or empty.</exception>
    public object RetriveDataValue()
    {
        //  Make sure that we've loaded the lazy value
        if (lazyDataValue == null)
        {
            lazyDataValue = new Lazy<object>(() =>
            {
                //  Deserialize
                var value = RawDataValue.Deserialize();

                //  Remve defaultize in case we've done that (by the way, we're caching the type
                //  in order to retrive it in case of null value)
                value = value.ReverseDefaultizeNullableValueForDeSerialize(out cachedDataType);

                //  Return it
                return value;
            });
        }

        //  Return the cached lazy data value
        return lazyDataValue.Value;
    }

    #endregion
} 
```

我希望保存并导致问题的 PostAttributeValue 类是：

```
public class PostAttributeValue
{
    /// <summary>
    /// The attribute value id
    /// </summary>
    [Key]
    public int AttributeValueId { get; set; }

    /// <summary>
    /// The value owner post
    /// </summary>
    public virtual Post OwnerPost { get; set; }

    /// <summary>
    /// The value attribute definition id
    /// </summary>
    //public int RelatedAttributeDefinitionId { get; set; }

    /// <summary>
    /// The value attribute definition
    /// </summary>
    public virtual PostAttributeDefinition Definition { get; set; }

    /// <summary>
    /// The stored raw value
    /// </summary>
    public byte[] RawValue { get; set; }

    #region Value content

    /// <summary>
    /// Check if there's anything stored in the raw value
    /// </summary>
    /// <returns>Boolean value indicates if there's anything stored in the raw value</returns>
    public bool HasValue()
    {
        return RawValue != null;
    }

    /// <summary>
    /// Retrive the item value
    /// </summary>
    /// <typeparam name="TType">The item default value data type</typeparam>
    /// <returns>The item value</returns>
    /// <exception cref="InvalidOperationException">Thrown in case the raw value is null or empty.</exception>
    public TType RetriveValue<TType>()
    {
        return (TType)RetriveValue();
    }

    /// <summary>
    /// Retrive the item value
    /// </summary>
    /// <returns>The item value</returns>
    /// <exception cref="InvalidOperationException">Thrown in case the raw value is null or empty.</exception>
    public object RetriveValue()
    {
        if (RawValue == null)
        {
            throw new InvalidOperationException("Could not deserialize the value since there's nothing in the raw value.");
        }
        return RawValue.Deserialize();
    }

    #endregion
} 
```

请注意，我使用 ViewModel 作为属性（model.Attributes 是一个 IEnumerable）

```
public class PostAttributeViewModel
{
    [ReadOnly(true)]
    [Editable(false)]
    public PostAttributeDefinition Definition { get; set; }

    [Required]
    public int DefinitionId { get; set; }

    [Required]
    public string DefinitionVertificationToken { get; set; }

    public object Value { get; set; }
} 
```

我分配并映射到 PostAttributeValue 模型的定义属性由 EF 自动填充。

# ruby-on-rails - 从一页的输入框中获取值并将其传递给另一页的标题

> ID：14007929
> 
> 赞同：0
> 
> 时间：2012-12-23T01:19:41.673
> 
> 标签：ruby-on-rails, string, textinput

我有一个我正在努力实现的功能，在任何地方都没有找到正确的答案。当用户将一些文本放入输入表单并单击“下一步”按钮时，他会将输入文本视为另一个页面的标题。

您可以登录到我的应用程序以了解我的意思： http: [//murmuring-headland-8091.herokuapp.com/](http://murmuring-headland-8091.herokuapp.com/) 例如，用户写下他想要做出的决定：“选择哪个工作？”，然后点击“你的选择是什么？”后 按钮，他看到“选择哪个工作？” 而不是“第 2 步，共 4 步”。

我认为我想要实现的东西被称为“字符串”，但我无法进一步了解这些知识。希望我把我的问题说清楚了。我是新手，希望能得到详细的解答。

这是我的应用程序的 github：[https ://github.com/strikhar/decisions](https://github.com/strikhar/decisions)

感谢您抽出宝贵时间帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T06:02:17.263

输入字段“选择哪个工作？” 没有与之关联的名称。因此，您需要为其分配一个名称以访问用户提供的输入。

一旦你给它分配了一个名字，比如说`whichjob`，你就可以通过它来访问`string`它`params[:whichjob]`。然后使用它，您可以显示此字符串来代替“Step 2 of 4”。

而不是使用这种手段

```
<a href="/options">What are your options? -&gt;</a> 
```

使用`submit`相同的字段。例如，

```
<form action='/options'>
.
.
.
.
     <input type='submit' value='Submit it now and go to "What are your options?"' /> 
```

# django - 当所有其他人似乎都工作时，Django NoReverseMatch

> ID：14007936
> 
> 赞同：0
> 
> 时间：2012-12-23T01:21:40.433
> 
> 标签：django, url, reverse

在我的模板、模型等中，所有其他反向 url（编辑、删除等）似乎都有效，但在我的业务应用程序**views.py**中却没有这个（错误跳下）：

```
from django.views.generic import ListView, DetailView
from django.views.generic.edit import UpdateView, DeleteView, CreateView
from django.core.urlresolvers import reverse

from business.models import Country

{...}

# Delete
class CountryDeleteView(DeleteView):
model = Country
template_name_suffix = '_delete_form'
success_url = reverse('country_listview')  # commenting this out makes everything work 
```

**项目 urls.py：**

```
from django.conf.urls import patterns, include, url

urlpatterns += patterns('',
    url(r'^business/', include('business.urls')),
    ) 
```

**业务应用程序 urls.py：**

```
from django.conf.urls import patterns, url
from business.views import CountryListView, CountryDetailView
from business.views import CountryCreateView, CountryUpdateView, CountryDeleteView

urlpatterns = patterns('',
    url(r'^country/$', CountryListView.as_view(), name='country_listview'),
    url(r'^country/(?P<pk>\d+)/$', CountryDetailView.as_view(), name='country_detailview'),
    url(r'^country/create/$', CountryCreateView.as_view(), name='country_createview'),
    url(r'^country/(?P<pk>\d+)/update/$', CountryUpdateView.as_view(), name='country_updateview'),
    url(r'^country/(?P<pk>\d+)/delete/$', CountryDeleteView.as_view(), name='country_deleteview'),
    ) 
```

我使用`model_listview`而不是仅仅`model_list`因为默认情况下`ListView`通用编辑视图已经`model_list`在上下文中传递（我没有在我的`ListView`子类中指定我应该为我的上下文变量命名的内容）并且它与模板**country_list.html**中的此代码冲突：

```
<ul>
    {% for c in country_list %}
        <li>{{ c.name }}<br>
            <a href="{% url country_detailview c.pk %}">Detalii</a>
            <a href="{% url country_updateview c.pk %}">Modifica</a>
            <a href="{% url country_deleteview c.pk %}">Sterge</a>
        </li>
    {% endfor %}
</ul> 
```

**和错误：**

> NoReverseMatch 在 /business/country/
> 
> 未找到带有参数“()”和关键字参数“{}”的“country_listview”的反向操作。
> 
> 请求方法：GET
> 
> 请求网址：_removed_ip_:8000/business/country/
> 
> Django 版本：1.4.3
> 
> 异常类型：NoReverseMatch
> 
> 异常值：
> 
> 未找到带有参数“()”和关键字参数“{}”的“country_listview”的反向操作。
> 
> 异常位置：/usr/lib/python2.7/site-packages/django/core/urlresolvers.py 在 _reverse_with_prefix，第 396 行
> 
> Python 可执行文件：/usr/bin/python
> 
> Python版本：2.7.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T04:23:05.017

可能是在加载 url 之前定义了表单。试试 reverse_lazy 看看是否可行。

未经测试：

```
from django.core.urlresolvers import reverse_lazy

...

success_url = reverse_lazy('country_listview') 
```

# ruby-on-rails - 让模型访问 Rails 中的 params 哈希的最佳方法是什么？

> ID：14007939
> 
> 赞同：0
> 
> 时间：2012-12-23T01:22:03.427
> 
> 标签：ruby-on-rails, ruby, api, model-view-controller, params

这似乎违反了 MVC，所以我将解释我正在尝试做的事情：

我的模型调用 API，API 的 URI 取决于 params 哈希。（params 哈希存储 Rails 应用程序的 URL）。

我创建了一个模块来混合到模型中（因为模型与 API 调用无关），但还没有弄清楚如何将参数放入模块中。

如果可能的话，我想用 params 哈希初始化模块，但不知道在哪里做。`before_create`在模型上可以工作，但那是在`model.rb`不知道参数的文件中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T09:02:46.413

几个想法，取决于你的需要：

如果参数变化很大，则在每次调用时将参数传递给模型。你可以做一个类方法或实例方法 -

```
Model.api_call params[:field]
@model.api_call params[:field] 
```

将参数保存为模型中的类变量：

```
Model.set_parameters(params)

def self.set_parameters(params)
  @@params = params
end

# access it in methods with @@params 
```

# objective-c - lldb 错误：在类型的对象上找不到属性

> ID：14007942
> 
> 赞同：22
> 
> 时间：2012-12-23T01:22:53.047
> 
> 标签：objective-c, ios6, xcode4.5, lldb

我正在尝试使用 lldb 调试我的 iOS 应用程序，但我在调试时遇到了非常奇怪的错误。

在断点前几行，我得到了：

`CGRect frame = view.frame;`

我可以使用`print frame`lldb 中的命令毫无问题地访问它。但是，当我尝试在 lldb 中再次访问框架时，我输入`print view.frame`并收到以下错误：

`error: property 'frame' not found on object of type 'UIView *'`

这没有意义，因为我可以通过键入并获得正确的结果来验证它`view`是一个`UIView*`实例并具有一个名为 frame 的有效属性：`po view`

`(UIView *) $4 = 0x1e199bf0 <MyAppCustomView: 0x1e199bf0; frame = (3398 3396; 204 208); layer = <CALayer: 0x1e199ce0>>`

*这个特殊的lldb*错误经常发生在我身上，我找不到这个错误的原因。有人在[属性 'count' not found on object of 'NSMutableArray *' PO command in lldb](https://stackoverflow.com/questions/13567455/property-count-not-found-on-object-of-type-nsmutablearray-po-command-in-ll)中建议可以使用 gdb，`(gdb) p view.frame`但我得到了`error: '(gdb)' is not a valid command.`，我高度怀疑 gdb 命令会“工作吗？” 无论如何，在另一个调试器中。

对于这个随机发生的错误有什么建议或解决方法吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-12-23T01:24:52.320

使用 Objective-C 时，lldb 不支持用于消息发送的点表示法。使用括号表示法并将结果转换为 CGRect：

```
p (CGRect)[view frame] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-01T21:36:42.840

以防万一上述方法不起作用（它不适合我，寻找变量单元格的框架，从 UITableViewCell 派生的类）：强制使用额外的括号似乎有助于 lldb 的小脑筋：

```
p ((CGRect)[cell frame]) 
```

魔术前奏：

```
(CGRect) $5 = origin=(x=0, y=0) size=(width=320, height=44) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-29T19:15:45.620

我不得不在 Xcode > Product > Scheme > Edit Scheme > Run > Diagnostics 中禁用（取消选中）Thread Sanitizer。启用 Thread Sanitizer 后，我无法通过 LLDB 访问许多 NSView 属性（例如边界、框架）。

# url - play framework2：查看应用程序是在 http 还是 https 上运行

> ID：14007946
> 
> 赞同：2
> 
> 时间：2012-12-23T01:23:44.707
> 
> 标签：url, playframework-2.0, router

我正在尝试确定 play 2 (with scala) 应用程序是否在 http 或 https 上运行

我尝试使用 routes.Application.index.absoluteURL(request)，就像这样

```
def chatUri(username: String)(implicit request: RequestHeader): String = {

  val uri = routes.Application.index.absoluteURL(request) 
```

但我收到以下错误：

```
/home/sas/tmp/websocket-chat/app/controllers/Application.scala:51: overloaded method value absoluteURL with alternatives:
[error]   (secure: Boolean)(implicit request: play.api.mvc.RequestHeader)java.lang.String <and>
[error]   (play.mvc.Http.Request)java.lang.String
[error]  cannot be applied to (play.api.mvc.RequestHeader)
[error]     val rootUri = Uri(routes.Application.index.absoluteURL(request)) 
```

我试图将 RequestHeader 转换为 Request，但出现以下错误

```
val rootUri = Uri(routes.Application.index.absoluteURL(request.asInstanceOf[Request[Any]]))

(secure: Boolean)(implicit request: play.api.mvc.RequestHeader)java.lang.String <and>
[error]   (play.mvc.Http.Request)java.lang.String
[error]  cannot be applied to (play.api.mvc.Request[Any])
[error]     val rootUri = Uri(routes.Application.index.absoluteURL(request.asInstanceOf[Request[Any]])) 
```

知道如何实现吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T11:23:44.303

必须说我对在 Scala 中获取绝对 url 的问题感到惊讶，在 Java 中它运行良好，无论如何......我怀疑它是否会帮助你确定协议（*编辑*：正如@MariusSoutier 所写）

由于Play 2[中没有对 SSL 的内置支持，](https://groups.google.com/forum/?fromgroups=#!topic/play-framework/-7zP0jV5T4U)您很可能正在（或应该使用）您的应用程序前面的一些 HTTP 服务器，比如说 Apache。有一些示例和帖子描述了该过程：

1.  查看主题：[如何配置 PlayFramework2 以支持 SSL？](https://stackoverflow.com/a/10758612/1066240)Nasir 提供了一个将 Apache 配置为 Play 代理的示例
2.  [将 Apache 配置为代理](http://www.nczonline.net/blog/2012/08/08/setting-up-apache-as-a-ssl-front-end-for-play/)也有很好的描述（**警告** *帖子描述的是 Play 1.x，但是 Apache 部分将是相同的*）
3.  最后，您需要设置[将转发](https://serverfault.com/a/257643/118032)到您的应用程序的正确标题

因此，在设置标题后（如第 3 点所示），您将能够在控制器中检查它：

```
def index = Action { request =>
    val proto = request.headers("X-FORWARDED-PROTO")
    Ok("Got request [" + request + "] with schema: " + proto )
} 
```

或在 Java 控制器中相同：

```
public static Result index() {
    String proto = request().getHeader("X-FORWARDED-PROTO");
    return ok("Got request [" + request() + "] with schema: " + proto);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-23T11:08:52.627

首先，通过创建绝对 URL，您无法确定应用程序是在 http 还是 https 上运行 - 查看方法签名：

```
def absoluteURL (secure: Boolean = false)(implicit request: RequestHeader): String 
```

没错，你必须*告诉*这个方法你是否想要安全。

我认为这是因为 Play 被设计为在反向代理后面工作，这使得使用加密请求变得透明。这意味着 Play 不必关心这一点。`absoluteURL`只能强制使用 https URL，例如确保登录页面使用 https。

根据您的反向代理，您可以设置一个自定义 http 标头，告诉您使用什么。`RequestHeader`没有信息。

# javascript - 悬停卡有更好的方法吗？

> ID：14007949
> 
> 赞同：0
> 
> 时间：2012-12-23T01:24:10.027
> 
> 标签：javascript, jquery, hover

在我的网站上，我在用户的个人资料图片上有悬停卡片。我有两个问题。

1.  我遇到的第一个问题是，当您将鼠标移开或移出个人资料图片时，它在显示和隐藏方面效果不佳。当您将鼠标快速移动到图片上时（例如，如果您只是在页面上移动鼠标）大约一秒钟后它仍然会弹出。我不明白为什么它会这样做。**只有在悬停 1000 毫秒后，卡片才会弹出。**

2.  我遇到的第二个问题是，如果您将鼠标悬停在一张图片上，然后在另一张图片关闭之前移动到另一张图片（例如位于其正上方的图片），则除非您将鼠标从图片上移开，否则它将无法正常工作然后将其移回上面。

我想知道是否有比我现在做的更好的方法来做 mouseenter 和 mouseleave 事件。

![悬停卡截图](../Images/43817c70e7c38746098b8e6aab88138b.png)

这是我用于悬停卡的 JavaScript：

```
var timeout, timeout2, hovercard_request;
$('.profile-hovercard').live('mouseenter',function() {
if(!$('#hovercard').hasClass('open')) {
    var id = $(this).attr('data-id'),
        pos = $(this).offset(),
        width = $(this).outerWidth(),
        miniprofile_url = $(this).parent().attr('href') + '/mini_profile';
    timeout = setTimeout(function() {
        //$('#hovercard').remove();
        if ($('#hovercard').length <= 0) {
            var hc = '<div id="hovercard" class="open"> \
              <div class="hovercard-loading"><img src="/assets/img/ProgressIndicator.gif" /></div> \
              </div>';
            $('body').append(hc);
            $('#hovercard').css({
                'position': 'absolute',
                'top': pos.top + "px",
                'left': (pos.left + width + 11) + "px"
            });
        }
        else {
            $('#hovercard').css({
                'position': 'absolute',
                'top': pos.top + "px",
                'left': (pos.left + width + 11) + "px"
            }).html('<div class="hovercard-loading"><img src="/assets/img/ProgressIndicator.gif" /></div>').show().addClass('open');
        }
        $.get(miniprofile_url, {}, function(data) {
            $('#hovercard').html('<div class="hovercard-inner"> \
                                  <div class="hovercard-pic"> \
                                     <a href="'+data.url+'"><img src="' + data.img_path + '" alt="' + data.name + '" /></a> \
                                  </div> \
                                 <div class="hovercard-details"> \
                                 <h3><a href="'+data.url+'">' + data.name + ( data.you == 1 ? ' <span style="font-weight:normal">(you)</span>' : '' ) + '</a> ' + ( data.is_online ? '<span class="online-user-icon m" title="'+data.name+' is online."></span>' : '') + '</h3> \
                                 <div class="hovercard-stats"> \
                                     <strong class="points">' + data.points + ' point' + (data.points == 1 ? '' : 's') + '</strong><br /> \
                                     <strong>' + data.questions + '</strong> question' + (data.questions == 1 ? '' : 's') + ' / <strong>' + data.answers + '</strong> answer' + (data.answers == 1 ? '' : 's') + '<!-- / <strong>' + data.comments + '</strong> comment' + (data.comments == 1 ? '' : 's') + '--><br /> \
                                     <span class="location">' + data.location + '</span> \
                                 </div> \
                                 </div> \
                                 <div class="clear"></div> \
                                 </div>');
            if(data.bio !== '') {
                $('#hovercard').append('<div class="hovercard-bio">' + data.bio + '</div>');
            }
            else {
                $('#hovercard').append('<div class="hovercard-bio"><em>This user does not have a bio.</em></div>');
            }
        },'json').fail(function() {
            $('#hovercard').html('<div class="hovercard-loading">The request has failed. Please try again later.</div>');
        }).error(function() {
            $('#hovercard').html('<div class="hovercard-loading">An error has occurred. Please try again later.</div>');
        });
    }, 1000);
} // end if
});
$('.profile-hovercard').live('mouseleave',function() {
    clearTimeout(timeout);
    //hovercard_request.abort();
    timeout2 = setTimeout(function() {
       $('#hovercard').hide().removeClass('open');
    }, 400);
    $('#hovercard').hover(function() {
        clearTimeout(timeout2);
    },function() {
        timeout2 = setTimeout(function() {
            $('#hovercard').hide().removeClass('open');
        }, 300);
    });
}); 
```

当您将鼠标悬停在某人的照片上时，它旁边会弹出一个小框，显示他们的一些信息。在上面的代码中，我有所有的超时，因为这是我可以让卡保持打开状态的唯一方法，这样有人可以将鼠标移到卡上而不会关闭卡。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T01:46:43.750

您可以尝试`clearTimeout(x);`在`setTimeout`. 这应该确保计时器没有启动两次。

这段代码仍然可以使用一些重构；mouseenter 处理程序太长了，很难理解它的作用和调试。

```
var timeout, timeout2, hovercard_request;
$('.profile-hovercard').live('mouseenter', function() {
    if (!$('#hovercard').hasClass('open')) {
        var id = $(this).attr('data-id'),
            pos = $(this).offset(),
            width = $(this).outerWidth(),
            miniprofile_url = $(this).parent().attr('href') + '/mini_profile';

        clearTimeout(timeout);
        timeout = setTimeout(function() {
            //$('#hovercard').remove();
            if ($('#hovercard').length <= 0) {
                var hc = '<div id="hovercard" class="open"> \
              <div class="hovercard-loading"><img src="/assets/img/ProgressIndicator.gif" /></div> \
              </div>';
                $('body').append(hc);
                $('#hovercard').css({
                    'position': 'absolute',
                    'top': pos.top + "px",
                    'left': (pos.left + width + 11) + "px"
                });
            }
            else {
                $('#hovercard').css({
                    'position': 'absolute',
                    'top': pos.top + "px",
                    'left': (pos.left + width + 11) + "px"
                }).html('<div class="hovercard-loading"><img src="/assets/img/ProgressIndicator.gif" /></div>').show().addClass('open');
            }
            $.get(miniprofile_url, {}, function(data) {
                $('#hovercard').html('<div class="hovercard-inner"> \
                                  <div class="hovercard-pic"> \
                                     <a href="' + data.url + '"><img src="' + data.img_path + '" alt="' + data.name + '" /></a> \
                                  </div> \
                                 <div class="hovercard-details"> \
                                 <h3><a href="' + data.url + '">' + data.name + (data.you == 1 ? ' <span style="font-weight:normal">(you)</span>' : '') + '</a> ' + (data.is_online ? '<span class="online-user-icon m" title="' + data.name + ' is online."></span>' : '') + '</h3> \
                                 <div class="hovercard-stats"> \
                                     <strong class="points">' + data.points + ' point' + (data.points == 1 ? '' : 's') + '</strong><br /> \
                                     <strong>' + data.questions + '</strong> question' + (data.questions == 1 ? '' : 's') + ' / <strong>' + data.answers + '</strong> answer' + (data.answers == 1 ? '' : 's') + '<!-- / <strong>' + data.comments + '</strong> comment' + (data.comments == 1 ? '' : 's') + '--><br /> \
                                     <span class="location">' + data.location + '</span> \
                                 </div> \
                                 </div> \
                                 <div class="clear"></div> \
                                 </div>');
                if (data.bio !== '') {
                    $('#hovercard').append('<div class="hovercard-bio">' + data.bio + '</div>');
                }
                else {
                    $('#hovercard').append('<div class="hovercard-bio"><em>This user does not have a bio.</em></div>');
                }
            }, 'json').fail(function() {
                $('#hovercard').html('<div class="hovercard-loading">The request has failed. Please try again later.</div>');
            }).error(function() {
                $('#hovercard').html('<div class="hovercard-loading">An error has occurred. Please try again later.</div>');
            });
        }, 1000);
    } // end if
});
$('.profile-hovercard').live('mouseleave', function() {
    clearTimeout(timeout2);
    //hovercard_request.abort();
    timeout2 = setTimeout(function() {
        $('#hovercard').hide().removeClass('open');
    }, 400);
    $('#hovercard').hover(function() {
        clearTimeout(timeout2);
    }, function() {
        clearTimeout(timeout2);
        timeout2 = setTimeout(function() {
            $('#hovercard').hide().removeClass('open');
        }, 300);
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T02:38:00.927

这是您可以做到的一种方法：

```
var timeout;

$('.profile').hover(function() {
    pos = $(this).offset();

    timeout = setTimeout(function() {
        $('.hovercard').fadeIn().css({
            'top': pos.top - 20 + 'px',
            'left': pos.left - 20 + 'px'
        });
    }, 1000);

}, function() {
    clearTimeout(timeout);
});

$('.hovercard').mouseleave(function() {
    $('.hovercard').fadeOut();
});​ 
```

基本上，您为 hovercard 提供额外的填充，以便它也覆盖个人资料图片。这意味着您可以使用事件的个人资料图片和`mouseenter`事件的悬停卡`mouseleave`。

示例：http: [//jsfiddle.net/grc4/C8VTS/1/](http://jsfiddle.net/grc4/C8VTS/1/)

# android - Android 在 PreferenceFragment 中模拟后退按钮

> ID：14007958
> 
> 赞同：0
> 
> 时间：2012-12-23T01:26:09.493
> 
> 标签：android

我在 PreferenceFragment 屏幕底部添加了一个 Cancel 和 OK 按钮，但我不知道单击它们时如何返回到上一个屏幕。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T02:15:43.160

在 onClickListener 中，您应该获取托管您的 PreferenceFragment 的父活动，并以标准方式删除该 PreferenceFragment。

```
getFragmentManager().beginTransaction().remove(preferencesFragment).commit(); 
```

preferencesFragment 是对您的 PreferencesFragment 的引用。

# c++ - 求除数的数量？

> ID：14007962
> 
> 赞同：3
> 
> 时间：2012-12-23T01:28:20.813
> 
> 标签：c++

我编写此代码是为了找到给定数字的除数。我尝试实现的方法找到所有素数因子（有效）并取相似素数的数量加一（给出除数的数量）。

例如 28 = 2*2 * 7 --> (2+1)*(1+1) = 6

这是我的尝试：

```
int num = 20;
int next = 0;
int exponent = 0;
int numberOfDivisors = 1;

    start:
        for (int i = 2; i <= num; i++)
        {
            next = i;

            if (num%i == 0)
            {   
                if (i == next)
                {
                    exponent++; 
                }
                else
                {
                    numberOfDivisors *= (exponent+1);
                    exponent = 0;
                }

                if (num != i)
                {
                    num /= i;
                    goto start;
                }
            }
        }

    std::cout << numberOfDivisors << std::endl; 
```

我只是无法弄清楚我错过了什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T01:38:19.557

从评论中可以看出，使用 goto 很糟糕。经过一点清理后，您的代码归结为：

```
#include <iostream>
int main() {
  int num = 20; 
  int numberOfDivisors = 1;

  for (int i = 2; i <= num; i++)
  {
    int exponent = 0;
    while (num % i == 0) {
        exponent++; 
        num /= i;
    }   
    numberOfDivisors *= (exponent+1);
  }

  std::cout << numberOfDivisors << std::endl;
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T01:36:56.623

实际上，这`goto`没有帮助，因为您已经检查了较低的主要因素，因此无需`i`放回`2`.

```
 int numberOfDivisors = 1;
    int exponent = 1;
    int i = 2;
    while (i <= num) {
        if (num%i == 0) {   
            exponent++; 
            num /= i;
        }
        else {
            numberOfDivisors *= exponent;
            exponent = 1;
            i++;
        }
    }
    numberOfDivisors *= exponent; // <-- you were missing this, mainly 
```

与样式或性能无关的代码的实际问题是您的循环完成了一些`exponent`您从未包含的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T02:04:15.953

你的代码有很多问题（而且`goto`中断循环很丑陋），但你的代码的一个主要问题是，在你进入`for`循环之后，你设置`next`的值与`i`.

然后，您测试一些东西（即 if`i`均分`num`，但这没关系）*和*（这是关键部分，您测试 if `i`is equal to `next`，您*只需*将它们设置为相等。

因此，您的代码永远没有机会输入`else`相应的部分`if`，即您将除数乘以`exponent + 1`.

结果，您的代码总是打印`1`，这不是您想要的。

`-O1`PS：作为死代码消除的一部分，编译器可能会完全优化其他内容，如果我启用优化或更高版本，这就是我的 gcc 4.7 实际上所做的。

# python - 如何通过 BeagleBone 上的 GPIO 引脚生成声音信号

> ID：14007965
> 
> 赞同：2
> 
> 时间：2012-12-23T01:28:38.237
> 
> 标签：python, audio, beagleboard

我正在寻找有关如何在 BeagleBone 上生成合成声音信号的指针/提示，类似于观察 Arduinos 上的tone() 函数。最终，我想在 GPIO 引脚上连接一个压电或扬声器，并从中听到声波。任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T20:27:44.047

这就是我设法使用 Python 和[PyBBIO](https://github.com/alexanderhiam/PyBBIO)在 Beaglebone 上解决这个问题的方法：

```
#!/usr/bin/python
# Circuit:
# * A Piezo is connected to pin 12 on header P8\.        - GPIO1_12
# * A LED is connected to pin 14 on header P8\.          - GPIO0_26
# * A button is connected to pin 45 on header P8\.       - GPIO2_6
#   Use a pull-down resistor (around 10K ohms) between pin 45 and ground. 
#       3.3v for the other side of the button can be taken from pins 3 or 4 
#       on header P9\. Warning: Do not allow 5V to go into the GPIO pins.
# * GND - pin 1 or 2, header P9.

def setup(): # this function will run once, on startup
    pinMode(PIEZO, OUTPUT) # set up pin 12 on header P8 as an output - Piezo
    pinMode(LED, OUTPUT) # set up pin 14 on header P8 as an output - LED
    pinMode(BUTTON, INPUT) # set up pin 45 on header P8 as an input - Button

def loop(): # this function will run repeatedly, until user hits CTRL+C
    if (digitalRead(BUTTON) == HIGH): 
        # was the button pressed? (is 3.3v making it HIGH?) then do:
            buzz()
    delay(10) # don't "peg" the processor checking pin

def delay(j):  #need to overwrite delay() otherwise, it's too slow
    for k in range(1,j):
            pass

def buzz():    #this is what makes the piezo buzz - a series of pulses
               # the shorter the delay between HIGH and LOW, the higher the pitch
    limit = 500     # change this value as needed; 
                    # consider using a potentiometer to set the value
    for j in range(1, limit):
            digitalWrite(PIEZO, HIGH)
            delay(j)
            digitalWrite(PIEZO, LOW)
            delay(j)
            if j==limit/2:
                    digitalWrite(LED, HIGH)
    digitalWrite(LED, LOW) # turn it off

run(setup, loop) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T02:14:48.103

AM3359 的 GPIO 引脚电压低，驱动强度不足以直接驱动任何类型的传感器。为此，您需要构建一个带有运算放大器、晶体管或 FET 的小电路。

完成此操作后，您只需设置一个定时器循环，以所需频率更改 GPIO 线的状态。

到目前为止，从该板获取音频的最快和最简单的方法是使用 USB 音频接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T02:16:38.070

看看[这个页面](http://processors.wiki.ti.com/index.php/GPIO_Driver_Guide)。从用户态（例如python），您可以通过写入正确的`sysfs`文件来将引脚设置为高或低`/sys/class/gpio`。

# android - 打开系统位置设置后android对话框不会关闭

> ID：14007966
> 
> 赞同：2
> 
> 时间：2012-12-23T01:28:44.377
> 
> 标签：android, dialog, settings

如果未启用，我有一个对话框提示用户启用 gps 位置。

打开设置后，用户启用 gps，并从位置设置屏幕按后退按钮，他们返回应用程序，但对话框仍然可见。

这是单击按钮的代码。

```
 // On pressing Settings button
    alertDialog.setPositiveButton("OK", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog,int which) {
            Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
            mContext.startActivity(intent);
            dialog.dismiss();
        }

    }); 
```

我的问题是为什么 dialog.dismiss() 不关闭对话框，我也尝试了 dialog.cancel() 具有相同的结果。打开设置屏幕后我应该做些什么吗？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T02:03:40.180

我的代码中有这段代码`Activity`：

```
private void showLocationDisabledInfo() {
    final Context c = this;
    AlertDialog.Builder builder = new AlertDialog.Builder(c);
    builder.setMessage("TEST");
    builder.setPositiveButton("OK", new OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {
            Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
            c.startActivity(intent);
        }
    });
    builder.setNeutralButton(R.string.cancel, null);
    builder.create().show();
} 
```

无论我点击什么按钮，它都会自动关闭对话框。它来自我的应用程序，并且在具有 API`8`和的设备上`10`以及运行 API 的模拟器上进行了测试`17`。我们的代码之间的唯一区别（可能）是`mContext`. 请提供负责设置对话框和您所描述行为的环境的完整代码。

# objective-c - 点击计数和圈数

> ID：14007972
> 
> 赞同：0
> 
> 时间：2012-12-23T01:30:31.680
> 
> 标签：objective-c, ios, math, tap

我创建了示例点击计数应用程序。但我不知道如何计算圈数。示例：当命中数 100 时，圈数为 1。当命中数 200 时，圈数为 2。我使用以下代码。谢谢。我是 xcode 初学者。

以下代码是 ViewController.m

```
#import "ViewController.h"

 @interface ViewController ()

 @end

@implementation ViewController

-(IBAction)plus {
    counter=counter +1;
    count.text = [NSString stringWithFormat:@"%i", counter];
}

-(IBAction)minus {
     counter=counter -1;
    count.text = [NSString stringWithFormat:@"%i", counter];
 }

 -(IBAction)zero {
     counter=0;
     count.text = [NSString stringWithFormat:@"%i", counter];
}
- (void)viewDidLoad
{
    counter=0;
     count.text=@"0";
     [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

 - (void)didReceiveMemoryWarning
 {
     [super didReceiveMemoryWarning];
     // Dispose of any resources that can be recreated.
 }

 @end 
```

以下代码是 ViewController.h #import

```
 int counter;

 @interface ViewController : UIViewController {
     IBOutlet UILabel *count;
     IBOutlet UILabel *lap;
 }

 -(IBAction)plus;
 -(IBAction)minus;
 -(IBAction)zero;
 @end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T02:48:08.317

这是我如何做到这一点的。现在请注意，我没有使用您的确切设置，但这应该可以工作，或者至少给您正确的想法。理论上这应该更难，因为你真的想检查无限量的 100 圈，所以我们也需要一些逻辑检查，除非我们使用 int。Int 并不精确，所以如果我们说 50/100，它仍然会返回 0。但是，100/100 = 1、200/100 = 2、275/100 仍然等于 2。这将轻松完成您想要的。

这是一个简单的例子，只有一个增加数量的按钮，我使用全局变量来计算圈数和点击数。

在.h

```
#import <UIKit/UIKit.h>

@interface TapCounterViewController : UIViewController
- (IBAction)buttonTouched:(id)sender;

@end 
```

在他们中

```
#import "TapCounterViewController.h"

@interface TapCounterViewController ()

@end

@implementation TapCounterViewController

int lapNumber = 0;
int buttonTaps = 0;
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)buttonTouched:(id)sender {
    buttonTaps = buttonTaps + 1;
    NSLog(@"Current Button Taps = %i", buttonTaps);

    //Check for Lap
    [self checkForLap];
}

-(void)checkForLap {
    //We must divide by 100 to check for the number if laps.
    int laps = buttonTaps/100;
    NSLog(@"Number of laps = %i", laps);
    lapNumber = laps;
}
@end 
```

这可以很容易地适应递减，重置你任何东西。每当您更改按钮点击时，执行 checkForLap。

祝你好运，如果您需要更多信息，请告诉我！

编辑

至于震动：

有两个看似相似的函数采用参数 kSystemSoundID_Vibrate：

1) `AudioServicesPlayAlertSound(kSystemSoundID_Vibrate);` 2)`AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);`

这两个功能都会震动 iPhone。但是当您在不支持振动的设备上使用第一个功能时，它会发出哔声。另一方面，第二个功能在不受支持的设备上没有任何作用。因此，如果您要连续振动设备，就像常识所说的警报一样，请使用功能 2。

另请参阅“iPhone 教程：检查 iOS 设备功能的更好方法”一文。

要导入的头文件：

```
#import <AudioToolbox/AudioServices.h> 
```

# javascript - 如何通过 websockets 同步两个 javascript 计时器

> ID：14007976
> 
> 赞同：2
> 
> 时间：2012-12-23T01:31:39.667
> 
> 标签：javascript, node.js, audio, websocket

我有一个带有 js 视觉节拍器（如指挥）的网站，可以通过多台机器上的 websocket 触发。如何使节拍器的开始尽可能同步？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T01:47:07.967

我要做的是测量延迟，并相应地进行补偿。

对于与服务器的每个连接，服务器应定期发送 ping 消息（不是真正的 ICMP ping...只是通过已建立的 websocket 通道发送的一些消息），并测量从客户端获得响应所需的时间。将此延迟除以 2，您就可以正确猜测消息从服务器到达客户端所需的时间。

一旦知道了这一点，您就可以估计两个客户端之间的时间差异，并进行相应的调整。

请注意，这绝不是完美的。我将完全在客户端维护您的节拍器时钟，并且仅使用与服务器的通信来进行调整。这将为用户提供更流畅的性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T01:52:28.123

这是一个[时钟恢复](http://en.wikipedia.org/wiki/Clock_recovery)问题。

您将面临的问题是每个系统上的挂墙时间可能不同，此外，从长远来看，它们往往会逐渐分开。除此之外，音频字时钟也不是从墙上时间驱动的，并且会与它有自己的偏差。这意味着您没有机会获得样本或相位精度。IEEE1394 音频流和 MPEG 传输流层都通过将嵌入位精度的时间戳发送到数据流中来实现这一技巧。[显然，将以太网、网络堆栈、 Nagel](http://en.wikipedia.org/wiki/Nagle%27s_algorithm)算法和 webSockets 中的任何传输队列结合起来，您不会得到这种奢侈。

10s 到 100ms 可能更现实。

您可能想看看[网络时间协议](http://en.wikipedia.org/wiki/Network_Time_Protocol)用来解决本质上类似问题的技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-07T11:49:33.670

从所有客户端 (UTC) 获取时间。查找客户的偏移量。根据每个客户端偏移量安排开始时间。

# c# - 以最快的方式选择 2 个 bigint 值之间的记录 - 所以使用 c# 对象而不是查询数据库

> ID：14007980
> 
> 赞同：-2
> 
> 时间：2012-12-23T01:32:59.687
> 
> 标签：c#, performance, c#-4.0, select, between

好吧，我有一个包含 2`bigint`列的表。

例子

```
val1 3213 12312
val2 13232 32322
.
.
.

select val from table where 3232 between col1 and col2 
```

我需要使用 between 运算符来选择单行数据。

现在我尝试`dataview`了，但失败了。Dataview 不支持`between`运营商。

像这样

```
dwIpAddress.RowFilter = string.Format("{0} between CodeVal_1 and CodeVal_2", irParameter); 
```

那么我可以使用哪种方法？

大约有 200000 条数据记录。

**试过这个，它超级慢**

```
 dwIpAddress.RowFilter = string.Format("CodeVal_1>= {0} and CodeVal_2<={0}", irParameter); 
```

C# 4.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T01:42:10.073

你有没有尝试过

```
 dwIpAddress.RowFilter = string.Format("CodeVal_1 <= {0} and {0} <= CodeVal_2", irParameter); 
```

此外，由于您提到您使用的是 C# 4.0，因此您可以使用实体框架来代替 DataView。你可能想要调查的东西。

此外，如果您的 DataView 包含数据库表中的所有记录，那么您可能需要调整您的查询，以便它只从数据库中获取它需要的行，而不是返回所有行然后在 C# 中过滤（如果这是你在做）

# objective-c - 以顶部中心为锚点缩放 UIView？

> ID：14007983
> 
> 赞同：21
> 
> 时间：2012-12-23T01:33:27.440
> 
> 标签：objective-c, uiview, calayer

我正在使用 CGAffineTransformMakeScale 缩放 UIView，但我想在缩放时将其固定在当前的顶部中心点。

我已经研究过设置`view.layer.anchorPoint`，但我相信我需要将它与设置结合使用`view.layer.position`来解释锚点的变化。

如果有人能指出我正确的方向，我将不胜感激！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-12-23T04:59:54.133

在此处查看我的答案，以了解更改锚点时视图为何会移动：[https ://stackoverflow.com/a/12208587/77567](https://stackoverflow.com/a/12208587/77567)

因此，从您的视图转换设置为身份开始。当视图未转换时，找到其上边缘的中心：

```
CGRect frame = view.frame;
CGPoint topCenter = CGPointMake(CGRectGetMidX(frame), CGRectGetMinY(frame)); 
```

然后锚点指向上边缘的中间：

```
view.layer.anchorPoint = CGPointMake(0.5, 0); 
```

现在图层`position`（或视图`center`）是图层顶部边缘的中心位置。如果您在此处停止，图层将移动，使其顶部边缘的中心位于更改锚点之前的真实中心位置。`position`因此，从刚才开始将图层更改为其顶部边缘的中心：

```
view.layer.position = topCenter; 
```

现在图层保持在屏幕上的相同位置，但其锚点位于其顶部边缘的中心，因此缩放和旋转将使该点保持不变。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2018-03-29T12:36:06.943

# 通过使用扩展

使用特定锚点缩放 UIView，同时避免错位：

```
extension UIView {
    func applyTransform(withScale scale: CGFloat, anchorPoint: CGPoint) {
        layer.anchorPoint = anchorPoint
        let scale = scale != 0 ? scale : CGFloat.leastNonzeroMagnitude
        let xPadding = 1/scale * (anchorPoint.x - 0.5)*bounds.width
        let yPadding = 1/scale * (anchorPoint.y - 0.5)*bounds.height
        transform = CGAffineTransform(scaleX: scale, y: scale).translatedBy(x: xPadding, y: yPadding)
    }
} 
```

因此，要将视图缩小到其大小的一半，并将其顶部中心作为锚点：

```
view.applyTransform(withScale: 0.5, anchorPoint: CGPoint(x: 0.5, y: 0)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-28T18:43:52.013

这是一个老问题，但我遇到了同样的问题，花了很多时间来达到预期的行为，扩大了@Rob Mayoff 的答案（感谢他的解释，我找到了解决方案）。我必须从用户触摸的点显示浮动视图缩放。根据屏幕坐标，它可以向下、向右、向左、向上或从中心缩放。

首先要做的是在触摸点中**设置浮动视图的中心**（它必须是中心，因为 Rob 解释）：

```
-(void)onTouchInView:(CGPoint)theTouchPosition
{
self.floatingView.center = theTouchPosition;
....
} 
```

下一个问题是设置**layer 的锚点**，这取决于我们想要做什么（我测量了相对于屏幕框架的点，并确定了缩放它的位置）：

```
switch (desiredScallingDirection) {
    case kScaleFromCenter:
    {
        //SCALE FROM THE CENTER, SO
        //SET ANCHOR POINT IN THE VIEW'S CENTER
        self.floatingView.layer.anchorPoint=CGPointMake(.5, .5);
    }
        break;
    case kScaleFromLeft:
        //SCALE FROM THE LEFT, SO
        //SET ANCHOR POINT IN THE VIEW'S LEFT-CENTER
        self.floatingView.layer.anchorPoint=CGPointMake(0, .5);
        break;
    case kScaleFromBottom:
        //SCALE FROM BOTTOM, SO
        //SET ANCHOR POINT IN THE VIEW'S CENTER-BOTTOM
        self.floatingView.layer.anchorPoint=CGPointMake(.5, 1);
        break;
    case kScaleFromRight:
        //SCALE FROM THE RIGHT, SO
        //SET ANCHOR POINT IN THE VIEW'S RIGHT-CENTER
        self.floatingView.layer.anchorPoint=CGPointMake(1, .5);
        break;
    case kScallingFromTop:
        //SCALE FROM TOP, SO
        //SET ANCHOR POINT IN THE VIEW'S CENTER-TOP
        self.floatingView.layer.anchorPoint=CGPointMake(.5, 0);
        break;
    default:
        break;

} 
```

现在，一切都很容易。根据您要赋予动画的效果（这个想法是从 0 到 100% 的弹跳缩放）：

```
//SETUP INITIAL SCALING TO (ALMOST) 0%
CGAffineTransform t=CGAffineTransformIdentity;
t=CGAffineTransformScale(t, .001, .001);
self.floatingView.transform=t;
[UIView animateWithDuration:.2
                      delay:0
                    options:UIViewAnimationOptionCurveEaseInOut
                 animations:^{
                     //BOUNCE A LITLE UP!
                     CGAffineTransform t = CGAffineTransformMakeScale(1.1,1.1);
                     self.floatingView.transform=t;
                 } completion:^(BOOL finished) {
                     [UIView animateWithDuration:.1
                                      animations:^{
                                          //JUST A LITTLE DOWN
                                          CGAffineTransform t = CGAffineTransformMakeScale(.9,.9);
                                          self.floatingView.transform = t;
                                      } completion:^(BOOL finished) {
                                          [UIView animateWithDuration:.05
                                                           animations:^{
                                                               //AND ALL SET
                                                               self.floatingView.transform  = CGAffineTransformIdentity;
                                                           }
                                           completion:^(BOOL finished) {
                                               //ALL SET
                                           }];
                     }];
                 }]; 
```

就是这样。如您所见，主要是**正确设置视图的位置和锚点。**那么，一切都是小菜一碟！问候，让代码与您同在！

# php - include() 是否使用 file_exists() 的缓存？

> ID：14007985
> 
> 赞同：6
> 
> 时间：2012-12-23T01:34:22.807
> 
> 标签：php, caching, file-exists

问题很简单：当涉及到触摸磁盘时，这两个示例是否相等，或者场景#2 是否两次触摸磁盘？

### 情景#1

```
include '/path/to/file.php'; 
```

### 情景#2

```
if (file_exists('/path/to/file.php'))
    include '/path/to/file.php'; 
```

我知道场景#1 触及磁盘一次。现在，据我了解，它会`file_exists()`缓存路径以及文件是否存在。为了清除该缓存，您需要调用`clearstatcache()`.

但是`include`，等人，是否也使用该缓存？还是专属于`file_exists()`?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T01:43:05.887

只需要提醒一点：`include`使用包含路径。`file_exists`没有。除此之外，您显然是在寻找问题而不是解决方案（这一定没有错，只是说，我的答案可能无法满足您的要求，仅涵盖一个片段）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-23T01:41:23.567

这两个例子都接触了磁盘两次——读取目录然后读取文件。在第一个示例中，这两者都发生在一个命令期间，第二个命令将它们拆分。include() 不太可能再次读取目录，因为您的操作系统应该包含某种 HD 缓存，至少应该持续这么长时间。

但是您显然是在尝试过度优化某些东西。除非您在脚本中执行 > 100 次，否则您的两个选项之间不会有任何性能差异。

# jquery - 如何为包含所选文本的 li 赋予 ID？

> ID：14007991
> 
> 赞同：-1
> 
> 时间：2012-12-23T01:37:34.150
> 
> 标签：jquery

我有这个 ol 列表

```
<ol><li class="first"><a href="/ivory/node/183">Sour Candy Spray 8.5ml (3 flavors)</a></li>
<li><a href="/ivory/node/181">Chap Ice Mini Stick 3g (Cherry)</a></li>
<li><a href="/ivory/node/180">Chap Ice Mini Stick 3g (Kiwi)</a></li>
<li><a href="/ivory/node/179">Chap Ice Mini Stick 3g (Orange)</a></li>
<li><a class="active" href="/ivory/node/166">Chap Ice Beeswax</a></li>
<li><a href="/ivory/node/165">Chap Ice Cherry Stick</a></li>
<li><a href="/ivory/node/170">Chap Ice Crazy Flavors 4.2g (Blueraspberry)</a></li>
<li><a href="/ivory/node/169">Chap Ice Crazy Flavors 4.2g (Watermelon)</a></li>
<li><a href="/ivory/node/168">Chap Ice Crazy Flavors Verry Berry 4.2g</a></li>
<li><a href="/ivory/node/167">Chap Ice Moisture 4.2g Stick</a></li>
<li><a href="/ivory/node/164">Chap Ice Original 4.2g Stick</a></li>
<li class="last"><a href="/ivory/node/163">ChapIce 10G Petrolium Jelly Squeeze Tube</a></li>
</ol> 
```

如何找到包含“Chap Ice Cherry Stick”的li，并给它一个唯一的ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T01:39:17.537

尝试这个，

```
$('li a:contains("Chap Ice Cherry Stick")').parent().attr('id', youruniqueID) 
```

如果您期望出现多个元素

```
$('li a:contains("Chap Ice Cherry Stick")').each(function(index, elem){
   $(this).parent().attr('id', "chap" + index);
}) 
```

# ios - 呈现模态视图控制器时，核心动画层表现得很奇怪。CATransform3D 问题

> ID：14007996
> 
> 赞同：2
> 
> 时间：2012-12-23T01:39:03.710
> 
> 标签：ios, cocoa-touch, core-animation, modalviewcontroller, catransform3d

我正在尝试创建自定义 UIView 过渡。基本上，当呈现某个模态视图时，它所覆盖的视图会移动到背景中。

为了实现这一点，我使用 Core 动画来操作视图层上的 CATransform3D，我将移至背景，然后在其上呈现模态视图。

要将视图移动到背景中，我正在创建一个 CABasicAnimation 来为 CATransform3D 中的变化设置动画，如下所示

```
CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"transform"];

CATransform3D toTransform = CATransform3DIdentity;
toTransform.m34 = 1.0f / -500.0f;
toTransform = CATransform3DTranslate(toTransform, 0.0f, 0.0f, -40.0f);

[animation setFromValue:[NSValue valueWithCATransform3D:CATransform3DIdentity]];
[animation setToValue:[NSValue valueWithCATransform3D:toTransform]];
[animation setDuration:1.0f];

self.menuView.layer.transform = toTransform;
[self.menuView.layer addAnimation:animation forKey:@"moveBackAnimation]; 
```

self.menuView 是我要向后移动的视图。

在我添加模态视图之前，这很好用。

```
RVLAddViewController *addViewController = [[RVLAddViewController alloc] initWithNibName:@"RVLAddViewController" bundle:nil];
[self presentViewController:addViewController animated:YES completion:nil]; 
```

当按下按钮时，我在动画下方调用此代码。如果未显示此代码，则每件事情都按预期工作，视图看起来就像它只是淡入远处然后它停留在那里。

当模态视图出现时，它不会逐渐消失在远处，而是向下射击到较小的尺寸并移动到左上角。

我会尽快上传一个示例应用程序，github 现在已经关闭。**编辑**不需要 - 已经给出了解决方案！**/编辑**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T05:58:48.720

我搞砸了一段时间，看起来它与自动布局有关。如果你把它关掉，它会像你期望的那样工作。