# StackOverflow 问答 13983000-13983999

# java - mysql数据库问题中的重复行

> ID：13983002
> 
> 赞同：-1
> 
> 时间：2012-12-21T01:17:36.593
> 
> 标签：java, mysql, database

我已经在 SO 上检查了类似的答案，大多数情况下他们建议使用结果集来检查数据库中是否已经存在该条目。不知道我在这里做错了什么

```
 public void setMonitorData(String name, monitorData data){
    Statement stmt = null;
    PreparedStatement stmtInsert;
    PreparedStatement stmtUpdate;
    ResultSet rs = null;
    for(int i = 0; i<data.wiredVector.size(); i++){
        if(data.wiredVector.elementAt(i).getInterfaceName().equals(name)){

            try{
                String checkRecord = "SELECT * FROM list_A WHERE NAME = '" + name + "'";
                stmt = conn.createStatement();
                rs = stmt.executeQuery(checkRecord);

                if(!rs.next()){  
                    String insertData = "INSERT INTO list_A (NAME, mac_add, ip_add,  default_gateway,"
                            + " net_add, mask, broad_add, max_transfer_rate, curr_transfer_rate,"
                            + " curr_used_bandwidth, packet_error_rate )"
                            + "VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";

                 //preparedStatemend code here....

         else{
              String update = "UPDATE list_A SET ..."       

         .....
         } 
```

在我执行代码之后..在数据库中有重复的记录，好像它完全跳过了条件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T12:01:15.903

这里你取“if(!rs.next())”会移动到过去的记录。所以在这里它将从一行开始，这就是它允许重复值的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T01:29:13.273

如果 mac_add 在您的表中有唯一索引或者它是主键，您可以使用 INSERT.. ON DUPLICATE KEY UPDATE。

[http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T04:38:09.553

你的问题在这里

```
if(!rs.next()) 
```

**javadocs :: ResultSet.next() 返回：** 如果新的当前行有效，则为 true；如果没有更多行，则为 false

将其更改为

```
 if(rs.next()) 
```

# node.js - 关于事件循环线程？

> ID：13983003
> 
> 赞同：0
> 
> 时间：2012-12-21T01:17:44.427
> 
> 标签：node.js

我知道node.js程序中只能运行1个线程。

如果这个线程被阻塞了，例如，等待键盘输入，它还能响应其他事件吗？

是否有后台事件循环线程来分发事件处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:25:24.207

> 如果这个线程被阻塞，它还能响应其他事件吗？

它不能立即响应，但希望当你最终完成你的块时，这些事件会排队等待处理。

> 是否有后台事件循环线程来分发事件处理？

没有后台线程。事件也由“主”（唯一）线程处理。

规则是永远不要在 node.js中*阻塞。*如果某些事情需要时间，您必须通过异步回调处理它。如果要同时执行 CPU 密集型操作，则必须使用多个进程（并在异步回调中接收结果）。

所有这一切的好处是您不必担心同步多个线程（因为只有一个）。这使编程更安全（但你必须习惯到处都有回调）。

# php - SimpleXMLIterator 性能 PHP

> ID：13983005
> 
> 赞同：0
> 
> 时间：2012-12-21T01:17:58.693
> 
> 标签：php, performance, simplexml

我有以下三个与 Amazon API 交互的函数。当我使用 parse_orders_result 函数时，它似乎需要大约 30 秒才能完成。我通过运行这个 get_orders 函数并注释掉了 parse_orders_result 发现了这一点，它在 3 秒内完成了 do while 循环的每次迭代。然而，当我运行解析的东西时，它需要我下面提到的 30 秒。如何提高此操作的性能？

GET_ORDERS 函数：

```
public function get_orders($date)
        {
        $this->throttle = amazon_throttle::list_orders_throttle();
        $this->endpoint = "mws.amazonservices.com";
        $this->url = "https://mws.amazonservices.com/Orders/$date";
        $this->action = "ListOrders";
        $this->version = '2011-01-01';
        $this->api = "/Orders/$date\n"; 
        $this->options = array( 
                                'Action' => 'ListOrders',
                                'OrderStatus.Status.1'=>'Unshipped',
                                'OrderStatus.Status.2'=>'PartiallyShipped', 
                                'OrderStatus.Status.3'=>'Shipped',
                                'OrderStatus.Status.4'=>'Canceled',//Get all unshipped, partially shipped, shipped, and canceled orders. This will update these types of orders if their status changes on Amazon
                                'LastUpdatedAfter'=> date("c", strtotime('-1 Month')) //FIXME update this to reflect our download interval later
                               );
        $this->create_signature();
        try 
            {       
            $results = $this->send_request(); //commented out for testing
            }
        catch (Exception $e)
            {
             echo $e->getMessage();
             return false;
            } 

        //$results = sql::value("SELECT api_response from dhs.dbo.api_response where id = 444");
        $xml = new SimpleXMLIterator($results); //make the iterator here so we can check for a nexttoken
        $orders = $this->parse_orders_result($xml->ListOrdersResult->Orders);
        if ($xml->ListOrdersResult->NextToken)
            {
            $next_token = (string)$xml->ListOrdersResult->NextToken;
            do 
                {
                $results = $this->get_orders_next_token($next_token);
                $xml = new SimpleXMLIterator($results);
                $returned = $this->parse_orders_result($xml->ListOrdersByNextTokenResult->Orders);
                $orders = array_merge($orders, $returned);
                if ($xml->ListOrdersByNextTokenResult->NextToken)
                    $next_token = (string) $xml->ListOrdersByNextTokenResult->NextToken;
                else
                    $next_token = null;
                }
            while($next_token);
            }
        //this stored procedure creates patient_ids for each order (if the patient doesn't already exist) and updates the orders table with with their patient_id
        sql::query('EXEC dhs.dbo.sp_create_patients');
        return $orders;
        } 
```

PARSE_ORDERS_RESULT 函数：

```
$xml->registerXPathNamespace('amz', 'https://mws.amazonservices.com/Orders/2011-01-01');
            $orders = array();

            foreach ($xml->Order as $order)
            {
                $last = null;
                $name = explode(' ', preg_replace('/[^A-z ]/', '', (string) $order->BuyerName)); //remove all special characters
                if (!isset($name[1]) || !$name[1])
                {
                    $attn_last = explode(' ', preg_replace('/[^A-z ]/', '',$order->ShippingAddress->Name)); //remove all special characters
                    $pos = count($attn_last) - 1;
                    $last = $attn_last[$pos];
                }
                $phone = preg_replace('/[^0-9]/', '', (string) $order->ShippingAddress->Phone); //remove everything that is not an int
                $phone = "(" . substr($phone, 0,3) . ")" . substr($phone,3, 3) . "-" . substr($phone, 6); //format phone number

                //order and ship status are both int values tied to information in the db
                $ship_method = array_search(strtoupper((string) $order->ShipmentServiceLevelCategory),
                        sql::two_column_array("SELECT id, description FROM dhs.dbo.shipping_method WHERE site IS NULL or site = 'AMAZON' "));
                $order_status = array_search(strtoupper((string) $order->OrderStatus),
                        sql::two_column_array("SELECT id, description FROM dhs.dbo.order_status WHERE site IS NULL or site = 'AMAZON' "));
                //you have to cast found elements as string or they are returned as SimpleXMLIterator objects and you can't get the value
                $arr = array(
                        'order_code'=> (string) $order->AmazonOrderId,
                        'shipping_method'=>$ship_method,
                        'amount'=> (string) $order->OrderTotal->Amount,
                        'purchased_on' => date('Y-m-d H:i:s', strtotime($order->PurchaseDate)),
                        'market_id' => (string) $order->MarketplaceId[0],
                        'status'=> $order_status,
                        'site'=> 'AMAZON',
                        'last_update' => date('Y-m-d H:i:s'),
                        'employee_id'=>login::$id,
                        'addr1'=> (string) $order->ShippingAddress->AddressLine1,
                        'addr2'=>(string) $order->ShippingAddress->AddressLine2,
                        'city'=>(string) $order->ShippingAddress->City,
                        'state'=>(string) $order->ShippingAddress->StateOrRegion,
                        'zip'=>(string) $order->ShippingAddress->PostalCode,
                        'attention'=>(string) $order->ShippingAddress->Name,
                        'email'=>(string) $order->BuyerEmail,
                        'phone'=>$phone,
                        'first'=>array_shift($name), //remove the 0 element, use array shift so we can glue the rest of the array together for last name
                        'last'=>(implode(' ', $name)) ? implode(' ', $name): $last,
                        'fullname'=>(string) $order->BuyerName,
                        'unshipped_items'=> (string) $order->NumberOfItemsUnshipped
                );
                foreach ($arr as $k => $v)
                    $arr[$k] = strtoupper($v);

                $id = sql::merge('dhs', 'dbo', 'orders', array('order_code', 'site'), $arr, 'id');
                $arr['order_id'] = $id;
                sql::merge('dhs', 'dbo', 'order_shipping', array('order_id'), $arr);

                $orders[] = $arr;
            }
            return $orders;
        } 
```

# 更新

不幸的是，我无法安装 XDebugger（它是公司服务器，我没有权限）。但是，我可以提供更多见解：

*   $xml->Orders 最多为 100 个订单（因此只有 100 次迭代），每个订单大约 1000 个字符
*   尽管我们每次迭代都会执行多个数据库请求（我将删除），但任何时候最多只有 150 个用户访问服务器（可能少于 70 个）
*   服务器环境：IIS 6、PHP 5.3、MSSQL Server 2008 R2、48GB RAM、16 个 2.7ghz 处理器内核（超线程复制 32 个处理器）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T19:06:34.320

这个问题肯定与我们对数据库运行的查询数量有关。我创建了一个接受多维数组的新合并语句，并从 foreach 循环中删除了不必要的查询，并将执行时间减少到 24 秒（通过 do-while 循环进行了 5 次迭代）。下面是修改后的解析命令函数：

```
private function parse_orders_result(SimpleXMLIterator $xml)
        {
            $shipping_methods = sql::two_column_array("SELECT id, description FROM dhs.dbo.shipping_method WHERE site IS NULL or site = 'AMAZON' ");
            $order_statuses = sql::two_column_array("SELECT id, description FROM dhs.dbo.order_status WHERE site IS NULL or site = 'AMAZON' ");
            $xml->registerXPathNamespace('amz', 'https://mws.amazonservices.com/Orders/2011-01-01');
            $orders = array();

            foreach ($xml->Order as $order)
            {
                $last = null;
                $name = explode(' ', preg_replace('/[^A-z ]/', '', (string) $order->BuyerName)); //remove all special characters
                if (!isset($name[1]) || !$name[1])
                {
                    $attn_last = explode(' ', preg_replace('/[^A-z ]/', '',$order->ShippingAddress->Name)); //remove all special characters
                    $pos = count($attn_last) - 1;
                    $last = $attn_last[$pos];
                }
                $phone = preg_replace('/[^0-9]/', '', (string) $order->ShippingAddress->Phone); //remove everything that is not an int
                $phone = "(" . substr($phone, 0,3) . ")" . substr($phone,3, 3) . "-" . substr($phone, 6); //format phone number

                //order and ship status are both int values tied to information in the db
                $ship_method = array_search(strtoupper((string) $order->ShipmentServiceLevelCategory), $shipping_methods);
                $order_status = array_search(strtoupper((string) $order->OrderStatus), $order_statuses);
                //you have to cast found elements as string or they are returned as SimpleXMLIterator objects and you can't get the value
                $arr = array(
                        'order_code'=> (string) $order->AmazonOrderId,
                        'shipping_method'=>$ship_method,
                        'amount'=> (string) $order->OrderTotal->Amount,
                        'purchased_on' => date('Y-m-d H:i:s', strtotime($order->PurchaseDate)),
                        'market_id' => (string) $order->MarketplaceId[0],
                        'status'=> $order_status,
                        'site'=> 'AMAZON',
                        'last_update' => date('Y-m-d H:i:s'),
                        'employee_id'=>login::$id,
                        'addr1'=> (string) $order->ShippingAddress->AddressLine1,
                        'addr2'=>(string) $order->ShippingAddress->AddressLine2,
                        'city'=>(string) $order->ShippingAddress->City,
                        'state'=>(string) $order->ShippingAddress->StateOrRegion,
                        'zip'=>(string) $order->ShippingAddress->PostalCode,
                        'attention'=>(string) $order->ShippingAddress->Name,
                        'email'=>(string) $order->BuyerEmail,
                        'phone'=>$phone,
                        'first'=>array_shift($name), //remove the 0 element, use array shift so we can glue the rest of the array together for last name
                        'last'=>(implode(' ', $name)) ? implode(' ', $name): $last,
                        'fullname'=>(string) $order->BuyerName,
                        'unshipped_items'=> (string) $order->NumberOfItemsUnshipped
                );
                foreach ($arr as $k => $v)
                    $arr[$k] = strtoupper($v);

                $orders[] = $arr;
            }
            sql::bulk_merge('dhs', 'dbo', 'orders', array('order_code', 'site'), $orders, 'id');
            sql::bulk_merge('dhs', 'dbo', 'order_shipping', array('order_code', 'site'), $orders);
            return $orders;
        } 
```

# macos - 在 OSX 上开始使用 ServiceStack

> ID：13983006
> 
> 赞同：2
> 
> 时间：2012-12-21T01:18:04.367
> 
> 标签：macos, monodevelop, servicestack

我在我的 Mac 上克隆了这个示例，并且一开始就有几个项目无法构建。专门尝试构建 MovieRest 示例我收到错误：

错误 CS0584：内部编译器错误：无法导入类型`ServiceStack.OrmLite.Sqlite.SqliteOrmLiteDialectProvider' from`ServiceStack.OrmLite.SqliteNET，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null' (CS0584) (ServiceStack.MovieRest)

我找不到任何关于在 Mac 上开始使用 ServiceStack 的帮助或示例，我觉得这很奇怪，因为它们在他们的概述演示中使用 MonoDevelop 非常困难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T04:41:08.150

示例项目已升级为引用 NuGet 包，但 MovieRest 项目未引用[ServiceStack.OrmLite.Sqlite.Mono](https://nuget.org/packages/ServiceStack.OrmLite.Sqlite.Mono) NuGet 包（因此它们不同步）。我刚刚完成了这项工作，现在已经签入了。

由于我在这里使用 VS.NET 2012 进行了此操作，因此 VS.NET 解决方案文件也已升级，因此您需要在其 Beta 通道上打开最新的 MonoDevelop (3.1.1)。

注意：所有示例项目都是**在 VS.NET 中开发的，**但在托管在 Hetzner Ubuntu vServer 的 servicestack.net 上时**部署在 Mono/Linux 上。**我们并不关心在 MonoDevelop 中进行开发，而是关心在 Linux/Mono 主机上运行基于 ServiceStack 的软件。理想情况下，它应该两者兼得，但由于我们主要在 VS.NET 中进行开发，因此我们不会经常针对 MonoDevelop 进行测试。

### Windows 上的 Sqlite 与 Mono + Linux / OSX

Sqlite 是一个非托管的本机 C 库，与 .NET 的其余部分不同，它不能在多个平台上运行相同的二进制文件。

在 Windows 上使用 .NET 时，用于 Windows/.NET 的包`ServiceStack.OrmLite.Sqlite`引用`Mono.Data.Sqlite.dll`将使用非托管文件夹（这就是为什么 sqlite.dll 需要设置为设置为“如果更新则复制”的内容资源的原因）。对于 Linux，它会查找**sqlite3.so**，而在 OSX 上，它会在您的库查找路径中查找**libsqlite3.dylib 。**如果您在主机操作系统中安装了 Sqlite，它会自动找到这些，如果没有，您需要在环境变量中包含这些共享库的路径。`sqlite3.dll``bin/`****`LD_LIBRARY_PATH`****

# asp.net-mvc - ASP.NET MVC4 ViewModel 和 knockoutJS ViewModel 重复

> ID：13983011
> 
> 赞同：1
> 
> 时间：2012-12-21T01:18:51.060
> 
> 标签：asp.net-mvc, knockout.js

我有一个带有模型（实体）DLL 项目的 MVC4 应用程序，该项目用于 BusinessLogic 和 DataAccess 层。MVC 控制器使用一些映射器扩展方法将视图模型（绑定到视图）转换为模型，并将模型对象传递给业务逻辑层。

我的问题是：如果我需要一些像 KnockoutJS 这样的客户端功能，那么创建一组 KnockoutJS ViewModel 是一种好习惯吗？我担心 ViewModel 的可维护性和频繁更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:33:57.553

我会说不，knockoutJS 是一个*客户端*库，因此不应该真正规定您的服务器如何发送数据。只要您的视图模型包含渲染所需的所有相关信息，这就是您所需要的。客户端如何处理与服务器完全无关。

通过创建 knockoutJS 特定的视图模型，您实际上将服务器响应耦合到您的客户端，这不是一个好主意 - 如果您更改为不同的客户端怎么办？如果你想支持多个客户端怎么办？

我建议创建一个特定于 KnockoutJS 的视图模型的客户端表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T01:25:44.047

我建议您创建特定于 KnockoutJS（或任何其他客户端使用）的 ViewModel。

我觉得在您的站点中使用的 ViewModels，在服务器端，应该能够轻松更改，因为站点既创建它们又使用它们。此外，您有编译器可以让您知道是否有错误。

然而，我觉得当我们将这些模型暴露给客户时，它们更像是一份不应该改变的合同，或者至少不应该经常改变。

# drupal - drupal 7网站太慢了

> ID：13983012
> 
> 赞同：0
> 
> 时间：2012-12-21T01:19:29.890
> 
> 标签：drupal, drupal-7

我刚开始在我的电脑上练习 drupal 7，但速度非常慢。

每当我尝试启用扩展模块时，进程都会超时，这意味着它超过了 30 秒的限制。所以我再次尝试（并在进一步超时时再次尝试），直到成功启用。但是模块下载和安装速度很好，这实际上是我的 drupal 7 上唯一没有任何速度问题的操作。

当我点击任何页面的链接时，打开该页面大约需要 20 秒（最多），有时超过 30 秒。我不认为这是正常的。我在我的计算机上创建了两个具有相同行为的 drupal 测试站点。我尝试了所有浏览器（IE、chrome、opera、firefox 和 safari），但没有任何改进。我在我的电脑上使用 windows vista。

可能是什么问题呢？

编辑：我刚刚解决了超时问题。有人可以告诉我在 drupal 7 上打开链接的正常平均时间是多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T11:36:30.347

尝试增加 php 内存限制。Drupal 7 没有使用过多的资源，应该可以在中低端服务器上运行。我建议使用 128Mb 的内存。

参考：[http ://drupal.org/requirements](http://drupal.org/requirements)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T10:08:53.840

模块安装操作通常需要超过 30 秒，您必须在 php.ini 中添加一些秒到变量**max_execution_time**。30 秒是默认值，因此您可以将其更改为 120（2 分钟）或 180（3 分钟）。 **max_execution_time = 180**可以解决您的问题。

# c# - 如何实例化 Web.Webpages.Html.HtmlHelper？

> ID：13983015
> 
> 赞同：1
> 
> 时间：2012-12-21T01:20:16.570
> 
> 标签：c#, asp.net-mvc-3, razor, html-helper

在 asp.net mvc 3 中，默认的 html 帮助程序来自`System.Web.Mvc.Html`. 我想使用来自`System.Web.WebPages.Html`. 尽我所能，我似乎无法获得实例或访问`System.Web.WebPages.Html`. 这是我尝试过的：

我在剃刀内联中尝试了所有这些，因为我认为它不会那么复杂（哈）。

这是版本

```
<add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

**使用新的**

首先，我尝试简单地实例化它：

```
@{ var h = new System.Web.WebPages.Html.HtmlHelper(); } 
```

在我运行它并得到这个之前，这似乎有效：

```
Compiler Error Message: CS0143: 
The type 'System.Web.WebPages.Html.HtmlHelper' has no constructors defined 
```

**使用反射**

所以我认为它是一个抽象类并试图继承它。不，它是一个实际的类，只是带有一个私有构造函数。所以我试图反映它

```
@using System.Reflection
@{
 BindingFlags flags = BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Public;
 System.Globalization.CultureInfo ci = null;
 var instance = (System.Web.WebPages.Html.HtmlHelper)Activator.CreateInstance(
    typeof(System.Web.WebPages.Html.HtmlHelper), 
    flags,
    null, 
    new object[] { ViewData.ModelState },
    ci
    );
} 
```

导致此错误：

```
Exception Details: System.MissingMethodException: 
Constructor on type 'System.Web.WebPages.Html.HtmlHelper' not found. 
```

**希望直接访问**

然后我试图寻找一个活动版本：

```
var h = System.Web.WebPages.HelperPage.Html; 
```

导致此错误（h 为空）

```
Object reference not set to an instance of an object. 
```

我尝试了这些的其他版本，但也没有成功，并且对如何获取此类的实例感到茫然。我可以访问，`@Html`但正如我所说，这不`HtmlHelper`适合这种情况。

我怎样才能得到一个实例`System.Web.WebPages.Html`？？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-12-21T02:10:37.910

System.Web.WebPages.Html 是命名空间而不是类，您不能实例化命名空间。

[http://msdn.microsoft.com/en-us/library/system.web.webpages.html(v=vs.111).aspx](http://msdn.microsoft.com/en-us/library/system.web.webpages.html(v=vs.111).aspx)

我想你想要 System.Web.WebPages.Html.HtmlHelper

# javascript - 给定一个 Rails 时间戳，我如何使用 JavaScript 来确定时间戳是多少天？

> ID：13983030
> 
> 赞同：1
> 
> 时间：2012-12-21T01:22:08.113
> 
> 标签：javascript

Rails 提供如下时间戳：2012-12-21T01:09:32Z

如何使用 JavaScript 确定时间戳的天数？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:27:13.773

您可以使用`new Date('2012-12-21T01:09:32Z')`将字符串转换为 Date 对象。然后使用简单的算术：

```
var dateStr = '2012-12-21T01:09:32Z',
daysAgo = (new Date() - new Date(dateStr)) / 86400 / 1000;

if (daysAgo > 7) {
    // more than 7 days ago
} 
```

根据您的情况，您可能希望使用`Math.floor(daysAgo)`或`Math.ceil(daysAgo)`向下或向上舍入结果。

# facebook - Facebook Graph API 限制 - 每个令牌和每个 IP？

> ID：13983033
> 
> 赞同：8
> 
> 时间：2012-12-21T01:22:26.867
> 
> 标签：facebook

所以我正在使用 Facebook Graph API。该文档指定速率限制为每 600 秒、每个令牌和每个 IP 600 次调用。我不明白这意味着什么，所以请告诉我这些示例是否会通过有效的速率限制：

**示例 1：** 我有 2 个访问令牌（用于 2 个用户）。我从 1 个 IP 地址拨打电话。我可以在 600 秒内进行 1200 次调用，每个访问令牌调用 600 次吗？

**示例 2：** 我有 1 个访问令牌，我从 2 个 IP 地址（每个 IP 地址 600 个）呼叫，我可以在 600 秒内总共拨打 1200 个电话吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-02T08:40:07.700

我检查了 Facebook 的速率限制，发现这两个例子都是正确的。Facebook 使用（令牌，IP 地址）对作为唯一标识符。您可以使用每个 1 个 IP 地址的 2 个访问令牌和来自 2 个 IP 地址的 1 个访问令牌。在这两种情况下，您总共可以拨打 1200 次电话，没有任何问题。

速率限制不取决于访问令牌类型（应用程序访问令牌、页面访问令牌等），也不考虑获得此访问令牌的人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-29T04:23:27.197

这一切都取决于你达到什么样的限制。如果它是“达到用户请求限制”，那么使用不同的访问令牌就足够了。但是，还有一个全局应用程序级别的 API 限制（据我所知）没有考虑您的 DAU 数量。

一旦您点击“达到应用程序请求限制”，该应用程序生成的所有用户令牌都会在此期间停止工作，甚至 OAuth 登录也会停止工作（！！！）。

# git - 在推送通知邮件中添加 git diff

> ID：13983037
> 
> 赞同：3
> 
> 时间：2012-12-21T01:23:13.817
> 
> 标签：git, push-notification, gitolite, git-diff, git-post-receive

目前我正在使用 gitolite 来管理我的存储库和用户。每次推送后我都成功设置了通知邮件。命令是

```
chmod a+x post-receive-email
cd /path/to/your/repository.git
ln -sf /usr/share/doc/git-core/contrib/hooks/post-receive-email hooks/post-receive 
```

通知邮件仅包含更改摘要。我想在该推送中添加每个修改文件的更改行。我知道编辑该 post-receive-email 文件并且必须使用 git-diff 命令。我的问题是

我必须使用的确切 git-diff 命令是什么..？我在那个 post-receive-email 文件中添加了该命令..？gitolite 中是否有可用的配置..？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-25T07:29:09.810

2021 年更新：现在完全通过[**`github.com/git-multimail/git-multimail`**](https://github.com/git-multimail/git-multimail)

使用 Git 2.33（2021 年第三季度），从og git 本身中**删除了多邮件：**`contrib/`

请参阅[Johannes Schindelin ( ) 的](https://github.com/dscho)[提交 f74d114](https://github.com/git/git/commit/f74d11471fa8870d4bcbe7dbff2f3ddac6783e7f)（2021 年 6 月 10 日[）](https://github.com/dscho)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 7e24201](https://github.com/git/git/commit/7e242013652525e6d8e0ee73bfb85ecaeab700ea))^(中，2021 年 7 月 8 日）)[`dscho`](https://github.com/dscho)
^([`gitster`](https://github.com/gitster))

> ## [`multimail`](https://github.com/git/git/commit/f74d11471fa8870d4bcbe7dbff2f3ddac6783e7f): 停止运送副本
> 
> ^(签字人：约翰内斯·辛德林)

> multimail项目是独立开发的，有自己的项目页面。
> 传统上，我们以`contrib/`.
> 
> 但是，这样的副本很容易变得陈旧，而将用户定向到实际项目会更好。

因此，`contrib/hooks/multimail`我在下面 2013 年提到的 git 2.33+（2021 年第三季度，8 年后）不再存在。

* * *

注意：您可能对新的 git-multimail 脚本感兴趣，它将包含在 git1.8.4（2013 年 7 月）中

请参阅[提交 bc501f69fc6d697968d472afbabe6af97a758b12](https://github.com/git/git/commit/bc501f69fc6d697968d472afbabe6af97a758b12)：

## `git-multimail`: 改进后接收电子邮件的替代品

> Add `git-multimail`，一个用于生成推送到 Git 存储库的通知电子邮件的工具。
> 它在很大程度上与 插件兼容`post-receive-email`，并建议最终替换该脚本。relative to
> 的优点在中描述。`git-multimail``post-receive-email`[`README.migrate-from-post-receive-email`](https://raw.github.com/mhagger/git-multimail/master/git-multimail/README.migrate-from-post-receive-email)

> `git-multimail`被组织在一个目录`contrib/hooks/multimail`中。

查看其维护的独立[GitHub 项目](https://github.com/mhagger/git-multimail)（即使该项目将在`contrib/hooks/multimail`启动 git1.8.4 时集成）

你补充说：

```
echo ""
echo "Line of changes:"
git diff --diff-filter=M --find-copies-harder --no-prefix --unified=2 $oldrev..$newrev 
```

You would add it in the [`git_multimail.py`](https://github.com/mhagger/git-multimail/blob/master/git-multimail/git_multimail.py#L1012-L1027) python script, just after the `diff-tree`.
Plus, you can fork the [GitHub project](https://github.com/mhagger/git-multimail), and propose a **`multimailhook.diffFilterOpts`** new option, for your `diff --diff-filter` addition.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T05:47:59.603

根据[githooks(5)](http://www.kernel.org/pub/software/scm/git/docs/githooks.html)，您可以编写一个`post-receive`脚本来获取标准输入的每一行（也就是受影响的分支），`log`第一个和第二个字段（`cut -d' ' -f1`, `cut -d' ' -f2`）之间的每个提交，以及`git show`每个提交。

将所有这些信息存储在一个变量中，然后邮寄——然后你就完成了。

我认为您可以首先将您的`post-receive-email`钩子复制到您的钩子目录中（而不是链接它），然后修改它以获得新的电子邮件正文。

如果您发布当前的钩子脚本，告诉您如何修改它可能会更容易。

# jquery - 使用 jquery 创建一个 asp.net 服务器控件

> ID：13983038
> 
> 赞同：1
> 
> 时间：2012-12-21T01:23:18.527
> 
> 标签：jquery, asp.net

在发布这个问题之前我已经完成了我的研究，我找不到任何有用的东西。我不知道是否可以在 jquery 的帮助下创建 asp.net 服务器控件。我有一个在服务器上运行的上传控制输入，并且我使用了一个 javascript 代码来创建一个新的上传控制输入，只要单击一个特定的按钮。但是我需要创建一个新的**RegularExpressionValidator**来控制每个新的上传控件。这可以实现，而不是在我的页面上使用多个上传控件和**RegularExpressionValidator 。**仔细检查我到目前为止所做的代码。

```
function addFileUploadBox() {
if (!document.getElementById || !document.createElement)
    return false;

var uploadArea = document.getElementById("upload-area");
var count = uploadArea.getElementsByTagName("input").length;

    if (!uploadArea)
        return;

    var newLine = document.createElement("br");
    uploadArea.appendChild(newLine);

    var newUploadBox = document.createElement("input");

    // Set up the new input for file uploads
    newUploadBox.type = "file";
    newUploadBox.size = "20";

    // The new box needs a name and an ID
    if (!addFileUploadBox.lastAssignedId)
        addFileUploadBox.lastAssignedId = 100;

    newUploadBox.setAttribute("id", "dynamic" + addFileUploadBox.lastAssignedId);
    newUploadBox.setAttribute("name", "dynamic:" + addFileUploadBox.lastAssignedId);
    newUploadBox.setAttribute("runat", "server");
    uploadArea.appendChild(newUploadBox);
    $("<asp:RegularExpressionValidator ID='regular" + addFileUploadBox.lastAssignedId + "' ValidationExpression='(.*?)\.(jpg|jpeg|png|gif|JPG)$' runat='server' ErrorMessage='Invalid file' ControlToValidate='dynamic" + addFileUploadBox.lastAssignedId + "' ForeColor='Red'></asp:RegularExpressionValidator>").insertAfter("#dynamic" + addFileUploadBox.lastAssignedId);
    addFileUploadBox.lastAssignedId++;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T01:28:09.653

这是不可能的。

原因：Asp.net 将其从 xhtml 转换为它的输出服务器端。

Anything you have done via jquery or javascript will be done client-side. The server knows nothing about validator that you have just attempted to create.

# python-3.x - Pyro4 将 python2 连接到 python3

> ID：13983045
> 
> 赞同：2
> 
> 时间：2012-12-21T01:24:06.437
> 
> 标签：python-3.x, python-2.7, pyro

我有以下设置：在 python2.7 下运行的 Pyro 名称服务器，在 python2.7 下运行的 Pyro 守护程序，以及（理想情况下）运行 python3.3 的 Pyro 客户端。

如果我使用在 python2.7 下运行的客户端连接到服务器，一切正常。当为客户端使用 python3.3 时，我可以很好地创建代理连接，但我得到：

```
Traceback (most recent call last):                                                                                                                     
  File "<stdin>", line 1, in <module>                                                                                                                  
  File "/project_path/lib/python3.3/site-packages/Pyro4/core.py", line 149, 
    return self.__send(self.__name, args, kwargs)                                                                                                      
  File "/project_path/lib/python3.3/site-packages/Pyro4/core.py", line 271, 
    self.__pyroCreateConnection()                                                                                                                      
  File "/project_path/lib/python3.3/site-packages/Pyro4/core.py", line 322, 
    uri=resolve(self._pyroUri)                                                                                                                         
  File "/project_path/lib/python3.3/site-packages/Pyro4/naming.py", line 336
    nameserver=locateNS(uri.host, uri.port)                                                                                                            
  File "/project_path/lib/python3.3/site-packages/Pyro4/naming.py", line 274
    proxy.ping()                                                                                                                                       
  File "/project_path/lib/python3.3/site-packages/Pyro4/core.py", line 149, 
    return self.__send(self.__name, args, kwargs)                                                                                                      
  File "/project_path/lib/python3.3/site-packages/Pyro4/core.py", line 290, 
    data=self._pyroSerializer.deserialize(data, compressed=flags & MessageFactory.FLAGS_COMPRESSED)                    
  File "/project_path/lib/python3.3/site-packages/Pyro4/util.py", line 146, 
    return self.pickle.loads(data)                                                                                                                     
ImportError: No module named 'exceptions' 
```

尝试使用任何远程方法时。pyro 文档似乎暗示我应该能够将 python2.7 实例与 python3.3 互连，不是这样吗？

python 的 2.7 和 3.3 实例都使用 Pyro4 版本 4.16

**编辑：**这是一些对我不起作用的实际代码：

（用一个python2 ns 启动）

在 python2.7 virtualenv 中：

```
import Pyro4

class TestProxy(object):       

    def foo(self):             
        return "bar"           

if __name__ == "__main__":     

    print "* Starting test proxy"   
    daemon=Pyro4.Daemon()
    tproxy_uri=daemon.register(TestProxy())
    ns=Pyro4.locateNS()
    ns.register("foo",tproxy_uri)   

    print "* Proxy started"
    daemon.requestLoop() 
```

在 python3.3 virtualenv 中：

```
import Pyro4

rtest = Pyro4.Proxy("PYRONAME:foo")
print(rtest.foo()) 
```

我得到了我上面提到的那个确切的例外。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T19:22:48.347

原因是泡菜。它是用于通过网络交换对象的“协议”。这就是为什么你不能传递类，而只能传递对象等等。py3 的 Pickle 有重大变化，但 2.7 与 2.6 没有。因此，理论上，pyro 将在 2.6 > 2.7 之间工作，但不是 2.7 > 3.3。（它有效，我有一个带有 python 2.6 的 VPS，我也被迫在我的 py2.7 上移动客户端应用程序。）可能对泡菜模块的破解可能会避免错误，但我确信这会打开一个潘多拉盒子. 唯一“真正的”替代方案是使用 python 服务器，通过 http/socket/https（不一定是 web 服务器）和发送/接收序列化字符串/命令。

PS：我看到帖子很旧！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-15T14:00:25.280

考克斯说的是对的。泡菜在 python2,3 之间是不同的。但蛇似乎是兼容的。你可以试试

PYRO_SERIALIZERS_ACCEPTED=蛇 /usr/bin/python3 -Wignore -m Pyro4.naming

# python - 如何在 PostgreSQL 中使用 SQLAlchemy 选择 FOR SHARE？

> ID：13983048
> 
> 赞同：2
> 
> 时间：2012-12-21T01:24:22.847
> 
> 标签：python, sqlalchemy, postgresql-9.1

我正在尝试 SELECT FOR SHARE 表中的一组行，以便它们被锁定直到事务结束。我正在使用 SQLAlchemy 0.7.9 在 PostgreSQL 9.1.6 数据库中执行此操作。这是有问题的python代码：

```
NUM_TERMS = 10
conn = engine.connect()
get_terms = select([search_terms.c.term_id, search_terms.c.term],
                   and_(search_terms.c.lock==False,
                   search_terms.c.status==False),
                   order_by=search_terms.c.term,
                   limit=NUM_TERMS, for_update="read")
trans = conn.begin()
try:
    search_terms = conn.execute(get_terms).fetchall()
    for term in search_terms:
        lock_terms = update(search_terms).\
                     where(search_terms.c.term_id==term.term_id).\
                     values(lock=True)
        conn.execute(lock_terms)
    if trans.commit():
        <do things with the search terms>
except:
    trans.rollback() 
```

问题是上面选择代码生成的SQL查询不是FOR SHARE，而是FOR UPDATE：

```
SELECT search_terms.term_id, search_terms.term
FROM search_terms
WHERE search_terms.lock = :lock_1 AND search_terms.status = :status_1     
ORDER BY search_terms.term
LIMIT :param_1 FOR UPDATE 
```

根据[SQLAlchemy API docs](http://docs.sqlalchemy.org/en/rel_0_7/core/expression_api.html#sqlalchemy.sql.expression.select)，在“for_update”参数描述下：

> 对于 Postgresql 方言，值“read”和“read_nowait”分别转换为 FOR SHARE 和 FOR SHARE NOWAIT。

根据上面，编译出来的SQL语句应该是FOR SHARE，其实不是。我的代码中的错误在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T04:57:44.057

无法重现：

```
from sqlalchemy import *

m = MetaData()
t = Table('t', m, Column('x', Integer))

s = select([t], for_update="read")

from sqlalchemy.dialects import postgresql
print s.compile(dialect=postgresql.dialect())

e = create_engine("postgresql://scott:tiger@localhost/test", echo=True)
with e.begin() as conn:
    m.create_all(conn)
    conn.execute(s) 
```

输出显示，无论是作为独立编译还是在 Postgresql 对话中，我们都会得到 FOR SHARE。在 0.7.9 和 0.8.0b2 中测试。如果您可以提供完整的可运行测试用例，那可能会更清楚：

```
SELECT t.x 
FROM t FOR SHARE
2012-12-20 23:53:33,670 INFO sqlalchemy.engine.base.Engine select version()
2012-12-20 23:53:33,671 INFO sqlalchemy.engine.base.Engine {}
2012-12-20 23:53:33,672 INFO sqlalchemy.engine.base.Engine select current_schema()
2012-12-20 23:53:33,672 INFO sqlalchemy.engine.base.Engine {}
2012-12-20 23:53:33,674 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2012-12-20 23:53:33,674 INFO sqlalchemy.engine.base.Engine select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where n.nspname=current_schema() and relname=%(name)s
2012-12-20 23:53:33,675 INFO sqlalchemy.engine.base.Engine {'name': u't'}
2012-12-20 23:53:33,676 INFO sqlalchemy.engine.base.Engine SELECT t.x 
FROM t FOR SHARE
2012-12-20 23:53:33,676 INFO sqlalchemy.engine.base.Engine {}
2012-12-20 23:53:33,676 INFO sqlalchemy.engine.base.Engine COMMIT 
```

# python - 可以访问原始功能的装饰器

> ID：13983050
> 
> 赞同：0
> 
> 时间：2012-12-21T01:24:38.283
> 
> 标签：python, decorator

我定义了以下装饰器：

```
def loop_callback(func):
    """Only works in programs with a single main loop. Can call .sameThread
    to access the original unwrapped function directly"""
    @wraps(func)
    def wrapped_func(*args, **varargs):
        if mainThread==threading.current_thread():
            print("We are in the loop thread")
            func(*args, **varargs)
        else:
            print("In another thread")
            loop.add_callback(lambda: func(*args, **varargs))
    wrapped_func.orig=func
    return wrapped_func 
```

这个想法是您应该能够通过调用类似`myObject.myFunction.orig(arg1, arg2)`. 不幸`orig`的是，不会收到 self 对象，只是`arg1`and `arg2`。有没有办法解决这个问题，以便可以按照我想要的方式调用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T01:33:39.780

您可能能够弄清楚如何将它硬塞到像这样的装饰器中，以便最终在您正在谈论的场景中得到您想要的绑定方法，但实际上，这可能是您学习的好机会关于[描述符协议](http://docs.python.org/2/howto/descriptor.html)。

# php - 如何调用单独的 header.php？

> ID：13983065
> 
> 赞同：3
> 
> 时间：2012-12-21T01:26:36.577
> 
> 标签：php, wordpress

老实说，我还不了解 PHP。但是我想要实现的目标在我脑海中听起来很容易。

`single.php`这是我的 wordpress文件顶部的代码：

```
<?php get_header(); ?> 
```

我创建了一个单独的标题，即`header2.php`.

我想知道我需要在`single.php`模板顶部写什么来调用`header2.php`而不是`header.php`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T01:30:49.527

如果你想要 header-2.php（而不是 header2.php），你必须调用：

```
<?php get_header('2'); ?> 
```

请参阅此页面：[http ://codex.wordpress.org/Function_Reference/get_header](http://codex.wordpress.org/Function_Reference/get_header)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T01:30:23.873

只需创建一个头文件，如

```
header-myHeader2.php 
```

并称它为

```
get_header('myHeader2'); 
```

语法是`header-name.php`，您可以使用该`name`部分调用。

[在这里阅读更多](http://codex.wordpress.org/Function_Reference/get_header)。

# python - 使用 SQL Alchemy 缓存读取、立即写入

> ID：13983067
> 
> 赞同：1
> 
> 时间：2012-12-21T01:26:54.930
> 
> 标签：python, sqlalchemy

Beaker 测试系统包括一个[中央调度程序](http://git.beaker-project.org/cgit/beaker/tree/Server/bkr/server/tools/beakerd.py?h=develop)，它根据配方中定义的各种标准将排队的配方分配给可用系统。

这是通过不断循环当前的配方队列并寻找可以处理该配方的可用系统来处理的。当这种方法查询从数据库中为每个配方检索更新的系统状态信息时，它会受到竞争条件的影响，即在队列中更靠后的任务有时会错误地在调度过程运行时可用的系统中进行第一次尝试。

例如，假设我们有 2 个系统 A 和 B，以及配方 1（需要系统 A）、2（可以在任一系统上运行）、3（也可以在任一系统上运行）。当调度通道开始时，系统 A 已经很忙，所以配方 1 没有可用的系统，我们继续查看配方 2 并将其分配给系统 B。在后台，系统 A 完成它正在做的事情并将自己标记为在数据库中可用。调度程序现在继续考虑方案 3，发现系统 A 可用并将方案 3 分配给系统 A。方案 3 已设法跳过队列并要求系统 A，即使方案 1 应该已获得它。

我正在尝试为此提出一个近期解决方案，该解决方案不涉及完全重新设计调度逻辑（尽管我们也在这方面探索一些更长期的想法）。

我目前拥有的最佳解决方案是打开一个单独的 SQL Alchemy 会话，纯粹作为调度过程开始时数据库状态的缓存，以及调度程序所做的任何系统可用性状态更改。此事务将在调度过程结束时中止。在调度过程中，所有状态更改都将照常写入数据库，但也需要写入缓存连接。

不过这看起来真的很难看，所以我想知道是否有人对如何使用 SQL Alchemy 处理这个问题有更好的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T08:35:45.123

经过一段时间的思考，我意识到核心一致性问题在于，当系统完成任务时，它实际上在数据库中被标记为空闲，即使当前有队列中的配方可以在该系统上执行。

相反，我们需要做的是确保如果有可以在该系统上执行的配方，系统会立即重新分配给队列中的第一个这样的配方，而不是被放回空闲池中。同样，如果添加新系统或将其重新置于自动化模式，那么我们会立即为其分配一些工作，而不是让它进入空闲池。

因此，主调度循环最终将仅处理将进入当前空闲系统的新配方分配的任务，而将排队的配方分配给系统将更多地是事件驱动的。

那时，管理对数据库的并发访问以确保两个系统不会开始尝试处理相同的配方，这只是一个典型的问题。

# .net - 按列表排序集合

> ID：13983069
> 
> 赞同：1
> 
> 时间：2012-12-21T01:26:56.943
> 
> 标签：.net, linq, enumerable

我有一个`Collection`。`Products`每个产品都有一个 ProductId (int) 属性。`List<int>`对于每个 ProductId，我也有一个条目。我需要`Collection<Products>`按`List<int>`. 这可能使用**LINQ**或其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T01:29:42.653

试试这个：

```
var res = orig.OrderBy(p => orderSettingList.IndexOf(p.ProductId)); 
```

请注意，其属性值不在列表中的产品将排在所有其他产品之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:05:50.790

我认为连接将是最有效的方法，因为它在内部使用字典。

```
orderSettingList.Join(orig, l => l, p => p.ProductId, (l, p) => p); 
```

# javascript - 在Javascript中声明一个回调函数

> ID：13983073
> 
> 赞同：-2
> 
> 时间：2012-12-21T01:28:18.973
> 
> 标签：javascript, function, callback

当我在家里玩一些*Javascriptz*时，我遇到了一些事情......

我做了一个简单的函数，它从字符串中返回每个字符或从数组中返回每个位置值：

```
function each (haystack, callback) {
    var each;
    for (each in haystack){
        if (callback && typeof callback == "function") {
            callback (haystack[each]);
        }
    }
} 
```

如何使用：

```
each ("StackOverflow", function (c) {
    console.log(c);
}); 
```

我想知道是否有办法将 /\ 变成这样：

```
each ("StackOverflow", c) {
    console.log(c);
} 
```

或者至少是*这样*的，任何你不需要`function`为回调重写单词的东西。

我试过这个，但没有成功：

```
each ("StackOverflow",
    "console.log(c)" // turn the callback function into a string
    // but where was `c` defined here? do.not.ask.me.
); 
```

并且`each()`是：

```
function each (haystack, callback) {
    var each;
    for (each in haystack){
        // call it in a setTimeout() crazy? yeah, didn't work...
        setTimeout(callback, 0);

        //and also tried this, no success...
        var b = new Function ("haystack[each]", cb);
        b ();
    }
} 
```

我的结论是，不幸的是，如果不声明匿名函数，我们就不能拥有回调函数。

**有没有办法在不使用工作的情况下制作回调函数** `function`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T01:35:44.470

请忘记字符串表示版本，它总是涉及`eval()`，我们知道这是邪恶的。

您不能简单地更改编程语言的语法。

无论如何，写作`function () {}`并不是什么大麻烦，您甚至可以将编辑器配置为自动插入片段。您还可以使用 CoffeeScript，它具有更简单的函数语法（当然，除了其他几个特性）并编译为 Javascript。

此外，您不必使用匿名函数。您可以传递任何类型的函数。

```
var func = function (x) { console.log(x); }; //inline function
each ("StackOverflow", func);

function func2 (x) { console.log(x); }; //classic function
each ("StackOverflow", func2);

each ("StackOverflow", alert); //YEEEES

each ("StackOverflow", 
    console.log.bind(console)); //here you should bind it to console! 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T01:37:59.467

```
for (each in haystack) 
```

如果您希望`haystack`成为一个数组，则应该使用 for 循环对其进行迭代，而不是使用 for 循环枚举键（请参阅[JavaScript for...in 与 for](https://stackoverflow.com/q/242841/1048572)的区别）。如果您迭代字符串，尤其如此，请注意旧的 IE 不支持字符串上的括号表示法。

> 如果不声明匿名函数，我们就不能有回调函数

不，对于回调函数，我们当然需要一些函数。但它不一定必须是匿名函数表达式。在您的示例中，您可以这样做

```
each ("StackOverflow", console.log);
each ("StackOverflow", console.log.bind(console)); // for Chrome users 
```

…或传递您在其他地方声明的任何其他合适的函数。

字符串（比如在[这个库](http://osteele.com/sources/javascript/functional/)中）有时可能更短，但它们需要被`eval`编辑，这对这个目的来说是邪恶的。不幸的是，EcmaScript 不支持任何更短的 lambda 表达式，但是您可能想看看[FF-only JavaScript 1.8*表达式闭包*](http://perfectionkills.com/a-closer-look-at-expression-closures/)或[CoffeeScript](http://coffeescript.org/)的极简函数语法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-21T01:39:27.620

在 ECMAScript 中创建函数有~~两种四种方式~~

1.  函数[声明](http://www.ecma-international.org/ecma-262/5.1/#sec-13)
2.  [函数](http://www.ecma-international.org/ecma-262/5.1/#sec-11.2.5)表达式
3.  [作为函数调用](http://ecma-international.org/ecma-262/5.1/#sec-15.3.1.1)的 Function 构造函数
4.  [作为构造函数调用](http://ecma-international.org/ecma-262/5.1/#sec-15.3.2.1)的 Function 构造函数

所有都需要使用字符串“function”或“Function”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-21T01:41:34.013

要`console.log`直接用作回调，您必须确保将其绑定回`console`以免它丢失正确的执行上下文，至少在 Chrome 中是这样，所以我被告知:)

```
each([1, 2, 3], console.log.bind(console)); 
```

此外，您`each()`不能安全地使用它`for ... in`：

```
for (var i = 0, n = haystack.length; i != n; ++i) {
    callback(haystack[i]);
} 
```

当向对象添加额外的属性时，差异会更加明显`Array`。

另请参阅：[为什么在数组迭代中使用“for...in”是个坏主意？](https://stackoverflow.com/questions/500504/javascript-for-in-with-arrays)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-21T01:40:40.320

简短的回答：没有。

您可以采用像[Coffeescript](http://coffeescript.org)这样的编译到 JavaScript 的语言，它对匿名函数有更短的语法：

```
//javascript version
function(c){ console.log(c) }

//coffeescript version
(c) => console.log c 
```

否则，您将不得不在某处声明该函数，无论是“就地”（匿名函数）还是代码中的其他地方作为变量。

# sql - 封闭 Select 以使用 PIVOT

> ID：13983078
> 
> 赞同：0
> 
> 时间：2012-12-21T01:29:16.197
> 
> 标签：sql, sql-server, database, sql-server-2008, sql-server-2005

我尝试了几种组合来包装最后一个选择以使用 PIVOT 及其结果

这是代码

```
 DECLARE @cols VARCHAR(1000)
DECLARE @sqlquery VARCHAR(2000)

SELECT  @cols = STUFF(( SELECT distinct  ',' + QuoteName(idIndice)
                        FROM tgpwebged.dbo.sistema_Indexacao as a FOR XML PATH('')
                        ), 1, 1, '')      

SET @sqlquery = 'WITH TempTable AS 
                ( 
                    select distinct a.id, b.idIndice, b.valor  
                    from tgpwebged.dbo.sistema_Documentos as a  
                    join tgpwebged.dbo.sistema_Indexacao as b on a.id = b.idDocumento 
                    join tgpwebged.dbo.sistema_DocType as c on a.idDocType = c.id
                    join tgpwebged.dbo.sistema_DocType_Index as d on c.id = d.docTypeId 
                    where d.docTypeId = 40      
                    and (b.idIndice = 11 AND b.valor = ''11111111'' OR b.idIndice = 12 AND b.valor = ''11111'' ) 
                ) 
                SELECT * FROM TempTable t1 
                         WHERE ((select count(*)          
                         from TempTable t2        
                         where t1.id = t2.id AND t1.valor != t2.valor) = 1)base
                PIVOT 
                (
                    Max(valor)
                    FOR [idIndice] IN (' + @cols + ')
                ) AS finalpivot' 

EXECUTE ( @sqlquery ) 
```

这当然行不通，所以我需要用括号或类似的东西来完成它吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T23:33:30.257

```
Try replace EXECUTE ( @sqlquery ) on EXEC @sqlquery 
```

[有关 EXECUTE 语句的更多信息](http://msdn.microsoft.com/en-us/library/ms188332%28v=sql.105%29.aspx)

# php - html/php调试

> ID：13983079
> 
> 赞同：3
> 
> 时间：2012-12-21T01:29:38.747
> 
> 标签：php, html, debugging, console

我正在创建一个网站，因此我正在学习如何在 html/css/php 中编程。对于我目前所学的其他语言，总是有一个 IDE 或交互式控制台，我可以直接输入代码以查看它们的工作原理、访问变量类型等，这使得学习和调试变得轻而易举。（例如 bash、python、matlab、perl、tcl...）

我可以对 html 和 php 做同样的事情吗？在 stackoverflow 的问题风格中，让我尝试让问题更具体一些。

我知道我可以在终端上以交互方式使用 php。但如果我想看看它在 html 脚本中是如何工作的，那还不够。 **是否有带有控制台的浏览器/IDE，我可以在其中交互式输入命令并查看结果？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T01:38:35.343

**对于 PHP：**

1.  我建议使用[Xdebug](http://xdebug.org/docs/)。
2.  通读这篇文章：[PHP 程序员的调试技术](http://www.ibm.com/developerworks/library/os-debug/)。
3.  关于[调试生产](https://stackoverflow.com/questions/3522182/will-enabling-xdebug-on-a-production-server-make-php-slower)的注意事项。

**对于您的标记：**

1.  阅读[Google Chrome 的类似 Firebug 的调试器](https://stackoverflow.com/questions/308125/firebug-like-debugger-for-google-chrome)。
2.  此外，您可以尝试[Web Developer](http://chrispederick.com/work/web-developer/)扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T01:45:39.873

你可以让你的浏览器成为你的ide。我有，看看：

方便的文章展示了如何将 php 输出到浏览器控制台。[http://sarfraznawaz.wordpress.com/2012/01/05/outputting-php-to-browser-console/](http://sarfraznawaz.wordpress.com/2012/01/05/outputting-php-to-browser-console/)

至于 html，请为您的浏览器下载 Web 开发人员扩展程序，并验证您的标记以进行测试/调试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T01:50:52.440

您可能对 Cloud9 IDE 之类的东西感兴趣。

查看它们：www.cloud9ide.com

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T01:40:07.723

我发现启用错误对于一般调试很方便。启用它后，您可以查看脚本失败的位置并轻松解决错误。对于更高级的东西，Xdebug 有它的位置。

结合本地 WAMP 安装，您有一个很好的起点。保存 php 脚本，执行它并结合“ [Firebug](https://getfirebug.com/) ”（FF 扩展名），你就有了一个不错的“初学者”调试工具集。

# preg-match - 无法工作 Propel Match 验证器

> ID：13983080
> 
> 赞同：0
> 
> 时间：2012-12-21T01:29:39.943
> 
> 标签：preg-match, propel

我正在开发一个 CRUD 应用程序。我使用 Propel 作为 ORM，并在 schema.xml 中添加了验证规则。但这，不能正常工作。例如，我发送一个包含用户姓氏的字符串，验证器是：

```
<rule name='minLength' value='4'/>
<rule name='maxLength' value='30'/>
<rule name='notMatch' value='/^\s+$/' />
<!-- the name can be only chars and spaces -->
<rule name='match' value='/[^A-Za-z ]$/'/> 
```

发送的用户姓氏是：“Martinez D Elia”。第四条规则有效失败。任何的想法 ？。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:54:52.103

正则表达式是错误的。正确的匹配是：

```
^[A-Za-z ]*$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:00:36.807

对上一个答案稍作更改，因为您需要最少 4 个字符和最多 30 个字符，您可能需要使用这个：

```
/^[A-Za-z ]{4,30}$/ 
```

另请注意，您确实需要正则表达式前后的“/”。仅供参考，您的正则表达式错误有两个原因：在字符类中放置“^”以及在字符类之后缺少长度限定符（没有“*”、“+”或括号 {}，您只匹配一个字符，再匹配会失败）。

# sql - Oracle/plsq 内连接多列到表一列

> ID：13983083
> 
> 赞同：0
> 
> 时间：2012-12-21T01:29:47.933
> 
> 标签：sql

我在加入 2 个表时遇到问题，假设我在第一个表名称国籍代码上有一个列（这是数字），它根据第一个表的国籍代码获取描述（可能是美国、中国等）。所以我尝试了内连接表，所以第一个内连接很好并且工作完美。

这是代码：

```
SELECT person.firstnm, person.middlenm, person.lastnm, refcd.description
FROM person
INNER JOIN refcd
ON person.natcd = refcd.id; 
```

但是，当我尝试从第一个表中加入第二列时，假设列名是 gencd（gendercode 它是一个外键）但是当我将查询更新为从一个表中连接 2 列从第二个中的一列中获取值时表我得到这个错误。“列不明确定义”我收到此错误，我理解我的问题是无论如何都可以实现我想要的输出？我想加入 2 个表，特别是将表 1 上的 2 列加入表 2 中的 1 列。

这是我更新的查询：

```
SELECT person.firstnm, person.middlenm, person.lastnm, refcd.description
FROM person
INNER JOIN refcd
ON person.natcd = refcd.id
INNER JOIN refcd
ON person.gencd = refcd.id; 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:52:23.920

您的查询应该是

```
SELECT person.firstnm, person.middlenm, person.lastnm, refcd.description
FROM person INNER JOIN refcd ON person.natcd = refcd.id
INNER JOIN refcd R2 ON person.gencd = R2.id; 
```

# c++ - 打印向量的结构元素

> ID：13983085
> 
> 赞同：2
> 
> 时间：2012-12-21T01:30:10.490
> 
> 标签：c++, visual-studio-2010

我正在学习矢量。我尝试实现一个打印向量的结构元素的代码，如下所示。互联网上的许多资源只教我一个简单的向量。当打印它时，我得到了表达。但是，任何提高代码质量和优雅性的建议都是开放的，尽管更改是基本的（在结构或循环中）。

非常感谢。

```
#include "stdafx.h"
#include <iostream>
#include <vector>
using namespace std;

typedef struct _student {
string name;
int age;
vector <string> subject;
}student;

int _tmain(int argc, _TCHAR* argv[])
{
  vector <student> x; //assmue at this point we do not know the number of students
  student y;

  //and I want to insert new information
  y.name ="John";
  y.age =9;
  y.subject.push_back("biology");
  y.subject.push_back("math");
  y.subject.push_back("art");
  x.push_back(y);       

  //get new information again
  //and I want to insert new information
  y.name ="Bon";
  y.age =12;
  y.subject.push_back("history");
  y.subject.push_back("physics");
  x.push_back(y);       

  // then I want display all data
  cout << "myvector contains:";

  for (int i=0; i<x.size(); i++)
  {   
      cout << "Student # " << i+1 <<endl;
      cout << "   name : " << x.at(i).name <<endl;  //Reference in the internet only display a simple vector --
      cout << "   age  : " << x.at(i).age <<endl;   //I get stuck to express this and next part
      cout <<"   Subject : ";
      for (int j =0; j < x.at(i).subject.size(); j++)
      {   
          cout << x.at(i).subject.at(j);
      }
      cout << endl;
cin.get();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:39:20.977

在这里，添加了一些评论和内容。不确定这是否是您要找的东西，但它就是在这里。

```
#include "stdafx.h"
#include <iostream>
#include <vector>
#include <string> // string would be welcome here!

struct _student // the typedef thing is not necessary in C++
{
    std::string            name; // i find this "using namespace ..." thing a bad habit, it can make code harder to read
    int                            age;
    std::vector<std::string>       subject;
};

int _tmain(int argc, _TCHAR* argv[])
{
    std::vector<student>    x;
    student                 y;
    size_t                  size; // calling vector.size() every iterations is a bad idea, performance-wise
    size_t                  size_subj; // same

    y.name = "John";
    y.age = 9;
    y.subject.push_back("biology");
    y.subject.push_back("math");
    y.subject.push_back("art");
    x.push_back(y);     

    y.name = "Bon";
    y.age = 12;
    y.subject.clear(); // clear subjects of the other student
    y.subject.push_back("history");
    y.subject.push_back("physics");
    x.push_back(y);     

    std::cout << "my vector contains:";
    for (int i = 0, size = x.size(); i < size; ++i)
    {
        size_subj = x[i].subject.size();
        // I prefer using operator[] when I'm sure nothing can go wrong
        std::cout << "Student # " << i + 1 <<endl;
        std::cout << "\tname: " << x[i].name <<endl;
        std::cout << "\tage: " << x[i].age <<endl;
        std::cout << "\tSubjects: ";
        for (int j = 0; j < size_subj; ++j)   
            std::cout << x[i].subject[j];
        std::cout << endl;
    }
    return 0;
} 
```

最后，使用 std::vector< std::string* > 或 std::vector< std::string& > 在性能方面可能是一个更好的主意，具体取决于您以后打算用它做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T01:38:17.327

这里没有真正的问题，所以我假设您要求“代码审查”“整洁”的方式当然是创建一个 operator<< 来获取您的内部结构。

除此之外，您可能希望考虑使用迭代器来遍历您的向量 - 这样，您应该能够更改任何其他容器类型的向量，而无需更改打印内容的循环。

为您的向量和临时学生使用比 x 和 y 更长的变量名称。

每次使用 setw 以相同的宽度打印字段。

我相信还有很多其他的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T01:43:54.817

正如评论所指出的，事实证明您没有包含`string`头文件。

# c# - 从 .net 存储 10 - 1 亿个模拟输出的最佳方式（SQL 与平面文件）

> ID：13983087
> 
> 赞同：11
> 
> 时间：2012-12-21T01:30:17.590
> 
> 标签：c#, .net, sql

我一直在从事一个项目，该项目从模拟中生成大约 10 到 1 亿个输出，我想存储这些输出以供将来分析。数据有几个自然级别的组织，例如教室里有参加考试的学生，这些考试有一些不同的表现指标。

就能够一次全部放入内存而言，我的数据似乎是边界线（考虑到模拟的计算需要内存中的大量数据来进行计算），但我没有任何迫切需要让我的程序立即可以使用所有数据。

我正在考虑将计算值输出到 SQL 数据库还是纯文本文件是否更好。我正在寻找有关哪种方法可能更快/更容易维护的建议（或者如果您有其他建议来存储我愿意接受的数据）。

我不需要能够与其他任何人共享数据，也不需要担心在未来几年内访问数据。我只需要一种方便的方法来避免每次我想对值的分析进行调整时重新生成模拟。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T01:40:21.117

我会考虑使用数据库——对于没有某种分类方案的文件系统来说，1 亿个文件太多了，而数据库可以轻松处理这么多行。您可以将输出序列化为 BLOB 列，因此您不必映射它。此外，请考虑 SQL Server 具有[文件流访问权限](http://technet.microsoft.com/en-us/library/bb933993%28SQL.105%29.aspx)，因此这本质上可能是一种混合方法，其中 SQL 为您管理文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T01:34:29.687

顺便说一句，听起来你最好将每次模拟运行的结果保存到一个平面文件中。它不必是文本文件 - 它可以是二进制文件。

在一次或多次模拟运行之后，可以读取文件并将其放入数据仓库以供以后分析。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T03:22:42.283

看看 MongoDB，它的性能显然比 SQL Server 2008 快 30 到 50 倍。

[http://blog.michaelckennedy.net/2010/04/29/mongodb-vs-sql-server-2008-performance-showdown/](http://blog.michaelckennedy.net/2010/04/29/mongodb-vs-sql-server-2008-performance-showdown/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-21T01:46:53.557

将数据从 RDBMS 服务器加载到内存中的粗略速率约为每秒 10K 条记录。如果您有 100M 条记录，并且您必须在某个时候使用所有数据，那么您大约需要三个小时来加载数据。那是在您进行任何计算之前！

普通文件可以快几个数量级。您可以使用基于文本的文件快速获得；采用二进制会以牺牲数据文件的可读性为代价来提高您的速度。

# c++ - NSOperation 和 NSOperationQueue 的 C++ 等效项

> ID：13983088
> 
> 赞同：7
> 
> 时间：2012-12-21T01:30:22.570
> 
> 标签：c++, objective-c, nsoperation, nsoperationqueue

请告诉我如何在 C++ 中实现 NSOperation 和 NSOperationQueue 功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:41:27.357

`NSOperation`是用于管理非关键任务的类。您创建操作，并将它们放在`NSOperationQueue`应用程序执行时执行每个操作。

C++ 中没有这样的“等价物”。C++ 是一种语言，`NSOperationQueue`FoundationKit 的一部分，OSX 和 iOS 的一部分，一组 Objective-C 对象，不属于 Objective-c 标准的一部分。

您需要研究的是用于执行任务并发的 Android 范例，并使用它们。或者，您可以直接从服务器手动下载资产，而不是任何托管任务库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-07T17:19:24.760

NSOperation 的粗略替代品：[std::packaged_task](http://en.cppreference.com/w/cpp/thread/packaged_task/packaged_task)。

# ios - NSFileManager - URLsForDirectory... 或 URLForDirectory

> ID：13983091
> 
> 赞同：5
> 
> 时间：2012-12-21T01:30:40.430
> 
> 标签：ios, nsfilemanager

`-[NSFileManager URLForDirectory:inDomain:appropriateForURL:create:error:]`需要一个 NSSearchPathDomainMask 并返回一个 URL。（这`...appropriateForURL:create:error:`部分在文档中有点混乱。）

`-[NSFileManager URLsForDirectory:inDomains:]`允许您为 domain 参数创建位掩码并返回 URL 数组。

在我看来，这两种方法之间存在重叠。如果我的目标是从 iOS 应用程序的沙箱中获取 Documents、Library 或 etc 目录，我应该什么时候使用一个而不是另一个？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-21T01:36:12.823

访问 Documents 目录（或其他类似目录）的标准方法是如下代码：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = paths[0]; 
```

这类似于这样做：

```
NSArray *URLs = [[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask];
NSURL *documentsURL = URLs[0]; 
```

关键区别在于第一个为您提供路径，`NSString`而第二个为您提供路径为`NSURL`.

可以通过以下方式使用另一种方法：

```
NSURL *documentsURL = [[NSFileManager defaultManager] URLForDirectory:NSDocumentDirectory inDomain:NSUserDomainMask appropriateForURL:nil create:NO error:nil]; 
```

您可以传递`NO`Documents 目录，因为它始终存在。您应该传递`YES`应用程序支持目录，因为它默认不存在。理想情况下，您不应该传递`nil`错误，这样您就可以看到如果方法调用返回时会发生什么`nil`。

这三种方法中的任何一种都有效。如果要将路径作为字符串，请使用第一个。如果您想将其用作 URL，请使用第 3 个。如果您很少需要传入多个域，请使用第二个。

# php - PHP 表达式 - 如果 $b 有内容则隐藏 $a

> ID：13983093
> 
> 赞同：0
> 
> 时间：2012-12-21T01:30:51.507
> 
> 标签：php, wordpress

我正在尝试为 href 设置表达式。基本上，如果用户在后端添加手动的，我希望 url 改变。

我正在使用高级自定义字段。

所以我有 2 个自定义字段，如果字段 B 有 url，我希望清除自定义字段 A。字段 A 始终由 cms 生成（如随机链接）。

为了更好地解释，以便您基本上了解这个概念，我希望用户能够输入他们的手动链接而不是生成的链接，如果我让自己清楚的话。

所以基本上如果字段 B 为真清除字段 A，这又是一个 href 链接。

我很确定这是一个以 php 开头的基本 php 语句：P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T01:34:56.703

```
$a = $_POST['a'];
$b = $_POST['b'];

if ($b != '') $a = null; 
```

# python - 创建动态 Python 字典引用路径

> ID：13983094
> 
> 赞同：2
> 
> 时间：2012-12-21T01:30:52.977
> 
> 标签：python, loops, dictionary, reference, concatenation

我在动态创建 Python 字典路径以循环并验证值时遇到问题。这是我想做的：

使用 Requests 1.0 进行 API 调用并将 JSON 响应存储在字典中。

```
response = requests.get(path/to/file.json).json() 
```

**响应**对象的格式如下：

```
{   
"status": "OK",
"items": [
    {
        "name": "Name 1",
        "id": 0,
        "address":{
            "city": "New York",
        }
    },
    {
        "name": "Name 2",
        "id": 1,
        "address":{
            "city": "New York",
        }
    },
    {
        "name": "Name 3",
        "id": 2,
        "address":{
            "city": "New York",
        }
    }]
} 
```

将**响应**字典、**字段**和**值**发送到函数进行验证。该函数将获取响应对象并将字段条目附加到它以定义其路径，然后根据该值进行验证。所以理论上它会是：

```
response[field] = value 
```

我为此编写的代码是：

```
def dynamic_assertion(response, field, value):
        i = 0
        stations = "response['items']"
        count = len(response['items'])
        while i < count:
            path = '%s[%s]%s' % (stations, i, field)
            path = path.strip("")
            if path != value:
                print type(path)
                return False
            i += 1
        return True

dynamic_assertion(response, "['address']['city']", "New York") 
```

我意识到，一旦我创建了路径字符串，它就不再是一个对象。如何以允许我保留响应对象并附加引用路径以遍历的方式创建它？这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:48:18.537

我认为您最好避免使用单个`path`字符串，而使用表示嵌套字典中各个键的元组或字符串列表。也就是说，您不会`"['address']['city']"`成为您的`field`论点，而是通过`("address", "city")`. 然后你只需要一个循环来遍历键并查看最终值是否正确：

```
def dynamic_assertion(response, field, value):
    for item in response["items"]:
        for key in field:
            item = item[key] # go deeper into the nested dictionary
        if item != value:
            return False # raising an exception might be more Pythonic
    return True 
```

示例输出（给定`response`问题中的字典）：

```
>>> dynamic_assertion(response, ("address", "city"), "New York")
True
>>> dynamic_assertion(response, ("address", "city"), "Boston")
False
>>> response["items"][2]["address"]["city"] = "Boston" # make response invalid 
>>> dynamic_assertion(response, ("address", "city"), "New York")
False
>>> dynamic_assertion(response, ("address", "city"), "Boston")
False 
```

# apache - Apache Mod_Rewrite - 重定向丢失 POST 数据 - 405 错误

> ID：13983095
> 
> 赞同：2
> 
> 时间：2012-12-21T01:31:08.743
> 
> 标签：apache, mod-rewrite, http-status-code-301, http-status-code-405

Stackoverflow 用户，

我有一个 Apache 应用程序需要接受发布到以下路径的数据：

```
/sample/HostChange/Submit
/sample/HostChange/SubmittoAPI 
```

我目前正在使用以下 301 重定向规则。这不是我想要的，因为 POST 被重定向，第二个请求是 GET 丢失所有数据。我看到 301 请求转到正确的 url，但第二个请求是 GET 并导致 405 响应代码。

.ht 访问：

> ```
> RewriteEngine On
> Redirect 301 /sample/HostChange/Submit /event
> Redirect 301 /sample/HostChange/SubmittoAPI /date 
> ```

我确定使用重定向是问题所在。有人可以帮我找出正确的 RewriteCondition 我需要用来将这些 POST 命中重定向到新路径，但保留提交给应用程序的数据。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-16T19:59:19.773

我遇到了同样的问题，对我来说，它帮助不是真正重定向请求，而是重写它。如果这适用于您的问题，我现在不知道。

以下是详细信息，它对我有用： [PHP Rewrite url and preserve posted data](https://stackoverflow.com/questions/7510799/php-rewrite-url-and-preserve-posted-data)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T01:36:00.860

我认为您不能重定向 POST（作为 POST）。浏览器不会再次发布数据。

您必须使用 Javascript 输出一些 HTML 以使浏览器将数据重新发布到新 URL。

或者不是重定向，而是让一些服务器端代码首先接受 POST 数据，然后以某种方式在内部发送它（可能是在 URL 中使用识别令牌重定向）。

或者，如果数据很短，则重写 URL 以包含数据作为查询参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T01:40:44.057

遵循以下内容应该可以工作，我目前不在 apache 实例周围，因此未尝试使用正则表达式，但请检查重写日志并查看其行为方式。

```
RewriteEngine On
RewriteLog /var/log/httpd/rewrite.log
RewriteLogLevel 9
RewriteCond %{REQUEST_URI} /sample/HostChange/Submit
RewriteRule ^/sample/HostChange/Submit(.*) /event/$1 [P,L] 
```

# ruby - 如何使用 AptanaStudio Ruby 调试器忽略“US-ASCII 中的无效字节序列”？

> ID：13983104
> 
> 赞同：1
> 
> 时间：2012-12-21T01:33:20.717
> 
> 标签：ruby, winapi

我英语不好，所以请原谅我的英语问题。

我在 Windows 7 中使用 AptanaStudio 3 和 Ruby 1.9.2。当我尝试使用 Win32 memcpy 从 ruby​​ 调试器中的共享内存中获取字符串数据时，会出现此问题。

```
# encoding: utf-8
require 'windows/file_mapping'
require 'windows/msvcrt/buffer'
require 'windows/handle'

include Windows::FileMapping
include Windows::MSVCRT::Buffer
include Windows::Handle

buf1 = 0.chr * 256
@mh = OpenFileMapping(FILE_MAP_ALL_ACCESS, false, "TAG_NAME")
@address = MapViewOfFile(@mh, FILE_MAP_ALL_ACCESS, 0, 0, 0)
memcpy(buf1, @address, 256)
UnmapViewOfFile(@address)
CloseHandle(@mh)

puts buf1.unpack("Z*") 
```

问题如下

```
 c:/Ruby192/lib/ruby/1.9.1/syck/rubytypes.rb:151:in `count'
    c:/Ruby192/lib/ruby/1.9.1/syck/rubytypes.rb:151:in `is_binary_data?'
    C:/Users/Zenbook/SkyDrive/AptanaStudio/workspace/best_practice/test.rb:19:in `<top (required)>'
    c:/Ruby192/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.16/lib/ruby-debug-ide.rb:112:in `debug_load'
    c:/Ruby192/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.16/lib/ruby-debug-ide.rb:112:in `debug_program'
    c:/Ruby192/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.16/bin/rdebug-ide:87:in `<top (required)>'
    c:/Ruby192/bin/rdebug-ide:19:in `load'
    c:/Ruby192/bin/rdebug-ide:19:in `<main>'
Uncaught exception: invalid byte sequence in US-ASCII 
```

当我在 memcpy 之后不使用任何断点或者我只得到字符串长度时，它不会发生。我的意思是，当 char 字符串大小为 256 ，char 字符串长度为 12 并且我只得到 12 个字节时，问题不会发生。

我认为这是因为调试器无法从 char 字符串中读取文本，包括未初始化的位置。

所以我想忽略错误或允许字符串包含无效文本。有人会帮助我吗？

# python - 线程不会在 python 中停止

> ID：13983119
> 
> 赞同：0
> 
> 时间：2012-12-21T01:35:50.733
> 
> 标签：python, multithreading, download

我的程序的目的是用线程下载文件。我定义了单位，并使用 len/unit 线程，len 是要下载的文件的长度。

使用我的程序，可以下载文件，但线程并没有停止。我找不到原因。

这是我的代码...

```
#! /usr/bin/python

import urllib2
import threading
import os
from time import ctime

class MyThread(threading.Thread):
 def __init__(self,func,args,name=''):
  threading.Thread.__init__(self);
  self.func = func;
  self.args = args;
  self.name = name;
 def run(self):
  apply(self.func,self.args);

url = 'http://ubuntuone.com/1SHQeCAQWgIjUP2945hkZF';
request = urllib2.Request(url);
response = urllib2.urlopen(request);
meta = response.info();
response.close();
unit = 1000000;
flen = int(meta.getheaders('Content-Length')[0]);
print flen;
if flen%unit == 0:
 bs = flen/unit;
else :
 bs = flen/unit+1;
blocks = range(bs);
cnt = {};
for i in blocks:
 cnt[i]=i;
def getStr(i):
 try:
  print 'Thread %d start.'%(i,);
  fout = open('a.zip','wb');
  fout.seek(i*unit,0);
  if (i+1)*unit > flen:
   request.add_header('Range','bytes=%d-%d'%(i*unit,flen-1));
  else :
   request.add_header('Range','bytes=%d-%d'%(i*unit,(i+1)*unit-1));
  #opener = urllib2.build_opener();
  #buf = opener.open(request).read();
  resp = urllib2.urlopen(request);
  buf = resp.read();
  fout.write(buf);
 except BaseException:
  print 'Error';
 finally :
  #opener.close();
  fout.flush();
  fout.close();
  del cnt[i];
# filelen = os.path.getsize('a.zip');
 print 'Thread %d ended.'%(i),
 print cnt;
# print 'progress : %4.2f'%(filelen*100.0/flen,),'%';
def main():
 print 'download at:',ctime();
 threads = [];
 for i in blocks:
  t = MyThread(getStr,(blocks[i],),getStr.__name__);
  threads.append(t);
 for i in blocks:
  threads[i].start();
 for i in blocks:
#  print 'this is the %d thread;'%(i,);
  threads[i].join();
 #print 'size:',os.path.getsize('a.zip');
 print 'download done at:',ctime();
if __name__=='__main__':
 main(); 
```

有人可以帮我理解为什么线程没有停止。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:01:35.963

我无法真正解决您的代码示例，因为它非常混乱且难以理解，但是您看到线程未结束的一个潜在原因是请求将停止并且永远不会完成。`urllib2`允许您指定允许请求执行多长时间的超时。

对于您自己的代码，我建议您将工作分成一个队列，启动固定数量的线程（而不是可变数量），然后让工作线程开始工作，直到完成。使 http 请求超时。如果超时到期，请重试或将工作放回队列中。

下面是一个通用示例，说明如何使用队列、固定数量的工作人员以及它们之间的同步原语：

```
import threading
import time
from Queue import Queue

def worker(queue, results, lock):
    local_results = []
    while True:
        val = queue.get()
        if val is None:
            break

        # pretend to do work
        time.sleep(.1)
        local_results.append(val)

    with lock:
        results.extend(local_results)
        print threading.current_thread().name, "Done!"

num_workers = 4

threads = []
queue = Queue()
lock = threading.Lock()
results = []

for i in xrange(100):
    queue.put(i)

for _ in xrange(num_workers):

    # Use None as a sentinel to signal the threads to end
    queue.put(None)

    t = threading.Thread(target=worker, args=(queue,results,lock))
    t.start()
    threads.append(t)

for t in threads:
    t.join()

print sorted(results)

print "All done" 
```

# python - Python蓝牙模块lightblue在mac osx 10.8上不起作用

> ID：13983125
> 
> 赞同：5
> 
> 时间：2012-12-21T01:36:18.190
> 
> 标签：python, macos, bluetooth

我正在尝试安装python蓝牙模块'lightblue'。我使用macports安装了它。当我导入模块时，它会导致一堆错误。

```
>> import lightblue
2012-12-21 07:04:13.874 Python[4062:f07] PyObjCPointer created: at 0x7fff788af900 of type {__CFBoolean=}
2012-12-21 07:04:13.875 Python[4062:f07] PyObjCPointer created: at 0x7fff788af8f0 of type {__CFBoolean=}
2012-12-21 07:04:13.876 Python[4062:f07] PyObjCPointer created: at 0x7fff788af910 of type {__CFNumber=}
2012-12-21 07:04:13.876 Python[4062:f07] PyObjCPointer created: at 0x7fff788af928 of type {__CFNumber=}
2012-12-21 07:04:13.876 Python[4062:f07] PyObjCPointer created: at 0x7fff788af940 of type {__CFNumber=}
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/lightblue/__init__.py", line 160, in <module>
    from _lightblue import *
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/lightblue/_lightblue.py", line 28, in <module>
    import _LightAquaBlue
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/lightblue/_LightAquaBlue.py", line 32, in <module>
    _FRAMEWORK_PATH)
ImportError: Cannot load LightAquaBlue framework, not found at/opt/local/Library/Frameworks/LightAquaBlue.framework 
```

请帮我安装这个模块。我没有找到很多其他的蓝牙编程模块。pybluez没有mac版本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:20:49.180

[这个版本](https://github.com/postskolkovo/lightblue-0.4)在山狮上成功地为我工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-26T09:45:40.357

我不确定这是否直接适用于原始问题......</p>

执行摘要：使用“sudo”并注意安装程序错误消息。

我尝试在运行 Xcode 5.0.2 的 Mac 上安装 lightblue-0.4

根据我在各个地方找到的建议，我将 setup.py 的最后一行更改为：

```
 os.system("xcodebuild install -target LightAquaBlue -configuration Release DSTROOT=/ INSTALL_PATH=/Library/Frameworks DEPLOYMENT_LOCATION=YES") 
```

我将 setup.py 中的其他行更改为：

```
packages=["lightblue","LightAquaBlue"],
package_dir={"lightblue":getpackagedir(), "LightAquaBlue":"%s/LightAquaBlue" % getpackagedir()},
package_data={"lightblue":[ ], "LightAquaBlue":["LightAquaBlue.bridgesupport"]}, 
```

我不得不将 LightAquaBlue Base SDK 的 Xcode 中的构建设置更改为 OS X 10.9（它正在寻找 10.4u——“u”=“and up”吗？当我收到错误消息时，我没有使用 sudo Xcode)

在我使用“sudo python setup.py install”之前，我在运行安装时遇到了 chown 权限错误

最后（叹气），我不得不复制 Macintosh HD/Libraries/LightAquaBlue.framework 文件夹中的 LightAquaBlue 别名并将其粘贴到 Macintosh HD/Libraries/LightAquaBlue.framework/Versions/A 文件夹中

毕竟我得到了：

**安装成功**

这将在此文件夹中产生一堆目标文件：

lightblue-0.4/src/mac/LightAquaBlue/build/LightAquaBlue.build/Release/LightAquaBlue.build/Objects-normal/x86_64

# macos - 如何在 mac OSX 上编译 node-segfault-handler？

> ID：13983126
> 
> 赞同：1
> 
> 时间：2012-12-21T01:36:20.057
> 
> 标签：macos, node.js

我正在尝试使用[https://github.com/ddopson/node-segfault-handler](https://github.com/ddopson/node-segfault-handler)来调试分段错误异常。我正在运行 OSX 10.8.6

但是，在存储库上运行 npm rebuild 后，我收到以下错误：

```
node example.js 

module.js:485
  process.dlopen(filename, module.exports);
          ^
Error: dlopen(/Users/xxx/lever/ats/node_modules/segvcatcher/build/Release/segvhandler_native.node, 1): no suitable image found.  Did find:
    /Users/xxx/lever/ats/node_modules/segvcatcher/build/Release/segvhandler_native.node: mach-o, but wrong architecture
    at Object.Module._extensions..node (module.js:485:11)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.<anonymous> (/Users/xxx/lever/ats/node_modules/segvcatcher/lib/segvhandler.js:7:16)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T05:11:20.203

我刚刚测试了在“Mac OS X 10.7.5 (11G63)”上构建它，它在那里工作正常。我没有任何带有 OSX 10.8.6 的盒子来专门测试它，但我敢打赌 Node 版本更重要。

```
> segvcatcher@0.1.0 安装 /Users/Dopson/work/other/node-segfault-handler
> 节点 waf 清洁；node-waf 配置构建

'clean' 成功完成（0.005s）
检查程序 g++ 或 c++：/usr/bin/g++
检查程序 cpp：/usr/bin/cpp
检查程序 ar：/usr/bin/ar
检查程序ranlib：/usr/bin/ranlib
检查 g++：好的
检查节点路径：ok /Users/Dopson/.node_libraries
检查节点前缀：ok /usr/local/Cellar/node/0.8.18
“配置”成功完成（0.032 秒）
Waf：进入目录`/Users/Dopson/work/other/node-segfault-handler/build'
[1/2] cxx: src/segvhandler.cpp -> build/Release/src/segvhandler_1.o
[2/2] cxx_link: build/Release/src/segvhandler_1.o -> build/Release/segvhandler_native.node
Waf：离开目录`/Users/Dopson/work/other/node-segfault-handler/build'
“构建”成功完成（0.214 秒）

```

它第一次对我来说失败了，因为我的 node-waf 安装失败了（缺少 python dep）。我重新安装了节点，它工作得很好。我使用 Homebrew 并安装了 Node v0.8.18。

# java - Android 类型 new View.OnClickListener(){} 的方法 startActivity(Intent) 未定义

> ID：13983129
> 
> 赞同：0
> 
> 时间：2012-12-21T01:36:41.040
> 
> 标签：java, android, android-intent, android-activity

```
public class ListSceneAdapter extends OAListSceneAdapter {

    public ListSceneAdapter(Context context) {
        super(context, R.layout.listitem); // pass the custom UI layout for list items
    }

    @Override
    protected void setupListItemView(View listItemView, OAScene scene) {
        // fill the custom UI with the given scene data for the list item
        ((TextView)listItemView.findViewById(R.id.listItemName)).setText(scene.name);

        // add listener for the button
        final OAScene _scene = scene;
        ((Button)listItemView.findViewById(R.id.listItemButton)).setOnClickListener(
                new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        Toast.makeText(getContext(), _scene.description, Toast.LENGTH_SHORT).show();
                    }
                });

        ((Button)listItemView.findViewById(R.id.listItemMap)).setOnClickListener(
                new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        double lat = 1.559034;
                        double longi =103.641486;

                        Intent intent = new Intent(
                                android.content.Intent.ACTION_VIEW,
                                Uri.parse("http://maps.google.com/maps?saddr="+ lat + "," + longi+ "&daddr="+_scene.getLatitude()+","+_scene.getLongitude()+""));
                        intent.setClassName("com.google.android.apps.maps", "com.google.android.maps.MapsActivity");
                        startActivity(intent);

                        //Toast.makeText(getContext(), _scene.description, Toast.LENGTH_SHORT).show();
                    }
                });
    }

} 
```

继承人的代码。当我尝试 onClick 并打开从 Google Map api 提供导航的新活动时。它给出了这个错误。方法 startActivity(Intent) 未定义新 View.OnClickListener(){} 类型

这是 LOGCAT

```
12-21 11:30:10.867: D/SensorManager(4782): ====>>>>>Num Sensor: 1
12-21 11:30:10.867: D/SensorManager(4782): ====>>>>>Num Sensor: 2
12-21 11:30:10.875: D/SensorManager(4782): ====>>>>>Num Sensor: 3
12-21 11:30:10.875: D/SensorManager(4782): ====>>>>>Num Sensor: 4
12-21 11:30:10.875: D/SensorManager(4782): ====>>>>>Num Sensor: 5
12-21 11:30:10.875: D/SensorManager(4782): ====>>>>>Num Sensor: 6
12-21 11:30:10.875: D/SensorManager(4782): ====>>>>>Num Sensor: 0
12-21 11:30:10.898: I/inertialManager(4782): Rotation is: 0 or 180
12-21 11:30:10.898: I/intertialManager(4782): Natural Orientation is landscape
12-21 11:30:11.000: W/System.err(4782): java.lang.NumberFormatException: unable to parse 'main' as integer
12-21 11:30:11.015: W/System.err(4782):     at java.lang.Integer.parse(Integer.java:383)
12-21 11:30:11.015: W/System.err(4782):     at java.lang.Integer.parseInt(Integer.java:372)
12-21 11:30:11.015: W/System.err(4782):     at java.lang.Integer.parseInt(Integer.java:332)
12-21 11:30:11.015: W/System.err(4782):     at java.lang.Integer.valueOf(Integer.java:506)
12-21 11:30:11.015: W/System.err(4782):     at com.hitlabnz.androidar.utils.SceneXMLReader.characters(SceneXMLReader.java:427)
12-21 11:30:11.015: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.text(ExpatParser.java:165)
12-21 11:30:11.015: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.appendBytes(Native Method)
12-21 11:30:11.015: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.parseFragment(ExpatParser.java:518)
12-21 11:30:11.015: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.parseDocument(ExpatParser.java:479)
12-21 11:30:11.015: W/System.err(4782):     at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:318)
12-21 11:30:11.015: W/System.err(4782):     at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:275)
12-21 11:30:11.015: W/System.err(4782):     at com.hitlabnz.androidar.utils.SceneXMLReader.readManifest(SceneXMLReader.java:549)
12-21 11:30:11.015: W/System.err(4782):     at com.hitlabnz.androidar.data.management.DataLoaderLocalXML.getSceneData(DataLoaderLocalXML.java:72)
12-21 11:30:11.015: W/System.err(4782):     at com.hitlabnz.androidar.data.management.DataLoaderLocalXML.getSceneData(DataLoaderLocalXML.java:1)
12-21 11:30:11.015: W/System.err(4782):     at com.hitlabnz.outdoorar.data.OADataManagerAssets.loadScenes(OADataManagerAssets.java:200)
12-21 11:30:11.015: W/System.err(4782):     at com.hitlabnz.outdoorar.data.OADataManager.startLoading(OADataManager.java:266)
12-21 11:30:11.015: W/System.err(4782):     at com.hitlabnz.outdoorar.api.OAListComponentBase.setupScenes(OAListComponentBase.java:87)
12-21 11:30:11.015: W/System.err(4782):     at com.hitlabnz.outdoorar.api.OAListComponentBase.onCreate(OAListComponentBase.java:167)
12-21 11:30:11.015: W/System.err(4782):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-21 11:30:11.015: W/System.err(4782):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
12-21 11:30:11.015: W/System.err(4782):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
12-21 11:30:11.015: W/System.err(4782):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-21 11:30:11.023: W/System.err(4782):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
12-21 11:30:11.023: W/System.err(4782):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-21 11:30:11.023: W/System.err(4782):     at android.os.Looper.loop(Looper.java:130)
12-21 11:30:11.023: W/System.err(4782):     at android.app.ActivityThread.main(ActivityThread.java:3687)
12-21 11:30:11.023: W/System.err(4782):     at java.lang.reflect.Method.invokeNative(Native Method)
12-21 11:30:11.023: W/System.err(4782):     at java.lang.reflect.Method.invoke(Method.java:507)
12-21 11:30:11.023: W/System.err(4782):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
12-21 11:30:11.023: W/System.err(4782):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
12-21 11:30:11.023: W/System.err(4782):     at dalvik.system.NativeStart.main(Native Method)
12-21 11:30:11.054: W/System.err(4782): java.lang.NumberFormatException: unable to parse 'main' as integer
12-21 11:30:11.062: W/System.err(4782):     at java.lang.Integer.parse(Integer.java:383)
12-21 11:30:11.062: W/System.err(4782):     at java.lang.Integer.parseInt(Integer.java:372)
12-21 11:30:11.062: W/System.err(4782):     at java.lang.Integer.parseInt(Integer.java:332)
12-21 11:30:11.070: W/System.err(4782):     at java.lang.Integer.valueOf(Integer.java:506)
12-21 11:30:11.070: W/System.err(4782):     at com.hitlabnz.androidar.utils.SceneXMLReader.characters(SceneXMLReader.java:427)
12-21 11:30:11.070: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.text(ExpatParser.java:165)
12-21 11:30:11.070: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.appendBytes(Native Method)
12-21 11:30:11.070: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.parseFragment(ExpatParser.java:518)
12-21 11:30:11.070: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.parseDocument(ExpatParser.java:479)
12-21 11:30:11.070: W/System.err(4782):     at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:318)
12-21 11:30:11.070: W/System.err(4782):     at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:275)
12-21 11:30:11.070: W/System.err(4782):     at com.hitlabnz.androidar.utils.SceneXMLReader.readManifest(SceneXMLReader.java:549)
12-21 11:30:11.070: W/System.err(4782):     at com.hitlabnz.androidar.data.management.DataLoaderLocalXML.getSceneData(DataLoaderLocalXML.java:72)
12-21 11:30:11.070: W/System.err(4782):     at com.hitlabnz.androidar.data.management.DataLoaderLocalXML.getSceneData(DataLoaderLocalXML.java:1)
12-21 11:30:11.070: W/System.err(4782):     at com.hitlabnz.outdoorar.data.OADataManagerAssets.loadScenes(OADataManagerAssets.java:200)
12-21 11:30:11.070: W/System.err(4782):     at com.hitlabnz.outdoorar.data.OADataManager.startLoading(OADataManager.java:266)
12-21 11:30:11.070: W/System.err(4782):     at com.hitlabnz.outdoorar.api.OAListComponentBase.setupScenes(OAListComponentBase.java:87)
12-21 11:30:11.070: W/System.err(4782):     at com.hitlabnz.outdoorar.api.OAListComponentBase.onCreate(OAListComponentBase.java:167)
12-21 11:30:11.070: W/System.err(4782):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-21 11:30:11.070: W/System.err(4782):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
12-21 11:30:11.070: W/System.err(4782):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
12-21 11:30:11.070: W/System.err(4782):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-21 11:30:11.070: W/System.err(4782):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
12-21 11:30:11.070: W/System.err(4782):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-21 11:30:11.070: W/System.err(4782):     at android.os.Looper.loop(Looper.java:130)
12-21 11:30:11.070: W/System.err(4782):     at android.app.ActivityThread.main(ActivityThread.java:3687)
12-21 11:30:11.070: W/System.err(4782):     at java.lang.reflect.Method.invokeNative(Native Method)
12-21 11:30:11.070: W/System.err(4782):     at java.lang.reflect.Method.invoke(Method.java:507)
12-21 11:30:11.070: W/System.err(4782):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
12-21 11:30:11.070: W/System.err(4782):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
12-21 11:30:11.070: W/System.err(4782):     at dalvik.system.NativeStart.main(Native Method)
12-21 11:30:11.242: W/System.err(4782): java.lang.NumberFormatException: unable to parse 'main' as integer
12-21 11:30:11.242: W/System.err(4782):     at java.lang.Integer.parse(Integer.java:383)
12-21 11:30:11.242: W/System.err(4782):     at java.lang.Integer.parseInt(Integer.java:372)
12-21 11:30:11.242: W/System.err(4782):     at java.lang.Integer.parseInt(Integer.java:332)
12-21 11:30:11.242: W/System.err(4782):     at java.lang.Integer.valueOf(Integer.java:506)
12-21 11:30:11.242: W/System.err(4782):     at com.hitlabnz.androidar.utils.SceneXMLReader.characters(SceneXMLReader.java:427)
12-21 11:30:11.242: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.text(ExpatParser.java:165)
12-21 11:30:11.242: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.appendBytes(Native Method)
12-21 11:30:11.242: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.parseFragment(ExpatParser.java:518)
12-21 11:30:11.242: W/System.err(4782):     at org.apache.harmony.xml.ExpatParser.parseDocument(ExpatParser.java:479)
12-21 11:30:11.242: W/System.err(4782):     at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:318)
12-21 11:30:11.242: W/System.err(4782):     at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:275)
12-21 11:30:11.242: W/System.err(4782):     at com.hitlabnz.androidar.utils.SceneXMLReader.readManifest(SceneXMLReader.java:549)
12-21 11:30:11.242: W/System.err(4782):     at com.hitlabnz.androidar.data.management.DataLoaderLocalXML.getSceneData(DataLoaderLocalXML.java:72)
12-21 11:30:11.242: W/System.err(4782):     at com.hitlabnz.androidar.data.management.DataLoaderLocalXML.getSceneData(DataLoaderLocalXML.java:1)
12-21 11:30:11.242: W/System.err(4782):     at com.hitlabnz.outdoorar.data.OADataManagerAssets.loadScenes(OADataManagerAssets.java:200)
12-21 11:30:11.250: W/System.err(4782):     at com.hitlabnz.outdoorar.data.OADataManager.startLoading(OADataManager.java:266)
12-21 11:30:11.250: W/System.err(4782):     at com.hitlabnz.outdoorar.api.OAListComponentBase.setupScenes(OAListComponentBase.java:87)
12-21 11:30:11.250: W/System.err(4782):     at com.hitlabnz.outdoorar.api.OAListComponentBase.onCreate(OAListComponentBase.java:167)
12-21 11:30:11.250: W/System.err(4782):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-21 11:30:11.250: W/System.err(4782):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
12-21 11:30:11.250: W/System.err(4782):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
12-21 11:30:11.250: W/System.err(4782):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-21 11:30:11.250: W/System.err(4782):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
12-21 11:30:11.250: W/System.err(4782):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-21 11:30:11.250: W/System.err(4782):     at android.os.Looper.loop(Looper.java:130)
12-21 11:30:11.250: W/System.err(4782):     at android.app.ActivityThread.main(ActivityThread.java:3687)
12-21 11:30:11.250: W/System.err(4782):     at java.lang.reflect.Method.invokeNative(Native Method)
12-21 11:30:11.250: W/System.err(4782):     at java.lang.reflect.Method.invoke(Method.java:507)
12-21 11:30:11.250: W/System.err(4782):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
12-21 11:30:11.250: W/System.err(4782):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
12-21 11:30:11.250: W/System.err(4782):     at dalvik.system.NativeStart.main(Native Method)
12-21 11:30:11.398: D/dalvikvm(4782): GC_CONCURRENT freed 265K, 47% free 3001K/5639K, external 499K/517K, paused 3ms+10ms
12-21 11:30:11.398: I/GPSManager(4782): Network Location Provider available
12-21 11:30:11.468: E/SensorManager(4782): registerListener :: handle = 1600615030  name= Gravity Sensor delay= 20000 Listener= com.hitlabnz.androidar.sensors.inertial.InertialManager$3@4055af88
12-21 11:30:11.468: E/SensorManager(4782): =======>>>Sensor Thread RUNNING <<<========
12-21 11:30:11.476: E/SensorManager(4782): registerListener :: handle = 1  name= MMC328X delay= 20000 Listener= com.hitlabnz.androidar.sensors.inertial.InertialManager$2@4055ac88
12-21 11:30:11.476: E/SensorManager(4782): reg :: handle = 1
12-21 11:30:12.687: E/SensorManager(4782): unregisterListener:: all sensors,  listener = com.hitlabnz.androidar.sensors.inertial.InertialManager$2@4055ac88
12-21 11:30:12.695: E/SensorManager(4782): unregisterListener:: all sensors,  listener = com.hitlabnz.androidar.sensors.inertial.InertialManager$3@4055af88
12-21 11:30:12.804: I/GPSManager(4782): Network Location Provider available
12-21 11:30:12.867: E/SensorManager(4782): registerListener :: handle = 1600615030  name= Gravity Sensor delay= 20000 Listener= com.hitlabnz.androidar.sensors.inertial.InertialManager$3@4055af88
12-21 11:30:12.867: E/SensorManager(4782): registerListener :: handle = 1  name= MMC328X delay= 20000 Listener= com.hitlabnz.androidar.sensors.inertial.InertialManager$2@4055ac88
12-21 11:30:12.875: E/SensorManager(4782): reg :: handle = 1
12-21 11:30:12.976: D/AndroidRuntime(4782): Shutting down VM
12-21 11:30:12.976: W/dalvikvm(4782): threadid=1: thread exiting with uncaught exception (group=0x40018578)
12-21 11:30:13.039: E/AndroidRuntime(4782): FATAL EXCEPTION: main
12-21 11:30:13.039: E/AndroidRuntime(4782): java.lang.NullPointerException
12-21 11:30:13.039: E/AndroidRuntime(4782):     at com.hitlabnz.tutorialbasic.ListSceneAdapter$2.onClick(ListSceneAdapter.java:53)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at android.view.View.performClick(View.java:2485)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at android.view.View$PerformClick.run(View.java:9080)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at android.os.Handler.handleCallback(Handler.java:587)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at android.os.Handler.dispatchMessage(Handler.java:92)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at android.os.Looper.loop(Looper.java:130)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at android.app.ActivityThread.main(ActivityThread.java:3687)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at java.lang.reflect.Method.invokeNative(Native Method)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at java.lang.reflect.Method.invoke(Method.java:507)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
12-21 11:30:13.039: E/AndroidRuntime(4782):     at dalvik.system.NativeStart.main(Native Method) 
```

OAListSceneAdapter 类

```
/*
 * Copyright 2011 the Human Interface Technology Laboratory New Zealand, University of Canterbury.
 * http://www.hitlabnz.org
 * 
 * This software is provided under the license terms described in LICENSE.TXT file distributed with this software package.
 */

package com.hitlabnz.outdoorar.api;

import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.TextView;

import com.hitlabnz.androidar.data.SceneData;
import com.hitlabnz.outdoorar.R;

/**
 * Basic adapter class for making custom layout for list items in list components. 
 * @author Gun Lee
 */
public class OAListSceneAdapter extends ArrayAdapter<SceneData> {

    protected LayoutInflater layoutInflater;
    private int listItemLayoutId;
    private Context c; 

    /**
     * Instantiate with the context to access the layout resource for list items.
     * Subclasses should override this method and call super(context, layoutResId) with a customized layout resource.
     * @param context   context for accessing resources
     */
    public OAListSceneAdapter(Context context) {
        this(context, R.layout.oa_list_item);
        c =context;
    }

    /**
     * Instantiate with the context to access the layout resource for list items.
     * Subclasses should NOT override this method.
     * @param context       context for accessing resources
     * @param layoutResId   resource id of the list item layout
     */
    protected OAListSceneAdapter(Context context, int layoutResId) {
        super(context, R.layout.list_item);

        this.layoutInflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        listItemLayoutId = layoutResId;
    }

    /**
     * Called back for setting up the list item view for a given scene.
     * Subclasses should override this method for setting up the list item view for the scene.
     * Subclasses need NOT to call the method in the super class.
     * @param listItemView  view for the list item, create with the layout resource id given at instan
     * @param scene
     */
    protected void setupListItemView(View listItemView, OAScene scene) {
        TextView nameText = (TextView) listItemView.findViewById(R.id.listItemName);
        TextView categoryText = (TextView) listItemView.findViewById(R.id.listItemCategory);

        nameText.setText(scene.name);
        if(scene.category == null)
            categoryText.setText("");
        else
            categoryText.setText("- " + scene.category);
    }

    /**
     * Called back for a view for the list item.
     * Subclasses should NOT override this method, but override the setupListItemView() method for customization.
     */
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        if (convertView == null)
            convertView = layoutInflater.inflate(listItemLayoutId, parent, false);

        OAScene scene = (OAScene)this.getItem(position);
        setupListItemView(convertView, scene);
        return convertView;
    }

} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-21T01:43:00.557

那是因为`Listener`s 不启动活动。

我假设传递给您的类的 Context 可通过 getter 方法或类似方法提供给整个类。`Context`如果没有，您可以在通过构造函数获取时存储对 this 的全局引用。您可能需要将其定为最终版本，否则`Listener` *可能会*抱怨。

无论如何，你要做的就是打电话

```
context.startActivity(intent) 
```

代替

```
startActivity(intent); 
```

因为[上下文](http://developer.android.com/reference/android/content/Context.html#startActivity%28android.content.Intent%29)可以启动活动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T04:05:52.670

您可以将对象活动类传递给适配器，从中调用适配器。然后使用该对象调用 startActivity。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T03:32:23.677

```
 ((Button)listItemView.findViewById(R.id.listItemMap)).setOnClickListener(
                new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {

                   Intent intent = new Intent(A.alias,B.class);

                        A.alias.startActivity(intent);
                    }
                }); 
```

# jquery - 交互后jquery不监听数据元素

> ID：13983131
> 
> 赞同：1
> 
> 时间：2012-12-21T01:36:43.963
> 
> 标签：jquery, twitter-bootstrap

我不确定这个最好的标题...

[此处提供实时链接](http://dev.schlagelassociates.com/News/Publications)

我对这个项目的总体目标。有些文件需要电子邮件才能下载。通过asp.net，我绑定了一个转发器，然后用jquery删除href并将其放在rel标签中，直到他们添加他们的电子邮件地址。

```
$('a[data-email="True"]').each(function () {
    var href = $(this).attr('href');
    $(this).attr('href', '#_');
    $(this).attr('rel', href);
}); 
```

jquery 检查`data-email`标签是否为“True”，如果是，`bootstrap modal`则将弹出并通过`ajax`表单调用 a`web method`并将电子邮件添加到数据库中，如果它不是重复的。

```
$('.emailcheck').live("click", function (e) {        
    if ($(this).data("email") == "True") {
        $('#emailModal').modal();
    }
}); 
```

成功后，模式将关闭，并在每个`data-email="True"`链接上添加回`href`并将`data-email`设置为 False

```
$('#emailModal').modal('hide');
$('body a[data-email="True"]').each(function () {
    var reltag = $(this).attr('rel');
    $(this).attr('href', reltag);
    $(this).attr('data-email', 'False');
}); 
```

所有这一切都成功发生，并且电子邮件会在另一次单击时下载。但是，当我单击下载链接时，模式仍然会弹出。

有人可以指导我解决为什么模态仍然弹出的解决方案。另外在成功脚本中有没有办法自动触发下载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:14:46.257

试试这个 - 变化不大，但这里有一个[jsFiddle](http://jsfiddle.net/jKmKZ/)显示它应该可以工作

**加载函数**

```
$('.emailcheck').each(function() {
    var href = $(this).attr('href');
    $(this).attr('href', '#_').attr('rel', href);
}); 
```

**点击事件**

```
$(document).on("click", '.emailcheck', function(e) {
    e.preventDefault()
    if ($(this).attr("data-email") == "True") {
        $('#emailModal').modal();
    }
}); 
```

**邮件提交功能**

```
$('#emailModal').modal('hide');
$('.emailcheck').each(function() {
    var reltag = $(this).attr('rel');
    $(this).attr('href', reltag).attr('data-email', 'False');
}); 
```

# javascript - wymeditor - 在样式表中格式化标题

> ID：13983133
> 
> 赞同：3
> 
> 时间：2012-12-21T01:36:57.733
> 
> 标签：javascript, html, css, wysiwyg, wymeditor

**我正在尝试在 wymeditor 中使用与我网站上相同的样式。**不幸的是，这个编辑器几乎没有记录，所以我真的不知道该怎么做。

该[文档](http://trac.wymeditor.org/trac/wiki/0.5/Customization.html)暗示您可以使用样式表，您可以在其中以某种形式定义所有内容，并且它将在编辑器中被解析和使用。我可以这样做，但只能使用类（右侧面板上的第二个框）。该文档提供了一个示例，但仅适用于类，而不适用于容器。有一个指向完整样式表的链接，但它是一个死链接，示例中使用的[样式表](http://files.wymeditor.org/wymeditor-1.0.0b2/examples/styles.css)只定义了类，没有定义容器。

**那么我将如何在编辑器中制作一个红色的 h1 呢？或者至少在预览中。**

如果有人链接或提供样式表的完整示例，我将非常高兴，其中 h1 和 p 之类的容器也被格式化并在编辑器中使用。如果这是不可能的，还有什么其他方法可以做到这一点？

* * *

**编辑：**

我可以使用 postInit 将 CSS 注入 iframe：

```
postInit: function(wym) {
    var $head = $(wym._box).find('iframe').contents().find("head");
    $head.append($("<link/>", { 
        rel: "stylesheet",
        href: costumIframeCss,
        type: "text/css"
     }));
} 
```

现在我唯一需要做的就是对预览对话框做类似的事情。也许使用**postInitDialog(wym,wdw)**。我还真不知道怎么做。最大的问题是我需要将预览对话框与其他对话框区分开来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T17:50:42.050

**更新**：

我看到您在`wdw`使用时可以访问对话框窗口`postInitDialog`。这很酷。您的操作方式（查看您的更新）与 Dialoglog 一样

看下图。我调试了预览对话框，因为它打开了。
看线号。`41`

![检查预览](../Images/5c706b82dd77315df390b5df66d009de.png)

按照您对编辑器所做的操作，可以对 Preview At 行执行相同操作。`41`，你可以`head`用同样的方式获取和追加样式

```
var $head = $(wdw.document.body);
$head.append($("<link/>", { 
    rel: "stylesheet",
    href: customPreviewCss, // CSS for Preview Dialog
    type: "text/css"
})); 
```

**初步答案**：

据我了解，您希望样式在编辑时生效。理想情况下，要`h1`在编辑（或任何此类自定义）时制作红色，您只有以下选项：

*   使用正确的类，如文档中所述 - 编辑器的真正目的就是这样。定制应该在现有的基础上进行
*   **编辑您已链接或**在编辑器处于活动状态时加载****的默认样式表**（您可以使用检查元素检查）这将在下面解释**

 **我看到当您使用编辑器时，它会以`iframe`. 安`iframe`有**自己的风格**。现在，检查元素。在您的情况下，它是一个`h1`，但我使用的`p`是示例中的标签

![检查编辑器本身](../Images/55aad9ec52be2e2a683dc98fbc0c266a.png)

看到它**从另一个文件**加载样式- `wymiframe.css`，行号。`51`对于`p`标签

因此，如果您想更改或添加自己的样式，请转到该文件。（如果您将鼠标悬停，您将获得文件路径，或右键单击并*在新选项卡中打开*并从地址栏中检查）
**添加或编辑**那里的样式`h1`。完毕。
此外，您可以转到`html`文件`wymeditor/iframe/default`夹中的相应文件。将您的自定义添加`link`到您自己的 css 文件中。在这个文件中，做所有需要的定制:)

希望它有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T05:26:56.183

如您所见，这些只是示例。您不能将其用作在线编辑器。您必须下载并尝试使用它。

```
http://files.wymeditor.org/wymeditor-0.5/examples/ 
```

上面显示了示例列表。因为您已尝试使用第一个链接。

要下载它，请访问此链接。

```
http://www.wymeditor.org/download/ 
```

选择最近的稳定版本以减少缺陷。

希望这可以帮助。

正如您所要求的，它在预览中效果很好，提交时没有任何反映。

要在预览中实现这一点，请单击倒数第二个位置的 HTML 图标。

编写您自己的代码，单击预览会在一个新的弹出窗口中获得您的结果。**

# javascript - 原型链 - 在一个对象上设置键会影响兄弟对象？

> ID：13983137
> 
> 赞同：0
> 
> 时间：2012-12-21T01:37:34.277
> 
> 标签：javascript, google-apps-script

我正在处理我的第一个涉及继承和原型链的 JS 项目，我很困惑为什么使用特定数据创建一个对象会影响我的第二个对象上已经存在的数据。**目标是在“父”对象的full_params**对象文字中拥有一组基本默认值，并在“子”对象的**default_params**对象文字中拥有一些更具体的默认值。子对象**specificRequest**为其构造函数获取一个数组参数，将这些参数添加到其 default_params，然后调用其原型的 setOptions 函数将这些参数添加到 full_params。

问题是，当我创建一个 specificRequest 对象并对其进行初始化时，它工作正常，但是当我创建第二个 specificRequest 对象时，full_params 已经与第一个相同。

由于对原型如何工作的误解，这可能是非常简单的事情......

```
/////// PARENT OBJECT

function baseRequest(custom_params) {

    var key;

    this.full_params = {
        "SignatureVersion": "2",
        "Timestamp": Utilities.formatDate(new Date(), "GMT", "yyyy-MM-dd'T'HH:mm:ss'Z'")
    };

    this.custom_params = custom_params;

}

baseRequest.prototype.setOptions = function(arg_options) {
    var key;

    if (typeof arg_options === "object") this.custom_params = arg_options;

    // If an object of request options is passed, use that. Otherwise use whatever is already in the custom_params object.
    for (key in this.custom_params) {
        this.full_params[key] = this.custom_params[key];
    }

}

///////// CHILD OBJECT

function specificRequest(mySKUList) {
    var i;
    this.mySKUList = mySKUList;

    this.default_params = {
        "Action": "myAction",
        "Version": "2011-10-01"
    };

    for (i = 0; i < this.mySKUList.length; i++) {
        var temp_sku = this.mySKUList[i];
        var temp_sku_name = "SellerSKUList.SellerSKU." + (i + 1);
        this.default_params[temp_sku_name] = temp_sku;
    }

    this.setOptions(this.default_params);
}

specificRequest.prototype = new baseRequest

///// Function to run

function testfoo() {

    var skulist1 = ["AR6100", "AR6102", "WB1234"]
    var skulist2 = ["XY9999"]

    var req1 = new specificRequest(skulist1);
    var req2 = new specificRequest(skulist2);

    // Req1 has AR6100, AR6102, and WB1234 as parameters, as expected
    // Req2 should only have XY9999, but instead has XY9999, AR6102, and WB1234
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:40:41.657

好吧，您已经将父类的具体实例绑定为子类的原型，如下所示：

```
specificRequest.prototype = new baseRequest 
```

相反，根本不实例化父类：

```
specificRequest.prototype = Object.create( baseRequest.prototype ); 
```

`super()`此外，在构造子实例时调用等价物：

```
function specificRequest(mySKUList) {
     baseRequest.call( this );

     ...
} 
```

并且请以大写字母开头的构造函数名称。

# flexigrid - flexAddData 无法正常工作

> ID：13983139
> 
> 赞同：0
> 
> 时间：2012-12-21T01:37:49.917
> 
> 标签：flexigrid

我直接在 flexigrid 中添加行，我尝试直接更新行但 flexAddData 总是显示旧行。如何直接更新行？任何想法 ？请帮助我很抱歉我的英语不好

```
 if ( flag == 'add' ){ 
        $.ajax({
        type    : "POST",
        url : "tr_procurement_data.php",
        data    : "process=prod_name&id_prod="+id_prod+"&qty_pad="+qty_pad+"&hb_pad="+hb_pad ,
        dataType : "json",                
        success : function(data){
            //add record to array
            rows.push({id: [data.id_prod], cell: [ data.id_prod, data.nm_prod, data.qty_pad, data.hb_pad ] });
            data = {
                total: 1,    
                page:1,
                rows: rows}
            $("#flex1").flexAddData(data);
        }
        });
    } 
    if ( flag == 'edit' ){  

        var fgrid = getAllRow();   //save array
        var fleng = fgrid.length;
        fgrid.forEach(function(row) { alert(row);
            if ( id_prod == row[0] ){
                rows.push({id: [row[0]], cell: [ row[0], row[1], qty_pad, hb_pad ] });
            }else{
                rows.push({id: [row[0]], cell: [ row[0], row[1], row[2], row[3] ] });
            }
        }); 
        data = {    total: fleng,  page:1,  rows: rows}

        deleteRow();
        $("#flex1").flexAddData(eval(data));            

    }    
}

function deleteRow() { 
  $("[id^=row]").each(function() { 
        $(this).find('div').each(function() {  alert( $(this).html() );
            $(this).remove();
     });
    });
}

function getAllRow() {
    var arrReturn        = [];
    $("[id^=row]").each(function() {
            var arrRow                = [];
            $(this).find('div').each(function() {
                    arrRow.push( $(this).html() );
            });
            arrReturn.push(arrRow);
    });
    return arrReturn; 
} 
```

那是我的代码希望

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T14:27:08.533

为什么不使用 flexReload？这将刷新网格中的当前数据

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-02T21:23:05.147

你需要这个：

```
$("#flex1").flexigrid({

  dataType : 'json',
  colModel : [{ ... }]

}).flexAddData({

  total: 1, 
  page: 1, 
  rows: [{ cell: [ "value1", "value2", "value3"] }] 

}); 
```

# android - Shape Drawable gradientRadius 仅适用于像素。这不是没用吗？% 值不起作用

> ID：13983141
> 
> 赞同：16
> 
> 时间：2012-12-21T01:38:13.077
> 
> 标签：android, android-drawable

我想使用具有径向渐变的可绘制形状作为视图的背景。根据 javadoc，渐变的半径可以设置为特定值（可能是像素）或百分比：

> **机器人：渐变半径**
> 
> 渐变的半径，仅用于径向渐变。
> 
> 可能是浮点值，例如“1.2”。
> 
> 可能是一个小数值，它是一个附加了 % 或 %p 的浮点数，例如“14.5%”。% 后缀始终表示基本大小的百分比；可选的 %p 后缀提供了相对于某些父容器的大小。

如果我错了，请纠正我，但在这里使用像素值是完全没用的，因为这个渐变看起来从一个屏幕密度到另一个屏幕密度完全不同（经过测试，是的，这是真的）。我尝试使用 % 和 %p 值，但它们根本不起作用。

我深入研究了 Android 源代码以查看如何处理 gradientRadius 并在 GradientDrawable 类中找到了这个：

```
TypedValue tv = a.peekValue(
    com.android.internal.R.styleable.GradientDrawableGradient_gradientRadius);
    if (tv != null) {
        boolean radiusRel = tv.type == TypedValue.TYPE_FRACTION;
        st.mGradientRadius = radiusRel ?
         tv.getFraction(1.0f, 1.0f) : tv.getFloat();
    } else ...
} 
```

啊哈！因此，所有添加 % 或 %p 所做的就是将我的值除以 100。（我对此进行了测试，因为 TypeValue.getFraction() 的文档更加不清楚）。65% 变为 0.65。有道理，但没有任何用处。

那么使用 gradientRadius 的最佳方法是什么？

PS。我已经使用 GradientDrawable 以编程方式添加了我的背景，并且得到了想要的结果。我使用 GradientDrawable.setGradientRadius() 和一个相对于视图宽度的值，并在设备之间获得一致的渐变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-29T07:12:32.677

要使用所有屏幕尺寸，您必须在 dp 中设置半径。您可以通过这种方法从dp计算px

```
 public float pxfromDp(float dp) {
    return dp * getResources().getDisplayMetrics().density;
} 
```

所以例如你想设置`GradientDrawable.setGradientRadius(pxfromDp(7));`

# ruby-on-rails - 如何实现同一模型的嵌套实例？例如类别中的类别？

> ID：13983144
> 
> 赞同：0
> 
> 时间：2012-12-21T01:38:33.483
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个`category`模型，基本上就是`products`分配给它的模型。

所以我的`category`模型看起来像这样：

```
attr_accessible :name
has_many :category_products do
  def with_products
    includes(:product)
  end
end

has_many :products, :through => :category_products 
```

我想做的是在类别中包含类别 - 因此应该能够放入产品`Men`然后`Shoes`。

这样，我可以有一个`Men`下拉菜单，它会生成`Men`like中的所有子类别`Shoes`。

但是，如果用户点击，`Men`他们将看到该类别中的所有产品。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:42:03.627

您可以使用[Ancestry 之](https://github.com/stefankroes/ancestry)类的 gem将您的类别组织成层次结构。

如果您只需要一层深度的嵌套，则可以使用自联接。

```
belongs_to :parent_category, class: "Category"
has_many :subcategories, class: "Category" 
```

您还需要迁移才能添加`category_id`到您的`category`表中。

`app/views/categories/_form.html.erb`在您的for中粘贴一个下拉列表，`category_id`并用您的类别列表填充它。您可以使用它为您的类别选择“父级”。

然后你可以做类似的事情：

```
# Get parent category's name
<%= somecategory.parent.name %>

# Iterate through subcategories
<% someothercategory.subcategories.each do |category| %>
  <%= category.name %>
<% end %> 
```

不过，在使用这些类别及其关联时，使用 Ancestry 之类的 gem 将为您提供更多的灵活性。

关于祖先如何工作的一点：

> Ancestry 为每个节点存储从根到父节点的路径。这是物化路径数据库模式的一种变体。它允许 Ancestry 在单个 SQL 查询中获取任何关系（兄弟姐妹、后代等），而无需复杂的算法和与左右值相关的不可理解性。此外，任何插入、删除和更新只会影响受影响节点自己的子树中的节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:09:37.307

我不知道 Ancestry gem 是如何工作的，但在嵌套解决方案中，主要关注的是 - 速度。如果模型类别不受高频创建的影响，请尝试[awesome_nested_set](https://github.com/collectiveidea/awesome_nested_set)。它不仅使用 parent_id，而且使用 :lft 和 :rgt 列，当孩子非常非常多时，它们可以显着加快相互嵌套对象的搜索速度...... 30-50 个类别和数千种产品 - 就是这种情况之一。

# php - HTMLPurifier 将 > 转换为 >

> ID：13983152
> 
> 赞同：0
> 
> 时间：2012-12-21T01:39:56.160
> 
> 标签：php, htmlpurifier

我正在使用带有输入文本区域的 HTMLPurifier，用户可以在其中放置他们的 HTML 标记。配置是默认的：

```
 $config = HTMLPurifier_Config::createDefault();
        $purifier = new HTMLPurifier($config);
        $_POST['txt'] = $purifier->purify($_POST['txt']); 
```

我遇到的问题是当用户`>`在文本中添加一些内容时，例如：

```
<p>Some text > other text </p> 
```

这将转换为：

```
<p>Some text &gt; other text </p> 
```

有没有办法阻止这种转换？不做遗忘：

```
$_POST['txt'] = str_replace('&gt;','>',$_POST['txt']); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:57:34.213

你可能知道`&gt;`html 的特殊字符`>`。浏览器将正确渲染所有内容。

您可以尝试使用[htmlspecialchars_decode](http://php.net/manual/en/function.htmlspecialchars-decode.php)将所有特殊字符解码为原始值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T06:26:49.390

如果没有发生这种转换，则 HTML 将无效。如果这就是你想要的，可能会有一个配置选项。

# netty - 是否可以在同一个应用程序中使用 Netty 3.x 和 4.0，还是会出现类名冲突？

> ID：13983155
> 
> 赞同：3
> 
> 时间：2012-12-21T01:40:30.300
> 
> 标签：netty, side-by-side

我正在评估将 netty 4 用于未来的一些工作，但它必须在我们现有的 webapp 逻辑中工作，由于我们需要一些第三方库，它间接依赖于 Netty 3.x。

我知道在 netty 4.0 中有重大的重构。因此，我想知道是否可以在同一个应用程序中同时使用两者，或者是否仍有一些重叠会导致类名冲突，或者可能是其他一些 [不太明显的] 副作用。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T13:04:38.950

是的，有可能... Netty 3 使用 org.jboss.netty 作为包名，而 Netty 4 使用 io.netty，所以完全没有问题。

# python - python中的透视投影和旋转

> ID：13983162
> 
> 赞同：2
> 
> 时间：2012-12-21T01:40:49.190
> 
> 标签：python, rotation, projection, perspective

我试过搜索，但其他问题似乎都不像我的。我或多或少地在 python 中尝试透视投影和旋转，并且遇到了障碍。我确信我的投影方程和旋转方程都是准确的；但是，当我运行它时，旋转开始正常，但开始向内旋转，直到矢量与 Z 轴（我正在旋转的轴）处于相同位置。

```
''' Imports '''
from tkinter import Tk, Canvas, TclError
from threading import Thread
from math import cos, sin, radians, ceil
from time import sleep

''' Points class '''
class pPoint:
    def __init__(self, fPoint, wWC, wHC):
        self.X = 0
        self.Y = 0
        self.Z = 0
        self.xP = 0
        self.yP = 0
        self.fPoint = fPoint
        self.wWC = wWC
        self.wHC = wHC

    def pProject(self):
        self.xP = (self.fPoint * (self.X + self.wWC)) / (self.fPoint + self.Z)
        self.yP = (self.fPoint * (self.Y + self.wHC)) / (self.fPoint + self.Z)

''' Main class '''
class Main:
    def __init__(self):
        ''' Declarations '''
        self.wWidth = 640
        self.wHeight = 480

        self.fPoint = 256

        ''' Generated declarations '''
        self.wWC = self.wWidth / 2
        self.wHC = self.wHeight / 2

        ''' Misc declarations '''
        self.gWin = Tk()

        self.vPoint = pPoint(self.fPoint, self.wWC, self.wHC)

        self.vPoint.X = 50
        self.vPoint.Y = 60
        self.vPoint.Z = -25
        self.vPoint.pProject()

        self.ang = 0

    def initWindow(self):
        self.gWin.minsize(self.wWidth, self.wHeight)
        self.gWin.maxsize(self.wWidth, self.wHeight)

        ''' Create canvas '''
        self.gCan = Canvas(self.gWin, width = self.wWidth, height = self.wHeight, background = "black")
        self.gCan.pack()

    def setAxis(self):
        ''' Create axis points '''
        self.pXax = pPoint(self.fPoint, self.wWC, self.wHC)
        self.pXbx = pPoint(self.fPoint, self.wWC, self.wHC)
        self.pYax = pPoint(self.fPoint, self.wWC, self.wHC)
        self.pYbx = pPoint(self.fPoint, self.wWC, self.wHC)
        self.pZax = pPoint(self.fPoint, self.wWC, self.wHC)
        self.pZbx = pPoint(self.fPoint, self.wWC, self.wHC)

        ''' Set axis points '''
        self.pXax.X = -(self.wWC)
        self.pXax.Y = 0
        self.pXax.Z = 1
        self.pXbx.X = self.wWC
        self.pXbx.Y = 0
        self.pXbx.Z = 1
        self.pYax.X = 0
        self.pYax.Y = -(self.wHC)
        self.pYax.Z = 1
        self.pYbx.X = 0
        self.pYbx.Y = self.wHC
        self.pYbx.Z = 1
        self.pZax.X = 0
        self.pZax.Y = 0
        self.pZax.Z = -(self.fPoint) / 2
        self.pZbx.X = 0
        self.pZbx.Y = 0
        self.pZbx.Z = (self.fPoint * self.wWC) - self.fPoint

    def projAxis(self):
        ''' Project the axis '''
        self.pXax.pProject()
        self.pXbx.pProject()
        self.pYax.pProject()
        self.pYbx.pProject()
        self.pZax.pProject()
        self.pZbx.pProject()

    def drawAxis(self):
        ''' Draw the axis '''
        self.gCan.create_line(self.pXax.xP, self.pXax.yP, self.pXbx.xP, self.pXbx.yP, fill = "white")
        self.gCan.create_line(self.pYax.xP, self.pYax.yP, self.pYbx.xP, self.pYbx.yP, fill = "white")
        self.gCan.create_line(self.pZax.xP, self.pZax.yP, self.pZbx.xP, self.pZbx.yP, fill = "white")

    def prePaint(self):
        self.vA = self.gCan.create_line(self.wWC, self.wHC, self.vPoint.xP, self.vPoint.yP, fill = "red")

    def paintCanvas(self):
        try:
            while True:
                self.ang += 1
                if self.ang >= 361:
                    self.ang = 0

                self.vPoint.X = (self.vPoint.X * cos(radians(self.ang))) - (self.vPoint.Y * sin(radians(self.ang))) 
                self.vPoint.Y = (self.vPoint.X * sin(radians(self.ang))) + (self.vPoint.Y * cos(radians(self.ang)))
                self.vPoint.pProject()

                self.gCan.coords(self.vA, self.wWC, self.wHC, self.vPoint.xP, self.vPoint.yP)

                self.gWin.update_idletasks()
                self.gWin.update()

                sleep(0.1)
        except TclError:
            pass

mMain = Main()

mMain.initWindow()
mMain.setAxis()
mMain.projAxis()
mMain.drawAxis()
mMain.prePaint()
mMain.paintCanvas() 
```

感谢您的任何输入:)

编辑：对不起，我刚刚意识到我忘了提出我的问题。我只想知道为什么它向内吸引，而不仅仅是“正常”旋转？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:06:58.823

实际上与您的问题无关，但我强烈建议您使用 Numpy 执行几何变换，特别是如果它涉及 3D 点。

下面，我发布一个示例片段，希望对您有所帮助：

```
import numpy
from math import radians, cos, sin

## suppose you have a Nx3 cloudpoint (it might even be a single row of x,y,z coordinates)
cloudpoint = give_me_a_cloudpoint()

## this will be a rotation around Y azis:
yrot = radians(some_angle_in_degrees)

## let's create a rotation matrix using a numpy array
yrotmatrix = numpy.array([[cos(yrot), 0, -sin(yrot)],
                          [0,         1,          0],
                          [sin(yrot), 0,  cos(yrot)]], dtype=float)

## apply the rotation via dot multiplication
rotatedcloud = numpy.dot(yrotmatrix, pointcloud.T).T   # .T means transposition 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:51:07.310

这一段是错的：

```
self.ang += 1
if self.ang >= 361:
    self.ang = 0

self.vPoint.X = (self.vPoint.X * cos(radians(self.ang))
               - self.vPoint.Y * sin(radians(self.ang))) 
self.vPoint.Y = (self.vPoint.X * sin(radians(self.ang))
               + self.vPoint.Y * cos(radians(self.ang)))
self.vPoint.pProject() 
```

有两个原因：

1.  `self.ang`将采用开放范围 [0 - 360] 内的整数，这意味着重复角度 360 (== 0)。
2.  *在每次迭代中，您将前一次迭代*中的点旋转角度。结果，您的第一帧为 1 度，第二帧为 1+2 = 3，第三帧为 1 + 2 + 3... 您应该是：
    *   每次将前一次迭代中的点旋转一个恒定角度（1°）。这受到我评论中提到的问题的影响
    *   每次将*初始点旋转当前的旋转角度*

# c - 在 C 中使用 Erastosthenes 筛法的素数

> ID：13983167
> 
> 赞同：2
> 
> 时间：2012-12-21T01:41:27.180
> 
> 标签：c, primes, sieve-of-eratosthenes

我编写了以下程序来显示最多 150 的所有素数。它根本没有执行。它有什么问题？

```
# include <stdio.h>
int main(void)
{
    int p[150], i, j;

    for (i = 2; i < 150; i++)
        p[i] = 0;

    i = 2;

    while (i < 150){

        if (p[i] == 0)
            printf("%i ", i);

        for (j = 1; i*j <= 150; j++)
            p[i*j] = 1;

        i++;
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T01:47:32.827

1.  您正在访问`p[i*j]`，它超出了有效的*[0-149]*范围。当等于 150时，条件`i*j <= 150`将评估为真，即相差一。`i*j`应该是`i*j < 150`。
2.  标准输出流被缓冲。您需要在循环结束时刷新。尝试添加一个`fflush(stdout)`.
3.  可能不太重要，但是如果您关心结果数组（例如：想稍后使用它），则值`p[2]`会错误地设置为 1。但是，您的程序仍会打印 2，但那是因为您的循环之前打印了数字改变 的值`p[i*j]`。最后，数字打印正确，但数组中的值并不完全正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T01:53:18.993

`i*j <= 150`是不正确的，应该是`i*j < 150`，因为`p`数组有从`0`到的元素`149`。程序因此陷入无限循环。

**编辑：**这个答案的其余部分是不正确的，所以我把它删除了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T01:49:18.167

作为学习练习，尝试添加一些 printf 来了解您的程序的功能。

还要记住，正如 jweyrich 所说，没有 \n 的 printf 将不会输出任何内容，直到（可能）程序退出。

# performance - 初学者 Python：如何减少程序中的列表数量并优化以下程序

> ID：13983168
> 
> 赞同：0
> 
> 时间：2012-12-21T01:41:29.423
> 
> 标签：performance, list, optimization, memory-management, python-2.7

我编写了以下程序来生成未来三年我可能拥有的所有可能的时间表（我在季度系统上）但它的效率低得离谱，而且正如所写的那样，在接下来的一百万年里不会给我答案.

为了澄清，我确实已经编写了文本文件，指定了我感兴趣的课程以及每个季度的数字、期限和年份（例如，2013-2014 年第 1 季度秋季）。我想将其限制为每季度生成 4-5 节课的时间表，希望在程序中有所体现。

我知道，考虑到所需结果的大小，我写这个的任何方式都会非常慢，但是如果有人可以帮助我加快速度，或者至少给我一个估计需要多长时间才能完成（ 24 小时或 24 个月）我将非常感激。

我已经确定但我不知道如何解决的两个问题是：

1.  我的比较功能（将列表转换回列表，然后在列表的每个成员中搜索另一个列表的每个成员）
2.  一般来说，列表的广泛使用，根据我的研究，它非常占用内存（例如，我使用的组合函数会生成一个迭代器对象，根据我的研究，它应该比列表更有效，但我没有知道如何有效地使用迭代器，从而减少内存使用；还有我在程序结束时使用的“GrandMasterLists”方法，结合所有的双 for 循环和线性增加的比较函数调用次数每个 for 循环，也必须使这比它需要的效率低得多）。

以下内容很长（177 行）（尽管也是重复的），但如果您正在寻找挑战或者您是编程专家，我将非常感谢您的帮助。

（我也意识到我在每一点上尝试做的很多事情可能不是很透明——在很多时候我都很难想出与我想要做的代码相匹配的代码——所以如果您需要澄清，请向我提问。）

```
import itertools

class Course:
    def __init__(self, NAME, TERM, YEAR):
        self.term=TERM
        self.year=YEAR
        self.name=NAME

class Quarter:
    def __init__(self, NUMBER, TERM, YEAR):
        self.term=TERM
        self.year=YEAR
        self.number=NUMBER

courselist=[]

def coursegen(NAME, TERM, YEAR):

    return Course(NAME, TERM, YEAR)

f=open('classlist.txt', 'r')
for line in f:
    courselist.append(coursegen(line.rstrip().split(';')[0],line.rstrip().split(';')    [1].split(','),line.rstrip().split(';')[2].split(','))) 
f.close()       

def quartergen(NUMBER,TERM,YEAR):
    return Quarter(NUMBER,TERM,YEAR)

m=open('quarterlist.txt', 'r')

line1=m.readline()
line2=m.readline()
line3=m.readline()
line4=m.readline()
line5=m.readline()
line6=m.readline()
line7=m.readline()
line8=m.readline()
line9=m.readline()

Quarter1=quartergen(line1.rstrip().split(';')[0],line1.rstrip().split(';')[1].split(','),line1.rstrip().split(';')[2].split(','))
Quarter2=quartergen(line2.rstrip().split(';')[0],line2.rstrip().split(';')[1].split(','),line2.rstrip().split(';')[2].split(','))
Quarter3=quartergen(line3.rstrip().split(';')[0],line3.rstrip().split(';')[1].split(','),line3.rstrip().split(';')[2].split(','))
Quarter4=quartergen(line4.rstrip().split(';')[0],line4.rstrip().split(';')[1].split(','),line4.rstrip().split(';')[2].split(','))
Quarter5=quartergen(line5.rstrip().split(';')[0],line5.rstrip().split(';')[1].split(','),line5.rstrip().split(';')[2].split(','))
Quarter6=quartergen(line6.rstrip().split(';')[0],line6.rstrip().split(';')[1].split(','),line6.rstrip().split(';')[2].split(','))
Quarter7=quartergen(line7.rstrip().split(';')[0],line7.rstrip().split(';')[1].split(','),line7.rstrip().split(';')[2].split(','))
Quarter8=quartergen(line8.rstrip().split(';')[0],line8.rstrip().split(';')[1].split(','),line8.rstrip().split(';')[2].split(','))
Quarter9=quartergen(line9.rstrip().split(';')[0],line9.rstrip().split(';')[1].split(','),line9.rstrip().split(';')[2].split(','))

m.close()   

def compare(x, y):

    if set(x).isdisjoint(set(y))==False:
    return True
else:
        return False

def offeredcoursegen(Quarter, courselist):
    offered=[]

    for course in courselist:

        if compare(course.year, Quarter.year)==True and compare(course.term, Quarter.term)==True:

            offered.append(course)

    return offered

def combo(x, courselist):   
    return list(itertools.combinations(offeredcoursegen(x,courselist), 4))+list(itertools.combinations(offeredcoursegen(x,courselist), 5))

Combo1=combo(Quarter1, courselist)

Combo2=combo(Quarter2, courselist)

Combo3=combo(Quarter3, courselist)

Combo4=combo(Quarter4, courselist)

Combo5=combo(Quarter5, courselist)

Combo6=combo(Quarter6, courselist)

Combo7=combo(Quarter7, courselist)

Combo8=combo(Quarter8, courselist)

Combo9=combo(Quarter9, courselist)

GrandMasterList=[]

for i in Combo1:
    for j in Combo2:
        if compare(i, j)==False:
            GrandMasterList.append([i,j])

GrandMasterList2=[]

for i in GrandMasterList:
    for j in Combo3:
        if compare(i[0],j)==False and compare(i[1],j)==False:
            GrandMasterList2.append(i+[j])

GrandMasterList3=[]

for i in GrandMasterList2:
    for j in Combo4:
        if compare(i[0],j)==False and compare(i[1],j)==False and    compare(i[2],j)==False:
            GrandMasterList3.append(i+[j])

GrandMasterList4=[]

for i in GrandMasterList3:
    for j in Combo5:
        if compare(i[0],j)==False and compare(i[1],j)==False and compare(i[2],j)==False and compare(i[3],j)==False:
            GrandMasterList4.append(i+[j])

GrandMasterList5=[]

for i in GrandMasterList4:
    for j in Combo6:
        if compare(i[0],j)==False and compare(i[1],j)==False and compare(i[2],j)==False and compare(i[3],j)==False and compare(i[4],j)==False:
            GrandMasterList5.append(i+[j])

GrandMasterList6=[]

for i in GrandMasterList5:
    for j in Combo7:
        if compare(i[0],j)==False and compare(i[1],j)==False and compare(i[2],j)==False and compare(i[3],j)==False and compare(i[4],j)==False and compare(i[5],j)==False:
            GrandMasterList6.append(i+[j])

GrandMasterList7=[]

for i in GrandMasterList6:
    for j in Combo8:
        if compare(i[0],j)==False and compare(i[1],j)==False and compare(i[2],j)==False and compare(i[3],j)==False and compare(i[4],j)==False and compare(i[5],j)==False and compare(i[6],j)==False:
            GrandMasterList7.append(i+[j])

GrandMasterList8=[]

for i in GrandMasterList7:
    for j in Combo9:
        if compare(i[0],j)==False and compare(i[1],j)==False and compare(i[2],j)==False and compare(i[3],j)==False and compare(i[4],j)==False and compare(i[5],j)==False and compare(i[6],j)==False and compare(i[7], j)==False:
            GrandMasterList8.append(i+[j])

for i in range(len(GrandMasterList8)):
    print 'Schedule %d \n' % (i)
    print 'Quarter 1'
    for j in range(len(GrandMasterList8[i][0])):
    print '%s ' % (GrandMasterList8[i][0][j].name)
print '\n Quarter 2'
for j in range(len(GrandMasterList8[i][1])):
    print '%s ' % (GrandMasterList8[i][1][j].name)
print '\n Quarter 3'
    for j in range(len(GrandMasterList8[i][2])):
        print '%s ' % (GrandMasterList8[i][2][j].name)
print '\n Quarter 4'
    for j in range(len(GrandMasterList8[i][3])):
        print '%s ' % (GrandMasterList8[i][3][j].name)
    print '\n Quarter 5'
    for j in range(len(GrandMasterList8[i][4])):
        print '%s ' % (GrandMasterList8[i][4][j].name)
    print '\n Quarter 6'
    for j in range(len(GrandMasterList8[i][5])):
        print '%s ' % (GrandMasterList8[i][5][j].name)
    print '\n Quarter 7'
    for j in range(len(GrandMasterList8[i][6])):
        print '%s ' % (GrandMasterList8[i][6][j].name)
    print '\n Quarter 8'
    for j in range(len(GrandMasterList8[i][7])):
        print '%s ' % (GrandMasterList8[i][7][j].name)
    print '\n Quarter 9'
    for j in range(len(GrandMasterList8[i][8])):
        print '%s ' % (GrandMasterList8[i][8][j].name)
    print '\n \n \n' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:50:39.387

@Joshua D. Boyd
这不是答案，但由于某种原因，我无法在评论中清楚地格式化 classlist.txt 的示例。
无论如何，这是一个例子：

德语 209-0;S;13-14,14-15,15-16
德语 309-1;F;14-15,15-16,16-17
德语 309-2;W;14-15,15-16 ,16-17
实盘分析 1;F;13-14,14-15,15-16,16-17
实盘分析 2;W;13-14,14-15,15-16,16-17
实盘分析 3; S;13-14,14-15,15-16,16-17
有机化学 1;F;13-14,14-15,15-16,16-17
有机化学 2;W;13-14,14- 15,15-16,16-17
有机化学 3;S;13-14,14-15,15-16,16-17
微分几何;F;13-14,14-15,15-16,16-17
统计 383-0;W;13-14,14-15,15-16,16-17
经济 381-1;W;13-14,14-15,15-16,16-17
数学 325-0;W ;13-14,15-16

等等

当然，整个列表大约有 90 个课程，程序必须对这些课程进行排序以得出每个季度可用的大约 10 到 20 个课程，然后为每个季度提出这些课程的所有可能组合，然后结合每个季度不重叠课程的组合（即，因此我没有得到包含同一课程不止一次的时间表）。

如果这也有帮助，这里是 Quarterlist.txt：
1;F;13-14
2;W;13-14
3;S;13-14
4;F;14-15
5;W;14-15
6;S; 14-15
7;F;15-16
8;W;15-16
9;S;15-16

我希望这比我以前的方法更有帮助。当我在终端中使用 python 编译器运行上述程序时，甚至需要很长时间才能返回中间步骤（我在整个过程中插入了几行打印行以检查其进度，十分钟后我只得到了“组合”）。考虑到初步步骤需要多长时间才能完成，并且理论上每个“GrandMasterList”的计算时间都比上一个要长，至少在我生成它们的方式上，似乎这个程序需要花费不合理的长时间才能完成。

主要是我想提出一个更有效的方法：
比较函数
方法来生成“GrandMasterList”（即组合每个季度的所有类组合，以便每个组合的类没有重叠）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T21:25:58.800

您发布的示例数据不够长，因此需要很长时间。

您可以通过执行以下操作来分析您的程序：

```
python2.6 -m cProfile ./your_program.py 
```

它会告诉你每个函数被调用的次数和一堆其他的统计数据。

在您的组合函数中，您采用两个迭代器并将它们转换为列表以返回组合列表。如果您将组合重写为本身是一个迭代器，那可能会给您带来一些收益。

比较可以更简单地写成：

```
def compare(x, y):
    return not set(x).isdisjoint(set(y)) 
```

# php - PHP preg_match 和正则表达式：小写字母只能带有连字符、数字或字母，并且至少有 6 个字符？

> ID：13983172
> 
> 赞同：1
> 
> 时间：2012-12-21T01:41:43.307
> 
> 标签：php, regex, preg-match, lowercase

我只想接受**带有连字符、数字或字母且至少 6 个字符**的小写字母的输入。但只要输入长度超过 6 个字符，下面的正则表达式就接受大写。

```
$user_name = 'BloggerCathrin';

if(!preg_match('/([a-z0-9]{6}|[a-z0-9\-]{6})/', $user_name))
{
    echo 'please use lowercaps only, either with hyphens, numbers, or alphabets, and at least 6 characters.';
} 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T01:43:38.170

`^`在开头和结尾处锚定您的字符串`$`。

```
"/^[a-z0-9-]{6,}$/" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T01:46:19.310

如果您的模式需要匹配整个字符串 - 从头到尾 - 您需要将其包装在里面`^`并且`$`：

```
 /^([a-z0-9]{6}|[a-z0-9\-]{6})$/
start -´                           `- end 
```

从[*PCRE 正则表达式语法 - 元字符*](http://php.net/regexp.reference.meta)：

> `^`- 断言主题开始（或行，在多行模式下）
> `$`- 断言主题结束或在终止换行之前（或行尾，在多行模式下）

* * *

如果您至少有六个字符（并且您也可以压缩），您的模式可能如下所示：

```
 /^[a-z0-9-]{6,}$/
             ```- minimum: 6, maximum: unspecified (empty) 
```

# magento - Magento：在页脚之前添加块

> ID：13983182
> 
> 赞同：0
> 
> 时间：2012-12-21T01:43:18.137
> 
> 标签：magento, content-management-system, block

我正在使用灰度模板，我想将最近查看的内容移到页脚之前的一个块中。我需要这个与页脚颜色不同的块。所以，我删除了 page.xml 的这个块：

```
<block type="reports/product_viewed" before="right.permanent.callout" name="right.reports.product.viewed" template="reports/product_viewed.phtml" /> 
```

并添加到 page.xml 的页脚块中：

```
 <block type="page/html_footer" name="footer" as="footer" template="page/html/footer.phtml">
            <block type="reports/product_viewed" before="right.permanent.callout" name="right.reports.product.viewed" template="reports/product_viewed.phtml" />
            <block type="page/html_wrapper" name="bottom.container" as="bottomContainer" translate="label">
                <label>Page Footer</label>
                <action method="setElementClass"><value>bottom-container</value></action>
            </block>
            <block type="page/switch" name="store_switcher" as="store_switcher" template="page/switch/stores.phtml"/>
            <block type="page/template_links" name="footer_links" as="footer_links" template="page/template/links.phtml"/>
        </block> 
```

完美的！但是，我需要这个块在页脚之前而不是里面......我该怎么做？？？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T07:12:51.537

打开您的 Page.xml 文件并找到以下块

```
<block type="page/html_footer" name="footer" as="footer" template="page/htmlfooter.phtml"> 
```

它应该在第 100 行附近。

在块内粘贴以下代码

```
<block type="reports/product_viewed" name="reports.product.viewed" as="recently_viewed" template="reports/product_viewed.phtml">
    <action method="setColumnCount"><columns>4</columns></action>
    <action method="setItemLimit"><type>recently_viewed</type><limit>4</limit></action>
</block> 
```

该块应如下所示 ![在此处输入图像描述](../Images/4f5827f15c944fb05ddf9f0b690b279d.png) 现在打开您的 footer.phtml 文件和页脚之前，即

```
<div class="footer-container"> 
```

编写以下代码

```
<?php echo $this->getChildHtml('recently_viewed') ?> 
```

并像下面这样更改子块调用 ![在此处输入图像描述](../Images/bcc74136027d38a9686181c0f9e532aa.png) 现在任何登录的用户都可以查看他们最近查看的产品，是的，它在页脚之外。您可以根据需要对其进行样式设置，也可以从块本身设置列数。享受。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T01:58:25.327

尝试将其添加到“页脚”部分的正上方：

```
<block type="core/text_list" name="review.before.footer" as="review.before.footer" translate="label">
       <block type="reports/product_viewed" before="right.permanent.callout" name="right.reports.product.viewed" template="reports/product_viewed.phtml" />
</block> 
```

# java - 如何修改我的 Java 小程序代码以使用 JPanel 而不是 JFrame？

> ID：13983187
> 
> 赞同：1
> 
> 时间：2012-12-21T01:44:09.610
> 
> 标签：java, swing, security, applet, jframe

我是一个正在学习 Java 的 .net 程序员。在过去的两周里，我一直在研究这个问题......

这是我的代码，用于显示我的安全系统网络摄像头并更新在小程序中运行的 JFrame 中的图像：（我需要将此代码转换为在 JPanel 中工作！）

```
public class Streamer extends JApplet {
String PATH = "C:/Security/CamCap/";
Integer UPDATE_INTERVAL = 100;
String CAM1FILE = "current1.png";
String CAM2FILE = "current2.png";
String CAM3FILE = "current3.png";
String CAM4FILE = "current4.png";
String CAM5FILE = "current5.png";
String CAM6FILE = "current6.png";
String CAM7FILE = "current7.png";
String CAM8FILE = "current8.png";
String LOGOFILE = "logo.png";

private String path1 = PATH + CAM1FILE;
private String path2 = PATH + CAM2FILE;
private String path3 = PATH + CAM3FILE;
private String path4 = PATH + CAM4FILE;
private String path5 = PATH + CAM5FILE;
private String path6 = PATH + CAM6FILE;
private String path7 = PATH + CAM7FILE;
private String path8 = PATH + CAM8FILE;
private String pathLogo = PATH + LOGOFILE;

JFrame frame = new JFrame("@Home - Live Video");
boolean loaded = false;

JLabel label1, label2, label3, label4, label5, label6, label7, label8, labelLogo;

public void init()
{
    frame.getContentPane().setBackground(Color.BLACK);
    frame.setMinimumSize(new Dimension(1087, 777));
    frame.setLayout(new GridLayout(3, 3, 2, 2));
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(1090,780);
    frame.getContentPane().setSize(1087, 777);
    frame.setLocationRelativeTo ( null );
    frame.setVisible(true); 

    //INITIALIZE CAMERA 1
ImageIcon icon1 = new ImageIcon();
    loaded = false;
    while(!loaded)
    {
        try {
            icon1 = new ImageIcon(ImageIO.read(new File(path1)));
            loaded = true;
        } catch (Exception ex) { loaded = false; }
    }

    label1 = new JLabel(icon1);
    frame.add(label1);

    //INITIALIZE CAMERA 2
ImageIcon icon2 = new ImageIcon();
    loaded = false;
    while(!loaded)
    {
        try {
            icon2 = new ImageIcon(ImageIO.read(new File(path2)));
            loaded = true;
        } catch (Exception ex) { loaded = false; }
    }

    label2 = new JLabel(icon2);
    frame.add(label2);

    //INITIALIZE CAMERA 3
ImageIcon icon3 = new ImageIcon();
    loaded = false;
    while(!loaded)
    {
        try {
            icon3 = new ImageIcon(ImageIO.read(new File(path3)));
            loaded = true;
        } catch (Exception ex) { loaded = false; }
    }

    label3 = new JLabel(icon3);
    frame.add(label3);

    //INITIALIZE CAMERA 4
ImageIcon icon4 = new ImageIcon();
    loaded = false;
    while(!loaded)
    {
        try {
            icon4 = new ImageIcon(ImageIO.read(new File(path4)));
            loaded = true;
        } catch (Exception ex) { loaded = false; }
    }

    label4 = new JLabel(icon4);
    frame.add(label4);

    //INITIALIZE CAMERA 5
ImageIcon icon5 = new ImageIcon();
    loaded = false;
    while(!loaded)
    {
        try {
            icon5 = new ImageIcon(ImageIO.read(new File(path5)));
            loaded = true;
        } catch (Exception ex) { loaded = false; }
    }

    label5 = new JLabel(icon5);
    frame.add(label5);

    //INITIALIZE CAMERA 6
ImageIcon icon6 = new ImageIcon();
    loaded = false;
    while(!loaded)
    {
        try {
            icon6 = new ImageIcon(ImageIO.read(new File(path6)));
            loaded = true;
        } catch (Exception ex) { loaded = false; }
    }

    label6 = new JLabel(icon6);
    frame.add(label6);

    //INITIALIZE CAMERA 7
ImageIcon icon7 = new ImageIcon();
    loaded = false;
    while(!loaded)
    {
        try {
            icon7 = new ImageIcon(ImageIO.read(new File(path7)));
            loaded = true;
        } catch (Exception ex) { loaded = false; }
    }

    label7 = new JLabel(icon7);
    frame.add(label7);

    //INITIALIZE CAMERA 8
ImageIcon icon8 = new ImageIcon();
    loaded = false;
    while(!loaded)
    {
        try {
            icon8 = new ImageIcon(ImageIO.read(new File(path8)));
            loaded = true;
        } catch (Exception ex) { loaded = false; }
    }

    label8 = new JLabel(icon8);
    frame.add(label8);

    //INITIALIZE LOGO
ImageIcon iconLogo = new ImageIcon();
        try {
            iconLogo = new ImageIcon(ImageIO.read(new File(pathLogo)));
            loaded = true;
        } catch (Exception ex) { loaded = false; }

    labelLogo = new JLabel(iconLogo);
    frame.add(labelLogo);

    frame.setVisible(true);
    run();
}

public void run()
{
    while(true)
    {
        try {
            ImageIcon icon1 = new ImageIcon(ImageIO.read(new File(path1)));
            label1.setIcon(icon1);
            label1.repaint();
        } catch (Exception ex) {}

        try {
            ImageIcon icon2 = new ImageIcon(ImageIO.read(new File(path2)));
            label2.setIcon(icon2);
            label2.repaint();
        } catch (Exception ex) {}

        try {
            ImageIcon icon3 = new ImageIcon(ImageIO.read(new File(path3)));
            label3.setIcon(icon3);
            label3.repaint();
         } catch (Exception ex) {}

        try {
            ImageIcon icon4 = new ImageIcon(ImageIO.read(new File(path4)));
            label4.setIcon(icon4);
            label4.repaint();
        } catch (Exception ex) {}

        try {
            ImageIcon icon5 = new ImageIcon(ImageIO.read(new File(path5)));
            label5.setIcon(icon5);
            label5.repaint();
        } catch (Exception ex) {}

        try {
            ImageIcon icon6 = new ImageIcon(ImageIO.read(new File(path6)));
            label6.setIcon(icon6);
            label6.repaint();
        } catch (Exception ex) {}

        try {
            ImageIcon icon7 = new ImageIcon(ImageIO.read(new File(path7)));
            label7.setIcon(icon7);
            label7.repaint();
        } catch (Exception ex) {}

        try {
            ImageIcon icon8 = new ImageIcon(ImageIO.read(new File(path8)));
            label8.setIcon(icon8);
            label8.repaint();
        } catch (Exception ex) {}

        try {            
            Thread.sleep(UPDATE_INTERVAL);
        } catch (Exception ex) {}
        }
    }
} 
```

我已经尝试了所有方法，但找不到将这段代码转换为在 JPanel 中工作的方法。我需要在我的小程序中使用 JPanel，这样我的相机就不会出现在一个新的、单独的窗口 (JFrame) 中。

有谁知道如何转换（只是一小部分）此代码以在 JPanel 中绘制和刷新我的图像？

提前致谢）！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:15:08.173

在 JLabel 中使用 GUI 的示例，它使用 Swing Timer 进行动画，并显示在 JApplet 中：

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.lang.reflect.InvocationTargetException;
import java.net.MalformedURLException;
import java.net.URL;

import javax.imageio.ImageIO;
import javax.swing.*;

@SuppressWarnings("serial")
public class SpriteAnimationApplet extends JApplet {
   private static final String SPRITE_SHEET_SPEC = "http://www.funorb.com/img/images/game/"
         + "central/dev_diary/sprite_sheet_full.gif";
   private static final int SPRITE_ROWS = 8; // an 8 x 8 sprite sheet

   @Override
   public void init() {
      try {
         final Icon[] icons = SpriteIO.getSprites(SPRITE_SHEET_SPEC, SPRITE_ROWS);
         SwingUtilities.invokeAndWait(new Runnable() {
            public void run() {
               SpriteAnimationPanel spritePanel = new SpriteAnimationPanel(icons);
               getContentPane().add(spritePanel);
               spritePanel.startAnimation();
            }
         });
      } catch (InvocationTargetException e) {
         e.printStackTrace();
         System.exit(-1);
      } catch (InterruptedException e) {
         e.printStackTrace();
         System.exit(-1);
      } catch (MalformedURLException e) {
         e.printStackTrace();
         System.exit(-1);
      } catch (IOException e) {
         e.printStackTrace();
         System.exit(-1);
      }
   }

}

class SpriteIO {
   public static Icon[] getSprites(String spriteSheetSpec, int spriteRows)
         throws MalformedURLException, IOException {
      Icon[] icons = new Icon[spriteRows * spriteRows];
      URL spriteSheetUrl = new URL(spriteSheetSpec);
      BufferedImage spriteSheet = ImageIO.read(spriteSheetUrl);
      double wD = (double) spriteSheet.getWidth() / spriteRows;
      double hD = (double) spriteSheet.getHeight() / spriteRows;
      int w = (int) wD;
      int h = (int) hD;
      for (int i = 0; i < spriteRows; i++) {
         for (int j = 0; j < spriteRows; j++) {
            int x = (int) (i * wD);
            int y = (int) (j * hD);
            BufferedImage img = spriteSheet.getSubimage(x, y, w, h);

            icons[j * spriteRows + i] = new ImageIcon(img);
         }
      }
      return icons;
   }
}

@SuppressWarnings("serial")
class SpriteAnimationPanel extends JPanel {
   private static final int TIMER_DELAY = 200;
   private Icon[] icons;
   private JLabel animationLabel = new JLabel();

   public SpriteAnimationPanel(Icon[] icons) {
      this.icons = icons;
      setLayout(new BorderLayout());
      add(animationLabel );
   }

   public void startAnimation() {
      Timer spriteTimer = new Timer(TIMER_DELAY, new ActionListener() {
         private int iconIndex = 0;

         @Override
         public void actionPerformed(ActionEvent arg0) {
            animationLabel.setIcon(icons[iconIndex]);
            iconIndex++;
            iconIndex %= icons.length;
         }
      });
      spriteTimer.start();
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T05:23:40.713

```
ImageIcon icon5 = new ImageIcon(ImageIO.read(new File(path5))); 
```

小程序资源通常从小程序的运行时类路径或主服务器加载。避免`File`在 applet 中使用对象，除非它们是由用户从 a 提供的`JFileChooser`（此处不是这种情况）。

```
ImageIcon icon5 = new ImageIcon(this.getClass().getResource(href5)); 
```

资源的 URL 可以相对于小程序的文档或代码库形成。

## 尖端

### 如有疑问，请打印出来！

对于每个`catch`转储堆栈跟踪。

```
} catch (Exception ex) {
    ex.printStackTrace();
    //.. 
```

### 观察输出

确保在浏览器启动小程序时显示[Java 控制台。](http://www.java.com/en/download/help/javaconsole.xml)

### 使用 Swing 执行动画`Timer`

如HFoE所讨论/所示。

### 图像缓存

小程序中的图像通常被缓存。小程序似乎多次加载图像，预计每次都不同（安全摄像头的最后一帧）。为了解决这个问题，将图像加载为 a`byte[]`并将其放入 a`ByteArrayInputStream`中。然后使用`ImageIO`.

由于 JRE 无法`byte[]`将图像的 映射到`File`路径或`URL`，因此无法缓存。

# performance - OpenGL - 如何计算地形高度网格中的法线？

> ID：13983189
> 
> 赞同：23
> 
> 时间：2012-12-21T01:44:19.550
> 
> 标签：performance, opengl, grid, terrain, normals

我的方法是分别计算平行于 X 轴和 Y 轴的两个切向量。然后计算叉积以找到法向量。

切线向量由穿过两个最近线段中点的线给出，如下图所示。

![在此处输入图像描述](../Images/9e7f69870f87cc140a5d521e922d0435.png)

我想知道是否有更直接的计算，或者在 CPU 周期方面更便宜。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-12-21T02:18:49.560

您实际上可以使用“有限差分法”（或者至少我认为以这种方式调用它）来计算它而无需叉积。

实际上它足够快，我用它来计算顶点着色器中的法线。

```
 // # P.xy store the position for which we want to calculate the normals
  // # height() here is a function that return the height at a point in the terrain

  // read neightbor heights using an arbitrary small offset
  vec3 off = vec3(1.0, 1.0, 0.0);
  float hL = height(P.xy - off.xz);
  float hR = height(P.xy + off.xz);
  float hD = height(P.xy - off.zy);
  float hU = height(P.xy + off.zy);

  // deduce terrain normal
  N.x = hL - hR;
  N.y = hD - hU;
  N.z = 2.0;
  N = normalize(N); 
```

# c# - ActionResult 返回一个流

> ID：13983190
> 
> 赞同：28
> 
> 时间：2012-12-21T01:44:24.527
> 
> 标签：c#, asp.net-mvc

我的`ActionResult`回报 a`File`但我也需要它有条件地回报 a `Stream`。

我无法找到有关 an`ActionResult`如何返回`Stream`.

这是我返回文件的代码：

```
 return File(memoryStream,.... ) 
```

如前所述，我只需要返回一个`Stream`.

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-12-21T04:14:39.537

# 为 MVC5 2020 更新：

*我之前的回答已经过时了。*

截至目前，`File`不同类型的 ActionResult 返回取决于给定的参数

```
// to return FileStreamResult
return File(memoryStream, "application/pdf");
// or..
return File(memoryStream, "application/pdf", "file_name"); 
```

* * *

使用[`FileStreamResult`](https://msdn.microsoft.com/en-us/library/system.web.mvc.filestreamresult.aspx)：

```
MemoryStream stream = someService.GetStream();

return new FileStreamResult(stream, "application/pdf") 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-21T06:38:01.577

让一个动作调用另一个动作是一种设计味道。你应该避免它。只需将需要在服务层中的 2 个操作之间重用的逻辑放在一起。然后从您的 2 个操作中调用此逻辑。

例如：

```
public ActionResult Action1()
{
    Stream stream = service.GetStream();
    // ... do something with the stream and return a view for example
    return View();
}

public ActionResult Action2()
{
    Stream stream = service.GetStream();
    // let's return the stream to the client so that he could download it as file
    return File(stream, "application/pdf");
} 
```

现在您不再需要从第一个操作调用第二个操作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-05-02T23:10:44.443

`Stream`在 a中使用 Action 方法的结果的最短方法`Controller`是您在问题中已经展示的方法：[`File`](https://msdn.microsoft.com/en-us/library/system.web.mvc.controller.file.aspx)使用`Controller`. 这会返回一个[`FileStreamResult`](https://msdn.microsoft.com/en-us/library/system.web.mvc.filestreamresult.aspx).

有几个可用的重载需要`Stream`. 两种重载都需要指定响应的 MIME 类型，它将作为`Content-Type`响应的标头发出；如果您的情况是您的应用程序不知道这一点，您总是可以分别为任意文本或二进制数据指定[`text/plain`](https://www.rfc-editor.org/rfc/rfc2046#section-4.1)或。[`application/octet-stream`](https://www.rfc-editor.org/rfc/rfc2046#section-4.5.1)如果适用，一个重载还需要第三个参数，该参数设置要在浏览器的下载对话框中显示的文件名（通过[`Content-Disposition`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition)标题控制）。

**重载签名**：

```
protected internal FileStreamResult File(
    Stream fileStream,
    string contentType
) 
```

和

```
protected internal virtual FileStreamResult File(
    Stream fileStream,
    string contentType,
    string fileDownloadName
) 
```

**示例用法**：

```
return File(myStream, "application/pdf"); 
```

或者

```
return File(myStream, "application/pdf", "billing-summary.pdf"); 
```

# django - 2列上的Django对称ManyToMany字段

> ID：13983192
> 
> 赞同：1
> 
> 时间：2012-12-21T01:44:42.333
> 
> 标签：django, django-models

在我的模型中，我如何明确声明我希望与另一列的多对多关系是对称的，以便从每个对象调用 object_set 时，它可以通过同一个数据库表来查找关系？

一个例子

```
class Person(models.Model):
    name = models.CharField(max_length=100)
    employer = models.ManyToManyField(Organization)

class Organization(models.Model):
    name = models.CharField(max_length=100) 
```

我是否需要在 Organization 类中创建第二个 ManyToManyField 才能执行类似的操作

```
org1.person_set.all() 
```

让所有受雇于该组织的人员和

```
pers1.organization_set.all() 
```

获取一个人可能为之工作的所有组织？还是单个 ManyToManyField 会对称地建立关系？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:52:04.157

你不需要做任何事情。

因为`ManyToMany`是 托管的`Person`，所以它将是：

```
pers1.employer.all() 
```

和

```
org1.person_set.all() 
```

# c# - 如何取消通过数据绑定所做的更改？

> ID：13983194
> 
> 赞同：14
> 
> 时间：2012-12-21T01:44:47.883
> 
> 标签：c#, winforms, data-binding

我正在通过构造函数传递客户列表。然后将其数据绑定到 ListBox。我还绑定了一个文本框以允许更改客户名称，它会自动更新 ListBox 和客户列表，这非常好。

但是，如果用户单击“取消”按钮，我希望不要保留更改。我告诉程序将客户列表设置为旧客户列表，但它不起作用，当我再次打开窗口时，ListBox 显示更新的客户名称而不是旧名称。

```
using System;
using System.Drawing;
using System.Windows.Forms;
using System.Collections.Generic;

namespace Bingding_Test
{
    public partial class Form_Customers : Form
    {
        List<Customer> customers;
        List<Customer> old_customers;
        BindingSource bs = new BindingSource();

        public Form_Actors(List<Customer> _customers)
        {
            InitializeComponent();

            customers = _customers;
            old_customers = new List<Customer>(_customers);

            bs.DataSource = customers;
            listBox1.DataSource = bs;
            listBox1.DisplayMember = "Name";

            txtb_name.DataBindings.Add("Text", bs, "Name");
        }

        void Btn_cancelClick(object sender, EventArgs e)
        {
            actors = old_customers;
            this.Close();
        }

        void Btn_saveClick(object sender, EventArgs e)
        {
            this.Close();
        }
    }
} 
```

任何人都知道我可以做些什么来确保当我单击取消按钮时不会保存所有更改？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T01:52:05.793

据我了解，您的问题是关于取消对您的`List<Customer>`through所做的更改`txtb_name`。默认情况下，`DataBindings`通过验证时自动应用更改。您可以控制`DataSourceUpdateMode`以不同方式更改此行为，具体取决于您的实现：

1.  在您设置任何绑定之前`txtb_name`（应该可以使用您的代码编写方式）：

    ```
    txtb_name.DataBindings.DefaultDataSourceUpdateMode = DataSourceUpdateMode.Never; 
    ```

2.  在您设置绑定之后`txtb_name`（也可以使用您的代码）：

    ```
    foreach( Binding b in txtb_name.DataBindings)
    {
        b.DataSourceUpdateMode = DataSourceUpdateMode.Never;
    } 
    ```

3.  在您使用[BindingManagerBase](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingmanagerbase.aspx)（[CurrencyManager](http://msdn.microsoft.com/en-us/library/system.windows.forms.currencymanager.aspx)或[PropertyManager](http://msdn.microsoft.com/en-us/library/system.windows.forms.propertymanager.aspx)）设置绑定后 - 更通用的方法，因为它允许您一次性处理许多控件，当您的项目发展时可能会变得有用。

    ```
    foreach(Binding b in bindingManager.Bindings)
    {
        b.DataSourceUpdateMode = DataSourceUpdateMode.Never;
    } 
    ```

对于[复杂的设置](http://www.codeproject.com/Articles/10745/CurrencyManager-Collection-Dealing-with-SuspendBin)，您可以使用[BindingManagerBase](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingmanagerbase.resumebinding.aspx)的[ResumeBinding](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingmanagerbase.aspx)和[SuspendBinding](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingmanagerbase.suspendbinding.aspx)，它们可以被覆盖以提供自定义的验证行为，例如，如果需要将多个字段作为一个整体逻辑部分进行验证，而不是一个一个地进行验证。

请注意，即使您设置了`DataSourceUpdateMode = DataSourceUpdateMode.Never`，也总会有一个更新通过，[根据 MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.datasourceupdatemode.aspx)（请参阅备注部分）：

> 即使更新模式设置为从不，数据源也会在第一次创建绑定时更新，因此至少会发生一次更新。

如果这对你来说是不可接受的，即你正在构建一个要求非常严格的企业级应用程序，我建议手动处理所有事情——停止使用`DataBindings`.

`DataSourceUpdateMode`归功于 Frederik Gheysels 关于[WinForms: DataBinding on a cancellable Dialog Form](http://fgheysels.blogspot.ca/2009/06/winforms-databinding-on-cancellable.html)的文章的提示。

# mysql - mysql将一个字段拆分为另一个表，相关字段为其他表

> ID：13983195
> 
> 赞同：1
> 
> 时间：2012-12-21T01:44:51.157
> 
> 标签：mysql

我是这个组的新手。我对mysql查询有一个疑问。希望有人能给出正确的解决方案。

我想从一个字段中拆分一些值并想检查其他表。希望你不清楚。

例如，

# 表格1

```
id primarySkill

1 : 2318, 5236, 8541
2 : 5236,8762
3 : 8541, 2318, 5236, 8762 
```

# 表2

```
id value

2318 java
5236 php
8541 .net
8762 Photoshop 
```

# 我想要这样的 TABLE1 输出：

```
id primarySkill
1 : java,php, .net
2 : php, Photoshop
3 : .net, java,php, Photoshop 
```

如何为此编写查询？您的迅速行动将受到高度赞赏

提前致谢

# c# - 基于另一个布尔值否定一个布尔值

> ID：13983198
> 
> 赞同：20
> 
> 时间：2012-12-21T01:45:00.937
> 
> 标签：c#, bit-manipulation

`b`无需编写两次即可编写此 C# 代码的最后一行的简短、优雅、按位方式是什么：

```
bool getAsIs = ....
bool b = ....

getAsIs ? b : !b 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-12-21T01:53:58.180

真值表可以表示为：

```
getAsIs    b    getAsIs ? b : !b
--------------------------------
0          0    1
0          1    0
1          0    0
1          1    1 
```

结果可以表示为：

```
result = (getAsIs == b); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-21T01:50:45.047

尝试使用二进制 XOR（[^ 运算符（C# 参考）](http://msdn.microsoft.com/en-us/library/zkacc7k1.aspx)）：

```
bool getAsIs = true;
bool b = false;

bool result = !(getAsIs ^ b); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-21T01:51:06.963

我想这是

```
var foo = !(getAsIs ^ b) 
```

简短，优雅，但绝对令人头疼！

# javascript - 使 HTML 文件成为 CSS 背景 - 可能吗？

> ID：13983201
> 
> 赞同：1
> 
> 时间：2012-12-21T01:45:51.603
> 
> 标签：javascript, html, css

我一直在为朋友制作网站，基本上我使用教程制作了旋转图像的背景。使用 GIF 的松散图像颜色为我节省了空间。无论如何，这是问题所在：我将它作为背景工作并使其出现在导航后面，但是当我这样做时，导航处于非活动状态（例如，尽管图像出现在导航后面，但它注册为在它的前面，所以你可以'不要点击任何东西）并且每当图像淡出成新图像时，导航就会消失并重新出现在新图像上。我玩了 z-index 但没有任何乐趣，非常困惑。

我知道这些事情很难解释，所以在这里，给自己一个测试服务器！！！

```
http://78.47.244.67/John/index.php 
```

这至少显示了会发生什么，我也可以提供代码：

以下是 CSS、HTML 和 Javascript 中背景、图像旋转的代码：

```
<html>
    <head>
        <style type="text/css">
            body {
                color:#000;
                background-color:#000;
            }
        </style>

        <style type="text/css">
            div.rotator {
                position:relative;
                display:none;
            }

            div.rotator ul li {
                float:left;
                position:absolute;
                list-style: none;
                margin:0px;
                padding:0px;
            }

            div.rotator ul li img {
                width:1600px;
                height:780px;
                margin:0px;
                padding:0px;
            }

            div.rotator ul li.show {
                z-index:-500;
            }
        </style>

        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

        <script type="text/javascript">
            function theRotator() {
                $('div.rotator ul li').css({opacity: 0.0});
                $('div.rotator ul li:first').css({opacity: 1.0});
                setInterval('rotate()',6000);
            }

            function rotate() { 
                var current = ($('div.rotator ul li.show')?  $('div.rotator ul li.show') : $('div.rotator ul li:first'));
                if(current.length == 0) current = $('div.rotator ul li:first');
                var next = ((current.next().length) ? ((current.next().hasClass('show')) ? 
                $('div.rotator ul li:first') :current.next()):$('div.rotator ul li:first'));
                //Un-comment the 3 lines below to get the images in random order
                var sibs = current.siblings();
                var rndNum = Math.floor(Math.random() * sibs.length );
                var next = $( sibs[ rndNum ] );
                //Set the fade in effect for the next image, the show class has higher z-index
                next.css({opacity: 0.0})
                .addClass('show')
                .animate({opacity: 1.0}, 1000);
                current.animate({opacity: 0.0}, 1000)
                .removeClass('show');
            };

            $(document).ready(function() {      
                theRotator();
                $('div.rotator').fadeIn(1000);
                $('div.rotator ul li').fadeIn(1000);
            });
        </script>
    </head>

    <body>
        <div class="rotator">
            <ul>
                <li class="show"><img src="img/trackbike.jpg"/></li>
                <li><img src="img/trackcar.jpg"/></li>
                <li><img src="img/drifting.jpg"/></li>
                <li><img src="img/mtb.jpg"/></li>
                <li><img src="img/wildlife.jpg"/></li>
            </ul>
        </div>
    </body>
</html> 
```

这是导航的 CSS 代码：

```
#sideNav {
    width:270px;
    height:900px;
    float:left;
    background-color: rgba(0, 0, 0, 0.5);
    z-index:500;
}

#sideNav img {
    padding-left:65px;
    padding-top:120px;
    padding-bottom:100px;
}

#sideNav a {
    padding-left:65px;
    color:#CCC;
    text-decoration:none;
    font: 28px Verdana, Geneva, sans-serif;
}

#sideNav li a:hover,
#sideNav li.current-page a {
    color:#ffc600;
}

#sideNav p a {
    float:right;
    font:10px Verdana, Geneva, sans-serif;
    color:#fff;
    text-decoration:none;
}

#sideNav p a:hover {
    color:#ffc600;
}

#sideNav p {
    font-size:10px;
    color:#FFF;
    padding-top:100px;
    padding-left:62px;
    width:120px;
} 
```

任何人都能够想出一个为什么？或者更好的解决方案？我很难过：/

任何帮助深表感谢，

塔，约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:51:38.743

为什么？不知道，但如果你添加

`z-index: -1`

在`rotator`课堂上，悬停看起来就像你想要的那样工作。

# node.js - NodeJS：警告：检测到可能的 EventEmitter 内存泄漏。增加了 11 位听众。使用emitter.setMaxListeners() 增加限制

> ID：13983204
> 
> 赞同：9
> 
> 时间：2012-12-21T01:46:07.340
> 
> 标签：node.js

我有以下代码：

```
var schild = spawn('script.sh', ["process1", "process2"]);
        schild.stderr.on('data', function (data) {
                        logger.info('stderr: ' + data);
        });

        schild.on('exit', function (code) {
          logger.info('child process exited with code ' + code);
        });

        schild.stdout.on('data', function (data) {
           logger.info('Data ' + data);
        }); 
```

当我运行代码时，出现以下错误：

```
(node) warning: possible EventEmitter memory leak detected. 11 listeners added. Use emitter.setMaxListeners() to increase limit.
Trace
    at EventEmitter.addListener (events.js:175:15)
    at EventEmitter.once (events.js:196:8)
    at Transport.logException (/x/home/prakash/src/node_modules/winston/lib/winston/transports/transport.js:118:8)
    at logAndWait (/x/home/prakash/src/node_modules/winston/lib/winston/logger.js:613:15)
    at async.forEach (/x/home/prakash/src/node_modules/winston/node_modules/async/lib/async.js:86:13)
    at Array.forEach (native)
    at _forEach (/x/home/prakash/src/node_modules/winston/node_modules/async/lib/async.js:26:24)
    at Object.async.forEach (/x/home/prakash/src/node_modules/winston/node_modules/async/lib/async.js:85:9)
    at Logger._uncaughtException (/x/home/prakash/src/node_modules/winston/lib/winston/logger.js:636:9)
    at process.EventEmitter.emit (events.js:126:20)
(node) warning: possible EventEmitter memory leak detected. 11 listeners added. Use emitter.setMaxListeners() to increase limit.
Trace
    at EventEmitter.addListener (events.js:175:15)
    at EventEmitter.once (events.js:196:8)
    at Transport.logException (/x/home/prakash/src/node_modules/winston/lib/winston/transports/transport.js:117:8)
    at logAndWait (/x/home/prakash/src/node_modules/winston/lib/winston/logger.js:613:15)
    at async.forEach (/x/home/prakash/src/node_modules/winston/node_modules/async/lib/async.js:86:13)
    at Array.forEach (native)
    at _forEach (/x/home/prakash/src/node_modules/winston/node_modules/async/lib/async.js:26:24)
    at Object.async.forEach (/x/home/prakash/src/node_modules/winston/node_modules/async/lib/async.js:85:9)
    at Logger._uncaughtException (/x/home/prakash/src/node_modules/winston/lib/winston/logger.js:636:9)
    at process.EventEmitter.emit (events.js:126:20) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T07:55:27.210

我相信问题在于，当您不再需要听众时，您并没有删除它们。完成后，您需要使用“ *schild.removeListener('exit', function)* ”或“ *schild.removeAllListeners('exit')* ”。

见：[http ://nodejs.org/api/events.html#events_emitter_removelistener_event_listener](http://nodejs.org/api/events.html#events_emitter_removelistener_event_listener)

当然，在某些情况下您需要拥有超过 10 个侦听器，在这种情况下您应该使用“ *schild.setMaxListeners(0)* ”（0 表示无限制）

见：[http ://nodejs.org/api/events.html#events_emitter_setmaxlisteners_n](http://nodejs.org/api/events.html#events_emitter_setmaxlisteners_n)

希望能帮助到你！

# qt - 使用 QtFFmpegWrapper+QLabel+QTimer 是在 Qt 应用程序中播放视频的好方法吗？

> ID：13983206
> 
> 赞同：1
> 
> 时间：2012-12-21T01:46:18.943
> 
> 标签：qt, video, ffmpeg, qlabel

我正在寻找如何在 Qt 上便携式播放视频，但不是 Phonon。

使用 ffmpeg 似乎是一个好主意（它应该在所有平台上以相同的方式工作）。

目前它使用 QLabel 进行视频输出，并为每一帧执行 QPixmap::fromImage；[由QtFFmpegWrapper](http://code.google.com/p/qtffmpegwrapper/)在后台线程中解码和缓冲的帧。QTimer 决定何时显示下一帧。

整个事情看起来有点骇人听闻（视频？在*标签*中？）。我做对了吗？在 Qt 应用程序中播放 ffmpeg 解码视频是否有更好的便携方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T07:37:42.500

您可能想看看 Qt 5.0 中的 Qt Multimedia 模块：http: [//doc-snapshot.qt-project.org/5.0/qtmultimedia/qtmultimedia-index.html](http://doc-snapshot.qt-project.org/5.0/qtmultimedia/qtmultimedia-index.html)。它应该比您描述的过程更有效（取决于平台）。

编辑：对于 Qt 5.0 之前的版本，您仍然可以使用编译 Qt Mobility 的[Qt Multimedia Kit尝试](http://doc.qt.digia.com/qtmobility/multimedia.html)[Qt Multimedia](http://doc.qt.digia.com/qt/examples-multimedia.html)模块，但我自己从未尝试过。

# c++ - 如何使用静态回调访问对象属性？

> ID：13983207
> 
> 赞同：0
> 
> 时间：2012-12-21T01:46:22.030
> 
> 标签：c++, callback, static-methods

**描述：**

我遇到了第 3 方库的问题，该库称为 TVideoGrabber。当我将函数的地址传递给库时，我无法从回调方法访问 MyClass 方法和属性。

```
m_pAPI->SetCallback(OnCallback); 
```

上面这一行将 OnCallback 地址传递给 API。一旦 API 在有更新时调用 OnCallback 方法。到目前为止，这工作正常。

**有问题的行：**

```
a->SetA(api->GetNumber()); 
```

我知道上面的语法不正确，但它应该说明我正在尝试做什么，我想从 API 设置 A 的值。

**问题：**

当 API 调用 OnCallback 函数时，发送者是 m_pAPI 对象的地址，我无权访问 MyClass 对象。

**问题：**

如何访问 MyClass 对象

**这是一个完整的代码示例：**

```
void MyClass::OnCallback(void* Object, void* sender) 
{
     API* api = (API*)(sender);

    // NO ACCESS TO MyClass properties or methods :( 
    a->SetA(api->GetNumber());  
}

class MyClass
{
    public:
          MyClass();
          ~MyClass();

          static void CALLBACK OnCallback(void* Object, void* sender);
          void SetA(int a);
          int GetA() const;

    private:
          API* m_pAPI;
          int a;  
}

MyClass::MyClass()
      : a(0)
{
    m_pAPI = new API;

    // Register for callbacks
    m_pAPI->SetCallback(OnCallback);
}

MyClass::~MyClass()
{
    delete m_pAPI;
}

int main()
{
    MyClass my;
    std::cout << "Value from API is " << my.GetA();

    return 0;
} 
```

提前致谢！期待您的回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:02:59.053

尝试替换：

```
m_pAPI = new API; 
```

经过：

```
m_pAPI = new API(this); 
```

这将使用 TVideoGrabber.h 中 CVideoGrabber 类的第二个构造函数：

```
CVideoGrabber (void* classPtr); 
```

并且您的类实例的指针将由回调事件的“sender”参数返回。

# visual-studio - 从 WebMatrix 2 启动 Visual Studio 会打开错误的版本

> ID：13983217
> 
> 赞同：11
> 
> 时间：2012-12-21T01:47:36.493
> 
> 标签：visual-studio, visual-studio-2012, registry, webmatrix, webmatrix-2

我正在使用 Microsoft **WebMatrix 2**处理一个简单的 ASP.NET WebPages 站点。当您在**Files**视图中时，有一个**Visual Studio Launch按钮，应该会在****Visual Studio 2012**中打开站点解决方案。在我的机器上，我还安装了 Visual Studio 2010，这是我单击按钮时打开的版本。

![在此处输入图像描述](../Images/5fa426cdd808b732e26a337f42ba2d79.png)

如何确保 Visual Studio 2012 已打开？

我正在使用 Windows 8，但我很确定这也适用于 Windows 7 和 XP。我怀疑我可能在 2010 年之前安装了 2012，这可以解释我的机器是如何进入这种状态的，但我无法确定。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-21T01:47:36.493

感谢[Mike Brind](http://www.mikesdotnetting.com/)在他的博客文章[WebMatrix Opens Wrong Version Of Visual Studio](http://www.mikesdotnetting.com/Article/175/WebMatrix-Opens-Wrong-Version-Of-Visual-Studio)中提供解决方案的技术细节。

基本上，您需要更新这些注册表项以指向正确版本的 Studio。修改[Windows 注册表](http://support.microsoft.com/kb/136393)时要小心！

```
HKEY_CLASSES_ROOT\VisualStudio.DTE\CLSID
HKEY_CLASSES_ROOT\VisualStudio.DTE\CurVer 
```

运行以下命令将首先备份注册表项并将值设置为 Visual Studio 2012。您需要打开管理员/提升权限的命令提示符才能执行它们。

```
reg export HKEY_CLASSES_ROOT\VisualStudio.DTE %HOMEPATH%\Documents\VisualStudio.DTE-RegistryKeyBackup.reg
reg add HKCR\VisualStudio.DTE\CLSID /ve /d {059618E6-4639-4D1A-A248-1384E368D5C3} /f
reg add HKCR\VisualStudio.DTE\CurVer /ve /d VisualStudio.DTE.11.0 /f 
```

# facebook - Facebook 评论未同步

> ID：13983220
> 
> 赞同：2
> 
> 时间：2012-12-21T01:47:52.670
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph, facebook-comments

我很难看到 facebook 评论与 facebook 帖子同步评论的工作示例。以下内容摘自：http: [//developers.facebook.com/docs/reference/plugins/comments/](http://developers.facebook.com/docs/reference/plugins/comments/)

> 然后，喜欢该页面的朋友和其他人可以通过直接在 Facebook 上的新闻提要或您网站上的评论框中点赞或回复评论来回复讨论。无论评论是在哪里发表的，话题都会在 Facebook 和您网站上的评论框中保持同步。

例如，查看他们 facebook 页面上的任何 techcrunch 文章：http: [//www.facebook.com/techcrunch?](http://www.facebook.com/techcrunch?fref=ts) fref=ts如果您单击链接查看他们网站上的文章，评论完全不同，不要t 似乎完全同步。

如果评论可以正确同步（B）如何完成，任何人都可以阐明（A）。

我有一个设置了沙盒的应用程序。如果我对我网站上的一篇文章发表评论，然后在我们的 Facebook 页面上发布该文章的链接，我希望我们网站上的评论和共享文章上的评论是一样的吗？

# javascript - webfonts 异步加载时执行代码和底部的其他脚本

> ID：13983222
> 
> 赞同：0
> 
> 时间：2012-12-21T01:48:10.690
> 
> 标签：javascript, asynchronous, typekit, webfont-loader

我正在使用 Typekit 的代码片段进行异步加载，位于 中`<head>`，我的 JavaScript 的其余部分位于`<body>`. 这是 Typekit 脚本的配置部分：

```
var config = {
  kitId: 'tca8gie',
  scriptTimeout: 3000,
  active: function() {

    $heroUnit = $(".hero-unit");
    if ($heroUnit.length)
      $heroUnit.find("h1, .lead").slabText({
        viewportBreakpoint: 600
      });

  }
}; 
```

[我在加载 webfonts 时在激活slabText](http://www.frequency-decoder.com/demo/slabText/)的位置添加了`active`回调。在 99% 的情况下，这是可行的，但在 1% 的情况下，位于我页面底部的 jQuery 尚未加载，因此此 slabText 代码会导致错误并且无法正常工作。`Can't find variable: jQuery`

当 webfonts、jQuery 和slabText 加载时，我如何准确地执行此代码？

# r - 在 r 中绘制板布局热图

> ID：13983225
> 
> 赞同：4
> 
> 时间：2012-12-21T01:48:45.047
> 
> 标签：r, plot, ggplot2, heatmap

我正在尝试在 R 中绘制板布局热图。板布局只是 8（行）x 12（列）圆（井）。行用字母标记，列用数字标记。每个孔需要填充一些颜色强度取决于定性或定量变量。盘子布局是这样的：

![在此处输入图像描述](../Images/6818849cc9ff30f5c967ee71977333db.png)

这是小数据集：

```
 set.seed (123)
platelay <- data.frame (rown = rep (letters[1:8], 12), coln = rep (1:12, each = 8),
colorvar = rnorm (96, 0.3, 0.2))

   rown coln     colorvar
1     a    1  0.187904871
2     b    1  0.253964502
3     c    1  0.611741663
4     d    1  0.314101678
5     e    1  0.325857547
6     f    1  0.643012997
7     g    1  0.392183241
8     h    1  0.046987753
9     a    2  0.162629430
10    b    2  0.210867606
11    c    2  0.544816359
12    d    2  0.371962765
13    e    2  0.380154290
14    f    2  0.322136543
15    g    2  0.188831773
16    h    2  0.657382627
17    a    3  0.399570096
18    b    3 -0.093323431
19    c    3  0.440271180
20    d    3  0.205441718
21    e    3  0.086435259
22    f    3  0.256405017
23    g    3  0.094799110
24    h    3  0.154221754
25    a    4  0.174992146
26    b    4 -0.037338662
27    c    4  0.467557409
28    d    4  0.330674624
29    e    4  0.072372613
30    f    4  0.550762984
31    g    4  0.385292844
32    h    4  0.240985703
33    a    5  0.479025132
34    b    5  0.475626698
35    c    5  0.464316216
36    d    5  0.437728051
37    e    5  0.410783531
38    f    5  0.287617658
39    g    5  0.238807467
40    h    5  0.223905800
41    a    6  0.161058604
42    b    6  0.258416544
43    c    6  0.046920730
44    d    6  0.733791193
45    e    6  0.541592400
46    f    6  0.075378283
47    g    6  0.219423033
48    h    6  0.206668929
49    a    7  0.455993024
50    b    7  0.283326187
51    c    7  0.350663703
52    d    7  0.294290649
53    e    7  0.291425909
54    f    7  0.573720457
55    g    7  0.254845803
56    h    7  0.603294121
57    a    8 -0.009750561
58    b    8  0.416922750
59    c    8  0.324770849
60    d    8  0.343188314
61    e    8  0.375927897
62    f    8  0.199535309
63    g    8  0.233358523
64    h    8  0.096284923
65    a    9  0.085641755
66    b    9  0.360705728
67    c    9  0.389641956
68    d    9  0.310600845
69    e    9  0.484453494
70    f    9  0.710016937
71    g    9  0.201793767
72    h    9 -0.161833775
73    a   10  0.501147705
74    b   10  0.158159847
75    c   10  0.162398277
76    d   10  0.505114274
77    e   10  0.243045399
78    f   10  0.055856458
79    g   10  0.336260696
80    h   10  0.272221728
81    a   11  0.301152837
82    b   11  0.377056080
83    c   11  0.225867994
84    d   11  0.428875310
85    e   11  0.255902688
86    f   11  0.366356393
87    g   11  0.519367803
88    h   11  0.387036298
89    a   12  0.234813683
90    b   12  0.529761524
91    c   12  0.498700771
92    d   12  0.409679392
93    e   12  0.347746347
94    f   12  0.174418785
95    g   12  0.572130490
96    h   12  0.179948083 
```

有没有可以轻松做到的包？是否可以在 base 或 ggplot2 或其他可以实现此目标的包中编写函数。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-21T01:57:18.440

用 改变足够大小的点的颜色`ggplot2`。请注意，我已经实施了@TylerRinkler 的建议，但在对`ggplot`. 我还删除了轴标签

```
ggplot(platelay, aes(y = factor(rown, rev(levels(rown))),x = factor(coln))) + 
     geom_point(aes(colour = colorvar), size =18)  +theme_bw() +
     labs(x=NULL, y = NULL) 
```

![在此处输入图像描述](../Images/f641294dc59f72b7d0a4e124bb76fa53.png)

还有一个基本的图形方法，它可以让你在绘图上方有 x 轴

```
# plot with grey colour dictated by rank, no axes or labels
with(platelay, plot( x=as.numeric(coln), y= rev(as.numeric(rown)), pch= 19, cex = 2, 
 col = grey(rank(platelay[['colorvar']] ) / nrow(platelay)), axes = F, xlab= '', ylab = ''))
# add circular outline
with(platelay, points( x=as.numeric(coln), y= rev(as.numeric(rown)), pch= 21, cex = 2))
# add the axes
axis(3, at =1:12, labels = 1:12)
axis(2, at = 1:8, labels = LETTERS[8:1])
# the background grid
grid()
# and a box around the outside
box() 
```

![在此处输入图像描述](../Images/111368d97399fa331418b763f0835958.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-21T02:54:58.167

对于咯咯笑声和圣诞欢呼，这里有一个使用基本 R 绘图函数的版本。尽管很可能有更好的解决方案。

```
dev.new(width=6,height=4)

rown <- unique(platelay$rown)
coln <- unique(platelay$coln)

plot(NA,ylim=c(0.5,length(rown)+0.5),xlim=c(0.5,length(coln)+0.5),ann=FALSE,axes=FALSE)
box()

axis(2,at=seq_along(rown),labels=rev(rown),las=2)
axis(3,at=seq_along(coln),labels=coln)

colgrp <- findInterval(platelay$colorvar,seq(min(platelay$colorvar),max(platelay$colorvar),length.out=10))
colfunc <- colorRampPalette(c("green", "blue"))
collist <- colfunc(length(unique(colgrp))) 

symbols(platelay$coln,
        factor(platelay$rown, rev(levels(platelay$rown))),
        circles=rep(0.2,nrow(platelay)),
        add=TRUE,
        inches=FALSE,
        bg=collist[colgrp]) 
```

结果图像：

![在此处输入图像描述](../Images/e8b85b2420a15d2e7aaf6dc06121c7ca.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-21T02:38:26.140

这里使用@mnel 的ggplot2 解决方案和网格解决方案的解决方案

![在此处输入图像描述](../Images/ee5adae67fd4131f290391065147c60b.png)

这里是给定解决方案的代码

```
d <- ggplot(platelay, aes(y=rown,x=factor(coln))) + 
  geom_point(aes(colour = colorvar), size =18) + theme_bw() 
```

我使用 ggplot 生成的数据

```
data <- ggplot_build(d)$data[[1]]

 x <- data$x
 y <- data$y
 grid.newpage()
 pushViewport(plotViewport(c(4, 4, 2, 2)),
               dataViewport(x, y)) 
```

网格有一个椭圆几何

```
 grid.ellipse(x, y,size=20,  ar = 2,angle=0,gp =gpar(fill=data$colour))
 grid.xaxis(at=c(labels=1:12,ticks=NA),gp=gpar(cex=2))
 grid.yaxis(at = 1:8,label=rev(LETTERS[1:8]),gp=gpar(cex=2))

 grid.roundrect(gp=gpar(fill=NA)) 
```

我添加网格：

```
gpgrid <- gpar(col='grey',lty=2,col='white')
grid.segments(unit(1:12, "native") ,unit(0, "npc"), unit(1:12, "native"),unit(1, "npc"),gp=gpgrid)
grid.segments(unit(0, "npc"), unit(1:8, "native"), unit(1, "npc"),unit(1:8, "native"),gp=gpgrid)
upViewport() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-21T05:44:32.343

这个答案是@thelatemail 答案的补充，它解释了 (8,12) = 96 格式的版图。

要构造 (32,48) = 1536 格式，AZ 的个位数是不够的。因此，需要扩展 AA、AB、AC、AD ... ZZ 等字母，并且可以通过将 LETTERS 连接到以下级别变量来将其扩展为三位或更多位数。

```
levels = c(LETTERS, c(t(outer(LETTERS, LETTERS, paste, sep = ""))))) 
```

@thelatemail 答案可以改进为 1536 板格式的两位数字母，如下所示

```
rown = rep (c(LETTERS, c(t(outer(LETTERS[1], LETTERS[1:6], paste, sep = "")))),

symbols(platelay$coln,
        factor(platelay$rown, 
               levels = rev(c(LETTERS, c(t(outer(LETTERS[1], LETTERS[1:6], paste, sep = "")))))),
        circles=rep(0.45,nrow(platelay)),
        add=TRUE,
        inches=FALSE,
        bg=collist[colgrp]) 
```

符号函数内的级别变量应该具有按字母顺序排序的单个字符，然后是双字符，然后是三字符......等等数字。

例如，如果您在符号函数中的级别顺序不正确，那么它将以不正确的颜色表示进行绘图。

错误顺序：A、AA、AB、AC、AD、AE、AF、B、C、D、...Z

正确顺序：A、B、C、D、E、.....Z、AA、AB、AC、AD、AE、AF

![在此处输入图像描述](../Images/92f9ed1eba12eeb3738c5cd22ee886fc.png)

# ios - ios - 清理后“libtool 失败，退出代码为 1”

> ID：13983226
> 
> 赞同：2
> 
> 时间：2012-12-21T01:48:48.480
> 
> 标签：ios, sharekit, exit-code, armv7, libtool-xcode

我正在做一个项目，一切都很顺利，直到我决定清理我的项目。

仅当我在模拟器上运行我的应用程序时才会出现以下错误（在真实设备上运行良好）：

```
Libtool /Users/Yaman/Library/Developer/Xcode/DerivedData/Homeless-gujyzhsiwenufvedlinbbtrizcpd/Build/Products/Debug-iphonesimulator/libShareKit.a normal i386
    cd "/Users/Yaman/Documents/iOS - App à vendre/Homeless/Submodules/ShareKit"
    setenv IPHONEOS_DEPLOYMENT_TARGET 4.0
    setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool -static -arch_only i386 -syslibroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.0.sdk -L/Users/Yaman/Library/Developer/Xcode/DerivedData/Homeless-gujyzhsiwenufvedlinbbtrizcpd/Build/Products/Debug-iphonesimulator -filelist "/Users/Yaman/Library/Developer/Xcode/DerivedData/Homeless-gujyzhsiwenufvedlinbbtrizcpd/Build/Intermediates/ShareKit.build/Debug-iphonesimulator/Static Library.build/Objects-normal/i386/ShareKit.LinkFileList" -ObjC -all_load -lCopy -lDelicious -lDiigo -lEmail "-lEvernote SDK" -lEvernote -lFacebook "-lFlickr SDK" -lFlickr -lFoursquareV2 "-lGoogle Reader" -lInstagram -lInstapaper -lJSONKit -lKippt -lLinkedIn -lLogout -lOAuth "-lOpen in Safari" -lPinboard -lPrint -lReachability "-lRead It Later" "-lSave to Album" -lShareKitCore "-lSina Weibo" -lSSKeyChain "-lText Message" -lTumblr -lTwitter -lVKontakte -o /Users/Yaman/Library/Developer/Xcode/DerivedData/Homeless-gujyzhsiwenufvedlinbbtrizcpd/Build/Products/Debug-iphonesimulator/libShareKit.a

/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: -dynamic not specified, -all_load invalid
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: -dynamic not specified the following flags are invalid: -ObjC 
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: can't locate file for: -lReachability
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: file: -lReachability is not an object file (not allowed in a library)
Command /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool failed with exit code 1 
```

`xcodebuild`直接从终端运行命令时出现这些错误：

```
** BUILD FAILED **

The following build commands failed:
    Libtool "build/ShareKit.build/Release-iphoneos/Static Library.build/Objects-normal/armv7/libShareKit.a" normal armv7
    Libtool "build/ShareKit.build/Release-iphoneos/Static Library.build/Objects-normal/armv7s/libShareKit.a" normal armv7s
(2 failures) 
```

有人能弄清楚这里发生了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-01T23:38:39.697

我刚收到这个错误。该项目运行良好，您添加了一个新的库和 BAM，构建失败。

我的情况是，Xcode5`\"`在我的`header search paths`价值观周围添加了一些特别的东西。

像那样 ：

```
\"$(SRCROOT)/myproject/Libraries/lib\" 
```

几乎不可能找到，但是在花费数小时寻找问题所在时，我终于尝试更改为

```
$(SRCROOT)/myproject/Libraries/lib 
```

并且构建成功回来了......感谢Xcode！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T08:21:15.227

第一个错误说明说编译[ShareKit](https://github.com/ShareKit/ShareKit)失败，因为`Reachability`缺少。我建议您检查您的编译环境是否具有最新（或兼容）版本的库。

这就是为什么`libShareKit.a`缺少最后一个错误说明中提到的并且编译您的应用程序失败的原因。尝试单独编译 ShareKit，完成后，再次尝试整个应用程序。

# asp.net - SQL Server 2008 R2 Express 错误：无法打开登录请求的数据库“PersonnelPro”。登录失败

> ID：13983230
> 
> 赞同：6
> 
> 时间：2012-12-21T01:49:23.360
> 
> 标签：asp.net, login, web-config, database-connection, sql-server-2008r2-express

我在我的数据库中使用 SQL Server 2008 R2 Express 和“SQL Server 和 Windows 身份验证”模式。我可以使用企业管理器打开数据库，但是当我运行我的 aspx 应用程序时，我得到：

> *无法打开登录请求的数据库“PersonnelPro”。登录失败。*

我的 web.config 连接字符串是：

```
<add name="dbString" 
     connectionString="Provider=sqloledb;Data Source=AREA51\SQLEXPRESS;Initial Catalog=PersonnelPro;User Id= ****;Password= ****" />` 
```

我搜索了网络和 SO，但找不到解决方案。有什么想法会导致这个问题吗？

**更新：**
查看 SQL 日志文件（“C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQLEXPRESS\MSSQL\Log”），我发现：

```
2012-12-21 05:58:00.97 Logon       Error: 18456, Severity: 14, State: 38.
2012-12-21 05:58:00.97 Logon       Login failed for user 'PersonnelPro'. Reason: Failed to open the explicitly specified database. [CLIENT: <named pipe>] 
```

此 Web 应用程序由第 3 方公司提供。所以从技术上讲，我只需要配置我的 web.config 文件就可以了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T07:44:39.333

删除用户 ID 和密码的“=”符号后的空格。我认为它被解释为价值的一部分。

**更新：**

您发布的新错误消息（无法打开明确指定的数据库。）可能意味着以下两种情况之一：

*   具有该名称的数据库不存在或拼写错误。
*   您尝试登录的用户无权访问数据库。`exec sp_helpuser 'username'`您可以通过在数据库中运行来检查这一点。

# json - 在 windows phone 中使用 json 从 wordpress 帖子中获取图像

> ID：13983236
> 
> 赞同：0
> 
> 时间：2012-12-21T01:49:53.110
> 
> 标签：json, wordpress, windows-phone-7, post

我想从 wordpress 博客中获取图片。我只会从一篇文章开始，而不是从所有文章图片开始。

我正在使用此代码。它可以获取标题、摘录、网址……但我无法获取图片：

命名空间 WpWordpressJson {

```
public class MainViewModel : INotifyPropertyChanged
{
    public MainViewModel()
    {
        this.Items = new ObservableCollection<ItemViewModel>();
    }

    /// <summary>
    /// A collection for ItemViewModel objects.
    /// </summary>
    public ObservableCollection<ItemViewModel> Items { get; private set; }

    private string _sampleProperty = "Sample Runtime Property Value";
    /// <summary>
    /// Sample ViewModel property; this property is used in the view to display its value using a Binding
    /// </summary>
    /// <returns></returns>
    public string SampleProperty
    {
        get
        {
            return _sampleProperty;
        }
        set
        {
            if (value != _sampleProperty)
            {
                _sampleProperty = value;
                NotifyPropertyChanged("SampleProperty");
            }
        }
    }

    public bool IsDataLoaded
    {
        get;
        private set;
    }

    /// <summary>
    /// Creates and adds a few ItemViewModel objects into the Items collection.
    /// </summary>
    public void LoadData()
    {
        WebRequest.RegisterPrefix("http://automaticband.es/bio/", WebRequestCreator.ClientHttp);
        Uri serviceUri = new Uri("http://automaticband.es/bio/?json=get_recent_posts");
        WebClient downloader = new WebClient();
        downloader.OpenReadCompleted += new OpenReadCompletedEventHandler(downloader_OpenReadCompleted);
        downloader.OpenReadAsync(serviceUri);
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (null != handler)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    void downloader_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
    {
        if (e.Error == null)
        {
            try
            {
                Stream responseStream = e.Result;
                DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(Posts));
                Posts response = (Posts)ser.ReadObject(responseStream);
                if (response.posts != null && response.posts.Count > 0)
                {
                    foreach (Post post in response.posts)
                    {
                        this.Items.Add(new ItemViewModel() { LineOne = post.title, LineTwo = post.excerpt });
                    }
                }
            }
            catch (Exception x)
            {
                return;
            }
            this.IsDataLoaded = true;
        }
    }
}

[DataContract]
public class Post
{
    [DataMember]
    public int id;
    [DataMember]
    public string type;
    [DataMember]
    public string slug;
    [DataMember]
    public string title;
    [DataMember]
    public string content;
    [DataMember]
    public string excerpt;
}

[DataContract]
public class Posts
{
    [DataMember]
    public int count;
    [DataMember]
    public int count_total;
    [DataMember]
    public List<Post> posts;
} 
```

我从这个网站得到它：

[http://kevinashley.com/connect-windows-phone-7-apps-to-wordpress-using-json/](http://kevinashley.com/connect-windows-phone-7-apps-to-wordpress-using-json/)

感谢你所做的一切

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T04:19:03.997

您在 Post 中缺少缩略图的 DataMember。在这里你可以找到一个完整的 WordPress JSON API 类：[http](http://msicc.net/?p=2929) ://msicc.net/?p=2929 希望这会有所帮助:-)

# php - 为什么这段代码没有抛出未定义的属性 PHP 通知？

> ID：13983237
> 
> 赞同：7
> 
> 时间：2012-12-21T01:50:34.280
> 
> 标签：php, variables, pass-by-reference

只是在玩，我发现了这个。

为什么引用调用`$this->newAxis()`不会抛出未定义的属性通知（**属性**`xAxis`），而`var_dump()`会？

```
public function newXAxis()
{
    // var_dump(isset($this->xAxis)); // false
    // var_dump($this->xAxis); // Throws the notice
    return $this->newAxis($this->xAxis); // Should throw the notice?!
}

protected function newAxis(&$current)
{
    // ...
} 
```

它是否与通过引用传递有关，因此不直接访问该属性？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T01:58:44.953

是的，它发生是因为您通过引用传递它。当您按值传递时，会尝试实际读取变量的值 - 因此会出现一条通知。通过引用传递时，不需要读取该值。

当您这样做时，如果变量/属性尚不存在，则会创建它。

从[手册](http://php.net/manual/en/language.references.whatdo.php#example-277)：

> 如果您通过引用分配、传递或返回未定义的变量，它将被创建。
> 
> ```
> <?php
> function foo(&$var) { }
> foo($a); // $a is "created" and assigned to null 
> ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-21T01:59:12.140

```
newAxis(&$current) 
```

是通过引用传递。这意味着您正在传递一个变量。

默认情况下，PHP 中的所有变量都是未定义的。

您只需使用即可定义它们，例如

```
$a = 1; 
```

如您所见，PHP 不会在这里抱怨`$a`未定义，对吧？

好的；），请参见此处：

```
$a = $b; 
```

PHP 现在抱怨`$b`未定义。

与`$a`（您定义变量）和`$b`（未定义变量）一样，它通过引用或按值传递：

```
$this->newAxis($a); 
```

变量`$a`在通过引用传递时定义。它带有它的默认值`NULL`。现在的`$b`例子：

```
var_dump($b); 
```

`var_dump`按值获取它的参数。因此 PHP 抱怨`$b`没有定义。

就这样。我希望它足够清楚。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-21T01:53:07.510

我要在这里走弯路了...

由于您将它作为一个对象（从一个类）访问它，它不会给您一个通知，而当您 var_dump 某些东西时，它就像一个数组一样访问它（并且由于它是空的，它会抛出一个通知）

# css - 如何在每个 Ruby on Rails 模板集合项之间呈现边框，但最后不呈现？

> ID：13983241
> 
> 赞同：0
> 
> 时间：2012-12-21T01:51:04.220
> 
> 标签：css, ruby-on-rails

我有一个要渲染的集合，但想在项目之间而不是在最后显示边界。这可能吗？

```
render :partial => 'classrooms/classroom_result', :collection => @result, :as => :classroom 
```

_classroom_result.html：

```
<div style='border-bottom:1px solid #CCCCCC;'>
  <%= classroom.name %>
</div> 
```

基本上有没有办法区分集合中的最后一项以进行样式设置？在这个例子中，我不想在最后一个项目上有border-bottom的css，因为我有一个围绕整个集合的边框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:12:17.003

首先这是一个 CSS 问题，而不是真正的 Rails 问题。

为此，您需要一个适当的样式表。我不认为你可以像你一样使用内联样式来做到这一点。接下来，您`<div>`需要一个 CSS 类来识别这个`<div>`s 列表，然后使用`:last-child`伪选择器禁用最后一个元素的边框。

在您的样式表中：

```
.classroom {
  border-bottom:1px solid #CCCCCC;
}

.classroom:last-child {
  border-bottom:0;
} 
```

在你的部分：

```
<div class="classroom">
  <%= classroom.name %>
</div> 
```

那应该这样做。此外， :last-child 在 <= IE8 中不起作用，但在大多数其他相对较新的浏览器中会起作用。

# groovy - Groovy 事实不一致？为什么不使用 == 运算符将列表强制为“true”？

> ID：13983244
> 
> 赞同：3
> 
> 时间：2012-12-21T01:51:13.843
> 
> 标签：groovy

以下所有断言都是`true`.

```
def obj = ["XXX"]
assert  true && obj // OK
assert  obj // OK
assert  ![] // OK 
```

为什么强制在以下一项中不起作用？

```
assert  true == obj // List is NOT coerced to true 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-21T02:28:40.283

因为 == 运算符不需要布尔操作数。

在第二种情况下应用强制，因为 && 运算符需要布尔操作数，而在第三种情况下，因为 assert 需要布尔操作数。但是 == 运算符接受任何类型的操作数，如果类型或值不同，则返回 false。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T14:06:59.473

在布尔上下文中评估时，空集合是错误的（AKA 错误），所以

```
assert ![] 
```

评估为`true`并且断言通过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-06T08:34:18.840

'==' 运算符被转换为一个**equals(Object o)**方法调用，因此它适用于任何类型的对象，而不仅仅是布尔值，因此没有理由强制转换为布尔值。

# jquery - jquery ui droppable 没有做任何事情

> ID：13983246
> 
> 赞同：0
> 
> 时间：2012-12-21T01:51:46.950
> 
> 标签：jquery, jquery-ui, jquery-ui-droppable

我似乎无法让我的 droppable 工作。当我把我的 .item 移动到 .itembox 时，它不会触发任何事情，但我没有做错任何事情（我猜）。这是学校的作业，我需要在早上之前把它修好。帮助将不胜感激。

```
$(".item").draggable();
$(".itembox").droppable({
    tolerance: "touch",
    drop: function() {
        console.log("hello");
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:02:04.097

你需要添加

```
 accept: 'div.item',
 drop: dropfunction 
```

, 到你的 droppable，其中 dropfunction 是在 drop 时触发的某种函数

我正在开发一个使用拖放的小[游戏](http://jsbin.com/unanuf/31/edit)`handleTileDrop`，您可以查看我的功能以获取更多详细信息

我希望这会有所帮助，祝你的项目好运:)

# c# - 如何在 C# 中编写一个看起来像 A(key, B(key, C(key, ValFactory(key)))) 的递归函数？

> ID：13983247
> 
> 赞同：3
> 
> 时间：2012-12-21T01:51:46.263
> 
> 标签：c#, function, recursion, functional-programming

如何编写具有这种形式的函数：

```
A(key, B(key, C(key, ValFactory(key)))) 
```

其中 A、B 和 C 具有此签名：

```
TResult GetOrAdd(string key, Func<string, TResult> generator); 
```

Valfactory 有签名：

```
TResult Get(string key); 
```

顺便说一句，“链接”函数的数量没有限制，因此它可以是 A、B 或 A、B、C 或 A、B、C、D、E 等。

我将函数 A、B、C 等存储在 LinkedList 中

我如何以我想要的方式称呼他们？

*编辑*添加一些信息以进行澄清：

我需要这个来实现多级缓存。有几个不同的缓存都实现了“GetOrAdd”功能。第一级缓存只是一个 ConcurrentDictionary 已经具有 GetOrAdd 函数。

缓存的工作方式是，如果一级缓存没有特定键的条目，它会尝试在二级缓存中查找。二级缓存在未命中时查找三级缓存等。

没有缓存应该知道另一个缓存，它应该只实现签名`TResult GetOrAdd(string, Func<string, TResult> functionToCallOnCacheMiss)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:07:38.353

如果您将每个 Func 存储在一个链表中，为什么不遍历该列表并使用前一个结果调用下一个 func 呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:58:41.843

我已经为它做了一个小例子。它没有使用两个不同的委托，而是只使用一个来简化事情。确保作为参数传递的最后一个方法不会尝试访问队列是用户的责任。不过，它可能可以重新排列。

```
public delegate TResult GetOrAdd<TResult>(string key, Queue<GetOrAdd<TResult>> generatorChain);

static T ExecuteChain<T>(string key, params GetOrAdd<T>[] generators)
{
    var queue = new Queue<GetOrAdd<T>>(generators.Skip(1));
    return generators.First()(key, queue);
}

static int A(string key, Queue<GetOrAdd<int>> generatorChain)
{
    var newKey = key.ToUpper();
    //You can perform checks on the queue
    //i.e. if it's empty, throw an exception
    var tempResult = generatorChain.Dequeue()(newKey, generatorChain);
    return tempResult*2;
}

static int B(string key, Queue<GetOrAdd<int>> generatorChain)
{
    var newKey = key.Insert(0, "My string is: ");
    var tempResult = generatorChain.Dequeue()(newKey, generatorChain);
    return tempResult + 1;
}

static int ValFactory(string key, Queue<GetOrAdd<int>> generatorChain)
{
    //Instead of defining another delegate, we just don't use the queue
    //You can still run your checks (i.e. throw exception if not empty)
    return key.GetHashCode();
} 
```

您可以通过以下方式调用链：

```
var result = ExecuteChain<int>("Hello world", A, B, ValFactory); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T03:40:33.120

鉴于这些定义：

```
public delegate TResult GetOrAdd<TResult>(string key, Func<string, TResult> generator);
public delegate TResult Get<TResult>(string key); 
```

你需要一个这样的函数：

```
public static Func<string, TResult> Chain<TResult>(Get<TResult> last, params GetOrAdd<TResult>[] funcs) {
    if (funcs.Count() == 0) return key => last(key);
    var head = funcs.First();
    var tail = funcs.Skip(1).ToArray();
    return key => head(key, Chain(last, tail));
} 
```

要编写这样的代码：

```
var result = Chain(ValFactory, A, B, C)(key); 
```

请注意，这看起来像是一种[责任链](http://en.wikipedia.org/wiki/Chain-of-responsibility_pattern)。

**更新**：您还可以`Chain`通过适配器函数简化并让客户端使用所需的参数排序：

```
public static GetOrAdd<TResult> Adapt<TResult>(Get<TResult> factory) {
    return (key, next) => factory(key);
}

public static Func<string, TResult> Chain<TResult>(params GetOrAdd<TResult>[] funcs) {
    if (funcs.Count() == 0) return null; // or return key => default(TResult);
    var head = funcs.First();
    var tail = funcs.Skip(1).ToArray();
    return key => head(key, Chain(tail));
}

...

var result = Chain(A, B, C, Adapt(ValFactory))(key); 
```

# c# - 对 int 或其他值类型的引用

> ID：13983251
> 
> 赞同：0
> 
> 时间：2012-12-21T01:52:15.483
> 
> 标签：c#

在启动时，我将一些大数据读入字典。然后在处理部分，这些值会改变很多次。问题是每次查找字典索引都需要很长时间。而且我不能使用“不安全”来访问指针。

所以我可以做类似的事情；

```
int dGeoLocationNorth = rawDataStore["GeoLoc_AC_154"]; // Raw data store is a custom implementation of a dict which is optimized
Console.WriteLine(dGeoLocatioNorth); // Output: 295
Console.WriteLine(rawDataStore["GeoLoc_AC_154"]); // Output: 295
dGeoLocationNorth = 1337;
Console.WriteLine(dGeoLocatioNorth); // Output: 1337
Console.WriteLine(rawDataStore["GeoLoc_AC_154"]); // Output: 1337 
```

关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:04:08.320

您可以创建一个类来包装您的值并将这些对象存储在您的字典中。

```
var dGeoLocationNorth = rawDataStore["GeoLoc_AC_154"]; // Raw data store is a custom implementation of a dict which is optimized
Console.WriteLine(dGeoLocatioNorth.Value); // Output: 295
Console.WriteLine(rawDataStore["GeoLoc_AC_154"].Value); // Output: 295
dGeoLocationNorth.Value = 1337;
Console.WriteLine(dGeoLocatioNorth.Value); // Output: 1337
Console.WriteLine(rawDataStore["GeoLoc_AC_154"].Value); // Output: 1337 
```

它不是太整洁，但它应该工作。

# javascript - How to determine which element is actually being hovered

> ID：13983253
> 
> 赞同：1
> 
> 时间：2012-12-21T01:52:31.253
> 
> 标签：javascript, jquery, drop-down-menu, menu, menubar

I do not know a lot of JS. Although I already did my own search, but I could not find out answers. So I am asking here and hope you can help me out.

I am trying to create a navigation menu based on div tag (like [http://www.adobe.com/](http://www.adobe.com/)), and using jQuery to make a function for "appear/disapper when hover".

Simple Div Structure:

```
<div id='menu'>
    <div> Level 1 a
            <div> Level 2 a </div> 
            <div> Level 2 b </div> 
    </div>
    <div> Level 1 b
            <div> Level 2 c </div> 
            <div> Level 2 d </div> 
    </div>
</div> 
```

I understand that it will need to use `$('#menu').hover()` function. My question is, if only use one id "menu", how or what kind of function I can use to determine which actual menu list is being hovered??

Like:

```
$("#menu").hover(                        // Div Menu is being hovered
    function () {
        // $el = Determine which menu inside of Div Menu is actually being hovered
        // $el.show();
    },
    function () {
        $el..hide();
    }
); 
```

Or maybe my structure is completely wrong, Should use another method to do this? Please help.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T01:58:01.613

```
$("#menu").hover(                        // Div Menu is being hovered
    function (event) {
        $el = $(event.target);
        $el.show();
    },
    function (event) {
        $el = $(event.target);
        $el.hide();
    }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T02:04:23.083

Actually, there is no `hover` event. There are [many different mouse events](http://www.quirksmode.org/js/events_mouse.html#mouseover) in two different models, and they are different in getting triggered from inner elements. Luckily, jQuery's [`hover`](http://api.jquery.com/hover/) method (actually [`mouseenter`](http://api.jquery.com/mouseenter) and [`mouseleave`](http://api.jquery.com/mouseleave)) abstracts over this and fires the handlers only when the parent element is hovered.

This means you have to bind the handler to every single element in the menu tree:

```
$("#menu div").hover(
    function (event) {
        console.log(event);
        $(this).children().show();
    },
    function (event) {
        $(this).children().hide();
    }
); 
```

[Demo at jsfiddle.net](http://jsfiddle.net/BQ3hL/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T02:25:41.843

Yes you could use the code you wrote for determining when you hover a div. Then you trigger a function for displaying the dropdown menu. When you define the css of the navigation bar you should set the part that doesn't have to be visible at the beginning to display:hidden; in the div, so it's hidden. Then through jquery you inject code into the css for changing the property display. I give you an example. Let's assume you create a div called "hidden" and set this in the css among other possible styles: #hidden { display:hidden }

Then you want the part with id "hidden" to appear when you hover the mouse. You can use:

```
$("#hidden").hover.css('display', 'block') 
```

so the hidden part will appear. Anyway you can create a dropdown menu even simply by using css only without jquery. Here i give you an example: Let's say you have this markup in the html file

```
<ul id="nav">
<li>
    <a href="#">Home</a>
</li>

<li>
    <a href="#">About</a>
    <ul>
        <li><a href="#">The product</a></li>

        <li><a href="#">Meet the team</a></li>
    </ul>
</li>
<li>
    <a href="#">Services</a>

    <ul>
        <li><a href="#">Sevice one</a></li>
        <li><a href="#">Sevice two</a></li>

        <li><a href="#">Sevice three</a></li>
        <li><a href="#">Sevice four</a></li>
    </ul>

</li>
<li>
    <a href="#">Product</a>
    <ul>
        <li><a href="#">Small product (one)</a></li>

        <li><a href="#">Small product (two)</a></li>
        <li><a href="#">Small product (three)</a></li>
        <li><a href="#">Small product (four)</a></li>

        <li><a href="#">Big product (five)</a></li>
        <li><a href="#">Big product (six)</a></li>
        <li><a href="#">Big product (seven)</a></li>

        <li><a href="#">Big product (eight)</a></li>
        <li><a href="#">Enourmous product (nine)</a></li>
        <li><a href="#">Enourmous product (ten)</a></li>

        <li><a href="#">Enourmous product (eleven)</a></li>
    </ul>
</li>
<li>
    <a href="#">Contact</a>

    <ul>
        <li><a href="#">Out-of-hours</a></li>
        <li><a href="#">Directions</a></li>

    </ul>
</li>
</ul> 
```

As you can see here the markup is simply a series of nested "ul". No verbose IDs/classes, no divs, just rich, semantic code.

The #nav ul contains a series of li, and any that require a dropdown then contain another ul. Notice the dropdown ul have no classes on them—this is because we use the cascade to style these, keeping our markup even cleaner.

Now the CSS:

```
#nav{
list-style:none;
font-weight:bold;
margin-bottom:10px;
/* Clear floats */
float:left;
width:100%;
/* Bring the nav above everything else--uncomment if needed.
position:relative;
z-index:5;
*/
}
#nav li{
float:left;
margin-right:10px;
position:relative;
}
#nav a{
display:block;
padding:5px;
color:#fff;
background:#333;
text-decoration:none;
}
#nav a:hover{
color:#fff;
background:#6b0c36;
text-decoration:underline;
}

/*--- DROPDOWN ---*/
#nav ul{
background:#fff; /* Adding a background makes the dropdown work properly in IE7+.     Make this as close to your page's background as possible (i.e. white page == white background). */
background:rgba(255,255,255,0); /* But! Let's make the background fully transparent      where we can, we don't actually want to see it if we can help it... */
list-style:none;
position:absolute;
left:-9999px; /* Hide off-screen when not needed (this is more accessible than     display:none;) */
}
#nav ul li{
padding-top:1px; /* Introducing a padding between the li and the a give the   illusion spaced items */
float:none;
}
#nav ul a{
white-space:nowrap; /* Stop text wrapping and creating multi-line dropdown items */
}
#nav li:hover ul{ /* Display the dropdown on hover */
left:0; /* Bring back on-screen when needed */
}
#nav li:hover a{ /* These create persistent hover states, meaning the top-most link stays 'hovered' even when your cursor has moved down the list. */
background:#6b0c36;
text-decoration:underline;
}
#nav li:hover ul a{ /* The persistent hover state does however create a global style for links even before they're hovered. Here we undo these effects. */
text-decoration:none;
}
#nav li:hover ul li a:hover{ /* Here we define the most explicit hover states--what happens when you hover each individual link. */
background:#333;
} 
```

So by using a nested unordered list and some css you can make an effective dropdown menu. That is the best solution according to me. Because the easier way you can make a thing the better it is.

For more details and a full explaination and demo of the dropdown menu, go to: [http://csswizardry.com/2011/02/creating-a-pure-css-dropdown-menu/](http://csswizardry.com/2011/02/creating-a-pure-css-dropdown-menu/)

Of course you can set the colors and style as you prefer.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-21T03:25:07.753

If you want a flyout vertical menu like that on Amazon check this example. It's simple, just html and css, no jquery. It looks alike.

HTML:

```
<ul class="nav">
<li>
    <a href="#">
        <strong>MP3s &amp; Cloud Player</strong> 18 million songs, play anywhere
    </a>
</li>
<li>
    <a href="#">
        <strong>MP3s &amp; Cloud Player</strong> 18 million songs, play anywhere
    </a>
    <ul>
        <li>
            <a href="#">
                <strong>Your Cloud Drive</strong> Anythign digital, securely stored, available anywhere
            </a>
        </li>
        <li>
            <a href="#">
                <strong>Learn more about cloud</strong>                </a>
        </li>
    </ul>
    <span class="cover"></span>
</li>
<li>
    <a href="#">
        <strong>Kindle</strong>
    </a>
</li>
</ul>​ 
```

CSS:

```
ul.nav{
font-size: 10px;
font-family: Verdana, Helvetica;
width: 200px;
background: #edf7ff;      
}

ul.nav li{
padding: 5px 4px;   
border: 1px solid #85abc9;
margin-bottom: -1px;
position: relative;
background: url(http://www.qualitymetric.com/Portals/0/images/orange_arrow.png) no-    repeat 185px center;
}

ul.nav > li:hover{
background: #fff;
border: 1px solid #999;
z-index:1;
box-shadow: 0px 1px 0px #999;
-moz-box-shadow: 0px 1px 0px #999;
}

ul.nav > li:hover > span{
width: 5px;
height: 100%;
background: #fff;
position: absolute;
top: 0px;
bottom: 0px;
right: 15px;
z-index: 10;
}

ul.nav li a{
color: #666;
text-decoration: none;
}

ul.nav li a strong{
font-size: 11px;
color: #333;
font-weight: bold;
display: block;
}

/* dropdown */

ul.nav li ul{
width: 200px;
padding-left: 12px;
background: #fff;
border: 1px solid #999;
position: absolute;
border-radius: 4px;
-moz-border-radius: 4px;
box-shadow: 1px 1px 0px #999;
-moz-box-shadow: 1px 1px 0px #999;
top: -1px;
left: 180px;
z-index: 9;
display: none;
}

ul.nav li:hover > ul{
display: block;           
}

ul.nav li ul li{
border: none;
padding-left: 12px;
background: url(http://www.qualitymetric.com/Portals/0/images/orange_arrow.png) no-    repeat 0px 6px;
}

ul.nav li ul li a strong{
font-weight: normal;
color: #034995;
} 
```

Look at the code and demo here: [http://jsfiddle.net/blackpla9ue/KHLgm/8/](http://jsfiddle.net/blackpla9ue/KHLgm/8/) You can edit and add things as you prefer. ​</p>

# javascript - 将照片发布到与用户无关的 Facebook 页面

> ID：13983258
> 
> 赞同：0
> 
> 时间：2012-12-21T01:53:08.337
> 
> 标签：javascript, facebook-javascript-sdk

我正在构建一个网站，允许任何经过身份验证的 Facebook 用户将照片发布到与 Facebook 页面关联的特定相册。我正在为此任务使用 JavaScript SDK。这是我到目前为止的代码：

```
window.fbAsyncInit = function () {
    FB.init({
        appId: "492414284132122",
        status: true,
        cookie: true,
        xfbml: true,
        channelUrl: "http://wineoclock.dev.mag/ClockMoments/channel.html"
    });
};

function uploadPhoto() {
    console.log("called uploadPhoto()...");
    FB.login(function (response) {
        if (response.authResponse) {
            document.getElementById("access_token").value = FB.getAuthResponse()["accessToken'];
            var form = document.getElementById("fbPhotoUpload");
            var formData = new FormData(form);
                    // indicate to user that upload is in progress
            document.getElementById("btnUpload").value = "Posting...";
            document.getElementById("btnUpload").disabled = true;
            // post photo to Facebook
            $.ajax({
                type: "POST",
                    // post to "Timeline Photos" album
                url: "https://graph.facebook.com/283773431737369/photos",
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                dataType: "json",
                success: function (response, status, jqXHR) {
                    console.log("Status: " + status);
                    if (!response || response.error) {
                        alert("Error occured:" + response.error.message);
                    }
                    else {
                        document.getElementById("fbPhotoUpload").reset();
                        $("#ThanksModal").reveal();
                    }
                    document.getElementById("btnUpload").value = "Post Photo";
                    document.getElementById("btnUpload").disabled = false;
                },
                error: function (jqXHR, status, errorThrown) {
                    console.log("AJAX call error. " + status);
                    console.log("errorThrown: " + errorThrown);
                },
                complete: function (jqXHR, status) {
                    console.log("AJAX call complete. " + status);
                }
            });
        }
        else {
            alert("Login failed: " + response.error);
        }
    });
} 
```

运行上面的代码，我发现选择的图像被上传，但它被上传到登录的 Facebook 帐户。这不是我想要的。我想将它上传到目标粉丝页面（在 AJAX POST 请求中指定），而不是登录用户。

我在 Internet 上读到我需要请求页面访问令牌，而不是用户访问令牌。为此，我需要以目标页面的身份登录，如此处 Facebook 文档中[所述](https://developers.facebook.com/docs/howtos/login/login-as-page/)。

有没有一种无需以 Facebook 页面管理员身份登录即可检索页面访问令牌的方法？如果需要，可以在幕后进行登录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-23T23:14:30.060

编辑：我想我误解了你；我发布的链接中描述的过程导致为任何用户获取访问令牌，您只需执行一次。

我坚信这是不可能的；如果可行，几乎任何应用程序都可以在任何粉丝专页上发布。

根据此处的解决方案：[Extended Facebook Page Access Token](https://stackoverflow.com/questions/10183625/extending-facebook-page-access-token)，您需要具有管理员权限才能将您的短期页面访问令牌转换为长期（实际上是 2 个月而不是几个小时）。整个过程在链接中有很好的描述。

# web - 如何在 IIS 上创建隐藏网站 - 具有多个用户帐户的 IIS

> ID：13983273
> 
> 赞同：5
> 
> 时间：2012-12-21T01:55:21.960
> 
> 标签：web, iis-7.5, hide, windows-server-2008-r2

我有一个小服务器插件，以及 IIS 和其他一些东西。是否可以允许第二个用户访问 IIS 管理器，具有创建和编辑站点的能力，但将两个帐户的站点分开？

我不担心两个帐户之间的安全性，只是为了整洁而将两个帐户的站点分开，这样一个用户就不会意外更改与另一个帐户相关的内容。目前我有两个用户属于管理员组，如果我用其中一个打开 IIS 管理器，它们都会显示所有站点。

已经问过一个类似的问题：[how to create hidden web site on IIS](https://stackoverflow.com/questions/2015237/how-to-create-hidden-web-site-on-iis)

您能否扩展该线程的答案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T22:09:14.483

**更新 1**

远程连接到站点将允许其他站点显示为隐藏，因为您只会看到连接站点。请参阅：[如何使用 Internet 信息服务 (IIS) 7 管理器远程连接到您的网站](http://blog.arvixe.com/how-to-use-internet-information-services-iis-7-manager-to-connect-remotely-to-your-website/)。

* * *

**更新 0**

至于隐藏站点和其他功能，请查看：[IIS 的管理配置是什么？](http://blogs.iis.net/davcox/archive/2009/12/02/what-is-administration-config-for-iis.aspx)

> IIS7 的一个鲜为人知的特性是它的 UI 是完全可扩展的！这意味着任何人都可以编写 C# 程序集并通过 IIS 管理器 UI 显示它。这里的可能性是无穷无尽的，任何人都可以编写新的证书管理系统、网站供应系统等。

我还没有找到说明可以隐藏实际站点的文档，但听起来应该是可能的。

[IIS 7.0 中的功能委派概述](http://www.iis.net/learn/manage/managing-your-configuration-settings/an-overview-of-feature-delegation-in-iis)还可以提供隐藏站点的功能。

其他链接：

*   [如何在 IIS 7 中隐藏“非委托”功能？](https://serverfault.com/questions/119419/how-do-i-hide-non-delegated-features-in-iis-7?rq=1)

* * *

根据您的描述，Microsoft 关于[为 IIS 管理器用户和 Windows 用户 (IIS 7) 配置权限](http://technet.microsoft.com/en-us/library/cc754009%28v=ws.10%29.aspx)的文档可能会有所帮助。例如：

*   [允许 IIS 管理器用户帐户连接到站点或应用程序 (IIS 7)](http://technet.microsoft.com/en-us/library/cc770968%28v=ws.10%29.aspx)

    > 注意：要让 IIS 管理器用户连接到您授予权限的站点和应用程序，您必须将管理服务配置为接受来自具有 IIS 管理器凭据的用户的连接。有关如何配置管理服务的详细信息，请参阅[在 IIS 7 中配置管理服务](http://technet.microsoft.com/en-us/library/cc754321%28v=ws.10%29.aspx)。

*   [为 IIS 管理器用户和 Windows 用户 (IIS 7) 配置权限](http://technet.microsoft.com/en-us/library/cc754009%28v=ws.10%29.aspx)- 添加了重点。

    > 使用 IIS 管理器权限功能**允许用户连接到 IIS 管理器中的站点和应用程序。当您不再希望用户在站点或应用程序中配置委派功能时，请删除用户帐户。**
    > 
    > **允许的用户可以在您授予他们权限的任何站点或应用程序中配置委托功能。**用户可以是 IIS 管理器用户（使用 IIS 管理器用户功能在 IIS 管理器中创建的凭据），也可以是本地计算机或计算机所属域上的 Windows 用户和组。

# iphone - 使用 UIWebView 滚动的 UILabels

> ID：13983274
> 
> 赞同：2
> 
> 时间：2012-12-21T01:55:33.950
> 
> 标签：iphone, ios, uiwebview, uilabel, uistoryboard

我的项目中有一个控制器，其中包含三个`UILabels`（标题、创建者和发布日期）`UIWebView`，底部显示`html`使用`loadHtmlString`. 现在`UIWebView`可以在底部滚动，而标签在屏幕上保持静态。我想要做的是将所有这些滚动在一起。如果有人可以帮助如何在 StoryBoards 中做到这一点。

![屏幕布局](../Images/2611130d93fd9533de85f699d82a8ba4.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T04:47:42.737

只需添加它`UILable`并`UIWebView`作为`UIScrollView`.. 的子视图和

在`- (void)webViewDidFinishLoad:(UIWebView *)webView {" delegate method I detect the size of the UIWebView`方法中只需设置 WebView 的 contentSize 和如下所示的滚动视图...

```
 [yourWebView setContentSize:CGSizeMake(320, yourWebView.contentSize.height)];
 [yourScrollView setContentSize:CGSizeMake(320,    scrView.frame.origin.y + yourWebView.contentSize.height)]; 
```

只需根据您的要求设置整个控件的框架...

希望这可以帮助你...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:20:57.567

将 UIScrollView 添加到您的视图中。将标签和 UIWebView 添加到 UIScrollview。这是它在 Interface Builder 中的外观。

![在此处输入图像描述](../Images/087e3112fd2974b87ddb55ccdcd56d95.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T03:00:23.237

请参阅此链接可能对您有所帮助： http: [//atastypixel.com/blog/a-drop-in-universal-solution-for-moving-text-fields-out-of-the-way-of-the-keyboard/评论页面 1/](http://atastypixel.com/blog/a-drop-in-universal-solution-for-moving-text-fields-out-of-the-way-of-the-keyboard/comment-page-1/)

您应该尝试在代码中实现 TPKeyboardAvoidingScrollView。请参阅此链接。

# javascript - 通过 http 传输大量 json

> ID：13983279
> 
> 赞同：1
> 
> 时间：2012-12-21T01:57:43.060
> 
> 标签：javascript, json, http, bigdata, data-transfer

我有大量（千兆字节）的 json 数据，我想通过一个安静的 Web 服务提供这些数据。数据的消费者将是另一个服务，并且这一切都将发生在服务器上（因此不涉及浏览器）。可以通过 http 传输多少数据是否有实际限制？http超时会开始发生，还是更多的是浏览器的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T02:48:00.697

HTTP 正文没有大小限制。就像通过网络浏览器下载一个巨大的文件一样。超时是套接字连接的设置，HTTP 是在其上构建的，因此它不是浏览器指定的功能。

但是，我在传输相当大的 json 对象时遇到了同样的问题。需要考虑的是网络负载、序列化/反序列化时间和内存成本。整个过程很慢（2GB 的数据，通过 Intranet，使用 JSON.NET 和一些计算我们需要 2-3 分钟），并且需要相当大的内存。幸运的是，我们只需要每天执行一次，这是一个后端过程。所以我们不怎么关注它。我们只是对 HTTP 连接使用同步模式，并设置一个较长的超时值来防止超时异常（也许 async 是一个不错的选择）。

所以我认为这取决于你的硬件和基础设施。

# zend-framework - xampp上的zend框架安装

> ID：13983281
> 
> 赞同：2
> 
> 时间：2012-12-21T01:57:46.090
> 
> 标签：zend-framework

我对 ZEND FRAMEWORK 完全陌生。我尝试安装但遇到了一些错误。

当我安装 zf@1 版本时。

1.  我将我的文件夹提取到路径中。`C:\xampp\php`将其命名为 zendframework。
2.  我将 php.ini 文件的 include_path 编辑为`include_path = ".;C:\xampp\php\PEAR;C:\xampp\php\zendframework\library"`
3.  重新启动的服务器。
4.  使用路径 C:\xampp\php\（我的确切 zf.bat 文件所在的位置）运行 cmd
5.  运行命令`zf show version`以 zf 错误结束，我的 zend 框架应该在包含路径中。

    *   如何解决此错误？
    *   问题是否已解决我的下一个命令`zf create project zend_blog`是否正确？
    *   如何使用 zf1 和 zf 2 创建项目？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-09T10:04:36.373

```
 Follow the given Instruction Below.

  • Go to ‘My Computer’ > Properties > Advanced Tab > Environment Variables. 
   Environment Variables box will open, View SYSTEM VARIABLES, 
    scroll the list to ’ PATH ‘ > double click ’ PATH ‘ .
      Add the following line to the end of the PATH  C:\xampp\php
    Zend Framework
  • Extract the Zend Framework files to C:\xampp\php\zf.
   •    Edit the php.ini file. You will find it at C:\xampp\php\php.ini. 
    Find the line that says ’ include_path ’ and edit the line: 
 Windows: “\path1;\path2″
  include_path = “C:\xampp\php\zf\library”
  • Open a shell and cd to C:\xampp\htdocs folder and type this:
    C:\xampp\htdocs>C:\xampp\php\ZendFramework\bin\zf.bat create project    testproject(project name)

  • Now Copy the Zend Folder from your ZendFramework folder ( C:\xampp\php\zf/library /Zend) into the library folder of your new test project ( C:\xampp\htdocs\testproject\library\Zend 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:04:57.417

它与 XAMPP 无关。某些东西未配置正确或不正确的权限。

见这些：

*   [在 Windows 上设置 CLI 工具](http://framework.zend.com/manual/1.12/en/zend.tool.framework.clitool.html#zend.tool.framework.clitool.setup-windows)
*   另外，请参阅[此线程](https://stackoverflow.com/questions/13913649/zend-project-not-working-on-xampp/13918250#13918250)
*   您也可以考虑使用 NetBeans IDE，它对 ZF 工具有很好的支持。[看看这个教程](http://netbeans.org/kb/docs/php/zend-framework-screencast.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T10:18:15.290

您需要将 zend 框架路径和 php.exe 路径放入您的[windows 路径变量](http://www.computerhope.com/issues/ch000549.htm)中，以便从命令行运行命令。这在 ZF1 中很重要，因此 Zend_Tool 将在命令行或 Netbeans 或其他 Ide 中工作。

# java - Java 打印问题

> ID：13983282
> 
> 赞同：2
> 
> 时间：2012-12-21T01:57:54.837
> 
> 标签：java, printing

我在通过 java 发送要打印到我的打印机的文档时遇到很多问题，我没有收到任何错误消息或任何东西，我可以在队列中看到打印作业，但它没有打印出任何东西，我已经重新安装了打印机驱动程序等但没有运气，到目前为止我唯一的运气是一个代码可以完美运行并发送并成功打印出文档。

下面是有效的java代码：

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.print.*;
import java.text.*;
/**
* The PrintText application expands on the
* PrintExample application in that it images
* text on to the single page printed.
*/
public class PrintText implements Printable {
/**
* The text to be printed.
*/
private static final String mText = 
"Four score and seven years ago our fathers brought forth on this "
+ "continent a new nation, conceived in liberty and dedicated to the "
+ "proposition that all men are created equal. Now we are engaged in "
+ "a great civil war, testing whether that nation or any nation so "
+ "conceived and so dedicated can long endure. We are met on a great "
+ "battlefield of that war. We have come to dedicate a portion of "
+ "that field as a final resting-place for those who here gave their "
+ "lives that that nation might live. It is altogether fitting and "
+ "proper that we should do this. But in a larger sense, we cannot "
+ "dedicate, we cannot consecrate, we cannot hallow this ground." 
+ "The brave men, living and dead who struggled here have consecrated "
+ "it far above our poor power to add or detract. The world will "
+ "little note nor long remember what we say here, but it can never "
+ "forget what they did here. It is for us the living rather to be "
+ "dedicated here to the unfinished work which they who fought here "
+ "have thus far so nobly advanced. It is rather for us to be here "
+ "dedicated to the great task remaining before us--that from these "
+ "honored dead we take increased devotion to that cause for which "
+ "they gave the last full measure of devotion--that we here highly "
+ "resolve that these dead shall not have died in vain, that this "
+ "nation under God shall have a new birth of freedom, and that "
+ "government of the people, by the people, for the people shall "
+ "not perish from the earth.";
/**
* Our text in a form for which we can obtain a
* AttributedCharacterIterator.
*/
private static final AttributedString mStyledText = new AttributedString(mText);
/**
* Print a single page containing some sample text.
*/
static public void main(String args[]) {
/* Get the representation of the current printer and 
* the current print job.
*/
PrinterJob printerJob = PrinterJob.getPrinterJob();
/* Build a book containing pairs of page painters (Printables)
* and PageFormats. This example has a single page containing
* text.
*/
Book book = new Book();
book.append(new PrintText(), new PageFormat());
/* Set the object to be printed (the Book) into the PrinterJob.
* Doing this before bringing up the print dialog allows the
* print dialog to correctly display the page range to be printed
* and to dissallow any print settings not appropriate for the
* pages to be printed.
*/
printerJob.setPageable(book);
/* Show the print dialog to the user. This is an optional step
* and need not be done if the application wants to perform
* 'quiet' printing. If the user cancels the print dialog then false
* is returned. If true is returned we go ahead and print.
*/
boolean doPrint = printerJob.printDialog();
if (doPrint) {
try {
printerJob.print();
} catch (PrinterException exception) {
System.err.println("Printing error: " + exception);
}
}
}
/**
* Print a page of text.
*/
public int print(Graphics g, PageFormat format, int pageIndex) {
/* We'll assume that Jav2D is available.
*/
Graphics2D g2d = (Graphics2D) g;
/* Move the origin from the corner of the Paper to the corner
* of the imageable area.
*/
g2d.translate(format.getImageableX(), format.getImageableY());
/* Set the text color.
*/
g2d.setPaint(Color.black);
/* Use a LineBreakMeasurer instance to break our text into
* lines that fit the imageable area of the page.
*/
Point2D.Float pen = new Point2D.Float();
AttributedCharacterIterator charIterator = mStyledText.getIterator();
LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
float wrappingWidth = (float) format.getImageableWidth();
while (measurer.getPosition() < charIterator.getEndIndex()) {
TextLayout layout = measurer.nextLayout(wrappingWidth);
pen.y += layout.getAscent();
float dx = layout.isLeftToRight()? 0 : (wrappingWidth - layout.getAdvance());
layout.draw(g2d, pen.x + dx, pen.y);
pen.y += layout.getDescent() + layout.getLeading();
}
return Printable.PAGE_EXISTS;
}
} 
```

但

这不是我想要做的，理想情况下我需要能够发送像 txt 文件这样的文档来打印，而不仅仅是我添加的一些文本，所以下面的代码不起作用，没有错误消息，甚至说打印完成。 .... 在终端中，可以在队列中再次看到这项工作，但从未打印出任何内容，我做错了什么？

```
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.File;
import java.io.FileInputStream;

import javax.print.Doc;
import javax.print.DocFlavor;
import javax.print.DocPrintJob;
import javax.print.PrintException;
import javax.print.PrintService;
import javax.print.PrintServiceLookup;
import javax.print.SimpleDoc;

import javax.print.attribute.HashPrintRequestAttributeSet;
import javax.print.attribute.PrintRequestAttributeSet;
import javax.print.attribute.standard.Copies;

import javax.print.event.PrintJobAdapter;
import javax.print.event.PrintJobEvent;

public class PrintTextFile {

  public static void main(String[] args) throws PrintException, IOException {
    String defaultPrinter =
      PrintServiceLookup.lookupDefaultPrintService().getName();
    System.out.println("Default printer: " + defaultPrinter);

    PrintService service = PrintServiceLookup.lookupDefaultPrintService();

    FileInputStream in = new FileInputStream(new File("D:/Documents/testDocToPrintUsingJava.txt"));

    PrintRequestAttributeSet  pras = new HashPrintRequestAttributeSet();
    pras.add(new Copies(1));

    DocFlavor flavor = DocFlavor.INPUT_STREAM.AUTOSENSE;
    Doc doc = new SimpleDoc(in, flavor, null);

    DocPrintJob job = service.createPrintJob();
    PrintJobWatcher pjw = new PrintJobWatcher(job);
    job.print(doc, pras);
    pjw.waitForDone();
    in.close();

    // send FF to eject the page
    InputStream ff = new ByteArrayInputStream("\f".getBytes());
    Doc docff = new SimpleDoc(ff, flavor, null);
    DocPrintJob jobff = service.createPrintJob();
    pjw = new PrintJobWatcher(jobff);
    jobff.print(docff, null);
    pjw.waitForDone();
  }
}

class PrintJobWatcher {
  boolean done = false;

  PrintJobWatcher(DocPrintJob job) {
    job.addPrintJobListener(new PrintJobAdapter() {
      public void printJobCanceled(PrintJobEvent pje) {
        allDone();
      }
      public void printJobCompleted(PrintJobEvent pje) {
        allDone();
      }
      public void printJobFailed(PrintJobEvent pje) {
        allDone();
      }
      public void printJobNoMoreEvents(PrintJobEvent pje) {
        allDone();
      }
      void allDone() {
        synchronized (PrintJobWatcher.this) {
          done = true;
          System.out.println("Printing done ...");
          PrintJobWatcher.this.notify();
        }
      }
    });
  }
  public synchronized void waitForDone() {
    try {
      while (!done) {
        wait();
      }
    } catch (InterruptedException e) {
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:24:04.913

下面的代码将打印一个文本文件。如果需要，您可以使用它。

```
public void printimg() throws FileNotFoundException, PrintException, InterruptedException {
    String filename = ("item.text"); // THIS IS THE TEXT FILE TO PRINT
    try{
    PrintRequestAttributeSet pras = new HashPrintRequestAttributeSet();
    DocFlavor flavor = DocFlavor.INPUT_STREAM.TEXT_PLAIN_UTF_8; //  FILE IS .txt TYPE
    PrintService printService[] =
            PrintServiceLookup.lookupPrintServices(flavor, pras);
    PrintService defaultService =
            PrintServiceLookup.lookupDefaultPrintService();
    PrintService service = ServiceUI.printDialog(null, 200, 200,
            printService, defaultService, flavor, pras);
    if (service != null) {
        DocPrintJob job = service.createPrintJob();
        FileInputStream fis = new FileInputStream(filename);
        DocAttributeSet das = new HashDocAttributeSet();
        Doc doc = new SimpleDoc(fis, flavor, das);
        job.print(doc, pras);

    }
    }
    catch(Exception a){
        JOptionPane.showMessageDialog(null, "OPeration Failed");
    }
} 
```

此功能可用于打印您的文本文件。您应该导入的库是

import javax.print.*;
导入 javax.print.attribute.DocAttributeSet；
导入 javax.print.attribute.HashDocAttributeSet；
导入 javax.print.attribute.HashPrintRequestAttributeSet；
导入 javax.print.attribute.PrintRequestAttributeSet；

# mysql - MySQL随机更新疯狂

> ID：13983290
> 
> 赞同：0
> 
> 时间：2012-12-21T01:59:52.153
> 
> 标签：mysql, database, stored-procedures

我有一个`mst2`创建最小生成树并`MST`使用多个值更新数据库中的表的过程。它适用于 WAMP，但当我尝试在实时服务器上导入它时表现得很疯狂。

目前，每次我重新加载表时，随机值都会出现在其中并且似乎会上下波动？？我不知道是怎么回事。我什至没有调用该函数，但表格似乎在不断地动态调整。

我会发布我的代码，但它可能有点矫枉过正，它非常广泛。如果有人对可能导致这种情况的原因有一般的想法，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T15:56:24.300

The problem was the fact that I was referencing the table in lowercase as `'mst'` in some parts of the code relying on the fact that MySQL isn't case sensitive. Apparently the server I was importing to (Linux) had MySQL configured to be case sensitive for table (and possibly column?) names, fixing the table name in the code from lower to upper solved the issue.

# java - 使用静态修改器跟踪对象实例

> ID：13983292
> 
> 赞同：1
> 
> 时间：2012-12-21T02:00:23.063
> 
> 标签：java, android, static, instance

我目前正在编写一个 Android 应用程序，并且我有一个关于何时使用静态方法/字段的更高级别的问题。

我的应用程序跟踪不同活动的时间使用情况，每个活动都是一个类的实例。我需要一个可以返回这个类的所有实例的方法。

像这样在我的 Activity 类中放置静态方法/字段是否是糟糕的设计：

```
static ArrayList<Activity> allInstances;    
public static void addToComprehensiveList(Activity a) {
    if(allInstances == null)
        allInstances = new ArrayList<Activity>();
    allInstances.add(a);
}
public static ArrayList<Activity> getComprehensiveList() {
    return allInstances;
} 
```

这里正确的设计选择是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T02:15:58.463

Keeping a static list of instances is a fairly safe and normal thing to do. The main gotchas have to do with when you add items to the list.

For example, if `Activity` has a nontrivial constructor that calls `addToComprehensiveList(this)` when it starts, then there are times when not-fully-initialized objects are in a publicly accessible list. If your program is single-threaded, this isn't too dangerous - unless the constructor later throws an exception, in which case the object is left in the list in a not-fully-initialized state.

A safe way around this is to create your instances in a factory method that adds the object to the list after it is created. Of course, if there are no subclasses, just adding to the list as the last statement in the constructor works fine.

The other danger here is that `getComprehensiveList()` returns a reference to its instance list, which means that client code could be modifying that list without your class knowing. Even if the client just iterates through the list, you would get a commodification exception if you create a new Activity during their iteration. A safer approach is to return a copy of the list.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-21T02:36:58.823

根据我在重压或内存使用情况下做这样的事情的经验：

```
static ArrayList<Activity> allInstances; 
```

不保证可用。VM 可以取消它，这就是 Singleton 可能更安全的原因。

# javascript - 图片幻灯片不适用于 Google Chrome

> ID：13983293
> 
> 赞同：-4
> 
> 时间：2012-12-21T02:00:27.297
> 
> 标签：javascript, jquery, html, google-chrome

此图像幻灯片适用于所有浏览器，但不适用于 Google Chrome [http://www.alternativechauffage.com](http://www.alternativechauffage.com)

知道如何解决吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:07:10.767

我认为这可能是您的问题：

[Nivo Slider 在 Chrome 和 Safari 中出现问题](https://stackoverflow.com/questions/4824140/nivo-slider-having-problem-in-chrome-safari)

```
#nivo-slider is supposed to have a height and width specified 
```

# php - PHP $_SESSION 变量意外运行

> ID：13983296
> 
> 赞同：2
> 
> 时间：2012-12-21T02:01:12.643
> 
> 标签：php, session, login, session-variables

我正在为我正在为网站的“成员”部分工作的网站创建一个非常基本的用户登录界面。我正在使用 $_SESSION 变量来存储信息。['access'] 存储一个关于用户是否被允许访问的布尔值，如果用户名/密码不匹配，['invalid'] 为真（用于错误处理），如果 ['no_attempt'] 为真用户尝试在未登录的情况下访问受限页面，并且 ['uri'] 存储他们尝试在未登录的情况下访问的页面的 URI。

到目前为止，按照我对页面的编码方式，一切正常，除了当 ['no_attempt'] 为真时永远不会显示错误消息。以下是我网页的摘录：

**登录.php**

```
session_start();
if(md5($_POST['username']) === '[username hash]' && md5($_POST['password']) === '[password hash]') {
    // allow access to members pages    
    $_SESSION['login']['allow'] = true;

    // clear error messages
    $_SESSION['login']['invalid'] = false;
    $_SESSION['login']['no_attempt'] = false;

    // if a url hasn't been stored for redirect, direct to the members home page
    if (!isset($_SESSION['login']['redirect']) || empty($_SESSION['login']['redirect'])) $_SESSION['login']['redirect'] = '/members';
    header("Location: {$_SESSION['login']['redirect']}");
}
else {
    $_SESSION['login']['invalid'] = true;
    header('Location: /');
} 
```

**每个受限页面的开头都以以下代码开头：**

```
session_start();
if($_SESSION['login']['allow'] != true) {
    $_SESSION['login']['redirect'] = $_SERVER['REQUEST_URI'];
    $_SESSION['login']['no_attempt'] = true;
    header('Location: /');
}
require ('../assets/includes/site-header.php'); 
```

**site-header.php**
这个页面在我网站每个页面的开头被调用。它有标题、导航栏和类似的东西。下面只是侧边栏的会员登录部分。

```
if(isset($_SESSION['login']['allow']) && $_SESSION['login']['allow'] == true) {
    echo "<li><a href=\"/members\" id=\"members\">Members</a></li>\n";
}
else {
    echo "<li>\n";
    echo "<div class=\"expandable\">Members <span class=\"show-hide\">+</span></div>\n";
    echo "<div class=\"nav-details\">\n";
    if (isset($_SESSION['login']['invalid']) && $_SESSION['login']['invalid'] == true) {
        echo "<div id=\"login-error\">The username or password you<br />entered was incorrect.</div>\n";                                    
    }
    elseif (isset($_SESSION['login']['no_attempt']) && $_SESSION['login']['no_attempt'] == true) {
        echo "<div id=\"login-error\">You must login before<br />accessing that page.</div>\n";
    }
    echo "<form method=\"post\" action=\"/members/login.php\" id=\"login-form\">\n";
    echo "Username:<br />\n";
    echo "<input type=\"text\" name=\"username\" /><br /><br />\n";
    echo "Password:<br />\n";
    echo "<input type=\"password\" name=\"password\" /><br /><br />\n";
    echo "<input type=\"submit\" value=\"Login\" id=\"login-button\" />\n";
    echo "</form>\n";
    echo "</div>\n";
    echo "</li>\n";
}
$_SESSION['login']['invalid'] = false;
$_SESSION['login']['no_attempt'] = false; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:09:42.977

我终于能够解决我的问题了！错误在于我在每个受限页面顶部包含的代码片段。我变了：

```
session_start();
if($_SESSION['login']['allow'] != true) {
    $_SESSION['login']['redirect'] = $_SERVER['REQUEST_URI'];
    $_SESSION['login']['no_attempt'] = true;
    header('Location: /');
}
require ('../assets/includes/site-header.php'); 
```

对此：

```
session_start();
if($_SESSION['login']['allow'] != true) {
    $_SESSION['login']['redirect'] = $_SERVER['REQUEST_URI'];
    $_SESSION['login']['no_attempt'] = true;
    header('Location: /');
}
else {
    require ('../assets/includes/site-header.php');
} 
```

我猜这与我`$_SESSION['login']['invalid'] = false; $_SESSION['login']['no_attempt'] = false;`在 site-header.php 上的设置有关。我仍然是 php 的初学者，但我认为 site-header.php 上的 php 代码可能是由于在页面重定向页面之前需要处理的，`header('Location: /');`如果有人知道这是否是我的问题得到修复的原因，或者如果它是为了别的东西，我会很高兴听到它！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-02T23:56:10.377

将这部分代码分开...

```
 elseif (isset($_SESSION['login']['no_attempt']) && $_SESSION['login']['no_attempt'] == true) {
    echo "<div id=\"login-error\">You must login before<br />accessing that page.</div>\n";
} 
```

到以下...

```
 elseif(isset($_SESSION['login']['no_attempt'])
    {
        if($_SESSION['login']['no_attempt'] === true)
          {
                echo "<div id=\"login-error\">You must login before<br />accessing that page.</div>\n";
          }
    } 
```

看看这是否有效。注意我使用了“===”运算符...这确保它是“相同的”

# sql - SQL 查询以查找哪个组没有给定值

> ID：13983297
> 
> 赞同：2
> 
> 时间：2012-12-21T02:01:17.170
> 
> 标签：sql

我正在使用 T-SQL。

说如果我有以下

```
Value     Nbr
-----     ---
one       6
one       7
one       8
two       6
two       7
three     5
three     3
three     2 
```

在上表中，我需要找出哪个组中没有 6。在这种情况下，它是 3，因为它没有 6。

这样做的最佳方法是什么？

我试过了：

```
 select Value from tbl1 
      where nbr <> 6
      group by Value 
```

但没有得到预期的结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T02:11:30.857

```
select distinct value
from tbl1
where value not in
(
    select distinct value
    from tbl1
    where nbr = 6
) 
```

# processing - Processing 如何保存草图？

> ID：13983301
> 
> 赞同：1
> 
> 时间：2012-12-21T02:02:08.687
> 
> 标签：processing, processing-ide

我刚开始学习处理，我发现每当我保存草图时，它都会创建一个新文件夹。我试图在文件夹中以不同的名称另存为草图，但这是不允许的。我收到此错误消息：“您无法将草图保存到其内部的文件夹中。这将永远持续下去。” 你能解释一下在Processing中保存草图的逻辑吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T13:25:41.633

通常，处理草图由与草图同名的文件夹中的 .pde 文件组成。这使得处理 IDE 更容易处理诸如处理资产（数据文件夹）、编译草图、导出等任务。

如果您想将草图组织成组，您可以为每个组创建一个新文件夹，然后将您需要的草图保存在那里。草图本身会创建自己的文件夹，因此您不需要。

如果要保存现有草图的另一个版本，请选择不同的草图名称，但选择草图文件夹作为旧/现有草图的兄弟（在同一级别/下一个）。

# .htaccess - .htaccess 将子域重定向到根域

> ID：13983306
> 
> 赞同：0
> 
> 时间：2012-12-21T02:03:01.057
> 
> 标签：.htaccess

也许我只是不知道如何提出问题以找到答案，但我想要做的是从旧 URL shop.nilandsplace.com/camp 到 nilandsplace.com/store/camping 的 .htaccess 重定向。不要让它变得更困难，但我想知道我在做什么，所以我可以学习这个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:19:39.733

尝试这个：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^shop.nilandsplace.com$
RewriteRule ^camp(.*)$ http://nilandsplace.com/store/camping$1 [R=301,L] 
```

第一行打开了重写引擎。我们需要在重写任何 URL 之前执行此操作。

第二行检查我们是否正在访问该`shop.nilandsplace.com`域。

第三行将任何请求从 重定向`/camp`到`http://nilandsplace.com/store/camping`。第三行末尾括号中的位告诉 Apache 将此设置为 301 重定向（以便搜索引擎知道页面已移动），并立即进行重定向，绕过此请求的任何即将到来的重写规则。

该代码还将重定向 camp 的子目录（camp 之后的任何内容），例如`shop.nilandsplace.com/camp/tent-poles`> `nilandsplace.com/store/camping/tent-poles`。

[您可以在Apache Docs](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)上了解有关该`mod_rewrite`模块（为重写引擎提供动力）的更多信息。

# javascript - jquery - .hide() .show() 破坏 CSS 样式

> ID：13983307
> 
> 赞同：2
> 
> 时间：2012-12-21T02:03:37.030
> 
> 标签：javascript, jquery, html, hide, show

我有一个包含一组默认显示的文本框和按钮的 div。我还有一组使用 jquery 制作的锦标赛括号，设置为`display: none`.

```
$('#buttontest').click(function() {
    $('div.bracket').show();
    $('div.teamList').hide();
}); 
```

当我使用此代码时，它可以根据显示的内容进行交换，但是当它显示锦标赛括号时，它会破坏其背后的 css 样式，锦标赛树上的球队不匹配。我在底部链接了 2 个屏幕截图以突出显示这一点。

这是锦标赛树的样子

![在此处输入图像描述](../Images/3c464310bdc31b7a9a6e14927f41363b.png)

但是当我隐藏括号并在单击按钮后显示它们时，它会像这样结束

![在此处输入图像描述](../Images/d433bf34eadf762dd8d5ff7eef4c8ba5.png)

这是我在 JADE 模板 HTML 语言中的 HTML 方面的代码，但很容易看到发生了什么:)

```
div.teamList
    form.pull-left(method="post", id="loginForm")
        input.input-small(id="team1", type="text", name="Team 1", placeholder="Team 1")
        input.input-small(id="team2", type="text", name="Team 2", placeholder="Team 2")
        br
        input.input-small(id="team3", type="text", name="Team 3", placeholder="Team 3")
        input.input-small(id="team4", type="text", name="Team 4", placeholder="Team 4")
        br
        input.input-small(id="team5", type="text", name="Team 5", placeholder="Team 5")
        input.input-small(id="team6", type="text", name="Team 6", placeholder="Team 6")
        br
        input.input-small(id="team7", type="text", name="Team 7", placeholder="Team 7")
        input.input-small(id="team8", type="text", name="Team 8", placeholder="Team 8")
        br
        button.btn.btn-primary.btn-mini(type="submit", value="Submit") Submit
        button#buttontest.btn.btn-primary.btn-mini(type="button") Submit
div.container
    div.bracket 
```

[https://raw.github.com/teijo/jquery-bracket/master/jquery.bracket.js](https://raw.github.com/teijo/jquery-bracket/master/jquery.bracket.js)

[https://raw.github.com/teijo/jquery-bracket/master/jquery.bracket.css](https://raw.github.com/teijo/jquery-bracket/master/jquery.bracket.css)

还有 singleElim - [http://pastebin.com/z6KvRqGU](http://pastebin.com/z6KvRqGU)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T04:17:45.293

在初始化括号之前，您需要保持`.bracket`div 可见。因此`display:none`，从您的`custom.css`样式表中删除，然后在您的`singleElim8.js`文件中执行此操作。

```
$(function() {
    $('#singleElim8').bracket({
        init: singleElim8Data
    })
    $('.bracket').hide();
}); 
```

在你的 8teams 玉中使用你原来的 js：

```
$('#buttontest').click(function() {
    $('div.bracket').show();
    $('div.teamList').hide();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:06:15.827

### 包括`clearfix`

包括 clearfix CSS 并以这种方式添加：

```
div.container.clearfix 
```

或者简单，给这个`div`CSS`overflow: hidden;`

# c# - 在 iis 和 asp.net 中支持虚 url 所需的工作流

> ID：13983313
> 
> 赞同：2
> 
> 时间：2012-12-21T02:05:05.670
> 
> 标签：c#, asp.net, iis-7.5

有人可以指导我完成使用 IIS 7 和 ASP.NET 4.0 支持虚 URL 所需的工作流程吗？我想要做的是能够处理来自浏览器的请求，例如`http://john.mysite.com`并让它转到并执行我的页面`http://www.mysite.com/mypage.aspx?id=3`。当然`id`会根据网址而变化。`http://zack.mysite.com`可能会去`http://www.mysite.com/mypage.aspx?id=4`。

我在想的是我需要一个保存 id 的数据库，`zack`然后`john`我会实现一个 URL 重写器，它将 url 重写为实际页面（例如`http://www.mysite.com/mypage.aspx?id=4`）。

有人可以告诉我我是否在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:21:12.887

是的，我相信这可以使用[IIS URL 重写](http://www.iis.net/learn/extensions/url-rewrite-module/using-the-url-rewrite-module)模块来实现。请注意，ASP.NET 也[支持一些自定义路由](http://msdn.microsoft.com/en-us/library/dd329551%28v=vs.100%29.aspx)。

# google-chrome-extension - 通过内容脚本注入的代码被删除

> ID：13983315
> 
> 赞同：1
> 
> 时间：2012-12-21T02:05:15.123
> 
> 标签：google-chrome-extension, xss, content-script

我正在创建一个 Chrome 扩展程序，它将在标签上方绘制一个显示 Flash 内容的图像。我已经在我的“contentscript.js”文件中编写了内容脚本，它只是通过脚本标签将另一个脚本文件“backgroundscript.js”插入到页面的正文中。

该代码适用于少数具有 Flash 视频的网站，并在 Flash Player 窗口的正上方显示图像，但在其他网站上则不显示。同样在少数情况下，它会出现几分之一秒，然后消失。

下面是我的清单文件：

```
{
  "name": "My First Chrome Extension",
  "version": "1.0.0.0",
  "description": "Tag videos from websites with a single click!",
  "icons": {   "16":"application_16.png","48":"application_48.png","128":"application_128.png" },
  "homepage_url": "http://www.myurl.com",
  "page_action":{
                "default_icon":{
                "19":"application_19.png",
                "38":"application_38.png"
            },
            "default_title":"VDownloader browser plugin"

        },
  "content_scripts": [ { "js": [ "contentscript.js" ], "matches": [ "http://*/*" ], "run_at" : "document_end", "all_frames": true} ],
  "plugins": [ { "path": "myplugin.dll", "public": true } ],
  "manifest_version":2,
  "minimum_chrome_version":"17",
  "offline_enabled":true,
  "permissions":["tabs","http://*/*", "https://*/*","contextMenus"],
  "web_accessible_resources":["application.png","backgroundscript.js"]
} 
```

我还通过插入“调试器”进行了检查；通过控制台进入我的脚本并监控代码执行；该脚本至少被添加到页面正文中一次。即使在没有显示图像按钮的情况下。

这是在不显示我的按钮的更高级网站上实施的某种 anit-XSS 控件吗？

我非常感谢您的帮助，因为过去几周我一直在努力克服这个问题，但没有成功:(

**编辑：**

请参阅下面的内容脚本：

```
var s = document.createElement('script');
s.src = chrome.extension.getURL("backgroundscript.js");
s.onload = function() {
    this.parentNode.removeChild(this);
};
(document.head||document.documentElement).appendChild(s); 
```

目标站点：

1.  不显示按钮：[http ://www.metacafe.com](http://www.metacafe.com)
2.  显示按钮片刻：[http ://www.dailymotion.com](http://www.dailymotion.com)
3.  正确显示按钮：[http ://www.myreviewalarm.com](http://www.myreviewalarm.com)

请看一下 backgroundscript.js 的内容：

```
var vdDelayTimer;
var vdUpdateInterval;
var playerButtons;

embedPlugin();

function embedPlugin() {
    var embed = document.createElement('embed');
    embed.setAttribute('type', 'application/x-myplugin');
    embed.setAttribute('id', 'myplugin');
    embed.setAttribute('style',   'width:1px;height:1px;position:absolute;left:0px;top:0px;');
    if(document.body!=null)
{
    document.body.appendChild(embed);
}
    testPlugin();
}

function testPlugin() {
    var plugin = document.getElementById('vdPlugin');
    if (plugin != null) {
        playerButtons = [];
        vdDelayTimer = setTimeout("appendButtons()", 2000);
    }
    else {
        window.alert('Plugin does not exist!');
    }
}

function updateButtons() {

    for (i = 0; i < playerButtons.length; i += 2) {
        updateButtonLocation(playerButtons[i], playerButtons[i + 1]);
    }
}

function updateButtonLocation(player, button) {

    var playerX = getX(player);
    var playerY = getY(player);
    var buttonHeight = 38;
    var buttonWidth = 196;
    var buttonX = playerX + player.offsetWidth - buttonWidth - 12;
    var buttonY = playerY - buttonHeight + 1;
    button.setAttribute('style', 'background-image: url(http://myurl.com/img/browser-download-button.png); width:' + buttonWidth + 'px;height:' + buttonHeight + 'px;position:absolute;left:' + buttonX + 'px;top:' + buttonY + 'px; cursor:pointer; cursor:hand;');
}

function appendButtons() {
    debugger;
    var objectTags = document.getElementsByTagName('object');
    for (var i = 0; i < objectTags.length; i++) {
        var objectTag = objectTags[i];
        if ((objectTag.hasAttribute('classid') && objectTag.getAttribute('classid') == 'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000')
|| (objectTag.hasAttribute('type') && objectTag.getAttribute('type') == 'application/x-shockwave-flash')) {
            if (objectTag.offsetWidth >= 320 && objectTag.offsetHeight >= 240)
                createButton(objectTag, getX(objectTag), getY(objectTag),  objectTag.offsetWidth);
        }
    }
    var embedTags = document.getElementsByTagName('embed');
    for (var i = 0; i < embedTags.length; i++) {
        try {
            var embedTag = embedTags[i];
            if (embedTag.hasAttribute('type') && embedTag.getAttribute('type') == 'application/x-shockwave-flash') {
                if (embedTag.offsetWidth >= 320 && embedTag.offsetHeight >= 240)
                    createButton(embedTag, getX(embedTag), getY(embedTag), embedTag.offsetWidth);
            }
        }
        catch (err) { }
    }
    var videoTags = document.getElementsByTagName('video');
    for (var i = 0; i < videoTags.length; i++) {
        try {
            var videoTag = videoTags[i];
            if (videoTag.hasAttribute('src')) {
                if (videoTag.offsetWidth >= 320 && videoTag.offsetHeight >= 240)
                    createButton(videoTag, getX(videoTag), getY(videoTag), videoTag.offsetWidth);
            }
        }
        catch (err) { }
    }
    vdUpdateInterval = setInterval("updateButtons();", 500);
}

function createButton(videoTag, playerX, playerY, playerWidth) {
    debugger;
    var buttonHeight = 38;
    var buttonWidth = 196;
    var buttonX = playerX + playerWidth - buttonWidth - 12;
    var buttonY = playerY - buttonHeight + 1;
    var vdPlugin = document.getElementById('vdPlugin');
    var strLocation = window.location.toString();
   // if (isSupported(strLocation)) {
        var downloadButton = document.createElement('img');
        downloadButton.setAttribute('title', 'Tag this video');
        downloadButton.setAttribute('src', 'http://myurl.com/img/browser-download-button.png');
        downloadButton.setAttribute('style', 'background-image: url(http://myurl.com/img/browser-download-button.png); width:' + buttonWidth + 'px;height:' + buttonHeight + 'px;position:absolute;left:' + buttonX + 'px;top:' + buttonY + 'px; cursor:pointer;cursor:hand;z-index:2147483647;');
        downloadButton.setAttribute('onclick', 'javascript:document.getElementById(\'vdPlugin\').downloadNow(window.location.href);');
        downloadButton.setAttribute('oncontextmenu', 'javascript:return false;');
        document.body.appendChild(downloadButton);
        playerButtons.push(videoTag, downloadButton);
   // }
}

function getY(oElement) {
    var iReturnValue = 0;
    while (oElement != null) {
        iReturnValue += oElement.offsetTop;
        oElement = oElement.offsetParent;
    }
    return iReturnValue;
}

function getX(oElement) {
    var iReturnValue = 0;
    while (oElement != null) {
        iReturnValue += oElement.offsetLeft;
        oElement = oElement.offsetParent;
    }
    return iReturnValue;
}

function isSupported(url) {
    var regLen = supportedSites.length;
    var regEx;
    var res = false;
    try {
        for (var i = 0; i < regLen && res == false; i++) {
            regEx = new RegExp(supportedSites[i], "i");
            res = regEx.test(url);
        }
    }
    catch (ex) {
    }
    return res;
} 
```

# entity-framework - EntityCodeFirst + MVC4 WebSecurity = 难过我

> ID：13983318
> 
> 赞同：1
> 
> 时间：2012-12-21T02:05:19.350
> 
> 标签：entity-framework, asp.net-mvc-4, ef-code-first, security, code-first

来自[这个例子](https://stackoverflow.com/questions/12435252/how-to-create-custom-additional-fields-in-userprofile-in-mvc4)
我有一个数据上下文

```
public class AggregateContext : DbContext
{
    public DbSet<BlogEntry> BlogEntries { get; set; }
    public DbSet<UserProfile> UserProfiles { get; set; }
} 
```

在应用程序开始我有这个

```
 Database.SetInitializer(new TestingDbInitializer());
        new AggregateContext().UserProfiles.Find(1); 
```

我的初始化程序看起来像这样

```
 public class TestingDbInitializer : DropCreateDatabaseAlways<AggregateContext>
{
    protected override void Seed(AggregateContext context)
    {
        AccountsContext(context);
        // add a bunch of Lorems to the blog. does call context.SaveChanges();
        BlogsContext(context);
    }

    void AccountsContext(AggregateContext context)
    {
        WebSecurity.InitializeDatabaseConnection(
            "DefaultConnection",
            "UserProfile",
            "UserId",
            "UserName",
            autoCreateTables: true);

        //create Admin
        if (!WebSecurity.ConfirmAccount("Admin"))
        {
            var confirm = WebSecurity.CreateUserAndAccount(
                "Admin",
                "password",
                new { Email = "please@help.me" });

            if (!Roles.RoleExists("Admin"))
                Roles.CreateRole("Admin");

            Roles.AddUserToRole("Admin", "Admin");
        }
    } 
```

当我运行它时，我在这条线上崩溃。

> var confirm = WebSecurity.CreateUserAndAccount("Admin", "password", new { Email = "please@help.me" });

带有 sqlexception“无效的列名 'Email'”。
在服务器资源管理器中查看我的数据库，我发现未创建电子邮件列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:08:51.527

```
public class AggregateContext : DbContext
{
    public AggregateContext()
        : base("DefaultConnection")
    {
    }
    public DbSet<BlogEntry> BlogEntries { get; set; }

    public DbSet<UserProfile> UserProfiles { get; set; }
} 
```

忘记定义连接。走我！

# postgresql - PostgreSQL 选择数字总和，按日期分组

> ID：13983320
> 
> 赞同：0
> 
> 时间：2012-12-21T02:05:35.610
> 
> 标签：postgresql, date, common-table-expression

我不确定是否已经存在这样的问题，找不到我的解决方案，如果这是重复的，很抱歉：我有一张带日期的表格：

```
 |date (date)| tax (numeric) |  (stuff in brackets is the type)
  |2012-12-12 | 5.00          |
  |2012-12-12 | 10.00         |
  |2012-12-13 | 2.00          | 
```

我希望我的输出看起来像这样：

```
 |date (date)| tax (numeric) |  (stuff in brackets is the type)
  |2012-12-12 | 15.00         |
  |2012-12-13 | 2.00          | 
```

我正在考虑进行 CTE 类型查询，因为在数据库中，我将内容存储为没有时区的日期时间，以及一堆税这是我查询的开始：

```
 with date_select as
 (
 select CAST(r.datetime as DATE), sum(r.tax) as tax
 from suezensalon.receipt r
 where r.datetime between '2012-12-12 00:00:00' and '2012-12-18 23:59:59'
 group by r.datetime  
 order by r.datetime
 ) 
```

这给了我最高的桌子。做这个的最好方式是什么？是通过“平均日期”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:37:10.010

这就是最终的工作：

```
 with date_select as
 (
 select CAST(r.datetime as DATE), sum(r.tax) as tax
 from suezensalon.receipt r
 where r.datetime between '2012-12-12 00:00:00' and '2012-12-18 23:59:59'
 group by r.datetime  
 order by r.datetime 
 ) 
 select extract(Month from datetime) || '-' || extract(Day from datetime) || '-' ||   extract(Year from datetime) as Date, sum(tax)
 from date_select
 group by Date
order by Date; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T04:18:27.180

我认为最简单的选项，并且最有可能在存在索引的情况下表现良好，是这样的：

```
SELECT
    datetime::date as "Date",
    sum(tax)
  FROM suezensalon.receipt
  WHERE datetime >= '2012-12-12 00:00:00'
    AND datetime <  '2012-12-19 00:00:00'
  GROUP BY datetime::date
  ORDER BY "Date"; 
```

# emacs - 点在 Emacs 中不断返回到同一个位置

> ID：13983322
> 
> 赞同：0
> 
> 时间：2012-12-21T02:05:42.880
> 
> 标签：emacs

Emacs 时不时地开发出这种在缓冲区中记住位置的烦人行为。每当我离开缓冲区并返回时，该点就会自动移回同一位置。

我可能在不知情的情况下打了一些随机命令，但有谁知道这是什么以及如何阻止它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:24:26.897

我认为 saveplace 在这种情况下很有用。您在配置文件中添加以下 S-exp。

```
(load "saveplace")
(setq-default save-place t) 
```

也可以看看

[http://www.emacswiki.org/emacs/SavePlace](http://www.emacswiki.org/emacs/SavePlace)

# linux - EC2 微实例 CPU 每天定期达到 100%

> ID：13983323
> 
> 赞同：8
> 
> 时间：2012-12-21T02:05:42.983
> 
> 标签：linux, ubuntu, amazon-ec2

![在此处输入图像描述](../Images/49f6238af90f4aa6268f177b2462f990.png)

我知道如果亚马逊用完一定数量的 CPU 时间，它会限制微型实例，但我认为情况并非如此。所有尖峰出现在世界标准时间 6:30 到 6:40 左右。我检查了我的 cron 作业，当时没有任何安排：

```
@reboot ~/path/to/script1.sh >> ~/log/cron.log
0 13 * * * ~/path/to/script2.sh >> ~/log/cron.log 
```

还能是什么？

PS：注意 CPU Utilization 下拉菜单设置为“Maximum”。该图看起来与“平均”相似。PPS：此实例是 2 实例负载平衡设置的一部分。

这是我的 /etc/cron.daily 里面的内容（其他 crons 是空的）：

apport、apt、aptitude、bsdmainutils、dpkg、logrotate、man-db、mlocate、passwd、流行度竞赛、标准、update-notifier-common

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-21T05:25:21.207

通常，Amazon 上的 Ubuntu AMI 每天的 cron 作业都`/etc/cron.daily`安排在早上的时间。此计划使用 管理`/etc/crontab`。示例`/etc/crontab`如下所示：

```
$ cat /etc/crontab 
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
# 
```

显然，每日任务在早上 6:25 运行。如果这会影响服务器的直接交付，您可能需要调整这些设置以将日常任务移至其他时间。此外，您可以调查下的项目`/etc/cron.daily`。对我来说，它看起来像：

```
$ ls /etc/cron.daily/
apport  apt  aptitude  bsdmainutils  dpkg  logrotate  man-db  mlocate  popularity-contest  standard 
```

其中，通常`man-db`并且`logrotate`可能会占用大量 CPU 时间来执行。这些是标准任务，可以进行调整以获得最佳性能。您可能需要考虑调整您的 logrotate 和 man-db 策略。

希望这可以帮助。

# fullcalendar - 完整日历未显示明年的活动

> ID：13983325
> 
> 赞同：0
> 
> 时间：2012-12-21T02:06:11.957
> 
> 标签：fullcalendar

使用完整日历我可以看到 12 月的事件，但是如果我点击下个月到 1 月，则什么也没有显示。

如果我将本地日期更改为 2013 年 1 月，则会显示 1 月的事件，我可以浏览回 12 月。

在演示网站上也发生在我身上：http: [//arshaw.com/fullcalendar/](http://arshaw.com/fullcalendar/)

在 IE9、FF、Chrome 中测试

有没有其他人经历过这个，或者至少确认你可以复制它，我不会生气......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T06:39:17.070

放松。我不知道你自己的 cal，但演示只是根据当前月份、年份生成一些示例事件；检查演示源...

# java - 刽子手程序，错误：找不到符号，缓冲阅读器？Java新手

> ID：13983329
> 
> 赞同：0
> 
> 时间：2012-12-21T02:06:28.870
> 
> 标签：java

这是我的程序的大部分错误部分：

```
 //play method
    private void play() throws IOException
    {
        do {
            guess(alphabet);
            usedLetters(used, alphabet);

            do {
                System.out.println("You have already guessed this " + alphabet + " and the others listed above.");
                guess(alphabet);
            } while (letterUsed == true);//will keep asking until letter was not used

            if (letterUsed == false)
            {
                life--;
                underWord(currentWord , checkLetter, used);
            } //only if the letter was not used, it will be checked for in the current word trying to be solved

            if (life == 0) {
                checkWord(currentWord , checkLetter);
            }
        } while (checkLetter != currentWord);

    } 
```

特别是这种方法目前存在所有错误。我需要询问用户对 1 个字母的猜测，然后检查它是否在他们当前试图猜测的单词中。我还存储了他们已经猜到的所有字母，以确保他们不会因为猜到同一个字母两次而丧生。所以她我有三个数组，一个存储使用过的字母，一个存储已经猜到的单词部分（以及需要 _ 的部分），一个存储他们试图猜测的单词。有没有更好的方法可以在下面编写此方法来完成所需的任务？

```
//underWord method to return the word with all characters not in letters replaced by _'s
private void underWord(char currentWord[] , char checkLetter[], char used[]) throws IOException //add parameters what it recieves
{

    for (int i = 0; i<currentWord.length; i++) {
       for (int index = 0; index<checkLetter.length; index++){
               if (used.contains(currentWord.charAt(i)))
            {
                checkLetter[index] =  currentWord.charAt(i);
            }

            else
            {
                checkLetter[index] = '_';
            }
          }
    }
    for (int i = 0; i < checkLetter.length; i++)
    {
        System.out.println(checkLetter[i]);
    }
}//End of maskWord method 
```

我编译并显示以下内容：

```
C:\Users\HOME\Documents\JCreator LE\MyProjects\twoHangman\src\twoHangman.java:289: error: cannot find symbol
               if (used.contains(currentWord.charAt(i)))
                                            ^
symbol:   method charAt(int)
location: variable currentWord of type char[]

C:\Users\HOME\Documents\JCreator LE\MyProjects\twoHangman\src\twoHangman.java:291: error: cannot find symbol
                checkLetter[index] =  currentWord.charAt(i);
                                                 ^
symbol:   method charAt(int)
location: variable currentWord of type char[]

C:\Users\HOME\Documents\JCreator LE\MyProjects\twoHangman\src\twoHangman.java:312: error: cannot find symbol
    alphabet = kb.readline().charAt(0);
                 ^
symbol:   method readline()
location: variable kb of type BufferedReader 
```

这是我第一次使用 Buffered Reader，我不知道出了什么问题

```
//guess method to ask for user's guess

private void guess(char alphabet) throws IOException//add parameters what it recieves
{
    System.out.println("Guess a letter in this 5-letter word: ");
    alphabet = kb.readline().charAt(0);
    used[dataSize] = alphabet;
    //adds guess to used letters array

}

//usedLetters method to check if user's guess has already been guessed
private boolean usedLetters(char used[], char alphabet) throws IOException
{
    for(int x=0; x<used.length; x++)
    {
        if(alphabet == used[x])
        {
            letterUsed = true;
            return letterUsed;
        }
        else
        {
            letterUsed = false;
            return letterUsed;
        }
     }

     for (int index = 0; index < used.length; index++) {
        System.out.println(used[index]);
    }

}

//checkWord method to see if the user has got the correct word

private void checkWord(char currentWord[], char checkLetter[]) throws IOException
{
    for(int x=0; x<currentWord.length; x++)
    {
        if(checkLetter == currentWord)
        {
            System.out.println("HUZZAH! You have guessed the word!");
            System.out.println("You have completed this game of hangman.");
            menu();
        }

        System.out.println("You have run out of guesses!");
        System.out.println("The word was:");
        for (int index = 0; index < currentWord.length; index++)
        {
            System.out.print(currentWord[index]);
        }
        menu();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:36:44.387

`currentWord`被声明为`char currentWord[]`。这意味着它`currentWord`是一个数组`char`。在 Java 中，这与`String`. 特别是，数组没有任何方法。您需要使用数组下标，例如`currentWord[i]`而不是`currentWord.charAt(i)`. 或者，您可以将程序设计为使用`String`s 而不是`char[]`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T02:16:47.827

首先，`readline`应该是`readLine`- Java 区分大小写。

* * *

更重要的是，`currentWord`是一个char数组。要访问 index 处的字符`i`，您可以使用`currentWord[i]`而不是`currentWord.charAt(i)`.

此外，您不能使用`used.contains(anything)`since`used`是一个数组。尝试循环`used`检查是否匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T02:17:11.977

正如@irrelephant 指出的那样：你拼错了*readLine()*。

`L`必须大写。

* * *

另一个错误消息也非常简单。

它告诉你数组没有这样的方法*charAt()*。

数组在 Java 中没有任何方法。

但是，String**确实**有一个名为*charAt()的方法*

在 Java 中，字符数组和字符串之间存在差异。

变量*checkLetter*和*currentWord*应该是字符串（不是字符数组）。

* * *

学习如何自己解决这些错误会更好。

每次遇到编译错误时都来 StackOverflow 浪费您和我们的时间。

# javascript - 单击时使用不同的文本更改文本

> ID：13983330
> 
> 赞同：0
> 
> 时间：2012-12-21T02:06:37.993
> 
> 标签：javascript, text, onclick

让我以我对网页设计的有限理解来开始我的问题。

我希望“-More-”文本在单击时变为“-Less-”，然后在再次单击时返回“-More-”。

我尝试修改的代码中已经存在一些 javascript。这可以与我要求达到相同结果的要求相结合吗？

我的javascript如下：

```
function showHide(shID) {
  if (document.getElementById(shID)) {
    if (document.getElementById(shID+'-show').style.display != 'none') {
        document.getElementById(shID+'-show').style.display = 'none';
        document.getElementById(shID).style.display = 'block';
    }
    else {
        document.getElementById(shID+'-show').style.display = 'inline';
        document.getElementById(shID).style.display = 'none';
    }
  }
} 
```

我的html如下：

```
 <div class="accordion">
    <p>1\. Decide
    <a href="#" id="exampleone-show" class="showLink"
    onclick="showHide('exampleone');return false;"><div class="btn_show">-More-</div></a>
    <p></p>
  </div>
  <div id="exampleone" class="more">
    <p>Blah Blah Blah.</p>
  </div> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:17:02.387

jQuery 不需要执行这个功能，它只会让整个脚本变得更麻烦和更慢。只需使用这个纯 JavaScript 解决方案：

```
function showHide(i) {
if (document.getElementById("example"+i).innerHTML=="-More-") {
    document.getElementById("example"+i).innerHTML="-Less-";
    document.getElementById("more"+i).style.display = 'block';
}
else if (document.getElementById("example"+i).innerHTML=="-Less-"){
    document.getElementById("example"+i).innerHTML="-More-";
    document.getElementById("more"+i).style.display = 'none';
}
} 
```

此代码`i`用作定义`div`需要更改的链接/的参数。对于您的 HTML，请使用以下命令：

```
<div class="accordion">
<p>1\. Decide</p>
    <a href="#" id="**example1**" class="showLink" onclick="**showHide(1)**">-More-</a>
</div>
<div id="**more1**" class="more" style="display:none;">
    <p>Blah Blah Blah.</p>
</div> 
```

基本上，您可以根据需要多次复制此 HTML 代码。只要确保您更改双星号中的代码部分即可。（JavaScript 代码通过识别 id`example1`和来工作`example2`；通过将此数字传递给`showHide()`，代码可用于多个实例。）

这是给你的 JSFiddle：http: [//jsfiddle.net/3Xawv/](http://jsfiddle.net/3Xawv/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:24:59.533

真正的答案是使用 jQuery，但是你可以这样做，像这样传递 click 事件：

```
 <a href="#" id="exampleone-show" class="showLink"
onclick="showHide('exampleone', event);return false;"> 
```

然后在 JS 方面

```
function showHide(shID, e) {
    if (document.getElementById(shID)) {
        if (document.getElementById(shID + '-show').style.display != 'none') {
            document.getElementById(shID + '-show').style.display = 'none';
            document.getElementById(shID).style.display = 'block';
        } else {
            document.getElementById(shID + '-show').style.display = 'inline';
            document.getElementById(shID).style.display = 'none';
        }
    }
    target = e.target;
    element = target.getElementsByClassName('btn_show');
    html = element.innerHTML;
    element.innerHTML = "";
    if (html.indexOf("-More-") != -1) {
        element.innerHTML = "-Less-";
    } else if (html.indexOf("-Less-") != -1) {
        element.innerHTML = "-More-";
    }
}​ 
```

说明： e.target 将返回实际接收到点击事件的元素——在本例中为链接。

# java - 将Java侦听器与其自己的功能分开？

> ID：13983331
> 
> 赞同：1
> 
> 时间：2012-12-21T02:06:43.707
> 
> 标签：java, android

我可以将 set-listener 行分成更小的部分吗？

这是我的代码：

```
protected void onCreate(Bundle savedInstanceState) {
   Preference button = (Preference)getPreferenceManager().findPreference("exitlink");      

      button.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {
             @Override
             public boolean onPreferenceClick(Preference arg0) {
                finish();   
                return true;
             }
        }); 
```

我希望它看起来像：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Preference button = (Preference)getPreferenceManager().findPreference("exitlink");      
    if(button != null) {
         button.setOnPreferenceClickListener(onPreferenceClick);
    }        
}

public boolean onPreferenceClick(Preference arg0) {
    finish();   
    return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:15:46.183

You can also create a variable outside of your method:

```
 private Preference.OnPreferenceClickListener listener = new Preference.OnPreferenceClickListener() {
         @Override
         public boolean onPreferenceClick(Preference arg0) {
            finish();   
            return true;
         }
    }; 
```

Then you use it as a variable: `setListener(listener)`. This would allow you to have multiple instances of the same listener class in your Activity.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T02:51:38.273

正如其他人所提到的，即使您无法将方法名称传递给`setOnPreferenceClickListener`您，也可以创建扩展类型的变量`Preference.OnPreferenceClickListener`。在您的原始代码中，这实际上正是您正在做的事情：您正在创建一个[匿名内部类](https://stackoverflow.com/questions/355167/how-are-anonymous-inner-classes-used-in-java)的对象。

相对于 Simon André Forsberg 的上述[回答](https://stackoverflow.com/a/13983373/18573)，这种方法的优势在于范围：它将侦听器功能保留在那个小块中，而不是可能遍布整个班级。

如 dmon 的[回答](https://stackoverflow.com/a/13983406/18573)那样在方法之外创建一个单独的变量失去了匿名内部类的一大好处，即它们可以访问包含范围内的变量：在您的原始代码中，侦听器可以访问变量`button`和`savedInstanceState`. 这对于在函数外部定义的单独变量是不可能的。

这并不意味着您必须使用匿名内部类。Oracle 有一个出色的教程，题为[关于编写事件侦听器的一般信息](http://docs.oracle.com/javase/tutorial/uiswing/events/generalrules.html)，您将从中受益匪浅。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T02:12:24.843

Your code above nearly works already. Use your above code with this tiny change:

```
button.setOnPreferenceClickListener(this); 
```

Then you just let your class implement the specific interface needed, in this case `Preference.OnPreferenceClickListener`.

In addition to dmon's suggestion below about using variables for this, it is also possible to write a function that returns a listener, which is very useable when you want to have similar listeners but with slight changes, like in the example below.

```
private Preference.OnPreferenceClickListener getListener(int listenerId) {
    return new Preference.OnPreferenceClickListener() {
         @Override
         public boolean onPreferenceClick(Preference arg0) {
            Log.i("MyTag", "Listener " + listenerId + " invoked!");
            finish();   
            return true;
         }
    };
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T02:17:20.270

不完全是。set-listener 需要一个 listener 实例，因此您总是需要创建一个。而且我认为这不是实现监听器接口的好方法。

解决方法是您可以使用带反射的注释，例如[http://code.google.com/p/roboguice/](http://code.google.com/p/roboguice/)。这可能会使代码更干净，但也会引入依赖关系。

# c++ - 结合函子和 lambda

> ID：13983336
> 
> 赞同：2
> 
> 时间：2012-12-21T02:07:24.717
> 
> 标签：c++, c++11, lambda, functor

我有一个仿函数，它创建了一组线性间隔的值。. .

```
//Linear spaced generator
struct gen_lin {
    float mi, inc;
public:
    gen_lin(float _mi=1.f, float _inc=1.f) : mi(_mi), inc(_inc){};
    float operator()() {
        return  mi+=inc;
    }
}; 
```

我可以用这样的值填充一个向量......

```
const size_t elements = 400;
std::vector<float> x(elements);
std::generate_n(x.begin(), elements, gen_lin(10.f,5.f) ); 
```

现在，我可以使用像这样的 lambda 轻松地将其转换为对数刻度......

```
auto lin = gen_lin(10.f,5.f);
std::generate_n(x.begin(), elements, [&](){return logf(lin());} ); 
```

但是当我尝试将它全部压缩到一行时，向量完全被 logf(10.) 的值填充。

```
std::generate_n(x.begin(), elements, [](){return logf(  gen_lin(10.f,5.f)() );} ); 
```

为什么，是否可以调整我的最后一行代码以使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:14:58.340

这样，您将创建一个 gen_lin 对象，并多次使用它：

```
auto lin = gen_lin(10.f,5.f);
std::generate_n(x.begin(), elements, [&](){return logf(lin());} ); 
```

有了这个，你正在创建几个 gen_lin 对象：

```
std::generate_n(x.begin(), elements, [](){return logf(  gen_lin(10.f,5.f)() );} ); 
```

每次创建新的 gen_lin 对象时，都会重置当前值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T02:15:26.463

在第一种情况下：

```
auto lin = gen_lin(10.f,5.f);
std::generate_n(x.begin(), elements, [&](){return logf(lin());} ); 
```

您有一个持久`gen_lin`对象 ，`lin`每次调用 lambda 都会更新它。但是对于你的单线，你只是`gen_lin`在每次调用 lambda 时创建新对象，获取它返回的第一个值，然后将对象扔掉。因为它是一个新对象，用相同的常量值初始化，所以每次都会给你相同的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T02:19:44.893

在第二种情况下，每个 lamdas 调用都会创建一个新的仿函数实例。

像 bind 这样的东西可能会解决你的问题。让 lambda 将您的仿函数作为参数并使用 bind 将公共实例附加到该参数？

或者使用任何风格的组合函子。

# android - 从 .xml 获取值到 .java 解析（float = null）错误

> ID：13983338
> 
> 赞同：0
> 
> 时间：2012-12-21T02:07:41.680
> 
> 标签：android

**文件.xml**

```
edittext(inputtype=numberdecimal, id=text1) value(1.5)
edittext(inputtype=numberdecimal, id=text2) value("") 
```

**文件.java**

```
txt1 = ((EditText)findViewById(R.id.Text1));
txt2 = ((EditText)findViewById(R.id.Text2));

s1 = txt1.getText().toString(); 
v1 = Float.parseFloat(s1);     //true
s2 = txt2.getText().toString(); 
v2 = Float.parseFloat(s2);     //error i want parse to (0) 
```

为什么是错误？如果文本不输入数据，我希望默认值为零

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:11:17.577

`""`不是有效数字，因此您很可能会得到Android[文档](http://developer.android.com/reference/java/lang/Float.html#parseFloat%28java.lang.String%29)`NumberFormatException`中所说的a 。最简单的事情就是在那里 设置你的文本。根据需要重复。`catch``NumberFormatException`

例如

```
try {
  v2 = Float.parseFloat(s2);
}
catch (NumberFormatException e)
{
  v2 = 0;
} 
```

# wpf - 如何将 WPF Datagrid RowHeaderWidth 设置为 Auto？

> ID：13983339
> 
> 赞同：1
> 
> 时间：2012-12-21T02:07:52.767
> 
> 标签：wpf, datagrid, grid, row

我的应用程序（WPF 环境）中有一个数据网格，可以将数据加载到其中。我的应用程序中的行标题中有行号（就像 excel 一样）。现在我的问题是当我有 99 行时，行标题的宽度是正确的，但是当它超过该行标题宽度时，它会太小并减少数字（见图）。我想将 rowheaderwidth 设置为 auto，但没有内置命令。有什么想法吗？谢谢您的帮助

![在此处输入图像描述](../Images/a964ede9cedc7bc35d70afa21de66c22.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T06:03:26.183

您应该编写自己的 DatagridRowHeaderTemplate。请参阅此链接：[http ://social.msdn.microsoft.com/Forums/en-US/wpf/thread/62e7b57d-b83f-4d25-bdb4-89b55f383bca/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/62e7b57d-b83f-4d25-bdb4-89b55f383bca/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-13T10:49:04.897

根据[DataGrid.RowHeaderWidth 属性](https://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.rowheaderwidth(v=vs.110).aspx)文档：

> 将此属性设置为 NaN 以使行标题自动调整其大小以适应其内容。

以下工作如记录。

```
<DataGrid RowHeaderWidth="NaN"/> 
```

# mdx - MDX 查询语言是否支持向下钻取、上卷、切片和切块、透视？

> ID：13983342
> 
> 赞同：1
> 
> 时间：2012-12-21T02:08:15.543
> 
> 标签：mdx, olap, multidimensional-array, drilldown, rollup

我为我的项目阅读了一些关于多维操作（上卷、下钻、切片、骰子和透视）和 MDX 查询语言的资源。我知道 OLAP 查询中有几个标准。

MDX 查询语言是否支持向下钻取、上卷、切片和切块、透视？还是完全是两种不同的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:40:18.263

是的; 本质上，MDX 正在处理所有这些操作：例如，在询问层次结构中的成员（即，父母与子女）时会执行向下钻取、上卷。或者，您可以显式使用多个向下钻取函数。[WHERE](http://www.iccube.com/support/documentation/mdx/Where%20Clause.html)语句正在对多维数据集进行切片。ETC...

# ios - 当我的项目使用 Cocoapods 时如何安装 Frank？

> ID：13983343
> 
> 赞同：4
> 
> 时间：2012-12-21T02:08:19.060
> 
> 标签：ios, xcode, cocoapods, frank

我有一个示例，新项目，我曾经`Cocoapods`安装`TestFlight`和`RestKit`. 现在我正在尝试添加 Frank，但“frank build”不起作用。

我已尝试按照[此处](http://blog.thepete.net/blog/2012/10/16/frank-with-cocoapods/)列出的步骤进行操作；

我尝试修改邮资`../Frank/frankify.xcconfig`并修改`.xcconfig`了默认目标。

当我运行“frank build”时，构建失败并给我留下一条消息，`"ld: library not found for -lPods"`.

关于如何让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T16:45:40.863

从您链接到的文章中，修改`frankify.xcconfig`文件后，您仍然需要使用`--workspace`和`--scheme`标志调用 frank。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-23T02:38:26.890

只需键入

```
frank build --workspace YourWorkspace.xcworkspace/ --scheme YourProject 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T14:09:42.463

您将遇到此问题，因为提供此库的 Pods 项目缺少该方案。您需要调整构建脚本/Frank 以使用新的 xcworkspace 而不是原始的 xcodeproj 文件。改变它应该让你得到你的正常项目和它所依赖的 Pods 静态库。

这也发生在 Jenkins 和 Hudson 构建中。这个问题不仅仅存在于弗兰克身上。

# database - 数据库结构指导

> ID：13983346
> 
> 赞同：0
> 
> 时间：2012-12-21T02:08:40.230
> 
> 标签：database, database-design

我有这个需要插入数据库的对象（包括正确的关系）我试图找到用正确的字段和关系构建数据库表的最佳方法..

我的对象：

**对象A：**

```
String id;
String mode;
String name;
Dictionary dict<String code,List<Pair<String index,String val>> 
```

**对象B：**

```
String sysId;
List<objectA> objectAs;
String seates; 
```

它应该是 objectB.sysId 到 objectA.id （许多 objectA 到一个 objectB）之间的一对多关系，
并且在 objectB 中，sysId 是主键。现在关于objectA我不知道如何正确处理字典......

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:55:58.083

```
CREATE TABLE ObjectA
(
    Id     CHAR(10) NOT NULL PRIMARY KEY,
    Mode   CHAR(10) NOT NULL,
    Name   CHAR(20) NOT NULL
);

CREATE TABLE ObjectA_Dict
(
    Id     CHAR(10) NOT NULL REFERENCES ObjectA,
    Code   CHAR(10) NOT NULL,
    PRIMARY KEY(Id, Code)
);

CREATE TABLE ObjectA_DictEntry
(
    Id     CHAR(10) NOT NULL,
    Code   CHAR(10) NOT NULL,
    FOREIGN KEY(Id, Code) REFERENCES ObjectA_Dict,
    Index  CHAR(10) NOT NULL,
    Value  VARCHAR(255) NOT NULL,
    PRIMARY KEY(Id, Code, Index)
); 
```

由于您没有告诉我们有关用于识别对象的字符串的组织结构，因此很难知道它们的大小。如果您愿意，您可以决定在表中使用某种自动分配的整数值；这将改变需要编写查询的方式，但可能会更好地使用一些处理 ORM（对象关系映射）的工具。由于您尚未确定您的目标是哪个 DBMS，因此也必须不进行说明。在`ObjectA_DictEntry`中，您可以将其`Id`作为外键引用`ObjectA`，但这不是必需的。使用显示的复合键，您可以在`ObjectA_DictEntry`不必参考其他表的情况下进行操作。如果您使用自动分配的值，您有时会被迫进行连接。

```
CREATE TABLE ObjectB
(
    SysId   CHAR(10) NOT NULL PRIMARY KEY,
    Seates  CHAR(20) NOT NULL
);

CREATE TABLE ObjectB_List
(
    SysId   CHAR(10) NOT NULL REFERENCES ObjectB,
    Id      CHAR(10) NOT NULL REFERENCES ObjectA,
    PRIMARY KEY (SysId, Id)
); 
```

这就是我认为您的`ObjectB`架构应该是什么样子的。我认为你应该展示你认为它应该是什么样子的；它会改善你的问题。

# css - CSS“正确”属性在对象之间不一致

> ID：13983350
> 
> 赞同：1
> 
> 时间：2012-12-21T02:09:06.370
> 
> 标签：css, html, iframe, web

因此，对于一个网站，我将网站划分为 div 和 iframe：一个 iframe 用于侧边栏，一个 iframe 用于页脚，中间的一个大 div 用于正文内容。为了让所有东西都保持静态和合适，我在这里使用了代码：

```
.bodycontent{
position:fixed;
top:0px;
left:150px;
right:0px;
bottom:100px;
overflow:auto;
}

.footerframe {
position:fixed;
left:150px;
bottom:0px;
right:0px;
height:100px;
border-top: 2px solid #888;
border-right: 2px solid #888;
border-top-right-radius:4px;
} 
```

这是为了让主 div 和页脚 iframe 都延伸到整个页面。它适用于主 div，但不适用于页脚。这种不一致是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:02:53.900

您的代码有两个问题：

1.  Top/Bottom 或 Left/Right 应始终成对使用，而不是四个值。如果您使用顶部，请不要使用底部；如果您使用左，请不要使用右。
2.  如果你想让一个位置固定的元素伸展到整个页面，你应该给它`width:100%`

:)

# kendo-ui - 如何检测 Kendo UI Window 上的 resizeStop 事件？

> ID：13983352
> 
> 赞同：0
> 
> 时间：2012-12-21T02:09:11.427
> 
> 标签：kendo-ui

标题说明了一切……

当我知道用户已完成调整大小时，我需要执行自定义操作，但是从我在 Kendo UI 文档中可以找到的内容来看，除了我无法按原样使用的“调​​整大小”之外，我没有其他可访问的事件。

也许我只是错过了这个活动？

如果不：

有没有办法使用“调整大小”事件来确定用户已停止调整大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T15:34:25.343

所以到目前为止，这是我的答案：

**由于架构需求，我的略有不同，但这是一个通用的解决方案**

```
var isResizing = false;
var wndw = $(element).kendoWindow({
                // .....
                resize: OnResize,
                // .....
            }).data('kendoWindow');

function onResize() {
    isResizing = true;
}

$('body').on('mouseup', '.k-window', function() {
    if(isResizing){
        // **Your 'Stopped' code here**
        isResizing = false;
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T08:39:53.513

您是否考虑过使用 underscore.js [debounce](http://underscorejs.org/#debounce)？我已经成功地使用它来仅在调整大小事件停止出现一段时间（在低于 300 毫秒的情况下）后才触发然后更改。这确实为捕捉结尾增加了一点延迟，但如果你像我一样只想存储最终大小，那么它工作得很好。这是上面代码的版本，但使用了下划线去抖动：

```
 var wndw = $(element).kendoWindow({
            // .....
            resize: _.debounce( this.hasResized, 300)
            // .....
        }).data('kendoWindow');

  //This is called at the end of a resize operation (using _.debounce)
  function hasResized (args) {
        // ** Your code here **
  }; 
```

希望有帮助。

# c# - 根据其中一个值删除注册表项？

> ID：13983353
> 
> 赞同：0
> 
> 时间：2012-12-21T02:09:35.107
> 
> 标签：c#, registry

我正在开发一个简单的应用程序来从注册表中删除用户配置文件条目，但我遇到了一个问题。

因此，首先，我通过以下代码获取 ProfileList 中的所有子项：

```
List<string> KeyList = new List<string>();

        RegistryKey ProfileList = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\\Microsoft\Windows NT\\CurrentVersion\\ProfileList\\");
        foreach (string ProfileKey in ProfileList.GetSubKeyNames())
        {
            KeyList.Add(ProfileKey);
        } 
```

从那里，我得到每个键的 ProfileImagePath 值并将它们添加到选中的列表框中：

```
KeyList.ForEach(delegate(string ProfileKey)
        {
            ProfileList = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\\Microsoft\Windows NT\\CurrentVersion\\ProfileList\\" + ProfileKey + "\\");
            checkedListBox1.Items.Add(ProfileList.GetValue("ProfileImagePath").ToString());
        }); 
```

然后，当用户单击删除按钮时，我希望应用程序删除已检查的用户配置文件。但是，我必须获取每个选中项的值（类似于 C:/Users/Name）并确定要删除哪些注册表项。我假设我可以在 foreach 循环中做到这一点，但我不太确定如何。这样做的最佳方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:26:24.713

干得好。当用户单击“删除选定用户”等按钮时，您可以执行此代码。这是代码的外壳：

```
string[] CheckItemsArray = new string[checkedListBox1.CheckedItems.Count+1];
        checkedListBox1.CheckedItems.CopyTo(CheckItemsArray, 0);

        foreach (string CheckedItem in CheckItemsArray)
        {
            if (CheckedItem != null)
            {
                //your deleting logic here

            }
        } 
```

# javascript - 根据 div 内容选择/突出显示选项

> ID：13983358
> 
> 赞同：0
> 
> 时间：2012-12-21T02:09:47.490
> 
> 标签：javascript, html, html-select

下面的代码假设将下拉列表与 div 内容匹配。如果找到“菠萝”，则选择此选项。我似乎找不到错误。

```
<head>
<script>
function displayResult(){

  var myObject=document.getElementById("mySelect");
  var myValue = $('#myContent').text();

  for(var i=0; i<myObject.length; i++){                        
      if(myObject.options[i].text == myValue){
          myObject.options[i].selected = true; 
          (also tried - myObject.options[i].selectedIndex = i;)
          break;
      }
  }
}
</script>
</head>

<body>

<div id="myContent">Pineapple</div>

<form>
   Select your favorite fruit:
   <select id="mySelect" size="4">
     <option>Apple</option>
     <option>Orange</option>
     <option>Pineapple</option>
     <option>Banana</option>
   </select>
</form>

<button type="button" onclick="displayResult()">Highlight Pineapple Option</button>

</body> 
```

**笔记：**

我希望突出显示该选项。缺少右括号是一个错字，已更正。尝试过 .selectedIndex=i，似乎没有奏效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:14:02.210

代替：

```
> myObject.options[i].selected = true; 
```

采用

```
myObject.selectedIndex = i; 
```

将 selected 属性设置为 true 并不一定会使选项被选中（它因浏览器而异）。

哦，你有一个语法错误：

```
<script>
function displayResult(){

  var myObject=document.getElementById("mySelect");
  var myValue = $('#myContent').text();

  for(var i=0; i<myObject.length; i++){                        
    ...
  }
  // missing closing } for function body
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:14:15.913

您缺少`displayResult`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T02:16:49.107

您`}`在函数末尾缺少 a 。

你应该包括 jQuery 库或更改

```
var myValue = $('#myContent').text(); 
```

到

```
var myValue = document.getElementById('myContent').innerHTML; 
```

* * *

不过，一个更简单的技巧是（*毕竟不是一个好技巧……请参阅@RobG 的评论*）

 ~~~~```
function displayResult() {

    var myObject = document.getElementById("mySelect");
    var myValue = document.getElementById('myContent').innerHTML;

    myObject.value = myValue;
} 
```~~ 

但对于 IE，选项将需要包含`value`属性

```
<option value="Pineapple">Pineapple</option> 
```~~

# configuration - 禁止访问！错误 403

> ID：13983359
> 
> 赞同：0
> 
> 时间：2012-12-21T02:10:24.673
> 
> 标签：configuration, xampp, localhost

我只是重新格式化我的电脑并在 64 位*Windows 7*平台上安装了*XAMPP 1.8.3 。*我将我的项目放在*htdocs*中并在浏览器中运行它。我的项目的功能保存对学生的冒犯，但是当我单击项目中*addedit_offense.php*文件中的按钮时，它显示：**`Save Changes`**

 ***```
Access Forbidden!
You don't have permission to access the requested object.
It is either read-protected or not readable by the server.
If you think this is a server error, please contact the webmaster.

Error 403
localhost
Apache/2.4.3 (Win32) OpenSSL/1.0.1c PHP/5.4.7 
```

在一切都出错之前，在我重新格式化我的电脑之前，一切都很顺利。它运行良好。

请帮助我，我一直在网上到处寻找，但似乎找不到正确的解决方案。谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T04:50:05.337

好的，正如您在评论中所说， .htacess 导致了问题。尝试删除 .htacess 文件，它肯定会正常工作***

# php - 检查数组中的任何值是否彼此相等

> ID：13983363
> 
> 赞同：3
> 
> 时间：2012-12-21T02:10:58.763
> 
> 标签：php

我正在验证一个表单，该表单最多可提交 3 个不同的 ID，具体取决于用户选择的内容。

我已将它们放入一个数组中：

```
$submitted_genres = array($_POST['genre1'], $_POST['genre2'], $_POST['genre3']); 
```

我如何检查以确保没有一个数组值彼此相等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T02:13:14.257

You could use `array_unique()` to get an array of all unique values and then compare the size against the original array:

```
if (count(array_unique($submitted_genres)) !== count($submitted_genres)) {
    // there's at least one dupe
} 
```

# c++ - 检查向量项是否不为空 C++

> ID：13983364
> 
> 赞同：0
> 
> 时间：2012-12-21T02:11:12.757
> 
> 标签：c++, vector

我有结构：

```
struct node
{
    bool data;
    node* l;
    node* r;
    node(bool data_) : data(data_), l(0), r(0) {}
}; 
```

像这样循环

```
void printNode(std::vector<node*> nodes, int level, int max_level)
{
    for (int i = 0; i < nodes.size(); i++) {
        node * itr = nodes.at(i);
        if (itr->data != 2) {
            cout << itr->data;
            newNodes.push_back(itr->l);
            newNodes.push_back(itr->r);
        } else {
            newNodes.push_back(new node(2));
            newNodes.push_back(new node(2));
            cout << " ";
        }

        printWhitespaces(betweenSpaces);
    }
} 
```

有时 itr->l(or r) 为空，而不是 init 结构。我怎样才能检查这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:13:42.897

Something like this? It will skip your `NULL` elements, and elements with `NULL` value for `r` member of the `vector` and continue the `for` loop.

```
node * itr = nodes.at(i);
if(!itr || !itr->r) continue; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:16:27.777

要检查指针是否为空，只需使用：

```
itr->l == 0 
```

如果为 0，则为空。但是考虑使用智能指针，它们更安全。

您还应该考虑使用以下方法以标准方式迭代您的向量：

```
std::vectoc<node*>::iterator
    it = nodes.begin(),
    ite = nodes.end();
for(; it != ite; ++it) {
    ...
} 
```

最后你可能应该像这样通过引用传递你的向量：

```
void printNode(std::vector<node*>& nodes, int level, int max_level) 
```

# linux - 来自 tar.gz 的 grep 不提取 [更快的一个]

> ID：13983365
> 
> 赞同：63
> 
> 时间：2012-12-21T02:11:12.617
> 
> 标签：linux, bash, grep

我正在尝试从十几个文件 .tar.gz 中提取模式，但它非常慢

我正在使用

```
tar -ztf file.tar.gz | while read FILENAME
do
        if tar -zxf file.tar.gz "$FILENAME" -O | grep "string" > /dev/null
        then
                echo "$FILENAME contains string"
        fi
done 
```

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2013-06-05T13:06:21.653

如果你有`zgrep`你可以使用

```
zgrep -a string file.tar.gz 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-12-21T15:32:48.057

您可以使用该`--to-command`选项将文件通过管道传输到任意脚本。使用它，您可以一次处理存档（并且没有临时文件）。另请参阅[此问题](https://stackoverflow.com/questions/8438982/piping-files-from-tar-to-a-command)和[手册](http://www.gnu.org/software/tar/manual/html_node/Writing-to-an-External-Program.html#SEC84)。有了上述信息，您可以尝试以下操作：

```
$ tar xf file.tar.gz --to-command "awk '/bar/ { print ENVIRON[\"TAR_FILENAME\"]; exit }'"
bfe2/.bferc
bfe2/CHANGELOG
bfe2/README.bferc 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-02-15T19:05:15.600

我知道这个问题已经 4 岁了，但我有几个不同的选择：

# 选项 1：使用`tar --to-command grep`

以下行将查找`example.tgz`. `PATTERN`这类似于@Jester 的示例，但我无法让他的模式匹配工作。

```
tar xzf example.tgz --to-command 'grep --label="$TAR_FILENAME" -H PATTERN ; true' 
```

# 选项 2：使用`tar -tzf`

第二个选项是`tar -tzf`用来列出文件，然后用`grep`. 您可以创建一个函数来反复使用它：

```
targrep () {
    for i in $(tar -tzf "$1"); do
        results=$(tar -Oxzf "$1" "$i" | grep --label="$i" -H "$2")
        echo "$results"
    done
} 
```

用法：

```
targrep example.tar.gz "pattern" 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-06-13T07:48:36.720

以下两个选项都运行良好。

```
$ zgrep -ai 'CDF_FEED' FeedService.log.1.05-31-2019-150003.tar.gz | more
2019-05-30 19:20:14.568 ERROR 281 --- [http-nio-8007-exec-360] DrupalFeedService  : CDF_FEED_SERVICE::CLASSIFICATION_ERROR:408: Classification failed even after maximum retries for url : abcd.html

$ zcat FeedService.log.1.05-31-2019-150003.tar.gz | grep -ai 'CDF_FEED'
2019-05-30 19:20:14.568 ERROR 281 --- [http-nio-8007-exec-360] DrupalFeedService  : CDF_FEED_SERVICE::CLASSIFICATION_ERROR:408: Classification failed even after maximum retries for url : abcd.html 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-21T02:24:11.197

如果这真的很慢，我怀疑您正在处理一个大型存档文件。它将解压缩一次以提取文件列表，然后将其解压缩 N 次——其中 N 是存档中的文件数——用于 grep。除了所有解压缩之外，每次都必须在存档中扫描相当多的内容以提取每个文件。最大的缺点之一`tar`是一开始没有目录。没有有效的方法来获取有关存档中所有文件的信息，并且只读取文件的该部分。它本质上必须读取所有文件，直到您每次提取的内容；它不能立即跳转到文件名的位置。

要加快速度，您可以做的最简单的事情是先解压缩文件 ( `gunzip file.tar.gz`)，然后处理该`.tar`文件。这本身可能就足够了。不过，它仍然会循环整个存档 N 次。

如果您真的希望它高效，您唯一的选择是在处理之前完全提取存档中的所有内容。由于您的问题是速度，我怀疑这是一个您不想先提取的巨大文件，但如果可以的话，这将大大加快速度：

```
tar zxf file.tar.gz
for f in hopefullySomeSubdir/*; do
  grep -l "string" $f
done 
```

请注意，`grep -l`打印任何匹配文件的名称，在第一个匹配后退出，如果没有匹配则静音。仅此一项就可以加快命令的 grepping 部分，因此即使您没有空间来提取整个存档，`grep -l`也会有所帮助。如果文件很大，它将有很大帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-12-21T02:20:05.067

对于初学者，您可以启动多个进程：

```
tar -ztf file.tar.gz | while read FILENAME
do
        (if tar -zxf file.tar.gz "$FILENAME" -O | grep -l "string"
        then
                echo "$FILENAME contains string"
        fi) &
done 
```

创建一个新的`( ... ) &`分离（阅读：父外壳不等待子外壳）进程。

之后，您应该优化存档的提取。读取没有问题，因为操作系统应该已经缓存了文件访问。但是，每次循环运行时，tar 都需要解压缩存档，这可能会很慢。解压存档一次并迭代结果可能会有所帮助：

```
local tempPath=`tempfile`
mkdir $tempPath && tar -zxf file.tar.gz -C $tempPath &&
find $tempPath -type f | while read FILENAME
do
        (if grep -l "string" "$FILENAME"
        then
                echo "$FILENAME contains string"
        fi) &
done && rm -r $tempPath 
```

`find`在这里使用，以获取我们正在迭代的目标目录中的文件列表`tar`，用于搜索字符串的每个文件。

**编辑：**`grep -l`正如吉姆指出的那样，用于加快速度。来自`man grep`：

```
 -l, --files-with-matches
          Suppress normal output; instead print the name of each input file from which output would
          normally have been printed.  The scanning will stop on the first match.  (-l is specified
          by POSIX.) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-02-05T01:41:51.110

> 我正在尝试从十几个文件 .tar.gz 中提取模式，但它非常慢
> 
> ```
> tar -ztf file.tar.gz | while read FILENAME
> do
>         if tar -zxf file.tar.gz "$FILENAME" -O | grep "string" > /dev/null
>         then
>                 echo "$FILENAME contains string"
>         fi
> done 
> ```

[使用ugrep](https://github.com/Genivia/ugrep)选项实际上很容易`-z`：

```
-z, --decompress
        Decompress files to search, when compressed.  Archives (.cpio,
        .pax, .tar, and .zip) and compressed archives (e.g. .taz, .tgz,
        .tpz, .tbz, .tbz2, .tb2, .tz2, .tlz, and .txz) are searched and
        matching pathnames of files in archives are output in braces.  If
        -g, -O, -M, or -t is specified, searches files within archives
        whose name matches globs, matches file name extensions, matches
        file signature magic bytes, or matches file types, respectively.
        Supported compression formats: gzip (.gz), compress (.Z), zip,
        bzip2 (requires suffix .bz, .bz2, .bzip2, .tbz, .tbz2, .tb2, .tz2),
        lzma and xz (requires suffix .lzma, .tlz, .xz, .txz). 
```

只需一个命令即可搜索`file.tar.gz`，如下所示：

```
ugrep -z "string" file.tar.gz 
```

这对每个存档文件进行 greps 以显示匹配项。存档文件名显示在大括号中，以区别于普通文件名。例如：

```
$ ugrep -z "Hello" archive.tgz
{Hello.bat}:echo "Hello World!"
Binary file archive.tgz{Hello.class} matches
{Hello.java}:public class Hello // prints a Hello World! greeting
{Hello.java}:  { System.out.println("Hello World!");
{Hello.pdf}:(Hello)
{Hello.sh}:echo "Hello World!"
{Hello.txt}:Hello 
```

如果您只想要文件名，请使用选项`-l`( `--files-with-matches`) 并使用选项自定义文件名输出以`--format="%z%~"`摆脱大括号：

```
$ ugrep -z Hello -l --format="%z%~" archive.tgz
Hello.bat
Hello.class
Hello.java
Hello.pdf
Hello.sh
Hello.txt 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-18T20:28:38.580

上面的所有代码都非常有用，但没有一个能完全满足我自己的需求：当前目录中的`grep`所有`*.tar.gz`文件都可以找到一个模式，该模式在可重用脚本中指定为参数以输出：

*   存档文件和提取文件的名称
*   找到模式的行号
*   匹配行的内容

这是我真正希望它能`zgrep`为我做的事情，但它不能。

这是我的解决方案：

```
pattern=$1
for f in *.tar.gz; do
     echo "$f:"
     tar -xzf "$f" --to-command 'grep --label="`basename $TAR_FILENAME`" -Hin '"$pattern ; true";
done 
```

`tar`如果您想使用基本`echo`语句测试所有变量是否正确扩展，也可以用以下内容替换该行：

```
tar -xzf "$f" --to-command 'echo "f:`basename $TAR_FILENAME` s:'"$pattern\"" 
```

让我解释一下发生了什么。希望有问题的存档文件名的`for`循环和是显而易见的。`echo`

`tar -xzf`：`x`提取，`z`通过gzip过滤，`f`基于以下存档文件...

`"$f"`: for 循环提供的存档文件（例如你通过`ls`双引号得到的），以允许变量扩展并确保脚本不会被任何带有空格的文件名等破坏。

`--to-command`：将 tar 命令的输出传递给另一个命令，而不是将文件实际提取到文件系统。这之后的所有内容都指定了命令是什么 ( `grep`) 以及我们传递给该命令的参数。

让我们自己分解那部分，因为它是这里的“秘诀”。

```
'grep --label="`basename $TAR_FILENAME`" -Hin '"$pattern ; true" 
```

首先，我们使用单引号开始这个块，这样执行的子命令 ( `basename $TAR_FILENAME`)*不会*立即展开/解析。稍后会详细介绍。

`grep`：要在（实际上不是）提取的文件上运行的命令

`--label=`: 用于添加结果的标签，其值用双引号括起来，因为我们*确实*希望`grep`命令解析命令`$TAR_FILENAME`传入的环境变量`tar`。

`basename $TAR_FILENAME`：作为命令运行（由反引号包围）并删除目录路径并仅输出文件名

`-Hin`:`H`显示文件名（由标签提供），`i`不区分大小写搜索，`n`显示匹配行数

然后我们用单引号“结束”命令字符串的第一部分，并用双引号开始下一部分，以便`$pattern`可以解析作为第一个参数传入的 。

意识到我需要使用哪些引语是让我绊倒时间最长的部分。希望这一切对您有意义并帮助其他人。另外，我希望我能在一年内再次需要它时找到它（我已经忘记了我为它制作的脚本！）

* * *

自从我写以上内容以来已经有几个星期了，它仍然非常有用......但它还不够好，因为文件已经堆积起来并且搜索东西变得更加混乱。我需要一种方法来限制我在文件日期之前查看的内容（仅查看更新的文件）。所以这就是代码。希望这是不言自明的。

```
if [ -z "$1" ]; then
    echo "Look within all tar.gz files for a string pattern, optionally only in recent files"
    echo "Usage: targrep <string to search for> [start date]"
fi
pattern=$1
startdatein=$2
startdate=$(date -d "$startdatein" +%s)
for f in *.tar.gz; do
    filedate=$(date -r "$f" +%s)
    if [[ -z "$startdatein" ]] || [[ $filedate -ge $startdate ]]; then
        echo "$f:"
        tar -xzf "$f" --to-command 'grep --label="`basename $TAR_FILENAME`" -Hin '"$pattern ; true"
    fi
done 
```

* * *

我不能停止调整这件事。我添加了一个参数来按 tar 文件中的输出文件的名称进行过滤。通配符也有效。

用法：

`targrep.sh [-d <start date>] [-f <filename to include>] <string to search for>`

例子：

`targrep.sh -d "1/1/2019" -f "*vehicle_models.csv" ford`

```
while getopts "d:f:" opt; do
    case $opt in
            d) startdatein=$OPTARG;;
            f) targetfile=$OPTARG;;
    esac
done
shift "$((OPTIND-1))" # Discard options and bring forward remaining arguments
pattern=$1

echo "Searching for: $pattern"
if [[ -n $targetfile ]]; then
    echo "in filenames:  $targetfile"
fi

startdate=$(date -d "$startdatein" +%s)
for f in *.tar.gz; do
    filedate=$(date -r "$f" +%s)
    if [[ -z "$startdatein" ]] || [[ $filedate -ge $startdate ]]; then
            echo "$f:"
            if [[ -z "$targetfile" ]]; then
                    tar -xzf "$f" --to-command 'grep --label="`basename $TAR_FILENAME`" -Hin '"$pattern ; true"
            else
                    tar -xzf "$f" --no-anchored "$targetfile" --to-command 'grep --label="`basename $TAR_FILENAME`" -Hin '"$pattern ; true"
            fi
    fi
done 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-02T09:32:39.150

就我而言，压缩包有很多小文件，我想知道压缩包内的存档文件匹配。`zgrep`速度很快（不到一秒），但没有提供我想要的信息`tar --to-command grep`，而且慢得多（很多分钟）¹。

所以我转向另一个方向，`zgrep`告诉我 tarball 中匹配项的字节偏移量，并将其与所有存档文件的 tarball 中的偏移量列表放在一起，以找到匹配的存档文件。

```
#!/bin/bash
set -e
set -o pipefail

function tar_offsets() {

    # Get the byte offsets of all the files in a given tarball 
    # based on https://stackoverflow.com/a/49865044/60422

    [ $# -eq 1 ]

    tar -tvf "$1" -R | awk '
    BEGIN{
      getline;
      f=$8;
      s=$5;
    }
    {
      offset = int($2) * 512 - and((s+511), compl(512)+1)
      print offset,s,f;
      f=$8;
      s=$5;
    }'

}

function tar_byte_offsets_to_files() {
    [ $# -eq 1 ]

    # Convert the search results of a tarball with byte offsets 
    # to search results with archived file name and offset, using
    # the provided tar_offsets output (single pass, suitable for
    # process substitution)

    offsets_file="$1"

    prev_offset=0
    prev_offset_filename=""

    IFS=' ' read -r last_offset last_len last_offset_filename < "$offsets_file"

    while IFS=':' read -r search_result_offset match_text
    do
        while [ $last_offset -lt $search_result_offset ]; do
            prev_offset=$last_offset
            prev_offset_filename="$last_offset_filename"

            IFS=' ' read -r last_offset last_len last_offset_filename < "$offsets_file"

            # offsets increasing safeguard
            [ $prev_offset -le $last_offset ]
        done

        # now last offset is the first file strictly after search result offset so prev offset is
        # the one at or before it, and must be the one it is in

        result_file_offset=$(( $search_result_offset - $prev_offset ))

        echo "$prev_offset_filename:$result_file_offset:$match_text"
    done
}

# Putting it together e.g.
zgrep -a --byte-offset "your search here" some.tgz | tar_byte_offsets_to_files <(tar_offsets some.tgz) 
```

* * *

¹我没有在 Linux 上运行它，我在 Windows 的最小 MSYS2 fork unixy 环境中使用 Git，因此 grep 的启动开销可能在 Linux 中要低得多，并且使 `tar --to-command grep`够好了; 在选择之前，根据您自己的需求和情况对解决方案进行基准测试。

# android - 每一类应用程序都单独安装在手机中。

> ID：13983368
> 
> 赞同：-1
> 
> 时间：2012-12-21T02:11:27.280
> 
> 标签：android

我开发了一个没有错误的android应用程序。它安装在我的手机中并且运行良好，但唯一的问题是，当我安装应用程序时。它正在单独安装应用程序中的所有类，并与它一起安装我的主应用程序。

那么，我应该如何防止所有类单独安装。请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:16:01.563

我猜你的 AndroidManifest.xml 有多个：

```
 <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
  </intent-filter> 
```

这导致为每个图标显示多个图标`Activity` 查找所有“额外”图标并删除它们。这曾经是 ADT 插件的一个问题（每次您`Activity`通过向导创建一个新插件时，它都会使用启动器属性自动添加它），您似乎使用的是旧版本。你应该更新它。

# asp.net-mvc - Exclude from ViewModel

> ID：13983371
> 
> 赞同：1
> 
> 时间：2012-12-21T02:12:03.893
> 
> 标签：asp.net-mvc, model-binding

I have the following file input tag in the "Create" View:

```
<input type="file" id="RequestFile" name="RequestFile"/>
@Html.ValidationMessage("RequestFile") 
```

The ViewModel contains this corresponding property:

```
[Required(ErrorMessage="Please select a file")]
public HttpPostedFileBase RequestFile { get; set; } 
```

This works fine in the "Create" View, but in the "Edit" View, I get ModelState.Isvalid as false. Using the same ViewModel I would like to exclude this field from validations because I would not want to upload the file again.

I tried simply disabling the input tag like this:

```
<input type="file" id="RequestFile" name="RequestFile" disabled/> 
```

This has a disabled input control but the Validation still fired.

Also applying the BindAttribute in the Controller did not work ([see this Question](https://stackoverflow.com/questions/10894329/exclude-some-child-members-from-getting-validated))

Ideally (I know it sounds unlikely), if there is a server-side solution to this, please post your thoughts. If there is a small client-side trick, please let me know!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:23:58.623

最好的方法是完全删除该属性，并始终直接从表单集合中访问它（并手动验证它）或使用属性名称手动删除模型状态错误（正如@cheesemacfly 在他的评论中所说的那样`ModelState.Remove("RequestFile")`）。后者使得它很容易修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:26:00.210

您可以使用 form.onsubmit 来检查它 document.getElementById("RequestFile").value 是否为空/空，如果是则取消提交。

就像是

```
<form onsubmit="if(!document.getElementById('RequestFile').value){alert('Please select a file.');return false;}" >
<input type="file" id="RequestFile" name="RequestFile" />
<input type="submit"/>
</form> 
```

return false 取消提交。

[http://jsfiddle.net/Cg7HY/1/](http://jsfiddle.net/Cg7HY/1/)

或者放在提交按钮本身的点击事件中

[http://jsfiddle.net/Cg7HY/3/](http://jsfiddle.net/Cg7HY/3/)

# wordpress - WordPress Templates - How do I exclude a template from the navigation bar?

> ID：13983380
> 
> 赞同：0
> 
> 时间：2012-12-21T02:13:28.003
> 
> 标签：wordpress, wordpress-theming

I created a new WordPress Template named "Footer page". When a new page is created in WordPress and the user selects the template "Footer page" the new page should not appear in the navigation bar.

I did some research and found something called "Exclude Pages from List" that says "Use the exclude parameter to hide certain Pages from the list to be generated by wp_list_pages." but have no idea where I should put it my template file? Or if this is the best way to exclude a template page from the navigation bar?

My code for footer-page.php is as follows:

```
<?php
/**
 * Template Name: Footer page
 *
 * A custom page template that does not appear in the navigation bar.
 *
 * The "Template Name:" bit above allows this to be selectable
 * from a dropdown menu on the edit page screen.
 *
 * @package WordPress
 * @subpackage Twenty_Ten
 * @since Twenty Ten 1.0
 */

get_header(); ?>

        <div id="container" class="one-column">
            <div id="content" role="main">

            <?php
            /* Run the loop to output the page.
             * If you want to overload this in a child theme then include a file
             * called loop-page.php and that will be used instead.
             */
             get_template_part( 'loop', 'page' );
            ?>

            </div><!-- #content -->
        </div><!-- #container -->

<?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T04:57:43.607

你可以试试这样：

```
if (is_page('1') || is_page('5')) {
             // 包括模板“sidebar.php”。
             获取模板部分（“循环”，“页面”）；
        }

```

[读这个](http://www.kimwoodbridge.com/how-to-exclude-pages-from-the-wordpress-navigation-bar/)

# javascript - Filtering page content with Jquery UI

> ID：13983382
> 
> 赞同：0
> 
> 时间：2012-12-21T02:13:32.320
> 
> 标签：javascript, jquery, jquery-ui

Attempting to filter out content on the page based on a jQuery UI autocomplete search. When the user is typing content not related to the search will switch to display: none; so only the content relevant to the search is displayed.

HTML

```
 <div class="items" data-id="Get Milk">Get Milk on the way home</div>
        <div class="items" data-id="Drop by Phil's">Drop by Phils house</div>
        <div class="items" data-id="Grab a Sandwich">Grab a sandwich</div>

<input id="auto" type="text" /> 
```

Javascript

```
$(function () {
    var source = $(".items").map(function () {
        return $(this).data("id");
    }).get();

    $("#auto").autocomplete({
        source: source        
    });
});​ 
```

Attempting with

```
$(document).ready(function () {

    var search = $("#auto").html();
    var results = $(".items").html();

    if (search == results) {
        $(".items").css("display", "block");
    } 
    else {
        $(".items").css("display", "none");
    }

}); 
```

Now I do understand that I need to refer to the individual "items" and this also needs to be demystified. ​ jsfiddle: [http://jsfiddle.net/J5rVP/25/](http://jsfiddle.net/J5rVP/25/) Courtesy Andrew Whitaker, from [bit.ly/U1gjr2](http://bit.ly/U1gjr2)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T02:32:11.247

好的，首先要了解您正在处理一个 jQueryUI 小部件。它们很棒且可扩展，但您必须深入研究文档以确保您了解它们的工作原理。

当您初始化自动完成时，您将需要提供一个响应功能，您可以在其中检查匹配项并在需要时隐藏。像这样：

```
$("#auto").autocomplete({
    source: source,
    response: function(event, ui){
        if(ui.content.length == 0)
            alert("nothing");
        else
           alert(ui.content.length + " items");
    }
}); 
```

最后，请仔细阅读自动完成文档。你会在那里学到很多关于 jQuery UI API 的知识。

[http://api.jqueryui.com/autocomplete/](http://api.jqueryui.com/autocomplete/)

# mobile-safari - Clickable overlay YouTube using Safari on IOS

> ID：13983387
> 
> 赞同：0
> 
> 时间：2012-12-21T02:13:53.260
> 
> 标签：mobile-safari, youtube-api

I'm using the YouTube API to display a video in the browser that takes up the entire viewable area. In every other browser I've tried it on (Chrome 23, IE 9, Safari 5, Chrome on Android), the close icon overlay is clickable while the video is playing (click link, see top right):

[http://jsbin.com/ajivex/2](http://jsbin.com/ajivex/2)

It doesn't work in Safari on IOS 5.1.1\. Is there anything I can do aside from creating a header and forcing the video not to take up the full height of the viewable area?

# haskell - 如何使用 Template Haskell 获取函数体？

> ID：13983391
> 
> 赞同：7
> 
> 时间：2012-12-21T02:14:10.140
> 
> 标签：haskell, template-haskell

目前，我正在尝试从 Haskell 子集进行翻译，而无需处理所有解析、类型检查等问题。文档并没有帮助我找出一个函数来通过其名称获取函数的主体（所有定义）。

此调用的上下文应类似于

```
fac 0 = 1
fac x = z * fac (x - 1)

getBody = ...

main = do
    x <- runQ $ getBody [| fac |]
    print x 
```

有谁知道

1.  TH 上是否有一些好的和最新的文档（不是 Hackage 上的参考）或
2.  如何制作getBody？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-21T02:44:21.480

通常，使用 TH 查找某事物定义的方法是使用`reify`函数。然而：

*   您[不能`reify`在运行时](http://www.haskell.org/haskellwiki/Template_Haskell#Why_does_runQ_crash_if_I_try_to_reify_something.3F)通过`runQ`. 它需要的信息在编译期间不可用。

*   目前，[由于缺乏兴趣，尚未实现](http://hackage.haskell.org/packages/archive/template-haskell/2.8.0.0/doc/html/Language-Haskell-TH.html#v%3aVarI)`reify`用于获取函数定义。

看来您需要另寻路线。您是否考虑过使用[该`haskell-src-exts`包](http://hackage.haskell.org/package/haskell-src-exts)进行解析和/或 GHC API 或基于它的东西？

# c++ - winsock2线程安全吗？

> ID：13983398
> 
> 赞同：5
> 
> 时间：2012-12-21T02:15:04.137
> 
> 标签：c++, multithreading, winsock2

我正在编写一个小型的 3 个服务器和 1 个客户端程序。2台服务器发送tcp消息，最后一台使用winsock2发送upd数据报。

我想知道我是否可以通过使用线程（OpenMP 或 boost::threads）来模拟 recvfrom()，以便 2 个线程同时从同一个端口上的同一个套接字监听。

我在 windows7 上使用 VC++ 2010。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T10:11:13.043

是的，套接字是线程安全的，但是你必须小心。一种常见的模式（当使用阻塞 IO 时）是让一个线程在一个套接字上接收数据，而另一个线程在同一个套接字上发送数据。让多个线程从一个套接字接收数据对于 UDP 套接字通常很好，但在大多数情况下对 TCP 套接字没有多大意义。[WSARecv](http://msdn.microsoft.com/en-us/library/ms741688%28v=VS.85%29.aspx)的文档中有一条警告：

> 不应从不同的线程同时在同一个套接字上调用 WSARecv，因为它可能导致不可预知的缓冲区顺序。

但是，如果您使用的是 UDP 并且协议是无状态的，这通常没有任何问题。

另请注意，`WSAEINPROGRESS`错误代码主要适用于 Winsock 1.1：

> WSAEINPROGRESS：阻塞的 Windows Sockets 1.1 调用正在进行中，或者服务提供者仍在处理回调函数。

`WSAEINPROGRESS`以及进一步状态的描述：

> 操作正在进行中。
> 
> 当前正在执行阻塞操作。Windows 套接字仅允许单个阻塞操作（每个任务或线程）处于未完成状态，并且如果进行了任何其他函数调用（无论它是否引用该套接字或任何其他套接字），该函数都会失败并出现 WSAEINPROGRESS 错误。

请注意，这涉及每个任务或线程的单个阻塞操作。

此外，WSARecv 的文档中还有一个附加警告：

> 在 APC 中发出另一个阻塞 Winsock 调用中断了同一线程上正在进行的阻塞 Winsock 调用将导致未定义的行为，并且 Winsock 客户端绝不能尝试。

但除了这些警告之外，你应该没问题。

更新：添加一些外部引用： [alt.winsock.programming：套接字线程安全吗？](https://groups.google.com/d/msg/alt.winsock.programming/JwxW797s4Ds/FTRgG1YKOVAJ) 和[Winsock 程序员的常见问题解答：Winsock 线程安全吗？](http://tangentsoft.net/wskfaq/intermediate.html#threadsafety)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T02:48:12.897

Winsock 只允许一个套接字上的阻塞 IO 调用。来自不同线程的多个阻塞调用最终会出现“WSAEINPROGRESS”错误。[http://msdn.microsoft.com/en-us/library/windows/desktop/ms740668%28v=vs.85%29.aspx#WSAEINPROGRESS](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740668%28v=vs.85%29.aspx#WSAEINPROGRESS)。

如果您想发出并发 IO 请求，您可以尝试使用异步 IO 或重叠 IO（在 Windows 用语中）。但我想你会想要并发处理数据而不是并发读取数据。在这种情况下，您可以让一个线程发出 IO 请求，其他线程进行处理。

# java - ClassCastException DataSource 无法转换为 javax.sql.ConnectionPoolDataSource

> ID：13983403
> 
> 赞同：4
> 
> 时间：2012-12-21T02:15:30.617
> 
> 标签：java, tomcat, jdbc, tomcat7

我得到了这个例外：

```
java.lang.ClassCastException: org.apache.tomcat.jdbc.pool.DataSource cannot be cast to javax.sql.ConnectionPoolDataSource 
```

当我尝试运行使用与 Tomcat7 无缝协作的 tomcat jdbc 池的 web 应用程序（在 Tomcat6 中）时

我已经在 tomcat 6 lib 文件夹中包含了这些 jar：

```
tomcat-jdbc.jar
tomcat-juli.jar 
```

可能是什么问题呢？

**更新：**

```
protected static Connection getConnection() throws NamingException, SQLException {
    InitialContext cxt = new InitialContext();
    String jndiName = "java:/comp/env/jdbc/MyDBHrd";
    ConnectionPoolDataSource dataSource = (ConnectionPoolDataSource) cxt.lookup(jndiName); // ClassCastException here....
    PooledConnection pooledConnection = dataSource.getPooledConnection();
    Connection conn = pooledConnection.getConnection();
    return conn; // Obtain connection from pool
} 
```

**配置：**

```
<Resource name="jdbc/MyDBHrd"
          auth="Container"
          type="javax.sql.DataSource"
          factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"
          testWhileIdle="true"
          testOnBorrow="true"
          testOnReturn="false"
          validationQuery="SELECT 1"
          validationInterval="30000"
          timeBetweenEvictionRunsMillis="30000"
          maxActive="5000"
          minIdle="10"
          maxWait="10000"
          initialSize="20"
          removeAbandonedTimeout="120"
          removeAbandoned="true"
          logAbandoned="false"
          minEvictableIdleTimeMillis="30000"
          jmxEnabled="true"
          jdbcInterceptors="org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;
            org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer"
          username="sa"
          password="password"
          driverClassName="net.sourceforge.jtds.jdbc.Driver"
          url="jdbc:jtds:sqlserver://192.168.114.130/MyDB"/> 
```

当我更改“类型”时：

```
 type="javax.sql.ConnectionPoolDataSource" 
```

我收到这个警告：

```
WARNING: javax.sql.ConnectionPoolDataSource is not a valid class name/type for this JNDI factory. 
```

导致`getConnection()`返回NULL。

**进口：**

```
import java.io.IOException;
import java.sql.CallableStatement;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Timestamp;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Map;

import javax.naming.InitialContext;
import javax.naming.NamingException;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.sql.ConnectionPoolDataSource;
import javax.sql.PooledConnection;

import org.apache.commons.dbutils.DbUtils;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T10:09:33.543

作为最终用户，您永远不必`ConnectionPoolDataSource`直接使用 a。它旨在作为物理连接的工厂 (the `PooledConnection`)。那`PooledConnection`保存在连接池中。当您执行 a`DataSource.getConnection`时，数据源将从池中签出 a `PooledConnection`，并将使用获得的逻辑连接返回给您作为最终用户，并在该逻辑关闭`PooledConnection.getConnection()`时将物理连接返回到池。`Connection`

所以构造是

```
User -- uses --> DataSource (with connectionpooling) -- uses --> ConnectionPoolDataSource 
```

或者

```
ConnectionPoolDataSource --> creates PooledConnection --> DataSource --> returns Connection --> User 
```

a 的使用与`DataSource`是否`DataSource`提供连接池无关（它应该对您透明）。

另请参阅我以前对另一个问题的回答：[https ://stackoverflow.com/a/12651163/466862](https://stackoverflow.com/a/12651163/466862)

换句话说，您的代码应更改为：

```
protected static Connection getConnection() throws NamingException, SQLException {
    InitialContext cxt = new InitialContext();
    String jndiName = "java:/comp/env/jdbc/MyDBHrd";
    DataSource dataSource = (DataSource) cxt.lookup(jndiName);
    Connection conn = dataSource.getConnection();
    return conn;
} 
```

# java - Collections.sort does not sort my list of objects

> ID：13983404
> 
> 赞同：0
> 
> 时间：2012-12-21T02:15:32.040
> 
> 标签：java

I'm trying to sort a list of objects by its id. Here is my code:

```
List<Employee> employee = getEmployeeList();
Collections.sort(employee, new Comparator<Employee>(){
    @Override
    public int compare(Employee employee1, Employee employee2) {
        return employee1.getEmployeeId().compareTo(employee2.getEmployeeId());
    }
}); 
```

But nothing happens after the sort, it still shows the original employee list. Am I doing something wrong? I've searched everywhere but they all just do this and it works for them. Here is a hard coded set of Employee Ids:

```
public class Employee{
    private String employeeId = "";
    private String employeeName = "";
    private String contactNbr = "";

    //getters and setters
}

List<Employee> empList = new ArrayList<Employee>();
Employee emp1 = new Employee();
emp1.setEmployeeId("A1B1");
empList.add(emp1);

Employee emp2 = new Employee();
emp2.setEmployeeId("A2B1");
empList.add(emp2);

Employee emp3 = new Employee();
emp3.setEmployeeId("A3B1");
empList.add(emp3);

Collections.sort(empList, new Comparator<Employee>(){
    @Override
    public int compare(Employee employee1, Employee employee2) {
        return employee1.getEmployeeId().compareTo(employee2.getEmployeeId());
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:26:42.453

检查employeeId compareTo 方法的结果。

如果它总是返回 0，则排序会认为所有元素都是相等的。集合进行稳定排序，因此如果所有元素都相等，它将保持顺序不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T05:34:07.497

您正在按排序顺序添加列表，这就是为什么您认为您的列表没有得到更新的印象。就您的消息来源而言，您做对了没有任何问题。问题是您的输入。您按如下排序顺序提供以下输入。

```
emp1.setEmployeeId("A1B1");
empList.add(emp1);

emp1.setEmployeeId("A2B1");
empList.add(emp2);

emp1.setEmployeeId("A3B1");
empList.add(emp3); 
```

您的输出将如下所示

```
Before sorting: [A1B1, A2B1, A3B1]
After sorting:  [A1B1, A2B1, A3B1] 
```

尝试如下修改源并检查

```
emp1.setEmployeeId("A3B1");
empList.add(emp3);

emp1.setEmployeeId("A2B1");
empList.add(emp2);

emp1.setEmployeeId("A1B1");
empList.add(emp1); 
```

你会得到如下结果

```
Before sorting: [A3B1, A2B1, A1B1]
After sorting:  [A1B1, A2B1, A3B1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T04:37:29.567

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.Iterator;
import java.util.List;

public class MainTest {

    public static void main(String[] arg)
    {
        List<Employee> empList = new ArrayList<Employee>();
        Employee emp1 = new Employee();
        emp1.setEmployeeId("A2B1");
        empList.add(emp1);

        Employee emp2 = new Employee();
        emp2.setEmployeeId("A1B1");
        empList.add(emp2);

        Employee emp3 = new Employee();
        emp3.setEmployeeId("A3B1");
        empList.add(emp3);

        Collections.sort(empList, new Comparator<Employee>(){

            public int compare(Employee employee1, Employee employee2) {
                return employee1.getEmployeeId().compareTo(employee2.getEmployeeId());
            }
        });

        Iterator i = empList.iterator();
        while(i.hasNext()){
            System.out.println(((Employee)i.next()).getEmployeeId());
        }

    }
}
class Employee{
    private String employeeId = "";
    private String employeeName = "";
    private String contactNbr = "";
    public String getContactNbr() {
        return contactNbr;
    }
    public void setContactNbr(String contactNbr) {
        this.contactNbr = contactNbr;
    }
    public String getEmployeeId() {
        return employeeId;
    }
    public void setEmployeeId(String employeeId) {
        this.employeeId = employeeId;
    }
    public String getEmployeeName() {
        return employeeName;
    }
    public void setEmployeeName(String employeeName) {
        this.employeeName = employeeName;
    }

    //getters and setters
} 
```

这是正确打印输出：A1B1 A2B1 A3B1

# php - 如何处理同时适用于服务器和客户端代码的常量？

> ID：13983407
> 
> 赞同：-1
> 
> 时间：2012-12-21T02:15:48.337
> 
> 标签：php, javascript, jquery, node.js

假设您将输入到表单中的文本限制为 500 个字符。您实际上并没有停止实时表单上的文本输入，而是有一个计数器在用户结束时提醒用户。JS代码需要知道限制是500。也许JS代码也会在提交时修剪文本。

在提交时，您使用 AJAX 对表单数据进行一些服务器端魔术。谨慎的做法是让服务器端 PHP 代码现在将注释文本修剪为 500 个字符，无论 JS 代码是否这样做。

这引入了一种情况，您必须在两段代码中输入一个常量，这对维护不利。这是一个简单的例子。情况可能更糟。

我在这里考虑两种情况：

```
JavaScript/JQuery <-> PHP
JavaScript/JQuery <-> Node.js 
```

您如何进行清理以减少维护负担并减少出错的可能性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T02:19:26.627

服务器是存储此类信息的唯一可靠位置，因为客户端上的任何内容都可以被操纵。

因此，我会将设置数组或配置文件作为 json 字符串发送给客户端。

# reactiveui - ReactiveUI 4.1 CreateDerivedCollection(...) 过滤器似乎不起作用

> ID：13983410
> 
> 赞同：0
> 
> 时间：2012-12-21T02:16:17.577
> 
> 标签：reactiveui

我正在使用`ReactiveUI 4.1`. 我使用一个`ReactiveCollection`可选项目（具有`IsSelected`标志）作为另一个派生反应集合的来源，该集合使用过滤器仅查看具有`IsSelected == true`. 如果在创建派生集合之前源集合预先填充了一些未/选定的项目，则视图过滤器似乎可以工作，但是当稍后源集合中的项目从选中状态变为未选中状态时，这些项目不会“消失”派生的集合。我确实在所有集合上设置`ChangeTrackingEnabled`了标志`true`，但它似乎没有帮助。附上我的代码片段：

```
private readonly ReactiveCollection<string> _sourceItems =  new ReactiveCollection<string>();
private readonly ReactiveCollection<SelectableDataItem<string>> _selectableItemsView = null;
private readonly ReactiveCollection<SelectableDataItem<string>> _selectedItemsView = null;
private readonly ReactiveCollection<string> _selectedDataView = null;

///....

    this._sourceItems.ChangeTrackingEnabled = true;

    this._selectableItemsView =
        this.SourceItems.CreateDerivedCollection<string, SelectableDataItem<string>>(i => new SelectableDataItem<string>(i) { IsSelected = true, });
    this._selectableItemsView.ChangeTrackingEnabled = true;
    this._selectedItemsView =
        this._selectableItemsView.CreateDerivedCollection<SelectableDataItem<string>, SelectableDataItem<string>>(
        i => i,
        f => f.IsSelected,
        (i1, i2) => 0
        );
    this._selectedItemsView.ChangeTrackingEnabled = true;
    this._selectedDataView =
        this._selectableItemsView.CreateDerivedCollection<SelectableDataItem<string>, string>(i => i.Data, f => f.IsSelected, (i1, i2) => 0);
    this._selectedDataView.ChangeTrackingEnabled = true; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T00:23:57.963

嗯，看起来像一个错误 - 您可以执行以下操作之一：

*   创建一个遇到此错误的示例应用程序，然后[创建一个问题](https://github.com/reactiveui/reactiveui/issues/new)
*   （更好）创建一个针对[ReactiveUI](https://github.com/reactiveui/reactiveui)的拉取请求，测试失败

# java - Cocos2D 对象扩展 CCSprite Android

> ID：13983411
> 
> 赞同：0
> 
> 时间：2012-12-21T02:16:23.257
> 
> 标签：java, android, cocos2d-iphone

我正在使用 Cocos2D，并且我创建了一个扩展 CCSprite 的 Object 类

我需要调用 CCSprite.sprite("filename") 方法，而不是作为 CCSprite 而是作为我创建的 Object 类。

这是我的课

```
public class Object extends CCSprite{
    public Object(){

    }
} 
```

这是我尝试调用该方法的方式

```
protected GameLayer()
{
    Object player = new Object();   
    player = Object.sprite("player.png");
{ 
```

我收到一条错误消息，提示“类型不匹配：无法从 CCSprite 转换为对象”

既然类是 CCSprite 的子类，为什么需要对其进行转换？

我应该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:23:50.673

已经`Object`定义了一个类，它是一切的超类。你不能去重新定义它，因为那样编译器就会感到困惑。

# core-data - 核心数据 - 原始设置器/获取器更快吗？什么时候不使用？

> ID：13983412
> 
> 赞同：0
> 
> 时间：2012-12-21T02:16:24.640
> 
> 标签：core-data

来自 Apple 的核心数据编程指南：

> Core Data 为托管对象类动态生成高效的公共和原始 get 和 set 属性访问器方法和关系访问器方法。
> 
> ...
> 
> 原始访问器方法类似于“普通”或公共键值编码兼容访问器方法，只是 Core Data 使用它们作为访问数据的最基本数据方法，因此它们不发出键值访问或观察通知。换句话说，它们对于primitiveValueForKey: 和setPrimitiveValue:forKey: 什么公共访问器方法对于valueForKey: 和setValue:forKey:。

然后我希望原始访问器方法比公共访问器性能更好，因为它们不会触发 KVO 通知。有没有办法用 Time Profiler 有效地测试这个理论？（当然，这不可能像将两个调用放在它们自己的 for 循环中那样简单，这些循环会迭代无数次并比较结果......）

显然，原始访问器不会被托管对象子类之外的对象或函数调用，但是什么时候不应该在类中使用它们呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T12:24:24.223

edelaney05,

如您所知，Core Data 依赖于 Objective-C 的 KVC/KVO 特性。是的，您是正确的，通过访问器的路径长度稍长。它呢？Core Data 的性能主要取决于 I/O 子系统的性能。

IOW，调整获取请求比避免访问器开销重要得多。你能做到你提议的吗？是的。你应该？不。IMO，您应该专注于如何有效地将数据放入 MOC，然后使用谓词和其他过滤技术对其进行优化。学习如何在提取后使用各种关键路径运算符和谓词语言对于编写高性能 CD​​ 代码非常重要。只有在 Instruments 可以记录您在访问器中花费了大量时间之后，我才会考虑您避免它们的策略。

在回答您的具体问题时，您通常应该将原始访问器的使用限制在您重新实现公共访问器的范围内。坚持使用所有代码的访问器将成为您的标准模式。这为您提供了将任意行为与任何属性相关联的长期工程优势。最后，如果您可以使用各种密钥路径和集合运算符，那么 CD 团队已经优化了这些访问模式。它们的性能非常好。

安德鲁

# node.js - Socket.io 因内部错误而失败

> ID：13983415
> 
> 赞同：1
> 
> 时间：2012-12-21T02:16:42.477
> 
> 标签：node.js, redis, socket.io

我最近运行了 npm install，它更新了我所有的包。出于某种原因，这破坏了我的网络服务器（每当我尝试加载页面时，它只会加载一部分并死于此错误）。我尝试回滚版本的 socket.io、redis 和 nodetime，它们是出现在堆栈跟踪中的包，但是我没有运气让网络服务器再次工作。帮助？我在 OS X 上运行。

```
events.js:66
        throw arguments[1]; // Unhandled 'error' event
                       ^
TypeError: First argument must be a Buffer
    at RedisClient.message (/Users/jchu/code/python/agles/ci/web/back/node_modules/socket.io/lib/stores/redis.js:126:24)
    at RedisClient.EventEmitter.emit (events.js:115:20)
    at RedisClient.return_reply (/Users/jchu/code/python/agles/ci/web/back/node_modules/socket.io/node_modules/redis/index.js:440:22)
    at RedisReplyParser.<anonymous> (/Users/jchu/code/python/agles/ci/web/back/node_modules/socket.io/node_modules/redis/index.js:81:14)
    at RedisReplyParser.EventEmitter.emit (events.js:88:17)
    at RedisReplyParser.add_multi_bulk_reply (/Users/jchu/code/python/agles/ci/web/back/node_modules/socket.io/node_modules/redis/lib/parser/javascript.js:311:14)
    at RedisReplyParser.send_reply (/Users/jchu/code/python/agles/ci/web/back/node_modules/socket.io/node_modules/redis/lib/parser/javascript.js:272:18)
    at RedisReplyParser.execute (/Users/jchu/code/python/agles/ci/web/back/node_modules/socket.io/node_modules/redis/lib/parser/javascript.js:222:22)
    at RedisClient.on_data (/Users/jchu/code/python/agles/ci/web/back/node_modules/socket.io/node_modules/redis/index.js:358:27)
    at Socket.<anonymous> (/Users/jchu/code/python/agles/ci/web/back/node_modules/socket.io/node_modules/redis/index.js:93:14) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-28T09:18:03.670

你安装了 MsgPack 吗？我用了之后

```
npm install msgpack 
```

Socket.IO 会告诉我你发布的确切错误。

我通过卸载 MsgPack

```
npm uninstall msgpack 
```

一切都恢复正常了。这不是问题的解决方案，但它是让您的系统重新运行的解决方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-20T18:47:18.013

不幸的是，我的项目中需要 MsgPack，因此我无法使用此处列出的答案。

相反，我找到了这个页面： [https ://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO](https://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO)

这导致我进行了这些代码更改。

以前我有：

```
redis = require('redis'),
redisPub = redis.createClient(),
redisSub = redis.createClient(),
redisClient = redis.createClient(),
RedisStore = require('connect-redis')(express),
sessionStore = new RedisStore({
  client: redisClient
}),
socketRedisStore = require('socket.io/lib/stores/redis'),
socketRedis = require('socket.io/node_modules/redis'),

...

io.configure(function() {
  io.set('log level', 1);
  io.set('store', new socketRedisStore({
    redisPub: redisPub,
    redisSub: redisSub,
    redisClient: redisClient
  }));
  io.set('authorization', function(data, accept) {

... 
```

进入这个：

```
redis = require('redis'),
redisPub = redis.createClient(),
redisSub = redis.createClient(null, null, {detect_buffers: true}),
redisClient = redis.createClient(),
RedisStore = require('connect-redis')(express),
sessionStore = new RedisStore({
  client: redisClient
}),
socketRedisStore = require('socket.io/lib/stores/redis'),
socketRedis = require('socket.io/node_modules/redis'),

...

io.configure(function() {
  io.set('log level', 1);
  io.set('store', new socketRedisStore({
    redis: redis,
    redisPub: redisPub,
    redisSub: redisSub,
    redisClient: redisClient
  }));
  io.set('authorization', function(data, accept) {

... 
```

注意 redisSub 中包含的选项，用于检测缓冲区，然后将基本 redis 对象注入到 socket.io 存储配置中。

# c# - 如何阻止 ScrollViewer 向下滚动

> ID：13983420
> 
> 赞同：1
> 
> 时间：2012-12-21T02:17:08.243
> 
> 标签：c#, windows-phone-7, xaml

我需要让 ScrollViewer 只向下滚动。

我在 Xaml 中创建了一个滚动查看器，并在其中填充了一个堆栈面板，其中包含代码中的矩形。然后我从底部启动用户，并希望他们用手指（如贝司手）使用“行走”动作滚动到顶部，但不希望他们能够滚动回底部。

我的 Xaml 看起来像这样：

```
<ScrollViewer Height="730" HorizontalAlignment="Left" Margin="6,6,0,0" Name="scrollViewer1" VerticalAlignment="Bottom" Width="462">
    <StackPanel Name="TrackStackPanel">

    </StackPanel>
</ScrollViewer> 
```

但是既然是用代码填写的，就需要尽可能多的在代码中完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T06:35:01.873

我会尝试通过`VerticalScrollBarVisibility="disabled"`- 处理手势来禁用垂直滚动，然后通过设置 [ScrollToVerticalOffset] 相应地滚动。

如果这不起作用，请尝试在 ScrollViewer 上方放置一个图层（例如 Grid），以便它接收所有手势，然后按照上述操作，通过 ScrollToVerticalOffset 滚动。

# javascript - JavaScript 生成下载？

> ID：13983425
> 
> 赞同：-2
> 
> 时间：2012-12-21T02:17:52.877
> 
> 标签：javascript, python, pdf, download

JavaScript 中有没有办法生成可下载的 PDF 或任何其他可以包含图像和文本的文件？我正在做一个需要此功能的奇怪项目。JavaScript 嵌入在本地存储的网页中，我可以完全控制用户的环境。如果我以一种或另一种方式配置本地安全设置，有没有办法以某种方式使用 JavaScript 运行本地进程？无论如何，我问的原因如下，这是我的项目，我有点挂了......

我有一个脚本可以在用户运行脚本时选择的分区上遍历文件系统。然后该脚本获取所有文件的列表并生成从文件系统遍历中找到的所有图像文件的缩略图文件。然后将这些缩略图生成到 HTML 页面中，然后由 firefox 中的脚本打开该页面。我在脚本生成的页面中有 JavaScript，允许用户选中和取消选中每个缩略图旁边的复选框。目标是一旦用户选择了他们感兴趣的所有图像，他们可以按下按钮生成他们选择的图像的报告。我不确定如何生成所述报告。我看到一个类似于我的问题，用 jsPDF 回答，但我不确定这是否是适合我情况的最佳解决方案？我只是在寻找想法和建议！如果需要，我愿意学习其他脚本方法。可以考虑使用服务器端解决方案，但我想远离任何本地服务器等（如 PHP 等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:36:36.170

您*可以*`data:`为此目的使用uri，然后使用[HTML5 下载属性](http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#attr-hyperlink-download)使其易于下载。不幸[的是，目前只有 Chrome 支持下载属性](http://caniuse.com/#feat=download)。（尽管据报道支持将在 Firefox 20 中提供）。没有下载属性，用户仍然可以右键保存。

[这是这种技术在工作中的一个很好的例子](http://webreflection.blogspot.de/2011/08/html5-how-to-create-downloads-on-fly.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T02:22:57.533

为了安全起见，浏览器中的 Javascript 被*大量沙盒化。*您无法从 JS 调用直接生成本地进程。就您而言，听起来您也不是在运行服务器，而是在通过脚本创建静态站点。

我强烈建议改为运行本地服务器 - 甚至可能*在脚本中使用*[Flask](http://flask.pocoo.org/)之类的东西，这是 Python 中一个很棒的微服务器框架。这样，您的 Javascript 将能够与您的“服务器”（这只是您的脚本）进行交互，然后可以根据需要即时生成 PDF。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T02:26:37.743

如果您[与您的服务器合作](http://tutorialzine.com/2011/05/generating-files-javascript-php/)，您可以将请求中的文件内容发送到隐藏 iframe 中的服务器，并让服务器回显该文件，并带有将其标记为下载的标头。

但是，似乎没有办法只在 javascript 中生成文件并使用“另存为”对话框保存到用户的机器上。看起来有[一个 API 正在为此工作](http://www.w3.org/TR/file-writer-api/)，但我认为它还没有准备好。

另一个非常不雅的选项是弹出一个带有 svg 代码的警报窗口（基本上是 XML，因此您可以在不需要额外库的情况下构建它）并告诉用户复制并粘贴到记事本中并保存为 .svg。

# java - Android 多文件上传到服务器

> ID：13983426
> 
> 赞同：1
> 
> 时间：2012-12-21T02:18:06.483
> 
> 标签：java, android, file, upload, image-uploading

我在将图像上传到服务器时遇到问题，以便更好地向您解释我的问题我准备了一对 PHP 脚本来模拟我想要发生的事情。

```
PHP upload file ///////////////////////////////////////////////////////////////////// 
<form  enctype="multipart/form-data"  action=destination.php method=post>
<input  type=file name=file1 />
<input  type=file name=file2 />
<input  type=submit name=submit />
</form>

    PHP destination file ////////////////////////////////////////////////////////////////

<?php

$files = array('file1', 'file2', 'file3');
$path = 'elp/pendingimages/';

foreach ($files as $file) {
    if ($_FILES[$file]['error'] > 0) {
        echo 'Error: '. $_FILES[$file]['error'] .'<br />';
    }
    else {
        echo 'Upload: '. $_FILES[$file]['name'] .'<br />';
        echo 'Type: '. $_FILES[$file]['type'] .'<br />';
        echo 'Size: '. ($_FILES[$file]['size'] / 1024) .' Kb<br />';
        echo 'Stored in: '. $_FILES[$file]['tmp_name'] .'<br />';
    }
}

?> 
```

///////////////////////////////////////// ////////////////////////////////

让目标文件保持原样，因为我无法控制服务器，我希望在我的 JAVA 代码中拥有与上传文件相同的功能。我已经有了这个，但我的问题是服务器中只插入了一行

```
FileInputStream fileInputStream = new FileInputStream(sourceFile);
URL url = new URL(upLoadServerUri);
conn = (HttpURLConnection) url.openConnection(); // Open a HTTP connection to the URL
conn.setDoInput(true); // Allow Inputs
conn.setDoOutput(true); // Allow Outputs
conn.setUseCaches(false); // Don't use a Cached Copy
conn.setRequestMethod("POST");
conn.setRequestProperty("Connection", "Keep-Alive");
conn.setRequestProperty("ENCTYPE", "multipart/form-data");
conn.setRequestProperty("Content-Type", "multipart/form-data;boundary=" + boundary);
conn.setRequestProperty("image[]", fileName);
dos = new DataOutputStream(conn.getOutputStream());
dos.writeBytes(twoHyphens + boundary + lineEnd);
dos.writeBytes("Content-Disposition: form-data; name=\"image[]\";filename=\"" + fileName + "\"" + ";user_id=\"157\"" + lineEnd);
dos.writeBytes(lineEnd);
dos.writeBytes(lineEnd);
bytesAvailable = fileInputStream.available(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:19:36.007

我已经在我的博客上写[了关于它的教程。](http://bayu.freelancer.web.id/2012/06/18/membuat-file-upload-di-android-dan-php/)不过，它是在印度尼西亚语中。在您的问题中，这是因为您只上传了一个文件。您将需要重复添加上传字段过程。

# linux - 通过shell脚本拆分字符串变量

> ID：13983428
> 
> 赞同：2
> 
> 时间：2012-12-21T02:18:26.440
> 
> 标签：linux, shell, tcl

我有一个包含日期和时间的字符串，**时间戳= 12-12-2012 16:45:00**

我需要将其重新格式化为**timestamp= 16:45:00 12-12-2012**

如何在 shell 脚本中实现这一点？

请注意：变量的值为**12-12-2012 16:45:00**，**时间戳**是变量的名称

```
#!usr/bin/expect
set timestamp "16:45:00 12-12-2012"
Now what should i do so value of timestamp will become 12-12-2012 16:45:00
script extention is .tcl example test.tcl 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T02:21:50.810

您可以使用可变模式移除。## 的意思是“从左边开始贪婪地删除所有匹配模式的东西”。%% 从右往右表示相同：

```
tm=${timestamp##* }
dt=${timestamp%% *}
result="$tm $dt" 
```

或者你可以使用 cut 来做同样的事情，给出一个字段分隔符：

```
tm=$(echo $timestamp | cut -f2 -d' ')
dt=$(echo $timestamp | cut -f1 -d' ')
result="$tm $dt" 
```

或者您可以使用 sed 将它们与正则表达式交换（参见其他帖子）。

或者如果您从 date 命令中提取日期，您可以要求它为您格式化：

```
result=$(date +'%r %F') 
```

就此而言，您可能有一个日期版本来解析您的日期，然后让您随心所欲地表达它：

```
result=$(date -d '12/12/2012 4:45 pm' +'%r %F') 
```

诚然，最后一个对日期输入很挑剔......有关接受输入的信息，请参阅“信息日期”。

如果你想使用正则表达式，我喜欢 Perl 的……它们写起来更干净：

```
echo $timestamp | perl -p -e 's/^(\S+)\s+(\S+)/$2 $1/' 
```

其中 \S 匹配非空格字符，+ 表示“一个或多个”，而 \s 匹配空格。括号会捕获匹配的部分。

**编辑：**

抱歉，没有意识到“时间戳=”是实际数据的一部分。如果您首先删除该部分，则上述所有示例都有效：

```
var='timestamp=2012-12-12 16:45:11'
timestamp=${var#timestamp=}
... then as above ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T02:21:40.140

使用 sed：

```
sed 's/\([0-9]*-[0-9]*-[0-9]*\)\([ \t]*\)\(.*\)/\3\2\1/' input 
```

此命令适用于包含该模式的行`number-number-number whitespace antyhing`。它只是将`number-number-number`零件`\([0-9]*-[0-9]*-[0-9]*\)`与`anything`零件交换`\(.*\)`，同时保留原始空格`\([ \t]*\)`。所以 sed 的替换部分是 `\3\2\1`，表示第三部分，空格，第一部分。

与 tcl 相同的逻辑：

```
set timestamp "12-12-2012 16:45:00"
set s [regsub {([0-9]*-[0-9]*-[0-9]*)([ \t]*)(.*)} $timestamp \\3\\2\\1]
puts $s 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T02:23:43.963

[awk](/questions/tagged/awk "显示标记为“awk”的问题")解决方案：

```
string="timestamp= 12-12-2012 16:45:00"
awk '{print $1, $3, $2}' <<< "$string" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T02:38:29.957

在 bash（和类似的 shell）中：

```
$ timestamp="12-12-2012 16:45:00"
$ read -a tsarr <<< "$timestamp"
$ echo "${tsarr[1]} ${tsarr[0]}"
16:45:00 12-12-2012 
```

# c# - 如何重构切换到字典/工厂

> ID：13983429
> 
> 赞同：4
> 
> 时间：2012-12-21T02:18:33.753
> 
> 标签：c#, dictionary, refactoring, switch-statement, factory

我正在尝试运行从文本文件中读取并逐行解析的“食谱”以动态调用一系列方法。我认为在进行了相当多的谷歌搜索之后我需要实现一个工厂，但我缺乏一些关键细节。这是我最接近的例子：

[http://simpleprogrammer.com/2010/08/17/pulling-out-the-switch-its-time-for-a-whooping/](http://simpleprogrammer.com/2010/08/17/pulling-out-the-switch-its-time-for-a-whooping/)

下面的代码是现在的一个片段。

```
 internal static void Run(int Thread_ID, List<StringBuilder> InstructionSet, List<double>[] Waveforms)
    {
        //Init
        List<double>[] Register = new List<double>[10];
        for (int i = 0; i < Waveforms.Length; i++) { Register[i] = new List<double>(Waveforms[i]); }
        for (int i = 0; i < Register.Length; i++) { if (Register[i] == null) { Register[i] = new List<double>(); } }

        //Run Recipe Steps
        foreach (var item in InstructionSet)
        {
            Step Op = Step.Parse(item.ToString());
            switch (Op.TaskName)
            {
                case "SimpleMovingAverage":
                    Register[Convert.ToInt32(Op.Args[0])] = Signal_Filters.SimpleMovingAverage(Register[Convert.ToInt32(Op.Args[1])], Convert.ToInt32(Op.Args[2]));
                    break;

                case "RollingSteppedStdDeviation":
                    Register[Convert.ToInt32(Op.Args[0])] = Signal_Filters.RollingSteppedStdDeviation(Register[Convert.ToInt32(Op.Args[1])], Convert.ToInt32(Op.Args[2]), Convert.ToInt32(Op.Args[3]));
                    break;

               //... etc. many, many methods to be called.
            }
        }
    } 
```

...以下是我有疑问的示例部分：

```
public static class MoveFactory
{
    private static Dictionary<string, Func<IMove>> moveMap = new Dictionary<string, Func<IMove>>()
    {
        {"Up", () => { return new UpMove(); }},
        {"Down", () => { return new DownMove(); }},
        {"Left", () => { return new LeftMove(); }}
        // ...
    };

    public static IMove CreateMoveFromName(string name)
    {
        return moveMap[name]();
    }
} 
```

1.  我可以自动生成字典列表吗？因此，每当我添加一个实现我的工厂接口（相当于 IMove）的新类时，我不必更新我的字典或我的代码的几乎任何其他部分。也许这可以强制作为接口的一部分？

2.  在上面的示例代码中，我没有看到它传入和传出参数。查看我的代码，我有需要逐步变异的数据......我将如何使用工厂来做到这一点。

3.  工厂需要是线程安全的，因为我想将不同的初始数据传递给多个运行自己的配方的工作人员。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T05:43:20.897

让我们一次解决这些问题。

## 动态构建词典

[使用反射](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.110%29.aspx)和[自定义属性](http://msdn.microsoft.com/en-us/library/sw480ze8%28v=vs.110%29.aspx)的组合实际上很容易做到这一点。

属性的创建非常简单，因此我将把它留给您自己查找，但我们假设您有一个`MoveNameAttribute`可以在类级别应用的调用。然后你可以装饰你的类，实现`IMove`如下：

```
[MoveName("Up")]
class UpMove: IMove{}

[MoveName("Down")]
class DownMove: IMove{} 
```

现在，您可以使用反射和一点[LINQ](http://msdn.microsoft.com/en-us/library/vstudio/bb397926.aspx)将这些类类型提取到字典中，并使用自定义属性中指定的键按需创建这些类型的新实例。

虽然整个工厂本身的代码行数非常短，但如果您以前从未做过反射，那么反射可能会令人生畏。我已经注释了每一行来解释发生了什么。

```
internal static class MoveFactory
{
    private static readonly IDictionary<String, Type> _moveTypes;

    static MoveFactory()
    {
        _moveTypes = LoadAllMoveTypes();
    }

    private static IDictionary<string, Type> LoadAllMoveTypes()
    {
        var asm =
            //Get all types in the current assembly
            from type in Assembly.GetExecutingAssembly().GetTypes()
            //Where the type is a class and implements "IMove"
            where type.IsClass && type.GetInterface("IMove") != null
            //Only select types that are decorated with our custom attribute
            let attr = type.GetCustomAttribute<MoveNameAttribute>()
            where attr != null
            //Return both the Name and the System.Type
            select new
                        {
                            name = attr.Name,
                            type
                        };

        //Convert the results to a Dictionary with the Name as a key
        // and the Type as the value
        return asm.ToDictionary(move => move.name, move => move.type);
    }

    internal static IMove CreateMove(String name)
    {
        Type moveType;

        //Check to see if we have an IMove with the specific key
        if(_moveTypes.TryGetValue(name, out moveType))
        {
            //Use reflection to create a new instance of that IMove
            return (IMove) Activator.CreateInstance(moveType);
        }

        throw new ArgumentException(
           String.Format("Unable to locate move named: {0}", name));
    }
} 
```

现在您有了工厂，您可以像这样简单地创建新实例：

```
var upMove = MoveFactory.CreateMove("Up");
var downMove = MoveFactory.CreateMove("Down"); 
```

由于工厂使用[静态构造](http://msdn.microsoft.com/en-us/library/k9x6w0hc%28v=vs.110%29.aspx)器，它只会填充这个列表一次，并会自动选择你的新类。

## 传递参数

我不是 100% 确定你的用例在这里，但看起来你不需要将参数传递给你的工厂，而是传递给你的`IMove`. 但是，您可以传入可变数量的参数。

如果是这种情况，那么您将不得不忍受您的设计中的一些丑陋。您的`IMove`界面上需要一个非常通用的方法：

```
public interface IMove
{
   double Compute(double val1, params int[] args);
} 
```

现在您的个人移动课程将不得不勤奋并检查以确保它们获得正确数量的参数。我将把它作为一个练习留给你，但这应该根据上面的例子给你你需要的东西。

## 线程安全

就目前而言，上面的工厂实现是线程安全的，因为它不依赖任何共享状态，并且底层字典本质上是不可变的。每次调用`CreateMove`都会返回一个全新的`IMove`实例。

现在你的实现是否`IMove`是线程安全的取决于你:)

哇！这是一个很长的答案，但希望这会对你有所帮助。

# c# - 代码类型的实际名称

> ID：13983441
> 
> 赞同：1
> 
> 时间：2012-12-21T02:20:40.867
> 
> 标签：c#

所以我基本上自学了如何编程（我没有说我有什么好），我很好奇代码的名称是什么，我很难解释。

```
Console.WriteLine( "eg." );
   ^  and   ^ 
```

我想知道他们叫什么？它类似于方法和功能吗？哦

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T02:23:47.143

您在句点之前列出的代码的左侧是**class**。在这种情况下，类是**Console**。

句号的右手边是一个**方法**。在这种情况下，**WriteLine()**。

这是一个**静态方法**调用的示例，因为您没有实例化**Console**类型的对象，而只是从该类中调用了一个静态方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T02:24:07.473

*   `Console`是 的缩写`System.Console`。它是`Console`在命名空间中`System`命名的类。
*   `WriteLine`是`Console`类中的一个方法。

* * *

我*强烈*建议你从一些初学者的材料开始。如果你不知道这些东西叫什么，你会发现不可能再学习了。所有教程材料都假定您至少听说过一门课程。

# mysql - 如何定位现有（“父”）记录并向其添加关联记录

> ID：13983445
> 
> 赞同：3
> 
> 时间：2012-12-21T02:21:16.647
> 
> 标签：mysql, ruby-on-rails, ruby, activerecord

我正在抓取一个网站，基本上，我有一个名为的表`games`和一个名为`publisher`. 一场比赛`has_one :publisher`。

当我找到一个游戏时，比如星际争霸（与暴雪发行商合作），我创建了一个名为 Starcraft 的游戏，以及一个名为 Blizzard 的发行商。这个问题：

当我找到暴雪的另一款游戏时，比如暗黑破坏神，我创建了一个新游戏，名称为`Diablo`，新发行商名称为`Blizzard`。现在我有两个名为 name 的发布者`Blizzard`。我如何确保星际争霸和暗黑破坏神都指向唯一的暴雪？

我想在创建游戏之前搜索数据库，查找发行商是否存在并使用它，如果不存在则创建一个然后使用它。但这是正常/最好的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:24:51.390

是的，您首先找到它，如果它不存在，则创建它：

```
publisher = Publisher.find_or_create_by_name name: "Blizzard"
publisher.games.build name: "Diablo", <more_params_for_game>
publisher.save

or we could also use create instead of build above. 
```

# javascript - Javascript将字符串更改为类型函数？

> ID：13983446
> 
> 赞同：1
> 
> 时间：2012-12-21T02:21:25.690
> 
> 标签：javascript

我有一个存储为字符串的函数列表，例如：

```
var act= "function () { alert() }"; 
```

我需要将行为的类型从“字符串”更改为“函数”，以便可以 .call() 它。我应该这样结束：

```
act = function () { alert() }; 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T02:24:04.120

这是使用 eval 不仅有效而且正确的少数情况之一：

```
var act = eval(function_string); 
```

但是，我应该注意，在字符串中包含一堆函数是糟糕设计的标志。不过，如果你必须这样做，那么 eval 就是这样做的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T02:25:22.233

尝试这个：

```
var act = 'alert(5);';

act = new Function( act ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T02:23:39.330

我猜你必须用eval来做。但是很多人认为它是邪恶的（请确保您从安全的来源获取字符串。）

```
var act= "function () { alert() }";
eval ('act = '+ act) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-21T02:22:28.800

您可以使用`eval`，尽管如果字符串来源未知，则认为它特别不安全。你不能真正将你拥有的东西分配给任何变量。`eval`参数必须是**表达式**或**语句**。你可以做这样的事情。

```
eval("var act = function () { alert('hey') }");    
act();​ 
```

# common-lisp - 如何保证干净地退出 sbcl

> ID：13983447
> 
> 赞同：6
> 
> 时间：2012-12-21T02:21:33.650
> 
> 标签：common-lisp, sbcl

我通过一个 shellscript 调用我的 common-lisp 程序，该 shellscript 使用必要的参数调用 sbcl，我必须保证无论如何实际程序完成调用将以一些/无输出结束。

我目前的解决方案如下所示：

```
sbcl --eval "(unwind-protect 
               (handler-case 
                   (progn 
                      (declaim #+sbcl(sb-ext:muffle-conditions style-warning))
                      (let ((*standard-output* (make-broadcast-stream)))
                        (ql:quickload \"module\"))
                   (eval (read-from-string \"(package:start)\"))) ;this starts the program
                  (error (err) 
                                (FORMAT t \"Something went really wrong:~a~%\" err) 
                                (sb-ext:exit))) 
              (sb-ext:exit))" 
```

但在以下两种情况下，它不会起作用：

```
sbcl --eval "(unwind-protect 
                 (handler-case 
                    (progn 
                       (define-condition bad () ())
                       (error 'bad)) 
                   (error (err) 
                                 (FORMAT t \"Something went really wrong:~a~%\" err) 
                                 (sb-ext:exit))) 
                 (sb-ext:exit))"

sbcl --eval "(unwind-protect 
                 (handler-case 
                     (progn 
                       (labels ((rek () (rek)))
                         (rek)))
                   (error (err) 
                                 (FORMAT t \"Something went really wrong:~a~%\" err) 
                                 (sb-ext:exit))) 
               (sb-ext:exit))" 
```

我现在想知道是否有另一种解决方案可以捕获被调用程序的任何可能结果并确保 sbcl 调用将退出干净？

对于第一种情况，一般捕获没有指定捕获什么，可能会做交易。第二种情况必须能够处理会导致调用低级调试器的错误/错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T03:01:08.963

该`--non-interactive`开关将确保 SBCL 永远不会进入调试器或 REPL。它类似于传递`--disable-debugger`和使用`--eval "(sb-ext:quit)"`. `sb-ext:*invoke-debugger-hook*`如果您不希望它在发生错误时打印回溯，您也可以自定义。

# maple - 如何在枫树中创建类似结构的地图（std :: map）？

> ID：13983449
> 
> 赞同：0
> 
> 时间：2012-12-21T02:21:42.053
> 
> 标签：maple

我需要一个带有 API 的容器，例如：

```
addKeyValuePair(containerRef, [key, value])
searchByKey(containerRef, key) #that would return NULL or `value` 
```

如何在 Maple (15) 中创建这样的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T08:42:30.843

You might just want usual indexing into a [table](http://www.maplesoft.com/support/help/Maple/view.aspx?path=table). Note that previously unassigned name `Y` below becomes a `table` just by virtue of assigning to some indexed entry `Y[a]`.

```
restart:
Y[a]:=211:

Y[a];
                          211

Y[b];
                          Y[b]

assigned(Y[a]);
                          true

assigned(Y[b]);
                         false

eval(Y);
                      table([a = 211]) 
```

Having said all that, it's only a small bit of wrapping to get the functionality you've described, where accessing `Y[b]` returns `NULL` when `Y[b]` is not yet assigned, etc.

You can of customize (or remove) the error checking and restriction that `key` be of type `symbol`, as Maple allows a `table` to be indexed more generally.

```
restart:

addKeyValuePair:=proc(containerRef::{indexed,symbol}, L::list)
  if nops(L) <> 2 then
    error "expecting list with two entries"; end if;
  if not type(L[1], symbol) then
    error "expecting list with symbol as first entry"; end if;
  containerRef[L[1]]:=L[2];
  NULL;
end proc:

searchByKey:=proc(containerRef::{indexed,symbol}, key::name)
  if assigned(containerRef[key]) then
    containerRef[key];
  else
    NULL;
  end if;
end proc:

addKeyValuePair( Y, [a, 4.5] );

searchByKey( Y, a );
                          4.5

searchByKey( Y, b );

searchByKey( Q, b );

addKeyValuePair( Y, [a, 211] );

searchByKey( Y, a );
                          211

addKeyValuePair( Y, [c] );
Error, (in addKeyValuePair) expecting list with two entries

addKeyValuePair( Y, [2.34, 211] );
Error, (in addKeyValuePair) expecting list with symbol as first entry 
```

A `table` is a mutable data structure. It is of type [last_name_eval](http://www.maplesoft.com/support/help/Maple/view.aspx?path=last_name_eval) and in consequence it (effectively) gets passed "by reference" as argument to a procedure call.

# eclipse - ndk-build 库无法通过 eclipse 添加到 apk 文件中，并且在 aapt a lib 模块之后出现签名问题

> ID：13983455
> 
> 赞同：0
> 
> 时间：2012-12-21T02:22:05.987
> 
> 标签：eclipse, android-ndk, ubuntu-12.04, aapt, android-keystore

首先，我正在运行一个托管在 win8 上的 ubuntu 12.04 x86 虚拟机。我正在将 ac/c++ 库编译到我的 android 应用程序中。

在目录中使用 ndk-build 后，似乎库和模块构建成功。而且我还可以看到 libs/armeabi/ 下的 .so 文件。但是，当我将我的项目导入 Eclipse 时，它​​总是给出错误，说在这种情况下找不到 lib，命名事件。而且我确实解压了apk文件，发现lib/armeabi/.so没有打包在apk文件中。

以下是详细信息，希望任何人都可以帮助我。

**NDK 构建：**

```
simon@ubuntu:~/projects/apps/latest/tgs-android/jni$ ndk-build 
 /home/simon/Android/android-ndk-r8c/build/core/add-application.mk:128: Android NDK:          WARNING: APP_PLATFORM android-14 is larger than android:minSdkVersion 11                a       in /home/simon/projects/apps/latest/tgs-android 
```

**androidManifest.xml**

```
 Compile++ thumb  : swift <= NativeLib.cpp
    Compile++ thumb  : swift <= sha1.cpp
    Compile++ thumb  : swift <= compat.cpp
    Compile++ thumb  : swift <= sendrecv.cpp
    Compile++ thumb  : swift <= send_control.cpp
    Compile++ thumb  : swift <= hashtree.cpp
    Compile++ thumb  : swift <= bin.cpp 
    Prebuilt       : libevent.a <= jni/libevent2/lib/
    Prebuilt       : libstlport_static.a <= <NDK>/sources/cxx-stl/stlport/libs/armeabi/
    SharedLibrary  : libevent.so
    Install        : libevent.so => libs/armeabi/libevent.so 
```

**能找到**

```
simon@ubuntu:~/projects/apps/latest/tgs-android/jni$ ls ../libs/armeabi/ 
libevent.so 
```

我遇到的另一个问题是，当我尝试使用 aapt a 将 .so lib 添加到 .apk 文件时，它似乎成功了，但是当我使用 adb install 在我的设备上安装它时。它提示：

```
 simon@ubuntu:~/projects/apps/latest/tgs-android/bin$ adb install IntroActivity.apk 
    2871 KB/s (1089288 bytes in 0.370s)
pkg: /data/local/tmp/IntroActivity.apk
    Failure [INSTALL_PARSE_FAILED_NO_CERTIFICATES]
    simon@ubuntu:~/projects/apps/latest/tgs-android/bin$ 
```

**但是我认为apk文件已经被eclipse在调试模式下签名了。**

```
simon@ubuntu:~/projects/apps/latest/tgs-android/bin$ jarsigner -verify     IntroActivity.apk 
    jar verified. 
```

警告：此 jar 包含未经完整性检查的未签名条目。

使用 -verbose 和 -certs 选项重新运行以获取更多详细信息。

任何帮助表示赞赏！提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T07:49:01.593

您可以通过在 Eclipse 中执行以下步骤来解决此问题：

1.

*   窗口 -> 首选项 -> C/C++ -> 构建 -> 设置
*   选择 CDT GNU C/C++ 错误解析器
*   在底部的错误解析器选项中，添加一个包含以下内容的新条目：

    ```
    Severity: Warning
    Pattern: (.*?):(\d+): Android NDK: WARNING:(.*)
    File: $1
    Line: $2
    Description: $3 
    ```

2\. 之后将这个新项目移到其上层的上方：`(.*?):(\d+):(\d+:)? (.*)`

这在这里讨论：[https ://code.google.com/p/android/issues/detail?id=39752](https://code.google.com/p/android/issues/detail?id=39752)

# r - 矩阵运算：索引逻辑到数值比较的不对称向量

> ID：13983456
> 
> 赞同：1
> 
> 时间：2012-12-21T02:22:10.390
> 
> 标签：r

我正在使用逻辑矩阵来选择和排序数字矩阵中相应元素的**索引**（两者具有相同的维度）。例如，

```
 x <- c(FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, FALSE)
 y <- c(7, 10, 3, 1, 6, 8, 2, 11, 1, 5)

 order(y[x],decreasing=TRUE)
 [1] 5 1 4 3 2 6 

 # NOTE: these are the **indices** of the ordered vector y[x] now containing
 # only six elements (10,3,6,8,11,1) 
```

伟大的。正常工作。然而，当我对一个矩阵进行运算时，我得到了一个意想不到的结果：

```
 x <- matrix(rep(c(F,T,T),10), nrow=10)

        [,1]  [,2]  [,3]
  [1,] FALSE  TRUE  TRUE
  [2,]  TRUE  TRUE FALSE
  [3,]  TRUE FALSE  TRUE
  [4,] FALSE  TRUE  TRUE
  [5,]  TRUE  TRUE FALSE
  [6,]  TRUE FALSE  TRUE
  [7,] FALSE  TRUE  TRUE
  [8,]  TRUE  TRUE FALSE
  [9,]  TRUE FALSE  TRUE
 [10,] FALSE  TRUE  TRUE

 y <- matrix( round(rnorm(30,sample(10))), ncol=3)

       [,1] [,2] [,3]
  [1,]    7    7    6
  [2,]   10   12    8
  [3,]    3    5    6
  [4,]    1    1    0
  [5,]    6    5    6
  [6,]    8    7    7
  [7,]    2    3    4
  [8,]   11    8    9
  [9,]    1    2    1
 [10,]    5    5    5

  y<-structure(c(7, 10, 3, 1, 6, 8, 2, 11, 1, 5, 7, 12, 5, 1, 5, 7, 
  3, 8, 2, 5, 6, 8, 6, 0, 6, 7, 4, 9, 1, 5), .Dim = c(10L, 3L))

 order(y[x], decreasing=TRUE)
 [1]  8  5  1  4 12  7 17  3 14 15 10 13 20 18  2 11  6  9 19 16 
```

似乎当比较返回长度不等的向量（取决于 x 中的逻辑 TRUE）时，我正在破坏操作的预期行为。然而，

```
 y[x]
 [1] 10  3  6  8 11  1  7 12  1  5  3  8  5  6  6  0  7  4  1  5 
```

产生我所期望的没有排序；order(y[x]) 对所有 TRUE 元素执行。这是一个错误吗？我会（天真地）期望它会分别对每一列执行操作并像上面那样连接结果。

无论如何，是否有合理的方法将不对称结果划分为矩阵？我考虑用 NA 填充每个向量到 max dim(x)，然后 cbind 成一个矩阵（见下文）。看起来像一团糟，因为我会失去矢量化。还有更优雅的想法/提示吗？

谢谢。

```
#Desired result
     [,1] [,2] [,3]
[1,]    5    2    4
[2,]    1    6    1
[3,]    4    1    2
[4,]    3    4    7
[5,]    2    7    5
[6,]    6    5    6
[7,]   NA    3    3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:26:19.210

我不确定为什么要使用 NA 保留矩阵结构。你不能使用列表列表吗？在这种情况下，您可以将矩阵转换为数据框并使用 mapply。这就是您在 R 中独立地对每一列执行函数的方式。

```
my.order <- function(x, y) order(y[x],decreasing=TRUE)
mapply(my.order, as.data.frame(x), as.data.frame(y))

$V1
[1] 5 1 4 3 2 6

$V2
[1] 2 6 1 4 7 5 3

$V3
[1] 4 1 2 7 5 6 3 
```

如果您确实需要，您始终可以填充每个元素并将列表强制为数据框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:30:26.757

`y[x]`返回

```
[1]  8  5  1  4 12  7 17  3 14 15 10 13 20 18  2 11  6  9 19 16 
```

这是一个数字向量。

`order(y[x])`因此正在处理一个数字向量。它没有记忆`y`并且`x`是矩阵，也没有能力读懂你的想法，它应该按列应用，并且应用于曾经是 3 列的矩阵，并且你想用`NA`值填充它。

您可以使用`is.na<-`并返回一个列表（类似于我写这篇文章时发布的答案）

```
newy <- y

is.na(newy) <- !x 
```

应用（新，2，函数（x）顺序（na.omit（x），递减=真））

```
[[1]]
[1] 5 1 4 3 2 6

[[2]]
[1] 2 6 1 4 7 5 3

[[3]]
[1] 4 1 2 7 5 6 3 
```

# java - TTS 支持汉字/语音

> ID：13983461
> 
> 赞同：0
> 
> 时间：2012-12-21T02:22:27.847
> 
> 标签：java, text-to-speech, chinese-locale

我将开发一个可以将文本转换为语音的工具。当然，对汉字的支持非常重要。如果没有，TTS 将是一个很好的选择，如果互联网访问是可访问的，我可以使用谷歌翻译 API。不幸的是，并非所有使用我的工具的地方都可以访问互联网，我想知道是否有另一种方法来完成这项任务？

我在互联网上搜索过，espeak 将是一个不错的解决方案。但我必须封装DLL。

有没有更好的解决方案来满足我的要求？

# vb.net - 在 vb.net 中使用箭头键导航

> ID：13983465
> 
> 赞同：0
> 
> 时间：2012-12-21T02:22:47.237
> 
> 标签：vb.net

我正在尝试使用箭头键（上/下）通过控件进行导航。
要尝试我的示例，只需创建一个新的 form1 并将此代码粘贴到其中。

```
Public Class Form1

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    Dim tb As New TextBox
    Dim cb As New CheckBox
    Dim cbb As New ComboBox
    Dim b1 As New Button
    Dim b2 As New Button

    With Me
        .KeyPreview = True
        .Size = New Size(350, 200)
        With .Controls
            .Add(tb)
            With tb
                .TabIndex = 0
                .Location = New Point(95, 20)
                .Text = "This is"
            End With
            .Add(cb)
            With cb
                .TabIndex = 1
                .Location = New Point(95, 50)
                .Checked = True
                .Text = "Example checkbox"
                .AutoSize = True
            End With
            .Add(cbb)
            With cbb
                .TabIndex = 2
                .Location = New Point(95, 80)
                .Text = "an Example"
                .DropDownStyle = ComboBoxStyle.DropDownList
            End With
            .Add(b1)
            With b1
                .TabStop = False
                .Location = New Point(90, 130)
                .Text = "Nothing"
            End With
            .Add(b2)
            With b2
                .TabStop = False
                .Location = New Point(170, 130)
                .Text = "Exit"
                AddHandler b2.Click, AddressOf b2_Click
            End With
        End With
    End With
End Sub

Private Sub Form1_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyDown
    If e.KeyCode = Keys.Up Then
        e.Handled = True
        Me.SelectNextControl(Me.ActiveControl, False, True, True, True)
    End If

    If e.KeyCode = Keys.Down Then
        e.Handled = True
        Me.SelectNextControl(Me.ActiveControl, True, True, True, True)
    End If
End Sub

Private Sub b2_Click(ByVal sender As Object, ByVal e As System.EventArgs)
    Me.Close()
End Sub

End Class 
```

发生什么了？
当启动一个程序并用箭头导航时，控件周围没有“焦点矩形”，在某些情况下，焦点“跑出来”到带有 tabstop = false 的控件？

但...

如果我用 TAB 键通过控件后，用箭头导航变得很好，焦点矩形出现，一切正常。

这里可能有什么问题？在程序启动后立即使用箭头导航的行为与使用 tab 键的行为相同，该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T09:35:51.160

我在这里找到了一种解决方案，可以“通过代码”按预期工作： [C# 代码](http://www.codeproject.com/Articles/27367/Enabling-Hot-Keys-Short-Cut-keys-for-windows-Appli)

这是我对 VB 的翻译。
1）在您的一些公共模块中添加导入...

```
Imports System.Runtime.InteropServices 
```

2）将此声明放在同一模块中：

```
<DllImport("user32.dll")> _
Private Sub SystemParametersInfo(ByVal uiAction As UInteger, ByVal uiParam As UInteger, ByRef pvParam As Integer, ByVal fWinIni As UInteger)
End Sub

' Constants used for User32 calls. 
Const SPI_SETKEYBOARDCUES As UInteger = &H100B 
```

3）将此公共功能放在同一模块中：

```
''' <summary> 
''' Change the setting programmatically 
''' for keyboard shortcut Issue 
''' </summary> 
Public Sub GetAltKeyFixed()
    Dim pv As Integer = 1
    ' Call to systemparametersinfo to set true of pv variable.

    SystemParametersInfo(SPI_SETKEYBOARDCUES, 0, pv, 0)
    'Set pvParam to TRUE to always underline menu access keys, 
End Sub 
```

4）从程序的开始位置（比如Form1）只需调用：

```
GetAltKeyFixed() 
```

一次就够了 ：）

# sql-server - 何时需要在 try catch 块中检查 @@trancount > 0？

> ID：13983467
> 
> 赞同：25
> 
> 时间：2012-12-21T02:23:11.140
> 
> 标签：sql-server, sql-server-2008, tsql, transactions, try-catch

有时我会看到以下代码片段。什么时候`if @@trancount > 0`需要`begin try`？两个都？或者它是一种安全的方式（最佳实践）来检查它，以防它在检查之前回滚？

```
begin tran
begin try
  ... just several lines of sql ...
  if @@trancount > 0 commit tran
end try
begin catch
  if @@trancount > 0 rollback tran
end catch 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T04:33:17.117

我可以想到一些在处理时要考虑的场景`@@trancount`：

1.  当前事务是从另一个具有自己事务的存储过程中调用的
2.  当前事务由一些具有自己事务的 .NET 代码调用
3.  当前交易是唯一的交易

我相信 Remus Rusanu 的[异常处理和嵌套事务](http://rusanu.com/2009/06/11/exception-handling-and-nested-transactions/)处理了所有这些可能性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-10-11T04:33:05.603

当你不使用@@trancount时，嵌套事务存储过程的错误信息不会返回错误的确切原因只是reurtn“回滚事务请求没有相应的开始事务”，否则它给出了错误的确切原因，所以它使用正确的语法很容易处理错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-10T11:59:05.773

回答这个问题 - 执行@@trancount 的时间是中间的代码是否可能已经执行了您启动的事务的提交或回滚。因此，例如，如果您正在调用存储过程 - 然后在最后执行检查。

顺便说一句，而不是做一个 if @@trancount>0 我建议最好在代码块的开头检查 @@trancount ，然后看看计数是否在最后增加了，在这种情况下做提交或回滚，取决于 try/catch。

特别是如果您处于触发器中，因为 @@trancount 将始终为 1，因此仅执行 @@trancount>0 可能会导致错误。

但是，即使您的代码只是在存储过程中，假设它被另一个本身具有打开事务的过程调用，如果您的代码错误并回滚，那么外部存储过程也将回滚其事务（参见[https： //www.sqlskills.com/blogs/paul/a-sql-server-dba-myth-a-day-2630-nested-transactions-are-real/](https://www.sqlskills.com/blogs/paul/a-sql-server-dba-myth-a-day-2630-nested-transactions-are-real/)）。

所以

开始 TRAN 打印@@TRANCOUNT

开始 TRAN 打印@@TRANCOUNT

回滚 TRAN 打印 @@TRANCOUNT

显示 1 2 0

So basically - if the code in the middle is calling other procedures, you need to perform the IF @@TRANCOUNT check.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-18T21:25:11.743

检查的原因是，如果您在@@trancount=0 时提交trans 或回滚它，您会收到带有此错误消息的异常：COMMIT TRANSACTION 请求没有相应的BEGIN TRANSACTION。

# backbone.js - 如何在集合提取上保留自定义属性

> ID：13983470
> 
> 赞同：4
> 
> 时间：2012-12-21T02:23:30.407
> 
> 标签：backbone.js

我有一个“资产”主干模型，它有一个名为“selected”的自定义属性。从某种意义上说，它不是服务器端对象的一部分，因此它是自定义的。我用来表示用户当前选择了哪些资产列表。

```
var Asset = Backbone.Model.extend({
    defaults: {
        selected: false
    },

    idAttribute: "AssetId"
}); 
```

这个模型是我定期获取的主干集合的一部分，以从服务器获取任何更改。

我遇到的问题是，每次我获取集合时，集合都会进行重置（我可以通过侦听重置事件来判断），因此选定属性的值会被来自 ajax 的数据清除要求。

骨干.js 文档似乎暗示有一个智能合并可以解决这个问题。我相信我在我的 fetch 方法中这样做

```
 allAssets.fetch({  update: true ,cache: false}); 
```

而且我还在模型中设置了“idAttribute”字段，这样进来的对象的id就可以和集合中的对象进行比较了。

我解决这个问题的方法是在我的集合对象中编写我自己的 Parse 方法

```
 parse: function (response) {
    // ensure that the value of the "selected" for any of the models
    // is persisted into the model in the new collection
    this.each(function(ass) {
        if (ass.get("selected")) {
            var newSelectedAsset = _.find(response, function(num) { return num.AssetId == ass.get("AssetId"); });
            newSelectedAsset.selected = true;
        }
    });
    return response;
} 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T10:34:55.990

[Collection.update](http://backbonejs.org/#Collection-update)（在 Backbone 0.9.9 中引入）确实尝试合并现有模型，但通过将新模型中的所有设置属性合并到旧模型中来实现。如果你检查[Backbone source code](http://backbonejs.org/docs/backbone.html#section-84)，你会看到

```
if (existing || this._byCid[model.cid]) {
    if (options && options.merge && existing) {
        existing.set(model.attributes, options);
        needsSort = sort;
    }
    models.splice(i, 1);
    continue;
} 
```

所有属性（包括默认值）都已设置，这就是您选择的属性重置为 false 的原因。删除 selected 的默认值将按预期工作：将[http://jsfiddle.net/nikoshr/s5ZXN/](http://jsfiddle.net/nikoshr/s5ZXN/)与[http://jsfiddle.net/nikoshr/s5ZXN/3/进行比较](http://jsfiddle.net/nikoshr/s5ZXN/3/)

也就是说，我不会依赖模型属性来存储我的应用程序状态，我宁愿将它移动到其他地方的控制器。

# datatable - p:subTable 标头中的 p:commandLink 仅针对第一个 p:subTable 触发

> ID：13983482
> 
> 赞同：1
> 
> 时间：2012-12-21T02:24:51.280
> 
> 标签：datatable, primefaces, commandlink

我需要在 subTable 标题中显示一个命令链接。页面正确呈现，但是只有第一个命令链接会触发并调用操作方法。所有后续命令链接都不会调用操作方法。我查看了前两个锚元素的 html 源代码。生成的 id 略有不同。第一个链接的 id 在 j_dt68 之后没有数字，而第二个链接的 id 有 j_dt68:0。不确定它是否重要。请帮忙！

```
First commandlink's html code:
                    <a id="center_content_form:equipment_tabview:equipment-table:0:j_idt68:equipment_details_link" href="#" class="ui-commandlink"   onclick="PrimeFaces.ab({source:'center_content_form:equipment_tabview:equipment-table:0:j_idt68:equipment_details_link'});return false;">DGI5120_GI:SB-5120 | 06634CVJTKH5</a>

Second commandlink's html code:
<a id="center_content_form:equipment_tabview:equipment-table:1:j_idt68:0:equipment_details_link" href="#" class="ui-commandlink" onclick="PrimeFaces.ab({source:'center_content_form:equipment_tabview:equipment-table:1:j_idt68:0:equipment_details_link'});return false;">DAR502G_ARRIS:TM502G | 6A7BMU47P225361</a>

<p:dataTable id="equipment-table" styleClass="list-datatable"
var="equipment" value="#{equipmentBean.equipmentList}"
emptyMessage="#{equipment_msgs['equipment.table.emptyMessage']}">

<f:facet name="header">
    <p:commandButton immediate="true" id="assign_equipment"
        icon="add-sign" styleClass="table-header-button-class"
        title="#{equipment_msgs['assign.equipment.tooltip.text']}"
        action="#{equipmentBean.navigateToAssignEquipmentPage()}" />
    <h:outputText
        value="#{equipment_msgs['assign.equipment.button.label']}"
        styleClass="table-header" />
</f:facet>

<p:column id="port_number"
    headerText="#{equipment_msgs['port.number.column.label']}"
    styleClass="col10 table_text" />
<p:column id="port_address"
    headerText="#{equipment_msgs['address.column.label']}"
    styleClass="co20 table_text" />
<p:column id="port_type"
    headerText="#{equipment_msgs['type.column.label']}"
    styleClass="col20 table_text" />
<p:column id="port_category"
    headerText="#{equipment_msgs['port.category.column.label']}"
    styleClass="col20 table_text" />
<p:column id="service_category"
    headerText="#{equipment_msgs['service.category.column.label']}"
    styleClass="col20 table_text" />
<p:column id="occurrence"
    headerText="#{equipment_msgs['occurrence.column.label']}"
    styleClass="col20 table_text" />
<p:column id="modem"
    headerText="#{equipment_msgs['modem.column.label']}"
    styleClass="col10 table_text" />
<p:subTable var="port" value="#{equipment.portList}">
    <f:facet name="header">
        <p:separator styleClass="header-separator" />
        <p:commandLink  id="equipment_details_link"
            value="#{equipment.detailLinkValue}"
            action="#{equipmentBean.navigateToEquipmentDetailsPage()}" >
            <f:setPropertyActionListener value="#{equipment}"
                target="#{equipmentBean.selectedEquipment}" />
        </p:commandLink>
        <p:separator styleClass="header-separator" />
    </f:facet>
    <p:column>
        <p:commandLink immediate="true" id="equipment_port_details_link"
            value="#{port.portNumber}"
            action="#{equipmentBean.navigateToEquipmentPortDetailsPage(port.portNumber)}">
            <f:setPropertyActionListener value="#{equipment}"
                target="#{equipmentBean.selectedEquipment}" />
        </p:commandLink>
    </p:column>
    <p:column>
        <p:commandLink immediate="true" id="equipment_port_addressable_transaction_details_link1"
            value="#{port.portAddress}"
            action="#{equipmentBean.navigateToEquipmentAddressPortDetailsPage(port.portNumber)}">
            <f:setPropertyActionListener value="#{equipment}"
                target="#{equipmentBean.selectedEquipment}" />
        </p:commandLink>
    </p:column>
    <p:column>#{port.portType}</p:column>
    <p:column>#{port.portDetails.portCategory}</p:column>
    <p:column>#{port.portDetails.serviceCategory}</p:column>
    <p:column>#{port.portDetails.occurrence}</p:column>
    <p:column>#{port.portDetails.modemText} </p:column>
</p:subTable>
 </p:dataTable> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T13:58:46.320

我做了一个解决方法：

在您的链接/按钮（在您的子表内）上放置一个 onclick 属性以从 id 中删除额外的数字并调用 PrimeFaces.ad(..) 函数

像这样：

```
 <script type="text/javascript">
        function deleteMsg(id) {
            var pattern = /(\w+:\w+:\d+:\w+)(:\d+)(:\w+)/g;
            var newId = id;
            if (pattern.test(id)) {
                newId = id.replace(pattern, "$1$3");
            }

            PrimeFaces.ab({source:newId,update:'formTable'});
            return false;
        }
    </script> 
```

在你的按钮上：

```
<p:commandButton onclick="return deleteMsg($(this).attr('id'))" actionListener="#{pSMsgController.removeMsg(_msg)}" icon="ui-icon-trash"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-14T13:47:56.243

尝试这个。

```
id replace js:

<script type="text/javascript">
        function deleteMsg(link) {
            var id = link.attr('id'); 

            var pattern = /(\w+:\w+:\d+:\w+)(:\d+)(:\w+)/g;
            var newId = id;
            if (pattern.test(id)) {
                newId = id.replace(pattern, "$1$3");
            }

            PrimeFaces.ab({source:newId,update:link.attr('id', newId)});
            return false;
        } 
```

子表标题中的 CommandLink：

```
 <p:commandLink onclick="return deleteMsg($(this));" ... > 
```

# php - 响应式设计 - Android 无法缩放

> ID：13983483
> 
> 赞同：0
> 
> 时间：2012-12-21T02:24:55.343
> 
> 标签：php, android, mysql, css, responsive-design

我正在处理的响应式设计提出了另一个问题。为简单起见，如果屏幕尺寸或设备尺寸小于 750 像素，我将主体设置为 480 像素。然后，理想情况下，任何设备上的屏幕都应该缩放以适应宽度。

今天已经在这里得到了一些帮助，我添加了视口元，所以现在 CSS 可以响应我的 iPhone 和 Android，以及最小化时的桌面浏览器。

iPhone 看起来很棒；它缩放到宽度，所以即使网页大约是 480 像素，它也非常适合我的 320 像素 iPhone 屏幕。

但是，在 Android 上，它放大得太远了。大约 25%-30% 的右侧不在屏幕上，我必须滚动才能看到它。如果我稍微缩小一点，则窗口在宽度方面适合屏幕并且看起来不错。我不知道为什么我必须手动缩小。

*   为什么加载页面时Android没有缩小到页面的宽度？

我的元标记如下所示：

```
<meta name="viewport" content="width=device-width,initial-scale=1.0"> 
```

我的 CSS 看起来像这样：

```
@media all and (max-device-width: 750px), all and (max-width: 750px) {
  body {max-width:480px;}
  #container {
    width: 90%;
    margin: 0px auto;
    padding: 0px;
    min-width:480px;
  }
  #rightnav {display:none;}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:17:36.567

如果您打算在 320 像素的屏幕上显示 480 像素的布局，您显然必须缩放，所以这完全按照指定的方式工作，但 iphone“聪明地”忽略了一些规则以全屏显示。您可以将该`initial-scale`值设置为 0.75 以强制每个设备在开始时保持该缩放级别。当然，更好的解决方案是在 320 像素设备上使用另一个媒体查询来进一步缩小屏幕内容。

# python - 实现椭圆曲线分解的生日悖论延续

> ID：13983486
> 
> 赞同：1
> 
> 时间：2012-12-21T02:25:08.473
> 
> 标签：python, primes, factorization

我想将椭圆曲线分解算法的生日悖论延续添加到我的分解程序[集合中。](http://programmingpraxis.com/contents/themes/#Prime%20Numbers)Brent 在[两篇](http://arxiv.org/pdf/1004.3366.pdf) [论文](http://pdf.aminer.org/001/011/657/factorization_of_the_tenth_fermat_number.pdf)中描述了该算法，Montgomery 也[描述](http://www.ams.org/journals/mcom/1987-48-177/S0025-5718-1987-0866113-7/)了该算法，我正在尝试根据Bosma 和 Lenstra的详细[描述来实现该算法。](http://infoscience.epfl.ch/record/164495/files/nscan12.pdf)到目前为止，这是我在 Python 中所拥有的，您可以在[ideone.com/vMXSab](http://ideone.com/vMXSab)上运行它：

```
# lenstra's algorithm per bosma/lenstra

from random import randint
from fractions import gcd

def primes(n):
    b, p, ps = [True] * (n+1), 2, []
    for p in xrange(2, n+1):
        if b[p]:
            ps.append(p)
            for i in xrange(p, n+1, p):
                b[i] = False
    return ps

def bezout(a, b):
    if b == 0: return 1, 0, a
    q, r = divmod(a, b)
    x, y, g = bezout(b, r)
    return y, x-q*y, g

def add(p, q, a, b, m):
    if p[2] == 0: return q
    if q[2] == 0: return p
    if p[0] == q[0]:
        if (p[1] + q[1]) % m == 0:
            return 0, 1, 0 # infinity
        n = (3 * p[0] * p[0] + a) % m
        d = (2 * p[1]) % m
    else:
        n = (q[1] - p[1]) % m
        d = (q[0] - p[0]) % m
    x, y, g = bezout(d, m)
    if g > 1: return 0, 0, d # failure
    z = (n*x*n*x - p[0] - q[0]) % m
    return z, (n * x * (p[0] - z) - p[1]) % m, 1

def mul(k, p, a, b, m):
    r = (0,1,0)
    while k > 0:
        if k % 2 == 1:
            r = add(p, r, a, b, m)
            if r[2] > 1: return r
        k = k // 2
        p = add(p, p, a, b, m)
        if p[2] > 1: return p
    return r

def lenstra1(n, limit):
    g = n
    while g == n:
        q = randint(0, n-1), randint(0, n-1), 1
        a = randint(0, n-1)
        b = (q[1]*q[1] - q[0]*q[0]*q[0] - a*q[0]) % n
        g = gcd(4*a*a*a + 27*b*b, n)
    if g > 1: return 0, g # lucky factor
    for p in primes(limit):
        pp = p
        while pp < limit:
            q = mul(p, q, a, b, n)
            if q[2] > 1:
                return 1, gcd(q[2], n)
            pp = p * pp
    return False

def parms(b1):
    b2 = 10 * b1
    er = [(1,31), (2,63), (3,127), (6,255), (12,511), \
          (18,511), (24,1023), (30,1023), (60,2047)]
    prev = 1,31
    for (e, r) in er:
        if e*e > b1/1250: break
        prev = e, r
    e, r = prev
    rBar = int(round(b2/r))
    u = randint(0, pow(2,30)//(e+2))
    v = randint(0, pow(2,30)//(e+2))
    uBar = randint(0, pow(2,30)//(e+2))
    vBar = randint(0, pow(2,30)//(e+2))
    return b2, e, r, rBar, u, v, uBar, vBar

def lenstra2(n, b1):
    g = n
    while g == n:
        q = randint(0, n-1), randint(0, n-1), 1
        a = randint(0, n-1)
        b = (q[1]*q[1] - q[0]*q[0]*q[0] - a*q[0]) % n
        g = gcd(4*a*a*a + 27*b*b, n)
    if g > 1: return 0, g # lucky factor
    for p in primes(b1):
        pp = p
        while pp < b1:
            q = mul(p, q, a, b, n)
            if q[2] > 1: return 1, gcd(q[2], n)
            pp = p * pp
    b2, e, r, rBar, u, v, uBar, vBar = parms(b1)
    f = [1] * (r+1)
    for i in range(1, r):
        p = mul(pow(u*i+v,e), q, a, b, n)
        if p[2] > 1: return 2, gcd(p[2], n)
        f[i] = (f[i-1] * (q[0] - p[0])) % n
    d = 1
    for j in range(1, rBar):
        pBar = mul(pow(uBar*j+vBar,e), q, a, b, n)
        if pBar[2] > 1: return 3, gcd(pBar[2], n)
        t = 0
        for i in range(0, r):
            t = (t + p[0] * f[i]) % n
        d = (d * t) % n
    g = gcd(d, n)
    if 1 < g < n: return 4, g
    return False 
```

该`primes`函数实现了一个简单版本的埃拉托色尼筛法，返回一个小于*n*的素数列表，该`bezout`函数实现了扩展的欧几里得算法，返回*a*的倒数、*b*的倒数以及它们的最大公约数。椭圆算术由`add`and`mul`函数给出；add 返回一个“点”(0, 0, *d* ) 来表示一个不可逆的分母，`mul`传播它，并且`mul`在因式分解函数中的使用必须在每次`mul`调用时检查它。函数`lenstra1`是椭圆曲线分解的简单单阶段版本，并且可以正常工作。

函数`lenstra2`及其辅助函数`parms`是我尝试实现上面引用的 Bosma/Lenstra[论文中给出的算法。](http://infoscience.epfl.ch/record/164495/files/nscan12.pdf)我首先尝试使基本版本正常工作，如第 6.1 节所述，而不考虑第 6.4 节和第 6.7 节中的优化。我认为里面的计算`parms`是正确的。函数运行，但总是返回`False`，表示它没有找到一个因子，或者它在完成算法并从最终`gcd`计算返回之前在椭圆算术中提前中断后返回。我认为问题在于*f*的系数的计算，以及使用*f*来计算*d*。

所以我的问题：

1.  我是否正确计算了*f*的系数？
2.  我是否正确计算了*d*的值？
3.  如何实现 6.4 和 6.7 节的优化？我不明白他们中的任何一个。
4.  如何使用 Weierstrass 坐标实现第 5.1 节的 Suyama 曲线？

非常感谢。

# prolog - 介意帮助 Prolog 编程吗？

> ID：13983488
> 
> 赞同：-5
> 
> 时间：2012-12-21T02:25:23.067
> 
> 标签：prolog

好的。这是我第二次发布这个问题，最后一次我的问题被少数管理员关闭，因为他们说“我没有做足够的努力来解决它”所以现在我解决了大约 70% 的问题。我希望这次有人能给我一个完成我的代码的答案。

这个问题是作为（Prolog 语言编程）的作业交给我的。

1.  工作分配。N 项工作将使用 N 台不同的机器完成。下表给出了使用机器 i 完成工作 j 的成本。

    ```
     1  2  3  4
                  ____________
                1| 6  5  3  6
                2| 5  6  8  12
                3| 8  6  8  9
                4| 3  6  5  8 
    ```

\\ 上面的 ( 1 2 3 4 ) 属于 (Jobs) 类别

\\左侧（1 2 3 4）属于（机器）类

编写一个声明式 Prolog 程序来确定应将哪些作业分配给哪些机器，以最小化总成本。

我做的第一步是从(Jobs) 的第一条垂直线中选择最低值的数字，然后在同一行中的所有其余数字上减去它 (3-8)、(3-6)、(3-5 ) ... 其余的垂直线以此类推。

这是我的代码（它还没有完成，所以基本上我正在寻找能够在下周一上午 12 月 23 日之前完成它的人）。

```
 >> initial:- M1=[6,5,3,6],
          M2=[5,6,8,12],
          M3=[8,6,8,9],
          M4=[3,6,5,8],

          write('M1= ['),
          printlist(M1),
      write('M2= ['),
          printlist(M2),
      write('M3= ['),
          printlist(M3),
      write('M4= ['),
          printlist(M4),nl,nl,

      redrow(M1,L1),
      redrow(M2,L2),
      redrow(M3,L3),
      redrow(M4,L4),

      write('L1= ['),
          printlist(L1),
      write('L2= ['),
          printlist(L2),
      write('L3= ['),
          printlist(L3),
      write('L4= ['),
          printlist(L4),nl,nl,

      /*Lc1=[],
      Lc2=[],
      Lc3=[],
      Lc4=[],*/

      col1(L1,L2,L3,L4,Lc1),
      col2(L1,L2,L3,L4,Lc2),
      col3(L1,L2,L3,L4,Lc3),
      col4(L1,L2,L3,L4,Lc4),          

      write('Lc1= ['),
          printlist(Lc1),
      write('Lc2= ['),
          printlist(Lc2),
      write('Lc3= ['),
          printlist(Lc3),
      write('Lc4= ['),
          printlist(Lc4),nl,nl,

      redrow(Lc1,Lx1),
      redrow(Lc2,Lx2),
      redrow(Lc3,Lx3),
      redrow(Lc4,Lx4),

      write('Lx1= ['),
          printlist(Lx1),
      write('Lx2= ['),
          printlist(Lx2),
      write('Lx3= ['),
          printlist(Lx3),
      write('Lx4= ['),
          printlist(Lx4),nl,nl,

      col1(Lx1,Lx2,Lx3,Lx4,Ly1),
      col2(Lx1,Lx2,Lx3,Lx4,Ly2),
      col3(Lx1,Lx2,Lx3,Lx4,Ly3),
      col4(Lx1,Lx2,Lx3,Lx4,Ly4),

      write('Ly1= ['),
          printlist(Ly1),
      write('Ly2= ['),
          printlist(Ly2),
      write('Ly3= ['),
          printlist(Ly3),
      write('Ly4= ['),
          printlist(Ly4),nl,nl.

redrow(M1,L1):- minimo(M1,Min), redcopy(M1,L1,Min).

minimo([X], X) :- !.
minimo([X,Y|Tail], N):-
    ( X > Y ->
        minimo([Y|Tail], N)
    ;
        minimo([X|Tail], N)
    ).

min1(X,Y,X):- X<Y, write('in min1 X= '), write(X), nl.
min1(X,Y,Y):- X>Y,write('in min1 Y= '), write(Y), nl.
min1(X,Y,Y).

redcopy(L,R,V) :- accCp(L,R,V).
accCp([],[],_).
accCp([H|T1],[M|T2],V) :- M is H-V, accCp(T1,T2,V).

col1([H1|T1],[H2|T2],[H3|T3],[H4|T4],[H1,H2,H3,H4]).
col2([H11,H12|T1],[H21,H22|T2],[H31,H32|T3],[H41,H42|T4],[H12,H22,H32,H42]).
col3([H11,H12,H13|T1],[H21,H22,H23|T2],[H31,H32,H33|T3],[H41,H42,H43|T4],[H13,H23,H33,H43]).
col4([H11,H12,H13,H14|T1],[H21,H22,H23,H24|T2],[H31,H32,H33,H34|T3],[H41,H42,H43,H44|T4],[H14,H24,H34,H44]).

/*redcopy([],[],_).
redcopy(Ls,Ld,R):- Ls=[X|Lst],Ld=[X-R|Ld], redcopy(Lst,Ld,R).*/

printlist([]):- write(']'),nl.
printlist(L):- L=[X|Lt], write(X), write(' , '), printlist(Lt). 
```

* * *

最后我需要知道什么问题要问计算机给我一个输出（是，否）。先感谢您 。

注意：如果我的代码或问题不清楚（请我向您解释）不要关闭我的问题，因为可能有人已经得到了答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T08:59:48.213

这可能不是您需要的答案，因为不会尝试满足假设缺失的 30%。真的，如果你能解释一下如此大胆的声明

> 我解决了大约70％..

可以评估，我们都可以从你的作业中学到一些东西。但是，唉，您的代码似乎与任何“声明式”解决方案相去甚远。你*在哪里**声明*如何解决问题？

让我们从高级描述开始：

> 确定应将哪些作业分配给哪些机器以最小化总成本

然后可以勾勒出一个*可重用的解决方案：*

```
assign_jobs_min_cost :-
    MJC =  % machines,jobs,cost
    [[6, 5, 3, 6 ],
     [5, 6, 8, 12],
     [8, 6, 8, 9 ],
     [3, 6, 5, 8 ]],
    assign_jobs_min_cost(MJC, Jobs, Cost),
    writeln(Jobs:Cost). 
```

*作业分配*可以简单地视为索引的排列（感谢问题数据的友好呈现），然后

```
assign_jobs_min_cost(MJC, Jobs, Cost) :-
    aggregate_all(min(C, P),
              (permutation([1, 2, 3, 4], P),
               cost_assign(MJC, P, C)),
              min(Cost, Jobs)). 
```

您会看到，Prolog 与任何其他语言一样，都带有一个*库*，它定义了解决问题的*惯用方法。*学习如何使用库通常是语言学徒中*最*重要的部分。

这里我使用 SWI-Prolog 库（[聚合](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.1%27,swi%28%27/doc/Manual/aggregate.html%27%29%29)），以及[排列](http://www.swi-prolog.org/pldoc/doc_for?object=permutation/2)/2。根据*您的*Prolog（和您的考官要求），您可以尝试用您自己的定义替换此类调用。

现在我们只剩`cost_assign(MJC, Jobs, Cost)`下计算了。再次使用库结构，它是一个“单一语句”：

```
cost_assign(MJC, Jobs, Cost) :-
    aggregate_all(
        sum(C),
        (between(1, 4, Mac),
         nth1(Mac, MJC, RowC),
         nth1(Mac, Jobs, J),
         nth1(J, RowC, C)
        ), Cost)
    % uncomment  below to see all assignments
    %,writeln(Jobs:Cost).
    . 
```

但你会学到更多自己写的东西......

# regex - 正则表达式：要求在此表达式前面加上“http://”

> ID：13983489
> 
> 赞同：0
> 
> 时间：2012-12-21T02:25:33.340
> 
> 标签：regex

我正在使用正则表达式来尝试验证 URL。我拥有的正则表达式运行良好，但唯一的问题是即使`http://`前面没有，它也会验证 URL。我希望它只验证 URL 是否`http://`在前面（即使它后面不包含 www）

这是我正在使用的正则表达式：

```
((https?)\:\/\/)?([a-z0-9+!*(),;?&=\$_.-]+(\:[a-z0-9+!*(),;?&=\$_.-]+)?@)?([a-z0-9-.]*)\.([a-z]{2,3})(\:[0-9]{2,5})?(\/([a-z0-9+\$_-]\.?)+)*\/?(\?[a-z+&\$_.-][a-z0-9;:@&%=+\/\$_.-]*)?(#[a-z_.-][a-z0-9+\$_.-]*)? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T02:27:26.247

`?`从左边删除第二个。它充当使整个`http`部分可选的量词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:27:58.850

只做（s）可选工作吗？

```
(http(s)?\:\/\/)?([a-z0-9+!*(),;?&=\$_.-]+(\:[a-z0-9+!*(),;?&=\$_.-]+)?@)?([a-z0-9-.]*)\.([a-z]{2,3})(\:[0-9]{2,5})?(\/([a-z0-9+\$_-]\.?)+)*\/?(\?[a-z+&\$_.-][a-z0-9;:@&%=+\/\$_.-]*)?(#[a-z_.-][a-z0-9+\$_.-]*)? 
```

看到新答案后，这将需要 http 或 https：

```
(http(s)?\:\/\/)([a-z0-9+!*(),;?&=\$_.-]+(\:[a-z0-9+!*(),;?&=\$_.-]+)?@)?([a-z0-9-.]*)\.([a-z]{2,3})(\:[0-9]{2,5})?(\/([a-z0-9+\$_-]\.?)+)*\/?(\?[a-z+&\$_.-][a-z0-9;:@&%=+\/\$_.-]*)?(#[a-z_.-][a-z0-9+\$_.-]*)? 
```

# firefox-os - Firefox OS 会支持 C 库吗？

> ID：13983492
> 
> 赞同：1
> 
> 时间：2012-12-21T02:25:52.077
> 
> 标签：firefox-os

我正在开发一个使用 C 作为基础的跨移动平台框架。然后我将为每个特定平台（如 ios、android、bb）制作一些包装器。我的目标平台之一是 firefox-os。我想知道是否可以在 firefox-os 中使用 c 库，但我找不到任何相关信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T17:07:58.253

如果您查看以下 Firefox OS 架构文档，它应该会回答您的问题： [https ://wiki.mozilla.org/B2G/Architecture](https://wiki.mozilla.org/B2G/Architecture)

例如，在 Gaia 下，它说：“它与底层操作系统的唯一接口是通过 Gecko 实现的 Open Web API。” 这意味着 Javascript 是您对较低级别调用所必须的唯一接口，前提是它们可通过 Open Web API 获得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T13:59:43.407

[一种解决方法是使用emscripten](https://github.com/kripken/emscripten)将 C 代码编译为 JavaScript 。Firefox 将在不久的将来实现[asmjs](http://asmjs.org/)，因此编译后的代码可能会非常高效（因为 emscripten 将以 asmjs 作为输出）。

# java - 多线程，读取多个文件并写入新文件

> ID：13983495
> 
> 赞同：-1
> 
> 时间：2012-12-21T02:26:07.507
> 
> 标签：java, multithreading, file

```
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.MappedByteBuffer;
import java.nio.channels.FileChannel;
import java.nio.charset.Charset;
import java.util.ArrayList;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Test6 implements Runnable {

    private File file;
    private int totalNumberOfFiles = 0;
    private static int nextFile = -1;
    private static ArrayList<String> allFilesArrayList = new ArrayList<String>();
    private static ExecutorService executorService = null;

    public Test6(File file) {
        this.file = file;
    }

    private String readFileToString(String fileAddress) {
        FileInputStream stream = null;
        MappedByteBuffer bb = null;
        String stringFromFile = "";
        try {
            stream = new FileInputStream(new File(fileAddress));
            FileChannel fc = stream.getChannel();
            bb = fc.map(FileChannel.MapMode.READ_ONLY, 0, fc.size());
            /* Instead of using default, pass in a decoder. */
            stringFromFile = Charset.defaultCharset().decode(bb).toString();
        } catch (IOException e) {
            System.out.println("readFileToString IOException");
            e.printStackTrace();
        } finally {
            try {
                stream.close();
            } catch (IOException e) {
                System.out.println("readFileToString IOException");
                e.printStackTrace();
            }
        }
        return stringFromFile;
    }

    private void toFile(String message, String fileName) {
        try {
            FileWriter fstream = new FileWriter("C:/Users/Nomi/Desktop/Workspace2/Test6/TestWritten/" + fileName);
            System.out.println("printing to file: ".concat(fileName));
            BufferedWriter out = new BufferedWriter(fstream);
            out.write(message);
            out.close();
        } catch (Exception e) {
            System.out.println("toFile() Exception");
            System.err.println("Error: " + e.getMessage());
        }
    }

//  private void listFilesForFolder(final File fileOrFolder) {
//      String temp = "";
//      if (fileOrFolder.isDirectory()) {
//          for (final File fileEntry : fileOrFolder.listFiles()) {
//              if (fileEntry.isFile()) {
//                  temp = fileEntry.getName();
//                  toFile(readFileToString(temp), "Copy".concat(temp));
//              }
//          }
//      }
//      if (fileOrFolder.isFile()) {
//          temp = fileOrFolder.getName();
//          toFile(readFileToString(temp), "Copy".concat(temp));
//      }
//  }

    public void getAllFilesInArrayList(final File fileOrFolder) {
        String temp = "";
        System.out.println("getAllFilesInArrayList fileOrFolder.getAbsolutePath()" + fileOrFolder.getAbsolutePath());
        if (fileOrFolder.isDirectory()) {
            for (final File fileEntry : fileOrFolder.listFiles()) {
                if (fileEntry.isFile()) {
                    temp = fileEntry.getAbsolutePath();
                    allFilesArrayList.add(temp);
                }
            }
        }
        if (fileOrFolder.isFile()) {
            temp = fileOrFolder.getAbsolutePath();
            allFilesArrayList.add(temp);
        }
        totalNumberOfFiles = allFilesArrayList.size();
        for (int i = 0; i < allFilesArrayList.size(); i++) {
            System.out.println("getAllFilesInArrayList path: " + allFilesArrayList.get(i));
        }
    }

    public synchronized String getNextFile() {
        nextFile++;
        if (nextFile < allFilesArrayList.size()) {
//          File tempFile = new File(allFilesArrayList.get(nextFile));
            return allFilesArrayList.get(nextFile);
        } else {
            return null;
        }
    }

    @Override
    public void run() {
        getAllFilesInArrayList(file);
        executorService = Executors.newFixedThreadPool(allFilesArrayList.size());
        while(nextFile < totalNumberOfFiles)
        {
            String tempGetFile = getNextFile();
            File tempFile = new File(allFilesArrayList.get(nextFile));
            toFile(readFileToString(tempFile.getAbsolutePath()), "Copy".concat(tempFile.getName()));
        }
    }

    public static void main(String[] args) {
        Test6 test6 = new Test6(new File("C:/Users/Nomi/Desktop/Workspace2/Test6/Test Files/"));
        Thread thread = new Thread(test6);
        thread.start();
//      executorService.execute(test6);
//      test6.listFilesForFolder(new File("C:/Users/Nomi/Desktop/Workspace2/Test6/"));
    }
} 
```

程序按预期进行。它进入文件夹，抓取一个文件，将其读入一个字符串，然后将内容写入一个新文件。我想做这个多线程。如果文件夹有 N 个文件，我需要 N 个线程。如果可能的话，我也想使用执行器框架。我认为可以沿着这条线有一种方法：

```
public synchronized void getAllFilesInArrayList() {
        return nextFile;
    } 
```

所以每个新线程都可以选择下一个文件。感谢您的帮助。

错误：

```
Exception in thread "Thread-0" java.lang.IllegalArgumentException
    at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:589)
    at java.util.concurrent.ThreadPoolExecutor.<init>(ThreadPoolExecutor.java:480)
    at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:59)
    at Test6.run(Test6.java:112)
    at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:50:45.377

首先，您解决问题的方法将导致更多的同步和竞争条件担忧，而不是看起来必要的。一个简单的策略来防止你的线程竞争是这样的：

1) 让调度程序线程读取目录中的所有文件名。

2) For each file, have the dispatcher thread spawn a worker thread and hand off the file reference

3) Have the worker thread process the file

4) Make sure you have some sane naming convention for your output file names so that you don't get threads overwriting each other.

As for using an executor, a ThreadPoolExecutor would probably work well. Go take a look at the javadoc: [http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ThreadPoolExecutor.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ThreadPoolExecutor.html)

# c# - Windows 应用商店应用保存状态信息

> ID：13983496
> 
> 赞同：0
> 
> 时间：2012-12-21T02:26:19.290
> 
> 标签：c#, windows-8, windows-store-apps, application-state

我刚刚开始使用 Windows 8 开发（使用 c#），并且正在将我的一个应用程序移植到 Windows 商店应用程序。本质上，我的应用程序接受用户输入字符串，计算适当的输出并响应用户。所以我使用列表视图来跟踪“对话”。我将用户的输入显示为列表视图元素，然后将输出显示为下一个元素（使用具有颜色等格式的文本块......）。

我想做的是在应用程序终止后使这种“对话”持续存在，但不确定最好的方法。我的第一个想法是在挂起时序列化列表视图对象，然后在加载时对其进行反序列化，但列表视图不可序列化......所以我的下一个想法是将每个输入和输出字符串写入文件并尝试重建列表视图当我加载应用程序时从这些字符串中提取，但我也遇到了一些问题。

所以我很好奇解决这个问题的最佳方法是什么。我希望应用程序开始备份之前已经以相同格式显示的对话，而不是什么。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T03:38:30.453

反正我不会持久化 ListView，你只需要持久化其中的数据。您是否使用 MVVM 类型模型，您的对话可能被捕获为[ObservableCollection](http://msdn.microsoft.com/en-us/library/vstudio/ms668604%28v=vs.110%29.aspx)，然后绑定到 ListView？如果没有，你应该:)

然后您只需要序列化 ​​ObservableCollection（请参阅[此处的一个选项](https://stackoverflow.com/questions/13923600/how-to-save-observablecollection-in-windows-store-app/13934288#13934288)）。你坚持它的地方取决于你：

*   [LocalFolder](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.applicationdata.localfolder.aspx)将使用基于文件的方法并在本地设备上可用
*   [RoamingFolder](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.applicationdata.roamingfolder.aspx)也将使用基于文件的方法，但使用云在用户拥有的多个设备上同步（并安装了应用程序）
*   云存储（如[Windows Azure](http://www.windowsazure.com/en-us/)或[Windows Azure 移动服务](http://www.windowsazure.com/en-us/develop/mobile/)）将为您提供本质上无限的存储，但需要管理云帐户并为其付费（尽管免费层级可能就足够了）
*   像[SQLite](http://timheuer.com/blog/archive/2012/08/07/updated-how-to-using-sqlite-from-windows-store-apps.aspx)这样的内存数据库是另一种选择，如果你感兴趣的话，它会给你关系语义。

首先，我会说使用[LocalFolder](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.applicationdata.localfolder.aspx)并将您的集合保存到一个文件中，然后当您重新水化它时，简单的数据绑定应该会自动处理显示。在某些时候，您可能需要决定存储多少。您希望您的应用程序能够响应用户（“快速而流畅”），因此您可能需要在请求时引入数据，而不是一次全部引入（也许是版本 2 的功能！）

# python - 在 pandas 中直观地分离条形图集群

> ID：13983498
> 
> 赞同：3
> 
> 时间：2012-12-21T02:26:29.427
> 
> 标签：python, matplotlib, plot, pandas

这更像是一种几乎有效的黑客攻击。

```
#!/usr/bin/env python

from pandas import *
import matplotlib.pyplot as plt
from numpy import zeros

# Create original dataframe
df = DataFrame(np.random.rand(5,4), index=['art','mcf','mesa','perl','gcc'],
                        columns=['pol1','pol2','pol3','pol4'])
# Estimate average
average = df.mean()
average.name = 'average'

# Append dummy row with zeros and then average
row = DataFrame([dict({p:0.0 for p in df.columns}), ])

df = df.append(row)
df = df.append(average)

print df

df.plot(kind='bar')
plt.show() 
```

并给出：

```
 pol1      pol2      pol3      pol4
art      0.247309  0.139797  0.673009  0.265708
mcf      0.951582  0.319486  0.447658  0.259821
mesa     0.888686  0.177007  0.845190  0.946728
perl     0.902977  0.863369  0.194451  0.698102
gcc      0.836407  0.700306  0.739659  0.265613
0        0.000000  0.000000  0.000000  0.000000
average  0.765392  0.439993  0.579993  0.487194 
```

和![在此处输入图像描述](../Images/017ce049a474b7f4fd40ac4d31d63c2d.png)

它提供了基准和平均值之间的视觉分离。有没有办法摆脱x轴上的0？

* * *

事实证明，DataFrame 不允许我以这种方式拥有多个虚拟行。我的解决方案是改变

```
row = pd.DataFrame([dict({p:0.0 for p in df.columns}), ]) 
```

进入

```
row = pd.Series([dict({p:0.0 for p in df.columns}), ]) 
row.name = "" 
```

系列可以用空字符串命名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T02:34:32.160

仍然很hacky，但它有效：

```
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

# Create original dataframe
df = pd.DataFrame(np.random.rand(5,4), index=['art','mcf','mesa','perl','gcc'],
                        columns=['pol1','pol2','pol3','pol4'])
# Estimate average
average = df.mean()
average.name = 'average'

# Append dummy row with zeros and then average
row = pd.DataFrame([dict({p:0.0 for p in df.columns}), ])

df = df.append(row)
df = df.reindex(np.where(df.index, df.index, ''))
df = df.append(average)
print df

df.plot(kind='bar')
plt.show() 
```

![在此处输入图像描述](../Images/903eea00f9559a227666f8f0f77844a2.png)

# android - 如果 ConvertView 属性不为空，我是否需要配置它？

> ID：13983509
> 
> 赞同：0
> 
> 时间：2012-12-21T02:28:07.057
> 
> 标签：android, android-adapter

在自定义`adapter`中，如何知道我是否需要重新配置`convertView`？

```
public View getView(int position, View convertView, ViewGroup parent) {
    ImageView imageView;
    if (convertView == null) {
        imageView = (ImageView) mInflater.inflate(R.layout.avatar, parent, false);

        // Should this 2 lines of code be here ?
        User user = mUserList.getUserAt(position);
        user.setAvatar(imageView);
    } else {
        imageView = (ImageView) convertView;
    }

    // or here ?
    User user = mUserList.getUserAt(position);
    user.setAvatar(imageView);

    return imageView;
} 
```

我认为如果它被回收，我不需要重置用户的头像，但我经常看到配置发生在`if`块之外。这是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T04:48:54.977

我总是在`if`块之外配置视图。您在 getView 方法中获得的这个 convertView 可能（并且很可能会）通过之前对 getView 的调用为另一个用户设置，因为 ListView 的策略是在项目视图离开屏幕时重用它们。如果您没有设置正确的头像，您将为此项目设置错误的头像。当然，您不需要重置与背景等具体位置无关的属性。

例如， [CursorAdapter](http://developer.android.com/reference/android/widget/CursorAdapter.html) [将 getView](http://androidxref.com/4.2_r1/xref/frameworks/base/core/java/android/widget/CursorAdapter.java#237)分成两部分：newView，它执行膨胀和（主要）与位置无关的设置，以及分配实际位置相关数据的 bindView。

您也可能会获得与之前用于此职位的完全相同的视图。当然你可以避免在这种情况下重置视图，但是你需要检查这个视图中的数据是否有效。我认为设置然后检查 View 的[标签](http://developer.android.com/reference/android/view/View.html#setTag%28java.lang.Object%29)是一个最明显的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T07:05:01.140

它并不是真正的回收，它只是意味着您需要根据其新位置用新数据填充“回收”视图。如果您不这样做，则该行将填充旧数据，因为您滚动了它的位置，因此这些数据不应再出现在屏幕上。

因此，简而言之，每次调用 getView() 时（`if`代码块之外），您都必须使用新数据重新配置视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T07:08:00.973

您的问题仅在于对 listview 的理解。

所以在这里我会让你清楚**它是如何工作的？**

假设列表视图必须包含**20 个项目**，但您当前的屏幕只能容纳（在屏幕上显示）**8 个项目**（列表项目，在您的情况下为 imageview）。

当列表视图尝试为其获取项目时，`1----8th`它将返回您`convertView`，`null`因为尚未发生**对象回收**。

但是，当您尝试滚动时，在我们的例子中（**向上滚动！**）。

```
the 1st element of the list will be recycled when go out of screen, and will be supplied as convertView for 9th item. 
```

这样，listview 只需管理第 8 个（在我们的例子中）即可显示任意数量的项目。

如果我们向下滚动病房，则会发生相反的情况。

**因此，在转换视图（null 或 not）的基础上，您必须设计您的逻辑来创建和填充或填充。**

希望这会帮助你。

# javascript - 如何在几个 ajax 步骤中逐步更新 html，尤其是在文件上传期间

> ID：13983511
> 
> 赞同：1
> 
> 时间：2012-12-21T02:28:55.603
> 
> 标签：javascript, jquery, ajax, file-upload, task-queue

# 长话短说

得到执行 5 个 ajax 步骤的 javascript 代码。

第二步和第三步涉及文件上传。有进度条。

不确定如何在 5 个步骤中逐步更新进度条。

# 很长的故事

该演示位于[http://ajaxprogressbar.cloudcontrolled.com/ajaxprogress.html](http://ajaxprogressbar.cloudcontrolled.com/ajaxprogress.html)

要执行它，请按“运行进度条”按钮

代码在[github上可用](https://github.com/simkimsia/ajaxprogressbars/blob/7e6e9c6be7497e7c865b2ffd0f7c4fe67723d434/ajaxprogress.html)

基本上，ajax 过程有 5 个步骤。

step1、4、5分别向step1.php、step4.php、step5.php发送数据。

step2 和 step3 是 ajax 文件上传步骤。

顺序应该是：

*   只有在第 1 步完成后，才能同时执行第 2 步和第 3 步。
*   步骤 4 只能在步骤 2 之后执行。
*   步骤 5 只能在前面的所有步骤都成功后执行。
*   如果在任何步骤中出现任何错误，则应停止该过程。

# 我想要完成的

1.  只有在第 1 步完成后，才能同时执行第 2 步和第 3 步。**（完毕）**
2.  步骤 4 只能在步骤 2 之后执行。**（完成）**
3.  步骤 5 只能在前面的所有步骤都成功后执行。
4.  如果在任何步骤中出现任何错误，则应停止该过程。
5.  每一步后更新进度条 20% **（完成）**
6.  [在第 2 步和第 3 步期间，](https://stackoverflow.com/questions/14002393/track-ajax-post-progress-for-fileupload-using-jquery-ajax-and-formdata)一次更新进度条 1%。**（完成）**见此
7.  重构executeProcess以使用Q.js而不是jquery

请注意，那些标记**（完成）**已完成。请在[此处](http://ajaxprogressbar.cloudcontrolled.com/ajaxprogress.html)查看演示。

# 我尝试并得到的结果

*   我之前为 R6 提出过上诉，我终于[在这里找到了](https://stackoverflow.com/questions/14002393/track-ajax-post-progress-for-fileupload-using-jquery-ajax-and-formdata)

# 我需要的

我想在不破坏其他任何东西的情况下完成 R3、R4、 ~~R6和 R7。~~

~~**R6 是最重要的。**~~

**R3 现在是最重要的。**

# 常见问题

1.  这是您的完整应用程序吗？

*不。我做了一个简化的测试用例，我去掉了尽可能多的不必要的代码来解释我的问题，而不会影响问题陈述。*

*因此，似乎缺少一些逻辑。但请放心作为演示，没有错误。我已经测试过了。*

*`sleep(5)`我还通过输入fileupload.php来模拟文件上传的时间延迟*

# 如果我在这里或其他地方找到解决方案我会怎么做

我会将解决方案作为演示工作并将其放到网上。

这也是为了帮助其他人从我的问题中学习。

# java - 充气机和循环无法正常工作

> ID：13983512
> 
> 赞同：4
> 
> 时间：2012-12-21T02:29:10.523
> 
> 标签：java, android, eclipse, loops

我目前正在为 android 上的应用程序执行自定义视图时遇到问题，我知道有很多与充气机相关的问题，但我无法解决这个问题。

充气机我工作得很好，但它应该循环 3 次，并且只循环 1 次，所以我只能看到最终布局的一个视图。

代码的相关部分是这个

```
 void populate(String strcline, String url){
lLfD = (LinearLayout)findViewById(R.id.lLfD);

    try{

    JSONArray a1 = new JSONArray(strcline);

    for(int i = 0; i < a1.length(); i++){

        JSONArray a2 =  a1.getJSONArray(i);

        final String fUserId = a2.getString(0);
        String userName = a2.getString(1);
        String userPicture = url + a2.getString(2);

        View child = getLayoutInflater().inflate(R.layout.cellevery, lLfD);
        ImageView avatar = (ImageView)findViewById(R.id.cellAvatar);
        downloadFile(userPicture, avatar);
        TextView cellName = (TextView)findViewById(R.id.cellName);
        cellName.setText(userName);

        lLfD.addView(child);

    }
    }catch(Exception e){

    }
    pDialog.dismiss(); 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T02:31:46.427

您看起来只需要在膨胀视图上运行 findViewById ，否则它只会找到第一个，这只是循环中的第一个：

```
 View child = getLayoutInflater().inflate(R.layout.cellevery, lLfD);
    ImageView avatar = (ImageView)child.findViewById(R.id.cellAvatar);
    downloadFile(userPicture, avatar);
    TextView cellName = (TextView)child.findViewById(R.id.cellName);
    cellName.setText(userName); 
```

这是循环中 findViewById 的解释：

```
Loop 1:
1LfD->child1->R.id.cellAvatar (findViewById(R.id.cellAvatar) finds this one)

Loop 2:

1Lfd->
   child1->R.id.cellAvatar
   child2->R.id.cellAvatar (findViewById(R.id.cellAvatar) finds the child1.cellAvatar again)

Loop 3:
1LfD->
   child1->R.id.cellAvatar 
   child2->R.id.cellAvatar 
   child3->R.id.cellAvatar (findViewById(R.id.cellAvatar) finds the child1.cellAvatar again) 
```

通过使用`child.findViewById(R.id.cellAvatar)`，它可以确保您为循环的每次运行找到正确的 R.id.cellAvatar。

那有意义吗？

**更新 2：**

你打电话时：

```
getLayoutInflater().inflate(R.layout.cellevery, lLfD); 
```

您已经将父视图设置为第二个参数，因此您无需调用：

```
lLfD.addView(child); 
```

# iphone - 如果定义了 didFinishPickingMediaWithInfo，相机会冻结

> ID：13983514
> 
> 赞同：5
> 
> 时间：2012-12-21T02:29:26.383
> 
> 标签：iphone, objective-c, ios, camera

我正在尝试使用 iPhone 进行基本的拍照。我使用以下代码显示相机：

```
 - (BOOL) startCameraControllerFromViewController: (UIViewController*) controller
                                       usingDelegate: (id <UIImagePickerControllerDelegate,
                                                       UINavigationControllerDelegate>) delegate {

        if (([UIImagePickerController isSourceTypeAvailable:
              UIImagePickerControllerSourceTypeCamera] == NO)
            || (delegate == nil)
            || (controller == nil))
            return NO;

        UIImagePickerController *cameraUI = [[UIImagePickerController alloc] init];
        cameraUI.sourceType = UIImagePickerControllerSourceTypeCamera;

        // Displays a control that allows the user to choose picture or
        // movie capture, if both are available:
        cameraUI.mediaTypes =
        [UIImagePickerController availableMediaTypesForSourceType:
         UIImagePickerControllerSourceTypeCamera];

        // Hides the controls for moving & scaling pictures, or for
        // trimming movies. To instead show the controls, use YES.
        cameraUI.allowsEditing = NO;

        cameraUI.delegate = delegate;

    [controller presentModalViewController: cameraUI animated: YES];
    return YES;
} 
```

这很好用，但是如果我定义处理函数：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{

} 
```

imagePicker 控件在按下 Use 按钮​​后冻结。它不会崩溃，不会抛出任何异常，代码正在做某事，但在屏幕上我只看到冻结的 imagePicker 控件。即使处理程序为空，控件也会冻结。如果我移除处理程序，相机会正常消失并显示相机被激活的位置......我在这里错过了什么重要的东西吗？

*更新：* 我尝试将图像分配给 UIImageView，代码执行，退出函数，就是这样，相机仍然在屏幕上：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    [[picker parentViewController] dismissModalViewControllerAnimated:YES];
    UIImage* original =[info objectForKey:@"UIImagePickerControllerOriginalImage"];
    [[self imgWLItemImage] setImage:[UIImage imageWithCGImage:original.CGImage scale:0.25 orientation:original.imageOrientation]];
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-21T02:43:58.330

试试这个并检查：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
   [picker dismissModalViewControllerAnimated:YES];
    UIImage* original =[info objectForKey:@"UIImagePickerControllerOriginalImage"];
    [[self imgWLItemImage] setImage:[UIImage imageWithCGImage:original.CGImage scale:0.25 orientation:original.imageOrientation]];
} 
```

# java - 在struts2的url中添加参数不显示

> ID：13983516
> 
> 赞同：1
> 
> 时间：2012-12-21T02:29:55.183
> 
> 标签：java, ajax, url, struts2, get

我在尝试访问的页面的 url 中添加了一个参数，但在生成的 url 中没有显示，这是为什么呢？

这是我的jsp。

```
<%@ taglib prefix="s" uri="/struts-tags"%>
<%@ taglib prefix="sj" uri="/struts-jquery-tags"%>
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
<sj:head ajaxhistory = "true" ajaxcache="true" />
<script>

</script>
</head>
<body>
    <h5>Struts Jquery Ajax Integration</h5>

    <div id="resultContent"></div>

    <noscript>Please Turn On Javascript to make the full use of this site</noscript>

    <h4>Choose A task</h4>
    <ul>
        <s:url value="views/ajaxvalidation.jsp" var="ajaxvalidation" >
            <s:param name="menuId" value="1"/>
        </s:url>
        <li><sj:a targets="resultContent" href="%{ajaxvalidation}">Ajax Validation</sj:a></li>
    </ul>

    <div>
        <h6>Play A Music while You Navigate</h6>
        <audio src="x.mp3" controls>Your browser does not support the
            audio element.
        </audio>
    </div>
</body>
</html> 
```

正在显示的 URL 是这个

```
http://localhost:8090/HelloStruts2/#resultContent=_sj_action_anchor_860825673resultContent 
```

`menuId`我在url中添加的参数在哪里？

我不知道这是否会有所作为，但我正在为 jquery 使用这个插件。

[struts2-jquery](http://code.google.com/p/struts2-jquery/)

生成的 HTML

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>

    <script type="text/javascript" src="/HelloStruts2/struts/js/base/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="/HelloStruts2/struts/js/base/jquery.ui.core.min.js?s2j=3.5.0"></script>
  <script type="text/javascript" src="/HelloStruts2/struts/js/plugins/jquery.subscribe.min.js"></script>
  <script type="text/javascript" src="/HelloStruts2/struts/js/plugins/jquery.ba-bbq.min.js"></script>

  <script type="text/javascript" src="/HelloStruts2/struts/js/struts2/jquery.struts2.min.js?s2j=3.5.0"></script>

<script type="text/javascript">
$(function() {
    jQuery.struts2_jquery.version="3.5.0";
    jQuery.scriptPath = "/HelloStruts2/struts/";
    jQuery.struts2_jquery.ajaxhistory = true;
    jQuery.ajaxSettings.traditional = true;

    jQuery.ajaxSetup ({
        cache: false
    });

    jQuery.struts2_jquery.require("js/struts2/jquery.ui.struts2.min.js");

    jQuery(window).trigger('hashchange');
});
</script>

        <link id="jquery_theme_link" rel="stylesheet" href="/HelloStruts2/struts/themes/smoothness/jquery-ui.css?s2j=3.5.0" type="text/css"/>

<script>

</script>
</head>
<body>
    <h5>Struts Jquery Ajax Integration By Kyel</h5>

    <div id="resultContent"></div>

    <noscript>Please Turn On Javascript to make the full use of this site</noscript>

    <h4>Choose A task</h4>
    <ul>

        <li><a id="anchor_2068827505" href="javascript:void(0)">Ajax Validation</a>
<script type='text/javascript'>
jQuery(document).ready(function () { 
    var options_anchor_2068827505 = {};
    options_anchor_2068827505.jqueryaction = "anchor";
    options_anchor_2068827505.id = "anchor_2068827505";
    options_anchor_2068827505.targets = "resultContent";
    options_anchor_2068827505.href = "views/ajaxvalidation.jsp";
    options_anchor_2068827505.hrefparameter = "menuId=1";

jQuery.struts2_jquery.bind(jQuery('#anchor_2068827505'),options_anchor_2068827505);

 });  
</script></li>

        <li><a id="anchor_1381525763" href="javascript:void(0)">Thank you JSP</a>
<script type='text/javascript'>
jQuery(document).ready(function () { 
    var options_anchor_1381525763 = {};
    options_anchor_1381525763.jqueryaction = "anchor";
    options_anchor_1381525763.id = "anchor_1381525763";
    options_anchor_1381525763.targets = "resultContent";
    options_anchor_1381525763.href = "views/thankyou.jsp";
    options_anchor_1381525763.hrefparameter = "menuId=2";

jQuery.struts2_jquery.bind(jQuery('#anchor_1381525763'),options_anchor_1381525763);

 });  
</script></li>
    </ul>

    <div>
        <h6>Play A Music while You Navigate</h6>
        <audio src="x.mp3" controls>Your browser does not support the
            audio element.
        </audio>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T03:41:14.443

使用动作标签并使用嵌套参数标签见下面的代码。

```
<s:url id="login" action="admin/showProfile" var="profileUrl">
    <s:param name="user">Rais</s:param>
</s:url>

<a href='<s:property value="#profileUrl"/>'>
<s:property value="#profileUrl"/></a> 
```

# android - 使用 AsyncTask 下载图像

> ID：13983517
> 
> 赞同：6
> 
> 时间：2012-12-21T02:30:49.617
> 
> 标签：android, download, android-asynctask, progress-bar

我不太确定我的代码或结构出了什么问题。我想使用 AsyncTask 下载图像并同时显示进度条。但我尝试了几种不同的方法。它仍然失败，不知道有什么问题。我的结构流程是

**ContentID 是一个字符串数组，用于存储图像的内容 ID。**

**主要问题：它设法从url下载图像并存储到手机中，但下载的图像都是同一个图像。它应该是不同的图像，这不是我所期望的。**

*次要问题：应用程序下载图像时弹出进度条，但进度条没有更新它的进度。它只是保持 0% 并在下载完成后关闭。*

我想知道是什么导致了我提到的主要和次要问题。如果您知道我的代码有什么问题，请发表评论或回答。任何帮助将不胜感激。

```
if(isSyncSuccess){

     SetConstant.IMAGE_EXIST = 1;
     pDialog = new ProgressDialog(GalleryScreen.this);
     pDialog.setMessage("Downloading file. Please wait...");
     pDialog.setIndeterminate(false);
     pDialog.setProgress(0);
     pDialog.setMax(contentId.length);
     pDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
     pDialog.setCancelable(true);

     if (contentId.length>0){
     Log.i(TAG, "contentid.length:" +contentId.length);
         for (int i=0;i<contentId.length;i++){
             if(helper.databaseChecking(useremail, contentId[i])){
                 contentdownload = i;
                 SetConstant.CONTENT_ID = contentId[i]; 

                 String URL = SetConstant.URL_DOWNLOAD_CONTENT+contentId[i];

                 DownloadFile downloadFile = new DownloadFile();
                 downloadFile.execute(URL);

                 }

    private class DownloadFile extends AsyncTask<String, Integer, String>{
    @Override
    protected String doInBackground(String... sUrl){
                Bitmap bm;
                InputStream in;

        try{

            in = new java.net.URL(sUrl[0]).openStream();
            bm = BitmapFactory.decodeStream(new PatchInputStream(in));
            File storage = new File(Environment.getExternalStorageDirectory() + File.separator + "/Image/");
            Log.i(TAG,"storage:" +storage);
            Log.i(TAG,"storage:" +storage.getAbsolutePath());
            if(!storage.exists()){
                storage.mkdirs();

            }
                String FileName = "/"+SetConstant.CONTENT_ID+".jpg"; 
                FileOutputStream fos = new FileOutputStream(storage + FileName);
                bm.compress(Bitmap.CompressFormat.JPEG, 85, fos);

                String filepath = storage + FileName;
                File filecheck = new File (filepath);
                long fileSize = filecheck.length();
                fos.flush();
                fos.close();

                Log.i(TAG, "bm:" +bm);
                Log.i(TAG, "fos:" +fos);
                Log.i(TAG, "filesize:" +fileSize);
                Log.i(TAG, "filepath:" +filepath);

        }
        catch(IOException e1){
                e1.printStackTrace();
                }   

        return null;
    }

    @Override
    protected void onPreExecute(){
        super.onPreExecute();
        pDialog.show();
    }

    @Override
    protected void onProgressUpdate(Integer... progress){
        super.onProgressUpdate(progress);
        pDialog.setProgress(progress[0]);
    }

    protected void onPostExecute(String result){
        super.onPostExecute(result);
        pDialog.dismiss();
    }
} 
```

**编辑**

现在该应用程序能够根据进度条下载图像了！但是我遇到的另一个问题是当应用程序无法完成下载时如何返回错误消息。目前，当应用程序下载失败时，它会崩溃。我相信我不应该在 doInBackground 里面运行它。但是我还能在哪里进行检查？知道如何作为错误消息返回并请求用户重试而不是使应用程序崩溃吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T02:46:25.777

您`onProgressUpdate`在`doInBackGround(...)`. 请注意，运行多个实例`AsyncTask`是一个[坏主意](https://stackoverflow.com/questions/6645203/android-asynctask-avoid-multiple-instances-running)。这是我的建议：

```
if(isSyncSuccess){
    SetConstant.IMAGE_EXIST=1;
    pDialog=new ProgressDialog(GalleryScreen.this);
    pDialog.setMessage("Downloading file. Please wait...");
    pDialog.setIndeterminate(false);
    pDialog.setProgress(0);
    pDialog.setMax(contentId.length);
    pDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
    pDialog.setCancelable(true);

    new DownloadFile().execute();
}

private class DownloadFiles extends AsyncTask<String, Integer, String> {
    @Override
    protected String doInBackground(String... sUrl) {
        Bitmap bm;
        InputStream in;

        if (contentId.length > 0) {
            for (int i = 0; i < contentId.length; i++) {
                if (helper.databaseChecking(useremail, contentId[i])) {
                    contentdownload = i;
                    SetConstant.CONTENT_ID = contentId[i];

                    String URL = SetConstant.URL_DOWNLOAD_CONTENT + contentId[i];
                    //YOUR INTRESTING LOOP HERE.
                    publishProgress(30);
                    //SOME INTRESTING NUMBER FOR PROGRESS UPDATE
                }
            }

            try {
                in = new java.net.URL(sUrl[0]).openStream();
                bm = BitmapFactory.decodeStream(new PatchInputStream(in));
                File storage = new File(Environment.getExternalStorageDirectory() + File.separator + "/Image/");
                Log.i(TAG, "storage:" + storage);
                Log.i(TAG, "storage:" + storage.getAbsolutePath());
                if (!storage.exists()) {
                    storage.mkdirs();

                }
                String FileName = "/" + SetConstant.CONTENT_ID + ".jpg";
                FileOutputStream fos = new FileOutputStream(storage + FileName);
                bm.compress(Bitmap.CompressFormat.JPEG, 85, fos);

                String filepath = storage + FileName;
                File filecheck = new File(filepath);
                long fileSize = filecheck.length();
                fos.flush();
                fos.close();
            } catch (IOException e1) {
                e1.printStackTrace();
            }

            return null;
        }

        @Override
        protected void onPreExecute () {
            super.onPreExecute();
            pDialog.show();
        }

        @Override
        protected void onProgressUpdate (Integer...progress){
            super.onProgressUpdate(progress);
            pDialog.setProgress(progress[0]);
        }

        protected void onPostExecute (String result){
            super.onPostExecute(result);
            pDialog.dismiss();
        }
    }
} 
```

当然，此代码不会运行，您需要修复范围。但我想建议的是，您的循环应该在 中，在这种情况下，您应该在给定时间`doInBackGround(...)`只有 1 个实例，然后调用.`AsyncTask``onProgressUpdate()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T02:48:09.103

在以下行中：

```
SetConstant.CONTENT_ID = contentId[i]; 
```

您将全局变量设置为一个值，然后基于该相同值创建一个字符串 url 并将其传递给 AsyncTask。执行，然后当它完成下载时，它会创建一个文件，其名称基于全局变量 SetConstant.CONTENT_ID。

换句话说，您正在另一个线程中使用一个全局变量，其值正在由主线程更改。不要这样做，因为不同的线程在不同的时间更新，你会遇到各种奇怪的问题。将输出文件的值或名称传递给 AsyncTask。您可以在 DownloadFile 的构造函数中执行此操作，并将值存储在字段中。

如果要更新进度条，则必须更新其值；它不会自行更新。在任务期间（在 doInBackground 中）调用 AsyncTask.publishProgress 并实现 onProgressUpdate 以更新进度对话框。

[编辑：在 UI 线程中确实调用了 onProgressUpdate。]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T05:43:31.460

**主要问题：**

```
SetConstant.CONTENT_ID = contentId[i]; 
String URL = SetConstant.URL_DOWNLOAD_CONTENT+contentId[i]; 
```

在这里，你遇到了麻烦。正如@Sofi Software LLC 的回答，您正在另一个线程中使用一个全局变量，其值正在由主线程更改。

**次要问题：**

*   如果要更新进度条，则必须更新其值；
    它不会自行更新。

您确实需要在 AsyncTask 中下载图像（从 URL 下载）。有效地实现你的功能，你需要做

*   创建 AsyncTask 来下载你的图像（在 doInBackground() 中实现下载），还有一个布尔值（比如 isImageDownloaded）来跟踪图像是否在 postExecute() 中成功下载。
*   在开始下载之前不要忘记显示您的进度条
*   执行您的 AsyncTask 以启动下载
*   创建 android.os.CountDownTimer 的扩展以倒计时最短时间
*   在 onFinish() 方法上检查您跟踪的布尔值，如果它是假的，那么您取消 AsyncTask 并抛出您想要的 toast/dialog
*   运行多个 AsyncTask 实例不是一个好主意，所以一个接一个。您可以使用 executeOnExecutor() 在 Executor 上执行 AsyncTask。要确保线程以串行方式运行，请使用：SERIAL_EXECUTOR。

**以下资源可能对您有所帮助#**

如果您需要下载图像，请显示进度条并在图像视图中加载

*   [https://github.com/koush/UrlImageViewHelper](https://github.com/koush/UrlImageViewHelper)
*   [http://developer.aiwgame.com/imageview-show-image-from-url-on-android-4-0.html](http://developer.aiwgame.com/imageview-show-image-from-url-on-android-4-0.html)
*   [http://blog.blundell-apps.com/imageview-with-loading-spinner/](http://blog.blundell-apps.com/imageview-with-loading-spinner/)

如果您需要使用 AsyncTask 下载多个文件（此处为图像）

*   [使用 AsyncTask 下载多个文件的问题](https://stackoverflow.com/questions/5079335/problem-with-downloading-multiple-files-using-asynctask)
*   [如何在 AsyncTask 中取回任务完成状态](https://stackoverflow.com/questions/5103727/how-to-get-back-the-task-completion-status-in-asynctask)
*   [在 Android 中实现文件下载的进度条](https://stackoverflow.com/questions/5041978/implement-progress-bar-for-file-download-in-android)

**编辑：**

来自[http://developer.aiwgame.com/imageview-show-image-from-url-on-android-4-0.html](http://developer.aiwgame.com/imageview-show-image-from-url-on-android-4-0.html)

```
new DownloadImageTask((ImageView) findViewById(R.id.imageView1))
            .execute("http://java.sogeti.nl/JavaBlog/wp-content/uploads/2009/04/android_icon_256.png"); }

public void onClick(View v) {
    startActivity(new Intent(this, IndexActivity.class));
    finish();

}

private class DownloadImageTask extends AsyncTask<String, Void, Bitmap> {
    ImageView bmImage;

    public DownloadImageTask(ImageView bmImage) {
        this.bmImage = bmImage;
    }

    protected Bitmap doInBackground(String... urls) {
        String urldisplay = urls[0];
        Bitmap mIcon11 = null;
        try {
            InputStream in = new java.net.URL(urldisplay).openStream();
            mIcon11 = BitmapFactory.decodeStream(in);
        } catch (Exception e) {
            Log.e("Error", e.getMessage());
            e.printStackTrace();
        }
        return mIcon11;
    }

    protected void onPostExecute(Bitmap result) {
        bmImage.setImageBitmap(result);
    } } 
```

从[Android ImageView 和 Progressbar 实现中的图像下载](https://stackoverflow.com/questions/7125490/image-download-in-an-android-imageview-and-progressbar-implementation)

```
 // note that you could also use other timer related class in Android aside from this CountDownTimer, I prefer this class because I could do something on every interval basis
            // tick every 10 secs (or what you think is necessary)
            CountDownTimer timer = new CountDownTimer(30000, 10000) {

                @Override
                public void onFinish() {
                    // check the boolean, if it is false, throw toast/dialog
                }

                @Override
                public void onTick(long millisUntilFinished) {
                    // you could alternatively update anything you want every tick of the interval that you specified
                }

            };

            timer.start() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-21T17:32:57.077

首先创建一个单独的类，允许您访问图像地址

如下所示：

公共类 ImageDownloader 扩展 AsyncTask {

```
 @Override
    protected Bitmap doInBackground(String... urls) {

        try {

            URL url = new URL(urls[0]);

            HttpURLConnection connection = (HttpURLConnection) url.openConnection();

            connection.connect();

            InputStream inputStream = connection.getInputStream();

            Bitmap myBitmap = BitmapFactory.decodeStream(inputStream);

            return myBitmap;

        } catch (Exception e) {

            e.printStackTrace();

        }

        return null;
    }
} 
```

然后通过创建一个对象来访问该类（通过按钮调用的方法）并执行 Bitmap 任务，如下所示：

公共类 MainActivity 扩展 Activity {

```
ImageView downloadedImg;

public void downloadImage(View view) {

    ImageDownloader task = new ImageDownloader();
    Bitmap myImage;

    try {
        myImage = task.execute("YOUR IMAGE ADDRESS ........").get();

        downloadedImg.setImageBitmap(myImage);

    } catch (Exception e) {

        e.printStackTrace();
    }

} 
```

不要忘记： 1 - 在 onCreat 方法中定义 imageView ==> deletedImg = (ImageView) findViewById(R.id.imageView); 2 - 通过用户界面中的按钮链接您创建的方法 ==> (public void downloadImage(View view){}) 3 - 在清单文件中请求权限

# pymunk - 当我旋转身体时，Pymunk 身体的形状不会旋转

> ID：13983518
> 
> 赞同：3
> 
> 时间：2012-12-21T02:31:12.970
> 
> 标签：pymunk

在 Pymunk 中，当我旋转一个物体时，它的形状并没有旋转。当我施加脉冲时，形状会像预期的那样同步移动。我的谷歌搜索表明当身体旋转时，身体的形状应该是旋转的。我从根本上误解了轮换吗？

这是相关的轮换代码：

```
def selectEntity(self, location):
    shapes = self.space.point_query(location)
    bodies = set()
    for shape in shapes:
        bodies.add(shape.body)
    for body in bodies:
        body.angle += 1.57079633 # + 90 degrees 
```

下面是初始化代码：

```
def _addShip(self, mass, center, angle = 0.):
    radius = 10

    groupId = self.getNextBodyId() # shapes in the same group do not generate collisions
    body = pymunk.Body(mass, pymunk.moment_for_circle(mass, radius / 10, radius)) # mass, inner radius, outer radius, offset
    body.angle = angle

    partOne = pymunk.Circle(body, radius, center)
    partOne.group = groupId
    partOne.color = THECOLORS['blue']
    partOne.friction = .8

    partTwo = pymunk.Circle(body, radius, (center[0], center[1] + 20))
    partTwo.group = groupId
    partTwo.color = THECOLORS['blue']
    partTwo.friction = .8

    ship = (partOne, partTwo, body)
    self.space.add(*ship) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:37:47.327

碰撞树/哈希不会立即更新，您需要先向前推进空间。另一种更新碰撞数据的方法是调用 Space.reindex_shape(shape_that_has_been_moved)。

请参阅此示例：

```
>>> from pymunk import *
>>> s = Space()
>>> b = Body(1,1)
>>> c1 = Circle(b, 10, (-10,0))
>>> c2 = Circle(b, 10, (10,0))
>>> s.add(b,c1,c2)
>>> s.step(.1)
>>> s.point_query((-15,0))
[<pymunk.Circle object at 0x02264690>]
>>> b.angle
0.0
>>> b.angle = 1.57
>>> s.point_query((-15,0))
[<pymunk.Circle object at 0x02264690>]
>>> s.step(.1)
>>> s.point_query((-15,0))
[]
>>> s.point_query((0,-15))
[<pymunk.Circle object at 0x02264690>]
>>> b.angle = 0
>>> s.point_query((-15,0))
[]
>>> s.reindex_shape(c1)
>>> s.reindex_shape(c2)
>>> s.point_query((-15,0))
[<pymunk.Circle object at 0x02264690>] 
```

# php - 在 INSERT TO 中使用变量作为表名

> ID：13983519
> 
> 赞同：0
> 
> 时间：2012-12-21T02:31:31.283
> 
> 标签：php, mysql

您好，我将向数据库中插入一些数据。没有我的 sql 错误，但数据未插入数据库。我的代码是：

```
 mysql_query("SET CHARACTER SET 'utf8'");
  mysql_query("SET character_set_results=utf8");

if (isset($_POST['Submit'])){ 
$category= $_POST['category'];

if ($category==1) {$cat="rf_power";
$sub_cat=$_POST['power']; $dur="p_duration";}
if ($category==2) {$cat="rf_bts";
$sub_cat=$_POST['BTS']; $dur="b_duration";}
 if ($category==3) {$cat="rf_transmission";
 $sub_cat=$_POST['transmission']; $dur="t_duration";}
 if ($category==4) {$cat="core_network";$sub_cat=$_POST['core']; $dur="duration";}
 if ($category==5) {$cat="daisy_chain";
 $sub_cat=$_POST['daisy']; $dur="d_duration";}

 $dateid=date('Y-m-d');
 $s_name=mysql_real_escape_string($_POST['s_name']);
 $location=mysql_real_escape_string($_POST['city']);
 $alarm_type=mysql_real_escape_string($_POST['a_type']);
 $severity=mysql_real_escape_string($_POST['severity']);
 $reason=mysql_real_escape_string($_POST['reason']);
 $shift_operation=mysql_real_escape_string($_POST['shto_do']);
 $system_operation=mysql_real_escape_string($_POST['syto_do']);
 $start_time=mysql_real_escape_string($_POST['date1']);
 $end_time=mysql_real_escape_string($_POST['date2']);
 $dur=mysql_real_escape_string($_POST['date3']);
 echo $dateid;
 echo $s_name;
 echo $sub_cat;
 echo $location;
 echo $alarm_type;
 echo $severity;
 echo $start_time;
 echo $end_time;
 echo $dur;
 echo $reason;
 echo $shift_operation;
 echo $system_operation;
 echo $cat ;

  $sql = "INSERT INTO ".$cat." (dateid,system_name,sub_cat,location,alarmtype,severity,start_time,end_time,duartion,reason,shift_operation,system_operation)
    VALUES ('$dateid','$s_name','$sub_cat','$location','$alarm_type','$severity','$start_time','$end_time','$dur','$reason','$shift_operation','$system_operation')";
 } 
```

所有打印正常通过回声。我认为错误是针对“INSERT INTO”.$cat。”。$cat 就在这里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:34:17.797

从发布的代码看来，您的查询没有被执行，而是存储在里面`$sql`并坐在那里。从代码中没有什么可以实际执行查询，我在底部添加了这个。添加`mysql_query($sql);`将针对您选择的数据库运行脚本

```
 $sql = "INSERT INTO $cat (dateid,system_name,sub_cat,location,alarmtype,severity,start_time,end_time,duartion,reason,shift_operation,system_operation)
        VALUES ('$dateid','$s_name','$sub_cat','$location','$alarm_type','$severity','$start_time','$end_time','$dur','$reason','$shift_operation','$system_operation')";
    mysql_query($sql); 
```

# html - 在按钮内将图像和文本居中，水平和垂直

> ID：13983522
> 
> 赞同：1
> 
> 时间：2012-12-21T02:31:52.700
> 
> 标签：html, css, alignment

我正在尝试用纯 CSS 构建一个按钮，但在对齐不同的元素时却失败了。这可能很容易，但我无法理解它。这是它的外观：

![在此处输入图像描述](../Images/a34b1563f22262a2ee924accac32aaab.png)

该按钮应包含文本和图像。两者都应该垂直居中。他们两个*一起*应该水平居中。

我可以让其中任何一个单独工作，但不能同时工作。

我真的在寻找一些关于什么是*最好*的方法的指导，但这是我到目前为止使用的，对我来说尽可能简化：

```
<span style="display:table; text-align:center;">
<span style="display:table-cell; position:relative; ">
    <a href=… >
        <img style="position:absolute; top:50%; margin-top:-#{ height / 2}px"></img>
    </a>
</span>
    <a href=… > TEXT </a>
</span> 
```

这是目前的结果。

![在此处输入图像描述](../Images/14798341db159b8d18c5dfe7d86476e4.png)

注意图标应该更靠右，文本也应该更靠右一点。我目前的理解是，现在它是死点，因为对图标使用绝对对齐会将其从流程中移除。

（由于我通过 ERB 生成 HTML，一些奇怪的变量。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T02:49:29.677

您可以只在其中使用`button`带有一些文本的图像。垂直对齐按钮的内容并添加填充。

```
<button><span><img src="http://placehold.it/25x25">Some Text</span></button>​ 
```

```
button{
    padding: 1em 2em;
}
img, span{
    vertical-align:middle;
} 
```

[**演示**](http://jsfiddle.net/mowglisanu/NRWU8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:51:23.030

您是否搜索过此 HTML：

```
<html>
<head>
<style>
    .icon_button{
        background:#FFFFFF url(http://www.limitedlink.com/images/png/ico.png) no-repeat 4px 4px;
        padding:4px 4px 4px 22px;
        height:auto;
    }
</style>

</head>
<body>
    <input type="button" value="halo" class="icon_button" />
</body>
</html> 
```

# uikit - 如何平均细分封闭的CGPath？

> ID：13983532
> 
> 赞同：4
> 
> 时间：2012-12-21T02:33:02.907
> 
> 标签：uikit, core-animation, core-graphics, polygon, cgpath

我有不确定数量的`CGPath`各种形状和大小的封闭元素，它们都包含一条凹贝塞尔曲线，如下图中的红色和蓝色形状。

将这些形状划分`n`为（大致）相等大小的区域的最简单和最有效的方法是什么？

![当前的 CAShapeLayers](../Images/f6d6e7d084b64b83153741f7c27bcbf1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-25T10:03:05.473

你想要的是[Delaunay triangulation](http://en.wikipedia.org/wiki/Delaunay_triangulation)。[这是一个](http://nodename.com/wpEmbeds/VoronoiToy/bin/PlanePointsApp.swf)类似于您想要做的示例。它使用[as3 库](http://nodename.github.io/as3delaunay/)。这是一个 iOS 端口，应该可以帮助您：

[https://github.com/czgarrett/delaunay-ios](https://github.com/czgarrett/delaunay-ios)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-25T20:41:48.367

我不太了解您想要实现的目标的背景以及限制是什么。例如，是否存在细分区域大小相等的硬性要求？

通常，性能问题的解决方案不是更快的算法，而是不同的方法，通常是以下一种或多种：

1.  预先计算值，或尽可能离线计算。比如说使用另一个服务器 API，它能够离线进行细分并为多个客户端缓存结果。您可以将计算后的结果作为位图提供，其中每种颜色都索引到您要显示的值表中。查找该值将是在触摸位置索引像素的简单问题。

2.  简化或近似解决方案。网格细分是否足够准确？在 500 x 6 = 3000 个细分中，每个区域只有大约 51 个正方形点，即大约 7x7 个点的区域。在那个尺寸下，用户不会注意到该区域是否完全准确。由于触摸分辨率，您可能最终需要聚合相邻区域。

3.  逐步细化。您通常不需要预先计算整个算法。算法通常以离散（通常是对称的）单元运行，这意味着您经常重复使用先前步骤中的信息。您可以预先计算第一步，然后使用后台线程逐步填充其余细节。您也可以推迟最终计算，直到触摸发生。在这一点上，最多一秒的延迟仍然是可以容忍的，或者在最坏的情况下，您可以在计算过程中显示动画。

您可以使用一些混合方法，并可能使用 Delaunay 三角剖分计算一个或两个级别，然后使用简单、快速的三角形细分来再计算两个级别。

根据所需的精度，如果不需要离散样本，则可以使用三角形各点之间的加权平均值来近似最终级别，即，如果触摸位于两点之间的中间，则选择它们之间的平均值。

# serial-port - 从 Internet 操作 8051 端口

> ID：13983535
> 
> 赞同：1
> 
> 时间：2012-12-21T02:33:20.567
> 
> 标签：serial-port, microcontroller, 8051, serial-communication

我在微控制器 8051 的端口连接继电器。我想从网站上操作它们。所以，我想将它们的状态发送/接收到计算机，然后上传到网络服务器。

[像这样](http://www.youtube.com/watch?v=kV2zHsQbYxI&feature=watch_response)的东西 ，但我在学校项目中使用 8051 受到限制。

我发现“Pyserial”可用于将数据接收到计算机。还有其他方法吗？

我对c、php、javascript有一些了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T20:22:41.413

在不了解您的能力的情况下，很难回答这样一个笼统的问题。

如果您熟悉 Python 并且可以对 8051 进行编程，那么让 8051 接收一个字节并根据字节中的位值控制最多 8 个输出，然后让 8051 将值回显到 PC 应该相对容易用于输出状态确认。

我没有使用过 Pyserial 或 Python，但从我读过的内容来看，Pyserial 应该能够以这种方式轻松发送和接收字节。

祝你好运。

# angularjs - 使用 ng-repeat 从 json 访问数组中的项目

> ID：13983541
> 
> 赞同：0
> 
> 时间：2012-12-21T02:34:42.667
> 
> 标签：angularjs

json文件：

```
{
"id":"7",  
"date":"1 Jan",  
"images":["507f42c682882","507e24b47ffdb","507e2aeca02d5","507e2b19663a9"]  
} 
```

在我的控制器中，我有

```
$http.get('urlToJsonFile).
    success(function(d){
        console.log(d);
        $scope.item = d;
    }); 
```

在我的部分视图中，我可以打印 id 和日期，但是在打印图像时，它就不起作用了。我做错了。为什么没有输出？你知道如何解决这个问题吗？

```
{{item.id}}:{{item.date}}
    <ul>
    <li ng-repeat="img in item.images">
    {{img}}
    </li>
    </ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:52:14.023

ng-repeat 和迭代原始类型存在一些已知问题。[在github](https://github.com/angular/angular.js/issues/933)上检查这个问题。

如果可能，请尝试使用对象作为数组元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T05:39:59.433

它正在工作。[请参阅此 JS Fiddle](http://jsfiddle.net/fJB69/) 。你能把你的代码放在 JSFiddle 中，说明为什么它不适合你吗？

我已将您的 ajax 响应用作硬编码集合。

```
'use strict';

var obj = {
    "id": "7",
    "date": "1 Jan",
    "images": ["507f42c682882", "507e24b47ffdb", "507e2aeca02d5", "507e2b19663a9"]
};

function Ctrl($scope) {
    $scope.item = obj;
}​ 
```

# php - 在不安装mysql服务器的情况下安装php mysqli扩展

> ID：13983542
> 
> 赞同：0
> 
> 时间：2012-12-21T02:35:33.573
> 
> 标签：php, mysql

在我的 linux 服务器中，我从源代码安装了 php v5.2.14，而不是安装 mysql 和 apache。由于本服务器只用于运行phpunit，所以不需要安装mysql和apache。问题是某些单元测试需要 mysqli 扩展。因此，我尝试使用 php 源代码中的代码安装 mysqli 扩展。但是，在执行 './configure' 时，它停止了以下操作：

```
checking for egrep... grep -E
checking for a sed that does not truncate output... /usr/bin/sed
checking for cc... cc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether cc accepts -g... yes
checking for cc option to accept ANSI C... none needed
checking how to run the C preprocessor... cc -E
checking for icc... no
checking for suncc... no
checking whether cc understands -c and -o together... yes
checking for system library directory... lib
checking if compiler supports -R... no
checking if compiler supports -Wl,-rpath,... yes
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking target system type... x86_64-unknown-linux-gnu
checking for PHP prefix... /home/pu/php
checking for PHP includes... -I/home/pu/php/include/php -I/home/pu/php/include/php/main -I/home/pu/php/include/php/TSRM -I/home/pu/php/include/php/Zend -I/home/pu/php/include/php/ext -I/home/pu/php/include/php/ext/date/lib
checking for PHP extension directory... /home/pu/php/lib/php/extensions/no-debug-non-zts-20060613
checking for PHP installed headers prefix... /home/pu/php/include/php
checking if debug is enabled... no
checking if zts is enabled... no
checking for re2c... no
configure: WARNING: You will need re2c 0.13.4 or later if you want to regenerate PHP parsers.
checking for gawk... gawk
checking for MySQLi support... yes, shared
checking whether to enable embedded MySQLi support... no
mysql_config not found
configure: error: Please reinstall the mysql distribution 
```

所以我认为它可能缺少 mysql 导致这个问题。有什么解决方案。我不想安装mysql服务器，只要安装mysql客户端或驱动程序就足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:16:22.247

它需要获取编译选项：

```
mysql_config (1)  - get compile options for compiling clients 
```

我认为你需要 php5-mysqlnd。尝试安装它：

```
$ sudo apt-get install php5-mysqlnd 
```

这个包没有 PHP 或 MySQL 作为依赖项：

```
php5-mysqlnd
  Depends: libc6 (>= 2.15)
  Depends: php5-common (= 5.3.10-1ubuntu3)
  Depends: phpapi-20090626+lfs
libc6
  Depends: libc-bin (= 2.15-0ubuntu10)
  Depends: libgcc1
  Depends: tzdata
libc-bin
libgcc1
  Depends: gcc-4.6-base (= 4.6.3-1ubuntu5)
  Depends: libc6 (>= 2.2.4)
  PreDepends: multiarch-support
gcc-4.6-base
multiarch-support
  Depends: libc6 (>= 2.13-0ubuntu6)
tzdata
  Depends: debconf (>= 0.5)
  Depends: debconf-2.0
debconf
  PreDepends: perl-base (>= 5.6.1-4)
perl-base
  PreDepends: dpkg (>= 1.14.20)
  PreDepends: libc6 (>= 2.11)
dpkg
  PreDepends: coreutils (>= 5.93-1)
  PreDepends: libbz2-1.0
  PreDepends: libc6 (>= 2.11)
  PreDepends: libselinux1 (>= 1.32)
  PreDepends: tar (>= 1.23)
  PreDepends: xz-utils
  PreDepends: zlib1g (>= 1:1.1.4)
coreutils
  Depends: dpkg (>= 1.15.4)
  Depends: install-info
  PreDepends: libacl1 (>= 2.2.51-5)
  PreDepends: libattr1 (>= 1:2.4.46-5)
  PreDepends: libc6 (>= 2.15)
  PreDepends: libselinux1 (>= 1.32)
install-info
  Depends: libc6 (>= 2.4)
libacl1
  Depends: libattr1 (>= 2.4.46-3)
  Depends: libc6 (>= 2.4)
  PreDepends: multiarch-support
libattr1
  Depends: libc6 (>= 2.4)
  PreDepends: multiarch-support
libselinux1
  Depends: libc6 (>= 2.8)
  PreDepends: multiarch-support
libbz2-1.0
  Depends: libc6 (>= 2.4)
  PreDepends: multiarch-support
tar
  PreDepends: libc6 (>= 2.8)
xz-utils
  Depends: libc6 (>= 2.7)
  Depends: liblzma5 (>= 5.1.1alpha+20110809)
liblzma5
  Depends: libc6 (>= 2.4)
  PreDepends: multiarch-support
zlib1g
  Depends: libc6 (>= 2.4)
  PreDepends: multiarch-support
debconf-2.0
php5-common
  Depends: libc6 (>= 2.4)
  Depends: sed (>= 4.1.1-1)
sed
  Depends: dpkg (>= 1.15.4)
  Depends: install-info
  PreDepends: libc6 (>= 2.4)
  PreDepends: libselinux1 (>= 1.32)
phpapi-20090626+lfs 
```

最后，添加`--with-mysqli=/usr/bin/mysql_config`为配置选项。

# php - Laravel 的管理面板？

> ID：13983543
> 
> 赞同：1
> 
> 时间：2012-12-21T02:36:06.377
> 
> 标签：php, laravel

我正在考虑从 Code Igniter 切换到 Laravel。

我们使用自定义管理面板部署了大量站点。

这是安装为 Code Igniter 的两个安装，

你基本上有（简化，我们实际上在主站点和管理面板上都使用了 HMVC，但这说明了重点）

```
index.php
assets
system
application
  config
  controllers
  models
  views    
admin
  index.php
  assets
  application 
    config 
    controllers
    models
    views 
```

并且管理员安装设置为`database.php`通过包含从主站点加载配置文件（例如）。

我们所有的主站点模型都使用管理面板中的模型，包括然后扩展它们，使我们能够仅在主站点中拥有特定于主站点的功能。

这对我们来说效果很好，但是现在我们正在切换到 Laravel，我们想知道是否有更好的方法来做到这一点，我们使用管理面板来管理几个“模块”，例如博客、购物车、物业经理、这些都是插件。

本质上，我们希望能够：

*   保持主站点与管理面板的分离清晰，以便我们可以在我们的任何站点上使用管理面板。
*   仍然可以放入捆绑包（例如博客捆绑包）。
*   理想情况下，我们希望在管理面板和主站点之间有一个共享的 bundles 文件夹，其中包含三个文件夹。`admin`//所以一个bundle是自包含的`main`。`shared`

在 laravel 中实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-10-24T13:20:31.380

我也从 CI 切换到 Laravel，发现 Laravel 中有基本的管理面板，但在生成 CRUD 时不是处理数据的正确解决方案

Check LaraAdmin 是一个开源的 Laravel 管理面板/CMS，可用作 Laravel 的管理后端、数据管理工具或 CRM 样板，具有 CRUD 生成、模块管理器、媒体、菜单、备份等功能。

文档： http: [//laraadmin.com/docs/1.0](http://laraadmin.com/docs/1.0)

源代码：[https ://github.com/dwijitsolutions/laraadmin](https://github.com/dwijitsolutions/laraadmin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T05:35:43.990

您可能已经考虑过这一点，但我认为最好使用管理包，因为包都是核心系统的一部分。这对 SoC 和简单性（易用性）都有好处。

然后，管理面板可以找到所有包（当然，除了它自己）来读取和写入配置条目，例如博客包的那些。

另一种方法是将管理面板放置在您的主应用程序中，通过将特定命令路由到各种管理控制器（不要忘记您可以将控制器放入子文件夹）。例如，您可以使用`routes.php`，将 路由`admin/pages/edit/152`到 中的`pages.php`控制器`application/controllers/admin/`。如前所述，您甚至可以使用这种方法通过扫描 bundles 目录来管理您的各种 bundles/snap-ins。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T23:01:16.467

有没有一种方法可以更改 Apache 配置，使每个站点都是 Laravel 上一个目录的虚拟主机？这样每个站点都是它自己的“html”目录，你不需要在 Laravel 中改变任何东西；index.php 中的行将为您完成所有繁重的工作：

```
require '../paths.php'; 
```

这是假设您的所有站点都在同一台机器或集群上运行，因此您的系统看起来像这样

```
assets
system
application
  config
  controllers
    admin
    site1
    site2
  models
    admin
    site1
    site2
  views    
    admin
    site1
    site2
html_site1
html_site2 
```

但是，如果您只想让管理面板成为自己的应用程序，您可以将 html 的内容复制到管理目录中，更改该目录的 mod_rewrite 或 .htaccess 然后更改

```
require '../paths.php'; 
```

到

```
require 'path/to/admin/paths.php'; 
```

它将使用完全不同的 laravel 应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-20T13:06:14.060

你可以使用 Laravella（一个 CMS，laravel 的 CRUD 包）

[https://github.com/laravella/laravella/releases](https://github.com/laravella/laravella/releases)

无论你是否使用 Laravella，都要为每个站点创建一个包来覆盖主站点的类。这样您就可以将每个站点保留在其自己的源代码控制存储库中。

# python - 带有指针数组的 cython

> ID：13983544
> 
> 赞同：6
> 
> 时间：2012-12-21T02:36:10.273
> 
> 标签：python, numpy, cython

我在 python 中有一个 numpy.ndarrays （具有不同长度）的列表，并且需要非常快速地访问 python 中的那些。我认为指针数组可以解决问题。我试过了：

```
float_type_t* list_of_arrays[no_of_arrays]
for data_array in python_list_of_arrays:
    list_of_arrays[0] = data_array 
```

但赛通抱怨：

```
no_of_arrays < Not allowed in a constant expression 
```

我尝试了几种方法来构造这个变量：

```
cdef extern from *:
    ctypedef int const_int "const int" 
```

（有更多的创造性尝试） - 但是不幸的是它不起作用。

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T03:03:52.810

为什么不使用 numpy 对象数组而不是数组列表？

我认为您遇到的问题是因为您`list_of_arrays`在堆栈中声明，并且它的大小必须在编译时知道。您可以尝试一些[动态分配](http://wiki.cython.org/DynamicMemoryAllocation)，如下所示：

```
from libc.stdlib cimport malloc, free

cdef float_type_t *list_of_arrays = \
    <float_type_t *>malloc(no_of_arrays * sizeof(float_type_t*))

for i in range(no_of_arrays):
    list_of_arrays[i] = &(data_array[i].data)

# don't forget to free list_of_arrays! 
```

（这假设`data_array`是一个 numpy 数组。）

但这仍然是在猜测您想要做什么。

# android - 如何在 android 中使用计时器程序使用 Lap Button（用于 android 中的计时器应用程序的lap 按钮代码）

> ID：13983549
> 
> 赞同：1
> 
> 时间：2012-12-21T02:36:36.157
> 
> 标签：android, timer

我有一个按钮开始和三个editText。如果我按下开始按钮，则计时器启动，按钮文本更改为 Lap，小时分钟和秒数显示在 edittext1 中。如果我按下 Lap 按钮，那么 editText1 的值将停止。editText1 的所有三个值都显示在editText2 中editText1 的停止位置。

请帮助我获取 Lap 按钮源代码。到目前为止，我有以下代码：

```
package com.example.timmerproject;

import java.util.Timer;
import java.util.TimerTask;
import android.app.Activity;
import android.os.Bundle;
import android.os.Handler;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class LapActivity extends Activity
{
    EditText ed1,ed2,ed3;
    Button btntimer;
    final Handler handler = new Handler();
    long startTime=0;
    Handler h2 = new Handler();

    Runnable run = new Runnable()
    {
        @Override
        public void run()
        {
            // TODO Auto-generated method stub
            long millis = System.currentTimeMillis() - startTime;
            int seconds = (int)(millis/1000);
            int hours =seconds/3600;
            int minutes = (seconds % 3600)/60;

            seconds = seconds % 60;
            ed1.setText(String.format("%02d:%02d:%02d", hours,minutes,seconds));
            h2.postDelayed(this, 500);
        }
    };

    class firstTask extends TimerTask
    {
        @Override
        public void run()
        {
            handler.sendEmptyMessage(0);
        }
    };

    class secondTask extends TimerTask
    {
        @Override
        public void run()
        {
            // TODO Auto-generated method stub
            LapActivity.this.runOnUiThread(new Runnable()
            {
                @Override
                public void run()
                {
                    // TODO Auto-generated method stub
                    long millis = System.currentTimeMillis() - startTime;
                    int seconds = (int)(millis/1000);
                    int hours =seconds/3600;
                    int minutes = (seconds % 3600)/60;

                    seconds = seconds % 60;
                    ed2.setText(String.format("%02d:%02d:%02d", hours,minutes,seconds));
                }
            });
        }
    }

    class thirdTask extends TimerTask
    {
        @Override
        public void run()
        {
            // TODO Auto-generated method stub
            LapActivity.this.runOnUiThread(new Runnable()
            {
                @Override
                public void run()
                {
                    // TODO Auto-generated method stub
                    long millis = System.currentTimeMillis() - startTime;
                    int seconds = (int)(millis/1000);
                    int hours =seconds/3600;
                    int minutes = (seconds % 3600)/60;

                    seconds = seconds % 60;
                    ed3.setText(String.format("%02d:%02d:%02d", hours,minutes,seconds));
                }
            });
        }           
    }

    Timer timer = new Timer();

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.lap);
        ed1 = (EditText)findViewById(R.id.ed11);
        ed2 = (EditText)findViewById(R.id.ed12);
        ed3 = (EditText)findViewById(R.id.ed13);
        btntimer = (Button)findViewById(R.id.lapbutton);

        btntimer.setOnClickListener(new OnClickListener()
        {
            @Override
            public void onClick(View v)
            {
                // TODO Auto-generated method stub
                Button btn = (Button)v;

                if(btn.getText().equals("Stop"))
                {
                    timer.cancel();
                    timer.purge();
                    h2.removeCallbacks(run);
                    btn.setText("Start");
                }
                else
                {
                    startTime = System.currentTimeMillis();
                    timer = new Timer();
                    timer.schedule(new firstTask(), 0,500);
                    timer.schedule(new secondTask(),  0,500);
                    timer.schedule(new thirdTask(),  0,500);
                    h2.postDelayed(run, 0);
                    btn.setText("Stop");       
                }   
            }   
        });
    }
} 
```

# c# - 不保存集合的紧凑框架自定义控件

> ID：13983552
> 
> 赞同：0
> 
> 时间：2012-12-21T02:36:55.360
> 
> 标签：c#, windows-mobile, compact-framework, visual-studio-designer

我正在为紧凑框架创建一个菜单控件。该控件具有一组项目。我可以使用 Visual Studio 设计器添加项目，但是，它们永远不会添加到设计器文件中，因此下次我打开设计器或构建解决方案时，菜单不再有任何项目。

这是项目的代码：

```
public class Item
{
    public int ImageIndex { get; set; }

    private string _text = "";
    public string Text
    {
        get { return _text ?? ""; }
        set { _text = value ?? ""; }
    }

    public string Name { get; set; }
} 
```

这是菜单的相关代码：

```
public class ItemMenu : Control
{
    public ItemMenu()
    {
        Columns = 4;
        RowHeight = 64;
        ColumnWidth = 64;
        _items.ListChanged += new ListChangedEventHandler(_items_ListChanged);
    }

    private BindingList<Item> _items = new BindingList<Item>();
    public BindingList<Item> Items
    {
        get { return _items; }
    }

    public ImageList NormalImages { get; set; }
    public ImageList SelectedImages { get; set; }

    public int Columns { get; set; }
    public int RowHeight { get; set; }
    public int ColumnWidth { get; set; }
    public int Rows
    {
        get { return (int)Math.Ceiling((double)Items.Count / (double)Columns); }
    }

    private void _items_ListChanged(object sender, ListChangedEventArgs e)
    {
        Refresh();
    }
} 
```

有谁知道当我在 Visual Studio 设计器中编辑项目时如何将项目集合保存到设计器文件中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T06:59:39.783

我会在假期外出时尽我所能回答这个问题，但是您需要为控件指定一些设计时属性。您可以将一个 DesignTimeAttributes 文件添加到您的控件程序集中。它是一个 XML 文件，我相信它带有 XMTA 扩展名。在每个类的 XML 文件中，您可以指定不同的设计时属性，以及将设计时编辑器链接到控件等。

您需要试验的属性是[DesignerSerializationVisibility](http://msdn.microsoft.com/en-us/library/system.componentmodel.designerserializationvisibility.aspx)属性。我相信您可以将其设置为 Content 以便正确序列化您的收藏。

如果您需要更多指导，当我回到我有一个示例的地方时，我可以更新我的答案。

# php - PHP - 动态添加透明PNG到GIF

> ID：13983557
> 
> 赞同：1
> 
> 时间：2012-12-21T02:38:08.340
> 
> 标签：php, watermark, php-gd

我正在尝试用 php 代码做一个水印标记，一切似乎都很好，直到我把一个透明的 PNG 文件放到 GIF 中。这会发生什么：

![在此处输入图像描述](../Images/38a04005d93659930d0a52fc1b15ee32.png)

所以不是透明的黑色水印，我在顶部得到了这个半纯绿色的东西。水印是 ![在此处输入图像描述](../Images/0377dadba99a337a8741ccc10f1f9619.png)

我使用以下 php 代码：

```
 ...
    $image = imagecreatefromgif($filepath);;
    $watermark_image = imagecreatefrompng($wm_filepath);
    imagealphablending($watermark_image, false);
    imagesavealpha($watermark_image, true);
    imagegif($image, $filepath);
    imagedestroy($image);

    imagecopy($image, $watermark_image, $offset['x'], $offset['y'], 0, 0, imagesx($watermark_image), imagesy($watermark_image) ); 
```

ps我不得不提一下，我尝试使用组合不同的设置

```
 imagealphablending()
    imagesavealpha() 
```

没有结果

**更新**：

现在我将图像保存为 png 文件。我删除了这两行`imagealphablending($watermark_image, false); imagesavealpha($watermark_image, true);`，它起作用了。但是，PNG 的透明度与 GIF 重叠。`imagealphablending($image, true);`没有帮助。我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:40:21.743

GIF 文件被限制为 256 种颜色，并且只有一种颜色被指定为透明。所以你不能有抗锯齿透明度，也不能有任何类型的抗锯齿。

我建议另存为PNG。

# php - 在 XAMPP 中使用 PHP：可以创建数据库但不能创建表

> ID：13983562
> 
> 赞同：0
> 
> 时间：2012-12-21T02:38:29.130
> 
> 标签：php, xampp

我是一名初级程序员，我安装了 XAMPP 是为了学习一点 PHP。我有 SQL 的工作知识。

我一直在关注[w3schools](http://www.w3schools.com/php/)的 PHP 教程。我目前遇到的问题是：我在[这里](http://www.w3schools.com/php/php_mysql_create.asp)使用脚本在其中创建一个数据库和一个表。我使用的几乎是逐字逐句的，除了我用“root”替换了用户并且我已经删除了密码。

通过浏览器运行脚本后，数据库 my_db 出现在 XAMPP 中 mysql 的数据文件中。

但是，没有表格的迹象，当我尝试选择表格时，我得到

> 表 'my_db.persons' 不存在

到底是怎么回事？我逐字记录的代码有问题，还是有权限的？

奇怪的是创建了数据库但没有创建表......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:21:15.837

发生的事情是您的“CREATE TABLE”将失败。

养成在每个 mySQL 查询（在您的代码中）之后检查错误的习惯：有时您可以忽略错误，但这种情况很少见。所以程序如下：

```
Create query: $sql =
Set parameters: $aParams =   (or bind paramters)
Execute query
If errors
    If debug: Show error and query
    If live: Log error and query 
```

我没有给出代码的解决方案，因为您遵循的教程的一个问题是它使用了很快就会贬值的 mysql_() 函数。您应该使用[PDO（PHP 数据库对象）](http://php.net/manual/en/book.pdo.php)或[mysqli()](http://php.net/manual/en/book.mysqli.php)函数，否则您的代码将无法在几个发布时间内运行。

使用 PDO，您可以将错误处理设置为使用异常，并将每个调用包装在 try {} catch {} 中，这使得捕获和报告错误的习惯变得非常容易。

```
 $sql = 'CREATE TABLE....';
    $aParams = array(
        ':param_name' => $param_value,
        ':param_name2' => $param_value2
           );

    try {
        $stmnt = $db->prepare($sql);
        $stmnt->execute($aParams);
        $stmnt = null;
    } catch (Exception $e) {
        // Error log here; $e contins line of error and the actual error, you have $sql and $aParams
        LogDBError($e, $sql, $aParams);
    } 
```

# c++ - msgpack 反序列化 c++

> ID：13983563
> 
> 赞同：2
> 
> 时间：2012-12-21T02:38:34.043
> 
> 标签：c++, msgpack, messagepack

当我从缓冲区解析时，我必须知道缓冲区的确切类类型（myclass）是什么。所以我不能以统一的方式处理所有的缓冲区解析。我必须区分每种班级类型（可以吗？）。

我的问题是“我如何以统一的方式处理所有缓冲区解析，并且不需要关心确切的类类型是什么。” 有什么解决办法吗？谢谢你的帮助！

```
 class myclass {
private:
    std::string m_str;
    std::vector<int> m_vec;
public:
    MSGPACK_DEFINE(m_str, m_vec);
};

int main(void) {
        std::vector<myclass> vec;
        // add some elements into vec...

        // you can serialize myclass directly
        msgpack::sbuffer sbuf;
        msgpack::pack(sbuf, vec);

        msgpack::unpacked msg;
        msgpack::unpack(&msg, sbuf.data(), sbuf.size());

        msgpack::object obj = msg.get();

        // you can convert object to myclass directly
        std::vector<myclass> rvec;
        obj.convert(&rvec);
} 
```

我希望它像这样工作

```
class base 
{
.....
};

class A:public base
{
....
};

class B:public base
{
....
};

base* parse(msgpack::sbuffer sbuf)
{
...
}

int main(void)
 {
    A a;
        msgpack::sbuffer sbuf;
        msgpack::pack(sbuf, a);
    base* a1 = parse(sbuf);
    ....    

    B b;
        msgpack::sbuffer sbuf;
        msgpack::pack(sbuf, b);
    base* b1 = parse(sbuf);
    ....        
} 
```

# php - 尝试从多个表中选择信息时，mysqli 准备好的语句出现问题

> ID：13983565
> 
> 赞同：0
> 
> 时间：2012-12-21T02:38:58.167
> 
> 标签：php, mysqli

我对 MySQLi 和准备好的语句相当陌生。最近一直在关注很多教程以了解它们是如何工作的，但仍然无法弄清楚这件事。当新用户尝试注册时，我想检查数据库中是否已经存在用户名和电子邮件。以下代码在我检查 1 个表时有效，但在我尝试检查多个表中的现有条目时无效。我试过加入和交叉加入子句以及联合和联合所有。Dreamweaver 没有显示语法错误，但一定是某个地方存在代码问题。我想知道在加入表格之前是否必须在 phpmyadmin 中设置表格之间的关系，但我认为这不会导致问题。

```
// check if the email is taken
    $check = $mysqli->prepare("SELECT email FROM parents JOIN leaders WHERE parents.email = ? OR leaders.email = ?"); 
    $check->bind_param("s", $input['email']);
    $check->execute();
    $check->store_result(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:53:18.883

好的，假设您有 3 个具有相同结构的表，您希望`UNION`在一个查询中将这些表放在一起，`WHERE`子句中有一个条件。

```
// UNION query to combine all three tables.
// The union is wrapped in a subquery to apply the single WHERE clause
// to the whole thing...
$sql = "
  SELECT email FROM (
    SELECT email FROM parents
    UNION SELECT email FROM leaders
    UNION SELECT email FROM guides
  ) combined
  WHERE email = ?";

if ($check = mysqli->prepare($sql)) {
  // Bind one input param
  $check->bind_param("s", $input['email']);
  $check->execute();
  $check->store_result();
  // Then fetch your row however you had planned to do so...
} 
```

### 表结构注意事项：

一般来说，不建议有多个具有相同结构的表。这里应该有一个表，而不是 3 个不同的表，它结合了所有表，并有一列将类型标识为`leader,guide,parent`.

# objective-c - [__NSCFString objectAtIndex:]：无法识别的选择器发送到实例错误

> ID：13983566
> 
> 赞同：0
> 
> 时间：2012-12-21T02:38:59.357
> 
> 标签：objective-c, nsmutablearray, nsarraycontroller, nscfstring

我尝试使用 Arraycontroller 将存储桶的内容加载到 NSTableView 中。我以这个错误结束了uo：

```
 -[__NSCFString objectAtIndex:]: unrecognized selector sent to instance 0x1006da970 
```

这是我用来检查的代码。

```
 - (IBAction)checkCloud:(id)sender {

    AmazonS3Client *s3 = [AmazonClientManager s3];

    S3ListObjectsRequest* listObjectsRequest = [[S3ListObjectsRequest alloc] initWithName:@"hello-testing"];

    NSMutableArray *fileListCloud = [[NSMutableArray alloc] init];
    NSMutableArray *fileModifiedList = [[NSMutableArray alloc] init];

    @try {

    S3ListObjectsResponse* response = [s3 listObjects:listObjectsRequest];

    NSMutableArray* objectSummaries = response.listObjectsResult.objectSummaries;
    for ( S3ObjectSummary* objSummary in objectSummaries ) {

        [fileListCloud addObject:[objSummary key]];
        [fileModifiedList addObject:[objSummary lastModified]];

       }
    }
    @catch (NSException *exception) {
       NSLog(@"Cannot list S3 %@",exception);
    }

     [self loadFileListTable:fileListCloud andFileModificationDate:fileModifiedList];

    }

    -(void)loadFileListTable:(NSMutableArray *)fileListArray andFileModificationDate:(NSMutableArray *)modifiedArray{

         NSRange range = NSMakeRange(0, [[_fileListAC arrangedObjects] count]);
         [_fileListAC removeObjectsAtArrangedObjectIndexes:[NSIndexSet indexSetWithIndexesInRange:range]];

        for(int i = 0 ; i<[fileListArray count];i++){
             [_fileListAC addObject:[NSMutableDictionary  dictionaryWithObjectsAndKeys:[[fileListArray objectAtIndex:i] objectAtIndex:0],@"Files",[[modifiedArray objectAtIndex:i] objectAtIndex:1],@"Date Modified", nil]];

        }
      } 
```

数组加载了文件名，但是当我将它添加到数组控制器时，它会引发上述错误。任何帮助都会非常棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:17:59.623

这里

```
[[fileListArray objectAtIndex:i] objectAtIndex:0]
[[modifiedArray objectAtIndex:i] objectAtIndex:1] 
```

`[fileListArray objectAtIndex:i]`并且`[modifiedArray objectAtIndex:i]`不是 NSArrays（我认为它们都是 NSStrings）。

您只需要删除错误`objectAtIndex:0`和`objectAtIndex:1`消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T04:34:08.747

在这里更改

```
[_fileListAC addObject:[NSMutableDictionary  dictionaryWithObjectsAndKeys:[fileListArray objectAtIndex:i],@"Files",[modifiedArray objectAtIndex:i], @"Date Modified", nil]]; 
```

# vim - 如何避免 vim 中的累积文件类型命令？

> ID：13983568
> 
> 赞同：1
> 
> 时间：2012-12-21T02:39:19.933
> 
> 标签：vim, file-type, vim-plugin, ftplugin

假设我在 vim 中加载了一个 python 文件。快速检查`:scriptnames`显示我的`~/.vim/ftplugin/python/python.vim`文件按预期加载。此文件中的命令之一突出显示超过第 80 列的所有字符。现在假设我在另一个缓冲区中打开了一个 C++ 文件（因此运行`~/.vim/ftplugin/cpp/cpp.vim`）。尽管执行了新命令，但`python.vim`仍然适用其中的设置；因此字符在我的 C++ 文件的第 80 列之后突出显示。

反正有没有像这样使文件类型命令不累积？我`filetype plugin indent on`在我的`.vimrc`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:05:31.733

The problem is that both `'colorcolumn'` and `:match` (you didn't specify whether you use the new setting or the older highlight approach) are **local to the window**, but ftplugins should only set *buffer-local* settings.

Why are these settings window-local? That allows you to have the same buffer displayed in two windows, one with, and one without the highlighting.

What can you do to prevent this?

a) Don't set this in the ftplugin, and instead use mappings to toggle the colorcolumn on/off.

b) Put `:setlocal nocolorcolumn` into all ftplugin scripts (e.g. in `~/.vim/after/ftplugin/*.vim`) for all filetypes that you're using. This will only work unless you switch between different filetypes in the same window.

c) The correct (but most complex) way to solve this is through a couple of `:autocmd`s on `BufWinEnter`, `BufWinLeave`, and `WinLeave` events.

# c++ - Microsoft Visual Studio 中的项目目录在哪里？

> ID：13983569
> 
> 赞同：0
> 
> 时间：2012-12-21T02:39:31.240
> 
> 标签：c++, directory, ms-project

microsoft Visual Studio C++ 中的项目目录在哪里？如何添加文件以便在代码行中编写**#include "myfile"**？谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:43:52.853

通常，Visual Studio 项目目录是解决方案目录的子目录。但是，它不需要。例如，您可以将一个项目添加到多个解决方案中。

对于任何给定的项目，在项目设置中，项目目录的位置可通过`$(ProjectDir)`宏扩展获得。

您还可以使用此类宏扩展来访问普通环境变量。

`#include "blah"`和之间的区别在于`#include <blah>`前者添加了一个依赖于编译器的附加搜索头，然后（如果失败）执行与后者相同的搜索。对于大多数（全部？）现代编译器，额外的搜索包括在包含文件的目录中搜索。因此，

添加文件以便您可以仅`#include "myfile"`在代码中编写的一种方法是将文件放在与包含代码相同的目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:44:37.690

将包含您的文件的目录添加到包含目录列表中：

> 项目 -> 属性 -> 配置属性 -> C/C++ -> 附加包含目录

# iphone - UiTabbar 图标无法正确显示

> ID：13983570
> 
> 赞同：0
> 
> 时间：2012-12-21T02:39:34.443
> 
> 标签：iphone, icons, uitabbar

我正在尝试升级我的应用程序以在 iPhone 5 的视网膜屏幕上显示看起来很棒的图标。目前我没有使用代码设置我的图标，我只是在 xcode 中选择图像并将其加载到它的自己的（我不知道如何在图标中编码，所以这就是我这样做的原因）。

无论如何，当我设置图标时，我必须使用 24x24 图标，否则它不适合。当我使用 64x64 的高分辨率图标时，它们不适合。我的问题是，我该如何做才能使我的图标缩放以适应但仍保持高分辨率质量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T05:13:16.133

只需尝试在您`.m`的特定tabBar父视图的文件中设置此代码..在`viewDidLoad:`方法中..

```
 self.tabBarItem.image = [UIImage imageNamed:@"home@2x.png"];/// set your image name instead of home 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T02:45:37.377

1）如果您的非视网膜图标是 24x24，那么您的视网膜图标应该是 48x48

2）您应该在界面生成器中将您的图标设置为非视网膜版本。只要您遵循标准命名方案，如果它在视网膜设备上，视网膜版本将自动换出：

```
name.png     (non-retina image)
name@2x.png  (retina image) 
```

另请注意：如果您确实在代码中设置了图像，您可以简单地使用`[UIImage imageNamed:@"whatever"]`并且视网膜图像也会自动为您换出（您不必执行 if-else 或类似的操作）。

# linux - 用于在特定时间跟踪特定字符串的日志文件的 Shell 函数

> ID：13983572
> 
> 赞同：15
> 
> 时间：2012-12-21T02:39:58.260
> 
> 标签：linux, grep, tail

我需要做以下事情来确保我的应用程序服务器是

1.  跟踪特定字符串的日志文件
2.  在打印该字符串之前保持阻塞状态
3.  但是，如果字符串在大约 20 分钟内未打印，则退出并抛出异常消息，例如“服务器需要超过 20 分钟才能启动”
4.  如果在日志文件中打印了字符串，则退出循环并继续。

有没有办法在 while 循环中包含超时？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-21T02:48:39.773

```
#!/bin/bash
tail -f logfile | grep 'certain_word' | read -t 1200 dummy_var
[ $? -eq 0 ]  && echo 'ok'  || echo 'server not up' 
```

这会读取写入日志文件的任何内容，搜索某些单词，如果一切正常，则回显 ok，否则在等待 1200 秒（20 分钟）后它会抱怨。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T02:44:58.693

您可以使用来自 shell 脚本的信号处理程序（请参阅[http://www.ibm.com/developerworks/aix/library/au-usingtraps/index.html](http://www.ibm.com/developerworks/aix/library/au-usingtraps/index.html)）。

基本上，您将定义一个要在信号 17 上调用的函数，然后在后台放置一个子脚本，以便稍后发送该信号：

```
timeout(pid) {
   sleep 1200
   kill -SIGUSR1 $pid
}

watch_for_input() {
   tail -f file | grep item
}

trap 'echo "Not found"; exit' SIGUSR1
timeout($$) &
watch_for_input 
```

然后，如果您达到 1200 秒，您的函数将被调用，您可以选择要执行的操作（例如向您的 tail/grep 组合发出信号，该组合正在监视您的模式以杀死它）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T02:46:06.490

你可以这样做：

```
start_time=$(date +"%s")
while true
do
    elapsed_time=$(($(date +"%s") - $start_time))
    if [[ "$elapsed_time" -gt 1200 ]]; then
        break
    fi
    sleep 1
    if [[ $(grep -c "specific string" /path/to/log/file.log) -ge 1 ]]; then
        break
    fi
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T02:49:48.177

```
time=0
found=0
while [ $time -lt 1200 ]; do
  out=$(tail logfile)
  if [[ $out =~ specificString ]]; then
    found=1
    break;
  fi  
  let time++
  sleep 1
done
echo $found 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-31T07:52:21.177

接受的答案不起作用并且永远不会退出（因为尽管`read -t`退出，先前的管道命令（`tail -f | grep`）只会`read -t`在尝试写入输出时被通知退出，这在字符串匹配之前永远不会发生）。

单线可能是可行的，但这里有脚本（工作）方法。每一个的逻辑都是相同的，它们用于`kill`在超时后终止当前脚本。Perl 可能比`gawk/read -t`

```
#!/bin/bash

FILE="$1"
MATCH="$2"

# Uses read -t, kill after timeout
#tail -f "$FILE" | grep "$MATCH" | (read -t 1 a ; kill $$)

# Uses gawk read timeout ability (not available in awk)
#tail -f "$FILE" | grep "$MATCH" | gawk "BEGIN {PROCINFO[\"/dev/stdin\", \"READ_TIMEOUT\"] = 1000;getline < \"/dev/stdin\"; system(\"kill $$\")}"

# Uses perl & alarm signal
#tail -f "$FILE" | grep "$MATCH" | perl -e "\$SIG{ALRM} = sub { `kill $$`;exit; };alarm(1);<>;" 
```

# javascript - javascript：旧版本 IE 的 selectionStart 和 selectionEnd 的替代方法

> ID：13983573
> 
> 赞同：1
> 
> 时间：2012-12-21T02:40:06.423
> 
> 标签：javascript, selection

我已经编写了一个脚本，用于从某种元素（例如 div 或 span）中的字符串或 html 中获取选择，并在 MaxArt 的帮助下对其进行格式化，这对于符合标准的浏览器非常有用。但是，对于旧版本的 IE，虽然我可以获得选择，但我没有办法获得起点和终点。开始和结束点是放置选择所必需的，一旦被操纵回字符串。

SelectionStart 或 SelectionEnd 适用于 textareas 但不适用于 div 或 span。以下由 MaxArt 提供的内容适用于符合标准的浏览器。任何人都可以推荐一些适用于旧版本 IE 的 span 和 div 的东西。

谢谢！

JS

```
function editText() {
//var sel = document.getElementById('displaytext').textContent;
//alert(sel);
    var sel = getSelection();
    alert(sel);
    var rng, startSel, endSel, sel;
if (!sel.rangeCount
        || displaytext.compareDocumentPosition((rng = sel.getRangeAt(0)).startContainer) === Node.DOCUMENT_POSITION_PRECEDING
    || displaytext.compareDocumentPosition(rng.endContainer) === Node.DOCUMENT_POSITION_FOLLOWING ) {
    sel = "";
}
else {
    startSel = displaytext.compareDocumentPosition(rng.startContainer) === Node.DOCUMENT_POSITION_FOLLOWING ? 0 : rng.startOffset;
    endSel = displaytext.compareDocumentPosition(rng.endContainer) === Node.DOCUMENT_POSITION_PRECEDING ? displaytext.textContent.length : rng.endOffset;
    sel = displaytext.textContent.substring(startSel, endSel);
}
} 
```

HTML

```
<span id = "displaytext">HERE IS A BUNCH OF TEXT THAT I WANT TO GRAB A SELECTION FROM</span> <a href="javascript:void(0)" onclick="editText()">link</a> 
```

# jquery - HTML jQuery 在单击按钮时更改段落

> ID：13983582
> 
> 赞同：0
> 
> 时间：2012-12-21T02:40:53.857
> 
> 标签：jquery, html, css, button, onclick

我正在制作一个简单的网站，它有一个主文本窗口，上面只有文本。我想要主页、关于、联系人等按钮。现在，我不想制作 about.html、contact.html 等，但我宁愿只更改文本而不加载新页面？（所以感觉更流畅）。

所以我用适合每个页面（主页，关于等）的文本制作了几段文字，现在有什么方法可以满足我的要求吗？只需单击按钮即可更改段落？或者是否有任何简单的方法可以做到这一点，而无需为每个页面制作 .html 文件？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:50:06.507

您可能想查看[jQuery UI 选项卡](http://jqueryui.com/tabs/)插件，如果您将内容内联，它将完全按照您的要求进行操作。或者，您可以拥有单独的内容文件，但使用相同的插件通过 AJAX 加载它们。即使您决定不使用该插件，您也可以使用类似的技术来实现相同的效果，即在页面加载时隐藏除主“选项卡”之外的所有内容，然后在 div 上使用锚点和按钮上的合适的 href 来确定哪个选项卡显示。

[jQuery UI 手风琴](http://jqueryui.com/accordion/)是另一种处理每页多个内容部分的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T04:09:18.223

使用[jQuery Ui Tabs](http://jqueryui.com/tabs/)和 [jQuery UI Accordion](http://jqueryui.com/accordion/)。

使用 jQuery UI 手风琴非常容易。

[jQuery UI 手风琴](http://jqueryui.com/accordion/)

[jQuery UI 选项卡](http://jqueryui.com/tabs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T02:43:18.377

您可以将数据存储在内存中（在变量或其他东西中），然后将点击事件绑定到更改 div 的函数吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T03:50:51.587

我同意 tvanfosson 并推荐 UI 选项卡或 AJAX 加载之类的东西，但如果你想看到一种非常基本的方式，你可以使用 jQuery 隐藏/显示来做到这一点：

[http://jsfiddle.net/ADDPH/7/](http://jsfiddle.net/ADDPH/7/)

HTML

```
<div id="container">
    <ul id="nav">
        <li><a href="#" class="index">Index</a></li>
        <li><a href="#" class="contact">Contact</a></li>
        <li><a href="#" class="other">Other</a></li>
    </ul>
    <div id="content">
        <div class="index hide">This is the home page.</div>
        <div class="contact hide" style="display:none;">This is my contact info.</div>
        <div class="other hide" style="display:none;">This is other stuff.</div>
    </div>
</div>​ 
```

jQuery

```
$("#nav a").click( function() {
    $(".hide").hide(); // hide other divs, marked with hide class
    var c = $(this).attr('class').split(' ')[0]; //Get First Class
    $("#content ."+c).show(); //show anything inside content div with the class c (marked with a . to represent class)
});​ 
```

# c# - 使用 linq to ef 加入 4 个表

> ID：13983586
> 
> 赞同：0
> 
> 时间：2012-12-21T02:42:18.687
> 
> 标签：c#, linq, entity-framework

我有四个表/类

```
public Class Brands
{
  public int Id {get;set;}
  public string Brand {get;set;}
  public String BrandType {get;set;}
}

public Class ManufactureA
{
  public int Id {get;set;}
  public int BrandsId {get;set;}
  public string Product {get;set;} 
  public int Distributor {get;set;}
}

public Class ManufactureB
{
  public int Id {get;set;}
  public int BrandsId {get;set;}
  public string Product {get;set;}
  public int Distributor {get;set;}
}

public Class ManufactureC
{
  public int Id {get;set}
  public int BrandsId {get;set;}
  public string Product {get;set;}
  public int Distributor {get;set;}
}

public Class ManufactureD
{
  public int Id {get;set;}
  public int BrandsId {get;set;}
  public string product {get;set;}
  public int Distributor {get;set;}
} 
```

我正在尝试制作一个表格，显示品牌及其相关制造商的信息。例如：

**品牌1：**

产品A，经销商A

**品牌2：**

产品B，分销商B

**品牌3：**

产品C、分销商C

**品牌4：**

产品D、分销商D

所以我从这段代码开始，但在决定如何实际分组或投影它时感到困惑：

```
var allBrandsManufactures = from brand in Brands
                            join factoryA in ManufactureA on factoryA.BrandsId equals brand.Id
                            join factoryB in ManufactureB on factoryB.BrandsId equals brand.Id
                            join factoryC in ManufactureC on factoryC.BrandsId equals brand.Id
                            join factoryD in ManufactureD on factoryD.BrandsId equals brand.Id 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T04:04:31.130

首先，如果可能，您应该真正考虑重做数据库设计。您的设计当前在表名中有信息。您应该能够将所有 Manufacture 表组合成一个可能应该称为 Products 的表。然后应该有一个额外的列来表明它是哪个制造商。像这样。

```
public class Products
{
  public int Id {get;set;}
  public int BrandsId {get;set;}
  public string ProductName {get;set;} 
  public int Distributor {get;set;}
  public string Manufacturer {get;set;}
} 
```

或者您可以创建一个单独的制造商表并通过外键将产品表链接到它，但这只有在您想要放入数据库中的其他制造商数据时才真正需要。然后，如果您获得新的制造商，则不必创建新表。它还使您的查询更容易。

现在，如果您坚持使用这种设计，那么您将想要进行联合而不是联接。最好的方法是将每个制造商查询分开，然后`Concat`将它们组合起来。

```
var brandA = from brand in Brands
         join factoryA in ManufactureA on brand.Id equals factoryA.BrandsId
         select new { 
            Brand = brand.Brand, 
            Product = factoryA.Product, 
            Distributor = factoryA.Distributor, 
            Manufacturer = "A"};

var brandB = from brand in Brands
         join factoryB in ManufactureA on brand.Id equals factoryB.BrandsId
         select new { 
            Brand = brand.Brand, 
            Product = factoryB.Product, 
            Distributor = factoryB.Distributor, 
            Manufacturer = "B"};

var brandC = from brand in Brands
         join factoryC in ManufactureA on brand.Id equals factoryC.BrandsId
         select new { 
            Brand = brand.Brand, 
            Product = factoryC.Product, 
            Distributor = factoryC.Distributor, 
            Manufacturer = "C"};

var brandD = from brand in Brands
         join factoryD in ManufactureA on brand.Id equals factoryD.BrandsId
         select new { 
            Brand = brand.Brand, 
            Product = factoryD.Product, 
            Distributor = factoryD.Distributor, 
            Manufacturer = "D"};

var result = brandA.Concat(brandB).Concat(brandC).Concat(brandD); 
```

您当然可以选择您想要的任何内容，但您必须在每个查询中选择相同的内容并为属性使用相同的名称。

# c++ - 通过函数返回枚举

> ID：13983587
> 
> 赞同：3
> 
> 时间：2012-12-21T02:42:27.343
> 
> 标签：c++, c++11, enums

我尝试对此进行研究，但可以找到适合我情况的解决方案。

所以我正在尝试为 mysql 字段的元数据制作一个基本的包装器：

```
#pragma once

#include <string>
#include <stdint.h>
#include <windows.h>
#include "mysql.h"

namespace escobar { namespace storage {

    class mysql_field_metadata
    {
    private:
        uint32_t result_index;          /* For indexing the field for a mysql record. */
        std::string name;               /* The name of the column. */
        std::string original_name;      /* The original name of the column, if the name is an alias. */
        std::string table;              /* Name of the table */
        std::string original_table;     /* The original name of the table, if the table name is an alias. */
        std::string database;           /* The name of the database the table/record belongs to. */
        uint32_t length;                /* The length of the field. */
        uint32_t max_length;            /* The maximum length of the set. */
        uint32_t decimals;              /* Number of decimals used in the field. */
        uint32_t charset;               /* Table charset. */
        enum enum_field_types type;     /* The type of MYSQL data. */

    public:
        mysql_field_metadata(MYSQL_FIELD* field_data, uint32_t _result_index) : 
            result_index(_result_index), name(field_data->name),
            original_name(field_data->org_name), table(field_data->table),
            original_table(field_data->org_table), database(field_data->db),
            length(field_data->length), max_length(field_data->max_length),
            decimals(field_data->decimals), charset(field_data->charsetnr),
            type(field_data->type)
        {
        }

        ~mysql_field_metadata(void) { }
        std::string get_name(void) { return this->name; }
        std::string get_original_name(void) { return this->original_name; }
        std::string get_table(void) { return this->original_name; }
        std::string get_original_table(void) { return this->original_table; }
        std::string get_database(void) { return this->database; }
        uint32_t get_length(void) { return this->length; }
        uint32_t get_max_length(void) { return this->max_length; }
        uint32_t get_decimals(void) { return this->decimals; }
        uint32_t get_charset(void) { return this->charset; }
        enum emum_field_types get_type(void) { return this->type; }
    };

}} 
```

如您所见，我的最后一个功能：

`enum emum_field_types get_type(void) { return this->type; }`

它似乎不起作用，我收到以下错误：

`error C2440: 'return' : cannot convert from 'enum_field_types' to 'escobar::storage::emum_field_types' 1> Conversion to enumeration type requires an explicit cast (static_cast, C-style cast or function-style cast)`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T02:44:42.327

您**不需要**在它前面加上`enum`. 您可以尝试将其从函数和成员中删除并报告回来。这可能会使编译器感到困惑。

```
enum_field_types type;     /* The type of MYSQL data. */
...
emum_field_types get_type(void) { 
```

编辑：要解决您的“标识符未声明”问题，`namespace::typename`如果它在命名空间中或`::typename`没有命名空间，请使用语法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T19:57:38.077

从编译器错误来看，似乎有两种不同的`enum_field_types`. 可能一个在您的命名空间内，一个是全局的。您有两种可能的解决方案：

1.  如果这两个声明都在您自己的代码中，您可以跟踪这两个声明并删除其中一个。

2.  您可以使用`namespace::typename`语法限定要使用的声明。

选择 1\. 应该是首选，因为对两个不同的声明使用相同的名称，尤其是当其中一个声明位于全局命名空间中时，可能会导致一些细微的错误和编译器错误。

# java - Java从浮点数转换为整数

> ID：13983593
> 
> 赞同：0
> 
> 时间：2012-12-21T02:43:54.413
> 
> 标签：java, casting

我有这个算法集（在我的脑海中），它需要我在一个循环中多次将 float 转换为 int （每 16 毫秒大约 300 次）。我的问题是这样的：

**在 java/android 中从 float 转换为 int 的过程有多昂贵，它会导致游戏变慢吗？**

我的游戏可以实现它是否足够便宜？如果没有，将十进制转换为整数的其他选项是什么？

编辑：**问题解决了！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:28:09.213

从 float 到 int 的转换不会比任何其他赋值语句花费更多。它由硬件处理。分配（取决于架构）通常花费一个周期或一次通过管道（非常非常快）。我不会担心这种转换对您的表现的影响。

# javascript - javascript 或 jquery 中的 CSS @media

> ID：13983596
> 
> 赞同：0
> 
> 时间：2012-12-21T02:44:00.933
> 
> 标签：javascript, jquery, css

我需要一点帮助。我在 html 和 css 中创建了一个导航菜单（带有特定的媒体查询），而我编写的 javascript (jquery) 代码如下所示：

```
var x = $('#nav-menu > ul').children().length;
alert(x);

$('#nav-menu > ul li').css(width, x); 
```

但是代码中的最后一行我想更改特定的媒体查询。

那可能吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T02:53:35.477

使用`.css`会创建一个内联样式，实际上并不会更改包含正在应用的规则的 CSS 文件。相反，创建一个类并在媒体查询中为您要更改的属性添加一个规则，并根据需要在 JavaScript 中使用`.addClass`和`removeClass`。

编辑：刚刚看到bergi的评论基本上是相同的想法。希望这有助于理解原因。

# php - 将 key=>value 数组的值插入 mysql 表（php）

> ID：13983598
> 
> 赞同：0
> 
> 时间：2012-12-21T02:44:12.967
> 
> 标签：php, mysql

我对 MySQL 非常陌生，我有两个数组，其输出如下所示：

```
Array
(
    [0] => Product/service
    [1] => Product/service
    [2] => Non-profit organization
    [3] => Community
    [4] => Company
    [5] => Non-profit organization
    [6] => Website
    [7] => Book
    [8] => Arts/humanities website
    [9] => Public figure
) 
```

我有一个表（带有变量名）和两个列名，上面的数组称为“类别”，我希望有一个表，其中有一个名为“类别”的列，它只会列出这些元素。我已经尝试了下面的代码，但它什么也没做：

```
mysql_connect('127.0.0.1','root','') or die(mysql_error());;
mysql_select_db("DBName") or die(mysql_error());;
mysql_query("CREATE TABLE `".$tablename."` ( category VARCHAR(30), name VARCHAR(30))");

foreach($category as $k=>$v)
{
    mysql_query("INSERT INTO".$tablename. "(category) VALUES".$v); 

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T05:44:44.817

我知道你是新人，所以让我看看能不能帮到你。有些人喜欢用他们的 php 进行创建，而我喜欢清晰简洁地了解正在发生的事情。

所以在这里试试这个：

```
foreach($categories as $key=>$val){

      $sql_I = "INSERT INTO categories SET category = '{$val}'";
      $res_I = mysql_query($sql_I) or die(mysql_error());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T02:49:30.460

你只需要更多的空白和一些额外的标点符号：

```
mysql_query('INSERT INTO '.$tablename. ' (category) VALUES ('.$v.')'); 
```

# objective-c - 警告：常量 8 与 XXXX 类型表达式的比较总是错误的

> ID：13983603
> 
> 赞同：8
> 
> 时间：2012-12-21T02:44:50.393
> 
> 标签：objective-c, comparison, warnings, asihttprequest, nsstream

我`ASIHTTPRequest`在我的项目中使用过，但在文件`ASIDataCompressor.m`行中`190`：

```
if ([inputStream streamStatus] == NSStreamEventErrorOccurred) {
        if (err) {
            *err = [NSError errorWithDomain:NetworkRequestErrorDomain code:ASICompressionError userInfo:[NSDictionary dictionaryWithObjectsAndKeys:[NSString stringWithFormat:@"Compression of %@ failed because we were unable to write to the destination data file at %@",sourcePath,destinationPath],NSLocalizedDescriptionKey,[outputStream streamError],NSUnderlyingErrorKey,nil]];
        }
        [compressor closeStream];
        return NO;
    } 
```

它警告我：

![警告](../Images/3311e90bb48b3bf2f885040ee5e0c0d0.png)

谁知道怎么修它？谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-21T02:49:20.800

`(NSStreamStatus)NSStreamEventErrorOccurred`

**编辑**

处理这个问题的正确方法可能是`NSStreamEventErrorOccurred`用`NSStreamStatusError`. 这可能是 ASIHTTP 的作者想要的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-21T02:49:52.330

`NSStreamEventErrorOccurred`是`NSStreamEvent`具有常数值的类型`8`。该`streamStatus`方法返回一个`NSStreamStatus`not`NSStreamEvent`并且`NSStreamStatus`值不超过一个值，`7`这就是您收到错误的原因。你很幸运 8 超出了界限并且你得到了一个错误，因为情况并非总是如此，因此，你应该始终小心返回类型。

# ruby-on-rails - FontAwesome 不显示字母“o”

> ID：13983605
> 
> 赞同：1
> 
> 时间：2012-12-21T02:44:51.933
> 
> 标签：ruby-on-rails, css, sass, webfonts

我正在尝试将[FontAwesome](http://fortawesome.github.com/Font-Awesome/)包含在我的项目中，但我无法让字母小“o”起作用，

我的字体-awesome.css.scss.erb

```
@font-face {
  font-family: "FontAwesome";
  src: url('<%= asset_path('fontawesome-webfont.eot') %>');
  src: url('<%= asset_path('fontawesome-webfont.eot') + '?#iefix' %>') format('eot'),              url('<%= asset_path('fontawesome-webfont.woff') %>') format('woff'), url('<%= asset_path('fontawesome-webfont.ttf') %>') format('truetype'), url('<%= asset_path('fontawesome-webfont.svg') + '#FontAwesome' %>') format('svg');
  font-weight: normal;
  font-style: normal;
}

// Other stuff,,,,,, 
```

我自己的CSS

```
 body {
   font-family: "FontAwesome"
 } 
```

发生的情况是文本变为某种衬线字体，所以有些东西正在改变，但不显示字母“o”，我尝试了各种宝石，但似乎都没有。

我还尝试了不同的浏览器（Chrome、FF、Safari）

作为操作系统，我使用 Lion 10.7.5

我还配置了资产路径。

![在此处输入图像描述](../Images/c2379730a459549bd393b9c30a9f25fc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:47:45.663

[FontAwesome](http://fortawesome.github.io/Font-Awesome/)要求您使用[`font-awesome.css`](https://github.com/FortAwesome/Font-Awesome/blob/master/css/font-awesome.css)样式表。

然后您将创建一个元素来使用字体，例如：

```
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet"/>

<i class="fa fa-download"> Download</i>
```

请参阅[*不使用 Boostrap？*](http://fortawesome.github.io/Font-Awesome/3.2.1/get-started/#not-using-bootstrap)¹在[http://fortawesome.github.io/Font-Awesome](http://fortawesome.github.io/Font-Awesome)获取方向

[1\. 这存在于旧 3.2.1 文档中。]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T02:47:37.780

你不应该使用 FontAwesome 作为你身体的字体。你会想把它限制在一个特定的类或类似的东西上。

# git - GitHub 推送只读

> ID：13983606
> 
> 赞同：1
> 
> 时间：2012-12-21T02:44:55.020
> 
> 标签：git, github

我是 Git 新手，所以我正在努力学习 git。同时，当我在 Git 上工作时，

> 错误：对用户名/file.git 的权限拒绝给 Username1。致命：无法从远程存储库中读取。

请确保您具有正确的访问权限并且存储库存在。

我遇到了这个错误。顺便说一句，文件是只读的。怎么推？

*   git clone git@github.com:username/file.git
*   git 添加文件.txt
*   混帐添加。
*   git commit -a -m "第二次提交"
*   git push git@github.com:username/file.git

顺便说一下 git config

```
[core]
repositoryformatversion = 0
filemode = true
bare = false
logallrefupdates = true
ignorecase = true
precomposeunicode = false
[remote "origin"]
url = git@github.com:username/files.git
fetch = +refs/heads/*:refs/remotes/origin/*
[branch "master"]
remote = origin
merge = refs/heads/master 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:06:46.180

If you want to clone other one's repo and make some contributions to it, you need to fork the repo as your own first. Push commits to your own repo and you can send a "Pull Request" to the original author then.

```
git clone git@github.com:username/file.git 
```

Here the `username` must be yours, or an org that you are in. Otherwise, you don't have the permission to update the repo.

* * *

B.t.w, a tip for you. You can

```
$ git remote add origin git@github.com:username/file.git
$ git push -u origin master 
```

Since then you can push it simply by

```
$ git push 
```

# c# - 需要将子窗体按钮点击统一到一个例程中

> ID：13983608
> 
> 赞同：2
> 
> 时间：2012-12-21T02:45:13.730
> 
> 标签：c#, winforms

我发现我开始对几个不同的点击事件使用相同的代码。我有一个 MDI 表单，并且有我称之为“主子”的“主子”，它们将打开与主关联的其他子。这是正在进行的主要/详细信息。一个例子是公司主子将有按钮来打开与公司关联的联系人、行业等。下面是打开 Contact 子窗体的代码示例。该代码也用于其他代码。

我想做的是能够只使用一个并填写按钮、表单、消息以及公司和联系人之间的连接标签。底部的代码是我到目前为止所拥有的，我用我正在寻找的内容标记了需要更改的行。带有单箭头的线条“似乎”可以工作，但多箭头线条却不能正确。出于比较的原因提供两者。

有人可以看看这个/这些，看看我在合并代码中做错了什么（或遗漏）吗？

谢谢...约翰

//打开联系表格的代码

```
 private void btnCompanyContact_Click(object sender, EventArgs e)
    {
        bool isOpen = false;

        foreach (Form f in Application.OpenForms)
        {
            if (f is frmContact)
            {
                isOpen = true;
                MessageBox.Show("The Contact list is already open.", "INFORMATION", MessageBoxButtons.OK);
                f.BringToFront();
                f.Controls["lblRecordID"].Text = lblCompanyID.Text;
                break;
            }
        }

        if (!isOpen)
        {
            frmContact contact = new frmContact();
            contact.MdiParent = this.MdiParent;
            contact.ReceiveValue(lblCompanyID.Text);
            contact.StartPosition = FormStartPosition.Manual;
            contact.Location = new Point(100, 100);
            contact.Show();
        }

        else
        {
            //do nothing
        }
    } 
```

//将所有打开的按钮合并到此例程中

```
 private void OpenCompanyInformationForm(Button btn, Form name, string message, string lbl)
    {
        bool isOpen = false;

        foreach (Form f in Application.OpenForms)
        {
  ->        if (f == name)
            {
                isOpen = true;
  ->            MessageBox.Show("The " + message + " list is already open.", "INFORMATION", MessageBoxButtons.OK);
                f.BringToFront();
  ->            f.Controls[lbl].Text = lblCompanyID.Text;
                break;
            }
        }

        if (!isOpen)
        {
   ->->->   frmContact contact = new frmContact();
            contact.MdiParent = this.MdiParent;
            contact.ReceiveValue(lblCompanyID.Text);
            contact.StartPosition = FormStartPosition.Manual;
            contact.Location = new Point(100, 100);
            contact.Show();
        }

        else
        {
            //do nothing
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T13:14:15.080

要执行自定义函数 ReceiveValue，您需要从 Form 创建一个派生类，并从该派生类创建所有表单

```
public class ContactBase : Form
{

    public void ReceiveValue(string p_Value)
    {
        Button button = (Button)this.Controls["lblRecordID"];
        if (button == null) return;
        button.Text = p_Value;
    }

}

private void OpenCompanyInformationForm(Form name)
    {
        bool isOpen = false;

        foreach (Form f in Application.OpenForms)
        {
            // Just to compare, you can use the Name property
  ->        if (f.Name == name.Name)
            {
                isOpen = true;
                // If the message is just a name of form, you can use Name or Text property
                // in this case you can supress message param
  ->            MessageBox.Show("The " + f.Text + " list is already open.", "INFORMATION", MessageBoxButtons.OK);
                f.BringToFront();
                // If the ReceiveValue is just to pass the text of lblCompanyID for lblRecordID button, you can use the function here
  ->            ((ContactBase)name).ReceiveValue(lblCompanyID.Text);
                break;
            }
        }

        if (!isOpen)
        {
   ->->->   ContactBase contact = (ContactBase)Activator.CreateInstance(name.GetType());
            contact.MdiParent = this.MdiParent;
            contact.ReceiveValue(lblCompanyID.Text);
            contact.StartPosition = FormStartPosition.Manual;
            contact.Location = new Point(100, 100);
            contact.Show();
        }

        else
        {
            //do nothing
        }
    } 
```

# c++ - 多线程情况下如何安全访问struct字段？

> ID：13983616
> 
> 赞同：0
> 
> 时间：2012-12-21T02:45:52.997
> 
> 标签：c++, multithreading

我有一个名为的结构的图像

```
struct _Visitors{
    int totalNum;
    map<uintptr_t, Visitor*> visitorMap;
}; 
```

请注意，Visitor 是一个 c++ 类

然后我声明一个指向 struct _visitors 实例的指针，即

```
struct _Visitors* pVisitors = NULL; 
```

现在我有三个线程：一个主线程 t1，两个工作线程 t2 和 t3。

t1 是这样的：

pVisitors = new _visitors();

t2 是这样的：

```
while(true){
     if a new visitor v enters
        //pthread_mutex_lock(mtx);
        pVisitors->totalNum++;
        visitorMap[v.getVid()] = &v;
        //pthread_mutex_unlock(mtx);
  } 
```

t3 是这样的：

```
 while(true){
     if a new visitor v leaves
        //pthread_mutex_lock(mtx);
        pVisitors->totalNum--;
        visitorMap.eraseAt[v.getVid()];
        //pthread_mutex_unlock(mtx);
  } 
```

我知道线程 t1 和 t2 可能在 struct _Visitor 的全局实例上存在数据竞争，所以我添加了一个独占锁（互斥锁）来保护 struct _visitors 中的 totalNum 和 visitorMap 字段。

现在我的问题是：添加一个独占锁来保护 struct _Visitors 中的字段就足够了吗？如果在具有多个处理器的 SMP 架构上执行，是否可以确保我的程序在任何情况下都不会遇到数据竞争？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:04:41.843

如果您的数据受到互斥锁的适当保护，我看不出有任何理由说明您会出现数据竞争、SMP 架构与否。

尽管如此，如果您对如何管理互斥体有任何疑问，请不要犹豫，使用 valgrind 执行您的程序，它能够检测并警告您数据竞争。

# user-interface - Any reference resource for programming language UI experience?

> ID：13983617
> 
> 赞同：1
> 
> 时间：2012-12-21T02:46:05.707
> 
> 标签：user-interface, programming-languages

Programming languages let their users feel terrible or smooth just like GUI designing does. When it comes with bad syntax features, users endure it with twitching fingers and eyes. And such issues already wasted a lot of time and other resources due to wars between language's fans and opponents ( ex: "goto considered harmful", "Node.js is cancer" ... ).

I wonder why UI designing at least became a researching target and own some stable standard like the distance between of user's mouse and the target component while languages didn't. I know some issues related to semantics, not only syntax. But I seriously feel these arguments should be formalized by some strong enough standards.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-25T05:33:16.013

剑桥似乎有一门名为“编程语言的可用性”的课程可以解决这个确切的问题。

从[2015-16 课程页面](http://www.cl.cam.ac.uk/teaching/1516/P201/)：

> 编程语言本质上是人与计算机之间进行交流的一种手段。传统的计算机科学研究对通信链路的机器端进行了大量的研究，但缺乏了解链路的人端的知识和研究方法。本课程提供在这一重要领域取得进展所必需的实用研究技能。

同一页列出了以下推荐阅读：

> *   [编程兴趣组心理学在线会议记录](http://www.ppig.org/)
> *   [剑桥技术研究人类参与者指南](http://bit.ly/hptps-guide)
> *   Cairns, P. 和 Cox, AL (2008) 人机交互研究方法。剑桥大学出版社。
> *   [Hoc, JM, Green, TRG, Samurcay, R 和 Gilmore, DJ (Eds.) (1990) 编程心理学。学术出版社。](http://www.cl.cam.ac.uk/teaching/1011/R201/ppig-book/)
> *   卡罗尔，JM（编辑）（2003 年）。HCI 模型、理论和框架：迈向多学科科学。摩根考夫曼。

2015 年的讲义似乎是一个很好的起点：[http ://www.cl.cam.ac.uk/teaching/1415/P201/p201-lecturenotes-2015.pdf](http://www.cl.cam.ac.uk/teaching/1415/P201/p201-lecturenotes-2015.pdf)

# c# - SurfaceScrollViewer position is not updating when ScrollToHorizontalOffset is called

> ID：13983619
> 
> 赞同：1
> 
> 时间：2012-12-21T02:46:07.663
> 
> 标签：c#, wpf, xaml, pixelsense

I am building an interactive campus map for a university on the Microsoft Surface 1.0 technology... I am working in WPF and C# with the Surface 1.0 SDK... I have dropped a large image into a `SurfaceScrollViewer` and there are various Canvas Elements that represent the buildings... There is another item that uses a selector to automatically move that building to the center of the screen.... I need to "Automatically" move the building on the map to the center of the screen when its name is pressed....

I am currently attempting to use: `ScrollToVerticalOffset()` and `ScrollToHorizontalOffset()` to move the `SurfaceScrollViewer` to the appropriate location. However the `SurfaceScrollViewer` never updates. I have searched and tried about three hundred different ways to do this but to no avail. Any suggestions upon how to achieve this would be great!

# python - What is a Pythonic way to count dictionary values in list of dictionaries

> ID：13983620
> 
> 赞同：1
> 
> 时间：2012-12-21T02:46:19.877
> 
> 标签：python, list, dictionary

For a list like this:

```
for i in range(100):
    things.append({'count':1})

for i in range(100):
    things.append({'count':2}) 
```

To count the number of `1` in list:

```
len([i['count'] for i in things if i['count'] == 1]) 
```

What is a better way?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T02:50:56.367

[集合.计数器](http://docs.python.org/2/library/collections.html#collections.Counter)

```
>>> from collections import Counter
>>> c = Counter([thing['count'] for thing in things])
>>> c[1]               # Number of elements with count==1
100
>>> c[2]               # Number of elements with count==2
100
>>> c.most_common()    # Most common elements
[(1, 100), (2, 100)]
>>> sum(c.values())    # Number of elements
200
>>> list(c)            # List of unique counts
[1, 2]
>>> dict(c)            # Converted to a dict 
{1: 100, 2: 100} 
```

* * *

也许你可以做这样的事情？

```
class DictCounter(object):
    def __init__(self, list_of_ds):
        for k,v in list_of_ds[0].items():
            self.__dict__[k] = collections.Counter([d[k] for d in list_of_ds])

>>> new_things = [{'test': 1, 'count': 1} for i in range(10)]
>>> for i in new_things[0:5]: i['count']=2

>>> d = DictCounter(new_things)
>>> d.count
Counter({1: 5, 2: 5})
>>> d.test
Counter({1: 10}) 
```

扩展 DictCounter 以处理丢失的键：

```
>>> class DictCounter(object):
    def __init__(self, list_of_ds):
        keys = set(itertools.chain(*(i.keys() for i in list_of_ds)))
        for k in keys:
            self.__dict__[k] = collections.Counter([d.get(k) for d in list_of_ds])

>>> a = [{'test': 5, 'count': 4}, {'test': 3, 'other': 5}, {'test':3}, {'test':5}]
>>> d = DictCounter(a)
>>> d.test
Counter({3: 2, 5: 2})
>>> d.count
Counter({None: 3, 4: 1})
>>> d.other
Counter({None: 3, 5: 1}) 
```

# python - 包含已编译和解释代码的“混合”Python 模块的示例？

> ID：13983629
> 
> 赞同：1
> 
> 时间：2012-12-21T02:47:56.383
> 
> 标签：python

你能推荐一个结构良好的 Python 模块，它结合了编译的 C 代码（例如使用 distutils）和解释的源代码吗？我收集到“包”可以汇总解释模块和编译模块，但如果可以将编译和解释源合并到一个模块中，我会不知所措。这样的事情存在吗？

如果不是，那么正确的事情 (TM) 是否有一个包含`from-import`从分离的编译和解释子模块加载公共符号的语句的包？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:01:29.747

一个模块不能同时包含 Python 和 C。每个 .py 文件都是一个模块，而 C 文件被编译并构建为 .so 或 .pyd 文件，每个文件都是一个模块。您可以将编译后的模块导入 Python 文件并一起使用。

如果你想要一些超简单的例子，你可能会喜欢[A Whirlwind Excursion through Python C Extensions](http://nedbatchelder.com/text/whirlext.html)。

# php - 输出自定义错误消息而不是默认的 php 错误消息

> ID：13983634
> 
> 赞同：2
> 
> 时间：2012-12-21T02:48:19.270
> 
> 标签：php

我在我的程序的一部分中使用 PHP 复制函数，其中函数的参数取决于用户输入。如果默认的 php 错误消息包含函数无法使用的路径，我会尝试避免它们，并输出如下所示的自定义消息。我是处理错误/异常的新手。我仍然收到 php 默认错误消息，而不是自定义的“路径不正确！” 使用下面的方法。

我尝试了什么：

```
try{
    copy($webImagePath, $destinationPath);
 }
 catch(Exception $e){
    echo 'Path was incorrect!';
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:00:44.837

考虑`set_error_handler`： http: [//php.net/manual/en/function.set-error-handler.php](http://php.net/manual/en/function.set-error-handler.php)

例子：

```
set_error_handler("someFunction");

function someFunction($errno, $errstr) {
    output details and information
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:15:11.847

您应该使用您希望显示的自定义消息引发异常。您可以通过在单个语句前面加上“@”符号来抑制默认的 PHP 错误消息。或者您可以更改每页的 error_reporting 级别（查看此链接了解更多详细信息：http: [//php.net/manual/en/function.error-reporting.php](http://php.net/manual/en/function.error-reporting.php)

还要检查以下代码片段

```
$file='example.txt';          //replace the file name with your URL
$newfile = 'example.txt.bak';
try{
  $ret=@copy($file, $newfile);
  if (!$ret){
    throw new Exception("File path doesn't exist..");
  }
}
catch(Exception $e){
echo $e->getMessage();
} 
```

# internet-explorer-9 - IE9 boxshadow 错误

> ID：13983648
> 
> 赞同：2
> 
> 时间：2012-12-21T02:50:14.557
> 
> 标签：internet-explorer-9, css

我发现如果你调整 div 的大小，阴影会保持在原来的位置。我单击按钮使子 div 更改高度，并且父级也更改高度，但阴影没有删除。

```
<script type="text/javascript">
    $(function () {
        // change width
        $('#btn1').toggle(function () {
            $('#div1').height(100);
        },
        function () {
            $('#div1').height(200);
        });
    });
</script>

 <style type="text/css">
    #div1
    {
        height: 200px;
    }
    #div2
    {
        width: 200px;
        box-shadow: 2px 2px 8px #000000;
        position: absolute;
        left: 200px;
        top: 200px;
    }
</style>

<body>
   <div id="div2">
    <div id="div1">
        <input type="button" id="btn1" value="test" />
    </div>
</div> 
```

[http://jsfiddle.net/edward44444/v2NmD/1/](http://jsfiddle.net/edward44444/v2NmD/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T11:14:01.883

直截了当的解决方法是在设置高度之前以及在设置高度时移除阴影：

CSS：

```
#div2.noshadow {
    box-shadow: none;
} 
```

JS：

```
$(function() {
    $('#btn1').toggle(function() {
        $('#div2').addClass('noshadow');
        $('#div1').height(100);
        $('#div2').removeClass('noshadow');
    }, function() {
        $('#div1').height(200);
    });
}); 
```

[http://jsfiddle.net/v2NmD/32/](http://jsfiddle.net/v2NmD/32/)

# php - Vim for PHP 开发：PHP 文档、手册、内置函数补全

> ID：13983659
> 
> 赞同：3
> 
> 时间：2012-12-21T02:52:25.317
> 
> 标签：php, vim

我已经将我的 vim 配置为使用 PHP，但是在 Google 上搜索后我无法解决一些问题：

*   首先，关于 PHP Documentor，我找到了 php-doc vim 插件，但我无法在我的代码中使用它，它只是向我显示了一个没有任何内容的 doc 块。

例子：

```
public function set($key, $value)
{
} 
```

当我尝试运行 php-doc 时（通过我配置的热键：cp）

```
/**
 *
 **/
public function set($key, $value)
{
} 
```

我期待这样的事情：

```
/**
 * 
 * 
 * @param unknown Some thing about parameter 
 * @param unknown Some thing about parameter 
 * @return void
 **/
public function set($key, $value)
{
} 
```

*   其次，我生成了一些标签（使用 ctags）用于使用 vim 开发 Zend 框架，但之后我没有任何完成 php 内置函数（使用omni 和 phpcomplete vim 插件，： http: [//www.vim.org/ scripts/script.php?script_id=3171](http://www.vim.org/scripts/script.php?script_id=3171)我已将语法更改为 5.3 使用的 PHP 语法（php.vim：[http](http://www.vim.org/scripts/script.php?script_id=2874) ://www.vim.org/scripts/script.php?script_id=2874 ）

*   第三，我希望我的 vim php 对 buitin 函数或带有文档的函数有建议，当我键入函数时，它可能会建议需要提供哪个参数，函数的作用是什么？像这样在 python 中：[http ://blog.dispatched.ch/wp-content/uploads/2009/05/omnicompletion.png](http://blog.dispatched.ch/wp-content/uploads/2009/05/omnicompletion.png)

我如何配置 vim 来满足这些需求，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-23T23:31:32.560

*   (1) 我没有看过 vim-doc 插件，但为了概念证明，请参阅`ClassHeader`foo.vim 中的函数和自动命令：http: [//www.vim.org/scripts/script.php? script_id=72](http://www.vim.org/scripts/script.php?script_id=72)

*   (2, 3) 我使用标准发行版附带的语法和 ftplugin 文件完成了内置函数和标签文件中的任何内容。尽管我仍在使用 vim 7.3，但我的语法文件比您提到的要更新。如果有多个匹配项，则函数签名将显示在预览窗口中；你想要更多的建议吗？例如，请参见[https://drupal.org/project/vimrc](https://drupal.org/project/vimrc)的屏幕截图。

# session - RavenDB Service Session.Query 不返回结果

> ID：13983661
> 
> 赞同：2
> 
> 时间：2012-12-21T02:52:30.283
> 
> 标签：session, oauth, ravendb

我在 localhost:8080 上设置了一个 RavenDB 服务实例，并且正在使用 OAuth 插件来存储一个简单的用户文档以进行身份​​验证。我使用 guid 作为 id 和用户电子邮件作为名称。以下代码正常运行以存储用户

```
public AccountUserDocument CreateUser(RegisterModel model)
{
    using (IDocumentSession session = DataDocumentStore.Instance.OpenSession())
    {
        Guid userId = Guid.NewGuid();

        session.Store(new AccountUserDocument
            {
                Name = model.Email,
                Id = String.Format("Raven/Users/{0}", userId),
                AllowedDatabases = new[] { "*" },

                Email = model.Email,
                FirstName = model.FirstName,
                LastName = model.LastName,
                FacebookId = 0,
                Expires = DateTime.Now.AddMonths(1),
                AccessToken = string.Empty

            }.SetPassword(model.Password));

        session.SaveChanges();

        return session.Load<AccountUserDocument>
                       (String.Format("Raven/Users/{0}", userId));
    }
} 
```

并返回一个有效的用户对象。但是，当我打电话时

```
return session.Query<AccountUserDocument>()
              .Customize(x => x.WaitForNonStaleResults())
              .Where(x => x.Name == email)
              .SingleOrDefault(); 
```

我什么都得不到。一周前它一直在工作，但现在它没有了。如果我打开 RavenDB 工作室，我可以看到用户和名称正是我输入的方式（我什至将其复制并粘贴到文本字段中）。

![在此处输入图像描述](../Images/7b8263a8f7feb9ce81f630b8e9026502.png)

我曾尝试停止并重新启动服务，希望能解决问题，但没有。

我想知道是否有人可以指出我如何调试这里发生的事情的方向。完整的代码存储库可以在这里找到

[https://github.com/jamesamuir/MVC_Facebook_Auth](https://github.com/jamesamuir/MVC_Facebook_Auth)

如果有人愿意下载它。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:39:24.470

好吧，我发现您提供的代码示例有很多问题 - 例如客户端和服务器的版本不匹配。此外，Authentication Bundle 是 1.0 的一项功能，已在 2.0 中弃用，几乎是最终版本，因此您正在编写最终必须替换的代码。

但要回答您的问题，您无法从查询中获得结果的具体原因是您选择使用以“Raven/”开头的文档键，这是 RavenDB 系统文档的约定 - 不会被索引.

如果您从您的 id 中删除“Raven/”，它将起作用。

此外，您不应该使用`.WaitForNonStaleResults()`- 这仅用于单元测试，并且在生产中很危险。如果您真的觉得需要等待，请使用`.WaitForNonStaleResultsAsOfNow()`- 更安全，因为它提供了一个截止点。

# javascript - 从字符串解析 GET 参数的 Javascript - 是什么导致了这个问题？

> ID：13983666
> 
> 赞同：0
> 
> 时间：2012-12-21T02:53:01.220
> 
> 标签：javascript, query-string

我一直在使用以下函数从当前 url 获取常规参数：

```
function getURLParameter(name) {
    return decodeURI(
        (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
    );
} 
```

但是，我想从遵循[此处](http://www.google.com/imgres?um=1&hl=en&safe=off&client=ubuntu&sa=N&tbo=d&channel=fs&biw=1854&bih=962&tbm=isch&tbnid=Lfj0vtCQt7S_YM%3a&imgrefurl=http://beautiful-pics.org/wayne-rooney/&docid=ZFU0V885e5LlqM&imgurl=http://beautiful-pics.org/wp-content/uploads/2011/12/Wayne_Rooney_4.jpg&w=415&h=512&ei=783TULHIA6Wp2gX154HgBQ&zoom=1)url 格式的字符串中获取 GET 参数“imgurl” 。

当我更改该函数以处理常规字符串时：

```
function getURLParameter(name, givenstring) {
    return decodeURI(
        (RegExp(name + '=' + '(.+?)(&|$)').exec(givenstring.search)||[,null])[1]
    );
} 
```

它返回空值。我什至做了一个用户脚本转到我刚刚给你的 url，我使用第一个函数来尝试获取那个 'imgurl' 参数，但它无法这样做。我也去掉了那个 url 中的冒号，但显然这什么也没做。

是什么让这个字符串格式的这个函数失效了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T02:56:22.967

`location.search`是当前 URL 的查询字符串部分。如果您想用任意字符串变量替换它`givenstring`，那么您将替换`location.search`为`givenstring`，而*不是*`givenstring.search`。所以：

```
function getURLParameter(name, givenstring) {
    return decodeURI(
        (RegExp(name + '=' + '(.+?)(&|$)').exec(givenstring)||[,null])[1]
    );
} 
```

顺便说一句，如果（例如）字符串是`foobar=baz&bar=bip`并且感兴趣的参数是，您的函数将出现异常`bar`。它将找到 的第一个实例`bar=...`，在本例中是`bar=baz`而不是`bar=bip`。您可以使用以下方法解决此问题`(^|&)`：

```
function getURLParameter(name, givenstring) {
    return decodeURI(
        (RegExp('(^|&)' + name + '=(.+?)(&|$)').exec(givenstring)||[,,null])[2]
    );
} 
```

（如果你的函数中有任何特殊字符——无论是 URL 中的特殊字符还是正则表达式中的特殊字符——你的函数也会出现异常行为`name`——但我猜你有足够的控制权`name`来确保这不会成为问题？）

# java - 尝试从 Java 中的 Hibernate 获取列名时为什么会收到错误消息？

> ID：13983671
> 
> 赞同：0
> 
> 时间：2012-12-21T02:53:35.413
> 
> 标签：java, hibernate, names

我试图从 Java 中的 Hibernate 查询中获取列名，我在网上做了一些搜索并找到了解决方案，但是当我尝试代码时，它给了我错误消息：

```
 private void executeHQLQuery(String hql,String ActionCommand)
  {
    try
    {
      Session session=HibernateUtil.getSession();
      session.beginTransaction();
      Query q=session.createQuery(hql);

      AliasToEntityMapResultTransformer INSTANCE=new AliasToEntityMapResultTransformer();
      q.setResultTransformer(INSTANCE);
//    q.setResultTransformer(AliasToEntityMapResultTransformer.INSTANCE);
      List<Map<String,Object>> aliasToValueMapList=q.list();

      for (Map<String,Object> map : aliasToValueMapList)
        for (Map.Entry<String,Object> entry : map.entrySet()) System.out.println(entry.getKey()+" - "+entry.getValue());

      List resultList=q.list();

      displayResult(resultList,ActionCommand);
      session.getTransaction().commit();
    }
    catch (HibernateException he) { he.printStackTrace(); }
  } 
```

错误消息指向以下行：`for (Map<String,Object> map : aliasToValueMapList)`

它说：“线程中的异常“AWT-EventQueue-0”java.lang.ClassCastException：sakila.entity.Actor 无法转换为 java.util.Map”，为什么？如何解决？

在我的情况下，如何将 aliasToValueMapList 作为 EntityBeans 列表循环并获取每个项目的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T04:48:47.957

我认为您的查询返回 EntityBeans 列表，并且转换不能应用于它们。也许[这篇](http://relation.to/2133.lace)文章会对你有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T05:01:01.530

使用 `query.setResultTransforer()`将设置结果的形状。

您分配的 Result 应该是 type`AliasToEntityMapResultTransformer`和 cast to `Map`。

所以它是扔的`ClassCastException`。

它返回类型的结果`AliasToEntityMapResultTransformer`。

希望这可以帮助 ：）

参考：[查询](http://docs.jboss.org/hibernate/orm/3.3/api/org/hibernate/Query.html#setResultTransformer%28org.hibernate.transform.ResultTransformer%29)

# objective-c - NSURL - 没有可变的子类，所以不需要“复制”作为属性？

> ID：13983673
> 
> 赞同：10
> 
> 时间：2012-12-21T02:54:13.450
> 
> 标签：objective-c, foundation

```
@interface SomeClass : NSObject

@property (copy,   nonatomic) NSString *usefulString;
@property (strong, nonatomic) NSString *dangerousString;

@property (copy,   nonatomic) NSURL *curiousURLOne;
@property (strong, nonatomic) NSURL *curiousURLTwo;

@end 
```

在上面的类中，`dangerousString`被认为是一个坏主意，因为`NSMutableString`继承自`NSString`. 这意味着您的类的用户可能会将可变字符串设置为`dangerousString`，然后稍后将可变字符串的值从`SomeClass`. 该属性`usefulString`没有这种危险，因为它将值复制到一个新的（不可变的）字符串对象中。

`NSURL`但是，对于（以及任何其他没有可变对应物的基础类 - 例如`NSNumber`），属性声明的复制语义似乎是不必要的。`NSURL`确实符合 NSCopying 的`copyWithZone:` *（......但我不得不怀疑它是否不只是返回相同的对象并增加了保留计数 - 为什么它会做其他任何事情？）*

你为什么要声明`copy`没有变异危险的属性？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-02-26T18:12:40.213

在 iOS7 中你可以使用 NSURLComponents，现在它很简单，看这个例子：

```
NSString *urlString = @"https://mail.google.com/mail/u/0/?shva=1#inbox";
NSURLComponents *components = [[NSURLComponents alloc] initWithString:urlString];

NSLog(@"%@ - %@ - %@ - %@", components.scheme, components.host, components.query, components.fragment);

NSURLComponents *components = [NSURLComponents new];
[components setScheme:@"https"];
[components setHost:@"mail.google.com"];
[components setQuery:@"shva=1"];
[components setFragment:@"inbox"];
[components setPath:@"/mail/u/0/"];

[webview loadRequest:[[NSURLRequest alloc] initWithURL:[components URL]]]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-21T03:02:28.967

Apple 不提供可变子类这一事实并不意味着恶意用户无法专门构建一个来欺骗您的类。如果您在假设字符串可以在您的类的背后更改的假设下操作，您至少需要允许恶意用户扩展`NSURL`到可变类的可能性：

```
@interface TrickThemURL : NSURL
    // override key properties, such as baseURL and host, to be mutable
@end 
```

如果程序员给了你一个对象，`TrickThemURL`而你在验证之前没有复制它，那么程序员现在可以自由地更改 URL 而不会让你的类知道。

# python - 如何将数据从 Django 数据库调用到模板（html）？

> ID：13983677
> 
> 赞同：0
> 
> 时间：2012-12-21T02:54:36.117
> 
> 标签：python, django, django-cms

**如何从数据库 django 中检索数据。我有这样的models.py：**

```
from cms.models.pluginmodel import CMSPlugin
from django.db import models

class Category(CMSPlugin):
    name = models.CharField(max_length=50)

    def __unicode__(self):
        return self.name 
```

**和文件 cmsplugins.py 像这样：**

```
from cms.plugin_base import CMSPluginBase
from cms.plugin_pool import plugin_pool
from django.utils.translation import ugettext_lazy as _

from models import Category

class CategoryPlugin(CMSPluginBase):
    model = Category
    name = _("Category Plugin")
    render_template = "about.html"

    def render(self, context, instance, placeholder):
        context['instance'] = instance
        return context

plugin_pool.register_plugin(CategoryPlugin) 
```

**如何检索要在 html 中显示的名称列表**？之前谢谢^^

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T04:07:00.970

在 Django 中，您应该将工作分为 3 个部分。

*   模型：您所有的数据库模型和逻辑都位于它之下。
*   模板：通过传递尽可能少的相关数据进行渲染来放置标记。
*   路由（视图）：您的 URL 映射到 urls.py 中的这些方法，它们调用模型并将处理后的数据进一步传递给模板以进行渲染。

关注@jdotjdot 在评论中给出的[链接。](https://docs.djangoproject.com/en/dev/intro/tutorial03/)这就是它在 Django 中完成的方式。

# c - IPC 在 Unix 中使用优先级队列？

> ID：13983679
> 
> 赞同：1
> 
> 时间：2012-12-21T02:54:41.610
> 
> 标签：c, unix

有没有办法使用优先队列在 C 中实现 IPC？我需要将一个结构从一个进程发送到另一个进程，但我想为每个结构分配一个优先级，以便另一个进程首先接收更高优先级的结构。类似于 FIFO 的东西，但具有优先级。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:01:33.927

[POSIX 消息队列](http://www.users.pjwstk.edu.pl/~jms/qnx/help/watcom/clibref/mq_overview.html)和 SysV 消息队列都可以处理优先级。POSIX 队列将始终在读取时返回最高优先级的最旧消息。SysV 队列返回一条消息，该消息具有读取时指定的任何（指定）优先级。

# c++ - 来自 QDateTime 的 QT 的 fromTime_t 不起作用

> ID：13983683
> 
> 赞同：4
> 
> 时间：2012-12-21T02:54:59.800
> 
> 标签：c++, qt

我尝试使用 QDateTime 的 fromTime_t 如下：

```
QDateTime t;
time_t elapsedTime;
t.fromTime_t(elapsedTime); 
```

结果是没有为 QDateTime 对象分配任何内容。但是，使用函数 setTime_t 确实有效（这不是静态的）。我错过了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T03:21:29.303

`fromTime_t`是静态的并返回 a `QDateTime`，所以你必须像这样使用它：

```
 time_t elapsedTime;
    QDateTime t(QDateTime::fromTime_t(elapsedTime)); 
```

或者你可以做

```
 time_t elapsedTime;
    QDateTime t;
    t.setTime_t(elapsedTime); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T03:21:20.570

您的代码没有正确使用静态函数。试试这个：

```
time_t elapsedTime;
...
QDateTime t = QDateTime::fromTime_t(elapsedTime); 
```

# javascript - javascript函数上奇怪的chrome行为来调整div的大小

> ID：13983686
> 
> 赞同：2
> 
> 时间：2012-12-21T02:55:57.133
> 
> 标签：javascript, html, css, google-chrome, webkit

我编写了一个脚本来调整 div 的大小，相对于另一个 div 的高度加上 70px （这是边距（顶部和底部）的大小）的大小，并将其加载到 window.onload 函数中。

```
 <script language="JavaScript">
        function tamanho_wrapper2(){
            var mydiv = document.getElementById("topicos");
            var current_height = parseInt(mydiv.offsetHeight);
            var wrapper2 = document.getElementById("wrapper2");
            wrapper2.style.height = current_height+70+"px";

        }
    </script> 
```

它在 Firefox 上工作，div 正是我想要的样子。但是在 chrome 上，在第一页的加载中，它在我得到高度的 div 的高度中包括底部和顶部边距的大小，所以 div 变得比我想要的大。奇怪的是，当页面重新加载时，chrome 只计算 div 的自身高度，作为 firefox。它已经发生在你身上了吗？

**编辑：**嗯，我最后得出的结论是，老事实：浏览器的引擎工作方式不同，而发生在我身上的事情就是一个证明。谢谢你们的关注。

**Edit2：**神奇地，浏览器的奇怪行为停止发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T17:03:53.450

尝试重置您的样式表（上面的链接）。所有浏览器对每个元素都有自己的默认样式，也许 Chrome 正在将其默认样式添加到您的 div 中，其他浏览器也可能以不同的方式显示它。

[http://meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

PS：对不起，我的英语有时更差：P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T13:47:35.347

我不确定为什么您的 javascript 在 Chrome 中不起作用，我觉得它很合适。你试过用jquery吗？我刚刚测试了这个 i chrome 并没有任何不利影响。我希望它有帮助:)

```
<div id="div1" style="background-color:#ff0000; height:50px; width:10px; float:left;"></div>

<div id="div2" style="background-color:#00ff00; height:150px; width:10px; float:left;"></div>

<input type="button" value="resize" onclick="resizeDiv();" /> 
```

然后这个jquery代码：

```
function resizeDiv(){
$('#div1').css('height', $('#div2').css('height'));
} 
```

# macos - 使用 NSOpenPanel 获取文件夹位置删除文件：// localhost

> ID：13983688
> 
> 赞同：2
> 
> 时间：2012-12-21T02:56:03.140
> 
> 标签：macos, cocoa, nsopenpanel

我正在使用 NSOpenPanel 在我的应用程序上设置一个文件夹，但我将其作为文件夹“file://localhost/Users/juan/”的路径

这是我的代码：

```
 NSOpenPanel * setDirectory = [NSOpenPanel openPanel];
    setDirectory.canChooseFiles=NO;
    setDirectory.canCreateDirectories=YES;
    setDirectory.canChooseDirectories=YES;
    setDirectory.directoryURL=_path;
    [setDirectory beginSheetModalForWindow:self.window completionHandler:^(NSInteger result) {
        NSLog(@" results %ld", result);
        if (NSFileHandlingPanelCancelButton){
            NSLog(@"cancel");

        }
        if (NSFileHandlingPanelOKButton) {

            self.path = [[setDirectory URLs] objectAtIndex:0];

        }

    }];
} 
```

我的问题是如何或我需要做什么来获得绝对路径，例如“/Users/juan/Desktop/”而没有文件：// localhost。

我真的很感激任何指示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T03:17:59.953

为此，请调用对象的`path`方法`NSURL`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T19:35:47.100

我发现了我正在使用的问题`[bitmapData writeToFile:nameandPath atomically:YES];`，它给了我一个错误。
我切换到`[bitmapData writeToURL:nameandPath atomically:YES];`并且一切正常。

# javascript - 在 JSON 中查找给定键的值并使用 javascript 更改值

> ID：13983694
> 
> 赞同：2
> 
> 时间：2012-12-21T02:56:48.130
> 
> 标签：javascript, json

我正在寻找一个函数，它可以根据一个键查找一个值并将该值替换为另一个值。键是 JSON 起始节点的树。这是示例。

```
var myData = {
    name : 'Dan',
    address: {
        city : 'Santa Clara',
                details : {
                   'prevhouse' : ''
                }
    }
} 
```

该函数的输入是一个密钥树。例如，myData-address-details-prevhouse

当我用一个新值传递这个键时，比如'Texas'，prevhouse 值将更改为我发送的新值。

新的 JSON 将是

```
var myData = {
    name : 'Dan',
    address: {
        city : 'Santa Clara',
                details : {
                   'prevhouse' : 'Texas'
                }
    }
} 
```

这是我到目前为止写的

```
var tree = key.split("-"); 
```

现在树变量包含 ["myData","address", "details","prevhouse"]

我知道我们可以使用 myData[tree[0]][tree[1]][tree[2]] 访问该对象，但不知何故无法从解析的值中获取它的动态。

我们如何动态生成它，因为深度的长度直到运行时才知道。

希望能得到帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T03:33:22.817

试试这个代码：

```
 var myData = {
        name: 'Dan',
        address: {
            city: 'Santa Clara',
            details: {
                prevhouse: ''
            }
        }
    };

    function setAttribute(obj, key, value) {
        var i = 1,
            attrs = key.split('-'),
            max = attrs.length - 1;

        for (; i < max; i++) {
            attr = attrs[i];
            obj = obj[attr];
        }

        obj[attrs[max]] = value;
        console.log('myData=', myData);

    }

    setAttribute(myData, "myData-address-details-prevhouse", "Texas"); 
```

[这](http://jsfiddle.net/UppdC/1/)是一个有效的 jsfiddle 演示；查看控制台的结果

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T03:08:33.720

您应该能够遍历每个键，因为您的 JSON 只是一个 JS 对象。因此，检查每个键，检查它是否已定义，如果已定义，请使用该对象进行下一次检查。这会让你到达你想去的地方。请记住，您将把最后一个键设置为您的值。

基本伪代码，无需处理设置：

```
obj = data;
for (key in keys) {
  obj = obj[key]
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T03:25:56.223

这样的事情会做：

```
function update(node, path, value) {
  path = path.split('-');
  do {
    node = node[path.splice(0, 1)];
  } while(path.length > 1);
  node[path[0]] = value;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T03:02:57.163

鉴于这`myData`是对象，我认为您应该使用`myData[tree[1]][tree[2]][tree[3]]`并丢弃数组中的第一项。

像这样的东西应该递归工作（未经测试）

```
function updateValue(obj, key, value)
{
   var keys = key.split('-');
   updateObjectValue(obj, keys.shift(), value);
}

function updateObjectValue(obj, keyArray, value)
{
     if (keyArray.length == 1) {
         obj[keyArray[0]] = value;
     }
     else if (keyArray.length > 1) {
         updateObject(obj[keyArray[0]], keyArray.shift(), value);
     }
} 
```

# java - 关于生成样本图表示（RDF 或 VEV 元组）的建议

> ID：13983696
> 
> 赞同：1
> 
> 时间：2012-12-21T02:57:40.017
> 
> 标签：java, python, mapreduce, akka

我想生成一个示例实验图数据。我希望能够指定边数、节点数和图拓扑（DAG、测谎仪……）可能需要生成数百万个，可能是数百亿个节点。

换句话说，我的程序应该采用一些节点、边数，生成一些样本分布，对于初学者来说，这些分布可能是纯随机的，然后写出来。

鉴于工作的大小，是否有人有关于如何使用 Parallel Python、MapReduce 或 Akka 执行此操作的良好指针或示例代码？

先感谢您。

# gwt - 如何从 CDN 提供 GWT 静态文件

> ID：13983697
> 
> 赞同：2
> 
> 时间：2012-12-21T02:57:39.837
> 
> 标签：gwt, cdn, same-origin-policy

我试图弄清楚如何从 CDN 而不是从 tomcat 服务器提供我的 GWT 文件。

我从这段代码开始

```
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="robots" content="no-index, no-follow" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>My Site</title>
<script type="text/javascript" src="/bcmjs/bcmjs.nocache.js"></script>
</head>

<body>
<div id="gwt_div">
</div>
</body>
</html> 
```

并修改了 javascript 导入以使用 CDN url，来自：

```
<script type="text/javascript" src="/bcmjs/bcmjs.nocache.js"></script> 
```

对此：

```
<script type="text/javascript" src="https://uoo9w.cloudfront.net/bcmjs/bcmjs.nocache.js"></script> 
```

万岁！js 下载，UIBinder 小部件可见，但 RPC 失败。

问题似乎是`GWT.getModuleBase`返回 Javascript 的 URL (uoo9w.cloudfront.net) 而不是主机页面 (mysite.example.com)，这会破坏诸如用于 RPC 请求的 URL 之类的东西。

~~`GWT.getModuleBaseForStaticFiles`似乎是一种允许使用 CDN 的方法，但我找不到有关它的文档。~~ *（看评论）*

有谁知道设置 GWT 以从 CDN 提供服务并将 RPC 请求发送到主机页面域的正确方法？

边注：

由于 CDN 具有不同的域名和路径，我担心会出现涉及同源策略的问题，但由于 GWT 主机页面与所有 RPC 请求在同一个域上提供服务，所以这不是问题。（即 Window.Location 与 RPC 的域相同）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T06:57:46.533

所以答案似乎是手动调用`ServiceDefTarget.setServiceEntryPoint()`每个 RPC 接口

这是我用来替换`moduleBaseURL`主机页面 url 的代码。它让我可以在所有界面上使用现有的`@RemoteServiceRelativePath`注释。`RemoteService`

```
public static native String getHostpageUrl()/*-{
   return $wnd.location.protocol + "//" + $wnd.location.host + "/";
}-*/;

GreetingServiceAsync greetingService = GWT.create(GreetingService.class);

ServiceDefTarget serviceDefTarget= ((ServiceDefTarget)greetingService);
String oldUrl = serviceDefTarget.getServiceEntryPoint();
String newServiceEntryPoint =  oldUrl.startsWith(GWT.getModuleBaseURL()) ? 
        getBaseUrl() + "module/" + oldUrl.substring(GWT.getModuleBaseURL().length(), value.length()) 
       : oldUrl;
serviceDefTarget.setServiceEntryPoint(newServiceEntryPoint); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T08:24:03.827

GWT 设置 RPC 的 url 指向script-tag的`src`属性而不是文档的属性。`modulename.nocache.js``location`

修复它的正常方法是将服务的基本 url 更改`rpc`为指向`location`html 文件的

```
GreetingServiceAsync greetingService = GWT.create(GreetingService.class);
((ServiceDefTarget)greetingService)
   .setServiceEntryPoint("http://hostname_of_your_document/modulename/greet"); 
```

注意：在这种情况下，您不是*跨域*，因为您`.html`和您`services`在同一主机中。

可选地，如果 与文件`services`不在同一主机中`.html`，则您正在执行*crossdomain*，因此您可以配置您的 servlet 以支持[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)。最好的方法是在您的`web.xml`

```
<filter>
  <filter-name>corsFilter</filter-name>
  <filter-class>com.example.server.CORSFilter</filter-class>
</filter>
<filter-mapping>
  <filter-name>corsFilter</filter-name>
  <url-pattern>/*</url-pattern>
</filter-mapping> 
```

对于过滤器类，您可以使用我为[gwtquery Ajax 文档所做的示例](https://code.google.com/p/gwtquery/wiki/Ajax#CORS_%28Cross_Origin_Resource_Sharing%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-17T23:03:45.520

请参阅此详细说明，了解您需要更新以从 AWS CloudFront 等 CDN 运行 GWT 应用程序的四个方面。

[https://groups.google.com/forum/?fromgroups#!topic/google-web-toolkit/4eNY2RiLH1k](https://groups.google.com/forum/?fromgroups#!topic/google-web-toolkit/4eNY2RiLH1k)

希望有帮助。

# android - 如何从 UI 线程 WebView.getTitle()？

> ID：13983699
> 
> 赞同：12
> 
> 时间：2012-12-21T02:58:06.587
> 
> 标签：android, android-webview

在 的子类中`WebView`，我曾经在重写的方法中有这一行`getTitle()`：

```
String title = super.getTitle(); 
```

它在所有版本的**Android**中运行良好，直到我在**Android 4.1**手机上测试我的应用程序，这在该行上给了我这个警告`super.getTitle()`：

> 12-20 21:38:27.467：W/webview_proxy(2537)：java.lang.Throwable：警告：在线程“WebViewCoreThread”上调用了 WebView 方法。 **所有 WebView 方法都必须在 UI 线程上调用。**WebView 的未来版本可能不支持在其他线程上使用。

因此，我正在考虑通过通过以下方式来解决这项新法令`runOnUiThread()`：

```
Activity a = this.getActivity();
a.runOnUiThread(new Runnable() {
    public void run() { 
    String title = super.getTitle();
    }
}); 
```

但是这段代码甚至不会编译，因为`super`不再引用`WebView`，而是引用`Activity`.

知道如何`super.getTitle()`从 UI 线程中获取信息吗？（具有上述约束，在 的`getTitle()`子类中`WebView`）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-01T22:46:10.333

[摩根的回答](https://stackoverflow.com/a/14112894/119114)虽然可以修复编译错误，但并不是真正解决这个问题。

首先，它不会改变对`getTitle()`不同线程的调用。那个潜在的问题是为什么 Android 在运行时给你错误。

你在评论中说

> 情况是我在 WebViewClient.onPageFinished() 中调用它，而它恰好不在 UI 线程上。

这*可能*是个问题。如果您从 UI 线程启动 Web 请求，那么`onPageFinished()`肯定应该在 UI 线程上回调。您能解释一下您是如何启动网络请求的，以及*为什么*要这样做吗？绝大多数情况下，您不应该`onPageFinished()`在后台看到呼叫，因此您可能在其他地方遇到问题。

（注意：如果您认为需要`WebView.loadUrl()`在后台调用以避免阻塞 UI，请[参阅有关该问题的其他答案](https://stackoverflow.com/a/11259703/119114)）

**如果**你真的认为你需要在后台启动 web 请求，并且你看到`onPageFinished()`在后台调用，你需要小心`getTitle()`在 UI 线程上调用。

此外，如果您从`onPageFinished()`方法中调用它，则无需使用如下语法：

```
String title = MyWebView.this.getTitle(); 
```

在该方法中，您将获得 Web 视图的实例，因此只需直接使用它：

```
public void onPageFinished (WebView view, String url) {
    String title = view.getTitle();
} 
```

但是，正如我所说，这并不能解决线程问题。您需要向我们展示您**为什么**尝试在该方法中使用页面标题，但安全使用它的*一种方法*是这样的：

```
public void onPageFinished (final WebView view, String url) {
   view.post(new Runnable() {
      public void run() { 
         String title = view.getTitle();
         // do something with title that affects the UI here
      }
   });     
} 
```

**请注意**，我需要在上面的代码中 制作`view`参数。`final`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-24T00:01:14.263

我没有直接回答您的问题，但是当我遇到类似问题时，我可以建议一种对我有用的解决方法：找到调用调用方法的方法并通过[runOnUiThread()](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)`String title = super.getTitle();`运行**它**。

HTH。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-01T18:07:59.257

直接的解决方案是这样做

```
String title = MyWebView.this.getTitle(); 
```

代替

```
String title = super.getTitle(); 
```

话虽如此，了解更多关于您调用它的情况会很有趣（即，为什么您在后台调用它）。我之所以问，是因为我不确定即使在您进行了我提到的代码更改之后，您的方法是否会达到您想要的效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T09:33:33.417

要消除此警告，请执行以下操作：

```
 Handler handler =new Handler();
    handler.post(new Runnable() {

        @Override
        public void run() {
            // TODO Auto-generated method stub
            String URL = "http://www.superlinux.net";

            //Of course the object "webview" is a WebView. 
            //it's better to define it a global variable
            webview.loadUrl(URL);
        }
    }); 
```

因此，使用这种方式，因为 webview 是 UI 元素，所以使用 Handler 对象。处理程序是与创建任何 UI 元素分开运行的某种线程。

# javascript - 如何向我的 Asp 超链接的 NavigateUrl 属性添加一些条件 Javascript？

> ID：13983700
> 
> 赞同：0
> 
> 时间：2012-12-21T02:58:16.543
> 
> 标签：javascript, asp.net, hyperlink, navigateurl

所以我在我的 asp.net 页面上有一个超链接。当该人单击该链接时，它会执行一些操作。现在我希望能够添加一个关于用户是否确定他/她想要执行该操作的 javascript 警报（实际上是确认）？如果是，则执行该操作，否则不执行任何操作。我该怎么做呢？

我当前的代码只有一个指向该操作的链接：

```
Link1.NavigateUrl = "./Actions.aspx?action=abort&job=" + JobID; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:06:42.777

我不在我的开发环境中进行测试，但这样的事情应该适合你：

```
Link1.NavigateUrl = "./Actions.aspx?action=abort&job=" + JobID;
Link1.Attributes["onclick"] = "return confirm('Are you sure?');"; 
```

# excel - Excel 2010 64 位 odbc 驱动程序

> ID：13983702
> 
> 赞同：0
> 
> 时间：2012-12-21T02:58:41.553
> 
> 标签：excel

我有一台装有 Windows 7 64 位和 Excel 2010 64 位的机器。

尝试在 C:\windows\system32\odbcad32.exe 中创建 DSN。找不到 oracle oledb 连接。

我怎样才能创建上述连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-25T19:47:01.970

您需要下载、安装和配置 64 位版本。从这里开始：

[http://www.oracle.com/technetwork/topics/winx64soft-089540.html](http://www.oracle.com/technetwork/topics/winx64soft-089540.html)

是的，这是一个没有收获的大痛苦。

# magento - 试图在我的 Magento 自定义扩展中扩展 getName？

> ID：13983710
> 
> 赞同：0
> 
> 时间：2012-12-21T02:59:33.160
> 
> 标签：magento, block, extend, adminhtml

即使我认为下面的代码会自行解释，也可以快速概述。我想扩展 getName() 公共函数并截断它。但是我的代码什么也不做，甚至没有抛出错误。这是我的文件。

贝金/TextShortner/etc/config.xml

```
<config>    
<modules>
<Beckin_TextShortner><version>1.0.0</version></Beckin_TextShortner>
    </modules>

<global>           
            <models>
               <textshortner>
                     <class>Beckin_TextShortner_Model</class>
               </textshortner>
            </models>
    <helpers>
         <textshortner>
          <class>Beckin_TextShortner_Helper</class>
         </textshortner>
    </helpers>      
</global>

<textshortner>
  <settings>
    <enable>1</enable>
  </settings>
</textshortner>

 <frontend>
    <layout>
        <updates>
            <beckin>
                <file>beckin_textshortner.xml</file>
            </beckin>
        </updates>
    </layout>
    <routers>
        <textshortner>
            <use>standard</use>
            <args>
                <module>Beckin_TextShortner</module>
                <frontName>textshortner</frontName>
            </args>
        </textshortner>
    </routers>  
</frontend>

</config> 
```

Beckin/TextShortner/Model/Catalog/Product.php

```
class Beckin_TextShortner_Model_Catalog_Product extends Mage_Catalog_Model_Catalog_Product
{   

public function getName()
{
$getmyName = $this->_getData('name');
return  $this->helper('core/string')->truncate($getmyName,10); 
}

} 
```

贝金/TextShortner/etc/system.xml

```
<config>
<tabs>
    <beckin translate="label">
        <label>Beckin Extensions</label>
        <sort_order>100</sort_order>
    </beckin>
</tabs>

<sections>  
            <textshortner translate="label">
        <label>Text Shortner</label>
        <tab>beckin</tab>
        <frontend_type>text</frontend_type>
        <sort_order>1010</sort_order>
        <show_in_default>1</show_in_default>
        <show_in_website>1</show_in_website>
        <show_in_store>1</show_in_store>

            <groups>            

                <settings translate="label">
                <label>Settings</label>
                <frontend_type>text</frontend_type>
                <sort_order>1</sort_order>
                <show_in_default>1</show_in_default>
                <show_in_website>1</show_in_website>
                <show_in_store>1</show_in_store>

                    <fields>
                        <enable translate="label">
                        <label>Enable</label>
                        <comment>
                        <![CDATA[Enable or Disable this extension.]]>
                        </comment>
                        <frontend_type>select</frontend_type>
                        <source_model>adminhtml/system_config_source_yesno</source_model>
                        <sort_order>1</sort_order>
                        <show_in_default>1</show_in_default>
                        <show_in_website>1</show_in_website>
                        <show_in_store>1</show_in_store>                    
                        </enable>           
                    </fields>

                </settings>
            </groups>
        </textshortner>
</sections>     
</config> 
```

贝金/TextShortner/etc/adminhtml.xml

```
<config>  

    <acl>
        <resources>
        <all>
            <title>Allow Everything</title>
        </all>
            <admin>
                <children>
                    <system>
                        <children>
                            <config>
                                <children>
                                    <textshortner>
                                        <title>Beckin Text Shortner Extension</title>
                                    </textshortner>
                                </children>
                            </config>
                        </children>
                    </system>
                </children>
            </admin>
        </resources>
    </acl>

</config> 
```

当然，我也设置了我的模块 xml 文件。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T08:53:34.050

首先是您扩展的模型 Mage_Catalog_Model_Catalog_Product 我认为这不是模型的正确名称？？

你的意思是 ？Mage_Catalog_Model_Product

其次，您的代码扩展了模型，但没有重写模型。因此，您必须更改核心池中的块文件中的模型，这不好。

所以你需要在这里做的是在你的 config.xml 中为模型指定重写

```
<models>
....
<catalog>
      <rewrite>
            <product>Beckin_TextShortner_Model_Catalog_Product</product>
      </rewrite>
</catalog>
....
</models> 
```

然后您将能够毫无问题地使用该方法

# android - 无法让 Edittext 值显示在新活动中？

> ID：13983713
> 
> 赞同：0
> 
> 时间：2012-12-21T02:59:36.220
> 
> 标签：android, nullpointerexception, android-edittext, spinner

在这方面有点菜鸟。我在从编辑文本中获取一些值以转移到新活动时遇到了一些麻烦。我正在尝试将其设置为所选微调器项目将其放置到正确文本视图中的位置。我没有强迫关闭，但它只是没有将用户值放入文本视图中。任何帮助将不胜感激。

主要活动

```
public class RoofingClaculatorActivity extends Activity implements OnClickListener,           android.view.View.OnClickListener {

EditText hFeetInput;
EditText hInchesInput;
EditText wFeetInput;
EditText wInchesInput;
Spinner slopeSpinner;
Button save;
int pos;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button save = (Button) findViewById(R.id.savedata);
    save.setOnClickListener(this);
}

public void onClick(View v) {
    // TODO Auto-generated method stub

    EditText hFeetInput = (EditText) findViewById(R.id.hFeetInput);
    EditText hInchesInput = (EditText) findViewById(R.id.hInchesInput);
    EditText wFeetInput = (EditText) findViewById(R.id.wFeetInput);
    EditText wInchesInput = (EditText) findViewById(R.id.wInchesInput);

    String hFeet = hFeetInput.getText().toString();
    String hInches = hInchesInput.getText().toString();
    String wFeet = wFeetInput.getText().toString();
    String wInches = wInchesInput.getText().toString();

    Double HFEET = Double.parseDouble(hFeet);
    Double HINCHES = Double.parseDouble(hInches);
    Double WFEET = Double.parseDouble(wFeet);
    Double WINCHES = Double.parseDouble(wInches);

    Intent i = new Intent(this, DisplayResults.class);
    Bundle b = new Bundle();
    b.putDouble("hFeetInput", HFEET);
    b.putDouble("hInchesInput", HINCHES);
    b.putDouble("wFeetInput", WFEET);
    b.putDouble("wInchesInput", WINCHES);

    i.putExtras(b);
    startActivity(i);
}

public void onClick(DialogInterface dialog, int which) {
    // TODO Auto-generated method stub

} 
```

}

第二项活动

```
public class DisplayResults extends Activity implements OnClickListener, OnItemSelectedListener {
static Double aHInches;
static Double aWInches;
static Double aHFeet;
static Double aWFeet;
private static double Squared = 0;
private static double Inches = 0;   
static String aSquared= Double.toString(Squared);
static String addedInches=Double.toString(Inches);;;
static TextView a_feet;
static TextView b_feet;
static TextView a_Inches;
static TextView b_Inches;
int pos;
Spinner slopeSpinner;
ArrayAdapter<String> adapter;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.displayresult);
    initialize();

    adapter = new ArrayAdapter<String>(this, R.array.slopeArray, android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    slopeSpinner = (Spinner) findViewById(R.id.slopeSpinner);

    Bundle gotData = getIntent().getExtras();
    aHFeet = gotData.getDouble("hFeetInput");
    aHInches = gotData.getDouble("hInchesInput");
    aWFeet = gotData.getDouble("wFeetInput");
    aWInches = gotData.getDouble("wInchesInput");
    Inches = aHInches + aWInches;
    Squared = aHFeet * aWFeet / 100;
    aSquared = Double.toString(Squared);
    addedInches = Double.toString(Inches);

}

private void initialize() {
    // TODO Auto-generated method stub
    a_feet = (TextView) findViewById(R.id.aHeight);
    b_feet = (TextView) findViewById(R.id.bHeight);
    a_Inches = (TextView) findViewById(R.id.aInches);
    b_Inches = (TextView) findViewById(R.id.bInches);

}

public void onClick(DialogInterface arg0, int arg1) {
    // TODO Auto-generated method stub

}

public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
    // TODO Auto-generated method stub
    slopeSpinner.setAdapter(adapter);
    slopeSpinner.setOnItemSelectedListener(this);
    pos = slopeSpinner.getSelectedItemPosition();

    if(pos == 0){
        a_feet.setText(aSquared);
        a_Inches.setText(addedInches);
    }else if (pos == 1){
        b_feet.setText(aSquared);
        b_Inches.setText(addedInches);
    }
}

public void onNothingSelected(AdapterView<?> arg0) {
    // TODO Auto-generated method stub

}

 } 
```

再次感谢任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T06:00:53.143

将以下代码写入文件`onItemSelected()`方法`DisplayResults.java`，它将解决您的问题，如果您对此有任何疑问，请告诉我。

```
if (pos == 0){
    a_feet.setText("Squared is:- " + aSquared);
    a_Inches.setText("Added Inches is:- " +addedInches);
} else if (pos == 1){
    b_feet.setText("Squared is:- " + aSquared);
    b_Inches.setText("Added Inches is:- " + addedInches);
} 
```

# php - Serialize or Hash a Closure in PHP

> ID：13983714
> 
> 赞同：8
> 
> 时间：2012-12-21T02:59:55.517
> 
> 标签：php, serialization, closures

This is bound to beg design questions, but I want to serialize or hash a closure in PHP such that I have a unique identifier for that closure.

I don't need to be able to call the closure from that, I just need a unique identifier for it that is accessible from inside and outside of the closure itself, i.e. a method that accepts a closer will need to generate an id for that closure, and the closure itself will need to be able to generate that same id

Things I've tried so far:

```
$someClass = new SomeClass();

$closure1 = $someClass->closure();

print $closure1();
// Outputs: I am a closure: {closure}

print $someClass->closure();
// Outputs: Catchable fatal error: Object of class Closure could not be converted to string

print serialize($closure1);
// Outputs: Fatal error: Uncaught exception 'Exception' with message 'Serialization of 'Closure' is not allowed'

class SomeClass
{
    function closure()
    {
        return function () { return 'I am a closure: ' . __FUNCTION__; };
    }
} 
```

The Reflection API doesn't seem to offer anything I might be able to use to create an ID either.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T07:33:52.803

My solution is more general and respects static parameters for closure. To make the trick, you can pass a reference to the closure inside the closure:

```
class ClosureHash
{
    /**
     * List of hashes
     *
     * @var SplObjectStorage
     */
    protected static $hashes = null;

    /**
     * Returns a hash for closure
     *
     * @param callable $closure
     *
     * @return string
     */
    public static function from(Closure $closure)
    {
        if (!self::$hashes) {
            self::$hashes = new SplObjectStorage();
        }

        if (!isset(self::$hashes[$closure])) {
            $ref  = new ReflectionFunction($closure);
            $file = new SplFileObject($ref->getFileName());
            $file->seek($ref->getStartLine()-1);
            $content = '';
            while ($file->key() < $ref->getEndLine()) {
                $content .= $file->current();
                $file->next();
            }
            self::$hashes[$closure] = md5(json_encode(array(
                $content,
                $ref->getStaticVariables()
            )));
        }
        return self::$hashes[$closure];
    }
}

class Test {

    public function hello($greeting)
    {
        $closure = function ($message) use ($greeting, &$closure) {
            echo "Inside: ", ClosureHash::from($closure), PHP_EOL, "<br>" ;
        };
        return $closure;
    }
}

$obj = new Test();

$closure = $obj->hello('Hello');
$closure('PHP');
echo "Outside: ", ClosureHash::from($closure), PHP_EOL, "<br>";

$another = $obj->hello('Bonjour');
$another('PHP');
echo "Outside: ", ClosureHash::from($another), PHP_EOL, "<br>"; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-21T05:43:52.060

You could all that you need write your own, your own closures having a `getId()` or `getHash()` or whatever.

Example ([Demo](http://eval.in/5103)):

```
1: Hello world
2: Hello world 
```

First closure (ID: 1), ID read in calling context. Second closure (ID: 2), ID read from within the closure (where self-reference).

Code:

```
<?php
/**
 * @link http://stackoverflow.com/questions/13983714/serialize-or-hash-a-closure-in-php
 */

class IdClosure
{
    private $callback;
    private $id;

    private static $sequence = 0;

    final public function __construct(Callable $callback) {
        $this->callback = $callback;
        $this->id = ++IdClosure::$sequence;
    }

    public function __invoke() {
        return call_user_func_array($this->callback, func_get_args());
    }

    public function getId() {
        return $this->id;
    }
}

$hello = new IdClosure(function($text) { echo "Hello $text\n";});
echo $hello->getId(), ": ", $hello('world');

$hello2 = new IdClosure(function($text) use (&$hello2) { echo $hello2->getId(), ": Hello $text\n";} );
$hello2('world'); 
```

I have no clue if that suits your needs, maybe it gives you some ideas. I suggested `spl_object_hash` but didn't understood the discussion much why it does not or in the end then does work.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-21T03:56:49.597

Ok, here is the only thing I can think of:

```
<?php
$f = function() {
};
$rf = new ReflectionFunction($f);
$pseudounique = $rf->getFileName().$rf->getEndLine();
?> 
```

If you like, you can hash it with md5 or whatnot. If the function is generated from a string however, you should seed that with a `uniqid()`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-21T03:50:04.600

PHP [anonymous functions](http://php.net/functions.anonymous) are exposed as instances of the [Closure class](http://php.net/class.closure). As they're basically objects, [`spl_object_hash`](http://php.net/spl_object_hash) will return a unique identifier when handed one. From the PHP interactive prompt:

```
php > $a = function() { echo "I am A!"; };
php > $b = function() { echo "I am B!"; };
php >
php >
php > echo spl_object_hash($a), "\n", spl_object_hash($b), "\n";
000000004f2ef15d000000003b2d5c60
000000004f2ef15c000000003b2d5c60 
```

Those identifiers might *look* the same, but they differ by one letter in the middle.

The identifier is good only for that request, so expect it to change between calls, even if the function and any `use`'d variables don't change.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-25T17:05:57.490

[Superclosure](https://github.com/jeremeamia/super_closure) provides a convenience class that allows you to serialize/unserialize closures, among other things.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-21T03:35:00.223

It sounds like you want to generate a signature. Creating a signature from outside the closure will be nearly impossible to reproduce if the closure accepts any parameters. The data passed in will change the generated signature.

```
$someClass = new SomeClass();
$closure1 = $someClass->closure();
$closure1_id = md5(print_r($closure1, true)); 
```

Even if your closure doesn't accept parameters, you still have the problem of storing and persisting the signature inside the closure. You might be able to do something with a static variable inside the closure so it only initializes once and retains the "signature". But that gets messy on how to retrieve it.

It really sounds like you want a class, not a closure. It would solve all of these problems. You could pass in a "salt" on instantiation and have it generate a signature using the salt (i.e. a random number). That would make the signature unique. You could then retain that salt, recreate a class using the exact same constructor parameters (i.e. salt) and compare that with the signature on file in the already created class.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-21T04:30:14.820

Possible solution arrived at with the help of @hakre and @dualed:

```
$someClass = new SomeClass();

$closure = $someClass->closure();
$closure2 = $someClass->closure2();

$rf = new ReflectionFunction($closure);
$rf2 = new ReflectionFunction($closure2);

print spl_object_hash($rf); // Outputs: 000000007ddc37c8000000003b230216
print spl_object_hash($rf2); // Outputs: 000000007ddc37c9000000003b230216

class SomeClass
{
    function closure()
    {
        return function () { return 'I am closure: ' . __FUNCTION__; };
    }

    function closure2()
    {
        return function () { return 'I am closure: ' . __FUNCTION__; };
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-19T13:43:37.157

I believe you can't hash `Closure` instances in a reliable manner in PHP, because you cannot access most symbols in the AST belonging to the function body.

As far as I can tell only outer scope variables used by the `Closure`, symbols in the function body of type `T_VARIABLE` (`$a`, `$b`, etc), type information and the function signature can be elucidated in a variety of ways. Absent vital information about the function body it is impossible for hash functions to behave in an idempotent manner when applied to instances of `Closure`.

`spl_object_hash` or `spl_object_id` won't save you -- a possibly (almost constantly in real world applications) changing refcount complicates the matter so these functions aren't usually idempotent either.

The only situation where hashing a `Closure` instance may be possible is when it has been defined in a PHP source file somewhere and your current instance of it uses no other `Closure` instances from its outer scope. In that case you might have some succes by wrapping your `Closure` instance in a `ReflectionFunction` instance. Now you can try to get the filename and line numbers where the `Closure` is declared. Then you could load the source file and extract the part between the line numbers, dump that part into a string and tokenize it with `token_get_all()`. Next remove tokens that don't belong to the `Closure` declaration and look at the outer scope of your `Closure` instance to get the values of any outer scope variables it uses. Finally, put all this together in some way and hash that data. But of course when you like to pass functions to functions it won't be long until you start questioning "*..but what if outer scope variables are also `Closure` instances?"* -- Well..

To test what happens in PHP I used the following a pair of functions:

```
$zhash = function ($input, callable $hash = null, callable $ob_callback = null) {
    if (\is_scalar($input)) {
        return \is_callable($hash) ? $hash($input) : \hash('md5', $input);
    }

    \ob_start(
        \is_callable($ob_callback) ? $ob_callback : null,
        4096,
        PHP_OUTPUT_HANDLER_STDFLAGS
    );
    \debug_zval_dump($input);
    $dump = \ob_get_clean();

    return \is_callable($hash) ? $hash($dump) : \hash('md5', $dump);
};

$zhash_algo_gz = function ($input, string $algo = 'sha256', int $compress = -1) use ($zhash) {
    return $zhash(
        $input,
        function ($data) use ($algo) {
            return \hash($algo, $data);
        },
        function ($data) use ($compress) {
            return \gzcompress($data, $compress, ZLIB_ENCODING_GZIP);
        }
    );
}; 
```

The use of `debug_zval_dump` was to avoid failure on circular refs and resources. The use of `gzcompress` was to compress the input data to the hash function if it was a very large class. I tested this with a fully loaded Magento2 application as input to `$zhash_algo_gz`, before I ran into the exact problems that lead me here in the first place (i.e. `debug_zval_dump` contains refcount, not function body, leading to non-idempotent results from hashing functions).

**On the the test**.

We set a variable all the closures in this test use:

```
$b = 42; 
```

In the first example the refcount stays the same for both calls as our two `Closure` instances are not bound to variables and the code is executed in a fresh `php -a` session:

```
$zhash_algo_gz(function ($a) use ($b) { return $a * $b + 5; });
$zhash_algo_gz(function ($a) use ($b) { return $a * $b + 6; }); 
```

Output:

```
a0cd0738ea01d667c9386d4d9fe085cbc81c0010f30d826106c44a884caf6184
a0cd0738ea01d667c9386d4d9fe085cbc81c0010f30d826106c44a884caf6184 
```

**Houston, we have a problem!**

As mentioned earlier we cannot infer vital information about the function body of `Closure` instances. The `+5` and `+6` tokens will not show up in any command output, `print_r`, `var_export`, `var_dump`, `debug_zval_dump` or otherwise.

This implies that hashing two anonymous functions that share the same signature, refcount, outer scope variables and parameters but a partially heterogeneous function body **will yield identical hashes**.

If we start a fresh `php -a` session, but now bind our `Closure` instances to variables first, it might look good at first glance:

```
$f1 = function ($a) use ($b) { return $a * $b + 5; });
$f2 = function ($a) use ($b) { return $a * $b + 6; });
$zhash_algo_gz($f1);
$zhash_algo_gz($f2); 
```

Output:

```
085323126d01f3e04dacdbb6791f230d99f16fbf4189f98bf8d831185ef13b6c
18a9c0b26bf6f6546d08911d7268abba72e1d12ede2e9619d782deded922ab65 
```

**Hey, different hashes! But don't be fooled...**

The change in hash is *not* due to the change in the function body, **it is due to the changed refcount!**. Not much use for that hash then, is there?

Apart from all this, like Brent says above, you probably want a `Class`, not a `Closure`.. this is still PHP ;)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-22T20:20:24.570

Just use [https://github.com/opis/closure](https://github.com/opis/closure) ,the library is maintained and it makes use of SplObjectStorage to create an wrapper for the closure object. You can use serialize and unserialize like this:

```
use function Opis\Closure\{serialize as opisSerialize, unserialize as opisUnserialize};

    $serialized = opisSerialize(new SerializableClosure($closure));
    $wrapper = opisUnserialize($serialized); 
```

# javascript - Node.js 和 Socket.IO - 房间问题

> ID：13983720
> 
> 赞同：7
> 
> 时间：2012-12-21T03:01:13.333
> 
> 标签：javascript, node.js, socket.io

考虑多聊天应用程序。用户可以加入多个房间（`socket.join(room)`），用户可以离开一个房间（`socket.leave(room)`）。

当套接字离开房间时，我通知其他房间参与者。如果套接字当前在 3 个房间中，并且他突然断开与网站的连接而没有以正确的方式离开房间，我如何通知这些房间用户已经离开？

如果我使用 on socket disconnect 事件，用户将不再在任何房间。是保留一组单独的用户的唯一方法，还是有一些我没有想到的聪明方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T16:44:37.923

在断开连接事件期间，您的进程仍然可以使用套接字。例如，这应该工作

```
io.socket.on('connection', function(socket){
    socket.on('disconnect', function() {
       // this returns a list of all rooms this user is in
       var rooms = io.sockets.manager.roomClients[socket.id];
       for(var room in rooms) {
           socket.leave(room);
       }
    });
}); 
```

尽管这实际上不是必需的，因为 socket.io 会在断开连接事件时自动修剪[房间。](https://github.com/LearnBoost/socket.io/wiki/Rooms)但是，如果您要执行特定操作，则可以使用此方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T11:33:03.013

我假设套接字是您的节点进程中的一个长期存在的对象。如果是这种情况，那么当用户连接时，您可以轻松地在套接字对象上添加对用户的引用。当您获得套接字断开连接时，您无需查找与会话关联的用户，因为它会在那里。

在连接或登录时：

```
socket.user = yourUser; 
```

断开连接时：

```
socket.on('disconnect', function(){
  socket.leave(room, socket.user);
} 
```

有关向套接字对象和单个房间聊天客户端添加属性的示例，请参见此处：

[http://psitsmike.com/2011/09/node-js-and-socket-io-chat-tutorial/](http://psitsmike.com/2011/09/node-js-and-socket-io-chat-tutorial/)

# c++ - 如何在 Ubuntu 12.0.4 上安装 GCC 2.95？

> ID：13983721
> 
> 赞同：0
> 
> 时间：2012-12-21T03:01:21.870
> 
> 标签：c++, c, gcc, ubuntu, compilation

我正在尝试在 Ubuntu 12.0.4 上安装 GCC 2.95。这是错误

`decl.c : in function 'start_struct': 4449:27; argument 'code' doesn't match prototype`

`ch-tree.h: 736:13: error: prototype declaration`

我试过了：

`./configure`
`make`（失败的）

如何解决这些错误并在 Ubuntu 12.0.4 上安装 GCC 2.95？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T03:05:52.527

My theory is that you are building it wrong. Did you read the directions?

I think you need to run `./configure`, then run `make bootstrap`. It has been a while (12 years at least!) but I think that will work.

The difference is that bootstrap will build a tiny version of GCC then build GCC then build GCC again. Of course this is slower than just make, but it should be able to build GCC starting with any K&R C compiler.

# html - div中神秘的多余空间

> ID：13983722
> 
> 赞同：1
> 
> 时间：2012-12-21T03:01:26.370
> 
> 标签：html, css

我正在尝试在图像上覆盖文本，当我将图像包装在 div 中并应用边框时，您可以看到之后有额外的空间。这个空间来自哪里，如何删除它？下面的 jsfiddle 有一个例子。

[http://jsfiddle.net/ngd5R/22/](http://jsfiddle.net/ngd5R/22/)

请注意，背景`.avatar`是红色的，表明边界框比它包含的图像大。我不能只应用边框，`img`因为`.message`依赖于父级的高度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:04:46.990

将以下行添加到您的规则中`.avatar img`：

```
display: block; 
```

红色背景将消失。[这是更新的小提琴](http://jsfiddle.net/ngd5R/23/)。默认情况下，图像是*内联*元素（技术上，`inline-block`IIRC），这意味着它们与文本相同。如果您将图像设置为块级项目，则“文本样式”流规则将不适用。

# mysql - 使用模运算符获取样本

> ID：13983727
> 
> 赞同：0
> 
> 时间：2012-12-21T03:01:46.893
> 
> 标签：mysql, sql, sample, modulo

如何使用 Modulo 运算符获取样本？

如果我有一组只是随机数的 ID，并且我想要 1% 的样本，我知道我可以执行“random_id % 101 = 0”。这是否意味着“random_id % 11 = 0”是 10% 的样本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:04:39.237

如果您选择每个第 n 个元素，这不是随机的。

# android - Android：仅在 onCreate 中使用 getIntent()？

> ID：13983728
> 
> 赞同：7
> 
> 时间：2012-12-21T03:02:06.507
> 
> 标签：android, android-intent, oncreate

在 Android（针对 API 14-16）中，我有一个`MainActivity`和一个`NextActivity`. 如果在以下块中调用方法，则使用意图`NextActivity`从内部开始没有困难：`MainActivity``getIntent()``onCreate()``NextActivity`

```
public class MainActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        int data = 7;
        ...
        Intent intent = new Intent(this, NextActivity.class);
        intent.putExtra("data", data);
        startActivity(intent);
        }
    }

public class NextActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        final int data = this.getIntent().getIntExtra("data", 7);
        ...
        }
    ...
    } 
```

但是，由于该字段`data`在 中的匿名（“内部”）类中使用`NextActivity`，我不得不声明它`final`。

我不想声明 fields `final`，如果我在课程开始之前声明它们，我通常可以避免这样做`onCreate()`。但是由于某种原因，`NextActivity`如果`getIntent()`语句出现（没有`final`关键字）在`onCreate()`.

知道为什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-21T04:44:00.113

`getIntent()`你以前不能`onCreate()`——那时根本没有`Intent`可用的。我相信对于任何需要`Context`.

但是，您的匿名内部类仍然可以调用`getIntent()`，因此您根本不需要将其声明为变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T04:35:24.720

根据你的问题，我理解的是你不想在下一个活动中将数据声明为最终数据。那么你不能尝试这个。/

```
public class NextActivity extends Activity {
    int data=0;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
         data = this.getIntent().getIntExtra("data", 7);
        ...
        }
    ...
    } 
```

试试这个...

# python - python lxml 模块在内部使用哪种编码？

> ID：13983729
> 
> 赞同：3
> 
> 时间：2012-12-21T03:02:14.520
> 
> 标签：python, encoding, lxml

当我得到一个网页时，我使用 UnicodeDammit 将其转换为 utf-8 编码，就像：

```
import chardet
from lxml import html
content = urllib2.urlopen(url).read()
encoding = chardet.detect(content)['encoding']
if encoding != 'utf-8':
    content = content.decode(encoding, 'replace').encode('utf-8')
doc = html.fromstring(content, base_url=url) 
```

但是当我使用时：

```
text = doc.text_content()
print type(text) 
```

输出是`<type 'lxml.etree._ElementUnicodeResult'>`。为什么？我认为这将是一个 utf-8 字符串。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T03:31:46.550

`lxml.etree._ElementUnicodeResult`是一个继承自的类`unicode`：

```
$ pydoc lxml.etree._ElementUnicodeResult

lxml.etree._ElementUnicodeResult = class _ElementUnicodeResult(__builtin__.unicode)
 |  Method resolution order:
 |      _ElementUnicodeResult
 |      __builtin__.unicode
 |      __builtin__.basestring
 |      __builtin__.object 
```

在 Python 中，拥有从基本类型扩展的类以添加一些特定于模块的功能是相当普遍的。将对象视为常规 Unicode 字符串应该是安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T01:04:48.687

您可能希望跳过重新编码步骤，因为`lxml.html`它将自动使用源文件中指定的编码，并且只要它最终成为有效的 unicode，也许没有理由担心它最初是如何编码的。

除非您的项目是如此的小和非正式，以至于您可以确定您永远不会遇到 8 位字符串（即它始终是 7 位 ASCII，没有特殊字符的英文），否则明智的做法是尽早将您的文本转换为 unicode（就像检索后一样）并保持这种状态，直到您需要将其序列化以写入文件或通过套接字发送。

您看到的原因`<type 'lxml.etree._ElementUnicodeResult'>`是因为`lxml.html.fromstring()`它会自动为您执行解码步骤。请注意，这意味着您上面的代码不适用于使用 UTF-16 编码的页面，例如，因为 8 位字符串将以 UTF-8 编码，但 html 仍会显示 utf-16

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-16" /> 
```

并且 lxml 将尝试根据 utf-16 编码规则对字符串进行解码，从而在短时间内引发我期望的异常。

如果您希望将输出序列化为**UTF-8**编码的 8 位字符串，您只需要以下内容：

```
>>> text = doc.text_content().encode('utf-8')
>>> print type(text)
<type 'str'> 
```

# html - 以 css 样式覆盖 *

> ID：13983730
> 
> 赞同：1
> 
> 时间：2012-12-21T03:02:19.203
> 
> 标签：html, css, input, vertical-alignment, overriding

我的 CSS 样式表：

```
 * {vertical-align:top;}  
input.test {vertical-align:middle;} 
```

这是我的 html 代码示例：

```
<input class="test" /><input class="test" /> 
```

所以我希望类测试覆盖*
我尝试过：

```
* {vertical-align:top;}
input.test {vertical-align:middle!important;} 
```

但它在 Firefox 上不起作用，并且垂直对齐仍然在顶部......
谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:11:52.893

...但是`vertical-align`，不幸的是，它不是适用于`input`元素的属性。

`!important`在这种情况下，没有任何区别。
`input.test`，事实上，已经是压倒一切的`*`

为什么？它是一个*更具体*的选择器，**CSS 都是关于**选择器的特殊性。
*即*具有最具体选择器的规则获胜。

因此，要影响该`input`元素的外观，您应该定位`td`包含它的单元格并设置*该* `vertical-align`值。

# jquery - 调整大小后导航消失

> ID：13983734
> 
> 赞同：0
> 
> 时间：2012-12-21T03:02:47.303
> 
> 标签：jquery, navigation, nav

有问题的网站：[http ://www.mtthwbsh.com](http://www.mtthwbsh.com)

我正在为该站点构建一个可折叠的导航，并注意到在它折叠后，如果您展开和缩回它并再次放大窗口，导航就会消失。我尝试将显示更改为阻止我的媒体查询，但我认为 jQuery 正在覆盖它。知道是什么原因造成的吗？

另外，我希望箭头在单击时旋转 180 度，我将如何定位它？我的jQuery如下：

```
/* toggle nav */
$("#menu-icon").on("click", function(){
$(".nav").slideToggle();
$(this).toggleClass("active");
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:13:42.737

`$(".nav").slideToggle();`似乎正在离开导航`display:none;`状态。当您尝试`display:block;`在媒体查询中设置时，您使用了`!important`吗？

**编辑**

如果您的屏幕尺寸小于 570px 需要切换，那么您需要确保在任何大于 570px 的尺寸下，它将在 CSS 中设置为 display:block;

```
@media (min-width:571px) {
    .nav { display:block!important; }
} 
```

这应该充分覆盖显示属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T04:37:26.867

在`style.css`，行号。1015，媒体查询用于`max-width:820px`

```
@media (max-width: 820px) 
```

检查这些图像，[可见导航](http://i1294.photobucket.com/albums/b603/vssranganadhp/Screenshot2012-12-21at100145AM_zpsfd8a03ea.png)，[隐藏导航（检查 css 检查器）](http://i1294.photobucket.com/albums/b603/vssranganadhp/Screenshot2012-12-21at100245AM_zps7bfc505d.png)

# xaml - 网格的背景图像不起作用

> ID：13983739
> 
> 赞同：1
> 
> 时间：2012-12-21T03:03:25.167
> 
> 标签：xaml, windows-8

我为我的网格设置了一个背景图像，它在设计器中显示正确，但是当我运行应用程序时，图像没有出现，背景是黑色的，有人有什么想法吗？下面是我的代码。

```
<Page.Resources>        
    <ImageBrush x:Key="BackgroundImage" ImageSource="People/Images/Background.jpg"/>
</Page.Resources>
<Grid Background="{StaticResource BackgroundImage}">
</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-22T04:02:17.520

我有同样的问题。正如 Jim 所建议的，您需要拥有正确的绝对路径。

我原来有：

> 资产\测验\image.png

它在设计器中显示良好，但在运行时不显示。我将其切换为：

> ms-appx:///Assets/Quizzes/image.png

现在它在设计器和运行时中正确显示。

# javascript - url解析javascript

> ID：13983742
> 
> 赞同：0
> 
> 时间：2012-12-21T03:04:03.310
> 
> 标签：javascript, dom

```
<a href="?action=add&question=149&cat=88">Answer</a>' 
```

这是获取 href 值所需的 url，我不能使用 element.getAttribute。我不能使用 dom 解析。但是如果我尝试使用搜索机制来解析它

```
td3_element = <td valign="top">
<a href="?action=add&question=149&cat=88">Answer</a>
</td>

href_start = td3_element.search("<a href=") + 8;
td3_part   = td3_element.substring(href_start);
href_end   = td3_part.search(">Answer</a>");
href_element = td3_part.substring(0,href_end);

href_element will only be till `?action=addamp` 
```

它正在采取

```
; 
```

字符`amp`作为行尾出现，它正在终止搜索到该点。有人可以告诉我一个解决方案，它可以在不使用 DOM 解析器的情况下提供所需的 href

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:11:28.797

你试过正则表达式吗？我不确定您所说的“搜索机制”是什么意思。

例如：

```
var htmlString = 'td3...(etc)';
var regex = /href="([^"])"/;
var hrefUrl = regex.exec()[1];
console.log(hrefUrl); //?action=add&question=149&cat=88 
```

另请参阅[此 jsfiddle](http://jsfiddle.net/Qfd8Z/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:15:49.463

尝试正则表达式

```
var a='<a href="?action=add&question=149&cat=88">Answer</a>';
a.match(/href="(.*)"/)[1]; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-21T03:19:07.897

这个怎么样：

**[JSBIN 演示](http://jsbin.com/ulejek/1/)**

创建一个临时 div，设置 innerHtml 和解析，

```
var str = '<a href="?action=add&question=149&cat=88">Answer</a>';

var div = document.createElement('div');
div.innerHTML = str;

document.write(div.childNodes[0].getAttribute('href')) 
```

# vb.net - 在 VB.net 中获取对象引用错误

> ID：13983743
> 
> 赞同：3
> 
> 时间：2012-12-21T03:04:03.107
> 
> 标签：vb.net

很好奇为什么在尝试在 VB.net 中调试我的程序时出现此错误

```
Object Reference not set to an instance of the object. 
```

它说由于第 4 行和第 5 行，我收到了这个错误：

```
Public Class Form1

Dim tSize
Dim S1 As String = ComboBox1.Text
Dim S2 As String = ComboBox2.Text

Private Sub FitContents()
    tSize = TextRenderer.MeasureText(TextBox3.Text, TextBox3.Font)
    TextBox3.Width = tSize.Width + 10
    TextBox3.Height = tSize.Height
End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    TextBox1.Text = S1
    TextBox2.Text = S2
End Sub

Private Sub TextBox3_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox3.TextChanged
    Call FitContents()
End Sub

End Class 
```

如果有人解释我收到此错误的原因，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T03:12:25.197

像 S1 和 S2 这样的类级变量在对象构造过程的早期就被初始化了。您的可视控件（如 Combobox1 和 Combobox2）在调用 InitializeComponent() 方法之前不会创建，直到几乎在构造函数结束时才会创建。

因此，当您尝试将 S1 设置为 Combobox1.Text 的值时，Combobox1 对象尚未创建，并且引用 Null 对象的 .Text 属性将给您该异常。

相反，在构造函数的末尾设置这些值，或者响应诸如 Load 之类的事件。

您也可以尝试将它们构建为属性...像这样：

```
Private Property S1() As String
    Get
        Return ComboBox1.Text
    End Get
    Set (ByVal value As String)
        ComboBox1.Text = value
    End Set
End Property 
```

# c# - 在 Windows 8 上获取电池状态

> ID：13983746
> 
> 赞同：4
> 
> 时间：2012-12-21T03:04:36.147
> 
> 标签：c#, windows-runtime, battery, batterylevel

我在 Internet 上进行了搜索，发现唯一有用的是在 Windows Phone 8 上获取电池状态的方法。但我希望它在 Windows 8 (RT) 上。

谁能帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T03:28:08.627

根据我能找到的一切，我们无法访问 WinRT 中的 Power API，它仅适用于桌面应用程序。请参阅此[MSDN 论坛文章](http://social.msdn.microsoft.com/Forums/en-US/winappswithnativecode/thread/63be5227-a1e1-43f2-8650-c861f0912b72)

从上面的链接：

> 电源管理功能仅适用于“桌面应用程序”。
> 
> Metro 风格应用中的 Power API 没有等效项。[请检查 Metro 风格应用程序中 Windows API 的替代方案](http://msdn.microsoft.com/en-us/library/windows/apps/hh464945.aspx)
> 
> 这是另一个线程[http://social.msdn.microsoft.com/Forums/en-US/tailoringappsfordevices/thread/3e9dc84c-bbf9-42f3-bc19-25bce3e7e04c](http://social.msdn.microsoft.com/Forums/en-US/tailoringappsfordevices/thread/3e9dc84c-bbf9-42f3-bc19-25bce3e7e04c)供您参考。

# mongodb - 用 MongoDB 飞镖

> ID：13983752
> 
> 赞同：7
> 
> 时间：2012-12-21T03:04:53.793
> 
> 标签：mongodb, dart

最近有没有关于在 MongoDB 中使用 Dart 的工作示例。我正在尝试的所有样本都出现错误。下面的例子。

代码：

```
import 'package:mongo_dart/mongo_dart.dart';

main(){
  Db db = new Db("mongo-dart-blog"); // Throws an error.
} 
```

错误：

```
Unhandled exception:
Invalid scheme in uri: mongo-dart-blog 
#0      Db.Db (package:mongo_dart/src/database/db.dart:25:7)
#1      main (file:///.../MongoDart/app.dart:4:11) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T06:07:32.853

我相信您正在运行一些旧版本的 mongo_dart 示例。我相信如果您能从 github [https://github.com/vadimtsushko/mongo_dart](https://github.com/vadimtsushko/mongo_dart)或 pub.dartlang.org 样本中获得新版本，并且测试会成功运行。新版博客示例中的对应行如下所示：

```
Db db = new Db("mongodb://127.0.0.1/mongo_dart-blog"); 
```

这是 Db.open 方法评论的摘录

Db 构造函数需要[有效的 mongodb URI](http://www.mongodb.org/display/DOCS/Connections)。例如，下一个代码指向默认 mongodb 端口上的本地 mongodb 服务器，数据库 testdb

```
var db = new Db('mongodb://127.0.0.1/testdb'); 
```

并且该代码直接到 MongoLab 服务器*ds037637-a.mongolab.com*上的 37637 端口，数据库*博客*，用户名*dart*，密码*测试*

```
var db = new Db('mongodb://dart:test@ds037637-a.mongolab.com:37637/blog'); 
```

不幸的是，由于旧的 dartdoc 错误，github 站点上的 API DOC 非常陈旧： [http ://code.google.com/p/dart/issues/detail?id=5218](http://code.google.com/p/dart/issues/detail?id=5218)

我希望它会很快得到修复，我将能够为 mongo_dart 生成有效的 API 文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-26T08:26:29.447

我自己在客户端 Dart 中使用 MongoDB 时遇到了很多麻烦。我最终将 Mongo 调用移至后端，并使用 REST 和 Json 的组合在两端之间进行通信。[你可以在https://github.com/RossBabcock3/dartgo3](https://github.com/RossBabcock3/dartgo3)找到我写的一个例子

# c# - 什么情况下一个线程可以同时多次进入一个锁（Monitor）区域？

> ID：13983753
> 
> 赞同：8
> 
> 时间：2012-12-21T03:05:25.273
> 
> 标签：c#, .net, concurrency, thread-safety, locking

（问题已修改）：到目前为止，答案都包括单个线程通过递归等方式线性重新进入锁定区域，您可以在其中跟踪单个线程两次进入锁定的步骤。但是是否有可能以某种方式生成单个线程（可能来自 ThreadPool，可能是由于计时器事件或异步事件或线程进入睡眠状态并分别在其他一些代码块中被唤醒/重用）以某种方式产生两个彼此独立的不同地方，因此，当开发人员通过阅读自己的代码没想到会遇到锁重入问题时？

在 ThreadPool 类备注（[点击这里](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)）中，备注似乎建议休眠线程在不使用时应被重用，否则会因休眠而浪费。

但是在 Monitor.Enter 参考页面（[单击此处](http://msdn.microsoft.com/en-us/library/de0542zz.aspx)）上，他们说*“同一线程在不阻塞的情况下多次调用 Enter 是合法的。”* 所以我想一定有一些我应该小心避免的事情。它是什么？一个线程怎么*可能两次进入同一个锁定区域？*

假设您有一些锁定区域需要很长时间。这可能是现实的，例如，如果您访问一些已被分页（或其他）的内存。锁定区域中的线程可能会进入睡眠状态或其他情况。同一个线程是否有资格运行更多代码，这些代码可能会意外进入同一个锁定区域？在我的测试中，以下内容不会让同一线程的多个实例运行到同一锁定区域。

那么如何产生问题呢？你究竟需要小心避免什么？

```
class myClass
{
    private object myLockObject;
    public myClass()
    {
        this.myLockObject = new object();
        int[] myIntArray = new int[100];               // Just create a bunch of things so I may easily launch a bunch of Parallel things
        Array.Clear(myIntArray, 0, myIntArray.Length); // Just create a bunch of things so I may easily launch a bunch of Parallel things
        Parallel.ForEach<int>(myIntArray, i => MyParallelMethod());
    }
    private void MyParallelMethod()
    {
        lock (this.myLockObject)
        {
            Console.Error.WriteLine("ThreadId " + Thread.CurrentThread.ManagedThreadId.ToString() + " starting...");
            Thread.Sleep(100);
            Console.Error.WriteLine("ThreadId " + Thread.CurrentThread.ManagedThreadId.ToString() + " finished.");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-21T06:45:28.343

假设您有一个包含操作的队列：

```
public static Queue<Action> q = whatever; 
```

假设`Queue<T>`有一个方法`Dequeue`返回一个布尔值，指示队列是否可以成功出队。

假设你有一个循环：

```
static void Main()
{
    q.Add(M);
    q.Add(M);
    Action action;
    while(q.Dequeue(out action)) 
      action();
}
static object lockObject = new object();
static void M()
{
    Action action;
    lock(lockObject) 
    { 
        if (q.Dequeue(out action))
            action();
    }
} 
```

显然主线程两次进入M中的锁；此代码是可*重入的*。也就是说，它通过间接递归进入*自身。*

这段代码对你来说看起来不可信吗？它不应该。**这就是 Windows 的工作方式**。每个窗口都有一个消息队列，当“泵送”消息队列时，会调用与这些消息对应的方法。当你点击一个按钮时，一条消息进入消息队列；当队列被抽出时，对应于该消息的点击处理程序被调用。

因此，编写 Windows 程序的锁包含对泵送消息循环的方法的调用是极其常见且极其危险的。如果您首先因为处理消息而进入该锁，并且如果消息在队列中两次，那么代码将间接进入自身，这可能会导致各种疯狂。

消除这种情况的方法是（1）永远不要在锁内做任何稍微复杂的事情，以及（2）当您处理消息时，*禁用处理程序*直到处理完消息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-21T03:12:24.747

如果您有这样的结构，则可以重新进入：

```
Object lockObject = new Object(); 

void Foo(bool recurse) 
{
  lock(lockObject)
   { 
       Console.WriteLine("In Lock"); 
       if (recurse)  { foo(false); }
   }
} 
```

虽然这是一个非常简单的示例，但在许多具有相互依赖或递归行为的场景中都是可能的。

例如：

*   ComponentA.Add()：锁定一个通用的“ComponentA”对象，将新项目添加到 ComponentB。
*   ComponentB.OnNewItem()：新项目触发列表中每个项目的数据验证。
*   ComponentA.ValidateItem()：锁定一个通用的“ComponentA”对象来验证项目。

需要在同一个锁上重新进入同一个线程，以确保您自己的代码不会发生死锁。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-21T03:24:22.330

可以递归到锁定块的更微妙的方法之一是在 GUI 框架中。例如，您可以在单个 UI 线程（Form 类）上异步调用代码

```
private object locker = new Object();
public void Method(int a)
{
    lock (locker)
    {
        this.BeginInvoke((MethodInvoker) (() => Method(a)));
    }
} 
```

当然，这也会陷入无限循环；您可能有一个条件，您希望通过该条件进行递归，此时您不会有无限循环。

使用`lock`不是睡眠/唤醒线程的好方法。我将简单地使用现有的框架，如任务并行库 (TPL) 来简单地创建抽象任务（请参阅 参考资料`Task`）来创建，并且底层框架处理创建新线程并在需要时将它们休眠。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-21T05:53:33.430

恕我直言，重新进入锁并不是您需要注意避免的事情（鉴于许多人的锁定心理模型，这充其量是危险的，请参见下面的**编辑**）。文档的重点是解释线程不能使用`Monitor.Enter`. 并非所有同步机制、框架和语言都如此。有些具有不可重入同步，在这种情况下，您必须小心线程不会阻塞自己。你需要小心的是总是打电话`Monitor.Exit`给每个`Monitor.Enter`电话。`lock`关键字会自动为您执行此操作。

重入的一个简单例子：

```
private object locker = new object();

public void Method()
{
  lock(locker)
  {
    lock(locker) { Console.WriteLine("Re-entered the lock."); }
  }
} 
```

线程两次进入同一个对象的锁，所以它必须被释放两次。通常它不是那么明显，并且有各种方法相互调用，在同一个对象上同步。关键是您不必担心线程本身会阻塞。

也就是说，您通常应该尽量减少持有锁所需的时间。获取锁的计算成本并不高，与您可能听到的相反（大约为几纳秒）。锁争用是昂贵的。

**编辑**

请阅读下面 Eric 的评论以获取更多详细信息，但总结是，当您看到它时，您`lock`的解释应该是“此代码块的所有激活都与单个线程相关联”，而*不是*像通常解释的那样，“此代码块的所有激活都作为单个原子单元执行”。

例如：

```
public static void Main()
{
  Method();
}

private static int i = 0;
private static object locker = new object();
public static void Method()
{
  lock(locker)
  {
    int j = ++i;

    if (i < 2)
    {
      Method();
    }

    if (i != j)
    {
      throw new Exception("Boom!");
    }
  }
} 
```

显然，这个程序炸毁了。没有`lock`，结果是一样的。危险在于，这`lock`会导致您产生一种错误的安全感，即在初始化`j`和评估`if`. 问题是你（也许是无意的）已经`Method`递归到自身并且`lock`不会阻止它。正如 Eric 在他的回答中指出的那样，您可能直到有一天有人同时排队太多操作时才会意识到这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-01T13:09:31.617

ThreadPool 线程不能仅仅因为它们进入睡眠状态而在其他地方重用；他们需要在重新使用之前完成。在锁定区域中花费很长时间的线程没有资格在其他一些独立的控制点运行更多代码。体验锁重入的唯一方法是通过递归或执行锁内的方法或委托来重入锁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-31T18:59:24.093

让我们想想递归以外的东西。
在一些业务逻辑中，他们希望控制同步的行为。其中一种模式，它们在`Monitor.Enter`某处调用，并希望`Monitor.Exit`稍后在其他地方调用。这是获取有关此想法的代码：

```
public partial class Infinity: IEnumerable<int> {
    IEnumerator IEnumerable.GetEnumerator() {
        return this.GetEnumerator();
    }

    public IEnumerator<int> GetEnumerator() {
        for(; ; )
            yield return ~0;
    }

    public static readonly Infinity Enumerable=new Infinity();
}

public partial class YourClass {
    void ReleaseLock() {
        for(; lockCount-->0; Monitor.Exit(yourLockObject))
            ;
    }

    void GetLocked() {
        Monitor.Enter(yourLockObject);
        ++lockCount;
    }

    void YourParallelMethod(int x) {
        GetLocked();
        Debug.Print("lockCount={0}", lockCount);
    }

    public static void PeformTest() {
        new Thread(
            () => {
                var threadCurrent=Thread.CurrentThread;
                Debug.Print("ThreadId {0} starting...", threadCurrent.ManagedThreadId);

                var intanceOfYourClass=new YourClass();

                // Parallel.ForEach(Infinity.Enumerable, intanceOfYourClass.YourParallelMethod);
                foreach(var i in Enumerable.Range(0, 123))
                    intanceOfYourClass.YourParallelMethod(i);

                intanceOfYourClass.ReleaseLock();

                Monitor.Exit(intanceOfYourClass.yourLockObject); // here SynchronizationLockException thrown
                Debug.Print("ThreadId {0} finished. ", threadCurrent.ManagedThreadId);
            }
            ).Start();
    }

    object yourLockObject=new object();
    int lockCount;
} 
```

如果您调用`YourClass.PeformTest()`并获得大于 1 的 lockCount，则您已重新进入；**不一定是并发**的。
**如果重入不安全，您将陷入**foreach 循环。
在 where `Monitor.Exit(intanceOfYourClass.yourLockObject)`will throw you a的代码块中`SynchronizationLockException`，这是因为我们尝试调用`Exit`的次数超过了它输入的次数。如果你要使用`lock`关键字，除了直接或间接的递归调用，你可能不会遇到这种情况。我想这就是`lock`提供关键字的原因：它可以防止`Monitor.Exit`以粗心的方式省略 。
我评论了 的调用`Parallel.ForEach`，如果您有兴趣，那么您可以测试它的乐趣。

测试代码`.Net Framework 4.0`是最低要求，并且还需要以下额外的名称空间：

```
using System.Threading.Tasks;
using System.Diagnostics;
using System.Threading;
using System.Collections; 
```

玩得开心。

# javascript - 使用 HTML 5 和 JS 创建飘雪

> ID：13983764
> 
> 赞同：37
> 
> 时间：2012-12-21T03:08:02.843
> 
> 标签：javascript, html, canvas

我访问了[Stack Exchange Winter Bash 网站](http://winterba.sh/)，我喜欢落雪！我的问题是，我怎样才能重新创建一个看起来一样好的类似效果。我试图对代码进行逆向工程，看看我是否能弄清楚，但可惜没有运气。JS 在我头上。我做了一些谷歌搜索并遇到了一些[示例](http://seb.ly/demos/JSSnow/snow3d.html)，但它们不如 SE 站点优雅或看起来不太好。

任何人都可以提供一些关于如何复制 SE Winter Bash 站点创建的内容或我可以学习如何执行此操作的地方的说明吗？

*编辑：*我想尽可能接近地复制效果，即：用雪花飘落的雪，并且能够移动鼠标并使雪随着鼠标的瞬间移动或旋转。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-12-21T03:40:53.690

好问题，实际上我前段时间写了一个雪插件，我会不断更新，**[看看它的实际效果](http://loktar00.github.com/JQuery-Snowfall/)**。[还有一个纯js源的链接](https://github.com/loktar00/JQuery-Snowfall/blob/master/src/snowfall.js)

我注意到您标记了问题 html5 和 canvas，但是您可以在不使用任何一个的情况下执行此操作，而只需使用带有图像或不同背景颜色的标准元素。

这是我刚才放在一起的两个非常简单的方法，供您使用。在我看来，关键是使用 sin 在薄片掉落时获得漂亮的波浪效果。第一个使用 canvas 元素，第二个使用常规 dom 元素。

因为我完全沉迷于画布，所以我认为这是一个画布版本，它的表现非常好。

**[帆布版](http://jsfiddle.net/loktar/UdyN6/)**

**[全屏](http://codepen.io/loktar00/full/CHpGo)**

```
(function() {
    var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame ||
    function(callback) {
        window.setTimeout(callback, 1000 / 60);
    };
    window.requestAnimationFrame = requestAnimationFrame;
})();

var flakes = [],
    canvas = document.getElementById("canvas"),
    ctx = canvas.getContext("2d"),
    flakeCount = 200,
    mX = -100,
    mY = -100

    canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

function snow() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    for (var i = 0; i < flakeCount; i++) {
        var flake = flakes[i],
            x = mX,
            y = mY,
            minDist = 150,
            x2 = flake.x,
            y2 = flake.y;

        var dist = Math.sqrt((x2 - x) * (x2 - x) + (y2 - y) * (y2 - y)),
            dx = x2 - x,
            dy = y2 - y;

        if (dist < minDist) {
            var force = minDist / (dist * dist),
                xcomp = (x - x2) / dist,
                ycomp = (y - y2) / dist,
                deltaV = force / 2;

            flake.velX -= deltaV * xcomp;
            flake.velY -= deltaV * ycomp;

        } else {
            flake.velX *= .98;
            if (flake.velY <= flake.speed) {
                flake.velY = flake.speed
            }
            flake.velX += Math.cos(flake.step += .05) * flake.stepSize;
        }

        ctx.fillStyle = "rgba(255,255,255," + flake.opacity + ")";
        flake.y += flake.velY;
        flake.x += flake.velX;

        if (flake.y >= canvas.height || flake.y <= 0) {
            reset(flake);
        }

        if (flake.x >= canvas.width || flake.x <= 0) {
            reset(flake);
        }

        ctx.beginPath();
        ctx.arc(flake.x, flake.y, flake.size, 0, Math.PI * 2);
        ctx.fill();
    }
    requestAnimationFrame(snow);
};

function reset(flake) {
    flake.x = Math.floor(Math.random() * canvas.width);
    flake.y = 0;
    flake.size = (Math.random() * 3) + 2;
    flake.speed = (Math.random() * 1) + 0.5;
    flake.velY = flake.speed;
    flake.velX = 0;
    flake.opacity = (Math.random() * 0.5) + 0.3;
}

function init() {
    for (var i = 0; i < flakeCount; i++) {
        var x = Math.floor(Math.random() * canvas.width),
            y = Math.floor(Math.random() * canvas.height),
            size = (Math.random() * 3) + 2,
            speed = (Math.random() * 1) + 0.5,
            opacity = (Math.random() * 0.5) + 0.3;

        flakes.push({
            speed: speed,
            velY: speed,
            velX: 0,
            x: x,
            y: y,
            size: size,
            stepSize: (Math.random()) / 30,
            step: 0,
            angle: 180,
            opacity: opacity
        });
    }

    snow();
};

canvas.addEventListener("mousemove", function(e) {
    mX = e.clientX,
    mY = e.clientY
});

init();​ 
```

**[标准元件版本](http://jsfiddle.net/loktar/guexx/)**

```
var flakes = [],
    bodyHeight = getDocHeight(),
    bodyWidth = document.body.offsetWidth;

function snow() {
    for (var i = 0; i < 50; i++) {
        var flake = flakes[i];

        flake.y += flake.velY;

        if (flake.y > bodyHeight - (flake.size + 6)) {
            flake.y = 0;
        }

        flake.el.style.top = flake.y + 'px';
        flake.el.style.left = ~~flake.x + 'px';

        flake.step += flake.stepSize;
        flake.velX = Math.cos(flake.step);

        flake.x += flake.velX;

        if (flake.x > bodyWidth - 40 || flake.x < 30) {
            flake.y = 0;
        }
    }
    setTimeout(snow, 10);
};

function init() {
    var docFrag = document.createDocumentFragment();
    for (var i = 0; i < 50; i++) {
        var flake = document.createElement("div"),
            x = Math.floor(Math.random() * bodyWidth),
            y = Math.floor(Math.random() * bodyHeight),
            size = (Math.random() * 5) + 2,
            speed = (Math.random() * 1) + 0.5;

        flake.style.width = size + 'px';
        flake.style.height = size + 'px';
        flake.style.background = "#fff";

        flake.style.left = x + 'px';
        flake.style.top = y;
        flake.classList.add("flake");

        flakes.push({
            el: flake,
            speed: speed,
            velY: speed,
            velX: 0,
            x: x,
            y: y,
            size: 2,
            stepSize: (Math.random() * 5) / 100,
            step: 0
        });
        docFrag.appendChild(flake);
    }

    document.body.appendChild(docFrag);
    snow();
};

document.addEventListener("mousemove", function(e) {
    var x = e.clientX,
        y = e.clientY,
        minDist = 150;

    for (var i = 0; i < flakes.length; i++) {
        var x2 = flakes[i].x,
            y2 = flakes[i].y;

        var dist = Math.sqrt((x2 - x) * (x2 - x) + (y2 - y) * (y2 - y));

        if (dist < minDist) {
            rad = Math.atan2(y2, x2), angle = rad / Math.PI * 180;

            flakes[i].velX = (x2 / dist) * 0.2;
            flakes[i].velY = (y2 / dist) * 0.2;

            flakes[i].x += flakes[i].velX;
            flakes[i].y += flakes[i].velY;
        } else {
            flakes[i].velY *= 0.9;
            flakes[i].velX
            if (flakes[i].velY <= flakes[i].speed) {
                flakes[i].velY = flakes[i].speed;
            }
        }
    }
});

init();

function getDocHeight() {
    return Math.max(
    Math.max(document.body.scrollHeight, document.documentElement.scrollHeight), Math.max(document.body.offsetHeight, document.documentElement.offsetHeight), Math.max(document.body.clientHeight, document.documentElement.clientHeight));
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-12-26T04:18:26.400

我创建了一个纯 HTML 5 和 js 降雪。在我的代码笔上查看：[https ://codepen.io/onlintool24/pen/GRMOBVo](https://codepen.io/onlintool24/pen/GRMOBVo)

```
// Amount of Snowflakes
var snowMax = 35;

// Snowflake Colours
var snowColor = ["#DDD", "#EEE"];

// Snow Entity
var snowEntity = "&#x2022;";

// Falling Velocity
var snowSpeed = 0.75;

// Minimum Flake Size
var snowMinSize = 8;

// Maximum Flake Size
var snowMaxSize = 24;

// Refresh Rate (in milliseconds)
var snowRefresh = 50;

// Additional Styles
var snowStyles = "cursor: default; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none; user-select: none;";

/*
// End of Configuration
// ----------------------------------------
// Do not modify the code below this line
*/

var snow = [],
    pos = [],
    coords = [],
    lefr = [],
    marginBottom,
    marginRight;

function randomise(range) {
    rand = Math.floor(range * Math.random());
    return rand;
}

function initSnow() {
    var snowSize = snowMaxSize - snowMinSize;
    marginBottom = document.body.scrollHeight - 5;
    marginRight = document.body.clientWidth - 15;

    for (i = 0; i <= snowMax; i++) {
        coords[i] = 0;
        lefr[i] = Math.random() * 15;
        pos[i] = 0.03 + Math.random() / 10;
        snow[i] = document.getElementById("flake" + i);
        snow[i].style.fontFamily = "inherit";
        snow[i].size = randomise(snowSize) + snowMinSize;
        snow[i].style.fontSize = snow[i].size + "px";
        snow[i].style.color = snowColor[randomise(snowColor.length)];
        snow[i].style.zIndex = 1000;
        snow[i].sink = snowSpeed * snow[i].size / 5;
        snow[i].posX = randomise(marginRight - snow[i].size);
        snow[i].posY = randomise(2 * marginBottom - marginBottom - 2 * snow[i].size);
        snow[i].style.left = snow[i].posX + "px";
        snow[i].style.top = snow[i].posY + "px";
    }

    moveSnow();
}

function resize() {
    marginBottom = document.body.scrollHeight - 5;
    marginRight = document.body.clientWidth - 15;
}

function moveSnow() {
    for (i = 0; i <= snowMax; i++) {
        coords[i] += pos[i];
        snow[i].posY += snow[i].sink;
        snow[i].style.left = snow[i].posX + lefr[i] * Math.sin(coords[i]) + "px";
        snow[i].style.top = snow[i].posY + "px";

        if (snow[i].posY >= marginBottom - 2 * snow[i].size || parseInt(snow[i].style.left) > (marginRight - 3 * lefr[i])) {
            snow[i].posX = randomise(marginRight - snow[i].size);
            snow[i].posY = 0;
        }
    }

    setTimeout("moveSnow()", snowRefresh);
}

for (i = 0; i <= snowMax; i++) {
    document.write("<span id='flake" + i + "' style='" + snowStyles + "position:absolute;top:-" + snowMaxSize + "'>" + snowEntity + "</span>");
}

window.addEventListener('resize', resize);
window.addEventListener('load', initSnow);
```

```
body{
  background: skyblue;
  height:100%;
  width:100%;
    display:block;
  position:relative;
}
```

```
<span id="flake0" style="cursor: default; user-select: none; position: absolute; font-family: inherit; font-size: 19px; color: rgb(221, 221, 221); z-index: 1000; left: 226px; top: 561px;">•&lt;/span>
```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2012-12-21T03:12:52.153

飘落的雪花很简单：创建一个画布，创建一堆雪花，然后绘制它们。

你可以像这样创建一个雪花类：

```
function Snowflake() {
    this.x = Math.random()*canvas.width;
    this.y = -16;
    this.speed = Math.random()*3+1;
    this.direction = Math.random()*360;
    this.maxSpeed = 4;
} 
```

或类似的东西。然后你有一个计时器，每一步都会少量调整每个雪花的方向，然后通过考虑速度和方向来计算新的 X 和 Y。

这很难解释，但实际上非常基本。

# email - GNU mailman - questions and testing

> ID：13983766
> 
> 赞同：2
> 
> 时间：2012-12-21T03:08:13.947
> 
> 标签：email, header, mailman

I feel really stupid asking this question, but I recently signed up to a GNU mailman list for the first time ever and can't quite figure out how to interact with it properly. I can't find any documentation anywhere on how to participate as a list member. In particular, I am trying to figure out how to make my responses nest properly when replying from a Gmail account. Through some sparse info I've gleaned, I found that the "In-Reply-To" header is supposedly the one that determines where your message nests on the list.

So, I posted a new message to the list, and when somebody replied to me, I received a copy in my Gmail in addition to the post on the list archives page. I replied to the Gmail and addressed it back to the main list address. After sending, I examined the Gmail headers, and `In-Reply-To` was indeed set to the `Message-ID` of the person who had replied to me, so I thought my response would be nested under his. Unfortunately, it was not. It was nested underneath my own OP, **next** to his. I can't figure out why, except that there is another header `References`, which in my response, included **two** `Message-ID`'s, both the one from my original post, and the one from the first response.

None of this stuff is intuitive at all or explained anywhere that I can find, and Gmail of course gives you no control of email headers... but I don't want to switch to an entirely new mail service just to interact with a Mailman list. Nor do I want to spam a real list with a bunch of stupid test messages of me figuring out what is probably supposed to be a very simple system. Does anybody know of a test instance of mailman somewhere that I can send a few mails to just so get this all sorted out? I found what appeared to be a couple, but none of them were actually accepting mail.

# javascript - JQuery need to push down page content on WordPress

> ID：13983769
> 
> 赞同：1
> 
> 时间：2012-12-21T03:08:59.710
> 
> 标签：javascript, jquery, html, wordpress

I have a unique situation and I will do my best to explain what I am trying to accomplish. I hope I am clear and someone can provide the framework to execute this.

Using WordPress, I would like to inject a landing page or a bit of content on top of any page a visitor hits on my site. For example, a user comes to my site and after 4 seconds all the page content moves down and displays whatever I specify. So I could in fact have `google.com` show up and push down my page or `facebook.com` or a big photo of my smiling face. :)

Anyone have any suggestions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:22:00.227

您应该能够使用 JQuery 来实现这一点。

查看[JSFiddle上的示例](http://jsfiddle.net/mFwmy/)

```
$(function() {
    var wait=2000; //ms to wait

    setTimeout(function() {
        var popdown=$("<div style='background-color:red; border:1px solid black; display:none'>Whatever you want to popdown</div>");

        $('html').prepend(popdown);
        $(popdown).slideDown();
    }, wait);
});​ 
```

# java - convert bitmap into ninepatch to use as background

> ID：13983775
> 
> 赞同：2
> 
> 时间：2012-12-21T03:09:39.883
> 
> 标签：java, android, image, bitmap, nine-patch

I have a problem I've been stuck on for a few days. I am trying to convert a nine patch image into a bitmap array, and change a specific color to a different one. I am having trouble converting the bitmap back to a nine patch, so I can use it as a background for a layout. I have tried using this code to create the bitmap then convert it back to a nine-patch drawable, but it just starts the activity and blinks black then goes back to the parent activity. If I comment out the creation and initialization of the nine-patch the activity starts just fine.

```
 Bitmap backMap = BitmapFactory.decodeResource(getResources(),R.drawable.outerbackground);
 backMap = backMap.copy(Bitmap.Config.ARGB_8888, true);
 backMap = getChangedColor(backMap, Color.rgb(212, 212, 212), Color.rgb(55, 50, 255));

 byte[] chunk = backMap.getNinePatchChunk();
 NinePatchDrawable np_drawable = new NinePatchDrawable(getResources(), backMap, chunk, new Rect(), null);
 np_drawable.setBounds(0, 0, backMap.getWidth(), backMap.getHeight()); 
```

I usually don't ask for help on such a thing, but I have went through all the documentation I could find on nine-patch images and bitmaps and still can't figure it out.

Long question short, I need to know how to convert a bitmap to a nine-patch image for use as a background. Thanks a million in advance. you'll get the other million after your done.

O and I am targeting version 16 with the minimum of 8.

# ruby-on-rails - 我需要测试我正在使用的 Ruby Gems (Devise) 的功能吗？

> ID：13983777
> 
> 赞同：1
> 
> 时间：2012-12-21T03:09:58.550
> 
> 标签：ruby-on-rails, rspec, devise

我对 Rails 还很陌生，但我读过 Michael Hartl 的书（超级丰富，顺便说一句）。

但是，我开始使用[Devise](https://github.com/plataformatec/devise)（也很有帮助）并且我有一个关于使用 rspec 进行测试的问题。在 Hartl 的书中，有所有这些用于用户验证的测试，例如电子邮件的唯一性，或者是否创建了具有有效属性的用户。

如果我使用 Devise，是否需要像这样的简单测试？

我问的部分原因是我不知道如何编写测试，即使我知道它们正在工作。一般来说，您是否需要测试 gem 以查看其内部功能是否正常工作？或者我可以假设这将起作用并且只测试可以创建和登录用户并完成它吗？

我确实测试了我的 CanCan 是如何测试我是否被重定向的，但这似乎更像是测试我创建的规则是否正确。测试 Devise 的内部功能似乎过分了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T03:20:04.070

我认为测试设计的内部功能是过度的。但是，如果您对设计进行更改，无论是视图、控制器还是验证，那么测试您的更改是合适的。

我也总是有请求/接受测试来测试我的应用程序的登录/注册部分。

你还问：

> 一般来说，您是否需要测试 gem 以查看其内部功能是否正常工作？

不，通常不会这样做。我喜欢寻找的东西：在 gem 的 github 或网页上，它们是否链接到 TravisCI --- 你可以查看他们当前的测试套件是否有效。一般来说，在你的水平上测试，而不是低于你的水平。例如，不要测试 Rails 是否有效，只需使用 Rails。

# java - 无法显示 jTable 的标题

> ID：13983780
> 
> 赞同：1
> 
> 时间：2012-12-21T03:10:48.827
> 
> 标签：java, swing, jtable, jscrollpane, jtableheader

这些是我在 java swing 中的 jTable 代码。

```
private JTable getJTable() {
    if (jTable == null) {
        Vector columnNames = new Vector(); //Vector class allows dynamic array of objects
        Vector data = new Vector();
        JPanel panel = new JPanel();   
        panel.setSize(new Dimension(198, 106));

        try {
            DBController db = new DBController();
            db.setUp("IT Innovation Project");
            Class.forName("sun.jdbc.odbc.JdbcOdbcDriver").newInstance();
            String dsn = "IT Innovation Project";
            String s = "jdbc:odbc:" + dsn;
            Connection con = DriverManager.getConnection(s, "", "");
            String sql = "Select * from forumTopics";
            java.sql.Statement statement = con.createStatement();
            ResultSet resultSet = statement.executeQuery(sql);
            ResultSetMetaData metaData = resultSet.getMetaData();
            int columns = metaData.getColumnCount();

            for (int i = 1; i <= columns; i++) {
                columnNames.addElement(metaData.getColumnName(i));
            }

            while (resultSet.next()) {
                Vector row = new Vector(columns);
                for (int i = 1; i <= columns; i++) {
                    row.addElement(resultSet.getObject(i));
                }
                data.addElement(row);
            }

            resultSet.close();
            ((Connection) statement).close();
        } catch (Exception e) {
            System.out.println(e);
        }

        jTable = new JTable(data, columnNames);
        TableColumn column;

        for (int i = 0; i < jTable.getColumnCount(); i++) {
            column = jTable.getColumnModel().getColumn(i);
            column.setMaxWidth(250);
        }

        String header[] = {"description", "title", "category", "posted by"};  

        for(int i=0;i<jTable.getColumnCount();i++) { 
            TableColumn column1 = jTable.getTableHeader().getColumnModel().getColumn(i);    
            column1.setHeaderValue(header[i]);  
        } 

        jTable.setBounds(new Rectangle(82, 218, 736, 292));
        jTable.setEnabled(false);
        jTable.setRowHeight(50);
        jTable.getRowHeight();         
    }
    return jTable;
} 
```

我为表格的标题设置了一个数组。但是，该程序仅显示我的数据库中的数据，没有任何标题。有人可以启发我吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T04:12:32.240

把你`JTable`的`JScrollPane`喜欢

```
add(new JScrollPane( getJTable() ) ); 
```

# c# - 如何设置以便我可以在 ASP.NET MVC 4 源代码中设置断点？

> ID：13983781
> 
> 赞同：1
> 
> 时间：2012-12-21T03:11:14.497
> 
> 标签：c#, asp.net-mvc-4

我正在尝试在 MVC 4 的源代码中设置断点。

以下是我采取的步骤：

*   [在 git clone https://git01.codeplex.com/aspnetwebstack.git](https://git01.codeplex.com/aspnetwebstack.git)克隆了 Git 存储库
*   在视觉工作室编译
*   执行：`sn -Vr *`
*   向解决方案添加了 MVC 4 项目
*   删除了对 System.Web.Mvc 的引用，并将其从解决方案的本地项目中添加回来

不过，当我运行它时，我得到了关于程序集签名的错误。我承认我从来不需要对程序集签名做太多事情——但据我了解，该`sn`命令禁用了它。

关于如何成功设置它以便我可以逐步完成代码的任何建议？

**我得到的错误：**

> 无法加载文件或程序集“System.Web.Mvc”或其依赖项之一。无法验证强名称签名。程序集可能已被篡改，或者它被延迟签名但未使用正确的私钥完全签名。（来自 HRESULT 的异常：0x80131045）

可能是让我搞砸的“它的依赖项之一”部分吗？我是否做出了错误的假设，也许我只能引用本地构建的程序集之一？（我只是猜测）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:42:43.753

[构建说明](http://aspnetwebstack.codeplex.com/wikipage?title=Building%20from%20Source)提到下载和运行（从提升的命令提示符），`SkipStrongNames -e`可执行文件在[此处](http://aka.ms/skipsn)可用。

但是，我认为能够直接在您的项目中调试框架和第三方库，而不必弄乱这些库的源代码会更有用。您只需要调试符号并相应地配置[VS。](http://weblogs.asp.net/gunnarpeipman/archive/2010/07/04/stepping-into-asp-net-mvc-source-code-with-visual-studio-debugger.aspx)关于符号服务器，如果可以的话，我会开始使用[symbolsource.org](http://www.symbolsource.org/Public/Home/VisualStudio)以获得更好的覆盖率。

# c# - 修改 app.config 以连接到未安装 SQL Server Management Studio 的计算机中的数据库文件

> ID：13983784
> 
> 赞同：2
> 
> 时间：2012-12-21T03:11:38.600
> 
> 标签：c#, sql-server

我使用 .net4 创建了一个软件，它使用 ORM 并连接到数据库。因此，当我需要连接到文件时，我必须首先打开 SQL Server Management Studio 并将数据库附加到它，然后如果我不这样做，我就可以使用我的软件，它会引发底层提供程序失败的异常打开。

现在我想将该软件部署到我的兄弟计算机上，他的计算机上没有安装 Visual Basic 和 SQL Server（但他有 .net 框架）所以有没有办法可以修改我`app.config`的指向数据库文件并且我不需要将文件附加到 SQL Server？

只是我不想一次又一次地将文件附加或分离到数据库中，.net 如何自动附加它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T08:05:49.137

实际上，安装 SQL Server 2012 Express LocalDB（它可能已经随 Visual Studio 2012 安装），然后修改连接字符串，如下所示：

```
connectionstring="data source=(LocalDB)\v11.0;attachdbfilename=c:\MyDatabaseFile.mdf;integrated security=True;" 
```

该`(LocalDB)\v11.0`部分是您指向 LocalDB“实例”的位置，您可以附加任何所需的 mdf 文件。请记住，这会锁定 mdf 文件，因此您无法在 Management Studio 中打开它并运行您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:40:59.620

您提到附加数据库，但不想安装 SQL Server。我会看看[SQL Server Express LocalDB](http://msdn.microsoft.com/en-us/library/hh510202.aspx)。虽然它在技术上是安装的，但它不是作为 Windows 服务安装的，因此它比完整的 SQL Server 或 SQL Express 轻得多。

# c# - 在 GridView/DetailsView 中显示外键数据

> ID：13983786
> 
> 赞同：2
> 
> 时间：2012-12-21T03:11:51.163
> 
> 标签：c#, asp.net, visual-studio-2010, gridview, detailsview

我有两张桌子..

`Students`

*   学生卡
*   姓名
*   学号

`School`

*   学号
*   学校名称。

这是我的场景，我`DetailsView`在我的页面上创建了一个显示 X StudentID 及其列的页面。显示 SchoolID（来自学生表）列时，它将按预期显示实际 ID。

我想知道如何显示实际的学校名称而不是 schoolID，我首先做的只是在第一个查询中进行查询，该查询显示学校的名称......

```
SELECT StudentID, (SELECT SchoolName FROM Schools 
                WHERE Schools.SchoolID = Students.SchoolID) 
                FROM Students WHERE StudentID=1 
```

尽管这可行，但在尝试通过 编辑记录时会产生问题`GridView`，但它不会在这些字段中保存正确的数据。

在编辑步骤中，`GridView`我可以将 SchoolID 键与 SchoolName 绑定，但是在查询中有查询时这将不起作用。

所以我的问题是如何在不更改 SQL 命令的情况下在 Visual Studio 中显示外键数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T07:56:36.310

您可以使用连接查询来做到这一点，例如：

```
select students.StudentId,students.Name,students.SchoolID,school.SchoolName from students join school on students.SchoolID=school.SchoolID 
```

而且，为了更好地理解“JOINS”，这里有一个有用的链接：[http ://www.sitepoint.com/understanding-sql-joins-mysql-database/](http://www.sitepoint.com/understanding-sql-joins-mysql-database/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T05:39:11.333

以前的解决方案是编辑 Select 命令（在创建 SQLDatasource 之后）以对包含有意义的字段名称的表执行内部连接。

**在这里检查**

**1.[链接](http://forums.asp.net/t/1478549.aspx)**

**2.[链接](http://asp.net.bigresource.com/Forms-Data-Controls-GridView-Bind-Field-Foreign-Key-039-s-Data-Record-HKgFtlZnW.html)**

# html - 在 iPad 1 safari 中离线运行单页 HTML 和 JavaScript 页面

> ID：13983788
> 
> 赞同：2
> 
> 时间：2012-12-21T03:11:56.423
> 
> 标签：html, ios, ipad, safari, offline

今年冬天我正在执教我儿子的国旗橄榄球队，我想用 jquery 制作一个小型寻呼机应用程序，它将在聚会期间为球队显示和动画一些比赛。我已经对此进行了很多研究，似乎 safari 无法加载本地文件。一些人建议使用 goodreader，该应用程序，但根据他们的手册，他们使用简化的浏览器而不是 safari。

不知道还有什么可以尝试的。iPad 是 wifi 只使用 ios5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T04:07:44.260

Safari 无法加载本地文件。

你有几个不同的选择。你可以：

1.  将文件上传到 Dropbox，并使用它的离线模式查看它。
2.  使用本机/混合容器（如 Appcelerator、PhoneGap 等）将您的 HTML/Javascript 捆绑到“本机”应用程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T22:29:33.193

我最终使用了 APPCACHE 中内置的 HTML5：http: [//www.html5rocks.com/en/tutorials/appcache/beginner/](http://www.html5rocks.com/en/tutorials/appcache/beginner/)

顺便说一句，我们不败 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T04:03:20.910

No Safari 无法加载本地文件。您不能从那里运行本地应用程序。您可以做的是使用dreamweaver/jQuery 为您的iphone 开发一个实际的应用程序。您也可以制作预先录制的视频并在 iPad 上播放。据我所知，Goodreader 是用于阅读本地 PDF，与应用程序无关......（但我真的不知道）

该页面应该让您大致了解使用 JQuery（移动）开发和实际应用程序：http: [//jquerymobile.com/](http://jquerymobile.com/)

编辑：我只是想到了一种更简单的方法。在 dropbox.com 上打开一个保管箱帐户，并将网站/Jquery 放在公共文件夹中。获取公用文件夹的 URL 并使用它。在 iPad 上打开网站，然后不要关闭窗口。即使网络连接停止，它仍然可以工作。

# php - 如何启用默认禁用的 PHP 函数（file_put_contents）？

> ID：13983789
> 
> 赞同：0
> 
> 时间：2012-12-21T03:11:59.393
> 
> 标签：php

file_put_contents() 函数由于某种原因在我的服务器上被禁用。如何启用它？我一般如何启用/禁用 PHP 功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T03:13:53.717

如果您在虚拟主机上，则出于某种原因将其禁用；您可以向他们的服务台发送消息以寻求有关此问题的帮助。他们可以进一步帮助您，也许不会启用此选项。但请解释为什么禁用此功能。

如果您有权访问，`php.ini`则可以通过它启用该功能。

否则，您可以（不是说它会 100% 工作）尝试以下操作：http: [//php.net/manual/en/function.ini-set.php](http://php.net/manual/en/function.ini-set.php)

# java - JBoss Standalone.conf VS Standalone.conf.bat

> ID：13983793
> 
> 赞同：13
> 
> 时间：2012-12-21T03:12:30.303
> 
> 标签：java, jboss, jvm

我目前正在检查我们的**JBoss AS7.1**服务器配置，并在我们的`jboss/standalone/bin`目录中发现了这两个先前配置的文件：

*   独立的.conf
*   独立的.conf.bat

现在我有兴趣调整我们`JAVA_OPTS`的配置文件，两个配置文件都有一个设置参数的位置。从快速谷歌搜索我认为`standalone.conf.bat`是设置这些的常用文件。但我不确定standalone.conf 文件在这里做什么。修改这两个文件时我只需要修改`standalone.conf.bat`还是需要注意任何配置顺序？

**更新：**

可以在此处找到回答此问题的相关 JBoss 文档：[https ://docs.jboss.org/author/display/AS71/JVM+settings](https://docs.jboss.org/author/display/AS71/JVM+settings)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-21T03:26:49.350

如果您在 Windows 上运行它，那么您只需要担心修改`standalone.conf.bat`文件。另一个文件 ( `standalone.conf`) 仅由 *Nix 环境使用。

# visual-c++ - 如何以编程方式从 PE 文件中获取 VC 编译器版本？

> ID：13983794
> 
> 赞同：1
> 
> 时间：2012-12-21T03:12:44.613
> 
> 标签：visual-c++, portable-executable

[CFF Explorer](http://www.ntcore.com/exsuite.php)能够从 PE 文件中检测 VC 编译器版本。它为我的 exe 文件显示“Microsoft Visual C++ 8”，该文件静态链接到 libCMT（无 dll 依赖项）。

这是怎么做的？它必须回复我不知道的 PE 文件中的某些结构。

**更新：**

1.  CFF Explorer 可以为静态链接的 PE 文件获取正确的 VC 编译器版本（不依赖于 msvcmXX.dll、msvcpXX.dll 或 msvcrXX.dll）
2.  即使我将PE可选标头中的LinkerVersion / ImageVersion / SubsytstemVersion / OperratingSystemVersion字段清零，CFF资源管理器仍然可以知道正确的VC编译器版本。

似乎 CFF 资源管理器正在使用一种非常可靠的方法来检测 VC 编译器版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T03:45:42.773

PE Header 有一些关于链接器（或编译器）的信息。查看：

[http://wiki.osdev.org/PE](http://wiki.osdev.org/PE)

并且：

[http://mirror.sweon.net/madchat/vxdevl/papers/winsys/pefile/pefile.htm](http://mirror.sweon.net/madchat/vxdevl/papers/winsys/pefile/pefile.htm)

PE 标头中的魔术词可能是您答案的关键。

*编辑*：

似乎 CFF 资源管理器依赖于代码签名。我在这里发现了一些有趣的帖子：

[确定哪个编译器构建了 Win32 PE](https://stackoverflow.com/questions/764329/determining-which-compiler-built-a-win32-pe)

在RBerteig 的回复中，内部符号可以用来确定编译器。

[http://www.codeproject.com/Articles/24417/Portable-Executable-PE-Code-Injection-Injecting-a](http://www.codeproject.com/Articles/24417/Portable-Executable-P-E-Code-Injection-Injecting-a)

从这篇文章中，_main 地址是确定它的签名之一。

和这篇文章： http: [//ntcore.com/files/richsign.htm](http://ntcore.com/files/richsign.htm)

提供有关 Microsoft 编译器签名的更多线索。

# aop - 如何在spring aop中将上下文参数传递给建议

> ID：13983796
> 
> 赞同：3
> 
> 时间：2012-12-21T03:12:51.503
> 
> 标签：aop, spring-aop

我现在正在学习spring aop，我不知道将上下文参数传递给建议。

注意我的意思是`context`论点，而不是`normal`论点。

传递普通参数很简单，例如：

```
a join point:
public void read(String something){

}

@Aspect
public class SessionAspect {
    @Pointcut("execution(* *.*(String)) &&args(something)")
    public void sess() {
    }

    @Before("sess()")
    public void checkSessionExist(String something) {
        //Here
    }
} 
```

然后`something`参数将传递给通知`checkSessionExist`。

但是我想获得像 HttpSession 或其他东西这样的上下文参数怎么样？

```
a join point:

public void listUser(){
    dao.list(User.class,.....);
}

@Aspect
public class SessionAspect {
    @Pointcut("execution(* *.*(String))")
    public void sess() {
    }

    @Before("sess()")
    public void checkSessionExist(String something) {
        //Here
    }
} 
```

在此示例中，`listUser`仅允许登录用户加入连接点。

所以我想检查当前的HttpSession中是否有一个标识，所以我需要在advice中获取一个HttpSession的实例`checkSessionExist`。

但是如何获得呢？

最简单的方法是将参数添加`HttpSession`到所有关节点，如下所示：

```
public void listUser(HttpSession session){
    dao.list(User.class,.....);
} 
```

然而，这已经违背了它自己的 AOP。在我看来，连接点甚至不需要知道Aspect的存在，不是吗？

如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T03:30:48.617

而不是通过`HttpSession`via ，您可以在自身中`@Pointcuts`获取引用`HttpSession``@Aspect`

```
RequestContextHolder.currentRequestAttributes()
.getAttribute("user", RequestAttributes.SCOPE_SESSION)

@Aspect
public class SessionAspect {

    // fetch the current HttpSession attributes and use as required 
    private ServletRequestAttributes attr = (ServletRequestAttributes) RequestContextHolder.currentRequestAttributes();

    @Pointcut("execution(* *.*(String))")
    public void sess() {
    }

    @Before("sess()")
    public void checkSessionExist(String something) {
        //Here
    }
} 
```

# java - 使用 JAVA 加密和乱码音频文件

> ID：13983798
> 
> 赞同：4
> 
> 时间：2012-12-21T03:13:08.483
> 
> 标签：java, audio, encryption, mp3, des

我目前正在开发一个使用 JAVA 加密 MP3 音频并从该加密的 MP3 文件中产生乱码的项目。到目前为止，我可以使用 DES 加密方法加密整个 MP3 文件。但是，此加密文件无法使用 MP3 播放器播放。我知道 MP3 文件有一些结构（标题和数据等），但我不知道在不破坏整个 MP3 结构的情况下对该文件实施加密。

如何使这个加密的 MP3 文件可以播放？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T04:38:02.133

更多关于 java 中解析和 mp3 流的信息：[JavaLayer](http://www.javazoom.net/javalayer/javalayer.html)`javazoom.jl.decoder.Bitstream`是一个 mp3 解码器，它自然地主要通过类实现流处理。它将跳过所有标签数据并为您提供每一帧的原始字节。

另一个做一些 mp3 流解析的库是[jaudiotagger](http://www.jthink.net/jaudiotagger/)，也许你也可以从那里清除一些代码。

这两个库都在 LGPL 下分发，因此请注意许可问题。

# javascript - 检票口使用 JavaScript 更新图像

> ID：13983800
> 
> 赞同：1
> 
> 时间：2012-12-21T03:13:25.823
> 
> 标签：javascript, jquery, wicket, wicket-1.5

当用户关注文本字段时，我正在尝试使用 JavaScript 更新图像。目前有以下 HTML/Wicket 代码：

```
<div class="input-prepend">
    <span class="add-on">
        <wicket:link>
            <img src="img/username-img-1.png" id="username-img"/>
        </wicket:link>
    </span>
    <input type="text" id="username" placeholder="User Name" wicket:id="username" />
</div> 
```

以及以下 JavaScript 代码：

```
$(document).ready(function() {  
    $('#username').focus(function() {
        $('#username-img').attr("src","img/username-img-2.png" );
    });
}); 
```

显然，这是行不通的，因为 Wicket 有自己的资源引用方式。我想知道我的其他选择。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T09:02:38.463

我了解到您的`webapp`文件夹中有图片。所以问题是您需要使用`UrlUtils.rewriteToContextRelative`.

像这样的东西可能会起作用：

```
public void renderHead(IHeaderResponse response) {

    StringBuilder script = new StringBuilder();
    script.append("$('#username').focus(function() {");
    script.append("$('#username-img').attr(\"src\",\"");
    script.append(UrlUtils.rewriteToContextRelative("img/logo.png", RequestCycle.get()));
    script.append("\");");
    script.append("});");

    response.render(OnDomReadyHeaderItem.forScript(script.toString()));
} 
```

# c++ - 有人在汇编语言级别解释左值和右值吗？

> ID：13983804
> 
> 赞同：4
> 
> 时间：2012-12-21T03:13:45.887
> 
> 标签：c++, c, lvalue

我想这里的每个人都知道这`--i`是一个左值表达式，而`i--`一个右值表达式。但是我阅读了这两个表达式的汇编代码，发现它们被编译为相同的汇编代码：

`mov eax,dword ptr [i]
sub eax,1
mov dword ptr [i],eax`

在 C99 语言标准中，左值被定义为具有对象类型或除 void 之外的不完整类型的表达式。

所以我可以确保`--i`返回一个非 void 类型的值，同时`i--`返回一个 void 或临时变量的值。

但是，当我给出诸如`i--=5`之类的赋值时，编译器会给我一个错误，指出`i--`它不是左值，我不知道为什么它不是以及为什么返回值是一个临时变量。编译器如何做出这样的判断？任何人都可以在汇编语言级别给我一些解释吗？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T03:17:03.760

左值？正确的价值？

如果您在谈论*lvalues*和*rvalues*，那么作为 lvalue 或 rvalue 的属性适用于表达式的*结果*，这意味着您必须考虑`--i`and的结果`i--`。在 C 语言*中，* `--i`和`i--`都是右值。因此，您的问题是基于 C 语言领域的不正确前提。`--i`不是C 中的左值。我*不*知道您要通过引用 C99 标准来说明什么，因为它明确指出两者都不是左值。此外，还不清楚`i--`返回 a是什么意思`void`。不，内置的后缀`--`永远不会返回`void`。

`--i`左值与右值的区别`i--`仅存在于 C++ 中。

无论如何，如果您只查看表达式语句`--i;`，`i--;`您就不会使用这些表达式的结果。你正在丢弃它们。使用独立的唯一一点`--i`是`i--`它们的副作用（减量`i`）。但是由于它们的副作用是相同的，因此完全可以预期生成的代码是相同的。

如果您想查看`--i`和`i--`表达式之间的区别，您必须使用它们的结果。例如

```
int a = --i;
int b = i--; 
```

将为每个初始化生成不同的代码。

这个例子与他们结果的左值或右值无关。如果你想从那一侧观察差异（如我上面所说，它只存在于 C++ 中），你可以试试这个

```
int *a = &--i;
int *b = &i--; 
```

第一次初始化将在 C++ 中编译（因为结果是左值），而第二次初始化不会编译（因为结果是右值并且您不能将内置的一元`&`应用于右值）。

该规范背后的基本原理是相当明显的。由于`--i`计算结果为 的*新*值`i`，因此完全有可能使此运算符返回对`i`自身的引用作为其结果（与 C 相比，C++ 语言更喜欢尽可能返回左值）。同时，`i--`需要返回 的*旧*值`i`。因为当我们开始分析结果时哦`i--`，`i`它本身很可能持有*新*值，所以我们不能返回对`i`. 我们必须`i`在一些辅助临时位置保存（或重新创建）旧值并将其作为结果返回`i--`. 该临时值只是一个值，而不是一个对象。它不需要驻留在内存中，这就是它不能是左值的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T03:17:33.673

[注意：我从 C++ 的角度回答这个问题。]

假设`i`是一个内置类型，如果你只写`--i;`or`i--;`而不是，说`j = ++i;`or `j = i++;`，那么编译器将它们编译成汇编代码也就不足为奇了——它们在做同样的事情，即递减`i`。当您对结果执行某些操作时，差异只会在汇编级别变得明显，否则它们实际上具有相同的语义。

（请注意，如果我们考虑重载用户定义类型的前后减量运算符，生成的代码将不一样。）

当你写类似的东西`i-- = 5;`时，编译器会抱怨，因为后减的语义本质上是减量有问题的东西，但返回它的旧值以供进一步使用。返回的东西将是临时的，因此为什么会`i--`产生一个 r 值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T04:39:21.653

术语“左值”和“右值”源自赋值表达式`E1 = E2`，其中左操作数`E1`用于标识要修改的对象，右操作数`E2`标识要使用的值。（见 C 1999 6.3.2.1，注 53。）

因此，仍然有一些与之关联的对象的表达式可用于定位该对象并对其进行写入。这是一个左值。如果表达式不是左值，它可能被称为右值。

例如，如果你有`i`某个对象的名称，它是一个左值，因为我们可以找到它的位置`i`，并且可以分配给它，就像在 中一样`i = 3`。

另一方面，如果我们有表达式`i+1`，那么我们已经取了 i 的值并加了 1，我们现在有了一个值，但它与特定的对象没有关联。这个新值不在`i`. 它只是一个临时值，没有特定的位置。（可以肯定的是，编译器必须把它放在某个地方，除非优化完全删除了表达式。但它可能在寄存器中而不是在内存中。即使由于某种原因它在内存中，C 语言也没有为您提供方法找出在哪里。）所以`i+1`不是左值，因为你不能在赋值的左侧使用它。

`--i`和`i++`都是取值`i`并执行一些算术运算的结果。（这些表达式也会改变，但这是运算符的副作用，而不是它返回的结果的一部分。）左值和右值的“左”和“右”与or运算符是否在左侧`i`无关或名字的右边；它们与作业的左侧或右侧有关。正如其他答案所解释的，在 C++ 中，当它们位于左值的左侧时，它们返回一个左值。然而，这是巧合；C++ 中运算符的这种定义是在“左值”一词创建多年后出现的。`--``++`

# java - 数据库连接spring框架未解决

> ID：13983807
> 
> 赞同：-2
> 
> 时间：2012-12-21T03:14:32.170
> 
> 标签：java, spring

我之前创建了spring框架，然后替换为数据库连接，但是创建bean有问题。

在部署过程中也收到以下错误。

> DEFAULT=C:\Users\gopc\Documents\NetBeansProjects\HelloSpringJDBC\build\web&name=HelloSpringJDBC&contextroot=/HelloSpringJDBC&force=true 在 GlassFish Server 3.1.2 上失败 部署期间发生错误：加载应用程序时出现异常：java.lang.IllegalStateException：ContainerBase .addChild: start: org.apache.catalina.LifecycleException: org.springframework.beans.factory.BeanCreationException: 在 ServletContext 资源 [/WEB-INF/applicationContext.xml] 中创建名称为“productManager”的 bean 时出错：设置属性值时出错; 嵌套异常是 org.springframework.beans.NotWritablePropertyException：bean 类 [SimpleProductManager] 的无效属性“productDao”：Bean 属性“productDao”不可写或具有无效的 setter 方法。setter 的参数类型是否与 getter 的返回类型匹配？有关详细信息，请参阅 server.log。C:\Users\gopc\Documents\NetBeansProjects\HelloSpringJDBC\nbproject\build-impl.xml:1029：模块尚未部署。有关详细信息，请参阅服务器日志。

**资源**

应用程序上下文.xml

```
 <?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd">

    <bean id="externalDataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource" scope="singleton"     destroy-method="close">
        <property name="driverClassName" value="sun.jdbc.odbc.JdbcOdbcDriver"/>
        <property name="url" value="jdbc:odbc:;DRIVER=Microsoft Access Driver (*.mdb, *.accdb);DBQ=C://Users//gopc//Documents//odbc_sql.accdb"/>
        <property name="username" value=""/>
        <property name="password" value=""/>
    </bean>

    <bean id="productManager" class="SimpleProductManager">
        <property name="productDao" ref="productDao"/>
    </bean> 
    <bean id="productDao" class="JdbcProductDao">
        <property name="dataSource" ref="externalDataSource"/>
    </bean> 

</beans> 
```

## **spirngapp-servlet.xml**

```
<?xml version="1.0" encoding="UTF-8"?> 
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd">

    <bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource">
       <property name="basename" value="messages"/>
    </bean> 

    <bean name="/hello.htm" class="HelloController"> 
            <property name="productManager" ref="productManager"/>    
    </bean>       

    <!-- we can prefix="/" 
    http://localhost:8080/HelloSpring/hello.htm
    specify the path in  modelview from the controller 
                        OR
    Decouple the view from the controller                    
    prefix="/WEB-INF/jsp/"
    -->

    <bean id="localeResolver" class="org.springframework.web.servlet.i18n.SessionLocaleResolver">  
            <property name="defaultLocale" value="en_US"/>  
    </bean> 
            <bean id="viewResolver"
              class="org.springframework.web.servlet.view.InternalResourceViewResolver"
              p:viewClass="org.springframework.web.servlet.view.JstlView"
              p:prefix="/WEB-INF/jsp/"
              p:suffix=".jsp" />
</beans> 
```

**JdbcProductDao.java**

```
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

import org.springframework.jdbc.core.namedparam.MapSqlParameterSource;
import org.springframework.jdbc.core.simple.ParameterizedRowMapper;
import org.springframework.jdbc.core.simple.SimpleJdbcDaoSupport;

public class JdbcProductDao extends SimpleJdbcDaoSupport implements ProductDao {

    protected final Log logger = LogFactory.getLog(getClass()); 

     public List<Product> getProductList() {
        logger.info("Getting products!");
        List<Product> products = getSimpleJdbcTemplate().query(
                "select id, description, price from products", 
                new ProductMapper());
        return products;
    } 

      public void saveProduct(Product prod) {
        logger.info("Saving product: " + prod.getDescription());
        int count = getSimpleJdbcTemplate().update(
            "update products set description = :description, price = :price where id = :id",
            new MapSqlParameterSource().addValue("description", prod.getDescription())
                .addValue("price", prod.getPrice())
                .addValue("id", prod.getId()));
        logger.info("Rows affected: " + count);
    }

      private static class ProductMapper implements ParameterizedRowMapper<Product> { 
        public Product mapRow(ResultSet rs, int rowNum) throws SQLException {
            Product prod = new Product();
            prod.setId(rs.getInt("id"));
            prod.setDescription(rs.getString("description"));
            prod.setPrice(new Double(rs.getDouble("price")));
            return prod;
        } 
    } 
} 
```

**SimpleProductManager.java**

```
import java.util.List; 
import java.util.ArrayList;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

public class SimpleProductManager implements ProductManager { 

    protected final Log logger = LogFactory.getLog(getClass()); 

    private ProductDao productDao;

    public List<Product> getProductDao() {
        //throw new UnsupportedOperationException();
        return productDao.getProductList();
    } 
    public void increasePrice(int percentage) {
        //throw new UnsupportedOperationException();        

            List <Product> products = productDao.getProductList();
            for (Product product : products) {
                double newPrice = product.getPrice() * (100 + percentage)/100;
                product.setPrice(newPrice);
                productDao.saveProduct(product);
            }
    } 

    public void setProductDao(ProductDao productDao) {
        //throw new UnsupportedOperationException();     
        logger.info("inside the setProducts in SimpleProductManager");
        this.productDao = productDao;

    } 
} 
```

**HelloController.java**

```
import java.util.Date;
import java.util.Map;
import java.util.HashMap;

import org.springframework.web.servlet.mvc.Controller;

import org.springframework.web.servlet.ModelAndView; 

import javax.servlet.ServletException;

import javax.servlet.http.HttpServletRequest;

import javax.servlet.http.HttpServletResponse; 

import org.apache.commons.logging.Log;

import org.apache.commons.logging.LogFactory; 

import java.io.IOException;

public class HelloController implements Controller { 

    private ProductManager productManager; 
    protected final Log logger = LogFactory.getLog(getClass()); 

    /*
    public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response)

            throws ServletException, IOException { 

        logger.info("Returning hello view"); 
        String now = ( new Date().toString());
        logger.info("time now:"+ now);

        //return new ModelAndView("hello");

        //return new ModelAndView("WEB-INF/jsp/hello","now",now);

        //decouple the view from the controller
        return new ModelAndView("hello","now",now);
    } 
    */

    //Writing some business logic in the controller

    public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException
    {
        String now = (new java.util.Date()).toString();

        logger.info("returning hello view with " + now); 
        Map<String, Object> myModel = new HashMap<String, Object>();

        myModel.put("now", now);
        myModel.put("products", this.productManager.getProductDao()); 
        return new ModelAndView("hello", "model", myModel);
    }

    public void setProductManager(ProductManager productManager) 
    {
        this.productManager = productManager;
    } 

} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-21T08:42:36.507

hey the problem got resovled, after i had modified, the following..

1) applicationContext with mapping for the bean "productManager" with ref productDao.

2) ProductManager interface with new method call getProducts(), then implemenent in the SimpleProductManager and which call the ProductDao.getProducts(), where the sql query is being defined.

# php - 混淆/编码/加密 PHP 系统函数名称

> ID：13983809
> 
> 赞同：0
> 
> 时间：2012-12-21T03:14:46.043
> 
> 标签：php, encryption, base64, eval, obfuscation

> **可能重复：**
> [在不加密的情况下保护 PHP 代码的最佳解决方案](https://stackoverflow.com/questions/336057/best-solution-to-protect-php-code-without-encryption)

谁能告诉我在 PHP 中混淆所有函数名是否可以/可以接受？

例如，这似乎可以使用在线工具：

原来的：

```
if(file_exists($file)){chmod($file,0644);echo"good";} 
```

混淆：

```
$x0c="\143hm\x6f\144"; $x0d="\x66\x69\x6ce\x5f\x65\170\151\x73\164\x73"; 
if($x0d($x0b)){$x0c($x0b,0644);echo"go\x6fd";}?> 
```

我的问题：

1.  请注意，它不再具有 file_exists 或 chmod 功能，但这适用于任何 PHP 安装设置/版本吗？
2.  使用此方法，可以完成任何 PHP 函数，例如：file()、eval()、base64_decode()、file_get_contents()；str_rot13()、strpos()、touch()、filemtime()？
3.  这适用于 Windows、Linux 等服务器吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T05:46:46.370

> 1.  请注意，它不再具有 file_exists 或 chmod 功能，但这适用于任何 PHP 安装设置/版本吗？
> 2.  使用此方法，可以完成任何 php 函数，例如：file()、eval()、base64_decode()、file_get_contents()；str_rot13()、strpos()、touch()、filemtime()？
> 3.  这适用于 Windows、Linux 等服务器吗？

是的，是的，是的。

> 谁能告诉我在 PHP 中混淆所有函数名是否可以/可以接受？

不，不，*地狱*不。

因此，虽然这段代码*有效*，但存在一些大问题：

1.  混淆得越多，代码就越慢。简单的生活事实。
2.  对于高级用户来说，简单地撤消您的所有工作是微不足道的。如果您试图混淆来源作为反盗版措施，您可以直接不打扰。
3.  如果您试图混淆来源以试图做*坏事*，请注意这些东西会像拇指酸痛一样突出，因为看起来“错误”，因此很容易删除。
4.  最后，即使您隐藏了函数的名称，您也无法绕过 PHP 的内置[`disable_functions`](http://php.net/manual/en/ini.core.php#ini.disable-functions)配置设置。

# java - 如何翻转和保存图像

> ID：13983811
> 
> 赞同：-2
> 
> 时间：2012-12-21T03:15:05.507
> 
> 标签：java, image, bufferedimage, flip, imageicon

我的形象声明：

```
ImageIcon imageIcon1 = new ImageIcon(main.class.getResource("image1.png"));
Image image1 = imageIcon1.getImage(); 
```

如何拍摄 image1，沿其垂直轴翻转并将其另存为另一张图像？

我用谷歌搜索过，我发现的每个解决方案都带有某种类型的转换错误。另外，如果有更有效的方式来声明我的图像，请告诉我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T03:21:56.463

你说：

> 我用谷歌搜索过，我发现的每个解决方案都带有某种类型的转换错误。

这只会告诉我们您做错了什么，但不会告诉我们是什么，从而限制了我们如何为您提供帮助。我只能告诉你一些对我有用的步骤：

*   创建另一个与第一个大小相同的 BufferedImage，
*   通过获取其 Graphics2D 上下文`createGraphics()`，
*   通过 an 翻转图形进行`AffineTransform.getScaleInstance(-1, 1)`水平翻转
*   不要忘记然后翻译转换以将翻转的图像带到您想要的位置。
*   将旧图像绘制到新图像中，
*   释放 Graphics2D 对象。

如果您需要更多帮助，请向我们展示您尝试过的内容并包含所有错误消息。

例如，我在玩镜像精灵图像时玩过这个。编译并运行它来看看我的意思：

```
import java.awt.Graphics2D;
import java.awt.GridLayout;
import java.awt.event.*;
import java.awt.geom.AffineTransform;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;

import javax.imageio.ImageIO;
import javax.swing.*;

public class FlipViaTransform {
   private static final String SPRITE_SHEET_SPEC = "http://www.funorb.com/img/images/game/"
         + "central/dev_diary/sprite_sheet_full.gif";
   private static final int TIMER_DELAY = 200;
   private static final int SPRITE_ROWS = 8; // an 8 x 8 sprite sheet

   public static void main(String[] args) {
      try {
         URL spriteSheetUrl = new URL(SPRITE_SHEET_SPEC);
         BufferedImage spriteSheet = ImageIO.read(spriteSheetUrl);
         final ImageIcon[] iconsA = new ImageIcon[64];
         final ImageIcon[] iconsB = new ImageIcon[64];
         double wD = (double) spriteSheet.getWidth() / SPRITE_ROWS;
         double hD = (double) spriteSheet.getHeight() / SPRITE_ROWS;
         int w = (int) wD;
         int h = (int) hD;

         // *** here's what I used to flip
         AffineTransform at = AffineTransform.getScaleInstance(-1, 1); // *** flip
         at.translate(-wD, 0);  // *** translate so that flipped image is visible
         for (int i = 0; i < SPRITE_ROWS; i++) {
            for (int j = 0; j < SPRITE_ROWS; j++) {
               int x = (int) (i * wD);
               int y = (int) (j * hD);
               BufferedImage imgA = spriteSheet.getSubimage(x, y, w, h);
               BufferedImage imgB = new BufferedImage(imgA.getWidth(),
                     imgA.getHeight(), BufferedImage.TYPE_INT_ARGB);
               Graphics2D g2 = imgB.createGraphics();
               g2.setTransform(at);   // *** transform
               g2.drawImage(imgA, 0, 0, null);  // *** draw old image into new
               g2.dispose();  // *** get rid of graphics2d object

               iconsA[j * SPRITE_ROWS + i] = new ImageIcon(imgA);
               iconsB[j * SPRITE_ROWS + i] = new ImageIcon(imgB);
            }
         }

         final JLabel labelA = new JLabel("Image");
         final JLabel labelB = new JLabel("Mirror Image");

         labelA.setVerticalTextPosition(JLabel.BOTTOM);
         labelB.setVerticalTextPosition(JLabel.BOTTOM);
         labelA.setHorizontalTextPosition(JLabel.CENTER);
         labelB.setHorizontalTextPosition(JLabel.CENTER);
         labelA.setIcon(iconsA[0]);
         labelB.setIcon(iconsB[0]);
         final JPanel panel = new JPanel(new GridLayout(1, 0));
         panel.add(labelA);
         panel.add(labelB);
         Timer spriteTimer = new Timer(TIMER_DELAY, new ActionListener() {
            int spriteIndex = 0;

            @Override
            public void actionPerformed(ActionEvent arg0) {
               labelA.setIcon(iconsA[spriteIndex]);
               labelB.setIcon(iconsB[spriteIndex]);
               spriteIndex++;
               spriteIndex %= iconsA.length;
            }
         });
         spriteTimer.start();
         JOptionPane.showMessageDialog(null, panel, "AffineTransform Example", JOptionPane.PLAIN_MESSAGE);
         spriteTimer.stop();
      } catch (MalformedURLException e) {
         e.printStackTrace();
      } catch (IOException e) {
         e.printStackTrace();
      }
   }
} 
```

显示为：
![在此处输入图像描述](../Images/b2547e04d756956bdd7fac8b55553724.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:22:59.850

我从来没有这样做过，但是您可以尝试研究是否可以将 3d 派对库（例如 ImageMagick 或 GraphicsMagic 与 Java 一起使用）。这些库可以读取 PNG 图像并对其执行图形操作。

# ios - 我需要在 iPod touch、iPad 和 iPhone 上单独测试吗？

> ID：13983816
> 
> 赞同：3
> 
> 时间：2012-12-21T03:16:05.617
> 
> 标签：ios, testing, compatibility

我想开始为 iOS 开发。来自 Android 开发背景，我知道您可以使用的设备类型越多，测试效果就越好，因为所有设备的规格都大相径庭，而在您的测试设备中可以完美运行的设备可能甚至无法运行另一个，别说好看了。

我知道在实际设备上进行测试非常重要，因为您可以在模拟器上测试的内容有很多限制，所以我决定购买一个实际设备。

但是，iOS 世界中也有大量可用的设备！有 iPod touch、iPad 和 iPhone，每个都有几个不同的世代和配置（8GB 版本与 16GB 版本、WiFi 版本、3G 版本等）。不仅是屏幕尺寸，而且不同设备的纵横比以及所包含的传感器也有很大不同。

我认为让应用程序在各种设备上*运行*应该不难，但是否有必要在您计划支持的所有设备类型上进行实际测试？苹果并不是以低价出名的，我希望尽可能降低起步成本。

因此，总结一下：是否有必要/建议在 iOS 开发世界中测试尽可能多的设备类型？

一个小的澄清：我特别询问是否可能存在与特定设备/设备系列相关的兼容性问题，我无法通过在模拟器上测试或完全不同的设备来捕获这些问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T04:14:54.423

一般来说，在模拟器上测试和在设备上测试在能力上的主要区别是：

*   模拟器不使用与设备完全相同的沙盒。因此，例如，如果您的配置文件缺少您的 Passbook 凭据，则此问题将出现在物理设备上，但不会出现在模拟器上。
*   该模拟器通常不支持 GPS、多点触控、推送通知、蓝牙和其他一些特定功能。
*   在非视网膜显示器上，iPhone 5+ 或（尤其是！）视网膜 iPad 的模拟器视图在 100% 时几乎无法使用，因为它的尺寸将超过您的屏幕尺寸。
*   有一些非常罕见的崩溃仅在模拟器上发生，少数仅在设备上发生。
*   模拟器并不总是支持您的应用支持的最早的 iOS 版本。例如，当前版本的 Xcode（如果您想为最新的 iOS 版本构建，则必须使用它）只有 5.0+ 的模拟器可用。
*   据我所知，使用 Instruments 进行的某些分析仅在模拟器中可用。

现在，在我的具体情况下，我尝试在我支持的每个屏幕分辨率和我支持的每个*主要*操作系统版本之一上进行测试。

这归结为以下一系列测试设备：

*   (480x320) iPhone 3GS 运行 4.3.3
*   (1136x640) 运行最新 6.x 的 iPod 5gen
*   (960x640) iPhone 4S 运行 6.0
*   (1024x768) iPad 第一代运行 5.0
*   (2048x1536) iPad 第 4 代运行最新的 6.x

请注意，iPad mini 的分辨率与第一代 iPad 相同。

（我的选择偏向于后来的 iOS 版本，因为我喜欢在它们推出时实现与所有 Apple 时髦的可选功能的集成。如果其中一个 6.x 设备运行 5.1，它可能会是一个更平衡的分类。）

如果您*不需要*支持 4.x，我个人建议不要这样做，因为 iTunes Connect 不再为其收集崩溃报告，模拟器也不再提供它。当然，只有你可以决定你是否真的*需要*，如果你这样做，把你的大量测试集中在那里，因为如果你使用的是 5.0 中才引入的 API，Xcode 不会警告你，这会使任何设备崩溃运行 4.x。

请注意，有一些方法可以（经过大量准备）降级设备上的 iOS 版本，因此，如果您真的想测试比您的设备更多的版本，您可以（付出很多努力）。但是，无论如何，您最好为此培养一个强大的 Beta 测试人员库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T03:50:58.717

虽然在所有可能的设备上进行测试显然很棒，但 iOS 生态系统比 Android*更*紧密，因此您可以稍微缩小范围。

您可以从限制目标 iOS 版本开始。无论如何，这将淘汰一些旧设备。iOS6 在所有 iOS 设备中的份额现在可能在发布 4 个月后的 75% 左右；iOS5+iOS6 90% 以上。如果您刚刚开始为 iOS 开发，您可能只针对 iOS6。

这意味着您的最低硬件平台是 iPad2 / iphone3GS / ipodTouch4

设备总列表

```
iPad:   2 3 4 mini
iPhone: 3GS 4 4S 5
iPod:   4 5 
```

十台设备。

但是您不需要全部测试它们。您可以明智地将其缩小到...

```
iPad:   mini + one of the retina models
iPhone: 3GS + 5 
```

用于日常测试。

显然，如果您*确实*想更加向后兼容，只需将低端测试模型替换为低规格设备（iphone 3、iPad 1）。

存储容量的差异（例如 8GB 与 16GB）几乎无关紧要。

根据您的项目，您必须特别注意一些硬件功能。显而易见的一个是视网膜与非视网膜显示器。定位服务的硬件功能在不同型号之间特别细微。

Lowendmac 有一个非常全面的[iphone 比较图表](http://www.lowendmac.com/iphone/iphone-comparison.html)...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T03:58:00.113

> 我认为让应用程序在各种设备上运行应该不难，但是否有必要在您计划支持的所有设备类型上进行实际测试？

这在很大程度上取决于您打算构建什么样的应用程序。例如，通用应用程序可以在小屏幕和大屏幕设备上运行，但在每个设备上的呈现方式可能不同，因此您希望能够同时尝试这两种设备。许多应用程序专门针对 iPad，因此显然没有必要在小型设备上进行测试。iPod Touch 和 iPhone 非常相似，因此在其中一个上进行测试通常就足够了。

简而言之，您不必拥有每台设备的每一个版本，也不必对曾经发布的每一个 iOS 版本进行测试。但是您确实希望在尽可能多的不同设备和操作系统版本上测试您的产品。因此，培养一批 Beta 测试人员，他们将通过在他们的设备上试用您的应用程序来帮助您。iOS 开发者计划允许您精确地向您的帐户添加多达 100 台测试设备，以便您可以在许多不同的环境中测试您的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-21T03:47:04.167

在 iPod touch 上进行测试通常不值得。

在 iOS 世界中，一般有 iPhone/iPod、iPhone 5/iPod 5 代和 iPad。

因此，总共有 3 个屏幕尺寸。

如果您计划针对的不仅仅是最新的操作系统（iOS 6），那就是测试的复杂性所在。只需针对 iOS 5，iOS 6 几乎会使您需要测试的目标数量增加一倍。

我尽量保持简单。我在我的 iPhone 5 和 iPad 上进行测试。两者都运行 iOS 6。对于 iOS 5 和小型 iPhone，我依赖于模拟器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T03:41:48.670

我为 Android 和 iOS 开发，所以我知道这个问题是从哪里来的。我有幸能够在大多数不同的 iOS 设备上进行开发，我想说在大多数情况下，我会在用户将使用的最不先进的设备上进行测试。如果它在 iPOd 3rd gen 上运行流畅，那么它将在 iPhone 4S、5 等上运行非常流畅。对于 iPhone 5 的不同屏幕高度，模拟器在布局时效果非常好。

您需要考虑的事情是，您的应用程序是否可以选择使用只有手机才有的某些功能，例如拨打电话。此外，如果您想制作 iPad 或通用应用程序，拥有一台真正的 iPad 会非常方便，但模拟器确实工作得很好。

# eclipse - 导出eclipse可部署插件和片段时出错

> ID：13983819
> 
> 赞同：2
> 
> 时间：2012-12-21T03:16:32.340
> 
> 标签：eclipse, eclipse-plugin

我有一个 Eclipse 插件在 Eclipse 环境中运行良好。

我想把它导出成一个 jar 文件，所以我选择了 Export > Deployable plugins and Fragments。

![在此处输入图像描述](../Images/7527a2bf968b2a4fd0b64728017d4a01.png)

我可以得到一个jar文件，但是报错了。

![在此处输入图像描述](../Images/bfbed925f8ceb9f0df4627d6e665652c.png)

打开日志文件，它报告我有 1242 个问题（191 个错误，1051 个警告）。这是错误日志的一些副本。

```
2\. ERROR in /Users/LSclipse/src/lsclipse/LSDiffRunner.java (at line 61)
    import edu.washington.cs.induction.OnePipeLineScript;
           ^^^
The import edu cannot be resolved
----------
3\. ERROR in /Users/LSclipse/src/lsclipse/LSDiffRunner.java (at line 261)
    OnePipeLineScript.getMatchingForRefFinder(projName, proj1, proj1Loc
    ^^^^^^^^^^^^^^^^^
OnePipeLineScript cannot be resolved 
```

为什么我有错误？我有 2049 个警告，但在 eclipse IDE 中编译插件时没有错误。

## 添加

主项目引用了另外两个项目，并引用了许多外部库。我附上了包视图和 Java 构建路径。

![在此处输入图像描述](../Images/a0216c4a832ea47f9a28ee14c8e379d1.png) ![在此处输入图像描述](../Images/9fbfa2cc6b50daecb3b1a16b226b67ed.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T04:53:17.403

这个问题涉及多个问题。但是，核心问题是该项目不是 Eclipse 插件，`apimatching`而`originanalysis`只是 Java 项目。结果，这两个项目没有包含在最终的 jar 文件中以破坏构建。

## 将两个项目符号链接到主项目中

我通过将 src 目录符号链接到主 eclipse 插件项目来解决了这个问题。

```
ln -s /workspace/seal/edu.ucsc.originanalysis/src /LSclipse/originanalysis
ln -s /workspace/seal/edu.ucsc.apimatching/src /LSclipse/apimatching 
```

在 Java Build Path/Source 选项卡中，我将这两个包含的项目添加为源。[Eclipse Java 缺少所需的源文件夹：'src'](https://stackoverflow.com/questions/5641072/eclipse-java-missing-required-source-folder-src)

现在我有没有错误的eclipse插件jar文件。

![在此处输入图像描述](../Images/06df1409e44716dcca1552bbc6e28854.png) ![在此处输入图像描述](../Images/66edd8e7a0d56a5db7ce37bc24e61ea9.png)

然后单击 F-5 刷新项目资源管理器并检查它们是 java src 目录。

在 Build 选项卡中选择包含的项目。

![在此处输入图像描述](../Images/c8a382ff31301b10e56fe02ba20f6da9.png)

更新`bin.include`并`source..`在 build.properties 选项卡中很重要。应该明白，在`bin.include`订购中也很关键。lib/cdtparser.jar 和 lib/cdtcore.jar 应该放在它们的用户之前 - `origin analysis/`。

![在此处输入图像描述](../Images/f2d12e6bb56f72b4aef4226705c2bf1e.png)

## 将包含项目的 jar 文件复制到主项目中

我还必须将这些项目文件中的一些 jar 文件复制到主项目中，然后在`Binary Build`选项卡中选择它们。

![在此处输入图像描述](../Images/0a860a30b691e2b9e53693f8fbd2d1ac.png)

并在 Runtime/Classpath 选项卡中添加 tim。

![在此处输入图像描述](../Images/a7834ede248459dfc671346d64d88169.png)

## 在执行环境中选择 JavaSE-1.6。

我有很多“必须覆盖超类方法”错误。有了这篇文章的提示 - ['Must Override a Superclass Method' Errors after importing a project into Eclipse](https://stackoverflow.com/questions/1678122/must-override-a-superclass-method-errors-after-importing-a-project-into-eclips)，我删除了 J2SE-1.5 来解决这个问题。

![在此处输入图像描述](../Images/601d73bece746e46b8cceac9eb3b45d3.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T07:56:55.413

开发插件时，不能将第三方库添加到 Java 的类路径中。它是构建标准 Java 应用程序的方式，但插件是一种 OSGi 包，它有[自己的类加载规则](https://www.google.com/#hl=en&sugexp=les;&gs_rn=1&gs_ri=hp&gs_mss=eclipse%20plug-in%20class%20tutorial&tok=-8UYaVbZJgKc6aZ8hM7OOw&pq=eclipse%20plug-in%20class%20path%20tutorial&cp=11&gs_id=6c&xhr=t&q=osgi+classloader&pf=p&newwindow=1&tbo=d&sclient=psy-ab&oq=osgi+classl&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.1355534169,d.aWc&fp=782f13b38dd4317e&bpcl=40096503&biw=1236&bih=662)。

正确的方法是将第三方库添加到插件的类路径中。

将以下声明添加到插件的**MANIFEST.MF中，**

```
Bundle-ClassPath: lib/log4j-1.2.7.jar,
 xml-apis.jar,
 ... 
```

检查这些链接[[1]](http://wiki.eclipse.org/FAQ_How_do_I_add_a_library_to_the_classpath_of_a_plug-in?)，[[2]](http://eclipse.dzone.com/articles/top-10-mistakes-eclipse-plugin)以了解它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T22:40:47.417

这就是有问题的地方，并将其视为潜在问题的潜在解决方案。

1.  此类是来自引用的 jar 还是在实际插件 edu.washington.cs.induction.OnePipeLineScript 中；

2.  您似乎有很多错误的文件夹，想知道您的 build.properties 文件是否显示任何警告，并且您还为 build.properties 源中的每个源文件夹定义了这个。= src/

3.  您的外部 jar 库似乎位于源类型不正确的文件夹中。它应该是一个非源文件夹（您可以通过包图标装饰器告诉源文件夹），并且您应该确保在清单编辑器中为运行时检查了 lib，以便它在构建中包含 jar。要将其取消标记为源文件夹，请在导航器视图中选择下拉菜单，转到过滤器并取消选中 .resources ，然后将在该文件中显示 .classpath 文件，您将看到该文件夹​​为 kind="src" （我相信）删除它。

4.  不知何故，您似乎也链接了源文件夹，这是我不建议的做法，并且不确定在导出插件时是否会导致问题。如果您可以避免链接源文件夹会更好。

**此外，您似乎将普通 java 应用程序的 java 构建路径配置与在 OSGI 中运行的插件混淆了，这些插件不是通过 java 构建路径配置的，而是您的 manifest.editor 所以作为一个经验法则，如果它的插件甚至不费心去尝试配置 java 构建路径，因为 OSGI 不同，这也可能导致问题**

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-09-12T06:32:35.437

在选项中选择“使用工作区中编译的类文件”对我有用。

![](../Images/6cbd8f2f2da382c0dda5c8b6341a34a8.png)

# css - CSS 流体两列和最小宽度

> ID：13983820
> 
> 赞同：4
> 
> 时间：2012-12-21T03:16:46.967
> 
> 标签：css, fluid-layout

我有一个两列的流体布局，左侧设置为`width: 40%`，右侧隐藏设置为`width: 60%`. 我希望允许用户根据自己的喜好调整浏览器的大小，但我必须让左侧显示的**最小宽度为`300px`**.

以下是我目前用于流体布局的代码，其中包括`min-width`规范。但是，CSS 忽略了它！它允许左侧列缩小到 下方`300px`。

我也尝试过设置`min-width`一个百分比，例如`20%`，但 CSS 也忽略了这个规范。

```
div#left {
background: #ccc;
position: fixed;
top: 0;
bottom: 0; 
left: 0;
width: 40%;
min-width:300px;
height: 100%;
}

div#right {
background: #aaa;
position: fixed;
top: 0; 
width:60%;
right: 0;
bottom: 0;
}
​ 
```

**jsFiddle 全屏示例：http:** [//jsfiddle.net/umgvR/3/embedded/result/](http://jsfiddle.net/umgvR/3/embedded/result/)

**jsFiddle 代码：http:** [//jsfiddle.net/umgvR/3/](http://jsfiddle.net/umgvR/3/)

这是什么原因造成的？如何更正代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T04:10:39.510

这也应该工作......

html

```
<div id="container">
        <div id="left">Left</div>
        <div id="right">Right</div>
</div> 
```

css

```
body, div {width:100%;
                height:100%;
                margin: 0;
            }

            #container {
                display:block;position: fixed;
            }
            #left, #right {
                display: inline-block;
            }
            div#left {
                background: #ccc;
                min-width: 300px;
                max-width: 40%;
            }

            div#right {position:fixed;
                background: #aaa;
                width: 60%;
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T03:37:48.767

如果您不太喜欢固定定位，这应该可以满足您的需求。

[在 JSFiddle 上查看](http://jsfiddle.net/vygfN/)

## HTML

```
<div id="left">Left</div><div id="right">Right</div> 
```

*注意元素之间没有空格*

## CSS

```
html, body {
  height: 100%;
}
body {
  min-width: 800px;
}
div#left {
  background: #ccc;
  display: inline-block;
  width: 40%;
  min-width:300px;
  height: 100%;
}

div#right {
  background: #aaa;
  display: inline-block;
  width:60%;
  height: 100%;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T03:26:48.910

我发现左侧 div 保持最小宽度，但它在右侧 div 下方。如果你把它放在前面，你可以在右 div 的顶部看到它。我不认为这是理想的。

```
 z-index: 1; 
```

我使用 z-index: 1; 左右和z-index：0；在右边的 div 上。

它有效，但我认为那里有更好的解决方案。

# php - 使用 PHP 脚本从 MySQL 数据库创建 XLS 文件

> ID：13983822
> 
> 赞同：2
> 
> 时间：2012-12-21T03:17:02.123
> 
> 标签：php, mysql, phpmyadmin, ms-office, xls

我想用 MySQL 数据库中的 PHP 脚本生成 XLS 文件。这里最大的问题是，当我打开新导出的 .xls 文件时，我看到值正常（即格式正确），但该字段的颜色变为白色。但是，我需要保持颜色不变，就像 Excel 中的默认设置一样。

这是我用来*从数据库*中提取数据的 PHP 脚本。

```
 <?php
            include 'connect.php';
            $result = mysql_query('SELECT * FROM projects2');

            ?>

        <center><h1>Lista valorilor din tabela</h1>
        <h2><a href="lec_datepm.php?exporta_lista_clienti=1" title="Exporta lista clienti in Excell" target="_blank">Exporta lista Clienti</a></h2></center>

        <?php
            include_once 'tabel_clientipm.php';
        ?> 
```

用于生成 XLS 文件的 PHP 文件是：

```
<?php
    include 'connect.php';
    $result = mysql_query('SELECT * FROM projects2');

    if (isset($_GET['exporta_lista_clienti'])) {
    $filename = 'raportnou.xls';

    header("Content-type: application/ms-excel");
    header("Content-Disposition: attachment; filename=$filename");

    include_once 'tabel_clientipm.php';

    exit();
    }
?> 
```

我添加了 tabel_clientipm.php：

```
<center>
<table border="1">
    <tr>
        <th>surname</th>
        <th>name</th>
        <th>age</th>

    </tr>
    <?php
        while ($client = mysql_fetch_assoc($result)) {
    ?>
    <tr>
        <td><?php echo $client['surname'];?></td>
        <td><?php echo $client['name'];?></td>
        <td><?php echo $client['age'];?></td>

    </tr>
    <?php
        }
    ?>
</table>
</center> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:23:25.107

如果您想创建隐藏在扩展中的**真实** `.xls`文件而不是 csv 或 html，请使用[**PHPExcel**](https://github.com/PHPOffice/PHPExcel)或`.xls`[](https://github.com/PHPOffice/PHPExcel)

 **它支持以下格式。

*   BIFF 8 ( `.xls`) Excel 95 及以上
*   Office Open XML ( `.xlsx`) Excel 2007 及更高版本

如果 PHPExcel 对您来说很慢，请检查[这些替代方案](https://stackoverflow.com/questions/3930975/alternative-for-php-excel)（由 PHPExcel 的作者提供。它们都比 PHPExcel 快

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:19:03.693

如果您导出为 csv，您可能可以将数据导入为无色。**

# c++ - BOOST ASIO 加载带有密码的 key.pem

> ID：13983824
> 
> 赞同：4
> 
> 时间：2012-12-21T03:17:09.203
> 
> 标签：c++, ssl, openssl, boost-asio, pem

目前我正在处理这个：

```
...
    ctx.use_certificate_chain_file("./C/cert.pem");
    ctx.use_private_key_file("./C/key.pem", boost::asio::ssl::context::pem);
    ctx.load_verify_file("./C/ca.pem");
... 
```

到目前为止一切正常，但我真正需要做的是加载相同的 key.pem 但带有密码短语，查看 asio 文档发现[ssl::context::set_password_callback](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/reference/ssl__context/set_password_callback.html)根据信息调用[SSL_CTX_set_default_passwd_cb](http://www.openssl.org/docs/ssl/SSL_CTX_set_default_passwd_cb.html)并允许处理加密的 PEM文件，请记住，我更熟悉 python 等高级语言，所以 c++ 不是我的强项

任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T08:53:12.600

您应该熟悉来自 python 的回调。

首先定义回调函数：

```
using namespace boost::asio;

// this function is called to obtain password info about an encrypted key
std::string my_password_callback(
    std::size_t max_length,  // the maximum length for a password
    ssl::context::password_purpose purpose ) // for_reading or for_writing
{
    std::string password; 
    // security warning: !! DO NOT hard-code the password here !!
    // read it from a SECURE location on your system
    return password;
} 
```

然后设置回调`set_password_callback()`：

```
// set the callback before you load the protected key
ctx.set_password_callback(my_password_callback);
// ...
// this will call my_password_callback if a password is required
ctx.use_private_key_file("key.pem",ssl::context::pem); 
```

如果你想使用一个类方法作为回调，

```
class server {
    std::string password_callback(); //NOTE: no parameters
    // ...
}; 
```

您可以使用`boost::bind()`设置回调：

```
#include <boost/bind.hpp>

void server::startup() {
    ctx_.set_password_callback(
        boost::bind(&server::password_callback,this) );
    // ...
} 
```

在任何一种情况下，如果无法解密密钥，将抛出`boost::system::system_error`异常（基于`std::exception`），可能是因为密码错误或找不到文件。

# asp.net-mvc-3 - wmd 编辑器选项卡未显示

> ID：13983828
> 
> 赞同：1
> 
> 时间：2012-12-21T03:17:46.693
> 
> 标签：asp.net-mvc-3, razor, wmd-editor

大家好，我正在尝试在stackoverflow上实现这样的wmd编辑器，但我无法显示编辑器的按钮，只有文本区域出现..这是我的代码..我在这里做错了吗？还是错过了什么？谢谢希望你们能帮助我。

`<!DOCTYPE html>`

```
<head>

<link href="@Url.Content("~/Content/wmd.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/showdown.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/wmd.js")" type="text/javascript"></script> 
```

`<body>`
`<div id="wmd-button-bar" class="wmd-panel"></div>`
`<textarea id="wmd-input" class="wmd-panel"></textarea>`
`<div id="wmd-preview" class="wmd-panel"></div>`
`<div id="wmd-output" class="wmd-panel"></div>`
`</head>`
`</body>`

# php - 试图在我的电脑上运行 Symfony 项目

> ID：13983831
> 
> 赞同：1
> 
> 时间：2012-12-21T03:18:18.263
> 
> 标签：php, apache, webserver, symfony-1.4

我正在尝试运行从 GitHub 克隆的 Symfony 项目。我以前从未使用过 Symfony，但我想运行这个项目。

我读到你需要运行`frontend_dev.php`，所以我将它运行到我的浏览器中：

`C:\Users\Computer\Desktop\Project\WebInterface\web\frontend_dev.php`

但只是得到了一个空白页面，上面有一些 PHP。我相信我可能必须设置一个网络服务器，但我不确定，我想我会先在这里问。

如果我想从我的计算机上运行该项目，我是否只需下载一个 Apache 服务器并将其放在根目录中？我需要更改哪些变量和文件才能使其正常工作？我需要转发任何端口吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:25:22.713

不再支持 Symfony 1.x 分支。使用 Symfony 2。

无论如何，关于您的问题：这里是 1.4 的文档：[第 1 天：启动项目](http://symfony.com/legacy/doc/jobeet/1_4/en/01?orm=Propel)

# python - 在 OSX 中的另一个应用程序上触发 drop 事件

> ID：13983832
> 
> 赞同：9
> 
> 时间：2012-12-21T03:18:39.640
> 
> 标签：python, xcode, macos, drag-and-drop, pyqt

我使用一些专有软件进行 DJ（Native Instruments Traktor）。如果你不熟悉这种东西，可以把它想象成一个美化的 iTunes：它浏览和播放音频文件。

我想为此构建一个自定义文件浏览器应用程序，但没有任何类型的 API。但是，它*确实*允许从文件系统中拖放音频文件，这是一个很好的开始。

我正在设计的文件浏览器的性质意味着我实际上不想拖放东西——我只想在我的应用程序中单击一个组件，并获得相同的效果。所以我正在寻找从我的文件浏览器应用程序以*编程方式触发*另一个应用程序上的放置事件的方法。

我选择的平台是 Python 和 PyQt，但我开始觉得我可能不得不降低一点。虽然还没有完成大量的 C#/Java，所以这可能是一个学习曲线（我已经完成了很多 ANSI C，但这可能*太低了*......）

这是我已经走了多远：

*   我制作了一个非常简单的 PyQt 应用程序
*   当我的应用程序中的 QLabel 被拖动时，我可以创建 QDrag 对象
*   我可以附加所有正确的 MIME 数据来代表音频文件
*   因此，如果我将 QLabel 从我的应用程序拖放到 Traktor 中，它会识别音频文件并播放它 - 好时光

所以现在我需要去掉中间人，点击时打包我的 MIME 数据，让 Traktor 认为我已经将它拖放到它上面。

我还对 OSX 开发人员的文档进行了一些研究，特别是[这些东西](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DragandDrop/Concepts/dragdestination.html)，它描述了传递给目标应用程序（放置目标）的消息序列。

这一切都是有道理的，但我正处于下降到 C#/Java 来尝试模仿这些消息的边缘，这听起来像兔子洞，如果我可以避免的话，我宁愿不冒险。

所以，在我做之前...

1.  这甚至可能吗？还是我会遇到某种跨应用程序安全障碍等？（删除目的地只接受直接来自操作系统或其他东西的消息）
2.  如果是，有没有更简单的方法来做到这一点？理想情况下使用 PyQt/Tkinter/wxPython ...？

我知道我可以通过点击自动化来做到这一点，但我可以想象它真的不可靠，将很大程度上依赖于窗口的位置等。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T07:23:44.000

没有尝试过，但是类似`CGEventCreateMouseEvent`并且`CGEventPostToPSN`可能会有所帮助。CGEvent.h 和 CGRemoteOperation.h

我还想知道目标应用程序是否会响应苹果事件 - 如果可以，您可以创建苹果事件并将其发送给它，这样会更干净。我会尝试运行 AppleScript Editor 或 Automator 并在有问题的应用程序上打开字典，看看它是否有一个事件字典，可能会做你想做的事。

运气。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T05:02:21.017

进步！虽然我仍然不知道将什么事件传递给应用程序，但我确实知道文件数据存储在哪里：它在拖动粘贴板上！尝试将文件拖到某处，然后运行：

```
#include <stdlib.h>
#import <Foundation/Foundation.h>
#import <AppKit/NSPasteboard.h>

int main(int argc, char **argv) {
    (void)argc, (void)argv;
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    NSPasteboard *dragPasteboard = [NSPasteboard pasteboardWithName:NSDragPboard];
    NSLog(@"%@", [dragPasteboard stringForType:(NSString *)kUTTypeFileURL]);
    [pool drain];
    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-24T12:14:01.250

我知道这是一篇旧帖子，但我正在开发我的 Traktor Suggestions 程序。我已经完成了 95%，现在我只需要一种方法来允许用户选择一个文件，然后单击“加载到甲板 A”或“加载到甲板 B”。如您所知，Traktor 将接受拖动的文件。但我想将其自动化，因为当您进行 DJ 时，您触摸鼠标的次数越少越好。

我也对你一直在做的事情非常感兴趣。

我花了一点时间才弄清楚，但我意识到我需要创建一个粘贴板。因为我没有处理图像，只需要提供文件路径（作为 NSString ......我也可以使用 NSURL，但直接路径似乎最简单）。它们是用于创建粘贴板和拖动会话以及设置“拖动图像”等的多种方法。然后我遇到了最简单的形式，即使用简单的 NSView 函数（需要放置在 Mouse Down 函数中）。并且已经设置了 dragFilePath 变量。所以在我的自定义 NSView 中我有这个代码。您还需要有一个 NSImageView 作为自定义 NSView 的子视图。为了让这个“快速”功能发挥作用。

self dragFile.... 创建一个即时粘贴板项目，并且拖动会话都将输出多行代码。

```
- (void)mouseDown:(NSEvent*)theEvent {
 NSLog(@"DRAGnDROP VIEW mouseDown happened");
NSLog(@"DRAGnDROP VIEW mouseDown dragFilePath is: %@", dragFilePath);
[self dragFile:dragFilePath fromRect:(self.bounds) slideBack:YES event:theEvent];
} 
```

我有两个按钮可以触发 CGEvents。我在 Applescript 中有按钮运行功能。Applescript 函数触发鼠标向下，启动 drake，切换到 Traktor，然后将鼠标移动到甲板 A 或甲板 B，然后释放。

AppleScript 功能：

```
on loadTraktorDeckA:sender
    deckDetailControllerDelegate's loadForDrag:me
    delay 0.5
    tell application "Traktor"
        activate
    end tell
    deckDetailControllerDelegate's loadForReleaseA:me
end loadTraktorDeckA:

on loadTraktorDeckB:sender
    deckDetailControllerDelegate's loadForDrag:me
    delay 0.5
    tell application "Traktor"
        activate
    end tell
    deckDetailControllerDelegate's loadForReleaseB:me
end loadTraktorDeckB: 
```

在自定义 NSView 中，这些是被调用的 CG 鼠标事件：

```
-(void)loadForDrag:(id)sender {
NSLog(@"mouse left drag called");
/* create a new Quartz mouse event.
 * @source : CGEventSourceRef
 * @mouseType : CGEventType
 * @mouseCursorPosition : CGPoint
 * @mouseButton : CGMouseButton
 */
CGEventSourceStateID kCGEventSourceStatePrivate = -1;
CGEventSourceRef loadDragEventRef = CGEventSourceCreate(kCGEventSourceStatePrivate);

CGPoint startPoint = CGPointMake(880.0, 770.0);
CGPoint movePoint1 = CGPointMake(610.0, 320.0);
CGEventRef leftDownEvent = CGEventCreateMouseEvent(loadDragEventRef, kCGEventLeftMouseDown, startPoint, 1);
CGEventRef leftDragEvent1 = CGEventCreateMouseEvent(loadDragEventRef, kCGEventLeftMouseDragged, startPoint, 0);
CGEventRef leftDragEvent2 = CGEventCreateMouseEvent(loadDragEventRef, kCGEventLeftMouseDragged, movePoint1, 0);
/* post a Quartz event into the event stream at a specified location.
 * @tap : CGEventTapLocation
 * @event : CGEventRef
 */
CGEventPost(kCGHIDEventTap, leftDragEvent2);

CGEventSourceSetLocalEventsSuppressionInterval(loadDragEventRef, 2);
CGEventPost(kCGHIDEventTap, leftDownEvent);
CGEventPost(kCGHIDEventTap, leftDragEvent1);
CGEventPost(kCGHIDEventTap, leftDragEvent2);

/**
 * release a Quartz event
 */
    // CFRelease(leftDragEvent);}

-(void)loadForReleaseA:(id)sender {
NSLog(@"mouse left Up called DECK A");
 CGPoint movePoint1 = CGPointMake(610.0, 320.0);
CGPoint movePointRelease = CGPointMake(220.0, 320.0);

CGEventRef leftDragEvent2 = CGEventCreateMouseEvent(NULL, kCGEventLeftMouseDragged, movePoint1, 0);
CGEventPost(kCGHIDEventTap, leftDragEvent2);

CGEventRef leftClickUpEvent = CGEventCreateMouseEvent(NULL, kCGEventLeftMouseUp,movePointRelease, 0);
CGEventPost(kCGHIDEventTap, leftClickUpEvent);

/** release a Quartz event
 */
CFRelease(leftClickUpEvent);}

-(void)loadForReleaseB:(id)sender {
NSLog(@"mouse left Up called DECK B");
CGPoint movePoint1 = CGPointMake(610.0, 320.0);
CGPoint movePointRelease = CGPointMake(1000.0, 320.0);

CGEventRef leftDragEvent2 = CGEventCreateMouseEvent(NULL, kCGEventLeftMouseDragged, movePoint1, 0);
CGEventPost(kCGHIDEventTap, leftDragEvent2);

CGEventRef leftClickUpEvent = CGEventCreateMouseEvent(NULL, kCGEventLeftMouseUp,movePointRelease, 0);
CGEventPost(kCGHIDEventTap, leftClickUpEvent);

CFRelease(leftClickUpEvent);} 
```

这是完整的自定义 DragNDropView 类

拖放视图.h

```
 //
//  DragNDropView.h
//  DJK-Tel Traktor Suggestions
//
//
//

#import <Cocoa/Cocoa.h>
#import <Foundation/Foundation.h>
#import <AppKit/AppKit.h>

@interface DragNDropView : NSView <NSDraggingSource, NSDraggingDestination, NSImageDelegate, NSApplicationDelegate>

    //NSPasteboardItemDataProvider

@property (nonatomic, strong) NSString* dragFilePath;
@property (nonatomic, strong) NSURL* dragFilePathURL;

- (id)initWithCoder:(NSCoder *)coder;
- (id)initWithFrame:(NSRect)frameRect;
- (void)mouseDown:(NSEvent*)theEvent;
-(IBAction)loadForDrag:(id)sender;
-(IBAction)loadForReleaseA:(id)sender;
-(IBAction)loadForReleaseB:(id)sender;
- (BOOL)shouldDelayWindowOrderingForEvent:(NSEvent *)event;

@end 
```

拖放视图.m

```
 //  DragNDropView.m
    //  DJK-Tel Traktor Suggestions
    //
    //
    //

#import "DragNDropView.h"

@implementation DragNDropView

@synthesize dragFilePath;
@synthesize dragFilePathURL;

- (id)initWithCoder:(NSCoder *)coder
{
    /*------------------------------------------------------
     Init method called for Interface Builder objects
     --------------------------------------------------------*/
    self=[super initWithCoder:coder];
    if ( self ) {

        NSLog(@"DRAGnDROP VIEW INIT WITH CODER happened");
            //[self registerForDraggedTypes:[NSArray arrayWithObjects:@"NSFilenamesPboardType",@"NSURLPboardType",nil]];
        [self initView];
    }
    return self;
}
- (id)initWithFrame:(NSRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        NSLog(@"DRAGnDROP VIEW INIT WITH FRAME happened");
        [self initView];
    }
    return self;
}

- (void)setFrame:(NSRect)frameRect
{
    [super setFrame:frameRect];
}

- (void) initView
{
    NSLog(@"DRAGnDROP VIEW Init View");

    dragFilePath = @"";
    dragFilePathURL = nil;
}

- (void)drawRect:(NSRect)dirtyRect {
    [super drawRect:dirtyRect];
        // Drawing code here.
}

#pragma mark - Destination Operations

- (void)mouseDown:(NSEvent*)theEvent {
    NSLog(@"DRAGnDROP VIEW mouseDown happened");
    NSLog(@"DRAGnDROP VIEW mouseDown dragFilePath is: %@", dragFilePath);
    [self dragFile:dragFilePath fromRect:(self.bounds) slideBack:YES event:theEvent];
}

- (BOOL)shouldDelayWindowOrderingForEvent:(NSEvent *)event {
    return YES;
}

- (void)mouseDragged:(NSEvent *)event {
}

- (BOOL)performDragOperation:(id <NSDraggingInfo>)sender {
    NSPasteboard *pboard = [sender draggingPasteboard];
        //NSLog(@"DRAGnDROP VIEW performDragOperation pboard is: %@", pboard);

    if ( [[pboard types] containsObject:NSFilenamesPboardType] ) {
        NSArray *files = [pboard propertyListForType:NSFilenamesPboardType];

        if ([files count] == 1) {
            dragFilePath = files[1];
            return YES;
        }
    }
    else if ( [[pboard types] containsObject:NSURLPboardType] ) {
        dragFilePathURL = [NSURL URLFromPasteboard:pboard];
        NSLog(@"DRAGnDROP VIEW performDragOperation dragFilePathURL is: %@", dragFilePathURL);
        return YES;
    }
    return NO;
}

-(void)loadForDrag:(id)sender {
    NSLog(@"mouse left drag called");
    /* create a new Quartz mouse event.
     * @source : CGEventSourceRef
     * @mouseType : CGEventType
     * @mouseCursorPosition : CGPoint
     * @mouseButton : CGMouseButton
     */
    CGEventSourceStateID kCGEventSourceStatePrivate = -1;
    CGEventSourceRef loadDragEventRef = CGEventSourceCreate(kCGEventSourceStatePrivate);

    CGPoint startPoint = CGPointMake(880.0, 770.0);
    CGPoint movePoint1 = CGPointMake(610.0, 320.0);
    CGEventRef leftDownEvent = CGEventCreateMouseEvent(loadDragEventRef, kCGEventLeftMouseDown, startPoint, 1);
    CGEventRef leftDragEvent1 = CGEventCreateMouseEvent(loadDragEventRef, kCGEventLeftMouseDragged, startPoint, 0);
    CGEventRef leftDragEvent2 = CGEventCreateMouseEvent(loadDragEventRef, kCGEventLeftMouseDragged, movePoint1, 0);
    /* post a Quartz event into the event stream at a specified location.
     * @tap : CGEventTapLocation
     * @event : CGEventRef
     */
    CGEventPost(kCGHIDEventTap, leftDragEvent2);

    CGEventSourceSetLocalEventsSuppressionInterval(loadDragEventRef, 2);
    CGEventPost(kCGHIDEventTap, leftDownEvent);
    CGEventPost(kCGHIDEventTap, leftDragEvent1);
    CGEventPost(kCGHIDEventTap, leftDragEvent2);

    /**
     * release a Quartz event
     */
        // CFRelease(leftDragEvent);
}

-(void)loadForReleaseA:(id)sender {
    NSLog(@"mouse left Up called DECK A");
    CGPoint movePoint1 = CGPointMake(610.0, 320.0);
    CGPoint movePointRelease = CGPointMake(220.0, 320.0);

    CGEventRef leftDragEvent2 = CGEventCreateMouseEvent(NULL, kCGEventLeftMouseDragged, movePoint1, 0);
    CGEventPost(kCGHIDEventTap, leftDragEvent2);

    CGEventRef leftClickUpEvent = CGEventCreateMouseEvent(NULL, kCGEventLeftMouseUp,movePointRelease, 0);
    CGEventPost(kCGHIDEventTap, leftClickUpEvent);

    CFRelease(leftClickUpEvent);
}

-(void)loadForReleaseB:(id)sender {
    NSLog(@"mouse left Up called DECK B");
    CGPoint movePoint1 = CGPointMake(610.0, 320.0);
    CGPoint movePointRelease = CGPointMake(1000.0, 320.0);

    CGEventRef leftDragEvent2 = CGEventCreateMouseEvent(NULL, kCGEventLeftMouseDragged, movePoint1, 0);
    CGEventPost(kCGHIDEventTap, leftDragEvent2);

    CGEventRef leftClickUpEvent = CGEventCreateMouseEvent(NULL, kCGEventLeftMouseUp,movePointRelease, 0);
    CGEventPost(kCGHIDEventTap, leftClickUpEvent);

    CFRelease(leftClickUpEvent);
}

#pragma mark - Source Operations

- (NSDragOperation)draggingSession:(NSDraggingSession *)session sourceOperationMaskForDraggingContext:(NSDraggingContext)context
{
    /*------------------------------------------------------
     NSDraggingSource protocol method.  Returns the types of operations allowed in a certain context.
     --------------------------------------------------------*/
    switch (context) {
        case NSDraggingContextOutsideApplication:
            return NSDragOperationCopy;

                //by using this fall through pattern, we will remain compatible if the contexts get more precise in the future.
        case NSDraggingContextWithinApplication:
        default:
            return NSDragOperationCopy;
                //return NSDragOperationNone;
            break;
    }
}

- (BOOL)acceptsFirstMouse:(NSEvent *)event
{
    /*------------------------------------------------------
     accept activation click as click in window
     --------------------------------------------------------*/
        //so source doesn't have to be the active window
    return NO;
}

@end 
```

# xml - 使用 xslt 解析然后格式化名称

> ID：13983833
> 
> 赞同：4
> 
> 时间：2012-12-21T03:18:43.663
> 
> 标签：xml, substring, xslt-1.0

我正在尝试编写一个 XSLT 样式表来处理作者的姓名并创建引用的 APA 版本。关于作者姓名的 APA 引文格式：如果姓名是引文的第一个元素，则列出姓氏，然后是首字母。在最后一位作者之前用逗号和与号 (&) 分隔姓名。我在这篇文章中遵循了 Dimitre Novatchev 的解决方案：[Using XSLT to select after EACH instance in a string/substring](https://stackoverflow.com/questions/13665638/using-xslt-to-select-after-each-instance-in-a-string-substring)但我没有得到我想要的结果。

**输入：**

```
<names>
    <author>Lio-Po, Gilda D.</author>
    <author>Primavera, Jurgenne H.</author>
    <author>Cuvin-Aralar, Ma. Lourdes A.</author>
    <author>Cruz, E.R.</author>
    <author>Catacutan, M.R.</author>
    <author>Agbayani, R.F.</author>
</names> 
```

期望的输出是：**Lio-Po, GD, Primavera, JH, Cuvin-Aralar, MLA, Cruz, ER, Catacutan, MR, & Agbayani, RF**

**对于只有 2 个作者的记录：**

```
<names>
 <author>Lio-Po, Gilda D.</author>
 <author>Primavera, Jurgenne H.</author>
</names> 
```

期望的输出是：**Lio-Po, GD, & Primavera, JH**

提前致谢。下面是我的代码，其中一些代码取自 Dimitre's。

```
<xsl:strip-space elements="*"/>

<xsl:template match="/">
    <xsl:for-each select="/names/author">
        <xsl:choose>
            <xsl:when test="count(following-sibling::text()) = 1">
                <xsl:text>&amp; </xsl:text>
                <xsl:apply-templates/>
            </xsl:when>
            <xsl:when test="count(following-sibling::text()) != 0">
                <xsl:apply-templates/>
                <xsl:text>, </xsl:text>
            </xsl:when>
        </xsl:choose>
    </xsl:for-each>
</xsl:template>

<xsl:template match="text()">
    <xsl:value-of select="substring-before(., ',')"/>

    <xsl:call-template name="replaceTokenDelims">
        <xsl:with-param name="pStr" select="concat(normalize-space(substring-after(., ',')), ' ')"/>
        <xsl:with-param name="pToken" select="' '"/>
        <xsl:with-param name="pReplacement" select="', '"/>
    </xsl:call-template>
</xsl:template>

<xsl:template name="replaceTokenDelims">
    <xsl:param name="pStr"/>
    <xsl:param name="pToken"/>
    <xsl:param name="pReplacement"/>

    <xsl:if test="$pStr">
        <xsl:value-of select="$pReplacement"/>
        <xsl:value-of select="substring(substring-before($pStr, $pToken),1,1)"/>

        <xsl:call-template name="replaceTokenDelims">
            <xsl:with-param name="pStr" select="substring-after($pStr, $pToken)"/>
            <xsl:with-param name="pToken" select="$pToken"/>
            <xsl:with-param name="pReplacement" select="$pReplacement"/>
        </xsl:call-template>
    </xsl:if>
</xsl:template> 
```

运行上面的代码给我输出：**Lio-Po, G, D, Primavera, J, H, Cuvin-Aralar, M, L, A, Cruz, E, Catacutan, M, & Agbayani, R**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T06:20:43.097

**更新**

这个有效，我什至自己测试过：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:str="http://exslt.org/strings">
<xsl:output  method="text" />
<xsl:template match="/">
    <xsl:for-each select="/names/author">
    <xsl:if test="position() = last()">
        <xsl:text>&amp; </xsl:text>
    </xsl:if>
    <xsl:for-each select="str:tokenize(.,' ')">
        <xsl:choose>
          <xsl:when test="position() = 1">
            <xsl:value-of select="."></xsl:value-of>
          </xsl:when>
          <xsl:when test="substring(.,2,1) = '.'">
            <xsl:for-each select="str:tokenize(.,'.')">           
                <xsl:value-of select="concat(.,'.')"></xsl:value-of>
                <xsl:if test="position() != last()">
                    <xsl:text> </xsl:text>
                </xsl:if>
            </xsl:for-each>
          </xsl:when>
          <xsl:otherwise>
            <xsl:value-of select="concat(substring(.,1,1),'.')"></xsl:value-of>
          </xsl:otherwise>
        </xsl:choose>       
        <xsl:choose>
          <xsl:when test="position() = last()">
            <xsl:text>, </xsl:text>
          </xsl:when>
          <xsl:otherwise>
            <xsl:text> </xsl:text>
          </xsl:otherwise>
        </xsl:choose>       

    </xsl:for-each>

    </xsl:for-each>
</xsl:template> 
```

给定 XML 的输出将是：

```
Lio-Po, G. D., Primavera, J. H., Cuvin-Aralar, M. L. A., Cruz, E. R., Catacutan, M. R., & Agbayani, R. F., 
```

如果你能忍受最后一个额外的逗号；）

**附录：** 这是我测试过的完整的 java 代码，看起来不错。

```
import java.io.File;
import java.io.IOException;
import java.io.StringWriter;

import javax.xml.transform.TransformerException;

public class XLSTTester {

    public static void main(String[] params){
        try {
            transform("d:\\workspace1\\test.xml","d:\\workspace1\\test.xsl");
        } catch (TransformerException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    private static void transform(String xmlFileFullPath, String xsltFileFullPath) throws TransformerException, IOException{
        File xmlFile = new File(xmlFileFullPath);
        File xsltFile = new File(xsltFileFullPath);
        StringWriter sw = new StringWriter();
        javax.xml.transform.Source xmlSource = new javax.xml.transform.stream.StreamSource(xmlFile);
        javax.xml.transform.Source xsltSource = new javax.xml.transform.stream.StreamSource(xsltFile); 
        javax.xml.transform.Result transResult = new javax.xml.transform.stream.StreamResult(sw);  

//          create an instance of TransformerFactory
        javax.xml.transform.TransformerFactory transFact = javax.xml.transform.TransformerFactory.newInstance(  );

        javax.xml.transform.Transformer trans = transFact.newTransformer(xsltSource);
        trans.transform(xmlSource, transResult);
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T08:22:18.757

**我想我明白了！**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:str="http://exslt.org/strings">
<xsl:output method="text"/>
<xsl:template match="/">
    <xsl:for-each select="/names/author">
        <xsl:variable name="firstname">
            <xsl:value-of select="substring-after(., ', ')"/>
        </xsl:variable>
        <xsl:if test="position() = last() and position() != 1">
            <xsl:text>&amp; </xsl:text>
        </xsl:if>
        <xsl:choose>
            <xsl:when test="substring($firstname,2,1) = '.'">
                <xsl:value-of select="concat(str:tokenize(.,','), ', ')"/>
                <xsl:for-each select="str:tokenize($firstname,'.')">
                    <xsl:value-of select="concat(.,'.')"/>
                    <xsl:if test="position() != last()">
                        <xsl:text> </xsl:text>
                    </xsl:if>
                </xsl:for-each>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="concat(str:tokenize(.,','), ', ')"/>
                <xsl:for-each select="str:tokenize($firstname,' ')">
                    <xsl:value-of select="concat(substring(.,1,1),'.')"/>
                    <xsl:if test="position() != last()">
                        <xsl:text> </xsl:text>
                    </xsl:if>
                </xsl:for-each>
            </xsl:otherwise>
        </xsl:choose>
        <xsl:if test="position() != last()">
            <xsl:text>, </xsl:text>
        </xsl:if>
    </xsl:for-each>
</xsl:template> 
```

**如果使用以下输入进行测试：**

```
<names>
    <author>Lio-Po, Gilda D.</author>
    <author>Cuvin-Aralar, Ma. Lourdes A.</author>
    <author>De la Cruz, Juan C.</author>
    <author>Cruz, E.R.</author>
    <author>Catacutan, M.R.</author>
    <author>De los Santos, M.A.</author>
    <author>Primavera, Jurgenne H.</author>
</names> 
```

**产生了期望的结果：**

```
Lio-Po, G. D., Cuvin-Aralar, M. L. A., De la Cruz, J. C., Cruz, E. R., Catacutan, M. R., De los Santos, M. A., & Primavera, J. H. 
```

# jquery - 检测变量的属性 - jquery

> ID：13983836
> 
> 赞同：2
> 
> 时间：2012-12-21T03:19:10.170
> 
> 标签：jquery

我正在编写一个脚本，但不确定为什么这不起作用

```
function moveIn($selector) {
if( $( $selector[left] ) != null ){
    $direction = 'left';
}else{
    $direction = 'right';
} 
```

这确实有效：

```
if( $( '#hello[left]' ) != null ){ 
```

这基本上就是我想要吐出的东西。似乎括号导致了问题。这还要怎么写？未来编码的提示？谢谢

整体功能：

```
function moveIn($selector) {
if( $( $selector + '[left]' ) != null ){
    $direction = 'left';
}else{
    $direction = 'right';
}
var animation = {};
    animation[$direction] = 0;
$($selector).animate(animation, 1500);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:21:45.950

假设您`"#hello"`作为选择器传递，那么您将尝试获取`left`不存在的字符串的属性。

`"#hello[left]"`另一方面，搜索具有 ID`hello`和`left` *属性*的元素。

他们不一样。尝试`$selector+"[left]"`

# asp.net - FormsAuthentication.SetAuthCookie 在 IE10 和 IIS 6.0 中不起作用

> ID：13983838
> 
> 赞同：5
> 
> 时间：2012-12-21T03:19:22.607
> 
> 标签：asp.net, cookies, webforms, internet-explorer-10

当我在 Windows 7 中使用 IE10 时，FormsAuthentication.SetAuthCookie 在 IIS 6.0 中不起作用。我使用 Fiddler 监视 cookie，我发现在 IIS 6.0 和 IE10 中，它没有设置 cookie。

测试用例结果：

1.  当我使用 FireFox 和 IIS 6.0 时，它可以工作。
2.  当我使用 IE9 和 IIS 6.0 时，它可以工作。
3.  当我使用 IE10 兼容模式和 IIS 6.0 时，它可以工作。
4.  当我使用 IE10 和 IIS 7.0 时，它可以工作。
5.  当我使用 IE10 和 IIS 6.0 时，它不起作用。

页面代码很简单：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        System.Web.Security.FormsAuthentication.SetAuthCookie("Demo", false); 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T07:26:03.733

当您的请求到达客户端时，您的身份验证 cookie 被设置。确保您没有任何可能迫使 asp.net 运行时重定向到错误页面的错误。

此外， response.Redirect 可能会导致问题。

# objective-c - NSMutableArray 不能添加对象？

> ID：13983839
> 
> 赞同：0
> 
> 时间：2012-12-21T03:19:35.147
> 
> 标签：objective-c, ios6

我有2个模型：

```
@interface Program : NSObject

@property (nonatomic, retain) NSString * name;

@property (nonatomic, strong) NSMutableArray *guides;
@end

@interface Guide : NSObject
@property (nonatomic, retain) NSString *name;
@end 
```

我从一个 xml 中添加了一些编程指南：

```
 Program *program = [Program new];
    program.name = @"My list"
    for(DDXMLElement *guideElement in [programElement nodesForXPath:@"guide" error:&error])
    {
        Guide *guide = [Guide new];
        guide.name = [guideElement stringValue];// [p attribute:@"name"];
        [program.guides addObject:guide];
        NSLog(@"load guide number: %d", [program.guides count]);
    } 
```

输出始终是“加载指南编号：0”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T03:24:58.250

program.guides 为 nil，因为您从未创建过它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T03:29:40.290

在您`Program`的`init`方法中，添加：

`self.guides = [[NSMutableArray alloc] init];`

或者，更草率地，在您的`for`循环添加之前：

`program.guides = [[NSMutableArray alloc] init];`

# google-apps-script - 如何使用 Drive API 在本地 Google Doc 中查找和替换？

> ID：13983842
> 
> 赞同：1
> 
> 时间：2012-12-21T03:19:50.577
> 
> 标签：google-apps-script, google-drive-api

我需要在 Google 文档中查找和替换。本质上，我有一个模板 Google Doc，我想以编程方式复制和自定义它。

原件和副本都应该是原生 Gdoc 格式，并且在视觉布局和格式方面前后看起来应该相同。

尝试通过 exportLink 下载 HTML（和其他格式），对输出进行查找和替换，然后将内容更新为查找和替换的输出。但这搞砸了格式，看起来很……迂回。

我正在使用 Ruby 客户端，这是值得的，但主要问题是，在本机 Doc 中进行查找和替换的最佳实践是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T17:42:56.753

我认为最简单的解决方案是`replaceText`在 Apps Script 中使用 Document 服务的方法：

[https://developers.google.com/apps-script/class_document#replaceText](https://developers.google.com/apps-script/class_document#replaceText)

# ios - 这个案子怎么分类？

> ID：13983843
> 
> 赞同：1
> 
> 时间：2012-12-21T03:20:02.103
> 
> 标签：ios, sorting, nsmutablearray, nsmutabledictionary

这种情况如何分类？

1.  我有一个`NSMutableArray`.
2.  我`NSMutableArray`可以有一个对象或`NSMutableDictionary`.
3.  我`NSMutableDictionary`只有 1 个对象（一个对象作为它的对象，一个字符串作为它的键）
4.  两个对象相同且具有属性`name`

现在，我正在努力解决的是我想`NSMutableArray`根据字典键和对象的`name`？（让我们忽略添加到的对象`NSMutableArray`）

一堆感谢人可以让我知道如何解决这个案子！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T04:48:35.457

将您添加`NSMutableArray`到 NSObject 的自定义子类并使用自定义 NSComparator 进行排序，如下所示：

```
(NSComparator)^(id obj1, id obj2){ /* obj1 and obj2 are NSMutableArrays */
      if ([obj1 objectAtIndex:1] isKindOfClass:[NSMutableDictionary class]) {
           // sort according to the dictionary case
      } else { // [obj1 objectAtIndex:1] isKindOfClass:[NSObject class]
           // sort according to the your other, default case
      }
} 
```

请注意，这是未经测试的，您需要填写 if 和 else 语句的主体。else 子句的注释就是我的编码方式，如果它不符合您的口味，您可以将其删除。

# xml - 使用 xsd 验证 xml 中的元素基数

> ID：13983848
> 
> 赞同：2
> 
> 时间：2012-12-21T03:21:10.207
> 
> 标签：xml, validation, sequence

我的 XML 文本如下所示：

```
<?xml version="1.0" encoding="UTF-8" ?>
<root>
    <create>a</create>
    <create>b</create>
    <createname>c</createname>
    <createname>d</createname>
    <primary>k</primary>
    <column>e</column>
    <column>f</column>
</root> 
```

通常，元素“create”、“createname”、“column”至少可以出现一次（1 到无界），元素“primary”应该只出现一次，所有这些元素可以按任意顺序排列。

"xsd:all" 只允许 0 或一次；"xsd:sequce" 表示元素必须按顺序显示，

如何使用 xsd 来实现此验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T19:50:10.400

简而言之，你不能。XML Schema 依赖于顺序来强制执行元素的计数（“all”除外）。大多数“编组”库也需要订单。如果您无法控制 XML 文件，一个建议是在验证之前使用 XSL 对其进行转换。

```
 <xsl:template match="/">
    <xsl:element name="root"></xsl:element>
    <xsl:for-each select="create">
        <xsl:copy-of select="."/>
    </xsl:for-each>
    <xsl:for-each select="createname">
        <xsl:for-each select="createname"></xsl:for-each>
    </xsl:for-each>
   </xsl:template> 
```

# ios - iOS推送通知的内存

> ID：13983853
> 
> 赞同：1
> 
> 时间：2012-12-21T03:21:54.203
> 
> 标签：ios, push-notification

我有一个 512M 内存的 vps，我想将它用作我的 iOS 应用程序的推送通知服务器，当时我将消息推送给 2,000 个用户（2,000 个设备令牌），由于使用了太多内存，vps 会下降。现在我有 30,0000 个用户，有没有办法向所有这些用户推送消息？或者我应该为 30,000 个用户准备多大的内存？

# delphi - 如何创建一个可以滚动固定行和列的自定义控件？

> ID：13983858
> 
> 赞同：6
> 
> 时间：2012-12-21T03:22:28.080
> 
> 标签：delphi, custom-controls, scrollbar, delphi-xe2

我试图弄清楚如何以用户可以向各个方向滚动但具有固定行和列的方式制作自定义控件。网格不适合我想要做的事情，因为它逐列滚动。我需要逐个像素地平滑滚动。我没有用列，只有视觉网格线。垂直滚动不仅要滚动右侧的区域，还要滚动左侧的固定区域。与水平滚动相同：标题行应与水平滚动条一起移动。

这只是我正在处理的最终控制的草稿。

![粗略控制设计](../Images/939267a24b696866d3c07c2d032d838f.png)

请注意滚动条如何不覆盖整个控件，仅覆盖较大的区域。固定的列/行也应该能够与它们相应的滚动条一起移动。

我应该如何实现滚动条才能做到这一点？

PS - 这是为了替换一个更彻底的问题，该问题因误导性请求而被删除。很抱歉，如果我缺少您可能需要知道的细节。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T14:44:03.870

首先，我认为您可以使用能够在单元格中保存控件的[组件](https://stackoverflow.com/a/6365764/757830)（示例[图像](https://stackoverflow.com/a/11507346/757830)），但是从您的评论中我了解到您想自己绘制所有内容。所以我写了一个' `THeaderGrid`'组件：

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  with THeaderGrid.Create(Self) do
  begin
    Align := alClient;
    OnDrawCell := DrawCell;
    OnDrawColHeader := DrawCell;
    OnDrawRowHeader := DrawCell;
    Parent := Self;
  end;
end;

procedure TForm1.DrawCell(Sender: TObject; ACanvas: TCanvas; ACol,
  ARow: Integer; R: TRect);
begin
  ACanvas.TextOut(R.Left + 2, R.Top + 2, Format('(%d,%d)', [ACol, ARow]));
end; 
```

![截屏](../Images/6e7880ece7247638c9c3105c1f9eee0b.png)

`TPaintScroller`该组件由三个控件（a `TPaintBox`on a `TScrollBox`）构建而成。实际上，对于这两个标头来说，`TScrollBox`它有点重，但是使用与单元格的数据区域相同的控件是一种方便。

共有三个 OnDraw 事件，一个用于标题，一个用于单元格，但您可以将它们都设置为相同的处理程序，就像上面的示例一样。通过列或行索引来区分每个`-1`。

```
unit HeaderGrid;

interface

uses
  Classes, Controls, Windows, Messages, Graphics, Forms, ExtCtrls, StdCtrls;

type
  TPaintEvent = procedure(ACanvas: TCanvas) of object;

  TPaintScroller = class(TScrollingWinControl)
  private
    FOnPaint: TPaintEvent;
    FOnScroll: TNotifyEvent;
    FPainter: TPaintBox;
    function GetPaintHeight: Integer;
    function GetPaintWidth: Integer;
    function GetScrollBars: TScrollStyle;
    procedure SetPaintHeight(Value: Integer);
    procedure SetPaintWidth(Value: Integer);
    procedure SetScrollBars(Value: TScrollStyle);
    procedure WMEraseBkgnd(var Message: TWMEraseBkgnd); message WM_ERASEBKGND;
    procedure WMHScroll(var Message: TWMScroll); message WM_HSCROLL;
    procedure WMVScroll(var Message: TWMScroll); message WM_VSCROLL;
  protected
    procedure CreateParams(var Params: TCreateParams); override;
    function DoMouseWheel(Shift: TShiftState; WheelDelta: Integer;
      MousePos: TPoint): Boolean; override;
    procedure DoPaint(Sender: TObject); virtual;
    procedure DoScroll; virtual;
    procedure PaintWindow(DC: HDC); override;
    procedure Resize; override;
  public
    constructor Create(AOwner: TComponent); override;
  published
    property OnPaint: TPaintEvent read FOnPaint write FOnPaint;
    property OnScroll: TNotifyEvent read FOnScroll write FOnScroll;
    property PaintHeight: Integer read GetPaintHeight write SetPaintHeight;
    property PaintWidth: Integer read GetPaintWidth write SetPaintWidth;
    property ScrollBars: TScrollStyle read GetScrollBars write SetScrollBars
      default ssBoth;
  end;

  TDrawCellEvent = procedure(Sender: TObject; ACanvas: TCanvas; ACol,
    ARow: Integer; R: TRect) of object;

  THeaderGrid = class(TCustomControl)
  private
    FCellScroller: TPaintScroller;
    FColCount: Integer;
    FColHeader: TPaintScroller;
    FColWidth: Integer;
    FOnDrawCell: TDrawCellEvent;
    FOnDrawColHeader: TDrawCellEvent;
    FOnDrawRowHeader: TDrawCellEvent;
    FRowCount: Integer;
    FRowHeader: TPaintScroller;
    FRowHeight: Integer;
    procedure CellsScrolled(Sender: TObject);
    function GetColHeaderHeight: Integer;
    function GetRowHeaderWidth: Integer;
    procedure PaintCells(ACanvas: TCanvas);
    procedure PaintColHeader(ACanvas: TCanvas);
    procedure PaintRowHeader(ACanvas: TCanvas);
    procedure SetColCount(Value: Integer);
    procedure SetColHeaderHeight(Value: Integer);
    procedure SetColWidth(Value: Integer);
    procedure SetRowCount(Value: Integer);
    procedure SetRowHeaderWidth(Value: Integer);
    procedure SetRowHeight(Value: Integer);
    procedure UpdateSize;
    procedure WMEraseBkgnd(var Message: TWMEraseBkgnd); message WM_ERASEBKGND;
  protected
    procedure CreateParams(var Params: TCreateParams); override;
    procedure DoDrawCell(ACanvas: TCanvas; ACol, ARow: Integer;
      R: TRect); virtual;
    procedure DoDrawColHeader(ACanvas: TCanvas; ACol: Integer;
      R: TRect); virtual;
    procedure DoDrawRowHeader(ACanvas: TCanvas; ARow: Integer;
      R: TRect); virtual;
    procedure Paint; override;
  public
    constructor Create(AOwner: TComponent); override;
    procedure MouseWheelHandler(var Message: TMessage); override;
  published
    property ColCount: Integer read FColCount write SetColCount default 5;
    property ColHeaderHeight: Integer read GetColHeaderHeight
      write SetColHeaderHeight default 24;
    property ColWidth: Integer read FColWidth write SetColWidth default 64;
    property OnDrawCell: TDrawCellEvent read FOnDrawCell write FOnDrawCell;
    property OnDrawColHeader: TDrawCellEvent read FOnDrawColHeader
      write FOnDrawColHeader;
    property OnDrawRowHeader: TDrawCellEvent read FOnDrawRowHeader
      write FOnDrawRowHeader;
    property RowCount: Integer read FRowCount write SetRowCount default 5;
    property RowHeaderWidth: Integer read GetRowHeaderWidth
      write SetRowHeaderWidth default 64;
    property RowHeight: Integer read FRowHeight write SetRowHeight default 24;
  published
    property Color;
    property Font;
    property ParentColor default False;
    property TabStop default True;
  end;

implementation

{ TPaintScroller }

constructor TPaintScroller.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  ControlStyle := [csOpaque];
  HorzScrollBar.Tracking := True;
  VertScrollBar.Tracking := True;
  Width := 100;
  Height := 100;
  FPainter := TPaintBox.Create(Self);
  FPainter.SetBounds(0, 0, 100, 100);
  FPainter.OnPaint := DoPaint;
  FPainter.Parent := Self;
end;

procedure TPaintScroller.CreateParams(var Params: TCreateParams);
begin
  inherited CreateParams(Params);
  with Params.WindowClass do
    Style := Style and not (CS_HREDRAW or CS_VREDRAW);
end;

function TPaintScroller.DoMouseWheel(Shift: TShiftState;
  WheelDelta: Integer; MousePos: TPoint): Boolean;
begin
  VertScrollBar.Position := VertScrollBar.Position - WheelDelta;
  DoScroll;
  Result := True;
end;

procedure TPaintScroller.DoPaint(Sender: TObject);
begin
  if Assigned(FOnPaint) then
    FOnPaint(FPainter.Canvas);
end;

procedure TPaintScroller.DoScroll;
begin
  if Assigned(FOnScroll) then
    FOnScroll(Self);
end;

function TPaintScroller.GetPaintHeight: Integer;
begin
  Result := FPainter.Height;
end;

function TPaintScroller.GetPaintWidth: Integer;
begin
  Result := FPainter.Width;
end;

function TPaintScroller.GetScrollBars: TScrollStyle;
begin
  if HorzScrollBar.Visible and VertScrollBar.Visible then
    Result := ssBoth
  else if not HorzScrollBar.Visible and VertScrollBar.Visible then
    Result := ssVertical
  else if HorzScrollBar.Visible and not VertScrollBar.Visible then
    Result := ssHorizontal
  else
    Result := ssNone;
end;

procedure TPaintScroller.PaintWindow(DC: HDC);
begin
  with FPainter do
    ExcludeClipRect(DC, 0, 0, Width + Left, Height + Top);
  FillRect(DC, ClientRect, Brush.Handle);
end;

procedure TPaintScroller.Resize;
begin
  DoScroll;
  inherited Resize;
end;

procedure TPaintScroller.SetPaintHeight(Value: Integer);
begin
  FPainter.Height := Value;
end;

procedure TPaintScroller.SetPaintWidth(Value: Integer);
begin
  FPainter.Width := Value;
end;

procedure TPaintScroller.SetScrollBars(Value: TScrollStyle);
begin
  HorzScrollBar.Visible := (Value = ssBoth) or (Value = ssHorizontal);
  VertScrollBar.Visible := (Value = ssBoth) or (Value = ssVertical);
end;

procedure TPaintScroller.WMEraseBkgnd(var Message: TWMEraseBkgnd);
begin
  Message.Result := 1;
end;

procedure TPaintScroller.WMHScroll(var Message: TWMScroll);
begin
  inherited;
  DoScroll;
end;

procedure TPaintScroller.WMVScroll(var Message: TWMScroll);
begin
  inherited;
  DoScroll;
end;

{ THeaderGrid }

procedure THeaderGrid.CellsScrolled(Sender: TObject);
begin
  FColHeader.FPainter.Left := -FCellScroller.HorzScrollBar.Position;
  FRowHeader.FPainter.Top := -FCellScroller.VertScrollBar.Position;
end;

constructor THeaderGrid.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  ControlStyle := [csOpaque];
  ParentColor := False;
  TabStop := True;
  FCellScroller := TPaintScroller.Create(Self);
  FCellScroller.Anchors := [akLeft, akTop, akRight, akBottom];
  FCellScroller.OnPaint := PaintCells;
  FCellScroller.OnScroll := CellsScrolled;
  FCellScroller.AutoScroll := True;
  FCellScroller.Parent := Self;
  FColHeader := TPaintScroller.Create(Self);
  FColHeader.Anchors := [akLeft, akTop, akRight];
  FColHeader.OnPaint := PaintColHeader;
  FColHeader.ScrollBars := ssNone;
  FColHeader.Parent := Self;
  FRowHeader := TPaintScroller.Create(Self);
  FRowHeader.Anchors := [akLeft, akTop, akBottom];
  FRowHeader.OnPaint := PaintRowHeader;
  FRowHeader.ScrollBars := ssNone;
  FRowHeader.Parent := Self;
  Width := 320;
  Height := 120;
  ColCount := 5;
  RowCount := 5;
  ColWidth := 64;
  RowHeight := 24;
  ColHeaderHeight := 24;
  RowHeaderWidth := 64;
end;

procedure THeaderGrid.CreateParams(var Params: TCreateParams);
begin
  inherited CreateParams(Params);
  with Params.WindowClass do
    Style := Style and not (CS_HREDRAW or CS_VREDRAW);
end;

procedure THeaderGrid.DoDrawCell(ACanvas: TCanvas; ACol, ARow: Integer;
  R: TRect);
begin
  if Assigned(FOnDrawCell) then
    FOnDrawCell(Self, ACanvas, ACol, ARow, R);
end;

procedure THeaderGrid.DoDrawColHeader(ACanvas: TCanvas; ACol: Integer;
  R: TRect);
begin
 if Assigned(FOnDrawColHeader) then
   FOnDrawColHeader(Self, ACanvas, ACol, -1, R);
end;

procedure THeaderGrid.DoDrawRowHeader(ACanvas: TCanvas; ARow: Integer;
  R: TRect);
begin
  if Assigned(FOnDrawRowHeader) then
    FOnDrawRowHeader(Self, ACanvas, -1, ARow, R);
end;

function THeaderGrid.GetColHeaderHeight: Integer;
begin
  Result := FColHeader.Height;
end;

function THeaderGrid.GetRowHeaderWidth: Integer;
begin
  Result := FRowHeader.Width;
end;

procedure THeaderGrid.MouseWheelHandler(var Message: TMessage);
begin
  with Message do
    Result := FCellScroller.Perform(CM_MOUSEWHEEL, WParam, LParam);
  if Message.Result = 0 then
    inherited MouseWheelHandler(Message);
end;

procedure THeaderGrid.Paint;
var
  R: TRect;
begin
  Canvas.Brush.Color := Color;
  R := Rect(0, 0, RowHeaderWidth, ColHeaderHeight);
  if IntersectRect(R, R, Canvas.ClipRect) then
    Canvas.FillRect(R);
  Canvas.Brush.Color := clBlack;
  R := Rect(0, ColHeaderHeight, Width, ColHeaderHeight + 1);
  if IntersectRect(R, R, Canvas.ClipRect) then
    Canvas.FillRect(R);
  R := Rect(RowHeaderWidth, 0, RowHeaderWidth + 1, Height);
  if IntersectRect(R, R, Canvas.ClipRect) then
    Canvas.FillRect(R);
end;

procedure THeaderGrid.PaintCells(ACanvas: TCanvas);
var
  Col: Integer;
  Row: Integer;
  R: TRect;
  Dummy: TRect;
begin
  ACanvas.Brush.Color := Color;
  ACanvas.Font := Font;
  ACanvas.FillRect(ACanvas.ClipRect);
  for Row := 0 to FRowCount - 1 do
  begin
    R := Bounds(0, Row * FRowHeight, FColWidth, FRowHeight);
    for Col := 0 to FColCount - 1 do
    begin
      if IntersectRect(Dummy, R, ACanvas.ClipRect) then
      begin
        DoDrawCell(ACanvas, Col, Row, R);
        if ACanvas.Pen.Style <> psSolid then
          ACanvas.Pen.Style := psSolid;
        if ACanvas.Pen.Color <> clSilver then
          ACanvas.Pen.Color := clSilver;
        ACanvas.MoveTo(R.Left, R.Bottom - 1);
        ACanvas.LineTo(R.Right - 1, R.Bottom - 1);
        ACanvas.LineTo(R.Right - 1, R.Top - 1);
      end;
      OffsetRect(R, FColWidth, 0);
    end;
  end;
end;

procedure THeaderGrid.PaintColHeader(ACanvas: TCanvas);
var
  Col: Integer;
  R: TRect;
  Dummy: TRect;
begin
  ACanvas.Brush.Color := Color;
  ACanvas.Font := Font;
  ACanvas.FillRect(ACanvas.ClipRect);
  R := Rect(0, 0, FColWidth, ColHeaderHeight);
  for Col := 0 to FColCount - 1 do
  begin
    if IntersectRect(Dummy, R, ACanvas.ClipRect) then
      DoDrawColHeader(ACanvas, Col, R);
    OffsetRect(R, FColWidth, 0);
  end;
end;

procedure THeaderGrid.PaintRowHeader(ACanvas: TCanvas);
var
  Row: Integer;
  R: TRect;
  Dummy: TRect;
begin
  ACanvas.Brush.Color := Color;
  ACanvas.Font := Font;
  ACanvas.FillRect(ACanvas.ClipRect);
  R := Rect(0, 0, RowHeaderWidth, FRowHeight);
  for Row := 0 to FRowCount - 1 do
  begin
    if IntersectRect(Dummy, R, ACanvas.ClipRect) then
    begin
      DoDrawRowHeader(ACanvas, Row, R);
      if ACanvas.Pen.Style <> psSolid then
        ACanvas.Pen.Style := psSolid;
      if ACanvas.Pen.Color <> clSilver then
        ACanvas.Pen.Color := clSilver;
      ACanvas.MoveTo(R.Left, R.Bottom - 1);
      ACanvas.LineTo(R.Right - 1, R.Bottom - 1);
    end;
    OffsetRect(R, 0, FRowHeight);
  end;
end;

procedure THeaderGrid.SetColCount(Value: Integer);
begin
  if FColCount <> Value then
  begin
    FColCount := Value;
    UpdateSize;
  end;
end;

procedure THeaderGrid.SetColHeaderHeight(Value: Integer);
begin
  if Value >= 0 then
  begin
    FColHeader.Height := Value;
    FRowHeader.BoundsRect := Rect(0, Value + 1, RowHeaderWidth, Height);
    FCellScroller.BoundsRect := Rect(RowHeaderWidth + 1, Value + 1, Width,
      Height);
  end;
end;

procedure THeaderGrid.SetColWidth(Value: Integer);
begin
  if FColWidth <> Value then
  begin
    FColWidth := Value;
    FCellScroller.HorzScrollBar.Increment := Value;
    UpdateSize;
  end;
end;

procedure THeaderGrid.SetRowCount(Value: Integer);
begin
  if FRowCount <> Value then
  begin
    FRowCount := Value;
    UpdateSize;
  end;
end;

procedure THeaderGrid.SetRowHeaderWidth(Value: Integer);
begin
  if Value >= 0 then
  begin
    FRowHeader.Width := Value;
    FColHeader.BoundsRect := Rect(Value + 1, 0, Width, ColHeaderHeight);
    FCellScroller.BoundsRect := Rect(Value + 1, ColHeaderHeight + 1, Width,
      Height);
  end;
end;

procedure THeaderGrid.SetRowHeight(Value: Integer);
begin
  if FRowHeight <> Value then
  begin
    FRowHeight := Value;
    FCellScroller.VertScrollBar.Increment := Value;
    UpdateSize;
  end;
end;

procedure THeaderGrid.UpdateSize;
begin
  FColHeader.PaintWidth := FColCount * FColWidth;
  FRowHeader.PaintHeight := FRowCount * FRowHeight;
  FCellScroller.PaintWidth := FColCount * FColWidth;
  FCellScroller.PaintHeight := FRowCount * FRowHeight;
end;

procedure THeaderGrid.WMEraseBkgnd(var Message: TWMEraseBkgnd);
begin
  Message.Result := 1;
end;

end. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T06:39:03.597

最简单的方法是制作一个没有滚动条的控件，然后将滚动条放在它上面，并对其大小和位置进行精细控制。

使用 Delphi 3-5，您可以使用自定义容器包将其封装为新控件，并像使用常规网格一样拖放到新表单上。

由于 D5 CCP 不再可用，但作为 VCL TFrame 给出了有限的模拟。或者您可以在运行时创建这些滚动条 - 您需要搜索 Windows 句柄创建例程（跟踪 TControl.Handle getter 方法），可能是 ReCreateWnd 等，并且在创建 GDI 句柄时 - 在其上创建滚动条。

# c# - 另一个缩短 SQL 字符串？C＃

> ID：13983863
> 
> 赞同：0
> 
> 时间：2012-12-21T03:23:06.467
> 
> 标签：c#, mysql, sql, select

有些人可能已经注意到了这一点，我想确认一下，我对复杂的 SQL 字符串真的没有经验。我只知道简单的 SELECT 、 INSERT 、 UPDATE 和 DELETE 语句。为了达到我的目的，我经常使用 2 SELECT 语句，比如这个：

```
con.Open();
string cmdstr = "SELECT UNIQUE FROM recipeList WHERE `stock_ID` = '" + stockIDTxtbox.Text + "'";
cmd = new MySqlCommand(cmdstr, con);
dr = cmd.ExecuteReader();
string menuID = "";
while (dr.Read())
{
   menuID = (dr["menu_ID"].ToString());
}
dr.Close();
con.Close();

con.Open();
string cmdstr = "SELECT `menu_name` FROM recipedb WHERE `menu_ID` = '" + menuID + "'";
cmd = new MySqlCommand(cmdstr, con);
dr = cmd.ExecuteReader();
string menuName = "";
while (dr.Read())
{
    menuName = (dr["menu_name"].ToString());
    this.listView1.Items.Add(new ListViewItem(new string[]{ menuName  }))
}
dr.Close();
con.Close(); 
```

任何想法如何缩短这个？oO

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:28:48.110

好久没写SQL了，不过应该是join吧，如下：

```
select rdb.menu_name
from recipedb rdb, 
     recipelist rl
where rl.menu_ID = rdb.menu_ID and
      rl.stock_ID = * insert your stockIDTxtbox.Text in here without the stars * 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T03:33:07.873

您可以将 SQL 编写为：

```
 string queryString =  "SELECT r2.menu_name "+
                       "FROM recipelist rl "+ 
                          "INNER JOIN recipedb r2 "+
                          "ON rl.menu_ID = r2.menu_ID "+
                       "WHERE r1.stock_ID = '" + stockIDTxtbox.Text + "'"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T03:35:54.777

这是一个简短的：

```
con.Open();
string cmdstr = "SELECT menu_name FROM recipedb WHERE menu_ID in (SELECT UNIQUE menu_id from recipeList WHERE stock_ID = '" + stockIDTxtbox.Text + "')";
cmd = new MySqlCommand(cmdstr, con);
dr = cmd.ExecuteReader();
string menuName = "";
while (dr.Read())
{
   menuName = (dr["menu_name"].ToString());
   this.listView1.Items.Add(new ListViewItem(new string[]{ menuName  }))
}
dr.Close();
con.Close(); 
```

# plugins - 如何制作一个d3插件？

> ID：13983864
> 
> 赞同：17
> 
> 时间：2012-12-21T03:23:08.993
> 
> 标签：plugins, d3.js

我想做一个简单的 d3 插件，但找不到如何做的信息。

它需要非常简单：

```
s.append('text').text("Some Text").editable(); 
```

应该只翻译成

```
s.append('text').text("Some Text").attr('data-editable', true); 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-21T04:01:34.210

不得不去挖掘源头，但最终得到了它。

```
(function() {
  d3.selection.prototype.editable = function() {
    return this.attr('data-editable', true);
  };
})(); 
```

[杰斯宾在这里](http://jsbin.com/ifayel/1/)

另请注意，如果您还希望插件在`.enter()`您需要分配`d3.selection.enter.prototype`.

如果（在我的情况下）您希望您的插件在两种情况下都可用：

```
(function() {
    d3.selection.prototype.editable = d3.selection.enter.prototype.editable = function() {
        return this.attr('data-editable', true);
      };
})(); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-02T23:56:08.620

Mike Bostock 写了 Towards Reusable Charts [http://bost.ocks.org/mike/chart/](http://bost.ocks.org/mike/chart/)

我按照这种模式制作了一个非常简单的示例 d3 插件，请参阅此块：[http](http://bl.ocks.org/cpbotha/5073718) ://bl.ocks.org/cpbotha/5073718 （和源要点：[https](https://gist.github.com/cpbotha/5073718) ://gist.github.com/cpbotha/5073718 ）。

根据 Mike Bostock 的说法，可重用图表应实现为“使用 getter-setter 方法的闭包”。我在上面的示例中正是这样做的。

@Wex 的答案也遵循这种模式，只是它没有展示闭包的想法，因为原始问题没有指定需要任何属性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-21T17:54:25.580

我看到它记录的方式：

```
function editable() {
    d3.select(this).attr("data-editable", true);
} 
```

其次是：

```
s.append('text').text("Some Text").call(editable); 
```

或者

```
d3.selectAll("text").each(editable); 
```

虽然我更喜欢乔治的解决方案。

# recursion - 求解具有多个递归步骤的递归方程

> ID：13983865
> 
> 赞同：0
> 
> 时间：2012-12-21T03:23:12.923
> 
> 标签：recursion, big-o, time-complexity, recurrence

我正在研究一些算法，并试图确定在形成方程时如何处理多个递归步骤。

所以展览A： ![展品 A](../Images/9345c5289b6c1cb0d91f63128dac5ab0.png)

对我来说很明显，这里的递归方程是： T(n) = c + 2T(n/2) 在大 O 表示法中简化为 O(n)

然而在这里，![展品 B](../Images/610ccfc4f88cd9fcc35c81ca6b1f5ec6.png)我们也有类似的事情发生，我得到了递归方程 T(n) = n + 2T(n/2) 因为我们有两个递归调用与第一个不同，在大 O 表示法中简化为 O (n)，但是这里不是这样。关于如何在第二个中获得正确的递归方程的任何输入？

任何关于如何解决这个问题的意见都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T03:37:31.980

您可能对主定理感兴趣：

[http://en.wikipedia.org/wiki/Master_theorem](http://en.wikipedia.org/wiki/Master_theorem)

递推方程`T(n) = n + 2T(n/2)`是`Theta(n log n)`，可以使用定理推导出来。要手动执行此操作，您还可以假设`n = 2^k`并执行以下操作：

```
T(n) = 2T(n/2) + n
     = 2(2T(n/4) + n/2) + n
     = (2^2)T(n/(2^2)) + 2n
     = (2^2)(2T(n/(2^3)) + n/(2^2)) + 2n
     = (2^3)T(n/(2^3)) + 3n
     = ...
     = (2^k)T(n/(2^k)) + kn
     = nT(1) + n log2 n
     = Theta(n log n) 
```

# c# - javascript show hide div

> ID：13983869
> 
> 赞同：-1
> 
> 时间：2012-12-21T03:23:36.780
> 
> 标签：c#, javascript, asp.net

how to do show and hide div in javascript and simillarly in c# pageload how to call div based on id value.can any one help on this ?

```
<ul>
<li><a href="#cat1">cat1</a></li>
<li><a href="#cat2">cat2</a></li>
<li><a href="#cat3">cat3</a></li>
</ul>

<div id="cat1">
<asp:UpdatePanel>
<asp:Panel>
<asp:ListView>
</asp:ListView>
</asp:Panel>
</asp:UpdatePanel>
</div>

<div id="cat2">
<asp:UpdatePanel>
<asp:Panel>
<asp:ListView>
</asp:ListView>
</asp:Panel>
</asp:UpdatePanel>
</div>

<div id="cat3">
<asp:UpdatePanel>
<asp:Panel>
<asp:ListView>
</asp:ListView>
</asp:Panel>
</asp:UpdatePanel>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T03:40:26.687

要在 C# 代码隐藏中引用 div，您需要向`runat="server"`div 添加一个属性。`Page_Load`然后，您可以在方法中通过 ID 引用它。您还应该`ClientIDMode="Static"`为 div 设置，以修复 div 的 ID，以便您可以在 Javascript 中引用它。注意静态 ID 的 ID 冲突。

使用严格的 Javascript，您可以像这样隐藏 div：

```
var elem = document.getElementById('cat1');
elem.style.display = 'none'; 
```

您可以像这样显示 div：

```
var elem = document.getElementById('cat1');
elem.style.display = 'block'; 
```

JQuery 可能是比 getElementById 方法更好的方法：

```
$('#cat1').hide(); 
```

和

```
$('#cat1').show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T05:02:35.577

```
function showDiv()
{
  // This is to show the div
   document.getElementById('divId').style.display = 'block';
}

function hideDiv()
{
 // This is to hide the div
   document.getElementById('divId').style.display = 'none';
} 
```

如果 div 具有 runat 属性，则代码将不支持..

希望对你有帮助..

# android - Marquee TextView not working in Android Layout

> ID：13983871
> 
> 赞同：0
> 
> 时间：2012-12-21T03:24:25.047
> 
> 标签：android, layout, textview, marquee

I'm trying to get @+id/trackname and @+id/artist_and_album to use the marquee setting in the following layout but they won't scroll. I also tried using setSelected(true) and setFocusable(true) in the actual Activity but that didn't work. Here is a picture of the layout:

![enter image description here](../Images/755c02ae5959288759760328aeda6278.png)

and the XML:

```
<LinearLayout
    android:id="@+id/player_actionbar"
    android:layout_width="fill_parent"
    android:layout_height="48dip"
    android:layout_alignParentTop="true"
    android:gravity="center_vertical"
    android:orientation="horizontal" >

    <ImageButton
        android:id="@+id/close"
        android:layout_width="56dip"
        android:layout_height="fill_parent"
        android:padding="4dip"
        android:scaleType="centerInside"
        android:background="@drawable/bg_actionbar_item"
        android:src="@drawable/icn_close" />

    <View
        android:layout_width="1dip"
        android:layout_height="26dip"
        android:background="#ff444444" />

    <TextView
        android:id="@+id/actionbar_title"
        android:layout_width="0dip"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:textSize="18sp"
        android:textColor="#ffffffff"
        android:ellipsize="marquee"
        android:gravity="center_vertical"
        android:paddingLeft="6dip"
        android:paddingRight="6dip"
        android:singleLine="true"
        android:layout_marginLeft="8dip"
        android:text="@string/nowplaying_title" />

    <ImageButton
        android:id="@+id/play_queue"
        android:layout_width="56dip"
        android:layout_height="fill_parent"
        android:padding="4dip"
        android:scaleType="centerInside"
        android:background="@drawable/bg_actionbar_item"
        android:src="@drawable/icn_play_queue" />

</LinearLayout>

<RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_above="@+id/player_controller"
    android:layout_below="@+id/player_actionbar" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_above="@+id/player_info"
        android:padding="10dip"
        android:background="@null" >

        <ImageView
            android:id="@+id/album_art"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:background="@null"
            android:src="@drawable/albumart_mp_unknown" />

    </LinearLayout>

    <LinearLayout
        android:id="@+id/player_info"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_marginTop="10dip"
        android:layout_marginLeft="12dip"
        android:gravity="center_horizontal"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/track_number_text"
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            android:paddingTop="5dip"
            android:textSize="13dip"
            android:textStyle="normal"
            android:textColor="#ffa9a9a9"
            android:singleLine="true" />

        <TextView 
            android:id="@+id/trackname"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textSize="17dip"
            android:textStyle="bold"
            android:textColor="#ffffffff"
            android:ellipsize="marquee"
            android:singleLine="true" />

        <TextView
            android:id="@+id/artist_and_album"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textSize="13dip"
            android:textStyle="normal"
            android:textColor="#ffa9a9a9"
            android:ellipsize="marquee"
            android:singleLine="true" />

    </LinearLayout>

</RelativeLayout>

<LinearLayout
    android:id="@+id/player_controller"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="40dip"
        android:paddingLeft="12dip"
        android:paddingRight="12dip"
        android:gravity="center_vertical"
        android:orientation="horizontal" >

        <TextView
            android:id="@+id/position_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:paddingRight="6dip" 
            android:textSize="12dip"
            android:textColor="#ffbbbbbb"
            android:gravity="right" />

        <SeekBar
            android:id="@+id/seek_bar"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:gravity="center_vertical"
            android:paddingLeft="9dip"
            android:paddingRight="9dip"
            android:progress="0"
            android:progressDrawable="@drawable/player_progress_drawable"
            android:thumb="@drawable/player_progress_thumb"
            android:thumbOffset="9dip"
            android:maxHeight="2dip"
            android:minHeight="2dip" />

        <TextView
            android:id="@+id/duration_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:paddingLeft="6dip"
            android:textSize="12dip"
            android:textColor="#ffbbbbbb"
            android:gravity="left" />
    </LinearLayout>

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="60dip"
        android:orientation="horizontal" >

        <ImageButton
            android:id="@+id/shuffle_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:paddingBottom="20dip"
            android:paddingLeft="12dip"
            android:paddingRight="10dip"
            android:paddingTop="8dip"
            android:background="@null"
            android:src="@drawable/btn_player_shuffle_normal" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_toLeftOf="@+id/repeat_button"
            android:layout_toRightOf="@+id/shuffle_button"
            android:paddingLeft="10dip"
            android:paddingRight="10dip"
            android:gravity="center_vertical"
            android:orientation="horizontal" >

            <net.sourceforge.servestream.button.RepeatingImageButton
                android:id="@+id/previous_button"
                android:background="@null"
                android:paddingBottom="20dip"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:src="@drawable/btn_player_prev" />

            <ImageButton
                android:id="@+id/play_pause_button"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:paddingBottom="20dip"
                android:background="@null"
                android:src="@drawable/btn_player_play" />

            <net.sourceforge.servestream.button.RepeatingImageButton
                android:id="@+id/next_button"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:paddingBottom="20dip"
                android:background="@null"
                android:src="@drawable/btn_player_next" />
        </LinearLayout>

        <ImageButton
            android:id="@+id/repeat_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:paddingBottom="20dip"
            android:paddingLeft="10dip"
            android:paddingRight="12dip"
            android:paddingTop="8dip"
            android:background="@null"
            android:src="@drawable/btn_player_repeat_normal" />

    </RelativeLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:16:14.480

我将布局修改为：

```
<LinearLayout
    android:id="@+id/player_actionbar"
    android:layout_width="fill_parent"
    android:layout_height="48dip"
    android:gravity="center_vertical"
    android:orientation="horizontal" >

    <ImageButton
        android:id="@+id/close"
        android:layout_width="56dip"
        android:layout_height="fill_parent"
        android:padding="4dip"
        android:scaleType="centerInside"
        android:background="@drawable/bg_actionbar_item"
        android:src="@drawable/icn_close" />

    <View
        android:layout_width="1dip"
        android:layout_height="26dip"
        android:background="#ff444444" />

    <TextView
        android:id="@+id/actionbar_title"
        android:layout_width="0dip"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:textSize="18sp"
        android:textColor="#ffffffff"
        android:ellipsize="marquee"
        android:gravity="center_vertical"
        android:paddingLeft="6dip"
        android:paddingRight="6dip"
        android:singleLine="true"
        android:layout_marginLeft="8dip"
        android:text="@string/nowplaying_title" />

    <ImageButton
        android:id="@+id/play_queue"
        android:layout_width="56dip"
        android:layout_height="fill_parent"
        android:padding="4dip"
        android:scaleType="centerInside"
        android:background="@drawable/bg_actionbar_item"
        android:src="@drawable/icn_play_queue" />

</LinearLayout>

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="0dip"
    android:layout_weight="1"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="0dip"
        android:layout_weight="1"
        android:padding="10dip"
        android:background="@null" >

        <net.sourceforge.servestream.utils.CoverView
            android:id="@+id/album_art"
            android:layout_height="fill_parent"
            android:layout_width="fill_parent" />

    </LinearLayout>

    <LinearLayout
        android:id="@+id/player_info"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dip"
        android:gravity="center_horizontal"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/track_number_text"
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            android:paddingTop="5dip"
            android:textSize="13sp"
            android:textStyle="normal"
            android:textColor="#ffa9a9a9"
            android:singleLine="true" />

        <TextView 
            android:id="@+id/trackname"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textSize="17sp"
            android:textStyle="bold"
            android:textColor="#ffffffff"
            android:ellipsize="marquee"
            android:singleLine="true" />

        <TextView
            android:id="@+id/artist_and_album"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textSize="13sp"
            android:textStyle="normal"
            android:textColor="#ffa9a9a9"
            android:ellipsize="marquee"
            android:singleLine="true" />

    </LinearLayout>

</LinearLayout>

<LinearLayout
    android:id="@+id/player_controller"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="40dip"
        android:paddingLeft="12dip"
        android:paddingRight="12dip"
        android:gravity="center_vertical"
        android:orientation="horizontal" >

        <TextView
            android:id="@+id/position_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:paddingRight="6dip" 
            android:textSize="12sp"
            android:textColor="#ffbbbbbb"
            android:gravity="right" />

        <SeekBar
            android:id="@+id/seek_bar"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:gravity="center_vertical"
            android:paddingLeft="9dip"
            android:paddingRight="9dip"
            android:progress="0"
            android:progressDrawable="@drawable/player_progress_drawable"
            android:thumb="@drawable/player_progress_thumb"
            android:thumbOffset="9dip"
            android:maxHeight="2dip"
            android:minHeight="2dip" />

        <TextView
            android:id="@+id/duration_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:paddingLeft="6dip"
            android:textSize="12sp"
            android:textColor="#ffbbbbbb"
            android:gravity="left" />

    </LinearLayout>

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="60dip"
        android:orientation="horizontal" >

        <ImageButton
            android:id="@+id/shuffle_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:paddingBottom="20dip"
            android:paddingLeft="12dip"
            android:paddingRight="10dip"
            android:paddingTop="8dip"
            android:background="@null"
            android:src="@drawable/btn_player_shuffle_normal" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_toLeftOf="@+id/repeat_button"
            android:layout_toRightOf="@+id/shuffle_button"
            android:paddingLeft="10dip"
            android:paddingRight="10dip"
            android:gravity="center_vertical"
            android:orientation="horizontal" >

            <net.sourceforge.servestream.button.RepeatingImageButton
                android:id="@+id/previous_button"
                android:background="@null"
                android:paddingBottom="20dip"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:src="@drawable/btn_player_prev" />

            <ImageButton
                android:id="@+id/play_pause_button"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:paddingBottom="20dip"
                android:background="@null"
                android:src="@drawable/btn_player_play" />

            <net.sourceforge.servestream.button.RepeatingImageButton
                android:id="@+id/next_button"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:paddingBottom="20dip"
                android:background="@null"
                android:src="@drawable/btn_player_next" />
        </LinearLayout>

        <ImageButton
            android:id="@+id/repeat_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:paddingBottom="20dip"
            android:paddingLeft="10dip"
            android:paddingRight="12dip"
            android:paddingTop="8dip"
            android:background="@null"
            android:src="@drawable/btn_player_repeat_normal" />

    </RelativeLayout>

</LinearLayout> 
```

我还在我的活动中加入了以下几行：

```
 mTrackName = (TextView) findViewById(R.id.trackname);
    mTrackName.setSelected(true);
    mArtistAndAlbumName = (TextView) findViewById(R.id.artist_and_album);
    mArtistAndAlbumName.setSelected(true); 
```

看起来带有嵌套 RelativeLayout 的原始布局阻止了文本滚动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T04:29:56.897

单独的类文件：

```
public class TextScrolling extends TextView {

    public TextScrolling(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public TextScrolling(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public TextScrolling(Context context) {
        super(context);
    }
    @Override
    protected void onFocusChanged(boolean focused, int direction, Rect previouslyFocusedRect) {
        if(focused)
            super.onFocusChanged(focused, direction, previouslyFocusedRect);
    }

    @Override
    public void onWindowFocusChanged(boolean focused) {
        if(focused)
            super.onWindowFocusChanged(focused);
    }

    @Override
    public boolean isFocused() {
        return true;
    }

} 
```

在您的 xml 文件中执行以下操作：

```
<yourpakage name.aboveclassname

    android:singleLine="true"
    android:ellipsize="marquee"
    android:marqueeRepeatLimit="marquee_forever"
    android:scrollHorizontally="true"
    android:textStyle="bold|italic"
    android:id="@+id/scrolltext"
    android:padding="5dip" 
    android:textSize="15dp"
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content" /> 
```

当然这会工作..试试看..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-12T07:18:31.413

在代码中设置

```
yourTexView.setMovementMethod(new ScrollingMovementMethod()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T02:37:15.197

设置 focusable(true) 并在代码中调用 requestFocus(); 如果您的布局包含具有可聚焦（true）的其他视图，则应确保您的 textview 已聚焦

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T03:33:24.627

这是我的选框代码：

```
<TextView
        android:id="@+id/scanCode"
        android:layout_width="0dip"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"
        android:layout_weight="1"
        android:ellipsize="marquee"
        android:fadingEdge="horizontal"
        android:lines="1"
        android:marqueeRepeatLimit="marquee_forever"
        android:scrollHorizontally="true"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="#ffffff" /> 
```

同样在代码中设置：

```
 scanCode.setEnabled(true);
    scanCode.setSelected(true); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-08T09:14:21.237

在 settext 之后尝试 setSelected(true)

# r - Fast grouping by list column subsets in data.table

> ID：13983874
> 
> 赞同：7
> 
> 时间：2012-12-21T03:24:35.653
> 
> 标签：r, grouping, data.table, aggregation

I am working with a large (millions of rows) data table with a list column containing deeply nested lists, which do not have uniform structure, size or order of elements (`list(x=1,y=2)` and `list(y=2,x=1)` may both be present and should be treated as identical). I need to repeatedly perform arbitrary groupings that include some columns from the data table as well as a subset of the data in the list column. Not all rows have values that will match the subset.

The approach I've come up with feels overly complicated. Here are the key points:

*   **Identifying values in a nested list structure.** My approach is to use `ul <- unlist(list_col)`, which "flattens" nested data structures and builds hierarchical names for direct access to each element, e.g., `address.country.code`.

*   **Ensuring that permutations of the same unlisted data are considered equal from a grouping standpoint.** My approach is to order the unlisted vectors by the names of their values via `ul[order(names(ul))]` and assign the result as a new character vector column by reference.

*   **Performing grouping on subsets of the flattened values.** I was not able to get `by=` to work in any way with a column whose values are lists or vectors. Therefore, I had to find a way to map unique character vectors to simple values. I did this with `digest`.

Here are the two workhorse functions:

```
# Flatten list column in a data.table
flatten_list_col <- function(dt, col_name, flattened_col_name='props') {

  flatten_props <- function(d) {
    if (length(d) > 0) {
      ul <- unlist(d)
      names <- names(ul)
      if (length(names) > 0) {
        ul[order(names)]          
      } else {
        NA
      }
    } else {
      NA
    }
  }

  flattened <- lapply(dt[[col_name]], flatten_props)
  dt[, as.character(flattened_col_name) := list(flattened), with=F]
}

# Group by properties in a flattened list column
group_props <- function(prop_group, prop_col_name='props') {
  substitute({
    l <- lapply(eval(as.name(prop_col_name)), function(x) x[names(x) %in% prop_group])
    as.character(lapply(l, digest))
  }, list(prop_group=prop_group, prop_col_name=prop_col_name))
} 
```

Here is a reproducible example:

```
library(data.table)

dt <- data.table(
  id=c(1,1,1,2,2,2), 
  count=c(1,1,2,2,3,3), 
  d=list(
    list(x=1, y=2), 
    list(y=2, x=1), 
    list(x=1, y=2, z=3),
    list(y=5, abc=list(a=1, b=2, c=3)),
    NA,
    NULL    
    )
)

flatten_list_col(dt, 'd')
dt[, list(total=sum(count)), by=list(id, eval(group_props(c('x', 'y'))))] 
```

The output is:

```
> flatten_list_col(dt, 'd')
   id count      d   props
1:  1     1 <list>     1,2
2:  1     1 <list>     1,2
3:  1     2 <list>   1,2,3
4:  2     2 <list> 1,2,3,5
5:  2     3     NA      NA
6:  2     3             NA

> dt[, list(total=sum(count)), by=list(id, eval(group_props(c('x', 'y'))))]
   id                      group_props total
1:  1 325c6bbb2c33456d0301cf3909dd1572     4
2:  2 7aa1e567cd0d6920848d331d3e49fb7e     2
3:  2 ee7aa3b9ffe6bffdee83b6ecda90faac     6 
```

This approach works but is pretty inefficient because of the need to flatten & order the lists and because of the need to calculate digests. I'm wondering about the following:

1.  Can this be done without having to create a flattened column by instead retrieving values directly from the list column? This will probably require specifying selected properties as expressions as opposed to simple names.

2.  Is there a way to get around the need for `digest`?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T03:56:17.773

这里有很多问题。最重要的（也是由于其他原因您还没有找到）是您通过引用分配但尝试用比您通过引用执行的空间更多的值替换。

举这个非常简单的例子

```
DT <- data.table(x=1, y = list(1:5))
DT[,new := unlist(y)]
Warning message:
In `[.data.table`(DT, , `:=`(new, unlist(y))) :
  Supplied 5 items to be assigned to 1 items of column 'new' (4 unused) 
```

您将丢失`nrow(DT)`新创建列表中除第一个项目之外的所有项目。它们不会对应于 data.table 的行

因此，您必须创建一个`data.table`足够大的新变量来*分解*这些列表变量。这不可能通过参考来实现。

```
 newby <- dt[,list(x, props = as.character(unlist(data))), by = list(newby = seq_len(nrow(dt)))][,newby:=NULL]
newby

   x props
 1: 1     1
 2: 1     2
 3: 1     2
 4: 1     1
 5: 1    10
 6: 2     1
 7: 2     2
 8: 2     3
 9: 2     5
10: 2     1
11: 2     2
12: 2     3
13: 3    NA
14: 3    NA 
```

请注意，需要 as.character 以确保所有值都是相同的类型，并且是在转换中不会丢失数据的类型。目前，您`NA`在数字/整数数据列表中拥有一个逻辑值。

* * *

另一个编辑强制所有组件为字符（甚至是 NA）。props 现在是一个列表，每行有 1 个字符向量。

flatten_props <- function(data) { if (is.list(data)){ ul <- unlist(data) if (length(ul) > 1) { ul <- ul[order(names(ul))] } as .character(ul) } else { as.character(unlist(data))}}

```
dt[, props := lapply(data, flatten_props)]
dt
   x   data   props
1: 1 <list>     1,2
2: 1 <list>  10,1,2
3: 2 <list>   1,2,3
4: 2 <list> 1,2,3,5
5: 3     NA      NA
6: 3   

dt[,lapply(props,class)]
          V1        V2        V3        V4        V5        V6
1: character character character character character character 
```

# arrays - 列表理解的方法，以设定的间隔加入具有不同字符串的列表。（语言不可知论者）

> ID：13983875
> 
> 赞同：2
> 
> 时间：2012-12-21T03:24:46.137
> 
> 标签：arrays, list, language-agnostic, map, list-comprehension

我对不同语言可以加入数组的可能方式感兴趣，而不是使用单个连接字符串，而是在给定的时间间隔使用不同的连接字符串。

例如（假设语言）：

```
Array.modJoin([mod, char], ...)
e.g. [1,2,3,4,5].modJoin( [1, ","], [2, ":"] ) 
```

在参数指定包含模数和连接字符的数组或对象的情况下，实现将检查哪个模数顺序优先（最新的），并应用连接字符。（要求 [mod,char] 以 mod 升序提供）

IE

```
if (index % (nth mod) == 0) 
  append (join char) 
  continue to next index 
else 
  (nth mod)-- repeat

when complete join with "" 
```

例如，我在 Ruby 中提出了以下内容，但我怀疑存在更好/更优雅的方法，这就是我希望看到的。

```
#Create test Array 
#9472 - 9727 as HTML Entities (unicode box chars)
range       = (9472..9727).to_a.map{|u| "&##{u};" } 
```

假设我们有一个模组和连接字符列表，我们必须规定模组的价值随着列表的进展而增加。

```
mod_joins   = [{m:1, c:",", m:12, c:"<br/>"] 
```

现在处理`range`with`mod_joins`

```
processed = range.each_with_index.map { |e, i| 
  m = nil
  mods.reverse_each {|j|
    m = j and break if i % j[:m] == 0
  }
  # use the lowest mod for index 0
  m = mods[0] if i == 0 
  m = nil ? e : "#{e}#{m[:c]}"
}

#output the result string
puts processed.join "" 
```

从这里我们有一个 htmlEntities 列表，用分隔，`,`除非它的索引是第 12 模，在这种情况下它是`<br/>`

因此，我对可以更优雅地完成此操作的方法很感兴趣，主要是在 Haskell、F#、Common Lisp（Scheme、Clojure）等函数式语言中，但在具有列表理解扩展等的通用语言中也有很酷的方法来实现这一点作为 C# 与 Linq、Ruby 和 Python 甚至 Perl。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T05:24:38.857

这是 Ruby 中一个更简单、更易读的解决方案

```
array = (9472..9727).map{|u|"&##{u};"}
array.each_slice(12).collect{|each|each.join(",")}.join("<br/>") 
```

或对于一般情况

```
module Enumerable   
  def fancy_join(instructions)
    return self.join if instructions.empty?
    separator = instructions.delete(mod = instructions.keys.max)
    self.each_slice(mod).collect{|each|each.fancy_join(instructions.dup)}.join(separator)
  end
end

range = (9472..9727).map{|u|"&##{u};"}
instructions = {1=>",",12=>"<br/>"}

puts array.fancy_join(instructions) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T03:53:09.860

这是一个用 Python 编写的纯功能版本。我相信它可以很容易地适应其他语言。

```
import itertools

def calcsep(num, sepspecs):
  '''
    num: current character position
    sepspecs: dict containing modulus:separator entries
  '''
  mods = reversed(sorted(sepspecs))
  return sepspecs[next(x for x in mods if num % x == 0)]

vector = [str(x) for x in range(12)]

result = [y for ix, el in enumerate(vector)
            for y in (calcsep(ix, {1:'.', 3:',', 5:';'}), el)]

print ''.join(itertools.islice(result, 1, None)) 
```

# python - 将异构时间序列添加到 DataFrame

> ID：13983876
> 
> 赞同：6
> 
> 时间：2012-12-21T03:24:49.600
> 
> 标签：python, dataframe, pandas, time-series

## 目标

我有一些 CSV 格式的多种产品的金融交易数据，我想使用 pandas 进行分析。交易以不规则的时间间隔发生，并且时间戳精确到 1 秒，这导致某些交易“同时”发生，即具有相同的时间戳。

目前的目标是绘制每种产品的累积交易量图。

## 现在的进展

已使用 read_csv() 将交易数据读入 DataFrame，即解析日期时间的索引。

```
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 447 entries, 2012-12-07 17:16:46 to 2012-12-10 16:28:29
Data columns:
Account Name    447  non-null values
Exchange        447  non-null values
Instrument      447  non-null values
Fill ID         447  non-null values
Side            447  non-null values
Quantity        447  non-null values
Price           447  non-null values
dtypes: float64(1), int64(1), object(5) 
```

完成了一些工作来添加“QuantitySigned”列。

我做了一个“groupby”，这样我就可以通过仪器访问数据。

```
grouped = trades.groupby('Instrument', sort=True)
for name, group in grouped:
        group.QuantitySigned.cumsum().plot(label=name)
plt.legend() 
```

## 问题

以上工作，但我想在一个DataFrame中拥有TimeSeries（每个仪器一个），即每个仪器一列，以便我可以使用DataFrame.plot（）。问题是没有两个 TimeSeries 具有完全相同的索引，即我需要合并所有 TimeSeries 的索引。

鉴于下面的简单示例，我知道这应该可行：

```
index=pd.date_range('2012-12-21', periods=5)
s1 = Series(randn(3), index=index[:3])
s2 = Series(randn(3), index=index[2:])
df = DataFrame(index=index)
df['s1'] = s1
df['s2'] = s2 
```

但是，尝试将 TimeSeries 聚合到 DataFrame 时会引发异常，我认为这与重复的索引元素有关：

```
grouped = trades.groupby('Instrument', sort=True)
df = DataFrame(index=trades.index)
for name, group in grouped:
        df[name] = group.QuantitySigned.cumsum()
df.plot()

Exception: Reindexing only valid with uniquely valued Index objects 
```

*我会“正确地”解决这个问题吗？关于如何以更好的方式解决这个问题有什么建议吗？*

## 可运行示例

这是一个引发异常的**可运行示例**：

```
import pandas as pd
from pandas import Series
from pandas import DataFrame

index = pd.tseries.index.DatetimeIndex(['2012-12-22', '2012-12-23', '2012-12-23'])

s1 = Series(randn(2), index[:2]) # No duplicate index elements
df1 = DataFrame(s1, index=index) # This works

s2 = Series(randn(2), index[-2:]) # Duplicate index elements
df2 = DataFrame(s2, index=index) # This throws 
```

## 解决方案

感谢@crewbum 的解决方案。

```
grouped = trades.groupby('Instrument', sort=True)
dflist = list()
for name, group in grouped:
    dflist.append(DataFrame({name : group.QuantitySigned.cumsum()}))
results = pd.concat(dflist)
results = results.sort().ffill().fillna(0)
results.plot() 
```

注意：我先转发填充，然后将剩余的 NaN 设置为零。正如@crewbum 指出的那样，ffill() 和 bfill() 是 0.10.0 的新功能。

我在用着：

*   熊猫 0.10.0
*   numpy 1.6.1
*   蟒蛇 2.7.3。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T04:56:45.820

pd.concat() 默认情况下对索引执行“外部”连接，并且可以通过及时向前和/或向后填充来填充空洞。

```
In [17]: pd.concat([DataFrame({'s1': s1}), DataFrame({'s2': s2})]).ffill().bfill()
Out[17]: 
                 s1   s2
2012-12-21  9.0e-01 -0.3
2012-12-22  5.0e-03 -0.3
2012-12-23 -2.9e-01 -0.3
2012-12-23 -2.9e-01 -0.3
2012-12-24 -2.9e-01 -1.8
2012-12-25 -2.9e-01 -1.4 
```

我应该补充一下，`ffill()`并且`bfill()`是 pandas 0.10.0 中的新内容。在此之前，您可以使用`fillna(method='ffill')`和`fillna(method='bfill')`。

# javascript - 在html文件中添加脚本标签

> ID：13983886
> 
> 赞同：4
> 
> 时间：2012-12-21T03:25:59.983
> 
> 标签：javascript, jquery, html

我尝试在使用 javascript 和 html 编程时是否可以尊重“关注点分离”。在许多情况下，我必须在页面加载后执行一些代码，我使用 jQuery 的文档就绪功能来执行此操作。我更喜欢将我的 javascript 代码放在一个单独的文件中。问题是我有一个用于几个 html 文件的脚本文件，并且不应在所有这些页面中执行文档准备功能。出于这个原因，我将脚本标签直接放在我的 html 中，并将文档准备功能放在这个标签中，但其余的 javascript 代码在我的 javascript 文件中。

将文档准备功能放在html中以促进在不同上下文中重用脚本文件是一种好习惯还是有什么好的做法来解决这个问题？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T03:31:34.737

在您的 HTML 中放置如下内容：

```
 <script type="text/javascript" src="common_stuff.js"></script>
   <script type="text/javascript" src="stuff_for_this_page.js"></script> 
```

然后使用 Apache [mod_deflate](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)模块将输出发送到客户端。

这将具有在开发中将 Javascript 与 HTML 分离的优点，但不需要客户端等待`ready`单独加载 JQuery 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:45:59.123

您应该查看[Angularjs](http://angularjs.org/)或[主干](http://backbonejs.org/).js 。这两个都可以用来为你的 javascripts 实现结构和设计。

# jquery - 在 click() 取消函数后，里面有 popstate

> ID：13983892
> 
> 赞同：0
> 
> 时间：2012-12-21T03:27:28.603
> 
> 标签：jquery, browser-history

如何`back_a`在删除后使用 popstate制作第一个函数`click`，然后我可以运行 antoner？

```
function back_a(){
    $(window).bind('popstate', function(e){
        //do some thing
    });
}
back_a();

function back_b(){
    $(window).bind('popstate', function(e){
        //do different thing
    });
}

$('btn').click(funcion(){
    // how to cancel back_a();
    //run back_b();
    back_b();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:32:01.007

jquery 中的事件可以命名空间：

```
$(selector).on("click.myclick", function(){...}); 
```

您可以稍后通过执行以下操作仅删除该特定事件：

```
$(selector).off("click.myclick"); 
```

**编辑**

尝试这样的事情：

```
$(window).on("popstate.fubar", function(e){
    // do some stuff here
});

$('btn').click(funcion(){
    $(window).off("popstate.fubar");
    $(window).on("popstate.fubar", function(e) {
        // do some different stuff here
    });
});​ 
```

# css - 当 $(this) 高度增加时，兄弟姐妹浮动到底部

> ID：13983898
> 
> 赞同：0
> 
> 时间：2012-12-21T03:28:49.110
> 
> 标签：css

```
<div class="wrapper">

    <div class="inlined">
        <div>first-child</div>
        <div>last-child</div> 
    </div>        

    <div class="inlined">
        <div>first-child-1</div>
        <div>last-child-1</div> 
    </div>        

</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

`.inlined div:last-child`是隐藏的，当它显示时，它的父级会`div .inlined`增加高度。然后它`div .inlined`旁边的移动到包装器的底部。

我希望它坚持到顶部。

我有很多`div .inlined`元素，连续 2 个

[http://jsfiddle.net/C3v2k/](http://jsfiddle.net/C3v2k/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:33:50.013

添加垂直对齐到`.inlined`

```
.inlined
{
    vertical-align:top;    
} 
```

[http://jsfiddle.net/mowglisanu/C3v2k/1/](http://jsfiddle.net/mowglisanu/C3v2k/1/)

# jquery - 更改jQuery选项卡上的类旋转更改？

> ID：13983900
> 
> 赞同：0
> 
> 时间：2012-12-21T03:29:27.777
> 
> 标签：jquery, html, jquery-ui-tabs

我正在使用 jQuery 和 JQUI 在我的网站上做一个“特色滑块”：http: [//calibur.8wayrun.com/](http://calibur.8wayrun.com/)

它使用如下代码（我已经编辑了所有非必要的信息，因为它只是在这里作为我正在做的事情的快速总结）。

```
<script type="text/javascript">
jQuery(document).ready(function() {
    $("#recentSlider2").tabs({
        fx:{opacity: "toggle"}
    }).tabs("rotate", 5000, true);
});
</script>

<div id="recentSlider2">
    <div class="recentSlider2 rightSlider">
        <div id="fragment-1"></div>
        <div id="fragment-2"></div>
        <div id="fragment-3"></div>
            etc...
        <ul>
            <li id="nav-fragment-1"></li>
            <li id="nav-fragment-2"></li>
            <li id="nav-fragment-3"></li>
                etc...
        </ul>
    </div>
</div> 
```

简单吧？好吧，如果您注意到，父 div 类是“recentSlider2 rightSlider”。在每次选项卡更改时，我希望滑块将“rightSlider”替换为“leftSlider”，并将“leftSlider”替换为“rightSlider”。这只是为了模拟每次幻灯片更改时从左到右的反弹。

这样的事情可能吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T04:02:36.417

您应该能够绑定到`tabsselect`事件：

```
$("#recentSlider2").bind('tabsselect', function(event, ui) {
      $(ui.tab).closest(".recentSlider2")
          .toggleClass("rightSlider")
          .toggleClass("leftSlider");
  }); 
```

# ruby-on-rails-3.2 - 在 Rails 3 中使用带有自引用关联的 jQuery Tokeninput

> ID：13983904
> 
> 赞同：1
> 
> 时间：2012-12-21T03:30:13.227
> 
> 标签：ruby-on-rails-3.2, jquery-tokeninput

[在Ryan Bates 的 Railscast](http://railscasts.com/episodes/258-token-fields-revised?view=asciicast)的帮助下，我正在尝试使用 Tokeninput 设置一个搜索即输入的表单。不幸的是，我无法通过自引用关联来解决这个问题。

在我的模型中：

```
class Skill < ActiveRecord::Base
  attr_accessible :skill_relationship_attributes, :prereq_tokens
  attr_reader :prereq_tokens

  has_many :skill_relationships
  has_many :prereqs, :through => :skill_relationships
  has_many :inverse_skill_relationships, :class_name => 'SkillRelationship', :foreign_key => "prereq_id"
  has_many :inverse_prereqs, :through => :inverse_skill_relationships, :source => :skill

  accepts_nested_attributes_for :skill_relationships, :allow_destroy => true

  def prereq_tokens=(ids)
    self.prereq_ids = ids.split(",")
  end
end

class SkillRelationship < ActiveRecord::Base
  attr_accessible :skill_id, :prereq_id, :skill_attributes, :prereq_attributes

  belongs_to :skill
  belongs_to :prereq, :class_name => 'Skill'
end 
```

我无力地整理了一个表格：

```
<%= form_for skill do |f| %> 
  <%= f.label :prereq_tokens, "Prerequisites" %><br/>
  <%= f.text_field :prereq_tokens, data: {load: Skill.all} %>       
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

我确实得到了一个样式精美的文本字段，但它在搜索时找不到任何东西，而且我不确定从这里去哪里。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T20:48:24.027

我想出了这个！首先，我从表单中删除了“data: {load: Skill.all}”，因为我希望它通过thinking_sphinx 而不是我的整个数据库工作。*然后*- 这是关键 - 我在我的咖啡脚本中指定了**propertyToSearch**和**queryParam**：

```
jQuery ->
  $('#skill_prereq_tokens').tokenInput '/skills.json'
    theme: 'facebook'
    propertyToSearch: 'title' // :title is the attribute in my Skill model that I want to show up in the list
    queryParam: 'search' // :search is the parameter that gets passed to thinking_sphinx 
```

瞧！事实证明，这更像是一个thinking_sphinx 问题，而不是与我的自我参照关联有关。

需要注意的是，使用 propertyToSearch 指定 title 属性仅确定哪个属性可以代表每个技能，**并且不会**阻止 thinking_sphinx 使用其索引中的其他属性。

但它的工作方式与 Facebook 输入字段不完全一样，因为 thinking_sphinx 默认只进行全词搜索。换句话说，如果我在寻找一种叫做“拳击”的技能，然后输入“box”甚至“boxin”，我什么也得不到。只有当我最终输入完整的拳击“拳击”字样时，该技能才会在列表中返回。可以将 thinking_sphinx 配置为索引前缀，这样它就会返回部分单词的结果，就像 Facebook 所做的那样 - 但如果你正在索引一个大型数据库，你可能不想这样做，因为你的索引会爆炸快疯了。这可能是 Facebook 将每个人的好友上限限制在 5000 个的重要原因，除了没有人拥有 5000 个好友这一事实。

# vb.net - 'Rock, Paper, scissor' 逻辑在 vb.net 中使用循环或 If 语句获得结果 'Win, Lose, Draw'

> ID：13983907
> 
> 赞同：0
> 
> 时间：2012-12-21T03:30:39.213
> 
> 标签：vb.net, algorithm, oop, loops, logic

我现在头晕目眩，可能是因为我错过了一些基本逻辑。

我在 VB.NET 中有一个“Rock, Paper, scissor”程序，它为每个单独的游戏/回合提供了正确的结果。我遇到的问题是在尝试确定 MATCH 的结果时，该结果也可以是“Win，Loose，Draw”。比赛是 3 胜制（先到 2）和 5 胜制（先到 3）。由于比赛的结果可能是平局，因此有多种组合/排列方式，例如：

1.  W、L、D
2.  左、宽、深
3.  左、右、右
4.  D、L、W
5.  W，D，L，......等等......

到目前为止，我有以下代码：

```
 Public Class GameForm
    Private humanScore As Integer = 0
    Private compScore As Integer = 0
    Private drawScore As Integer = 0
    Private totalGames As Integer = 0
    Private totalGamesForWin As Integer = 0
    Private totalGamesPlayed As Integer = 0
    Private player1 = New PlayerHumanPlayer()
    Private player2 = New PlayerComputerRandom()

    Private Sub GameForm_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        If GameTypeForm.cmboMatchDuration.SelectedItem = 0 Then
            totalGames = 3
            totalGamesForWin = 2
            lblMatchInfor.Text = GlobalVariables.MatchTypeBestOf3Message
        ElseIf (GameTypeForm.cmboMatchDuration.SelectedItem = 1) Then
            totalGames = 5
            totalGamesForWin = 3
            lblMatchInfor.Text = GlobalVariables.MatchTypeBestOf5Message
        End If

    End Sub

    Private Sub btnRock_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnRock.Click
        findGameWinner("HumanPlayer", "Rock", "RandomComputer")
    End Sub

    Private Sub btnPaper_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPaper.Click
        findGameWinner("HumanPlayer", "Paper", "RandomComputer")
    End Sub

    Private Sub btnScissors_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnScissors.Click
        findGameWinner("HumanPlayer", "Scissors", "RandomComputer")
    End Sub

    Public Sub findGameWinner(ByVal p1name As String, ByVal p1WeaponSelected As String, ByVal p2Name As String)

        player1.Name = p1name
        player1.pickWeapon(p1WeaponSelected)  ' Should I be using the Rock Class???

        player2.Name = p2Name
        player2.pickWeapon()

        Dim winner As Integer = player1.getWeapon().compareTo(player2.getWeapon())

        Select Case winner
            Case 1
                updateScores(True, False)
                findMatchWinner()
            Case -1
                updateScores(False, True)
                findMatchWinner()
            Case 0
                updateScores(False, False)
                findMatchWinner()
        End Select
    End Sub

    Public Function updateScores(ByVal humanWon As Boolean, ByVal compWon As Boolean) As Integer

        If humanWon = True Then
            humanScore = humanScore + 1

            'Update Human labels
            lblPlayerScore.Text = humanScore.ToString()
            'txtCompChoice.Text = txtCompChoice.Text + Environment.NewLine + Type.GetType(player2.pWeapon.ToString()).ToString()
            txtCompChoice.Text = txtCompChoice.Text + Environment.NewLine + player2.pWeapon.ToString()
            txtGameStatus.Text = txtGameStatus.Text + Environment.NewLine + player1.Name() + " wins!"

        ElseIf compWon = True Then
            compScore = compScore + 1

            'Update Computer labels
            lblCompScore.Text = compScore.ToString()
            'txtCompChoice.Text = txtCompChoice.Text + Environment.NewLine + Type.GetType(player2.pWeapon.ToString()).ToString() 
            txtCompChoice.Text = txtCompChoice.Text + Environment.NewLine + player2.pWeapon.ToString()
            txtGameStatus.Text = txtGameStatus.Text + Environment.NewLine + player2.Name() + " wins!"

        Else
            drawScore = drawScore + 1

            'Update Draw labels
            lblDrawGame.Text = drawScore.ToString()
            'txtCompChoice.Text = txtCompChoice.Text + Environment.NewLine + Type.GetType(player2.pWeapon.ToString()).ToString()
            txtCompChoice.Text = txtCompChoice.Text + Environment.NewLine + player2.pWeapon.ToString()
            txtGameStatus.Text = txtGameStatus.Text + Environment.NewLine + "Draw!"

        End If

        totalGamesPlayed = totalGamesPlayed + 1

        Return totalGamesPlayed
    End Function

    Public Function findMatchWinner() As String

        If totalGamesPlayed <> totalGames Then
            If humanScore = totalGamesForWin Then
                lblMatchInfor.Text = GlobalVariables.HumanMacthWinMessage
                clearForm()
            ElseIf compScore = totalGamesForWin Then
                lblMatchInfor.Text = GlobalVariables.CompMacthWinMessage
                clearForm()
            ElseIf totalGamesPlayed = totalGames - 1 Then
                lblMatchInfor.Text = GlobalVariables.DeciderGameMessage
            End If
        ElseIf humanScore = totalGamesForWin Then
            lblMatchInfor.Text = GlobalVariables.HumanMacthWinMessage
            clearForm()
        ElseIf compScore = totalGamesForWin Then
            lblMatchInfor.Text = GlobalVariables.CompMacthWinMessage
            clearForm()
        ElseIf (drawScore = totalGamesPlayed) Then
            lblMatchInfor.Text = GlobalVariables.DrawMacthWinMessage
            clearForm()
        End If

        Return "Human OR Computer"
    End Function

    Public Sub clearForm()

    End Sub

End Class 
```

我以为我做得很好，直到我想起我完全忘记了平局/平局。从那以后我的脑袋一直在循环，所以有人可以解释一下如何让 findMatchWinner() 函数正常工作吗？

任何帮助将不胜感激。

提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:37:31.027

我建议不要检查一个玩家有多少胜利，看看它是否是预期的回合数，你可以只记录两个支付者的胜利并在最后进行比较。

如果玩家 A > 玩家 B 则玩家 A 获胜，如果相同则为平局。另外，请记住，一场 3 轮的游戏不需要 2 次获胜即可获胜，因为玩家 A 可以获胜一次，然后所有其他游戏都可能是平局。

# php - 独立的 TypoScript 解析器库？

> ID：13983911
> 
> 赞同：0
> 
> 时间：2012-12-21T03:31:57.690
> 
> 标签：php, typo3, typoscript

我想在我的实际 Web 应用程序中集成 TypoScript 之类的东西（它不是基于 Typo3 的）

我想在文件中使用打字稿，然后解析器会返回给我一个配置数组

有可能还是 PHP 有类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T02:09:18.913

检查`TYPO3\CMS\Core\TypoScript\TemplateService`，但我担心单独使用它会相当困难。

您将在 找到课程`typo3/sysext/core/Classes/TypoScript/TemplateService.php`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T13:11:41.647

看看**t3lib/class.t3lib_tsparser.php**类。也许您将能够根据您的项目对其进行调整。特别是它`parse()`和`parseSub()`方法应该是你感兴趣的。

# c - 使用多线程的消息队列

> ID：13983913
> 
> 赞同：2
> 
> 时间：2012-12-21T03:32:01.600
> 
> 标签：c, multithreading, message-queue

```
gcc 4.7.2
c89
APR 1.4 
```

你好，

我正在使用 APR 线程池、事件循环（轮询）和消息队列（msgget、msgsnd、msgrcv）。

目前，我只是在测试是否按 ctrl-c。它会将while设置为false。所以消息将在我的信号处理程序中发送，以便在我的 while 循环中接收。

但是， msgrcv 似乎阻塞在我的事件循环中。所以我无法从我的图书馆获得任何其他活动。在我的事件循环中，我正在检查是否收到了一条消息。但是，我认为它会阻止等待消息。这将导致我的循环停止循环，我将无法从我的库中捕获任何事件。

这是我第一次使用消息队列。

这是我的代码，我只复制了相关部分，所以我删除了所有错误检查以保持简短。

目前我只是在测试我的事件循环是否可以从队列中接收消息，因此它可以停止循环。

非常感谢您的任何建议，

```
#define MSG_KEY 0001L
static int msg_id = 0;
static volatile apr_status_t is_looping = FALSE;

/* Wait for these message commands */
typedef enum tag_msg_cmd {END_LOOP, START_LOOP} msg_cmd_e;

/* message queue data */
typedef struct tag_msg_data msg_data_t;
struct tag_msg_data {
    long mtype;
    msg_cmd_e msg_cmd;
};

int main(void)
{
    /* Create message queue */
    msg_id = msgget(MSG_KEY, 0666 | IPC_CREAT);

    /* Create thread pool */
    has_error = apr_thread_pool_create(&thd_pool,
                                       init_threads,
                                       max_threads,
                                       mem_pool_app);

   /* Start event loop */
   LOG_CHECK(apr_thread_pool_schedule(thd_pool,
                                       (apr_thread_start_t)event_loop,
                                       NULL,
                                       0,
                                       NULL) == APR_SUCCESS, "Failed to schedule event loop");

    /* Pause until ctrl-c */
    pause();

    /* Destroy all memory pools and threading pools */
}

/* Poll for incoming events */
static apr_status_t event_loop(void)
{
    msg_data_t msg_data;
    int evt_id = 0;
    int msg_id = 0;

    /* Connect to the message queue */
    msg_id = msgget(MSG_KEY, 0644);
    assert(msg_id != -1 && "Failed to connect to the message queue");
    LOG_DEBUG("Connected to message queue with msg ID [ %d ]", msg_id);

    while(is_looping) {
        /* Under development - Process incoming event from shared library */
        /* evt_id = sr_waitevt(timeout_ms); */
        /* process_event(evt_id); */

        LOG_DEBUG("Looping....");

        /* Should not be blocking here, as I need to receive other events */
        msgrcv(msg_id, &msg_data, (sizeof msg_data) - (sizeof(long)), 2, 0);
        LOG_DEBUG("Waiting...");
        if(msg_data.msg_cmd == END_LOOP) {
            LOG_DEBUG("END_LOOP event queue message has been received");
            break;
        }
        sleep(1);
    }

    return 1;
}

/* Signal handler will terminated application on ctrl-c */
static void signal_handler(int sig)
{
    msg_data_t msg_data = {2,  END_LOOP};
    int rc = 0;

    rc = msgsnd(msg_id,
                &msg_data,
                (sizeof msg_data) - (sizeof(long)),
                IPC_NOWAIT);

    assert(rc == 0 && "Failed to send data to the message queue");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T04:04:29.837

将标志参数 on `msgrcv`（第 5 个参数）设置为 IPC_NOWAIT。这使得~~队列~~接收非阻塞。

# javascript - Jquery - 使用嵌套函数和 setInterval() 循环

> ID：13983914
> 
> 赞同：0
> 
> 时间：2012-12-21T03:32:46.363
> 
> 标签：javascript, jquery

可能不是最清晰的标题，但这里是 - 我需要在页面上显示两个独立的倒计时，接受用户输入的每个起始值。当一个到达零时，另一个启动并倒计时到零。代码如下，并按预期工作。

我调用 Timer1 函数，它检查变量的起始值，如果存在，则开始计数。当计数为零时，我清除间隔，将显示重置为起始值，并触发第二个计时器，如果它分配了一个值：

```
 function Timer1() {
        var gDuration = goTime;
        countdown = setInterval(function () {
            if (gDuration >= 0) {
                $("#durationValue").html(ToTime(gDuration));
                gDuration--;
            }
            else {
                clearInterval(countdown);
                $("#durationValue").html(ToTime(goTime));
                if (restTime != 0) {
                    Timer2();
                }
            }
        }, 1000);
    }

    function Timer2() {
        var rDuration = restTime;
        countdown = setInterval(function () {
            if (rDuration >= 0) {
                $("#restValue").html(ToTime(rDuration));
                rDuration--;
            }
            else {
                clearInterval(countdown);
                $("#restValue").html(ToTime(restTime));
            }
        }, 1000);
    } 
```

下一步是允许该进程运行一定数量的循环 - 我尝试将 Timer1 中的 setInterval 包装在一个 for 循环中，但这是行不通的。任何想法如何更好地解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:38:35.070

`for`-loops 不适用于异步的东西。正如您已经演示过的那样，只需将其设为具有结束条件的计数器`g/rDuration`即可。

带有一些回调抽象和大量的延续传递风格：

```
function timer(el, duration, interval, callback) {
    var countdown = setInterval(function() {
        if (duration-- >= 0) {
            el.text(ToTime(duration));
        } else {
            clearInterval(countdown);
            callback();
        }
    }, interval);
}

var goTime = …, restTime = …;
function t1(cb) {
    timer($("#durationValue"), goTime, 1000, cb);
}
function t2(cb) {
    timer($("#restValue"), restTimer, 1000, cb);
}
var loops = …;
(function loop(cb) {
    t1(function(){
        t2(function() {
            if (loop-- >= 0)
                loop(cb);
            else
                cb();
        });
    });
})(function() {
    alert("finished!");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:37:03.387

我能想到的最简单的事情是让你的 Timer 函数在当前迭代中有一个参数。每当一个计时器开始另一时间时，增加该值。并使用该值来确定它是否确实应该启动下一个计时器。

# ruby-on-rails - Ruby Gem 指向本地 gem 时有效，但未发布一次

> ID：13983920
> 
> 赞同：1
> 
> 时间：2012-12-21T03:33:37.643
> 
> 标签：ruby-on-rails, ruby, gem, asset-pipeline

情况如下：

我决定开始在 gem 中移动我在每个项目中重用的所有 js 代码，并在以下位置创建 gem：

```
/Users/alain/Dropbox/rails_app/alain_toolbox 
```

所以在我的项目中，为了测试一切是否正常，我将这一行添加到 gem 文件中：

```
gem 'alain_toolbox', '=0.0.1', path:'/Users/alain/Dropbox/rails_app/alain_toolbox 
```

一切正常。

然后，我做一个

```
gem build alain_toolbox.gemspec 
gem push alain_toolbox-0.0.1.gem 
```

一切似乎都有效。所以我将gemfile中的gem require 替换为：

```
gem 'alain_toolbox' 
```

然后做一个捆绑包并成功安装gem。问题是当我打开应用程序时，我收到一个错误，它无法在该行中找到“alain_toolbox”

```
<%= javascript_include_tag "application" %> 
```

和 application.js 看起来像这样：

```
//= require alain_toolbox 
```

当我在当地时，它正在工作。

所以问题是：为什么？（！）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T02:33:43.483

发现错误：我不知道怎么做，但我忘了对资产文件执行“git add”。添加文件并重建 gem 后，一切都按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T04:38:55.197

[Rails 指南](http://guides.rubyonrails.org/asset_pipeline.html#adding-assets-to-your-gems)表明gem 需要实现一个 rails 引擎。此外，资产仍需要位于 gem 中的指定目录之一（app/assets、lib/assets 或 vendor/assets）。我假设在本地情况下，您的宝石已经在该路径中。

根据[这个 AsciiCast](http://asciicasts.com/episodes/279-understanding-the-asset-pipeline)，您可以通过打印 Rails.application.config.assets.paths 配置在 rails 控制台中查看资产管道路径

相关问题：[在资产管道路径中获取 Gem 供应商文件](https://stackoverflow.com/questions/7531563/get-gem-vendor-files-in-asset-pipeline-path)

# google-apps-script - UrlFetchApp muteHttpException 不起作用

> ID：13983925
> 
> 赞同：5
> 
> 时间：2012-12-21T03:34:53.477
> 
> 标签：google-apps-script

如何处理 urlfetch 错误？我正在尝试`muteHttpExceptions: true`，但它不起作用并且脚本中断。

```
function myFunction() {
  var result = UrlFetchApp.fetch("http://www.soccer-wallpapers.net/soccer_wallpaper/barcelona_fc_barcelona_360.jpg ", {
muteHttpExceptions: true });
  Logger.log("code: " + result.getResponseCode());
  Logger.log("text: " + result.getContentText());
} 
```

但我正在尝试另一个错误网址来正常工作。

```
http://img8.uploadhouse.com/fileuploads/2058/20586362b34151eb10a4001e1c44305fe41bff6.jpg 
```

使用 try 和 catch 方法解决句柄。

```
 try
  {
    var page = UrlFetchApp.fetch("http://www.soccer-wallpapers.net/soccer_wallpaper/barcelona_fc_barcelona_360.jpg");
  }
  catch(err)
  {
    Browser.msgBox("error");
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T13:29:45.783

这似乎按设计工作。这`muteHttpExeptions`是为了做到这一点。如果脚本收到 HTTP 错误状态，它会告诉脚本正常运行。在您的第一个示例代码中，该错误不是 HTTP 错误。没有 Web 服务器可以返回任何类型的 HTTP 代码。网址不存在。连接到 Internet 的服务无法继续，并且没有 HTTP 异常。

当我访问[http://www.soccer-wallpapers.net/soccer_wallpaper/barcelona_fc_barcelona_360.jpg](http://www.soccer-wallpapers.net/soccer_wallpaper/barcelona_fc_barcelona_360.jpg)时，我收到一条超时消息。没有什么可以回应我的请求。看来 football-wallpapers.net 不再响应请求。它确实有一个 DNS 条目，但不响应来自我位置的 ping。

如果您必须处理错误的 URL、可能关闭服务器和其他服务器错误，那么您将需要使用`try{}catch(){}`块。你如何处理这些错误取决于你。该`muteHttpExceptions`标志更多地用于将 HTTP 错误作为应用程序的一部分进行处理，而不是在脚本级别引发错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-12T18:27:02.267

That's still remains an issue in functions that are called in cells where the try-catch in this case is just ignored

# plot - 为 CPU 提供更多功能以在 Octave 中绘图

> ID：13983928
> 
> 赞同：2
> 
> 时间：2012-12-21T03:35:45.350
> 
> 标签：plot, cpu, gnuplot, octave, time-complexity

我在 Octave 中制作了这个函数来绘制分形图。现在，绘制我计算的所有点需要很长时间。我已经使我的函数尽可能高效，我认为我可以让它更快地绘制的唯一方法是让我的 CPU 完全专注于函数或以某种方式告诉它应该专注于我的情节。

有没有办法我可以做到这一点，或者这真的是极限吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T04:02:04.933

要确定你的绘图消耗了多少 CPU，运行你的绘图，然后在一个单独的窗口中（假设你在 Linux/Unix 上），运行`top`命令。（对于 Windows，启动任务主控并切换到“进程”选项卡，单击 CPU 标题以按 CPU 排序）。

（您问题标签上的 Octave 翻转描述说 Octave 是一种脚本语言。我希望它会调用`gnuplot`来创建绘图。将其视为最高的 CPU 消耗者）。

您应该看到您的 Octave/gnuplot cmd 位于列表顶部附近，并且`top`有一列标有`%CPU`（或类似）。这将显示该进程消耗了多少 CPU。

我希望看到该进程消耗 95% 或更多的 CPU。如果您看到这个数字明显较低，那么您需要检查下面的进程，它们是否正在消耗剩余的 CPU（某种病毒扫描（在 PC 上），还是数据库或服务器？）？如果一个竞争程序是问题所在，那么您必须决定是否可以等到它/它们完成，或者您可以杀死它们并稍后重新启动。（对于 lunix，请使用`kill -15 pid`或`kill -11 pid`。仅`kill -9 pid`作为最后的手段使用。在此处搜索有关尝试正确顺序的文章`kill -$n`）

如果没有竞争进程并且它`octave/gnuplot`使用的比例低于 95%，那么您将不得不寻找替代工具来查看是什么阻碍了该进程。（这不太可能，您的整个绘图过程的某些部分可能是磁盘 I/O 或网络 I/O 绑定）。

因此，这取决于您当前正在经历的时间尺度与您“想要”经历的时间。

您的系统是否有多个 CPU？然后，您需要研究`octave/gnuplot`文档以查看它是否支持指示“使用 $n 可用 CPU 进行处理”的开关。（或者找到一个支持使用 $n 多个 CPU 的绘图程序）。

实际上，如果您的进程现在需要 10 分钟，并且您可以通过消除竞争进程，从 60% 提高到 90%，即 CPU 增加 50%，但只会将其减少到 5 分钟（不确定，可能更少，数学**不是**我的强项；-))。能够将任务划分为 5-10-?? CPU 将是加快周转时间的最确定途径。

因此，为了更进一步，您需要使用一些数据点来编辑您的问题。你的阴谋需要多长时间？它正在处理的文件有多大。你正在做的绘图有什么特别需要数学的东西吗？预处理的数据文件可以加快计算速度吗？此外，如果`top`不显示 gnuplot 以 99% CPU 运行的结果，则编辑您的帖子以显示`top`有助于我们理解您的问题的输出。（粘贴到您的`top`输出中，用鼠标选择它，然后使用`{}`输入框顶部的格式化工具来保持格式并避免输出在您的帖子中换行）。

IHTH。

PS 请注意您通过滚动分配给问题的每个标签的关注者数量。通过包含您正在使用的操作系统的标签以及与性能测量/测试相关的标签，您可能会在您的问题上获得更有用的“眼睛”（转到标签选项卡并输入各种术语以查看您有多少关注者'重新获得。SO 礼仪的一点是只指定一种编程语言（如果合适的话），这也可能适用于操作系统。）

# android - 将 Flash 代码移植到 iOS 和 Android

> ID：13983929
> 
> 赞同：0
> 
> 时间：2012-12-21T03:35:48.610
> 
> 标签：android, ios, flash, actionscript-2, unity3d

我有带有 AS2 脚本的 flash 代码。这是一款老虎机游戏，我想将其移植到 Android 和 iOS。因为它是一款老虎机游戏，所以 UI 在选择我编码的技术时不会成为优先事项。我可以很好地在 android 中创建单独的 UI和 iOS 并将它们与另一种语言的插件连接起来。但是，我想尽可能多地重复使用 AS2 中的代码，因为大部分代码都包含老虎机和宾果游戏的逻辑。我想知道我该怎么做。我应该选择 unity 3D、Oracle ADF、Corona 还是任何其他有用的 IDE。还是应该将 AS2 脚本转换为 C 代码并将其用作 Android 和 iOS 中的插件？或任何其他选择。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T13:15:24.040

看看可能适合您的[Scaleform Mobile 。](http://gameware.autodesk.com/usage/casual)您可以使用 AS2 代码并将其部署到移动设备。Scaleform 使用自己的运行时，但它与 Flash 工具链集成。我们使用 Unity3D 插件，效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T11:17:49.067

我对 Scaleform for Unity 插件有一些经验，我也认为它是您需要的最佳解决方案（无论是 Scaleform for Unity 插件还是 Scaleform 移动版）。

在 Scaleform 中，您将能够将大部分代码库留在 AS 端。

但是 Scaleform 是具有非友好文档的高级库，因此在您能够开始工作之前，您需要具备一些 С++/C 知识来引导骨架应用程序。

# javascript - jquery ajax 函数在成功时生成动态内容

> ID：13983931
> 
> 赞同：2
> 
> 时间：2012-12-21T03:36:19.640
> 
> 标签：javascript, jquery, html, css, ajax

我有这个`function`迭代一个`array`，我想动态地生成所有 te div，其中`array`应该显示来自的信息......萤火虫检查器显示`divs`在那里，但图像和信息没有显示。我非常感谢你们能给我的任何帮助，这是我的代码

```
 $("#busca").on('click', function(){

        $.ajax({ 
        type    : "POST",
        url     : "service.php",
        dataType: "json",
        data    : {
            action:"fullProjects",
            },          
            success:function(data){

                var i;
                for (i = 0; i < data.data.length; ++i) {

                    console.log(i);

                    var divCreator ='';

                    divCreator+='<div id="grupo'+i+'" class="typeface-js" style="font-family:GreyscaleBasic">';
                    divCreator+='<div class="tipo-pro">';
                    divCreator+='<div id="tipo_'+i+'" class="tipo"></div>';
                    divCreator+='<div id="tipo_arq_abajo'+i+'" class="abajo"></div>';
                    divCreator+='</div>';
                    divCreator+='<div id="fotoproyectos'+i+'" class="foto"></div>';
                    divCreator+='<div id="nombreproyectos'+i+'" class="nombre-pro"></div>';
                    divCreator+='</div>';
                    divCreator+='</div><br><br><br><br><br><br>';

                    $("#contiene-pro").append(divCreator);

                    //$("#fotoproyectos"+i).empty();
                    var htmlThings = '';
                    htmlThings += '<img src="' + data.data[i].path + '" height="128" width="160">';
                    $("#fotoproyectos"+i).append(htmlThings);

                    $("#nombreproyectos"+i).empty();
                    var htmlMoreThings = '';
                    htmlMoreThings += "<form method=\"post\" name=\"projectsearch\" id=\"projectsearch"+ i +"\" action=\"proyectos_arq.php\">" 
                    htmlMoreThings += "<span style=\"cursor: pointer;\" onclick=\"document.getElementById('projectsearch"+ i +"').submit()\">"+ data.data[i].projectName +"</span>"
                    //html2 += "<button id=" + "button" + data.projectId + " style=\"visibility:hidden;\"><span id=" + data.projectId + " style=\"cursor: pointer;\"><span>" + data.projectName + "</span></span></button>"
                    htmlMoreThings += "<input name=\"project_id\" type=\"hidden\" id=\"project_id\" value=" + data.data[i].projectId + ">"  
                    htmlMoreThings += "</form>"
                    $("#nombreproyectos"+i).append(htmlMoreThings);

                };

            }
        })

    }); 
```

`contiene-pro`是其余`div's`所有帮助的主要容器真的很感激......我尝试了一种不同的方法，结果相同

```
$("#busca").on('click', function(){

        $.ajax({ 
        type    : "POST",
        url     : "service.php",
        dataType: "json",
        data    : {
            action:"fullProjects",
            },          
            success:function(data){

                var i;
                for (i = 0; i < data.data.length; ++i) {

                    console.log(i);

                    var divCreator ='';

                    divCreator+='<div id="grupo'+i+'" class="typeface-js" style="font-family:GreyscaleBasic">';
                    divCreator+='<div class="tipo-pro">';
                    divCreator+='<div id="tipo_'+i+'" class="tipo"></div>';
                    divCreator+='<div id="tipo_arq_abajo'+i+'" class="abajo"></div>';
                    divCreator+='</div>';
                    divCreator+='<div id="fotoproyectos'+i+'" class="foto"><img src="' + data.data[i].path + '" height="128" width="160"></div>';
                    divCreator+='<div id="nombreproyectos'+i+'" class="nombre-pro"><form method=\"post\" name=\"projectsearch\" id=\"projectsearch"+ i +"\" action=\"proyectos_arq.php\">';
                    divCreator+='<span style=\"cursor: pointer;\" onclick=\"document.getElementById('projectsearch"+ i +"').submit()\">"+ data.data[i].projectName +"</span>'
                    divCreator+='<input name=\"project_id\" type=\"hidden\" id=\"project_id\" value=" + data.data[i].projectId + ">';
                    divCreator+='</form></div>';
                    divCreator+='</div>';
                    divCreator+='</div><br><br><br><br><br><br>';

                    $("#contiene-pro").append(divCreator);

                };

            }
        })

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T04:42:44.297

由于“&”不匹配，您的代码有太多错误。修复：

```
$("#busca").on('click', function() {

  $.ajax({
    type : "POST",
    url : "service.php",
    dataType : "json",
    data : {
      action : "fullProjects",
    },
    success : function(data) {

      var i;
      for ( i = 0; i < data.data.length; ++i) {

        console.log(i);
        var thisData = data.data[i];
        var divCreator = '';

        divCreator += '<div id="grupo' + i + '" class="typeface-js" style="font-family:GreyscaleBasic">';
        divCreator += '<div class="tipo-pro">';
        divCreator += '<div id="tipo_' + i + '" class="tipo"></div>';
        divCreator += '<div id="tipo_arq_abajo' + i + '" class="abajo"></div>';
        divCreator += '</div>';
        divCreator += '<div id="fotoproyectos' + i + '" class="foto"><img src="' + thisData.path + '" height="128" width="160"></div>';
        divCreator += '<div id="nombreproyectos' + i + '" class="nombre-pro"><form method="post" name="projectsearch" id="projectsearch' + i + '" action="proyectos_arq.php">';
        divCreator += '<span style="cursor: pointer;" onclick="document.getElementById("projectsearch' + i + '").submit()">' + thisData.projectName + '</span>';
        divCreator += '<input name=\"project_id\" type=\"hidden\" id=\"project_id\" value="' + thisData.projectId + '">';
        divCreator += '</form></div>';
        divCreator += '</div>';
        divCreator += '<br><br><br><br><br><br>';
        $("#contiene-pro").append(divCreator);
      };
    }
  });
}); 
```

# android - 数据未显示在列表视图中

> ID：13983932
> 
> 赞同：2
> 
> 时间：2012-12-21T03:36:23.260
> 
> 标签：android

应用程序运行时，我有两个进程正在运行。当进程“loaddata”完成时，结果使用 sqlite 存储到数据库中。当该进程下一个“Workoffline”将运行时，它负责从数据库加载数据并显示应用程序的列表视图。但我的问题是，当应用程序完成后，我的列表视图为空，我运行应用程序重新加载，新数据出现。你能帮我吗。（我必须在google上找到可以使用android同步的，以便处理“LoadData”运行完成然后最后运行进程Workoffline，但我不知道该怎么办！！）

源代码

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.invoice);
     doTimerTask();
    }
 // load dữ liệu lên listview
public void loaddatalistview()
{
    listview = (ListView) findViewById(R.id.listView1);
    listview.setAdapter(new DataAdapter(Invoice.this, codeInvoiceArray
            .toArray(new String[codeInvoiceArray.size()]), nameArray
            .toArray(new String[nameArray.size()]), phonenumberArray
            .toArray(new String[phonenumberArray.size()]), addressArray
            .toArray(new String[addressArray.size()])));
    listview.setOnItemClickListener(new OnItemClickListener() {

        // xử lý sự kiện khi chọn item trên listview
        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            Intent j = new Intent(Invoice.this, Menu_Main.class);

            // lấy thông tin thông qua vị trí của item được chọn
            String url = urlArray.get(position);
            String address = addressArray.get(position);
            String mahoadon = codeInvoiceArray.get(position);
            String phone = phonenumberArray.get(position);

            // chuyển thông tin này qua bên phần MENU
            j.putExtra("url", url);
            j.putExtra("address", address);
            j.putExtra("mahoadon", mahoadon);
            j.putExtra("phone", phone);
            j.putExtra("ID", IDDelivery);
            startActivity(j);
        }
    });
}

// Ứng dụng sẽ hoạt động offline với data được lưu trong database khi thiết
// bị không có
// kết nối mạng
public void workoffline()
{
    clearArray();
    try {
        mDb.openDB();
        Cursor mCursor = mDb.getAllInvoice(IDDelivery);
        if (mCursor.moveToFirst()) {
            do {
                codeInvoiceArray.add(mCursor.getString(1));
                nameArray.add(mCursor.getString(2));
                phonenumberArray.add(mCursor.getString(3));
                addressArray.add(mCursor.getString(4));
                urlArray.add(mCursor.getString(5));

            } while (mCursor.moveToNext());
            loaddatalistview();
        }
        mDb.closeDB();
    } catch (Exception e) {
        e.printStackTrace();
    }

}

// lấy dữ liệu từ server về thiết bị
public void loaddata()
{

    String sampleURL = SERVICE_URL + "/monthlytarget.php";
    CallUrl wst = new CallUrl(CallUrl.GET_TASK, this, "Lấy thông tin hóa đơn...", 1, IDDelivery);
    wst.execute(new String[] {
            sampleURL
    });

    // Hiển thị thông tin nhận được lên listview

}

// kiểm tra thiết bị có kết nối mạng hay không?
// nếu có thiết bị sẽ làm việc online
// nếu không thiết bị sẽ chuyển sang hoạt động offline
public void testNetwork()
{
    // Kiểm tra kết nối đến server
    TestConnectionNew test = new TestConnectionNew();
    try {
        String recieve = test.execute("http://longvansolution.tk/monthlytarget.php").get();
        if (recieve.equalsIgnoreCase("true") && isNetworkAvailable() == true)
        {
            ***loaddata();
            workoffline();***
        }
        else if (recieve.equalsIgnoreCase("false") || isNetworkAvailable() == false)
        {
            String mess = "Không thể kết nối đến server hoặc thiết bị chưa có kết nối mạng!";
            Toast.makeText(Invoice.this, mess, Toast.LENGTH_SHORT).show();
            workoffline();
        }

    } catch (InterruptedException e) {
        e.printStackTrace();
    } catch (ExecutionException e) {
        e.printStackTrace();
    }
}

// thực hiện load data từ server về theo thời gian định sẵn
public void doTimerTask() {
    TimerTask mTimerTask;
    Timer t = new Timer();
    final Handler handler = new Handler();
    mTimerTask = new TimerTask() {
        public void run() {
            handler.post(new Runnable() {
                public void run() {
                    testNetwork();
                    Log.d("TIMER", "TimerTask run");
                }
            });
        }
    };
    // public void schedule (TimerTask task, long delay, long period)
    t.schedule(mTimerTask, 500, 300000); //
} 
```

# php - 如何在图库视图中查看 PDF

> ID：13983933
> 
> 赞同：0
> 
> 时间：2012-12-21T03:36:29.060
> 
> 标签：php, jquery, pdf, web

是否可以在网站上将 PDF 作为图库视图查看。我的客户想将他所有的 pdf 文件转储到一个目录中，并希望其他人通过网站访问所有这些文件。我知道我们可以为图像文件提供画廊视图，但我想知道 pdf 文件是否也可以。他还希望通过触摸屏设备访问该网站。任何信息都会非常明显。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T05:17:03.017

您好，此代码用于查看 pdf。核实。可能会有所帮助。

```
 <!--[if IE]>
                <object type="application/pdf" width="718" height="700">
                  <param name="src" value="219.pdf" >
                  <param name="controller" value="true" >
                </object>
                <![endif]-->

                <!--[if !IE]> <!-->
                <object data="219.pdf" type="application/pdf" width="718" height="700">
                  alt : <a href="219.pdf">test.pdf</a>
                </object>
                <!--<![endif]--> 
```

# c# - 使用 SQLite 进行日志记录

> ID：13983936
> 
> 赞同：2
> 
> 时间：2012-12-21T03:37:09.470
> 
> 标签：c#, asp.net, .net, sqlite, rdbms

我想使用 SQLite 作为 WCF 服务日志记录的数据库后端。一切看起来都不错，但是如何从真实系统中提取数据库日志文件并且不锁定数据库以检查/分析日志？这个系统似乎负载很大，每次我尝试获取数据库日志文件时，它都会被锁定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:57:08.740

SQLite 允许多个进程/应用程序打开同一个数据库文件以进行读写（写入时涉及一些锁定，但这并不常见）。

您应该能够让日志记录过程不断将新行记录到数据库中，同时让卸载/提取过程将旧行复制到其他位置。

但是，如果您不应该在数据库打开时使用标准复制功能将其复制为文件，因为它很可能会损坏它（在 Windows 上，由于严格的锁定，它甚至可能是不可能的）。

相反，让卸载过程使用标准 SQLite API（或一些支持 SQLite 的脚本语言）连接到数据库，使用该 API 读取行并在其他地方创建该数据的副本，例如在另一个 SQLite 数据库或大型“真实”SQL 数据库中，例如MySQL、Postgres 或 MSSQL（如果愿意，也可以在文本文件中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T05:12:17.273

使用 SQLite 的[在线备份](http://www.sqlite.org/backup.html)API 来提取数据，而无需锁定数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-07T17:02:09.490

您现在可以使用 SQLite 的[预写日志记录](https://sqlite.org/wal.html)模式来启用 SQLite 数据库同时读取和写入。

使用 WAL 代替回滚日志有优点和缺点。优点包括：

1.  在大多数情况下，WAL 明显更快。
2.  WAL 提供了更多的并发性，因为读取器不会阻塞写入器，写入器不会阻塞读取器。读和写可以同时进行。
3.  使用 WAL 的磁盘 I/O 操作往往更具顺序性。
4.  WAL 使用更少的 fsync() 操作，因此在 fsync() 系统调用被破坏的系统上不易受到问题的影响。

# php - CodeIgniter，除主页外的所有页面都有状态码 404，但看起来完全没问题？

> ID：13983937
> 
> 赞同：1
> 
> 时间：2012-12-21T03:37:16.397
> 
> 标签：php, codeigniter

我注意到这一点的唯一原因是因为我尝试进行 ajax 调用，但从未调用过我的回调。因为我得到了一个 404，即使它工作正常并且响应是正确的。我也不能发送任何 POST 数据，它会被清除。有谁听说过吗？您需要我提供哪些额外信息？

我在本地主机上，WAMP。并使用虚拟主机

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T04:12:06.330

知道了。我没有安装 mod_rewrite ......不知何故。

我的 htaccess 的这一部分允许它使用 404 状态码

```
<IfModule !mod_rewrite.c>

    # Without mod_rewrite, route 404's to the front controller
    ErrorDocument 404 /index.php

</IfModule> 
```

# actionscript-3 - 闪存中的鼠标事件

> ID：13983938
> 
> 赞同：0
> 
> 时间：2012-12-21T03:37:29.140
> 
> 标签：actionscript-3, flash, apache-flex

我正在尝试在 Flash 应用程序中制作自己的按钮。这是一些代码：

```
addEventListener(MouseEvent.MOUSE_OUT, Out);
addEventListener(MouseEvent.MOUSE_OVER, Over);

...

private function Over(event:MouseEvent):void
{
    addChild(overImage);
}

private function Out(event:MouseEvent):void
{
    removeChild(overImage);
} 
```

当鼠标悬停在此按钮上时，overImage 会闪烁。看起来`Over`和`Out`正在调用每一帧。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:46:14.990

如果鼠标位于`overImage`将出现的点，则该子对象将在其自身上引发`MOUSE_OVER`事件，从而`MOUSE_OUT`在其父对象上引发事件。父级`MOUSE_OUT`将从显示列表中删除 ，`overImage`这将再次导致`MOUSE_OVER`父级超出，再次启动循环并使`overImage`闪烁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T07:41:44.450

就像其他人说的那样，改用 ROLL_OVER 和 ROLL_OUT，或者设置 button.mouseChildren = false。

它闪烁的原因是因为 MOUSE_OVER 和 MOUSE_OUT 将用于该按钮的每个孩子。因此，如果您有文本、背景图像/颜色、光泽或其中的其他元素，则每次滚动其中任何部分时，它都会触发。

因此，当您添加“overImage”时，它会出现在鼠标下方，并触发另一个 mouseOut 和 mouseOver。同样，只需使用 ROLL_OVER 和 ROLL_OUT，或设置 mouseChildren = false

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T03:47:38.003

既然你用 Flex 标记了这个；为什么不使用[Flex 按钮](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/controls/Button.html)？

MouseOver 事件将随着鼠标移动而连续触发。我会在调用 addChild 之前执行检查，以查看 overImage 是否已经成为父对象：

```
private function Over(event:MouseEvent):void
{
   if(!overImage.parent){
    addChild(overImage); 
   }
}

private function Out(event:MouseEvent):void
{
    if(overImage.parent){
     removeChild(overImage);
    }
} 
```

我怀疑这会阻止“闪烁”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T07:05:38.940

只需考虑使用`MouseEvent.ROLL_OVER`和`MouseEvent.ROLL_OUT`事件。他们忽略组件的孩子。没有任何额外的检查和丑陋的技巧。

顺便说一句，按钮支持皮肤和状态，因此您可以将图像包含在“结束”状态中。

# python - 如何使用 wget 下载文件

> ID：13983941
> 
> 赞同：5
> 
> 时间：2012-12-21T03:37:39.530
> 
> 标签：python, wget, scrapy

scrapy 没有正确下载文件。我有我的项目的 URL，所以我想我可以使用 wget 来下载文件。

如何在 scrapy`process_item`函数中使用 wget？或者，是否有另一种下载文件的方式？

```
class MyImagesPipeline(ImagesPipeline):
    #Name download version
    def image_key(self, url):
        image_guid = url.split('/')[-1]
        return 'full/%s' % (image_guid)

    def get_media_requests(self, item, info):
        if item['image_urls']:
            for image_url in item['image_urls']:
            # wget -nH image_ul -P  images/
            yield Request(image_url) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T04:02:25.620

此代码将执行 wget，您可以将您的注释替换为以下行

```
import subprocess

    ...

subprocess.call(['wget','-nH', image_url, '-P  images/']) 
```

您可以在此处阅读有关 subprocess.call 的信息：http: [//docs.python.org/2/library/subprocess.html](http://docs.python.org/2/library/subprocess.html)

# ruby-on-rails - Ruby on Rails Rake 资产：预编译错误 - 命令失败，状态为 (1) - CScript 错误：Windows 脚本宿主执行失败

> ID：13983948
> 
> 赞同：2
> 
> 时间：2012-12-21T03:38:40.297
> 
> 标签：ruby-on-rails, rake, asset-pipeline

好吧，我们都看到了关于 Rake assets:precompile 错误的问题。我尝试了多种方法，我查看了以下 SO 问题[Ruby on Rails Rake assets:precompile error](https://stackoverflow.com/questions/7464544/ruby-on-rails-rake-assetsprecompile-error)并尝试了多种方法，甚至执行以下操作：`config.assets.compile = true`然后运行`rake assets:precompile --trace RAILS_ENV=production`​​. 但是我注意到，当我尝试执行以下操作时：

`rake assets:precompile RAILS_ENV=production`我收到以下错误：

> 耙中止！CScript 错误：Windows 脚本宿主的执行失败。(0x800A0007)
> 
> C:\Users\home\Desktop>cd MIUK_Portal
> 
> C:\Users\home\Desktop\MIUK_Portal>rake assets:precompile RAILS_ENV=production C:/RailsInstaller/Ruby1.9.3/bin/ruby.exe C:/RailsInstaller/Ruby1.9.3/bin/rake assets:precompile:all RAILS_ENV =生产RAILS_GROUPS=资产耙已中止！795：'C:\Users\home\AppData\Local\Temp\execjs20121221-5484-1atk9yx.js(2, 3) Microsoft JScript 运行时错误：内存不足
> 
> '（在 C:/Users/home/Desktop/MIUK_Portal/app/assets/javascripts/application.js 中）
> 
> 任务：TOP => assets:precompile:primary（通过使用 --trace 运行任务查看完整跟踪）rake 中止！命令失败，状态为 (1)：[C:/RailsInstaller/Ruby1.9.3/bin/ruby.exe C...]
> 
> 任务：TOP => assets:precompile（通过使用 --trace 运行任务查看完整跟踪）

有没有人遇到过这个问题？你如何克服这一点？

**更新**

好吧，显然从查看错误来看，它清楚地表明

> :\Users\home\AppData\Local\Temp\execjs20121221-5484-1atk9yx.js(2, 3) Microsoft JScript 运行时错误：内存不足

所以我现在想知道如何解决这个问题？有任何想法吗？除此之外，我注意到有人确实遇到了类似的问题：[CS Script issue](https://stackoverflow.com/questions/11292514/cscript-error-execution-of-the-windows-script-host-failed-rails-rake-assetsp)，但这没有解决：

所以我问有没有人有同样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-16T04:48:42.487

这就是我所做的，它对我有用。我首先在我的系统中安装了 node.js，然后运行了以下命令`bundle exec rake assets:precompile`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:46:12.613

我能够通过将项目转移到 Linux 环境（Ubuntu）并运行`bundle exec rake assets:precompile`. 它似乎有效，我相信这类问题与Windows有关。如果开始任何与 RoR 相关的开发，请坚持使用 Linux。

# ios - iOS项目的.git文件夹

> ID：13983949
> 
> 赞同：0
> 
> 时间：2012-12-21T03:38:44.430
> 
> 标签：ios, git

我使用 git 来管理我的 ios 项目，并且我们知道 git 会在项目下生成一个 .git 文件夹，我想知道当我使用 Xcode 将应用程序上传到应用商店时，我应该先删除 .git 文件夹吗？或者 .git 文件夹在上传时会归档到应用程序中吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T03:42:00.423

该`.git`文件夹不包含在您的应用存档中。你不应该删除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:47:58.627

当您编译代码并创建一个包时，它永远不会包含 git 文件夹内容。git 只是 svn 的替代品。无论您的项目中是否有 .git 文件，应用程序包都没有关系。这根本不会影响您的捆绑包。简而言之，您**不需要**删除此文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T04:04:08.260

您的源代码和 .git 文件夹永远不会上传到 AppStore。只会上传已编译的应用程序包。

也就是说，您不必删除 .git 文件夹。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-21T03:41:59.217

你可以打开一个终端，然后输入：

```
ls -A 
```

您可以找到所有文件，包括隐藏文件“.git”

要删除它，请键入：

```
rm -rf .git 
```

# machine-learning - 我如何在这个例子中使用基于规则的学习算法

> ID：13983955
> 
> 赞同：1
> 
> 时间：2012-12-21T03:39:47.767
> 
> 标签：machine-learning, data-mining, weka

我有如下数据，以便对人们在网上购买衣服时发现模型中的哪些特征具有吸引力进行预测性学习。

所以我有如下数据。

```
COLORofCLOTHING  MODELHAIR_COLOR MODEL_BUILD SELLER_CATEGORY
  Red               Black         Lean           1
  Blue              Brown         Lean           5
  Black             Blonde        Healthy        10 
```

为了预测服装是否会卖得好给定一组属性。但是卖家类别可以是 1 到 10 之间的任何值（1 是最好的，10 是最差的）我不知道如何解决这个问题。为此，我正在使用 weka。人们可以给我关于如何解决这个问题的想法吗？

基本上我想建立一个模型来学习衣服的颜色等特征，并可以预测衣服的销售情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T04:40:41.850

将您的数据集转换和规范化为以下内容：

```
 color_red   color_blue color_black  hair_black  hair_brown  hair_blonde ... prediction
 1           0          0            1           0           0           ... 0
 0           1          0            0           1           0           ... 0.5
 0           0          1            0           0           1           ... 1 
```

随机森林和神经网络应该能够给你预测。

# r - R数据框：行间计算

> ID：13983956
> 
> 赞同：2
> 
> 时间：2012-12-21T03:39:52.197
> 
> 标签：r, time-series

[这是从数据框中的每个分组行中减去上一年的值](https://stackoverflow.com/questions/9552771/subtract-previous-years-from-value-from-each-grouped-row-in-data-frame)的扩展。使用 plyr 的选项完全有意义。

现在，我正在尝试添加更多列。我还修改了年份，所以它是一个实际的年份，ID 不同的起点。这是制表符分隔 df 的链接：[https ://dl.dropbox.com/u/9699533/df.txt](https://dl.dropbox.com/u/9699533/df.txt)

![在此处输入图像描述](../Images/939707fad5b2aad42c3943f2c05b34a0.png)

当我在当前行时，我无法获得指向上一行的指针。我想把它传递给 plyr::transform 的函数部分。请问这个怎么写？谢谢！

~ *~* ~ *~*备用数据帧输入~ *~* ~ *~*

```
> dput(df)
structure(list(id = c(1L, 1L, 1L, 2L, 2L, 2L, 3L, 3L, 3L, 4L, 
4L, 4L, 5L, 5L, 5L), value = c(6L, 16L, 21L, 5L, 10L, 26L, 2L, 
12L, 26L, 9L, 16L, 26L, 2L, 15L, 29L), year = c(2007L, 2008L, 
2009L, 2011L, 2012L, 2013L, 2004L, 2004L, 2006L, 2010L, 2011L, 
2012L, 2014L, 2015L, 2016L), actual = c(6L, 10L, 5L, 5L, 5L, 
16L, 2L, 10L, 14L, 9L, 7L, 10L, 2L, 13L, 14L)), .Names = c("id", 
"value", "year", "actual"), class = "data.frame", row.names = c(NA, 
-15L)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:52:43.993

不要使用`transform`.

```
foo <- function(x){
   x$ratio <- c(NA,tail(x$actual,-1)/head(x$value,-1))
   x
 }
> 
> ddply(df,.(id),foo)
   id value year actual     ratio
1   1     6 2007      6        NA
2   1    16 2008     10 1.6666667
3   1    21 2009      5 0.3125000
4   2     5 2011      5        NA
5   2    10 2012      5 1.0000000
6   2    26 2013     16 1.6000000
7   3     2 2004      2        NA
8   3    12 2004     10 5.0000000
9   3    26 2006     14 1.1666667
10  4     9 2010      9        NA
11  4    16 2011      7 0.7777778
12  4    26 2012     10 0.6250000
13  5     2 2014      2        NA
14  5    15 2015     13 6.5000000
15  5    29 2016     14 0.9333333 
```

如果我们可以假设您的数据框已排序，并且我们知道每个组 (by `id`) 有多大，我们甚至不需要执行整个拆分应用程序：

```
df$ratio2 <- with(df,c(NA,tail(actual,-1) / head(value,-1)))
df$ratio2[seq(1,nrow(df),by = 3)] <- NA 
```

# php - 在 html 中嵌入 WMV 文件的问题

> ID：13983957
> 
> 赞同：0
> 
> 时间：2012-12-21T03:40:04.913
> 
> 标签：php, javascript, html, windows-media-player, wmv

我有一个链接可以在我的网站上播放视频。当用户单击该视频链接时，将弹出嵌入该视频的 div（不是弹出窗口，它使用 jquery BlockUI 显示隐藏的 div）。并且有一个关闭按钮，它将隐藏嵌入视频的 div。

一切正常。但是视频并没有在关闭该 div 时停止。我能听到声音:(。我也想在关闭该视频时停止该声音。该怎么办。请做必要的事

```
<OBJECT ID="MediaPlayers" WIDTH="400" HEIGHT="350" CLASSID="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95"
STANDBY="Loading Windows Media Player components..." TYPE="application/x-oleobject">
<PARAM NAME="FileName" VALUE="1.wmv">
<PARAM name="autostart" VALUE="false">
<PARAM name="ShowControls" VALUE="true">
<param name="ShowStatusBar" value="false">
<PARAM name="ShowDisplay" VALUE="false">
<EMBED TYPE="application/x-mplayer2" SRC="1.wmv" NAME="MediaPlayer"
WIDTH="400" HEIGHT="350" ShowControls="1" ShowStatusBar="0" ShowDisplay="0" autostart="0"> </EMBED>
</OBJECT> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T05:26:43.190

关闭弹出窗口时尝试使用它。

```
document.getElementById("MediaPlayers").stop(); 
```

或者你可以使用另一个div来包装这个播放器，然后在打开弹出窗口时将你的html添加到innerHTML中，然后在关闭窗口时将其全部删除。喜欢

```
<div id="playerWrap">
    <OBJECT ID="MediaPlayers" ....
    .....
    </OBJECT>
</div> 
```

javascript代码：

```
document.getElementById("palyerWrap").innerHTML = ""; 
```

[http://www.htmlforums.com/multimedia-elements/t-accessing-mediaplayer-functionality-from-javascript-65899.html](http://www.htmlforums.com/multimedia-elements/t-accessing-mediaplayer-functionality-from-javascript-65899.html)参考

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:57:27.070

如果您希望每个人都能够观看您的视频，则应使用 html5 视频标签。这不仅可以让您摆脱专有插件（Windows 媒体播放器）的意外行为，还可以让您接触到更广泛的设备，从而获得更多的受众。

我建议将您的视频转换为 webm 格式并使用 jplayer 将其显示在您的网站上。

# c# - 在 VS 2012 项目中启用 System.Net.Http

> ID：13983958
> 
> 赞同：3
> 
> 时间：2012-12-21T03:40:08.563
> 
> 标签：c#, .net, json, web-config, drools

我对 JSON 开发还很陌生，刚刚开始是一项重大任务，通过 Google 提供的解决方案很少。

如果不将 system.net.http 添加为我的项目的一部分，我将无处可去

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Web;
using System.Net.Http; 
```

var、HttpWebClient、KeyValuePair 等对象在编译期间抛出错误。这是我尝试过的：

*   重新安装.NET 4.0
*   重新安装.NET 4.5
*   通过重新打包库。NuGet
*   参考system.net

没运气。我什至尝试在 web.config 中引用该类

```
<compilation targetFramework="4.5">
  <assemblies>
    <add assembly="System.Net.Http, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
  </assemblies>
</compilation> 
```

并再次在..

```
<runtime>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
    <dependentAssembly>
      <assemblyIdentity name="System.Net.Http" publicKeyToken="b03f5f7f11d50a3a" />
      <bindingRedirect oldVersion="0.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
    </dependentAssembly>
  </assemblyBinding>
</runtime> 
```

在“程序集”上引发错误

我无计可施。在无法使用 System.Net.Http 的地方，我没有引用或做错什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T03:49:45.037

在 .NET 4.5 System.Net.Http 中是它自己的程序集，您必须转到“添加引用”（右键单击项目）并选择它。

请参阅 HttpClient 的 MSDN 页面：http: [//msdn.microsoft.com/en-us/library/system.net.http.httpclient.aspx](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient.aspx)

> 程序集：System.Net.Http（在 System.Net.Http.dll 中）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T03:55:54.230

帮助系统显示 System.Net.Http 命名空间是在 System.Net.Http.dll 中定义的，正如您所说，它没有列出。快速搜索我自己的文件系统会发现副本

*   在 GAC
*   在 32 位和 64 位的框架文件夹中

在我的系统上，这些路径是

```
 C:\Windows\Microsoft.NET\Framework\v4.0.30319
 C:\Windows\Microsoft.NET\Framework64\v4.0.30319 
```

System.Net.Http.WebRequest.dll 位于相同的路径上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T03:43:43.373

你试过了吗

```
using System.Net.Http; 
```

C# 是一种区分大小写的语言。

# java - java中的一次循环？

> ID：13983959
> 
> 赞同：0
> 
> 时间：2012-12-21T03:40:15.203
> 
> 标签：java, loops, time

我试过在java中制作一个只运行一次的循环，

```
package com.notelek.programs.flat;

import java.awt.event.KeyEvent;

import com.notelek.programs.flat.input.Controller;

public class Game {
    public static int time;
    public Controller controls;

    public Game(){
        controls = new Controller();
    }

    public void tick(Boolean[] key){
        time++;
        Boolean forward = key[KeyEvent.VK_W];
        Boolean back = key[KeyEvent.VK_S];
        Boolean left = key[KeyEvent.VK_A];
        Boolean right = key[KeyEvent.VK_D];
        Boolean turnLeft = key[KeyEvent.VK_LEFT];
        Boolean turnRight = key[KeyEvent.VK_RIGHT];
        for(Boolean i = true; i == true; i = false){
            forward = true;
            back = true;
            left = true;
            right = true;
            turnLeft = true;
            turnRight = true;
        }
        controls.tick(forward,back,left,right,turnLeft,turnRight);
    }    
} 
```

那是我的代码，我需要将向前向后向左向右转左转右变量全部设置为 true，然后快速（在一秒钟内）返回 false 有谁知道这样做的简单方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T03:46:22.180

我们说话的速度有多快，在这里？如果您想在一秒钟内切换它（比一秒钟快得多），只需执行以下操作：

```
forward = true;
back = true;
left = true;
right = true;
turnLeft = true;
turnRight = true;
forward = false;
back = false;
left = false;
right = false;
turnLeft = false;
turnRight = false; 
```

如果您正在寻找可以操作的切换，我会制作您自己的方法：

```
public void toggle() {
    forward = !forward;
    back = !back;
    // and so on
} 
```

...然后在经过一定的毫秒后调用它。

但是，本着回答所问问题的精神，如果你真的，真的，*真的*想使用一个只运行一次的循环，出于某种原因......这是它的语法：

```
for(int i = 0; i < 1; i++) {
    // do stuff
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T03:55:14.653

如果你*真的*想要一个循环，使用这个：

```
do {
    your code here
} while (false); 
```

IMO，这有点傻......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T09:16:02.927

可能尝试这样的事情：

> ```
> for(int i = 0; i < 2; i++)
> {
>      Boolean state = (i == 0);
>      forwards = state;
>      back = state;
>      left = state;
>      right = state;
>      turnLeft = state;
>      turnRight = state;
> 
>      // Optional sleep
>      int milliseconds = 100;
>      Thread.sleep(milliseconds);
> } 
> ```

循环将循环一次，将所有设置为`true`(i == 0)，然后在下一次重复将所有设置为`fasle`，然后退出。

这`Thread.sleep()`是可选的，具体取决于您是否需要这些值在短时间内保持不变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T03:48:31.450

为什么要使用循环？如果您只想让某事稍等片刻，为什么不使用等待命令：

[Thread.sleep(int 毫秒)](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Thread.html)

您可以只执行您想要的代码块，等待规定的毫秒数，然后执行另一个代码块：

```
int milliseconds = 1000;

forward = true;
back = true;
left = true;
right = true;
turnLeft = true;
turnRight = true;
Thread.sleep(milliseconds)
forward = false;
back = false;
left = false;
right = false;
turnLeft = false;
turnRight = false; 
```

# c - 为什么 Windows 的 CreateFile( ) 骗我？

> ID：13983967
> 
> 赞同：6
> 
> 时间：2012-12-21T03:41:00.073
> 
> 标签：c, winapi, createfile

我试图阻止我的进程中的第三方 DLL 读取我打开的文件，我发现它是......好吧，*不可能*的。

无论我做什么，无论我指定什么共享标志，他们的调用似乎*总是成功！*

这是 Process Monitor 的屏幕截图——第一个`CreateFile`电话是我的，其余的是他们的：

[![截屏](../Images/b24403811d67b3f68e852d55d04d1fde.png)](https://i.stack.imgur.com/y3npm.png)

这怎么可能？为什么*“共享模式：无”*对我撒谎，我该如何防止这种情况？

* * *

下面的代码是重现问题的示例：

```
#include <stdio.h>
#include <Windows.h>

int main()
{
    LPCTSTR file = TEXT("C:\\Test1234.xml");
    HANDLE hFile1 =
        CreateFile(file, FILE_READ_ATTRIBUTES, 0, NULL, OPEN_ALWAYS, 0, NULL);
    HANDLE hFile2 =
        CreateFile(file, FILE_READ_DATA, 0, NULL, OPEN_ALWAYS, 0, NULL);
    DWORD n;
    BYTE buf[1];
    printf("%d\n", ReadFile(hFile2, buf, sizeof(buf), &n, NULL));
    CloseHandle(hFile1);
    CloseHandle(hFile2);
    DeleteFile(file);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T05:12:50.110

共享模式被强制用于实际读取和写入文件的 DATA。属性（如文件大小、时间戳等）不包含在共享规则中，并且没有办法阻止它们在没有 ACL 的情况下访问。

最好的办法是打开文件进行 R/W/D 访问，而不是指定 SHARE_READ|WRITE|DELETE。

很奇怪，但确实如此。

# php - 在 PHP 中将内容复制到另一个页面

> ID：13983975
> 
> 赞同：0
> 
> 时间：2012-12-21T03:41:59.503
> 
> 标签：php, mysql

我想问一下PHP和MySQL。我有 2 页 php，我们称之为 content.php 和 duplicate.php。在内容 php 中，有一个搜索表单和一个表单搜索结果表。

我想问的是：我可以将 content.php 中的表格结果复制到 duplicate.php （只是表格，没有表格）吗？我现在想的是使用会话，但我认为这不是解决我的问题的更好方法。或者如果这是最好的方式，我必须在会议上保留哪些内容？询问？要不然是啥？

对不起，我的英语不好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T03:43:14.413

只需使用一个文件，并将相关部分包含在诸如`if( isset($_POST['submit']))`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T04:18:21.790

```
//do query to MySQL
$content = "";
$content .= "<table>";
$content .= "<tr><td>put your data</td></tr>";
$content .= "</table>";

$_SESSION['my_content'] = $content; 
```

使用 my_content 会话在 duplicate.php 中回显该内容。希望对您有所帮助....取决于您想做什么。如果您只想在一页中制作，请使用 Kolink 评论。

# android - 我的孩子活动没有将结果发送回父母

> ID：13983977
> 
> 赞同：0
> 
> 时间：2012-12-21T03:42:06.960
> 
> 标签：android, android-intent, android-activity

我正在尝试为我所在的课程创建一个待办事项列表，而我拥有该应用程序的方式是我在顶部有一个 EditText 以在 TDL 中输入一个项目。然后我使用扩展的表格布局来显示项目。我还有一个按钮调用第二个活动，然后有两个其他按钮来获取时间和日期（希望）在我点击按钮上的完成按钮后显示在 TDL 项目上（我想回到主要活动）到目前为止，我正在 AVD 上对此进行测试。

所以我认为我的问题是我不认为我的第二个活动是传回我想要的信息。根据调试器，第一个活动的 onActivityResults 方法在调用第二个活动之前被调用。

这是第一个活动：

```
package com.parrishb.todo;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.view.KeyEvent;
import android.view.View;
import android.widget.EditText;
import android.widget.Button;

public class ToDoActivity extends Activity {

    SharedPreferences pref; 

    public final static int ACTIVITY =1;

    public static Globals g;

    public ToDoView tdv;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_to_do);

        final EditText myEditText = (EditText)findViewById(R.id.myEditText);

        Button mPickDate = (Button) findViewById(R.id.pickDate);
        tdv = (ToDoView)findViewById(R.id.tdv);

        myEditText.setOnKeyListener(new View.OnKeyListener() {
            public boolean onKey(View v, int keyCode, KeyEvent event) {
                if(event.getAction()== KeyEvent.ACTION_DOWN){
                    if((keyCode == KeyEvent.KEYCODE_DPAD_CENTER) || (keyCode == KeyEvent.KEYCODE_ENTER)){
                        tdv.addRow(ToDoActivity.this, myEditText.getText().toString());

                        myEditText.setText("");
                        return true;
                    }
                }
                return false;
            }
        });

        // CLick listener for the date/time button
        mPickDate.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                startActivityForResult(new Intent(ToDoActivity.this, DatePickerActivity.class), ACTIVITY);
            }
        });

    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data){
        super.onActivityResult(requestCode, resultCode, data);
        if(resultCode== RESULT_OK && requestCode== ACTIVITY){
            String append= (new StringBuilder().append(data.getStringExtra("Time"))
                    .append(" ").append(data.getStringExtra("Date")).toString());
            tdv.editRow(ToDoActivity.this, append);
        }

    }

} 
```

这是我的第二个活动：

```
package com.parrishb.todo;

import java.util.Calendar;

import android.app.Activity;
import android.app.DatePickerDialog;
import android.app.Dialog;
import android.app.TimePickerDialog;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.DatePicker;
import android.widget.TextView;
import android.widget.TimePicker;
public class DatePickerActivity extends Activity {

    private TextView mDateDisplay;
    private Button mPickDate;
    private int mYear;
    private int mMonth;
    private int mDay;
    private TextView mTimeDisplay;
    private Button mPickTime;

    private Button done;

    private int mhour;
    private int mminute;

    static final int TIME_DIALOG_ID = 1;

    static final int DATE_DIALOG_ID = 0;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.buttonclick);

        mDateDisplay =(TextView)findViewById(R.id.date);
        mPickDate =(Button)findViewById(R.id.datepicker);
        mTimeDisplay = (TextView) findViewById(R.id.time);
        mPickTime = (Button) findViewById(R.id.timepicker);
        done = (Button)findViewById(R.id.done);

        //Pick time's click event listener
        mPickTime.setOnClickListener(new View.OnClickListener(){

            @Override
            public void onClick(View v) {
                showDialog(TIME_DIALOG_ID);

            }

        });

        //PickDate's click event listener 
        mPickDate.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                showDialog(DATE_DIALOG_ID);

            }
        });

        done.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                //DatePickerActivity.this.finishActivityFromChild(DatePickerActivity.this, ToDoActivity.ACTIVITY);
                //finishActivity(ToDoActivity.ACTIVITY);
                //return;
                //DatePickerActivity.this.finish(ToDoActivity.ACTIVITY);
                //finish();
                DatePickerActivity.this.finish();

            }
        });

        final Calendar c = Calendar.getInstance();
        mYear = c.get(Calendar.YEAR);
        mMonth = c.get(Calendar.MONTH);
        mDay = c.get(Calendar.DAY_OF_MONTH);
        mhour = c.get(Calendar.HOUR_OF_DAY);
        mminute = c.get(Calendar.MINUTE);

    }

    @Override
    public void finish(){
        Intent resultIntent = new Intent();
        Bundle b = new Bundle();
            b.putString("Date", mDateDisplay.getText().toString());
            b.putString("Time", mTimeDisplay.getText().toString());
        resultIntent.putExtras(b);
        setResult(Activity.RESULT_OK, resultIntent);
        super.finish();
    }

    //-------------------------------------------update date----------------------------------------//    
    private void updateDate() {

        mDateDisplay.setText(
                new StringBuilder()
                // Month is 0 based so add 1
                .append(mMonth + 1).append("/")
                .append(mDay).append("/")
                .append(mYear).append(" "));

    }

    //-------------------------------------------update time----------------------------------------//    
    public void updatetime()
    {
        mTimeDisplay.setText(
                new StringBuilder()
                .append(pad(mhour)).append(":")
                .append(pad(mminute))); 

    }

    private static String pad(int c) {
        if (c >= 10)
            return String.valueOf(c);
        else
            return "0" + String.valueOf(c);
    }

    //Datepicker dialog generation  

    private DatePickerDialog.OnDateSetListener mDateSetListener =
            new DatePickerDialog.OnDateSetListener() {

        public void onDateSet(DatePicker view, int year, 
                int monthOfYear, int dayOfMonth) {
            mYear = year;
            mMonth = monthOfYear;
            mDay = dayOfMonth;
            updateDate();
        }
    };

    // Timepicker dialog generation
    private TimePickerDialog.OnTimeSetListener mTimeSetListener =
            new TimePickerDialog.OnTimeSetListener() {
        public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
            mhour = hourOfDay;
            mminute = minute;
            updatetime();
        }

    };

    @Override
    protected Dialog onCreateDialog(int id) {
        switch (id) {
        case DATE_DIALOG_ID:
            return new DatePickerDialog(this,
                    mDateSetListener,
                    mYear, mMonth, mDay);

        case TIME_DIALOG_ID:
            return new TimePickerDialog(this,
                    mTimeSetListener, mhour, mminute, true);

        }
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T05:38:10.887

我已经完成了第二个活动，并将日期和时间选择器带入了主要活动。

# ios - UIView 不允许我添加子视图

> ID：13983982
> 
> 赞同：0
> 
> 时间：2012-12-21T03:44:29.503
> 
> 标签：ios, xcode, uiview, uiviewcontroller, addsubview

所以我有一个视图，在我的 viewcontoller 类中，我尝试使用以下代码添加一个子视图。

```
 UIButton *test = [[UIButton alloc]initWithFrame:CGRectMake(30, 100, 100, 100)];
    [self.view addSubView:test]; 
```

什么都没有发生，没有错误或任何东西。我知道它被调用是因为它在 viewdidload 方法中。我有一个单独的类，我是 uiview 的子类，这与它有什么关系吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:49:29.570

```
UIButton *test = [UIButton buttonWithType:UIButtonTypeRoundedRect];
test.frame = CGRectMake(30, 100, 100, 100);
[self.view addSubView:test]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T03:52:39.043

您需要确保添加该按钮的所有必需属性：

```
UIButton *test = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[test addTarget:self action:@selector(selector:) forControlEvents:UIControlEventTouchDown];
[test setTitle:@"Button Title" forState:UIControlStateNormal];
test.frame = CGRectMake(30, 100, 100, 100);
[view addSubview:test]; 
```

# c++ - 当调用具有条件变量等待的线程对象的析构函数时会发生什么？

> ID：13983984
> 
> 赞同：10
> 
> 时间：2012-12-21T03:45:33.407
> 
> 标签：c++, multithreading, c++11, condition-variable

我正在使用 a`SynchronisedQueue`在线程之间进行通信。我发现当附加线程正在等待条件变量时销毁线程对象会导致程序崩溃。这可以通过`detach()`在线程销毁之前调用来纠正。但我想知道当等待条件变量的线程终止时会发生什么。还有另一种使用条件变量的方法来避免这种情况吗？

```
#include <queue>
#include <thread>
#include <mutex>
#include <condition_variable>

template <typename Type> class SynchronisedQueue {
 public:
  void Enqueue(Type const & data) {
    std::unique_lock<std::mutex> lock(mutex_);
    queue_.push(data);
    condition_.notify_one();
  }
  Type Dequeue() {
    std::unique_lock<std::mutex> lock(mutex_);
    while (queue_.empty())
      condition_.wait(lock);
    Type result = queue_.front();
    queue_.pop();
    return result; 
  }
 private:
  std::queue<Type> queue_;
  std::mutex mutex_;
  std::condition_variable condition_; 
};

class Worker {
public:
  Worker(SynchronisedQueue<int> * queue) : queue_(queue) {}
  void operator()() {
    queue_->Dequeue();    // <-- The thread waits here.
  }
private:
  SynchronisedQueue<int> * queue_;
};

int main() {
  auto queue = new SynchronisedQueue<int>();
  Worker worker(queue);
  std::thread worker_thread(worker);
  worker_thread.~thread();  // <-- Crashes the program.
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-21T04:12:50.573

来自 C++11 规范：

> **30.3.1.3**线程析构函数 [thread.thread.destr] ~thread();
> 
> 如果 joinable()，则调用 std::terminate()。否则，没有任何影响。
> 
> [ 注意：在其析构函数中隐式分离或加入 joinable() 线程可能导致难以调试正确性（分离）或性能（加入）错误，仅在引发异常时遇到。因此，程序员必须确保在线程仍可连接时永远不会执行析构函数。——尾注]

因此，在`thread destructor`没有先调用`join`（等待它完成）的情况下调用 a 或者`detach`保证立即调用`std::terminate`并结束程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T04:09:50.570

如果您没有调用（等待线程完成）或（将线程与对象分离），则析构函数`std::thread`将在线程上运行时调用。`std::terminate``join()``detach()`

您的代码调用析构函数`worker_thread`而不调用它`join()`，`detach()`因此`std::terminate`被调用。这与条件变量的存在无关。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-21T03:59:10.233

当某物正在或可能正在使用它时，您永远不能破坏资源。这真的只是常识。

# database - 用于多个（相同结构）元素的基于 Web 的数据库界面

> ID：13983987
> 
> 赞同：0
> 
> 时间：2012-12-21T03:45:58.873
> 
> 标签：database, grid, dataset, project-management

我想知道是否有现成的数据库/数据集接口软件（更好的开源）可以在公司内部实施以遵循多个元素。

例如，我有 1000 个建筑工地（元素），它们都具有相同的生命周期。

*   启动（日期，类型等）
*   投影（日期、状态、文件等）
*   构造（日期、类型等）
*   接受（日期、状态、文件、评论等）

这就像1000个标准子项目（元素）的项目管理

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T12:21:50.807

你肯定需要一个CMS。据我了解，您需要管理 1000 个网站。

试试这个链接，然后选择最适合您要求的 CMS 之一。

[http://www.webdistortion.com/2008/05/17/13-free-cms-options-for-web-design-professionals/](http://www.webdistortion.com/2008/05/17/13-free-cms-options-for-web-design-professionals/)

# optimization - 在 gcc/g++ 中，-g 选项会减慢可执行文件的速度吗？

> ID：13983988
> 
> 赞同：1
> 
> 时间：2012-12-21T03:46:10.143
> 
> 标签：optimization, gcc, g++

我听说人们说它没有，但我认为最好问一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:52:39.920

当你尝试它时会发生什么？为您关心的一些代码计时，用 重新编译`-g`，并对新代码计时。

包含所有调试内容并不会更快，但这并不意味着它会更慢。最重要的是，这并不意味着它会*在您关心的代码中*变慢。如果你有一个程序在没有它的情况下运行 30 秒，在`-g`有它的情况下运行 31 秒，你在乎吗？

优化俱乐部的第一条规则是“不优化”。第二条规则是“不经过测量就不要优化”。

# html - 加快画布图像裁剪

> ID：13983994
> 
> 赞同：1
> 
> 时间：2012-12-21T03:46:58.623
> 
> 标签：html, canvas, getimagedata

我正在做一个简单的图像裁剪，用户用鼠标在他们想要保留的区域周围画一条线。当他们确认后，图像的其余部分将被裁剪掉。以下是我目前处理上述裁剪的方式：

```
var data = c.getImageData(0,0,canvas.width,canvas.height);      
for (var x = 0; x < data.width; x++) {
   for (var y = 0; y < data.height; y++) {
      if (!c.isPointInPath(x,y)) {
         var n = x + (data.width * y);
         var index = n*4; 
         data.data[index+3] = 0;
      }
   }
} 
```

但是，这可能会很快陷入困境。您尝试保留的图像越少，运行速度就越快，但即使保存 30% 的图像（画布为 800x800）也会导致它挂起几秒钟。有没有更快的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T10:48:05.403

我真的不明白您为什么要深入研究像素细节来操纵裁剪图像功能。这是可以理解的，因为需要更多时间来裁剪图像的其余部分，因此图像越大，因为实际上在迭代二维像素数组时，操作所需的处理时间随着大小的增加呈指数增长像素图。

所以我的建议是尝试重新制作该功能，甚至不触及`getImageData`and`putImageData`功能。没用的。我会按照以下方式制作：

1.  获取 处的像素坐标`mouse down`。
2.  为`mouse move`.
3.  在原始图像上创建一个半透明图像，并使用该`fillRect`函数绘制到创建的画布中。
4.  为`mouse up`.
5.  获取 处的像素坐标`mouse up`。
6.  计算得到的正方形的坐标。
7.  使用正方形坐标作为参数将生成的图像绘制到画布中。
8.  作为最后一步，将画布的内容绘制到图像上。

这样，您将节省大量图像裁剪处理的开销。

这是一个供您参考的脚本：[https ://github.com/codepo8/canvascropper/blob/master/canvascrop.js](https://github.com/codepo8/canvascropper/blob/master/canvascrop.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T08:37:21.857

当您必须使用用户定义的形状时，没有真正的方法可以加快速度，但可以通过工人来处理陷入困境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T21:20:51.080

一些想法：

限制`getImageData`在用户绘制的多边形的边界框内。

Put`data.height`等`data.width`在变量的循环内使用。

也许您可以拆分内部/外部测试并设置`imagedata`alpha 值。

甚至可能将多边形绘制为黑白`imagedata`对象，然后得到两者之间的区别？

能分享一下`isPointInPath(x,y)`功能吗？

# mysql - 无法按字母顺序对mysql表行进行排序

> ID：13983996
> 
> 赞同：2
> 
> 时间：2012-12-21T03:47:13.623
> 
> 标签：mysql, sorting

我有一张表中的项目记录。这些项目是以字母和数字开头的记录的混合。我无法让它们正确排序（按字母顺序，顶部的数字）。这是我用来调用表格的内容。

```
SELECT * FROM `cog_name` ORDER BY `cog_name`.`name` ASC 
```

这不应该工作吗？我得到了大部分条目，顶部有数字，然后按字母顺序排列的记录在下面。**但是**，大约一半时，它开始按字母顺序“重新列出”另一组。

```
Example query result:
SELECT * FROM `cog_name` ORDER BY `cog_name`.`name` ASC
--------
name
--------
1 car
2 horse
3 rocket
apple
banana
carrot
1 car
2 horse
3 rocket
apple
banana
carrot 
```

与我的示例不同，条目都是唯一名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:24:47.393

您可以使用 TRIM 功能：

```
SELECT TRIM(name) FROM `cog_name` ORDER BY TRIM(name) ASC 
```

应该这样做！

# tsql - 是否可以将 6 列与不同的表、不同的数据库和不同的服务器联合起来？

> ID：13983997
> 
> 赞同：0
> 
> 时间：2012-12-21T03:47:34.900
> 
> 标签：tsql, sql-server-2005, union

是否可以将 6 列与不同的表、不同的数据库和不同的服务器联合起来？

**请告诉我这是否可能？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:54:13.773

如果您希望使用 SQL Server 查询不同服务器上的多个数据库，您应该查看链接服务器 >> [http://msdn.microsoft.com/en-us/library/ms188279.aspx](http://msdn.microsoft.com/en-us/library/ms188279.aspx)

一旦添加了所有需要访问的链接服务器，就可以像访问“本地”一样访问这些服务器上的表。然后你只需要担心性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T12:03:39.723

作为先前的答案，您需要链接服务器作为开始。

将服务器添加到执行查询的服务器后，您可以按如下方式运行查询

```
SELECT Field1 , field2
FROM   LINKED_SERVER1.DatabaseName.dbo.tableName_X

UNION ALL

SELECT Field1 , field2
FROM   LINKED_SERVER2.DatabaseName.dbo.tableName_Y 
```

您可以根据需要向联合中添加任意数量的表，只需遵循基本的 UNION 规则。即联合中的所有选择必须具有相同数量的字段和兼容的数据类型