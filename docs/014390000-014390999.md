# StackOverflow 问答 14390000-14390999

# javascript - 如何在复选框的 onclick 上删除事件侦听器，默认情况下应始终选中它

> ID：14390005
> 
> 赞同：1
> 
> 时间：2013-01-17T23:26:17.477
> 
> 标签：javascript

```
<div class="add-gift-message no-display" id="add-gift-options-86">
    <h3>Do you have any gift items in your order?</h3>
    <p>
        <input type="checkbox" name="allow_gift_options" id="allow_gift_options" value="1" onclick="toogleVisibilityOnObjects(this, ['allow-gift-options-container']);" class="checkbox" />
        <label for="allow_gift_options">Add gift options</label>
    </p>
</div>
<div class="gift-message-form" id="allow-gift-options-container">

<div class="inner-box">
        <div id="add-gift-options-for-order-86" class="no-display">
        <h4>Gift Options for the Entire Order</h4>
        <p>
            <input type="checkbox" name="allow_gift_messages_for_order" id="allow_gift_options_for_order" value="1" onclick="toogleVisibilityOnObjects(this, ['allow-gift-options-for-order-container']);" class="checkbox" />
            <label for="allow_gift_options_for_order">Add gift options for the Entire Order</label>
        </p>
    </div> 
```

如何在 id="add-gift-options-86" 的复选框的 onclick 上删除事件侦听器并且不选择复选框，具体取决于其他 id 为 ="allow_gift_options_for_order" 的复选框也可见，默认情况下应选中

# android - 一个Activity中有多个ListView，如何输入数据？

> ID：14390006
> 
> 赞同：0
> 
> 时间：2013-01-17T23:26:44.607
> 
> 标签：android, mysql, listview, textview

我正在开发一个 Activity 有 8 个 ListView 的 App，我需要分别在 MySql 中插入数据，我该怎么做？

ListView只显示数据，点击时没有动作，所以没有ListView会更好，也许是在TextView中输入数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:50:23.880

您应该决定显示数据的最佳方式。同一个活动中的 8 个列表视图对我来说听起来有点奇怪。在像平板电脑这样的设备中，它可能会没问题，但在像手机这样的小型设备上，它会非常难以处理。

如果你要显示大量数据，listview 是最好的选择。但如果只有一两个字符串，请使用文本视图。

反正。要在每个列表视图中显示数据，您应该为每个列表视图创建一个适配器。

祝你好运！

# mysql - 如何隐藏列？MySQL

> ID：14390007
> 
> 赞同：8
> 
> 时间：2013-01-17T23:26:45.230
> 
> 标签：mysql, sum, hide

我有一个我制作的代码，但我想隐藏该列。所以它只显示 storeID 而不是 SALARY。我知道我需要将它包裹在另一组括号中，但不知道在哪里做。还有谁能告诉我一种确定在哪里使用括号的技术？抱歉，对 MySQL 不太熟悉，但已经学习了几个星期了。刚刚用 Chen Notations 完成了图表，现在是代码。

```
SELECT storeID, SUM(SALARY) FROM STORE
JOIN EMPLOYEE
WHERE SALARY < expenditure; 
```

目前它正在显示：

```
| storeID | |    SUM(SALARY)    |
|    1    | |    £30000         |
|    2    | |    £25000         |
|    3    | |    NOTHING        | 
```

我希望隐藏第二列 SUM(SALARY)。提前致谢。

**编辑**：我不太清楚。我需要计算 SALARY（每个商店的所有工资的总和），并找到 SALARY < 支出的 storeID。

EMPLOYEE = SALARY STORE = storeID 和支出。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-17T23:29:04.157

```
SELECT StoreId
FROM
(
   SELECT storeID, SUM(SALARY) FROM STORE
   JOIN EMPLOYEE
   WHERE SALARY < expenditure
) 
```

这应该工作;）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-17T23:31:08.067

试试这个

```
 SELECT storeID  FROM STORE
    JOIN EMPLOYEE
    WHERE SALARY < expenditure; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-04T10:54:54.077

是的，你需要一个别名

```
SELECT x.name, x.branch
FROM (

SELECT person.name AS name, person.email, branch.name AS branch
FROM person
JOIN branch ON person.branch_id = branch.id
)x 
```

所以我用 x 命名我的查询块，即使你可以像 x 一样引用

```
x.name
x.branch 
```

# ruby-on-rails - Heroku run rake db:seed 坏了

> ID：14390008
> 
> 赞同：1
> 
> 时间：2013-01-17T23:26:51.407
> 
> 标签：ruby-on-rails, heroku, refinerycms

我正在使用带有自定义引擎的 Refinery CMS，但无法运行`heroku rake db:seed`. 似乎这导致我的应用程序在生产中中断。

在本地一切正常，但是当我尝试为我的数据库播种时，我得到了这个输出：

[https://gist.github.com/f90b545dc85c44addffd](https://gist.github.com/f90b545dc85c44addffd)

关于可能导致此问题的任何想法。这是我的seeds.rb 文件：

```
(Refinery.i18n_enabled? ? Refinery::I18n.frontend_locales : [:en]).each do |lang|
  I18n.locale = lang

  if defined?(Refinery::User)
    Refinery::User.all.each do |user|
      if user.plugins.where(:name => 'refinerycms-projects').blank?
        user.plugins.create(:name => 'refinerycms-projects',
                            :position => (user.plugins.maximum(:position) || -1) +1)
      end
    end
  end

  url = "/projects"
  if defined?(Refinery::Page) && Refinery::Page.where(:link_url => url).empty?
    page = Refinery::Page.create(
      :title => 'Projects',
      :link_url => url,
      :deletable => false,
      :menu_match => "^#{url}(\/|\/.+?|)$"
    )
    Refinery::Pages.default_parts.each_with_index do |default_page_part, index|
      page.parts.create(:title => default_page_part, :body => nil, :position => index)
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T16:18:27.443

为了解决这个问题，我需要`ruby '1.9.3'`在我的 gemfile 中指定。显然，这与将 Refinery CMS 应用程序部署到 Heroku 有关。

`ruby '1.9.3'`一旦我在我的 gemfile 中部署到 heroku，我就`heroku run rake db:seed`没有问题了。

更多信息在这里：

[https://groups.google.com/forum/?fromgroups=#!topic/refinery-cms/bvGsot-wFxc](https://groups.google.com/forum/?fromgroups=#!topic/refinery-cms/bvGsot-wFxc)

# python - 在 Python 中截断文件和登录

> ID：14390010
> 
> 赞同：1
> 
> 时间：2013-01-17T23:26:58.473
> 
> 标签：python, python-2.6

我正在编写一个脚本，需要从我们公司的数据库中删除大量电影/媒体文件。我正在 Mac 和 Python 环境中进行开发，这两种环境对我来说都是新的。我正在尝试使其尽可能具有弹性，因为它可能会破坏当前生产中的所有项目的数据库，而不是淘汰的旧项目。

想知道，如果有任何严重的逻辑缺陷，我是否正确登录等。以及任何其他建议，以使其尽可能健壮和谨慎，我们将不胜感激。

```
import os.path 
import shutil 
import datetime
import logging

root_path = "blah"
age_in_days = 2
truncate_size = 1024

class TruncateOldFiles():
    def delete_files(root_path):
        if os.path.exists(root_path):
            for dirpath, dirnames, filenames in os.walk(root_path):

                for file in filenames:
                    current_path = os.path.join(dirpath, file)
                    file_modified_time  = datetime.date(os.path.getmtime(current_path))

                    if ((datetime.datetime.now() - file_modified_time) > datetime.timedelta(days = age_in_days)):
                        count += 1

                if count == len(files) and not os.path.isfile("donotdelete.txt"):
                    for file in filenames:
                        try:
                            with open (file, 'w+') as file:
                                file.truncate(1024)

                            log()

                        except IOError:
                            pass

    def log():
        format = '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
        logging.basicConfig(filename='myapp.log', level=logging.INFO, format = format)
        logging.info('Starting to truncate all files...') 
```

此外，我只能在终端中编译它，但不太知道如何从中调试逻辑错误。我习惯于在 IDE 中使用 C++ 和 Java 进行编码，在这里我使用的 Xcode 似乎不利于我的开发风格。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T15:08:29.917

我不确定提到的数据库在哪里发挥作用，您似乎只是在处理文件系统中的文件名。

*   您正在使用`os.path.isfile()`它，我只会使用它来测试存在的东西是否是文件（而不是目录、链接等）。如果文件系统中不存在该名称，它会返回 False（我必须查一下），所以它可以工作。但我原以为它会引发 IOError。我的建议是`os.path.exists()`改用。

*   比较`date()`和时要小心`datetime()`，它们是不一样的。并`datetime()`从时间戳使用`.fromtimestamp`

*   我希望您意识到脚本总是在您启动脚本的目录中查找“donotdelete.txt”。`os.walk`不做`os.chdir`。如果这不是您想要的（并且`donotdelete.txt`通过在每个目录中设置一个不截断来保护某些特定目录，您应该测试`os.path.exists(os.path.join(dirpath, 'donotdelete.txt'))`

*   `len(files)`? 您的意思是`len(filenames)`，通过比较来查看目录中的所有文件是否足够旧`count`？

*   您在测试年龄的 for 循环中正确地构造了 a`current_path`和`dirpath`the 。`filename`在截断 for 循环中，您只需使用`file`，它将尝试在当前目录中打开。

*   你正在制作一个旧式课程，我总是会制作新式新[课程](http://docs.python.org/2/reference/datamodel.html#newstyle)：

    类 TruncateOldFiles(object): ....

*   您应该`self`在每个方法中都有参数，然后您可以调用`log`as `self.log()`，因为除非您这样做，否则您的代码将无法工作`TruncateOldFiles.log()`

*   我不确定日志中的格式信息是从哪里填写的。它写入（在更正了如何`log()`调用之后，只有`starting to truncate .....`每个文件的行才会被截断而没有额外的信息。

*   count 没有初始化，只是递增，你需要做`count = 0`

*   我会将根路径、天数和截断大小参数传递给类创建。后两者可能是默认值。

*   对于这种破坏性的不可逆操作，我在类创建中添加了一个参数，以便能够让它运行而无需执行任何操作，除了日志记录。也许这就是测试的`donotdelete.txt`目的，但它不会记录任何东西，所以你在日志中没有任何迹象表明程序会做什么。

*   对于许多类，我有一个详细的参数来帮助查找错误，这是用于交互式运行并且与日志不同

*   您有 1024 硬编码而不是使用 truncate_size，并且您正在打开和截断小于 truncate_size 的文件，这是不必要的。

*   您在 for 循环和 with 语句中都使用`file`（python 关键字）作为变量名，它可能有效，但它不是很好的样式，并且在您扩展 for 循环中的代码时必然会导致问题。

我的课更像（但`log()`仍需要修复）：

```
class TruncateOldFiles():
    def __init__(self, age_in_days=2, truncate_size=1024,
                 verbose=0, for_real=True):
        self._age = datetime.timedelta(days = age_in_days)
        self._truncate_size = truncate_size
        self._verbose = verbose
        self._for_real = for_real

    def delete_files(self, root_path):
        if not os.path.exists(root_path):
            if self._verbose > 1:
                print 'root_path', self._root_path, 'does not exists'
            return
        for dirpath, dirnames, filenames in os.walk(root_path):
            count = 0
            for filename in filenames:
                current_path = os.path.join(dirpath, filename)
                file_modified_time  = datetime.datetime.fromtimestamp(os.path.getmtime(current_path))
                if self._verbose > 0:
                    print file_modified_time, current_path
                if ((datetime.datetime.now() - file_modified_time) > self._age):
                    count += 1
            if count == len(filenames) and not os.path.exists(os.path.join(dirpath, "donotdelete.txt")):
                for filename in filenames:
                    current_path = os.path.join(dirpath, filename)
                    if os.path.getsize(current_path) <= self._truncate_size:
                        if self._verbose > 0:
                            print 'not big enough:', current_path
                        continue
                    try:
                        if self._verbose > 0:
                            print 'truncating:', file
                        if self._for_real:
                            with open (current_path, 'w+') as fp:
                                fp.truncate(self._truncate_size)
                        self.log()
                    except IOError:
                        pass

    def log(self):
        format = '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
        logging.basicConfig(filename='myapp.log', level=logging.INFO, format = format)
        logging.info('Starting to truncate all files...') 
```

以及测试它的代码：

```
tof = TruncateOldFiles(verbose=1, for_real=False)
tof.delete_files('blah') 
```

# php - PHP不解析wordpress rss feed

> ID：14390011
> 
> 赞同：0
> 
> 时间：2013-01-17T23:27:02.047
> 
> 标签：php, wordpress, rss

我已经在 SO 上阅读了关于这个主题的十几篇文章，所有这些文章都提到了我没有的空白问题，并且提要验证器同意我的提要没问题（http://feedvalidator.org/check.cgi ?url=http%3A%2F%2Fgearmunk.com%2Fblog%2Ffeed%2F)

我正在使用以下代码来解析 rss：

```
<?php
$rss = new DOMDocument();
$rss->load('http:/gearmunk.com/blog/feed/');
$feed = array();
foreach ($rss->getElementsByTagName('item') as $node) {
$item = array ( 
'title' => $node->getElementsByTagName('title')->item(0)->nodeValue,
'desc' => $node->getElementsByTagName('description')->item(0)->nodeValue,
'link' => $node->getElementsByTagName('link')->item(0)->nodeValue,
'date' => $node->getElementsByTagName('pubDate')->item(0)->nodeValue,
);
array_push($feed, $item);
}
$limit = 3;
for($x=0;$x<$limit;$x++) {
$title = str_replace(' & ', ' &amp; ', $feed[$x]['title']);
$link = $feed[$x]['link'];
$description = $feed[$x]['desc'];
$date = date('l F d, Y', strtotime($feed[$x]['date']));
echo '<p><strong><a href="'.$link.'" title="'.$title.'">'.$title.'</a></strong><br />';
echo '<small><em>Posted on '.$date.'</em></small></p>';
echo '<p>'.$description.'</p>';
}
?> 
```

但是如果你查看[http://gearmunk.com/index3.php](http://gearmunk.com/index3.php)你会看到，在右边，它列出了 3 个错误的日期并且没有 rss 数据。如果我输入另一个提要 URL，它就可以正常工作，如果我将我的 rss 提要放入 Google 阅读器，它就可以正常工作。我希望我缺少一些愚蠢的简单东西。有人可以帮忙吗？

谢谢，埃里克

更多信息：

我开始专注于它是一个 wordpress 问题，所以我尝试了一些其他的 wordpress RSS 提要。来自 CNN 的一个工作正常（http://religion.blogs.cnn.com/feed/），但是来自 BoingBoing（也是一个 WP 网站）的一个不起作用：[http](http://boingboing.net/feed) ://boingboing.net/feed 。

我没有收到通常与空白问题相关的 XML Parse 错误，所以我不认为是这样。

埃里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:01:30.757

尝试改变

```
$rss->load('http:/gearmunk.com/blog/feed/'); 
```

到以下（注意额外的 / ）

```
$rss->load('http://gearmunk.com/blog/feed/'); 
```

通过该更改，代码似乎按预期运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-24T15:43:46.203

我知道这是一个老问题，但我在尝试解决我自己的 WordPress RSS 提要问题时遇到了它。就我而言，我错过了 PHP XML 扩展。

所以我跑了 `apt-get install php7.0-xml`（我在 Ubuntu 上运行 PHP v7.0，检查你的 php 版本），重新启动了我的服务器，它完全解决了我的问题！

对于 PHP 7 上的 CentOS / Fedora / Red Hat：

```
yum install php70w-xml 
```

希望这对某人有帮助！

# objective-c - osx，使tableview可重新加载

> ID：14390015
> 
> 赞同：0
> 
> 时间：2013-01-17T23:27:32.947
> 
> 标签：objective-c, macos, tableview, nsarraycontroller, reloaddata

我还有一个简单的问题，我自己无法解决。我有两个xib。main.xib 用于用户输入，result.xib 用于结果。Xib2 在 input-xib 上按下按钮时启动。按钮操作（在 AppDelegate.m 中）：

```
- (IBAction)pushRun:(id)sender {

    if (!rwc)
    {
        rwc = [[ResultWindowController alloc] init];
    }
    [rwc setValueArray:[toDoItemArrayController arrangedObjects]];
    [rwc setNumberOfCalculations:[NSNumber numberWithInt:[_inputNumberOfCalculations intValue]]];
    [rwc calculateResults]; //starts method in 2nd-window controller for result calculation

    [rwc showWindow:self]; 
} 
```

`rwc`是`WindowController`进行计算并显示 result.xib ( `ResultWindow`)：

结果窗口控制器.h：

```
#import <Cocoa/Cocoa.h>

@interface ResultWindowController : NSWindowController{

    NSArray *valueArray;
    NSMutableArray *resultArray;
    NSNumber *numberOfCalculations;
}

@property (nonatomic, retain, readwrite) NSArray *valueArray;
@property (retain) NSNumber *numberOfCalculations;
@property (nonatomic, retain, readwrite) NSMutableArray *resultArray;

-(void)calculateResults;

@end 
```

结果窗口控制器.m：

```
#import "ResultWindowController.h"
#import "ResultItem.h" //my result model

@implementation ResultWindowController
@synthesize valueArray, resultArray, numberOfCalculations;

- (id)init
{
    if(![super initWithWindowNibName:@"ResultWindow"])
    return nil;
    return self;
}

-(void)awakeFromNib
{

}

- (void)windowDidLoad
{
    [super windowDidLoad];
}

- (void)calculateResults
{
    //a lot of calculation code ...

    ResultItem *newResult = [[ResultItem alloc]init];

    [newResult setValue:[nameArray objectAtIndex:i] forKey:@"name"];
    [newResult setValue:[NSNumber numberWithDouble:avg] forKey:@"averageValue"];
    [newResult setValue:[NSNumber numberWithDouble:min] forKey:@"minValue"];
    [newResult setValue:[NSNumber numberWithDouble:max] forKey:@"maxValue"];
    [newResult setValue:dimensionRandomArray forKey:@"randomArray"];

    [resultArray addObject:newResult]; 

} 
```

结果被放入模型对象并收集在`resultArray`. 现在它会变得有趣（至少对我来说）：

1.  通过BindingInspector`resultArray`作为内容绑定到`NSArrayController`
2.  这`NSArrayController`是 result.xib 的一部分
3.  result.xib 有一个`tableview`（没有自己的类或视图控制器）
4.  列`tableview`绑定到中`NSArrayController`使用的通过键值 `resultArray`

当 result.xib 窗口启动时，一切正常。`tableview`按预期显示内容。但！当我对 input.xib 进行更改并再次按下操作按钮时`tableview`，结果.xib 没有更新。我检查了`resultArray`内容（通过 NSLog），它得到了所有的新值，所以工作正常。

我的问题在哪里？

我读了很多，`[tableView reloadData]`但我不知道如何实际设置代码和必要的绑定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:57:53.987

不要将对象添加到数组中，而是将 IBOutlet 添加到数组控制器中，然后使用该方法`addObject:`将对象添加到表视图中。

# magento - 取消预授权过期的 Magento 订单

> ID：14390017
> 
> 赞同：0
> 
> 时间：2013-01-17T23:27:42.453
> 
> 标签：magento, magento-1.7, authorize.net

我的 Magento 网站中有一些超过 30 天的订单，因此 authorize.net 预授权已过期。当我去取消订单时，它尝试提交 pre-auth void 但由于原始交易不再存在而失败。有没有办法手动覆盖这个无效程序并在这种状态下简单地取消订单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-16T21:20:44.523

在需要时一次性完成这些取消的一种简单方法是：

1) 从 Magento 的订单中获取 Auth.net 交易 ID。它应该在订单底部的评论历史中显示。

2) 在 sales_payment_transaction 表 > txn_id 字段中搜索该交易 ID

3) 一旦你在 mySQL 中找到了记录（如果你有 phpMyAdmin 会很有帮助），那么只需将该记录的 txn_id 清空即可。

4) 回到 Magento 管理员，您现在可以取消订单，因为它知道不要尝试返回 Auth.net 取消订单。

** 或者，您可以通过 URL 中的订单 ID 轻松找到记录，并在同一个表中找到它。例如：

```
https://www.yourdomain.com/store/index.php/backend/sales_order/view/order_id/6957/key/4c16ff2bfed4b496670be4747sdjhdfd6/ 
```

它是 order_id: 6957 在数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T00:09:33.050

看一看 @

> /app/code/core/Mage/Paygate/Model/Authorizenet.php

为您的支付模块打开调试以查看`$result->getResponseCode()`过期交易的结果。一旦你弄清楚结果（代码/错误代码）是什么，你就可以创建一个新的“案例”来模仿`case self::RESPONSE_CODE_APPROVED:`

还要看看@ $this->_isTransactionExpired($realAuthTransactionId) 看看为什么它没有捕捉到你的过期交易。

```
protected function _voidCardTransaction($payment, $card)
{
    $authTransactionId = $card->getLastTransId();
    $authTransaction = $payment->getTransaction($authTransactionId);
    $realAuthTransactionId = $authTransaction->getAdditionalInformation($this->_realTransactionIdKey);

    $payment->setAnetTransType(self::REQUEST_TYPE_VOID);
    $payment->setXTransId($realAuthTransactionId);

    $request= $this->_buildRequest($payment);
    $result = $this->_postRequest($request);

    switch ($result->getResponseCode()) {
        case self::RESPONSE_CODE_APPROVED:
            if ($result->getResponseReasonCode() == self::RESPONSE_REASON_CODE_APPROVED) {
                $voidTransactionId = $result->getTransactionId() . '-void';
                $card->setLastTransId($voidTransactionId);
                return $this->_addTransaction(
                    $payment,
                    $voidTransactionId,
                    Mage_Sales_Model_Order_Payment_Transaction::TYPE_VOID,
                    array(
                        'is_transaction_closed' => 1,
                        'should_close_parent_transaction' => 1,
                        'parent_transaction_id' => $authTransactionId
                    ),
                    array($this->_realTransactionIdKey => $result->getTransactionId()),
                    Mage::helper('paygate')->getTransactionMessage(
                        $payment, self::REQUEST_TYPE_VOID, $result->getTransactionId(), $card
                    )
                );
            }
            $exceptionMessage = $this->_wrapGatewayError($result->getResponseReasonText());
            break;
        case self::RESPONSE_CODE_DECLINED:
        case self::RESPONSE_CODE_ERROR:
        if ($result->getResponseReasonCode() == self::RESPONSE_REASON_CODE_NOT_FOUND
            && $this->_isTransactionExpired($realAuthTransactionId)
        ) {
          .....

public function canVoid(Varien_Object $payment)
{
    if ($this->_isGatewayActionsLocked($this->getInfoInstance())) {
        return false;
    }
    return $this->_isPreauthorizeCapture($this->getInfoInstance());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-15T15:22:08.990

对于仍在寻找如何取消授权已过期的订单的任何人。通过将交易的 is_cloased 值更改为 1（是）来更新 sales_payment_transaction 的数据库记录。在浏览器中查看交易时，您将需要订单 ID 和交易 ID，您都可以从 URL 中获取它们。

https//magento.com/admin/sales_transactions/view/ **txn_id/11111** / **order_id/55555** /

```
$collection = Mage::getModel('sales/order_payment_transaction')
->getCollection()
->addAttributeToFilter('order_id', '11111')
->addAttributeToFilter('txn_id', '55555');

foreach ($collection as $col) {
    if ($col->getId()){
        $col->setIsClosed(1)->save();
    }
} 
```

您还可以通过 phpMyAdmin 打开 sales_payment_transaction 并为您的订单查找带有 order_id 和 txn_id 的行来更新该值。

一旦 is_closed 值设置为 1，您现在应该可以取消订单，因为它告诉系统授权已关闭，并且不要尝试取消已在授权点网上过期的授权

# javascript - 在 Chrome 扩展中使用 AngularJS

> ID：14390018
> 
> 赞同：3
> 
> 时间：2013-01-17T23:28:01.583
> 
> 标签：javascript, google-chrome-extension, angularjs

我想在 Chrome 扩展程序中使用 AngularJS，但出现如下错误：

```
Error: SECURITY_ERR: DOM Exception 18
Error: An attempt was made to break through the security policy of the user agent.
    at new listConnection 
```

**清单.json：**

```
 {
  "name": "Chrome auditor connection",
  "version": "1",
  "icons": { "48": "icone.png",
            "128": "icone.png" },
  "description": "Chrome-auditor-connection is an extension for Google Chrome browser. It ensures that nobody connects to your browser with your profile.",
  "background": {
    "scripts": [
      "chrome_ex_oauthsimple.js",
      "chrome_ex_oauth.js",
      "background.js"
    ]
  },
  "browser_action": {
    "default_title": "Chrome auditor connection",
    "default_icon": "icone.png",
    "default_popup": "index.html"
  },
  "permissions": [
    "storage"
  ],
  "web_accessible_resources": ["index.html"],
  "sandbox": {
     "pages": ["index.html","index.js","angular.min.js"]
  },
  "manifest_version": 2
} 
```

**index.js：**

```
function listConnection( $scope) {      
    $scope.connections = JSON.parse(localStorage['connectionHistory']);
} 
```

我认为 JSON.parse() 被 Chrome“内容安全策略”（CSP）阻止。

你有什么解决办法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T07:56:17.837

您的 index.js 已按照 manifest.json 文件中的定义进行沙盒处理。
“[沙盒](https://developer.chrome.com/extensions/manifest.html#sandbox)页面将无法访问扩展程序或应用程序 API”
因此它无法访问本地存储。
删除沙箱或使用类似[https://github.com/jamesmortensen/chrome-sandbox-storageAPI](https://github.com/jamesmortensen/chrome-sandbox-storageAPI)的东西来处理沙箱页面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T07:24:59.090

有两个答案给你：

1.  添加`ng-csp`到您的`<html>`标签，像这样`<html ng-csp ng-app="AngularAppName">`。看到这个[答案](https://stackoverflow.com/questions/11108679/possible-to-use-angularjs-for-a-chrome-extensions-options-page)
2.  将此行添加到`manifest.json`文件

`"content_security_policy": "script-src 'self' 'unsafe-eval'; object-src 'self' "`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T10:50:51.773

# 代码中的问题

这些是我到目前为止看到的代码共享的一些问题！

*   你`index.html`被用作`default_popup`,`web_accessible_resources`和 in `sandbox Pages`。它在功能上不正确，您要开发什么？
*   为什么要放在`angular.min.js`沙盒位置？
*   `index.js`由 使用，如果是`index.html`，则无需明确列出。
*   存储是每个域的对象，`localstorage`与沙盒和其他页面不同。

# android - Android 应用的安装方式与 adb 和 sdcard 不同

> ID：14390019
> 
> 赞同：1
> 
> 时间：2013-01-17T23:28:21.657
> 
> 标签：android, android-manifest, apk, adb

我的应用程序遇到的一个问题是它没有恢复到最近的活动。我添加了

```
android:alwaysRetainTaskState="true" 
```

到 AndroidManifest.xml。它修复了调试模式的问题，但在我为发布模式构建时却没有。有点。

如果我通过将发布 APK 下载到手机的 sdcard 并从那里安装来安装应用程序，则存在上述错误。如果我通过 adb 安装完全相同的 APK，则该错误不存在。这适用于 Android 4.0 之前和之后的设备。

有任何想法吗？因为我太迷失了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T18:16:14.990

您是否直接从安装程序启动应用程序（安装后安装程序会询问您是否要启动应用程序）。如果是这样，这是你的问题。安装程序启动的应用程序处于一种奇怪的状态，这是一个令人讨厌的长期存在的错误。如果您随后使用 HOME 按钮返回 HOME 屏幕，然后返回您的应用程序，Android 会愉快地再次启动您的应用程序的根 Activity :-(

有关此错误的更多详细信息，请参阅[http://code.google.com/p/android/issues/detail?id=26658](http://code.google.com/p/android/issues/detail?id=26658) 许多人已经为这个问题苦苦挣扎了好几天 :-( 请为问题加注星标以提高认识。

该错误存在于所有设备上，在所有版本的 Android 上（至少到 ICS，尚未在 JellyBean 上测试）。这一切都在模拟器中正常工作，因此您不能将模拟器行为用作真实设备行为的指示。

可以在[http://code.google.com/p/android/issues/detail?id=2373#c21找到针对此问题的简单解决方法](http://code.google.com/p/android/issues/detail?id=2373#c21)

# jquery - 对象 [对象对象] 没有方法“可排序”

> ID：14390025
> 
> 赞同：0
> 
> 时间：2013-01-17T23:28:45.103
> 
> 标签：jquery, jquery-ui, backbone.js

我有一个使用本地存储和 jquery ui 的骨干网/rails 应用程序。我在一个 Rails 3.2.8 应用程序上开发它，让它工作，然后将代码复制到我在服务器上使用的应用程序（也是 Rails 3.2.8），但在我将它推送到服务器之前，我测试了它本地主机。奇怪的是，它不适用于发往服务器的 Rails 应用程序。只有一个 jQuery ui 方法导致我在新应用程序上出现问题，引发此错误。

```
Object [object Object] has no method 'sortable' 
```

当我从下面的渲染函数中注释掉可排序代码时，应用程序运行良好两个应用程序中的 jQuery 版本相同（1.8）与 jQuery ui 版本（1.9.2）相同（主干版本也相同）。我检查了这两个应用程序的页面源，并且文件以相同的顺序加载。虽然原始应用程序适用于 Chrome 和 Firefox，**但一个转折是我在 Safari 中的两个应用程序上都遇到了相同的错误**。我清除了每个浏览器中的缓存。代码包含在这个`$(function(){ });`

```
$(function() {

    ...ommitted code...

       window.App = new AppView();

}); 
```

但是，我也尝试在应用程序视图的初始化周围放置文档就绪代码，但它没有改变任何东西

```
$(document).ready(function() {

       window.App = new AppView();
}); 
```

鉴于上述情况（以及下面的代码），两者都不能在 Safari 中正常工作，但原始应用程序在 Chrome 和 Firefox 中工作（而另一个不能）这一事实是否表明您可以指导我到任何可能的问题区域......先感谢您

**sortable 所在的渲染函数**

```
 render: function() {
            $(this.el).html(this.template(this.model.toJSON()));
             this.setText();
             var that = this;
             console.log(this.$("ul.bucket-companies"));
             this.$("ul.bucket-companies").sortable({
             dropOnEmpty: true,
             connectWith: "ul.bucket-companies",
             receive: function(event, ui) {
              var bucket = that.model;
              var id = $(ui.item[0]).attr("id");
              var company = Companies.get(id);
              var oldBucket = company.getBucket();

             company.setBucket(bucket.id);
             oldBucket.removeCompany(company.id);
             bucket.addCompany(company.id);
            }
           });
              return this;
            }, 
```

**更新。**

这是渲染函数中的 console.log 显示的`console.log(this.$("ul.bucket-companies"));`

```
[ul.bucket-companies, prevObject: i.fn.i.init[1], context: li.bucket-item, selector: "ul.bucket-companies", constructor: function, init: function…]
0: ul.bucket-companies
context: li.bucket-item
length: 1
prevObject: i.fn.i.init[1]
selector: "ul.bucket-companies"
__proto__: Object[0]
 feng.js:87 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:24:02.807

该问题通过在`rake assets:precompile`发往服务器的 Rails 应用程序上再次执行来解决（当应用程序减去这个主干组件，最初被推送到服务器时，它已经预编译过一次）。虽然我打算在推送时再次编译资产，但令我惊讶的是，后续预编译对于在推送之前在本地主机上测试新代码是必要的。我猜想，编译一次，然后添加更多的 javascript（包括 jQuery UI）而不编译第二次，以一种不友好的方式混合在一起。

# linux - 查看列表中出现的每个文件名的文件内容

> ID：14390026
> 
> 赞同：0
> 
> 时间：2013-01-17T23:28:48.693
> 
> 标签：linux, shell, unix

我正在使用以下命令创建文件名列表：

```
ls | grep "\.txt$" 
```

我得到一个文件列表：

```
F1.txt
F2.txt
F3.txt
F4.txt 
```

我想查看这些文件的内容（使用less/more/cat/...）

有没有办法通过敲击来做到这一点？

（顺便说一句，我使用更复杂的命令获得了文件名列表，这只是一个更简单的说明示例）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:30:53.123

这够了吗？

```
$ cat *txt 
```

对于更丰富的查询，您可以使用`find`and `xargs`：

```
$ find . -name "*txt" | xargs cat 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T23:34:21.923

你可以尝试这样的事情：

```
#!/bin/bash

for i in *.txt
do
  echo Displaying file $i ...
  more  $i
done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T23:40:01.647

关于什么：

```
cat $(ls | grep "\.txt$") 
```

# jquery - jQuery：slideUp 在动画之前扩展元素

> ID：14390031
> 
> 赞同：0
> 
> 时间：2013-01-17T23:29:21.043
> 
> 标签：jquery

火狐：[jsFiddle](http://jsfiddle.net/vol7ron/Pbz3Z/)

我不确定这是否只是我的设置，但在 Firefox 中，在动画开始之前似乎有一点高度跳跃。

JavaScript：

```
window.run = function(){
var $alert = $('.alert').clone();                                    // Store for another run
var maxSize = 0;

$('#start-size').html($('.alert').height());                         // Default start size

$('.alert').slideUp({
  duration:1500,
  step: function(){ 
    var _height=$(this).height();
    if (_height>maxSize) {
      maxSize = _height;
      $('#max-size').html(maxSize);
    }
  },
  complete: function(){
    $(this).remove();
    setTimeout(function(){$('.container').append($alert);},1000);   // Reset for another run
  }
}); 
```

};

HTML：

```
<button onClick="run()">Slide Up</button>  
<div class="container">
  <div class="content alert">
    Alert! Hide
  </div>
</div>
<div>Start Size: <span id="start-size"></span></div>
<div>Max Size: <span id="max-size"></span></div> 
```

CSS：

```
.container { border:1px solid black; margin:20px; padding: 5px; }
.content { border:1px solid #900; height:20px; padding:5px; }
.alert { background: #c99; color: #900; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:33:11.680

似乎如果您在动画之前设置最大高度，它将修复它。

```
var $alert = $('.alert');
$alert.css('max-height',$alert.height()).slideUp({...}); 
```

但是，我还没有找到为什么会这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T02:59:12.637

尝试为 height 属性设置动画，而不是使用该`slideUp()`方法。

# javascript - RegExp 选择除某些字符之外的所有字符

> ID：14390032
> 
> 赞同：-1
> 
> 时间：2013-01-17T23:29:27.533
> 
> 标签：javascript, regex

我有一个短语，其中可能包含 0 个或多个嵌入字符串，如下所示：“这是 0lsdkfjl0MY 1lsdkfjl0SENTENCE”。这些嵌入字符串的模式与表达式匹配：(?:0|1)lsdkfjl(?:0|1|2|3|4)。我需要将除与模式匹配的字符之外的所有字符都转换为小写。我怎样才能做到这一点？那是在 JavaScript 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:33:35.370

您可以使用捕获组和替换功能：

```
str.replace(/[^dontmatch]+/g, function(match) {
    return match.toLowerCase();
}); 
```

这是一个例子：

```
> 'ADFGXYZ'.replace(/[^AD]+/g, function(match) { return match.toLowerCase(); });
"ADfgxyz" 
```

# jquery - 如何在同一行发布 1 个表单和 1 个其他值编码？

> ID：14390034
> 
> 赞同：0
> 
> 时间：2013-01-17T23:29:59.380
> 
> 标签：jquery, ajax

如何在同一行发布 1 个表单和 1 个其他值编码？

谢谢。

```
$.ajax({
    type: "POST",
    url: "...",
    data: $('.form').serialize(), & id = 10, // not work
    success: ....

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T23:34:34.967

```
$.ajax({
    type: "POST",
    url: "...",
    data: $('.form').serialize()+'&id = 10',
    success: ....

}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T23:37:37.763

您也可以单独发送该值。

```
$.ajax({
    type: "POST",
    url: "...",
    data: {form : $('.form').serialize(),id: '10'},
    success: ....

}); 
```

# php - Codeigniter 2.1 - 多语言插入

> ID：14390035
> 
> 赞同：1
> 
> 时间：2013-01-17T23:30:08.913
> 
> 标签：php, codeigniter, codeigniter-2

我需要用两种语言将数据插入数据库，我有点进退两难（数据需要以两种语言存在）。让用户同时插入两种语言的数据更好，还是让用户先插入一种语言然后再插入第二种语言更好？如果后者更好，那么最有效的方法是什么？我如何展示所有未以两种语言插入的文章？

文章的数据库结构：

所有文章的公用表（相同数据）：

```
**article -> id_article | image | date_created | category_id | subcategory_id** 
```

数据不同的表：

**`article_info -> article_id | name | text | lang_id`**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T23:43:03.320

如果数据*必须*以两种语言存在——即，应用程序假设如果一个项目以一种语言存在，那么它必须以另一种语言存在——那么你应该设计你的应用程序，以便用户必须同时添加它们。

当您执行数据库写入时，您还应该使用事务。这将确保您的所有写入都成功，或者它们都不成功。它可以防止数据库处于不确定状态，其中包含一种语言的记录而不是另一种语言的记录。

查看有关事务的[CodeIgniter 手册页](http://ellislab.com/codeigniter/user-guide/database/transactions.html)，了解它们的工作原理。

您还可以使用`insert_batch`数据库类中的方法一次插入两条记录。我不知道它如何与所有数据库驱动程序一起工作，但是当您使用 mysqli 驱动程序时，它将生成一个查询`insert_batch`，因此整个插入将成功或整个插入将失败，类似于事务中发生的情况。也就是说，我仍然会将调用包装`insert_batch`在一个事务块中，只是为了有点偏执和面向未来。

# javascript - 从 Javascript 访问 HTML 元素

> ID：14390038
> 
> 赞同：0
> 
> 时间：2013-01-17T23:30:21.000
> 
> 标签：javascript, html, jsp

我有以下 HTML 代码

```
<input type="text" readonly name="Name" class="GadgetName" placeholder="Please Enter the Gadget Name" value="Potatoe Masher" />
<input type="text" readonly name="Description" class="GadgetDescription" placeholder="Please Enter the Gadget Description" value="You'll Never Stop Mashing !" />
<form action="SubmitComment" method="POST">
    <div class="Comment">
        <textarea rows="4" cols="200" name="Comment" class="GadgetComment" id="Comment2" placeholder="Write Comments Here"></textarea>
        <input type="button" value="Submit Comment" class="CommentButton" onclick="AddComment()" />
    </div><br />
</form> 
```

我需要访问只读文本框中`Name`的文本和文本区域中的`Comment`文本。

请注意，这些行位于 for 循环中，因此有多个具有相同类名的组件。

我设法`Comment`使用此代码获取 textarea 中的值

```
$(document).ready(function(){
    $(document).on("click", ".CommentButton", function(){
        text = $("textarea", $(this).parent()).val();
    });
}); 
```

我现在需要的是访问文本框中的`Name`文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:44:31.320

这是你如何做到的。

```
$(document).ready(function () {
  $('.CommentButton').click(function () {
    console.log($(this).closest('form').parent().find('[name="Name"]').val());
    console.log($(this).parent().find('[name="Comment"]').val());
  });
}); 
```

[您也可以在实际操作](http://jsfiddle.net/NsVKW/7/ "jsFiddle")中进行尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:49:01.330

您可以通过两种方式做到这一点：

1.  从使用输入名称..

    ```
    $(document).ready(function () {

    $(document).on("click", ".CommentButton", function () {   
        text    =   $("textarea", $(this).parent()).val();
        var name = $("input[name='Name']").val();
        var description = $("input[name='Description']").val();
       });
    }); 
    ```

或者

2 通过使用类名：

```
 $(document).ready(function () {

    $(document).on("click", ".CommentButton", function () {   
        text    =   $("textarea", $(this).parent()).val();
        var name = $(".GadgetName").val();
        var description = $(".GadgetDescription").val();
       });
    }); 
```

JsFiddle：http: [//jsfiddle.net/KZ9hx/1/](http://jsfiddle.net/KZ9hx/1/)

# php - 解析错误：语法错误，意外的 T_ECHO

> ID：14390041
> 
> 赞同：0
> 
> 时间：2013-01-17T23:30:25.087
> 
> 标签：php

我正在学习 PHP，我正在尝试执行此代码，但它向我显示此消息“解析错误：语法错误，意外 T_ECHO”

```
<?php
include "../conexao.php";

$sql = mysql_query("SELECT vale_alimentacao FROM usuario WHERE  id=1");
$ln = mysql_fetch_array($sql);
$vale_alimentacao = $ln['vale_alimentacao'];

$total_diario = 0.0;
$contador = 0.0;

$sql = mysql_query("SELECT id, data, valor_almoco, bebida FROM vale_alimentacao WHERE 1=1");
while($ln = mysql_fetch_array($sql))
{
            $contador = 0.0;

            if($ln['valor_almoco'] < 8.0)
                $contador = $ln['valor_almoco'];
            else if($ln['valor_almoco'] > 8.0 && $ln['valor_almoco'] < 13.0)
                $contador = 8.0;
            else
                $contador = ($ln['valor_almoco']-8.0);´

            echo $contador;

            $total_diario += $contador;
?> 
```

任何人都可以帮助我吗？这是语法错误，但我不知道在哪里。拥抱

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:32:20.393

删除`´`行中的

```
$contador = ($ln['valor_almoco']-8.0);´ 
```

要调试此类错误，请查看错误消息中的行号。它有助于。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:32:00.843

```
$contador = ($ln['valor_almoco']-8.0);´ 
```

结尾有`。

# php - 我的数组值在 php 中不断消失和刷新？

> ID：14390042
> 
> 赞同：2
> 
> 时间：2013-01-17T23:30:33.133
> 
> 标签：php

我希望能够使用函数向名为播放列表的数组添加新值（这是强制性的）。但是每次我输入另一个值时，它都会替换旧值，而不仅仅是添加到数组的末尾。怎么了？

```
<?php

$playlist = array("Be more.mp3", "Drift Away.mp3", "Panda Sneeze.mp3");

function add_songs_playlist() {

global $playlist;
?>

<form method = "post">
<input type = "text" name = "name1"/>
<input type = "submit" name = "submit1"/>
</form>

<?php

if (isset($_POST['submit1'])) {
$newsong = $_POST['name1'];
array_push($playlist, $newsong);

}
}

add_songs_playlist();

foreach ($playlist as $value) {

echo $value."<br>";
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T23:35:15.517

PHP 值不会在请求之间保存。每次加载此页面时，都会`$playlist`从您分配的相同三个值开始。

如果您想将数据保存更长时间，则需要将其保存在某个地方——cookie、文件、会话、数据库等。

或者，您可以将值存储在 HTML 本身中，方法是`<input type="hidden">`为播放列表中的每首歌曲打印一个。然后当用户输入一首新歌时，你会得到新歌加上所有旧歌的完整列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T23:59:01.143

只需将播放列表写入文件

```
<?php
    if (isset($_POST['submit1'])) {
        $song = "\n".$_POST['name1'];
        $file = fopen("songs.txt", 'a');
        fwrite($file, $song);
        fclose($file);
    }

    $file = file("songs.txt");
    foreach ($file as $song) {
        echo $song . "</br>";
    }
?>

<form method = "post">
<input type = "text" name = "name1"/>
<input type = "submit" name = "submit1"/>
</form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T23:37:20.653

你犯了一个普遍的错误：

您必须了解，每次以您的方式传输值时，您的 php 脚本都会再次启动。它重新启动，上次没有留下任何东西。

为了能够以您希望的方式接管值，您必须在将这些值推送到数组后以持久方式存储它们。在下一次运行期间，您首先必须从该持久存储中读取现有值，填充数组，然后才能在该数组顶部添加另一个值。这是一般原则，是这种框架工作的基本方式。

通常，数据库用作持久存储，但文件也可能很有趣，具体取决于您计划处理的请求数量和数据量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T00:06:11.867

这是您的代码的一个小模型。我删除了该函数并将您的数组存储在表单本身中。

这个可以在服务器上不存储任何信息的情况下工作，我敢打赌，我认为它不会很有用。您应该像@Anonymous 在之前的回复中建议的那样存储您的内容。

**工作代码：**

```
<?php

// First check if I get a POST request with list of songs
if (isset($_POST['playlist'])) {
    $playlist = $_POST['playlist'];
} else { // Else set my default list
    $playlist = array("Be more.mp3", "Drift Away.mp3", "Panda Sneeze.mp3");
}

// You need to get the added son BEFORE you generate the FORM,
// so it can be a part of the form
if (isset($_POST['name1'])) {
    $playlist[] = $_POST['name1'];
}

?>
<form method = "post">

<?php
// This loop stores your songs as hidden values within the form,
// so you will get them with your next post
foreach($playlist as $song) {  
?>
<input type = "hidden" name = "playlist[]" value = "<?php echo $song?>">
<?php
}
?>
<input type = "text" name = "name1"/>
<input type = "submit" name = "submit1"/>
</form>

<?php

foreach ($playlist as $value) {
    echo $value."<br>";
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-17T23:34:48.147

特定于您的转发代码的示例是：

```
if (isset($_POST['submit1'])) {
$newsong = $_POST['name1'];
$playlist[] = $newsong;

} 
```

还有一个错误可能是你的表单在一个函数中......为什么不这样做

```
<?php
$playlist = array("Be more.mp3", "Drift Away.mp3", "Panda Sneeze.mp3");
?>

<form method = "post">
<input type = "text" name = "name1"/>
<input type = "submit" name = "submit1"/>
</form>

<?php

if (isset($_POST['submit1'])) {
$newsong = $_POST['name1'];
 $playlist[] = $newsong;
}

foreach ($playlist as $value) {

echo $value."<br>";
}
?> 
```

我不确定您是否关心页面是否刷新。但是，如果您对页面刷新没问题，这应该可以。如果您不想刷新，您可以将变量保存在 javascript 中并在其中进行工作，然后使用表单按钮 onClick 作为函数调用。或者，如果您想在 PHP 中使用您的变量以便在不刷新的情况下重置您的 php 变量，您需要进行 AJAX 调用以回调 JSON 以更新您的 PHP 变量。

# c++ - C++ 对非类类型成员的请求

> ID：14390043
> 
> 赞同：0
> 
> 时间：2013-01-17T23:30:49.013
> 
> 标签：c++

我有一个简单的程序。主要由我的教授提供。我们要编写 3 个函数，称为`enter`, `simplify`, `display`。

主要的

```
#include <iostream>
using namespace std;
// #include "fraction.h"

struct Fraction {
    int numerator;
    int denominator;
};

void enter(struct Fraction* fraction);
void simplify(struct Fraction* fraction);
void display(struct Fraction fraction);

int main() 
{
    struct Fraction fraction;
    cout << "Fraction Simplifier" << endl;
    cout << "===================" << endl;
    enter(&fraction);
    //simplify(&fraction);
    //display(fraction);
}

void enter(struct Fraction* fraction) {
    cout << "Numerator:     " << endl;
    cin >> *fraction.numerator; // the line that doesn't work, line 31
}

void simplify(struct Fraction* fraction) {}
void display(struct Fraction fraction) {} 
```

错误：

```
w2.cpp:31:19: error: request for member ânumeratorâ in âfractionâ, which is of non-class type âFraction*â 
```

有问题的线路

```
void enter(struct Fraction* fraction) {
    cout << "Numerator:     " << endl;
    cin >> *fraction.numerator; // the line that doesn't work, line 31
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T23:32:35.130

您有[运算符优先级](http://en.cppreference.com/w/cpp/language/operator_precedence)问题。这个表达

```
*fraction.numerator; 
```

被解析为

```
*(fraction.numerator); 
```

尝试这个

```
(*fraction).numerator; 
```

或这个

```
fraction->numerator; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T23:32:49.740

你有一个操作顺序问题。你要：

```
cin >> (*fraction).numerator 
```

或者更惯用的说法：

```
cin >> fraction->numerator; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T23:35:14.320

您遇到运算符优先级（`* Operator`和`. Operator`）的问题，[参考链接](http://en.wikipedia.org/wiki/Operators_in_C_and_C++)

你可以试试：

```
cin >> fraction->numerator; 
```

或者

```
cin >> (*fraction).numerator; 
```

或者更好的方法是将 Fraction 的引用传递给`enter`,`simpilfy`和`display`，例如：

```
void enter(Fraction& fraction)
{
  cout << "Numerator:     " << endl;
  cin >> fraction.numerator;
}
void simplify(Fraction& fraction);
void display(const Fraction& fraction); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T23:37:23.720

一元的`operator*`优先级很低，因此表达式的操作顺序将在它之前发生。为了解决这个问题，我们将部分括在括号中以指定顺序：

```
(*fraction).number 
```

这种方式`fraction`首先被取消引用，然后我们可以访问作为结果返回的对象。

# css - 使用响应式 Twitter Bootstrap 内容重叠水平表单的问题

> ID：14390045
> 
> 赞同：9
> 
> 时间：2013-01-17T23:30:53.693
> 
> 标签：css, forms, twitter-bootstrap, responsive-design

我花了更多的时间来尝试修复这个愚蠢的错误。我有一个显示在某些内容左侧的表单。在宽屏和窄屏上看起来都不错，但在平板电脑宽度上（它覆盖在 770 和 950 左右之间），右侧的内容与表单域重叠。

我是否在我的标记中遗漏了一些东西才能正确使用 Twitter Bootstrap，或者我是否需要使用断点添加一些自定义样式来修复它？似乎固定像素宽度导致了 bootstrap.css 中定义的问题。由于我使用的是流体响应布局，这些宽度属性不应该使用 % 吗？![在此处输入图像描述](../Images/d1a901422ab64f0a1903f135c6343f27.png)

```
<div class="container-narrow">
  <div class="content">
    <div class="row-fluid">
      <div class="span5">
        <form class="form-horizontal" id="applies-Step1-form" action="/" method="post">
          <div class="control-group">
            <label class="control-label required" for="Step1_email">Email <span class="required">*</span></label>
            <div class="controls">
              <input size="60" maxlength="255" name="Step1[email]" id="Step1_email" type="text" />
            </div>
          </div>

          <div class="control-group">
            <label class="control-label required" for="Step1_home_zip">Home Zip <span class="required">*</span></label>
            <div class="controls">
              <input size="5" maxlength="5" name="Step1[home_zip]" id="Step1_home_zip" type="text" />
            </div>
          </div>
        </form>
      </div>

      <div class="span7">
        <div class="promo-btm">
          <h2>Heading 2</h2>
          <ul class="checks">
            <li>Bullet One</li>
            <li>Bullet Two</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div> 
```

请参阅随附的错误截图，或者您可以使用我的[fiddle](http://jsfiddle.net/yR7Ap/1/)自己重现它。

如果有人可以帮助指出解决此问题的方法，我将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T00:04:01.953

只需为您的输入元素添加一个宽度，这样它们就可以响应您的所有屏幕尺寸。`.span12`您可以在输入元素上使用诸如宽度之类的东西，这应该可以解决问题：

**HTML**

```
<div class="container-narrow">
  <div class="content">
    <div class="row-fluid">
      <div class="span5">
        <form class="form-horizontal" id="applies-Step1-form" action="/" method="post">
          <div class="control-group">
            <label class="control-label required" for="Step1_email">Email <span class="required">*</span></label>
            <div class="controls">
              <input class="span12" size="60" maxlength="255" name="Step1[email]" id="Step1_email" type="text" />
            </div>
          </div>

          <div class="control-group">
            <label class="control-label required" for="Step1_home_zip">Home Zip <span class="required">*</span></label>
            <div class="controls">
              <input class="span12" size="5" maxlength="5" name="Step1[home_zip]" id="Step1_home_zip" type="text" />
            </div>
          </div>
        </form>
      </div>

      <div class="span7">
        <h2>Heading 2</h2>
        <ul class="checks">
          <li>Bullet One</li>
        </ul>
      </div>
    </div>
  </div>
</div> 
```

演示：http: [//jsfiddle.net/yR7Ap/18/](http://jsfiddle.net/yR7Ap/18/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:30:59.390

其他帖子已查明问题的根本原因，即您的表单对于具有默认引导 css 的 span5 div 来说太宽了

不过，让它合身并不难。看看这是否有帮助：http: [//jsfiddle.net/panchroma/FXXaZ/](http://jsfiddle.net/panchroma/FXXaZ/)

我已经用这个 CSS 收紧了你的表单：

```
/* pull control label left */
.form-horizontal .control-label {
width:70px; /* default 160 */
}

/* pull input box left */
.form-horizontal .controls {
margin-left: 90px; /* defaul 180 */
}

/* shorten input box  */
input, textarea, .uneditable-input {
width: 180px; /* default 206 */
} 
```

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T23:53:46.587

您的表单对于 .span5 列来说太宽了。尝试在上面添加：

```
<div class="row-fluid">
  <div class="span5">hello</div>
  <div class="span7">world</div>
</div> 
```

并添加以下样式：

```
.row-fluid > div { outline: 5px solid green; } 
```

你会明白我的意思。

# web-services - 重复的肥皂请求

> ID：14390047
> 
> 赞同：1
> 
> 时间：2013-01-17T23:31:03.043
> 
> 标签：web-services, weblogic11g

我们正在从 升级`10.0`到`10.3.6`. 我们的 Web 应用程序在 DMZ 中运行，并使用`.jar`由 clientgen 创建的文件`JAX-RPC`通过 XML 防火墙调用部署在我们内部网络上的 Web 服务操作。我的问题是 XML 防火墙的行为就好像调用 Web 服务操作的 HTTP 请求被发送了两次，而据我所知，它只发送了一次。我设置了以下属性来查看肥皂流量：

```
-Dweblogic.wsee.verbose=*
-Dweblogic.log.RedirectStdoutToServerLogEnabled=true 
```

不幸的是，我无法访问 XML 防火墙，但我已经能够获取我的服务端点的完整日志。我可以看到它报告收到重复的请求，但对于我来说，我不知道这是怎么发生的。当 Web 服务客户端在 version 上运行时，不会发生这种情况`10.0`。

我已经尝试了我能想到的一切来解决这个问题。我希望这里有人可以提供一些建议，或者告诉我这是否是一个已知问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T04:17:55.860

您可以使用[TCP Monitor](http://ws.apache.org/commons/tcpmon/tcpmontutorial.html)拦截服务器和防火墙之间**的 SOAP 流量。**

通过这种方式，您可以判断请求是否被发送两次，或者防火墙是否存在内部问题。

此外，在您拦截请求后，您可以再次使用 TCP Monitor 或[SOAP UI](http://www.soapui.org/)重新发送请求以模拟 Web 服务器并调试防火墙。

# jquery - HTML - 如何连接区域标签

> ID：14390054
> 
> 赞同：1
> 
> 时间：2013-01-17T23:31:34.057
> 
> 标签：jquery, imagemap, area, areas

如何使脚本将两个不同的区域标签解释为一个？

比如我这里有一张肌肉图

[小提琴](http://jsfiddle.net/MV6Ue/1/)

```
<img src="http://www.ise-dvp.narod.ru/atletics/images/man2.gif" class="atlas" alt="muscles" usemap="#Navigation">

        <map id="Navigation" name="Navigation">

  <area shape="poly" coords="88,265,74,266,65,257,57,226,64,199,75,182,87,181,102,198,106,214,100,240,97,251,86,261,80,263,85,262" href="#"  alt="muscle1">
  <area shape="poly" coords="123,269,108,237,108,208,114,196,126,183,139,181,145,194,152,218,154,233,152,254,146,272,139,279,120,275,121,267" href="#"  alt="muscle2">

        </map>

$(document).ready(function ()
        {
            $('.atlas').maphilight();
        }); 
```

使用 maphilight.js 在鼠标悬停时选择区域。我需要选择大腿肌肉（两条腿），但它只选择一个。我的其他肌肉也有同样的问题。我想在鼠标悬停时同时选择它们。

是否可以合并 2 个区域标签或让 maphilight.js 选择 2 个标签作为一个标签？

请帮忙=）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:49:02.813

您需要在区域标签中添加一些属性并将其添加到默认功能选项中，例如：

```
<area shape="poly" coords="88,265,74,266,65,257,57,226,64,199,75,182,87,181,102,198,106,214,100,240,97,251,86,261,80,263,85,262" href="#"  alt="muscle1" group="thigh">
<area shape="poly" coords="123,269,108,237,108,208,114,196,126,183,139,181,145,194,152,218,154,233,152,254,146,272,139,279,120,275,121,267" href="#"  alt="muscle2" group="thigh"> 
```

JS：

```
$.fn.maphilight.defaults = {
    ...
    groupBy: 'group',
    .... 
```

它们的属性`group="thigh"`相同，因此它们都将在悬停时突出显示。

见[小提琴](http://jsfiddle.net/Fu3ad/)

# python - 使用已验证数据的具有依赖关系的 web2py 验证器

> ID：14390055
> 
> 赞同：0
> 
> 时间：2013-01-17T23:31:38.490
> 
> 标签：python, web2py

web2py 一书的 [表单和验证器一章中提供了这个](http://web2py.com/books/default/chapter/29/07#Validators-with-dependencies)*具有依赖关系*的验证器示例。

```
def index():
    form = SQLFORM.factory(
        Field('username', requires=IS_NOT_EMPTY()),
        Field('password', requires=IS_NOT_EMPTY()),
        Field('password_again',
              requires=IS_EQUAL_TO(request.vars.password)))
    if form.process().accepted:
        pass # or take some action
    return dict(form=form) 
```

依赖`password_again`基于从表单接收到的密码字段的原始输入 - `request.vars.password`。

添加基于表单中已验证数据的验证器的最简洁方法是什么，例如`form.vars.pasword`？

我正在考虑在验证过程中可能对字段中的值进行清理的情况（例如，转为大写，去除前导空格，附加校验位）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:37:11.767

在这种情况下，请使用[`onvalidation`函数](http://web2py.com/books/default/chapter/29/07#onvalidation)。

# android - 单声道机器人模态弹出窗口

> ID：14390058
> 
> 赞同：2
> 
> 时间：2013-01-17T23:31:43.543
> 
> 标签：android, android-activity, xamarin.android, monodevelop

我想知道如何（如果可能的话）在单声道中为 droid 应用程序创建一个模态弹出窗口。

场景：应用程序与客户托管的 Web 服务器进行通信（因此该位置将因客户而异）。要使用该应用程序，用户必须指定其 Web 服务器的连接字符串。因此，当应用程序启动并遇到主要活动时，我要做的第一个任务是检查设备应用程序设置中是否设置了连接字符串。如果不是，我想抛出一个简单的模式弹出窗口，允许用户指定与其服务器的连接。

我真的不想开始正常的活动，因为用户将能够单击后退按钮并返回主菜单，并且应用程序处于无效状态，因为它不知道要与哪个服务器通信。

关于我如何解决这个问题的任何想法？

或者我应该构建活动链，以便在第一个活动中输入连接字符串，以便如果他们点击返回，它实际上会退出应用程序？

我有点困惑。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:21:52.513

这是可能的`AlertDialog`。它可以使用列表、复选框、是/否按钮和自定义视图创建简单输入对话框。

[Xamarin Sample Repository](https://github.com/xamarin/monodroid-samples/blob/master/ApiDemo/App/AlertDialogSamples.cs)中有一个用于不同类型对话框的示例，在底部您可以找到一个添加了包含用户名和密码字段的自定义视图的示例。

所以首先定义你想要放入的自定义视图`AlertDialog`。`alert_dialog_connection_entry.xml`并且是`Layout`：

在您的活动中的某处添加代码：

```
var connection_string_view = LayoutInflater.Inflate(Resource.Layout.alert_dialog_connection_entry, null);

var builder = new AlertDialog.Builder(this);
builder.SetTitle("Connection String");
builder.SetView(connection_string_view);
builder.SetPositiveButton("OK", OkClicked);
builder.SetNegativeButton("Cancel", CancelClicked);
builder.Create();
builder.Show(); 
```

为按钮添加一些处理程序：

```
private void CancelClicked(object sender, DialogClickEventArgs dialogClickEventArgs)
{
    //Todo
}

private void OkClicked(object sender, DialogClickEventArgs dialogClickEventArgs)
{
    var dialog = sender as AlertDialog;

    if (null != dialog)
    {
        var connectionEdit = dialog.FindViewById(Resource.Id.connectionstring_edit) as EditText;

        if (null != connectionEdit)
            Console.WriteLine("Connection String: {0}", connectionEdit.Text);
    }
} 
```

应该是这样的。您应该能够在对话框中放置任何类型的自定义视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:16:09.450

如果您只想显示一个模式弹出窗口让用户放置他们的连接字符串，您可以试试这个。

首先，您需要对对话框的呈现方式有一个简单的布局。在这种情况下，`TextView`显示“连接字符串：”之类的内容并`EditText`让用户放置连接字符串可能就足够了。

然后，您可以将此代码放在您的某个位置`MainActivity`，例如在检查应用程序设置或类似内容之后。

```
 var builder = new AlertDialog.Builder(this);
        var view = LayoutInflater.Inflate(Resource.Layout.ModalDialog, null);
        builder.SetView(view);
        string connectionString = view.FindViewById<EditText>(Resource.Id.ConnectionString).Text;
        AlertDialog alert = builder.Create();
        alert.SetCancelable(false);    //This prevents the dialog from being dismissed by either hit back button or hit out side of the dialog
        alert.SetButton("OK", (s,e)=> ToDo(connectionString));    //Now you have the connection string, to do whatever you want.
        alert.Show(); 
```

正如您所说，替代方法可能是允许用户在第一个屏幕中指定连接字符串。这也是一个很好的方法。我假设你知道怎么做，所以我没有在这里发布代码。

# cocos2d-iphone - cocos2d：鼠标经过时改变CCMenuItemImage？

> ID：14390062
> 
> 赞同：2
> 
> 时间：2013-01-17T23:32:07.337
> 
> 标签：cocos2d-iphone, mouseover, ccmenuitem, ccmenu

有谁知道当鼠标经过 CCMenuItem 时，一种简单的方法可以为它设置动画。

我读过这个线程：

[选择时的 Cocos2d CCMenuItem 动画](https://stackoverflow.com/q/10475623/1443375)

这似乎涵盖了 Cocoa Touch，但不适用于 OS X。

cocos2d参考列出了CCMenuItemImage的这个方法：我是这样使用的：

```
CCMenuItem *beginButtonMenuItem = [CCMenuItemImage itemWithNormalImage:@"BeginButton3.png" 
                                                     selectedImage:@"BeginButtonSel3.png"
                                                            target:self
                                                        selector:@selector(beginButtonPressed:)]; 
```

但是，当鼠标经过时，该菜单项不会通过更改图像来响应，只有在单击时才会响应。

CCMenuItem 参考有这个方法：

*   (void) selected，说明“该项目被选中（未激活），类似于“鼠标悬停””

但没有示例代码...

任何人都可以帮助实现这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-01T02:09:59.927

我发现当鼠标经过状态时很容易对状态进行任何`CCMenu`更改，从而使其具有悬停效果。首先，确保您已设置`CCMenuItem``selected``[window_ setAcceptsMouseMovedEvents:YES];`

然后将此函数添加到`CCMenu.m`（可能就在`ccMouseDragged`定义之后）：

```
- (BOOL) ccMouseMoved:(NSEvent *)event {
  if( ! _visible || ! _enabled)
    return NO;

  CCMenuItem *currentItem = [self itemForMouseEvent:event];
  if(!currentItem) {
    if(_highlightedItem != _selectedItem) {
      [_highlightedItem unselected];
    }
    [_highlightedItem release];
    _highlightedItem = nil;
    return NO;
  }

  if (currentItem != _highlightedItem) {
    [_highlightedItem unselected];
    _highlightedItem = currentItem;
    [_highlightedItem retain];
    [_highlightedItem selected];
  }

  return YES;
} 
```

# joomla - 如何在 joomla 中向注册用户隐藏菜单项

> ID：14390065
> 
> 赞同：0
> 
> 时间：2013-01-17T23:32:25.667
> 
> 标签：joomla

我正在使用 joomla 1.5.23，我想要隐藏菜单项以注册/登录用户。我可以向公众隐藏菜单项，但反过来想要它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:37:08.830

上面的答案完全相反，我找到了一个使用 metamod for joomla 的解决方案。在这里，您可以向注册者隐藏并向公众展示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T06:35:30.550

在`joomla1.5`中，您可以更改菜单的访问级别。

通过以下路径更改权限。

**管理员 => 菜单 => 主菜单（菜单类型）=> 选择任何菜单 => 将访问级别检查为已注册，然后单击保存按钮。**

以下菜单仅适用于*注册*用户。

# java - Android AlarmManager 警报不工作

> ID：14390070
> 
> 赞同：0
> 
> 时间：2013-01-17T23:32:46.823
> 
> 标签：java, android, alarmmanager, alarm

我正在尝试制作一个简单的警报触发器。当警报响起时，应该有一个简单的声音警报。但是警报没有响起，什么也没有发生。现在我不确定我在哪里弄错了 - 是时代吗？意图？接收器？

我在其中使用 AlarmManager 的类

```
package com.example.prva;

import java.text.DateFormat;
import java.util.Calendar;
import java.util.Date;

import android.app.Activity;
import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.Intent;
import android.os.Bundle;
import android.os.Handler;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.widget.TimePicker;

public class Meni_Splash extends Activity{  
    Calendar c = Calendar.getInstance();
    private int hour = c.get(Calendar.HOUR_OF_DAY);
    private int minute = c.get(Calendar.MINUTE);
    int milivreme;
    int milipicker;
    long sveskupa;
    int hoursad;
    int minutesad;
    protected boolean timeactive = true;
    Handler h=new Handler();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);             
        h.post(new Runnable(){
            @Override
            public void run() {
                String currentDateTimeString = DateFormat.getDateTimeInstance().format(new Date());
                TextView text = (TextView) findViewById(R.id.textDate);
                text.setText(currentDateTimeString);
                h.postDelayed(this, 1000);
            }
        });     

        final TimePicker picker = (TimePicker) findViewById(R.id.timePicker);
        final TextView text = (TextView) findViewById(R.id.texttime);

        picker.setIs24HourView(true);       
        picker.setCurrentHour(hour);
        picker.setCurrentMinute(minute);

        Button btnt = (Button) findViewById(R.id.buttontime);       

        btnt.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                hoursad = picker.getCurrentHour();
                minutesad = picker.getCurrentMinute();
                milipicker = (((hoursad) * 60 * 60 * 1000) + ((minutesad) * 60 * 1000));
                text.setText(new StringBuilder().append(hoursad).append(":").append(minutesad).append( "Trenutno vrijeme u milisekundama : ").append(System.currentTimeMillis()).append(" vrijeme izabrano u milisekundama sve skupa ").append(milipicker));
            }
        });

        Button btnalarm = (Button) findViewById(R.id.btnalarm);
        btnalarm.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                hoursad = picker.getCurrentHour();
                minutesad = picker.getCurrentMinute();
                milivreme = (((hour)* 60 * 60 * 1000)+ ((minute) * 60 * 1000));     
                milipicker = (((hoursad) * 60 * 60 * 1000) + ((minutesad) * 60 * 1000));
                sveskupa = milipicker - milivreme;

                Intent intent = new Intent(Meni_Splash.this, AlarmReceiver.class);
                PendingIntent pendingintent = PendingIntent.getActivity(Meni_Splash.this, 2, intent, PendingIntent.FLAG_CANCEL_CURRENT);

                AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);
                am.set(AlarmManager.RTC_WAKEUP, System.currentTimeMillis() + sveskupa, pendingintent);                      

            }
        });

        Button btnv = (Button) findViewById(R.id.buttonv);
        btnv.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                startActivity(new Intent(Meni_Splash.this, button.class));              
            }
        });             
    }   
} 
```

警报接收器类：

```
package com.example.prva;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;

public class AlarmReceiver extends Activity {
    protected MediaPlayer MPAlarm;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        MPAlarm = MediaPlayer.create(this, R.raw.splash);
        MPAlarm.start();
    }

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-12T05:37:28.320

您应该在清单上注册您的 AlarmReceiver：

```
<receiver android:process=":remote" android:name="com.yourpackage.AlarmReceiver" android:enabled="true" ></receiver> 
```

不要忘记放置 android:process=":remote" 以使其工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:57:22.860

看起来 AlarmManager set() 函数中存在问题。

警报管理器设置（） =>

public void set（int类型，long triggerAtMillis，PendingIntent操作）

参数类型 ELAPSED_REALTIME、ELAPSED_REALTIME_WAKEUP、RTC 或 RTC_WAKEUP 之一。triggerAtMillis 警报应该响起的毫秒时间，使用适当的时钟（取决于警报类型）。operation 警报响起时执行的操作；通常来自 IntentSender.getBroadcast()。

请注意，操作 (PendingIntent) 将从 IntentSender.getBroadcast() 获取操作。希望它有帮助。

# mysql - MYSQL 查询：如何获取每个类别的值？

> ID：14390072
> 
> 赞同：0
> 
> 时间：2013-01-17T23:32:51.270
> 
> 标签：mysql, sql

我有一个巨大的表，其中包含数百万条按时间戳存储股票值的记录。结构如下：

```
Stock, timestamp, value

goog,1112345,200.4

goog,112346,220.4

Apple,112343,505

Apple,112346,550 
```

我想按时间戳查询这张表。如果时间戳匹配，则应返回所有相应的股票记录，如果没有该时间戳的股票记录，则应返回前一个股票。在上面的例子中，如果我通过 timestamp=1112345 查询，那么查询应该返回 2 条记录：

```
 goog,1112345,200.4

  Apple,112343,505 (immediate previous record) 
```

我尝试了几种不同的方法来编写此查询，但没有成功，我确定我遗漏了一些东西。有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:41:22.220

```
SELECT `Stock`, `timestamp`, `value`
FROM `myTable`
WHERE `timestamp` = 1112345
  UNION ALL
SELECT `Stock`, `timestamp`, `value`
FROM `myTable`
WHERE `timestamp` < 1112345
ORDER BY `timestamp` DESC
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:42:19.460

我不认为有一个简单的方法来做这个查询。这是一种方法：

```
select tprev.*
from (select t.stock,
             (select timestamp from t.stock = s.stock and timestamp <= <whatever> order by timestamp limit 1
             ) as prevtimestamp
      from (select distinct stock
            from t
           ) s
    ) s join
    t tprev
    on s.prevtimestamp = tprev.prevtimestamp and s.stock = t.stock 
```

这是获取记录的前一个或相等的时间戳，然后将其重新加入。如果您在（股票，时间戳）上有索引，那么这可能会相当快。

它的另一个措辞使用`group by`：

```
select tprev.*
from (select t.stock,
             max(timestamp) as prevtimestamp
      from t
      where timestamp <= YOURTIMESTAMP
      group by t.stock
    ) s join
    t tprev
    on s.prevtimestamp = tprev.prevtimestamp and s.stock = t.stock 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T23:39:08.380

`select Stock, timestamp, value from thisTbl where timestamp = ?`并填写时间戳到它应该是什么？您的演示查询可[在此小提琴上找到](http://sqlfiddle.com/#!2/aece0/2/0)

# c# - 验证两个 XML 模式的兼容性

> ID：14390077
> 
> 赞同：0
> 
> 时间：2013-01-17T23:33:32.423
> 
> 标签：c#, xml, f#, xsd

是否有 .NET 调用来验证一个 XML 模式是否与另一个模式向后兼容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T13:42:37.040

不，您必须使用`XmlSchema`该类来解析两个模式，然后编写进行比较的代码。

XML 比较/差异不会削减它，因为两个 XSD 甚至可以相同并且具有非常不同的 XML 表示 - 例如：

```
<xs:schema targetNamespace="http://tempuri.org/XMLSchema.xsd"
    elementFormDefault="qualified"
    xmlns="http://tempuri.org/XMLSchema.xsd"
    xmlns:mstns="http://tempuri.org/XMLSchema.xsd"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:element name="test">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="str" type="xs:string"/>
      </xs:sequence>
      <xs:attribute name="num" type="xs:int"/>
    </xs:complexType>
  </xs:element>

</xs:schema> 
```

和

```
<xs:schema targetNamespace="http://tempuri.org/XMLSchema.xsd"
    elementFormDefault="qualified"
    xmlns="http://tempuri.org/XMLSchema.xsd"
    xmlns:mstns="http://tempuri.org/XMLSchema.xsd"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:element name="test" type="test">
  </xs:element>

  <xs:complexType name="test">
    <xs:sequence>
      <xs:element name="str" type="xs:string"/>
    </xs:sequence>
    <xs:attribute name="num" type="xs:int"/>
  </xs:complexType>

</xs:schema> 
```

# r - 线性预测器 - 有序概率（序数，clm）

> ID：14390080
> 
> 赞同：2
> 
> 时间：2013-01-17T23:33:46.580
> 
> 标签：r, package, ordinal

我有一个关于功能`ordinal`包`R`或具体功能的问题`predict.clm()`。我想计算`linear predictor`一个`ordered probit`估计值。使用 MASS 包的 polr 函数，可以通过 object$lp 访问线性预测器。它为我提供了每条线的价值，并且与我所理解的线性预测器即 X_i'beta 一致。但是，如果我使用`predict.clm(object, newdata,"linear.predictor")`带有 clm() 的有序概率估计，我会得到一个包含元素 eta1 和 eta2 的列表，

1.  如果 newdata 包含因变量，则每列一列
2.  如果 newdata 不包含因变量，则每个元素包含与因变量中的级别一样多的列

不幸的是，我不知道这意味着什么。同样在作者的文档和论文中，我没有找到任何关于它的信息。你们中的一个人会很好地启发我吗？这会很棒。

干杯，

AK

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T13:03:52.060

**更新（评论后）：**

基本`clm`模型是这样定义的（详见[clm 教程](http://cran.r-project.org/web/packages/ordinal/vignettes/clm_tutorial.pdf)）：

![](../Images/dc18f0968d00c858da8a500e8e5a0342.png)

生成数据：

```
library(ordinal)
set.seed(1)
test.data = data.frame(y=gl(4,5),
                       x=matrix(c(sample(1:4,20,T)+rnorm(20), rnorm(20)), ncol=2))
head(test.data) # two independent variables 
test.data$y     # four levels in y 
```

构建模型：

```
fm.polr <- polr(y ~ x) # using polr
fm.clm  <- clm(y ~ x)  # using clm 
```

现在我们可以访问`thetas`and `betas`（见上面的公式）：

```
# Thetas
fm.polr$zeta # using polr
fm.clm$alpha # using clm
# Betas
fm.polr$coefficients # using polr
fm.clm$beta          # using clm 
```

获得线性预测变量（仅`theta`公式右侧没有的部分）：

```
fm.polr$lp                                                 # using polr
apply(test.data[,2:3], 1, function(x) sum(fm.clm$beta*x))  # using clm 
```

新数据生成：

```
# Contains only independent variables
new.data <- data.frame(x=matrix(c(rnorm(10)+sample(1:4,10,T), rnorm(10)), ncol=2))
new.data[1,] <- c(0,0)  # intentionally for demonstration purpose
new.data 
```

有四种类型的预测可用于`clm`模型。我们对 感兴趣`type=linear.prediction`，它返回一个包含两个矩阵的列表：`eta1`和`eta2`。它们包含每个观测值的线性预测变量`new.data`：

```
lp.clm <- predict(fm.clm, new.data, type="linear.predictor")
lp.clm 
```

**注 1：** `eta1`和`eta2`字面上相等。第二个只是在索引中旋转`eta1`1 。`j`因此，它们分别打开了线性预测量表的左侧和右侧。

```
all.equal(lp.clm$eta1[,1:3], lp.clm$eta2[,2:4], check.attributes=FALSE)
# [1] TRUE 
```

**注2：**第一行的预测`new.data`等于`thetas`（只要我们将此行设置为零）。

```
all.equal(lp.clm$eta1[1,1:3], fm.clm$alpha, check.attributes=FALSE)
# [1] TRUE 
```

**注 3：**我们可以*手动*构建这样的预测。例如，第二行的预测`new.data`：

```
second.line <- fm.clm$alpha - sum(fm.clm$beta*new.data[2,])
all.equal(lp.clm$eta1[2,1:3], second.line, check.attributes=FALSE)
# [1] TRUE 
```

**注 4：**如果`new.data`包含响应变量，则`predict`仅返回指定水平的线性预测变量`y`。我们可以再次手动检查它：

```
new.data$y <- gl(4,3,length=10)
lp.clm.y <- predict(fm.clm, new.data, type="linear.predictor")
lp.clm.y

lp.manual <- sapply(1:10, function(i) lp.clm$eta1[i,new.data$y[i]])
all.equal(lp.clm.y$eta1, lp.manual)
# [1] TRUE 
```

# python - 如何最好地对 SciPy 稀疏矩阵进行行缩放？

> ID：14390082
> 
> 赞同：4
> 
> 时间：2013-01-17T23:33:55.370
> 
> 标签：python, scipy, sparse-matrix

我有一个 SciPy 稀疏矩阵`A`，比如说 CSR 格式，以及一个`v`匹配长度的向量。

行缩放的最佳方式是什么`A`，`v`即执行 `diag(v) * A`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:21:13.373

简单的方法是让 scipy 处理血淋淋的细节，只需执行以下操作：

```
scipy.sparse.spdiags(v, 0, len(v), len(v)) * A 
```

**编辑**如果（且仅当）您的矩阵以 CSC 格式存储时，您可以按如下方式进行操作：

```
A_csc.data = A_csc.data * v[A_csc.indices] 
```

我做了一些计时，很大程度上取决于矩阵的稀疏性及其大小，请随意使用以下代码：

```
from __future__ import division
import numpy as np
import scipy.sparse as sps
import timeit

A_csr = None
A_csc = None
v = None

def time_row_scaling(n, dens) :
    global A_csr, A_csc, v
    v = np.random.rand(n)
    A_csr = sps.rand(n, n, density=dens, format='csr')
    A_csc = A_csr.tocsc()
    def row_scale(A_csc, v) :
        A_csc.data = A_csc.data * v[A_csc.indices]
    row_scaled_1 = sps.spdiags(v, 0, n , n) * A_csr
    row_scaled_2 = sps.spdiags(v, 0, n , n) * A_csc
    row_scale(A_csc, v)
    if n < 1000 :
        np.testing.assert_almost_equal(row_scaled_1.toarray(),
                                       row_scaled_2.toarray())
        np.testing.assert_almost_equal(row_scaled_1.toarray(),
                                       A_csc.toarray())
    A_csc = A_csr.tocsc()
    t1 = timeit.timeit('sps.spdiags(v, 0, len(v) , len(v)) * A_csr',
                       'from __main__ import sps, v, A_csr',
                       number=1)
    t2 = timeit.timeit('sps.spdiags(v, 0, len(v), len(v)) * A_csc',
                       'from __main__ import sps, v, A_csc',
                       number=1)
    t3 = timeit.timeit('A_csc.data = A_csc.data * v[A_csc.indices]',
                       'from __main__ import A_csc, v',
                       number=1)
    print t1, t2, t3

>>> time_row_scaling(1000, 0.01)
0.00100659830939 0.00102425072673 0.000231944553347
>>> time_row_scaling(1000, 0.1)
0.0017328105481 0.00311339379218 0.00239826562947
>>> time_row_scaling(10000, 0.01)
0.0162369397769 0.0359325217874 0.0216837368279
>>> time_row_scaling(10000, 0.1)
0.167978350747 0.492032396702 0.209231639536 
```

总结似乎是，如果是CSR，或者真的很大，就用简单的第一种方法。如果它是一个很小的、非常稀疏的矩阵，那么就地方法会更快，尽管那时所有的时间都很小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-14T00:48:37.537

sklearn 在`sklearn.utils.sparsefuncs.inplace_csr_row_scale`. 在我的实验中，这稍微优于 Jaime 建议的方法和`csr_matrix.multiply`方法。请注意，我的实验是在非常大的矩阵上进行的 - 形状约为 10^7 x 10^4。对于这种大小的矩阵，sklearn 大约需要 2 秒；其他方法的范围为 2.5-5 秒。

但是，我发现*到目前为止*，实现这一点的最高效方法是使用提供的[mkl_?csrmultcsr](https://software.intel.com/en-us/node/468640)方法和对角矩阵连接到 MKL。

不提供这样做的代码，因为我的包装器仍然存在太多错误，但是对于与上面使用的相同大小的矩阵，这会在大约 0.3 秒内执行重新缩放。

也许有一天 numpy/scipy 将连接到 MKL 进行稀疏数学，就像他们为密集数学所做的那样......

# mysql - 为什么我在 WHERE 选择中遇到这个简单的 JOIN 问题（使用 int）？

> ID：14390085
> 
> 赞同：0
> 
> 时间：2013-01-17T23:34:01.580
> 
> 标签：mysql

```
SELECT `userlist`.`patient_id` , `results`.`patient_id` , `results`.`result` , `userlist`.`login_id`
FROM `userlist`
JOIN `results` ON `userlist`.`patient_id` = `results`.`patient_id`
WHERE `userlist`.`login_id` = `7555555`
COLLATE utf8_general_ci 
```

问题在于...

```
WHERE `userlist`.`login_id` = `7555555` 
```

我试过了`(7555555)`，`"7555555"`和`'7555555'`。

缺少一些东西，我很难过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:37:14.370

试试这个没有任何小票

```
 WHERE `userlist`.`login_id` = 7555555 
```

编辑：

换个地方

```
 COLLATE utf8_general_ci
     WHERE `userlist`.`login_id` = 7555555 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:51:39.097

得到它的工作......

```
SELECT `userlist`.`patient_id` , `results`.`patient_id` , `results`.`result` , `userlist`.`login_id`
FROM `userlist`
JOIN `results` ON `userlist`.`patient_id` = `results`.`patient_id`
COLLATE utf8_general_ci
WHERE `login_id` =7269715 
```

让我知道这是否有意义，否则回答改进，我会给你。

# php - Github API List all repositories and repo's content

> ID：14390090
> 
> 赞同：32
> 
> 时间：2013-01-17T23:34:27.220
> 
> 标签：php, javascript, github, github-api

If I was to go about displaying just MY github repositories and their contents on an external website how would i go about doing this? Are there any source code's you can provide me with, if not point me in the right direction? I'm quite a beginner to programming so any help is appreciated. Thank you everyone. Taking a glance at their website

I glanced over relevant links- but still have no clue how I would accomplish this.

[-Github List all Repo's](http://developer.github.com/v3/repos/#list-all-repositories)

[-Github List all Repo content](http://developer.github.com/v3/repos/contents/)

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-02T00:08:19.070

all of the previous answers are great. however if you are looking for a quick and dirty example of how to get a list of publicly available repos then check out my [jsfiddle.](http://jsfiddle.net/wh1t3w0lf21/nT5wY/3/)

which uses this ajax call to list all of a users public repos:

```
$("#btn_get_repos").click(function() {
    $.ajax({
        type: "GET",
        url: "https://api.github.com/users/google/repos",
        dataType: "json",
        success: function(result) {
            for(var i in result ) {
                $("#repo_list").append(
                    "<li><a href='" + result[i].html_url + "' target='_blank'>" +
                    result[i].name + "</a></li>"
                );
                console.log("i: " + i);
            }
            console.log(result);
            $("#repo_count").append("Total Repos: " + result.length);
        }
    });
}); 
```

to see what kind of data is returned just check the console after clicking the button or you can install Google Chromes JSONView extension and then just visit the url that the ajax request is making i.e. [https://api.github.com/users/google/repos](https://api.github.com/users/google/repos)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-04-30T14:59:49.617

Here is a nice way just with the curl. You should change the $user and the $token variableso to make this script work for your case. The code is tested with a valid token so I hope it will work for you. As you could see in the comments of the code the token could be generated from your github account from here [https://github.com/settings/applications](https://github.com/settings/applications)

```
<?php
  // for example your user
  $user = 'flesheater';

  // A token that you could generate from your own github 
  // go here https://github.com/settings/applications and create a token
  // then replace the next string
  $token = 'ced38b0e522a5c5e8ab10';

  // We generate the url for curl
  $curl_url = 'https://api.github.com/users/' . $user . '/repos';

  // We generate the header part for the token
  $curl_token_auth = 'Authorization: token ' . $token;

  // We make the actuall curl initialization
  $ch = curl_init($curl_url);

  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

  // We set the right headers: any user agent type, and then the custom token header part that we generated
  curl_setopt($ch, CURLOPT_HTTPHEADER, array('User-Agent: Awesome-Octocat-App', $curl_token_auth));

  // We execute the curl
  $output = curl_exec($ch);

  // And we make sure we close the curl       
  curl_close($ch);

  // Then we decode the output and we could do whatever we want with it
  $output = json_decode($output);

  if (!empty($output)) {
    // now you could just foreach the repos and show them
    foreach ($output as $repo) {
      print '<a href="' . $repo->html_url . '">' . $repo->name . '</a><br />';
    }
  }

?> 
```

Also since we like github, we should cache the results in the end and fetch them once per day or so.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-30T12:55:29.413

All these examples are just as pseudo without "authentication" and you can improve them yourself as you like;

```
<?php
// a simple way to get a user's repo
$res = file_get_contents("https://api.github.com/repos/qeremy/mii");
$res = json_decode($res);
print_r($res);
?> 
```

```
stdClass Object
(
    [language] => JavaScript
    [merges_url] => https://api.github.com/repos/qeremy/mii/merges
    [contributors_url] => https://api.github.com/repos/qeremy/mii/contributors
    [assignees_url] => https://api.github.com/repos/qeremy/mii/assignees{/user}
    [url] => https://api.github.com/repos/qeremy/mii
    [description] => Multipurpose JavaScript Library
    [ssh_url] => git@github.com:qeremy/mii.git
    [comments_url] => https://api.github.com/repos/qeremy/mii/comments{/number}
    [statuses_url] => https://api.github.com/repos/qeremy/mii/statuses/{sha}
    [keys_url] => https://api.github.com/repos/qeremy/mii/keys{/key_id}
    ...

```

```
<?php
// getting a repo's README
$res = file_get_contents("https://api.github.com/repos/qeremy/mii/readme");
$res = json_decode($res);
print_r($res);
?> 
```

```
stdClass Object
(
    [_links] => stdClass Object
        (
            [self] => https://api.github.com/repos/qeremy/mii/contents/README.md
            [git] => https://api.github.com/repos/qeremy/mii/git/blobs/49f0c4d5e25ac44921ba4372aebd76d2da5128e2
            [html] => https://github.com/qeremy/mii/blob/master/README.md
        )

    [url] => https://api.github.com/repos/qeremy/mii/contents/README.md
    [type] => file
    [sha] => 49f0c4d5e25ac44921ba4372aebd76d2da5128e2
    [path] => README.md
    [size] => 8213
    [encoding] => base64
    [content] => QWN0dWFsbHksIEkga25vdyB0aGF0IHRoZXJlIGFyZSBidWNoIG9mIEphdmFT
Y3JpcHQgbGlicmFyeSwgZXZlbiBtb3JlIHBvd2VyZnVsbC4gQnV0IHNvbWV0
    ...

```

But, I think needs more complicated structure;

```
<?php
class GRepo
{
    protected 
        // needs "user"
        $src_userRepos = "https://api.github.com/users/%s/repos",
        // needs "user,repo"
        $src_userRepoDetails = "https://api.github.com/repos/%s/%s",
        $responseCode, $responseText,
        $user;

    public function __construct($user) {
        $this->user = $user;
    }

    public function listRepos() {
        $this->_request(
            sprintf($this->src_userRepos, $this->user));
        if ($this->responseCode != 200) {
            throw new Exception('Server error!'); // e.g
        }
        return json_decode($this->responseText);
    }

    public function getRepoDetails($repo) {
        $this->_request(
            sprintf($this->src_userRepoDetails, $this->user, $repo));
        if ($this->responseCode != 200) {
            throw new Exception('Server error!'); // e.g
        }
        return json_decode($this->responseText);
    }

    // Could be extended, e.g with CURL..
    protected function _request($url) {
        $contents =@ file_get_contents($url);
        $this->responseCode = (false === $contents) ? 400 : 200;
        $this->responseText = $contents;
    }
}

// Test
$gr = new GRepo('qeremy');
print_r( $gr->listRepos() );
print_r( $gr->getRepoDetails('mii') );
?> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-18T16:47:17.347

When you say "display a repo and its contents" you actually say "display the state of the repo after the latest commit of the master branch", right? That's actually the better way of thinking about the problem and will be a better guide through using GitHub's API.

You need to look at the [Git data](http://developer.github.com/v3/git/) part of the API. Here's what you need to do:

1) fetch the list of refs for your repo using:

```
https://api.github.com/repos/:user/:repo/git/refs 
```

Working example:

```
https://api.github.com/repos/izuzak/noam/git/refs 
```

Notice that it lists the references in your repo and gives you links to continue.

2) fetch the commit object of the ref that interests you, namely "master", using the link provided in the response to 1):

```
https://api.github.com/repos/:user/:repo/git/commits/:sha 
```

Working example:

```
https://api.github.com/repos/izuzak/noam/git/commits/5cf12775b844664d5f7af6663706195680181374 
```

Notice that you get back an object with a link to a tree.

3) fetch the tree object of the last commit in the master ref, using the link provided in the response to 2) :

```
https://api.github.com/repos/:user/:repo/git/trees/:sha 
```

Working example:

```
https://api.github.com/repos/izuzak/noam/git/trees/8a721bea8d2f281c87b39c74cbf5a70075d686b4 
```

Notice that you get back a list of files in the root directory that is your repo. This is what you want. If you have subdirectories, you will get links to fetch the files in those subdirectories.

This should be enough to get you started :). Good luck!

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-30T13:03:06.103

Please try following library also available on git hub: [https://github.com/ornicar/php-github-api](https://github.com/ornicar/php-github-api)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-17T23:44:32.867

You need to parse the respone Githubs API sends you back. In PHP you can do this by using `json_decode()` which will give you an array to work with. You can use something like [`curl`](http://php.net/manual/en/book.curl.php) to issue the requests from PHP and then get the results and parse them as described above.
Another way to do this are REST Client classes for PHP, have a look at this one [here](http://phphttpclient.com/) for example.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-18T02:57:32.667

If you want some source code to analyze, about javascript you can try to start from [GitHub Repositories](https://github.com/jjNford/github-repositories) (more specifically [here](https://github.com/jjNford/github-repositories/blob/master/js/repos.js#L295)), it's a nice open project for a Chrome extension which does something similiar to what you're looking for.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-03T12:13:51.397

you can use [github api](http://developer.github.com/guides/getting-started/)

```
organization="write-here-the-organization"
githubuser="your-github-user"
token=`curl -i -u ${githubuser}  -d '{"scopes": ["repo"]}' https://api.github.com/authorizations | grep token | cut -d\" -f 4`
curl -i -H "Authorization: token ${token}" https://api.github.com/orgs/${organization}/repos 
```

as result of the above you will get a long json with all repositories, and their information. you can continue from here.

# c++ - 在循环中只为函数内的变量分配一次内存

> ID：14390093
> 
> 赞同：-2
> 
> 时间：2013-01-17T23:34:39.427
> 
> 标签：c++, memory-management

让我们有一个`func`为`vec`. 同样 let's`func`在一个循环中被多次调用。

```
void func ()
{
    std::vector<int> vec;
    vec.resize(someNumber);
}

for (int i=0; i<someNumber; ++i)
{
    func ();
} 
```

如何`vec`在循环中只分配一次内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:45:49.963

我可以看到两种可能的解决方案。一种是让函数引用`std::vector<int>`它可以使用的一个。

```
void func (std::vector<int> & vec)
{
    vec.resize(someNumber);
} 
```

另一种可能性是创建一个使用私有向量的函子，因此可以重用分配，假设它被多次调用。

```
class SomeFunctor
{
public:
    void operator()();

private:
    std::vector<int> vec;
}

void SomeFunctor::operator()()
{
    vec.resize(someNumber);
} 
```

这可以像这样使用：

```
SomeFunctor func;

for (int i=0; i<someNumber; ++i)
{
    func ();
} 
```

请注意，调用`resize()`向量意味着向量将为现有元素分配新的存储空间，复制现有元素并释放旧存储空间。这违背了持有向量对象的全部目的，因为向量的内部分配*永远不会*被重用！考虑`reserve()`改用它，它永远不会缩小（但可能会扩大）分配。

最佳解决方案可能不是这些方法，而是更简单的方法。您的示例代码没有提供足够的细节来了解这些方法是否有益。

* * *

作为旁注，请记住过早的优化是一件坏事。首先编写代码，然后运行分析器并查看瓶颈在哪里——通常它们将围绕收集用户输入或其他诸如网络和磁盘 I/O 之类的东西。我并不是说您不应该尝试预测可能的瓶颈并围绕它们进行工程设计，但不要过分担心每个可能的函数调用和分配/释放。

如果这是一个工作应用程序而不是原型，请运行分析器。您很可能会发现任何瓶颈都存在于其他地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:48:17.180

正如 Beta 所说，每次`func()`调用函数时都会创建一个新向量，并在函数退出时销毁。如果你想有一个单独的向量，每次调用都会调整大小，你可能想做类似的事情

```
std::vector<int> vec;
for (int i=0; i<someNumber; ++i)
{
    vec.resize(i);
} 
```

或者您可以使用您需要的最大内存直接初始化您的向量

```
std::vector<int> vec(someNumber); 
```

# php - 使用 php 的雅虎消息

> ID：14390097
> 
> 赞同：0
> 
> 时间：2013-01-17T23:34:59.370
> 
> 标签：php, api, yahoo

是否有一个 yahoo Api 可以帮助您使用 PHP 发送 yahoo 即时消息？我用谷歌搜索了它，但我发现论坛上有 3.4 年前的主题......我发现一些课程不起作用等等。有人能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T19:49:20.937

是的，有一个[messenger-sdk-php](https://github.com/yahoo/messenger-sdk-php)。

您需要创建该类的新实例：

```
$engine = new JYMEngine(CONSUMER_KEY, SECRET_KEY, USERNAME, PASSWORD); 
```

使用雅虎帐户登录：

```
$engine->fetch_request_token();
$engine->fetch_access_token();
$engine->signon('Status message'); 
```

然后你可以发送消息：

```
$engine->send_message('yahooID', $message); 
```

随代码提供的示例客户端是一个很好的起点。它接受任何好友请求并接受诸如帮助（显示可用命令）、新闻（显示来自雅虎的新闻标题）等命令，...

# uiscrollview - xcode 4.5 在图像上滚动不起作用

> ID：14390099
> 
> 赞同：0
> 
> 时间：2013-01-17T23:35:05.570
> 
> 标签：uiscrollview, uiimageview, xcode4.5

我对一张效果很好的图片进行了缩放。它只是不会滚动。

有一件事要提一下，我尝试将图片居中，但这也不起作用。下面是我的代码。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UIImage * image = [UIImage imageNamed:@"family.jpeg"];
    self.imageview = [[UIImageView alloc] initWithImage:image];
    [self.view addSubview:self.imageview];

    [image drawInRect:CGRectMake((self.view.frame.size.width/2) - (image.size.width/2), (self.view.frame.size.height / 2) - (image.size.height / 2), image.size.width, image.size.height)];

    [self.scroller setContentSize:[image size]];
    [self.scroller setMaximumZoomScale:2.0];

}

- (UIView *)viewForZoomingInScrollView:(UIScrollView*)scrollView
{
    return self.imageview;
} 
```

非常感谢您提供的任何帮助/评论：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T06:50:05.577

对于滚动，滚动视图的内容大小必须大于滚动视图的帧大小。您只需尝试一下，看看它是否正在滚动。

[self.scroller setContentSize:CGSizeMake(self.scroller.frame.size.width+500, self.scroller.frame.size.height+500)];

如果它正常工作，那么您的图像大小可能小于滚动视图的框架大小。

# javascript - jstl 迭代中的 JavaScript

> ID：14390104
> 
> 赞同：0
> 
> 时间：2013-01-17T23:35:37.663
> 
> 标签：javascript, jstl

我有以下代码：

```
 <%int number=0;%>

    <c:forEach var="row" items="${tAdmin.rows}" varStatus="totalRow" step="1">
       <td><%=++number%></td>
      <td>
      <div id="content" style="table-layout:fixed; width:405px; word-wrap:break-word;">
      <script language="JavaScript" type="text/JavaScript">
            function load(){
                    var content='${row.content}';
                    document.getElementById("content").innerHTML=content;
                    document.getElementById("content").innerHTML=Utf8.decode(document.getElementById("content").innerHTML);     
            }
            window.onload=load;
    </script>
    </div>
    </td>
    </c:forEach> 
```

问题是它只显示最后一个内容的结果，而不是根据数字逐行打印出来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:02:03.290

如果您在浏览器中查看页面源代码，您正在创建的内容看起来像这样（注意 ${row.content} 已经在服务器上被替换）：

```
<td>0<td>
<td>
  <div id="content" style="table-layout:fixed; width:405px; word-wrap:break-word;">
  <script language="JavaScript" type="text/JavaScript">
        function load(){
                var content='The first row content';
                document.getElementById("content").innerHTML=content;
                document.getElementById("content").innerHTML=
                    Utf8.decode(document.getElementById("content").innerHTML);     
        }
        window.onload=load;
</script>
</div>
</td>
<td>1<td>
<td>
  <div id="content" style="table-layout:fixed; width:405px; word-wrap:break-word;">
  <script language="JavaScript" type="text/JavaScript">
        function load(){
                var content='Some different content';
                document.getElementById("content").innerHTML=content;
                document.getElementById("content").innerHTML=
                    Utf8.decode(document.getElementById("content").innerHTML);     
        }
        window.onload=load;
</script>
</div>
</td>
<td>2<td>
<td>
  <div id="content" style="table-layout:fixed; width:405px; word-wrap:break-word;">
  <script language="JavaScript" type="text/JavaScript">
        function load(){
                var content='Yet some more content';
                document.getElementById("content").innerHTML=content;
                document.getElementById("content").innerHTML=
                    Utf8.decode(document.getElementById("content").innerHTML);     
        }
        window.onload=load;
</script>
</div>
</td> 
```

您将拥有许多副本，`function load()`并且多次`window.onload`分配到哪里`window.onload=load;`

当 this 到达浏览器并被解释时，只有*最后一个*定义`function load()`有效；只有你*最后*一次分配`window.onload=load;`意味着什么（因为你不断地替换 window.onload 的值）——每次重新定义`load()`都会替换前一次——所以只有你的*最后一次* `var content='${row.content}';`被执行。

此外，您将拥有许多`<div>`具有相同“内容”ID 的标签，这是不允许的。

这些`<td><div>...</div></td>`块中的每一个的内容都可以由服务器上的 JSP/JSTL 本身设置——无需通过 javascript 设置 innerHTML。您可以使用`totalRow`您设置的 varStatus 来提供第一个数字`<td>`——您不需要增加自己的计数器。

您可以使用表达式语言 (EL) 来访问每一行的内容值。

Inline style="blah blah blah" 很烂。只有在绝对必要时才使用它。
相反，将所有这些样式放在 CSS 定位 .contentbits:
style="table-layout:fixed; width:405px; word-wrap:break-word;"
变成

```
.contentbits {
    table-layout:fixed;
    width:405px;
    word-wrap:break-word;
} 
```

页面片段变得更加简单：

```
<c:forEach var="row" items="${tAdmin.rows}" varStatus="totalRow" step="1">
  <td>${totalRow}</td>
  <td>
    <div class="contentbits">${row.content}</div>
  </td>
</c:forEach> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:49:39.970

这不是正确的方法，但可以使用一个简单的解决`addEventListener`方案`onload`：

```
<%int number=0;%>

<c:forEach var="row" items="${tAdmin.rows}" varStatus="totalRow" step="1">
   <td><%=++number%></td>
  <td>
  <div id="content<%=number%>" style="table-layout:fixed; width:405px; word-wrap:break-word;">
  <script language="JavaScript" type="text/JavaScript">
        window.addEventListener("load", function () {
                var element = document.getElementById("content<%=number%>");
                element.innerHTML=Utf8.decode('${row.content}');     
        }, true);
</script>
</div>
</td>
</c:forEach> 
```

实际上，您的代码仅使用最后一个“onload”，因为在加载页面时，`load`只有在完成完全加载后才会执行 javascript 回调。因此，每次执行循环时，它都会更新`load`最后一个的回调引用，因此当`onload`被触发时，只会执行最后一个。

但是您的代码也有其他错误。id 在代码中`content`重复很多次，这将使您的 div`getElementById`无用，因为您有很多相同的 id。ID 必须对工作属性是唯一的。

最后，将您的 HTML 与内部脚本混合并不是一个好的模式，最好将您的逻辑文件（javascript 文件）放在外部，然后它可以在完成加载时更改您的代码，读取生成的 html。您还可以`data`在您的然后通过 javascript 读取它来创建属性`div`以管理具有特定`data`属性的所有项目。

为了简单起见，我将添加一个示例：

```
<%int number=0;%>

<c:forEach var="row" items="${tAdmin.rows}" varStatus="totalRow" step="1">
   <td><%=++number%></td>
  <td>
  <div id="content<%=number%>" style="table-layout:fixed; width:405px; word-wrap:break-word;" data-content="${row.content}">
</div>
</td>
</c:forEach> 
```

现在脚本文件（我在这个例子中使用 jQuery 可以在任何浏览器上运行）：

```
$(function() {
    $("[data-content]").each(function(item) {
        $(item).html(Utf8.decode(item.attr('data-content')));
    });
}); 
```

# qt - 在控制台应用程序中使用 QFtp

> ID：14390107
> 
> 赞同：0
> 
> 时间：2013-01-17T23:36:13.170
> 
> 标签：qt, ftp, console

我是使用 Qt 的高级初学者，我正在尝试编写一个使用 QFtp 的控制台应用程序。该应用程序本身本质上只是程序代码，但由于 QFtp 是异步的，这让我抓狂。我需要测试多个 ftp 下载是否成功，但代码不会阻塞，因此测试总是失败。到目前为止，最好的解决方案是创建一个信号和插槽链，以菊花链形式链接 ftp 代码和程序部分。看来必须有更好的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T14:13:29.937

您可以使用[QEventLoop](http://qt-project.org/doc/qt-4.8/QEventLoop.html)等待信号。只需将信号连接到`QEventLoop::quit()`，然后调用`QEventLoop::exec()`。

```
QFtp ftp;
QEventLoop eventLoop;
connect(&ftp, SIGNAL(commandFinished(int,bool)), &eventLoop, SLOT(quit()));
eventLoop.exec(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T12:22:29.310

由于它是异步的，您最好通过信号和槽机制跟踪它，但这确实会影响您的程序逻辑。Qt 中 FTP 的唯一其他默认选项是，`QNetworkAccessManager`但这也是异步的，因此无论您选择哪种方式，都必须使用信号/插槽系统来跟踪何时完成。

您*可以*使用`QTcpSocket`和编写自己的 FTP 代码，这允许您阻止调用线程，直到它在某些条件下返回，但您必须编写更多代码才能执行您想要的操作。

# android - 从标签 android 启动 uri

> ID：14390112
> 
> 赞同：0
> 
> 时间：2013-01-17T23:36:43.193
> 
> 标签：android, android-tabhost

我有一个带有标签的简单 Android 应用程序。我希望第二个选项卡在单击时打开一个 google play 商店 URL。

选项卡加载，但当我单击 tab2 时应用程序崩溃。

```
TabSpec spec = m_tabhost.newTabSpec("tab1")
            .setIndicator("tab1")
            .setContent(new Intent().setClass(this, GridActivity.class).putExtra("tabindex", 0));
            m_tabhost.addTab(spec);

   spec = m_tabhost.newTabSpec("tab2")
    .setIndicator("tab2")
    .setContent(new Intent(Intent.ACTION_VIEW).setData(Uri.parse("market://search?q=pub:Google Inc.")));
    m_tabhost.addTab(spec); 
```

这是错误：

```
01-16 18:53:58.734: W/dalvikvm(10611): threadid=1: thread exiting with uncaught exception (group=0x4001e578)
01-16 18:53:58.738: W/System.err(10611): java.lang.SecurityException: Requesting code from com.android.vending (with uid 10060) to be run in process soundboard.code.bhak (with uid 10130)
01-16 18:53:58.757: W/System.err(10611):    at android.app.ActivityThread.getPackageInfo(ActivityThread.java:1296)
01-16 18:53:58.757: W/System.err(10611):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1546)
01-16 18:53:58.757: W/System.err(10611):    at android.app.ActivityThread.startActivityNow(ActivityThread.java:1491)
01-16 18:53:58.757: W/System.err(10611):    at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:127)
01-16 18:53:58.757: W/System.err(10611):    at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:339)
01-16 18:53:58.757: W/System.err(10611):    at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:657)
01-16 18:53:58.757: W/System.err(10611):    at android.widget.TabHost.setCurrentTab(TabHost.java:329)
01-16 18:53:58.757: W/System.err(10611):    at android.widget.TabHost$2.onTabSelectionChanged(TabHost.java:133)
01-16 18:53:58.757: W/System.err(10611):    at android.widget.TabWidget$TabClickListener.onClick(TabWidget.java:456)
01-16 18:53:58.761: W/System.err(10611):    at android.view.View.performClick(View.java:2538)
01-16 18:53:58.761: W/System.err(10611):    at android.view.View$PerformClick.run(View.java:9152)
01-16 18:53:58.761: W/System.err(10611):    at android.os.Handler.handleCallback(Handler.java:587)
01-16 18:53:58.761: W/System.err(10611):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-16 18:53:58.765: W/System.err(10611):    at android.os.Looper.loop(Looper.java:130)
01-16 18:53:58.765: W/System.err(10611):    at android.app.ActivityThread.main(ActivityThread.java:3687)
01-16 18:53:58.765: W/System.err(10611):    at java.lang.reflect.Method.invokeNative(Native Method)
01-16 18:53:58.765: W/System.err(10611):    at java.lang.reflect.Method.invoke(Method.java:507)
01-16 18:53:58.769: W/System.err(10611):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
01-16 18:53:58.769: W/System.err(10611):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
01-16 18:53:58.769: W/System.err(10611):    at dalvik.system.NativeStart.main(Native Method)
01-16 18:53:58.792: D/BugSenseHandler(10611): Transmitting stack trace: java.lang.SecurityException: Requesting code from com.android.vending (with uid 10060) to be run in process soundboard.code.bhak (with uid 10130) 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:44:51.423

就像异常状态一样，您得到 a 是`SecurityException`因为您请求将外部意图启动到您拥有的容器中。几乎你唯一的选择就是加载你在本地创建`URL`的那个 play store url 的版本。`WebView`

相反，如果您希望它加载实际的 Play 商店应用程序，您仍然可以通过发送意图来完成，但您将无法将其加载到您的容器中......相反，您必须让您的代码实际启动单击选项卡时播放商店 url的外部`Intent`。

编辑：您可能能够以某种方式获得对您想要单击的选项卡的实际视图的引用，以便`OnClickListener`通过一些技巧将其放置在上面`TabHost`，[这里](https://stackoverflow.com/a/4336851/977479)是一个如何使用当前选项卡执行此操作的示例，尽管如何获取任意选项卡的视图并不是很明显。如果您真的想采用这种方法，您可能可以`TabHost`在创建它后迭代它的子视图并找到正确的视图。

相反，您可以使用典型的[TabHost.OnTabChangedListener](http://developer.android.com/reference/android/widget/TabHost.OnTabChangeListener.html)，它会在单击选项卡时为您提供一个事件。您可以在选项卡内容中放置某种虚拟布局（您正在设置播放意图 atm 的位置）（也许让它在恢复时切换到其他地方或其他地方？由您决定）......然后在`OnTabChanged`这个选项卡中，启动您的上述意图。IE ：

```
m_tabhost.setOnTabChangedListener(new OnTabChangedListener(){

  @Override 
  public void onTabChanged(String tabId){
  if(tabId.equals(SOME_TAB_ID_FOR_THIS_TAB)){
    Intent i = new   Intent(Intent.ACTION_VIEW).setData(Uri.parse("market://search?q=pub:Google Inc."));
    startActivity(i);
    //more stuff if you need
   }}
}); 
```

# java - Groovy/Java 正则表达式循环匹配模式

> ID：14390115
> 
> 赞同：4
> 
> 时间：2013-01-17T23:37:05.163
> 
> 标签：java, regex, groovy

我有一个字符串，其中包含一些我想提取的以十六进制表示的字节。例如：

```
String str = "051CF900: 00 D3 0B 60 01 A7 16 C1  09 9C" 
```

我想提取这些值并将它们连接到一个字符串中，使其看起来像：

```
00D30B6001A716C1099C 
```

我的尝试：

```
String stream = "";
Pattern pattern = Pattern.compile("\\b[A-F0-9]{2}\\b");
matcher = pattern.matcher(str);
matcher.find{ newByte ->
  println(newByte);
  stream += newByte;
};
println(stream); 
```

当我尝试将每个字节添加到时，`stream`它似乎停止循环。如果我删除该行，每个字节都会成功打印出来。为什么当我添加`newByte`到时循环会中断`stream`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T10:54:53.993

由于这是 Groovy，您可以将所有代码更改为：

```
String stream = str.findAll( /\b[A-F0-9]{2}\b/ ).join() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T00:38:45.430

*对于 Groovy，您*需要从`String`. 代替：

```
matcher.find { newByte -> 
```

和

```
matcher.findAll { newByte -> 
```

# python - 从 csv 文件中删除换行符

> ID：14390123
> 
> 赞同：5
> 
> 时间：2013-01-17T23:37:41.347
> 
> 标签：python, newline

我正在尝试在 python 中处理一个 csv 文件，该文件在每行/行的中间有一个 ^M 字符，这是一个换行符。我无法以“rU”以外的任何模式打开文件。

如果我确实以“rU”模式打开文件，它会读取换行符并拆分文件（创建换行符）并给我两倍的行数。

我想完全删除换行符。如何？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-17T23:48:08.663

请注意，正如[文档](http://docs.python.org/2/library/csv.html)所说：

> *csvfile*可以是任何支持迭代器协议并在每次`next()`调用其方法时返回一个字符串的对象——文件对象和列表对象都适用。

因此，在将文件交给您的`reader`或`DictReader`. 而不是这个：

```
with open('myfile.csv', 'rU') as myfile:
    for row in csv.reader(myfile): 
```

做这个：

```
with open('myfile.csv', 'rU') as myfile:
    filtered = (line.replace('\r', '') for line in myfile)
    for row in csv.reader(filtered): 
```

那`'\r'`是 Python（和 C）的拼写方式`^M`。因此，这只是`^M`通过将每个字符替换为空字符串来去除所有字符，无论它们出现在哪里。

* * *

> 我想我想永久修改文件而不是过滤它。

首先，如果您想在运行 Python 脚本之前修改文件，为什么不在 Python 之外进行呢？`sed`, `tr`, 许多文本编辑器等都可以为您做到这一点。这是一个 GNU sed 示例：

```
gsed -i'' 's/\r//g' myfile.csv 
```

但是如果你想用 Python 来做，它并没有那么冗长，而且你可能会发现它更具可读性，所以：

首先，如果要从中间插入或删除，则无法真正就地修改文件。通常的解决方案是编写一个新文件，然后将新文件移到旧文件上（仅限 Unix）或删除旧文件（跨平台）。

跨平台版本：

```
os.rename('myfile.csv', 'myfile.csv.bak')
with open('myfile.csv.bak', 'rU') as infile, open('myfile.csv', 'wU') as outfile:
    for line in infile:
        outfile.write(line.replace('\r'))
os.remove('myfile.csv.bak') 
```

不太笨重但仅适用于 Unix 的版本：

```
temp = tempfile.NamedTemporaryFile(delete=False)
with open('myfile.csv', 'rU') as myfile, closing(temp):
    for line in myfile:
        temp.write(line.replace('\r'))
os.rename(tempfile.name, 'myfile.csv') 
```

# android - 将点击事件传递给 Android 微调器

> ID：14390124
> 
> 赞同：0
> 
> 时间：2013-01-17T23:37:42.837
> 
> 标签：android

我创建了自己的小部件，一个带有 TextView（标签）和 Spinner 的 LinearLayout。

在 XML 中看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="50dp"
    android:orientation="horizontal"
    android:clickable="true"
    android:focusable="true"
    android:focusableInTouchMode="true"
    style="@style/MySpinner>
    <TextView android:id="@+id/label"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:textStyle="bold"
        android:layout_weight="0.4"
        android:textSize="18sp"
        android:padding="8dp"
        android:enabled="false"/>
    <Spinner android:id="@+id/spinner"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:entries="@array/thats_me_age_values"
        android:layout_weight="0.6"
        android:spinnerMode="dialog"
        android:padding="8dp"/>
</LinearLayout> 
```

LinearLayout 应该获取所有触摸事件，以便它可以正确使用它的样式（按下时背景更改）。该样式将背景属性设置为此选择器：

```
<?xml version="1.0" encoding="utf-8"?>
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
     <!-- pressed -->
     <item android:state_pressed="true" android:state_focused="false"> 
         <shape android:shape="rectangle" android:visible="true">
             <corners android:topLeftRadius="7dp" android:topRightRadius="7dp"/>
             <solid android:color="@color/dark_yellow"/>
             <stroke android:width="1dp" android:color="@color/grey"/>
         </shape>
     </item> 
     <!-- focused -->
     <item android:state_focused="true"> 
         <shape android:shape="rectangle" android:visible="true">
             <corners android:topLeftRadius="7dp" android:topRightRadius="7dp"/>
             <solid android:color="@color/dark_yellow"/>
             <stroke android:width="1dp" android:color="@color/grey"/>
         </shape>
     </item> 
     <!-- default -->
     <item>
         <shape android:shape="rectangle" android:visible="true">
             <corners android:topLeftRadius="7dp" android:topRightRadius="7dp"/>
             <solid android:color="@color/yellow"/>
             <stroke android:width="1dp" android:color="@color/grey"/>
         </shape>
     </item>
 </selector> 
```

我已经尝试为 LinearLayout 覆盖 onInterceptTouch 方法。日志消息在按下时显示，但背景不会改变。

```
@Override
public boolean onTouchEvent(MotionEvent event) {
    Log.i("TOUCH", "onTouchEvent");
    return super.onTouchEvent(event);
}

@Override
public boolean onInterceptTouchEvent(MotionEvent ev) {
    onTouchEvent(ev);
    Log.i("TOUCH", "onInterceptTouchEvent");
    return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T14:10:16.670

我认为将 android:addStatesFromChildren="true" 添加到 LinearLayout 将解决您的问题......因此，当您单击/聚焦时，您的微调器线性布局会将其状态更改为单击/聚焦。

# c# - 如何强制工作流包含本地类型程序集名称？

> ID：14390131
> 
> 赞同：1
> 
> 时间：2013-01-17T23:38:28.530
> 
> 标签：c#, workflow-foundation-4, workflow-foundation

我正在使用 WF4，并且在同一个项目中拥有我的类型、活动和工作流，然后我使用 ActivityXamlServices.Load(path) 来加载我的工作流活动，它会引发以下异常：

```
The type ‘InArgument(local:,,,, of property ‘InputArgs’ could not be resolved 
```

[通过在这篇文章](http://social.msdn.microsoft.com/Forums/lv/wfprerelease/thread/a29c22d6-cc41-48b2-b15b-f8c7912a04d1)中查看此问题的解决方案，我在工作流程中手动包含了程序集名称，并且一切正常。

问题：每次我对工作流程进行任何更改时，它都会重新编写 xaml 并删除我手动添加的程序集名称。

问题：有没有办法强制包括本地类型的程序集名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T12:42:08.200

诀窍是使用 XamlXmlReaderSettings 并指定应用作本地程序集引用的内容。

```
var settings = new XamlXmlReaderSettings()
{
    LocalAssembly = typeof(YourArgumentType).Assembly
};
var reader = new XamlXmlReader(path, settings);
Activity workflow = ActivityXamlServices.Load(reader); 
```

# php - while 循环优化一点

> ID：14390133
> 
> 赞同：1
> 
> 时间：2013-01-17T23:38:46.100
> 
> 标签：php, loops, while-loop, micro-optimization

我有一个`while`循环运行，可以抓取我网站上的所有帖子

`while ( $all_query->have_posts() ) : $all_query->the_post();`

每个都有我需要使用的元数据。这是一个名为的字段`'rate'`，我需要合并类似的值，1-5。

目前，我有这个

```
while ( $all_query->have_posts() ) : $all_query->the_post();
    $fives = 0;
    $fours = 0;
    $threes = 0;
    $twos = 0;
    $ones = 0;
    if(get_post_meta($post->ID, 'rate', true) == 'five') { 
        $fives = $fives + 5;
    }
    if(get_post_meta($post->ID, 'rate', true) == 'four') { 
        $fours = $fours + 4;
    }
    if(get_post_meta($post->ID, 'rate', true) == 'three') { 
        $threes = $threes + 3;
    }
    if(get_post_meta($post->ID, 'rate', true) == 'two') { 
        $twos = $twos + 2;
    }
    if(get_post_meta($post->ID, 'rate', true) == 'one') { 
        $ones = $ones + 1;
    }
    endwhile; 
```

它有效，但它真的很恶心。

有没有更优化和更干净的方式来做这样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T23:43:59.080

一点点数组操作可以大大简化这一点：

```
$counts = array_fill(1, 5, 0);
$labels = array(1 => 'one', 'two', 'three', 'four', 'five');

while(...) {
    $index = array_search(get_post_meta($post->ID, 'rate', true), $labels);
    $counts[$index] += $index;
} 
```

总数保存在里面`$counts`，`$counts[1]`是总数。`$labels`是否可以帮助将文本表示与内部的数组位置相匹配`$counts`——这当然可以用纯文本来完成`switch`。

该循环用于`array_search`将文本表示转换为数组索引，然后简单地将相应的计数增加等于索引的数量。

生产代码当然也应该考虑`array_search`返回的可能性`false`。

# jquery - Jquery 提示按钮

> ID：14390136
> 
> 赞同：1
> 
> 时间：2013-01-17T23:39:28.477
> 
> 标签：jquery, html, function, prompt

我需要一点帮助。我是 jquery 的新手，我正在尝试制作一个用户单击然后出现提示的按钮。但无论我做什么，我似乎都无法在您按下按钮后出现提示。

HTML：

```
<input class=".button" type="submit" value="Car" /> 
```

jQuery：

```
$(document).ready(function() {
        $(".button").click(function() {
            var myNumber = 19.2;
            var myAnswer = prompt("How many miles did you travel?");
            document.write("Your Carbon Foot print is:" + myAnswer * myNumber + "lbs" );

          });
      }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T23:40:47.073

`".button"`从HTML 中的输入类中删除句点。

尽管 jQuery/CSS 选择器使用句点和散列来区分`class`和`IDs`，但您不要将它们放在 HTML 元素上。

# c# - 无法实例化泛型类

> ID：14390137
> 
> 赞同：3
> 
> 时间：2013-01-17T23:39:32.130
> 
> 标签：c#, generics

我有一个接口

```
public interface ICrypto<T> : IDisposable
{
     ICryptoTransform GetDecryptor();

     ICryptoTransform GetEncryptor();

     T GetAlgorithm();
} 
```

我有一个实现

```
public class TripleDESCryptoProvider : ICrypto<TripleDESCryptoServiceProvider>
{

    public TripleDESCryptoProvider() { }

    public ICryptoTransform GetDecryptor()
    {
        return GetAlgorithm().CreateDecryptor();
    }

    public ICryptoTransform GetEncryptor()
    {
        return GetAlgorithm().CreateEncryptor();
    }

    public TripleDESCryptoServiceProvider GetAlgorithm()
    {
     ...
    }

    public void Dispose()
    {
        throw new NotImplementedException();
    }
} 
```

我有一个实现上述实现的类

```
public class CryptoWork<T> where T : ICrypto<T>, new()
{
    protected static T _keyStore;

    public static T KeyStore
    {
        get
        {
            if (_keyStore == null)
            {
                _keyStore = new T();
            }
            return _keyStore;
        }
    }

    /// <summary>
    /// Encrypt a byte array
    /// </summary>
    public string Encrypt(string input)
    {
        byte[] inputArray = UTF8Encoding.UTF8.GetBytes(input);
        using (var encryptor = KeyStore.GetEncryptor())
        {
            return Convert.ToBase64String(encryptor.TransformFinalBlock(inputArray, 0, inputArray.Length));
        }
    }

    /// <summary>
    /// Decrypt a byte array
    /// </summary>
    public string Decrypt(string input)
    {
        byte[] inputArray = Convert.FromBase64String(input);
        using (var encryptor = KeyStore.GetDecryptor())
        {
            return UTF8Encoding.UTF8.GetString(encryptor.TransformFinalBlock(inputArray, 0, inputArray.Length));
        }
    }
} 
```

我在实例化类时遇到问题`CryptoWork<T> where T : ICrypto<T>, new()`：

两者都不

```
 var cryptoWork = new CryptoWork < ICrypto < TripleDESCryptoProvider > > (); 
```

也不

```
var cryptoWork = new CryptoWork < TripleDESCryptoProvider > (); 
```

编译。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T23:46:06.043

您已指定：

```
CryptoWork<T> where T : ICrypto<T>, new() 
```

你正在使用

```
new CryptoWork<TripleDESCryptoProvider>(); 
```

为此，我们需要：

```
TripleDESCryptoProvider : ICrypto<TripleDESCryptoProvider> 
```

（因为`T`= `TripleDESCryptoProvider`）

但是你有：

```
TripleDESCryptoProvider : ICrypto<TripleDESCryptoServiceProvider> 
```

和一个公共的无参数构造函数（你有）。选项：

*   制作`TripleDESCryptoProvider : ICrypto<TripleDESCryptoProvider>`
*   重构 API
*   使该`CryptoWork`类型具有 2 个泛型类型参数；一个用于`TripleDESCryptoProvider`，另一个用于`TripleDESCryptoServiceProvider`

# wpf - 关闭后，如何将可拖动的 wpf 弹出窗口设置为其原始位置？

> ID：14390142
> 
> 赞同：2
> 
> 时间：2013-01-17T23:40:00.927
> 
> 标签：wpf, wpf-controls

我使用在 Stack Overflow 上找到的代码，使用附加的行为使 WPF 弹出窗口可拖动。此代码和行为按预期工作。弹出窗口将保持在其拖动位置，直到用户再次移动它。

我现在要做的是让弹出窗口在关闭并重新打开后出现在其原始放置目标位置。我如何完成这项任务？

原帖：[wpf 中的可拖动弹出控件](https://stackoverflow.com/questions/4784240/a-draggable-popup-control-in-wpf)

Rick Sladkey 编写的答案代码：[https ://stackoverflow.com/a/4784977/1286413](https://stackoverflow.com/a/4784977/1286413)

这是弹出窗口的 XAML：

```
<Grid>
   <StackPanel>
       <TextBox x:Name="textBox1" Width="200" Height="20"/>
   </StackPanel>
   <Popup PlacementTarget="{Binding ElementName=textBox1}" IsOpen="{Binding IsKeyboardFocused, ElementName=textBox1, Mode=OneWay}">
       <i:Interaction.Behaviors>
           <local:MouseDragPopupBehavior/>
       </i:Interaction.Behaviors>
       <TextBlock Background="White">
           <TextBlock.Text>Sample Popup content.</TextBlock.Text>
       </TextBlock>
   </Popup>
</Grid> 
```

这是他写的 AttachedBehavior：

```
public class MouseDragPopupBehavior : Behavior<Popup>
{
   private bool mouseDown;
   private Point oldMousePosition;

   protected override void OnAttached()
   {
       AssociatedObject.MouseLeftButtonDown += (s, e) =>
       {
           mouseDown = true;
           oldMousePosition = AssociatedObject.PointToScreen(e.GetPosition(AssociatedObject));
           AssociatedObject.Child.CaptureMouse();
       };
       AssociatedObject.MouseMove += (s, e) =>
       {
           if (!mouseDown) return;
           var newMousePosition = AssociatedObject.PointToScreen(e.GetPosition(AssociatedObject));
           var offset = newMousePosition - oldMousePosition;
           oldMousePosition = newMousePosition;
           AssociatedObject.HorizontalOffset += offset.X;
           AssociatedObject.VerticalOffset += offset.Y;
       };
       AssociatedObject.MouseLeftButtonUp += (s, e) =>
       {
           mouseDown = false;
           AssociatedObject.Child.ReleaseMouseCapture();
       };
   }
} 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:06:17.223

在 OnAttached 中，向 Closed 添加一个处理程序以保存弹出窗口的位置，并向 Opened 添加另一个处理程序，将弹出窗口移回该位置。

```
public class MouseDragPopupBehavior : Behavior<Popup>
{
    private bool mouseDown;
    private Point oldMousePosition;

    private bool useSavedPosition;
    private Point savedPosition;

    protected override void OnAttached()
    {
        AssociatedObject.MouseLeftButtonDown += (s, e) =>
        {
            mouseDown = true;
            oldMousePosition = AssociatedObject.PointToScreen(e.GetPosition(AssociatedObject));
            AssociatedObject.Child.CaptureMouse();
        };
        AssociatedObject.MouseMove += (s, e) =>
        {
            if (!mouseDown) return;
            var newMousePosition = AssociatedObject.PointToScreen(e.GetPosition(AssociatedObject));
            var offset = newMousePosition - oldMousePosition;
            oldMousePosition = newMousePosition;
            AssociatedObject.HorizontalOffset += offset.X;
            AssociatedObject.VerticalOffset += offset.Y;
        };
        AssociatedObject.MouseLeftButtonUp += (s, e) =>
        {
            mouseDown = false;
            AssociatedObject.Child.ReleaseMouseCapture();
        };

        AssociatedObject.Opened += (s, e) =>
        {
            if (!useSavedPosition) return;
            AssociatedObject.HorizontalOffset = savedPosition.X;
            AssociatedObject.VerticalOffset = savedPosition.Y;
        };

        AssociatedObject.Loaded += (s, e) =>
        {
            savedPosition = new Point(AssociatedObject.HorizontalOffset, AssociatedObject.VerticalOffset);
            useSavedPosition = true;
        };
    }
} 
```

# ios - iOS - UITableViewCell 被剪裁

> ID：14390143
> 
> 赞同：1
> 
> 时间：2013-01-17T23:40:03.237
> 
> 标签：ios, uitableview

我有一个带有平铺背景图像的 UITableView

```
self.tableView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"bg.png"]]; 
```

使用此图像模式，我注意到在每个第三个表格单元格上，模式都不匹配，并且在背景图像上可以清楚地看到一条线。在完全相同的位置，我的 UITableViewCell 的底部被剪裁了，所以我失去了单元格的底部。我假设这两个问题是相关的。我想知道是否有人可以解释这里发生的事情，并可能提供一个建议来修复我的表格单元格不被剪裁。

右边的图像是**剪切**的单元格，左边的图像是正常的单元格

![正常细胞](../Images/d969aa381df27e2b88aa80ec867b7f00.png) ![裁剪的表视图单元格](../Images/606d4321f353d4757d5dccf638dcc967.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T14:32:43.007

我整理了这个。我正在更改 UITableViewCell 框架原始值以在导致此问题的表格单元格之间创建间隙。

```
self.contentView.frame.origin.y = 20; 
```

而不是这个，我只是调整了边界以创建单元格行之间的间隙。

```
CGRect bounds = self.contentView.bounds;
bounds.size.height = bounds.size.height -20;
self.contentView.bounds = bounds; 
```

希望将来能帮助某人

# php - 简单的 301 重定向

> ID：14390151
> 
> 赞同：0
> 
> 时间：2013-01-17T23:40:48.143
> 
> 标签：php, .htaccess, url, url-rewriting, url-routing

我目前使用它来转发我的 URL。但我有一个错误，我需要转发所有

```
/search/search-term/1/ >> /search/search-term/
/search/search-term/2/ >> /search/search-term/2/ 
```

1 和 2 是页码。所有第 1 页都需要位于“根”网址。

出于某种原因，我的代码无法正常工作。

这是我所有页面都可以正常工作的当前方法。

```
RewriteRule ^/([a-z\d][\w-.'\d]+[a-z\d]+)/([0-9]+)/?$  results.php?whatwhere=$1&page=$2
RewriteRule ^/([a-z\d][\w-.'\d]+[a-z\d]+)/([0-9]+)?$   results.php?whatwhere=$1&page=$2 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T03:53:27.063

在其他规则之前试试这个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI}  /(.*)/1/?  [NC]
RewriteRule .*  %1  [L] 
```

替换`[L]`为`[L,R=301]` 永久重定向

# java - dispatchKeyEvent 不会影响 PopupWindow 内的 EditText

> ID：14390152
> 
> 赞同：0
> 
> 时间：2013-01-17T23:40:52.177
> 
> 标签：java, android, popupwindow

我有包含一些 EditTexts 的弹出窗口。我想在弹出窗口中创建我的自定义数字键盘。所以我有 10 个代表数字 0-9 的按钮。内部按钮的 onClickListener 我试图调度关键事件

```
public void onClick(View v) {
    dispatchKeyEvent(new KeyEvent(KeyEvent.ACTION_UP, KeyEvent.KEYCODE_0));
} 
```

但它不会影响 EditTexts。我试图用可聚焦的等于真和假来做到这一点，但结果是一样的。当我试图在活动的主布局中调度关键事件时，它运行良好，那么我应该改变什么以使我的代码在弹出窗口中工作？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-05T14:30:06.973

您是否尝试过请求关注 EditTexts？不仅使用

```
editText.setFocusable(true); 
```

但是也

```
editText.requestFocus(); 
```

我认为这也可能不起作用，因为您没有首先注入 DOWN 事件。尝试以下操作：

```
Instrumentation mInstrumentation = new Instrumentation();
final Thread t = new Thread() {
     public void run(){ 
              mInstrumentation.sendKeyDownUpSync(KeyEvent.KEYCODE_0);               
     };
t.start(); 
```

这将注入一个事件，该事件将由具有焦点的视图处理

# php - 如何使用 cURL 和 php 获得服务器的响应？

> ID：14390161
> 
> 赞同：0
> 
> 时间：2013-01-17T23:41:48.163
> 
> 标签：php, xml, curl, response

我有一个发送者脚本和一个接收者脚本。发送者发送一个 xml 文件，而接收者获取它并将其存储在数据库中。

发件人看起来像这样：

```
$xml = file_get_contents("data.xml");

  // We send XML via CURL using POST with a http header of text/xml.
  $ch = curl_init();
  // set URL and other appropriate options
  curl_setopt($ch, CURLOPT_URL, "http://localhost/iPM/receiver.php");
  curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: text/xml'));
  curl_setopt($ch, CURLOPT_HEADER, 0);
  curl_setopt($ch, CURLOPT_POST, 1);
  curl_setopt($ch, CURLOPT_POSTFIELDS, $xml);
  curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 0);
  curl_setopt($ch, CURLOPT_REFERER, 'http://localhost/iPM/receiver.php');
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  $ch_result = curl_exec($ch);
  echo "Result = ".$ch_result;
  curl_close($ch); 
```

和接收器：

```
$xml = file_get_contents('php://input');

parsing the xml - storing to database
etc etc etc etc etc etc etc etc etc 
```

当我运行发送者脚本时，我需要从接收者那里得到一切正常并且收到 xml 文件的响应。我相信我会在这行代码中看到这一点，在我的代码中： `echo "Result = ".$ch_result;` 但我看到打印的唯一内容是`Result =`。

那我做错了什么？我应该在我的发件人/收件人上添加什么才能得到回复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T10:17:06.037

替换以下行：

```
$ch_result = curl_exec($ch);
echo "Result = " . $ch_result; 
```

使用以下几行，看看它是否有效：

```
$ch_result = curl_exec($ch);
$ch_header = curl_getinfo($ch);
echo "Status : " . $ch_header['http_code'] . "<br />";
echo "Result = " . $ch_result; 
```

[`curl_getinfo`](http://php.net/manual/en/function.curl-getinfo.php)返回有关请求的基本信息和变量`http_code`返回响应代码 200,404 等。然后您可以检查代码并根据您的要求对其进行解析。

希望能帮助到你。

# sed - sed：无法读取 /home/me/weather：没有这样的文件或目录

> ID：14390162
> 
> 赞同：0
> 
> 时间：2013-01-17T23:41:49.840
> 
> 标签：sed, conky

我从从 accuweather 获取天气信息的脚本中提取了以下内容：

```
wget -O ./weather_raw $address

if [[ -s ./weather_raw ]]; then

egrep 'Currently|Forecast<\/title>|_31x31.gif' ./weather_raw > ./weather
sed -i '/AccuWeather\|Currently in/d' ./weather
sed -i -e 's/^[ \t]*//g' -e 's/<title>\|<\/title>\|<description>\|<\/description>//g' ./weather
sed -i -e 's/&lt;img src="/\n/g' ./weather
sed -i '/^$/d' ./weather
sed -i -e 's/_31x31.*$//g' -e 's/^.*\/icons\///g' ./weather
sed -i -e '1s/.$//' -e '3s/.$//' -e '6s/.$//' ./weather
for (( i=2; i<=8; i+=3 ))
    do
        im=$(sed -n ${i}p ./weather)
        sed -i $i"s/^.*$/$(test_image $im)/" ./weather
    done

fi 
```

触发上述代码的命令位于 conkyrc 文件及其`~/.conkyblue/accu_weather/rss/acc_rss`. 当我从提示符运行 conkyrc 脚本时，出现错误

```
sed: can't read /home/me/weather: No such file or directory 
```

事实上，当我检查时，没有创建“天气”文件。但是，如果`~/.conkyblue/accu_weather/rss/acc_rss`直接从提示符运行命令，它会按预期工作并创建内容并将其放入 /home/me/weather 文件中。

我对 sed 命令一无所知，尽管由于这种麻烦，我正在尝试学习它。

代码可能有什么问题。我不认为这是一个权限问题，因为它写入的文件夹是我的主文件夹，我当然拥有它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:55:58.833

它应该是由 egrep 创建的。

当您运行脚本时，该`weather`目录将在`pwd`脚本进程中创建。

检查并查看 egrep 为什么不创建该文件，或者它在哪个目录中创建它。

# javascript - 全局变量不会被迭代

> ID：14390164
> 
> 赞同：-1
> 
> 时间：2013-01-17T23:42:25.120
> 
> 标签：javascript, function, variables, global-variables

我声明了一个全局变量*nrOfFoundIncidents*，每次发现“事件”时都会在函数内部进行迭代。但是，在函数执行后，变量再次为空，即使它是在函数外部声明的。

为什么会这样，我能做些什么呢？

```
var INCIDENT_MATCHES = {
    trafficAccidents: /(traffic|car) accident|/
    robberies: /...
    ...you get it.
};

// theIncidents[0] = "There was a robbery on the 52th street last nigth...";
// theIncidents[1] = "Two days ago a car crashed into a house...";
// theIncidents[2] = "One person got stabbed outside his home...";
... and so on...

var nrOfFoundIncidents = 0;

function FindIncidents(incidentReports) {
    var incidentCounts = {};
    var incidentTypes = Object.keys(INCIDENT_MATCHES);
    incidentReports.forEach(function(incident) {
        incidentTypes.forEach(function(type) {
            if(typeof incidentCounts[type] === 'undefined') {
                incidentCounts[type] = 0;
            }
            var matchFound = incident.match(INCIDENT_MATCHES[type]);
            if(matchFound){
                var matchFound = incident.match(INCIDENT_MATCHES[type]);
                nrOfFoundIncidents += 1;
                console.log(nrOfFoundIncidents);    // 1, 2, 3, 4, 5, 6, 7...
            }
        });
     });

     return incidentCounts;    // <- returns as it supposed
}

var objectOfIncidents = FindIncidents(theIncidents); <-- as an argument an object containing of categories with reg exp to find them in the text that is searched is provied.

console.log(nrOfFoundIncidents); // <--- 0 
```

**编辑：**我用其余代码更新了函数，因为存在遗漏相关信息的风险。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:25:47.950

您的代码实际上完全按照您的预期工作。请参阅this fiddle以获取证据。

[http://jsfiddle.net/vxbRV/](http://jsfiddle.net/vxbRV/)

它记录：

```
found a match 1
found a match 2
found a match 3
after code runs: 3 
```

这证明变量正在按照您的预期递增。

无论您遇到什么问题，都不是此发布代码的直接部分。

# asp.net - 将网站（asp.net）部署到 IIS 服务器

> ID：14390165
> 
> 赞同：0
> 
> 时间：2013-01-17T23:42:40.340
> 
> 标签：asp.net, windows, iis-7

我有一个要部署在 IIS 7 服务器上的网站。我能够添加网站，我也分配了一个 IP 地址（本地主机的 IP）和端口。例如，如果端口号是 8123，IP 地址是 127.0.0.1，而现在，当我尝试通过以下方式**从远程计算机**查看/浏览我的网站时：http : *//127.0.0.1* :8123它会打开一个**目录页面.** 我的网站中有 3 个表格，即；主页、仪表板和插入。如果我想浏览到 MainPage* **(http://127.0.0.1:8123/MainPage.aspx)***它会给出这样的运行**时错误**

“/”应用程序中的服务器错误。

> 说明：服务器上发生应用程序错误。此应用程序的当前自定义错误设置可防止远程查看应用程序错误的详细信息（出于安全原因）。但是，它可以被本地服务器机器上运行的浏览器查看。

```
<configuration>
>     <system.web>
>         <customErrors mode="Off"/>
>     </system.web> </configuration> 
```

> 注意：您看到的当前错误页面可以通过修改应用程序配置标记的“defaultRedirect”属性以指向自定义错误页面 URL 来替换为自定义错误页面。

```
<configuration>
>     <system.web>
>         <customErrors mode="RemoteOnly" defaultRedirect="mycustompage.htm"/>
>     </system.web> </configuration> 
```

我按照建议中的说明进行了更改，但问题仍然存在。帮助解决这个问题。我是新手，所以我不能说我遵循了正确的程序，无论如何，除了浏览部分之外，一切对我来说似乎都很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:49:37.953

删除这个

```
< customErrors mode="RemoteOnly" defaultRedirect="mycustompage.htm"/> 
```

把这个

```
<compilation debug="true" targetFramework="4.0"> 
```

那么你可以得到错误

# c++ - C++ 未定义对 ... 的引用以及警告：不推荐使用从字符串常量到 'char*' 的转换

> ID：14390168
> 
> 赞同：-6
> 
> 时间：2013-01-17T23:43:17.370
> 
> 标签：c++

在 C++ 中我得到这两个错误

```
undefined reference to 'Employee::Employee'
warning: deprecated conversion from string constant to 'char*' 
```

在我的代码的以下两部分中。我知道有很多关于此的主题，但我无法自己解决它....我必须做些什么来解决这个问题？

1.

```
Employee::Employee(SymbolStr sstr, int* egn, int* cd)
{
    sbstr=sstr;
    for(int i = 0; i < 10; i++)
        id[i] = egn[i];
    for(int i = 0; i < 4; i++)
        code[i] = cd[i];
} 
```

2.

```
int main()
{
    ofstream fileout("LuboHW.txt");
    cout << "Please, enter how many entries of employee's information would you like to make?" << endl;
    int count;
    cin >> count;
    //cin.ignore();
    Employee* emp = new Employee[count];
    for(int i = 0; i < count; i++)
    {
        cout << "Entering information about employee number " << i << ": " << endl;
        emp[i].read();
    }
    cout << "Please, enter the code of the desired employee position: " << endl;
    int cd[4];
    for(int i = 0; i < 4; i++)
        cin >> cd[i];
        //cin.ignore();
    //writing information about employee in fileout.txt, searching by code
    for(int i = 0; i < count; i++)
    {
        for(int j = 0; j < 4; j++)
        {
            if(*emp[j].getCode() == cd[i])
                continue;
            if(j == 3)
                fileout << emp[i] << endl;
        }
    }
    system("PAUSE");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T23:52:14.977

要调用`new Employee[count]`，您需要一个`Employee`默认构造函数 ( `Employee::Employee()`)。

`Employee::Employee(SymbolStr sstr, int* egn, int* cd)`不是默认构造函数。

# php - Wordpress、实体框架和 REST 服务集成……可能吗？

> ID：14390169
> 
> 赞同：0
> 
> 时间：2013-01-17T23:43:18.150
> 
> 标签：php, database, wordpress, entity-framework, rest

我们正在将我们的网站迁移到 WordPress，我遇到了一个令人困惑的问题，我不知道从哪里开始。

我们有一个全部存储在 SQL Server 中的产品信息管理器。我正在寻找一种将产品集成到 WordPress 系统中的方法。

现在有一个使用实体框架的数据访问层，我们现在正在使用 asp.net 解决方案来访问它。

我正在考虑要求我们的数据库开发人员为产品信息创建 REST 服务，但我不确定如何将其集成到 WordPress 中……如果可能的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T16:12:34.717

是的，这是可能的。

根据您需要公开的模型数量，如果您利用 Web API，创建服务也可能很简单。

至于将其集成到 WordPress 中，这是一个 PHP 任务，添加页面或编辑您的主题。因此，您将需要在 Google 上搜索一些关于在 PHP 中读取 JSON 或 XML 的示例，但这几乎就是这里的范围。我认为没有技术限制。

你可以从这里开始：http: [//php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T17:25:45.610

是的，你绝对可以做到。一旦您通过 REST 服务或任何其他基于 SOAP 的 Web 服务公开它。您可以从您的 Wordpress 中使用 thrm 。有一些插件可以帮助你。

[看看这里](http://wordpress.org/extend/plugins/tags/rest)

如果需要，您也可以创建自己的插件。对于您需要做的其他 PHP 内容和集成，我会同意 @MisterJames 的意见。

# android - Android - 如何将在 Windows 中制作的 Eclipse 项目导入 Mac

> ID：14390170
> 
> 赞同：1
> 
> 时间：2013-01-17T23:43:21.197
> 
> 标签：android, eclipse

我有一个在 Windows 上的 Eclipse 中制作的 Android 项目，现在我需要将该项目导入 Mac 上的 Eclipse。

我正在尝试使用导入项目工具。问题是项目未显示在要选择的项目列表中。

是否有另一种方法可以将项目导入 Eclipse Mac？或者也许我需要做一些不同的事情？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:41:48.907

我可以找到我的问题所在。

我的所有项目都在一个工作区文件夹中。因此，每次我尝试将我的项目导入新的 Mac Eclipse 时，我都无法在项目列表中看到它们。

问题是我从那个工作区文件夹和 Eureka 中取出我的项目，Eclipse 可以列出项目并且我可以导入它们。

我希望它可以帮助某人。

# php - Wordpress 延迟发布给非会员的内容

> ID：14390180
> 
> 赞同：0
> 
> 时间：2013-01-17T23:44:46.877
> 
> 标签：php, wordpress, membership

我有一个使用 WPMU Membership 插件的 wordpress 网站。我想在我的模板中添加代码，以便在向非会员显示新帖子前 5 天向会员显示新帖子。

像这样的东西：

```
if (current_user_on_level(17) && CODE TO DETERMINE IF POST IS LESS THAN 5 DAYS OLD) {
echo POST CONTENT; 
}
else { 
echo 'Info not available yet';
}
; 
```

我将使用什么代码来确定发布的帖子是否少于 5 天？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T16:00:06.410

我想出了答案。首先必须使用以下代码将发布时间转换为 UNIX 代码：

（True 将其设置为 UNIX 纪元时间，而不是设置为本地时区）

然后我用这段代码获取了 5 天前的 UNIX 时间

```
strtotime("-5 day") 
```

将两者与显示内容的 if 语句放在一起，或者如果还没有时间，则显示内容尚不可用的消息。

```
<?php 
$post_timestamp = get_post_time('U', true); 
if (current_user_on_level(17) && $post_timestamp <= strtotime("-1 day")) 
{
get_template_part( 'content', get_post_format() );  
}
else {
echo 'No post available yet <br />';
}?> 
```

唯一的问题是，因为我的帖子是按时间顺序排列的，所以我的博客顶部充满了“尚无可用帖子”这一行。谁能想到我怎样才能让这些陈述坐在底部？

# objective-c - 如何在 ObjC 中获取调用者函数的文件名和行号？

> ID：14390181
> 
> 赞同：1
> 
> 时间：2013-01-17T23:44:59.563
> 
> 标签：objective-c

由于许多脚本语言都有 caller()，我想在 ObjC 方法中获取调用者的信息。特别是，我在 dealloc 方法中需要它，该方法由编译器自动调用，因此我无法将任何参数传递给它。

因为 ObjC 异常有堆栈跟踪，所以我猜调用者信息存在于某处。如何在不引发异常的情况下获取信息？

```
-(void)dealloc {
  // get caller's information and NSLog() it here!
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:25:22.700

您是否考虑过使用 dtrace（http://www.mactech.com/articles/mactech/Vol.23/23.11/ExploringLeopardwithDTrace/index.html 有一些信息，谷歌搜索“mac dtrace”有更多信息）从在外面，而不是在里面添加东西呢？您可以通过这种方式获得*大量*信息，如果还不够，您甚至可以在应用程序中添加自定义静态探针以收集更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T23:46:48.387

您可以从[`backtrace(3)`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/backtrace.3.html)&& [`backtrace_symbols(3)`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/backtrace.3.html)C 函数中获取所需的信息。您可能需要一些诡计多端的技巧才能使它看起来适合 Objective-C 案例。

编辑：我收回了 -`backtrace_symbols`在这里为 Objective-C 测试程序提供了漂亮的输出：

```
0   example           0x0000000109274c77 +[TestClass classMethod] + 55
1   example           0x0000000109274cee -[TestClass instanceMethod] + 46
2   example           0x0000000109274dec main + 140
3   libdyld.dylib     0x00007fff914c37e1 start + 0

0   example           0x0000000109274c77 +[TestClass classMethod] + 55
1   example           0x0000000109274d36 -[TestClass dealloc] + 54
2   example           0x0000000109274e19 main + 185
3   libdyld.dylib     0x00007fff914c37e1 start + 0 
```

我拨通了`backtrace*`电话，`classMethod`从`instanceMethod`和 从拨通了电话`dealloc`。似乎在这两种情况下都有效，没问题。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-18T00:05:01.230

使用 self 和 _cmd？

```
NSLog(@"%@", self); 
```

# ruby - “rescue Exception => e”中的“=>”有什么作用？

> ID：14390182
> 
> 赞同：4
> 
> 时间：2013-01-17T23:45:03.290
> 
> 标签：ruby, syntax, rescue, hashrocket

举个例子：

```
def method_of_doom
my_string = "I sense impending doom."
my_string.ah_ha_i_called_a_nonexistent_method
rescue NoMethodError => e:
puts "PROBLEM: " + e.to_s
rescue Exception:
puts "Uhh...there's a problem with that there method."
end 
```

在上面写着：

```
rescue NoMethodError => e: 
```

'=>' 在做什么？

它与这种用法有何不同：

```
module FighterValues
BAMBOO_HEAD = { 'life' => 120, 'hit' => 9 }
DEATH = { 'life' => 90, 'hit' => 13 }
KOALA = { 'life' => 100, 'hit' => 10 }
CHUCK_NORRIS = { 'life' => 60000, 'hit' => 99999999 }

def chuck_fact
puts "Chuck Norris' tears can cure cancer..."
puts "Too bad he never cries."
end
end

module ConstantValues
DEATH = -5 # Pandas can live PAST DEATH.
EASY_HANDICAP = 10
MEDIUM_HANDICAP = 25
HARD_HANDICAP = 50
end

puts FighterValues::DEATH
→ {'life'=>90,'hit'=>13}

puts ConstantValues::DEATH
→ -5 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-18T00:54:03.070

### 哈希火箭是一种句法标记

哈希火箭实际上是一个句法令牌。您可以在由 定义的语法中找到标记`ext/ripper/ripper.y`：

```
%token tASSOC           /* => */ 
```

换句话说，Ripper 使用哈希火箭来*关联*事物。

### 如何使用 tASSOC

通常，此标记用于散列文字中以将键与值相关联。例如：

```
{ :e => 'foo' } 
```

将字符串文字`foo`与符号相关联`:e`。这种常见用法是人们倾向于将哈希火箭视为仅与哈希相关的构造的原因。

另一方面，以下将变量与异常相关联：

```
rescue => e 
```

在这种情况下，Ripper 不是将键与值相关联，而是将变量`e`与隐含的`StandardError`异常相关联，并使用变量来存储[Exception#message](http://www.ruby-doc.org/core-1.9.3/Exception.html#method-i-message)的值。

### 延伸阅读

如果您了解分词器、词法分析器和解析器，`ripper.y`并且其中的各种内容`ext/ripper/lib/ripper`具有指导意义。然而，在*显微镜下的 Ruby*第 19 页，Pat Shaughnessy 警告说：

> Ruby 不使用 Lex 标记化工具，C 程序员通常将其与 Yacc 或 Bison 等解析器生成器结合使用。相反，Ruby 核心手动编写了 Ruby 标记化代码。

当您尝试在源代码级别了解 Ruby 的语法时，请记住一些事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T23:46:06.143

[Ruby 信息页面上](https://stackoverflow.com/tags/ruby/info)有很多很好的链接。

这取决于上下文。

## 在 a 的上下文中，`rescue`它意味着：

“将异常对象分配给变量`e`。”

这样`e.to_s`以后就可以使用了。

## 在哈希文字中，它意味着：

一对，由 key=>value 表示。

这是由两对创建的哈希文字：`{:name => "Fred", :age => 20}`

（Ruby 1.9/2.0+ 还允许`{name: "Fred", age: 20}`语法、where`name`和`age`引用符号。）

## 在字符串中，它是这样的：

“=> 哇！”。

在这种情况下`puts FighterValues::DEATH`，相当于`puts FighterValues::DEATH.to_s`。也就是说，显示的输出来自一个*字符串*。考虑一下：`puts "{a => b}"`。

# css - 查找缺少的 CSS 类和 ID 的最简单方法

> ID：14390183
> 
> 赞同：12
> 
> 时间：2013-01-17T23:45:04.030
> 
> 标签：css, firefox, firebug

如何识别在代码中引用但在 css 文件中缺失的 css 类或 id？firebug 中是否有我可以使用的功能？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T10:45:04.607

Firebug 不这样做，也没有我能想到的任何工具，因为它不是一个常见或高回报的任务。

但是，查找未使用的 CSS 规则以便修剪它们***是一项常见任务。***您可以通过修剪常见的 CSS 文件来获得性能提升。但是从 HTML 页面中删除 ID 和类并没有多大帮助，而且更有可能破坏某些东西（见下文）。

用于查找未使用的 CSS 规则的一个很好/常见的 Firefox 插件是[*Dust-Me Selectors*](https://addons.mozilla.org/en-us/firefox/addon/dust-me-selectors/)。如果您真的想要一个工具来查找没有 CSS 规则的 ID 和类，您可能会[将该附加组件的源代码](https://addons.mozilla.org/en-us/firefox/files/browse/148586/)作为创建自己的 Firefox 扩展的良好起点。

* * *

删除 ID 和类，仅仅因为它们没有 CSS 规则不是一个好主意，并且可能会破坏事情。
ID 和类可以出于多种原因出现在页面中，而不仅仅是 CSS 的方便句柄。

以下是 ID 或类可能出现在页面中的一些原因：

1.  将内容识别为 javascript，或标记更改内容的目标。除了最简单的动态页面之外，这对于所有页面都是必须的。
2.  同样，插件、扩展、蜘蛛、RSS 工具等使用 Id 和类。
3.  作为状态或状态指示器。例如：`<p class="comment highest-rated">...`
4.  作为页内锚点的简单替代品。这些允许在不添加元素的情况下精确定位超链接。   [示例链接。](https://stackoverflow.com/questions/14390183/easiest-way-to-find-missing-css-classes-and-ids#footer-sites)
5.  作为良好[语义标记](http://robertnyman.com/2007/10/29/explaining-semantic-mark-up/)的一部分，这是帮助人类和我们的脚本理解、使用和维护页面的最佳实践。
6.  帮助定位 CSS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-05-27T04:44:11.323

[您可能会发现此链接](https://stackoverflow.com/questions/983586/how-can-you-determine-if-a-css-class-exists-with-javascript)上回答的问题很有用，Javascript 可用于搜索类。虽然，查找 CSS 未使用的类可能很有用，但请注意删除因其他原因可能需要的类（正如其他人指出的那样）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-20T10:12:53.257

带有 ReSharper 插件的 Visual Studio 可以做到这一点。它用蓝色波浪下划线显示每个缺失的类。

我不确定哪个版本，但我使用

*   Visual Studio 2013 高级版
*   ReSharper 版本 8.2.3

其他版本也可以。

# c++ - 在 if 语句中比较结构内的值

> ID：14390185
> 
> 赞同：-4
> 
> 时间：2013-01-17T23:45:17.453
> 
> 标签：c++

我正在用 C++ 编写分数简化器。我正在尝试比较结构中的两个值以查看哪个更大，以下均不起作用：

```
void simplify(struct Fraction* fraction) {
    if (fraction->numerator) > (fraction->denominator)
    {
        cout << "test";
    }
}

void simplify(struct Fraction* fraction) {
    if (fraction.numerator) > (fraction.denominator)
    {
        cout << "test";
    }
} 
```

结构：

```
struct Fraction {
    int numerator;
    int denominator;
}; 
```

错误：

```
w2.cpp: In function void simplify(Fraction*):
w2.cpp:40:15: error: request for member numerator in fraction, which is of non-class type Fraction*
w2.cpp:40:26: error: expected primary-expression before > token
w2.cpp:40:38: error: request for member denominator in fraction, which is of non-class type Fraction*
w2.cpp:41:2: error: expected ; before { token 
```

如何比较结构内的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T23:47:18.057

你有指针，所以你需要取消引用它们。你也有括号问题：

```
void simplify(struct Fraction* fraction) {
    if (fraction->numerator > fraction->denominator)
    {
        cout << "test";
    }
} 
```

您可以通过传递引用来避免所有这些指针取消引用的麻烦。另外，**删除不必要`struct`的 s**：

```
void simplify(const Fraction& fraction) {
    if (fraction.numerator > fraction.denominator) {
        cout << "test";
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T23:47:00.750

您只是缺少一对括号：

```
void simplify(struct Fraction* fraction) {
    if ( (fraction->numerator) > (fraction->denominator) )
    {
        cout << "test";
    }
} 
```

# ruby - 复合主键仅用于访问记录，不保存数据映射器中的记录

> ID：14390187
> 
> 赞同：2
> 
> 时间：2013-01-17T23:45:25.797
> 
> 标签：ruby, composite-primary-key, ruby-datamapper

我有一个应用程序可以跟踪玩家在健身计划中的进度。所以每个玩家都有多个相同的 :week_id 周

Week_id 结合belongs_to 关系是Week 记录的复合主键。

但是，当我尝试使用属于不同玩家的相同 week_id 创建两个星期时，我收到“column week_id is not unique”错误。

我觉得我走在正确的轨道上，因为当我想获取周记录时，它告诉我需要两个参数来获取它 - week_id 和 player_id。

我可能在这里遗漏了一些简单的东西。我希望你能给我看。

```
require "rubygems"  
require "json"
require "sqlite3"
require "data_mapper"
require "bigdecimal"

DataMapper::setup(:default, "sqlite3://#{Dir.pwd}/prod.db")

DataMapper::Model.raise_on_save_failure = true

class Player

    include DataMapper::Resource

    property :name, String, :key => true
    property :age, Integer

    has n, :weeks

end

class Week

    include DataMapper::Resource

    property :week_id, Integer, :key => true
    property :score, Integer

    belongs_to :player, :key => true

end

DataMapper.finalize.auto_migrate!

@jack = Player.create(:name => "jack")
@jack.weeks.create(:week_id => 1)

@jill = Player.create(:name => "jill")
@jill.weeks.create(:week_id => 1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-12T06:00:32.740

看起来你已经想出了一个解决方案，但我会继续为后代发布另一个答案，因为我遇到了同样的问题。

似乎将 ':player_name' 声明为作为键的属性以及使用 'belongs_to' 声明，您最终会使用相同的 SQL 来创建表，但它也认识到 week_id 是复合键的一部分，并且不需要是唯一的。（看来 DataMapper 的复合键在“property”和“belongs_to”声明之间存在问题。）

```
class Week

    include DataMapper::Resource

    property :week_id, Integer, :key => true
    property :player_name, String, :key => true
    property :score, Integer

    belongs_to :player, :key => true

end 
```

产生以下 SQL 来创建表：

~ (0.000000) CREATE TABLE "weeks" ("week_id" INTEGER NOT NULL, "player_name" VARCHAR(50) NOT NULL, "score" INTEGER, PRIMARY KEY("week_id", "player_name"))

而且您的示例代码可以正常工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T06:46:55.213

所以我最终像这样对我的 Week 模型进行了一个小改动

```
class Week

    include DataMapper::Resource

    property :id, String, :key => true
    property :week_id, Integer
    property :score, Integer

    belongs_to :player

end 
```

每当我创建一个新的 Player 模型时，我都会连接外键和 week_id 以创建 id 字符串

因此，对于 :id 为 "jack" 的玩家的第一条记录，我的 id 字符串看起来像 "jack1"

不确定这是否是 data_mapper 方式，但它有效。

# windows-7 - 无法使用 mingw/msys 安装 SDL

> ID：14390194
> 
> 赞同：1
> 
> 时间：2013-01-17T23:45:40.753
> 
> 标签：windows-7, mingw, configure, msys

我不知道这实际上是 SDL 问题还是只是我不知道如何从 msys/mingw 构建包。到目前为止我所做的：

1.  `mingw-get-inst.exe`从 sourceforge下载最新版本并运行它。这安装了一个`C:\MinGW\`目录，里面有 msys。这给我带来了我的第一个困惑。当我打开 mingw shell 时，它并没有像我预期的那样将我带到我的`/home/`目录（我以前使用过 mingw 并记得这很奇怪），它把我放在`/c/Users/me/`.

2.  我想这一定是我的主目录并将提取的内容`SDL-1.2.15/`放在这个位置。

3.  然后我跑了：

    ```
    cd SDL-1.2.15
    ./configure --help 
    ```

    但收到了`sh: ./configure: No such file or directory`。

4.  然后我创建了一个`/c/MinGW/msys/1.0/home/`目录，将其设置为 HOME 环境变量，将 SDL 文件夹移入其中并尝试再次配置，结果相同。

关于安装软件包，我真的不明白一些事情，我希望有人能弄清楚。我之前安装了一些，这`./configure; make; make install;`似乎是一个常见的程序。我知道 msys 提供了 的功能`make`，但是`configure`每个包中都应该包含一个文件吗？如果是这样，为什么它不在 SDL 包中/如何配置它？

我一直按照[这里](http://blog.pantokrator.net/2006/08/08/setting-up-msysmingw-build-system-for-compiling-sdlopengl-applications/)的说明进行操作，他们似乎在评论中为其他人工作。最底部的评论告诉它`mingw-get-inst`有效，尽管我确实尝试了两种方式。

我觉得我缺乏 msys/mingw 知识是我的问题。

我在Windows 7上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-07T13:49:24.967

我遇到了与您描述的相同的问题，经过一些研究后，我得到了 SDL、SDL_image 和 SDL_ttf 工作。

似乎*配置*文件只存在于源代码包中。我在下载 SDL_image 源代码后发现了这一点。所以，问题可能在于*配置*文件只出现在源包中。

但是，我遇到了其他问题，所以我不确定这是否为我解决了这个问题，但似乎应该如此。

# .net - 在不加载整个图像的情况下读取图像标题信息

> ID：14390204
> 
> 赞同：0
> 
> 时间：2013-01-17T23:46:36.407
> 
> 标签：.net, image, header, byte

我有一个将处理大量图像的 .net 3.5 应用程序。我需要检查图像扩展名、图像高度和宽度以及 PPI 是否正确。我不想将整个图像加载到 .net 图像或位图中，这将花费很长时间并且会占用大量资源。我不能使用第三方插件或dll，当然需要昨天完成。

所以，我正在读取文件的初始字节，检查“魔术”数字以确保图像扩展名匹配，然后是我需要处理的大多数图像类型的图像的高度和宽度。这速度更快，资源消耗更少。我可以使用一些帮助来从某些图像类型中读取 PPI，而到目前为止，其中两种类型让我无法验证扩展。

BMP、JPG、GIF 和 PNG 我在阅读 PPI 时需要帮助。

*   寻找类似位于偏移 xx 的东西。

TIF、EPS 和 PSD 我需要帮助来阅读高度、宽度和 PPI。

*   我几乎被困在 EPS 和 Psd 文件上，任何事情都会有所帮助。

*   是的，我知道 tiflib，它看起来很棒，而且远远超出了我的需要。一个只处理高度、宽度和 PPI 的更轻的版本会很棒。如果必须，我可以做到这一点，但我希望有人准备好了:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T22:45:05.927

*所有字节位置都假定第一个字节位于位置 1，而不是 0。*

**PNG 文件**宽度：字节 9-12，高度：字节 13-16，PPI：查找 112 72 89 115（十进制值）的 4 字节签名，字节 1-4（以下）包含每单位的 X 个像素，字节 5 -8 包含每单位的 Y 像素，字节 9 包含单位说明符（0=未知，1=米）。PPI 存储在一个可选的块中，可能并不存在于所有 PNG 中。

[http://www.libpng.org/pub/png/spec/iso/index-object.htm](http://www.libpng.org/pub/png/spec/iso/index-object.htm)或[http://en.wikipedia.org/wiki/PNG_file_format](http://en.wikipedia.org/wiki/PNG_file_format)

**BMP 文件**宽度：字节 18-21，高度：字节 22-25，PPI：字节 38-41 包含每米的 X 像素，字节 42-45 包含每米的 Y 像素。

[http://en.wikipedia.org/wiki/BMP_file_format](http://en.wikipedia.org/wiki/BMP_file_format)

**JPG 文件**JPEG 是指压缩，而 JFIF 是实际的文件存储格式。宽度：，高度：，PPI：字节 11-12 包含每单位的 X 像素，字节 13-14 包含每单位的 Y 像素。字节 10 包含单位（0=无单位，1=每英寸像素，2=每厘米像素）。

[http://en.wikipedia.org/wiki/JPEG_File_Interchange_Format](http://en.wikipedia.org/wiki/JPEG_File_Interchange_Format)和[http://www.ecma-international.org/publications/files/ECMA-TR/TR-098.pdf](http://www.ecma-international.org/publications/files/ECMA-TR/TR-098.pdf)

**GIF 文件**宽度：字节 7-8，高度：字节 9-10，PPI：GIF 文件不包含任何像素密度信息。

[http://en.wikipedia.org/wiki/Graphics_Interchange_Format](http://en.wikipedia.org/wiki/Graphics_Interchange_Format)

我提供了其他格式的链接，因为它们需要格式的特定知识来确定您请求的信息是否存储或存储在何处。

[http://partners.adobe.com/public/developer/tiff/index.html](http://partners.adobe.com/public/developer/tiff/index.html)

[http://en.wikipedia.org/wiki/Portable_Document_Format](http://en.wikipedia.org/wiki/Portable_Document_Format)和[http://www.adobe.com/devnet/pdf/pdf_reference_archive.html](http://www.adobe.com/devnet/pdf/pdf_reference_archive.html)

[http://www.adobe.com/devnet-apps/photoshop/fileformatashtml/](http://www.adobe.com/devnet-apps/photoshop/fileformatashtml/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-28T22:41:52.373

与其花费数百小时的开发时间编写和调试您自己的多格式图像解析器，我建议您寻找优化现有方法的方法。虽然有些图像格式很容易，但有些则很难。有些真的很难。如前所述，一些“格式”只是其他格式的容器。

以下是一些建议：

[加快在 Windows 窗体（c#.net）应用程序中从磁盘加载图像](https://stackoverflow.com/questions/1201228/speed-up-loading-an-image-from-disk-in-a-windows-forms-c-net-app)

[http://www.vcskicks.com/fast-image-processing.php](http://www.vcskicks.com/fast-image-processing.php)

[如何在 JPG 图像中找到每英寸像素值？](https://stackoverflow.com/questions/12485764/how-can-i-find-the-pixel-per-inch-value-in-a-jpg-image)

# java - Java Servlet JSP 使用 apache commons FileUpload 删除文件

> ID：14390206
> 
> 赞同：2
> 
> 时间：2013-01-17T23:46:42.263
> 
> 标签：java, jsp, servlets

我一直在寻找这个主题很长一段时间，并没有找到任何能够解决我的问题的东西..所以我求助于你！

我有一个 JSP，我在其中打开一个文件对话框来选择一个文件。以前，我使用它来将文件上传到指定目录（在我的代码中）。这工作正常。我现在尝试使用相同的代码删除相同的文件，方法是在适当的目录中选择它并将其传递给我在下面包含的 servlet。我正在使用 Apache Common FileUpload 库来执行此操作。

```
protected void doPost(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {
    // checks if the request actually contains upload file
    if (!ServletFileUpload.isMultipartContent(request)) {
        // if not, we stop here
        return;
    }

    // configures some settings
    DiskFileItemFactory factory = new DiskFileItemFactory();

    ServletFileUpload delete = new ServletFileUpload(factory);

    // constructs the directory path to delete file
    String deletePath = UPLOAD_DIRECTORY;

    // parses the request's content to extract file data
    List formItems = delete.parseRequest(request);
    Iterator iter = formItems.iterator();

    // iterates over form's fields
    while (iter.hasNext()) {
        FileItem item = (FileItem) iter.next();

        // processes only fields that are not form fields
        if (!item.isFormField()) {

            String fileName = new File(item.getName()).getName();
            String filePath = deletePath + File.separator + fileName;
            File storeFile = new File(filePath);

            //File storeFile = new File("C:\\temp\\discLogo.txt");

            // deletes the file on disk
            boolean erased = storeFile.delete();
            }
        } 
```

UPLOAD_DIRECTORY 是我从上传 JSP 存储文件的地方。如果我用硬编码目录取消注释我为 storeFile 注释掉的行，删除方法就可以正常工作，只要我最初在目录中选择一个不同的文件。这让我相信 HttpServletRequest 将文件保存在内存中的某个地方。

它是否正确？有什么办法可以释放它，以便我可以删除最初选择的文件？还是有更简单的方法来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:21:20.220

如果文件根本不存在（用于预先测试），或者文件被另一个应用程序甚至您自己的代码打开而被锁定，则将`File#delete()`返回！`false``File#exists()`

如果此文件是由您自己的代码预先写入磁盘并保证不会在其他地方打开，那么您应该确保在写入文件内容后`OutputStream#close()`在块中调用。`finally`这个问题表明你没有。如果您在写入文件后保持打开状态，则在重新启动服务器/JVM 之前无法将其删除。

作为 FileUpload 的依赖项，您应该已经拥有 Apache Commons IO，它带有方便的实用方法，可减少文件复制和关闭样板文件。

```
InputStream input = item.getInputStream();
OutputStream output = new FileOutputStream(storeFile);

try {
    IOUtils.copy(input, output);
} finally {
    IOUtils.closeQuietly(output);
    IOUtils.closeQuietly(input);
} 
```

### 也可以看看：

*   [我如何在 java webapp 中的服务器上保存和检索图像](https://stackoverflow.com/questions/8516387/how-i-save-and-retrieve-an-image-on-my-server-in-a-java-webapp/8521981#8521981)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T23:53:02.967

上传文件的对象是什么？您要按内容检查所有文件吗？

我想说更简单的方法是不上传整个文件。您要做的是调用一些代码 - JSP/Servlet - 作为参数传递文件的 ID（通常是*服务器内部*的路径）并使其删除文件。如果上传的所有文件都在同一个文件夹中，那么名称应该足够了（*）。

毕竟，通过上传文件，你是在强迫你在你的 PC 中拥有你想要删除的文件的副本（如果你删除了本地文件怎么办？你应该无法删除服务器中的文件吗？）

(*) 一定要执行安全检查，这样任何人都不能`..\..\WEB-INF\web.xml`作为参数传递。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-04T06:59:14.733

您可以删除该文件，因为平台独立的解决方案是这样的

```
File deleteFile = new File(<file Path> ) ;
// check if the file  present or not
if( deleteFile.exists() )
deleteFile.delete() ; 
```

注意如果文件路径是目录，那么在删除之前目录必须为空。 [上传文件或删除](http://www.dreamincode.net/forums/topic/56494-file-upload-servlet/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T21:18:59.703

看起来我的问题出在我的 JSP 中。我最初有以下表格：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>File Delete</title>
</head>
<body>
    <form method="post" action="DeleteServlet"
        enctype="multipart/form-data">
        Select file to delete: <input type="file" name="dataFile"
            id="fileChooser" /><br />
        <br /> <input type="submit" value="Delete" />
    </form>
</body>
</html> 
```

我通过`encytype="multipart/form-data"`从表单中删除来更改它，然后能够使用 request.getParameter("dataFile") 来获取文件名。

# php - PHP JSON 对象将在本地主机上呈现，但不会从远程服务器呈现

> ID：14390207
> 
> 赞同：0
> 
> 时间：2013-01-17T23:46:44.160
> 
> 标签：php, javascript, ajax, json

我正在为我们当地的田径俱乐部创建一个非常简单的移动应用程序。当我在本地主机上对其进行测试时，该应用程序似乎工作正常，但是当我将链接更改为指向我的远程服务器然后打包该应用程序时，似乎什么也没有呈现。我希望这是一个非常容易解决的问题。这是我想使用 JSON 对象使用 Javascript 将其填充到 HTML 框架中的页面。

```
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>United Track Club</title>
<link href="jquery-mobile/jquery.mobile-1.0.1.min.css" rel="stylesheet" type="text/css"/>
<!-- This reference to phonegap.js will allow for code hints as long as the current site has been configured as a mobile application. -->

<script src="jquery-mobile/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="/phonegap.js" type="text/javascript"></script>
<script src="jquery-mobile/jquery.mobile-1.0.1.min.js" type="text/javascript"></script>

<!--a name="viewport"content="width=device-width, initial-scale=1"> -->
</head>

<body>
<div data-role="page" id="runnerListPage">
<div data-role="header">
<h1>Runners2</h1></div>
<div data-role="content">

     <ul id="runnerList" data-role="listview" data-filter="true">
     </ul>

   </div>
   <div data-role="footer" data-position="fixed">
   <div data-role="navbar">
      <ul>
        <li><a href="index.html" data-icon="home">Home</a></li>
        <li><a href="#searchListPage" data-icon="search">Search</a></li>
        <li><a href="#scheduleListPage" data-icon="grid">Schedule</a></li>
     </ul>
    </div>
    </div>
    </div>

   </body>
   </html> 
```

这是我为填充上述代码而创建的 JS。

```
$.getJSON('http://unitedtrack.org/Mobile/TF/getrunnerlist.php', function(data){
var object = data.items,
runnerCount = object.length, 
target = document.getElementById('runnerList'),
i;

if (runnerCount>0){
    for (i =0 ; i< runnerCount; i=i+1){
        var unitrun=object[i],
        EventDt = unitrun.First_Nm,
        MeetNm = unitrun.Last_Nm;
target.innerHTML +='<li><a href="#">'+ EventDt +', ' +MeetNm +' </a></li>';
}
}
else {
    alert('there are no runners');
}
});

target.addEventListener("click",data,false); 
```

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:53:04.007

您需要在您查询的页面上设置适当的标题（例如[http://unitedtrack.org/Mobile/TF/getrunnerlist.php](http://unitedtrack.org/Mobile/TF/getrunnerlist.php)）。

您需要设置[Access-Control-Allow-Origin](http://www.w3.org/TR/cors/)标头。有关跨域请求的更多信息，请参阅链接。

# rdbms - MySQL Workbench Forward Engineer (Generate DDL) 能否针对 MySQL 以外的关系型数据库（如 MS SQL Server、PostGreSQL、Oracle 等）

> ID：14390217
> 
> 赞同：0
> 
> 时间：2013-01-17T23:47:26.477
> 
> 标签：rdbms, mysql-workbench, erd, forward-engineer

我的印象是 MySQL Workbench 可用于为 MySQL 以外的关系数据库生成 DDL。

这个2010 年的[问题](https://stackoverflow.com/questions/3391130/forward-engineering-to-sql-server-from-mysql-workbench)说不，唯一的方法是为 MySQL 生成 DDL，然后手动转换它。

期间有没有发生什么变化？有什么插件吗？

谢谢——马修·莫伊森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T16:59:39.850

我是一名 MySQL Workbench 开发人员，我可以直接告诉您，这没有任何改变。

# python - 重塑熊猫系列？

> ID：14390224
> 
> 赞同：24
> 
> 时间：2013-01-17T23:48:24.543
> 
> 标签：python, numpy, pandas, reshape

在我看来，它就像 pandas.Series 中的一个错误。

```
a = pd.Series([1,2,3,4])
b = a.reshape(2,2)
b 
```

b 有类型 Series 但无法显示，最后一条语句给出异常，非常冗长，最后一行是“TypeError: %d format: a number is required, not numpy.ndarray”。b.shape 返回 (2,2)，与其类型 Series 相矛盾。我猜也许 pandas.Series 没有实现重塑功能，我正在从 np.array 调用版本？有人也看到这个错误吗？我在熊猫 0.9.1。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-01-18T00:15:30.670

您可以调用系列[`reshape`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.reshape.html)的*值*数组：

```
In [4]: a.values.reshape(2,2)
Out[4]: 
array([[1, 2],
       [3, 4]], dtype=int64) 
```

我实际上认为应用于系列并不总是有意义`reshape`（您是否忽略索引？），并且您认为它只是 numpy 的重塑是正确的：

> `a.reshape?`
> `Docstring: See numpy.ndarray.reshape`

*也就是说，我同意它让你尝试这样做的事实看起来像一个错误。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:23:55.670

reshape 函数将新形状作为一个元组而不是多个参数：

```
In [4]: a.reshape?
Type:       function
String Form:<function reshape at 0x1023d2578>
File:       /Library/Frameworks/EPD64.framework/Versions/7.3/lib/python2.7/site-packages/numpy/core/fromnumeric.py
Definition: numpy.reshape(a, newshape, order='C')
Docstring:
Gives a new shape to an array without changing its data.

Parameters
----------
a : array_like
    Array to be reshaped.
newshape : int or tuple of ints
    The new shape should be compatible with the original shape. If
    an integer, then the result will be a 1-D array of that length.
    One shape dimension can be -1\. In this case, the value is inferred
    from the length of the array and remaining dimensions. 
```

Reshape 实际上是在 Series 中实现的，会返回一个 ndarray：

```
In [11]: a
Out[11]: 
0    1
1    2
2    3
3    4

In [12]: a.reshape((2, 2))
Out[12]: 
array([[1, 2],
       [3, 4]]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-15T12:47:00.387

只需使用以下代码：

```
b=a.values.reshape(2,2) 
```

我想它会对你有所帮助。你只能直接使用 reshape() 函数。但它会给出未来的警告

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-05T17:21:04.420

你可以直接使用`a.reshape((2,2))`reshape一个Series，但是你不能直接reshape一个pandas DataFrame，因为pandas DataFrame没有reshape功能，但是你可以在numpy ndarray上做reshape：

1.  将 DataFrame 转换为 numpy ndarray
2.  重塑
3.  转换回来

例如

```
a = pd.DataFrame([[1,2,3],[4,5,6]])
b = a.as_matrix().reshape(3,2)
a = pd.DataFrame(b) 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2020-09-02T16:07:29.123

例如我们有一个系列。我们可以像这样将其更改为数据框；

a = pd.DataFrame(a)

# php - 使用 PHP 进行 MySQL 排序

> ID：14390228
> 
> 赞同：0
> 
> 时间：2013-01-17T23:48:30.920
> 
> 标签：php, mysql

我正在尝试完成以下情况：

```
$mysql_query = "
  SELECT * 
  FROM st_users 
  WHERE 
      `user_comp_supervisor_id` = '$team_supervisor' AND 
      `user_exempt_from_goals` = '0' 
  ORDER BY 'calculate_progress_percent()' ASC
"; 
```

我知道我无法通过 MySQL 语句中的函数完成排序，但我试图弄清楚如何获取所有返回的记录，然后从 php 函数结果中按从高到低的顺序对它们进行排序。任何想法将不胜感激；几个小时以来，我一直在努力解决这个问题...... :-(

```
 function diy_calc_progress_percent($user_id,$period_id,$period_week_number)
    {
        $this->user_id = $user_id;
        $this->period_id = $period_id;
        $this->period_week_number = $period_week_number;

        if ($this->period_week_number == 1)
        {
            $this->week_id = mysql_result( mysql_query(" SELECT `period_week_one` FROM `st_comp_periods` WHERE `period_id` = '$this->period_id' "),0 );
        }
        else if ($this->period_week_number == 2)
        {
            $this->week_id = mysql_result( mysql_query(" SELECT `period_week_two` FROM `st_comp_periods` WHERE `period_id` = '$this->period_id' "),0 );
        } 
        else
        {
            echo "Week number not valid.";
            exit();
        }

        $this->week_start_date = mysql_result( mysql_query(" SELECT `week_start_date` FROM `st_comp_weeks` WHERE `week_id` = '$this->week_id' "),0 );

        $this->week_end_date = mysql_result( mysql_query(" SELECT `week_end_date` FROM `st_comp_weeks` WHERE `week_id` = '$this->week_id' "),0 );

        $this->user_department = $this->user_info($this->user_id,"user_comp_department_id");

        $this->user_week_diy_goal = mysql_result( mysql_query(" SELECT `goal_diy_department` FROM `st_comp_department_goals` WHERE `goal_department_id` = '$this->user_department' AND `goal_week_id` = '$this->week_id' "),0 );

        $this->calc_totals_result = mysql_query("SELECT SUM(record_total_diy_revenue) AS user_week_total FROM `st_entered_records` WHERE `record_user_id` = '$this->user_id' AND `record_date` BETWEEN '$this->week_start_date' AND '$this->week_end_date'");
        $this->calc_totals_row = mysql_fetch_assoc($this->calc_totals_result);
        $this->user_week_total = $this->calc_totals_row['user_week_total']; 
        $this->user_week_one_percent = ($this->user_week_total / $this->user_week_diy_goal) * 100;
        $this->user_week_one_percent = number_format( (float)$this->user_week_one_percent, 2, '.', '' );

        return $this->user_week_one_percent;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:32:27.457

你可能不得不做一些数组杂耍。首先将您的所有条目从 st_users 获取到第一个数组（mysql_query）然后您可以遍历该数组，并为每个条目执行 calculate_progress_percent() 并构建第二个数组，您可以在其中添加附加信息（“user_progress_percent” ）。在此之后，您可以根据您的新信息（“user_progress_percent”）对新数组进行排序。

这里有一些快速而肮脏的代码建议——但是代码没有经过测试……当然……:)

第一的：

```
$mysql_query = "SELECT * FROM st_users 
WHERE `user_comp_supervisor_id`='$team_supervisor' AND 
      `user_exempt_from_goals` = '0'"; 
```

然后是这样的：

```
$i = 0;
while($tmp = mysql_fetch_array($mysql_query)) {
    $my_second_array[$i]['user_id'] = $tmp['user_id'];
    $user_id = $my_second_array[$i]['user_id'];
    diy_calc_progress_percent($user_id,$period_id,$period_week_number);
    $my_second_array[$i]['user_result'] = $diy_calc_progress_percent_result;
    $i++;
} 
```

然后应该可以对第二个数组进行排序，如下所述：

[按值排序多维数组](https://stackoverflow.com/questions/2699086/sort-multidimensional-array-by-value-2)

…希望这在某些时候有所帮助…</p>

# c# - 我应该在哪里填充我的下拉列表以保留其选择？

> ID：14390229
> 
> 赞同：0
> 
> 时间：2013-01-17T23:48:38.627
> 
> 标签：c#, asp.net

我已经看到建议我在 if(!IsPostback) 块中填充列表的帖子。

但是，我只生成下拉列表以响应回发，所以我认为这对我不起作用。

我目前所做的是将下拉列表数据绑定到`Page_Init`. 但是，当我使用“检查元素”在进行新选择后检查列表（因此触发了自动回发）时，我看到列表中的第一项始终是“选中的”。

请让我知道如何通过回发保持选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T03:26:36.043

如果您在 Page_Init 中绑定控件，那么您将失去您的选择。不要那样做。

绑定一次控件，ViewState 会保留控件数据。But when the selection changes, that will be sent to the server, and the `SelectedIndexChanged`event will fire.

* * *

更一般地说，在阶段之前在控件上设置的任何属性`Render`都将保存在 ViewState 中。在下一次 PostBack 时，控件将加载 ViewState 的内容，因此将自身恢复到 PostBack 之前的状态。

然后，控件将记录在 PostBack 上发送的任何 POST 值。这包括对选择、文本框内容等的更改。该控件将触发适当的*something* Changed 事件，以指示 ViewState 的先前状态发生了更改。

# ios - LUMINANCE_ALPHA 的缩放问题

> ID：14390230
> 
> 赞同：2
> 
> 时间：2013-01-17T23:48:47.400
> 
> 标签：ios, opengl-es, textures

我目前正在扩展我的 OpenGL-UI 系统，为此我重写了字体部分并遇到了使用 mipmapping 时出现的问题。因为图像表达了超过数千个单词的事实：

![字体问题](../Images/eaf017733a2580bb4792b7c8cb33d012.png)

如您所见，字体的透明度正在消失（文本应显示 8 次！），这仅在使用`LUMINANCE_ALPHA`-textures 时发生。加载纹理的代码基本相同，但它们使用的格式不同，这就是`LUMINANCE_ALPHA`用途：

> TexImageInternalFormat.LUMINANCE_ALPHA，TexImageFormat.LUMINANCE_ALPHA，TexImagePixelType.UNSIGNED_BYTE

启用线性过滤并将钳位设置为`GL_CLAMP_TO_EDGE`。对我来说，这似乎是一个 mipmapping 问题，但我尝试了很多不同的设置，但它不起作用，正如我已经说过的，RGBA 纹理工作没有任何问题。该应用程序还可以在 iOS 上运行，因此`LUMINANCE_ALPHA`与 RGBA 相比，使用 -texture 可以节省大量内存。

什么可能导致这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T19:12:58.263

事实证明，`ImageFormat`设置是错误的：

```
LA8 = new ImageFormat("LA8", TexImageInternalFormat.LUMINANCE_ALPHA, TexImageFormat.LUMINANCE_ALPHA, TexImagePixelType.UNSIGNED_BYTE, 4); 
```

最后一个数字表示此格式的每个像素的字节数，在`LUMINANCE_ALPHA`. PVR 阅读器不会抱怨丢失的图像数据，也没有抛出异常。将 4 更改为 2 即可解决问题。

# qt - QtCreator Designer 信号/槽连接与生成的代码不一致

> ID：14390231
> 
> 赞同：0
> 
> 时间：2013-01-17T23:48:58.973
> 
> 标签：qt, qt-creator

我正在 QtCreator 中开发一个 Qt 项目。该项目有一个带有多个 UI 元素的对话框，其中一些必须根据用户的操作来启用/禁用。（即，如果用户选择单选按钮，则必须启用表单字段。）

当我通过 Qt Designer 工具添加新的信号/插槽连接或删除现有的连接时，更改在预览中显示得很好。但是，当我编译应用程序时，窗口的行为仍然与以前完全相同。

我通过检查`ui_WindowName.h`Qt Designer 创建的文件对此进行了调查。接近`setupUi`函数末尾的是一组`connect()`调用。这些`connect()`调用与今天早些时候存在的槽和信号是一致的，但它们并没有反映我从那时起通过 Qt Designer 所做的更改。

如果我手动更改`ui_WindowName.h`文件，则 UI 可以工作。但是，当然，如果我尝试从 Qt Designer 中获得任何机会，我的更改就会被覆盖。

即使我退出 QtCreator 并再次打开它，Designer 仍然显示更改的插槽/信号连接，而自动生成的代码不反映更改。

难道我做错了什么？有什么方法可以删除 Designer 存储的任何缓存，或者让事情恢复同步吗？

谢谢！

（另一件事：我使用的是独立的 Qt Creator，而不是尝试在 Visual Studio 中开发。我在网上可以找到的唯一其他类似问题是来自在 Visual Studio 中开发的人，它不支持自动化信号/插槽的东西。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T04:12:40.407

像往常一样，一旦你意识到答案就很明显了。

我在处理它的过程中移动了这个项目。有一个 .pro.user 文件可以跟踪项目所在的位置。没有意识到这一点，我将它与其余文件一起移动。

结果，我正在编辑该项目的一个副本并运行另一个。

故事的寓意：如果您移动 Qt 项目，请记住更新您的 .pro.user 文件。

（或者你可以直接删除它。当你打开项目时，Qt Creator 会提示你重新创建它。）

# c# - 使用 SQL 从多个表中拉取数据并在一个视图中显示

> ID：14390237
> 
> 赞同：1
> 
> 时间：2013-01-17T23:49:28.197
> 
> 标签：c#, sql, asp.net-mvc, ado.net, crud

我已经创建了我的应用程序并使用了数据库优先方法。所以我使用 ADO.net 实体数据模型将我的数据库添加到项目中，然后以这种方式添加控制器，我认为我没有任何模型可以这么说？但无论如何，我已经添加了控制器，并且 CRUD 已自动添加到每个实体中。

我的问题是，我想在一个网页上查看许多表中的数据。我可以通过 sql 执行此操作，但如何使用 sql 提取我需要的数据并将其显示在屏幕上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T03:31:40.850

为了建立一点戴夫A的答案：

我个人喜欢使用数据库优先 EF 进行这种类型的检索。

构建 EDMX 后，创建一个简单、直接的 POCO，以模仿您想要返回的内容。一个简单的例子是：

```
public class ComplexModelFromMultipleTables
{
   List<Car> Cars { get; set; }
   List<Bike> Bikes { get; set; }
   List<Boat> Boats { get; set; }
} 
```

一旦您在数据库中建立了反映在 EDMX 中的关系，就可以通过您喜欢的模式在提供程序中访问它。一个简单的使用模式总是好的，尽管我用映射器构建了更复杂的对象。

```
public ComplexModelFromMultipleTables GetObject
using (var db = new DBContext())
{
    var model = new ComplexModelFromMultipleTables
    {
        Cars = db.Cars.Where(x => x.CarType == whateveryouwant).ToList(),
        Bikes = db.Bikes.Where(x => x.anotherproperty == whateveryouwant).ToList(),
        Boats = db.Boats.Where(x => x.something else == whateveryouwant).ToList(),
    }
    return model;
} 
```

从您的控制器调用此提供程序并使用

```
@model ComplexModelFromMultipleTables 
```

在您的视图顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:05:24.450

我假设您指的是创建实体模型的 EF Code First 方法。

如果我是对的，那么您与使用实体（表映射类）作为视图的模型的常见做法相冲突。

当我第一次搭建页面时，我经常使用实体作为模型。但正如您所发现的，它们很少适用，我经常发现自己迁移到更健壮的模型。

1）我建议您在模型目录中创建一个类库。嵌入使您的类中的多个实体成员。

例如，您可以拥有一个 CustomeActivityModel，它还具有客户、销售和订单的成员。

```
class CustomeActivityModel
{
      Customers CustomerList { get; set; }
      Sales SalesList { get; set; }
      Orders OrdersList { get; set; }
} 
```

在您的控制器中，您将填充它们

```
 ViewResult Index()
{
   CustomeActivityModel Model = new CustomeActivityModel();
   Model.CustomerList EFContext.Customers;
   Model.SalesList EFContext.Sales;
   Model.OrdersList EFContext.Orders;
   Return View(Model);
} 
```

或者，您可以使用 EF 的 Linq 功能来包含具有关键关系的实体（假设销售具有客户和订单的外键）

```
 ViewResult Index()
{
   Model = EFContext.Sales.include("Customers").include("Orders");
   Return View(Model);
} 
```

# ruby - 有哪些方法可以从 WSDL 文件自动生成 ruby 客户端存根？

> ID：14390239
> 
> 赞同：4
> 
> 时间：2013-01-17T23:49:32.520
> 
> 标签：ruby, soap

我正在使用 Ruby 和 Savon gem 与 SOAP/WS 交互，并希望从 Ruby 中的 WSDL 自动生成客户端请求方法。

在我这样做之前，我想知道是否有任何其他 Ruby/SOAP 库可以做到这一点？

*编辑：请注意，我已经知道这在 Savon 中不可用，实际上我的意图是添加该功能，我正在检查它是否存在于其他用 Ruby 编写的地方。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T15:13:57.797

因为你问这个问题才几天，而且我遇到了同样的问题，我决定创建一个小脚本来做到这一点。

下载 - 例如另存为*objects.rb*并使用 _bunde exec objects.rb path_to.wsdl_ 运行

[https://gist.github.com/4622792](https://gist.github.com/4622792)

让我知道它是否有效^^

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:02:28.253

看看[Savon 的规范](https://github.com/savonrb/savon/tree/master/spec)，它有相当丰富的测试环境

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-08T02:14:48.470

我认为`ads_common`谷歌与你相关。

[google-api-ads-ruby/ads_common at master · googleads/google-api-ads-ruby](https://github.com/googleads/google-api-ads-ruby/tree/master/ads_common)

`rake generate`可以从 WSDL 自动创建客户端库。

它专门用于 Google Ads，但这个概念将有助于从 Ruby 中的 WSDL 自动创建多功能客户端库。

# http - 网络服务器是否应该忽略额外的查询参数或返回错误？

> ID：14390242
> 
> 赞同：1
> 
> 时间：2013-01-17T23:49:43.313
> 
> 标签：http, rest

我正在实现一个 RESTful Web 服务器的逻辑，它支持使用类似 SolR 的语法进行搜索。以下是一些常见的有效请求：

*   “https://www.somewhere.com/fooResource/123”
*   “https://www.somewhere.com/fooResource/456”
*   “https://www.somewhere.com/fooResource?q=title:hi”
*   “https://www.somewhere.com/fooResource?q=title:hello&sort=foo”

我的问题很笼统；如果我收到这样的请求，我该怎么办？

*   “https://www.somewhere.com/fooResource?q=title:hi&something=foo”

我收到了一个对我没有意义的查询参数“something”，我们的搜索引擎将忽略它。我是不是该

*   立即返回 4xx 状态码
*   忽略它并返回 200 结果
*   根据我的用例，要么我是“正确的”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:53:40.543

许多网页只是忽略了他们没有预料到的东西。

通常 URL 和参数是在浏览器或 Web 服务客户端上单击某些内容或运行某些代码的结果。这些很少会提交任何意想不到的东西。

如果出于某种原因，您希望有人欺骗您的网站并以某种方式提交“hackish”请求，您可能希望通过识别非法参数并返回一些错误来锁定它们。4xx 对于 REST 服务是合理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:52:58.460

阅读 HTTP 状态定义。我会练习不返回任何带有错误信息的东西。400 的定义在`The request could not be understood by the server due to malformed syntax. The client SHOULD NOT repeat the request without modifications.`这里似乎是合适的，但您的用例可能不这样认为。

如果您忽略，您没有向客户提供任何信息。他们可能永远不知道出了什么问题。

# schema.org - 如何标记 Schema.org 产品的替代部件号？

> ID：14390243
> 
> 赞同：1
> 
> 时间：2013-01-17T23:49:48.397
> 
> 标签：schema.org

我们一直在使用 schema.org 在网络上使用元数据标记我们的产品。

我们有一个系统，其中我们有产品的备用零件号，客户希望能够搜索任何备用零件号。

使用 schema.org 或 GoodRelations 我们应该如何标记替代零件号？我们认为我们应该在 Web 上每个部件有一页，而不是每个备用部件号一页，但我们确实希望 Google 和 Bing 能够在语义上找到并理解我们的备用部件号？

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-28T17:04:24.793

“产品部分”概念可以在 GoodRelations 中由类 ProductOrServiceModel ( [http://purl.org/goodrelations/v1允许的对象属性 isAccessoryOrSparePartFor (](http://purl.org/goodrelations/v1#ProductOrServiceModel) [http://purl.org/goodrelations/v1#isAccessoryOrSparePartFor ) 表示](http://purl.org/goodrelations/v1#isAccessoryOrSparePartFor)[#产品或服务模型](http://purl.org/goodrelations/v1#ProductOrServiceModel)）

对于 Google 或 Bing 是否在当前实施中考虑到此属性，我没有答案。这是一个移动的目标，也许你最好的选择是试一试。

# post - 澄清 POST 到站点

> ID：14390250
> 
> 赞同：0
> 
> 时间：2013-01-17T23:50:42.357
> 
> 标签：post

假设我要使用 www.mysite.com?user=myuser 发布到站点，这会模拟与该表单关联的提交按钮吗？如果是这样，如果表单中有多个提交按钮会发生什么？

此外，如果该按钮的 html`<input name="button" class="button" type="button" value="Save" onclick="javascript: submit()" disabled>`与“禁用”属性类似，这是否意味着我无法发布 www.mysite.com?user=myuser/won't work？

```
<form name="Form" method="post" action="/thisAction.do">
    <input type="text" name="inquiryNo" maxlength="11" value="" onkeyup="javascript: checkNo()">
    <input name="buttonInquire" class="button" value="Inquire" onclick="javascript: submitInquire()" type="button">

    <!--Then comes a number of other inputs-->
    <input.../>
    <input.../>
    <input.../>

    <input name="modify" class="button" type="button" value="Save"
            onclick="javascript: submitModify()" disabled>

</form> 
```

这是一些示例代码，因为它是我不允许分享的工作内容。因此，当我使用查询操作时，一个新帐户成功加载，详细信息显示在页面上。修改操作旨在“修改”这些详细信息，但它只返回页面上显示的相同详细信息。我没有得到任何反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:06:05.183

您*可以*使用查询字符串（ 之后的内容`?`）发布到 URL，并且由于您说您正在使用`urllib2`参数`data`，这就是发生的情况。然后，服务器可以读取 POST 数据和查询字符串，并做它想做的任何事情，尽管大多数时候它们被合并在一起或者查询字符串被完全忽略。

`disabled`只会阻止您单击浏览器中的按钮（即使那样，您也可以使用 Firebug 之类的工具取消禁用它）。您可以将任何您想要的内容发布到您想要的任何 URL；HTML 无法阻止您，但如果服务器愿意，它仍然可以给您一个错误。

* * *

我认为您的问题是“查询”是默认操作，并且您的 POST 有问题。因此，无论您发送什么，服务器都无法识别它并退回到“查询”。

看起来该表单旨在发送`modify=Save`。你能发布你实际运行的 Python 代码吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-17T23:56:14.603

不，您实际输入的是 GET 方法。

提交数据有两种方式：POST 和 GET。

Post 是通过使用网页中的表单提交数据，该表单在后台发布到另一个表单，而 GET 将数据设置在 url 本身中，如 user=myuser。

如果 Web 程序员实际上正在检查 POST 方法，大多数情况下使用 GET 方法（url 查询字符串）将不起作用。如果程序员正在等待 GET 请求并且您实际 POST 请求，也会发生同样的情况。

但是有一个名为 REQUEST 的 php var 可以与 GET 和 POST 一起使用。

我不是 PHP 方面的专业人士，但是因为您目前没有答案，所以我尽力解释它。希望有高手过来解释一下。

您在我回复时编辑了您的问题，因此您需要有人回答您的第二个问题。

# android - 如何将数字 editText 字段与变量联系起来，以便它们可以双向自动更新？

> ID：14390251
> 
> 赞同：0
> 
> 时间：2013-01-17T23:50:43.077
> 
> 标签：android, android-edittext

在代码中，我有一个整数变量。在 GUI 中，我有一个数字 editText 字段和两个按钮，它们将变量的值增加/减少一。

我需要将该字段链接到变量，以便该字段在每次更改时显示变量的当前值（即按下按钮），并在用户使用 Android 键盘编辑字段时自动设置变量值。最好，我希望它自动更新变量而无需按“完成”（如果可能的话），但是我还需要设置数量限制。此外，每次更改值时都需要调用一个方法。

我已经能够找到如何根据请求从 editText 读取值（到变量），以及如何将特定文本设置到字段中（从变量）。但是，当我需要动态地将字段用作输入和输出时，这似乎不太实用。例如，当按下按钮时，它会更改变量，然后更改字段，但这也会触发 onTextChanged 观察程序，然后再次获取字段文本并将其设置为值。我假设必须有一种更有效的方法来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:03:35.137

没有必要发明轮子。Android 框架为此提供了小部件 - [NumberPicker](http://developer.android.com/reference/android/widget/NumberPicker.html)。

* * *

**编辑：**如果你不能或不想使用`NumberPicker`，这里的想法是：

```
private class NumberPicker {
    private int value=0;

    private Button btnIncr;
    private Button btnDecr;
    private EditText editText;

    public NumberPicker(Button btnIncr, Button btnDecr, EditText editText) {
        this.btnIncr=btnIncr;
        this.btnDecr=btnDecr;
        this.editText=editText;

        this.btnIncr.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                value++;
                NumberPicker.this.editText.setText(String.valueOf(value));
            }
        });

        this.btnDecr.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                value--;
                NumberPicker.this.editText.setText(String.valueOf(value));
            }
        });

        editText.addTextChangedListener(new TextWatcher() {
            @Override
            public void beforeTextChanged(CharSequence s, int start, int count, int after) {
            }

            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                value=Integer.parseInt(s.toString());
            }

            @Override
            public void afterTextChanged(Editable s) {
            }
        });
    }

    public int getValue() {
        return value;
    }
} 
```

并且不要担心当按钮更改值时会触发 TextWatcher。这不应该引起任何问题。

# wordpress - Wordpress 错误和错误

> ID：14390253
> 
> 赞同：2
> 
> 时间：2013-01-17T23:50:52.093
> 
> 标签：wordpress

我有一个几乎修复的网站，但我遇到了一些错误......所以我尝试重新安装主题，但 Wordpress 会记住之前的所有设置（标题等）......导致这种情况发生的问题是该站点的侧面有一个不需要存在的白条，并且它将站点缩小了一半……在我的笔记本电脑，台式机和iphone上。此外，滑块不显示我的特色幻灯片。尝试添加新滑块时，我在页面顶部收到此错误：

> 注意： wp_deregister_script 被错误调用。在 wp_enqueue_scripts、admin_enqueue_scripts 或 init 挂钩之前，不应注册或排队脚本和样式。有关更多信息，请参阅 WordPress 中的调试。（此消息是在 3.3 版中添加的。）在 /home/setli/public_html/wp-includes/functions.php 的第 2944 行

[这](http://setlistshow.com/)是有问题的网站。

我会雇人帮我尽快解决这个问题并通过 Paypal 支付给你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T05:05:15.477

引用：

> 注意： wp_deregister_script 被错误调用。在 wp_enqueue_scripts、admin_enqueue_scripts 或 init 挂钩之前，不应注册或排队脚本和样式。

你是`wp_deregister_script`直接调用包含的函数吗？应该使用[actions](http://codex.wordpress.org/Plugin_API/Action_Reference)调用这些函数。您应该使用`add_action('wp_enqueue_scripts', 'your_function_name');`来运行该函数，而不是直接调用该函数。

如果脚本用于 WordPress 仪表板，则使用`admin_enqueue_scripts`而不是。`wp_enqueue_script`

**阅读更多：**

[admin_enqueue_scripts()](http://codex.wordpress.org/Plugin_API/Action_Reference/admin_enqueue_scripts)

[wp_enqueue_script()](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:03:45.457

页面顶部的导航区域中有一个大图像（1600 像素宽）。此图像导致整个站点向外推并偏移包含的`div`.

您需要将此添加到您的 CSS 以修复：

```
#logo {
    width: 100%;
    overflow: hidden;
} 
```

至于您在问题中提出的错误，我在任何地方都看不到。我建议从服务器上完全删除您的主题，然后再次下载/安装它。你最近更新主题了吗？这些问题是从什么时候开始出现的？

此外，看起来正在使用两个主题。您是否使用框架和子主题？尝试更改/禁用子主题。

# c - GDB：如果变量相等则中断

> ID：14390256
> 
> 赞同：99
> 
> 时间：2013-01-17T23:51:11.997
> 
> 标签：c, gdb

当变量等于我设置的某个值时，我喜欢让 GDB 设置一个断点，我尝试了这个示例：

```
#include <stdio.h>
main()
{ 
     int i = 0;
     for(i=0;i<7;++i)
        printf("%d\n", i);

     return 0;
} 
```

GDB 的输出：

```
(gdb) break if ((int)i == 5)
No default breakpoint address now.
(gdb) run
Starting program: /home/SIFE/run 
0
1
2
3
4
5
6

Program exited normally.
(gdb) 
```

如您所见，GDB 没有设置任何断点，GDB 可以做到这一点吗？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2013-01-18T00:43:05.927

除了嵌套在断点内的观察点之外，您还可以在“文件名：行号”上设置单个断点并使用条件。我发现有时更容易。

```
(gdb) break iter.c:6 if i == 5
Breakpoint 2 at 0x4004dc: file iter.c, line 6.
(gdb) c
Continuing.
0
1
2
3
4

Breakpoint 2, main () at iter.c:6
6           printf("%d\n", i); 
```

如果您像我一样厌倦了更改行号，您可以添加一个标签，然后在标签上设置断点，如下所示：

```
#include <stdio.h>
main()
{ 
     int i = 0;
     for(i=0;i<7;++i) {
       looping:
        printf("%d\n", i);
     }
     return 0;
}

(gdb) break main:looping if i == 5 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-01-18T00:00:37.947

您可以为此使用观察点（数据上的断点而不是代码）。

您可以从使用`watch i`.
然后使用`condition <breakpoint num> i == 5`

您可以通过使用获取断点编号`info watch`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-18T00:37:09.943

首先，您需要使用适当的标志编译您的代码，以便在代码中进行调试。

```
$ gcc -Wall -g -ggdb -o ex1 ex1.c 
```

然后用你最喜欢的调试器运行你的代码

```
$ gdb ./ex1 
```

给我看代码。

```
(gdb) list
1   #include <stdio.h>
2   int main(void)
3   { 
4     int i = 0;
5     for(i=0;i<7;++i)
6       printf("%d\n", i);
7   
8     return 0;
9   } 
```

在第 5 行中断并查看 i == 5。

```
(gdb) b 5
Breakpoint 1 at 0x4004fb: file ex1.c, line 5.
(gdb) rwatch i if i==5
Hardware read watchpoint 5: i 
```

检查断点

```
(gdb) info b
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x00000000004004fb in main at ex1.c:5
    breakpoint already hit 1 time
5       read watchpoint keep y                      i
    stop only if i==5 
```

运行程序

```
(gdb) c
Continuing.
0
1
2
3
4
Hardware read watchpoint 5: i

Value = 5
0x0000000000400523 in main () at ex1.c:5
5     for(i=0;i<7;++i) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-18T00:21:42.000

有硬件和软件观察点。它们用于读取和写入变量。你需要参考一个教程：

[http://www.unknownroad.com/rtfm/gdbtut/gdbwatch.html](http://www.unknownroad.com/rtfm/gdbtut/gdbwatch.html)

要设置观察点，首先需要将代码分解到环境中存在变量 i 的位置，然后设置观察点。

`watch`命令用于设置写、`rwatch`读和`awatch`读/写的观察点。

# java - Java - 使用 wait() 和 notify()

> ID：14390257
> 
> 赞同：0
> 
> 时间：2013-01-17T23:51:15.497
> 
> 标签：java, multithreading, deadlock

这不是[Java 的副本，使用同步方法的多线程](https://stackoverflow.com/questions/11526460/java-multithreading-with-synchronized-methods)……他没有问同样的问题。

我正在尝试编写一个使用多线程和死锁的程序。我无法理解在同步方法中如何以及在何处使用 wait() 和 notify() 以使线程等待并使用 notify() 将其唤醒。我有它让第一个线程在 ping 语句之后等待，以便下一个线程也将启动它的 ping 语句。但是我有一个 notify() 来唤醒第一个线程，但我不知道为什么线程不会唤醒。以下是我的输出：

```
Starting...1
Girl (ping): pinging Boy
Boy (ping): pinging Girl
Girl (ping): asking Boy to confirm
Boy (confirm): confirm to Girl
Girl (ping): got confirmation
Boy (ping): asking Girl to confirm
Girl (confirm): confirm to Boy
Boy (ping): got confirmation 
```

我的代码死锁，或者我没有正确使用等待和通知，因为它在这里停止：

```
Starting...1
Girl (ping): pinging Boy
Boy (ping): pinging Girl
Girl (ping): asking Boy to confirm
Boy (confirm): confirm to Girl
Girl (ping): got confirmation 
```

这是我的代码：

监视器.java

```
class Monitor {
String name;

   public Monitor (String name) { this.name = name; }

   public String getName() {  return this.name; }

   public synchronized void ping (Monitor p) {
      p.release(p);
      System.out.println(this.name + " (ping): pinging " + p.getName());
      notify();
      try { wait(); } catch (Exception e) {}
      System.out.println(this.name + " (ping): asking " + p.getName() + " to confirm");
      p.confirm(p);
      System.out.println(this.name + " (ping): got confirmation");
   }

   public synchronized void confirm (Monitor p) {
      System.out.println(this.name + " (confirm): confirm to " + p.getName());
   }

   public synchronized void release (Monitor p) {
      notify();
   }
} 
```

亚军.java

```
public class Runner extends Thread {
Monitor m1, m2;

    public Runner (Monitor m1, Monitor m2) { 
      this.m1 = m1; 
      this.m2 = m2; 
    }

    public void run () {  
       m1.ping(m2);  
    }
} 
```

死锁.java

```
public class DeadLock {
   public static void main (String args[]) {
      int i=1;
      System.out.println("Starting..."+(i++));
      Monitor a = new Monitor("Girl");
      Monitor b = new Monitor("Boy");
      (new Runner(a, b)).start();
      (new Runner(b, a)).start();
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:16:30.537

您正在调用：

```
(new Runner(a, b)).start();
// which effectively calls in run()
a.ping(b); 
```

这锁定`a`调用 notify on`a`然后等待`a`。

另一个线程调用：

```
(new Runner(b, a)).start();
// which effectively calls in run()
b.ping(a); 
```

这锁定`b`调用 notify on`b`然后等待`b`。

由于两个线程都没有通知另一个线程，因此它们永远不会离开该状态。我不确定您要完成什么，因此很难弄清楚如何修复代码。

**编辑：**

现在你已经编辑了你的代码，你就有了一个更标准的死锁。

*   第一个线程锁定`a`然后尝试锁定`b`以通知它。
*   第二个线程锁定`b`然后尝试锁定`a`以通知它。

每个线程都有自己的锁，但需要另一个锁才能继续。经典的僵局。

我建议你学习使用调试器@OhioState22。设置断点并单步执行您的代码。这是一个不错的[Eclipse 教程](http://vogella.com/articles/EclipseDebugging/article.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:51:19.817

As a rule avoid using Java's wait() and notify() and prefer one of Java 5's concurrency features instead, e.g. ReentrantLock. The reason is that if a thread calls notify() before your thread hits wait(), the subsequent call to wait() will block and depending on your algorithm, indefinitely. Lookup the javadocs for [RenetrantLock](http://docs.oracle.com/javase/6/docs/api/)

# resize - 网格窗格调整大小

> ID：14390261
> 
> 赞同：3
> 
> 时间：2013-01-17T23:51:27.480
> 
> 标签：resize, constraints, javafx, layout-manager

我想要一个网格窗格布局，如附图所示。有人知道怎么做还是我使用了错误的布局？ ![在此处输入图像描述](../Images/ee6ebb33356e214bd7cb8b356db76a60.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T00:01:59.247

您可以使用列和行约束来控制 GridPane 中不同行和列的增长方式。

这样做的方法是`hgrow`将第一列的属性设置为 ALWAYS，`vgrow`将第一行的属性设置为 ALWAYS - 这意味着左上角的单元格将始终展开。您可以将其他单元格设置为固定宽度/高度，否则它们将扩展以适应其内容，仅此而已。

我在 AnchorPane 中包含了一个带有 GridPane 的 FXML 示例，并锚定在 AnchorPane 的顶部、左下角和右侧。这意味着 GridPane 将增长到填充父 AnchorPane：

```
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import java.util.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.paint.*?>

<AnchorPane id="AnchorPane" prefHeight="400.0" prefWidth="600.0" xmlns:fx="http://javafx.com/fxml">
  <children>
    <GridPane AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
      <columnConstraints>
        <ColumnConstraints hgrow="ALWAYS" />
        <ColumnConstraints prefWidth="150" />
      </columnConstraints>
      <rowConstraints>
        <RowConstraints vgrow="ALWAYS" />
        <RowConstraints prefHeight="150" />
      </rowConstraints>
    </GridPane>
  </children>
</AnchorPane> 
```

这将导致此处显示的布局，并展开以填充父窗格：

![结果布局](../Images/48b7be35b2649da4828e2eb200947889.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:24:46.523

原来我想要做的事情需要`AnchorPane`和`GridPane`.

# php - 提交详细信息后如何检索ID

> ID：14390262
> 
> 赞同：0
> 
> 时间：2013-01-17T23:51:36.130
> 
> 标签：php, mysql, sql, database, mysqli

我的数据库设计存在重大缺陷。下面是我的四个表：

**会话表：**

```
SessionId  SessionName
3           EROEW 
```

**问题表：**

```
QuestionId(PK)  QuestionNo  QuestionContent  SessionId (FK)
11              1           Question1        3    
12              2           Question2        3
13              3           Question3        3 
```

**图片_问题：**

```
ImageQuestionId (PK) ImageId (FK) SessionId (Fk)  QuestionNo (FK)
1                    1              3               1
2                    2              3               2 
```

**图片：**

```
ImageId (PK)  SessionId (Fk)  QuestionNo (FK)
1              3               1
2              3               2 
```

现在正如您在`Image_Question`表中看到的那样，`QuestionNo`指的`QuestionNo`是非唯一的或换句话说非唯一的字段。现在我认为这是不好的做法。

现在我知道你会说为什么不使用`QuestionId`. 问题是我不能使用`QuestionId`，因为图像是在提交问题之前上传到每个问题的，而我们可以自己提出问题的唯一方法`QuestionId`是在用户提交问题之后。

所以我尝试做的是通过`QuestionNo`从页面获取`SessionId`.

现在我听说这是一种不好的做法，我想改成`QuestionNo (FK)`. 但是在提交问题后，我将无法上传文件并插入上传的详细信息以获取，对我来说这是无法完成的。`Image_Question``QuestionId (FK)``QuestionId`

所以我的问题是，有没有一种方法可以将每个上传的图像存储到临时表中，获取每个图像所属的问题编号和 sessionid，然后从那里能够找到并将值`QuestionId`存储在表中？`QuestionId``Image_Question`

下面是我当前的 php 代码，它在上传图像后插入值：

如果有人可以更新下面的代码，那就太好了，但任何答案都会有所帮助：

```
 move_uploaded_file($_FILES["fileImage"]["tmp_name"],
      "ImageFiles/" . $_FILES["fileImage"]["name"]);
      $result = 1;

    $imagesql = "INSERT INTO Image (ImageFile) 
    VALUES (?)";

    //Dont pass data directly to bind_param store it in a variable
$insert->bind_param("s",$img);

//Assign the variable
$img = 'ImageFiles/'.$_FILES['fileImage']['name'];  //GET THE IMAGE UPLOADED

 $insert->execute();

        $insert->close();

        $lastImageID = $mysqli->insert_id; 

$_SESSION['lastImageID'] = $lastImageID; 
$_SESSION['ImageFile'] = $_FILES["fileImage"]["name"]; 

        $sessid =  $_SESSION['id'] . ($_SESSION['initial_count'] > 1 ? $_SESSION['sessionCount'] : ''); GET THE NAME OF THE SESSION    

$sessionquery = "SELECT SessionId FROM Session WHERE (SessionName = ?)";  //FIND SESSIONID by finding it's SESSIONNAME

// Bind parameter for statement
$sessionstmt->bind_param("s", $sessid);

// Execute the statement
$sessionstmt->execute();

// This is what matters. With MySQLi you have to bind result fields to
// variables before calling fetch()
$sessionstmt->bind_result($sessionid);

// This populates $sessionid
$sessionstmt->fetch();

    $sessionstmt->close();        

 $imagequestionsql = "INSERT INTO Image_Question (ImageId, SessionId, QuestionNo)  //INSERT DETAILS INTO CURRENT IMAGE_QUESTION TABLE
    VALUES (?, ?, ?)"; 

     if (!$insertimagequestion = $mysqli->prepare($imagequestionsql)) { 
      // Handle errors with prepare operation here 
       echo "Prepare statement err imagequestion"; 
    } 

$qnum = (int)$_POST['numimage']; //QUESTION NUMBER IMAGE IS UPLOADED IN

$insertimagequestion->bind_param("iii",$lastImageID, $sessionid, $qnum); 

    $insertimagequestion->execute(); 

                if ($insertimagequestion->errno) { 
          // Handle query error here 
        } 

        $insertimagequestion->close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:02:12.230

您最大的问题是您的架构没有标准化。这样做应该会对你有所帮助。
以下是我推荐的构建数据库的方法：

**会议：**

```
SessionId  SessionName
3          EROEW 
```

**问题：**

```
QuestionId(PK)  QuestionContent  SessionId (FK)
11              Question1        3    
12              Question2        3
13              Question3        3 
```

**图片：**

```
ImageId (PK)
1           
2 
```

**图片_问题：**

```
ImageId (FK) QuestionId (FK) -- (Composite primary key)
1            11
2            12 
```

表的插入顺序应为：

```
Session -> Question -
                     \
                      -- Image_Question
                     /
              Image - 
```

您将避开潜在的更新问题和数据冲突。

# xcode - 我需要有关在 Xcode 中使用 NSUserDefaults 的信息

> ID：14390264
> 
> 赞同：0
> 
> 时间：2013-01-17T23:51:39.817
> 
> 标签：xcode, nsuserdefaults

我在发布我在这里找到的问题时遇到了这些信息：

“Apple 为提交到应用商店的应用添加了额外规则。

我们不能再在 Documents 文件夹中存储任意数据文件。只有用户生成的内容（例如他们手动键入并保存的文本文件或他们用相机拍摄的照片）才能保存在 Documents 文件夹中。

我们现在应该将应用程序生成的文件存储在 Library/Cache 文件夹而不是 Documents 文件夹中。此外，我们应该使用跳过备份属性标记我们不想同步到 iCloud 的文件。

不遵守此规定将导致应用程序被 Apple 拒绝。

原因：Documents 文件夹现在用于同步到 iCloud。iCloud 每隔几分钟就会进行一次同步，如果我们将应用程序生成的数兆字节的文件存储在 Documents 文件夹中，它就会与用户自己的 iCloud 同步文件混在一起。”

这让我想知道我在应用程序中使用 NSUserDefaults 的方式在苹果眼中是否“合法”。

我正在制作一个简单的应用程序，它在大约五个不同的地方接受用户输入。我将这些简单的字符串保存在 NSUserDefault 变量中。

对于完全理解上述引文中陈述的任何人，我的问题是：

我是否以苹果不再允许的方式保存数据？

我是开发游戏的新手，引号中的信息并没有让我清楚（在我的应用程序的情况下）我是否错了。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:23:00.627

NSUserDefault 是官方的、受支持的存储用户首选项的方式。如果这就是您要存储的内容，那么这是正确的方法。

# javascript - Jquery取消按钮输入占位符文本

> ID：14390265
> 
> 赞同：0
> 
> 时间：2013-01-17T23:51:43.593
> 
> 标签：javascript, jquery

我之前问过这个问题，但是在没有正确信息的情况下问了这个问题，又来了。我需要做的是取消按钮“list_btn_cancel”关闭弹出活动并用输入占位符替换输入的内容。该表是输入。

```
 <table  width="100%" style="line-height:0px" >
        <tr>
            <td><p>1.</p></td>
            <td><input name="activities_thoughts_1" id="activities_thoughts_1" type="text" style="width:345px;" placeholder="Type or click list button &gt;" /></td>
            <td><input type="button" id="thoughts_1"  class="list_btn ext_thoughts" value="List &gt;" /></td>
        </tr>

        </table>

    **this table is the popup**

    <div id="popup_activity" class="box_list">

          <div id="list_question_btn"></div></div>
        </div>
        <div id="activity_area_content" style="padding-bottom:5px;" >
    <form name="form1">   

    <table class="style2" width="100%">
        <tr><br />
          <td width="8%" align="right"><input name="thoughts_list" id="thoughts_list_0" class="thoughts_list" type="radio" value="It is just terrible that my child will not be a normal kid" /></td>

      </table>
    </form>
    </div>
  </div>

    <div><table><td><a style="margin-left:290px" onclick="closeDialog('popup_activity');"><input type="button" id="thoughts_cancel"  class="list_btn list_btn_cancel" value="Cancel &gt;" placeholder="Type or click list button &gt;"  /></a></td>&nbsp;<td><a onclick="closeDialog('popup_activity');"><input style="margin-left:10px" type="button" id="close_thoughts"  class="list_btn list_btn_close" value="Close &gt;" /></a></td></table></div></div>

    **Here is the script**
    $('.list_btn').button();

    $('#popup_activity').css("display","none");
    $('#list_help').css("display","none");

    $('.ext_thoughts').click(function(){
        openDialog('popup_activity');
        btn_id= $(this).attr('id');
    });

    $('.thoughts_list').click(function(){
        ( $(this).attr('id'));
        $("#activities_" +btn_id).val($(this).val());
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:58:41.970

很难从你的问题中确切地弄清楚你想要做什么，但如果你想要的只是让文本输入恢复到它的占位符文本，只需将它的值设置为空白。

```
$("#activities_thoughts_1").val(''); 
```

这是一个例子[http://jsfiddle.net/arG5f/](http://jsfiddle.net/arG5f/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:07:35.277

好吧，不太明白你想要什么，但这是我认为你想要的：

```
<!DOCTYPE html>
<html lang="en">
  <head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(function()
    { 
    $('.ext_thoughts').click(function(){
        $("#popup_activity").toggle();  
    });
    $('.list_btn_cancel').click(function(){
            $("#popup_activity").hide();
        $("#activities_thoughts_1").val('');
     }); 
    });
</script>
  </head>
  <body>
<input name="activities_thoughts_1" id="activities_thoughts_1" type="text" style="width:345px;" placeholder="Type or click list button " />
<br>
<input type="button" id="thoughts_1"  class="list_btn ext_thoughts" value="Show/Hide List" />
<input type="button" id="thoughts_cancel"  class="list_btn list_btn_cancel" value="Cancel" />
<br>

<div id="popup_activity" class="box_list" style="display:none;">
This is the pop up division         
</div>
</body>
</html> 
```

[在这里提琴](http://jsfiddle.net/aaaheatair/g9axT/)

# jquery - 如何停止jquery函数

> ID：14390266
> 
> 赞同：0
> 
> 时间：2013-01-17T23:51:50.480
> 
> 标签：jquery, function, animation

我想在我的网站上使用由 Jquery 动画制作的小帮助框。一切都很好，但是当我快速进出盒子时，它开始像疯了一样躲藏起来。有什么办法可以停止功能隐藏框？这是我的帮助框：http: [//jojo.i-web.sk/test/box.php](http://jojo.i-web.sk/test/box.php)

这是代码：

```
<body>
    <center>!!LOOK AT DOWN RIGHT CORNER!!</center>
    <div id="help-box">
        <div id="help_sipka">
            <<
        </div>
        <div id="help_problem_nadpis">
            <h1>Do you have problem?</h1>
            Click here.
        </div>
        <div id="help_problem_button">
            <div style="float:right;"><acronym title="Zatvoriť"><input id="help_zavri" class="button_zavri" type="button" value="X"></acronym></div>
            <h1>Do you have problem?</h1>
            Have you lost password or found bug? Do you need help<br>
            We can help you.<br>
            Send mail to our admins.<br>
            <input class="button_odosli" type="button" name="posli_mail" value="Send mail">
        </div>
    </div>
    <script type="text/javascript">
        $(function() {
        var help_finished=1;

            $('#help-box').mouseenter(function(){
                if(help_finished!=2) {
                    help_finished=1;
                    $('#help-box').animate({width:'200'});
                    $('#help_sipka').delay(500).slideUp();        
                    $('#help_problem_nadpis').delay(500).slideDown();
                }
            });

            $('#help-box').mouseleave(function(){ 
                if (help_finished ==1) {
                    setTimeout(hide_box, 500);
                    help_finished=0;
                }
            });

            function hide_box() {
                if (help_finished==0||help_finished==3) {
                    $('#help_sipka').slideDown();        
                    $('#help_problem_nadpis').slideUp();
                    $('#help-box').delay(300).animate({width:'30'});
                }  
            }

            $('#help_zavri').click(function(){
                help_finished=3
                $('#help_problem_button').slideUp();
                $('#help-box').animate({opacity:'0.75'});
                hide_box();        
            });

            $('#help-box').click(function(){
                if(help_finished!=3) {
                    help_finished=2;
                    $('#help-box').animate({opacity:'1'});
                    $('#help_problem_button').slideDown(); 
                    $('#help_problem_nadpis').slideUp(); 
                }
            });
        });
    </script>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T23:55:13.347

使用 jquery[停止](http://api.jquery.com/stop/)方法：

```
// Will stop the current animation and then start a fadeout.
$(this).stop(true, true).fadeOut(); 
```

所以在你的例子中，你可能想要这样做：

```
$('#help-box').stop(true,true).animate({width:'200'}); 
```

此外，您可以使用完成的委托查看在上一个动画之后触发下一个动画，因此您不需要对延迟进行硬编码：

```
$('#help-box').stop(true,true).animate({width:'200'}, function () {
        $('#help_sipka').slideUp(function () {
           $('#help_problem_nadpis').slideDown();
        }); 
 }); 
```

由于您正在使用超时，因此您需要在设置新的超时函数之前使用[clearTimeout将其保存在变量中并清除它：](http://www.w3schools.com/jsref/met_win_cleartimeout.asp)

```
// keep this variable scoped outside the method call.
var timeout;

//... Whenever you set the timeout, clear it before you set a new one.
clearTimeout(timeout);
timeout = setTimeout(hide_box, 500); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T23:55:03.473

是的，它是`.stop()`。

当你开始一个新的动画时，你可以这样做。

```
$('selector').stop(true, true).animate({}); 
```

`stop()`使用这些参数会清除 jQuery 的动画队列并强制当前动画停止，从而允许正在进行的动画立即开始。

**[文档](http://api.jquery.com/stop/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T23:56:19.797

你要这个：

```
$(this).stop(true); 
```

jQuery .stop() 文档 - [http://api.jquery.com/stop/](http://api.jquery.com/stop/)

# c# - 更新此扩展以处理 FlatLoopValueInjection

> ID：14390267
> 
> 赞同：0
> 
> 时间：2013-01-17T23:51:52.963
> 
> 标签：c#, generics, valueinjecter

我在 stackoverflow 上找到了这段代码，但我注意到它无法处理 FlatLoopValueInjection，我想让它处理这个，但我不知道如何处理。

```
public static ICollection<TTo> InjectFrom<TFrom, TTo>(this ICollection<TTo> to, IEnumerable<TFrom> from) where TTo : new()
        {
            foreach (var source in from)
            {
                var target = new TTo();
                target.InjectFrom(source);
                to.Add(target);
            }
            return to;
        } 
```

我知道这需要更新 `target.InjectFrom(source);`，但我不确定如果它可以接受任何东西（FlatLoopValueInjection、UnflatLoopValueInjection 等）并使用它会更好

# php - 使用 curl 从另一台服务器下载文件

> ID：14390271
> 
> 赞同：0
> 
> 时间：2013-01-17T23:52:38.967
> 
> 标签：php, file, curl, download

我正在尝试使用 curl 下载远程文件我在不同的文件和服务器中测试了此代码，它工作正常，但在这里不起作用

```
$ch = curl_init();
$targetFile = fopen( 'FindchipsExport.xls', 'w' );
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_VERBOSE, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Content-Type: application/vnd.ms-excel"));
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (X11; Linux i686; rv:6.0) Gecko/20100101 Firefox/6.0Mozilla/4.0 (compatible;)");
curl_setopt($ch, CURLOPT_URL, 'http://www.findchips.com/mySearchListToExcel?distributors=1567');
curl_setopt( $ch, CURLOPT_FILE, $targetFile );
curl_exec( $ch );
fclose( $targetFile ); 
```

# hibernate - 使用 Hibernate 的二级缓存有什么缺点？

> ID：14390275
> 
> 赞同：9
> 
> 时间：2013-01-17T23:53:00.893
> 
> 标签：hibernate, caching

我看到很多文章说在Hibernate中使用二级缓存会提高性能，但没有太多关于使用它的缺点。我不想将二级缓存视为一种神奇的“在这里启用免费更好的性能！” 按钮。谁能描述使用二级缓存的缺点，以便我了解使用它的含义？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T03:34:22.537

另一个答案中引用的观点似乎是有效的。然而，对我来说，主要的缺点是别的：

1.  性能下降。是的，拥有缓存并不一定会给您带来更好的性能。Hibernate 需要做额外的工作来存储和更新缓存。如果缓存的实体经常更改而您不经常查询它们，那么启用缓存只会增加不必要的额外负担。

2.  缓存失效。如果您的应用程序具有通过不更新实体的方式执行更新的逻辑（例如，直接 SQL 更新、通过其他应用程序更新、批量 HQL 更新（我不太确定最后一种情况：P）），Hibernate 将不知道实体发生变化。因此，当您进行查询时，您仍然会在更新之前获得图像。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-18T00:57:21.180

缺点：

1.  集群部署需要一种方法来保持缓存同步。我们使用了一个简单的 EhCache 和我们自己的利用 JGroups 的失效例程（高努力 - 推荐反对它）并使用 Infinispan。如果你走 infinispan 路线，你需要启用 XA 事务。这将需要您的应用服务器提供的 XA 驱动程序和事务管理器，或者您必须使用 Atomikos。
2.  存在边缘情况（例如多对一或一对多情况），其中实体的更新/删除未正确反映在集合中。一个例如：[http](http://www.tikalk.com/java/forums/hibernate-second-level-cache-collection-eviction) ://www.tikalk.com/java/forums/hibernate-second-level-cache-collection-eviction ）

# java - 打开一个新的 jframe，并在该 jframe 中显示指定的 jpanel

> ID：14390281
> 
> 赞同：0
> 
> 时间：2013-01-17T23:53:19.950
> 
> 标签：java, netbeans

```
Toevoegen frame = new Toevoegen();
frame.setVisible(true); 
```

这为我打开了新框架，但是有没有办法显示指定的 jpanel，因为在那个 jframe 中有一个 tabbedpane，我想显示（指定的）选项卡

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T23:58:06.553

您可以使用：

```
tabbedPane.setSelectedIndex(tabIndex); 
```

# python - 如何比较集合中的值并在python中重写它们

> ID：14390282
> 
> 赞同：0
> 
> 时间：2013-01-17T23:53:23.297
> 
> 标签：python, set, overwrite

这是我的代码，我定义了一个空集，我想比较 `se([i]) > 0`，然后重新分配`se([i])`to的值`0`。我无法做到这一点，因为`se([i])`它是一个集合，无法与 int 进行比较。请帮助。我是 python 编程的新手。

```
se =set()
se.update([8])
print (se)
for i in range (10):
    se.update([i])
    print type(se)
    print len(se)
print se 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:03:24.687

如果您只是想比较 to 的每个元素`se`，并用`0`替换那些，那很容易：`> 0``0`

```
se = {0 if element > 0 else element for element in se} 
```

或者，如果您考虑一下：

```
se = {min(element, 0) for element in se} 
```

您不能通过 indexing 来做到这一点`se[i]`，因为集合不可索引，因为集合（数学和 Python）的全部意义在于它们是无序的。而且您绝对不能通过调用来做到这一点`se([i])`，因为您`set`不是函数，也不是其他可调用（类似函数）的东西。如果你真的想通过就地变异来做到这一点，你可以：

```
for element in se.copy():
    if element > 0:
        se.remove(element)
        se.add(0) 
```

（注意`se.copy()`那里——你不能在迭代集合时改变它的形状，所以你需要迭代它的一个副本。）

同时，集合的全部意义在于它是无序的，这意味着`0`多次添加与添加一次完全相同。所以：

```
>>> se = { -3, -2, -1, 0, 1, 2, 3 }
>>> print se
set([0, 1, 2, 3, -1, -3, -2])
>>> se = {min(element, 0) for element in se}
>>> print se
set([0, -2, -3, -1]) 
```

或者，使用您的代码（`print`为简洁起见，删除了一些额外的语句）：

```
>>> se =set()
>>> se.update([8])
>>> print (se)
set([8])
>>> for i in range (10):
...     se.update([i])
>>> print se
set([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
>>> se = {min(element, 0) for element in se}
>>> print se
set([0]) 
```

# c# - 作为 xml 值的表单控件

> ID：14390287
> 
> 赞同：1
> 
> 时间：2013-01-17T23:53:41.110
> 
> 标签：c#, xml, winforms, linq

我的 c# win 表单中有这个示例代码...

```
List<string> listFurniture = new List<string>();
XDocument xml = XDocument.Load(Application.StartupPath + @"\Furniture.xml");
foreach (XElement quality in xml.Descendants("Quality"))
    listFurniture.Add(quality.Value);

maintextbox.Text = listFurniture[0]; 
```

... 而这个例子 xml

```
<Furniture>
  <Table>
    <Quality>textbox1.Text + "and" + textbox2.Text + "but" + textbox3.Text</Quality>   
    ...
  </Table>  
</Furniture> 
```

我的困境是，maintextbox 正在生成实际的字符串“ `textbox1.Text`”，而不是 textbox1 的值。

我希望将 xml 值读取为：

```
maintextbox.Text = textbox1.Text + "and" + textbox2.Text + "but" + textbox3.Text; 
```

不是：

```
maintextbox.Text = "textbox1.Text + "and" + textbox2.Text + "but" + textbox3.Text"; 
```

我也尝试使用文本文件，`StreamReader`得到了相同的结果。

以这种方式编码我的项目的原因是因为文本框的顺序发生了变化，“and”和“but”也发生了变化。当这种变化发生时，我不必重写代码和重新编译程序。我只会在 xml 中进行更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T07:18:29.960

您的解决方案中的 xml 解析一切正常。您需要的是处理`Quality`字符串。

```
string[] parts = quality.Split('+');
Regex regex = new Regex(@"^""(.*)""$");
var textBoxes = Controls.OfType<TextBox>().ToList();

for (int i = 0; i < parts.Length; i++)
{
    string part = parts[i].Trim();

    var match = regex.Match(part);
    if (match.Success)
    {
        parts[i] = match.Groups[1].Value;
        continue;
    }

    var textBox = textBoxes.FirstOrDefault(tb => tb.Name + ".Text" == part);
    if (textBox != null) // possibly its an error if textbox not found
        parts[i] = textBox.Text; 
}    

mainTextBox.Text = String.Join(" ", parts); 
```

这里发生了什么：

*   我们按字符分割质量字符串`+`以获得字符串部分的数组
*   使用正则表达式，我们验证部分是否看起来像引号中的内容`"something"`。如果是，那么它将是`or`，`and`或其他连接词
*   最后，我们检查所有文本框是否匹配质量字符串部分中的文本框名称。如果匹配，则我们将部分替换为文本框中的文本
*   我们加入部分以获得结果字符串

* * *

顺便说一句，您可以在一行中解析 Xml：

```
var listFurniture = xml.Descendants("Quality") 
                       .Select(q => (string)q)
                       .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:08:17.540

* * *

更新：

因为我收到了一条评论来解释一下代码；我会稍微解释一下。

首先，XML 作为一种语言是为结构化而设计的。那种结构和轻松；提供了在语言或应用程序之间无缝地快速解析数据的灵活性和能力。您最初的问题表明您的文本框正在生成您的代码的字符串值`textbox.text`。

XML 需要结构化；一个示例结构是：

```
<Furniture>
     <Table>
         <Color> Red </Color>
         <Quality> 10 </Quality>
         <Material> Wood </Material>
      </Table>
</Furniture> 
```

因此，如果您要阅读您的 XML，它将找到`root`标签。所有其他组件将是`nodes`. 这些节点需要被索引，或者通过虹吸来获得您希望在文本框中表示的正确相关性。

这就是这段代码正在做的事情；我将通过每一步分解它。

```
// String you will format with the XML Structure.
StringBuilder output = new StringBuilder(); 
```

下一部分将如下：

```
// Create an XML Reader, by wrapping it in the 'using' it will ensure once your done the object is disposed of.  Rather then leaving the connection to your document open.
using (XmlReader reader = XmlReader.Create(new StringReader(xmlString)))
{
       // We will read our document to the following; hold to that attribute.  The attribute is identifying the node and all of the child elements that reside within it: So in our case Table.
       reader.ReadToFollowing("Table");
       reader.MoveToFirstAttribute();
       string color = reader.Value;
       output.AppendLine("The color of the table " + color);

       // As you can see there isn't anything fancy here, it reads to our root node.  Then moves to the first child element.  Then it creates a string and appends it. Keep in mind we are using our StringBuilder so we are just appending to that structure.
       reader.ReadToFollowing("Material");
       output.AppendLine("The material: " + reader.ReadElementContentAsString());

       // Same result as we used earlier; just a different method to attain our value.
}

// Now we output our block.
OutputTextBlock.Text = output.ToString(); 
```

现在所有数据都被推送到一个字符串中，显然您也可以使用上面的代码和一个文本框来检索这些值。

这就是您正确地将 XML 接收到应用程序中的方式；但你之前提到了两件事。所以听起来你试图使用文本框来物理写入文档，这可以通过 XmlWriter 完成。

**但是，您还不断收到文本框的原因是，就文本框而言`textbox.text`，它与值相关联。您的结构说明此字符串是值。**

**为了实现您的目标；您将有一种将值写入文档的方法。然后另一个阅读它；以便它正确地将数据传入和传出文档并正确表示。**

`<Quality>Textbox1.Text</Quality>` 这不允许文本框值自动读入您的文档和文本框。您将字符串值分配到节点中。您必须在物理上将值写入文档，然后才能读取它。

MSDN 提供了如何正确解析数据的示例；希望我已经澄清了您遇到问题的一些原因。

* * *

更多代码；直接来自 MSDN：就在 MSDN：

```
StringBuilder output = new StringBuilder();

String xmlString =
        @"<?xml version='1.0'?>
        <!-- This is a sample XML document -->
        <Items>
          <Item>test with a child element <more/> stuff</Item>
        </Items>";
// Create an XmlReader
using (XmlReader reader = XmlReader.Create(new StringReader(xmlString)))
{
    XmlWriterSettings ws = new XmlWriterSettings();
    ws.Indent = true;
    using (XmlWriter writer = XmlWriter.Create(output, ws))
    {

        // Parse the file and display each of the nodes.
        while (reader.Read())
        {
            switch (reader.NodeType)
            {
                case XmlNodeType.Element:
                    writer.WriteStartElement(reader.Name);
                    break;
                case XmlNodeType.Text:
                    writer.WriteString(reader.Value);
                    break;
                case XmlNodeType.XmlDeclaration:
                case XmlNodeType.ProcessingInstruction:
                    writer.WriteProcessingInstruction(reader.Name, reader.Value);
                    break;
                case XmlNodeType.Comment:
                    writer.WriteComment(reader.Value);
                    break;
                case XmlNodeType.EndElement:
                    writer.WriteFullEndElement();
                    break;
            }
        }

    }
}
OutputTextBlock.Text = output.ToString(); 
```

或者

```
StringBuilder output = new StringBuilder();

String xmlString =
    @"<bookstore>
        <book genre='autobiography' publicationdate='1981-03-22' ISBN='1-861003-11-0'>
            <title>The Autobiography of Benjamin Franklin</title>
            <author>
                <first-name>Benjamin</first-name>
                <last-name>Franklin</last-name>
            </author>
            <price>8.99</price>
        </book>
    </bookstore>";

// Create an XmlReader
using (XmlReader reader = XmlReader.Create(new StringReader(xmlString)))
{
    reader.ReadToFollowing("book");
    reader.MoveToFirstAttribute();
    string genre = reader.Value;
    output.AppendLine("The genre value: " + genre);

    reader.ReadToFollowing("title");
    output.AppendLine("Content of the title element: " + reader.ReadElementContentAsString());
}

OutputTextBlock.Text = output.ToString(); 
```

# perl - 关于 perl tie::File 模块

> ID：14390289
> 
> 赞同：0
> 
> 时间：2013-01-17T23:53:47.553
> 
> 标签：perl, activeperl

我对 tie::file 模块有两个疑问

1.  我使用 tie::file 模块对 55 MB 的文件进行搜索，并在 tie::file 中设置了 20 MB 的内存。当我尝试在绑定数组上 grep 以查找搜索字符串时，它需要很长时间。有什么解决办法吗？

2.  可以 tie::file 用于读取二进制文件。绑定数组由“\n”分隔。如何使用 tie::file 读取二进制文件？你能贴我一些示例代码吗？

/home/a814899> perl -e 'print "x\n"x27 for 1..1024*1024;' >一个

/home/a814899> 回声“你好世界”>> a

```
Using Unix grep

/home/a814899> time grep "hello " a
hello world

real    0m8.280s
user    0m8.129s
sys     0m0.139s

Using the regex

/home/a814899> (time perl -e 'while (<>) { if (/hello/) { print "hello world"} }' a)
hello world
real    0m51.316s
user    0m51.087s
sys     0m0.189s

Using Perl Grep

#!/usr/bin/perl
print "executing\n";
my $outputFileDir="/home/a814899";
my $sFileName="a";
open my $fh, "<", $outputFileDir . "/" . $sFileName or do {
       print "Could not open the file";
    };
print "success  in open" . "\n";
my @out=grep {/hello world/} <$fh> ;
print "@out" ;
close($fh) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:03:08.830

1.  是的。

    这就是您可能使用 Tie::File 的方式：

    ```
    $ (
        time perl -MTie::File -e'
           tie @a, "Tie::File", $ARGV[0];
           for (@a) { if (/y/) { } }
        ' a
    ) 2>&1 | grep real
    real    2m44.333s 
    ```

    这是“解决方法”：

    ```
    $ (
        time perl -e'
            while (<>) { if (/y/) { } }
        ' a
    ) 2>&1 | grep real
    real    0m0.644s 
    ```

    数据文件是使用创建的

    ```
    $ perl -E'say "x"x54 for 1..1024*1024;' >a 
    ```

2.  Tie::File 不读取文件；Tie::File 提供了一种将文件的行映射到数组元素的方法。由于“二进制”文件没有行，使用 Tie::File 访问一个文件没有任何意义。

# c# - 在 kinect 类和 opentk onrenderframe 类之间共享值

> ID：14390290
> 
> 赞同：0
> 
> 时间：2013-01-17T23:53:51.397
> 
> 标签：c#, kinect, opentk

我在我的应用程序中使用 Kinect `OpenTK`。在一个类中，我使用`WindowLoaded`方法，该方法在循环中调用`SensorSkeletonFrameReady`并写入控制台计算的右手坐标。

在我调用的主窗口类`OnRenderFrame`中，它在循环中将立方体绘制到视口。

所以基本上我需要将坐标从`SensorSkeletonFrameReady`kinectControl 发送到`OnRenderFrame`主窗口类。

我试过用线程来完成这个，但我不知道如何发送值。

编辑：

这是主窗口类：

```
 ...
                public class MainWindow : GameWindow
                {
                ...
                /*Kinect thread start*/
                        kinectControl kinectObject = new kinectControl();
                        Thread oThread = new Thread(new ThreadStart(kinectObject.WindowLoaded));
                        oThread.Start();
                        ...
protected override void OnRenderFrame(FrameEventArgs e)
        {
        ...
        //Here I need get coordinates from kinectControl

                        DrawCube();
                        ... 
```

这是 kinectControl 类：

```
 ...
    private void SensorSkeletonFrameReady(object sender, SkeletonFrameReadyEventArgs e)
    {
    ...
            foreach (Skeleton skeleton in skeletons)
            {
                Joint rightHand = skeleton.Joints[JointType.HandRight];
                Joint leftHand = skeleton.Joints[JointType.HandLeft];
                Joint head = skeleton.Joints[JointType.Head];

                double leftY = leftHand.Position.Y;
                double headY = head.Position.Y;

                // get the individual points of the right hand
                double rightX = rightHand.Position.X;
                double rightY = rightHand.Position.Y;
                double rightZ = rightHand.Position.Z;

                //here I need send this coordinates to mainwindow class 
```

...

Edit2：我找到了解决方案，而不是注册事件，而是在 OnRenderFrame 方法中使用 OpenNextFrame 方法进行轮询。

```
public void findSkeleton()//random name of function
        {
            Skeleton[] skeletons = new Skeleton[0];

            SkeletonFrame skeletonFrame = this.sensor.SkeletonStream.OpenNextFrame(0);

                if (skeletonFrame != null)
                {
                    skeletons = new Skeleton[skeletonFrame.SkeletonArrayLength];
                    skeletonFrame.CopySkeletonDataTo(skeletons);
                }
...//rest is the same as in SensorSkeletonFrameReady event 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T20:37:24.230

轮询是一种选择，但我仍然不清楚是否有必要将 Kinect 代码放在单独的线程中。Kinect 完成的所有轮询和处理都已经在 UI 线程之外完成，只有当您捕获其中一个`FrameReady`事件时，您才会将 UI 线程带入混合中。捕获该事件时，您通常希望对 UI 做一些事情。

就个人而言，我使用以下核心结构来

```
private readonly KinectSensorChooser _sensorChooser = new KinectSensorChooser();

public MainViewModel()
{
    KinectSensorManager = new KinectSensorManager();
    KinectSensorManager.KinectSensorChanged += OnKinectSensorChanged;

    _sensorChooser.Start();

    if (_sensorChooser.Kinect == null)
    {
        MessageBox.Show("Unable to detect an available Kinect Sensor");
        Application.Current.Shutdown();
    }

    // Bind the KinectSensor from the sensorChooser to the KinectSensor on the KinectSensorManager
    var kinectSensorBinding = new Binding("Kinect") { Source = _sensorChooser };
    BindingOperations.SetBinding(this.KinectSensorManager, KinectSensorManager.KinectSensorProperty, kinectSensorBinding);
} 
```

`KinectSensorManager`是`KinectWpfViewers`示例项目中的一个辅助函数；Kinect for Windows Toolkit 的一部分。使用上面的我的 Kinect 然后使用以下内容进行初始化：

```
#region Kinect Discovery & Setup

private void OnKinectSensorChanged(object sender, KinectSensorManagerEventArgs<KinectSensor> args)
{
    if (null != args.OldValue)
        UninitializeKinectServices(args.OldValue);

    if (null != args.NewValue)
        InitializeKinectServices(KinectSensorManager, args.NewValue);
}

/// <summary>
/// Initialize Kinect based services.
/// </summary>
/// <param name="kinectSensorManager"></param>
/// <param name="sensor"></param>
private void InitializeKinectServices(KinectSensorManager kinectSensorManager, KinectSensor sensor)
{
    // configure the color stream
    kinectSensorManager.ColorFormat = ColorImageFormat.RgbResolution640x480Fps30;
    kinectSensorManager.ColorStreamEnabled = true;

    // configure the depth stream
    kinectSensorManager.DepthStreamEnabled = true;

    kinectSensorManager.TransformSmoothParameters =
        new TransformSmoothParameters
        {
            // as the smoothing value is increased responsiveness to the raw data
            // decreases; therefore, increased smoothing leads to increased latency.
            Smoothing = 0.5f,
            // higher value corrects toward the raw data more quickly,
            // a lower value corrects more slowly and appears smoother.
            Correction = 0.5f,
            // number of frames to predict into the future.
            Prediction = 0.5f,
            // determines how aggressively to remove jitter from the raw data.
            JitterRadius = 0.05f,
            // maximum radius (in meters) that filtered positions can deviate from raw data.
            MaxDeviationRadius = 0.04f
        };

    // configure the skeleton stream
    sensor.SkeletonFrameReady += OnSkeletonFrameReady;
    kinectSensorManager.SkeletonStreamEnabled = true;

    // initialize the gesture recognizer
    _gestureController = new GestureController();
    _gestureController.GestureRecognized += OnGestureRecognized;

    kinectSensorManager.KinectSensorEnabled = true;

    if (!kinectSensorManager.KinectSensorAppConflict)
    {
        // more initialization
    }
}

/// <summary>
/// Uninitialize all Kinect services that were initialized in InitializeKinectServices.
/// </summary>
/// <param name="sensor"></param>
private void UninitializeKinectServices(KinectSensor sensor)
{
    // unregister services
} 
```

在我的示例代码中，我`SkeletonFrameReady`定义了一个事件。这对于任何其他`FrameReady`事件都是相同的。您可以设置适当的处理程序来获取数据，然后使用它执行您需要执行的操作。您现在位于 OpenTK 引用所在的主类中。

UI 线程上发生的唯一事情是处理函数内部的内容，或者它调用的内容。

# ruby-on-rails - Rails：在多个嵌套的宁静路线中嵌套相同的资源？

> ID：14390294
> 
> 赞同：4
> 
> 时间：2013-01-17T23:54:23.543
> 
> 标签：ruby-on-rails, routes, has-many-through

这很容易，但是在框架/语言之间来回切换让我怀疑自己。`has_many :through`试图为Rails中的关系制定路线。

```
#User
has_many :reservations, :dependent => :destroy
has_many :events, :through => :reservations

#Reservation
belongs_to :user
belongs_to :event

#Event
has_many :reservations, :dependent => :destroy
has_many :attendees, through => :reservations, :source => :user 
```

我想要从用户模型中快速构建/创建新预订到特定事件的路线（反之亦然），但不知道如何去创建它们。这看起来很奇怪：

```
resources :users do
  resources :reservations, only: [:new, :create, :destroy]
end

resources :events do
  resources :reservations, only: [:new, :create, :destroy]
end 
```

无论如何，只是寻找验证，或者可能是另一种处理方式。理想情况下，用户可以单击的事件旁边的页面上有一个链接，并且（通过 ajax 或页面重新加载）他们会进行“预订”。

出于同样的原因，我需要路由来查看每个对给定事件有预订的用户。并且为给定用户保留的每个事件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T00:51:14.797

好问题！我想我会选择这组路线：

```
resources :events do
  resources :reservations, only: [:new, :create, :destroy]
end

resources :users do
  get 'reservations', :on => :member
end 
```

您的预订将与活动密切相关。我认为从建模的角度来看这是有道理的。根据您的描述，听起来登录用户会在活动中单击链接以创建预订。通过将预订与事件相关联，您只需从路线就知道要为哪个事件构建预订，并且因为您有一个经过身份验证的用户，您也可以假设要使用哪个用户（可能来自您的会话）。例如，类似 POST 的路由`/events/5/reservations`会为当前登录的用户创建事件 5 的预留。

对资源的附加`get`操作`user`允许您提供端点来回答问题`What reservations does a particular user have?`

理想情况下，您希望确保只有一组端点用于管理资源。就通过非资源操作获取附加信息而言，这更多是一个偏好问题以及您想要支持哪些用例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T17:53:40.773

我会用它来干燥路线：

```
def reserv
  resources :reservations, only: [:new, :create, :destroy]
end

resources :users do
  reserv
end

resources :events do
  reserv
end 
```

# actionscript-3 - 如何在不更改 hitbox 的情况下调整 actionscript 3 中对象的大小？

> ID：14390295
> 
> 赞同：1
> 
> 时间：2013-01-17T23:54:44.090
> 
> 标签：actionscript-3, event-handling, resize

当我在 actionscript 3 中调整按钮的大小时，在我的赋值示例中，hitbox 变为文本而不是正方形：

[http://www.datafilehost.com/download-5ff20e2c.html](http://www.datafilehost.com/download-5ff20e2c.html)

视频解释问题：[http ://sdrv.ms/YcnjYV](http://sdrv.ms/YcnjYV)

这是代码：

```
import flash.events.MouseEvent;

trace("Stage(X,Y):" + stage.stageWidth + "X" + stage.stageHeight);

stage.addEventListener(MouseEvent.MOUSE_MOVE, mousePosition);
clickMe.addEventListener(MouseEvent.CLICK, handleClicks); 
function mousePosition(event:MouseEvent) {

    if(clickMe.mouseX >= 0 && clickMe.mouseX <= clickMe.width && clickMe.mouseY >= 0 && clickMe.mouseY <= clickMe.height)
    {
        do
        {
            var newX = Math.floor(Math.random()*stage.stageWidth);
            var newY = Math.floor(Math.random()*stage.stageHeight)

        }while(newX >= stage.stageWidth - clickMe.width || newY >= stage.stageHeight - clickMe.height)

        clickMe.x = newX;
        clickMe.y = newY;

        if(clickMe.width > 50)
        {
            clickMe.width=clickMe.width - 5;
            clickMe.height = clickMe.width - 5;
        }
    }
}

function handleClicks(event:MouseEvent)
{
    trace("Button Clicked!");
} 
```

调整对象大小时，如何使 hitbox 保持不变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T13:13:34.987

Changing of button size affects on mouseX/mouseY value inside it. So dont rely on it and just use checking based on button position and size.

```
if(mouseX >= clickMe.x && mouseX <= clickMe.x+clickMe.width && mouseY >= clickMe.y && mouseY <= clickMe.y+clickMe.height) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T01:21:55.090

这似乎是您正在做的更好和更清洁的方法（假设您将 clickMe 剪辑移动到随机位置并将其缩小 5px）

```
import flash.events.MouseEvent;

clickMe.addEventListener(MouseEvent.ROLL_OVER, moveSquare);

function moveSquare(e:MouseEvent):void
{
    var newX       = Math.floor(Math.random()*stage.stageWidth);
    var newY       = Math.floor(Math.random()*stage.stageHeight);
    clickMe.x      = newX;
    clickMe.y      = newY;
    clickMe.width  = clickMe.width - 5;
    clickMe.height = clickMe.height - 5;
} 
```

# vba - Word 2010：如何在 qat（快速访问工具箱）中创建下拉菜单

> ID：14390300
> 
> 赞同：2
> 
> 时间：2013-01-17T23:55:14.993
> 
> 标签：vba, customization, office-2010, word-2010, ribbonx

**简短内容：** 我想通过在 Word 的启动文件夹中放置自定义的 .dotm 文件，将下拉菜单添加到任何 Word 2010 实例的快速访问工具栏。我未能*创建这个定制的 .dotm-file*。

**LONG：** 我一直在为 Word 2010 编写一些“插件”，首先使用 VSTO，然后发现部署问题，现在使用 VBA。加载项应简化将我公司的徽标和法律声明添加到文档中（存在不同的徽标和法律声明组合）。

为了允许通过尽可能少的点击来选择想要的徽标和法律声明，我考虑在快速访问工具栏 (qat) 中自动添加一个下拉菜单。我想通过在用户的 Word 启动文件夹中放置一个包含此 qat 扩展的代码和页眉/页脚设置的逻辑的 .dotm 文件来做到这一点。

我已经成功地使用 CustomUI 将这样的下拉菜单添加到 Add-Ins-Ribbon，在代码方面一切正常。通过菜单，用户可以从提供的所有预设中进行选择，并成功添加页眉和页脚。

此外，我已经看到并使用了成功将控件直接添加到 qat 的示例。

如果放置在我的启动文件夹中，这些示例可以完美地完成工作，并且其中定义的控件会出现在 Word 的任何实例上。可行的方法是在 .dotm 文档中创建一个新文件夹“userCustomization”，然后创建带有几个限制的 customUI.xml 文件（例如，不允许自定义图标）。

不幸的是，我无法弄清楚如何在 qat 中实现下拉菜单控件。我发现的所有示例都只使用了“简单”（按钮）控件，无论我尝试将按钮包装在标签中多少次，我都无法正常工作。

另一方面，我可以通过“qat => add controls”手动将我的功能区添加到 qat 和 .. 瞧 .. 它就在那里，完全按照需要工作，所以我想它一定是可能的。但我需要的是自动执行此操作，以便我们的用户不必对 qat 进行任何配置。

非常感谢您的帮助！来自德国的问候，库尔特

这是将下拉菜单添加到加载项选项卡的方式：

```
<ribbon>  
<tabs>  
<tab idMso="TabAddIns">    
<group id="MyGroup" label="WordDesigner" visible="false">       

    <menu id="myMenu" label="Design einfügen" size="large" image="menulogo">
    <menu id="mySubMenu" label="Rechnungswesen" image="icon2">  
        <button id="MahnUndKlage"  label="Mahn- und Klage" image="icon3" onAction="DesignAnwenden"/> 
        <button id="Buchhaltung"  label="Buchhaltung" image="icon3" onAction="DesignAnwenden"/>    
    </menu>
    <button id="Personalabteilung"  label="Personalabteilung" image="icon3" onAction="DesignAnwenden"/>
    <button id="Verkauf"  label="Verkauf" image="icon4" onAction="DesignAnwenden"/>
    <button id="clearHeaderAndFooter"  label="Gestaltung entfernen" image="icon5" onAction="DesignAnwenden"/>   
    </menu>
</group>
</tab>
</tabs>
</ribbon>
</customUI> 
```

我发现的有用信息包括：

*   [Greg Maxey 关于修改 qat 中的图标](http://gregmaxey.mvps.org/word_tip_pages/modify_qat_button_image_text.html)
*   [德语，RibbonX 简介的第 18 部分](http://www.office-loesung.de/ftopic266375_0_0_asc.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T10:59:59.487

好吧，更多的研究已经导致了更多的信息（...），以防其他人可能会搜索类似的问题，我会尝试得出结论......

*   1）根据QAT上的[这个](http://msdn.microsoft.com/en-us/library/windows/desktop/dd940502%28v=vs.85%29.aspx)MS页面，只有Button，ToggleButton和CheckBox是Win7中QAT的有效项目（Win8允许更多控件）。

*   由于您也可以手动添加下拉菜单，我认为必须有一些方法可以自动执行此操作，以及使用按钮、复选框和切换按钮

*   通过修改启动文件夹中 .dotm 文件的 userCustomization-Folder 中的 customUI.xml 文件，我可能一辈子都想不出一种方法来自动将下拉列表添加到 QAT。

*   实现该目标还有另一种可能性：Office 2010 使用“.officeUI”类型的文件，其中存储来自 QAT 的每个用户元素（例如 Word.officeUI）。在那里，添加以下 xml 元素将确保，如果您已将包含菜单的 .dotm 文件放置在 Word 的启动文件夹中，则它在加载时显示为 QAT 中的下拉列表：

    `<mso:control idQ="x1:myMenu" visible="true"/>`

*   不幸的是，热情地将这个 xml 元素添加到 userCustomization 中的 customUI.xml 会导致 .. poof .. 根本没有用户在 QAT 中定义额外的图标（customUI.xml 已损坏）。

此外，我昨天偶然发现的一个很好的资源是 Andy Pope 的[Visual Ribbon Editor](http://www.andypope.info/vba/ribboneditor.htm)。您可以轻松调整功能区和 QAT。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-24T14:17:34.953

我知道我迟到了，但我通过谷歌找到了这篇文章，并认为你会很感激你的回答。

您*可以*通过 Word 的 QAT 使用一点 VBA 技巧来创建菜单的外观。基本上，创建一个自定义命令栏，每个“控件”代表所需菜单上的一个插槽。如果您愿意，可以使用“.BeginGroup”创建分隔线来分隔项目。您的菜单至少可以降低几级，但为了复杂性，我不建议您太深。

当您的命令栏完美时，创建一个仅在运行时将命令栏显示为弹出窗口的宏：

```
 Application.CommandBars("My Command Bar").ShowPopup 
```

将该宏的快捷方式添加到 QAT。当您单击该快捷方式时，您的命令栏将在光标处显示为弹出菜单，这是您想要的效果。

享受！

# php - 通过 PHP 在另一个图像中的大小和位置

> ID：14390302
> 
> 赞同：2
> 
> 时间：2013-01-17T23:55:57.690
> 
> 标签：php, image, coordinates, boundary, image-size

我有两个图像（小和大）。大的包含一个小的。就像小的是照片，大的是相册中的一页。

如何使用 PHP 在大图像中获取小图像的坐标？而且我还需要知道该图像在大图像中的大小......所以只是小图像呈现的任何角度和侧面大小的（x，y）坐标......

(x,y, 宽度, 高度)

我已经问过这样的问题并得到了一个绝妙的答案（[在这里](https://stackoverflow.com/questions/14345256/determine-position-of-one-image-in-another-with-php)）但我忘了在那里提到小图像的大小可能与大图像中该图像的大小不同......

而且，如果可以处理大图像中那个小图像的呈现，可以有一些东西覆盖它的一个角度......就像在这个例子中：

小图： ![小图](../Images/08f188761e490db94c0bcb048b2145e8.png)

大图： ![大图](../Images/982515e5c4722a7326c0c38d3ffdf983.png)

小图像总是只有一个矩形。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T14:43:54.370

好吧，这个答案并不能**完美地**回答这个问题，但它应该给你一个好的开始！我知道我在代码中重复了自己，但我的目标只是让某些东西正常工作，以便您可以在其上进行构建，这不是生产代码！

**前提条件**

从大图开始：

![大的](../Images/ce598a928dcb6aecb495d31c5c86b409.png)

我们需要尽可能地找到另一张图片的位置：

![在此处输入图像描述](../Images/980ab0f1fd7773946f169e05280f811b.png)

我决定将这个过程分成许多子步骤，您可以根据您希望代码执行的操作来改进或删除这些子步骤。

出于测试目的，我确实在不同的输入图像上测试了我的算法，因此您将看到一个定义要加载的文件的变量...

我们从：

```
function microtime_float()
{
    list($usec, $sec) = explode(" ", microtime());
    return ((float)$usec + (float)$sec);
}

$time_start = microtime_float();

$largeFilename = "large.jpg";

$small = imagecreatefromjpeg("small.jpg");
$large = imagecreatefromjpeg($largeFilename); 
```

和

```
imagedestroy($small);
imagedestroy($large);

$time_end = microtime_float();
echo "in " . ($time_end - $time_start) . " seconds\n"; 
```

对我们的表演有一个好主意。幸运的是，大多数算法都非常快，所以我不必进行更多优化。

**背景检测**

我从检测背景颜色开始。我假设背景颜色将是图片中最常见的颜色。为此，我只计算了在大图片中可以找到的每种颜色的引用数量，使用递减值对其进行排序，并将第一个作为背景颜色（如果您更改了源图片，应该允许代码适应）

```
function FindBackgroundColor($image)
{
    // assume that the color that's present the most is the background color
    $colorRefcount = array();

    $width = imagesx($image);
    $height = imagesy($image);

    for($x = 0; $x < $width; ++$x)
    {
        for($y = 0; $y < $height; ++$y)
        {
            $color = imagecolorat($image, $x, $y);
            if(isset($colorRefcount[$color]))
                $colorRefcount[$color] = $colorRefcount[$color] + 1;
            else
                $colorRefcount[$color] = 1;
        }
    }

    arsort($colorRefcount);
    reset($colorRefcount);

    return key($colorRefcount);
}
$background = FindBackgroundColor($large); // Should be white 
```

**分区**

我的第一步是尝试找到所有非背景像素所在的区域。通过一点填充，我能够将区域分组为更大的区域（这样一个段落将是一个区域而不是多个单独的字母）。我从 5 的填充开始并获得了足够好的结果，所以我坚持使用它。

这被分解为多个函数调用，所以我们开始：

```
function FindRegions($image, $backgroundColor, $padding)
{
    // Find all regions within image where colors are != backgroundColor, including a padding so that adjacent regions are merged together
    $width = imagesx($image);
    $height = imagesy($image);

    $regions = array();

    for($x = 0; $x < $width; ++$x)
    {
        for($y = 0; $y < $height; ++$y)
        {
            $color = imagecolorat($image, $x, $y);

            if($color == $backgroundColor)
            {
                continue;
            }

            if(IsInsideRegions($regions, $x, $y))
            {
                continue;
            }

            $region = ExpandRegionFrom($image, $x, $y, $backgroundColor, $padding);
            array_push($regions, $region);
        }
    }

    return $regions;
}

$regions = FindRegions($large, $background, 5); 
```

在这里，我们迭代图片的每个像素，如果它的背景颜色，我们将其丢弃，否则，我们检查它的位置是否已经存在于我们找到的区域中，如果是这样，我们也跳过它。现在，如果我们没有跳过像素，这意味着它是一个彩色像素，应该是一个区域的一部分，所以我们开始`ExpandRegionFrom`这个像素。

检查我们是否在区域内的代码非常简单：

```
function IsInsideRegions($regions, $x, $y)
{
    foreach($regions as $region)
    {
        if(($region["left"] <= $x && $region["right"] >= $x) && 
           ($region["bottom"] <= $y && $region["top"] >= $y))
        {
            return true;
        }
    }
    return false;
} 
```

现在，扩展代码将尝试在每个方向上扩大区域，只要找到要添加到区域的新像素就会这样做：

```
function ExpandRegionFrom($image, $x, $y, $backgroundColor, $padding)
{
    $width = imagesx($image);
    $height = imagesy($image);

    $left = $x;
    $bottom = $y;
    $right = $x + 1;
    $top = $y + 1;

    $expanded = false;

    do
    {
        $expanded = false;

        $newLeft = ShouldExpandLeft($image, $backgroundColor, $left, $bottom, $top, $padding);
        if($newLeft != $left)
        {
            $left = $newLeft;
            $expanded = true;
        }

        $newRight = ShouldExpandRight($image, $backgroundColor, $right, $bottom, $top, $width, $padding);
        if($newRight != $right)
        {
            $right = $newRight;
            $expanded = true;
        }

        $newTop = ShouldExpandTop($image, $backgroundColor, $top, $left, $right, $height, $padding);
        if($newTop != $top)
        {
            $top = $newTop;
            $expanded = true;
        }

        $newBottom = ShouldExpandBottom($image, $backgroundColor, $bottom, $left, $right, $padding);
        if($newBottom != $bottom)
        {
            $bottom = $newBottom;
            $expanded = true;
        }
    }
    while($expanded == true);

    $region = array();
    $region["left"] = $left;
    $region["bottom"] = $bottom;
    $region["right"] = $right;
    $region["top"] = $top;

    return $region;
} 
```

这些`ShouldExpand`方法本可以以更简洁的方式编写，但我采用了一些快速原型的方法：

```
function ShouldExpandLeft($image, $background, $left, $bottom, $top, $padding)
{
    // Find the farthest pixel that is not $background starting at $left - $padding closing in to $left
    for($x = max(0, $left - $padding); $x < $left; ++$x)
    {
        for($y = $bottom; $y <= $top; ++$y)
        {
            $pixelColor = imagecolorat($image, $x, $y);

            if($pixelColor != $background) 
            {
                return $x;
            }
        }
    }

    return $left;
}

function ShouldExpandRight($image, $background, $right, $bottom, $top, $width, $padding)
{
    // Find the farthest pixel that is not $background starting at $right + $padding closing in to $right
    $from = min($width - 1, $right + $padding);
    $to = $right;
    for($x = $from; $x > $to; --$x)
    {
        for($y = $bottom; $y <= $top; ++$y)
        {
            $pixelColor = imagecolorat($image, $x, $y);

            if($pixelColor != $background) 
            {
                return $x;
            }
        }
    }

    return $right;
}

function ShouldExpandTop($image, $background, $top, $left, $right, $height, $padding)
{
    // Find the farthest pixel that is not $background starting at $top + $padding closing in to $top
    for($x = $left; $x <= $right; ++$x)
    {
        for($y = min($height - 1, $top + $padding); $y > $top; --$y)
        {
            $pixelColor = imagecolorat($image, $x, $y);

            if($pixelColor != $background)
            {
                return $y;
            }
        }
    }

    return $top;
}

function ShouldExpandBottom($image, $background, $bottom, $left, $right, $padding)
{
    // Find the farthest pixel that is not $background starting at $bottom - $padding closing in to $bottom
    for($x = $left; $x <= $right; ++$x)
    {
        for($y = max(0, $bottom - $padding); $y < $bottom; ++$y)
        {
            $pixelColor = imagecolorat($image, $x, $y);

            if($pixelColor != $background)
            {
                return $y;
            }
        }
    }

    return $bottom;
} 
```

现在，为了查看算法是否成功，我添加了一些调试代码。

**调试渲染**

我创建了第二个图像来存储调试信息并将其存储在磁盘上，以便以后可以看到我的进度。

使用以下代码：

```
$large2 = imagecreatefromjpeg($largeFilename);
$red = imagecolorallocate($large2, 255, 0, 0);
$green = imagecolorallocate($large2, 0, 255, 0);
$blue = imagecolorallocate($large2, 0, 0, 255);

function DrawRegions($image, $regions, $color)
{
    foreach($regions as $region)
    {
        imagerectangle($image, $region["left"], $region["bottom"], $region["right"], $region["top"], $color);
    }
}

DrawRegions($large2, $regions, $red);

imagejpeg($large2, "regions.jpg"); 
```

我可以验证我的分区代码做得不错：

![分区](../Images/ddabf77fc1725977c946a8a6e794a216.png)

**纵横比**

我决定根据纵横比（宽高比）过滤掉一些区域。可以应用其他过滤，例如平均像素颜色或其他东西，但纵横比检查非常快，所以我使用了它。

我只是定义了一个“窗口”，如果区域的纵横比在最小值和最大值之间，则将在其中保留区域；

```
$smallAspectRatio = imagesx($small) / imagesy($small);

function PruneOutWrongAspectRatio($regions, $minAspectRatio, $maxAspectRatio)
{
    $result = array();
    foreach($regions as $region)
    {   
        $aspectRatio = ($region["right"] - $region["left"]) / ($region["top"] - $region["bottom"]);
        if($aspectRatio >= $minAspectRatio && $aspectRatio <= $maxAspectRatio)
        {
            array_push($result, $region);
        }
    }

    return $result;
}

$filterOnAspectRatio = true;

if($filterOnAspectRatio == true)
{
    $regions = PruneOutWrongAspectRatio($regions, $smallAspectRatio - 0.1 * $smallAspectRatio, $smallAspectRatio + 0.1 * $smallAspectRatio);
    DrawRegions($large2, $regions, $blue);
}

imagejpeg($large2, "aspectratio.jpg"); 
```

通过添加`DrawRegions`调用，我现在将仍在列表中的区域绘制为蓝色作为潜在位置：

![纵横比](../Images/7d751a69c24050e90e4116c746474ae2.png)

如您所见，只剩下4个位置！

**寻找角落**

我们快完成了！现在，我正在做的是从小图片中查看四个角的颜色，并尝试在剩余区域的角中找到最佳匹配像素。此代码最有可能失败，因此如果您必须花时间改进解决方案，此代码将是一个不错的候选者。

```
function FindCorners($large, $small, $regions)
{
    $result = array();

    $bottomLeftColor = imagecolorat($small, 0, 0);
    $blColors = GetColorComponents($bottomLeftColor);
    $bottomRightColor = imagecolorat($small, imagesx($small) - 1, 0);
    $brColors = GetColorComponents($bottomRightColor);
    $topLeftColor = imagecolorat($small, 0, imagesy($small) - 1);
    $tlColors = GetColorComponents($topLeftColor);
    $topRightColor = imagecolorat($small, imagesx($small) - 1, imagesy($small) - 1);
    $trColors = GetColorComponents($topRightColor);

    foreach($regions as $region)
    {
        $bottomLeft = null;
        $bottomRight = null;
        $topLeft = null;
        $topRight = null;

        $regionWidth = $region["right"] - $region["left"];
        $regionHeight = $region["top"] - $region["bottom"];

        $maxRadius = min($regionWidth, $regionHeight);

        $topLeft = RadialFindColor($large, $tlColors, $region["left"], $region["top"], 1, -1, $maxRadius);
        $topRight = RadialFindColor($large, $trColors, $region["right"], $region["top"], -1, -1, $maxRadius);
        $bottomLeft = RadialFindColor($large, $blColors, $region["left"], $region["bottom"], 1, 1, $maxRadius);
        $bottomRight = RadialFindColor($large, $brColors, $region["right"], $region["bottom"], -1, 1, $maxRadius);

        if($bottomLeft["found"] && $topRight["found"] && $topLeft["found"] && $bottomRight["found"])
        {
            $left = min($bottomLeft["x"], $topLeft["x"]);
            $right = max($bottomRight["x"], $topRight["x"]);
            $bottom = min($bottomLeft["y"], $bottomRight["y"]);
            $top = max($topLeft["y"], $topRight["y"]);
            array_push($result, array("left" => $left, "right" => $right, "bottom" => $bottom, "top" => $top));
        }
    }

    return $result;
}

$closeOnCorners = true;
if($closeOnCorners == true)
{
    $regions = FindCorners($large, $small, $regions);
    DrawRegions($large2, $regions, $green);
} 
```

我试图通过从角落增加“径向”（基本上是正方形）来找到匹配的颜色，直到找到匹配的像素（在公差范围内）：

```
function GetColorComponents($color)
{
    return array("red" => $color & 0xFF, "green" => ($color >> 8) & 0xFF, "blue" => ($color >> 16) & 0xFF);
}

function GetDistance($color, $r, $g, $b)
{
    $colors = GetColorComponents($color);

    return (abs($r - $colors["red"]) + abs($g - $colors["green"]) + abs($b - $colors["blue"]));
}

function RadialFindColor($large, $color, $startx, $starty, $xIncrement, $yIncrement, $maxRadius)
{
    $result = array("x" => -1, "y" => -1, "found" => false);
    $treshold = 40;
    for($r = 1; $r <= $maxRadius; ++$r)
    {
        $closest = array("x" => -1, "y" => -1, "distance" => 1000);
        for($i = 0; $i <= $r; ++$i)
        {
            $x = $startx + $i * $xIncrement;
            $y = $starty + $r * $yIncrement;

            $pixelColor = imagecolorat($large, $x, $y);

            $distance = GetDistance($pixelColor, $color["red"], $color["green"], $color["blue"]);
            if($distance < $treshold && $distance < $closest["distance"])
            {
                $closest["x"] = $x;
                $closest["y"] = $y;
                $closest["distance"] = $distance;
                break;
            }
        }

        for($i = 0; $i < $r; ++$i)
        {   
            $x = $startx + $r * $xIncrement;
            $y = $starty + $i * $yIncrement;

            $pixelColor = imagecolorat($large, $x, $y);

            $distance = GetDistance($pixelColor, $color["red"], $color["green"], $color["blue"]);
            if($distance < $treshold && $distance < $closest["distance"])
            {
                $closest["x"] = $x;
                $closest["y"] = $y;
                $closest["distance"] = $distance;

                break;
            }
        }

        if($closest["distance"] != 1000)
        {
            $result["x"] = $closest["x"];
            $result["y"] = $closest["y"];
            $result["found"] = true;
            return $result;
        }
    }

    return $result;
} 
```

如您所见，我不是 PHP 专家，我不知道有一个内置函数可以获取 rgb 通道，哎呀！

**最后呼叫**

所以现在算法运行了，让我们看看它使用以下代码发现了什么：

```
foreach($regions as $region)
{
    echo "Potentially between " . $region["left"] . "," . $region["bottom"] . " and " . $region["right"] . "," . $region["top"] . "\n";
}

imagejpeg($large2, "final.jpg");

imagedestroy($large2); 
```

输出（非常接近真正的解决方案）：

```
Potentially between 108,380 and 867,827
in 7.9796848297119 seconds 
```

给出这张图片（和之间的矩形`108,380`以`867,827`绿色绘制）

![最终的](../Images/db36824f053d47a173ddfa259ca1c325.png)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T09:08:13.567

如果没有颜色，我的解决方案就可以工作（除了图像周围的白色和黑色，但您可以修改脚本以使其以不同的方式工作）

```
 $width = imagesx($this->img_src);
    $height = imagesy($this->img_src);

    // navigate through pixels of image
    for ($y = 0; $y < $height; $y++) {
        for ($x=0; $x < $width; $x++) {
            list($r, $g, $b) = imagergbat($this->img_src, $x, $y);
            $black = 0.1;
            $white = 0.9;
            // calculate if the color is next to white or black, if not register it as a good pixel
            $gs = (($r / 3) + ($g / 3) + ($b / 3);
            $first_pixel = array();
            if ($gs > $white &&  $gs < $black) {
                // get coordinate of first pixel (left top)
                if (empty($first_pixel))
                    $first_pixel = array($x, $y);
                // And save last_pixel each time till the last one
                $last_pixel = array($x, $y);
            }
        }
    } 
```

你得到你的图像的坐标。在此之后你只需要裁剪它。

# php - 如何订购某一天的节目？

> ID：14390304
> 
> 赞同：0
> 
> 时间：2013-01-17T23:56:05.927
> 
> 标签：php, mysql

我正在尝试查询有关加入showingdates 和showings 表的查询，并获取某个日期的所有显示并按时间排序。

我的showingdates 日字段形成为showdate(datetime) 并显示`"2013-03-06 00:00:00"`

我的放映 performance_date 字段又是一个日期时间，示例是

```
 "2013-03-06 20:00:00 , 
 "2013-03-06 21:00:00" . 
```

如何查询该日期并按时间排序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T23:59:31.653

这应该有效。

```
SELECT garbage
FROM trash
WHERE DATE(showdate) = '2013-03-06'
ORDER BY TIME(showdate) DESC 
```

这里的时间正在下降。删除`DESC`实现升序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:00:51.370

仅从特定日期获取行（不使用`showdate`列上的任何函数，因此可以使用索引）：

```
WHERE showdate >= '2013-03-06'
  AND showdate < '2013-03-06' + INTERVAL 1 DAY 
```

按时间排序（因为所有行都具有相同的日期，并且`showdate`具有日期和时间，只需按此排序）：

```
ORDER BY showdate 
```

# php - isAuthorized() 和在 CakePHP 中使用 Acl 组件有什么区别？

> ID：14390307
> 
> 赞同：2
> 
> 时间：2013-01-17T23:56:14.470
> 
> 标签：php, cakephp, authorization, cakephp-2.1

我还是蛋糕的新手。假设你有一个表 users ，它有一个 group_id 和一个名为 groups 的表：

*   身份角色
*   1 名管理员
*   2 老师
*   3 学生

我想知道，例如，使用 isAuthorized 函数授权用户访问某个操作和使用 Acl 限制他的访问之间有什么区别？一种方法比另一种更安全吗？

另外，我想知道是否有任何“Cakish”方式，例如： - 允许管理员访问编辑操作 - 允许学生访问编辑操作，但限制他更改某个字段。

例如，假设一个学生正在编辑表用户，该表具有以下字段：用户名、密码、组 ID。他可以编辑密码，但不能编辑 group_id 和用户名。虽然管理员可以编辑两者。我实现这一点的方式是在控制器内部检查，在用户发布后，他的 group_id ，并根据他的权限取消设置字段 username 和 group_id 。这是实现这一点的正确方法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T03:35:00.963

ACL（或访问控制列表）是一种将谁有权访问什么的逻辑与您的代码分开的方法。使用 isAuthorized() 您必须为每种可能的访问类型手动添加代码。此外，ACL 允许（递归）分组和类似矩阵的访问（例如“允许访问所有战士，但不允许访问 Gremlin 种族的战士”）；CakePHP 的文档非常丰富。

但是，我个人认为 Cake 的 ACL 缺少的是限制对*特定*项目的访问。例如，一个学生可以查看他的结果，但不能查看其他学生的结果；即他可以调用/results/view/10、/results/view/49 和/results/view/87，但不能调用其他。我无法使用 ACL 做到这一点。

至于编辑：显示/发布所有数据通常是个坏主意，然后删除您认为不必要的内容。有一天你一定会忘记一个字段，然后你就有了一个错误或漏洞。我建议使用安全组件来防止表单篡改，然后只将这些字段添加到用户可以编辑的表单中，具体取决于访问级别。

CakePHP 文档告诉您在控制器的 POST 操作中手动添加要保存的字段，但这意味着您必须在 2 个位置维护字段列表：在您的表单视图中和控制器中。根据访问级别添加代码以包含/排除字段，您会感到头疼。使用安全防篡改，用户无法手动添加字段来操作 POST 数据。

# java - 泛指Java中不同家族的对象

> ID：14390310
> 
> 赞同：0
> 
> 时间：2013-01-17T23:56:48.097
> 
> 标签：java, generics

我有属于家庭的班级`Foo`( `BabyFoo`, `MamaFoo`, `PapaFoo`) 以及属于家庭的班级`Bar`( `BabyBar`, `MamaBar`, `PapaBar`)。在每个家庭中，很容易提及家庭成员。例如，当`MamaFoo`指代她自己的孩子时，她明确指代`BabyFoo`。但是在某些情况下，类在一个家族（ , , ）`Lou`的成员上运行代码而不知道哪个家族正在处理请求。`Baby``Mama``Papa`

如何`Lou`在 Java 中泛指任一家族的成员？

到目前为止，我的（糟糕的）解决方案是使用委托。Lou 不会对这两个家庭的成员运行代码。取而代之的是两个网关类`FamilyFoo`并`FamilyBar`处理来自`Lou`.

`FamilyFoo``FamilyBar`反过来又明确地提到了他们家庭中的阶级。这个解决方案结果很差，因为它会导致大量的代码重复，即使多态性（`Lou`委托给 a `Family reference`，两者的父级`FamilyFoo`and `FamilyBar`）意味着实现了一些代码经济性。

你能做得更好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:21:05.050

如果要对所有子类型进行相同的操作，您应该使用 Bar 和 Foo 可以实现的接口。

相反，如果有意义，您可以创建一个 Bar 和 Foo 都可以扩展的超类。根据您的解释，我无法确定哪个更好。我需要更多信息。

**编辑**：您可以使用代表家庭的通用家庭成员，例如`Baby<T>`, 。`Mama<T>``Papa<T>``T`

# android - ProgressDialog 与 AsyncTask - 不会显示

> ID：14390312
> 
> 赞同：1
> 
> 时间：2013-01-17T23:56:51.207
> 
> 标签：android, android-asynctask

我知道这个问题已被多次问过，但我有一个明显干净的代码，但它不起作用，没有给我任何异常或任何东西。

我有一个简单的一键式 Activity ( `MainActivity`)。其中的按钮调用 an`AsyncTask`以便在后台发送电子邮件。我试图做我认为这是一件很常见的事情：`ProgressDialog`在任务开始时显示 a 并在任务结束时将其关闭。为此，我将上述代码放入`AsyncTask.onPreExecute()`and`AsyncTask.onPostExecute()`中。我认为问题出在`Context`提供给对话框构造函数中，但我为我创建了一个简单的构造函数，我`AsyncTask`将应用程序上下文传递给该构造函数。我添加了一个简单`Toast`的调试，但它也没有出现......

这是按钮`onClick`方法的代码：

```
public void onClick(View v) {
    new Sender(this).execute("args");
} 
```

这是任务的代码：

```
private class Sender extends AsyncTask<String, Void, Void> {
    private ProgressDialog progDialog;
    private Context context;

    public Sender(Context context) {
        this.context = context;
    }

    @SuppressWarnings("unused")
        protected void onPreExecute(Void... params) {
        Toast.makeText(this.context, "Sending...", Toast.LENGTH_SHORT).show();
        progDialog = ProgressDialog.show(this.context, "Sending", "Picture is being sent...", true);
    }

    protected Void doInBackground(String... mailSubj) {
        // some code that works
        return null;
    }

    @SuppressWarnings("unused")
    protected void onPostExecute(Void... v) {
        progDialog.dismiss();
        Toast.makeText(MainActivity.this, "Mail sent", Toast.LENGTH_SHORT).show();
    }
} 
```

我哪里做错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T23:59:52.400

您的进度对话框未显示，因为您没有覆盖`onPreExecute()`. 添加`@Override`注释到你的`onPreExecute()`，看看会发生什么。`onPreExecute`不接受任何论据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:07:14.650

我发现了错误，解决方案很简单：添加`Void`参数列表`onPreExecute()`并`onPostExecute()`导致 Java 不覆盖`AsyncTask`. 第一个不需要参数，后者需要一个 Result （在这种情况下`Void`）参数。这个问题可以关闭。

# python - 创建金字塔教程应用程序时如何检查数据库中的数据？

> ID：14390318
> 
> 赞同：1
> 
> 时间：2013-01-17T23:57:20.753
> 
> 标签：python, database, pyramid

我正在阅读本教程 [http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/tutorials/wiki2/index.html](http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/tutorials/wiki2/index.html) ，我想看看我已将哪些页面添加到我的数据库中。如何查看数据库以查看其中的文件和条目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T04:39:12.033

您的项目目录中应该有一个扩展名为 .sqlite 的数据库文件。您可以使用 "sqlite3 myproject.sqlite" 来查看它。进入 sqlite shell 后，您可以键入“.help”以获取有关查看表的更多命令。

# mysql - 无法更新表

> ID：14390320
> 
> 赞同：0
> 
> 时间：2013-01-17T23:57:23.837
> 
> 标签：mysql, sql, tsqlt

所以现在我有一个简单的 SQL 存储过程，我可以调用它来更新数据库中的一个表。在存储过程中，我有一个 If 条件语句：

```
IF 1 > 0 THEN   
         UPDATE TABLE_A 
         SET COLUMN_1 =299999 
         WHERE COLUMN_2 ='2014-01-03'  and COLUMN_3=0; 
```

我很确定更新子句没有问题，因为当我单独运行它时，它会很好地更新表。我可以在表格中看到正在更新的值。

但是，当我将它放在`IF`语句之后（如上面的代码）时，更新失败（返回我没有受影响的行）。

我很确定 IF 语句也是正确的（现在我把它设置为 1>0 只是为了测试）。

如果我在 IF 之后放置一个插入语句，它也可以正常工作。正在向表中插入新行。这太奇怪了。有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T04:17:49.857

如果是 T-SQL，请尝试使用`BEGIN`语句而不是 then

```
IF 1 > 0
BEGIN
UPDATE TABLE_A 
SET COLUMN_1 =299999 
WHERE COLUMN_2 ='2014-01-03'  and COLUMN_3=0
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:12:16.733

尝试这个

```
 UPDATE TABLE_A 
     SET COLUMN_1 =299999 
     WHERE COLUMN_2 ='2014-01-03'  
     AND COLUMN_3=0
     AND 1 > 0 ;              <------- put it in where clause 
```

# java - 如何使用 VERTX 处理程序获取 POST 表单数据？

> ID：14390322
> 
> 赞同：4
> 
> 时间：2013-01-17T23:57:41.077
> 
> 标签：java, vert.x, forms, http-post

我可以使用缓冲区处理程序获取表单数据，但它是一个 void 函数，我无法返回表单数据值。总共有大约 4-7 个表单，我不想一遍又一遍地编写相同的处理程序，因为默认函数是无效的。

html:

```
<!DOCTYPE html>
<html>    
<head><title>Login Page</title></head>
<body>
    <a href="/activateUserPage">activate user</a>
    <br/>
    <a href="/login">log in</a>
    <br/>

    <form id='login' action='/login' method='post'>
        <fieldset >
            <legend>Login</legend>
            <input type='hidden' name='submitted' id='submitted' value='1'/>

            <label for='username' >UserName: </label>
            <input type='text' name='username' id='username'  maxlength="50"/>

            <label for='password' >Password: </label>
            <input type='password' name='password' id='password' maxlength="50"/>

            <input type='submit' name='Submit' value='Submit' />
        </fieldset>
    </form>         
</body>    
</html> 
```

爪哇：

```
import org.jboss.netty.handler.codec.http.QueryStringDecoder;
import org.vertx.java.core.Handler;
import org.vertx.java.core.Vertx;
import org.vertx.java.core.buffer.Buffer;
import org.vertx.java.core.http.HttpServer;
import org.vertx.java.core.http.HttpServerRequest;
import org.vertx.java.core.http.RouteMatcher;
import org.vertx.java.deploy.Verticle;

import java.util.Collection;
import java.util.List;
import java.util.Map;
import java.util.Set;

/**
 * Created by IntelliJ IDEA.
 * User: yao
 * Date: 1/17/13
 * Time: 2:22 PM
 */

public class Main extends Verticle
{
    @Override
    public void start() throws Exception
    {
        System.out.println("starting the vertx stuff");
        final String host = "localhost";
        final String port = "8181";

        Vertx vertx = Vertx.newVertx();
        HttpServer httpServer = vertx.createHttpServer();

        ...

        httpServer.requestHandler(new Handler<HttpServerRequest>()
        {
            public void handle(HttpServerRequest req)
            {
                String path = req.path;

                /* start mapping of page urls*/
                // redirect user to the login page
                if (path.equals("/"))
                {
                    req.response.sendFile(dir + "html/loginPage.html");
                }
                ...

                /* end mapping of page urls*/

                /* start mapping of form urls */
                // login
                else if (path.equals(login))
                {
                    mainLogin();
                    getFormData(req);
                }
                ...

                /* end mapping of form urls */

                /* all other pages */
                else
                {
                    req.response.end("404 - page no exist");
                }
            }
        });

        System.out.println("vertx listening to: " + host + " " + port);
        httpServer.listen(Integer.valueOf(port), host);
    }

    ...

    private void getFormData(final HttpServerRequest req)
    {
        req.bodyHandler(new Handler<Buffer>()
        {
            @Override
            public void handle(Buffer buff)
            {
                String contentType = req.headers().get("Content-Type");
                if ("application/x-www-form-urlencoded".equals(contentType))
                {
                    QueryStringDecoder qsd = new QueryStringDecoder(buff.toString(), false);
                    Map<String, List<String>> params = qsd.getParameters();
                    System.out.println(params);
                }
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-10-18T20:30:25.283

现在 BodyHandler 由 vertx 提供，使用它将 isExpectMultipart 设置为 true，您将能够读取表单属性为

```
request.getFormAttribute("username");//to read input named username. 
```

只需在您的实际处理程序之前添加这一行：

```
router.route().handler(BodyHandler.create()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-06-28T13:36:46.003

对于java，这非常有效：

```
request.expectMultiPart(true);
    request.endHandler(req->{
      String text = request.formAttributes().get("bigtext"); 
      //got it here
      //do something ...
 }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-30T22:37:36.703

我最后所做的基本上是这样的：

使用 post 进行 ajax 调用，表单中的数据需要序列化。

```
$.ajax
({
    type: "POST",
    url: "/login",
    data: $('#frm_login').serialize(),
    success: function(data)
... 
```

在后端，vertx 接收此数据作为缓冲区。rest 是通过“&”和“=”分割来解析缓冲区。

```
Map<String, String> params = new HashMap<String, String>();
String[] paramSplits = buffer.toString().split("&");
String[] valueSplits;

if (paramSplits.length > 1)
{
    for (String param : paramSplits)
    {
        valueSplits = param.split("=");
        if (valueSplits.length > 1)
        {
            // add this check to handle empty phone number fields
            params.put(decode(valueSplits[0]), decode(valueSplits[1]));
        }
    }
} 
```

希望这对其他人有帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-10T09:24:03.653

这可以使用 http 请求上的 formAttributes 来完成。这是scala中的一个例子

```
 req.expectMultiPart(true) //Will expect a form
  req.endHandler({

    req.formAttributes() //This is used to access form attributes

    //some code with attributes

  }) 
```

参考：http: [//vertx.io/core_manual_java.html#handling-multipart-form-attributes](http://vertx.io/core_manual_java.html#handling-multipart-form-attributes)

# java - JTable 可水平滚动并增长以填充父容器

> ID：14390324
> 
> 赞同：1
> 
> 时间：2013-01-17T23:57:55.510
> 
> 标签：java, swing, user-interface, jtable, jscrollpane

我想将 a`JTable`放入 a`JScrollPane`并希望它：

*   可水平和垂直滚动（仅当它的内容使其大于父容器时）
*   如果需要，自动增长以填充父容器（双向）
*   仅在需要时具有一个/两个滚动条

顺便说一句，`JList`行为完全一样。但是我发现没有简单的方法可以同时完成所有目标`JTable`。完成第一个的简单方法是禁用自动调整大小，但这会阻止第二个发生。我想出了一个非常 hacky 的解决方案，它将一个组件侦听器添加到`JScrollPane`并在调整该容器的大小时调整表格的大小。但是，我不得不在 resize 方法中添加一些“软糖因素”（见 4x 评论），因为我猜想存在一些固有的不准确性，所以我通过小像素量改变了我的高度/宽度检查。如果没有这些软糖因素，滚动条要么出现得太早（在需要它们之前），要么即使存在滚动条，长表格单元格的最后也会被截断。关于这些 hacky fudge 因素的最糟糕的部分是，如果您改变 GUI 的外观和感觉，那么整个解决方案将停止如此干净地工作（即 fudge 因素需要改变）。这显然与理想相去甚远。

必须有一种更清洁的方法来实现这一点。有人可以帮忙吗？运行附加的代码并拖动整个框架的大小以查看表格更新。这段代码使用了金属外观和感觉，这似乎可以在我的 Windows 7 机器上运行，并选择了软糖因素，但如果它在另一个操作系统上运行不那么干净，我不会感到惊讶。

```
import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.event.ComponentAdapter;
import java.awt.event.ComponentEvent;

import javax.swing.BoxLayout;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.ScrollPaneConstants;
import javax.swing.UIManager;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableCellRenderer;

public class JTableScrollTest {

    private JFrame frame;
    private JPanel panel;
    private DefaultTableModel tableModel;
    private JTable table;
    private JScrollPane scrollPane;

    /**
     * Launch the application.
     */
    public static void main(String[] args) {
        try {
            UIManager.setLookAndFeel("javax.swing.plaf.metal.MetalLookAndFeel");
        } catch (Throwable e) {
            e.printStackTrace();
        }

        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    JTableScrollTest window = new JTableScrollTest();
                    window.frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    /**
     * Create the application.
     */
    public JTableScrollTest() {
        initialize();
    }

    /**
     * Initialize the contents of the frame.
     */
    private void initialize() {
        frame = new JFrame();
        frame.setBounds(100, 100, 450, 300);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        panel = new JPanel();
        frame.getContentPane().add(panel, BorderLayout.CENTER);
        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));

        scrollPane = new JScrollPane();
        panel.add(scrollPane);

        tableModel = new DefaultTableModel(new Object[]{"Stuff"},0);
        tableModel.addRow(new Object[]{"reeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeally long string"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"a"});
        tableModel.addRow(new Object[]{"LAST ITEM"});
        table = new JTable(tableModel);
        table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        scrollPane.setViewportView(table);

        resizeTable();
        panel.addComponentListener(new ComponentAdapter() {
            @Override
            public void componentResized(ComponentEvent evt) {
                resizeTable();
            }
        });
    }

    public void resizeTable() {
        int width = 0;
        int height = 0;
        for (int row = 0; row < table.getRowCount(); row++) {
            TableCellRenderer renderer = table.getCellRenderer(row, 0);
            Component comp = table.prepareRenderer(renderer, row, 0);
            width = Math.max (comp.getPreferredSize().width, width);
            height += comp.getPreferredSize().height;
        }
        if (width > panel.getWidth() - 2) { // fudge factor
            width += 4; // fudge factor
            scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        } else {
            width = panel.getWidth();
            scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        }
        if (height > panel.getHeight() + 4) { // fudge factor
            height -= 26; // fudge factor
            scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        } else {
            height = panel.getHeight();
            scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_NEVER);
        }
        table.setPreferredSize(new Dimension(width, height));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:23:30.933

我遇到过同样的问题。该表只是使列更大或更小，而不是显示滚动条。通过反复试验，我想出的 hack 是`ComponentListener`您附加到`ScrollPane`.

诀窍是在滚动窗格小于表格的首选大小时关闭表格的自动调整大小。请注意，您不应直接设置表格的首选大小。不用管它自动计算。如果您需要更大或更小的某些列，请通过列模型（例如`table.getColumnModel().getColumn(0).setMaxWidth(25)`）设置它们的宽度。

此类还包括另一个`TableModelListener`在将列添加到表时执行相同逻辑的类。

```
public final class ScrollingTableFix implements ComponentListener {
  private final JTable table;

  public ScrollingTableFix(JTable table, JScrollPane scrollPane) {
    assert table != null;

    this.table = table;

    table.getModel().addTableModelListener(new ColumnAddFix(table, scrollPane));
  }

  public void componentHidden(final ComponentEvent event) {}

  public void componentMoved(final ComponentEvent event) {}

  public void componentResized(final ComponentEvent event) {
    // turn off resize and let the scroll bar appear once the component is smaller than the table
    if (event.getComponent().getWidth() < table.getPreferredSize().getWidth()) {
        table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
    }
    // otherwise resize new columns in the table
    else {
        table.setAutoResizeMode(JTable.AUTO_RESIZE_ALL_COLUMNS);
    }
  }

  public void componentShown(final ComponentEvent event) {}

  // similar behavior is needed when columns are added to the table
  private static final class ColumnAddFix implements TableModelListener {
    private final JTable table;
    private final JScrollPane scrollPane;

    ColumnAddFix(JTable table, JScrollPane scrollPane) {
      this.table = table;
      this.scrollPane = scrollPane;
     }

    @Override
    public void tableChanged(TableModelEvent e) {
      if (e.getFirstRow() == TableModelEvent.HEADER_ROW) {
        if (scrollPane.getViewport().getWidth() < table.getPreferredSize().getWidth()) {
          table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        }
        else {
          table.setAutoResizeMode(JTable.AUTO_RESIZE_ALL_COLUMNS);
        }
      }
     }
   }
} 
```

要使用它，只需像这样连接所有东西：

```
JTable table = new JTable();
JScrollPane scroller = new JScrollPane(table);
scroller.addComponentListener(new ScrollingTableFix(table, scroller)); 
```

# javascript - garlicjs-rails - 如果加载了 localStorage 数据，则提醒用户

> ID：14390327
> 
> 赞同：0
> 
> 时间：2013-01-17T23:58:14.510
> 
> 标签：javascript, ruby-on-rails-3, local-storage

garlicjs-rails 有一个名为“onRetrieve”的回调。我认为这就是我突出显示哪些字段来自 localStorage 的解决方案。我现在在这里有一个警报，只是为了调试，但会更改它以向那些从 localStorage 获取数据的字段添加一个类（即编辑现有数据，其中一些字段在数据库中，而一些字段没有或已更改） .

这个脚本来自garlicjs.js 网站

```
 $( 'input.no_good' ).garlic( {
      onRetrieve: function ( elem, retrievedValue ) {
      console.log( 'The retrieved value for ' + elem.name() + ' is : ' + retrievedValue );
     }
    } ); 
```

这就是我试图使用的

```
 $("input#user_certificatenumber").garlic onRetrieve: (elem, retrievedValue) ->
    alert "The retrieved value for " + elem.name() + " is : " + retrievedValue 
```

对我来说什么都没有发生......我期待的是，如果从 localStorage 中检索到 id 为 user_certificatenumber 的元素，则“.garlic onRetrieve”将触发并运行该函数。不是这样。

我希望我能从问这个问题中得到两件事：更好地学习 javascript 并弄清楚如何查看表单中的所有字段，而不仅仅是一个字段，然后使用 js 添加类并为从检索到的输入着色本地存储。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T11:28:02.200

你`data-persist="garlic"`在表格上加了吗？

如果是这样，您的`onRetrieve`侦听器不会应用于您的表单元素，因为表单已经被数据持久化绑定。

只需将您的行添加到整个表单（没有数据持久化）以在其 elems 上绑定 Garlic 并在每个字段上注册 onRetrieve 侦听器

```
$("#yourformid").garlic onRetrieve: (elem, retrievedValue) ->
    alert "The retrieved value for " + elem.name() + " is : " + retrievedValue 
```

最好的

# rjava - 安装和加载“rJava”

> ID：14390328
> 
> 赞同：3
> 
> 时间：2013-01-17T23:58:22.170
> 
> 标签：rjava

由于“rJava”的加载问题，我在加载“Deducer”包时遇到问题。“rJava”的安装似乎正确完成，但调用它加载时失败。

拜托，任何人都可以阐明一些智慧吗？:)

错误：'rJava' 的 loadNamespace() 中的 .onLoad 失败，详细信息：调用：stop("No CurrentVersion entry in '", key, "'！尝试重新安装 Java 并确保 R 和 Java 具有匹配的架构。")错误：找不到对象“键”错误：“rJava”的包/命名空间加载失败</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T12:10:44.277

在 xubuntu 12.04 上，通过以下方式将 javac 1.7.0_21 设置为默认值：

```
$ sudo update-alternatives 
```

然后

```
$ sudo R CMD javareconf
$ sudo R
> update.packages() 
```

# android - 在标签导航中使用片段或活动？

> ID：14390329
> 
> 赞同：0
> 
> 时间：2013-01-17T23:58:33.150
> 
> 标签：android, android-fragments, android-tabs

我有一个包含 4 个主要标签片段的应用程序。但是，在每个选项卡内，用户可以执行不同的操作，从而使他在同一选项卡内导航。我应该启动新活动还是只用新片段替换选项卡片段？我看到使用新活动的最大缺点是我失去了标签导航视图。

我应该怎么办？只使用片段？对于一项活动来说，这是很多片段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:11:54.710

使用片段。它们非常适合您的情况。不用担心，一个活动中的4个片段并不算多。片段被设计为轻量级，因此您可以使用更多。

# android - Android Sqlite 数据库架构

> ID：14390331
> 
> 赞同：10
> 
> 时间：2013-01-17T23:59:00.043
> 
> 标签：android, sqlite

我想我已经用 android 创建了一个 sqllite 数据库，但是每次我去插入时，它都声称一列不存在。如何查看架构以及在创建对象时是否调用了 onCreate 方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-18T00:06:06.813

你可以用代码做到这一点。Sqlite 有一个名为“sqlite_master”的表，其中包含模式信息。

```
 /**
     * Get all table Details from the sqlite_master table in Db.
     * 
     * @return An ArrayList of table details.
     */
    public ArrayList<String[]> getDbTableDetails() {
        Cursor c = db.rawQuery(
                "SELECT name FROM sqlite_master WHERE type='table'", null);
        ArrayList<String[]> result = new ArrayList<String[]>();
        int i = 0;
        result.add(c.getColumnNames());
        for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {
            String[] temp = new String[c.getColumnCount()];
            for (i = 0; i < temp.length; i++) {
                temp[i] = c.getString(i);
            }
            result.add(temp);
        }

        return result;
    } 
```

更简单的方法是在模拟器上运行它。

1.  打开 ddms 视角
2.  查找数据/data/PACKAGENAME/database/YOURFILE
3.  单击右上角的从数据库中提取按钮，如图所示。

打开 ![在此处输入图像描述](../Images/3a8e3ac73f90ed0908b8438169660783.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:39:36.580

检查数据库架构的另一种方法是`adb shell`进入设备（或模拟器）。使用：启动 sqlite 的命令行`sqlite3 <path to your database>`并`.schema`在命令提示符下键入。

请参阅：http: [//developer.android.com/tools/help/sqlite3.html](http://developer.android.com/tools/help/sqlite3.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-21T08:41:00.873

您可以按如下方式获取表名：

```
 /**
     * Get all table Details from the sqlite_master table in Db.
     * 
     * SQlite has a table called "sqlite_master " which holds schema information.
     * 
     * @return An ArrayList of table names.
     */
    public ArrayList<String> getDbTableNames(SQLiteDatabase db) {
        ArrayList<String> result = new ArrayList<String>();
        Cursor c = db.rawQuery("SELECT name FROM sqlite_master WHERE type='table'", null);

            if (c.moveToFirst()) {
                while ( !c.isAfterLast() ) {
                    result.add( c.getString(c.getColumnIndex("name")) );
                    c.moveToNext();
                }
            }

        return result;
    } 
```

# c++ - 当 UDF 调用基于另一个 UDF 的输出时，Excel 在用户定义的 DLL 上崩溃

> ID：14390335
> 
> 赞同：0
> 
> 时间：2013-01-17T23:59:08.413
> 
> 标签：c++, visual-studio, excel, dll, user-defined-functions

我编写了一个 Excel 可以使用的 dll 文件，但是我的电子表格在某些情况下会崩溃。如果有人可以帮助我，我将不胜感激。

我正在使用的 C++ 代码如下：（主要是从 C++ 包 QuantLib 借来的）

```
long __stdcall nextBusinessDay_C(long todaySerial) {
    Date today(todaySerial);
    UnitedStates us(UnitedStates::NYSE);
    return (long)(us.advance(today,1,Days).serialNumber());
} 
```

在 Excel 中，我有以下 VBA 代码

```
Declare Function yz_nextBusinessDayUS_NYSE_C Lib _
    "c:\lib\myExcelFile.dll" _
(ByVal ds As Long) As Long

Function nextBizDayUS(d As Date) As Date
    nextBizDayUS = nextBusinessDayUS_C(CLng(d))
End Function 
```

现在，在 Excel 中，如果我只使用：

```
//This works perfectly fine
A1: 1/1/2013         B1: =nextBizDayUS(A1)
A2: 1/2/2013         B2: =nextBizDayUS(A2)
A3: 1/2/2013         B3: =nextBizDayUS(A3)
...                  ... 
```

我可以像这样继续写几千行，没有任何问题。但是，如果我使用一个函数的输出作为另一个函数的输入，每次按下 Ctrl+Alt+F9 时，我的 Excel 都会崩溃：

```
//This crashes every time when I hit Ctrl+Alt+F9!!!
A1: 1/1/2013
A2: =nextBizDayUS(A1)
A3: =nextBizDayUS(A2) 
```

在我的 C++ 库中使用的源代码与 QuantLib 包完全相同（我只是想学习这个包，而不是推销我自己的代码）代码使用的唯一花哨的东西是 boost::shared_ptr<>。

我为此困扰了很多天。希望有人可以帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T15:09:48.407

谢谢大家的回复。我已经想通了。

文件崩溃是因为我的 C++ 函数在接受 0 值作为输入日期时抛出异常。在 excel 中，如果我有以下工作表：

```
A1: 1/1/2013
A2: =nextBizDayUS(A1)
A3: =nextBizDayUS(A2) 
```

一旦我按下 Ctrl+Alt+F9，nextBizDayUS 将按以下顺序评估 3 次：

```
=nextBizDayUS(0)  'cell A3
=nextBizDayUS(A1)  'cell A2
=nextBizDayUS(A2)  'cell B3 
```

不知道 Excel 为什么这样做，但为了解决这个问题，我只需要在我的 C++ 函数中添加一个特殊情况来处理 0 值输入。

# c# - 如何制作一个弹出面板来加载网页以在 .aspx 页面中进行调查？

> ID：14390336
> 
> 赞同：3
> 
> 时间：2013-01-17T23:59:22.143
> 
> 标签：c#, asp.net, popup, frames

我想要完成的是这个。我希望它是这样的，当用户单击一个按钮时，会出现一个弹出窗口并允许他们完成调查。但是，我不希望它是一个弹出窗口，就像图像中的那样。此外，弹出窗口需要能够嵌入网页，因为调查本身就是一个页​​面。所以基本上，不是当用户单击他们被重定向的按钮时，我想要一个弹出窗口（而不是弹出窗口）出现在其中的页面。我目前使用的是面板中的iframe，但我觉得肯定有比使用frames更好更稳定的方式。任何人都可以提出更好的方法吗？对不起我的术语，如果不知道这叫什么，我是 .ASP NET wed 开发的新手。下面是代码（按钮将 visible=”False” 更改为 true）：

```
 <asp:Panel CssClass="BlowItUp" ID="Panel1" runat="server" 
            Visible="False" >

         <iframe src="http://10.0.0.1/start.htm" style="width:100%; height:100%; top:0px;" />

      </asp:Panel> 
```

重要的CSS：

```
.BlowItUp
{
    position:absolute;
    width:80%;
    height:90%;
    z-index:300;    
    right:10%;
    top:5%;
    padding:0px;
} 
```

![在此处输入图像描述](../Images/e4c10f8595d8e88cab7d3e103e07b6a9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:00:33.407

除非您可以控制“内部”页面，否则我认为框架是您要管理的最佳选择。否则，内页将寻求导航到另一个页面，您将失去“框架”。

我建议的一件事是不同的弹出面板。说[jQuery UI 对话框](http://jqueryui.com/dialog/)？

# node.js - Nodejs 两条路径的区别

> ID：14390337
> 
> 赞同：12
> 
> 时间：2013-01-17T23:59:22.333
> 
> 标签：node.js

我正在尝试区分两条路径。我有一个解决方案，但我对此并不满意，即使它有效。有没有更好/更简单的方法来做到这一点？

```
var firstPath =  '/my/first/path'
  , secondPath = '/my/first/path/but/longer'

// what I want to get is: '/but/longer'

// my code:
var firstPathDeconstruct = firstPath.split(path.sep)
  , secondPathDeconstruct = secondPath.split(path.sep)
  , diff = []

secondPathDeconstruct.forEach(function(chunk) {
  if (firstPathDeconstruct.indexOf(chunk) < 0) {
    diff.push(chunk)
  }
})

console.log(diff)
// output ['but', 'longer'] 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-18T00:11:06.717

Node 提供了一个标准函数 ，`path.relative`它正是这样做的，并且还处理您可能遇到的所有各种相对路径边缘情况：

来自[在线文档](http://nodejs.org/api/path.html#path_path_relative_from_to)：

> # `path.relative(from, to)`
> 
> 求解从`from`到的相对路径`to`。
> 
> 例子：
> 
> ```
> path.relative('C:\\orandea\\test\\aaa', 'C:\\orandea\\impl\\bbb')
> // returns
> '..\\..\\impl\\bbb'
> 
> path.relative('/data/orandea/test/aaa', '/data/orandea/impl/bbb')
> // returns
> '../../impl/bbb' 
> ```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-18T00:04:04.890

这可能有效。尽管它依赖于这样一个事实，即它知道它们中的哪一个是另一个的子集，并假设大小写相同。

```
var diff = secondPath.substring(firstPath.length); 
```

# java - 无法使用正则表达式匹配字符串“[help]”中的字符串“help”

> ID：14390342
> 
> 赞同：1
> 
> 时间：2013-01-17T23:59:47.700
> 
> 标签：java, regex

我无法让它正确匹配。它只打印“[help]”，但我希望它匹配括号内的字符。

想：

```
[help]
help 
```

代码：

```
 Pattern p = Pattern.compile("\\[(\\w+)\\]");
        Matcher m = p.matcher("[help]");
        m.find();

        for (int i=0;i<m.groupCount(); i++) {
            System.out.println(m.group(i));
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T00:05:17.500

您需要检查`<=`groupCount。像这样：

```
for (int i = 0; i <= m.groupCount(); i++) { 
```

来自[Matcher Javadoc](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/regex/Matcher.html#groupCount%28%29)：

> 任何小于或等于此方法返回值的非负整数都保证是此匹配器的有效组索引。

# ruby-on-rails - Factory Girl：未初始化的常量

> ID：14390345
> 
> 赞同：8
> 
> 时间：2013-01-18T00:00:02.387
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec2, factory-bot

我有一个工厂，例如：

```
FactoryGirl.define do
  factory :page do
    title 'Fake Title For Page'
  end
end 
```

和一个测试：

```
describe "LandingPages" do
    it "should load the landing page with the correct data" do
        page = FactoryGirl.create(:page)
        visit page_path(page)
    end
end 
```

我的 spec_helper.rb 包含：

```
require 'factory_girl_rails' 
```

但我不断得到：

```
LandingPages should load the landing page with the correct data
     Failure/Error: page = FactoryGirl.create(:page)
     NameError:
       uninitialized constant Page
     # ./spec/features/landing_pages_spec.rb:5:in `block (2 levels) in <top (required)>' 
```

这是一个新项目，所以我不相信测试实际上是问题所在。我相信它可能设置不正确。关于尝试和/或在哪里解决这个问题的任何想法？

我平静的 pages.rb 文件：

```
class Pages < ActiveRecord::Base
  # attr_accessible :title, :body
end 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-18T00:14:40.557

从您的文件名来看，该模型实际上名为 LandingPage。工厂试图根据你给它的名字来猜测你的类名。所以 :page 变成了 Page。

您可以更改工厂的名称，也可以添加显式类选项：

```
FactoryGirl.define do
  factory :landing_page do
    title 'Fake Title For Page'
  end
end 
```

或者

```
FactoryGirl.define do
  factory :page, :class => LandingPage do
    title 'Fake Title For Page'
  end
end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-18T01:01:07.017

看起来您的模型名称是复数：`Pages`. 这应该真的是单数：`Page`. 您还需要将文件重命名`app/models/page.rb`为。FactoryGirl 假设一个单一的模型名称。

# c++ - 在 VS Locals 窗口中更改变量的显示名称

> ID：14390346
> 
> 赞同：0
> 
> 时间：2013-01-18T00:00:08.750
> 
> 标签：c++, visual-studio-2010, debugging, visual-studio-debugging, visual-studio-extensions

我们有一种自定义脚本语言，可以生成 C++ 块。它的设计方式是为 C++ 端的每个类类型生成“thisPtr”作为“this”对象。

我想知道是否有一种方法可以扩展本地/监视窗口，以便将“thisPtr”显示为“this”，以便用户在监视窗口中键入查找内容会更简单。

# javascript - 让这个 jQuery 工作是我毕生的抱负

> ID：14390348
> 
> 赞同：-3
> 
> 时间：2013-01-18T00:00:21.100
> 
> 标签：javascript, jquery

我正在尝试为我的第一个特定页面的移动版本编写一些 jQuery。如果我检测到较小的浏览器尺寸，我只会显示文章列表。一旦用户点击一篇文章，我希望列表最小化并且文章显示在主要内容中。我试图通过在单击文章时隐藏列表来做到这一点，但我几乎无法超越将页面制作成任何内容的基本步骤。这是我尝试在鼠标悬停时仅在文章列表周围设置边框：

```
<script>
    if( $(window).width() < 481 && $(window).width() > 0 ) {
        $("div.st_tabs_container").mouseover(function () {
            alert("asdfasd");
            $("div.st_tabs_container").css("border", "3px double red");
           alert("swear words");
        });
    } else {
    }
</script> 
```

我可以让它做任何事情的唯一方法是编写 ("*").mouseover(function){ 。如果我选择了所有内容，鼠标悬停将起作用，st_tabs_container 将获得红色边框并且警报将消失。如果我尝试选择其他任何东西（.ie $("div.st_tabs_container") ）它不起作用。谁能解释一下？我确定这很简单，但我不明白。更糟糕的是，我需要在点击时执行操作的实际元素是 div.st_vertical ul.st_tabs a.st_tab_active 。我没有运气编写选择它的代码。任何和所有的智慧将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:11:52.050

做这样的事情，例如： http: [//jsfiddle.net/ZMBWZ/](http://jsfiddle.net/ZMBWZ/) 如果它不起作用，让屏幕变小

html:

```
<div class="st_tabs_container"></div> 
```

CSS：

```
div{
 height: 100px;
  width: 100px;
  border: 1px solid red;
} 
```

查询：

```
$(function () {
    if ($(window).width() < 481 && $(window).width() > 0) {
        $("div.st_tabs_container").mouseover(function () {
            alert("asdfasd");
            $("div.st_tabs_container").css("border", "3px double red");
            alert("swear words");
        });
    }else{}
}); 
```

# ios - iOS 存折序列号：哪些字符有效？最大长度是多少？

> ID：14390351
> 
> 赞同：4
> 
> 时间：2013-01-18T00:00:34.780
> 
> 标签：ios, passbook

Passbook for iOS 使用一个序列号，您的服务器可以使用该序列号来识别特定的通行证。

有谁知道存折序列号中哪些字符是有效的？我知道数字和字母是有效的，但符号/标点符号也有效（例如“-”和“.”）？

另外，序列号的最大长度是多少？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T01:13:49.757

几乎可以使用任何字符，包括“-”和“.”，只要序列保持唯一即可。特殊字符，如 '\' 需要正确转义，尽管它们可能与您的数据库不兼容，或者如果在代码的其他地方没有正确处理，可能会导致其他问题。

我刚刚尝试使用以下序列号通过，它添加到 Passbook 没有任何问题。

```
"serialNumber":"[]{}-_)(*&^%$#@!`~+=|\\\/?.><,:;" 
```

UTF8 编码的字符也可以：

```
"serialNumber":"\u9127\u6a02\u611a" // Chinese characters 鄧樂愚 
```

至于最大长度，我不知道有任何限制，尽管实验起来很简单。

这一系列 400 个字符也摄取 ok。

```
"serialNumber":"0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789" 
```

我建议不要对序列使用任何类型的用户输入，因为这可能会导致非唯一冲突并使您面临注入攻击。此外，如果您更改架构（比如 AWS DynamoDB 等 Web 服务解决方案），为了避免任何问题，遵守 XML 标准也不是一个坏习惯。Base64 编码您的序列将确保广泛的兼容性。

序列号也可用于在 pass 中存储元数据。

```
"serialNumber":"UniqueID|data1|data2|data3|etc." 
```

# android - 未由 JUnit 运行的 Activity 的 Android 测试

> ID：14390356
> 
> 赞同：1
> 
> 时间：2013-01-18T00:00:54.427
> 
> 标签：android, eclipse, unit-testing, junit, android-testing

我正在尝试第一次进行 Android 单元测试，但遇到了一个我似乎无法解决的问题：只运行了一个测试类，我无法运行与 Activity 测试相关的测试类，并且即使在其中断言 true=false 也不会显示错误。

我的测试项目由三个源文件组成：

*   我项目中某个类的测试文件（AndroidTestCase 的子类）
*   我的第一个活动的测试文件 LoginActivity（ActivityInstrumentationTestCase2 的子类）
*   另一个活动的测试文件，EditUserActivity（又是 ActivityInstrumentationTestCase2 的子类）

我使用了以下教程： http: [//forum.frandroid.com/topic/13831-traduc-de-tuto-les-tests-unitaires/](http://forum.frandroid.com/topic/13831-traduc-de-tuto-les-tests-unitaires/)（法语但代码是英语）

首先阅读 StackOverflow 上的以下答案：[尝试在 Eclipse 中运行 Android JUnit 测试失败？](https://stackoverflow.com/questions/2346734/trying-to-run-android-junit-tests-in-eclipse-fails)但这似乎不是我的问题

最后一个测试类的代码如下：

```
package com.imci.ica.test;

import com.imci.ica.EditUserActivity;
import android.test.ActivityInstrumentationTestCase2;

public class EditUserActivityTest extends
        ActivityInstrumentationTestCase2<EditUserActivity> {
    EditUserActivity mActivity;

    public EditUserActivityTest() {
        super("com.imci.ica", EditUserActivity.class);
    }

    @Override
    protected void setUp() throws Exception {
        super.setUp();
        mActivity = this.getActivity();
    }

    public void testTest() {
        assertEquals(true, false);
    }
} 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-29T21:50:03.777

对我来说，我发现一个测试班正在崩溃。我忘了添加非参数构造函数。解决这个问题，所有测试都会运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:08:47.360

我不明白为什么，但我不得不移动 Eclipse 项目的文件，所以我关闭了项目，移动它们并将项目导入回来，现在检查了所有测试，所以我的问题得到了解决。如果它可以帮助某人...

# mysql - 计算表中的重复名称

> ID：14390357
> 
> 赞同：1
> 
> 时间：2013-01-18T00:01:00.300
> 
> 标签：mysql, sql, database, join

我有两个表：Customer 和 ParkingTransaction。我想展示最常使用地段的前 10 位客户。ParkingTrasaction 表中的“CustomerKey”是将 ParkingTransaction 连接到 Customer 的 FK。我编写了以下代码，它计算了 ParkingTransaction 表中最常用的 CustomerKey，它工作正常......

```
SELECT TOP 10 CustomerKey
, count(*) as 'Usage'
  FROM ParkingTransaction
  GROUP BY CustomerKey
  HAVING (count(CustomerKey) > 0)
  ORDER BY 'Usage' DESC 
```

这是我的输出

[输出](http://i.imgur.com/5sY7o.png)

我面临的问题是：我想从 Customer 表中提取 FirstName 和 LastName 字段，而不是仅按 CustomerKey 排序。我已经搞砸了 JOINS，但还没有提出解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:06:16.330

MySQL`LIMIT`不使用`TOP`.

```
SELECT  a.FirstName, a.LastName,
        COUNT(*) as `Usage`
FROM    Customer a
        INNER JOIN ParkingTransaction b
            ON a.CustomerKey = b.CustomerKey
GROUP BY a.FirstName, a.LastName
ORDER BY `Usage` DESC
LIMIT 10 
```

由于查询正在使用`INNER JOIN`,`HAVING COUNT(*) > 0`在这种情况下是不必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:11:14.337

这是一种方法：

```
SELECT CustomerKey, c.firstname, c.lastname, count(*) as 'Usage'
FROM ParkingTransaction pt join
     customer c
     on pt.customerkey = c.customerkey
GROUP BY pt.CustomerKey, c.firstname, c.lastname, 
ORDER BY 'Usage' DESC
limit 10 
```

# php - PHP MySql：explode 和 JOIN 组合

> ID：14390360
> 
> 赞同：0
> 
> 时间：2013-01-18T00:01:22.777
> 
> 标签：php, mysql, join, explode

我将用户 ID 与单独的逗号放在一起以`MySql TABLE`获得最佳用户。现在我为这个结果`Example : 1,2,3`使用函数：`PHP` `explode()`

```
$bestuser = explode(',',$bestuser); 
```

我有另一个 MySql TABLE 用于此行的用户列表：id/name/datejoin/birthday ....

现在，我需要使用 MySql JOIN 方法打印最佳用户的名称。实际上我的意思是如何将爆炸结果与其他 MySql TABLE 结果结合起来。

**注意**：我知道这个设计（1,2,3）很糟糕，但我别无选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:15:08.950

您可以编写一个 SQL 查询来执行此操作：

```
SELECT id,name
FROM user
WHERE id IN (:yourListOfIds) 
```

如果列表以任何方式由用户提供，请注意 SQL 注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T09:26:34.023

*可以*在连接条件中使用 MySQL 的[`FIND_IN_SET()`](http://dev.mysql.com/doc/en/string-functions.html#function_find-in-set)功能：

```
table_a JOIN table_b ON FIND_IN_SET(table_a.id_a, table_b.csv_a) 
```

但是（根据我上面评论中的警告）这个操作将非常低效，因为 MySQL 必须完全扫描两个表。

一个*更好的*解决方案是创建一个关系表：

```
CREATE TABLE relations (
  FOREIGN KEY (id_a) REFERENCES table_a (id_a),
  FOREIGN KEY (id_b) REFERENCES table_b (id_b)
) SELECT table_a.id_a, table_b.id_b
  FROM   table_a JOIN table_b
      ON FIND_IN_SET(table_a.id_a, table_b.csv_a);

ALTER TABLE table_b DROP csv_a; 
```

然后可以根据需要通过连接表来查询所需的数据：

```
SELECT   table_a.*
FROM     table_a JOIN relations USING (id_a)
WHERE    relations.id_b = ? 
```

如果需要，甚至可以使用 MySQL 的[`GROUP_CONCAT()`](http://dev.mysql.com/doc/en/group-by-functions.html#function_group-concat)函数来获取原始 CSV：

```
SELECT   table_b.id_b, GROUP_CONCAT(relations.id_a) AS csv_a
FROM     table_b JOIN relations USING (id_b)
WHERE    ...
GROUP BY table_b.id_b 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T00:16:32.417

看到[这个问题](https://stackoverflow.com/questions/471914/can-you-split-explode-a-field-in-a-mysql-query)，但是如果你看一下[手册](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)上的评论，你会发现很多人都在谈论爆炸。

# ruby-on-rails - Rails 自动加载在 RSpec 中的行为很奇怪，带有模块和带有 spork 的子类

> ID：14390361
> 
> 赞同：0
> 
> 时间：2013-01-18T00:01:23.693
> 
> 标签：ruby-on-rails, rspec, spork

在我的 Rails 应用程序中，我添加了以下文件：
app/models/baz.rb
lib/presenters/foo_presenter.rb
lib/presenters/foo_presenter/bar.rb
spec/models/baz_spec.rb
spec/lib/presenters/foo_presenter/ bar_spec.rb

lib/presenters/foo_presenter.rb 的内容类似于：

```
module Presenters
  module FooPresenter
    def self.render
      # do stuff
    end
  end
end 
```

lib/presenters/foo_presenter/bar.rb 的内容如下：

```
module Presenters
  class FooPresenter::Bar
    def baz
      # do stuff
    end
  end
end 
```

spec/lib/presenters/foo_presenter/bar_spec.rb 的内容如下：

```
require 'spec_helper'

module Presenters::FooPresenter
  describe Bar do
    # some tests
  end
end 
```

然后我在 spec/models/baz_spec.rb 中有一个规范文件：

```
require 'spec_helper'

describe Baz do
  it 'works' do
    Presenters::FooPresenter.render
  end
end 
```

（app/models/baz.rb 的内容与这个问题无关）
问题是当我运行`rspec spec/models/baz_spec.rb`它时没有 spork 可以正常工作，但是当 spork 运行时，我收到如下错误：NameError: undefined method `render' for演示者::FooPresenter:模块

我对代码进行了一些跟踪，并注意到当 rspec 加载 spec/lib/presenters/foo_presenter/bar_spec.rb 时，它会导致 Rails 自动加载 lib/presenters/foo_presenter/bar.rb 等此时 Presenters::FooPresenter::Bar已加载，但是当 baz_spec.rb 运行时， lib/presenters/foo_presenter.rb 从未加载过，因此出现异常。但这只有在 spork 正在运行时才会发生。快速修复是`require 'foo_presenter'`在 config/initializers 中的文件中，但是是否有不需要显式要求的更清洁的解决方案？我的猜测是这里的问题是 Rails 不会自动加载 lib/presenters/foo_presenter.rb 因为 Presenters::FooPresenter 已经由 bar_spec.rb 定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T20:02:53.807

我和一位同事今天遇到了这个问题，我们最终发现我们需要 Spork 在每次运行时重新加载类。我们使用 each_run() 方法来做到这一点：

```
Spork.each_run do
  Dir[Rails.root.join("app/classes/**/*.rb")].each {|f| require f}
end 
```

# linux - curl 和 cookies - 命令行工具

> ID：14390364
> 
> 赞同：0
> 
> 时间：2013-01-18T00:01:38.887
> 
> 标签：linux, cookies, curl

我正在尝试更熟悉 curl，因此我正在尝试从我已经登录的站点向网页发送发布请求：

```
curl --data "name=value" http://www.mysite.com >> post_request.txt 
```

我有一个包含所有 hmtl 页面的输出，其中有一条消息告诉我我没有登录，所以我检索了网站的 cookie（称为 PHPSESSID，很重要），将其存储在 /temp/cookies.txt 中，然后

```
 curl --cookie /tmp/cookies.txt --cookie-jar /tmp/cookies.txt --data "name=value" http://www.mysite.com > post_request.txt 
```

但我仍然有同样的信息。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:40:15.597

我建议您使用网络转储工具（`wireshark`或`tcpdump`）并嗅探您的外壳和服务器之间的通信。检查 cookie 是否已发送以及是否包含正确的内容。

# ios - 在Objective-C中的NSString中存储带有特殊字符的URL字符串

> ID：14390365
> 
> 赞同：1
> 
> 时间：2013-01-18T00:01:48.997
> 
> 标签：ios, objective-c, ipad, url, freebase

我正在尝试在 iOS 应用程序中使用[Freebase ，并且查询是使用 URL 构建的。](http://www.freebase.com/)URL 包含多个特殊字符（{}、:)，但我希望能够使用 URL 字符串，以便可以从 Freebase 下载数据。

https://www.googleapis.com/freebase/v1/mqlread?query=[{"type":"/music/album","name":null,"artist":{"id":"/en/ bob_dylan"},"limit":3}]&光标

在 Safari 中加载 URL 时，浏览器实际上将该字符串转换为：[https ://www.googleapis.com/freebase/v1/mqlread?query=%5B%7B%22type%22:%22/music/album% 22,%22name%22:null,%22artist%22:%7B%22id%22:%22/en/bob_dylan%22%7D,%22limit%22:3%7D%5D&cursor](https://www.googleapis.com/freebase/v1/mqlread?query=%5B%7B%22type%22:%22/music/album%22,%22name%22:null,%22artist%22:%7B%22id%22:%22/en/bob_dylan%22%7D,%22limit%22:3%7D%5D&cursor)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:11:14.667

您可以在 an 上使用此方法`NSString`为您添加百分比转义。

```
- (NSString *)stringByAddingPercentEscapesUsingEncoding:(NSStringEncoding)encoding 
```

# c# - 使用 WPF 在 XAML 中实现 CollectionChanged 处理程序

> ID：14390368
> 
> 赞同：1
> 
> 时间：2013-01-18T00:01:57.750
> 
> 标签：c#, wpf, events, user-interface, event-handling

我使用了位于[stackoverflow:event-fired-when-item-is-added-to-listview](https://stackoverflow.com/questions/5904519/event-fired-when-item-is-added-to-listview)的解决方案来利用 CodeBehind 中的接口 INotifyCollectionChanged。有没有办法在 XAML 中添加这个 EventHandler？

本质上，我希望在 XML 中定义这一行：

```
((INotifyCollectionChanged)lbFiles.Items).CollectionChanged += lbFiles_SelectionChanged; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:34:55.363

您应该只是在`CollectionChanged`绑定到您的 ListBox/ListView 等的集合上创建事件，从后面的代码中直接访问控件不是 WPF 做事的方式。

例子：

xml:

```
<Window x:Class="WpfApplication8.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="340" Width="480" Name="UI" >
    <Grid DataContext="{Binding ElementName=UI}">
        <ListBox ItemsSource="{Binding MyProperty}" />
    </Grid>
</Window> 
```

代码：

```
public partial class MainWindow : Window
{
    private ObservableCollection<string> _myProperty = new ObservableCollection<string>();

    public MainWindow()
    {
        InitializeComponent();
        MyProperty.CollectionChanged += MyProperty_CollectionChanged;
    }

    public ObservableCollection<string> MyProperty
    {
        get { return _myProperty; }
        set { _myProperty = value; }
    }

    void MyProperty_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        // Collection Changed
    }
} 
```

# jquery - jQuery函数没有正确传递参数

> ID：14390371
> 
> 赞同：0
> 
> 时间：2013-01-18T00:02:10.190
> 
> 标签：jquery, html, jquery-ui

[http://jsbin.com/ituxij/4/edit](http://jsbin.com/ituxij/4/edit)

我正在尝试使用 Jquery 将图像拖放到 div 我有一个功能

```
<div id="trash" class=""> Trash</div> 
```

* * *

```
$trash.droppable({
    accept: "#gallery > li",
    activeClass: "ui-state-highlight",
    drop: function(event, ui) {
        var $droppableId = $(this).attr("id");

        deleteImage($droppableId, ui.draggable);
    }
}); 
```

在这种情况下 $droppableId = 垃圾或我的 div 的名称。

我打电话

```
function deleteImage($droppableId, $item) {
    $item.fadeOut(function() {
        alert($droppableId);
        var $list = $("ul", $droppableId).length ? $("ul", $droppableId) : $("<ul class='gallery ui-helper-reset'/>").appendTo($droppableId);

        $item.find("a.ui-icon-trash").remove();
        $item.append(recycle_icon).appendTo($list).fadeIn(function() {
            $item.animate({
                width: "48px"
            }).find("img").animate({
                height: "36px"
            });
        });
    });
} 
```

该函数提醒垃圾，这是正确的，但是当我尝试将“垃圾”传递给 .appendTo 方法时，它的工作方式与我简单地输入垃圾不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:05:48.780

`$droppableId`只是元素的 id，而不是选择器或元素本身。

尝试`.appendTo($('#'+$droppableId));`或 `.appendTo('#'+$droppableId);`

作为一个侧面，我会尽量避免`$`在使用 jquery 时在变量的开头使用，它看起来有点令人困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:05:43.723

```
$("#trash").droppable({      
   accept: "#gallery > li",      
   activeClass: "ui-state-highlight",    
   drop: function( event, ui ) {   
   var $droppableId = $(this).attr("id");

  deleteImage($droppableId, ui.draggable );     
  }   
  }); 
```

# mysql - MD5 函数返回空结果

> ID：14390375
> 
> 赞同：7
> 
> 时间：2013-01-18T00:02:28.790
> 
> 标签：mysql, md5

我试图从我的数据库中返回一个值的 MD5 编码字符串，但它只返回一个空白结果（不是 null，只是空白）。我试过运行这个查询并得到相同的结果：

```
SELECT MD5('test'); 
```

我尝试重新启动 MySQL 服务器、MySQL Workbench 等。但得到相同的结果。如果我尝试在不同的数据库/服务器上运行相同的命令，它会很好地返回哈希字符串。

我究竟做错了什么？是否有我在意外中禁用的设置？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-18T01:14:14.297

在 MySQL v5.5.3 之前，`MD5()`返回二进制字符串。

默认情况下，MySQL Workbench 不显示二进制字符串（避免意外误解）；但是可以在输出网格中显示二进制字符串值：查看 > 编辑 > 首选项 > SQL 编辑器 >`BINARY/VARBINARY`视为非二进制字符串。

或者，升级您的 MySQL 服务器或将结果转码为非二进制字符集：

```
SELECT CONVERT(MD5('test') USING utf8) 
```

# android - 尝试从 ImageView 获取图像时出现空指针异常

> ID：14390378
> 
> 赞同：0
> 
> 时间：2013-01-18T00:03:15.760
> 
> 标签：android, nullpointerexception, android-imageview

我正在尝试将表单中的详细信息提交到设备上的本地数据库。我得到一个空指针，这似乎出现在这部分代码中。我有一种感觉，这可能与我尝试从 ImageView 获取图像的方式有关。

有任何想法吗？

```
 addContactBtn.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            Toast.makeText(v.getContext(), "Add Contact", Toast.LENGTH_SHORT).show();
            i = new Intent(v.getContext(), ViewActivity.class);
            //Add contact to database
            dbAdapter.addContact(nameBox.getText().toString(), numberBox.getText().toString(), emailBox.getText().toString(), imgHolder.getDrawingCache());
            startActivity(i);
        }
    });
} 
```

这是 addContact() 方法：

```
public void addContact(String name, String number, String email, Bitmap img){
    ContentValues values = new ContentValues();

    ByteArrayOutputStream out = new ByteArrayOutputStream();
    img.compress(Bitmap.CompressFormat.PNG, 100, out);

    values.put(COLUMN_NAME, name);
    values.put(COLUMN_NUMBER, number);
    values.put(COLUMN_EMAIL, email);
    values.put(COLUMN_IMG, out.toByteArray());

    db.insert(TABLE_NAME, null, values);
    Toast.makeText(context, "Contact Added Successfully!", Toast.LENGTH_SHORT).show();
} 
```

这是日志输出：

```
01-17 23:57:16.939: E/AndroidRuntime(4582): FATAL EXCEPTION: main
01-17 23:57:16.939: E/AndroidRuntime(4582): java.lang.NullPointerException
01-17 23:57:16.939: E/AndroidRuntime(4582):     at com.example.contactappca2.AddActivity$2.onClick(AddActivity.java:73)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at android.view.View.performClick(View.java:3549)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at android.view.View$PerformClick.run(View.java:14400)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at android.os.Handler.handleCallback(Handler.java:605)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at android.os.Handler.dispatchMessage(Handler.java:92)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at android.os.Looper.loop(Looper.java:154)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at android.app.ActivityThread.main(ActivityThread.java:4944)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at java.lang.reflect.Method.invokeNative(Native Method)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at java.lang.reflect.Method.invoke(Method.java:511)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-17 23:57:16.939: E/AndroidRuntime(4582):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:32:05.693

如果你直接传递 Bitmap 而不是 imgHolder.getDrawableCache() 会更好，它应该可以工作，

```
BitmapDrawable drawable = (BitmapDrawable) imgHolder.getDrawable();
Bitmap bitmap = drawable.getBitmap();

i = new Intent(v.getContext(), ViewActivity.class);
//Add contact to database
dbAdapter.addContact(nameBox.getText().toString(), numberBox.getText().toString(), emailBox.getText().toString(), bitmap);
startActivity(i); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:28:39.303

在调用之前尝试在相应的布局上调用[layout(int, int, int, int)](https://developer.android.com/reference/android/view/View.html#layout%28int,%20int,%20int,%20int%29)`imgHolder.getDrawingCache();`

在这里看到：[Android 2.1 View 的 getDrawingCache() 方法总是返回 null](https://stackoverflow.com/questions/2817166/android-2-1-views-getdrawingcache-method-always-returns-null)

# wif - Windows 身份基础 4.5 配置

> ID：14390382
> 
> 赞同：8
> 
> 时间：2013-01-18T00:03:47.667
> 
> 标签：wif

我们有一个最初使用 .NET 4.0 和 WIF 3.5（1.0？）构建的应用程序。我正在将其转换为使用 WIF 4.5，因为我们已将应用程序升级到 .NET 4.5。我已经完成了所有代码更改，并且一直在与配置设置作斗争。我目前的困境在于 <claimTypeRequired> 元素。根据[这个文档](http://msdn.microsoft.com/en-us/library/hh598930.aspx)，它应该是 <identityConfiguration> 的孩子，但是当我修改我的配置看起来像这样

```
<system.identityModel>
  <identityConfiguration>
    <claimTypeRequired>
      ...
    </claimTypeRequired> 
```

我在运行时收到以下错误

```
Parser Error Message: Unrecognized element 'claimTypeRequired'. 
```

如果我只是注释掉 <claimTypeRequired> 块，我会克服该错误，但随后会遇到另一个问题。我们通过以下配置修改了现有应用程序中的 maximumClockSkew

```
<securityTokenHandlerConfiguration>
  <maximumClockSkew value="1" />
</securityTokenHandlerConfiguration> 
```

前面引用的配置文档甚至没有提到 maximumClockSkew。我想我会试着把它留在里面看看会发生什么。发生的事情是

```
Parser Error Message: Property 'maximumClockSkew' is not a ConfigurationElement. 
```

但是当我使用 JustDecompile 查看 SecurityTokenHandlerConfigurationElement 类时，我可以看到以下属性：

```
[ConfigurationProperty("maximumClockSkew", IsRequired=false, DefaultValue="00:05:00")]
[IdentityModelTimeSpanValidator(MinValueString="00:00:00")]
[TypeConverter(typeof(TimeSpanOrInfiniteConverter))]
public TimeSpan MaximumClockSkew... 
```

所以它似乎期待它在那里。

这几乎就像微软实际上并不希望我们使用这些东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-19T13:04:29.157

这是来自 resharper 的 IdentityConfigurationElement 的反编译。您会注意到 claimtyperequired 不再是该元素的成员。尽管它在 Microsoft 的文档中，但它似乎不是架构的一部分。

```
// Type: System.IdentityModel.Configuration.IdentityConfigurationElement
// Assembly: System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
// Assembly location: C:\Windows\Microsoft.NET\Framework\v4.0.30319\System.IdentityModel.dll

using System;
using System.ComponentModel;
using System.Configuration;
using System.Runtime;

namespace System.IdentityModel.Configuration
{
  /// <summary>
  /// Represents an &lt;identityConfiguration&gt; element in a configuration file. This class cannot be inherited.
  /// </summary>
  public sealed class IdentityConfigurationElement : ConfigurationElement
  {
    /// <summary>
    /// Initializes a new instance of the <see cref="T:System.IdentityModel.Configuration.IdentityConfigurationElement"/> class.
    /// </summary>
    [TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")]
    public IdentityConfigurationElement();
    /// <summary>
    /// Gets or sets the name of the identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// The name of the identity configuration.
    /// </returns>
    [ConfigurationProperty("name", Options = ConfigurationPropertyOptions.IsKey)]
    [StringValidator(MinLength = 0)]
    public string Name { get; set; }
    /// <summary>
    /// Gets the <see cref="T:System.IdentityModel.Configuration.AudienceUriElementCollection"/> that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// The collection of audience URIs that are configured for this identity configuration element.
    /// </returns>
    [ConfigurationProperty("audienceUris", IsRequired = false)]
    public AudienceUriElementCollection AudienceUris { get; }
    /// <summary>
    /// Gets or sets the <see cref="T:System.IdentityModel.Configuration.IdentityModelCachesElement"/> that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// The element that configures the token replay cache and the session security token cache for this identity configuration element.
    /// </returns>
    [ConfigurationProperty("caches", IsRequired = false)]
    public IdentityModelCachesElement Caches { get; set; }
    /// <summary>
    /// Gets or sets the <see cref="T:System.IdentityModel.Configuration.X509CertificateValidationElement"/> that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// The element that configures the certificate validator and its properties for this identity configuration element.
    /// </returns>
    [ConfigurationProperty("certificateValidation", IsRequired = false)]
    public X509CertificateValidationElement CertificateValidation { get; set; }
    /// <summary>
    /// Gets or sets the claims authentication manager that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// A custom type element that specifies the <see cref="T:System.Type"/> of the claims authentication manager. The type must derive from <see cref="T:System.Security.Claims.ClaimsAuthenticationManager"/>.
    /// </returns>
    [ConfigurationProperty("claimsAuthenticationManager", IsRequired = false)]
    public CustomTypeElement ClaimsAuthenticationManager { get; set; }
    /// <summary>
    /// Gets or sets the claims authorization manager that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// A custom type element that specifies the <see cref="T:System.Type"/> of the claims authorization manager. The type must derive from <see cref="T:System.Security.Claims.ClaimsAuthorizationManager"/>.
    /// </returns>
    [ConfigurationProperty("claimsAuthorizationManager", IsRequired = false)]
    public CustomTypeElement ClaimsAuthorizationManager { get; set; }
    /// <summary>
    /// Gets or sets the <see cref="T:System.IdentityModel.Configuration.IssuerNameRegistryElement"/> that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// The element that configures the issuer name registry for this identity configuration element.
    /// </returns>
    [ConfigurationProperty("issuerNameRegistry", IsRequired = false)]
    public IssuerNameRegistryElement IssuerNameRegistry { get; set; }
    /// <summary>
    /// Gets or sets the issuer token resolver that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// A custom type element that specifies the <see cref="T:System.Type"/> of the issuer token resolver. The type must derive from <see cref="T:System.IdentityModel.Selectors.SecurityTokenResolver"/>.
    /// </returns>
    [ConfigurationProperty("issuerTokenResolver", IsRequired = false)]
    public CustomTypeElement IssuerTokenResolver { get; set; }
    /// <summary>
    /// Gets or sets the maximum clock skew that is configured for this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// The maximum clock skew.
    /// </returns>
    [TypeConverter(typeof (TimeSpanOrInfiniteConverter))]
    [ConfigurationProperty("maximumClockSkew", DefaultValue = "00:05:00", IsRequired = false)]
    [IdentityModelTimeSpanValidator(MinValueString = "00:00:00")]
    public TimeSpan MaximumClockSkew { get; set; }
    /// <summary>
    /// Gets or sets a value that indicates whether to save the bootstrap context in claims identities and session security tokens created by the handlers configured in this identity collection.
    /// </summary>
    /// 
    /// <returns>
    /// true to save the <see cref="T:System.IdentityModel.Tokens.BootstrapContext"/>; otherwise, false.
    /// </returns>
    [ConfigurationProperty("saveBootstrapContext", DefaultValue = false, IsRequired = false)]
    public bool SaveBootstrapContext { get; set; }
    /// <summary>
    /// Gets or sets the service token resolver that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// A custom type element that specifies the <see cref="T:System.Type"/> of the service token resolver. The type must derive from <see cref="T:System.IdentityModel.Selectors.SecurityTokenResolver"/>.
    /// </returns>
    [ConfigurationProperty("serviceTokenResolver", IsRequired = false)]
    public CustomTypeElement ServiceTokenResolver { get; set; }
    /// <summary>
    /// Gets or sets the <see cref="T:System.IdentityModel.Configuration.TokenReplayDetectionElement"/> that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// The element that specifies whether token replay detection is enabled and specifies the maximum expiration period for tokens in the token replay cache.
    /// </returns>
    [ConfigurationProperty("tokenReplayDetection", IsRequired = false)]
    public TokenReplayDetectionElement TokenReplayDetection { get; set; }
    /// <summary>
    /// Gets or sets the <see cref="T:System.IdentityModel.Configuration.SecurityTokenHandlerSetElementCollection"/> that is associated with this identity configuration element.
    /// </summary>
    /// 
    /// <returns>
    /// The security token handler collections configured for this identity configuration element..
    /// </returns>
    [ConfigurationProperty("", Options = ConfigurationPropertyOptions.IsDefaultCollection)]
    public SecurityTokenHandlerSetElementCollection SecurityTokenHandlerSets { get; }
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-02T14:11:32.263

顺便说一句，如果您还没有发现 XML 中的 claimTypeRequired 属性，您可以使用它作为解决方法：

在配置文件的顶部，输入：

```
<section name="system.identityModel.services.serialization" type="System.IdentityModel.Services.Serialization , System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/> 
```

然后围绕claimTypeRequired，这是一个示例：

```
<system.identityModel.services.serialization>
        <claimTypeRequired>
          <claimType type="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name" optional="true"/>
          <claimType type="http://schemas.microsoft.com/ws/2008/06/identity/claims/role" optional="true"/>
        </claimTypeRequired>
  </system.identityModel.services.serialization> 
```

亲切的问候，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-31T18:09:39.080

你几乎接近了这是在配置中设置它的答案

```
 <securityTokenHandlerConfiguration saveBootstrapContext="true" maximumClockSkew="00:35:00" > 
```

它可以在这里将其设置为 35 分钟的值。hh:MM:ss

# python - ansi 颜色未显示在 emacs 窗口中

> ID：14390388
> 
> 赞同：3
> 
> 时间：2013-01-18T00:04:26.790
> 
> 标签：python, emacs, colors, ansi-escape

我知道以前有人问过这个问题的变体......但我一定遇到了不同的问题，因为解决方案对我不起作用。我有一个使用 ANSI 代码的文本文件，当我`cat`将文件发送到终端时，它可以很好地显示。但是，当我对文件进行 emacs 23.2.1 时，我看到如下内容：

```
^[[36mText^[[0m 
```

如果重要的话，`^[`那一行中的两个都是红色的（emacs 将其视为一个字符），而该文本的其余部分是黑色的。我希望该行在 emacs 编辑器中为浅蓝色。提到我正在使用 python 代码制作这个文件可能会有所帮助

```
python
>>> myfile = open("test.txt","w")
>>> myfile.write("\033[36mText\033[0m\n")
>>> myfile.close() 
```

生成该文本。环顾四周，我尝试了几种解决方案：

```
(require 'ansi-color)                                                                                                                                                                                              
;(autoload 'ansi-color-for-comint-mode-on "ansi-color" nil t)                                                                                                                                                      

(add-hook 'shell-mode-hook 'ansi-color-for-comint-mode-on)                                                                                                                                                         

;(setq ansi-term-color-vector [unspecified "#3f3f3f" "#cc9393" "#7f9f7f" "#f0dfaf"  "#8cd0d3" "#dc8cc3" "#93e0e3" "#dcdccc"]) 

;(defun colorize-compilation-buffer ()                                                                                                                                                                             
;  (toggle-read-only)                                                                                                                                                                                              
;  (ansi-color-apply-on-region (point-min) (point-max))                                                                                                                                                            
;  (toggle-read-only))                                                                                                                                                                                             
;(add-hook 'compilation-filter-hook 'colorize-compilation-buffer)                                                                                                                                                  

;(defadvice display-message-or-buffer (before ansi-color activate)                                                                                                                                                 
;  "Process ANSI color codes in shell output."                                                                                                                                                                     
;  (let ((buf (ad-get-arg 0)))                                                                                                                                                                                     
;    (and (bufferp buf)                                                                                                                                                                                            
;         (string= (buffer-name buf) "*Shell Command Output*")                                                                                                                                                     
;         (with-current-buffer buf                                                                                                                                                                                 
;           (ansi-color-apply-on-region (point-min) (point-max)))))) 
```

但这些都不起作用。我不是 emacs/lisp 专家......所以我在这里很无助。我还尝试清除`.emacs`文件中的所有其他内容，以防万一发生冲突。

关于我可以尝试什么的任何其他想法？

# twitter-bootstrap - 从 font awesome SVG 文件手动创建 SVG 文件时，无法从 fontcustom 创建正确大小和对齐的图标

> ID：14390391
> 
> 赞同：1
> 
> 时间：2013-01-18T00:04:56.340
> 
> 标签：twitter-bootstrap, svg, custom-font, font-awesome

我正在尝试从 fontawesome 的 svg 文件 (fontawesome-webfont.svg) 中提取 SVG 文件，以便我只能使用特定字体并使用 fontcustom 创建自己的自定义字体。所有这些都是为了减少字体文件的大小，因为我没有使用所有 300 个左右的 fontawesome 图标，而只是少数。

如何为现有图标提取 SVG 文件？我尝试了很多组合，其中之一是：

从 font-awesome.min.css，我知道图标日历是：

```
.icon-calendar:before { content: "\f073"; } 
```

接下来，从 fontawesome-webfont.svg 中，我复制了以 d=" 开头的图标日历的字形代码，并创建了一个新的 SVG 文件（通过前缀路径）calendar.svg 以供 fontcustom 使用。

```
<svg xmlns="http://www.w3.org/2000/svg">
<path d="M128 -128h288v288h-288v-288zM480 -128h320v288h-320v-288zM128 224h288v320h-288v-320zM480 224h320v320h-320v-320zM128 608h288v288h-288v-288zM864 -128h320v288h-320v-288zM480 608h320v288h-320v-288zM1248 -128h288v288h-288v-288zM864 224h320v320h-320v-320z M512 1088v288q0 13 -9.5 22.5t-22.5 9.5h-64q-13 0 -22.5 -9.5t-9.5 -22.5v-288q0 -13 9.5 -22.5t22.5 -9.5h64q13 0 22.5 9.5t9.5 22.5zM1248 224h288v320h-288v-320zM864 608h320v288h-320v-288zM1248 608h288v288h-288v-288zM1280 1088v288q0 13 -9.5 22.5t-22.5 9.5h-64 q-13 0 -22.5 -9.5t-9.5 -22.5v-288q0 -13 9.5 -22.5t22.5 -9.5h64q13 0 22.5 9.5t9.5 22.5zM1664 1152v-1280q0 -52 -38 -90t-90 -38h-1408q-52 0 -90 38t-38 90v1280q0 52 38 90t90 38h128v96q0 66 47 113t113 47h64q66 0 113 -47t47 -113v-96h384v96q0 66 47 113t113 47 h64q66 0 113 -47t47 -113v-96h128q52 0 90 -38t38 -90z"
style="fill:#000000;fill-opacity:1;stroke:none" />
</svg> 
```

如果我不包含 style=fill 行，那么 SVG 将不会在浏览器中呈现，因此 fontcustom 将创建一个空白 TTF 文件。

到目前为止，一切都很好。所以能够手动创建一个 SVG 文件，并运行 fontcustom 脚本来生成 fontcustom.css 和其他字体文件。但是，现阶段存在多个问题：

1.  结果图标的大小与我使用 font awesome 的大小不同。它相当大。这与在 SVG 中指定我缺少的某些内容有关。但我不知道从哪里复制它！

2.  一些图标是旋转的。例如，星形图标会略微旋转。

    .icon-star-empty:before { 内容: "\f006"; }

它必须与手动创建的单个 SVG 文件有关。我错过了什么？还是有别的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:22:07.373

如果您只对使用 Font Awesome 图标感兴趣，最好的方法是使用[icnfnt.com](http://icnfnt.com/)。如果您想组合一些自己的图标，[IcoMoon 应用程序](http://icomoon.io/app/)应该非常简单。

# jquery - 使用 jQuery 格式化 json.net 日期

> ID：14390394
> 
> 赞同：1
> 
> 时间：2013-01-18T00:05:01.453
> 
> 标签：jquery, datepicker, json.net

我从 JSON.NET 获得了以下日期（使用 HTML 显示）。

```
<span class="date"> 2013-01-01T00:00:00  </span>
<span class="date"> 2009-05-01T00:00:00  </span>
<span class="date"> 2011-01-06T00:00:00  </span>
<span class="date"> 2012-03-09T00:00:00  </span> 
```

如何将这些日期转换为“mm-dd-yyyy”格式。这意味着，HTML 应该是这样的：

```
<span class="date"> 01-01-2013  </span>
<span class="date"> 05-01-2009  </span>
<span class="date"> 01-06-2011  </span>
<span class="date"> 03-09-2012  </span> 
```

我尝试了几种使用 jQuery DatePicker 和 DateFormat 的方法。[我在SO](https://stackoverflow.com/questions/3215508/how-to-format-this-date-type-2010-06-24t000000z-to-sun-24-06-10-7-15-p-m-cdt)上也有类似的问题。但我仍然无法弄清楚这一点。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:38:11.250

jQuery UI`datepicker.parseDate`不能解析时间，所以你必须删除它们：

```
var input = "2013-01-01T00:00:00";
input = input.split("T")[0]; // "2013-01-01"
var date = $.datepicker.parseDate("yy-mm-dd", input); 
```

然后使用`formatDate`应该不是问题：

```
var newDateString = $.datepicker.formatDate("mm-dd-yy", date); 
```

要获取跨度 html：

```
var spanHtml = "<span class='date'> " + newDateString + " </span>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:39:44.947

```
$('span').text(function(i, v){
   var d = new Date($.trim(v));
   return (d.getMonth()+1) + '-' + d.getDate() + '-' + d.getFullYear();
}); 
```

[http://jsfiddle.net/BdMfp/](http://jsfiddle.net/BdMfp/)

# batch-file - 使用隐藏的 cmd.exe 打开应用程序

> ID：14390396
> 
> 赞同：2
> 
> 时间：2013-01-18T00:05:23.933
> 
> 标签：batch-file, cmd, avd

要打开 Android 虚拟设备，建议在下一行添加快捷方式或批处理文件：

```
C:\android-sdk\tools\emulator.exe -avd MyAVD 
```

然而，当我这样做时，它会打开一个命令行窗口，如果我错误地关闭它（因为我使用许多命令行窗口来调试应用程序，所以经常出现这种情况），它也会关闭 AVD 模拟器。

我想在没有命令行窗口的情况下打开 AVD，为了防止这种情况，我建议在开始时使用`cmd /c`或使用`start` ，但它也不起作用。任何人都可以告诉我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T11:09:13.823

您可以使用 VBScript 打开隐藏的命令提示符窗口

```
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run("C:\batchfile.bat"), 0, True 
```

如果您将其另存为`.vbs`并确保替换`C:\batchfile.bat`为您的位置，这将运行隐藏的命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:25:43.120

这应该这样做，它应该作为`taskeng.exe`任务管理器中的子进程运行。

```
schtasks -create -tn foo -tr <command> -sc once -st 00:00 -ru system
schtasks -run -tn foo
schtasks -delete -tn foo -f 
```

[**参考**](https://stackoverflow.com/questions/14391774/schtasks-system-fails)

# php - 连续文件上传？

> ID：14390399
> 
> 赞同：0
> 
> 时间：2013-01-18T00:05:46.937
> 
> 标签：php, file-upload

有些文件必须上传到系统。主要是 5-10MB 的 JPG 文件。但是，用户通常上传速度很慢，所以大部分时间都超过了 max_execution_time()。

我无权修改 max_execution_time()

这个案子有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:20:26.010

尝试设置使用`ini_set()`：

```
$max_execution_time = 1000; // or whatever value you need
ini_set('max_execution_time', $max_execution_time); 
```

# c# - Activator.GetObject 返回身份验证失败

> ID：14390407
> 
> 赞同：0
> 
> 时间：2013-01-18T00:06:14.067
> 
> 标签：c#, remoting

我有一对旧的 (2008) C# 应用程序，一个提供 TCP 侦听器服务，另一个是连接到该服务的客户端。如果我在同一台机器上运行这两个应用程序，它工作正常。但是，如果我尝试从仅通过 VPN 连接到服务器的机器上的客户端进行连接，则会出现身份验证失败。两台机器上的防火墙都关闭了。

```
IFoo factory = (IFoo)Activator.GetObject(
                    typeof(IFoo),
                    pathtoService);
remoteData = factory.CreateInstance(); 
```

CreateInstance 调用失败并显示身份验证消息。

首先 - 这种旧技术是否被更好的技术所取代（甚至更简单？）其次 - 有什么方法可以传递凭据，这样就可以了？

# xslt - 使用 XSLT 转换“编号”键值 XML 元素

> ID：14390413
> 
> 赞同：1
> 
> 时间：2013-01-18T00:06:21.740
> 
> 标签：xslt

我有一个数据集（我无法控制），它有一个简单的键值结构。如果填充具有 n 行的表，则输出样本将是：

```
<property>
  <name>Row1_Field1</name>
  <value>Data Value Sample</value>
</property>
<property>
  <name>Row1_Field2</name>
  <value>Data Value Sample</value>
</property>
<property>
  <name>Row2_Field1</name>
  <value>Data Value Sample</value>
</property>
<property>
  <name>Row2_Field2</name>
  <value>Data Value Sample</value>
</property> 
```

是否有可能使用 XSLT 将其转换为更易于使用的东西，例如下面的示例？

```
<rows>
  <row>
    <Field1>Data Value Sample</Field1>
    <Field2>Data Value Sample</Field2>
  </row>
  <row>
    <Field1>Data Value Sample</Field1>
    <Field2>Data Value Sample</Field2>
  </row>
</rows> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:28:45.373

**这种转变：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
     <rows>
      <xsl:apply-templates/>
     </rows>
 </xsl:template>

 <xsl:template match=
  "property[not(substring-before(name,'_')
               =
                substring-before(preceding-sibling::*[1]/name,'_'))]">
  <row>
    <xsl:apply-templates mode="inRow" select=
     "/*/property[substring-before(name,'_') = substring-before(current(),'_')]"/>
  </row>
 </xsl:template>

 <xsl:template match="property" mode="inRow">
  <xsl:element name="{substring-after(name,'_')}"><xsl:value-of select="value"/></xsl:element>
 </xsl:template>
 <xsl:template match="property"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<properties>
    <property>
        <name>Row1_Field1</name>
        <value>Data Value Sample</value>
    </property>
    <property>
        <name>Row1_Field2</name>
        <value>Data Value Sample</value>
    </property>
    <property>
        <name>Row2_Field1</name>
        <value>Data Value Sample</value>
    </property>
    <property>
        <name>Row2_Field2</name>
        <value>Data Value Sample</value>
    </property>
</properties> 
```

**产生想要的正确结果：**

```
<rows>
   <row>
      <Field1>Data Value Sample</Field1>
      <Field2>Data Value Sample</Field2>
   </row>
   <row>
      <Field1>Data Value Sample</Field1>
      <Field2>Data Value Sample</Field2>
   </row>
</rows> 
```

# javascript - HTML5使用 javascript 更改

> ID：14390415
> 
> 赞同：1
> 
> 时间：2013-01-18T00:07:00.460
> 
> 标签：javascript, html

我有`<input type=date id=something>`

我想使用 javascript 更改数据。

我在 mysql 中发送查询并请求日期，所以我需要把那个日期放在那里我试过`document.getElementById.('something').value=$new`了，但它没有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:19:02.533

因为日期格式必须采用 ISO 8601 格式，您可能需要编辑作为值传递的内容

例如：

```
<input type="date" name="dt" value="1999-07-16"> 
```

有效，但

```
<input type="date" name="dt" value="1999-7-16"> 
```

没有

# html - 子站点中不同的自动填充系统

> ID：14390417
> 
> 赞同：3
> 
> 时间：2013-01-18T00:07:09.640
> 
> 标签：html, autocomplete

我正在使用登录对话框在某个域上编写 Web 系统。

系统位于一个地址上

```
http://www.example.com/systemB/ 
```

但是，地址有不同的系统

```
http://www.example.com/systemA/ 
```

使用不同的登录对话框，使用不同的凭据。（`systemB`经常用的用户也用`systemA`。）

然而，大多数浏览器会自动`http://www.example.com/systemA/`从 `http://www.example.com/systemB/`.

我可以这样编写网站，使对话框不会自动填充`systemA`，但仍然允许自动填充？（例如，写一些“自动填充域”。）

我知道我可以`autocomplete="off"`使用，但我不想直接关闭它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T16:13:27.903

您可以尝试为 systemA (value="") 中的字段设置空值。当用户打开它时，这些字段是空的，但如果他点击它们，就会有自动填充建议。

# wpf - F# 将向量数组转换为 Media.Polygon PointCollection

> ID：14390422
> 
> 赞同：1
> 
> 时间：2013-01-18T00:08:18.820
> 
> 标签：wpf, vector, f#, polygons

不同的数据结构对某些事情来说是好/更好的，而不是对其他事情。

有没有办法将向量数组转换为 WPF 多边形使用？

```
let mutable nodes = [| Vector (100.0, 100.0); Vector (60.0, 20.0); Vector (80.0, 60.0); Vector(50.0, 100.0); Vector (100.0, 80.0); Vector (30.0, 140.0); Vector (20.0, 80.0); Vector (30.0, 30.0); |]

let spolyS : Point seq = Seq.ofArray [| Vector (0.0, 0.0); Vector (6.0, 2.0); Vector (8.0, 6.0); Vector(5.0, 10.0); Vector (10.0, 8.0); Vector (3.0, 14.0); Vector (-2.0, 8.0); Vector (-3.0, 3.0); |]
let seqFromArray1 = [| 1..10 |] :> seq<int>
let seqFromArray2 = [| 1 .. 10 |] |> Seq.ofArray
let seqFromArray3 = polyS :> seq<Point>

let mutable arrayList1 = new System.Collections.ArrayList(10)
for i in 1 .. 10 do arrayList1.Add(10) |> ignore
let seqCast : seq<int> = Seq.cast arrayList1

let mutable arrayList2 = new Media.PointCollection(10)
for i in 1 .. 10 do arrayList1.Add(10) |> ignore
let seqCast : seq<Point> = Seq.cast arrayList2
let spts : Point seq = Seq.ofArray polyS |> new Media.PointCollection
let spts : Point seq = Seq.ofArray polyS |> new Media.PointCollection
let spts : Point seq = Seq.ofArray polyS |> new Media.PointCollection(spts IEnumerable<Point>):unit 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T03:27:24.360

也许是这样的：

```
let vectors = [| Vector(100.0, 100.0); Vector(60.0, 20.0); ... |]
let points = vectors |> Array.map (fun v -> Point(v.X, v.Y))
let mediaPoints = Media.PointCollection(points) 
```

# openmp - 使用 OpenMP 拆分 LAPACK 调用

> ID：14390423
> 
> 赞同：2
> 
> 时间：2013-01-18T00:08:21.707
> 
> 标签：openmp, lapack

我正在对我编写的一个例程进行代码调整，其中一部分执行两个可以同时完成的矩阵乘法。目前，我在第一个 DGEMM 和第二个 DGEMM 上调用 DGEMM（来自英特尔的 MKL 库）。每次调用都会使用我机器上的所有 12 个内核。我希望它同时执行两个 DGEMM 例程，每个使用 6 个内核。我觉得这是一件简单的事情，但无法找到/理解如何实现这一点。我遇到的主要问题是 OpenMP 必须从一个线程调用 DGEMM 例程，但每次调用都可以使用 6 个。哪个指令最适合这种情况？它需要嵌套的编译指示吗？

因此，作为更一般的说明，我如何将（在我的情况下为 12 个）核心划分为集合，然后从一个线程运行一个例程，该线程使用其集合中的所有线程。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T13:55:32.083

您可以做的最接近的事情是让一个由两个线程组成的团队执行一个 OpenMP 并行区域，然后从每个线程调用 MKL。您必须在 MKL 中启用嵌套并行（通过禁用动态线程），将 MKL 线程数固定为 6，并且必须使用英特尔的编译器套件来编译您的代码。MKL 本身使用 OpenMP 进行线程化，但它是英特尔的 OpenMP 运行时。如果您碰巧使用了其他编译​​器，例如 GCC，它的 OpenMP 运行时可能与 Intel 的不兼容。

由于您没有指定语言，我提供了两个示例 - 一个在 Fortran 中，一个在 C/C++ 中：

Fortran：

```
call mkl_set_num_threads(6)
call mkl_set_dynamic(0)

!$omp parallel sections num_threads(2)
!$omp section
   call dgemm(...)
!$omp end section
!$omp section
   call dgemm(...)
!$omp end section
!$omp end parallel sections 
```

C/C++：

```
mkl_set_num_threads(6);
mkl_set_dynamic(0);

#pragma omp parallel sections num_threads(2)
{
    #pragma omp section
    {
        cblas_dgemm(...)
    }
    #pragma omp section
    {
        cblas_dgemm(...)
    }
} 
```

一般来说，您不能为 MKL 创建线程子集（至少考虑到我目前的理解）。每个 DGEMM 调用将使用全局指定数量的 MKL 线程。请注意，MKL 操作可能会针对 CPU 的缓存大小进行调整，并且并行执行两个矩阵乘法可能没有好处。如果您有一个带有两个六核 CPU 的 NUMA 系统，每个 CPU 都有自己的内存控制器（我怀疑是您的情况），您可能会这样，但您必须注意数据的放置位置并启用线程的绑定（固定）到核心。

# cordova - 黑莓应用程序：在应用程序关闭时使用 phonegap 推送

> ID：14390424
> 
> 赞同：3
> 
> 时间：2013-01-18T00:08:30.590
> 
> 标签：cordova, blackberry, push

我一般的问题，（对不起，如果重复，我在这个网站上搜索了大约一天）

我在 phonegap (2.3) 中构建了一个黑莓 webworks 应用程序（适用于 webworks 5+）。应用程序工作正常，它注册了 BIS 服务，我可以向应用程序发送推送通知，但只有当应用程序出现在屏幕上时。

基本上我想通知显示类似于 android 或 ios，它会弹出或转到消息中心。

我该如何解决这个问题，是我在关闭应用程序时如何处理它，还是我需要设置某种类型的侦听器事件？

感谢任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-01T08:00:23.853

您需要调用`launchApplicationOnPush()`PushService 实例。

查看[`successCreatePushService`pushCapture 示例](https://github.com/blackberry/BB10-WebWorks-Samples/blob/master/pushCapture/www/js/common.js#L716)中的方法以获取工作示例。

# css - 媒体查询未在 IE 中获取

> ID：14390430
> 
> 赞同：0
> 
> 时间：2013-01-18T00:08:56.433
> 
> 标签：css, media-queries

我的 css 文件中有以下测试代码：

```
@media only screen and (min-width: 960px){
    body{
        background-color: red;
    }
    .wrapperShadow {
        margin: 0px 3em;
        box-shadow: 0px 0px 2.5em 0.5em rgba(0, 0, 0, 0.4);
    }
    .wrapperShadow {
        margin: 0px 3em;
        box-shadow: 0px 0px 2.5em 0.5em rgba(0, 0, 0, 0.4);
    }

 } 
```

我添加了红色作为测试。但是在 IE 中，它并没有按照 F12 工具选择这个 css，
我只是想知道问题可能是什么。

**编辑1：**

我注意到的是，我的网站在各个页面上默认为兼容模式。当我使用地址栏中的小破页符号关闭兼容模式时，页面看起来正确。
为什么它默认为兼容模式？是因为我的标题中有以下行：

```
<meta http-equiv="X-UA-Compatible" content="IE=8">
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" > 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:21:12.500

你有打开兼容模式吗？检查...

（IE9 在“兼容性视图设置”下有“在兼容性视图中显示 Intranet 站点”）

祝你好运..）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:26:34.513

据我所知，IE9 可以理解@media 查询，但早期版本不能。如果您在 PC 上按 f12，然后检查兼容模式，您可能会发现它运行的是早期版本。

我曾经看到这段代码显示子 IE9 浏览器的默认图像：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T00:31:22.480

呃，实际上它不会让我发布代码。解决方法在第 85 行：[https ://github.com/scottjehl/picturefill/commit/9aa22f58cd338bdd22e907239cb33629a5ec2143](https://github.com/scottjehl/picturefill/commit/9aa22f58cd338bdd22e907239cb33629a5ec2143)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T02:59:27.150

使用这些元标记，您告诉 ie 使用 ie 7 视图引擎，哎呀。当您删除这些标签时，您将使用 9 或 10 视图引擎。

# integration-testing - 使用 RSpec 发送原始帖子数据

> ID：14390432
> 
> 赞同：3
> 
> 时间：2013-01-18T00:08:59.020
> 
> 标签：integration-testing, rspec-rails

我正在尝试在功能性 RSpec 示例中发布一些原始数据：

```
payload = "{wrongly_formatted_json}"
uri = "http://example.com"
headers["HTTP_CONTENT_TYPE"] = "application/json"
post(uri, payload, headers) 
```

RSpec 太聪明了，它把我的请求有效载荷包装在另一个哈希中：

```
{"{wrongly_formatted_json}" => nil} 
```

我发现有人推荐`@request.env['RAW_POST_DATA']`，但请求对象在我的示例中不可用。@request 对象附带 ActiveSupport::TestCase 并且因此不能使用，或者是因为我包含了 Rack::Test::Methods，我对吗？

如何使用 RSpec 发布原始数据？注意，我想发送*格式错误的*JSON。我正在使用 rspec-rails 2.12.0。

这是一个类似的[SO question](https://stackoverflow.com/questions/2103977/how-to-send-raw-post-data-in-a-rails-functional-test)，提出了同样的问题，但他们使用 ActiveSupport::TestCase 来解决它。

# c# - 为什么 Response.Write() 只写入列表中的第一个元素？

> ID：14390438
> 
> 赞同：0
> 
> 时间：2013-01-18T00:09:55.237
> 
> 标签：c#, asp.net, xml, .net-4.0

我正在尝试在我的页面上写一些联合，

我使用 .Net 类将 rss 内容放入列表

```
<div>    
    <%
        var r = System.Xml.XmlReader.Create("http://www.huffingtonpost.com/feeds/verticals/small-business/index.xml");
        System.ServiceModel.Syndication.SyndicationFeed albums = System.ServiceModel.Syndication.SyndicationFeed.Load(r);
        r.Close(); 

        foreach (System.ServiceModel.Syndication.SyndicationItem album in albums.Items)
        {
            Response.Write(album.Title.Text);                        
        }                          
    %>
</div> 
```

好吧，`foreach`这里只是作为一个**forfirst**，因为它只在列表中写入第一个 SyndicationItem。如您所见，[该列表中有许多项目](http://www.huffingtonpost.com/feeds/verticals/small-business/index.xml)。我的错误在哪里？

只是为了确保我的专辑列表中不仅有一项，我数了一下。

```
<div>

        <%
            var r = System.Xml.XmlReader.Create("http://www.huffingtonpost.com/feeds/verticals/small-business/index.xml");
            System.ServiceModel.Syndication.SyndicationFeed albums = System.ServiceModel.Syndication.SyndicationFeed.Load(r);
            r.Close();
            int i = albums.Items.ToList().Count;

            Response.Write(i); 

          /*  foreach (System.ServiceModel.Syndication.SyndicationItem album in albums.Items)
            {
                Response.Write(album.Title.Text); 
            } */

         %>

    </div> 
```

结果：

![在此处输入图像描述](../Images/fa6400373376d83913817f5691ebe393.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:40:15.903

我想知道您看到的标题输出是否是“huffingtonpost.com 上的小型企业”。如果是，那么它工作正常。列表中有一项包含许多条目。在当前迭代中进行另一次迭代，你应该很高兴。

![赫芬顿邮报的标题列表](../Images/92c6941c71ce678c731936d82a3b1f33.png)

更新我刚刚将您的代码粘贴到表单页面中，它包含所有 15 个结果。

# ruby-on-rails - 在 Rails 中使用角色进行验证

> ID：14390439
> 
> 赞同：3
> 
> 时间：2013-01-18T00:10:05.610
> 
> 标签：ruby-on-rails, rails-activerecord

是否可以使用用于`attr_accessible`and的角色`attr_protected`？我正在尝试设置仅在不是管理员时执行的验证（例如这种[http://launchware.com/articles/whats-new-in-edge-scoped-mass-assignment-in-rails-3- 1](http://launchware.com/articles/whats-new-in-edge-scoped-mass-assignment-in-rails-3-1) )。例如：

```
class User < ActiveRecord::Base
   def validate(record)
     unless # role.admin?
       record.errors[:name] << 'Wrong length' if ...
     end
  end
end

user = User.create({ ... }, role: "admin") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T08:22:28.483

在查看并挖掘源代码后，似乎在创建 Active Record 对象时传入的角色是通过受保护的方法公开的`mass_assignment_role`。因此，有问题的代码可以重写为：

```
class User < ActiveRecord::Base
  def validate(record)
    unless mass_assignment_role.eql? :admin
      record.errors[:name] << 'Wrong length' if ...
    end
  end
end

user = User.create({ ... }, role: "admin") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T02:18:10.790

当然可以是这样的：

```
class User < ActiveRecord::Base
  attr_accessible :role

 validates :record_validation

 def record_validation
   unless self.role == "admin"
     errors.add(:name, "error message") if ..
   end
 end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T04:17:54.360

你可以这样做

```
class User < ActiveRecord::Base
  with_options :if => :is_admin? do |admin|
    admin.validates :password, :length => { :minimum => 10 } #sample validations
    admin.validates :email, :presence => true #sample validations
  end
end 
```

[5.4 分组条件验证](http://guides.rubyonrails.org/active_record_validations_callbacks.html)

# windows - 在 apache 2.2 上加载 mod_wsgi 失败

> ID：14390441
> 
> 赞同：1
> 
> 时间：2013-01-18T00:10:14.800
> 
> 标签：windows, apache, wsgi

全部，

我想将 mod_wsgi 模块添加到我的本地 apache 2.2 服务器。但是当我将“LoadModule module_wsgi modules/mod_wsgi.so”添加到 https.conf 文件中时。apache 服务将无法启动。跟随错误被添加到 error.log 文件中。

> httpd.exe：C:/Apache2.2/conf/httpd.conf 第 129 行的语法错误：在文件 C:/Apache2.2/modules/mod_wsgi.so 中找不到 API 模块结构 `module_wsgi'：没有错误

有关其他信息，以下是我的计算机的设置。

1.  我的电脑运行的是 Windows 7 系统。
2.  我已经安装了 xampp 1.8.1（它内置了 apache 2.4 服务）。我用一个独立的安装包安装了 apache 2.2。并将其绑定到端口 8888。如果我不添加 wsgi 模块。它工作正常。所以，我的电脑有两个 apache 服务实例。
3.  我已经在我的系统中安装了 python 2.6.6 并在我的系统路径中添加了 c:\Python26。

# javascript - 应用程序脚本：在网络应用程序中创建“动态”页面？

> ID：14390442
> 
> 赞同：4
> 
> 时间：2013-01-18T00:10:19.447
> 
> 标签：javascript, google-apps-script

我刚刚开始玩应用程序脚本和谷歌网络应用程序。我可以构建一个基本应用程序，其中设置了一个“静态”（因为需要更好的词）页面，如下所示：

```
function doGet() {
var app = UiApp.createApplication().setTitle('foo');
...set up widgets/etc
return app;
}
...handlers here 
```

据我所知，*在* `doGet`返回之前没有一个处理程序开始运行。这就是我的问题。我需要一个交互式页面，其中页面的内容由对下拉列表的第一个响应决定。换句话说，用户会看到一个下拉列表，他进行选择并点击“提交”，然后我必须根据该选择设置一个列表框。

所以，看起来我不能把我的任何逻辑放进去`doGet`，我基本上必须通过我的事件处理程序链接所有的逻辑：

```
function doGet() {
  ...set up first page and first submit handler
  return app;
}
function firstSubmitHandler(e) {
  .. respond to first submit handler, draw list boxes, set up second list handler
}
function secondSubmitHandler(e) {
  .. respond to second submit handler, yada
} 
```

如果这是正确的，那就太疯狂了。我错过了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:51:50.953

这是您在创建新的“作为 Web 应用程序的脚本”时获得的示例脚本的一个小扩展。我所做的只是让初始单击处理程序向 Ui 添加另一个按钮，然后将另一个单击处理程序带入范围。您可以使用相同的概念来构建动态 UI。

```
// Script-as-app template, extended.
// doGet is exactly as supplied
function doGet() {
  var app = UiApp.createApplication();

  var button = app.createButton('Click Me');
  app.add(button);

  var label = app.createLabel('The button was clicked.')
                 .setId('statusLabel')
                 .setVisible(false);
  app.add(label);

  var handler = app.createServerHandler('myClickHandler');
  handler.addCallbackElement(label);
  button.addClickHandler(handler);

  return app;
}

// myClickHandler now contains a modified copy of doGet.
function myClickHandler(e) {
  //////////// Key concept: The UI app lives on after doGet exits
  var app = UiApp.getActiveApplication();

  var button = app.createButton('Click Me 2');
  app.add(button);

  var label = app.createLabel('The 2 button was clicked.')
                 .setId('statusLabel')
                 .setVisible(false);
  app.add(label);

  var handler = app.createServerHandler('myClickHandler2');
  handler.addCallbackElement(label);
  button.addClickHandler(handler);

  return app;
}

// myClickHandler2 is the original myClickHandler, as supplied
function myClickHandler2(e) {
  var app = UiApp.getActiveApplication();

  var label = app.getElementById('statusLabel');
  label.setVisible(true);

  app.close();
  return app;
} 
```

如果这还不足以让您入门，请查看[如何使用 Google UI Builder 和 Apps 脚本的清晰示例](https://stackoverflow.com/questions/10670927/a-clear-example-of-how-to-use-google-ui-builder-and-apps-script)，以及 Serge 提供的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T14:10:58.773

在任何类型的 webapp 中，你响应来自客户端的请求，然后你就完成了。如果客户端想要交互，它需要发出新的请求。在大多数 webapps 中，这意味着向服务器发出 XHR 请求；应用程序脚本使用处理程序简化了这一点，但概念是相同的。

为什么这么疯狂？这就是世界上每个 webapp 的编写方式——服务器提供初始页面，如果存在交互性，页面会发出新请求并在服务器上运行更多东西。HTTP 被设计为无状态协议，即使有允许客户端和服务器之间持久连接的扩展，它们也很少使用（用于需要即时更新的聊天之类的事情），并且对于您的内容来说会非常缓慢和昂贵正在努力做。

如果你是从常规的桌面编程开始使用 webapps，这个模型一开始可能会很奇怪和不直观，但它对 Apps Script 来说并不是特别的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-05T21:15:46.803

无需重新加载 Google Apps 脚本网页即可检索 HTML 内容并将其动态注入页面。

设置空元素以接收新的页面内容

```
 <section id="ChgViewSection">
      <div id="PageOne"></div>
      <div id="PageTwo"></div>
      <div id="PageThree"></div>
      <div id="PageFour"></div>
      <div id="PageFive"></div> 
  </section> 
```

最初将大多数元素设置为隐藏，`style="display:none"`

```
 <section id="ChgViewSection">
      <div id="PageOne" style="display:block"></div>
      <div id="PageTwo" style="display:none"></div>
      <div id="PageThree" style="display:none"></div>
      <div id="PageFour" style="display:none"></div>
      <div id="PageFive" style="display:none"></div>    
    </div>
  </section> 
```

将一个元素设置为`style="display:block"`。那将是最初加载的页面。

创建用户界面以更改页面、菜单或选项卡。

```
<div id="tabs-nested-left">
  <div class="cb" id="tabSignIn" onclick="mainStart('SignInBody', 'SignIn')">Sign In</div>
  <div class="cb" id="tabInput" onclick="mainStart('InputBlock', 'InputForm')">Input</div>
  <div class="cb" id="tabReg" onclick="mainStart('RegisterBlock', 'Register')">Registration</div>
  <div class="cb" id="tabRegExpl" onclick="mainStart('Explain', 'Explain')">Registration Explanation</div>
  <div class="cb" id="tabContact" onclick="mainStart('ContactUs', 'Contact')">Security</div>
</div> 
```

写一个`<script>`用于处理`onclick`事件。

```
<script>

function mainStart(ElmtToGoTo, FileToGet) {
   var currntShown = 'SignInBody'; //Create variable and set initial value
   //Hide the currently shown element first
   document.getElementById(currntShown).style.display = 'none';
   //
   currntShown = ElmtToGoTo;
   //display the element that will be shown.  No content is injected yet
   document.getElementById(ElmtToGoTo).style.display = 'block';

   var el = document.getElementById(ElmtToGoTo);
   // If element is empty get HTML and inject
   if (el.childNodes.length === 0) {
      //alert("it's empty!");
    //Run back end google .gs code to get new content
    google.script.run.withFailureHandler(onFailure)
      .withSuccessHandler(onGotHTML)
      .include(FileToGet);
  };

};

<script> 
```

向您的 HTML 脚本添加失败和成功处理程序：

```
function onGotHTML(daHTML) {
  //alert("Got HTML File!");
  document.getElementById(currntShown).innerHTML=daHTML;
  };

function onFailure(error) {
  alert("on failure ran:" + error.message);
}; 
```

编写服务器端`.gs`代码：

```
function include(filename) {
  return HtmlService.createHtmlOutputFromFile(filename)
   .getContent(); 
}; 
```

单击选项卡时，当前显示的内容`<div>`将被隐藏，然后`<div>`显示要显示的内容，但尚无内容。如果`<div>`已经有内容，什么也不做。如果`<div>`为空，则运行 a`google.script`并从服务器获取内容。内容返回给客户端并注入到`<div>`成功处理程序`onGotHTML`和`document.getElementById(currntShown).innerHTML=daHTML;`

其中大部分是 DOM 操作和样式更改。但是使之成为可能的是从服务器检索文件内容。您需要与内容一起保存的文件才能注入`<div>`元素。当用户单击菜单项或选项卡时从服务器检索 HTML 内容可以避免预先加载所有内容。一个问题是 CSS 样式数据不能在以后添加，除非它`inline`（已经在标签中）。因此，您必须在页面首次加载时加载所有 CSS 样式文件，或者将样式设置放入元素中。您可以在页面加载后注入 HTML，并在不重新加载页面的情况下显示它，但您不能在页面加载后包含 CSS 文件并显示新样式。

我可能遗漏了一些东西，比如用于样式的 CSS 文件，但代码；HTML/样式；并显示总体策略。您可以像这样构建动态单页应用程序。

# navigation - Sublime Text 2：禁用文档预览

> ID：14390444
> 
> 赞同：51
> 
> 时间：2013-01-18T00:10:54.663
> 
> 标签：navigation, sublimetext2

我尝试搜索这个，但 SublimeText 中有一个不同的功能，人们称之为“预览”，所以我找不到任何相关信息。

当文档打开时，如何禁用 SublimeText2 中显示的预览导航图像？另外，这个功能叫什么？

![在此处输入图像描述](../Images/696b3befab691dd68aa60a89f81a370f.png)

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2013-01-18T00:11:42.777

这在 Sublime Text 中称为“小地图”。要禁用它，请转到`View -> Hide Minimap`菜单中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-11T15:04:24.890

如果你想要一个键盘快捷键来切换它，你可以通过添加这个来创建一个：

```
{ "keys": ["ctrl+k", "ctrl+m"], "command": "toggle_minimap" } 
```

...到你的`Preferences -> Key Bindings - User`文件。这会将其设置为 Ctrl+K 后跟 Ctrl+M 的顺序，我之所以选择它只是因为它类似于切换侧边栏的快捷方式（Ctrl+K、Ctrl+B），但您可以将其设置为您喜欢的任何内容。

# c# - 使用 EF 映射“仅插入”表

> ID：14390450
> 
> 赞同：1
> 
> 时间：2013-01-18T00:11:29.117
> 
> 标签：c#, entity-framework, entity-framework-5

我想保存对我的`Comment`实体/表所做的所有更改的历史记录。

我的方法：
- 使用[“仅插入”表](https://stackoverflow.com/a/1324794/1711500)
- 使用[复合 PK](https://stackoverflow.com/a/5466519/1711500)，由 db 生成的 int 键和 db 生成的 DateTime 戳组成 -在实体上
使用[AsNoTracking](https://stackoverflow.com/a/10389861/1711500)

但是，假设它是该实体的导航属性：

```
public Article { 
  public int ID { get; set; }
  public string Title { get; set; }
  public string Content { get; set; }
  public virtual Comment Comments { get; set; }
} 
```

因此，如果我调用`articleFoo.Comments`它将获取*所有*实体，这意味着所有修订。我只想得到“最新”的。我将如何实现这一目标？

**- -更新 - -**

1.  如果我使用 Linq 过滤，那么我将如何处理它，或者
    如果我使用 sprocs 选项，那么我将如何做到这一点？
2.  我的假设不完整——我必须生成复合键，因为对于两个修订实体，它们的 ID 必须相等，但它们的更新日期时间必须不同。所以我不能让数据库自动生成这些，或者我可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:01:08.363

您可以通过为`Comments`. 这将使用表触发器在字段级别跟踪所有插入、修改和删除。我四处寻找一种工具来使它更容易，我在 CodeProject 上找到了一个工具[-](http://www.codeproject.com/Articles/21068/Audit-Trail-Generator-for-Microsoft-SQL)但如果你搜索更长的时间，你会找到更好的东西。

如果这不能让你的船漂浮，那么......

通过 EF，您可以在提交之前检查新的、更新的或删除的评论记录，并在提交之前添加历史信息。

例如，您可以使用`ObjectContext.SavingChanges`来检查并记录更改，然后将您自己的历史记录添加到上下文中。

在我的示例中，我的`DbContext`实例是`StackOverflowEntities`我在基础`ObjectContext.SaveChanges`事件上添加和事件处理程序的地方

```
 // SavingChanges event handler. 
    private void context_SavingChanges(object sender, EventArgs e) {

        ObjectContext objectContext = sender as ObjectContext;

        if (objectContext != null) {
            foreach (ObjectStateEntry entry in objectContext.ObjectStateManager
                            .GetObjectStateEntries(EntityState.Added | EntityState.Modified | EntityState.Deleted)
                            .Where(et => et.Entity.GetType().Equals(typeof(Comment)))) {

                Comment comment = entry.Entity as Comment;
                Comment_Audit audit = new Comment_Audit {
                    BodyText = comment.BodyText,
                    Commentor = comment.Commentor,
                    ..
                    ..
                    ChangedAt = DateTime.Now,
                    ChangeType = entry.State.ToString()

                };

                StackOverflowEntities.Set<Comment_Audit>().Add(audit);

            }
        }
    } 
```

现在，每次`Comment`更改 a 时，您都会添加一条审计记录以与它一起保存。

# objective-c - 如何让 iTunes 跳到曲目的特定时间？操作系统

> ID：14390451
> 
> 赞同：1
> 
> 时间：2013-01-18T00:11:31.920
> 
> 标签：objective-c, macos, cocoa, itunes

我`iTunes.h`用来控制和接收来自 iTunes 的信息，但我想做的是能够让 iTunes 跳到曲目的特定时间（以秒为单位，或类似的时间）。
我找到了这些方法 -->`[iTunes fastForward]`但是`[iTunes rewind]`使用这些命令我无法指定确切的时间。
关于如何做的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:10:45.050

您正在寻找“玩家位置”。在 AppleScript 中：

```
tell application "iTunes"
    get player position
    set player position to 10
end tell 
```

翻译为：

```
NSLog(@"%ld",[iTunes playerPosition]);
[iTunes setPlayerPosition:10]; 
```

# javascript - 如何将动态图像加载到网页中？

> ID：14390457
> 
> 赞同：4
> 
> 时间：2013-01-18T00:12:02.997
> 
> 标签：javascript, html

我有一个网页，我想显示一个图表。我希望能够使用 DOT 语言动态指定图形。因此，我制作了一个页面，该页面采用 DOT 表达式作为查询参数并返回图像内容。现在我可以简单地添加一个`img`带有适当`src 的标签。

```
<img src="/dot/png/graph{a--b}"> 
```

但是，某些服务器在处理长 URL 时会遇到问题。是否可以通过 POST 请求获取图像并`img`使用 JavaScript 将其显示在标签中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:35:06.060

我唯一能想到的是让服务器返回图像数据的 base64 编码字符串，您可以将其包含在这样的`img`标签中：

```
<img src="data:image/png;base64,BASE64STRINGGOESHERE"> 
```

请注意，IE7 及以下版本不支持[数据 URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)，并且 IE8 仅允许 URI 中包含 32KB 的数据。

# python - 如何为这个 A* 程序构建邻接表

> ID：14390458
> 
> 赞同：2
> 
> 时间：2013-01-18T00:12:09.237
> 
> 标签：python, path-finding, a-star

我试图了解 A* 寻路算法，以及如何在 python 程序中实现它。我发现[这个网站](http://scriptogr.am/jdp/post/pathfinding-with-python-graphs-and-a-star)很好地解释了算法本身的工作原理，并提供了一些示例代码。

这是我卡住的地方：

```
def make_graph(mapinfo):

nodes = [[AStarGridNode(x, y) for y in range(mapinfo.height)] for x in range(mapinfo.width)]
graph = {}
for x, y in product(range(mapinfo.width), range(mapinfo.height)):
    node = nodes[x][y]
    graph[node] = []
    for i, j in product([-1, 0, 1], [-1, 0, 1]):
        if not (0 <= x + i < mapinfo.width): continue
        if not (0 <= y + j < mapinfo.height): continue
        graph[nodes[x][y]].append(nodes[x+i][y+j])
return graph, nodes

graph, nodes = make_graph({"width": 8, "height": 8})
paths = AStarGrid(graph)
start, end = nodes[1][1], nodes[5][7]
path = paths.search(start, end)
if path is None:
    print "No path found"
else:
    print "Path found:", path 
```

我不明白“ **mapinfo** ”对象的外观。我通过用一些数字替换 mapinfo 变量来管理程序的工作，但无法弄清楚整个列表将如何工作，特别是如果我们想要包括墙壁。你能提供一些澄清/例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:56:23.010

该`mapinfo`对象（如给定代码中所示）是传递给`make_graph()`函数的字典参数，用于存储要搜索的网格的尺寸（宽度和高度）。

您可以在函数调用之前定义它，然后将其传递给函数，例如：

```
mapinfo = {"width": 8, "height": 8}
graph, nodes = make_graph(mapinfo) 
```

问题是该`make_graph()`函数试图直接访问`width`和`height`中的值`mapinfo`（例如 by `mapinfo.height`），这会导致异常`AttributeError: 'dict' object has no attribute 'height'`。

我能想到的两个选择是：

*   更改语句`make_graph()`以通过键而不是属性访问字典元素，方法是将 all 更改`mapinfo.height`为`mapinfo['height']`宽度并类似地更改），或
*   使用您需要的属性创建一个 MapInfo 类，并将它的实例传递给`make_graph()`函数而不是字典。

    ```
    class MapInfo(object):
        def __init__(self, width, height):
            self.width = width
            self.height = height

    # ...

    mapinfo = MapInfo(width=8, height=8)
    graph, nodes = make_graph(mapinfo) 
    ```

如果要包括无法通行的地形（例如墙壁），则必须做更多的事情。

`MapInfo`也许通过给它另一个属性来扩展类：

```
def __init__(self, width, height, impassable=[]):
    """Create a MapInfo object representing the search area and obstacles.

        Args:
            width: Integer representing the width of the area
            height: Integer representing the height of the area
            impassable: List of (x, y) tuples representing impassable obstacles.
    """
    self.width = width
    self.height = height
    self.impassable = impassable 
```

`make_graph()`接下来，如果目标区域不是不可通过的，您需要修改该函数以仅在两个网格空间之间添加边缘。

```
for i, j in product([-1, 0, 1], [-1, 0, 1]):
    # Check that we are inside the grid area.
    if not (0 <= x + i < mapinfo.width): continue
    if not (0 <= y + j < mapinfo.height): continue
    # Check if the target area is impassable.
    if (x + i, y + j) in mapinfo.impassable: continue
    # All looks good. Add target space as reachable from current (x, y) space.
    graph[nodes[x][y]].append(nodes[x+i][y+j]) 
```

然后，您将根据需要使用其他不可通过的区域修改您的`mapinfo`实例定义：

```
impassable = [(3, 3), (3, 4), (3, 5)]  # modify to your needs
mapinfo = MapInfo(width=8, height=8, impassable=impassable) 
```

# google-chrome - Chrome 24 css3 转换 3D 在悬停时闪烁

> ID：14390461
> 
> 赞同：2
> 
> 时间：2013-01-18T00:12:33.277
> 
> 标签：google-chrome, css, hover, transform, translate3d

我在 chrome 24 上有一个奇怪的错误。比长描述更好，你可以看看这里

```
.card {
  width:270px;
  height:180px;
  background:lightblue;
  border:1px solid black;
}

.card:hover {
  -webkit-transform:perspective(2000) rotate3d(0, 40, 0, 20deg);
  -moz-transform:perspective(2000) rotate3d(0, 40, 0, 20deg);
  -ms-transform:perspective(2000) rotate3d(0, 40, 0, 20deg);
  -o-transform:perspective(2000) rotate3d(0, 40, 0, 20deg);
  transform:perspective(2000) rotate3d(0, 40, 0, 20deg);
} 
```

[http://jsfiddle.net/xMfZw/3/](http://jsfiddle.net/xMfZw/3/)

正如您在左侧看到的那样，我可以毫无问题地悬停，但在 le 右侧它闪烁，因为我不再悬停 div。

有什么建议吗？

它在 IE10、Firefox 上运行良好，但在 Opera 上不运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T00:23:56.193

发生的情况是，当您旋转它时，它的右半部分位于它最初所在的平面后面，因此悬停不再起作用。将整个事物向前平移元素宽度的一半（甚至更少，一半是当您围绕垂直轴旋转 90 度时）将解决问题。

```
-webkit-transform: translateZ(135px) perspective(2000) rotate3d(0, 40, 0, 20deg); 
```

[**工作小提琴**](http://jsfiddle.net/thebabydino/xMfZw/4/)

此外，您不需要`-ms-transform`. IE10 支持无前缀变换，而 IE9 不支持 3D 变换。

Opera 根本不支持 3D 变换。所以你也不需要`-o-transform`。

至于`-moz-transform`，现在只有 Firefox for Android 才需要。

见[**caniuse.com**](http://caniuse.com/#feat=transforms3d)

# javascript - 滚动上的 jQuery 棒 div

> ID：14390464
> 
> 赞同：2
> 
> 时间：2013-01-18T00:12:44.120
> 
> 标签：javascript, jquery, css

我有一个顶部固定的 div，然后是一个包含两个 div 内部（左和右）的主框架。我想在滚动的顶部栏下方制作正确的 div。

我已经把我在这里的东西放了：http: [//jsfiddle.net/mhD9Y/2/](http://jsfiddle.net/mhD9Y/2/)

```
$(document).ready(function(){

var window_top = 41 - $(window).scrollTop();
  var div_top = $('#stop_scroll').offset().top;
  if (window_top > div_top)
    $('#right').addClass('stick');
  else
    $('#right').removeClass('stick');

});

 .stick {
        position: fixed !important;
        top: 41px !important;z-index: 5 !important;    -webkit-transition: all 1s ease;
    -moz-transition: all 1s ease;
    -o-transition: all 1s ease;
    transition: all 1s ease;
    } 
```

问题是脚本根本没有启动。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T00:17:56.753

将您的代码与窗口滚动一起放置。

```
$(document).ready(function(){
    $(window).scroll(function(){
      var window_top = $(window).scrollTop() - 41;
      var div_top = $('.right').offset().top;
      if (window_top > 41) {
        if (!$('.right').is('.stick')) {
            $('.right').addClass('stick');
         }
      }  else
           $('.right').removeClass('stick');
    });
}); 
```

要么将 id="right" 更改为 class="right"

或者

改变你的CSS

.stick 并在每个属性的末尾添加 !important。

[jsfiddle 上的演示](http://jsfiddle.net/mhD9Y/12/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:46:08.207

脚本：

```
 $(document).ready(function(){
      $(window).scroll(function(){
        var window_top = $(window).scrollTop() - 41;
        var div_top = $('#stop_scroll').offset().top;
        console.log(window_top, div_top);
        if (window_top > div_top) {
             $('#right').addClass('stick');
        } else {
             $('#right').removeClass('stick');
        }
      });
    }); 
```

CSS：

```
 .stick {
        position: fixed !important;
        top: 41px !important;
    } 
```

# android - 使用 jquerymobile 和 phonegap 存储数据

> ID：14390466
> 
> 赞同：0
> 
> 时间：2013-01-18T00:12:56.807
> 
> 标签：android, cordova, jquery-mobile

我目前正在创建可以使用 jquerymobile 和 phonegap 保存用户设置的 Web 应用程序。但我不知道是否可以保存关闭应用程序后不会重置的用户设置？

谢谢你，对不起我的英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:59:08.023

你可以使用LocalStorage，对吧？我认为IOS和Android都支持它。

[http://www.w3schools.com/html/html5_webstorage.asp](http://www.w3schools.com/html/html5_webstorage.asp)

# ruby-on-rails - 运行 bundle exec rake db:migrate 时“rake aborted！无法连接到主节点”

> ID：14390467
> 
> 赞同：0
> 
> 时间：2013-01-18T00:13:08.653
> 
> 标签：ruby-on-rails, ruby, gem

我在运行时遇到了一些问题`bundle exec rake db:migrate`。终端打印出以下内容：

```
 [RailsAdmin] RailsAdmin initialization disabled by default. Pass SKIP_RAILS_ADMIN_INITIALIZER=false if you need it.
rake aborted!
Failed to connect to a master node at 127.0.0.1:9100
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/mongo-1.6.4/lib/mongo/connection.rb:420:in `connect'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/mongo-1.6.4/lib/mongo/connection.rb:594:in `setup'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/mongo-1.6.4/lib/mongo/connection.rb:130:in `initialize'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/mongo_mapper-0.12.0/lib/mongo_mapper/connection.rb:79:in `new'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/mongo_mapper-0.12.0/lib/mongo_mapper/connection.rb:79:in `connect'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/mongo_mapper-0.12.0/lib/mongo_mapper/connection.rb:89:in `setup'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/mongo_mapper-0.12.0/lib/mongo_mapper/railtie.rb:28:in `block in <class:Railtie>'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `instance_exec'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `run'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/railties-3.2.11/lib/rails/initializable.rb:55:in `block in run_initializers'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `each'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `run_initializers'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/railties-3.2.11/lib/rails/application.rb:136:in `initialize!'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in `method_missing'
/Users/User/app/config/environment.rb:5:in `<top (required)>'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `block in require'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in `load_dependency'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require'
/Users/User.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/railties-3.2.11/lib/rails/application.rb:103:in `require_environment!'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/gems/railties-3.2.11/lib/rails/application.rb:297:in `block (2 levels) in initialize_tasks'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/bin/ruby_noexec_wrapper:14:in `eval'
/Users/User/.rvm/gems/ruby-1.9.3-p327@rails3tutorial2ndEd/bin/ruby_noexec_wrapper:14:in `<main>'
Tasks: TOP => db:migrate => environment
(See full trace by running task with --trace) 
```

澄清一下：在运行 bundle exec rake db:migrate 之前，我做了 bundle install ，一切正常。任何人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T02:10:25.510

你的数据库在运行吗？此错误消息表明它无法连接到您的数据库。

# java - 端点没有适配器；您的端点是用@Endpoint 注释的，还是实现了受支持的接口，如 MessageHandler 或 PayloadEndpoint？

> ID：14390474
> 
> 赞同：30
> 
> 时间：2013-01-18T00:13:38.177
> 
> 标签：java, jms, spring-ws

我正在为带有 JMS 的 Spring-WS 示例而苦苦挣扎。我按照 Spring 的建议设置了 Spring-WS 和 JMS 布线。但我不断收到以下错误。我不知道如何绕过这个问题，任何帮助将不胜感激：

```
[org.springframework.ws.soap.server.endpoint.SoapFaultAnnotationExceptionResolver] - 
Resolving exception from endpoint 
[org.springframework.ws.samples.mtom.ws.ImageRepositoryEndpoint@1c8b0b1]: 
java.lang.IllegalStateException: No adapter for endpoint 
[org.springframework.ws.samples.mtom.ws.ImageRepositoryEndpoint@1c8b0b1]: 
Is your endpoint annotated with @Endpoint, or does it implement a supported interface like MessageHandler or PayloadEndpoint?

[org.springframework.ws.soap.server.endpoint.SimpleSoapExceptionResolver] - Resolving exception from endpoint
[org.springframework.ws.samples.mtom.ws.ImageRepositoryEndpoint@1c8b0b1]: 
java.lang.IllegalStateException: No adapter for endpoint [org.springframework.ws.samples.mtom.ws.ImageRepositoryEndpoint@1c8b0b1]: 
Is your endpoint annotated with @Endpoint, or does it implement a supported interface like MessageHandler or PayloadEndpoint?

[org.springframework.ws.soap.server.SoapMessageDispatcher] - 
Endpoint invocation resulted in exception - responding with Fault
java.lang.IllegalStateException: No adapter for endpoint  [org.springframework.ws.samples.mtom.ws.ImageRepositoryEndpoint@1c8b0b1]: 
Is your endpoint annotated with @Endpoint, or does it implement a supported interface like MessageHandler or PayloadEndpoint? 
```

我的 Web 服务接线是

```
<bean id="imageRepository"
    class="org.springframework.ws.samples.mtom.service.StubImageRepository" />

<!-- JMS WIRING TO WS START -->
<bean id="messageFactory" class="org.springframework.ws.soap.saaj.SaajSoapMessageFactory" />

<bean id="messageDispatcher"
    class="org.springframework.ws.soap.server.SoapMessageDispatcher">
    <property name="endpointMappings">
        <bean
            class="org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping">
            <property name="defaultEndpoint">
                <bean
                    class="org.springframework.ws.samples.mtom.ws.ImageRepositoryEndpoint">
                    <constructor-arg ref="imageRepository" />
                </bean>
            </property>
        </bean>
    </property>
</bean>

<bean
    class="org.springframework.jms.listener.DefaultMessageListenerContainer">
    <property name="connectionFactory" ref="jmsConnectionFactory" />
    <property name="destinationName" value="WS.JMS.EXAMPLE.V1.IMAGE.REPO.REQUEST" />
    <property name="messageListener">
        <bean
            class="org.springframework.ws.transport.jms.WebServiceMessageListener">
            <property name="messageFactory" ref="messageFactory" />
            <property name="messageReceiver" ref="messageDispatcher" />
        </bean>
    </property>
</bean> 
```

我的终点代码是

```
@PayloadRoot(localPart = "StoreImageRequest", namespace = "http://www.springframework.org/spring-ws/samples/mtom")
@ResponsePayload
public String  store(@RequestPayload JAXBElement<Image> requestElement) throws IOException {
    Image request = requestElement.getValue();
    return imageRepository.storeImage(request.getName());
} 
```

我的架构是

```
<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.springframework.org/spring-ws/samples/mtom"
    xmlns:tns="http://www.springframework.org/spring-ws/samples/mtom"
    xmlns:xmime="http://www.w3.org/2005/05/xmlmime" elementFormDefault="qualified">
    <element name="StoreImageRequest" type="tns:Image"/>
    <element name="LoadImageRequest" type="string"/>
    <element name="LoadImageResponse" type="tns:Image"/>
    <complexType name="Image">
        <sequence>
            <element name="name" type="string"/>
        </sequence>
    </complexType>
</schema> 
```

我的客户请求是

```
<ns2:StoreImageRequest xmlns:ns2="http://www.springframework.org/spring-ws/samples/mtom"><ns2:name>spring-ws-logo.png</ns2:name></ns2:StoreImageRequest> 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2014-03-06T14:54:03.883

我有一个类似的错误信息。我的问题出在我从 XSD 生成的请求和响应类中。它错过了@XMLRootElement 注释。这导致操作描述（在 WSDL 中）和已实现方法的描述（在 Endpoint 中）不匹配。**将 JAXBElement 添加到我的端点方法解决了我的问题。**

```
import javax.xml.bind.JAXBElement;

@PayloadRoot(namespace = "http://foo.bar/books", localPart = "GetBook")
@ResponsePayload
public JAXBElement<MyReponse> getBook(@RequestPayload JAXBElement<MyRequest> myRequest) {
    ... 
```

有关更多详细信息，请参阅此博客：[spring-ws：端点没有适配器](https://jbossadventure.wordpress.com/2013/04/16/spring-ws-no-adapter-for-endpoint/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-03-21T02:12:12.880

我正在使用 WSDL 文件并按照以下方式进行操作，然后它就起作用了。

```
 @PayloadRoot(namespace = "http://www.myservice/v1.0/query", localPart = "queryRequest")
  @ResponsePayload
  public JAXBElement<QueryResponse> queryAddrLocation(@RequestPayload JAXBElement<QueryRequest> queryRequest) {
    System.out.println("Welcome to " + queryRequest);
    return createJaxbElement(new QueryResponse(), QueryResponse.class);
  }

  private <T> JAXBElement<T> createJaxbElement(T object, Class<T> clazz) {
    return new JAXBElement<>(new QName(clazz.getSimpleName()), clazz, object);
  } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-11-27T13:24:04.430

我有一个类似的错误。问题是从 XSD/WSDL 生成的请求和响应错过了 @XMLRootElement 注释。通过将 JAXBElement 添加到端点解决了这个问题。

```
private static final String NAMESPACE_URI = "<targetNamespace>";

@Autowired
Service   service;

@PayloadRoot ( namespace = Endpoint.NAMESPACE_URI, localPart = "name" )
@ResponsePayload
public JAXBElement < Response > Create ( @RequestPayload JAXBElement < Request> request ) throws Exception
{
ObjectFactory factory = new ObjectFactory ( );
Response response = new Response ( );
Request req = request.getValue ( );

response  = this.service.call( req);

return factory.createResponse ( response );
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T09:55:23.667

我不确定您的完整 Endpoint 的外观如何，但该类应该使用注释`@Endpoint`或者它应该实现`MessageHandler`or `PayloadEndpoint`。

您可以使用的另一件事是方法签名。Spring-WS 的端点映射非常智能：它尝试将方法签名中的输入和输出类与 WSDL 文件进行映射。你确定一个字符串是@ResponsePayLoad，而不是一个`StoreImageResponse`？

例如，这是我的一个端点的方法签名

```
@PayloadRoot(
    localPart = "GetHiredCandidatesRequest", 
    namespace = DEFAULT_NAMESPACE
)
@ResponsePayload
public GetHiredCandidatesResponse getCandidates (
    @RequestPayload GetHiredCandidatesRequest getCandidate,
    MessageContext messageContext) {
    ...
} 
```

在我的 WSDL 中定义如下：

```
<wsdl:operation name="GetHiredCandidates">
    <wsdl:input message="tns:GetHiredCandidatesRequest" name="GetHiredCandidatesRequest"></wsdl:input>
    <wsdl:output message="tns:GetHiredCandidatesResponse" name="GetHiredCandidatesResponse"></wsdl:output>
</wsdl:operation> 
```

你看到它是如何映射的吗？也许您在签名中遗漏了类似的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-10-18T14:24:40.047

从 SOAPUI 调用此方法时有效：

```
@PayloadRoot(namespace = NAMESPACE_URI, localPart = "getOrderDetail")
public @ResponsePayload JAXBElement<OrderDetailResponse> getOrderDetail(@RequestPayload JAXBElement<String> customerId, @RequestPayload JAXBElement<String> promoCode) 
```

在下面的方法中，customerStatusRequest 中的值是 null，即使我从 SOAPUI 填充它们。

```
@PayloadRoot(namespace = NAMESPACE_URI, localPart = "getCustomerStatus")
public @ResponsePayload
JAXBElement<CustomerStatusResponse> getCustomerStatus(@RequestPayload JAXBElement<CustomerStatusRequest> customerStatusRequest) 
```

（CustomerStatusRequest 实现 Serializable）

看来字符串参数值正在通过调用。但不是自定义类。我以这种方式注释了 CustomerStatusRequest 类：

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "CustomerStatusRequest", propOrder = {
    "customerId",
    "gender",
    "dob",
    "lastName",
    "sourceSystemId"
},namespace="http://www.mycompany.com/webservices") 
```

以及 CustomerStatusRequest 中的每个字段：

```
@XmlElement(name = "customerId", required = true, nillable = true) 
```

该方法被调用，但 customerId 等的值仍然为 null。自定义类是否需要额外的注释？

- 谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-14T10:12:47.473

首先，根据指南，应该有一个**Endpoint**类

```
@Endpoint
public class EmpEndpoint {

    @Autowired
    private EmpService empService;

    //This is like @RequestMapping of Spring MVC    
    @PayloadRoot(localPart = "EmpServiceRequest", namespace = "http://www.example.org/")
    @ResponsePayload
    public EmpServiceResponse getemployeeDetails(@RequestPayload EmpServiceRequest request) {
        EmpServiceResponse response = new ObjectFactory().createEmpServiceResponse();
        List<Employee> l = empService.getemployeeDetails(request.getName());
        response.setName(l.get(0).getName());
        response.setEmail(l.get(0).getEmail());
        return response;
    }
} 
```

还有一个**服务**及其 **实现**类，它将具有**PayloadRoot**和其他**注释（请求和响应）**

并将其放在您的 spring-servlet.xml 中

```
 <!-- To detect @Endpoint -->
<sws:annotation-driven/>

<!-- To detect @Service, @Component etc -->
<context:component-scan base-package="your package for eg com.employee" /> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-06-05T21:03:41.817

我有同样的错误，但只运行我的 Spring Web Service 集成测试。

问题是，`Jaxb2Marshaller`如果与`Jaxb2Marshaller`测试内部相比，我设置了不同的配置。我没有为应用程序和测试使用相同的 Bean。

我`Jaxb2Marshaller`正在运行的应用程序是：

```
private Jaxb2Marshaller marshaller() {
    Jaxb2Marshaller marshaller = new Jaxb2Marshaller();
    marshaller.setContextPath("com.company.application");
    marshaller.setMtomEnabled(true);
    return marshaller;
} 
```

但在我的测试中，我使用的是：

```
@Before
public void init() throws Exception {
    marshaller.setPackagesToScan(ClassUtils.getPackageName(Order.class));
    marshaller.afterPropertiesSet();
} 
```

为了使测试工作，我刚刚定义了两个缺失的属性：

```
@Before
public void init() throws Exception {
    marshaller.setPackagesToScan(ClassUtils.getPackageName(Order.class));
    marshaller.afterPropertiesSet();
    marshaller.setContextPath("com.company.application");
    marshaller.setMtomEnabled(true);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-23T00:00:09.460

我在 beanXml 文件中添加了属性

这是工作。

```
<bean id="marshaller"
    class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
     <property name="supportJaxbElementClass" value = "true"/>
    <property name="contextPaths">
        <list>
            <value>com.xxx</value>
        </list>
    </property>
    <property name="schemas">
        <list>
            <value>classpath:/xsd/service.xsd</value>
        </list>
    </property>
</bean> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-12T18:51:10.197

同样的问题，但在我的情况下是因为我忘记放置注释`@ResponsePayload`和`@RequestPayload`处理函数。只需检查一下！这可能就是它所需要的。

# java - 番石榴谷歌代码笛卡尔

> ID：14390475
> 
> 赞同：0
> 
> 时间：2013-01-18T00:14:02.147
> 
> 标签：java, guava, cartesian

无论如何要对 15 个大小为 5 的整数集进行笛卡尔积吗？似乎图书馆抛出异常错误：笛卡尔积太大！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-23T08:39:46.633

[错误消息](https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/CartesianList.java#L59)解释了该问题：

```
IllegalArgumentException: Cartesian product too large; must have size at most Integer.MAX_VALUE 
```

15 个 5 长度集合的笛卡尔积产生 5^15 个不同的结果，即 30,517,578,125。因为 a`Set`不能有一个`size()`大于`Integer.MAX_VALUE`它不可能（正确）返回这么大的集合。正如 Louis Wasserman 所指出的，您不太可能真的想要对如此大量的结果进行操作，因为无论您如何构建 300 亿个列表都是昂贵的。您最好的选择可能是重新检查问题，看看是否有一些解决方案可以避免构建如此多的结果。

如果您实际上不需要`Set`语义，您当然可以使用嵌套的 for 循环一一简单地构造所有笛卡尔集（如[文档](https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/Sets.html#cartesianProduct-java.util.List-)中所述）：

```
for (B b0 : sets.get(0)) {
  for (B b1 : sets.get(1)) {
    ...
    ImmutableList<B> tuple = ImmutableList.of(b0, b1, ...);
    // operate on tuple
  }
} 
```

但是当然不要尝试将它们全部存储在一个集合中 - 当您超过集合的最大大小（或您的堆空间）时，您会收到错误消息。

# c# - 在 WinRT 上用 C# 从 MP3 流中绘制波形

> ID：14390476
> 
> 赞同：3
> 
> 时间：2013-01-18T00:14:08.657
> 
> 标签：c#, .net, windows-runtime, mp3, waveform

我正在开发一个 Windows RT 应用程序，它使用 MediaCapture.StartRecordToStreamAsync() 来捕获 MP3 格式（16 位、44.1 KHz、128Kbps）的音频流。我想知道是否有人知道如何有效地将流转换为可以绘制到画布上的浮点数组。

我已经找到了一种使用一些互操作调用将 MP3 转换为 PCM 的方法，然后读取波形以绘制波形。但我想我正在寻找一种从直接生成 MediaCapture 的流中绘制波形的方法。

任何建议将不胜感激！

# php - PHP OOP 会话对象 - 不会在没有序列化的情况下持续存在

> ID：14390483
> 
> 赞同：0
> 
> 时间：2013-01-18T00:15:12.083
> 
> 标签：php

我试图弄清楚为什么下面的代码不会跨页面保留我的 $_SESSION['objSession'] 对象，除非我将序列化/反序列化保留在下面。我厌倦了手动序列化/反序列化以在会话中进行对象更改，人们一直说我不应该这样做，但我确实看到其他关于会话对象在没有它的情况下不会在网络上持续存在的抱怨，包括堆栈上的...... PHP 5.3 阿帕奇 2.2 Windows 2008。

```
<?php require_once("/php/php_clsSession.php");?>
<?php session_start(); ?>
<?php
    // Session Object Create/Log
    $objSession = new clsSession;
    if ( !(isset($_SESSION['objSession']) )) {
        // This line will populate some properties in the obj
        // like Session_ID and Create_dt
        $objSession->CreateSession(session_id(),$_SERVER);
    }
    else {
        // this code will only run if the session is already 
        // set
        $objSession = unserialize($_SESSION['objSession']);
        $objSession->UpdateSession(session_id(),$_SERVER);
    }
    // Update Session Object
    $_SESSION['objSession'] = serialize($objSession);
    unset($objSession);
?> 
```

---- clsSession 在此行下方...您可以忽略数据库包含，因为代码在不使用数据库功能的情况下存在相同的问题，并且无论如何我暂时对数据库功能进行了注释...。

```
<?php
   // -----------------------------------------------------------------
   // Program Type: Class
   // Program Name: clsSession
   // Program Date: 01/08/2012 Programmer: Tim Wiley
   // Description:  Standard class for session creation/update
   // -----------------------------------------------------------------
  class clsSession {

       // Properties
       public $Session_Id = null;
       public $Creation_Dt = null;
       public $Action_Dt = null;
       public $Session_IP_Address = null;
       public $Browser_Type = null;
       public $Display_Resolution = null;
       public $Is_Https_Ind = null;
       public $Is_Logged_In_Ind = 0;
       public $User_Key = null;
       public $User_Id = null;
       public $Email_Address = null;
       public $Request_Method = null;
       public $Page_Requested = null;
       public $Page_Request_Params = null;
       public $Page_Action = null;
       public $Login_Attempts = 0;
       public $Max_Login_Attempts = 3;

     private function UpdateSessionClassData (&$xSessionId = null, &$xSessionObj = null, &$xPageAction = "N/A" ) {
        $this->Session_Id = &$xSessionId;
        $this->Action_Dt = date( 'Y-m-d H:i:s', time( ));
        $this->Session_IP_Address = substr(trim(&$xSessionObj['REMOTE_ADDR']),0,24);
        $this->Browser_Type = substr(trim(&$xSessionObj['HTTP_USER_AGENT']),0,140);
        $this->Request_Method = substr(trim(&$xSessionObj['REQUEST_METHOD']),0,24);
        $this->Page_Requested = substr(trim(&$xSessionObj['SCRIPT_NAME']),0,140);
        $this->Page_Request_Params = substr(trim(&$xSessionObj['QUERY_STRING']),0,140);
        $this->Is_Https_Ind = &$xSessionObj['SERVER_PORT'] == 443 ? 1 : 0;
        if (is_null($this->Display_Resolution)) {
            require_once('/javascript/js_SaveScreenResolutionInCookie.js');
            $this->Display_Resolution = !( IS_NULL( $_COOKIE['users_resolution'] )) ? substr(trim($_COOKIE['users_resolution']),0,16) : "N/A";
        }
        $this->Page_Action = substr(trim(&$xPageAction),0,32);
     }
     // Initialize Session objSession for $_SESSION
     public function CreateSession($xSessionId = null, &$xSessionObj = null ) {
        $this->Creation_Dt = date( 'Y-m-d H:i:s', time( ));
        $this->UpdateSessionClassData(&$xSessionId, &$xSessionObj);
       // $this->WriteSessionToDb();
        }

     // Update Session objSession for $_SESSION
     public function UpdateSession($xSessionId = null, &$xSessionObj = null, $xPageAction = "N/A" ) {
        $this->UpdateSessionClassData(&$xSessionId, &$xSessionObj, &$xPageAction);
       // $this->WriteSessionActivityToDb();
        }

      // Writes the session data to database
      public function WriteSessionToDb($xUserType = "Web") {
              $objConnect = new clsDb;
              $objDb = $objConnect->GetDbConnection($xUserType);
              //$objDb = $this->GetDbConnection($xUserType);
              $_InsertSQL = new PDOStatement;
              $_InsertSQL = $objDb->prepare("INSERT INTO T_SESSION_STATS(" .
                  "F_ACTION_DT, F_SESSION_ID, F_SESSION_IP_ADDRESS, F_BROWSER_TYPE," .
                  "F_DISPLAY_RESOLUTION, F_PAGE_REQUESTED, F_PAGE_REQUEST_PARAMS," .
                  "F_REQUEST_METHOD, F_IS_HTTPS_IND, F_IS_LOGGED_IN_IND, F_USER_KEY)" .
                  "Values (?,?,?,?,?,?,?,?,?,?,?)");
              $_InsertSQL->bindParam(1, $this->Action_Dt );
              $_InsertSQL->bindParam(2, $this->Session_Id );
              $_InsertSQL->bindParam(3, $this->Session_IP_Address );
              $_InsertSQL->bindParam(4, $this->Browser_Type );
              $_InsertSQL->bindParam(5, $this->Display_Resolution );
              $_InsertSQL->bindParam(6, $this->Page_Requested );
              $_InsertSQL->bindParam(7, $this->Page_Request_Params );
              $_InsertSQL->bindParam(8, $this->Request_Method );
              $_InsertSQL->bindParam(9, $this->Is_Https_Ind );
              $_InsertSQL->bindParam(10, $this->Is_Logged_In_Ind );
              $_InsertSQL->bindParam(11, $this->User_Key );
          try {
            $objDb->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
            $objDb->beginTransaction();
            $_InsertSQL->execute();
            $objDb->commit();
            unset($objDb);
          } catch (Exception $e) {
            $objDb->rollBack();
            echo "Failed: " . $e->getMessage();
            unset($objDb);
            unset($objConnect);
          }
      }

        // Writes the session data to database
        public function WriteSessionActivityToDb($xUserType = "Web",$xPageAction = "N/A") {
                $objConnect = new clsDb;
                $objDb = $objConnect->GetDbConnection($xUserType);
                //$objDb = $this->GetDbConnection($xUserType);
                $_InsertSQL = new PDOStatement;
                $_InsertSQL = $objDb->prepare("INSERT INTO T_SESSION_ACTIVITIES(" .
                    "F_ACTION_DT, F_SESSION_ID, F_SESSION_IP_ADDRESS, " .
                    "F_PAGE_REQUESTED, F_PAGE_REQUEST_PARAMS," .
                    "F_REQUEST_METHOD, F_PAGE_ACTION, F_IS_HTTPS_IND, F_IS_LOGGED_IN_IND, F_USER_KEY)" .
                    "Values (?,?,?,?,?,?,?,?,?,?)");
                $_InsertSQL->bindParam(1, $this->Action_Dt );
                $_InsertSQL->bindParam(2, $this->Session_Id );
                $_InsertSQL->bindParam(3, $this->Session_IP_Address );
                $_InsertSQL->bindParam(4, $this->Page_Requested );
                $_InsertSQL->bindParam(5, $this->Page_Request_Params );
                $_InsertSQL->bindParam(6, $this->Request_Method );
                $_InsertSQL->bindParam(7, substr(trim($xPageAction),0,32));
                $_InsertSQL->bindParam(8, $this->Is_Https_Ind );
                $_InsertSQL->bindParam(9, $this->Is_Logged_In_Ind );
                $_InsertSQL->bindParam(10, $this->User_Key );
            try {
              $objDb->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
              $objDb->beginTransaction();
              $_InsertSQL->execute();
              $objDb->commit();
              unset($objDb);
              unset($objConnect);
            } catch (Exception $e) {
              $objDb->rollBack();
              unset($objDb);
              echo "Failed: " . $e->getMessage();
            }
        }
    }

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:51:51.757

这个问题似乎在你的`clsSession`课堂上。这是使用`&`. 由于会话对象已序列化，因此这些引用未正确存储。尝试删除这些（即更改`UpdateSessionClassData`和`UpdateSession`删除`&`from 参数），看看这是否解决了问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-18T00:32:18.513

开始，放在`session_start();`前面`require_once`并添加`var_dump($_SESSION)`调试。

# objective-c - 禁用菜单项

> ID：14390489
> 
> 赞同：5
> 
> 时间：2013-01-18T00:15:48.580
> 
> 标签：objective-c, macos

我的一本电子书解释了如何添加新的菜单项。嗯，这不是很难弄清楚。也不难弄清楚如何将 IBAction 链接到新菜单项。但是这本书和谷歌搜索结果并没有解释如何禁用一个菜单项。更具体地说，我想禁用首选项和退出，具体取决于窗口当前出现的位置。如果应用程序当前显示首选项窗口，我想禁用这些菜单项。

![在此处输入图像描述](../Images/0ec6272046f0cad431a1f9a678f6f76e.png)

假设我有一个名为**preferencesMenu**的 IBOutlet ，然后我有

```
[preferencesMenu setEnabled:NO]; 
```

，这不会禁用有问题的菜单项。那么如何禁用特定的菜单项呢？

感谢您的意见。

汤姆

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T02:58:16.603

NSMenuItem 仅当**它们**的目标和选择器分别为`nil`和时才会自动禁用`NULL`。

```
[preferencesMenu setTarget:nil];
[preferencesMenu setAction:NULL]; 
```

快速测试揭示了这一点：

![在此处输入图像描述](../Images/716067066ef5df9e937ae22620dae7aa.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T01:12:33.660

只需将目标设置为零。我会做的。

```
[preferencesMenu setTarget:nil]; 
```

# php - PHP：关于类声明的顺序，有人可以解释实例化类/子类的规则吗？

> ID：14390490
> 
> 赞同：1
> 
> 时间：2013-01-18T00:15:52.683
> 
> 标签：php, class, instance

我希望我使用了正确的术语，如果没有，请发表评论，我会更正。

* * *

### #1：工作

在类声明*之前*实例化

```
$x = new Abc;

class Abc {
    // code
} 
```

* * *

### #2：不起作用

在子类声明*之前*实例化（子类*在*父类之前声明）

```
$x = new Xyz

class Xyz extends Abc {
    // code
}

class Abc {
    // code
} 
```

* * *

### #3：工作

*在子类声明之前*实例化（子类声明*在*父类之后）

```
$x = new Xyz

class Abc {
    // code
}

class Xyz extends Abc {
    // code
} 
```

* * *

### #4：工作

在子类声明*之后*实例化（子类在父类*之前声明）*

```
class Xyz extends Abc {
    // code
}

$x = new Xyz

class Abc {
    // code
} 
```

* * *

### 编辑

以下引用来自@artsylar 下面的回答。我不知道我的共享主机是否启用了*自动加载*，但对于我列出的示例，我无法理解该引用。

> 笔记：
> 
> 除非使用自动加载，否则必须在使用类之前定义类。如果一个类扩展了另一个类，则必须在子类结构之前声明父类。此规则适用于继承其他类和接口的类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:25:26.390

我认为这个链接可以帮助你。[http://php.net/manual/en/language.oop5.inheritance.php](http://php.net/manual/en/language.oop5.inheritance.php)

> 笔记：
> 
> 除非使用自动加载，否则必须在使用类之前定义类。如果一个类扩展了另一个类，则必须在子类结构之前声明父类。此规则适用于继承其他类和接口的类。

# python - 最快的 Python 并发框架

> ID：14390493
> 
> 赞同：3
> 
> 时间：2013-01-18T00:16:00.187
> 
> 标签：python, c, performance, concurrency, event-handling

有人可以建议一个 Python 中的并发框架（线程，基于事件），它可以处理两个任务，一个必须处理大量事件，另一个可以以较慢的速度处理一个或多个命令？我将使用 Twisted 制作原型，看看它是否能满足我的需求。我浏览了[http://www.slideshare.net/dabeaz/an-introduction-to-python-concurrency](http://www.slideshare.net/dabeaz/an-introduction-to-python-concurrency)，它提供了丰富的信息，所以我可以尝试的另一个选择似乎是多处理模块。

## 背景

我正在尝试编写一个程序，该程序可以在一侧与 C 程序交互，而在另一侧与网络交互。C 程序以很高的速率生成事件（每秒数十万，可能是一百万条消息），这些事件需要在不被阻塞的情况下被消费，并且 C 程序需要发送来自网络的命令。

我认为带有 zeromq ( [http://www.zeromq.org/](http://www.zeromq.org/) ) 的 Python 足以使用 C 程序中的事件。但我还需要在我的程序中同时处理来自网络的命令。我之前使用 Python 和 Twisted 进行异步编程，但不确定它是否可以足够快地同时处理 zeromq 消息和其他任务。

我将尝试一下，但我想知道是否有人对其他做事方式有任何想法。我宁愿使用 Python，因为它可以让处理命令和保持状态比我必须在 C 中更容易。

# python - 如何在python中的子进程中跳出循环

> ID：14390495
> 
> 赞同：0
> 
> 时间：2013-01-18T00:16:11.013
> 
> 标签：python, global-variables, multiprocessing

我觉得这应该是一个简单的解决方案，但这是一天结束的时候，我已经脑残了。我目前正在产生几个进程，一个进程正在接收数据并将其存储到文件中。另一个是解析数据，第三个是等待用户输入以知道何时停止存储数据。

我需要知道如何做的是突破我的 while 循环。我不想使用父进程设置的全局变量，但如果需要，我可以这样做。现在我的代码看起来像这样：

```
while(packetReceived < totalToReceive):
    data, addr = sock.recvfrom(packetSize) 
```

我的想法是这样的：

```
breakout = 0
while(packetReceived < totalToReceive || breakout != 0):
    data, addr = sock.recvfrom(packetSize) 
```

但后来我需要以某种方式设置突破。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:28:29.557

您不能仅通过在父进程中使用全局变量来共享状态。这可能看起来有效，但它只在某些时候有效；它既不可靠也不可预测。除了在 Windows 上，它可靠且可预测地永远不会工作；每个孩子都将永远拥有自己独立的旗帜副本，因此您永远不会退出。

如果您真的想通过共享变量来做到这一点，请参阅文档中的[进程之间的共享状态](http://docs.python.org/2/library/multiprocessing.html#sharing-state-between-processes)，但简短的版本是：您创建一个`multiprocessing.Value`. 然后您使用 a`multiprocessing.Condition`来保护该值免受竞争，因为否则，无法保证子进程将永远看到父进程的更改。

当然，您可以通过例如创建一个`mmap`最小尺寸并仅将`m[0]`其用作标志而`m.flush()`不是条件来伪造它，但这实际上并不简单。

另一种方法是使用[`multiprocessing.Pipe`](http://docs.python.org/2/library/multiprocessing.html#exchanging-objects-between-processes)或类似的方法传递“立即关闭”消息。子进程可以各自生成一个线程来阻塞管道，或者您可以将管道和您的套接字扔`select`在一起，或者所有其他常见的技巧。

在这种情况下，可能还有另一个更简单的选择：一开始就不要使用`multiprocessing`。显然，您的后台任务不受 CPU 限制，因为它只是循环从套接字读取，那么为什么不只是`threading`呢？

此外，让我感到震惊的是，您也许可以通过其他方式简化您的设计，这可以完全消除这个问题。您是否需要读取和处理作业之间的文件而不是队列，甚至只是一个直接顺序管道？您能否将用户输入和套接字扔到同一个事件循环中（`select`如果用户输入是`stdin`并且您不关心 Windows，则使用普通旧的；如果用户输入是 Qt GUI，则使用 a`QSocket`而不是 a ；如果您愿意学习; ETC。）。或者，是否有真正的用户输入，或者只是“立即退出”（或“关闭套接字并立即处理剩余的消息”），您可以使用 ^C 处理？`socket.socket``twisted``twisted`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:35:45.247

与其使用多处理变量，不如考虑检查是否存在“毒丸”以跳出循环。

例如，更改：

```
data, addr = sock.recvfrom(packetSize) 
```

类似于：

```
received = sock.recvfrom(packetSize)
if received is None:
    break
data, addr = received 
```

`None`您可以通过向进程发送一个值来指示进程跳出其循环。我不确定您是否`sock`可以发送/接收`None`，但总体思路是一样的。

# c# - 以服装格式加入字符串列表

> ID：14390501
> 
> 赞同：0
> 
> 时间：2013-01-18T00:17:07.080
> 
> 标签：c#, string, concatenation

我有一个这样定义的字符串列表

```
List<String> lstHeaders = new List<string>(new String[]{"str","str1","str2"}); 
```

我想要一种方法以特定格式加入所有元素以获得类似的东西

```
<td>str</td><td>str1</td><td>str2</td> 
```

但是在代码的在线获取这个，就像这样

```
"<th>"+lstHeaders.functionToGetFormated()+"</th>" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:20:40.137

为此编写自己的扩展方法可能更有意义。没有任何内置功能可以完全像那样工作（我知道）。

```
public static string WrapElementsWithTag(this IEnumerable<string> input, string wrapper)
{
    StringBuilder sb = new StringBuilder();
    foreach (string s in input)
    {
        sb.AppendFormat("<{1}>{0}</{1}>", s, wrapper);
    }
    return sb.ToString();
} 
```

叫喜欢;

```
lstHeaders.WrapElementsWithTag("td"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T00:23:24.980

使用`StringBuilder`类：

```
var sb = new StringBuilder();
lstHeaders.ForEach(x => sb.AppendFormat("<td>{0}</td>", x));
return sb.toString() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T00:24:31.693

您可以执行以下操作：

```
string.Format("<td>{0}</td>", string.Join("</td><td>", lstHeaders)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T00:25:45.260

使用 Linq 和`String.Concat`：

```
string result = string.Concat(lstHeaders.Select(s => string.Format("<td>{0}</td>", s))); 
```

查询语法可能更清楚：

```
string result = string.Concat(from s in lstHeaders select string.Format("<td>{0}</td>", s)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T00:47:40.387

通常简单的字符串连接对于构建像 html 和 xml 这样的元数据是有风险的。如果您绝对确定文本不会破坏元语法，您肯定可以使用 StringBuilder 或 LinQ 来做到这一点。说，那些字符串已经被转义了。

否则，您可以考虑使用 HtmlTextWriter。在 LINQ 中使用 HtmlTextWriter 应该不难。

# uitableview - 第三次选择同一个 UITableViewCell 不会高亮和添加accessoryCheckmark

> ID：14390502
> 
> 赞同：1
> 
> 时间：2013-01-18T00:17:15.207
> 
> 标签：uitableview, highlight, selectedindex

1.  当我想突出显示并在所选单元格旁边放置复选标记时，下面的代码有效。

2.  当我想选择另一个单元格时，它也可以工作，因为它取消选择最后一个单元格或突出显示并在新选定的单元格旁边放置一个复选标记和突出显示。

3.  当我重新选择一个选定的单元格时，它也可以工作，因为它取消选择它不会留下复选标记并在 UITable 中突出显示。

4.  但是，当我第三次选择同一个单元格时（意思是，我第一次选择它，代码突出显示它并在它旁边打了一个复选标记。我第二次选择了同一个单元格，它删除了突出显示和复选标记，现在是我第三次选择同一个单元格）它突出显示单元格几分之一秒，然后突出显示消失。单元格旁边的复选标记也永远不会出现，就好像我刚刚取消选择它一样。无论我选择同一个单元格多少次，它都不会突出显示它或在它旁边放一个复选标记。完成此操作的唯一方法是先选择另一个单元格，然后重新选择原始单元格。请帮忙。

    ```
    - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath*)indexPath
    {

        // select new

        UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];

        cell.accessoryType = UITableViewCellAccessoryCheckmark;
        [cell setSelected:TRUE animated:TRUE];

        // deselect old
        UITableViewCell *old = [self.tableView cellForRowAtIndexPath:self.lastSelected];

        old.accessoryType = UITableViewCellAccessoryNone;
        [old setSelected:FALSE animated:TRUE];

        // keep track of the last selected cell      
        self.lastSelected = indexPath;

    } 
    ```

我通过 Storyboard 构建了 UITableView。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T07:11:05.463

只是对那里的逻辑进行了小幅调整：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath*)indexPath
{

    UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];

    if (self.lastSelected && (self.lastSelected.row == indexPath.row)) {
        cell.accessoryType = UITableViewCellAccessoryNone;
        [cell setSelected:NO animated:TRUE];
        self.lastSelected = nil;
    } else {
       cell.accessoryType = UITableViewCellAccessoryCheckmark;
       [cell setSelected:TRUE animated:TRUE];

        UITableViewCell *old = [self.tableView cellForRowAtIndexPath:self.lastSelected];
        old.accessoryType = UITableViewCellAccessoryNone;
        [old setSelected:NO animated:TRUE];
        self.lastSelected = indexPath;
    }
} 
```

# java - 捕获焦点事件的来源

> ID：14390503
> 
> 赞同：1
> 
> 时间：2013-01-18T00:17:20.823
> 
> 标签：java

我试图找出一个棘手的焦点遍历问题。

捕获正在执行焦点更改的内容很容易，但目的不大，它是事件队列。我需要的是捕获请求焦点更改的内容 - 找到启动焦点更改请求的代码。

我曾经有一个方便的工具，它使用了一些噱头或其他工具，使其有效地成为接收事件的队列，然后可以使用调试逻辑对其进行自定义以打印出请求来源的堆栈跟踪，但我已经失去了工具，而创建它超出了我的范围。然而，我很想再次拥有它，因为它非常简单，非常适合调试焦点问题。

所以我问：我如何捕获事件的来源？我只需要它来处理焦点事件，所以如果它是针对这些事件的解决方案，那么它对我来说就像一个通用的事件队列解决方案一样好。

如果没有这样的工具，我可以蛮力解决问题，但我宁愿不必求助于使用调试器一次单步执行代码行。

# jquery - 一次滑下一个

> ID：14390506
> 
> 赞同：0
> 
> 时间：2013-01-18T00:17:37.160
> 
> 标签：jquery, jquery-ui

所以我知道有很多这样的问题，但我认为这有点独特......这是我的代码首先......

```
<div class="holster_infobox_helper">

        <div id="infobox_holder">
            <div class="infobox">
                <h2><img src="<?php $ROOTPATH ?>/img/icons/color_18/access_point.png">Alerts</h2>
                <p class="infobox_alert"><a href="<?php echo $ROOTPATH; ?>jobs"><img src="<?php $ROOTPATH ?>/img/icons/gray_18/hammer.png">Accepted Proposal</a></p>
                  <p class="infobox_alert"><a href="<?php echo $ROOTPATH; ?>jobs"><img src="<?php $ROOTPATH ?>/img/icons/gray_18/hammer.png">Accepted Proposal</a></p>
                    <p class="infobox_alert"><a href="<?php echo $ROOTPATH; ?>jobs"><img src="<?php $ROOTPATH ?>/img/icons/gray_18/hammer.png">Accepted Proposal</a></p>
            </div>

            <div class="infobox">
                <h2><img src="<?php $ROOTPATH ?>/img/icons/color_18/hammer.png">Jobs</h2>
                <p class="infobox_alert"><a href="<?php echo $ROOTPATH; ?>jobs"><img src="<?php $ROOTPATH ?>/img/icons/gray_18/hammer.png">Accepted Proposal</a></p>
                <p class="infobox_alert"><a href="<?php echo $ROOTPATH; ?>jobs"><img src="<?php $ROOTPATH ?>/img/icons/gray_18/hammer.png">Accepted Proposal</a></p>
                  <p class="infobox_alert"><a href="<?php echo $ROOTPATH; ?>jobs"><img src="<?php $ROOTPATH ?>/img/icons/gray_18/hammer.png">Accepted Proposal</a></p>
            </div>
        </div>

    </div> 
```

我有一个小片段，

```
$(".infobox_alert").delay(2500).slideDown(1000); 
```

这使得所有 .infobox_alert

的立即下降。我想让每个“信息框”中的每一个都一个一个地下拉。从第一个信息框开始，一二三，然后是下一个信息框，一二三，然后是下一个。所以它会一个一个地打开，然后一个一个地打开。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:23:15.567

如果您使用[each](http://api.jquery.com/jQuery.each/)方法，您可以延迟滑动所需的时间：

```
var i = 0;
$(".infobox_alert").each(function () {
  $(this).delay(1000*i).slideDown(1000);
  i++;
}); 
```

这种方法在完整事件上的链接的好处是，您可以通过增加延迟或缩短延迟来错开它们。如果缩短它，它们会按顺序下降，但不要等到前一个完全滑动完成后才开始滑动。尝试使用延迟，直到获得所需的效果。

小提琴示例：http: [//jsfiddle.net/MKKbj/](http://jsfiddle.net/MKKbj/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:27:20.883

使用递归：

```
slideIt(0);

function slideIt(i){
   var el =$(".infobox_alert:eq("+i+")");
   if(el == undefined) 
       return;
   el.slideDown(1000);
   setTimeout(function(){slideIt(++i)}, 1000);
} 
```

演示：http: [//jsfiddle.net/Yjnny/](http://jsfiddle.net/Yjnny/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T00:23:20.770

一种方法是在递归函数中使用每个向下滑动的回调。

创建一个向下滑动的函数：

```
var slideDownNext = function(element){
    element.next().slideDown( function(){ slideDownNext($(this)) } );
} 
```

然后将其附加到第一个元素：

```
$(".infobox_alert:first").slideDown( function(){ slideDownNext($(this)) } ); 
```

正如其他答案中提到的，您可以使用超时/延迟来错开滑动，但这并不能保证下一个在前一个完成之前不会打开。即使您将动画的时间设置为与延迟相同，也可能会发生其他事情，这可能会使下一个动画在前一个动画完成之前开始。

**更新：** 我没有完全查看问题中的 html 并假设所有元素都是兄弟姐妹。因为情况并非如此，这样的解决方案应该会更好：

```
var alerts = $('.infobox_alert')
function slideNext(i){
    alerts.eq(i).slideDown( function(){ slideNext(++i); } );
}
alerts.eq(0).slideDown( function(){ slideNext( ++i ); } ); 
```

# java - 单元测试中的模拟域实体

> ID：14390512
> 
> 赞同：2
> 
> 时间：2013-01-18T00:18:40.787
> 
> 标签：java, unit-testing, junit, mockito

我有一个非常简单的问题：我一直在为具有 Context 对象的命令对象编写一些单元测试。这个上下文里面有一些领域实体。

```
 public class Context { 
          private DomainEntity domainEntity1;
          private Dto dto1;

          // getters and setters go here...

          public boolean isDomainEntityValid() {
              // a little bit of logic goes here
          }
    }

    public class Command {

          public void execute(Context context) { 
                // do its logic in here
          }
    } 
```

DTO 和 DomainEntity 只有 setter 和 getter 以及非常简单的验证方法（例如`isFirstNameValid()`）。

Context 对象中确实有逻辑——毕竟，它检查上下文是否一致，上下文是否完整，等等。

在对命令对象进行单元测试时，我很清楚应该模拟出上下文 - 但是实体和 dto 呢？我应该嘲笑他们吗？如果是这样，我将不得不做很多像下面这样的代码

```
 doReturn(1L).when(domainEntity1).getId();
    doReturn("phil").when(domainEntity1).getName(); 
```

换句话说，必须定义 getters 方法的许多行为。

所以，底线：我应该在对对象进行单元测试时模拟域实体和 DTO 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:30:18.440

我认为您可能在这里违反[了得墨忒耳的“法则”](http://en.wikipedia.org/wiki/Law_of_Demeter)。我把它放在引号中是因为你不应该将此作为法律，而应作为建议。

您并没有真正给我们足够的上下文来告诉您应该具体更改什么（即：为什么命令需要 id 和名称？），但是还有另一个原则叫做[告诉，不要问](http://pragprog.com/articles/tell-dont-ask)和我想想如果你改变你的代码来遵循它，你的代码将变得更容易测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T03:25:11.150

（我想我可以在我的评论中详细说明）

您是否需要进行模拟等都取决于您的被测系统（SUT，在本例中为您的命令）中的逻辑。

模拟/存根的整个想法是我们对 SUT 的测试不依赖于其他实际代码。因此我们编写了适合在测试中使用的模拟/存根，因此测试的有效性仅取决于 SUT，而不取决于其他实际代码（当然，假设您的模拟/存根编写正确，但这通常不是问题由于其简单性）

因此，如果您的 Command 逻辑类似于

```
DomainEntity domain = context.getDomainEntity();
domain.doSomething(); 
```

那么是的，您需要为您的域实体进行模拟。

但是，如果您只是针对上下文工作，例如：

```
if (context.isDomainEntityValid()) {
    doSomething();
} else {
    doAnotherThing();
} 
```

那么模拟域实体就没有意义了。

还有一点需要注意，借助模拟框架，您可以根据您的 SUT 逻辑简单地进行存根。你不需要为每个方法做存根。

因此，如果您的 Command 仅调用`domain.doSomething()`，则只需存根此方法。忘了`DomainEntity#anotherMethod()` `DomainEntity#getId()`。

# ios - iOS 5 自动旋转不起作用

> ID：14390513
> 
> 赞同：1
> 
> 时间：2013-01-18T00:18:50.850
> 
> 标签：ios, uitabbarcontroller, uistoryboard, autorotate

我有标签栏应用程序，但旋转有问题。我正在使用带有标签栏控制器的故事板作为初始视图控制器，在 ios 6 上一切正常，视图旋转为横向和纵向，但在 ios 5 上，视图仅处于纵向模式，旋转不起作用。我尝试创建自定义标签栏控制器子类，并向它添加了 shouldAutoRotateToInterfaceOrientation 函数，还添加了标签栏中的所有视图控制器，但它没有帮助。有人知道有什么问题吗？

编辑：如果您有 Xcode 4.5.2，您可以从标签栏应用程序模板创建新项目并检查自己是否有同样的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T14:21:24.807

检查它是否在您的应用程序的*每个*视图控制器中

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
    return YES;
} 
```

但是不要担心标签栏控制器的子类化，你不需要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:31:33.163

我发现该帖子并且该解决方案对我有用：http: [//iosgems.blogspot.de/2012/11/how-to-get-autorotation-working-for.html](http://iosgems.blogspot.de/2012/11/how-to-get-autorotation-working-for.html)

# java - 自定义休眠实体持久化器

> ID：14390515
> 
> 赞同：3
> 
> 时间：2013-01-18T00:19:09.540
> 
> 标签：java, database, hibernate, orm

我正在对映射的项目进行性能测试/优化

```
a document <--> Java object tree <--> mysql database 
```

用于映射的文档、Java 类、数据库模式和逻辑是使用 HyperJaxb3 编排的。其中的ORM部分是hibernate提供的JPA。

大约有 50 个不同的实体，它们之间显然有很多关系。该应用程序的一个主要功能是加载文档，然后将数据重组为新文档；每个传入文档的所有部分最终都会在一个传出文档中发送出去。虽然我不希望生活在关系世界中，但事务语义非常适合这个应用程序 - 涉及大量资金和政府监管，因此我们需要确保所有内容都准确交付一次。

从功能上讲，一切进展顺利，性能也不错（经过大量调整）。每个文档由几千个实体组成，最终在数据库中创建几千行。文档的大小各不相同，插入性能与需要插入的行数几乎成正比（这并不奇怪）。

我看到了重大优化的潜力，这就是我的问题所在。

每个文档都映射到实体树。树的“叶子”一半包含许多详细信息，这些信息在决定如何生成传出文档时未使用。换句话说，我不需要能够通过许多表的内容来查询/过滤。

我想将适当的实体子树映射到 blob，从而节省插入/更新/索引我目前以通常方式处理的大多数行的开销。

看来我最好的选择是实现一个自定义 EntityPersister 并将其与适当的实体相关联。这是正确的方法吗？hibernate 文档还不错，但它是一个相当复杂的类，需要实现，在查看 javadoc 后我留下了很多问题。您能否指出一个具体但简单的示例，我可以将其用作起点？

关于另一种方法来处理这种优化的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:33:09.807

我在存储大量二进制数据时遇到了同样的问题。我发现效果最好的解决方案是对象模型的非规范化。例如，我创建了一个主记录，然后创建了第二个保存二进制数据的对象。在 master 上，使用`@OneToOne`到辅助对象的映射，但将关联标记为惰性。现在只有在需要时才会加载数据。

可能会减慢您速度的一件事是`outer join`休眠对这种类型的所有对象执行。为避免这种情况，您可以将对象标记为强制对象。但是，如果数据库没有给您带来巨大的性能影响，我建议您不要管它。我发现如果我尝试进行常规连接，Hibernate 倾向于立即加载二进制数据。

最后，如果您需要在单个 SQL 调用中检索大量二进制数据，请使用 HQL`fetch join`命令。例如： `from Article a fetch join a.data`其中 a.data 是与二进制持有者的一对一关系。HQL 编译器会将其视为在单个 sql 调用中获取所有数据的指令。

高温高压

# c++ - 我的卫星环绕，但沿着非圆形路径（校正球坐标数学）

> ID：14390516
> 
> 赞同：1
> 
> 时间：2013-01-18T00:19:10.273
> 
> 标签：c++, macos, math, opengl

这就是我将环面（卫星）放置在球体上，然后围绕球体旋转的方式：

```
 int satellite_1_1_step = 0;
    int &r_satellite_1_1_step = satellite_1_1_step;
    float satellite_1_1_divider = 300;

    float satellite_1_1_theta = 6.5;
    float satellite_1_1_phi = 1;
    float satellite_1_1_theta_increment = 20/satellite_1_1_divider;
    float satellite_1_1_phi_increment = 20/satellite_1_1_divider;

    void satellite_1_1 ()
    {
            float satellite_1_1_theta_math = (satellite_1_1_theta-(satellite_1_1_theta_increment * r_satellite_1_1_step))/10.0*M_PI;
            float satellite_1_1_phi_math = (satellite_1_1_phi-(satellite_1_1_phi_increment * r_satellite_1_1_step))/10.0*2*M_PI;
            r_satellite_1_1_x = radius_exodus_pos * sin(satellite_1_1_theta_math) * cos(satellite_1_1_phi_math);
            r_satellite_1_1_y = radius_exodus_pos * sin(satellite_1_1_theta_math) * sin(satellite_1_1_phi_math);
            r_satellite_1_1_z = radius_exodus_pos * cos(satellite_1_1_theta_math);  

            glPushMatrix();
            glTranslatef(r_satellite_1_1_x,r_satellite_1_1_y,r_satellite_1_1_z);
            glColor3f(1,0,0);
            glutSolidTorus(0.04, 0.2, 10, 100);
            glEnd();
            glPopMatrix();
    } 
```

这就是我更新和增加其位置的方式：

```
 void satellite_1_1_increment()
    {

    if (r_satellite_1_1_step < satellite_1_1_divider)   
        {
        ++(r_satellite_1_1_step); 
        }

    if (r_satellite_1_1_step >= satellite_1_1_divider)  
        {
        r_satellite_1_1_step = 1;  
        }
    } 
```

所以，我的圆环（卫星）围绕球体移动，最终回到起始位置，然后再次继续——这很棒。然而，它所走的路径在两极（我认为）周围摇摆不定——而不是简单地环绕球体。

是否可以对我的数学进行改进，使卫星以更圆形的路径环绕球体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:36:10.493

我看到的第一个问题是：

```
void satellite_1_1_increment()
{
    if (r_satellite_1_1_step < satellite_1_1_divider)   
    {
        ++(r_satellite_1_1_step); 
    }

    if (r_satellite_1_1_step >= satellite_1_1_divider)  
    {
        r_satellite_1_1_step = 1;  
    }
} 
```

当第一个测试增加步长以满足第二个测试时，边缘情况会发生什么？它立即被重置，因此丢失了该值。我认为您希望这样写以避免该问题：

```
void satellite_1_1_increment()
{
    if (r_satellite_1_1_step >= satellite_1_1_divider)   
           r_satellite_1_1_step = 1;  
    else   ++r_satellite_1_1_step;
} 
```

`1`复位值是否正确？也许应该是`0`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T02:29:05.173

更改了前两行：

```
 void satellite_1_1 ()
    float satellite_1_1_theta_math = (satellite_1_1_theta+(satellite_1_1_theta_increment* r_satellite_1_1_step))*M_PI;
    float satellite_1_1_phi_math = (satellite_1_1_phi-(satellite_1_1_phi_increment* r_satellite_1_1_step))*M_PI/360; 
```

现在卫星沿赤道运行 360 度。在我的 glPushMatrix 之后添加一个 glRotatef 可以让我微调它的轴。

再次感谢沃利克。- 克罗普克

# matlab - 如何将属性 _value 对添加到 txt 文件并按字母顺序排序

> ID：14390517
> 
> 赞同：3
> 
> 时间：2013-01-18T00:19:17.077
> 
> 标签：matlab

我想在包含属性值对的 txt 文件中添加属性值对，并且属性应按字母顺序排序，其中属性位于方括号之间，其值在下面的行中。这是一个示例文件：除此之外，我想忽略以“#”开头的注释行。

```
#
[system]
# 
programming 
#
[information] 
#
application 
```

像：-

```
function [] = updateFile( fileName,property,propertyValue )

% all inputs in strings
%
rfh = fopen( fileName, 'r' ); % read handle
tname = tempname(); % temporary file name
wfh = fopen( tname, 'w' ) 
```

在这个例子中，“系统”是一个属性，而“编程”是它的值。同样，“信息”是另一种属性，“应用”是它的价值。

我想用属性值对调用我的函数，并用新的属性值对更新 txt 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T04:08:50.287

由于您正在更新文件，因此您应该以“追加”模式打开它。您使用该`sort`功能对数据进行排序。假设变量`property`和`propertyValue`是元胞数组，您的代码将如下所示

```
function [] = updateFile( fileName,property,propertyValue )

% all inputs in strings

fid = fopen(fileName, 'a' ); % file handle
[property_sorted,sort_index] = sort(property); % sort file
for count = 1:length(sort_index)
    fprintf(fid,'%s\n%s\n',property_sorted(count),propertyValue(sort_index(count)));
end

fclose(fid); 
```

有关更多信息，请参阅排序 ( `doc sort`) 的文档。

# php - 转换出现在字符串中的链接

> ID：14390518
> 
> 赞同：1
> 
> 时间：2013-01-18T00:19:25.373
> 
> 标签：php, regex, preg-replace

我正在尝试更改字符串的出现，例如`http://www.bbc.co.uk/`，使其出现在 html 链接中，例如`<a href="http://www.bbc.co.uk/">http://www.bbc.co.uk</a>`

但是由于某种原因，我的正则表达式转换不起作用。有人可以指出我正确的方向吗？

```
$text = "I love this website http://www.bbc.co.uk/";
$x = preg_replace("#[a-z]+://[^<>\s]+[[a-z0-9]/]#i", "<a href=\"\\0\" target=\"_blank\">\\0</a>", $text);
var_dump($x); 
```

输出我喜欢这个网站`http://www.bbc.co.uk/`（没有 html 链接）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:26:09.853

您的怪异角色类别有问题：

```
 [[a-z0-9]/] 
```

双方括号用于 POSIX 字符类，如`[[:digit:]]`.

你的意思是写：

```
 [a-z0-9/] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:27:41.083

用这个：

```
$x = preg_replace('#http://[?=&a-z0-9._/-]+#i', '<a target="_blank" href="$0">$0</a>', $text); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T00:29:53.433

这是因为您的正则表达式正在给您一个匹配项（事实上，它甚至还没有接近给您一个匹配项，因为您根本不接受域名中的句点）。尝试这样的事情：

```
$pattern = '#https?://.*\b#i';
$replace = '<a href="$0" target="_blank">$0</a>';
$x = preg_replace($pattern, $replace, $text); 
```

请注意，我实际上并没有尝试在此处验证 URL 格式，因此我只接受 http():// 之类的任何内容，直到下一个单词边界。无论如何，您似乎并不打算使用真正的 URL 验证正则表达式（即验证至少有一个`.`，TLD 组件有 2-6 个字符等），所以我只是想我会给你最简单的匹配的模式。

# vim - Vim中的b和B有什么区别？

> ID：14390519
> 
> 赞同：75
> 
> 时间：2013-01-18T00:19:27.220
> 
> 标签：vim

我用谷歌搜索，这就是它所说的：

要返回一个单词，使用 b。再一次，B 将在 Vim 认为的单词中包含更多字符。

我不明白 B 与 b 有何不同。你能举个例子让我明白吗？谢谢。

[编辑]实际上我想知道这一点，因为在在线 vim[游戏中](http://vim-adventures.com/)，我试图回到 WORDS from ！与b，但它没有工作。但是，当我在我的计算机上安装 Vim 时尝试它时，它与 b 一起工作。那么这只是为了让玩家在线索的帮助下使用B吗？

这是游戏的图片：

![在此处输入图像描述](../Images/accba49ac77b137f885816f3737ef68b.png)

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2013-01-18T00:24:18.760

像大多数大写的移动对一样，`b`按单词移动，但按单词`B`移动。不同之处在于 vim 认为“单词”是字母、数字和下划线（您可以使用`iskeyword`设置进行配置），但“单词”*始终*是任何不是空格的东西。

所以鉴于此：

```
foo-bar-baz 
```

如果光标在 上`z`并按下`b`，光标将移回 的开头`baz`，然后移到连字符，然后回到 的开头`bar`，依此类推。其中每一个对于 vim 来说都是一个不同的“词”：`foo`, `-`, `bar`, `-`, `baz`。

但是，如果您按`B`，光标将一直向左移动到`f`，因为`foo-bar-baz`都是非空格，因此是单个 WORD。

`:help word`vim 内部也解释了这一点。

* * *

关于 vim 游戏：我认为游戏将巨石视为标点符号。尝试像这样在 vim 中输入它：

```
not WORDS*! 
```

将光标放在 上`!`，`b`会将您移回`*`，因为`*!`是所有标点符号，因此是一个单词。但那`*`实际上是一块巨石，所以你不能在那里移动，所以什么也没有发生。 `B`，另一方面，会跳过所有不是空格的内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-18T00:22:33.147

B 将标点符号视为单词的一部分，仅使用空格作为单词分隔符；b 不将标点符号视为单词的一部分。

# jquery - 修改 jQuery Autocomplete 插件以在未找到结果时返回新行

> ID：14390521
> 
> 赞同：1
> 
> 时间：2013-01-18T00:19:48.073
> 
> 标签：jquery, jquery-autocomplete

我们使用[jQuery Autocomplete 插件](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)使用静态数据集进行好友查找搜索（即，我们在页面上加载了好友数组，而不是通过 AJAX 查找）。我们想修改插件以在没有找到结果时注入一个结果，就像一行有名字`Search for "Input Value" instead`但运气不太好。

有没有人有修改过的源来添加这样的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:48:11.197

You can use the [`response` callback](http://api.jqueryui.com/autocomplete/#event-response):

```
 $(function () {
     var list = [
         "a",
         "b"];
     $("#i").autocomplete({
         source: list,
         response: function (event, ui) {
             var results = ui.content;
             if (results.length === 0) {
                 results.push({
                     label: "Search for '" + $("#i").val() + "' instead"
                 });
             }
         }
     });
 }); 
```

[Here's a fiddle.](http://jsfiddle.net/HjDfj/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:40:11.653

您可以使用自己的功能自定义自动完成`source`功能：

```
$(elem).autocomplete({
    source: function (request, response) {
        var noResults = [ { label: 'Search for "Input Value"', value: -1 } ];
        try {
            var matcher = new RegExp( $.ui.autocomplete.escapeRegex( request.term ), "i" );
            var matchingFriends = $.grep(friendsArray, function(value) {
                // check if search token matches a friend
                if (matcher.test(value.username)) {
                    // add necessary properties for display in autocomplete
                    value.label = value.username;
                    value.value = value.id;
                    return true;
                }
                return false;
            });
            return matchingFriends;
        }
        catch (err) {
            response(noResults);
        }
        response(noResults)
    }
}); 
```

查看[源代码](https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.autocomplete.js#L358)以了解这是如何在 jQuery-UI 中实现的，以获得更多想法。

# c# - 如何在文本文件中查找子字符串的索引

> ID：14390522
> 
> 赞同：1
> 
> 时间：2013-01-18T00:19:55.887
> 
> 标签：c#, substring

我已经使用 VS 2008 将一个 asp.net c# 项目转换为框架 3.5。应用程序的目的是解析一个包含许多行类似信息的文本文件，然后将数据插入数据库。

我没有编写原始应用程序，但开发人员使用 substring() 来获取各个字段，因为它们总是从同一位置开始。

我的问题是：

什么是在文本文件中查找子字符串索引而无需手动计算位置的最佳方法？有人有他们用来查找文本文件中字符位置的首选方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:24:37.437

我会说`IndexOf()`/`IndexOfAny()`和`Substring()`. 或者，[正则表达式](http://msdn.microsoft.com/en-us/library/30wbz966%28v=vs.71%29.aspx)。如果该文件具有类似 XML 的结构，[则此](http://msdn.microsoft.com/it-it/library/hcebdtae%28v=vs.80%29.aspx).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:03:03.493

如果文件是用逗号分隔的，你可以使用 string.Split

如果数据是：string[] text = { "1, apple", "2, orange", "3, lemon" };

```
 private void button1_Click(object sender, EventArgs e)
    {
        string[] lines = this.textBoxIn.Lines;
        List<Fruit> fields = new List<Fruit>();
        foreach(string s in lines)
        {
            char[] delim = {','}; 
            string[] fruitData = s.Split(delim);
            Fruit f = new Fruit();
            int tmpid = 0;
            Int32.TryParse(fruitData[0], out tmpid);
            f.id = tmpid;
            f.name = fruitData[1];
            fields.Add(f);
        }
        this.textBoxOut.Clear();
        string text=string.Empty;
        foreach(Fruit item in fields)
        {
            text += item.ToString() + " \n";
        }
        this.textBoxOut.Text = text;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T03:44:59.987

您可以使用 indexOf() 然后使用 Length() 作为第二个子字符串参数

```
substr = str.substring(str.IndexOf("."), str.Length - str.IndexOf(".")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:39:47.193

我正在阅读的文本文件不包含分隔符 - 有时字段之间存在空格，有时它们一起运行。在任何一种情况下，每一行的格式都相同。当我问这个问题时，我正在查看记事本中的文件。

问题是：如何在文件中找到位置，以便可以将位置（数字）指定为我的子字符串函数的 startIndex？

答：我发现在**notepad++**中打开文本文件 会显示光标在文件中任何位置的列号和行数，从而使这项工作更容易。

# data-structures - 检查是否平衡二叉树（标准ml）

> ID：14390526
> 
> 赞同：0
> 
> 时间：2013-01-18T00:20:26.510
> 
> 标签：data-structures, tree, functional-programming, sml, ml

树数据类型是：

```
datatype mobile = Object of int | Wire of mobile * mobile 
```

为了检查它是否平衡，我发现我必须首先创建一个权重函数来计算每个节点值的权重，然后比较左子树和右树。但是，我无法将其用 ml 语言表达。

到目前为止的代码：

```
fun balanced  Object = true
if(weight(Wire(x,t1)) - weight(Wire(y,t1))) = 0)
   then true
else false 
```

# wpf - 为什么我的 DataGrid 列中的 ComboBox 会将自身重置为 null？

> ID：14390528
> 
> 赞同：1
> 
> 时间：2013-01-18T00:20:32.360
> 
> 标签：wpf, combobox, wpfdatagrid

在我的 WPF 应用程序中，我正在开发一个相当简单的页面，它允许创建一个新对象或从组合框中选择一个，然后编辑该对象。

对象的可编辑部分之一是一对多关系中的相关数据库表，因此对于该部分，我使用了 DataGrid。DataGrid 本身有一个数据绑定的 ComboBox 列，如您在此处看到的：

```
<DataGrid AutoGenerateColumns="False" EnableRowVirtualization="True"
          CanUserAddRows="False" CanUserDeleteRows="True" 
          ItemsSource="{Binding Path=No.Lower_Assy}"
          DataGridCell.Selected="dgAssy_GotFocus">
    <DataGrid.Columns>
        <DataGridTemplateColumn Header="Number &amp; Type">
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <ComboBox ItemsSource="{Binding Path=DataContext.ComboSource, RelativeSource={RelativeSource AncestorType=Page}}"
                              SelectedValuePath="bwk_No"
                              SelectedValue="{Binding Path=fwf_Higher_N, ValidatesOnDataErrors=True, ValidatesOnExceptions=True, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Path=Number}"/>
                                    <TextBlock Text="{Binding Path=Type}"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
        <!-- other text columns omitted -->
        <DataGridTemplateColumn>
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <Button Content="Delete" Click="btnDeleteHigherAssy_Click" />
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
    </DataGrid.Columns>
</DataGrid> 
```

后面的代码：

```
private void dgAssy_GotFocus(object sender, RoutedEventArgs e)
{
    if (e.OriginalSource.GetType() == typeof(DataGridCell))
    {
        // Starts the edit on the row
        DataGrid grd = (DataGrid)sender;
        grd.BeginEdit(e);
    }
} 
```

对于保存按钮：

```
private void btnSave_Click(object sender, RoutedEventArgs e)
{
    if (CanUserEdit())
    {
        if (string.IsNullOrWhiteSpace(model.Data.Error))
        {
            repo.Save(model.Data);

            StatusText = STATUS_SAVED;
            model.CanSave = false;

            // This is the data source for the main combo box on the page
            model.ComboSource = repo.GetData();

            // Set the combo box's selected item, in case this is a new object.
            // cboNo is the main combo box on the page which allows selecting
            // an object to edit

            // Apparently setting SelectedItem directly doesn't work on a databound combo box
            int index = model.ComboSource.ToList().FindIndex(x => x.bwk_No == model.Data.bwk_No);
            cboNo.SelectedIndex = index;   
        }
        else
        {
            MessageBox.Show("Invalid data:\n" + model.Data.Error, "Cannot save");
        }
    }
} 
```

### 问题

当我从数据网格的组合框中选择一个项目时，它似乎可以工作，直到我单击保存按钮。然后发生两件事：

1.  组合框的选定项设置为`null`，使组合框消隐。
2.  作为 (1) 的结果，保存按钮被重新启用，因为数据已更改。（保存按钮绑定到`model.CanSave`，如您所见，它在按钮处理程序中设置为 false；如果没有数据错误，则由属性更改事件处理程序设置为 true。）

为什么要重置？我密切关注代码流，可以看到`fwf_Higher_N`正在处理组合框支持字段 () 的属性更改事件，它似乎以某种方式来自该行`model.ComboSource = repo.GetData();`，但堆栈只显示`[external code]`，我不明白为什么该行将修改现有对象。

* * *

### 模型类

```
// Names have been changed to protect the innocent
private class MyDataViewModel : INotifyPropertyChanged
{
    private DbData _Data;
    public DbData Data
    {
        get { return _Data; }
        set
        {
            _Data = value;
            OnPropertyChanged("Data");
        }
    }

    private IQueryable<MyComboModel> _ComboSource;
    public IQueryable<MyComboModel> ComboSource {
        get { return _ComboSource; }
        set
        {
            _ComboSource = value;
            OnPropertyChanged("ComboSource");
        }
    }

    private bool _CanSave;
    public bool CanSave
    {
        get { return _CanSave; }
        set
        {
            _CanSave = value;
            OnPropertyChanged("CanSave");
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    protected void OnPropertyChanged(string name)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(name));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:20:01.300

您对正在发生的事情的描述与您的标记不太匹配。我将做一些假设，例如这`Page.DataContext`是`MyDataViewModel`.

我很抱歉这么说，但是[SSCCE](http://sscce.org)会在这里创造奇迹。我强烈建议当任何人陷入他们对代码的深入了解的情况时，他们不太了解他们打破了他们正在尝试做的事情并创建一个最小的原型，该原型要么表现出相同的行为，要么可以帮助您了解正在发生的事情错误的。在过去的五年里，我制作了 500 多个原型。

至于这种情况，您在 中引用了一个`ComboBox`名为**cboNo**，`btnSave_Click`但我在 xaml 中没有看到它。此 ComboBox 的 ItemSource 似乎绑定到`MyDataViewModel.ComboSource`.

此外，*DataGrid 中的所有 ComboBox*似乎也绑定到模型的 ComboSource。并且，在按钮处理程序事件中，您可以*更改属性中的内容*：

```
// This is the data source for the main combo box on the page
model.ComboSource = repo.GetData(); 
```

这会触发`PropertyChanged`，并且*每个绑定到该属性的 ComboBox 都将被更新*。这不仅意味着`cboNo`DataGrid 中的每个 ComboBox。

预期的行为是，当`ComboBox.ItemsSource`更改时，如果`ComboBox.SelectedItem`项目源中不包含该行为，则该行为将`SelectedItem`被取消。

我刚刚创建了一个原型（501+），看起来如果`IEnumerable`ComboBox 绑定到更改，*但 IEnumerable 中的元素没有*，则`SelectedItem`不会被*清空*。

```
var temp = combo.ItemsSource.OfType<object>().ToArray();            
combo.ItemsSource = temp; 
```

因此，在`btnSave_Click`事件处理程序中，您更改了此 ItemsSource，它可能没有*与*组合中已有的相同实例，从而使*绑定到此属性的所有 ComboBox 的*SelectedItem 无效，然后仅更新`cboNo`SelectedIndex。

*现在，至于该怎么办...*

嗯，不确定。从您的其余代码来看，您似乎需要做更多的代码隐藏工作，以确保只有必要的 ComboBox 更新其源代码......

# ios5 - iOS 版本 5.1.1 的电话差距错误。按钮不起作用

> ID：14390533
> 
> 赞同：1
> 
> 时间：2013-01-18T00:20:56.090
> 
> 标签：ios5, cordova

使用 iPhone App 的电话间隙。当设备具有 iOS 版本 5.1.1 时，我的应用程序顶部栏上的按钮不起作用。在更高版本以及 5.1.1 上的模拟器上运行良好。

按下这些按钮根本没有效果。只要不在顶部栏上，整个应用程序中的所有其他按钮都可以在 5.1.1 上正常工作。

关于错误原因或潜在修复的任何想法？

# iphone - 网站有没有办法检测 iOS 用户的“区域格式”？

> ID：14390539
> 
> 赞同：1
> 
> 时间：2013-01-18T00:21:17.367
> 
> 标签：iphone, ios, ipad, safari, regional-settings

网站有没有办法检测 iOS 用户的“区域格式”？

设置 > 国际 > 区域格式

如果是这样，使用的环境变量是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:33:10.713

这应该会影响语言环境：

```
window.navigator.language //=> "en-us" 
```

就我而言，witten 语言是`en`，区域格式是`us`.

此链接在您的 iPhone 上应提醒设备区域设置：http: [//jsfiddle.net/reHED/](http://jsfiddle.net/reHED/)

# c - C 指针数组和 malloc

> ID：14390547
> 
> 赞同：3
> 
> 时间：2013-01-18T00:22:01.227
> 
> 标签：c, pointers, malloc

我正在尝试使用指针从存储到数组中的 std 获取数据。main 将 d 声明为`int *d;`并使用调用该函数`x = getdata(&d);`当我使用 gdb 逐步执行它时，它在 for 循环的第一次迭代中死亡，当它尝试 *d[i]=val;

```
int getdata(int **d)
{ 
    int count,val,i,j=0; 

    scanf("%d", &count);

    d = malloc(sizeof *d * count);
    for( i = 0; i < count-1; i++) {

    scanf("%d",val);

    *d[i]=val;  

    }

    for ( i = 0; i < count; i++)
            printf("Number %d\n",*d[i]);

    return count; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:27:25.693

您拥有的是指向数组的指针，而不是指针数组。

1)`malloc`返回一个 void* 所以你需要将结果分配给`*d`而不是`d`

2）你想要的数据大小是一个`int`，而不是一个`int*`（使用`*d`让你`int*`知道 where`**d`是一个 int）

```
*d = malloc(sizeof(**d) * count); 
```

3) 索引数组需要稍微不同的语法

```
(*d)[i] = val;

printf("%d\n", (*d)[i]); 
```

4）第二个scanf需要一个指针，而不是一个int

```
scanf("%d", &val); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T00:28:20.310

```
*d = malloc(count * sizeof(int)); 
```

然后

```
(*d)[i] = val 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T00:35:42.653

内存应按如下方式分配

```
*d = malloc(count * sizeof **d); 
```

应按如下方式访问这些值

```
(*d)[i] = val; 
```

也不清楚为什么要分配`count`元素并仅在输入周期中初始化`count - 1`元素（然后`count`在输出周期中打印所有元素）。

# maven - 开始 Spring 3 和错误执行应用程序

> ID：14390550
> 
> 赞同：1
> 
> 时间：2013-01-18T00:22:45.313
> 
> 标签：maven, ubuntu, spring-3, sts-springsourcetoolsuite

我尝试在我的 Ubuntu 机器上运行[Spring 3 Hello World 教程，但遇到了一些问题。](http://www.mkyong.com/spring3/spring-3-hello-world-example/)

首先，我正在开发 Springsource ToolSuite 3.1.0 版本，并在我的机器上安装了 Maven。我已经在同一个站点上浏览了一个带有 Maven 的 Java 应用教程。

首先，Maven 不应该解决依赖问题吗？当我写

```
import org.springframework.*; 
```

我收到一条错误消息，指出无法找到该库，因此我必须手动将 JAR 本身添加到构建路径以解决该问题。尽管构建路径向导中存在许多 .m2/REPO 库路径。

`mvn --version`返回

```
jason@asus:~/IDE/springsource/sts-3.1.0.RELEASE/plugins$ mvn --version
Apache Maven 3.0.4
Maven home: /usr/share/maven
Java version: 1.6.0_24, vendor: Sun Microsystems Inc.
Java home: /usr/lib/jvm/java-6-openjdk-i386/jre
Default locale: en_US, platform encoding: UTF-8
OS name: "linux", version: "3.5.7-03050702-generic", arch: "i386", family: "unix" 
```

其次，当从命令行执行时，我得到这个打印输出：

```
jason@asus:~/Documents/workspace-sts-/SpringExample$ java -cp target/SpringExample-1.0-SNAPSHOT.jar com.jasonjohns.App
Exception in thread "main" java.lang.NoClassDefFoundError: org/springframework/beans/factory/BeanFactory
  at java.lang.Class.getDeclaredMethods0(Native Method)
  at java.lang.Class.privateGetDeclaredMethods(Class.java:2442)
  at java.lang.Class.getMethod0(Class.java:2685)
  at java.lang.Class.getMethod(Class.java:1620)
  at sun.launcher.LauncherHelper.getMainMethod(LauncherHelper.java:492)
  at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:484)

Caused by: java.lang.ClassNotFoundException: org.springframework.beans.factory.BeanFactory
  at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
  at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
  at java.security.AccessController.doPrivileged(Native Method)
  at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
  at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
  at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
  at java.lang.ClassLoader.loadClass(ClassLoader.java:356) 
```

可以肯定的是，我检查了 STS/plugins 文件夹，那里有一个`org.springframework.beans_3.1.1.RELEASE.jar`。

我的 pom.xml 是

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
    <groupId>com.jasonjohns</groupId>
    <artifactId>SpringExample</artifactId>
    <packaging>jar</packaging>
    <version>1.0-SNAPSHOT</version>
    <name>SpringExample</name>
    <url>http://maven.apache.org</url>
<dependencies>
  <dependency>
    <groupId>junit</groupId>
    <artifactId>junit</artifactId>
    <version>3.8.1</version>
    <scope>test</scope>
  </dependency>

  <!--  Spring 3 Dependencies  -->
  <dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-core</artifactId>
    <version>3.1.1.RELEASE</version>
  </dependency>

  <dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-context</artifactId>
    <version>3.1.1.RELEASE</version>
  </dependency>
</dependencies>
</project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:37:46.617

我会尝试在终端中导航到您项目的位置，然后执行`mvn eclipse:eclipse`. 这将（重新）生成特定于 Eclipse/Spring Tool Suite 的文件 - 本质上是创建 .classpath 和 .project 文件（参见[http://maven.apache.org/plugins/maven-eclipse-plugin/eclipse-mojo.html](http://maven.apache.org/plugins/maven-eclipse-plugin/eclipse-mojo.html)）。

.classpath 本质上是您的构建路径，通过运行**eclipse:eclipse** maven 将根据您的 pom.xml 的内容为您生成它。

完成后，在 Eclipse/STS 中刷新项目。确保勾选自动构建（项目->自动构建）。

# xml - 如何从 CakePHP 将 XML 格式的 POST DATA 发送到外部 URL

> ID：14390556
> 
> 赞同：0
> 
> 时间：2013-01-18T00:23:14.867
> 
> 标签：xml, forms, api, cakephp, post

我正在使用 CakePHP 编写一个使用来自 web 服务的数据的应用程序。网络服务 API 告诉我需要将我的 POST DATA 作为 XML 发送，如下所示：

```
<Request>
    <Key>abcd123</Key>
    <Param1>myval</Param1>
</Request> 
```

请问如何使用 CakePHP 实现这一点？我尝试过这样的事情：

```
echo $this->Form->create(Model, array('url' => 'https://myprovider/API/myuserid'));
echo $this->Form->input('Key', array('value'=> 'abcd123'));
echo $this->Form->input('Param1', array('value'=> 'myval'));
echo $this->Form->end('Submit'); 
```

但是如何在提交之前将 POST 数组转换为 xml？

提前谢谢了，

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T05:46:56.600

在 CakePHP 中使用 HttpSocket 将 POST 数组作为 xml 发送

```
App::uses('HttpSocket', 'Network/Http');
App::uses('Xml', 'Utility');
$http = new HttpSocket();
$http->configAuth('Basic', 'user', 'password'); //optional, if needs authentication
$xml_data = Xml::fromArray($this->request->data);
$xml_string = $xml_data->asXML();
$http->post('https://myprovider/API/myuserid', $xml_string); 
```

# google-apps-script - 当单元格等于特定值时，在相邻单元格中添加时间戳

> ID：14390558
> 
> 赞同：0
> 
> 时间：2013-01-18T00:23:15.243
> 
> 标签：google-apps-script, google-drive-api, google-apps

我有一个项目跟踪工具。K 列有一个任务完成时的下拉菜单。下拉菜单可以选择将任务设置为“未交付”或“已交付”。我想对 L 列进行编程，以便每当有人选择“已交付”任务时，我都有该操作的时间戳。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:59:20.087

您可以使用附加到电子表格的脚本来执行此操作。如果您不熟悉电子表格中的 Google Apps-Script，请参阅[教程。](https://developers.google.com/apps-script/articles)

这是执行您所描述的电子表格的图片：

![工作电子表格的屏幕截图](../Images/6246d9202ce8a98a8fe7e3776d730a3b.png)

下面的脚本将通过在 L 列中写入或清除时间戳来对 K 列中的更改做出反应。由于电子表格中的每次更改都会调用它，因此它所做的第一件事是检查是否发生了我们关心的更改，如果没有发生则退出.

```
/**
 * This function is an auto-trigger, because of its name. It will be
 * invoked on every change in the spreadsheet. The only change that
 * we're interested in is in Column K, and we want to put a timestamp
 * into Column L if the value selected for Column K is "Completed".
 */
function onEdit(event){
  var ColK = 11;  // Column Number of "K"

  var changedRange = event.source.getActiveRange();
  if (changedRange.getColumn() == ColK) {
    // An edit has occurred in Column K
    var state = changedRange.getValue();
    var adjacent = event.source.getActiveSheet().getRange(changedRange.getRow(),ColK+1);
    var timestamp = new Date(); // Get the current time
    // We'll do something different, depending on the selected value
    switch (state) {
      case "Completed":
        // Write timestamp into adjacent cell
        adjacent.setValue(timestamp);
        break;
      case "Not Completed":
        // Erase timestamp in adjacent cell
        adjacent.clearContent();
        break;
      default:
        // Something we didn't expect
        adjacent.setValue("*ERROR*");
        break
    }
  }
} 
```

要做的事情：此脚本假定您只更改了一个单元格，这意味着将值复制到多个单元格的处理不正确。

# mysql - 用于队列分析的 MySQL JOIN

> ID：14390563
> 
> 赞同：0
> 
> 时间：2013-01-18T00:23:53.420
> 
> 标签：mysql, sql

我有两个表可以使用，USERS，METRICS_DAILY

mysql> 描述用户；

```
+---------------------------+---------------------+------+-----+------------------------------------------+----------------+
    | Field                     | Type                | Null | Key | Default                                  | Extra          |
    +---------------------------+---------------------+------+-----+------------------------------------------+----------------+
    | USER_ID                   | int(11) unsigned    | NO   | PRI | NULL                                     | auto_increment |
    | CREATED                   | timestamp           | NO   |     | CURRENT_TIMESTAMP|
+---------------------------+---------------------+------+-----+------------------------------------------+----------------+ 
```

mysql> 描述 METRICS_DAILY；

```
+---------+----------------------+------+-----+---------+-------+
| Field   | Type                 | Null | Key | Default | Extra |
+---------+----------------------+------+-----+---------+-------+
| USER_ID | int(11) unsigned     | NO   | PRI | NULL    |       |
| EVENT   | tinyint(3) unsigned  | NO   | PRI | NULL    |       |
| DATE    | date                 | NO   | PRI | NULL    |       |
| COUNT   | smallint(5) unsigned | NO   |     | 0       |       |
+---------+----------------------+------+-----+---------+-------+ 
```

我需要选择计数不同的 USER_ID，其中 DATE=DATE(NOW()) 和 (x,y,z) 中的事件和 USERS.CREATED 是月 1、月 2、月 3、...月当前。

我几乎可以完全在 METRICS_DAILY 表中完成它，因为我的 DATE 与 USERS.CREATED 相对应，只是间接地。

Created 是一个完整的时间戳。我需要按月将其分解为同类群组。

这是一个开始：

SELECT count(distinct METRICS_DAILY.USER_ID),CREATED,MONTH(CREATED),DATE FROM METRICS_DAILY LEFT JOIN USERS ON (METRICS_DAILY.USER_ID = USERS.USER_ID) where EVENT > 10 and DATE=DATE(NOW()) group by MONTH(CREATED );

```
+---------------------------------------+---------------------+----------------+------------+
| count(distinct METRICS_DAILY.USER_ID) | CREATED             | MONTH(CREATED) | DATE       |
+---------------------------------------+---------------------+----------------+------------+
|                                     3 | 2013-01-14 09:35:16 |              1 | 2013-01-18 |
|                                    16 | 2012-12-15 07:07:49 |             12 | 2013-01-18 |
+---------------------------------------+---------------------+----------------+------------+ 
```

2 行（0.00 秒）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T16:25:58.697

像这样的东西？

```
SELECT MONTHNAME(u.CREATED), YEAR(u.CREATED), COUNT(*) AS UserCount
FROM METRICS_DAILY md
JOIN USERS u
ON u.USER_ID = md.USER_ID
WHERE md.DATE = NOW() AND md.EVENT in (x,y,z)
GROUP BY MONTHNAME(u.CREATED), YEAR(u.CREATED) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T01:20:04.000

```
SELECT DATE(`METRICS_DAILY`.`DATE`) AS `Day of DATE`, `METRICS_DAILY`.`EVENT` AS `EVENT`, COUNT(DISTINCT `METRICS_DAILY`.`USER_ID`) AS `Number of unique User Id`
  FROM METRICS_DAILY
  JOIN USERS ON `METRICS_DAILY`.`USER_ID` = `USERS`.`USER_ID`
  WHERE (`METRICS_DAILY`.`EVENT` >= "31") AND (`METRICS_DAILY`.`DATE` BETWEEN "2012-12-01" AND "2012-12-31") AND (`USERS`.`CREATED` BETWEEN CAST("2012-12-01" AS DATETIME) AND CAST(CONCAT("2012-12-31", " 23:59:59") AS DATETIME))
  GROUP BY DATE(`METRICS_DAILY`.`DATE`), `METRICS_DAILY`.`EVENT`
  ORDER BY `Day of DATE` ASC, `EVENT` ASC; 
```

# node.js - 如何理解node_redis中的参数？

> ID：14390569
> 
> 赞同：0
> 
> 时间：2013-01-18T00:24:22.163
> 
> 标签：node.js, redis, node-redis

全部

我正在研究node_redis，在examples/simple.js中，有如下代码：

```
1    client.hset("hash key", "hashtest 1", "some value", redis.print);
2    client.hset(["hash key", "hashtest 2", "some other value"], redis.print);
3    client.hkeys("hash key", function (err, replies) {
4        console.log(replies.length + " replies:");
5        replies.forEach(function (reply, i) {
... 
```

我很困惑：

为什么第 3 行有两个参数 "(err, replies)" ，设计师定义了多少参数？

或者你想指导我应该读什么书或其他东西来理解它们？先感谢您！

最好的祝福

彭CZ

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T15:13:23.060

function (error, data..) 是 node.js 中回调参数的事实标准。

如果操作成功完成，error 为 null，replies 是带有哈希键的数组。如果有错误，则错误包含详细信息并且不填写回复。

这就是你要问的吗？

# java - 如何使用嵌入式码头添加 servlet 过滤器

> ID：14390577
> 
> 赞同：26
> 
> 时间：2013-01-18T00:24:53.637
> 
> 标签：java, jetty, servlet-filters, embedded-jetty

我将码头嵌入到我的应用程序中，并试图弄清楚如何添加 servlet 过滤器（用于 cookie 处理）。wiki 和 javadoc 并没有说得很清楚，我错过了什么：

```
Server server = new Server(port);
ServletContextHandler context = new ServletContextHandler(ServletContextHandler.SESSIONS);
context.setContextPath("/");
FilterHolder f = new FilterHolder(new AuthorisationFilter());
context.addFilter(... f ...); // ?????
context.addServlet(new ServletHolder(new TestServlet()), "/"); 
```

我在这方面找到的唯一信息是一个[论坛帖子，建议](http://comments.gmane.org/gmane.comp.java.jetty.support/14244)需要改进这方面的文档。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-05-23T08:31:30.207

我遇到了同样的问题，但我认为 Καrτhικ 的答案太复杂了。我发现了这个简单的方法：

```
Server server = new Server(8080);
ServletContextHandler context = new ServletContextHandler(ServletContextHandler.SESSIONS);
context.setContextPath("/");
context.addServlet(org.eclipse.jetty.servlet.DefaultServlet.class, "/");
context.addFilter(AppFilter.class, "/*", EnumSet.of(DispatcherType.INCLUDE,DispatcherType.REQUEST));

server.setHandler(context);
server.start();
server.join(); 
```

我的码头版本是`8.1.14.v20131031`.

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-01-18T14:21:25.787

更新：对于 Jetty 版本 9.2.2：

```
 Server server = new Server();

    // Note: if you don't want control over type of connector, etc. you can simply 
    // call new Server(<port>);
    ServerConnector connector = new ServerConnector(server);
    connector.setHost("0.0.0.0");
    connector.setPort(8085);
    // Setting the name allows you to serve different app contexts from different connectors.
    connector.setName("main");
    server.addConnector(connector);

    WebAppContext context = new WebAppContext();
    context.setContextPath("/");
    // For development within an IDE like Eclipse, you can directly point to the web.xml
    context.setWar("src/main/webapp");
    context.addFilter(MyFilter.class, "/", 1);

    HandlerCollection collection = new HandlerCollection();
    RequestLogHandler rlh = new RequestLogHandler();
    // Slf4j - who uses anything else?
    Slf4jRequestLog requestLog = new Slf4jRequestLog();
    requestLog.setExtended(false);
    rlh.setRequestLog(requestLog);
    collection.setHandlers(new Handler[] { context, rlh });
    server.setHandler(collection);

    try {
        server.start();
        server.join();
    } catch (Exception e) {
        // Google guava way
        throw Throwables.propagate(e);
    } 
```

原始答案===

如果您不想使用 web.xml，请使用以下命令：

```
SocketConnector socketConnector = new SocketConnector();
socketConnector.setPort(7000); // Change to port you want
Server server.setConnectors(new Connector[] { socketConnector });

WebAppContext webapp = new WebAppContext();

webapp.setContextPath("/"); // For root
webapp.setWar("/"); // Appropriate file system path.

// Now you can use the various webapp.addFilter() methods
webapp.addFilter(MyFilter.class, "/test", 1); // Will serve request to /test.
// There are 3 different addFilter() variants.

// Bonus ... request logs.
RequestLogHandler logHandler = new RequestLogHandler();
NCSARequestLog requestLog = new NCSARequestLog("/tmp/jetty-yyyy_mm_dd.request.log");
requestLog.setRetainDays(90);
requestLog.setAppend(true);
requestLog.setExtended(false);
requestLog.setLogTimeZone("GMT");
logHandler.setRequestLog(requestLog);

logHandler.setHandler(webapp);

HandlerList handlerList = new HandlerList();
handlerList.addHandler(logHandler);

server.setHandler(handlerList);

server.start(); 
```

如果您确实想使用 web.xml，而不是 addFilter() 方法，只需确保您的 webapp 根路径中有一个 WEB-INF/web.xml，并带有以下 xml：

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE web-app
   PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
   "http://java.sun.com/dtd/web-app_2_3.dtd">

<web-app>
    <filter>
        <filter-name>filterName</filter-name>
        <filter-class>com.x.y.z.FilterClass</filter-class>
    </filter>
    <filter-mapping>
        <url-pattern>/test</url-pattern>
        <filter-name>filterName</filter-name>
    </filter-mapping>
</web-app> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-08T21:44:46.150

这些`ServletContextHandler.addFilter(...)`方法只是方法的便利包装`ServletHandler.addFilter(...)`。只要您只需要一个`<url-pattern>`，它们*就*非常方便。但是，如果您需要多个模式或选择`<servlet-name>`改用，您将需要更多类似的东西：

```
ServletContextHandler context = new ServletContextHandler(
        ServletContextHandler.SESSIONS);

FilterMapping mapping = new FilterMapping();
mapping.setFilterName( "Foobar Filter" );
mapping.setPathSpecs( new String[] { "/foo/*", "/bar/*" } );
mapping.setServletNames( new String[] { "foobar" } );
mapping.setDispatcherTypes(
        EnumSet.of( DispatcherType.INCLUDE,DispatcherType.REQUEST ) ) );

FilterHolder holder = new FilterHolder( FoobarFilter.class );
holder.setName( "Foobar Filter" );

context .getServletHandler().addFilter( holder, mapping ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-21T18:50:59.830

更新为 java 11 而不是 javax。使用雅加达。和 11.0.3 用于码头

```
ServletHolder servletHolder = new ServletHolder(DefaultServlet.class);
servletHolder.setInitParameter("resourceBase","./resource");
servletHolder.setInitParameter("dirAllowed", "false");
servletHolder.setInitParameter("pathInfoOnly", "true");
servletHandler.addServlet(servletHolder, "/api/source/*");
FilterHolder f = new FilterHolder(new MyFilter());
servletHandler.addFilter(MediaFilter.class, "/api/source/*",     
EnumSet.allOf(DispatcherType.class)); 
```

# c# - 使用 C# 编辑 sql 数据库记录

> ID：14390579
> 
> 赞同：0
> 
> 时间：2013-01-18T00:24:57.467
> 
> 标签：c#, sql, sql-server, visual-studio-2010, sql-server-2012

我创建了一个连接到小型数据库的小软件。我正在使用 c# 和 winfroms 连接到本地 sql 服务器并显示数据库，`datagridview`到目前为止，我已经成功地将记录添加到数据库并选择一条记录进行编辑。

因此，当我选择要编辑的记录并编辑想要的字段时，然后单击编辑按钮，理论上应该更新已编辑的记录。但是，当我这样做时，我似乎面临以下错误：（见图 1）

图。1![在此处输入图像描述](../Images/9848e25beffd467c94b1a4b34cd2cffd.png)

我似乎无法弄清楚为什么会发生此错误。任何帮助将非常感激

界面：（图2）

图2![在此处输入图像描述](../Images/df046f3661e9c0630df86ea49301ab8d.png)

执行编辑 btnEdit 的代码：

```
 private void btnEdit_Click(object sender, EventArgs e)
        {
            try
            {
                //Open Connection
                sc.Open();
                DataTable dt = new DataTable();
                SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM myEmployees WHERE EmpID" + 
                    txtID.Text + " ", sc);
                da.Fill(dt);

                //start the editing of the selected record
                dt.Rows[0].BeginEdit();

                dt.Rows[0][1] = txtFName.Text;
                dt.Rows[0][2] = txtLName.Text;
                dt.Rows[0][3] = txtJRole.Text;
                dt.Rows[0][4] = txtEmp.Text;
                //dt.Rows[0][1] =

                //stop editing
                dt.Rows[0].EndEdit();

                //sql commandbuilder that allow saving of records
                SqlCommandBuilder cb = new SqlCommandBuilder(da);

                //update the database
                da.Update(dt);

                //close connection
                sc.Close();

                loadEmp();
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Error);
                // Application.ExitThread();
            }
        } 
```

datagridview cick 事件，它负责编辑记录选择：

```
private void dgEmployees_Click(object sender, EventArgs e)
        {
            try
            {

                DataTable dt = new DataTable();
                SqlDataAdapter slctRow = new SqlDataAdapter("SELECT * FROM myEmployees WHERE EmpID=" +
                Convert.ToInt16(dgEmployees.SelectedRows[0].Cells[0].Value.ToString()) + " ", sc);
                slctRow.Fill(dt);

                //display records into textboxes
                txtID.Text = dt.Rows[0][0].ToString();
                txtFName.Text = dt.Rows[0][1].ToString();
                txtLName.Text = dt.Rows[0][2].ToString();
                txtJRole.Text = dt.Rows[0][3].ToString();
                txtEmp.Text = dt.Rows[0][4].ToString();

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Error);
                // Application.ExitThread();
            }

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:28:15.040

抛开参数化问题不谈 - 你错过了一个`=`：

```
SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM myEmployees WHERE EmpID="+ 
                txtID.Text + " ", sc); // WARNING: SQL INJECTION RISK 
```

然而; 我*强烈*建议您查看参数化。例如，如果我输入（在该文本框中）会发生什么：

```
0; delete from myEmployees -- 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:27:38.057

尝试在in`=`之后添加：`EmpID``btnEdit_Click`

```
 SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM myEmployees WHERE EmpID=" + 
                    txtID.Text + " ", sc); 
```

# spring - RequestParameter 编码字符串

> ID：14390580
> 
> 赞同：1
> 
> 时间：2013-01-18T00:25:13.713
> 
> 标签：spring, controller, get, encode, http-request-parameters

我有一个带有 RequestParam 作为字符串的控制器，它是 BASE64 编码的，它包含多次“+”字符（类似于“domain.com/request?code=sdfesdfd+23fewrfr3”）。当我尝试在控制器方法主体中打印“代码”值时，它会打印将“+”替换为空格“”的值（在示例中为“sdfesdfd 23fewrfr3”）。我怎样才能避免出现这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:48:49.430

如果可以的话，通过 URLEncoder 运行字符串...

[http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html)

...如果您不能这样做，请尝试使用百分比编码....

[http://en.wikipedia.org/wiki/Percent-encoding](http://en.wikipedia.org/wiki/Percent-encoding)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-18T00:43:14.903

用“+”替换所有空格？

```
 code.replaceAll(" ", "+"); 
```

# java - 静态成员和非静态成员是分开的吗？

> ID：14390584
> 
> 赞同：0
> 
> 时间：2013-01-18T00:25:29.543
> 
> 标签：java, non-static, static

所以我得到了这个类：

```
package src;

import java.util.ArrayList;
import java.util.List;
import org.lwjgl.util.vector.Vector3f;

public class Model {
    public List<Vector3f> Vertices = new ArrayList<Vector3f>();
    public List<Vector3f> Normals = new ArrayList<Vector3f>();
    public List<Face> Faces = new ArrayList<Face>();

    public static Model LoadModel()
    {
        return new Model();
    }
} 
```

LoadModel 方法会影响任何 Model 对象吗？LoadModel 方法还没有完成！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T10:10:04.637

> 静态成员和非静态成员是分开的吗？

是的。它们与类相关联，而不是与单个实例相关联。

> LoadModel 方法会影响任何 Model 对象吗？

它将创建一个新的。

> LoadModel 方法还没有完成！

我不知道这是什么意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:31:35.380

不确定我是否完全理解你的问题，伙计。

LoadModel 是一个静态方法——这意味着该方法“属于”类。简而言之，有人可以这样做：

```
 Model model = Model.LoadModel(); 
```

LoadModel 将创建一个 Model 对象——它将实例化 Vertices、Normals 和 Faces 对象。

如此简短的回答：不，它不会影响 - 它只会导致模型对象及其内部对象被实例化，并且模型的新实例将返回给调用者。

希望我已经回答了你的问题。

# c# - 带有可移植数据库的简单 CRUD 应用程序

> ID：14390592
> 
> 赞同：2
> 
> 时间：2013-01-18T00:25:48.883
> 
> 标签：c#, .net, database, application-design, portable-database

经过大量搜索，我将在这里提出我的问题。如果有重复并且我的 search-foo 能力使我失败，我会很乐意顺从它。关于这个问题。

我在服务和 Web 应用程序方面拥有丰富的背景，以“始终在线”的方式使用集中式数据库服务器。但是，我的一个朋友需要一个简单的 CRUD 应用程序（可能是 C#，因为我对其他 GUI 库/API 的经验有限）来替换他目前拥有的昂贵的解决方案。

应用程序本身非常简单，我计划使用 Dropbox 作为网络层以使其更简单。我无法解决的问题是我需要一种处理便携式数据库以进行身份​​验证/授权的好方法。我正在考虑将 SQL Lite 存储在 Dropbox 内的只读文件夹中，以便在连接到互联网时保持最新状态，但不需要网络连接即可运行（使用该程序时它们并不总是有互联网）。

我正在寻找具有类似设计的建议、阅读材料或经验作为起点。

感谢您花时间提供帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T03:23:39.920

我推荐 Sqlite。适用于几乎所有平台，并且非常易于使用。对于 .NET，我使用微型 ORM，例如 Dapper。

这是一个例子：[http ://blog.maskalik.com/asp-net/sqlite-simple-database-with-dapper](http://blog.maskalik.com/asp-net/sqlite-simple-database-with-dapper)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T03:18:43.283

您还可以使用 SQL Server Compact Edition (SQLCE) 快速实现这一目标。VS 为设计人员提供了制作 SQLCE 数据库文件的功能，ADO.NET 也可以很好地使用它。它还支持简单的复制。

# arrays - （反）将对象序列化为 XStream 中的数组

> ID：14390595
> 
> 赞同：1
> 
> 时间：2013-01-18T00:26:23.863
> 
> 标签：arrays, refactoring, xstream

我试图通过用适当的对象替换一些正在传递的数组来清理一些旧代码，以提高可读性并封装一些行为。当事实证明数组正在通过 XStream 运行以实现持久性时，我遇到了一个问题。

我需要保留序列化的格式，并且有问题的数组位于通过 XStream 进行（反）序列化的各种其他对象中。有没有简单的方法来处理这个？

我希望有一个我可以应用的 Annotation 或一个简单的 XStream`Converter`我可以为我的新类编写并完成它，但据我所见，它需要`Converter`为每个包含类编写 s 。我不确定，因为我不熟悉 XStream。如果没有简单的解决方案，我将不得不放弃并将数组留在原处，因为我没有时间预算用于任何花哨的事情或学习 XStream 的细节。

具体来说，我有`TileLayer`一个成员`int[] metaTileFactors`，我想用`MetaTiling`具有成员的类替换它`final int x`，`final int y`并且仍然让它像以前一样序列化和反序列化到/从相同的 XML。

# jquery - iFrame jQuery - 在加载新的 iFrame 内容时父滚动到 iFrame 的顶部

> ID：14390599
> 
> 赞同：0
> 
> 时间：2013-01-18T00:26:43.543
> 
> 标签：jquery, iframe, scroll

这是我在加载到父页面的 iFrame 中加载的脚本。

**问题：** 我希望它在每次点击 iFrame 中的指定内容时滚动到 iframe 的顶部，同时具有 iFrame 更改页面的内容。

（例如我点击 iFrame 中的提交按钮以在 iFrame 中加载新内容。同时父页面滚动到 iFrame 的顶部）

我给 iFrame 一个 id 为“iFrame”。当我单击 iFrame 中名为“imageField”的元素时，它将提交一个表单并在 iframe 中加载新内容。但我也希望它在加载 iframe 的主页上滚动到 iFame 的顶部。

原因是因为某些内容较大，当他们从 iFrame 中的较大内容点击提交时，它会转到较小的内容，因为他们必须滚动完成主页才能看到内容，因此看起来屏幕是空白的。因此，当新的 iFrame 内容正在加载时，我希望托管 iFrame 的主页滚动到 iFrame 的顶部。

**这是 iFrame 中的代码：**

```
<script>
    $(document).ready(function (){

        $("#imageField").click(function (){

                $('html, body').animate(
                    {
                    scrollTop: $("#iFrame").offset().top
                     }, 2000);

        });
    });
</script> 
```

**我的 iFrame 代码：**

```
<iframe src="questions/questions.php" name="inlineframe" width="550"
marginwidth="5"  height="1500" marginheight="5" scrolling="auto" 
frameborder="0" id="iFrame" ></iframe> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-12T05:52:37.990

尝试这个：

在主页上，放置一个javascript函数：

```
// This is main page
<script type="text/javascript">        
    function scrollFrame(position) {
        position += $('#myFrameID').offset().top;
        $('body').animate({ scrollTop: position }, 1000);
    }
</script> 
```

在 iframe 内的子页面上，将 javascript 更改为

```
 $("#imageField").click(function () {
        if (window != window.top) // the page is inside iframe
            window.top.scrollFrame(0); // change the position if any. 0 is top
    }); 
```

# java - 如何检索动态生成的网页元素？

> ID：14390603
> 
> 赞同：1
> 
> 时间：2013-01-18T00:27:22.253
> 
> 标签：java, android, jsoup

我使用 Jsoup 获取网站。这是网络的链接：

[http://www.yelp.com/search?find_desc=restaurants&find_loc=westmont%2C+il&ns=1&ls=43131f934bb3adf3#find_loc=Hinsdale,+IL&l=p:IL:Hinsdale::&sortby=rating&unfold=1](http://www.yelp.com/search?find_desc=restaurants&find_loc=westmont%2C+il&ns=1&ls=43131f934bb3adf3#find_loc=Hinsdale,+IL&l=p:IL:Hinsdale::&sortby=rating&unfold=1)

现在我正在尝试提取网络上的子页面数量。例如下图“转到页面”旁边的数字：![在此处输入图像描述](../Images/b55431302e866465a553aa33dd7d125c.png)

不幸的是，浏览器中的“查看源代码”或 Jsoup 都无法看到这些元素。我猜这个内容是动态嵌入到网络中的。如果是这样，访问动态生成的网络的最佳方式是什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T03:39:12.633

对于使用 AJAX/JS Libraries 技术生成内容的网站，您可能希望使用 HTMLUnit 代替（HTMLUnit 可以模拟 Javascript 事件）。JSoup 仅适用于静态 HTML，或者您可以通过 viewsource 接收的内容。

# python - Python 请求 SSL 问题

> ID：14390605
> 
> 赞同：8
> 
> 时间：2013-01-18T00:27:27.853
> 
> 标签：python, ssl, connect, python-requests

自从我开始为此寻找解决方案以来已经有好几天了。

我一直在尝试使用请求通过代理发出 https 请求，但没有成功。

尽管这包含在我的一个更大的项目中，但这一切都归结为：

```
 import requests

    prox = 'xxx.xxx.xxx.xxx:xxx' # fill in valid proxy

    r = requests.get('https://ipdb.at', proxies={'http': prox,
                                                 'https': prox}) 
```

我尝试了 kward verify=False 但我不断收到相同的错误或它的变体：

```
 Traceback (most recent call last):
      File "/Users/mg/Desktop/proxy_service.py", line 21, in <module>
        verify=False)
      File "/Library/Python/2.7/site-packages/requests/api.py", line 55, in get
        return request('get', url, **kwargs)
      File "/Library/Python/2.7/site-packages/requests/api.py", line 44, in request
        return session.request(method=method, url=url, **kwargs)
      File "/Library/Python/2.7/site-packages/requests/sessions.py", line 279, in request
        resp = self.send(prep, stream=stream, timeout=timeout, verify=verify, cert=cert, proxies=proxies)
      File "/Library/Python/2.7/site-packages/requests/sessions.py", line 374, in send
        r = adapter.send(request, **kwargs)
      File "/Library/Python/2.7/site-packages/requests/adapters.py", line 213, in send
        raise SSLError(e)
    requests.exceptions.SSLError: [Errno 1] _ssl.c:504: error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol
    [Finished in 20.4s with exit code 1] 
```

我正在为 python 使用最新版本的 requests 和 openssl 和 2.7.3。我在 mac mountain lion 10.8.2 和 Windows 7 上对其进行了测试。

我用谷歌搜索了这个，看到其他人有类似的问题。我在库请求和 urllib3 上发现了相关的拉取请求，还看到了有关这是 http 连接动词的错误实现的信息。我找到了一个使用自定义适配器的修复程序（我不记得确切，但我认为这是正确的术语）来使用自定义 ssl 协议。都试过了，都没有帮助。

所以，我正在寻找更多信息。你知道发生了什么吗，我可以修复它，等等，等等......

欢迎所有帮助，谢谢大家！

PS：我尝试了几个代理，我确定它们不是问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-23T16:01:13.847

我遇到了同样的问题，但是在尝试使用 oauth2client（谷歌库，用于针对他们的 API 使用 oauth2）时。经过一天的 faffing（“实验”），我发现我的 env 变量设置如下：

```
https_proxy=https://your-proxy:port 
```

将此更改为

```
https_proxy=http://your-proxy:port 
```

完全为我解决了这个问题。大概这意味着从客户端到代理的初始握手现在是未加密的，但此后 https 必须直接流动。无论如何，我不相信我的公司代理配置为使用 https。

但是请注意，我的浏览器在之前的设置下都表现良好。也许他们在使用 https 失败后默默地尝试通过 http 建立代理连接。

谷歌搜索显示了将 https_proxy 设置为同等程度的 http 或 https 地址的示例。我想这取决于代理的配置方式。

浏览器/操作系统配置弹出窗口中的“用于所有协议”按钮很容易意外使用我的设置。

但是我不确定这是否是你的问题。您的代码表明您已经对 http 和 https 使用完全相同的代理设置。

顺便说一句，这一切都在 Ubuntu 12.04.1 上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-15T23:48:19.317

此处的答案对我 [有用，使用带有 TLS 的请求并没有提供 SNI 支持](https://stackoverflow.com/questions/18578439/using-requests-with-tls-doesnt-give-sni-support)

我安装了三个依赖库，并在第二个答案中包含了猴子补丁提示

# virtualbox - 更改已挂载子文件夹的权限

> ID：14390608
> 
> 赞同：1
> 
> 时间：2013-01-18T00:27:43.040
> 
> 标签：virtualbox, mount, shared-directory

我在 VirtualBox VM 中使用 windows 7 作为主机和 debian 6。安装来宾添加以共享主机系统提供的文件夹。在 debian 中运行一个网络服务器。到目前为止一切都很好。但也需要更改子文件夹的权限。共享文件夹安装有

```
mount -t vboxsf -o permissions,umask=0000,uid=33,gid=33 webdev /var/www 
```

有没有办法实现这一点？另一种方法是在来宾系统上共享 samba，但这会很慢。

# c# - C# Rect 类 y 轴未正确创建

> ID：14390609
> 
> 赞同：0
> 
> 时间：2013-01-18T00:27:56.643
> 
> 标签：c#, silverlight, geometry, geocoding

我在 C# 中用两点创建一个 Rect。这些点实际上是地理界限。我遇到的问题是，当我创建矩形时，y 轴被翻转。

例如说我的数据是`west="5.42194487004" south="46.407494" east="17.166386" north="55.056664"`

我把它传给`Rect geoBounds = new Rect(new Point(west, north),new Point(east, south));`

创建的 Rectangle 具有以下属性

```
 Bottom  55.056664          double
    Height  7.781945           double
    IsEmpty false              bool
    Left    5.864166           double
    Right   15.038887000000003 double
    Top     47.274719          double
    Width   9.1747210000000017 double
    X       5.864166           double
    Y       47.274719          double 
```

Y 轴翻转。我已经三重检查了输入呼叫的数据是否正确。怎么了？我也知道我没有提供太多代码，但觉得不需要更多代码。如果需要，将提供更多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:36:08.343

坐标系在屏幕左上角有 0,0，Y 向下增加。`Rect.Bottom`您可以在该属性的示例页面上看到这一点：http: [//msdn.microsoft.com/en-us/library/system.windows.rect.bottom.aspx](http://msdn.microsoft.com/en-us/library/system.windows.rect.bottom.aspx)

请注意该页面上的此评论：

```
// Bottom property gets the y-axis value of the bottom of the rectangle.  
// For this rectangle the value is 55.
rectInfo = rectInfo + "Bottom: " + myRectangle.Bottom; 
```

和这个：

```
// Top property gets the y-axis position of the top of the rectangle which is  
// equivalent to getting the rectangle's Y property. 
// For this rectangle the value is 5.
rectInfo = rectInfo + "| Top: " + myRectangle.Top; 
```

显式构造函数进一步支持了这一点：http `Rect`: [//msdn.microsoft.com/en-us/library/ms587929%28v=vs.95%29.aspx](http://msdn.microsoft.com/en-us/library/ms587929%28v=vs.95%29.aspx)

请注意`x`并`y`描述左上角，其中宽度向右延伸，高度向下延伸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:41:11.493

```
Rect geoBounds = new Rect(west, north, (east - west), (north - south)); 
```

# json - 来自 Scala JSON 阅读器的 HashMap 的“不是 Any 的成员”错误

> ID：14390611
> 
> 赞同：0
> 
> 时间：2013-01-18T00:28:12.027
> 
> 标签：json, scala

如果您可以提供一个简单的模板，我愿意使用不同的库。我更喜欢我解析的 JSON 的嵌套地图输出。谢谢！

相关代码：

```
import scala.util.parsing.json.JSON
...
input = [Some file read in; see bottom for result]
val parsed = JSON.parseFull(input)
val parsedMap = (parsed.toList)(0)
println(parsedMap)
println(parsedMap.getClass())
println(parsedMap.keys) 
```

结果，包括底部的错误：

> 地图（交互 -> 地图（作者 -> 地图（名称 -> iBuyCell，头像 -> [http://a0.twimg.com/profile_images/1751023331/SellingYourCell1_normal.png](http://a0.twimg.com/profile_images/1751023331/SellingYourCell1_normal.png)，用户名 -> iBuyCell，id -> 4.62459933E8，链接-> [http://twitter.com/iBuyCell](http://twitter.com/iBuyCell) )，来源 -> twitterfeed，id -> 1e17bc84c345a800e0742ed998fff162，链接 -> [http://twitter.com/iBuyCell/statuses/186347162957918208](http://twitter.com/iBuyCell/statuses/186347162957918208)，内容 -> 电话禁令对警方提出挑战：上周，教堂山成为该州和全国唯一一个... [http://t.co/xVCQMDU7](http://t.co/xVCQMDU7), created_at -> Sun, 01 Apr 2012 07:00:00 +0000, type -> twitter), links -> Map(created_at -> List(Sun, 01 Apr 2012 04:22:36 +0000), retweet_count -> List(3.0), title -> List(电话禁令对警察提出挑战 - Orange County - NewsObserver.com), url -> List(http://www.newsobserver.com/2012/04/01/1970433/police- challenged-by-cell-phone.html)), 显着性 -> Map(content -> Map(sentiment -> -1.0)), language -> Map(tag -> en), raw_links -> List(http:// bit.ly/HwmJa6), twitter -> Map(source -> twitterfeed, domain -> List(bit.ly), text -> 电话禁令给警察带来挑战：Chapel Hill 上周成为该州和全国唯一的城镇到 p... [http://t.co/xVCQMDU7](http://t.co/xVCQMDU7), 链接 -> 列表 (http://bit.ly/HwmJa6), id -> 186347162957918208, created_at -> Sun, 01 Apr 2012 07:00:00 +0000, user -> Map(utc_offset -> -14400.0, name -> iBuyCell, screen_name -> iBuyCell, location -> Text (Bez) Buy Kyts, url -> [http://way.to/FreeFones](http://way.to/FreeFones) , description -> Need Cash FAST? 给我们发短信 24 小时快速报价！时间，如果您需要一部新的免费手机，可选择运营商和样式，请点击下面的网站！，id_str -> 462459933，listed_count -> 1.0，followers_count -> 178.0，id -> 4.62459933E8，created_at -> Thu， 2012 年 1 月 12 日 23:58:34 +0000, lang -> en, time_zone -> Atlantic Time (Canada), statuses_count -> 13069.0)))
> 
> 类 scala.collection.immutable.HashMap$HashTrieMap
> 
> 错误：值键不是任何 println(parsedMap.keys) 的成员

如果有帮助，这是有问题的原始 JSON：

> 教堂山上周成为该州和全国唯一一个... http://t.co/xVCQMDU7","user":{"created_at":"Thu, 12 Jan 2012 23:58:34 + 0000","description":"需要快速现金吗？24小时发短信给我们快速报价！同时，如果您需要一部新的免费手机，可选择运营商和款式，请点击以下网站！","followers_count":178,"id":462459933,"id_str":"462459933","lang ":"en","listed_count":1,"location":"Text (Bez) Buy Kyts","name":"iBuyCell","screen_name":"iBuyCell","statuses_count":13069,"time_zone" :"大西洋时间 (加拿大)","url":"http://way.to/FreeFones","

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T04:05:02.563

我复制了您的示例 JSON 并使用它来初始化`String`然后传递给`scala.util.parsing.json.JSON.parseFull`. 结果是`Option[Any]`，正如所宣传的那样。然后你使用`toList`它`Option[Any]`（在这种情况下实际上是 a `Some`）并得到一个元素`List[Any]`（如果它是 a `None`，你会得到一个 empty `List`）。然后，您选择该 的第一个（也是唯一的）元素`List`，产生一个`Any`.

在这一点上，有了一个`Any`在手（可以是任何东西，呃......），您只能调用在 type 上定义的那些方法`Any`。那当然不包括`keys`！

正如 Martin Blech 所说明的，您可以通过模式匹配进行此操作的一种方法。这种`case`子句有效地结合了`isInstanceOf[Type]`(type test) 和`asInstanceOf[Type]`(cast) 给你一个静态承载 type 的值`Map[String, Any]`。那时，您使用类似`keys`or的方法`keySet`（以及为 定义的所有其他方法`Map`）。

最后请注意，由于 JVM 的类型擦除，`case`所讨论的值与所有其他类型无法区分，因此您将收到未经检查的类型警告。`Map`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T03:31:15.330

[文档](http://www.scala-lang.org/api/current/index.html#scala.util.parsing.json.JSON%24)说`parseFull`返回一个`Option[Any]`包含 an`Array[Any]`或 a的 an `Map[String, Any]`。如果您确定要解析 JSON 对象而不是数组，则一种方法是：

```
JSON.parseFull(input).get match {
  case map: Map[String, Any] => {
    // do anything you have to do with the map here, e.g.:
    println(map.keys)
  }
} 
```

# php - 如何为我的 iOS 应用程序设计服务器数据库？

> ID：14390613
> 
> 赞同：1
> 
> 时间：2013-01-18T00:28:15.323
> 
> 标签：php, mysql, ios

我正在开发一个 iOS 应用程序，用户可以从中在服务器中发布各种事件并查看所有用户创建的事件。我的问题不具有编程性质。我想在这里展示我将如何设计我的服务器数据库并告诉我您对此的看法以及如何改进它。

该应用程序有一个非常简单的界面，当用户想要发布活动时，只需写一个标题、一些评论并在需要时附上一张照片。然后这些信息通过 XML 发送到我的服务器并存储到数据库中。

问题是因为有些人不成熟，他们会尝试发布不恰当的文字甚至照片。所以我想对我的用户进行一些控制。我在想的是，当应用程序第一次在手机上运行并连接到服务器时，服务器会将用户 ID 发送回手机。然后每次用户发送一个 xml 文件时，他都会将他的用户 ID 与 xml 一起附加（以编程方式附加）。此外，我会保留另一个数据库，其中包含随时间创建的所有用户 ID。因此，如果我注意到一个不适当的事件，我可以从我的数据库中删除用户 ID，并且下次用户尝试发送某些内容时，服务器会知道该 ID 不在数据库中，因此不允许发布。

这是防止不成熟行为的一种更简单的方法，还是听起来不错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:33:03.800

当然你描述的是可能的。但是它有一个大问题：机器人（脚本）可以轻松使用该界面。因此，如果有人*真的*想滥用你的服务，他可以在一秒钟内用他喜欢的任何东西淹没你。或者他可以一次又一次地尝试，直到你不得不放弃从服务中删除他的帖子。

我建议您改为查看现有框架之一。这样您就不必重新发明轮子（这已经完成了 19562394792 次，而且还在继续），也不必从错误中吸取教训（您肯定会犯）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:33:28.637

这是关于图像的唯一可行解决方案，因为您无法轻松地对图像执行任何识别来确定它是否合适。他们发布的评论将更容易被扫描以查找不适当的项目。

如果您愿意进行这种节制，那么您的解决方案听起来是正确的。正如您提到的，与任何开放系统一样，您无法真正阻止人们创建新帐户。您可以记录和禁止 IP 地址，但这不再是一个很好的解决方案，因为大多数 IP 地址实际上可以是共享网关地址，并且这些地址在用户之间经常轮换。

创建一个标识。注意行为。禁止身份证。并鼓励社区参与通过某种标志按钮提醒您不良帖子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T00:34:57.697

There are many ways to design a database and not just for use with an iOS app. However when I'm building a mobile app (iOS, Android or any other) I want to make sure that the amount of data being sent and received is as small as possible; this is why I use JSON instead of XML... smaller footprint.

Because I use JSON I like to use an object database like MongoDB (my favorite) or CouchDB, because I 1) don't need to worry about the structure of my data and 2) the database stores the objects in JSON format.

I then use Node.JS for my application server so now I have JSON database -> JSON objects in my server application code -> outputting JSON... seamless with no Mappers or serialisation required. FTW.

# c# - MVC4下拉列表问题

> ID：14390616
> 
> 赞同：1
> 
> 时间：2013-01-18T00:28:30.300
> 
> 标签：c#, asp.net, asp.net-mvc-4

所以我正在构建一个 MVC4 应用程序，我根本无法让 Html.DropDownList 正常运行。所有实际页面显示的是一个提交按钮，它实际上并没有呈现下拉列表。

这是控制器：

```
 public ActionResult Index() {
        var items = new SelectList(
            new[] {
                new { Value="ships", Text="Ship" },
            },
            "Value", "Text"
        );

        ViewData["tableitems"] = items;

        return View();
    } 
```

这是观点：

```
@using (Html.BeginForm("Search", "Encyclopedia", FormMethod.Get)) {
    @*<select id="table" name="table">
        <option value=""></option>
        <option value="ships">Ship</option>
    </select>*@

    Html.DropDownList("table", ViewData["tableitems"] as SelectList, "Ship" );

    <input type="submit" value="view" />
} 
```

我一直在网上搜索几个小时尝试各种排列，但我无法得到它。谁能指出我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:30:40.497

你`@`在前面少了一个`Html.DropDownList`

```
@using (Html.BeginForm("Search", "Encyclopedia", FormMethod.Get)) {
    @Html.DropDownList("table", ViewData["tableitems"] as SelectList, "Ship" );
    <input type="submit" value="view" />
} 
```

如果没有`@`，您的代码只是评估为 an`MvcHtmlString`但它实际上并没有被渲染到视图，这就是`@`进来的地方！

# ios - iOS模拟器迭代重置图像

> ID：14390620
> 
> 赞同：0
> 
> 时间：2013-01-18T00:28:54.320
> 
> 标签：ios, uiimageview, uiimage, iteration, simulator

我目前正在开发一个将迭代重置图像的应用程序，并且无法存储或预测未来的图像。对于简单的测试，我使用

```
UIImage * image = [UIImage imageNamed:@"mountain.jpg"];
image = [ /* function that changes image */ ];
self.imageView.image = image 
```

这很好用。`imageView`更新了，就像我想要的一样。但是当我这样做时

```
for (i=0; i<10; i++){
    image = [ /* function that changes image */ ];
    self.imageView.image = image;
 } 
```

它不起作用。所以我尝试了这个：

```
for (int i=0; i<10; i++) {
    NSLog(@"%d", i);
    [NSThread sleepForTimeInterval:1.0];
    image = [self.brain recontructImage:image iterations:10];
    self.imageView.image = image;
    [self.imageView setNeedsDisplay];
    [self.imageView setImage:image];
} 
```

并翻转它，使`[self.image setNeedsDisplay]`和`[self.image setImage:image]`之前的位置`image = [ /* function that changes image */ ]`。

我只在模拟器中尝试过，我开始怀疑它是否坏了，但我对此表示怀疑。也许这是时间问题，但我停顿了一秒钟。我究竟做错了什么？

# symfony - Symfony2：如何仅使用 slug 设置 url

> ID：14390622
> 
> 赞同：1
> 
> 时间：2013-01-18T00:29:06.460
> 
> 标签：symfony, routing

> **可能重复：**
> [基于原则的自定义 symfony 路由](https://stackoverflow.com/questions/9570115/custom-symfony-routing-based-on-doctrine)

我的项目中有几个与每种对象类型相关的 url。前任。

对于产品：

```
/product/product-1
/product/product-2 
```

但现在我为一般信息管理创建了一个控制器。前任。使用条款，关于我们..等。

我想要只包含页面 slug 的 url。

```
/terms-use
/about-us 
```

不是：

```
/page/terms-use
/page/about-us 
```

如何在 routing.yml 中定义它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T06:17:10.253

Venu 是对的，[基于教义的自定义 symfony 路由](https://stackoverflow.com/questions/9570115/custom-symfony-routing-based-on-doctrine)提供了一种方法来做到这一点，如果你的 slug 参数是通过添加父页面的 slug 来构建的，这样孙子页面就有一个 slug，`grandparent-slug/parent-slug/child-slug`在这种情况下会抛出异常.

我们使用路由来匹配我给出的示例中的 slug，它需要在注释中使用一些正则表达式：

```
/**
 * @Route("{slug}", name="page_index", defaults={"slug" = false}, requirements={"slug" = "[0-9a-zA-Z\/\-]*"})
 * @Template()
 */
public function indexAction($slug)
{
    if ($slug !== false) {
        $page = $this->findPage($slug); 
```

上述要求注释意味着 slug 可以是带有正斜杠和连字符的字母数字。然后，您需要实现一种方法`findPage($slug)`，在正斜杠上分解 slug 并找到正确的子页面。

因为路由匹配很多其他路由，所以在 routing.yml 文件中最后包含这个控制器很重要，并且这个动作最后包含在控制器中的公共动作中，以便所有其他路由首先匹配。

### 编辑

这是我们为从上述 slug 中查找页面而编写的 findPage 方法：

```
protected function findPage($slug_string, $first_page = false)
{
    $slug_array = explode("/", $slug_string);
    $slug = array_shift($slug_array);
    $page = $this->em->getRepository("PagesBundle:Page")->getPageBySlug($slug, $this->site_id);
    if (!$page) {
        return false;
    }
    // if only the first matched page is required return it
    if ($first_page) {
        return $page;
    }
    // Otherwise loop through the slug array and match recursive 
    //children until slug array is empty or no match found
    while (!empty($slug_array)) {
        if ($page->getChildren()) {
            $slug = array_shift($slug_array);
            foreach ($page->getChildren() as $child_page) {
                if ($child_page->getSlug() == $slug) {
                    $page = $child_page;
                    break;
                }
            }
        } else {
            return false;
        }
    }

    return $page;
} 
```

# vim - 添加一个挂钩到 Vim 的默认缓冲区

> ID：14390623
> 
> 赞同：3
> 
> 时间：2013-01-18T00:29:21.390
> 
> 标签：vim

我想配置 Vim，以便当 [No Name] 缓冲区打开时，语法设置为 markdown。这可能吗？我在 Vim 的帮助中看不到这种钩子。

我正在使用 Vim 7.3，用`--with-features=huge`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:38:00.173

[这在 vim 提示 wiki](http://vim.wikia.com/wiki/File_type_plugins#Setting_a_default_filetype)中提到：

```
" default filetype
let g:do_filetype = 0
au GUIEnter,BufAdd * if expand('<afile>') == "" | let g:do_filetype = 1 | endif
au BufEnter * if g:do_filetype | setf markdown | let g:do_filetype = 0 | endif 
```

> 为什么需要使用全局变量而不是立即设置文件类型，这是我的理解，因为触发 autocmd 时缓冲区尚未完全创建。

# python - Python 对象中哪个是更有效的 __hash__ 实现？散列 self.__str__、属性元组还是真正的散列例程？

> ID：14390624
> 
> 赞同：3
> 
> 时间：2013-01-18T00:29:43.090
> 
> 标签：python

`__hash__()`为任何给定的 Python 对象创建股票的一种常见且快速的方法似乎是`return hash(str(self))`，如果该对象实现了`__str__()`. 但是，这有效吗？根据[这个 SO answer](https://stackoverflow.com/a/4005412)，对象属性元组的哈希是“好”的，但似乎并不表明它是否对 Python 最有效。还是`__hash__()`为每个对象实现一个并使用[此页面](http://eternallyconfuzzled.com/tuts/algorithms/jsw_tut_hashing.aspx)中的真正散列算法并将各个属性的值混合到由返回的最终值中 会更好`__hash__()`吗？

假装我已经从[这个 SO question](https://stackoverflow.com/a/4594659)实现了 Jenkins 哈希例程。哪个`__hash__()`更好用？：

```
# hash str(self)
def __hash__(self):
    return hash(str(self))

# hash of tuple of attributes
def __hash__(self):
    return hash((self.attr1, self.attr2, self.attr3,
                 self.attr4, self.attr5, self.attr6))

# jenkins hash
def __hash__(self):
    from jenkins import mix, final
    a = self.attr1
    b = self.attr2
    c = self.attr3
    a, b, c = mix(a, b, c)
    a += self.attr4
    b += self.attr5
    c += self.attr6
    a, b, c = final(a, b, c)
    return c 
```

为简单起见，假设样本对象中的属性都是整数。还假设所有对象都派生自一个基类，并且每个对象都实现了自己的`__str__()`. 使用第一个散列的权衡是我也可以在基类中实现它，而不是向每个派生对象添加额外的代码。但是，如果第二个或第三个`__hash__()`实现在某些方面更好，这是否抵消了为每个派生对象添加代码的成本（因为每个派生对象可能具有不同的属性）？

**编辑：**第三`import`个`__hash__()`实现的存在只是因为我不想起草整个示例模块+对象。假设这`import`确实发生在模块的顶部，而不是每次调用函数时。

**结论：**根据对[这个封闭的 SO 问题](https://stackoverflow.com/q/10130454)的回答和评论，看起来我真的想要元组哈希实现，不是为了速度或效率，而是因为 and 的底层二元`__hash__`性`__eq__`。由于散列值将具有某种形式的有限范围（例如，32 位或 64 位），如果确实发生散列冲突，则会检查对象相等性。因此，由于我确实`__eq__()`通过使用自我/其他属性的元组比较来实现每个对象，所以我还想`__hash__()`使用属性元组来实现，以便尊重事物的哈希/相等性质。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:42:25.710

你的第二个有一个重要的性能悲观：每次调用函数时都会导入两个名称。当然，它相对于字符串哈希版本的性能如何取决于字符串的生成方式。

也就是说，当您拥有定义对象相等性的属性，并且这些属性本身是可散列类型时，最简单（并且几乎可以肯定性能最佳）的方法将是散列包含这些属性值的元组。

```
def __hash__(self):
    return hash((self.attr1, self.attr2, self.attr3)) 
```

# html - CSS内联/块问题

> ID：14390626
> 
> 赞同：3
> 
> 时间：2013-01-18T00:29:45.013
> 
> 标签：html, css, inline, block

`<span>`我在使用标签时遇到 css 内联/块问题。![在此处输入图像描述](../Images/fa817997281c939b47520d10a7cfd1d6.png)

![在此处输入图像描述](../Images/283df46888fd0dd80e035b3767b1b57e.png)

正如您从图像中看到的那样，当您将鼠标悬停在第三条消息上时，删除/回复控件会弹出，我不希望他们将内容下推。我怎样才能做到这一点？

这是我的 CSS 代码：

```
ul.inbox {
    width: 100%;
    list-style-type: none;
}

.unread {
    border: 1px solid #999 !important;
    background: #eee url("new.png") no-repeat !important;
    background-position: left center !important;
}

li span.hidden {
    clear: both;
    visibility: hidden;
}

li span.messageControls {
    clear: both;
    float: right;
    display: inline;
}

li span.messageControls a {
    padding: 5px 5px 0 0;
    font-size: 12px;
    color: #06c;
}

li.message {
    background: #eee;
    border: 1px solid #ddd;
    list-style-type: none;
    display: block;
    margin: 0 0 10px;
    padding-left: 30px;
    background-position: left center;
}

li.message:hover {

}

li.message a {
    text-decoration: none;
}

li {
    overflow: hidden;
}

li span.from {
    margin: 5px 0 5px 5px;
    font-family:"Open Sans",sans-serif;
    font-size: 14px;
    color: #666;
    float: left;
    font-weight: 700;
}

li span.date {
    margin: 5px 5px 5px 0;
    font-size: 12px;
    float: right;
    color: #06c;
}

li p.subject {
    margin: 5px 0 5px 5px;
    font-size: 14px;
    color: #666;
    clear: both;
    font-weight: 700;
}

li p.preview {
    margin: 5px 0 5px 5px;
    font-size: 12px;
    color: #999;
} 
```

还有我的“收件箱”代码：

```
<ul class="inbox">
    <li id="1001843" class="message " onmouseout="document.getElementById('1001843MC').className='hidden'" onmouseover="document.getElementById('1001843MC').className='messageControls'" onclick="ajaxMessage(1001843);">
        <span class="from">Michael‌·Norris</span> <span class="date">Yesterday‌·21:18</span> <span id="1001843MC" class="hidden"><a href="compose.php?id=&to=">Reply</a> &nbsp; <a href="update.php?id=&action">Delete</a></span>

        <p class="subject">gjhgjhg</p>

        <p class="preview">jhgjhgjhg</p>
    </li>

    <li id="1001842" class="message " onmouseout="document.getElementById('1001842MC').className='hidden'" onmouseover="document.getElementById('1001842MC').className='messageControls'" onclick="ajaxMessage(1001842);">
        <span class="from">Michael‌·Norris</span> <span class="date">Yesterday‌·21:18</span> <span id="1001842MC" class="hidden"><a href="compose.php?id=&to=">Reply</a> &nbsp; <a href="update.php?id=&action">Delete</a></span>

        <p class="subject">gfhjgjfdhsgf</p>

        <p class="preview">gj‌·hg</p>
    </li>

    <li id="1001841" class="message " onmouseout="document.getElementById('1001841MC').className='hidden'" onmouseover="document.getElementById('1001841MC').className='messageControls'" onclick="ajaxMessage(1001841);">
        <span class="from">Michael‌·Norris</span> <span class="date">Yesterday‌·20:17</span> <span id="1001841MC" class="hidden"><a href="compose.php?id=&to=">Reply</a> &nbsp; <a href="update.php?id=&action">Delete</a></span>

        <p class="subject">gjhgjhg</p>

        <p class="preview">jhgjhgjhg</p>
    </li>
</ul> 
```

在这里小提琴：http: [//jsfiddle.net/Er73L/](http://jsfiddle.net/Er73L/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:43:28.830

您需要`clear`正确设置属性以实现您想要的行为，而不是`clear: both`盲目使用。

我对您的 CSS 做了两处更改：

```
li span.messageControls {
    clear: right; /* was clear: both; */
    float: right;
    display: block; /* was display: inline */
}

li p.subject {
    margin: 5px 0 5px 5px;
    font-size: 14px;
    color: #666;
    clear: left; /* was clear: both; */
    font-weight: 700;
} 
```

这是一个[工作示例](http://jsfiddle.net/Er73L/2/)。我还建议您阅读[文档](http://www.w3.org/TR/CSS2/visuren.html#flow-control)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:43:32.610

这是我建议您解决此问题的方法：http: [//jsfiddle.net/Er73L/1/](http://jsfiddle.net/Er73L/1/)

这是与原始 CSS 相比的差异：[http ://www.diffchecker.com/3tKbEnCe](http://www.diffchecker.com/3tKbEnCe)

```
li span.messageControls {
    position: absolute;
    right: 0;
    top: 1em;
}

li.message {
    background: #eee;
    border: 1px solid #ddd;
    list-style-type: none;
    display: block;
    margin: 0 0 10px;
    padding-left: 30px;
    background-position: left center;
    position: relative;  // NEW LINE
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T00:46:48.433

简单的修复，只需使用`clear:left`而不是`clear:both`这样：

```
li p.subject {
    margin: 5px 0 5px 5px;
    font-size: 14px;
    color: #666;
    clear:left;
    font-weight: 700;
} 
```

[小提琴](http://jsfiddle.net/Er73L/6/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T00:53:01.673

另一种选择是绝对定位跨度元素。只需将此行添加到 CSS 的底部并根据需要进行调整...

```
.messageControls{width:100px;border:1px solid red;position:absolute;right:0;margin-top:20px;} 
```

[http://jsfiddle.net/nYCsx/1/](http://jsfiddle.net/nYCsx/1/)

# node.js - 将文件保存到 GridFS 的同步问题 - Node.JS/Express

> ID：14390630
> 
> 赞同：0
> 
> 时间：2013-01-18T00:30:08.677
> 
> 标签：node.js, mongodb, express

我正在尝试将社交网络中的个人资料照片作为 Facebook 保存在我的“fs.files”和“fs.chunks”中，我可以做到这一点，但我发现这样做的方式并不正确。

我的步骤是：

1.  使用 Passport 在 Facebook 上进行用户登录；
2.  将图片文件保存在磁盘上（内部应用程序文件夹）；
3.  打开并读取图片文件并将其存储在正确的集合中（来自 Mongo 的文件和块）。

问题发生在第 2 步和第 3 步之间，因为在这种情况下将文件保存在磁盘上并不是最好的主意，并且在尝试将其存储在数据库上时会发生同步问题和延迟。

我曾使用`setTimeout`javascript 函数来实现它。但这太糟糕了，我知道。我想知道以某种方式获取某种文件流并将其直接存储在 GridFS 上或使实际过程更高效的方法：

**代码：**

从 URL 中获取图片并保存（磁盘步骤）

```
// processing image 'http://graph.facebook.com/' + user.uid + '/picture';
// facebook -> disk
var userProfilePhoto = user.provider + '_' + user.uid + '.png';

request(user.photoURL)
    .pipe(fs.createWriteStream(configApp.temp_files + userProfilePhoto)); 
```

获取磁盘上保存的图片并存储在GridFS上

```
setTimeout(function() {
    mongoFile.saveFile(user, true, userProfilePhoto, mimeType.mime_png, 
        function(err) {
            if (!err) {
                user.save();
            }
        }
    );
}, 5000); 
```

不幸的是，我不得不使用`setTimeout`它来实现它，没有它，mongo 只需插入“fs.files”并跳过“fs.chunks”，因为文件还没有准备好 - 似乎还没有保存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T17:07:39.347

我做的！

[我替换了http-get](https://npmjs.org/package/http-get)的请求插件，所以当文件准备好时，我可以将它存储在 MongoDB 中。

# php - 具有任意数量的 URL 段的 Laravel 4 路由

> ID：14390631
> 
> 赞同：1
> 
> 时间：2013-01-18T00:30:08.237
> 
> 标签：php, url-routing, laravel, laravel-4

我有一个尝试移植到 L4 的 L3 应用程序。在 L3 版本中，我的一条路线是

```
Route::get('/(:any)/(:all?)', etc... 
```

这允许我处理任意数量的 URL 段，例如：

```
/contact_page
/store_category
/store_category/shirts_category
/store_category/shirts_category/specific_shirt_page
/an/arbitrary/number/of/nested/categories 
```

但在 L4 中，我无法弄清楚如何模拟 (:all?)

下面的代码有效：

```
Route::get('/{arg1?}/{arg2?}/{arg3?}', function($arg1='home', $arg2, $arg3)
{
  //do something
}); 
```

所以我可以添加大量可选参数（比我认为在现实世界中使用时需要的更多）但这不是很优雅。

Laravel 4 中是否有某种方法可以定义一个可以响应任意数量的 URL 段的路由？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-19T19:56:04.343

您可以将模式条件添加到您的路线，例如：

```
Route::get('{any}/{args}', function($action, $args = null)
{
   // do something like return print_r(explode('/', $args), true);
})->where('args', '(.*)'); 
```

# jquery - IE9 jQuery $ 错误

> ID：14390635
> 
> 赞同：-3
> 
> 时间：2013-01-18T00:30:38.137
> 
> 标签：jquery, internet-explorer

我创建了一个 jQuery 脚本来允许我的背景云动画在 IE 中运行，因为我对所有其他浏览器使用 CSS3 :after 和 :before 伪和关键帧。它可以在所有浏览器中运行，当然 IE9 除外。出于某种原因，它在第`$`8 行的第一个错误。我在网上搜索了答案，但到目前为止我什么也没找到，我还尝试强制 IE 恢复使用 IE8 兼容模式，看看它是否会工作但这产生了同样的错误。有没有其他人有同样的错误并且知道如何解决它？即使我完全删除了整行`$(init);`，错误也会移动到第 9 行。![这是使用 IE 调试时产生的错误消息。](../Images/226c16d4828a36eabdd4283c33a914a4.png)

这是我的网站的 URL，供您自行查看，[http://cafe.cic.hull.ac.uk/~405851/](http://cafe.cic.hull.ac.uk/~405851/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:52:40.457

看起来您`clouds.js`在加载 jQuery 之前正在加载。*在 jQuery 和 jQueryUI之后*移动链接到 cloud.js 的 <script> 标记，您的问题应该得到解决。

# ruby - 安装了 ruby gems1.9.1 但它报告版本 1.3.5

> ID：14390639
> 
> 赞同：1
> 
> 时间：2013-01-18T00:31:21.247
> 
> 标签：ruby, rubygems, version, ubuntu-10.04

我在一个非常干净的 Lucid VM 上安装了 ruby​​gems1.9.1。

```
$ sudo apt-get install rubygems1.9.1
...
The following extra packages will be installed:
  irb1.9.1 libreadline-ruby1.9.1 libreadline5 rdoc1.9.1
Suggested packages:
  graphviz build-essential rubygems-doc
The following NEW packages will be installed:
  irb1.9.1 libreadline-ruby1.9.1 libreadline5 rdoc1.9.1 rubygems1.9.1
0 upgraded, 5 newly installed, 0 to remove and 85 not upgraded.
...
Get:1 http://archive.ubuntu.com/ubuntu/ lucid/main libreadline5 5.2-7build1 [147kB]
Get:2 http://archive.ubuntu.com/ubuntu/ lucid/universe libreadline-ruby1.9.1 1.9.1.378-1 [15.2kB]
Get:3 http://archive.ubuntu.com/ubuntu/ lucid/universe irb1.9.1 1.9.1.378-1 [66.9kB]
Get:4 http://archive.ubuntu.com/ubuntu/ lucid/universe rdoc1.9.1 1.9.1.378-1 [125kB]
Get:5 http://archive.ubuntu.com/ubuntu/ lucid/universe rubygems1.9.1 1.3.5-1ubuntu2 [191kB]
Fetched 545kB in 7s (76.2kB/s)                                                                                                                             
Selecting previously deselected package libreadline5.
(Reading database ... 29331 files and directories currently installed.)
Unpacking libreadline5 (from .../libreadline5_5.2-7build1_amd64.deb) ...
Selecting previously deselected package libreadline-ruby1.9.1.
Unpacking libreadline-ruby1.9.1 (from .../libreadline-ruby1.9.1_1.9.1.378-1_amd64.deb) ...
Selecting previously deselected package irb1.9.1.
Unpacking irb1.9.1 (from .../irb1.9.1_1.9.1.378-1_all.deb) ...
Selecting previously deselected package rdoc1.9.1.
Unpacking rdoc1.9.1 (from .../rdoc1.9.1_1.9.1.378-1_all.deb) ...
Selecting previously deselected package rubygems1.9.1.
Unpacking rubygems1.9.1 (from .../rubygems1.9.1_1.3.5-1ubuntu2_all.deb) ...
Processing triggers for man-db ...
Setting up libreadline5 (5.2-7build1) ...

Setting up libreadline-ruby1.9.1 (1.9.1.378-1) ...
Setting up irb1.9.1 (1.9.1.378-1) ...

Setting up rdoc1.9.1 (1.9.1.378-1) ...
Setting up rubygems1.9.1 (1.3.5-1ubuntu2) ... 
```

然而，奇怪的是：

```
$ gem1.9.1 --version
1.3.5

$ cat /usr/bin/gem1.9.1 
#!/usr/bin/ruby1.9.1
... 
```

我不确定这是包装问题还是 Ruby 问题。

我需要 Gems > 1.8 来安装另一个包。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-18T01:00:09.317

`gem update --system`是确保您处于 Rubygems 最高版本的良好起点。如果您的版本不支持它，那么您需要引导它，因为该功能并不总是可用。

就我个人而言，我从不将 repos 用于我的 Ruby/Python/Perl 安装，而是确保我有所需的依赖项，然后从源代码编译。

考虑安装[rbenv](https://github.com/sstephenson/rbenv)或[RVM](http://rvm.io)并让它管理您的 Ruby 安装。RVM 具有更多的功能并且更具侵入性。rbenv 更简单，功能更少——我个人使用 rbenv。

# python - python中用于电机控制和数据采集的并行while循环

> ID：14390648
> 
> 赞同：0
> 
> 时间：2013-01-18T00:32:21.787
> 
> 标签：python, parallel-processing, motordriver

假设我有两个功能：

```
def moveMotorToPosition(position,velocity) 
    #moves motor to a particular position
    #does not terminate until motor is at that position 
```

和

```
def getMotorPosition() 
    #retrieves the motor position at any point in time 
```

在实践中，我希望能够让电机来回摆动（通过一个循环调用 moveMotorToPosition 两次；一次是正位置，一个是负位置）

虽然该“控制”循环正在迭代，但我希望一个单独的 while 循环通过调用 getMotorPositionnd 以某种频率提取数据。然后我会在这个循环上设置一个计时器，让我设置采样频率。

在 LabView 中（电机控制器提供了一个 DLL 来连接），我通过“并行”while 循环来实现这一点。我以前从未使用过 parallel 和 python 做过任何事情，并且不确定哪个是最引人注目的方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:58:33.283

为了让你更接近听起来你想要的东西：

```
import threading

def poll_position(fobj, seconds=0.5):
    """Call once to repeatedly get statistics every N seconds."""
    position = getMotorPosition()

    # Do something with the position.
    # Could store it in a (global) variable or log it to file.
    print position
    fobj.write(position + '\n')

    # Set a timer to run this function again.
    t = threading.Timer(seconds, poll_position, args=[fobj, seconds])
    t.daemon = True
    t.start()

def control_loop(positions, velocity):
    """Repeatedly moves the motor through a list of positions at a given velocity."""
    while True:
        for position in positions:
            moveMotorToPosition(position, velocity)

if __name__ == '__main__':
    # Start the position gathering thread.
    poll_position()
    # Define `position` and `velocity` as it relates to `moveMotorToPosition()`.
    control_loop([first_position, second_position], velocity) 
```

# wpf - 树视图中的wpf数据绑定组合框

> ID：14390649
> 
> 赞同：1
> 
> 时间：2013-01-18T00:32:22.947
> 
> 标签：wpf, data-binding, treeview

我对 WPF 非常陌生，并感谢您的帮助：

```
Model:
   Collection<Presenter>,
   Presenter has a Collection<Presentation>,
   Presentation has a TeachingSession property (which contains a DateTime? property) 
```

我正在尝试显示树视图：

```
presenter name
   [combobox of available Dates] 
```

目前，树视图中的每个演示者姓名都正确显示，并且展开的第一个父项显示具有正确选择日期的组合框。但是，在任何时候显示的组合框都是“同步的”——即更改组合框中的值（或扩展不同的树视图项）会更改所有可见的组合框的值，因此它们都显示相同的日期。

```
<TreeView Name="PresenterTreeView" ItemsSource="{Binding}">
    <TreeView.Resources>
        <HierarchicalDataTemplate DataType="{x:Type local:Presenter}"
                  ItemsSource="{Binding Path=Presentations}">
            <TextBlock Text="{Binding Path=FullName}" />
        </HierarchicalDataTemplate>
        <HierarchicalDataTemplate DataType="{x:Type local:Presentation}">
            <ComboBox SelectedItem="{Binding Path=TeachingSession, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                      DisplayMemberPath="SessionDate"
                      ItemsSource="{Binding Source={StaticResource availableDatesViewSource}}" >
            </ComboBox>
        </HierarchicalDataTemplate>
    </TreeView.Resources>
</TreeView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T03:19:07.530

我已经编译了您的示例，但无法像您描述的那样使组合框同步。

也许您将能够看到我所做的不同并且可能是解决方法，或者也许我错了，并且在您的问题中遗漏了一些东西？

这是我使用的代码：

xml:

```
<Window x:Class="WpfApplication8.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="340" Width="480" Name="UI" xmlns:local="clr-namespace:WpfApplication8">

    <TreeView Name="PresenterTreeView" DataContext="{Binding ElementName=UI}" ItemsSource="{Binding Path=Presenters}" >
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="{x:Type local:Presenter}" ItemsSource="{Binding Path=Presentations}">
                <TextBlock Text="{Binding FullName}" />
            </HierarchicalDataTemplate>
            <HierarchicalDataTemplate DataType="{x:Type local:Presentation}">
                <ComboBox SelectedItem="{Binding TeachingSession.SessionDate}" ItemsSource="{Binding ElementName=UI, Path=Dates}" />
            </HierarchicalDataTemplate>
        </TreeView.Resources>
    </TreeView>
</Window> 
```

代码：

```
public partial class MainWindow : Window
{
    private ObservableCollection<Presenter> _myProperty = new ObservableCollection<Presenter>();
    private ObservableCollection<DateTime?> _myDates = new ObservableCollection<DateTime?>();

    public MainWindow()
    {
        InitializeComponent();
        DateTime time1 = DateTime.Now;
        DateTime time2 = DateTime.Now.AddDays(1);
        Dates.Add(time1);
        Dates.Add(time2);
        for (int i = 0; i < 20; i++)
        {
            Dates.Add(DateTime.Now.AddDays(i));
        }

        TeachingSession teach = new TeachingSession { SessionDate = time1 };
        Presentation pres = new Presentation { TeachingSession = teach };
        Presenter presenter = new Presenter { FullName = "Presenter1" };
        presenter.Presentations = new ObservableCollection<Presentation>();
        presenter.Presentations.Add(pres);

        TeachingSession teach1 = new TeachingSession { SessionDate = time2 };
        Presentation pres1 = new Presentation { TeachingSession = teach1 };
        Presenter presenter1 = new Presenter { FullName = "Presenter1" };
        presenter1.Presentations = new ObservableCollection<Presentation>();
        presenter1.Presentations.Add(pres1);

        Presenters.Add(presenter);
        Presenters.Add(presenter1);
    }

    public ObservableCollection<Presenter> Presenters
    {
        get { return _myProperty; }
        set { _myProperty = value; }
    }

    public ObservableCollection<DateTime?> Dates
    {
        get { return _myDates; }
        set { _myDates = value; }
    }
}

public class Presenter
{
    public string FullName { get; set; }
    public ObservableCollection<Presentation> Presentations { get; set; }
}

public class Presentation
{
    public TeachingSession TeachingSession { get; set; }
}

public class TeachingSession
{
    public DateTime? SessionDate { get; set; }
} 
```

结果：

![在此处输入图像描述](../Images/cfeee090f61a98235e1b76eaacdc42d2.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T19:10:42.027

由于 sa_ddam213 的回答，我能够将问题追踪到与用于 bindItemsSource 的 CollectionViewSource 的默认同步

组合框需要属性：

```
IsSynchronizedWithCurrentItem="False" 
```

# objective-c - 覆盖objective-c中的dealloc方法

> ID：14390652
> 
> 赞同：2
> 
> 时间：2013-01-18T00:32:47.740
> 
> 标签：objective-c, dealloc

有人能告诉我如果你在 Objective-C 中重写 dealloc 方法会发生什么吗？就像它会崩溃还是会开始到处泄漏内存一样。我一直想知道会发生什么以及为什么有必要阻止程序员直接使用 dealloc。

在什么情况下你必须做这样的事情？

**编辑**：对不起，伙计们不清楚。我主要是在谈论术语或 ARC 类型编码。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-18T00:49:07.187

在非 ARC 代码中，覆盖`-dealloc`是一件极其常见的事情。事实上，你很难找到一个*不*覆盖它的类。

但是，要记住的关键是，每次覆盖`-dealloc`总是以调用`[super dealloc]`.

当然，在 ARC 代码中，覆盖`-dealloc`要少得多。如果你覆盖它，你不会调用`[super dealloc]`，因为编译器会为你插入它。但请记住，这仅适用于 ARC。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-18T00:51:23.343

在 ARC 覆盖该`dealloc`方法非常普遍之前，您正在释放已释放实例拥有的 ivars。现在，使用 ARC，不太常见，但是，在某些特殊情况下，您可能必须这样做，例如当您从观察中注销实例时使用`NSNotificationCenter`.

您谈论的规则是不要`dealloc`直接调用（而不是覆盖），这通常会导致崩溃，因为您绕过了 Cocoa 的内部引用计数系统。

*编辑*：根据您的编辑，如果您`[super dealloc]`在 ARC 下调用，您将收到编译时错误。如果没有错误，它可能会导致重复`dealloc`调用，这会使你的程序崩溃。

# asynchronous - 为什么上下文切换很慢？

> ID：14390655
> 
> 赞同：1
> 
> 时间：2013-01-18T00:32:58.470
> 
> 标签：asynchronous, parallel-processing

我想知道为什么与同一线程上的异步操作相比，上下文切换很慢。

为什么最好运行 N 个线程（N 等于内核数），每个线程异步处理 M 个客户端，而不是运行 M 个线程？我已经告诉过原因是上下文切换开销，但我找不到上下文切换有多慢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:45:24.320

为了澄清起见，我假设当您说“而不是运行 M 个线程”时，您的意思是 N*M 个线程（如果您运行 M 个线程，每个线程都需要处理 N 个客户端以匹配相同数量的客户端总数，而这将是类似的情况）。

因此，在 N 个内核中运行的 N 个线程、每个处理 M 个客户端和在相同数量的内核中运行的 N*M 个线程之间的区别在于，在第一种情况下，您不必创建新线程，并且正如您所说，你不会有上下文切换。这是一个优势，因为创建 OS 线程所需的工作量很大；它需要创建不同的进程空间、新堆栈等。此外，如果您有更多线程，操作系统调度程序将停止并激活正在运行的进程，这也很耗时。每次调度程序更改分配给核心的进程时，它可能还需要缓存该进程的上下文，从而增加大量缓存未命中并因此增加时间。

另一方面，如果您有固定数量的线程，等于内核数（有时甚至建议 N-1），您可以在用户级调度程序中管理“任务”或客户端，这可能会在几个对程序进行更多计算，但避免大量操作系统进程和内存管理，从而使整体执行速度更快。一些当前的并行 API，例如 .Net 任务并行库 (TPL)、OpenMP、英特尔的线程构建模块或 Cilk 体现了这种称为动态多线程的并行模型。

# ruby-on-rails - Rails - rabl 和 gon gem 返回连接表的集合

> ID：14390663
> 
> 赞同：1
> 
> 时间：2013-01-18T00:33:53.213
> 
> 标签：ruby-on-rails, ruby, rabl

这是我第一次使用 rabl 和 gon gem。我只是尝试使用 rabl 输出查询的结果。不幸的是，我没有得到正确的对象。

我的控制器：

```
@test = Category.joins('LEFT OUTER JOIN incomes ON incomes.category_id = categories.id AND incomes.dept_id = 86').group_by { |category| category.cat_ds } 
```

我的 rabl 模板：

```
collection @test
attributes :cat_code, :cat_ds 
```

我希望得到的结果：

```
{
    "REVENUE": [
        {
            "cat_code": 10001,
            "cat_ds": "REVENUE",
            "id": 1,
            "incomes": [
                {
                    "category_id": "1.0",
                    "chart_id": 1,
                    "created_at": "2013-01-15T16:43:52Z",
                    "dept_id": 4,
                    "feb": "11.0",
                    "id": 1,
                    "jan": "12.12",
                    "note": "Testing",
                    "updated_at": "2013-01-15T16:43:52Z",
                    "year_id": 1,
                    "total_cost": 23
                }
            ]
        }
    ],
    "EXPENSE": [
        {
            "cat_code": 10002,
            "cat_ds": "EXPENSE",
            "id": 2,
            "incomes": [
                {
                    "category_id": "2.0",
                    "chart_id": 2,
                    "created_at": "2013-01-15T16:43:52Z",
                    "dept_id": 86,
                    "feb": "45.0",
                    "id": 3,
                    "jan": "60.0",
                    "note": "Two",
                    "updated_at": "2013-01-15T16:43:52Z",
                    "year_id": 1,
                    "total_cost": 105
                },
                {
                    "category_id": "2.0",
                    "chart_id": 2,
                    "created_at": "2013-01-15T16:43:52Z",
                    "dept_id": 86,
                    "feb": "45.55",
                    "id": 5,
                    "jan": "3454.0",
                    "note": "One",
                    "updated_at": "2013-01-15T16:43:52Z",
                    "year_id": 1,
                    "total_cost": 3499
                }
            ]
        }
    ]
} 
```

我已经删除了上面的大部分结果。

我得到的结果：

```
{

        "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": [
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            },
            {
                "[#<Category id: 1, cat_code: 10001, cat_ds: \"INPATIENT REVENUE\">]": {}
            }
        ]
    } 
```

因此，对于像收入和费用这样的每个组，它返回一个记录，相同的记录。为什么它根本不解析我给它的实例变量。在呈现数据之前，它还对数据做了什么。

另外值得注意的是，如果我跳过 rabl 模板并使用来自 gon 的变量，它会完美显示。所以它一定与我的 rabl 模板有关吗？

**编辑** 我想看看以下是否有效，但我收到以下错误： `Cannot find rabl template 'income/index' within registered ([]) view paths!`

```
def index
    @test_obj = Category.joins('LEFT OUTER JOIN incomes ON incomes.category_id = categories.id AND incomes.dept_id = 86').group_by { |category| category.cat_ds }
    @test = Rabl::Renderer.json(@test_obj, 'income/index')
    gon.rabl "app/views/incomes/index.rabl", as: "test"        
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:11:36.613

在你的控制器中试试这个。Rabl 用于渲染，因此如果您想使用它传递给 gon，我认为您必须手动渲染它，因为您将为请求渲染 HTML。

```
@test_obj = Category.joins('LEFT OUTER JOIN incomes ON incomes.category_id = categories.id AND incomes.dept_id = 86').group_by { |category| category.cat_ds }

@test = Rabl::Renderer.json(@test_obj, 'test/show') 
```

# jquery - 禁用指向同一页面的链接

> ID：14390666
> 
> 赞同：0
> 
> 时间：2013-01-18T00:34:23.300
> 
> 标签：jquery, jquery-mobile

我正在寻找有关如何禁用将使用 jquery/jquerymobile 重定向到同一页面的链接的最佳实践。

例如，如果我在主页上并且有一个指向主页的链接，它甚至不应该刷新页面。

我的链接代码：

```
<a href="Homepage.aspx" rel="external">Home</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:45:53.980

完全未经测试，但取决于您的代码是如何编写的，这可能会起作用。

```
$('a').each(function(){
    if($(this).attr('href') === window.location.pathname) 
        $(this).removeAttr('href');
        // Alternatively: $(this).attr('href','#');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:46:20.143

我对 jquery/jquery mobile 不够熟悉，不知道这是否是最佳实践，但它应该可以工作。

```
$("a").each(function(){
   if(window.location.href==this.href)
     this.onclick=function(){return false};
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T00:49:44.890

您可以使用解析当前 URL`window.location.href`并提取**页面名称**。

然后，您可以对每个链接进行迭代，并为具有与当前页面值相同的 href 值的链接附加行为

```
var currentPage = ....// extract the page from window.location.href

$('a').each(function(index, element) {

    var currentA = $(this);
    if (currentA.attr('href') == currentPage) {
        // Append a listener on the click event that will return false
        // and stop the default behaviour
        currentA.on('click', false);
    }

}); 
```

注意：将 false 设置为处理函数与创建返回 false 的匿名函数相同，并且再次与创建调用`event.stopPropoagation()`和`event.preventDefault()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-24T03:25:38.043

```
for (var a = document.getElementsByTagName("A"), b = 0; b < a.length; b++) {
    if (a[b].href === window.location.href.split("#")[0] && a[b].hasChildNodes()) {
        for (var c = 0; b < a[b].childNodes.length; c++) {
            a[b].parentNode.insertBefore(a[b].childNodes[c].cloneNode(!0), a[b]);
        }
    }
} 
```

# ios - 具有不同分段级别的 UISlider

> ID：14390668
> 
> 赞同：2
> 
> 时间：2013-01-18T00:34:35.437
> 
> 标签：ios, objective-c, uikit, uislider

我想创建一个具有不同灵敏度级别的范围滑块。它需要根据用户选择的范围内的特定部分采取不同的行动。即 - 如果我的滑块的范围是 1-100,000，则将范围设置为较低的值将跳 1，将范围设置为较高的值将跳 100。

eBay 在他们的网站上实现了这种滑块（注意左侧的价格范围滑块）：[http ://www.ebay.com/sch/i.html?LH_FS=0&_sacat=0&_from=R40&_nkw=car&_mPrRngCbx=1&_udlo=490&_udhi= 21%2C000%2C000](http://www.ebay.com/sch/i.html?LH_FS=0&_sacat=0&_from=R40&_nkw=car&_mPrRngCbx=1&_udlo=490&_udhi=21%2C000%2C000)

任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:40:28.903

由于滑块没有显示相关的值，为什么不简单地向值更改事件添加一个动作出口并计算适当的跳转。

例如，将滑块的范围设置为 1 到 100。假设您使用标签显示计算范围。

然后标签的值将是：

```
if slider.value < 10, then value = range
else if slider.value < 20 then value = 10 + (slider.value - 10) * 2 // increments of 2
else if slider.value < 50 then value = 10 + 10 * 2 + (slider.value - 20) * 5 // increments of 5 
```

...

你明白了吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T00:43:54.823

将滑块的范围设置为 0 - 5。然后将所需的值计算为`10 ^ sliderValue`。这基本上给了你一个对数刻度。

如果您想要离散但不同的线性范围，那么 kabram 的答案可能更符合您的要求。

更新：

将滑块的范围设置为 0.0 到 5.0。随着滑块值的变化，计算值变为：

```
double newValue = pow(10, slider.value); 
```

`slider`在哪里`UISlider`。`pow`是一个标准的 C 数学函数。这为您提供以下信息：

```
slider.value newValue
     0.0          1.0
     1.0         10.0
     2.0        100.0
     3.0       1000.0
     4.0      10000.0
     5.0     100000.0 
```

# html - HTML5 Canvas DrawImage 口吃/断断续续

> ID：14390669
> 
> 赞同：4
> 
> 时间：2013-01-18T00:34:48.340
> 
> 标签：html, animation, canvas, drawimage

**问题**

我试图让画布上的图像从左到右顺利移动。在 Chrome/Safari 上还不错（仍然有点卡顿），但在多台机器上的 Firefox 中存在明显的卡顿（在 Windows 和 Mac 上试过）。我对如何解决这个问题有点困惑。

**我尝试了什么**

我正在使用 requestAnimationFrame 而不是 setTimeout。我正在使用 clearRect 而不是设置画布宽度，尽管我正在清除整个画布而不是最小边界框，因为我想在最坏的情况下对其进行测试。我确实关闭了额外的标签。我什至禁用了 Firebug。我正在使用 drawImage 而不是图像数据函数。由于除了 clearRect 和 drawImage 之外我没有做任何其他事情，因此我避免使用屏幕外画布。

**示例 1：http:** [//jsfiddle.net/QkvYs/](http://jsfiddle.net/QkvYs/)

这个有一个固定的帧率，无论游戏循环运行的频率如何，它都能确保位置正确。它显示跳过的帧数。这个例子更接近我的目标。请注意，即使没有跳过任何帧，它看起来也很不稳定。我也玩过帧率但没有成功，虽然我想瞄准大约 30 fps (var frameRate = 33;)。

**示例 2：http:** [//jsfiddle.net/R8sEV/](http://jsfiddle.net/R8sEV/)

这是一个简单的方法，它所做的只是移动图像。这在多台机器上对我来说口吃。

```
//loop
function loop() {
    //request anim frame
    requestAnimationFrame(loop);

    //set canvas once able
    if (!canvas) {
        var temp = document.getElementById("testCanvas");
        if (temp) {
            canvas = temp;
            ctx = canvas.getContext('2d');
        }
    }

    //update and render if able
    if (canvas) {
        //increase x
        x += 5;

        //start from beginning
        if (x > canvas.width) {
            x = 0;
        }

        //clear
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        //image
        ctx.drawImage(image, x, 200);
    }
}

//start
loop(); 
```

**我看到了什么**

我意识到这个问题之前已经被问过，我确实在问之前看过。然而，不幸的是，给出的答案没有帮助。

*   [https://gamedev.stackexchange.com/questions/37298/slow-firefox-javascript-canvas-performance](https://gamedev.stackexchange.com/questions/37298/slow-firefox-javascript-canvas-performance)

*   [HTML5 Canvas 动画偶尔会出现抖动/犹豫/卡顿](https://stackoverflow.com/questions/9944961/html5-canvas-animation-has-occasional-jitter-hesitation-stutter)

*   [画布动画在 FireFox 中卡顿，但在 Chrome 中非常完美](https://stackoverflow.com/questions/14198233/canvas-animation-stutters-in-firefox-but-is-perfect-in-chrome)

*   [HTML5画布动画口吃有解决办法吗？](https://stackoverflow.com/questions/6513940/is-there-a-solution-for-html5-canvas-animation-stutter)

谢谢您的帮助！我很感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:49:50.803

For instance use time delta in your position calculations. This will ensure that object is moved by certain value in given time regardless of FPS and delay between frames.

Edited your fiddle: [http://jsfiddle.net/R8sEV/2/](http://jsfiddle.net/R8sEV/2/)

wrong approach:

`x += 5`

good approach:

`x += speed * delta / 1000`

where delta is time in [ms] which passed from last frame - and speed is measured in [pixels/second]

# php - MySQL 数据库结构用于存储具有多个可用选项的项目

> ID：14390672
> 
> 赞同：1
> 
> 时间：2013-01-18T00:35:00.057
> 
> 标签：php, mysql, sql-update, checkbox, insert-update

我早些时候问过这个问题但找不到答案..首先对不起我的英语..

我有一个包含 80 个复选框的表单：这些复选框是 car 的选项，
例如 car ；Mp3 播放器 | ABS | 安全气囊 | 空调 |

用户应该从复选框中选择他自己的汽车选项并将其发布。问题是？我应该如何将它们存储在数据库中？顺便说一句，用户应该能够稍后更新它们..

我应该使用 implode() 并将它们存储为

```
option1 , option2 , option34 , option45 , option66 ,  in one column 
```

或者像那样

```
Car_ID | Options | 
155      option2
155      option34
155      option45
155      option66 
```

（他们应该如何更新它们？）

或在数据库中打开 80 列之类的，

```
Car_ID | Option1 | Option2 | Option3 | Option4 | Option5
155         true     true      false     false     false 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:37:53.570

您应该有一个选项表、一个用户表和一个关联它们的 user_options 表。这将允许您根据需要轻松修改选项并添加或删除选项。

```
Users
user_id,username

Options
option_id,option_name

User Options
option_id,user_id 
```

如果每个用户可以拥有多辆汽车，则应该是：

```
Users
user_id,username

Options
option_id,option_name

Cars
car_id,car_name

User_Car_Options
user_id,car_id,option_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:39:02.513

最好的方法是这样

```
+---------+----------+----------+----------+
| Car_ID  | Option1  | Option2  | Option3  |
+---------+----------+----------+----------+
| 1       | TRUE     | FALSE    | NULL     |
| 2       | TRUE     | NULL     | FALSE    |
| 3       | NULL     | TRUE     | FALSE    |
+---------+----------+----------+----------+ 
```

（如果您觉得这会使您的原始表格变得混乱，您也可以简单地将这些列放在一个单独的表格中，并在它们之间建立 1:N 的关系）

**编辑 ：**

但是，如果复选框是动态的，并且您希望能够从列表中添加/删除框，则可能需要设置 N:M 关系，其中表格中的每一行都可以为每个复选框设置一个值。这将需要一个单独的表来存储复选框，以及一个中间表来存储表 A 中的每一行对于每个复选框的值。像：

```
/* Your table */
+-----+
| AID | 
+-----+ 
| 1   |
| 2   |
| 3   | 
+-----+

/* The table for the boxes */
+-------+-------+
| BoxID | Label |
+-------+-------+
| 1     | Box1  |
| 2     | Box2  |
| 3     | Box3  |
+-------+-------+

/* The intermediary table 
 * linking them together */
+-----+-------+-------+
| AID | BoxID | Value |
+-----+-------+-------+
| 1   | 1     | TRUE  |
| 1   | 2     | FALSE |
| 2   | 1     | TRUE  |
| 2   | 3     | FALSE |
| 3   | 2     | TRUE  |
| 3   | 3     | FALSE |
+-----+-------+-------+ 
```

# twitter-bootstrap - 引导单选按钮取消选择

> ID：14390675
> 
> 赞同：9
> 
> 时间：2013-01-18T00:35:12.097
> 
> 标签：twitter-bootstrap, radio-button

我只想在下面选择一个可以正常工作的选项，但也想取消选择一个选项，引导程序没有选择任何内容。有没有办法做到这一点？

```
<div class="btn-group" data-toggle="buttons-radio">
     <button data-toggle="button" class="btn btn-small">1</button>
     <button data-toggle="button" class="btn btn-small">2</button>
     <button data-toggle="button" class="btn btn-small">3</button>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:00:51.837

你必须用 Javascript 来做到这一点：

```
$(".btn-group button").removeClass("active"); 
```

见这里：http: [//jsfiddle.net/TrPFf/2/](http://jsfiddle.net/TrPFf/2/)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-11-07T17:01:00.080

如果您使用的是 Bootstrap 的 Button 插件，您可以将单选按钮包装在“按钮”标签中，如下所示：

```
<div class="btn-group" data-toggle="buttons">
  <label class="btn btn-primary">
    <input type="radio" name="options" id="option1"> Option 1
  </label>
  <label class="btn btn-primary">
    <input type="radio" name="options" id="option2"> Option 2
  </label>
  <label class="btn btn-primary">
    <input type="radio" name="options" id="option3"> Option 3
  </label>
</div> 
```

这使得 HTML 更加语义化，并且更容易获得用户输入。

# android - 加速度计在所有设备中都不能正常工作

> ID：14390679
> 
> 赞同：1
> 
> 时间：2013-01-18T00:35:49.350
> 
> 标签：android, andengine, accelerometer

这是一个非常开放的问题。

我们使用 Andengine 为安卓开发了一款游戏。僵尸向你袭来，它们“抓住”你，为了摆脱它们，你必须移动设备。多个设备中存在一个错误，无法通过移动设备来摇晃僵尸。我们无法在我们用于测试游戏的设备上复制此错误。

所以我的问题是：**硬件是否有可能与某些 android 功能不完全兼容？我的意思是那里有大量的安卓设备。**

我问这个问题是为了更好地了解如何进行。我们应该进一步挖掘编程（就像我们一直在做的那样，没有成功）还是实现一种不同的方式来摇动僵尸（没有加速度计）。

提前致谢

如果有人想更好地了解错误 [https://play.google.com/store/apps/details?id=com.exmgames.cfdesperationlite](https://play.google.com/store/apps/details?id=com.exmgames.cfdesperationlite)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T17:10:48.463

问题可能与加速度计的频率有关。注册时不要使用以下 android 常量。

```
mSensorManager.registerListener(this, mAccelerometer, SensorManager.SENSOR_DELAY_NORMAL); 
```

这些值对于不同的设备是不同的。即例如：SENSOR_DELAY_UI 在一个设备中提供 100Hz，在另一个设备中提供 50Hz，在另一个设备中提供 125Hz。始终使用硬编码频率。

```
int SENSOR_DELAY_FASTEST    get sensor data as fast as possible
int SENSOR_DELAY_GAME   rate suitable for games
int SENSOR_DELAY_NORMAL rate (default) suitable for screen orientation changes
int SENSOR_DELAY_UI rate suitable for the user interface 
```

使用以微秒为单位的硬编码值，例如频率 1 Hz

```
mSensorManager.registerListener(this, mAccelerometer,1000000); 
```

希望它解决。

# java - 使用 Gson 创建 JSON 时 POJO 中黑色字段的影响

> ID：14390681
> 
> 赞同：0
> 
> 时间：2013-01-18T00:36:01.850
> 
> 标签：java, json, gson

我正在尝试将 JSON 字符串转换为 POJO 和从 POJO 转换。我想知道对于不同类型的 json 是否最好有一个新的类定义。正如我认为让 google gson 必须解析空字段会减慢它的速度。（不是很明显，但仍然。我认为值得进行实验并在此处发布。）例如登录客户端可能是。

```
public class CustomJSON {
    private String name;

    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
} 
```

但我可以从客户那里收到其他东西，例如。最喜欢的颜色，食物等。

```
public class CommonJSON {
    private String name;
    private String food;
    private String music;

    //getters and setters.
} 
```

所以我进行了测试。

CustomJson 与上面相同，并且使用 CommonJSON 我添加了 50 个其他空字段，这些字段将不使用 a 到 ax。

```
public class CommonJSON {
    private String name;
    private String a;
          ...
    private String ax;

    //getters and setters.
} 
```

我运行测试的主要方法如下。

```
public static void main(String[] args) {
        // TODO Auto-generated method stub

        String theJSON = "";

        int passes = 100;
        long start;
        long finish;
        long exeTime;

        Gson gson = new Gson();

        //custom JSON
        start = System.nanoTime();
        for(int i=0;i<passes;i++)
        {
            CustomJSON custom = new CustomJSON();
            custom.setName("StackOverFlow");            
            theJSON = gson.toJson(custom);
        }
        finish = System.nanoTime();
        System.out.println(theJSON);
        exeTime = finish-start;
        System.out.println("Custom JSON \n\t>\t "+(exeTime)+" Nano seconds");
        System.out.println(" \t>\t "+Math.round((exeTime)/1000000.0)+" Micro seconds\n");

    //common JSON
    start= System.nanoTime();
    for(int i=0;i<passes;i++)
    {
        CommonJSON toClientJSONd = new CommonJSON();
        toClientJSONd.setName("StackOverFlow");
        theJSON = gson.toJson(toClientJSONd);
    }
    finish = System.nanoTime();
    System.out.println(theJSON);
    exeTime = finish-start;
    System.out.println("Common JSON \n\t>\t "+(exeTime)+" Nano seconds");
    System.out.println(" \t>\t "+Math.round((exeTime)/1000000.0)+" Micro seconds");

} 
```

The results are not as I expected. With 100 passes the common class finishes 10ms faster on my machine. If I increase the number of passes the common class eventually starts to lag behind.

**What makes the common class faster to start of with? Should I worry about this in my code or just use one class for a common class for all jsons?**

I can provide full source and an eclipse project if anyone would like to run it.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:53:01.167

You seem to be experiencing the effects of the JVM warming up. See [this](https://stackoverflow.com/questions/4345999/avoid-jvm-warmup) SO post for more info.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T16:50:51.803

To answer the other part of my question. For Simple JSON objects its neater to use the JsonObject from the GSON lib and add properties.

```
JsonObject json = new JsonObject();
json.addProperty("myBool", false); 
```

# python - 如何使用非官方的 Google Trend API (pyGTrends.py)

> ID：14390685
> 
> 赞同：3
> 
> 时间：2013-01-18T00:37:04.060
> 
> 标签：python, google-trends

我开始学习python来制作一个用于抓取网络数据的程序。所以我在谷歌上搜索，发现了谷歌趋势 API，pyGTrend.py。但我不能使用它。我可以在谷歌找到同样的问题，但没有我能理解的解决方案。请帮我。

我刚刚使用了 API 所有者网站上所写的 API：[Programmatic Google Trends Api](http://www.juiceanalytics.com/writing/programmatic-google-trends-api/)

```
from pyGTrends import pyGTrends

connector = pyGTrends('googleID','passwaord')
connector.download_report(('banana', 'bread', 'bakery'),date='2008-4',geo='AT',scale=1)
print connector.csv() 
```

错误信息如下，

```
Traceback(most recent call last):
File ('Stdin') line1, in <Module>
File "C:\Pyhon27\Lib\site-pacakage\pyGTrends.py" line 115, in csv
KeyError: 'main' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-06T21:41:51.383

你需要这样称呼它

```
from pytrends.pyGTrends import pyGTrends 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-29T02:38:32.940

这是一个如何使用它的示例。如果您需要进一步的帮助，请告诉我：

```
from pytrends.pyGTrends import pyGTrends
import time
from random import randint
from IPython.display import display
from pprint import pprint
import urllib
import sys

google_username = "GMAIL_USERNAME"
google_password = "PASSWORD"
path = "."

terms = [
    "Image Processing",
    "Signal Processing",
    "Computer Vision",
    "Machine Learning",
    "Information Retrieval",
    "Data Mining"
]
# connect to Google Trends API
connector = pyGTrends(google_username, google_password)

for label in terms:
    print(label)
    sys.stdout.flush()
    #kw_string = '"{0}"'.format(keyword, base_keyword)
    connector.request_report(label, geo="US", date="01/2014 96m")
    # wait a random amount of time between requests to avoid bot detection
    time.sleep(randint(5, 10))
    # download file
    connector.save_csv(path, label)

for term in terms:
    data = connector.get_suggestions(term)
    pprint(data) 
```

# android - 为什么我在注册 facebook 应用时会得到不同的 keyhashes？

> ID：14390688
> 
> 赞同：1
> 
> 时间：2013-01-18T00:37:17.993
> 
> 标签：android, facebook

我试过了

```
keytool -exportcert -alias androiddebugkey -keystore ~/.android/debug.keystore | openssl sha1 -binary | openssl base64 
```

我得到一个 keyhash `1knQ67Fx4PUOYXggSe+mnzqaTL8=`。

但是[谷歌自己的文档也提出了另一种选择](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/)。

```
try {
    PackageInfo info = getPackageManager().getPackageInfo(
            "com.facebook.samples.hellofacebook", 
            PackageManager.GET_SIGNATURES);
    for (Signature signature : info.signatures) {
        MessageDigest md = MessageDigest.getInstance("SHA");
        md.update(signature.toByteArray());
        Log.d("KeyHash:", Base64.encodeToString(md.digest(), Base64.DEFAULT));
        }
} catch (NameNotFoundException e) {
} catch (NoSuchAlgorithmException e) {
} 
```

但这会产生`UR02fNgzyMOjpWCxUnjGZ4ctF6Y=`. 我已经双重验证了这一点，并且我通过各自的方法得到了这两个值。

*为什么它们不同？我应该在developers.facebook.com 注册哪一个？*文档似乎不是很清楚。

**编辑：**

正如 Offbeatmammal 所说，我可以在 facebook 网站上注册多个密钥。所以没关系。但我还应该在应用程序清单文件中指定 keyhash。*所以另外问：我应该在应用程序中使用哪一个*？我当然可以尝试，但也欢迎回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T02:25:53.410

您的应用程序基本上需要至少 2 个密钥哈希。这是假设，您只在一台计算机上工作。对于额外的计算机，您需要在开发者控制台中为您的应用设置生成并添加一个密钥哈希。

**解释：**

当您测试您的应用程序时，eclipse（与 ADT / SDK 结合使用）将始终使用 将**`debug.keystore`**应用程序推送到设备或模拟器。发布应用程序时，您使用为应用程序生成的密钥库（用于发布到 Google Play）。

Facebook 需要 debug.keystore 和您自己的密钥库的密钥哈希。

为了解决您使用 2 种不同方法获得不同密钥哈希的担忧，这是我在开始使用 Facebook Android SDK 时遇到的问题。为了避免这种情况，我找到了一个始终有效且始终精确的解决方案。您可以按照这些答案中的步骤进行操作（它们几乎相同），您的 Key Hash 将立即工作：

1.  [https://stackoverflow.com/a/13283088/450534](https://stackoverflow.com/a/13283088/450534)
2.  [https://stackoverflow.com/a/13343529/450534](https://stackoverflow.com/a/13343529/450534)
3.  [https://stackoverflow.com/a/10516629/450534](https://stackoverflow.com/a/10516629/450534)（解决方案在此评论中）

所以，总结一下：

1.  尝试使用上面提供的链接中的步骤，让 Facebook SDK 告诉您正确的密钥哈希。
2.  至于要使用哪个 Key Hash：您不必决定。由于您已经将两个密钥哈希都添加到了开发者控制台，因此 Facebook 将自动使用适当的一个。
3.  我不知道需要将密钥哈希添加到`Manifest`文件中。这可能是 Facebook SDK v3 的要求。在这种情况下，在测试时，使用使用创建的 Key Hash **`debug.keystore`**，当您准备发布应用程序时，更改为使用您的**发布密钥库**创建的 Key Hash 。

希望这能解决您的问题。

**编辑**

正如已经指出的 Offbeatmammal 一样，您可以向开发者控制台添加多个密钥哈希。因此，您不必担心存储和使用多个 Key Hash。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:40:05.270

我一直使用 keytool 签名。好消息是您注册签名的 Facebook 表单支持多个签名（如果您要处理多个应用程序，或者需要支持多个应用程序商店并最终得到不同的哈希值，这很方便）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-13T02:43:00.193

我遇到了同样的问题。但最后我通过指定存储密码得到了相同的密钥哈希

`keytool -exportcert -alias androiddebugkey -keystore keystore/debug.keystore -storepass yourstorepass | openssl sha1 -binary | openssl base64`

# jquery - 通过数据属性将 HTML 表格元素转换为 JSON

> ID：14390697
> 
> 赞同：1
> 
> 时间：2013-01-18T00:38:31.170
> 
> 标签：jquery, json, html

我是 jQuery 的新手！

有没有办法将表格元素数据转换为 JSON？请参阅下面的示例图片。

![在此处输入图像描述](../Images/44a7b0734a1199ce4ea95e4d11ff5351.png)

JSON 结果在`#result`div 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:17:14.920

```
var arr = $('tr').map(function () {
    var o = {
        "apvhdrid": this.parentNode.parentNode.dataset.apvhdrid,
        "id": this.dataset.id
    };
    $('td', this).each(function () {
        for (key in this.dataset) {
            o[key] = this.dataset[key];
        }
    })
    return o;
}).get();

$('#result').text(JSON.stringify(arr)); 
```

[http://jsfiddle.net/pE8Hu/](http://jsfiddle.net/pE8Hu/)

# c# - 同步实现异步接口？

> ID：14390701
> 
> 赞同：3
> 
> 时间：2013-01-18T00:39:00.827
> 
> 标签：c#, asynchronous, task-parallel-library

我必须实现一个 C# 接口方法，例如：

```
Task<Foo> ExecuteAsync(); 
```

但是这个特定的实现实际上是同步的。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T02:57:08.750

如果您使用的是 .Net 4.0，则需要使用`TaskCompletionSource`，设置其结果，然后返回`Task`.

在 .Net 4.5 / C# 5.0 上，您有两个选择：使用`Task.FromResult()`或将您的方法变成`async`没有任何`await`. 第二种方法效率较低，并且会产生警告，所以我会选择第一种方法。

# google-chrome - 在浏览器中查看 Sketchup/CAD 模型

> ID：14390704
> 
> 赞同：0
> 
> 时间：2013-01-18T00:39:17.510
> 
> 标签：google-chrome, browser, cad

我希望 Sketchup/CAD 模型可以在浏览器（最好是 Chrome）中查看。给定陀螺仪的俯仰、偏航和滚动测量值，我希望 CAD 模型能够响应这些测量值。我将如何去做这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T20:43:51.270

一种可能的解决方案是Electric Rain 的[Swift 3D](http://www.erain.com/)，但我完全没有这方面的经验。

# php - 在 MySQL 表中设置每个用户 ID 的最大条目数

> ID：14390705
> 
> 赞同：0
> 
> 时间：2013-01-18T00:39:23.917
> 
> 标签：php, mysql, sql

说我有下表

```
//table user_update
update_id   |   userid   |   update_message   |   timestamp 
```

有没有办法设置每个用户标识的最大条目数？我想让它在用户输入 5 个更新之后，之后输入的任何更新都会删除最旧的更新。我知道如何通过 PHP 做到这一点，只是好奇是否有任何方法可以通过 MySQL 做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:50:26.027

这实际上是可能的。但如果你真的想做出这样的努力，那就值得怀疑了。

阅读一些关于“触发器”的内容。当满足某些条件时，您可以使用触发器来启动操作。这样，您可以触发对该表`delete`上的每个操作的操作。`insert`然后剩下的就是最多保留五个条目的条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:50:51.143

我能想到做这个数据库端的唯一方法是`TRIGGER`在表上使用 a 。也许是这样的：

```
CREATE TRIGGER check_for_too_many_rows
AFTER INSERT ON User_Update
FOR EACH ROW BEGIN
   DO SOME LOGIC TO CHECK THE COUNT AND DELETE IF MORE THAN 5...
END; 
```

以下是一些附加信息：

[http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html](http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html)

祝你好运。

# java - 如何让 Maven 将我的项目部署到远程 JBoss AS7 服务器

> ID：14390706
> 
> 赞同：1
> 
> 时间：2013-01-18T00:39:27.957
> 
> 标签：java, maven, jboss, jboss7.x

如果我这样做，如何让 Maven 将我的项目部署到远程 JBoss AS7 服务器

**mvn 安装**

但如果我做一个，我希望它部署到我的本地 JBoss AS7 服务器

**mvn jboss-as:deploy**

下面是我的 POM.XML 文件：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.xxxx</groupId>
    <artifactId>MavenJbossWebDemo</artifactId>
    <packaging>war</packaging>
    <version>0.0.1-SNAPSHOT</version>
    <name>Maven and JBoss WebDemo Webapp</name>
    <url>http://maven.apache.org</url>

    <properties>
        <java-version>1.7</java-version>
        <deploy.jboss.host>xxx</deploy.jboss.host>
        <deploy.jboss.user>xx</deploy.jboss.user>
        <deploy.jboss.password>xx</deploy.jboss.password>
    </properties>

    <dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>
    </dependencies>
    <build>
        <finalName>MavenJbossWebDemo</finalName>

        <plugins>
            <plugin>
                <groupId>org.jboss.as.plugins</groupId>
                <artifactId>jboss-as-maven-plugin</artifactId>
                <version>7.2.Final</version>
            </plugin>

            <plugin>
                <groupId>org.jboss.as.plugins</groupId>
                <artifactId>jboss-as-maven-plugin</artifactId>
                <version>7.2.Final</version>
                <configuration>
                    <hostname>${deploy.jboss.host}</hostname>
                    <port>${deploy.jboss.port}</port>
                    <username>${deploy.jboss.user}</username>
                    <password>${deploy.jboss.password}</password>
                    <name>${backend.deployment-name}</name>
                    <filename>${project.build.finalName}.war</filename>
                    <skip>${skipDeployment}</skip>
                </configuration>
                <executions>
                    <execution>
                        <id>deploy-jar</id>
                        <phase>install</phase>
                        <goals>
                            <goal>deploy</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project> 
```

# javascript - 视觉力远程无序列化器

> ID：14390707
> 
> 赞同：0
> 
> 时间：2013-01-18T00:39:29.560
> 
> 标签：javascript, extjs, apex-code, visualforce, serialization

我正在使用 sencha 和 salesforce 构建移动 SDK。我的应用程序工作得很好，我可以从 salesforce 查询对象以及插入。但是在将我同事的代码添加到我的项目中后，我在浏览器的 javascript 控制台中遇到了一个错误，我可以不再导航到我的页面，但只能导航到他的页面，但是当我转到他的页面时，我无法查询任何对象. 如果我将我的代码添加给我的同事，它就可以正常工作。我忘了配置什么吗？错误在下面，我打开它，这样我们就可以看到堆栈了。

```
Visualforce Remoting Exception: No serializer found for class core.filemanager.FileBlobValue
VFRemote.js:114
$VFRM.Util.errorVFRemote.js:114
(anonymous function)VFRemote.js:129
a.Event.fireVFRemote.js:48
a.Observable.fireEventVFRemote.js:43
_Visualforce.Direct._Visualforce.extend.onProviderDataVFRemote.js:83
a.Event.fireVFRemote.js:48
a.Observable.fireEventVFRemote.js:43
_Visualforce.direct.RemotingProvider._Visualforce.extend.onDataVFRemote.js:91
_Visualforce.extend.handleResponseVFRemote.js:72
aVFRemote.js:35
(anonymous function) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T03:29:39.453

我认为从错误消息中可以看出，您正在尝试使用 VF Remote 调用检索二进制数据 (FileBlobValue)。它说它不能序列化二进制数据。

FileBlobValue 可能不是代码中的文字变量，因此请尝试考虑您正在检索的所有数据并确定其中是否包含 blob 或二进制文件，然后从选择中删除可疑字段。

如果您手动有意识地尝试返回一个 blob，请将其编码为 base64。

# xcode - MKMapView setRegion：动画：使应用程序崩溃（已编辑）

> ID：14390708
> 
> 赞同：2
> 
> 时间：2013-01-18T00:39:30.297
> 
> 标签：xcode, ios6, mkmapview, mkannotation, mkmapviewdelegate

我有一个 MKMapView，它在点击时（垂直）扩展（使用 UITapGestureRecognizer）并在 pan 上触发 api 调用（使用 UIPanGestureRecognizer）。

一切正常，直到一段时间后，在平移时，应用程序会崩溃，几乎没有任何有用的信息（或我能理解的信息）

异常断点已打开，并且僵尸对象已启用。在崩溃时，它永远不会遇到异常断点！

这是日志：（平移开始、平移、平移结束根据平移手势识别器状态打印出来）。平移结束后，应用程序立即崩溃。（地图尚未加载其所有图块，并且尚未调用 regionDidChangeAnimated）：

```
2013-01-17 14:46:04.396 MyApp[13126:c07] Panning Began
2013-01-17 14:46:04.412 MyApp[13126:c07] Panning
2013-01-17 14:46:04.412 MyApp[13126:c07] Panning
2013-01-17 14:46:04.557 MyApp[13126:c07] Panning
2013-01-17 14:46:04.606 MyApp[13126:c07] Panning
2013-01-17 14:46:04.691 MyApp[13126:c07] Panning Ended
2013-01-17 14:46:04.692 MyApp[13126:c07] *** -[MKMapViewPositioningChange hasChanges]: message sent to deallocated instance 0x139f7520 
```

这是我在崩溃后看到的回溯：

```
(lldb) bt
* thread #1: tid = 0x1c03, 0x02a4fa97 CoreFoundation`___forwarding___ + 295, stop reason = EXC_BREAKPOINT (code=EXC_I386_BPT, subcode=0x0)
    frame #0: 0x02a4fa97 CoreFoundation`___forwarding___ + 295
    frame #1: 0x02a4f94e CoreFoundation`_CF_forwarding_prep_0 + 14
    frame #2: 0x01244d27 MapKit`-[MKMapView(UserPositioningInternal) _runPositioningChange] + 2037
    frame #3: 0x01242dd7 MapKit`-[MKMapView(UserPositioningInternal) _runPositioningChangeIfNeeded:] + 86
    frame #4: 0x01240220 MapKit`-[MKMapViewInternal runPositioningChangeIfNeeded] + 50
    frame #5: 0x01e2eb90 Foundation`__NSFireTimer + 97
    frame #6: 0x02a1f376 CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + 22
    frame #7: 0x02a1ee06 CoreFoundation`__CFRunLoopDoTimer + 534
    frame #8: 0x02a06a82 CoreFoundation`__CFRunLoopRun + 1810
    frame #9: 0x02a05f44 CoreFoundation`CFRunLoopRunSpecific + 276
    frame #10: 0x02a05e1b CoreFoundation`CFRunLoopRunInMode + 123
    frame #11: 0x03c897e3 GraphicsServices`GSEventRunModal + 88
    frame #12: 0x03c89668 GraphicsServices`GSEventRun + 104
    frame #13: 0x0132d65c UIKit`UIApplicationMain + 1211
    frame #14: 0x0001223d MyApp`main + 141 at main.m:16
    frame #15: 0x00002fc5 MyApp`start + 53 
```

当我为 PanGestureRecognizer 操作方法建立连接时，崩溃就消失了。

有没有办法在使用手势识别器时摆脱这种崩溃？或者有没有办法知道地图被点击和平移，而不使用 GestureRecognizers？

任何帮助/问题/答案/评论表示赞赏！

* * *

更新（1 月 19 日）：这似乎根本不是平移手势识别器的问题。现在，在我尝试向 mapview 添加新注释，调用 [MapView setRegion: animated:] 并在 regionDidChangeAnimated 被击中之前崩溃，在它崩溃的地方使用相同的 [MKMapViewPositioningChange hasChanges] 日志，现在我让它崩溃了.

* * *

更新（1 月 23 日）：我想我很确定发生了什么。有一段代码试图设置区域以包含 MKMapView 可见矩形中的所有注释，以及我正在调用的其他一些位置 [myMapView removeAnnotations:[myMapView annotations]]。而且，我的猜测是，这两个动作最终会导致令人讨厌的空中碰撞，没有留下任何导致坠机的线索。如果我的预感修复通过了 QA，将用答案更新问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T06:56:12.530

正如我之前所猜测的（问题的第二次更新），这是尝试添加地图区域以显示所有注释并同时删除所有注释的问题。如果您正在调用 setRegion: animated: ，请确保检查 mapView 是否至少有一个注释。

此外，明智地使用以下代码会很有帮助，尤其是当您根据注释在地图上执行任何类型的动画时。

[MKMapView removeAnnotations:[MKMapView 注释]];

# asp.net-mvc - 使用 ViewModel 屏蔽可为空的域属性

> ID：14390711
> 
> 赞同：3
> 
> 时间：2013-01-18T00:39:45.817
> 
> 标签：asp.net-mvc, asp.net-mvc-3, viewmodel, nullable

我正在使用 Entity Framework 4.0，并使用 POCO 对象。当我从数据库中填充 POCO 对象时，我将属性值转换为我自己的域对象，我们可以将其称为我的模型。

必然地，我的 Model 的字段是否为 Nullable 取决于它在数据库中映射到的值是来自 NULL 还是 NOT NULL 列。我不会详细介绍，但这些值在数据库中必须可以为空，因为用户可以在将对象发布给公众之前部分保存对象的草稿。在这种情况下，我有几个可以为空的字段。所以假设我的模型看起来像：

```
public class MyModel
{
   public int? Field1 {get; set; }
   public DateTime? Field2 {get; set; }
   public int Field3 {get; set; }
} 
```

如果我在我的视图中使用这个模型，并带有可空字段，我开始收到错误消息，告诉我我不能在不同的地方使用可空属性作为值，比如 HTML 帮助器等。我可以说类似的东西`if (Model.MyBoolField.HasValue && Model.MyBoolField.Value) { // etc }`，但对于一个看法。

我考虑创建一个 ViewModel 对象，该对象继承自我的原始域对象，并且`new`如果基本版本为空，我的可空字段的不可空版本会返回适当的值。所以像：

```
public class MyViewModel : MyModel
{
   public new int Field1
   {
      get { return base.Field1 ?? 7; }
   }

   public new DateTime Field2
   {
      get { return base.Field2 ?? DateTime.Now; }
   }
} 
```

我的问题是我并不总是知道要显示的好的“默认”值。如果当基值为 null 时我在 View Model 的 getter 中抛出异常怎么办？这是不好的做法吗？

我基本上是在寻找关于如何处理模型中的可为空字段的最佳实践，尤其是在视图中显示时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:53:59.843

如果只需要在 View 中显示这些字段，则不需要指定或检查 is 是否有值。

在您的视图文件中使用`Model.Field1`就足够了。它不会显示任何内容，也不会抛出`exception`. `??`有意义时，您始终可以使用它来设置默认值。

```
@(Model.Field1 ?? "There is nothing to see here") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:04:45.803

在大多数情况下，我使用“For”帮助器，它看起来可以使用`Nullable`值（`PublishedCount`是一个可为空的属性）：

```
@Html.TextBoxFor(m => m.BillPull.PublishedCount, new { id="txtPublishedCount" })
@Html.ValidationMessageFor(m => m.BillPull.PublishedCount) 
```

当我需要使用 just`TextBox`时，我使用该`GetValueOrDefault`方法，以及框架提供的任何默认值：

```
@Html.TextBox("BillPull.AutoPublishDate", Model.BillPull.AutoPublishDate.GetValueOrDefault().ToString(dateFormat), new { id = "dtpAutoPublishDate" })
@Html.ValidationMessageFor(m => m.BillPull.AutoPublishDate) 
```

# bash - bash shell 脚本中大于 255 的数字

> ID：14390716
> 
> 赞同：5
> 
> 时间：2013-01-18T00:40:12.050
> 
> 标签：bash, shell

如何返回大于 255 的数字

```
function returnnumber(){
    x=256
    return $x
}

returnnumber
echo "value: $?" 
```

我想输入 256 和 256 返回

但是 256 返回 0。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T01:02:17.527

你不能！Shell 函数实际上并不*返回*任何内容，它们只是以退出状态退出，就像其他 UNIX 命令一样。和其他 UNIX 命令一样，它们的[退出状态](http://en.wikipedia.org/wiki/Exit_status#Unix)必须是无符号字节。

如果要存储命令的输出（包括函数），可以按通常的方式捕获其标准输出。

```
d() {
    echo 'hi'
}
x=$(d)
echo "$x"
hi 
```

这是[Wooledge 的关于从命令中获取值的 wiki](http://mywiki.wooledge.org/BashFAQ/002)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-18T01:02:50.927

在 bash 中，`return`不会像您期望的其他编程语言那样做：

> 简单命令的**返回**值是它的退出状态，如果命令被信号 n 终止，则*返回128+* *n*。

 *此代码将起作用：

```
#!/bin/bash

function returnnumber(){
    echo $1
}

returnnumber 256 
```*

# android - 位置侦听器之谜

> ID：14390721
> 
> 赞同：0
> 
> 时间：2013-01-18T00:40:23.283
> 
> 标签：android, service, locationlistener

我有一项服务（它扩展了服务）。在 onCreate 事件中，我执行以下操作...

```
 locMgr = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
    locLstnr = new MyLocationListener();
    locMgr.requestLocationUpdates(LocationManager.GPS_PROVIDER, 10000, 10, locLstnr); 
```

（顺便说一句，我有这个设置为 10 秒的间隔，它至少每秒熄灭一次）

我所有的信息都表明，如果您有一个扩展 Service 的服务，那么无论活动启动该服务多少次，它都不会启动另一个服务，也不会再次通过 onCreate 事件（尽管它确实再次通过 onStartCommand）。

我的日志中有强有力的证据表明我得到了多个 MyLocationListener 实例。有时2份，有时4份，有时8份。如果不是这样，我将获得我的服务的多个副本。

谁能看到可能导致这种情况的原因？
谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T02:45:16.903

除非它杀死原始服务，否则它不会再次通过 onCreate 。由于未知原因，它经常这样做。然后它重新创建它。解决此问题的廉价方法是让您的 onCreate 函数启动您自己的服务，使其保持常驻。但是，您仍然会丢失内存的内容。

# java - java正则表达式模式未封闭字符类

> ID：14390722
> 
> 赞同：5
> 
> 时间：2013-01-18T00:40:23.340
> 
> 标签：java, regex, matcher

我需要帮助。我越来越：

```
Caused by: java.util.regex.PatternSyntaxException: Unclosed character class near index 24
^[a-zA-Z└- 0-9£µ /.'-\]*$
                        ^
        at java.util.regex.Pattern.error(Pattern.java:1713)
        at java.util.regex.Pattern.clazz(Pattern.java:2254)
        at java.util.regex.Pattern.sequence(Pattern.java:1818)
        at java.util.regex.Pattern.expr(Pattern.java:1752)
        at java.util.regex.Pattern.compile(Pattern.java:1460)
        at java.util.regex.Pattern.<init>(Pattern.java:1133)
        at java.util.regex.Pattern.compile(Pattern.java:823) 
```

这是我的代码：

```
String testString = value.toString();

Pattern pattern = Pattern.compile("^[a-zA-Z\300-\3770-9\u0153\346 \u002F.'-\\]*$");
Matcher m = pattern.matcher(testString); 
```

我必须对某些使用 unicode 值，因为我正在使用 xhtml。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-18T00:53:24.510

假设您要匹配`\`and`-`而不是`]`：

```
Pattern pattern = Pattern.compile("^[a-zA-Z\300-\3770-9\u0153\346 \u002F.'\\\\-]*$"); 
```

您需要双重转义反斜杠，`\`正则表达式中的转义字符也是如此。因此`\\]`转义了 java 的反斜杠，但不是正则表达式。您需要添加另一个 java-escaped`\`以便对您的第二个 java-escaped 进行正则表达式转义`\`。

所以`\\\\`在 java 转义之后变成`\\`which 正则表达式转义到`\`.

移动`-`到序列的末尾意味着它被用作字符，而不是 Pshemo 指出的范围运算符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T00:46:31.357

很难说你想要实现什么，但我可以在你的正则表达式中看到一些奇怪的东西：

1.  您已经打开了一类字符，但从未关闭它。取而代之的是，您使用`\\]`了使`]`字符正常的。
    *   如果你想包含`]`在你的角色类中，那么最后你需要额外`]`的，比如`"^[a-zA-Z\300-\3770-9\u0153\346 \u002F.'-\\]]*$"`
    *   如果你想包含`\`在你的字符类中，那么你需要使用`\\\\`版本，因为你需要在正则表达式引擎和 Java 字符串中两次转义它的特殊含义
2.  您`-`与 ( `'-\\]`) 一起使用，它在字符类中用于指定字符范围，例如`a-z`or `A-Z`。为了逃避它的特殊含义，你需要使用`\\-`

# arrays - 在使用数组 [as3] 内的影片剪辑时遇到问题

> ID：14390728
> 
> 赞同：0
> 
> 时间：2013-01-18T00:41:12.937
> 
> 标签：arrays, actionscript-3, loops, actionscript

在我正在制作的游戏中，我试图将精灵放在命中框的顶部。我能想到的最好方法是制作两个数组；一个用于命中框，一个用于精灵，然后通过将在其自己的脚本中的 for 循环让精灵停留在各自的命中框之上。

问题是，当我尝试让任一数组中的 MovieClip 执行任何操作时，它都不起作用。如果我对精灵的 X 或 Y 位置进行跟踪，我会在终端中得到“未定义”。我将从上到下解释这一点。

这是我课程的摘录，其中包含 for 循环（Dasengine 是我的主要课程仅供参考）

```
for(var i:Number = 0; i < Dasengine.ovrcnt.length; i++){
        trace(Dasengine.ovrcnt[i].x); //returns "undefined"
                    trace(Dasengine.ovrcnt[i]); //returns "object Onmea"
Dasengine.ovrcnt[i].x = Dasengine.enemycnt[i].x;//this isn't working

            } 
```

在另一个脚本中，当敌人生成时，他们会通过这种方法。

```
if(ENEMY SPAWN CONDITION IS MET ){
 Dasengine.baddie = new nme_spawn.Enemya(); //ENEMY HITBOX
 Dasengine.Obaddie = new nme_overlay.Onmea(); //ENEMY's sprite

 Dasengine.enemycnt[cntup] = [Dasengine.baddie]; //Enemy's Hit box movie clip is put in array meant for holding enemy movie clips

 Dasengine.ovrcnt[cntup] = [Dasengine.Obaddie]; //Enemy sprites that go over the hit boxes are stored here
 cntup++; //this is so movie clips are put in new parts of the array

                } 
```

在我的主类中，影片剪辑声明如下，我也有 addChild 功能。

```
public static var Obaddie:nme_overlay.Onmea;
//^variable for sprite
public static var baddie:nme_spawn.Enemya;
//^variable for hitbox 
```

也 Obaddie = 覆盖坏人。它是作为 hitbox 顶部的 MovieClip，这是玩家将看到的

badde = 只是命中框。这包含了敌人ai的“肉”。

我和一些朋友讨论过这个问题，他们认为我可能需要在数组中的对象的类中定义“X”是什么。所以我做了以下

```
 package nme_overlay {

import flash.display.*;
import flash.events.*;
import nme_spawn.*;

    public class Onmea extends MovieClip{

        // Constants:
        // Public Properties:
        // Private Properties:
        public static var xloc:int = 0;
        // Initialization:

        public function Onmea() { 

        this.addEventListener(Event.ENTER_FRAME, overlaya);

        }

        private function overlaya(e:Event){
        xloc = 55;
        //trace(xloc);
        }

    }

} 
```

然后对于循环类我做了这个

```
 for(var i:Number = 0; i < Dasengine.enemycnt.length; i++){
        trace(Dasengine.ovrcnt[i]);//returns "object Onmea"
        trace(Dasengine.ovrcnt[i].xloc);//still returns "undefined"

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:58:48.867

您的 xloc 变量是静态的——它属于类 nme_overlay，而不是任何特定实例。如果你要在你的代码中执行此操作并且你有严格模式（我怀疑你没有，因为你的代码中有很多东西应该给你至少警告），你会得到一个错误确切地告诉你：

```
for(var i:Number = 0; i < Dasengine.enemycnt.length; i++){
        trace(Dasengine.ovrcnt[i]);//returns "object Onmea"
        trace(nme_overlay(Dasengine.ovrcnt[i]).xloc);//still returns "undefined"
} 
```

# mysql - 将子查询（根据排序选择记录）转换为 JOIN

> ID：14390729
> 
> 赞同：0
> 
> 时间：2013-01-18T00:41:35.000
> 
> 标签：mysql, sql, join

我有这个查询：

```
SELECT *
  FROM iptable
 WHERE ip = (SELECT ip
               FROM iptable
              WHERE name = 'username'
              ORDER BY date DESC
              LIMIT 0,1
            )
   AND name != 'username' 
```

这是它的作用：

*   用户输入一个名称（在本例中为*username*）
*   *查询从iptable*获取最新记录（仅限 IP）
*   它使用返回的 IP 在*iptable*中搜索**其他用户**

该查询运行良好，但我想知道是否可以使其使用 JOIN 而不是子查询？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:50:46.340

您正在从给定用户的最新 ip 中选择 ip 上出现的所有名称。（我最初误读了查询，所以这会有所帮助。）

以下将其转换为显式连接：

```
select ip.*
from iptable ip join
     (select date, max(ip) as maxip
      from iptable
      where name = 'username'
      group by date
      order by date desc
      limit 1
     ) ips
     on ips.maxip = ip.ip
where is.name <>  'username' 
```

（可能会假设名称和 ips 永远不会为 NULL。）

不过，我确实想指出，原始版本仍在进行连接，只是没有明确说明。

挑战是获取最近的 ip 作为名称。这是另一种方式，使用`group_concat`with `substring_index`：

```
select ip.*
from iptable ip join
     (select name,
             substring_index(group_concat(ip order by date desc), ',', 1) as lastip
      from iptable
      where name = 'username'
      group by name
     ) ips
     on ips.lastip = ip.ip
where ips.name <> ip.name 
```

# c - 我的 C 程序中的阶乘计算不正确？

> ID：14390731
> 
> 赞同：3
> 
> 时间：2013-01-18T00:41:40.220
> 
> 标签：c, factorial

```
#include <stdio.h>
#include <conio.h>

int main()
{
  long signed fact=1;

  int c, n ;

  printf("Factorial to be calculated: ");
  scanf("%d", &n);

  for (c = 1; c <= n; c++)
  fact = fact * c;

  printf("Factorial of %d = %ld\n", n, fact);
  getch();
  return 0;
} 
```

在上面的C程序中，当我运行时，我不能得到13！正确的。12 的输出为真。我该如何解决这个问题？我认为长期未签名就足够 13 了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T00:47:48.460

您的平台上可能`long`是 32 位的（您可以通过打印 的值来查找`sizeof(long)`）。13！大于 2^32-1（32 位无符号值的最大可能值），因此会溢出。

尝试使用`uint64_t`(from `<stdint.h>`) 代替。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T01:29:37.297

Oli 所说的是正确的——C 标准保证`long`至少是 32 位。在某些平台上可能更多。

你可以使用`unsigned long long`. 这至少是 64 位，但它仍然只能让您计算最多 20 位！

C FAQ 对整数大小有一个很好的概述：[我应该如何决定使用哪种整数类型？](http://c-faq.com/decl/inttypes.html)您可能想要寻找一个任意精度的库。

否则，如果您只想近似更大的阶乘，也许您可​​以使用[斯特林公式](http://en.wikipedia.org/wiki/Stirling%27s_approximation)。

# bash - 是什么导致监视管道文本干净地出现在终端中但在文本文件中带有特殊字符？

> ID：14390732
> 
> 赞同：2
> 
> 时间：2013-01-18T00:41:40.833
> 
> 标签：bash, encoding, watch

如果我运行这个命令：

```
traceroute -p 80 www.google.com. 2>&1|tee -a ~/tmp/traceroute.log 
```

终端内容与文件内容一致，干净（无特殊字符）

但是，如果我运行此命令：

```
watch -n5 "traceroute -p 80 www.google.com." 2>&1|tee -a ~/tmp/watch.log 
```

我在终端看到这个：

```
Every 5.0s: traceroute -p 80 www.google.com.            Fri Jan 18 11:27:41 2013

traceroute to www.google.com. (74.125.237.115), 30 hops max, 60 byte packets
 1  10.0.0.1 (10.0.0.1)  3.138 ms  3.351 ms  3.349 ms
 2  192.168.1.254 (192.168.1.254)  5.832 ms  6.043 ms  6.183 ms
 3  lback9.comcen.com.au (203.23.236.9)  31.569 ms  31.949 ms  33.484 ms
 4  core-syd-lns2.comcen.com.au (203.23.236.45)  48.331 ms  48.484 ms  48.720 ms
 5  * * *` 
```

这在日志文件中（SE 代码解析/显示阻塞如下）：

```
(B)0[?1049h[1;24r[m[4l[H[JEvery 5.0s: traceroute -p 80 www.google.com.[1;57HFri Jan 18 11:27:41 2013[3;1Htraceroute to www.google.com. (74.125.237.115), 30 hops max, 60 byte packets
[1B 1  10.0.0.1 (10.0.0.1)  3.138 ms  3.351 ms  3.349 ms 
```

[1B 2 192.168.1.254 (192.168.1.254) 5.832 ms 6.043 ms 6.183 ms [1B 3 lback9.comcen.com.au (203.23.236.9) 31.569 ms 31.949 ms 33.484 ms [1B 4 core-syd-lns2.comcen.com .au (203.23.236.45) 48.331 毫秒 48.484 毫秒 48.720 毫秒[8;2H5 * * * [1B 6 * * *

我检查了我的语言环境设置，并将它们粘贴到`~/.bashrc`

```
~$ locale
LANG=en_US.UTF-8
LANGUAGE=
LC_CTYPE="en_US.UTF-8"
LC_NUMERIC="en_US.UTF-8"
LC_TIME="en_US.UTF-8"
LC_COLLATE="en_US.UTF-8"
LC_MONETARY="en_US.UTF-8"
LC_MESSAGES="en_US.UTF-8"
LC_PAPER="en_US.UTF-8"
LC_NAME="en_US.UTF-8"
LC_ADDRESS="en_US.UTF-8"
LC_TELEPHONE="en_US.UTF-8"
LC_MEASUREMENT="en_US.UTF-8"
LC_IDENTIFICATION="en_US.UTF-8"
LC_ALL=en_US.UTF-8 
```

并在`~/.bashrc`：

```
export LC_ALL="en_US.UTF-8"
export LANG="$LC_ALL"
export LANGUAGE="$LC_ALLL"
export LC_CTYPE="$LC_ALL"
export LC_NUMERIC="$LC_ALL"
export LC_TIME="$LC_ALL"
export LC_COLLATE="$LC_ALL"
export LC_MONETARY="$LC_ALL"
export LC_MESSAGES="$LC_ALL"
export LC_PAPER="$LC_ALL"
export LC_NAME="$LC_ALL"
export LC_ADDRESS="$LC_ALL"
export LC_TELEPHONE="$LC_ALL"
export LC_MEASUREMENT="$LC_ALL"
export LC_IDENTIFICATION="$LC_ALL" 
```

有没有人了解导致这种情况的原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:59:37.763

Watch 每次显示新信息时都会清除屏幕。它通过打印到终端的特殊字符来做到这一点。在文件中，您只是看到这些字符被完全解释。如果您想看到真正的混乱，请尝试打开手表的一些其他功能，例如 --differences 突出显示。

# html - 从 gimp 生成的图像映射不起作用

> ID：14390735
> 
> 赞同：0
> 
> 时间：2013-01-18T00:42:10.460
> 
> 标签：html, image, imagemap

我使用 gimp 生成了这个图像映射，当我将代码添加到我的网站时，它就像那里根本没有链接一样。任何可能发生这种情况的原因。

```
<img src="images/footerlinks.jpg" width="175" height="66" border="0" usemap="#map"/>
<map name="map">
<!-- #$-:Image map file created by GIMP Image Map plug-in -->
<!-- #$-:GIMP Image Map plug-in by Maurits Rijk -->
<!-- #$-:Please do not edit lines starting with "#$" -->
<!-- #$VERSION:2.3 -->
<!-- #$AUTHOR:David -->
<area shape="rect" coords="32,72,239,415" nohref="nohref" /></area>
<area shape="rect" coords="393,320,483,336" href="http://www.dance-mate.com/details.html" /></area>
</map> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-18T01:15:47.973

您定义的`areas`超出图像边界（图像高 66 像素，第一个链接的顶部为 72 像素，第二个链接为 320 像素）。矩形中点的顺序是 `left, top, right, bottom`)。您是否缩小了图像，或者 Gimp 是否真的生成了图像边界之外的那些区域？

此外，[`area`它是一个 void 元素（自关闭）](http://www.w3.org/TR/html-markup/area.html)，`nohref`无效并确保为`alt`链接和图像添加属性（HTML 中的图像大小为 7 倍，以便您可以看到链接）：

```
<img src="images/footerlinks.jpg" width="1225" height="462" alt="foo" usemap="#map"/>
<map name="map">
  <area shape="rect" coords="32,72,239,415" href="#bar" alt="bar" />
  <area shape="rect" coords="393,320,483,336" href="#baz" alt="baz" />
</map> 
```

# c - (C) 程序不打印输入文件中的所有值

> ID：14390739
> 
> 赞同：0
> 
> 时间：2013-01-18T00:42:47.980
> 
> 标签：c

与 C 合作。

好的，所以这可能是显而易见的，但由于某种原因，我的程序只会从 .dat 输入文件中打印一定数量的值，而不是打印所有值。这是代码：

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{

int N = 0;
int j;
float i;

const char Project_Data[] = "FloatValues.dat";

FILE *input = fopen(Project_Data, "r");

if(input != (FILE*) NULL)
{
    while(fscanf(input, "%e", &i) == 1)
    {
        printf("%e\n",i);
        ++N;
    }
    printf("\t The number of values in this file is: %d\n", N);

    fclose(input);
}
else
    printf("Input file could not be read.\n");

return(0);
} 
```

是的，所以大约有 100000 个值要打印，但我似乎只能得到 20000 个。文件中的值是按顺序排序的，编译器似乎只在文件底部附近开始打印，大约 80000 或所以价值观。

有人知道我哪里出错了吗？

# c# - 绑定 DataTemplate 控件属性

> ID：14390743
> 
> 赞同：4
> 
> 时间：2013-01-18T00:43:26.977
> 
> 标签：c#, wpf, binding, datatemplate

我有`UserControl`以下类似：

```
<UserControl>
    <Expander> 
        <Expander.HeaderTemplate>
            <DataTemplate>
                <Grid HorizontalAlignment="{Binding Path=HorizontalAlignment, RelativeSource={RelativeSource AncestorType={x:Type ContentPresenter}}, Mode=OneWayToSource}">
                    <TextBlock Text="{Binding Path=Service, Mode=TwoWay}"/>
                </Grid>
            </DataTemplate>
        </Expander.HeaderTemplate>            
    </Expander>
</UserControl> 
```

我想将控件的`Text`属性绑定到我的类的属性，例如：`TextBlock``UserControl`

```
public string Service
{ get; set; } 
```

我能怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T01:02:33.240

尝试将 设置`DataContext`为 ，`UserControl`以便您可以访问属性

在这种情况下，我已将`UserControl`“UI”（`Name="UI"`）命名为，因此您可以使用绑定`ElementName` `Text="{Binding ElementName=UI, Path=Service}"`

例子：

```
<UserControl x:Class="WpfApplication8.UserControl1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300" Name="UI">
    <Expander>
        <Expander.HeaderTemplate>
            <DataTemplate>
                <Grid HorizontalAlignment="{Binding Path=HorizontalAlignment, RelativeSource={RelativeSource AncestorType={x:Type ContentPresenter}}, Mode=OneWayToSource}">
                    <TextBlock Text="{Binding ElementName=UI, Path=Service}" />
                </Grid>
            </DataTemplate>
        </Expander.HeaderTemplate>
    </Expander>
</UserControl> 
```

代码：

我已经实现`INotifyPropertyChanged`了这将允许在`Service`字符串更改时更新 UI

```
public partial class UserControl1 : UserControl, INotifyPropertyChanged
{
    public UserControl1()
    {
        InitializeComponent();
        Service = "Test";
    }

    private string _service;
    public string Service
    {
        get { return _service; }
        set { _service = value; NotifyPropertyChanged("Service"); }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }
} 
```

结果：

![在此处输入图像描述](../Images/170d8f455a349b6024a9e7bd9fba5efb.png)

# c - 无法在 C Fedora16 中关闭非阻塞 UDP 套接字

> ID：14390745
> 
> 赞同：0
> 
> 时间：2013-01-18T00:43:29.990
> 
> 标签：c, sockets, unix, udp, nonblocking

我使用 C 语言和 Fedora 16 操作系统构建了非常基本的 UDP 聊天。

当我的服务器连接时，他有 5 个端口并监听它们。

我的问题是：当我尝试使用新客户端连接到服务器但给他我的服务器不知道的端口时，我希望他立即退出。

我不知道如何检查“MSG_DONTWAIT”标志。

这是我的代码：

**服务器端：**

```
#define MAX_MESSAGE_SIZE 1024
#define SERVER_CONNECTIONS 5

// Implementation of server that manages a chat.
#include "server.h"

int main(int argc,char* argv[])
{
    if(argc != 2)  //check if user insert more then one argument to the program
    {
        printf("Usage server <port>\n‬‬");
        fflush(stdout);
        exit (-1);
    }

/*!
========Server creation flow:========
1) create the socket
2) bind the socket to a port
3) recvfrom (read from socket)
4) sendto (close the socket)
5) close the socket
*/

//!------------------------------------- 1) create the socket-------------------------------------
//!------------------------------- 2) bind the socket to a port-----------------------------------
    int fd[SERVER_CONNECTIONS];  //socket descriptor
    int port[SERVER_CONNECTIONS];  //socket fd port
    int i=0;
    for(i=0; i<SERVER_CONNECTIONS; i++)
    {
        port[i] = atoi(argv[1])+i;
    }
    create_sockets(fd, port);

    char buf[MAX_MESSAGE_SIZE]; //used by read() & write()
    int maxfd = find_maxfd(fd);
    struct sockaddr_in cli;  //used by read() & write()
    int cli_len = sizeof(cli);  //used by read() & write()

    fd_set readfds;
    fd_set writefds;
    struct timeval timeout;
    timeout.tv_sec = 1;
    int nbytes=0;

    while(1)
    {
        FD_ZERO(&readfds);
        FD_ZERO(&writefds);
        for(i=0; i<SERVER_CONNECTIONS; i++)
        {
            FD_SET(fd[i], &readfds);
            FD_SET(fd[i], &writefds);
        }

        /* Now use FD_SET to initialize other fd’s that have already been returned by accept() */
        if (select(maxfd+1, &readfds, 0, 0, 0) < 0)
        {
            perror("select");
            exit(1);
        }

        for(i=0; i<SERVER_CONNECTIONS; i++)
        {
//!------------------------------- recvfrom (read from socket)-----------------------------------
            if(FD_ISSET(fd[i], &readfds))
            {
                fprintf(stderr, "ready to read from %d\n", fd[i]);
                memset(&buf, 0, sizeof(buf)); //init buf
                if((nbytes = recvfrom(fd[i], buf, sizeof(buf), 0 /* flags */, (struct sockaddr*) &cli, (socklen_t*)&cli_len)) < 0)
                {
                    perror("recvfrom");
                    exit(1);
                }
//!------------------------------- sendto (close the socket)-----------------------------------
                FD_ZERO(&writefds);
                FD_SET(fd[i], &writefds);

                if (select(maxfd+1, 0, &writefds, 0, &timeout) < 0)
                {
                    perror("select");
                    exit(1);
                }

                if(FD_ISSET(fd[i], &writefds))
                {
                    fprintf(stderr, "ready to write to %d\n", fd[i]);
                    string_to_hex(buf);
                    if ((nbytes = sendto(fd[i], buf, strlen(buf), 0 /* flags */, (struct sockaddr*) &cli, sizeof(cli))) < 0)
                    {
                        perror("sendto");
                        exit(1);
                    }
                }
            }
        }
    }
    return 0;
}

void create_sockets(int fd[], int port[])
{
    int i=0;
    for(i=0; i<SERVER_CONNECTIONS; i++)
    {
//!------------------------------------- 1) create the socket-------------------------------------
        if((fd[i] = socket(PF_INET, SOCK_DGRAM, 0)) < 0)
        {
            perror("socket");
            exit(1);
        }

//!------------------------------- 2) bind the socket to a port-----------------------------------
        struct sockaddr_in srv;  //used by bind()
        srv.sin_family = AF_INET;  //use the Internet address family
        srv.sin_port = htons(port[i]);  //socket ‘fd’ to port
        srv.sin_addr.s_addr = htonl(INADDR_ANY);  //a client may connect to any of my addresses

        if(bind(fd[i], (struct sockaddr*) &srv, sizeof(srv)) < 0)
        {
            perror("bind");
            exit(1);
        }
    }
}

int find_maxfd(int fd[])
{
    int i=0;
    int res=fd[0];
    for(i=1; i<SERVER_CONNECTIONS; i++)
    {
        if(fd[i]>res)
        {
            res = fd[i];
        }
    }
    return res;
}

void string_to_hex(char buf[])
{
    int buf_size = strlen(buf);

    char result[buf_size*3+1];
    memset(&result, 0, sizeof(result));
    char temp[4];

    int i=0;
    for (i=0; i<buf_size-1; i++)
    {
        memset(&temp, 0, sizeof(temp));
        sprintf(temp, "%X:", (int)buf[i]);
        strcat(result, temp);
    }
    memset(&temp, 0, sizeof(temp));
    sprintf(temp, "%X", (int)buf[i]);
    strcat(result, temp);

    strcpy(buf, result);
} 
```

**客户端：**

```
#define MAX_MESSAGE_SIZE 1024

// Implementation of client that will use the chat.
#include "client.h"

int main(int argc,char* argv[])
{
    if(argc != 3)  //check if user insert more then one argument to the program
    {
        printf("Usage client <host name> <port>\n‬‬");
        fflush(stdout);
        exit(-1);
    }

/*!
========Client creation flow:========
1) create the socket
2) sendto (close the socket)
3) recvfrom (read from socket)
4) close the socket
*/

    fprintf(stderr, "please enter something: \n");

//!------------------------------------- 1) create the socket-------------------------------------
    int fd;  //socket descriptor
    if((fd = socket(PF_INET, SOCK_DGRAM, 0)) < 0)
    {
        perror("socket");
        exit(1);
    }

    struct sockaddr_in srv;  //used by sendto()

    srv.sin_family = AF_INET;
    srand ( time(NULL) );  //new random seed
    int rand_num = (rand() % 5) + atoi(argv[2]);  //
    srv.sin_port = htons(rand_num);

    char *srv_name = argv[1];
    struct hostent *hp; //ptr to host info for remote
    hp = gethostbyname(srv_name);
    if( hp == NULL)
    {
        herror("gethostbyname");
        exit(-1);
    }

    srv.sin_addr.s_addr = ((struct in_addr*)(hp->h_addr))->s_addr; //set IP Address to "srv_name"

    char buf[MAX_MESSAGE_SIZE]; //used by read() & write()
    int nbytes=0;
    while(1)
    {
//!------------------------------------- 2) sendto (close the socket)-------------------------------------
        memset(&buf, 0, sizeof(buf)); //init buf
        fgets(buf, sizeof(buf), stdin); //get input from user

        if(strcmp(buf, "quit\n") == 0)
        {
            break;
        }

        if(!((strlen(buf) == 1) && (buf[1] == '\n')))
        {
            buf[strlen(buf)-1] = '\0';
        }
        //write_to_server(fd, buf, srv);
        if ((nbytes = sendto(fd, buf, strlen(buf), MSG_DONTWAIT /* flags */, (struct sockaddr*) &srv, sizeof(srv)) < 0))
        {
            perror("sendto");
            exit(1);
        }

//!------------------------------------- 3) recvfrom (read from socket)-------------------------------------
        memset(&buf, 0, sizeof(buf)); //init read_buf
        //read_from_server(fd, buf);
        if((nbytes = recvfrom(fd, buf, sizeof(buf), 0 /* flags */, 0, 0) < 0))
        {
            perror("recvfrom");
            exit(1);
        }
        if( (errno == EAGAIN) || (errno == EWOULDBLOCK ) )
        {
            perror("EWOULDBLOCK");
            exit(1);
        }
        printf("%s\n", buf); //print result to client
        fflush(stdout);
    }
//!------------------------------------- close the socket-------------------------------------
    close(fd);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T08:07:07.043

我得到了它..

您需要使用客户端的连接功能和“MSG_DONTWAIT”标志。

然后当客户端连接并且您输入任何内容时，他会立即退出..

```
//!--------------- 2) connect to the server--------------------------
if(connect(fd, (struct sockaddr*) &srv, sizeof(srv)) < 0) //connect to server "srv_name"
{
    perror("connect");
    exit(-1);
} 
```

# c# - 为什么 XDocument 不能从这个格式良好的 XML 文本中获取元素？

> ID：14390749
> 
> 赞同：2
> 
> 时间：2013-01-18T00:44:04.340
> 
> 标签：c#, xml, linq-to-xml

我试图从以下 XML 文本中获取元素的值，但除非我从元素`Address`中删除，否则找不到它。但是，即使使用它，XML 也是有效的。这里有什么问题？`xmlns="http://www.foo.com"``Root`

由于我是从 Web 服务获取 XML 文本，因此我无法控制它，但`xmlns`如果我不得不作为最后的手段，我可​​以删除该部分。

```
<?xml version="1.0" encoding="utf-8"?>
<Root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
      xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
      xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
      xmlns="http://www.foo.com">
  <Address>Main St SW</Address>
</Root> 
```

```
var doc = XDocument.Parse(xmlTextAbove);
var address = doc.Descendants().Where(o => o.Name == "Address").FirstOrDefault();
Console.WriteLine(address.Value); // <-- error, address is null. 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-18T00:53:47.927

由于您的 xml 包含名称空间，因此您必须在代码中提及它。这将起作用：

```
 XNamespace nsSys = "http://www.foo.com";
    XElement xDoc = XElement.Load("1.xml");
    XElement xEl2 = xDoc.Descendants(nsSys + "Address").FirstOrDefault(); 
```

但是，我不得不稍微更改您的 xml，因为它包含重复的内容`xmlns:xsi`，并且`xmlns:xsd`每种 xml 格式应该只出现一次：

```
<?xml version="1.0" encoding="utf-8"?>
<Root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:xsd="http://www.w3.org/2001/XMLSchema"
      xmlns="http://www.foo.com" >
  <Address>Main St SW</Address>
</Root> 
```

MSDN 中的相关文章：[XNamespace 类](http://msdn.microsoft.com/en-us/library/system.xml.linq.xnamespace.aspx)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-18T00:53:57.003

文档根的 XML 命名空间包含在 的文本表示中`o.Name`，它实际上是 的一个实例，[`XName`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xname.aspx)因此条件永远不会匹配。

最简单的解决方法是[`LocalName`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xname.localname.aspx)用于比较：

```
.Where(o => o.Name.LocalName == "Address") 
```

# regex - awk：带前导零的递增数字

> ID：14390751
> 
> 赞同：1
> 
> 时间：2013-01-18T00:44:27.300
> 
> 标签：regex, sed, awk

我在这里遇到了很多关于 SO 的 awk 问题，但仍然无法为我的目的创建一个。

我有一个像这样的文件：

```
Project Name
Version 1.0
Revision 0059 
```

如何在保持其余部分不变的同时将 0059 增加到 0060？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:50:36.667

单程：

```
$ awk '$1=="Revision"{$2=sprintf("%04d",$2+1);}1' file
Project Name
Version 1.0
Revision 0060 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:19:00.203

试试这个

```
sed -rne '/^Revision/s/Revision ([0-9]+)/\1/gp' temp.txt | awk '{printf("%04d\n",$0+1)}' 
```

# heroku - 通过 Proximo 运行 Heroku 上的进程失败

> ID：14390754
> 
> 赞同：2
> 
> 时间：2013-01-18T00:44:41.590
> 
> 标签：heroku, phantomjs, proximo

在我的 Rails 应用程序中有一个方法（旨在通过 Rake 任务触发），它可以运行并运行 PhantomJS 进程：

```
bin/proximo bin/phantomjs vendor/assets/javascripts/yslow.js http://www.example.com 
```

可执行文件是 1.8.1 或 Linux ( `phantomjs`x86-64)。`yslow.js`对于 PhantomJS 3.1.1 是 YSlow。

该过程是通过 Heroku 的 Proximo 插件运行的，因为我正在针对的网站（上面的 example.com）将向任何未列入白名单的 IP 显示反 DOS 保护页面。

我遇到的问题是这个命令只是挂起，没有返回任何输出。如果我在不执行`bin/proximo`包装脚本的情况下运行相同的命令，它可以工作，但是由于上面提到的 IP 限制，我当然会得到错误页面的输出。

这是直接在 Heroku 上的 Rails 控制台中运行的堆栈跟踪：

```
irb(main):023:0> `bin/proximo bin/phantomjs vendor/assets/javascripts/yslow.js http://www.example.com`
^CIRB::Abort: abort then interrupt!
  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/core_ext/kernel/agnostics.rb:7:in `call'
  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/core_ext/kernel/agnostics.rb:7:in ``'
  from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/core_ext/kernel/agnostics.rb:7:in ``'
  from (irb):23
  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/commands/console.rb:47:in `start'
  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/commands/console.rb:8:in `start'
  from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/commands.rb:41:in `<top (required)>'
  from script/rails:6:in `require'
  from script/rails:6:in `<main>' 
```

任何想法是什么导致挂起？

* * *

**编辑**：我的同事帮助我发现挂起的实际上是 PhantomJS，而不是代理。我会寻找另一种销售 PhantomJS 的方式，除非其他人有其他建议。

**编辑 2**：我用 Heroku buildpack 安装了 PhantomJS，同样的事情发生了。我还注意到，如果我连接到 Heroku 上的 Bash shell 并运行`phantomjs`控制台，我无法在其中输入命令，因为 enter 键什么都不做。不知道有没有关系...

# ios - Objective-C：如何将结果保存到第二个视图控制器？

> ID：14390756
> 
> 赞同：-1
> 
> 时间：2013-01-18T00:45:05.113
> 
> 标签：ios, objective-c, cocoa-touch

我是菜鸟，需要一些指导。我已经 7 年没有搞砸编程了。在目标-C。如何将结果保存到第二个视图控制器？可以说根视图控制器是一个计算器。得到结果后，我希望能够点击保存按钮，数据将保存到第二个视图控制器。第二个视图控制器将列出结果。我希望能够用我的手指轻扫删除它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:54:10.520

在第二个视图控制器中创建一个属性数据，然后在推送/显示视图控制器之前设置该属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T03:14:41.387

执行以下步骤：

首先，您将第二个视图控制器头文件导入到第一个。第一视图控制器.h

```
#import <UIKit/UIKit.h>
#import "secondViewController.h" 
```

在第二个视图控制器头中创建一个属性 secondViewController.h

```
@property NSString *passingValue; 
```

创建 secondViewController 的实例

```
secondViewController *targetVC ;
targetVC.passingValue = newValue; 
```

现在你`@synthesize 传递值，在 secondViewController.m

现在您可以获取 secondViewController 的值

```
- (void)viewDidLoad
{
    NSLog(@"Image Name : %@ ",passingValue);
   [super viewDidLoad];
} 
```

# javascript - 检查来自多个上传文件输入的所有扩展名

> ID：14390757
> 
> 赞同：2
> 
> 时间：2013-01-18T00:45:29.860
> 
> 标签：javascript, html

我需要更改此代码，以便条件检查来自多个选择文件输入的所有选定文件的文件扩展名，此代码仅检查一个。我有什么办法可以做到这一点？

```
var file = document.getElementById('file');
var ext = file.value.substring(file.value.lastIndexOf('.') + 1);

     if(ext!== "mp4" && ext!== "m4v" && ext!== "f4v")  {
         alert('not an accepted file extension');
             return false;
} 

<input id="file" name="uploaded[]" type="file" multiple /> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-18T00:59:10.737

请注意，我只费心获取字符串的最后三个字符，因为您只有三个字母的文件扩展名。如果您愿意，可以使用`.split('.')`获取一个段数组并选择该数组的最后一个元素。

```
var selection = document.getElementById('file');
for (var i=0; i<selection.files.length; i++) {
    var ext = selection.files[i].name.substr(-3);
    if(ext!== "mp4" && ext!== "m4v" && ext!== "fv4")  {
        alert('not an accepted file extension');
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:53:08.487

要获取 dom 元素数组中的所有输入元素，请使用`document.getElementsByName('uploaded[]')`.

例如，在您的情况下，它将类似于：

```
var files = document.getElementsByName('uploaded[]'); 
for (var i = 0, j = files.length; i < j; i++) {
    var file = files[i];
    // do stuff with your file
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-08-12T03:51:08.207

通过 javascript [some()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some)方法验证多个文件。

```
function isVideo(film) {
  const ext = ['.mp4', '.m4v', '.fv4'];
  return ext.some(el => film.endsWith(el));
}

function fileValidation() {
  let files = document.getElementById('file');
  for (let i = 0; i < files.files.length; ++i) {
    let fname = files.files.item(i).name;
    if (!isVideo(fname)) {
      alert("File extension not supported!");
      return false;
    }
  }
}
```

```
<input id="file" name="uploaded[]" type="file" multiple onchange="fileValidation()" />
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-13T11:25:37.140

```
 <input name="" id="yourinputfieldis"  onchange="checkFile()"  type="file" multiple = "multiple" accept = "*">    

  <script>
        function checkFile() {   
        var x =  document.getElementById("yourinputfieldis");
        var txt = "";
        document.getElementById("demo").innerHTML = txt;
        if ('files' in x) {
        if (x.files.length == 0) {
        txt = "Select one or more files.";
        } else {
        for (var i = 0; i < x.files.length; i++) {      

        var file = x.files[i];
        if ('name' in file) {

        var ext = file.name.split('.').pop().toLowerCase();
        if($.inArray(ext, ['gif','png','jpg','jpeg','doc','pdf','xlsx']) == -1) {
        txt += "name: " + file.name + "<br>";
        document.getElementById("yourinputfieldis").value = "";

        if ('size' in file) {
        txt += "size: " + file.size + " bytes <br>";
        }
        alert('You are trying to upload files which not allowed ' + "(" + file.name + " is invalid)");

        }

        }
        }
        }
        }
        else {
        if (x.value == "") {
        txt += "Select one or more files.";
        } else {
        txt += "The files property is not supported by your browser!";
        txt  += "<br>The path of the selected file: " + x.value; 
        }
        }     
        }
   </script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-02T15:36:35.533

使用此方法验证 aspx 页面中的文件类型，

```
<asp:FileUpload ID="fupload" name="fupload" runat="server" Class="form-control multi" accept="doc|docx|pdf|xls|xlsx" Width="270px" /> 
```

我已经使用“MultiFile.js”插件来选择多个文件并上传。

# ios - 获取字符串的某些部分

> ID：14390762
> 
> 赞同：0
> 
> 时间：2013-01-18T00:46:05.767
> 
> 标签：ios

如果我有一个返回值的字符串：

```
<div style="clear:both;"></div>
                <div style="float:left;">
                    <div style="float:left; height:27px; font-size:13px; padding-top:2px;">
                        <div style="float:left;"><a href="http://www.hulkshare.com/ap-nxy2n2wn7ke8.mp3" rel="nofollow" target="_blank" style="color:green;">Download</a></div> 
```

我怎样才能从中得到`<a href="http://www.hulkshare.com/ap-nxy2n2wn7ke8.mp3"`一部分？如果已经有关于此的帖子，我很抱歉，我找不到任何帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:52:38.490

我会看看`NSRegularExpression`Class

[http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T01:27:21.937

这是使用正则表达式查找子字符串的示例。它查找 "href="，然后查找 href= 之后的第一个引号 (")。一旦找到这些索引，就会返回 then 之间的字符串。

在我的示例中并不真正需要正则表达式，您可以使用简单的 NSString 方法来查找子字符串。

这只是一个适合您特定情况的硬编码示例。在实践中，您最好使用 DOM/XML 解析器来执行此类操作。

另外，我假设您要提取实际的 URL，而不关心

另请注意，此函数不处理字符串中没有 href 匹配的情况。

```
- (NSString *)stringByExtractingAnchorTagURLFromString:(NSString *)dom {
    NSError *error;

    // Find the "href=" part
    NSRegularExpression *firstRegexp = [NSRegularExpression regularExpressionWithPattern:@"href=\"" options:NSRegularExpressionCaseInsensitive error:&error];
    NSTextCheckingResult *firstResult = [firstRegexp firstMatchInString:dom options:NSMatchingReportProgress range:NSMakeRange(0, [dom length])];

    NSUInteger startIndex = firstResult.range.location + firstResult.range.length;

    // Find the first quote (") character after the href=
    NSRegularExpression *secondRegexp = [NSRegularExpression regularExpressionWithPattern:@"\"" options:NSRegularExpressionCaseInsensitive error:&error];
    NSTextCheckingResult *secondResult = [secondRegexp firstMatchInString:dom options:NSMatchingReportProgress range:NSMakeRange(startIndex, [dom length]-startIndex)];

    NSUInteger endIndex = secondResult.range.location;

    // The URL is the string between these two found locations
    return [dom substringWithRange:NSMakeRange(startIndex, endIndex-startIndex)];
} 
```

这就是我测试它的方式：

```
NSString *dom = @"<div style=\"clear:both;\"></div><div style=\"float:left;\"><div style=\"float:left; height:27px; font-size:13px; padding-top:2px;\"><div style=\"float:left;\"><a href=\"http://www.hulkshare.com/ap-nxy2n2wn7ke8.mp3\" rel=\"nofollow\" target=\"_blank\" style=\"color:green;\">Download</a></div>";
NSString *result = [self stringByExtractingAnchorTagURLFromString:dom];
NSLog(@"Result: %@", result); 
```

测试打印：

```
Result: http://www.hulkshare.com/ap-nxy2n2wn7ke8.mp3 
```

**更新——多个 HREF**

对于多个 href，请使用此函数，它将返回一个包含 url 的 NSString 数组：

```
- (NSArray *)anchorTagURLsFromString:(NSString *)dom {
    NSError *error;
    NSMutableArray *urls = [NSMutableArray array];

    // First find all matching hrefs in the dom
    NSRegularExpression *firstRegexp = [NSRegularExpression regularExpressionWithPattern:@"href=\"" options:NSRegularExpressionCaseInsensitive error:&error];
    NSArray *matches = [firstRegexp matchesInString:dom options:NSMatchingReportProgress range:NSMakeRange(0, [dom length])];

    // Go through all matches and extrac the URL
    for (NSTextCheckingResult *match in matches) {
        NSUInteger startIndex = match.range.location + match.range.length;

        // Find the first quote (") character after the href=
        NSRegularExpression *secondRegexp = [NSRegularExpression regularExpressionWithPattern:@"\"" options:NSRegularExpressionCaseInsensitive error:&error];
        NSTextCheckingResult *secondResult = [secondRegexp firstMatchInString:dom options:NSMatchingReportProgress range:NSMakeRange(startIndex, [dom length]-startIndex)];

        NSUInteger endIndex = secondResult.range.location;

        [urls addObject:[dom substringWithRange:NSMakeRange(startIndex, endIndex-startIndex)]];
    }

    return urls;
} 
```

这就是我测试它的方式：

```
NSString *dom2 = @"<div style=\"clear:both;\"></div><div style=\"float:left;\"><div style=\"float:left; height:27px; font-size:13px; padding-top:2px;\"><div style=\"float:left;\"><a href=\"http://www.hulkshare.com/ap-nxy2n2wn7ke8.mp3\" rel=\"nofollow\" target=\"_blank\" style=\"color:green;\">Download</a><a href=\"http://www.google.com/blabla\" rel=\"nofollow\" target=\"_blank\" style=\"color:green;\">Download</a></div>";
NSArray *urls = [self anchorTagURLsFromString:dom2];
for (NSString *url in urls) {
    NSLog(@"URL: %@", url);
} 
```

这是测试的输出：

```
URL: http://www.hulkshare.com/ap-nxy2n2wn7ke8.mp3
URL: http://www.google.com/blabla 
```

# linux - Apache 2：从 Linux 中的 bash 脚本调用“a2ensite”

> ID：14390764
> 
> 赞同：1
> 
> 时间：2013-01-18T00:46:14.727
> 
> 标签：linux, bash, apache2

我目前正在为我的网络服务器编写一个管理页面，以使我自己更容易从我的浏览器创建新的 apache 域。一切都按我的意愿工作，除了一件事。

详细说明：我的服务器上有一个 cron 作业，以 root 身份运行 bash 脚本，该脚本检查包含我要创建的域名列表的文件。如果该文件包含一个域名，它会自动为该域创建一个新的虚拟主机，编辑我的 hosts 文件，并重新启动服务器。这一切都很完美，但是我希望脚本做的是它在重新启动服务器之前激活它自动创建的域。我尝试使用 apache 2 的`a2ensite`命令执行此操作，但是脚本返回一个错误，指出找不到该命令。

有没有办法从 bash 脚本调用这个命令，或者我可以调用这个命令的替代方法？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T00:55:42.890

```
$ which a2ensite
/usr/sbin/a2ensite 
```

通常，cron 有一个非常严格的 $PATH，不包括`/usr/sbin`or `/sbin`，它们是系统二进制文件（供 root 使用）。使用完全限定的路径名​​总是一个好主意。所以要么调用`/usr/bin/a2ensite`你的脚本，要么定义一个变量：

```
A2ENSITE=/usr/sbin/a2ensite
...
${A2ENSITE} new-domain.com 
```

# php - 如何让 ajax respose.Text 显示为 html？

> ID：14390772
> 
> 赞同：0
> 
> 时间：2013-01-18T00:47:05.927
> 
> 标签：php, html, ajax, responsetext

我正在进行 Ajax 请求查询以获取 php 文件中包含 HTML 代码的变量。我目前正在使用这种方法来显示从 Ajax 请求中检索到的内容：

```
document.getElementById('my_div').innerHTML = request.responseText; 
```

但是，当我查看页面源代码 (Chrome) 以查看页面上的 HTML 代码时，从 Ajax 响应中检索到的 HTML 并未显示，但该 HTML 代码的效果在页面上是可见的。

任何人都知道如何使 Ajax 响应作为 HTML 可见，以便在视图页面源中可见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:51:14.577

View source will only show the html of the document when the page was loaded. Any dom manipulation done after that will not be visible in the view source.

You can see it in elements tab in the chrome console (f12) though.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:51:57.900

页面源是加载页面时的源。您无法在此处显示 AJAX 内容。

您可以使用 Chrome/Safari 上的 Webkit Inspector（右键单击 -> 检查元素）或Firefox 上的[Firebug](https://getfirebug.com/)来检查标记，或者使用诸如[Charles](http://www.charlesproxy.com/)之类的调试代理来查看发送/接收的数据（包括任何请求数据和响应 HTML )

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-18T00:52:04.907

您可以使用浏览器开发工具来监控网络活动。这通常允许您查看浏览器对当前网页发出的请求和响应，包括 AJAX 调用。

# php - 查询未在 vbulletin php 中执行

> ID：14390773
> 
> 赞同：0
> 
> 时间：2013-01-18T00:47:15.107
> 
> 标签：php, sql, vbulletin

我正在为 vbulletin 编写一个插件，其中包括创建一个新线程 - 下面的查询是我所做的。查询在 phpmyadmin 中完美运行，但在 php 文件中运行时不执行；没有报告错误。谁能告诉我如何解决这个问题？非常感谢你！

```
mysql_query("INSERT INTO `thread` (`threadid`,  `title`,    `prefixid`, `firstpostid`,  `lastpostid`,   `lastpost`, `forumid`,  `pollid`,   `open`, `replycount`,   `hiddencount`,  `deletedcount`, `postusername`, `postuserid`,   `lastposter`,   `dateline`, `views`,    `iconid`,   `notes`,    `visible`,  `sticky`,   `votenum`,  `votetotal`,    `attach`,   `similar`,  `taglist`,  `awardedcredits`,   `threaddesc`)
                    VALUES        (NULL,        '$mname',    '',         '0',            '0',            '0',        '$M4rumid', '0',         '1',    '0',            '0',            '0',            '$username',     '$userid',       '$username',     '$date',     '0',        '0',        '',         '1',        '0',        '0',        '0',            '0',        '',         NULL,       '0',                'awarded');
             SET    @threadid = LAST_INSERT_ID();

             INSERT INTO `post`   (`postid`,    `threadid`, `parentid`, `username`,     `userid`,   `title`,    `dateline`,     `pagetext`,     `allowsmilie`,  `showsignature`,    `ipaddress`,    `iconid`,   `visible`,  `attach`,   `infraction`,   `reportthreadid`,   `kbank`,    `post_thanks_amount`)
                    VALUES        (NULL,        @threadid,  '0',        '$username',    '$userid',  '$mname',   '$date',        '$postcontent', '1',            '1',                '',             '0',        '1',        '0',        '0',            '0',                '0.00',     '0');
             SET    @postid = LAST_INSERT_ID();

             UPDATE `thread` 
             SET    `firstpostid` = @postid,
                    `lastpostid` = @postid,
                    `lastpost` = '$date'
             WHERE  `threadid` = @threadid;

             UPDATE `user` 
             SET    `posts` = `posts`+1
             WHERE  `userid` = '$userid';"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:03:26.580

这些是 4 个查询，而不是 1 个。

来自[mysql_query 的 PHP 手册](http://php.net/manual/en/function.mysql-query.php)：

> mysql_query() 向与指定链接标识符关联的服务器上当前活动的数据库发送一个**唯一查询（不支持多个查询） 。**

顺便说一句，在同一页面上：

> 此扩展自 PHP 5.5.0 起已弃用，并将在未来删除。相反，应该使用 MySQLi 或 PDO_MySQL 扩展。

顺便说一下，VBulletin 希望您如何与它的数据库进行交互：[**Vbulletin SQL 查询语法**](http://www.vbulletin.com/docs/html/main/codestandards_sql_query)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:03:33.787

我认为您的问题是您无法使用 mysql_query 运行多个查询。检查此链接：

[http://php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)

从他们的网站：

> mysql_query() 向与指定链接标识符关联的服务器上当前活动的数据库发送一个唯一查询（不支持多个查询）。

尝试使用 mysqli_multi_query 代替：

[http://php.net/manual/en/mysqli.multi-query.php](http://php.net/manual/en/mysqli.multi-query.php)

祝你好运。

# android - 如何在 Android 上通过发送接收文件

> ID：14390774
> 
> 赞同：0
> 
> 时间：2013-01-18T00:47:30.557
> 
> 标签：android, android-intent, send

我的清单如下：

```
<activity android:name="SendLauncherActivity" >
    <intent-filter>
        <action android:name="android.intent.action.SEND_MULTIPLE" />
        <category android:name="android.intent.category.DEFAULT" />
        <data android:mimeType="*/*" />
    </intent-filter>
</activity> 
```

我想获取每个文件的路径。
所以我有如下代码：

```
Intent intent = getIntent();
String action = intent.getAction();
String type = intent.getType();

ArrayList<Uri> imageUris = intent.getParcelableArrayListExtra(Intent.EXTRA_STREAM);
if (imageUris != null) {
    for(int i = 0; i < imageUris.size();i++) {
    System.out.println("Path " + imageUris.get(i).getPath());
    }
} 
```

但我得到如下路径：

```
01-17 18:21:13.350: I/System.out(20564): Path /external/file/15406 
```

如何修改以获取实际的文件路径？　

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:49:23.183

可能没有“实际文件路径”。

如果你看，你的方案可能是`content://`. 这是由 a 提供的数据`ContentProvider`。不必有文件。

无论它是文件还是其他流向您的东西，您都可以使用它来`ContentResolver`获取。`InputStream``Uri`

# ember.js - 在 yeoman 中使用最新的 Ember.js (1.0.0-PRE.3)

> ID：14390776
> 
> 赞同：1
> 
> 时间：2013-01-18T00:47:42.207
> 
> 标签：ember.js, javascript-framework, yeoman

ember.js**[团队](http://emberjs.com)**刚刚发布了新版本的 ember 框架版本，`1.0.0-pre.3`这个版本包含了我非常渴望使用的新“路由器”API。

我即将开始一个新的应用程序，并且**[yeoman](http://yeoman.io)**在我的工作流程中提供帮助，但是 yeoman ember-generator 使用该`1.0.0-pre.2`版本（具有已弃用的路由器 API 实现）来生成项目样板，但我想使用我的新项目中的新版本`1.0.0-pre.3`，简单的方法是非常hacky，它是直接在yeoman模板目录中更改ember.js lib并更新使用它的相应生成器脚本中的版本号，我'已经进行了测试以这种方式更改它并且它会起作用，但是这样我会“破坏”我的 yeoman 安装，我认为这不是一个好的选择。

所以我的最后一个主要问题是，我将如何更新 yeoman 以使用新的 ember 库而不进行黑客攻击？或者我应该为项目创建一个分支[https://github.com/yeoman/yeoman](https://github.com/yeoman/yeoman)为新的 ember-generator 创建一个新分支（显然使用最新的 ember 库）并提出一个希望被接受的拉取请求？有人“精明的约曼人”可以在这里为我指明正确的方向吗？我只是想让它以正确的方式......如果有的话:)

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T11:11:55.920

只需手动更新项目中的 ember 库。

Yeoman 1.0 将支持透明地更新库。

# vb.net - Record and view video at the same time DirectShow

> ID：14390778
> 
> 赞同：0
> 
> 时间：2013-01-18T00:47:53.040
> 
> 标签：vb.net, exception-handling, directshow, video-capture, directshow.net

I have used the sample code of DirectShow in order to record a video. however, I want to display the video during recording as well. But I can't do it at the same time, this error always shows:

```
' Const VIDEODEVICE As Integer = 0
' zero based index of video capture device to use
Cursor.Current = Cursors.WaitCursor

If cam Is Nothing Then
    cam = New AsfFilter.Capture(VIDEODEVICE, textBox1.Text)
    previewCamera(PictureBox1) <----- this is my code regarding on previewing the video recording.
    cam.Start()

    button1.Text = "Stop"
    textBox1.[ReadOnly] = True
Else
    button1.Text = "Start"
    textBox1.[ReadOnly] = False

    ' Pause the recording
    cam.Pause()

    ' Close it down
    cam.Dispose()
    cam = Nothing
End If

Cursor.Current = Cursors.[Default] 
```

Error:

> Insufficient system resources exist to complete the requested service. (Exception from HRESULT: 0x800705AA)

What am I doing wrong? Did somebody know of this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T06:00:11.737

`0x800705AA`：[`ERROR_NO_SYSTEM_RESOURCES`“系统资源不足，无法完成请求的服务。”](http://alax.info/blog/1383)

这是您需要知道的事情：视频捕获设备是专有访问资源。您使用它一次，您不能在另一个过滤器图表上再次使用它（即一个用于记录的图表，另一个用于监控）。您必须有单个过滤器图来托管视频捕获。从那里，您可以使用 Smart Tee Filter 或[Infinite Pin Tee Filter](http://msdn.microsoft.com/en-us/library/windows/desktop/dd390336%28v=vs.85%29.aspx)在录制和监控腿上复制视频馈送。或者，或者，使用[多图解决方案](http://www.gdcl.co.uk/gmfbridge/)，在单个图上进行静态视频捕获。

# node.js - 带有子组的 Mongoose 和表单提交

> ID：14390783
> 
> 赞同：0
> 
> 时间：2013-01-18T00:48:56.547
> 
> 标签：node.js, express, mongoose

所以，我有一个猫鼬模式，比如：

```
Person: {
   name: String,
   address: {
      street: String,
      number: String,
      city: String
   }
} 
```

有没有办法对我们的表单进行编码，以便我可以直接从 req.body 映射到 Person 实例？考虑到地址的细分。我试过：

```
<form>
   <input name="name">
   <input name="address.street">
   <input name="address.number">
   <input name="address.city">
</form> 
```

它不起作用......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T01:32:57.420

试试这个：

```
<form>
    <input name="name">
    <input name="address[street]">
    <input name="address[number]">
    <input name="address[city]">
</form> 
```

请参阅有关 application/x-www-form-urlencoded 编码的[这篇文章。](https://stackoverflow.com/questions/950133/nested-model-parameters-during-an-html-post)

# batch-file - How to add the contents of a folder to a jar file without extracting it in a batch file?

> ID：14390784
> 
> 赞同：1
> 
> 时间：2013-01-18T00:48:57.163
> 
> 标签：batch-file

How do you add the contents of a folder to a jar file without extracting it?

I would like to run it in a batch file.

I started using 7zip

```
7za x test.jar
copy test1 test
7za a test.zip -tzip
move test.zip test.jar 
```

[7zip cmd download](http://downloads.sourceforge.net/sevenzip/7za920.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:52:30.533

使用 7zip。打开存档，然后将文件夹拖到您要放置的位置。

# java - How can I make an image available for an online user to save/download that I've created with a Java Applet?

> ID：14390785
> 
> 赞同：1
> 
> 时间：2013-01-18T00:48:58.657
> 
> 标签：java, image, applet

I asked a question on here once before and got some great help and advice from a lot of knowledgeable people so I thought I'd try this again with another programming issue I'm having.

Here is the basic problem. I've created a small Java applet that takes four images and combines them into one large image. To be more specific, I combine four images into one large image that will fold up to be a greeting card when printed out. Everything works just fine, but I'm going to be embedding the applet on my website and so I'll have users select the four images they want from a list of images on my website, and then with their selections I'll create the large image.

Now here's the trouble... when I create the large image I want the user to be able to download it. Is it necessary to create a signed applet? And if so, how do I go about signing my applet? Or is it somehow possible for the applet to just display the image in such a way so the user can just right-click the image and save it to their file system. Any advice/suggestions would be much appreciated!!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:53:29.997

如果图像是从下载小程序类本身的同一位置加载的，则无需对小程序进行签名。但是，从未签名的小程序本地保存图像会出现问题。对于该功能，您需要对小程序进行签名。

或者，对于在 Web 浏览器中运行的小程序，可以使用以下命令在单独的浏览器框架中显示图像：

```
applet.getAppletContext().showDocument(imageURL, frameTarget); 
```

从此页面/框架中，可以[使用 Javascript 将图像保存在本地](https://stackoverflow.com/questions/7951326/save-image-to-users-disk-using-javascript)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T02:03:01.783

根据 Java 和浏览器版本，我看到 3 个选项：

1.  对 Jar 进行数字签名并鼓励最终用户信任数字签名的代码。
2.  [Jar 应用程序，使用Java Web Start](https://stackoverflow.com/tags/java-web-start/info)部署它并使用 JNLP API 服务保存生成的图像。这可以使用自 Java 1.2 起的自由浮动小程序或自 1.6.0_10+ 起的嵌入式小程序来完成。这是一个[演示。的文件服务](http://pscode.org/jws/api.html#fs)。 [GIFanim](http://pscode.org/gifanim/)还提供了一个嵌入式小程序，该小程序使用保存动画 GIF 的服务。
3.  将图像编码为[Base64 URL](http://en.wikipedia.org/wiki/Data_URI_scheme#HTML)以将其直接显示在网页中。这需要更新的浏览器，*较旧的浏览器对图像大小设置了 32Kb 的限制。* J2SE 最近只添加了一个方法，可以为我们进行转换。看`DatatypeConverter.printBase64Binary(byte[])`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T01:07:46.577

要将文件写入文件系统，需要对小程序进行签名。

然而，自签名小程序非常容易，除非您的用户非常谨慎，否则自签名将起作用。

按照这些说明签署小程序。PS这些说明适用于linux设置。您可能需要在 windows 中设置环境变量。

[罐子签名链接](http://www.doc.ic.ac.uk/csg-old/java/signed-applets/)

# jquery - Set the height of a block depending of its content

> ID：14390787
> 
> 赞同：0
> 
> 时间：2013-01-18T00:49:08.043
> 
> 标签：jquery, offset

So, here is a [quick JSFiddle](http://jsfiddle.net/Axiol/CfB5s/) to demonstrate my problem.

Problem is, after having played with the `offset`, it happens that the `div#TL` should be shorter than before, but it isn't.

So, I'm looking for a way to reset the `div#TL` depending of the height it should have. Problem is, I can't know before which of the 2 columns will be the longest.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T02:25:35.073

你不会通过改变relative/block/float子项的顶部位置来改变relative/float/block的高度；它不是那样工作的

要么创建 2 列，甚至不需要重新定位任何东西，要么在定位孩子后设置高度/溢出

```
 $TL.css({

        overflow : "hidden",
        height : $TL.height()+math.Min($TL.find(".TLItem").map(function() {
                                            return   $(this).css("top");
                                               })
                                      )
       }); 
```

（我会改变html结构）

# php - Converting Propel to JSON with linked entities

> ID：14390788
> 
> 赞同：2
> 
> 时间：2013-01-18T00:49:13.577
> 
> 标签：php, json, propel

I have this setup in a PHP project using Propel (which I'm new to).

> User: userid, firstname, lastname
> 
> SignIn: signinid, userid, time

SignIn, in this case, is a table containing the times each user signed in.

What I want is to print out a JSON string using Propel of the last ten SignIn entries. On the front end I want to display something like:

```
Bob Builder signed in at 3:30pm
Max Power signed in at 3:24pm
... 
```

So when I query the last ten entries in SignIn and then call toJSON, I'd like to have the User data for that SignIn record also included in the JSON.

How can I do that?

Note, if there's a better way to do this, I'm open to ideas.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T08:50:57.000

关于 Propel 的一件事是[文档](http://propelorm.org/reference/model-criteria.html)非常干净、可读性强并且总是很有帮助。

对于您的请求，您可以尝试以下请求。仔细看一下，它是可读的（与 Propel 一样）

```
$signIn = SignInQuery::create()
  ->select(array('User.firstname', 'User.lastname', 'SignIn.time'))
  ->join('User')
  ->orderByTime('desc')
  ->limit(10)
  ->find()
  ->toJson(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T15:38:33.143

只是一个替代解决方案：您还可以覆盖`*Base`类中的任何方法，我已经多次这样做以向 、 或 方法添加`toJSON`额外`toArray`信息`fromArray`。

在 SignIn.php 中：

```
public function toJSON() {
  $fields = json_decode(parent::toJSON());
  $user = $this->getUser(); // assumes you have a foreign key set up
  $fields->firstname = $user->getFirstname();
  $fields->lastname = $user->getLastname();
  return json_encode($fields);
} 
```

现在您只需查询您的 SignIn 对象，并且无论何时`toJSON`调用，都会附加用户数据：

```
$signIn = SignInQuery::create()
  ->orderByTime('desc')
  ->limit(10)
  ->find()
  ->toJson(); 
```

请注意，`toJSON`覆盖实际上是对 BaseObject 中通用“to[Format]”方法的覆盖，该方法由第 380 行（在 v1.6 中）上的代码处理：`public function __call($name, $params) { ... }`

# jquery - jquery hover animate image (once)

> ID：14390789
> 
> 赞同：1
> 
> 时间：2013-01-18T00:49:15.837
> 
> 标签：jquery, jquery-animate, vibration

I came across this post (http://stackoverflow.com/questions/10665918/jquery-animate-shake-on-hover) which is almost what I'm looking for, and this jsfiddle (http://jsfiddle.net/g6AeL/222/), but I just need the vibrate function to happen once when you hover on the item instead of continuously vibrating while you're hovering over the item.

Could someone help me with making it just do it once when you hover over the item?

Here's the javascript from the jsfiddle.

```
$(function() {
  var interval = 10;
  var duration= 1000;
  var shake= 3;
  var vibrateIndex = 0;
  var selector = $('.box'); /* Your own container ID*/
    $(selector).each(function(){
        var elem = this;
        $(this).hover( /* The button ID */

        function(){ 
            vibrateIndex = setInterval(function(){
                vibrate(elem); 
            }, interval);
        },
        function(){ 
            clearInterval(vibrateIndex);
            $(this).stop(true,false)
                .css({position: 'static', left: '0px', top: '0px'});
        }
    );
    })

    var vibrate = function(elem){
        $(elem).stop(true,false)
        .css({position: 'relative', 
        left: Math.round(Math.random() * shake) - ((shake + 1) / 2) +'px', 
        top: Math.round(Math.random() * shake) - ((shake + 1) / 2) +'px'
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:03:08.877

您可以像这样添加一个计数器：

```
var Counter = 0

var vibrate = function(elem){
  if (Counter <= 100) {
    Counter++;
    $(elem).stop(true,false)
    .css({position: 'relative', 
    left: Math.round(Math.random() * shake) - ((shake + 1) / 2) +'px', 
    top: Math.round(Math.random() * shake) - ((shake + 1) / 2) +'px'
    });
  }
} 
```

它会根据您的需要振动多次，然后停止。您需要在某些可以选择的事件上重置计数器，例如 mouseout 等。

[http://jsfiddle.net/g6AeL/226/](http://jsfiddle.net/g6AeL/226/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T01:19:44.223

您可以尝试添加一个 setTimeout 来停止有时之后的抖动。

也许是这样的：

```
$(selector).each(function(){
    var elem = this;
    var vibrateIndex;
    var timeoutIndex;
    $(this).hover( /* The button ID */

    function(){ 
        vibrateIndex = setInterval(function(){
            vibrate(elem); 
        }, interval, 0);
      timeoutIndex = setTimeout(function(){clearInterval(vibrateIndex)},1000);
    },
      function(){
        clearInterval(vibrateIndex);
       clearTimeout(timeoutIndex); 
      }
    );
}) 
```

看看[jsfiddle](http://jsfiddle.net/g6AeL/227/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T01:12:34.530

好的，我开始制作它的插件：

```
$.fn.extend({

   randShake : function(duration, shakeInt,shake){
              return $(this).stop(true,false)
                        .css({
                             left : Math.round(Math.random() * shake) - ((shake + 1) / 2) +'px', 
                             top : Math.round(Math.random() * shake) - ((shake + 1) / 2) +'px'

                         }).vibrate(duration, shakeInt,shake);
      },

     vibrate : function(duration, shakeInt,shake) {
       if (duration>shakeInt) setTimeOut(function(){

                          $(this).randShake(duration-shakeInt, shakeInt,shake);

                           },shakeInt);

             }
            return this;
          }      
       });

      jQuery(function($,undefined) {

          $(selector).on("mouseover",function(){
              $(this).vibrate(duration, shakeInt,shake);
                 });

       }) 
```

尚未对其进行测试，但在我看来，这个想法更像是 jquery 的精神而不是原始代码

# backbone.js - backbone.js automatic PUT after POST

> ID：14390801
> 
> 赞同：0
> 
> 时间：2013-01-18T00:50:38.523
> 
> 标签：backbone.js, sinatra

Our server saves the model, and returns the JSON as specified in the doc. The problem is, backbone.js issues PUT as soon as it receives response. Can it be because the model is sent without _id property, and the server appends that to a model?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T06:12:35.083

如果您认为 Backbone 会根据对先前请求的响应自动发出 PUT，那么您会感到困惑。Backbone 不会做这样的事情。如果您看到 PUT 通过网络传输，则代码库中的某些内容（事件绑定或其他）正在调用`save`模型或手册`sync`。

否则，您需要发布代码以便我们帮助您进行调试，但我可以向您保证，骨干网本身不会通过一组非常小的方法之一发出不是由外部代码触发的网络请求，例如`fetch`, `save`, 或`sync`.

至于服务器上的ID，那应该很好。事实上，如果主干感到困惑并认为现有模型是新模型，它会发出 POST 而不是 PUT，这不是您所看到的。

# asp.net-mvc-3 - Windows 7（或更高版本）上 Web 应用程序的自动安装程序

> ID：14390806
> 
> 赞同：3
> 
> 时间：2013-01-18T00:50:59.473
> 
> 标签：asp.net-mvc-3, sql-server-2008-r2, windows-installer, local

我有一个在 ASP.NET MVC3 和 SQL Server 2008 Express 中实现的 Web 应用程序。它相对较小，因此我可以将其部署在客户端的本地计算机（Windows 7 或更高版本）中。

目前，我通过在 IIS 中创建新网站手动部署它，将发布的文件复制到网站文件夹，安装 SQL Server 2008R2 并使用 Management Studio 使用一些初始数据恢复数据库。

我可以，但我的客户不行。他们不能做同样的事情。我想要的是一个自动安装程序，我的客户只需点击几个按钮即可完成所有工作。

具体来说，此自动安装程序必须执行以下操作：

1.  安装 SQL Server 2008R2 Express 并恢复初始数据库。
2.  安装 IIS7（如果在 Windows 7 中未启用）。
3.  创建一个新的应用程序池 (V4)，一个新的网站使用这个池。然后将发布的文件复制到网站的文件夹中。
4.  安装程序可以运行`aspnet_regiis`命令并授予`NETWORK SERVICE`帐户到`TEMP`文件夹的权限。这是网站运行所必需的。
5.  安装程序可以将一些字体复制到 Windows 的 Font 文件夹中。

我看到许多应用程序可以执行此自动安装程序，但在谷歌搜索后我找不到一个彻底的解决方案来尝试。

请给我一些建议。提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T08:47:43.507

如果您想要一个免费的解决方案，那么您需要[WiX](http://wix.sourceforge.net/)，但如果您从未使用它创建过软件包，则需要一些时间来学习使用它。

[Advanced Installer](http://www.advancedinstaller.com)是一个更易于使用且功能强大但付费的工具，您需要专业版，但您可以通过 30 天试用模式免费试用。它具有 SQL Server Express 的预定义先决条件、安装 IIS 实体的内置支持以及设置文件/文件夹权限。基本上你需要的所有要求。

要启用任何 IIS 功能，您只需添加一个 PowerShell 脚本。

# c# - 如何在代码中使用新模型读取旧版本的 MongoDb 文档

> ID：14390819
> 
> 赞同：0
> 
> 时间：2013-01-18T00:51:56.807
> 
> 标签：c#, mongodb

假设我的 c# 模型更新了，而通讯集仍然包含旧文档，我希望新旧文档在集合中共存，同时仅使用新版本的 c# 模型来读取它们。如果可能的话，我希望不使用继承。所以我想知道其中哪些问题是可以解决的，以及如何解决：

*   c# 模型中有一个新属性，它不存在于数据库中。我认为它永远不应该是一个问题，Mongo对此一无所知，它将使用默认值初始化。这里唯一的问题是用所有旧文档的特定值初始化它，有人知道怎么做吗？

*   其中一项财产已从模型中消失。我希望 MongoDb 找出 c# 类中没有更多属性可以将旧文档的字段映射到，并忽略它而不是崩溃。这种情况可能听起来有点奇怪，因为这意味着数据库中会留下一些垃圾，但无论如何，这种行为是否可以实现/配置？

*   如果更改了类型，则新类型可转换为旧类型，例如整数->字符串。有没有办法为旧文档配置映射？

如果无法解决，我可以考虑将继承用于第二种情况

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:17:47.777

您的问题的大部分答案都可以[在此处](http://www.mongodb.org/display/DOCS/CSharp+Driver+Serialization+Tutorial#CSharpDriverSerializationTutorial-Fieldorpropertylevelserializationoptions)找到。

*   `BsonDefaultValue("abc")`属性上的属性来处理数据库中不存在的值，并在反序列化时给它们一个默认值
*   `BsonIgnoreExtraElements`类上的属性以忽略反序列化期间发现的额外元素（以避免异常）
*   如果成员的类型发生更改，则需要自定义序列化程序来处理，或者您需要编写升级脚本来修复数据。`int`离开负载可能会更容易，并`save`根据`string`需要进行。（这意味着您需要为该属性的`string`版本指定一个新的属性名称。）

# c++ - 成员数组的大小由模板参数定义，但为什么零大小数组没有警告？

> ID：14390822
> 
> 赞同：5
> 
> 时间：2013-01-18T00:52:08.140
> 
> 标签：c++, arrays, templates

我试图编写一个模板化的基类来存储固定数量的数据类型，每个数据类型都有不同的长度。这是我尝试做的很多事情的简化版本：

```
template< int NINT, int NR0 >
class EncapsulatedObjectBase
{
   public:

  EncapsulatedObjectBase();

  ~EncapsulatedObjectBase();

  double m_real[NR0];
  int m_int[NINT];
} 
```

是的......所以模板参数可以为零，从而声明一个零长度的对象数组。此基础将有多个派生类，每个派生类都定义自己的变量数量。我有两个问题：

1）这种方法是否存在根本缺陷？

2) 如果是这样...当我实例化一个零长度数组时，为什么 icc13 或 gcc4.7.2 不给我警告？对于 gcc，我使用 -wall 和 -wextra -wabi。没有警告让我认为这种事情还可以。

编辑：

这是显示我在说什么的文件的内容：

```
#include <iostream>

template< int NINT, int NR0 >
class EncapsulatedObjectBase
{
public:
  EncapsulatedObjectBase(){}
  ~EncapsulatedObjectBase(){}

  double m_real[NR0];
  int m_int[NINT];
};

class DerivedDataObject1 : public EncapsulatedObjectBase<2,0>
{
   public:

   DerivedDataObject1(){}

  ~DerivedDataObject1(){}

  inline int& intvar1() { return this->m_int[0]; }
  inline int& intvar2() { return this->m_int[1]; }

};

class DerivedDataObject2 : public EncapsulatedObjectBase<0,2>
{
   public:

   DerivedDataObject2(){}

  ~DerivedDataObject2(){}

  inline double& realvar1() { return this->m_real[0]; }
  inline double& realvar2() { return this->m_real[1]; }
};

int main()
{
   DerivedDataObject1 obj1;
   DerivedDataObject2 obj2;

   obj1.intvar1() = 12;
   obj1.intvar2() = 5;

   obj2.realvar1() = 1.0e5;
   obj2.realvar2() = 1.0e6;

   std::cout<<"obj1.intvar1()  = "<<obj1.intvar1()<<std::endl;
   std::cout<<"obj1.intvar2()  = "<<obj1.intvar2()<<std::endl;
   std::cout<<"obj2.realvar1() = "<<obj2.realvar1()<<std::endl;
   std::cout<<"obj2.realvar2() = "<<obj2.realvar2()<<std::endl;

} 
```

如果我用“g++ -Wall -Wextra -Wabi main.cpp”编译它，我不会收到任何警告。我必须使用 -pedantic 标志来获取警告。所以我仍然不知道这有多不安全。回想起来，我觉得它一定不是一个好主意……尽管如果我能侥幸逃脱它会非常有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:55:55.777

在 C 中，使用大小为零的数组作为结构的最后一个成员实际上是合法的，并且通常在结构最终以某种在编译时未知的动态创建的内联数据结束时使用。换句话说，我可能有类似的东西

```
struct MyData {
    size_t size;
    char data[0];
};

struct MyData *newData(size_t size) {
    struct MyData *myData = (struct MyData *)malloc(sizeof(struct MyData) + size);
    myData->size = size;
    bzero(myData->data, size);
    return myData;
} 
```

现在该`myData->data`字段可以作为指向动态大小数据的指针进行访问

也就是说，我不知道这种技术对 C++ 的适用性如何。但只要你从不子类化你的类就可以了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T01:09:33.840

零大小的数组在 C++ 中实际上是非法的：

> `[C++11: 8.3.4/1]:` *[..]*如果*常量表达式*(5.19) 存在，**它应该是一个整数常量表达式，并且它的值应该大于零**。常量表达式指定数组（元素数量）的边界。如果常量表达式的值为`N`，则数组`N`元素编号`0`为`N-1`，标识符的类型`D`为“<em>derived-declarator-type-list array of `N`T”。*[..]*

出于这个原因，您的类模板*不能*`0,0` [在 GCC 4.1.2](http://codepad.org/ZqlBniEl)中或[在 GCC 4.7.2](http://liveworkspace.org/code/3snWgY%240)中使用合理的标志来实例化：

```
template< int NINT, int NR0 >
class EncapsulatedObjectBase
{
   public:

  EncapsulatedObjectBase();

  ~EncapsulatedObjectBase();

  double m_real[NR0];
  int m_int[NINT];
};

int main()
{
   EncapsulatedObjectBase<0,0> obj;
} 
```

> t.cpp：在 'EncapsulatedObjectBase<0, 0>' 的实例化中：
> t.cpp:17：从此处实例化第 10 行：错误：ISO C++ 禁止 因 -Wfatal 错误而终止
> 零大小数组编译。

铿锵 3.2 说：

> source.cpp:10:17：警告：零大小数组是扩展 [-Wzero-length-array]

（请注意，在任何情况下，除非您尝试实例化这样的类，否则您不会收到任何错误。）

那么，这是个好主意吗？不，不是。当任一参数为`0`. 我还会看看为什么你想要零长度数组并考虑调整你的设计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T02:39:11.690

1）添加到您的类**C++11 static_assert**或**BOOST_STATIC_ASSERT**的声明中，您将获得零长度数组的**编译时诊断：**

```
....
   BOOST_STATIC_ASSERT(NR0 > 0);
   BOOST_STATIC_ASSERT(NINT > 0);
   double m_real[NR0];
   int m_int[NINT];
}; 
```

2) 使用**std::array**或**boost::array**，您将对此类代码中的索引溢出问题进行运行时诊断（在调试模式下）：

```
 BOOST_STATIC_ASSERT(NR0 > 0);
   BOOST_STATIC_ASSERT(NINT > 0);
   boost::array<double, NR> m_real;   //double m_real[NR0];
   boost::array<int, NINT> m_int;     //int m_int[NINT];
}; 
```

备注： *类**boost::array**专门用于零大小数组*

3) 使用**size_t**而不是 int 作为数组的大小。

你的设计很危险：

```
 DerivedDataObject1 a;
   a.m_real[2] = 1;   // size of m_real == 0 !!! 
```

我认为更改类 EncapsulatedObjectBase 的设计会更好。可能会更好地使用：

```
 template<typename T, size_t N> class EncapsulatedObjectBase
   {
    ....
   };
   class DerivedDataObject1 : public EncapsulatedObjectBase<int,2>
   {
     ....
   };
   class DerivedDataObject2 : public EncapsulatedObjectBase<double,2>
   {
     ....
   };
   class DerivedDataObject3 : public EncapsulatedObjectBase<double,2>
                            , public EncapsulatedObjectBase<int,2>
   {
     ....
   }; 
```

# spring - 使用 OpenSessionInViewFilter 时出现 No bean named 'sessionFactory' 错误

> ID：14390823
> 
> 赞同：3
> 
> 时间：2013-01-18T00:52:21.453
> 
> 标签：spring, hibernate, exception, open-session-in-view

我正在使用 Hibernate 的延迟加载，并且在将 OpenSessionInViewFilter 添加到我的 web.xml 之后，我开始得到 sessionFactory 丢失异常，即使在定义了要使用的 sessionFactory bean 之后也是如此。

```
org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'sessionFactory' is defined
org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:529)
org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1095)
org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:277)
org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1097)
org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.lookupSessionFactory(OpenSessionInViewFilter.java:242)
org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.lookupSessionFactory(OpenSessionInViewFilter.java:227)
org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:171)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76) 
```

[这](https://stackoverflow.com/questions/8574552/spring-hibernate-lazy-loading-sessionfactory-and-opensessioninviewfilter)似乎是同一个问题，但不幸的是我不明白解决方案。我按照建议的解决方案（将 sessionFactory 移动到名为 root-spring.xml 的文件）我得到了服务器启动的异常。

知道我缺少什么吗？

web.xml

```
 <?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         id="WebApp_ID" version="2.5">

    <display-name>recommendationCrawler</display-name>

    <servlet>
        <servlet-name>spring</servlet-name>
        <servlet-class>
            org.springframework.web.servlet.DispatcherServlet
        </servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>spring</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <filter>
        <filter-name>hibernateFilter</filter-name>
        <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>

        <init-param>
            <param-name>sessionFactoryBeanName</param-name>
            <param-value>sessionFactory</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>hibernateFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!--<listener>-->
        <!--<listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>-->
    <!--</listener>-->

    <!--<context-param>-->
        <!--<param-name>log4jConfigLocation</param-name>-->
        <!--<param-value>/WEB-INF/log4j.properties</param-value>-->
    <!--</context-param>-->

    <!-- listener to load the root application context -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
</web-app> 
```

Spring-servlet.xml

```
<?xml  version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:jee="http://www.springframework.org/schema/jee"
       xmlns:lang="http://www.springframework.org/schema/lang"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd
        http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

    <context:annotation-config/>
    <context:component-scan base-package="net.crawler"/>

    <mvc:annotation-driven/>

    <bean id="jspViewResolver"
          class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass"
                  value="org.springframework.web.servlet.view.JstlView"/>
        <property name="prefix" value="/WEB-INF/jsp/"/>
        <property name="suffix" value=".jsp"/>
    </bean>

    <bean id="messageSource"
          class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
        <property name="basename" value="classpath:messages"/>
        <property name="defaultEncoding" value="UTF-8"/>
    </bean>

    <bean id="propertyConfigurer"
          class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
          p:location="/WEB-INF/jdbc.properties"/>

    <bean id="dataSource"
          class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close"
          p:driverClassName="${jdbc.driverClassName}"
          p:url="${jdbc.databaseurl}" p:username="${jdbc.username}"
          p:password="${jdbc.password}"/>

    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="dataSource"/>
        <property name="configLocation">
            <value>classpath:hibernate.cfg.xml</value>
        </property>
        <property name="configurationClass">
            <value>org.hibernate.cfg.AnnotationConfiguration</value>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${jdbc.dialect}</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>
            </props>
        </property>
        <property name="annotatedClasses">
            <list>
                <value>net.crawler.dao.model.ScrapingProperties</value>
            </list>
        </property>
    </bean>

    <tx:annotation-driven/>

    <bean id="transactionManager"
          class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean>

    <!--&lt;!&ndash; Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources/ directory &ndash;&gt;-->
    <mvc:resources mapping="/resources/**" location="/resources/"/>

</beans> 
```

项目结构：

![项目结构](../Images/f3a2017ca7f1c885b54bab30ded77c64.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T01:38:22.997

尝试将以下配置移动到 applicationContext.xml

```
 <bean id="propertyConfigurer"
          class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
          p:location="/WEB-INF/jdbc.properties"/>

    <bean id="dataSource"
          class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close"
          p:driverClassName="${jdbc.driverClassName}"
          p:url="${jdbc.databaseurl}" p:username="${jdbc.username}"
          p:password="${jdbc.password}"/>

    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="dataSource"/>
        <property name="configLocation">
            <value>classpath:hibernate.cfg.xml</value>
        </property>
        <property name="configurationClass">
            <value>org.hibernate.cfg.AnnotationConfiguration</value>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${jdbc.dialect}</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>
            </props>
        </property>
        <property name="annotatedClasses">
            <list>
                <value>net.crawler.dao.model.ScrapingProperties</value>
            </list>
        </property>
    </bean>

    <tx:annotation-driven/>

    <bean id="transactionManager"
          class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean> 
```

# c++ - 提升精神语义动作和融合数据类型

> ID：14390825
> 
> 赞同：1
> 
> 时间：2013-01-18T00:52:31.347
> 
> 标签：c++, boost, boost-spirit, boost-fusion

我有一条规则应该返回一个 Boost.Fusion ASSOC_STRUCT。我正在尝试将规则解析器解析的结果分配给 _val，但我无法使其工作。我将跳过谈话，直接向您展示相关代码。

```
#include <boost/fusion/include/define_assoc_struct.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix_core.hpp>
#include <boost/spirit/include/phoenix_operator.hpp>
#include <boost/fusion/include/as_vector.hpp>
#include <boost/spirit/include/qi_symbols.hpp>
#include <iostream>
#include <string>

namespace keys {
   struct actor_key;
   struct action_key;
   struct money_key;
 }

 BOOST_FUSION_DEFINE_ASSOC_STRUCT(
    (), ActionLine,
    (int, action, keys::action_key)
    (int, amount, keys::money_key)
    (int, actor, keys::actor_key)
  )

int main ()
{
  namespace qi = boost::spirit::qi;
  using qi::_1;
  using qi::_2;
  using qi::_a;
  using qi::int_;
  using qi::lit;
  using boost::spirit::_val;
  using boost::fusion::as_vector;

  qi::symbols<char, int> name_parser_;
  name_parser_.add("name4", 4);

  std::string input("string1 ($7) string2 name4");
  std::string::const_iterator f(input.begin()), l(input.end());  
  ActionLine expected{0, 7, 4}, result;

  //The following rule is supposed to parse input of the form
  //"string1 ($[integer]) string2 [name]"
  //and return a triple (ActionLine) with the values { 0, value of (int_), value of (name_parser_) }
  qi::rule<std::string::const_iterator, ActionLine()> action_line_ =
     lit("string1 ($") >> int_ >> lit(") string2 ") >> name_parser_
     // [ _val = ActionLine{0, _1, _2} ]; // this is what I am trying to achieve
    [ _val = ActionLine{0, 7, 4} ]; //this compiles, but of course is not what I need

   bool b =
     qi::parse(f, l, action_line_, result) &&
     as_vector(result) == as_vector(expected);

   std::cout << "test: " << std::boolalpha << b << std::endl;
   return 0;
 } 
```

（使用 g++ above_file.cpp -std=c++0x 编译）我的实际应用程序中的编译器错误与此示例中的有些不同，但类似于（在 _val = ActionLine{0, _1, _2} 的行中） : 没有调用::ActionLine::ActionLine()的匹配函数，我猜它不能将_1和_2转换为int。

我还尝试添加本地 int 变量并使用它们来复制解析的值，但它不起作用，没有使用 boost::phoenix::at(_1,0), boost::phoenix::at(_1,1 ）（我发现这些想法在这里[提升了精神语义动作参数](https://stackoverflow.com/questions/3066701/boost-spirit-semantic-action-parameters)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T11:03:05.540

你需要[`phoenix::construct`](http://www.boost.org/libs/phoenix/doc/html/phoenix/modules/object/construction.html)在你的语义动作中使用来做你想做的事。

```
#include <boost/fusion/include/define_assoc_struct.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix_core.hpp>
#include <boost/spirit/include/phoenix_operator.hpp>
#include <boost/spirit/include/phoenix_object.hpp> //CHANGE:you need to include this to use "phoenix::construct"
#include <boost/fusion/include/as_vector.hpp>
#include <boost/spirit/include/qi_symbols.hpp>
#include <iostream>
#include <string>

namespace keys {
   struct actor_key;
   struct action_key;
   struct money_key;
 }

 BOOST_FUSION_DEFINE_ASSOC_STRUCT(
    (), ActionLine,
    (int, action, keys::action_key)
    (int, amount, keys::money_key)
    (int, actor, keys::actor_key)
  )

int main ()
{
  namespace qi = boost::spirit::qi;
  namespace phx = boost::phoenix;
  using qi::_1;
  using qi::_2;
  using qi::_a;
  using qi::int_;
  using qi::lit;
  using boost::spirit::_val;
  using boost::fusion::as_vector;

  qi::symbols<char, int> name_parser_;
  name_parser_.add("name4", 4);

  std::string input("string1 ($7) string2 name4");
  std::string::const_iterator f(input.begin()), l(input.end());  
  ActionLine expected{0, 7, 4}, result;

  //The following rule is supposed to parse input of the form
  //"string1 ($[integer]) string2 [name]"
  //and return a triple (ActionLine) with the values { 0, value of (int_), value of (name_parser_) }
  qi::rule<std::string::const_iterator, ActionLine()> action_line_ =
     (lit("string1 ($") >> int_ >> lit(") string2 ") >> name_parser_) //CHANGE:the parentheses are important otherwise the semantic action would be attached to name_parser_
    [ _val = phx::construct<ActionLine>(0, _1, _2) ]; //CHANGE: you need to use phoenix to use the placeholders _1, _2, etc

   bool b =
     qi::parse(f, l, action_line_, result) &&
     as_vector(result) == as_vector(expected);

   std::cout << "test: " << std::boolalpha << b << std::endl;
   std::cout << at_key<keys::action_key>(result)<< ", " << at_key<keys::money_key>(result)<< ", " << at_key<keys::actor_key>(result) << std::endl;

   return 0;
 } 
```

# python - 由于小数导致的python polyfit错误

> ID：14390828
> 
> 赞同：0
> 
> 时间：2013-01-18T00:52:48.837
> 
> 标签：python

我有几个 Python 列表（比如说“x”和“y”），其中的数字都是“小数”，使用“小数”模块。我需要这个，因为这些数字精确到许多小数位。

然后我需要使用 y 与 x 的图的梯度

```
slope,intercept = np.polyfit(x,y,1) 
```

但我收到以下错误：

```
TypeError: unsupported operand type(s) for +: 'Decimal' and 'float' 
```

我假设 polyfit 不喜欢我以这种方式使用小数？有什么办法吗？

谢谢！

# javascript - 如何在 Django 模板过滤器中使用 Sekizai javascript 块？

> ID：14390837
> 
> 赞同：3
> 
> 时间：2013-01-18T00:53:33.103
> 
> 标签：javascript, django, django-sekizai

我正在编写一个 Django 模板过滤器。我想插入一些javascript。简而言之：有没有办法在这个过滤器中添加到 Sekizai "js" 块，但让它呈现在页面模板上定义的 "js" 块中？

为了使我的问题更清楚，以下过滤器可以满足我的要求，但没有 Sekizai：（为简单起见，省略了自动转义）

```
from django import template
from django.template import Context
register = template.Library()
@register.filter  
def myfilter(text):
    context = { "text": text }
    myhtml = get_template('mytemplate.html')
    return myhtml.render(Context(context)) 
```

其中`mytemplate.html`有一些javascript，例如：

```
<canvas id="xyz" width="200" height="200"></canvas>
<script>
function drawCircle(context, radius, centerX, centerY, color) {
    context.beginPath();
    context.arc(centerX, centerY, radius, 0, 2 * Math.PI);
    context.fillStyle = color;
    context.fill();
}
var canvas = document.getElementById('xyz');
var context = canvas.getContext('2d');
drawCircle(context,50,100,100,"blue");
</script> 
```

这工作正常。

但是，对于 Sekizai，我希望将`<script>...</script>`in`mytemplate.html`添加到“js”块中：

```
{% addtoblock "js" %}<script>...</script>{% endaddtoblock %} 
```

（使用 Sekizai 还需要更改过滤器：

```
from sekizai.context import SekizaiContext
...
    return myhtml.render(SekizaiContext(context)) 
```

)

但这不起作用，因为模板过滤器没有“js”块 - 所以 javascript 永远不会呈现。然而，在大图中有一个“js”块，例如过滤器是从一个看起来像这样的模板调用的：

```
{% load sekizai_tags %}
<head>...</head>
<body>
     {{ info|myfilter }}
     {% render_block "js" %}
</body> 
```

那么......有没有办法解决这个问题？我可以在我的模板过滤器中添加一个 Sekizai 块，并让它在页面模板上呈现吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T08:52:01.817

Django 模板过滤器不继承全局模板上下文，但[包含标签](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#inclusion-tags)可以（如果您`takes_context=True`在`inclusion_tag`装饰器中设置）。

我建议您重构代码以使用包含标记而不是过滤器，在这种情况下，sekizai 块***可能会***起作用。

# eclipse - 为什么日食给我这个错误？

> ID：14390839
> 
> 赞同：1
> 
> 时间：2013-01-18T00:53:45.930
> 
> 标签：eclipse, plugins

好的，所以我为eclipse安装了[这个](http://java.decompiler.free.fr/?q=jdeclipse)插件。我将其 features 文件夹中的所有内容拖到 Eclipse 中，并将其插件文件夹中的所有内容拖到 Eclipse 的插件文件夹中。我还将 site.xml 复制到 Eclipse 的主文件夹中。但是当我启动 eclipse 并试图查看类文件时，他们给了我一个 eclipse 错误。我尝试卸载它，但它没有显示它已安装。我也尝试删除我复制的基本文件，但它仍然给了我同样的错误。

错误，近距离，是这样的：

```
 org.eclipse.core.runtime.CoreException: The Class File Viewer cannot handle the given input ('org.eclipse.ui.ide.FileStoreEditorInput').
    at org.eclipse.jdt.internal.ui.javaeditor.ClassFileEditor.doSetInput(ClassFileEditor.java:652)
    at org.eclipse.ui.texteditor.AbstractTextEditor$19.run(AbstractTextEditor.java:3200)
    at org.eclipse.jface.operation.ModalContext.runInCurrentThread(ModalContext.java:464)
    at org.eclipse.jface.operation.ModalContext.run(ModalContext.java:372)
    at org.eclipse.jface.window.ApplicationWindow$1.run(ApplicationWindow.java:759)
    at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
    at org.eclipse.jface.window.ApplicationWindow.run(ApplicationWindow.java:756)
    at org.eclipse.ui.internal.WorkbenchWindow.run(WorkbenchWindow.java:2649)
    at org.eclipse.ui.texteditor.AbstractTextEditor.internalInit(AbstractTextEditor.java:3218)
    at org.eclipse.ui.texteditor.AbstractTextEditor.init(AbstractTextEditor.java:3245)
    at org.eclipse.ui.internal.EditorManager.createSite(EditorManager.java:828)
    at org.eclipse.ui.internal.EditorReference.createPartHelper(EditorReference.java:647)
    at org.eclipse.ui.internal.EditorReference.createPart(EditorReference.java:465)
    at org.eclipse.ui.internal.WorkbenchPartReference.getPart(WorkbenchPartReference.java:595)
    at org.eclipse.ui.internal.EditorAreaHelper.setVisibleEditor(EditorAreaHelper.java:271)
    at org.eclipse.ui.internal.EditorManager.setVisibleEditor(EditorManager.java:1459)
    at org.eclipse.ui.internal.EditorManager$5.runWithException(EditorManager.java:972)
    at org.eclipse.ui.internal.StartupThreading$StartupRunnable.run(StartupThreading.java:31)
    at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)
    at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)
    at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4140)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3757)
    at org.eclipse.ui.application.WorkbenchAdvisor.openWindows(WorkbenchAdvisor.java:803)
    at org.eclipse.ui.internal.Workbench$33.runWithException(Workbench.java:1600)
    at org.eclipse.ui.internal.StartupThreading$StartupRunnable.run(StartupThreading.java:31)
    at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)
    at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)
    at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4140)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3757)
    at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2609)
    at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2499)
    at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:679)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:668)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:123)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1410) 
```

屏幕截图是这样的：

![错误截图](../Images/d68cd16a2f58231b4eb1e03a25b8af5e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-12T10:52:40.587

您没有以正确的方式安装插件，它很可能无法正常工作。JD-Eclipse 页面告诉你如何正确安装它。即使您下载存档`Update Site`，您也必须使用该`Install New Software...`对话框。在给定的说明中，您应该做的唯一不同的事情是在`New Repository`对话框中，而不是将 URL 粘贴`Update Site`到输入中 - 单击`Archive...`按钮并选择您下载的 zip 文件。

您不应该通过简单地将 jar 文件复制到相应的文件夹中来破坏整个安装，但显然它已损坏或暴露了一些错误，从而引发了给定的异常。实际上，异常看起来像是标准 JDT 类编辑器失败了，而不是 JD-Eclipse。

我建议您关闭 Eclipse，删除您手动复制粘贴的所有文件，再次启动它并尝试在工作区中打开一些类文件。如果可以，请尝试正确安装 JD-Eclipse（如果您在 Windows 上，则包括 Microsoft Visual C++ 2008 Express Edition）。如果它不起作用，请尝试重新安装 Eclipse。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:59:06.697

您将要查看的类文件放在什么位置和位置？该类文件是否存在于您的工作区中？如果没有，请尝试将您的类文件放入您的工作区

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-02-20T05:23:25.780

对于快速和肮脏的检查，我找到了一个更好的选择：转到[http://jd.benow.ca/](http://jd.benow.ca/)并将您的类文件拖放到底部的“Live Demo”->“Input Files”部分。像魅力一样工作！

# java - 这个java单例类实现有什么问题？

> ID：14390840
> 
> 赞同：2
> 
> 时间：2013-01-18T00:53:46.523
> 
> 标签：java

我在 stackexchange 中看到了另一篇关于实现 java 单例的各种方法的文章。显示的方法之一是以下示例。它的票数很低。想知道为什么。 [在 Java 中实现单例模式的有效方法是什么？](https://stackoverflow.com/questions/70689/what-is-an-efficient-way-to-implement-a-singleton-pattern-in-java)

```
public class Singleton {

    private static Singleton instance = null;

    static {
          instance = new Singleton();
          // do some of your instantiation stuff here
    }

    private Singleton() {
          if(instance!=null) {
                  throw new ErrorYouWant("Singleton double-instantiation, should never happen!");
          }
    }

    public static getSingleton() {
          return instance;
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T00:58:40.510

正如[@Craig](https://stackoverflow.com/users/23572/craig)在评论中所说：

> 不对。加载类时，静态变量与静态块一起初始化。无需拆分声明。

从本质上讲，它被否决了，因为它是错误信息，他所说的很多内容都不是真的。**具体来说，在加载类时会**使用静态方法初始化静态变量，而作者声称并非如此。

他的论点也没有真正的意义，“数据插入”可以在构造函数中完成。

话虽如此，上面的代码可以正常工作，这只是一种奇怪的方式，并且可以说是最不风格的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T00:57:42.113

以下解决方案确保它是线程安全的

```
public class Singleton {
    // Private constructor prevents instantiation from other classes
    private Singleton() { }

    /**
    * SingletonHolder is loaded on the first execution of Singleton.getInstance() 
    * or the first access to SingletonHolder.INSTANCE, not before.
    */
    private static class SingletonHolder { 
            public static final Singleton INSTANCE = new Singleton();
    }

    public static Singleton getInstance() {
            return SingletonHolder.INSTANCE;
    } 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T01:05:20.847

这不是实现它的好方法。

由于静态变量是在 JVM 加载时初始化的，因此只需将单例设为 final：

```
public final class Singleton
{ 
    private static final Singleton INSTANCE = new Singleton();

    private Singleton()
    {
        // build it
    }

    public static Singleton getInstance()
    {
        return INSTANCE;
    }
} 
```

# grails - IMAP 空闲方法挂起 + javax.mail + groovy

> ID：14390844
> 
> 赞同：1
> 
> 时间：2013-01-18T00:53:57.253
> 
> 标签：grails, groovy, imap, jakarta-mail

我已经配置了 courier IMAP 服务器并测试了 IDLE 功能，它在使用 telnet 时可以正常工作

```
 machinexxx:~$ telnet hostname 143
    Trying x.x.x.x...
    Connected to hostname.
    Escape character is '^]'.
    * OK [CAPABILITY IMAP4rev1 UIDPLUS CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT THREAD=REFERENCES SORT QUOTA IDLE ACL ACL2=UNION STARTTLS] Courier-IMAP ready. Copyright 1998-2008 Double Precision, Inc.  See COPYING for distribution information.
    a login loginname password
    a OK LOGIN Ok.
    b select INBOX
    * FLAGS (\Draft \Answered \Flagged \Deleted \Seen \Recent)
    * OK [PERMANENTFLAGS (\* \Draft \Answered \Flagged \Deleted \Seen)] Limited
    * 27 EXISTS
    * 0 RECENT
    * OK [UIDVALIDITY 1358238865] Ok
    * OK [MYRIGHTS "acdilrsw"] ACL
    b OK [READ-WRITE] Ok
    b IDLE
    + entering ENHANCED idle mode
    * 28 EXISTS
    * 1 RECENT 
```

当我从我的 grails 应用程序中尝试相同的操作时，它只是挂在 java mail IMAPFolder idle() 命令上并且没有得到任何更新。知道发生了什么吗？我试图搜索其他问题，看起来没有一个直接的解决方案（他们建议多线程或创建一个线程来调用 idle() 方法，然后重新运行同一个线程）有没有人实现它请分享代码. 谢谢！

```
 def serviceMethod() {

        log.info("Email Service check for emails!")

        runAsync {   
        Properties props = new Properties()           

        props.setProperty "mail.store.protocol", "imap"
        props.setProperty "mail.imap.host", "hostname"  
        props.setProperty "mail.imap.port", "143"

        def sess = Session.getDefaultInstance props, null      
        def store = sess.getStore "imap"        

        IMAPFolder inbox

        try{

              store.connect("hostname", 143, "loginname", "password") 

              inbox = store.getFolder "INBOX" 

              inbox.open(Folder.READ_WRITE)

              inbox.idle(false)

              def messages = inbox.search(new FlagTerm(new Flags(Flags.Flag.SEEN), false))

              def contents, bodyPart
                messages.each { msg ->

                println("${msg.subject} ${msg.sender}")

              }        
        } 
        catch(MessagingException e){
            log.error "Issue with connecting to email store or accessing folder or messages: " + e
        }
        catch(Exception eX){
            log.error "enable to read email " + eX
        }
        finally {
          if(inbox){
              inbox.close(true)
             }
              store.close()
        }
    }
    } 
```

# wpf - 根据模板绑定背景颜色WPF更改内容模板的线性渐变偏移颜色

> ID：14390845
> 
> 赞同：0
> 
> 时间：2013-01-18T00:53:59.080
> 
> 标签：wpf, xaml, controltemplate, templatebinding, lineargradientbrush

好的，这就是问题所在。我试图弄清楚如何使这项工作：

考虑以下用于创建自定义按钮的 ControlTemplate：

```
<ControlTemplate x:Key ="cButton" TargetType="{x:Type Button}">
      <!--Styles-->
      <Grid x:Name="bkg">
      <Grid.Background>
         <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
           <GradientStop Color="{TemplateBinding Background}" Offset="0.5"/><!-- Error! -->
           <GradientStop Color="White" Offset="1.0"/>
       </LinearGradientBrush>
      </Grid.Background>
      <ContentPresenter 
    TextBlock.FontSize="80" 
    HorizontalAlignment="Center" 
    VerticalAlignment="Center" 
    ContentSource="Content" />
      </Grid>
      <!--Triggers-->
      <ControlTemplate.Triggers>
         <Trigger Property="IsPressed" Value="True">
         <Setter TargetName="bkg" Property="Background" Value="White"/>
         </Trigger>
      </ControlTemplate.Triggers>
   </ControlTemplate> 
```

此控制模板构成此脚本的一部分，如您所见，我正在尝试从主网格中概述的按钮声明中获取背景颜色。

```
<Grid>
<Grid.Resources>
   <ControlTemplate x:Key ="cButton" TargetType="{x:Type Button}">
      <!--Styles-->
      <Grid x:Name="bkg">
      <Grid.Background>
         <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
           <GradientStop Color="{TemplateBinding Background}" Offset="0.5"/><!-- Error! -->
           <GradientStop Color="White" Offset="1.0"/>
       </LinearGradientBrush>
      </Grid.Background>
      <ContentPresenter 
    TextBlock.FontSize="80" 
    HorizontalAlignment="Center" 
    VerticalAlignment="Center" 
    ContentSource="Content" />
      </Grid>
      <!--Triggers-->
      <ControlTemplate.Triggers>
         <Trigger Property="IsPressed" Value="True">
         <Setter TargetName="bkg" Property="Background" Value="White"/>
         </Trigger>
      </ControlTemplate.Triggers>
   </ControlTemplate>
  </Grid.Resources>
  <Grid.ColumnDefinitions>
   <ColumnDefinition Width="*"/>
    <ColumnDefinition Width="*"/>
  </Grid.ColumnDefinitions >
  <Button Name="btnIn" Grid.Column="0" Content="IN" Background="Green"  Foreground="White" Template="{StaticResource cButton}"/>
  <Button Name="btnOut" Grid.Column="1" Content="OUT" Background="Red" Foreground="White" Template="{StaticResource cButton}" />
  </Grid> 
```

好的，现在主要问题是这个..

问题1：为什么按钮的ControlTemplate中标有错误注释的行没有使用模板绑定检索背景颜色？如果我使用纯色，它会工作得很好，所以我看不出为什么它不应该以这种方式工作。请提供发生这种情况的原因。

以下仍然有点不清楚，我不知道它们是否与问题有关，如果有人可以清除它们，那就太好了。

问题 2：这两个 TargetType 值“Button”和“{x:Type Button}”有什么区别。我知道它们是 typeof 等价物，但两者之间有什么区别吗？我读了 MSDN，但真正的区别并不那么清楚。

问题 3：我何时使用 x:Name 以及何时使用 Name ？区别再次不清楚。

问题 4：x:Static 是做什么的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T07:36:51.610

我认为您的模板无法正常工作，因为 Background 属性是 Brush （类）。然后你尝试将它绑定到 Color (struct)

UPD 你可以像这样使用简单的转换器：

```
public class BrushToColorConverter: IValueConverter{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        SolidColorBrush b = value as SolidColorBrush;
        if (b != null)
        {
            return b.Color;
        }
        return null;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

将其添加到资源中：

```
<wpfApplication1:BrushToColorConverter x:Key="btcConv"/> 
```

并修改你的风格：

```
 <Grid.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="{Binding Path=Background, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource btcConv}}" Offset="0.5"/>
                        <GradientStop Color="White" Offset="1.0"/>
                    </LinearGradientBrush>
                </Grid.Background> 
```

或者您可以使用这样的绑定（如果您确定背景是 SolidColorBrush）：

```
<GradientStop Color="{Binding Path=Background.Color, RelativeSource={RelativeSource TemplatedParent}}" Offset="0.5"/> 
```

# c++ - constexpr 类的设计：合并 constexpr 和非 constexpr 版本？

> ID：14390848
> 
> 赞同：13
> 
> 时间：2013-01-18T00:54:04.477
> 
> 标签：c++, c++11, constructor, constants, constexpr

考虑一个只在运行时包装一个值的类：

```
template <typename Type>
class NonConstValue 
{
    public:
        NonConstValue(const Type& val) : _value(val) {;}
        Type get() const {return _value;}
        void set(const Type& val) const {_value = val;}
    protected:
        Type _value;
}; 
```

以及它的 constexpr 版本：

```
template <typename Type>
class ConstValue 
{
    public:
        constexpr ConstValue(const Type& val) : _value(val) {;}
        constexpr Type get() const {return _value;}
    protected:
        const Type _value;
}; 
```

问题 1：您能否确认 constexpr 版本的设计方式正确？

问题 2：如何将两个类混合成一个`Value`可以`constexpr`构造或运行时构造的类，并且其值可以`get()`在运行时或编译时？

编辑：问题 3：如果`get()`在`.cpp`文件中定义，如果我想`get()`内联，如果它不是`constexpr`函数的正确声明是什么？是吗

```
constexpr inline Type get(); 
```

或者

```
inline constexpr Type get() 
```

或者是其他东西 ？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-18T00:59:56.487

只需将说明`constexpr`符添加到每个潜在的*常量表达式*函数。

```
template <typename Type>
class Value 
{
public:
    constexpr Value(Type const& val) : _value(val) {}
    constexpr Type const& get() const {return _value;}
    void set(Type const& val) {_value = val;}
protected:
    Type _value;
}; 
```

您不需要*const*和*非常量*版本，因为这可以通过`Value`使用*const*或*非常量*类型实例化模板来完成。

您不需要*constexpr*和*非 constexpr*版本，`constexpr`这意味着潜在的*常量表达式*以及表达式是否最终成为*常量表达式*取决于它的参数。表达式是否最终在*编译*时被评估取决于上下文和实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T01:00:42.393

您的`constexpr`类设计正确，只是您输入了构造函数的名称错误（应该是`ConstValue`，而不是`Value`）。但我确信这只是一个错字。

您的版本的实例`constexpr`既可以用作编译时对象，也可以用作运行时对象。

```
template <typename Type>
class ConstValue
{
    public:
        constexpr ConstValue(const Type& val) : _value(val) {;}
        constexpr Type get() const {return _value;}
    protected:
        const Type _value;
};

int main(int argc, char* argv[])
{
    int x[ConstValue<int>(3).get()];
} 
```

# ruby - 如果不满足条件，Thor::Group 不会继续

> ID：14390860
> 
> 赞同：0
> 
> 时间：2013-01-18T00:55:43.020
> 
> 标签：ruby, thor

我正在从 RubiGen 转换生成器，并希望这样做，如果不满足条件，则 Thor::Group 中的任务组不会完成。

RubiGen 生成器看起来像这样：

```
 def initialize(runtime_args, runtime_options = {})
   super
   usage if args.size != 2
   @name = args.shift
   @site_name=args.shift
   check_if_site_exists
   extract_options
 end

def check_if_site_exists
  unless File.directory?(File.join(destination_root,'lib','sites',site_name.underscore))
    $stderr.puts "******No such site #{site_name} exists.******"
   usage
  end
 end 
```

因此，如果该站点尚未生成，它会显示一个使用横幅并退出。

使用 thor 重新创建它的最佳方法是什么？

这是我的任务。

```
class Page < Thor::Group 
include Thor::Actions
source_root File.expand_path('../templates', __FILE__)

argument :name
argument :site_name
argument :subtype, :optional => true

def create_page
  check_if_site_exists
  page_path = File.join('lib', 'sites', "#{site_name}")
  template('page.tt', "#{page_path}/pages/#{name.underscore}_page.rb")
end

def create_spec 
    base_spec_path = File.join('spec', 'isolation', "#{site_name}")
        if subtype.nil? 
            spec_path = base_spec_path
        else 
            spec_path = File.join("#{base_spec_path}", 'isolation')
        end

        template('functional_page_spec.tt', "#{spec_path}/#{name.underscore}_page_spec.rb")

end

protected 

 def check_if_site_exists # :nodoc:
      $stderr.puts "#{site_name} does not exist." unless File.directory?(File.join(destination_root,'lib','sites', site_name.underscore))
 end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T05:47:19.980

在查看了 spree gem 的生成器之后，我首先添加了一个方法来检查站点，如果在向控制台输出错误消息后找不到该站点，则使用代码 1 退出。代码看起来像这样：

```
def check_if_site_exists 
  unless File.directory?(path/to/site) 
     say "site does not exist." 
     exit 1
  end
end 
```

# oracle - Oracle 文本搜索不适用于某些单词

> ID：14390863
> 
> 赞同：2
> 
> 时间：2013-01-18T00:55:58.623
> 
> 标签：oracle, full-text-search

我正在为我的项目使用 Oracle 的文本搜索。我在我的专栏上创建了一个 ctxsys.context 索引并插入了一个条目“你想要一些酒吗？？？”。我执行了查询

```
select guid, text, score(10) from triplet where contains (text, 'Would', 10) > 0 
```

它没有给我任何结果。查询“you”和“some”也返回零结果。只有 'like' 和 'wine' 匹配记录。甲骨文是否将您视为停用词？我怎样才能让Oracle匹配这些词？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T04:34:35.727

所以，我发现根据 oracle 中的停用词列表，查询的输出是完美的。

这些词可以在 ctxsys 包中找到，您可以使用

```
SELECT * FROM CTX_STOPLISTS;
SELECT * FROM ctx_stopwords; 
```

是的，oracle 将您的查询中的“you”、“would”视为停用词。以下列表是默认停用词。

```
a   did     in  only    then    where
all     do  into    onto    there   whether
almost  does    is  or  therefore   which
also    either  it  our     these   while
although    for     its     ours    they    who
an  from    just    s   this    whose
and     had     ll  shall   those   why
any     has     me  she     though  will
are     have    might   should  through     with
as  having  Mr  since   thus    would
at  he  Mrs     so  to  yet
be  her     Ms  some    too     you
because     here    my  still   until   your
been    hers    no  such    ve  yours
both    him     non     t   very     
but     his     nor     than    was      
by  how     not     that    we   
can     however     of  the     were     
could   i   on  their   what     
d   if  one     them    when 
```

如果您需要删除一些指定的词（或添加停用词），

（您需要 **GRANT EXECUTE ON CTXSYS.CTX_DDL **）然后，您必须执行一个过程，例如：

```
begin
ctx_ddl.remove_stopword('mystop_list','some');
ctx_ddl.remove_stopword('mystop_list','you');
end; 
```

请参阅ctx_ddl 包中各种功能的[链接](http://www.cnptia.embrapa.br/~fernanda/ORACLE/docs_intermedia/cddlpkg.htm#17004)

您可以通过查询获得有关创建的 ctx 索引的完整描述，

```
select ctx_report.describe_index('yourindex_name') from dual; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T08:31:58.707

看[文档](http://docs.oracle.com/cd/E11882_01/text.112/e24435/query.htm)

在“4.1.5 查询停用词”段落中，您可以获得一些有用的信息:)

# c# - 静止搜索中的错误

> ID：14390865
> 
> 赞同：2
> 
> 时间：2013-01-18T00:56:40.647
> 
> 标签：c#, search, chess, minimax

我一直在稳定地开发一个国际象棋程序，并且很快就会有一个极小极大搜索、迭代深化和转置表。然而，目前，我有一个错误，我已将其隔离在我的静止搜索中。我很沮丧，因为我直接复制了一个伪代码实现，但它似乎对我不起作用。我在网上找到的其他实现给了我类似的结果。

当多次重新捕获可用时，该错误似乎错误地计算了对手的“最佳”捕获，因此返回一个通常有利于调用搜索的一方的值。

**引擎是用 C# 编写的**

```
public static double Quiet(Game game, double alpha, double beta, int depth)
    {           
        double eval = Evaluation.evaluate(game);
        if(depth == 0)
        {
            return eval;
        }

        // Pseudo-legal sorted moves (Captures first)
        List<SerializedMove> moves = MoveGenerator.ListAllMoves(game, false);

        foreach(SerializedMove move in moves)
        {
            // If the move is not a capture
            if(move.taken_type == SerializedMove.NONE)
            {
                // Because of move ordering break if not a capture (Captures are first)
                break;
            }

            // Make move and alternate side to move 
            game.MakeMove(move);
            if(game.whiteMoves)
            {
                double score = Quiet(game, alpha, beta, depth - 1);
                if(score > alpha)
                {
                    alpha = score;
                }
            }
            else
            {
                double score = Quiet(game, alpha, beta, depth - 1);
                if(score < beta)
                {
                    beta = score;
                }
            }
            game.UnmakeMove(move);
            if(beta <= alpha)
            {
                break;
            }
        }

        if(game.whiteMoves)
        {
            if(beta == Evaluation.KING)
            {
                return eval;
            }
            else
            {
                return beta;
            }
        }
        else
        {
            if(alpha == -Evaluation.KING)
            {
                return eval;
            }
            else
            {
                return alpha;
            }
        }
    } 
```

我的评估函数分别返回有利于白色或黑色的 +/- 值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T16:14:26.630

在 Quiet() 函数循环遍历移动列表后，它会返回错误的黑白移动值。如果白棋在移动，则应返回 alpha，因为这是您跟踪白棋最佳棋步得分的地方。同样，如果黑色正在移动，则应返回 beta。

# php - 重新填充生日下拉列表

> ID：14390866
> 
> 赞同：0
> 
> 时间：2013-01-18T00:57:02.927
> 
> 标签：php, codeigniter

当验证失败并且页面重新加载时，我无法弄清楚如何在 CodeIgniter 中重新填充我的生日下拉助手。我正在尝试使用`set_value('field_name')`它比我的其他下拉菜单更复杂一些，因为它涉及三个元素。

我的代码在[这里可用](https://gist.github.com/a1c8428675d890d6b5f4)

提前致谢

这是验证规则

```
$this->form_validation->set_rules('relation', 'Relation', 'trim|required');
$this->form_validation->set_rules('location', 'Location', 'trim|required');
$this->form_validation->set_rules('city', 'City', 'trim|required');
$this->form_validation->set_rules($birthdate, 'Birthday', 'trim|required');
$this->form_validation->set_rules('gender', 'Gender', 'trim|required'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:49:41.617

这是我用来验证生日（并重新填充下拉菜单）的精简版本。仅供参考，我在这里有一些逻辑，您可能想要删除。

验证规则：

```
$this->form_validation->set_rule('birthdate-month','Birthdate Month','required|is_natural_no_zero|greater_than[0]|less_than[13]');
$this->form_validation->set_rule('birthdate-day','Birthdate Day','required|is_natural_no_zero|greater_than[0]|less_than[32]');
$this->form_validation->set_rule('birthdate-year','Birthdate Year','required|is_natural_no_zero|greater_than[1930]|less_than['.(date("Y") - 18).']'); 
```

控制器：

```
if ($this->form_validation->run()) {
    $birthdate = array(
        $this->form_validation->set_value('birthdate-year'),
        $this->form_validation->set_value('birthdate-month'),
        $this->form_validation->set_value('birthdate-day')
    );

    $data = array(
        'birthdate' => implode("-", $birthdate)
    );
}

// Then pass $data to your model and do whatever you want, i.e.:
$this->user_model->update_user($data); 
```

然后是视图中的 PHP/HTML：

```
<select name="birthdate-month" id="birthdate-month">
    <option value=""></option>
    <?php foreach($months as $month_number => $month_name) { ?>
    <option value="<?php echo $month_number; ?>" <?php echo set_select('birthdate-month', $month_number); ?>><?php echo $month_name; ?></option>
    <?php } ?>
</select>

<select name="birthdate-day" id="birthdate-day">
    <option value=""></option>
    <?php for($i=1; $i<=31; $i++) { ?>
    <option value="<?php echo $i; ?>" <?php echo set_select('birthdate-day', $i); ?>><?php echo $i; ?></option>
    <?php } ?>
</select>

<select name="birthdate-year" id="birthdate-year">
    <option value=""></option>
    <?php for($i=(date("Y") - 18); $i>=1930; $i--) { ?>
    <option value="<?php echo $i; ?>" <?php echo set_select('birthdate-year', $i); ?>><?php echo $i; ?></option>
    <?php } ?>
</select> 
```

仅供参考，`$months`是一个数组：

```
array(
    '01' => 'January',
    '02' => 'February',
    '03' => 'March',
    '04' => 'April',
    '05' => 'May',
    '06' => 'June',
    '07' => 'July',
    '08' => 'August',
    '09' => 'September',
    '10' => 'October',
    '11' => 'November',
    '12' => 'December'
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T01:32:51.077

文档告诉：

> **设置选择（）**
> 
> 如果您使用菜单，此功能允许您显示已选择的菜单项。第一个参数必须包含选择菜单的名称，第二个参数必须包含每个项目的值，第三个（可选）参数允许您将项目设置为默认值（使用布尔值 TRUE/FALSE）。

**例子：**

```
<select name="myselect">
<option value="one" <?php echo set_select('myselect', 'one', TRUE); ?> >One</option>
<option value="two" <?php echo set_select('myselect', 'two'); ?> >Two</option>
<option value="three" <?php echo set_select('myselect', 'three'); ?> >Three</option>
</select> 
```

# php - PHP：如何根据嵌套值获取数组

> ID：14390868
> 
> 赞同：1
> 
> 时间：2013-01-18T00:57:21.717
> 
> 标签：php, arrays, multidimensional-array

给定这个数组和一个名称（例如'def'），我如何获得包含数组或键？

```
$all = array(
 '0' => array(
      'name' => 'abc'
      'option' => 1,
    ),
 '1' => array(
      'name' => 'def'
      'option' => 1,
    ),
 '2' => array(
      'name' => 'ghi'
      'option' => 0,
    ),
); 
```

给定'def'返回这个数组的最佳方法是什么？

```
$single = array(
  'name' => 'def'
  'option' => 1,
); 
```

我可以做这样的事情：

```
$single = array();
foreach ($all as $key => $value) {
  if ($value['name'] == 'def') {
    $single = $all[$key]; 
  }
} 
```

或者预渲染数组中的键，使其看起来像这样：

```
$all = array(
 'abc' => array(
      'name' => 'abc'
      'option' => 1,
    ),
 'def' => array(
      'name' => 'def'
      'option' => 1,
    ),
 'ghi' => array(
      'name' => 'ghi'
      'option' => 0,
    ),
);
$single = $all['def']; 
```

但我想知道是否有更短的 php 函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T01:03:56.517

你可以使用[array_filter](http://php.net/manual/en/function.array-filter.php)：

```
array_filter($array, function($var){
   return $var["name"] == "def";
}); 
```

# iphone - iphone 5模拟器中没有按钮事件

> ID：14390869
> 
> 赞同：4
> 
> 时间：2013-01-18T00:57:23.500
> 
> 标签：iphone, ios, ios5, ios6, ios-simulator

当我测试我在 iPhone 6 模拟器中运行的应用程序时，一切都按预期工作。但是，如果我在 iPhone 5 或 iPhone 5.1 模拟器中对其进行测试，我似乎无法触发按钮事件。我使用 Xcode 4.5.2，不使用情节提要，我使用简单的按钮进行了测试，操作如下：

```
- (IBAction)test:(id)sender {

    NSLog(@"YEES");
} 
```

并且这些操作是使用界面构建器中的拖放连接的。我似乎无法将其解雇..您知道可能是什么问题吗？

**1月18日更新：**

如果我“正常”单击 iPhone 5/5.1 模拟器中的按钮，则不会发生任何事情。如果我稍微“慢”点击一个按钮，该按钮将被“按下”/选中。如果我做一个“非常慢”的点击，比如按住按钮 3 秒钟，我会得到按钮点击事件！这怎么可能？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:54:16.007

我为我的案例找到了一个解决方案 - 我将 UITapGestureRecognizer 添加到容器 UIView 中，它会在 UIButtons 之前拦截事件，并且需要一些时间才能失败，然后按钮才能处理点击……但奇怪的是，在 iOS 6 中一切正常

为了避免这种情况，我们可以简单地调用：

```
[tapRecognizer setCancelsTouchesInView:NO]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:10:36.823

我真的怀疑这可能是视图重叠的问题。请为您在视图控制器上使用的视图着色，并检查您的任何视图是否与您的按钮重叠

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-04T01:33:30.023

我在 iPhone 5s 模拟器上遇到了类似的问题。通过反复试验，我意识到模拟器中按钮的高度为 0 或其他小数字......第一个线索是当我更改其背景颜色时 - 背景没有显示在模拟器中（在较大的模拟器上，像 6 或 6 plus，它显示为细线而不是全高）。然后当我添加一个高度约束时，它开始接受点击事件。这帮助我确定了问题，但这不是我正在寻找的解决方案。最初我在没有尺寸限制的情况下布置了按钮，所以它的实际尺寸应该由它的固有尺寸决定。因此，我将按钮的垂直压缩阻力改为“必需”，而不是高度约束。这解决了这个问题。

# python - QThread多次执行

> ID：14390879
> 
> 赞同：0
> 
> 时间：2013-01-18T00:58:45.163
> 
> 标签：python, pyqt4, signals-slots, qthread

我在这里写了一个简短的程序来记录和回放我的鼠标动作。我已经实现了一个简单的 GUI，`PyQt`并且过去可以使用它。最近我决定通过实现而不是在主循环`QThread`中使用来更新代码以减少“hacky” 。`processEvents()`

下面的代码执行，但行为奇怪。运行代码时，会发生以下情况：

> **输入1：**我按记录
> 
> **控制台输出：** `isRecording = True`
> 
> **输入 2：**我按下停止
> 
> **控制台输出：** `Stopped!`
> 
> **输入 3：**我按下播放
> 
> **控制台输出：** `isRecording = True`
> 
> **输入 4：**我按下停止
> 
> **控制台输出：** `Stopped!` `Play!` `Playback complete!`

我不清楚为什么按下`play`程序后会尝试再次录制，并且只有在按下停止后才会开始播放。此外，在经历了这段怪异之后，它继续表现出这种类似类型的输出，但偏差很小。

我的猜测是它与重新分配线程信号`started`有关，具体取决于我是否调用类的`play`or`record`成员函数`CursorCapture`。

任何见解将不胜感激。

## 代码

```
import win32api
import sys
import time

from PyQt4 import QtGui
from PyQt4.QtCore import Qt, QPoint
from PyQt4 import QtCore

class MouseRecord(QtCore.QObject):

    finished = QtCore.pyqtSignal()    

    def __init__(self):

        super(MouseRecord, self).__init__()        

        self.isRecording = False
        self.cursorPath = []

    @QtCore.pyqtSlot()  
    def record(self):

        self.isRecording = True
        self.cursorPath = []
        print "isRecording = " + str(self.isRecording)

        while(self.isRecording):

            #print "Recording"            

            self.cursorPath.append(win32api.GetCursorPos())
            time.sleep(.02)            

        self.finished.emit()
        print "Stopped!"

    def stop(self):

        self.isRecording = False

    @QtCore.pyqtSlot()    
    def play(self):

        print "Play!"

        for pos in self.cursorPath:
            #print "Playing"            
            win32api.SetCursorPos(pos)
            time.sleep(.02)        

        print "Playback complete!"
        self.finished.emit()            

class CursorCapture(QtGui.QWidget):

    def __init__(self):

        super(CursorCapture, self).__init__()

        self.isRecording = False
        self.mouseRecorder = MouseRecord()

        self.myThread = QtCore.QThread()

        self.mouseRecorder.moveToThread(self.myThread)
        self.mouseRecorder.finished.connect(self.myThread.quit) 

        self.initUI()

    def initUI(self):

        self.recordBtn = QtGui.QPushButton("&Record")
        self.stopBtn   = QtGui.QPushButton("&Stop")
        self.playBtn   = QtGui.QPushButton("&Play")        

        self.recordBtn.clicked.connect(self.record)
        self.stopBtn.clicked.connect(self.stop)
        self.playBtn.clicked.connect(self.play)

        self.hBox = QtGui.QHBoxLayout()

        self.hBox.addWidget(self.recordBtn)
        self.hBox.addWidget(self.stopBtn)
        self.hBox.addWidget(self.playBtn)

        self.setLayout(self.hBox)

        self.setWindowTitle("Cursor Capture")
        self.show()

    def record(self):

        self.myThread.started.connect(self.mouseRecorder.record)
        self.myThread.start()        

    def stop(self):

        self.mouseRecorder.stop()

    def play(self):

        self.myThread.started.connect(self.mouseRecorder.play)
        self.myThread.start()

def main():

    qApp = QtGui.QApplication(sys.argv)

    cursorCapture = CursorCapture()

    sys.exit(qApp.exec_())    

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:59:02.037

经过更多的调查和玩耍，我发现了这个问题。将信号重新连接到插槽时，您必须确保`disconnect()`之前的信号。发生的事情是：

按记录。记录信号已连接。按播放。由于记录信号没有*断开*，它首先触发。然后，播放信号被连接并执行。这种类型的行为会叠加，这就是事情表现如此奇怪的原因。

# php - 计算日期之间的天数，不计算周六和周日

> ID：14390880
> 
> 赞同：0
> 
> 时间：2013-01-18T00:58:50.380
> 
> 标签：php, date

> **可能重复：**
> [计算工作日](https://stackoverflow.com/questions/336127/calculate-business-days)

我有一份显示项目时间表的报告，在该报告中我有一个信号量，它会随着项目计划开始日期和实际日期之间的差异而变化，即：

如果计划日期与实际开始日期相同，则信号量为绿色。

如果日期之间的天数差 > 0 且 < 2，则为黄色。

如果差值 > 3，则信号量为红色。

我的代码如下所示：

```
if( (strtotime($real) - strtotime($planned)) == 0 )
{
    $semaphore = 'green';
} 
```

问题是计划日期例如在星期五，而项目实际上是在下星期一开始的。在这种情况下，信号量应该是黄色的，因为项目比计划晚了一天（工作）开始。问题是我在计算周六和周日，信号量显示为红色。

我怎样才能做出这个例外？

编辑：

我终于这样做了：

```
if((date('l',strtotime($planned)) == 'Friday') AND (strtotime('next monday',strtotime($planned)) == strtotime($real)))
{
    $semaphore = 'yellow';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:33:37.637

假设你有`$real = '2007/10/31';`

```
 $weekday = date('l', strtotime($real));  // Wednesday 
```

这可以[帮助你吗](http://prajapatinilesh.wordpress.com/2009/05/07/get-all-dates-between-two-dates-using-php-code/)

我建议在这些日期之间获取几天，然后确定它们之间的日子是星期日还是星期六

# windows-mobile - 需要帮助为 Windows Mobile 6.1 和更高版本的应用程序选择平台

> ID：14390895
> 
> 赞同：0
> 
> 时间：2013-01-18T00:59:57.863
> 
> 标签：windows-mobile, windows-mobile-6.1

我一直在网上搜寻，试图确定如何最好地解决这个问题。我需要为 Windows Mobile 6.1 编写一个原始的应用程序，但我的期望是它也需要在版本 7 和更高版本上运行。

应用程序需要与数据库交互，但由于连接是断断续续的，它需要在断开模式下工作，并在用户回到范围内并提交更改时重新同步。

我目前拥有 Visual Studio 2010 专业版，理想情况下希望在此 IDE 中工作，但这很灵活。该数据库托管在 SQL Server 上，但版本可能是 2005、2008 或 2012。

任何人都可以提供有关方法的建议吗？

非常感谢

马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:06:29.883

你将面临一些巨大的挑战。首先，要面向 WinMo 6.x，您*必须*使用 Studio 2008 Pro（或 Ultimate）。Studio 2010 无法定位这些设备。

其次，来自 WinMo 6.x 的二进制文件根本无法在 Windows Phone 7（如果这就是“7”的意思）设备上运行。UI 代码也是 100% 不可移植的。

下一个版本的 Windows Embedded Handheld（WinMo 6.5 被称为）还没有被太多讨论，但基于 MS 一直在做的事情，我怀疑它会比旧版本更类似于 Phone 或 Surface温莫。业务逻辑会移植，但 UI 几乎肯定不会。

所以我的建议是安装 Studio 2008，然后确保你的代码库中有**非常非常好的**模型/视图分离，并把所有东西都接口出来，以提高你在时机成熟时能够移植的几率。您将跳过 Studio 2010，直接进入 2012。

** 编辑 **

微软[今天刚刚证实了我的怀疑](http://www.microsoft.com/en-us/news/features/2013/jan13/01-14Handheld.aspx)，即下一个版本的 Windows Embedded Handled 确实将基于 Phone 8 平台，因此您现在可以开始使用 Phone 8 SDK 进行开发。

# debugging - 我可以从交互式解释器启动调试吗？

> ID：14390907
> 
> 赞同：2
> 
> 时间：2013-01-18T01:01:07.073
> 
> 标签：debugging, python

我目前正在 Python 交互式解释器会话中。我有一个函数，我知道它正在做一些时髦的事情，所以我想在调试器会话中逐步完成它。我知道函数的文件名和行号。

我现在有什么办法可以在该函数的开头设置一个断点，然后运行它并逐步执行它吗？无需打开编辑器，找到文件，找到函数，手动插入`import pdb; pdb.set_trace()`，保存文件，然后返回解释器，重新加载函数来自的模块并运行它？更不用说，如果我忘记删除以后会带来麻烦的 pdb 跟踪。

**总结问题：**如果我在一个普通的 Python 解释器会话（或 iPython）中，是否可以在某处设置断点并开始调试，而无需在`pdb.set_trace()`某处实际编辑代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:08:26.370

我不敢相信我错过了这一点，但我只是第二次浏览了[pdb 文档](http://docs.python.org/2/library/pdb.html)，并意识到所有`run*`功能几乎完全符合我的要求。他们不允许我将特定的行设置为断点，但我可以传递我想要使用的函数和参数，它会在函数的第一行中断：

```
import pdb
pdb.runcall(my_wonky_function, "arg1", "arg2", *myargs) 
```

实际上它在一个名为“EOF”的神秘位置破裂：

```
(pdb) 列表
[EOF]
```

在我到达函数的第一行之前，我必须走两步，但这几乎不是问题。

# android - 如何控制 Android WebView 历史/回栈？

> ID：14390908
> 
> 赞同：13
> 
> 时间：2013-01-18T01:01:09.443
> 
> 标签：android

我试图找出一种处理 WebView 后退堆栈的方法，类似于从我自己的应用程序的 WebView 中按下后退按钮时 Android Web 浏览器如何处理它。

问题与**Javascript 重定向**有关。WebView 后台堆栈似乎包含简单重定向的 URL。这是我的相关代码：

```
private class ArticleWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        view.loadUrl(url);
        return true;
    }
}

@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_BACK)
    {
        WebView wv = (WebView)findViewById(R.id.web);
        if (wv.canGoBack())
        {
            wv.goBack();

            return true;
        }
    }

    return super.onKeyDown(keyCode, event);
} 
```

如您所见，按下后退按钮会选择堆栈中的前一个 URL，该 URL 在调用 shouldOverrideUrlLoading() 后加载到 WebView 本身中。实际上，我在 shouldOverrideUrlLoading() 内部做了很多与这个特定问题无关的事情，所以“删除我的 WebViewClient 实现”对我不起作用。无论如何，当前一个 URL 是 Javascript 重定向时，该 URL 会加载，然后 Javascript 会立即重定向到 WebView 所在的 URL。我无法禁用 Javascript，因为该网站依赖于它。我也无法更改网站（第三方）。

这个重定向问题的结果对于最终用户来说是一个恶性循环，他们疯狂地向后按压只是为了比 Android 网页处理引擎稍微快一点。

现在这里是有趣的地方：Android Web 浏览器可以很好地处理 Javascript 重定向的后退按钮！它遵循重定向很好，但后退按钮执行用户期望它执行的操作。这意味着可以正确处理这种情况。Android 网络浏览器如何处理这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-06-12T16:56:45.983

检测用户何时触发 url 加载，并将其添加到 backstack。

```
private List<String> previous = new ArrayList<String>();
private String mLastUrl;
webview.setWebViewClient(new WebViewClient() {
    @Override
    public void onPageFinished(WebView view, String url) {
        Log.i("DebugDebug", "OnPageFinished " + url);
        mLastUrl = url;
        super.onPageFinished(view, url);
    }
});

webview.setOnTouchListener(new View.OnTouchListener() {
    @Override
    public boolean onTouch(View view, MotionEvent motionEvent) {
        WebView.HitTestResult hr  = ((WebView)view).getHitTestResult();
        if (hr != null && mLastUrl != null) {
            if (previous.isEmpty() || !previous.get(previous.size() - 1).equals(mLastUrl)) {
                previous.add(mLastUrl);
            }
            Log.i("DebugDebug", "getExtra = " + hr.getExtra() + "\t\t Type = " + hr.getType());
        }
        return false;
    }
});

@Override
public void onBackPressed() {
    Log.i("DebugDebug", "onBackPressed");
    int size = previous.size();
    if (size > 0){
        webview.loadUrl(previous.get(size - 1));
        previous.remove(size - 1);
    } else {
        super.onBackPressed();
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-22T00:32:25.773

你的 onKeyDown 应该看起来像这些

```
@Override
   public boolean onKeyDown(int keyCode, KeyEvent event)
  {
    if ((keyCode == KeyEvent.KEYCODE_BACK) && myWebView.canGoBack()) {
        myWebView.goBack();
        return true;
    }
    return super.onKeyDown(keyCode, event);
   } 
```

这里 myWebView 是在 Activity 的 onCreate 中声明的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-23T01:33:35.777

我和你有类似的问题，并找到了解决方法。这是[我的答案](https://stackoverflow.com/a/24900457/541620)。

当我单击第一个链接（www.new.a）时，它会自动重定向其他链接（mobile.new.a）。通常链接重定向两个或三个，我的解决方案几乎适用于每个重定向链接。我希望这个答案可以帮助您解决 annyoing 重定向链接。

我终于想通了。您需要一个具有四个 API 的 WebViewClient。WebViewClient中有shouldOverrideUrlLoading()、onPageStarted()、onPageFinished()和doUpdateVisitedHistory()。您需要的所有 API 都是 API 1，所以不用担心。

这是[我的答案](https://stackoverflow.com/a/24900457/541620)。看看那个！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-30T01:38:08.983

```
private class ArticleWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        return false;
    }
}

@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_BACK)
    {
        WebView wv = (WebView)findViewById(R.id.web);
        if (wv.canGoBack())
        {
            wv.goBack();
            return true;
        }
    }
    return super.onKeyDown(keyCode, event);
} 
```

如果你想在你的webview而不是系统浏览器中处理链接，这个`shouldOverrideUrlLoading`方法应该*返回* `false`，并且不要调用`view.loadUrl(url)`，如果你返回false，你的webview会自动加载url。如果您手动加载 url，历史记录将不正确。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-09T02:28:32.030

```
boolean isGoBack = false;    //back key is pressed

private long goBackTime = 0; //

@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if ((keyCode == KeyEvent.KEYCODE_BACK) && mWebView.canGoBack()) {
        isGoBack = true;
        goBackTime = System.currentTimeMillis();
        mWebView.goBack();
        return true;
    }
    return super.onKeyDown(keyCode, event);
}

Webview mWebView.

setWebViewClient(new WebViewClient() { //setWebViewClient
    @Override
    public boolean shouldOverrideUrlLoading (WebView view, String url){
        if (!TextUtils.isEmpty(startUrl) && !startUrl.equals(url) && isGoBack && System.currentTimeMillis() - goBackTime < 600) {
            isGoBack = false;
            if (mWebView.canGoBack()) {
                mWebView.goBack();
            } else {
                finish(); //activity finish
            }
        } else {
            view.loadUrl(url);
            isGoBack = false;
            return true;
        }

        return false;
    }
    @Override
    public void onPageStarted (WebView view, String url, Bitmap favicon){
        super.onPageStarted(view, url, favicon);

        startUrl = url;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-17T07:56:57.597

[正确的答案是按照https://stackoverflow.com/a/8644978/5022858](https://stackoverflow.com/a/8644978/5022858)和[https://developer.android.com/reference/android/webkit/WebViewClient.html](https://developer.android.com/reference/android/webkit/WebViewClient.html)`false`中的`shouldOverrideUrlLoading()`描述返回。这可以防止重定向被添加到历史列表中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-09T14:13:11.897

这个片段对我有用，试试吧：

```
@Override
public void onBackPressed() {
    BlankFragment fragment = (BlankFragment)
            getSupportFragmentManager().findFragmentByTag("webView");
    if (fragment.canGoBack()) {
        fragment.goBack();
    } else {
        super.onBackPressed();
    }
  } 
```

# jsf-2 - Flash Scope 不删除变量

> ID：14390909
> 
> 赞同：2
> 
> 时间：2013-01-18T01:01:18.323
> 
> 标签：jsf-2, flash-scope

当我尝试设置 Flash 范围变量然后进行重定向时，我遇到了 Flash 范围的问题。在控制台中，我得到以下跟踪...

```
 com.sun.faces.context.flash.ELFlash setCookie
    WARNING: JSF1095: The response was already committed by the time we tried to set the outgoing     
    cookie for the flash.  Any values stored to the flash will not be available on the next request. 
```

这个想法是从第一页（搜索页）传递一个 id 到第二页，但是如果我取消使用立即，我得到提到的日志，并且闪存计数器不再增加。

编码：

（搜索bean）@ManagedBean @ViewScoped 公共类ConsultarPaisBean 实现Serializable { private static final long serialVersionUID = 7947494818704255376L;

```
@ManagedProperty("#{flash}")
private Flash flash;

@ManagedProperty("#{paisService}")
private PaisService paisService;

private List<Pais> paises;
private PaisFilter paisFilter;
private Pais paisSelected;

@PostConstruct
public void init() {
    this.paisFilter = new PaisFilter();
    this.paisSelected = null;
    this.paises = null;
}

public String irRegistrarPais() {
    return MappingUrlConstants.PAIS;
}

public String irModificarPais() {
    String respuesta = null;
    if (this.paisSelected != null && this.paisSelected.getId() != null) {
        flash.put("paisId", this.paisSelected.getId());
        respuesta = MappingUrlConstants.PAIS;
    }
    return respuesta;
}

public String buscarPaises() {
    this.paisSelected = null;
    this.paises = this.paisService.getPaisByParams(this.paisFilter);
    return null;
}

public String limpiarFiltros() {
    this.paisFilter = new PaisFilter();
    return null;
}

public List<Pais> getPaises() {
    return paises;
}

public void setPaises(List<Pais> paises) {
    this.paises = paises;
}

public PaisFilter getPaisFilter() {
    return paisFilter;
}

public void setPaisFilter(PaisFilter paisFilter) {
    this.paisFilter = paisFilter;
}

public Pais getPaisSelected() {
    return paisSelected;
}

public void setPaisSelected(Pais paisSelected) {
    this.paisSelected = paisSelected;
}

public void setPaisService(PaisService paisService) {
    this.paisService = paisService;
}

public void setFlash(Flash flash) {
    this.flash = flash;
} 
```

}

（添加/更新 bean）

```
@ManagedBean
@ViewScoped
public class PaisBean implements Serializable {

private static final long serialVersionUID = 3604521826400240955L;

@ManagedProperty("#{paisService}")
private PaisService paisService;

@ManagedProperty("#{flash}")
private Flash flash;

private Pais pais;

@PostConstruct
public void init() {
    if (this.flash.get("paisId") != null) {
        Long id = (Long) this.flash.get("paisId");
        this.pais = this.paisService.getPaisById(id);
    } else {
        this.pais = new Pais();
    }
}

public String registrarPais() {

    String mensajeExito = null;
    if (this.pais.getId() == null) {
        this.paisService.save(this.pais);
        mensajeExito = MessageUtils.getMessage("org.siae.commons.messages.general", "pais.registrar.exito",
                new Object[] { this.pais.getNombre() });
    } else {
        this.paisService.update(this.pais);
        mensajeExito = MessageUtils.getMessage("org.siae.commons.messages.general", "pais.modificar.exito",
                new Object[] { this.pais.getNombre() });
    }
    FacesUtils.addInfoMessage(mensajeExito);
    return MappingUrlConstants.CONSULTAR_PAIS;
}

public String irConsultarPais() {
    return MappingUrlConstants.CONSULTAR_PAIS;
}

public void setPaisService(PaisService paisService) {
    this.paisService = paisService;
}

public void setFlash(Flash flash) {
    this.flash = flash;
}

public Pais getPais() {
    return pais;
}

public void setPais(Pais pais) {
    this.pais = pais;
} 
```

}

我感谢您的帮助。

# python - 自扫码，防止打印报表

> ID：14390911
> 
> 赞同：5
> 
> 时间：2013-01-18T01:01:49.390
> 
> 标签：python

我有一个我正在研究的python项目，而不是打印语句，我调用了一个函数say()，这样我就可以在开发过程中打印信息并在生产过程中记录信息。但是，我经常忘记这一点，并错误地将打印语句放入代码中。无论如何让python程序读取它自己的源代码，如果它在函数say()之外找到任何打印语句，则退出()？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T01:18:27.063

这可以使用[`ast`](http://docs.python.org/2/library/ast.html)模块来完成。如果您将来使用 Python 3 或 Python 2，以下代码将找到`print`语句和函数的任何调用。`print()``print_function`

```
import ast

class PrintFinder(ast.NodeVisitor):
    def __init__(self):
        self.prints_found = []

    def visit_Print(self, node):
        self.prints_found.append(node)
        super(PrintFinder, self).generic_visit(node)

    def visit_Call(self, node):
        if getattr(node.func, 'id', None) == 'print':
            self.prints_found.append(node)
        super(PrintFinder, self).generic_visit(node)

def find_print_statements(filename):
    with open(filename, 'r') as f:
        tree = ast.parse(f.read())
    parser = PrintFinder()
    parser.visit(tree)
    return parser.prints_found

print 'hi'
for node in find_print_statements(__file__):
    print 'print statement on line %d' % node.lineno 
```

这个例子的输出是：

> hi
> 第 24 行
> 打印语句 第 26行打印语句

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T01:15:28.817

虽然我不建议这样做，但如果你真的想这样做，你可以通过重新定义`print`语句让 Python 解释器抛出错误。

如果使用 Python 3，只需将其放在代码的开头/顶部附近：

```
print = None 
```

如果有任何`print`语句，您将收到`TypeError: 'NoneType' object is not callable`错误消息。

[如果使用 Python 2.x，您可以使用另一个答案](https://stackoverflow.com/a/10106489/1988505)中建议的想法来允许 Python 2.x 具有可覆盖的打印语句。

```
from __future__ import print_function
print = None 
```

将其与您的功能结合在一起`say()`，您可以执行以下操作：

```
print_original = print
print = None

def say(data):
    print = print_original 
    # Your current `say()` code here, such as:
    print(data)  # Could just use `print_original` instead.
    # Redefine print to make the statement inaccessible outside this function.
    print = None 
```

# mysql - 如何通过其他两个表从第一个表更新记录？

> ID：14390913
> 
> 赞同：-1
> 
> 时间：2013-01-18T01:02:09.583
> 
> 标签：mysql

我有三张桌子：

`TableA`

```
+-------+--------+--------+
| id_a  | name   | total  |
+-------+--------+--------+
|    1  | Andrew |        |
|    2  | Jhon   |        |
+-------+--------+--------+ 
```

`TableB`

```
+-------+--------+--------+--------+
| id_b  | id_a   | amount | id_c   |
+-------+--------+--------+--------+
|    1  | 1      |    5   | 1      |
|    2  | 1      |    1   | 2      |
+-------+--------+--------+--------+ 
```

`TableC`

```
+-------+--------+
| id_c  | status |
+-------+--------+
|    1  | 1      |
|    2  | 0      |
+-------+--------+ 
```

所以我需要做的是计算来自 TableB 的总金额总和，其中 id_a = (1 或我发布的 id) 并且 id_c 的状态为 1 或 0 并将其设置到 TableA in total 列中，用于数据我`total`在 TableA 中的字段上方发布的表，其中 id_a = 1 将包含一个`6`值。

我正在尝试通过这种方式进行查询：

```
UPDATE TableA SET total=(SELECT SUM(amount) as sum FROM TableB WHERE id_a = 1 GROUP BY(sum)) 
```

但这是错误的（我认为）。对此有何好查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:05:08.403

您可以`INNER JOIN`在内部使用 TableB 和 TableC 之间的一个`SELECT`。

```
UPDATE TableA SET
    total=(
        SELECT SUM(amount) FROM TableB
                           INNER JOIN TableC ON TableB.id_c = TableC.id_c
        WHERE id_a = 1 AND (status = 1 OR status = 0)
        GROUP BY id_a
    )
WHERE id_a = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T01:06:40.863

试试这个

```
 UPDATE TableA SET total=(SELECT SUM(amount)  FROM TableB WHERE id_a = 1) 
```

# java - 与元素类型“null”关联的属性“href”的值不能包含“<”字符

> ID：14390918
> 
> 赞同：2
> 
> 时间：2013-01-18T01:02:32.193
> 
> 标签：java, css, spring, jsp, mapping

我是 Java 和 Spring 的新手。我在尝试应用 CSS 样式时遇到了错误。这是我的jsp：

```
<jsp:root version="1.2" xmlns:jsp="http://java.sun.com/JSP/Page"
xmlns:display="urn:jsptld:http://displaytag.sf.net"
xmlns:c="http://java.sun.com/jsp/jstl/core"
xmlns:spring="http://www.springframework.org/tags">
<jsp:directive.page contentType="text/html; charset=UTF-8" />
<jsp:directive.page import="test1.domain.*" />

<html>
<head>
<title>CD Catalog</title>
<link href='<c:url value="/css/displaytag.css" />' rel="stylesheet" type="text/css" />
</head>
and so on... 
```

css 文件夹与 WEB-INF 位于同一级别。

在我的 servlet.xml 我有：

```
<mvc:resources mapping="/**" location="/*" /> 
```

我得到的下一个错误：

**HTTP 状态 500 - /WEB-INF/jsp/test_task.jsp(11,15) 与元素类型“null”关联的属性“href”的值不得包含“<”字符。**

我也尝试了单引号和双引号，并尝试了相同的双引号，但没有成功。

我会很感激任何建议。先感谢您。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T01:14:54.203

请将标签库声明添加`<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>`到标题中。taglib 指令声明您的 JSP 页面使用一组自定义标记（`c:url`此处），并标识库的位置。如果没有该指示，您的 JSP 文件将以 ( `href`) 属性结束，其中包含非转义`<`字符，这不是有效的 XML。

**更新**：

只要意识到您使用的是 JSP 文档而不是 JSP 页面，并且您已经声明了 namespace `xmlns:c`，因此不再需要 taglib。由于 JSP 文档严格要求格式良好的 XML 文档，因此它抱怨链接的 href 属性（`<`内部未转义）。为避免这种情况，请尝试：

```
<c:url var="url" value="/css/displaytag.css" />
<link href="${url}" rel="stylesheet" type="text/css" /> 
```

# php - 在哪里保留在多个 ZF2 模块中使用的类？

> ID：14390922
> 
> 赞同：2
> 
> 时间：2013-01-18T01:03:08.697
> 
> 标签：php, module, zend-framework2

我的 Zend Framework 2 应用程序中有一个服务层。在这一层，我有一个所有服务类都扩展的抽象基类，如下所示。

**基类：**

```
namespace User\Service;

use Zend\ServiceManager\ServiceManagerAwareInterface;
use Zend\ServiceManager\ServiceManager;

class AbstractService implements ServiceManagerAwareInterface {
    protected $serviceManager;

    public function setServiceManager(ServiceManager $serviceManager) {
        $this->serviceManager = $serviceManager;
    }

    public function getServiceManager() {
        return $this->serviceManager;
    }
} 
```

**服务等级：**

```
namespace User\Service;

use User\Service\AbstractService;

class UserService extends AbstractService {
    public function register($id, $username, $password) {
        /* ... */
    }
} 
```

问题是基类将在我的模块中使用（每个模块都有一个服务层），我想知道存储它的最佳位置在哪里。我的数据库层有完全相同的场景。在我的脑海中，我能想到几个可能性：

1.  每个模块中的副本。不是一个优雅的解决方案，也不容易维护。
2.  “应用程序”模块中的一个副本，每个模块都使用这个副本。创建跨模块依赖项。
3.  在`vendor`目录中，因此在任何模块目录之外。我对 Composer 还不太熟悉，但我想我可以将它作为依赖项添加到那里？

所以基本上问题是在哪里放置几个模块使用的类。让它发挥作用并不难，但问题是尽可能以最好的方式做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T03:34:52.733

我认为一个好的做法是将你所有的基类和函数单元到一个独立的公共模块中，你的其他模块将依赖于这个公共模块。

有很多参考资料你可以看看：

*   [PhlyCommon](https://github.com/weierophinney/PhlyCommon)，[PhlyBlog](https://github.com/weierophinney/PhlyBlog)所依赖的
*   [ZfcBase](https://github.com/ZF-Commons/ZfcUser)，Zfc系列模块所依赖的

有了公共模块后，可以通过composer定义模块依赖关系，然后只需一行命令即可安装所有依赖模块。

# node.js - 如何使用 Node.js 检查任意 PID 是否正在运行？

> ID：14390930
> 
> 赞同：23
> 
> 时间：2013-01-18T01:04:11.367
> 
> 标签：node.js, pid, platform-independent

有没有办法使用 Node.js 检查系统上的任意 PID 是否正在运行或存活？假设 Node.js 脚本具有适当的读取权限`/proc`或 Windows 等效权限。

这可以同步完成：

```
if (isAlive(pid)) { //do stuff } 
```

或异步：

```
getProcessStatus(pid, function(status) {
    if (status === "alive") { //do stuff }
} 
```

请注意，我希望找到一个适用于任意系统 PID 的解决方案，*而*不仅仅是正在运行的 Node.js 进程的 PID。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2014-01-22T23:28:32.907

您可以调用`process.kill(pid, 0)`并将其包装在 try/catch 中。

[http://nodejs.org/api/process.html#process_process_kill_pid_signal](http://nodejs.org/api/process.html#process_process_kill_pid_signal) -

> “如果目标不存在会抛出错误，作为一种特殊情况，可以使用信号 0 来测试进程是否存在。”

例子：

```
function pidIsRunning(pid) {
  try {
    process.kill(pid, 0);
    return true;
  } catch(e) {
    return false;
  }
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-02-14T22:07:41.320

我还需要检查项目中运行的 pid。我接受了这个使用的[答案](https://stackoverflow.com/questions/4647313/how-to-check-wether-a-process-with-a-given-pid-is-running?rq=1)`kill -0 <PID>`并将其包装在一个名为**is-running** [https://npmjs.org/package/is-running的模块中](https://npmjs.org/package/is-running)

`npm install is-running`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-18T01:11:35.237

我不是这里的专家，但你能不能生成一个子进程来使用命令行工具检查状态？

# node.js - 控制会话从 express 开始并连接中间件

> ID：14390932
> 
> 赞同：7
> 
> 时间：2013-01-18T01:04:18.057
> 
> 标签：node.js, session, express, connect

有没有办法控制会话何时从 connect 的会话中间件开始？

例如，如果我有快速应用配置：

```
var app = express();
app.configure(function(){
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('secret'));
  app.use(express.session({ store:sessionStore, ... }));
}); 
```

然后在*每个*请求上，如果没有给出会话 cookie，就会启动一个会话。如果我只想在用户通过身份验证后开始会话怎么办？

例如，假设我有两条路线`/protected`和`/login`.

*   如果有人`/protected`在没有会话 cookie 的情况下点击，中间件将**不会**启动新会话。（`req.session`是`null`）
*   如果有人点击`/protected`了会话 cookie，中间件将**检查**是否存在与 cookie 和 set 匹配的活动会话`req.session`，但*不会*启动新会话。（`req.session`可以有一个值或者是`null`）
*   如果有人点击`/login`了正确的参数，则**显式**启动会话并仅设置 cookie。

启动会话的唯一方法应该是明确的：

```
app.post('/login', function(req, res, next) {
  // connect to database and validate user...
  db.authenticate( req.body.user, req.body.pass, function(allow) {
    if (allow) {
      // START SESSION HERE
      // this will send set the cookie
    }
  });
} 
```

有没有办法用现有的连接会话中间件来完成这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T23:40:28.343

您要做的是删除此行：

```
app.use(express.session({ store:sessionStore, ... })) 
```

现在默认情况下禁用会话，由您决定哪个控制器将使用它们：

```
var useSessions = express.session({ store:sessionStore, ... });

var preCb = function (req, res, next) {
  // authenticate and stuff
  // ....
  if (authenticated === true) {
     next();
  }
};

app.post('/login', useSessions, function(req, res, next) { ... });
app.post('/protected', preCb, useSessions, function(req, res, next) { ... }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:15:17.103

即使每次都开始一个会话，也没有关系，因为它将是空的。如果您尝试使用它来验证访问权限（似乎是这种情况），最简单的解决方案是在您的会话中设置一个属性（例如 req.session.authenticated = true;），然后检查它。这种方式从技术上讲，任何访问者都有一个会话，但是如果 req.session.authenticated == true，您将只使用该会话。它可能不是您正在寻找的东西，但它是完成此任务的最简单方法。

# delphi - 知道使用 FastMM 分配内存的位置

> ID：14390934
> 
> 赞同：6
> 
> 时间：2013-01-18T01:04:39.180
> 
> 标签：delphi, fastmm

我正在尝试使用 Delphi 7 调试大型应用程序中的内存使用情况。我能够安装 fastmm debug full dll 并解决一些泄漏问题。

我还安装了内存使用跟踪器，让我可以查看分配了哪些块以及它们的大小。

我的问题是，有没有办法找出块的分配位置？我知道这是可能的，因为如果没有释放内存，则会打印堆栈跟踪。有没有办法“戳”fastmm 让它打印给定分配的堆栈跟踪？

附带问题：如果知道分配的起始地址，有没有办法找出对象是哪个类？（假设分配是针对一个对象的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T03:24:54.880

您可以：

*   尝试使用`LogAllocatedBlocksToFile`程序。如果其`ALastAllocationGroupToLog`参数小于`AFirstAllocationGroupToLog`或为零，则记录*所有*块及其分配调用堆栈。但是，如果您的应用程序有很多内存分配，请准备好长时间等待。我经历了大约 4 小时的等待时间和 1.5Gb 的结果文件。（旁注：使用[glogg](http://glogg.bonnefon.org/ "格洛格")查看如此大的文件）
*   修改`FastMM4.pas`以便实现`LogCallStack`将在界面中可见。或者您可以尝试直接从`FastMM_FullDebugMode.dll`

附带问题：尝试使用`DetectClassInstance`函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T01:09:28.110

如果您使用 FullDebugMode 并启用将数据写入文件的条件，那么您应该得到您想要的。当程序关闭时，它将为每个泄漏的分配写出堆栈跟踪。（如果您正在调试一个存在大量内存泄漏的程序，这可能需要一段时间。如果泄漏的项目是一个包含许多其他对象的容器，我认为它会使关闭持续 10 分钟或更长时间。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T19:09:23.533

考虑到您在评论中说应用程序的内存在应用程序关闭时得到了很好的清理，听起来您正在寻找**逻辑**内存泄漏 - 换句话说：对象的存活时间比需要的时间长，但时间到了完成应用程序它们被清理是因为存在清理它们的代码。

例子：

*   使用 Application 作为所有者创建一个 TForm，引用它的变量是 Delphi 在创建表单单元时创建的全局变量。
*   将表单的 CloseAction 配置为 caHide（在 OnClose 事件中）
*   显示表格，对其进行操作
*   关闭表单，在应用关闭之前不再使用它
*   关闭应用程序，这会使应用程序清除它拥有的所有对象

所以你有**逻辑内存泄漏**，但没有*物理内存泄漏*——这是 FastMM 可以轻松检测到的那种。由于您不希望我们假设的 TForm 在应用程序完成之前一直存在，因此它在语义上泄漏了，但是由于它被引用并且在应用程序结束时有代码破坏它，因此对于 FastMM 来说是一个正常的分配。

也就是说，您似乎不需要内存管理器的内存转储，而是内存分析器。

# jquery - 使用 Jquery 读取动态更新的 txt 文件

> ID：14390936
> 
> 赞同：0
> 
> 时间：2013-01-18T01:05:03.083
> 
> 标签：jquery, eclipse, jsp

我正在编写一个应用程序，其中 Servlet 激活爬虫并将感兴趣的 URL 写入 txt 文件。然后我想读取这个 txt 文件（逐行）并附加到我的 JSP 中。我正在使用以下 Jquery：

```
// LOAD file and split line by line and append divs
        $.get('./crawlFiles/urls.txt', function(data) {
            setTimeout(data, 3000);
            var lines = data.split("\n");
            $.each(lines, function(n, elem) {
                $('#reviewList').append('<div><a href="'+ elem +'">' + elem + '</a></div>');
            });
        }); 
```

如果没有 setTimeout() 我可以读取文件，但它会显示旧信息（我必须在 Eclipse 中重新加载项目才能获得新信息）。我通过搜索此站点发现 setTimeout() 应该可以完成工作，但是屏幕上什么也没有。

如何读取带有新添加信息的 txt 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T01:07:26.633

似乎是缓存问题？猜猜你应该将缓存配置设置为否（如上）：

```
$.ajaxSetup({
    // Disable caching of AJAX responses
    cache: false
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-18T01:17:09.973

根据请求，只需将随机数作为查询字符串 ./crawlFiles/urls.txt?rand=randomnumber。

我喜欢使用 DDMMYYYYHHMMSS 作为随机数，它总是唯一的。

# compiler-construction - 如何解决 dbus 对 libnih ./configure 的依赖？

> ID：14390939
> 
> 赞同：0
> 
> 时间：2013-01-18T01:05:18.090
> 
> 标签：compiler-construction, vps, configure, dbus, upstart

在vps环境下，我刚刚安装

```
dbus-1.6.8 
```

要求

```
libnih-1.0.3 
```

但是，libnih 的安装在此处停止：

```
checking for DBUS... no
configure: error: Package requirements (dbus-1 >= 1.2.16) were not met:

No package 'dbus-1' found

Consider adjusting the PKG_CONFIG_PATH environment variable if you
installed software in a non-standard prefix.

Alternatively, you may set the environment variables DBUS_CFLAGS
and DBUS_LIBS to avoid the need to call pkg-config.
See the pkg-config man page for more details. 
```

我在哪里设置 PKG_CONFIG_PATH 环境变量？

我的 dbus 路径是：

```
/home/MYUSER/usr/local/bin/lib/dbus-1.0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T12:19:23.387

检查 dbus-1.0 目录，它可能有一个 pkg_config (pr somesuch) 子目录。

然后，设置 PKG_CONFIG_PATH 以包含该子目录：

```
export PKG_CONFIG_PATH=/home/MYUSER/usr/local/bin/lib/dbus-1.0/SUBDIR:$PKG_CONFIG_PATH 
```

# geb - Geb 自动化 - 两个输入字段同名

> ID：14390942
> 
> 赞同：2
> 
> 时间：2013-01-18T01:06:02.550
> 
> 标签：geb

如果有人可以帮助我，我将不胜感激。我有一个表格，由

```
*Mailing Address*
*Physical Address* 
```

一个有身份证，一个没有。示例：街道 当我仅使用邮寄地址街道字段并运行脚本时 - 它也会插入物理地址街道字段。我不知道如何到达父 DIV 以分隔邮寄地址和物理地址街道字段。所以它只能在一个街道地址输入任何帮助感谢。

```
$("input", id: "Street").value("780 woodland ave") 
```

**邮寄地址：**

```
></fieldset><fieldset id="fieldset-mailing-list"><legend>Mailing List <a id="mailing-list" name="mailing-list"/></legend><div class="row-fluid"><div class="span12"><div class="control-group"><label for="mailName" class="control-label">In Care of Name</label><div class="controls"><input placeholder="" class="mailName span12" ng-model="Application.contactInformation.mailingAddress" id="mailName" type="text"/></div></div></div ></div><div class="row-fluid"><div class="span6"><div class="control-group"><label for="street" class="control-label">Street</label><div class="controls"><input ng-required="isRequired()" placeholder="Street Number and Name" class="required" ng-model="Application.contactInformation.mailingAddress.street" name="street" id="street" type="text"/><br/><span ng-show="application.street.$error.required" style="color:red">***a required field***<br/></span></div></div></div> 
```

**实际地址：**

`></fieldset><fieldset id="fieldset-physical-mailing-list"><legend>Physical Address <a id="physical-mailing-list" name="physical-mailing-list"/></legend><div class="row-fluid"><div class="span12"><label class="checkbox"><input name="sameAddress" id="sameAddress" type="checkbox"/>`

**实际地址与邮寄地址相同。**

```
</label></div></div><div class="row-fluid"><div class="span6"><div class="control-group"><label for="street" class="control-label">Street</label><div class="controls"><input placeholder="Street Number and Name" class="" ng-model="Application.contactInformation.physicalAddress.street" id="street" type="text"/></div></div></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T13:02:09.493

要选择街道输入，您可以执行以下操作：

```
$('input', name: 'street') 
```

要选择错误消息，您可以说：

```
$('input', name: 'street').closest('div').find('span') 
```

或者：

```
$('input', name: 'street').parent().find('span') 
```

或者：

```
$('input', name: 'street').nextAll('span') 
```

# sql - 跨服务器查询与本机查询的开销是多少？

> ID：14390944
> 
> 赞同：4
> 
> 时间：2013-01-18T01:06:37.773
> 
> 标签：sql, sql-server, tsql

如果我连接到 SQL Server 中的特定服务器，并且我使用引用另一台服务器中的表的查询，这会减慢查询速度吗？在）？我问是因为我想知道将该表导入我所在的服务器是否比跨服务器查询更有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:23:10.877

我会说这*取决于*。是的，可能不是您想要的答案，但这取决于情况。使用链接服务器确实是有代价的，特别是取决于您尝试返回的行数和您尝试运行的查询类型。您应该能够查看查询的执行计划，并查看有多少用于访问链接服务器表。这以及返回结果所需的时间可能有助于确定是否需要它。

关于将表格带到本地，这也取决于。您需要最新数据还是静态数据？如果是静态的，那么导入表不是一个坏主意。如果该数据不断变化并且您需要更改，那么这可能不是最佳解决方案。您总是可以考虑创建 SSIS 包以每晚执行此操作，但同样，这取决于。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T02:22:14.987

正如 sgeddes 所提到的，这取决于。

我自己对链接服务器查询的经验是，它们对于大型表来说非常慢。根据您编写查询的方式，可能必须在运行语句的服务器上评估谓词（如果您要加入它们，很可能），这意味着它可能会将整个表传输到该服务器，然后过滤结果。这对性能肯定是不利的。

# python - 抑制管道后在日志中打印的 Scrapy Item

> ID：14390945
> 
> 赞同：29
> 
> 时间：2013-01-18T01:06:38.487
> 
> 标签：python, scrapy

我有一个scrapy项目，最终进入我的管道的项目相对较大，并且存储了大量元数据和内容。一切都在我的蜘蛛和管道中正常工作。然而，当它离开管道时，日志正在打印出整个scrapy Item（我相信）：

```
2013-01-17 18:42:17-0600 [tutorial] DEBUG: processing Pipeline pipeline module
2013-01-17 18:42:17-0600 [tutorial] DEBUG: Scraped from <200 http://www.example.com>
    {'attr1': 'value1',
     'attr2': 'value2',
     'attr3': 'value3',
     ...
     snip
     ...
     'attrN': 'valueN'}
2013-01-17 18:42:18-0600 [tutorial] INFO: Closing spider (finished) 
```

如果可以避免的话，我宁愿不要将所有这些数据都放入日志文件中。关于如何抑制此输出的任何建议？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-30T15:37:32.383

另一种方法是覆盖子类的`__repr__`方法，`Item`以选择性地选择在管道末端打印哪些属性（如果有）：

```
from scrapy.item import Item, Field
class MyItem(Item):
    attr1 = Field()
    attr2 = Field()
    # ...
    attrN = Field()

    def __repr__(self):
        """only print out attr1 after exiting the Pipeline"""
        return repr({"attr1": self.attr1}) 
```

这样，您可以将日志级别保持在`DEBUG`并仅显示您希望从管道中看到的属性（`attr1`例如，检查）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-18T02:02:16.667

阅读了文档并通过源代码进行了（简要）搜索，我看不到实现这一目标的直接方法。

锤子的做法是将settings中的日志级别设置为INFO（即在settings.py中加入以下行）：

`LOG_LEVEL='INFO'`

这将删除有关正在抓取的 URL/页面的许多其他信息，但它肯定会抑制有关已处理项目的数据。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-01-03T02:37:45.130

我尝试了@dino 提到的**repre**方式，效果不好。但是从他的想法演变而来，我尝试了**str**方法，并且它有效。

这是我的做法，非常简单：

```
 def __str__(self):
        return "" 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-10-02T15:21:26.897

如果您只想排除输出的某些属性，您可以扩展@dino 给出的答案

```
from scrapy.item import Item, Field
import json

class MyItem(Item):
    attr1 = Field()
    attr2 = Field()
    attr1ToExclude = Field()
    attr2ToExclude = Field()
    # ...
    attrN = Field()

    def __repr__(self):
        r = {}
        for attr, value in self.__dict__['_values'].iteritems():
            if attr not in ['attr1ToExclude', 'attr2ToExclude']:
                r[attr] = value
        return json.dumps(r, sort_keys=True, indent=4, separators=(',', ': ')) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-12-18T08:56:09.580

如果您因为多年后遇到同样的问题而在这里找到了自己的方式，那么最简单的方法是使用[`LogFormatter`](https://docs.scrapy.org/en/latest/topics/logging.html#custom-log-formats)：

```
class QuietLogFormatter(scrapy.logformatter.LogFormatter):
    def scraped(self, item, response, spider):
        return (
            super().scraped(item, response, spider)
            if spider.settings.getbool("LOG_SCRAPED_ITEMS")
            else None
        ) 
```

只需添加`LOG_FORMATTER = "path.to.QuietLogFormatter"`到您的邮件中`settings.py`，您就会看到`DEBUG`除已抓取的项目之外的所有邮件。有了`LOG_SCRAPED_ITEMS = True`您可以恢复以前的行为，而无需更改您的`LOG_FORMATTER`.

同样，您可以自定义已爬网页面和已删除项目的日志记录行为。

*编辑*：我[在这个库中包装了](https://pypi.org/project/scrapy-extensions/)[这个格式化程序](https://gitlab.com/mshepherd/scrapy-extensions/-/blob/master/scrapy_extensions/loggers.py)和一些其他的 Scrapy 东西。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-01-18T06:29:59.797

或者如果您知道蜘蛛正常工作，那么您可以禁用整个日志记录

`LOG_ENABLED = False`

当我的爬虫运行良好时，我禁用它

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-11-20T19:24:55.990

我认为最干净的方法是向记录器添加一个过滤`scrapy.core.scraper`器来更改相关消息。这使您可以保持项目的`__repr__`完整，并且不必更改scrapy 的日志记录级别：

```
import re

class ItemMessageFilter(logging.Filter):
    def filter(self, record):
        # The message that logs the item actually has raw % operators in it,
        # which Scrapy presumably formats later on
        match = re.search(r'(Scraped from %\(src\)s)\n%\(item\)s', record.msg)
        if match:
            # Make the message everything but the item itself
            record.msg = match.group(1)
        # Don't actually want to filter out this record, so always return 1
        return 1

logging.getLogger('scrapy.core.scraper').addFilter(ItemMessageFilter()) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-01-30T00:26:00.883

我们在生产中使用以下示例：

```
import logging

logging.getLogger('scrapy.core.scraper').addFilter(
    lambda x: not x.getMessage().startswith('Scraped from')) 
```

这是一个非常简单且有效的代码。我们将此代码添加到`__init__.py`带有蜘蛛的模块中。在这种情况下，此代码会自动使用类似`scrapy crawl <spider_name>`所有蜘蛛的命令运行。

# ruby-on-rails - 未确认用户登录时重定向到某个页面而不是 :notice

> ID：14390947
> 
> 赞同：9
> 
> 时间：2013-01-18T01:06:43.723
> 
> 标签：ruby-on-rails, ruby, devise

如何将*未确认*的用户在登录时重定向到某个页面，而不是显示：通知（“您必须确认您的帐户”）。使用 Devise gem（最新）

这个问题：（[设计 - 如果帐户未确认，则重定向到页面](https://stackoverflow.com/questions/6208492/devise-redirected-to-page-if-account-isnt-confirmed)）提供了这个解决方案：

```
# config/initializers/my_strategy.rb
Warden::Strategies.add(:my_strategy) do 
  def valid? 
    true
  end 

  def authenticate! 
    u = User.find_for_authentication(:email => params[:email])
    if u.nil? || !u.valid_password?(params[:password])
      fail(:invalid)
    elsif !u.confirmed?
      fail!("Account needs confirmation.")
      redirect!("your_root_url")
    end
  else
    success!(u)
  end    
end

#config/initializers/devise.rb
config.warden do |manager|  
  manager.default_strategies(:scope => :user).unshift :my_strategy
end 
```

这是行不通的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T06:21:25.480

生成您自己的会话控制器来覆盖设计的默认会话控制器`rails g controller sessions`（此控制器的名称无关紧要，您可以有自己的选择）

编辑`config/routes.rb`

```
devise_for :users, :controllers => {:sessions => "sessions"} 
```

编辑`app/controllers/sessions_controller.rb`

```
class SessionsController < Devise::SessionsController
  def create
    @user = User.find_by_email(params[:user][:email])
    if !@user or @user.confirmed?
      super
    else
      redirect_to YOUR_DESIRED_path
    end
  end 
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T13:51:20.020

我有更好的运气在我的应用程序中覆盖 Devise 的控制器以进行微调，这通常是 Devise SessionsController。

举个例子：

```
class SessionsController < Devise::SessionsController

  def create
    #overriding Devise's create controller first
    super

    #check if current user is inactive
    @user = user_from_current_user
    unless @user.active?
      redirect("your_root_url")
    end
  end

end 
```

高温高压

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-22T12:36:17.917

**我在下面的示例中对其进行了修复，但我想知道是否可以在此方法中传递用户对象（ username ），以便我可以使用设计用户模型 user.username 或 user.login 重定向到 /confirm/ 。**

```
 config.warden do |manager|
    manager.failure_app = CustomFailure
  end

  class CustomFailure < Devise::FailureApp
    def redirect_url
        if warden_message == :unconfirmed
          "/confirm"
        else
          super
        end
      end 
```

# android - 从屏幕上消失后，如何在 Listview 行中保存更改后的 ImageView 的状态？

> ID：14390948
> 
> 赞同：0
> 
> 时间：2013-01-18T01:06:58.357
> 
> 标签：android, android-listview

我设计了一个带有列表视图的应用程序，我可以在其中更改列表项的颜色，这是应用程序屏幕的链接：

![图片](../Images/f216e65b5faf22b1e31a846118b99db2.png)

通过更改列表行左侧的图像来更改颜色。现在，当我在列表中向下滑动更改颜色时，颜色又回到原来的状态（意味着图像视图恢复到其原始来源）。

列表的数据取自 XML 文件，解析为散列映射，并使用扩展到列表中的适配器。我该如何解决这个问题？

正如我所看到的，因为列表视图重用了不在屏幕上的视图，所以当我回到屏幕外的已更改行然后又回来时，它会再次从哈希映射中提取其信息。所以我需要做的是在哈希映射中找到由适配器绑定到行布局的数据索引，并在那里更改关联的颜色，这样下次适配器重新创建该行时，它将被分配用正确的颜色。如何才能做到这一点？

这是此活动的 Java 代码：

```
public class SkyGiraffeAppActivity extends Activity implements AdapterView.OnItemClickListener, View.OnClickListener {
// All static variables
static final String TAG = "SkyGiraffeAppActivity";
// XML node keys
static final String KEY_TASK = "task"; // parent node
static final String KEY_ID = "id";
static final String KEY_TITLE = "title";
static final String KEY_DATE = "date";
static final String KEY_TIME = "time";
static final String KEY_PRIORITY  = "priority";
static final String KEY_USERPRIORITY = "userpriority";

View currentRow;
final ArrayList<HashMap<String, String>> menuItems = new ArrayList<HashMap<String, String>>();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);
    ListView list = new ListView(this);
    list.setDivider(null);
    list.setDividerHeight(0);

    setContentView(list);
    getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.taskstitle);

    Log.e(TAG, "Created Array");

    XMLParser parser = new XMLParser();

    Log.e(TAG, "Getting xml from raw folder");
    InputStream xml = getResources().openRawResource(R.raw.taskslists); // getting XML

    Log.e(TAG, "reading xml file to string");
    String sxml = parser.readTextFile(xml);

    Log.e(TAG, "creating dom element from string");
    Document doc = parser.getDomElement(sxml); // getting DOM element

    Log.e(TAG, "getting node list of all the elements");
    NodeList nodeList = doc.getElementsByTagName(KEY_TASK);

    Log.e(TAG, "looping through all the elements");
    for (int i = 0; i < nodeList.getLength(); i++) 
    {
        // creating new HashMap
        HashMap<String, String> map = new HashMap<String, String>();
        Element e = (Element) nodeList.item(i);
        Log.e(TAG, "element number: " + i + " added to hash map");
        // adding each child node to HashMap key => value
        map.put(KEY_ID, parser.getValue(e, KEY_ID));
        map.put(KEY_TITLE, parser.getValue(e, KEY_TITLE));
        map.put(KEY_DATE, parser.getValue(e, KEY_DATE));
        map.put(KEY_TIME, parser.getValue(e, KEY_TIME));
        map.put(KEY_PRIORITY, parser.getValue(e, KEY_PRIORITY));
        map.put(KEY_USERPRIORITY, parser.getValue(e, KEY_USERPRIORITY));

        // adding HashList to ArrayList
        menuItems.add(map);
    }

    // Adding menuItems to ListView
    ListAdapter adapter = new SimpleAdapter(this, menuItems, R.layout.row,
          new String[] { KEY_TITLE, KEY_DATE, KEY_TIME, KEY_PRIORITY, KEY_USERPRIORITY}, 
          new int[]    { R.id.text_title, R.id.text_date, R.id.text_time ,R.id.image_priority, R.id.bchangecolor}){

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            View row =  super.getView(position, convertView, parent);
            View left = row.findViewById(R.id.bchangecolor);
            left.setTag(position);
            left.setOnClickListener(SkyGiraffeAppActivity.this);
            View right = row.findViewById(R.id.barrow);
            right.setTag(position);
            right.setOnClickListener(SkyGiraffeAppActivity.this);

            ImageView prioriy = (ImageView) row.findViewById(R.id.image_priority);
            ImageView usercolor = (ImageView) row.findViewById(R.id.bchangecolor);

            String userpriority = menuItems.get(position).get(KEY_USERPRIORITY);   
            Log.e(TAG, "user priority color for this view was: " + userpriority);

            if (userpriority.contentEquals("green"))
            {
                usercolor.setImageResource(R.drawable.task_bg_left_green);
            }
            else if (userpriority.contentEquals("blue"))
            {
                usercolor.setImageResource(R.drawable.task_bg_left_blue);
            }
            else if (userpriority.contentEquals("yellow"))
            {
                usercolor.setImageResource(R.drawable.task_bg_left_yellow);
            }
            else if (userpriority.contentEquals("orange"))
            {
                usercolor.setImageResource(R.drawable.task_bg_left_orange);
            }
            else if (userpriority.contentEquals("red"))
            {
                usercolor.setImageResource(R.drawable.task_bg_left_red);
            }

            int number = Integer.valueOf(menuItems.get(position).get(KEY_PRIORITY));
            switch ( number )
            {
            case 1:
                prioriy.setImageResource(R.drawable.priority_first);
                break;
            case 2:
                prioriy.setImageResource(R.drawable.priority_second);
                break;
            case 3:
                prioriy.setImageResource(R.drawable.priority_third);
                break;
            case 4:
                prioriy.setImageResource(R.drawable.priority_fourth);
                break;
            case 5:
                prioriy.setImageResource(R.drawable.priority_fifth);
                break;
            default:
                prioriy.setImageResource(R.drawable.priority_first);
            }

            return row;
        }
    };

    list.setAdapter(adapter);
    list.setOnItemClickListener(this);  
}

public void onClick(View v) 
{
     Intent i = new Intent(this, TaskColorChangeActivity.class);
     i.putExtra("color", "choosecolor");

     switch(v.getId()) {
        case R.id.bchangecolor:
            Log.e(TAG, "pressed the color change button on" + v.getId());
            currentRow = v;
            startActivityForResult(i, 1);
            break;
        case R.id.barrow:
            Log.e(TAG, "pressed the arrow button on" + v.getId());
            i = createIntentwithExtra(v.getRootView());
            startActivity(i);
            break;
        default:
            break;
        }   
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub
    super.onActivityResult(requestCode, resultCode, data);

    if(data.getExtras().containsKey("chosencolor"))
    {
        ImageView imageView = (ImageView) currentRow.findViewById(R.id.bchangecolor);
        if (data.getStringExtra("chosencolor").contentEquals("blue"))
        {
            imageView.setImageResource(R.drawable.task_bg_left_blue);
            //menuItems.get(po)
        }
        else if (data.getStringExtra("chosencolor").contentEquals("green"))
        {
            imageView.setImageResource(R.drawable.task_bg_left_green);
        }
        else if (data.getStringExtra("chosencolor").contentEquals("yellow"))
        {
            imageView.setImageResource(R.drawable.task_bg_left_yellow);
        }
        else if (data.getStringExtra("chosencolor").contentEquals("orange"))
        {
            imageView.setImageResource(R.drawable.task_bg_left_orange);
        }
        else if (data.getStringExtra("chosencolor").contentEquals("red"))
        {
            imageView.setImageResource(R.drawable.task_bg_left_red);    
        } 
    }
}

public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
    Log.e(TAG, "pressed the row itself" + v.getId());
    Intent intent = createIntentwithExtra(v);
    startActivity(intent);  
}

public Intent createIntentwithExtra(View v)
{
    Intent intent = new Intent(getApplicationContext(), SingleMenuItemActivity.class);
    String title = ((TextView) v.findViewById(R.id.text_title)).getText().toString();
    String date = ((TextView) v.findViewById(R.id.text_date)).getText().toString();
    String time = ((TextView) v.findViewById(R.id.text_time)).getText().toString();
    intent.putExtra(KEY_TITLE, title);
    intent.putExtra(KEY_DATE, date);
    intent.putExtra(KEY_TIME, time);

    return intent;
}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:38:15.247

您应该重新使用已经创建的视图。像这样的事情：

```
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder = null;
    if(convertView == null){
        //CREATE NEW HOLDER
        holder = new ViewHolder();
        // Layout XML
        int layoutFile = R.layout.adapter_layout;
        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = inflater.inflate(layoutFile, null);
        convertView.setTag(holder);
        holder.tvName= (TextView)convertView.findViewById(R.id.tvName);

              /// SET DE VALUES TO THE VIEW HERE, INCLUDING THE
              /// ONCLICK TO THE VIEW
    Users u = arrayUser.get(position);

    holder.tvName.setText(u.getName());

    }
    else
        holder= (ViewHolder)convertView.getTag();
    return convertView;
}

static class ViewHolder{
    TextView tvName;
} 
```

# string - 如何在 Bash 脚本中回显“$x_$y”？

> ID：14390955
> 
> 赞同：16
> 
> 时间：2013-01-18T01:08:21.330
> 
> 标签：string, bash, shell

非常有趣的是，如果您打算`0_1`使用 Bash 显示代码

```
x=0
y=1
echo "$x_$y" 
```

那么它只会显示

```
1 
```

我试过`echo "$x\_$y"`了，它不起作用。

如何回显表单`$x_$y`？我将在文件名字符串上使用它。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-18T01:24:35.633

因为变量名中允许有下划线，所以命令：

```
echo "$x_$y" 
```

正在尝试回显`${x_}`（在您的情况下可能为空），然后是`${y}`. 这样做的原因是因为参数扩展是一个贪婪的操作——它会在 之后尽可能多的合法字符`$`来形成一个变量名。

手册页的相关部分`bash`指出：

> 该`$`字符引入了参数扩展、命令替换或算术扩展。
> 
> 要扩展的参数名称或符号可以用大括号括起来，这是可选的，但**用于保护要扩展的变量免受紧随其后的字符的影响，这些字符可以解释为名称的一部分。**
> 
> 当使用大括号时，匹配的结束大括号是第一个`}`不被反斜杠转义或在带引号的字符串中，并且不在嵌入的算术扩展、命令替换或参数扩展中。

因此，解决方案是确保`_`不*被*视为第一个变量的一部分，这可以通过以下方式完成：

```
echo "${x}_${y}" 
```

我倾向于像这样做我*所有*的 bash 变量，甚至像这样的独立变量：

```
echo "${x}" 
```

因为它更明确，而且我过去被咬过很多次:-)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-18T01:09:43.483

这边走：

```
$ echo "${x}_${y}"
0_1 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-18T01:09:51.700

用花括号括起来：

`echo "${x}_${y}"`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-18T01:38:39.817

只是为了逆势而上，你也可以这样做：

```
echo $x'_'$y 
```

您可以将引用和未引用的部分彼此相邻，中间没有空格。而且由于`'`不是变量名的合法字符，bash 将仅替换`$x`. :)

# asp.net-mvc - 在 getter 和 setter 中抛出异常

> ID：14390956
> 
> 赞同：1
> 
> 时间：2013-01-18T01:08:24.183
> 
> 标签：asp.net-mvc, asp.net-mvc-3, nullable, getter-setter, model-validation

我想知道在使用 getter 和 setter 时模型验证的最佳实践是什么。具体来说，我的模型中有可以为空的字段，在某些用例中，访问时不应有空值。在这些情况下，我想从 getter 中抛出一个异常，但这是一种公认​​的做法吗？

如果我在 setter 中收到无效的值，也可能是这种情况。

除了抛出异常之外，我还知道 MVC 属性可用于装饰字段，但并未将它们用于模型验证。在“此值在我的 getter 中不应为空”场景中，是否有我可以使用的适当属性？

此外，如果接受在 getter 和 setter 中抛出异常，是否有推荐的抛出异常，即 ValueNotValidException （如果那是真实的）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:22:02.563

您应该使用标准[数据验证属性](https://msdn.microsoft.com/en-us/library/dd901590(VS.95).aspx)来验证模型。如果该值是必需的 - 使用 [Required]。

[http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/adding-validation-to-the-model](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/adding-validation-to-the-model)

```
if (ModelState.IsValid)
{
   ...
} 
```

更少的代码维护和更高的可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:27:26.067

如果您打算将该对象用作 ViewModel，您可以使用`[NotNullValidator]`Microsoft 的[Enterprise Library](http://msdn.microsoft.com/en-us/library/ff648951.aspx)以及其他提供额外功能（如`Regex`验证、范围、类型等）的给定注释它，如此[处](http://msdn.microsoft.com/en-us/library/ff648951.aspx)`IgnoreNulls`所示。也可以使用此库创建自定义验证器，基于[此分步指南](http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/07/26/CustomValidatorApplicationBlockSoftwareFactory.aspx)，您可以使用它来注释您的 ViewModel。

否则，您将使用更传统的[MVC 数据注释属性](http://weblogs.asp.net/scottgu/archive/2010/01/15/asp-net-mvc-2-model-validation.aspx)，例如`[Required]`.

# javascript - 在 Firefox 上将光标设置到 textarea-setSelectionRange() 的末尾？

> ID：14390958
> 
> 赞同：1
> 
> 时间：2013-01-18T01:08:49.257
> 
> 标签：javascript, firefox

[我最初的问题是对这个问题](https://stackoverflow.com/questions/6003300/how-to-place-cursor-at-end-of-text-in-textarea-when-tabbed-into)的直接欺骗，试图将光标放在文本区域的末尾。

```
one
two
three|<-- ideal position 
```

它在除 Firefox 之外的所有浏览器上都运行良好（我目前使用的是 18.0 版）。即使 Tim 在上面的链接中提供的 jsfiddle（为方便起见：http: [//jsfiddle.net/DqtVK/40/](http://jsfiddle.net/DqtVK/40/)）也不起作用。

似乎它根本不再突出显示或放置光标。

我知道 jquery 是一个替代选项（如在[此处](https://stackoverflow.com/questions/13425363/jquery-set-textarea-cursor-to-end-of-text)找到）但是在 Firefox 方面发生了什么使这种方法不再可靠的事情吗？任何人有任何见解？有没有办法避免 jquery 路由？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T23:41:01.443

看起来有一个未捕获的异常阻止我的代码完成。看来 Firefox 真的不喜欢关注隐藏的 HTML 片段。吸取教训，确保你的目标是可见的！

虽然为什么 jsfiddle 不能正常工作对我来说仍然是一个谜......但我的基本问题已经解决了。

如果有人能解释 jsfiddle 的奥秘，请继续回复，我会留意的。

# java - 如果 Date 大部分被弃用并且我们要使用 Calendar，那么 DateFormat 类的等价物是什么？

> ID：14390967
> 
> 赞同：1
> 
> 时间：2013-01-18T01:10:01.760
> 
> 标签：java, date, date-format

我是 Java 的新手，如果 Date （大部分？）被弃用，我有点不清楚如何编写自己的 DateFormat 子类。

1.  我应该使用日期还是日历？
2.  如果 Calendar 全面，什么类取代 DateFormat？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:14:59.630

首先`java.text.DateFormat class`不**推荐使用**，您使用`java.util.Date`类作为**桥梁**来使用类格式化`java.util.Calendar`对象`java.text.DateFormat`。

```
java.text.DateFormat---> use this class to format dates.
java.util.Calendar  ---> use this class to perform date related operations. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T01:21:50.660

1.  `Date`表示特定的毫秒时间。换句话说，`Date`是一个长毫秒值的包装器。`Calendar`用于获取 a 的星期、月份等的特定日期`Date`。

2.  使用`DateFormat`. 您可以使用`getDate`a 的方法将对象`Calendar`传递给。`Date``DateFormat`

此外，您可能会发现 Joda 时间很有用。

# c# - TCPClient 流异常？

> ID：14390970
> 
> 赞同：3
> 
> 时间：2013-01-18T01:10:12.340
> 
> 标签：c#, tcpclient

我有一个 TCPClient，它创建了一个我在 DataAvailable 时读取的流。

每 20 秒 !DataAvailable 我使用 ACK 消息 ping 套接字以防止流关闭。

但我似乎得到了喜忧参半的结果。似乎每隔一次我打开流（基本上重新启动我的服务）我都会遇到传输错误。

这是我的 Connect 函数的简化版本：

```
client = new StreamClient();
client.Connect(new IPEndPoint(clientAddress, senderPort));
stream = client.GetStream();
bool status = SendMessage(seq, sync, MessageTypes.Init); 
```

SendMessage 函数执行以下操作：

```
if (stream == null) return false;
stream.Write(TransmitBuffer, 0, TransmitMessageLength); 
```

我的关闭功能：

```
if (stream != null)
{
    SendMessage(seq, sync, MessageTypes.Finish);
    stream.Close();
}
stream = null;

client.Close();
client = null; 
```

由于套接字的性质，预计 SendMessage 调用偶尔会失败。

但有时，一旦我连接，一切运行正常，没有失败的消息。但其他时候 ACK 会失败。当 ACK 失败时，我调用 Close，这将强制进行 Connect 并验证套接字的另一端是否打开。如果那失败了，那么我知道结束了。但有时该调用不会失败，然后 20 秒后 ACK 会失败。

谁能给我一个意见，为什么会发生这种情况？等待 20 秒是否太长？我没有正确关闭插座的末端吗？

我正在处理的具体错误消息是：

```
Unable to write data to the transport connection: An established connection was aborted by the software in your host machine. 
```

它发生在`stream.Write(TransmitBuffer, 0, TransmitMessageLength);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T16:13:06.033

一般来说，将协议放在 TCP 之上是一个很大的错误。它只会使连接*不那么*可靠。TCP 已经非常有力地保证从一台机器发送的数据将被网络上的另一台机器接收。只有非常恶劣的外部环境才能使这种情况失败。诸如设备断电或计划外重启之类的事情。

除非其中一台机器故意关闭套接字，否则不应断开*连接*。当然，这应该始终以可预测的方式完成。事务的逻辑结束或机器正在签署的显式消息。

除了“阻止流关闭”之外，您没有给出将这个“ACK 协议”添加到连接逻辑的任何动机。我认为您在这里看到的是它不起作用，实际上并没有阻止流关闭。所以它仍然像在添加协议层之前那样出错，您仍然会遇到意外的“已建立的连接被中止”异常。

您如何*降低*可靠性的一个示例是您添加的 20 秒超时检查。TCP 不使用 20 秒超时。它使用指数退避算法来检查超时。通常它不会放弃，直到至少 45 秒过去了。因此，您将在TCP 执行此操作*之前声明连接已失效。*

很难就如何推进这一点提供建议。但显然不是通过添加协议，您尝试过它并没有奏效。您将不得不找出连接意外中断的原因。不幸的是，这确实需要大量的工作，您必须深入了解位于您的机器和服务器之间的网络设备和软件。有些人认为问题出在电线的另一端，因为那是最难诊断的地方。让网站的网络管理员参与您的问题是重要的第一步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T17:17:38.237

我在您的实现中看到的主要让我印象深刻的是，您似乎将 Stream 视为连接，但事实并非如此。您对 Stream 实例的检查应该改为对 TcpClient 实例的检查。我不确定这是否是您问题的根源，但它对我来说确实很奇怪。

而不是这个：

```
stream = client.GetStream();
if (stream != null)
{
    SendMessage(seq, sync, MessageTypes.Finish);
    stream.Close();
}
stream = null; 
```

我通常会做更多这样的事情：

```
if (client != null)
{
    if (client.Connected)
    {
        client.GetStream().Close();
    }

    client.Close();
    client = null;
} 
```

您应该在使用流之前检查 TcpClient.Connected，而不是流本身。
我要提到的另一件事是确保始终使用异步方法来连接、读取和写入 TcpClient。同步的更容易，但我的经验是依赖它们会给你带来麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T15:24:06.597

[我们在开发网络通信库](http://www.networkcomms.net)时遇到了类似的问题。我们发现最可靠的解决方案是发送一些空数据（也就是保持活动状态），而不是使用 ACK。在这种情况下 byte[1] 具有零值。这将导致：

1.  发送成功，接收端可以忽略数据。
2.  发送失败，将立即导致连接关闭并重新建立。

这些结果中的任何一个都确保了连接始终处于可用状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-26T07:24:20.477

为什么要发送 ACK？您应该发送 SYN。

而且你不应该发送 ACK、SYN、RST 或为此设置任何其他标志。您正在涉足 TCP 内部。您正在创建应用程序级协议，并且保持活动是其中的一部分，原因，iirc，即使有[http://msdn.microsoft.com/en-us/library/windows/desktop/ee470551%28v=vs.85 %29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ee470551%28v=vs.85%29.aspx)连接将一直打开，直到您关闭它。

# common-lisp - 在 FreeBSD 上配置错误

> ID：14390971
> 
> 赞同：0
> 
> 时间：2013-01-18T01:10:21.153
> 
> 标签：common-lisp, ecl

我 git clone 最新的 ECL 并执行以下操作：

```
$./configure --prefix=/home/***/ecl
...
configure: error: Oops, mp_limb_t is 32 bits, but the assembler code
in this configuration expects 64 bits.
You appear to have set $CFLAGS, perhaps you also need to tell GMP the
intended ABI, see "ABI and ISA" in the manual.
configure: error: Failed to configure the GMP library.

$ls -l /usr/local/lib/libgmp*
-rw-r--r--  1 root  wheel  790194  9 11 14:04 /usr/local/lib/libgmp.a
-rwxr-xr-x  1 root  wheel     907  9 11 14:04 /usr/local/lib/libgmp.la*
lrwxr-xr-x  1 root  wheel      12  9 11 14:04 /usr/local/lib/libgmp.so@ -> libgmp.so.10
-rwxr-xr-x  1 root  wheel  434419  9 11 14:04 /usr/local/lib/libgmp.so.10*
-rw-r--r--  1 root  wheel   29292  9 11 14:04 /usr/local/lib/libgmpxx.a
-rwxr-xr-x  1 root  wheel     943  9 11 14:04 /usr/local/lib/libgmpxx.la*
lrwxr-xr-x  1 root  wheel      13  9 11 14:04 /usr/local/lib/libgmpxx.so@ -> libgmpxx.so 
```

.6
-rwxr-xr-x 1 根轮 21092 9 11 14:04 /usr/local/lib/libgmpxx.so.6*

问候 ！

# symfony - 通过 Composer 更新时不是 git 存储库错误

> ID：14390972
> 
> 赞同：3
> 
> 时间：2013-01-18T01:10:26.927
> 
> 标签：symfony, symfony-2.1, composer-php

我正在尝试使用 composer 将我的 Symfony 2 项目从 2.1.4 更新到 2.1.7 并`php composer.phar update`正常运行，在更新了一些依赖项后，我收到以下错误：

```
[RuntimeException]
Failed to clone http://github.com/fabpot/Twig-extensions via git, https
and http protocols, aborting.

- git://github.com/fabpot/Twig-extensions
  fatal: Not a git repository (or any of the parent directories): .git

- https://github.com/fabpot/Twig-extensions
  fatal: Not a git repository (or any of the parent directories): .git

- http://github.com/fabpot/Twig-extensions
  fatal: Not a git repository (or any of the parent directories): .git 
```

我检查了 URL 并可以确认它存在，我也可以`git clone`在同一个 CLI 中没有任何问题。

奇怪的是，如果我`php composer.phar update twig/extensions`单独运行它似乎可以毫无问题地更新。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-18T08:28:36.060

这通常发生在你有一个旧的 symfony 副本，它与供应商一起安装为 git repos 但删除了 git repos。要修复它，您应该只删除供应商目录，以便它们从头开始重新安装为 git 克隆或 zip 存档，但没有任何先前的假设。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-24T14:41:46.717

请注意，目前，我在使用 hhvm 和 PHP 7 时遇到了类似`composer`的**问题**。

```
[RuntimeException]
Failed to execute git checkout 'hash' -- && git reset --hard 'hash' --
fatal: Not a git repository (or any of the parent directories): .git 
```

错误的出现取决于`composer.json`并非总是如此，而是经常出现。我关闭**hhvm**以使其正常工作。

# java - 为什么 Android Handler 用 int 参数化？

> ID：14390977
> 
> 赞同：2
> 
> 时间：2013-01-18T01:11:25.737
> 
> 标签：java, android, handler

我`android.os.Handler`对Android中的机制感到非常困惑。为什么[消息处理](http://developer.android.com/reference/android/os/Handler.html#hasMessages%28int%29)使用`int`对消息类型进行编码？在阅读了 Effective Java 之后，我学会了偏爱 Enum 而不是`int`这些类型，我觉得如何在这里继续进行非常不安全。

我想使用状态模式，定义来自 Handler 的子类的不同状态类，以处理来自视图的不同消息。

```
public class ReadyState extends Handler {

     @Override
     public void handleMessage(Message msg, int what) {
          // ...      
     }
} 
```

我是否必须使用 对我的状态进行编码`int`，是否可以使用`Enum`with 字段：

```
enum Action {
    START(0), STOP(1), BACKFLIP(2);

    int code;
    public Action(int code) { this.code = code }
} 
```

有替代方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T01:17:42.407

> 为什么消息处理使用 int 来编码消息的类型？

它需要一个 int 作为参数，因为库的作者不能把*你的*枚举放在那里，他们甚至不知道它叫什么！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T01:17:58.553

如果您想将`what`参数映射到枚举，那就是要走的路。

将其设为 int 意味着您可以将参数用作位集或简单代码或实际数据或其他任何内容。

# html - 如何在页面顶部保留导航栏？

> ID：14390979
> 
> 赞同：13
> 
> 时间：2013-01-18T01:11:33.287
> 
> 标签：html, css, navigation, fixed

我正在尝试让我的导航栏保持在页面顶部，就像在[forbes.com上一样](http://www.forbes.com)

我知道我能做到

```
nav
{
   position: fixed;
   top: 0;
} 
```

但是导航栏不在页面顶部，它位于徽标之后...但是，当您向下滚动时，我希望导航栏粘在屏幕顶部..

[这是我的网站](http://fusedigital.eu)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-25T17:28:45.597

解决方案很简单，在添加 px 的同时保留你的 css

```
nav
{
   position: fixed;
   top: 0px;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-01T06:01:21.657

您可以像这样在 JQuery 中尝试：

HTML：

```
<div id="wrapper">

    <header>
        <h1>Floater Navigation</h1>
    </header>

    <nav>
        <p>Navigation Content</p>
    </nav>

    <div id="content">
            <p>Lorem Ipsum.</p>
    </div>
</div> 
```

CSS：

```
#wrapper {
    width:940px;
    margin: 0 auto;
}

header {
    text-align:center;
    padding:70px 0;
}

nav {
    background: #000000;
    height: 60px;
    width: 960px;
    margin-left: -10px;
    line-height:50px;
    position: relative;
}

#content {
    background: #fff;
    height: 1500px; /* presetting the height */
    box-shadow: 0 0 5px rgba(0,0,0,0.3);
}

.fixed {
    position:fixed;
} 
```

查询：

```
$(document).ready(function() {

    // Calculate the height of <header>
    // Use outerHeight() instead of height() if have padding
    var aboveHeight = $('header').outerHeight();

    // when scroll
    $(window).scroll(function(){

        // if scrolled down more than the header’s height
        if ($(window).scrollTop() > aboveHeight){

            // if yes, add “fixed” class to the <nav>
            // add padding top to the #content 
            // (value is same as the height of the nav)
            $('nav').addClass('fixed').css('top','0').next().css('padding-top','60px');

        } else {

            // when scroll up or less than aboveHeight,
            // remove the “fixed” class, and the padding-top
            $('nav').removeClass('fixed').next().css('padding-top','0');
        }
    });
}); 
```

来源：[http ://www.jay-han.com/2011/11/10/simple-smart-sticky-navigation-bar-with-jquery/](http://www.jay-han.com/2011/11/10/simple-smart-sticky-navigation-bar-with-jquery/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-27T16:03:01.417

You can use:

```
nav
{
   position: fixed;
   top: 0;
   left: 0;
} 
```

See this complete example example:

```
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: sans-serif;
}

#header {
    width: 100%;
    height: 90vh;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 60px 12px;
}

header nav {
    width: 100%;
    height: 10vh;
    background-color: #262534;
    display: grid;
    align-items: center;
    border-bottom: 4px solid #F9690E;
    position: fixed;
    top: 0;
    left: 0;
}

header .nav-item {
    display: inline;
    margin: 0 8px;
}

header .nav-item:first-of-type {
    margin-left: 48px;
}

header .nav-item a {
    color: white;
    text-decoration: none;
    font-size: 16px;
}

header .nav-item a:hover {
    text-decoration: underline;
}

header #more-drop-down-menu a:last-of-type:hover {
    text-decoration: none;
}

header .nav-item a.active {
    text-decoration: underline;
    color: #F9690E;
}

/** menu**/
menu{
  margin-top:14vh;
  text-align: center;
}
menu p{
  font-size: 14px;
  line-height:125%;
  padding: 25px;
}
```

```
<header>

        <!-- Start Nav -->
        <nav>
            <ul>
                <li class="nav-item"><a href="#Home" class="active">Home</a></li>
                <li class="nav-item"><a href="#About">About</a></li>
                <li class="nav-item"><a href="#Contact">Contact</a></li>
                <!-- END Drop Down Menu -->

            </ul>
        </nav>
        <!-- End Nav -->   
    </header>
 <menu>
 <h1> Example of fixed nav</h1>
     <p>
         Lorem ipsum dolor sit amet, consectetur adipisicing elit. Cumque exercitationem ipsa quisquam sunt ex blanditiis iure vero molestias impedit recusandae eius quasi unde assumenda molestiae, dolorem illum, aliquid aut neque?
         Error aut voluptatum molestias ad quidem odio labore eaque veniam fugiat earum, aliquid incidunt beatae nam pariatur minus voluptates atque suscipit cupiditate et! Tenetur eveniet delectus aspernatur? Perferendis, modi similique.
         Debitis eaque suscipit tenetur, laboriosam perferendis possimus voluptas expedita labore aspernatur. Nobis cum vel quae voluptates pariatur architecto quas labore assumenda ipsam sint tenetur, nisi in non alias quisquam atque.
         Animi, exercitationem ullam laudantium dolores praesentium distinctio illo, fugiat iusto soluta quibusdam eius? Quaerat reiciendis voluptatum voluptatibus porro saepe blanditiis nam iure odio soluta, cum ipsam, suscipit molestiae natus eius!
         Quasi, quae harum? Fuga facere facilis, cumque veniam voluptatum itaque aspernatur natus ratione nesciunt dolores qui, iste ullam dolorem totam accusantium officiis nisi hic esse reiciendis molestias. Unde, inventore fugiat?
         Corrupti similique consequatur provident aliquam voluptates minima modi voluptatibus exercitationem magni, consectetur delectus? Rerum quo cumque dolorem voluptatibus tempora, nesciunt laboriosam eum assumenda deserunt error ullam asperiores velit suscipit corrupti!
         Perspiciatis architecto illo quis dolore necessitatibus ad accusantium voluptatem esse ducimus! Modi facilis consequuntur mollitia asperiores praesentium. Tempora vero quod aliquam, alias quis, nisi cumque totam sed odit, hic suscipit.
         Aut molestias minus accusantium, cumque, aspernatur quia aliquam accusamus nostrum saepe, eius vero velit. Labore a deserunt voluptate illo, eum eos, ad saepe, eius temporibus quis eaque ea reiciendis soluta!
     </p>
 </menu>
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-21T17:15:02.843

这就是导航栏在滚动过去后粘在顶部的方式。

```
.affix {
	top: 0px;
	margin: 0px 20px;
}
.affix + .container {
	padding: 5px;
}
```

```
<nav class="navbar navbar-default" data-spy="affix" data-offset-top="50">
...
</nav>
```

“navbar”会自行创建一个块，因此您只需在 css 文件中提及边距 `.navbar { margin: 0px auto; /*You can set your own margin for top-bottom & right-left respectively*/ z-index: 1; }` z-index 将优先级设置为该特定元素，以便其他元素不会滚动它。如果 z-index 具有正值，则它具有最高优先级，否则具有最低优先级（对于负值）。我希望这是有帮助的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-07T21:26:08.057

这是一种不使用 JQuery 的方法。它的工作原理是为窗口设置一个滚动侦听器，并在滚动到达正确位置时切换导航栏的类。

```
var body = document.getElementsByTagName("body")[0];
var navigation = document.getElementById("navigation");

window.addEventListener("scroll", function(evt) {
  if (body.scrollTop > navigation.getBoundingClientRect().bottom) {
    // when the scroll's y is bigger than the nav's y set class to fixednav
    navigation.className = "fixednav"
  } else { // Overwise set the class to staticnav
    navigation.className = "staticnav"
  }
});
```

```
h1 {
  margin: 0;
  padding: 10px;
}
body {
  margin: 0px;
  background-color: white;
}
p {
  margin: 10px;
}
.fixednav {
  position: fixed;
  top: 0;
  left: 0;
}
.staticnav {
  position: static;
}
#navigation {
  background-color: blue;
  padding: 10px;
  width: 100%;
}
#navigation a {
  padding: 10px;
  color: white;
  text-decoration: none;
}
```

```
<h1>
Hello world
</h1>
<nav id="navigation" class="staticnav"><a href="#">Home</a>  <a href="#">About</a>
</nav>
<!-- We initialize the nav with static condition -->
<p>
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
  Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.
</p>
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-13T17:27:33.380

```
nav {
    position: sticky;
    top: 0;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-01-18T02:55:55.013

使用绝对位置并将顶部值设置为您希望导航栏从浏览器顶部开始的像素数。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-04-25T19:33:30.033

在您的 css 文件中：

```
body {
    padding-top: 0px;
} 
```

# utf-8 - 扩展字符集 chars 无法识别并转换为 ? 标记

> ID：14390980
> 
> 赞同：0
> 
> 时间：2013-01-18T01:11:33.893
> 
> 标签：utf-8, latin1

我有一个包含一些特殊字符的字符串，例如“\u2012”，即图形破折号。当我试图在控制台上打印这个时，我得到一个“？” 标记而不是其符号。我有一个编辑器，我可以在其中使用 alt+numpad 插入符号，例如 alt+2012。在编辑器中，我可以看到符号将其保存在 xml 文件中并使用 nodevalue 获取值，我得到一个“？” 标记。
总结一下，我面临阅读扩展拉丁字符集的问题。我需要的是当我插入这些符号并阅读它时，我应该得到类似 &#xXXXX; 的东西。请帮忙！

蒂亚:)

只是我有一个 String inpath = "À";，我想得到它的 unicode 值..like &#xXXXX;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T05:46:52.450

Windows 中的默认控制台编码是一些 MS-DOS 代码页，它们不支持该字符。您可以在运行程序之前尝试运行`chcp 65001`，但您可能还需要更改控制台字体。

只要您使用 UTF-8，您就不需要对任何其他字符做任何您不会做的事情。你在很多地方都没有这样做。您需要在代码中明确写入以 UTF-8 保存和读取文件，而不是依赖平台默认编码。

# html - 将多个元素向右和底部浮动

> ID：14390983
> 
> 赞同：2
> 
> 时间：2013-01-18T01:11:44.347
> 
> 标签：html, css, position

一旦它是多个元素，一个简单的

```
position:absolute;
bottom:0; 
```

无济于事，因为它会覆盖多个元素

这是我尝试的一个小提琴：http: [//jsfiddle.net/7uYUP/](http://jsfiddle.net/7uYUP/) （这是我想要向右和底部浮动的 .interaction 元素，现在它们只能向右浮动）

我希望不必求助于JS ..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:17:38.927

问题是绿色和黄色框之间的高度不同（10pt 与 40pt）。您可以通过以下方式进行调整`margin-top`：

```
.interaction{
   height:40pt;
   width:100pt;
   background-color:yellow;
   float:right;
   border: 1pt solid blue;
   margin-top:-32pt;
} 
```

[http://jsfiddle.net/7uYUP/2/](http://jsfiddle.net/7uYUP/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T03:54:02.007

```
<body>

<div id="container"><div>

    <div class="interaction leftalign">
    </div>

    <div class="interaction">
    </div>  

</div></div>  

</body>  

 body{
      background-color:red;
    }

    #container{
     position:absolute;
      height:10pt;
      width:100%;
      background-color:green;
     bottom:0;
    } 

    #container > div {
      position:relative;
      height:100%;
    }  

    .interaction{
    height:40pt;
    width:100pt;
    background-color:yellow;
    float:right;
    border: 1pt solid blue;
    }  

    .interaction.leftalign {
      float:left;
    } 
```

# python - 当我尝试运行 Travis-CI 测试时，为什么我的模块无法导入？

> ID：14390984
> 
> 赞同：2
> 
> 时间：2013-01-18T01:11:56.500
> 
> 标签：python, travis-ci

我正在尝试在我制作的模块上运行 Travis-CI。Nosetests 在我的本地机器上以优异的成绩通过，但由于某种原因，该`test.py`文件无法导入我的项目。以下是 Travis-CI 的完整输出：

```
Using worker: ppp3.worker.travis-ci.org:php-4

$ cd ~/builds
$ git clone --branch=master --depth=100 --quiet git://github.com/louist87/Scrappy.git louist87/Scrappy
$ cd louist87/Scrappy
$ git checkout -qf 68d1291c8a81638554d036aa01215632a6661623
$ source ~/virtualenv/python2.7/bin/activate
$ python --version
Python 2.7.3
$ pip --version
pip 1.2.1 from /home/travis/virtualenv/python2.7/lib/python2.7/site-packages/pip-1.2.1-py2.7.egg (python 2.7)
$ pip install -r requirements.txt --use-mirrors
Downloading/unpacking guessit>=0.5.2 (from -r requirements.txt (line 1))
  Downloading guessit-0.5.3.tar.gz (45kB): 45kB downloaded
  Running setup.py egg_info for package guessit

Downloading/unpacking tvdb-api>=1.8.2 (from -r requirements.txt (line 2))
  Downloading tvdb_api-1.8.2.tar.gz
  Running setup.py egg_info for package tvdb-api

Downloading/unpacking hachoir-metadata>=1.3.3 (from -r requirements.txt (line 3))
  Downloading hachoir-metadata-1.3.3.tar.gz (52kB): 52kB downloaded
  Running setup.py egg_info for package hachoir-metadata
    Warning: unable to recompile dialog.ui to dialog_ui.py using pyuic4
    (use command "-c egg_info --egg-base pip-egg-info --disable-qt" to disable this warning)

Downloading/unpacking hachoir-core>=1.3.3 (from -r requirements.txt (line 4))
  Downloading hachoir-core-1.3.3.tar.gz (91kB): 91kB downloaded
  Running setup.py egg_info for package hachoir-core

Downloading/unpacking hachoir-parser>=1.3.4 (from -r requirements.txt (line 5))
  Downloading hachoir-parser-1.3.4.tar.gz (359kB): 359kB downloaded
  Running setup.py egg_info for package hachoir-parser

    warning: no files found matching 'metadata_csv.py'
Installing collected packages: guessit, tvdb-api, hachoir-metadata, hachoir-core, hachoir-parser
  Running setup.py install for guessit

  Running setup.py install for tvdb-api

  Running setup.py install for hachoir-metadata
    Warning: unable to recompile dialog.ui to dialog_ui.py using pyuic4
    (use command "-c install --record /tmp/pip-Xc_ilb-record/install-record.txt --single-version-externally-managed --install-headers /home/travis/virtualenv/python2.7/include/site/python2.7 --disable-qt" to disable this warning)

    changing mode of build/scripts-2.7/hachoir-metadata from 664 to 775
    changing mode of build/scripts-2.7/hachoir-metadata-gtk from 664 to 775
    changing mode of build/scripts-2.7/hachoir-metadata-qt from 664 to 775
    deleting hachoir_metadata.egg-info/requires.txt

    changing mode of /home/travis/virtualenv/python2.7/bin/hachoir-metadata-qt to 775
    changing mode of /home/travis/virtualenv/python2.7/bin/hachoir-metadata to 775
    changing mode of /home/travis/virtualenv/python2.7/bin/hachoir-metadata-gtk to 775
  Running setup.py install for hachoir-core

  Running setup.py install for hachoir-parser
    deleting hachoir_parser.egg-info/requires.txt

    warning: no files found matching 'metadata_csv.py'
Successfully installed guessit tvdb-api hachoir-metadata hachoir-core hachoir-parser
Cleaning up...
$ nosetests -w tests/
E
======================================================================
ERROR: Failure: ImportError (No module named scrappy.core)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/travis/virtualenv/python2.7/local/lib/python2.7/site-packages/nose/loader.py", line 390, in loadTestsFromName
    addr.filename, addr.module)
  File "/home/travis/virtualenv/python2.7/local/lib/python2.7/site-packages/nose/importer.py", line 39, in importFromPath
    return self.importFromDir(dir_path, fqname)
  File "/home/travis/virtualenv/python2.7/local/lib/python2.7/site-packages/nose/importer.py", line 86, in importFromDir
    mod = load_module(part_fqname, fh, filename, desc)
  File "/home/travis/builds/louist87/Scrappy/tests/test.py", line 8, in <module>
    import scrappy.core as scrappy
ImportError: No module named scrappy.core

----------------------------------------------------------------------
Ran 1 test in 0.004s

FAILED (errors=1)

Done. Build script exited with: 1 
```

请注意，这`Scrappy`是我的项目的名称，这就是导入失败的原因。

这是我的`.travis.yml`文件：

```
language: python
python:
  - "2.7"
install: "pip install -r requirements.txt --use-mirrors"
script: "nosetests -w tests/" 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T15:37:35.023

`develop`好的，事实证明 Travis-CI在安装目标包时并没有隐式执行。

`script`通过将 YAML 文件中的行编辑为：

```
script:  "python setup.py develop && nosetests -w tests/" 
```

# eclipse - 是否有不使用 Spring 的 MVC/JPA 教程？

> ID：14390994
> 
> 赞同：0
> 
> 时间：2013-01-18T01:12:55.030
> 
> 标签：eclipse, jsp, servlets, jpa, spring-mvc

这是我在这里的第一篇文章。我正在寻找一些使用 JPA 和 MVC 的 Web 应用程序的示例或教程。到目前为止，我发现的所有教程和示例都与 Spring 相关。我是使用 JPA/MVC 的新手，我发现有点难以理解 Spring 的工作原理。谁能推荐我一个没有 Spring 的好教程或一个简单的例子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T02:01:18.713

观看易于理解的视频：[http ://m.youtube.com/user/koushks?gl=US&hl=en&client=mv-google](http://m.youtube.com/user/koushks?gl=US&hl=en&client=mv-google)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T02:25:33.453

对于它的价值，我[通过这本书](https://rads.stackoverflow.com/amzn/click/com/1590594118)“点击”了这个概念。现在有点过时了，但基本保持不变。除此之外，如果您搜索“ [java servlets basic mvc tutorial](https://www.google.com/search?q=java%20servlets%20basic%20mvc%20tutorial&aq=f&oq=java%20servlets%20basic%20mvc%20tutorial&aqs=chrome.0.57j0.13917&sourceid=chrome&ie=UTF-8) ”之类的内容，您也可以找到一堆简单的教程和演示文稿。

# php - 如何在 MySQL 中将分数存储为字符，以便可以在文本中输出

> ID：14390995
> 
> 赞同：-1
> 
> 时间：2013-01-18T01:13:02.707
> 
> 标签：php, mysql, phpmyadmin, character, fractions

我试图将分数 3/5（五分之三）存储为 MySQL 中的一个字符，以便它在 php 中输出，就像一行文本中的符号 ½。我正在使用 phpMyAdmin。

分数 3/5 的代码是：

*   角色名称 - VULGAR FRACTION 3/5
*   字符 - ⅗</li>
*   实体 -
*   数量实体 -`&#8535;`
*   十六进制实体 -`&#x2157;`

有没有办法做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:17:25.730

这里有一个很长的答案[来](https://stackoverflow.com/questions/279170/utf-8-all-the-way-through)解释你需要什么。基本上，您需要确保所有表都使用 utf-8 编码。这将需要一些调试。

# javascript - 为什么这段代码在 setTimeout 中调用但在它之外调用时有效？

> ID：14390998
> 
> 赞同：3
> 
> 时间：2013-01-18T01:13:08.457
> 
> 标签：javascript, settimeout

我有一个 eventHandler，每次将节点插入到 contenteditable div 时都会触发它。此 eventHandler 将新插入的替换`div node`为`p node`.

问题是在替换后放置光标。基本上光标没有正确放置，也就是说，光标在预期放置在新创建的 p 节点中时消失了。奇怪的是，内容可编辑 div 仍然具有焦点，并且转储`window.selection`对象显示正确设置的范围。

我可以解决此问题的唯一方法是使用 setTimeout 进行脏修复。

* * *

**问：为什么使用 setTimeout 调用 placeCursor() 但不使用它时它会起作用？**

* * *

## 相关代码：

[JSFiddle](http://jsfiddle.net/tivie/kmkcJ/)

```
obj.addEventListener("DOMNodeInserted", onNodeInsert, false);

function onNodeInsert(e) {
    var range    = document.createRange(),
        sel      = window.getSelection(),
        newNode  = e.target,
        tagName  = newNode.tagName.toLowerCase(),
        lnbrNode = document.createElement('br'),
        pNode    = document.createElement('p');

    if (tagName === 'div' && newNode.getAttribute("id") === null) {
        // First we remove the event listener so that it doesn't get triggered again
        this.removeEventListener('DOMNodeInserted', onNodeInsert, false);

        // Creates a p node and removes the div
        newNode.parentNode.replaceChild(pNode, newNode);
        pNode.appendChild(lnbrNode);

        // Places the caret where it belongs
        var placeCursor = function () {
            range.setStart(pNode, 0);
            sel.removeAllRanges();
            sel.addRange(range);    
        }

        //placeCursor(); // DOES NOT WORK (cursor disappears)
        setTimeout(placeCursor,1); // WORKS

        //We can restore the event listener now
        this.addEventListener("DOMNodeInserted", onNodeInsert, false);
    }
} 
```

有关更多上下文，请参阅[此帖子](https://stackoverflow.com/questions/14347462/set-caret-position-in-contenteditable-div)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:25:41.407

我不知道如何做一个很好的解释，但是是因为 DOM 持久化延迟。我有很多手机问题。所以当监听器回调被执行时，dom 还没有准备好。

所以它不起作用，因为您正在尝试管理选择。如果您设置了超时，该函数将在 4 毫秒后执行，因此有足够的时间 DOM 将您的更改与范围保持一致并进行您尝试做的更改。

实际上，浏览器不应该需要延迟函数的执行才能工作，理论上你的代码没有`setTimeout`.

只是为了你知道。在我的桌面浏览器中，它可以正常工作，但是，当我在上网本中运行它时，我需要使用 setTimout 才能工作。