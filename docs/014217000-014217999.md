# StackOverflow 问答 14217000-14217999

# r - 程序运行后定位错误

> ID：14217000
> 
> 赞同：3
> 
> 时间：2013-01-08T14:22:31.213
> 
> 标签：r, error-handling

我使用的代码计算语法错误并在程序运行后报告语法错误的数量。错误计数代码是在 stackoverflow 上提供的，以响应我之前的问题：[R：是否有一个用于说明是否发生任何错误的文件末尾的命令？](https://stackoverflow.com/questions/9337406/r-is-there-a-command-for-the-end-of-a-file-that-states-whether-any-errors-occur)

有时我在分析大型数据集时忘记注释打印消息，而 R 无法打印所有数据和所有代码。

```
 [ reached getOption("max.print") -- omitted 498 rows ] 
```

当发生这种情况并且错误计数代码报告错误时，我不能简单地向上滚动以查看错误是什么。有没有办法在 R 代码运行后定位错误？我尝试使用`traceback()`但没有帮助。我从未使用过`traceback()`，也许我没有正确使用它。我在网上找到的其他潜在解决方案似乎需要在运行 R 文件之前插入代码。

我可以用注释掉的 print 命令重新运行 R 代码，但在这种情况下，代码需要几个小时才能运行。也许我可以使用较小的数据集快速重新运行代码以找到错误，但这假设数据集的大小不会以某种方式导致错误。

这是一个包含错误的示例程序。如果`n`更改为一个大数字，可能是 10000000，此代码似乎会创建相同的场景或类似于我上面描述的场景。谢谢你的任何建议。

我通常通过将代码保存在 *.r 文件中来运行我的代码，然后复制该文件的内容并将其粘贴到安装 R 应用程序期间放置在我的戴尔 PC 64 位 Windows 7 Professional 桌面上的默认 R GUI 中。

```
# the four lines below are for counting syntax errors

.error.count <- 0
old.error.fun <- getOption("error")
new.error.fun <- quote(.error.count <- .error.count + 1)
options(error = new.error.fun, width=2400)

##########################################################

n <- 10

a <- rnorm(n,10,4)
b <- rnorm(n,50,8)
c <- EXP(b)
d <- a + b

df <- data.frame(a,b,d)
df

##########################################################

# the three lines below count the number of errors in the code above

cat("ERROR COUNT:", .error.count, "\n")
options(error = old.error.fun)
rm(.error.count, old.error.fun, new.error.fun)

##########################################################

traceback()

# No traceback available 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:04:36.227

这是一个仅在交互模式下有效的选项，AFAICT。

修改您的序言以将错误消息写入错误日志变量：

```
.error.log <- NULL
old.error.fun <- getOption("error")

new.error.fun <- quote({
  .error.count <- .error.count + 1
  .error.log <- c(.error.log, geterrmessage())
}) 
```

然后运行您的代码和`cat()`错误日志的值：

```
cat("ERROR COUNT:", .error.count, "\n")
cat("ERROR LOG:", .error.log, collapse="\n") 
```

结果：

```
> cat("ERROR COUNT:", .error.count, "\n")
ERROR COUNT: 1 
> cat("ERROR LOG:", .error.log, collapse="\n")
ERROR LOG: Error: could not find function "EXP" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:58:06.883

这是一种稍微不同的方法，它使用该`local`函数创建一个包含日志的错误记录器。

```
error.logger <- local({
    error.log <- list() # initial empty log
    function () {
        # each time called, add to the log
        error.log <<- c(error.log, geterrmessage()) 
    }
})

options(error=error.logger, show.error.locations=TRUE) 
```

这与 Andrie 的方法基本相同，但避免了全局变量`.error.log`。您可以使用 访问日志`get('error.log', environment(error.logger))`。`show.error.locations=TRUE`将在您的错误消息中包含源代码行号。

无论您处于交互模式还是批处理模式，这都有效。

# c# - LINQ - 无法将类型“AnonymousType#1”隐式转换为“字符串”

> ID：14217002
> 
> 赞同：0
> 
> 时间：2013-01-08T14:22:35.320
> 
> 标签：c#, linq

我有下面的代码，我需要用一个 if 语句来修改它，以说明如果某些东西会导致这个，或者让它那个。这是我现在拥有的：

```
 var result = (from fs in ctx.datFiles
                      where fs.File_ID == fID
                      select new
                      {
                          LastName = fs.datClaim.LastName,
                          FirstName = fs.datClaim.FirstName,
                      }).FirstOrDefault();

    DetailsModelView dmv = new DetailsModelView
    {
        ClaimID = result.ClaimID,
        LastName = result.LastName,
        FirstName = result.FirstName,

    }; 
```

我想做类似的事情：

```
var result =""

if (something)
{
result = (from fs in ctx.datFiles
                          where fs.File_ID == fID
                          select new
                          {
                              LastName = fs.datClaim.LastName,
                              FirstName = fs.datClaim.FirstName,
                          }).FirstOrDefault();

}
else
{
result = (from fs in ctx.datFiles
                          where fs.File_ID == 5
                          select new
                          {
                              LastName = fs.datClaim.LastName,
                              FirstName = fs.datClaim.FirstName,
                          }).FirstOrDefault();
}

        DetailsModelView dmv = new DetailsModelView
        {
            ClaimID = result.ClaimID,
            LastName = result.LastName,
            FirstName = result.FirstName,

        }; 
```

但我不断收到以下错误：当我尝试在 LINQ 语句之外创建“结果”时，无法将类型“AnonymousType#1”隐式转换为“字符串”。

我需要什么来声明结果以使其工作，而不是字符串？

这只是一个简单的例子，我的查询在“else”上变得更加复杂，然后只是 ID 更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T14:30:52.643

这是一个有效的功能程序：

```
var foo = new {LastName = "", FirstName=""};;

int bar = 1;

if (bar==1)
{
    foo = new {LastName = "test1", FirstName="test2"};
}
else
{
    foo = new {LastName = "test3", FirstName="test4"};
} 
```

如您所见，我创建了一个虚拟匿名对象，以便`var foo`知道要制作什么对象。这显然应该与您在 if 语句的两个分支中创建的匿名对象相同。

还应该注意的是，在上面的代码中，似乎没有任何理由不`DetailsModelView`直接在 linq 中使用而不是匿名类型。这可能是您的用例更复杂，但由于有一个简单的一对一映射，您可以创建您`DetailsModelView`当前创建匿名方法的位置。那么 result 可以定义为 being `DetailsModelView`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:25:06.243

在`var result =""`结果已经是字符串之后。

关于什么：

```
int id;
if(something)
{
    id = fID;
}
else
{
    id = 5;
}

var result = (from fs in ctx.datFiles
                          where fs.File_ID == id
                          select new
                          {
                              LastName = fs.datClaim.LastName,
                              FirstName = fs.datClaim.FirstName,
                          }).FirstOrDefault(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:37:30.377

正如其他人所说，`var result = "";`当`string result = "";`您尝试将其值设置为您的 linq 结果时，它会尝试将其转换为字符串。

根据实际代码的设计方式，您可以使用 FirstName、LastName 属性声明一个简单类型，而不是返回匿名类型。同样，如果您总是要使用 LINQ 调用的结果创建 DetailsModelView 的实例，则可以将结果变量声明为`DetailsModelView result = null;`并且在您的代码中返回 DetailsModelView 而不是匿名类型。最后，您只需要在 DetailsViewModel（如果有）中指定额外的属性，而不是实例化一个新属性。

```
DetailsViewModel result = null;

if (something)
  result = ;// LINQ Query
else
  result = ;// LINQ Query 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T14:29:44.970

您根本不需要 Linq 投影。

编辑 - 但正如 Servy 指出的那样，如果这是一个 ORM 调用，你可能确实想要它，这意味着需要投影。

`FirstOrDefault`此外，如果返回 null，您的代码将引发 null ref 异常。

```
int searchId = fId;

if(something)
    searchId = fId;
else
    searchId = 5;

var result = ctx.datFiles.FirstOrDefault(fs => fs.File_ID == searchId)
               .Select(fs=> new 
                 {
                   Id = fs.datClaim.Id,
                   LastName = fs.datClaim.LastName,
                   FirstName = fs.datClaim.FirstName,
                 });

if(result == null)
    throw new Exception(); // if there is no result your code will throw!

DetailsModelView dmv = new DetailsModelView
{
    ClaimID = result.Id,
    LastName = result.LastName,
    FirstName = result.FirstName,
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T14:39:54.013

这是一篇文章，告诉您如何转换为匿名类型： [http ://tomasp.net/blog/cannot-return-anonymous-type-from-method.aspx](http://tomasp.net/blog/cannot-return-anonymous-type-from-method.aspx)

C# 中匿名类型的特性之一是，如果它们包含相同的数据，则该类型将被重用，以便您稍后可以引用它——在这种情况下，您可以对其进行强制转换。

我不确定这对你来说是不是最好的解决方案，但它应该可以工作。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-08T14:26:09.787

更改`var result = "";`为

```
var result = new
{
    LastName = "",
    FirstName = "",
}; 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-01-08T14:40:20.800

改变

```
var result = ""; 
```

到

```
var result; 
```

确保在 LINQ 语句之外创建它时将其转换为

```
DetailsModelView 
```

# php - 将透明图像放在非透明图像上

> ID：14217010
> 
> 赞同：0
> 
> 时间：2013-01-08T14:23:07.710
> 
> 标签：php

我将上传的图像 ($image) 裁剪为固定大小。

```
$new = imagecreatetruecolor($width, $height);
imagealphablending($new, false);
imagesavealpha($new, true);
imagecopyresampled($new, $image, 0, 0, $x, $y, $width, $height, $width, $height); 
```

我读到 imagealphablending 和 imagesavealpha 应该这样设置。$image 不透明。

```
$cover = imagecreatefrompng('../img/magazine2.png');
imagealphablending($cover, false);
imagesavealpha($cover, true); 
```

是应该放在顶部的图像，我读到它应该具有这些设置。$new 和 $cover 现在的大小完全相同。

然后我将 $cover 复制到 $new 上，应该显示因为 $cover 是透明的

```
imagecopy($new, $cover, 0, 0, 0, 0, $width, $height); 
```

但是它放在 $new 上没有透明度，缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:49:56.890

唯一需要做的是：

```
imagealphablending($new, true); 
```

不

```
imagealphablending($new, false);
imagesavealpha($new, true); 
```

或者

```
imagealphablending($cover, false);
imagesavealpha($cover, true); 
```

# html - How can I position a DIV in another DIV so the space above the DIV and below it is equal?

> ID：14217015
> 
> 赞同：1
> 
> 时间：2013-01-08T14:23:16.397
> 
> 标签：html, css

I have the following HTML:

```
<div id="outer">
    <div class="content left"></div>
    <div class="content right">
       <div class="fill">
           <div class="blue">
             xxx <br> xxx
           </div> 
    </div>
</div> 
```

CSS:

```
 body, html { height: 100%; }
#outer { position:absolute; margin:5%; bottom:0; top:0; left:0; right:0; overflow:hidden; }
.content { position:absolute; width:50%; height:100%; }
.content.left { background-color:yellow; }
.content.right { background-color:red; left:50%; }
.fill { padding: 2em; background-color: green; height: 100%;}
.blue { background-color: blue; } 
```

[Fiddle](http://jsfiddle.net/M8gy5/)

How can I make it so the space above and below the blue DIV is the same height?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:33:30.747

The following should work for you:

```
.blue { 
  position:absolute;
  top:50%;
  background-color: blue;
} 
```

Here is a good reference for vertically aligning content [Link](http://phrogz.net/css/vertical-align/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:37:15.027

你问这个是因为你没有看到你所期望的，还是因为你不知道如何编程？我问这个是因为你忘了关闭“填充”DIV。

如果这不是您的问题，请尝试将位置分配给绝对。

```
.blue{
    position: absolute;
    background-color: blue;
    padding: 10px;
} 
```

# c++ - 仅头文件库循环依赖

> ID：14217022
> 
> 赞同：0
> 
> 时间：2013-01-08T14:23:38.547
> 
> 标签：c++, circular-dependency, raii

我正在尝试围绕外部 C API 创建一个仅限标头的 C++ 库。C API 使用`void *`指针作为句柄。这是想法：

```
// resource.hpp
class Resource {
public:
    // RAII constructor, destructor, etc.
    // ...
    void do_something(const Handle & h) {
        do_something_impl( (void *) h);
    }
};

// handle.hpp
class Handle
{
public:
    Handle(size_t n, const Resource & res)
        : p_(res.allocate(n)), res_(res) {}

    // cast operation
    operator void *() const { return p_; }

private:
    void * p_;
    Resource & res_;
}; 
```

这里的问题是 (a) Handle 必须保留对 Resource 的引用，并且 (b) Resource 需要能够将 Handle 转换为 void *。不幸的是，这导致了循环依赖。

关于如何**重组**它的任何想法？

注意：答案不是简单地“包含 xxx.hpp”或前向声明其中一个类。这需要以某种方式重组，我只是不太明白如何。

将 a`class Handle`作为前向声明添加到 Resource 文件的顶部不起作用，因为强制转换`(void *)`是 Resource 仍然无法看到的 Handle 定义的一部分。同样，将强制转换更改为`void * ptr()`成员函数会导致相同的问题。

将函数定义移动到 .cpp 文件也不是答案——它必须是仅标题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T14:00:35.043

好吧，这是救援的模板（再次！）：

```
// resource.hpp
class Resource;
template<typename TResource> class Handle;

class Resource {
public:
    // RAII constructor, destructor, etc.
    // ...
    void do_something(const Handle<Resource> & h) {
        do_something_impl( (void *) h);
    }
};

// handle.hpp
template<class TResource>
class Handle {
public:
    Handle(size_t n, const TResource & res)
        : p_(res.allocate(n)), res_(res) {}

    // cast operation
    operator void *() const { return p_; }

private:
    void * p_;
    TResource & res_;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:26:47.577

不要将头文件相互包含，而是对类进行*前向声明*。这样它们就可以用作引用或指针。

所以在resource.hpp中：

```
class Handle;

class Resource {
public:
    // RAII constructor, destructor, etc.
    // ...
    void do_something(const Handle & h) {
        do_something_impl( (void *) h);
    }
}; 
```

在handle.hpp中：

```
class Resource;

class Handle
{
public:
    Handle(size_t n, const Resource & res)
        : p_(res.allocate(n)), res_(res) {}

    // cast operation
    operator void *() const { return p_; }

private:
    void * p_;
    Resource & res_;
}; 
```

* * *

由于您`void*`在函数内部使用了类型转换运算符`do_something`，因此您必须将该实现移动到单独的源文件中。在该源文件中，您可以包含两个头文件，因此可以访问所有函数。

# iis-7.5 - 作为反向代理的托管 Fusion

> ID：14217023
> 
> 赞同：0
> 
> 时间：2013-01-08T14:23:39.163
> 
> 标签：iis-7.5, reverse-proxy, managedfusion

我正在尝试（但失败）设置反向代理。

我试过了：

*   [微软特有的方式。](http://blogs.msdn.com/b/carlosag/archive/2010/04/02/setting-up-a-reverse-proxy-using-iis-url-rewrite-and-arr.aspx)
    *   重定向有效，但 URL 重写无效（客户端在 URL 中看不到任何更改，但请求由另一个网站处理）。
*   [使用 IIRF。](http://iirf.codeplex.com/)
    *   这适用于测试机器，[但 IIRF 安装在生产中失败。](http://iirf.codeplex.com/workitem/32479)
*   [管理融合。](http://urlrewriter.codeplex.com/)

    *   我已经正确配置了这个（我相信）：

    > RewriteEngine On
    > RewriteRule ^/ping/(.*) [http://my.proxy.com/](http://my.proxy.com/) $1 [P,NC]
    > RewriteLog "managed-fusion-log.txt"
    > RewriteLogLevel 9

    我相信这可行，因为我在日志文件中看到了这一点：

> 2013-01-08T13:49:41 ***** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** * * *** ** *****
> 2013-01-08T13:49:41 [重写] 输入：[http](http://swisscom-live.emusetech.com:81/ping/somecall.svc)
> ://swisscom-live.emusetech.com:81/ping/ somecall.svc 2013-01-08T13:49:41 [规则 0 ] 输入：/ping/somecall.svc
> 2013-01-08T13:49:41 [规则 0] 规则模式匹配
> 2013-01-08T13:49:41 [规则 0] 输出：[http ://my.proxy.com/ somecall.svc](http://my.proxy.com/somecall.svc)
> 2013-01-08T13:49:41 [重写] 代理： http: [//my.proxy.com/somecall.svc](http://my.proxy.com/somecall.svc)
> 2013-01-08T13:49:41 ***** ** *** ** *** ** *** ** *** * * *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *****

但是，实际的网络浏览器向我显示来自“本地”机器的 404 错误。日志说它正在做正确的事情，但我无法弄清楚为什么它实际上没有这样做！

* * *

指点赞赏！（在 Managed Fusion 或任何其他项目上）。

* * *

**更新：** 我终于设法让微软特有的方式工作。诀窍（我缺少的）是我需要创建一个单独的空 Web 应用程序，并且只在这个新应用程序上创建反向代理。

我怀疑我试图添加它的其他应用程序有一些覆盖配置，这些配置阻止了 URL 重写工作（但仍然允许重定向）。

不过，仍然对有关 Managed Fusion 问题的任何评论感兴趣！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-13T13:26:20.093

使用托管融合作为代理时遇到相同的问题 (404)。

显然，除了安装 nuget 包时未自动添加的模块之外，还有一个**处理程序要注册。**

网络配置：

```
<system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <modules runAllManagedModulesForAllRequests="true">
      <add name="RewriterModule" type="ManagedFusion.Rewriter.RewriterModule, ManagedFusion.Rewriter" preCondition="" />
    </modules>
    <handlers>
      <add name="RewriterProxyHandler" preCondition="integratedMode" verb="*" path="RewriterProxy.axd" type="System.Web.HttpForbiddenHandler, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
    </handlers>
</system.webServer> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T01:32:54.833

当我将上述解决方案移至生产机器时，它无法用于包含`.svc`. 事实证明，另一个问题的 [this answer][5] 有解决方案。

这最终将其添加到反向代理的 web.config 中：

```
<system.web>
 <compilation targetFramework="4.0">
  <buildProviders>
   <remove extension=".svc" />            
  </buildProviders>
 </compilation>
</system.web> 
```

这样对远程服务器的服务调用实际上是进行的，而不是在本地解释。

这也解决了托管融合问题！:-)

# xml - 想从 xml 中替换“with”

> ID：14217025
> 
> 赞同：-1
> 
> 时间：2013-01-08T14:23:48.447
> 
> 标签：xml, xslt-1.0

嗨，我已将 CDATA 应用于 xml 中的节点部分，所有`<`和`>`都被替换为`&lt;`and `&gt;`。我想另外`"`替换`&quot;`。

我需要对 CDATA 部分进行哪些更改以`"`替换`&quot;`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T02:23:41.433

你没有说清楚你在做什么，所以很难简单地回答。

*如果*你的意思是

*   您在要提供给 XSLT 样式表的 XML 文档中添加了 CDATA 标记部分；
*   与输入中的 CDATA 部分相对应的样式表输出部分具有对实体的引用，`lt`并且`gt`输入具有尖括号（因此`<p class="greeting">Hello, world</p>`变为`&lt;p class="greeting"&gt;Hello, world!&lt;/p&gt;`，这就是您想要的；和
*   您希望 " 也不会出现在输出中，而是由对实体的引用替换`quot`

*那么*实现目标的一种方法是编写一个模板来处理文本节点，该模板测试“是否存在”，将文本节点拆分为第一个“的左侧和右侧”，写出左侧部分，写出一个＆符号，写出`quot;`，然后使用字符串的正确部分递归调用自身。

以下样式表说明了该模式：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                version="1.0">

  <xsl:template match="doc">
    <xsl:element name="doc">
      <xsl:apply-templates/>
    </xsl:element>
  </xsl:template>

  <xsl:template match="text()" name="escape-quot">
    <xsl:param name="s" select="."/>
    <xsl:choose>
      <xsl:when test="contains($s,'&quot;')">
        <xsl:variable name="sL" 
          select="substring-before($s,'&quot;')"/>
        <xsl:variable name="sR" 
          select="substring-after($s,'&quot;')"/>
        <xsl:value-of select="$sL"/>
        <xsl:text>&amp;quot;</xsl:text>
        <xsl:call-template name="escape-quot">
          <xsl:with-param name="s" select="$sR"/>
        </xsl:call-template>
      </xsl:when>
      <xsl:otherwise>
        <xsl:value-of select="$s"/>
      </xsl:otherwise>
    </xsl:choose>    
  </xsl:template>
</xsl:stylesheet> 
```

我们可以将其应用于以下输入以查看结果：

```
<doc>Hi. This is a test.
<![CDATA[<p class="greeting">Hello, 
world!</p>]]>
</doc> 
```

我得到的结果是，我猜想，你在找什么。

```
<?xml version="1.0"?>
<doc><p>Hi. This is a test.</p>
<p>&lt;p class=&amp;quot;greeting&amp;quot;&gt;Hello, 
world!&lt;/p&gt;</p>
</doc> 
```

如果这不是您想要的，您可以尝试更详细地解释您的问题。在这种情况下，提供（a）当前代码的关键位，（b）示例输入，（c）您当前获得的输出示例，并描述它的问题总是一个好主意, 和 (d) 您希望输出看起来像的样本。（保持示例和代码简短——您希望提供尽可能最小的完整工作示例，以便读者可以重现您的问题。）

# delphi - 如何在 Win7/8 中默认使系统托盘图标更明显

> ID：14217029
> 
> 赞同：2
> 
> 时间：2013-01-08T14:23:57.757
> 
> 标签：delphi, winapi

如何让系统托盘图标在 Win7/8 中更显眼？（非隐藏）

好像“SPEAKER”等一些图标默认是不隐藏的，怎么办？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-08T14:25:15.130

您无法选择是否隐藏通知图标。这取决于用户。这是设计使然。另一方面，MS 确实会强制他们的一些通知图标最初是可见的。

Raymond Chen 在这里讨论这个问题：[没有防止通知图标被隐藏的界面](http://blogs.msdn.com/b/oldnewthing/archive/2010/12/15/10105142.aspx)

> 首先，我要祝贺你编写了宇宙历史上最棒的程序。
> 
> 不幸的是，Windows 7 并没有为你的精彩做好准备，因为没有办法阻止你的通知图标被隐藏。那是因为如果有，那么所有其他程序（那些不如你棒的程序）都会使用它，从而导致你的棒图标在所有不棒的图标中丢失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T18:33:52.660

在 Windows 7 及更高版本中，您不能强制图标出现在主任务栏上。[这在文档](http://msdn.microsoft.com/en-us/library/ee330740%28v=vs.85%29.aspx)中明确说明：

> 在 Windows 7 上将图标添加到通知区域时，默认会添加到通知区域的溢出部分。此区域包含处于活动状态但在通知区域中不可见的通知区域图标。只有用户可以将图标从溢出中提升到通知区域，尽管在某些情况下系统可以将图标临时提升到通知区域作为短预览（不到一分钟）。
> 
> 注意 用户应该对他们希望在通知区域中看到哪些图标拥有最终决定权。在通知区域中安装非瞬态图标之前，应征求用户的许可。还应该为他们提供从通知区域中删除图标的选项（通常通过其快捷菜单）。

# node.js - node.js 和 websocket 模块聊天不返回数据

> ID：14217032
> 
> 赞同：1
> 
> 时间：2013-01-08T14:24:11.207
> 
> 标签：node.js, websocket

我正在为一个简单的聊天应用程序使用以下代码[https://gist.github.com/2031681 。](https://gist.github.com/2031681)

我跑`node chat-server.js`得到

```
Tue Jan 08 2013 15:45:52 GMT+0200 (IST) Server is listening on port 1337 
```

我尝试通过访问它`http://localhost:1337/chat.html`并获得以下信息

```
No data received
Error 324 (net::ERR_EMPTY_RESPONSE): The server closed the connection without sending any data. 
```

我是 node.js 的新手，我不知道这个问题可能来自哪里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T07:19:33.150

I have also tried this tutorial and faced the same problem. But i have found issues and fixed it.

You have to run chat.html as a file by simply double clicking the file you dont need to access it via localhost. Also change

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script> 
```

to

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script> 
```

it will work. If you want it to be accessible on other computers on your network put it in wamp/www folder or htdocs folder in xampp and change the following line in frontend.js file:

```
var connection = new WebSocket('ws://127.0.0.1:1337'); 
```

into

```
var connection = new WebSocket('ws://your_pc_ip:1337'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T13:50:31.457

搜索了几个小时可能会出现非常类似的问题时，突然我们发现带有我们的 API 和 Web 服务的服务器已关闭。该应用程序在本地主机上运行，​​但对服务器的 API 调用不返回任何内容哈哈 :(

# jquery - 使用 JQuery / AJAX 在 WordPress 中显示 XML 内容

> ID：14217042
> 
> 赞同：0
> 
> 时间：2013-01-08T14:24:53.047
> 
> 标签：jquery, ajax, wordpress, xml-parsing

我一直在使用以下脚本的变体从日历的 XML 提要中提取事件信息并将其显示在 html 页面中：

```
$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "../../../evanced/lib/eventsxml.asp?dm=exml&nd=14&fe=1&alltime=1",
        dataType: "xml",
        success: xmlParserFeatured,
        error: function(){alert("We're sorry. Something didn't load correctly.");}
    });
});
function xmlParserFeatured(xml) {
    $(xml).find("item").each(function () {
        var xml_image           = $(this).find('imagepath').text();
        var xml_imagetext       = $(this).find('imagetext').text();
        var xml_title           = $(this).find('title').text();
        var xml_date            = $(this).find('date').text();
        var xml_time            = $(this).find('time').text();
        var xml_endtime         = $(this).find('endtime').text();
        var xml_location        = $(this).find('location').text();
        var xml_link            = $(this).find('link').text();
        var xml_description     = $(this).find('description').text();
        var xml_signup          = $(this).find('signup').text();
        var xml_eventtype           = $(this).find('prieventtype').text();
        var hasImage            = xml_image != "" && xml_image != "";
        var hasDate             = xml_date != "";
        var noEndTime           = xml_time != "" && xml_endtime == "";
        var hasEndTime          = xml_time != "" && xml_endtime != "";
        var hasLink             = xml_link != "";
        var hasDescription      = xml_description != "";
        var hasLocation         = xml_location != "";
        var hasSignUp           = xml_signup == "1";
        var eventType           = xml_eventtype == "Outreach" || xml_eventtype == "Teen" || xml_eventtype == "Youth";
        var content = ((eventType) ? "<div class='article " + xml_eventtype + "'>" : "<div class='article Adult'>") +
            ((hasImage) ? "<img class='article' src='" + xml_image + "' alt='" + xml_imagetext + "' />" : "")
            + "<p class='article_heading'>" + ((hasLink) ? "<a href='" + xml_link + "'>" + xml_title + "</a></p>" : "<p class='article_heading'>" + xml_title + "</p>") 
            + "<p class='article_subheading'>" + xml_date + ((hasEndTime) ?  " from " + xml_time + " to " + xml_endtime : "") + ((noEndTime) ? " at " + xml_time : "") + ((hasLocation) ? "<br />Location: " + xml_location + "</p>" : "") 
            + ((hasDescription) ? "<p>" + xml_description + "</p>" : "") 
            + ((hasSignUp) ? "<p><a href='" + xml_link + "'>Register Online</a>.</p>" : "") 
            + "<div style='clear: both; height: 1px;'></div></div>";
        $(".event_list").append(content);
});} 
```

我们正在将我们的网站迁移到 WordPress，但我无法让它在任何 WP 页面上运行。我的问题是 a.）这是否可以在 WordPress 中工作和 b.）是否有另一种/不同/更好的方法可以在 WordPress 中获得相同的结果？我在网上找到的大部分内容都讨论了将 XML 提要导入为博客文章，这不是我想要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:56:20.357

首先，您是否尝试过 XSL 将您的 XML 转换为 HTML？

无论如何，它是一个 JavaScript 解决方案，因此它与服务器端的 Wordpress 无关。

1) 你确定由 Wordpress 创建的 HTML 文档至少有一个带有 'event_list' 类的元素吗？那似乎不是标准的 WP 类，也许你忘记了。

2) 您是否在搬家时更改了您网站的域名？1 个域提供的 JavaScript 有时无法向其他域发送请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T01:00:36.917

最终放弃了这一点，转而采用更简单的解决方案。决定只使用需要填充的节点并使用 php 解决方案。

```
<?php
$url = "/evanced/lib/eventsxml.asp?dm=exml&nd=7&fe=1&alltime=1";
$xml = simplexml_load_file($url);

foreach($xml->item as$item)
    {
        echo "<div class='main-cal-event main-cal-event-".$item->prieventtype."'>";
        echo "<p><span class='event-title'><a href='".$item->link."'>".$item->title."</a></span><br />";
        echo "<span class='event-date'>".$item->date." from ".$item->time." to ".$item->endtime."</span><br />";
        echo "<span class='event-desc'>".$item->description."</span></p>";
        echo "<div class='fix'></div>";
        echo "</div>";
    }
?> 
```

# java - SimpleDateFormat 解析为日期

> ID：14217044
> 
> 赞同：0
> 
> 时间：2013-01-08T14:24:56.367
> 
> 标签：java, date

我在课堂测试中有字段：

```
private Date date; 
```

主要代码：

```
SimpleDateFormat sdf = new SimpleDateFormat("dd.MM.yyyy");
Date now = new Date();
Test test = new Test();
test.setDate(sdf.parse(now.toString())); 
```

但我有错误：

```
java.text.ParseException: Unparseable date: "Tue Jan 08 14:10:23 GMT 2013"
    at java.text.DateFormat.parse(Unknown Source) 
```

我如何将今天的日期解析为 sava

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-08T14:28:01.513

`now.toString()`不是将日期表示为字符串的好方法，因为它使用“默认”格式。要将日期表示为字符串，可以使用以下`format(Date date)`方法`SimpleDateFormat`：

```
SimpleDateFormat sdf = new SimpleDateFormat("dd.MM.yyyy");
Date now = new Date();

String dateAsString = sdf.format(date); //"08.01.2013"
Date dateFromString = sdf.parse(dateAsString); 
```

# javascript - 试图让我的形象淡出工作

> ID：14217046
> 
> 赞同：1
> 
> 时间：2013-01-08T14:25:01.060
> 
> 标签：javascript

```
var fade = 1;

function fadeit() {
    if (fade < 4500) 
        fade++
    else 
        fade = 1
    setTimeout("fadeit()", 100)
}

function fader() {
    fadeit()
    if (fade < 3500) 
        document.getElementById("showone").style.opacity = "0.4";
    else if (fade < 500) 
        document.getElementById("showone").style.opacity = "0.1";
    else 
        document.getElementById("showone").style.opacity = "1.0";
} 
```

我试图让这段代码工作，以便它会在不同时间淡化图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:29:56.860

我会使用 JQuery 来实现，而不是编写自己的 JavaScript（它可能不是跨平台的）

看看Jquery中的`fadeIn()`and函数`fadeOut()`

[http://api.jquery.com/fadeIn/](http://api.jquery.com/fadeIn/)

[http://api.jquery.com/fadeOut/](http://api.jquery.com/fadeOut/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:32:02.413

我认为 `setTimout("fadeit()", 100)` 应该是 `setTimeout("fader()", 100)`。否则`fader`永远不会被调用...

你可能想在某个时候停止褪色。按照你的方式，它会一直消失，然后在计数器达到 4500 时重新启动。做这样的事情来防止循环，直到你`fadeit`再次专门调用：

```
function fadeit() {
    if (fade < 4500) {
        fade++
        setTimeout("fader()", 100)
    }
    else 
        fade = 1
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:32:18.837

您实际上需要在每次调用`fadeit`. 你所做的只是增加计数。另外，你的逻辑`if...else if...else`是错误的。每当第二个条件为真时，第一个条件总是为真，因此永远不会采用第二个分支。我在这里重写了它：

```
var fade = 1;

function fadeit() {
    if (fade < 4500) {
        fade++
    } else {
        fade = 1
    }
    doFade();
    setTimeout(fadeit, 100)
}

function fader() {
    fadeit()
}

function doFade() {
    if (fade < 500) 
        document.getElementById("showone").style.opacity = "0.1";
    else if (fade < 3500) 
        document.getElementById("showone").style.opacity = "0.4";
    else 
        document.getElementById("showone").style.opacity = "1.0";
} 
```

请注意，这将不断循环淡入（这是您的原始代码试图做的）。如果您想淡入一次并完成它，您可以将其重写为：

```
var fade = 1;

function fadeit() {
    if (fade < 4500) {
        fade++
        doFade();
        setTimeout(fadeit, 100)
    }
}

function fader() {
    fade = 1;
    fadeit()
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T14:32:14.837

您在循环中调用了错误的方法...更改

```
setTimout("fadeit()", 100) 
```

到

```
setTimeout("fader()", 100) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T14:33:23.843

```
var fade=1

function fader()
{
if (fade<4500) { fade++; }
else { fade=1; }
var op=1;
if (fade < 3500) { op=0.4; }
else if (fade < 500){ op=0.1; }
document.getElementById("showone").style.opacity=op;
//this is a loop i don't know if is the correct behaviour
setTimeout("fader()",100);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-08T14:40:25.497

我认为，如果您要使用纯 javascript 方法，则可能必须考虑 IE 问题等。

这篇文章更好地描述了' [javascript fade](http://www.lateralcode.com/javascript-fade-effect/) '。

```
function fade( elem, time )
{
  var startOpacity = elem.style.opacity || 1;
  elem.style.opacity = startOpacity;

  (function go() {
    elem.style.opacity -= startOpacity / ( time / 100 );

    // for IE
    elem.style.filter = 'alpha(opacity=' + elem.style.opacity * 100 + ')';

    if( elem.style.opacity > 0 )
        setTimeout( go, 100 );
    else
        elem.style.display = 'none';
   })();
} 
```

这是一个例子：http: [//jsfiddle.net/HCzJj/](http://jsfiddle.net/HCzJj/)

# arrays - 随机数组程序吞噬我的记忆

> ID：14217050
> 
> 赞同：-1
> 
> 时间：2013-01-08T14:25:13.600
> 
> 标签：arrays, perl, random

我想编写一个 perl 程序来生成长度为 8 的非重复单个数字（数字 1-8 以随机顺序排列）和第九个元素为下划线的数组。我写过这样的代码。我想将此生成的数组用于基于数字的益智游戏。

```
@mat = (0,0,0,0,0,0,0,0,0);

sub randgen { 

    $randigit = int(rand(9));

    if ($randigit == 0) {  
        &randgen;   
    }

    elsif (    $mat[0] == $randigit
            || $mat[1] == $randigit
            || $mat[2] == $randigit
            || $mat[3] == $randigit
            || $mat[4] == $randigit
            || $mat[5] == $randigit
            || $mat[6] == $randigit
            || $mat[7] == $randigit
            || $mat[8] == $randigit
          )
    {
        &randgen;
    }
}

&randgen;

for ( $assign = 0; $assign <= 8; $assign++) {

    $mat[$assign] = $randigit;
    print "@mat \n"; # To see to what extent the program has generated the array
    &randgen;
}

for ($i = 0; $i <= $#mat; $i++) {   

    $sum = $sum + $mat[$i];
}

$miss = 36 - $sum ;
$mat[7] = $miss;
$mat[8] = "_";
print "@mat \n"; 
```

程序分配第 7 个元素后，我的程序开始消耗内存（10 GB）。我不明白这是为什么。我使用数学逻辑来找到丢失的数字（数字总和 - 36 (n(n+1)/2)）。为什么要吃掉我的记忆？还是有任何有效的方法来编写相同的程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T14:43:02.620

**有没有编写相同程序的有效方法？**

你打赌。您只需要几行代码：

```
use List::Util 'shuffle';       # import shuffle
my @array = shuffle( 1 .. 8 );  # shuffle 1 to 8
push @array, '_';               # add the underscore 
```

在一行中：

```
my @array = ( shuffle( 1 .. 8 ), '_' ); 
```

考虑以下：

*   将您的 sub 结构化为`return`一个值
*   避免写`&randgen;`什么时候`randgen();`做同样的事情
*   词法作用域通过`my`
*   [`use strict; use warnings;`](https://stackoverflow.com/q/8023959/133939)
*   尽可能避免进行递归调用（这可能是您的内存消耗的来源）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-08T14:42:59.970

我还没有查看是什么在吞噬你的记忆，但这里有一个更简单的方法来实现你想要的：

```
#!/usr/bin/env perl
use strict;
use warnings;
use List::Util 'shuffle';

my @mats = shuffle 1 .. 8;
push @mats, '_';

print "@mats\n"; 
```

样本输出：

```
3 1 5 8 2 7 4 6 _ 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-08T15:21:21.760

当然，使用`shuffle`是解决您问题的一种正确方法。这是关于您的代码出了什么问题的讨论，以及如何更优雅地表达这种算法。

一旦你`use warnings`，你就会收到关于深度递归的警告——调用堆栈正在吃掉你的内存。在您的 for 循环中，您`randgen`在第 8 个元素（索引 7）被填充后调用。在这种情况下，递归条件总是为真（因为八个元素是唯一的，所以现在总是有一个元素`$randigit`相等）。

您的代码中还有其他一些可以改进的地方：

像这样`for ($i = MIN; $i <= MAX; $i++)`的循环最好写成 foreach-loops：

```
for my $i (MIN .. MAX) 
```

子例程可以接受参数（这些在 中`@_`）并返回值。这消除了使用全局变量来传递参数的需要。

另外，`use strict; use warnings`. 这指出了许多错误，并迫使您声明所有变量（您可以使用 vars 声明`my`）。

这是您的代码的更新版本。它没有递归，而是一个循环。它完美地工作：

```
#!/usr/bin/perl

use strict; use warnings;

# randgen takes
#   - the largest number that may be used, and
#   - a list of all forbidden numbers.
sub randgen { 
    my ($max, @forbidden) = @_; # unpack arguments
    my $rand;
    do {
        $rand = int rand($max + 1);
    } while grep {$_ == $rand} 0, @forbidden;
    return $rand;  # return the rand value.
}

my $digits = 8;
my @mat;  # don't prefill fields.
for ( 1 .. $digits ) {                 # do $digits times 
    push @mat, randgen($digits, @mat); # push appends item to array
    print "@mat\n";
}
push @mat, "_";

print "@mat\n"; 
```

示例输出：

```
8
8 4
8 4 7
8 4 7 2
8 4 7 2 3
8 4 7 2 3 5
8 4 7 2 3 5 1
8 4 7 2 3 5 1 6
8 4 7 2 3 5 1 6 _ 
```

The `grep` builtin takes an expression or a block, plus a list of values. It returns all values to which the expression evaluates to true. The current item is accessible via `$_`. In my loop, it returns true as long as there is a value in `@forbidden` or the value `0` that is equal to `$rand`.

# asp.net - 如何从已成为安全问题的先前运行的网站中收集/提取数据？

> ID：14217052
> 
> 赞同：0
> 
> 时间：2013-01-08T14:25:17.557
> 
> 标签：asp.net, web, webforms, webserver

我有一个分配给我的项目，该项目涉及从以前运行的网站/数据表单中恢复/提取数据。该网站已经有很长一段时间没有维护了，并且已经停止供公众使用。我已经获得了用于构建原始网站的 .htm 、 .asp 和 .js 文件，但我不熟悉应该如何查找以前收集的数据。

一旦我有了数据的位置，我将如何提取信息以供审查？需要收集和审查信息，以了解多年来收集的信息的价值/有效性。

到目前为止，我收集到的唯一信息是该网站是使用 ASP.Net 的 Windows OS Server。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:27:58.703

我不确定我什至会打扰代码。获得数据库位置后，开始查看字段。如果您开始看到涉及敏感信息的字段（字段名称包括`ssn`, `dob`, `maiden`(name) 等），您将对需要清理的内容有一个很好的了解。

如果那里有信用卡信息，上帝会帮助你。

至于查看数据，这就是代码可能派上用场的地方——它会告诉你正在使用什么类型的后端。如果是access数据库，你可以安装MS Access并打开MDB。如果它是 SQL Server 数据库，您将需要客户端工具和与之通信的工作服务器。

# php - PHP 升级给我的 Wordpress 博客错误

> ID：14217062
> 
> 赞同：0
> 
> 时间：2013-01-08T14:25:36.307
> 
> 标签：php, wordpress

我刚刚升级了 Apache，也许我还更新了 PHP（但不是 100% 确定），我的网站： http: [//www.villagedrinks.co.uk/](http://www.villagedrinks.co.uk/)现在出现这些错误，我什至没有在我的网站上使用 WP网站，任何帮助真的很感激。我的一般编码能力相当有限。谢谢 Greg
以下是错误/警告：

```
Deprecated: Assigning the return value of new by reference is deprecated in /home/village/public_html/blog/wp-includes/cache.php on line 36

Deprecated: Assigning the return value of new by reference is deprecated in /home/village/public_html/blog/wp-includes/query.php on line 21

Deprecated: Assigning the return value of new by reference is deprecated in /home/village/public_html/blog/wp-includes/theme.php on line 507

Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /home/village/public_html/blog/wp-includes/cache.php:36) in /home/village/public_html/includes/inc_functions.php on line 22 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:27:18.543

`error_reporting`将 php.ini 中的 PHP 变量更改`E_ALL & ~E_DEPRECATED`为生产服务器的推荐值。然后重新启动您的网络服务器。这将抑制弃用通知并解决您的`session_start()`问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:30:02.547

你肯定在使用 Wordpress： http: [//www.villagedrinks.co.uk/blog/](http://www.villagedrinks.co.uk/blog/)

您收到警告是因为您的 Wordpress 安装很古老：

```
<meta name="generator" content="WordPress 2.2.1" /> 
```

升级 Wordpress（当前版本为 3.5）或完全删除`/blog/`文件夹。

[安装旧版本是不安全的，并且会允许某人通过众多未修补](http://www.cvedetails.com/vulnerability-list/vendor_id-2337/product_id-4096/version_id-45986/Wordpress-Wordpress-2.2.1.html)的错误之一进入您的站点。

# node.js - Mongoose 模式/模型中的自定义构造函数

> ID：14217067
> 
> 赞同：14
> 
> 时间：2013-01-08T14:25:42.540
> 
> 标签：node.js, mongoose

问候大家！

我如下定义了一个 Mongoose 模式并注册了一个模型（InventoryItemModel）。有没有办法为模式创建自定义构造函数，这样当我从模型中实例化一个对象时，该函数将被调用（例如，从数据库中加载具有值的对象）？

```
var mongoose = require('mongoose')
  , Schema = mongoose.Schema

var InventoryItemSchema = new Schema({
    Sku : String
  , Quanity : Number
  , Description : String
  , Carted : []
  , CreatedDate  : {type : Date, default : Date.now}
  , ModifiedDate  : {type : Date, default : Date.now}
});

mongoose.model('InventoryItem', InventoryItemSchema);

var item = new InventoryItem(); 
```

我可以添加一些自定义构造函数，以便在实例化时从数据库中填充项目吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-09T05:57:46.570

根据您要采取的方向，您可以：

**1）使用钩子**

当模型初始化、验证、保存和删除时，钩子会自动触发。这是“由内而外”的解决方案。您可以在此处查看文档：

*   [http://mongoosejs.com/docs/middleware.html](http://mongoosejs.com/docs/middleware.html)

**2）为您的模式编写一个静态创建函数。**

静力学存在于您的模型对象上，可用于替换创建新模型等功能。如果您的`create`步骤有额外的逻辑，您可以自己在静态函数中编写。这是“由外而内”的解决方案：

*   [http://mongoosejs.com/docs/guide.html#statics](http://mongoosejs.com/docs/guide.html#statics)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-08-22T19:57:59.960

[这是来自答案](https://stackoverflow.com/a/14229099/2476755)的选项#2 的`@hunterloftis`实现。

> 2）为您的模式编写一个静态创建函数。

```
someSchema.statics.addItem = function addItem(item, callback){
//Do stuff (parse item)
 (new this(parsedItem)).save(callback);
} 
```

当您想从 someSchema 创建新模型时，而不是

```
var item = new ItemModel(itemObj);
item.save(function (err, model) { /* etc */ }); 
```

做这个

```
ItemModel.addItem(itemObj, function (err, model) { /* etc */ }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-04T17:30:09.203

我自己遇到了这个问题并写了一个猫鼬插件来帮助解决你的问题

```
var mongoose = require('mongoose')
  , Schema = mongoose.Schema
  , construct = require('mongoose-construct')

var user = new Schema({})
user.plugin(construct)

user.pre('construct', function(next){
    console.log('Constructor called...')
    next()
})

var User = mongoose.model('User', user)
var myUser = new User(); // construct hook will be called 
```

这是 repo（也可以在 npm 上找到）：[https ://github.com/IlskenLabs/mongoose-construct](https://github.com/IlskenLabs/mongoose-construct)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-09T00:13:17.330

@hunterloftis provided me the answer I needed. Now, nearly 6+ years later, here is my solution for anyone else.

```
InventoryItemSchema.static( 'new', function( that )
{
    let instance = new InventoryItemSchema();
    Object.assign( instance, that );
    return instance;
}); 
```

or as the one-liner (which is less conducive to debugging)

```
InventoryItemSchema.static( 'new', function( that )
{return Object.assign( new InventoryItemSchema(), that );}); 
```

Either way, where you would like to have

```
let inventoryItem = new InventoryItemSchema({...}); 
```

you will instead have

```
let inventoryItem = InventoryItemSchema.new({...}); 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2016-12-11T20:46:02.163

你需要导出。这是一个例子：

```
import mongoose from "mongoose";

let  Schema = mongoose.Schema;

let restaurentSchema = new Schema({
  name : String
})

//export

module.exports = mongoose.model("Restaurent", restaurentSchema) 
```

# java - 传递对象时的模拟方法

> ID：14217072
> 
> 赞同：0
> 
> 时间：2013-01-08T14:25:57.913
> 
> 标签：java, mockito

我试图在 Spring/Hibernate 中模拟一个 DAO 方法，它接受一个对象并返回一个对象。

```
Mockito.when(mockedDao.findByProperty(c)).thenReturn(state); 
```

`c`对象具有键值对，例如“name”、“ben”。`state`对象将具有就业状态。

但是当我运行测试时它返回null。我认为这是因为`criteria`我在单元测试中传递的参数并不完全相同，尽管它们是相等的。我该如何解决这个问题？这里的条件是一个具有与休眠条件无关的键值的对象......

这是“service.getELementByName”：

```
 @Override
@Transactional
public State getElementByName(Object value) {
    Criteria c = new Criteria();
    c.property = "state_name";
    c.value = (String) value;
    State result = (State) stateDAO.findByProperty(c);
    return result;
} 
```

请建议！谢谢

* * *

编辑代码看起来像这样

```
private State state;

@Mock
private StateDAO mockedDao;
@InjectMocks
private StateServiceImpl service;

@Before
public void init() {
    // mockedDao = mock(StateDAO.class);
    Criteria c = new Criteria();
    c.property = "state_name";
    c.value = (String) "Virginia";
    state = new State();
    state.setId(20);
    state.setIntPtLat(37.5222512);
    state.setIntPtLon(-78.6681938);
    state.setStateName("Virginia");
    Mockito.when(mockedDao.findByProperty(eq(c))).thenReturn(state);
    // service = new StateServiceImpl<State>();
}

@Test
public void testFindByProperty() {

    state = new State();
    state.setId(20);
    state.setIntPtLat(37.5222512);
    state.setIntPtLon(-78.6681938);
    state.setStateName("Virginia");

    Criteria c = new Criteria();
    c.property = "state_name";
    c.value = (String) "Virginia";
    Mockito.when(mockedDao.findByProperty(eq(c))).thenReturn(state);
    service.getElementByName("Virginia");
    State result = (State) service.getElementByName("Tes");
    assertEquals(state, result);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:32:39.750

如果您需要根据`Criteria`传递给的特定实例添加行为，`findByProperty`那么您需要深入了解 Mockito 认为它不一样的原因 - 在发布更多代码之前，我们无能为力！

但是，如果不是这种情况并且任何实例都可以，那么您可以使用参数匹配器来放松一下，例如：

```
Mockito.when(mockedDao.findByProperty(any(Criteria.class))).thenReturn(state); 
```

就像我说的那样，这取决于您要测试的内容。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T15:07:35.420

你在任何地方打电话给 Mockito.initMocks(this) 吗？如果没有，那可能是你的问题。

# github - Visual Studio 2012 - 导入/导出 GitHub Gists

> ID：14217079
> 
> 赞同：6
> 
> 时间：2013-01-08T14:26:22.597
> 
> 标签：github, visual-studio-2012, code-snippets, gist

我遇到了以下帖子： Jeffrey Way 的[用 Gists](http://net.tutsplus.com/tutorials/tools-and-tips/sexy-code-snippet-management-with-gists/) 进行的性感代码片段管理，描述了如何**在 Sublime Text 2 中使用 GitHub 管理和共享片段**。

他使用一个插件轻松地从 GitHub 导入和导出 Gists。

我想在 VS2012 中做同样的事情，但没有找到插件或解决方案来做到这一点。Gister允许创建[Gists](http://visualstudiogallery.msdn.microsoft.com/b31916b0-c026-4c27-9d6b-ba831093f6b2)，但它不进行任何导入。

有谁知道另一个插件或类似的解决方案来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-16T05:38:40.437

要将 gist 导入 Visual Studio，请记住每个 gist 都是一个普通的 git 存储库。因此，您应该能够使用 [Visual Studio Tools for Git](http://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c)之类的插件来克隆 gist 的 Git 存储库。

正如您在问题中提到的，您应该能够将[Gister](http://visualstudiogallery.msdn.microsoft.com/b31916b0-c026-4c27-9d6b-ba831093f6b2)用于其他与 gist 相关的功能。

# assembly - Yasm 使用 intel 语法编译 64 位代码

> ID：14217080
> 
> 赞同：1
> 
> 时间：2013-01-08T14:26:23.803
> 
> 标签：assembly, x86, x86-64, yasm

我有这个文件：

```
.code64
pop %rbx 
```

使用以下指令与 yasm 很好地编译：

```
yasm.exe asm.asm -o asm.bin -m amd64 --parser=gas 
```

我的问题是：有没有办法使用 nasm 解析器通过 intel 语法编译 64 位代码？我不太喜欢 AT&T 语法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:44:01.553

请参阅[有关 BITS 指令的 yasm 手册](http://www.tortall.net/projects/yasm/manual/html/nasm-directives.html#nasm-directive-bits)。

```
bits 64
pop rbx 
```

```
yasm.exe asm.asm -o asm.bin -m amd64 
```

# c++ - Clang 和 Intel 无法编译此 CRTP 代码

> ID：14217086
> 
> 赞同：11
> 
> 时间：2013-01-08T14:26:37.300
> 
> 标签：c++, templates, c++11, compiler-errors, crtp

我编写了一个使用大量 C++11 元编程技术和 CRTP 的小型库，它可以很好地与 g++ 4.7.2 一起编译

现在，我尝试用 Intel icpc 13.0.0.079 编译它，它会产生数百个错误。所以我试图一个接一个地隔离问题。

所以，首先，考虑这段代码，它在 g++ 4.7.2 下编译没有问题

```
#include <iostream>

template<template<typename> class Crtp, typename Type>
struct Base {};

template<typename Type>
struct Derived : public Base<Derived, Type>
{
    Derived(): Base<Derived, Type>() {;}
};

int main()
{
    Derived<int> x;
    return 0;
} 
```

icpc 和 clang 都无法编译这段代码：

```
test_crtp.cpp(26): error: type "Derived<Type>::Derived" is not a class template
      Derived(): Base<Derived, Type>() {;}
                      ^

test_crtp.cpp(26): error: "Base" is not a nonstatic data member or base class of class "Derived<int>"
      Derived(): Base<Derived, Type>() {;}
                 ^
          detected during instantiation of "Derived<Type>::Derived() [with Type=int]" at line 31

compilation aborted for test_crtp.cpp (code 2) 
```

那么它是 intel 和 clang 还是 g++ 中的错误？如果它在 intel 和 clang 中，你认为它会在未来的版本中解决吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T14:42:57.613

在 class 内部`Derived`，名称`Derived`指的是（实例化的）类，而不是类模板。请`Base< ::Derived, Type>`改用（注意在 < 和 :: 之间留一个空格）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-08T16:03:35.787

在**C++ Template the Complete Guide** ( [Amazon](https://rads.stackoverflow.com/amzn/click/com/0201734842) ) 的第 9.2.3 节中，有关于 Injected Class Names 的讨论。去引用：

> 类模板也注入了类名。但是，它们比普通的注入类名更奇怪：它们后面可以跟模板参数（在这种情况下，它们是注入的类模板名称），但是如果它们后面没有模板参数，则它们表示以参数作为参数的类（或者，对于部分专业化，它的专业化参数）。这解释了以下情况：

```
template<template<typename> class TT> 
class X {};

template<typename T> 
class C 
{
    Ca;        // OK: same as ''C<T> a;''
    C<void> b; // OK
    X<C> c;    // ERROR: C without a template argument list
               // does not denote a template
    X<::C> d;  // ERROR: <: is an alternative token for [
    X< ::C> e; // OK: the space between < and :: is required
} 
```

> 请注意，非限定名称如何引用注入的名称，如果它后面没有模板参数列表，则不被视为模板的名称。作为补偿，我们可以通过使用文件范围限定符:: 来强制找到模板的名称。这可行，但我们必须小心不要创建所谓的二合字母标记 <:，它被解释为左括号。虽然相对罕见，但此类错误会导致令人困惑的诊断。

因此，您的代码中发生的事情`Base<Derived, Type>`是被解释为`Base<Derived<Type>, Type>`格式错误的。因此，您需要使用范围限定符`::`，在 之间有一个空格`<`来避免有向图。

# arrays - 在两个日期之间获取所有特定日期 - 最快的方法？

> ID：14217088
> 
> 赞同：2
> 
> 时间：2013-01-08T14:26:41.600
> 
> 标签：arrays, vb.net, performance, date

我正在研究最好和最快的方法是在两个特定日期之间获得所有日子（周一、周二、周三）。

日期作为参数以逗号分隔的字符串传递给 Web 服务，例如`mon,tue,wed,`

目前这是伪代码。

所以我的（伪）代码如下

```
function Add(startdate, enddate, days)
{
    dateList as New List(Of Date)
    if days.split(',').count < 7 then
    {
        // This is the problem area.

    }

    while(startdate < enddate)
    {
        // do some processing of either the dates in dateList or just all days
    }
} 
```

这个问题对我来说是我

1)

*   将`days`参数拆分为数组，
*   循环天数数组
*   每个`day`天数：
    *   经历和之间的每个`startdate`日期`enddate`
    *   如果`date.day` 是`day`，则在此方法中添加到 dateList 可能有 (365 * 6) 检查（假设开始日期和结束日期相隔一年），如果选择了所有日期，我可以忽略将它们放入列表

2)

*   经历和之间的每个`startdate`日期`enddate`
*   开关（日期.dayofweek.tostring（））
*   case 'mon': if days.contains('mon') then addDatetoList

3)

*   对于每个`everyday`之间`startdate`和`enddate`
*   如果`days`.contains(everyday.dayofweek.tostring()) 然后 addDatetoList

4）有没有我忽略的另一种方法，所有这些都是完全低效的？

计算需要在 vb.net 代码隐藏中进行，否则我会考虑使用 sql server 来完成。

**编辑**

作为功​​能计时的练习，我快速构建了以下内容来尝试我的方法和其他方法。

```
Dim DaysOfWeek As String = "Monday,Tuesday,Friday"
        Dim startDate As DateTime = DateTime.Now
        Dim endDate As DateTime = DateTime.Now.AddDays(365)
        Dim dateList As New List(Of DateTime)()

        Dim method1StopWatch As New Stopwatch
        Dim method2StopWatch As New Stopwatch
        Dim method3StopWatch As New Stopwatch
        Dim method4StopWatch As New Stopwatch

        Dim executionStart As Long
        Dim executionEnd As Long
        Dim noDays As Integer = 0

        'Method3

        method3StopWatch.Start()
        Do While (startDate < endDate)
            If DaysOfWeek.Contains(startDate.DayOfWeek.ToString()) Then
                dateList.Add(startDate)
                noDays = noDays + 1
            End If
            startDate = startDate.AddDays(1)

        Loop
        method3StopWatch.Stop()
        Label3.Text = method3StopWatch.ElapsedTicks.ToString() & " " & noDays & " Days"

        noDays = 0
        dateList.Clear()
        startDate = DateTime.Now

        'Method2

        method2StopWatch.Start()

        Do While (startDate < endDate)
            Select startDate.DayOfWeek.ToString()
                Case "Monday"
                    If DaysOfWeek.Contains("Monday") Then
                        dateList.Add(startDate)
                        noDays = noDays + 1
                    End If
                Case "Tuesday"
                    If DaysOfWeek.Contains("Monday") Then
                        dateList.Add(startDate)
                        noDays = noDays + 1
                    End If
                Case "Wednesday"
                    If DaysOfWeek.Contains("Wednesday") Then
                        dateList.Add(startDate)
                        noDays = noDays + 1
                    End If
                Case "Thursday"
                    If DaysOfWeek.Contains("Thursday") Then
                        dateList.Add(startDate)
                        noDays = noDays + 1
                    End If
                Case "Friday"
                    If DaysOfWeek.Contains("Friday") Then
                        dateList.Add(startDate)
                        noDays = noDays + 1
                    End If
                Case "Saturday"
                    If DaysOfWeek.Contains("Saturday") Then
                        dateList.Add(startDate)
                        noDays = noDays + 1
                    End If
                Case "Sunday"
                    If DaysOfWeek.Contains("Sunday") Then
                        dateList.Add(startDate)
                        noDays = noDays + 1
                    End If
            End Select
            startDate = startDate.AddDays(1)

        Loop
        method2StopWatch.Stop()
        Label2.Text = (method2StopWatch.ElapsedTicks).ToString() & " " & noDays & " Days"

        noDays = 0
        dateList.Clear()
        startDate = DateTime.Now

        method1StopWatch.Start()
        For Each Day As String In DaysOfWeek.Split(CChar(","))
            Do While (startDate < endDate)
                If startDate.DayOfWeek.ToString() = Day Then
                    noDays = noDays + 1
                    dateList.Add(startDate)
                End If
                startDate = startDate.AddDays(1)
            Loop
            startDate = DateTime.Now
        Next

        method1StopWatch.Stop()
        Label1.Text = (method1StopWatch.ElapsedTicks).ToString() & " " & noDays & " Days"

        noDays = 0
        dateList.Clear()
        startDate = DateTime.Now

        method4StopWatch.Start()
        Dim daysList As New List(Of DayOfWeek)()
        daysList.Add(DayOfWeek.Monday)
        daysList.Add(DayOfWeek.Tuesday)
        daysList.Add(DayOfWeek.Friday)
        Dim datesList As List(Of Date) = GetDayOfWeekDates(startDate, endDate, daysList)
        method4StopWatch.Stop()
        Label4.Text = (method4StopWatch.ElapsedTicks).ToString() & " " & datesList.Count & " Days"

    End Sub

    Public Function GetDayOfWeekDates(startDate As Date, endDate As Date, daysOfWeek As List(Of DayOfWeek)) As List(Of Date)
        Dim liReturn As New List(Of Date)()
        Dim currDay As Date = startDate
        While currDay <= endDate
            If daysOfWeek.Contains(currDay.Date.DayOfWeek) Then
                liReturn.Add(currDay.Date)
            End If
            currDay = currDay.AddDays(1)
        End While
        Return liReturn
    End Function 
```

这导致周一、周二、周五的以下输出（经过的滴答声）：

```
Method 1 : 10650 - 157 Days
Method 2 : 4152 - 157 Days
Method 3 : 4084 - 157 Days
Method 4 : 179 - 157 Days 
```

这也意味着我的方法和逻辑很糟糕。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:59:09.900

This is the way I'd do it. I don't know if it is the most performant way possible, but in my opinion it is the easiest code to read and understand, and should execute quite quickly even if you are checking a large date range.

```
Public Function GetDayOfWeekDates(startDate As Date, endDate As Date, daysOfWeek As List(Of DayOfWeek)) As List(Of Date)
    Dim liReturn As New List(Of Date)()
    Dim currDay As Date = startDate
    While currDay <= endDate
        If daysOfWeek.Contains(currDay.Date.DayOfWeek) Then
            liReturn.Add(currDay.Date)
        End If
        currDay = currDay.AddDays(1)
    End While
    Return liReturn
End Function 
```

You would call the function by building a list of DayOfWeek to check against:

```
 Dim daysList As New List(Of DayOfWeek)()
    daysList.Add(DayOfWeek.Monday)
    daysList.Add(DayOfWeek.Friday)
    Dim datesList As List(Of Date) = GetDayOfWeekDates(New Date(2012, 1, 1), New Date(2012, 12, 31), daysList) 
```

In this example, your result would be in List(Of Date) datesList.

Edit: I just noticed that you mentioned a web service will receive a comma-delimited list with the days of the week. In my opinion you should definitely parse the list in a separate function at a level in your code where errors can be returned via the web service if the list is invalid. The function to find the list of dates should take a strongly typed parameter as I have shown above.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T15:37:22.897

**EDIT 2**

I've tested the updated function and I was able to simplify which should also make it a little faster.

```
Public Shared Function DaysOfWeekRange(
    ByVal startDateTime As DateTime, _
    ByVal endDateTime As DateTime, _
    ByVal daysOfWeek As ISet(Of DayOfWeek)) As IEnumerable(Of DateTime)

    If (endDateTime < startDateTime) Then
        Return Enumerable.Empty(Of DateTime)()
    End If

    Dim startDate = startDateTime.Date
    Dim endDate = endDateTime.Date

    Dim firstDate As DateTime?
    Dim lastDate As DateTime
    Dim increment = 0
    Dim increments = New List(Of Integer)(7)

    ' Get Increments
    For d = 0 To 6
       If firstDate.HasValue Then
           increment += 1
           Dim day = startDate.AddDays(d)
           If daysOfWeek.Contains(day.DayOfWeek) Then
               lastDate = day
               increments.Add(increment)
               increment = 0
           End If           
       Else
           Dim possibleFirst = startDate.AddDays(d)
           If daysOfWeek.Contains(possibleFirst.DayOfWeek) Then
               firstDate = possibleFirst
               lastDate = firstDate
           End If
       End If
    Next

    If Not firstDate.HasValue Then
        Return Enumerable.Empty(Of DateTime)()
    End If

    ' Add loop back increment
    increments.Add((7 - lastDate.DayOfWeek) + firstDate.Value.DayOfWeek)

    ' Prepare iteration
    Dim wholeWeeks = Math.Floor(endDate.Subtract(firstDate).TotalDays() /7)
    Dim results = new List(Of DateTime)((wholeWeeks + 1) * daysOfWeek.Count)
    Dim thisDate = firstDate

    ' Whole Weeks
    For i = 1 To wholeWeeks Step 1
        For Each increment In increments
            results.Add(thisDate)
            thisDate = thisDate.AddDays(increment)
        Next
    Next

    ' Last Partial Week
    If (thisDate <= endDate) Then
        For Each increment In Increments
            results.Add(thisDate)
            thisDate = thisDate.AddDays(increment)
            If (thisDate > endDate) Then
                Exit For
            End If
        Next
    End if

    Return results
End Function 
```

* * *

I can think of a more efficient way but, it involves implementing `Enumerator(Of DateTime)`, its a shame we don't have a `yield return` equivalent in Visual Basic, then there would be a simple efficient option. If you want the `Enumerator` option then please ask.

Anyway this function is simple to write and shouldn't be too slow.

```
Public Shared Function DaysOfWeekRange(
    ByVal startDateTime As DateTime, _
    ByVal endDateTime As DateTime, _
    ByVal daysOfWeek As ISet(Of DayOfWeek)) As IEnumerable(Of DateTime)

    If (endDateTime < startDateTime) Then
        Return Enumerable.Empty(Of DateTime)()
    End If

    Dim startDate = startDateTime.Date
    Dim endDate = endDateTime.Date

    Return Enumerable.Range(0, endDate.Subtract(startDate).TotalDays) _
        .Select(Function(i) startDate.AddDays(i)) _
        .Where(Function(day) daysOfWeek.Contains(day.DayOfWeek))
End Function 
```

* * *

**EDIT**

In this approach I calculate the cycle of increments up front and repeat for the number of whole weeks without checks. Then I increment for the last partial week with checks. If the range is sufficiently wide I think this should have a performance adavantage.

```
Public Shared Function DaysOfWeekRange(
    ByVal startDateTime As DateTime, _
    ByVal endDateTime As DateTime, _
    ByVal daysOfWeek As ISet(Of DayOfWeek)) As IEnumerable(Of DateTime)

    If (endDateTime < startDateTime) Then
        Return Enumerable.Empty(Of DateTime)()
    End If

    Dim startDate = startDateTime.Date
    Dim endDate = endDateTime.Date

    Dim firstDate = Enumerable.Range(0, 6) _
        .Select(Function(i) startDate.AddDays(i)) _
        .First(Function(d) daysOfWeek.Contains(d.DayOfWeek))

    Dim firstDayOfWeek = firstDate.DayOfWeek
    Dim offsets = New SortedSet(Of Integer)()
    For Each dayOfWeek in daysOfWeek
       Dim offset = dayOfWeek - firstDayOfWeek

       Select Case offset
           Case Is > 0
               offsets.Add(offset)
           Case Is < 0
               offsets.Add(7 + offset)
       End Select
    Next

    Dim increments = New List(Of Integer)()
    Dim lastOffset = 0
    For Each offset In offsets
        increments.Add(offset - lastOffset)
        lastOffset = offset
    Next
    increments.Add(7 - lastOffset)

    Dim results = new List(Of DateTime)()
    Dim wholeWeeks = Math.Floor(endDate.Subtract(firstDate).TotalDays() /7)
    Dim thisDate = firstDate

    'Whole Weeks
    For i = 1 To wholeWeeks Step 1
        For Each increment In increments
            results.Add(thisDate)
            thisDate = thisDate.AddDays(increment)
        Next
    Next

    'Last Partial Week
    If (thisDate <= endDate) Then
        For Each increment In Increments
            results.Add(thisDate)
            thisDate = thisDate.AddDays(increment)
            If (thisDate > endDate) Then
                Exit For
            End If
        Next
    End if

    Return results
End Function 
```

It looks like a lot more code but I think that in most cases the preperation up front results in less work overall.

# android - 安卓隐藏应用

> ID：14217096
> 
> 赞同：3
> 
> 时间：2013-01-08T14:27:01.523
> 
> 标签：android, security, hidden, launcher

> **可能重复：**
> [没有应用程序图标的应用程序](https://stackoverflow.com/questions/6426389/application-without-app-icon)

我想创建安全 - 应用程序。我想在配置后隐藏启动器上的应用程序图标（用户看不到它们）。我尝试使用服务，但这不是一个好的解决方案，因为我仍然看到 icon 。我听说要编辑 mainfest，但我无法制作它们。请帮助我，不要删除我的帖子。谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:30:53.480

一种可能的方法是删除线

```
<category android:name="android.intent.category.LAUNCHER"> 
```

从您的清单中，它告诉 Android 您放入的活动应该出现在启动器中。

但是，从启动器中隐藏您的应用程序并不是一个好主意，因为这样普通用户将不知道如何找到它以根据需要重新配置/删除它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:30:38.120

这看起来像是对您需求的回答：[http ://androidsnips.blogspot.com/2011/11/create-android-application-with-no.html?m=0](http://androidsnips.blogspot.com/2011/11/create-android-application-with-no.html?m=0)

# php - 使用 Amazon API MWS 进行签名查询

> ID：14217097
> 
> 赞同：1
> 
> 时间：2013-01-08T14:27:07.250
> 
> 标签：php, api, amazon, amazon-mws

我正在尝试为卖家亚马逊网络服务 (MWS) 发出签名请求。我正在使用这里的脚本： [将亚马逊 MWS 暂存器查询转换为 API 调用](https://stackoverflow.com/questions/11694376/converting-amazon-mws-scratchpad-queries-to-api-calls)

但是不知道为什么会报错：“我们计算的请求签名与您提供的签名不匹配。请检查您的 AWS 秘密访问密钥和签名方法。详情请参阅服务文档。”

所以这是我的脚本：

```
define ("AWS_ACCESS_KEY_ID", "xxxxx");
define ("MERCHANT_ID", "xxxxx");
define ("MARKETPLACE_ID", "xxxxx");
define ("AWS_SECRET_ACCESS_KEY","xxxxx");

$base_url = "https://mws.amazonservices.fr/Products/2011-10-01";
$method = "POST";
$host = "mws.amazonservices.fr";
$uri = "/Products/2011-10-01";

function amazon_xml($searchTerm) {

$params = array(
'AWSAccessKeyId' => AWS_ACCESS_KEY_ID,
'Action' => "GetLowestOfferListingsForSKU",
'SellerId' => MERCHANT_ID,
'SignatureMethod' => "HmacSHA256",
'SignatureVersion' => "2",
'Timestamp'=> date("Y-m-d\TH:i:s.\\0\\0\\0\\Z", time()),
'Version'=> "2011-10-01",
'MarketplaceId' => MARKETPLACE_ID,
'Query' => $searchTerm,
'ItemCondition'=> "New",
'ExcludeMe' => "false");

// Sort the URL parameters
$url_parts = array();
foreach(array_keys($params) as $key)
$url_parts[] = $key . "=" . str_replace('%7E', '~', rawurlencode($params[$key]));
sort($url_parts);

// Construct the string to sign
$url_string = str_replace("%7E", "~", implode("&", $url_parts));
$string_to_sign = "POST\nmws.amazonservices.fr\n/Products/2011-10-01\n" . $url_string;

// Sign the request
$signature = hash_hmac('sha256', $string_to_sign, AWS_SECRET_ACCESS_KEY, TRUE);

// Base64 encode the signature and make it URL safe
$signature = rawurlencode(base64_encode($signature));

$url = "https://mws.amazonservices.fr/Products/2011-10-01" . '?' . $url_string . "&Signature=" . $signature;

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, 15);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
$response = curl_exec($ch);

$parsed_xml = simplexml_load_string($response);

return ($parsed_xml);
} 
```

我不明白出了什么问题如果有人可以帮助....

提前致谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T18:11:09.887

签署字符串时遇到问题..试试这个

```
$url_parts = array();
foreach(array_keys($params) as $key)
    $url_parts[] = $key . "=" . str_replace('%7E', '~', rawurlencode($params[$key]));
sort($url_parts);

// Construct the string to sign
$url_string = implode("&", $url_parts);
$string_to_sign = "GET\nmws.amazonservices.com\n/Products/2011-10-01\n" . $url_string;

// Sign the request
$signature = hash_hmac("sha256", $string_to_sign, AWS_SECRET_ACCESS_KEY, TRUE);

// Base64 encode the signature and make it URL safe
$signature = urlencode(base64_encode($signature));

$url = "https://mws.amazonservices.com/Products/2011-10-01" . '?' . $url_string . "&Signature=" . $signature; 
```

它为我工作......希望这会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-23T11:50:29.123

确保在使用 cURL 时将方法设置为“GET”，在上面的示例中更改为

$方法=“获取”；

它应该可以工作。

# java - 在我的 Java GUI 中嵌入视频

> ID：14217098
> 
> 赞同：0
> 
> 时间：2013-01-08T14:27:11.027
> 
> 标签：java, video, compiler-errors, jmf

我做了一个简单的游戏，它是一个基于状态的游戏，这意味着我有许多不同的状态（屏幕），例如启动屏幕、菜单屏幕和实际游戏，我的菜单屏幕现在很无聊，我想要一部分它是一个没有任何控件的视频，因此它看起来像是游戏中内置的动画，我查看了 JMF 并发现您只需要以下代码即可使其工作（请注意，我已经删除了我找到的原始代码，所以它只是剩下的视频）：

EIDT：显示的代码带有解释错误消息的注释：

```
 package javagame;

import java.awt.BorderLayout;
import java.awt.Component;
import java.net.URL;

import javax.swing.JFrame;

public class mediaPlayer extends JFrame
    {
        public mediaPlayer()
        {
            setLayout(new BorderLayout());

            URL mediaURL = //Whatever

            Player mediaPlayer = Manager.createRealizedPlayer(mediaURL);
            //Player cannot be resolved as a variable
            //mediaPlayer cannot be resolved as a variable
            //Manager cannot be resolved

            Component video = mediaPlayer.getVisualComponent();
            //The method getVisualComponent() is undefined for thetype mediaplayer
            add(video,BorderLayout.CENTER);

        }
    } 
```

我创建了一个名为 mediaPlayer 的新类，并将上面的代码放入其中，它扩展了 JFrame，但我在播放器、媒体播放器和管理器等内容下遇到错误，例如为此制作方法、为此制作类、为此制作变量，我认为这将毫无错误地工作，因为它扩展了 JFrame 并且所有所需的方法、类和变量都已经生成，我错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:36:36.150

> ..我错了吗？

是的，你是。自动包含在框架中的唯一方法是为其定义的方法。

您所说的方法是 JMF 的一部分。这些类需要在代码顶部导入。就像是：

```
import javax.media.*; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T16:26:47.663

确保下载 Java Media Framework。将 jar 添加到项目中名为 lib 的文件夹中。右键单击 jar 并将其添加到构建路径。然后你的导入应该工作。

# html - 什么字符代表文本区域中的新行

> ID：14217101
> 
> 赞同：94
> 
> 时间：2013-01-08T14:27:28.250
> 
> 标签：html, textarea, newline

只是快速一个，但要确保我能捕捉到跨平台的变化。

我喜欢将输入到文本区域的新行转换为[逗号]，以便输出可以在一行上表示，我的问题......

目前，从谷歌浏览器发送，当我查看值时，我发现它`\r\n`用于新行。如果我更换`\r\n`，我知道它适用于 Windows 7 上的 chrome，但其他平台呢，其他浏览器将作为新行插入文本区域内的内容是否有变化？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2013-01-08T14:37:48.147

根据 HTML 规范，浏览器需要将用户输入中的换行符规范化为 CR LF ( `\r\n`)，我认为任何浏览器都不会出错。参考：HTML 4.01 规范中的第 17.13.4 条[表单内容类型](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4)。

在 HTML5 草稿中，情况更加复杂，因为它们还处理浏览器内部的进程，而不仅仅是在提交表单时发送到服务器端表单处理程序的数据。根据他们（和浏览器实践），[`textarea`](http://www.w3.org/TR/html5/forms.html#the-textarea-element)元素值存在于三种变体中：

1.  用户输入的原始值，未标准化；它可能包含 CR、LF 或 CR LF 对；
2.  内部值，称为“API 值”，其中换行符标准化为 LF（仅）；
3.  提交值，其中换行符被标准化为 CR LF 对，根据 Internet 约定。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-08T14:29:24.997

专门讨论 Web 表单中的文本区域，适用于所有平台上的所有文本区域，都`\r\n`可以。

如果您使用其他任何东西，您将在 Windows 平台上导致剪切和粘贴问题。

当表单提交时，换行符将被 Windows 浏览器规范化，但是如果您将表单发送到带有`\n`换行符的浏览器，您会发现文本不会在例如记事本和 textarea 之间正确复制和粘贴。

有趣的是，尽管有 Unix 行尾约定`\n`，但大多数基于文本的网络协议（包括 HTTP、SMTP、POP3、IMAP 等）的标准仍然是`\r\n`. 是的，它可能没有多大意义，但这对你来说是历史和不断发展的标准！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-22T19:39:11.863

```
&#10;- Line Feed and &#13; Carriage Return 
```

这些[HTML 实体](https://www.w3schools.com/html/html_entities.asp) 将在文本区域内插入新行或回车。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-11-27T16:28:57.053

看来，根据[HTML5 规范](http://www.w3.org/TR/html5/forms.html#the-textarea-element)， textarea 元素的 value 属性应该返回 '\r\n' 换行：

> 元素的[值](http://www.w3.org/TR/html5/forms.html#concept-fe-value)被定义为元素的原始值，并应用了以下转换：
> 
> 替换每次出现的“CR”（U+000D）字符后面没有“LF”（U+000A）字符，以及每次出现的“LF”（U+000A）字符前面没有“CR”（ U+000D) 字符，由一个 U+000D CARRIAGE RETURN "CRLF" (U+000A) 字符对组成的两个字符的字符串。

在指向“value”的链接之后，可以清楚地看出它是指在 javascript 中访问的 value 属性：

> 表单控件具有值和检查性。（后者仅由输入元素使用。）这些用于描述用户如何与控件交互。

但是，在所有五种主要浏览器中（使用 Windows，2015 年 11 月 27 日），如果将 '\r\n' 写入文本区域，则会剥离 '\r'。（测试：var e=document.createElement('textarea'); e.value='\r\n'; alert(e.value=='\n');）从 v9 开始，IE 就是如此。在此之前，IE 会返回 '\r\n' 并将 '\r' 和 '\n' 都转换为 '\r\n' （这是 HTML5 规范）。所以...我很困惑。

为了安全起见，通常在正则表达式中使用 '\r?\n' 而不仅仅是 '\n' 就足够了，但如果必须知道换行符序列，则可以在应用程序中执行上述测试。

# ruby-on-rails - 如何使用 Ruby on Rails 随机选择要显示的内容

> ID：14217102
> 
> 赞同：2
> 
> 时间：2013-01-08T14:27:35.273
> 
> 标签：ruby-on-rails, ruby, random

我在我的 Ruby on Rails 应用程序中的侧边栏中有一个横幅，它由一大块 HTML 显示，`views/home/index.html`但我还有另一个横幅。我想在每次有人查看页面时随机显示其中一个。

```
<section id="audio-banner">
<a onclick="changeClass("#swap") href="#">
<img src="someImage.gif" >
</a>
</section> 
```

和

```
<section id="audio-banner">
<a onclick="changeClass("#swap2") href="#">
<img src="someOtherImage.gif" >
</a>
</section> 
```

我是 Ruby 和 Rails 的新手。我不确定将预定义的 HTML（模型、控制器、帮助程序等）放在哪里，或者如何编写将随机显示这两者之一的函数。

我开始编辑`helpers/home_helper.rb`并插入以下代码

```
module StoreHelper
  def randomAudio
    audio1 = '<section id="audio-banner">'
    audio1 << '<a onclick="changeClass("#swap"); return false;" href="#">'
    audio1 << '<img src="some.gif">'
    audio1 << '</a>'
    audio1 << '</section>'
    audio1
    audio2 = '<section id="audio-banner">'
    audio2 << '<a onclick="changeClass("#swap2"); return false;" href="#">'
    audio2 << '<img src="someOther.gif" alt="Estate">'
    audio2 << '</a>'
    audio2 << '</section>'
    audio2
  end
end 
```

但这就是我所得到的，因为我知道这是不正确的。任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T14:34:00.617

这是您的代码的改进版本（应该可以）。请注意，在实际应用中，您应该将这些 HTML 部分移动到部分。但是在这里，为了简单起见，让我们将它们内联。

```
module StoreHelper
  def randomAudio
    audio1 = <<-HTML
    <section id="audio-banner">
      <a onclick="changeClass("#swap"); return false;" href="#">
        <img src="some.gif">
      </a>
    '</section>
    HTML

    audio2 = <<-HTML
    <section id="audio-banner">
      <a onclick="changeClass("#swap2"); return false;" href="#">
        <img src="someOther.gif" alt="Estate">
      </a>
    </section>
   HTML

   # pick one of them randomly
   [audio1, audio2].sample
  end
end 
```

它使用[heredocs](http://blog.jayfields.com/2006/12/ruby-multiline-strings-here-doc-or.html)来定义 HTML 片段而没有额外的噪音。另请阅读有关[Array#sample](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-sample)的信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T14:40:44.230

在我看来，将纯 HTML 放入助手中似乎不合适。我可能会创建 2 个部分：`shared/_audio1.html.erb`并且`shared/_audio2.html.erb`考虑到您将来可能希望在不同的页面上显示这些横幅。现在你需要做的就是随机渲染这个部分：

```
= render "shared/%s.html.erb" % ["audio1", "audio2"].sample 
```

部分的名称是硬编码的，但它应该能让你继续前进。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-08T14:48:47.673

不要为部分或助手而烦恼。

在您的`home_controller`中，设置一个可能的图像数组。如果要从文件夹生成它，请使用：

```
# Loads from public directory and subsequently removes public from the path
# so that you can use it as your image URI.
@images = Dir.glob("public/banner-images/*.gif").map{|i| i.gsub(/^public/, "") } 
```

然后在你的`views/home/index.html.erb`：

```
<%= image_tag @images.select %> 
```

简单的。

# ios - 子视图不调整设备旋转

> ID：14217104
> 
> 赞同：2
> 
> 时间：2013-01-08T14:27:42.963
> 
> 标签：ios

我正在向我的视图添加一个子视图。一切正常。我的应用程序支持自动旋转。当我旋转我的设备时，我的父视图 shouldautorotate/willanimate 被调用，但子视图 shouldautorotate/willanimate 没有被调用。因此，我无法设置子视图的 UI 组件的位置。

```
viewController = [[abcController alloc] initWithNibName:@"abcController" bundle:nil];
[self.view addSubview:viewController.view]; 
```

任何指针都会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:35:02.317

那是因为您不能在功能上将视图从一个视图控制器添加到另一个视图控制器的视图树中，并期望第二个视图控制器获取消息。

你需要要么

1.  让您添加的视图成为您的第一个`UIViewController`（而不是第二个`UIViewController`）的一部分
2.  使用这些`addChildViewController`方法将第二个视图控制器添加为第一个视图控制器的子级（这将允许转发这些消息）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:32:04.280

您的视图缺少正确的自动调整大小设置：

```
viewController.view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; 
```

除此之外，如果您的意思是您`abcController`的 's`shouldautorotate/willanimate`没有被调用，那是正常行为。

您的主控制器应该实现某种包含逻辑并将其转发`shouldautorotate/willanimate`给您的控制器。即，您的主控制器可以调用`shouldautorotate/willanimate`您的`abcController`实例，但它应该知道它。顺便说一句，Apple 不建议这样做，但如果您想支持 iOS4，这是唯一的方法。

或者，您可以使用[UIViewController Containment](https://developer.apple.com/videos/wwdc/2011/?id=102) for iOS>5。

这诉诸于使用两种方法：

```
@interface UIViewController (UIContainerViewControllerProtectedMethods)

 - (void)addChildViewController:(UIViewController *)childController;
 - (void)removeFromParentViewController;

@end 
```

[在这里](http://www.cocoanetics.com/2012/04/containing-viewcontrollers/)你可以找到一个很好的教程。这不适用于 iOS4。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T14:38:00.210

为了让视图控制器接收 shouldautorotate/willanimate 调用，您需要它位于“视图层次结构”中。因此，如果您只是将其视图添加为子视图，这些方法将不会被调用，但是如果您将此视图控制器推送到导航控制器或将其呈现为模式视图控制器或使用 addChildViewController 方法（适用于 iOS 5+），视图控制器将收到这些消息。如果您只想将其视图添加为子视图，则可以使用 autoresizingMask。（但是我只是没有看到创建视图控制器的意义，而不仅仅是自定义视图）

# javascript - 为简单的jQuery轮播暂停悬停

> ID：14217106
> 
> 赞同：0
> 
> 时间：2013-01-08T14:27:49.593
> 
> 标签：javascript, jquery, hover, carousel

我在这里设置了一个超级简单的功能轮播示例：

[http://codepen.io/anon/full/myvAz](http://codepen.io/anon/full/myvAz)

问题是，我无法让轮播在悬停时停止旋转。

我什至无法在将鼠标悬停在包含的 div 上时发出警报，即使它具有设定的宽度和高度。但是，如果我将悬停部分粘贴到控制台中，我会收到警报。

与其他代码结合使用时，它似乎不会触发。

任何帮助将不胜感激

谢谢

继承人的代码：

```
<script>
// Main image carousel
$(document).ready(function(){
$("#headerMrS > div:gt(0)").hide();

var carouDiv = function(){
    setInterval(function() { 
      $('#headerMrS > div:first')
        .fadeOut(500)
        .next()
        .fadeIn(500)
        .end()
        .appendTo('#headerMrS');
    },  2000);
};

$(carouDiv());//Initialise the carousel function

$("#headerMrS").hover(function(){//Stop the carousel on hover
 $(this).stop;
  },function(){
  $(this).resume;
});

//Direction Arrow links
$(".button-sales").click(function(){
    $(".header").fadeOut(800);
    $(".sales").animate({opacity:"show"},800);
});
$(".button-modern").click(function(){
    $(".header").fadeOut(800);
    $(".modern").animate({opacity:"show"},800);
});
$(".button-antique").click(function(){
    $(".header").fadeOut(800);
    $(".antique").animate({opacity:"show"},800);
});
}); 
```

```
<style>

#headerMrS {position:relative; height:150px; width:350px}
.header {position:absolute; top:0; left:0}
</style>

<div id="headerMrS">
<div class="header sales active">
    <div class="header-content">
        <img src="http://placehold.it/350x150/4787ed/ffffff" alt="" />
        <div class="button-next button-antique">next</div>
        <div class="button-prev button-modern">prev</div>
    </div>
</div>
<div class="header antique">
    <div class="header-content">
        <img src="http://placehold.it/350x150/fc8a41/ffffff" alt="" />

        <div class="button-next button-modern">next</div>
        <div class="button-prev button-sales">prev</div>
    </div>
</div>
<div class="header modern">
    <div class="header-content">
        <img src="http://placehold.it/350x150/e7376b/ffffff" alt="" />

        <div class="button-next button-sales">next</div>
        <div class="button-prev button-antique">prev</div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:46:50.937

怎么用`clearInterval()`？

不是简单地调用`setInterval()`，而是将`setInterval()`函数分配给一个变量，下面我使用`carouselInt`. 这是调用`clearInterval()`. 要停止间隔，您将调用`clearInterval(carouselInt)`

根据我刚刚阅读的内容，`stop()`将停止当前动画，但您每 2 秒就有一个新动画。它对导致动画触发的 setInterval 没有明显影响。

您可以尝试以下方法。

```
var carouselInt = '';

var carouDiv = function(){
    carouselInt = setInterval(function() { 
      $('#headerMrS > div:first')
        .fadeOut(500)
        .next()
        .fadeIn(500)
        .end()
        .appendTo('#headerMrS');
    },  2000);
};

$(carouDiv());//Initialise the carousel function

$("#headerMrS").hover(function(){//Stop the carousel on hover
 clearInterval(carouselInt);
  },function(){
  carouDiv();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:36:10.817

似乎您在 HTML 的第 63 行附近有一个未关闭的脚本标签 - 这可能是问题吗？

# .net - 具有更改参数的递归函数与子函数-为什么一个更好

> ID：14217115
> 
> 赞同：0
> 
> 时间：2013-01-08T14:28:07.613
> 
> 标签：.net, vb.net, oop

昨天我问[了这个问题](https://stackoverflow.com/questions/14203240/passing-object-byref-into-sub-rather-than-using-a-function-is-this-bad-program)，关于使用递归子函数，传入的参数是实际所需的输出，并得到建议，而不是使用所需的输出作为返回值的递归函数。

这两个解决方案如下所示（在此示例中，要获取树视图中某个节点下的所有已检查节点，返回为`List(Of Treenode)`：

* * *

**递归子：**

```
Sub GetAllCheckedNodes(ByVal tn As TreeNode, ByVal NodesList As List(Of TreeNode))
    If tn.Checked Then NodesList.Add(tn)

    For Each nd As TreeNode In tn.Nodes
        GetAllCheckedNodes(nd, NodesList)
    Next
End Sub 
```

期望的输出将在哪里`NodesList`，因此使用如下：

```
Dim CheckedNodes as New List(Of Treenode)
GetAllCheckedNodes(MyTreeNode, CheckedNodes) 
```

在那个时间点，`Checkednodes`将被填充。

* * *

**递归函数：**

```
Function GetAllCheckedNodes(ByVal tn As TreeNode) As List(Of TreeNode)
    Dim RetVal As New List(Of TreeNode)

    If tn.Checked Then RetVal.Add(tn)

    For Each nd In tn.Nodes
        RetVal.AddRange(GetAllCheckedNodes(tv, nd))
    Next

   Return RetVal
End Function 
```

将按如下方式使用：

```
Dim CheckedNodes as List(Of Treenode) = GetAllCheckedNodes(MyTreeNode) 
```

* * *

所以我的问题是：

1.  显然，该功能似乎更容易理解，但从编程的角度来看，还有其他理由使用它吗？
2.  在递归函数中，您在`List(Of TreeNode)`每次迭代中声明一个新的，而您在 Sub 中使用相同的列表...这不会使 sub 更有效地使用内存吗？并且，如果是这样，是否有时会创建如上所示的递归子代码是更好的内存管理解决方案？还是从来没有？？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:53:00.850

所以 Function 对于调用代码来说更简单，而 Sub 表现更好。这样做可以两全其美：

```
Function GetAllCheckedNodes(ByVal tn As TreeNode) As List(Of TreeNode)
    Dim output As New List(of TreeNode)
    GetAllCheckedNodes(tn, output)
    Return output
End Function

Private Sub GetAllCheckedNodes(ByVal tn As TreeNode, ByVal NodesList As List(Of TreeNode))
    If tn.Checked Then NodesList.Add(tn)

    For Each nd As TreeNode In tn.Nodes
        GetAllCheckedNodes(nd, NodesList)
    Next
End Sub 
```

# php - 如何在 PHP 中将 Oracle SDO_GEOMETRY 转换为 KML 或 JSON

> ID：14217116
> 
> 赞同：-1
> 
> 时间：2013-01-08T14:28:06.793
> 
> 标签：php, oracle, openlayers, oracle-spatial

我在 Oracle 中有一个 SDO_GEOMETRY 格式的图层，我想在 Web 地图应用程序中显示它。我在 Oracle Spatial 开发人员指南 ( [http://docs.oracle.com/cd/B28359_01/appdev.111/b28400/sdo_util.htm#BJEFIFEF](http://docs.oracle.com/cd/B28359_01/appdev.111/b28400/sdo_util.htm#BJEFIFEF) ) 中找到了这个示例：

```
-- Convert cola_c geometry to a KML document; convert that result to
-- a spatial geometry.
DECLARE
  kmlgeom CLOB;
  val_result VARCHAR2(5);
  geom_result SDO_GEOMETRY;
  geom SDO_GEOMETRY;
BEGIN
SELECT c.shape INTO geom FROM cola_markets c WHERE c.name = 'cola_c';

-- To KML geometry
kmlgeom := SDO_UTIL.TO_KMLGEOMETRY(geom);
DBMS_OUTPUT.PUT_LINE('To KML geometry result = ' || TO_CHAR(kmlgeom));

-- From KML geometry
geom_result := SDO_UTIL.FROM_KMLGEOMETRY(kmlgeom);
-- Validate the returned geometry
val_result := SDO_GEOM.VALIDATE_GEOMETRY_WITH_CONTEXT(geom_result, 0.005);
DBMS_OUTPUT.PUT_LINE('Validation result = ' || val_result);

END;
/

To KML geometry result =
<Polygon><extrude>0</extrude><tessellate>0</tessellate><altitudeMode>relativeToG
round</altitudeMode><outerBoundaryIs><LinearRing><coordinates>3.0,3.0 6.0,3.0
6.0,5.0 4.0,5.0 3.0,3.0 </coordinates></LinearRing></outerBoundaryIs></Polygon>
Validation result = TRUE 
```

是否可以在 PHP 中使用 SDO_UTIL.TO.KMLGEOMETRY？

或者有没有其他方法可以在 web 地图应用程序中使用 SDO_GEOMETRY？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T22:55:48.327

该函数返回一个 CLOB，因此您应该没有理由不能只从 SELECT 语句中调用它并将结果作为字符串返回给 PHP。

# php - 在不知道文件类型的情况下删除文件

> ID：14217121
> 
> 赞同：0
> 
> 时间：2013-01-08T14:28:19.173
> 
> 标签：php, unlink

我可以在不知道 php 类型的情况下删除文件吗？我想做这样的事情：

```
unlink('../gallery/images/pic23.?) 
```

我该怎么做？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:29:38.653

您可以找到所有文件，[`glob()`](http://php.net/glob)然后单独删除它们，如下所示：

```
foreach( glob( '../gallery/images/pic23.*') as $file) {
    unlink( $file);
} 
```

# c++ - 在 Eclipse 中运行多个 Qt 测试

> ID：14217122
> 
> 赞同：2
> 
> 时间：2013-01-08T14:28:20.660
> 
> 标签：c++, qt, unit-testing, eclipse-cdt

我正在为一个大型 Qt (4.8.x) 项目设置测试，并希望在 Eclipse (JUNO) 中运行 qt 单元测试。因此我安装了 C/C++ 单元测试支持。我创建了一个子项目，其中包含 3 个类/文件中的 3 个测试用例。因为我能够构建一个测试应用程序，所以我添加了一个新的“运行配置”来选择“Qt Tests Runner”。

现在我可以在 Eclipse 中启动/运行测试，但 Eclipse 只显示一个类的结果，然后停止并出现错误：

> XML 解析错误:: 匹配“[xX][mM][lL]”的进程指令目标是不允许的

我使用 -xml 运行 Qt 测试二进制文件，发现应用程序输出是 3 个完整的 xml 文档而不是一个。我认为这就是问题所在，但我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T13:58:15.217

您是否有多个测试类从同一个可执行文件运行？据我所知，每次调用`QTest::qExec()`QTest 时都会将其视为完整的测试。

我认为他们使用 QTest 的目标是每个测试类都有一个可执行文件。我还没有找到解决这个问题的方法，但是你可以做 QTest 想要的（每个测试类一个可执行文件）或者切换到 googletest。

# php - 无 Cookie 跟踪

> ID：14217123
> 
> 赞同：0
> 
> 时间：2013-01-08T14:28:21.320
> 
> 标签：php, caching, cookies, tracking

我正在从事大学最后一年的项目，其中包括网站访问者跟踪（不是转换跟踪，因此服务器到服务器的回发跟踪不符合我的兴趣）。显然，使用 cookie 实现起来非常简单，但是作为后备，我想实现无 cookie 跟踪。我知道这不可靠，但我读过的文章已经过时了，所以也许事情已经改变了，有一些聪明的方法可以做到这一点。

我知道唯一可能使用的足迹是 UA 的组合（我可以存储浏览器更新信息，因为如果更新了 UA 标头将不匹配，所以我可以以某种方式找出同一个访问者刚刚更新了他的浏览器) 和 IP（可能还有时间戳？如果是这样呢？我应该查看哪些模式？），但我开始研究客户端数据缓存，这些缓存可以使用 AJAX 或其他替代方法发送到服务器。

我正在寻找的是可以帮助我建立这种跟踪系统的想法和技巧。

我会将每个访问者的个人资料存储在数据库中，以便我可以单独分析每个访问者。因此，在页面视图中，我将查找该访问者，如果他已经存在，我将继续存储链接到他的数据。

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:12:10.860

我实现了基于 IP 地址的基本跟踪，但由于它收集了所有其他信息（浏览器、操作系统、屏幕分辨率、颜色深度、闪存版本等），因此绝对可以通过这些数据的集合来定义用户点。

我倾向于存储原始数据，然后使用查询来执行分析以使其更快，但这取决于您是否需要存储在用户访问期间实际使用的其他信息。

# php - 为什么要通过 PHP heredoc 生成简单的 HTML？

> ID：14217124
> 
> 赞同：6
> 
> 时间：2013-01-08T14:28:21.990
> 
> 标签：php, html, heredoc

我继承了一个网站，我需要对其进行一些更改。与往常一样，在网站开发中有很多方法可以做事。然而，这个特定的网站让我感到困惑。所有的 html 都是通过 heredoc php 脚本提供的。但是，没有人做任何 php 处理。

例如（仅结构）index.php：

```
<?php
$html = <<<html

<html>
    <head></head>
    <body>
        {more simple HTML here.  No php processing to be done}
    </body>
</html>
html;
echo $html;
?> 
```

我了解 php，但我无法弄清楚为什么他们以这种方式生成页面，而不是在没有 php 变量处理的情况下简单地交付它。在我假设这个人不知道他们在做什么之前，我想我会问。有任何想法吗？

这是我在 StackOverflow 上的第一篇文章，因此也欢迎对论坛礼仪进行反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:31:43.943

这可能是因为他们打算在 HEREDOC 中使用 PHP 变量。您的示例没有这些，但我会冒险猜测它们在某些地方使用。从那里开始，我会想象 HEREDOC 在任何地方都使用以保持一致性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:33:56.143

heredocs 的原因可能是因为您不必在 heredoc 中转义引号或担心引号，而字符串文字您必须相应地管理引号。

尽管将 HTML 保存在单独的文件中或使用模板系统更为常见 - 通常这将是比 heredocs 或字符串文字更好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T16:52:02.960

PHP 文件已经是 HTML 中的模板文件。

将您的代码替换为：

```
<html>
    <head></head>
    <body>
        {more simple HTML here.  No php processing to be done}
    </body>
</html> 
```

只需在 PHP 文件的正文中包含`<?php`and之外`?>`的 HTML 即可返回 HTML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T16:58:02.420

您可能会花费数周的时间来尝试了解遗留开发人员的想法，而这只是在浪费时间。

我建议将代码重构为在这些情况下不需要 PHP 中的任何东西，做他们所做的事情没有任何好处，而且每次编辑它时都会给你带来不和谐的体验。

# php - PHP 类可以返回记录集吗

> ID：14217125
> 
> 赞同：0
> 
> 时间：2013-01-08T14:28:28.373
> 
> 标签：php, class, ms-access

我正在尝试为我的访问数据库连接创建一个类并返回一个记录集，然后使用 MoveNext() 遍历 RS。

```
class AccessDBConnection 
{ 
private $db; 
private $sql; 

function __construct($db, $sql) {

    $conn = new COM('ADODB.Connection') or exit('Cannot start ADO.');
    $conn->Open("DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=$db"); 

    $rs = $conn->Execute($sql);
    return $rs;

} 
```

采用：

```
function testclass () {
    $rs = new AccessDBConnection("e:\database.mdb", "SELECT StudentID, UserName FROM MyTable WHERE StudentID = 'BJxxxx'");

    while (!$rs->EOF) { 
        $SID =  $rs->Fields['StudentID']->Value; 
        $UN =  $rs->Fields['UserName']->Value;
            echo $SID . " -- CLASS TEST -- " . $UN . "<br>";
                $rs->MoveNext(); 
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:31:25.227

您不能从构造函数返回结果集。

创建一些分离的方法，比如`getRS`返回它。

```
class AccessDBConnection 
{
    private $conn;

    public function __construct($db) {

        $this->conn = new COM('ADODB.Connection') or exit('Cannot start ADO.');
        $this->conn->Open("DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=$db"); 

    }

    public function query($sql) {

        return $this->conn->Execute($sql);

    }

} 
```

用法：

```
function testclass () {
    $db = new AccessDBConnection("e:\database.mdb");
    $rs = $db->query("SELECT StudentID, UserName FROM MyTable WHERE StudentID = 'BJxxxx'");

    while (!$rs->EOF) { 
        $SID =  $rs->Fields['StudentID']->Value; 
        $UN =  $rs->Fields['UserName']->Value;
            echo $SID . " -- CLASS TEST -- " . $UN . "<br>";
                $rs->MoveNext(); 
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T14:35:55.420

构造函数不返回。所以调用：

```
$rs = new AccessDBConnection($db, $sql); 
```

不会产生记录集。

一些通用指针：

*   做的很少，`__construct`以便在您进行测试时更容易
*   创建一个类似于`public function connect()`执行连接的方法
*   创建用于执行查询和返回记录集的方法。

或者找到一个已经完成工作的包装类。重写轮子没有意义。

# c - c中的意外输出（指针）

> ID：14217126
> 
> 赞同：0
> 
> 时间：2013-01-08T14:28:37.943
> 
> 标签：c, output

有人可以指出这个错误

```
#include <stdio.h>
void modify (char*s,int x,int y)
{
    s[x]=s[y];
}
main()
{
   char* s = "random";
   modify(s,1,2);
} 
```

节目突然结束。我知道这可能是一个非常简单的问题，但我是 c 新手。谢谢 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T14:30:46.793

这是因为它在分配期间崩溃`modify`。原因是指针指向一个不能修改的常量字符串。

如果要修改字符串，可以将其声明为数组：

```
char s[] = "random"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:39:13.627

就是这样。我曾经遇到过同样的问题。你应该替换这一行：

```
 char *s = "random"; 
```

与以下一个：

```
char s[] = "random"; 
```

# c++ - C++如何删除两个相互引用的类指针

> ID：14217131
> 
> 赞同：0
> 
> 时间：2013-01-08T14:28:44.117
> 
> 标签：c++, pointers

我对 C++ 指针有疑问

我是 C# 和 VB.NET 程序员，但我最近已经转换为 C++，所以我不知何故是 C++ 新手

现在我正在写一个字幕编辑器，我有两个类一个字幕包含指向其所有行的指针列表的段落类

和包含指向其父段落的指针的字幕行类（当行发生更改时调用父级中的方法）

在字幕段落类中，当我删除指向子行的指针列表时，它们不会被删除

我通过在删除指针后尝试使用指针并调用一些函数来测试它，它们可以工作！

我还在 Ubuntu 中使用“系统监视器”来告诉我的应用程序在为指针分配空间之前和之后使用了多少内存，我发现在分配内存后它会增加，但在我删除指针后空间没有被释放

所以我有几个问题：
1-我可以有两个相互引用的类吗？
2-当我用引用替换两个类之一中的指针时，同样的问题仍然存在
3-如果我有两个类，每个类都相互引用，我该如何手动打破这个引用

我知道我可以使用共享指针或弱指针类，但我想先手动完成

这是我的两个类的示例，用于演示我的应用程序中的问题

```
#include <iostream>
#include <stdio.h>

class B;

class A
{
    public :
      void setB(B *b){_b = b;cout << "set B" << endl;}
      ~A();
    private:
    B *_b;

};
class B
{
    public :
        void setA(A *a){_a = a;cout << "set A" << endl;}
        ~B(){cout <<"B is dieing" << endl;/*delete _a;*/}
    private:
        A *_a;

};

A::~A(){cout << "A is dieing" << endl;delete _b;}

int main()
{
    getchar(); // two have some time to know how much memory does my application use before allocaing space for pointers

    A *a = new A;
    B *b = new B;

    a->setB(b);
    b->setA(a);

    getchar();// two have some time to know how much memory does my application use after deallocaing the space

    delete a;
    delete b;

    // but here,after deleting it, it's still there, not deleted! I can use it
    a->setB(b);

    getchar();
    return 0;
} 
```

提前致谢

亚瑟·索比

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:06:30.177

要回答您的问题“我可以有两个相互引用的类吗？”，答案显然是肯定的。但是你需要不断思考“谁拥有内存？这个指针什么时候有效？什么时候无效？我怎么知道它是否以及何时改变？”

在 C# 中，您永远不必关心，因为 .Net 框架中内置的引用计数和垃圾收集器会为您处理内存所有权和管理，并自动在正确的时间做正确的事情。在 C++ 中，考虑这些事情是程序员的责任。

在 C++ 中行之有效的方法是在拥有它们的上下文中分配堆栈上的对象。

```
int main()
{
    A a;
    B b;

    a.setB(&b);
    b.setA(&a);

    return(0);
} 
```

现在，当 main() 超出范围时， a 和 b 都将自动销毁。

这仍然会遇到您为自己创建的真正问题。A 类真的需要保留指向 B 的指针的副本吗？通常，A 在执行某个方法期间只需要对 B 的引用。与其保留副本，为什么不在需要时将其传递？

```
a.doesSomethingWithB(parm1, parm2, &b); 
```

这样 A 就没有与 B 的长期承诺。

保留任何东西的副本意味着副本可能与真实的东西不同步。这就是我们有“不要重复自己”规则（又名 DRY，又名单一定义规则）的原因。

在审查 C++ 代码时，我会寻找“new”运算符的实例，因为这告诉我开发人员将手动管理内存，这意味着他或她必须格外小心析构函数、指针、副本指针，管理生命周期，所有这些额外的东西都会使代码更加复杂。复杂的代码会导致错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:32:06.933

删除对象后，您可以使指针指向 NULL，这样您就不能再同时使用它们了。

当您释放堆中的内存空间时，块被认为是空闲的，因此它们将在任何进一步的内存分配时被覆盖。但如果没有，您仍然可以按照您所看到的那样使用它。但这显然不是一个好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T14:39:25.513

仅仅因为您删除 a 或删除 b 并不意味着指针更改为空。
看一下：[为什么不删除将其指针重置为 null](http://www.daniweb.com/software-development/cpp/threads/188538/why-doesnt-delete-reset-its-pointer-to-null#)
当您将存储在 a 中的地址传递给删除运算符时，请考虑一下。delete 释放内存地址，但不修改保存地址的变量。
一个好的策略是

```
delete a;
a = null; 
```

删除后引用对象是未定义的行为。

# ruby-on-rails - 我可以跨多个服务器协调 Chef 部署资源的回滚吗？

> ID：14217134
> 
> 赞同：3
> 
> 时间：2013-01-08T14:28:50.687
> 
> 标签：ruby-on-rails, chef-infra, continuous-deployment

我正在从 Capistrano 转移到 Chef 以部署 Rails 应用程序（使用[deploy_revision](http://docs.opscode.com/resource_deploy.html)），我不清楚最佳实践（或常见实践）的问题。通过谷歌搜索，我没有找到太多东西。

使用 Capistrano 和“推送”模型，在跨多个服务器部署应用程序时，可以直接识别何时出现部署失败并立即在所有服务器上回滚部署。Capistrano 还在每个应用服务器上建立了一个维护页面，然后不会关闭该维护页面，除非我已成功部署到所有服务器或回滚部署。

使用 Chef 和“拉”模型，每台服务器可能会在稍有不同的时间获取其更新。我可能会比应用程序服务器提前几分钟更新应用程序代码并运行数据库迁移。所以我真的没有很好的方法来识别故障并确保构建回滚到最后一个成功部署的版本（在所有服务器上）。

我知道我在这里有一些选择：

1.  不要守护厨师客户端。使用 cron 每晚或每小时运行一次。（如果有些服务器成功并且只有一个遇到问题，我仍然无法回滚我的所有服务器。）
2.  不要守护厨师客户端。不要使用 deploy_revision。通过[knife ssh](http://docs.opscode.com/knife_ssh.html)或[capistrano-chef](https://github.com/cramerdev/capistrano-chef)运行它。（我现在回到“推”模型而不是“拉”模型，这是 Chef 吸引力的一部分。）
3.  守护厨师客户并编写相互交谈的自定义食谱。（对此不感兴趣。）
4.  放松。别担心。让错误发生，然后修复它们。（这里也不激动。）

我可以开始构建其中任何一个，但在我投入大量时间构建之前，我希望了解在该领域的大型部署中什么是有效的。你做了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T05:56:18.913

Pull 适用于解决[配置漂移](http://kief.com/configuration-drift.html)问题。对于按需部署（和潜在的回滚），推送更好。看看这些（我没用过）：

[https://github.com/etsy/deployinator](https://github.com/etsy/deployinator)

[http://www.rackspace.com/blog/rackspace-open-sources-dreadnot/](http://www.rackspace.com/blog/rackspace-open-sources-dreadnot/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:02:56.557

我已经通过 Chef 的 deploy_revision 策略部署了 ROR 应用程序并取得了一些成功。要克服拉取策略的时序控制限制，最简单的方法是编写一个部署脚本，归结为：

*   停止 chef-client（以确保守护进程不处理事情）
*   手动运行 chef-client（这也将重新启动守护进程）

或者，如果您很懒惰，只需运行`chef-client`，不要担心守护程序。

然后用于`knife-ssh`在适用的节点上执行这些命令。最终结果是您的所有与部署相关的配置都由厨师管理，但您可以根据需要启动部署。

对于奖励积分，将所有这些打包在 Jenkins 任务中。您需要将 jenks 配置为 Chef 客户端，并在您的应用程序项目中执行“部署到暂存”任务。现在您可以单击运行任务，您的不会说厨师的队​​友可以轻松地进行部署。为了获得更多奖励积分，设置 jenkins 以在成功构建后自动部署！

# jquery - asp.net 拨号代码下拉菜单

> ID：14217142
> 
> 赞同：0
> 
> 时间：2013-01-08T14:29:35.070
> 
> 标签：jquery, asp.net, asp.net-mvc

我需要带有标志的国际拨号代码下拉控件代码。是否有任何 asp.net 免费或高级控件？或者我可以与 asp.net mvc 一起使用的任何 html 控件/代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-04T15:29:18.233

你用 jquery 标记了你的问题，所以我会提到我的 jQuery 插件，它可以做到这一点：[https ://github.com/Bluefieldscom/intl-tel-input](https://github.com/Bluefieldscom/intl-tel-input)

它与 asp.net 无关，但也不必如此。

# class - 如何将类之间的依赖关系管理到咖啡脚本项目中

> ID：14217145
> 
> 赞同：3
> 
> 时间：2013-01-08T14:29:37.043
> 
> 标签：class, coffeescript, dependencies

有**样本**：

*   B类

*   A 类扩展 B 类

**命令**：coffee -w -j main.js -c -l -o lib src

**错误**：未捕获的类型错误：无法读取未定义的属性“原型”

**原因**：在编译文件中，ClassA 在 B 之前编译，因此在创建 ClassA 并尝试扩展它时，classB 还不存在。

**愚蠢的修复**：ClassA重命名为ClassC，所以在编译文件中会在ClassB之后编译

有人得到更好的修复？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:57:19.253

如[咖啡脚本文档](http://coffeescript.org/#usage)所述：

> -j, --join [FILE]
> 在编译之前，将所有脚本按照它们传递的顺序连接在一起，并将它们写入指定的文件。对于构建大型项目很有用。

这意味着您必须以正确的顺序传递脚本。假设 classA 在文件 classA.coffee 中，而 classB 在文件 classB.coffee 中，上面的命令应该是：

```
coffee -w -j main.js -c -l -o lib src/classB.coffee src/classA.coffee 
```

# ruby - 如何扩展 rspec 模拟期望？

> ID：14217148
> 
> 赞同：0
> 
> 时间：2013-01-08T14:29:46.047
> 
> 标签：ruby, rspec

如果参数是一种异常，我想扩展`and_return`方法以引发异常。例如

```
obj.stub(:meth).and_return(SomeException,"message") 
```

这种构造应该在第一次调用时引发异常，并在第二次调用时返回字符串。

如何通过这种方法扩展 rspec，是否有此类任务的指南？

更新：

此函数的一般表示法可以是：

```
and_return_or_raise(list of arguments or/and exceptions) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:24:37.007

怎么样

```
stuff = [SomeException, "message"]
obj.stub(:meth).and_return do
  i = stuff.shift
  if i.respond_to?(:downcase)
    i
  else
    raise i
  end
end 
```

当然不是最漂亮的方式，但应该在您的特定情况下完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:20:39.760

所以，返回多个值的实际业务是在类中的[这个方法](https://github.com/rspec/rspec-mocks/blob/master/lib/rspec/mocks/message_expectation.rb#L440-L443)中`RSpec::Mocks::MessageExpectation`：

```
def call_implementation_consecutive(*args, &block)
  @value ||= call_implementation(*args, &block)
  @value[[@actual_received_count, @value.size-1].min]
end 
```

基本上，`call_implementation`返回您传递给的预期返回值列表`and_return`，并且此方法挑选出与当前调用相对应的那个（如果我们调用该方法的次数多于列表中的值，则返回最后一个值）。

所以，要做你想做的事，你可以猴子修补这个方法，如下所示：

```
class RSpec::Mocks::MessageExpectation
  alias_method :old_call_implementation_consecutive, :call_implementation_consecutive

  def call_implementation_consecutive(*args, &block)
    old_call_implementation_consecutive(*args, &block).tap do |value|
      raise value if value.is_a?(Class) && value < Exception
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T17:23:40.883

你不需要扩展任何东西——只需使用 RSpec 的内置错误匹配器并接收计数：

```
class Foobar
  def foo
    bar
  end
end

it "raises the first time, then returns a string" do
  obj = Foobar.new
  obj.should_receive(:bar).once.and_raise(StandardError)
  obj.should_receive(:bar).once.and_return("message")
  expect { obj.foo }.to raise_error(StandardError)
  obj.foo.should == "message"
end 
```

# jquery - 带有标签/自动完成列的 jQuery Grid

> ID：14217149
> 
> 赞同：0
> 
> 时间：2013-01-08T14:29:47.810
> 
> 标签：jquery, datagrid

我正在寻找一个允许具有“标签”可编辑列的 jQuery 网格。我的标签取自可能值列表（以 json 形式出现）。

我基本上是在查看这个[用于 ASP.NET MVC 的后网格控件中的组件？](https://stackoverflow.com/questions/177275/grid-controls-for-asp-net-mvc)和更多。

我接近使用[jqxGrid](http://www.jqwidgets.com/jquery-widgets-demo/demos/jqxgrid/index.htm#demos/jqxgrid/defaultfunctionality.htm "jqx网格")和标签库的一些实现，因为 jqxGrid 允许为列呈现我自己的值 - 但是，我有很多冲突。这篇文章不是为了解决这样的冲突（我仍在尝试这样做）——它是为了知道是否有一个支持内置该功能的 jQuery 网格。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T13:34:02.273

我还没有看到比 DataTables 更好的 jquery 网格。检查 www.datatables.net

# php - 如何计算 PHP 中多维数组中特定键的值？

> ID：14217150
> 
> 赞同：1
> 
> 时间：2013-01-08T14:29:49.033
> 
> 标签：php, arrays, multidimensional-array

我有一个看起来像这样的数组：

> Array(
> [0] => Array([city] => 309[store] => 12[apples] => 21[oranges] => 14[lichis] => 34)
> [1] => Array([city] => 309[store] => 13[apples] => 0[oranges] => 11[lichis] => 32)
> [2] => Array([city] => 309[store] => 14[apples] => 44[橙子] => 61[lichis] => 0)
> [3] => Array([city] => 309[store] => 15[apples] => 7[oranges] => 0[lichis] => 6)
> [4] => Array([city] => 309[store] => 16[apples] => 0[oranges] => 0[lichis] => 12) )

我需要在这里做两件事：
1\. 获取城市中所有特定水果的数量（即 309 城市总共有多少苹果、橙子、荔枝）和
2\. 我如何获取 a 的值具体店铺？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:48:30.290

好吧，说这个数组叫做 $store

```
$count = 0;
$s = array();

foreach($store as $store){
 $count = 0;
 $count += $store['apples'];
 $count += $store['oranges'];

 $s[$store['store']] = $count;
} 
```

如果需要，可以添加更多水果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:02:54.283

This is a more complicated example, but better than spaghetti code. Turn your array into XML first.

```
// this is your initial array
$my_array = array(
array("city"=>309, "store"=>12, "apples"=>21, "oranges"=>14, "lichis"=>34 ),
array("city"=>309, "store"=>13, "apples"=>0, "oranges"=>11, "lichis"=>32 ),
array("city"=>309, "store"=>14, "apples"=>44, "oranges"=>61, "lichis"=>0 ),
array("city"=>309, "store"=>15, "apples"=>7, "oranges"=>0, "lichis"=>6 ),
array("city"=>309, "store"=>16, "apples"=>0, "oranges"=>0, "lichis"=>12 ),
); 
```

Writing spaghetti code to manually isolate stores becomes a messy jungle of if statements and loops.

```
// might as well convert it to xml
function array_to_xml( $data ) {
    $xml = "<xml>\n";
    foreach( $data as $row ) {
        $xml .= "<entry>";
        foreach( $row as $k => $v ) {
            $xml .= "<{$k}>{$v}</{$k}>";
        }
        $xml .= "</entry>\n";
    }
    $xml .= "</xml>\n";
    return( $xml );
} 
```

At this point, `$xml` looks like this (as a string) and is more manageable:

```
<xml>
  <entry>
    <city>309</city>
    <store>12</store>
    <apples>21</apples>
    <oranges>14</oranges>
    <lichis>34</lichis>
  </entry>
  ...(more entries)...
</xml> 
```

Now, load it into something queriable with XPath, an XML standard:

```
$xml = simplexml_load_string( array_to_xml( $my_array ) ); 
```

To get the count of all the specific fruits in the city (i.e. how many apples, oranges, lichies are there in total in city 309) we need a simple but reusable summary function.

```
// so lets make a generic function to count specific items
function count_items( $stores, $items = array() ) {
    $sum = array();
    foreach( $stores as $store ) {
        foreach( $items as $k ) {
            if( !isset( $sum[$k] ) ) $sum[$k] = 0;
            $sum[$k] += $store->$k;
        }
    }
    return( $sum );
} 
```

We only want city 309, and looking specifically for apples, oranges and lichis, since they are fruits:

```
$only_this_city = $xml->xpath("//entry[city=309]");
print_r( count_items( $only_this_city, array("apples", "oranges", "lichis")) ); 
```

We get this:

```
Array
(
    [apples] => 72
    [oranges] => 86
    [lichis] => 84
) 
```

Secondly, to grab the values for a specific store:

```
$only_this_store = $xml->xpath("//entry[city=309 and store=14]");
print_r( count_items( $only_this_store, array("apples") ) ); 
```

You get:

```
Array
(
    [apples] => 44
) 
```

Obviously you can request more items, or query with more complexity. Look up some docs on XPath for future queries.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T16:46:58.127

```
function extractData( array $data, $store = null )
{
    $callback = function( $values, $array ) use ( $store )
    {
        // We require values for a particular store
        if( ! is_null( $store ) )
        {
            if( $array[ 'store' ] == $store )
            {
                return $array;
            }

            return false;
        }
        // Return the sum of all stores in a city
        else
        {
            // Toss out the city and store values since they're not needed
            unset( $array['city'], $array['store'] );

            // Seed the initial values
            if( ! is_array( $values ) || empty( $values ) )
            {
                return $array;
            }

            // array_map function used add the arrays
            $add = function( $a, $b )
            {
                return $a + $b;
            };

            // Add the arrays
            $summedArray = array_map( $add, $values, $array );

            // Return the combined array structure
            return array_combine( array_keys( $values ), $summedArray );
        }
    };

    return array_reduce( $data, $callback, array() );
}

$data = array(
    0 => array(
        "city" => 309,
        "store" => 12,
        "apples" => 21,
        "oranges" => 14,
        "lichis" => 34
    ),
    1 => array(
        "city" => 309,
        "store" => 13,
        "apples" => 0,
        "oranges" => 11,
        "lichis" => 32
    ),
    2 => array(
        "city" => 309,
        "store" => 14,
        "apples" => 44,
        "oranges" => 61,
        "lichis" => 0
    ),
    3 => array(
        "city" => 309,
        "store" => 15,
        "apples" => 7,
        "oranges" => 0,
        "lichis" => 6
    ),
    4 => array(
        "city" => 309,
        "store" => 16,
        "apples" => 0,
        "oranges" => 0,
        "lichis" => 12
    )
);

// Return the values for a particular store
print_r( extractData( $data, 16 ) );

// Return the total of all stores in the city
print_r( extractData( $data ) ); 
```

这将产生以下结果......

**单一城市**

```
Array
(
    [city] => 309
    [store] => 16
    [apples] => 0
    [oranges] => 0
    [lichis] => 12
) 
```

**总计**

```
Array
(
    [apples] => 72
    [oranges] => 86
    [lichis] => 84
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T20:37:32.740

> **注意：**在做出任何反应之前……我知道 OP 没有询问如何以面向对象的方式处理这个问题，所以这只是一个建议。

我将为整体数据创建一个单独的类，并为每个商店数据创建另一个类。

```
$arr = array(
    array('city' => 309, 'store' => 12, 'apples' => 21, 'oranges' => 14, 'lichis' => 34),
    array('city' => 309, 'store' => 13, 'apples' => 0, 'oranges' => 11, 'lichis' => 32),
    array('city' => 309, 'store' => 14, 'apples' => 44, 'oranges' => 61, 'lichis' => 0),
    array('city' => 309, 'store' => 15, 'apples' => 7, 'oranges' => 0, 'lichis' => 6),
    array('city' => 309, 'store' => 16, 'apples' => 0, 'oranges' => 0, 'lichis' => 12)
);

foreach ($arr as $rec) {
    $storeID = $rec['store'];
    $city = $rec['city'];
    unset($rec['city'],$rec['store']);
    // assuming all the keys except these 2
    // represent product name->quantity pairs
    StoreData::add(new Store($storeID,$city,$rec));
}
//print_r(StoreData::$stores);

echo
'<b>total products:</b> ' .
    StoreData::get_total_products() . PHP_EOL .
'<b>total products in city #309:</b> ' .
    StoreData::get_total_products_by_city(309) . PHP_EOL .
'<b>"apples" everywhere:</b> ' .
    StoreData::get_product_total('apples') . PHP_EOL .
'<b>"apples" in store #12:</b> ' .
    StoreData::get_product_total_by_store('apples',12) . PHP_EOL .
'<b>"apples" in city #309:</b> ' .
    StoreData::get_product_total_by_city('apples',309);

class StoreData {

    public static $stores = array();

    public static function add(Store $store) {
        self::$stores[] = $store;
    }

    public static function remove(Store $store) {
        foreach (self::$stores as $key => $value) {
            if ($value == $store) {
                unset(self::$stores[$key]);
                break;
            }
        }
    }

    public static function find_by_city($cityID) {
        $cityID = (int) $cityID;
        return array_filter(self::$stores,create_function(
            '$store',
            "return \$store->city == $cityID;")
        );
    }

    public static function find_by_store($storeID) {
        $storeID = (int) $storeID;
        foreach (self::$stores as $store) {
            if ($store->id == $storeID) return $store;
        }
        return FALSE;
    }

    public static function get_total_products() {
        $total = 0;
        foreach (self::$stores as $store)
            $total += $store->get_total_products();
        return $total;
    }

    public static function get_total_products_by_city($city) {
        $stores = self::find_by_city((int) $city);
        $total = 0;
        foreach ($stores as $store)
            $total += $store->get_total_products();
        return $total;
    }

    public static function get_product_total_by_city($productName,$city) {
        return self::product_total($productName,self::find_by_city((int) $city));
    }

    public static function get_product_total_by_store($productName,$storeID) {
        $res = self::find_by_store((int) $storeID);
        return $res ? self::product_total($productName,array($res)) : $res;
    }

    public static function get_product_total($productName) {
        return self::product_total($productName,self::$stores);
    }

    private static function product_total($productName,$stores=NULL) {
        $total = 0;
        foreach ($stores as $store)
            $total += $store->get_product_total($productName);
        return $total;
    }

}

class Store {

    public $id;
    public $city;
    public $products;

    function __construct($id,$city,$products=array()) {
        $this->id = $id;
        $this->city = $city;
        $this->products = $products;
    }

    public function get_total_products() {
        return array_sum($this->products);
    }

    public function get_product_total($productName) {
        if (isset($this->products[$productName]))
            return (int) $this->products[$productName];
        return 0;
    }

} 
```

将输出

> **总产品：** 242
> **城市总产品 #309：** 242
> **“苹果”无处不在：** 72
> **“苹果”在商店 #12：** 21
> **“苹果”在城市 #309：** 72

# c# - 设计模式以防止未分配的对象

> ID：14217152
> 
> 赞同：10
> 
> 时间：2013-01-08T14:29:53.993
> 
> 标签：c#, design-patterns, resharper, instantiation

我经常收到一些关于“使用‘新’表达式创建的未分配对象”的更清晰的警告。以下代码片段将演示这种情况：

我正在使用一个助手类（`Observer.cs`），它监视其他类（`MonitoredClass.cs`）的一些属性。当一个属性改变时，观察者类将改变的值写入另一个数据类（`DataClass.cs`）。

简化的代码被剪断：

监控类.cs：

```
public class MonitoredClass : INotifyPropertyChanged
{
   // simplified: in fact property calls OnPropertyChange(..)
   public string Property1 { get; set; }
} 
```

数据类.cs：

```
public class DataClass
{
   public string LastProperty1Value { get; set; }
} 
```

观察者.cs：

```
public class Observer
{
   private MonitoredClass _monitoredClass;
   private DataClass _dataClass;
   public Observer(MonitoredClass monitoredClass, DataClass dataClass)
   {
      _monitoredClass = monitoredClass;
      _dataClass = dataClass;
      _monitoredClass.PropertyChanged+=MonitoredClassPropertyChanged;
   }

   private void MonitoredClassPropertyChanged(..)
   {
      _dataClass.LastProperty1Value = _monitoredClass.Property1;
   }
} 
```

到现在为止还挺好。

如果我现在使用上面的 Observer 类，如下所示：

```
...
new Observer(monitoredClassInstance, dataClassInstance);
... 
```

比我得到一个更清晰的警告“可能由'new'表达式创建的未分配对象”。

我现在的问题是，是否有更好的解决方案/模式来设计这个观察者。粗略地说，我可以将新的观察者实例分配给一个私有字段。但比我有一个从未使用过的字段。或者我可以设置带属性的监控类实例和数据类实例，而不是在构造函数中传递它们。但这只是防止警告，实际上并没有改变架构。

提前感谢您的建议、意见、模式等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-08T14:40:21.497

它可能很好。当然，它之所以有效，是因为您附加了一个事件处理程序，从而将 Observer 的生命周期与 MonitoredClass 的生命周期联系起来。如果您没有附加事件处理程序，那么 Observer 将没有对它的引用，并且它（最终）将被垃圾收集。

考虑一下，因此将构造函数设为私有并编写公共静态工厂方法来创建它可能会更清楚：

```
public class Observer
{
    private MonitoredClass _monitoredClass;
    private DataClass _dataClass;

    public static void Observe(MonitoredClass monitoredClass, DataClass dataClass)
    {
        new Observer(monitoredClass, dataClass);
    }

    private Observer(MonitoredClass monitoredClass, DataClass dataClass)
    {
        _monitoredClass = monitoredClass;
        _dataClass = dataClass;
        _monitoredClass.PropertyChanged+=MonitoredClassPropertyChanged;
    }

    private void MonitoredClassPropertyChanged(..)
    {
        _dataClass.LastProperty1Value = _monitoredClass.Property1;
    }
} 
```

然后你可以在 Observe() 中抑制警告，调用它的人就不用担心了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T14:37:58.910

```
public class Observer
{
 private MonitoredClass _monitoredClass;
 private DataClass _dataClass;

 public void Setup(MonitoredClass monitoredClass, DataClass dataClass)
 {
    _monitoredClass = monitoredClass;
    _dataClass = dataClass;
    _monitoredClass.PropertyChanged+=MonitoredClassPropertyChanged;
 }

 private void MonitoredClassPropertyChanged(..)
 {
    _dataClass.LastProperty1Value = _monitoredClass.Property1;
 }
} 
```

和

```
Observer o = new Observer();
o.Setup( foo, bar ); 
```

这不仅会阻止警告，还会让您更改以在观察者上实现其他方法，例如

```
 public void Close()
 {
    _monitoredClass.PropertyChanged-=MonitoredClassPropertyChanged;
 } 
```

如果您想以明确的方式控制退订。

# c# - 如何在 C# 中编写防火墙自动登录应用程序

> ID：14217155
> 
> 赞同：2
> 
> 时间：2013-01-08T14:29:57.347
> 
> 标签：c#, authentication, cookies, httpwebrequest

在我的工作日中，我需要通过我们内部网上的大约 90,000 个防火墙进行身份验证，并且还需要在家中通过 vpn 进行身份验证，我想知道自动化该过程有多容易。我想使用 c#，并想出了这样的东西（这不起作用）。

```
...
System.Net.HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(url);
request.Proxy.Credentials = request.Credentials = new NetworkCredential("someusername", "somepass");
request.PreAuthenticate = true;
request.KeepAlive = true;
request.Timeout = 10 * 1000;
var response = request.GetResponse();
... 
```

此代码似乎可以正常工作，无论如何我都会得到正确的响应详细信息，但是如果我尝试在我的网络浏览器中访问网页，我仍然会被要求登录。

如何保留连接/身份验证详细信息？饼干？还是我这样做完全错了？

附言。我知道我可以让应用程序执行此操作，但我想自己执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:37:07.280

这取决于防火墙 Web 界面中使用的身份验证机制。
重要的是您必须在防火墙 Web 界面上登录并创建一个会话，之后您可以在浏览器中使用该会话。您可以尝试找出您的会话密钥（POST、GET、Cookie 等）并尝试将其从您的 c# Web 响应“传输”到您的浏览器。但是正如亚历克斯已经指出的那样，如果这有效，您应该考虑使用另一个防火墙；）

为了获得如此出色的 Admin-Helper-Tool，我会尝试在您的应用程序中使用 WebBrowser 控件并使用此“框架浏览器”自动登录到您的防火墙 Web 应用程序。类似的东西也应该适用于防火墙 Web 界面： http: [//www.codegain.com/articles/csharp/utilities/automating-facebook-login-using-webbrowser-control-in-csharp.aspx](http://www.codegain.com/articles/csharp/utilities/automating-facebook-login-using-webbrowser-control-in-csharp.aspx)

# autocomplete - Geocoder v3 自动完成酒店

> ID：14217156
> 
> 赞同：0
> 
> 时间：2013-01-08T14:30:01.430
> 
> 标签：autocomplete, geocode

我们正在运营一个网站 (www.taxileader.net/taxi-tegel.html)，人们可以在其中预订从机场到目的地的出租车。

要预订和计算通常是机场的起始地址（我们的数据库中已经存在纬度/经度）与其目的地之间的距离，我们使用谷歌地图 v3

在“目的地字段”中，我们已经有一个自动完成功能，可以从客户所写的地址中提取邮政编码（或邮政编码），但我们还需要他们找到酒店的邮政编码。

我们用来获取地址信息的 API 调用是 geocoder v3，这是错误的，还是我们必须添加其他东西才能找到酒店？

```
$("#txt_indirizzo").autocomplete({
    //This bit uses the geocoder to fetch address values
    source : function(request, response) {
        geocoder.geocode({
            'address' : request.term,
            'bounds' : bound
        }, function(results, status) {
            response($.map(results, function(item) {
                var zip = '';
                for (var i in item.address_components) {
                    if (item.address_components[i].types[0] == 'postal_code' || item.address_components[i].types[1] == 'postal_code') {
                        zip = item.address_components[i].long_name;
                    }
                }
                if (zip == '') {
                    return;
                } else {
                    return {
                        value : item.formatted_address,
                        latitude : item.geometry.location.lat(),
                        longitude : item.geometry.location.lng(),
                        zip : zip
                    }
                }

            }));
        })
    },
    //This bit is executed upon selection of an address
    select : function(event, ui){
        if (tipoDiTrasf == 2) {
            return;
        }

        chk_txt_indirizzo = true;
        if (ui.item.zip != '') {

            chkPostcode(ui.item.zip, ui.item.latitude, ui.item.longitude, ui.item.value, '#txt_indirizzo');

        } else {
            alert('Questo non è un indirizzo valido');
            setTimeout('$("#txt_indirizzo").val("")', 5);
        }
        tab(1);
    },
    change : function() {
        if (!chk_txt_indirizzo) {
            $("#txt_indirizzo").val('').data("autocomplete").term = "";
            zip_indirizzo = pointLat2 = pointLon2 = setIndirizzo = false;
            putondinNam();

        }
    }
}); 
```

至少有没有办法让谷歌地图只自动完成到城市？

我的意思是在“城市字段”中，我们只想显示城市而不是地址

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:13:55.403

也许，这些地方可以帮助你？

[与 bing/google 地理编码集成的位置搜索自动完成功能](https://stackoverflow.com/questions/1323661/location-search-autocomplete-that-integrates-with-bing-google-geocoding)

[http://gerger.co/blog/2011/02/17/google-maps-api-v3-location-search-with-jquery-autocomplete-plugin/](http://gerger.co/blog/2011/02/17/google-maps-api-v3-location-search-with-jquery-autocomplete-plugin/)

[http://gmap3.net/en/pages/19-demo/](http://gmap3.net/en/pages/19-demo/)

[https://google-developers.appspot.com/maps/documentation/javascript/examples/places-autocomplete](https://google-developers.appspot.com/maps/documentation/javascript/examples/places-autocomplete)

# c++ - 如何判断双精度浮点数是否可以安全地存储为单精度浮点数？

> ID：14217161
> 
> 赞同：4
> 
> 时间：2013-01-08T14:30:12.623
> 
> 标签：c++, c, floating-point

> **可能重复：**
> [实数 - 如何确定是否需要浮点数或双精度数？](https://stackoverflow.com/questions/13620481/real-numbers-how-to-determine-whether-float-or-double-is-required)

我正在尝试检查从 double 到 float 的转换是否会导致精度损失。显然，我可以进行转换并将浮点数转换回双精度并将其与原始值进行比较。我很好奇是否有更直接的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-08T14:31:59.170

转换为浮点数并返回通常是最有效的解决方案；在最常见的架构上，它只需要几个指令，每个指令都有几个周期的延迟。这也具有既简单又正确的优点。

在没有硬件支持浮点的平台上，您可以通过拆分数字并检查指数和有效数字是否适合单精度来更有效地进行检查，但这是一个相对不常见的极端情况，并且这更容易出错，并且不能移植到使用不同 FP 格式的平台上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:14:27.287

浮点数有两部分，尾数和指数。double 有更多的位分配给两个部分。将 double 分配给 float 会丢弃尾数位，这会降低精度，这是意料之中的。但是，如果双指数不适合浮点指数，那么浮点数将是一个垃圾值。

# joomla - 清理joomla中的输入

> ID：14217164
> 
> 赞同：2
> 
> 时间：2013-01-08T14:30:24.017
> 
> 标签：joomla, joomla2.5, joomla-extensions, joomla-component

我的 Joomla 插件中有这样的代码：

```
$some_id = $_GET["someid"];

$db = JFactory::getDBO();
$db->setQuery("SELECT * FROM #__table WHERE id = '$some_id'");

$result = $db->loadRow(); 
```

Joomla 会自动清理这个，还是我需要做一些事情（以及什么）来清理这个查询？使用 Joomla 2.5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T16:08:55.247

使用 Joomla 时无需清理数据库查询。您正在拉下的信息是已经放在那里或已经放在那里的信息，因此您不想更改。我还建议使用 Joomla 2.5 编码标准来进行数据库查询，如下所示：

```
$db = JFactory::getDbo();
$query = $db->getQuery(true);
$query->select($db->quoteName('*'))
      ->from($db->quoteName('#__table'))
      ->where($db->quoteName('id') . ' = ' . $db->quote($some_id));
$db->setQuery($query);
$rows = $db->loadRow(); //or loadResult() 
```

我唯一需要对某些东西进行清理（可以这么说）是在处理文件时，在这种情况下我使用了`JFile::makeSafe();`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T16:13:24.977

看看 JInput 和这个[相应的文档](http://docs.joomla.org/Retrieving_request_data_using_JInput)

过滤器示例：

```
$jinput = JFactory::getApplication()->input;
$some_id = $jinput->get('someid', '', 'string'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T16:26:34.587

请看看你会得到你的答案

安全编码指南

[http://docs.joomla.org/Secure_coding_guidelines](http://docs.joomla.org/Secure_coding_guidelines)

# algorithm - 调度算法

> ID：14217167
> 
> 赞同：-1
> 
> 时间：2013-01-08T14:30:28.887
> 
> 标签：algorithm, scheduling

我在考试中有一个问题，我不知道如何回答：

假设您有一台供个人使用的机器，并且您正在开发各种程序。在去吃午饭之前你想留下五个大程序来编译。在这种情况下，证明以下调度算法将选择什么/哪个是合理的：先到先服务、最短作业优先、循环或优先调度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T11:01:47.043

老实说，我选择`Shortest Job First`的原因很简单，当我吃完午饭回来时，我希望有尽可能多的程序可供调试和测试。

# ios - 无法将 UIViewController IBOutlets 与 StoryBoard 链接

> ID：14217182
> 
> 赞同：2
> 
> 时间：2013-01-08T14:30:52.710
> 
> 标签：ios, xcode, uiviewcontroller, storyboard, iboutlet

我在情节提要中有两个 UIViewController（A 和 B）。A 视图控制器有一个属性

```
@property (nonatomic, retain) IBOutlet UIViewController *viewController; 
```

我想通过情节提要链接到 B.

出口显示在故事板菜单的 IBOutlets 部分下，但我无法链接。为什么我要这样做似乎很奇怪，但我需要它。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T14:43:18.417

IBOutlets 是单个视图控制器中的连接。在视图控制器中创建对对象的引用，以便您可以在代码中使用这些对象。

您不能从一个视图控制器创建 IBOutlets 到另一个视图控制器。属性是正确的方法，但您必须在代码中分配属性。通常，当一个视图控制器创建另一个视图控制器时，它可能会设置对自身的引用。

```
OtherViewController *otherViewController = [OtherViewController alloc] init];
otherViewController.masterViewController = self;
// at this point "otherViewController" has a reference to the current view controller 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:05:21.563

现在我明白我需要做什么了。我需要创建一个[自定义 segue](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomSegues/CreatingCustomSegues.html)以实现与将 UINavigationController 链接到其他 ViewController 并标记为 RootViewController 时相同的结果。它是由 segue 而不是 IBOutlet 完成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-05T22:13:12.973

我参加聚会有点晚了，但是我组织了一个 segue 课程来帮助完成这项工作。查看 git 存储库以查看正在运行的类：[https](https://github.com/datinc/DATOutletSegue) ://github.com/datinc/DATOutletSegue 。

基本上它使用 segue 的标识符连接到父控制器

# c - 按规则填充二维数组

> ID：14217187
> 
> 赞同：1
> 
> 时间：2013-01-08T14:30:56.653
> 
> 标签：c, arrays, matrix

如何填充这样的数组：

> 1 2 3 4
> 2 3 4 3
> 3 4 3 2
> 4 3 2 1

我需要找出一个公式来确定填充这个数组的模式。

```
#include <stdio.h>
#define N 4

int main()
{
int i,j,arr[N][N];
int a=1;
for(i=0;i<N;i++)
    for(j=0;j<N;j++)
    {
        arr[j][i]=i+j+1;
    }
for(i=0; i < N; i++)

    for(j=0;j<N;j++)
        printf("%2i ",arr[j][i]);
        printf("\n"); 

 return 0;
} 
```

它的打印结果与所需的数组类似，除了我在第二行的末尾需要“3”，在那之后，它会反转。请解释一下我该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:35:01.903

尝试这个：

```
 arr[j][i]=N-abs(i+j-(N-1)); 
```

`abs()`可以在您需要围绕某个值镜像的数字序列的任何时候使用。您只需减去一个常数，使您想要镜像的值为零，取绝对值，然后重新调整输出。

在您的情况下（N = 4），`(i+j)`总和产生：0,1,2,3,4,5,6。中间值为 N-1，因为最大值为 2 * (N-1)。

减去 N-1 (3) 得到：-3,-2,-1,0,1,2,3。

`abs()`给出：3,2,1,0,1,2,3 。

如果我们从 N (4) 中减去它，我们会得到所需的 1,2,3,4,3,2,1 序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:49:48.820

```
arr[j][i]=(j * 3 + j/ 3 + b) % N + 1; 
```

# javascript - 在我的网络应用程序中使用 JavaScript 删除用户智能手机上的文件

> ID：14217192
> 
> 赞同：0
> 
> 时间：2013-01-08T14:30:59.933
> 
> 标签：javascript

我是一名来自德国的软件开发人员，我有一个关于智能手机、网站和安全的特殊问题！

我的网络应用程序 - 针对智能手机进行了优化 - 允许它将照片文件（由智能手机相机制作）上传到我们的网络服务器。（我使用常规的 HTML 文件控件。）

它工作正常！

但现在我们考虑通过网络应用程序删除智能手机上上传的照片的可能性！

有没有机会意识到这一点？

我们的用户使用适用于 Android 的 Firefox 17.0。

也许 Mozilla 提供了专有的 JavaScript 代码来访问本地智能手机设备……？

或者是否有可能更改 Firefox Mobile 的本地安全设置？

如果这两种解决方案都不能实现，我可以开发一个智能手机应用程序（本地安装）删除手机上的照片吗？我敢肯定我可以！

但随后我需要有可能使用我的网站代码启动应用程序。

所以我有同样的安全问题 - 我想是的......我再次需要一种方法来“离开”我的网站，以便通过 JavaScript 或其他方式访问本地设备（在手机上启动已安装的应用程序）。

有没有人有想法？

提前致谢。

托马斯

# visual-studio-2012 - 如何获取更多信息，为什么发布失败？

> ID：14217195
> 
> 赞同：1
> 
> 时间：2013-01-08T14:31:13.497
> 
> 标签：visual-studio-2012, publish, web-deployment

我目前尝试使用 Visual Studio 2012 部署 ASP.NET 应用程序。我创建了一个发布配置文件，验证了连接（得到这个绿色复选标记）并单击“发布”。我使用相同的信息和 FileZilla，可以创建文件/文件夹。

但我得到这个错误：

```
2>------ Publish started: Project: MyProject, Configuration: Debug Any CPU ------
2>Connecting to my.url.de...
2>Transformed Web.config using C:\Users\moose\MyProject\MyProject\Web.Debug.config into obj\Debug\TransformWebConfig\transformed\Web.config.
2>Copying all files to temporary location below for package/publish:
2>obj\Debug\Package\PackageTmp.
2>Publishing folder /...
2>Unable to add 'Global.asax' to the Web site.   (550).
2>Unable to add 'NamespaceComments.xml' to the Web site.   (550).
2>Unable to add 'packages.config' to the Web site.   (550).
2>Unable to add 'Web.config' to the Web site.   (550).
2>Unable to add folder 'bin' to the Web site.  Cannot create folder "bin".
2>Unable to add folder 'CodeTemplates' to the Web site.  Cannot create folder "CodeTemplates".
2>Unable to add folder 'Content' to the Web site.  Cannot create folder "Content".
2>Unable to add folder 'Models' to the Web site.  Cannot create folder "Models".
2>Unable to add folder 'Views' to the Web site.  Cannot create folder "Views".
2>
========== Build: 1 succeeded, 0 failed, 2 up-to-date, 0 skipped ==========
========== Publish: 0 succeeded, 1 failed, 0 skipped ========== 
```

我知道 FTP-Error 550 意味着：*未采取请求的操作。文件不可用（例如，文件未找到，无法访问）。*（[来源](http://en.wikipedia.org/wiki/List_of_FTP_server_return_codes)）

这并没有给我任何暗示他为什么“无法添加 [xyz]”。我怎样才能获得有关它的更多信息？（例如，VS 尝试在哪里部署它？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-20T14:08:31.337

当这发生在我身上时，我意识到我忘记以管理员身份启动我的 Visual Studio。一旦我这样做了，发布的问题就消失了。

# numpy - 如何矢量化一维数组上的操作以在 numpy 中生成二维矩阵

> ID：14217206
> 
> 赞同：4
> 
> 时间：2013-01-08T14:31:44.970
> 
> 标签：numpy, vectorization

我有一个一维数组

```
i = np.arange(0,7,1) 
```

和一个函数

```
# Returns a column matrix
def fn(i):
    return np.matrix([[i*2,i*3]]).T

fnv = np.vectorize(fn) 
```

然后写

```
fnv(i) 
```

给我一个错误

```
 File "<stdin>", line 1, in <module>
  File "c:\Python33\lib\site-packages\numpy\lib\function_base.py", 
        line 1872, in __call__
    return self._vectorize_call(func=func, args=vargs)
  File "c:\Python33\lib\site-packages\numpy\lib\function_base.py", 
        line 1942, in _vectorize_call
        copy=False, subok=True, dtype=otypes[0])
  ValueError: setting an array element with a sequence. 
```

我正在寻找的结果是一个具有两行和与输入数组一样多的列的矩阵。numpy 中实现这一目标的最佳符号是什么？

例如*我*会等于

```
[1,2,3,4,5,6] 
```

并且输出将等于

```
[[2,4,6,8,10,12],
 [3,6,9,12,15,18]] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T14:40:56.323

**编辑** 你应该尽量避免使用`vectorize`，因为它给人一种 numpy 效率的错觉，但它里面都是 python 循环。

如果您真的必须处理用户提供的函数，这些函数采用`int`s 并返回 a`matrix`的形状`(2, 1)`，那么您可能无能为力。但这似乎是一个非常奇怪的用例。`int`如果您可以将其替换为接受 an并返回 an`int`并在需要时使用的函数列表`ufuncs`，即`np.sin`代替`math.sin`，您可以执行以下操作

```
def vectorize2(funcs) :
    def fnv(arr) :
        return np.vstack([f(arr) for f in funcs])
    return fnv

f2 = vectorize2((lambda x : 2 * x, lambda x : 3 * x))

>>> f2(np.arange(10))
array([[ 0,  2,  4,  6,  8, 10, 12, 14, 16, 18],
       [ 0,  3,  6,  9, 12, 15, 18, 21, 24, 27]]) 
```

仅供您参考，我已根据您提出的矢量化进行了计时：

```
f = vectorize(fn)

>>> timeit.timeit('f(np.arange(10))', 'from __main__ import np, f', number=1000)
0.28073329263679625
>>> timeit.timeit('f2(np.arange(10))', 'from __main__ import np, f2', number=1000)
0.023139129945661807

>>> timeit.timeit('f(np.arange(10000))', 'from __main__ import np, f', number=10)
2.3620706288432984
>>> timeit.timeit('f2(np.arange(10000))', 'from __main__ import np, f2', number=10)
0.002757072593169596 
```

因此，即使对于小型阵列，速度也有一个数量级，对于较大的阵列，速度会增长到 1000 倍，几乎免费提供。

**原始答案**

`vectorize`除非没有办法，否则不要使用它，它很慢。请参阅以下示例

```
>>> a = np.array(range(7))
>>> a
array([0, 1, 2, 3, 4, 5, 6])
>>> np.vstack((a, a+1))
array([[0, 1, 2, 3, 4, 5, 6],
       [1, 2, 3, 4, 5, 6, 7]])
>>> np.vstack((a, a**2))
array([[ 0,  1,  2,  3,  4,  5,  6],
       [ 0,  1,  4,  9, 16, 25, 36]]) 
```

无论你的函数是什么，如果它可以用 numpy 的 ufunc 构建，你可以做类似的事情`np.vstack((a, f(a)))`并得到你想要的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:08:35.193

vectorize 的简单重新实现给了我想要的东西

```
def vectorize( fn):
    def do_it (array):
        return np.column_stack((fn(p) for p in array))
    return do_it 
```

如果这不是高性能或有更好的方法，请告诉我。

# javascript - 我可以拥有 RequireJS 模块的多个实例吗？

> ID：14217208
> 
> 赞同：7
> 
> 时间：2013-01-08T14:31:53.113
> 
> 标签：javascript, requirejs, amd

我显然缺少一些概念/理解，而且绝对是 javascript OO 基础知识！

我喜欢使用 RequireJS，我的 Web 应用现在看起来更像是一个结构化的应用，而不是一堆疯狂的代码。

我只是在努力理解如何/如果以下是可能的。

我有一个模块，它充当名为**dataservice_base**的基本数据服务模块，如下所示：

```
define(['dataservices/dataservice'], function (dataservice) {

    // Private:     Route URL
    this.route = '/api/route-not-set/';
    var setRoute = function (setRoute) {
        this.route = setRoute;
        return;
    }

    //  Private:    Return route with/without id 
    var routeUrl = function (route, id) {
        console.log('** Setting route to: ' + route);
        return route + (id || "")
    }

    //  Private:    Returns all entities for given route
    getAllEntities = function (callbacks) {
        return dataservice.ajaxRequest('get', routeUrl())
        .done(callbacks.success)
        .fail(callbacks.error)
    };

    getEntitiesById = function (id, callbacks) {
        return dataservice.ajaxRequest('get', routeUrl(this.route, id))
        .done(callbacks.success)
        .fail(callbacks.error)
    };

    putEntity = function (id, data, callbacks) {
        return dataservice.ajaxRequest('put', routeUrl(this.route, id), data)
        .done(callbacks.success)
        .fail(callbacks.error)
    };

    postEntity = function (data, callbacks) {
        return dataservice.ajaxRequest('post', routeUrl(this.route), data)
        .done(callbacks.success)
        .fail(callbacks.error)
    };

    deleteEntity = function (id, data, callbacks) {
        return dataservice.ajaxRequest('delete', routeUrl(this.route, id), data)
        .done(callbacks.success)
        .fail(callbacks.error)
    };

    //  Public:     Return public interface
    return {
        setRoute: setRoute,
        getAllEntities: getAllEntities,
        getEntitiesById: getEntitiesById,
        putEntity: putEntity,
        postEntity: postEntity,
        deleteEntity: deleteEntity
    };

}); 
```

如您所见，我引用的是 dataservices/dataservice，它实际上是核心 AJAX 调用机制（未显示，但实际上只是包装器中的基本 jQuery ajax 调用）。

我想要做的是允许这个基本数据服务模块被“实例化”，如下所示（在另一个模块中 - 仅限片段代码）：

```
define(['dataservices/dataservice_base', 'dataservices/dataservice_base', 'dataservices/dataservice_base'], function (dataservice_profile, dataservice_qualifications, dataservice_subjects) {

    //  Set the service route(s)
    dataservice_profile.setRoute('/api/profile/');
    dataservice_qualifications.setRoute('/api/qualification/');
    dataservice_subjects.setRoute('/api/subject/'); 
```

如您所见，我试图包含相同的**dataservice_base**（上面定义）3次，但在函数引用中，我试图通过命名变量来引用每个实例，即：

dataservice_profile、dataservice_qualifications、dataservice_subjects

..当然，我正在尝试为每个实例设置一个唯一的**setRoute**值，以便在模块中进一步使用..同时利用常见调用（get、puts、posts 等）。

显然我在这里遗漏了一些东西..但是任何帮助我回到路上的帮助都会非常感激！

亲切的问候，大卫。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T17:42:57.650

我认为您只需要包含一次依赖项并使用[new](https://stackoverflow.com/a/3658673/1916258)关键字。可能您需要重构，以便常用功能位于依赖模块中：

```
define(['dataservices/dataservice'], function (dataservice) {
    var dataservice_profile = new dataservice();
    var dataservice_qualifications = new dataservice();
    var dataservice_subjects = new dataservice();

    //  Set the service route(s)
    dataservice_profile.setRoute('/api/profile/');
    dataservice_qualifications.setRoute('/api/qualification/');
    dataservice_subjects.setRoute('/api/subject/');

    // define needs to return something
    return {
       profile: dataservice_profile,
       qualifications: dataservice_qualifications,
       subjects: dataservice_subjects
    };
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T17:56:01.097

是的，大脑冻结或其他......有时独自工作的问题！

因此，正如@asgoth 所提到的，我必须理清思路并仔细考虑一下！

我最终得到了一个重构的 dataservice_base 模块，如下所示：

```
define(['dataservices/dataservice'], function (dataservice) {

    //  Set any class/static vars

    //  Set the instance function
    function dataservice_base(setRoute) {

        var self = this;

        self.route = setRoute;
        console.log('setting route: ' + self.route);

        function routeUrl(route, id) {
            console.log('** Setting route to: ' + route);
            return route + (id || "")
        }

        self.getAllEntities = function (callbacks) {
            return dataservice.ajaxRequest('get', routeUrl())
            .done(callbacks.success)
            .fail(callbacks.error)
        }

        self.getEntitiesById = function (id, callbacks) {
            return dataservice.ajaxRequest('get', routeUrl(self.route, id))
            .done(callbacks.success)
            .fail(callbacks.error)
        }

        self.putEntity = function (id, data, callbacks) {
            return dataservice.ajaxRequest('put', routeUrl(self.route, id), data)
            .done(callbacks.success)
            .fail(callbacks.error)
        }

        self.postEntity = function (data, callbacks) {
            return dataservice.ajaxRequest('post', routeUrl(self.route), data)
            .done(callbacks.success)
            .fail(callbacks.error)
        }

        self.deleteEntity = function (id, data, callbacks) {
            return dataservice.ajaxRequest('delete', routeUrl(self.route, id), data)
            .done(callbacks.success)
            .fail(callbacks.error)
        }

    } // eof instance

    return dataservice_base;
} 
```

当然，正如@asgoth 提到的，我当然只需要包含一个对 dataservice_base 模块的引用，并根据我的需要实例化它，如下所示：

```
define(['dataservices/dataservice_base','viewmodels/viewmodel_profile', 'viewmodels/viewmodel_qualifications', 'viewmodels/viewmodel_subjects', 'app/common'], function (dataservice_base, viewmodel_profile, viewmodel_qualifications, viewmodel_subjects, common) {

    var dataservice_profile = new dataservice_base('/api/profile/');
    var dataservice_qualifications = new dataservice_base('/api/qualification/');
    var dataservice_subjects = new dataservice_base('/api/subject/');

    // do whatever now with those instance objects...
} 
```

所以..现在一切正常！

我想我唯一需要做的另一件事是查找清理过程以确保释放这些对象..但是只会有几个..但仍然..

再次感谢@asgoth

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-02T15:08:26.353

只需返回一个函数而不是这样的对象

```
return function(){
    return {
        // your public interface goes here
    };
} 
```

现在您可以使用`new componentName()`.

# c - 在 C 中使用结构指针，即使它们没有被声明

> ID：14217216
> 
> 赞同：1
> 
> 时间：2013-01-08T14:32:11.073
> 
> 标签：c, pointers, struct

```
#include <stdlib.h>

struct timer_list
{
};

int main(int argc, char *argv[])
{
  struct foo *t = (struct foo*) malloc(sizeof(struct timer_list));
  free(t);
  return 0;
} 
```

为什么上面的代码段编译（在 gcc 中）并且在我没有定义 foo 结构时可以正常工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T14:34:37.083

因为在上面的代码片段中，编译器不需要知道 的大小`struct foo`，只需要知道指向 的**指针**的大小`struct foo`，这与结构的实际定义无关。

现在，如果你写过：

```
struct foo *t = malloc(sizeof(struct foo)); 
```

那将是一个不同的故事，因为现在编译器需要知道要分配多少内存。

此外，如果您尝试访问 a 的成员`struct foo*`（或取消引用指向 foo 的指针）：

```
((struct foo*)t)->x = 3; 
```

编译器也会抱怨，因为此时它需要知道`x`.

* * *

顺便说一句，此属性对于实现[不透明指针](http://en.wikipedia.org/wiki/Opaque_pointer)很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:07:10.020

“那么 free(t) 呢？编译器可以在不知道结构实际大小的情况下释放内存吗？” 不，编译器不会释放任何东西。Free() 只是一个输入参数为 void * 的函数。

# c# - Mono Monodevelop 和 SQLite

> ID：14217217
> 
> 赞同：-1
> 
> 时间：2013-01-08T14:32:13.167
> 
> 标签：c#, windows, sqlite, mono, monodevelop

我正在尝试学习如何将 SQLite 与 c# (mono/monodevelop) 一起使用。我在我的解决方案中包含了 SQLite 参考，我正在尝试编译这个简单的代码：

```
using System;
using System.Data;
using System.Data.SQLite;

namespace SqliteTest
{

class SqliteTest 
{
    static void dbstuff ()
    {
        //Creating DB
        SQLiteConnection.CreateFile("MyDatabase.sqlite");
        //Creating a Connection 
        SQLiteConnection m_dbConnection;
        m_dbConnection = new SQLiteConnection("Data Source=MyDatabase.sqlite;Version=3;");
        //Conntecting
        m_dbConnection.Open();
        //Run some sql commands
        string sql = "CREATE TABLE highscores (name VARCHAR(20), score INT)";
        SQLiteCommand command = new SQLiteCommand(sql, m_dbConnection);
        command.ExecuteNonQuery(); //This command just indicae the number of rows that have been modified

    }

    static void Main() 
    {
        dbstuff();
    }
}
} 
```

但我得到这个错误：

```
The type 'System.Data.Common.DbConnection' is defined in an assembly that is not referenced 
```

我该如何解决这个问题？

我是 C# 的新手，我希望有人能指出我正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:36:47.573

添加

```
using System.Data.Common; 
```

在文件前面。

# jasper-reports - 传递链接参数

> ID：14217222
> 
> 赞同：1
> 
> 时间：2013-01-08T14:32:18.293
> 
> 标签：jasper-reports, ireport

我创建了一个带有饼图的报表，当用户单击饼图的一部分时，我想打开另一个报表。每个部分将有两个不同的参数，将在另一个报告中使用（当用户单击饼图时将打开）。

我对超链接和链接参数做了很多研发，但没有成功，虽然超链接工作但无法获取链接参数。

我正在使用*iReport 4.7.0*而不是*JR Server*。

那么如何设置和获取链接参数呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T11:12:11.577

在 Chart Data > Details > Section 超链接中，您需要将超链接类型设置为`Reference`（`ReportExecution`特定于 JasperReports Server）。

作为超链接参考，您可以添加链接表达式，例如

```
"http://link/to/report?category=" + $F{category} + "&param2=" + $P{param} 
```

where`$F{category}`是饼图中分段类别的字段的`$P{param}`占位符，并且是任意第二个参数的占位符。

# c - 打包成一个八位字节串

> ID：14217224
> 
> 赞同：0
> 
> 时间：2013-01-08T14:32:25.693
> 
> 标签：c, string

> **可能重复：**
> [填充八位字节字符串](https://stackoverflow.com/questions/14231464/filling-an-octet-string)

我有 65 个不同位长的参数，我需要填写一个八位字节字符串。参数将在八位字节字符串中连续填充。例如，假设第一个参数是 1 位长，因此它将在八位字节字符串的第一个八位字节的第 0 位位置填充。现在第二个参数假设为 9 位长。因此，该参数的前 7 位将被填充到相同的八位字节中，接下来的 2 位应位于下一个八位字节的第 0 位和第 1 位位置。类似地，其他参数将被填充到八位字节字符串中。我试图编写一个函数，其中我将指针传递给当前八位字节、位位置和源指针，数据将从那里复制。但我发现逻辑实现有困难。我尝试了许多逻辑（位操作、位移、旋转等），但无法获得正确的逻辑。如果有人可以在“C”中给我一个逻辑/功能，我将不胜感激。您也可以使用不同的函数原型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:38:20.380

这被称为“比特流”，并且在例如低级网络协议中相当普遍。

如果你的参数有一个合理的上限，例如 32 位，你应该考虑实现类似的东西：

```
void bitstream_append(uint32_t value, uint8_t bits); 
```

这会将`bits`最右边的位附加`value`到流中。如果您已经拥有`bitstream_append_bit(bool bit);`.

# python - 我如何将 rpy2--另一个库/模块导入 Google App Engine 项目

> ID：14217226
> 
> 赞同：-3
> 
> 时间：2013-01-08T14:32:29.263
> 
> 标签：python, google-app-engine, rpy2

这是[rpy2](http://rpy.sourceforge.net/rpy2_documentation.html)。

我会使用“easy_install rpy2”进行安装。

请“一步一步”解释我。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:38:24.390

只会上传应用程序文件夹中的内容。

因此，您只需将相关文件夹放入您的应用引擎项目文件夹中即可。就像您要导入自己的模块一样。然后它将可用于您的应用程序引擎应用程序。

所以安装你想安装的东西，把它的安装目录复制到你的应用程序引擎应用程序目录中。这是通用的，它并不特定于您链接到的包。

这是一个类似的问题：[如何使用 Google App Engine 管理第三方 Python 库？（虚拟环境？点子？）](https://stackoverflow.com/questions/4863557/how-do-i-manage-third-party-python-libraries-with-google-app-engine-virtualenv)

请注意，如果它不是纯 python（即具有 C 组件），它将无法在应用引擎上运行。

GAE 注释：

> 您可以在 Google App Engine 应用程序中使用任何纯 Python 第三方库。为了使用第三方库，只需将文件包含在您的应用程序目录中，当您将应用程序部署到我们的系统时，它们将与您的应用程序一起上传。您可以像在应用程序中导入任何其他 Python 文件一样导入这些文件。

[https://developers.google.com/appengine/kb/commontasks#thirdparty](https://developers.google.com/appengine/kb/commontasks#thirdparty)

# haskell - Parsec 无法识别块注释

> ID：14217231
> 
> 赞同：2
> 
> 时间：2013-01-08T14:32:45.440
> 
> 标签：haskell, mustache, parsec

我在解析小胡子模板时遇到 Parsec 识别注释的问题。
各种胡须标记都以`{{`包含块注释 ( `{{!comment}}`) 开头。我已经在我的 TokenParser 中设置了 commentStart 和`{{!`commentEnd `}}`。
每当我向模板添加评论时，Parsec 都会抱怨评论是意外的。
它需要一个 mustache 变量，因为这是唯一匹配的标记`{{`。

Parsec 何时删除评论？我认为它会在源代码命中我的解析器之前发生？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T15:02:20.390

Parsec 不会删除评论。在 a`TokenParser`中，注释包含在空格下，因此

```
whiteSpace tokenParser 
```

跳过注释和普通空格（空格、制表符、换行符……）。

通常，您使用`lexeme parser`跳过一个词位之后的所有空白，然后您只需要一个初始空白跳过让顶级解析器跳过源中的任何前导空白，然后，所有空白（包括注释）是自动处理（由创建的`TokenParser`）`makeTokenParser`。

如果您不`lexeme`手动使用和处理空格，则必须注意作为注释分隔符前缀的标记/词素。如果您先尝试前缀，那将成功，但仅消耗部分注释分隔符，在这种情况下，保留`'!'`变量解析器，然后失败。

# jquery - Jquery find the text field by the text within it

> ID：14217233
> 
> 赞同：0
> 
> 时间：2013-01-08T14:32:55.083
> 
> 标签：jquery

Is it possible to find a text field by the text entered inside.

My exact situation is that,

I have about 4-5 text fields, and i need to find those text fields which doesn't have any text entered, i.e whose value = "" .

Any help would be of great use.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T14:34:43.893

你可以使用[`filter`](http://api.jquery.com/filter/)方法。

```
var $input = $('input[type=text]').filter(function(){
   return this.value === ''
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:45:01.720

您可以使用@undefined 给出的方法。以下选择对我有用，您可以尝试：

```
 $(":text[value=]").get() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:57:38.147

```
$('input:text').filter(function() { return $(this).val() == ""; }); 
```

或者

```
$('input:text').filter(function() { return this.value == ""; }); 
```

或者

```
$('input:text[value=""]'); 
```

# php - Saving runtime created table rows using PHP and MySQL

> ID：14217235
> 
> 赞同：1
> 
> 时间：2013-01-08T14:33:00.460
> 
> 标签：php, javascript, html, mysql

I am new to PHP. I am working on a form which has a table with thee columns that is two textboxes and and one combo box. I used JavaScript for generating the table rows and the same to delete it. I also referred one of your blogs for generating the rows. Now I am stuck on how to save the values from the the generated textbox to the MySQL database. Can anyone help me out? It would be a huge favor.

Here is my code:

```
<?php
session_start();
if (!isset($_SESSION["username"])) {
    header("Location: unauthorize_access.php");
}

if(isset($_POST['submit']))
    {

        $length = count($_POST['testparameters']);

        for($i=0; $i< $length; $i++){
            $TestParameters=$_POST['testparameters'][$i];
            if(!empty($TestParameters)){
            $InsertQuery = "INSERT INTO color(name) VALUES('$TestParameters')";
            $result=mysql_query($InsertQuery) or die(mysql_error());
        }
        }
        if(!$InsertQuery)
        {
            die('Could not enter data:' . mysql_error());
            }
    }
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <title>Makhtab</title>
            <link rel="stylesheet" type="text/css" href="form2/view.css" media="all">
                <script type="text/javascript" src="form2/view.js"></script>
                <script type="text/javascript" src="form2/calendar.js"></script>
                <meta http-equiv="Content-Script-Type" content="text/javascript"> 
                    <script type="text/javascript">

                            function deleteRow(row)
                            {
                            var i=row.parentNode.parentNode.rowIndex;
                            document.getElementById('POITable').deleteRow(i);
                            }

                            function insRow()
                            {
                            console.log( 'hi');
                            var x=document.getElementById('POITable');
                            var new_row = x.rows[1].cloneNode(true);
                            var len = x.rows.length;
                            new_row.cells[0].innerHTML = len;

                            var inp1 = new_row.cells[1].getElementsByTagName('input')[0];
                            inp1.id += len;
                            inp1.value = '';
                            var inp2 = new_row.cells[2].getElementsByTagName('input')[0];
                            inp2.id += len;
                            inp2.value = '';
                            x.appendChild( new_row );
                            }
                </script>
                              <script type="text/javascript">

                            function deletezimRow(row)
                            {
                            var i=row.parentNode.parentNode.rowIndex;
                            document.getElementById('zimtable').deleteRow(i);
                            }

                            function inszimRow()
                            {
                            console.log( 'hi');
                            var x=document.getElementById('zimtable');
                            var new_row = x.rows[1].cloneNode(true);
                            var len = x.rows.length;
                            new_row.cells[0].innerHTML = len;

                            var inp1 = new_row.cells[1].getElementsByTagName('input')[0];
                            inp1.id += len;
                            inp1.value = '';
                            var inp2 = new_row.cells[2].getElementsByTagName('input')[0];
                            inp2.id += len;
                            inp2.value = '';
                            x.appendChild( new_row );
                            }
                </script>
                                    <!--<style type="text/css" title="currentStyle">
                                        @import "tran/css/layout-styles.css";
                                        @import "tran/css/themes/smoothness/jquery-ui-1.8.4.custom.css";
                                    </style>-->
                <script  type="text/javascript" src="tran/js/jquery-1.6.1.min.js"></script>
                <script  type="text/javascript" src="tran/js/jquery-ui-1.8.14.custom.min.js"></script>

                <script  type="text/javascript" src="tran/js/jq-ac-script.js"></script>
                </head>
                <body id="main_body" >

                    <img id="top" src="form2/top.png" alt="">
                        <div id="form_container">

                            <h1><a>Untitled Form</a></h1>
                            <form id="makhtab" class="appnitro" enctype="multipart/form-data" method="post" action="">
                                <div class="form_description">
                                    <h2>Makhtab Details</h2>
                                    <!--<p>This is your form description. Click here to edit.</p>-->
                                </div>                      
                                <table border="0px" width="100%">
                                    <tr>
                                        <td><label class="description" for="element_1">Code</label></td><td><input id="element_1" name="code" class="element text small" type="text" maxlength="6" value=""/></td>
                                    </tr>
                                    <tr>
                                        <td><label class="description" for="element_1">Name</label></td><td><input id="element_1" name="name" class="element text large" type="text" maxlength="40" value=""/> </td>
                                    </tr>

                                    <tr>
                                        <td><label class="description" for="element_1">Address</label></td><td><input id="element_4_1" name="add1" class="element text large" value="" type="text"></td>
                                    </tr>
                                    <tr>
                                        <td></td><td><input id="element_4_1" name="add2" class="element text large" value="" type="text"></td>
                                    </tr>
                                    <tr>
                                        <td></td><td><input id="element_4_1" name="add3" class="element text large" value="" type="text"></td>
                                    </tr>
                                    <tr>
                                        <td><label class="description" for="element_1">City</label></td><td><select name="cmbcity" class="element text medium" style="font-size:18px;"/>
                                            <option value=""></option>
                                            <?php
                                            mysql_connect("localhost", "root", '') or die(mysql_error());
                                            mysql_select_db("webapp") or die(mysql_error());
                                            $result = mysql_query("SELECT `name` from city ") or die(mysql_error());

                                            while ($year = mysql_fetch_array($result)) {

                                                echo "<option value='$year[name]'>$year[name]</option>";
                                            }
                                            ?>
                        </select>

                                    </tr>
                                                                        <tr>
                                        <td><label class="description" for="element_1">State</label></td><td><select name="cmbstate" class="element text medium" style="font-size:18px;"/>
                                            <option value=""></option>
                                            <?php
                                            mysql_connect("localhost", "root", '') or die(mysql_error());
                                            mysql_select_db("webapp") or die(mysql_error());
                                            $result = mysql_query("SELECT `name` from state ") or die(mysql_error());

                                            while ($year = mysql_fetch_array($result)) {

                                                echo "<option value='$year[name]'>$year[name]</option>";
                                            }
                                            ?>
                        </select>
                                                                        </tr>
                                </tr>
                                <tr>
                                    <td><label class="description" for="element_1">Country</label></td><td><select name="cmbcountry" class="element text medium" style="font-size:18px;"/>
                                        <option value=""></option>
                                        <?php
                                        mysql_connect("localhost", "root", '') or die(mysql_error());
                                        mysql_select_db("webapp") or die(mysql_error());
                                        $result = mysql_query("SELECT `name` from country ") or die(mysql_error());

                                        while ($year = mysql_fetch_array($result)) {

                                            echo "<option value='$year[name]'>$year[name]</option>";
                                        }
                                        ?>
                                        </select>
                                    <tr>
                                        <td><label class="description" for="element_1">Telephone</label></td><td><input id="element_1" name="country" class="element text medium" type="text" maxlength="255" value=""/></td>
                                    </tr>
                                    <tr>
                                        <td><label class="description" for="element_1">Mobile</label></td><td><input id="element_1" name="country" class="element text medium" type="text" maxlength="10" value=""/></td>
                                    </tr>
                                    <tr>
                                        <br />
                                    </tr>

                                    </table>

                                         <tr>
                                    <br /><p style="border-bottom: 1px dotted #ccc;"></p><br />
                                    <div class="form_description">
                                        <h2>Zimmedar Details</h2>
                                        <!--<p>This is your form description. Click here to edit.</p>-->
                                    </div>
                                </tr>
                                         <input type="button" id="addmorezimbutton" value="Add zimmedar" onclick="insRow()"/><br/><br/>
                                    <table id="zimtable" border="0px" size="100px" cellspacing="0" cellpadding="2">
                                        <tr>
                                            <td width="10" align="center"><label class="description">Srno.&nbsp;</label></td>
                                            <td width="118"><label class="description">Zimmedar Name</label></td>
                                            <td width="118"><label class="description">Mobile</label></td>

                                            <td width="10"></td>
                                            <td width="10" align="center"></td>
                                        </tr>
                                        <tr>
                                            <td>1</td>
                                            <td width="210"><input  size="40" maxlenght="40" type="text" id="zimame[]"/></td>
                                            <td width="80"><input  size="10" maxlenght="10" type="text" id="zimmob[]"/></td>

                                            <!--<td><input  size="45" maxlenght="10" type="text" id="momob"/>&nbsp;</td>-->
                                            <td><input type="button" id="addzimmore" value="+" onclick="inszimRow()"/></td>
                                            <td align="center"><input type="button" id="delzimbutton" value="-" onclick="deletezimRow(this)"/></td>
                                        </tr>

                                    </table>

                                                                         <tr>
                                    <br /><p style="border-bottom: 1px dotted #ccc;"></p><br />
                                    <div class="form_description">
                                        <h2>Muallim Details</h2>
                                        <!--<p>This is your form description. Click here to edit.</p>-->
                                    </div>
                                </tr>
                                         <input type="button" id="addmorePOIbutton" value="Add Muallims" onclick="insRow()"/><br/><br/>
                                    <table id="POITable" border="0px" size="100px" cellspacing="0" cellpadding="2">
                                        <tr>
                                            <td width="10" align="center"><label class="description">Srno.&nbsp;</label></td>
                                            <td width="118"><label class="description">Moallim Name</label></td>
                                            <td width="118"><label class="description">Mobile</label></td>
                                            <td width="118"><label class="description">Qabiliyat</label></td>
                                            <td width="10"></td>
                                            <td width="10" align="center"></td>
                                        </tr>
                                        <tr>
                                            <td>1</td>
                                            <td width="210"><input  size="40" maxlenght="40" type="text" id="moname[]"/></td>
                                            <td width="80"><input  size="10" maxlenght="10" type="text" id="momob[]"/></td>
                                            <td><select name="cmbmuallim[]" class="element text large" style="font-size:18px;"/>
                                                <option value=""></option>
                                                <?php
                                                mysql_connect("localhost", "root", '') or die(mysql_error());
                                                mysql_select_db("webapp") or die(mysql_error());
                                                $result = mysql_query("SELECT `name` from qabiliyat ") or die(mysql_error());

                                                while ($year = mysql_fetch_array($result)) {

                                                    echo "<option value='$year[name]'>$year[name]</option>";
                                                }
                                                ?>
                                                </select></td>
                                            <!--<td><input  size="45" maxlenght="10" type="text" id="momob"/>&nbsp;</td>-->
                                            <td><input type="button" id="addmore" value="+" onclick="insRow()"/></td>
                                            <td align="center"><input type="button" id="delPOIbutton" value="-" onclick="deleteRow(this)"/></td>
                                        </tr>
                                    </table>

                                             <br /><p style="border-bottom: 1px dotted #ccc;"></p><br />
                                             <table border="0px" width="85%">
                                                 <tbody><tr>
                                                         <td width="105"><label class="description">No. of Students</label></td>
                                                         <td width="65"><input type="text" name=stu" size="5" maxlength="5"></input></td>
                                                         <td width="105"><label class="description">No. of Batches</label></td><td width="14"><input type="text" name="batch" size="5" maxlength="3"></input></td>
                                                     </tr>
                                                     <tr>

                                                     </tr>
                                                 </tbody>

                                             </table>     
                                    </div>
                                    </div>
                            </form>

                            </table>    
                            </form>

                            </body>
                            </html> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-08T18:04:57.330

如果我错了，请纠正我。我没有看到任何打开 mysql 数据库连接的代码。

请参阅此示例。

```
<?php
$con = mysql_connect("localhost","peter","abc123");
if (!$con)
{
    die('Could not connect: ' . mysql_error());
}

// Create database
if (mysql_query("CREATE DATABASE my_db",$con))
{
   echo "Database created";
} else {
   echo "Error creating database: " . mysql_error();
}
?> 
```

**在使用mysql_query**插入记录之前，请确保您打开了如上所述的 mysql 数据库连接。

# java.util.logging - 自动读取 JUL 的 logging.properties

> ID：14217237
> 
> 赞同：0
> 
> 时间：2013-01-08T14:33:03.747
> 
> 标签：java.util.logging

是否可以让我的 webapp 无需修改就可以识别 logging.properties？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-17T16:50:46.217

在 Tomcat 下，您可以设置[WatchedResource](http://tomcat.apache.org/tomcat-5.5-doc/config/context.html)以指向您的[logging.properties](http://tomcat.apache.org/tomcat-7.0-doc/logging.html)，如果 Web 应用程序更新，它将重新加载它。您必须进行测试以确保重新加载不会触发任何类加载器内存泄漏。

您可以在应用程序运行时使用[JMX](http://docs.oracle.com/javase/7/docs/api/java/util/logging/LoggingMXBean.html)修改记录器级别。或者您必须求助于使用[WatchService](http://docs.oracle.com/javase/7/docs/api/java/nio/file/WatchService.html)编写自定义代码来监控 logging.properties 文件并调用 LogManager.readConfiguration。

# c# - file upload in asp.net mvc 4 razor

> ID：14217240
> 
> 赞同：12
> 
> 时间：2013-01-08T14:33:07.043
> 
> 标签：c#, file-upload, razor, asp.net-mvc-4

I am using **ASP .Net MVC 4.0** and **VS10**. I am a newbie in web application.

I have designed a page with html razor view. Here is some code of **Index.cshtml**:

```
@{
ViewBag.Title = "BAP Automation";
}
@section featured {
    <section class="featured">
        <div class="content-wrapper">
            <hgroup class="title">
                <h1>@ViewBag.Title.</h1>
                <h2>@ViewBag.Message</h2>
            </hgroup>
            <form action="Index">
            <table>              **//EDITED BELLOW**
                <tr><form action="" method="post">
                    <td>Upload Excel File: </td>
                    <td><input type="text" name="NAMEtxtFileName"/></td>
                    <td><input type="button" value="Upload" id="IDbtnUpload" name="NAMEbtnUpload"/></td>
                    </form>
                </tr>
                <tr>
                    <td>Company Name: </td>
                    <td><input type="text" /></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td align="right"><input type="submit" value="Process" /></td>
                    <td></td>
                </tr>
            </table>
            </form>
        </div>
    </section>
} 
```

I am trying to upload an excel file in **NAMEbtnUpload**'s click event. clicking on this button we will be in this page, just a file upload dialog will open and selecting the file, the file location will be shown in the **NAMEtxtFileName** textbox.

**EDIT 1:**

I have written some code from the suggested code:

```
 [HttpPost]
    public ActionResult Index(HttpPostedFileBase NAMEbtnUpload)
    {
        if (NAMEbtnUpload.ContentLength > 0)
        {
            var fileName = Path.GetFileName(NAMEbtnUpload.FileName);
            var path = Path.Combine(Server.MapPath("~/App_Data/Given Excel's"), fileName);
            NAMEbtnUpload.SaveAs(path);
        }

        return RedirectToAction("Index");
    } 
```

but this shows following error:

## Server Error in '/' Application.

**The resource cannot be found.** **Description**: **HTTP 404**. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable. Please review the following URL and make sure that it is spelled correctly.

**Requested URL:** /

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-10-03T16:26:57.370

尝试将“EncType”属性添加到您的表单中。

```
@using (Html.BeginForm("ACTION", "CONTROLLER", FormMethod.Post, new { EncType="multipart/form-data"})){
  //FORM MARKUP HERE
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-08T14:35:21.707

[Phil Haack 在他的博客文章Uploading a File (Or Files) With ASP.NET MVC](http://haacked.com/archive/2010/07/16/uploading-files-with-aspnetmvc.aspx)中向您展示了如何处理文件上传。

您缺少很多东西，因此阅读该帖子将使您比这里的任何答案更进一步。

** 编辑 1 的更新 **

几个问题

1.  `<form action="index" >` - 这应该是`<form action="/ControllerName/Index">`
2.  您有多个嵌套的表单标签。您可以有多个表单标签，但它们不能嵌套。在您的情况下，您只需要一个。大多数时候你只需要1。
3.  `<input type="button" value="Upload" id="IDbtnUpload" name="NAMEbtnUpload"/>`应该

`@using(Html.BeginForm())`与手动编写表单标签相比，使用它更传统。见下文。

```
@using(Html.BeginForm("Index"))
{
 <table>
    <tr>
        <td>Upload Excel File: </td>
        <td><input type="text" name="NAMEtxtFileName"/></td>
        <td><input type="file" id="IDbtnUpload" name="NAMEbtnUpload"/></td>

    </tr>
    <tr>
        <td>Company Name: </td>
        <td><input type="text" /></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td align="right"><input type="submit" value="Process" /></td>
        <td></td>
    </tr>
 </table>
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-08T14:34:53.597

> 单击[上传]按钮，我们将在此页面中，将打开一个文件上传对话框并选择文件，文件位置将显示在 NAMEtxtFileName 文本框中。

这是不可能的，因为文件上传元素不再以编程方式访问。“回到过去”，恶意网站通过将文件上传控件的值设置为众所周知的密码文件位置等，默默地上传敏感信息。

`<input type="file" />`正如@Bretts 答案中的链接所建议的那样，您只需在表单上添加一个并处理上传服务器端。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T09:08:20.527

在控制器类中设置文件控件的名称。例如在上面的代码中

```
public ActionResult Index(HttpPostedFileBase NAMEbtnUpload) 
```

将 NAMEbtnUpload 更改为 NAMEtxtFileName 这可以解决您的问题。

# mysql - MySQL Query sum

> ID：14217243
> 
> 赞同：1
> 
> 时间：2013-01-08T14:33:20.663
> 
> 标签：mysql, select, group-by, sum

I've got the following query

```
SELECT crm_presupuestos.fecha_alta, 
       crm_presupuestos.id_vendedor, 
Sum( 
`precio` * ( 100 - `crm_presupuestosdetalles`.`bonif` ) / 100 * `crm_presupuestosdetalles`.`cantidad`) AS LineaNeto
FROM   crm_presupuestos 
       RIGHT JOIN crm_presupuestosdetalles 
               ON crm_presupuestos.id_presupuesto = 
                  crm_presupuestosdetalles.id_presupuesto 
GROUP  BY crm_presupuestos.fecha_alta, 
          crm_presupuestos.id_vendedor 
HAVING (( Date(( crm_presupuestos.fecha_alta )) = Curdate() )); 
```

This works okay, but I need it to sum all the `linea neto` of each `ID_Vendedor`. Also, I need a total at the end of this. Could somebody show me how to do it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:41:09.580

Try this:

```
SELECT IFNULL(Fecha_Alta, 'Total') Fecha_Alta, ID_Vendedor, SUM(LineaNeto) LineaNeto 
FROM (SELECT cp.Fecha_Alta, cp.ID_Vendedor, SUM(Precio * (100-cpd.Bonif)/100*cpd.Cantidad) AS LineaNeto
      FROM CRM_PRESUPUESTOS cp
      RIGHT JOIN CRM_PresupuestosDetalles cpd ON cp.ID_Presupuesto = cpd.ID_Presupuesto
      GROUP BY cp.Fecha_Alta, cp.ID_Vendedor
      HAVING DATE(cp.Fecha_Alta)=CURDATE()) A 
GROUP BY ID_Vendedor WITH ROLLUP; 
```

# java - 套接字 ObjectOutpuStream ObjectInputStream

> ID：14217245
> 
> 赞同：1
> 
> 时间：2013-01-08T14:33:26.327
> 
> 标签：java, sockets, serversocket, objectoutputstream, objectinputstream

我正在编写简单的客户端 - 服务器应用程序。一切正常，但是当我将 InputStream 和 OutputStream 更改为 ObjectOutputStream 和 ObjectInputStream 时，我的应用程序不会发送消息。任何人都可以帮助我并向我展示问题吗？

这是 Serwer.java：

```
class InWorke implements Runnable{

    BufferedReader odczyt=null;
    String slowo;
    ObjectInputStream ois=null;
    Message message;

    InWorke(ObjectInputStream ois) {
        this.ois=ois;
    }

    public void run() {
        while(true) {
            try {
                slowo = (String) ois.readObject();
            } catch (ClassNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            System.out.println(slowo);
            Thread.yield();
        }               }

}

class OutWorke implements Runnable{
    Socket socket=null;
    BufferedReader odczytWe=null;
    DataOutputStream zapis=null;
    String slowo=null;
    Message message; // it is the simple class to serialization
    ObjectOutputStream oos;

    OutWorke(Socket socket,ObjectOutputStream oos) {
        this.socket=socket;
        this.oos=oos;
    }

    public void run() {
        while(true) {
            odczytWe=new BufferedReader(new InputStreamReader(System.in));
            try {
                slowo=odczytWe.readLine();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            try {
                    oos.writeObject(slowo);
                    oos.flush();
                } catch (IOException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
            Thread.yield();

    }

}
}

public class Klient {
    public static void main(String[] args) {

    Socket socket=null;
    ExecutorService exec=Executors.newCachedThreadPool();

    ObjectOutputStream oos=null;
    ObjectInputStream ois=null;

    try {
        socket=new Socket("localhost", 8881);
    } catch (UnknownHostException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    try {
        //we=socket.getInputStream();
        ois=new ObjectInputStream(socket.getInputStream());
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    try {
        //wy=socket.getOutputStream();
        oos=new ObjectOutputStream(socket.getOutputStream());
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    exec.execute(new OutWorke(socket, oos));
    exec.execute(new InWorke(ois));

 }
} 
```

客户端.java：

```
class InWorker implements Runnable{

    Socket socket=null;
    //InputStream we=null;
    //OutputStream wy=null;
    String slowo=null;
    BufferedReader odczyt=null;
    ObjectOutputStream oos;
    ObjectInputStream ois;
    Message message=null;

    InWorker(Socket socket,ObjectInputStream ois) {
        this.socket=socket;
        this.ois=ois;
    }

    public void run() {
                while(true) {
                try {
                    slowo=(String) ois.readObject();
                } catch (ClassNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                System.out.println(slowo);
                Thread.yield();
            }

            }
}

class OutWorker implements Runnable{

    DataOutputStream zapis=null;
    BufferedReader odczyt=null;
    //OutputStream wy=null;
    String tekst=null;
    ObjectOutputStream oos=null;
    Message message;

    OutWorker(ObjectOutputStream oos) {
        this.oos=oos;
    }

    public void run() {
        while(true) {
        odczyt=new BufferedReader(new InputStreamReader(System.in));
        try {
            tekst=odczyt.readLine();
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        try {
            oos.writeObject(tekst);
            oos.flush();
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        Thread.yield();
        }
    }

}

public class Serwer {

    public static void main(String[] args) {
        ServerSocket serversocket=null;
        Socket socket=null;
        //InputStream we=null;
        //OutputStream wy=null;
        ObjectOutputStream oos=null;
        ObjectInputStream ois=null;

        ExecutorService exec=Executors.newCachedThreadPool();

        try {
            serversocket=new ServerSocket(8881);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        try {
            socket=serversocket.accept();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        try {
            ois=new ObjectInputStream(socket.getInputStream());
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        try {
            oos=new ObjectOutputStream(socket.getOutputStream());
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        exec.execute(new InWorker(socket, ois));
        exec.execute(new OutWorker(oos));

    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T14:55:14.197

检查构造函数`ObjectInputStream`：[构造函数](http://docs.oracle.com/javase/6/docs/api/java/io/ObjectInputStream.html#ObjectInputStream%28java.io.InputStream%29)。
它说：

> 此构造函数将阻塞，直到相应的 ObjectOutputStream 已写入并刷新标头。

所以需要创建并刷新对应的ObjectOutputStream。现在，您在服务器和客户端的输出流之前创建 ObjectInputStreams。它们阻止程序，因为没有创建输出流。您应该首先创建输出流，调用`flush`它们，然后才创建输入流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:31:53.917

正如尼基塔指出的那样，根本问题是。实现方案是让服务器和客户端以相反的顺序获取输入和输出流。如果一个首先获取输入流，则另一个获取输出流，等等。我切换客户端以首先获取输出流，并且一切正常。然后我把它放回去并更改服务器，一切都以这种方式工作......您可以选择更改哪个。

供参考： [http ://docs.oracle.com/javase/6/docs/api/index.html?java/io/ObjectOutputStream.html](http://docs.oracle.com/javase/6/docs/api/index.html?java/io/ObjectOutputStream.html)

# sqlite - SQLite and concurrency

> ID：14217249
> 
> 赞同：28
> 
> 时间：2013-01-08T14:33:40.167
> 
> 标签：sqlite

I need to integrate a database in one of our products and I wonder which one would be more suited to our needs (easy automatic deployment, no administration, good performance), and sqlite seems to be a good solution. The problem is that the database could potentially face high concurrency issues: it is accessed through PHP (Apache) each time a client connects to the server the database is running on. One client connects (and execute an INSERT query) approximatively every 10 seconds to the server, and it could possibly have more than 100 clients running.

When executing an INSERT query, sqlite locks the entire database at a certain time for a certain duration. Is there a way to compute that duration? If this is not possible, do you think sqlite (v3.3.7) is still adapted with the above conditions?

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-06-16T11:32:26.033

我尽量避免情绪化的回复和夸张，但我对这个页面上显示的对 sqlite 缺乏了解感到非常**惊讶。**不同的数据库实现满足不同的需求，从您提供的操作规范来看，sqlite3 似乎非常适合您的需求。详细说明：

sqlite3 完全符合 ACID，这意味着它可以确保原子提交，这既不是 MySQL（尽管它可能很好）也不是 Oracle 可以吹嘘的。[在这里](http://adamfowlerml.wordpress.com/2013/01/25/true-acid-compliance/)查看更多

此外，sqlite3 有一个看似简单的机制来确保最大并发性（这也是线程安全的），如他们的[文件锁定和并发文档](http://www.sqlite.org/lockingv3.html)中所述。

根据他们（sqlite3 开发人员）自己的估计，sqlite3 每秒最多可以进行 50,000 次 INSERT——这是受磁盘旋转速度限制的理论最大值。ACID 合规性要求 sqlite3 确认数据库提交已写入磁盘，因此 INSERT、UPDATE 或 DELETE 事务需要两次完整的磁盘旋转，从而有效地将事务数减少到 7200rpm 磁盘驱动器上的 60/s。这在另一个答案中链接的 sqlite FAQ 中进行了概述，事实给出了引擎在生产中的数据吞吐量能力的一些想法。但是并发读写呢？

前面链接的文件锁定和并发文档解释了 sqlite3 如何避免“writer startvation”——一种情况，即大量的数据库读取访问会阻止寻求写入数据库的进程/线程获取锁。锁定状态从 SHARED 到 PENDING 到 EXCLUSIVE 的升级发生在 sqlite3 遇到 INSERT（或 UPDATE 或 DELETE）语句，然后在 COMMIT 时再次发生，这意味着完整的数据库锁定被延迟到执行实际写入之前的最后一刻。sqlite 处理文件锁定的巧妙机制的结果意味着，如果写入者加入队列（PENDING 锁），现有读取（共享锁）将完成，向写入者进程授予独占锁，然后继续读取。这只需要几毫秒，

我相信 EXCLUSIVE 锁上的默认 sqlite3 等待时间是 3 秒，因此考虑到每秒 60 个事务是一个合理的预期，并且您平均每 10 秒向数据库写入一次 - 我会说 sqlite3 很好完成任务，并且仅在您的流量增加 500 倍时才需要引入集群。

不错，非常适合您的要求。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-08T14:45:28.087

我认为 SQLite 不是满足这些要求的好解决方案。SQLite 专为本地和轻量级使用而设计，而不是为数百个请求提供服务。

我会推荐一些其他的解决方案，例如`MySQL`or `PostgreSQL`，两者都可以很好地编写脚本。所以，如果我是你，我会努力编写设置脚本。

为了避免 SQLite 信徒和仇恨者之间的激烈战争，让我提请您注意经常提到的[SQLite 何时使用](http://www.sqlite.org/whentouse.html)文档（我相信它被认为是可靠的来源）。他们在这里声明如下：

> **客户端/服务器 RDBMS 可能更好地工作的情况**
> 
> *高并发*
> 
> SQLite 支持无限数量的同时读取器，但它在任何时刻只允许一个写入器。对于许多情况，这不是问题。作家排队。每个应用程序都快速完成其数据库工作并继续前进，没有任何锁定持续超过几十毫秒。但是有些应用程序需要更多的并发性，这些应用程序可能需要寻求不同的解决方案。

我认为在提到的问题中涉及许多写入，如果 OP 会选择 SQLite，它将导致不可扩展的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-12T10:57:14.053

以下是 SQLite 对 SQLite 的适当使用的看法：[http](http://www.sqlite.org/whentouse.html) : //www.sqlite.org/whentouse.html 特别是，该页面说 SQLite 适合中低流量站点，正是您想要的那种应用程序重新考虑。

除非您期望大幅增长，否则 SQLite 似乎对您有用。根据您在每个请求中执行的操作，我希望每秒 0.17 次查询的查询率完全在 SQLite 的能力范围内。

为了获得良好的用户体验，您应该设计您的网站，以便为单个请求提供服务所需的查询大约需要 200 毫秒。为了实现这一点，结果集可能不应该超过几个分数行；并且应该依赖于索引，而不是全表扫描。如果你做到了，那么你将有足够的空间来每秒处理 5 个查询（在峰值时）。这是您在问题中陈述的要求的 30 倍。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-08T14:37:25.200

SQLite FAQ 涵盖了这个主题：[http ://www.sqlite.org/faq.html](http://www.sqlite.org/faq.html) ://www.sqlite.org/faq.html （参见：“(5) 多个应用程序或同一应用程序的多个实例可以同时访问单个数据库文件吗？”）

但是对于您的特定用途，您可能需要进行一些压力测试以验证它是否满足您的需求。对于 SQLite 来说，100 个并发用户可能有点多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-13T19:42:45.513

我通读了常见问题解答，似乎 SQLite 对并发有一些相当不错的支持，但可能需要使用事务来*确保*一切顺利。

上面关于 Apache 并发的评论是正确的：一个 Apache 服务器可以提供多个请求，数量取决于运行的进程数。我运行的大多数服务器，它设置为 3-5 个进程，而在较大的安装中，它可能达到 20 个。这里的重点是 SQLite 不仅可以处理中小型流量网站，因为它可以执行数千次插入一秒。

我计划在我当前的项目中使用 SQLite，但为了安全起见，我完全打算对任何写作或并发敏感部分使用 BEGIN TRANSACTION 和 COMMIT。

底线，像往常一样，阅读手册。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-18T19:03:49.637

除了上面关于 sqlite3 的讨论之外，sqlite v 3.7.0 中引入的另一个**很棒的特性是****WAL 模式**，您可以在其中读取多个进程并可以同时使用一个进程写入。

看看[http://www.sqlite.org/wal.html](http://www.sqlite.org/wal.html)

# jakarta-ee - Adding more web-apps/wars to a Netbeans maven Enterprise Application

> ID：14217256
> 
> 赞同：0
> 
> 时间：2013-01-08T14:34:04.900
> 
> 标签：jakarta-ee, maven, netbeans

I want to modularise my web application setup a bit better. I have a REST service that I want to put in its own web-app/war project. When you create a Maven Enterprise Application in Maven you get a project with an EAR, EJB and Web app archetypes. I want to add another Web app archetype where I can put my REST code to keep it separated from my regular web site code. So how do I do this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:36:45.713

这个问题概述了在 Maven 中将多个战争合并为一个的推荐方法：

[将不同的 Maven 网络项目组合成一个项目](https://stackoverflow.com/questions/14100700/combine-different-maven-web-projects-into-a-single-project/14105957)

也许这就是你要找的，对吧？

# visual-studio-2012 - 404 Not Found bundles/WebFormsJs after publishing from VS2012

> ID：14217257
> 
> 赞同：2
> 
> 时间：2013-01-08T14:34:10.343
> 
> 标签：visual-studio-2012, web-applications, http-status-code-404, bundle, publish

I am having issues when publishing my web app to our server with some resources not being loaded.

To rule out any possible mistake by myself I tested by creating a totally new Web Application from the template: Visual C#->Web->ASP.NET Web Forms Application and publishing this.

When running locally everything works fine but the published app gets 404 errors for a bunch of resources namely:

*   bundles/WebFormsJs?v=q9E9g87bUDaS624mcBuZsBaM8xn2E5zd-f4FCdIk2cA1
*   bundles/modernizr?v=jmdBhqkI3eMaPZJduAyIYBj7MpXrGd2ZqmHAOSNeYcg1
*   bundles/MsAjaxJs?v=J4joXQqg80Lks57qbGfUAfRLic3bXKGafmR6wE4CFtc1
*   Content/css?v=f5ydPh92LWsttS1MEc8JZmFtAgT6RUaer_jy37xBkQs1 (twice)
*   bundles/MsAjaxJs?v=J4joXQqg80Lks57qbGfUAfRLic3bXKGafmR6wE4CFtc1
*   bundles/WebFormsJs?v=q9E9g87bUDaS624mcBuZsBaM8xn2E5zd-f4FCdIk2cA1

Needless to say without these files a whole bunch of stuff doesn't work right.

I am using Visual Studio 2012 Ultimate v11.0.51106.01 Update 1 on Framework 4.5.50709 on Windows 7 Professional with SP1 (32bit). The server is Windows Server 2008 Enterprise with SP2 (32bit) and has Framework 4.5 installed (I'm not sure how to find the exact version number?).

N.B. The bundles directory does not exist either in the published app or the local source.

When running locally it is running in the IIS Express instance started automatically by Visual Studio.

I am thinking it must be a server configuration issue and Google is turning a blank for me.

Has anyone found a solution for this issue?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T10:37:49.317

我们通过制作具有 IIS7.5 而不是 7.0 的新 Windows 服务器 2008 R2（显然与 SP2 不同？）解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-08T12:40:06.607

在 web.config 中添加以下给定标签，然后它将开始工作。

这解决了我的问题

```
<system.webServer>
    <modules>
      <remove name="Session" />
      <add name="Session" type="System.Web.SessionState.SessionStateModule, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
      <add name="BundleModule" type="System.Web.Optimization.BundleModule" />
    </modules>
    <security>
      <requestFiltering allowDoubleEscaping="true"/>
    </security>
</system.webServer> 
```

# ruby-on-rails - Ruby on Rails 上的路由错误

> ID：14217260
> 
> 赞同：1
> 
> 时间：2013-01-08T14:34:15.290
> 
> 标签：ruby-on-rails

我正在做 Michael Hartl 的 Ruby on Rails 教程，但遇到路由错误。
这是执行后的终端输出`rake routes`：

```
 users GET    /users(.:format)          users#index
            POST   /users(.:format)          users#create
   new_user GET    /users/new(.:format)      users#new
  edit_user GET    /users/:id/edit(.:format) users#edit
       user GET    /users/:id(.:format)      users#show
            PUT    /users/:id(.:format)      users#update
            DELETE /users/:id(.:format)      users#destroy
   sessions POST   /sessions(.:format)       sessions#create
new_session GET    /sessions/new(.:format)   sessions#new
    session DELETE /sessions/:id(.:format)   sessions#destroy
       root        /                         static_pages#home
     signup        /signup(.:format)         users#new
     signin        /signin(.:format)         sessions#new
    signout DELETE /signout(.:format)        sessions#destroy
       help        /help(.:format)           static_pages#help
      about        /about(.:format)          static_pages#about
    contact        /contact(.:format)        static_pages#contact 
```

当 localhost:3000/signin/ 或 localhost:3000/sessions/new 时，路由错误如下

```
No route matches {:action=>"destroy", :controller=>"sessions"} 
```

有人对如何更正路线设置有答案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T19:30:01.697

你的路由文件中有这样的一行吗？

`match '/signout', :to => 'sessions#destroy'`

# c# - 比较两个列表

> ID：14217261
> 
> 赞同：13
> 
> 时间：2013-01-08T14:34:17.797
> 
> 标签：c#

我正在编写一个小程序来比较两个列表。如果值相同，我将它们添加到列表 dups，如果它们不同，我将它们添加到 distinct。我注意到我的值有的加了有的没有，调试了一段时间后，我不确定是什么问题。有人可以阐明一点吗？谢谢。

```
 List<int> groupA = new List<int>();
        List<int> groupB = new List<int>();

        List<int> dups = new List<int>();
        List<int> distinct = new List<int>();

        groupA.Add(2);
        groupA.Add(24);
        groupA.Add(5);
        groupA.Add(72);
        groupA.Add(276);
        groupA.Add(42);
        groupA.Add(92);
        groupA.Add(95);
        groupA.Add(266);
        groupA.Add(42);
        groupA.Add(92);

        groupB.Add(5);
        groupB.Add(42);
        groupB.Add(95);

        groupA.Sort();
        groupB.Sort();

        for (int a = 0; a < groupA.Count; a++)
        {
            for (int b = 0; b < groupB.Count; b++)
            {
                groupA[a].CompareTo(groupB[b]);

                if (groupA[a] == groupB[b])
                {
                    dups.Add(groupA[a]);
                    groupA.Remove(groupA[a]);
                    groupB.Remove(groupB[b]);
                }

            }
            distinct.Add(groupA[a]);
        } 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-08T14:38:43.470

我会使用[`Intersect`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.intersect.aspx)and[`Except`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx)方法：

```
dups = groupA.Intersect(groupB).ToList();
distinct = groupA.Except(groupB).ToList(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-08T14:38:29.680

当您从列表中删除一个项目时，您会将剩余元素的索引向下移动。本质上，您正在使用 for 循环跳过一些项目。
尝试使用 while 循环，并在不删除项目时手动增加计数器。

例如下面的代码是不正确的

```
List<int> nums = new List<int>{2, 4, 6, 7, 8, 10, 11};

for (int i = 0; i < nums.Count; i++)
{
  if (nums[i] % 2 == 0)
    nums.Remove(nums[i]);
} 
```

如果将返回列表`{4, 7, 10, 11}`而不是仅返回`{7, 11}`.

它不会删除 4 的值，因为当我删除 2 的值时，（对于`i=0`）`nums`列表来自

```
//index 0  1  2  3  4   5   6 
nums = {2, 4, 6, 7, 8, 10, 11} 
```

到

```
//index 0  1  2  3  4   5
nums = {4, 6, 7, 8, 10, 11} 
```

循环结束，i 递增到 1，下一个引用的项是`nums[1]`，这不是人们直观预期的 4，而是 6。因此实际上跳过了 4 的值，并且不执行检查。

每次修改要迭代的集合时，您都应该非常非常小心。例如，`foreach`如果您尝试这样做，该语句将引发异常。在这种情况下，您可以使用一段时间

```
List<int> nums = new List<int>{2, 4, 6, 7, 8, 10, 11};

int i = 0;
while (i < nums.Count)
{
  if (nums[i] % 2 == 0)
  {
    nums.Remove(nums[i])
  }      
  else
  {
    i++; //only increment if you are not removing an item
         //otherwise re-run the loop for the same value of i
  }  
} 
```

你们甚至可以分叉 for，比如

```
for (int i = 0; i < nums.Count; i++)
{
  if (nums[i] % 2 == 0)
  {
    nums.Remove(nums[i]);
    i--; //decrement the counter, so that it will stay in place
         //when it is incremented at the end of the loop
  }
} 
```

或者，您可以使用 linq，如下所示：

```
distinct.AddRange(groupA);
distinct.AddRange(groupB);
distinct = distinct.Distinct().ToList(); 
```

和

```
dups.AddRange(groupA);
dups.AddRange(groupB);

dups = dups.GroupBy(i => i)
           .Where(g => g.Count() > 1)
           .Select(g => g.Key)
           .ToList(); 
```

请注意，LINQ 代码不会改变您现有的 groupA 和 groupB 列表。如果你只是想区分它们，你可以这样做

```
groupA = groupA.Distinct().ToList();
groupB = groupB.Distinct().ToList(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-08T14:39:10.140

您可以使用 Linq 轻松完成：

```
 List<int> dups = groupA.Intersect(groupB).ToList();
    List<int> distinct = groupA.Except(groupB).ToList(); 
```

（假设我正确理解了你想要做什么）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-10-03T04:24:46.617

您需要在两者中找到缺失的元素：

```
List<int> onlyInA = groupA.Except(groupB).ToList();
List<int> onlyInB = groupB.Except(groupA).ToList(); 
```

或在单个 linq 中：

```
List<int> missing = groupA.Except(groupB).Union(groupB.Except(groupA)).ToList() 
```

注意 - 与所有 linq 一样，值得指出的是，它不是最有效的方法。所有列表迭代都有成本。如果列表真的很大，那么对两个列表进行排序然后一起迭代它们会更快......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-12-02T18:03:36.607

问题的标题是“比较两个列表”，一些只对真/假结果感兴趣的人会进入该问题

使用 Enumerable.SequenceEqual 方法

```
 if (listA.SequenceEqual(listB))
    {
       // they are equal
    } 
```

# jsf-2 - 没有渲染二维数组

> ID：14217263
> 
> 赞同：0
> 
> 时间：2013-01-08T14:34:27.933
> 
> 标签：jsf-2, multidimensional-array

我正在尝试将二维数组显示为页面中的表格。我知道这听起来好像我在重新发明轮子，但我必须处理的对象是一个自定义类型的二维数组，它也必须以特定的方式呈现（总是相同的）。

棘手的部分是这个二维数组在它的一些索引中可以有空值。在这些情况下，必须呈现特定的“不可用”单元格。表结构（是的......`<table>` `<tr>`和`<td>`）已经由*设计团队*定义并被客户接受。

* * *

由于 JSTL 和 JSF 标记的管理顺序，我尝试使用`<c:forEach/>`，但在尝试使其工作时遇到了麻烦。处理 JSF 标记时，会出现一些问题，包括值过时和缺少组件。

数组（`@ViewScoped`bean 的属性）在被调用时始终为 null `<c:forEach/>`，即使我强制创建数组：

```
public MyObject[][] getMatrix() {
    if(loadedMatrix == null)
        initializeMatrix();
    return loadedMatrix.getTable();
} 
```

该`initializeMatrix()`方法从数据库中获取相应的数据并调用创建二维数组的逻辑，`loadedMatrix`一旦创建就引用它（所有这些都有效，没有异常或错误）。`initializeMatrix`结束时，`loadedMatrix`静止`null`。

我选择了嵌套`<c:forEach/>`选项，因为我需要管理表的索引以知道要呈现的内容（如果对象为空，可用性标志设置为 false 或者是否可以正常呈现），但就目前而言，我认为最安全的解决方案是创建自定义组件。

* * *

*我的问题是*：在知道我正在渲染的索引的同时，我必须将二维数组的内容渲染为表格吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:54:11.123

您可以使用`ui:repeat`代替`c:forEach`，我自己尝试了一个示例，它对我有用。`c:foreach`是一个标签处理程序，请查看@BalusC 的以下帖子，以了解更多关于为什么不应该将标签处理程序与视图范围的 bean 一起使用的信息。

[JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)

```
<table>
<ui:repeat value="#{sampleBean.twodarray}" var="firstLevel" varStatus=#{vs}>
    <tr>
    <ui:repeat value="#{firstLevel}" var="secondLevel" rendered="#{!empty  firstLevel}">
        <td>#{vs.index} - #{secondLevel}</td>
    </ui:repeat>
    <h:panelGroup rendered="#{empty firstLevel}">
        <td colspan="3">empty</td>
    </h:panelGroup>
    </tr>
</ui:repeat>
</table> 
```

# algorithm - 使用均匀分布的 rand100() 编写函数 rand30() 返回 1 到 100

> ID：14217267
> 
> 赞同：-4
> 
> 时间：2013-01-08T14:34:51.163
> 
> 标签：algorithm

请尝试编写`rand30()`返回 1 到 30 的函数。

你有`rand100()`功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T14:45:35.917

假设函数返回整数：

```
int r = rand100();
while (r > 90) {
    r = rand100();
}
return 1 + (r - 1) % 30; 
```

其中`%`运算符表示模数。

当我们均匀分布 100 个输入数字时，要获得 30 个输出数字的均匀分布，我们能做的最好的事情是将 3 个输入数字映射到一个输出数字。必须丢弃剩余的 10 个输入。

我们平均多久调用一次 rand100？1 次 90% 2 次 9% 3 次 0.9% ...

平均值为 1.111111

# android - 如何在没有 iScroll 的 PhoneGap 应用程序中使用下拉刷新功能？

> ID：14217271
> 
> 赞同：9
> 
> 时间：2013-01-08T14:34:58.917
> 
> 标签：android, iphone, cordova, iscroll, pull-to-refresh

我为 iPhone、Android 和 WP8 设置了一个 PhoneGap 项目。

要刷新 UIWebView 的内容，我想为用户提供拉动刷新功能。

由于其他限制，我不能使用像 iScroll 这样的 JavaScript 解决方案。

有没有办法使用**本机**拉动刷新功能来重新加载 UIWebView 的当前内容？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T09:52:40.493

经过数周的研究，我发现没有适合我所有需求的解决方案。到目前为止，我似乎需要为每个操作系统定制一个解决方案。这就是我想出的：

*   **iOS 版本 < 5** : iScroll
*   **iOS 版本 5+**：[http ://damien.antipa.at/2012/10/16/ios-pull-to-refresh-in-mobile-safari-with-native-scrolling](http://damien.antipa.at/2012/10/16/ios-pull-to-refresh-in-mobile-safari-with-native-scrolling)
*   **安卓**：iScroll
*   **WP8**：需要自己的定制解决方案

另外应该注意的是，WP8 用户不习惯“拉动刷新”，因为这不是 WP 上的常见行为。因此，为 WP8 实施 pull-to-refresh 应该是经过深思熟虑的。

# asp.net-mvc - Visual Studio 禁用打开生成的视图 (ASP.NET MVC)

> ID：14217275
> 
> 赞同：1
> 
> 时间：2013-01-08T14:35:07.987
> 
> 标签：asp.net-mvc, visual-studio-2010, visual-studio

有谁知道在使用实体框架生成具有读/写访问权限的控制器后是否可以禁用加载到主视角的视图？

手动关闭标签变得很痛苦。

任何信息将不胜感激。

# android - 阻止 popupWindow 在 popupWindow 内启动

> ID：14217276
> 
> 赞同：2
> 
> 时间：2013-01-08T14:35:17.007
> 
> 标签：android

一位用户引起了我的注意。我正在启动一个 popupWindow 并显示一个编辑文本字段。当他与 EditText 字段（可能是拼写检查器或类似的东西）交互时，他的设备似乎正在尝试启动另一个 popupWindow。现在我听说 popupWindows 在启动其他 popupWindows 时遇到问题，但我不确定如何或是否可以阻止它，因为调用函数是我无法控制的 HTC 库。

我看不到 HTC 代码，但我猜它正在尝试使用“this”作为上下文来调用弹出窗口，在我的例子中是一个 popupWindow。再说一次，我可能对问题的原因很不满意。有任何想法吗？

```
0android.view.WindowManager$BadTokenException: Unable to add window -- token android.view.ViewRoot$W@479562d0 is not valid; is your activity running?
1at android.view.ViewRoot.setView(ViewRoot.java:509)
2at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:177)
3at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
4at android.widget.PopupWindow.invokePopup(PopupWindow.java:828)
5at android.widget.PopupWindow.showAtLocation(PopupWindow.java:688)
6at com.htc.textselection.SelectionAnchor.show(SelectionAnchor.java:121)
7at com.htc.textselection.TextSelectionMethodImpl.showAnchorCursorMode(TextSelectionMethodImpl.java:1290)
8at com.htc.textselection.TextSelectionMethodImpl.onTouchInEditText(TextSelectionMethodImpl.java:2113)
9at com.htc.textselection.TextSelectionMethodImpl.onTouchEvent(TextSelectionMethodImpl.java:1922)
10at android.widget.TextView.onTouchEvent(TextView.java:7166)
11at android.view.View.dispatchTouchEvent(View.java:3818)
12at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1131)
13at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1131)
14at android.view.ViewRoot.handleMessage(ViewRoot.java:1806)
15at android.os.Handler.dispatchMessage(Handler.java:99)
16at android.os.Looper.loop(Looper.java:143)
17at android.app.ActivityThread.main(ActivityThread.java:5073)
18at java.lang.reflect.Method.invokeNative(Native Method)
19at java.lang.reflect.Method.invoke(Method.java:521)
20at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
21at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
22at dalvik.system.NativeStart.main(Native Method) 
```

# asp.net - 在子文件夹中配置默认 角色提供程序

> ID：14217278
> 
> 赞同：0
> 
> 时间：2013-01-08T14:35:18.870
> 
> 标签：asp.net, roleprovider

我有两个自定义角色提供者。其中之一在根 web.config 中设置为默认角色提供者

```
<roleManager enabled="true" defaultProvider="COS" cacheRolesInCookie="true" cookieName=".ASPROLES" cookieTimeout="10"
             cookiePath="/" cookieRequireSSL="false" cookieSlidingExpiration="true" cookieProtection="All" >
  <providers>
    <add name="COS" type="ServiceEventDirectory.COSRoleProvider"/>
    <add name="PINS" type="ServiceEventDirectory.PINSRoleProvider"/>
  </providers>
</roleManager> 
```

我需要的是能够在我的 Web 应用程序的子部分中使用其他角色提供者。如果可能的话，我如何配置它，以便在应用程序的此子部分中确定角色时，它将使用“PINS”角色提供程序？

我最初的反应是覆盖子部分目录中 web.config 中的角色管理器元素。这给出了编译错误：

> 在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。

# java - 如何扩展基本成员字段？

> ID：14217280
> 
> 赞同：7
> 
> 时间：2013-01-08T14:35:22.327
> 
> 标签：java

我有一个类（Base）和一个 InfoBase 类型的字段，其中包含一些信息。Base 的专业化（Ext）需要保存附加信息（InfoExt）。因此，Ext 将 InfoExt 分配给 Base.info。但是，当 Base 替换 info 时我遇到了问题，因为它会分配`info = new InfoBase()`因此 InfoExt 的附加信息丢失。

因此，我创建了一个`abstract void assign()`in Base（变体 A）。在这种情况下，每次在 Ext 中使用时，都需要将 info 转换为 InfoExt。

因此，在变体 BI 中还创建了`abstract InfoBase info()`.

```
 variant A                        variant B
+----------------+  +---------------------------+  +----------------------------+
| InfoBase       |  | Base                      |  | Base'                      |
|----------------|  |---------------------------|  |----------------------------|
| + name: String |  | + info: InfoBase          |  | + abstract InfoBase info() |
|                |  | + abstract void assign()  |  | + abstract void assign()   |
|                |  |                           |  |                            |
+----------------+  +---------------------------+  +----------------------------+
          ^                      ^                               ^
          |                      |                               |
          +                      +                               +
+----------------+  +---------------------------+  +----------------------------+
| InfoExt        |  | Ext                       |  | Ext'                       |
|----------------|  |---------------------------|  |----------------------------|
| + id: int      |  | + void assign() {         |  | + InfoExt info             |
|                |  |     info = new InfoExt(); |  | + InfoBase info() {        |
|                |  |   }                       |  |     return info;           |
+----------------+  +---------------------------+  |   }                        |
                                                   | + void assign() {          |
                                                   |     info = new InfoExt();  |
                                                   |   }                        |
                                                   +----------------------------+ 
```

.

```
 class InfoBase {
   public String name;
 }

 abstract class Base {
    abstract public void assign();
    abstract InfoBase info();
 }

 class InfoExt extends InfoBase {
   public int id;
 }

 class Ext extends Base {
    public InfoExt info;

    @Override InfoBase info() { return info; }

    @Override public void assign() { info = new InfoExt(); }
 } 
```

这是一种常见的情况，用通用的方法如何处理？变体 A/B 有什么缺点吗？

如何在 Base 中提供一个 info 字段，子类可以用来存储扩展信息？

谢谢您的考虑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:59:10.947

也许这样的东西是你正在寻找的？

```
abstract class Base {
    private InfoBase info; 

    abstract public void assign();

    protected void setInfo(InfoBase info) {
        this.info = info;
    }

    public InfoBase getInfo() { 
        return info;
    }
}

class Ext extends Base {
    private InfoExt info;

    @Override 
    public InfoExt getInfo() { 
        return info;
    }

    @Override
    public void assign() {
        info = new InfoExt();
        setInfo(info);
    }

} 
```

这将允许 Base 服务`InfoBase`对象，而 Ext 可以服务`InfoExt`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:57:54.783

如果您有一个 InfoBase 的子类，它的数据将被主要访问，您应该将 Base Class 中的属性“info”类型更改为 InfoExt。

在不久的将来，也许你会有任何其他具有不同数据和行为的 InfoBase 子类，你怎么做？在这种情况下，我建议你使用 GOF 的 Bridge-Pattern，它会帮助你解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:12:15.100

我不完全理解你的问题，但这里有一个提示：

通常，在实例化 Base 子类时，您将让每个子类在子类覆盖的第二种方法（**初始化**或类似方法）中执行其特定语句。因此，例如，每个子类将使用特定的**InfoBase子类实例化****信息**。

 **之后，**Ext**应该只覆盖需要 InfoBase 特定行为的方法，将**info**转换为正确的类。

这是最简单的设计。由于我不知道您的代码的复杂性，因此无法为您提供更具体的解决方案；但您也可以考虑使用适配器模式、策略或状态（当然取决于要解决的问题）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T15:09:04.773

如果您正在寻找一种避免强制转换的方法，这可能有效（使用泛型）：

```
public abstract class Base<T extends InfoBase> {
    protected T info;

    public T info(){
        return info;
    }

    public abstract void assign();
}

public class ExtBase extends Base<InfoExt> {

    @Override
    public void assign() {
        info = new InfoExt();   
    }
} 
```

Info 将是子类 ExtBase 的 InfoExt 类型。前任）

```
ExtBase b = new ExtBase();
b.info() // Returns Type InfoExt 
```**

# c# - 如何使 Active Directory 文件夹中的用户可以在我的 ASP.NET 应用程序中看到网络表单？

> ID：14217281
> 
> 赞同：0
> 
> 时间：2013-01-08T14:35:23.587
> 
> 标签：c#, asp.net, authentication, active-directory, windows-authentication

我已经构建了一个用于 Guestconnection 的 ASP.NET 应用程序，它有一个导航

*   添加用户
*   日志
*   帮助

此应用程序将在我们的 Intranet（共享点）中运行，我希望只有来自活动目录中的文件夹的用户（例如 guestadmin）才能看到导航日志。

这是我的主站点：

```
...
<div class="cssmenu" id='cssmenu'>
                    <ul>
                       <li class='active'><a href='UserList.aspx'><span>Benutzer</span></a></li>    
                        <% if (true)
                          { %>    
                          <li><a href='log.aspx'><span>Aufzeichnung</span></a></li>               

                       <% } %>                 
                       <li ><a href='help.aspx'><span>Hilfe</span></a></li>
                    </ul>
                 </div>
... 
```

如果 authen.. 用户在这个广告文件夹中，那么我想要得到 true 否则为 false。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:45:24.140

我猜。这可以通过使用目录服务来完成，您可以在活动目录中搜索用户，然后执行所需的操作。尝试使用命名空间活动目录目录服务

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:50:03.817

看看[Role Provider](http://msdn.microsoft.com/en-us/library/6b241xwt%28v=vs.100%29.aspx)。有一些实现，包括[WindowsTokenRoleProvider](http://msdn.microsoft.com/en-us/library/system.web.security.windowstokenroleprovider%28v=VS.80%29.aspx)。

以下是基本的 web.config/system.web 设置：

```
<authentication mode="Windows" />

<authorization>
  <allow roles="BUILTIN\Administrators" />
    <deny users="*" />
  </authorization>

<roleManager defaultProvider="WindowsProvider" 
  enabled="true"
  cacheRolesInCookie="false">
  <providers>
    <add
      name="WindowsProvider"
      type="System.Web.Security.WindowsTokenRoleProvider" />
  </providers>
</roleManager> 
```

# c# - 参数对 XML 文件的图像读写无效

> ID：14217284
> 
> 赞同：0
> 
> 时间：2013-01-08T14:35:46.777
> 
> 标签：c#, xml, image, bitmap, bytearray

我有一个 XML 文件，其中包含一个字节数组作为字符串。（微软徽标 Gif 图像）

```
 <CustomerLogo1>R0lGODlhbAKrAYcAAP///3Nzc/JQIv+5AX+6AAGk7+vr63Jycmtra3BwcGpqanFxcW5ubmxsbJmZmXR0dG1tbQKk72lpaf7+/m9vb9LS0v+1APNaL/FHFhCp8MbGxnx8fO7u7np6eubm5vj4+Orq6v7//5iYmHl5eby8vODg4Iq/IEe88/+/IP+3AHu4AACf76SkpPaAXwCg7v+9EH+7APX56Xm2AP/KQUu99P/56eLi4oe+D5/LQPZ+XPFQIni3AIeHh//LR6LMR5ubm/39/b29vXV1dXt7e9PT0/T09PLy8pSUlPf394CAgPv7+/Dw8Ojo6Pr6+vX19ZOTk3d3d+np6Xh4eM7Ozu3t7a+vr/Pz8+Pj4/z8/NfX17Ozs/Hx8YGBgZycnNHR0X19fZ6enrGxsfn5+efn5+Hh4ZKSksTExO/v77e3t6enp8rKymhoaIyMjHZ2dp2dnYiIiMXFxZeXl97e3mFhYbW1tY+Pj8nJyYKCgqKiouzs7LKysv/GM8LCwpXGMqCgoH9/f9TU1H5+ftbW1oODg7u7u8fHx8/Pz4WFhdnZ2fb29ouLi9zc3JWVldra2tvb24aGhtjY2JGRkd3d3aurq+Tk5OXl5aioqMvLy62trcHBwcPDw2RkZM3Nzb+/v8jIyJCQkKmpqaWlpcDAwGZmZomJibi4uLq6urm5uaqqqoSEhK6urqysrLa2tszMzN/f376+vpaWlpqamo6OjoqKiv///tDQ0NXV1Y2NjVTB9Qyo8HS0AP/NTBGp8KHMRv+yAP+6D/JSJP65AfeHZ/FIF//KQv7//v7KRv/+/vb56v+8Fky99PiiiEO485/LQqLMRoO8DwCf7vNkO//56P/PW6jRW/JaL7jYcv+5AvZ+Xf7+//JQI/T56f/IRPE+CQKk7ky88x6u8YC6AXvN9p/LQaXOS//46fNYLPJRI//YdP65AHi2APR6V/V3VHm3AIO9Fv7LR6LNRoe/Dw+m8P/56v/554G6D53KQvP56Pf67v767Z7KRUS58gCa7QCe7wGj7/WAXyH/C05FVFNDQVBFMi4wAwEBAAAh+QQAAAAAACwAAAAAbAKrAQAI7wANCBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDitQIoKTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDCh1KtKhOgUaTKl3KtKnTp1CjSp1KtapSpFazat3KtavXr2DDij1qYKzZs2jTql3Ltu1TrG7jyp1Lt67du0nh4t3Lt6/fv4C96g1MuLDhw4gToxysuLHjx5Ajb2UsubLly5gzy6SsubPnz6ALcw5NurTp02NHo17NurXroqpfy55Nu/bK2LZz695NGjfv38CDN/YtvLjx43aJI1/OvHlY5c6jS5/uchQ69evYs++0rr279+8quYMfT/66+PLo0x8/r769+9zs38ufvzo+/fv4O9vPz7//4/3+BShgYAAOaOCBdRWI4IIMpqVggxBG2NWDElZoYVQUXqjhhrCVxeGHIHKVYYgklriZhyamqGKHK7book8jvijjh18xzmijhTXeqGODOe7oo4E9/ihkf0EOaSR9RR6pZHtJLukkeU0+KWV3UU5pJXVVXqllc1lu6aVxXX4p5m9hjmmmbWWeqeZraa7pJmptvilnaHHOaadmdd6pZ2V57umnY119/inoYYEOaihghR6q6F6JLuooXY0+KmlbkU5qKVqVXqrpcyhu6imdnX4qKp6hjmoqn6Weqiqgqa7qKqGtviororHOaiujtd6qK6S57uorpb3+KiymwQ5rLKfHJstKVqbKNrtYsc5GKxWz0jZLbbXJXoutsdpuK2y33voKbri6jkuureaeK2u66rrKbruqvguvqfLOK2q99nqKb76a7suvpf7+K2nAAjtHSnDBih6MsKEKLyxoww77CXHEek5MsZ0WXyxnxhq7yXHHan4MspkijyxmySZ7iXLKWq7MspUuvyxlzDI7SXPNSt6Ms5E67yxGZM8++wh00DoOTbSNRh8tY9JKu8h00ys+DXWKUk9dYtVWh4h11jRCy3W2Xn/Nbdhif0t22eKejXa5aq+Nbtturwt33O7OTUh3vHbfTW/eet/Ld9/6/g14v4IPDnDhhg+MeOIGL854wo4/znDkkj9MeeUSX455xZpvjnHnnm8Meugej056yKafTnLqqp/Meuv/Kr8Oe8uyzw5z7bbPjHvuNu/Oe86+/85z8ML/THzxQr8ezQXMN+/889BHL/300AMjDErk1BPPDdx37/334Icv/vjeP9MHMsijCpU5ArTv/vvwxy///PTHj0ELKOEgAwwE9O///wAMoAAHSMD/qcAEMUifZLp0gfo58IEQhN/98re/Alrwghj03wETqEDIMDCCIAyh/fB3Ev3xL4MoTKEGEdhBD76ugSKMIQgnWMIKqvCGGNxgC//zQhn68IE0NIkJcUjEAupwh8Pp4Q+XKL8glmSIRYwiAI+IxMR8kIlYdJ8TAQBFKXqRilWEFVRgmEUsbrGLXowiGMMoGiWWkYlnFrRhGtXIQjaK8SlkfOMP43jCORZxjXb/pNUY9QhHEgpRjn7EISAD6ZcrEtKHfEzkH+vISAK58ZExjKQkFUnJSv7FkZgUoSY3qcJFehIvoAzlDA35RESSMoOmDOMEGnlJVUZwlK+EZSdPyZdU2hKIrOSiK3NpwVi2EAkeyIIhNFCIKQCiBEZITi1/6UBcErOYu9zhEjQAhkG0gQEQaEADIMCAAHwhEkTg1SCpectgovGaRsymAg2AiQ0gAAEUWEAA9snPAyRgE6hQJx7Z2U4K9hGe8eTgbD7QhEUBoRMdkAAF+EnRiiqgCgJ1Sh4JSj9rIlSAxsTJLOsyUpZ4QA9leAQp4tAJKwCgpHpyghsUkICK2pSfF81o/1M2ytEmunOYH52iPHmSBzNo4KhITWpS+YAIphjBqEqNqgbMYIcPuIQQD5BAA8CJAAncIQsvhamcjFAHCdz0rAHI6Vx82VMJ/vSgQQ1gSHEyhU2sQQJ4zate87qJJCBhKVqYw14HKwEFrCEAVGgJHdaQgAdUtAELaKqemnAEs6L1pmqVC1vbqsW3xpWAc71JBRhwgMvu8wEHaAAnlIKEVDDAsZd9wAI2wAGWCKIBNbXpAxowCJfeqQqWPa1p95nZuGyWswLw6Gf7F1qbjLa0ww0AAhyglCkgILoBSABtWRILBVxWAny4kyPyiVboHmABCzhAaYurklmKdULTRG77lOu73ObW5LnYXYAQPFCS9/rEAdeNrnZrq5ItBCK3Z1WAG+yEhSMgALb8dCx0GYCAxsr2nqPAaHvdixL/VuW4nKXvZ+1LE/xiFwF0MIoNZIvdAa+EEm3QJ1obEAkPjwkSEIDuWRHwiFMgwgMeWEQh8HCAgLoECGMgRDq/AuK2ijiuJJ6JiaPLgEP8lShhCO5wXaySMUgBwTdtwBPsFAoFQNimEJhEEVQSBTKwRAmLQEMd2jCHU4ClyT19clCjLJMpDze1hiBKEbgwUR1flsspEcMjyolWCVhiTkVIwkR3/OiZWAEQq3jDAhQAgU2//+LO8ZWvnj/K55j4ebgIWPBQ7NAA7O4T0SkJw2HPugAISPZNiyDtWSnwB9++pAmcwEMSGKAAXRM3CKBep3zdatDlgnSoOzm1aRcAhSgIZQJHaLWrYY2SJdzBzDcdRRpsLCY+eNfQONXDZg6wBgqgO63IZnKokTtqhJYaJtI2rQTQIJQSnNfV2d0uS66QhHbzs9Zr+MGV5bQK7970ABRoxGZGAGaKKiDegpl3iD3rbKEqFCj5viwDeCCGoDT8zFsWOEu2AIoOMKABFT5EJ4DQXzmBweE2TcAI8iATEFA8wRiHr7KX3dlmd9yA0NZJyC8LAVsAxQhfmPS2Vd4SDmTBE/+tkINV9fSDANuUAlxwwsQrjtOgi0jjTub40Zmb9JwsHa0I8ANQ4OD1qRO4JeSeU9fPCgEebB0mBvg5Zs0+GbTnWe1rv/dL3n7WBEDhb1iIBATO+m5+cvtSe7/pyP/+ksCT/djJHijR31dveCreJSFHb6NJ4BNJJKDyqm881TWVeZtufuxAD71GR096xB/99C3JNwPqoAipVxQCs2goT9JQd35S4BFHMD5FL5+YvAPF+tdmCvZx0oXm85MBb+C8Szyfe3kPffSlvybwWZJvBODBDN7f5wEYIAieLGEIMhZuACRACFXEP+B3hxbbdx/k1n1ndXsxQX6Dp3s7xXtFV0P/cNVx67cS+dYAXXAGHfB5aYUHPJEJOEdRC/AATAAK/0d9T9EEVEAGWTAFR+UJXuAITLBmJzGAMpEIVAACVOBrNvEBeVACgsCCzDQFWUAGHKAESZEITLAIFWAHzPSCY6CDPzEBW+ABjlABnnBUakAEixCDMzEBXrgSbvB/DEAKNBcTSyB4NqUAmcCATMFTy5Z+xDSBKlGBIgAAZdZ4IxCANqEEbDB5NtUAdRgK2pZzs3cSTWADrlACiriIiigJS6ATWGADnQAGpDACAQAB95SJCSAESXAEk2AIeogSYkAGjLiIpOgKYocSeRAEDjAIIyAFI/AHdaAFC/cSSOAIaOAA/4cwAgcAAQqQiQgweR0wC36gCWMQFB7wCj/gTQkAjLjFiU8ACmrABDwBAnaQBnXwBULQjMBYYULABUdQBYIggzAxBnJgiiVgA0/gh183CItAiqUYj+lYC1KQf4+lClcgj4poA1OBZxwFh7kkhylBhwDQCIyGWZ2gEzhWeQiwWixQgoVoEj73eupVkeolAax3ExxAArdwAL8IAQmQXhV1XhSAAL/YAX4ACWWIEh5wXhZZkQvQAF7wUiWRCGEgBb/IAAmwkxQgUcf4EldQBYfAABKAADopkhR1Xgngi2Z2BJ6QiiZBg/1VAXHwADn5eiO5ABTQAL/YBk+wWjbhBHYQB/9QYJIQkE/vRpJcCQFcsAr8+BJPgAAvWXkjOZd2WZGmVVp3eQAd0I+G94++J4FthxMEiQV9yHeKYIQ4gQfgVlEMwAWJAAAPKXuhKJFSkE/olZnotQaEYBNUUAUjwGn2KGBFeWsn0ZKYqZkL0IwVYBI2wAMGl3PV1mEo4QpucAASYGyutgAmeQd8oJg2UQIOhgAhiHJotQCbwAYrGRNi8ArfRpyudgCo1ZMHAAaU4BJPoACqOZo2dV7b+Z2ZmZfgiV4j4JfnR3QA+UoCiRIECQCv8IFJSQGmSRNUgIYUJQEaNpk3ZYIAAAIZmGAZKRNAEAQjIAGNBXD9FAAN0Jop4QH/LNadEMCgkiAF/5dds7kSibAK0sWdCEphn+AKMlFSonAAFRpbEPAENLd9tvAGxYag3akAbVAKy4kS2eaiNnqjQ2CeoueA6UlK63kS7XkGQ3CgaZgGOGEKWnZwB3AFJaGfhFiZJeGfGqgAAVqOR6AAFPAAxhmdELBkLPmgIxmh/fkFg7ifF5oScsCiIXijfygEGjATWIAKNBUAW2paDwABZTCjLIEFYbCVbJpzEgALUFqjf1qoppWj0/KXBNWjm/SjJtGeAMB8W6pdZ2ATTfAG7EhRDcAIZeikFcWfUgqgMpEFQ+BddcqlXnqaYJqUEAAIAMAI8Cmb1pYSUyAEDXCq/zfajCkWE5OwBnSZl/uEp3qqEk4QCxLAoYWqAIdAjSlBqIb6rDaFqBiiqOzEqJLkqCUBqY6ggWm1hjUBCJmqqXZgEp46fREZpf+JWVXaEoZwidDai6lqEg7KoanVCFNQpo13pibRCgkgfdAaALjJby+hCdAZXXUqrC9RBGWQpP8qXXcAAs2Krw1rqNIKFf64qIHpbNgKAJCqBLJwkMf3CcPqEmF4UxSQBORYrpZ3rv2Zrmm4ritBBPMHcN5ZefCqEvP6cBTQCh+LqxY6q4/arz4rfzW7mw1QCC4RBZeJVo61AOA0TjqJbgjbEmIQBxIwtPKHXr+KWWwAlSXhrBNrsAGH/6qju+eAyZWx9TWYoqWbmlqHJpEJ/+dPi0ATTCAE3GmVGtakEAmlLTulMJsSVzACIItWCcCV5dQGdgtzndZPXYqzq9pPQuAGLaavlSC4uCpbvphjQpC4Rvmr0DVRbsYSaRCr04cAQvAGRxAHZUAKQ1CSDQBdU8sSqzBrplWS+PQAbfAAFFZh0bUGoQBTcTmXf7aXL4mU5ZVed9mXiXqebxhM4wBUaftxPwGpALAFG6CBCFBpMsEKDAuwCxC6ekuZLBGq6uoSSKAIDxZbxNYBbhAEREAGUTAGktAKWvAEQtCiN9ugj0tRqBVhvagAAPyLDUABjge0TRAJpAuCZsYIpf/gBa4Qv5JwCWFQfBJrUwhQB8CpivWIVhAwAmjABFs3AWKwBItACIwgBBJ1oiNbEtYlnUzHW5agAY3gAVFwBbYwiQXKrfLXAFNwEk9QwWEbW2hVsW/xOtWgA0icxEq8xEzcxE78xEqsDecwDP8QAgBACyXRDDuwdv4TDge0DUNBvQBgCQmsXdEUEx8wlGH2BDClsq/GsuT7si4BXHkpAVzwCollUqzABSkcryWRs5RHUeTEBqqgAYYAB2EgAh2wBgsAtCTQvQAbrAuQBte5Ek1gCw6mw2klCjSJEvDnwrbHBW9pUnoQCJsgsixhBEkQriMpAYdQCF6LElSABhSqfxX/daepAJVMkI420MtkQAnruGt3IAm9XMzGfMyUUAEbHGaq4AHHbMyVPK1QAQwYUM3WfM3YnM3avM3cjM3D0A3rYMUm0Qe60A47cM7onM7qvM7s3M7ujM7qoAvucA9hzLb8BIgo4QjGW1EI8KbYd69ndbQo4cYAOL4ua1F/O1JXEABr2ngMgApQyBJWUApSsAl+DACAfFkk+gZEkMElwQGaoAiVUBIYOFFbultJAFYvMQFBoJWnCgEoqxIEfV7zyRJLYAlPgAUskWWXxZuoEJkv4QGy0JhnJQHx5mEle1MQ8AYDeAb2aXGcbH5PIQw5UNVWfdVYndVavdVcfdXY0ALs/7AMKGEN9gAPvdALPpDWar3WbN3Wbv3WcO0DzqAP1IAP9Vx5+FxzQPAJrLxPDZCnMeEArYZyvEaO4bufcHzQFve3JtEFCbxP7jauMFFSTFAGteC4yCpcCgAGqfiFnQwAibB1eiABv8pjXuMF/nRZCBBeKAEEddDXl/gJM7gSJWUAWOBfefBl5YUApTATSBAHjx0AFGBlLVF7jul3E4esF8eGihECxXDFiCHGAKAJCXxeJQATlbC/0jUJKUHQoKrYOMXYAFAC+1xR6AWWNRcTSmDY8qrdFDVdJUfbJ2Fg3EoBQ/CTk10ScJBjN6WlEHALOl1SH7BoAQ0GPoEGwc1eMP+RCIoA237dCsUthsidgE9ddsxtIdK9BBvgr8TF3S8RBvF3XpLQ3Xtr0H7LEmRcXg1AeDuR0ZrHBY8YE9RdXhBwCTfhBxV6XnKAEolwBxyuoNTFEwM+uIJ8C8pHE3Lwbztm4Cxh3BSFgIBX4aAn1RxCvSMlp433B+ydEk5AaO9GY3rq3Yl94ioBdT8uXbEglTDh4n+oBiEKC0CsoCKg5iXBBFDArQogsCYx4Bz+ABRwB0CtE4JA5P1EAZCAEyRIuIEQTf7l5N834VE+pSyeFUBzDFj8Fdlw6UEh3QAgB+XNTwjgCS6hBv+HAHAg0yW+EnGM0CvBCXGuX0yKjO59p4r/oNMxQQUdgKwQp9I3QdAKyggwxYeE7tcZSecmUQWPvanGDgBX0L8HmE6NLuHi1xIKmIaTbhVSEwLavu3c3u3e/u3gHu7iftdh5ratHQkV/AAIcAQ2BgSMUMEJ8AVbgOriq+rgTVyMfYc7xgJDweb9pAAJKROc4OAMkJg3MUtEMOzZFQhQ2AUSC1v6ZAaQKAusDFsNINkHXwYOjgB6nhKOvk9Q3nlSDm8XnhS4cAIon/Iqv/Is3/Iu//IszwziUAxY7IXowA098A49sPM83/M+//NAH/RCz/PGMA35QO5/aO4oAQcJnF6xrhJkoF6YBQorIeZ8u+qLrRJiwAPDvuv9/+7eCdAG+A0TyA53WqATkaaB6jXiJ0EHwV24XTDKNcEBud54QxDjOEEIFYoATK4SHx8AIT9+I7/cVN4U8uACiJ/4ir/4jN/4jv/4iw8N/LAPKLEHvmABmJ/5mr/5nN/5nv/5m+8LyUAPSP9YSn8SRhAIP67gJjEJpCu3VZ/qKoH14a0SdYuswx3fso6sDHALZYh9IgDE8+eqOiHYMybqJ9EI7qbRcokHO14TWfDpfg3sOpEFWKl5bHDkKPH3gU/tg3/tH/Y6vBAB5F/+5n/+6J/+6r/+518AK6AMKEEMFjAAwTAA9n//+J//+r///N//ADFgQLoUKMoBQJhQ4UKGDf8VVmBwIMBEigEaiHAIYJKEBxUpMuDipKGVLxQ8BnjQ4BMQhywQnJyYYAOHjCA6JIAZQAGJhkQg5NSJJ+NQogk9PFiQE0GoogqR8GAA80GCEQaaEtXzUilPhU1m/QQaU0ECWJdENp0AwIzWkwcUVLk6lMoQnDAT/DHi8Adbjwx4fIhrYETdkwqCxEWcOKMBq4odL+QVQfJkypUtX8acmbI3f/2+LSRmYUAwgaVNn0adWvXq0tcKSntcFKLEkxczlkhA+ySCVg3hKMgpgU9Glzll0nRok7DHnQ2DAM9pOHbRo0lhSjiFeMnNtgEoHBITOy0AOA2AIlDFsBD0nB0nHkD/gOBOKeTjM9Lh6xGBpukImxwyCaYFpKBCr/w++iuwwaI7rD8HF2vsQcQyKKBCCy/EMEMNN+QwwxVoWGgG0VgjsUQTSyuoBgkZmg0m2xhKC4gnzIMJgTgYAuITsDyiYIMziDswpplq4g6m5hjCRAH3PDoAAi9WZKg6pQq5Ki0m2rDuJAjKsC+2WnbcjamFsIhDgomWDIsBBUaoYouiLAlyIgiImC7GMsCs6AAhKjEwJ78Au0qw5SqSDkooGTP0Kgo7ZLRRRy2M4MMQRzyxUktRREHFRAFosTaMGkqrEATQpGiBB/hEKC1JcrsujaGKs2vI5IosjKuF8IhzgQUk2RQh/ynbauDJuMgIQDf9uugvrSyiUsqNhvIYJE6gElDgCzMS6jIhMOI8gIJGHhSBxrYeuKJPmP5UcFCKCu21P0TbzWjRR+elF1JJFRLxUn0rTbHXTj160SErAgmwMC2wBcAS9vJkAJFX4zyOSHUnOnIhN8T1KCkb2v2VSQgqQAwRVmv048FlzwMDRgA8uEMCY8M6kwIEHMgjoy64fYCMB7fN6QByzT0J3UAXNLJBeGN792iG5K236UYjBRFfSvelWrV+N/23ooAdmmThiigYBImEzhii4IogYEOJh42TtSHlorNVoSfwLPWBjXvtOM+PERNk5N1SdvDkZlUGIA9YFDAbZoSKJEjCFYdu7lmIch3kGSafJ2doLz8THHpinYxWWrGkQ0+IaadP1xDqSatmPbWrE82aoq0bIuOAl99rYIqERPF6XVGIgvWkiGf1vGK56UZJY46RsnzvuLLwW7+SA2e2RhaGAiKTL8ZSnKKOEBhCZ4YgtzwBOcDFOM8HKAG6L86bEpRB0h3/G31+01HHv0LVpW69f0w1hV1EXPSpjEyAEemjCAJ+gBAl3AKB3unAj9YWK+S4jVbMiVtC4vDAYiXAEcvLkt5AFhc52C4nDbhRnQDgBeRNBAGYKMoSVDECBCQOZghIRV4W0gUOBoABWXCQjFqYACnUrCGaO9f7ihK/os1PdBFy4v3yh7r9JSRf/uvf6wwVu4nMriF2OFBHFiCEMQAAEgIszPWAB7G2MeRtRsogQvzArdwhDEp5o0iTRngVDwghhGdThNrEAwANcPABCMjOUMZjAC38QQHmIVVwUMGQNPSOIhBQg4OUABXjfMFNR4yT0OBHtMKAzonwg6L9prjKAlQR/yFXxCLrtAglLlqEgBlxQhJsSDFWAIAFlvQhJACQrYUEzyPDs2Dx4ggAUABTJ73EG/Pa4ryrnOGCFbmLDqfDijgdUgOIsQIc6gABBPxRQKdaiBakhQA0OOgMG/AcA2YRHlBuDlCjLJ4pT0mU+pFOiqyslysBAMtYUm2WK6qlFxuiit51RJ5j6MAfJcKAtBXFmNhs40LeWKuGnAKYh4wFCJu3x6Z84BHVY1IAztefi/VsAQ6rEkKAAAgHJKCbi4OLQvggrQYAbjqLMKGLFti+iohyiaRkjj73CaGl/hOg8xIoQQuqr4NKKKG3zIgNgnoSIZRhAbfTySuaclGKINON1/9c1zIr0ELvfEGHxOwPHt9DTbTEga0I+N10kJCKXQZAJp90zCKOgIAERPKSsxAkQgTR1weATWxpgasiAcCHHiLgYERF0D2Pms+lBiqV/nwq/qI6taleqqoPumpdOdgtlAhvBAWyKBsreFZlNiQKWOoZJqNpzmLRtSlVcCYEYBHZq8jhqyeMBHGbAgRRNBYoC4ACCBTCgREkxbAUEMQwY9NSyzFAWPVMomb5iVRCibWzS/xs6Jwa2qfdy4qkLS2/MuUvNAIMqxlRw2rPI5SxylZicGuIEhSBUoAdgSWJkmtvSdqUKTQArMXa03T04EwJXLY/tQgAb2MCxIQAYZznEdP/YzgQUeNEMCNIDJoSx+s5BJjivOhtKntPN9r47uu0DkptU5xwBwIrjgHZ7S/bZqtRtFJsmQBIElAOwADdIViaHltwUd7puQAgABSxKQIX+uodYT4IFNJiwCUWogczGQcKTIgNCZzZAAcMBcXuE+9QmFiYnL6Yqftcr4w5ROMam3a+WKuv1u6bkTCUuXs+JEUTrkJWIQ1ZIRvFoEMcQYEH+/AOS3Ayb/WoGPJZ7gArVYxHDevDN9DTQSx8cAO+qRBHRE96jzGCloGiajeHUsVDyQN516VGOzukn+rVc9P43Gf5AnCLgZbdoB1yhQdUujAuXrR/iQfghjSBDWytchzo/6nchnzACtpVSII3nZhL9PABECDFWdCCkCu0gcoKIARDPhAFxzTC1R8xxEKUcG0l0zqmCKnkqCmQhG+f2NZxzsgSAuE5CNSB2+f9tdLyHOwMDZvYJrpxf3J8lXAdmojpbYm0k0nthpjBmcVSQBcSkaq4UIIN+Y7Sk0WoGCQcoseEcgDCQQWAJTyihxToAE26tIRUECKxD+cUst+TAF4thA8nT8ACYF6U8XTCwUBRADQj++ai3hqXshaQENDc64ZE/GgTp/iFLH5xEmV8OhtvCieurjgFTC/aQv4vHDOy15sTig13a8oS9PCATdAp5pr27VV4BzMJREK6TaHEG0YFFP8J0KEhRfjCGuoACKQjBE45WcAQML2QHbN1yQcYTlOwgAYIaNg7Gxi9we0ZFyywoe9VrjPZFWJ2eKE97fpz7yvhy3ar/TmAYFVoRhIxiNvncU6IYbRfM/roIuvkyAhRAwKcbZEHYKKMGQFCCTCxgbE8//AjdcxTzFNp8JlCmw3ZwimgIK0AQGAQRbi8lhtAgSeooeBDmYID0LAGKIMDWwgNcJmwWICZcQTimgBIOAIFcD2dyISi4LrMQozKEZAF8IRqyySIA7mz+71HWTviKz5joyWls6XEIDOYeQAGKDXoEznaIrmGAAIHOLmJWAAFEII4IARIYIItMIItYAIv0AP/WXALnGgSw1sIcUu8qwAEBphA71CAP0gDNbCBMzACIzgDG1CDNAgE7mmPBWiAKEOIItClYmkABLBCTjAA8fqAK8CEA6AyCYi3hsACRuCIsICPBCgDU4AEAxBCIwABSDCFSKCAHqKYI8ACCzw4xKADZ5oKCgADLzCAIZQDQlAEIXgx3msX3/u9EjRB1HC72IC7pqgEv4IZBYC2uIg+syKy2tq5wgkECBi1iiBDBWCANhiCL9iANoAABYAA2rAd82tCmXM+M7wKTNhDmLGpl+gAX+wAiyCs9wCKNci9hUBDs5GZBoCCN3CAUMAEFogFHrCISgM6R0uIMRgBWwyLZiMn/wqQgiHYgF9kAAQYRpiBgA4YO6K4wIkwqqJoBErjwwaAACmoxx1kgCHoxBDsvRF0FFEcRdMoxcc4RaoTAfqDrsfrvFecvoSANEJZpgmALAAAhAXYMgFJgJVEPCYMN2ScK2UsKVgwNMWhwwSggOPqHglwAEVziG0UEAZYwwYgShWsCAlop6HwAgqgspNYAJyMukNjSkC4in/0Ia/LCJNqvlJZSdpgSBCMMYhkFImcSIGoSMe4yKKYAu3DOmRJDI9UR4QIybRqCk9ggJT0iFucK5c0CphUsOkwAkWoyUMjTAn4BPzLCKAkzLBAADYQG6IwAwZoysU8CQpgADuIC6sMyMGiKIUczImv7CxP7BVQTDuyLMuzVIy0JAq+yy2ZBBK8mza9a4pCWICtJMwmocrzmybXbIoziIQy2z7CbDYJEIH3u7w0pEwXCYTvKwo4sMzkVJyfELPMfETE2IJAsM2TAM2lEs1NIU2KM82JRM3EUE2iiETD2szYgs2Rk82mEIQvSEDo1BvD6xIn5E2iSAskwAPE0cvFZAAImASfHArFlM+JkIA/ADzJAgAiID9rLND3kAAu+BbE0EysHIr88pnF3M59/+rORPnOYAvPURxPxCjPoRgDIZgYCSgFx4DLvOOouKACHsI2xUGKTfiul0S8+7wKTRgCCXzQqWCc3mgKksBLZ5SAOqA3pBuPKPgBg3xQNWQAPIg96py9fwOAKojPQ9vQU+pQQ/lQPQtRExzRuCjRoXCAAzGVfpRBqViAj5TL6jOeq5gCUkCABpjCc1GAA8ADwMJR9JOQPEiDAJCA7GQSBliDEdCDgns4JHiDNbDT5KQACYCCUhBQxVADyXvU/syYOt28x6hQncNPLXDSQ5OChgxLsdyz4Buo4StLszS+FUkLQ9iENZCAWrVVCZiDSHgMWaXVW52DNnMMN5iDW7VVBf9YgwCArYZgggQYBWK11TlIysQQAzs4ggOQgBr6KsOiw2BsgEBAhQRdCEowVmet1TmYOgmpBEzgggYQxqjMk/folgaQAAjgATRI1rhYgkx4AiFAAGHMSbDa1vj4gyp4vOn4ADVgBJ1AACm0nA66RwSQgi4AhEZ8jCMYVnLdhD8A1aLwgjdQAMS5HQGUGQm4A1PFM1TtkDAlvjG9CiowAw2A2ZiFWU2whcdQAjt4WZnlAw94DETQBA2AA5mFWTiwA1BFAk8IWqGFWT7AHMe4AhIQgSSov4+l2n4dxiGog1WoAONkCCcAWqWFWTO41xUpggqYBFmIKHalWqodxj84Ai3/QARTewwmuARQ+IQNOAC1XVvCggJSSAND+D907YQuGAQhUBMF6FfEfaQE6Fs80ACHvApB4AOw1QAzmAKKTYzxQIJL+IEvoJa1FcYA4IJYyAQjCk3IHU2UTdWoea9WPUHdg93YBQArsIEKMINS0AMt0IJTMAMvcAUq6Dw7mwAqkANOyAQ00F0tMAU4qAAb4FMJmYAzKAEv0ATk1QI66IRLaAQQqNTgjQsn8ABBKAQSSF5WEAXtBQG5lV2H2IJFsANCyF0tyIRasAHEtLMuhZIvlTGVZTuWXd//BeAAnsXH8F4BNmAAxt8V0V/24t+L898DhuAIluAJpuAKTmAJWeDQ3mpgYnvgCvbgDwbhEBZhQ7ngB8ngp9rgPuvgEWbhFnbhFwbhEnaQEwaoFK6xFYbhHNbhHeZh7kRd71TdDbHh+MLhHjbiI0biJE4MGe4PGmalIS6tIlbiKabiKu5hJp4OJ14lKJ4qKbbiLwbjMKZgLI4NLZ4iLi4oLxbjNWbjNu41Mn4MM84fNI4lNXbjO8bjPN4UOHYMORYtVZUq13VVFNTjQjbkQyYdPlYMP6YiQGbVVrVjRJbkSZZkRU4MRp4xRxZkUnxVSvbkTwZlfvphDw3i1NHkTabITg7lVWZlT/a25Akp5Yo7ZVQe5Fa25VtG5FeOC0x2GjrGokjG5WAW5g/WZUWJZQzxZf8B5mFm5mYW4GJuCl4Wtlmm5WV25mvG5jceZS89ZrWjZlS25mwW53FO5G2GklzoZnthXeGj5f8h53eG5wiG5qIAhwyw53vG53zW533m537OZ16QB1xYiF34hRcw6ING6IRW6IVm6IZO6F/Yg3mI54mmaNmd54rG6IzW6EMx54326I8GaY4O6ZEm6ZIWaZNG6ZRWaVFe6ZZ2aZW+6JeW6Zl25Y6m6ZvGaVuO6Zzm6Z7+4p326aAW6iu26aE26qOuYqBG6qVmaglW6qaG6qh7tuiiluqqtmp5puqr1uqtjt2n5uqvBusH8eqwJuuyDoysNuu0VmsHGeu1duu0buu3lmuwjuu5tuurruu71muozuu99uuj7uu/FmyfDuzBNuybLuzDVmyXTuzFdmyUbuzHluyQjuzJtmyNruzL1uyJzuzN9uxx7uzPFm1nbw7t0TbtYC7t01ZtVk7t1Xbtmn7t2M7p1pbt2s5j2rbt3GZj3Nbt3v5ptPbt4G5m3hbu4jZi4jbu5M5h5Fbu5mZh5nbu6CZm4Jbu6i5k6Lbu7DZg7Nbu7l5f7vbu8CY78Bbv8j5d80bvXKbu9GZvHWAm7/aG7z1e7/im7xB+7/rG7+m47/zm7yWe7/4G8ADe7wAncF/77wJHcG1O8AUX4QFn8AJ38AcP8AiX8P6m8ArP7wvH8PrW8A2P7w738PYG8RBP7xEncfM28RMX7xRXce9VZvEW1+4Xh3HrlvEZl+4at3HnxvEcV+4d53Hj9vEfF+4gF3LfJvIi1+0jR3LbVvIll+0md/LXhvIoX+0pp/LTtvIrH+0s1/LP5vIu3+wvB/PLFvMxn1bsMjfzx0bzNF/sNWfzw3bzNx/sOJfzv6bzOt/rO8fzu9bzPZ/rPvfztwb0QF/rQSd0uD7wQ19wQ1d0smb0RqfrRId0An/0Sd/qSrd0vJb0TOdvTOd0qVT29E/n600XdfoO9VJf6lNHdcAm9VVnb1V3daGG9Vgn7Fan9fKe9VufbVvXdRfn9V6P8V8HdhoX9mG/8WI3dh1H9mTv8WVndiB39mcf8miXdiOn9mpVT/Jrx3Ym1/Ztf/Ju93YpB/dwr/JxJ3csN/dz3/J0V3cvZ/d2D/N3h3cyl/d5P/N6t3c1x/d8b/N953c49/d/n/OAF3g7J/iCz/ODR3g+V/iF//OGd+J4QYf4iC90xrD4i8f4jNf4jef4jvf4jwf5kBf5kSf5kjf5k0f5lFf5lWf5lnf5l4f5mJf5maf5mm95isf5nLczBwBWhOD5hADWoP95nx96nu95o/d5oHeIo096ogf6oXf6pz/6qRf6ntd5kw76ps96ANh6pm/6r1f6rVeIny96rTd7rj97pUf7tVf7q0dpq1/7rid6q6f6p18IuL97tJf7sYd6se97rf97t3/7s9/7NqP7th/7xAf7ry/8pPd6uG98xRd8rKf7yld7r+f6oof6xc/7tA/8qZd6vkd8tp987Q4IADs=</CustomerLogo1> 
```

当我加载 XML 时，我使用以下函数将图像拉入

```
 static byte[] GetBytes(string str)
    {
        byte[] bytes = new byte[str.Length * sizeof(char)];
        System.Buffer.BlockCopy(str.ToCharArray(), 0, bytes, 0, bytes.Length);
        return bytes;
    } 
```

IE

```
 CustomerLogo1 = GetBytes(xmlDoc.ChildNodes[1].ChildNodes[8].InnerText); 
```

然后我使用以下函数将其读回

```
 public Bitmap byteArrayToImage(byte[] byteArrayIn)
    {
        MemoryStream mem = new MemoryStream(byteArrayIn);
        return new Bitmap(mem);
    } 
```

但是我在新的 Bitmap(mem) 评论中收到错误“参数无效”

我不明白是读取它的问题，还是写入磁盘的问题。我正在使用以下函数来编写字节数组，这是 XML 类的一个参数。

```
 public byte[] imageToByteArray(Bitmap bmp)
    {
        TypeConverter converter = TypeDescriptor.GetConverter(typeof(Bitmap));
        return (byte[])converter.ConvertTo(bmp, typeof(byte[]));
    } 
```

要保存 XML，然后使用

```
 public string SettingsToXMLString(Settings settings)
    {
        StringWriter Output = new StringWriter(new StringBuilder());
        XmlSerializer s = new XmlSerializer(settings.GetType());
        s.Serialize(Output, settings);
        return Output.ToString();
    } 
```

非常感谢安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:32:57.643

您应该使用[System.Convert.FromBase64String](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx)从 xml 文档中检索二进制数据。所以你的代码应该是这样的：

```
CustomerLogo1 = Convert.FromBase64String(xmlDoc.ChildNodes[1].ChildNodes[8].InnerText); 
```

编辑：正如吉姆所说，你应该更好地通过他们的名字而不是他们在文档中的当前位置来访问 xml 元素。

# c# - SQL 视图上的 LINQ 选择得到错误答案

> ID：14217285
> 
> 赞同：9
> 
> 时间：2013-01-08T14:35:49.987
> 
> 标签：c#, sql, linq, view

我有一个 SQL 视图，它产生 8 列的响应。它相当复杂，所以我不会在这里列出它，它不会对我试图理解的问题增加太多。

当我直接使用此查询查询 SQL 管理器中的视图时

```
SELECT * FROM [GPPS].[dbo].[PartIndex]
WHERE CategoryNameId = 182 AND CycleId = 13 AND BasketId = 304 AND MarketId = 8
ORDER BY ProductNameId 
```

我得到了（前两行很重要）的预期结果，并且 ProductNameId 列在结果中排​​名第 7

```
 vvvvv
                            =====   
218   13    8   304 182 124 32575   162.84
218   13    8   304 182 124 32576   184.08
218   13    8   304 182 125 32577   156.13
218   13    8   304 182 127 32578   605.84
218   13    8   304 182 130 32579   141.51 
```

当我对视图执行以下 LINQ

```
PartIndexes.Where(x => x.CategoryNameId == 182 
                       && x.CycleId == 13 
                       && x.BasketId == 304 
                       && x.MarketId == 8)
           .ToList()
           .OrderBy(x => x.ProductNameId); 
```

我实际上得到的是：

```
 vvvvv
                            ===== 
218   13    8   304 182 124 32576   184.08
218   13    8   304 182 124 32576   184.08
218   13    8   304 182 125 32577   156.13
218   13    8   304 182 127 32578   605.84
218   13    8   304 182 130 32579   141.51 
```

如您所见，前两个条目是相同的，并且 ID（32575 和 32576）的区别已经丢失。

当我在视图上运行 LINQ 查询时查看 SQL 探查器会产生以下 SQL

```
SELECT 
[Extent1].[SetNameId] AS [SetNameId], 
[Extent1].[CycleId] AS [CycleId], 
[Extent1].[MarketId] AS [MarketId], 
[Extent1].[BasketId] AS [BasketId], 
[Extent1].[CategoryNameId] AS [CategoryNameId], 
[Extent1].[ProductNameId] AS [ProductNameId], 
[Extent1].[PartId] AS [PartId], 
[Extent1].[Total] AS [Total]
FROM (SELECT 
  [PartIndex].[SetNameId] AS [SetNameId], 
  [PartIndex].[CycleId] AS [CycleId], 
  [PartIndex].[MarketId] AS [MarketId], 
  [PartIndex].[BasketId] AS [BasketId], 
  [PartIndex].[CategoryNameId] AS [CategoryNameId], 
  [PartIndex].[ProductNameId] AS [ProductNameId], 
  [PartIndex].[PartId] AS [PartId], 
  [PartIndex].[Total] AS [Total]
  FROM [dbo].[PartIndex] AS [PartIndex]) AS [Extent1]
WHERE (182 = [Extent1].[CategoryNameId]) AND (13 = [Extent1].[CycleId]) AND (304 =  [Extent1].[BasketId]) AND (8 = [Extent1].[MarketId]) 
```

然后当我直接在 SQL 管理器中执行它时，我得到了所需的结果：

```
218   13    8   304 182 124 32575   162.84
218   13    8   304 182 124 32576   184.08
218   13    8   304 182 125 32577   156.13
218   13    8   304 182 127 32578   605.84
218   13    8   304 182 130 32579   141.51 
```

正如任何人都知道这里可能会发生什么以及为什么执行 LINQ 请求会返回与 SQL 中不同的结果，但是在执行由 LINQ 查询生成的 SQL 时，它会返回所需的结果？

SQL 在直接使用时在做什么，而在正确呈现时 LINQ 没有做什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-08T15:34:17.377

您的问题与此类似：[Using a view with no primary key with Entity](https://stackoverflow.com/a/11371825)

指定使您的行唯一的**key 。**您可以通过属性在实体映射上指定这些键：

```
public class YearlySalesOnEachCountry
{        
    [Key, Column(Order=0)] public int CountryId { get; set; }
    public string CountryName { get; set; }
    [Key, Column(Order=1)] public int OrYear { get; set; }

    public long SalesCount { get; set; }      
    public decimal TotalSales { get; set; }
} 
```

或者你可以通过代码方法来做到这一点：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    base.OnModelCreating(modelBuilder);    
    modelBuilder.Entity<YearlySalesOnEachCountry>()
           .HasKey(x => new { x.CountryId, x.OrYear });     
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-04-02T23:37:51.663

如果实体框架为视图选择的键不是唯一的，则可能无法正确返回结果。对于某些视图，无法定义正确的键（具有所有非空列）并且对使用视图没有任何好处。

对于这些情况，请考虑使用 EF Edmx 接口手动定义密钥：

```
 1) Any existing non-null field or 

 2) A separately added column "key" such as:

     select 1 as EfKey -- Must use with AsNoTracking() 
```

这两种方法都需要对每个查询（[链接](https://stackoverflow.com/a/48653443/538763)）使用“AsNoTracking()”。

使用 AsNoTracking() 向 EF 发出信号以绕过其基于密钥的记录缓存机制。如果没有 AsNoTracking()，结果可能会损坏，其中包含重复的行。

使用 (2) 的一个优点是，如果忘记了 AsNoTracking()，那么结果应该很糟糕，很容易被注意到。

避免使用 row_number() 的任何变体，因为它通常会妨碍 SQL 引擎中谓词的有效使用。这可以通过查看带有谓词的 SQL 实际计划来验证。（抱歉，这是我最初发布的建议。）

```
 -- Avoid!
   select row_number() over (order by (select null)) as RowId,
          ... 
```

希望 EF 团队会考虑为视图提供一个选项，该选项允许禁用 Key 要求并在每个查询中自动使用 AsNoTracking()。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T15:19:34.693

实际上，@stanke 的问题给了我一个想法。

实际上，我稍微更改了视图以包含另一列，以便可以唯一标识每条记录。

我实际上并不需要结果表中的列值，但它确实有助于 LINQ 在查询时保持记录的唯一性。看起来 SQL 本身就可以很好地做到这一点，但 LINQ 需要一点帮助来保持记录的不同。

它现在可以在 SQL 和 LINQ 中按预期工作

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-08T18:32:17.097

我添加了

```
ISNULL(CONVERT(VARCHAR(50), NEWID()), '') AS Pkid 
```

作为我认为解决这个问题的第一篇专栏。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-08T14:52:45.567

在前两行的第 6 列，您有相同的值 - 124，如果这是此视图中的某个外键，则可能导致过滤一行。我在使用数据表加载函数时遇到了类似的情况，因为它在将检索到的数据加载到数据表时应用了约束。尝试从 linq 到 sql 模式中删除密钥。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-08T14:56:59.793

我没有看到您的 LINQ 有任何问题。

您如何填充 PartIndexes（ORM、SqlCommand 等）？

也许你在 DAL 或 ORM 映射中的逻辑搞砸了，这搞砸了存储在 PartIndexes 中的内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-06T15:58:21.997

假设您使用的是**EF (entity framework)**。如果是这样，请在 IQueryable 上使用**.AsNoTracking()**，否则您可能会得到**缓存**的结果。

# java - Java金额格式

> ID：14217296
> 
> 赞同：0
> 
> 时间：2013-01-08T14:36:41.797
> 
> 标签：java

我有 156 个金额，当我总结得出总金额时，金额格式就像`323E43.32`我不想要的那样，但我想要 344234.45 格式。我得到了字符串中的单个金额，在执行任何操作之前，我已将其键入为双倍值。

有没有办法在java中格式化从`323E43.32`到的金额？`344234.45`

代码片段：

```
for (int i = 0; i < numrows; i++)
{
    double temp=Double.parseDouble(orders.getString("AMOUNT"));
    totalAmount=totalAmount+temp;
    bean.setTotalAmount(totalAmount);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:41:50.243

你为什么不看看[DecimalFormat](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/DecimalFormat.html)

```
 DecimalFormat formatter = new DecimalFormat("0.0000");
    Double price2 = Double.parseDouble(decim.format(price));
    System.out.println(price2); // it will print it in the default format 
```

如果要打印格式化的表示，请使用以下格式打印：

```
 String s = formatter.format(price);
    System.out.println("s is '"+s+"'"); 
```

另请查看[如何格式化十进制数字？](http://javarevisited.blogspot.in/2012/03/how-to-format-decimal-number-in-java.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:42:14.523

这个线程可以解决你的问题吗？

[没有E的double和float的Java除法](https://stackoverflow.com/questions/9054836/java-division-for-double-and-float-without-e)

使用此代码：

```
 System.out.println(new DecimalFormat("#.#####").format(doubleValue)); 
```

# python - Python：多处理和 c_char_p 数组

> ID：14217297
> 
> 赞同：5
> 
> 时间：2013-01-08T14:36:42.033
> 
> 标签：python, multiprocessing, ctypes

我正在启动 3 个进程，我希望它们将一个字符串放入一个共享数组中，**位于对应于进程 (i) 的索引处。**

看下面的代码，生成的输出是：

```
['test 0', None, None]
['test 1', 'test 1', None]
['test 2', 'test 2', 'test 2'] 
```

为什么 'test 0' 会被`test 1`和覆盖？`test 1``test 2`

我想要的是（顺序不重要）：

```
['test 0', None, None]
['test 0', 'test 1', None]
['test 0', 'test 1', 'test 2'] 
```

编码 ：

```
#!/usr/bin/env python

import multiprocessing
from multiprocessing import Value, Lock, Process, Array
import ctypes
from ctypes import c_int, c_char_p

class Consumer(multiprocessing.Process):
    def __init__(self, task_queue, result_queue, arr, lock):
            multiprocessing.Process.__init__(self)
            self.task_queue = task_queue
            self.result_queue = result_queue
            self.arr = arr
            self.lock = lock

    def run(self):
            proc_name = self.name
            while True:
                next_task = self.task_queue.get()
                if next_task is None:
                    self.task_queue.task_done()
                    break            
                answer = next_task(arr=self.arr, lock=self.lock)
                self.task_queue.task_done()
                self.result_queue.put(answer)
            return

class Task(object):
    def __init__(self, i):
        self.i = i

    def __call__(self, arr=None, lock=None):
        with lock:
            arr[self.i] = "test %d" % self.i
            print arr[:]

    def __str__(self):
        return 'ARC'

    def run(self):
        print 'IN'

if __name__ == '__main__':
   tasks = multiprocessing.JoinableQueue()
   results = multiprocessing.Queue()

   arr = Array(ctypes.c_char_p, 3)

   lock = multiprocessing.Lock()

   num_consumers = multiprocessing.cpu_count() * 2
   consumers = [Consumer(tasks, results, arr, lock) for i in xrange(num_consumers)]

   for w in consumers:
      w.start()

   for i in xrange(3):
      tasks.put(Task(i))

   for i in xrange(num_consumers):
      tasks.put(None) 
```

我正在运行 Python 2.7.3 (Ubuntu)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T19:46:14.793

这个问题似乎与[此](https://stackoverflow.com/q/11848381/190597)类似。在那里，JF Sebastian 推测分配给`arr[i]`指向`arr[i]`的内存地址只对进行分配的子进程有意义。其他子进程在查看该地址时检索垃圾。

至少有两种方法可以避免这个问题。一种是使用`multiprocessing.manager`列表：

```
import multiprocessing as mp

class Consumer(mp.Process):
    def __init__(self, task_queue, result_queue, lock, lst):
            mp.Process.__init__(self)
            self.task_queue = task_queue
            self.result_queue = result_queue
            self.lock = lock
            self.lst = lst

    def run(self):
            proc_name = self.name
            while True:
                next_task = self.task_queue.get()
                if next_task is None:
                    self.task_queue.task_done()
                    break            
                answer = next_task(lock = self.lock, lst = self.lst)
                self.task_queue.task_done()
                self.result_queue.put(answer)
            return

class Task(object):
    def __init__(self, i):
        self.i = i

    def __call__(self, lock, lst):
        with lock:
            lst[self.i] = "test {}".format(self.i)
            print([lst[i] for i in range(3)])

if __name__ == '__main__':
   tasks = mp.JoinableQueue()
   results = mp.Queue()
   manager = mp.Manager()
   lst = manager.list(['']*3)

   lock = mp.Lock()
   num_consumers = mp.cpu_count() * 2
   consumers = [Consumer(tasks, results, lock, lst) for i in xrange(num_consumers)]

   for w in consumers:
      w.start()

   for i in xrange(3):
      tasks.put(Task(i))

   for i in xrange(num_consumers):
      tasks.put(None)

   tasks.join() 
```

* * *

另一种方法是使用具有固定大小的共享数组，例如`mp.Array('c', 10)`.

```
import multiprocessing as mp

class Consumer(mp.Process):
    def __init__(self, task_queue, result_queue, arr, lock):
            mp.Process.__init__(self)
            self.task_queue = task_queue
            self.result_queue = result_queue
            self.arr = arr
            self.lock = lock

    def run(self):
            proc_name = self.name
            while True:
                next_task = self.task_queue.get()
                if next_task is None:
                    self.task_queue.task_done()
                    break            
                answer = next_task(arr = self.arr, lock = self.lock)
                self.task_queue.task_done()
                self.result_queue.put(answer)
            return

class Task(object):
    def __init__(self, i):
        self.i = i

    def __call__(self, arr, lock):
        with lock:
            arr[self.i].value = "test {}".format(self.i)
            print([a.value for a in arr])

if __name__ == '__main__':
   tasks = mp.JoinableQueue()
   results = mp.Queue()
   arr = [mp.Array('c', 10) for i in range(3)]

   lock = mp.Lock()
   num_consumers = mp.cpu_count() * 2
   consumers = [Consumer(tasks, results, arr, lock) for i in xrange(num_consumers)]

   for w in consumers:
      w.start()

   for i in xrange(3):
      tasks.put(Task(i))

   for i in xrange(num_consumers):
      tasks.put(None)

   tasks.join() 
```

我推测这`mp.Array(ctypes.c_char_p, 3)`不起作用的原因是因为`mp.Array('c', 10)`它具有固定大小，因此内存地址永远不会改变，而`mp.Array(ctypes.c_char_p, 3)`具有可变大小，因此当`arr[i]`分配给更大的字符串时内存地址可能会改变。

也许这就是[文档](http://docs.python.org/2/library/multiprocessing.html#module-multiprocessing.sharedctypes)在声明时警告的内容，

> 尽管可以将指针存储在共享内存中，但请记住，这将引用特定进程地址空间中的位置。但是，指针很可能在第二个进程的上下文中无效，并且尝试从第二个进程取消引用指针可能会导致崩溃。

# c# - 根据鼠标在模型中的拖动方向和位置旋转模型组

> ID：14217299
> 
> 赞同：6
> 
> 时间：2013-01-08T14:36:46.870
> 
> 标签：c#, wpf, graphics, 3d

我在 WPF 中添加了几个立方体`Viewport3D`，现在我想用鼠标操作它们的组。

![初始立方体](../Images/0c719a410b3f31675d231b7685177c8a.png)

当我单击并拖动这些立方体中的一个半时，我希望孔平面沿拖动方向旋转，旋转将被处理，`RotateTransform3D`因此不会有问题。

问题是我不知道应该如何处理拖动，更准确地说：我如何知道立方体的哪些面被拖动以确定要旋转的平面？

例如，在下面的情况下，我想知道我需要将立方体的右侧平面顺时针旋转 90 度，这样一排蓝色面将位于顶部，而不是白色面位于后面。

![第二个立方体](../Images/26c5fb7a94d0a978455f8457513461fc.png)

在本例中，顶层应逆时针旋转 90 度： ![第三个立方体](../Images/f8430c05325394b63ff927451c88db24.png)

目前我的想法是在立方体上放置某种不可见区域，以检查拖动发生在哪个区域`VisualTreeHelper.HitTest`，然后确定我应该旋转哪个平面，该区域将匹配第一个拖动示例：

![在此处输入图像描述](../Images/eb5e01509367786e12fd0172149e8ee9.png)

但是当我添加所有四个区域时，我又回到了第一方，因为我仍然需要根据“触摸”的区域来确定方向和要旋转的面。

我对想法持开放态度。

请注意，这个立方体可以自由移动，所以当用户点击和拖动时它可能不在初始位置，这是最困扰我的。

PS：拖动将通过`MouseLeftButtonDown`,`MouseMove`和的组合来实现`MouseLeftButtonUp`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T20:48:46.930

**鼠标事件**

您需要使用`VisualTreeHelper.HitTest()`来选择`Visual3D`对象（如果每个面都是单独的，过程可能会更简单`ModelVisual3D`）。[这里](http://blogs.msdn.com/b/wpf3d/archive/2009/05/18/3d-hit-testing.aspx)有一些关于 HitTesting 的一般帮助，[这里](http://grokys.blogspot.com/2010/08/wpf-3d-translating-2d-point-into-3d.html)有一个非常有用的花絮，它极大地简化了挑选过程。

**事件剔除**

假设您现在有两个`ModelVisual3D`来自挑选测试的对象（一个来自`MouseDown`事件，一个来自`MouseUp`事件）。首先，我们应该检测它们是否共面（以避免选择从一个面到另一个面）。一种方法是比较面法线以查看它们是否指向相同的方向。如果您在 MeshGeometry3D 中定义了法线，那就太好了。如果没有，那么我们仍然可以找到它。我建议为扩展添加一个静态类。计算法线的示例：

```
public static class GeometricExtensions3D
{
    public static Vector3D FaceNormal(this MeshGeometry3D geo)
    {
        // get first triangle's positions
        var ptA = geo.Positions[geo.TriangleIndices[0]];
        var ptB = geo.Positions[geo.TriangleIndices[1]];
        var ptC = geo.Positions[geo.TriangleIndices[2]];
        // get specific vectors for right-hand normalization
        var vecAB = ptB - ptA;
        var vecBC = ptC - ptB;
        // normal is cross product
        var normal = Vector3D.CrossProduct(vecAB, vecBC);
        // unit vector for cleanliness
        normal.Normalize();
        return normal;
    }
} 
```

使用它，您可以比较命中的法线`MeshGeometry3D`（`Visual3D`此处涉及大量投射），并查看它们是否指向同一方向。为了安全起见，我将对向量的 X、Y、Z 进行容差测试，而不是直接等价。另一个扩展可能会有所帮助：

```
 public static double SSDifference(this Vector3D vectorA, Vector3D vectorB)
    {
        // set vectors to length = 1
        vectorA.Normalize();
        vectorB.Normalize();
        // subtract to get difference vector
        var diff = Vector3D.Subtract(vectorA, vectorB);
        // sum of the squares of the difference (also happens to be difference vector squared)
        return diff.LengthSquared;
    } 
```

如果它们不共面（SSDifference > 一些任意测试值），您可以`return`在这里（或提供某种反馈）。

**对象选择**

既然我们已经确定了我们的两张面孔，并且它们确实已经成熟，可以进行我们想要的事件处理，我们必须推导出一种方法来从我们所拥有的信息中提取信息。您应该仍然拥有之前计算的法线。我们将再次使用它们来选择其余要旋转的面。另一种扩展方法有助于比较确定是否应将人脸包含在旋转中：

```
 public static bool SharedColumn(this MeshGeometry3D basis, MeshGeometry3D compareTo, Vector3D normal)
    {
        foreach (Point3D basePt in basis.Positions)
        {
            foreach (Point3D compPt in compareTo.Positions)
            {
                var compToBasis = basePt - compPt; // vector from compare point to basis point
                if (normal.SSDifference(compToBasis) < float.Epsilon) // at least one will be same direction as
                {                                                     // as normal if they are shared in a column
                    return true;
                }
            }
        }
        return false;
    } 
```

您需要为两个网格（MouseDown 和 MouseUp）剔除面，迭代所有面。保存需要旋转的几何图形列表。

**旋转变换**

现在是棘手的部分。Axis-Angle 旋转有两个参数：a`Vector3D`表示垂直于旋转的轴（使用右手法则）和旋转角度。但是我们立方体的中点可能不在 (0, 0, 0)，所以旋转可能很棘手。因此，首先我们必须找到立方体的中点！我能想到的最简单的方法是将立方体中每个点的 X、Y 和 Z 分量相加，然后将它们除以点数。当然，诀窍是不要多次添加同一点！你如何做到这一点将取决于你的数据是如何组织的，但我认为这是一个（相对）微不足道的练习。您不想应用变换，而是自己移动点，因此我们将构建矩阵，而不是创建和添加到 TransformGroup！转换矩阵如下所示：

```
 1, 0, 0, dx
    0, 1, 0, dy
    0, 0, 1, dz
    0, 0, 0, 1 
```

因此，给定立方体的中点，您的平移矩阵将是：

```
 var cp = GetCubeCenterPoint(); // user-defined method of retrieving cube's center point
    // gpu's process matrices in column major order, and they are defined thusly
    var matToCenter = new Matrix3D(
            1, 0, 0, 0,
            0, 1, 0, 0,
            0, 0, 0, 1,
            -cp.X, -cp.Y, -cp.Z, 1);
    var matBackToPosition = new Matrix3D(
            1, 0, 0, 0,
            0, 1, 0, 0,
            0, 0, 0, 1,
            cp.X, cp.Y, cp.Z, 1); 
```

剩下的就是我们的轮换。你还有参考我们从 MouseEvents 中挑选的两个网格吗？好的！让我们定义另一个扩展：

```
 public static Point3D CenterPoint(this MeshGeometry3D geo)
    {
        var midPt = new Point3D(0, 0, 0);
        var n = geo.Positions.Count;
        foreach (Point3D pt in geo.Positions)
        {
            midPt.Offset(pt.X, pt.Y, pt.Z);
        }
        midPt.X /= n; midPt.Y /= n; midPt.Z /= n;
        return midPt;
    } 
```

获取从`MouseDown`' 网格到`MouseUp`' 网格的向量（顺序很重要）。

```
 var swipeVector = MouseUpMesh.CenterPoint() - MouseDownMesh.CenterPoint(); 
```

而且您仍然对我们的打击面保持正常，对吗？我们可以（基本上神奇地）通过以下方式获得旋转轴：

```
 var rotationAxis = Vector3D.CrossProduct(swipeVector, faceNormal); 
```

这将使您的旋转角度**始终**为+90°。制作 RotationMatrix ( [source](http://en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle) ):

```
 swipeVector.Normalize();
    var cosT = Math.Cos(Math.PI/2);
    var sinT = Math.Cos(Math.PI/2);
    var x = swipeVector.X;
    var y = swipeVector.Y;
    var z = swipeVector.Z;
    // build matrix, remember Column-Major
    var matRotate = new Matrix3D(
         cosT + x*x*(1 -cosT), y*x*(1 -cosT) + z*sinT, z*x*(1 -cosT) -y*sinT, 0,
        x*y*(1 -cosT) -z*sinT,   cosT + y*y*(1 -cosT), y*z*(1 -cosT) -x*sinT, 0,
        x*z*(1 -cosT) -y*sinT,  y*z*(1 -cosT) -x*sinT,  cosT + z*z*(1 -cosT), 0,
                            0,                      0,                     0, 1); 
```

将它们组合起来得到变换矩阵，注意顺序很重要。我们要获取该点，将其转换为相对于原点的坐标，旋转它，然后按此顺序将其转换回原始坐标。所以：

```
 var matTrans = Matrix3D.Multiply(Matrix3D.Multiply(matToCenter, matRotate), matBackToPosition); 
```

然后，您就可以移动这些点了。遍历您之前标记为进行旋转的每个`Point3D`中的每个`MeshGeometry3D`，然后执行以下操作：

```
 foreach (MeshGeometry3D geo in taggedGeometries)
    {
        for (int i = 0; i < geo.Positions.Count; i++)
        {
            geo.Positions[i] *= matTrans;
        }
    } 
```

然后......哦等等，我们完成了！

# three.js - 了解three.js 射线投影

> ID：14217308
> 
> 赞同：4
> 
> 时间：2013-01-08T14:37:20.600
> 
> 标签：three.js

我想了解光线投影的工作原理。几乎在我看到的任何地方，我都会得到这样的代码：

```
new THREE.Vector3(mouseX, mouseY, 0.5); 
```

我对 z 位置的 0.5 感到困惑。根据我的理解，我们正在预测`z=1 plane`（不是`z=0.5 plane`）。那么我们不应该像这样使用它吗？

```
new THREE.Vector3(mouseX, mouseY, 1.0); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:51:51.563

经常使用的模式是这样的：

```
var vector = new THREE.Vector3(
    ( event.clientX / window.innerWidth ) * 2 - 1,
    - ( event.clientY / window.innerHeight ) * 2 + 1,
    0.5,
); 
```

这是标准化设备坐标 (NDC) 空间中的一个点。

功能

```
projector.unprojectVector( vector, camera ); 
```

是从 NDC 空间映射到世界空间。

的值可以设置为 -1 和 1 之间的任何值`0.5`。`vector.z`

为什么？因为这些点都在 NDC 空间中平行于 z 轴的线上，并且都将映射到世界空间中相机发出的同一条光线。

设置`z = -1`将映射到近平面上的一个点；`z = 1`远平面。

So the short answer is, it doesn't matter what the value of `z` is, as long as it is between -1 and 1\. For numerical reasons, we stay away from the endpoints, and 0.5 is often used.

# linux - PCIe 中断路由

> ID：14217311
> 
> 赞同：1
> 
> 时间：2013-01-08T14:37:32.800
> 
> 标签：linux, interrupt, fpga, pci

我目前正在 xilinx PFGA 中实现 PCIE 端点设备，并且在中断方面存在一些问题。

当驱动程序初始化时，它将中断映射到 IRQ 32

```
[ 1078.938669]   alloc irq_desc for 32 on node -1
[ 1078.938670]   alloc kstat_irqs on node -1
[ 1078.938675] pci 0000:06:00.0: PCI INT A -> GSI 32 (level, low) -> IRQ 32 
```

但是，当中断触发时，

```
[ 1134.850064] irq 16: nobody cared (try booting with the "irqpoll" option)
[ 1134.850067] Pid: 0, comm: swapper Tainted: P           2.6.32-5-amd64 #1
[ 1134.850069] Call Trace:
[ 1134.850070]  <IRQ>  [<ffffffff81095d89>] ? __report_bad_irq+0x30/0x7d
                          .
                          .
                          .
[ 1134.850119] handlers:
[ 1134.850120] [<ffffffffa0e7935e>] (azx_interrupt+0x0/0x11d [snd_hda_intel])
[ 1134.850124] Disabling IRQ #16 
```

irq 似乎被路由到另一个引脚 IRQ #16。我使用了 PCIe msi 中断。什么可能导致这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T16:13:42.737

我想你可能使用 ML555 板。这是一个关于 ML555 上的 PCIE 驱动程序的网站。幸好它还活着。 [https://asim.csail.mit.edu/redmine/projects/leap-platforms/repository/show/trunk/drivers/linux/platforms/htg-pcie-virtex5/src](https://asim.csail.mit.edu/redmine/projects/leap-platforms/repository/show/trunk/drivers/linux/platforms/htg-pcie-virtex5/src) 我也遇到了一些关于pcie设备驱动的障碍。所以我们可以交流一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-23T13:20:01.087

我遇到过类似的问题。

1）克里斯在他的评论中说，确保你在 PCI 配置空间中实现 MSI 寄存器。这些寄存器由 BIOS/OS 写入，以告知硬件要写入 MSI 中断的哪个地址的值。

2) 确保 PCIE 端点 (pcie_7x?) 配置了这些寄存器的地址。每个中断需要 4 个寄存器。给 coregen 的地址是一个 16 位的字地址。

希望这可以帮助。

# javascript - 带有url字符串的Javascript AJAX加载？

> ID：14217314
> 
> 赞同：1
> 
> 时间：2013-01-08T14:37:43.670
> 
> 标签：javascript, ajax, post, google-analytics-api

我在测试 Google Analytics API 时正在加载 javascripts。我的服务器上托管了一些静态 JS 文件（如 googleAnalyticsAuthorization_v3.js 和 googleAnalyticsApi_v3.js），我可以很好地查询/评估它们，但我不知道应该如何查询/评估以下内容： [http://apis. google.com/js/client.js?onload=handleClientLoad](http://apis.google.com/js/client.js?onload=handleClientLoad)

我的 AJAX 加载器很简单：

```
function requestJavascriptWithHttpMethod(filePath, httpMethod)
{
    request = new XMLHttpRequest();
    request.open(httpMethod, filePath, true);

    request.onreadystatechange = function()
    {
        _log('Request "'+filePath+'": readyState <'+requestReadyStateString(this.readyState)+'>, status <'+requestStatusString(this.status)+'>.');      

        if (this.readyState == this.DONE &&
            requestStatusString(this.status) == 'OK')
        {
            _log('Loading of "'+filePath+'" finished.');
            eval(this.responseText);
        }
    }

    request.send(); 
    _log('Request "'+filePath+'"...');
}

function requestJavascript(filePath)
{ requestJavascriptWithHttpMethod(filePath, "GET"); } 
```

我试图发布 url，但没有执行任何结果（它实际上返回状态码 0）。

```
requestJavascript('googleAnalyticsAuthorization_v3.js'); //Loads, evaluates well.
requestJavascript('googleAnalyticsApi_v3.js'); //Loads, evaluates well.
requestJavascriptWithHttpMethod('http://apis.google.com/js/client.js?onload=handleClientLoad', "POST"); //Nothing seems happening, returns with status code 0. 
```

它的行为应该与我只是将其包含在客户端 HTML 代码中一样，例如：

```
<script src="http://apis.google.com/js/client.js?onload=handleClientLoad"></script> 
```

控制台输出为：

```
Request "googleAnalyticsAuthorization_v3.js"...
Request "googleAnalyticsApi_v3.js"...
Request "http://apis.google.com/js/client.js?onload=handleClientLoad"...
Request "http://apis.google.com/js/client.js?onload=handleClientLoad": readyState <request finished and response is ready>, status <0>.
Request "googleAnalyticsApi_v3.js": readyState <request received>, status <OK>.
Request "googleAnalyticsApi_v3.js": readyState <processing request>, status <OK>.
Request "googleAnalyticsApi_v3.js": readyState <request finished and response is ready>, status <OK>.
Loading of "googleAnalyticsApi_v3.js" finished.
googleAnalytics_v3.js evaluated
Request "googleAnalyticsAuthorization_v3.js": readyState <request received>, status <OK>.
Request "googleAnalyticsAuthorization_v3.js": readyState <processing request>, status <OK>.
Request "googleAnalyticsAuthorization_v3.js": readyState <request finished and response is ready>, status <OK>.
Loading of "googleAnalyticsAuthorization_v3.js" finished.
googleAnalyticsAuthorization_v3.js evaluated 
```

有人可以帮我吗？

其实我只是想把所有的逻辑都封装到javascript中，不依赖HTML端。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:42:48.217

由于同源策略，您不能对第三方域进行 Ajax 调用。通常，您将使用 JavaScript 将 JavaScript 添加到页面

```
var script = document.createElement("script");
script.src = "foo.js";
document.getElementsByTagName("body")[0].appendChild(script); 
```

这将跨浏览器工作，但您遇到的问题是 Google Analytics 用于`document.write`在页面上添加新的脚本标签。这意味着它将替换所有页面内容。因此，您无法在页面加载后将其代码动态添加到页面中。

对于异步加载，请参阅 Google 的网站：[https ://developers.google.com/analytics/devguides/collection/gajs/asyncTracking](https://developers.google.com/analytics/devguides/collection/gajs/asyncTracking)

```
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXX-X']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 
```

# html - Chrome 渲染 element as

# when using webGL

I'm finding that Chrome (running v 23) both on Winxp and Ubuntu is rendering the content of my "title" tag in the body as a "h1" tag, but only in this page wh

> ID：14217317
> 
> 赞同：0
> 
> 时间：2013-01-08T14:37:50.877
> 
> 标签：html, google-chrome, webgl

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:47:25.377

h1 元素由 webgl-utils.js 创建

# php - 无效的 Memcache-> 连接成员变量错误

> ID：14217319
> 
> 赞同：11
> 
> 时间：2013-01-08T14:37:57.757
> 
> 标签：php, zend-framework, nginx, memcached

我们目前使用 Nginx 作为我们的服务器并使用 memcached 作为缓存机制。我正在检查 PHP 错误日志，许多关于 memcached 的 PHP 警告引起了我的注意。

```
PHP Warning: Memcache::get(): Invalid Memcache->connection member variable in {directory}/library/Zend/Cache/Backend/Memcached.php on line 180 
```

在它指向的那一行，有这段代码：

```
$tmp = $this->_memcache->get($id); 
```

我还看到许多其他带有相同警告消息的 PHP 警告，但与 memcache 对象的不同函数调用不同：

```
PHP Warning: Memcache::add(): Invalid Memcache->connection member variable in {directory}/library/Zend/Cache/Backend/Memcached.php on line 180
PHP Warning: Memcache::set(): Invalid Memcache->connection member variable in {directory}/library/Zend/Cache/Backend/Memcached.php on line 230
PHP Warning: Memcache::delete(): Invalid Memcache->connection member variable in {directory}/library/Zend/Cache/Backend/Memcached.php on line 323 
```

我通过网络进行了搜索，但找不到任何真正有帮助的东西。有时，我们的 memcached 会出现一些问题。当服务器由于某些问题而关闭时，是否可能会发生这种问题？我真的不知道是什么导致了这些警告。我该如何纠正它，或者至少如何避免这些警告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T11:48:12.410

我找到了 3 个可能对您有帮助的参考资料

1.  [文件系统和内存缓存的限制](https://stackoverflow.com/questions/6766334/php-unable-to-connect-to-memcached-at-times-when-under-high-load)
2.  [可能的内存泄漏](https://stackoverflow.com/questions/983925/persistent-connections-to-memcached-in-php/3363578#3363578)
3.  [Memcache 与 Memcached](https://stackoverflow.com/questions/9790780/the-memcache-extension-must-be-loaded-for-using-this-backend/9802388#9802388)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-01T04:47:05.723

我有同样的问题。当我在 __destruct 中调用 memcache 对象来更新我的对象的状态时，我得到了错误。这是我的解决方案：在您更改状态的类函数中调用对象，并确保将 memcache 的实例发送到此类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-04T17:38:38.903

您需要检查 key max 250 chars 和 value max : 1MB

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-10T01:52:48.077

你最近编译过自己的 php 吗？版本可能不同步。

# python - 向 Django 管理主页添加一个计数器

> ID：14217325
> 
> 赞同：2
> 
> 时间：2013-01-08T14:38:13.143
> 
> 标签：python, django, admin

我想知道是否可以在 Django 管理应用主页上添加一个计数器，

例子：

![在此处输入图像描述](../Images/7c8f5936f8e7ea0ecae590266a2ea49c.png)

我可以为此在 models.py 或 admin.py 中创建一个@property 吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:11:22.277

尝试修改`Model._meta.verbose_name`

在您的 admin.py 文件中：

```
from app.models import CouponModel

CouponModel._meta.verbose_name_plural = "Used Coupons ( %s ) " % CouponModel.objects.all().count() 
```

我测试了它并且它有效，不知道它有多聪明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T12:34:33.743

您可以专门化字符串类型以添加​​所需的动态行为。

这是一个完整的例子：

```
from django.db import models

class VerboseName(str):
    def __init__(self, func):
        self.func = func

    def decode(self, encoding, erros):
        return self.func().decode(encoding, erros)

class UsedCoupons(models.Model):
    name = models.CharField(max_length=10)

    class Meta:
        verbose_name_plural = VerboseName(lambda: u"Used Coupons (%d)" % UsedCoupons.objects.all().count()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:10:40.410

我认为你不能在 Meta 中做到这一点，因为它需要一个动态值。修改 Meta 也会在您使用模型的所有地方进行更改，而不仅仅是管理员。我认为最好的主意是使用这样的东西[https://stackoverflow.com/a/6312798/1433029](https://stackoverflow.com/a/6312798/1433029)或使用 django 管理工具[https://bitbucket.org/izi/django-admin-tools/](https://bitbucket.org/izi/django-admin-tools/)

# javascript - 如何使用 javascript 打印页面并隐藏标题？

> ID：14217326
> 
> 赞同：2
> 
> 时间：2013-01-08T14:38:14.093
> 
> 标签：javascript, html, extends

我的网站上有一个名为 printUsers.html 的页面。
在它上面有一个使用'javascript:window.print()'打印页面的按钮。
我还在页面上使用“@media print”来在打印页面时隐藏一些按钮。
这一切都很好，我在这里没有问题。

问题如下：
站点上的所有页面都从主页扩展。所以在 printUsers.html 的顶部我有：
`#{extends 'App/main.html' /}`

这包括样式和带有按钮和下拉菜单的标题。
当用户单击打印按钮时，我想隐藏来自 main.html 的所有标题和按钮等。
我尝试将它包装到一个 div 中，给它一个 id 并隐藏它，但这不起作用。

我刚刚开始使用 javascript，所以任何帮助将不胜感激。
谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T14:50:32.610

# CSS方式

## @媒体打印

按照您在问题中的说明使用`@media Print`，但包括您不想在打印结果中看到的所有元素，并放入`display:none`它们。`margin:0 auto; text-align:center;`如果您想将其置于页面中心，您也可以将一些内容应用于您的主要内容。

**编辑：**您可以隐藏任何元素，例如`header`：

```
header
{
    display:none;
}

footer
{
    display:none;
} 
```

* * *

# Javascript 方式

## 按钮的 onClick

您的按钮的点击：

**按钮 onClick()**

```
<button id="printThatText" name="printThatText" onclick="printPage();">Print this page</button>" 
```

标头（或页面末尾）中的 javascript 代码

**Javascript**

```
function printPage()
{
    var myDropDown = document.getElementById('myDropDown');
    myDropDown.style.display = "none";
    //Whatever other elements to hide.
    window.print();
    myDropDown.style.display = "block";
    return true;
} 
```

* * *

您还可以将所有这些元素放在一个数组中，然后`for ... in ...`循环显示/隐藏它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:47:19.433

用一个封装了所有你想隐藏的东西的元素来包装内容。在打印 CSS 中，将显示设置为无。

**CSS：**

```
@media print {
    #myHeader, #myFooter { display: none }
} 
```

**的HTML：**

```
<div id="myHeader">
  <ul>
    <li>
      <a>My link</a>
   </li>
 </ul>
</div>
<div id="myContent">
  <p>This will print fine</p>
</div>
<div id="myFooter">
  <p>This will not print</p>
</div> 
```

您总是可以使用 HTML5 页眉/页脚元素！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T14:41:03.637

也许尝试相反——只打印一个特定的 div——而不是隐藏其他 div：只[打印 <div id=printarea></div>？](https://stackoverflow.com/questions/468881/print-div-id-printarea-div-only)

# c - 使用 struct 关键字的函数定义不合适

> ID：14217332
> 
> 赞同：0
> 
> 时间：2013-01-08T14:38:26.963
> 
> 标签：c

我在 C 中使用结构时遇到了问题，我有这个代码。

**更正说明** 我的代码上有一个分号，对不起我的错

我的头文件.h

```
 struct node{
    Token elem;
    void (*push)(Stack[], Token);
    Token (*pop)(Stack[]);
    Token (*peek)(Stack[]);
    boolean (*isEmpty)(Stack[]);
    boolean (*isFull)(Stack[]);
};

typedef struct node Stack; 
```

我的主程序

```
# include <stdio.h>
# include "codes/myHeader.h" <-- im using tc2 by the way so im forced to use this kind of inlcude

some codes.. 
```

当我尝试编译它时，我在 MyHeader.h 部分出现错误（假设 .c 的另一部分正在工作）它说有一个未定义的错误“节点”，我真的不知道发生了什么，一直尝试将 typedef struct node MyStructure 移动到 struct node { } 定义下方仍然会出现相同的错误

顺便说一句，我正在使用 tc2

有人关心指出我缺少什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:40:35.067

```
typedef struct node {
   int x;
   int y;
} MyStructure; 
```

如同：

```
struct node {
   int x;
   int y;
};

typedef struct node MyStructure; 
```

堆栈实现示例

```
//definitions
//C99 has #include <stdbool.h> for this
typedef short boolean;
#define true  1
#define false 0

//You may #define YOUR_APIENTRY APIENTRY (from a system header)
#define YOUR_APIENTRY
#define YOUR_APIENTRYP YOUR_APIENTRY*

//predeclarations
struct _Stack;
typedef struct _Stack Stack;

struct _StackImpl;
typedef struct _StackImpl StackImpl;

struct _Element;
typedef struct _Element Element;

//stack implementation function type definitions
typedef void    (YOUR_APIENTRYP pfnPush)     (Stack*, Element);
typedef Element (YOUR_APIENTRYP pfnPop)      (Stack*);
typedef Element (YOUR_APIENTRYP pfnPeek)     (Stack*);
typedef boolean (YOUR_APIENTRYP pfnIsEmpty)  (Stack*);
typedef boolean (YOUR_APIENTRYP pfnIsFull)   (Stack*);

//funct ptr table
struct _StackImpl{
    pfnPush     push;
    pfnPop      pop;
    pfnPeek     peek;
    pfnIsEmpty  isEmpty;
    pfnIsFull   isFull;
};

//stack
typedef struct _Stack{
    Element* elems; //any appropriate container
    size_t elemCount;
    //if you want to replace the implementation using
    //different func tables (polymorphic)
    //StackImpl* funcPtrs; 
} Stack;

//stack element
struct _Element{
    int value;
};

//default implementation /replace NULL's with actual function pointers)
StackImpl defaultStackImpl = 
{
    NULL,
    NULL,
    NULL,
    NULL,
    NULL
};

//function wrappers
void push(Stack* stack, Element elem)
{
    //if you use a polymorphic implementation
    //stack->funcPtrs->push(stack,elem);
    defaultStackImpl.push(stack,elem);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:40:02.940

如果您尝试使用名为 的裸类型`node`，那是不对的。不存在这种类型。您需要使用：

```
struct node my_node; 
```

或使用`typedef`：

```
MyStructure my_node; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T14:40:15.997

您需要在结构的最后一个 } 之后添加一个分号。

# kdb - 在 q 中分配时如何进行更改

> ID：14217334
> 
> 赞同：2
> 
> 时间：2013-01-08T14:38:30.380
> 
> 标签：kdb, q-lang

例如，我知道：

```
c1 xasc table 
```

将返回一个按 中的值按升序排序的表`c1`，但这不会更改表本身。所以我想知道是否存在除

```
table:`c1 xasc table 
```

可以将更改应用于表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T23:17:39.417

您可以执行以下操作，用新的排序版本覆盖旧表。

```
`c1 xasc `table 
```

# c# - 是否可以在域模型项目中使用 MVC Foolproof Validation

> ID：14217336
> 
> 赞同：1
> 
> 时间：2013-01-08T14:38:40.453
> 
> 标签：c#, asp.net-mvc-4, foolproof-validation

我正在尝试根据使用 MVC Foolproof Validation 提供的 RequiredIf 数据注释输入的 URL 来验证两个字段，该项目是一个具有业务逻辑、数据层、表示和单元测试层的 n 层 Web 应用程序。

目前正在业务逻辑层中找到的域项目中处理验证，我已经在其他项目中成功使用了这个包，但到目前为止还没有让它在这个项目中工作。

当我在 Web 浏览器中运行应用程序时，该字段未标记为必填，无需输入这两个字段之一即可提交表单。

有关更多详细信息，请参阅我之前在这里找到的问题：

[根据输入的 URL 验证文本框](https://stackoverflow.com/questions/14211860/validating-textboxes-based-on-the-url-entered)

到目前为止，我已经实现了一个自定义验证器，它确实捕获了错误，但用户不知道该字段实际上是必需的，直到他们提交表单而不输入值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T16:45:42.207

在查看了许多使用 n 层架构的 MVC 4 项目之后，特别是可以在此处找到的 ProDinner：

[http://prodinner.codeplex.com/](http://prodinner.codeplex.com/)

我现在决定重构应用程序，以便域（核心）现在将模型实现为 POCO，然后在从域模型继承的 MVC 项目中的视图模型中实现验证。

# c# - Web-API 获取对象

> ID：14217341
> 
> 赞同：3
> 
> 时间：2013-01-08T14:39:01.140
> 
> 标签：c#, asp.net-web-api

我创建了一个 Web-API，我想使用参数 BeginAddress (string)、EndAddress(string)、BegineDate (Datetime) 获取所有路由。我用这些属性创建了一个新的类 SearchRoute。

我可以用一个 id 或一个字符串来做一个普通的 Get，但是如何通过给一个对象来做一个 Get？这可能吗？

是否可以对一个对象进行发布/放置而不是要求退货？

```
using (HttpClient client = new HttpClient())
{
    HttpResponseMessage response = await client.GetAsync(url + userid);
    if (response.IsSuccessStatusCode)
    {
        string content = await response.Content.ReadAsStringAsync();
        List<Route> list = await SerializeService.Deserialize<List<Route>>(content);
        return list;
    }
    return null;
} 
```

网页 API 功能

```
public List<Route> GetAllByCity(SearchRoute sr)
{
    return RouteDAO.GetAllByCity(sr);
} 
```

更新：如果我这样做，则 Post 不起作用，但如果我创建一个新控制器，它就会起作用。

```
[HttpPost]
// POST api/route
public void Post([FromBody]Route route)
{
    RouteDAO.Create(route);
}

// POST api/route
[HttpPost]
public List<Route> Post([FromBody]SearchRoute sr)
{
    return RouteDAO.GetAllByCity(sr);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-02-01T19:18:09.780

即使使用复杂对象作为参数，我也更喜欢坚持使用 GET。如果您担心 URI 的长度，请记住：

1.  不需要为简单对象和复杂对象添加属性名称前缀，因为 Web API 对象绑定可以仅根据属性名称自动解析。
2.  [允许](https://www.google.com/webhp?sourceid=chrome-instant&ion=1&espv=2&ie=UTF-8#q=max%20length%20of%20url)的最大 URL 长度为 2083 个字符，这在大多数情况下已经足够了。

如果你我们以你为例

```
public class SearchRoute {
   public string BeginAddress {get;set;}
   public string EndAddress {get;set;}
   public DateTime BeginDate {get;set;}
}

[HttpGet]
public List<Route> Get([FromUri]SearchRoute sr)
{
    return RouteDAO.GetAllByCity(sr);
} 
```

搜索时的 Uri

*   BeginAddress = "一些开始";
*   EndAddress = "某个结局"
*   开始日期 = "2016-01-01T16:40:00"

结果查询字符串：

`?BeginAddress=Some beginning&EndAddress=Some ending&BeginDate=2016-01-01T16:40:00`

*同样，即使没有对象前缀/限定符，属性也会自动解析并填充对象实例。*

*   将域信息添加到 URL 可能另外 50 个左右的字符
*   添加一个控制器名称可能另外 30 个左右的字符
*   添加查询字符串 = 82 个字符

*请注意，我没有考虑将特殊字符（如空格）解析为 Url 转义字符序列*

**总共 ≈ 162 个** *字符*

考虑到允许的最大 URL 长度为 2083 个字符，这还不错，因此在这个简单的示例中，您只使用了**7%**的可能。

这可能是首选的方法，因为它符合[RESTful API 标准](https://en.wikipedia.org/wiki/Representational_state_transfer)，其中 GET 调用/动词不会更改数据，而 POST 调用/动词会这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:54:00.417

您可以通过在 URI 中使用复杂类型来传递对象。您需要使用格式正确的查询字符串来帮助 Web API。这将是一个例子：

```
?SearchRoute.BeginAddress=TheAddressValue&SearchRoute.EndAddress=TheAddressValue 
```

但是，如果您的查询字符串开始变得太大，您可能会错误地对交互进行建模。

然后，在服务器中，您应该让 Web API 知道它应该在 URI 中查找值：

```
public List<Route> GetAllByCity([FromUri]SearchRoute sr)
    {
        return RouteDAO.GetAllByCity(sr);
    } 
```

# .net - 一个方法什么时候成为“业务逻辑”的一部分，什么时候应该放在“存储库”中？

> ID：14217352
> 
> 赞同：2
> 
> 时间：2013-01-08T14:39:36.120
> 
> 标签：.net, architecture

*   你手里有一个“方法”。
*   它击中了 Db。
*   根据方法的实现，它可能是加载、保存、删除一些实体。

*你需要把这个方法放在某个地方*；您的选择是存储库或业务逻辑。

**问题：** 此方法的哪些属性使其成为业务逻辑的一部分，以便您将其放置在业务逻辑层中？

如果我换个说法：你如何决定一个方法应该放在“业务逻辑”还是“存储库”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T14:41:54.587

您的存储库应该**只**执行简单的 CRUD 操作（例如插入、选择、删除等）。如果它做得更多，它属于业务逻辑。

您可以有一个服务层来执行业务逻辑，然后调用您的存储库，但您的存储库应该是“愚蠢的”，只做 CRUD。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:50:54.843

> *   它击中了 Db。

如果该方法访问数据库，无论是执行 SQL、从 O/R 映射器查询还是任何直接与持久性相关的东西，它都应该在持久层中，而不是在业务层中。

它可能在一个 Repository 实现中，一个 DAO，你可以命名它，但绝对是一个数据访问层类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T09:12:30.110

我更喜欢将存储库调用作为基本的 CRUD 操作

具有业务逻辑的代码将在 b.logic 层。该层可以使用 Repo 调用来实现它所追求的目标

一个更好的方法，我适合的是将其视为 3 层

工作流或事务脚本层 业务逻辑层 存储库层

Repo 调用之间的工作流协调并将数据传递给业务逻辑层以执行其任务

# svn - 如何从分支开始到 HEAD 的点获得 SVN 差异？

> ID：14217364
> 
> 赞同：7
> 
> 时间：2013-01-08T14:40:11.203
> 
> 标签：svn

我想看看分支上发生了哪些变化，但我不确定如何。我想我需要找到分支的第一个修订版并使用它？

谷歌搜索没有帮助我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-08T15:05:10.973

大致

```
svn log --diff --stop-on-copy https://subversion/.../branches/BR-2-7-3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-12T15:17:11.450

您是对的，这是在创建分支时的修订号和您希望与之比较的版本的修订号之间进行比较的问题（在这种情况下，它可能是分支上的最新提交）

您需要分两步执行此操作：

1）查找分支创建时的修订号和最新提交的修订号

```
svn log --stop-on-copy <branch location eg. "https://subversion/.../branches/BR-2-7-3"> 
```

这将向您显示分支上所有提交的日志，最新的提交在顶部（以 rYYYY 的形式），分支的开始在底部（以 rXXXX 的形式）。记住这两个提交的修订号（XXXX 和 YYYY）

2）做这两个修订之间的差异

```
svn diff -rXXXX:YYYY <branch location eg. "https://subversion/.../branches/BR-2-7-3"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T14:53:59.293

我不确定您是否使用的是 Eclipse！但如果你是，你可以切换到 SVN Repository Exploring——右键单击你想要的分支，然后单击显示历史记录。在那里它会告诉你发生了什么改变以及由谁改变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-26T02:07:54.813

`svn log`现在有参数 `--diff`来生成差异输出：

```
svn log --stop-on-copy --diff path/to/branch 
```

管道到`colordiff`和`less -R`类似 git 的输出。

# java - 重新初始化组件时，我的事件监听器停止工作

> ID：14217371
> 
> 赞同：0
> 
> 时间：2013-01-08T14:40:35.447
> 
> 标签：java, swing, events, awt, event-listener

我有这个带有不同屏幕的程序（由 JPanels 表示）。每次打开屏幕时，我都会重建该面板，并将其放在`JFrame`.

现在，当我第一次构建面板（总是相同的功能）并按下一个按钮时，附加到它的代码将运行。当我重建屏幕时，它`eventSource`永远不会等于实际的`eventSource`.

见代码：

```
public class NewUserScreen extends JPanel implements MouseListener{
    //SButton inherits from Component
    SButton sb;

    ...

    public void SetFields(){
        removeAll();
        revalidate();
        repaint();

        ...     

        sb = new SButton(new Point(282, 295), "Save");
        sb.addMouseListener(this);
        add(sb);

        ...
    }

    ...

    @Override
    public void mouseReleased(MouseEvent arg0) {
        if(arg0.getSource().equals(sb)){
            DBManager.addUser(...);
        }else{
            //So after the 2nd build, it will always run this code :(
            ScreenManager.OpenAdminS();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:48:00.600

1.  > 让这个程序具有不同的屏幕（由 JPanels 表示）。每次打开屏幕时，我都会重建该面板，并将其放在 JFrame 上。

    *   使用[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)而不是删除并向[JFrame添加新视图](http://docs.oracle.com/javase/tutorial/uiswing/components/frame.html)
2.  > 现在，当我第一次构建面板（总是相同的功能）并按下一个按钮时，附加到它的代码将运行。当我重建屏幕时，eventSource 永远不会等于实际的 eventSource。

    *   必须调用`(re)validate()`和`repaint()`为父（`JFrame`在你的情况下），一次，作为最后的代码行（在对容器的所有更改完成之后）

# c# - 如何覆盖 ControlTemplate 中的属性？

> ID：14217372
> 
> 赞同：6
> 
> 时间：2013-01-08T14:40:36.720
> 
> 标签：c#, wpf

我有以下 XAML：

```
<Window x:Class="WpfTest.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="227" Width="391">
    <Window.Resources>
        <ControlTemplate x:Key="PentagonButton" TargetType="{x:Type Button}">
            <Grid>
                <Path Data="M 0,-1 L -.95,-.3 L -.58,.8 L .58,.8 L .95,-.3 Z" Stroke="Black" Stretch="Uniform" Fill="Red" />
                <Viewbox>
                    <ContentPresenter Margin="20" />
                </Viewbox>
            </Grid>
        </ControlTemplate>
    </Window.Resources>
    <Grid>
        <Button Content="red" Margin="12,19,0,0" Template="{StaticResource PentagonButton}" HorizontalAlignment="Left" Width="166" Height="151" VerticalAlignment="Top" />        
        <Button Content="blue" Margin="178,19,0,0" Template="{StaticResource PentagonButton}" Height="151" VerticalAlignment="Top" HorizontalAlignment="Left" Width="173" />        
    </Grid>
</Window> 
```

由于 Fill="Red"，显然所有按钮都将具有红色填充/背景颜色。我想为几个按钮使用这个模板，但每个按钮都有不同的填充颜色，在设计时就知道了。设置背景颜色没有效果，所以我必须更改填充颜色，但我无法在实际按钮定义中再次定义 Path 属性。如何在 XAML 中访问和覆盖此属性？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-08T14:47:14.847

不要直接使用模板。分配一个样式并使用它。

IE

```
 <Style x:Key="PentagonButton" TargetType="{x:type Button}">
 <Setter Property="Background" Value="Red"/>
    <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type Button}">
                <Grid>
                    <Path Data="M 0,-1 L -.95,-.3 L -.58,.8 L .58,.8 L .95,-.3 Z" Stroke="Black" Stretch="Uniform" Fill="{TemplateBinding Background}" />
                    <Viewbox>
                        <ContentPresenter Margin="20" />
                    </Viewbox>
                </Grid>
            </ControlTemplate>
    </Setter.Value>
    </Setter>
    </Style> 
```

然后像这样使用它：

```
<Grid>
        <Button Content="red" Margin="12,19,0,0" Style="{StaticResource PentagonButton}" HorizontalAlignment="Left" Width="166" Height="151" VerticalAlignment="Top" />        
        <Button Content="blue" Margin="178,19,0,0" Style="{StaticResource PentagonButton}" Height="151" VerticalAlignment="Top" HorizontalAlignment="Left" Width="173" Background="Blue" />        
    </Grid> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T14:50:44.687

使用 TemplateBinding 在其控件的 xaml 中更改模板的值：

```
 <ControlTemplate x:Key="PentagonButton" TargetType="{x:Type Button}">
                    <Grid>
                        <Path Data="M 0,-1 L -.95,-.3 L -.58,.8 L .58,.8 L .95,-.3 Z" Stroke="Black" Stretch="Uniform" Fill="{TemplateBinding Background}" />
                        <Viewbox>
                            <ContentPresenter Margin="20" />
                        </Viewbox>
                    </Grid>
                </ControlTemplate> 
```

你的按钮：

```
 <Button Background="Red" Content="red" Margin="12,19,0,0" Template="{StaticResource PentagonButton}" HorizontalAlignment="Left" Width="166" Height="151" VerticalAlignment="Top" />
                <Button Background="Blue" Content="blue" Margin="178,19,0,0" Template="{StaticResource PentagonButton}" Height="151" VerticalAlignment="Top" HorizontalAlignment="Left" Width="173" /> 
```

# ruby-on-rails - 为什么 ActiveRecord 的 :include 做两个查询？

> ID：14217379
> 
> 赞同：3
> 
> 时间：2013-01-08T14:40:57.600
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

我只是在学习 ActiveRecord 和 SQL，我的印象是`:include`执行一个 SQL 查询。所以如果我这样做：

```
Show.first :include => :artist 
```

它将执行一个查询，该查询将返回第一个节目和艺术家。但是查看生成的 SQL，我看到两个查询：

```
[2013-01-08T09:38:00.455705 #1179] DEBUG -- :   Show Load (0.5ms)  SELECT `shows`.* FROM `shows` LIMIT 1
[2013-01-08T09:38:00.467123 #1179] DEBUG -- :   Artist Load (0.5ms)  SELECT `artists`.* FROM `artists` WHERE `artists`.`id` IN (2) 
```

我看到了一个 Railscast 视频，作者正在查看`:include`vs `:join`，我在控制台上看到了输出 SQL，这是一个大型 SQL 查询，但它只是一个查询。我只是想知道这是应该的还是我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T16:36:22.370

Active Record 有两种预先加载关联的方式。:includes 将根据一些启发式方法触发其中任何一个。

一种方法是每个关联有一个查询：首先加载所有节目（1 个查询），然后加载所有艺术家（第二个查询）。如果您当时包含一个关于艺术家的关联，这将是第三个查询。所有这些查询都是简单的查询，尽管这确实意味着在您的特定情况下不会获得任何优势。因为查询是分开的，所以您不能做诸如通过子关联订购顶级（显示）之类的事情。

第二种方法是将所有内容加载到一个基于大连接的查询中。这总是产生一个查询，但它更复杂 - 每个关联包含 1 个连接，并且将结果集转换回 ruby​​ 对象的代码也更复杂。还有一些其他极端情况：无法处理多态的 belongs_to 并且在同一级别包含多个 has_many 会产生非常大的结果集）。

Active Record 将默认使用第一种策略（预加载），除非它认为您的查询条件或订单正在引用关联，在这种情况下它会回退到第二种方法。您可以通过使用 `preload`or`eager_load`代替来强制使用策略`:includes`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:07:25.787

Using`:includes`是一种提供急切加载的解决方案。在您的示例中，它将最多加载两个查询。如果您要更改您的查询`Show.all :include => :artist`。这也将只调用两个查询。

更好的解释：[Active Record Querying Eager Loading](http://guides.rubyonrails.org/active_record_querying.html#eager-loading-associations)

# java - 如何在 Netbeans 中创建/生成 WCF RESTful Web 服务客户端

> ID：14217380
> 
> 赞同：0
> 
> 时间：2013-01-08T14:40:57.830
> 
> 标签：java, netbeans, wcf-rest, restful-architecture

我在 WCF 中有一个 RESTful 网络服务。

如何在 Netbeans 中为其创建/生成 RESTful Web 服务客户端？

最终，我想在 JSF Web 应用程序中使用它。

# events - JavaFX 2：将鼠标事件传递给其他窗口？

> ID：14217387
> 
> 赞同：2
> 
> 时间：2013-01-08T14:41:14.667
> 
> 标签：events, popup, window, mouseevent, javafx-2

我创建了一个可在屏幕上拖动的 PopUp，就像一个独立于主窗口的 Photoshop 调色板。

但是，当我将这个 PopUp 拖到主窗口上时，我希望主窗口做出反应，即从拖动中接收鼠标事件。

问题似乎在于，由于 PopUp 本身就是一个 Window ，它会消耗拖动鼠标事件，而主窗口永远不会得到它们。

我尝试让主窗口成为弹出窗口的所有者，但它仍然没有得到它们。

有没有办法解决这个问题？谢谢

# php - 将自己的 CSS 应用到外部页面

> ID：14217390
> 
> 赞同：0
> 
> 时间：2013-01-08T14:41:35.207
> 
> 标签：php, jquery, css

我想将一个外部页面链接到一个新选项卡中，并将我自己的 css 应用于它，这会改变这个外部页面的总体布局。css 在另一台服务器中。

这可以做到吗？

我正在使用 php、jquery 和 Apache 服务器。

我想在我的服务器上使用 php 代理请求外部页面并添加 css 但可能，如果有解决方案，它会更有效。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:45:41.470

将页面下载到您的服务器，应用 CSS，然后将页面显示给用户（代理）是执行此操作的唯一方法。如果该站点不安全并且具有可以注入的漏洞，则可以使用黑帽方式进行操作..但我怀疑这里是否有人会给您一种令人讨厌的方式来做到这一点+一旦被发现没有怀疑它会恢复到原来的 css 并修补漏洞。

如果可能，请考虑安全风险。这些天 CSS 非常强大，想象一下如果您可以更改 google.com 上的 CSS - Fun Times :D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:43:30.430

不，它不能以代理以外的方式完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:49:03.123

将 CSS 注入嵌入式 iframe（或者更一般地说，对子 iframe 执行*任何*操作）的能力将打开一个巨大的安全漏洞。

想象一下，您在我使用的网络邮件服务中显示一个 iframe，并对其进行大量重新设计，使我的“撰写回复”页面看起来像来自邮件服务的“确认密码”页面。当我天真地输入密码时，它会将我的密码通过电子邮件发送给受访者！

您可以通过使用浏览器插件或扩展来实现您想要的目标。访问一个网站应该需要零信任，但安装一个扩展通常*确实*意味着来自用户的一些信任，因此扩展比普通网页具有更大的自由度。

请注意，服务器代理获取不会发送用户的会话/身份验证 cookie，因此如果您尝试获取需要登录的站点（例如 Facebook），您将只能获取公共资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T14:52:06.767

根据您想要实现的目标，可能会有更好的方法。如果您打算将它分发给许多用户`broser plugin`，或者可能更容易创建，则`UserScript`适用于`Greasemonkey`/ Tampermonkey 之类的插件。另一种方法是创建一个`bookmarklet`供用户在其浏览器栏中单击的。在这里看看这个：http: [//benalman.com/projects/run-jquery-code-bookmarklet/](http://benalman.com/projects/run-jquery-code-bookmarklet/)它很容易创建。

# c# - 变量不保存在对象中

> ID：14217391
> 
> 赞同：1
> 
> 时间：2013-01-08T14:41:39.323
> 
> 标签：c#, xml, oop, mvvm

因此，我正在从 XML 读取文件，并且使用 Debug-Output 可以很好地工作。

```
while (reader.Read())
{
    if (reader.NodeType == XmlNodeType.Element && reader.Name == "Note")
    {
        Note n = new Note();

        reader.ReadToFollowing("NoteTitle");
        string s = reader.ReadElementContentAsString();
        n.NoteTitle = s;
        Debug.WriteLine("s " + s);
        Debug.WriteLine("n " + n.NoteTitle);
     }
} 
```

我的问题是

```
n.NoteTitle = s; 
```

不做任何事情，所以第二个调试只打印“n”，而第一个调试打印`"s Notetitle1"`正确。

我的问题是什么？

编辑：对不起，NoteTitle 的实现：

```
private string _noteTitle = string.Empty;
    public string NoteTitle
    {
        get { return this._noteTitle; }
        set { RaisePropertyChanged("NoteTitle"); }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:27:25.370

查看`NoteTitle`设置器的实现，您忘记设置私有字段的值，即

```
private string _noteTitle = string.Empty; 

public string NoteTitle 
{ 
    get { return this._noteTitle; } 
    set 
    { 
        this._noteTitle = value; // set the field value
        RaisePropertyChanged("NoteTitle"); 
    } 
} 
```

这可以解释为什么在设置`NoteTitle`属性时没有保留任何值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T15:20:00.077

OP 中的序列化似乎让人们望而却步。我认为这个问题可以更好地表达为：

```
 Note n = new Note();
    string s = "TEST";
    n.NoteTitle = s;
    Debug.WriteLine("s " + s);
    Debug.WriteLine("n " + n.NoteTitle); 
```

问题变成了：为什么第二个 WriteLine() 显示“n”而不是“n TEST”？

答案是 Note.NoteTitle 的 setter 或 getter 的实现有一些特殊之处。例如，此实现将产生以下效果：

```
public string NoteTitle
{
    get
    {
        return "";
    }

    set
    {
        // Do nothing.
    }
} 
```

# python - Stumped - 在 Python 中从字典列表中获取具有多个关联值的唯一键

> ID：14217392
> 
> 赞同：2
> 
> 时间：2013-01-08T14:41:39.813
> 
> 标签：python, dictionary

我正在解析一个 csv 文件来执行一些基本的数据处理。我正在使用的文件是网站的用户活动日志，格式如下：

```
User ID, Url, Number of Page Loads, Number of Interactions 
```

用户 ID 和 URL 是字符串，页面加载次数和交互次数是整数。

我正在尝试确定哪个 url 具有最佳的交互页面比率。

我正在努力的部分是获取唯一值并汇总列中的结果。

我编写了以下代码：

```
import csv
from collections import defaultdict

fields = ["USER","URL","LOADS","ACT"]

file = csv.DictReader(open('file.csv', 'rU'), delimiter=",",fieldnames=fields)
file.next()

dict = defaultdict(int)

for i in dict:
    dict[i['URL']] += int(i['LOADS']) 
```

这工作正常。它返回一个唯一 url 列表，其中包含字典中 url 的总加载数 -`{ 'URL A' : 1000 , 'URL B' : 500}`

问题是当我尝试向 url 键添加多个值时，我很难过。

我试过修改for循环来做：

```
for i in dict:
    dict[i['URL']] += int(i['LOADS']), int(i['ACT']) 
```

我收到了`TypeError: unsupported operand type(s) for +=: 'int' and 'tuple'`。为什么第二个值被认为是一个元组？

我尝试添加 just `int(i[ACT])`，效果很好。就在我同时尝试这两个值的时候。

我在 python 2.6.7；关于如何做到这一点以及为什么将其视为元组的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:44:29.133

因为`int(i['LOADS']), int(i['ACT'])`是一个元组：

```
>>> 1, 2
(1, 2) 
```

如果要同时添加两个变量，只需将它们相加即可：

```
+= int(i['LOADS']) + int(i['ACT']) 
```

此外，您正在遮蔽内置函数`dict`和`list`类型。使用不同的变量名称。`list`一旦你的影子你将无法使用内置：

```
>>> d = {1: 2, 3: 4}
>>> list(d)
[1, 3]
>>> list = 5
>>> list(d)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'int' object is not callable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:44:36.127

*就在我同时尝试这两个值的时候。*

你想如何“添加”它们？作为他们的总和？

```
for i in list:
    dict[i['URL']] += int(i['LOADS']) + int(i['ACT']) 
```

另外，不要使用`list`and`dict`作为变量名。

```
import csv
fields = ["USER","URL","LOADS","ACT"]

d = {}
with open('file.csv', 'rU') as f:
    csvr = csv.DictReader(f, delimiter=",",fieldnames=fields)
    csvr.next()
    for rec in csvr:
        d[rec['URL']] = d.get(rec['URL'], 0) + int(rec['LOADS']) + int(rec['ACT']) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:53:26.663

你最好使用 a`list`作为你的 defaultdict 容器：

```
import csv
from collections import defaultdict

d = defaultdict(list)
fields = ["USER","URL","LOADS","ACT"]

with open('file.csv', 'rU') as the_file:
    rows = csv.DictReader(the_file, delimiter=",",fieldnames=fields)
    rows.next()

    for row in rows:
        data = (int(row['LOADS']),int(row['ACT']))
        d[row['URL']].append(data) 
```

现在你有

```
d['someurl'] = [(5,17),(7,14)] 
```

现在你可以做任何你想做的总和，例如，`loads`一个 URL 的所有：

```
load_sums = {k:sum(i[0] for i in d[k]) for k in d} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T17:38:19.607

您可以使用面向对象的方法并定义一个类来保存信息。它比大多数其他答案更冗长，但值得考虑。

```
import csv
from collections import defaultdict

class Info(object):
    def __init__(self, loads=0, acts=0):
        self.loads = loads
        self.acts = acts
    def __add__(self, args): # add a tuple of values
        self.loads += args[0]
        self.acts += args[1]
        return self
    def __repr__(self):
        return '{}(loads={}, acts={})'.format(self.__class__.__classname__,
                                              self.loads, self.acts)

summary = defaultdict(Info)
fields = ["USER", "URL", "LOADS", "ACTS"]

with open('urldata.csv', 'rU') as csv_file:
    reader = csv.DictReader(csv_file, delimiter=",", fieldnames=fields)
    reader.next() # skip header
    for rec in reader:
        summary[rec['URL']] += (int(rec['LOADS']), int(rec['ACTS']))

for url,info in summary.items():
    print '{{{!r}: ({}, {})}}'.format(url, info.loads, info.acts) 
```

# java - 如何在 Gson/Json 中获取对象标识符的名称？

> ID：14217404
> 
> 赞同：0
> 
> 时间：2013-01-08T14:42:13.520
> 
> 标签：java, json, gson

我有一个这样的 Json 文件

```
{Users:[{
user1 :{
email: "sth"
phone : "sth"
}},
user2:{
email:"sth"
phone:"sth"
}]} 
```

以上是只读文件。我正在使用以下代码：

```
BufferedReader br = new BufferedReader(fileReader);
    Myclass myclass= gson.fromJson(br, Myclass.class); 
```

所以我可以使用我的课程来获取电子邮件和电话的值。但我也想要用户名。即 user1 电子邮件电话 user2 电子邮件电话

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:45:41.997

将用户名作为另一个属性，如下所示：

```
{Users:[{ name: "user1", email: "sth", phone : "sth" }, {name: "user2", email:"sth", phone:"sth"}]} 
```

如果您可以向我们展示 Myclass，提供更多详细信息会有所帮助，但它应该看起来像这样：

```
public class Myclass [

    private List<User> Users;

    public List<User> getUsers() {
        return Users;
    }

    public void setUsers(List<User> Users) {
        this.Users = Users;
    }
} 
```

和

```
public class User {

    private String email;

    private String name;

    private String phone;

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getPhone() {
        return phone;
    }

    public void setPhone(String phone) {
        this.phone = phone;
    }
} 
```

这将适用于您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:14:21.277

如果您无法修改 json，那么您可能必须编写自己的反序列化器。像这样的东西：

```
public class UserDeserializer implements JsonDeserializer<User> {

    @Override
    public User deserialize(JsonElement jsonElement, Type typeOfT, JsonDeserializationContext context) {
        Map.Entry<String, User> userAndName = jsonElement.getAsJsonObject().entrySet().iterator().next();

        String name = userAndName.getKey();

        JsonObject userInfo = userAndName.getValue().getAsJsonObject();

        String email = userInfo.get("email").getAsString();
        String phone = userInfo.get("phone").getAsString();

        return new User(name, email, phone);
    }
} 
```

然后，您将在创建 gson 实例时注册反序列化器：

```
Gson gson = new GsonBuilder()
    .registerTypeAdapter(User.class, new UserDeserializer())
    .create(); 
```

# git - 为什么我不能推送新克隆的 repo？

> ID：14217406
> 
> 赞同：2
> 
> 时间：2013-01-08T14:42:16.770
> 
> 标签：git

因为我创建了一个共享 repo 文件夹，路径为：//web1/www 在另一台 PC 中，我创建了一个文件夹，然后打开了 bash，我做了：

```
$ git clone //web1/www 
```

然后在新创建的 repo 文件夹中：

```
$ git status
# On branch master
nothing to commit, working directory clean 
```

我添加了一个文件，然后：

```
$ git add .
$ git commit -m 'new file added'
$ git push origin master 
```

但是，这就是我在下面得到的错误，知道我现在该怎么办吗？

```
$ git push origen master
fatal: 'origen' does not appear to be a git repository
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.

s.ali@WEB2 /d/ketab projects/www (master)
$ git remote -v
origin  //web1/www (fetch)
origin  //web1/www (push)

s.ali@WEB2 /d/ketab projects/www (master)
$ git push origin master
Counting objects: 3, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (2/2), done.
Writing objects: 100% (2/2), 257 bytes, done.
Total 2 (delta 1), reused 0 (delta 0)
remote: error: refusing to update checked out branch: refs/heads/master
remote: error: By default, updating the current branch in a non-bare repository
remote: error: is denied, because it will make the index and work tree inconsist
ent
remote: error: with what you pushed, and will require 'git reset --hard' to matc
h
remote: error: the work tree to HEAD.
remote: error:
remote: error: You can set 'receive.denyCurrentBranch' configuration variable to

remote: error: 'ignore' or 'warn' in the remote repository to allow pushing into

remote: error: its current branch; however, this is not recommended unless you
remote: error: arranged to update its work tree to match what you pushed in some

remote: error: other way.
remote: error:
remote: error: To squelch this message and still keep the default behaviour, set

remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse'. 
```

PS：我在 Windows 7 本地网络上，使用域而不是工作组

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T21:02:55.737

这是因为您的来源是一个完整的存储库。

如果你想推送到一个仓库，它需要是一个光秃秃的（没有工作树）

创建 repo 时使用 --bare 标志

`git init --bare`

push 命令只更新内部 git 文件，而不是工作目录。所以本质上，如果你推送到一个完整的仓库，HEAD（工作目录中的签出文件）实际上将在你刚刚推送的前沿提交的后面。所以 git 开发人员决定不允许这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:20:15.180

> git push 起源大师

它的起源

```
git push origin master 
```

# windows-phone-7 - Windows Phone 8 GeoCoordinateWatcher 与 Geolocator

> ID：14217408
> 
> 赞同：10
> 
> 时间：2013-01-08T14:42:17.870
> 
> 标签：windows-phone-7, windows-phone-8, location

Windows Phone 8 具有`GeoCoordinateWatcher`Windows Phone 7 中存在的 ，但它也具有[`Geolocator`](http://msdn.microsoft.com/en-US/library/windows/apps/windows.devices.geolocation.geolocator)，两者都执行相同的功能，即允许您“观察”地理位置的变化。我找不到任何关于是否`GeoCoordinateWatcher`已弃用、`Geolocator`现在是否应该使用的信息——或者两者之间的差异。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T14:47:48.137

简单 - 如果您不需要或计划 WP7 的版本，仅适用于 WP8，则使用 Geolocator - 它比 GeoCoordinateWatcher 更易于配置。
或者，我在我的应用程序中使用了另一种解决方案，使用依赖注入并为您的地理定位服务实现通用接口，这将在 WP8 版本中使用 Geolocator 并在 WP7 中使用 GeoCoordinateWatcher 来实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T18:16:14.167

此外，Geolocator 可以在后台使用，而 GeoCoordinateWatcher 则不能。

我在 WP8 SDK 泄露时写过它。如果您想看一下，我的帖子在下面，但我相信 MSDN 文档也应该在某个地方涵盖它。

[http://www.adambenoit.com/development/continuous-location-tracking-windows-phone-8-part-2-background/](http://www.adambenoit.com/development/continuous-location-tracking-windows-phone-8-part-2-background/)

希望这些附加信息有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-30T13:53:31.633

不仅它们具有相同的功能，而且 Geolocator 非常快，我已经进行了一些测试，虽然一个好的旧 GeoCoordinateWatcher 可以在大约 3 秒内获得您在粗糙区域的位置，但 GeoLocator 需要大约 0.3 秒才能找到您。因此，为 GeoLocator 获胜。

顺便说一句，我认为“地理定位器可以在后台运行”，他们指的是像他们在这个例子中使用的那样使用它：http: [//msdn.microsoft.com/en-us/library/windowsphone/develop/jj662935 (v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj662935(v=vs.105).aspx)

也就是说，没有后台代理的限制。我建议我们开始采用 GeoLocator，除非您同时针对 WP 7.8 和 WP8

# html - CKEditor 4 将 HTML 保存到数据库

> ID：14217409
> 
> 赞同：0
> 
> 时间：2013-01-08T14:42:28.387
> 
> 标签：html, sql, content-management-system, ckeditor, asp.net-4.0

感谢您提前查看我的问题。

我正在尝试将 ckeditor 的内容保存到数据库中。我收到以下错误：

```
 A potentially dangerous Request.Form value was detected from the client (ctl00$ctl00$mainContent$rightContent$ctl00$txtContent="<p> Look for a pla..."). 
```

我做了一些研究，大多数解决方案都是针对旧版本的软件或者是不安全的。

我正在使用 ASP.NET 4.0，如果有任何建议，我将不胜感激。

# java - 在 Swing 中添加组件的性能更高的顺序是什么

> ID：14217411
> 
> 赞同：1
> 
> 时间：2013-01-08T14:42:35.343
> 
> 标签：java, swing, components, add

我需要重构我的应用程序，因为我遇到了渲染问题，这可能是由于未正确使用事件调度线程造成的。为了做正确的事情，我尝试收集信息。我已经开始了这个关于 EDT 的线程： [何时在 Swing 中实现组件](https://stackoverflow.com/questions/14192572/when-exactly-are-components-realized-in-swing)

现在我想了解更多关于嵌套面板的最佳方法。

假设我有以下结构：

[面板A [面板B [面板C]]]

什么会更高效（对 invalidate() 的内部调用更少）

订单 1（首先是内部组件，然后是外部组件）：

```
PanelB.add(PanelC);
PanelA.add(PanelB); 
```

订单 2（首先是外部组件，然后是内部）：

```
PanelA.add(PanelB);
PanelB.add(PanelC); 
```

如果有人还有更多关于如何获得最高性能 UI 的信息/链接/提示等，我将不胜感激。大多数教程只是解释基础知识。

一个相关的问题：由于所有 JComponents 都是容器，我考虑通过添加组件来保存一些 JPanel，比如一个 JButton。这是一个好习惯吗：

```
JButton b=new JButton();
b.setLayout(new BorderLayout(),BorderLayout.Right);
b.add(new MyComponent()); 
```

当我更改组件的布局时，如何知道组件默认使用的布局以及可能发生的情况？

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:03:25.937

1.  您不必担心添加组件的顺序，用户不会注意到差异。

2.  一般来说，您不应该担心 UI 的性能。Swing 代码本身将“足够快”。仅当您从 UI 开始长时间运行的非 UI 任务时，性能/响应能力才会变得有趣。

3.  如果您将面板添加到按钮，它将使用户感到困惑。您可以检查组件的源代码以查看它们的布局管理器（但这很少需要）

# xslt - 为 xml 中的每个 xsl:text 标签设置 disable-output-escaping="yes"

> ID：14217412
> 
> 赞同：3
> 
> 时间：2013-01-08T14:42:35.583
> 
> 标签：xslt, text, escaping, output

说我有以下xml：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/*">
  <display>
    <xsl:for-each select="logline_t">
      <xsl:text disable-output-escaping="yes">&lt;</xsl:text> <xsl:value-of select="./line_1" <xsl:text disable-output-escaping="yes">&gt;</xsl:text>
      <xsl:text disable-output-escaping="yes">&lt;</xsl:text> <xsl:value-of select="./line_2" <xsl:text disable-output-escaping="yes">&gt;</xsl:text>
      <xsl:text disable-output-escaping="yes">&lt;</xsl:text> <xsl:value-of select="./line_3" <xsl:text disable-output-escaping="yes">&gt;</xsl:text>
    </xsl:for-each>
  </display>
</xsl:template>
</xsl:stylesheet> 
```

有没有办法为文档中出现的所有 xsl:text 设置 disable-output-escaping="yes" ？

我知道有一个选项可以放置 < xsl:output method="text"/> 并且每次都像 & lt; 出现时，会出现一个<，但问题是有时在line_1、line_2或line_3的值中，有一个“$lt;” 我不想改变（也就是说，我只需要改变两者之间的任何东西）

这就是我想要完成的。我有这个xml：

```
<readlog_l>
 <logline_t>
  <hora>16:01:09</hora>
  <texto>Call-ID: 663903&lt;hola&gt;396@127.0.0.1</texto>
 </logline_t>
</readlog_l> 
```

而这个翻译：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/*">
 <display>

  &lt;screen name="<xsl:value-of select="name(.)"/>"&gt;

  <xsl:for-each select="logline_t">
  &lt; field name="<xsl:for-each select="*"><xsl:value-of select="."/></xsl:for-each>" value="" type="label"/&gt;
  </xsl:for-each>

  &lt;/screen&gt;

 </display>
</xsl:template>

</xsl:stylesheet> 
```

我希望这是输出：

```
<?xml version="1.0"?>
<display>

<screen name="readlog_l">

  <field name="16:01:09 Call-ID: 663903&lt;hola&gt;396@127.0.0.1 " value="" type="label">

</screen>
</display> 
```

请注意，我需要字段名称中的“<”不要被转义，这就是我不能使用输出方法文本的原因。

另外，请注意，这是一个示例，翻译要大得多，所以这就是为什么我试图找出如何不为我需要的每个 '<' 或 '>' 编写禁用输出转义。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:27:35.580

感谢您澄清问题。在这种情况下，我相当确定没有必要禁用输出转义。XSLT 旨在完成您正在做的事情：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/*">
 <display>

  <screen name="{name(.)}">

  <xsl:for-each select="logline_t">
     <xsl:variable name="nameContent">
        <xsl:for-each select="*">
          <xsl:if test="position() > 1"><xsl:text> </xsl:text></xsl:if>                 
          <xsl:value-of select="."/>
        </xsl:for-each>
     </xsl:variable>
     <field name="{$nameContent}" value="" type="label" />
  </xsl:for-each>

  </screen>

 </display>
</xsl:template>

</xsl:stylesheet> 
```

在这一点上我有点不清楚：请注意，我需要字段名称中的“<”不要被转义，这就是为什么我不能使用输出方法文本的原因。

你指的是哪个<？是“hola”周围的<和>吗？如果你让那些未转义的，你最终会得到无效的 XML。您的示例输出中的 name 属性看起来也有很多不在输入 XML 中的值。那些是从哪里来的？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T13:33:40.437

鉴于您的预期输出，您根本不需要 doe 。这是一个不使用 doe 的可能解决方案，它基于模板而不是`for-each`：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes" />

  <xsl:template match="/*">
    <display>
      <screen name="{name(.)}">
        <xsl:apply-templates select="logline_t"/>
      </screen>
    </display>
  </xsl:template>

  <xsl:template match="logline_t">
    <field value="" type="label">
      <xsl:attribute name="name">
        <xsl:apply-templates select="*" mode="fieldvalue"/>
      </xsl:attribute>
    </field>
  </xsl:template>

  <xsl:template match="*[last()]" mode="fieldvalue">
    <xsl:value-of select="." />
  </xsl:template>

  <xsl:template match="*" mode="fieldvalue">
    <xsl:value-of select="." />
    <xsl:text> </xsl:text>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T17:21:02.417

如果您想在所有内容上设置 doe，这表明您正在尝试“手动”生成标记。我不认为这是一个特别好的想法（实际上，我认为这是一个糟糕的想法），但如果这是你想做的，我会建议使用文本输出方法而不是 xml 输出方法。这样，不会发生特殊字符的转义，因此不需要禁用它。

# java - 我的 findCombos 方法不起作用，如何从 java 字符数组中删除字符

> ID：14217413
> 
> 赞同：0
> 
> 时间：2013-01-08T14:42:37.303
> 
> 标签：java, binary-search, arrays, character-arrays

我正在制作一种方法，它将返回一个`String[]`包含一个字母不同的单词的有效组合。该方法将`String`包含单词字典的数组作为第一个参数，将另外两个分别包含单词 one 和 two 的字符串作为第二个和第三个参数。

这是我的方法：

```
public static String[] findCombos(String[] dict, String a, String b){
    char[] wordA = a.toCharArray();
    char[] wordB = b.toCharArray();
    int length = wordA.length;
    List<String> validCombos = new ArrayList<String>();
    Arrays.sort(dict);
    //wordA     
    for(int i = 0; i<length; i++){
        char tmp = wordA[i];
        wordA[i] = 0;
        String tmpWordA = new String(wordA).trim();
        //tmpWordA = tmpWordA + wordA.toString().trim();
        if(Arrays.binarySearch(dict, tmpWordA) >= 0){
            int lengthb = wordB.length;
            String tmpWordB = new String(wordB).trim();
            //tmpWordB = tmpWordB + wordB.toString();
            for(int j = 0; j<lengthb; j++){
                tmpWordB = new StringBuffer(tmpWordB).insert(j ,tmp).toString();
                if(Arrays.binarySearch(dict, tmpWordB) >= 0){
                    validCombos.add(tmpWordA + "\\t" + tmpWordB);//combo found
                }else{
                    wordA[i] = tmp;
                }
            }
        }else{
            wordA[i] = tmp;
        }
    }
    //wordB
    int lengthb = b.length();
    for(int i = 0; i<lengthb; i++){
        char tmp = wordB[i];
        wordB[i] = 0;
        String tmpWordB = new String(wordB).trim();
        //tmpWordB = tmpWordB + wordB.toString().trim();
        if(Arrays.binarySearch(dict, tmpWordB) >= 0){
            int lengtha = a.length();
            String tmpWordA = new String(wordA).trim();
            //tmpWordA = tmpWordA + wordA.toString();
            for(int j = 0; j< lengtha; j++){
                tmpWordA = new StringBuffer(tmpWordA).insert(j, tmp).toString();
                if(Arrays.binarySearch(dict, tmpWordA) >= 0){
                    validCombos.add(tmpWordA + "\\t" + tmpWordB);//combo found
                }else{
                    wordB[i] = tmp;
                }
            }
        }else{
            wordB[i] = tmp;
        }
    }
    String[] res = validCombos.toArray(new String[0]);
    return res;
} 
```

数组已经排序，我确定有问题的元素在数组中，但是搜索不断返回负数并自动分支到`else`子句。有任何想法吗？这是字典的链接：

[字典 - PasteBin](http://pastebin.com/qsK275Ek)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:15:57.707

您没有删除索引 i 处的字符，而是将索引处的字符替换为`i`0，该错误假设会破坏您的算法。

**使用 StringBuilder 从字符数组中按索引删除字符**

```
String mystring = "inflation != stealing";
char[] my_char_array = mystring.toCharArray();
StringBuilder sb = new StringBuilder();
sb.append(mystring);
sb.deleteCharAt(10);
my_char_array = sb.toString().toCharArray();
System.out.println(my_char_array);             //prints "inflation = stealing" 
```

上面的代码从字符数组中删除了感叹号。

**滚动您自己的 java 函数以从字符数组中删除一个字符：**

```
String msg = "johnny can't program, he can only be told what to type";

char[] mychararray = msg.toCharArray();
mychararray = remove_one_character_from_a_character_array_in_java(mychararray, 21);
System.out.println(mychararray);

public char[] remove_one_character_from_a_character_array_in_java(
                           char[] original, 
                           int location_to_remove)
{
    char[] result = new char[original.length-1];
    int last_insert = 0;
    for (int i = 0; i < original.length; i++){
        if (i == location_to_remove)
            i++;

        result[last_insert++] = original[i];
    }
    return result;
}

//The above method prints the message with the index removed. 
```

来源： [https ://stackoverflow.com/a/11425139/445131](https://stackoverflow.com/a/11425139/445131)

# actionscript-3 - 数字标牌应用 (as3)

> ID：14217420
> 
> 赞同：1
> 
> 时间：2013-01-08T14:42:47.567
> 
> 标签：actionscript-3, flash, timer, loader

我正在尝试为我工作的公司开发一个数字标牌应用程序，使用 flash cs6。它实际上由两个应用程序组成，一个是服务器端，另一个安装在具有运行 windows xp 的集成计算机的电视显示器上。服务器应用程序只不过是管理员用来输入通过某些 php 存储在 mysql 数据库中的数据的表单。那工作正常。

我的问题是在显示器中运行的客户端。该应用程序实际上非常简单：它应该从 mysql 表中加载不同种类的信息的“部分”，因此加载所有存储在服务器中的文本、图像和视频。事情是加载器与计时器并行运行。计时器负责调用影片剪辑和帧，这样我就不需要为时间轴中的所有内容设置动画，并且应用程序会在循环中从一个部分到另一个部分继续运行。我在哪里发现问题。我无法找到一种合适的方法来以与计时器配合良好的方式对此类加载程序进行编程。所以最终结果是图像和视频被部分加载或从未加载，使客户端应用程序以奇怪的方式运行。这是应用程序部分之一的示例：

```
import flash.utils.Timer;
import flash.display.MovieClip;
import flash.events.Event;
import flash.events.TimerEvent;
import fl.transitions.*;
import fl.transitions.easing.*;

var randomNumber:Number = Math.random();
var xAnivItemRef:Number = 75;
var yAnivItemRef:Number = 140;
var anivArray:Array = new Array  ;
var endingTimer:Timer = new Timer(10000);
var loopTimer:Timer = new Timer(500);
var counter:uint = 0;
var fotosURL:String = "http://www.maxionline.com.br/maxi_sds/server/img/aniversariantes/";
var current_time = new Date();
var i:uint = 0;
var alphaTween:Tween;
var aniversariante_mc:MovieClip;
var numAniversariantes:uint;

endingTimer.addEventListener(TimerEvent.TIMER, leaveEvents);
loopTimer.addEventListener(TimerEvent.TIMER, loadAniv);

function setTitleMonth(event:Event = null)
{
          var month:String = current_time.getMonth();
          switch (month)
          {
                    case "0" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "janeiro!";
                              break;

                    case "1" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "fevereiro!";
                              break;

                    case "2" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "março!";
                              break;

                    case "3" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "abril!";
                              break;

                    case "4" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "maio!";
                              break;

                    case "5" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "junho!";
                              break;

                    case "6" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "julho!";
                              break;

                    case "7" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "agosto!";
                              break;

                    case "8" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "setembro!";
                              break;

                    case "9" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "outubro!";
                              break;

                    case "10" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "novembro!";
                              break;

                    case "11" :
                              anivTitle_mc.anivTitlePt2_mc.month_txt.text = "dezembro!";
                              break;

                    default :
                              break;
          }
}

function anivSetup(event:Event = null):void
{
          var anivLoader:URLLoader = new URLLoader();
          anivLoader.dataFormat = URLLoaderDataFormat.TEXT;
          anivLoader.load(new URLRequest("http://www.maxionline.com.br/maxi_sds/client/dataRecoverAniv.php?_rand =" + randomNumber));
          anivLoader.addEventListener(Event.COMPLETE, getAnivData);
}

function getAnivData(evt:Event = null):void
{
          var anivDataStr:String = evt.target.data;
          var anivDataArray:Array = anivDataStr.split("&");
          var numItemsStr:String = anivDataArray[anivDataArray.length - 1].substr(5);
          var numItems:Number = Number(numItemsStr) * 4;
          numAniversariantes = numItems/4;
          anivDataArray.splice(anivDataArray.length - 1, 1);

          for (var i:uint=0; i<numItems; i++)
          {
                    anivArray.push(anivDataArray[i]);
          }
          loadAniv();
          anivMask_mc.gotoAndPlay("on");
          endingTimer.start();
          loopTimer.start();
}

function loadAniv(event:Event = null):void
{
          var aniversariante:anivItem_mc = new anivItem_mc();
          aniversariante.name = "aniversariante" + counter;

          if (numAniversariantes > 12)
          {
                    if (counter < 4)
                    {
                              aniversariante.y = yAnivItemRef + (220 * counter);
                              aniversariante.x = xAnivItemRef;
                    }
                    if (counter >= 4 && counter < 8)
                    {
                              aniversariante.y = yAnivItemRef + (220 * (counter - 4));
                              aniversariante.x = xAnivItemRef + 1355;
                    }
                    if (counter >= 8 && counter < 12)
                    {
                              aniversariante.y = yAnivItemRef + (220 * (counter - 8));
                              aniversariante.x = xAnivItemRef + 250;
                    }
                    if (counter >= 12 && counter < 16)
                    {
                              aniversariante.y = yAnivItemRef + (220 * (counter - 12));
                              aniversariante.x = xAnivItemRef + 895;
                    }
          }
          if (numAniversariantes > 8 && numAniversariantes <= 12)
          {
                    if (counter < 4)
                    {
                              aniversariante.y = yAnivItemRef + (220 * counter);
                              aniversariante.x = xAnivItemRef;
                    }
                    if (counter >= 4 && counter < 8)
                    {
                              aniversariante.y = yAnivItemRef + (220 * (counter - 4));
                              aniversariante.x = xAnivItemRef + 1355;
                    }
                    if (counter >= 8 && counter < 12)
                    {
                              aniversariante.y = yAnivItemRef + (220 * (counter - 8));
                              aniversariante.x = xAnivItemRef + 250;
                    }
          }
          if (numAniversariantes > 0 && numAniversariantes <= 8)
          {
                    if (counter < 4)
                    {
                              aniversariante.y = yAnivItemRef + (220 * counter);
                              aniversariante.x = xAnivItemRef + 200;
                    }
                    if (counter >= 4 && counter < 8)
                    {
                              aniversariante.y = yAnivItemRef + (220 * (counter - 4));
                              aniversariante.x = xAnivItemRef + 1150;
                    }
          }
          anivLoader_mc.addChild(aniversariante);
          aniversariante_mc = MovieClip(root).aniv_mc.anivLoader_mc.getChildByName("aniversariante" + counter);
          aniversariante_mc.anivName_txt.text = anivArray[i];
          aniversariante_mc.day_mc.anivDay_txt.text = anivArray[i + 1];

          var imgLoader:Loader = new Loader();
          imgLoader.load(new URLRequest(fotosURL + anivArray[i + 3]));
          imgLoader.contentLoaderInfo.addEventListener(ProgressEvent.PROGR ESS,imageLoading);
          imgLoader.contentLoaderInfo.addEventListener(Event.COMPLETE,imag eLoaded);

          var fadein:TransitionManager = new TransitionManager(aniversariante_mc);
          fadein.startTransition({type:Fade, direction:Transition.IN, duration:1, easing:Strong.easeOut});

          counter++;
          i = i + 4;

          if (i >= anivArray.length)
          {
                    loopTimer.stop();
                    loopTimer.removeEventListener(TimerEvent.TIMER, loadAniv);
          }
}

function leaveEvents(event:TimerEvent):void
{
          endingTimer.removeEventListener(TimerEvent.TIMER, leaveEvents);
          endingTimer.stop();
          anivMask_mc.gotoAndPlay("off");
          play();
}

function imageLoading(evt:ProgressEvent):void
{
          var loaded:Number = evt.bytesLoaded / evt.bytesTotal;
          updateProgress(loaded);
}

function updateProgress(vl:Number)
{
          aniversariante_mc.photo_mc.preloader_mc.loadingBar_mc.width = vl * aniversariante_mc.photo_mc.preloader_mc.loadingBar_mc.width;
}

function imageLoaded(event:Event):void
{
          var loadInfo:LoaderInfo = (event.target as LoaderInfo);
          aniversariante_mc.photo_mc.photoLoader_mc.addChild(loadInfo.cont ent);
}

anivSetup();
setTitleMonth();

stop(); 
```

.fla 可以在这里下载：

[http://www.maxionline.com.br/maxi_sds/sds_client.fla](http://www.maxionline.com.br/maxi_sds/sds_client.fla)

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T20:09:08.683

退一步看大图……

我已经使用 Flash 构建了一个数字标牌类型的应用程序，内容从服务器交付，目前已开始其第四年的更新。我认为的一些一般性想法：

1.  不要将传统的 Flash 时间轴用于程序的主要流程。而是使用 Actionscript 3 以编程方式执行所有操作。这应该可以消除一些无法正确显示的问题，但更重要的是可以实现更大的可扩展性。这也将允许您在动态插入内容时更好地控制。

2.  有一个顶级“管理器”类来管理您将循环播放的内容的“播放列表”。当内容播放完毕时，它应该通知“管理员”播放完毕（或失败），以便管理员可以立即播放下一个内容项。这将需要在适用的情况下添加事件侦听器和处理程序，在某些情况下可能会替换计时器。

3.  将所有代码保存在类文件（ClassName.as）中，并将它们组织到文件夹（命名空间）中。没有任何仅位于随机关键帧上的内联 Actionscript。您可以使用“导出到 Actionscript”选项将库项目链接到类。

4.  保持你的主类尽可能小，将尽可能多的代码推送到单独的类文件中。

5.  大多数动画和补间可以使用[TweenLite](http://www.greensock.com/tweenlite/)和[TimelineMax](http://www.greensock.com/timelinemax/)系列中的包来完成。

6.  任何动画，如您拥有的徽标，都应包含在其自己的电影剪辑/库对象/类中，以便您可以轻松地将其插入任何地方。对于您的徽标动画，如果包含它，使用传统时间线对其进行动画处理应该没有任何问题。

7.  在机器上本地下载所有服务器内容，然后让 Flash 在本地读取所有内容。这应该消除对内容的长时间等待，尤其是在互联网陷入困境的情况下。

8.  为每种内容类型（视频、图像幻灯片、介绍动画等）设置一个类。这将允许您插入自定义内容。

9.  尽可能使用 XML 或 JSON。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-11-10T23:13:35.433

您可以使用一个名为“Xibo”的在线开源软件，它非常有用，可能能够满足您的需求。[https://springsignage.com/xibo-for-android/](https://springsignage.com/xibo-for-android/)

# javascript - 重用 kendo-ui 模板

> ID：14217421
> 
> 赞同：2
> 
> 时间：2013-01-08T14:42:50.203
> 
> 标签：javascript, kendo-ui

第一次渲染模板工作正常。它按预期显示：

![在此处输入图像描述](../Images/d6826ccc48cf58f6013d12f225e3ea65.png)

当返回并再次导航到同一屏幕时，会导致以下结果，其中会丢失列表格式：

![在此处输入图像描述](../Images/440d379384c961baeb9c8c8c20364547.png)

为什么会发生这种情况以及如何预防？

下面是模板定义：

```
<div data-role="view" data-layout="app" data-title="Time Card" id="screen1">
</div>
<script type="text/x-kendo-template" id="template1">
    Heading
    <ul data-role="listview" data-style="inset" data-type="group"> 
        <ul data-role="listview">
            Group 1
            # for (var i = 0; i < data.headers.length; i++) { #
                <li><a>#= data.heades[i].Item #</a></li>
            # } #
        </ul>
        <ul data-role="listview">
            Group 2
            <li>hello</li>
            <li>goodbye</li>
        </ul>
    </ul>
</script> 
```

下面是填充模板并导航到它的代码：

```
var templateContent = $("#template1").html();
var template = kendo.template(templateContent);
var data = {headers: headers};
$("#screen1").html(template(data));
app.navigate("#screen1"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T17:10:37.243

发生这种情况是因为您要替换不受支持的视图的 HTML。例如，小部件在更改后不会重新初始化。

```
$("#screen1").html(template(data)); //html replacement of the View's content is not supported 
```

我的建议是[将小部件绑定到 DataSource](http://demos.kendoui.com/mobile/listview/databinding.html)并使用其[API 方法](http://docs.kendoui.com/api/framework/datasource#methods)来更改内容。ListView 会在数据更改后自动重新渲染模板。

# xcode - 没有应用名称的bundelPath

> ID：14217422
> 
> 赞同：0
> 
> 时间：2013-01-08T14:42:54.507
> 
> 标签：xcode, cocoa-bindings

我需要在没有应用名称的情况下获取应用的路径（bundlePath 或 bundleURL）

```
NSUrl *strUrl = [[NSBundle mainBundle]bundleURL];

NSString *str = [[NSBundel mainBundel]bundlePath]; 
```

我该怎么做

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T19:30:51.930

两者`NSURL`和`NSString`都有删除最后一个路径组件的方法，因此这应该提供您正在寻找的内容：

```
NSURL *strUrl = [[[NSBundle mainBundle] bundleURL] URLByDeletingLastPathComponent];

NSString *str = [[[NSBundle mainBundle] bundlePath] stringByDeletingLastPathComponent]; 
```

# jquery - 通过 JSON 从 last.fm 获取数据没有给出正确的响应

> ID：14217426
> 
> 赞同：1
> 
> 时间：2013-01-08T14:42:58.877
> 
> 标签：jquery, json, undefined, last.fm

由于某种奇怪的原因，我的 JSON 请求编写了以下 HTML。

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

不明确的

*Kamaya Painters 是荷兰艺术家 Tijs Verwest（更为人熟知的 Tiesto）和排名第一的 Benno De Goeij 使用的团体名称。所有曲目均在 Black Hole Recordings 上发行，随后被授权给 Planetary Conciousness 和 Data Records 标签。Endless Wave，1998 年，是 Kamaya Painters 发行的第一首曲子，它被誉为真正的恍惚经典之一，尽管它实际上暗示了与 Liquid Child - Diving Faces 相似的旋律。*- **我通过我的脚本要求提供简历，所以这确实有效。**

我编写了以下 jQuery 代码来调用 JSON 并将其写入我的 HTML。

```
$('#artists li a').live('click',function() {

    var artistid = $('img', this).attr('alt');

    $.getJSON("http://ws.audioscrobbler.com/2.0/?method=artist.getinfo&artist=" + artistid +            "&api_key=XXXXXXXXXXXXXXXXXXXXXXXXX&format=json&callback=?", function(data) {
                var popupinfohtml = '';
                $.each(data.artist, function(i, item) {      
                console.log(data);   
                popupinfohtml += " <h5> " +item.name+ " </h5><p> " +item.summary+ "</p>";
                });
                $('#moreinfo').html(popupinfohtml);
    }); 
 }); 
```

这是匹配的响应：[http ://www.last.fm/api/show/artist.getInfo](http://www.last.fm/api/show/artist.getInfo)

有谁能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:46:55.877

据我了解[您发布](http://www.last.fm/api/show/artist.getInfo)的链接中的文档，请求返回一个 XML 结构。因此，将其附加到您的 HTML 页面总是会导致奇怪的结果，因为浏览器只会忽略 XML 标记，如 "" 或 "" 等。

剩下并因此显示的是 XML 标记内的内容。

祝你好运。:)

# c++ - cppunit SEGFAULT - 带有核心转储

> ID：14217430
> 
> 赞同：0
> 
> 时间：2013-01-08T14:43:06.390
> 
> 标签：c++, cppunit

我有一个执行的 CppUnit 测试套件，并在执行结束时执行应用程序段。

我一直试图理解这个核心转储一段时间，但我无法弄清楚可能出了什么问题，但如果我将它粘贴在这里，也许有人会遇到这样的问题并为我指明一个好的方向。

```
Program terminated with signal 11, Segmentation fault.
#0  0x000000000100ad8e in CppUnit::XmlOutputter::XmlOutputter (this=0x7fffc180bc00, result=<optimized out>, stream=<optimized out>, encoding=...) at XmlOutputter.cpp:21
21      XmlOutputter.cpp: No such file or directory.
        in XmlOutputter.cpp
(gdb) where
#0  0x000000000100ad8e in CppUnit::XmlOutputter::XmlOutputter (this=0x7fffc180bc00, result=<optimized out>, stream=<optimized out>, encoding=...) at XmlOutputter.cpp:21
#1  0x00000000016e7d18 in ?? ()
#2  0x0000000001426498 in std::string::_Rep::_S_empty_rep_storage ()
#3  0x000000000101488a in ?? ()
#4  0x00000000016d1de8 in ?? ()
#5  0x00000000016e79e0 in ?? ()
#6  0x00000000016e79f0 in ?? ()
#7  0x00000000016e79e8 in ?? ()
#8  0x00007f93740040e0 in ?? ()
#9  0x00007f9374001310 in ?? ()
#10 0x0000000000000004 in ?? ()
#11 0x00007fffc180bcf8 in ?? ()
#12 0x00007f93740040e0 in ?? ()
#13 0x00000000016e79e0 in ?? ()
#14 0x000000000100b1a2 in CppUnit::XmlOutputter::addSuccessfulTest (this=<optimized out>, test=0x7f9374004de0, testNumber=32767, testsNode=0x7f9374001610) at XmlOutputter.cpp:195
#15 0x00007f937c47bd85 in std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) () from /usr/lib64/libstdc++.so.6
#16 0x000000000100a887 in CppUnit::TextTestRunner::~TextTestRunner (this=<optimized out>, __in_chrg=<optimized out>) at TextTestRunner.cpp:36
#17 0x000000000100a4ca in __exchange_and_add_single (__val=<optimized out>, __mem=<optimized out>) at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/ext/atomicity.h:70
#18 __exchange_and_add_dispatch (__val=<optimized out>, __mem=<optimized out>) at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/ext/atomicity.h:86
#19 _M_dispose (__a=<optimized out>, this=<optimized out>) at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/bits/basic_string.h:234
#20 ~basic_string (this=<optimized out>, __in_chrg=<optimized out>) at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/bits/basic_string.h:494
#21 _Destroy<std::basic_string<char, std::char_traits<char>, std::allocator<char> > > (__pointer=<optimized out>) at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/bits/stl_construct.h:88
#22 _Destroy<std::basic_string<char, std::char_traits<char>, std::allocator<char> >*> (__last=<optimized out>, __first=<optimized out>) at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/bits/stl_construct.h:103
#23 _Destroy<std::basic_string<char, std::char_traits<char>, std::allocator<char> >*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > (__last=<optimized out>, __first=0x0)
    at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/bits/stl_construct.h:128
#24 _M_destroy_data_aux (__last=<optimized out>, __first=<optimized out>, this=<optimized out>) at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/bits/deque.tcc:709
#25 _M_destroy_data (__last=<optimized out>, __first=<optimized out>, this=<optimized out>) at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/bits/stl_deque.h:1604
#26 ~deque (this=<optimized out>, __in_chrg=<optimized out>) at /proj/ims_lu/repository/LOTC/R1A07-0/usr/include/c++/4.3/bits/stl_deque.h:776
#27 ~Message (this=<optimized out>, __in_chrg=<optimized out>) at ../../include/cppunit/Message.h:39
#28 CppUnit::TextOutputter::printFailureDetail (this=0x407a80, thrownException=0x7fffc180d1b0) at TextOutputter.cpp:101
#29 0x00007f937c3e7b38 in ?? () from /usr/lib64/libstdc++.so.6
#30 0x00007fffc180bf50 in ?? ()
#31 0x00007fffc180c0b0 in ?? ()
#32 0x00007fffc180c0c8 in ?? ()
#33 0x00007f937d84f58b in _dl_map_object_deps () from /lib64/ld-linux-x86-64.so.2
Backtrace stopped: previous frame inner to this frame (corrupt stack?) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T20:59:16.370

只是一个猜测，但请尝试将通用 TestRunner 与 XmlOutputter 一起使用，而不是*TextTestRunner*

```
CPPUNIT_NS::TextUi::TestRunner runner;

std::ofstream outputFile("testOutput.xml" );
CPPUNIT_NS::XmlOutputter  xmlOutputter( &runner.result(), outputFile ); 
runner.addTest( testSuite );
runner.setOutputter( &xmlOutputter );
runner.run(); 
```

# php - Joomla！2.5 生成的URL中的组件菜单类型参数

> ID：14217433
> 
> 赞同：1
> 
> 时间：2013-01-08T14:43:28.427
> 
> 标签：php, joomla, components, joomla-k2

我正在修改 K2 itemslist->category 视图以提供标签，因此显示的文章将是指定的类别和视图之一。

我的问题是：**如何向菜单类型添加一个菜单参数，它将在项目 URL 上插入自己的值？**

在我的情况下，生成的菜单类型 url 是

"index.php?option=com_k2&view=itemlist&layout=category&task=category&id=1&tag="

我不明白为什么标签是空白的。

[这是我的 category.xml](https://gist.github.com/4484243)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T07:53:43.340

带入 URL 的参数是在请求字段和字段集中指定的参数

```
<fields name="request">
    <fieldset name="request">
        <!-- Matt93 added this line. -->
        <field name="tag" type="tag" default="" label="K2_SELECT_TAG" description=""/>
        <!-- end -->
        <field name="task" type="hidden" default=""/>
        <field name="id" type="hidden" default=""/>
    </fieldset>
</fields> 
```

您在此处正确添加了标签字段，但它的默认值为“”，表示没有值。这正是您在 URL 中看到的内容（无价值）。尝试设置不同的默认值，您将在您的 URL 中看到它。此外，您几乎在每个字段集中都设置了标签字段。删除除请求字段集中的所有内容。

# c++ - ISO-8859 到 UTF-8 转换 C++

> ID：14217434
> 
> 赞同：0
> 
> 时间：2013-01-08T14:43:28.503
> 
> 标签：c++, utf-8, character-encoding

我一直在尝试使用从以下获得的代码将 ISO-8859 字符集转换为 utf-8： [Convert ISO-8859-1 strings to UTF-8 in C/C++](https://stackoverflow.com/questions/4059775/convert-iso-8859-1-strings-to-utf-8-in-c-c) 这是我的代码：

```
#include <iostream>
#include <string>

using namespace std;
int main(int argc,char* argv[])
{
    string fileName ="ħëlö";
    int len= fileName.length();
    char* in = new char[len+1];
    char* out = new char[2*(len+1)];
    memset(in,'\0',len+1);
    memset(out,'\0',len+1);
    memcpy(in,fileName.c_str(),2*(len+1));

    while( *in )
    {
            cout << " ::: " << in ;
            if( *in <128 )
            {
                    *out++ = *in++;
            }
            else
            {
                    *out++ = 0xc2+(*in>0xbf);
                    *out++ = (*in++&0x3f)+0x80;
            }
    }
    cout << "\n\n out ::: " << out << "\n";
    *out = '\0';
} 
```

但输出是

```
::: ħëlö ::: ?ëlö ::: ëlö ::: ?lö ::: lö ::: ö ::: ?

 out ::: 
```

输出“out”应该是一个 utf-8 字符串，但它不是。我在 Mac OS X 中得到这个 ..

我在这里做错了什么..？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:50:26.160

您正在增加`out`循环中的指针，导致您忘记输出开始的位置。传递给的指针`cout`是递增的指针，因此它显然不再指向生成输出的开头。

此外，终止`out`发生*在*打印之后，这当然是错误的方法。

此外，这依赖于源代码和东西的编码，不是很好。您应该以不同的方式表达输入字符串，使用具有十六进制值的单个字符或为了安全起见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:53:02.343

ISO-8859-1 没有该字符`ħ`，因此您的源不可能按照方法要求在 ISO-8859-1 中。或者您的源代码在 ISO-8859-1 中，但是一旦您保存它`ħ`就会被替换。`?`

# cakephp - CakePHP 验证取决于其他字段

> ID：14217442
> 
> 赞同：10
> 
> 时间：2013-01-08T14:43:48.293
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1, cakephp-2.2

我想知道是否可以使用 CakePHP 验证规则来验证一个依赖于另一个字段的字段。

我一直在阅读[有关自定义验证规则的文档，](http://book.cakephp.org/2.0/en/models/data-validation.html#adding-your-own-validation-methods)但`$check`参数仅包含要验证的当前字段的值。

例如。**只有当****new_password**字段不为空时，我才想根据*需要*定义**verify_password**字段。（如果

 *****无论如何我都可以用 Javascript 来做，但我想知道是否可以直接用 CakePHP 来做。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-08T14:50:57.700

当您验证模型上的数据时，数据已经是[`set()`](http://api20.cakephp.org/class/model#method-Modelset). 这意味着您可以在模型的`$data`属性上访问它。下面的示例检查我们正在验证的字段，以确保它与验证规则中定义的其他字段（例如密码确认字段）相同。

验证规则如下所示：

```
var $validate = array(
    'password' => array(            
        'minLength' => array(
            'rule' => array('minLength', 6),
            'message' => 'Your password must be at least 6 characters long.'
        ),
        'notempty' => array(
            'rule' => 'notEmpty',
            'message' => 'Please fill in the required field.'
        )
    ),
    'confirm_password' => array(
        'identical' => array(
            'rule' => array('identicalFieldValues', 'password'),
            'message' => 'Password confirmation does not match password.'
        )
    )
); 
```

然后，我们的验证函数查看传递的字段数据（confirm_password）并将其与我们在规则中定义的数据（传递给`$compareFiled`）进行比较。

```
function identicalFieldValues(&$data, $compareField) {
    // $data array is passed using the form field name as the key
    // so let's just get the field name to compare
    $value = array_values($data);
    $comparewithvalue = $value[0];
    return ($this->data[$this->name][$compareField] == $comparewithvalue);
} 
```

这是一个简单的示例，但您可以使用`$this->data`.

您帖子中的示例可能如下所示：

```
function requireNotEmpty(&$data, $shouldNotBeEmpty) {
    return !empty($this->data[$this->name][$shouldNotBeEmpty]);
} 
```

和规则：

```
var $validate = array(
  'verify_password' => array(
    'rule' => array('requireNotEmpty', 'password')
  )
); 
```*****

# vba - 检查 Access 2010 导航子窗体是否打开

> ID：14217443
> 
> 赞同：3
> 
> 时间：2013-01-08T14:43:50.167
> 
> 标签：vba, ms-access-2010

我正在开发一个程序来跟踪使用导航表单作为始终打开的主菜单的客户信息。许多子表单都有列表框，需要在输入/更改数据时重新查询，或者用户倾向于认为他们没有更改记录集，我们最终会得到重复的数据。在我运行刷新之前，我无法弄清楚如何检查导航表单的特定子表单是否打开......它们都被称为“NavigationSubform”。因此，例如，如果我为客户添加新的工作安排，我想在“onclose”事件中重新查询此列表框，以确保他们拥有最新信息。我可以做到... Forms!navMain!NavigationSubform.Form.lstEmployment.Requery ...但是如果用户在关闭表单之前更改了导航表单上的窗格，它就会爆炸。这种情况经常发生：例如，客户在您输入工作安置信息时打断了您，您停下来输入咨询说明，然后再返回，将主菜单留在“临床”目录中。有没有办法检查导航子表单对象中是否加载了特定的子表单？我附上了一个屏幕截图，以防它有助于理解。

在此先感谢您的任何建议！！

[就业屏幕](http://i.stack.imgur.com/mJYWJ.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:52:25.567

已经有一段时间了，但我相信您可以使用 isLoaded 方法来确定是否加载了子表单

[http://msdn.microsoft.com/en-us/library/office/ff194656.aspx](http://msdn.microsoft.com/en-us/library/office/ff194656.aspx)

希望这会有所帮助，布伦特

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:54:49.887

您可以使用源对象属性检查子窗体控件的内容，例如：

```
forms!mainform.asubformcontrol.sourceobject 
```

您还可以从表单对象中获取表单的名称：

```
forms!mainform.asubformcontrol.form.name 
```

# c++ - 在同一进程中从 C++ 程序运行可执行文件

> ID：14217444
> 
> 赞同：2
> 
> 时间：2013-01-08T14:43:51.007
> 
> 标签：c++, process

那可能吗？我想轻松访问可执行文件的内存来编辑它。或者，当我不是管理员时，是否可以从另一个进程编辑可执行文件的内存？我已经尝试过 ptrace 库，如果我不是管理员，它会失败。我在 Linux

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T09:14:23.823

这就是调试器所做的。您可以查看开源调试器的代码，例如 gdb，以了解它是如何工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T08:31:18.750

答案：

*   是的 - 它有效：您不必是管理员/root，但当然您需要访问进程内存的权限，即同一用户。
*   不——这并不容易

写入的可能性`/proc/pid/mem`是不久前添加到 Linux 内核中的。因此，这取决于您使用的内核。小程序在内核 3.2 和 2.6.32 中进行了检查。

该解决方案包括两个程序：

1.  启动的“服务器”分配一些内存，将一些模式写入该内存，并每三秒输出一次在打印模式后放置的内存内容。
2.  通过 /proc/pid/maps 和 /proc/pid/mem 连接到服务器的“客户端”搜索模式并将其他一些字符串写入服务器的内存。

该实现使用堆 - 但只要权限允许 - 也可以更改其他进程内存的其他部分。

这是在 C 中实现的，因为它非常“低级” - 但它应该在 C++ 中工作。这是一个概念证明——没有生产代码——例如缺少一些错误检查，并且它有一些固定大小的缓冲区。

# 内存持有者.c

```
/*
 * Alloc memory - write in some pattern and print out the some bytes
 * after the pattern.
 *
 * Compile: gcc -Wall -Werror memholder.c -o memholder.o
 */

#include <sys/types.h>
#include <string.h>
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>

int main() {

   char * m = (char*) malloc(2048);
   memset(m, '\xAA', 1024);
   strcpy(m + 1024, "Some local data.");

   printf("PID: %d\n", getpid());

   while(1) {
      printf("%s\n", m + 1024);
      sleep(3);
   }

   return 0;
} 
```

# 记忆作者.c

```
/*
 * Searches for a pattern in the given PIDs memory
 * and changes some bytes after them.
 *
 * Compile: gcc -Wall -std=c99 -Werror memwriter.c -o memwriter
 */

#include <sys/types.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <string.h>
#include <sys/mman.h>
#include <sys/ptrace.h>
#include <sys/wait.h>

int open_proc_file(pid_t other_pid, char const * const sn,
   int flags) {
   char fname[1024];
   snprintf(fname, 1023, "/proc/%d/%s", other_pid, sn);
   // Open file for reading and writing
   int const fd = open(fname, flags );
   if(fd==-1) {
      perror("Open file");
      exit(1);
   }
   return fd;
}

void get_heap(int fd_maps, size_t * heap_start, size_t * heap_end) {
   char buf[65536];
   ssize_t const r = read(fd_maps, buf, 65535);
   if(r==-1) {
      perror("Reading maps file");
      exit(1);
   }
   buf[r] = '\0';
   char * const heap = strstr(buf, "[heap]");
   if(heap==NULL) {
      printf("[heap] not found in maps file");
      exit(1);
   }

   // Look backward to the latest newline
   char const * hl_start;
   for(hl_start = heap; hl_start > buf && *hl_start != '\n'; 
       --hl_start) {}
   // skip \n
   ++hl_start;

   // Convert to beginnig and end address
   char * lhe;
   *heap_start = strtol(hl_start, &lhe, 16);
   ++lhe;
   *heap_end = strtol(lhe, &lhe, 16);
}

int main(int argc, char *argv[]) {

   if(argc!=2) {
      printf("Usage: memwriter <pid>\n");
      return 1;
   }

   pid_t const other_pid = atoi(argv[1]);
   int fd_mem = open_proc_file(other_pid, "mem", O_RDWR);
   int fd_maps = open_proc_file(other_pid, "maps", O_RDONLY);

   size_t other_mem_start;
   size_t other_mem_end;
   get_heap(fd_maps, &other_mem_start, &other_mem_end);

   ptrace(PTRACE_ATTACH, other_pid, NULL, NULL);
   waitpid(other_pid, NULL, 0);

   if( lseek(fd_mem, other_mem_start, SEEK_SET) == -1 ) {
      perror("lseek");
      return 1;
   }

   char buf[512];

   do {
      ssize_t const r = read(fd_mem, buf, 512);
      if(r!=512) {
         perror("read?");
         break;
      }

      // Check for pattern
      int pat_found = 1;
      for(int i = 0; i < 512; ++i) {
         if( buf[i] != '\xAA' ) 
            pat_found = 0;
            break;
      }
      if( ! pat_found ) continue;

      // Write about one k of strings
      char const * const wbuf = "REMOTE DATA - ";
      for(int i = 0; i < 70; ++i) {
         ssize_t const w = write(fd_mem, wbuf, strlen(wbuf));
         if( w == -1) {
            perror("Write");
            return 1;
         }
      }
      // Append a \0
      write(fd_mem, "\0", 1);
      break;

   } while(1);

   ptrace(PTRACE_DETACH, other_pid, NULL, NULL);   

   close(fd_mem);
   close(fd_maps);

   return 0;
} 
```

# 示例输出

```
$ ./memholder
PID: 2621
Some local data.
Some local data.
MOTE DATA - REMOTE DA... 
```

# 其他解释

您的问题还有另一种解释（在阅读标题而不是问题时），您想将一个进程中的“可执行文件”替换为另一个进程。这可以由`exec()`（和朋友）轻松处理：

来自`man exec`：

> exec() 系列函数用新的进程映像替换当前进程映像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T14:54:34.130

我不完全确定您在问什么，但这可以通过共享内存实现。

见这里：[http ://www.kernel.org/doc/man-pages/online/pages/man7/shm_overview.7.html](http://www.kernel.org/doc/man-pages/online/pages/man7/shm_overview.7.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-09T16:23:23.390

在 Windows 中，用于此的方法被命名为 ReadProcessMemory / WriteProcessMemory，但是，您需要为此的管理权限。linux 也是如此，正如我在评论中所说，没有健全的系统会允许**用户**进程修改非拥有的内存。

对于 linux，唯一的功能是[ptrace](http://www.linuxmanpages.com/man2/ptrace.2.php)。您**需要**成为管理员。

[http://cboard.cprogramming.com/cplusplus-programming/92093-readprocessmemory-writeprocessmemory-linux-equivalent.html](http://cboard.cprogramming.com/cplusplus-programming/92093-readprocessmemory-writeprocessmemory-linux-equivalent.html)包含更详细的讨论。

你能想象在没有管理员身份的情况下允许进程修改其他进程内存的后果吗？

# objective-c - UIWebView 不加载外部图像

> ID：14217448
> 
> 赞同：1
> 
> 时间：2013-01-08T14:44:07.170
> 
> 标签：objective-c, ios, uiwebview

我正在使用 loadHTMLString 方法加载 UIWebView，根据连接速度，有时不会加载图像，我只看到一个空白矩形而不是图像。有没有人看到这个问题？请注意，图像是外部链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:04:08.627

```
NSURLRequest *req = [NSURLRequest requestWithURL:webUrl];

[self.WebView loadRequest:req]; 
```

if images are only external hyperlink

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:55:07.227

也许你需要设置你的 baseURL。您的 HTML img 部分看起来如何？您是否引用了包括 http:// 在内的整个超链接？确保完整的链接在那里，你应该没有问题。如果您在包中本地引用图像，则使用：

```
NSString *htmlFile = [[NSBundle mainBundle] pathForResource:@"filename" ofType:@"html"];
NSString *HTMLData = [[NSString alloc] initWithContentsOfFile:htmlFile];
[webView loadHTMLString:HTMLData baseURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] bundlePath]]]; 
```

# javascript - 在 JavaScript 中由一个字符而不是连续的字符分割

> ID：14217450
> 
> 赞同：6
> 
> 时间：2013-01-08T14:44:17.700
> 
> 标签：javascript, regex, string, split, contiguous

情况如下：

```
var stringExample = "hello=goodbye==hello";
var parts = stringExample.split("="); 
```

输出：

```
hello,goodbye,,hello 
```

我需要这个输出：

```
hello,goodbye==hello 
```

连续/重复的字符必须忽略，只取单个`"="`来拆分。

也许一些正则表达式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T14:45:35.737

您可以使用正则表达式：

```
var parts = stringExample.split(/\b=\b/); 
```

`\b`检查单词边界。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T15:03:03.223

Most probably, @dystroys answer is the one you're looking for. But if any characters other than alphanumerics (`A-Z`, `a-z`, `0-9` or `_`) could surround a "splitting `=`"), then his solution won't work. For example, the string

```
It's=risqué=to=use =Unicode!=See? 
```

would be split into

```
"It's", "risqué=to", "use Unicode!=See?" 
```

So if you need to avoid that, you would normally use a lookbehind assertion:

```
result = subject.split(/(?<!=)=(?!=)/);  // but that doesn't work in JavaScript! 
```

So even though this *would* only split on single `=`s, you can't use it because JavaScript doesn't support the `(?<!...)` lookbehind assertion.

Fortunately, you can always transform a `split()` operation into a global `match()` operation by matching everything that's allowed *between* delimiters:

```
result = subject.match(/(?:={2,}|[^=])*/g); 
```

will give you

```
"It's", "risqué", "to", "use ", "Unicode!", "See?" 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-08T15:29:33.200

作为可能的解决方案的第一个近似值可能是：

```
".*[^=]=[^=].*" 
```

请注意，这只是正则表达式，如果您想将它与 egrep、sed、java 正则表达式或其他任何东西一起使用，请注意是否需要转义某些内容。

注意！：这是第一个近似值，可以改进。请注意，例如，此正则表达式不会匹配此字符串“=”（null - equal - null）。

# batch-file - 如何将字符 q 从批处理文件发送到 GIT

> ID：14217456
> 
> 赞同：2
> 
> 时间：2013-01-08T14:44:41.697
> 
> 标签：batch-file, git-bash

我需要从我正在使用的脚本中显示我的存储库的最后一次提交：

```
git log -1 --pretty=oneline 
```

问题来了：

1.  由于想要使用这种格式打印，一行打印了整个提交哈希。

    `git log -1 --pretty=format:%h\ %s\ %an`

    但是批处理文件中的部分代码由于`%`符号而被识别为变量。

2.  为了完成显示日志，有必要发送字符`q`，当直接输入到 git bash 时效果很好，但是当从批处理文件发送时，我得到“'q' 不被识别为内部或外部命令”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:11:42.947

除非您在发出诸如 等命令时强制使用寻呼机`git log`，否则如果没有控制终端，该命令将不会使用寻呼机，这需要您键入`q`以退出寻呼机。

您可以使用以下方法测试我在此处描述的内容：

```
git log -1 --pretty=oneline | cat 
```

注意`cat`上面命令末尾的使用。

如果`git`仍然需要您输入 a `q`，那么您必须查看是否没有任何配置文件（全局-- -- 或`~/.gitconfig`本地-- `.git/config`）迫使 git 使用寻呼机。

您可以通过使用以下内容来规避（不更改配置文件）git的行为：

```
GIT_PAGER= git log -1 --pretty=oneline 
```

注意等号和之间的空格`git`。

关于百分号，您可能必须提供有关您的环境的更多详细信息，因为我看不到 bash 本身将百分号解释为变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-29T17:58:19.903

至于“q”问题：

```
git --no-pager 
```

# oracle - 如何在从 v$sql 收到的 Oracle 查询中查找参数？

> ID：14217461
> 
> 赞同：15
> 
> 时间：2013-01-08T14:45:01.020
> 
> 标签：oracle, parameters, prepared-statement

我使用查询：

```
 select LAST_LOAD_TIME, ELAPSED_TIME, MODULE, SQL_TEXT elasped from v$sql
 WHERE MODULE='JDBC Thin Client'
 ORDER BY LAST_LOAD_TIME DESC 
```

过去了：

```
 delete from tableA where fk in (select pk from tableB where tableB.fk=:1
 and tableB.date between :2 and :3) 
```

是否可以找到这些参数 1、2 和 3？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-08T14:52:22.487

像这样的东西：

```
select s.sql_id, 
       bc.position, 
       bc.value_string, 
       s.last_load_time, 
       bc.last_captured
from v$sql s
  left join v$sql_bind_capture bc 
         on bc.sql_id = s.sql_id 
        and bc.child_number = s.child_number
where s.sql_text like 'delete from tableA where fk%' -- or any other method to identify the SQL statement
order by s.sql_id, bc.position; 
```

# android - 从 WebView 向上导航到不同的父活动

> ID：14217463
> 
> 赞同：3
> 
> 时间：2013-01-08T14:45:07.447
> 
> 标签：android, android-actionbar, actionbarsherlock

在我的`MainActivity`我有 5 个按钮，其中 4 个打开一个`WebViewActivity`来显示静态 HTML 内容。第 5 个按钮`PumpsActivity`包含另外 5 个按钮，这些按钮也可以打开`WebViewActivity`以显示静态 HTML 页面。

### 现在解决问题：

我希望能够“向上导航”`WebViewActivity`到适当的父活动。例如：如果`WebViewActivity`被调用，则`MainActivity`向上导航应该将用户带到`MainActivity`. [按照android.developer.com](http://developer.android.com/training/implementing-navigation/ancestral.html)上的指南，这很容易实现。但是我如何`WebViewActivity`才能导航到`PumpsActivity`？**如何检查从哪个活动`WebViewActivity`开始？**

我的相关代码（与[指南](http://developer.android.com/training/implementing-navigation/ancestral.html)`WebViewActivity`中的基本相同）：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_web_view);

    getSupportActionBar().setDisplayHomeAsUpEnabled(true);
    Intent intent = getIntent();
    setTitle(intent.getStringExtra("WEBVIEW_TITLE"));

    webview = (WebView) findViewById(R.id.wvMyWebView);
    WebSettings webSettings = webview.getSettings();
    webSettings.setJavaScriptEnabled(true);
    webview.loadUrl(intent.getStringExtra("WEBVIEW_URL"));
}
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            // This is called when the Home (Up) button is pressed
            // in the Action Bar.
            Intent parentActivityIntent = new Intent(this, MainActivity.class);

            parentActivityIntent.addFlags(
                    Intent.FLAG_ACTIVITY_CLEAR_TOP |
                    Intent.FLAG_ACTIVITY_NEW_TASK);
            startActivity(parentActivityIntent);
            finish();
            return true;
    }
    return super.onOptionsItemSelected(item);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:27:04.257

正如 Leonidos 建议的那样，您可以添加一个参数，但这会引入额外的耦合，我觉得父母只有共同的 Activity 超类，并且传递 Activity 类型并不理想。

想到的一种方法是在 WebViewActivity 中有另一个额外的字符串，它指示调用活动。在 onOptionsItemSelected 中，您可以检查父字符串 extra 以查看哪个 Activity 调用了它，并根据需要导航到该 Activity。

# python - 使用已经存在的数据库表发布 django 视图

> ID：14217466
> 
> 赞同：0
> 
> 时间：2013-01-08T14:45:22.033
> 
> 标签：python, django

我有使用 python 编程的经验，但对 Django 很陌生。我最近浏览了本教程并且一切都有意义，但是我想知道是否可以从已经存在的数据库表创建视图而无需创建模型。或者，如果这不可能，有没有办法创建模型来生成带有已经存在的数据库表的 ORM？

基本上我在数据仓库表中有聚合指标，我想实时发布到网页上。Django 是正确的工具吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:49:17.807

用于[`./manage.py inspectdb`](https://docs.djangoproject.com/en/1.4/ref/django-admin/#inspectdb)从现有数据库创建模型。

# clojure - println 集合中的每个元素并返回 TRUE

> ID：14217478
> 
> 赞同：2
> 
> 时间：2013-01-08T14:45:45.217
> 
> 标签：clojure

我是这样做的：

```
(coll? (map #(println (.toString %)) java-objects)) 
```

函数必须返回`TRUE`，这就是为什么这个`coll?`谓词。我想有更好，更优雅的方式吗？

附言。而且这个功能不起作用，因为它是“懒惰的”。您能否推荐一种正确的方法来遍历集合中的所有元素并对每个元素进行处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:56:17.657

[http://clojuredocs.org/clojure_core/clojure.core/doall](http://clojuredocs.org/clojure_core/clojure.core/doall)

```
(doall (map #(println (.toString %)) java-objects)) 
```

它会回报你

```
(nil nil nil ...) 
```

如果你需要真的：

```
(do
    (doall (map #(println (.toString %)) java-objects))
    true) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:18:05.830

如果您不需要表达式的值而只需要副作用，那么最好使用`doseq`而不是`map`：

```
(do (doseq [o java-objects]
      (println (.toString o)))
    true) 
```

`doseq`文档：

```
clojure.core/doseq
([seq-exprs & body])
Macro
  Repeatedly executes body (presumably for side-effects) with
  bindings and filtering as provided by "for".  Does not retain
  the head of the sequence. Returns nil. 
```

# javascript - Javascript日期减法

> ID：14217480
> 
> 赞同：1
> 
> 时间：2013-01-08T14:45:51.580
> 
> 标签：javascript, html, date, datetime

我希望我的代码能够像这样工作，如果我选择一周中的任何日期，它将返回该周前一个星期一的日期。例如：如果我选择 2013 年 1 月 8 日，它将自动返回 2013 年 1 月 7 日。这是我的代码：

```
var dateValue = document.getElementById("OurDate").value; //OurDate is the textbox where I am giving the date as input
var d = new Date(dateValue);
            var newDate = new Date(); ;
            var day = d.getDay();

            if (day == "0")
            newDate.setDate(d.getDate() - 6);
            else if (day == "1")
            newDate = d;
            else if(day=="2")
            newDate.setDate(d.getDate() - 1);
            else if(day=="3")
            newDate.setDate(d.getDate() - 2);
            else if(day=="4")
            newDate.setDate(d.getDate() - 3);
            else if(day=="5")
            newDate.setDate(d.getDate() - 4);
            else if (day == "6")
            newDate.setDate(d.getDate() - 5);

            alert(newDate); 
```

此代码适用于 1 月的任何日期。但是当我在二月或任何其他月份给出任何日期时。它向我显示一月的日期。例如：如果我选择 2013 年 2 月 19 日，它应该返回 2013 年 2 月 18 日，但它会返回 2013 年 1 月 18 日。对这个问题有什么帮助吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:50:29.593

这是因为您正在制作一个新的 Date 对象，而不是使用相同的对象或克隆它：

```
var d = new Date(dateValue);
var newDate = new Date( +d ); // Cloning d 
```

* * *

您可以将整个语句重写为：

```
var date = new Date();
date.setDate( date.getDate() - date.getDay() + 1 );

console.log( date.getDay() ); // 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:52:01.243

问题确实出在这一行：

```
var newDate = new Date(); 
```

通过在它的构造函数中不提供任何值`Date`使用今天的日期。所以你从今天减去。

如果您以相同的方式构建两者`d`，`newDate`它会按预期工作：

```
var d = new Date('2013-02-19');
var newDate = new Date('2013-02-19'); 
```

现场示例：http: [//jsfiddle.net/cS2CC/](http://jsfiddle.net/cS2CC/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:55:17.160

而不是`getDate()`，使用[`getDay()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getDay)：

> 的返回值`getDay`是一个与星期几对应的整数：0 代表星期日，1 代表星期一，2 代表星期二，以此类推。

然后，您可以使用`.setDate()`来设置日期：

```
var date = new Date();
var day = date.getDay();
var days_from_monday = day - 1;

date.setDate(date.getDate() - days_from_monday); 
```

或者更简洁：

```
var date = new Date();
date.setDate(date.getDate() - date.getDay() + 1); 
```

# ios - 什么应该是录制声音并拍摄这样的照片的好方法？

> ID：14217485
> 
> 赞同：-1
> 
> 时间：2013-01-08T14:46:00.373
> 
> 标签：ios, uiimagepickercontroller, avfoundation

我需要制作一个可以录制音频和拍照的示例应用程序。启动 ui 应该很简单：相机预览，一个按钮。

当用户触摸时，应开始录音，并在用户触摸时拍摄图像。

什么应该是最好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:00:20.987

[http://developer.apple.com/：SpeakHere](http://developer.apple.com/) [+](http://developer.apple.com/library/ios/#samplecode/SpeakHere/Introduction/Intro.html#//apple_ref/doc/uid/DTS40007802) PhotoPicker [（](http://developer.apple.com/library/ios/#samplecode/PhotoPicker/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010196) 30 个样本）

# assembly - X86 程序集中的浮点除法给出了奇怪的结果

> ID：14217486
> 
> 赞同：1
> 
> 时间：2013-01-08T14:46:02.517
> 
> 标签：assembly, floating-point, x86, fasm

我目前正在学习[Simply FPU 教程](http://www.ray.masmcode.com/tutorial/index.html)。所以作为自己的练习，我想学习如何在汇编中划分浮点数。假设我要将 48.6 除以 17.1。这是代码。

```
format PE console 4.0
entry main
include 'win32a.inc'

section '.data' data readable writeable
num1 dq 48.6
num2 dq 17.1
result dq ?
fmt db "%g", 10
szBuff db 32 dup (0)

section '.code' code readable executable
main:
fld qword [num1]
fld qword [num2]
fdivp 
fstp qword [result]
invoke printf, fmt, result 
invoke ExitProcess, 0

section '.idata' import data readable
library kernel32,'kernel32.dll', msvcrt,'msvcrt.dll'
import kernel32, ExitProcess,'ExitProcess'
import msvcrt, printf, 'printf' 
```

代码的输出是

> 7.62883e+265

这里出了什么问题？

正如 Jester 所建议的，我使用 OllyDbg 检查了代码

![ollydbg 截图](../Images/0c2b4308d735846cfd350d39873b3159.png)

我猜结果是正确的，但不知何故它被 printf 搞砸了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T14:56:08.980

赞成使用该教程，它非常好:)

那里有几个问题：

*   你的价值观不会`st(0)`，`st(7)`他们会`st(1)`和`st(0)`。寄存器编号是固定的，它总是`st(0)`在顶部，但桶会转动。当您加载某些内容时，它将是`st(0)`. 如果你之后加载其他东西，桶会旋转，你之前拥有的东西将移动到`st(1)`当前值将被放入`st(0)`。
*   确保您的汇编程序生成适当大小的指令，例如用于`fld`和`fst`
*   确保您的`invoke`宏知道如何将浮点参数传递给`printf`
*   你没有清理FPU栈（这里不影响操作，只是一般问题）

我建议您使用调试器单步执行代码，这样您就可以看到正在发生的事情，您甚至不需要尝试使用`printf`.

* * *

**更新**：在 linux 上使用 gdb 和工作代码的示例会话（为清晰起见进行了编辑）：

```
$ cat > div.s
.intel_syntax noprefix
.globl main

.data
num1: .double 48.6
num2: .double 17.1
fmt: .string "%g\n"

.text
main:
    sub esp, 16
    fld qword ptr [num1]    # st(0)=48.6
    fld qword ptr [num2]    # st(0)=17.1, st(1)=48.6
    fdivp                   # st(0)=st(1)/st(0), one item popped
    fstp qword ptr [esp+4]  # store as argument and pop
    mov dword ptr [esp], offset fmt
    call printf
    add esp, 16
    ret
$ gcc -masm=intel -m32 -g div.s -o div
$ ./div
2.84211
$ gdb ./div
GNU gdb (GDB) 7.3.50.20111117-cvs-debian
(gdb) br main
Breakpoint 1 at 0x80483c4: file div.s, line 11.
(gdb) r
Starting program: div 
Breakpoint 1, main () at div.s:11
11          sub esp, 16
(gdb) n
main () at div.s:12
12          fld qword ptr [num1]    # st(0)=48.6
(gdb) 
13          fld qword ptr [num2]    # st(0)=17.1, st(1)=48.6
(gdb) info float
=>R7: Valid   0x4004c266666666666800 +48.60000000000000142      
  R6: Empty   0x00000000000000000000
  R5: Empty   0x00000000000000000000
  R4: Empty   0x00000000000000000000
  R3: Empty   0x00000000000000000000
  R2: Empty   0x00000000000000000000
  R1: Empty   0x00000000000000000000
  R0: Empty   0x00000000000000000000
(gdb) n
14          fdivp                   # st(0)=st(1)/st(0), one item popped
(gdb) info float
  R7: Valid   0x4004c266666666666800 +48.60000000000000142      
=>R6: Valid   0x400388ccccccccccd000 +17.10000000000000142      
  R5: Empty   0x00000000000000000000
  R4: Empty   0x00000000000000000000
  R3: Empty   0x00000000000000000000
  R2: Empty   0x00000000000000000000
  R1: Empty   0x00000000000000000000
  R0: Empty   0x00000000000000000000
(gdb) n
15          fstp qword ptr [esp+4]  # store as argument and pop
(gdb) info float
=>R7: Valid   0x4000b5e50d79435e4e16 +2.842105263157894584      
  R6: Empty   0x400388ccccccccccd000
  R5: Empty   0x00000000000000000000
  R4: Empty   0x00000000000000000000
  R3: Empty   0x00000000000000000000
  R2: Empty   0x00000000000000000000
  R1: Empty   0x00000000000000000000
  R0: Empty   0x00000000000000000000
(gdb) n
16          mov dword ptr [esp], offset fmt
(gdb) info float
  R7: Empty   0x4000b5e50d79435e4e16
  R6: Empty   0x400388ccccccccccd000
  R5: Empty   0x00000000000000000000
  R4: Empty   0x00000000000000000000
  R3: Empty   0x00000000000000000000
  R2: Empty   0x00000000000000000000
  R1: Empty   0x00000000000000000000
=>R0: Empty   0x00000000000000000000 
```

请注意，`gdb`打印接下来要执行的指令。FPU 堆栈顶部由箭头标记，这始终`st(0)`是根据定义。如有必要，其后以递增顺序和环绕顺序紧随其后。第一个转储显示`48.6`正在加载，`st(0)`因为它由箭头标记，其他位置是空的。然后，由于箭头移动了（枪管旋转） ，`17.1`正在重新装入。`st(0)`现在`48.6`是`st(1)`。`FDIVP`执行除法并从堆栈中删除一项，因此我们最终得到结果，`st(0)`其余为空。`FSTP`然后存储`st(0)`as`printf`参数并将其从堆栈中删除，因此所有寄存器现在都是空的。

# jquery - jQuery - Slidetoggle 可以工作，但不能在 Firefox 中使用

> ID：14217489
> 
> 赞同：1
> 
> 时间：2013-01-08T14:46:22.597
> 
> 标签：jquery, slidetoggle

```
<script>
jQuery(document).ready(function($){
$("#panel").click(function(){ 

event.preventDefault();
$("#panel_stats").slideToggle("slow");

});
});
</script> 
```

我可以确认这在**Chrome**和**Safari**中有效，但在**Internet Explorer**和**Firefox**中无效。我已经在某处读到内联 HTML “display:none” 会起作用，但最终它没有。

**删除 event.preventDefault(); 成功了，谢谢大家！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:49:38.523

```
<script>
$(document).ready(function(){
    $("#panel").click(function(){ 
       $("#panel_stats").slideToggle("slow");    
    });
});
</script> 
```

尝试删除`event.preventDefault();`也定义面板到`#panel`或`.panel`

**演示：http:** [//jsfiddle.net/enve/L4nXy/](http://jsfiddle.net/enve/L4nXy/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-08T17:54:33.500

你可以保留`event.preventDefault();`

但是添加`event.stopPropagation();`

然后它将在 Firefox 和所有浏览器中运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T13:03:13.163

尝试使用 .on 的 jQuery ...

```
$("#panel").on('click', function(){ 
       $("#panel_stats").slideToggle("slow");    
}); 
```

问候。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-09T16:34:18.500

我尝试删除 event.preventDefault 但它搞砸了 Chrome 上的行为。

我最终这样做了：

```
 $(function () {
        $('.faqs dd').hide();
        $('.faqs dt')
            .click(function () {
                if (!(navigator.userAgent.toLowerCase().indexOf('firefox') > -1)) {
                    // not firefox
                    event.preventDefault();
                }
                $(this).next().slideToggle('normal');
            });
    }); 
```

# java - Java - 从字符串中检索值，实现 Scanner() 或 Pattern() & Matcher()，或其他

> ID：14217490
> 
> 赞同：0
> 
> 时间：2013-01-08T14:46:26.273
> 
> 标签：java

我有一个`String`：

```
 String message1 = "Request: <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ws="http://ws.me.test.com">
    <soapenv:Header/>
    <soapenv:Body>
       <ws:RequestTypeOne>
          <userId>user_name_one</userId>
       </ws:RequestTypeOne>
    </soapenv:Body>
 </soapenv:Envelope>"; 
```

1）我需要能够提取起始词 - 它可以是*Request*或*Repsonse*，所以我可以存储在另一个中`String`。

2）我需要能够提取标签之间的内容，并将其存储到另一个字符串中。

我已经使用`Scanner()`了`useDelimiter()`，但我不确定如何实现这一点。我也尝试过 pattern() 和 matcher() 但我不确定这是否最适合此要求。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:58:37.717

我为您的请求使用了正则表达式和[http://rubular.com 。](http://rubular.com)

1.  `/^(Request|Response)/`只提取这个词
2.  `/\W<(.*)>/`提取`< >`. 警告：在结果列表中，`< >`不会包含 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:54:28.677

尝试

```
 String type =  message1.substring(0, message1.indexOf(':'));
    String userId = message1.substring(message1.indexOf("<userId>") + 8, message1.indexOf("</userId>")); 
```

# java - 使用 SimpleDateFormat 将字符串转换为日期

> ID：14217491
> 
> 赞同：1
> 
> 时间：2013-01-08T14:46:39.767
> 
> 标签：java, string, date

我想将 a 转换`String`为 a`Date`但出现以下异常：

```
java.text.ParseException: Unparseable date: "Thu Jan 27 14:47:58 CET 2011"
    at java.text.DateFormat.parse(DateFormat.java:335)
    at de.datev.boxi.Main.run(Main.java:36)
    at com.crystaldecisions.sdk.plugin.desktop.program.internal.ProgramWrapper.main(ProgramWrapper.java:174) 
```

我应该使用哪些参数将字符串格式化为日期？

我的程序看起来像：

```
try {
    SimpleDateFormat sdf = new SimpleDateFormat("EEE MMM dd HH:mm:ss z yyyy");
    Date d1 = sdf.parse("Thu Jan 27 14:47:58 CET 2011");
    System.out.println(d1);
} catch (ParseException ex) {
    ex.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:48:32.650

尝试：

```
new SimpleDateFormat("EEE MMM dd HH:mm:ss z yyyy", Locale.ENGLISH); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T14:53:31.447

在 Java 中解析这种“复杂”的时间戳总是很棘手。我也有同样的经历。

Java 在解析您的时区时遇到问题。

甚至更有可能默认语言环境与您的时间字符串不匹配，我建议您将英语语言环境添加到您的通话中：

```
SimpleDateFormat sdf = new SimpleDateFormat("EEE MMM dd HH:mm:ss z yyyy", Locale.ENGLISH); 
```

我总是建议添加此参数，因为根据执行环境，您的应用程序可以在某些机器上运行而在其他机器上失败 - 取决于默认语言环境。

# delphi - 如何检测添加新的串口？

> ID：14217492
> 
> 赞同：7
> 
> 时间：2013-01-08T14:46:41.800
> 
> 标签：delphi, windows-7, serial-port, delphi-xe2

为了与微控制器通信，我使用串行端口。我使用工作正常的 TCommPortDriver 2.1。但是，它缺乏检测新组件的添加或删除的能力。这在会话期间经常发生。

是否有一个事件可以告诉您何时添加或删除了组件？

**更新 1**

我尝试了 RRUZ 的第一个建议，并将其变成了一个独立的程序。它会在`WM_DEVICECHANGE`插入或拔出电缆时做出反应，但`WParam`不会显示设备的到达或移除。结果是：

```
msg = 537, wparam = 7, lparam = 0
msg = 537, wparam = 7, lparam = 0
msg = 537, wparam = 7, lparam = 0 
```

拔出USB线时发送第一条消息，插入时发送第二条消息。消息部分显示`WM_DEVICECHANGE`消息（537）但`WParam`为7，不是`WM_DEVICECHANGE`或`DBT_DEVICEARRIVAL`。我对代码进行了一些修改，以便处理消息，但由于`LParam`为零，这没有用。结果与 VCL 和 FMX 相同。作为检查，请参见下面的代码。

**更新 2**

我现在运行了 WMI 代码。它仅在添加 COM 端口时触发，删除时没有反应。结果：

```
TargetInstance.ClassGuid      : {4d36e978-e325-11ce-bfc1-08002be10318} 
TargetInstance.Description    : Arduino Mega ADK R3 
TargetInstance.Name           : Arduino Mega ADK R3 (COM4) 
TargetInstance.PNPDeviceID    : USB\VID_2341&PID_0044\64935343733351E0E1D1 
TargetInstance.Status         : OK 
```

这是否可以解释在其他代码中这不被视为添加 COM 端口的事实？它似乎将新连接视为 USB 端口（实际上是什么）。Arduino 驱动程序将其转换为 COM 端口，但 WMI 无法识别。Windows 消息“看到”COM 端口更改，但无法检测到它是添加还是删除。

无论如何：设备更改有效。我只需要枚举 COM 端口即可查看实际存在的 COM 端口，这是我已经手动完成的。现在我可以用`WM_DEVICECHANGE`. 我只是向 CPDrv 组件添加一个事件。

感谢 RRUZ 的代码和帮助！

```
 unit dev_change;

  interface

  uses
    Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
    Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls;

  type
    TProc = procedure (text: string) of object;

    BroadcastHdr  = ^DEV_BROADCAST_HDR;
    DEV_BROADCAST_HDR = packed record
      dbch_size: DWORD;
      dbch_devicetype: DWORD;
      dbch_reserved: DWORD;
    end;
    TDevBroadcastHdr = DEV_BROADCAST_HDR;

  type
    PDevBroadcastDeviceInterface  = ^DEV_BROADCAST_DEVICEINTERFACE;
    DEV_BROADCAST_DEVICEINTERFACE = record
      dbcc_size: DWORD;
      dbcc_devicetype: DWORD;
      dbcc_reserved: DWORD;
      dbcc_classguid: TGUID;
      dbcc_name: Char;
    end;
    TDevBroadcastDeviceInterface = DEV_BROADCAST_DEVICEINTERFACE;

  const
    DBT_DEVICESOMETHING        = $0007;
    DBT_DEVICEARRIVAL          = $8000;
    DBT_DEVICEREMOVECOMPLETE   = $8004;
    DBT_DEVTYP_DEVICEINTERFACE = $00000005;

  type
    TDeviceNotifyProc = procedure(Sender: TObject; const DeviceName: String) of Object;
    TDeviceNotifier = class
    private
      hRecipient: HWND;
      FNotificationHandle: Pointer;
      FDeviceArrival: TDeviceNotifyProc;
      FDeviceRemoval: TDeviceNotifyProc;
      FOnWin: TProc;

      procedure WndProc(var Msg: TMessage);

    public
      constructor Create(GUID_DEVINTERFACE : TGUID);
      property OnDeviceArrival: TDeviceNotifyProc read FDeviceArrival write FDeviceArrival;
      property OnDeviceRemoval: TDeviceNotifyProc read FDeviceRemoval write FDeviceRemoval;
      destructor Destroy; override;

      property OnWin: TProc read FOnWin write FOnWin;
    end;

    TForm1 = class(TForm)
      Memo: TMemo;
      procedure FormCreate(Sender: TObject);
      procedure FormDestroy(Sender: TObject);
    private
      { Private declarations }
      DeviceNotifier : TDeviceNotifier;
    public
      { Public declarations }
      procedure arrival(Sender: TObject; const DeviceName: String);
      procedure report (text: string);
    end;

  var
    Form1: TForm1;

  implementation

  {$R *.dfm}

  constructor TDeviceNotifier.Create(GUID_DEVINTERFACE : TGUID);
  var
    NotificationFilter: TDevBroadcastDeviceInterface;
  begin
    inherited Create;
    hRecipient := AllocateHWnd(WndProc);
    ZeroMemory (@NotificationFilter, SizeOf(NotificationFilter));
    NotificationFilter.dbcc_size := SizeOf(NotificationFilter);
    NotificationFilter.dbcc_devicetype := DBT_DEVTYP_DEVICEINTERFACE;
    NotificationFilter.dbcc_classguid  := GUID_DEVINTERFACE;
    //register the device class to monitor
    FNotificationHandle := RegisterDeviceNotification(hRecipient, @NotificationFilter, DEVICE_NOTIFY_WINDOW_HANDLE);
  end;

  procedure TDeviceNotifier.WndProc(var Msg: TMessage);
  var
    Dbi: PDevBroadcastDeviceInterface;
  begin
    OnWin (Format ('msg = %d, wparam = %d, lparam = %d', [msg.Msg, msg.WParam, msg.LParam]));
    with Msg do
    if (Msg = WM_DEVICECHANGE) and ((WParam = DBT_DEVICEARRIVAL) or (WParam = DBT_DEVICEREMOVECOMPLETE) or
                                    (WParam = DBT_DEVICESOMETHING)) then
    try
      Dbi := PDevBroadcastDeviceInterface (LParam);
      if Dbi.dbcc_devicetype = DBT_DEVTYP_DEVICEINTERFACE then
      begin
        if WParam = DBT_DEVICEARRIVAL then
        begin
          if Assigned(FDeviceArrival) then
            FDeviceArrival(Self, PChar(@Dbi.dbcc_name));
        end
        else
        if WParam = DBT_DEVICEREMOVECOMPLETE then
        begin
          if Assigned(FDeviceRemoval) then
            FDeviceRemoval(Self, PChar(@Dbi.dbcc_name));
        end;
      end;
    except
      Result := DefWindowProc(hRecipient, Msg, WParam, LParam);
    end
    else
      Result := DefWindowProc(hRecipient, Msg, WParam, LParam);
  end;

  destructor TDeviceNotifier.Destroy;
  begin
    UnregisterDeviceNotification(FNotificationHandle);
    DeallocateHWnd(hRecipient);
    inherited;
  end;

  procedure TForm1.arrival(Sender: TObject; const DeviceName: String);
  begin
     report (DeviceName);

     ShowMessage(DeviceName);
  end;

  procedure TForm1.FormCreate(Sender: TObject);
  const
    GUID_DEVINTERFACE_COMPORT  : TGUID = '{86E0D1E0-8089-11D0-9CE4-08003E301F73}';
  begin
    DeviceNotifier:=TDeviceNotifier.Create(GUID_DEVINTERFACE_COMPORT);
    DeviceNotifier.FDeviceArrival:=arrival;
    DeviceNotifier.OnWin := report;
  end;

  procedure TForm1.FormDestroy(Sender: TObject);
  begin
    DeviceNotifier.Free;
  end;

  procedure TForm1.report (text: string);
  begin
     Memo.Lines.Add (text);
  end;

  end. 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-08T15:52:16.847

您可以使用[`RegisterDeviceNotification`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363431%28v=vs.85%29.aspx)WinAPI 函数将[`DEV_BROADCAST_DEVICEINTERFACE`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363244%28v=vs.85%29.aspx)结构与[`GUID_DEVINTERFACE_COMPORT`](http://msdn.microsoft.com/en-us/library/windows/hardware/ff545821%28v=vs.85%29.aspx)设备接口类一起传递。

试试这个样本。

```
type
  PDevBroadcastHdr  = ^DEV_BROADCAST_HDR;
  DEV_BROADCAST_HDR = packed record
    dbch_size: DWORD;
    dbch_devicetype: DWORD;
    dbch_reserved: DWORD;
  end;
  TDevBroadcastHdr = DEV_BROADCAST_HDR;

type
  PDevBroadcastDeviceInterface  = ^DEV_BROADCAST_DEVICEINTERFACE;
  DEV_BROADCAST_DEVICEINTERFACE = record
    dbcc_size: DWORD;
    dbcc_devicetype: DWORD;
    dbcc_reserved: DWORD;
    dbcc_classguid: TGUID;
    dbcc_name: Char;
  end;
  TDevBroadcastDeviceInterface = DEV_BROADCAST_DEVICEINTERFACE;

const
  DBT_DEVICEARRIVAL          = $8000;
  DBT_DEVICEREMOVECOMPLETE   = $8004;
  DBT_DEVTYP_DEVICEINTERFACE = $00000005;

type
  TDeviceNotifyProc = procedure(Sender: TObject; const DeviceName: String) of Object;
  TDeviceNotifier = class
  private
    hRecipient: HWND;
    FNotificationHandle: Pointer;
    FDeviceArrival: TDeviceNotifyProc;
    FDeviceRemoval: TDeviceNotifyProc;
    procedure WndProc(var Msg: TMessage);
  public
    constructor Create(GUID_DEVINTERFACE : TGUID);
    property OnDeviceArrival: TDeviceNotifyProc read FDeviceArrival write FDeviceArrival;
    property OnDeviceRemoval: TDeviceNotifyProc read FDeviceRemoval write FDeviceRemoval;
    destructor Destroy; override;
  end;

type
  TForm17 = class(TForm)
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
  private
    { Private declarations }
    DeviceNotifier : TDeviceNotifier;
  public
    { Public declarations }
    procedure arrival(Sender: TObject; const DeviceName: String);
  end;

var
  Form17: TForm17;

implementation

{$R *.dfm}

constructor TDeviceNotifier.Create(GUID_DEVINTERFACE : TGUID);
var
  NotificationFilter: TDevBroadcastDeviceInterface;
begin
  inherited Create;
  hRecipient := AllocateHWnd(WndProc);
  ZeroMemory(@NotificationFilter, SizeOf(NotificationFilter));
  NotificationFilter.dbcc_size := SizeOf(NotificationFilter);
  NotificationFilter.dbcc_devicetype := DBT_DEVTYP_DEVICEINTERFACE;
  NotificationFilter.dbcc_classguid  := GUID_DEVINTERFACE;
  //register the device class to monitor
  FNotificationHandle := RegisterDeviceNotification(hRecipient, @NotificationFilter, DEVICE_NOTIFY_WINDOW_HANDLE);
end;

procedure TDeviceNotifier.WndProc(var Msg: TMessage);
var
  Dbi: PDevBroadcastDeviceInterface;
begin
  with Msg do
  if (Msg = WM_DEVICECHANGE) and ((WParam = DBT_DEVICEARRIVAL) or (WParam = DBT_DEVICEREMOVECOMPLETE)) then
  try
    Dbi := PDevBroadcastDeviceInterface(LParam);
    if Dbi.dbcc_devicetype = DBT_DEVTYP_DEVICEINTERFACE then
    begin
      if WParam = DBT_DEVICEARRIVAL then
      begin
        if Assigned(FDeviceArrival) then
          FDeviceArrival(Self, PChar(@Dbi.dbcc_name));
      end
      else
      if WParam = DBT_DEVICEREMOVECOMPLETE then
      begin
        if Assigned(FDeviceRemoval) then
          FDeviceRemoval(Self, PChar(@Dbi.dbcc_name));
      end;
    end;
  except
    Result := DefWindowProc(hRecipient, Msg, WParam, LParam);
  end
  else
    Result := DefWindowProc(hRecipient, Msg, WParam, LParam);
end;

destructor TDeviceNotifier.Destroy;
begin
  UnregisterDeviceNotification(FNotificationHandle);
  DeallocateHWnd(hRecipient);
  inherited;
end;

procedure TForm17.arrival(Sender: TObject; const DeviceName: String);
begin
  ShowMessage(DeviceName);
end;

procedure TForm17.FormCreate(Sender: TObject);
const
  GUID_DEVINTERFACE_COMPORT  : TGUID = '{86E0D1E0-8089-11D0-9CE4-08003E301F73}';
begin      
  DeviceNotifier:=TDeviceNotifier.Create(GUID_DEVINTERFACE_COMPORT);
  DeviceNotifier.FDeviceArrival:=arrival;
end;

procedure TForm17.FormDestroy(Sender: TObject);
begin
  DeviceNotifier.Free;
end;

end. 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-08T16:09:26.097

另一种选择是使用 WMI 事件，在这种情况下使用`__InstanceCreationEvent`事件和[`Win32_PnPEntity`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394353%28v=vs.85%29.aspx)WMI 类，您可以过滤使用[`{4d36e978-e325-11ce-bfc1-08002be10318}`](http://msdn.microsoft.com/en-us/library/windows/hardware/ff553426%28v=vs.85%29.aspx)类 GUID 添加的串行端口，像这样写一个 WQL 语句

```
Select * From __InstanceCreationEvent Within 1 Where TargetInstance ISA "Win32_PnPEntity" AND TargetInstance.ClassGuid="{4d36e978-e325-11ce-bfc1-08002be10318}" 
```

试试这个样本

```
{$APPTYPE CONSOLE}

{$R *.res}

uses
  Windows,
  {$IF CompilerVersion > 18.5}
  Forms,
  {$IFEND}
  SysUtils,
  ActiveX,
  ComObj,
  WbemScripting_TLB;

type
  TWmiAsyncEvent = class
  private
    FWQL      : string;
    FSink     : TSWbemSink;
    FLocator  : ISWbemLocator;
    FServices : ISWbemServices;
    procedure EventReceived(ASender: TObject; const objWbemObject: ISWbemObject; const objWbemAsyncContext: ISWbemNamedValueSet);
  public
    procedure  Start;
    constructor Create;
    Destructor Destroy;override;
  end;

//Detect when a key was pressed in the console window
function KeyPressed:Boolean;
var
  lpNumberOfEvents     : DWORD;
  lpBuffer             : TInputRecord;
  lpNumberOfEventsRead : DWORD;
  nStdHandle           : THandle;
begin
  Result:=false;
  nStdHandle := GetStdHandle(STD_INPUT_HANDLE);
  lpNumberOfEvents:=0;
  GetNumberOfConsoleInputEvents(nStdHandle,lpNumberOfEvents);
  if lpNumberOfEvents<> 0 then
  begin
    PeekConsoleInput(nStdHandle,lpBuffer,1,lpNumberOfEventsRead);
    if lpNumberOfEventsRead <> 0 then
    begin
      if lpBuffer.EventType = KEY_EVENT then
      begin
        if lpBuffer.Event.KeyEvent.bKeyDown then
          Result:=true
        else
          FlushConsoleInputBuffer(nStdHandle);
      end
      else
      FlushConsoleInputBuffer(nStdHandle);
    end;
  end;
end;

{ TWmiAsyncEvent }

constructor TWmiAsyncEvent.Create;
const
  strServer    ='.';
  strNamespace ='root\CIMV2';
  strUser      ='';
  strPassword  ='';
begin
  inherited Create;
  CoInitializeEx(nil, COINIT_MULTITHREADED);
  FLocator  := CoSWbemLocator.Create;
  FServices := FLocator.ConnectServer(strServer, strNamespace, strUser, strPassword, '', '', wbemConnectFlagUseMaxWait, nil);
  FSink     := TSWbemSink.Create(nil);
  FSink.OnObjectReady := EventReceived;
  FWQL:='Select * From __InstanceCreationEvent Within 1 '+
        'Where TargetInstance ISA "Win32_PnPEntity" AND TargetInstance.ClassGuid="{4d36e978-e325-11ce-bfc1-08002be10318}" ';

end;

destructor TWmiAsyncEvent.Destroy;
begin
  if FSink<>nil then
    FSink.Cancel;
  FLocator  :=nil;
  FServices :=nil;
  FSink     :=nil;
  CoUninitialize;
  inherited;
end;

procedure TWmiAsyncEvent.EventReceived(ASender: TObject;
  const objWbemObject: ISWbemObject;
  const objWbemAsyncContext: ISWbemNamedValueSet);
var
  PropVal: OLEVariant;
begin
  PropVal := objWbemObject;
  Writeln(Format('TargetInstance.ClassGuid      : %s ',[String(PropVal.TargetInstance.ClassGuid)]));
  Writeln(Format('TargetInstance.Description    : %s ',[String(PropVal.TargetInstance.Description)]));
  Writeln(Format('TargetInstance.Name           : %s ',[String(PropVal.TargetInstance.Name)]));
  Writeln(Format('TargetInstance.PNPDeviceID    : %s ',[String(PropVal.TargetInstance.PNPDeviceID)]));
  Writeln(Format('TargetInstance.Status         : %s ',[String(PropVal.TargetInstance.Status)]));
end;

procedure TWmiAsyncEvent.Start;
begin
  Writeln('Listening events...Press Any key to exit');
  FServices.ExecNotificationQueryAsync(FSink.DefaultInterface,FWQL,'WQL', 0, nil, nil);
end;

var
   AsyncEvent : TWmiAsyncEvent;
begin
 try
    AsyncEvent:=TWmiAsyncEvent.Create;
    try
      AsyncEvent.Start;
      //The next loop is only necessary in this sample console sample app
      //In VCL forms Apps you don't need use a loop
      while not KeyPressed do
      begin
          {$IF CompilerVersion > 18.5}
          Sleep(100);
          Application.ProcessMessages;
          {$IFEND}
      end;
    finally
      AsyncEvent.Free;
    end;
 except
    on E:EOleException do
        Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode]));
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
end. 
```

# css - 使用 Backbone.Marionette 区域时未正确应用 CSS

> ID：14217499
> 
> 赞同：0
> 
> 时间：2013-01-08T14:47:11.930
> 
> 标签：css, backbone.js, marionette, backbone-views

我是 Backbone.Marionette 的新手，现在我正在使用这个框架开发我的第一个应用程序。

我现在正在苦苦挣扎的问题：当我在视图中使用区域时，css 没有正确应用。更具体地说：我有一个 CompositeView 渲染带有图片的滑块（使用环形交叉口 jQuery 插件）。一切都很好，直到我尝试将它与区域一起使用。

我在我的应用程序中添加了一个区域`{ sliderContainer: "#sliderContainer"}`，然后调用`show(view)`它。现在它没有正确呈现（我猜，`id="greatSlider"`没有应用在根视图 div 元素上定义的样式）。我认为问题出在我为区域添加的额外 div 中，但是在我删除了该区域并将 sliderContainer 作为我的视图的一个 el 并将 greatSlider 移动到模板之后，我又让一切正常。任何想法如何处理这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:27:13.537

我在选择器中的错误是否不再存在区域问题。

# python - 从具有匹配属性的字典列表中删除项目

> ID：14217501
> 
> 赞同：0
> 
> 时间：2013-01-08T14:47:16.600
> 
> 标签：python, list, dictionary

例如，我有一个字典列表：

```
data = [
    { 'id': 1 },
    { 'id': 2 },
    { 'id': 3 },
    { 'id': 4 },
    { 'id': 5 },
]

remove_ids = [3,4] 
```

所以我想申请`remove_ids`并`list`最终得到：

```
list = [
    { 'id': 1 },
    { 'id': 2 },
    { 'id': 5 },
] 
```

我在想一些事情：

```
data.remove([item (if item['id'] in remove_ids) for k, item in data]) 
```

显然这不起作用，但我很想知道我是否接近。我也有兴趣看看这是否可能在一行中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:50:00.510

```
new_data=[x for x in data if x['id'] not in remove_ids] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T14:50:01.273

```
data = [d for d in data if d['id'] not in remove_ids] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T14:51:17.620

你可以使用`filter`.

```
remove_ids = (3, 4)
filtered_data = filter(lambda item: item['id'] not in remove_ids, data) 
```

如果`data`很大或者您经常这样做，您也可能会从`itertools`.

```
from itertools import ifilterfalse
remove_ids = (3, 4)
filtered_data = tuple(ifilterfalse(lambda item: item['id'] in remove_ids, data)) 
```

# mysql - MySQL查询加权投票 - 如何计算分配给不同列的值

> ID：14217506
> 
> 赞同：1
> 
> 时间：2013-01-08T14:47:28.817
> 
> 标签：mysql

我有一个将值写入 mysql 数据库表的投票应用程序。这是一个偏好/加权投票系统，因此人们选择第一个选项、第二个选项和第三个选项。这些都进入表中的单独字段。我正在寻找一种编写查询的方法，该查询将为响应分配数值（第一个响应为 3，第二个响应为 2，第一个响应为 1），然后显示带有总分的值。我已经能够为总票数做到这一点

```
select count(name) as votes,name 
from (select 1st_option as name from votes 
      union all 
      select 2nd_option from votes 
      union all 
      select 3rd_option from votes) as tbl 
group by name 
having count(name) > 0 
order by 1 desc; 
```

但还没有完全弄清楚如何为每一列中的响应分配值，然后将它们拉到一起。任何帮助深表感谢。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:55:31.713

你可以这样做：

```
select sum(score) as votes,name 
from (select 1st_option as name, 3 as score from votes 
      union all 
      select 2nd_option as name, 2 as score from votes 
      union all 
      select 3rd_option as name, 1 as score from votes) as tbl 
group by name; 
```

# performance - 使用 Symfony 2 加载页面时的 CPU 问题

> ID：14217510
> 
> 赞同：0
> 
> 时间：2013-01-08T14:47:30.967
> 
> 标签：performance, symfony, cpu

我在这里发帖是因为我在 Symfony2 项目中遇到了一个非常无聊的问题。(v.2.1.5) 几天以来，我的整个网站变得非常缓慢，每个页面（包括最简单的页面）都需要大约 4 或 5 秒才能加载。

显然，我在不同的服务器上尝试了我的项目，使用 Windows（WAMP 和 XAMPP 服务器）和 Debian 服务器（使用 PHP 5.3.9）。

在所有这些服务器上，我都遇到了同样的问题：页面非常慢，加载时 CPU 过度使用。我在开发模式下检查了 CPU，没有和在清理缓存之后。每次，CPU 看起来都被大量用于这些任务。

我还拍了一些截图来解释我的问题。

* * *

Symfony2 分析器：http: [//intuitiv.nanakii.fr/upload/profiler.jpg](http://intuitiv.nanakii.fr/upload/profiler.jpg)

CPU使用率 ：

清理缓存后在开发模式下：http: [//intuitiv.nanakii.fr/upload/318-dev-nocache.PNG](http://intuitiv.nanakii.fr/upload/318-dev-nocache.PNG)

在带有缓存的开发模式下：http: [//intuitiv.nanakii.fr/upload/318-dev-cache.PNG](http://intuitiv.nanakii.fr/upload/318-dev-cache.PNG)

没有开发模式，清理缓存后：http: [//intuitiv.nanakii.fr/upload/318-prod-nocache.PNG](http://intuitiv.nanakii.fr/upload/318-prod-nocache.PNG)

没有开发模式，有缓存：http: [//intuitiv.nanakii.fr/upload/318-prod-cache.PNG](http://intuitiv.nanakii.fr/upload/318-prod-cache.PNG)

* * *

所有 CPU 屏幕截图都显示了我系统上的 CPU 使用率，同时在网站上加载了一页。

我知道我的问题不是很准确，并且我知道要帮助我获得这些信息并不容易。

但是，我真的不知道在哪里调查来解决这个问题。所以，每一个想法都是有用的。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:59:53.820

和我的 profiler 相比，一切都很长，尤其是请求（加载 + 防火墙）

你经常使用 Twig 的渲染标签吗？众所周知，它会[减慢一切](https://stackoverflow.com/questions/9862585/symfony2-and-twig-render-performance-issues)。

# mysql - 数据库设计 - 有什么方法可以避免在这里重复列？

> ID：14217512
> 
> 赞同：2
> 
> 时间：2013-01-08T14:47:32.777
> 
> 标签：mysql, database

我有一个数据库，将哈希值和一些关于哈希的数据存储在一个表中。其中一个字段是“job_id”，它是哈希来自的作业的 ID。

我要解决的问题是，在这种设计中，哈希只能属于一个作业——实际上，哈希可以出现在许多作业中，我想知道每个作业中都会出现哈希。

我正在考虑这样做的方式是创建一个名为“Jobs”的新表，其中包含“job_id”、“job_name”和“hash_value”字段。当一批新数据插入数据库时​​，作业 ID 和名称将在此处创建，每个哈希将与原始哈希表一样进入此处，但在作业表中，它也将针对作业存储.

我不喜欢这样，因为我会跨表复制哈希列。有没有更好的办法？我可以添加到哈希表中，但不能删除任何列，因为闭源软件依赖于它。哈希值是主键。它是 MySQL，数据库存储了数百万条记录。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:40:40.337

> 我要解决的问题是，在这种设计中，哈希只能属于一个作业——实际上，哈希可以出现在许多作业中，我想知道每个作业中都会出现哈希。
> 
> 我正在考虑这样做的方式是创建一个名为“Jobs”的新表，其中包含“job_id”、“job_name”和“hash_value”字段。

只要您*还*可以获得a）正确的外键和b）“job_id”和“hash_value”的级联正确，那应该没问题。

*重复数据*和*冗余数据*是关系建模中的技术术语。*技术术语* 意味着它们具有您在字典中不太可能找到的含义。它们并不意味着“相同的值出现在多个表中”。这*应该*很明显，因为如果您将这些值替换为代理 ID 号，那么这些 ID 号将出现在多个表中。

这些技术术语实际上意味着“具有相同含义的相同值”。（相关：[Hugh Darwen](http://www.dcs.warwick.ac.uk/~hugh/TTM/The-Relational-Model.pdf)关于谓词的定义和使用的文章。）

用 ID 号替换文本可能有很好的实际原因，但没有理论上的理由这样做，规范化当然不需要它。（没有“每一行都有一个 ID 号”范式。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:42:11.737

添加新`job`表是要走的路。这是代表一对多关系的规范做法。

避免不必要的重复值是很好的。但是在这种情况下，您并没有真正“复制”该`hash_value`列。相反，您实际上是在定义与作为主键`job`的表之间的关系。`hash_value`

关系是通过给子表增加一列来实现的；该列包含父表中的主键值。通常，我们也会在列上添加 FOREIGN KEY 约束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:41:00.510

如果我正确阅读了您的问题，那么由于以下两个事实，您的设计存在根本缺陷：

*   哈希是主键（引自您的问题）
*   可以从多个不同的输入生成相同的哈希（事实）
*   你有数百万个哈希（来自问题）

使用数百万行/散列，最终您会遇到散列冲突。

唯一明智的方法是将 job_id 作为主键并在具有非唯一索引的列中散列。给定哈希查找工作将很简单。

# struts2 - 从 2.2.1.1 升级到 2.3.8 后的 Struts 2 堆栈跟踪

> ID：14217515
> 
> 赞同：0
> 
> 时间：2013-01-08T14:47:46.030
> 
> 标签：struts2

这对我来说是个谜，任何人都可以在这里阐明可能的原因吗？

```
java.lang.NullPointerException 
    com.opensymphony.xwork2.validator.AnnotationValidationConfigurationBuilder.processVisitorFieldValidatorAnnotation(AnnotationValidationConfigurationBuilder.java:485)
    com.opensymphony.xwork2.validator.AnnotationValidationConfigurationBuilder.processAnnotations(AnnotationValidationConfigurationBuilder.java:208)
    com.opensymphony.xwork2.validator.AnnotationValidationConfigurationBuilder.buildAnnotationClassValidatorConfigs(AnnotationValidationConfigurationBuilder.java:781)
    com.opensymphony.xwork2.validator.AnnotationActionValidatorManager.buildClassValidatorConfigs(AnnotationActionValidatorManager.java:283)
    com.opensymphony.xwork2.validator.AnnotationActionValidatorManager.buildValidatorConfigs(AnnotationActionValidatorManager.java:371)
    com.opensymphony.xwork2.validator.AnnotationActionValidatorManager.getValidators(AnnotationActionValidatorManager.java:102)
    com.opensymphony.xwork2.validator.AnnotationActionValidatorManager.validate(AnnotationActionValidatorManager.java:141)
    com.opensymphony.xwork2.validator.AnnotationActionValidatorManager.validate(AnnotationActionValidatorManager.java:133)
    com.opensymphony.xwork2.validator.AnnotationActionValidatorManager.validate(AnnotationActionValidatorManager.java:128) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:52:46.157

或者也许是的:)

我发现了这个答案

[Struts 2 Validation w/ annotations 获得空异常](https://stackoverflow.com/questions/4652195/struts-2-validation-w-annotations-getting-a-null-exception)

它没有提到版本，但根据发布日期和答案的日期，它可能是同一个问题。

查看提供的解决方案（指定基本 Validators.xml 中的所有内容）并查看它是否有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T14:25:05.997

看起来 validators.xml 的 DOCTYPE 已更改。更新 URL-reference 修复了它。

# java - 哪个更有效：原子地修改数组或同步访问它？

> ID：14217518
> 
> 赞同：1
> 
> 时间：2013-01-08T14:47:52.427
> 
> 标签：java, performance, synchronization, atomic

考虑这两个代码示例：

```
private final Player[] players = new Player[MAX_PLAYERS + 1];
private int playerCount;

public boolean addPlayer(Player player) {
    synchronized (players) {
        for (int i = 1; i < players.length; i++) {
            if (players[i] == null) {
                players[i] = player;
                playerCount++;
                player.setIndex(i);
                return true;
            }
        }
        return false;
    }
}

public void removePlayer(Player player) {
    synchronized (players) {
        players[player.getIndex()] = null;
        playerCount--;
    }
}

public Player[] getPlayers() {
    synchronized (players) {
        return players;
    }
}

public int getPlayerCount() {
    synchronized (players) {
        return playerCount;
    }
} 
```

和...

```
private final AtomicReferenceArray<Player> players = new AtomicReferenceArray<Player>(MAX_PLAYERS + 1);
private final AtomicInteger playerCount = new AtomicInteger();

public boolean addPlayer(Player player) {
    for (int i = 1; i < players.length(); i++) {
        if (players.get(i) == null) {
            players.set(i, player);
            playerCount.incrementAndGet();
            player.setIndex(i);
            return true;
        }
    }
    return false;
}

public void removePlayer(Player player) {
    players.set(player.getIndex(), null);
    playerCount.decrementAndGet();
}

public AtomicReferenceArray<Player> getPlayers() {
    return players;
}

public AtomicInteger getPlayerCount() {
    return playerCount;
} 
```

现在，我知道通常访问数组是非常有效的。但是，我知道同步可能代价高昂。另一方面，原子操作不需要同步，但我猜这`players.get(i)`不如`players[i]`. 那么，如果我在游戏环境中使用这些样本中的哪一个会给我最好的性能呢？我设计了服务器，以便每个新玩家都有一个专用于他们的线程。每次他们完成连接和登录后，他们都会通过 将自己添加到玩家列表中`addPlayer(Player)`。当玩家断开连接时，他们会通过 将自己从玩家列表中删除`removePlayer(Player)`。由于这些操作是从不同的线程调用的，因此肯定需要同步。那么我应该使用哪个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:51:42.083

这些关于 SO 的大多数问题都可以用“你测量过吗”来回答，并且可能非常依赖于你的环境。但是，无论您选择什么解决方案：

> 每次他们完成连接和登录时，他们都会通过 addPlayer(Player) 将自己添加到玩家列表中

通过网络连接/登录等的成本将使您担心的任何效率都相形见绌*。*

这个断言：

> 但是，我知道同步可能代价高昂

以前比较担心。如今的同步成本大大降低。

对于上述情况，我真的不会担心。让您的解决方案发挥作用，然后确定上述是否足够低效以保证返工。我在上面看到的很少有性能相关引起我的关注。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:09:51.183

这是最简单的写法

```
private final List<Player> players = new CopyOnWriteArrayList(); // thread safe

public boolean addPlayer(Player player) {
    return players.add(player);
}

public void removePlayer(Player player) {
    players.remove(player);
}

public List<Player> getPlayers() {
    return players;
}

public int getPlayerCount() {
    return players.size();
} 
```

注意：这不起作用

```
public Player[] getPlayers() {
    synchronized (players) {
        return players;
    }
} 
```

因为您将无法以安全的方式使用返回的数组。鉴于您只访问最终字段，同步不会做任何事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:54:38.887

只有选项 1 是线程安全的。

选项 2`player[i]`以非线程安全的方式检查是否为 null。

# html - Firefox 100% 宽度过度扩展父 Div

> ID：14217524
> 
> 赞同：3
> 
> 时间：2013-01-08T14:48:03.867
> 
> 标签：html, css, firefox, width

我有两个文本框，一个 1 像素的 div 包含在一个 div 中。父 div 具有自动高度，宽度为 100%。

毕竟还有另一个 div 是 100% 的宽度和高度，这个 div 在 Webkit 中正确显示，但它过度扩展了父 div 的边框大约 2-3 px。

这是所有相关代码，我已将其缩小到仅这些，并且我通过将背景涂成红色来检查 Firefox 中的父 div 宽度和高度，并且当我这样做时它不会扩展（红色）。

我似乎记得读过一些关于必须告诉 Firefox 或 Webkit 等...如何定义宽度的内容，但我不记得 CSS 了，我花了大约 45 分钟谷歌搜索所有我能找到的东西。

**HTML**

```
 <!-- CREDENTIALS -->
            <div class="centreLoginForm-Credentials">

                <div id="disabledDiv"></div>

                <input id="usernameCred" class="textInput top" type="text" placeholder="Username">
                <!--<div class="dividerDiv textBoxGrey"></div>-->
                <input id="passwordCred" class="textInput bottom" type="password" placeholder="Password">

            </div>
            <!-- CREDENTIALS END --> 
```

**CSS**

```
.centreLoginForm-Credentials
{
    width: 100%;
    height: auto;

    position: relative;

    margin-top: 10px;

    display: table;

    background-color: rgb(255, 255, 255);

    box-shadow: 0px 0px 3px rgba(200, 200, 200, 0.3);

    border-radius: 3px; 
    border: 1px solid rgba(230, 230, 230, 1);
}

#disabledDiv
{
    position: absolute;

    /*z-index: -10;*/

    width: 100%;
    height: 100%;

    box-shadow: inset 0px 0px 30px rgba(220, 220, 220, 1);  
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T14:53:19.870

The 100% width does not include padding and/or borders. If you want to include these try this css:

```
box-sizing:border-box;
-moz-box-sizing:border-box;
-webkit-box-sizing:border-box 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T15:01:15.403

是的，正如威廉所说，添加了填充和边框。

正如你所说，`display: table`对于这个 div 来说是一个奇怪的选择。

但`display: block`仅设置是不够的，您还应该删除水平边框：

[http://jsfiddle.net/Ks4Ur/](http://jsfiddle.net/Ks4Ur/)

```
display: block;
border-left: none;
border-right: none; 
```

编辑：为让我发笑的 AsciiArt 昵称 +1 :)

# doctrine-orm - 用于回车/换行的表单文本区域行为

> ID：14217525
> 
> 赞同：3
> 
> 时间：2013-01-08T14:48:04.127
> 
> 标签：doctrine-orm, newline, symfony-2.1, carriage-return, postgresql-8.4

我正在开发一个带有 symfony2、教义 2 和奏鸣曲管理包的项目。

当我在 textarea 中编辑实体的字段时，它会使用 \r 回车将其保存在 postgres 数据库中。这对我来说是个问题，因为我将此字段与 java 小程序一起使用，并且格式必须正确。

这是一个让我满意的例子：

```
 -ISIS-  02210509232D

  42 45  0  0  0  0  0  0  0  0  0
     1.6288   -9.1522   -0.6175 O   0  0  0  0  0  0  0  0  0
    -0.0179    1.3546    0.0193 O   0  0  0  0  0  0  0  0  0
     0.4111   -6.3640    1.1717 C   0  0  0  0  0  0  0  0  0
     1.3655   -6.8310    0.0373 C   0  0  0  0  0  0  0  0  0 
```

这是我在编辑另一个字段时得到的：

```
Mrv0541 01081315253D          \r
 \r
   9  8  0  0  0  0            999 V2000\r
    -0.0166    1.3706    0.0096 N   0  0  0  0  0  0  0  0  0  0  0  0\r
    -1.1791   -0.7076    0.0095 N   0  0  0  0  0  0  0  0  0  0  0  0\r
     1.1396   -0.6403   -0.0123 N   0  0  0  0  0  0  0  0  0  0  0  0\r 
```

我如何确定我在 textarea 中编辑的字段格式正确？（我不想要这些\r）

**编辑：**

我在表单页面上检查了javascript，文本中根本没有回车。我禁用了表单中字段的修剪。

**我在哪里可以检查是否是 symfony2 或教义 2 在使用回车符代替换行符保存此实体字段时起作用？**

# php - 显示每个客户的未结订单数量

> ID：14217526
> 
> 赞同：0
> 
> 时间：2013-01-08T14:48:08.027
> 
> 标签：php, mysql

我在一段无法找到解决方案的代码上停留了一段时间。尝试了一大堆选项，但似乎都不起作用。

我和我所有的顾客都有一张桌子。它显示了他们的姓名、邮政编码等。但我也想在同一张表中显示未结订单的数量。

我得到了这些表mysql表：

表格1

表名：客户

列：customer_ID、postcode、customer_since、customer_name

表 2

表名：状态

列：status_ID、status_name

表3

表名：订单

列：order_ID、customer_ID、status_ID

到目前为止，这是我的代码：

```
$sql = mysql_query ("SELECT customer.customer_ID, customer.postcode, customer.since, customer.name
FROM customer
ORDER BY customer.customer_ID desc  ");

echo '<table border="0" width="515"  >
      <tr>
    <td>
       <table cellspacing="0" cellpadding="0" border="0" width="515" id="table1" >
         <tr>
            <th width="60" align="center"><span class="tabledescription">Number:</span></td> //customernumber
        <th width="155" align="center"><span class="tabledescription">Name:</span></td> //customername
        <th width="100" align="center"><span class="tabledescription">Postcode:</span></td>//customerpostcode
        <th width="100" align="center"><span class="tabledescription">Orders open:</span></td>//amount of open orders
        <th width="100" align="center"><span class="tabledescription">Since:</span></td>//customer since
         </tr>
       </table>
    </td>
  </tr>
  <tr>
    <td>
       <div style="width:565px; height:322px; overflow:auto;">
         <table id="table1" cellspacing="0" cellpadding="0" border="0" width="575" >';

while($row = mysql_fetch_array($sql, MYSQL_ASSOC))
{
$id = $row['customer_ID'];
$name= $row['name'];
$postcode = $row['postcode'];
$status = $row['status'];
$since = $row['customer_since'];
$probleem = $row['probleem'];

$csince = date('d-m-Y', $since);

echo "<tr><td width=64><a style=' color: #009bce; text-decoration: none;' href='detailvieuwcustomer.php?id=".$id."'>".$id."</a></td>
        <td width=160>$name</td>
        <td width=105>$postcode</td>
        <td width=105>amount</td>
        <td width=105>$csince</td></tr>";

        }
echo ' </table>  
       </div>
    </td>
  </tr>
</table>'; 
```

到目前为止，这正在工作并展示我的 8 位客户。每个订单我有 7 种不同的状态类型。最后一个是它已交付，因此一个未打开。我做了这个代码：

```
$statusnumber = 7;

$sql1 = mysql_query("SELECT * FROM order WHERE customer_ID = '". $id . " ' AND status_ID != '". $statusnumber . "' ");

while($prow = mysql_fetch_array($sql1, MYSQL_ASSOC))
{

$openstatus = $prow['storing_ID'];

echo $openstatus; 
```

这个向我展示了每个没有 status_ID 7 的订单。

现在我不知道如何计算 status_ID 为 1 - 6 的订单数量，并将未结订单数量放在正确客户后面的表格中。

我也尝试加入表格：

```
$sql = mysql_query("SELECT status.status_ID, order.status_ID, order.customer_ID, customer.customer_ID, customer.name, customer.postcode, customer.since
        FROM order
        INNER JOIN status on (status.status_ID = order.status_ID)
        INNER JOIN customer on (customer.customer_ID = order.customer_customer_ID)
        ORDER BY customer.customer_ID desc "); 
```

但是当我这样做时，它会多次向我展示我的所有客户，因为他从订单中获取 customer_ID，而我收到了大约 30 个订单。它给了我这样的结果：1,1,1,1,2,2,2,3,4,4,5,5,5,5 等。

我似乎无法用他们打开的正确数量的订单向所有客户显示 1 次..

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:10:20.540

有几种方法。

一种是对`order`表进行 OUTER JOIN。这里的技巧是 customer_ID 上的 GROUP BY，并检查`status_ID`列以返回 0 或 1，然后使用 SUM 组聚合函数将 0 和 1 相加：

```
 SELECT c.customer_ID
      , c.postcode
      , c.since
      , c.name
      , SUM(IF(s.status_ID != 7,1,0)) AS open_order_count
  FROM customer c
  LEFT
  JOIN order o
    ON o.customer_ID = c.customer_ID
  LEFT
  JOIN status s
    ON s.status_ID = o.status_ID
 GROUP
    BY c.customer_ID
     , c.postcode
     , c.since
     , c.name
 ORDER
    BY c.customer_ID DESC 
```

注意：我们可以使用`COUNT`聚合来代替`SUM`，但我们需要为那些我们不想计算的行返回一个 NULL ......

```
 , COUNT(IF(s.status_ID != 7,1,NULL)) AS open_order_count 
```

* * *

另一种方法（通常在大型集合上性能较差）是在 SELECT 列表中使用相关子查询：

```
 SELECT c.customer_ID
      , c.postcode
      , c.since
      , c.name
      , ( SELECT SUM(IF(s.status_ID != 7,1,0))
            FROM order o
            LEFT
            JOIN status s
              ON s.status_ID = o.status_ID
           WHERE o.customer_ID = c.customer_ID
        ) AS open_order_count
  FROM customer c
 ORDER BY c.customer_ID DESC 
```

* * *

注意：为了性能，我可能会避免加入表格，并通过只查看表格来`status`快捷检查。（这实际上取决于查询中包含该表的原因；我只是认为这里不需要它。）例如`status_ID``order``status`

```
 SELECT c.customer_ID
      , c.postcode
      , c.since
      , c.name
      , ( SELECT SUM(IF(o.status_ID != 7,1,0))
            FROM order o
           WHERE o.customer_ID = c.customer_ID
        ) AS open_order_count
  FROM customer c
 ORDER BY c.customer_ID DESC 
```

* * *

另一种方法是使用内联视图获取所有客户的未结订单计数，然后将其连接到客户表......

```
 SELECT c.customer_ID
      , c.postcode
      , c.since
      , c.name
      , IFNULL(r.open_order_count,0) AS open_order_count
  FROM customer c
  LEFT
  JOIN (
         SELECT o.customer_ID
              , SUM(IF(o.status_ID != 7,1,0)) AS open_order_count
           FROM order o
          GROUP
             BY o.customer_ID
       ) r
    ON r.customer_ID = o.customer_ID
 ORDER BY c.customer_ID DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:55:40.443

这个问题有两个部分：

1.  **我如何知道订单何时开放？**依赖“状态 ID 1-6”通常不是正确的方法。当您添加另一个状态时会发生什么？现在“开放”意味着“状态 ID 1-6 和 8？” 你可以看到这很快就会失控。更好的方法是在表中添加一个`is_open`标志`status`（也可能在`order`表中，但这只是出于历史目的，在您的应用程序中可能不是必需的）。

2.  **如何获取每个客户的未结订单计数？**那么这个问题的答案取决于你对前面的解决方案，但这应该可以解决问题（假设你已经在你的状态表中添加了一个 is_open 列，它是一个 TINYINT(1) 并在每个订单状态上正确设置了标志):

    从客户 LEFT JOIN 订单开启 (order.customer_ID = customer.customer_ID) LEFT JOIN 状态开启 (status.status_ID = order.status_ID) GROUP BY customer.customer_ID

请注意使用 a`LEFT JOIN`而不是 an `INNER JOIN`，这样无论有无活动订单，客户都会出现在您的客户列表中。

# sql - SQL 用户无法从 UID = 用户的 sysobjects 中选择对象

> ID：14217528
> 
> 赞同：0
> 
> 时间：2013-01-08T14:48:21.500
> 
> 标签：sql, sql-server, permissions, sysobjects

我正在使用一个遗留系统，该系统尝试通过首先以该用户的身份查询 sysobjects 以确定对象是否存在来为特定用户执行 SQL 中的架构更改。如果是，它会创建一个 ALTER VIEW 语句，否则它会创建一个 CREATE VIEW 语句。在这种情况下，视图存在，但查询仍然无法列出对象。

例如：

```
setuser 'APPLICATION_DEV'
Select * from sysobjects o, sysusers u
where u.uid = o.uid 
and u.name = N'APPLICATION_DEV' 
```

问题是该数据库中的某些帐户可以无错误地运行此查询，并且它返回该用户拥有的所有对象。但是，其他帐户没有得到此查询返回的记录。如果我将用户设置为 SA 并运行查询，则会出现所有用户对象。受影响的用户是架构的所有者，并且拥有架构的创建视图权限。我找不到工作用户和非工作用户帐户之间的权限差异。

是否有我缺少的权限会限制用户在 sysobjects 中查询他们自己的对象？

是的，我知道 sysobjects 已经过时，但我无法控制这里的实际代码，而是必须修复数据库，以便他们的代码能够按预期工作。

编辑：其他发现。为了使事情复杂化，我可以成功运行它：

```
setuser 'APPLICATION_DEV'
Select * from sysusers
Where name = 'APPLICATION_DEV' 
```

我也可以成功执行：

```
setuser 'APPLICATION_DEV'
Select * from sysobjects
Where uid = 308 --308 is the uid of the APPLICATION_DEV user 
```

但是，当我在 where 子句或通过 INNER JOIN 使用连接时，我没有得到任何记录。什么会限制我对纯粹基于联接的记录的访问？索引权限？？我很困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:25:54.287

对于用户映射中的特定用户，检查您是否选中了除 db_denydatareader 和 db_denydatawriter 之外的所有复选框。

还要检查这个
[对象'sysobjects'，数据库'mssqlsystemresource'，模式'sys'的SELECT权限被拒绝](https://stackoverflow.com/questions/1473315/the-select-permission-was-denied-on-the-object-sysobjects-database-mssqlsyst)
[http://social.msdn.microsoft.com/Forums/en/sqlsecurity/thread/a2befd20-2a9b-4a60- 95a9-3a80a1a99ea1](http://social.msdn.microsoft.com/Forums/en/sqlsecurity/thread/a2befd20-2a9b-4a60-95a9-3a80a1a99ea1)

# android - Android SoftKeyboard onKeyDown/Up 未检测到“替代”键

> ID：14217535
> 
> 赞同：5
> 
> 时间：2013-01-08T14:48:51.980
> 
> 标签：android, android-softkeyboard

我有一个为我处理输入的视图，我弹出一个键盘并将视图设置为可聚焦的。现在我可以得到某些按键...

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_DEL) {
    } else if (keyCode == KeyEvent.KEYCODE_BACK) {
    } else if (keyCode == KeyEvent.KEYCODE_ENTER) {
    } else {
    }
} 
```

依此类推......我通过使用按下的字符

```
event.getDisplayLabel() 
```

只要我只想要普通字母 AZ 就可以了。在其他语言中，长按软键盘上的普通字母可以找到更多字母……但是，onKeyDown/Up 无法检测到这些替代字母。我只能检测到正常的字母，软键盘的标签。现在我的应用程序必须处理外国输入和字母，我已将键盘更改为土耳其语，我可以在键盘上找到 í ì ú ù 之类的字母，但如果我按下它们，我没有得到任何回应。不是 event.getDisplayLabel 也不是 event.getUnicodeChar(); 如何检测这些字母？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-02T00:08:33.927

当键盘打开时，由于 Android 将屏幕键盘视为单独的活动，`onKeyDown()`因此`onKeyUp()`方法无法正常工作。

实现您想要的最简单的方法是覆盖`onKeyPreIme()`视图上的方法。例如，如果您尝试从 EditText 捕获 onKeyDown，请创建一个新的扩展类`EditText`，并覆盖该`onKeyPreIme()`方法：

```
public class LoseFocusEditText extends EditText {

    private Context mContext;

    protected final String TAG = getClass().getName();

    public LoseFocusEditText(Context context) {
        super(context);
        mContext = context;
    }

    public LoseFocusEditText(Context context, AttributeSet attrs) {
        super(context, attrs);
        mContext = context;
    }

    public LoseFocusEditText(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        mContext = context;
    }

    @Override
    public boolean onKeyPreIme(int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_BACK) {

            //hide keyboard
            InputMethodManager mgr = (InputMethodManager) mContext.getSystemService(Context.INPUT_METHOD_SERVICE);
            mgr.hideSoftInputFromWindow(this.getWindowToken(), 0);

            //lose focus
            this.clearFocus();

            return true;
        }
        return false;
    }
} 
```

这是在 kitkat / htc one 上测试的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T15:37:13.077

编辑：

我不确定是什么导致 onKeyDown 根本不被调用。可能是你的观点有问题？因此，可能有比我的解决方案更好的答案。无论哪种方式，这可能有效：

不要使用视图中的 onKeyDown，而是在活动级别覆盖 dispatchKeyEvent。这将在您的关键事件到达窗口管理器之前处理它，因此请确保在您未明确处理的任何关键事件上调用 super。

使用 ACTION_DOWN 的示例（因为每个事件都有 ACTION_UP 和 ACTION_DOWN），因为您的示例使用了 onKeyDown：

```
@Override
public boolean dispatchKeyEvent(KeyEvent event){
    if(event.getAction() == KeyEvent.ACTION_UP) {
        return super.dispatchKeyEvent(event);
    }

    if (keyCode == KeyEvent.KEYCODE_DEL) {
    } else if (keyCode == KeyEvent.KEYCODE_BACK) {
    } else if (keyCode == KeyEvent.KEYCODE_ENTER) {
    } else {
        return super.dispatchKeyEvent(event);
    }
} 
```

**现在**（对此感到抱歉）

你可以试试：

```
char key = (char)event.getUnicodeChar(); 
```

代替

```
char key = event.getDisplayLabel(); 
```

getDisplayLabel() 只会为您提供键盘上显示的键，正如您所指出的，它不一定是用户选择的字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T15:29:27.840

知道了 ：）

```
public boolean onKey(View v, int keyCode, KeyEvent event) {
    if(event.getAction()==KeyEvent.ACTION_DOWN) return true;
    if(keyCode==KeyEvent.KEYCODE_ALT_LEFT || keyCode==KeyEvent.KEYCODE_ALT_RIGHT || keyCode==KeyEvent.KEYCODE_SHIFT_LEFT || keyCode==KeyEvent.KEYCODE_SHIFT_RIGHT) return true;

    if (keyCode == KeyEvent.KEYCODE_DEL) {
        doBackspace();
        return true;
    } else if (keyCode == KeyEvent.KEYCODE_BACK) {
        if(this.avl!=null) this.avl.onInputCancelled(this);
        return false;
    } else if (keyCode == KeyEvent.KEYCODE_ENTER) {
        inputstarted=false;
        if(this.avl!=null) this.avl.onInputFinished(this,this.text,celldata);
        return true;
    }   

    String key = "";
    if (event.getAction()==KeyEvent.ACTION_UP) key = String.valueOf((char)event.getUnicodeChar()).toUpperCase();
    else if (event.getAction()==KeyEvent.ACTION_MULTIPLE) key = String.valueOf(event.getCharacters()).toUpperCase();
    return process(key);
} 
```

重要的部分是阻止 ALT_LEFT/SHIFT_LEFT/etc 键码并区分 ACTION_UP/ACTION_MULTIPLE 并使用 event.getUnicodeChar() 或 event.getCharacters()。

它现在可以工作了，我可以获得所有的字符，甚至 KEYCODE_DEL 也可以在手机上工作。但是在平板电脑上我仍然没有得到删除键的回调。似乎是一个糟糕的错误，因为今天早上它即使在平板电脑上也能正常工作。

# c# - Windows 8 应用程序中的 C# 和 C++ 问题

> ID：14217537
> 
> 赞同：1
> 
> 时间：2013-01-08T14:49:00.347
> 
> 标签：c#, c++, windows-8, windows-runtime

我的代码使用媒体基础转换将效果应用于 XAML/C# 中呈现的视频流。它实际上是 Microsoft 提供的 Media Capture 示例。我想使用 DirectX Toolkit，所以我在 C++ 应用程序中添加了对它的引用。构建成功但是我遇到了以下错误：

```
warning LNK4197: export 'DllGetActivationFactory' specified multiple times; using first specification 
warning LNK4197: export 'DllCanUnloadNow' specified multiple times; using first specification
warning LNK4197: export 'DllGetActivationFactory' specified multiple times; using      first specification 
warning LNK4197: export 'DllCanUnloadNow' specified multiple times; using first specification
error LNK2005: _DllCanUnloadNow@0 already defined in dllmain.obj 
error LNK1169: one or more multiply defined symbols found 
```

这里有更详细的描述： [Windows::Storage::ApplicationData::Current Not Found in C++](https://stackoverflow.com/questions/12893355/windowsstorageapplicationdatacurrent-not-found-in-c)

但是，按照该帖子中的步骤操作后，我遇到了另一个错误。当 C# 代码尝试在以下位置调用 WinRT dll 时

```
await m_mediaCaptureMgr.AddEffectAsync(Windows.Media.Capture.MediaStreamType.VideoPreview, "GrayscaleTransform.GrayscaleEffect", null); 
```

它抛出一个没有任何细节的新异常。异常文本是

```
System.Exception: Error in the DLL
at Windows.Media.Capture.MediaCapture.AddEffectAsync(MediaStreamType mediaStreamType, String effectActivationID, IPropertySet effectSettings) 
```

我所做的只是通过编译器将我的 DLL 链接到 GreyscaleTransform，而无需调用任何其他代码。

关于可能导致此问题的任何想法或解决问题的最佳方法是什么？

非常感谢，斯特凡

# jira - jira 记录完成时间（不是花费的时间）

> ID：14217539
> 
> 赞同：0
> 
> 时间：2013-01-08T14:49:03.997
> 
> 标签：jira, jira-plugin

完成某些任务后，如何在 jira 中记录当前（完成）时间？所以我不想将任务花费的时间计算为任务的开始时间+任务花费的时间，我只想输入完成时间，花费的时间将被计算（在 jira 中）作为完成时间开始时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T20:36:34.153

JIRA 目前不提供实时跟踪。

但是，您的 IDE 应该有一些记录您时间的方法 - 例如 Eclipse 在任务插件中内置了它，它也可以连接到 JIRa，以便您可以在 IDE 中查看您的任务并“实时记录您的时间” “ 在那里。

我发现这相当不方便，因为如果在 IDE 内不活动一段时间后，跟踪将停止 - 虽然这是 IDE 中的一个选项。我个人使用对“单人表演”团队免费的[Toggl 。](http://www.toggl.com)他们对团队的定价也非常好。还有像 Toggl 这样的其他服务，它们并不都是基于 Web 的。例如，如果您在 Linux 上使用[Project Hamster 。](http://projecthamster.wordpress.com/)只是谷歌`time tracking`。;) 否则，正如我所说，唯一的方法是通过某些任务模块将您的 IDE 连接到 JIRA。

# debugging - 许多 requestShippingRates 错误

> ID：14217541
> 
> 赞同：0
> 
> 时间：2013-01-08T14:49:10.573
> 
> 标签：debugging, magento, php

我似乎无法找到如何追踪这个错误：我可以看到它与运费有关，但错误日志中发布的信息很少。

```
2013-01-08T15:45:36+01:00 DEBUG (7): requestShippingRates 
```

发布了许多此类错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:00:31.220

有两种可能性，一种是字符串包含在您的代码中，因此只需在项目中搜索“requestShippingRates”，然后找到传递给的字符串`Mage::log`。另一个可能更有可能的是，在某个时候，有人`Mage::log(__FUNCTION__)`在其中一个`requestShippingRates`函数中添加了一些类似的东西。通过搜索`n requestShippingRates`（即匹配函数声明末尾的 n），您应该可以很容易地找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T19:33:22.870

如果您有 shell 访问权限，请尝试使用以下命令搜索 requestShippingRates 的实例。从 /var/www/app 目录运行它。* 表示查看所有内容，-R 表示递归目录，-i 表示忽略大写/小写。

```
 grep "requestShippingRates" * -R -i 
```

您没有提到这些错误是否显示在您的 php 日志中，但您也可以 grep 以下内容：

```
grep "error_log(" * -R -i 
```

这将显示写入 php 错误日志的任何内容。

# php - div 中的背景图像不使用 PHP 显示

> ID：14217545
> 
> 赞同：0
> 
> 时间：2013-01-08T14:49:29.147
> 
> 标签：php, image, background

我正在尝试为 div 提供附加到特定帖子的背景图像（每次需要另一个图像时都会出现）。我正在从数据库中检索 URLS，然后将其放入以下代码中：

```
<div class="parallax_banner" style="background-image:url(<?= "_/".$rowImage['imgPath']."/".$rowImage['imgName'] ?>)"></div> 
```

整个代码：

```
<?

$result = mysql_query("SELECT * FROM `items` WHERE `itemID` = ".$_GET['postID'])or die(mysql_error());
while ($row = mysql_fetch_assoc($result)) {

    $resultImage = mysql_query("SELECT * FROM `images` WHERE `itemID` =".$row['itemID']." LIMIT 1")or die(mysql_error());
    while ($rowImage = mysql_fetch_assoc($resultImage)) {
?>      
<div class="paginaBannerWrapper">
    <div class="paginaBannerSlideshow">
        <div class="parallax_banner" style="background-image:url(<?= "_/".$rowImage['imgPath']."/".$rowImage['imgName'] ?>)"></div> 
    </div>
</div>      
<div id="content">
    <div id="bigTitle">
        <h1><?=$row['itemTitle']?></h1>
    </div>
    <div id="centerContent">    
                <div id="colDesc">                  
                    <div class="itemContent"><?=$row['itemContent']?></div>
                </div>
                <div id="colImg"><img src="<?= "_/".$rowImage['imgPath']."/".$rowImage['imgName'] ?>"/></div>

        <?  
            }
        }
        ?>
    </div>
</div> 
```

它没有显示任何内容，但是如果我测试链接`<img src=`而不是`background-image:url()`显示它。所以这条路是对的。如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:52:43.617

如果您使用`background-*`css 设置，您需要为 div 提供一些高度和宽度尺寸，否则它将默认为无，您将看不到您的图像。

# jquery - JQuery 淡入/淡出

> ID：14217548
> 
> 赞同：1
> 
> 时间：2013-01-08T14:49:32.880
> 
> 标签：jquery, fade

我有一组 div 在单击它们各自的菜单链接时淡出和淡入。第一个 div 应该在页面加载时自动加载，没有任何淡入淡出，如果没有加载任何内容，则应该只有淡入淡出效果。现在我完成了所有这一切，除了第一个 div 的即时加载。当我加载页面时，没有内容存在，出现淡出，然后第一个 div 自动淡入。如何确保我自动加载的第一个 div 没有任何淡入淡出？

当前代码：

```
$(document).ready(function () {
  $('a').bind("click", function () {
    $('a').removeClass("actief");
    $(this).addClass("actief");
    var fade = $(this);

    if ($('#content').html()) {
      $(this).addClass("actief");
      $('#content').stop().fadeTo(500, 0, function () {
        $('#content').html("").css('opacity', 0);
        fade.next().clone().appendTo('#content');
        $('#content').stop().fadeTo(500, 1);
      });
    } else {
      $('#content').css('opacity', 0);
      fade.next().clone().appendTo('#content');
      $('#content').stop().fadeTo(500, 1);
    }
  });

  $('a:first').trigger('click');
}); 
```

HTML：

这是html

```
<body>
    <div id="container">
        <div id="menudiv">
            <ul id="menu">
                <li>
                    <a>About</a>
                    <div>
                       <H1>About</H1>
                           <img src="pic.png">
                           <p></p>
                    </div>
                </li>
                <li>
                    <a>Knowledge</a>
                    <div>
                       <H1>Knowledge</H1>
                           <img src="pic.png">
                           <p></p>
                    </div>
                </li>
                <li>
                    <a>Expectations</a>
                    <div>
                       <H1>Expectations</H1>
                           <img src="pic.png">
                           <p></p>
                    </div>
                </li>
                <li>
                    <a>More</a>
                    <div>
                       <H1>More</H1>
                           <img src="pic.png">
                           <p></p>
                    </div>
                </li>
            </ul>
    </div>

    <div id="content">

    </div>
</div>

</body> 
```

CSS

```
*{
    margin:0px;
    padding:0px;
}

#container{
    width:800px;
    height:600px;
    margin:auto;
    background-color:#6CF;
}

#menudiv{
    width:800px;
    background-color:#066;
    height:50px;
    float:left;
    margin-top:20px;
    border-bottom:2px solid orange;
}

#content{
    width:800px;
    background-color:#069;
    height:400px;
    float:left;
}

#content p{
    font-family:Arial, Helvetica, sans-serif;
    font-size:14px;
    color:white;
    padding:10px;
}

#content img{
    border: 2px solid white;
    margin-left:10px;
    float:left;
    margin-right:10px;
}

H1{
    font-family:Arial, Helvetica, sans-serif;
    font-size:16px;
    color:white;
    padding:10px;
}

ul li{
    list-style-type:none;
    float:left;
    margin:10px;
    background-color:black;
    color:white;
    border:2px solid white;
    padding:4px;
}

ul li div{
    display:none;
    text-decoration:line-through;
}

ul li .actief{
    color:orange;
}

#menu ul li div{display:none}
#menu ul li:first-child div{display:block} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:32:54.800

你可以通过 CSS 做到这一点，

```
#menu ul li div{display:none}
#menu ul li:first-child div{display:block} 
```

然后它将在页面加载时重置

（你可能想让你的 CSS 更具体一点）

更新一：

糟糕，没有发现 .clone() 位，而不是 .trigger("click")，您可以使用它...

$('a:first').next().clone().appendTo('#content');

这将按照您的描述将第一个 div 复制到页面正文中

更新二：

要保留 .trigger() ，您可以检测 .click 是否由真正的点击触发（请参见[此处](https://stackoverflow.com/questions/6692031/check-if-event-is-triggered-by-a-human)），然后在您的点击功能中绕过 .fade 效果（或者可能有 101 种其他方法可以做到这一点！）

# android - 在画布上绘制的圆圈与屏幕不匹配

> ID：14217567
> 
> 赞同：5
> 
> 时间：2013-01-08T14:50:23.630
> 
> 标签：android, graphics, canvas

我想在屏幕中心画圆，但我得到了这样的东西：

![在此处输入图像描述](../Images/c3f8f4ebd89af8770fee064f82de3f92.png)

我正在使用这段代码来绘制这个圆圈。

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Display display = getWindowManager().getDefaultDisplay(); 
    int width = display.getWidth();
    int height = display.getHeight();

    Bitmap bmp = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_4444);

    Canvas c = new Canvas(bmp);

    RectF rect = new RectF(0,0,width,width);
    drawCircle(rect, c, width, height);
    ImageView img = (ImageView) findViewById(R.id.imageView1);
    img.setImageBitmap(bmp);
    img.setScaleType(ScaleType.FIT_CENTER);

}

private void drawCircle(RectF rect, Canvas c, int width, int height) {
    Paint paint = new Paint();
    paint.setARGB(255, 255 , 10, 21);
    paint.setStrokeWidth(10);
    paint.setAntiAlias(true);
    paint.setStrokeCap(Paint.Cap.BUTT);
    paint.setStyle(Paint.Style.STROKE);
    int radius;
    if(width < height)
        radius = width/2;
    else 
        radius = height/2;
    c.drawCircle(width/2, height/2, radius, paint);
} 
```

即使我使用屏幕大小来绘制它，我也不明白为什么它在侧面被切割，所以它应该完全适合它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-08T14:56:18.900

您没有考虑线条的粗细（strokeWidth）。你画了一个圆圈，假设它的厚度为 0，所以“实际”圆圈接触屏幕的边缘，但由于你使用了厚画笔，一些油漆从边缘漏了出来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T14:59:30.133

你应该减少厚度/2。

```
 private void drawCircle(RectF rect, Canvas c, int width, int height) {
        Paint paint = new Paint();
        paint.setARGB(255, 255 , 10, 21);
        paint.setStrokeWidth(10);
        paint.setAntiAlias(true);
        paint.setStrokeCap(Paint.Cap.BUTT);
        paint.setStyle(Paint.Style.STROKE);
        int radius;
        if(width < height)
            radius = width/2;
        else 
            radius = height/2;

//this is the new line:
        radius-= 5;
        c.drawCircle(width/2, height/2, radius, paint);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:57:43.720

占`StrokeWidth`半径：

```
// Substract stroke width.
radius -= paint.getStrokeWidth() / 2;
c.drawCircle(width/2, height/2, radius, paint); 
```

# git - 关于自动 git 标记的问题

> ID：14217573
> 
> 赞同：1
> 
> 时间：2013-01-08T14:50:42.287
> 
> 标签：git

**情况：**我们公司创建了使用 Hudson 从 git 存储库中的代码构建的软件版本。有时，由于试用期已过，我们需要重现以前版本的构建。这带来了一个问题，因为我们需要找到与该软件版本对应的代码版本。我们的开发人员不使用标签或分支工作，因为它不符合我们的工作风格。

作为这个问题的解决方案，我认为我们应该在每次构建成功时包含一个自动标记系统。

我想到的工作流程如下（在我们的构建机器上执行）：

1.  如果进行了任何本地更改，则丢弃所有本地更改：`git checkout .` `git clean -df`
2.  获取最新版本：`git pull`
3.  转到所需的版本`git checkout .`或`git checkout <tag>`
4.  构建软件
5.  如果成功：标记当前版本，并将标记推送到存储库：`git tag -m "automated tag" versionXXX` `git push --tags`

关于这种工作方式，我有 3 个问题：

1.  这种工作方式有什么明显的缺陷吗？（含糊，我知道 - 对不起）
2.  对于这个用例，使用带注释的标签比轻量级标签有什么优势吗？大多数帖子都推荐带注释的标签，但我并没有真正看到附加值，尤其是对于这个用例。
3.  我们的软件由多个模块组成，每个模块都有自己的 git 存储库。其中一些模块几乎没有更新。有很多标签指向同一个提交有什么缺点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:23:06.830

> 1）这种工作方式有什么明显的缺陷吗？（含糊，我知道 - 对不起）

没有。

> 2）对于这个用例，使用带注释的标签比轻量级标签有什么优势吗？

不，如果您没有在标签消息中添加任何有意义的内容，那么一开始就创建一个没有任何意义。没有真正的缺点（它们几乎不会占用任何空间）。如果你从构建中得到任何结果，你可以把它们放在标签注释中（除非你有其他的日志机制，无论如何都要检查），例如警告的数量，或者类似的东西。

> 3）有很多标签指向同一个提交有什么缺点吗？

不，除了可能会弄乱标签名称空间（标签名称必须对 repo 唯一）之外，没有问题。如前所述，它们几乎不使用任何空间。如果冗余标签有任何问题，您可以实施如下策略：如果先前构建的标签指向我现在要标记的同一提交，则不要标记它。如果您查找特定版本的标签，请在您指定的版本之前使用最新版本的标签。（这只有在查找是自动化的情况下才可行；否则只需重新标记提交。）

# jmeter - Jmeter HttpRequest java实现是单线程的吗

> ID：14217576
> 
> 赞同：2
> 
> 时间：2013-01-08T14:50:46.733
> 
> 标签：jmeter

在 jmeter 上查看文档说 http 请求的 java 实现。

API 最适合单线程使用——各种设置（例如代理）是通过系统属性定义的，因此适用于所有连接。

这种说法令人困惑。这是否意味着如果你在 ThreadGroup 中放置 100 个线程，你实际上只有一个 java 线程？一个线程到多个连接？或者它意味着别的东西。

我以为Jmeter是为了创建多个java线程进行压力测试。我们希望利用具有多个 java 线程的多个处理器进行压力测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:55:39.173

> 这是否意味着如果你在 ThreadGroup 中放置 100 个线程，你实际上只有一个 java 线程？

不，但我同意这令人困惑。100 个线程意味着最多 100 个并发连接。

文档说，由于 Java HTTP API 是通过系统属性配置的，因此它最适合单线程应用程序。在多线程环境中，很难仅将设置应用于单个线程，因为系统属性是全局的。

HTTPClient 采样器（您应该更喜欢）没有这样的限制，因为一切都是基于连接显式配置的。

# python - python pandas csv导出

> ID：14217581
> 
> 赞同：7
> 
> 时间：2013-01-08T14:51:01.207
> 
> 标签：python, csv, pandas, export

我在将数据框导出到 CSV 文件时遇到问题。

数据类型是 String 和 Float64 值，如下所示：

```
In [19]: segmenti_t0
Out[19]:
SEGM1  SEGM2
AD     P.S.         8.3
       SCREMATO     0.6
CRE    STD          1.2
FUN    INTERO       0.0
       P.S.         2.0
       SCREMATO     0.0
NORM   INTERO      13.1
       P.S.        69.5
       SCREMATO     5.2
Name: Quota volume_t0 
```

我尝试使用以下命令导出此数据框：

```
IN [20]: segmenti_t0.to_csv('C:Users\MarioRossi\prova.csv', sep=";") 
```

当我尝试使用 Excel 打开它或尝试使用格式参数从 csv 文件将其导入 excel 时，我会获得非常奇怪的浮点值格式，例如 69.5000 或 5.2.0000000 或日期时间格式，如下所示：

```
NORM    INTERO  13.01
NORM    P.S.    69.05.00
NORM    SCREMATO    5.02 
```

考虑到我使用的是欧洲格式（“”，就像我从 csv 文件中导入原始原始数据时使用的十进制一样）。

请帮助我：我开发了一个软件（带有 GUI 等），因此我无法交付它！

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T15:40:44.970

您应该使用[`to_excel`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_excel.html)DataFrame 方法：

```
# first convert Series to DataFrame
df_segmenti_t0 = DataFrame(segmenti_t0)

# save as excel spreadsheet
df_segmenti_t0.to_excel('prova.xls') 
```

# android - GCM 推送通知 - 需要查看移动通知区域中的所有推送警报，一个接一个。

> ID：14217583
> 
> 赞同：3
> 
> 时间：2013-01-08T14:51:03.300
> 
> 标签：android, push-notification, google-cloud-messaging

如果我的问题太简单，请道歉。

目前我正在开发一个 android 应用程序，其中我将收到多个警报（来自服务器），并且我必须一个接一个地查看所有推送警报（在移动通知列表中）。

我在下面给出了我的代码。我的服务器正在成功地将所有 GCM 推送警报通知发送到我的 android 手机。

但是，我只能查看最后发送的推送警报（在通知列表中）。也就是说，考虑我的服务器正在发送 2 个推送警报：PUSH_A 和 PUSH_B。在我的安卓手机中，我只能查看第二个警报：PUSH_B。

请你说，我做错了什么。我必须一个接一个地查看移动设备中的所有推送警报（通知列表中的 PUSH_A 和 PUSH_B）。

我的**服务器代码**如下：

```
Sender aGcmSender = new Sender(API_KEY); 

//Constructing message which need to be transmitted to android device.      
Message aMessage = new Message.Builder().addData("message", thePushMsg).build(); 

Result aResult = aGcmSender.send(aMessage, theRegId, 1); //Transmitting message to android device
if(aResult != null)
{
    if(aResult.getMessageId() != null)
    {
        String aCanonicalRegistrationId = aResult.getCanonicalRegistrationId();
        if(aCanonicalRegistrationId != null)
        {
            //updating aCanonicalRegistrationId to my database
        }
        itsLogger.info("Push notification successfully sent to cub of phone: "+theCubsPhone);
        itsLogger.info("Message Id:"+aResult.toString());
    }
    else 
    {  
        String error = aResult.getErrorCodeName();
        itsLogger.info("Android Push Notification: Failed to send push notification to phone" + thePushMsg);
        if (error.equals(Constants.ERROR_NOT_REGISTERED)) {    
            // application has been removed from device - unregister database
        }
    }
} 
```

**手机中的 GCM 代码：** * *AndroidManifest.xml：* *

```
 <permission android:name="MyProjectPackage.permission.C2D_MESSAGE" android:protectionLevel="signature" />
    <uses-permission android:name="MyProjectPackage.permission.C2D_MESSAGE" />

<!-- App receives GCM messages. -->
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <!-- GCM requires a Google account. -->
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
    <uses-permission android:name="android.permission.USE_CREDENTIALS" />
    <uses-permission android:name="android.permission.READ_OWNER_DATA" />
    <!-- Keeps the processor from sleeping when a message is received. -->
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <!-- Permission to vibrate -->
    <uses-permission android:name="android.permission.VIBRATE" />

<!-- BroadcastReceiver for push alert notifications -->
        <receiver android:name="com.google.android.gcm.GCMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND" >
          <intent-filter>
            <action android:name="com.google.android.c2dm.intent.RECEIVE" />
            <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
            <category android:name="MyProjectPackage" />
          </intent-filter>
        </receiver>
        <service android:name=".GCMIntentService" /> 
```

**GCMIntentService：**

```
private void sendGCMIntent(final Context theContext, String theMessage) 
    {   
    int icon = R.drawable.icon;
        long when = System.currentTimeMillis();

        NotificationManager notificationManager = (NotificationManager)
                theContext.getSystemService(Context.NOTIFICATION_SERVICE);
        Notification notification = new Notification(icon, theMessage, when);

        String title = theContext.getString(R.string.app_name);

        Intent notificationIntent = new Intent();
        // set intent so it does not start a new activity
        notificationIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP |
                Intent.FLAG_ACTIVITY_SINGLE_TOP);
        PendingIntent intent =
                PendingIntent.getActivity(theContext, 0, notificationIntent, 0);
        notification.setLatestEventInfo(theContext, title, theMessage, intent);
        notification.flags |= Notification.FLAG_AUTO_CANCEL;

        // Play default notification sound
        notification.defaults |= Notification.DEFAULT_SOUND;

        // Vibrate if vibrate is enabled
        notification.defaults |= Notification.DEFAULT_VIBRATE;
        notificationManager.notify(0, notification);    
    } 
```

请提供任何帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-08T15:01:38.560

因为您的通知 ID 始终为 0

```
notificationManager.notify(0, notification); 
```

新通知将替换为以前的通知。只是您必须将 id 更改为这样的任何数字：

```
if (theMessage.equals(PUSH_A ))
    notificationManager.notify(0, notification);
else
    notificationManager.notify(1, notification); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-10T12:17:16.773

放

```
int n_id =  new Random().nextInt(); 
```

把这个`n_id`传给

```
mNotificationManager.notify(appName, n_id, mBuilder.build()); 
```

函数，因为我已经传递了它，因此整数 id 总是会得到不同的随机数，这种方式总是会收到每条新消息的新通知

# android - Android数据库sql列表

> ID：14217585
> 
> 赞同：0
> 
> 时间：2013-01-08T14:51:09.823
> 
> 标签：android, arrays, sqlite, arraylist, android-listview

您好我正在尝试使用 sql 数据库创建一个 android 应用程序，我想在列表视图中列出我的结果，但似乎无法让它工作，请帮助我到目前为止并收到错误

java.lang.IllegalArgumentException：列“_id”不存在

SimpleCursorAdapter adp;

```
 public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);

         db.open();

         // from array: keeps the names of the Cursor columns.
         String[] from = {"CURSOR_FIELD1","CURSOR_FIELD2"};
         // to array: keeps the ids of the fields in your list item layout
         int[] to = {R.id.itemLayoutfield1, R.id.itemLayoutfield2};
         // sets the basic layout of the ListActivity (the layout must contain a ListView element with the id called 'list').
         setContentView(R.layout.view_data_layout);

         // gets de cursor with the rows        
         c = db.getAllCourses(); 

         adp = new SimpleCursorAdapter(this, R.layout.row, c, from, to);             
         setListAdapter(adp);

        ListView listView = getListView();
        listView.setTextFilterEnabled(true);

        listView.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                // When clicked, show a toast with the TextView text
                Toast.makeText(getApplicationContext(),
                ((TextView) view).getText(), Toast.LENGTH_SHORT).show(); 

                displayAllCourses(c);

                db.close();

            }               

        }); 
```

还有我的 dbadapter

公共游标 getAllCourses() {

```
 return db.query(DATABASE_TABLE, new String[] { ID, Time_Amount,
            Seed_Acre, MM_Settings, Acre_amount, Speed_Type, Acre_String, Seed_Type,  Hill_Name }, null, null,
            null, null, null, null);
}

public Cursor getCourse(long rowId) throws SQLException {

    Cursor mCursor = db.query(true, DATABASE_TABLE, new String[] { ID,
            Time_Amount, Seed_Acre, MM_Settings, Acre_amount, Speed_Type, Acre_String, Seed_Type, Hill_Name },
            ID + "=" + rowId, null, null, null, null, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:12:30.670

您的“ *hill* ”字符串数组仅包含一个项目（甚至不是表的第一行）。

要显示来自 Cursor 的查询结果，您最好使用 SimpleCursorAdapter 对象，而不是 ArrayAdapter，此对象可帮助您将查询结果（光标）映射到视图（用户界面）的字段。它会是这样的：

```
public class YourListActivity extends ListActiviy{

    private SimpleCursorAdapter adp;
    private Cursor c;

    public void onCreate(Bundle savedInstanceState) {
             super.onCreate(savedInstanceState);

             ...
             // from array: keeps the names of the Cursor columns.
             String[] from = {"CURSOR_FIELD1","CURSOR_FIELD2", ...};
             // to array: keeps the ids of the fields in your list item layout
             int[] to = {R.id.itemLayoutfield1, R.id.itemLayoutfield2, ...};
             // sets the basic layout of the ListActivity (the layout must contain a ListView element with the id called 'list').
             setContentView(R.layout.listLayout);

             // gets de cursor with the rows        
             c = db.getAllCourses(); 

             adp = new SimpleCursorAdapter(this, R.layout.itemLayout, c, from, to);             
             setListAdapter(adp);

             ...
     }
} 
```

重要提示：请记住，CursorAdapter 类及其子类（即 SimpleCursorAdapter）需要将表的主键命名为 _id。

listLayout.xml 应该类似于（注意它有一个 ID 为“ *list* ”的 ListView）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
         android:orientation="vertical"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content">
     <ListView android:id="@android:id/list"
               android:layout_width="fill_parent"
               android:layout_height="wrap_content"/>
 </LinearLayout> 
```

itemlayout.xml 可能类似于：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content" >
            <TextView
                android:id="@+id/itemLayoutfield1"
                android:text="TextView" />
        </LinearLayout>
        <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="match_parent" >
            <TextView
                android:id="@+id/itemLayoutfield2"
                android:text="TextView" />          
        </LinearLayout>
        <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="match_parent" >
            <TextView
                android:id="@+id/itemLayoutfield3"
                android:text="TextView" />          
        </LinearLayout>
</LinearLayout> 
```

# ruby - # 未定义的方法“密码”

> ID：14217591
> 
> 赞同：1
> 
> 时间：2013-01-08T14:51:21.307
> 
> 标签：ruby, ruby-on-rails-3, forms, model, controller

我正在关注此视频教程并学习如何从头开始创建身份验证：

[http://www.youtube.com/watch?v=O5RDisWr_7Q](http://www.youtube.com/watch?v=O5RDisWr_7Q)

* * *

这是我的用户迁移文件：

```
class CreateUsers < ActiveRecord::Migration
  def change
    create_table :users do |t|
      t.string :email
      t.string :password_hash
      t.string :password_salt

      t.timestamps
    end
  end
end 
```

我的控制器：

```
class UsersController < ApplicationController
  def new
    @user = User.new
  end

  def create
    @user = User.new(params[:users])
    if @user.save
      redirect_to root_url, :notice => "Signed up!"
    else
      render "new"
    end
  end
end 
```

最后是我的模型：

```
class User < ActiveRecord::Base
  attr_accessible :email, :password_hash, :password_salt

  before_save :encrypt_password

  validates_confirmation_of :password
  validates :password, presence: true
  validates :email, presence: true

  def encrypt_password
    if password.present?
      self.password_salt = BCrypt::Engine.generate_salt
      self.password_hash = BCrypt::Engine.hash_secret(password, password_salt)
    end
  end
end 
```

* * *

现在，我想我知道为什么会触发此错误；显然，该`@user.save`调用试图将值保存`password`到 User 表中的密码字段中，但该字段在数据库中不存在。在视频中，他提到要修复此错误，我应该将：添加`attr_accessible :password`到我的模型中，它应该可以工作，但我收到以下错误：

> 用户控制器中的 NoMethodError#create
> 
> # 未定义的方法“密码”
> 
> app/controllers/users_controller.rb:8:in `create'

有什么建议么？我只是想利用使用强类型模型而不是松散的 html 字段所带来的验证。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T14:53:43.303

您有`attr_accessible :password_hash, :password_salt`，但我认为它应该与`attr_accessible :password`一起使用，`attr_accessor :password`因为您需要一个`password`在您的`encrypt_password`方法中工作的虚拟属性。所以：

```
class User < ActiveRecord::Base
  attr_accessible :email, :password
  attr_accessor :password
end 
```

`attr_accessor`创建不可用作数据库字段的虚拟属性（因此是虚拟的）。

`attr_accessible`是一种将属性列入白名单的安全机制，可以像您一样通过批量分配进行设置`User.new(params[:users])`

# java - Java 事件循环，“轻轻”睡眠

> ID：14217592
> 
> 赞同：0
> 
> 时间：2013-01-08T14:51:21.080
> 
> 标签：java, sleep, event-loop

我正在做一种事件循环来处理 Java 中的多个非阻塞套接字。问题是当我保持循环不变时，它使用了整个核心。（例如，我有一个四核，每次启动程序时，CPU 每次都会跳到 25%。）

我知道我可以使用 Thread.sleep() 来减慢处理器的使用速度，但我想知道是否有合适的方法来做到这一点。我觉得 Thread.sleep(1) 可能会限制我的事件循环。

所以我的问题是，我该怎么做？有正确的方法吗？我应该降低线程的优先级吗？我应该使用 Thread.sleep(0, someNanosecondsAmount) 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:19:37.610

所有的休眠方法都会休眠至少 1 毫秒。您可以使用更短但通常不会放弃 CPU 的 yield()。

如果您忙于等待一组套接字，您最终将使用整个 cpu，或者您将有毫秒级的延迟。

一个更好的解决方案是使用 Selector 等待 Socket 准备好使用，或者使用每个连接的线程阻塞 NIO。

# iphone - iOS 图形库

> ID：14217595
> 
> 赞同：-1
> 
> 时间：2013-01-08T14:51:26.220
> 
> 标签：iphone, objective-c, ios, macos, ipad

我正在学习 iOS，我想创建一个小应用程序，它将我的图像放在黑色背景上并添加任何文本。

示例 - [http://demotivation.me/images/20130105/d5il8ka359c2.jpg](http://demotivation.me/images/20130105/d5il8ka359c2.jpg)

如何更好地实现它？使用哪个图形库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:56:38.967

使用标准 iOS SDK 函数、操作`UIView`和标签。
你不希望这样做有什么困难。只需设置一些框架和视图层次结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T14:57:22.483

查看 Quartz / Core Graphics 的那种绘图（用于学习目的）。[Quartz 2D Programming Guide](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/Introduction/Introduction.html "Quartz 2D 编程指南")是开始了解更多信息的好地方。

如果您不是出于学习目的而这样做，您可以使用视图、图像视图和标签轻松地做到这一点。设置都可以在 Interface Builder 中完成（虽然对学习不是很有用）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T15:22:18.463

我认为您需要这样的简单代码：

```
UIView* backgroundView = [[UIView alloc] initWithFrame:[[UIScreen mainScreen] bounds]]; // create background view with frame of all screen
backgroundView.backgroundColor = [UIColor blackColor]; // set it color

UIImageView* image = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"image.png"]]; // create image view with image you want
image.frame = CGRectMake(10, 10, 300, 300); // set frame, better to set frame in depending of backgroundView frame, because we've got few types of iOS devices with different displays
[backgroundView addSubview:image]; // place created image to background

UILabel* textLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 0, 0)]; // create frame you want with similar way as image
textLabel.backgroundColor = UIColor.clearColor;
[backgroundView addSubview:textLabel];
[self.view addSubview:backgroundView]; // add created backgroundView to your UIViewController's background 
```

# maven - 无法使用 maven-3.0.4 构建 Java Mail API 1.4.5

> ID：14217596
> 
> 赞同：1
> 
> 时间：2013-01-08T14:51:26.497
> 
> 标签：maven, jakarta-mail, netbeans-7

我正在尝试使用 Maven 的默认设置使用 Maven-3.0.4 构建 Java Mail 1.4.5。

由于以下错误，它无法构建 -

> 会话 [INFO] 8 个错误 [INFO] ----------------------------------------- ------------------ [信息] ----------------------------- ----------------------------------------- [INFO] 构建失败 [INFO] - -------------------------------------------------- ------------------- [INFO] Total time: 1:51.197s [INFO] Finished at: Tue Jan 08 13:06:01 IST 2013 [INFO] Final Memory : 12M/67M [信息] -------------------------------------------------------- --------------------------- [错误] 无法执行目标 org.apache.maven.plugins:maven-compiler-plugin:2。3.2：在项目 javax.mail 上编译（默认编译）：编译失败：编译失败：[ERROR] \Workarea\mySourceData\src\Mail\mail\src\main\java\javax\mail\Session.java:[ 210,37] 找不到符号 [ERROR] 符号：变量版本 [ERROR] 位置：类 javax.mail。 [http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException](http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException)

当我尝试使用 netbeans - 7.2.1 构建 Java Mail 时遇到同样的问题，它在 Session.java 类中出现相同版本问题而失败。

如何在 Session.java 类中设置此版本以消除此错误？

如果我们可以使用 nexus 存储库，请告诉我如何设置它。

谢谢，尼拉姆夏尔马

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T23:38:30.020

JavaMail 1.4.5 需要 Maven 2 来构建。在 1.4.5 发布后不久，我将其修复为使用 Maven 3 构建。如果要反向移植它们，可以在源存储库中找到更改。

不过，上面的错误看起来与 Maven 版本无关，因此可能还有其他问题。我记得，我在使用更新版本的编译器插件时遇到了类似的问题，我还必须更新 build-helper 插件来修复它。

# soap - 使用客户端存根时前缀为空

> ID：14217597
> 
> 赞同：1
> 
> 时间：2013-01-08T14:51:35.187
> 
> 标签：soap, null, axis, rpc, prefix

我必须使用轴来生成存根，因为我正在使用的 SOAP 使用 RPC。设置要发布的代码后，我收到以下堆栈跟踪。如果有人遇到过这个问题，请帮忙。通过在 Eclipse 中使用调试工具，我可以看到 Axis 正在使用默认前缀，但问题是它使用的前缀之一已被使用，因此它返回 null。有谁知道为什么会发生这种情况？

```
AxisFault
 faultCode: {http://schemas.xmlsoap.org/soap/envelope/}Server.userException
 faultSubcode: 
 faultString: java.io.IOException: java.io.IOException: Non nillable element 'prefix' is null.
 faultActor: 
 faultNode: 
 faultDetail: 
    {http://xml.apache.org/axis/}stackTrace:java.io.IOException: java.io.IOException: Non nillable element 'prefix' is null.
    at org.apache.axis.encoding.ser.BeanSerializer.serialize(BeanSerializer.java:275)
    at org.apache.axis.encoding.SerializationContext.serializeActual(SerializationContext.java:1504)
    at org.apache.axis.encoding.SerializationContext.serialize(SerializationContext.java:980)
    at org.apache.axis.encoding.SerializationContext.outputMultiRefs(SerializationContext.java:1055)
    at org.apache.axis.message.SOAPBody.outputImpl(SOAPBody.java:145)
    at org.apache.axis.message.SOAPEnvelope.outputImpl(SOAPEnvelope.java:478)
    at org.apache.axis.message.MessageElement.output(MessageElement.java:1208)
    at org.apache.axis.client.Call.invoke(Call.java:2757)
    at org.apache.axis.client.Call.invoke(Call.java:2443)
    at org.apache.axis.client.Call.invoke(Call.java:2366)
    at org.apache.axis.client.Call.invoke(Call.java:1812) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-01T13:09:14.493

虽然这个问题在一年后没有得到回答，但我认为它可能会对您有所帮助，因为您正在使用 RPC 并且可能是一个遗留系统。

在您生成的带有 Apache Axis 的客户端存根中，打包后以“_xsd”结尾，其中 Web 服务提供者的对象被一一创建开放类。在类中间的某个地方，你会发现一个像这样的静态块代码：

```
 static {
    typeDesc.setXmlType(...);
    org.apache.axis.description.ElementDesc elemField = new org.apache.axis.description.ElementDesc();
    elemField.setFieldName("prefix");
    elemField.setXmlName(new javax.xml.namespace.QName("", "prefix"));
    elemField.setXmlType(new javax.xml.namespace.QName("http://www.w3.org/2001/XMLSchema", "string"));
    elemField.setNillable(false);
    typeDesc.addFieldDesc(elemField);
} 
```

只需将 nillable 的值更改为 true ，如下所示：

```
elemField.setNillable(true); 
```

如果它们与您的 WSDL 中的相应值不匹配（即根据您的 WSDL 的定义，它们可以为空），您应该对所有类和这些类的所有字段重复此操作。

我注意到 Apache Axis 1.2 - 1.4 默认情况下会自动将属性设置为“nillable”。我不知道为什么会这样，但我认为这是解决方案。

# python - 在 Spring Integration 中调用非 Java 转换器

> ID：14217598
> 
> 赞同：0
> 
> 时间：2013-01-08T14:51:39.670
> 
> 标签：python, spring, groovy, spring-integration

我在一个 Spring 集成项目中工作，流程很简单。我从消息通道收到一条消息并将其转发到我自己的自定义编写的路由器。路由器根据消息类型和一些外部哈希映射值，通过通道将消息转发给转换器。一切，路由器和转换器都在 Java 中。现在我必须扩展我的项目，以便能够调用由非 Java 语言（如 ruby​​、python、groovy 等）编写的转换器。我已经看到这些语言中的非 Java 代码如何在 Spring 上下文中建模为 bean。但是，我不确定如何在 Spring Integration 中调用非 Java 转换器。任何指针或示例示例/代码都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:51:05.640

看一下`spring-integration-scripting`模块；例如...

```
<service-activator input-channel="referencedScriptInput">
    <script:script 
            lang="python"
            location="org/springframework/integration/scripting/config/jsr223/Jsr223ServiceActivatorTests.py">
        <script:variable name="foo" value="foo"/>
        <script:variable name="bar" value="bar"/>
        <script:variable name="date" ref="date"/>
    </script:script>
</service-activator> 
```

和

```
<transformer input-channel="referencedScriptInput">
    <script:script
    lang="ruby" 
    location="org/springframework/integration/scripting/config/jsr223/Jsr223TransformerTests.rb"/>
</transformer> 
```

文档在这里... [http://static.springsource.org/spring-integration/reference/html/messaging-endpoints-chapter.html#scripting](http://static.springsource.org/spring-integration/reference/html/messaging-endpoints-chapter.html#scripting)

# php - 每20秒执行一次php函数

> ID：14217601
> 
> 赞同：1
> 
> 时间：2013-01-08T14:51:41.723
> 
> 标签：php

我有一个 PHP 脚本来解析来自 JSON url 的实时分数，然后检查是否某些分数发生了变化，它调用另一个 php 脚本将通知推送到 IOS 设备。

我的问题是如何让第一个脚本每 20 秒运行一次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:53:34.830

这取决于您使用的主机操作系统。对于 linux/unix/等。调度任务的首选工具是[cron](http://en.wikipedia.org/wiki/Cron)。对于 Windows 或 Mac 或类似的东西，还有其他内置的调度程序。

使用 cron 来安排每分钟运行的任务可能如下所示：

```
* * * * * /path/to/command 
```

然而，粒度似乎只到了分钟。因此，如果没有更精细的任务调度程序，您可能需要在内部处理 20 秒的延迟。

一个想法可能是将任务包装在一个脚本中，该脚本运行命令，休眠 20 秒，再次运行命令，休眠 20 秒，然后再次运行命令。然后 cron 作业将调用该包装脚本。我的 bash 有点生疏，但这个想法看起来像这样：

```
/path/to/command
sleep 20
/path/to/command
sleep 20
/path/to/command 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-01T20:23:44.517

```
$total_time = 0;
$start_time = microtime(true);
while($total_time < 60)//run while less than a minute
  {
    //DoSomething;
    echo $total_time."\n";
    sleep(20);//wait amount in seconds
  $total_time =  microtime(true) - $start_time ;
  } 
```

将此添加到 cronjob 以每分钟运行一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T14:55:39.020

一般而言，a`cronjob`非常适合此类任务。看看这里：[http](http://www.thegeekstuff.com/2011/07/php-cron-job/)
://www.thegeekstuff.com/2011/07/php-cron-job/ 如果这不适用，您也许可以为 PHP CLI [http://php.net/编写脚本manual/en/features.commandline.php](http://php.net/manual/en/features.commandline.php)允许您无限运行。只需在其中放置一个带有 sleep() 的 while(true) 循环，然后使用 php 命令运行它`> php yourscript.php`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T14:55:25.147

也许你可以试试[睡觉](http://php.net/manual/ru/function.sleep.php)

```
while(1) {
    exec('php path/to/script.php');
    sleep(20);
} 
```

# java - java中的日期比较（字符串和日期）

> ID：14217604
> 
> 赞同：0
> 
> 时间：2013-01-08T14:51:47.370
> 
> 标签：java

如何在java中比较以下两个日期。我的情况是

```
 String dt1="2013/01/08";
  Date f=Calendar.getInstance().getTime();

  and how to add time(hh:mm:ss.ms) to the date string(i mean to dt1)eg. 2013/01/08 21:10:01.23 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T14:53:12.163

```
 String dt1="2013/01/08";
        Date f=Calendar.getInstance().getTime();
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy/MM/dd");
        System.out.println(sdf.parse(dt1).after(f)); 
```

*   使用 SimpleDateFormat 并将字符串格式化为 java.util.Date
*   使用 java.util.Date.after() 或 java.util.Date.before() 比较两个日期

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:55:56.003

您也可以使用[compareTo](http://docs.oracle.com/javase/6/docs/api/java/util/Date.html#compareTo%28java.util.Date%29)方法

```
 String dt1="2013/01/08";
    Date f=Calendar.getInstance().getTime();
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy/MM/dd");
    System.out.println(sdf.parse(dt1).compareTo(f); 
```

# backbone.js - 使用钛合金从外部 XML 中获取数据

> ID：14217609
> 
> 赞同：1
> 
> 时间：2013-01-08T14:51:56.930
> 
> 标签：backbone.js, collections, xmlhttprequest, titanium, appcelerator-mobile

我正在开发我的第一个使用 Appcelerator Titanium 制作的 iPhone 应用程序。我正在使用合金框架。

我只有一般的 JavaScript 背景。我已经阅读了 BackboneJS 是如何工作的，但是我正在为这个概念而苦苦挣扎。

该应用程序非常基础，我只需要获取一个包含 XML 响应的 URL。示例：[http ://www.domain.com/api.php?listProducts](http://www.domain.com/api.php?listProducts)

此 URL 将响应类似这样的内容

```
<response>
<request>
<timestamp id="0.66266400 1357656226"/>
<status id="100">OK</status>
</request>
<api_function>getproductsimage</api_function>
<products>
<product id="1">
<images>
<image name="featured" width="640" height="347" src="../html/productImages/featured.jpg"/>
<image name="nonretina" width="125" height="95" src="../html/productImages/thumbnail.jpg"/>
<image name="retina" width="250" height="190" src="../html/productImages/thumbnail.jpg"/>
<image name="ldpi" width="" height="" src=""/>
<image name="mdpi" width="" height="" src=""/>
<image name="hdpi" width="" height="" src=""/>
<image name="xhdpi" width="" height="" src=""/>
</images>
</product>
</product>
</products>
</response> 
```

我想在 TableView 中处理这些数据，显然会有不止一个响应。但是，我并不真正了解有关在 BackboneJS 中制作 XHR 的文档。谁能帮我制作一个简单的集合/模型来简单地获取这个 URL 并显示数据。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:49:23.143

is 纯粹是一个[backbonejs 模型解析](http://backbonejs.org/#Model-parse)问题，因为backbone 使用JSON 响应并且您正在查看返回XML。

不需要您使用 Alloy 模型来解决此问题，因此您可以使用 http 请求实现您的解决方案并自己填充对象。

# javascript - $(this).find(..) 替代

> ID：14217612
> 
> 赞同：1
> 
> 时间：2013-01-08T14:52:06.327
> 
> 标签：javascript, jquery, html

我发现自己在这样做，但不确定这是否是最好的方法。这里举个例子。

```
<ul id="menubar">
  <li><a class="menu_item">File</a>
    <ul>
      <li><a id="menu_file_new">New</a></li>
      <li><a id="menu_file_open">Open</a></li>
    </ul>
  </li>
  <li><a class="menu_item">Run</a>
    <ul>
      <li><a id="menu_run_preview">Preview</a></li>
      <li><a id="menu_run_compile">Compile</a></li>
    </ul>
  </li>
</ul> 
```

jQuery

```
$('.menu_item').hover(function(){
    $(this).find('ul').show();
}); 
```

只是想知道这是最好的方法吗， find 似乎有点矫枉过正？

* * *

**编辑：我不能使用 css 因为这个：当一个项目被单击/悬停时在 Opera/IE 中失败它在这两个浏览器中失败。[http://jsfiddle.net/cJsn2/1/](http://jsfiddle.net/cJsn2/1/)这是因为 html 标准。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:55:36.447

您只能使用 CSS 执行此操作

```
.menu_item ul { display: none; }
.menu_item:hover ul {display: block; } 
```

至于JavaScript，没关系，你可以用$.children 代替$.find 来遍历更少的节点

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:12:08.753

这将是一个简单的悬停脚本：

```
// I'm purposely using `toggleClass`, instead of show/hide, to
// have more flexibility with styling
$('.menu_item').each(function () {
  var $li = $(this).closest('li');

  $(this).hover(function () {
    $li.toggleClass('hover');
  });
}); 
```

使用以下CSS：

```
ul ul {
  display: none;
}

li.hover > ul {
  display: block;
} 
```

演示：http: [//jsbin.com/ehifod/1/](http://jsbin.com/ehifod/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T15:01:21.867

尝试仅使用 css 执行此操作

问题是你要在 *li*上 而不是在 *a上应用“悬停”*

```
#menubar li ul{ 
  display:none; 
}

#menubar li:hover > ul{ 
  display:block; 
} 
```

[jsfiddle >](http://jsfiddle.net/xpwUa/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T14:55:34.590

你想用的是[最接近的](http://api.jquery.com/closest/)。它沿着 DOM 树向上移动以找到匹配选择器的第一个父元素：

 ~~~~```
$('.menu_item').hover(function(){
    $(this).closest('ul').show();
}); 
```~~  ~~```
$(".menu_item").hover(function() {
    $(this).next().show();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T14:55:20.893

您可以使用 CSS（这是假设`ul`元素包含在`.menu_item`元素中）：

```
.menu_item:hover > ul {
   display: block;
} 
```

演示：http: [//jsfiddle.net/maniator/cJsn2/](http://jsfiddle.net/maniator/cJsn2/)

使用以下 HTML：

```
<ul id="menubar">
  <li class="menu_item"><a>File</a>
    <ul>
      <li><a id="menu_file_new">New</a></li>
      <li><a id="menu_file_open">Open</a></li>
    </ul>
  </li>
  <li class="menu_item"><a>Run</a>
    <ul>
      <li><a id="menu_run_preview">Preview</a></li>
      <li><a id="menu_run_compile">Compile</a></li>
    </ul>
  </li>
</ul> 
```~~~~

# openedge - Progress DB 9.1 和 9.1D 何时发布？

> ID：14217615
> 
> 赞同：0
> 
> 时间：2013-01-08T14:52:16.927
> 
> 标签：openedge, progress-db

我有一个我管理的旧应用程序，它运行在进度数据库之上。出于各种原因，我正在尝试收集一些信息。至少，我需要知道 Progress 9.1 和 9.1D 何时发布。我提到这两个版本是因为我们使用的是 9.1D，而且我认为“D”版本可能只是自 9.1 初始版本以来矿工更新的第四次迭代。

理想情况下，我想找到一个指向 Progress DB 更改日志的源链接。但是，这里通常不接受有关文档的问题。相反，我要求提供这些版本的发布日期，并要求您提供我可以进一步探索的来源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:50:58.960

9.1A 是 1999 年，9.1D 是 2002 年。

9.1E SP04 是版本 9 的最后一个版本，于 2004 年发布。

在版本 10 中，产品名称更改为“OpenEdge”。谷歌比“进步”更容易；）

如果您确实安装了给定的 Progress 版本，您可以查看“版本”文件。它会告诉你构建日期是什么。

总体思路：[http ://www.oehive.org/VersionHistory](http://www.oehive.org/VersionHistory)

# ruby - 通过从 VIM 会话中捕获 bash 脚本来获取输入

> ID：14217617
> 
> 赞同：0
> 
> 时间：2013-01-08T14:52:21.017
> 
> 标签：ruby, vim

我正在创建一个新的 CLI 应用程序，我想从用户那里获得一些敏感的输入。因为，这个输入可能非常具有描述性，而且信息有点敏感，我想让用户从这个应用程序输入这样的命令：

```
app new entry 
```

之后，我想为用户提供一个 VIM 会话，他可以在其中编写此描述性输入，当他退出此 VIM 会话时，它将被我的脚本捕获并用于进一步处理。

有人可以告诉我一种方法（可能是一些隐藏的 VIM 功能 - 因为，我总是对它们感到惊讶）以便我可以这样做，而无需创建任何临时文件？正如下面评论中所解释的，我更喜欢内存中的文件，因为信息可能有点敏感，因此，我想先通过我的脚本处理它，然后只将它写入磁盘一种加密方式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T15:39:12.517

Git 实际上是这样做的：当你输入 时`git commit`，会创建一个新的 Vim 实例，并在这个实例中使用一个临时文件。在那个文件中，你输入你的提交信息

一旦 Vim 再次关闭，临时文件的内容就会被 Git 读取和使用。之后，临时文件再次被删除。

所以，要得到你想要的，你需要以下步骤：

*   创建一个唯一的临时文件（[创建一个临时文件而不在 Ruby 中打开它](https://stackoverflow.com/questions/6437655/create-a-tempfile-without-opening-it-in-ruby)）
*   在该文件上打开 Vim（[Ruby，exec、system 和 %x() 或反引号之间的差异](https://stackoverflow.com/questions/6338908/ruby-difference-between-exec-system-and-x-or-backticks)）
*   等到 Vim 再次终止（也包含在上面的 SO 线程中）
*   读取临时文件（[如何使用 Ruby 读取文件？](https://stackoverflow.com/questions/7157207/how-can-i-read-file-with-ruby)）
*   删除临时文件（[在 ruby​​ 中删除文件](https://stackoverflow.com/questions/6553392/deleting-files-in-ruby)）

而已。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T20:59:27.803

您可以让 shell 创建附加到您的函数的文件描述符并让 vim 在那里写入，如下所示：（但您需要将脚本分成两部分：一个调用 vim，另一个处理其输入）：

```
# First script
…
vim --cmd $'aug ScriptForbidReading\nau BufReadCmd /proc/self/fd/* :' --cmd 'aug END' >(second-script) 
```

. 笔记：

1.  `second-script`实际上可能是第一个脚本中定义的函数（至少在 zsh 中）。这也需要 bash 或 zsh（仅在后者上测试）。
2.  需要 *nix，可能不适用于某些被认为是 *nix 的操作系统。
3.  `BufReadCmd`需要，因为 vim 在尝试读取只写描述符时挂起。
4.  建议您立即设置文件类型（如果需要），而不使用 ftdetect 插件：以防您的脚本不是唯一使用此方法的脚本。
5.  Zsh 将等待`second-script`完成，因此您可以在 vim 命令之后继续执行脚本，以防`second-script`不需要来自那里的信息（很难从那里获得）。
6.  第二个脚本将从子shell 启动。`vim`因此，在调用后运行的代码中不会看到任何变量修改。
7.  第二个脚本将接收 vim 在标准输入上保存的任何内容。父标准输入不能直接访问，但使用`</dev/tty`可能会起作用。

* * *

这适用于 zsh/bash 脚本。没有什么能真正阻止您在 ruby​​ 中使用相同的想法（它可能更方便并且不需要拆分为两个脚本），但我对 ruby​​ 的了解不足以说明如何在 ruby​​ 中创建文件描述符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T02:46:59.263

为此使用 vim 似乎有点矫枉过正。

`highline`红宝石宝石可能会满足您的需求：

```
require 'highline'
irb> pw = HighLine.new.ask('info: ') {|q| q.echo = false }
info: 
=> "abc" 
```

当您设置`echo`为时，不会显示用户的文本`false`。

这也比创建文件然后删除它更安全，因为您必须确保删除是安全的（用随机数据多次覆盖文件，使其无法恢复；请参阅`shred`或`srm`实用程序）。

# statistics - 模型比较中的 AIC 值

> ID：14217619
> 
> 赞同：1
> 
> 时间：2013-01-08T14:52:22.017
> 
> 标签：statistics, model-comparison

我正在使用 AIC 比较两个模型。但是，我意识到两个 AIC 值都太小（-4752.66，另一个接近）。我想知道这是正常的还是我在计算时做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-03T12:16:20.733

可以有负的 aic 值！（参考[https://stats.stackexchange.com/questions/84076/negative-values-for-aic-in-general-mixed-model](https://stats.stackexchange.com/questions/84076/negative-values-for-aic-in-general-mixed-model)）

由于这些值彼此过于接近，因此您可以选择 delta 较小的值。如果两个 deltas 都小于 2，则查找 evidence ratio 。证据比小于 2.7 表明展位模型很好 ->（“比较模型”的搜索： http: [//theses.ulaval.ca/archimede/fichiers/21842/apa.html#d0e5831](http://theses.ulaval.ca/archimede/fichiers/21842/apa.html#d0e5831)）。

如果这是您的情况，您可以使用模型平均->（Symonds、Matthew RE 和 Adnan Moussalli。“使用 Akaike 的信息标准在行为生态学中进行模型选择、多模型推理和模型平均的简要指南。”行为生态学和社会生物学 65.1 （2011）：13-21。）

# javascript - 使用“隐藏”iframe 上传文件在资源管理器中不起作用

> ID：14217620
> 
> 赞同：0
> 
> 时间：2013-01-08T14:52:23.827
> 
> 标签：javascript, jquery, internet-explorer, iframe

我有这个表格html：

```
<form id="testForm" method="post" action="upload.php" target="upload_target" enctype="multipart/form-data" style="margin-bottom:0;">
    <textarea name="infoText"></textarea>
    <input id="file-input" name="bid-file" type="file" style="visibility:hidden;">
    <input type="submit" id="submitBtnFile" style="visibility:hidden;">
</form>
<button id="#submitBtn">Submit</button>

<iframe id="upload_target" name="upload_target" src="#" style="width:0;height:0;border:0px solid #fff;"></iframe> 
```

我的js是：

```
$('#submitBid').click( function(){
    $('#objectCommentsSubmit').trigger('click');
    $('#submitBtnFile').trigger('click');
    $('.loading-bid').show();
}); 
```

这适用于 Safari、Firefox 和 Chrome，但不适用于 IE！

谁能告诉我我在 IE 上做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:58:41.367

尝试改变

```
$('#submitBtnFile').trigger('click'); 
```

至

```
$("#testForm").submit(); 
```

# memory-leaks - CLR 2.0 内存泄漏：卸载时无法释放 COM 对象

> ID：14217623
> 
> 赞同：0
> 
> 时间：2013-01-08T14:52:33.540
> 
> 标签：memory-leaks, clr, com-interop, managed-c++

我在 CLR 2.0 中遇到了一个在 CLR 4.0 中解决的错误。当跨 .NET COM 互操作传递数组并生成 COM 异常 (E_FAIL) 时会发生这种情况。如何重现此错误的详细信息如下。

我的问题是强制我们的客户升级到 .NET 4.0 会非常困难，所以我想实现一个解决方法。如果我知道错误已经发生，我可以通过调用 obj->Release 来做到这一点，但如果有任何误报的机会，这显然是危险的。

所以问题是：这个错误的规格是什么，我是否可以准确地识别它？

我找到了 4.0.1、4.0.2 和 4.0.3 的 .NET 发行说明，但没有提到该错误。从 2.0 到 4.0 的 CLR 转换中一定有一个重要的变更列表，我猜这不是公开的？

显然，下面的代码本身没有什么意义，但它是我可以基于相当大、复杂的解决方案提炼的问题的最简单再现。

提前感谢您的观看，

R

**重要编辑**

不幸的是，我回来尝试进一步调查，可能下面的代码实际上并没有重现该错误，这将令人失望。但是，在实际应用中，内存泄漏是显而易见的。如果有人感兴趣并且我有时间，我会尝试提供一个有效的示例。

**代码概述**

我有一个 .NET 应用程序 ConsoleApp.exe，虽然原来是 F#，但这里用 C# 复制。ConsoleApp.exe 调用托管程序集 managed.AComObject.dll，它公开了一个 COM 对象 AComObject。AComObject.get_TheObject() 返回一个指向智能指针 ASmartPtr 的 VARIANT*，它允许我重写 AddRef 和 Release 方法以观察对对象持有的引用。

在启用非托管代码调试的情况下运行 ConsoleApp.exe 时，我可以在 SmartPtr 上看到引用计数。我通过调整 ConsoleApp.exe.config 中的 supportedRuntime 属性来更改 CLR，结果如下：

*   v4.0 显示“DEBUGMSG::ASmartPtr::Release:0”，此时 SmartPtr 被删除。
*   v2.0.50727 在退出之前显示“DEBUGMSG::ASmartPtr::Release:1”，这是一个泄漏。

我包含了我认为相关的代码，但如果需要更多，请大喊；COM 需要大量样板代码...！

**控制台应用程序**

```
using managed.AComObject;
using System;

public static class Program
{
    public static void Main()
    {
        AComObject an_obj = new AComObject();
        object[] pData = new object[] { 1 };
        object a_val = an_obj.get_TheObject(0, pData);
        object[] pData2 = new object[] { a_val };

        try
        {
            object obj3 = an_obj.get_TheObject(1, pData2);
        }
        catch (System.Exception)
        {
            // Makes no diff whether it's caught - still does not clean
        }
    }
} 
```

**AComObject.dll**

*AComObject.idl*

```
interface IAComObject : IDispatch
{
    [propget, id(1), helpstring("")] HRESULT DllName([out, retval] BSTR* pName);
    [propget, id(2), helpstring("")] HRESULT TheObject([in] LONG count, [in, size_is(count)] VARIANT* pData, [out, retval] VARIANT* pObject);
};

[...]    
library AComObjectLib
{
    importlib("stdole2.tlb");

    // Class information
    [...]
    coclass AComObject
    {
        [default] interface IAComObject;
    };
}; 
```

AComObject.h

```
[...]

class ATL_NO_VTABLE CAComObject :
    public CComObjectRootEx<CComSingleThreadModel>,
    public CComCoClass<CAComObject, &CLSID_AComObject>,
    public IDispatchImpl<IAComObject, &IID_IAComObject, &LIBID_AComObjectLib, /*wMajor =*/ 1, /*wMinor =*/ 0>
{
public:
DECLARE_REGISTRY_RESOURCEID(IDR_ACOMOBJECT)

BEGIN_COM_MAP(CAComObject)
    COM_INTERFACE_ENTRY2(IDispatch, IAComObject)
    COM_INTERFACE_ENTRY(IAComObject)
END_COM_MAP()

public:
    CAComObject();

    virtual /* [helpstring][propget] */ HRESULT STDMETHODCALLTYPE get_DllName(
            /* [retval][out] */ BSTR* pName);

    virtual /* [helpstring][propget] */ HRESULT STDMETHODCALLTYPE get_TheObject(
            /* [in] */ LONG count,
            /* [in, size_is(count)] */ VARIANT* pData,
            /* [retval][out] */ VARIANT* pObject);
};

OBJECT_ENTRY_AUTO(CLSID_AComObject, CAComObject) 
```

*AComObject.cpp*

```
class ASmartPtr : public IUnknown
{
    int m_RC;

    void DebugMsg(std::string msg)
    {
        std::stringstream _msg;
        _msg << ".\nDEBUGMSG::ASmartPtr::" << msg << "\n";
        OutputDebugStringA(_msg.str().c_str());
    }
public:
    ASmartPtr()
        : m_RC(1)
    {
        DebugMsg(std::string("Created"));
    }

    virtual ULONG STDMETHODCALLTYPE AddRef() 
    {
        ULONG refcnt = ++m_RC;
        std::stringstream msg;
        msg << "AddRef:" << refcnt;
        DebugMsg(msg.str());
        return refcnt;
    }

    virtual ULONG STDMETHODCALLTYPE Release() 
    {
        ULONG refcnt = --m_RC;
        std::stringstream msg;
        msg << "Release:" << refcnt;
        DebugMsg(msg.str());
        if (m_RC == 0)
            delete this;
        return refcnt;
    }

    HRESULT STDMETHODCALLTYPE QueryInterface(REFIID iid, void** ppvObj)
    {
        if (!ppvObj) return E_POINTER;

        if (iid == IID_IUnknown)
        {
            *ppvObj = this;
            AddRef();
            return NOERROR;
        }
        return E_NOINTERFACE;
    }
};

[...]

STDMETHODIMP CAComObject::get_TheObject(LONG count, VARIANT* pData, VARIANT* pObject)
{
    if (count == 1)
        return E_FAIL;

    CComVariant res;
    res.punkVal = new ASmartPtr();
    res.vt = VT_UNKNOWN;

    res.Detach(pObject);

    return S_OK;
} 
```

**managed.AComObject.dll**

这是从具有以下构建后事件的 COM 对象组装而成的，以允许将数组传递给 get_TheObject() 而不是引用。

*批处理文件*

```
call "C:\Program Files (x86)\Microsoft Visual Studio 9.0\Common7\Tools\vsvars32.bat"

echo "f" | xcopy /L/D/Y ..\Debug\AComObject.dll  managed.AComObject.dll | find "AComObject" > nul
if not errorlevel 1 (
    tlbimp   ..\Debug\AComObject.dll /primary /keyfile:..\piakey.snk /out:managed.AComObject.dll
  ildasm managed.AComObject.dll /out:managed.AComObject.raw.il
  perl -p oneliner.pl < managed.AComObject.raw.il > managed.AComObject.il
  ilasm managed.AComObject.il /dll /key=..\piakey.snk
)
set errorlevel=0
exit 0 
```

*oneliner.pl*

```
$a = 1 if (/TheObject\(/);if ($a){s/object&/object\[\]/; s/marshal\( struct\) pData/marshal\( \[\]\) pData/; $a++; $a&=3;} 
```

这只是改变了 IL：

```
[in] object&  marshal( struct) pData) runtime managed internalcall 
```

至

```
[in] object[]  marshal( []) pData) runtime managed internalcall 
```

**一些附加信息**

在考虑我对汉斯评论的回应时，我意识到缺少一些相关信息。

如果没有抛出异常（即 E_FAIL 更改为 S_OK），则没有泄漏。在 S_OK 情况下，我们可以看到对象引用计数返回 1，因为我们将 .NET COM 互操作返回到 ConsoleApp.exe。在 E_FAIL 情况下，引用计数保持在 2。在这两种情况下，我们都可以观察到终结器在应用程序终止时再次减少引用计数（并在 S_OK 情况下观察对象析构函数），但在 E_FAIL 情况下，这仍然会留下refcount 为 1，因此对象被泄漏。在 CLR 4.0 中，所有行为都符合预期（即，即使在 E_FAIL 情况下，refcount 在传递回 ConsoleApp.exe 时也会返回 1）。

我们正在考虑升级到 CLR 4.0 以解决此泄漏，但这并非完全无关紧要，因为它以不同的方式处理 COM 包装的托管 DLL，这对我们的一些客户来说是一个重大变化。如果有办法让我准确识别出这个错误，我们可以避免升级痛苦的时间更长一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:32:02.340

最后，解决方案相当简单，我们无需升级就可以继续进行。这是向 application.exe.config 添加supportedRuntime 和附加属性的老技巧：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0" />
  </startup>
</configuration> 
```

如果没有该属性，.NET2 代码会并行加载到 CLR2 中，因此我们会遭受泄漏。该属性允许将 .NET2 代码直接加载到 CLR4 中，从而避免泄漏。这里有对该属性的详细评论：http: [//www.marklio.com/marklio/PermaLink,guid,ecc34c3c-be44-4422-86b7-900900e451f9.aspx](http://www.marklio.com/marklio/PermaLink,guid,ecc34c3c-be44-4422-86b7-900900e451f9.aspx)。

不幸的是，对于任何使用具有这种配置的应用程序的人来说，内存泄漏仍然存在，但这暂时就足够了。

# php - MySQL全文索引搜索mysql_num_rows返回1

> ID：14217624
> 
> 赞同：0
> 
> 时间：2013-01-08T14:52:34.987
> 
> 标签：php, mysql, full-text-search, mysql-num-rows

下面更正！

我用这个简单的 SQL 问题在一个相当大的表中搜索匹配项：

```
$result = mysql_query("SELECT *, MATCH(foretag, stad) AGAINST('$query') AS r FROM tblforetag WHERE MATCH(foretag, stad) AGAINST('$query')"); 
```

...但`mysql_num_rows($result)`总是返回 1。我在 HeidiSQL 中尝试了完全相同的查询（与 $query 具有相同的值），它返回了 45 个结果。任何线索如何摆脱这个问题？

更正：事实证明，计数不是问题。这只会在 PHP 页面上返回一个结果，但不会在直接在 MySQL 提示符或 HeidiSQL 中执行时（本质上是相同的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:25:07.647

问题是编码。自从我在“ping”上找到比赛后，我才意识到这一点。我通过使用解决了这个问题`utf8_decode()`。

# python - Python：在元组的元组中处理子元组？

> ID：14217631
> 
> 赞同：1
> 
> 时间：2013-01-08T14:52:49.263
> 
> 标签：python, mysql, database

嗨！作为一个完整的python初学者，我想知道如何在一个元组的元组中获取一个元组元素——即结果

```
results=cursor.fetchall() 
```

给出一个元组

```
((row1_value1,row1_value2,...),(row2_value1,row2_value2..),) 
```

我知道

```
for id in results:
    print id 
```

或者

```
results [i] 
```

作为一个整体访问每一行。

但是我如何直接访问元组 - 元组内的值，即 row2_value3 ???

我帮助自己编写了以下代码，但是否有可能给出确切的“地址”，例如 results [i,sub-i] ？

```
for id in results:
    a=results[i]
    i=0
    for x in a:
        print a[i]
        i+=1 
```

我想使用 fetchall，只是为了学习如何在 python 中做事——我想在 python 中拥有整个数据库并使用它。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:54:36.530

```
results[0][1] 
```

从第一 (0) 行访问第二 (1) 元素（`row1_value2`在您的情况下）。Python 中的列表是 0 索引的。

同样的方法`row2_value3`是`results[1][2]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:54:40.620

你可以这样做`results[row][field]`。

# php - 如何根据时间在 td 中定位 div 看起来像谷歌日历

> ID：14217632
> 
> 赞同：0
> 
> 时间：2013-01-08T14:52:48.900
> 
> 标签：php, jquery, css, css-position

HTML

```
<td time='10:00 AM'>
<span timeStart="00" timeEnd="10" class="entry deletable">Entery 1 from 10:00-10:15</span>
<span timeStart="15" timeEnd="30" class="entry deletable">Entery 2</span>
</td> 
```

这是 td 如何在我的 jquery/php 日历中查看的示例。

我的问题是

1.  我怎样才能根据时间开始和时间结束使这些跨度的Css位置和设置高度，以及如何避免重叠？
2.  我应该还是不应该在 html 中包含 timeStart 和 end ？我可以在 php 上动态设置样式，这将是一种更清洁的方式！

* * *

我想我没有说清楚。

这是我到目前为止尝试过的重量

html

```
<td style='width:60px;'>
<div style="position:relative">
<span style="position:absolute;top:00px;" title="Time:10:00 AM">demo patient</span>
<span style="position:absolute;top:40px;" title="Time:10:20 AM">new patient</span>
</div>
</td> 
```

PHP用来生成这个

```
echo"<span style='position:absolute;top:".
date("i", strtotime($data['time_booked']))."px;' title='{$data['time_booked']}'>{$data['name']}</span>"; 
```

现在我可以根据需要定位跨度，唯一的问题是如果 2 个预订同时进行，它们重叠，我该如何避免这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:24:36.460

试试这个。它利用数据属性来确定要使用多大的块。我还将您的跨度更改为 div，如果您需要它们内联块，您可以相应地更改 css。[jsFiddle 示例](http://jsfiddle.net/rUu3p/)

**HTML**

```
<table>
  <tr>
    <td time='10:00 AM'>
      <div data-time-start="00" data-time-end="15" class="entry deletable">Entry 1 from 10:00-10:15</div>
      <div data-time-start="15" data-time-end="45" class="entry deletable">Entry 2 from 10:15-10:45</div>
      <div data-time-start="45" data-time-end="60" class="entry deletable">Entry 3 from 10:45-11:00</div>
    </td>
  </tr>
</table> 
```

**CSS**

```
.entry{
  border-top:1px solid #000;
  background:#bad;
} 
```

**jQuery**

```
$('.entry').each(function (i) {
  var $this = $(this);
  timestart = $this.data('time-start'),
  timeend = $this.data('time-end');

  $this.height(timeend - timestart);
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-08T15:09:15.407

为什么不直接去谷歌的日历。下载 html + 样式表，并使用您最喜欢的代码编辑器来研究他们是如何做到的？

# asp.net-mvc - 多个 AJAX 调用和 DbContext

> ID：14217633
> 
> 赞同：0
> 
> 时间：2013-01-08T14:52:50.553
> 
> 标签：asp.net-mvc, dbcontext

我和我的团队建立了一个动态网站，可以跟踪客户的各种不同信息。当从网格中选择用户时，会对各种方法进行多次 ajax 调用，每个方法都会获得一个新的 DbContext 实例。

```
 public JsonResult GetPaymentInfo(int id = 0)
    {
        var paymentInfo = new PaymentInfo();
        using (var data = new DashboardModels())
        {
            paymentInfo = data.PaymentInfo.Where(p => p.AccountId == id).AsNoTracking().FirstOrDefault();
        }
        return Json(JsonResponseFactory.SuccessResponse(paymentInfo), JsonRequestBehavior.DenyGet);
    } 
```

与此类似。

与 DbContext 相关的异步触发这些方法的推荐方法是什么（因为它们都将 Json 数据返回到各自的 jQuery Ajax 调用）？我应该与单个事务共享相同的 DbContext 吗？如果是这样，有人可以帮助我朝这个方向前进吗？

# java - 所有双精度的Java总和不返回预期结果

> ID：14217636
> 
> 赞同：4
> 
> 时间：2013-01-08T14:53:09.740
> 
> 标签：java, sum, double, floating-accuracy, decimalformat

> **可能重复：**
> [将小数位移动到双精度](https://stackoverflow.com/questions/4937402/moving-decimal-places-over-in-a-double)

为什么下面的数字总和不等于`0.4622`？但`0.46219999999999994`

```
Double total = new Double(0.08) + new Double(0.0491) + new Double(0.3218) + 
         new Double(0.0113) + new Double(0.0); // = 0.46219999999999994 
```

我有一个检查用户输入的应用程序。

用户输入 5 个十进制数字和一个总数。应用程序检查所有 5 个数字的总和，以 4 位小数为上限，在 komma 后面是否等于总数。

封顶它给了我`0.4621`不等于`0.4622`. 我不能使用 DecimalFormat 因为它会四舍五入。如果我明确地说，向下取整，那么在这种情况下它将失败。

关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-08T14:56:08.303

尝试使用`java.math.BigDecimal`. 双轮结果。您只需要使用`add`方法，而不是 + 运算符。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-08T14:56:56.110

如果需要准确的答案，请避免使用 float 和 double -- **Item 48** -- **Effective Java Second edition**

改为使用`BigDecimal`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-08T14:57:01.183

看起来像是**浮点运算**的经典案例。如果您想要精确计算，请使用`java.math.BigDecimal`. 看看[每个计算机科学家应该知道的关于浮点运算的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-08T15:00:54.867

当您使用浮点运算时，您还必须使用适当的舍入。

顺便说一句：当原语可以使用时，不要使用对象。

```
double total = 0.08 + 0.0491 + 0.3218 + 0.0113 + 0.0;
System.out.printf("%.4f%n", total);

double rounded = Math.round(total * 1e4) / 1e4;
if (rounded == 0.4622)
    System.out.println("rounded matched"); 
```

印刷

```
0.4622
rounded matched 
```

正如预期的那样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-08T14:57:20.857

浮点表示是一个近似值，因此当您使用 float 和 double 时，您会遇到这些小的舍入误差。例如，如果您尝试将 0.08 转换为二进制，您将意识到您实际上无法完全做到这一点。每当您在计算中使用 double 和 float 时，都需要考虑这一点。

0.08 [10] = 0.00010100011110101110... [2]

一个重复的模式。因此，无论您使用多少位，都会产生舍入误差。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-08T15:00:59.173

Java 中的 Double 和 float 在内部表示为二进制分数，因此在表示十进制分数时可能不精确（IEEE 标准 754）。如果您的十进制数计算需要精度，请使用[Java.math.BigDecimal](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-08T14:56:06.433

这又是一个四舍五入的问题。你永远不应该比较双打并期望它们完全相等。而是定义一个小epsylon，并期望结果在预期答案的epsylon内。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-08T14:57:11.977

任何浮点值都是不精确的。解决方案**是**在必须显示值时使用[DecimalFormat 。](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/DecimalFormat.html)不，它不会四舍五入，而是最接近的值。

从 javadoc ：

> DecimalFormat 使用半偶数舍入（请参阅 ROUND_HALF_EVEN）进行格式化。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-08T14:57:37.030

像 Double 这样的浮点数的内部表示从来都不是一个精确的表示。这就是为什么在计算过程中会出现此类错误的原因。

始终建议将此类结果格式化为逗号后的特定位数，因此您的结果将正确显示为具有 4 到 15 位或更多位数的“0.4622”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-08T15:00:09.207

也许直接检查字符串输入对您来说更可行。即检查小数点后字符的长度。

# java - 在 jsf 页面中随帖子显示重音

> ID：14217646
> 
> 赞同：1
> 
> 时间：2013-01-08T14:53:35.800
> 
> 标签：java, jsf, encoding

> **可能重复：**
> [JSF 中的 UTF-8 表单提交正在破坏数据](https://stackoverflow.com/questions/10721342/utf-8-form-submit-in-jsf-is-corrupting-data)

这是我写的代码

```
 <?xml version='1.0' encoding='ISO-8859-1' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    </head>
    <body>

        <ui:composition template="../WEB-INF/templates/template.xhtml">

            <ui:define name="titleHeader">
                <h:outputText value="#{bundles.messages['message.NouveauClient']}" styleClass="titreContainer"/>
            </ui:define>

            <ui:define name="content">
                <p:growl  autoUpdate="true"/>
                <h:form>
                    <h:panelGrid columns="1" width="100%" columnClasses="top1,top2">
                        <h:panelGrid columns="2" width="80%">
                            <h:outputText value="#{bundles.messages['message.NomClient']}"/>
                            <p:inputText value="#{clientController.client.nom}" required="true"/>
                            <h:outputText value="#{bundles.messages['message.honoraire']}"/>
                            <p:inputText value="#{clientController.client.honoraire}" required="true"/>
                        </h:panelGrid >
                        <p:commandButton action="#{clientController.newClient()}" value="Valider" ajax="false"/>
                    </h:panelGrid>
                </h:form>
            </ui:define>

        </ui:composition>
    </body>
</html> 
```

这是 newClient 的代码

```
 public String newClient() {
         serviceClient.create(getClient());
         message.info(new BundleKey("messages", "message.success"));
         return "lstClient";
    } 
```

问题是：当我放置一个名为 name 的客户端时，`zéro`它以 name 保存在数据库中 `zÃ©ro`。

谁能帮我找到解决这个问题的方法

# objective-c - 转换日期格式

> ID：14217650
> 
> 赞同：0
> 
> 时间：2013-01-08T14:53:44.353
> 
> 标签：objective-c, ios

如何将这种类型的日期格式转换为 yyyy-MM-dd HH:MM:ss 格式。

```
 "DATE_OF_JOINING":"\/Date(1349634600000+0530)\/" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:00:24.660

使用 NSDateFormatter。这将让您以多种不同的方式将其格式化，并将其格式化为字符串。

这是苹果对 iOS 类的参考： [https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T22:24:43.847

 我更喜欢扫描仪而不是正则表达式来从字符串中提取时间间隔

```
NSDictionary *dict = @{@"DATE_OF_JOINING" : @"Date(1357683534626+0530)"};

NSString *string = dict[@"DATE_OF_JOINING"];
NSString *intervalString;
NSString *offsetString;

NSScanner *scanner = [NSScanner scannerWithString:string];
[scanner setScanLocation:[string rangeOfString:@"("].location+1];
[scanner scanUpToCharactersFromSet:[NSCharacterSet characterSetWithCharactersInString:@"+-"] intoString:&intervalString];
[scanner scanUpToString:@")" intoString:&offsetString];

NSInteger hours = [[offsetString substringToIndex:3] integerValue];
NSInteger minutes = [[offsetString substringFromIndex:3] integerValue];
NSDateComponents *offsetComponents = [[NSDateComponents alloc] init];
offsetComponents.hour = hours;
offsetComponents.minute = minutes;

NSTimeInterval interval= [intervalString doubleValue];

NSDate *date = [NSDate dateWithTimeIntervalSince1970:interval/1000];

date = [[NSCalendar currentCalendar] dateByAddingComponents:offsetComponents toDate:date options:0];
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"yyyy-MM-dd HH:mm:ss"];
NSString *result = [formatter stringFromDate:date]; 
```

# javascript - Adobe Livecycle javascript 获取属性节点

> ID：14217666
> 
> 赞同：0
> 
> 时间：2013-01-08T14:54:45.267
> 
> 标签：javascript, pdf, livecycle

我有一个我正在 Livecycle Designer ES2 中设计的 PDF 模板。数据绑定是 XML Schema。对于其中一个字段，我需要使用一些格式绑定数据。例如：如果我的 XML（基于架构）如下：

```
<formElement xmlns:ns2="http://it.anas.pdm/anaspcm">
    <elementNode value="FCON" />
</formElement> 
```

如何访问该`value`属性？

我试过：

> xfa.data.formElement.elementNode.getAttribute("值");

但它不起作用。

你知道帮帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-20T13:28:48.717

通常这应该有效：

```
xfa.resolveNode("formElement.elementNode.value") 
```

# python - 从列表中获取分数近似值

> ID：14217667
> 
> 赞同：3
> 
> 时间：2013-01-08T14:54:45.270
> 
> 标签：python, list, matching

我刚刚开始使用 Python。

这是一个齿轮率计算器。

我有一个 367 到 7645373 范围内的 5000 个整数的列表和一个原始分数，它可以是 1/10 或 34561/43521 到 10/1。

我需要创建一个新分数，其值与原始分数接近，由表中存在的分子和分母组成。

事实上，我想要一个按与原始分数的偏差排序的匹配列表。

我有一个解决方案，但需要很长时间才能给出值为 1/10 的结果，因为 367/3670 或 368/3680 或 4352/43520 等解决方案是等效的。

Pythonist 会怎么做呢？

请不要告诉我这是 C 库的情况！:D

干杯
安东尼奥

```
def searcharatio(l, a):
    b = []
    mx = l[-1][0]
    ln = l[0][0]
    ld = l[0][0]
    i = max(int(ln/a.numerator-1), int(ld/a.denominator)-1)
    print i
    while 1:
        n = a.numerator * i
        d = a.denominator * i

        if n > mx or d > mx:
            return sorted(b)
        if n > 0.9*ln and d > 0.9*ld:
            # enumerate es lista 2 elem 0=num orden, 1=elemento
            ri = (min(enumerate(l), key=lambda x:abs(x[1][0]-n)))
            ro = (min(enumerate(l), key=lambda x:abs(x[1][0]-d)))
            ln = ri[1][0]
            ld = ro[1][0]

            e = [abs(1.0 - ((float(ln)/ld) / (float(n)/d))), i, ri, ro]
            b.append(e)
        i+=1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:26:16.190

Python 在迭代时往往很慢；使用 NumPy 的矢量化解决方案可能会更快。

```
def search_ratio(l, a):
    l = np.array(l)
    t = l.astype(float).reshape(-1, 1) / l.reshape(1, -1)
    i = np.unravel_index(np.argsort(np.where(t > a, t / a, a / t).flat), t.shape)
    return l[i[0]], l[i[1]] 
```

例如，`search_ratio(range(2, 6), 1.3)`将给出：

```
(array([4, 5, 3, 5, 2, 3, 4, 5, 4, 4, 3, 5, 2, 3, 2, 2]),
 array([3, 4, 2, 3, 2, 3, 4, 5, 2, 5, 4, 2, 3, 5, 4, 5])) 
```

是`4/3`最接近 1.3 的比率，`5/4`是下一个最接近的比率，等等。

请注意，`t`为了提高效率，可以缓存可用比率表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:43:03.327

```
from __future__ import division
import itertools

def searchratio(input_range):
    my_ratios=set()
    for x in itertools.combinations(input_range, 2):
        y=x[0]/x[1]
        if y==1/10 or (10/1>y>34561/43521):
            my_ratios.add(x)
    return my_ratios

if __name__=='__main__':
    from time import time
    t1=time()
    nk=len(searchratio(xrange(4000)))
    t2=time()
    print t2-t1, nk 
```

在蟒蛇中； pypy中的`4000`项目列表需要 6.5 秒；项目
列表需要 3.25 秒， 如果您想进一步减少它；您必须选择或将您的代码并行处理。简单的步骤就是在( ) 中运行您的代码；你可以立即看到时间减少。`4000`
`cython``ipython``pypy-c``https://pypy.org/``50%`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T14:22:04.507

我结束了使用 bisect 和排序列表。

```
import bisect
import random
import time
def searchratio(t,n,d):
  #n must be <= d if it's not he case swap ,and swap the results returned
  b=[]
  a=float(n)/d
  t0=t[0]
  x1=bisect.bisect(t,t0/a)
  print a,x1,t0
  lm=len(t)-2
  for ti in t[x1:lm]:
      x1=bisect.bisect_left(t,ti*a)
      b.append([t[x1],ti])
      b.append([t[x1+1],ti])
  b.sort(key = lambda x:abs(x[0]/float(x[1])-a))
  return b   

#-----test program--------------------------------------------------   
l=[random.randrange(100000,10000000) for i in xrange(100000)]
l.sort()
n=3
d=100
t=time.clock()
r=searchratio(l,n,d)
t=time.clock() - t
print t, len(r), float(n)/d 
for x in r:
    print x, x[0]/float(x[1]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T15:21:13.847

计算所有结果并在之后排序。

```
from collections import namedtuple
import random

fraction_target = 1 / 10.0
limit_left = fraction_target * 0.9
limit_right = fraction_target * 1.1

result = namedtuple('result', 'val1 val2 fraction')

values = [random.randint(367, 7645373) for _ in range(5000)]

fraction_results = []
for value_1 in values:
    for value_2 in values:
        fraction = value_1 / float(value_2)
        if limit_left < fraction < limit_right:
            fraction_results.append(result(value_1, value_2, fraction))

fraction_results.sort(key=lambda x: abs(x.fraction - fraction_target))

print(fraction_results[0:10]) 
```

我将存储的结果限制在所需分数的 90% 到 110% 之间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T09:23:55.027

由于此解决方案的局限性，我不确定这是否有帮助，但我仍然发布它，因为该理论至少非常适用于您的问题。

我假设您的列表只是一个数字列表。所以让我们先把它设为 a `set`，因为我们会反复检查成员资格，而使用 set 会更快：

```
integers = set(integers) 
```

现在，`fractions.Fractions`该类有一个名为 的漂亮方法[`limit_denominator`](http://docs.python.org/2/library/fractions.html#fractions.Fraction.limit_denominator)，它可能对您有所帮助。它基于[欧几里得算法](http://en.wikipedia.org/wiki/Euclidean_algorithm)，可用于构造任何实数的连[分数](http://en.wikipedia.org/wiki/Continued_fractions)。然后可以使用数字的连分数来构造具有给定分母约束的该数字的最佳有理近似值。

因此，要将其应用于您的问题，我们从`Fraction`您希望表示的开始，并`limit_denominator`以略低于前一个近似值的分母的极限重复调用，直到我们找到一个分子和分母都在 中的分数`integers`。由于较大的分母意味着更好的近似值，因此第一个匹配是最好的。

```
import fractions

def best_approximation(numerator, denominator, integers):
    min_int = min(integers)
    max_int = max(integers)
    org_frac = fractions.Fraction(numerator, denominator)
    if org_frac > 1:
        # the numerator is larger than the denominator, so our maximum 
        # denominator must be adjusted down accordingly, since we also
        # want the numerator to be below max_int
        curr_max = int(max_int / org_frac)
    else:
        curr_max = max_int
    while True:
        fr = org_frac.limit_denominator(max_int)
        if fr.numerator < min_int or fr.denominator < min_int:
            return None
        if fr.numerator in integers and fr.denominator in integers:
            return fr
        max_int = fr.denominator - 1 
```

我已经用一个整数列表测试了它，它只是 367 和 7645373 之间的质数，我得到了这个输出：

```
>>> print best_approximation(34561, 43521, integers)
4513/5683 
```

这仍然没有尽可能快，因为`limit_denominator`方法构建的内部结构可以被重用。您可以通过复制源代码并修改它来解决这个问题，或者使用维基百科文章从头开始实现算法。

我提到的限制是：使用这种方法可能找不到最佳近似值。如果整数列表太稀疏，这可能是个问题。在我的主要列表的特定情况下，使用从 7645373 到 17645373 的随机分子和分母，它只适用于大约一半的情况，这显然不够好。另一方面，当您得到答案时，您会知道这是一个非常好的近似值。

# c# - 迭代直到达到 int.MaxValue

> ID：14217671
> 
> 赞同：2
> 
> 时间：2013-01-08T14:54:50.247
> 
> 标签：c#, console-application

作为一个小测试，我想看看在 C# 控制台应用程序中计数到 int.MaxValue 需要多长时间。每隔几个小时，我就会检查一下进度。昨晚当我认为程序将执行完毕时，它正在执行回 0。我不确定为什么会发生这种情况，我想知道是否有人可以向我解释。它所做的是它计数到 2,147,483,647，然后当达到这个值时，它开始倒数到零。尽管它看起来是倒数，但该值是负数。我想知道是否需要使用 int.MaxValue 的绝对值。无论如何，我只是好奇是否有人能看到我没有看到的东西。这是我的代码。谢谢

```
static void Main(string[] args)
    {
        int maxInt = int.MaxValue;
        int numToCountTo = maxInt;
        //int numToCountTo = 1000000;

        try
        {
            Console.WriteLine(DateTime.Now);
            Console.WriteLine("Press any key to begin.");
            Console.ReadLine();

            Stopwatch sw = new Stopwatch();
            sw.Start();

            for (int counter=0; counter <=numToCountTo ; counter++)
            {

                Console.WriteLine(counter);

            }

            sw.Stop();
            TimeSpan ts = sw.Elapsed;

            // Format and display the TimeSpan value.
            string elapsedTime = String.Format("{0:00 Hours}, {1:00 Minutes}, {2:00 Seconds}, {3:00 Milliseconds}",
                ts.Hours, ts.Minutes, ts.Seconds,
                ts.Milliseconds / 10);

            // ("#,#") places a comma between every 3 digits
            Console.WriteLine("It took " + elapsedTime + " to count to " + numToCountTo.ToString("#,#"));
            Console.WriteLine("Press Enter key to continue.");
            Console.ReadLine();
        }
        catch (Exception ex)
        { 
            throw new Exception("Exception Reached: " + ex.Message)
        }
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-08T14:59:01.303

你的 for 循环：

```
for (int counter=0; counter <=numToCountTo ; counter++) 
```

是不正确的。它将在`counter <= int.MaxValue`始终为真时执行。当它增加时，它将滚动到`int.MinValue`并继续增加。

将其更改为

```
for (int counter=0; counter < numToCountTo ; counter++) 
```

或使用`long`你的循环计数器：

```
for (long counter=0; counter <= numToCountTo ; counter++) 
```

您还可以使用`do...while`循环，因为循环是在评估中断条件*之前执行的：*

```
int counter = 0;
do
{
   ...
   counter++;
}
while(counter < numToCountTo); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-08T14:58:26.450

它将继续，因为`counter`永远不会 > than `int.MaxValue`，如果你这样做`int.MaxValue+1`，它将结束`int.MinValue`。

因此，您的`for`条件始终为真。

我建议的另一种选择是为您的计数器使用更大的数据类型，例如`long`，或将循环更改为：

```
int counter = -1;
for(;;) // while(true)
{
    counter++;
    Console.WriteLine("{0}", counter);

    if (counter == int.MaxValue) 
    {
        break;
    } 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:58:39.323

这称为溢出 - 整数环绕到可能的最低负值。

如果你想让它停下来，`maxInt`你应该用 - 替换`<=`-`<`目前你永远不能停止循环，因为`counter`永远不可能更大`maxIni`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T15:00:55.663

当您将 1 添加到 an 时，`Int32.MaxValue`您最终会得到`Int32.MinValue`.

```
int a = Int32.MaxValue;
a++; // a is now -2147483648 
```

# php - Wordpress PHP 权限被拒绝错误

> ID：14217672
> 
> 赞同：1
> 
> 时间：2013-01-08T14:54:54.363
> 
> 标签：php, wordpress, permission-denied

我的所有网站页面都收到以下错误。

警告：session_start() [function.session-start]: open(/tmp/sess_110024a16996bb35c7f6d138127e6f13, O_RDWR) 失败：/home/summeybo/public_html/wp-content/themes/freely/admin/options.php 中的权限被拒绝 (13)在第 2 行

警告：session_start() [function.session-start]：无法发送会话缓存限制器 - 标头已发送（输出开始于 /home/summeybo/public_html/wp-content/themes/freely/admin/options.php:2） /home/summeybo/public_html/wp-content/themes/freely/admin/options.php 在第 2 行

警告：无法修改标头信息 - 标头已由 /home/summeybo/public_html/wp-login 中的（输出开始于 /home/summeybo/public_html/wp-content/themes/freely/admin/options.php:2）发送。第 368 行的 php

警告：无法修改标头信息 - 标头已由 /home/summeybo/public_html/wp-login 中的（输出开始于 /home/summeybo/public_html/wp-content/themes/freely/admin/options.php:2）发送。 php上线380

我什至尝试使用我们购买的主题进行全新安装，但没有成功。我还尝试更改 tmp 文件夹的权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:08:41.777

我也找到了问题，谢谢 好的，我解决了。感谢 Skatox 和 Igor。开发主题的绅士在主题的 admins 文件夹中的 options.php 文档的末尾省略了结尾？>。感谢你们！

# mysql - 多个 SUM 查询为 1 行

> ID：14217673
> 
> 赞同：0
> 
> 时间：2013-01-08T14:54:55.427
> 
> 标签：mysql

我正在使用以下 SQL 根据日期范围返回几个总和：

```
SELECT SUM(CASE WHEN omtr_date >= '2013-01-08 00:00:00' THEN omtr_page_view END) AS omtr_page_view,
       SUM(CASE WHEN omtr_date >= '2013-01-02 00:00:00' THEN omtr_page_view END) AS omtr_page_view 
FROM emb_visits; 
```

但它返回 2 行；使用`mysqli_fetch_array`(php) 它给了我 2 个数组，而不是 1 个包含 2 个值的数组。

是否可以将这 2 个结果分组为 1 行/数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:39:56.073

我可能会更改查询，以便您返回的每个列值具有不同的名称：

```
 SELECT 
      SUM(CASE WHEN omtr_date >= '2013-01-08 00:00:00' THEN omtr_page_view END) AS omtr_page_view_jan08,
      SUM(CASE WHEN omtr_date >= '2013-01-02 00:00:00' THEN omtr_page_view END) AS omtr_page_view_jan02
  FROM emb_visits; 
```

通过为每一列提供不同的别名，不会混淆值是什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:35:08.410

您是否尝试过使用其他表进行类似查询？我用我的一个数据库的一些表做了一个小例子，它给了我一个包含 2 列的单行结果。

以下是您可以同时使用的类似查询。我保证在找到您的查询的解决方案后编辑我的答案。

```
SELECT
     (SELECT SUM(omtr_page_view) FROM emb_visits WHERE omtr_date >= '2013-01-08 00:00:00'),
     (SELECT SUM(omtr_page_view) FROM emb_visits WHERE omtr_date >= '2013-01-02 00:00:00') 
```

# java - 使用 Java 和正则表达式修复路径

> ID：14217679
> 
> 赞同：0
> 
> 时间：2013-01-08T14:55:20.500
> 
> 标签：java, regex, string, path, string-parsing

我有一个这样的字符串（最后并不总是相同的*文件名*，这只是示例）

```
\\eabman03\edicom\Aterlasning\repstat.txt 
```

我想得到这个

```
\\eabman03\edicom\Aterlasning\ 
```

所以我想用Java去掉这个字符串末尾的*文件名。*我该如何做这种最有效的方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T14:56:19.497

```
new File(stringValue).getParent() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:57:18.900

```
String str = "\\eabman03\\edicom\\Aterlasning\\repstat.txt";
System.out.println(str.substring(0, str.lastIndexOf('\\')+1)); 
```

1.  获取最后一个索引`\`
2.  并使用 String.subString() 方法

输出：

```
\eabman03\edicom\Aterlasning\ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T14:58:33.237

```
String dirpath = filepath.replaceAll("(?<=\\\\)[^\\]+", "") 
```

# arrays - 如何访问 mongo db 中嵌套数组中的对象

> ID：14217683
> 
> 赞同：1
> 
> 时间：2013-01-08T14:55:33.783
> 
> 标签：arrays, mongodb, nested

假设以下投资组合集合：

```
{
    "_id" : ObjectId("50e5a858ad06fe3439000001"),
    "name" : "Portfolio 1",
    "description" : "description Portfolio 1",
    "userId" : "",
    "wallets" : [ ]
}
{
    "_id" : ObjectId("50e5a858ad06fe3439000002"),
    "name" : "Portfolio 2",
    "description" : "description Portfolio 2",
    "userId" : "",
    "wallets" : [
        {
            "_id" : ObjectId("50e5ac69f214a46139000001"),
            "name" : "wallet name 2-1",
            "description" : "description du wallet",
        "cards" : [
            {
                "_id" : ObjectId("50ebe4b5906a1e830d000001"),
                "name" : "Card 2-1-1",
                "description" : "description card 1",
            },
            {
                "_id" : ObjectId("50ebe61f2c0f189310000001"),
                "name" : "Card 2-1-2",
                "description" : "description de la carte",
            },
            {
                "_id" : ObjectId("50ebe6202c0f189310000002"),
                "name" : "Card 2-1-2",
                "description" : "description de la carte",
            },
            {
                "_id" : ObjectId("50ebe6212c0f189310000003"),
                "name" : "Card 2-1-3",
                "description" : "description de la carte",
            },
            {
                "_id" : ObjectId("50ebe6212c0f189310000004"),
                "name" : "Card 2-1-4",
                "description" : "description de la carte",
            }
        ]
    },
    {
        "_id" : ObjectId("50ebe6b22c0f189310000005"),
        "name" : "wallet 2-2",
        "description" : "",
        "cards" : [
            {
                "_id" : ObjectId("50ec21063f3c5f9f12000001"),
                "name" : "Card 2-2-1",
                "description" : "",
            }
        ]
    },
    {
        "_id" : ObjectId("50ebe6ba2c0f189310000006"),
        "name" : "wallet 2-3",
        "description" : "",
        "cards" : [
            {
                "_id" : ObjectId("50ec21233f3c5f9f12000002"),
                "name" : "Card 2-3-1",
                "description" : "",
            }
        ]
    }
]
} 
```

由于投资组合、钱包和卡 _id，我想访问特定卡。我想要的是：

```
{
"_id" : ObjectId("50e5a858ad06fe3439000002"),
"wallets" : [
    {
        "_id" : ObjectId("50e5ac69f214a46139000001"),
        "cards" : [
            {
                "_id" : ObjectId("50ebe4b5906a1e830d000001"),
                "name" : "Card 2-1-1",
                "description" : "description card 1",
            }
        ]
    },
] 
```

}

我正在 nodejs/mongo-native-driver 上开发 mongodb 2.2.2。

任何帮助将不胜感激（shell示例或javascript赞赏）

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T19:23:38.740

类似于 slee 使用[Aggregation Framework](http://docs.mongodb.org/manual/aggregation/)的答案，但最好尽早从结果中剔除条目以防止不必要的展开。

```
 var aggOps = [
        { $match: {
            _id: portfolioID
        }},
        {$unwind: '$wallets'},
        { $match: {
            'wallets._id': walletID
        }},
        {$unwind: '$wallets.cards'},
        { $match: {
            'wallets.cards._id': cardID
        }},
    ];

    collection.aggregate(aggOps, function (err, result) {
        console.log(result);
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:45:04.403

可以使用聚合[框架。](http://docs.mongodb.org/manual/applications/aggregation/)具体来说，[$unwind](http://docs.mongodb.org/manual/reference/aggregation/unwind/#_S_unwind)运算符在这种情况下可能最有用。请记住， $unwind 不会扩展空数组，因此示例中的第一个文档被排除在聚合管道之外。

```
db.collection.aggregate(
    { $unwind : "$wallets" },
    { $unwind : "$wallets.cards" },
    { $match: {
        "_id"               : ObjectId("50e5a858ad06fe3439000002"),
        "wallets._id"       : ObjectId("50e5ac69f214a46139000001"),
        "wallets.cards._id" : ObjectId("50ebe4b5906a1e830d000001")
    } }
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T15:41:59.597

> [http://docs.mongodb.org/manual/reference/projection/elemMatch/](http://docs.mongodb.org/manual/reference/projection/elemMatch/)

根据 mongodb 文档，这可以通过 $elemMatch 运算符来完成。我试图提出查询，您能否检查它是否适用于您的情况，或者您可以根据需要进行修改。

```
var projection = { _id: 1, wallets: { _id: 'walletId', $elemMatch: { cards._id: 'cardId'}}};

db.portfolio.find(    {_id: 'portfolio_id'},    projection ) 
```

# asp.net - 浏览器刷新后 Html.Deserialize 丢失 TempData

> ID：14217688
> 
> 赞同：0
> 
> 时间：2013-01-08T14:55:47.603
> 
> 标签：asp.net, html, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-futures

我有一个 ASP.NET MVC4 向导。为了逐步传递一个大视图模型，我使用了期货程序集。我序列化我的模型

```
@Html.Serialize("model", Model, SerializationMode.Signed); 
```

并在控制器中反序列化它

```
protected override void OnActionExecuting(ActionExecutingContext filterContext)
{
    var serialized = Request.Form["model"];
    if (serialized != null)
    {
        model = (BausparViewModel)new MvcSerializer().Deserialize(serialized, SerializationMode.Signed);
        TryUpdateModel(model);
    }

...
} 
```

我在

```
protected override void OnResultExecuted(ResultExecutedContext filterContext)
{
    if (filterContext.Result is RedirectToRouteResult)
        TempData["model"] = model;
} 
```

每个向导步骤都有自己的视图，我使用 RedirectToAction("ActionName") 在控制器中管理上一个/下一个操作

一切正常，只要使用 F5 或菜单没有刷新浏览器。在这一点上，控制器再次被调用。控制器已经有一个模型，尽管 TempData 没有再次保存。

但是缺少两个枚举属性。它们在前面的步骤中使用。他们通过 RadiobuttonFor 绑定到视图。

那么为什么会有一个不完整的模型呢？

在此先感谢 csteinmueller

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:53:16.317

For anything that should live longer than 1 request, you should not use `TempData`. Use `Session` or some other longer term storage mechanism.

`TempData` is designed to delete a value after it is read out of the dictionary. That's why `TempDataDictionary` has methods like `Peek` and `Keep`. Those methods let you tell the dictionary explicitly "hey, don't delete this value after I read it", because by default, it does delete the value after you read it.

# security - Kerberos 领域理解

> ID：14217697
> 
> 赞同：2
> 
> 时间：2013-01-08T14:56:17.870
> 
> 标签：security, kerberos, encryption-symmetric

有人可以总结一下为什么在 Kerberos 中需要领域以及该概念的优势。

我正在努力将我知道/开始理解的所有内容隔离为一些明确定义的修改点。我的研究只是发现了如此深入的文章，几乎无法理解它。我明白他们是什么。我知道使用它们意味着数据是分布式的，因此在系统发生故障时是有利的，并且更容易管理许多小领域而不是一个巨大的领域。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-08T05:30:27.103

“领域”的明确概念允许 Kerberos 系统的扩展和联合。想象两组 A 和 B 开始独立使用 Kerberos。每个都有一个完全独立的 Kerberos 系统或领域：一组连接到公共 Kerberos 身份验证服务的安全主体（用户和软件服务），允许它们相互进行身份验证。

现在，这些团体想要一起工作；假设 B 有一个 Web 服务器，它希望允许对 A 的成员进行经过身份验证的访问。这带来了一个实际问题：两个 Kerberos 系统不能互操作。为了允许身份验证，当 Web 服务器已经在领域 B 中具有身份时，他们必须将 Web 服务器加入到领域 A，或者 A 中的每个用户也必须加入 B（通过在 B 中获取新的主体名称，使用新密码，多次验证并根据他们想要访问的内容在身份之间切换）。一团糟。

对此的解决方案是联合：组 B 决定信任 A 对其自己用户的标识，而不是要求他们独立向 B 注册。这是通过向 A 提供一个密钥来实现的，该密钥允许其 Kerberos 系统直接在 B 中颁发良好的凭据领域。这称为单向领域信任（B 信任 A）。B Web 服务器可以区分不同组中的用户，因为领域明确地出现在主体名称中：user@A 与 user@B。

为了帮助扩展方面，Kerberos 5 自动支持分层领域信任。如果您有三个领域 FOO、A.FOO 和 B.FOO，FOO 信任 A.FOO，而 B.FOO 信任 FOO，则 user@A.FOO 可以在 B.FOO 中对服务进行身份验证，而无需领域管理员在 A.FOO 和 B.FOO 之间建立直接信任：Kerberos 会自动跟随信任关系上下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T08:07:36.707

领域只是安全主体的虚拟集合。SASL 使用相同的概念。例如，在 Windows 中，域是 Kerberos 领域。根据您的情况，一个大领域是有意义的。链接领域需要它们之间的双向信任。对您来说意味着更多的管理开销。你有什么实际问题？

# wcf - 由于内部错误，服务器无法处理请求。在 WCF 错误中

> ID：14217700
> 
> 赞同：4
> 
> 时间：2013-01-08T14:56:20.303
> 
> 标签：wcf, wcf-client

我已经使用 C# 在框架 4.0 中编写了我的服务。这是一个返回值的简单方法

Web.config 是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.web>
    <machineKey validationKey="0E1F430D6FFFA91FBEDAEC1D2DDAAC2127EB055DBAFB78328C5BDE83249A94EA66400453B" decryptionKey="A13EACEAAABBECF2D06619924A8" validation="SHA1" decryption="AES" />
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <services>
      <service name="DecryptCookie.Service1">
        <host>
          <baseAddresses>
            <add baseAddress = "http://localhost:8732/Design_Time_Addresses/WCFandEFService/ProductService/" />
          </baseAddresses>
        </host>
        <endpoint address=""  binding="wsHttpBinding"    contract="DecryptCookie.IService1">
          <identity>
            <dns value="localhost"/>
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract = "IMetadataExchange"/>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpGetEnabled="True"/>
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>  
</configuration> 
```

当我尝试使用该服务时，我收到如下错误：

```
Error: The server was unable to process the request due to an internal error. 
For more information about the error, either turn on
IncludeExceptionDetailInFaults (either from ServiceBehaviorAttribute or from
the configuration behavior) on the server in   order to send the exception
information back to the client, or turn on tracing as per the Microsoft .NET
Framework 3.0 SDK documentation and inspect the server trace
logs.System.Exception {System.ServiceModel.FaultException} 
```

我不确定问题是什么。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-08T15:30:52.090

当我收到这些神秘错误时，我会打开跟踪并创建一个服务日志 (.svcLog)。然后，您可以使用 Service Trace Viewer 工具加载/读取此文件。这将为您提供有关错误的详细数据。按照此链接上的说明进行操作 - [http://msdn.microsoft.com/en-us/library/ms732023.aspx](http://msdn.microsoft.com/en-us/library/ms732023.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-06T10:03:10.800

请检查代理文件。检查您是否更新了业务/数据访问文件中的任何内容并且没有更新代理。这是由于代理错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-29T06:28:50.700

当您将项目从一个系统复制到另一个系统时，可能会出现这种情况。在这种情况下，您必须从 web.config 中删除端点，并且应该再次添加服务引用。

尝试配置跟踪以获取更多错误信息：

打开WCF服务库的app.config文件，添加system.diagnostics的配置

```
 <sources>
      <source name="System.ServiceModel" 
            switchValue="Critical,Information,ActivityTracing"
                propagateActivity="true">
        <listeners>
                 <add name="messages"
                 type="System.Diagnostics.XmlWriterTraceListener"
                 initializeData="c:\logs\messages.svclog" />
          </listeners>
      </source>
    </sources>
    <trace autoflush="true" />
  </system.diagnostics> ``` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-16T13:48:04.403

您可以尝试在**web.config**文件中添加诊断信息以获取日志：

```
 <system.diagnostics> 
      <sources> 
        <source name="System.ServiceModel" 
                switchValue="All" 
                propagateActivity="true"> 
          <listeners> 
            <add name="traceListener" 
                type="System.Diagnostics.XmlWriterTraceListener" 
                initializeData= "D:\AppLogs\Traces.svclog" /> 
          </listeners> 
        </source> 
      </sources> 
    </system.diagnostics> 
```

# jquery - asp.net mvc4 中 jquery.mobile-1.2.0.js 中的运行时异常

> ID：14217701
> 
> 赞同：0
> 
> 时间：2013-01-08T14:56:28.890
> 
> 标签：jquery, mobile, asp.net-mvc-4

我正在将 mvc4 应用程序转换为对移动设备友好的应用程序。我已经通过 nuget 安装了 jquery.mobile 和 jquery.mobile.mvc

在我的 layout.mobile.cshtml 中，代码如下

```
<link href="@Url.Content("~/Content/Mobile/Site.Mobile.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/Mobile/jquery.mobile-1.2.0.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/Mobile/jquery.mobile-1.2.0.min.js")" type="text/javascript"></script> 
```

但是当我通过将用户代理设置为 Iphone 来运行应用程序时，即使在页面加载之前，我也会收到以下异常

```
Exception Description: ![Jscript run time error][1] in  $.mobile is undefined in jquery-mobile-1.2.0.js 
```

我是使用 jquery 进行移动开发的新手。还有谁能告诉我现在在移动代理中查看时如何缩小图像我正在使用以下代码，但是当我使用移动代理时，图像与桌面一样大，我使用的是 IE 8 和 mvc4。请帮忙？

```
<head>
    @using System;
    @using System.Web;
    <title>@ViewBag.Title </title>
    <link href="@Url.Content("~/Content/Mobile/Site.Mobile.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/themes/custom-theme/jquery.ui.all.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/Icons/icons.css")" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
    <meta name="viewport" content="width=device-width">
      @System.Web.Optimization.Styles.Render("~/Content/Site.Mobile.css")
          @System.Web.Optimization.Scripts.Render("~/bundles/jquery")
</head> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:31:37.160

你有没有提到“主要”Jquery？

请参阅此示例：http: [//jquerymobile.com/demos/1.2.0/docs/about/getting-started.html](http://jquerymobile.com/demos/1.2.0/docs/about/getting-started.html)

另外：您只需要一个 jquery mobile。jquery.mobile-1.2.0.min.js 是“压缩”和优化的库，jquery.mobile-1.2.0.js 是调试库。与“主要”jquery 相同。

# cordova - PhoneGap 插件 YouTube Intent 后退按钮

> ID：14217704
> 
> 赞同：0
> 
> 时间：2013-01-08T14:56:36.250
> 
> 标签：cordova, youtube-api, phonegap-plugins

我使用以下代码从我的 Phonegap / Cordova 插件启动 YouTubeStandalonePlayer Intent：

```
package com.remcob00.plugins.youtube;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.content.Intent;

import org.apache.cordova.api.Plugin;
import org.apache.cordova.api.PluginResult;

import com.google.android.youtube.player.YouTubeInitializationResult;
import com.google.android.youtube.player.YouTubeStandalonePlayer;

public class YouTube extends Plugin {

@Override
public PluginResult execute(String action, JSONArray args, String callbackId) {
    try {
        JSONObject jo = args.getJSONObject(0);
        doSendIntent(jo.getString("videoid")); 
        return new PluginResult(PluginResult.Status.OK);
    } catch (JSONException e) {
        return new PluginResult(PluginResult.Status.JSON_EXCEPTION);
    }
}

private void doSendIntent(String videoid) {
    // API key instructions https://developers.google.com/youtube/android/player/register
    Intent youtubeIntent = YouTubeStandalonePlayer.createVideoIntent((Activity) this.cordova, "YOUR_API_KEY", videoid);
    this.cordova.startActivityForResult(this, youtubeIntent, 0);
}

} 
```

（[GitHub上的插件](https://github.com/remcob00/cordova-phonegap_youtube_player_api_android)）

但问题是，如果我打开 YouTube 意图并按下后退按钮 I，它不会返回到我打开意图的页面，而是返回 index.html 文件。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T00:32:45.893

如果找不到更好的解决方案，可以在每次页面更改后使用 window.localStorage 存储当前位置，然后在打开 index.html 时，检测 Resume 事件并检查 window.localStorage 的值是否不为空.

如果不是 - 只需重定向到该位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-18T13:36:18.953

这似乎是Android模拟器中的一个问题。我已经在真实设备上对其进行了测试，并且效果很好。

# android - android中Base64中的OutOfmemory异常

> ID：14217706
> 
> 赞同：1
> 
> 时间：2013-01-08T14:56:42.627
> 
> 标签：android, base64

我有一个类似联系人 contentprovider 的数据库，因为该用户可以捕获每个联系人的图像，捕获后，我将图像编码为 base64 并保存到文件中，并使用文件的路径更新该图像字段，并同步所有如果用户在线，则与服务器的联系人，以及我在需要时从服务器获取所有这些数据，同时我从文件中获取图像时我面临内存不足异常 base64，如果我将图像保存在数据库中是解决问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:31:31.640

当您尝试对整个图像进行编码时，图像通常会在 Android 中导致 OutOfMemoryException。为此，以块的形式读取图像数据，然后在对块应用编码后将块保存在临时文件中。编码完成后，对编码的图像文件做任何你想做的事情。

这是从文件编码图像并使用块将其保存在文件中的代码..

```
 String imagePath = "Your Image Path";        
    String encodedImagePath = "Path For New Encoded File"; 
    InputStream aInput;
    Base64OutputStream imageOut = null;
    try {
        aInput = new FileInputStream(imagePath);

        // carries the data from input to output :
        byte[] bucket = new byte[4 * 1024];
        FileOutputStream result = new FileOutputStream(encodedImagePath);
        imageOut = new Base64OutputStream(result, Base64.NO_WRAP);
        int bytesRead = 0;
        while (bytesRead != -1) {
        // aInput.read() returns -1, 0, or more :
        bytesRead = aInput.read(bucket);
        if (bytesRead > 0) {
            imageOut.write(bucket, 0, bytesRead);
            imageOut.flush();
        }
        imageOut.flush();
        imageOut.close();
    } catch (Exception ex) {
        Log.e(">>", "error", ex);
    } 
```

# ajax - rich:fileUpload 页面刷新后丢失元素

> ID：14217708
> 
> 赞同：1
> 
> 时间：2013-01-08T14:56:48.300
> 
> 标签：ajax, jsf-2, richfaces

我正在使用丰富的面孔元素`rich:fileUpload`。文件上传工作正常。

我只是认为一种行为是中继问题：用户上传文件。他现在可以查看他上传的所有文件，并在必要时清除一个或所有文件。但是，如果他刷新页面（F5 或某些快捷方式），文件列表将被清除。表单中的所有其他信息都存在，但上传文件的列表不存在。更糟糕的是：用户现在无法删除曾经上传的文件。

有没有办法再次显示文件渲染/加载`fileUpload`元素内的文件列表。我可以轻松地制作一个`dataGrid`，但两次显示文件列表似乎是错误的，以防万一用户刷新页面。

丰富的面孔展示也使用了第二个列表：[fileUpload-Demo](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=fileUpload)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T10:08:22.917

正如您在演示[文件Upload-Demo](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=fileUpload)中看到的，它们使用的是*@SessionScoped* bean。使用*@RequestScoped*或*@ViewScoped* bean 时，会重新创建 bean，因为视图是。

这将是解决问题的最简单方法。

# asp.net - 从 Node.js 将数据发布到 ASP.NET WEB API 服务

> ID：14217710
> 
> 赞同：2
> 
> 时间：2013-01-08T14:56:52.627
> 
> 标签：asp.net, node.js, express, asp.net-web-api

我目前正在开发一个应用程序，以允许我公司的高管在任何地方执行某些操作。我的 Node.js 片段充当 Internet 和我公司内部 LAN 之间的代理，并调用公司 LAN 上的一些 ASP.NET WEB API 服务来处理 Active Directory 身份验证（以便高管可以使用他们的 Windows 登录）以及存储和检索数据来自 SQL Server 2008。

ASP.Net AuthenticateUser() 函数接受包含 userId 和 pas 的 HTTP POST 请求，并返回一个 JSON 对象，其中包含客户端可用于签署请求的哈希值。当我将用户 ID 和密码作为查询参数传递时它工作正常，但是当我尝试将它们嵌入到请求正文中时它会失败。工作版本如下所示。（**注意：**我省略了错误处理以提高清晰度。）

```
 namespace Approver.Controllers 
   {
      public class UtilityController : ApiController 
      {
        public UserInfo AuthenticateUser(string userId, string password) 
        {
          return UtilityBo.AuthenticateUser(userId, password); 
        } 
      } 
   } 
```

工作的 Node.js 代码（即 Express 中的路由）如下所示。

```
exports.login = function(req, res){
var userId = req.body.userId;
var password = req.body.password;
var postData = 'userId='+userId+'&password='+password;
});
var options = {
  host: res.app.settings['serviceHost'],
  port: res.app.settings['servicePort'],
  path: '/api/Utility/AuthenticateUser?userId='+userId+'&password='+password,
  method: 'POST',
  header: {
    'Content-Type': 'application/x-www-form-urlencoded',
    'Content-Length': postData.length
  }
};      
http.request(options, function(resp){
  resp.setEncoding('utf8');
  var arr = '';
  resp.on('data', function (chunk){
    arr += chunk;
  });
  resp.on('end', function (){
    var data = JSON.parse(arr);
    res.writeHead(200, {'Content-Type': 'application/json',});
    res.end(JSON.stringify(data));
  });
}).end(JSON.stringify(postData)); 
```

当我将代码更改为仅接受来自帖子正文的数据时，IIS 返回 HTTP 500 错误。新的 WEB API 服务如下所示。

```
namespace Approver.Controllers 
{
  public class UtilityController : ApiController 
 {
    public UserInfo AuthenticateUser(UserAuthentication userAuth) 
    {
      return UtilityBo.AuthenticateUser(userAuth); 
    } 
  } 
}

namespace Approver.Models 
{
  public class UserAuthentication 
  {
    [Required] 
    public string UserId { get; set; }

    [Required] 
    public string Password { get; set; } 
  } 
} 
```

新的节点代码只是从 URL 中去除查询参数。

在做了一些测试之后，我意识到 web api 从来没有向模型中插入数据，所以 userAuth 总是有空值。但是，我尝试通过 Chrome 的 REST 控制台发布数据，并且成功了，因此 Node.js 部分必须包含错误。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:24:57.253

我认为您在 Uri 的模型绑定中遇到了问题。

尝试明确指定`FromUri`属性。

```
namespace Approver.Controllers 
{
  public class UtilityController : ApiController 
 {
    public UserInfo AuthenticateUser([FromUri] UserAuthentication userAuth) 
    {
      return UtilityBo.AuthenticateUser(userAuth); 
    } 
  } 
} 
```

如果您希望参数从 body 和 uri 绑定，请尝试使用

```
namespace Approver.Controllers 
{
  public class UtilityController : ApiController 
 {
    public UserInfo AuthenticateUser([ModelBinder] UserAuthentication userAuth) 
    {
      return UtilityBo.AuthenticateUser(userAuth); 
    } 
  } 
} 
```

[本文](http://blogs.msdn.com/b/jmstall/archive/2012/04/16/how-webapi-does-parameter-binding.aspx)对 ASP.NET Web API 中的模型绑定进行了深入了解

# linux - 如何使用 ARP REQUEST/REPLY 包测试主机 IP 在 Linux 中是否可访问？

> ID：14217717
> 
> 赞同：0
> 
> 时间：2013-01-08T14:57:14.957
> 
> 标签：linux, arp

如何使用 ARP REQUEST/REPLY 包测试主机 IP 在 Linux 中是否可访问？

有谁知道该命令或有 C++/C 中的程序可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:02:04.763

`arping`可以为你施展魔法吗？[http://linux.die.net/man/8/arping](http://linux.die.net/man/8/arping)

arping 实用程序执行类似于 ping 命令的操作，但在以太网层。您可以向邻居主机/计算机发送 ARP REQUEST。

# javascript - Javascript 警报和确认在 Windows 7 上的 IE9 中不起作用

> ID：14217721
> 
> 赞同：1
> 
> 时间：2013-01-08T14:57:20.350
> 
> 标签：javascript, internet-explorer-9, alert

我有一台装有 IE9 的 Windows 7 机器，并且没有禁用 Javascript。但是，当我使用警报或确认浏览器时，浏览器只会闪烁两次，没有任何反应。这不是代码或验证问题，因为代码在 Chrome、Firefox、Opera 和 Safari 中运行良好。我检查了控制台，没有错误。

有谁知道是否有办法通过某些设置专门影响这些特定的 JavaScript 函数？为了增加更多的混乱，提示功能确实有效，只是没有提醒和确认。

例如，此代码示例无法显示警报。

```
<script>
  alert('hello');
  document.write('done');
  document.close();
</script> 
```

没有附加组件，也没有弹出窗口阻止程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-26T13:12:48.280

> 我知道这个问题很老，但我也遇到了同样的问题，并在这里的另一篇文章中找到了我的答案，所以我认为其他人可能会从中受益。

加载页面后打开 IE 开发人员工具 (F12)。

检查浏览器模式：和文档模式：

尝试将浏览器模式设置为 IE9，将文档模式设置为 IE9 标准。

现在再试一次，看看是否有效。

[原来的答案。](https://stackoverflow.com/a/9743147/3987406)

# c++ - c++ - 应该在无指针类中声明/实现析构函数吗？

> ID：14217723
> 
> 赞同：4
> 
> 时间：2013-01-08T14:57:25.180
> 
> 标签：c++, implementation

应该在无指针类中声明/实现析构函数吗？拥有/不拥有它有什么好处吗？

我的男人是：

```
class Point
{
public: 
    int X, Y;
    Point(int x, int y);
    //~Point(void);       //should I uncoment it and implement empty destructor ?
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T14:57:59.713

> **应该在无指针类中声明/实现析构函数吗？**

不需要^([条件适用])。编译器将为您生成一个。
仅当您想要执行特定的操作时才应提供一个，而编译器不会。
例如：

*   资源管理（内存管理，文件处理），
*   记录，
*   关闭网络连接，
*   简而言之，每次销毁对象时都需要执行的自定义功能

一般来说，经验法则是：
***“如果您需要提供复制构造函数或复制赋值运算符，那么您很可能还需要提供自己的析构函数。”***
通俗地说，这条规则被称为**[三规则](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)**。

* * *

^([条件适用]) 如果您的类旨在充当继承的基类，并且您的实现将需要调用`delete`指向派生类对象的基类指针，那么您需要提供一个析构函数并将其标记为`virtual`基类，失败这样做会导致**Undefined Behavior**。

* * *

> **拥有/不拥有它有什么好处吗？**

无，因为编译器做同样的事情，所以不需要额外输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T14:57:50.820

不，如果您不管理资源，则不应使用**非析构函数。`virtual`**

如果您希望从类派生并计划多态删除（即`delete`通过基类指针派生的对象），则需要一个`virtual`析构函数。

事实上，您不应该直接管理资源，而应该使用包装器——即智能指针而不是原始指针和手动分配/解除分配。

# jquery - 是否可以使此导航仅在 css 上工作并删除 jquery？

> ID：14217724
> 
> 赞同：0
> 
> 时间：2013-01-08T14:57:26.530
> 
> 标签：jquery, css, drop-down-menu, navigation

你们这里的一群人在这个带有子类别 3 的平滑下拉导航系统中帮助我非常有帮助，但是，在查看它之后，我很好奇我是否可以仅使用 css 获得相同的效果并删除所有 jquery。它将使用的站点是用纯 css 制作的，这是 jquery 的唯一需要，所以我想看看我是否可以完全消除对它的需要。这是小提琴页面。我认为使用缓动会起作用，但不确定如何修改它。此外，由于我的网站不是 html5，因此无法在 html 中使用“角色”。

```
<div id="trigger"><a href="#menu" class="menu-link">Menu</a></div>
</div>
<nav id="menu" role="navigation">
<ul>
<li><a href="#">Category 1</a></li>
<li><a href="#">Category 2</a></li>
<li id="Category3"><a href="#">Category 3</a>
    <ul id="extraOptions">
        <li><a href="#">Extra Option 1</a></li>
        <li><a href="#">Extra Option 2</a></li>
        <li><a href="#">Extra Option 3</a></li>
    </ul></li>
<li><a href="#">Category 4</a></li>
<li><a href="#">Category 5</a></li>
<li><a href="#">Category 6</a></li>
</ul>
</nav> 
```

**查看小提琴文件**

[http://jsfiddle.net/ApNhK/1/](http://jsfiddle.net/ApNhK/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:00:52.717

我认为您无法`onclick()`在 css 中模拟 a 。如果这是`:hover`可能的，为什么不呢？

编辑：我认为`:focus`它可能会起作用，我会检查一下，等等

Edit2：我想这是不可能的。你可以`:focus`让它看起来像一个点击，但它非常有限，你不能`:focus`只使用 javascript 来制作复杂的嵌套子菜单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:02:28.597

Sorry, click handlers require JS, I don't think theres any way around it.

Even the "onclick" html attribute is just a lazy way of putting JavaScript inline.

You could have a hovering menu, where the user is required to hover to see the page, but thats not very good UX. I would keep the jquery. I think it looks good, and jQuery is a great library to familiarize yourself with

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T22:40:45.390

可以通过以下方式在单击时显示菜单（dis）`:target`：[jsFiddle](http://jsfiddle.net/woestijnrog/9hPZu/3/)

如果可以的话，使带有子菜单的菜单表现得像你想要的那样需要巧妙地使用相邻/兄弟/后代选择器。

# objective-c - HTTP 将 UIImage 发布到服务器

> ID：14217726
> 
> 赞同：0
> 
> 时间：2013-01-08T14:57:28.623
> 
> 标签：objective-c, post, uiimage

我有以下方法用于创建一个`NSMutableURLRequest`包含在`NSMutableDictionary`.

```
+ (NSMutableURLRequest *)createURLRequestWithURL:(NSString *)URL andPostData:(NSMutableDictionary *)postDictionary {
    NSMutableURLRequest *urlRequest = [[NSMutableURLRequest alloc]init];
    NSString *postString = @"";
    NSString *postLength = nil;
    NSData *postData = nil;

    //convert post distionary into a string
    if (postDictionary) {
        for (NSString *key in postDictionary) {
            if ([postString length] != 0) {
                postString = [postString stringByAppendingString:@"&"];
            }

            postString = [postString stringByAppendingFormat:@"%@=%@", [self urlEncodeString:key], [self urlEncodeString:[postDictionary valueForKey:key]]];
        }
    }

    //get length of post and convert post into a data object
    postLength = [NSString stringWithFormat:@"%d", [postString length]];
    postData = [postString dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];

    //setup the request
    [urlRequest setURL:[NSURL URLWithString:URL]];
    [urlRequest setHTTPMethod:@"POST"];
    [urlRequest setValue:postLength forHTTPHeaderField:@"Content-Length"];
    [urlRequest setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    [urlRequest setHTTPBody:postData];

    return urlRequest;
} 
```

到目前为止，我一直只使用字符串数据作为`postDictionary`.

我的问题是我应该如何修改此代码以发送其他类型的值？具体来说，我正在尝试将图像发送到服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:04:49.480

[http://lists.apple.com/archives/web-dev/2007/Dec/msg00017.html](http://lists.apple.com/archives/web-dev/2007/Dec/msg00017.html)

```
NSString *filename = @"myfile.jpg";
NSString *boundary = @"----FOO";

 NSURL *url = [NSURL URLWithString:@"http://example.com";];
NSMutableURLRequest *req = [NSMutableURLRequest requestWithURL:url];
[req setHTTPMethod:@"POST"];

NSString *contentType = [NSString stringWithFormat:@"multipart/form- data, boundary=%@", boundary];
[req setValue:contentType forHTTPHeaderField:@"Content-type"];

NSString *imagePath = [NSString stringWithFormat:@"/path/to/image/%@", filename];
NSData *imageData = [NSData dataWithContentsOfFile:imagePath options:0 error:nil];

//adding the body:
NSMutableData *postBody = [NSMutableData data];
[postBody appendData:[[NSString stringWithFormat:@"--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[@"Content-Disposition: form-data; name= \"some_name\"\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[@"some_value"; dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[[NSString stringWithFormat:@"Content- Disposition: form-data; name=\"image_file\"; filename=\"%@\"\r\n", filename] dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[@"Content-Type: image/jpeg\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:imageData];
[postBody appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[@"Content-Disposition: form-data; name= \"some_other_name\"\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[@"some_other_value"; dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[[NSString stringWithFormat:@"\r\n--%@--\r \n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[req setHTTPBody:postBody]; 
```

或者只使用 ASIHttpRequest [http://allseeing-i.com/ASIHTTPRequest/](http://allseeing-i.com/ASIHTTPRequest/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:07:14.857

您应该查看[本教程](http://zcentric.com/2008/08/29/post-a-uiimage-to-the-web/)。

基本上你需要

1.  更改内容类型标题
2.  从图像中获取 NSDate（例如使用 UIImageJPEGRepresentation()）
3.  使用图像数据、边界、Content-Disposition 和 Content-Type 创建主体

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T05:00:36.743

使用其他答案中的信息根据需要修改我的代码：

```
+ (NSMutableURLRequest *)createURLRequestWithURL:(NSString *)URL andPostData:(NSMutableDictionary *)postDictionary {
    NSMutableURLRequest *urlRequest = [[NSMutableURLRequest alloc]init];
    NSMutableData *postData = [NSMutableData data];

    NSString *boundary = @"---------------------------14737809831466499882746641449";

    //convert post distionary into a string
    if (postDictionary) {
        for (NSString *key in postDictionary) {
            [postData appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];

            id postValue = [postDictionary valueForKey:key];

            if ([postValue isKindOfClass:[NSString class]]) {
                [postData appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name= \"%@\"\r\n\r\n", key] dataUsingEncoding:NSUTF8StringEncoding]];
                [postData appendData:[postValue dataUsingEncoding:NSUTF8StringEncoding]];
            } else if ([postValue isKindOfClass:[UIImage class]]) {
                [postData appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"%@\"; filename=\"%@.png\"\r\n", key, [TSGUIDCreator generateGUID]] dataUsingEncoding:NSUTF8StringEncoding]];
                [postData appendData:[@"Content-Type: image/jpeg\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
                [postData appendData:[@"Content-Transfer-Encoding: binary\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
                [postData appendData:UIImagePNGRepresentation(postValue)];
            } else {
                [NSException raise:@"Invalid Post Value" format:@"Received invalid post value while trying to create URL Request. Post values are required to be strings. The value for the following key was not a string: %@.", key];
            }
        }

        [postData appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    }

    //setup the request
    [urlRequest setURL:[NSURL URLWithString:URL]];
    [urlRequest setHTTPMethod:@"POST"];
    [urlRequest setValue:[NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary] forHTTPHeaderField:@"Content-Type"];
    [urlRequest setHTTPBody:postData];

    return urlRequest;
} 
```

# javascript - 访问同一函数内的其他函数

> ID：14217729
> 
> 赞同：0
> 
> 时间：2013-01-08T14:57:35.007
> 
> 标签：javascript

有什么方法可以做到这一点？

```
 function test()
    {

        this.write = function(text)
        {
            alert(text);
        }

        this.read = function()
        {
            this.write('foo');
            // WRONG WAY
            // test.write('foo');
        }
    } 
```

如何从“this.read”调用“this.write”函数？

**编辑：**

找到 EricG 的遮阳篷。已尝试使用上面的代码，它可以工作。但是我的真实代码仍然无法正常工作。我必须弄清楚发生了什么。

从“THIS.READ”内部调用“THIS.WRITE”的方法就是调用“this.write()”。就像那样。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:01:38.963

```
function test()
{
    this.write = function(text)
    {
        alert(text);
    }

    this.read = function()
    {
        this.write('foo');
    }
}

var a = new test();
a.read(); 
```

[jsFiddle](http://jsfiddle.net/Pf5ZK/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:01:49.510

试试这个：

```
function test()
{

    this.write = function(text)
    {
        alert(text);
    }

    this.read = function()
    {
        this.write('foo');
    }
}

var t = new test();
t.read(); 
```

[小提琴](http://jsfiddle.net/cQg6v/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:03:48.847

```
function test()
{
   var self = this;

    this.write = function(text)
    {
        alert(text);
    };

    this.read = function()
    {
        self.write('foo');
    };

    // depending on browser versions or included libraries.
    this.another = function () {
        this.write('foo');
    }.bind(this);
} 
```

您也可以在没有绑定调用的情况下使用 this，但在某些情况下，“this”的含义可能会改变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T15:18:38.807

这完全取决于从哪里调用函数。我建议阅读更多关于`this`关键字的内容也许看看这个[SO question](https://stackoverflow.com/questions/3127429/javascript-this-keyword)

如果您创建一个实例`test`

```
function test()
{

    this.write = function(text)
    {
        alert(text);
    }

    this.read = function()
    {
        this.write('foo');
    }
}
var inst = new test()
inst.read() //foo
inst.read.call() //Uncaught TypeError: Object [object Window] has no method 'write' 
```

并且调用`read`这个实例的方法，`this`会引用*好*，这个实例的`test`

但是，如果您的代码不起作用，则可能会使用另一个上下文调用该方法。也许你添加了一个 Eventlistener。并且它尝试调用的回调函数`this.write`
将`this`不再引用测试/您的函数的实例。

您还可以做的是将上下文保留在局部变量中，例如

```
function test()
{
    var context = this;
    this.write = function(text)
    {
        alert(text);
    }

    this.read = function()
    {
        context.write('foo');
    }
}
var inst = new test()
inst.read() // foo
inst.read.call() //foo 
```

因此，正如您在第二种情况下看到的那样，`write`尽管`read`以全局对象`Window`作为其上下文来调用被执行。

这是一个[JSBin](https://stackoverflow.com/questions/3127429/javascript-this-keyword)

# asp.net-mvc - .net mvc 404 自定义错误页面有时只能工作

> ID：14217733
> 
> 赞同：1
> 
> 时间：2013-01-08T14:57:40.603
> 
> 标签：asp.net-mvc, asp.net-mvc-4, error-handling, custom-error-pages

我正在尝试在我的 MVC 4 站点上执行 404 操作来回答默认图像，只要该站点在任何图像上获得 404。

当我在本地运行时一切正常，但是当我在我的服务器上发布我的网站时，它不起作用......

我在我的 Web.Config 上有：

```
<customErrors mode="On">
   <error statusCode="404" redirect="~/Home/Error404" />
</customErrors> 
```

在我的 HomeController 上：

```
 public ActionResult Error404()
    {
        if (Request.Url.AbsoluteUri.Contains(".jpg") || Request.Url.AbsoluteUri.Contains(".gif") || Request.Url.AbsoluteUri.Contains(".png"))
        {
            var dir = Server.MapPath("~/Content/Images/");
            var path = Path.Combine(dir, "imageNotFound400.jpg");
            return base.File(path, "image/jpeg");
        }
        return View();
    } 
```

正如我所说，在本地运行，它工作，它返回我的默认图像，但在线，你可以在这里看到 ：http://www.ipgii.org.br/Mensagem?pageSize=9&page=30 和这里：[http](http://www.ipgii.org.br/Mensagem?pageSize=9&page=30) [： //www.ipgii.org.br/Content/Uploads/Thumbnails/alegrai-vos-no-senhor.jpg](http://www.ipgii.org.br/Content/Uploads/Thumbnails/alegrai-vos-no-senhor.jpg) 它进入了一个丑陋的 HTTP 404 错误页面。

我需要帮助！=]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:31:39.627

我写了一篇关于在 ASP.Net MVC 应用程序中正确设置错误页面的博客文章，在这里。

[http://web.archive.org/web/20130911212149/http://blog.aquabirdconsulting.com/2012/04/19/setting-up-asp-net-mvc-error-pages/](http://web.archive.org/web/20130911212149/http://blog.aquabirdconsulting.com/2012/04/19/setting-up-asp-net-mvc-error-pages/)

但看起来你缺少的是：

```
<httpErrors existingResponse="PassThrough" /> 
```

这可确保 IIS7+ 不会弄乱您的错误页面。阅读这篇文章，看看你是否做了你需要做的一切。

* * *

## 编辑（根据 OP 评论）

您将 httpErrors 标签放在 system.webServer 标签下。它应该看起来像这样。我在下面添加了另一个属性，它可能对您想要做的事情有所帮助。

```
<system.webServer>
    <httpErrors existingResponse="PassThrough" errorMode="Custom" />
</system.webServer> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:14:20.910

如果您的应用程序在本地工作没有问题，但在远程托管时遇到问题，根据我的经验，大多数情况下 IIS 配置不正确。

在您的情况下，我觉得运行网站的帐户（AppPool Account）可能没有对 /Uploads/Thumbnails 文件夹的读取权限。

其次，请检查您的 Global.aspx.cs 文件中的 MapRoute 是否有 *.jpg 文件的转义语句。也许 IIS 正在寻找一个处理程序来将请求传递给 uri：[http](http://www.ipgii.org.br/Content/Uploads/Thumbnails/alegrai-vos-no-senhor.jpg) ://www.ipgii.org.br/Content/Uploads/Thumbnails/alegrai-vos-no-senhor.jpg并且无法找到它。

这是错误代码的原因：IIS 中的 0x80070002：http: [//support.microsoft.com/kb/942052](http://support.microsoft.com/kb/942052)

# multithreading - 应用程序挂起在 SysUtils -> DoneMonitorSupport 退出

> ID：14217735
> 
> 赞同：16
> 
> 时间：2013-01-08T14:57:43.147
> 
> 标签：multithreading, delphi, delphi-xe2

我正在编写一个线程密集型应用程序，它在退出时挂起。

我跟踪到系统单元，找到了程序进入无限循环的地方。它在**SysUtils**行 19868 -> **DoneMonitorSupport** -> **CleanEventList**：

```
repeat until InterlockedCompareExchange(EventCache[I].Lock, 1, 0) = 0; 
```

我在网上搜索了一个解决方案，发现了几个 QC 报告：

*   [http://qc.embarcadero.com/wc/qcmain.aspx?d=95194](http://qc.embarcadero.com/wc/qcmain.aspx?d=95194)
*   [http://qc.embarcadero.com/wc/qcmain.aspx?d=90487](http://qc.embarcadero.com/wc/qcmain.aspx?d=90487)

不幸的是，这些似乎与我的情况无关，因为我既不使用**TThreadList**也不使用**TMonitor**。

我很确定我的所有线程都已完成并已被销毁，因为它们都继承自保持创建/销毁计数的基本线程。

有没有人遇到过类似的行为？您是否知道发现根本原因所在的任何策略？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-09T00:39:31.153

我一直在研究`TMonitor`锁是如何实现的，终于有了一个有趣的发现。为了有点戏剧性，我先告诉你锁是如何工作的。

当您在 a 上调​​用任何`TMonitor`函数时`TObject`，会创建一个新的`TMonitor`记录实例，并将该实例分配给`MonitorFld`对象本身内部的 a。此分配以线程安全的方式进行，使用`InterlockedCompareExchangePointer`. 由于这个技巧，`TObject`它只包含一个指针大小的数据量来支持`TMonitor`，它不包含完整的 TMonitor 结构。这是一件好事。

该`TMonitor`结构包含许多记录。我们将从`FLockCount: Integer`领域开始。当第一个线程`TMonitor.Enter()`在任何对象上使用时，这个组合的锁计数器字段的值将为零。再次使用一种`InterlockedCompareExchange`方法获取锁并启动计数器。调用线程将没有锁定，也没有上下文切换，因为这一切都是在进程中完成的。

当第二个线程尝试`TMonitor.Enter()`锁定同一个对象时，它的第一次锁定尝试将失败。当这种情况发生时，Delphi 遵循两种策略：

*   如果开发人员过去`TMonitor.SetSpinCount()`设置了“旋转”次数，那么 Delphi 将执行一个忙等待循环，旋转给定的次数。这对于小锁来说非常好，因为它允许在不进行上下文切换的情况下获取锁。
*   如果自旋计数过期（或者没有自旋计数，并且默认情况下自旋计数为零），`TMonitor.Enter()`将对`TMonitor.GetEvent()`. 换句话说，它不会忙于等待浪费 CPU 周期。记住，`TMonitor.GetEvent()`因为那很重要。

假设我们有一个获取锁的线程和一个试图获取锁但现在正在等待由`TMonitor.GetEvent`. 当第一个线程调用`TMonitor.Exit()`时，它会注意到（通过该`FLockCount`字段）至少有一个其他线程阻塞。因此，它会立即触发通常应该是先前分配的事件（调用`TMonitor.GetEvent()`）。但是由于两个线程，一个调用的线程和一个调用的线程`TMonitor.Exit()`实际上`TMonitor.Enter()`可能`TMonitor.GetEvent()`同时调用，因此内部还有一些技巧`TMonitor.GetEvent()`可以确保*只分配一个*事件，与操作顺序无关。

对于更多有趣的时刻，我们现在将深入研究其`TMonitor.GetEvent()`工作方式。这个东西存在于`System`单元内部（你知道，我们不能重新编译来玩的那个），但事实证明它通过`System.MonitorSupport`指针将实际分配事件的职责委托给了另一个单元。这指向`TMonitorSupport`声明 5 个函数指针的类型记录：

*   `NewSyncObject`- 为同步目的分配一个新事件
*   `FreeSyncObject`- 取消分配用于同步目的的事件
*   `NewWaitObject`- 为等待操作分配一个新事件
*   `FreeWaitObject`- 释放等待事件
*   `WaitAndOrSignalObject`- 好吧..等待或发出信号。

事实证明，`NewXYZ`函数返回的对象可以是任何东西，因为它们仅用于调用`WaitXYZ`和对应调用`FreeXyzObject`. 这些功能的实现`SysUtils`方式旨在为这些锁提供最少的锁定和上下文切换；因为对象本身（由`NewSyncObject`and返回`NewWaitObject`）不是直接由 . 返回的事件`CreateEvent()`，而是指向`SyncEventCacheArray`. 它更进一步，直到需要时才创建实际的 Windows 事件。因此， 中的记录`SyncEventCacheArray`包含几条记录：

*   `TSyncEventItem.Lock`- 这告诉 Delphi 而不是 Lock 现在是否正在用于任何事情，并且
*   `TSyncEventItem.Event`- 如果需要等待，这包含将用于同步的实际事件。

当应用程序终止时，`SysUtils.DoneMonitorSupport`遍历所有记录`SyncEventCacheArray`并等待锁变为零，即等待锁停止被任何东西使用。从理论上讲，只要该锁不为零，至少有一个线程可能正在使用该锁 - 所以明智的做法是等待，以免导致 AccessViolations 错误。我们终于解决了当前的问题：HANGING in`SysUtils.DoneMonitorSupport`

# 为什么应用程序可能会在 SysUtils.DoneMonitorSupport 中挂起，即使它的所有线程都正确终止？

因为至少一个使用 或 中的任何一个分配的事件`NewSyncObject`没有使用它对应的or`NewWaitObject`释放。我们回到常规。它分配的事件保存在对应于用于的对象的记录中。指向该记录的指针*仅*保存在该对象的实例数据中，并在应用程序的整个生命周期内保存在那里。搜索字段的名称，我们在文件中找到：`FreeSyncObject``FreeWaitObject``TMonitor.GetEvent()``TMonitor``TMonitor.Enter()`*`FLockEvent``System.pas`*

 *```
procedure TMonitor.Destroy;
begin
  if (MonitorSupport <> nil) and (FLockEvent <> nil) then
    MonitorSupport.FreeSyncObject(FLockEvent);
  Dispose(@Self);
end; 
```

并在此处调用该记录析构函数：`procedure TObject.CleanupInstance`.

换句话说，最终的同步事件*只有在用于同步的对象被释放时才会被释放！*

# 回答OP的问题：

应用程序挂起，因为至少有一个用于的 OBJECT`TMonitor.Enter()`未被释放。

# 可能的解决方案：

不幸的是我不喜欢这个。不对，我的意思是不释放小对象的惩罚应该是小内存泄漏，而不是挂起的应用程序！这对于服务应用程序来说尤其糟糕，因为服务可能只是永远挂起，没有完全关闭但无法响应任何请求。

Delphi 团队的解决方案？他们不应该挂在`SysUtils`单元的最终代码中，无论如何。他们可能应该忽略`Lock`并转而关闭事件句柄。在那个阶段（SysUtils 单元的最终确定），如果仍然有代码在某个线程中运行，那么它的状态就非常糟糕，因为大多数单元都已经完成了，它没有在设计运行的环境中运行。

对于德尔福用户？我们可以`MonitorSupport`用我们自己的版本替换它，它不会在最终确定时进行那些广泛的测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T00:18:15.047

我可以使用 Cosmin 提供的示例重现您的问题。我也可以通过在所有线程完成后简单地释放 SyncObj 来解决问题。

由于我无法访问您的代码，所以我不能多说，但可能 TMonitor 使用的某些对象实例没有被释放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T10:43:10.663

我通过以下方式解决了这个错误：

将**System.SysUtils**、**InterlockedAPIs.inc**和**EncodingData.inc复制到我的应用程序目录并更改****System.SysUtils**中的以下代码：

```
 procedure CleanEventList(var EventCache: array of TSyncEventItem);
  var
    I: Integer;
  begin
    for I := Low(EventCache) to High(EventCache) do
    begin
      if InterlockedCompareExchange(EventCache[I].Lock, 1, 0) = 0 then
         DeleteSyncWaitObj(EventCache[I].Event);
      //repeat until InterlockedCompareExchange(EventCache[I].Lock, 1, 0) = 0;
      //DeleteSyncWaitObj(EventCache[I].Event);
    end;
  end; 
```

我还在 System.SysUtils 顶部添加了此检查，以提醒我在更改 Delphi 版本时更新 System.SysUtils 文件：

```
{$IFNDEF VER230}
!!!!!!!!!!!!!!!!
You need to update this unit to fix the bug at line 19868
See http://stackoverflow.com/questions/14217735/application-hangs-in-sysutils-donemonitorsupport-on-exit
!!!!!!!!!!!!!!!!
{$ENDIF} 
```

在这些更改之后，我的应用程序正确关闭。

注意：我尝试按照 LU RD 的建议添加“ReportMemoryLeaksOnShutdown”，但在关闭时，我的应用程序进入了一个竞争条件，弹出了许多运行时错误对话框。当我尝试 EurekaLog 的内存泄漏功能时，也会发生类似的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-10T01:37:54.130

在 Delphi XE5 中，Embarcadero 通过添加`(Now - Start > 1 / MSecsPerDay) or`到`repeat until`循环中解决了这个问题，`CleanEventList`这样它会在 1 毫秒后放弃。然后它会删除该事件，无论是否`Lock`为`0`。*

# facebook - 将 Facebook 点赞链接到图片（来自我的网站）

> ID：14217740
> 
> 赞同：1
> 
> 时间：2013-01-08T14:57:50.960
> 
> 标签：facebook, facebook-like

我这里有个小问题。不知道这是否可能。

简而言之：我想在我的网站上显示连接到图像的相同 Facebook 点赞按钮，并且能够从我的网站单击点赞按钮来点赞该图像。

我曾尝试使用各种链接，希望能对此提供任何帮助！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:04:23.167

I got a Like button from facebook , I have a page there go to its admin panel, then from the sidebar there is a link named as resources. go to that page you will find like button there Thanks, Shah Rukh

# c# - 长时间运行任务的视觉反馈

> ID：14217742
> 
> 赞同：0
> 
> 时间：2013-01-08T14:57:55.487
> 
> 标签：c#, winforms

我有一个长时间运行的 for-each 循环，并且想知道是否有一种惯用的方式来添加一些视觉用户反馈，这样用户就不会认为应用程序崩溃了。

```
private void btnRunLongRunningTask_Click(object sender, EventArgs e)
{
    foreach(string path in Directory.EnumerateFiles(@"path"), "*.ext", SearchOption.AllDirectories))
    {
        var result = LongRunning.Task(path);
        string resultPath = Manipulate(path);
        // write result to resultPath
    }
} 
```

这可能会有所帮助：任务本身并不需要很长时间，但可能会有很多。

关于我如何做到这一点的任何建议？由于我得到了一个目录作为参数，我想我会查看任务将执行多少次，然后相应地更新进度条，在后台工作人员中运行任务和更新代码，注意跨线程访问问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T15:01:34.040

您可以将工作移至 BackgroundWorker 并使用 ReportProgress 方法。

```
for (i = 0; i < count; i++)
{
    // do work
    worker.ReportProgress((100 * i) / count);
}

private void MyWorker_ProgressChanged(object sender,
    ProgressChangedEventArgs e)
{
    taskProgressBar.Value = Math.Min(e.ProgressPercentage, 100);
} 
```

# eclipse - 黑莓：使用观察者模式

> ID：14217743
> 
> 赞同：-2
> 
> 时间：2013-01-08T14:57:56.453
> 
> 标签：eclipse, list, blackberry, java-me

我正在做一个在列表字段中显示新闻的项目。新闻以 XML 形式从 Web 服务返回。作为 blackberry 的 Java 新手，我通过浏览、研究和提问取得了一些进展。

我已经能够

1.  获取从 Web 服务返回的 xml

2.  通过 DOM/SAX 解析器解析 xml

3.  将数据添加到向量

4.  并使用列表字段显示数据

问题：假设用户当前正在查看或滚动列表而他不知道或不知道，我如何使用新的或当前的新闻（数据）更新列表字段。

建议：从我的小研究中，我发现这可以使用观察者模式来实现。如何？如果可能，示例代码或片段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T10:24:35.050

首先，观察者模式只有在你有办法监听远程数据的变化时才有意义（即：如果你的服务器在数据变化时向 BB 发送了推送消息）。由于您必须提取数据，因此您没有在听任何内容，您需要的只是在每次 WS 调用后更新列表。

要更新列表，请查看[`ObjectListField`](http://www.blackberry.com/developers/docs/5.0.0api/index.html)类中的方法。您可以插入和删除单行。要更新单行或多行，您必须设置整个数组。修改后，只需在字段上调用 ​​invalidate 即可。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-08T20:45:46.310

在 Java 库中，您可以找到 Observer 接口和 Observable 类。使您想要观察的对象（在本例中为 listField）继承了 Observable 类。然后创建一个实现 Observer 接口的类，这个类会更新你的数据。更多：[http ://docs.oracle.com/javase/1.4.2/docs/api/java/util/Observer.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Observer.html)

问题是可观察对象必须更改其状态以提醒观察者并更新数据。但正如我所见，这是该模式的强制实施。建议你多研究。

# tcl - 如何在 tcl 中对数组进行排序？

> ID：14217744
> 
> 赞同：1
> 
> 时间：2013-01-08T14:57:56.447
> 
> 标签：tcl, sorting

我有一个这种类型的数组：

```
cat1 A B C 12
cat1 E F G 10
cat2 C F G 4
cat2 H F S 12
cat3 F G M -12
... 
```

我不知道我有多少个类别可供输入。

我想按类别在输出一个文件中，按最后一列排序

```
cat1 E F G 10
cat1 A B C 12 
```

对于第一个文件

```
cat2 C F G 4
cat2 H F S 12 
```

对于第二个文件等....

我试过这个：

我把每一行都放在 $list {{cat1 ABC 12} {cat1 EFG 10} .....}

之后，我对其进行排序：

设置列表 [lsort -index 4 -real $list]

```
foreach element $list {
            regexp {.*} [lindex [split $element " "] 0] start
            set table_cat($start) "$element"
    } 
```

之后，我写文件：

```
 foreach element [array names table_cat] {
            set thefile [open "cat_$element.txt" "w"]
            puts $thefile "$table_cat($element)"
    } 
```

但我在结果行中只有 1 行！

为什么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:11:37.800

我不确定这`regexp`是关于什么的，因为你可以简单地写，

```
set start [lindex [split $element " "] 0] 
```

但也许还有更多内容，您简化了示例。

无论如何，每个文件只看到一个结果的原因是您`table_cat($start)`每次都在覆盖。你可能想要做的更像是

```
lappend table_cat($start) "$element" 
```

（顺便说一下，`lappend`如果它不存在，将创建一个列表——所以不需要“初始化”。）

然后，你想像这样迭代：

```
foreach cat [array names table_cat] {
    foreach line $table_cat($cat) {
        // write $line to the file for $cat
    }
} 
```

* * *

我不得不说，你的命名有点奇怪。我会这样写，但对每个人都是他/她自己的：

```
foreach line $lines {
    set category [lindex [split $line " "] 0]
    lappend lines_by_category($category) $line
}

foreach category [array names lines_by_category] {
    set file [open "cat_$category.txt" "w"]
    foreach line $lines_by_category($category) {
        puts $file $line
    }
} 
```

# c++ - 在成员函数中测试 this 指针是否合法 C++？

> ID：14217746
> 
> 赞同：4
> 
> 时间：2013-01-08T14:58:03.550
> 
> 标签：c++, null, this

我有一个涉及不同类类型对象的应用程序。对象由指针引用。空指针表示关联对象不存在。目前调用代码比较繁琐，因为每次使用指向对象的指针时，都会检测指针值是否为空，并采取适当的措施使其为空。因为在不存在的情况下要采取的默认操作取决于对象的类型，所以我更愿意在对象本身的类中而不是在调用程序中对其进行编码。这导致如下结构：

```
class C
{ ... 
  void member_func() //non-virtual !
  { if (this) { do something with the object ... }
    else { take some default action }
  }
  ...
}; 
```

显然成员函数不能是虚函数，因为当对象不存在时查找表也不存在，虚调用就会失败。但是这段代码对于非虚拟成员函数来说是合法的 C++ 吗？对于我尝试过的编译器，它似乎可以正常工作，但我担心可能的不可移植性。在标准中，我找不到明确允许或明确禁止此类结构的条款。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-08T14:59:11.023

`this`在成员函数中永远不会为空，因此您执行的检查是无用的。

正如 Matthieu M. 在评论中指出的那样，如果您在代码中执行以下操作：

```
C* c = 0; 
c->member(); 
```

这会导致**未定义的行为**，这很**糟糕**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-08T15:19:05.627

正如已经指出的，`this`永远不能是空指针。如果是，您已经调用了未定义的行为。相反，您可以创建一组重载函数，如下所示：

```
void DoTheThing(C* cp)
{
    if (cp)
        cp->member_func();
    else
    {
        // take some default action
    }
}

void DoTheThing(B* bp)
{
    if (bp)
        bp->some_other_member_func();
    else
    {
        // take some default action
    }
} 
```

如果您要调用的函数在每个类中具有相同的名称，那么您可以在每个类中创建一个静态函数，该函数执行该类的默认操作（都具有相同的名称），并制作一个模板：

```
template<typname T>
void DoTheThing(T* tp)
{
    if (tp)
        tp->member_func();
    else
        T::default_action()
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T15:01:07.170

就标准而言，该代码是不合法的，**但**它在实践中被使用（这是不好的做法）。

事实上，IIRC MFC 在内部使用这些检查。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T15:10:34.803

*检查*是否`this == NULL`没有问题。通过 NULL 对象指针*调用方法是。*

如果您想将检查保存在某处，您可以将它放在一个智能指针类中，如果持有的指针为 NULL，该类可以采取适当的操作。如果“适当的操作”由所持有的类型唯一确定，则可以使用特征类来指定它。

这样，您的 NULL 检查和它们的逻辑保持在一起，而不是混入调用者或方法代码。

* * *

```
// specialize this to provide behaviour per held type
template <typename T> struct MaybeNullDefaultAction {
    void null_call() { throw std::runtime_error("call through NULL pointer"); }
}

template <typename T> class MaybeNull: MaybeNullDefaultAction<T> {
    T *ptr;
public:
    explicit MaybeNull(T *p) : ptr(p) {}

    T* operator-> () {
        if (!ptr)
            null_call();
        // null_call should throw to avoid returning NULL here
        return ptr;
    }
}; 
```

不幸的是，我看不到不投掷的方法。没有办法拦截所有方法名称的函数调用，否则我只会`*this`从.`operator->``operator()`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T15:45:59.723

我认为不允许这样做。您要求参考标准。我相信首先感兴趣的是 9.3.1 非静态成员函数，1.：

> 可以使用类成员访问语法 (5.2.5, 13.3.1.1) 为其类类型的对象或从其类类型派生的类的对象（第 10 条）调用非静态成员函数。

其次我们看5.2.5类成员访问，2.：

> 表达式 E1->E2 被转换为等价形式 (*(E1)).E2；5.2.5 的其余部分将仅解决第一个选项（点）。

因此，如果 E1 是 a `nullptr`，则 *E1 将不被允许。所以至少是我的猜测。

# sql - 将日期转换为 YYYYMM 格式

> ID：14217751
> 
> 赞同：58
> 
> 时间：2013-01-08T14:58:22.097
> 
> 标签：sql, sql-server, tsql

我想选择价值=`201301`

```
select getdate(), cast(datepart(year, getdate()) as varchar(4))+cast(datepart(MONTH, getdate()) as varchar(2)) 
```

它返回`20131`

这样做的正常方法是什么？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2013-01-08T15:01:44.410

```
SELECT CONVERT(nvarchar(6), GETDATE(), 112) 
```

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2013-01-08T15:03:20.137

```
SELECT LEFT(CONVERT(varchar, GetDate(),112),6) 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2018-04-18T02:57:28.187

我知道这是一个老话题，但如果你的`SQL server`版本高于 2012。

还有一个简单的选项可以选择，[FORMAT](https://docs.microsoft.com/en-us/sql/t-sql/functions/format-transact-sql?view=sql-server-2017)功能。

```
SELECT FORMAT(GetDate(),'yyyyMM') 
```

[sqlfiddle](http://sqlfiddle.com/#!18/9eecb/13149)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-18T16:56:42.727

实际上，这*是*获得所需内容的正确方法，除非您可以使用 MS SQL 2014（它最终启用了日期时间的自定义格式字符串）。

要获得`yyyymm`而不是`yyyym`，您可以使用这个小技巧：

```
select 
 right('0000' + cast(datepart(year, getdate()) as varchar(4)), 4)
 + right('00' + cast(datepart(month, getdate()) as varchar(2)), 2) 
```

它比获取`convert(..., 112)`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-01-11T16:34:33.867

一种更有效的方法，它使用整数数学而不是字符串/varchars，这将导致 int 类型而不是字符串类型是：

```
SELECT YYYYMM = (YEAR(GETDATE()) * 100) + MONTH(GETDATE()) 
```

在年份的右侧添加两个零，然后将月份添加到添加的两个零。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-11T15:25:58.797

您可以将日期转换为多种格式，例如：

```
CONVERT(NVARCHAR(10), DATE_OF_DAY, 103) => 15/09/2016
CONVERT(NVARCHAR(10), DATE_OF_DAY, 3) => 15/09/16 
```

语法：

```
CONVERT('TheTypeYouWant', 'TheDateToConvert', 'TheCodeForFormating' * ) 
```

*   代码是一个整数，这里 3 是没有世纪的第三种格式，如果你想要世纪，只需将代码更改为 103。

**在您的情况下**，我刚刚通过 nvarchar(6) 转换并限制大小，如下所示：

```
CONVERT(NVARCHAR(6), DATE_OF_DAY, 112) => 201609 
```

查看更多：[http ://www.w3schools.com/sql/func_convert.asp](http://www.w3schools.com/sql/func_convert.asp)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-01-08T15:01:32.657

现在是第 1 个月，所以你得到了一个期望值。根据这个答案，您必须将月份（1-> 01）归零：[How do I convert an int to a zero padded string in T-SQL?](https://stackoverflow.com/questions/309165/how-do-i-convert-an-int-to-a-zero-padded-string-in-t-sql)

# visual-studio - 什么编程语言？

> ID：14217753
> 
> 赞同：1
> 
> 时间：2013-01-08T14:58:23.300
> 
> 标签：visual-studio, programming-languages

我获得了这个源代码，但我不知道是什么语言以及如何打开它。我可以使用 Visual Studio 打开它吗？（没有找到项目文件）

![在此处输入图像描述](../Images/dc57ce514062895fee32fabc68254412.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:01:00.887

它们是 Visual Basic 6 文件，您需要拥有旧版本的 Visual Studio 才能通过导入器打开它，因为较新的版本不支持 .NET 之前的版本。

您可以在 Visual Studio 2008 或之前根据本教程执行此操作：http: [//msdn.microsoft.com/en-us/library/aa260644.aspx](http://msdn.microsoft.com/en-us/library/aa260644.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T15:13:04.603

老派VB。.NET 之前。在 Visual Studio 6.0 中打开 VBP。如果你打开它，它会尝试升级它，你可能会遇到很多编译错误。.NET 和 6.0 完全不同。如果您有 MSDN，您仍然可以访问旧版本的 Visual Studio 或 VB。祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T15:00:47.733

对我来说看起来像 Visual Basic。请参阅[此处了解此处使用的文件类型](http://www.hitmill.com/programming/vb/filetypes.html)

更准确地说，您需要提供一些示例内容。:)

# c++ - 访问冲突读取位置 0xfeeefef2 多线程编程 c++ windows

> ID：14217762
> 
> 赞同：0
> 
> 时间：2013-01-08T14:58:44.330
> 
> 标签：c++, multithreading

我有执行以下操作的代码：

- 生成一个包含“e”个节点的链表，每个节点都分配了一个随机值，以及工人编号

- 创建 w 个线程，如果节点的 worker 编号等于他的线程 id，则每个线程在列表中进行 ckeck，如果是，则从该值生成 sqrt

-当列表中的5个或所有值都小于2时，主线程从列表中删除小于2的元素

- 一次只能运行 3 个线程。

这是代码：

```
DWORD WINAPI work(LPVOID argument){
    int tid = *((int *)argument);
    elem* p = head;
    while(p!=NULL){
        if (tid == p->worker){
            WaitForSingleObject(semaphor, 0L);
            double val = p->value;
            p->value = sqrt(val);
            if (p->value < 2){
                EnterCriticalSection(&countMutex);
                count++;
                if(count == maxCount){
                    WakeConditionVariable (&conditionalVar);
                }
                LeaveCriticalSection(&countMutex);
            }       
            Sleep(1);
            ReleaseSemaphore(semaphor, 1L, NULL);
        }
        if (p->next == NULL)
            p = head;
        else 
            p = p->next;
    }

    return NULL;
}

int _tmain(int argc, _TCHAR* argv[])
{
    //generate list, create threads (the threads are assigned to the work function)

    EnterCriticalSection(&countMutex);
    while(e > 0){
        SleepConditionVariableCS(&conditionalVar, &countMutex, INFINITE);
        deleteElements();
        if (e < 5)
            maxCount = e;
        count = 0;
        cout << "After erasure: \n";
        printList();
        cout << "\n";
    }
    LeaveCriticalSection(&countMutex);

    //free space
} 
```

问题是在第一次删除后，我收到错误“mainW.cpp.exe 中 0x00fe1c8e 处的未处理异常：0xC0000005：访问冲突读取位置 0xfeeefef2。”

我确实意识到这意味着我试图在某个地方访问一个已经被删除的值，但我不知道为什么，因为列表是同步的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:15:29.477

您正在遍历列表而没有任何锁。

```
if (p->next == NULL)
    p = head;
else 
    p = p->next; 
```

如果主线程刚刚删除`p->next`怎么办？

# javascript - 单击 div 内的任何内容时的 jQuery 事件单击

> ID：14217766
> 
> 赞同：0
> 
> 时间：2013-01-08T14:59:02.057
> 
> 标签：javascript, jquery

我有这个 jQuery：

```
$("div.result").live("click", function(event){
alert("kokoko");
}); 
```

HTML 可以是：

```
<div id="result">
Flash banner code
Image with link 
etc.
</div> 
```

我想要做的是在单击 div 持有者内的任何元素时触发警报。目前，当结果中有图像横幅时，不会触发警报。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T14:59:49.373

尝试：

```
$("#result").on("click", function(){
    alert("kokoko");
});

// or

$("#result").click(function(){
    alert("kokoko");
});

// or just pure JavaScript

document.getElementById("result").addEventListener("click",function(){
    alert("kokoko");
}); 
```

`addEvent`尽管使用像这样的纯 JavaScript（使用和`removeEvent`函数）解决跨浏览器问题是一个很好的做法：

```
(function(){
    if ( document.addEventListener ) {
        this.addEvent = function(elem, type, fn) {
            elem.addEventListener(type, fn, false);
            return fn;
        };

        this.removeEvent = function(elem, type, fn) {
            elem.removeEventListener(type, fn, false);
        };
    } else if ( document.attachEvent ) {
        this.addEvent = function(elem, type, fn) {
            var bound = function() {
                return fn.apply(elem, arguments);
            };
            elem.attachEvent("on" + type, bound);
            return bound;
        };

        this.removeEvent = function (elem, type, fn) {
            elem.detachEvent("on" + type, fn);
        };
    }
})(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-08T15:01:41.857

切勿使用或推荐已弃用的[.live()](http://api.jquery.com/live/) ...

```
$("#result").on("click", function(event){
alert("kokoko");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T15:01:59.617

这应该这样做：

```
$("#result").on("click", function(){
    alert("it worked!");
}); 
```

不推荐使用 live

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T15:02:42.450

应该是 div#result .result 将是一个类。另外，尽量不要使用 live，而是使用 .on() 。

# javascript - 如何在 Phonegap 中只加载一次 JS 库？

> ID：14217772
> 
> 赞同：0
> 
> 时间：2013-01-08T14:59:28.580
> 
> 标签：javascript, jquery, cordova, jquery-mobile

我如何才能为 Phonegap 中的多个 HTML 页面仅归档一次加载 JS 库。

我有这个项目：

```
./index.html

./FoderA/index.html

./FoderB/index.html
.... 
```

并且在每个 index.html 中我都使用了 cordova2.2.0.js，但性能会有所降低。我可以加载一次 JS 库（cordova、jquerymobile、....）吗，例如在`./index.html`应用程序启动时？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:31:45.643

好吧，如果您导航到新页面，则需要重新加载所有 JavaScript，因此避免这种情况的方法是不要导航到新页面。您可以使用 Ajax 加载第二个页面并将其添加到您的 DOM 来完成此购买。看看Bryce 推出他自己的 loadPage 功能的这篇[好文章。](https://www.ibm.com/developerworks/mydeveloperworks/blogs/94e7fded-7162-445e-8ceb-97a2140866a9/entry/dynamic_page_loading_for_phonegap1?lang=en)

[jQuery Mobile](http://jquerymobile.com/test/docs/api/methods.html)和 Dojo等其他 JavaScript 框架也允许您执行此操作，但您需要加载这些框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:45:34.167

你可以试试[这个框架](http://cordova.codeplex.com)。以下是我的一个项目中的示例 index.html：

```
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dark Maze</title>
<script src="Scripts/cordova/cordova-2.2.0.js" type="text/javascript"></script>
<script src="Scripts/jquery/jquery-1.7.2.min.js" type="text/javascript"></script>

<script src="Scripts/novas/nova.all.js" type="text/javascript"></script>
<script src="Scripts/maze/maze.data.js" type="text/javascript"></script>

</head>

<body>
<div id="themes">
    <link href="themes/nova.ui.core.css" rel="stylesheet" />
    <link href="themes/nova.ui.content.css" rel="stylesheet" />
</div>
<div id="body">
    <script language="javascript" type="text/javascript">
        $(document).ready(function () {
            nova.application.start("home.html");
        });
    </script>
</div>
</body>
</html> 
```

实际上，所有其他页面都将通过 ajax 调用加载到 div#body 中。其他页面不需要包含<head>或<body>，只需要从<div>开始

home.html：

```
<style>
#content {
    width: 100%;
    min-height: 100%;
    position: relative;
}
.content-w1 {
    padding: 15px;
    padding-bottom: 20px;
}
#links {
    position: absolute;
    bottom: 0px;
    width: 100%;
    text-align: center;
    line-height: 20px;
}
.content-w1 h1 {
    background-color: #FFFCE5;
    text-align: center;
    margin: 0px;
    padding: 10px 0px;
    color: #30C5F2;
    font-size: 25px;
    font-weight: bold;
    margin-bottom: 20px;
    border-radius: 5px;
}

</style>

<div id="content">
<div class="content-w1">
    <div class="logo-home"></div>
    <ul class="color-blocks">
        <li>Never</li>
        <li>Lose</li>
        <li>Your</li>
        <li>Hope</li>
        <li>.</li>
    </ul>
    <ul class="menu">
        <li id="linkLevels">Choose Level</li>
        <li id="linkHelp">Help</li>
        <li id="linkQuickStart">
            Quick Start
            <small id="quickstartLevel">Level 1</small>
        </li>
    </ul>
    <div class="challenge">
    </div>
</div>
<div id="links">
    &copy;2012, NovaSoftware.com, 
    <i>v1.0</i>
</div>
</div>
<script language="javascript" type="text/javascript">

nova.application.currentPage.onLoaded(function () {
    function init() {
        if (window.DbService == undefined) {
            return;
        }

        var service = new DbService();
        var quickStart = 1;
        service.init(function () {
            service.getQuickStartLevel(function (level) {
                $("#quickstartLevel").html("Level " + level);
                quickStart = level;
            });
        });

        nova.touch.bindClick("#linkQuickStart", function () {
            alert("linkQuickStart");
            var page = new nova.Page("pages/game.html");
            page.level = quickStart;
            nova.application.gotoPage(page);
        });
        nova.touch.bindClick("#linkLevels", function () {
            nova.application.gotoPage("pages/levels.html");
        });
        //nova.application.gotoPage("pages/levels.html");
    }

    init();
});

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T20:54:04.950

您应该使用 Ajax 将所有 js 库和 css 加载到 DOM

# r - 在时间序列上转换时间

> ID：14217777
> 
> 赞同：2
> 
> 时间：2013-01-08T14:59:38.150
> 
> 标签：r, time-series, zoo, posixct

我正在阅读降水时间序列的 csv 文件，问题是时间是什么时候`00:00`。

```
head(C1)
            fecha precip
1      09/04/2012      0
2 09/04/2012 0:05      0
3 09/04/2012 0:10      0
4 09/04/2012 0:20      0
5 09/04/2012 0:25      0
6 09/04/2012 0:30      0 
```

我正在尝试获取一个动物园对象，但如果我将时间更改为 POSIXct 或 POSIXlt：

```
C1$fecha <- as.POSIXct(C1$fecha, format="%d/%m/%Y %k:%M") 
```

我在有问题的日期得到 NA。

```
head(C1)
                fecha precip
1                <NA>      0
2 2012-04-09 00:05:00      0
3 2012-04-09 00:10:00      0
4 2012-04-09 00:20:00      0
5 2012-04-09 00:25:00      0
6 2012-04-09 00:30:00      0 
```

对此有任何提示吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:15:47.630

一种解决方案是查找较短的字符串，即没有时间信息。然后`0:00`在转换为日期时间对象之前连接到这些字符串中的每一个：

创建样本数据：

```
x <- c("09/04/2012", "09/04/2012 0:05", "09/04/2012 0:10", "09/04/2012 0:20", 
       "09/04/2012 0:25", "09/04/2012 0:30") 
```

用于`nchar()`标识长度仅为 10 个字符的元素。然后`paste()` `0:00`到这些元素：

```
index <- sapply(x, nchar) == 10
x[index] <- paste0(x[index], " 0:00")

as.POSIXct(x, format="%d/%m/%Y %k:%M")

[1] "2012-04-09 00:00:00 BST" "2012-04-09 00:05:00 BST" "2012-04-09 00:10:00 BST"
[4] "2012-04-09 00:20:00 BST" "2012-04-09 00:25:00 BST" "2012-04-09 00:30:00 BST" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:48:15.293

如果`x`是您的日期和日期/时间向量，请尝试以下操作：

```
as.POSIXct(paste(x, "00:00"), format = "%m/%d/%Y %k:%M") 
```

# java - 爪哇@ 和编码

> ID：14217779
> 
> 赞同：1
> 
> 时间：2013-01-08T14:59:48.313
> 
> 标签：java, compilation, javac

我正在尝试在我的计算机上用法语在 Windows 7 下编译一些 java 文件；我觉得我在文件结束时遇到了一些麻烦......

第一步，我生成要编译的文件列表：

```
dir src\*.java /B/S > javasrc.tmp~ 
```

这将在文件“javasrc.tmp~”中逐行写入目录src的java文件的完整路径（递归）。就我而言，我有：

```
C:\Users\Alexandre\Développement\Java\src\testA.java
C:\Users\Alexandre\Développement\Java\src\testB.java
[...] 
```

（请注意，我的完整路径中有一个重音字母）

在第二步中，我使用以下命令编译所有源文件：

```
"%JAVA_HOME%\bin\javac.exe" @javasrc.tmp~ 
```

我得到这个错误：

```
javac: file not found: C:\Users\Alexandre\Développement\Java\src\testA.java 
```

在 Notepad++ 中打开我的 javasrc.tmp~ 文件时，文件显示为：

```
C:\Users\Alexandre\D,veloppement\Java\src\testA.java
C:\Users\Alexandre\D,veloppement\Java\src\testB.java
[...] 
```

重音字母显示为逗号；我必须选择 OEM 863 文件编码才能正确显示文件的内容。

那么如何解决我的问题呢？（我将这些命令用作 bat 文件中的自动化过程）。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:07:51.153

最好的方法是更改​​为 ant 或 maven，而不是 bat 文件。它更标准，也更便携。

一个基本的 ant 文件将被命名为 build.xml，看起来像这样：

```
<project name="My Project Name Here" basedir="." default="main">

<property name="lib.dir" value="lib"/>

<path id="classpath">
<fileset dir="${lib.dir}" includes="**/*.jar"/>
</path>

<property name="src.dir" value="src"/>

<property name="build.dir" value="build"/>
<property name="classes.dir" value="${build.dir}/classes"/>
<property name="jar.dir" value="${build.dir}/jar"/>

<property name="main-class" value="My Main Class Name Here"/>

<target name="clean">
<delete dir="${build.dir}"/>
</target>

<target name="compile">
<mkdir dir="${classes.dir}"/>
<javac srcdir="${src.dir}" destdir="${classes.dir}" classpathref="classpath"/>
</target>

<target name="jar" depends="compile">
<mkdir dir="${jar.dir}"/>
<jar destfile="${jar.dir}/${ant.project.name}.jar" basedir="${classes.dir}">
<manifest>
<attribute name="Main-Class" value="${main-class}"/>
</manifest>
</jar>
</target>

<target name="run" depends="jar">
<java fork="true" classname="${main-class}">
<classpath>
<path refid="classpath"/>
<path location="${jar.dir}/${ant.project.name}.jar"/>
</classpath>
<arg value="RIMM" />
</java>
</target>

<target name="clean-build" depends="clean,jar"/>

<target name="main" depends="clean,run"/>

</project> 
```

# php - 如果声明为 $var（不是 $this->var），如何在 PHP 类中共享一个变量

> ID：14217782
> 
> 赞同：0
> 
> 时间：2013-01-08T14:59:51.337
> 
> 标签：php, class, variables, scope

我知道最好按照预期的方式做事，使用 $this->fname 在类中声明和设置变量......我明白了......

但是为了不让这个问题太长，假设我的类中有一个函数，可以将数据提取并解析为 $var=""; 中设置的大量变量。方式。

说.. $fname = "Sollenn"; $年龄=“20”；

我在同一个类中有另一个函数，稍后我应该在我的代码中调用它，并且这个函数需要以相同的方式调用这些变量

```
$currentName = $fname;
etc.. 
```

如果我尝试在第一个函数中正确设置类变量 $this->fname，则第二个函数/例程将中断..

而且我也不能全局化 $fname 等变量。因为我需要变量留在课堂上

有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:03:09.433

通过仅声明一个变量`$var = "value";`，您就是在本地堆栈中声明该变量。当函数执行完成时堆栈被清除，并且堆栈不能从函数范围之外访问。

您将不得不使用：

*   实例变量（你说你不能，虽然我想看看当你尝试使用它们时会发生什么，因为我怀疑你只是没有正确使用这里的变量）。
*   静态类变量（但是如果您需要这些变量对于对象的每个实例都不同，这显然是行不通的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:05:30.643

让您的第一个方法返回数组，然后在需要时将其传递给第二个方法

```
Class Foo
{

     public function first()
     {
          // process that builds an array

          return $array;
     }

     public function second($array)
     {
          // do something with array
     } 
}

$foo = new Foo;

$array = $foo->first();

// other stuff in code

$foo->second($array); 
```

编辑：考虑一下，没有必要将数组存储在类之外

```
class Bar
{
     protected $array_from_first;

     public function first()
     {
          $this->array_from_first = $array;
     }

     public function second()
     {
          $array = $this->array_from_first;
     }
} 
```

# html - 在绝对 div 上设置高度 100%

> ID：14217783
> 
> 赞同：54
> 
> 时间：2013-01-08T14:59:52.640
> 
> 标签：html, css, absolute

我面临**覆盖 100% 高度 div**的问题。我可以使用固定位置来解决封面问题，但这并不是我真正想要的，因为您应该能够向下滚动“封面”> 所以分辨率低于我的人可以看到整个内容。

代码示例：

HTML

```
<body>
<div>Overlay example text</div>
</body> 
```

CSS

```
body {
    float: left;
    height: 3000px;
    width: 100%;
}
body div {
    position: absolute;
    height: 100%;
    width: 100%;
    background-color: yellow;
} 
```

**问题：** div 的高度 100% 只包含 100% 的 webbrowser/viewport，但我希望它覆盖整个身体。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-01-08T15:01:48.713

尝试添加

```
position:relative 
```

适合你的体型。每当绝对定位任何东西时，您都需要将父容器或祖先容器之一相对定位（或静态的默认位置以外的任何东西），因为这将使项目相对于所定位的祖先容器绝对定位。

由于您没有定位元素，css 将不知道 div 绝对定位到什么，因此不知道要采用 100% 的高度

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2013-01-08T15:04:16.570

[http://jsbin.com/ubalax/1/edit](http://jsbin.com/ubalax/1/edit)。你可以在这里看到结果

```
body {
    position: relative;
    float: left;
    height: 3000px;
    width: 100%;
}
body div {
    position: absolute;
    height: 100%;
    width: 100%;
    top:0;
    left:0;
    background-color: yellow;
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-01-08T15:08:04.443

很少有答案给出高度和宽度为 100% 的解决方案，但我建议您不要在 css 中使用百分比，使用顶部/底部和左/右定位。

这是一种更好的方法，可以让您控制保证金。

这是代码：

```
body {
    position: relative;
    height: 3000px;
}
body div {

    top:0px;
    bottom: 0px;
    right: 0px;
    left:0px;
    background-color: yellow;
    position: absolute;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-01-30T20:39:04.983

# 完全拉伸（水平/垂直）

接受的答案很棒。只是想为其他来这里的人指出一些事情。在这些情况下，边距不是必需的。如果您想要一个具有特定“边距”的居中布局，您可以将它们添加到右侧和左侧，如下所示：

```
.stretched {
  position: absolute;
  right: 50px;  top: 0;  bottom: 0; left: 50px;
  margin: auto;
} 
```

这是非常有用的。

# 居中 div（垂直/水平）

作为奖励，绝对居中可用于获得极其简单的居中：

```
.centered {
  height: 100px;  width: 100px;  
  right: 0;  top: 0;  bottom: 0; left: 0;
  margin: auto;
  position: absolute;
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-09-26T11:29:08.123

而不是使用`body`， using`html`为我工作：

```
html {
   min-height:100%;
   position: relative;
}

div {
   position: absolute;

   top: 0px;
   bottom: 0px;
   right: 0px;
   left: 0px;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-24T09:49:48.653

另一种不使用任何高度但仍填充 100% 可用高度的解决方案。在 codepen 上检查一下。[http://codepen.io/gauravshankar/pen/PqoLLZ](http://codepen.io/gauravshankar/pen/PqoLLZ)

对于这个 html 和 body 应该有 100% 的高度。此高度等于视口高度。

使内部 div 位置为绝对值，并给出顶部和底部 0。这会将 div 填充到可用高度。（高度等于身体。）

html代码：

```
<head></head>

<body>
  <div></div>
</body>

</html> 
```

CSS代码：

```
* {
  margin: 0;
  padding: 0;
}

html,
body {
  height: 100%;
  position: relative;
}

html {
  background-color: red;
}

body {
  background-color: green;
}

body> div {
  position: absolute;
  background-color: teal;
  width: 300px;
  top: 0;
  bottom: 0;
} 
```

# android - 使用 EXTRA_PLUGGED 获取 USB 电缆插入 IN/OUT 事件不起作用

> ID：14217789
> 
> 赞同：7
> 
> 时间：2013-01-08T15:00:07.060
> 
> 标签：android, android-intent, usb, broadcastreceiver, battery

我的意图是在首选项中保存 Android 设备 USB/电源线的当前状态：已连接/已断开连接。从开发人员网站我看到有两个意图获得该状态：ACTION_POWER_CONNECTED / DISCONNECTED。因此，我使用了与 Developers 上发布的代码相同的代码：

[http://developer.android.com/training/monitoring-device-state/battery-monitoring.html](http://developer.android.com/training/monitoring-device-state/battery-monitoring.html)

在监控充电状态变化部分。

**显现**

```
<receiver android:name=".PowerConnectionReceiver">
  <intent-filter>
    <action android:name="android.intent.action.ACTION_POWER_CONNECTED"/>
    <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED"/>
  </intent-filter>
</receiver> 
```

**Java 代码**

```
public class PowerConnectionReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) { 

        int chargePlug = intent.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1);
        boolean usbCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_USB;
        boolean acCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_AC;

        Toast.makeText(context, "pvr = " + usbCharge + ", " + acCharge + "," + isCharging, Toast.LENGTH_SHORT).show();
    }
} 
```

当我插入 USB 电缆 IN/OUT 时，广播总是正确发送并被 PowerConnectionReceiver 捕获，但结果始终相同（=电缆已拔出）。

我用 Galaxy Nexus 4.1.1 / 4.2.1 对其进行了测试 - 我总是在 Toast 中得到 2xFALSE（chargePlug = FALSE，usbCharge = FALSE）。

**为什么**intent.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1)**总是返回默认值“-1”？**

谢谢你。

附言。如果我在 Java 中注册接收器，一切正常

```
Intent intent = context.registerReceiver(null, new IntentFilter(Intent.ACTION_BATTERY_CHANGED)); 
```

...在服务或活动中。但是根据 Android Developers 网站，不需要使上面的代码返回正确的值；

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-22T23:42:18.877

我正在处理同样的问题，遇到你的帖子。我认为问题在于您提供链接的 Android 培训页面中的代码是错误的。

ACTION_POWER_CONNECTED 和 ACTION_POWER_DISCONNECTED 没有“携带”您从代码中的意图查询的数据。我也无法在我的设备上使用相同的东西（运行 Android 4.3 的第一代 Nexus 7 和运行 Android 2.3.6 的 Nexus One），而且因为它似乎无法在任何地方工作，所以我遇到了“错误代码”结论。

我用下面的代码修复了它。它实际上非常接近您作为修复提供的内容，只是它直接进入我的 BroadcastReceiver 而不是进入活动。在您上面的代码中，此处的代码段将位于以“int chargePlug”开头的行之前。之后，将同一行（您的行）中的“intent”从“int chargePlug”开始更改为“mIntent”。

```
final Intent mIntent = context.getApplicationContext().registerReceiver(null, new IntentFilter(Intent.ACTION_BATTERY_CHANGED)); 
```

请注意，您的 BroadcastReceiver 现在将有两个意图。一个传递给它，这将是包含动作 ACTION_POWER_CONNECTED（或 ACTION_POWER_DISCONNECTED）的意图，另一个是在 BroadcastReceiver 中创建的，专门用于提取电池信息。

如果您将我提供的代码片段放入活动中（它不会连接到您的广播接收器），我提供的代码片段将不起作用，因为参数列表中的值为空。您实际上并没有使用该 null 注册 BroadcastReceiver 。将 null 更改为 BroadcastReceiver 也不理想，因为 ACTION_BATTERY_CHANGED 通知可以触发很多。我很有信心 ACTION_BATTERY_CHANGED 不打算用作广播接收器的触发器。相反，我认为它旨在实时用于获取最后一个“粘性”广播，其中包含有关电池信息更改的信息（在 Android 文档中查找“粘性广播”）。

另请注意，我给出的代码片段在调用链中包含“getApplicationContext()”。把它拿出来，Gingerbread 设备就会崩溃（感谢 CommonsWare）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-05T06:07:23.020

我不确定您为什么会遇到问题，但对我有用的是注册 ACTION_POWER_CONNECTED 和 ACTION_POWER_DISCONNECTED 操作：

```
<receiver android:name="PowerReceiver" >
    <intent-filter>
        <action android:name="android.intent.action.ACTION_POWER_CONNECTED" />
        <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED" />
    </intent-filter>
</receiver> 
```

并像这样实现广播接收器：

```
public class PowerReceiver extends BroadcastReceiver {

    @Override public void onReceive(Context context, Intent intent) {
        if(intent.getAction() == Intent.ACTION_POWER_CONNECTED) {
            //Handle power connected
        } else if(intent.getAction() == Intent.ACTION_POWER_DISCONNECTED){
            //Handle power disconnected
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-16T08:40:01.753

```
public class PowerConnectionReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        final Intent mIntent = context.getApplicationContext().registerReceiver(null, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));

        int status = mIntent.getIntExtra(BatteryManager.EXTRA_STATUS, -1);
        boolean isCharging = status == BatteryManager.BATTERY_STATUS_CHARGING || status == BatteryManager.BATTERY_STATUS_FULL;

        int chargePlug = mIntent.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1);
        boolean usbCharge = chargePlug == BATTERY_PLUGGED_USB;
        boolean acCharge = chargePlug == BATTERY_PLUGGED_AC;

    }
} 
```

# javascript - 访问 JSON 数组中的对象 (JavaScript)

> ID：14217790
> 
> 赞同：17
> 
> 时间：2013-01-08T15:00:07.427
> 
> 标签：javascript, arrays, json, object

> **可能重复：**
> [我有一个嵌套的数据结构/JSON，我怎样才能访问一个特定的值？](https://stackoverflow.com/questions/11922383/i-have-a-nested-data-structure-json-how-can-i-access-a-specific-value)

我有一个在 JSON 数组中返回嵌套对象的服务。如何遍历对象并打印所需的数据？

这是我的结果：

```
[
{
    "item1": {
        "sourceUuid": "5599ffac-4b99-47c7-9370-a25e7e465429",
        "targetUuid": "5599ffac-4b99-47c7-9370-a25e7effffff"
    }
},
{
    "item2": {
        "sourceUuid": "bf63fe50-8b2b-488d-b565-009fcaebdb45",
        "targetUuid": "-1"
    }
},
{
    "item3": {
        "sourceUuid": "0005fd96-f654-4781-8602-09fedc0cdd35",
        "targetUuid": "0005fd96-f654-4781-8602-09fedc0cdd35"
    }
}
] 
```

这是我要为每个项目（item1、item2、item3、...）打印的内容：

```
Item Name: item1
Source: 5599ffac-4b99-47c7-9370-a25e7e465429
Target: 5599ffac-4b99-47c7-9370-a25e7effffff 
```

到目前为止，我尝试过：

```
for (var i = 0, length = data.length; i < length; i++) {
for (obj in data[i]) {
    console.log(obj);

}
} 
```

这只会返回“item1”、“item2”等。但我不知道如何从那里访问 sourceUuid 等

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-08T15:03:29.097

您可以使用 for 循环循环数组，[使用](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)[for-in 循环循环](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in)对象属性。

```
for (var i=0; i<result.length; i++)
    for (var name in result[i]) {
        console.log("Item name: "+name);
        console.log("Source: "+result[i][name].sourceUuid);
        console.log("Target: "+result[i][name].targetUuid);
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-08T15:01:58.730

使用循环

```
for(var i = 0; i < obj.length; ++i){
   //do something with obj[i]
   for(var ind in obj[i]) {
        console.log(ind);
        for(var vals in obj[i][ind]){
            console.log(vals, obj[i][ind][vals]);
        }
   }
} 
```

演示：http: [//jsfiddle.net/maniator/pngmL/](http://jsfiddle.net/maniator/pngmL/)

# google-app-engine - App Engine 上的实际 NDB count() 限制是多少？

> ID：14217795
> 
> 赞同：4
> 
> 时间：2013-01-08T15:00:15.777
> 
> 标签：google-app-engine, app-engine-ndb

我们正在尝试使用 NDB 查询 App Engine 数据存储区以获取一些常规统计信息。它们不需要 100% 准确（即，我不关心最终的一致性）；他们只需要大致反映实体的数量。

使用 NDB，我们发布的内容很简单，例如：

```
query = MyModel.query(MyModel.source==source, MyModel.created<=some_time).order(-MyModel.created)
count = query.count(keys_only=True) 
```

这是在大约 60 年代后超时。我们经常使用实体组和事务，但我希望这些不会影响这些计数查询。我们目前有大约 420 万个实体`MyModel`，但`source`过滤器会将其限制为大约 210,000 个。

是否有另一种方法来计算这种数量级的数字，而不需要一堆自定义的 memcache-y 逻辑？请记住，数字不需要精确，只需“大致正确”即可。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T15:12:32.390

我相信这个限制，以前是 1000，现在已经被取消了。所以实际的限制是在超时之前可以计算多少。

已经提出了一些类似的问题，通常[此时会提出分片计数器](http://code.google.com/appengine/articles/sharding_counters.html)。

~~但我认为您最好将计数器作为任务（超时时间为 10 分钟）或在后端（根本没有超时）运行。~~

正如 Guido 在评论中指出的那样，**查询时间不能超过 60 秒。**

编辑：前段时间删除了 1000 限制，1.3.6： [发行说明：](http://googleappengine.blogspot.co.uk/2010/08/multi-tenancy-support-high-performance_17.html)

> 数据存储不再对计数和偏移实施 1000 个实体的限制。使用这些的查询现在将安全地执行，直到它们返回或您的应用程序达到请求超时限制。

# ios - UIScrollView 布局更改

> ID：14217799
> 
> 赞同：0
> 
> 时间：2013-01-08T15:00:29.080
> 
> 标签：ios, layout, uiscrollview, uiimageview, uipagecontrol

我有一个带有一堆图像的 UIScrollView。到目前为止，我已经设法在布局更改时更改滚动视图及其 UIImageViews 的大小。但问题是，当布局发生变化时，图像似乎“摆动”而不是围绕其中心点旋转。这看起来很奇怪，我看到许多具有这种分页的应用程序已经在图像视图上实现了平滑的布局更改动画。我如何实现这一目标？

代码是这样的：

```
viewDidLoad
{
     // Set up scrollview subviews and their content offsets based on NSArray

     // Set up orientation change listener
}

orientationChangeListener
{
     UIImageView *iv = [self.ivScrollView.subviews objectAtIndex: self.ivPager.currentPage];

     self.ivScrollView.layer.anchorPoint = iv.layer.anchorPoint;

     [self.ivScrollView setContentOffset: CGPointMake(self.ivScrollView.frame.size.width * self.current, 0.0) animated:NO
 ];

    switch(orientation){

        case portrait:

              // update scrollview's subview sizes and content offsets
              // code to position the image appropriately based on screen dimensions

               break;

       case landscapeLeft:

              // update scrollview's subview sizes and content offsets
              // code to position the image appropriately based on screen dimensions

               break;

       case landscapeRight:

              // update scrollview's subview sizes and content offsets
              // code to position the image appropriately based on screen dimensions

               break;

    }

} 
```

我希望这能给你这个想法。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T10:03:32.060

**这是以防有人遇到此问题并碰巧找到此页面：**

经过大量研究，我终于按照这个视频[WWDC 2010 Video: Designing Apps with Scrolls Views中的说明解决了这个问题](https://developer.apple.com/videos/wwdc/2010/)

Also, after following everything in the video I had to set this property in each of the Zoomable scrollviews which displayed the images:

```
myZoomableScrollview.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; 
```

# c# - 如何订购 2 个不同的列表？

> ID：14217801
> 
> 赞同：1
> 
> 时间：2013-01-08T15:00:31.123
> 
> 标签：c#

我有一`Step`堂课和一`AutoStep`堂课

```
class Step {
    int StepNumber;
}

class AutoStep {
    int StepNumber;
} 
```

它们**不是**从任何类继承的，**也不**能从任何类继承。

我必须按 StepNumber 对它们进行排序并根据它们的类型（`Step`或`AutoStep`）调用特定方法

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T15:09:02.890

从字面上看，这就是接口的用途：

```
public interface ISteppable
{
    public int StepNumber { get; }
    public void Foo();//the method you need to call; adjust the signature as needed
}

class step : ISteppable
{
    int StepNumber;

    int ISteppable.StepNumber
    {
        get { return StepNumber; }
    }

    public void Foo()
    {

    }
}

class AutoStep
{
    int StepNumber;

    int ISteppable.StepNumber
    {
        get { return StepNumber; }
    }

    public void Foo()
    {

    }
} 
```

然后，您可以创建`ISteppable`对象集合并使用它们的`StepNumber`属性对它们进行排序并调用`Foo`它们中的每一个。

由于您不能修改任何一个类，您需要使用适配器模式为这些类型创建这些接口的实现：

```
public class StepAdapter : ISteppable
{
    private step value;
    public StepAdapter(step value)
    {
        this.value = value;
    }

    public int StepNumber
    {
        get { return value.StepNumber; }
    }

    public void Foo()
    {
        value.Foo();
    }
}

public class AutoStepAdapter : ISteppable
{
    private AutoStep value;
    public AutoStepAdapter(AutoStep value)
    {
        this.value = value;
    }

    public int StepNumber
    {
        get { return value.StepNumber; }
    }

    public void Foo()
    {
        value.Foo();
    }
} 
```

然后你可以创建一个`ISteppable`对象集合，当你想添加一个`step`对象时，只需将它包装在 a 中`StepAdapter`并将所有`AutoStep`对象包装在`AutoStepAdapter`objects 中。

```
List<ISteppable> list = new List<ISteppable>();

list.Add(new StepAdapter(new step(){StepNumber = 5}));
list.Add(new AutoStepAdapter(new AutoStep(){StepNumber = 3}));

list.Sort((a, b) => a.StepNumber.CompareTo(b.StepNumber));

foreach (var item in list)
{
    item.Foo();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T15:02:59.590

您可以使用`as`它们来投射它们：

```
Step stepObject = input as Step;

if(stepObject != null)
{
  // do something with Step
}

AutoStep autoStepObject = input as AutoStep;

if(autoStepObject != null)
{
  // do something with AutoStep
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T15:27:05.447

如果您有两种类型要以相同的方式处理，您应该以某种方式为它们创建一个类型。

在这种情况下，最好的选择是通用接口（或者可能是通用基类），但这似乎不是您的选择。

另一种方法是创建接口和从它继承的两个适配器（每个原始类型一个）。

[Servy 的回答](https://stackoverflow.com/a/14217982/41071)很好地解释了这两个选项。

但另一种选择是使用`dynamic`. 这样，拥有一个同名的属性就足以以相同的方式使用它们。但我不推荐这种方法，因为它破坏了（编译时）类型安全。

例如（使用Servy答案中的修改代码）：

```
List<dynamic> list = new List<dynamic>();

list.Add(new step{ StepNumber = 5 });
list.Add(new AutoStep{ StepNumber = 3 });

foreach (var item in list.OrderBy(x => x.StepNumber))
{
    item.Foo();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T15:14:01.033

如果您可以使用接口，则问题很容易解决：

```
class step : IStep
{
   ...
   public int StepNumber {get; set;}
}

class AutoStep : IStep
{
   ...
   public int StepNumber {get; set;}
}

interface IStep
{
   public int StepNumber;
}

List<IStep> steps; // list with steps and autosteps
List<IStep> orderedSteps = steps.OrderBy(s => s.StepNumber);
foreach (IStep step in orderedSteps)
{
  if (step is Step)
    // call to method here
  else if (step is AutoStep)
    // call to other method here
} 
```

或者，您也许可以使用反射做一些事情（由于性能影响，不建议这样做）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T16:55:59.957

这绝对不是我在不受严格限制的情况下做事的方式，但是您可以使用以下排序方法：

```
private void sort(object toBeSorted)
{
    if(toBeSorted is Step)
    {
        callStepSort();
    }
    else if(toBeSorted is AutoStep)
    {
        callAutoStepSort();
    }
} 
```

这负责检查类型，避免继承，并允许您调用 sort 方法而不管类型如何。

但同样，如果没有限制，这根本不是我要做到这一点的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-08T23:00:58.327

假设您定义了两个列表：

```
List<AutoStep> autoStepList;
List<Step> stepList; 
```

根据你的类的定义，该字段`StepNumber`是非公开的，所以我们需要通过`Reflection`.

您可以将以下类添加到您的项目中：

```
using System.Collections.Generic;
using System.Reflection;
using System.Linq;

public partial class AnyStepComparer<T>: IComparer<T> {
    int IComparer<T>.Compare(T stepX, T stepY) {
        if(typeof(Step)==typeof(T)||typeof(AutoStep)==typeof(T))
            return (
                from it in new[] { 0 }
                let type=typeof(T)
                let flagsAccess=BindingFlags.Instance|BindingFlags.NonPublic|BindingFlags.Public
                let invokeAttr=flagsAccess|BindingFlags.GetProperty|BindingFlags.GetField
                let binder=default(Binder)
                let args=default(object[])
                let x=(int)type.InvokeMember("StepNumber", invokeAttr, binder, stepX, args)
                let y=(int)type.InvokeMember("StepNumber", invokeAttr, binder, stepY, args)
                select Comparer<int>.Default.Compare(x, y)
                ).First();

        var message="{0} must be either Step or AutoStep";
        var paramName="[T]";
        throw new ArgumentException(String.Format(message, paramName), paramName);
    }

    public static readonly AnyStepComparer<T> Default=new AnyStepComparer<T>();
} 
```

然后在代码中定义方法：

```
public static void SortSteps<T>(List<T> steps) {
    if(steps is List<AutoStep>||steps is List<Step>)
        steps.Sort(AnyStepComparer<T>.Default);
} 
```

这样您就可以通过调用对它们进行排序：

```
SortSteps(autoStepList); 
```

或者

```
SortSteps(stepList); 
```

或者，您可以直接在代码中对它们进行排序：

```
autoStepList.Sort(AnyStepComparer<AutoStep>.Default); 
```

或者

```
stepList.Sort(AnyStepComparer<Step>.Default); 
```

# c# - 反序列化跨程序集移动的类型

> ID：14217802
> 
> 赞同：4
> 
> 时间：2013-01-08T15:00:33.163
> 
> 标签：c#, .net, binaryformatter, binary-serialization

我有一堆类型已从一个程序集转移到另一个程序集。我正在尝试使用*SerializationBinder将使用旧程序集序列化的数据**反*序列化为新程序集中的类型。

 ***编辑：**程序集的根命名空间与程序集名称相同。旧程序集不再存在。

```
sealed class TypeMapBinder : SerializationBinder
    {
        public override Type BindToType( string assemblyName, string typeName )
        {
            Type typeToDeserialize = null;

            if ( assemblyName.Contains( "old namespace" ) )
                typeToDeserialize = Type.GetType( typeName.Replace( "old namespace", "new namespace" ) );
            else
                typeToDeserialize = Type.GetType( String.Concat( typeName, ", ", assemblyName ) );

            return typeToDeserialize;
        }
    } 
```

反序列化代码看起来像这样 -

```
using ( MemoryStream ms = new MemoryStream( byteArr ) )             {
                BinaryFormatter formatter = new BinaryFormatter( );
                formatter.Binder = new TypeMapBinder( );
                return formatter.Deserialize( ms );             
} 
```

当我尝试反序列化时，在尝试加载旧程序集时出现错误。

> 无法加载文件或程序集“旧程序集”或其依赖项之一。该系统找不到指定的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T12:15:46.197

我想我看到了同样的问题。

我的 SerializationBinder 的 BindToType 方法不会发出任何类型，它指的是旧程序集，但 BinaryFormatter 仍然尝试加载该旧程序集：

```
System.IO.FileNotFoundException : Could not load file or assembly 'Old.Interfaces, Version=3.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified.
   at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, ref StackCrawlMark stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, ref StackCrawlMark stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, ref StackCrawlMark stackMark, IntPtr pPrivHostBinder, Boolean forIntrospection)
   at System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, ref StackCrawlMark stackMark, Boolean forIntrospection)
   at System.Reflection.Assembly.Load(String assemblyString)
   at System.UnitySerializationHolder.GetRealObject(StreamingContext context)
   at System.Runtime.Serialization.ObjectManager.ResolveObjectReference(ObjectHolder holder)
   at System.Runtime.Serialization.ObjectManager.DoFixups()
   at System.Runtime.Serialization.Formatters.Binary.ObjectReader.Deserialize(HeaderHandler handler, __BinaryParser serParser, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage)
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream, HeaderHandler handler, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage)
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream)
   [...] 
```

如果我添加一个处理程序`AppDomain.CurrentDomain.AssemblyResolve`来加载`New.Interfaces`而不是`Old.Interfaces`它会引发另一个异常：

```
System.TypeLoadException : Could not load type 'Old.Interfaces.MyClass' from assembly 'New.Interfaces, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null'.
   at System.Reflection.RuntimeAssembly.GetType(RuntimeAssembly assembly, String name, Boolean throwOnError, Boolean ignoreCase, ObjectHandleOnStack type)
   at System.Reflection.RuntimeAssembly.GetType(String name, Boolean throwOnError, Boolean ignoreCase)
   at System.UnitySerializationHolder.GetRealObject(StreamingContext context)
   at System.Runtime.Serialization.ObjectManager.ResolveObjectReference(ObjectHolder holder)
   at System.Runtime.Serialization.ObjectManager.DoFixups() 
```

但是，已经为该类型调用了 BindToType 方法`Old.Interfaces.MyClass`，正如我所说，在 BindToType 中，我没有返回可能引用旧类的单个类型。

此外，如果我更改被反序列化的二进制数据，以便字符串的出现`Old`被替换`New`，则最终加载对象图。我对这个解决方案不太满意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-27T14:01:33.743

我自己也遇到了这个问题，而且几乎无法修复。

我将某些类型从一个程序集移动到另一个程序集，现在我在旧版本中序列化的文件无法反序列化。我的 SerializationBinder 成功解析了每种类型（包括最终导致异常的类型），但我仍然收到错误。它直到稍后才崩溃，在反序列化器中的 DoFixup 例程启动的代码部分中。

事实证明，我的一个序列化类型有一个**Type 类型**的成员（我知道这很令人困惑）。存储在此 Type 属性中的 Type 信息在反序列化时不会通过 SerializationBinder，但会在内部解析并失败。AssemblyResolve 也不会修复它。

除了手动解析文件之外，反序列化此文件的唯一方法是将旧版本与以前可以读取它的程序集一起包装，然后将其保存为中性类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-17T10:00:48.887

我也遇到了同样的问题：类型被移动到另一个程序集，有自定义活页夹返回正确的类型，但生成了 TypeLoadException。

实际上有帮助的事情是：[https](https://stackoverflow.com/a/19490593/434298) ://stackoverflow.com/a/19490593/434298 我的意思是添加`[assembly:TypeForwardedTo(typeof(TheType))]`到最初具有该类型的程序集...

因此，对于您的问题，我建议您尝试一下，如果需要制作没有*真正源代码*的程序集，而只是 [程序集：]

*希望这会帮助另一个可怜的灵魂：|**

# javascript - Javascript：刷新 IFrame 浏览器特定

> ID：14217813
> 
> 赞同：0
> 
> 时间：2013-01-08T15:01:07.033
> 
> 标签：javascript, internet-explorer, firefox, iframe, browser

我需要一个解决方案来刷新适用于不同浏览器的 iframe。
你能确认一下，我在互联网上找到的代码是正确的还是给我正确的 javascript？

即 7 `window.document.getElementById('iframeId').contentWindow.location.reload(true);`

即 8 `window.document.getElementById('iframeId').contentWindow.location.reload(true);`

即 9 `window.document.getElementById('iframeId').contentWindow.location.reload(true);`

火狐 12-17
`window.document.getElementById('iframeId').src = window.document.getElementById('iframeId').src;`

铬 < 19
`document.getElementById('iframeId').contentWindow.location.reload();`

铬现在
？？？

Safari 和 Opera 会很好，但以上内容很重要。iframe 可能位于不同的域中。

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:33:26.070

在 Chrome 版本 23.0.1271.97 我刚刚尝试使用

`document.getElementById('iframeId').contentWindow.location.reload()`

它有效。你可以试试：

`document.getElementById('iframeId').contentWindow.location.href = document.getElementById('iframeId').contentWindow.location.href`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-17T11:50:18.363

```
**Try This**
location.reload(); 
```

# php - 将 count() 移出 foreach 循环

> ID：14217814
> 
> 赞同：-4
> 
> 时间：2013-01-08T15:01:07.617
> 
> 标签：php, mysql, count, laravel

我有一个数组列表，我需要对其应用一些逻辑，数组中的每个元素都引用我数据库中的一个类别。

到目前为止，我正在使用 foreach 循环中的计数来计算该类别在我的数据库中应用的次数。有没有办法把这个计数移到我的 foreach 循环之外？到目前为止，它的运行速度并不慢，基准为 0.00241899490356。

但我有超过 150 个类别，每个类别都循环并计数 6 次。我担心随着类别使用和数据库空间的增加，它会变得迟缓。我读到数据库操作不应该在循环中。在类似情况下，这种做法是否可行且可以原谅？

编辑 :: 我真的很抱歉我缺少代码。我通常先勾勒出问题，然后填上漏洞。我的时间用完了。不是马虎的借口，但这是我的借口。在阅读当前回复之前，我现在会修复。

```
 $nazioni = array(
        'ad' => array( 'eur', ),
        'ae' => array( 'asi', ),
        'af' => array( 'asi', ),
        'ag' => array( 'nam', ),
        'al' => array( 'eur', ),
        'am' => array( 'asi', 'eur', ),
        ...
        'za' => array( 'afr', ),
        'zm' => array( 'afr', ),
        'zw' => array( 'afr', ),
    );

    $categorie = array(
        'eur',
        'asi',
        'afr',
        'nam',
        'sam',
        'oce',
    );

    echo '<ul>';
    foreach($categorie as $cat)
    {
        echo '<li><a href="#">'.$cat.'</a></li>';
        echo '<ul>';
        foreach($nazioni as $n=>$c)
        {
            if(array_intersect(array($cat), $c) == true)
            {
                echo Filtra::uri_locale($n, $cat, $uri);
            }
        }
        echo '</ul>';
    }
    echo '</ul>';
} 
```

计数在我的 Filtra::uri_locale 操作中完成。

```
public static function uri_locale ($n, $cat, $uri)
{
    $count = DB::table('recipes')
    ->where(function($query)
    {
        $corso = Filtra::corso(explode("/", URI::current()));
        if(!empty($corso))
        {
            $query->where_in('course', $corso, 'OR');
        }
    })
    ->where('nation', '=', $n)->count();

    //if more than 0, or not empty and in the uri array.
    if($count > 0 || !empty($uri) && array_intersect(array($n), $uri))
    {
        return self::uri_href($uri, $n, $count);
        // ex: returns a link named Italy (3) if Italy has 3 results counted.
    }
} 
```

我正在查找的相关数据库表：

```
| id | title | nation | course |
————————————————————————————————
| 1  | Pizza | it     | 4      | 
```

它被翻译成意大利，课程用于另一层分类，使用相似的逻辑，相同的解决方案来解决相同的问题。

再次，对这种混淆感到非常抱歉，我已经超出了我的头脑和最后期限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:20:40.877

由于您没有提供有关您的 PHP 代码或数据库的任何信息，所以让我做一些假设和回答。假设 1, hello, world 是您的类别。

您可以通过 2 种方式对此进行优化。

**方法一**

```
<?php
$array = array(1, "hello", 1, "world", "hello");
print_r(array_count_values($array));
?> 
```

输出/输出

```
Array
(
    [1] => 2
    [hello] => 2
    [world] => 1
) 
```

**方法二**

您可以为此使用数据库功能`COUNT()`。

```
SELECT category, COUNT(*) FROM category_table GROUP BY category; 
```

输出/输出

```
+--------+----------+
|category| COUNT(*) |
+--------+----------+
| 1      |        2 |
| hello  |        2 |
| world  |        1 |
+--------+----------+ 
```

如果您有任何问题，请告诉我

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:08:28.733

让 MySQL 进行计数可能会更好，请在此处查看：[https](https://dev.mysql.com/doc/refman/5.1/en/counting-rows.html) ://dev.mysql.com/doc/refman/5.1/en/counting-rows.html然后您就不必“转移”所有数据到 PHP 并在那里进行计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:20:36.687

您可以使用一些变量来存储每个类别的计数。然后您测试变量是否不为空，您将在其中获取值，否则您进行计数。

# metaprogramming - 如何构造一个发出任意数量可能匹配的宏？

> ID：14217821
> 
> 赞同：0
> 
> 时间：2013-01-08T15:01:26.760
> 
> 标签：metaprogramming, nemerle

假设我想创建一个这样的宏：

`m(1, k)`会产生：

```
match(k)
{
  | 1 => 2
  | _ => 0
} 
```

`m(2, k)`会产生：

```
match(k)
{
  | 1 => 2
  | 2 => 3
  | _ => 0
} 
```

等等。尽管`<[ $i => $(i + 1) ]>`接受了可能匹配的构造，但我不知道如何创建由这些组成的匹配表达式。这个例子当然是人为的；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T09:17:33.120

```
public macro m(to, k)
{
  def toInteger(literal)
  {
     | <[ $(i : int) ]> => i
     | _ => Message.Error(literal.Location, $"'$literal' integer literal expected"); 0;
  }

  def to = toInteger(to);

  def createCases(i) 
  {
     | i when (i > 0) => <[case: | $i => $(i + 1)  ]> :: createCases(i - 1);
     | _ => [ <[case: | _ => 0 ]> ]
  }

  <[
    match ($k)
    {
      ..$(createCases(to))
    }
  ]>
} 
```

[http://nemerle.org/Macros_tutorial#Matching_match-cases](http://nemerle.org/Macros_tutorial#Matching_match-cases)

# javascript - 使用 jquery 调用外部 Web 服务

> ID：14217829
> 
> 赞同：1
> 
> 时间：2013-01-08T15:01:41.210
> 
> 标签：javascript, jquery, web-services

我正在使用以下代码使用 jquery 调用外部 Web 服务。在`Chrome`中，我收到此“500 内部服务器错误”，在 Firefox 中，它显示`'0'`

我无法弄清楚问题所在。这是我的完整代码..

```
 <script type="text/javascript" src="js/jquery-1.3.1.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jQuery/1.2.6/jQuery.min.js">   
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#btnCall").click(function (event) {
            $.ajax({
                type: "POST",
                url: "www.google.com",
                data: "{'ESS123', 'aaaaaa', '', 'abc@hotmail.com', '23424234', '', 0, 100, 1000007, 1, '', 12, '','','', '2013', '', 1, 1000006, 1000033, 100, 1000012, 1000012, 1000001, 1000001, 100, 'caff4eb4fbd6273e37e8a325e19f0991'}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    alert('s');
                },
                error: AjaxFailed
            });
        });
    });
    function AjaxSucceeded(result) {
        alert('s');
        //alert(result.d);
    }
    function AjaxFailed(result) {
        alert(result.status + ' ' + result.statusText);
    }  
</script>

<body>
 <input type="button" value="Submit" id="btnCall" />
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:02:44.253

可能还有其他原因，但您的`data`参数不包含有效的 JSON。无效输入是 500 内部服务器错误的常见原因。

请参阅[JSONLint](http://jsonlint.com/)：

```
Parse error on line 1:
{    'ESS123',    'aaaaa
-----^
Expecting 'STRING', '}' 
```

（提示，JSON 中的字符串必须用`"`字符引用，并且与数组不同，对象需要键：值对而不是值列表）。

# git - git reset 上的双破折号 [--] 选项有什么作用？

> ID：14217853
> 
> 赞同：15
> 
> 时间：2013-01-08T15:03:04.380
> 
> 标签：git, git-reset

我见过这样的命令：

```
git reset e542 -- readme.txt 
```

我了解此命令将来自提交 e542 的文件 readme.txt 的内容放入索引中。但是`--`那里有什么选择呢？

git reset 手册页将它列为前两种形式的可选，但我找不到它的含义。

```
git reset [-q] [<commit>] [--] <paths>…
git reset (--patch | -p) [<commit>] [--] [<paths>…] 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-08T15:05:11.547

`--`将分支名称与文件名分开，以防有任何歧义（如果您有一个分支和一个同名的文件）。如果没有歧义，则不需要`--`.

正如 Jonas Wielicki 所提到的，这允许文件名以`-`;开头。否则，这些将被解释为命令行选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:06:52.197

我相信它只是将提交（这是一个可选参数）与路径列表分开。如果您没有分隔符，则无法确定第一个参数是路径还是提交。

# php - Javascript Jquery Get Dropdown value always 0

> ID：14217856
> 
> 赞同：1
> 
> 时间：2013-01-08T15:03:13.090
> 
> 标签：php, javascript, jquery, codeigniter, drop-down-menu

I am developing a website using CI, PHP, JQuery. I have a dropdown menu. When I try to get the value using JQuery, the result always 0\. Here is my code.

html:

```
 <div id="label"><label>Merk</label></div><div id="pilihan"><select name="brand">
 <option value="0">PILIH SATU</option>
 <option value="1">ACURA</option>
 <option value="2">ALFA ROMEO</option>
 <option value="3">ASTON MARTIN</option>
 <option value="4">AUDI</option>
 <option value="5">BENTLEY</option>
 <option value="6">BERTONE</option>
 <option value="7">BIMANTARA</option>
 <option value="8">BMW</option>
 <option value="9">BUGATTI</option>
 <option value="10">BUICK</option>
 <option value="11">CADILLAC</option>
 <option value="12">CHANA</option>
 <option value="13">CHERY</option>
 <option value="14">CHEVROLET</option>
 <option value="15">CHRYSLER</option>
 <option value="17">CITROEN</option>
 <option value="18">CODA</option>
 <option value="19">DAEWOO</option>
 <option value="20">DAIHATSU</option>
 <option value="21">DAIMLER</option>
 <option value="22">DATSUN</option>
 <option value="23">DODGE</option>
 <option value="24">DYNA</option>
 <option value="25">FERRARI</option>
 <option value="26">FIAT</option>
 <option value="27">FORD</option>
 <option value="28">FOTON</option>
 <option value="29">GREELY</option>
 <option value="30">GMC</option>
 <option value="31">GREAT WALL</option>
 <option value="32">HAGLER</option>
 <option value="33">HINO</option>
 <option value="34">HOLDEN</option>
 <option value="35">HONDA</option>
 <option value="36">HUMMER</option>
 <option value="37">HYUNDAI</option>
 <option value="38">INFINITI</option>
 <option value="39">ISUZU</option>
 <option value="40">JAGUAR</option>
 <option value="41">JEEP</option>
 <option value="42">KIA</option>
 <option value="43">KTM</option>
 <option value="44">LAMBORGHINI</option>
 <option value="45">LAND ROVER</option>
 <option value="46">LEXUS</option>
 <option value="47">LIGIER</option>
 <option value="48">LOTUS</option>
 <option value="49">MASERATI</option>
 <option value="50">MAYBACH</option>
 <option value="51">MAZDA</option>
 <option value="52">MCLAREN</option>
 <option value="53">MERCEDES-BEN</option>
 <option value="54">MINI</option>
 <option value="55">MITSUBISHI</option>
 <option value="56">MORGAN</option>
 <option value="57">NISSAN</option>
 <option value="58">OPEL</option>
 <option value="59">PEUGEOT</option>
 <option value="60">PORSCHE</option>
 <option value="61">PROTON</option>
 <option value="62">RANGE ROVER</option>
 <option value="63">RENAULT</option>
 <option value="64">ROLLS-ROYCE</option>
 <option value="65">SAAB</option>
 <option value="66">SKODA</option>
 <option value="67">SMART</option>
 <option value="68">SSANGYONG</option>
 <option value="69">SUBARU</option>
 <option value="70">SUNBEAM</option>
 <option value="71">SUZUKI</option>
 <option value="72">TATA</option>
 <option value="73">TIMOR</option>
 <option value="74">TOYOTA</option>
 <option value="75">TRIUMPH</option>
 <option value="76">VAUXHALL</option>
 <option value="77">VOLKSWAGEN</option>
 <option value="78">VOLVO</option>
 <option value="79">WRANGLER</option>
 </select></div> 
```

JQuery:

```
$('select[name="brand"]').change(function(){
        var brand = $("select[name='brand']").val();
        alert(brand);
        $.ajax({
            type: "POST",  
            url: '<?php echo site_url("ajax_data/getmodel"); ?>',
            dataType: 'json', 
            data: { vehicle_class : '', vehicle_brand : brand },
            success: function(data) {
                // Clear all options from vehicle class select 
                $('select[name="model"] option').remove(); 

                // Fill vehicle class select 
                $.each(data, function(i, j){ 
                    var row = "<option value=\"" + j.model_id + "\">" + j.model_name + "</option>"; 
                    $(row).appendTo('select[name="model"]'); 
                });
            }
        });
    }); 
```

What is wrong with my code actually? Thank you.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:32:34.443

我刚刚将您的代码放入一个文本文件（名为`test.html`）...

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
</head>
<body>

<div id="label"><label>Merk</label></div><div id="pilihan"><select name="brand">
<option value="0">PILIH SATU</option>
<option value="1">ACURA</option>
<option value="2">ALFA ROMEO</option>
<option value="3">ASTON MARTIN</option>
:       :        :
<option value="77">VOLKSWAGEN</option>
<option value="78">VOLVO</option>
<option value="79">WRANGLER</option>

<script type="text/javascript">
$('select[name="brand"]').change(function(){
    var brand = $("select[name='brand']").val();
    alert( brand );
});
</script>

</body>
</html> 
```

该代码在 FireFox、Chrome 和 IE8 中完美运行。

另外，我的伙伴说salam sejahtera。:o)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-01-08T15:25:01.733

您正在使用 select[name=brand] 进行选择，这意味着您正在尝试访问 `<select value="THIS_IS_WHAT_YOU_ARE_SELECTING">`

但你想要选择的选项，所以使用

`$('select[name=brand] option:selected').val();`

# python - 我可以在 Google 应用引擎上使用带有 python 的 open cv 吗？

> ID：14217858
> 
> 赞同：4
> 
> 时间：2013-01-08T15:03:16.107
> 
> 标签：python, google-app-engine, opencv, python-2.7

嗨，实际上我正在研究一个打算在 google appengine 上部署的项目。但是我发现python支持谷歌应用引擎。我可以在 Google 应用引擎上使用 python 脚本运行 openCV 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-08T15:06:05.657

不，GAE 仅支持纯 python 扩展或他们自己提供的扩展。

OpenCV 使用 C，所以不适合。

> 解释器可以运行任何 Python 代码，包括应用程序中包含的 Python 模块以及 Python 标准库。解释器不能用 C 代码加载 Python 模块；它是一个“纯”的 Python 环境。

[https://developers.google.com/appengine/docs/python/overview](https://developers.google.com/appengine/docs/python/overview)

[纯 Python 和 GAE](https://developers.google.com/appengine/docs/python/runtime#Pure_Python)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T15:06:42.503

不可以。OpenCV 是 C++ 库的 Python 包装器，Google App Engine 只能运行纯 Python 代码。

Google App Engine[于 2012 年 5 月 9 日接受了这个问题](http://code.google.com/p/googleappengine/issues/detail?id=7010)，但它还没有得到任何地方。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-15T13:44:23.060

现在是可能的。该应用程序应使用 GAE 灵活环境中的自定义运行时进行部署。`RUN apt-get update && apt-get install -y python-opencv`可以通过在 Dockerfile 中添加指令来安装 OpenCV 库。

# sqlalchemy - How to select min and max from table by column score?

> ID：14217860
> 
> 赞同：17
> 
> 时间：2013-01-08T15:03:20.890
> 
> 标签：sqlalchemy

How to select min and max from table by column score ? Is this possible with session query ?

```
class Player(Base):
    username = Column(String)
    score = Column(Integer)
    # more not impoortant columns 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-01-16T14:35:19.273

对于需要查找分数字段的最小值和最大值的情况。您可以使用 min 和 max 函数通过一个查询来执行此操作：

```
from sqlalchemy.sql import func
qry = session.query(func.max(Player.score).label("max_score"), 
                func.min(Player.score).label("min_score"),
                )
res = qry.one()
max = res.max_score
min = res.min_score 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-09-15T20:03:43.503

```
from sqlalchemy import func
max = session.query(func.max(Table.column)).scalar()
min = session.query(func.min(Table.column)).scalar() 
```

# ios - UISegmentedControl 选择在动画之前未更新

> ID：14217864
> 
> 赞同：0
> 
> 时间：2013-01-08T15:03:31.247
> 
> 标签：ios

我有一个 UISegmentedControl 像模态窗口一样显示/隐藏。最初它没有选定的段。在 IB 中，Value Changed 事件连接到方法 - (IBAction)cardClassificationChanged:(UISegmentedControl *)sender。这是那个方法：

```
- (IBAction)cardClassificationChanged:(UISegmentedControl *)sender
{
    NSLog(@"%d", sender.selectedSegmentIndex);
    // block for updating the categorization of current card asynchronously
    [self.cardActionSheet hideWithAnimation];
} 
```

如果我注释掉最后一行（对 -hideWithAnimation 的调用），则选择会按预期更改，一切正常。但是，通过调用该动画方法，UISegmentedControl 选择在动画之前不会在视觉上发生变化。这是 hideWithAnimation 方法：

```
- (void)hideWithAnimation
{
    CATransition *animation = [CATransition animation];
    animation.type = kCATransitionFade;
    animation.duration = globalAnimationLength;
    [self.layer addAnimation:animation forKey:nil];

    self.hidden = YES;
} 
```

下次出现此视图时（通过触摸手势）， UISegmentedControl 将选择正确的段。

似乎我不应该为 UISegmentedControl 调用 setNeedsDisplay，但即使我在 cardClassificationChanged 方法或 hideWithAnimation 方法中尝试它，它也不会刷新。

我显然缺少与 UI 更新相关的内容，我需要调用什么来在动画之前更新 UISegmentedControl 选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:11:10.077

我建议你应该使用 UIKit 动画来淡出你的控制。试试下面的代码

```
- (void)hideWithAnimation
{
    [UIView animateWithDuration:0.2
                 animations:^{
                     self.alpha = 0.;
                 } completion:^(BOOL finished) {
                     self.alpha = 1.;
                     self.hidden = YES;
                 }];
} 
```

# jquery - jQuery doesnt work after adding a jquery line

> ID：14217865
> 
> 赞同：-2
> 
> 时间：2013-01-08T15:03:34.900
> 
> 标签：jquery, reload

I have few line that listing to this script

```
$("a.remove").click(function(){
    var id = $(this).attr('id')
    var user = $(this).attr('value')
    $.ajax({
        success : function(){
            var url = "includes/action.php?page=access&action=remove";
            var popupmessage = "Error";
            $.post(url, { id: id },
                function(data){
                    return true;
            });
        }
    });
}); 
```

but when i add new line via jQuery it doesn't work until refreshing the page

```
$("<a class=\"remove\" href=\"#\"></a>").insertAfter('#accesstable tr:last'); 
```

any idea how to fix it ?

Edit: **Working code**

```
$('a.remove').live('click', function(){
    var id = $(this).attr('id')
    var user = $(this).attr('value')
    $.ajax({
        success : function(){
            var url = "includes/action.php?page=access&action=remove";
            var popupmessage = "Error";
            $.post(url, { id: id },
                function(data){
                    return true;
            });
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:05:33.403

尝试：

```
$(document).on('click', 'a.remove', function(){ 
```

> 委托事件的优点是它们可以处理来自以后添加到文档的后代元素的事件。通过选择在附加委托事件处理程序时保证存在的元素，您可以使用委托事件来避免频繁附加和删除事件处理程序的需要。

[http://api.jquery.com/on/#direct-and-delegated-events](http://api.jquery.com/on/#direct-and-delegated-events)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:09:17.757

猜测一下（因为没有足够的代码可以确定），您的问题是您正在绑定点击，然后添加一个应该由该点击处理程序绑定的元素。它不是那样工作的。如果绑定 with `.click`，它将绑定当时存在*的*所有匹配元素。它不会自动绑定创建的新元素。

要绑定尚未创建`.on`的元素，请在具有选择器的父元素上使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:09:56.910

如果您的意思是您新添加的锚标记没有调用您已经声明的相同点击事件，那是因为您正在使用[.click()](http://api.jquery.com/click/)函数。这只会将点击事件添加到当前页面中的那些匹配元素。

您应该考虑使用[live()](http://api.jquery.com/live/)事件，因为这将

> 为现在和将来匹配当前选择器的所有元素附加一个事件处理程序。

因此，您可以更改为：

```
$("a.remove").live('click', function(){ .. }); 
```

**编辑**

Live() 已弃用，您现在应该使用[on()](http://api.jquery.com/on/)函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T15:07:13.717

jQuery 忽略动态添加的内容的监听器，使用 jQuery 的[live](http://api.jquery.com/live/)

```
$("a[class='remove']").live('click', function(){}); 
```

*编辑：* live 已被弃用，使用带有**on的解决方案**

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-08T15:35:25.580

.live 已弃用，只需使用：

```
$(document).on('click', 'a.remove', function(){..}); 
```

# postgresql - Create a new Table with pgsql

> ID：14217866
> 
> 赞同：0
> 
> 时间：2013-01-08T15:03:36.880
> 
> 标签：postgresql, plpgsql

I want to create a new table with plpgsql, but I want that the user gives the name of the table.My code generate a table with the name of **tbname**

this is my code:

```
CREATE OR REPLACE FUNCTION "Object_gen"(tablename text)
  RETURNS void AS
$BODY$DECLARE
tbname text;
BEGIN
tbname:=tablename;
CREATE TABLE tbname(Surrogat uuid);
END$BODY$
  LANGUAGE plpgsql; 
```

How can I solve my problem? somehow that the name of my table comes from the user

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:07:17.323

您需要使用动态 SQL：

```
CREATE OR REPLACE FUNCTION "Object_gen"(tablename text)
  RETURNS void AS
$BODY$
BEGIN
  execute 'CREATE TABLE '||tablename||' (Surrogat uuid)';
END
$BODY$
LANGUAGE plpgsql; 
```

# sql-server-2008 - 编写sql查询包装行数据

> ID：14217867
> 
> 赞同：0
> 
> 时间：2013-01-08T15:03:44.097
> 
> 标签：sql-server-2008

我有一个要求，即仅使用 SQL 查询来显示数据。表名：EMP_DEPT

```
 DEPARTMENT  |   EMPLOYEE    |   SALARY
    DEPT1       |   ABC         |   20000
    DEPT1       |   MNO         |   30000
    DEPT1       |   XYZ         |   25000
    DEPT2       |   DEF         |   42000
    DEPT2       |   GHI         |   35000
    DEPT3       |   JKL         |   36000 
```

以及我期望的结果如下

```
 DEPARTMENT  |   EMPLOYEE    |   SALARY
    DEPT1       |   ABC         |   20000
                |   MNO         |   30000
                |   XYZ         |   25000
    DEPT2       |   DEF         |   42000
                |   GHI         |   35000
    DEPT3       |   JKL         |   36000 
```

像这样打印的选择查询将是什么。使用 MSSQL 作为数据库

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:09:10.380

试试这个。您可以使用`''`或`NULL`随心所欲。也许您想按分区排序`EMPLOYEE`。

```
SELECT 
   CASE WHEN rn = 1 THEN DEPARTMENT ELSE '' END  as DEPARTMENT,
   EMPLOYEE,
   SALARY
FROM
(
   SELECT *, ROW_NUMBER() OVER (PARTITION BY DEPARTMENT ORDER BY (SELECT 1)) rn
   FROM EMP_DEPT
) A 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:13:32.740

您可以使用`ROW_NUMBER()`标识第一次出现的部门，并使用`CASE`语句显示部门名称或空白。

```
SELECT
    CASE
        WHEN ROW_NUMBER() OVER(PARTITION BY DEPARTMENT ORDER BY EMPLOYEE) = 1
        THEN DEPARTMENT
        ELSE ''
    END AS DEPARTMENT,
    EMPLOYEE,
    SALARY
FROM EMP_DEPT
ORDER BY EMP_DEPT.DEPARTMENT, EMPLOYEE 
```

# python - IOError Django Permission Denied

> ID：14217872
> 
> 赞同：0
> 
> 时间：2013-01-08T15:04:01.433
> 
> 标签：python, django

I want to watermark every image a user upload on my Django site. I decided to install a package [Django-watermark](https://github.com/codekoala/django-watermark) to handle the operation. After installing and carrying out all the necessary settings, I launched the page to check if it works..after visiting the page, I'm getting the below error. I'm on Windows machine (Windows 7) . I granted the media folder full permission by visiting Properties->Security->Edit, and I clicked on full control for every group and usernames.

I visited the page again, and I'm still getting the same error.

```
IOError at /ham/5/

[Errno 13] Permission denied: 'C:\\Python27\\Scripts\\nate\\media'

Request Method:     GET
Request URL:    http://127.0.0.1:8000/ham/5/
Django Version:  1.4
Exception Type:  IOError
Exception Value:  

[Errno 13] Permission denied: 'C:\\Python27\\Scripts\\nate\\media'

Exception Location:  C:\Python27\lib\site-packages\PIL\Image.py in open, line 1952
Python Executable:  C:\Python27\python.exe
Python Version:    2.7.3 
```

How can I get rid of this? I'm in development server(Django and Wampserver).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:11:46.567

我相信您只需要为运行 django 的任何用户[授予目录](http://answers.microsoft.com/en-us/windows/forum/windows_vista-files/how-do-i-change-folder-and-file-permissions/465f2b42-63dd-4486-8dd1-c870290efeed)写访问权限。

# c# - Creating Datagridview in C#.net with our desired behaviours/override the existing behaviours

> ID：14217873
> 
> 赞同：0
> 
> 时间：2013-01-08T15:04:00.867
> 
> 标签：c#, datagridview, custom-controls

I'm using `DatagridView` in my project. I have to Add a `DataGridView` in Each form that i created. And in each `form` i have to Add some similar code blocks in this case. Instead of that i want to create a `control library`. In the library i want to implement my own behaviour *(override default behaviour of that contol)* .

Can anybody please help me in this regards? .How to create a custom `Datagridview` *(inherited from the `DatagridVview` provided in .net)* with our own behaviours in c#.net.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:13:05.167

您可以创建一个继承自 DataGridView 的[用户控件](http://msdn.microsoft.com/en-us/library/a6h7e207%28v=vs.71%29.aspx)并覆盖行为

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:06:31.220

控件只是一个类。

您可以创建自己的从`DataGridView`控件继承的类。

然后，您可以覆盖或添加不同的行为

```
public class CustomGridView : DataGridView {

   public string MyCustomProperty { get; set;}

} 
```

# c# - Using Generics properties with EF

> ID：14217875
> 
> 赞同：0
> 
> 时间：2013-01-08T15:04:03.180
> 
> 标签：c#, entity-framework, generics, entity-framework-4, metadata

I know that [EF isn't supposed to support generic Entity types](https://stackoverflow.com/questions/1541154/how-to-create-an-entity-data-model-for-inherited-generic-types) but I have a huge need for it in a project... I have about 200 classes containing 0 to 5 complex generic property :

```
public class MyCommonProperty
{
    public virtual string Key { get; set; }
}

public class MyCustomClass<T> : MyCommonProperty where T : struct, IComparable, IFormattable, IConvertible
{
    public virtual T Value { get; set; }
    public virtual string DisplayValue { get; set; }

    public MyCustomClass(string key)
    {
        Key = key;
    }
}

public class ConcreteClass
{
    public int Id { get; set; }
    public MyCustomClass<CustomType1> CustomType1 { get; set; }
    public MyCustomClass<CustomType2> CustomType2 { get; set; }
} 
```

I just want to persist the *Key* property in the DB with Entity Frameworks, using these POCO. Here is my model :

*   Entity Type
    *   **ConcreteClass**
        *   Id (*int*, Identity)
        *   CustomType1 (*MyCommonProperty*)
        *   CustomType2 (*MyCommonProperty*)
*   Complex Types
    *   **MyCommonProperty**
        *   Key (*string*)

Finally, in my UI, the code looks like :

```
using (var db = new ModelContainer())
{
    db.ConcreteClassSet.AddObject(new ConcreteClass()
    {
        CustomType1 = new MyCustomClass<CustomType1>() { Key = "RandomKey1" },
        CustomType2 = new MyCustomClass<CustomType2>() { Key = "RandomKey2" }
    });
    db.SaveChanges();
} 
```

When I run this code, I get this error :

> The member with identity 'Domain.MyCustomClass`1[[Domain.CustomType1, Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]' does not exist in the metadata collection.

Although *MyCustomClass* wasn't defined in my edmx, I though EF wouldn't care about this class as a *MyCustomClass* is also a *MyCommonProperty* wich is defined in the metadata...

I overrided the *ValidateEntity* in my container :

```
public partial class ModelContainer : DbContext
{
    public ModelContainer()
        : base("name=ModelContainer")
    {
    }

    protected override DbEntityValidationResult ValidateEntity(DbEntityEntry entityEntry, IDictionary<object, object> items)
    {
        if (entityEntry.Entity is ConcreteClass)
            return new DbEntityValidationResult(entityEntry, new List<DbValidationError>());
        return base.ValidateEntity(entityEntry, items);
    }

    public DbSet<ConcreteClass> ConcreteClassSet { get; set; }
} 
```

Basically, I turned off the validation for my *ConcreteClass*, telling EF that they are always valid. With this workaround, the *db.Save()* works : in the database, a new row is added, with a generated Id and "RandomKey1" and "RandomKey2" in the *CustomType1* and *CustomType2* fields.

Now the problem is the validation : I don't want to turn off the validation for all the entities containing those generics properties It looks like the only problem is that Entity search for the concrete type (*MyCustomClass*) of my property in the metadata and can't find it because the only type declared there is *MyCommonProperty*

I think that it would be possible by modifying the metadata to add some fake types into it. For example by finding the *MyCommonProperty*, copying it, and rename the copy *'Domain.MyCustomClass`1[[Domain.CustomType1, Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'*

```
var metadata = (this as IObjectContextAdapter).ObjectContext.MetadataWorkspace;
var metaType = metadata.GetType("MyCommonProperty", "Domain", DataSpace.CSpace);
metaType.Name = "'Domain.MyCustomClass`1[[Domain.CustomType1, Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'";
metadata.RegisterItemCollection(metaType); 
```

I couldn't find a way to make it (lacks of knowledge and skill) so if someone have an idea or some hints, I would be grateful.

# php - PHP：存储登录用户

> ID：14217883
> 
> 赞同：3
> 
> 时间：2013-01-08T15:04:25.150
> 
> 标签：php, database, security, userid

当让用户登录网站时，我需要以某种方式存储登录的用户 ID，以便我的网站可以为不同的用户生成不同的内容。

将用户的 ID 保存在 `$_SESSION[]`变量中是否安全？

用户是否可以更改`$_SESSION[]`数据并伪装成另一个用户？

我使用 id 来检查我应该从数据库中获取哪些数据并查看用户拥有哪些权限。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T15:29:06.990

最佳且公认的做法是将用户 ID 保存在会话中。

会话默认存储`/tmp`为文件。[除非您遇到目录遍历](http://en.wikipedia.org/wiki/Directory_traversal)漏洞等安全问题，否则最终用户无法查看它。大多数应用程序`$_SESSION`都照常使用。如果存在广泛的弱点，那么主要项目将采取不同的做法。您不必担心通过客户端漏洞获取服务器端会话值。还要记住使用会话的简单性。它使数据访问您需要在整个应用程序中持续、标准和一致地访问的用户特定数据。

# c# - IIS 本地主机 Asp Net MVC 应用程序出现错误 101 (net::ERR_CONNECTION_RESET)

> ID：14217885
> 
> 赞同：0
> 
> 时间：2013-01-08T15:04:44.143
> 
> 标签：c#, asp.net, asp.net-mvc, iis, asp.net-mvc-4

我不再能够连接到在 IIS7.5 上运行的 Asp NET mvc 4 应用程序

我根本没有做任何改变，在计算机重新启动后，我得到：

```
Erro 101 (net::ERR_CONNECTION_RESET) 
```

我正在尝试从 localhost 访问它。该应用程序仍在开发中，所以我不明白为什么会这样。

按照我已经完成的说明：

*   已检查 IIS 服务
*   为此应用程序重新配置 IIS
*   刷新的 DNS
*   禁用 Windows 防火墙

还有什么我应该看的吗？？？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:58:04.637

找到了解决方案。

出于某种原因，我可能删除了应用程序中使用的 localhost 证书。

我创建了一个新的自签名证书，并将其添加到 IIS。最后一步是在应用程序 SSL 配置中添加此证书。

就这样！

# security - Does a Good Password Salt Need to Include Both Numbers and Letters?

> ID：14217886
> 
> 赞同：1
> 
> 时间：2013-01-08T15:04:44.457
> 
> 标签：security, passwords, password-protection

I am salting newly created passwords before hashing them with an encryption algorithm. I generate my salts using a random number function.

Are you compromising security if your salts are only comprised of numbers (with no letters) or does this make no difference at all?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T21:41:17.537

盐应该是**唯一的**（理想情况下适用于世界上的每个密码），并且**不可预测**。使用确定性计算机可以做的最好的事情是获取一个随机数，并希望返回的值*几乎*是唯一的。因此，您拥有的可能组合越多，盐独特的机会就越大。

一些散列算法定义了一个数字和一个可接受字符的字母表。例如，PHP 的 BCrypt 需要一个包含 22 个字符的盐：

```
./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz 
```

您可以获得最可能的组合，使用字母表中的**所有**字符，而不仅仅是字符 0-9。当然，带有小字母（0-9）的较长盐可以具有与带有大字母（0-9，az，...）的较短盐一样多的组合。

为了简短起见，请使用所有可能的字符，以及散列算法期望的尽可能多的字符。

PS：如果你使用像 BCrypt 这样的密钥派生函数（你真的应该），那么你不能在散列之前对密码进行加盐，而是必须将加盐传递给散列函数。

# sql - oracle日期差SQL查询

> ID：14217889
> 
> 赞同：3
> 
> 时间：2013-01-08T15:04:52.607
> 
> 标签：sql, oracle, date-arithmetic

> **可能重复：**
> [计算 Oracle SQL 中 2 个日期/时间之间的差异](https://stackoverflow.com/questions/1096853/calculate-difference-between-2-date-times-in-oracle-sql)

我有一张表，其中维护了 PurchasedDate。我必须从系统中获取日期并以天为单位计算日期差异。当我在 Oracle 工作时，datediff() 没有给出结果。

样品表：

```
产品编号 日期
P101 2012 年 12 月 31 日
P102 2011 年 12 月 29 日

```

如果今天返回 P102，则差值应为 10。

这里有详细的说明

```
账单 ID 产品 ID 日期
101 P101 2012 年 12 月 31 日
101 P102 2012 年 12 月 31 日
102 P405 2012 年 6 月 29 日
102 P210 2012 年 6 月 29 日
105 P205 2012 年 5 月 2 日

```

如果客户来退换BillNo101的产品P101，那么系统应该计算退货日期（即系统日期）和购买日期之间的差异。如果 P101 于 2012 年 1 月 8 日返回，则 P101 的答案应为 10

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-08T15:09:28.420

尝试

```
SELECT trunc(sysdate) - PurchasedDate 
  FROM table_name; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T15:08:54.823

在 Oracle 中，您可以只减去日期。这将在几天内给您答案。

例如，假设您的意思是 2012 年 12 月 29 日而不是 2011 年 12 月 29 日！

```
select trunc(sysdate) - your_date from your_table;

SQL> select trunc(sysdate) - to_date('29-dec-2012', 'dd-mon-yyyy') from dual;

TRUNC(SYSDATE)-TO_DATE('29-DEC
------------------------------
                            10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:39:53.957

您可以从下面的链接中找到有关在 oracle 中计算日期差异的好信息

[如何在 Oracle SQL 中计算日期之间的差异](http://oracletuts.net/tutorials/how-to-calculate-difference-between-dates-in-oracle-sql/)

# struts - Struts controller/porccessor monitoring/log utility

> ID：14217890
> 
> 赞同：0
> 
> 时间：2013-01-08T15:04:54.327
> 
> 标签：struts, monitoring

I'm looking for some kind of monitoring tool to visualize/log all internal struts forwards together with all http headers, parameters, request and session attributes values. The intend is to understand the full flow of certain request in struts 1.x application.

Thanks a lot.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:24:04.183

使用MaintainJ监控java web应用程序中的所有调用和方法......并在firefox中安装'firebug'运行它选择net标签......在这个标签下你可以看到每个服务器调用和该调用的响应......
Chrome也有此功能...

# vb.net - VB.NET 进度条

> ID：14217894
> 
> 赞同：7
> 
> 时间：2013-01-08T15:05:11.087
> 
> 标签：vb.net, for-loop, progress-bar

> **可能重复：**
> [.NET 进度条未更新](https://stackoverflow.com/questions/5714159/net-progressbar-not-updating)

我建立了一个进度条类，显示我的 for 循环中的进度。这是进度条类的代码：

```
Public Class frmProgress
Private Sub frmProgress_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    progressBar.Minimum = 0
End Sub

Public Sub ProgressBarSetup(ByRef Maximum As Integer, ByRef Title As String)
    progressBar.Maximum = Maximum
    progressBar.Value = 0
    Me.Text = Title
    Me.Show()
End Sub

Public Sub IncProg()
    progressBar.Value += 1
    Application.DoEvents()

    If progressBar.Value = progressBar.Maximum Then
        Me.Close()
    End If
End Sub
End Class 
```

这是我在 for 循环中使用它的方法：

```
Dim pb As New ProgressBar
pb.ProgressBarSetup(5000, "Test")

For i As Integer = 0 To 5000 - 1
      pb.IncProg()
Next 
```

问题是视觉问题。它完成了完整进度条的 70-85%，然后关闭。关闭时，进度条值和最大值相等，但进度条仅填充到其长度的四分之三左右。

我尝试使用 progressBar.Refresh() 而不是 Application.DoEvents() 但它大大减慢了进度 - 仍然给我相同的结果。

有没有其他方法可以实现更好的视觉吸引力进度条？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-08T15:07:47.593

在 Windows 7 上看到这种效果是正常的。问题是当您将值设置为 X 时，它会在接下来的 0.5-1 秒内滑动到该位置。因此，如果您的动作发生得很快，您只会看到它在 50-80% 的情况下完成。解决方案是首先设置为更高的值，然后减少到您想要的值。像这样的东西：

```
progressBar.Value += 2
progressBar.Value -= 1 
```

并且不要忘记临时增加最大值，否则您可能会遇到异常，例如，当从 4999 增加到 5000 时（您不能设置为 5001）。

# ios - 为 iOS 应用程序存储设备配置的最佳方式

> ID：14217896
> 
> 赞同：1
> 
> 时间：2013-01-08T15:05:13.433
> 
> 标签：ios

我正在开发一个 iOS 应用程序，它更像是一个永久安装类型的应用程序，每个客户端都会有所不同。因此，我正在寻找在设备上安装应用程序可以检测到的某种配置类型的最佳方法，并且本质上将其“锁定”到客户端的特定设置中。即使删除了应用程序，我也希望这种情况持续存在。

像 mobileconfig 文件这样的东西会很整洁，但我认为它们不能包含未定义的变量或被应用程序读取。

我很好奇最好和最干净的方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:15:41.147

正如其他答案和评论所说，如果没有设备被越狱，这真的无法做到。然而......有一个可能的选择。

您可以使用[OpenUDID](https://github.com/ylechelle/OpenUDID)或[SecureUDID](http://secureudid.org/)创建唯一标识符，然后在您的服务器数据库中创建配置。如果配置文件不存在，应用程序将连接到您的服务器以获取全局配置。这样，如果用户使用您的应用程序，然后删除该应用程序，然后重新安装它，您仍将拥有应用程序可以重新下载并存储在设备本地的配置。

# jquery - Rails JQuery 从 html 获取数据

> ID：14217897
> 
> 赞同：1
> 
> 时间：2013-01-08T15:05:18.123
> 
> 标签：jquery, ruby-on-rails, coffeescript

我正在尝试在 js.coffee 脚本中使用来自 html 页面的数据。

视图代码为：

```
 <span class="colHeader" data-wostatus-id="<%= wostatus.id %>"><span><%= wostatus.statuscode %></span></span> 
```

检查 html 如下所示：

```
<span class="colHeader" data-wostatus-id="4"><span>WAPR</span></span> 
```

到目前为止，一切都很好。

我的 js.coffee 文件有：

```
 alert($(this).data('wostatus-id')) 
```

我得到的结果=未定义

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:12:49.957

在你的 js.coffee 文件中试试这个。它只会在 DOM 准备好时运行，并且专门访问`span`元素：

```
$ ->
  alert($('span.colHeader').data('wostatus-id')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T19:14:49.397

只需使用 jQuery 并扫描文档以查找具有 id 的任何内容：

```
jQuery("[data-wostatus-id]").each (index, elm) ->
    alert(jQuery(elm).attr("data-wostatus-id")) 
```

这假定页面上有多个“id”（因此`each`）

# google-chrome - 单独安装和运行，第二个谷歌浏览器

> ID：14217900
> 
> 赞同：5
> 
> 时间：2013-01-08T15:05:32.773
> 
> 标签：google-chrome

我想在我的 PC 上安装几个不同的 chrome 实例。我必须分别安装 **CHROME**、**CHROME** **CANARY**、 **CHROMIUM**版本，并且做得很好！

但是，是否存在仅适用于“CHROME”的内置功能，而不安装其他 Chrome 版本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-12T17:41:38.677

您还可以查看 Chrome 的“用户配置文件”功能。这是分离多个 Facebook/Gmail/etc 帐户的一种非常巧妙的方法。它还保留不同的书签/浏览历史记录/自动完成/cookies等。几乎唯一共享的是您正在运行的Chrome构建。

右上角有一个非常漂亮的个人资料交换图标：

![注意右上角的配置文件图标](../Images/6577810ff0181181e7f236c53106e138.png)

导航到“chrome://settings”->“用户”

更新（2015）：请注意，此功能最近被破坏了，因此现在要获得良好的行为需要设置一些额外的标志。请参阅[http://digiwonk.wonderhowto.com/how-to/get-back-avatars-chrome-switch-user-profiles-more-easily-0159605/](http://digiwonk.wonderhowto.com/how-to/get-back-avatars-chrome-switch-user-profiles-more-easily-0159605/)

# html - 如何设置空跨度高度等于默认行高？

> ID：14217902
> 
> 赞同：44
> 
> 时间：2013-01-08T15:05:34.947
> 
> 标签：html, css

我有一组`<span>`元素（每个元素都嵌套到对应的`<div>`）。他们构建了一堆面板，如下图所示。

![在此处输入图像描述](../Images/3e41df003be5d67f40b83c3cd22b8b01.png)

当 span 包含一些文本时，它具有正常的高度。但是当它为空时，它的高度为0px。但我需要它有一个正常的高度（让它看起来像在图片中）。

如何实现这种行为？（我试图插入一个空格，但也许有更好的解决方案）。

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2015-03-30T19:38:23.403

这是一个简单而强大的解决方案：

```
span.item:empty:before {
  content: "\200b"; // unicode zero width space character
} 
```

（*更新 12/18/2015*：不要使用`\00a0`不间断空间，而是使用`\200b`，这也是一个不间断空间，但宽度为零。请参阅我在[https://stackoverflow.com/a/29355130/516910](https://stackoverflow.com/a/29355130/516910)上的其他答案)

此 CSS 选择器仅选择“空”的跨度，并将一些内容注入该空白空间，即不间断空格字符。因此，无论您设置什么字体大小和行高，周围的所有内容`<span>`都会对齐，就像您在 that 中存在文本一样`<span>`，这可能是您想要的。

[http://plnkr.co/edit/eXHphA?p=preview](http://plnkr.co/edit/eXHphA?p=preview)

结果如下所示：

![正确的结果布局](../Images/7b20bbacfd1ff6700ce786f07edb1218.png)

* * *

我看到使用的两个问题`min-height`：

1.  在字体大小发生变化的地方很容易受到攻击
2.  文本基线不在正确的位置

以下是出现问题时的反例：

1.  字体大小发生变化，现在您必须再次手动调整最小高度。您不能使用同一个类来支持网站中字体大小不同的不同部分。这里这个地方的字体大小是 30，但 min-height 仍然设置为 20。所以空的 span 没有那么高。:-(

[http://plnkr.co/edit/zeEvca?p=preview](http://plnkr.co/edit/zeEvca?p=preview)

![font-size 是 30，但 min-height 是 20。哎呀。](../Images/87d2a72f4ffb06bb5933818b6e57e4e5.png)

2.  您的空跨度具有正确的高度和最小高度，但它没有与跨度周围的文本正确对齐。基线下降不正确。看看上面写着“嗯？”的那一行。以下：

[http://plnkr.co/edit/GGd7mz?p=preview](http://plnkr.co/edit/GGd7mz?p=preview)

![基线如何失败](../Images/1f0fd9f6d1f6b0958bac46d271ba9cf9.png)

最后一个示例的代码：

```
<div class="group">
  Hello <span class="item">Text</span>
</div>
<div class="group">
  Huh? <span class="item"></span>
</div>
<div class="group">
  Yes! <span class="correct"></span>
</div> 
```

CSS：

```
.group {
  background-color: #f1f1f1;
  padding: 5px;
  font-size: 20px;
  margin-bottom: 20px;
}

.item {
  background-color: #d2e3c5;
  border-radius: 6px;
  padding: 10px;
  margin-bottom:5px;
  display: inline-block;
  min-height: 20px;
}

.correct {
  background-color: #d2e3c5;
  border-radius: 6px;
  padding: 10px;
  margin-bottom:5px;
  display: inline-block;
}
.correct:empty:before {
  content: "\00a0";
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-08T15:08:56.587

您可以设置 span display:inline-block; 然后添加最小高度

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T18:25:36.210

从图片中，您似乎已经设置`display: block`了`span`元素。如果没有，请添加。或者，考虑`div`改用。这两个元素的区别在于`span`默认是inline，默认`div`是block，那么为什么不使用后者呢？

然后，您需要设置`min-height`一个等于具有内容的项目的高度的值。这通常由它们的行高决定。默认行高因字体（和浏览器）而异，因此要获得一致的结果，请明确设置行高，例如

```
* { line-height: 1.25; }
span { min-height: 1.25em; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T15:09:17.070

也许这会奏效-

```
span{
  min-height:16px;
} 
```

# jquery - 未调用 jquery 函数

> ID：14217903
> 
> 赞同：0
> 
> 时间：2013-01-08T15:05:39.977
> 
> 标签：jquery, jsp, struts

我有以下html代码：

```
<link rel="stylesheet" type="text/css" href="../themes/default/easyui.css">
<link rel="stylesheet" type="text/css" href="../themes/icon.css">
<link rel="stylesheet" type="text/css" href="demo.css">
<script type="text/javascript" src="../jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="../jquery.easyui.min.js"></script>
<script>
    $(function(){
        $('#test').treegrid({
            iconCls:'icon-save',
            width:1500,
            height:350,
            nowrap: false,
            rownumbers: true,
            animate:true,
            collapsible:true,
        url:'jsondata.jsp',
            idField:'job',
            treeField:'job',
            columns:[[
                             {field:'job',title:'Job',width:200,
                    formatter:function(value){
                        return '<span style="color:red">'+value+'</span>';
                    }
                },
                {field:'desc',title:'Description',width:250},
                {field:'start_date',title:'Start date',width:150,rowspan:2},
                {field:'end_date',title:'End Date',width:250,rowspan:2},
                {field:'progress',title:'Progress',width:300,rowspan:2,
                    formatter:function(value){
                    alert(value);
                        if (value){
                            var s = '<div style="width:100%;background:#fff;border:1px solid #ccc">' +
                                    '<div style="width:' + value + '%;background:red">' + value + '%' + '</div>'
                                    '</div>';
                            alert(s);
                            return s;
                        } else {
                            return '';
                        }
                    }
                }
            ]],
            onBeforeLoad:function(row,param){
                if (row){
                    alert("subdata.json called");
                    $(this).treegrid('options').url = 'jsondata.jsp';
                } else {
                    alert("data.json called");
                    $(this).treegrid('options').url = 'jsondata.jsp';
                }
            },
            onContextMenu: function(e,row){
                e.preventDefault();
                $(this).treegrid('unselectAll');
                $(this).treegrid('select', row.job);
                $('#mm').menu('show', {
                    left: e.pageX,
                    top: e.pageY
                });
            }
        });
    });

    function reload(){
        var node = $('#test').treegrid('getSelected');
        if (node){
            $('#test').treegrid('reload', node.job);
        } else {
            $('#test').treegrid('reload');
        }
    }
    function collapse(){
        var node = $('#test').treegrid('getSelected');
        if (node){
            $('#test').treegrid('collapse', node.job);
        }
    }
    function expand(){
        var node = $('#test').treegrid('getSelected');
        if (node){
            $('#test').treegrid('expand', node.job);
        }
    }
    function collapseAll(){
        var node = $('#test').treegrid('getSelected');
        if (node){
            $('#test').treegrid('collapseAll', node.job);
        } else {
            $('#test').treegrid('collapseAll');
        }
    }
    function expandAll(){
        var node = $('#test').treegrid('getSelected');
        if (node){
            $('#test').treegrid('expandAll', node.job);
        } else {
            $('#test').treegrid('expandAll');
        }
    }
    var jobIndex = 1000;
    function append(){
        jobIndex++;
        var data = [{
            job: 'job'+jobIndex,
            desc: 'desc'+jobIndex,
            start_date: '12/28/2012',
            end_date: '12/30/2012',
            progress: '80'
        }];
        var node = $('#test').treegrid('getSelected');
        $('#test').treegrid('append', {
            parent: (node?node.job:null),
            data: data
        });
    }
    function remove(){
        var node = $('#test').treegrid('getSelected');
        if (node){
            $('#test').treegrid('remove', node.job);
        }
    }
</script> 
```

```
<div style="margin:10px 0;">
    <a href="#" onclick="reload()">Reload</a>
    <a href="#" onclick="collapse()">Collapse</a>
    <a href="#" onclick="expand()">Expand</a>
    <a href="#" onclick="collapseAll()">CollapseAll</a>
    <a href="#" onclick="expandAll()">ExpandAll</a>
    <a href="#" onclick="append()">Append</a>
</div>

<table id="test"></table>

<div id="mm" class="easyui-menu" style="width:120px;">
    <div onclick="append()">Append</div>
    <div onclick="remove()">Remove</div>
</div> 
```

当我直接运行这个文件时，它运行良好，即它调用 jsondata.jsp 文件，我从中返回 json 数据。

但是当我使用mapping.findForward通过struts动作调用它时，它只显示超链接（重新加载，折叠..）并且不调用$（function（）{}。怎么办？

# ruby-on-rails-3.2 - 在 Rails 3 中什么是“current_user”？

> ID：14217904
> 
> 赞同：2
> 
> 时间：2013-01-08T15:05:43.233
> 
> 标签：ruby-on-rails-3.2

*   这是rails框架提供的东西吗？

*   可以将其更改为“current_car” - 在本例中，“car”是我的对象吗？

    那么，我可以使用“current_”并附加我的对象的名称吗？？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T15:21:20.127

current_user 是由许多可用于 Rails 的身份验证框架定义的方法。 [Devise](https://github.com/plataformatec/devise)是最流行的身份验证框架之一，但您还可以找到许多其他框架。

current_user 方法通常返回当前经过身份验证的用户（如果有），否则返回 nil。

当然，你不能只用你想要的任何东西替换 current_ 的后缀，它就是行不通的。

我不明白您为什么要在应用程序中使用 current_car，但您可以将其作为评论发布，我会尽力帮助您确定是否需要它以及有哪些替代方案。

# java - 休眠映射 - 无法确定 pg-uuid 的类型

> ID：14217906
> 
> 赞同：1
> 
> 时间：2013-01-08T15:05:50.320
> 
> 标签：java, hibernate, postgresql, mapping, uuid

我实际上是在尝试使用带有 java 注释的 Hibernate ORM 进行映射。我将 PostgreSQL 用于我的数据库及其 UUID 类型。正如我在其他帖子中看到的那样，当我想将 UUID pgsql 类型映射到 UUID Java 类型时，我应该将 @Type(type="pg-uuid") 添加到每个 UUID 字段。问题是当我得到这个时，它似乎没有被休眠识别：

> org.hibernate.MappingException：无法确定类型：pg-uuid，在表：ev_session，列：[org.hibernate.mapping.Column（user_id）]

我在谷歌上找不到任何提到这一点的东西，所以我真的不知道应该去哪里看。

这是我的映射类。该表使用两个 UUID 作为主键，这就是为什么我必须创建一个嵌套类来表示它。我不确定我做对了。

```
@Entity
@Table(name="ev_session")
public class SessionDb {

    ////////////////////////
    // VARIABLES
    ////////////////

    @Id
    private PrimaryKey primaryKey;
    @Column(name="date")
    private Date timestamp;

    ////////////////////////
    // NESTED CLASSES
    ////////////////

    @Embeddable
    private class PrimaryKey implements Serializable {
        private static final long serialVersionUID = 7124577164356450734L;

        @Type(type="pg-uuid")
        @Column(name="user_id")
        public UUID userID;
        @Type(type="pg-uuid")
        @Column(name="key")
        public UUID token;
    }

    ////////////////////////
    // CONSTRUCTORS
    ////////////////

    public SessionDb() {
        this.primaryKey = new PrimaryKey();
    }

    ////////////////////////
    // METHODS
    ////////////////

    @Override
    public String toString() {
        return this.primaryKey.token + " associated to " + this.primaryKey.userID + " at " + this.timestamp; 
    }

    ////////////////////////
    // GETTERS/SETTERS
    ////////////////

    public final UUID getUserID() {
        return this.primaryKey.userID;
    }

    public final void setUserID(UUID userID) {
        this.primaryKey.userID = userID;
    }

    public final UUID getToken() {
        return this.primaryKey.token;
    }

    public final void setToken(UUID token) {
        this.primaryKey.token = token;
    }

    public final Date getTimestamp() {
        return timestamp;
    }

    public final void setTimestamp(Date timestamp) {
        this.timestamp = timestamp;
    }

} 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:24:32.547

我想你应该使用`Generator`：

```
@Id @GeneratedValue(generator="system-uuid")
@GenericGenerator(name="system-uuid", strategy = "uuid") 
```

看看[这里](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#entity-hibspec-identifier)。更多文档[在这里](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/mapping.html#d0e5294)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-04T14:44:44.563

如果是 xml 映射，您可以添加

```
<typedef class="org.hibernate.type.PostgresUUIDType" name="pg-uuid" /> 
```

如[https://developer.jboss.org/thread/229747](https://developer.jboss.org/thread/229747)中所述，但我不知道如何使用注释进行配置。

# org-mode - org-mode 导出到 html：链接在新选项卡中打开？

> ID：14217908
> 
> 赞同：2
> 
> 时间：2013-01-08T15:05:52.317
> 
> 标签：org-mode

在从 org-mode 创建的 html 中，如果指定为，您可以在新选项卡中打开链接

```
#+ATTR_HTML: target="_blank" 
[[http://cnn.com][CNN]] 
```

我在[这里](http://lists.gnu.org/archive/html/emacs-orgmode/2011-02/msg00550.html)找到的。

`[[http://cnn.com][CNN]]`但是，如果是项目符号项，这将不起作用。例如，

```
#+ATTR_HTML: target="_blank" 
- [[http://cnn.com][CNN]] 
```

或者

```
- #+ATTR_HTML: target="_blank" 
  [[http://cnn.com][CNN]] 
```

1）我怎样才能使它工作，2）我可以通过在顶部指定某种形式的这个选项（可能是一些参数`#+OPTIONS:`）来为特定页面上的所有链接设置这个html属性吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T11:51:18.413

简短回答：替换函数中的字符串`org-export-attach-captions-and-attributes`：

```
diff -u -L /home/eab/.emacs.d/el-get/org-mode/lisp/org-exp.el -L \#\<buffer\ el-get/org-exp.el\> /home/eab/.emacs.d/el-get/org-mode/lisp/org-exp.el /tmp/buffer-content-8644Ge2
--- /home/eab/.emacs.d/el-get/org-mode/lisp/org-exp.el
+++ #<buffer el-get/org-exp.el>
@@ -1935,7 +1935,7 @@
            "\\|"
            "^[ \t]*\\(|[^-]\\)"
            "\\|"
-           "^[ \t]*\\[\\[.*\\]\\][ \t]*$"))
+           "^.*\\[\\[.*\\]\\][ \t]*$"))
    cap shortn attr label end)
     (while (re-search-forward re nil t)
       (cond 
```

关于麻烦的长评论。让我们看看函数的源代码，它解析`#+ATTR_BACKEND`成文本属性。

```
(defun org-export-attach-captions-and-attributes (target-alist)
  "Move #+CAPTION, #+ATTR_BACKEND, and #+LABEL text into text properties.
If the next thing following is a table, add the text properties to the first
table line.  If it is a link, add it to the line containing the link."
  (goto-char (point-min))
  (remove-text-properties (point-min) (point-max)
              '(org-caption nil org-attributes nil))
  (let ((case-fold-search t)
    (re (concat "^[ \t]*#\\+caption:[ \t]+\\(.*\\)"
            "\\|"
            "^[ \t]*#\\+attr_" (symbol-name org-export-current-backend) ":[ \t]+\\(.*\\)"
            "\\|"
            "^[ \t]*#\\+label:[ \t]+\\(.*\\)"
            "\\|"
            "^[ \t]*\\(|[^-]\\)"
            "\\|"
            "^[ \t]*\\[\\[.*\\]\\][ \t]*$"))
...))) 
```

`org-export-current-backend`在`HTML`这种情况下。它适用于此类文本

```
#+ATTR_HTML: target="_blank" 
[[http://cnn.com][CNN]] 
```

像这样：

`#+ATTR_HTML: target="_blank"`1）通过正则表达式解析整行`"^[ \t]*#\\+attr_"...`

`[[http://cnn.com][CNN]]`2）通过正则表达式解析整行`"^[ \t]*\\[\\[.*\\]\\][ \t]*$"`

`#+ATTR_HTML: target="_blank"`3）在导出到html之前删除字符串

4) 设置`target="_blank"`线的属性`[[http://cnn.com][CNN]]`

然后 org-mode 准备使用此属性导出的 html 链接。

如果我替换字符串`"^[ \t]*\\[\\[.*\\]\\][ \t]*$"`，`"^.*\\[\\[.*\\]\\][ \t]*$"`那么这个补丁函数适用于

```
#+ATTR_HTML: target="_blank" 
  - [[http://cnn.com][CNN]] 
```

也。但是list有问题

```
 - [[http://cnn.com][CNN]] 
  - [[http://cnn.com][CNN]]
  - some text 
```

如果我`ATTR_HTML`在每个链接之前

```
#+ATTR_HTML: target="_blank" 
  - [[http://cnn.com][CNN]] 
#+ATTR_HTML: target="_blank" 
  - [[http://cnn.com][CNN]]
  - some text 
```

然后我得到这样的输出html

```
* CNN

* CNN
* some text 
```

列表中有一个额外的空白。所以，我不能得到这样的输出

```
* CNN
* CNN
* some text 
```

只要

```
* CNN

* CNN

* some text 
```

这个例子展示了 org-mode 在某些情况下并不灵活。我可以编写 lisp 函数，它为导出文本中的所有链接设置此 html 属性，并将此功能添加到`#+OPTIONS:`或其他内容中。但是我不能以这种方式使越来越多的 org-mode 导出系统复杂化，因为存在一些 org-mode 语法限制 - 它很简单。

如果我有这样的 org-publish 问题，我想：除了 org-mode 之外，我可能需要其他东西来化妆吗？)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-06-15T23:02:15.207

我发现添加了以下作品：

```
#+HTML_HEAD: <base target="_blank"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-04T11:23:26.437

如果您有几个链接，您可以将 html 包含到您的模板中，如下所示

```
My projects
- @@html:<a href="https://example.com" target="_blank">Example</a>@@ 
```

# java - JTextPane 不换行

> ID：14217911
> 
> 赞同：3
> 
> 时间：2013-01-08T15:06:03.260
> 
> 标签：java, swing, jtextpane

我遇到了一个奇怪的问题。我有一个`JtextPane`内部 a `JscrollPane`，它在分发列表方面显示大字符串，并且当我使用 eclipse 运行程序时它正确地包装代码但是当我在使用 java webstart 运行相同的程序时它停止包装文本。

这是我的代码：

```
 private JScrollPane displayResults(String distributionList) {
// TODO Auto-generated method stub
  JTextPane textArea = new JTextPane();
  textArea.setText(distributionList);
  textArea.setEditable(false);
  JScrollPane scrollPane = new JScrollPane(textArea);  
  scrollPane.setPreferredSize( new Dimension( 500, 500 ) );
  return scrollPane;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T15:14:48.880

原因可能是java版本。

请参阅[https://forums.oracle.com/forums/thread.jspa?messageID=10690405](https://forums.oracle.com/forums/thread.jspa?messageID=10690405)讨论并提供解决方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:58:59.313

对我来说这项工作很好

```
 textArea.setEditorKit(new HTMLEditorKit(){ 
     @Override 
     public ViewFactory getViewFactory(){ 

         return new HTMLFactory(){ 
             public View create(Element e){ 
                View v = super.create(e); 
                if(v instanceof InlineView){ 
                    return new InlineView(e){ 
                        public int getBreakWeight(int axis, float pos, float len) { 
                            return GoodBreakWeight; 
                        } 
                        public View breakView(int axis, int p0, float pos, float len) { 
                            if(axis == View.X_AXIS) { 
                                checkPainter(); 
                                int p1 = getGlyphPainter().getBoundedPosition(this, p0, pos, len); 
                                if(p0 == getStartOffset() && p1 == getEndOffset()) { 
                                    return this; 
                                } 
                                return createFragment(p0, p1); 
                            } 
                            return this; 
                          } 
                      }; 
                } 
                else if (v instanceof ParagraphView) { 
                    return new ParagraphView(e) { 
                        protected javax.swing.SizeRequirements calculateMinorAxisRequirements(int axis, javax.swing.SizeRequirements r) { 
                            if (r == null) { 
                                  r = new javax.swing.SizeRequirements(); 
                            } 
                            float pref = layoutPool.getPreferredSpan(axis); 
                            float min = layoutPool.getMinimumSpan(axis); 
                            // Don't include insets, Box.getXXXSpan will include them. 
                              r.minimum = (int)min; 
                              r.preferred = Math.max(r.minimum, (int) pref); 
                              r.maximum = Integer.MAX_VALUE; 
                              r.alignment = 0.5f; 
                            return r; 
                          } 

                      }; 
                  } 
                return v; 
              } 
          }; 
      } 
  }); 
```

# sql - 在 SSIS 中将列转换为行

> ID：14217912
> 
> 赞同：1
> 
> 时间：2013-01-08T15:06:03.677
> 
> 标签：sql, pivot, ssis

我的数据看起来像

```
Viral Impressions   Paid Impressions    Organic Impressions
123                   5678                          34566 
```

我希望它采用这种格式。

```
 Impressions
Viral        123
Paid         5678
Organic       34566 
```

我如何在 SSIS 中使用 Pivot unpivot 做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:00:01.553

作为 UNPIVOT 的替代方法，您可以使用 UNION ALL：

```
 Select 'viral' as col, [viral impressions] as impressions
 From yourtable
 Union all
 Select 'paid' as col, [paid impressions] as impressions
 From yourtable
 Union all
 Select 'organic' as col, [organic impressions] as impressions
 From yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/655a5/1)

给出结果：

```
|     COL | IMPRESSIONS |
-------------------------
|   viral |         123 |
|    paid |        5678 |
| organic |       34566 | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:12:58.723

使用`UNPIVOT`表运算符：

```
SELECT 
  value, 
  Impressions
FROM TableName
UNPIVOT
(
  Impressions
  FOR value IN([Viral], 
               [Paids], 
               [Organic])
) u; 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!3/98aa8/1)

这假设列的名称存储为`Viral | Paid | Organic`. 如果这些列的名称是`Viral Impressions | Paid Impressions | Organic Impressions`那么你可以这样做：

```
WITH CTE
AS
(
  SELECT value, Impressions
  FROM Table1
  UNPIVOT
  (
     Impressions
     FOR value IN([Viral Impressions], 
                  [Paid Impressions], 
                  [Organic Impressions])
  ) u
)
SELECT 
  REPLACE(value, ' Impressions', '') Value, 
  Impressions
FROM CTE; 
```

## [更新的 SQL Fiddle 演示](http://www.sqlfiddle.com/#!3/dd268/4)

# wcf - 我们可以为 web.config 中 dataContractSerializer 的 maxItemsInObjectGraph 指定的最大大小是多少？

> ID：14217915
> 
> 赞同：1
> 
> 时间：2013-01-08T15:06:21.287
> 
> 标签：wcf, web-config, datacontractserializer

我们可以为 web.config 中 dataContractSerializer 的 maxItemsInObjectGraph 指定的最大大小是多少？

目前我们将其设置为 22020096。因此，有时来自我们上游的数据无法成功处理。将其增加到 52020096 后，它工作正常。

但我想知道 maxItemsInObjectGraph 的限制是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:09:24.610

支持的类型（在 web.config 中格式化为字符串）是整数（因为这是值映射到的类型），默认值为[`int.MaxValue`](http://msdn.microsoft.com/en-us/library/system.int32.maxvalue.aspx)（即 2,147,483,647）。这在 MSDN 文档页面上针对[`MaxItemsInObjectGraph`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.maxitemsinobjectgraph.aspx). 它不能再高了。

# ruby - 无法批量分配受保护的属性 - 它是 attr_accessor 中的批量分配字段

> ID：14217916
> 
> 赞同：1
> 
> 时间：2013-01-08T15:06:23.130
> 
> 标签：ruby, ruby-on-rails-3, model, mass-assignment, attr-accessor

> 无法批量分配受保护的属性：密码、密码确认

* * *

这两个字段都没有映射到数据库中，它们只是我想用来启用一些很好的验证的表单中的字段。

这是我的模型类：

```
class User < ActiveRecord::Base
  attr_accessible :email, :password_hash, :password_salt
  attr_accessor :password, :password_confirmation

  before_save :encrypt_password

  validates_confirmation_of :password
  validates :password, presence: true
  validates :email, presence: true

  def encrypt_password
    if password.present?
      self.password_salt = BCrypt::Engine.generate_salt
      self.password_hash = BCrypt::Engine.hash_secret(password, password_salt)
    end
  end
end 
```

我的印象是，通过在 attr_accessor 方法中放置`password`和，它们**不会**被批量分配，但在这里我遇到了这个小问题。`password_confirmation`

 **有什么建议么？

这是我的迁移字段，因此您可以查看我的数据库中实际存在哪些字段。

```
class CreateUsers < ActiveRecord::Migration
  def change
    create_table :users do |t|
      t.string :email
      t.string :password_hash
      t.string :password_salt

      t.timestamps
    end
  end
end 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:16:13.307

**attr_accessible** specifies a white list of model attributes that can be set via mass-assignment. **attr_accessor** creating an instance variable (@name) and a corresponding access method to read it. Also creates a method called name= to set the attribute.

```
class User < ActiveRecord::Base
  attr_accessible :email, :password, :password_confirmation
  attr_accessor :password

  before_save :encrypt_password

  validates_confirmation_of :password
  validates_presence_of :password, :on => :create
  validates :email, presence: true

  def encrypt_password
    if password.present?
      self.password_salt = BCrypt::Engine.generate_salt
      self.password_hash = BCrypt::Engine.hash_secret(password, password_salt)
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:09:08.180

您需要 在**attr_accessible中添加****:password_confirmation**和**:password****

# asp.net-mvc-3 - 仅当按下特定按钮时才进行淘汰验证

> ID：14217921
> 
> 赞同：1
> 
> 时间：2013-01-08T15:06:30.943
> 
> 标签：asp.net-mvc-3, knockout.js, knockout-validation

[https://github.com/ericmbarnard/Knockout-Validation/wiki/Native-Rules](https://github.com/ericmbarnard/Knockout-Validation/wiki/Native-Rules)

我在我的 MCV3 页面上使用淘汰赛验证。我的情况是我有两个按钮。一个是添加到收藏夹，另一个是保存。添加到集合会根据需要查找以下属性：

```
FirstName: ko.observable().extend({ required: true }),
LastName: ko.observable().extend({ required: true }),
Title: ko.observable(),
Email: ko.observable().extend({ required: true, email: true }),
Date1: ko.observable(new Date()).extend({ required: true }), 
```

我定义了两个函数来检查页面是否有效：

## 第一的：

```
AddToCollection: function () {
            if (!viewModel.isValid()) {
                viewModel.errors.showAllMessages();
                return false;
            } else {
                this.Collection.push(new Item(this.FirstName(), this.LastName(), this.Title(), this.Email()));
                viewModel.clear();
            }
        }, 
```

## 第二：

```
save: function () {
            if (!viewModel.isValid()) {
                viewModel.errors.showAllMessages();
                return false;
            } else {
                $.ajax({
                    url: '@Url.Action("DoSomethinn")',
                    type: "POST",
                    data: ko.toJSON(this),
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {

                    }
                });
            }
        } 
```

我想要做的事情是，如果调用 Save，我不希望 FirstName、LastName 和 Email 是必需的，仅验证 Date1，但在调用 AddToCollectoin 时需要 FirstName、LastName 和 Email，但是Date1 不是。如何设置 Only If Native Rule，或者有更好的方法来做到这一点。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T16:15:54.403

该`onlyIf`选项可以在这里工作：

```
FirstName: ko.observable().extend({ 
    required: {
        params: true,
        onlyIf: function(){ return someFlagIsTrue; }
    } 
```

您需要`someFlagIsTrue`从点击事件或其他方式设置。

# c# - 存储过程和返回变量中的值不同

> ID：14217931
> 
> 赞同：1
> 
> 时间：2013-01-08T15:06:59.350
> 
> 标签：c#, sql, sql-server

我的登录页面中有两个实例，具体取决于作为增值税返回的内容（从下面的存储过程中返回变量），当我在服务器上执行存储过程时，结果是`INTERNAL`，但是条件`else`被执行而不是`INTERNAL`登录页。

```
string usertype = u.ViewUserType((int)Session["Id"]);
string vattype = u.ViewUserVat((string)Session["Code"]);                         

if (usertype == "Client")
{
   if (vattype == "INTERNAL")
   {
      Response.Redirect("~/NonIFAClient/");
   }
   else 
   {
      Response.Redirect("~/Client/");
   }
}

public string ViewUserVat(string code)
{
   CamOnlineAccess.Utilities u = new CamOnlineAccess.Utilities();
   SqlCommand c = u.GetCommandSP("dbo.ViewUserVat");

   c.Parameters.AddRange(new System.Data.SqlClient.SqlParameter[] {
       new System.Data.SqlClient.SqlParameter("@code",System.Data.SqlDbType.VarChar,50),
       new System.Data.SqlClient.SqlParameter("@vat",SqlDbType.VarChar, 50, System.Data.ParameterDirection.Output, false, ((byte)(0)), ((byte)(0)), "", System.Data.DataRowVersion.Current, null)});

   c.Parameters["@code"].Value = code;

   c.Connection.Open();
   c.ExecuteScalar();   // because we have output parameters
   c.Connection.Close();

   return (string)c.Parameters["@vat"].Value;
} 
```

存储过程：

```
ALTER PROCEDURE [dbo].[ViewUserVat] 
      -- Add the parameters for the stored procedure here
      @code varchar,
      @vat varchar(50) output
AS
  SELECT 
      TOP 1 @vat = vattable 
  FROM
      dbo.portfolio 
  WHERE
      owner = @code 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T16:54:58.927

有几种方法可以从存储过程中返回数据 - 您可以使用`RETURN`，可以执行普通`SELECT`操作，还可以使用 out 参数。访问这些值的方式不同，取决于用于执行查询的方法 - `ExecuteScalar`, , ... -。`ExecuteNonQuery`它还受到[`SET NOCOUNT`](http://msdn.microsoft.com/de-de/library/ms189837.aspx)控制是否返回受影响的行数的影响，甚至——如果我没记错的话——声明存储过程的方式。

自从我上次不得不搞砸这件事以来已经有一段时间了，我不记得所有的细节，也不知道有一份完整的清单给出了所有的细节。但我很确定以下内容应该适用于您的情况。

更改存储过程以返回单行和单列

```
ALTER PROCEDURE [dbo].[ViewUserVat] 
      @code varchar
AS
  SELECT 
      TOP 1 vattable 
  FROM
      dbo.portfolio 
  WHERE
      owner = @code 
```

并使用这样的返回值`ExecuteScalar()`。

```
public String ViewUserVat(String code)
{
    var command = CamOnlineAccess.Utilities().GetCommandSP("dbo.ViewUserVat"))

    try
    {
        command.Parameters.AddWithValue("@code", code);

        command.Connection.Open();

        return (String)command.ExecuteScalar();
    }
    finally
    {            
        command.Connection.Close();

        command.Dispose();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:11:20.160

比较中可能存在空格或铸造问题

尝试

```
c.ExecuteScalar();//because we have output parameters
c.Connection.Close();

String value = (string)c.Parameters["@vat"].Value;

value = value.Trim().ToUpper();

return (string)c.Parameters["@vat"].Value; 
```

# facebook - 在 Facebook 中添加网站

> ID：14217932
> 
> 赞同：0
> 
> 时间：2013-01-08T15:07:01.237
> 
> 标签：facebook, web

我关于 Facebook 和网站的问题如下：

如何将我的网站主页添加到 Facebook？有没有人做这个的教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:28:14.420

您想创建一个画布应用程序。教程在这里：[https ://developers.facebook.com/docs/appsonfacebook/tutorial/](https://developers.facebook.com/docs/appsonfacebook/tutorial/)

# ember.js - ember containerView 作为属性

> ID：14217933
> 
> 赞同：0
> 
> 时间：2013-01-08T15:07:05.463
> 
> 标签：ember.js

我想引用一个容器视图作为父视图的属性。

例如，在 parentView 的模板中，我想这样定义 containerView：

```
<a {{action toggleForm target="view"}} class="btn btn-primary" href="#">Create</a>
{{view view.formContainer}} 
```

然后我希望能够像这样在 parentView 中更改 containerView 的 currentView：

```
 toggleForm: (e) ->
    e.stopPropagation()

    @get('formContainer').set('currentView', Em.View.create()) 
```

但问题是他的 formContainer 属性引用了类而不是实例。

我可以从 childViews 集合中像这样访问它：

```
formContainer = @get('childViews.firstObject') 
```

但显然，如果视图不再是 firstObject，那么我的代码就会中断。

如何在不通过 childViews 集合的情况下引用实例，或者这可能是这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:39:08.350

你走在正确的轨道上。问题是您试图使用该`formContainer`属性（显然已设置为视图类）作为对视图实例的引用。

如果要从父级访问视图的实例，则需要使用视图助手的 viewName 属性。有关详细信息，请参阅[http://emberjs.com/api/classes/Ember.Handlebars.helpers.html#method_view](http://emberjs.com/api/classes/Ember.Handlebars.helpers.html#method_view)。

```
<a {{action toggleForm target="view"}} class="btn btn-primary" href="#">Create</a>
{{view view.formContainer viewName="formContainerViewName"}} 
```

您可以使用此名称从其父级引用视图，并且可以设置它的 currentView 属性。

```
toggleForm: (e) ->
  e.stopPropagation()
  @get('formContainerViewName').set('currentView', Em.View.create()) 
```

顺便说一句，我建议将 formContainer 属性重命名为 FormContainer，因为约定是以大写开头的类定义。

这是一个工作示例：http: [//jsfiddle.net/ZJjUM/1/](http://jsfiddle.net/ZJjUM/1/)

# javascript - 从 type="button" 切换到 asp:LinkBut ton

> ID：14217936
> 
> 赞同：3
> 
> 时间：2013-01-08T15:07:09.220
> 
> 标签：javascript, jquery, asp.net, asplinkbutton

试图从按钮切换到超链接（上一篇文章）但无法使其正常工作，因此决定改用链接按钮。

在我正在使用的 aspx 页面中

```
<script type ="text/javascript">
      function showImg(url) 
      {
                  $("#imagePreview").attr("src", url);

       }
</script>

        <div style="height:50px; margin-top:25px; margin-bottom:25px;">
            <img id="imagePreview" alt="" width="30" height ="30"></img>
        </div> 
```

然后在我正在使用的 ascx 页面中

```
<input type="button" onclick='javascript:showImg("<%# FieldValueString %>")' /> 
```

这很好用，当单击按钮时，图片显示在下面，但是我想要一个链接按钮。

我已经尝试了[http://www.devmanuals.com/tutorials/ms/aspdotnet/linkbutton.html](http://www.devmanuals.com/tutorials/ms/aspdotnet/linkbutton.html)上的示例，但没有任何乐趣，

iv尝试过

```
<asp:LinkButton
        ID="LinkButton1"
        runat="server"
        Text="Preview" 
        Font-Bold="True"
        ForeColor="Maroon"

        PostBackUrl='javascript:showImg("<%# FieldValueString %>")' /> 
```

但是当我单击按钮时没有任何反应我必须将任何代码添加到 .cs 文件中吗？

请帮忙

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T15:18:56.427

您正在使用不正确的属性。尝试这个：

```
<asp:LinkButton
        ID="LinkButton1"
        runat="server"
        Text="Preview" 
        Font-Bold="True"
        ForeColor="Maroon"
        OnClientClick='javascript:showImg("<%# FieldValueString %>"); return false;' /> 
```

# php - 从二维数组中获取所有组合键代码

> ID：14217940
> 
> 赞同：1
> 
> 时间：2013-01-08T15:07:14.053
> 
> 标签：php, arrays, multidimensional-array

我想获取数组的组合键 - 这里是示例：

```
$keys = array(
        array(
            'original',
            'section 1',
            'section 2'
        ),
        array(
            'original',
            'section 1'
        ),
        array(
            'original',
            'section 1'
        ),
        array(
            'original',
            'section 1',
            'section 2'
        ),
        array(
            'original',
            'section 1'
        )
); 
```

所有原始部分都是 00000（5 个数字，因为有 5 个不同的数组，但可以有 1 到 n 个数组，不限于 5 个），变体 #15 将是例如 01010。我基本上想获得所有变体的列表带有该键的列表以获取它们。我们假设每个数组内不超过 9 个部分 + 原始部分。

输出应如下所示：

```
array(
    array(
        "key" => "00000",
        "data" => array(
            "original", "original", "original", "original", "original"
        )
    ),
    array(
        "key" => "10000",
        "data" => array(
            "section 1", "original", "original", "original", "original"
        )
    ),
    array(
        "key" => "20000",
        "data" => array(
            "section 2", "original", "original", "original", "original"
        )
    ),
    array(
        "key" => "01000",
        "data" => array(
            "original", "section 1", "original", "original", "original"
        )
    )
    [...]
) 
```

除此之外，如果有一个很好的方法来获得它，那将是很好的。给出密钥 01010 并取回所有部分。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:50:41.927

这是我想出的：

```
$options = array();
$counter1 = 0;
foreach($keys as $values) {
    $counter1++;
    $counter2 = 0;
    $options[$counter1] = array();
    foreach($values as $key => $value) {
        if(isset($options[($counter1 - 1)])) {
            foreach($options[($counter1 - 1)] as $old_val) {
                $counter2++;
                $old_array = $old_val['data'];
                array_push($old_array, $value);
                $options[$counter1][$counter2] = array();
                $options[$counter1][$counter2]['key'] = $old_val['key'] . $key;
                $options[$counter1][$counter2]['data'] = $old_array;
            }
        }
        else {
            $counter2++;
            $options[$counter1][$counter2] = array();
            $options[$counter1][$counter2]['key'] = $key;
            $options[$counter1][$counter2]['data'] = array($value);
        }
    }
}
$all_options = end($options); 
```

你得到 72 个正确的结果，因为它是 3 * 2 * 2 * 3 * 2 = 72

# jquery - Jquery动画没有动画

> ID：14217942
> 
> 赞同：0
> 
> 时间：2013-01-08T15:07:20.487
> 
> 标签：jquery, jquery-animate

我想用 jQuery 为图片制作动画。我有这个代码：

```
$(document).ready(function(){
$(".label").delay(2000).animate({backgroundPositionX:"0px",backgroundPositionY:"30px"},10000,linear);
$(".label").animate({backgroundPositionX: "-70px" ,backgroundPositionY:"30px"},10000,linear);
$(".label").animate({backgroundPositionX: "-140px" ,backgroundPositionY:"30px"},10000,linear); 
```

但动画不起作用。知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:13:12.267

这个[SO 问题和答案](https://stackoverflow.com/a/8175460/978264)会有所帮助。`backgroundPositionX`并且`backgroundPositionY`是非标准的，不适用于所有浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:35:49.727

我将我的代码编辑为：

```
$(document).ready(function () {
  $(".label").delay(2000).css({
   "backgroundPositionX": "0px",
    "backgroundPositionY": "30px"
  }, 5000, 'linear');
  $(".label").animate({
    "backgroundPositionX": "-70px",
   "backgroundPositionY": "30px"
  }, 5000, 'linear');
  $(".label").animate({
    "backgroundPositionX": "-140px",
    "backgroundPositionY": "30px"
  }, 5000, 'linear');
}); 
```

它适用于**Chrome**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:29:05.700

```
$(document).ready(function () {
  $(".label").delay(2000).animate({
    backgroundPositionX: "0px",
    backgroundPositionY: "30px"
  }, 10000, 'linear');
  $(".label").animate({
   backgroundPositionX: "-70px",
   backgroundPositionY: "30px"
  }, 10000, 'linear');
  $(".label").animate({
    backgroundPositionX: "-140px",
    backgroundPositionY: "30px"
  }, 10000, 'linear');
}); 
```

[演示](http://jsfiddle.net/dcsM9/2/)_

# android - 使用 AsyncTask 快速滚动时出现 NullPointerException

> ID：14217943
> 
> 赞同：0
> 
> 时间：2013-01-08T15:07:20.210
> 
> 标签：android, android-asynctask

有人告诉我在这里使用 AsyncTask：[nullpointerexception-when-scrolling-fast](https://stackoverflow.com/questions/13937264/nullpointerexception-when-scrolling-fast) 这就是我所做的，但我仍然遇到同样的错误：它工作正常，直到我开始快速滚动。当滚动非常慢时，不会发生此错误。这真的让我很困惑。

```
package com.mamlambo.tutorial.tutlist;

import java.util.ArrayList;
import java.util.TreeSet;

import android.os.AsyncTask;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.view.View.OnClickListener;
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.widget.BaseAdapter;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.ImageView;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;

public class TutListActivity extends Activity {

    private DatabaseManager mHelper;
    private SQLiteDatabase mDatenbank;
    private ArrayList<String> devicesList;
    ListView listView;
    EfficientAdapter objectAdapter;

    private class EfficientAdapter extends BaseAdapter {
        private LayoutInflater mInflater;
        private Bitmap mIcon1;
        private Bitmap mIcon2;

        private TreeSet mSeparatorsSet = new TreeSet();

        private static final int TYPE_ITEM = 0;
        private static final int TYPE_SEPARATOR = 1;
        private static final int TYPE_MAX_COUNT = TYPE_SEPARATOR + 1;

        public EfficientAdapter(Context context) {
            // Cache the LayoutInflate to avoid asking for a new one each time.
            mInflater = LayoutInflater.from(context);

            // Icons bound to the rows.
            mIcon1 = BitmapFactory.decodeResource(context.getResources(), R.drawable.icon);
            mIcon2 = BitmapFactory.decodeResource(context.getResources(), R.drawable.icon);
        }

        public int getCount() {
            return devicesList.size();
        }

        public void addItem(final String item) {
            devicesList.add(item);
            notifyDataSetChanged();
        }

        public Object getItem(int position) {
            return position;
        }

        public long getItemId(int position) {
            return position;
        }

        @Override
        public void notifyDataSetChanged() // Create this function in your adapter class
        {
            super.notifyDataSetChanged();
        }

        public void addSeparatorItem(final String item) {
            devicesList.add(item);
            // save separator position
            mSeparatorsSet.add(devicesList.size() - 1);
            notifyDataSetChanged();
        }

        @Override
        public int getItemViewType(int position) {
            return mSeparatorsSet.contains(position) ? TYPE_SEPARATOR : TYPE_ITEM;
        }

        public View getView(int position, View convertView, ViewGroup parent) {
            // A ViewHolder keeps references to children views to avoid unneccessary calls
            // to findViewById() on each row.
            ViewHolder holder;

            // When convertView is not null, we can reuse it directly, there is no need
            // to reinflate it. We only inflate a new View when the convertView supplied
            // by ListView is null.
            int type = getItemViewType(position);

            if (convertView == null) {

                holder = new ViewHolder();

                switch (type) {
                    case TYPE_ITEM:
                        convertView = mInflater.inflate(R.layout.list_item, null);
                        // Creates a ViewHolder and store references to the two children views
                        // we want to bind data to.
                        holder.text = (TextView) convertView.findViewById(R.id.Title_List_Item);
                        holder.icon = (ImageView) convertView.findViewById(R.id.Delete_List_Item);
                        break;
                    case TYPE_SEPARATOR:
                        convertView = mInflater.inflate(R.layout.seperator_item, null);
                        holder.text = (TextView)convertView.findViewById(R.id.Text_Seperator_Item);
                        break;
                }

                convertView.setTag(holder);

            } else {
                // Get the ViewHolder back to get fast access to the TextView
                // and the ImageView.
                holder = (ViewHolder) convertView.getTag();
            }

            switch (type) {
                case TYPE_ITEM:
                    convertView.findViewById(R.id.Title_List_Item).setTag(devicesList.get(position));
                    convertView.findViewById(R.id.Delete_List_Item).setTag(devicesList.get(position));

                    holder.text.setText(devicesList.get(position));
                    holder.icon.setImageBitmap((position & 1) == 1 ? mIcon1 : mIcon2);

                    holder.text.setOnClickListener(mOnTitleClickListener);
                    holder.icon.setOnClickListener(mOnIconClickListener);
                    break;
                 case TYPE_SEPARATOR:
                     holder.text.setText(devicesList.get(position));
                     break;
            }

            return convertView;
        }

        private OnClickListener mOnTitleClickListener = new OnClickListener() {
            public void onClick(View v) {
                    if(v.getTag().toString() == "ADD DEVICE"){
                        Intent addDevice = new Intent(getApplicationContext(), addDevice.class);
                        startActivity(addDevice);
                    }else{
                        Intent showRemote = new Intent(TutListActivity.this, Remote.class);
                        showRemote.putExtra("selectedDevice", v.getTag().toString());
                        startActivity(showRemote);
                    }
            }
        };

        private OnClickListener mOnIconClickListener = new OnClickListener() {
            public void onClick(View v) {
                String NameOfDevice[] = new String[2];
                NameOfDevice = v.getTag().toString().split(",");
                mDatenbank.execSQL("DELETE FROM addedDevices WHERE name = '"+NameOfDevice[0]+"'");

                ladeDevices();
                objectAdapter.notifyDataSetChanged();
            }
        };

        class ViewHolder {
            TextView text;
            ImageView icon;
        }
    }

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.mainlayout);

        mHelper = new DatabaseManager(this);
        mDatenbank = mHelper.getReadableDatabase();

        listView = (ListView) findViewById(R.id.list);
        objectAdapter = new EfficientAdapter(this);

        new LoadDevices().execute();

    }

    private class LoadDevices extends AsyncTask<String, Integer, String> {

        @Override
        protected void onPreExecute() {
        }

        @Override
        protected String doInBackground(String... params) {
            devicesList = new ArrayList<String>();
            Cursor devicesCursor = mDatenbank.query("addedDevices", new String[] {"name", "hersteller"}, null, null, null, null, null);
            startManagingCursor(devicesCursor);
            devicesCursor.moveToFirst();

            for (int i=0;i<devicesCursor.getCount();i++){ 
                String addingElement = new String(devicesCursor.getString(0)+", "+devicesCursor.getString(1));
                objectAdapter.addItem(addingElement);
                devicesCursor.moveToNext();
                if (i % 4 == 0) {
                    objectAdapter.addSeparatorItem("separator " + i);
                }
            } 
            objectAdapter.addItem("ADD DEVICE");

            return "All Done!";
        }

        @Override
        protected void onProgressUpdate(Integer... values) {
        }

        @Override
        protected void onPostExecute(String result) {

            listView.setAdapter(objectAdapter);
        }
    }

    private void ladeDevices() {
        }

} 
```

这是 Logcat 输出：

```
12-10 21:46:04.891: E/AndroidRuntime(5815): FATAL EXCEPTION: main
12-10 21:46:04.891: E/AndroidRuntime(5815): java.lang.NullPointerException
12-10 21:46:04.891: E/AndroidRuntime(5815):     at com.mamlambo.tutorial.tutlist.TutListActivity$EfficientAdapter.getView(TutListActivity.java:152)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.widget.AbsListView.obtainView(AbsListView.java:2255)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.widget.ListView.makeAndAddView(ListView.java:1769)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.widget.ListView.fillDown(ListView.java:672)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.widget.ListView.fillGap(ListView.java:636)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.widget.AbsListView.trackMotionScroll(AbsListView.java:5040)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.widget.AbsListView.scrollIfNeeded(AbsListView.java:3197)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.widget.AbsListView.onTouchEvent(AbsListView.java:3471)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.View.dispatchTouchEvent(View.java:7127)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2170)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1905)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1925)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1379)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.app.Activity.dispatchTouchEvent(Activity.java:2396)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1873)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.View.dispatchPointerEvent(View.java:7307)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:3174)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewRootImpl.deliverInputEvent(ViewRootImpl.java:3119)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewRootImpl.doProcessInputEvents(ViewRootImpl.java:4155)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewRootImpl.enqueueInputEvent(ViewRootImpl.java:4134)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewRootImpl$WindowInputEventReceiver.onInputEvent(ViewRootImpl.java:4226)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.InputEventReceiver.dispatchInputEvent(InputEventReceiver.java:171)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.InputEventReceiver.nativeConsumeBatchedInputEvents(Native Method)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.InputEventReceiver.consumeBatchedInputEvents(InputEventReceiver.java:163)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewRootImpl.doConsumeBatchedInput(ViewRootImpl.java:4205)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.ViewRootImpl$ConsumeBatchedInputRunnable.run(ViewRootImpl.java:4245)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.Choreographer$CallbackRecord.run(Choreographer.java:725)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.Choreographer.doCallbacks(Choreographer.java:555)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.Choreographer.doFrame(Choreographer.java:523)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:711)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.os.Handler.handleCallback(Handler.java:615)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.os.Handler.dispatchMessage(Handler.java:92)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.os.Looper.loop(Looper.java:137)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at android.app.ActivityThread.main(ActivityThread.java:4745)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at java.lang.reflect.Method.invokeNative(Native Method)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at java.lang.reflect.Method.invoke(Method.java:511)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-10 21:46:04.891: E/AndroidRuntime(5815):     at dalvik.system.NativeStart.main(Native Method) 
```

# mysql - 如何计算别名列上的聚合函数 SUM？

> ID：14217944
> 
> 赞同：9
> 
> 时间：2013-01-08T15:07:23.687
> 
> 标签：mysql, sql

如何计算别名列上的聚合函数 SUM？

```
SELECT a.question_id, 
       a.level, 
       Count(a.question_id) AS rank, 
       Sum(rank)        AS total 
FROM   logs AS a, 
       question AS b 
WHERE  a.question_id = b.q_id 
       AND a.level = '2' 
GROUP  BY a.question_id 
ORDER  BY rank DESC 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-08-02T15:39:32.467

只需用 (SELECT alias) 包装您重用的别名：

```
SELECT a.question_id, 
       a.level, 
       COUNT(a.question_id) AS rank, 
       SUM(SELECT(rank)) AS total 
FROM   logs AS a, 
       question AS b 
WHERE  a.question_id = b.q_id 
       AND a.level = '2' 
GROUP  BY a.question_id 
ORDER  BY rank DESC 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-08T15:27:46.813

SQL 的作用域规则不允许您在同一`select`. 虽然这看起来不合理，但这是为了防止混淆，例如：

```
select 2*x as x, x+1 
```

第二个变量指的是哪个`x`？

您可以通过使用子查询来解决此问题：

```
select t.*, Sum(rank) AS total 
from (SELECT a.question_id, a.level, Count(a.question_id) AS rank, 
      FROM logs AS a join
           question AS b 
           on a.question_id = b.q_id 
      WHERE a.level = '2' 
      GROUP  BY a.question_id 
     ) t
ORDER BY rank DESC 
```

我还修复了您的连接语法。在子句中使用逗号表示`cross join`带有限制的a`where`已经过时了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:25:28.937

`SUM(rank)`除非您的分组与您的分组不同，否则这样做没有任何意义`COUNT(a.question_id)`。否则，SUM 将始终处理一行 - 这是 COUNT 结果的值。此外，您要求在`COUNT(a.question_id)`哪里指定 GROUP BY 子句也使用`a.question_id`. 这不会返回您正在寻找的结果。

如果您澄清分组的用途`rank`，则可以为此进行子查询。

# c++ - 如何在 C++ 中打开 Nano 并从中获取字符串？

> ID：14217946
> 
> 赞同：0
> 
> 时间：2013-01-08T15:07:29.390
> 
> 标签：c++, linux, git, command-line-interface, nano

我正在创建一个简单的日志记录程序。当用户进入`log some_file`控制台时，程序当前只是简单地接收来自 的一些基本输入`cin`，并将其记录到`some_file`.

但是，我不想使用 实现我自己的编辑器`cin`，而是想打开 Nano 编辑器并让用户在那里编辑他的消息。

然后，当消息完成时，我希望我的 C++ 记录器将其作为字符串接收并继续。

这正是 git 在提交时所做的。

我怎样才能做到这一点？

（最好不使用expect等工具，只使用原始C++代码。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T15:11:29.890

大多数编辑器都希望使用普通文件，因此您通常会创建一个临时文件，然后在其命令行上将该文件的名称传递给编辑器。当编辑器返回时，您将临时文件中的内容复制到您的日志中，然后销毁该文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:17:18.360

如果要使用 Nano 编辑器，则需要运行 system() 函数以使用临时文件调用 Nano。然后稍后删除文件..

```
std::string filename = "/tmp/.out." + std::to_string(getpid());
std::string cmd = "/bin/nano " + filename
system(cmd.c_str());
// read from filename
unlink(filename.c_str()); 
```

**更新**

如果按照 DevSolar 的建议使用 tmpnam()

```
char filename[L_tmpnam];
tmpnam(filename);
std::string cmd  = "/bin/nano " + filename
system(cmd.c_str());
unlink(filename); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:11:53.237

打开一个文件（将文件名传递给编辑器），保存然后从你的程序中读取它呢？我一直认为 git 的工作方式相同。

# mysql - 嵌套 SQL，查找哪些论坛有某种类型的帖子

> ID：14217949
> 
> 赞同：0
> 
> 时间：2013-01-08T15:07:39.070
> 
> 标签：mysql, sql, nested-queries

我有一个我试图运行的 SQL 语句，但它抛出了一个错误：

```
SELECT fp.forum_id, COUNT(fp.forum_id) AS num_posts
FROM forums_posts fp
GROUP BY fp.forum_id
WHERE (
    SELECT COUNT(p.post_id) AS num_joined_posts
    FROM posts p
    WHERE p.post_type IN ('TypeA', 'TypeB', 'TypeC')
        AND p.forum_id = fp.forum_id
) > 0
ORDER BY num_posts DESC 
```

该`forums_posts`表是一个将论坛 ID 与帖子 ID 匹配的关系表，并且该`posts`表（也存储帖子的论坛 ID）仅包含有关每个帖子的信息。我试图找出：哪些论坛有 TypeA、TypeB 或 TypeC 类型的帖子；以及每个论坛中有多少帖子。

嵌套 SQL 语句从来都不是我的强项。有人可以指出正确的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T15:12:07.063

`where`应该在之前`group by`。

您也可以使用显式来编写`join`：

```
SELECT fp.forum_id, COUNT(fp.forum_id) AS num_posts
FROM forums_posts fp join
     (SELECT p.forum_id, COUNT(p.post_id) AS num_joined_posts
      FROM posts p
      WHERE p.post_type IN ('TypeA', 'TypeB', 'TypeC')
      group by p.forum_id
     ) p
     on p.forum_id = fp.forum_id
GROUP BY fp.forum_id
ORDER BY num_posts DESC 
```

虽然，我认为最有效的演绎可能是：

```
SELECT fp.forum_id, COUNT(fp.forum_id) AS num_posts
FROM forums_posts fp join
GROUP BY fp.forum_id
having exists (select 1
               FROM posts p
               WHERE p.post_type IN ('TypeA', 'TypeB', 'TypeC') and
                     p.forum_id = pf.forum_id
               limit 1
              )
ORDER BY num_posts DESC 
```

特别是如果您对帖子（forum_id，post_type）有索引。我将条件`having`从`where`子句移到子句，因为分组后用于此比较的数据可能较少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:13:09.857

尝试这个-

```
SELECT fp.forum_id, COUNT(fp.forum_id) AS num_posts
FROM forums_posts fp
WHERE (
    SELECT COUNT(p.post_id) AS num_joined_posts
    FROM posts p
    WHERE p.post_type IN ('TypeA', 'TypeB', 'TypeC')
        AND p.forum_id = fp.forum_id
) > 0
GROUP BY fp.forum_id
ORDER BY num_posts DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:13:38.923

我就是这样做的，SQL 往往使用连接更快。

```
SELECT * FROM 
(
  SELECT fp.forum_id,
       SUM(CASE p.post_type = 'TypeA' THEN 1 ELSE 0 END) AS A_Count,
       SUM(CASE p.post_type = 'TypeB' THEN 1 ELSE 0 END) AS B_Count,
       SUM(CASE p.post_type = 'TypeC' THEN 1 ELSE 0 END) AS C_Count
  FROM forums_posts fp
  LEFT JOIN posts p ON fp.forum_id = p.forum_id
  GROUP BY fp.forum_id
) T
WHERE T.A_count > 0 AND T.B_count > 0 AND T.C_count > 0 
```

我没有测试过这个，所以它可能有错别字。

# ruby-on-rails - 通过 CanCan 中的多态关联定义能力

> ID：14217957
> 
> 赞同：2
> 
> 时间：2013-01-08T15:07:51.823
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, cancan, polymorphic-associations, rails-activerecord

我有以下型号：

```
class Post < ActiveRecord::Base
   has_many :responses, as: :responseable, dependent: :destroy
end

class Call < ActiveRecord::Base
   has_many :responses, as: :responseable, dependent: :destroy
end

class Meeting < ActiveRecord::Base
   has_many :responses, as: :responseable, dependent: :destroy
end

class Response < ActiveRecord::Base
   belongs_to :responseable, polymorphic: true # Tested
end 
```

在 CanCan 中，我试图通过多态关联中的属性来定义特定自定义响应操作的能力。动作如下所示：

```
class ResponsesController < ApplicationController

  before_filter :authenticate_user!
  load_and_authorize_resource

  respond_to :html, :xml, :js, :json, :pdf

  # GET /responses/polling
  # GET /responses/polling.json
  def polling
    responseable_type = params[:responseable_type]
    klass = [Post, Call, Meeting].detect { |c| responseable_type}
    @responseable = klass.find(params[:responseable_id])
    undivided_millisecond_epoch_time_in_integer = params[:after]
    undivided_millisecond_epoch_time_in_decimal = (undivided_millisecond_epoch_time_in_integer).to_d
    divided_millisecond_epoch_time_in_decimal = (undivided_millisecond_epoch_time_in_decimal / 1000000).to_d
    @responses = @responseable.responses.where("created_at > ?", Time.at(divided_millisecond_epoch_time_in_decimal))
  end
... 
```

此操作通过一个 JavaScript 函数运行，该函数每 5 秒轮询一次新响应。但是，当它运行时，我在日志中收到以下错误：

```
A NameError occurred in responses#polling:

  uninitialized constant Responseable
  activesupport (3.2.8) lib/active_support/inflector/methods.rb:230:in `block in constantize' 
```

知道定义这些能力类型的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:30:08.947

您在该控制器中弄得一团糟，请尝试遵循 REST（或 CRUD）。

无论如何，Cancan 将无法检测到您尝试授权的资源。尝试这样的事情：

```
load_resource :post
load_resource :call
load_resource :meeting
load_and_authorize_resource :response, :through => [:post, :call, :meeting] 
```

# android - 谷歌JSON解析问题

> ID：14217958
> 
> 赞同：0
> 
> 时间：2013-01-08T15:07:51.947
> 
> 标签：android, json, google-api-client

> **可能重复：**
> [android.os.NetworkOnMainThreadException](https://stackoverflow.com/questions/6343166/android-os-networkonmainthreadexception)

我决定使用[google api 客户端](http://code.google.com/p/google-api-java-client)。我从[这个例子](http://www.androidhive.info/2012/08/android-working-with-google-places-and-maps-tutorial)中得到了一个解析 JSON 的类，它在 android 2.2 上运行良好。但是，当我在 android 3.x 或 4.x 上进行测试时，它崩溃了。如何解决？

```
public class GooglePlaces {

    /** Global instance of the HTTP transport. */
    private static final HttpTransport HTTP_TRANSPORT = new NetHttpTransport();

    // Google API Key
    private static final String API_KEY = "AIzaSyCRLa4LQZWNQBcjCYcIVYA45i9i8zfClqc"; 
    private static final String PLACES_SEARCH_URL = "https://maps.googleapis.com/maps/api/place/search/json?";
    private static final String PLACES_SEARCH_GEOPOINT_URL = "http://maps.googleapis.com/maps/api/geocode/json?";
    private static final String PLACES_TEXT_SEARCH_URL = "https://maps.googleapis.com/maps/api/place/search/json?";
    private static final String PLACES_DETAILS_URL = "https://maps.googleapis.com/maps/api/place/details/json?";
    private static final String DIRECTION_URL = "https://maps.googleapis.com/maps/api/directions/json?";
    private double _latitude;
    private double _longitude;
    private double _radius;
    public String test = new String("");

    public PlacesList search(double latitude, double longitude, double radius, String types) throws Exception {

        this._latitude = latitude;
        this._longitude = longitude;
        this._radius = radius;

        try {

            HttpRequestFactory httpRequestFactory = createRequestFactory(HTTP_TRANSPORT);
            HttpRequest request = httpRequestFactory.buildGetRequest(new GenericUrl(PLACES_SEARCH_URL));
            request.getUrl().put("key", API_KEY);
            request.getUrl().put("location", _latitude + "," + _longitude);
            request.getUrl().put("radius", _radius); // in meters
            request.getUrl().put("sensor", "false");
            if (types != null)
                request.getUrl().put("types", types);

            PlacesList list = request.execute().parseAs(PlacesList.class);
            // Check log cat for places response status
            Log.d("Places Status", "" + list.status);
            return list;

        } catch (HttpResponseException e) {
            Log.e("Error:", e.getMessage());
            return null;
        }
    }

    public static HttpRequestFactory createRequestFactory(final HttpTransport transport) {
        return transport.createRequestFactory(new HttpRequestInitializer() {
            public void initialize(HttpRequest request) {
                GoogleHeaders headers = new GoogleHeaders();
                headers.setApplicationName("AndroidHive-Places-Test");
                request.setHeaders(headers);
                JsonObjectParser parser = new JsonObjectParser(new JacksonFactory());
                request.setParser(parser);
            }
        });
    }
} 
```

这是我导入的库：

```
google-api-client-1.10.3-beta.jar
google-api-client-android2-1.10.3-beta.jar
google-http-client-1.10.3-beta.jar
google-http-client-android2-1.10.3-beta.jar
google-oauth-client-1.10.1-beta.jar
gson-2.1.jar
guava-11.0.1.jar
jackson-core-asl-1.9.4.jar
jsr305-1.3.9.jar
protobuf-java-2.2.0.jar 
```

这是日志猫

```
01-08 22:20:55.318: E/InputEventReceiver(771): Exception dispatching input event.
01-08 22:20:55.318: E/MessageQueue-JNI(771): Exception in MessageQueue callback: handleReceiveCallback
01-08 22:20:55.416: E/MessageQueue-JNI(771): android.os.NetworkOnMainThreadException
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at java.net.InetAddress.getAllByName(InetAddress.java:214)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:341)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:315)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpEngine.connect(HttpEngine.java:310)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:289)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:239)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:80)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.google.api.client.http.javanet.NetHttpRequest.execute(NetHttpRequest.java:90)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:895)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.ftravelbook.json.GooglePlaces.getInfo(GooglePlaces.java:50)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.ftravelbook.maps.google.GoogleActivity$Touchy.onTouchEvent(GoogleActivity.java:356)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.google.android.maps.OverlayBundle.onTouchEvent(OverlayBundle.java:63)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.google.android.maps.MapView.onTouchEvent(MapView.java:681)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.View.dispatchTouchEvent(View.java:7127)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2170)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1905)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1925)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1379)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.app.Activity.dispatchTouchEvent(Activity.java:2396)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1873)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.View.dispatchPointerEvent(View.java:7307)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:3174)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewRootImpl.deliverInputEvent(ViewRootImpl.java:3119)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewRootImpl.doProcessInputEvents(ViewRootImpl.java:4155)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewRootImpl.enqueueInputEvent(ViewRootImpl.java:4134)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.ViewRootImpl$WindowInputEventReceiver.onInputEvent(ViewRootImpl.java:4226)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.view.InputEventReceiver.dispatchInputEvent(InputEventReceiver.java:171)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.os.MessageQueue.nativePollOnce(Native Method)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.os.MessageQueue.next(MessageQueue.java:125)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.os.Looper.loop(Looper.java:124)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at android.app.ActivityThread.main(ActivityThread.java:4745)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at java.lang.reflect.Method.invokeNative(Native Method)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at java.lang.reflect.Method.invoke(Method.java:511)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
01-08 22:20:55.416: E/MessageQueue-JNI(771):    at dalvik.system.NativeStart.main(Native Method)
01-08 22:20:55.416: D/AndroidRuntime(771): Shutting down VM
01-08 22:20:55.426: W/dalvikvm(771): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
01-08 22:20:55.476: E/AndroidRuntime(771): FATAL EXCEPTION: main
01-08 22:20:55.476: E/AndroidRuntime(771): android.os.NetworkOnMainThreadException
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
01-08 22:20:55.476: E/AndroidRuntime(771):  at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
01-08 22:20:55.476: E/AndroidRuntime(771):  at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
01-08 22:20:55.476: E/AndroidRuntime(771):  at java.net.InetAddress.getAllByName(InetAddress.java:214)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:341)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:315)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpEngine.connect(HttpEngine.java:310)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:289)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:239)
01-08 22:20:55.476: E/AndroidRuntime(771):  at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:80)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.google.api.client.http.javanet.NetHttpRequest.execute(NetHttpRequest.java:90)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:895)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.ftravelbook.json.GooglePlaces.getInfo(GooglePlaces.java:50)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.ftravelbook.maps.google.GoogleActivity$Touchy.onTouchEvent(GoogleActivity.java:356)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.google.android.maps.OverlayBundle.onTouchEvent(OverlayBundle.java:63)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.google.android.maps.MapView.onTouchEvent(MapView.java:681)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.View.dispatchTouchEvent(View.java:7127)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2170)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1905)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:2176)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1919)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1925)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1379)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.app.Activity.dispatchTouchEvent(Activity.java:2396)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1873)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.View.dispatchPointerEvent(View.java:7307)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:3174)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewRootImpl.deliverInputEvent(ViewRootImpl.java:3119)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewRootImpl.doProcessInputEvents(ViewRootImpl.java:4155)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewRootImpl.enqueueInputEvent(ViewRootImpl.java:4134)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.ViewRootImpl$WindowInputEventReceiver.onInputEvent(ViewRootImpl.java:4226)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.view.InputEventReceiver.dispatchInputEvent(InputEventReceiver.java:171)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.os.MessageQueue.nativePollOnce(Native Method)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.os.MessageQueue.next(MessageQueue.java:125)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.os.Looper.loop(Looper.java:124)
01-08 22:20:55.476: E/AndroidRuntime(771):  at android.app.ActivityThread.main(ActivityThread.java:4745)
01-08 22:20:55.476: E/AndroidRuntime(771):  at java.lang.reflect.Method.invokeNative(Native Method)
01-08 22:20:55.476: E/AndroidRuntime(771):  at java.lang.reflect.Method.invoke(Method.java:511)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
01-08 22:20:55.476: E/AndroidRuntime(771):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
01-08 22:20:55.476: E/AndroidRuntime(771):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:28:30.930

这不是 JSON/GSON 问题。问题是您正在 UI 线程上进行网络调用。这在早期版本的 Android 中是一个警告 - 在更高版本的 SDK（我认为是 3.0）中更改为编译错误。

最重要的是，将您的网络调用移出 UI 线程（使用 AsyncTask）来解决此问题。

# ruby-on-rails - 如何打破括号内的线

> ID：14217959
> 
> 赞同：-2
> 
> 时间：2013-01-08T15:07:53.910
> 
> 标签：ruby-on-rails, ruby, haml

我希望能够在括号内换行而不会出现“括号不一致”错误。

这是一个例子：

```
select.someclass.something{data: {max_amount: o.max_amount_clean, max_amount: o.min_amount_clean, fee: o.fee_clean}} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:19:33.970

我不确定我是否理解，但如果参数是哈希而不是块，就像看起来一样，你可以这样做

```
select.someclass.something(
  {data: 
      {max_amount: o.max_amount_clean, 
       max_amount: o.min_amount_clean, 
       fee: o.fee_clean}}
) 
```

# extjs4 - 如何将数据加载到树存储中。来自另一个树存储的读取器的数据

> ID：14217965
> 
> 赞同：1
> 
> 时间：2013-01-08T15:08:19.163
> 
> 标签：extjs4

我有几个树面板，每个面板都配置了单独的树商店。我已经为一家商店配置了代理。在此加载事件中，我正在尝试加载第二个存储（代理内存），如下所示。但它不起作用。

EXT js 版本：4.0.7

```
_treeStore2 = Ext.create('Ext.data.TreeStore', {
    model: 'Scenario',
    proxy   : {
         type    : 'memory'         
    }

});

_treeStore1 = Ext.create('Ext.data.TreeStore', {
    model: 'Scenario',     
    root:'data1',
    proxy   : {
         type    : 'ajax',
         url: '/proj/examples?id='+_Id,          
         reader  : {
             type    : 'json',
             root:'data1'
            }
    },
    listeners: {
         'load': {
              fn: function(store, records, success, operations) {           
                              _treeStore2.setRootNode(_treeStore1.getProxy().getReader().jsonData.data2);           
                                 } 
    }
}); 
```

示例 JSON 数据：

```
{"data1":[{"name":"value","children":[]}],"data2":[{"name":"value","children":[]}]} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-09T00:36:30.753

尝试使用 loadData(data2) 或 loadRawData 方法。 [http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Store-method-loadRawData](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Store-method-loadRawData)

# prolog - 如何在 SWI Prolog 中获取术语的类型

> ID：14217966
> 
> 赞同：1
> 
> 时间：2013-01-08T15:08:24.860
> 
> 标签：prolog

有没有办法知道 Prolog 中的变量是什么类型？我有代码

```
test:- 
    writeln('Please enter the absolut file name :'),
    read(FileName),
    write('Opening file '),
    write(FileName),nl,
    open(FileName,read,Stream),
    read_file(Stream,Lines),
    close(Stream),
    parseLines(Lines).

% used on reading the text file 
read_file(Stream,[]) :-
    at_end_of_stream(Stream).
% used on reading the text file 
read_file(Stream,[X|L]) :-
    \+ at_end_of_stream(Stream),
    read(Stream,X),
    read_file(Stream,L).

parseLines(Lines):-
%primele 2 linii contin lista cu barbatii si list cu femeile iar 
%restul liniilor contin preferintele acestora
    Lines=[LB|[LF|LPrefs]],
    writeln(LB),
    atom_length(LB,2). 
```

我得到了错误（运行测试时）

```
ERROR: [Thread pdt_console_client_0_Default Process] atom_length/2: Type error: `list' expected, found `man([m1,m2])' 
```

输入文本文件包含

```
man = {m1, m2}.
women = {w1, w2}.

m1: w1 > w2.
m2: w1 > w2.
w1: m1 > m2.
w2: m1 > m2. 
```

我正在尝试解析该文件，但是我尝试的任何操作都会收到该错误，例如从文件中读取的 Lines 中的内容不是 string,atoms ，我不知道该怎么做才能解决此问题。

PS关于如何快速/简单地解析文件的任何想法？奇怪的是，解析问题的输入比解决问题要困难得多。

谢谢。

编辑：我找到了复合谓词，从文件中读取的行是复合术语。Edit2：我的目标是读取该文件中的数据并对其进行断言或类似的，我想解决稳定的婚姻问题，我解决了但我无法弄清楚从该文件格式读取输入的这一部分。

Edit3：我有其他输入文件，其中包含以下行：

```
alan: christine > tina > zoe > ruth > sarah. 
```

由于多个 > 运算符，当尝试将它们作为术语读取时，这条线失败了，所以我认为并不是我的所有输入都是有效的 Prolog

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T16:58:58.173

由于您标记了您的问题 [swi-prolog]，并且您的文件包含有效的 Prolog 术语，您可以使用[read_file_to_terms](http://www.swi-prolog.org/pldoc/doc_for?object=read_file_to_terms/3) /3，并在一次调用中加载列表（此提示适用于 PS 部分）。之后，您必须处理您的条款列表：您的 parseLines/1 它没用。就像列表处理的示例一样，我将显示每个加载的术语：

```
?- read_file_to_terms('/home/carlo/x.txt',L,[]), maplist(writeln, L).
man={m1,m2}
women={w1,w2}
m1:w1>w2
m2:w1>w2
w1:m1>m2
w2:m1>m2
L = [man={m1, m2}, women={w1, w2}, m1:w1>w2, m2:w1>w2, w1:m1>m2, w2:m1>m2]. 
```

*编辑* 我认为 {} 被命名为“集合构造函数”，它只是一个奇怪的复合形状：

```
?- write_canonical({a,b,c}).
{}(','(a,','(b,c))) 
```

您可以使用 univ 获取参数列表

```
?- {a,b,c} =.. X.
X = [{}, (a, b, c)]. 
```

**以前*编辑中的***错误****

 ***`=..`似乎没有什么相关性，因为 {} 不仅仅是一个复合词，它更像一个运算符，*包括*前缀和后缀（即以某种方式组合`op(xf,,({))`and `op(fx,,(}))`）。

AFAIK 将“集合”转换为列表需要类似

```
setcons_to_list(S, L) :-
    S =.. [{}, E] -> andexpr_to_list(E, L) ; L = [].

andexpr_to_list((E,Es), [E|Ts]) :-
    !, andexpr_to_list(Es, Ts).
andexpr_to_list(E, [E]). 
```

测试

```
?- setcons_to_list({},L).
L = [].

?- setcons_to_list({1,2,3,4},L).
L = [1, 2, 3, 4]. 
```

*更多编辑*

Prolog 运算符是“可配置的”，可以向解析器指示该首选项列表。在源代码中添加[op](http://www.swi-prolog.org/pldoc/doc_for?object=op/3)声明`:- op(10,xfy,(>)).`。这里是使用提示的示例

```
?- op(10,xfy,(>)).
true.

?- X = (alan: christine > tina > zoe > ruth > sarah),write_canonical(X).
:(alan,>(christine,>(tina,>(zoe,>(ruth,sarah)))))
X = alan:christine>tina>zoe>ruth>sarah. 
```

当心：更改预定义的关联性应该小心。否则，如果您更喜欢使用 DCG 制作更通用的解析器，那么[这个其他答案可能会很有用。](https://stackoverflow.com/a/14024377/874024)***

# html - html div 容器不会因内部内容而占用高度

> ID：14217974
> 
> 赞同：1
> 
> 时间：2013-01-08T15:08:46.643
> 
> 标签：html, containers

为什么`<div id = "container">`高度是 433px？我制作了这个页面[http://www.elektroninescigaretes.ym.lt/](http://www.elektroninescigaretes.ym.lt/)当我检查一个元素时它显示我 div 只有 433px 我想在页脚上制作版权所有（c）的东西，所以我需要 div 有所有页面的高度不仅是上部。

```
//index file
<?php include ("template/header.php"); ?>
<div id = "home_content"></div>
<?php include ("template/footer.php"); ?>

//header file

<!DOCTYPE html>
<html>
<head>
<link rel = "stylesheet" href = "media/styles/style.css" media = "screen">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>el Cigarai</title>
</head>
<body class = "<?php 
$remove = array(".php", "/");
$url = $_SERVER['SCRIPT_NAME'];
$current_file = str_replace($remove, "", $url);
 $current_page = explode('_', $current_file);
 echo $current_page[0];
?>">

<div id = "container">

//footer file

</div>
</body>
</html>

  /style file

#container{
position: relative;
margin: 0 auto;
width: 960px;
height: 100%;
}
#home_content{
position: absolute;
top: 294px;
right: 60px;
width: 960px;
height: 750px;
background-image: url('../images/woman.jpg');
background-repeat: no-repeat;
overflow: hidden;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T15:29:48.353

把它放在你的风格中：

```
html body{height: 100%;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:35:25.993

您设置了 100% 的高度，这意味着如果您的内容增长大于视口（或父容器）表示的 100%，它将不会增长。尝试使用

```
min-height:100% 
```

# java - 获取并发修改异常。问题出在哪里？（代码）

> ID：14217975
> 
> 赞同：0
> 
> 时间：2013-01-08T15:08:47.950
> 
> 标签：java, swing, concurrentmodification

我用Java写了一个简单的游戏。这是主要代码：

```
public class MainPanel extends JPanel {
    private Player player = new Player(100, 100, 3, 3);
    private Point2D targetPoint = new Point2D.Float(130, 350); //Pos on begin
    private ArrayList<Beam> beams = new ArrayList<Beam>();

    public MainPanel() {
        setPreferredSize(new Dimension(300, 400));

        addMouseMotionListener(new MouseMotionHandler());
        //Add shortcuts
        makeShortcut("player.BM1", "F1", new SetBeamModeAction(1));
        makeShortcut("player.BM2", "F2", new SetBeamModeAction(2));

        //Start threads
        Thread t = new Thread(new PlayerMoveRunnable());
        t.start();
        Thread t2 = new Thread(new PlayerShootRunnable());
        t2.start();
    }

    public void paintComponent(Graphics g) {
        Graphics2D g2 = (Graphics2D)g;
        g2.setColor(Color.BLACK);
        g2.fillRect(0, 0, 300, 400);
        //Draw player
        g2.drawImage(player.getImage(), (int)player.getX(), (int)player.getY(), null);
        //Draw beams
        for (Beam beam : beams) {
            g2.drawImage(beam.getImage(), (int)beam.getX(), (int)beam.getY(), null);
        }
    }

    //Thread running all the time
    private class PlayerMoveRunnable implements Runnable {
        public void run() {
            try {
                while (true) {
                    player.moveToPoint(targetPoint);
                    repaint();
                    Thread.sleep(15);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }

    //Thread working all the time
    private class PlayerShootRunnable implements Runnable {
        public void run() {
            try {
                while (true) {
                    //Choose which beam to shoot (depends on set mode)
                    Thread t;
                    switch (player.getBeamMode()) {
                        case 1:
                            t = new Thread(new BeamMoveRunnable(new Beam1(player.getX()+18, player.getY(), 0, -15)));
                            break;
                        case 2:
                            t = new Thread(new BeamMoveRunnable(new Beam2(player.getX()+18, player.getY(), 0, -30)));
                            break;
                        default:
                            t = null;
                            break;
                    }
                    t.start();
                    Thread.sleep(200);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }

    private class BeamMoveRunnable implements Runnable {
        private Beam beam;

        public BeamMoveRunnable(Beam beam) {
            this.beam = beam;
        }

        public void run() {
            Beam beam = this.beam;
            beams.add(beam);
            try {
                while (true) {
                    if (beam.getY() <= 0) {
                        beams.remove(beam);
                        break;
                    }
                    beam.move();
                    repaint();
                    Thread.sleep(20);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

**[它不是完整的代码。我剪了几行肯定不会引起问题]**

我收到这样的错误：

```
Exception in thread "AWT-EventQueue-0" java.util.ConcurrentModificationException
    at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:819)
    at java.util.ArrayList$Itr.next(ArrayList.java:791)
    at spacecommander.MainPanel.paintComponent(MainPanel.java:53)
    at javax.swing.JComponent.paint(JComponent.java:1054) 
```

等等...

问题出在哪里？我知道 ConcurrentModificationException 是什么意思，但我不知道问题出在哪里。也许我应该进行一些同步。如果是，请显示在哪里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:27:22.187

在迭代光束之前，`paintComponent`创建集合的副本并使用副本进行迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T15:15:07.213

您正在修改另一个线程中的梁列表，例如`BeamMoveRunnable`，当您迭代集合时。

为每个对象创建一个线程非常浪费且难以管理。

我建议你有一个线程定期调用每个梁上的方法来移动。我建议您在绘制梁时不要添加或删除梁，这样您就不必同步对集合的访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:13:12.093

`beams`您正在修改线程`BeamMoveRunnable`（包装此对象的线程）中的数组列表，`Runnable`同时在方法中对其进行迭代`paintComponent`。这就是异常的原因。

# java - 如何为交互式会话创建有状态的 Groovy 绑定

> ID：14217976
> 
> 赞同：1
> 
> 时间：2013-01-08T15:08:48.640
> 
> 标签：java, groovy

我正在构建一个基于 groovy 的工具，作为一个插件，我想提供一个交互式命令行，我有这个部分工作，但绑定不会在`GroovyShell.evaluate()`调用之间保持状态，我已经阅读了 groovy 文档他们有一个使用名为 的类的示例，该类`InteractiveGroovyShell`在 2.0.x 版本中不可用。

有没有办法配置普通的 groovy shell 来实现这个功能？

这是我现在如何创建 groovy shell 的简化版本：

```
CompilerConfiguration config = new CompilerConfiguration();
Binding binding = new Binding();
shell = new GroovyShell(binding, config);
shell.evaluate("def a = 20");
shell.evaluate("println a"); //this throws an exception telling the variable does not exist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T19:54:18.330

```
shell.evaluate("def a = 20"); 
```

而不是`def a = 20`你只需要`a = 20`. 每个`evaluate`调用都会解析和编译一个单独的脚本，并且声明（无论是带有`def`还是带有诸如 的显式类型`int a = 20`）成为该特定脚本中的局部变量，并且*不会*在绑定中存储任何内容。如果没有，`def`您将简单地分配给一个未声明的变量，该变量将进入绑定，因此对以后的`evaluate`调用可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:21:07.730

您应该`binding`为不同的 shell 重复使用相同的内容。绑定本身将保持状态：

```
import org.codehaus.groovy.control.CompilerConfiguration

def binding = new Binding()
def shell = new GroovyShell(binding)

shell.evaluate("a = 5")
assert binding.variables == [a:5]

shell.evaluate("println a; b = 6")
assert binding.variables == [a:5, b:6]

def shell2 = new GroovyShell(binding)

// even in a new shell the binding keep the state
shell2.evaluate("c = 7")
assert binding.variables == [a:5, b:6, c:7] 
```

在 groovy 2.0.5 中工作

# extjs - 如何使用来自另一个树存储读取器的数据加载树存储

> ID：14217978
> 
> 赞同：0
> 
> 时间：2013-01-08T15:08:51.823
> 
> 标签：extjs

我有几个树面板，每个面板都配置了单独的树商店。我已经为一家商店配置了代理。在此加载事件中，我正在尝试加载第二个存储（代理内存），如下所示。但不起作用。

分机版本：4.0.7

```
_treeStore2 = Ext.create('Ext.data.TreeStore', {
model: 'Scenario',
proxy : {
type : 'memory'
}

});

_treeStore1 = Ext.create('Ext.data.TreeStore', {
model: 'Scenario',
root:'data1',
proxy : {
type : 'ajax',
url: '/proj/examples?id='+_Id,
reader : {
type : 'json',
root:'data1'
}
},
listeners: {
'load': {
fn: function(store, records, success, operations) {
_treeStore2.setRootNode(_treeStore1.getProxy().getReader().jsonData.data2);
}
}
}); 
```

示例 JSON 数据：

```
 {"data1":[{"name":"value","children":[]}],"data2": [{"name":"value","children":[]}]} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-06T11:45:10.720

尝试这个：

```
/**
 * Because of a bug in Ext.data.NoteInterface in ExtJs < 4.1.3
 * we have to do deep cloning.
 */
var clone = function(node) {
  var result = node.copy(),
      len = node.childNodes ? node.childNodes.length : 0,
      i;
  // Move child nodes across to the copy if required
  for (i = 0; i < len; i++)
    result.appendChild(clone(node.childNodes[i]));
  return result;
};

var oldRoot = store1.getRootNode(),
    newRoot = clone(oldRoot);

store2.setRootNode(newRoot); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T02:24:21.180

不要使用原始 Json 数据，而是尝试将“记录”参数从负载侦听器传递到另一个 Store。所以是这样的：

```
listeners: {
    load: function(store, records) {
        _treeStore2.setRootNode.setRootNode(records);
    } 
} 
```

# android - NoDefaultSpinner 用户必须选择默认元素两次

> ID：14217986
> 
> 赞同：0
> 
> 时间：2013-01-08T15:09:11.413
> 
> 标签：android, spinner, android-spinner

[我在这里](https://stackoverflow.com/questions/14207035/spinner-if-item-selected-again?answertab=votes#tab-top)问了一个问题 并得到了答案

好的，我只需要在 xml 文件中添加包名，所以这个微调器现在可以工作了，但是又出现了另一个问题。要选择在初始化期间选择的元素，我必须单击它两次。我想，这是因为我使用计数器来检查用户是否选择了项目：

```
variables.spinner1.setOnItemSelectedListener(new OnItemSelectedListener() {
                    @Override

                    public void onItemSelected(AdapterView<?> parent, View view,
                            int position, long id) {    
                        CharSequence t2 = (CharSequence) parent.getItemAtPosition(position);
                        variables.wall=t2.toString();
                        if(i>0){ 
                            new DownloadRow().execute();
                        }
                        if(i==0) i++;

                    }
                    @Override
                    public void onNothingSelected(AdapterView<?> arg0) 
                        // TODO Auto-generated method stub
                    }      
                }); 
```

我该怎么做才能使用户只需要单击一次选定的项目？

只是一个提示（即您根本不需要任何处理），不，这是一个错误的变体。情况是，当用户单击位置 0（或任何其他位置）的元素时，新的 DownloadRow().execute() 必须启动。但是现在（我不知道为什么）如果用户点击零位置的元素，什么也不会发生。如果他再次单击它，DownloadRow().execute() 就会启动，因为它必须在第一个用户单击后完成。看起来如果在这个微调器的初始化过程中没有发生 var i 的增量（或其他一些问题）。但是，如果位置==0，我再次增加。然后 DownloadRow().execute() 自动启动，用户自己不选择 iem。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T01:42:51.907

找到了解决方案。

```
 if(i==0) {
        if(position==0) variables.spinner1.setSelection(0);
        i++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T15:59:27.780

我不确定我是否完全理解您在这里尝试做的事情，但我认为如果您将 if 语句更改为：

```
if(position>0){ 
    new DownloadRow().execute();
} 
```

You should get the behaviour that you want, as this starts DownloadRow when an item other than the default value is selected.

如果您需要用户可选择的默认值，那么我建议您改为使用默认值（在位置 0），这只是一个提示（即您根本不需要任何处理），而其他所有位置都是您想调用的选项 DownloadRow().execute

# jquery - 修改 balupton ajaxify-html5.js 以使用两个不同的区域（div）

> ID：14217996
> 
> 赞同：1
> 
> 时间：2013-01-08T15:09:35.877
> 
> 标签：jquery, history.js, ajaxify

balupton 的 ajaxify-html5.js：[https ://github.com/browserstate/ajaxify](https://github.com/browserstate/ajaxify)

我需要修改这个很棒的脚本来实现以下场景：

我页面上的某些链接需要将内容加载到一个 div 然后滚动到它，我页面上的其他链接需要将内容加载到另一个 div 然后滚动到它。

ajaxify-html5 脚本已经能够阻止与某个类的链接。如果我可以利用该功能并将其一分为二，我将准备就绪（即，我会将类 .go-to-divA 用于某些链接，将 .go-to-divB 用于其他链接）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-18T06:24:16.097

我一直在寻找解决方案，我想我们必须首先考虑一些事情才能使其发挥作用。

1 - 我们必须制作 2 个不同的 div 容器来加载内容。让我们命名第一个“主容器”和第二个“子容器”。

2 - 我们需要两个不同的链接类来指向不同的 div 容器，正如您已经放置的那样。'.go-to-divA' 和 '.go-to-divB'。

3 - Ajaxify-html5.js 正在将 url 更改为单击的 ahref 链接。

这两个类都会更改 url，但功能会有所不同。例如，'.go-to-divA' 将加载一个带有“主容器”的页面，其中还包含“子容器”和淡入淡出的整个内容。现在，“主容器”内的“.go-to-divB”类链接将加载“子容器”中淡入和淡出 div 的内容。

所以我想对于这个解决方案，页面结构在我们必须利用脚本功能的方式上起着重要作用。我们必须对此进行测试，看看效果如何

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-20T04:45:03.347

这就是我最终如何做到的。你可以忽略一些额外的东西。

```
// History.js It!
// v1.0.1 - 30 September, 2012
// https://gist.github.com/854622
(function(window,undefined){

  // Prepare our Variables
  var
    History = window.History,
    $ = window.jQuery,
    document = window.document;

  // Check to see if History.js is enabled for our Browser
  if ( !History.enabled ) {
    return false;
  }

  if ($.browser.msie && parseInt($.browser.version, 10) > 9) {
    return false;
  }

  // Wait for Document
  $(function(){

    // Prepare Variables
    var
    /* Application Specific Variables */
    contentSelector = '#contenucoeur',
    replaceZoneActus = '.emplacementactu',
    scrollZoneActus = '#topemplacementactu',
    replaceZoneArticles = '.emplacementarticle',
    scrollZoneArticles = '#topemplacementarticle',
    $contentActus = $(replaceZoneActus),
    $contentArticles = $(replaceZoneArticles),
    contentNodeActus = $contentActus.get(0),
    contentNodeArticles = $contentArticles.get(0),
    $blocArticle = $('.blocArticle'),
    $menu = $('.articualites'),
    activeClass = 'articleactive',
    activeSelector = '.articleaactive',
    menuChildrenSelector = '> article',
    completedEventName = 'statechangecomplete',
    /* Application Generic Variables */
    $window = $(window),
    $body = $(document.body),
    testurl = History.getHash(),
    rootUrl = History.getRootUrl();

    console.log( History, testurl );

    // Ensure Content
    if ( $contentActus.length === 0 || $contentArticles.length === 0 ) {
      $content = $body;
    }

    // Internal Helper
    $.expr[':'].internal = function(obj, index, meta, stack){
      // Prepare
      var
        $this = $(obj),
        url = $this.attr('href')||'',
        isInternalLink;

      // Check link
      isInternalLink = url.substring(0,rootUrl.length) === rootUrl || url.indexOf(':') === -1;

      // Ignore or Keep
      return isInternalLink;
    };

    // HTML Helper
    var documentHtml = function(html){
      // Prepare
      var result = String(html)
        .replace(/<\!DOCTYPE[^>]*>/i, '')
        .replace(/<(html|head|body|title|meta|script)([\s\>])/gi,'<div class="document-$1"$2')
        .replace(/<\/(html|head|body|title|meta|script)\>/gi,'</div>');

      // Return
      return result;
    };

    // Ajaxify Helper
    $.fn.ajaxify = function(){

      // Prepare
      var $this = $(this);

      // Ajaxify
      $this.find('#columns a:not(.btPrint, .linkMore, .linkScroll, .backtopPag, .linkRssActu a, .fluxrsspresse a, .wrapFiltreFAQ a, .page-sitemap .inside a, .titleSearchResult a, .itemWaypoint, .profilLink a, .field-liens-internes a, #ctaDiscover, .downloadMedia a, .homeLink, .wrapFormulaire a, .noAjax, .wrapperArticle a, a[href$=".pdf"], a[href|="http"], a[rel="external"], .wrapError a, .popin a )').live('click', function(event){

        event.preventDefault();

        // Prepare
        var $this = $(this),
            url = $this.attr('href'),
            title = $this.attr('title')||null;

        // variable de la pagination =< cas des précédent - suivant
        pagin = $this.hasClass('linkPag');
        // variable d'empalcement cible de chargement
        emplacement = $this.attr('data-emplacement');

        if( $this.is('.accordilink, .sliderlink, .lienFamille, .closeArticle') ) {

          var idSlider = parseInt( $this.attr('data-slider'), 10 ),
              idAccordeon = parseInt( $this.attr('data-accordeon'), 10 ),
              idBrand = $this.attr('data-category');

          if( $this.is('.closeArticle') ){

            $this.parents('.block-content').fadeOut(700, function(){
              $this.empty();
            });

            if( /homeactus|intranav_homeactus/.test(emplacement) ) {

              if( $('html').attr('lang') == 'fr' ) {
                url = '/';
              } else {
                url = '/en';
              }

              title = 'kendrick ';

              setTimeout(function(){jQuery.scrollTo('#mini-panel-blue_bar', 800, {'axis':'y'});}, 300);

              $blocArticle.removeClass('active');

            } else
            if( /articles|intranav_articles|intranav_brands/.test(emplacement) ) {

              setTimeout(function(){jQuery.scrollTo('.titlePage', 800, {'axis':'y'});}, 300);

              $blocArticle.removeClass('active');

            } else
            if( /actualites|intranav_actualites/.test(emplacement) ) {

              setTimeout(function(){jQuery.scrollTo('.panelsRegion-kendrick_basic-actualit__s-inside', 800, {'axis':'y'});}, 300);

              $blocArticle.removeClass('active');

            }

          } else if( $this.is('.accordilink') ){

            jQuery('.view-rubrique-slider .view-content').accordion('activate', jQuery('#' + idAccordeon + 'rubriqueaccordion').prevAll().length);

            setTimeout(function(){jQuery.scrollTo('#' + idAccordeon + 'rubriqueaccordion', 800, {'axis':'y'});}, 300);

          } else if( $this.is('.lienFamille') ){

            jQuery('.view-marque-accordion .view-content').accordion('activate', jQuery('#' + idBrand).prevAll().length );

            setTimeout(function(){jQuery.scrollTo('#' + idBrand, 800, {'axis':'y'});}, 300);

          } else if( $this.is('.sliderlink') ){

            if ($('#views_slideshow_cycle_main_rubrique_slider-mainslider').length) {

              $('#views_slideshow_pager_field_item_bottom_rubrique_slider-mainslider_' + idSlider + '').trigger('click');
              //Drupal.viewsSlideshow.action({ "action": 'goToSlide', "slideshowID": 'rubrique_slider-mainslider', "slideNum": idSlider });

            }

          }

        } else {

          /* état actif */
          if (!pagin) {

            $('.blocArticle', $('.view-articles')).removeClass('active');
            $this.parents('figure').addClass('active');

          } else {

             dirNext = $this.hasClass('nextActu');

          }

        }

        History.pushState(null,title,url);

        // Continue as normal for cmd clicks etc
        if ( event.which == 2 || event.metaKey ) { return true; }

        // Ajaxify this link
        return false;

      });

      // Chain
      return $this;
    };

    // Ajaxify our Internal Links
    $body.ajaxify();

    // Hook into State Changes
    $window.bind('statechange',function(){
      // Prepare Variables
      var
        State = History.getState(),
        url = State.url,
        url_split = State.url.split('/'),
        relativeUrl = url.replace(rootUrl,'');

        if( url_split.length > 4 ){
          var urlPop = url_split.pop()[0].substring(0, 1);
        }

      // Ajax Request the Traditional Page
      $.ajax({
        beforeSend: function() {

          // Start Fade Out
          // Animating to opacity to 0 still keeps the element's height intact
          // Which prevents that annoying pop bang issue when loading in new content
          // Call emplacement specific actions
          // and only if new content was request
          if( urlPop == '_' ){
            // optimisation http://www.onextrapixel.com/2013/02/21/improve-your-code-with-smart-javascript-techniques-and-patterns/
            if( /articles|intranav_articles|intranav_brands/.test(emplacement) ) {

              //On crée juste la div pour le loader
              $('<div />', {'id':'loader', 'height':'24px'}).prependTo(scrollZoneArticles);

              $contentArticles.animate({
                opacity: 0
              }, 800);

              $.scrollTo(scrollZoneArticles, 800, {'axis':'y'});

            } else if( /actualites|homeactus|intranav_actualites|intranav_homeactus/.test(emplacement) ) {

              //On crée juste la div pour le loader
              $('<div />', {'id':'loader', 'height':'24px'}).prependTo(scrollZoneActus);

              $contentActus.animate({
                opacity: 0
              }, 800);

              $.scrollTo(scrollZoneActus, 800, {'axis':'y'});
            }

          } else {

            $('#topemplacementactu, #topemplacementarticle').find('.view-content').empty();

            $blocArticle.removeClass('active');

            return false;

          }

        },
        url: url,
        success: function(data, textStatus, jqXHR){

          // Prepare
          var
            $data = $(documentHtml(data)),
            $dataTitle = $data.find('.document-title'),
            $dataBody = $data.find('.document-body:first'),
            $dataContent = $dataBody.find(contentSelector).filter(':first'),
            $menuChildren,
            contentHtml = $dataContent.html()||$data.html(),
            $scripts;

          // Fetch the scripts
          $scripts = $dataContent.find('.document-script');
          if ( $scripts.length ) {
            $scripts.detach();
          }

          // Fetch the content
          // contentHtml = $dataContent.html()||$data.html();

          // if contentHtml is null-vide
          if ( !contentHtml ) {
            //document.location.href = url;
            return false;
          }
          function animateLoad(el, elScroll) {

            if (!pagin) {

                el.html(contentHtml).css('opacity', 100);

            } else {

                // if (dirNext) {
                //     var marginLeft = $VAR.widthWindow;
                // } else {
                //     var marginLeft = -$VAR.widthWindow;
                // }

                var marginLeft = -$VAR.widthWindow;

                el.html(contentHtml).css({
                    'opacity': 100,
                    'margin-left': marginLeft,
                    'width': ($VAR.widthWindow > 1280) ? '1280' : $VAR.widthWindow
                }).animate({
                    'margin-left': 0
                }, 500, function(){

                    $(this).css('width', 'auto');

                });

            }

            el.find('.closeArticle').attr('data-emplacement', emplacement).attr('data-accordeon');

            $.scrollTo(elScroll, 800, {'axis':'y'});

          }

          // Update the content if needed

          if( /articles|intranav_articles|intranav_brands/.test(emplacement) ) {

            animateLoad($contentArticles, scrollZoneArticles);

          } else
          if( /actualites|homeactus|intranav_actualites|intranav_homeactus/.test(emplacement) ) {

            animateLoad($contentActus, scrollZoneActus);

          }

          if( $('.innerDiapo').length ){

            setTimeout(initDiapo, 1000);

          }

          if( $('#map').length ){

            setTimeout(imageMap, 1000);

          }

          // Update the title
          document.title = $dataTitle.text();
          try {
            document.getElementsByTagName('title')[0].innerHTML = document.title.replace('<','&lt;').replace('>','&gt;').replace(' & ',' &amp; ');
          }
          catch ( Exception ) { }

          // Add the scripts
          $scripts.each(function(){
            var $script = $(this), scriptText = $script.text(), scriptNode = document.createElement('script');
            scriptNode.appendChild(document.createTextNode(scriptText));
            contentNode.appendChild(scriptNode);
          });

          // We clear out the loader zone
          $('#loader').remove();
          $window.trigger(completedEventName);

          // Inform Google Analytics of the change
          if ( typeof window._gaq !== 'undefined' ) {
            window._gaq.push(['_trackPageview', relativeUrl]);
          }

          // Inform ReInvigorate of a state change
          if ( typeof window.reinvigorate !== 'undefined' && typeof window.reinvigorate.ajax_track !== 'undefined' ) {
            reinvigorate.ajax_track(url);
            // ^ we use the full url here as that is what reinvigorate supports
          }
        },
        error: function(jqXHR, textStatus, errorThrown){
          document.location.href = url;
          return false;
        }
      }); // end ajax

    }); // end onStateChange

  }); // end onDomLoad

})(window); // end closure 
```

# java - java：如何使用bufferedreader读取特定行

> ID：14217997
> 
> 赞同：8
> 
> 时间：2013-01-08T15:09:38.393
> 
> 标签：java, bufferedreader, file-handling, file-read

假设我有一个名为：data.txt（包含 2000 行）的文本文件

如何读取给定的特定行： 500-1500 然后 1500-2000 并显示特定行的输出？

此代码将读取整个文件（2000 行）

```
public static String getContents(File aFile) {

        StringBuffer contents = new StringBuffer();

        try {

        BufferedReader input = new BufferedReader(new FileReader(aFile));
        try {
            String line = null; 

            while (( line = input.readLine()) != null){
            contents.append(line);
            contents.append(System.getProperty("line.separator"));
            }
        }
        finally {
            input.close();
        }
        }
            catch (IOException ex){
            ex.printStackTrace();
        }

        return contents.toString();
} 
```

如何修改上述代码以读取特定行？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-08T15:16:16.553

我建议 java.io.LineNumberReader。它扩展了 BufferedReader，您可以使用它`LineNumberReader.getLineNumber();`来获取当前行号

您还可以使用 Java 7 ，如果它更适合您，则`java.nio.file.Files.readAllLines`返回 a`List<String>`

笔记：

1) 偏爱 StringBuilder 而不是 StringBuffer，StringBuffer 只是一个遗留类

2)`contents.append(System.getProperty("line.separator"))`不好看`contents.append(File.separator)`改用

3）捕获异常似乎无关紧要，我还建议将您的代码更改为

```
public static String getContents(File aFile) throws IOException {
    BufferedReader rdr = new BufferedReader(new FileReader("aFile"));
    try {
        StringBuilder sb = new StringBuilder();
        // read your lines
        return sb.toString();
    } finally {
        rdr.close();
    }
} 
```

在我看来，现在代码看起来更干净了。如果您使用的是 Java 7，请使用 try-with-resources

```
 try (BufferedReader rdr = new BufferedReader(new FileReader("aFile"))) {
        StringBuilder sb = new StringBuilder();
        // read your lines
        return sb.toString();
    } 
```

所以最后你的代码看起来像

```
public static String[] getContents(File aFile) throws IOException {
    try (LineNumberReader rdr = new LineNumberReader(new FileReader(aFile))) {
        StringBuilder sb1 = new StringBuilder();
        StringBuilder sb2 = new StringBuilder();
        for (String line = null; (line = rdr.readLine()) != null;) {
            if (rdr.getLineNumber() >= 1500) {
                sb2.append(line).append(File.pathSeparatorChar);
            } else if (rdr.getLineNumber() > 500) {
                sb1.append(line).append(File.pathSeparatorChar);
            }
        }
        return new String[] { sb1.toString(), sb2.toString() };
    }
} 
```

请注意，它返回 2 个字符串 500-1499 和 1500-2000

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T15:16:46.053

一个更清洁的解决方案是在 apache commons 中使用 FileUtils。 [http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html) 示例片段：

```
String line = FileUtils.readLines(aFile).get(lineNumber); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-11-19T14:27:22.517

更好的方法是使用 BufferedReader。例如，如果您想阅读第 32 行：

```
for(int x = 0; x < 32; x++){
    buf.readLine();
}
lineThreeTwo = buf.readLine(); 
```

现在在 String lineThreeTwo 中，您已经存储了第 32 行。