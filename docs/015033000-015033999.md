# StackOverflow 问答 15033000-15033999

# php - 仅适用于周一至周四的 PHP 日期函数

> ID：15033001
> 
> 赞同：-2
> 
> 时间：2013-02-22T20:53:34.743
> 
> 标签：php, date

我有一个送货服务，只在周一到周四取货。我只想为用户提供下一个可用的三天作为预定取件的选项。

我的代码有效，但我想知道是否有一种更“有效”的方式来编写我想要实现的目标？

```
$numericDay=date('N');
        if ($numericDay==1) {
            echo '<option value="' . date('Ymd', strtotime('+1 days')) . '">' . date('\T\o\m\o\r\r\o\w - F j, Y', strtotime('+1 days')) . '</option>';
            echo '<option value="' . date('Ymd', strtotime('+2 days')) . '">' . date('l - F j, Y', strtotime('+2 days')) . '</option>';
            echo '<option value="' . date('Ymd', strtotime('+3 days')) . '">' . date('l - F j, Y', strtotime('+3 days')) . '</option>';
        }
        if ($numericDay==2) {
            echo '<option value="' . date('Ymd', strtotime('+1 days')) . '">' . date('\T\o\m\o\r\r\o\w - F j, Y', strtotime('+1 days')) . '</option>';
            echo '<option value="' . date('Ymd', strtotime('+2 days')) . '">' . date('l - F j, Y', strtotime('+2 days')) . '</option>';
            echo '<option value="' . date('Ymd', strtotime('next monday')) . '">' . date('l - F j, Y', strtotime('next monday')) . '</option>';
        }
        if ($numericDay==3) {           
            echo '<option value="' . date('Ymd', strtotime('+1 days')) . '">' . date('\T\o\m\o\r\r\o\w - F j, Y', strtotime('+1 days')) . '</option>';
            echo '<option value="' . date('Ymd', strtotime('+next monday')) . '">' . date('l - F j, Y', strtotime('next monday')) . '</option>';
            echo '<option value="' . date('Ymd', strtotime('next tuesday')) . '">' . date('l - F j, Y', strtotime('next tuesday')) . '</option>';
        }
        if ($numericDay>=4 and $numericDay<=7) {
            echo '<option value="' . date('Ymd', strtotime('next monday')) . '">' . date('l - F j, Y', strtotime('next monday')) . '</option>';
            echo '<option value="' . date('Ymd', strtotime('next tuesday')) . '">' . date('l - F j, Y', strtotime('next tuesday')) . '</option>';
            echo '<option value="' . date('Ymd', strtotime('next wednesday')) . '">' . date('l - F j, Y', strtotime('next wednesday')) . '</option>';
        } 
```

提前感谢您的任何见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:09:20.713

这是您需要的...

```
$dateTime = new DateTime();
$x = 0;
while ( $x < 3 ) {
    $dateTime->modify("+1 day");
    if ($dateTime->format("N") > 4)
        continue;
    printf("<option value=\"%s\">%s</option>\n", $dateTime->format("Ymd"), $dateTime->format("l - F j, Y"));
    $x ++;
} 
```

输出

```
<option value="20130225">Monday - February 25, 2013</option>
<option value="20130226">Tuesday - February 26, 2013</option>
<option value="20130227">Wednesday - February 27, 2013</option> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:16:22.620

这就是我要做的。

```
$offsets = array(
    1 => array(1, 2, 3),
    2 => array(1, 2, 6),
    3 => array(1, 5, 6),
    4 => array(4, 5, 6),
    5 => array(3, 4, 5),
    6 => array(2, 3, 4),
    7 => array(1, 2, 3)
);

$numericDay = date('N');
foreach ($offsets[$numericDay] as $offset)
{
    $dateFormat = $offset == 1 ? '\T\o\m\o\r\r\o\w - F j, Y' : 'l - F j, Y';
    echo '<option value="' . date('Ymd', strtotime('+' . $offset . ' days')) . '">' . date($dateFormat, strtotime('+' . $offset . ' days')) . '</option>';
} 
```

编辑：整理了一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:02:53.197

**创建一个while循环：**

```
$echoedDays = 0;
$dateIndex = 0
while ($echoedDays < 3) { 
```

从明天的日期开始并检查天数。如果是周一至周四 (1-4)，请回显日期并增加`$echoedDays`. 否则，只需增加`$dateIndex`并移至下一个日期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T21:08:10.270

这也可以工作：

```
 $numericDay=date('N');

    if($numericDay < 4)
        echo '<option value="' . date('Ymd', strtotime('+1 days')) . '">' . date('\T\o\m\o\r\r\o\w - F j, Y', strtotime('+1 days')) . '</option>';
    else
        echo '<option value="' . date('Ymd', strtotime('next monday')) . '">' . date('l - F j, Y', strtotime('next monday')) . '</option>';

    if($numericDay < 3)
        echo '<option value="' . date('Ymd', strtotime('+2 days')) . '">' . date('l - F j, Y', strtotime('+2 days')) . '</option>';
    else
        echo '<option value="' . date('Ymd', strtotime('next tuesday')) . '">' . date('l - F j, Y', strtotime('next tuesday')) . '</option>';

    if($numericDay < 2)
        echo '<option value="' . date('Ymd', strtotime('+3 days')) . '">' . date('l - F j, Y', strtotime('+3 days')) . '</option>';
    else
        echo '<option value="' . date('Ymd', strtotime('next wednesday')) . '">' . date('l - F j, Y', strtotime('next wednesday')) . '</option>'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T21:25:43.247

## Mod 4是你的朋友...

```
$days = Array("Mon","Tue","Wed","Thu","Fri","Sat","Sun");

for($i=1;$i<=7;$i++){
  if($i > 4){ $n = 1; } else {
    $n = $i%4+1;
  }
  $o = ($n)%4+1;
  $p = ($o)%4+1;
  echo "It's ".$days[$i-1]." and the next three available days are... ".$days[$n-1].", ".$days[$o-1]." and ".$days[$p-1]."\n";
} 
```

## 输出

```
It's Mon and the next three available days are... Tue, Wed and Thu
It's Tue and the next three available days are... Wed, Thu and Mon
It's Wed and the next three available days are... Thu, Mon and Tue
It's Thu and the next three available days are... Mon, Tue and Wed
It's Fri and the next three available days are... Mon, Tue and Wed
It's Sat and the next three available days are... Mon, Tue and Wed
It's Sun and the next three available days are... Mon, Tue and Wed 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-22T21:06:12.127

```
$store = array(
    1 => array(
        date('Ymd', strtotime('+1 days')),
        date('\T\o\m\o\r\r\o\w - F j, Y', strtotime('+1 days'))
    ),
    array(
        date('Ymd', strtotime('+2 days')),
        date('\T\o\m\o\r\r\o\w - F j, Y', strtotime('+2 days'))
    ),
    array(
        date('Ymd', strtotime('+3 days')),
        date('\T\o\m\o\r\r\o\w - F j, Y', strtotime('+3 days'))
    ),
    'm' => array(
        date('Ymd', strtotime('next monday')),
        date('l - F j, Y', strtotime('next monday'))
    ),
    't' => array(
        date('Ymd', strtotime('next tuesday')),
        date('l - F j, Y', strtotime('next tuesday'))
    ),
    'w' => array(
        date('Ymd', strtotime('next wednesday')),
        date('l - F j, Y', strtotime('next wednesday'))
    )
);

$numericDay=date('N');
if ($numericDay==1) {
    echo '<option value="' . $store[1][0] . '">' . $store[1][1] . '</option>';
    echo '<option value="' . $store[2][0] . '">' . $store[2][1] . '</option>';
    echo '<option value="' . $store[3][0] . '">' . $store[3][1] . '</option>';
}
elseif ($numericDay==2) {
    echo '<option value="' . $store[1][0] . '">' . $store[1][1] . '</option>';
    echo '<option value="' . $store[2][0] . '">' . $store[2][1] . '</option>';
    echo '<option value="' . $store['m'][0] . '">' . $store['m'][1] . '</option>';
}
elseif ($numericDay==3) {           
    echo '<option value="' . $store[1][0] . '">' . $store[1][1] . '</option>';
    echo '<option value="' . $store['m'][0] . '">' . $store['m'][1] . '</option>';
    echo '<option value="' . $store['t'][0] . '">' . $store['t'][1] . '</option>';
}
elseif ($numericDay>=4 and $numericDay<=7) {
    echo '<option value="' . $store[1][0] . '">' . $store[1][1] . '</option>';
    echo '<option value="' . $store['t'][0] . '">' . $store['t'][1] . '</option>';
    echo '<option value="' . $store['w'][0] . '">' . $store['w'][1] . '</option>';
} 
```

# import - 将数据导入 Fedora Commons

> ID：15033002
> 
> 赞同：1
> 
> 时间：2013-02-22T20:53:37.777
> 
> 标签：import, fedora-commons

我刚刚在网络服务器上设置了 Fedora Commons，现在我想将 5 GB 的 XML 文件导入其中。有没有办法做到这一点而不必通过网络界面，例如。在执行一些操作以使 Fedora Commons 可以读取文件后，我可以将文件复制到某个目录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-25T11:58:18.257

去

**fedora 主文件夹**->**客户端**-> **bin** -> **fedora-admin.sh 或 fedora-admin.bat**

运行它，它会询问你 Fedora 端口（8080）和密码（fedoraAdmin）等。

![Fedora 登录](../Images/46f0cb66775c1df610742b73660b4815.png)

转到**文件**菜单->**摄取**->**多个对象**->**从目录**

![fedora 目录导入](../Images/0e714fe2a1342fa599b5820c07fe6ca4.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T14:18:00.043

XML 数据是您要摄取的新内容，还是您从另一个 Fedora Commons 服务器导入的 FOXML 内容？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T18:24:14.573

Fedora 的 Java GUI 提供了[批量导入功能](https://wiki.duraspace.org/display/FEDORA36/Fedora+Administrator#FedoraAdministrator-IngestMultipleObjects)，您可以从命令行开始：

`$FEDORA_HOME/client/bin/fedora-admin.sh`（或者`fedora-admin.bat`如果你在 Windows 上）。

但是，您需要为要摄取的对象生成 FOXML 或 METS XML 文件，因此 XSLT 可能是合适的。

# google-api - 用于 Google 服务的 Google API

> ID：15033005
> 
> 赞同：1
> 
> 时间：2013-02-22T20:53:49.327
> 
> 标签：google-api

通常我可以使用搜索引擎找到任何东西。但这一次我似乎失败了

我想知道是否可以获得启用和禁用的服务列表，例如 GMail、Google+、YouTube 等。我知道我可以通过“组织和用户”页面上的“服务”选项卡执行此操作。但是，我想创建一个应用程序，允许我从应用程序启用和禁用服务，而不必登录到网页。

我一直在 google apis 中四处寻找，我发现唯一一个几乎存在的就是发现 api，但它没有列出核心的 google 服务，也没有办法启用或禁用这些服务。

基本上我只想知道，有没有办法做到这一点，也许在哪里看。

# testing - 测试两个数据库数据是否相同

> ID：15033006
> 
> 赞同：0
> 
> 时间：2013-02-22T20:53:54.113
> 
> 标签：testing, database-testing

对于一个测试项目，我需要测试数据库是否按要求工作；以及需要检查给定两个数据库，数据库中的数据是否相同。那么，是否有任何预定义的算法来执行此任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:01:09.517

定义什么是相同的。它是模式、数据还是两者兼而有之？如果是模式，它只是表还是所有元素，包括函数/过程/视图等。

如果您要使用 jdbc，则从模式揭示函数开始，并逐一比较和对比对象。然后对表内的数据重复相同的操作。

您可以利用 OpenSource 项目来阅读架构详细信息。

# objective-c - 解析 Graphviz 的 Dot 语言

> ID：15033011
> 
> 赞同：2
> 
> 时间：2013-02-22T20:54:15.957
> 
> 标签：objective-c, c

我在 Objective-C 或 C 中搜索点语言 ( [http://www.graphviz.org/content/dot-language](http://www.graphviz.org/content/dot-language) ) 解析器，但我找不到。有什么建议吗？

我不想画图，而是想用 Dot 语言来描述一个工作流。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T23:26:38.990

[GraphViz](http://www.graphviz.org/)是开源的，所以它的解析器是可用的......

# azure - Windows Azure 存储证书已过期

> ID：15033020
> 
> 赞同：45
> 
> 时间：2013-02-22T20:54:38.107
> 
> 标签：azure, blob, blobstorage

我们的 Azure Blob 存储证书今天已过期。这不是我们提供的证书，而是由 Microsoft 提供的，如下图所示。如何解决这个问题？我曾尝试寻找解决方案，但一无所获。我们的应用程序无法连接到存储，因为证书已过期，并且我们收到错误指示：无法为 SSL/TLS 安全通道建立信任关系

![在此处输入图像描述](../Images/32d5f182652ae84ca9f6244573c13c91.png)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-22T21:22:11.770

作为一项临时措施，我能够登录到 azure 门户并将连接字符串的协议部分从 https 更改为 http。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-22T22:34:03.947

如果您可以 RDP 进入您的角色，还有两个可能的解决方案。

1.  在 c:\Config 目录中手动更改配置。
2.  构建一个已修补的 DLL 以解决该问题，然后通过 RDP 手动上传它。解决方法可能是硬编码连接字符串，或放入代码以接受过期证书。例如：`ServicePointManager.ServerCertificateValidationCallback = delegate { return true; };`

（[在 MSDN 论坛上向 AlexNS 提供关于](http://social.msdn.microsoft.com/Forums/en-US/windowsazuredata/thread/751c85c5-b3b5-43ba-9d5b-770472ad79e1)想法 #2 的提示以及向 Jason Vallery 提供证书验证回调代码的提示）

**如评论中所述，禁用 HTTPS 和/或忽略证书验证错误可能会危及您的通信安全。因此，在您执行此操作之前请三思而后行，并在 Microsoft 解决此问题后立即将其更改回来。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T05:03:14.043

首先，我们能够通过显式使用 HTTP 端点进行存储来避开大部分问题（我们不会在那里存储任何过于敏感的内容）。

如果您处于类似情况并且可以使用 HTTP 端点，有一种解决方法可以让您[**永久**](http://blog.elasticforce.net/post/43780882113/azure-outage)升级角色。它涉及带有本地包的 Azure Powershell 部署，即使通过两个门户的升级继续失败，它似乎也能正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-25T11:57:36.723

请注意 - 如果您从 https 切换到 http，则传输机制不再确保数据正确传输，您*可能*需要检查 blob 的 MD5。

StorageClient < 2.0 有时通过上传来管理这一点，但阅读[这篇文章](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/02/18/windows-azure-blob-md5-overview.aspx)，从不下载。

对于 StorageClient 2.0，您可能需要将 BlobRequestOptions 更改为 UseTransactionalMD5（[详见此处](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/10/29/windows-azure-storage-client-library-2-0-breaking-changes-amp-migration-guide.aspx)）

# c# - WebBrowser 控件中的空白填充

> ID：15033023
> 
> 赞同：0
> 
> 时间：2013-02-22T20:55:09.137
> 
> 标签：c#, html, css, internet-explorer, webbrowser-control

我正在尝试`WebBrowser`使用以下代码控制显示图像：

```
string captcha = "<img src=\"http://www.reddit.com/captcha/{0}/.png\" border=\"0\"></img>";
webBrowser1.DocumentText = String.Format(captcha, iden); 
```

但它看起来像这样。仅查看顶部图像。左上角有空白，图像右下移动。

![在此处输入图像描述](../Images/35ce858e73f7b60af6bb8d13dfad4036.png)

我已经尝试过`border=0; padding=0; vertical-align:top;`img 和 body 标签，但没有任何效果。

有没有办法去掉那个空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:01:53.230

<html> 和 <body> 元素具有填充/边距。试试这个：

```
string captcha = "<style>html, body {{ padding: 0; margin: 0 }}</style><img src=\"http://www.reddit.com/captcha/{0}/.png\" border=\"0\"></img>";
webBrowser1.DocumentText = String.Format(captcha, iden); 
```

# matlab - Matlab - 为矩阵生成随机坐标

> ID：15033040
> 
> 赞同：1
> 
> 时间：2013-02-22T20:56:46.420
> 
> 标签：matlab, random, matrix, coordinates, permutation

我需要在预定义大小的矩阵上创建一个随机、非重复的坐标集的列表（大小为 n）。

有没有一种快速的方法可以在 Matlab 中生成它？

我最初的想法是创建一个大小为 n 的列表，其大小为（宽度 x 长度）的排列，并将它们转换回 Row 和 Col 值，但在我看来太多了。

谢了，兄弟们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:10:35.103

您可以使用`randperm`生成线性索引，并在需要时使用 将其转换为 [row,col] `ind2sub`。

```
x = rand(7,9);
n = 20;
ndx = randperm(numel(x), n);
[row,col] = ind2sub(size(x), ndx); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:09:55.593

只要`n`小于矩阵中元素的数量，这很简单：

```
% A is the matrix to be sampled
% N is the number of coordinate pairs you want
numInMat = numel(A);

% sample from 1:N without replacement
ind = randperm(numInMat, N);

% convert ind to Row,Col pairs
[r, c] = ind2sub( size(A), ind ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:11:28.907

您的想法很好，尽管您甚至不必将线性索引转换回行和列索引，但您可以将线性索引直接转换为二维数组。

```
idx = randperm(prod(size(data))) 
```

其中数据是您的矩阵。这将生成一个介于 1 和 之间的随机整数向量`prod(size(data))`，即每个元素都有一个索引。

例如

```
n = 3;
data = magic(n);
idx = randperm(prod(size(data)));
reshape(data(idx), size(data)) %this gives you your randomly indexed data matrix back 
```

# c++ - c++ sizeof 运算符如何计算大小？

> ID：15033041
> 
> 赞同：14
> 
> 时间：2013-02-22T20:56:49.270
> 
> 标签：c++, class, sizeof

我创建了一个只有 2 个公共函数（构造函数和析构函数）的类 X，并且使用`sizeof`运算符，类大小将变为 1。

当我在上面的类声明中添加一个类型的私有数据成员时`char`，大小仍然是1。最后我给它添加了一个整数类型作为类数据成员，现在大小是8字节。

请向我解释如何计算班级人数。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-22T20:59:11.793

首先，要认识到非虚函数对类的大小没有影响。

*任何*类的实例的大小至少为 1 字节，即使该类为空，这样不同的对象会有不同的地址。

添加 a`char`可确保不同的对象具有不同的地址，因此编译器不会人为地在大小上添加 1。那么大小`sizeof(char)`= 1。

然后添加一个`int`，它（可能）在您的平台上添加 4 个字节。然后编译器决定填充该类，以便出于性能/CPU 要求的原因将其对齐，并添加 3 个空字节，因此大小现在为 1 + 3 + 4 = 8。它可能会在`int`成员之前添加填充，以便它将在 4 字节边界上对齐，但除非您的 CPU 需要，否则不需要这样做。

[您可以在 Wikipedia 页面](http://en.wikipedia.org/wiki/Data_structure_alignment)上阅读有关填充的信息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-22T21:02:48.160

有许多因素决定了 C++ 中类的对象的大小。这些因素是：

1.  所有非静态数据成员的大小
2.  数据成员的顺序
3.  字节对齐或字节填充
4.  其直接基类的大小
5.  虚函数的存在（使用虚函数的动态多态性）。
6.  正在使用的编译器
7.  继承方式（虚继承）

你可以在这里找到更多[http://www.cprogramming.com/tutorial/size_of_class_object.html](http://www.cprogramming.com/tutorial/size_of_class_object.html)

# objective-c - Objective-C 类必须有一个指定的初始化器吗？

> ID：15033050
> 
> 赞同：3
> 
> 时间：2013-02-22T20:57:15.693
> 
> 标签：objective-c, initializer, designated-initializer

[我在这个Apple's docs](http://developer.apple.com/library/ios/#documentation/general/conceptual/CocoaEncyclopedia/Initialization/Initialization.html#//apple_ref/doc/uid/TP40010810-CH6)中找到了指定初始化程序的一些信息，但我不明白的是，每个类必须有***一个且只有一个***指定初始化程序吗？

例如， if `class A`has `initL, initM, initN`, while`class B`继承自`class A`and has怎么办`initX, initY, initZ`。有没有一条规则说我们不能有`initX`call `[super initL]`， and `initY`call `[super initM]`， and `initZ`call `[super initN]`？

也就是说，不是所有的“辅助初始化器”都调用指定初始化器，然后每个指定初始化器都会调用`[super initFoo]`超`initFoo`类的指定初始化器，我们不能只有3个主初始化器，每个调用者对应的超类的3个主初始化器? （也就是说，这些都继承自`NSObject`并只是调用`self = [super init]`。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T21:56:37.020

不，一个 obj-c 类可能有多个指定的初始值设定项。最常见的例子是`-initWithCoder:`vs `-init`。前者用于取消归档对象，后者用于所有其他初始化。

也就是说，在`-initWithCoder:`. 这有助于防止代码重复，并且如果要为所有初始化调用子类，则必须重写哪个方法很明显。但是，如果您有很好的理由需要 3 个不同的指定初始化程序，那么没有什么可以阻止您这样做。请务必正确记录它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:58:01.660

指定初始化器是一个有助于防止递归调用和省略重要的基类初始化的概念。有可能不遵循指定的初始化规则并仍然构建工作类层次结构。

事实上，Cocoa 中有一些模式与纯指定初始化不同：例如 NSCoding 需要使用`initWithCoder:`初始化对象，但您仍然可以使用其他初始化程序从代码中初始化对象。

# sql - sql新手试图交叉引用两个表中的数据

> ID：15033054
> 
> 赞同：2
> 
> 时间：2013-02-22T20:57:49.470
> 
> 标签：sql, oracle, cross-reference

我有两张桌子，`DATA_TABLE`和`ERROR_TABLE`。`DATA_TABLE`有一列`ID`有一个 8 位数字。有`ERROR_TABLE`一列后跟八位数字。`KEY``idkey=`

我不能使用相交，因为元组不同，我不知道如何解决它。

我需要的是找到与列中`DATA_TABLE`的值`ID`对应的列中具有值`ERROR_TABLE`的`KEY`行。

这是一个视觉效果。我需要查看其中哪些匹配并从`DATA_TABLE`

```
DATA_TABLE
  ID
  24294857
  19573859
  49205983

ERROR_TABLE
  KEY
  idkey=24294857
  idkey=66849896
  idkey=94697356 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:06:18.567

我会使用一个简单的内部连接

```
select * 
from DATA_TABLE 
inner join ERROR_COLUMN  
   on DATA_TABLE.ID = ERROR_TABLE.KEY 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:20:50.587

类似于 PM 77-1，但使用显式连接：

```
SELECT *
  FROM DATA_TABLE
  JOIN ERROR_TABLE
    ON 'idkey=' || ID = KEY; 
```

见：[http ://sqlfiddle.com/#!4/dbe73/3](http://sqlfiddle.com/#!4/dbe73/3)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T21:06:27.040

```
select dt.* 
from data_table dt 
join error_table et 
   on et.idkey = dt.id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T21:25:51.643

最好的办法是更正错误表中的数据。这些示例将仅剪切文本留下数字。您可以使用 TO_NUMBER() 函数将它们显式转换为数字以加入和比较。您已经有很多连接示例。但在加入之前，您需要将双方转换为数字，以切断数字前面的字符：

```
-- This example assumes you will always have '=' in your string --
SELECT SUBSTR('idkey=24294857', INSTR('idkey=24294857', '=')+1) digits_only 
  FROM dual
/

SELECT regexp_replace('idkey=24294857','[^0-9]') digits_only 
  FROM dual; 
/

SELECT REGEXP_SUBSTR('idkey=24294857','[[:digit:]]+') AS digits_only FROM dual
/ 
```

在此之后，您的查询将比较数字与连接中的数字，这是唯一正确的做法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T21:07:21.233

你的意思是这样的吗？

```
SELECT * FROM DATA_TABLE d, ERROR_TABLE e
WHERE ('idkey='||d.id = e.key)
ORDER BY DATA_TABLE.id 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-25T14:53:22.030

感谢大家的帮助！

我尝试了每一个建议，但没有任何工作。我对 SQL 非常熟悉，并且只了解一些命令。

最后，我从一位同事那里得到了这个***，它完成了我所需要***的。现在，我只需要了解它...

```
SELECT *
FROM DATA_TABLE
WHERE EXISTS 
        (SELECT NULL
           FROM ERROR_TABLE
          WHERE ID = SUBSTR(ERROR_TABLE.KEY,7)); 
```

# java - 在冒号后用小写罗马字拆分字符串并附加到 HTML

> ID：15033056
> 
> 赞同：1
> 
> 时间：2013-02-22T20:57:54.053
> 
> 标签：java, android, html, string, split

我正在尝试动态拆分字符串，我的字符串如下：

```
I need to call 2 numbers: (i) 1234 (ii) 4567 
```

有时我的数据也可能包含这样的内容：

```
1st type:

I need to call 2 numbers: numbers are (i) 1234 (ii) 4567 

2nd type:

I need to call my friends: numbers are as follows(only close friends) 
```

我需要像这样显示数据：

```
I need to call 2 numbers: 
(i) 1234 
(ii) 4567 
```

这意味着在冒号之后获取小罗马字母 (i) 并将其显示在下一行，然后获取 (ii) 小罗马字母并将其显示在下一行，依此类推。

现在我正在使用 regx 来检查我的字符串是否包含冒号（:)，如果它存在则获取与 regx 匹配的模式并显示。

它适用于我最初的情况，但对于我提到的 2 种类型它不起作用。

这是我的代码：

```
if(mString.contains(":")){
                     String [] parts = mString.split (":");

                     html.append("<p>"+parts [0]+"</p>");
                     Matcher m = Pattern.compile ("\\([^)]+\\)[^(]*").matcher (parts [1]);
                     while (m.find ()) {

                         html.append("<p>"+m.group ()+"<br>");
                     }
                     html.append("</br></p>"); 
```

编辑：

```
I need to call 2 numbers: 
    (i) 1234 // it can be alphabets also like abc
    (ii) 4567 // it can be alphabets also abc 
```

小罗马字母也可以是 n 像 (i),(ii),(iii) 等等

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:16:06.980

也许这段代码可以帮助你：

```
Pattern p = Pattern.compile("^.*:.*([0-9]{4}).*([0-9]{4}).*");
Matcher m = p.matcher("I need to call 2 numbers: (i) 1234 (ii) 4567");
if (m.find()) {
    System.out.println(m.group(1));
    System.out.println(m.group(2));
} 
```

无论如何，您总是可以使用子串和 indexOf，

# c# - 您将如何在 C# 中使用 dateTimePicker 编写代码来计算天数

> ID：15033060
> 
> 赞同：-5
> 
> 时间：2013-02-22T20:58:11.963
> 
> 标签：c#

我需要使用 C# 编写代码。需要通过使用 2 个`dateTimePicker`控件来实现一次天数。有人有什么想法吗？我知道如何在**vb.net**中执行此操作，但不确定如何**在 C#**中执行。

vb.net 代码：

```
NumberOfDays = DateDiff(DateInterval.Day, CDate(StartDateTimePicker.Text),
                                CDate(EndDateTimePicker.Text)) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T21:01:07.703

```
int NumberOfDays = (StartDateTimePicker.Value - EndDateTimePicker.Value).Days; 
```

或者，如果您想计算部分天数：

```
double NumberOfDays;
NumberOfDays = (StartDateTimePicker.Value - EndDateTimePicker.Value).TotalDays; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-22T21:00:45.927

```
var numberOfDays = (EndDateTimePicker.Value - StartDateTimePicker.Value).TotalDays; 
```

# c++ - 块拼图求解 C++ 算法

> ID：15033061
> 
> 赞同：1
> 
> 时间：2013-02-22T20:58:40.537
> 
> 标签：c++, performance, algorithm, dynamic, backtracking

我想制作一个算法来解决[Block Puzzles](https://play.google.com/store/apps/details?id=biz.mtoy.blockpuzzle&hl=ro)，但尽可能高效。我已经做了简单的方法（回溯）。

我将所有内容都表示为矩阵 - 碎片必须适合的大矩阵在开始时全部为 0，如果空间已满，则碎片为 1，如果空间为空，则为 0。现在，下一个可能更有效的想法是在转到下一行之前始终验证一行是否完整。我的意思是我可能有一块表示为 （十字架）。如果十字架被放在角落里，程序将无用地为无效的解决方案进行整个回溯，因此它应该返回并尝试另一件。
`0 1 0
1 1 1
0 1 0`

如果有必要，我可以提供一段代码，正如我所说，我只做了简单的低效回溯。
有没有人有更好的想法？在这种情况下可以使用动态规划吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:31:14.360

把问题想象成一个图：节点是可以排列块的各种状态，边是从一个节点到另一个节点的可能移动。那么解就是当前位置到目标的最短距离，可以使用 Dijkstra 算法计算。

# java - 一个简单的java游戏出错

> ID：15033062
> 
> 赞同：-1
> 
> 时间：2013-02-22T20:58:41.940
> 
> 标签：java, swing

我正在做一个鼹鼠游戏。你知道，有一个带有痣图片的按钮，如果你点击带有痣的按钮，你会得到积分。我还没有完成它，我只是想让第一个按钮可见，但是`java.lang.reflect.invocationtargetexception`当我尝试执行时出现错误。任何想法都将受到高度赞赏。

```
import java.awt.event.*;    
import java.awt.*;
import java.applet.*;
import javax.swing.*;

public class topos extends JApplet implements ActionListener{
       JLabel puntaje;
       JButton topo;
       Container c;
       int contador=0;

public topos(){
    Frame f = new Frame ("El famoso juego de los topos");
    f.add("center", this);
    f.setSize (900,300);
    f.setVisible(true);
    }
public void init(){
    c = getContentPane();
    topo = new JButton (new ImageIcon("topo.jpg"));
    puntaje = new JLabel("0");
    topo.addActionListener(this);
    c.add("center",topo);
}
public void actionPerformed(ActionEvent e){
    JButton b = (JButton)e.getSource();
    try {
        if (b == topo){
        contador = contador + 1;
        puntaje.setText(" " + contador );
        }

    }
    catch (Exception f){
        f.printStackTrace();
    }
    }

public static void main (String s[]){
    topos t = new topos();
    t.init();
    t.start();  

}

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T04:22:30.577

此代码解决了两个直接问题（`Frame`和`JApplet`出现），但没有纠正***许多***其他问题。

```
import java.awt.event.*;
import java.awt.*;
import java.applet.*;
import javax.swing.*;

public class topos extends JApplet implements ActionListener{
    JLabel puntaje;
    JButton topo;
    Container c;
    int contador=0;

    public topos(){
        Frame f = new Frame ("El famoso juego de los topos");
        f.add(this, BorderLayout.CENTER);
        f.setSize (900,300);
        f.setVisible(true);
    }

    public void init(){
        c = getContentPane();
        topo = new JButton (new ImageIcon("topo.jpg"));
        puntaje = new JLabel("0");
        topo.addActionListener(this);
        c.add(topo, BorderLayout.CENTER);
    }

    public void actionPerformed(ActionEvent e){
        JButton b = (JButton)e.getSource();
        try {
            if (b == topo){
                contador = contador + 1;
                puntaje.setText(" " + contador );
            }
        }
        catch (Exception f){
            f.printStackTrace();
        }
    }

    public static void main (String s[]){
        topos t = new topos();
        t.init();
        t.start();
    }
} 
```

## 更新

此代码更正了源代码中的许多其他问题。

1.  它允许代码通过在面板中创建 GUI（然后添加到其中一个）作为小程序或应用程序运行。这通常称为混合应用程序/小程序。
2.  这段代码没有尝试设置框架的大小（不考虑框架装饰），而是设置了游戏本身的首选大小。小程序将在 HTML 中指定宽度/高度。
3.  它专门使用基于 Swing 的组件。

* * *

```
import java.awt.event.*;
import java.awt.FlowLayout;
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.Color;
import java.applet.*;
import javax.swing.*;

public class topos extends JApplet {

    public void init(){
        getContentPane().add(new WhackAMoleGUI(), BorderLayout.CENTER);
    }

    public static void main (String s[]){
        JFrame f = new JFrame ("El famoso juego de los topos");
        f.add( new WhackAMoleGUI(), BorderLayout.CENTER );
        f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        f.pack();
        f.setLocationByPlatform(true);
        f.setVisible(true);
    }
}

class WhackAMoleGUI extends JPanel implements ActionListener {

    final Dimension preferredSize = new Dimension(400, 200);
    JLabel puntaje;
    JButton topo;
    int contador=0;

    WhackAMoleGUI() {
        setLayout(new FlowLayout());
        topo = new JButton (new ImageIcon("topo.jpg"));
        add(topo);
        puntaje = new JLabel("0");
        add(puntaje);
        topo.addActionListener(this);
        setBackground(Color.YELLOW);
    }

    @Override
    public Dimension getPreferredSize() {
        return preferredSize;
    }

    public void actionPerformed(ActionEvent e){
        JButton b = (JButton)e.getSource();
        try {
            if (b == topo){
                contador = contador + 1;
                puntaje.setText(" " + contador );
            }
        }
        catch (Exception f){
            f.printStackTrace();
        }
    }
} 
```

# android - AWS S3 Java SDK：以编程方式检测时间/时钟偏差？

> ID：15033064
> 
> 赞同：3
> 
> 时间：2013-02-22T20:58:50.733
> 
> 标签：android, amazon-web-services, amazon-s3

我的 Android 应用程序使用 AWS Java SDK 将用户照片上传到 S3。

每当用户手机的时钟“倾斜”时，都会导致所有传输失败。这是 S3 的一个有据可查的方面：

[http://aws.amazon.com/articles/1109?_encoding=UTF8&jiveRedirect=1#04](http://aws.amazon.com/articles/1109?_encoding=UTF8&jiveRedirect=1#04)

上游 S3 服务似乎很清楚地报告了这个错误：

> HTTP 状态码：403 禁止
> 
> 错误代码：RequestTimeToo-Skewed
> 
> 说明：请求时间与服务端时间相差过大。

但是，在使用 Java SDK 时，似乎信息丰富的 403 代码丢失了......而且我只有一个不透明的“TransferState.Failed”可以通过（顺便说一下，如果互联网连接丢失，这也是同样的错误，如果它时间出等...）。

据我从文档中可以看出：

[http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/index.html](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/index.html) [http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/TransferProgress .html](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/TransferProgress.html) [http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/Transfer.TransferState.html](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/Transfer.TransferState.html) [http://docs.aws.amazon.com/AWSJavaSDK/latest /javadoc/com/amazonaws/services/s3/transfer/Upload.html](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/Upload.html)

无法获取有关传输失败的附加“RequestTimeToo-Skewed”元数据。

我错过了吗？当使用 Amazon 的 Java SDK 进行 S3 传输失败时，是否有任何方法可以获取额外的错误信息？

**更新＃1：** 一位评论者亲切地强调我应该澄清两点：

*   我实际上正在使用适用于 Android 的 AWS 开发工具包（它看起来与 Java 开发工具包非常相似，但仍然不同）
*   我正在使用 TransferManager 类来执行我的上传。显然，这是一个包装了较低级别 AmazonS3Client 的高级类......并且这个较低级别的类应该公开我需要的错误报告，但我仍在调查 TransferManager 和 AmazonS3Client 之间所涉及的确切权衡。据我所知，没有办法通过（同步）AmazonS3Client.putObjectRequest 获取进度信息，这对我来说是一个障碍......

**更新 #2：** 我衷心感谢 Jason（AWS SDK 团队的）在这里停下来帮助我。如果您使用某些方法，重要的信息确实可以作为 AmazonS3Exception 上的属性使用。文档最初让我感到困惑，我认为需要手动 Thread.sleep() 循环来轮询状态（因此我无法利用 waitForCompletion 或 waitForException），但如果您在 PutObjectRequest 上使用 ProgressListener，您可以获得完整的进度回调和AmazonS3Exception 的错误保真度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T01:09:40.990

这两种方法应该可以帮助您：

*   [Transfer.waitForCompletion()](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/Transfer.html#waitForCompletion())
*   [Transfer.waitForException()](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/Transfer.html#waitForException())

如果您根据传输进度事件检测到您的传输失败，您可以简单地调用 Transfer.waitForException() 以返回发生的异常。在这种情况下，该异常将是 AmazonServiceException，其中包含您需要查看的所有信息，以了解真正的问题是时钟偏差问题。

或者，该`Transfer.waitForCompletion()`方法将从 ExecutionException 中解开原始异常并直接抛出原始异常，就好像这一切都发生在一个线程上一样。如果您想使用 catch 块干净、优雅地捕获不同类型的错误，这可能是一种更方便的方法。

我不同意“catch Exception”块“非常广泛”。该代码的重点是捕获发生的任何错误，将传输标记为失败并重新抛出错误，以便应用程序代码知道它。如果它不那么广泛，那么**这**正是异常可能潜入并且传输进度不会正确更新并且与现实不同步的情况。

给出这两种方法并拍摄，如果有帮助，请告诉我们！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T00:13:15.413

好吧，我已经调试了亚马逊的 SDK，我很遗憾地说这些信息正在被内部吞噬。也许我会尝试提交一个补丁。

详细信息：内部抛出了一个 AmazonS3Exception，它实际上准确地报告了这个确切的错误场景，但是一个粗暴的 try catch (Exception e) 消耗了它并洗掉了特殊性。

这是有罪的尝试捕获：

[https://github.com/aws/aws-sdk-java/blob/master/src/main/java/com/amazonaws/services/s3/transfer/internal/UploadMonitor.java#L145](https://github.com/aws/aws-sdk-java/blob/master/src/main/java/com/amazonaws/services/s3/transfer/internal/UploadMonitor.java#L145)

这是一个屏幕截图，显示 AmazonS3Exception 使用正确的信息正确抛出......

![调试截图](../Images/cd5dc9ce064e28debdd61f9f47ce34db.png)

# java - 为什么我的多 jar 应用程序似乎没有注意到包含一类唯一字段的 JAR 中的更改？

> ID：15033067
> 
> 赞同：3
> 
> 时间：2013-02-22T20:59:08.580
> 
> 标签：java, jar, jvm

我有一个具有一个可执行 JAR 的应用程序，它使用其他 JAR 库。当我更新一个库 JAR 时，用户关闭他们的程序并再次打开它，并使用新的 JARS。但是，我有一个只包含一个类的 JAR，它只包含字段。当这个 JAR 被自己替换时，旧 JAR 的字段中的值似乎在程序中使用。

此时旧的 JAR 从文件系统中消失了，所以我对这些值的来源有点困惑。我当前的解决方案是更新另一个使用有问题的 JAR 的 JAR，但我不确定为什么会这样，所以我正在寻找任何可用的见解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T21:06:40.510

java代码中的常量可以被编译器内联。例子：

```
public class A {
    public static final String STR = "foo";
}

public class B {
    public static void main(final String... args) {
        System.out.println(A.STR);
    }
} 
```

如果将 STR 更改为“bar”并重新编译 A，B 在运行时仍会打印“foo”。解决方案是还重新编译和更新使用常量的代码。

另请参阅[是否所有编译时常量都内联？](https://stackoverflow.com/questions/377819/are-all-compile-time-constants-inlined)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:11:24.453

这些静态字段的值可能会在程序关闭后保存在 RAM 中。如果您重命名包含这些字段的包或类，我敢打赌，当您修改值并重新启动时，它会起作用。这不是一个好的解决方案，只是稍微确认一下这些值正在被缓存。我建议你不要有一个只有字段值的类。如果您想将这些值与代码的其余部分分开，那么如果这些字段很容易表示为字符串，则可以使用属性文件。您也可以将它们设为其他类中的字段。

# php - Laravel mssql 驱动支持

> ID：15033069
> 
> 赞同：3
> 
> 时间：2013-02-22T20:59:23.947
> 
> 标签：php, sql-server, laravel

我一直在为 Laravel 框架搜索 mssql 驱动程序，但到目前为止还没有运气。我知道 Laravel 对 sql 服务器有 sqlsrv 支持，但我需要的是 mssql 连接器（具有以“mssql_”开头的功能的连接器）。

我们不能使用 sqlsrv，因为我们的大多数服务器都是 MSSQL 2000，据我所知 sqlsrv 不提供对这些服务器的支持。此外，MS 不为 linux 提供 sqlsrv 驱动程序。（我们在 Fedora 17 64 位上使用 freetds 驱动程序和手动编译的 php 5.4.8）。

**我的问题是**

1.  Laravel 中是否有任何支持 mssql 的补丁？
2.  如果没有，如果可能的话，我应该创建/修改哪些文件以支持 mssql？

我也可以使用支持 mssql 的不同框架，但我真的很喜欢 Laravel 处理所有事情的方式。我不想因为 Laravel 不支持 mssql 而放弃它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:08:31.453

它似乎不包括该驱动程序...我相信您可以在 laravel/database/connectors 进行设置

# ajax - 同一视图中的 2 个 AJAX 调用 (CakePHP 2.3)

> ID：15033070
> 
> 赞同：0
> 
> 时间：2013-02-22T20:59:32.377
> 
> 标签：ajax, cakephp

我在 CakePHP 中遇到 AJAX 问题。我在一个视图中有 2 种不同的 AJAX 表单。第一个 AJAX 表单运行良好，但另一个无法正常运行。当我调用第二个 AJAX 时，它不会将此表单中的数据设置为`$this->request->data`，但 AJAX 会正常运行。之后，它将更新`<div id="about"></div>`. 奇怪的是，在 div 更新后，我尝试再次通过此表单发送数据，它可以工作，它会更新我在数据库中的数据。此外，当我在视图中只有第二个 AJAX 时，它会正常工作并在我第一次通过它发送数据时发送数据。

这是我的代码：

这是一个视图文件：

```
<div id="price-list">
    <?php echo $user['User']['price_list']; ?>
</div>

<?php
    echo $this->Form->create('User');
    echo $this->Form->input('User.price_list', array('label' => false));
    echo $this->Js->submit('Save', array(
        'url' => array('controller' => 'users', 'action' => 'ajax_edit_price_list'),
        'update' => '#price-list',
        'buffer' => false,
    ));
?>

<div id="about">
    <?php echo $user['User']['about']; ?>
</div>

<?php
    echo $this->Form->create('User');
    echo $this->Form->input('User.about', array('label' => false));
    echo $this->Js->submit('Save', array(
        'url' => array('controller' => 'users', 'action' => 'ajax_edit_about'),
        'update' => '#about',
        'buffer' => false,
    ));
?> 
```

我之前还附加`<?php echo $this->Js->writeBuffer(); ?>`了我的 default.ctp `</body>`。

你有什么想法，哪里有问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T06:08:47.853

我无法重现您的确切问题，但我想我知道问题所在。您的第二个表单是在第一个表单内创建的。您需要添加`echo $this->Form->end();`到两个表格的末尾。

此外，表单正在使用相同的 ID 创建。虽然这不是导致问题的原因，但它仍然不好。我建议你听从 thaJeztah 的建议，在里面手动指定一个 ID `$this->Form->create()`。

# jquery - jQuery Validation 在验证范围输入时失败

> ID：15033073
> 
> 赞同：0
> 
> 时间：2013-02-22T20:59:50.797
> 
> 标签：jquery, jquery-validate, jquery-tools

我正在使用这个滑块：

> [http://jquerytools.org/documentation/rangeinput/index.html](http://jquerytools.org/documentation/rangeinput/index.html)

它生成的代码如下所示：

```
<input id="AddedValue" max="100000" min="0" name="AddedValue" type="text" data-orig-type="range" value="0" class="range"> 
```

现在，当我使用此滑块并将其设置为**任何**值时，它会显示`the value needs to be less or equal 100000`. 我怎样才能解决这个问题？或者有什么方法可以让我禁用这个单一输入的验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:32:00.690

您的问题是由您添加到输入中的`min`和属性引起的。`max`jQuery Validate 插件采用这些并认为它们是您的规则。在这种情况下，即使`ignore`选项被“忽略”......它仍然认为这些是有效的规则。

```
<input id="AddedValue" max="100000" min="0" name="AddedValue" type="text" data-orig-type="range" value="0" class="range"> 
```

> OP：“或者有什么方法可以让我禁用对这个单一输入的验证？”

在您显示更多代码之前，简单的解决方案是从该元素中删除`min`and属性。`max`也许您的输入滑块允许您以另一种方式定义最小值和最大值。虽然，因为它是 jQueryTools 包的一部分，我不希望任何东西遵循正常的约定。

**编辑：**

似乎存在冲突，在我对 jsFiddle 的简短测试中，我会说这是由 jQueryTools 引起的。最合乎逻辑的解决方案是`attributes`从输入元素中删除这些内联，并使用 jQuery 独立声明每个插件的选项......

```
$(document).ready(function() {

    $('#myform').validate({  // jQuery Validate setup
        // other options,
        rules: {
            AddedValue: {
                min: 0,
                max: 100000
            }
        }
    });

    $('#AddedValue').rangeinput({  // jQueryTools Rangeinput setup
        // other options,
        min: 0,
        max: 100000
    });

}); 
```

坦率地说，如果 jQueryTools 不能与其他 jQuery 插件配合得很好，我会把它扔给别的东西。（*如果您进一步深入研究，您会发现 jQueryTools 自 jQuery 1.3 以来只有一次更新，并且几乎没有开发人员。浏览他们的用户论坛和 Github 站点，您会发现 Tero 几乎没有兴趣在支持他的创作，并且在过去 18 个月左右的时间里，一直找不到任何人来接任。*）

# node.js - ExpressJS 和 MongooseJS：我可以在子文档中查询数组值吗？

> ID：15033077
> 
> 赞同：1
> 
> 时间：2013-02-22T21:00:01.410
> 
> 标签：node.js, mongodb, express, mongoose

我有一个使用 expressjs 和 mongoosejs 编写的 web api。

应用程序中的主架构包含一个子文档`permissions`，其中包含数组字段。这些数组包含可以对该文档执行操作的用户的 ID。

我试图通过`read`子文档数组字段中的值来限制对该集合的查询结果：

这是主要架构：

```
var MainSchema = new Schema({
    uri: { type: String, required: false },
    user: { type: String, required: false },
    groups: [String],           
    tags: [String],
    permissions: {
        read: [String],
        update: [String],
        delete: [String]
    }
}); 
```

我想返回在数组中具有特定值`permissions.read`或该数组为空的文档。

我的代码不会抛出错误，但不会限制结果；我仍然得到与给定值不匹配且不为空的文档。

这是我所拥有的：

```
var MainModel = mongoose.model('MainSchema', MainSchema);

app.get('/api/search', function (req, res) {
    var query = MainModel.find({'uri': req.query.uri }); 

    // This works fine
    if (req.query.groups) {
        query.where('groups').in(req.query.groups);
    }
    else if (req.query.user) {
        query.where('user').equals(req.query.user);
    }

    // How can I return only documents that match req.query.user or ""?
    query.where('permissions.read').in([req.query.user, ""]);

    query.exec(function (err, results) {
      if (!err) {
        return res.send(results);
      } else {
        return console.log(err);
      }
    });
}); 
```

我有一种预感，该`where`子句没有`permissions.read`针对传递给该`in`子句的数组的每个值测试每个元素的值。

谢谢。

**编辑**：这是一个不应返回的文档，但它是（注意，permissions.read 数组包含一个不是当前用户 ID 的值）：

```
{
    "user": "firstname@gmail.com",
    "uri": "http://localhost:3000/documents/test",
    "permissions": {
      "delete": [
        "firstname@gmail.com"
      ],
      "update": [
        "firstname@gmail.com"
      ],
      "read": [
        "firstname@gmail.com"
      ]
    },
    "tags": [],
    "groups": [
      "demo",
      "2013"
    ]
} 
```

**已编辑**：更正了模型/架构混淆，这不在我的代码中，但在复制/粘贴中被遗漏了。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T21:19:24.230

我已经寻找但没有找到一个 mongodb/mongoose 查询的示例，该查询测试子文档数组字段中的指定值或空数组字段。

相反，由于我同时控制 API（此代码来自该 API）和客户端应用程序，因此我进行了重构。

`where`我现在根据客户端用户选择将三个子句之一添加到查询中：

```
if (req.query.mode === 'user') {
    query.where('user').equals(req.query.user);
}
else if (req.query.mode === 'group') {
    query.where('groups').in(req.query.groups);
    query.$where('this.permissions.read.length === 0');
}
else if (req.query.mode === 'class') {
    query.$where('this.permissions.read.length === 0');
} 
```

感谢您的意见，@JohnnyHK。

# mysql - 使用 MySQL 使用 LEFT JOIN、变量和自动增量更新查询

> ID：15033079
> 
> 赞同：1
> 
> 时间：2013-02-22T21:00:17.587
> 
> 标签：mysql, left-join, auto-increment

我陷入了困境。这是表结构。

默认类别

```
category_id | parent_id |   name                | symbol 
-----------------------------------------------------------
    1       |   1       |   SMT Equipment       |   SMT
    2       |   1       |   ATE & INSPECTION    |   ATE
    3       |   1       |   Feeders             |   FED
    4       |   1       |   Rework Station      |   RWS
    5       |   1       |   X-Ray Machines      |   XRM 
```

default_products

```
id  | subcategory_id | product_name | product_code
---------------------------------------------------
1   |   1           |   A           |   null
2   |   1           |   B           |   null
3   |   2           |   C           |   null
4   |   2           |   D           |   null
5   |   1           |   E           |   null
6   |   3           |   F           |   null
7   |   4           |   G           |   null
8   |   1           |   H           |   null
9   |   2           |   I           |   null 
```

default_products_code

```
id  | category_id | code    
-------------------------
1   |       1     | 1   
2   |       2     | 1       
3   |       3     | 1   
4   |       4     | 1       
5   |       5     | 1 
```

现在这里是细节

每当创建类别时，我都会在 default_products_code 中输入一个条目并提供 code = 1 作为默认值。现在，每当插入产品时，我都会从 default_products_code 中获取代码，并从 default_category 中获取符号，并制作这样的代码，例如产品 A 的代码是 SMT0001，然后我将 default_products_code 中的代码更新为 2，因为在 product_code 中分配了 1 . 这就是我目前的系统。但是现在问题来了，我的数据库中有数百种产品，我必须使用我解释的上述标准更新新添加的列。

这是我尝试使用自动增量的查询

```
SET @var := 1;
UPDATE default_products AS dp
LEFT JOIN(
            SELECT 
                dc.category_id,
                CONCAT(symbol, LPAD(@var,5,'0')) AS `code`,
                @var := @var+1
            FROM default_products AS dp
            LEFT JOIN default_category AS dc ON dc.category_id = dp.subcategory_id
            WHERE subcategory_id = 1
        ) AS l ON l.category_id = dp.subcategory_id 
SET part_code = l.code
WHERE subcategory_id = 1; 
```

它产生这个结果

```
id  | subcategory_id | product_name | product_code
---------------------------------------------------
1   |   1           |   A           |   SMT00001
2   |   1           |   B           |   SMT00001
5   |   1           |   E           |   SMT00001
8   |   1           |   H           |   SMT00001 
```

虽然我需要这个

```
id  | subcategory_id | product_name | product_code
---------------------------------------------------
1   |   1           |   A           |   SMT00001
2   |   1           |   B           |   SMT00002
5   |   1           |   E           |   SMT00003
8   |   1           |   H           |   SMT00004 
```

另一件事我需要更新表中的所有产品。如何在单个查询中执行此操作。我知道在这种情况下我需要删除 WHERE subcategory_id = 1 但我无法继续。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:13:33.027

你的问题是`LPAD`

[LPAD](http://www.w3resource.com/mysql/string-functions/mysql-lpad-function.php)是这样定义的

```
 LPAD(str, len, padstr) 
```

在您的查询中，您应该这样使用

```
 LPAD(id, 5, 0) 
```

在您的查询中`LPAD(@var,5,'0')`，它将始终返回 00001 原样`@var`1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:37:37.507

好吧，经过一些修改，我发现了如何做到这一点。

```
SET @var := 0;
UPDATE default_products AS dp
LEFT JOIN(
        SELECT 
        dc.category_id,
        dc.symbol
        FROM default_products AS dp
        LEFT JOIN default_category AS dc ON dc.category_id = dp.subcategory_id
        WHERE subcategory_id = 16
        group by dp.id            
    ) AS l ON l.category_id = dp.subcategory_id 
SET part_code = CONCAT(l.symbol, LPAD(@var := @var+1,5,'0'))
WHERE subcategory_id = 16; 
```

我已经完成了代码创建，它完全按照我的需要工作。我仍然想在删除 where 条件的情况下更新它，以便我可以更新所有产品。

# c# - 如何在不等待的情况下在单例中执行昂贵的操作？

> ID：15033089
> 
> 赞同：2
> 
> 时间：2013-02-22T21:01:38.950
> 
> 标签：c#, .net, singleton, lazy-loading

我创建了一个单例模式类，其中包含一些填充起来非常昂贵的实例变量（字典）。

此类用于 .NET MVC 4 项目。他们的关键是这个 Singleton 类中的字典提供的数据**很好**，但不是运行 Web 应用程序所必需的。

换句话说，当我们处理一个 Web 请求时，如果字典中的信息可用，该请求将得到增强，但如果它不可用，那也没关系。

所以我想做的是找到将数据加载到 Singleton 中的这些字典的最佳方法，而不会因为它们充满数据而阻塞 Web 活动。

我通常会找到一种使用多线程的方法，但在过去，我阅读并遇到了在 ASP.NET 中使用多线程技术的问题。.NET 4 / MVC 4 有变化吗？我应该如何处理这个？

**更新**

根据下面的反馈和[更多的研究](http://geekswithblogs.net/BlackRabbitCoder/archive/2010/05/19/c-system.lazylttgt-and-the-singleton-design-pattern.aspx)，我现在正在做的事情如下，它似乎工作正常。有没有人看到任何潜在的问题？在我的测试中，无论我调用多少次 LazySingleton.Instance，构造函数只会被调用一次，并立即返回。我可以立即访问 LazySingleton.EXPENSIVE_CACHE，尽管它可能不包含我正在寻找的值（我在我的应用程序中使用`.Contains()`调用对其进行测试）。所以它似乎正在工作......

如果我只从单个线程（LazySingleton 构造函数）编辑 EXPENSIVE_CACHE 字典，在我的 Web 应用程序中读取它时是否需要担心线程安全？

```
public class LazySingleton
{
    public ConcurrentDictionary<string, string> EXPENSIVE_CACHE = new ConcurrentDictionary<string, string>(1, 80000); // writing to cache in only one thread
    private static readonly Lazy<LazySingleton> instance = new Lazy<LazySingleton>(() => new LazySingleton());

    private LazySingleton()
    {
        Task.Factory.StartNew(() => expensiveLoad());
    }

    public static LazySingleton Instance
    {
        get
        {
            return instance.Value;
        }
    }

    private void expensiveLoad()
    {
        // load data into EXPENSIVE_CACHE
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T21:59:18.833

您可以填写您的现金储备库

1.  应用程序_启动
2.  会话开始

您的 Web 应用程序事件。
像这样的东西

```
<%@ Application Language="C#" %>
<script runat="server">
    void Application_Start(object sender, EventArgs e) 
    {
        SingletonCache.LoadStaticCache();
    }
</script> 
```

[这](http://www.asp.net/web-forms/tutorials/data-access/caching-data/caching-data-at-application-startup-cs)可能有用吗

# javascript - JQuery 选择器按值选择下拉列表

> ID：15033092
> 
> 赞同：0
> 
> 时间：2013-02-22T21:01:44.147
> 
> 标签：javascript, jquery, html

我有一组是/否下拉菜单，我想选择所有值为是的选择元素。

```
<select name="foo1">
  <option value="yes">Yes</option>
  <option value="no">No</option>
</select>
<select name="foo2">
  <option value="yes">Yes</option>
  <option value="no">No</option>
</select>
<select name="foo3">
  <option value="yes">Yes</option>
  <option value="no">No</option>
</select> 
```

我想要一个 JQuery 选择器，它返回当前处于“是”状态的选择节点的子集。我意识到我可以对 filter() 进行简单的调用，但我更愿意在选择器中完成所有操作。

```
$('#myform select').filter(function(k,v){return v.value == 'yes';}) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:05:05.930

```
$('#myform select option[value="yes"]:selected').parent() 
```

[看演示](http://jsfiddle.net/RqPTC/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:11:21.857

it would be

```
$('#form select:has(option[value=yes]:selected)') 
```

It will get all select that has option:selected with a value=yes

[FIDDLE](http://jsfiddle.net/FDmDS/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T21:06:35.310

如果您希望它高效，您应该坚持使用`filter`，但您可以创建一个可以直接在选择器中使用的自定义过滤器：

```
$.expr[':'].value = $.expr.createPseudo(function (value) {
    return function (el) {
        return el.value == value;
    };
}); 
```

按如下方式使用它：

```
$('select:value(yes)'); 
```

这是小提琴：http: [//jsfiddle.net/Eb3hp/](http://jsfiddle.net/Eb3hp/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T21:03:08.987

```
$('#myform select[value=yes]'); 
```

# asp.net-mvc-3 - 使用 Ajax.ActionLink() 在 IIS 中部署后不会触发操作方法

> ID：15033098
> 
> 赞同：1
> 
> 时间：2013-02-22T21:02:09.323
> 
> 标签：asp.net-mvc-3, routing, actionresult

我有一个默认路由如下：

public static void RegisterRoutes(RouteCollection routes) { routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

```
 routes.MapRoute(
            "Default",                                              // Route name
            "{controller}/{action}/{id}",                           // URL with parameters
            new { controller = "Home", action = "Index", id = "URLParameter.Optional" }  // Parameter defaults
        );

    } 
```

我的索引操作方法正在返回要查看的模型列表。在索引视图中，我有这样的东西：

```
@Html.ActionLink(article.Title,"Download",new { id = "C:\\Files\file1.txt"},null); 
```

但是，在 IIS 中部署之后，“下载”操作方法没有被触发并且得到 404 PAGE NOT FOUND 错误。

如果我在 Html.ActionLink 中将操作方法​​指定为“索引”，那么它的工作方式如下：

> @Html.ActionLink(article.Title,"Index",new { id = "C:\Files\file1.txt"},null);

上面的代码正在工作，因为它在 IIS 中部署后采用默认路由。我试图更改 Global.asax 中的路线，但未能得到解决方案。

我在这里需要的是，我希望触发第二种操作方法，但事实并非如此。

我的第一个行动方法是：

```
 public ActionResult Index() {} 
```

我的第二个行动方法是：

```
 public ActionResult Download(string loc) {}    //This is not getting fired..??? 
```

如果需要，将为您提供更多详细信息。请协助，因为它会影响我的交付。

# cocos2d-iphone - cocos2d不能改变ccnode的不透明度

> ID：15033099
> 
> 赞同：1
> 
> 时间：2013-02-22T21:02:13.157
> 
> 标签：cocos2d-iphone

我发现 setopacity 功能不适用于我们的一款 cocos2d 游戏，它使用的是 cocos2d 1.0.1。无论我设置什么值，所有 ccnode 的不透明度始终为 255，并且淡入/淡出操作也不起作用。我们还有另一款使用相同版本 cocos2d 的游戏，但它运行良好。有没有人知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T17:44:52.773

CCNodes 实际上没有纹理（图像），因此它们没有 opacity 属性。我假设您认为设置 CCNode 的不透明度会影响其子节点，但它不会。不透明度仅影响您为其设置不透明度的对象的纹理。您可以设置 CCSprite 的不透明度，因为它具有纹理，但这样做不会影响 CCSprite 的子项。如果要影响多个 CCSprite 的不透明度，则必须遍历所有子项，并为每个子项设置不透明度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-13T09:39:48.897

Basic DrawNode 本身也无法处理不透明度（此功能在 cocos2d-4.* 的计划中）。

`Node`您可以从或继承您的类`DrawNode`并`setOpacity`像这样实现：

```
void AlphaNode::setOpacity(GLubyte opac) {
mOpacity = opac;
if (_bufferCount) {
    for (int i = 0; i < _bufferCount; i++) {
        _buffer[i].colors.a = mOpacity;
    }
}

if (_bufferCountGLPoint) {
    for (int i = 0; i < _bufferCountGLPoint; i++) {
        _bufferGLPoint[i].colors.a = mOpacity;
    }
}

if (_bufferCountGLLine) {
    for (int i = 0; i < _bufferCountGLLine; i++) {
        _bufferGLLine[i].colors.a = mOpacity;
    }
    _dirtyGLLine = true;
}
_dirty = true;
} 
```

我认为您可以为`Node`.

# sharepoint-2010 - 将凭据从 SSRS 传递到 Sharepoint 数据源时出错

> ID：15033100
> 
> 赞同：3
> 
> 时间：2013-02-22T21:02:13.243
> 
> 标签：sharepoint-2010, reporting-services, ssrs-2008

我正在使用 SSRS 2008 R2 构建一个使用 Sharepoint 列表作为其数据源的报告，它被配置为使用 Windows 身份验证（集成安全性）连接到该列表。问题是当报表部署到报表服务器时，SharePoint 源拒绝凭据，返回：

```
An error has occurred during report processing. (rsProcessingAborted) 

Query execution failed for dataset 'ListDataset'. (rsErrorExecutingCommand) 

An error occurred when accessing the specified SharePoint list. The connection string 
might not be valid. Verify that the connection string is correct. (rsSPDataProviderError)

The request failed with HTTP status 401: Unauthorized. 
```

当我在 BIDS 中本地测试报表时，Sharepoint 数据源接受我的凭据，但在它们从报表服务器“双跳”后不接受它们。最好的解决方法是什么？我是否需要在 SSRS 中创建服务帐户，在 SSRS 的数据源中提供这些凭据，并通过 Sharepoint 向服务帐户授予必要的读取权限？任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-25T00:02:41.653

这是对[类似问题](https://stackoverflow.com/questions/14780220/sharepoint-list-data-source-giving-http-401-unauthorized-error)的相同答案：

我通常创建一个名为 Reportuser 的用户（例如 reportuser@[domain].com）。在您的域上创建此用户，确保它有权访问 SharePoint。

在报表数据源属性中的 BIDS/visual studio 中，在凭据选项卡下，单击“使用 Windows 身份验证（集成安全性）”旁边的单选按钮。将数据源上传到报表管理器网站。（你已经完成了这部分）。

导航到报告管理器网站，以及已上传数据源的属性。

在以“连接使用”开头的部分下：

选中“安全存储在报表服务器中的凭据”选项

像这样输入用户名和密码（其中域替换为您的网络域）：reportuser@domain.com 密码

重要部分：勾选“连接到数据源时用作 Windows 凭据”

测试连接并将工作 - 我刚刚测试过它。

# jsf - 我将 Primefaces 3.4.2 与 JSF 2.0 一起使用 我在 JSF 页面的对话框弹出窗口中有以下内容。 <p:dialog 0="" 1632="" header="Create New Request" style="font-weight:bold" 问问题="" 2013-02-22t21:02:15.740="" 次="" this="" question="" shows="" research="" effort;="" it="" is="" useful="" and="" clear="" does="" not="" show="" any="" unclear="" or="" bookmark="" question.="" activity="" on="" post.="" 我将="" primefaces="" 3.4.2="" 与="" jsf="" 2.0="" 一起使用="" 我在="" 页面的对话框弹出窗口中有以下内容。="" <p:dialog="" widgetvar="newDialog" resizable="false" id="newDlg" showeffect="fade" hideeffect="fade" appendtobody="true" modal="true" position="center top" width="850" height="450"><p:panelgrid columns="2"><h:outputlabel value="Employee" for="employee"><p:selectonemenu id="employee" value="#{mymb.employee}" converter="#{employeeConverter}"><f:selectitems value="#{mymb.employeeItems}" var="emp" itemlabel="#{emp.employeeName}" itemvalue="#{emp.employeeNumber}"><p:ajax listener="#{mymb.loadDepartments}" process="@this"></p:ajax></f:selectitems></p:selectonemenu></h:outputlabel></p:panelgrid><p:separator></p:separator></p:dialog>如果我使用appendToBody="true"，则selectOneMenu Converter不会调用类，但如果我使用 ，appendToBody="false"则调用Converter类。 这可能是什么原因？appendToBody="false"使我的弹出对话框无法使用，无法使用鼠标导航。 我该如何解决这个问题？ 如果您在PUT 方法支持页面中使用 PUT，您可以获得他们 PUT 的文件名$_SERVER['REQUEST_URI'] 例如，如果我有接收 PHP 脚本 当我发出 CURL 时： curl -X PUT -T "localfile.txt" http://example.com/interesting/target/name.txt 我得到输出（在我的错误日志中） Received PUT, filename: interesting/target/name.txt, 4931 bytes 如果您问我如何找出源文件系统 (localfile.txt) 中文件的名称，我认为这不会被传递。 jsfjsf-2primefaces 4 1 回答 1 This answer is useful 1 删除appendToBody并<h:form>在您的对话框中放置一个（连同它的内容）。 的目的appendToBody="false"是确保您的对话框呈现在 HTML 输出的主体内（因此在 main 内<h:form>）。 如果没有appendToBody="false"，对话框可能最终会被附加到标记的末尾，因此，其中的任何内容都不会被执行。 添加<h:form>到您的对话框可确保即使它在外部结束，它仍然能够提交到服务器 于 2013-02-22T21:08:45.540 回答 Related 2 c++ - 什么是 tar 解析器中的链接指示符（文件类型） 4 iphone - 在 Viewforheaderinsection 中单击的 UITableView 部分 1 hash - 周和强滚动校验和 1 parse-platform - 如何使用 parse.com 更新 1 个请求中的所有记录？ 11 android - 如何在Android中方向改变时连续播放音频？ 4 svn - How to use findstr, exclude svn directory in gvim 1 c# - 我们什么时候需要使用代理类？ 0 delphi - customizing TListBox , effective load from ini file 1 vb.net - vb.net 上的简单计算 1 winforms - RichTextBox 中的手动自动换行 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</h:form></h:form></h:form>

> ID：15033101
> 
> 赞同：0
> 
> 时间：
> 
> 标签：jsf, jsf-2, primefaces

我将 Primefaces 3.4.2 与 JSF 2.0 一起使用

我在 JSF 页面的对话框弹出窗口中有以下内容。

```
<p:dialog header="Create New Request" style="font-weight:bold"
        widgetVar="newDialog" resizable="false" id="newDlg"
        showEffect="fade" hideEffect="fade" appendToBody="true"
        modal="true" position="center top" width="850" height="450">
        <p:panelGrid columns="2">
        <h:outputLabel value="Employee" for="employee" />
            <p:selectOneMenu id="employee" value="#{mymb.employee}" 
            converter="#{employeeConverter}">
         <f:selectItems value="#{mymb.employeeItems}" var="emp"
        itemLabel="#{emp.employeeName}" itemValue="#{emp.employeeNumber}"/>
       <p:ajax listener="#{mymb.loadDepartments}"  process="@this"/>
</p:selectOneMenu>

        </p:panelGrid>
        <p:separator />
            </p:dialog> 
```

如果我使用`appendToBody="true"`，则`selectOneMenu` `Converter`不会调用类，但如果我使用 ，`appendToBody="false"`则调用`Converter`类。

这可能是什么原因？`appendToBody="false"`使我的弹出对话框无法使用，无法使用鼠标导航。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:08:45.540

删除`appendToBody`并`<h:form/>`在您的对话框中放置一个（连同它的内容）。

的目的`appendToBody="false"`是确保您的对话框呈现在 HTML 输出的主体内（因此在 main 内`<h:form/>`）。

如果没有`appendToBody="false"`，对话框可能最终会被附加到标记的末尾，`<body/>`因此，其中的任何内容都不会被执行。

添加`<h:form/>`到您的对话框可确保即使它在外部结束，`<body/>`它仍然能够提交到服务器

# fancybox - 禁用 JavaScript 时显示隐藏内容

> ID：15033105
> 
> 赞同：0
> 
> 时间：2013-02-22T21:02:23.977
> 
> 标签：fancybox, hidden, javascript

我有一大段 HTML 内容，当使用 fancyBox 启用 JavaScript 时可以查看这些内容。点击阅读更多链接后，fancyBox 会弹出一个显示隐藏内容的窗口。Intro、More 和 Bob 部件显示在 fancyBox 中，但 Intro 和 Bob 部件首先显示，然后单击阅读更多链接。这是一个推荐列表，阅读更多部分与 fancyBox 一起出现。

```
...
<li>

    <!-- hidden div begin-->
    <div id="read-more-1" style="display: none;">
        <p>Intro More</p>
        <span class="source">Bob</span>
    </div>
    <!-- hidden div end-->

    <!-- displayed begin-->
    <p>Intro</p>
    <a class="fancy-monials" href="#read-more-1">Read more...</a><br />
    <span class="source">Bob</span>
    <!-- displayed begin-->

</li>
... 
```

如果我禁用 JavaScript 并单击阅读更多链接，它只会将我带到我的主页。我期望的。

我曾尝试构建一个`<noscript>`块来完整地重新显示推荐，并隐藏其他推荐，但这似乎很乏味和hacky。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:06:02.240

解决此类问题的一种常见方法是向`class="no-js"`页面元素添加属性`html`，然后使用 javascript 删除此类。

然后，您可以将此类用作 CSS 中的样式挂钩，以根据是否启用 JS 来显示/隐藏内容。所以在最基本的情况下，你可以这样做（使用上面的代码）：

```
<html class="no-js">
    <head>
        <script type="text/javascript">
            var dde = document.documentElement;
            dde.className = dde.className.replace('no-js','js');
        </script>
        <style type="text/css">
            .no-js .read-more {
                display: block;
            }
            .js .read-more {
                display: none;
            }
        </style>
    </head>
    <body>
        <!-- ... -->
        <ul>
            <li>
                <!-- hidden div begin-->
                <div id="read-more-1" class="read-more">
                    <p>Intro More</p>
                    <span class="source">Bob</span>
                </div>
                <!-- hidden div end-->

                <!-- displayed begin-->
                <p>Intro</p>
                <a class="fancy-monials" href="#read-more-1">Read more...</a><br />
                <span class="source">Bob</span>
                <!-- displayed begin-->
            </li>
        </ul>
        <!-- ... -->
    </body>
</html> 
```

换句话说，您使用 javascript 将`no-js`类更改为`js`，然后使用 CSS 隐藏`.js .read-more`但显示`.no-js .read-more`（或任何隐藏元素的类名）。

希望这可以帮助！

# python - web2py 来检查它是否是一个 POST 动作

> ID：15033106
> 
> 赞同：0
> 
> 时间：2013-02-22T21:02:32.847
> 
> 标签：python, post, http-post, web2py

在 django 中，我可以很容易地测试它是否是 post action

```
 if request.POST:
     do whatever 
```

如何检查它是 web2py 中的 POST 操作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:13:18.460

请求方法可从以下位置获得：

```
request.env.request_method 
```

但对于这种情况，

```
if request.post_vars:
    #whatever 
```

可能更容易

# r - 指定格子图面板的顺序

> ID：15033107
> 
> 赞同：2
> 
> 时间：2013-02-22T21:02:33.057
> 
> 标签：r, lattice

我已经查看了关于这个主题的两个类似问题，但在这两个问题中都没有找到我想要的答案。as.table 函数将字母顺序从左下角更改为左上角，但对组内窗格的顺序没有任何作用。

数据（我的客户专有）具有由字母和数字组合而成的电台标识。当绘制的所有站点组中有一系列具有相同首字母的站点时，它们按第一个数字排序，而不是我们人类计数的方式。例如，SW-1、SW-10、SW-11、SW-2、SW-3。我希望它们按 SW-1、SW-2、SW-3、SW-10、SW-11 的顺序排列。我使用的代码是：

```
 xyplot(as.d$quant ~ as.d$sampdate | as.d$site, ylim=range(as.d$quant), xlim=range(as.d$sampdate), 
 main='Arsenic By Time', ylab='Concentraion (mg/L)', xlab='Time') 
```

我不知道如何附加结果图的 .pdf，但如果有人告诉我如何执行此操作，我会这样做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T21:16:02.730

您需要按您期望的顺序指定该因子变量的水平。正如您所注意到的，默认值是字典式：

```
xyplot(as.d$quant ~ as.d$sampdate | factor( as.d$site, 
                                            levels=1:length(unique(as.d$site))) , 
         ylim=range(as.d$quant),   xlim=range(as.d$sampdate), 
         main='Arsenic By Time', ylab='Concentration (mg/L)', xlab='Time') 
```

根据问题目前的情况，您可能需要：

```
require(gtools)
xyplot(as.d$quant ~ as.d$sampdate | factor( as.d$site, 
                                  levels=mixedsort( as.character(unique(as.d$site)) ) ) , 
         ylim=range(as.d$quant),   xlim=range(as.d$sampdate), 
         main='Arsenic By Time', ylab='Concentration (mg/L)', xlab='Time') 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T21:27:10.210

这里有几点。

首先是在 R 中，诸如因子级别的顺序之类的东西被认为是数据的属性或属性，而不是图形/分析的属性。因此，绘图或分析函数中通常没有用于指定顺序的参数，而是在数据对象本身中指定该顺序，然后所有绘图和分析都使用该顺序。

要更改顺序，您可以使用函数指定所需的顺序`factor`，或者您可以使用 和 等函数`relevel`来`reorder`更改因子水平的顺序。如果您希望级别与它们在数据中出现的顺序相同，则该`unique`函数运行良好。对于混合使用字符和数字进行排序，`mixedsort`gtools 包中的功能可能很有用。

# html - HTML5 视频无法在 IE9 中播放

> ID：15033108
> 
> 赞同：0
> 
> 时间：2013-02-22T21:02:36.247
> 
> 标签：html, video, internet-explorer-9

网址：[http ://carolpolis.com/#media](http://carolpolis.com/#media)

HTML

```
<video width="auto" height="200px" poster="images/WithCourage.jpg" controls>
<source src="media/WithCourage.mp4" type="video/mp4">
<source src="media/WithCourage.webm" type="video/webm">
<source src="media/WithCourage.ogv" type="video/ogg">
Your browser does not support the video tag.
</video> 
```

.htaccess

```
AddType video/ogg .ogv
AddType video/ogg .ogg
AddType video/mp4 .mp4
AddType video/webm .webm
AddType application/x-shockwave-flash swf 
```

文档类型

```
<!DOCTYPE HTML> 
```

该视频在 Firefox 和 Chrome 中完美播放，但在 IE9 中我只看到“海报”图像而没有媒体控件。似乎知道它们是视频，但是当我右键单击它们并按“播放”时，没有任何反应。

非常感谢您的帮助！梅雷迪思

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T00:15:13.583

您的 mp4 视频的编码不正确。

根据对[这个问题](https://stackoverflow.com/questions/13798978/php-html5-compatible-mp4-video-using-ffmpeg)的回答，我将您网站上的一个视频转换为使用基线 (3) 编码配置文件，并使视频在 IE10 的 html 页面上工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:06:58.630

尝试使用绝对 URL，例如：

```
<video width="auto" height="200px" poster="images/WithCourage.jpg" preload controls>
<source src="http://carolpolis.com/media/WithCourage.mp4" type="video/mp4">
<source src="http://carolpolis.com/media/WithCourage.webm" type="video/webm">
<source src="http://carolpolis.com/media/WithCourage.ogv" type="video/ogg">
Your browser does not support the video tag.
</video> 
```

并添加`<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-01T22:09:13.043

在这个问题上浪费了很多时间之后。我发现返回内容类型错误的问题（使用 fiddler2）。我试图用 web.config 修复它，但没有任何帮助。所以我为视频文件编写了特定的操作，问题得到了解决

```
public ActionResult GetVideoFile(string id = "")
{
    string dir = Server.MapPath("/Content/MyVideoFiles");
    string path = System.IO.Path.Combine(dir, id);
    if ((System.IO.File.Exists(path))) {
        return File(path, "video/mp4");
    }
    return null;
} 
```

# php - 如何十六进制到 str 单词以 preg 替换常见的反斜杠开头？

> ID：15033109
> 
> 赞同：0
> 
> 时间：2013-02-22T21:02:36.707
> 
> 标签：php, design-patterns, preg-replace

我正在使用这种模式：

```
$line = preg_replace('#(\w)(\w)#e', "chr(hexdec('$1$2'))", $line); 
```

但这对这个字符串很有用：`"c8d3e320c7e1e1f8e520c7e1d1cde3e420c7e1d1cdede3fe"`

我想转换字符串，例如：-`"\'c8\'d3\'e3\'20\'c7\'e1\'e1\'f8\'e5\'20\'c7\'e1\'d1\'cd\'e3\'e4\'20\'c7\'e1\'d1\'cd\'ed\'e3\'fe"`

这意味着任何角色都是从`\'` 如何改变模式开始的？

谢谢+阿卡姆

使用此模式解决的问题

```
 $line = preg_replace("#\\\'(\w)(\w)#e", "chr(hexdec('$1$2'))", $line); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:12:38.253

```
$line = "\'c8\'d3\'e3\'20\'c7\'e1\'e1\'f8\'e5\'20\'c7\'e1\'d1\'cd\'e3\'e4\'20\'c7\'e1\'d1\'cd\'ed\'e3\'fe";
echo preg_replace("#\\'(\w)(\w)#e", "chr(hexdec('$1$2'))", $line);

//test
preg_match_all("#\\'(\w)(\w)#e", $line, $out);
echo '<pre>';
print_r($out);

    [1] => Array
        (
            [0] => c
            [1] => d
            [2] => e
            [3] => 2
            [4] => c
            [5] => e
            [6] => e
            [7] => f
            [8] => e
            [9] => 2
            [10] => c
            [11] => e
            [12] => d
            [13] => c
            [14] => e
            [15] => e
            [16] => 2
            [17] => c
            [18] => e
            [19] => d
            [20] => c
            [21] => e
            [22] => e
            [23] => f
        )

    [2] => Array
        (
            [0] => 8
            [1] => 3
            [2] => 3
            [3] => 0
            [4] => 7
            [5] => 1
            [6] => 1
            [7] => 8
            [8] => 5
            [9] => 0
            [10] => 7
            [11] => 1
            [12] => 1
            [13] => d
            [14] => 3
            [15] => 4
            [16] => 0
            [17] => 7
            [18] => 1
            [19] => 1
            [20] => d
            [21] => d
            [22] => 3
            [23] => e
        )

) 
```

# eclipse - 识别 Eclipse 中的 TODO 标签

> ID：15033116
> 
> 赞同：0
> 
> 时间：2013-02-22T21:03:02.900
> 
> 标签：eclipse, todo

我想知道 Eclipse 是否支持标签的某种标识（数字或名称）`TODO`？具体来说，我希望能够参考其他`TODO`的。

**示例**（自由发明的示例说明为什么会有用以及它如何工作）：

*原始代码*

```
private int someInt;
[...]
public MyClass() {
    someInt = 0;
} 
```

*编辑代码*

```
// private int someInt; // TODO(1) discuss if really necessary
[...]
public MyClass() {
    // someInt = 0; >TODO(1)
} 
```

此外，最好将人员分配给 TODO 标签，以便为某个人标记该 TODO。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:30:51.330

不会。但是如果您将 TODO 标记放入 JavaDoc 注释中，那么您可以轻松地使用普通的 JavaDoc 引用来指向类、成员和方法，这应该足以拥有引用。

如果你现在说你不能用那个来引用方法的第 27 行，对。只需将第27行的代码提取到一个新方法中即可。:)

关于您的第二个问题：我建议不要在项目管理相关信息中乱扔代码。如果您将任务分配、所有已修复的错误编号和其他内容添加到代码中，代码将变得非常不可读。话虽如此，如果您真的愿意，您可以轻松地为自己定义一个 Java[注释类型](http://docs.oracle.com/javase/tutorial/java/javaOO/annotations.html)，并用这些注释标记您的任意代码片段。他们甚至可能为人员、优先级或您想象的任何其他内容提供不同的可选字段。

# java - pdfbox 将 pdf 转换为图像字节 []

> ID：15033118
> 
> 赞同：11
> 
> 时间：2013-02-22T21:03:04.937
> 
> 标签：java, pdfbox

使用 pdfbox，是否可以将 PDF（或 PDF 字节 []）转换为图像字节 []？我在网上浏览了几个示例，唯一能找到的示例描述了如何将转换后的文件直接写入文件系统或将其转换为 Java AWT 对象。

我宁愿不招致将图像文件写入文件系统的 IO，读入字节 []，然后将其删除。

所以我可以这样做：

```
String destinationImageFormat = "jpg";
boolean success = false;
InputStream is = getClass().getClassLoader().getResourceAsStream("example.pdf");
PDDocument pdf = PDDocument.load( is, true );

int resolution = 256;
String password = "";
String outputPrefix = "myImageFile";

PDFImageWriter imageWriter = new PDFImageWriter();    

success = imageWriter.writeImage(pdf, 
                    destinationImageFormat, 
                    password, 
                    1, 
                    2, 
                    outputPrefix, 
                    BufferedImage.TYPE_INT_RGB, 
                    resolution); 
```

还有这个：

```
InputStream is = getClass().getClassLoader().getResourceAsStream("example.pdf");

PDDocument pdf = PDDocument.load( is, true );
List<PDPage> pages = pdf.getDocumentCatalog().getAllPages();

for ( PDPage page : pages )
{
    BufferedImage image = page.convertToImage();
} 
```

我不清楚的是如何将 BufferedImage 转换为 byte[]。我知道这在 imageWriter.writeImage() 中被转换为文件输出流，但我不清楚 API 是如何工作的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-22T21:12:14.063

You can use ImageIO.write to write to an OutputStream. To get a byte[], use a ByteArrayOutputStream, then call toByteArray() on it.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-27T04:01:56.867

添加maven依赖：

```
 <!-- https://mvnrepository.com/artifact/org.apache.pdfbox/pdfbox -->
    <dependency>
        <groupId>org.apache.pdfbox</groupId>
        <artifactId>pdfbox</artifactId>
        <version>2.0.1</version>
    </dependency> 
```

并且，将 pdf 转换为图像：

```
import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.rendering.PDFRenderer;
import javax.imageio.ImageIO;

private List<String> savePDF(String filePath) throws IOException {
    List<String> result = Lists.newArrayList();

    File file = new File(filePath);

    PDDocument doc = PDDocument.load(file);
    PDFRenderer renderer = new PDFRenderer(doc);

    int pageSize = doc.getNumberOfPages();
    for (int i = 0; i < pageSize; i++) {
        String pngFileName = file.getPath() + "." + (i + 1) + ".png";

        FileOutputStream out = new FileOutputStream(pngFileName);
        ImageIO.write(renderer.renderImageWithDPI(i, 96), "png", out);
        out.close();

        result.add(pngFileName);
    }
    doc.close();
    return result;
} 
```

编辑：

```
import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.rendering.PDFRenderer;
import javax.imageio.ImageIO;

private List<String> savePDF(String filePath) throws IOException {
    List<String> result = Lists.newArrayList();

    File file = new File(filePath);

    PDDocument doc = PDDocument.load(file);
    PDFRenderer renderer = new PDFRenderer(doc);

    int pageSize = doc.getNumberOfPages();
    for (int i = 0; i < pageSize; i++) {
        String pngFileName = file.getPath() + "." + (i + 1) + ".png";

        ByteArrayOutputStream out = new ByteArrayOutputStream(pngFileName);
        ImageIO.write(renderer.renderImageWithDPI(i, 96), "png", out);

        out.toByteArray(); // here you can get a byte array

        out.close();

        result.add(pngFileName);
    }
    doc.close();
    return result;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-14T21:11:33.910

```
 try {           
                PDDocument document = PDDocument.load(PdfInfo.getPDFWAY());
                if (document.isEncrypted()) {
                    document.decrypt(PdfInfo.getPASSWORD());
                }
                if ("bilevel".equalsIgnoreCase(PdfInfo.getCOLOR())) {
                    PdfInfo.setIMAGETYPE( BufferedImage.TYPE_BYTE_BINARY);
                } else if ("indexed".equalsIgnoreCase(PdfInfo.getCOLOR())) {
                    PdfInfo.setIMAGETYPE(BufferedImage.TYPE_BYTE_INDEXED);
                } else if ("gray".equalsIgnoreCase(PdfInfo.getCOLOR())) {
                    PdfInfo.setIMAGETYPE(BufferedImage.TYPE_BYTE_GRAY);
                } else if ("rgb".equalsIgnoreCase(PdfInfo.getCOLOR())) {
                    PdfInfo.setIMAGETYPE(BufferedImage.TYPE_INT_RGB);
                } else if ("rgba".equalsIgnoreCase(PdfInfo.getCOLOR())) {
                    PdfInfo.setIMAGETYPE(BufferedImage.TYPE_INT_ARGB);
                } else {
                    System.exit(2);
                }
                PDFImageWriter imageWriter = new PDFImageWriter();
                boolean success = imageWriter.writeImage(document, PdfInfo.getIMAGE_FORMAT(),PdfInfo.getPASSWORD(),
                        PdfInfo.getSTART_PAGE(),PdfInfo.getEND_PAGE(),PdfInfo.getOUTPUT_PREFIX(),PdfInfo.getIMAGETYPE(),PdfInfo.getRESOLUTION());
                if (!success) {
                    System.exit(1);
                }
                document.close();

        } catch (IOException | CryptographyException | InvalidPasswordException ex) {
            Logger.getLogger(PdfToImae.class.getName()).log(Level.SEVERE, null, ex);
        }
public class PdfInfo {
    private static String PDFWAY;    
    private static String OUTPUT_PREFIX;
    private static String PASSWORD;
    private static int START_PAGE=1;
    private static int END_PAGE=Integer.MAX_VALUE;
    private static String IMAGE_FORMAT="jpg";
    private static String COLOR="rgb";
    private static int RESOLUTION=256;
    private static int IMAGETYPE=24;
    private static String filename;
    private static String filePath="";
} 
```

# jquery - Jquery颜色插件不转换为透明

> ID：15033124
> 
> 赞同：1
> 
> 时间：2013-02-22T21:03:24.250
> 
> 标签：jquery, css

好吧，我已经为我的网站使用了这个颜色插件。它实际上工作但不完全。根据我的风格，我的链接没有背景颜色。但是，当您将鼠标悬停在它们上时，使用 jquery 会更改背景颜色，但是在悬停它们之后，一定不会有任何背景颜色，但确实如此。“停止动画”可能不会做我愿意做的事情。我实际上希望这些链接根本没有背景颜色。我知道它很简单，但就是无法完成。这是我的jQuery代码：

```
 $(document).ready(function () {             
     $("#Menu div span label a").hover(function () {    
        $(this).stop().animate({ backgroundColor: "#00aadd" }, 600);     
         }, function () {    
    $(this).stop().animate({ backgroundColor: "transparent" },400);});
}); 
```

完整的代码就在这里。[http://jsfiddle.net/hGmxP/34/](http://jsfiddle.net/hGmxP/34/)。

顺便说一句，如果你看到我为这些简单的链接使用了很多标签，那是因为该网站将成为我的作品集，并且它需要有很多层用于设计部分。那么我的代码有什么问题吗？并提前感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:24:56.550

您可以尝试使用 CSS。但我认为它不适用于 IE

```
-webkit-transition: all 0.6s ease;
-moz-transition: all 0.6s ease;
-o-transition: all 0.6s ease;
transition: all 0.6s ease; 
```

你可以在这里查看：http: [//jsfiddle.net/76uGE/1/](http://jsfiddle.net/76uGE/1/)

# ruby - Ruby 和 UnixSocket：只有一条消息？

> ID：15033125
> 
> 赞同：1
> 
> 时间：2013-02-22T21:03:32.570
> 
> 标签：ruby, sockets, unix

我正在尝试在我的 Ruby 脚本中使用 UnixSocket，以便让多个进程相互通信。

但我不明白为什么 ii 只能向监听过程发送一条消息。仅限于我所拥有的基础知识：

服务器

```
require 'socket'
server = UNIXServer.open('/tmp/scanlcd_test.sock')
while true do
    client = server.accept
    puts "I got: " + client.readline
end

server.close 
```

客户：

```
require 'socket'
client = UNIXSocket.open('/tmp/scanlcd_test.sock')
client.puts "1"
sleep 9
client.puts "2"
client.puts "3"
client.puts "4" 
```

结果是：

```
./server.rb
I got: 1 
```

就是这样……最后 3 个 put 不见了……有什么问题吗？

# jquery - jQuery Mobile 手风琴小部件自动高度不起作用

> ID：15033127
> 
> 赞同：0
> 
> 时间：2013-02-22T21:03:42.567
> 
> 标签：jquery, jquery-ui, jquery-mobile, accordion, jquery-ui-accordion

我正在使用带有 jQ​​uery 版本 1.7.1 和 jQueryMobile 版本 1.1.1 的 jQuery Mobile 手风琴小部件。我希望手风琴在展开时占据固定空间，以便页面的其余部分不会向下滚动，就像这里的演示一样：http: [//jqueryui.com/accordion/#default](http://jqueryui.com/accordion/#default)

我曾尝试使用 jQuery 中的“手风琴”选项，但它们似乎有所不同。就像现在一样，手风琴面板会根据内容改变大小，因此手风琴下方的内容会不断变化。

这是我的代码：

```
 <div data-role="collapsible-set">
    <div data-role="collapsible">
        <h3>Title 1</h3>
        <p>[content 1: very long]</p>
    </div>
    <div data-role="collapsible">
        <h3>Title 2</h3>
        <p>[content 2: normal length]</p>
    </div>
    <div data-role="collapsible">
        <h3>Title 3</h3>
        <p>[content 3: short]</p>
    </div>
    <div data-role="collapsible">
        <h3>Title 4</h3>
        <p>[content 4: short]</p>
    </div>
</div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:13:40.807

不要将 jQuery Ui 手风琴与 jQuery Mobile 手风琴混淆，它们没有任何共同点。

jQuery Mobile 手风琴可以通过一些 css 更改强制使用固定高度：

```
.ui-collapsible-content {
    height: 50px !important;
    overflow-y:scroll !important;
} 
```

现场**jsFiddle**示例：http: [//jsfiddle.net/Gajotres/YvhLk/](http://jsfiddle.net/Gajotres/YvhLk/)

删除 **溢出-y:scroll !important;** 如果您不想要滚动条。

# java - Java：多线程程序中的 java.util.NoSuchElementException？

> ID：15033128
> 
> 赞同：1
> 
> 时间：2013-02-22T21:03:50.437
> 
> 标签：java, multithreading, exception

我需要在文件中组织多线程查找：

用户输入 where find(path) 和 what find(word);

第一个线程在文件夹中找到 .txt 文件并将结果添加到队列中；当队列有一些文件=>第二个线程开始在这个文件中查找需要查找的内容（单词）。如果找到成功，将显示此文件的路径 + 该单词在文件中相遇的次数。
但是我有`NoSuchElementException.`

**输出：**

```
 Exception in thread "pool-1-thread-2" java.util.NoSuchElementException  
    at java.util.AbstractQueue.remove(AbstractQueue.java:117)  
    at task.FileScan.run(FileScan.java:77)  
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)  
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)  
    at java.lang.Thread.run(Thread.java:722). 
```

**代码：**

```
import java.util.concurrent.*;
import java.util.*;
import java.io.*;

class FolderScan implements Runnable {

    private String path;
    private BlockingQueue<File> queue;
    private CountDownLatch latch;
    private File endOfWorkFile;

    FolderScan(String path, BlockingQueue<File> queue, CountDownLatch latch,
            File endOfWorkFile) {
        this.path = path;
        this.queue = queue;
        this.latch = latch;
        this.endOfWorkFile = endOfWorkFile;
    }

    public FolderScan() {
        // TODO Auto-generated constructor stub
    }

    @Override
    public void run() {
        findFiles(path);
        queue.add(endOfWorkFile);
        latch.countDown();
    }

    private void findFiles(String path) {

        File root = new File(path);
        File[] list = root.listFiles();
        for (File currentFile : list) {
            if (currentFile.isDirectory()) {
                findFiles(currentFile.getAbsolutePath());
            } else {
                if (currentFile.getName().toLowerCase().endsWith((".txt"))) {
                    queue.add(currentFile);
                }
            }
        }

    }

}

public class FileScan implements Runnable {

    private String whatFind;
    private BlockingQueue<File> queue;
    private CountDownLatch latch;
    private File endOfWorkFile;

    public FileScan(String whatFind, BlockingQueue<File> queue,
            CountDownLatch latch, File endOfWorkFile) {
        this.whatFind = whatFind;
        this.queue = queue;
        this.latch = latch;
        this.endOfWorkFile = endOfWorkFile;
    }

    public FileScan() {
        // TODO Auto-generated constructor stub
    }

    Set<String> words = new HashSet<String>();
    int matches = 0;

    @Override
    public void run() {

        while (true) {
            File file = queue.remove();
            if (file == endOfWorkFile) {
                break;
            }
            scan(file);
        }

        latch.countDown();
    }

    private void scan(File file) {
        Scanner scanner = null;
        try {
            scanner = new Scanner(file);
        } catch (FileNotFoundException e) {
            System.out.println("FileNotFoundException.");
            e.printStackTrace();
        }
        while (scanner.hasNext()) {
            String word = scanner.next();
            words.add(word);
        }

        if (words.contains(this.whatFind)) {
            // System.out.println("File:" + ((File) words).getAbsolutePath());
            matches++;
        }
        @SuppressWarnings("unused")
        String myStr = String.format("File: %s and the number of matches "
                + "is = %d", file.getAbsolutePath(), matches);
        System.out.println("myStr");

        matches = 0;
    }

    // ask user about input
    public void askUserPathAndWord() {

        BufferedReader bufferedReader = new BufferedReader(
                new InputStreamReader(System.in));
        String path;
        String whatFind;
        BlockingQueue<File> queue = new LinkedBlockingQueue<File>();

        try {
            System.out.println("Please, enter a Path and Word"
                    + "(which you want to find):");
            System.out.println("Please enter a Path:");
            path = bufferedReader.readLine();
            System.out.println("Please enter a Word:");
            whatFind = bufferedReader.readLine();

            if (path != null && whatFind != null) {

                File endOfWorkFile = new File("GameOver.tmp");
                CountDownLatch latch = new CountDownLatch(2);

                FolderScan folderScan = new FolderScan(path, queue, latch,
                        endOfWorkFile);
                FileScan fileScan = new FileScan(whatFind, queue, latch,
                        endOfWorkFile);

                Executor executor = Executors.newCachedThreadPool();
                executor.execute(folderScan);
                executor.execute(fileScan);

                latch.await();
                System.out.println("Thank you!");
            } else {
                System.out.println("You did not enter anything");
            }

        } catch (IOException | RuntimeException e) {
            System.out.println("Wrong input!");
            e.printStackTrace();
        } catch (InterruptedException e) {
            System.out.println("Interrupted.");
            e.printStackTrace();
        }
    }

    /**
     * @param args
     */

    public static void main(String[] args) {
        new FileScan().askUserPathAndWord();
    }
} 
```

怎么能解决这个问题？

谢谢，
纳扎尔。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T21:07:47.700

你检查[过javadoc](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/BlockingQueue.html)吗？

有一个很好的表格，根据您的需要显示要调用的方法。在您的情况下，我猜您需要阻止并等待队列为空。如果是这种情况，您应该替换`remove`为`take`.

注意：我没有检查您的代码的详细信息，因此可能存在其他问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:15:13.717

```
package task;

import java.util.concurrent.*;
import java.util.*;
import java.io.*;

class FolderScan implements Runnable {

    private String path;
    private BlockingQueue<File> queue;
    private CountDownLatch latch;
    private File endOfWorkFile;

    FolderScan(String path, BlockingQueue<File> queue, CountDownLatch latch,
            File endOfWorkFile) {
        this.path = path;
        this.queue = queue;
        this.latch = latch;
        this.endOfWorkFile = endOfWorkFile;
    }

    public FolderScan() {  }

    @Override
    public void run() {
        findFiles(path);
        queue.add(endOfWorkFile);
        latch.countDown();
    }

    private void findFiles(String path) {

        try {
            File root = new File(path);
            File[] list = root.listFiles();
            for (File currentFile : list) {
                if (currentFile.isDirectory()) {
                    findFiles(currentFile.getAbsolutePath());
                } else {
                    if (currentFile.getName().toLowerCase().endsWith((".txt"))) {
                            queue.put(currentFile);
                    }
                }
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

    }

}

public class FileScan implements Runnable {

    private String whatFind;
    private BlockingQueue<File> queue;
    private CountDownLatch latch;
    private File endOfWorkFile;

    public FileScan(String whatFind, BlockingQueue<File> queue,
            CountDownLatch latch, File endOfWorkFile) {
        this.whatFind = whatFind;
        this.queue = queue;
        this.latch = latch;
        this.endOfWorkFile = endOfWorkFile;
    }

    public FileScan() {     }

    Set<String> words = new HashSet<String>();
    int matches = 0;

    @Override
    public void run() {

        while (true) {
            try {
                File file;
                file = queue.take();

                if (file == endOfWorkFile) {
                    break;
                }

                scan(file);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }

        latch.countDown();
    }

    private void scan(File file) {
        Scanner scanner = null;
        try {
            scanner = new Scanner(file);
        } catch (FileNotFoundException e) {
            System.out.println("FileNotFoundException.");
            e.printStackTrace();
        }
        while (scanner.hasNext()) {
            String word = scanner.next();
            words.add(word);
        }

        if (words.contains(this.whatFind)) {
            // System.out.println("File:" + ((File) words).getAbsolutePath());
            matches++;
        }

        String myStr = String.format("File: %s and the number of matches "
                + "is = %d", file.getAbsolutePath(), matches);
        System.out.println(myStr);

        matches = 0;
    }

    // ask user about input
    public void askUserPathAndWord() {

        BufferedReader bufferedReader = new BufferedReader(
                new InputStreamReader(System.in));
        String path;
        String whatFind;
        BlockingQueue<File> queue = new LinkedBlockingQueue<File>();

        try {
            System.out.println("Please, enter a Path and Word"
                    + "(which you want to find):");
            System.out.println("Please enter a Path:");
            path = bufferedReader.readLine();
            System.out.println("Please enter a Word:");
            whatFind = bufferedReader.readLine();

            if (path != null && whatFind != null) {

                File endOfWorkFile = new File("GameOver.tmp");
                CountDownLatch latch = new CountDownLatch(2);

                FolderScan folderScan = new FolderScan(path, queue, latch,
                        endOfWorkFile);
                FileScan fileScan = new FileScan(whatFind, queue, latch,
                        endOfWorkFile);

                Executor executor = Executors.newCachedThreadPool();
                executor.execute(folderScan);
                executor.execute(fileScan);

                latch.await();
                System.out.println("Thank you!");
            } else {
                System.out.println("You did not enter anything");
            }

        } catch (IOException | RuntimeException e) {
            System.out.println("Wrong input!");
            e.printStackTrace();
        } catch (InterruptedException e) {
            System.out.println("Interrupted.");
            e.printStackTrace();
        }
    }

    /**
     * @param args
     */

    public static void main(String[] args) {
        new FileScan().askUserPathAndWord();
    }
} 
```

# c - 使用 fgets 和 strtok 从文件中读取和解析行

> ID：15033140
> 
> 赞同：4
> 
> 时间：2013-02-22T21:04:36.350
> 
> 标签：c, string, io, fgets, strtok

我在使用相当基本的代码时遇到了麻烦。我需要从下面显示的文件中读取每一行，用 strtok 将其分成 3 个部分，并将每个部分存储到一个数组中。“goals”和“assists”的数组工作正常，但由于某种原因，整个 name 数组都填充了从文件中读取的姓氏。

输入文件：

```
Redden 2 0
Berglund 5 2
Jackman 2 0
Stewart 4 0
Oshie 3 5
McDonald 2 4
Pietrangelo 2 7
Perron 2 6
Tarasenko 5 5 
```

相关代码：

```
int main(int argc, char* argv){  
    FILE* inFile = fopen(argv[1],"r");
    char ** nameArray;
    int * goalArray;
    int * assistArray;
    int size = countLinesInFile(inFile);
    allocateMemory(&goalArray, &assistArray, &nameArray, size);
    readLinesFromFile(inFile, goalArray, assistArray, nameArray, size);
}

void allocateMemory(int** goals, int** assists, char*** names, int size)
{
  *goals = malloc(size*sizeof(int));
  *assists = malloc(size*sizeof(int));
  *names = malloc(size*sizeof(char *));
  int i;
  for(i=0; i<size; i++)
  {
    *(*names + i) = calloc(MAX_NAME,sizeof(char));
  }
}

void readLinesFromFile(FILE* fPtr, int* goals, int* assists, char** names, int numLines)
{
  int i;
  char * buffer = malloc(MAX_LINE*sizeof(char));
  for(i = 0; i<numLines; i++)
  {
    if(fgets(buffer, MAX_LINE, fPtr)!= NULL)
    {
      names[i] = strtok(buffer, " \n");
      goals[i] = atoi(strtok(NULL, " \n"));
      assists[i] = atoi(strtok(NULL, " \n"));
    }
  }
} 
```

出于某种原因，nameArray[0-9] 都包含“Tarasenko”，对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:08:07.700

您没有复制名称，只是将返回的指针`strtok`放入数据结构中。您最终会得到一个充满相同指针的数据结构，这些指针指向`buffer`. 由于`buffer`每次通过循环都会修改 get 的内容，因此您最终会得到一堆指向最后一次通过的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:18:41.813

[`strtok`](http://linux.die.net/man/3/strtok)返回指向包含下一个标记的以空字符结尾的字符串的指针。要实际复制此令牌，您应该使用[`strcpy`](http://linux.die.net/man/3/strcpy)：

```
strcpy(names[i],    strtok(buffer,      " \n"));
strcpy(goals[i],    atoi(strtok(NULL,   " \n")));
strcpy(assists[i],  atoi(strtok(NULL,   " \n"))); 
```

另请注意，您的代码中存在内存泄漏：

```
void readLinesFromFile(/*...*/)
{
    char * buffer = malloc(MAX_LINE*sizeof(char));
    // ...
    fgets(buffer, MAX_LINE, fPtr);
    // ...
} 
```

`buffer`您通过调用动态分配`malloc`，但不会释放此内存。不要忘记调用[`free()`](http://linux.die.net/man/3/free)指向已分配内存的指针`malloc`。但是在这种情况下，具有自动存储持续时间的数组将是一个更好的选择：

```
void readLinesFromFile(/*...*/)
{
    char buffer[MAX_LINE];
    // ...
    fgets(&buffer, MAX_LINE, fPtr);
    // ...
} 
```

# php - Codeigniter 在页面顶部加载 CSS/JS 文件

> ID：15033141
> 
> 赞同：2
> 
> 时间：2013-02-22T21:04:39.490
> 
> 标签：php, codeigniter

我试图通过创建一个`header.php`像

```
<style> @import url('<?=base_url()?>assets/css/style.css'); </style>
<style> @import url('<?=base_url()?>assets/css/bootstrap.css'); </style>
<style> @import url('<?=base_url()?>assets/css/bootstrap-responsive.css'); </style>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script> 
```

在控制器文件中，我将这些视图称为

```
public function show($id)
{
    $data['car'] = $this->car_model->findCar($id)->row();
    $this->load->view('index.php/car/show',$data);
    $this->load->view('header');
    $this->load->view('footer');
} 
```

一切都很好，但似乎所有这些文件都加载在页面底部。我`Uncaught ReferenceError: jQuery is not defined`在加载 jQuery 之类的东西时遇到了困难。我通过在特定视图文件的标题中添加脚本标记暂时解决了这个问题。

如果我希望它们在页面顶部加载，我该如何更改，也许是在`<header>`标签中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:08:29.247

您需要更改视图加载的顺序：

```
public function show($id)
{
    $this->load->view('header');
    $data['car'] = $this->car_model->findCar($id)->row();
    $this->load->view('index.php/car/show',$data);
    $this->load->view('footer');
} 
```

# javascript - window.orientation 检测仅适用于手持设备

> ID：15033146
> 
> 赞同：1
> 
> 时间：2013-02-22T21:04:57.300
> 
> 标签：javascript, jquery

我的 webapp 上有以下代码，仅以横向显示 div。它在手机上运行良好，但在我不想要的 iPad 上也运行良好。有没有办法让这个功能只在手持设备上工作？

```
$(function(){
window.onload = handleOrientation;
    window.addEventListener('orientationchange', handleOrientation, false);
        function handleOrientation() {
            if (window.orientation == "90" || window.orientation == "-90") {
            document.getElementById("landscape").style.display = 'block';
        } else {
            document.getElementById("landscape").style.display = 'none';
        }
    }
}); 
```

我是javascript的新手，多亏了你们，我尽可能快地学习和学习，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:41:12.727

您应该能够区分手机和平板电脑，然后为平板电脑禁用它。

区分的一种方法是找出屏幕宽度。

```
if (window.screen.width < 320) {
// This is an iphone
// 320 pixels is the width of an iphone
// do the necessary
} 
```

这可能不是最好的方法，但可以解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:27:47.320

您需要进行一些用户代理嗅探，因为仅通过检查屏幕尺寸/像素密度几乎不可能区分手机和平板电脑。甚至用户代理也不是 100% 可靠的。

您可以在这里找到一些灵感：http: [//detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:57:07.773

如果您只关心 iPad 作为平板电脑。您可以检查浏览器的用户代理并仅在它是电话时附加侦听器。否则检查它是否是带有用户代理字符串的移动设备。

```
if (!navigator.userAgent.test(/iPad/i)) {
    // Attcah listener here
} 
```

检查以下问题的答案，了解如何使用用户代理字符串进行检测。

[一般如何检测 Android 平板电脑。用户代理？](https://stackoverflow.com/questions/5341637/how-do-detect-android-tablets-in-general-useragent)

# python - Python - 从 html 页面中提取数据的单元测试类

> ID：15033148
> 
> 赞同：0
> 
> 时间：2013-02-22T21:05:04.257
> 
> 标签：python, unit-testing

我正在用 Python 编写小型应用程序，一个模块负责下载和解析网页，`Beautiful Soup`用于解析和`urllib2`页面下载。

我现在想知道，我怎么能为负责解析页面的类编写单元测试。

我可以创建一些抽象`urllib2`并将其注入负责解析的类（我的计划是为不同的网页设置不同的类），并且在测试期间我会注入一个模拟这个抽象的对象。但我不太确定这种方式。我只会创建一个抽象，因为编写测试会更容易，而不是因为需要抽象（至少我现在是这么认为的）。

然后我会遇到如何测试这个抽象的问题，它需要互联网连接才能正常工作，当我运行测试时，我如何断言下载了正确的页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:22:32.170

要在 python 中实现单元测试，您应该考虑使用 Mocks 和补丁： [http ://www.voidspace.org.uk/python/mock/](http://www.voidspace.org.uk/python/mock/)

# python - 在 Python 图中添加边（初学者）

> ID：15033155
> 
> 赞同：2
> 
> 时间：2013-02-22T21:05:43.963
> 
> 标签：python, graph

在以下图的实现中，`v, w = e`分配做什么以及它是如何工作的？我认为我们不允许做这样的不对称作业。

```
class Graph(dict):
    def __init__(self, vs=[], es=[]):
        """create a new graph.  (vs) is a list of vertices;
        (es) is a list of edges."""
        for v in vs:
            self.add_vertex(v)

        for e in es:
            self.add_edge(e)

    def add_vertex(self, v):
        """add (v) to the graph"""
        self[v] = {}

    def add_edge(self, e):
        """add (e) to the graph by adding an entry in both directions.

        If there is already an edge connecting these Vertices, the
        new edge replaces it.
        """
        v, w = e
        self[v][w] = e
        self[w][v] = e 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T21:09:21.517

它的工作方式是这样的：e 实际上是一个元组，由两个元素组成。声明`v, w = e`等于将 e 的第一个元素分配给 v，将第二个元素分配给 w。

作为演示，检查以下 python 控制台输出：

```
>>> e = (1, 2)
>>> u, v = e
>>> u
1 
>>> v
2 
```

希望能有所澄清。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:16:37.920

这是因为艾伦唐尼（[书](http://greenteapress.com/complexity/index.html)）想在他的书的下一页向您展示拆包。

他在这里写道：

```
class Edge(tuple):
    def __new__(cls, *vs):
        return tuple.__new__(cls, vs)

    def __repr__(self):
        return 'Edge(%s, %s)' % (repr(self[0]), repr(self[1]))

    __str__ = __repr__ 
```

...所以它变得明确，它是一个元组。

# javascript - 是否可以在数组数组内和数组之间随机播放对象？

> ID：15033156
> 
> 赞同：0
> 
> 时间：2013-02-22T21:05:49.970
> 
> 标签：javascript, arrays, random, shuffle

假设我在 javascript 中有一个数组，例如

```
[[1,2,3],[4,5,6],[7,8,9],[10,11,12],[13,14,15],[16,17,18]] 
```

我可以随机打乱子数组的元素以获得这样的东西吗

```
[[16,4,10],[8,3,9],[1,14,18],[2,5,7],[6,17,11],[12,13,15]] 
```

编辑：所有子数组的长度相同。并且新数组将具有与旧数组相同长度的子数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:20:51.280

我会为此使用下划线：http: [//underscorejs.org/](http://underscorejs.org/)

```
`v = [[1,2,3],[4,5,6],[7,8,9],[10,11,12],[13,14,15],[16,17,18]]
v2 = _.shuffle(_.flatten(v))
v3 = _.groupBy(v2, function(item, i) {
  return i % v.length;
})`

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2013-02-22T21:18:39.163

您可以展平您的阵列，[将其洗牌](https://stackoverflow.com/q/2450954/1048572)，然后再次拆分：

```
var flat = [].concat.apply([], myArray);
arrayShuffle(flat);
var newArray = [],
    sublen = myArray[0].length;
for (var i=0; i<flat.length; i+= sublen)
    newArray.push(flat.slice(i, i+sublen)); 
```

* * *

或者您修改现有的洗牌算法之一以使用子数组中的项目。例如，Fisher-Yates-shuffle：

```
function shuffle2dArray(array) {
    if (!array.length) return array;
    var sublen = array[0].length,
        len = array.length * sublen;
    for (var i = len - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var ix = ~~(i/sublen),
            iy = i % sublen,
            jx = ~~(j/sublen),
            jy = j % sublen;
        var temp = array[ix][iy];
        array[ix][iy] = array[jx][jy];
        array[jx][jy] = temp;
    }
    return array;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2013-02-22T21:19:27.883

这会随机播放，它不会返回新数组：

```
function shuffleMatrix (m) {
   if (m.length == 0 || m[0].length == 0) {
       // no rows or columns, just return it
       return m;
   }
   function swap(i1, j1, i2, j2) {
       if (i1 != i2 || j1 != j2) {
           var temp = m[i1][j1];
           m[i1][j1] = m[i2][j2];
           m[i2][j2] = temp;
   }
   var rows = m.length;
   var cols = m[0].length;
   for (i = 0; i < rows; i++) {
       for (j = 0; j < cols; j++) {
           var new_i = Math.random()*rows;
           var new_j = Math.random()*cols;
           swap(i, j, new_i, new_j);
       }
   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2013-02-22T21:10:10.490

```
function arrayShuffle(){
  var tmp, rand;
  for(var i =0; i < this.length; i++){
    rand = Math.floor(Math.random() * this.length);
    tmp = this[i]; 
    this[i] = this[rand]; 
    this[rand] =tmp;
  }
}

Array.prototype.shuffle =arrayShuffle; 
```

And then 

```
for(var i in arrays){
    arrays[i].shuffle()
} 
```

same thing to position of arrays inside the toplevel array.

//EDIT: Missreading :)

```
function shuffleAnyNumber (arrays) {
   var numbers = new Array();     //collection of all numbers

   for(var i in this){
       for(var j in arrays[i]){
          numbers.push( arrays[i][j]);        //collect numbers out of the given arrays
       }       
   }

   numbers.shuffle(); //Method shown above

   var output = new Array();
   var tempArray= new Array();

   //putting it together
   for(var i in numbers){
       if(tempArray.length == 3){
            output.push(tempArray);
            tempArray = new Array();
       } else {
            tempArray.push(numbers[i]);
       }
   }

   return output;
} 
```

i ' d say it will work like that.

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2013-02-23T00:39:12.593

我 100% 支持 Ilan Berci 的回答。但是，您可以使用下划线以更实用的样式编写它：

```
var v = [[1,2,3],[4,5,6],[7,8,9],[10,11,12],[13,14,15],[16,17,18]];

return _(v).chain().flatten().shuffle().groupBy(function(item, i) { 
    return i % v.length; 
}).values().value(); 
```

去下划线！！ 
```

# three.js - Dat.gui 用于不透明度

> ID：15033157
> 
> 赞同：0
> 
> 时间：2013-02-22T21:05:50.423
> 
> 标签：three.js, dat.gui

我需要使用以下命令在 dat.gui 上放置一个透明模型 stl：

gui.add(opacity_model, 'model').onChange(function(){

```
 if (opacity_model, 'model' ==  true) {
                    material.opacity = 0.0;

                } else {

                    material.opacity = 1.0
                } 
```

}

但它不会改变模型的不透明度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T12:53:31.267

也尝试设置 material.transparent = true; 或虚假；

# android - WordPress for Android 中的 IDN 域支持

> ID：15033161
> 
> 赞同：1
> 
> 时间：2013-02-22T21:06:03.630
> 
> 标签：android, wordpress, dns, idn

有人在 Wordpress 中为 Android 2.2.7 应用程序配置了 IDN 域吗？

我已经使用和不使用 punycode 符号进行了测试，但都不起作用。

我曾经获得相同的错误代码：

java.net:UnknownHostException 无法解析主机...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T18:03:59.047

目前最新版本的 Android 版 WordPress 支持 Punycode。IDN 支持的补丁正在开发中，从这里开始：[https ://github.com/wordpress-mobile/WordPress-Android/pull/515](https://github.com/wordpress-mobile/WordPress-Android/pull/515)

# apache - .htaccess 规则，将不存在的旧地址重定向到新地址

> ID：15033166
> 
> 赞同：3
> 
> 时间：2013-02-22T21:06:17.983
> 
> 标签：apache, .htaccess, mod-rewrite

以下是如何在博客上查看我的旧帖子地址：

```
subdomain.domain.com/view/1310/article-title/ 
```

当访问者来自谷歌的这样一个地址时，我希望它被重定向，如下所示：

```
http://www.domain.com/article-title/ 
```

我需要指定有关旧/第一个链接的一些详细信息：

*   **子域**，是一个变量
*   **view** , 是一个固定词
*   **1230**，可以是任何数字/id

我试过这个：

```
Options +FollowSymLinks
RewriteEngine On
RewriteCond %{HTTP_HOST} subdomain.domain.com $ [NC]
RewriteRule ^/view/(*)/(.*)$ http://www.domain.com/$2 [R=301,L] 
```

导致 500 大错误。

网站正在对 WordPress cms 进行裁决。

提前致谢！

* * *

在 Michael Berkowski 的回答之后添加。我目前的 wp 规则是：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:10:56.233

500 错误是（零或更多）前面没有任何限定符的`(*)`结果。`*`您可能已经打算`(.*)`，但您真正需要的是`[^/]+`让所有字符都达到下一个`/`：

```
Options +FollowSymLinks
RewriteEngine On
# Slight modification of the subdomain - must escape .
RewriteCond %{HTTP_HOST} subdomain\.domain\.com$ [NC]
# Note this may need to be ^view/ instead of ^/view
# In htaccess context the leading / should probably not be there
RewriteRule ^/view/([^/]+)/(.*)$ http://www.domain.com/$2 [R=301,L] 
```

上面专门针对`subdomain.domain.com`，但由于您指定它是可变的，因此使用它来获取所有子域，除了`www.domain.com`：

```
Options +FollowSymLinks
RewriteEngine On
# Matches all subdomains except www.
RewriteCond %{HTTP_HOST} !^www\.domain\.com$ [NC]
RewriteRule ^/view/([^/]+)/(.*)$ http://www.domain.com/$2 [R=301,L] 
```

如果做不到这一点，请发布您可能拥有的任何其他重写规则（因为您提到这是 WordPress 我希望您有其他规则），因为订单可能很重要。

### 更新合并 WordPress 规则：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

# The new rules handle the subdomain redirect...
RewriteCond %{HTTP_HOST} !^www\.domain\.com$ [NC]
RewriteRule ^view/([^/]+)/(.*)$ http://www.domain.com/$2 [R=301,L]

# After which WordPress does its internal redirection
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

# mongodb - 使用 directoryperdb 的 MongoDB 的第二个硬盘

> ID：15033169
> 
> 赞同：5
> 
> 时间：2013-02-22T21:06:31.623
> 
> 标签：mongodb, symlink

有没有人有使用经验`directoryperdb`？我找不到很多它的用法示例，我想先通过一些知识渊博的人来运行我的思维过程:)

我有一个近 TB 的数据库，并想在单独的硬盘驱动器上添加另一个。我不能把它搞砸，因为重新整合我的数据需要几个小时。

我目前有：

*   `--dbpath`作为`/home/mongo`
*   一个新的漂亮的空硬盘安装在`/hd/newhd`

我的流程如下：

1.  让我们调用现有数据库`old`和新数据库`new`。
2.  `mkdir /home/mongo/old`
3.  `mv /home/mongo/* /home/mongo/old/`
4.  符号链接`/home/mongo/new`到`/hd/newhd/newmongodb`
5.  `vim /etc/mongod.conf`~ 并设置`directoryperdb = true`
6.  重新启动 mongod 并开始将数据插入到一个名为的新数据库中`new`

这看起来好吗？它会自动识别新文件夹并正常继续吗？

* * *

Edit1：根据这个：https://groups.google.com/forum/?fromgroups=#!topic/mongodb-commits/frAjIDG08Mc[文件](https://groups.google.com/forum/?fromgroups=#!topic/mongodb-commits/frAjIDG08Mc)`mongod.lock`应该在`/home/mongo`. 日志或 _tmp 目录呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T22:05:51.470

好的，所以我冒险了，效果很好~！:)

我现在成功地将数据保存到`new`符号链接到第二个 HDD 的数据库中。

唯一的编辑是不要费心将`journal`文件夹移动到 db 子目录中，因为它只会在主目录中重新创建`--dbpath`

希望其他人会发现这篇文章很有用。

# batch-file - 如何批量检查大型txt文件中的重复项？

> ID：15033172
> 
> 赞同：0
> 
> 时间：2013-02-22T21:06:53.360
> 
> 标签：batch-file

我只需要一个方便的小工具来检查文本文件中的重复行，它会删除那些重复的。所以如果文件说：

```
A
B
C
D
A
E 
```

它会变成：

```
A
B
C
D
E 
```

很好很简单。但是文本文件将很大并且充满长文件位置，我需要确保任何文件都不超过一个。只要只剩下一个，删除哪个重复项都没有关系。所以我会接受这样的事情：

```
B
C
D
A
E 
```

这是我到目前为止所拥有的一切：

```
@echo off
SetLocal EnableDelayedExpansion
set v=0
FOR /F "usebackq delims=" %%a in ("SomeArray.txt") do (
set /a var+=1
set var!v!=%%a
)
pause 
```

我不知道从哪里开始制作循环来测试所有可能的重复项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:31:32.673

您将行存储在“数组”中的代码已损坏。您应该递增`v`而不是`var`.

检查重复项的代码很简单，但速度很慢。只需遍历现有值以查看它是否与当前行匹配。如果未找到匹配项，则仅回显并存储当前行。唯一行的数量越多，它变得越慢。

下面的脚本需要文件名作为第一个也是唯一的参数

```
@echo off
setlocal enableDelayedExpansion
set n=0
for /f "usebackq delims=" %%A in (%1) do (
  set "skip="
  for /l %%N in (1 1 !n!) do if "%%A"=="!var%%N!" set skip=1
  if not defined skip (
    echo %%A
    set /a n+=1
    set "var!n!=%%A"
  )
) 
```

如果一行以开头，则上述操作将失败，`;`因为默认的 FOR /F EOL 选项将跳过以 . 开头的行`;`。这可以通过一些尴尬的语法来解决，将 EOL 和 DELIMS 都设置为空：`usebackq^ delims^=^ eol^=`

如果任何行包含，上述操作也会失败，`!`因为延迟扩展会在扩展 FOR /F 变量时破坏行的值。这可以通过根据需要仔细启用和禁用延迟扩展来解决。

```
@echo off
setlocal disableDelayedExpansion
set n=0
for /f usebackq^ delims^=^ eol^= %%A in (%1) do (
  set "ln=%%A"
  set "skip="
  setlocal enableDelayedExpansion
  for /l %%N in (1 1 !n!) do if "!ln!"=="!var%%N!" set skip=1
  if defined skip (endlocal) else (
    echo !ln!
    set /a n+=1
    for %%N in (!n!) do (
      endlocal
      set "var%%N=%%A"
      set "n=%%N"
    )
  )
) 
```

但是有更快、更简单的解决方案。

最快和最简单的纯批处理解决方案是将行内容合并到变量的名称中。要检查重复项，只需检查变量是否已定义。

```
@echo off
setlocal

:: clear existing _ variables
for /f "eol== delims==" %%V in ('set _ 2^>nul') do set "%%V="

:: read and echo file, throw away duplicates (case insensitive)
:: does not work if line contains =
for /f usebackq^ delims^=^ eol^= %%A in (%1) do (
  if not defined _%%A (
    echo %%A
    set "_%%A=1"
  )
) 
```

上述解决方案有两个主要限制。

*   重复比较不区分大小写，因为变量名不区分大小写。

*   该解决方案将无法正确检测包含`=`因为`=`不能包含在变量名中的重复项。

我相信 rene 使用 SORT 的解决方案是最好的普遍适用的方法，虽然 rene 的代码有以下缺点

*   使用 CALL 会显着降低性能（对于大文件很明显）

*   以 开头的行`;`被跳过

*   特殊字符如`&` `|` `<` `>` `^`导致问题

*   该脚本假定只有一个空格分隔的标记

缺点很容易解决：

```
@echo off
setlocal disableDelayedExpansion
set "old="
for /f delims^=^ eol^= %%A in ('sort %1') do (
  set "new=%%A"
  setlocal enableDelayedExpansion
  if "!new!" equ "!old!" (endlocal) else (
    echo !new!
    endlocal
    set "old=%%A"
  )
) 
```

所有批处理解决方案的最大行长度限制为 ~8191 个字符。

此外，上述所有解决方案都会去除空行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:33:32.597

使用以下内容创建一个 cmd 文件 uniqeline.cmd：

```
@echo off
set prev=
for /f %%a in ('sort %1') do call :oneline %%a
goto :eof

:oneline
if NOT !%1!==!%prev%! echo %1
set prev=%1
goto :eof 
```

从命令行调用：

```
uniqeline yourfilewithfilesnames.lst 
```

# c# - 无法获得一对一的相关对象

> ID：15033173
> 
> 赞同：0
> 
> 时间：2013-02-22T21:06:54.117
> 
> 标签：c#, entity-framework

我有实体：

```
public class User
    {
        public int UserId { get; set; }
        public string UserName { get; set; }
        public string Email { get; set; }
        ...
        public virtual Profile Profile { get; set; }
        ...
public class Profile
    {
        public int UserId { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; } 
```

当我尝试获取用户时出现错误：

```
System.Data.Edm.EdmEntityType: : EntityType 'Profile' has no key defined. Define the key for this EntityType. 
```

当我将实体更改为：

```
public class User
    {
        [Key]
        public int UserId { get; set; }
        public string UserName { get; set; }
        public string Email { get; set; }
        ...
        public virtual Profile Profile { get; set; }
        ...
public class Profile
    {
        [Key]
        public int UserId { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; } 
```

我得到错误：

```
{"Invalid column name 'Profile_UserId'."} 
```

我究竟做错了什么？
![在此处输入图像描述](../Images/bf58fbf9fffa74ae60a730af24776835.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:12:14.720

根据[http://blog.bennymichielsen.be/2011/06/02/entity-framework-4-1-one-to-one-mapping/](http://blog.bennymichielsen.be/2011/06/02/entity-framework-4-1-one-to-one-mapping/)它可以工作：

```
public class User
{
        [Key]
        public int UserId { get; set; }
        public string UserName { get; set; }
        public string Email { get; set; }
        public virtual Profile Profile { get; set; }
}

public class Profile
{
        [Key]
        public int UserId { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        [Required]
        public virtual User User { get; set;}
} 
```

# python - SQLAlchemy 枚举代码表示和数据库表示

> ID：15033177
> 
> 赞同：1
> 
> 时间：2013-02-22T21:07:05.740
> 
> 标签：python, sqlalchemy

[这是对best-way-to-do-enum-in-sqlalchemy](https://stackoverflow.com/questions/2676133/best-way-to-do-enum-in-sqlalchemy)非常有趣的答案的后续。Cito 扩展了 Zzzeeks 的答案以包括非常好的排序。Cito 在结尾处还留下了一段诱人的代码。

```
class DeclEnumType(SchemaType, TypeDecorator):
    """DeclEnum augmented so that it can persist to the database.""" 
```

这正是我试图构建一个 Python 枚举，它在数据库中自己的表中表示。EmployeeType.full_time 在 Python 代码中可用*并且*在 DB 中有自己的表（对于这个简单的示例，只有一个 idx 和名称）。

但是，我不确定我是否了解如何使用 Cito 的 DeclEnumType 示例，因为以下示例不会在数据库中创建 EmployeeType 表。

```
class EmployeeType(DeclEnum):
    # order will be as stated: full_time, part_time, contractor
    full_time = EnumSymbol("Full Time")
    part_time = EnumSymbol("Part Time")
    contractor = EnumSymbol("Contractor")

class Employee(Base):
    __tablename__ = 'employee'

    id = Column(Integer, primary_key=True)
    name = Column(String(60), nullable=False)
    type = Column(DeclEnumType(EmployeeType)) 
```

关于如何获得这种双重表示的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T23:38:46.503

如果我没记错的话，这样做：

```
type = Column(EmployeeType.db_type()) 
```

代替

```
type = Column(DeclEnumType(EmployeeType)) 
```

应该这样做。

# android - CordovaWebView.loadUrl 在 javascript: URL 上超时

> ID：15033179
> 
> 赞同：0
> 
> 时间：2013-02-22T21:07:15.673
> 
> 标签：android, cordova, android-webview

我有一个包含多个 CordovaWebViews 的 Android 应用程序。（注意：我正在对一个我不太熟悉的应用程序进行维护。）各种 WebView 使用 CordovaWebView 中的 loadUrl 函数相互发送消息，并带有一个字符串**“javascript: ('toggleMenu();');”** . （toggleMenu() 函数在我的一个

我对 WebView 的布局方式进行了一些更改（添加了另一个包含滑出菜单和主视图的顶级视图），突然这些 loadUrl 调用超时：我得到了恐惧“E/CordovaWebView (2774): CordovaWebView: 超时错误！” 出现在 logcat 中的行。

**怎么会发生这种情况，因为我正在加载的 URL 是一个很小的 ​​JavaScript 片段？我应该在哪里查找此错误的原因？** 除了通知我调用已正确发送到 Android WebView 实例之外，logcat 并没有太大帮助：

```
D/NWCPanels(2774): <9956> sendMessage - HEADER; target: main
D/NWCPanels(2774): <9956> sendMessage - script:javascript:  ('toggleMenu();');
D/UiTask(2774): <1> run - url: javascript:  ('toggleMenu();');
D/WebView(2774): loadUrlImpl: called 
```

好的，电话一直传到 Android 的 WebView。有我的调试语句表明我的代码认为它有效，然后看起来它实际上是在访问 webkit：

```
D/CordovaLog(2774): - Debug - toggleMenu from header. result: true
D/webcore(2774):  CORE loadUrl: called
D/webkit(2774): Firewall not null
D/webkit(2774): euler: isUrlBlocked = false 
```

也许它正在考虑加载我的 URL，因为它没有被阻止？但是，大约 3 秒后：

```
E/CordovaWebView(2774): CordovaWebView: TIMEOUT ERROR! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-05T07:26:27.653

请使用它清除 webview catch`webView.Clearcatch()`工作正常。我也尝试过，它解决了我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T23:40:48.910

事实证明，我在问题中根本没有提到：我使用的内部框架不喜欢我格式化函数的方式。（它会进行字符串操作以找出函数的名称，而执行“var funcName = function(){}”会破坏它。）

没什么可看的，伙计们，继续前进......

# javascript - 向 SWF 播放器添加播放/暂停

> ID：15033190
> 
> 赞同：3
> 
> 时间：2013-02-22T21:08:02.313
> 
> 标签：javascript, flash

我有以下 .swf 播放器，我想向播放器对象添加更多控件，例如播放和暂停：

```
<object classid="player" width="780" height="420" codebase="[longurl]"
    classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">
    <param value="sameDomain" name="allowScriptAccess" />
    <param name="movie" value="/root/Desktop/test.swf" />
    <param name="quality" value="best" />
    <param value="true" name="controller" />
    <param name="play" value="true" />
    <param name="loop" value="true" />
    <param name="wmode" value="window" />
    <param name="scale" value="showall" />
    <param name="menu" value="true" />
    <param name="devicefont" value="false" />
    <param name="salign" value="" />
    <param name="flashvars" 
        value='config={"clip":{"url":"video.flv","autoPlay":false}}' />
    <param name="allowScriptAccess" value="sameDomain" />
</object> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:27:57.090

我不确定我们是否可以在控件中嵌入播放/暂停选项。

但是，我们可以为“播放/暂停”添加一个按钮，单击该按钮会调用一个 JavaScript 函数来为我们执行播放或暂停。

只需将 id="myVideo" 添加到您的对象标签。

```
<script>
function playPause(){
    if(document.getElementById('myVideo').paused){
        document.getElementById('myVideo').play();
    }
    else
    {document.getElementById('myVideo').pause();
    }
}
</script>

<button onclick="playPause()">PLAY/PAUSE</button>

<object id="myVideo" classid="player" width="780" height="420" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">
<param value="sameDomain" name="allowScriptAccess" />
<param name="movie" value="/root/Desktop/test.swf" />
<param name="quality" value="best" />
<param value="true" name="controller" />
<param name="play" value="true" />
<param name="loop" value="true" />
<param name="wmode" value="window" />
<param name="scale" value="showall" />
<param name="menu" value="true" />
<param name="devicefont" value="false" />
<param name="salign" value="" />
<param name="flashvars" value='config={"clip":    
{"url":"video.flv","autoPlay":false}}' />
<param name="allowScriptAccess" value="sameDomain" />
</object> 
```

# c - 选择缓冲区的大小

> ID：15033192
> 
> 赞同：8
> 
> 时间：2013-02-22T21:08:08.107
> 
> 标签：c

我很困惑，在分配内存时`malloc`必须提供大小，但是，有时您不知道此时需要的大小，因此您要么分配大量内存（这听起来不太明智的，因为您可能不会全部使用它）或者您`realloc`在初始缓冲区大小变得太小时时使用。这两个选项有效吗？第二个听起来不错，但是，文档说`realloc` `...may move the memory block to a new location`这听起来像是一个非常糟糕的主意/难以处理的情况（例如，如果您有多个指针指向同一个地址，那么当您调用`realloc`它们时它们都变得无效）我是初学者使用 C，有人可以解释我如何处理您的缓冲区可能会或可能不会增长以占用大量内存的情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T21:32:28.307

> 有时您不知道此时需要的大小，因此您要么分配大量内存（这听起来不太明智，因为您可能不会全部使用它），或者您使用 realloc 什么时候初始缓冲区大小变得太小。这两个选项有效吗？

原则上是的。实际上，对于*现代操作系统内核和默认系统配置，使用**malloc*分配多少并不重要。你看，*malloc*分配*地址空间*，而不是内存。您可以根据需要分配尽可能多的地址空间，它实际上不会消耗内存；当然，操作系统会对该值进行多次完整性检查，例如在只有 2GiB 可用内存（RAM + 交换）的系统上，您无法分配 3GiB。通常的配置是单个块中可分配的最大地址空间块是可用系统内存的 50%。

只有当您实际向其写入内容时，操作系统才会为它保留内存。所以不要使用*calloc*，因为它会初始化内存，即在其中写入一些东西。

因此，如果您不知道您究竟需要多少，只需 malloc 一大块地址空间，根据处理的数据类型的特征，您知道它很容易容纳您所期望的任何内容。一旦你把它放在内存中，你可以使用*realloc*来缩小分配。对于所有重要的实现，*realloc*在缩小分配时永远不会移动数据。

需要注意的一件事是内存过度使用：假设您有 5 个进程在具有 4GiB RAM 的系统上运行，每个进程分配 1GiB，但没有立即写入。操作系统会给他们这个地址空间，即它过度使用内存（就像航空公司过度使用航班座位一样）。一段时间后，进程开始写入它。在某些时候，系统内存不足，操作系统必须对此做点什么：它将开始杀死进程，直到再次有“呼吸”的空间。

不过，您可以关闭内存过度使用；强烈推荐用于高可靠性系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T21:12:55.027

你是对的——这几乎是你的两个选择。您可以通过抽象一点来解决“多指针”问题。如果不是`malloc`直接传递由返回的指针，而是将其粘贴到另一个数据结构中：

```
struct malloc_wrapper
{
    void *p;
} wrapper;

wrapper.p = malloc(INITIAL_SIZE); 
```

相反，传递指向该数据结构的指针，您可以随时更改`p`，并且共享指向您的新结构的指针的任何人都将相应地更新：

```
void *tmp = realloc(somepointertowrapper->p, NEW_SIZE);

/* check tmp to ensure it's not NULL. That indicates a failure
 * to realloc and the original pointer passed into realloc 
 * remains valid.
 */

somepointertowrapper->p = tmp; 
```

# php - 通过 PHP 进行浏览器渲染后，如何获取计算出的图像宽度？

> ID：15033194
> 
> 赞同：1
> 
> 时间：2013-02-22T21:08:10.307
> 
> 标签：php, javascript, rhino

我有一个获取 URL 的 HTML 内容的服务器端脚本。我需要它来获取元素（特别是图像）的计算宽度，因为如果应用了所有 CSS 属性，浏览器将呈现。可以做 qQuery 的 .width 方法所做的事情，但在 PHP 中。

有没有图书馆可以做到这一点？我听说过 Rhino，但我不确定它是否具有这种特定功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:17:55.820

在呈现某些东西的那一刻，您在 PHP 上完全无法控制它，它很简单不知道它是如何在页面上设置的。您需要做的是在 javascript 中计算它并通过 ajax 调用将该数据发送回 PHP。

# angularjs - 在 AngularJS 中的 $http 请求期间显示微调器 GIF？

> ID：15033195
> 
> 赞同：235
> 
> 时间：2013-02-22T21:08:21.327
> 
> 标签：angularjs, ajax, busyindicator

我正在使用`$http`AngularJS 的服务来发出 Ajax 请求。

执行 Ajax 请求时如何显示微调器 GIF（或其他类型的忙碌指示器）？

`ajaxstartevent`我在 AngularJS 文档中没有看到类似的东西。

* * *

## 回答 #1

> 赞同：472
> 
> 时间：2013-02-22T21:18:27.497

这实际上取决于您的特定用例，但一种简单的方法将遵循如下模式：

```
.controller('MainCtrl', function ( $scope, myService ) {
  $scope.loading = true;
  myService.get().then( function ( response ) {
    $scope.items = response.data;
  }, function ( response ) {
    // TODO: handle the error somehow
  }).finally(function() {
    // called no matter success or failure
    $scope.loading = false;
  });
}); 
```

然后在您的模板中对其做出反应：

```
<div class="spinner" ng-show="loading"></div>
<div ng-repeat="item in items>{{item.name}}</div> 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2013-04-12T17:00:59.417

**以下是~~当前~~过去的 AngularJS 咒语：**

```
angular.module('SharedServices', [])
    .config(function ($httpProvider) {
        $httpProvider.responseInterceptors.push('myHttpInterceptor');
        var spinnerFunction = function (data, headersGetter) {
            // todo start the spinner here
            //alert('start spinner');
            $('#mydiv').show();
            return data;
        };
        $httpProvider.defaults.transformRequest.push(spinnerFunction);
    })
// register the interceptor as a service, intercepts ALL angular ajax http calls
    .factory('myHttpInterceptor', function ($q, $window) {
        return function (promise) {
            return promise.then(function (response) {
                // do something on success
                // todo hide the spinner
                //alert('stop spinner');
                $('#mydiv').hide();
                return response;

            }, function (response) {
                // do something on error
                // todo hide the spinner
                //alert('stop spinner');
                $('#mydiv').hide();
                return $q.reject(response);
            });
        };
    });

//regular angular initialization continued below....
angular.module('myApp', [ 'myApp.directives', 'SharedServices']).
//....... 
```

**这是它的其余部分（HTML / CSS）......使用**

```
$('#mydiv').show(); 
$('#mydiv').hide(); 
```

**切换它。注意：以上内容在帖子开头的角度模块中使用**

```
#mydiv {  
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    z-index:1000;
    background-color:grey;
    opacity: .8;
 }

.ajax-loader {
    position: absolute;
    left: 50%;
    top: 50%;
    margin-left: -32px; /* -1 * image width / 2 */
    margin-top: -32px;  /* -1 * image height / 2 */
    display: block;     
}

<div id="mydiv">
    <img src="lib/jQuery/images/ajax-loader.gif" class="ajax-loader"/>
</div> 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2015-08-12T02:02:47.277

**这是一个使用`directive`and的版本`ng-hide`。**

**这将在通过 Angular 服务的所有**调用期间显示加载程序`$http`。

**在模板中：**

`<div class="loader" data-loading></div>`

**指示：**

```
angular.module('app')
  .directive('loading', ['$http', function ($http) {
    return {
      restrict: 'A',
      link: function (scope, element, attrs) {
        scope.isLoading = function () {
          return $http.pendingRequests.length > 0;
        };
        scope.$watch(scope.isLoading, function (value) {
          if (value) {
            element.removeClass('ng-hide');
          } else {
            element.addClass('ng-hide');
          }
        });
      }
    };
}]); 
```

通过`ng-hide`在元素上使用类，可以避免使用 jquery。

* * *

**自定义：添加一个`interceptor`**

如果您创建加载拦截器，您可以根据条件显示/隐藏加载器。

**指示：**

```
var loadingDirective = function ($rootScope) {
  return function ($scope, element, attrs) {
      $scope.$on("loader_show", function () {
          return element.removeClass('ng-hide');
      });
      return $scope.$on("loader_hide", function () {
          return element.addClass('ng-hide');
      });
  };
}; 
```

**拦截器：**

*   例如：不显示`spinner`何时`response.background === true;`
*   拦截`request`和/或`response`设置`$rootScope.$broadcast("loader_show");`或`$rootScope.$broadcast("loader_hide");`

[有关编写拦截器的更多信息](http://www.webdeveasy.com/interceptors-in-angularjs-and-useful-examples/)

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2014-09-16T16:18:38.500

如果你使用 ngResource，对象的 $resolved 属性对加载器很有用：

对于如下资源：

```
var User = $resource('/user/:id', {id:'@id'});
var user = User.get({id: 1}) 
```

您可以将加载器链接到资源对象的 $resolved 属性：

```
<div ng-hide="user.$resolved">Loading ...</div> 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2014-07-31T14:16:15.770

[https://github.com/wongatech/angular-http-loader](https://github.com/wongatech/angular-http-loader)是一个很好的项目。

这里的例子[http://wongatech.github.io/angular-http-loader/](http://wongatech.github.io/angular-http-loader/)

下面的代码显示了请求发生时的模板 example/loader.tpl.html。

```
<div ng-http-loader template="example/loader.tpl.html"></div> 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2014-07-08T10:12:55.730

刚刚发现了`angular-busy`根据一些异步调用显示一个小加载器的指令。

例如，如果你必须做一个`GET`，引用你的承诺`$scope`，

```
$scope.req = $http.get('http://google.fr'); 
```

并这样称呼它：

```
<div cg-busy="req"></div> 
```

* * *

这里是`[**GitHub**](https://github.com/cgross/angular-busy)`.

您也可以使用`bower`（不要忘记更新您的项目依赖项）安装它：

```
bower install angular-busy --save 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-07-26T02:04:19.750

对于页面加载和模式，最简单的方法是使用`ng-show`指令并使用范围数据变量之一。就像是：

```
ng-show="angular.isUndefined(scope.data.someObject)". 
```

在这里，虽然`someObject`未定义，但微调器将显示。一旦服务返回数据并被`someObject`填充，微调器将返回其隐藏状态。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-08-19T15:01:27.647

如果您将 api 调用包装在服务/工厂中，那么您可以在那里跟踪加载计数器（根据@JMaylin 的[回答](https://stackoverflow.com/a/15033322/1037948)和出色的同时建议），并通过指令引用加载计数器。或其任何组合。

## API 包装器

```
yourModule
    .factory('yourApi', ['$http', function ($http) {
        var api = {}

        //#region ------------ spinner -------------

        // ajax loading counter
        api._loading = 0;

        /**
         * Toggle check
         */
        api.isOn = function () { return api._loading > 0; }

        /**
         * Based on a configuration setting to ignore the loading spinner, update the loading counter
         * (for multiple ajax calls at one time)
         */
        api.spinner = function(delta, config) {
            // if we haven't been told to ignore the spinner, change the loading counter
            // so we can show/hide the spinner

            if (NG.isUndefined(config.spin) || config.spin) api._loading += delta;

            // don't let runaway triggers break stuff...
            if (api._loading < 0) api._loading = 0;

            console.log('spinner:', api._loading, delta);
        }
        /**
         * Track an ajax load begin, if not specifically disallowed by request configuration
         */
        api.loadBegin = function(config) {
            api.spinner(1, config);
        }
        /**
         * Track an ajax load end, if not specifically disallowed by request configuration
         */
        api.loadEnd = function (config) {
            api.spinner(-1, config);
        }

        //#endregion ------------ spinner -------------

        var baseConfig = {
            method: 'post'
            // don't need to declare `spin` here
        }

        /**
         * $http wrapper to standardize all api calls
         * @param args stuff sent to request
         * @param config $http configuration, such as url, methods, etc
         */
        var callWrapper = function(args, config) {
            var p = angular.extend(baseConfig, config); // override defaults

            // fix for 'get' vs 'post' param attachment
            if (!angular.isUndefined(args)) p[p.method == 'get' ? 'params' : 'data'] = args;

            // trigger the spinner
            api.loadBegin(p);

            // make the call, and turn of the spinner on completion
            // note: may want to use `then`/`catch` instead since `finally` has delayed completion if down-chain returns more promises
            return $http(p)['finally'](function(response) {
                api.loadEnd(response.config);
                return response;
            });
        }

        api.DoSomething = function(args) {
            // yes spinner
            return callWrapper(args, { cache: true });
        }
        api.DoSomethingInBackground = function(args) {
            // no spinner
            return callWrapper(args, { cache: true, spin: false });
        }

        // expose
        return api;
    }); 
```

## 微调指令

```
(function (NG) {
    var loaderTemplate = '<div class="ui active dimmer" data-ng-show="hasSpinner()"><div class="ui large loader"></div></div>';

    /**
     * Show/Hide spinner with ajax
     */
    function spinnerDirective($compile, api) {
        return {
            restrict: 'EA',
            link: function (scope, element) {
                // listen for api trigger
                scope.hasSpinner = api.isOn;

                // attach spinner html
                var spin = NG.element(loaderTemplate);
                $compile(spin)(scope); // bind+parse
                element.append(spin);
            }
        }
    }

    NG.module('yourModule')
        .directive('yourApiSpinner', ['$compile', 'yourApi', spinnerDirective]);
})(angular); 
```

## 用法

```
<div ng-controller="myCtrl" your-api-spinner> ... </div> 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-07-09T16:45:30.970

**我猜这是添加微调器的最简单方法：-**

您可以将 ng-show 与这些漂亮微调器中的任何一个的 div 标签一起使用 [http://tobiasahlin.com/spinkit/](http://tobiasahlin.com/spinkit/) {{这不是我的页面}}

然后你可以使用这种逻辑

```
//ajax start
    $scope.finderloader=true;

          $http({
    method :"POST",
    url : "your URL",
  data: { //your data

     }
  }).then(function mySucces(response) {
    $scope.finderloader=false;
      $scope.search=false;          
    $scope.myData =response.data.records;
  });

    //ajax end 
```

```
<div ng-show="finderloader" class=spinner></div>
//add this in your HTML at right place
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-10-03T16:15:37.840

```
Based on Josh David Miller response:

  <body>
  <header>
  </header>
<div class="spinner" ng-show="loading">
  <div class="loader" ></div>
</div>

<div ng-view=""></div>

<footer>
</footer>

</body> 
```

添加这个CSS：

```
 .loader {
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  border-bottom : 16px solid black;
  width: 80px;
  height: 80px;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
  position: absolute;
  top: 45%;
  left: 45%;
}

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.spinner{
  width: 100%;
height: 100%;
z-index: 10000;
position: absolute;
top: 0;
left: 0;
margin: 0 auto;
text-align: center;
vertical-align: middle;
background: white;
opacity: 0.6;
} 
```

就在你的角度添加：

$rootScope.loading = 假；$rootScope.loading = true; -> 当 $http.get 结束时。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-01-21T22:59:42.307

从@bulltorious 分享我的最佳答案版本，针对更新的角度构建进行了更新（我在此代码中使用了版本 1.5.8），并且还结合了@JMaylin 使用计数器的想法，以便对多个同时请求具有鲁棒性，以及跳过显示少于某个最小毫秒数的请求的动画的选项：

```
var app = angular.module('myApp');
var BUSY_DELAY = 1000; // Will not show loading graphic until 1000ms have passed and we are still waiting for responses.

app.config(function ($httpProvider) {
  $httpProvider.interceptors.push('busyHttpInterceptor');
})
  .factory('busyHttpInterceptor', ['$q', '$timeout', function ($q, $timeout) {
    var counter = 0;
    return {
      request: function (config) {
        counter += 1;
        $timeout(
          function () {
            if (counter !== 0) {
              angular.element('#busy-overlay').show();
            }
          },
          BUSY_DELAY);
        return config;
      },
      response: function (response) {
        counter -= 1;
        if (counter === 0) {
          angular.element('#busy-overlay').hide();
        }
        return response;
      },
      requestError: function (rejection) {
        counter -= 1;
        if (counter === 0) {
          angular.element('#busy-overlay').hide();
        }
        return rejection;
      },
      responseError: function (rejection) {
        counter -= 1;
        if (counter === 0) {
          angular.element('#busy-overlay').hide();
        }
        return rejection;
      }
    }
  }]); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-04-03T14:10:06.040

您可以使用角度拦截器来管理 http 请求调用

```
 <div class="loader">
    <div id="loader"></div>
  </div>

<script>
    var app = angular.module("myApp", []);

    app.factory('httpRequestInterceptor', ['$rootScope', '$location', function ($rootScope, $location) {
        return {
            request: function ($config) {
                $('.loader').show();
                return $config;
            },
            response: function ($config) {
                $('.loader').hide();
                return $config;
            },
            responseError: function (response) {
                return response;
            }
        };
    }]);

    app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider',
        function ($stateProvider, $urlRouterProvider, $httpProvider) {
            $httpProvider.interceptors.push('httpRequestInterceptor');
        }]);

</script> 
```

[https://stackoverflow.com/a/49632155/4976786](https://stackoverflow.com/a/49632155/4976786)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-07-13T13:00:59.767

## 没有拦截器或 jQuery 的简单方法

这是一种无需第三方库、拦截器或 jQuery 即可显示微调器的简单方法。

在控制器中，设置和重置一个标志。

```
function starting() {
    //ADD SPINNER
    vm.starting = true;
    $http.get(url)
      .then(function onSuccess(response) {
        vm.data = response.data;
    }).catch(function onReject(errorResponse) {
        console.log(errorResponse.status);
    }).finally(function() {
        //REMOVE SPINNER
        vm.starting = false;
    });
}; 
```

在 HTML 中，使用以下标志：

```
<div ng-show="vm.starting">
    <img ng-src="spinnerURL" />
</div>

<div ng-hide="vm.starting">
    <p>{{vm.data}}</p>
</div> 
```

该`vm.starting`标志`true`在 XHR 启动时设置，并在 XHR 完成时清除。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-07-19T06:13:53.663

这对我很有效：

HTML：

```
 <div id="loader" class="ng-hide" ng-show="req.$$state.pending">
    <img class="ajax-loader" 
         width="200" 
         height="200" 
         src="/images/spinner.gif" />
  </div> 
```

角度：

```
 $scope.req = $http.get("/admin/view/"+id).success(function(data) {          
      $scope.data = data;
  }); 
```

虽然从 $http 返回的承诺是未决的，但 ng-show 将评估它是“真实的”。一旦 promise 被解决，它就会自动更新……这正是我们想要的。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-12-23T10:45:59.000

**使用以下拦截器显示 http 请求的加载栏**

```
'use strict';
appServices.factory('authInterceptorService', ['$q', '$location', 'localStorage','$injector','$timeout', function ($q, $location, localStorage, $injector,$timeout) {

var authInterceptorServiceFactory = {};
var requestInitiated;

//start loading bar
var _startLoading = function () {
   console.log("error start loading");
   $injector.get("$ionicLoading").show();

}

//stop loading bar
var _stopLoading = function () {
    $injector.get("$ionicLoading").hide();
}

//request initiated
var _request = function (config) {
     requestInitiated = true;
    _startLoading();
    config.headers = config.headers || {};
    var authDataInitial = localStorage.get('authorizationData');
    if (authDataInitial && authDataInitial.length > 2) {
        var authData = JSON.parse(authDataInitial);
        if (authData) {
            config.headers.Authorization = 'Bearer ' + authData.token;
        }
    }
    return config;
}

//request responce error
var _responseError = function (rejection) {
   _stopLoading();
    if (rejection.status === 401) {
        $location.path('/login');
    }
    return $q.reject(rejection);
}

//request error
var _requestError = function (err) {
   _stopLoading();
   console.log('Request Error logging via interceptor');
   return err;
}

//request responce
var _response = function(response) {
    requestInitiated = false;

   // Show delay of 300ms so the popup will not appear for multiple http request
   $timeout(function() {

        if(requestInitiated) return;
        _stopLoading();
        console.log('Response received with interceptor');

    },300);

return response;
}

authInterceptorServiceFactory.request = _request;
authInterceptorServiceFactory.responseError = _responseError;
authInterceptorServiceFactory.requestError = _requestError;
authInterceptorServiceFactory.response = _response;

return authInterceptorServiceFactory;
}]); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-02-12T15:23:49.793

```
.factory('authHttpResponseInterceptor', ['$q', function ($q) {
        return {
            request: function(config) {
                angular.element('#spinner').show();
                return config;
            },
            response : function(response) {
                angular.element('#spinner').fadeOut(3000);
                return response || $q.when(response);
            },
            responseError: function(reason) {
                angular.element('#spinner').fadeOut(3000);
                return $q.reject(reason);
            }
        };
    }]);

 .config(['$routeProvider', '$locationProvider', '$translateProvider', '$httpProvider',
            function ($routeProvider, $locationProvider, $translateProvider, $httpProvider) {
                $httpProvider.interceptors.push('authHttpResponseInterceptor');
    }
]);

in your Template
<div id="spinner"></div>

css   

#spinner,
#spinner:after {
  border-radius: 50%;
  width: 10em;
  height: 10em;
  background-color: #A9A9A9;
  z-index: 10000;
  position: absolute;
  left: 50%;
  bottom: 100px;
}
@-webkit-keyframes load8 {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
@keyframes load8 {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-04-08T09:14:27.363

使用以下代码创建指令：

```
$scope.$watch($http.pendingRequests, toggleLoader);

function toggleLoader(status){
  if(status.length){
    element.addClass('active');
  } else {
    element.removeClass('active');
  }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-08-04T13:00:54.427

显示不同 url 更改之间加载的另一种解决方案是：

```
$rootScope.$on('$locationChangeStart', function() {
  $scope.loading++;
});

$rootScope.$on('$locationChangeSuccess', function() {
  $timeout(function() {
    $scope.loading--;
  }, 300);
}); 
```

然后在标记中只需使用 切换微调器`ng-show="loading"`。

如果您想在 ajax 请求上显示它，只需`$scope.loading++`在请求开始和结束时添加 add `$scope.loading--`。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-01-14T14:27:57.140

你也可以尝试这样的事情：

创建指令：

```
myApp.directive('loader', function () {
    return {
        restrict: 'A',
        scope: {cond: '=loader'},
        template: '<span ng-if="isLoading()" class="soft"><span class="fa fa-refresh fa-spin"></span></span>',
        link: function (scope) {
            scope.isLoading = function() {
                var ret = scope.cond === true || (
                        scope.cond &&
                        scope.cond.$$state &&
                        angular.isDefined(scope.cond.$$state.status) &&
                        scope.cond.$$state.status === 0
                    );
                return ret;
            }
        }
    };
}); 
```

然后你添加这样的东西到 mainCtrl

```
 // Return TRUE if some request is LOADING, else return FALSE
    $scope.isLoading = function() {
        return $http.pendingRequests.length > 0;
    }; 
```

HTML 可以是这样的：

```
<div class="buttons loader">
    <span class="icon" loader="isLoading()"></span>
</div> 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-02-25T08:55:38.653

以下方式将记录所有请求，并仅在所有请求完成后隐藏：

```
app.factory('httpRequestInterceptor', function(LoadingService, requestCount) {
    return {
        request: function(config) {
            if (!config.headers.disableLoading) {
                requestCount.increase();
                LoadingService.show();
            }
            return config;
        }
    };
}).factory('httpResponseInterceptor', function(LoadingService, $timeout, error, $q, requestCount) {
    function waitAndHide() {
        $timeout(function() {
            if (requestCount.get() === 0){
                LoadingService.hide();
            }
            else{
                waitAndHide();
            }
        }, 300);
    }

    return {
        response: function(config) {
            requestCount.descrease();
            if (requestCount.get() === 0) {
                waitAndHide();
            }
            return config;
        },
        responseError: function(config) {
            requestCount.descrease();
            if (requestCount.get() === 0) {
                waitAndHide();
            }
            var deferred = $q.defer();
            error.show(config.data, function() {
                deferred.reject(config);
            });
            return deferred.promise;
        }
    };
}).factory('requestCount', function() {
    var count = 0;
    return {
        increase: function() {
            count++;
        },
        descrease: function() {
            if (count === 0) return;
            count--;
        },
        get: function() {
            return count;
        }
    };
})
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-03-22T10:44:08.260

由于**position:fixed**的功能最近发生了变化，我很难将 gif 加载器显示在所有元素之上，所以我不得不使用 angular 的内置**jQuery**。

**html**

```
<div ng-controller="FetchController">
      <div id="spinner"></div>
</div> 
```

**CSS**

```
#spinner {display: none}
body.spinnerOn #spinner { /* body tag not necessary actually */
   display: block;
   height: 100%;
   width: 100%;
   background: rgba(207, 13, 48, 0.72) url(img/loader.gif) center center no-repeat;
   position: fixed;
   top: 0;
   left: 0;
   z-index: 9999;
}
body.spinnerOn main.content { position: static;} /* and whatever content needs to be moved below your fixed loader div */ 
```

**控制器**

```
app.controller('FetchController', ['$scope', '$http', '$templateCache', '$location', '$q',
function($scope, $http, $templateCache, $location, $q) {

angular.element('body').addClass('spinnerOn'); // add Class to body to show spinner

$http.post( // or .get(
    // your data here
})
.then(function (response) {
    console.info('success');     
    angular.element('body').removeClass('spinnerOn'); // hide spinner

    return response.data;               
}, function (response) {                   
    console.info('error'); 
    angular.element('body').removeClass('spinnerOn'); // hide spinner
});

}) 
```

希望这可以帮助 ：）

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-09-28T14:58:42.353

所有答案都是复杂的，或者需要在每个请求上设置一些变量，如果我们知道 DRY 概念，这是非常错误的做法。这里是简单的拦截器示例，我在 ajax 启动时将鼠标设置为等待，并在 ajax 结束时将其设置为自动。

```
$httpProvider.interceptors.push(function($document) {
    return {
     'request': function(config) {
         // here ajax start
         // here we can for example add some class or show somethin
         $document.find("body").css("cursor","wait");

         return config;
      },

      'response': function(response) {
         // here ajax ends
         //here we should remove classes added on request start

         $document.find("body").css("cursor","auto");

         return response;
      }
    };
  }); 
```

必须在应用程序配置中添加代码`app.config`。我展示了如何在加载状态下更改鼠标，但在那里可以显示/隐藏任何加载器内容，或者添加、删除一些显示加载器的 css 类。

拦截器将在每个 ajax 调用上运行，因此无需在每个 http 调用上创建特殊的布尔变量*（ $scope.loading=true/false 等） 。*

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-04-07T09:25:16.053

这是我的实现，就像一个 ng-show 和一个请求计数器一样简单。

它为所有对 $http 的请求使用新服务：

```
myApp.service('RqstSrv', [ '$http', '$rootScope', function($http, $rootScope) {
    var rqstService = {};

    rqstService.call = function(conf) {

        $rootScope.currentCalls = !isNaN($rootScope.currentCalls) ?  $rootScope.currentCalls++ : 0;

        $http(conf).then(function APICallSucceed(response) {
            // Handle success
        }, function APICallError(response) {
            // Handle error
        }).then(function() {
            $rootScope.currentCalls--;
        });
    }
} ]); 
```

然后你可以根据当前调用的数量使用你的加载器：

```
<img data-ng-show="currentCalls > 0" src="images/ajax-loader.gif"/> 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-04-03T14:05:43.107

如果您想为每个 http 请求调用显示加载器，那么您可以使用角度拦截器来管理 http 请求调用，

这是一个示例代码

```
<body data-ng-app="myApp">
<div class="loader">
    <div id="loader"></div>
</div>

<script>
    var app = angular.module("myApp", []);

    app.factory('httpRequestInterceptor', ['$rootScope', '$location', function ($rootScope, $location) {
        return {
            request: function ($config) {
                $('.loader').show();
                return $config;
            },
            response: function ($config) {
                $('.loader').hide();
                return $config;
            },
            responseError: function (response) {
                return response;
            }
        };
    }]);

    app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider',
        function ($stateProvider, $urlRouterProvider, $httpProvider) {
            $httpProvider.interceptors.push('httpRequestInterceptor');
        }]);

</script>
</body> 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-09-23T18:38:55.100

# 只需使用 ng-show 和布尔值

无需使用指令，无需复杂。

这是放置在提交按钮旁边或您希望微调器所在的任何位置的代码：

```
<span ng-show="dataIsLoading">
  <img src="http://www.nasa.gov/multimedia/videogallery/ajax-loader.gif" style="height:20px;"/>
</span> 
```

然后在你的控制器中：

```
$scope.dataIsLoading = true

let url = '/whatever_Your_URL_Is'
$http.get(url)
.then(function(response) {
  $scope.dataIsLoading = false
}) 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-12-04T10:02:08.630

添加到@Adam的答案，

按照建议使用 ng-show，但是，在您的情况下，您希望该功能具有多个请求并在隐藏加载程序之前等待所有请求。

```
<span ng-show="pendingRequests > 0">
    <img src="http://www.nasa.gov/multimedia/videogallery/ajax-loader.gif" style="height:20px;"/>
</span> 
```

然后在你的控制器中：

```
$scope.pendingRequests++;

let url = '/whatever_Your_URL_Is'
$http.get(url)
  .then(function(response) {
      $scope.pendingRequests--;
}) 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2015-03-26T20:21:46.173

这是我的解决方案，我觉得其他人在此处发布的解决方案要容易得多。虽然不确定它有多“漂亮”，但它解决了我所有的问题

我有一个名为“加载”的 CSS 样式

```
.loading { display: none; } 
```

加载 div 的 html 可以是任何内容，但我使用了一些 FontAwesome 图标和 spin 方法：

```
<div style="text-align:center" ng-class="{ 'loading': !loading }">
    <br />
    <h1><i class="fa fa-refresh fa-spin"></i> Loading data</h1>
</div> 
```

在要隐藏的元素上，只需编写以下代码：

```
<something ng-class="{ 'loading': loading }" class="loading"></something> 
```

在函数中我只是在加载时设置它。

```
(function (angular) {
    function MainController($scope) {
        $scope.loading = true 
```

我正在使用 SignalR，所以在 hubProxy.client.allLocks 函数中（当它完成通过锁时）我把

```
 $scope.loading = false
 $scope.$apply(); 
```

这也会在页面加载时隐藏 {{someField}}，因为我在加载时设置加载类，然后 AngularJS 将其删除。

# javascript - 使用 JavaScript 检查字符串是否包含日文字符（包括汉字）

> ID：15033196
> 
> 赞同：27
> 
> 时间：2013-02-22T21:08:22.623
> 
> 标签：javascript, regex, string

如何检查给定字符串是否包含一个或多个日文字符（由假名和/或汉字组成）？

我在这里看到了一个类似的问题：[如何检查变量是否包含中文/日文字符？](https://stackoverflow.com/questions/11206443/how-can-i-check-if-variable-contains-chinese-japanese-characters)，我使用了解决方案来提出这个：

```
var containsJapanese = string.match(/[\u3400-\u9FBF]/); 
```

但是，这会产生许多误报。

我已经通过让脚本遍历整个网页的内容（例如 Facebook、Stack Overflow 等）并标记应该包含日语文本的 div 来测试它。在这些情况下，大量的 div 最终会被错误地标记。我还在包含日文文本的页面上对其进行了测试，*那里*的日文 div 最终与许多错误标记的 div 一起被正确标记。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-02-22T22:53:30.863

检查这是否有效。我发现[这个网站](http://www.rikai.com/library/kanjitables/kanji_codes.unicode.shtml)似乎列出了所有可能在日语文本中使用的 Unicode 字符。

相应的正则表达式（对于单个字符）将是：

```
/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/
  -------------_____________-------------_____________-------------_____________
   Punctuation   Hiragana     Katakana    Full-width       CJK      CJK Ext. A
                                            Roman/      (Common &      (Rare)    
                                          Half-width    Uncommon)
                                           Katakana 
```

范围是（引自网站）：

*   `3000 - 303f`: 日式标点符号
*   `3040 - 309f`: 平假名
*   `30a0 - 30ff`: 片假名
*   `ff00 - ff9f`: 全角罗马字符和半角片假名
*   `4e00 - 9faf`: 中日韩统一表意文字 - 常见和不常见的汉字
*   `3400 - 4dbf`: 中日韩统一表意文字扩展 A - 稀有汉字

我稍微改变了范围：

*   对于*全角罗马字符和半角片假名，*我已经从 更改`ff00 - ffef`为。来自的代码点包含韩文半角字符，这不是您想要的。您可能想从 重新添加代码点，但它们大多是半角标点符号或全角货币符号。`ff00 - ff9f`*`ffa0 - ffdc``ffe0 - ffef`*

 *您可以检查该站点并取消您不想要的任何范围，或者确保它不会出现在您的输入中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:54:21.037

使用 charCode 函数检测日语。例如，（来自网站[http://www.jpf.go.jp/j/index.html](http://www.jpf.go.jp/j/index.html)）

```
 var a=$('a[href$="culture/new/index.html"]').text();
  a=a+'K';
 for(i=0;i<3;i++){ //3 as i knew it was length 3\. Please use string.length
    console.log(a.charCodeAt(i));
   //Detect the charCode here and use break on match
 }

 Output : 19968 35239 75 
```*

# android-intent - finish() and bitmap memory management

> ID：15033205
> 
> 赞同：0
> 
> 时间：2013-02-22T21:09:11.300
> 
> 标签：android-intent, android-image

I have been struggling with bitmap memory management when transitioning from one activity to another. I have found the two biggest helps are: (1) keep track of all the bitmaps in the fragment or activity in an array and then nulling the array at onPause() and (2) calling finish() on my current activity when I transition to another activity.

But with finish() I lose all my previous state information.

Does anyone know what finish() is doing for my bitmap memory management that nulling my bitmaps would not do?

I would like to manually do whatever it is that finish() is doing to clear up my memory. Here is my "clearBitmap" code I use to null the bitmaps:

```
public void onPause()  {
    super.onPause();
    clearBitmaps();
    System.gc();        
}  

public void clearBitmaps()  {       
    if (bitmapArray!=null) {
        for (int i=0; i<bitmapArray.length; i++)  {
            if (bitmapArray[i]!=null)  {
                bitmapArray[i].recycle();
                bitmapArray[i] = null;  
            }                           
        }
        bitmapArray = null;
    }       
} 
```

I tried calling the clearBitmap() method in lieu of finish() but it didn't do any good.

By the way, I am efficiently loading the bitmaps and doing all the other tricks that Android tells me to do for Bitmap management, but still have this problem. I find this issue baffling because I am not using a lot of bitmaps. But if I transition back and forth between activities about 40 times it always crashes (it used to be 6 times, so I have made significant progress with the methods above).

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T02:54:56.120

这并不是我自己问题的真正答案，但我最终调用 onBackPressed() 来处理内存管理问题并保留我的状态信息。

# javascript - how do i pass document.getElementById("someid") on click event

> ID：15033206
> 
> 赞同：-2
> 
> 时间：2013-02-22T21:09:19.253
> 
> 标签：javascript, jquery, jquery-ui, javascript-events

I am sorry, I am new to javascript.

I want to pass an id selector as a parameter on click event as follows :

i tried :

```
<button onclick="mycustomfunction(document.getElementById('someTextId'))"/> 
```

and using jquery :

```
<button onclick="mycustomfunction($('#someTextId').val())"/> 

mycustomfunction(control)
{
// do something with the control
} 
```

can someone please help me to understand where I am going wrong ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:15:07.167

您尝试获得的值与被按下的按钮无关。只需从按钮中完全删除该引用并执行以下操作：

```
<button onclick="mycustomfunction()"/> 
<script>
function myscustomfunction() {
    var val = $('#someTextId').val(); // must be an input field for val() to work otherwise use html() or text()
    // do other stuff
}
</script> 
```

或者如果你真的想让它对 jQuery 更友好：

```
<button id="cool_button" /> 
<script>
$('#cool_button').click(function() {
    var val = $('#someTextId').val(); // must be an input field for val() to work otherwise use html() or text()
    // do other stuff
});
</script> 
```

您会发现 jQuery 的优点之一是，如果操作得当，您可以开始从 HTML 结构中删除事件处理程序逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:11:54.370

do the `document.getElementById()` call inside the event handler function and pass in the id string

```
<button onclick="mycustomfunction('someTextId')"/> 

function mycustomfunction(controlId) {
    var control = document.getElementById(controlId);

    // now work with control
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T21:12:07.700

`<button onclick="mycustomfunction($('#someTextId').val())"/>` - this will pass the value. You end up with a string.

`<button onclick="mycustomfunction(document.getElementById('someTextId'))"/>` - this will pass an object reverence to the DOM element. From here you could do:

```
mycustomfunction(element) {
    alert(element.value)
} 
```

# php - 如何在 wordpress functions.php 中检测 post_format

> ID：15033214
> 
> 赞同：0
> 
> 时间：2013-02-22T21:10:08.210
> 
> 标签：php, wordpress

如何检测函数中当前帖子的 post_format 以启动特定的帖子脚本？

```
if (has_post_format( 'gallery' )){
    echo 'testing 123';
} 
```

我在我的functions.php中尝试过，在设置为画廊的帖子上，没有任何反应。如果我将 echo 行放在 if 之外，它会显示在每一页的顶部（如预期的那样），为什么 has_post_format 不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:23:40.043

如果您没有提供作为第二个参数的 POST_ID，has_post_format() 只会在循环内工作。如果您不在循环内，则必须发送 post_id。

由于您是从functions.php 执行此操作，因此您需要以某种方式检索postID。在这种情况下，我们可以根据 URL 进行操作。所以，

```
$url = explode('?', 'http://'.$_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"]);
$postID = url_to_postid($url[0]); 
```

现在你可以像这样进行比较

```
has_post_format('gallery', $postID) { /** do your thing **/ } 
```

# java - Java Game freezes at fighting

> ID：15033216
> 
> 赞同：-1
> 
> 时间：2013-02-22T21:10:11.627
> 
> 标签：java, swing, paint, freeze, paintcomponent

i'm just programming a java game and what i want to do is that when i press space, the character goes into fight mode for 5 sec and then release it. i already have done, that i press one time, fight mode gets enabled and when i press another time, its getting released but when i try it like this (code at bottom) the game just freezes for 5 sec but nothing happens and i don't even get a error code.

```
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Toolkit;
import javax.swing.JPanel;

public class Zeichnen extends JPanel {

    int x = 10;
    int y = 335;
    int width = 100;
    int height = 106;
    int speed = 10;
    boolean left = false;
    boolean fight = false;
    String file = "res/character.png";
    Image character;

    public void paint(Graphics g) {
        super.paintComponent(g);
        character = Toolkit.getDefaultToolkit().getImage(file);
        g.drawImage(character, x, y, width, height, this);
    }

    public void moveLeft() {
        if (left == false) {
            left = true;
            if (fight == true) {
                x = x + 129;
                width = -129;
            } else if (fight == false) {
                x = x + 100;
                width = -100;
            }
        }
        x = x - speed;
        rand();
        repaint();
    }

    public void moveRight() {
        if (left == true) {
            left = false;
            if (fight == true) {
                x = x - 129;
                width = 129;
            } else if (fight == false) {
                x = x - 100;
                width = 100;
            }
        }
        x = x + speed;
        rand();
        repaint();
    }

    public void moveUp() {
        y = y - speed;
        repaint();
    }

    public void moveDown() {
        y = y + speed;
        repaint();
    }

    public void fight() {
        long curTime = System.currentTimeMillis();
        fight = true;
        file = "res/character_fight.png";
        if (left == true) {
            width = -129;
        } else if (left == false) {
            width = 129;
        }
        repaint();
        if (System.currentTimeMillis() > curTime + 5000) {
            fight = false;
            file = "res/character.png";
            if (left == true) {
                width = -100;
            } else if (left == false) {
                width = 100;
            }
            repaint();
        }
    }

    public void rand() {
        if (x <= -130) {
            x = 770;
        } else if (x >= 770) {
            x = -130;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:14:14.877

`paint`应该遵守链式机制，您应该覆盖而`paintComponent`不是`paint`. 绘画时也不要加载图像，`JPanel`在初始化时加载它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:27:51.363

我不明白你的问题，你想按下一个键，你的角色形象改变 5 秒？在这种情况下，您应该实现一个侦听器，然后打开一个计时器来安排一个计时器任务

```
TimerTask task = new TimerTask()  {
        @Override
        public void run() {
            //reset your character to normal state
            }
        }
};
new Timer().schedule(task, 5000); 
```

# ios - 目标 C 中的不完整实现警告

> ID：15033217
> 
> 赞同：0
> 
> 时间：2013-02-22T21:10:13.810
> 
> 标签：ios, objective-c, object

我看过其他帖子，但我不确定他们在说什么。我刚开始 Xcode，它对我来说是新的。警告只是说“语义问题不完整的实现”

```
#import <Foundation/Foundation.h>
#import "classOne.h"

@implementation classOne    <------ this is where I get the Warning

-(void) print
{
    NSLog(@"I am %i years old, and weigh %i lbs.", age, weight);
}

-(void) setAge:(int) a
{
    age = a;
}

-(void) setWeight: (int) w
{
    weight = w;
}
@end 
```

那么.h文件如下：

```
#import <Foundation/Foundation.h>

@interface classOne : NSObject {

    int age;
    int weight;

} //Person: NSObject

-(void) print;
-(void) setAge: (int) a;   //same as  void setAge(int a);
-(void) setWight: (int) w;  //same as  void setWeight(int a);
@end 
```

* * *

主文件如下：

```
#import <Foundation/Foundation.h>
#import "classOne.h"

int main(int argc, const char * argv[])
{

@autoreleasepool {
    classOne *Trenton;

    Trenton = [classOne alloc]; //reserves memory for the object Trenton
    Trenton = [Trenton init];   //initalizes the object

    [Trenton setAge: 25];
    [Trenton setWight: 230];
    [Trenton print];
    //[Trenton release]; //release frees any memory we borrowed from alloc
}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:12:09.887

在 Xcode 中，在左侧边栏的警告选项卡中找到警告（它是左起第四个图标，看起来像 的那个`/!\`），然后单击它旁边的小三角形。它将列出所有缺少的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:24:27.753

您需要在`@interface`和 中拼写相同的方法`@implementation`。看起来你忘记`e`了`setWeight:`

```
 -(void) setWight: (int) w;  //same as  void setWeight(int a); 
```

编译器警告您，因为根据您`@interface`声明中的这个拼写错误，它期望您实现一个名为 的方法`setWight:`，但您已经实现了`setWeight:`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:19:45.393

您的接口要么具有在实现中不存在的接口中定义的方法，要么您的接口已声明它实现了一个协议，该协议具有必需的方法，而您尚未在实现文件中实现它们。

# android - Android 4.2.2 adb can't find devices

> ID：15033218
> 
> 赞同：19
> 
> 时间：2013-02-22T21:10:18.363
> 
> 标签：android, adb, nexus-7

With the new update to 4.2.2 to my Galaxy Nexus and Nexus 7, I can't find both my devices under `adb`.

These are the steps I took:

*   Updated to 4.2.2
*   Updated ADT and SDK through the SDK Manager
*   Checked ADB version, it's at 1.0.31
*   Restarted PC and Tablet and Phone numerous times

When I run `adb devices`, it's just blank. I have the same issue on Windows 8 and on Ubuntu 12.10, but on Ubuntu it shows my device and it says `offline`.

Are there any other steps I can take?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-22T21:15:08.787

来自[adb 文档](http://developer.android.com/tools/help/adb.html)

> 当您将运行 Android 4.2.2 或更高版本的设备连接到您的计算机时，系统会显示一个对话框，询问是否接受允许通过此计算机进行调试的 RSA 密钥。这种安全机制可以保护用户设备，因为它确保无法执行 USB 调试和其他 adb 命令，除非您能够解锁设备并确认对话框。这要求您具有 adb 版本 1.0.31（适用于 SDK Platform-tools r16.0.1 及更高版本）才能在运行 Android 4.2.2 或更高版本的设备上进行调试

所以，拔掉插头，等待，重新插入电缆，然后点击确定（在设备上出现的模式对话框中）

如果您点击取消，设备将通过以下方式显示为离线`adb devices`

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-22T21:18:14.740

尝试为您的设备预先安装驱动程序。确保在 Windows 下，您的设备首先在系统控制面板中被识别。

我使用的是 Windows 7，并且在插入设备驱动程序之前，系统无法识别我的 Galaxy Nexus。根据评论，这也适用于 Windows 8。

Galaxy Nexus 驱动程序

*   [http://www.samsung.com/us/support/owners/product/SCH-I515MSAVZW#](http://www.samsung.com/us/support/owners/product/SCH-I515MSAVZW#)
*   转到手册和驱动程序 > 软件

连结 7

*   [http://support.asus.com/Download.aspx?SLanguage=en&m=Nexus+7&p=28&s=2](http://support.asus.com/Download.aspx?SLanguage=en&m=Nexus+7&p=28&s=2)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-05-30T19:05:17.627

尽管我分享了我的经验，但我有 -

*   拔下并重新插入设备
*   安装了正确的平台工具
*   安装了正确的 Android 网桥打开和关闭 USB 调试以及打开和关闭...
*   尝试了WiFi，但它说它离线
*   等等等等

为我解决的问题是将设备连接从大容量存储更改为 MTP。为此，请在拔下电话的情况下进入 -

> “设置”->“存储”->*点击菜单按钮*->“USB电脑连接”->“媒体设备（MTP）”

希望这可以帮助一些人发疯！

谢谢，

灰。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-14T15:08:15.567

这是我所做的（Galaxy S4 4.2.2）：

*   转到设置=>关于此设备=>点击“版本号”几次，也就是说“JDQ39.I9505XXBHYTGKDD”（不是android版本或其他任何东西）；在这里你会看到谷歌或三星有很多幽默，因为你必须点击多次，直到吐司显示“你只需点击几下就可以成为开发者”；在点击 10 次之后，您可以祝酒“您是开发人员”

*   转到“开发选项”（在“更多”选项卡（设置菜单的 rigjt 选项卡）中）；确保选中“USB 调试”。

它有效！Eclipse 可以看到您的 S4（或任何其他设备）4.2.2 ！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-21T01:46:52.247

adb 等待设备

为我工作。只需拔下您的 USB 设备，运行此命令，然后在等待时，插入您的设备，然后它就可以工作了。:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-01T17:19:12.730

我尝试了这里和其他帖子中提到的所有内容。不是电缆、USB 端口、重新启动 PC 或 Nexus 7、杀死并启动 adb 或启用/禁用 USB 调试。

这是由于 4.2.2 OTA 更新，我只是替换了 \platform-tools\ 文件夹，如下所述：[Android ADB device offline, can't issue commands](https://stackoverflow.com/questions/14993855/android-adb-device-offline-cant-issue-commands)

下载更新的平台工具：http: [//dl.google.com/android/repository/platform-tools_r16.0.1-windows.zip](http://dl.google.com/android/repository/platform-tools_r16.0.1-windows.zip)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-08T15:51:48.063

我今天遇到了这个问题，并通过重新启动 Tab2 来修复它，同时将其插入笔记本电脑/eclipse

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-11T06:09:32.537

我在 cm10.1 nightly build on droid bionic 上使用的解决方案是在更新最新的 USB 驱动程序后，使用大容量存储选项（而不是用于 USB 计算机连接的 MTP 选项），然后在开发人员选项中取消选中并重新选中，“ADB over network “ 选项。然后它做了 RSA 弹出对话框。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-03T22:15:31.747

您可以使用旧版本的 adb.exe。更新平台工具。您可能还必须设置 adb.exe 的新路径。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-05-28T11:22:56.373

转到开发人员选项并检查 USB 调试为我解决了它

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-27T04:24:43.013

检查你是否在 Ubuntu 中安装了 android-adb-tools。如果这样做，adb 工具可能已经过时了。卸载您使用 ADB 插件下载的最新 adb 工具并为其创建别名。要检查 adb 版本，请执行“adb 版本”，如果它是 1.0.29 是旧版本，最新且适用于 Android 4.2.2 的是 1.0.31。

我做了很多东西，直到我意识到这一点。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-03-21T19:54:24.563

万一它帮助其他人到达这里，我在中兴手机上遇到了这个问题。

我尝试根据[此处](http://developer.android.com/tools/extras/oem-usb.html)的官方列表安装驱动程序，但在设备管理器中，驱动程序被标记为未正确安装。

最后，我发现完成这项工作的方法是：

1.  按菜单按钮
2.  选择“连接到电脑”
3.  选择“默认连接类型”
4.  选择“安装驱动程序”
5.  插入手机并在 PC 上选择安装驱动程序的选项
6.  然后将“默认连接类型”更改为“PC软件”

这样做之后，我能够做到：

```
adb kill-server
adb start-server
adb devices 
```

并查看我的设备。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-06-30T16:53:21.367

对我来说，最好的解决方案是：

通过 SDK-Manager 更新 Android SDK。删除我的 usr 目录（Windows 7）中的“.android”文件夹并重新插入设备。由于 ADB RSA 密钥问题，工作完美。我有一个旧版本的 ADB，我把它藏在 c:\windows\system32\ 中，因为我不想在我想要的只是一个命令提示符时安装整个畸形 SDK。不错的谷歌，新的微软。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-03-23T06:27:22.900

它在使用 Android 4.4.2 的 Windows 8 上运行

重置手机，

*   转到设置->关于手机->七次点击内部版本号。
*   返回并转到开发人员选项检查USB调试。
*   转到 Windows 8 开始菜单单击个人资料图片，然后单击更改个人资料图片。

选择设备并通过计量连接下载。通过电缆连接您的手机并等待您的 PC。

# c++ - Reader-writer lock with condition variable

> ID：15033220
> 
> 赞同：0
> 
> 时间：2013-02-22T21:10:28.387
> 
> 标签：c++, condition-variable, readerwriterlock

I find neither boost nor tbb library's condition variable has the interface of working with reader-writer lock (ie. shared mutex in boost). condition_variable::wait() only accepts mutex lock. But I think it's quite reasonable to have it work with reader-writer lock. Can anyone tell me the reason why they don't support that, or why people don't do that?

Thanks, Cui

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:19:15.183

底层平台的原生线程 API 可能无法轻松支持它。例如，在 POSIX 平台上，条件变量是根据`pthread_cond_t`它实现的，只能与`pthread_mutex_t`. 为了获得最大的性能，基本条件变量类型是原生类型的轻量级包装器，没有额外的开销。

如果您想使用其他类型的互斥锁，您应该使用`std::condition_variable_any`or `boost::condition_variable_any`，它适用于任何类型的互斥锁。由于除了用户提供的互斥锁之外，还使用了本机平台类型的内部互斥锁，因此这会产生少量额外开销。（我不知道 TBB 是否提供等效类型。）

这是一种设计权衡，允许性能或灵活性。如果您想要获得最大性能，您可以使用它，`condition_variable`但只能使用简单的互斥锁。如果你想要更多的灵活性，你可以得到它，`condition_variable_any`但你必须牺牲一点性能。

# javascript - Chrome specific flash repaint youtube video api

> ID：15033221
> 
> 赞同：0
> 
> 时间：2013-02-22T21:10:32.177
> 
> 标签：javascript, css, google-chrome, twitter-bootstrap, youtube-javascript-api

I am using the youtube api to create a flash video inside of a twitter bootstrap modal. It works fine in all browsers except in chrome. After closing the modal and hovering over buttons or images fragments of the video appear in there place. I tried changing wmodes, opacity, visibility. I can't post a link because it's a client project that is in development. Does anyone have any experience with this? Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:56:15.397

用于引导模式的默认 css3 转换属性导致了重绘问题。删除转换后，不再发生这种情况。

# python - OAuth2.0 authentication in Google App Engine

> ID：15033223
> 
> 赞同：0
> 
> 时间：2013-02-22T21:10:35.310
> 
> 标签：python, google-app-engine, oauth, oauth-2.0, raspberry-pi

I've managed to implement the [simpleauth](http://code.google.com/p/gae-simpleauth/) package for a basic webapp I've been working on. I now need to send data to this service from a python script running on a Raspberry Pi (the app is a "data logger" for temperature). Before I had implemented the simpleauth package, I could just POST the data and username to the site. Alas, now the response is the login page (to be expected).

If I wanted to connect to this webapp from the command line, I assume I'll need to authenticate myself. However, how would I go about doing this? I assume I'm going to need to programmatically replicate the steps taken by the browser to get a token but [I think I've tried this](http://pastebin.com/uPYMSKee) and it hasn't worked. I'm not even sure who my token provider is - my webapp, or Google?

Any tips?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:34:19.173

如果您尝试在已安装或控制台应用程序上进行身份验证，则需要在将用户重定向到登录/授权页面时`urn:ietf:wg:oauth:2.0:oob`用作参数。`redirect_uri` `GET`一旦您的应用获得授权，他们将在文本框中看到有效的 OAuth 2.0 代码，他们必须将其复制/粘贴到您的应用中。一旦他们这样做了，那么您的应用程序必须遵循通常的服务器端流程的其余部分（用于令牌交换的代码等）。

# sql-server-2008 - table-valued function, returning no value?

> ID：15033224
> 
> 赞同：0
> 
> 时间：2013-02-22T21:10:36.993
> 
> 标签：sql-server-2008, table-valued-parameters

this is my function:

```
create function ReservationByClient (@reservation_ID int)
returns table
as

    return(
    select 
    c.client_name,
    c.client_surname,
    c.client_passport,
    r.aptID,
    r.start_date,
    r.end_date,
    r.confirmation
    from tblClient c 
    inner join  tblReservation r on r.client_ID=c.client_ID
    where r.reservation_ID=@reservation_ID) 
```

when invoked with:

```
select * from dbo.ReservationByClient (602) 
```

it returns only column names and no values in it even there are existing records in both tables, eg. there are three reservations for the same client.

one more question: can i get results only for confirmed reservations (field confirmed is bit type)

thanks

# iphone - Show Unnecessary "0" inputs

> ID：15033225
> 
> 赞同：0
> 
> 时间：2013-02-22T21:10:37.977
> 
> 标签：iphone, xcode, zero, decimalformat

I am building a calculator and have run into a problem with displaying unnecessary 0's (it isn't displaying them and I want it to be).

An example of what it does now is as follows. [Represents Calculator Screen]

[Blank Calculator Screen]

User hits "4"

[4]

User hits "."

[4]

User hits "0"

[4]

User hits "0"

[4]

User hits "5"

[4.005]

**Instead, I want to make it do the following:**

[Blank Calculator Screen]

User hits "4"

[4]

User hits "."

[4.]

User hits "0"

[4.0]

User hits "0"

[4.00]

User hits "5"

[4.005]

I use a number formatter as shown below...

```
 formatter = [[NSNumberFormatter alloc] init];
     formatter.numberStyle = NSNumberFormatterDecimalStyle;
     formatter.maximumIntegerDigits = 13;
     formatter.minimumFractionDigits = 0;
     formatter.maximumFractionDigits = 13;
     formatter.maximumSignificantDigits = 13;
     formatter.usesGroupingSeparator = YES;
     formatter.groupingSeparator = @",";
     formatter.decimalSeparator = @".";
     formatter.generatesDecimalNumbers = true; 
```

I use the following to call my numbers...

```
 buttonScreen.text = [formatter stringFromNumber:
 [NSNumber numberWithDouble:currentNumber]] 
```

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:13:49.033

它没有给您零，因为 4 是 4、4.0、4.00 等的精确浮点表示。我建议您将用户输入存储到 a中，然后在需要进行实际数学运算时`NSString *`将其转换为 a 。`NSNumber`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:15:16.317

您可以通过在“=”或按下操作键之前不评估输入来解决此问题。

一旦输入完成，您只需添加到字符串并将字符串转换为正确的数字，您知道这是因为按下了不同的键。

# vim - LaTeX editors with VIM like commands

> ID：15033236
> 
> 赞同：3
> 
> 时间：2013-02-22T21:11:37.463
> 
> 标签：vim, latex

I have recently grown fond of VIM for simple scripts now that I know how to use it a little bit. (thanks VIM adventures!!!)

Is there a LaTeX editor out there with vim-like commands? Having the toolbar of Winedt with the VIM commands to move around the text and replace/substitute things would be great.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:18:23.070

有[vim-latex](https://github.com/jcf/vim-latex)可以为 Vim 添加 LaTeX 支持，如果这是您正在寻找的。

我建议使用[Vundle](https://github.com/gmarik/vundle)安装它。

# java - 使用本地电话调制解调器作为短信网关从 php 发送短信

> ID：15033250
> 
> 赞同：1
> 
> 时间：2013-02-22T21:12:26.670
> 
> 标签：java, php, ruby, sms, sms-gateway

有没有办法使用连接到 pc 的本地手机从 php web 应用程序发送短信？

我知道它可以通过外部网关来完成，但不幸的是我的 php 项目是基于离线的。所以我想知道是否有任何方法可以在不需要互联网连接的情况下做到这一点。

我用谷歌搜索了很多，发现有几个用于 java 的 lib，如[serial-comm](http://code.google.com/p/serial-comm/)和[smslib](http://code.google.com/p/smslib/)，但可以使用 php 吗？

我在 Windows 上使用 xampp 在本地网络上托管我的 Web 应用程序

```
Apache 2.4.3
MySQL 5.5.27
PHP 5.4.7
phpMyAdmin 3.5.2.2
FileZilla FTP Server 0.9.41
Tomcat 7.0.30 (with mod_proxy_ajp as connector)
Strawberry Perl 5.16.1.1 Portable 
```

我的项目基于 php5-Codeigniter-doctrine orm-mysql-mysqlite

如果它不能使用 php 完成，**我可以用其他编程语言**（ror、java web 等）编写一个帮助程序，这将有助于连接的 sms 网关和 web 应用程序之间的通信，而对我的网络设置的干扰最小？

也有人可以解释一下可以用作短信网关的电话标准吗？

注意：我的客户短信流量每天/每个本地网络/每个调制解调器最多不会超过 50 条短信。

我在网上找到的关于这个主题的最佳资源之一是这里[http://www.developershome.com/sms/howToSendSMSFromPC.asp](http://www.developershome.com/sms/howToSendSMSFromPC.asp)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-20T23:17:09.937

您可以使用 php 发送短信，但您必须设置短信网关服务器。然后，您可以向该 URL 发布/获取请求以发送短信。现在短信网关服务器应该有一个GSM调制解调器或手机连接。

**所以要求是** 带有 GMS 调制解调器/移动电话的 SMS 网关。服务器上的 URL，您可以发送请求

# java - java中有没有更好的混淆器？

> ID：15033256
> 
> 赞同：-1
> 
> 时间：2013-02-22T21:13:01.287
> 
> 标签：java

我正在寻找 java 的混淆器。找到一个，proguard。当我使用 jad 反编译时，这只能工作到一个级别，所有代码都是可见的。只有方法名和一些变量名被重命名，其余的都是可见的。有没有更好的混淆器无法从中获取源代码？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:20:44.387

只要您处理软件，您所能做的就是使源代码的检索更加困难。在 Java 中，您几乎总是能够从类文件中获得可读性很强的源代码。在编译成机器代码的应用程序中，您可能会得到更糟糕的结果，但想要得到它的人仍然能够检索到信息。即使您用 C 语言编写软件、编译并将其烧录到微控制器中，也可能有些人急于检索二进制程序并对其进行反编译。

老实说，如果您想减慢成功的反编译速度（这就是您所能实现的全部），请尝试找到使调试主动部署的应用程序对您来说最痛苦的混淆器。因为，如果你混淆了，调试和维护也可能会非常缓慢。

# php - 如何将选定的选项插入数据库

> ID：15033257
> 
> 赞同：2
> 
> 时间：2013-02-22T21:13:14.190
> 
> 标签：php, mysql

我正在为网站构建一个基于 php 的测验。我是初学者。我编写了从数据库中获取问题和选项的代码，并将它们显示在我的页面中。当用户选择选项时，我希望将答案插入到我的数据库中。我写了一些基本代码，但它不起作用请帮助。这是我的代码问题表有 7rows(qid,question,optiona,optionb,optionc,optiond,answeroption)，答案表有 simple2rows(qid,answer)

```
 if(isset($_POST['next']))
{
    $a=$_POST['a'];
}
if(!isset($a))
{
    $a=0;
}
include('connection.php');
mysql_query("INSERT INTO answers (username,qid, option)
VALUES ($username,a-1,'$_POST('option'))");

$sql1="SELECT * FROM exam1  LIMIT 1 OFFSET $a";
$result=mysql_query($sql1);
echo "<form method='post' action='quiz.php'>";
while ($row = mysql_fetch_array($result))
{
    echo $row['question']. "<br/>";
    echo "<input type='radio' value='optiona' name='option'>" .$row['optiona'];
    echo "<input type='radio' value='optionb' name='option'>" .$row['optionb'];
    echo "<input type='radio' value='optionc' name='option'>" .$row['optionc'];
    echo "<input type='radio' value='optiond' name='option'>" .$row['optiond']; "<br/>";
}
$c=$a-1;
$b=$a+1;
echo "<input type='hidden' value='$c' name='a'>";
echo "<input type='submit' name='previous' value='previous'> ";
echo "<input type='hidden' value='$b' name='a'>";
echo "<input type='submit' name='next' value='next'> ";
echo "<input type='reset' name='reset' value='Reset'>";
echo "</form>"; 
```

?>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:17:01.867

您需要学习基本的 PHP 语法。`$_POST`不是函数。这是[一个数组](http://php.net/manual/en/reserved.variables.post.php)。例如

```
$var = $_POST['var'];
             ^--   ^--- note the bracketing. 
```

即使代码 DID 工作，您也会很容易受到[SQL 注入攻击](http://bobby-tables.com)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:37:16.423

大大大大关注！我希望这只是一个测试代码注释最后一个！

您的代码在这里很容易被注入`$a=$_POST['a'];`

我建议用这个替换`$a= filter_input(INPUT_POST, 'a', FILTER_SANITIZE_STRING);` 这是一个逃脱攻击的！

我希望它对你有帮助

# media - 使用 Meteor 访问离线客户端媒体存储的最佳方式是什么？

> ID：15033268
> 
> 赞同：2
> 
> 时间：2013-02-22T21:14:06.213
> 
> 标签：media, meteor, offline

我不确定客户端的 mongolitedb 持久性生命周期。是否可以在其中存储二进制数据并稍后在 html 中引用？或者也许最好的方法是通过 localstorage 使用 html5 持久性。有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:05:43.653

amplify 包为 localStorage 提供了一个很好的接口。Minimongo 不会在客户端上保留任何内容。它只存储在内存中。如果你想在本地存储中保留一些文档，你现在需要自己做。

# javascript - 更新画布样式

> ID：15033274
> 
> 赞同：2
> 
> 时间：2013-02-22T21:14:40.227
> 
> 标签：javascript, jquery, html, css, canvas

所以我有一些基本的画布和一个`<input type="color">`我想改变颜色的某个形状`on change`的颜色。

这是我的代码

```
var colorRect = '#000';

var ball = document.getElementById("canvas");
var ctx = ball.getContext("2d");
var ctx1 = ball.getContext("2d");
ctx1.fillStyle = colorRect;
ctx1.fillRect(0,0,200,200);
ctx1.save();

//Left eye
ctx.fillStyle = '#fff';
ctx.fillRect(50,80,10,10);

//Right eye
ctx.fillStyle = '#fff';
ctx.fillRect(150,80,10,10);

//Nose
ctx.fillStyle = '#fff';
ctx.fillRect(100,110,10,20);

//Mouth

ctx.fillStyle = 'red';
ctx.fillRect(60,150,100,10);

$('#favcolor').on('change',function(){
  colorRect = $(this).val();
  ctx1.fillStyle = $(this).val();
  ctx1.fillRect(0,0,200,200);
}); 
```

在这里你可以看到它：http: [//jsbin.com/inewum/1](http://jsbin.com/inewum/1)问题是我认为它会覆盖一切，因为我再也看不到眼睛和嘴巴了......我只想更新风格它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:18:58.163

你必须重新绘制它。创建您的绘图例程和颜色状态变量。当您更改某些内容时，只需用新颜色重新绘制它。

您只是在更改上下文填充样式并在其上绘制一个矩形。这就是眼睛和嘴巴消失的原因。

更改为这个并查看[演示](http://jsbin.com/inewum/2/edit)：

```
$(function () {

    draw();
    $('#favcolor').on('change', function () {
        colorRect = $(this).val();
        draw();
    });

});

var colorRect = '#000';

function draw() {

    var ball = document.getElementById("canvas");
    var ctx = ball.getContext("2d");
    var ctx1 = ball.getContext("2d");
    ctx1.fillStyle = colorRect;
    ctx1.fillRect(0, 0, 200, 200);
    ctx1.save();

    //Left eye
    ctx.fillStyle = '#fff';
    ctx.fillRect(50, 80, 10, 10);

    //Right eye
    ctx.fillStyle = '#fff';
    ctx.fillRect(150, 80, 10, 10);

    //Nose
    ctx.fillStyle = '#fff';
    ctx.fillRect(100, 110, 10, 20);

    //Mouth

    ctx.fillStyle = 'red';
    ctx.fillRect(60, 150, 100, 10);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:40:36.843

所有 HTML5 画布图形（矩形、圆形、线条等）都不是实体对象，您不能像 JavaScript DOM 对象那样对它们进行操作。因此，您必须重新绘制整个画布图像以更改单独元素的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T15:12:47.557

也许 SVG 更适合您，您可以像对待任何旧 HTML 一样对待 SVG 元素。

这是您使用 SVG 完成的示例[http://jsbin.com/inewum/15/edit](http://jsbin.com/inewum/15/edit)

该脚本可以简化为：

```
$('#favcolor').on('change',function(){
    $('.face').css({
      'fill': $(this).val()
    });
}); 
```

画布可以替换为：

```
<svg height=200 width=200 viewBox='0 0 200 200'>
   <rect width=200 height=200 class="face" />
   <!-- left eye -->
   <rect x=50 y=80 width=10 height=10 fill="white"/>
   <!-- right eye -->
   <rect x=150 y=80 width=10 height=10 fill="white"/>
   <!-- nose -->
   <rect x=100 y=110 width=10 height=20 fill="white"/>
   <!-- mouth -->
   <rect x=60 y=150 width=100 height=10 fill="red"/>
</svg> 
```

# angularjs - ng-grid 编辑不绑定到模型

> ID：15033285
> 
> 赞同：1
> 
> 时间：2013-02-22T21:15:28.023
> 
> 标签：angularjs

这是一个示例 plunker： [http ://plnkr.co/edit/9iCNie?p=preview](http://plnkr.co/edit/9iCNie?p=preview)

预计 myData 在名称被编辑后会发生变化，但事实并非如此。

HTML：

```
<body ng-controller="MyCtrl">
    {{myData}}
    <div class="gridStyle" ng-grid="gridOptions"></div>
</body> 
```

JS：

```
// main.js
var app = angular.module('myApp', ['ngGrid']);
app.controller('MyCtrl', function($scope) {
    $scope.myData = [{name: "Moroni", age: 50},
                     {name: "Tiancum", age: 43},
                     {name: "Jacob", age: 27},
                     {name: "Nephi", age: 29},
                     {name: "Enos", age: 34}];
    $scope.gridOptions = { 
      data: 'myData', 
      enableCellSelection: true,
      canSelectRows: false,
      displaySelectionCheckbox: false,
      columnDefs: [{field: 'name', displayName: 'Name', enableFocusedCellEdit: true}, {field:'age', displayName:'Age'}]
    };
}); 
```

我也在这里打开了一个问题[https://github.com/angular-ui/ng-grid/issues/182](https://github.com/angular-ui/ng-grid/issues/182)，以防这是一个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:02:53.577

这是一个错误，它已在最新版本中修复。在这里工作 - [http://plnkr.co/edit/9iCNie?p=preview](http://plnkr.co/edit/9iCNie?p=preview)

# c++ - QGLWidget的QTimer，在其他机器上绘制和计时不正确

> ID：15033290
> 
> 赞同：0
> 
> 时间：2013-02-22T21:15:53.300
> 
> 标签：c++, qt, opengl, opengl-3

我有两个计时器来重绘 QGLWidget 并确定 FPS

```
QObject::connect(&fpsTimer, SIGNAL(timeout()), this, SLOT(updateFps()));
fpsTimer.start(1000);

QObject::connect(&updateTimer, SIGNAL(timeout()), this, SLOT(updatePanel()));
updateTimer.start(0);

void GLPanel::updatePanel()
{
    updateBuffers();
    updateGL();
    frameCount++;
} 
```

我还在每一帧都用新数据更新 vbos。

在我安装了 Qt 的机器上，我得到了一致的 60 FPS，因为更新计时器将根据 GUI 线程触发。我尝试将其设置为每 15 毫秒更新一次，而不是依靠 GUI 线程而没有运气。在其他机器上，它上升到大约 1000 FPS。

我遇到的另一个问题是我的观点在其他机器上没有正确绘制。它们被绘制在错误的位置和颜色。至于这是否与Qt或OpenGL有关......？

关于什么会导致这种情况的任何想法？

点击屏幕中间的 [其他机器 其他机器](http://i.imgur.com/dH1HTie.png)

点击一个点 [Working Dev Machine 后的 Working Dev Machine](http://i.imgur.com/GbD8EPt.png)

他们应该看起来完全一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:47:39.780

您的绘图计时器使用 0 毫秒的间隔。所以程序试图尽可能快地绘制。这就是为什么其他计算机具有非常高的帧速率。您的计算机很可能正在使用显示驱动程序的[vsync](http://en.wikipedia.org/wiki/Screen_tearing#V-sync)设置。Vsync 会将绘图与显示器的刷新率同步，这就是 60 Hz 帧率的原因。因此，您可以使用垂直同步设置将其他计算机的帧速率限制为 60。

但是，一些旧的和便宜的显卡根本不支持垂直同步。然后您需要更改计时器的时间间隔，例如更改为 15 毫秒。它不会产生像垂直同步那样好的结果，但它比以 1000 Hz 绘制要好得多。

# javascript - Google Places 自动完成：矩形边界与半径

> ID：15033294
> 
> 赞同：1
> 
> 时间：2013-02-22T21:16:13.353
> 
> 标签：javascript, google-maps-api-3, autocomplete, google-places-api

我们正在使用 Javascript API v3，我想添加一个半径来获得更多本地结果。但我无法让它工作。

文档说[Google Places API使用 radius，但](https://developers.google.com/places/documentation/autocomplete)[Google Maps JavaScript API v3](https://developers.google.com/maps/documentation/javascript/places#places_autocomplete)使用矩形 LatLngBounds 。这是正确的还是我可以将半径与 Javascript API 一起使用？

不起作用：

```
 var defaultPlace = new google.maps.LatLng(28.522399, -81.415558);

    var optionsAuto = {
        location: defaultPlace,
        radius: 20000
    };

    var autocomplete2 = new google.maps.places.Autocomplete(input2, optionsAuto); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:43:53.223

您不能将半径与 Javascript API 一起使用。 [https://developers.google.com/maps/documentation/javascript/reference#AutocompleteOptions](https://developers.google.com/maps/documentation/javascript/reference#AutocompleteOptions)

Javascript API 与 REST API 不同。我想如果你真的需要半径，你可以将 REST 调用的结果代理到你的应用程序中。但是创建一些将半径值转换为方形边界框以在 Javascript API 中使用的方法应该不会太难。

# python - 为什么我使用此（python）代码得到“int is not callable”TypeError？

> ID：15033298
> 
> 赞同：2
> 
> 时间：2013-02-22T21:16:27.737
> 
> 标签：python

我正在做 Project Euler 的第 30 题，即找到所有可以写为数字的五次方之和的数字的总和。（[http://projecteuler.net/problem=30](http://projecteuler.net/problem=30)了解更多信息。）

出于某种原因，当我尝试运行我尝试的解决方案时，我得到一个“int is not callable”类型错误：

```
def problem30():
    sum = 0
    for n in xrange(20000):
        if sum([((int(x))**5) for x in list(str(n))]) == n:
            sum += n
    sum 
```

为什么我会收到这样的错误，我该如何解决？提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T21:18:37.603

您将变量命名为`sum`，并尝试同时将其用作内置函数。

重命名作为`sum`总和的标识符：

```
def problem30():
    total = 0
    for n in xrange(20000):
        if sum(int(x) ** 5 for x in str(n)) == n:
            total += n
    return total 
```

我也简化了你的表达方式；大多数括号和清单都是多余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:19:16.603

这就像调用一个变量 justData 然后尝试以下操作：

```
justData = 0
justData(parameterA, parameterB)
# Oops, tried to call a variable as though it wasn't data. 
```

# c# - 如何找到通过 C# 应用程序自动化 SAP 所需的连接字符串？

> ID：15033303
> 
> 赞同：1
> 
> 时间：2013-02-22T21:16:50.037
> 
> 标签：c#, automation, connection-string, sap

我正在尝试通过 C# 与 SAP 建立连接。作为参考，我正在使用此处找到的代码：[如何使用 c# 自动化 SAP GUI](https://stackoverflow.com/questions/13130176/how-do-i-automate-sap-gui-with-c-sharp)

我添加了对 sapfewse.ocx 的引用和相应的 using 语句。这是我的代码：

```
using SAPFEWSELib;

private void OpenSAP()
{
    GuiApplication Application;
    GuiConnection Connection;
    GuiSession Session;

    Application = (GuiApplication)System.Activator.CreateInstance(Type.GetTypeFromProgID("SapGui.ScriptingCtrl.1"));

    // How do I find the connection string that I use to connect to SAP?
    Connection = Application.OpenConnectionByConnectionString("XXXXXXXXX", false, true);
    Session = (GuiSession)Connection.Sessions.Item(0);

    Session.TestToolMode = 1;

    ((GuiTextField)Session.ActiveWindow.FindByName("RSYST-MANDT", "GuiTextField")).Text = "XXX";
    ((GuiTextField)Session.ActiveWindow.FindByName("RSYST-BNAME", "GuiTextField")).Text = "XXXXXXXX";
    ((GuiTextField)Session.ActiveWindow.FindByName("RSYST-BCODE", "GuiPasswordField")).Text = "XXXXXXXX";
    ((GuiTextField)Session.ActiveWindow.FindByName("RSYST-LANGU", "GuiTextField")).Text = "XX";            
} 
```

当我运行此代码说“...连接断开”时出现错误。如何确定要使用的正确连接字符串？在哪里可以找到用于连接到 SAP 的连接字符串？或者有比使用 OpenConnectionByConnectionString() 方法更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-20T10:00:59.973

Use this line of code: Connection = Application.OpenConnectionByConnectionString("/H/IP Address/S/3200", false, true);

H: Host IP Address S: Host Port Number. Default is 3200\. Check yours.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T12:37:06.700

以下是描述路由或连接字符串格式的[官方文档的一部分：](http://help.sap.com/saphelp_erp60_sp/helpdata/en/4f/992de4446d11d189700000e8322d00/content.htm)

> **定义**
> 
> 路由字符串描述了两台主机之间所需连接的站点。路由字符串具有以下语法
> 
> ```
> (/H/host/S/service/W/pass)* 
> ```
> 
> 它由形式为 的任意数量的子字符串组成 `/H/host/S/service/W/pass`。
> 
> **注意：** H、S 和 W 必须大写！
> 
> **结构**
> 
> 路由字符串包含每个 SAProuter 和目标服务器的子字符串。每个子字符串都包含 SAProuter 在路由中建立连接所需的信息：主机名、端口名和密码（如果已给出）。
> 
> 子字符串的语法：
> 
> *   `/H/`表示主机名。请注意，主机名必须至少有两个字符长。
> *   `/S/`用于指定服务（端口）；它是一个可选条目，默认值为 3299
> *   `/W/`表示路由上前任和后继连接的密码，也是可选的（默认为“”，无密码）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-27T01:28:27.207

Your connection string is the name of the SAP area such as ERP, P56, or DFQ

```
Connection = Application.OpenConnectionByConnectionString("ERP", false, true); 
```

Use that

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-09T05:58:12.227

The "XXXXXXXXX" argument ("ConnectionString") is actually the *description* of the connection string that you can locate in the saplogon.ini file, which is at %AppData%\Roaming\SAP\Common

# c# - C#正则表达式检测行尾

> ID：15033305
> 
> 赞同：0
> 
> 时间：2013-02-22T21:17:01.197
> 
> 标签：c#, regex

我需要一个匹配所有这些组合的 C# 正则表达式 -

ABC（以及后面的空格和零个或多个字符）

ABC（后面没有空格和任何*数字*）

ABC（和行尾）<-这是我无法弄清楚的

这是我到目前为止所拥有的 -

```
 bool match = Regex.IsMatch(address, @"((ABC)?[\s+0-9*])"); 
```

我试过这个无济于事（还有很多其他的东西） -

```
 bool match = Regex.IsMatch(address, @"((ABC)?[\s+0-9*$])"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:19:18.820

```
/ABC(?: \w*|\d+|\n)/ 
```

`\n`匹配新行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:20:46.893

也许这就是您正在寻找的：

```
/ABC(?: .*|\d+)?$/ 
```

# django - Django 使用模型 EmailField 引发 AttributeError

> ID：15033307
> 
> 赞同：1
> 
> 时间：2013-02-22T21:17:08.790
> 
> 标签：django, django-models, django-admin

我在我的管理员 list_display 中添加了一个名为“is_dotcom”的模型布尔字段，实现是：

```
email = models.EmailField(max_length=254)

def is_dotcom(self):
    return self.email.lower().endsWith(".com")

is_dotcom.admin_order_field = 'email'
is_dotcom.boolean = True
is_dotcom.short_description = 'Company?' 
```

但是我的管理页面上的所有这些都是“（无）”。我期待真/假（尽管*有时*我的布尔值显示为绿色检查或红色禁止进入标志，有人知道这是为什么吗？）

我将此代码基于[django 教程](https://docs.djangoproject.com/en/1.4/intro/tutorial02/)中的示例。

我假设正在显示“（无）”，因为 is_dotcom() 方法正在引发 django 正在捕获的 AttributeError。我猜想在 EmailField 上调用 .lower() 是合法的，但我不确定（你们为参考文档做了什么？）谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:23:16.023

问题出在这一行：

```
 return self.email.lower().endsWith(".com") 
```

方法是[`.endswith()`](http://docs.python.org/2/library/stdtypes.html#str.endswith)。
请注意没有骆驼案。

重现错误的简化示例：

```
>>> 'foo'.endsWith('test')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'str' object has no attribute 'endsWith' 
```

# python - Python在流模式下修改文件时帮助调试错误

> ID：15033309
> 
> 赞同：0
> 
> 时间：2013-02-22T21:17:50.717
> 
> 标签：python, debugging, error-handling, streamwriter

我有以下问题。我正在读取文件 x,y,z 为：

```
481492.93 6244326.24 26.56
481493.03 6244325.60 25.06
481493.17 6244324.68 22.89
481493.50 6244322.52 17.80
481492.84 6244327.05 27.84
481492.90 6244326.66 26.90
481492.86 6244327.16 27.45
481493.48 6244323.08 17.79
481492.80 6244327.80 28.30
481492.94 6244326.84 26.04
.......................... 
```

我希望在同一个文件上读取、修改和写入（不创建备份文件，因为原始文件超过 10GB）

```
481492.93 6244326.24 26.56 (375, 2902)
481493.03 6244325.60 25.06 (376, 2902)
481493.17 6244324.68 22.89 (377, 2902)
481493.50 6244322.52 17.80 (379, 2903)
481492.84 6244327.05 27.84 (375, 2902)
481492.90 6244326.66 26.90 (375, 2902)
481492.86 6244327.16 27.45 (374, 2902)
481493.48 6244323.08 17.79 (379, 2903)
481492.80 6244327.80 28.30 (374, 2902)
481492.94 6244326.84 26.04 (375, 2902)
.......................... 
```

我写了以下方法

```
def get_point_grid_id(x,y,x_min,y_max,x_dist,y_dist):
        col = int((x - x_min)/x_dist)
        row = int((y_max - y)/y_dist)
        return (row, col)

with open(file_temp, "r+") as f:
    for line in open(file_temp):
        x,y,z = line.split()
        id = get_point_grid_id(float(x),float(y),origin[0],origin[1],1,1)
        element = [x,y,z,id]
        newelement = " ".join([str(e) for e in element])+ "\n"
        f.write(newelement) 
```

当我运行该功能时，出现以下错误

```
Traceback (most recent call last):
  File "<editor selection>", line 3, in <module>
ValueError: too many values to unpack 
```

我想这是原始文件的连接问题

出现错误

```
>>> x,y,z = line.split()
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
ValueError: too many values to unpack 
```

哪里`line`奇怪

```
'481499.82 6244470.31 29.23 (231, 2909)\n' 
```

代替 `'481499.82 6244470.31 29.23\n'`

从新文件运行`print line`后我得到这个打印后使用`for line in open(file_temp):`

```
481499.98 6244494.02 34.14
481499.98 6244494.02 34.14 (208, 2909)
481499.96 6244471.05 33.39
481499.96 6244471.05 33.39 (231, 2909)
481499.95 6244471.27 33.46
481499.95 6244471.27 33.46 (230, 2909)
481499.98 6244473.84 32.72
481499.98 6244473.84 32.72 (228, 2909)
481499.98 6244474.07 32.70
481499.98 6244474.07 32.70 (228, 2909)
481499.97 6244474.28 32.93
481499.97 6244474.28 32.93 (227, 2909)
481499.88 6244474.40 34.35
481499.88 6244474.40 34.35 (227, 2909) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:26:51.473

以 r+ 模式打开该行意味着您读取了一行，即读取了 38 个字符。然后修改这 38 个字符然后，在当前文件位置（字符 39）覆盖现有数据

我猜这不是你想要的

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:41:02.143

这只是行不通。正如Martijn所说，

## 我

`file`对象有一个缓冲位置。每次读取一个字符时，缓冲区位置都会增加 1。假设您读取了 10 个字符长的行：

```
>>> myfile = open('some_file.txt')
>>> myfile.tell() #gets the buffer position
0
>>> myfile.readline()
'012345678\n' 
```

现在缓冲区位置按`len(line)`字符前进：

```
>>> myfile.tell()
10 
```

这意味着当您调用 时`myfile.write()`，它会从位置 10 开始写入。

## 二

您根本无法在不覆盖某些内容或将字符附加到末尾（假设缓冲区位置位于文件末尾）的情况下将字符“插入”到文件中。

## 所以你会怎么做？

您可以创建一个临时文件，同时从您的输入文件中读取，并写入您的临时文件。之后（如果您愿意），您可以将原始文件替换为临时文件：

```
with open(input_file) as infile, open(output_temp_file, "w") as outfile:
    for line in infile:
        x, y, z = line.split()
        new_line = ' '.join([x, y, z] + [function_of_xyz(x, y, z)]) + '\n'
        outfile.write(new_line) 
```

您还应该检查[`csv`模块](http://docs.python.org/2/library/csv.html)。

# jquery - 切换功能以显示和隐藏与类关联的元素

> ID：15033310
> 
> 赞同：0
> 
> 时间：2013-02-22T21:17:53.600
> 
> 标签：jquery, html, css, wordpress

我在一个页面上有几个 div，其中隐藏了我想在单击 div 元素时显示的文本。如何使用 div 的类来做到这一点？

这是我的html：

```
<div id="post-<?php the_ID(); ?>" <?php post_class('team-member'); ?>>
    <?php echo get_the_post_thumbnail($page->ID, array(441,293)); ?>
    <div class="bio-button">BIO</div>   
       <h2><?php the_title(); ?></h2>
       <h3><?php the_excerpt(); ?></h3>
    <div class="team-text">
       <p><?php the_content(); ?></p>
    </div>
</div> 
```

还有我的jQuery：

```
$('.bio-button').toggle(function () {
   $('.team-text',this).show();
}, function () {
   $('.team-text',this).hide();
return false;
}); 
```

再说一次，我将为 .team-member 提供多个 div，.team-text 被隐藏，并在单击 .bio-button 时显示。

我在我的 jquery 中做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:19:31.237

`.toggle()`已经执行了自己的显示/隐藏。无需在内部构建函数。

您还可以定位多个类名： `$('.bio-button, .team-text')`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:20:36.263

`.team-text`不是被点击元素的子元素，你可以`siblings`和`toggle`效果方法：

```
$('.bio-button').click(function () {
   $(this).siblings('.team-text').toggle();
}); 
```

请注意，从 jQuery 1.7 开始，切换事件方法已在 jQuery 1.9 中被弃用和删除。

更新：

```
$('.bio-button').click(function () {
   $(this).siblings('.team-text').show();
});

$('.team-text .button').click(function () {
   $(this).parent('.team-text').hide();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:21:20.797

`toggle()`不采取两个这样的功能。切换只是显示/隐藏它们（使用可配置的参数）。这可能是您需要的：

```
$('.bio-button').click(function() {
    $(this).next('.team-text').toggle();
} 
```

# sed - Sed 和 Awk - 在配置文件中添加一行

> ID：15033314
> 
> 赞同：0
> 
> 时间：2013-02-22T21:18:08.077
> 
> 标签：sed, awk

我需要使用`sed`and将分区添加到配置文件中`awk`。我怎样才能做到这一点 ？就像假设我`/test1`在分区中有一个路径`/dev/sda3`，我需要添加`/dev/sda3`到一个配置文件的名称（第 3 部分）。让我们假设配置文件是`configtest.config` 我需要添加到`configtest.config`以下第三行：

```
part3  /dev/sda3 
```

我该如何使用`sed`and来做到这一点`awk`？我知道要读取分区，即

```
df /test1 | awk '/^\/dev/ {$1}' 
```

我明白了

```
/dev/sda3 
```

但我不知道如何将此分区添加到配置文件的第三行及其名称（part3）

我想使用`sed`和`awk`。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:21:50.610

```
var=$(df /test1 | sed -rn '2s@([^0-9]+([0-9]+)).*@part\2 \1@p')
sed -i "3i $var" configtest.config 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:53:14.603

```
df /test1 |
awk 'NR==FNR{if (/^\/dev/) part=$1; next} 1; FNR==3{print "part3",part}' - configtest.config 
```

如果你想用结果覆盖原始文件，那么它只是：

```
df /test1 |
awk 'NR==FNR{if (/^\/dev/) part=$1; next} 1; FNR==3{print "part3",part}' - configtest.config > tmp &&
mv tmp configtest.config 
```

# android - 通知 setAutoCancel(true) 不起作用

> ID：15033316
> 
> 赞同：28
> 
> 时间：2013-02-22T21:18:15.463
> 
> 标签：android, notifications, click

我试图显示当用户点击它时删除的通知。我正在使用`NotificationCompat`该类来构建我的通知，并调用`setAutoCancel(true)`我的构建器。这是一段代码：

```
NotificationCompat.Builder mBuilder = new NotificationCompat.Builder(this)
        .setSmallIcon(R.drawable.ic_launcher)
        .setContentTitle("title")
        .setAutoCancel(true)
        .setContentText("content");
NotificationManager notificationManager = (NotificationManager)getSystemService(Context.NOTIFICATION_SERVICE);
notificationManager.notify(0, mBuilder.build()); 
```

通知已正确添加，但是当我点击它时没有任何反应！我究竟做错了什么？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-03-19T16:51:39.857

使用 setContentIntent 应该可以解决您的问题：

```
.setContentIntent(PendingIntent.getActivity(this, 0, new Intent(), 0)); 
```

在您的示例中：

```
NotificationCompat.Builder mBuilder= new NotificationCompat.Builder(this)
        .setSmallIcon(R.drawable.notification_icon)
        .setContentTitle("title")
        .setAutoCancel(true)
        .setContentText("content")
        .setContentIntent(PendingIntent.getActivity(this, 0, new Intent(), 0));
NotificationManager notificationManager= (NotificationManager)getSystemService(Context.NOTIFICATION_SERVICE);
notificationManager.notify(0, mBuilder.build()); 
```

通常，您可能希望将用户引导至相关内容，因此可能会将“new Intent()”替换为其他内容。

我上传了一个[演示](https://github.com/snodnipper/press-delete-notification)到 github。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-04-21T21:01:39.077

我知道答案已经被接受，但是我在使用不同的解决方案时遇到了同样的问题，所以我将在这里分享。

对我来说，我使用同一个`NotificationCompat.Builder`对象来创建一个名为`setOngoing(true)`. 这是一个上传进度通知，在工作时不应删除。

无论如何，任务完成后，我打电话，`setAutoCancel(true)`但通知仍然没有滑动。我必须做的也是调用`setOngoing(false)`。

现在看起来很明显，但它可能会在未来为其他人节省一些时间。

# php - 在 Doctrine (Symfony 2) 中选择一列为假的所有内容

> ID：15033317
> 
> 赞同：2
> 
> 时间：2013-02-22T21:18:17.583
> 
> 标签：php, mysql, symfony, doctrine

我的控制器中有代码：

```
$categories = $this->getDoctrine()->getRepository('MyBundle:Categories')->findAll(); 
```

默认情况下，这会从我的表中返回所有数据，但我只想返回列“cenzored”为0的记录。如果不创建另一个实体，我该怎么做？

我的表看起来：

```
cid | integer | auto_increment
name | varchar(50)
cenzored | boolean 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:29:18.503

改用并使用数组`findBy`为 - 子句添加一些信息：`WHERE`

```
[…]->findBy(array('cenzored' => false)); 
```

# f# - F# - 使用重载和参数调用 ac# 方法

> ID：15033319
> 
> 赞同：3
> 
> 时间：2013-02-22T21:18:22.170
> 
> 标签：f#

不知道其他 30 篇文章是如何在这里对我没有帮助的，但我正在使用带有这些重载的 ac# dll：

```
function TqlForBidAskTrade(string, int?, params string[])
function TqlForBidAskTrade(string[], int?, params string[]) 
```

我可以在 c# 中使用我想要的参数调用此方法，如下所示：

```
TqlForBidAskTrade("string", null) 
```

F# 中的等价物是什么？我似乎根本无法编译任何东西。我试过了：

```
TqlForBidAskTrade("string", null)
TqlForBidAskTrade("string", Nullable<int>())
TqlForBidAskTrade("string", Nullable<int>(), null)
TqlForBidAskTrade("string", Nullable<int>(), [])
TqlForBidAskTrade("string", Nullable<int>(), ["doodah"])
TqlForBidAskTrade("string", 4, ["doodah"]) 
```

看起来我应该偶然发现所有类似的请求，但我一直在寻找一个小时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T21:24:20.090

和... 掌心。
TqlForBidAskTrade("string", Nullable()) 确实有效，在我的随机代码修补中，我弄乱了语法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-22T21:30:01.063

您找到了解决方案，但要添加一些解释：

C# 编译器会`Nullable<T>`特别对待。一个例子是`null`可以代替`new Nullable<T>()`。这是[另一个例子](https://stackoverflow.com/a/676089/162396)。

在 F# 中，`Nullable<'T>`只是另一种类型：没有糖，没有魔法。`option<'T>`是最接近`Nullable`对应物的东西，用于[可选参数](http://msdn.microsoft.com/en-us/library/dd233213.aspx)。如果在 F# 中定义，您的函数可能如下所示：

```
type T =
  static member TqlForBidAskTrade(s:string, ?n:int, ?args:string[]) = ()

T.TqlForBidAskTrade("foo") 
```

# ruby-on-rails - 在 Rails 中使用 javascript 拦截 Omniauth 回调

> ID：15033324
> 
> 赞同：2
> 
> 时间：2013-02-22T21:18:36.040
> 
> 标签：ruby-on-rails, devise, omniauth

我正在尝试在 Rails 3.2 应用程序中使用多个提供程序实现 Omniauth 和设计。

一个棘手的场景是：用户第一次通过 LinkedIn 登录。由于linkedin 不提供用户电子邮件，因此我不知道应该将此linkedin 凭据链接到哪个帐户。所以我想拦截回调以提示一个弹出窗口，允许用户输入他的电子邮件或用户名，然后将凭据与电子邮件一起传递给控制器​​。

我该怎么办？

# sql-server - SQL 排除先前在另一个类别中选择的行

> ID：15033335
> 
> 赞同：4
> 
> 时间：2013-02-22T21:19:02.050
> 
> 标签：sql-server, sql-server-2008

```
SELECT * FROM dbo.Sample ORDER BY Site 
```

输出：

```
Site Data
1   Cat
1   Mule
1   Pig
2   Giraffe
2   Dog
2   Horse
2   Mule
4   Cat
8   Dog
8   Pig
8   Mule
8   Bull
9   Bull
9   Giraffe
9   Moose 
```

我想显示按站点排序的数据，但排除以前站点中的行。显示站点 1 中的所有项目 站点 2 中尚未在站点 1 中显示的任何项目，等等。

所以结果显示为：

```
Site    Data
----     ----
1   Cat
1   Mule
1   Pig
2   Dog
2   Giraffe
2   Horse
9   Moose 
```

初始列表是从具有多个连接的查询构建的。

一个工作示例是：

```
SELECT * FROM dbo.Sample WHERE Site = 1
UNION
SELECT * FROM dbo.Sample WHERE Site = 2
AND Data NOT IN (SELECT Data FROM dbo.Sample WHERE Site < 2)
UNION
SELECT * FROM dbo.Sample WHERE Site = 8
AND Data NOT IN (SELECT Data FROM dbo.Sample WHERE Site < 8)
UNION
SELECT * FROM dbo.Sample WHERE Site = 9
AND Data NOT IN (SELECT Data FROM dbo.Sample WHERE Site < 9)
ORDER BY Site 
```

我的站点列表也来自查询。

从 SiteList 中选择不同的站点

```
1
2
4
8
9 
```

当然应该有一种简单有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T21:21:44.537

这会给你想要的结果

```
SELECT MIN(Site) AS Site,
       Data
FROM   dbo.Sample
GROUP  BY Data
ORDER  BY Site 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-22T21:22:41.577

您可以使用`ROW_NUMBER`：

```
WITH CTE AS
(
   SELECT s.*,
      RN = ROW_NUMBER () OVER (PARTITION BY Data Order By Site) 
   FROM dbo.Sample s
)
SELECT * FROM CTE WHERE RN = 1
ORDER BY Site 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T21:35:47.877

```
SELECT * 
FROM dbo.sample a 
WHERE site = 
(SELECT min(site) 
 FROM dbo.sample b 
 WHERE a.data=b.data)
order by site 
```

不像第一个解决方案那样优雅，但是如果您最终得到具有不同值的其他列（例如颜色）并且仍然只希望每只动物有一行，这也将起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T21:22:04.463

试试这个

```
SELECT min(site)
FROM dbo.sample
GROUP BY data
ORDER BY 1 
```

# javascript - jQuery UI - 添加标签教程需要解释

> ID：15033336
> 
> 赞同：1
> 
> 时间：2013-02-22T21:19:06.383
> 
> 标签：javascript, jquery, jquery-ui, tabs, jquery-ui-tabs

我无法理解 jQuery UI 选项卡教程的某个部分。特别是这部分`#{href}'>#{label}`它在做什么/它是什么意思？

完整代码：

```
$(function () {
    var tabTitle = $("#tab_title"),
      tabContent = $("#tab_content"),
      tabTemplate = "<li><a href='#{href}'>#{label}</a> <span class='ui-icon ui-icon-close' role='presentation'>Remove Tab</span></li>",
      tabCounter = 3;

    var tabs = $("#tabs").tabs();

    // modal dialog init: custom buttons and a "close" callback reseting the form inside
    var dialog = $("#dialog").dialog({
      autoOpen: false,
      modal: true,
      buttons: {
        Add: function () {
          addTab();
          $(this).dialog("close");
        },
        Cancel: function () {
          $(this).dialog("close");
        }
      },
      close: function () {
        form[0].reset();
      }
    });

    // addTab form: calls addTab function on submit and closes the dialog
    var form = dialog.find("form").submit(function (event) {
      addTab();
      dialog.dialog("close");
      event.preventDefault();
    });

    // actual addTab function: adds new tab using the input from the form above
    function addTab() {
      var label = tabTitle.val() || "Tab " + tabCounter,
        id = "tabs-" + tabCounter,
        li = $(tabTemplate.replace(/#\{href\}/g, "#" + id).replace(/#\{label\}/g, label)),
        tabContentHtml = tabContent.val() || "Tab " + tabCounter + " content.";

      tabs.find(".ui-tabs-nav").append(li);
      tabs.append("<div id='" + id + "'><p>" + tabContentHtml + "</p></div>");
      tabs.tabs("refresh");
      tabCounter++;
    }

    // addTab button: just opens the dialog
    $("#add_tab")
      .button()
      .click(function () {
        dialog.dialog("open");
      });

    // close icon: removing the tab on click
    tabs.delegate("span.ui-icon-close", "click", function () {
      var panelId = $(this).closest("li").remove().attr("aria-controls");
      $("#" + panelId).remove();
      tabs.tabs("refresh");
    });

    tabs.bind("keyup", function (event) {
      if (event.altKey && event.keyCode === $.ui.keyCode.BACKSPACE) {
        var panelId = tabs.find(".ui-tabs-active").remove().attr("aria-controls");
        $("#" + panelId).remove();
        tabs.tabs("refresh");
      }
    });
  }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:23:17.067

您将其放入字符串中：

```
<a href='#{href}'>#{label}</a> 
```

稍后，您将使用该字符串并使用它执行此操作：

```
tabTemplate.replace(/#\{href\}/g, "#" + id).replace(/#\{label\}/g, label) 
```

所以你正在做的是用标签的实际链接和文本替换原始字符串中的`{href}`和字符。`{label}``<a>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:34:14.380

基本上，#{href} 和 #{label} 以及 #tab_title 和 #tab_content 都是占位符。这些占位符将替换为真实内容。

jQuery UI 教程包含一些 LI 元素，这些元素之后将成为选项卡：

```
<li><a href="#tabs-1">Nunc tincidunt</a></li>
<li><a href="#tabs-2">Proin dolor</a></li>
<li><a href="#tabs-3">Aenean lacinia</a></li> 
```

可以将href="" 的内容匹配到#{href} 占位符，A 元素的内容会插入到对应的#{label}

href-part 甚至命名将包含内容的 div-id。

```
<div id="tabs-1">
  <p>Proin elit arcu, [... ]tempus lectus.</p>
</div> 
```

id 为“tabs-1”的 div 将被读取为选项卡“#tabs-1”的内容。在模板中，此内容将用于代替#tab_content。

# pdf - PDF 流中垂直向后的 JPEG（或其他）图像

> ID：15033343
> 
> 赞同：1
> 
> 时间：2013-02-22T21:19:23.827
> 
> 标签：pdf, stream, jpeg

我正在尝试理解 PDF 格式，到目前为止，我已经看到图像可以以 JPG 格式出现（但显然没有“JFIF”字节）。

**或者，它是否与 JPEG 不同但非常相似？**

我看到图像垂直反转。

**这次回归的目的是什么？**

图像可以在 PDF 流中正常显示吗？

这是 PDF 中的示例。据我所知，这个上传的文件与 PDF 文件中包含的 done 相同，打包如下（使用 NASM 程序集数据定义使其变得简单）：

```
db "19 0 obj",0x0D
db "<< /Type /XObject /Subtype /Image /Width 367 /Height 475 /BitsPerComponent 8 ",0x0D
db "/ColorSpace 12 0 R /Length 37575 /Filter /DCTDecode >> ",0x0D
db "stream",0x0D,0x0A
incbin "19_0_obj.bin.jpg"
db "endstream",0x0D
db "endobj",0x0D 
```

[![](../Images/5d50fc5169d7d727289a120457bd0a72.png)](https://i.stack.imgur.com/tmpRj.jpg)

# batch-file - 在文件中搜索单词列表，然后在另一个上找到这些单词，用 Class=ShipDummy 替换整行，替换它下面的 2 行

> ID：15033351
> 
> 赞同：0
> 
> 时间：2013-02-22T21:19:38.883
> 
> 标签：batch-file, batch-processing, batch-rename

我想从我们称为“List.txt”的外部列表（简单的一行中的每个单词）中搜索单词列表，然后在文件中搜索它们（C:\Users\P Ditty\ Documents\SH3\data\cfg\Backups_SCR*.clg) *（匹配整个单词，即使它在另一个单词中，并且匹配大小写）*，然后如果它们在那里，则在另一个文件中找到这些单词（Campaign_SCR.mis.tmp）*（匹配整个单词，即使它在另一个匹配的大小写中）*仅当行以“Name =”开头时，才将 (Campaign_SCR.mis.tmp) 中的整行替换为 Name=ShipDummy。之后，同一文件中下面的两行将替换为第二行“Class=ShipDummy”，然后是第三行“Type=206”。

这是我现在拥有的代码。现在它在 C:\Users\P Ditty\Documents\SH3\data\cfg\Backups_SCR*.clg 中搜索 ClassName= **Variable**，然后如果在 Campaign_SCR.mis.tmp 中找到该变量，它将用 Class=ShipDummy 替换整行. 它还将其下方的 1 行替换为“Type=206”。

```
setlocal enableDelayedExpansion

>Campaign_SCR.mis.tmp (
for /f "tokens=1* delims=:" %%A in ('findstr /n "^" Campaign_SCR.mis.backup') do (
    ( echo !ln!| findstr "^Type=12$" >NUL && set ln=ln ) || (
        set "ln=%%B"
        if "!ln:~0,6!"=="Class=" (
            findstr /s /c:"ClassName=!ln:~6!" "C:\Users\P Ditty\Documents\SH3\data\cfg\Backups_SCR\*.clg" >"C:\Users\P Ditty\Documents\SH3\data\cfg\Backups_SCR\null" && (
                echo Class=ShipDummy
                set "ln=Type=12"
            )
        )
        if #!ln!==# (echo;) else echo !ln!
    )
  )
) 
```

**但我希望它从我指定的列表中搜索名称，在 (C:\Users\P Ditty\Documents\SH3\data\cfg\Backups_SCR*.clg) 中搜索。然后，如果找到匹配项，则在 Campaign_SCR.mis.tmp 中搜索并替换整行，前提是该行以“Name=”开头，Name=ShipDummy。下面的两行将替换为第二行“Class=ShipDummy”，然后是第三行“Type=206”：**

```
Name=ShipDummy
Class=ShipDummy
Type=206 
```

**请记住，在 Campaign_SCR.mis.tmp 中，变量的行通常不会显示为 Name=variable。很可能是 Name=(words)variable(words)

被搜索的列表可以是外部的吗？我们可以让它每行搜索一个单词吗？例如：如果列表如下：

俾斯麦引擎盖击退

它将搜索每个单词。**

**当它匹配列表中的单词到 (C:\Users\P Ditty\Documents\SH3\data\cfg\Backups_SCR*.clg) 时，请确保它也匹配大小写。所以列表中的“Bismarck”将从（C:\Users\P Ditty\Documents\SH3\data\cfg\Backups_SCR*.clg）中找到“Bismarck”，而不是找到“bismarck”**

感谢您的时间！

顺便说一句，对于我在这里遇到的问题，这可能是一个更简单的解决方法：[如何应用它？](https://stackoverflow.com/questions/15017118/how-do-i-apply-this)

**例如：**

假设我有一个看起来像这样的外部列表（例如称为 List.txt）：

```
Bismarck
Hood
Repulse 
```

我将为此搜索 C:\Users\P Ditty\Documents\SH3\data\cfg\Backups_SCR*.clg。假设它在以下位置找到“俾斯麦”和“胡德”：

```
sadfasfasfdBismarckfasdfasdfasdfas

asdfasfdafHoodasdfasfas 
```

然后它将在 Campaign_SCR.mis.tmp 中搜索俾斯麦和胡德替换：

```
Name=asdfBismarckasfdw
Class=jlkjf
Type=12 
```

和：

```
Name=ShipDummy
Class=ShipDummy
Type=206 
```

和

```
Name=asdfHoodasfdw
Class=jlkjf
Type=13 
```

和：

```
Name=ShipDummy
Class=ShipDummy
Type=206 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T00:47:33.577

```
@echo off
setlocal EnableDelayedExpansion

REM INITIALIZE THE LIST OF WORDS THAT WILL BE SEARCHED
set targetWords=:EOF

rem I'd like to search for a list of words from an external list (simple each word on a line)
for /F %%a in (List.txt) do (   
   rem and search for them in a file (C:\Uses\P Ditty\Documents\SH3\data\cfg\Backups_SCR*.clg) 
   findstr "%%a" "C:\Uses\P Ditty\Documents\SH3\data\cfg\Backups_SCR*.clg" > NUL
   rem if they are there...
   if !errorlevel! equ 0 (
      REM INSERT THE WORD IN THE TARGET LIST
      set targetWords=!targetWords! %%a
   )
)

REM INSERT THE END-OF-FILE MARK IN THE FILE
echo :EOF>> Campaign_SCR.mis.tmp

REM INITIALIZE THE NUMBER OF LAST PROCESSED LINE IN REDIRECTED Campaign_SCR.mis.tmp
set lastLine=0

rem ... find those words on another file(Campaign_SCR.mis.tmp)
< Campaign_SCR.mis.tmp (for /F "delims=:" %%a in ('findstr /N "%targetWords%" Campaign_SCR.mis.tmp') do (
   REM DUPLICATE PREVIOUS LINES UNTIL NEW TARGET LINE
   set /A numOfLines=%%a-lastLine-1
   for /L %%i in (1,1,!numOfLines!) do (
      set line=
      set /P line=
      echo(!line!
   )
   rem if the line starts with "Name="
   set /P line=
   if "!line:~0,5!" equ "Name=" (
      rem replacing the whole line...with Name=ShipDummy
      echo Name=ShipDummy
      rem After that the two lines below that in that same file would be replaced with 2nd line "Class=ShipDummy", 
      set /P line=
      echo Class=ShipDummy
      rem then 3rd line "Type=206".
      set /P line=
      echo Type=206
      set /A lastLine=%%i+2
   ) else (
      REM DUPLICATE THE NON MATCHING LINE, IF IS NOT THE :EOF MARK
      if "!line!" neq ":EOF" (
         echo !line!
         set lastLine=%%i
      )
   )
)) > Campaign_SCR.mis.tmp.NEW

REM UPDATE THE NEW FILE
REM del Campaign_SCR.mis.tmp
REM ren Campaign_SCR.mis.tmp.NEW Campaign_SCR.mis.tmp 
```

# magento - MAGENTO - 网格视图不显示为网格

> ID：15033355
> 
> 赞同：0
> 
> 时间：2013-02-22T21:19:55.137
> 
> 标签：magento, view, grid

我有我的 magento 显示为一个网格，但它正在做一些相当奇怪的事情。如果您查看网页[http://www.theshirt.org](http://www.theshirt.org)，您会看到它显示 3 个产品，然后在下一行显示 1，然后是 3，然后是 1，依此类推。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T22:18:15.477

您每行的列数设置为 4，您需要将其更改为 3

转到 /app/design/frontend/default/[theme]/layout/catalog.xml

```
<catalog_product_view translate="label">
    <label>Catalog Product View (Any)</label>
    ....
    <block type="catalog/product_list_upsell" name="product.info.upsell" as="upsell_products" template="catalog/product/list/upsell.phtml">
                <action method="setColumnCount"><columns>5</columns></action>
               .... 
```

将行更改为

```
 <action method="setColumnCount"><columns>3</columns></action> 
```

# ruby-on-rails - ruby gem 的版本控制最佳实践

> ID：15033357
> 
> 赞同：1
> 
> 时间：2013-02-22T21:20:08.313
> 
> 标签：ruby-on-rails, version-control, rubygems, versioning

我经常向它添加新的宝石和功能。在我上次发布之前，我的一些代码在我的开发环境中出现了问题，我发现这是因为我的一些 gem（尤其是 CarrierWave 和 jQuery）已经更新并且不能与某些代码一起使用。

管理有关版本控制的 gem 的最佳方法是什么？有些人似乎说您应该始终在 Gemfile 中指定版本号……但是对于所有 gem？一些？

我知道对于某些 gem，由于错误等原因，您可能*必须*存储版本号。但除此之外，在开发过程中，有时我会添加新的 gem，并且可能需要做 a`bundle update`以使新的东西正常工作，但随后不想破坏旧东西。

我有很好的测试，希望能在投入生产之前发现很多错误。其他用户如何确保 gem 更新在开发时不会破坏完全不相关的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T12:10:24.537

不幸的是，如果你不希望你的应用程序因为向后不兼容的 gem 更新而中断，你必须指定 gem 版本。我发现一个好的做法是使用悲观运算符`~>`来指定 gem 版本。例如：

```
gem carrierwave, '~>0.6.0' 
```

这意味着carrierwave gem 将被冻结在0.6 版本，但bundle 将安装任何小的、向后兼容的更新和错误修复，通常是最后一个数字（0.6.1、0.6.2...）的增量。这意味着您可以更新您的捆绑包，而不会冒破坏某些东西的风险（运行时不再退缩`bundle update`）。

您还可以在主要版本上使用悲观运算符：

```
gem devise, '~>2.0' 
```

这意味着 bundle 将更新到版本 2.1.0、2.2.0、2.2.1、2.3.0，但永远不会更新到 3.x。

一些考虑：

1.  您不必**指定**所有 gem 版本，但这是一种很好的做法。例如，我没有指定我自己的 gem 的版本。但是每个第三方 gem 都有指定的版本。否则，我会把我的代码信任到我无法控制的事情上。

2.  您仍然需要对 gem 维护者有一定的信任才能使用悲观运算符。鲁莽的维护者仍然可以在次要版本中发布向后不兼容的更改。在这些情况下，我锁定了次要版本（没有悲观运算符）。

3.  如果您指定 gem 版本，您将使 bundle 解决 gem 依赖项的工作变得更加容易，这意味着它会更快地完成。

# rdlc - 编辑报告的版本

> ID：15033358
> 
> 赞同：2
> 
> 时间：2013-02-22T21:20:14.640
> 
> 标签：rdlc, visual-studio-express

哪些版本的 Microsoft Visual Studio Express 可以编辑`rdlc`文件？

我需要一个免费资源供最终用户编辑报告以修复外观问题，而无需强迫他们购买完整的 VS 许可证。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-20T09:04:46.587

如果您使用 VS2010 或 VS2012 创建报告，您必须考虑这个分支： [https ://github.com/majorsilence/My-FyiReporting](https://github.com/majorsilence/My-FyiReporting)

如果您使用 VS2005 或 VS2008 创建报告，您可以使用： [http](http://www.fyireporting.com/) ://www.fyireporting.com/ (*)

(*)*编辑（2017 年 3 月）：此链接似乎不再有效；网站已完全重建，现在是关于 SEO*

# sql - 如何包含作为列值返回的总行数？

> ID：15033360
> 
> 赞同：1
> 
> 时间：2013-02-22T21:20:22.660
> 
> 标签：sql, oracle11g, max, rownum

**甲骨文 11g**

我想将 max(rownum) 作为新列包括在内以获得所需的结果。本质上，我想将此*QueryA*的结果作为新列添加到*QueryB。* 当我在 QueryB 中包含 max(rownum) 时，我得到一个“不是单组函数”。当我按可乐或 rownum 分组时，QueryB 也不起作用。

**查询A**

```
with data_row as
(
select 1 as col_a from dual union all
select 2 as col_a from dual union all 
select 3 as col_a from dual )
select max(rownum) as max_row from data_row 
```

**查询B**

```
with data_row as
( select 1 as col_a from dual union all
  select 2 as col_a from dual union all
  select 3 as col_a from dual)
select col_a, rownum from data_row 
```

**期望的结果**

```
Col_a    Rownum   MaxRowNum
--------------------------------
1          1       3
2          2       3
3          3       3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:24:21.200

您可以使用`count`函数的解析形式

```
SQL> ed
Wrote file afiedt.buf

  1  with data_row as (
  2    select 1 as colA from dual union all
  3    select 2 as cola from dual union all
  4    select 3 as cola from dual
  5  )
  6  select colA, rownum, count(*) over () cnt
  7*   from data_row
SQL> /

      COLA     ROWNUM        CNT
---------- ---------- ----------
         1          1          3
         2          2          3
         3          3          3 
```

# api - 从 5 位邮政编码、程序化、api 获取 9 位邮政编码

> ID：15033361
> 
> 赞同：7
> 
> 时间：2013-02-22T21:20:22.610
> 
> 标签：api, geocode, google-geocoder, street-address, usps

我有 5 位邮政编码，这些是从 Google Maps Api 检索的。

我的困境是我必须连接到一个也包含地址的远程数据库。如果该地址在该数据库中不存在，我必须编写它，如果它确实存在，那么除了存储数据库分配给该地址的 ID 之外，我什么也不做。出现问题是因为检查此数据库的 api 不使用通配符，该数据库中的地址具有 9 位邮政编码 (5+4)，并且不会返回地址的其余部分与我的地址与 5 位邮政编码相匹配。

远程系统会告诉我该地址与我发送的地址不存在。

因此，为了防止将重复的地址写入数据库，我需要在发送之前找到我拥有的邮政编码的 9 位版本。

这将如何完成？是否有确定 5 位地址的最后 4 位是什么的公式？USPS 有 API 吗？人口普查有一张大桌子吗？

洞察力赞赏

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T22:03:16.317

如果您使用 USPS 发送邮件，则仅允许使用 USPS API 获取信息...

但是您可以查看 SmartyStreets（我曾经在那里工作）或其他经过 CASS 认证的供应商。他们获得地址验证许可，您还可以在没有地址的情况下执行城邦和邮政编码查找（取决于您选择的人）。

我认为您会发现它们比默认的 USPS 网络服务更容易、更全面。

这里有一些示例代码......任你选择：[https ://github.com/smartystreets/LiveAddressSamples](https://github.com/smartystreets/LiveAddressSamples)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:26:41.073

美国邮政服务有[许多 API](https://www.usps.com/business/webtools.htm)。他们的“地址信息 API”包括：

> 地址标准化
> 
> 消除寻址错误并帮助确保准确及时地交付。此工具可纠正街道地址中的错误，包括缩写和缺失信息。它还提供 ZIP+4® 代码。
> 
> 邮政编码™查找
> 
> 查找美国任何给定地址、城市和州的匹配邮政编码或邮政编码 + 4 编码
> 
> 城市/州查询
> 
> 使用邮政编码获取准确的城市和州信息。

[地址信息 API 需要使用](https://www.usps.com/business/webtools-address-information.htm)权限。

# ios - 在 CvSVM 中获取权重，OpenCV 的 SVM 实现

> ID：15033363
> 
> 赞同：2
> 
> 时间：2013-02-22T21:20:36.950
> 
> 标签：ios, opencv, machine-learning, computer-vision, svm

我在 iOS 上使用 OpenCV 的 SVM 实现（基于 LibSVM）。训练后是否可以得到权重向量？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T15:41:17.617

在处理它之后，我已经能够获得权重。为了获得权重，必须首先获得支持向量，然后将它们与 alpha 值相乘。

```
// get the svm weights by multiplying the support vectors by the alpha values
int numSupportVectors = SVM.get_support_vector_count();
const float *supportVector;
const CvSVMDecisionFunc *dec = SVM.decision_func;
svmWeights = (float *) calloc((numOfFeatures+1),sizeof(float));
for (int i = 0; i < numSupportVectors; ++i)
{
    float alpha = *(dec[0].alpha + i);
    supportVector = SVM.get_support_vector(i);
    for(int j=0;j<numOfFeatures;j++)
        *(svmWeights + j) += alpha * *(supportVector+j);
}
*(svmWeights + numOfFeatures) = - dec[0].rho; //Be careful with the sign of the bias! 
```

这里唯一的技巧是实例变量`float *decision_function`在 opencv 框架上受到保护，所以我必须更改它才能访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:58:35.137

粗略浏览一下文档和源代码（[https://github.com/Itseez/opencv/blob/master/modules/ml/src/svm.cpp](https://github.com/Itseez/opencv/blob/master/modules/ml/src/svm.cpp)）告诉我，表面上答案是“否”。超平面参数似乎隐藏在 CvSVMSolver 类中。CvSVM 包含一个名为“求解器”的类对象。看看你能不能联系到它的成员。

# vb.net - 单击按钮时增加标签值

> ID：15033371
> 
> 赞同：0
> 
> 时间：2013-02-22T21:20:53.057
> 
> 标签：vb.net

我尝试使用 CInt、TryParse、Convert.Int32 等进行转换，但没有任何效果。我只需要在单击按钮 btnVote 时显示候选人的总票数，并在单击 btnResult 时显示结果。我也尝试在网上搜索，但仍然没有运气，所以我来到了这个网站，希望我能用 VB.net 中的程序解决我的问题

下面是我的代码：

```
Public Class Presidential_Election

    Private Sub btnVote_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnVote.Click
        If cboCandidates.Text = "NOLI" Then
            lblNoli.Text = Integer.Parse(lblNoli.Text) + 1
        ElseIf cboCandidates.Text = "VAL" Then
            lblVal.Text = (CInt(lblVal.Text) + 1).ToString
        ElseIf cboCandidates.Text = "LESTER" Then
            lblLester.Text = CInt(lblLester.Text) + 1
        ElseIf cboCandidates.Text = "GWAPO" Then
            lblGwapo.Text = CInt(lblGwapo.Text) + 1
        End If
    End Sub

    Private Sub btnResult_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnResult.Click
        lblNoli.Visible = True
        lblVal.Visible = True
        lblLester.Visible = True
        lblGwapo.Visible = True
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:39:03.130

我会为每个候选人设置一个整数计数器。将它们设置为 0，然后在它们收到投票时增加它们。当您显示结果时，只需将标签的文本绑定到其各自的计数器并使其可见。这样，您就不必一直引用 label.text。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:32:15.037

如果您没有将标签文本设置`0`在开头，那么使用`CInt`肯定会引发错误。你有两个选择：

*   将所有标签文本设置为 0 并继续使用`CInt`, 或
*   使用 Val()

例子 ：

```
lblGwapo.Text = Val(lblGwapo.Text) + 1 
```

# c - 创建一个 pthreads 线程池来处理 get 请求

> ID：15033376
> 
> 赞同：2
> 
> 时间：2013-02-22T21:21:22.780
> 
> 标签：c, networking, pthreads, threadpool

我很难相信没有答案或教程，但我很难在任何地方找到一个！

我必须（并且必须）构建一个多线程服务器来处理 C 中的 GET 请求。要获得满分，这需要使用线程池。目前我的主线程接受连接并将它们传递给一个新线程。

我可以在网上找到一些用 c 语言实现的线程池，但是来自 Java 背景的人很难理解它们。他们似乎也都使用任务队列。

考虑到您可以将侦听呼叫告知队列连接，这似乎没有必要。我在某处看到接受是线程安全的（说我也听到 POSIX 说安全它更安全？）这是一种明智的做法吗？或者每个线程等待接受而不是在通过连接之前停止执行，开销会更高吗？

如果是这种情况，我将如何在 C 中执行此操作？我想我需要保持一个线程安全的数据结构，存储指向每个线程的指针和一个指示它们是否忙的值？并且有一些方法可以重新启动线程并传递一个连接？但我不知道如何做到这一点，也无法在互联网上找到任何简单的教程。

任何建议或教程链接将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T11:33:45.323

`Accept()`是[线程安全的](http://pubs.opengroup.org/onlinepubs/7908799/xsh/threads.html)。

实际上，您所描述的是一种使用线程池实现套接字服务器的优雅方式 - 调用`accept()`所有线程池，操作系统将在连接到达时只唤醒一个线程。干得好，当我不得不实施这样的事情时，我从来没有真正考虑过这个选项。

据我所知，同时调用多个线程并没有真正的开销`accept()`——所有线程都会休眠，直到可以接受连接，所以它们不会有效地消耗任何 CPU 时间。

# javascript - 你如何使用 hasOwnProperty？

> ID：15033377
> 
> 赞同：2
> 
> 时间：2013-02-22T21:21:33.013
> 
> 标签：javascript, class, coffeescript

任何人都可以解释对空对象调用 hasOwnProperty 的作用吗？为什么要使用它？

```
__hasProp = {}.hasOwnProperty 
```

当我开始在 coffescript 中开发时，我发现了这一点.. Ty

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T21:23:08.210

`hasOwnProperty`不**叫**。函数名后面没有括号。

`__hasProp`是对[*^([MDN])*](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)**的引用**，因为[`Object.prototype.hasOwnProperty`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)

```
__hasProp = {}.hasOwnProperty 
```

是一个较短的版本

```
__hasProp = Object.prototype.hasOwnProperty 
```

现在打电话`__hasProp`，例如

```
__hasProp.call(someObject, 'foo') 
```

比

```
Object.prototype.hasOwnProperty.call(someObject, 'foo') 
```

* * *

> 我是在开始开发咖啡时创立的。

所以我假设这一行是自动生成的，你可能想知道如果没有人真正需要编写代码，为什么还要创建快捷方式？

将此函数分配给变量避免了查找`Object`，`Object.prototype`并且`Object.prototype.hasOwnProperty`每次您想使用它时。`__hasProp`只是一个查找，而不是三个，并且在经常使用时可能会导致性能略有提高。

# sql - 手动选择行 phpmyadmin

> ID：15033383
> 
> 赞同：0
> 
> 时间：2013-02-22T21:21:56.140
> 
> 标签：sql, phpmyadmin

是否可以手动选择要运行 sql 查询的行？在 phpmyadmin 界面中，每一行都有一个复选框，可以以某种方式用于过滤行吗？我可以看到一个可以编写查询的内联选项。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:42:59.790

您不能使用复选框对特定字段运行查询。要在特定字段上运行查询，您需要使用某种子句。

# c++ - 在类中使用指针

> ID：15033385
> 
> 赞同：0
> 
> 时间：2013-02-22T21:22:03.403
> 
> 标签：c++

大家好，我这里有一个不寻常的问题。我编写了一个货币兑换器类，它根据购买的总金额和购买的金额确定作为找零的纸币和硬币的数量。例如，如果您要以 12.04 美元的价格购买某样东西并给了一张 20 美元的钞票，您将收到 7.96 美元的零钱。

输出将是：

```
0 twenty dollar bill(s)  
0 ten dollar bill(s)  
1 5 dollar bill(s)  
2 1 dollar bills(s)  
3 quarter(s)  
2 dime(s)  
1 penny(s) 
```

**现在问题是我必须使用指针或引用返回每张钞票和硬币的数字。**

我的程序有两个函数 GetBills，它使用指向整数的指针来返回更改所需的 20 美元、10 美元、5 美元和 1 美元钞票的数量。

另一个是 GetCoins，它再次使用指向整数的指针来返回更改所需的四分之一角钱、五分钱和便士的数量。

我的问题是这个。我的 GetBills 没有在指针中存储任何值，但我的 GetCoins 是。如果我输入 12.04 作为购买价格和 20.00 给定数量，我的输出是：

```
0 twenty dollar bill(s)
0 ten dollar bill(s)
0 5 dollar bill(s)
0 1 dollar bills(s)
3 quarter(s)
2 dime(s)
1 penny(s) 
```

所以你可以看到一些硬币的价值很好但不是钞票。什么可能导致我的 GetBills 中的指针无法存储正确的值？

这是我的缩短代码：

*MoneyChanger.h*

```
class MoneyChanger
{
private:
double amountP, amountG, totalChange;
int twenty, ten, five, one, change;
int quarter, dime, nickel, penny;
public:
void GetBills(int *twenties, int *tens, int *fives, int *ones);
void GetCoins(int *quarters, int *dimes, int *nickels, int *pennies);
}; 
```

*MoneyChanger.cpp*

```
void MoneyChanger::setData(double pp, double given)
{
amountP = pp;
amountG = given;
CalcChange();
}
void MoneyChanger::CalcChange()
{
 while(totalChange >= 20){totalChange = totalChange-20; twenty++;}
 while(totalChange >= 10){totalChange = totalChange-10; ten++;}
 while(totalChange >= 5){totalChange = totalChange-5; five++;}
 while(totalChange >= 1){totalChange = totalChange-1; one++;}
 while(totalChange >= .25){totalChange = totalChange-.25; quarter++;}
 while(totalChange >= .10){totalChange = totalChange-.10; dime++;}
 while(totalChange >= .05){totalChange = totalChange-.05; nickel++;}
 while(totalChange >= .01){totalChange = totalChange-.01; penny++;}

}
double MoneyChanger::GetTotalChange()
{
totalChange = amountG - amountP;
    return totalChange;
}
void MoneyChanger::GetBills(int *twenties, int *tens, int *fives, int *ones)
{
*twenties = twenty;
*tens = ten;
*fives = five;
*ones = one;
CalcChange();
}
void MoneyChanger::GetCoins(int *quarters, int *dimes, int *nickels, int *pennies)
{
*quarters = quarter;
    *dimes = dime;
*nickels = nickel;
*pennies = penny;
CalcChange();
 } 
```

*主文件*

```
int main()
{
MoneyChanger mc;
int twenties, tens, fives, ones, quarter, dimes, nickels, pennies;
double purchase, given;
cout<<"please enter total cost of purchase: ";
cin>>purchase;
cin.ignore();
cout<<"\nplease enter amount given: ";
cin>>given;
mc.setData(purchase, given);
cin.ignore();
cout<<"Your change is: "<<mc.GetTotalChange()<<"\n\n";

mc.GetBills(&twenties, &tens, &fives, &ones);
mc.GetCoins(&quarter, &dimes, &nickels, &pennies);

cout<<twenties<<" twenty dollar bill(s)"<<endl;
cout<<tens<<" ten dollar bill(s)"<<endl;
cout<<fives<<" five dollar bill(s)"<<endl;
cout<<ones<<" one dollar bill(s)"<<endl;
cout<<quarter<<" quarter(s)"<<endl;
cout<<dimes<<" dime(s)"<<endl;
cout<<nickels<<" nickel(s)"<<endl;
cout<<pennies<<" penny(s)"<<endl;
return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:28:44.260

我认为您的问题出在`GetBills`并且应该在分配之前首先调用`GetCoins`该函数。`CalcChange`假设您已将 bills/coins 成员变量初始化为 0，第一次调用`GetBills`会将所有传入的 bills 设置为 0。然后，您的函数将计算 bills 和 coins 的值应该是什么。调用`GetCoins`coin 的成员变量已经被设置为`CalcChange`调用 in 中的正确值`GetBills`。

我建议`calcChange`退出这两个函数（因为多次调用它是多余的）并在你的 main 中做一些这样的事情：

```
cout<<"Your change is: "<<mc.GetTotalChange()<<"\n\n";

mc.calcChange();

mc.GetBills(&twenties, &tens, &fives, &ones);
mc.GetCoins(&quarter, &dimes, &nickels, &pennies); 
```

# c++ - C++ 对象引用损坏

> ID：15033388
> 
> 赞同：-5
> 
> 时间：2013-02-22T21:22:06.143
> 
> 标签：c++, object, reference

创建对对象的引用会导致该引用被破坏。这绝对是奇怪的，因为它似乎是简单的 C++ 功能。另一个奇怪的事情是，问题似乎已经出现而没有更改任何相关代码（我知道）。如果我不得不猜测，我会说这与所涉及的 DirectX 代码有关。

这是代码：

```
// the header file of the class of the problem object
#pragma once

#include<vector>
#include<Windows.h>
#include<xnamath.h>
#include<string>
using namespace std;

#define float2 XMFLOAT2
#define float4 XMFLOAT4

namespace DXLib
{
    struct Sprite
    {
        char* imagename;
        float2 pos;
        float rot;
        float2 scale;
        float4 rgba;
    };

    struct Rect
    {
        float2 pos;
        float2 size;
        float4 color;
    };

    struct Text
    {
        std::string string;
        float2 pos;
    };

    class D3DDraw
    {
    public:
        D3DDraw(int maxdepth = 0);
        ~D3DDraw(void);
        void DrawSprite(char* imagename, float2 pos, int depth = 0, float rot = 0.0f, XMFLOAT2 scale = XMFLOAT2(1, 1), float4 rgba = float4(1, 1, 1, 1));
        //void DrawRect(float2 pos, float2 size, float4 color);
        void DrawDXText(std::string string, float2 pos);
        void Clear(void);

    public:
        std::vector<vector<Sprite>> depths_;
        std::vector<Text> texts_;
        int maxdepth_;  // set on initialize, do not change
        float2 spriteoffset_;
    };
}

// the header file for the base class for the class in which the problem occurs
#pragma once
#include <windows.h>
#include"D3DCore.h"
#include"D3DRender.h"
#include"D3DDraw.h"
#include"DXInput.h"
#include<cassert>
using namespace DXLib;

const UINT uWindowSizeX = 1000;
const UINT uWindowSizeY = 800;

class Application
{
public:
    Application();
    ~Application();
    HRESULT Run();

protected:
    virtual void Update(void);

private:
    static LRESULT CALLBACK WndProc( HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam );

protected:
    D3DDraw m_cDraw;
    DXInput m_cInput;

private:
    HWND m_hWnd;
    D3DCore m_cCore;
    D3DRender m_cRender;
};

// the class header file
#pragma once
#include"stdafx.h"
#include"VGraphics.h"
#include"EntityPool.h"
#include"VUI.h"
#include"Manager.h"

class VApp : public Application
{
public:
    VApp(void);
    ~VApp(void);
    virtual void Update(void) override;

private:
    void Log(double dTime);  // prints log info to console every nth frame

private:
    int m_iTime;
    VGraphics m_cGraphics;
    EntityPool m_cPool;
    VUI m_cVUI;
    Manager m_cManager;
};

// the function in which the problem occurs
void VApp::Update(void)
{
    double dTime = (GetTickCount() - m_iTime) / 1000.0;

    D3DDraw& rcDraw = m_cDraw; // that object is initialized and just fine
    // that reference now points to an uninitialized object
    m_cVUI.Tick(m_cInput, m_cDraw, m_cPool, m_cManager);

    m_cManager.Tick();

    m_cGraphics.Draw(m_cVUI.GetView(), m_cPool, m_cDraw);

    Log(dTime);

    m_iTime = GetTickCount();
    Sleep(15);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:58:40.020

我不知道为什么，但在这里更改访问说明符：

```
protected:
    D3DDraw m_cDraw;
    DXInput m_cInput; 
```

为了`public`解决这个问题，这是一个黑客，但我可以接受：D

无论如何感谢您尝试提供帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:25:18.660

好吧，这是我对 SSCCE 的尝试，但我无法让它失败（可能与通过[指向错误对象](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/cplr129.htm)的指针访问受保护的成员有关）：

```
class Thing 
{ 
public:
    int value;
    Thing() { value = 42; }
    ~Thing() { };
};

class Foo
{
public:
    Foo() { }
    ~Foo() { }

public:
    void CallMethod()
    {
        Method();
    }

protected:
    virtual void Method()
    {
    }

    Thing m_x;
};

class Bar : public Foo
{
public:
    Bar() { }
    ~Bar() { }

    virtual void Method() override
    {
        Thing& x = m_x;
        printf("%d\n", x.value);
    }
};

int _tmain(int argc, _TCHAR* argv[])
{
    Foo f;
    Foo& rf = f;

    printf("%p\n", &rf);

    Bar bar;

    Foo& rfoo = bar;
    rfoo.CallMethod();

    return 0;
} 
```

# c - 在负索引处访问数组的元素

> ID：15033398
> 
> 赞同：-2
> 
> 时间：2013-02-22T21:22:34.887
> 
> 标签：c, arrays

我有这个功能：

```
void func(int index, struct foo b[])
{
    // ...
    a[0][0] = b[index].c[0];
    // ...
} 
```

但有时使用 index 调用该函数`-2`：

```
a[0][0] = b[-2].c[0]; 
```

我认为 -2 超出范围，有时会崩溃，但有时不会。

如果数组b的头地址是0xffd9cda4，那么b[-2]的地址是什么？
0xffd9cda4 + 0xffffffffe = 0x1ffd9cda2？0x1ffd9cda2 有效吗？

它在 64 位 Linux 上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:31:13.393

您有一个数组`b`，它占用从 address 开始的内存块`&b[0]`。甚至不要试图找出 的地址是什么`b[-2]`，因为这显然不在这个数组占用的内存块内。

试图访问数组边界外的内存会产生**未定义的行为**。

* * *

另请注意，无法`b`在此函数的主体中检索数组的大小：

```
void func(int index, struct foo b[]) {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:53:33.420

访问超出其边界的数组会导致未定义的行为。但是，C 没有自动数组边界检查。所以这可能会导致崩溃，但不能保证它会。通常它只是溢出到恰好位于内存中相邻的某个对象中。

请注意，如果`b`是指针，而不是数组，则`b[-2]`可能是有效的。例如

```
typedef struct foo {
   int c[5];
} foo_struct;
foo_struct x[10];
foo_struct *b = &x[3]; 
```

如果你现在这样做：

```
a[0][0] = b[-2].c[0]; 
```

这相当于做：

```
a[0][0] = x[1].c[0]; 
```

在这种情况下，相关的数组边界是`x`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:45:52.530

```
b[-2] 
```

是相同的

```
*(b - 2) 
```

这显然是错误的。未定义的行为，访问您不拥有的内存。UB 并不意味着你的程序会崩溃，它意味着*你的程序的行为是 undefined*。

# c# - 是否可以从 .NET 用户类中删除或解决冲突？

> ID：15033399
> 
> 赞同：1
> 
> 时间：2013-02-22T21:22:36.823
> 
> 标签：c#, asp.net-mvc

在我的 .NET MVC 项目中，我有一个名为 User 的模型，当我在剃刀视图中时，它的类与 System.Security.Principal.IPrincipal.WebPageRenderingBase.User 冲突。（并且仅在剃刀视图内）。

有没有办法给我的班级一个不同的全局别名？或者更好的是，阻止这个 .NET 类出现？

我不想要一个冗长的解决方案。（前缀）有没有办法删除对这个愚蠢的用户属性的引用？

这是每个人的常见问题还是我的设置有问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-06-25T02:50:38.080

只需将您的模型类从 重命名`User`为`Person`。每个解决方案都会以不必要的复杂性使您的代码膨胀。

另一件事：如果您使用名为`User`99% 的类，则可以确定您在视图中使用模型，最好的方法是使用 ViewModel，您可以在其中收集需要传递给视图的所有数据。因此，在视图中，用户将成为该视图模型的一个属性。

这种方法还可以帮助您消除使用 ViewBags 和类似...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-22T21:25:31.643

完全符合您的课程，即

```
MyNamespace.Core.User 
```

而不仅仅是

```
User 
```

虽然我有点困惑，因为

```
System.Security.Principal.IPrincipal.WebPageRenderingBase.User 
```

是类型的属性而`IPrincipal`不是称为的类型`User`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-25T02:33:42.490

我通常会执行以下操作：

```
using m = MyProject.MyNameSpace.MySubNameSpace;

var u = new m.User(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-06-28T08:13:05.333

这有点混合了@devlife 和@Romias 的答案。

通过实现`using`别名，您可以将您的类“重命名”（在文件中定义的文件中）为您在语句中`User`指定的内容。`using`

例如：

```
using Person = NameSpace.SubNameSpace.Classes.User 
```

然后，您可以在定义此别名的文件中`Person`用作您的类。`User`

请参阅：http: [//msdn.microsoft.com/en-us/library/sf0df423 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/sf0df423(v=vs.71).aspx)

最后一节提供了一个完整的代码示例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-25T01:42:02.683

也许伟大的 Jon Skeet 有你的答案：

“ [Visual Studio 8 中程序集引用的 Aliases 属性有什么用](https://stackoverflow.com/questions/286632/)”：

> 这是针对“外部别名”的。假设您要使用两种不同的类型，它们都称为 Foo.Bar（即 Foo 命名空间中的 Bar）。这两种类型将位于不同的程序集中（根据定义） - 您使用 VS 中的属性将别名与每个引用关联，然后您可以执行以下操作：
> 
> ```
> extern alias FirstAlias;
> extern alias SecondAlias;
> 
> using FirstBar = FirstAlias::Foo.Bar;
> using SecondBar = SecondAlias::Foo.Bar; 
> ```
> 
> 然后在您的代码中使用 FirstBar 和 SecondBar。
> 
> 所以基本上它是一个额外的命名级别——除非你真的、真的必须这样做，否则你不应该使用它。它会让很多人感到困惑。一开始就尽量避免陷入这种情况——但在你无法避免的时候要注意这个解决方案。

# android - Google maps api v2 android 其他国家的空白地图

> ID：15033403
> 
> 赞同：1
> 
> 时间：2013-02-22T21:23:03.553
> 
> 标签：android, google-maps-api-2

我来自委内瑞拉，我使用 google map api v2 for android 开发了一个应用程序，我的应用程序在这里运行良好，但是西班牙的一个朋友运行该应用程序并且地图有一个空白屏幕。它显示缩放和当前位置的指示器，因此地图正在运行，但它不显示地图上的位置和地图本身。

# android - Vuforia AR 示例 App android？

> ID：15033405
> 
> 赞同：1
> 
> 时间：2013-02-22T21:23:05.613
> 
> 标签：android, augmented-reality, vuforia

我正在关注 Vuforia 并且我已经运行了示例，但是如果我想启动我们自己的应用程序怎么办，那么任何人都可以知道一些参考资料或书籍或任何可以帮助我第一次启动应用程序的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T21:28:50.840

不完全是 Vuforia，但我必须推荐以下内容：

查看 Raghav Sood 的书[Pro Android Augmented Reality](http://www.apress.com/9781430239451) 和他的[github 项目](https://github.com/RaghavSood/ProAndroidAugmentedReality)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T11:24:18.997

您可以将 vuforia 与 JPCT-AE 集成。[我在它的wiki](http://www.jpct.net/wiki/index.php/Integrating_JPCT-AE_with_Vuforia)上做了一个教程

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-07-31T21:04:40.097

阅读 Dominic Cushnan 的“为 iOS 和 Android 开发 AR 游戏”。使用 Vuforia 进行开发的书籍

# python - 在 Python 中实例化 - 不可调用

> ID：15033409
> 
> 赞同：0
> 
> 时间：2013-02-22T21:23:14.677
> 
> 标签：python, python-3.x

我正在尝试创建一个新对象，但我在回溯中收到错误：

```
 p1 = point(point.x+jumpValue, point.y)
TypeError: 'point' object is not callable 
```

我在同一个文件中定义了这个类：

```
class point(object):
    def __init__(self, x, y):
        self.x = x
        self.y = y 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T21:24:51.490

您有一个同名的变量*不是*类。重命名要使用的类`Point`：

```
class Point(object):
    def __init__(self, x, y):
        self.x = x
        self.y = y 
```

然后将其称为：

```
p1 = Point(point.x + jumpValue, point.y) 
```

# mysql - 在数据库中保存点历史记录

> ID：15033411
> 
> 赞同：0
> 
> 时间：2013-02-22T21:23:17.267
> 
> 标签：mysql, database, database-design

我有一个会员网站，每个用户每天都可以对足球比赛进行多次投注。这个想法是总结每一天的点，计算它们并将它们显示在图表中（使用谷歌图表API）。到目前为止一切都很好。每天都会为每个用户计算新积分，并与过去几天的积分一起显示在图表上。这样用户就可以在曲线或图形中看到他过去的结果。我唯一的猜测是制作一个带有 ID - 用户名 - 点数 - 回合的表格。我不希望我的数据库因我的表和查询构造不佳而受到影响。

所以我的问题是：我应该如何在我的数据库中进行设置？

这是我现在的桌子：

* * *

表 -> 成员
ID
名 姓
用户
名
密码

（我的虚构表）。

TABLE -> MEMBERS_POINTS
ID
用户名
积分
回合

* * *

所以我设置了一个查询，从所需的回合中获取用户积分。这是好方法吗？这会减慢我的数据库速度吗？每个用户将玩 30 轮游戏，如果有几个用户，该表可能包含数千行。

[在这里](https://stackoverflow.com/questions/14847202/how-should-i-setup-my-mysql-tables-for-this-simple-php-points-system)找到一个帖子，但我没有任何答案，我有一些不同的想法。

**编辑**

这是一个会员网站，每个注册用户都必须一次下所有 60 个赌注，60 个赌注在 30 天内分配（我称之为回合）。每轮包括 2 个投注，最多 6 分。总分将与领导者一起显示，并与每天的获胜者一起显示。每个用户都应该能够以图表的形式查看他或她过去的分数。

1 位用户 = 60 次投注 = 30 天（回合。总积分和每天的积分保持在记录中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T23:13:36.083

这里发生了几件事。

首先，您似乎关心性能。从性能的角度来看，您提到的设计应该没问题（尽管见下文） - 数据库非常擅长处理大量数据。在 MySQL 上，这样的设计可以增长到数百万条记录，而不会出现任何真正的性能问题。

其次，虽然存在设计问题。您确实应该[阅读](http://en.wikipedia.org/wiki/Unique_key)数据库设计-在一个问题中回答太大-但是您的 member_points 表应链接到 member.id 列（假设这是主键），而不是用户名-如果用户更改了用户名，您必须更新他们所有的 member_points 记录。

# focus - 如何在 JavaFX 2 中设置“默认”焦点节点？

> ID：15033415
> 
> 赞同：3
> 
> 时间：2013-02-22T21:23:29.733
> 
> 标签：focus, javafx-2

我正在尝试将我的特定设置`Node`为`Stage`“默认”键盘焦点节点。

让我解释一下：我首先调用`node.requestFocus()`一个 focusable `Node`，然后禁用并最终重新启用整个`Node`图的根。完成后，我发现键盘焦点已移动到其他一些可聚焦节点。我猜另一个节点是“默认”可聚焦节点，即`Node`从无法聚焦的禁用状态返回时获得焦点的节点`Node`。不幸的是，这不是我想要关注的节点！

有谁知道在这种情况下控制哪个节点获得键盘焦点的方法？实际上，如果有一种方法可以让 JavaFX 只记住先前关注的节点并返回到它，那就更好了。

# linux - 如何使用 touch 命令在指定目录创建文件

> ID：15033416
> 
> 赞同：5
> 
> 时间：2013-02-22T21:23:36.033
> 
> 标签：linux, touch

在 Linux 中`touch`- 命令创建文件。但它总是在当前目录中创建它。如何在指定目录中创建文件？

例如

```
touch file ../my_directory 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-22T21:24:55.457

尝试

```
touch ../my_directory/file 
```

虽然它不会创建 ../my_directory ，但我认为这不是你想要的。

# django - 覆盖 Django 字段的 + 运算符

> ID：15033426
> 
> 赞同：1
> 
> 时间：2013-02-22T21:24:01.807
> 
> 标签：django, django-models, operator-overloading

我想覆盖 Django 字段的 +- 运算符：

```
x+y --> x | y    (bitwise or)
x-y --> x & (~y) (almost the inverse of above) 
```

在哪里放置覆盖定义？下面是错误的：

```
class BitCounter(models.BigIntegerField):
    description = "A counter used for statistical calculations"
    __metaclass__ = models.SubfieldBase    

    def __radd__(self, other):
       return self | other

   def __sub__(self, other):
      return self & (^other) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:02:12.000

当您这样做时`myobj.myfield`，您访问的是由[字段`to_python`方法](https://docs.djangoproject.com/en/dev/howto/custom-model-fields/#django.db.models.Field.to_python)返回的类型的对象，而不是字段本身。这是由于 Django 的一些元类魔法。

* * *

您可能希望在此方法返回的类型上覆盖这些方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:15:01.690

首先，创建另一个继承自 int 的类：

```
class BitCounter(int):
    def __add__(self, other):
        return self | other

    def __sub__(self, other):
        return self & (~other) 
```

然后在字段的 to_python 方法中返回这个类的一个实例：

```
class BitCounterField(models.BigIntegerField):
    description = "A counter used for statistical calculations"
    __metaclass__ = models.SubfieldBase    

    def to_python(self, value):
        val = models.BigIntegerField.to_python(self, value)
        if val is None:
            return val
        return BitCounter(val) 
```

# c# - Asp.net 永久重定向 Body,Path,QueryString,Method

> ID：15033428
> 
> 赞同：1
> 
> 时间：2013-02-22T21:24:04.543
> 
> 标签：c#, asp.net

在我的场景中。

我想将所有请求重定向到另一个包含路径、查询字符串、方法、内容的域

示例 一些用户向我的域发送请求。

```
POST www.mydomain.com/service?id=5
HEADER { 
token:securityToken
UserAgent: Chrome
Accept: application/json
}
BODY
{
Content lorem ipsum
} 
```

我将检查一些参数并更改标头中的令牌。

然后

我想将此请求发送到另一个域。

```
POST www.anotherdomain.com/service?id=5
HEADER {
token:newsecurityToken
UserAgent: Chrome
Accept: application/json
}
BODY
{
Content lorem ipsum
} 
```

最后

用户将得到另一个域的响应。可能吗 ？

服务器：Windows 服务器 2008 .Net 框架：4.0

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:32:15.313

如果您想让请求通过您的域返回，最好的办法是向外部域发出您自己的请求。我会提供有关如何使用的更多详细信息，但我不知道您使用的是什么版本的 .net。这是一篇概述方法的帖子。

[在 asp.net 中中继请求（转发请求）](https://stackoverflow.com/questions/697177/relaying-a-request-in-asp-net-forwarding-a-request)

它基本上说创建一个新的`WebRequest`，设置相关属性，获取响应，并将响应中的信息发送回用户。

我觉得我不得不问这个，你确定你不是在尝试网络钓鱼或其他什么吗？转念一想，没关系。;)

更新：

由于您不需要它通过您的域，我建议使用 301 重定向。这是一个帖子，有人在开始请求中这样做

[在 asp.net 4.0 中的 301 重定向](https://stackoverflow.com/questions/10673303/301-redirect-in-asp-net-4-0)

> ```
> void Application_BeginRequest(object sender, EventArgs e) 
> {
>     // Code that runs on every request
>     if (HttpContext.Current.Request.Url.ToString().ToLower().Contains("http://website.net"))
>     {
>         HttpContext.Current.Response.Status = "301 Moved Permanently";
>         HttpContext.Current.Response.AddHeader("Location", Request.Url.ToString().ToLower().Replace("http://website.net", "http://www.website.net"));
>     }
> } 
> ```

请注意，如果没有任何复杂的逻辑来确定您是否要重定向，这篇文章还提供了一种通过在 web.config 中重写 url 的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:41:38.637

只是抛出一个想法，因为我以前从未见过这种方法，有没有理由你不能使用 SOAP Web 服务来完成这个？

[将值传递给对象到 webservices webmethod C#](https://stackoverflow.com/questions/9024625/pass-values-to-an-object-to-webservices-webmethod-c-sharp)

它们或多或少是为这种类型的东西创建的，会让你的生活变得更轻松。否则，您可以使用 URL 参数

[Asp.net 将参数添加到 url 字符串](https://stackoverflow.com/questions/7445517/asp-net-adding-parameter-to-url-string)

或者，只需适当地使用 POST 和 GET 请求传递值。POST 到域 B 并有一个侦听器等待解析这些值的 POST。我会选择网络服务，它们比看起来更容易。

# f# - F# 上转型基地

> ID：15033448
> 
> 赞同：3
> 
> 时间：2013-02-22T21:25:15.747
> 
> 标签：f#, f#-3.0, upcasting

当我想向上`base`转换到适当的接口类型（即`A`）以便我可以在其上调用 doA() 时，我得到一个解析错误。我知道`base`（[http://cs.hubfs.net/topic/None/58670](http://cs.hubfs.net/topic/None/58670)）有点特别，但到目前为止我还没有找到解决这个特定问题的方法。

有什么建议么？

```
type A =
    abstract member doA : unit -> string

type ConcreteA() =
    interface A with
        member this.doA() = "a"

type ExtA() = 
    inherit ConcreteA()

interface A with
    override this.doA() = "ex" // + (base :> A).doA() -> parse error (unexpected symbol ':>' in expression)

((new ExtA()) :> A).doA() // output: ex 
```

工作的 C# 等价物：

```
public interface A
{
    string doA();
}

public class ConcreteA : A {
    public virtual string doA() { return "a"; }
}

public class ExtA : ConcreteA {
    public override string doA() { return "ex" + base.doA(); }
}

new ExtA().doA(); // output: exa 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T21:41:18.073

这相当于您的 C#：

```
type A =
    abstract member doA : unit -> string

type ConcreteA() =
    abstract doA : unit -> string
    default this.doA() = "a"
    interface A with
        member this.doA() = this.doA()

type ExtA() = 
    inherit ConcreteA()
    override this.doA() = "ex" + base.doA()

ExtA().doA() // output: exa 
```

`base`不能独立使用，只能用于成员访问（因此解析错误）。请参阅[MSDN 上的类](http://msdn.microsoft.com/en-us/library/dd233205.aspx)下的*指定继承*。

# android - 小部件 TextView 调整大小

> ID：15033452
> 
> 赞同：0
> 
> 时间：2013-02-22T21:25:39.220
> 
> 标签：android, android-widget, resize, textview

我有一个小部件，显示了此处显示的两个 TextView：

![小部件屏幕截图](../Images/81a18f7eedb401248002b4faa2588cfa.png)

我想知道的是，调整小部件大小时是否可以调整文本大小？基本上使小部件可以调整大小。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:38:29.950

您需要实现小部件 XML 以填充父级，然后启用调整大小。

例如

```
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <TextView
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" />
</LinearLayout> 
```

`android:resizeMode="vertical"`将您的小部件标记为可调整大小`<appwidget-provider ... />`

现在在较新的 Android 版本上，当您调整屏幕上的小部件大小时，它将调整大小以填充。

对于锁屏小部件，您必须进行更多设置才能使小部件可调整大小。看看[App Widget 大小指南](http://developer.android.com/guide/topics/appwidgets/index.html#lockscreen-sizing)

这是相关部分

> 当小部件托管在锁屏上时，框架会忽略 minWidth、minHeight、minResizeWidth 和 minResizeHeight 字段。如果小部件也是主屏幕小部件，则仍需要这些参数，因为它们仍在家庭中使用，但出于锁定屏幕的目的，它们将被忽略。
> 
> 锁屏小部件的宽度始终填满提供的空间。对于锁屏小部件的高度，您有以下选项：
> 
> *   如果小部件未将自身标记为可垂直调整大小（android:resizeMode="vertical"），则小部件高度将始终为“小”：
>     *   在纵向模式的手机上，“小”定义为显示解锁 UI 时剩余的空间。
>     *   在平板电脑和横向手机上，“小”是基于每个设备设置的。
> *   如果小部件将自身标记为可垂直调整大小，则小部件高度在显示解锁 UI 的竖屏手机上显示为“小”。在所有其他情况下，小部件的大小以填充可用高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:47:09.837

除了@Kirk 的回答：如果您在画布（`Canvas.drawText(....)`）上绘制文本，那么如果您调整小部件的大小，小部件将自动调整文本的大小。不幸的是，应用小部件只能在 Android Honeycomb 及更高版本中调整大小。

# jquery - .prop disable 在 Chrome 和 Firefox 中不起作用

> ID：15033458
> 
> 赞同：2
> 
> 时间：2013-02-22T21:25:55.653
> 
> 标签：jquery, disable-link

我们正在使用 jquery-1.7.1 并试图在 asp.net 中隐藏一个按钮。该按钮是一个链接按钮控件。我们使用的代码如下

```
function checkDisabledButton(btn){
    var mbtn = $('#' + btn)
    mbtn.prop('disabled', true);
}; 
```

该按钮在 IE 中被禁用，但 Chrome 和 Firefox 没有被禁用。我看过很多关于它的帖子.. 但大多数人都在谈论需要 jQuery 1.7.. 我们已经在使用它。希望有人能伸出援手。

在查看了我一直在考虑更改为 asp:button 的响应后，该按钮将呈现为输入 type=submit。我真正想要的是能够调用一个函数来禁用控件。通过这种方式，我可以对多伙伴按钮和多伙伴页面使用相同的功能。我仍然没有让它工作，但考虑到这一点..我希望有人可以继续提供帮助。这是被调用的按钮控件

```
<asp:Button ID="lbApprove" runat="server" CssClass="ButtonPrimary button" Text="Approve" OnClientClick="return tryIt(this, 'PROCESSING');"/> 
```

一旦单击，tryIt 会将按钮的文本更改为我传入的任何内容（在本例中为“处理”）。再次......我希望按钮只能点击一次。我看过 .one 以及 .on 和 .off ，但还没有运气。我现在没有发布任何代码，因为它只是尝试到目前为止......

这是最新的，乍一看似乎可行。这不是 jQuery.. 但可能是一个开始。它在页面回发发生之前禁用按钮。它来自这篇文章。必须有一个正确的起点:)

[http://aspsnippets.com/Articles/Disable-Button-before-Page-PostBack-in-ASP.Net.aspx](http://aspsnippets.com/Articles/Disable-Button-before-Page-PostBack-in-ASP.Net.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:34:57.283

如果它是一个链接按钮，那么它会呈现为一个锚点。该`disabled`属性不是锚的标准属性。IE 工作的事实是非标准/未指定的行为。

作为证明，请参阅这个 jsfiddle，我不是通过 jquery 而是通过 html 属性[http://jsfiddle.net/5htFh/](http://jsfiddle.net/5htFh/)设置禁用的。请注意，在 FF 中它仍然遵循。所以无论如何，这不是 jquery 让你失望；事实上，`disabled`在 html4 规范下，锚点不是一个选项。

请参阅此 SO 线程，了解其他人如何推荐使用锚点：[如何使用 jQuery 启用或禁用锚点？](https://stackoverflow.com/questions/1164635/how-to-enable-or-disable-an-anchor-using-jquery)

# signalr - SignalR 客户端页面在经过随机时间后断开连接

> ID：15033462
> 
> 赞同：3
> 
> 时间：2013-02-22T21:26:24.007
> 
> 标签：signalr

我有一个管理“监控”页面，它连接到我的 SignalR 集线器，只监听所有 SignalR 广播消息，显示来自服务器的实时活动列表。但是，通常在经过任意且可变的持续时间之后，它就不再听到来自服务器的任何消息。

我曾相信 SignalR 连接可以自我修复。我认为我应该能够无限期地打开一个页面并让它仍然保持与服务器的实时连接，继续听到事件，这是否合理？如何解决此类问题？

# tfs - 如何从我的 TFS 服务器列表中删除 tfspreview？

> ID：15033464
> 
> 赞同：6
> 
> 时间：2013-02-22T21:26:28.003
> 
> 标签：tfs

我们已经停止使用 tfspreview，现在在 visualstudio.com 上。但是，在获取最新信息时，我不断收到奇怪的错误。首先，我想从服务器列表中删除 tfspreview。你怎么做到这一点？“删除”按钮被禁用。

![删除被禁用...](../Images/82503324923984c399872dd3183b28b5.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-11-11T22:23:47.943

在 Visual Studio 中，选择 Team 菜单并断开与 TFS 服务器的连接。然后导航到团队资源管理器并单击“选择团队项目”。窗口打开后，单击“服务器”按钮并选择要删除的服务器。由于您不再连接到 TFS 服务器，您现在可以单击删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-03T13:15:34.197

从**控制面板\所有控制面板项\凭据管理器**屏幕中删除 TFS 凭据。

# jquery - 使用jquery从body中的所有元素中过滤元素

> ID：15033466
> 
> 赞同：1
> 
> 时间：2013-02-22T21:26:31.923
> 
> 标签：jquery

如果我有一组 jquery 元素`var elements = $('.containers');`我如何选择正文中的所有内容，但该组元素并附加一个单击事件？我试过类似的东西，

```
var filtered = $('*').filter(function(index){
    return elements;
});

$(document).ready(function(){
    $('body').on('click', filtered, function(){
         alert('something on body was clicked that wasn't "element"');
     });
}); 
```

*这根本不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:28:47.193

使用[.not()](http://api.jquery.com/not/)选择器。

```
$('body').find('*').not('.containers').on('click',function(){
    // do something
}); 
```

最好将点击事件附加到比`$('body').find('*')`（这是正文的所有子元素）更具体的东西，但使用你给我的东西。或者你可以用不同的方式去做：

```
$('body').find('*').on('click',function(){
    // do something
});

$('.containers').off('click'); 
```

这将为所有内容设置它，然后仅为`.containers`项目删除它。有点冗长，但更明确，如果你改变主意，你只需要删除/修改[.off()函数。](http://api.jquery.com/off/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:29:00.983

只需过滤掉`.containers`元素，最好在附加事件处理程序之前：

```
$(document).ready(function(){
    $('*').filter(function() {
         return ! $(this).is('.containers');
    }).on('click', function(){
         alert('something on body was clicked that wasnt "element"');
    });
}); 
```

**编辑：**

如果您尝试通过单击外部来关闭下拉菜单、模式或类似内容，如评论所示，那么这样做的方法是：

```
$(function() {
    $(document).on('click', function(e) {
        if ( !$(e.target).closest('.containers').length ) {
            // you clicked outside
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T21:53:01.007

如果要检查 .container 和容器的后代，可以使用[.filter()](http://api.jquery.com/filter/)。[然后使用.closest()](http://api.jquery.com/closest/)检查当前元素是否 - 或有祖先元素有 class=container

```
$('body *').filter(function(){
    return $(this).closest('.containers').length === 0; 
}).on('click', function(){
     alert('something on body was clicked that wasn\'t "element" or inside element');
}); 
```

[小提琴](http://jsfiddle.net/5W2cd/)

这是另一个解决方案

```
$('body').on('click','*:not(.containers,.containers *)', function(){
     alert('something on body was clicked that wasn\'t "element" or inside element');
}); 
```

[小提琴](http://jsfiddle.net/ZatuM/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T21:30:28.190

更好的方法是在文档上只有一个处理程序，并检查当事件冒泡到文档时单击的元素。

```
$(document).on('click', function (event) {
    var $target = $(event.target);
    if ($target.hasClass('containers') || $target.closest('.containers').length > 0) {
        alert('something on body was clicked that wasn't "element"');
        return;    
    }

    // Rest of logic
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T22:21:28.860

另一种选择是简单地添加一个处理程序`$('html')`，然后确保容器处理程序调用`event.stopPropagation()`或返回 false，它处理在 jQuery 中自动停止的传播：

```
$('html').on('click', function () {
    alert("Clicked!");
});

$('.containers').on('click', function (event) {
    return false;
}); 
```

示例：http: [//jsfiddle.net/7hGL7/](http://jsfiddle.net/7hGL7/)

对于您正在做的事情，即关闭菜单，这是一个简单直接的解决方案。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-22T21:30:36.827

示例代码中的一个问题是警报中未转义的单引号。

至于排除某些元素，我建议使用您设置的路由（将事件附加到正文），然后检查事件目标是否具有给定的类。像这样：

```
$(document).ready(function(){
    $('body').on('click', function(e){
        if ($(e.target).hasClass('containers') || $(e.target).closest('.containers').length > 0)
            return; // do nothing with elements that have the container class
        alert('something on body was clicked that wasn\'t "element"');
     });
}); 
```

注意单词“don't”中多余撇号的转义：`don\'t`。

**文档和相关阅读**

*   `jQuery.hasClass`- [http://api.jquery.com/hasClass/](http://api.jquery.com/hasClass/)
*   `jQuery.closest`- [http://api.jquery.com/closest/](http://api.jquery.com/closest/)
*   *MDN 上的“值、变量和文字”* - [https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Values,_variables,_and_literals](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Values,_variables,_and_literals)

# checkbox - primefaces 的 selectBooleanCheckbox 出现问题

> ID：15033467
> 
> 赞同：0
> 
> 时间：2013-02-22T21:26:37.007
> 
> 标签：checkbox, primefaces

我有一个带有支持 bean 的 selectBooleanCheckbox，它将复选框的值设置为 true。这显示了在渲染时选中的框。（我想要什么）但是，当您单击该框（假设它应该取消选中）时，它会继续被选中。只有在第二次单击后，该框才会变为未选中状态。这导致另一个问题。如果从未单击该框（假设布尔值应等于 true，因为该值未更改），则该值将保存为 false 并且与我的逻辑不符。由于要求，我需要在加载时检查该框。注意：Ajax 似乎工作正常。这是我的代码：

html:

```
 <p:selectBooleanCheckbox id="testBox"
                widgetVar="textBoxVar"
                value="#{bean.testValue}">
                <p:ajax event="change" process="testValue">
                    <s:conversationId/>
                </p:ajax>
 </p:selectBooleanCheckbox> 
```

豆：

```
 Boolean testValue = 'true';

 public void setTestValue(Boolean test1){
    this.testValue = test1; 
  }

 public Boolean getTestValue(){
     return this.test;
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T17:25:58.817

首先这个结构：

```
Boolean testValue = 'true'; 
```

Java 中不存在，因此我将其视为输入错误。

其次你的`process="testValue"`似乎不对。您没有具有此 ID 的组件，至少这里没有。如果您只想处理此`p:selectBooleanCheckbox`使用`process="testBox"`或`process="@this"`.

另外，正如我所知道`s:conversationId`的来自 JBoss Seam 框架，我不知道工作是否正确`p:ajax`是您需要检查的工作，但要做好准备，这可能不适用于 Seam 对话。

# android - 从选中的单选按钮 Android 中检索值

> ID：15033468
> 
> 赞同：0
> 
> 时间：2013-02-22T21:26:39.873
> 
> 标签：android, radio-button, switch-statement, radio-group, user-feedback

我正在建立一个用户反馈表。该表格由多个`RadioGroups`. 每个`RadioGroup`里面有 5 个`RadioButtons`。

目前这是我检查每个组的值的方式。但是，这样做似乎很冗长且尴尬，有人可以提出一种更有效的方法来整理代码吗？

这是我的 XML 文件：

```
 <?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <!-- Activity Title -->

        <TextView
            android:id="@+id/feedbackTitle"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dp"
            android:text="@string/feedbackTitletxt"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <!-- Description box -->

        <TextView
            android:id="@+id/feedbackInfo"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dp"
            android:text="@string/feedbackInfotxt" />

        <!-- Name -->

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:id="@+id/nameLabel"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/nameLabeltxt" />

            <EditText
                android:id="@+id/nameEntryBox"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="10dp"
                android:ems="10"
                android:inputType="textPersonName" />

        </LinearLayout>

        <!-- County -->

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:id="@+id/countyLabel"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/countyLabeltxt" />

            <Spinner
                android:id="@+id/countySpinner"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_marginBottom="10dp"
                android:layout_weight="1" />

        </LinearLayout>

        <!-- Date of Birth -->

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical" >

            <TextView
                android:id="@+id/dobLabel"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginBottom="5dp"
                android:text="@string/dobLabeltxt" />

            <DatePicker
                android:id="@+id/datePicker"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginBottom="10dp" />

        </LinearLayout>

        <!-- Atmosphere -->

        <TextView
            android:id="@+id/atmosphereLabel"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:text="@string/atmosphereLabeltxt" />

        <RadioGroup
            android:id="@+id/atmospheregroup"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginBottom="10dp"
            android:orientation="horizontal" >

            <RadioButton
                android:id="@+id/arad1"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginLeft="5dp"
                android:layout_weight="1"
                android:text="@string/radVal1" />

            <RadioButton
                android:id="@+id/arad2"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:layout_marginLeft="15dp"
                android:layout_weight="1"
                android:text="@string/radVal2" />

            <RadioButton
                android:id="@+id/arad3"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginLeft="15dp"
                android:layout_weight="1"
                android:text="@string/radVal3" />

            <RadioButton
                android:id="@+id/arad4"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginLeft="15dp"
                android:layout_weight="1"
                android:text="@string/radVal4" />

            <RadioButton
                android:id="@+id/arad5"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical"
                android:layout_marginLeft="15dp"
                android:layout_weight="1"
                android:text="@string/radVal5" />
        </RadioGroup>

        <!-- Service -->

        <TextView
            android:id="@+id/serviceLabel"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:text="@string/serviceLabeltxt" />

            <RadioGroup
                android:id="@+id/sevicegroup"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:layout_marginBottom="10dp"
                android:orientation="horizontal" >

                <RadioButton
                    android:id="@+id/srad1"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_marginLeft="5dp"
                    android:layout_weight="1"
                    android:text="@string/radVal1" />

                <RadioButton
                    android:id="@+id/srad2"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_marginLeft="15dp"
                    android:layout_weight="1"
                    android:text="@string/radVal2" />

                <RadioButton
                    android:id="@+id/srad3"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_marginLeft="15dp"
                    android:layout_weight="1"
                    android:text="@string/radVal3" />

                <RadioButton
                    android:id="@+id/srad4"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_marginLeft="15dp"
                    android:layout_weight="1"
                    android:text="@string/radVal4" />

                <RadioButton
                    android:id="@+id/srad5"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_marginLeft="15dp"
                    android:layout_weight="1"
                    android:text="@string/radVal5" />
            </RadioGroup>

        <!-- Rating Bar -->

        <TextView
            android:id="@+id/overallLabel"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:text="@string/overallLabeltxt" />

        <RatingBar
            android:id="@+id/ratingBar1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginBottom="10dp" />

        <!-- Submit Button -->

        <Button
            android:id="@+id/submitFormBtn"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="@string/submitFormBtntxt" />
    </LinearLayout>

</ScrollView> 
```

这是我的活动：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.feedback_scroll);

    // References to XML - Reference required to every component on the
    // form.
    name = (EditText) findViewById(R.id.nameEntryBox);
    county = (Spinner) findViewById(R.id.countySpinner);
    // Set array adapter
    county.setAdapter(fillCountySpinner());
    date = (DatePicker) findViewById(R.id.datePicker);
    atmosGroup = (RadioGroup) findViewById(R.id.atmospheregroup);
    atmo1 = (RadioButton) findViewById(R.id.arad1);
    atmo2 = (RadioButton) findViewById(R.id.arad2);
    atmo3 = (RadioButton) findViewById(R.id.arad3);
    atmo4 = (RadioButton) findViewById(R.id.arad4);
    atmo5 = (RadioButton) findViewById(R.id.arad5);
    servGroup = (RadioGroup) findViewById(R.id.sevicegroup);
    ser1 = (RadioButton) findViewById(R.id.srad1);
    ser2 = (RadioButton) findViewById(R.id.srad2);
    ser3 = (RadioButton) findViewById(R.id.srad3);
    ser4 = (RadioButton) findViewById(R.id.srad4);
    ser5 = (RadioButton) findViewById(R.id.srad5);
    rating = (RatingBar) findViewById(R.id.ratingBar1);
    submitBtn = (Button) findViewById(R.id.submitFormBtn);

    // Add a listener to the submit button - Anonymous inner class
    submitBtn.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // Create a new Intent.
            Intent i = new Intent(v.getContext(), FeedbackResults.class);

            // Add extra parameters using putExtra() method. extras are
            // essentially a Bundle of additional information we want to
            // pass to a new activity.
            // It is similar to a map in the sense that is uses key value
            // pairs.

            // Name - Get name from EditText box and convert to string.
            i.putExtra("name", name.getText().toString());
            // County - getSelectedItem() will return data of currently
            // selected item. Convert this to a String.
            i.putExtra("county", county.getSelectedItem().toString());

            // DOB - dd/mm/yyyy format.
            i.putExtra("day", date.getDayOfMonth());
            i.putExtra("month", date.getMonth());
            i.putExtra("year", date.getYear());

            // Atmosphere - assign the checked buttons id to id variable and
            // pass to method which will assign "atmos" a value based on
            // radio button selected.
            id = atmosGroup.getCheckedRadioButtonId();
            getAtmosphere(id);
            i.putExtra("atmosphere", atmos);

            // Service - assign the checked buttons id to id variable and
            // pass to method which will assign "serv" a value based on
            // radio button selected.
            id = servGroup.getCheckedRadioButtonId();
            getService(id);
            i.putExtra("service", serv);

            // Rating - As the rating is a Float and we cannot display a
            // Float in a TextView we must convert to a string.
            i.putExtra("rating", Float.toString(rating.getRating()));

            // Start new Activity that will display a review of the
            // customers feedback. Pass the intent to the method. This
            // intent contains all of the data in it's extras array.
            startActivity(i);
            finish();

            // Toast message - Create a Toast Object to inform user that
            // feedback was submitted.
            Toast.makeText(v.getContext(), "Thank you for your feedback!",
                    Toast.LENGTH_LONG).show();

        }
    });
} 
```

在这个电话中，我为每个不同的组写了这个方法。

```
// Called when the user presses the submit button. The id of the radioButton
// that was checked is passed to the method.
public void getAtmosphere(int id) {

    // Switch statement will check if the ID matches any of the cases.
    switch (id) {
    case R.id.arad1:
        atmos = "1";
        break;
    case R.id.arad2:
        atmos = "2";
        break;
    case R.id.arad3:
        atmos = "3";
        break;
    case R.id.arad4:
        atmos = "4";
        break;
    case R.id.arad5:
        atmos = "5";
        break;
    }
} 
```

以上工作正常，没有错误，但我只想知道如何改进它！非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:34:39.390

> 然而，这样做似乎很冗长和尴尬

RadioGroups 只是啰嗦...您可以编写更少的代码：

```
TextView checked = (TextView) findViewById(amosgroup.getCheckedRadioButtonId());
atmos = checked.getText().toString(); 
```

（`getCheckedRadioButtonId()`本身就很啰嗦！）但这假设每个 RadioButton 的文本是“1”、“2”等，并且`findViewById()`比 switch 语句慢......

* * *

或者您可以使用 an[`OnCheckedChangedListener`](https://developer.android.com/reference/android/widget/RadioGroup.OnCheckedChangeListener.html)这样您就不必调用`getCheckedRadioButtonId()`. 但是每次用户点击一个新的 RadioButton 时都会调用这个，如果你只需要“最终答案”，它会慢几毫秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:37:01.970

好吧，由于您的 id 和您制作的结果字符串是合乎逻辑的（`"1"`for`arad1`等），您可以使用[此答案](https://stackoverflow.com/a/10138018/1815485)将 id 作为字符串获取。当然，如果您的按钮已经使用数字作为文本，那么使用它会更容易。

所以这样的事情可能会起作用：

```
String s =  getResources().getResourceEntryName(id);
atmos = s.substring (s.length()-1); 
```

# ios - UIView在动画后没有返回到正确的位置

> ID：15033471
> 
> 赞同：0
> 
> 时间：2013-02-22T21:26:55.107
> 
> 标签：ios, animation, uiview, nsnotificationcenter, uikeyboard

我有一个简单`UITextField`的，当有人去编辑它并且键盘弹出时，视图会向上移动，以便用户可以看到他们正在输入的内容。但是，当我关闭键盘时，视图并没有回到原来的位置！我正在使用一个`CGPoint`属性来捕获其原始位置`viewDidLoad`，然后尝试将其设置回键盘关闭时的位置。

代码：

```
- (void)viewDidLoad {

    [super viewDidLoad];

    // Set the original center point for shifting the view
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardDidShow:) name:UIKeyboardDidShowNotification object:nil];
    self.originalCenter = self.view.center;
}

- (void)doneWithNumberPad {

    [locationRadius resignFirstResponder];

    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.25];
    self.view.center = self.originalCenter;
    [UIView commitAnimations];
}

- (void)keyboardDidShow:(NSNotification *)note
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.25];
    self.view.center = CGPointMake(self.originalCenter.x, 150);
    [UIView commitAnimations];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:33:46.397

调用时`viewDidLoad`，您的视图层次结构尚未针对当前设备的屏幕大小或方向进行布局。现在看还为时过早`self.view.center`。

`viewDidLayoutSubviews`代替它。

```
- (void)viewDidLayoutSubviews {
    [super viewDidLayoutSubviews];
    self.originalCenter = self.view.center;
} 
```

请注意，如果您支持自动旋转，如果在自动旋转发生时键盘是可见的，即使这也无法正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T23:23:11.163

如果您不需要绝对的最终中心位置，那么实现此功能的可靠方法是在键盘显示时将视图上移一个您定义的固定值，并在键盘隐藏时将其下移该固定值.

```
#define OFFSET 100

- (void)doneWithNumberPad {
    [locationRadius resignFirstResponder];

    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.25];
    self.view.center = CGPointMake(self.view.center.x, self.view.center.y + OFFSET);
    [UIView commitAnimations];
}

- (void)keyboardDidShow:(NSNotification *)note
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.25];
    self.view.center = CGPointMake(self.view.center.x, self.view.center.y - OFFSET);
    [UIView commitAnimations];
} 
```

# html - HTML5 可拖动的幽灵图像并不总是显示在 Chrome 中

> ID：15033472
> 
> 赞同：3
> 
> 时间：2013-02-22T21:26:55.583
> 
> 标签：html, google-chrome, draggable

我的笔记本电脑上有 Chrome，台式机上有一个。它们是完全相同的版本，并且它们似乎具有相同的设置。但是当我在笔记本电脑上拖动时，会出现重影图像。当我在桌面上拖动时，不会出现重影图像。

例如，[使用此演示](http://www.w3schools.com/html/tryit.asp?filename=tryhtml5_draganddrop)，当我在笔记本电脑上拖动图像时，我看到徽标的幻影随着光标移动。在我的桌面上，我看不到它。如果它们是不同的浏览器或版本我可以理解，但它们是相同的版本，那么谁在控制是否出现重影？是否有设置或可能是操作系统差异（它们都是 Windows，但一个是 7，另一个是服务器）？

编辑：相同版本的 Firefox 中的相同奇怪行为。幽灵在一台机器上不存在，而在另一台机器上出现。IE幽灵也没有出现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-12T20:40:47.203

我怀疑您的两种设置之间的区别在于，一种是在 Windows Aero 桌面组合上运行，而另一种则不是。如果您安装 Windows 7 桌面并将其切换到“经典”桌面（右键单击桌面 > 个性化 > 基本和高对比度主题 > Windows 经典），则拖动幽灵将在 Windows 7 上的 Chrome 中停止工作。为什么 Chrome 需要 Aero拖鬼工作我不确定。

IE10 和 Opera 在经典桌面模式下运行时也不会显示重影。

# javascript - 使用 serialScroll jQuery 插件停止在页面中循环

> ID：15033480
> 
> 赞同：2
> 
> 时间：2013-02-22T21:27:40.783
> 
> 标签：javascript, jquery, jquery-plugins, serialscroll

我正在为网站使用 jQuery 插件，但我并不是最擅长 javascript。这段代码中的什么使脚本不断循环，我在哪里可以停止它？我不确定它来自哪里/是否来自这个脚本，或者我是否应该寻找其他地方......

```
 jQuery(function( $ ){   
    var $slideshow = $('#slideshow');
    var $homeslidernav = $('#navigation li button');
    var $prev = $('button.prev');
    var $next = $('button.next');
    $('#welcome h1').lettering();
    var intval = 7200;
    function ResetFunction() {
        TweenMax.killAll(true, false, true); 
    };
    function Slide1Function() {
        var Slide1 = new TimelineMax();         
        $('#section1').append([
            Slide1.to( $('.head_animation'), .2, {css:{display: 'block', opacity: '1'}}),
            Slide1.to( $('.head2_animation'), .2, {css:{ display: 'block', opacity: '1'}}),
            Slide1.from( $('.head2_animation'), 1.8, {css:{ top: '300px'}, ease:Expo.easeInOut}, -1.5),
            Slide1.from( $('.head_animation .char1'), .25, {css:{top: '-200px', right:'1000px'}, ease:Elastic.easeOut}),
            Slide1.from( $('.head_animation .char2'), .25, {css:{top: '300px', right:'1000px'}, ease:Elastic.easeOut}),
            Slide1.from( $('.head_animation .char3'), .25, {css:{top: '-400px', right:'1000px'}, ease:Elastic.easeOut}),
            Slide1.from( $('.head_animation .char4'), .25, {css:{top: '-200px', left:'1000px'}, ease:Elastic.easeOut}),
            Slide1.from( $('.head_animation .char5'), .25, {css:{top: '200px', left:'1000px'}, ease:Elastic.easeOut}),
            Slide1.from( $('.head_animation .char6'), .25, {css:{top: '-200px', left:'1000px'}, ease:Elastic.easeOut}),
            Slide1.from( $('.head_animation .char7'), .25, {css:{top: '200px', left:'1000px'}, ease:Elastic.easeOut}),

            Slide1.from( $('.head_animation .char1'), .3, {css:{color: '#4f3f35', fontFamily: 'MenschBold'}}),
            Slide1.from( $('.head_animation .char2'), .3, {css:{color: '#4f3f35', fontFamily: 'MenschBold'}}),
            Slide1.from( $('.head_animation .char3'), .3, {css:{color: '#4f3f35', fontFamily: 'MenschBold'}}),
            Slide1.from( $('.head_animation .char4'), .3, {css:{color: '#4f3f35', fontFamily: 'MenschBold'}}),
            Slide1.from( $('.head_animation .char5'), .3, {css:{color: '#4f3f35', fontFamily: 'MenschBold'}}),
            Slide1.from( $('.head_animation .char6'), .3, {css:{color: '#4f3f35', fontFamily: 'MenschBold'}}),
            Slide1.from( $('.head_animation .char7'), .3, {css:{color: '#4f3f35', fontFamily: 'MenschBold'}})       
        ]);
    };
    $slideshow.serialScroll({
        target:'#sections',
        items:'li.slide',
        prev: $prev,
        next: $next,
        axis:'xy',
        navigation: $homeslidernav,
        interval:intval,
        duration:0,
        force:true,
        constant:false,
        onBefore:function( e, elem, $pane, $items, pos ){
            $homeslidernav.removeClass('active');
            $homeslidernav.removeAttr("disabled"); 
            $homeslidernav.eq(pos).addClass('active');
            $homeslidernav.eq(pos).attr("disabled", "disabled");
            $('#sections li.slide').removeClass('first'); 
            $('#sections li.slide').removeClass('current'); 
            $('#sections li.slide').eq(pos).addClass('current');
            if($('#section1.current').length > 0) {
                Slide1Function();
            }
            else {
                ResetFunction();
                $('.head_animation').css({'display': 'none', 'opacity':'0'});
                $('.head2_animation').css({'display': 'none', 'opacity':'0'});
            };
            e.preventDefault();
            if( this.blur )
                this.blur();
        },
        onAfter:function( elem ){
            if($('#section1.first').length > 0) {
                Slide1Function();
            }
        }
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:44:33.847

从@Barmar 发布的文档看来，它`serialScroll`具有 start 和 stop 属性。如果没有看到您的其余代码，包括您的实现方式，很难说。但我猜这`force: true`是迫使它开始，但你没有`stop.serialScroll`在任何地方打电话

```
start.serialScroll (Re)starts autoscrolling
stop.serialScroll Stops the autoscrolling 
```

# linux - 在 AWK 中读取两个文件

> ID：15033481
> 
> 赞同：0
> 
> 时间：2013-02-22T21:27:43.047
> 
> 标签：linux, awk, file-handling

我有一个看起来像这样的文件：

```
1   4
2   4
3   5
4   4
5   4
6   1
7   1
8   1
9   4
10  4
12  1
13  1
14  1
15  1
16  2
19  3
20  1
21  1
26  1
28  3
24  4
29  4
30  1 
```

第 1 列是序列号，第 2 列是值。我想计算特定范围之间的值之和，例如：将 column2 中介于 2 和 7 之间的值相加（来自 column1）

我通过以下 awk one liner 实现了这一点：

```
awk '{if ($1 >= 2 && $1 <= 7) x += $2 } END {print x}' file_name #output is 20 
```

问题是我想从其他文件 2 中读取范围：从 3-9、2-6、12-20 等

```
3 9
2 6
12 20 
```

我如何将 file2 的范围传递给 AWK，而不是使用 if 语句手动输入范围。如何在 AWK 中读取多个文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:46:09.380

您可以尝试另一个：

```
awk '
  NR==FNR{
    A[$1]=$2
    next
  }
  {
    t=0
    for(i in A) if(i>=$1 && i<=$2) t+=A[i]
    print t
  }
' file rangefile 
```

或者在一行中：

```
awk 'NR==FNR{A[$1]=$2; next}{t=0; for(i in A) if(i>=$1 && i<=$2) t+=A[i]; print t}' file rangefile 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:32:20.310

您可以通过几种方式读取多个文件。您可以在命令行上指定多个文件，在这种情况下 awk 将读取每个文件一次，或者您可以使用`getline`从文件中读取一行。然而，在这种情况下，最简单的方法可能是执行计算成本更高的事情，并且只为 file2 中指定的每个范围读取一次 file1，但不要使用 awk 来读取范围。就像是：

```
while read lower upper; do
awk '$1 >= lower && $1 <= upper{ x += $2 } END {print x}' \
    lower=$lower upper=$upper file1
done < file2 
```

如果您只想读取 file1 一次，则可以执行更复杂的操作，例如（未经测试）：

```
awk 'NR==FNR{ lo[NR]=$1; hi[NR]=$2; next } 
    { for( i in lo ) if( $1 >= lo[i] && $1 <= hi[i] ) sum[i]+=$2 }
    END{ for( i in b ) print "sum of " lo[i] " to " hi[i] ": " sum[i] }' file2 file1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T12:10:58.097

这是一种使用方法`awk`：

```
awk 'NR==FNR { a[$1]=$2; next } { for (i in a) { i+=0; if (i>=$1 && i<=$2) s+=a[i] } print s; s=0 }' file1 file2 
```

结果：

```
20
18
10 
```

# qt - BB10 Cascades - 模拟触摸事件

> ID：15033490
> 
> 赞同：2
> 
> 时间：2013-02-22T21:28:20.060
> 
> 标签：qt, touch-event, blackberry-cascades

我正在尝试在 BB10 应用程序上模拟触摸事件。我的主要目标是创建一个触摸事件，例如，像素 (100,100) 并让应用程序处理它。这是自动化 GUI 测试的一部分，有助于进一步部署。

我已经搞砸了几天了，真的没有任何进展。我尝试过模拟触摸事件，然后使用 Qt 发送事件发送它们，但这似乎不起作用。我有什么方法可以“发送” ontouch 信号吗？非常感谢任何帮助，因为我正在慢慢放弃。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T13:02:57.367

创建触摸目标。对于 BlackBerry 智能手机，创建至少 101 x 101 像素（7.2 毫米）的触摸目标。

# ios - 默认键盘按钮的帧大小

> ID：15033491
> 
> 赞同：0
> 
> 时间：2013-02-22T21:28:34.937
> 
> 标签：ios, objective-c, ipad

是否有位置可以找到，或者有人知道苹果 ipad 键盘上基本按钮的框架大小吗？如果可能的话，其他按钮，如返回键等？我想现在我们可以忽略它们实际上是基于方向不同的大小......

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:30:44.693

您是否尝试过 iOS Artwork Extract 项目？[https://github.com/0xced/UIKit-Artwork-Extractor](https://github.com/0xced/UIKit-Artwork-Extractor)

它会让你提取出 UIKit 中使用的确切图像，然后你可以自己测量它们。:)

# php - 从 exec() 运行脚本时 PHP ini_set("max_execution_time") 失败

> ID：15033493
> 
> 赞同：2
> 
> 时间：2013-02-22T21:28:41.310
> 
> 标签：php, exec, php-ini

简单地说：

当我通过经典 URL 调用调用 script.php 时，ini_set("max_execution_time")**有效**

当 script.php 从另一个 php 脚本/进程通过 exec() 函数运行时，ini_set("max_execution_time")**不起作用。**

现在，我的解决方案不是简单地中继选项 1，因为它可以工作，因为即将激活 script.php 的 exec() 函数和很少有类似的函数是通过（外部）cron 作业调用的。

有谁知道发生了什么？

如果它来自下面的帮助正在激活代码：

```
exec('/usr/bin/env php ./script.php');
sleep(30);
exec('/usr/bin/env php ./script2.php'); 
```

它激活了 script 和 script2.php，当 ini_set() 返回 FALSE 时它们都失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:41:12.510

正如 Barmar 指出的，有几个用于 php 的 INI 文件。至少一个用于 CGI，一个用于 CLI。您也可以通过 ini_set 或 .htaccess 内部设置一些东西。有一些配置文件定义了哪些设置可以在哪里更改。安静，您可能不允许在 CLI 脚本中修改 max_execution_time。如果我没记错的话，默认情况下它应该是 0 也就是无限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:46:52.110

正如[Barmar](https://stackoverflow.com/users/1491895/barmar)上面所说，两个版本使用不同的 PHP.ini 文件。

CLI 版本是否在安全模式下运行？

在安全模式下使用 ini_set() 可能无法在运行时设置 max_execution_time。此外，CLI 版本的执行时间限制默认为 0。

[http://php.net/manual/en/info.configuration.php](http://php.net/manual/en/info.configuration.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-15T16:21:26.277

如果您启用它，这可能是**xdebug**，因为它默认时间为 0（以防止您的脚本在设置断点时超时）。它可能会将其锁定为 0。这对我来说是个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T21:35:21.433

使用 set_time_limit(seconds) 而不是 ini_set()

# sql - 如何加入一对多关系

> ID：15033499
> 
> 赞同：0
> 
> 时间：2013-02-22T21:28:58.373
> 
> 标签：sql, join

我正在尝试加入 3 个表...月、monthly_results 和 issue_results。每月只有一个monthly_results 记录，但每月有0 到n 个issue_results。当没有 Issue_results 时，我可以设置 Left Join 以获取 Month_results。我的问题是当我在一个月内有多个 issue_results 时。我只希望在我的结果集中出现一次month_results ...否则我们会在报告每月总数时重复计算结果。

例如，这里是表格

月 1,2,3

月度结果（月，份）
(1, 5000)
(2, 2500)
(3, 1000)

问题结果（问题、月份、订单）
(1,1,750)
(2,1,500)
(3,3,250)

当我加入表格时，我想看到以下内容：

（月、期、份、订单）
1, 1, 5000, 750
1, 2, , 500
2, , 2500,
3, 3, 1000, 250

使用左外连接我可以获得第二个月（正确填充没有问题），但不幸的是，我在第二个月得到以下重复的每月结果 1 ...

1, 1, 5000, 750
1, 2, **5000** , 500
2, , 2500,
3, 3, 1000, 250

非常感谢任何和所有建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-12T03:33:22.527

给定表格中没有足够的信息来确定 5000 份副本与第 1 个月中的哪个问题相关联。您要查找的结果显示与第 1 期而不是第 2 期关联的 5000 个副本，但表中没有信息可以区分。澄清：

包含第 1 个月信息的表格行如下：

每月结果：

```
 (Month, Copies)
    (1,5000) 
```

问题结果：

```
 (Issue, Month, Orders)
    (1,1,750)
    (2,1,500) 
```

这样看，您可以从 Monthly Results 表中看到，与 5000 个副本关联的唯一一条信息是第 1 个月。因此，当您加入 Issue Results 时，第1 个月的**两个问题**都匹配到 5000 个副本。

要获得您正在寻找的结果，或者：

1）您的第一个表需要包含问题（月，问题，副本）
2）或者您需要说明如何选择哪个问题“获取”副本（在这种情况下）每月有 >1 个问题）。sgeddes 提供了一个很好的解决方案，即当月的第一期是获取副本的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:50:20.297

根据您的 RDBMS，有不同的方法可以实现这一点。

这是一个MySQL解决方案：

```
SELECT M.Month, 
  I.Issue,
  @copies:=IF(@prevMonth=M.Month,NULL,M.Copies) copies,
  I.Orders,
  @prevMonth:=M.Month
FROM MonthResults M
  LEFT JOIN IssueResults I ON M.Month = I.Month
  JOIN (SELECT @copies:=0) t; 
```

[小提琴演示示例](http://sqlfiddle.com/#!2/89924/2)

这是一个更通用的方法，应该适用于大多数 RDBMS：

```
SELECT M.Month, 
  I.Issue,
  T.Copies,
  I.Orders
FROM MonthResults M
  LEFT JOIN IssueResults I ON M.Month = I.Month
  LEFT JOIN (
      SELECT Min(I.Issue) minIssue,
        M.Month, M.Copies
      FROM MonthResults M LEFT JOIN IssueResults I ON M.Month=I.Month
      GROUP BY M.Month, M.Copies
) t ON M.Month = t.Month AND (I.Issue = t.minIssue OR I.Issue IS NULL) 
```

[还有另一个小提琴演示](http://sqlfiddle.com/#!3/e9490/1)

# api - 创建匿名相册 imgur api 版本 3

> ID：15033506
> 
> 赞同：0
> 
> 时间：2013-02-22T21:29:24.963
> 
> 标签：api, imgur

如何使用 imgur API 版本 3 创建匿名相册（不绑定帐户）？

我已经尝试了所有我能想到的方法，但我总是得到 403 禁止或 405 方法不允许......

```
POST https://api.imgur.com/3/album HTTP/1.1
Authorization: Client-ID ***
Host: api.imgur.com
Content-Length: 22
Expect: 100-continue
Connection: Keep-Alive

{"title":"album title"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:31:23.377

根据[此页面](http://api.imgur.com/models/gallery_album)，您将`account_url`密钥设置为`null`。

# hibernate - 无法阻止 Hibernate 打开太多连接

> ID：15033508
> 
> 赞同：1
> 
> 时间：2013-02-22T21:29:35.617
> 
> 标签：hibernate, hibernate-mapping

我正在使用：Hibernate 3.6.8 和 mySQL、Tomcat 6、JDBC 连接池

我遇到了 Hibernate 打开大量连接的问题，这最终导致我的 Web 应用程序无法获得新连接。起初我以为问题是我在没有连接池的情况下运行，所以我连接了 Tomcat JDBC 池。

这使问题变得更糟。它没有在几次查询后失败，而是立即失败。原来这是因为 Hibernate 试图打开比我的池大小（30）更多的连接。我检查了一下，在我创建 EntityManager 的任何地方，如果有尝试，我都会在 finally 子句中调用 close()，所以我不确定它们为什么保持打开状态。

查看 close() 的源代码，我发现如果有一个事务打开，它实际上并没有关闭，所以我尝试在实体管理器上调用 getTransaction().commit()，即使它只是一个选择语句。这没有效果。然后我发现了这个配置标志，并将其打开：
`<property name="hibernate.ejb.discard_pc_on_close" value="true" />`

这有所不同，当我尝试渲染对象以进行输出时出现异常：未能延迟初始化角色集合：XXX.Comment.attachments，没有会话或会话已关闭

问题似乎是我进行了许多查询来创建评论集合，并且所有这些查询都保持连接打开。Comment 类包含以下内容：

```
@OneToMany
@JoinTable(name = "Object", joinColumns = { @JoinColumn(name = "parentId") }, inverseJoinColumns = { @JoinColumn(name = "id") })
public List<Attachment> getAttachments()
{
    if (attachments == null)
    {
        attachments = new ArrayList<Attachment>();
    }
    return attachments;
} 
```

我会提到这里有一些继承。
Attachment是KObject（db中的表名Object）的子类，KObject包含了用来映射回Comment的parentId（也是KObject的子类）。

为澄清起见，这是我给实体经理的电话：

```
public <T> T findById(Class<T> objClass, String id)
{
    EntityManager em = theEMF.createEntityManager();
    em.getTransaction().begin();
    try {
        T obj = em.find(objClass, id);
        return obj;
    } catch(NoResultException e) {
        return null;
    } finally {
        em.getTransaction().commit();
        em.clear();
        em.close();
    }   
} 
```

theEMF 是一个在首次使用时初始化的静态成员变量。

我认为解决方案是@OneToMany(fetch=FetchType.EAGER)，但这没有效果。我究竟做错了什么？

# algorithm - 给定初始条件，如何构建所有可能条件的图？

> ID：15033509
> 
> 赞同：-1
> 
> 时间：2013-02-22T21:29:37.357
> 
> 标签：algorithm, graph, permutation

考虑流行的容器问题：

*我们有三个容器，一个是 10 升，一个是 7 升，一个是 4 升。10 升的容器是空的，而 7 和 4 升的容器是满的。列举你可以达到的方法——一些其他状态——只将一个容器的内容物倒入另一个容器中，直到 a) 倾倒的容器是空的或 b) 接收容器是满的。*

对于家庭作业（我已经完成），我们应该讨论如何将这类问题解释为图，然后我们将在图上运行哪些算法以找到解决方案。

我的问题是，在给定某些初始条件的情况下，我们如何生成三个容器的所有可能状态的图表？对于给定的一组容器，可能有 N 个可能的状态，但我想有 M 个不相交的状态，从初始条件是不可能达到的。那么我们如何找到有效图的 N - M 个顶点，以及连接这些顶点的边呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:37:05.810

图有**节点**和**边**。

**节点**意味着一种状态。也就是你所有容器的状态

**边缘**意味着状态之间的（有效）转换。

如果你可以枚举所有改变状态的方法，那么你可以枚举一个节点到其他节点的所有出边。

以容器为例：

状态：10升容器（里面有一些量）、7升容器（里面有一些量）和4升容器（里面有一些量）

状态转换函数：

*   将 4 升容器的内容物倒入 7 升容器中
*   将 7 升容器的内容物倒入 10 升容器中
*   将 4 升容器的内容物倒入 10 升容器中
*   将 7 升容器的内容物倒入 4 升容器中
*   将 10 升容器的内容物倒入 4 升容器中
*   将 10 升容器的内容物倒入 7 升容器中

对这些功能的约束：一个人倾倒直到倾倒容器是空的，或者接收容器是满的。

您有 n 个容器，并且可能（n 选择 2）这些容器之间的交互。

调用这些函数中的任何一个都可能将您转换到另一种状态。

您可以定义与每个边缘转换相关的**成本。**在像这样的简单问题中，所有边缘转换函数都具有相同的成本 (1)，但在现实世界的示例中，例如在地图上的城市之间移动，成本可能是您必须沿着边缘移动的距离。

也许您想尽量减少倒出 4 升容器。您可以为涉及将 4 升容器倒入任何其他容器的所有边缘指定 2 而不是 1 的边缘权重。

现在我们已经根据节点和边定义了我们的图，我们可以搜索它！

也许你有一些像你提到的那样的起始状态（10 升容器是空的，7 和 4 升容器是满的）。并且您想进入其他状态（10 升容器已满，7 升容器为空，4 升容器有 1 升）。您可以从初始状态开始**搜索图表，并在达到目标时停止搜索。**

传统的图搜索技术有广度优先搜索（BFS）和深度优先搜索（DFS）。我会让你去[维基百科](http://en.wikipedia.org/wiki/Graph_traversal)学习它们。其他图搜索技术（如 A*）定义了一个**启发式**或经验法则，以尝试最快地到达目标状态。启发式方法涉及估计您在达到目标之前还有多长时间，并且有各种各样的研究来定义特定问题的启发式方法（提出启发式方法真的很难！）

实际生成您想要稍后搜索的图形可以通过前面描述的 BFS 或 DFS 方法完成。简单地说，创建一个描述你的初始条件的节点，然后在它上面应用你所有的状态转换函数来生成所有可达的节点。将这些节点放在一个列表中（这些是已生成但尚未展开的节点）。对于列表中的每个元素，以相同的方式展开它。将您已完成扩展的节点放入一个封闭列表中，这样您就可以确保您永远不会尝试两次生成相同的节点。

# java - 杂志阅读器应用程序的 RESTful 方法？

> ID：15033510
> 
> 赞同：0
> 
> 时间：2013-02-22T21:29:48.670
> 
> 标签：java, android, json, web-services

我正在为我工​​作的校园出版物构建一个杂志阅读器应用程序。

如我所见，实现中将涉及 4 个组件：

*   杂志出版商在其中发布新故事的 Java 程序。该程序创建 Story 类的 POJO，并将它们序列化为`JSON`对象。

*   存储`JSON`由第一个程序创建的对象的数据库

*   一种`RESTful`Web 服务 (Java)，它通过将传递的对象添加到数据库来处理来自第一个程序的 PUT 请求，`JSON`并通过从数据库中删除对象来删除该程序的请求。`JSON`该服务还通过将对象从数据库返回给它来处理来自 (Android) 客户端应用程序的 GET 请求。它还需要能够接受来自客户端的 POST 请求，以指示何时查看故事，以维护故事视图的计数。

*   一个 Android 应用程序，用于将 Web 服务传递给它`Gson`的对象反序列`JSON`化为 Story 对象，当应用程序运行时，它会自动连接到 Web 服务并获取最新的 20 个故事，并从中创建以`ViewPager`.

这是我第一次创建 Web 服务（或由它支持的应用程序），所以我在这里主要寻找的是确认我的基本方法是否符合最佳实践。我开发这个应用程序主要是作为一种自学练习，所以我非常愿意考虑使用其他方法来完成这项任务。

否则，我确实有一个特定的问题，那就是：哪种类型的数据库最适合存储 JSON 对象，以及如何设置它来存储这些对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:42:23.287

为什么不让他们发表博客文章并建立 RSS 提要？然后，您可以使用 [在后台服务中运行](http://developer.android.com/training/run-background-service/index.html)的示例应用程序作为 RSS 阅读器的起点。它对图像进行 RSS 拉取，并将它们的 URI 放入内容提供程序中。

# python - 根据样本数据计算置信区间

> ID：15033511
> 
> 赞同：165
> 
> 时间：2013-02-22T21:29:50.040
> 
> 标签：python, numpy, scipy, statistics, confidence-interval

假设正态分布，我有我想计算置信区间的样本数据。

我已经找到并安装了 numpy 和 scipy 包，并且已经让 numpy 返回平均值和标准差（numpy.mean(data)，数据为列表）。任何有关获得样本置信区间的建议将不胜感激。

* * *

## 回答 #1

> 赞同：221
> 
> 时间：2013-02-22T22:18:58.337

```
import numpy as np
import scipy.stats

def mean_confidence_interval(data, confidence=0.95):
    a = 1.0 * np.array(data)
    n = len(a)
    m, se = np.mean(a), scipy.stats.sem(a)
    h = se * scipy.stats.t.ppf((1 + confidence) / 2., n-1)
    return m, m-h, m+h 
```

你可以这样计算。

* * *

## 回答 #2

> 赞同：180
> 
> 时间：2015-12-26T18:56:16.667

这是 shasan 代码的缩短版本，计算数组平均值的 95% 置信区间`a`：

```
import numpy as np, scipy.stats as st

st.t.interval(0.95, len(a)-1, loc=np.mean(a), scale=st.sem(a)) 
```

但是使用 StatsModels'[`tconfint_mean`](http://www.statsmodels.org/stable/generated/statsmodels.stats.weightstats.DescrStatsW.tconfint_mean.html)可以说更好：

```
import statsmodels.stats.api as sms

sms.DescrStatsW(a).tconfint_mean() 
```

两者的基本假设是样本（数组`a`）独立于具有未知标准偏差的正态分布（参见[MathWorld](http://mathworld.wolfram.com/Studentst-Distribution.html)或[Wikipedia](https://en.wikipedia.org/wiki/Student's_t-distribution)）。

对于大样本量 n，样本均值呈正态分布，可以使用`st.norm.interval()`（如 Jaime 的评论中所建议的）计算其置信区间。但上述解决方案对于小 n 也是正确的，其中`st.norm.interval()`给出的置信区间太窄（即“假置信”）。有关更多详细信息，请参阅我对类似问题的[回答（以及 Russ 的评论之一）。](https://stackoverflow.com/a/33374673/1628638)

这是一个示例，其中正确的选项给出（基本上）相同的置信区间：

```
In [9]: a = range(10,14)

In [10]: mean_confidence_interval(a)
Out[10]: (11.5, 9.4457397432391215, 13.554260256760879)

In [11]: st.t.interval(0.95, len(a)-1, loc=np.mean(a), scale=st.sem(a))
Out[11]: (9.4457397432391215, 13.554260256760879)

In [12]: sms.DescrStatsW(a).tconfint_mean()
Out[12]: (9.4457397432391197, 13.55426025676088) 
```

最后，使用不正确的结果`st.norm.interval()`：

```
In [13]: st.norm.interval(0.95, loc=np.mean(a), scale=st.sem(a))
Out[13]: (10.23484868811834, 12.76515131188166) 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2019-03-20T22:06:14.613

开始`Python 3.8`，标准库将[`NormalDist`](https://docs.python.org/3.8/library/statistics.html?highlight=normaldist#statistics.NormalDist)对象作为[`statistics`](https://docs.python.org/3.8/library/statistics.html)模块的一部分提供：

```
from statistics import NormalDist

def confidence_interval(data, confidence=0.95):
  dist = NormalDist.from_samples(data)
  z = NormalDist().inv_cdf((1 + confidence) / 2.)
  h = dist.stdev * z / ((len(data) - 1) ** .5)
  return dist.mean - h, dist.mean + h 
```

这：

*   `NormalDist`从数据样本 (中创建一个对象，这使我们可以通过和[`NormalDist.from_samples(data)`](https://docs.python.org/3.8/library/statistics.html?highlight=statistics#statistics.NormalDist.from_samples)访问样本的均值和标准差。[`NormalDist.mean`](https://docs.python.org/3.8/library/statistics.html?highlight=statistics#statistics.NormalDist.mean)[`NormalDist.stdev`](https://docs.python.org/3.8/library/statistics.html?highlight=statistics#statistics.NormalDist.stdev)

*   使用累积分布函数 ( ) 的倒数，根据给定置信度`Z-score`的标准正态分布（由 表示）计算。`NormalDist()`[`inv_cdf`](https://docs.python.org/3.8/library/statistics.html#statistics.NormalDist.inv_cdf)

*   根据样本的标准差和均值生成置信区间。

* * *

这假设样本量足够大（假设超过约 100 个点），以便使用标准正态分布而不是学生的 t 分布来计算`z`值。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-02-22T22:15:04.163

首先从[查找表中查找](http://en.wikipedia.org/wiki/Standard_normal_table)所需置信区间的[z 值](http://en.wikipedia.org/wiki/Standard_score)。置信区间为，其中是您的样本均值的估计标准差，由 给出，其中是根据您的样本数据计算的标准差，是您的样本量。`mean +/- z*sigma``sigma``sigma = s / sqrt(n)``s``n`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-23T22:01:23.227

关于 Ulrich 的回答——即使用 t 值。当真正的方差未知时，我们使用它。这是当您拥有的唯一数据是样本数据时。

对于 bogatron 的回答，这涉及 z 表。在已知并提供方差时使用 z 表。然后你也有样本数据。Sigma 不是样本均值的估计标准差。这是众所周知的。

所以假设方差是已知的，我们想要 95% 的置信度：

```
from scipy.stats import norm
alpha = 0.95
# Define our z
ci = alpha + (1-alpha)/2
#Lower Interval, where n is sample siz
c_lb = sample_mean - norm.ppf(ci)*((sigma/(n**0.5)))
c_ub = sample_mean + norm.ppf(ci)*((sigma/(n**0.5))) 
```

只有样本数据和未知方差（意味着必须仅根据样本数据计算方差），Ulrich 的答案非常有效。但是，您可能希望指定置信区间。如果您的数据是 a 并且您希望置信区间为 0.95：

```
import statsmodels.stats.api as sms
conf = sms.DescrStatsW(a).tconfint_mean(alpha=0.05)
conf 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-16T19:53:27.913

基于原始但有一些具体的例子：

```
import numpy as np

def mean_confidence_interval(data, confidence: float = 0.95) -> tuple[float, np.ndarray]:
    """
    Returns (tuple of) the mean and confidence interval for given data.
    Data is a np.arrayable iterable.

    ref:
        - https://stackoverflow.com/a/15034143/1601580
        - https://github.com/WangYueFt/rfs/blob/f8c837ba93c62dd0ac68a2f4019c619aa86b8421/eval/meta_eval.py#L19
    """
    import scipy.stats
    import numpy as np

    a: np.ndarray = 1.0 * np.array(data)
    n: int = len(a)
    if n == 1:
        import logging
        logging.warning('The first dimension of your data is 1, perhaps you meant to transpose your data? or remove the'
                        'singleton dimension?')
    m, se = a.mean(), scipy.stats.sem(a)
    tp = scipy.stats.t.ppf((1 + confidence) / 2., n - 1)
    h = se * tp
    return m, h

def ci_test_float():
    import numpy as np
    # - one WRONG data set of size 1 by N
    data = np.random.randn(1, 30)  # gives an error becuase len sets n=1, so not this shape!
    m, ci = mean_confidence_interval(data)
    print('-- you should get a mean and a list of nan ci (since data is in wrong format, it thinks its 30 data sets of '
          'length 1.')
    print(m, ci)

    # right data as N by 1
    data = np.random.randn(30, 1)
    m, ci = mean_confidence_interval(data)
    print('-- gives a mean and a list of length 1 for a single CI (since it thinks you have a single dat aset)')
    print(m, ci)

    # multiple data sets (7) of size N (=30)
    data = np.random.randn(30, 7)
    print('-- gives 7 CIs for the 7 data sets of length 30\. 30 is the number ud want large if you were using z(p)'
          'due to the CLT.')
    m, ci = mean_confidence_interval(data)
    print(m, ci)

ci_test_float() 
```

输出：

```
-- you should get a mean and a list of nan ci (since data is in wrong format, it thinks its 30 data sets of length 1.
0.1431623130952463 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan nan nan nan nan nan nan nan nan]
-- gives a mean and a list of length 1 for a single CI (since it thinks you have a single dat aset)
0.04947206018132864 [0.40627264]
-- gives 7 CIs for the 7 data sets of length 30\. 30 is the number ud want large if you were using z(p)due to the CLT.
-0.03585104402718902 [0.31867309 0.35619134 0.34860011 0.3812853  0.44334033 0.35841138
 0.40739732] 
```

我认为 Num_datasets 的 Num_samples 是正确的，但如果没有在评论部分告诉我。

* * *

作为奖励，一个几乎只使用火炬的火炬实现：

```
def torch_compute_confidence_interval(data: Tensor,
                                      confidence: float = 0.95
                                      ) -> Tensor:
    """
    Computes the confidence interval for a given survey of a data set.
    """
    n: int = len(data)
    mean: Tensor = data.mean()
    # se: Tensor = scipy.stats.sem(data)  # compute standard error
    # se, mean: Tensor = torch.std_mean(data, unbiased=True)  # compute standard error
    se: Tensor = data.std(unbiased=True) / (n ** 0.5)
    t_p: float = float(scipy.stats.t.ppf((1 + confidence) / 2., n - 1))
    ci = t_p * se
    return mean, ci 
```

* * *

关于 CI 的一些评论（或参见[https://stats.stackexchange.com/questions/554332/confidence-interval-given-the-population-mean-and-standard-deviation?noredirect=1&lq=1](https://stats.stackexchange.com/questions/554332/confidence-interval-given-the-population-mean-and-standard-deviation?noredirect=1&lq=1)）：

```
"""
Review for confidence intervals. Confidence intervals say that the true mean is inside the estimated confidence interval
(the r.v. the user generates). In particular it says:
    Pr[mu^* \in [mu_n +- t.val(p) * std_n / sqrt(n) ] ] >= p
e.g. p = 0.95
This does not say that for a specific CI you compute the true mean is in that interval with prob 0.95\. Instead it means
that if you surveyed/sampled 100 data sets D_n = {x_i}^n_{i=1} of size n (where n is ideally >=30) then for 95 of those
you'd expect to have the truee mean inside the CI compute for that current data set. Note you can never check for which
ones mu^* is in the CI since mu^* is unknown. If you knew mu^* you wouldn't need to estimate it. This analysis assumes
that the the estimator/value your estimating is the true mean using the sample mean (estimator). Since it usually uses
the t.val or z.val (second for the standardozed r.v. of a normal) then it means the approximation that mu_n ~ gaussian
must hold. This is most likely true if n >= 0\. Note this is similar to statistical learning theory where we use
the MLE/ERM estimator to choose a function with delta, gamma etc reasoning. Note that if you do algebra you can also
say that the sample mean is in that interval but wrt mu^* but that is borning, no one cares since you do not know mu^*
so it's not helpful.

An example use could be for computing the CI of the loss (e.g. 0-1, CE loss, etc). The mu^* you want is the expected
risk. So x_i = loss(f(x_i), y_i) and you are computing the CI for what is the true expected risk for that specific loss
function you choose. So mu_n = emperical mean of the loss and std_n = (unbiased) estimate of the std and then you can
simply plug in the values.

Assumptions for p-CI:
    - we are making a statement that mu^* is in mu+-pCI = mu+-t_p * sig_n / sqrt n, sig_n ~ Var[x] is inside the CI
    p% of the time.
    - we are estimating mu^, a mean
    - since the quantity of interest is mu^, then the z_p value (or p-value, depending which one is the unknown), is
    computed using the normal distribution.
    - p(mu) ~ N(mu; mu_n, sig_n/ sqrt n), vial CTL which holds for sample means. Ideally n >= 30.
    - x ~ p^*(x) are iid.

Std_n vs t_p*std_n/ sqrt(n)
    - std_n = var(x) is more pessimistic but holds always. Never shrinks as n->infity
    - but if n is small then pCI might be too small and your "lying to yourself". So if you have very small data
    perhaps doing std_n for the CI is better. That holds with prob 99.9%. Hopefuly std is not too large for your
    experiments to be invalidated.

ref:
    - https://stats.stackexchange.com/questions/554332/confidence-interval-given-the-population-mean-and-standard-deviation?noredirect=1&lq=1
    - https://stackoverflow.com/questions/70356922/what-is-the-proper-way-to-compute-95-confidence-intervals-with-pytorch-for-clas
    - https://www.youtube.com/watch?v=MzvRQFYUEFU&list=PLUl4u3cNGP60hI9ATjSFgLZpbNJ7myAg6&index=205
""" 
```

# ember.js - 如何修改由 Ember 控制器管理的数组中的元素？

> ID：15033514
> 
> 赞同：5
> 
> 时间：2013-02-22T21:29:53.317
> 
> 标签：ember.js

我可能错过了一些非常愚蠢的东西，（Ember 新手）但我不知道如何修改在我的 Ember 控制器管理下的数组，而不是设置一个全新的数组。

例如。我的控制器中有以下测试功能。当用户单击时，我想用新值修改受控数组的每个元素（或者它可以是单个元素）。

我知道您应该通过“设置”来让 Ember 知道更改，所以我认为这会起作用：

```
clickHandler:function(e){
    var temp = this.get("itemList").copy(); // copy it
    for (var i = 0; i < temp.length; i++) { 
        temp[i].desc = "CANCELLED";     // change it
    }
    this.set('itemList', temp); // put it back
} 
```

我制作了数组的副本，对其进行修改，然后将其重新设置。但不知何故，Ember 抱怨第 4 行，在那里我修改了 temp[i].desc 的内容，说我必须使用 Ember.Set。我以为我可以修改“离线”副本，然后将其重新设置，但不行，我不知道为什么。其他数组操作，如 shift/unshift/pop 似乎可以工作。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-22T23:04:29.913

你的方法看起来不太花哨。此代码将起作用：

```
clickHandler:function(e){
    var itemList = this.get("itemList");
    itemList.forEach(function(item){ // for iterating over an array, always use the forEach function
        item.set("desc", "CANCELLED"); // you have to call this set()-function to make changes to an Ember Object
    });
} 
```

**为什么需要调用 set() 方法而不能使用直接访问方法？**

set() 方法使 Ember 能够执行其自动绑定魔法。调用此方法时，它会安排所有需要在依赖于修改后的属性的对象上执行的工作。最简单的示例是显示需要更新的给定属性的模板。

**这里对上面的代码进行了可能的改进，使其更加修饰：** 您可以使用 ArrayController 来管理您的 itemList。在这种情况下，您可以将 itemList 设置为控制器的内容属性。你会注意到很多教程在处理数组时都使用了这个控制器。

```
App.ItemListController = Ember.ArrayController.extend({
    content : null, //set your itemList into this property
    clickHandler:function(e){
        this.get("content").setEach("desc", "CANCELLED");
    }
}); 
```

# c# - 使用 Timer 类时出现错误跨线程操作

> ID：15033515
> 
> 赞同：1
> 
> 时间：2013-02-22T21:29:53.647
> 
> 标签：c#, winforms, datagridview

我有一个 Winform 应用程序，我对它的功能感到满意。我想每 15 分钟从数据库中检索一次最新数据并将其显示在 DataGridView 中。

我添加了一个 Timer 类。15 分钟过去后，我可以调用检索和显示数据的方法。我收到错误（请参阅随附的屏幕截图）。

我在这里做错了什么？

下面是我的代码：

```
public partial class Form1 : Form
{
    System.Timers.Timer aTimer;

    public Form1()
    {
      InitializeComponent();
      StartTimer();
    }

    private void RetrieveData()
    {

      DataTable table = new DataTable();
      table.Rows.Add(woStatus, dateReceived, dateApprovedFormatted, binNo, ppNo, woNo, daysDifference);

      dataGridViewMain.DataSource = table;
      dataGridViewMain.Sort(dataGridViewMain.Columns["Days in the shop"], ListSortDirection.Descending);
    }

    private void StartTimer()
    {
      aTimer = new System.Timers.Timer(10000); // 10secs
      aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);
      RetrieveData();
      aTimer.Start();
    }

    private void OnTimedEvent(object source, ElapsedEventArgs e)
    {
      aTimer.Stop();
      aTimer.Dispose();
      StartTimer();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T21:32:24.617

`System.Timers.Timer`触发随机工作线程，**而不是**UI 线程。因此，当代码进入`RetrieveData`（通过`OnTimedEvent`then `StartTimer`）时，它位于错误的线程上。您可以使用它`this.Invoke((MethodInvoker) delegate {...})`来找到正确的线程，但仅使用该`System.Windows.Forms.Timer`组件可能更简单，因为它会自动（通过同步上下文）在 UI 线程上触发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:34:39.267

我没有看到任何屏幕截图，但是如果您遇到跨线程异常，我会怀疑这是因为您*在计时器线程上*调用的 StartTimer() 方法中调用了 RetreiveData() 。您需要确保影响 UI 的代码在与 UI 相同的线程上执行，否则您将遇到此类异常。查看提供的方法`InvokeRequired()`和 Control.Invoke() 以确保影响 UI 的方法调用在上下文切换回 UI 线程后完成。

# angularjs - angular.module 最低限度

> ID：15033516
> 
> 赞同：4
> 
> 时间：2013-02-22T21:29:54.760
> 
> 标签：angularjs

这怎么行不通？不抛出“no module: tut”错误的最低要求是多少？

```
<!DOCTYPE html>
<html ng-app="tut">
    <head>
        <script type="text/javascript" src="./jquery.js"></script>
        <script type="text/javascript" src="./script-ng.js"></script>
        <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
          <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.4/angular.min.js"></script>
        <link rel="stylesheet" href="main.css"></link>
    </head>
    <body>
        <div id="sidebar_left"><div id="header"></div><ul id="nav"></ul></div>
        <div id="container">

            <video id="video" controls>

                        Your browser does not support the video tag.</video>
            <br />
            <button id="reset">Replay</button>

        <br />
        <div ng-controller="getAnswers" id="pannel">
            <div id="base">{{verbs.base}}</div>
            <ul class="answers">
                <li ng-click="checkAnswer($event)" ng-repeat="answer in verbs.conjugations" class="answer {{answer.correct}}" id="answer{{$index}}">{{answer.text}}</li>
            </ul>
        </div>
        <br />
        <br />
        <br />
        <div id="warning"></div>
    </div>
</body> 
```

```
angular.module('tut', []).controller('getAnswers', function ($scope, $element){
    $scope.verbs = conjugate(conjugationsets[tutorial_number][questionnum]);
    $scope.randomizeAnswers = function () {
      fisherYates($scope.verbs.conjugations);
    }();

    $scope.checkAnswer = function (){
        checkanswer();
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T06:45:45.320

非常简单。您可能忘记这样做了，只需在您的 js 文件顶部添加 angularjs 库即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:35:02.797

在大多数应用程序中，您只需要一个模块，在您的情况下，您需要将 ng-app="app" 包含在 HTML 元素中，该元素是您想要使用角度工作的内容的父级。

大多数时候，这是可以做到的标签

如果您想拆分代码以进行测试，您可以创建多个模块并将它们的名称包含在依赖项数组中，如下所示：

```
angular.module('tut', [ 'othermodule', 'andanothermodule']);

angular.module('othermodule');

etc. 
```

是的，加载脚本的顺序是错误的，正如 Josh 的评论中所指出的那样。

# java - 如何在 Java 小程序上正确使用图像文件 (gif)？

> ID：15033518
> 
> 赞同：0
> 
> 时间：2013-02-22T21:30:02.643
> 
> 标签：java, eclipse, image

我正在使用 Java (eclipse) 编写游戏，并且我设法完全掌握了基础知识。我使用 .gif 文件作为游戏精灵并加载它们

```
Image java.applet.Applet.getImage(URL url, String name) 
```

在 Eclipse 下，我的代码运行完美，但是当我将小程序添加到可运行的 JFrame 或将其嵌入到网站时，它会因错误而爆炸，最明显的是

```
access denied("java.io.filepermission read") 
```

在非常沮丧并在我能找到的每个论坛和教程上搜索了几个小时之后，我遇到了一个叫做沙盒错误的东西，我读过这意味着小程序无法访问该类所在的文件系统上的图像。

如果这是我得到的错误，并且小程序无法访问文件或图像（这对我来说似乎很愚蠢，那么小程序的意义何在？）那么如果我无法从文件中加载它们，我该如何在小程序中使用图像? 或者更重要的是，如何让我的完美无错代码在 Eclipse 之外运行，以便我可以“分发”它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:42:45.393

您可以检查几件事，图像存储在服务器上的什么位置？哪些用户是这些图像的所有者，该用户与运行 Web 服务器的用户不同吗？如果是这样，我会更改图像和图像所在目录的权限，以便它们包括对运行 Web 服务器的用户的读取访问权限。

在 Stackvoerflow 上问了一个类似的问题： [how to provide access permission for applet to write on file system](https://stackoverflow.com/questions/4660646/how-to-provide-access-permission-for-applet-to-write-on-file-system)

正如另一张海报所提到的，您似乎必须确保您的小程序已签名：[http ://www-personal.umich.edu/~lsiden/tutorials/signed-applet/signed-applet.html](http://www-personal.umich.edu/~lsiden/tutorials/signed-applet/signed-applet.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:54:31.207

默认情况下，小程序无法访问本地文件系统。[Java 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/applet.html#images)告诉您如何在小程序中正确使用图像。

# python - 如何更改 Python Shell 中的文本颜色？

> ID：15033521
> 
> 赞同：0
> 
> 时间：2013-02-22T21:30:24.867
> 
> 标签：python

比如说，我想做一个简单的打印语句，例如：

print("今天外面好*热。")*

如何在 Python Shell 中将“热”设为红色？

# wpf - WPF ContextMenu 问题：如何设置 ContextMenu 的 DataContext？

> ID：15033522
> 
> 赞同：35
> 
> 时间：2013-02-22T21:30:24.777
> 
> 标签：wpf, contextmenu, datacontext

我在弄清楚如何`DataContext`在`ContextMenu`.

我有一组视图模型，它们是`ItemsControl`. 每个视图模型都有一个项目集合，这些项目也是另一个项目的来源`ItemsControl`。每个项目用于绘制具有`ContextMenu`. `MenuItems`需要`ContextMenu`绑定到视图模型上的命令，但是`PlacementTarget`指向`ContextMenu`单个项目。

我的 Xaml 看起来像这样：

```
<ItemsControl ItemsSource="{Binding Markers"}>
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <ItemsControl ItemsSource="{Binding Items}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Image>
                            <Image.ContextMenu>
                                <ContextMenu>
                                     <MenuItem Header="Edit" Command="{Binding EditCommand}" />
                                </ContextMenu>
                            </Image.ContextMenu>
                        </Image>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

如何将 的 设置`DataContext`为`ContextMenu`项目的相应父视图模型？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-02-22T21:47:06.557

ContextMenu 位于可视化树之外。下面是应该为您提供数据上下文的 xaml：

```
<ItemsControl ItemsSource="{Binding Markers}" Tag="{Binding ElementName=outerControl, Path=DataContext}">
   ...
   <ContextMenu DataContext="{Binding Path=PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
      <MenuItem Header="Edit"
                Command="{Binding EditCommand}" />
   </ContextMenu>
   ...
</ItemsControl> 
```

这篇[文章](http://www.codeproject.com/Articles/162784/WPF-ContextMenu-Strikes-Again-DataContext-Not-Upda)解释了这是如何工作的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-11-02T20:08:18.720

您可以使用标记扩展：

```
using System;
using System.Windows.Controls;
using System.Windows.Markup;
using System.Xaml;

[MarkupExtensionReturnType(typeof(ContentControl))]
public class RootObject : MarkupExtension
{
    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        var rootObjectProvider = (IRootObjectProvider)serviceProvider.GetService(typeof(IRootObjectProvider));
        return rootObjectProvider?.RootObject;
    }
} 
```

它让您可以：

```
<ItemsControl ItemsSource="{Binding Markers}">
   ...
   <ContextMenu DataContext="{Binding DataContext, Source={local:RootObject}}">
      <MenuItem Header="Edit"
                Command="{Binding EditCommand}" />
   </ContextMenu>
   ...
</ItemsControl> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-19T10:49:51.473

我不喜欢使用标签。我更喜欢附加财产。

您需要添加附加属性：

```
public static readonly DependencyProperty DataContextExProperty =
   DependencyProperty.RegisterAttached("DataContextEx",
                                       typeof(Object), 
                                       typeof(DependencyObjectAttached));

public static Object GetDataContextEx(DependencyObject element)
{
    return element.GetValue(DataContextExProperty);
}

public static void SetDataContextEx(DependencyObject element, Object value)
{
    element.SetValue(DataContextExProperty, value);
} 
```

在 XAML 中：

```
<Button attached:DependencyObjectAttached.DataContextEx="{Binding ElementName=MyDataContextElement, Path=DataContext}">
    <Button.ContextMenu>
        <ContextMenu DataContext="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget.(attached:DependencyObjectAttached.DataContextEx)}">
        </ContextMenu>
    </Button.ContextMenu>
</Button> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-21T11:22:05.307

此代码允许您同时使用全局和本地 DataContext（整个 userControl 和当前 TreeViewItem）：

```
<TreeView Grid.Row="0" ItemsSource="{Binding Path=SelectableEnterprises}">
<TreeView.ItemTemplate>
    <HierarchicalDataTemplate ItemsSource="{Binding Children}">
        <Grid Height="20" Tag="{Binding DataContext, ElementName=userControl}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="25"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Grid.ContextMenu>
                <ContextMenu DataContext="{Binding PlacementTarget, RelativeSource={RelativeSource Self}}" >
                    <ContextMenu.Visibility>
                        <MultiBinding Converter="{converters:SurveyReportVisibilityConverter}">
                            <Binding Path="DataContext"/> <!--local DataContext-->
                            <Binding Path="Tag.SelectedSurvey"/> <!--global DataContext-->
                        </MultiBinding>
                    </ContextMenu.Visibility>

                    <MenuItem Header="Show HTML-report" Command ="{Binding Tag.OpenHTMLReportCommand}" 
                              CommandParameter="{Binding DataContext}" />
                </ContextMenu>
            </Grid.ContextMenu> 
```

# c# - 带有复合键的 Linq Join()

> ID：15033523
> 
> 赞同：6
> 
> 时间：2013-02-22T21:30:26.427
> 
> 标签：c#, linq

我正在尝试用两张桌子提出请求

Table Page : Id, LangId (主键) PageTypeId, PageTypeLangId (外键)

表 PageType : Id, LangId (主键)

那么怎么办呢？在这里，我想只是添加 PageTypeLangId

```
 return context.Pages
            .Join(context.PageTypes, p => p.PageTypeId, pT => pT.Id,(p, pT) => new { p, pT }) 
```

我想 ：

```
 select * from Page inner join PageType on Page.PageTypeId=PageType.Id and     Page.PageTypeLangId=PageType.LangId 
```

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-22T21:55:12.583

以下应该有效：

```
return context.Pages
              .Where(x => x.PageTypeLangId.HasValue)
              .Join(context.PageTypes,
                    p => new { Id = p.PageTypeId,
                               LangId = p.PageTypeLangId.Value },
                    pT => new { pT.Id, pT.LangId },
                    (p, pT) => new { p, pT }); 
```

# python - 记录 Django Haystack 搜索关键字

> ID：15033524
> 
> 赞同：3
> 
> 时间：2013-02-22T21:30:27.487
> 
> 标签：python, django, django-haystack

我的 url.py 中有以下内容：

```
from haystack.forms import HighlightedModelSearchForm
from haystack.query import SearchQuerySet
from haystack.views import SearchView
from articles.models import Article

article_sqs = SearchQuerySet().models(Article)

urlpatterns = patterns('',
    ...
    url(r'^article/search/$', SearchView(
        template='articles/search/results.html',
        searchqueryset=article_sqs,
        results_per_page=10,
        form_class=HighlightedModelSearchForm
    ), name='haystack_search'),
... 
```

它工作正常，但我需要捕获搜索关键字来记录它。

我怎样才能捕捉到它？

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T02:49:10.783

我想做类似的事情，所以我创建了一个名为**search的应用程序**

**搜索/models.py**

```
from django.db import models
from django.contrib.auth.models import User
from django.utils.translation import ugettext as _

class SearchTerm(models.Model):
    query = models.CharField(
        verbose_name = _(u'Search Term'),
        max_length = 255,
        default = None
    )

class SearchQuery(models.Model):
    term = models.ForeignKey(
        SearchTerm
    )
    user = models.ForeignKey(
        User,
        blank = True, 
        null = True,
    )
    when = models.DateTimeField(
        verbose_name = _(u'Date Searched'),
    ) 
```

**搜索/urls.py**

```
from django.conf.urls.defaults import *

urlpatterns = patterns('',
    url(r'^search/', 'search.views.search', name="search"),
) 
```

然后当然在我的项目网址中我添加了以下规则：

```
url(r'^', include('search.urls')), 
```

**搜索/views.py**

```
from django.http import HttpResponse
from django.shortcuts import get_object_or_404, render, redirect
from haystack.forms import ModelSearchForm, SearchForm
from haystack.views import SearchView
from search.models import SearchQuery, SearchTerm
import datetime

def search(request):
    if 'page' not in request.GET :
        try :
            st, created = SearchTerm.objects.get_or_create(query=request.GET['q'])
            sq = SearchQuery()
            sq.term = st
            sq.user = request.user
            sq.when = datetime.datetime.now()
            sq.save()
        except :
            pass

    view = SearchView()
    return view(request) 
```

`if 'page' not in request.GET`以便仅在搜索结果的第一页上保存 SearchQuery

每个 SearchQuery 在数据库中都是唯一的。

SearchTerm 的每个 SearchQuery 都记录有附加信息，例如`user`（可为空的）并且`when`搜索了该术语。

`view = SearchView()`并`return view(request)`使其在记录 SearchQuery 后，为该请求调用默认的 haystack 视图。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T20:05:44.900

可能最简单的解决方案是继承 SearchView 并在您的 urlpatterns 中使用它。

不幸的是，Haystack SearchView 的编写方式与 Django 基于类的视图不同（可能是因为它是在将 CBV 引入 Django 之前编写的......），但它是非常简单的一段代码[https://github.com/toastdriven/django- haystack/blob/master/haystack/views.py#L13](https://github.com/toastdriven/django-haystack/blob/master/haystack/views.py#L13)

像这样的东西应该工作：

```
class LoggingSearchView(SearchView):

    def create_response(self):
        logger.info(self.query)  #or log self.query as you like
        return super(LoggingSearchView, self).create_response() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-03T10:41:08.320

Haystack 相关`saved_searches`应用允许存储用户的搜索历史：

[https://github.com/toastdriven/saved_searches](https://github.com/toastdriven/saved_searches)

# wso2 - 如何在 WSO2 Viskit 库的图表示例中从 DataProvider 中提取数据

> ID：15033528
> 
> 赞同：0
> 
> 时间：2013-02-22T21:30:36.863
> 
> 标签：wso2, data-visualization, google-gadget

我正在使用 WSO2 Viskit 图表库。我在从 dataProvider 中提取特定数据时遇到问题。我可以使用数据提供者获取数据。我可以将数据接收器添加到数据提供者。我创建了一个 dataFilter 并将其作为 datareciever 添加到 dataprovider 中。如下代码所示

```
var dataProvider = new Viskit.p.ProviderGETMakeRequest("http://localhost:8087/generator7.php")
var dataFilter2 = new Viskit.f.BasicFilter(["services", "service"], ["@name"],["Service 01"]);
dataProvider.addDataReceiver(dataFilter2);
dataFilter2.addDataReceiver(lineChart); 
```

我正在使用示例中提供的计时机制。如果我将折线图或条形图对象添加到 dataFilter，我可以检索数据并将其显示在条形图或折线图等中。

我的问题是我可以添加一个变量或一个数组作为数据接收器，而不是 dataFilter 或图表对象。我只想提取原始数值数据，以便在更新时将其显示在图表的一侧。

或者换句话说，我如何从数据接收器（向数据提供者注册）中提取原始数据并将其存储在变量或数组等中。

奥马尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T05:48:53.143

wso2 viskit 已弃用。一段时间内也没有维护版本。WSO2 中有一个新项目正在进行，以使 Web 开发更容易。WSO2 开发的新 Web 开发框架称为[WSO2 Jaggery](http://jaggeryjs.org/)。这是一个服务器端的 JavaScript 框架。对于表示层，我们坚持使用直接的图表库，例如 dojo、jquery 等。原因是 wso2 viskit 比这些库的 API 更难使用和维护。高温高压

# android - 像纯android一样分类ListView

> ID：15033531
> 
> 赞同：1
> 
> 时间：2013-02-22T21:31:12.553
> 
> 标签：android, android-listview

我想做一个listView ...就像这样..有什么建议吗？

![在此处输入图像描述](../Images/ef9b18641cd0023c6cec7ad409f72946.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:37:29.673

您确定要使用`ListView`..？

如果元素完全不同，则每一行（即子元素）**都不能**有一个共同的布局。您显然可以使用`ListView Headers`来实现这一点并使用`getView()`来确定是否显示复选框..

但是，如果要显示的元素太多，那么简单（并且可能是不道德的方式）将简单地使用 a `LinearLayout`inside a `ScrollView`，假设您有固定数量的要显示的元素，而这些元素是事先已知的。

但是，在您的情况下，最好的办法是使用`PreferenceActivity`. 它是设置屏幕的常用 Activity，仅针对该目的进行了优化，就像任何应用程序设置屏幕中的用户首选项一样。

**编辑**：正如您在评论中提到的，您只希望显示类别中的项目列表而不是复选框，我假设您没有设计设置屏幕。就此而言，您可以使用 an `ExpandableListView`，您可以在其中将类别列表显示为父项，并将每个类别下的项目显示为子项。

或者，正如*@CommonsWare*先生在对您问题的评论中已经建议的那样，使用**ListView 的标题**来显示类别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:56:25.807

如果你想得到像你发布的图片一样的东西，你可以尝试一个偏好活动：http: [//developer.android.com/reference/android/preference/PreferenceActivity.html](http://developer.android.com/reference/android/preference/PreferenceActivity.html)

# java - 使用 Dropbox API 获取目录中的文件数

> ID：15033535
> 
> 赞同：1
> 
> 时间：2013-02-22T21:31:22.787
> 
> 标签：java, file, dropbox-api

这可能吗？我将一些文件存储在一个目录中。我希望用户看到整个文件夹。我尝试并搜索，但找不到获取文件计数或目录中文件列表的方法。

我正在使用Java，但我想这并不重要。

已经非常感谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T19:29:48.810

您可以为所需文件夹调用[/metadata](https://www.dropbox.com/developers/core/api#metadata)，然后计算“内容”列表中“is_dir”为假的条目数。如果您使用的是官方 Java SDK，则此调用对应于[元数据](https://www.dropbox.com/static/developers/dropbox-java-sdk-1.5.3-docs/com/dropbox/client2/DropboxAPI.html#metadata%28java.lang.String,%20int,%20java.lang.String,%20boolean,%20java.lang.String%29)方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-05-07T15:47:35.620

您可以使用`/files/list_folder`Dropbox 的 API，即[https://api.dropboxapi.com/2/files/list_folder](https://api.dropboxapi.com/2/files/list_folder)

您可以参考[https://www.dropbox.com/developers/documentation/http/documentation#files-list_folder](https://www.dropbox.com/developers/documentation/http/documentation#files-list_folder)

您必须为此 API 添加标头和请求数据，并在 Dropbox 中获取文件夹和文件。好好利用它。

# sql-server - 内部联接后要查询的 SQL Server 重复结果

> ID：15033537
> 
> 赞同：-4
> 
> 时间：2013-02-22T21:31:33.850
> 
> 标签：sql-server, distinct

我有一个查询，我从 7 个表中调用。在我的查询中，我使用内部连接连接表。

问题是我有重复的结果。我想提一下，我的表中没有任何重复的记录。我尝试了不同的但没有帮助。

我也一次又一次地尝试使用 Group d。你有什么建议吗？当您从许多带有外键的表中调用时，这是一个常见问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:07:34.150

更改选择列表以显示查询中所有表的每个 PK，查看重复的 PK 值，这是您的重复项。查看围绕该表连接的查询。我敢打赌，您的加入是错误的，如下所示：

```
SELECT
    a.PK, b.Pk, c.PK, D.pk .....
    FROM Table_A             a
        INNER JOIN Table_B   b ON a.col=b.pk
        INNER JOIN Table_C   c ON b.col=b.pk --<<look for a bad join like this
        INNER JOIN Table_D   d ON c.col=d.pk
        ... 
```

# convention - 文件夹名称约定 Java

> ID：15033539
> 
> 赞同：2
> 
> 时间：2013-02-22T21:31:47.910
> 
> 标签：convention

您将保存信息（游戏保存、高分等）的文件夹称为什么。它只是一个命名约定问题。默认情况下，您有 src 并且对于资源，您可以创建一个名为 res 的文件夹并将其添加到构建路径中。出于好奇，我只是想问一下，您将在其中写入信息的文件夹称为什么。我在想 sav （用于保存）或 writ （用于写入）。我正在使用 Eclipse，所以我知道如何将文件夹添加到构建路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:34:22.463

1.  不在`src`，因为它是输出，而不是...来源。
2.  高度特定于应用程序，并取决于您未明确说明的要求。这需要所有用户都可以访问吗？只有一个？来自远程进程？在应用程序运行之间持续存在？自动备份/持久化？在 Dropbox 中？加载到 MySQL 中？等等。显然，这个问题的答案会因应用程序而异，输出应该在哪里也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:37:15.967

这是程序创建的动态数据吗？如果是这样，您为什么要在构建中包含这些文件？

对于动态数据，java.util.prefs 包提供了一个潜在的跨平台解决方案，例如windows 的注册表和linux 上的~/.directories。

# matlab - MATLAB：for 循环中的索引错误

> ID：15033540
> 
> 赞同：0
> 
> 时间：2013-02-22T21:31:55.117
> 
> 标签：matlab, loops, for-loop, indexing

我想分开以下单位矩阵的列

```
I =
 1     0     0
 0     1     0
 0     0     1 
```

使用 for 循环，然后将其标记为索引向量。然后我用

```
n=3;
I = eye(n);
for i = drange(1:n)
    e(i) = zeros(n,1)
end 
```

为最后一步生成列向量：

```
for i = drange(1:n)
    e(i)= I(:,i)
end 
```

但我对索引有错误。有人知道怎么搭吗？

或者一般来说，我如何分隔矩阵的列以分隔具有必须使用该向量的某些索引的向量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:54:05.483

为什么不直接生成

```
n=3;

e=eye(n,n); 
```

顺便说一句，您可以使用以下方法更正循环：

```
for i=1:n
   e(:,i)=I(:,i); 

end 
```

但是，没有必要！

# python - 将 Django 连接到 MongoLab 数据库

> ID：15033541
> 
> 赞同：2
> 
> 时间：2013-02-22T21:31:57.753
> 
> 标签：python, django, mongodb, pymongo, mlab

我目前正在运行 Django 1.4.3，我想连接我自己的数据库（在 MongoLab 中创建）以与我的 Django 网站交谈。我已经尝试过很多关于如何实现这一点的教程；我在 Django settings.py 文件中遇到的问题是我的数据库设置不正确（由于无法连接）。我对 Django 和 MongoDB 非常陌生，因此将不胜感激。

这是我遵循的教程之一：[http ://www.allbuttonspressed.com/blog/django/2010/05/MongoDB-backend-for-Django-nonrel-released](http://www.allbuttonspressed.com/blog/django/2010/05/MongoDB-backend-for-Django-nonrel-released)

注意：如果这很重要，我正在使用 Mac 并使用终端对所有内容进行编程。

这是我的 settings.py 中的问题区域（大部分是由 Django 自动生成的）

```
DATABASES = {
    'default': {
        #'ENGINE': 'django_mongodb_engine', ### This wasn't working ###
        'ENGINE': '',
        'NAME': '',                      # Or path to database file if using sq$
        'USER': '',                      # Not used with sqlite3.
        'PASSWORD': '',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. N$
        'PORT': '',                      # Set to empty string for default. Not$
    }
} 
```

这是错误消息：

```
Validating models...

Unhandled exception in thread started by <bound method Command.inner_run of <django.contrib.staticfiles.management.commands.runserver.Command object at 0x10f732210>>
Traceback (most recent call last):
  File "/Library/Python/2.7/site-packages/django/core/management/commands/runserver.py", line 91, in inner_run
self.validate(display_num_errors=True)
  File "/Library/Python/2.7/site-packages/django/core/management/base.py", line 266, in validate
num_errors = get_validation_errors(s, app)
  File "/Library/Python/2.7/site-packages/django/core/management/validation.py", line 23, in get_validation_errors
from django.db import models, connection
  File "/Library/Python/2.7/site-packages/django/db/__init__.py", line 40, in <module>
backend = load_backend(connection.settings_dict['ENGINE'])
  File "/Library/Python/2.7/site-packages/django/db/__init__.py", line 34, in __getattr__
return getattr(connections[DEFAULT_DB_ALIAS], item)
  File "/Library/Python/2.7/site-packages/django/db/utils.py", line 92, in __getitem__
backend = load_backend(db['ENGINE'])
  File "/Library/Python/2.7/site-packages/django/db/utils.py", line 24, in load_backend
return import_module('.base', backend_name)
  File "/Library/Python/2.7/site-packages/django/utils/importlib.py", line 35, in import_module
__import__(name)
  File "build/bdist.macosx-10.8-intel/egg/django_mongodb_engine/__init__.py", line 13, in <module>
AttributeError: 'tuple' object has no attribute 'insert' 
```

文件：.../django_mongodb_engine/ **init** .py（这是直接下载的，没有编辑）

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

__version__ = (0, 4, 0)
__author__ = "Flavio Percoco Premoli, Alberto Paro, " + \
         "Jonas Haag and contributors"
__contact__ = "django-non-relational@googlegroups.com"
__homepage__ = "https://django-mongodb.org"
__docformat__ = "restructuredtext"

try:
    from django.conf import settings
    settings.INSTALLED_APPS.insert(0, 'django_mongodb_engine')
    # It might be irritating that django-mongodb-engine registers itself as an app,
    # and I think this is worth an explanation - so here you go:
    # django-mongodb-engine provides a way to set MongoDB-specific options for a
    # certain model via the 'MongoMeta' class/attribute (similar to the Django-style
    # 'Meta' class).  We want those options to be copied into the model's
    # '_meta' object, right after the class has been defined.
    # For this, we have to listen to the 'class_prepared' signal from
    # 'django.db.models.signals'. Because the 'django_mongodb_engine' module gets
    # imported as part of the initialization process of Django's ORM ('django.db'),
    # we can *not* import anything from 'django.db' in this file (or any other
    # submodule that is imported while the ORM initialization) because that would
    # get us into recursive import hell which the Python interpreter doesn't allow.
    # The only way to make sure certain code is executed after Django's ORM has been
    # initialized is registering an app. After initializing itself, Django imports
    # all apps defined in the project's 'settings.py' in the order implied by
    # iterating over the INSTALLED_APPS list. As we have to make sure that
    # django-mongodb-engine is loaded very first, we prepend it to the list.
except ImportError:
pass 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:43:27.127

您需要在设置文件中配置值。如您所见，它们大多是空字符串。MongoLab 将在您创建的数据库的主页上为您提供所需的所有连接信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T00:38:56.880

似乎是一个错误。

检查[这份报告](https://github.com/django-nonrel/mongodb-engine/issues/153)。

如果您点击链接，[这里](https://github.com/django-nonrel/djangotoolbox/issues/36)的开发人员会说：

> mongodb-engine 目前不支持 django 1.4。所以坚持1.3。

那条评论是昨天的。就是这样，您使用的 Django 版本不兼容。

# unix - Crontab 格式 - 每 15 分钟

> ID：15033542
> 
> 赞同：34
> 
> 时间：2013-02-22T21:32:05.897
> 
> 标签：unix, crontab

我试图让一个简单的 crontab 作业每 15 分钟运行一次，但在决定如何格式化时间时遇到了麻烦。

我一直在放下的是以下内容：

```
15 * * * * ------------------------ 
```

我很确定这只是每小时的前 15 分钟。

我认为 crontab 允许用户指定运行的确切时间，即：

```
0, 15,30,45 * * * * ------------------------- 
```

但是，如果我想从启动 crontab 的那一刻起每 15 分钟运行一次（可能不一定是可被 15 整除的值），我将如何进行格式化/这可能吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-02-22T21:58:01.737

Crontab 不记得您“开始”的时间（大概是您执行`crontab -e`or`crontab filename`命令的时间）。

如果您想从任意时间开始每 15 分钟运行一次作业，则必须指定该时间。这：

```
7-59/15 * * * * command 
```

将在每小时后的 7、22、37 和 52 分钟运行。假设您正在运行 Vixie cron，这是最常见的实现。为了更好的便携性，您可以使用：

```
7,22,37,52 * * * * command 
```

请记住，前 5 个字段中的任何一个都不能有空格；`0, 15,30,45`，正如你在你的问题中所说的那样，是无效的。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-02-22T21:35:25.893

您可以像这样格式化 crontab，让它每 15 分钟运行一次。

`*/15 * * * * [path/to/script]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-27T11:12:09.200

`0,15,30,45`15 分钟不正确。

更好更简单的方法是`*/15 * * * *`15 分钟。

```
5 minutes
*/5 * * * *

15 minutes
*/15 * * * *

30 minutes
*/30 * * * *

60 minutes
0 * * * *

1 day
0 0 * * * 
```

# integration - 将 BuildBot 集成到 JIRA

> ID：15033554
> 
> 赞同：8
> 
> 时间：2013-02-22T21:32:44.893
> 
> 标签：integration, jira, jira-plugin, buildbot

我们有一个[BuildBot](http://buildbot.net/)设置用于我们的持续构建。此外，我们碰巧使用 JIRA 来满足我们所有的错误跟踪和任务需求。

我试图完成的（并且几乎没有发现任何信息）是将构建号（来自生成的构建）集成到 JIRA 中。具体来说，我需要两个字段：

*   **Found In Build**（下拉列表列出了以前的构建到某个阈值，允许 QA 简单地选择构建号）
*   **Resolved In Build**（另一个下拉菜单允许工程师选择包含修复的*未来构建）*

最终，我希望这些字段也成为必填字段，但这是更简单的任务。

在研究了几天之后，我找不到任何参考、插件甚至是关于如何完成此操作的提示；需要你的帮助。

请发布完整的答案而不是代码片段，这样您的努力就不会被使用/误解。

PS JIRA 版本：**5.2** BuildBot：**0.8.4p2**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-24T00:17:07.597

这不是一个直接的解决方案，但[竹子](http://www.atlassian.com/software/bamboo)与 jira 紧密集成，并在 jira 中自动显示此信息和其他信息，反之亦然。

# c++ - 在 3d 棋盘中求水量的技巧

> ID：15033555
> 
> 赞同：5
> 
> 时间：2013-02-22T21:32:45.413
> 
> 标签：c++, recursion, volume

所以我有一个任务，我必须重新创建一个 3d 棋盘，它是一个 RxC 方格，每个方格都有不同的高度。如果棋盘是不透水的，有人把水倒在上面，直到它不能再盛水，它就会盛住一定量的水。如果板子已经装满了最大量的水，任何倒在板上的多余水都会从边缘排出，板子周围没有高大的容器。你可以假设棋盘上的方格是一平方英寸，高度以英寸为单位。

```
int CalcContainedWater( const int *p_data, int num_columns, int num_rows ) 
```

where`p_data`是指向有符号整数的连续二维、行优先数组的第一个元素的指针。您的函数将针对不同形状和内容的板的参考实现进行测试，以确定其正确性。

请记住，其中的值`p_data`可以同时保存高度的正值和负值。

例如：

A) 下面的棋盘产生 3 的遏制。

```
1, 1, 1, 1, 1,
1, 0, 0, 0, 1,
1, 1, 1, 1, 1, 
```

B) 下面的棋盘产生 0 的遏制。

```
1, 0, 1,
1, 0, 1,
1, 1, 1, 
```

C) 下面的棋盘产生 1 的遏制。

```
0, 1, 0,
1, 0, 1,
0, 1, 0, 
```

**这是我到目前为止所拥有的：**

```
 #include "stdafx.h"
    #include <queue>
    #include <vector>
    using namespace std;

enum GridPosition
{
    TOP_LEFT_CORNER,
    TOP_RIGHT_CORNER,
    BOTTOM_LEFT_CORNER,
    BOTTOM_RIGHT_CORNER,
    TOP_ROW,
    BOTTOM_ROW,
    LEFT_COLUMN,
    RIGHT_COLUMN,
    FREE,
};

struct Square
{
    int nHeight;
    int nPos;
    GridPosition gPos;
    bool bIsVisited;
    bool bIsFenced;
    bool bIsFlooding;

    Square(){ nHeight = 0; nPos = 0; gPos = FREE; bIsVisited = false; bIsFenced = false; bIsFlooding = false;};
    ~Square(){};
    Square( int Height, int Pos, GridPosition GridPos, bool Visited, bool Fenced, bool Flooding) 
    { 
        nHeight = Height;
        nPos = Pos;
        gPos = GridPos;
        bIsVisited = Visited;
        bIsFenced = Fenced;
        bIsFlooding = Flooding;
    }
};

template< typename FirstType, typename SecondType >
struct PairComparator 
{
  bool operator()( const pair<FirstType, SecondType>& p1,
    const pair<FirstType, SecondType>& p2 ) const 
    {  
        return p1.second > p2.second;
    }
};

int CalcContainedWater( const int *p_data, int num_columns, int num_rows );

int CalcContainedWater( const int *p_data, int num_columns, int num_rows )
{
    priority_queue<pair<int,int>, vector<pair<int,int>>, PairComparator<int,int>> qPerimeter;
    queue<pair<int,int>> qFlooding;
    vector<Square> vSquareVec(num_columns * num_rows);

    int nTotalContained = 0;

    int nCurrentSqHeight = 0;
    int nCurrWaterLvl = 0;
    int nDepth = 1;

    for( int nRow = 0; nRow < num_rows; ++nRow)
    {
        for( int nColumn = 0; nColumn < num_columns; ++ nColumn)
        {
            int nCurrArrayPoint = nRow * num_columns + nColumn;
            nCurrentSqHeight = p_data[nCurrArrayPoint];

            Square sSquare(nCurrentSqHeight, nCurrArrayPoint, FREE, false,false,false);

            if(nRow == 0  && nColumn == 0)
                sSquare.gPos = TOP_LEFT_CORNER;
            else if(nRow == 0  && nColumn == num_columns - 1)
                sSquare.gPos = TOP_RIGHT_CORNER;
            else if(nRow == num_rows - 1  && nColumn == 0)
                sSquare.gPos = BOTTOM_LEFT_CORNER;
            else if(nRow == num_rows - 1  && nColumn == num_columns - 1)
                sSquare.gPos = BOTTOM_RIGHT_CORNER;
            else if( nRow == 0)
                sSquare.gPos = TOP_ROW;
            else if( nRow == num_rows -1 )
                sSquare.gPos = BOTTOM_ROW;
            else if( nColumn == 0)
                sSquare.gPos = LEFT_COLUMN;
            else if( nColumn == num_columns - 1)
                sSquare.gPos = RIGHT_COLUMN;

            vSquareVec[nCurrArrayPoint] = sSquare;

            if( nRow == 0  || nColumn == 0 ||  
                nColumn == num_columns - 1 || nRow == num_rows -1 )
            {
                sSquare.bIsFenced = true;

                vSquareVec[nCurrArrayPoint] = sSquare;

                pair<int,int> p1(nCurrArrayPoint, nCurrentSqHeight);

                qPerimeter.push(p1);
            }
        }
    }

    nCurrWaterLvl = qPerimeter.top().second;

    while( !qPerimeter.empty() )
    {
        pair<int,int> PerimPos = qPerimeter.top();
        qPerimeter.pop();

        if( !vSquareVec[PerimPos.first].bIsVisited )
        {
            if( vSquareVec[PerimPos.first].nHeight > nCurrWaterLvl )
                nCurrWaterLvl = vSquareVec[PerimPos.first].nHeight;

            vSquareVec[PerimPos.first].bIsFlooding = true;
            qFlooding.push(PerimPos);

            while( !qFlooding.empty() )
            {
                pair<int,int> FloodPos = qFlooding.front();
                qFlooding.pop();
                nDepth = nCurrWaterLvl - vSquareVec[FloodPos.first].nHeight;

                if( nDepth >= 0)
                {
                    vSquareVec[FloodPos.first].bIsVisited = true;
                    pair<int,int> newFloodPos;
                    switch(vSquareVec[FloodPos.first].gPos)
                    {
                    case TOP_LEFT_CORNER:
                        if( !vSquareVec[FloodPos.first + 1].bIsVisited && 
                            !vSquareVec[FloodPos.first + 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first + num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first + num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        break;
                    case TOP_RIGHT_CORNER:
                        if( !vSquareVec[FloodPos.first - 1].bIsVisited && 
                            !vSquareVec[FloodPos.first - 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first + num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first + num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        break;
                    case BOTTOM_LEFT_CORNER:
                        if( !vSquareVec[FloodPos.first + 1].bIsVisited && 
                            !vSquareVec[FloodPos.first + 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first - num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first - num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        break;
                    case BOTTOM_RIGHT_CORNER:
                        if( !vSquareVec[FloodPos.first - 1].bIsVisited && 
                            !vSquareVec[FloodPos.first - 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first - num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first - num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        break;
                    case TOP_ROW:
                        if( !vSquareVec[FloodPos.first - 1].bIsVisited && 
                            !vSquareVec[FloodPos.first - 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first + 1].bIsVisited && 
                            !vSquareVec[FloodPos.first + 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first + num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first + num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        break;
                    case BOTTOM_ROW:
                        if( !vSquareVec[FloodPos.first - 1].bIsVisited && 
                            !vSquareVec[FloodPos.first - 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first + 1].bIsVisited && 
                            !vSquareVec[FloodPos.first + 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first - num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first - num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        break;
                    case LEFT_COLUMN:
                        if( !vSquareVec[FloodPos.first + 1].bIsVisited && 
                            !vSquareVec[FloodPos.first + 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first + num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first + num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first - num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first - num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        break;
                    case RIGHT_COLUMN:
                        if( !vSquareVec[FloodPos.first - 1].bIsVisited && 
                            !vSquareVec[FloodPos.first - 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - 1 ].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first + num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first + num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first - num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first - num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        break;
                    case FREE:
                        if( !vSquareVec[FloodPos.first + 1].bIsVisited && 
                            !vSquareVec[FloodPos.first + 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first - 1].bIsVisited && 
                            !vSquareVec[FloodPos.first - 1].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - 1].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - 1].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - 1].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first + num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first + num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first + num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first + num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first + num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }
                        if( !vSquareVec[FloodPos.first - num_rows].bIsVisited && 
                            !vSquareVec[FloodPos.first - num_rows].bIsFlooding)
                        {
                            vSquareVec[FloodPos.first - num_rows].bIsFlooding = true;
                            newFloodPos.first = vSquareVec[FloodPos.first - num_rows].nPos;
                            newFloodPos.second = vSquareVec[FloodPos.first - num_rows].nHeight;
                            qFlooding.push(newFloodPos);
                        }

                        nTotalContained += nDepth;

                        break;
                    }

                }
                else
                {
                    vSquareVec[FloodPos.first].bIsFlooding = false;
                    if( !vSquareVec[FloodPos.first].bIsFenced )
                    {
                        vSquareVec[FloodPos.first].bIsFenced = true;
                        qPerimeter.push(FloodPos);
                    }
                }

            }
        }

    }
    return nTotalContained;
    } 
```

我所找到的只是顶部、底部、左侧和右侧的正方形高度。

目前，我一直在试图弄清楚如何获得总体积，因为如果它们的高度较小，水会溢出到正方形上。我看的越多，我就越认为它应该递归地完成，但找不到实现它的方法。

任何帮助将非常感激。不只是为了朝着正确的方向推进我需要做的事情而寻找答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T03:28:12.153

有趣的问题，有许多不同的解决方案。今天下午我一直在考虑这个问题，我会使用优先队列（也许是最小堆）进行洪水填充。我们称它为`fence`.

您还需要跟踪访问过的项目。最初将所有项目标记为未访问。

首先将网格周边的所有点添加到`fence`.

现在你像这样循环：

从 中弹出前面的项目`fence`。您已选择周长上的最低点之一。

*   如果该项目已被访问，则丢弃它并再次循环。
*   如果它未被访问，则只有当它大于当前水位时，它的高度才会成为您的新水位。

您现在从该点开始进行洪水填充。您可以递归地执行此操作（深度优先），但我将使用无序队列（广度优先）进行讨论。我们称这个队列为`flood`. 您首先将项目推到`flood`.

洪水然后是这样的：循环直到没有剩余的项目`flood`......

*   弹出一个项目`flood`
*   如果它已经被访问过，忽略它并再次循环。
*   如果项目高度小于或等于当前水位，请计算高度差并将其添加到您的总体积中。将项目标记为已访问，然后将所有未访问的邻居添加到`flood`。
*   如果项目高度大于当前水位，只需将其添加到`fence`. 您将需要一种方法来判断该项目是否已经存在`fence`- 您不想再次添加它。也许您可以扩展您的“已访问”标志以应对此问题。

就是这样。诚然，这只是一个思想实验，当我躺在那里感到宿醉和肮脏时，但我认为这很好。

* * *

正如你所要求的......一些伪代码。

最初设定：

```
## Clear flags.  Note I've added a 'flooding' flag
for each item in map
    item.visited <- false     # true means item has had its water depth added
    item.fenced <- false      # true means item is in the fence queue
    item.flooding <- false    # true means item is in the flooding queue
end

## Set up perimeter
for each item on edge of map (top, left, right, bottom)
    push item onto fence
end

waterlevel <- 0
total <- 0 
```

现在是算法的主要部分

```
while fence has items
    item <- pop item from fence
    if item.visited = true then loop again

    ## Update water level
    if item.height > waterlevel then waterlevel = item.height

    ## Flood-fill item using current water level
    push item onto flood
    item.flooding <- true

    while flood has items
        item <- pop item from flood
        depth <- waterlevel - item.height

        if depth >= 0 then
            # Item is at or below water level.  Add its depth to total.
            total <- total + depth
            item.visited <- true

            # Consider all immediate neighbours of item.
            for each neighbour of item
                if neighbour.visited = false then
                    if neighbour.flooding = false then
                        push neighbour onto flood
                        neighbour.flooding <- true
                    end
                end
            end
        else
            # Item is above water
            item.flooding <- false
            if item.fenced = false then
                push item onto fence
                item.fenced <- true
            end
        end

    end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:42:12.123

这不仅仅是简单地计算体积。

根据您发布的示例，您首先要测试*容器*，然后再担心容器的体积。

我建议确定板上是否存在封闭多边形。
如果多边形是闭合的，确定它的面积。
用于体积计算的高度将是所有围墙的最小高度。
最后，体积将是最小高度乘以多边形的面积。

基于顶点或线段向量确定闭合多边形的网络算法研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T22:39:32.557

这有点蛮力，但可能会奏效。

您可能会尝试在概念上将电路板分成几层，例如：

```
-------------------------
0 | 1 | 1 | 0 | 1 | 1 | 0
1 | 0 |-1 | 1 | 0 | 0 | 1
1 | 1 | 1 | 1 | 1 | 1 | 1
------------------------- 
```

只看最低层。假设 -1 是底部，板将如下所示：

```
-------------------------
0 | 0 | 0 | 0 | 0 | 0 | 0
0 | 0 |-1 | 0 | 0 | 0 | 0
0 | 0 | 0 | 0 | 0 | 0 | 0
------------------------- 
```

对于每个正方形，确定左侧、右侧、顶部和底部是否存在一个均具有更大值的正方形。在这种情况下，我们数 1。

然后移动到下一层，填补最后一层的“洞”。

```
-------------------------
0 | 1 | 1 | 0 | 1 | 1 | 0
1 | 0 | 0 | 1 | 0 | 0 | 1
1 | 1 | 1 | 1 | 1 | 1 | 1
------------------------- 
```

冲洗，重复。在这一层中，我们数 4，总共为 5。

```
-------------------------
1 | 1 | 1 | 1 | 1 | 1 | 1
1 | 1 | 1 | 1 | 1 | 1 | 1
1 | 1 | 1 | 1 | 1 | 1 | 1
------------------------- 
```

顶层显然没有，我们完成了。

在伪代码中：

```
for each layer l in layers
   for each square in l
      if there exists a square left, right, top and bottom with higher value
          count the square. 
```

**编辑**

当然，既然我有严重的问题，今天早上我醒来的第一件事就是想到这个问题，并立即打破了我的解决方案。

让我们对示例进行一项更改：

```
-------------------------
0 | 1 | 1 | 0 | 1 | 1 | 0
1 | 0 |-1 | 1 | 0 | 0 | 1
1 | 1 | 1 | 1 | 1 | 0 | 1
-------------------------
                    ^ 
```

在外面开一个洞。使用当前算法，我们将得到 4 的解，这显然是错误的。

为了解决这个问题，我们需要实现一个回溯算法。

我们不是在左边、右边、顶部和底部的任何地方寻找更高的值，而是只检查紧邻的方块。如果有任何高度相同，我们也需要访问该广场并再次执行检查。如果我们找到通往外面的路，那么原始方块（以及随后所有访问过的方块）都会失败。如果我们遇到了死胡同，那么所有访问过的方格都可以计算在内。

通过这种修改，我们将得到正确的结果 3。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-14T20:20:47.110

这是一段工作代码：基本思想是将棋盘水平分割成多个级别，并确定每个级别可以容纳的体积（复杂度 O(x * y * z)）：

```
#include <stdio.h>
#include <memory.h>

// The Cell structure for each level
struct Cell
{
    unsigned char height; // either 0 or 1
    bool visited; // we only visit the cells that have height of 0
};

// The recursive function that visits a cell, accumulate the water volume (or if leaked due to being at the border, reset the values); it also
// looks to its 4 adjacent cells (if valid) recursively.
// Note that the top level function actually attempts to visit *all* the "connected" cells (and mark them as visited, so they will not be visited again)
// From the top level, the cells are thus visited in "chunks" (as long as they are connected)
void VisitCell(Cell* one_level_cells, unsigned short a_w, unsigned short a_h, unsigned short w, unsigned short h, unsigned __int64* sum, bool* leaked)
{
    Cell& cell = one_level_cells[h * a_w + w];
    if (cell.height == 0 && !cell.visited)
    {
        cell.visited = true;
        if (w == 0 || w + 1 == a_w || h == 0 || h + 1 == a_h)
        {
            // I am at the border while I am not guarding the water, the water for this "chunk" is then leaked!
            *leaked = true;
            *sum = 0;
        }

        if (!*leaked)
        {
            // potentially increment the volume, until it's detected leaked at some point
            ++*sum;
        }

        if (w < a_w - 1)    VisitCell(one_level_cells, a_w, a_h, w+1, h, sum, leaked);
        if (w > 0)          VisitCell(one_level_cells, a_w, a_h, w-1, h, sum, leaked);
        if (h < a_h - 1)    VisitCell(one_level_cells, a_w, a_h, w, h+1, sum, leaked);
        if (h > 0)          VisitCell(one_level_cells, a_w, a_h, w, h-1, sum, leaked);
    }
}

//@param int const * const unsigned short *a_board - argument representing the NxM board.
//@param unsigned short a_w - argument representing the width of the board
//@param unsigned short a_h - argument representing the height of the board
//@return - unsigned __int64 - the volume of water the board retains

// complexity: O(a_w * a_h * max_height)
unsigned __int64 CalculateVolume(const unsigned short *a_board, unsigned short a_w, unsigned short a_h)
{
    if (!a_board || a_w < 3 || a_h < 3)
    {
        return 0;
    }
    // Basic algorithm: slice the board horizontally into as many levels as the maximum height of the board
    // for each sliced level, determine the water volume cubed so far, and the total volume is the sum of the volume of the individual level
    unsigned __int32 n = a_w * a_h;
    unsigned short max_height = 0;
    for (unsigned __int32 i = 0; i < n; ++i)
    {
        if (max_height < a_board[i])
        {
            max_height = a_board[i];
        }
    }
    unsigned short *board = new unsigned short[n];
    memcpy(board, a_board, n * sizeof(unsigned short));
    Cell* one_level_cells = new Cell[n];
    unsigned __int64 total_volume = 0;
    for (unsigned short i = 0; i < max_height; ++i)
    {
        // form a new current level of cells (and update the copy of the board accordingly)
        unsigned __int64 volume_this_level = 0;
        for (unsigned __int32 j = 0; j < n; ++j)
        {
            if (board[j] > 0)
            {
                --board[j];
                one_level_cells[j].height = 1;
            }
            else
            {
                one_level_cells[j].height = 0;
            }
            one_level_cells[j].visited = false;
        }

        // visit all the cells within the current level
        // we mark the cells after being visited, and the cells are visited in "chunks" when they are "connected" together
        // so effectively, most of the top level cell visiting would return immediately, rather than trying to revisit the cells again and again
        for (unsigned short h = 0; h < a_h; ++h)
        {
            for (unsigned short w = 0; w < a_w; ++w)
            {
                unsigned __int64 sum = 0;
                bool leaked = false;
                // NB: the top level function here will attempt to cover *all* the connected cells at the current level (in the recursion)
                // so even though we are still iterating through all the cells at the top level, most of them should find that the cell has been visited
                // so the sum here is actually a "chunked" sum in the perception of the top level cells
                VisitCell(one_level_cells, a_w, a_h, w, h, &sum, &leaked);
                volume_this_level += sum;
            }
        }

        total_volume += volume_this_level;
    }

    delete[] one_level_cells;
    delete[] board;

    return total_volume;
}

int main()
{
    // feel free to play with this board
    unsigned short board[] = {
        2, 2, 2, 2, 2, 2, 2, 2,
        2, 1, 1, 1, 1, 1, 1, 2,
        2, 1, 2, 3, 3, 2, 1, 2,
        2, 1, 3, 1, 1, 3, 1, 2,
        2, 1, 3, 1, 1, 3, 1, 2,
        2, 1, 2, 3, 3, 2, 1, 2,
        2, 1, 1, 1, 1, 1, 1, 2,
        2, 2, 2, 2, 2, 2, 2, 2,
    };
    printf("Volume: %lld\n", CalculateVolume(board, 8, 8));
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-18T07:24:15.680

这是@paddy 的python(2.7) 版本的伪代码。希望这会对某人有所帮助。

```
import heapq
block =[
1, 2, 3,
4 ,2,6,
7, 0,5,
11,15, 13,
14,15,16,
1,0,1,
1,1,1]
cmax =3; 
rmax =7;
items =[]
fence = []
flood = []
waterlevel = 0
total = 0
class Item(object):
    visited = False
    fenced = False
    flooding = False
    height= 0
    index = 0
i=0
## initializing blocks
for val in block:    
    item =  Item();
    item.height = val
    item.index = i
    i+=1
    items.append((item.height,item))
## find out the edges  
for i in range (cmax):
    heapq.heappush(fence, items[i])
    heapq.heappush(fence, items[i+(rmax-1)*cmax])
    print items[i][1].height,items[i+(rmax-1)*cmax][1].height

for i in range(1,rmax-1):
    heapq.heappush(fence, items[cmax*i])
    heapq.heappush(fence, items[cmax*i+(cmax-1)])
    print items[cmax*i][1].height,items[cmax*i+(cmax-1)][1].height

## get neighbour
def get_neighbour(i):
    c= i%cmax
    r= i//cmax
    neighbour = []
    if (c != 0):
        neighbour.append(items[r*cmax+c-1])
    if (c != (cmax -1)):
        neighbour.append(items[r*cmax+c+1])
    if (r != 0):
        neighbour.append(items[(r-1)*cmax+c])
    if (r != (rmax -1)):    
        neighbour.append(items[(r+1)*cmax+c])
    return neighbour

while (len(fence)>0):
    item = heapq.heappop(fence)
    if(item[1].visited):
        continue
    if (item[1].height > waterlevel):
        waterlevel = item[1].height
    heapq.heappush(flood,item)
    item[1].flooding = True
    while(len(flood)>0):
        fitem = heapq.heappop(flood)
        depth = waterlevel - fitem[1].height
        if (depth >= 0):
            total += depth
            fitem[1].visited = True
            neighbour = get_neighbour(fitem[1].index)
            for nitem in neighbour:
                if nitem[1].visited == False :
                    if nitem[1].flooding == False :
                        heapq.heappush(flood,nitem)
                        nitem[1].flooding = True
        else:
            fitem[1].flooding = False
            if fitem[1].fenced == False:
                heapq.heappush(fence,fitem)
                fitem[1].fenced = True
print total 
```

# python - 使用 Python 2.7 将 dbf 数据传递给句子并保存为文本文件

> ID：15033564
> 
> 赞同：1
> 
> 时间：2013-02-22T21:33:51.463
> 
> 标签：python, python-2.7, dbf

我有一个脚本，可以将一些结果导出到 dbf 文件（dbf 是我正在使用的软件的唯一导出选项）。我想使用这些结果（行数会有所不同）将包含结果的句子输出到文件中。

例如

汽车.dbf

```
Toyota
Mazda
Kia
Volkswagon 
```

我想输出以下句子：

在这个街区内，街上停着一辆丰田、马自达、起亚和大众汽车。

如果结果是两个我不想要逗号：

汽车.dbf

```
Toyota
Mazda 
```

在这个街区内，街上停着一辆丰田和马自达。

汽车.dbf

```
empty 
```

这附近的街道上没有停放汽车。

我知道如何执行 if else 语句，但不确定如何在句子中将 dbf 记录作为变量传递。任何人的想法？

使用python 2.7。

提前一千感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:08:53.090

使用[我的 dbf 包](https://pypi.python.org/pypi/dbf)：

```
import dbf
table = dbf.Table('Cars', default_data_types={'C':dbf.Char})  # don't want extra spaces
cars = []
table.open()
for record in table:
    cars.append(record[0])   # or cars.append(record.make) if 'make' is the field name

if len(cars) == 1 and cars[0] == 'empty'):
    # print no cars sentence
elif len(cars) == 1:
    # print one car sentence
elif len(cars) == 2:
    # print two car sentence
else:
    # print many car sentence 
```

在`for record in table`循环之后，所有名称都在`cars`列表中。那时它是简单的字符串替换：

```
# many car case
first = "Within this neighborhood there is a "
last = " parked on the street."
middle = ('%s, ' * (len(cars)-1) + 'and a %s') % tuple(cars)
print first + middle + last+ 
```

字符串替换使这`middle =`条线变得有点花哨。每个都`%s`将被替换为来自 的条目，并且如果您`cars`必须拥有与 相同数量的项目。当然，您需要在最后一项之前添加一个“和”。所以如果你有四辆车：`cars``%s`

```
cars = ['Mazda', 'Ford', 'Dodge', 'Yugo'] 
```

然后

```
len(cars) - 1 == 3 
```

所以

```
'%s, ' * (len(cars)-1) == '%s, %s, %s, ' 
```

然后我们添加最后一部分

```
'%s, ' * (len(cars)-1) + 'and a %s' == '%s, %s, %s, and a %s' 
```

最后，`%`字符串替换函数看到

```
'%s, %s, %s, and a %s' % tuple(cars) 
```

这会给我们

```
 'Mazda, Ford, Dodge, and a Yugo' 
```

注意：我们不得不说`tuple(cars)`因为`cars`是一个`list`并且`%`需要单个项目或项目元组。

# javascript - compare array, remove items

> ID：15033566
> 
> 赞同：0
> 
> 时间：2013-02-22T21:33:58.750
> 
> 标签：javascript, google-maps, google-places-api

Using the Google Places API, you can only get 20 results back from a single query ... so you can't query for ALL results at once, but rather need to store what has already been searched for (in an array) and add to that array or remove from that array...

This demonstrates my question ... I need to be able to add places to my array, but then search through the array and remove any places that are no longer needed.

Is there a "compare array" function that I should be utilizing, or perhaps something better? I just feel that's quite rudimentary... and perhaps I'm missing some Google API function that's obvious.

My plan is to create an object:

```
var placesObj = {}; 
```

And since all places can have multiple "types", I need to be able to push each place `id` into an array WITHIN the `placesObj` like so:

```
var placesObj = {
    bars: {'123123123123123', '123123123355555', '12312312132123'},
    parks: {'123123123123123', '123123123355555', '12312312132123'}
}; 
```

This way, I can look for the `id` string and remove it from the entire `placesObj` ...

I hope this makes sense... I just need to know how to construct this object.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:40:41.117

[http://php.net/manual/en/function.array-diff.php](http://php.net/manual/en/function.array-diff.php)应该对您有所帮助。它将返回一个数组，其中包含数组 1 中不存在于第二个数组中的所有条目。然后，您应该能够相应地修改您的数组。

编辑：现在很明显您引用的是javascript，而不是php，这是一个不同的对话。如果我要比较 JS 对象并相应地更新它们，我会使用键值对并像这样删除：

```
var placesObj = {
    bars: {'tavern': '123123123123123', 'bar123':'123123123355555', 'blahblah':'12312312132123'},
    parks: {'jungle' : '123123123123123', 'kidspar;':'123123123355555', 'foo': '12312312132123'}
}; 

delete placesObj['tavern']; 
delete placesObj['yourKey']; 
```

我假设您从 google 获取 json 响应并从响应中构建此对象...您可能只使用从 google 获得的其他一些唯一值来制作像地点名称一样的键。

# jquery - 使用面板和页面转换的 Jquery Mobile Glitch

> ID：15033569
> 
> 赞同：2
> 
> 时间：2013-02-22T21:34:03.820
> 
> 标签：jquery, mobile, panel, transition

我已经使用 Jquery Mobile 实现了一个面板导航系统。但是，似乎在发生页面转换时，会出现一些图形故障。在我的桌面 chrome 上，我页面上的渐变在过渡期间看起来被挤压了。在我的移动 chrome 浏览器上访问同一页面时，过渡期间页面底部会出现一条白线。

通过我的测试，我发现如果我去掉面板导航，图形故障也会消失。

这是其中一页的示例。其他页面在结构上看起来相同。

```
<!DOCTYPE html> 
<html>
<head> 
    <title>Vidapp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></sc    ript>

    <link rel="stylesheet" href="resources/custom.css" />
</head>

<body> 
<div data-role="page" data-theme="a">

    <div data-id="header" data-role="header" data-position="fixed" data-tap-toggle="false">
    <a href="#sidemenu" data-icon="bars">Menu</a>
    <h1>Contributions</h1>
    <a href="#" data-icon="home">Gift</a>
</div>

<div id="sidemenu" data-role="panel" data-position-fixed="true" data-display="overlay" data-theme="a">
    <ul data-role="listview">
        <li><a href="/views/browse/trending.html">Trending</a></li>
        <li><a href="/views/browse/friends.html">Friends</a></li>
        <li><a href="/views/browse/contributions.html">Contributions</a></li>
        <li><a href="/views/browse/mygifts.html">My Gifts</a></li>
    </ul>
</div>

<div data-role="content">
    <input type="search" name="search" id="search" data-mini="true" placeholder="Have a Reference Code?" />
    <h2>My Contributions</h2>
</div>

</div>
</body>
</html> 
```

代码托管在这里：[错误演示](http://vidapp.cardswap.ca/)

我无法弄清楚是什么导致了这些图形故障的发生！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T07:51:39.697

According to the jQuery Mobile website: [http://jquerymobile.com/demos/1.3.0-rc.1/docs/demos/widgets/panels/](http://jquerymobile.com/demos/1.3.0-rc.1/docs/demos/widgets/panels/)

> A panel must be a sibling to the header, content and footer elements inside a jQuery Mobile page. **You can add the panel markup either before or after these elements, but not in between.** A panel cannot be placed outside a page, but this constraint will be removed in a future version.

Try moving the panel to either before the header, or after the contact divs.

# android - 立即使用 android sdk 在 facebook 会话上请求发布权限

> ID：15033570
> 
> 赞同：3
> 
> 时间：2013-02-22T21:34:08.950
> 
> 标签：android, facebook

我正在尝试立即请求刚刚创建的用户会话的发布权限并收到以下错误，因为会话状态是“已创建”而不是“已打开”

```
"Session: an attempt was made to request new permissions for a session that is not currently open." 
```

如何立即请求发布权限？有什么方法可以授权新用户并在一次调用中获得发布权限？

最终会话会话 = Session.getActiveSession(); if (session.isOpened()) { shareToFacebook(loadedImage, shareBody, session); } 别的 {

```
final StatusCallback callback = new StatusCallback() {
    public void call(Session thisSession, SessionState state, Exception exception) {
        if (exception != null) {
            Toast.makeText(getApplicationContext(), "Facebook permissions failed: " + exception.getMessage(),
                    Toast.LENGTH_SHORT).show();
        }
        else
        {
            shareToFacebook(loadedImage, shareBody, thisSession);
        }
    }
};

//up the permissions and then post
if (session != null && !isSubsetOf(PERMISSIONS,  session.getPermissions())) {

    Session.NewPermissionsRequest newPermissionsRequest = new Session.NewPermissionsRequest(ActivityFacts.this, PERMISSIONS);
    session.addCallback(callback);
    session.requestNewPublishPermissions(newPermissionsRequest);
}
else
{
    //add user then up the permissions
    StatusCallback authorizeCallback = new StatusCallback() {
        public void call(Session thisSession, SessionState state, Exception exception) {
            if (exception != null) {
                Toast.makeText(getApplicationContext(), "Facebook login failed: " + exception.getMessage(),
                        Toast.LENGTH_SHORT).show();
            }
            else
            {
                Session.NewPermissionsRequest newPermissionsRequest = new Session.NewPermissionsRequest(ActivityFacts.this, PERMISSIONS);
                session.addCallback(callback);
                session.requestNewPublishPermissions(newPermissionsRequest);

            }
        }
    };

    OpenRequest openRequest = new OpenRequest(ActivityFacts.this);
    List<String> readPermissions = new ArrayList<String>();
    readPermissions.add("email");
    openRequest.setPermissions(readPermissions);
    openRequest.setLoginBehavior(SessionLoginBehavior.SSO_WITH_FALLBACK);
    openRequest.setCallback(authorizeCallback);
    session.openForRead(openRequest);
} 
```

}

# c++ - 在 Windows 中的顶级 Qt 应用程序上

> ID：15033571
> 
> 赞同：0
> 
> 时间：2013-02-22T21:34:11.637
> 
> 标签：c++, windows, qt

如何使我的应用程序始终位于最前面，这意味着用户无法以 Qt 或任何其他可能的 C++ 方式访问开始菜单或桌面？
我还需要它在登录进度后立即启动，更像是一个新的 windows gui，一个更简单的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T18:41:36.573

`QWidget::setWindowFlags(Qt::WindowStaysOnTopHint)`应该做的伎俩。请注意，在 X11 上的某些窗口管理器上，您还必须传递 Qt::X11BypassWindowManagerHint 才能使此标志正常工作。

# ios - xcode，在模拟器上启动是可以的，但无法存档

> ID：15033584
> 
> 赞同：0
> 
> 时间：2013-02-22T21:35:02.230
> 
> 标签：ios, iphone, xcode, homebrew, .a

我是 Xcode 的新手。

我在旧的（iOS 3.2）xcode 游戏项目上添加了一些功能。在我接触之前，这段代码已经有一年多没有接触过了。在我尝试制作 .iap 文件之前，它运行良好。它运行正常，我的所有更改都没有出错。所以我从 iPhone 6.0 Simulator -> iOS Device 更改了目标设备，并尝试存档。不幸的是，它产生了一堆错误：

```
ld: warning: ignoring file lib/libegn_neutron_http_Release_iphoneos.a, file was built for archive which is not the architecture being linked (armv7): lib/libegn_neutron_http_Release_iphoneos.a
Undefined symbols for architecture armv7:
  "_EGN_setPollingInMenu", referenced from:
      ExitGamesCreateSession(sLibraryData*) in exitgames.o
  "_EGN_Neutron_New", referenced from:
      ExitGamesInit(sLibraryData*) in exitgames.o
  "_EGN_setServerUrl", referenced from:
      ExitGamesCreateSession(sLibraryData*) in exitgames.o 
```

......类似的34个错误继续

```
 "_EGN_NeutronCls_Release", referenced from:
      ExitGamesShutDown(sLibraryData*) in exitgames.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

这个项目使用了一些支持社交功能的“exitgames”库。这个项目也有一些“Brew”c++代码的包装部分。不知道哪个部位有问题。试图弄清楚并搜索了一整天，但仍然无法获得线索。

有人可以给我一个建议吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:01:48.530

尝试从命令行运行 lipo -info exitgames.a，它应该会告诉您该框架支持哪些架构。

# jquery - 在幻灯片中使用 jQuery fadeIn() 后从其他 div 添加和删除类

> ID：15033587
> 
> 赞同：1
> 
> 时间：2013-02-22T21:35:16.160
> 
> 标签：jquery, addclass, removeclass

我使用 jQuery 制作了幻灯片。它使用fadeIn 和fadeOut 方法。这工作正常。

我需要帮助的是向另一个 div 添加一个 css 类，具体取决于显示的幻灯片。我在 JSfiddle 中添加了一些缩短的代码，这样您就可以更好地理解我的意思。

[http://jsfiddle.net/dRqKM/](http://jsfiddle.net/dRqKM/)

我希望在显示相应的幻灯片时突出显示粉红色框。

添加以下内容似乎不起作用：

```
if ($("#firstSlide").css("display") == "block") {
    $("#div1").addClass("Highlight");
    $("#div2").removeClass("Highlight");
    $("#div3").removeClass("Highlight");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:39:50.890

您拥有的那些 if 语句只会在页面准备好时运行一次，而您会希望它们在点击时被触发，我想。此外，您的 Highlight 类没有足够高的特异性来覆盖 .button 类的背景样式。在您的样式表中考虑这一点：

```
div.Highlight { background:green; } 
```

然后将节点添加到样式规则将覆盖按钮类的背景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:44:59.477

三大问题：

1.  的特殊性`.Highlight`与`.button`因为`.Highlight`在 CSS 定义中首先出现，所以 bg 颜色从`.button`获胜并保持粉红色。赋予它更高的特异性或更高的重要性（例如`div.Highlight`or`.button.Highlight`或 use `!important`）
2.  您的代码没有考虑轮换——当您单击下一个/上一个按钮时。所以任何变成绿色的东西都会保持绿色，因为你没有旋转它。
3.  您的检查代码（if/else if/else if 块）是错误的。看起来不错，`if`但其他两个条件块是错误的。我将假设这只是一个演示错字。但我在我的例子中修复了它。

[http://jsfiddle.net/dRqKM/1/](http://jsfiddle.net/dRqKM/1/) 查看这个小提琴的工作版本。请注意，如果您希望框在淡入淡出结束**之前**转动，只需将调用移动到调用`changeActiveChild`之后*而*不是`fadeIn`回调函数内部，例如[http://jsfiddle.net/dRqKM/6/](http://jsfiddle.net/dRqKM/6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:51:42.063

我在这里修复了一些逻辑问题：

[http://jsfiddle.net/dRqKM/7/](http://jsfiddle.net/dRqKM/7/)

除此之外最大的问题是`.Highlight`该类是在该类之前声明的，`button`因此将它们都添加了，`button`该类仍然具有优先权。因此，即使逻辑正确，它也无法正常工作。我将班级移到`.Highlight`班级下方`button`并修复了一些逻辑。现在你们都可以走了。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-22T21:38:22.417

从所有按钮中删除类，然后将其添加回正确的类：

```
$('.buttons').removeClass('Highlight');
targetButton.addClass('Highlight'); 
```

此外，您的`Highlight`课程不够具体，无法覆盖该`button`课程。另一件需要注意的事情是，如果您有意`background-color: green;`而不是`background`. `background`CSS 属性用作快捷方式，语法不同。如果您只指定颜色，通常首选前一种方法。

这是一个工作版本：

```
 $(document).ready(function () {
     $('.slideshow').find('> li:eq(0)').nex\All().css({ 'opacity': '0', 'display': 'none' });
     $('.controls > a').click(function (event) {
        event.preventDefault();
        var currentslide = $(this).parents('li:first');

        var currentposition = $('.slideshow li').index(currentslide);
        var nextposition = ($(this).attr('class') == 'next') ? currentposition + 1 : currentposition - 1;

        $('.buttons').removeClass('Highlight');
        $('#div'+(nextposition+1)).addClass('Highlight')

        $('.slideshow li:eq(' + currentposition + ')').hide() 
        $('.slideshow li:eq(' + nextposition + ')').fadeIn(2000);
    });
}); 
```

JSFiddle：http: [//jsfiddle.net/dRqKM/8/](http://jsfiddle.net/dRqKM/8/)

**文档**

*   `jQuery.addClass`- [http://api.jquery.com/addClass/](http://api.jquery.com/addClass/)
*   `jQuery.removeClass`- [http://api.jquery.com/removeClass/](http://api.jquery.com/removeClass/)
*   jQuery 选择器 - [http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)
*   `background`MDN 上的CSS - [https://developer.mozilla.org/en-US/docs/CSS/background](https://developer.mozilla.org/en-US/docs/CSS/background)
*   `background-color`MDN 上的CSS - [https://developer.mozilla.org/en-US/docs/CSS/background-color](https://developer.mozilla.org/en-US/docs/CSS/background-color)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-22T21:45:29.717

在这里你是队友：http: [//jsfiddle.net/zFnfC/](http://jsfiddle.net/zFnfC/)

两行在 js 和 1 在 css

```
$("div.buttons").removeClass('Highlight');
$("#div" + (nextposition + 1)).addClass('Highlight'); 
```

和CSS：

```
.Highlight { background: green !important; } 
```

# security - ubuntu 将文件从 windows 复制到 /var/www 风险

> ID：15033600
> 
> 赞同：1
> 
> 时间：2013-02-22T21:36:23.473
> 
> 标签：security, ubuntu, copy, paste

我有一台用于开发的 Windows 机器。当代码工作时，我 ssh 并将文件从 developermnet 复制到生产环境，即 /var/www。

这种复制和粘贴安全吗？我看到一些文件被标记为读/写，而另一些文件只被标记为读。以这种方式将文件从 dev 传输到 prod 时我应该担心吗？

当我执行 >ls /var/www 时，文件的输出应该是什么？

如果有人可以提供一些提示。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T00:36:03.953

/var/www/ 是默认的文档根目录，因此应该/将拥有您网站的根文件夹。ls 会列出它们，而 ls -ltr 会为您提供这些文件夹/文件的所有属性信息。

您可以通过 ssh 进入 Dev 并将文件传输到 prod，但更好的方法是设置安全 ftp 和只能访问 var/www/ 下的特定目录的特定用户帐户，然后将其设置为所有其他人。这样，只有一个用户可以在文件系统级别访问 Prod，并且访问和记录非常有限。

# jquery - 使用 jQuery 在表格网格中选择相邻的 td

> ID：15033602
> 
> 赞同：0
> 
> 时间：2013-02-22T21:36:30.027
> 
> 标签：jquery, html-table

我正在尝试使用 jQuery 制作简单的数字游戏。我使用 html 表格构建了一个 7x7 网格。我创建了一些 jQuery 函数来允许用户突出显示和取消突出显示表格中的单元格。我想让用户选择的第一个单元格必须位于最左侧的列中，然后选择的每个后续单元格必须与突出显示的单元格相邻，直到它们将单元格一直连接到右侧桌子。这些单元格中会有数字，并且会有一些我尚未确定的游戏功能。

通过一个简单的布尔值和一些 if 逻辑，我确定第一个单元格必须来自左列，但现在**我无法确保每个后续单元格都与突出显示的单元格相邻**。我为表格中的每个 td 分配了一个编号 id，从 1 到 49（7 行，每行 7）。当用户选择一个单元格时，我会在一个名为 cellCoord 的数组中捕获该单元格的 id。我希望这样的事情可能会奏效：

```
var thisCell = parseInt($(this).attr('id'));
if  (thisCell == (cellCoord[i]+1) || thisCell == (cellCoord[i]-1) ||
     thisCell == (cellCoord[i]+7) || thisCell == (cellCoord[i]-7)) 
```

不幸的是，它没有。有什么建议么？

我的努力的早期草稿可以在[这里](http://andysgamelab.com/xgrid.htm "X 网格")找到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:14:35.860

从您的网站上获取表格，我会对其进行一些更改，添加课程

```
<table>
    <tr class="row">
        <td class="square candidate"></td>
        <td class="square"></td>
        <td class="square"></td>
        <td class="square"></td>
        <td class="square"></td>
        <td class="square"></td>
        <td class="square"></td>
    </tr>
    ...
</table> 
```

CSS：

```
.square {
    width: 30px;
    height: 30px;
    border: white solid 1px;
    background-color: lightblue;
}

.highlighted {
    background-color: lime;
} 
```

然后选择相邻的方块

```
$('.square').click(function () {
    if ($(this).hasClass('candidate')) {
        $(this).addClass('highlighted');
        // select adjacent squares
        // horizontal
        $(this).prev('.square').addClass('candidate');
        $(this).next('.square').addClass('candidate');
        // vertical
        var i = $(this).index();
        $(this).parent('.row').prev('.row').children(':eq(' + i + ')').addClass('candidate');
        $(this).parent('.row').next('.row').children(':eq(' + i + ')').addClass('candidate');
    }
}); 
```

一个正方形是 a `.candidate`，如果它与一个已经存在的`.highlighted`正方形相邻。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:45:35.873

jQuery 的`.index()`功能可以为您解决这个问题。它可以告诉您在一组项目中选择了哪个项目。

[http://api.jquery.com/index/](http://api.jquery.com/index/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:46:05.513

为每个单元格分配一个 x 和 y 坐标。此外，添加一个类“选定”做任何突出显示的 div。例如。

```
<div data-x="1" data-y="1"><div data-x="2" data-y="1">
<div data-x="1" data-y="2"><div data-x="2" data-y="2"> 
```

然后像下面这样。

```
var div = $('#idOfDivJustClicked');
var x = div.data('x');
var y = div.data('y'); 
```

然后使用 jquery 的 attr 选择器搜索包含正负一的 x 或 y 坐标的 div。这不是确切的逻辑，您需要实现类似的东西。

```
if ($('div[data-x=' + (x+1) + '][data-y=' + y + ']').hasClass('selected'))
{
    // found an adjacent highlighted cell
    // execute code
} 
```

# ruby-on-rails - Heroku 推送被拒绝，检测到 Ruby 版本已更改，找不到 net-scp-1.0.6

> ID：15033607
> 
> 赞同：4
> 
> 时间：2013-02-22T21:37:05.733
> 
> 标签：ruby-on-rails, ruby, deployment, heroku

我无法弄清楚这里发生了什么。我在星期二部署到 Heroku 没有问题。我没有在本地或 Gemfile 上更改我的 Ruby 版本，但 heroku 告诉我我已经更改了 Ruby 版本并且它无法找到 net-scp-1.0.6。一切都在本地完美运行，我四处搜索，找不到任何解决类似问题的东西。

```
Counting objects: 81, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (62/62), done.
Writing objects: 100% (62/62), 10.77 KiB, done.
Total 62 (delta 49), reused 0 (delta 0)
-----> Deleting 8 files matching .slugignore patterns.
-----> Removing .DS_Store files
-----> Ruby/Rails app detected
-----> Using Ruby version: ruby-1.9.3
-----> Installing dependencies using Bundler version 1.3.0.pre.5
       Ruby version change detected. Clearing bundler cache.
       Old: ruby 1.9.3p327 (2012-11-10 revision 37606) [x86_64-linux]
       New: ruby 1.9.3p392 (2013-02-22 revision 39386) [x86_64-linux]
       Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin --deployment
       Fetching gem metadata from https://rubygems.org/.......
       Fetching gem metadata from https://rubygems.org/..
       Could not find net-scp-1.0.6 in any of the sources
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app 
```

这就是我的 Gemfile 的样子。

```
source 'https://rubygems.org'

ruby '1.9.3'

gem 'rails', '~> 3.2.11'

gem 'aws-sdk'
gem 'jquery-rails'
gem 'jquery-ui-rails'

gem 'pg'
gem 'thin'
gem 'best_in_place'
gem 'stripe'
gem 'paperclip'
gem 'coffeebeans'
gem 'mail'
gem 'bcrypt-ruby', '~> 3.0.0'
gem 'carmen'
gem 'haml'
gem 'devise'
gem 'sinatra', '~> 1.3.2'
gem 'dynamic_form'
gem 'fog', '~> 1.3.1'
gem 'wicked'
gem 'lazy_high_charts', '~> 1.1.5'
gem 'jquery-datatables-rails'
gem 'sass-rails'

group :assets do
  gem 'uglifier', '>= 1.0.3'
  gem 'coffee-rails', '~> 3.2.1'
end

group :test, :development do
  gem 'hirb'
end 
```

任何想法，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-22T21:41:18.077

net-scp-1.0.6 gem 最近被猛拉。

在本地，运行：

```
gem cleanup  
bundle update 
```

然后提交并推送，它会将 net-scp 更新到最新版本，你会没事的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-22T21:44:27.040

看来我想通了。此问题是由于出于安全考虑而从 Ruby Gems 中删除了 net-scp 引起的。我按照有关此 Fog 问题的说明 ( [https://github.com/fog/fog/issues/1561](https://github.com/fog/fog/issues/1561) ) 并将 net-scp 锁定到 1.0.4 并且生活恢复正常。

# r - 在 Windows 上设置 R 以获取 texlive 而不是 miktex

> ID：15033615
> 
> 赞同：29
> 
> 时间：2013-02-22T21:37:16.577
> 
> 标签：r, latex, rstudio, miktex

**在 Windows 上，我如何指示 R 调用 TeXlive 而不是 MikTeX？**

我在我的 Linux 和 Windows 机器上设置了 R。在我的 Windows 机器上，我碰巧有 MikTeX 和 TeXlive 可用。由于我不会进入的原因，我希望 R 调用 TeXlive。此时，R 正在选择 MikTeX。

我猜我需要在我的 Renviron 文件中设置 TEXINPUTS 或类似的东西。但是我一直无法在网上找到准确的说明。帮助将不胜感激。

更新：这是我尝试过的不同的事情：更改 PATH 中 TeXlive 和 MikTeX 的顺序。从路径中删除 MikTeX。两者都不起作用，MikTeX 仍在被使用。

我找不到 R 的相关文档，但我确实在 RStudio 文档中找到了一些提示，因此我尝试在 RStudio 中解决问题。我成功定义了 RSTUDIO_PDFLATEX 环境变量：

```
Sys.getenv('RSTUDIO_PDFLATEX')
[1] "C:/texlive/2012/bin/win32" 
```

[参考：http://www.rstudio.com/ide/docs/authoring/latex_program?version=0.97.312&mode=desktop]

但是仍然需要使用 MikTeX。

```
Sys.which("pdflatex")
                                         pdflatex 
"C:\\PROGRA~2\\MIKTEX~1.9\\miktex\\bin\\pdflatex.exe" 
```

更新 2：我尝试过的另一件事：虽然 texlive 已经在我的 PATH 上，但以防万一我从 R 中添加它。

```
Sys.setenv("PATH" = paste(Sys.getenv("PATH"),"C:/texlive/2012/bin/win32",sep=":")) 
```

我还尝试将 Sys.which("pdflatex") 返回的 pdflatex 的路径设置为：

```
Sys.setenv(pdflatex="C:/texlive/2012/bin/win32") 
```

以及带有 PDFLATEX 或“PDFLATEX”的变体，但这无济于事。除了 texlive 的路径之外，我还从路径中删除了所有内容：

```
Sys.setenv("PATH" = "C:/texlive/2012/bin/win32") 
```

这给了我想要的路径

```
Sys.which("pdflatex")
                                 pdflatex 
"C:\\texlive\\2012\\bin\\win32\\pdflatex.exe" 
```

但是，运行 texi2dvi 失败：

```
tools::texi2pdf(Out)
Error in texi2dvi(file = file, pdf = TRUE, clean = clean, quiet = quiet,  : 
pdflatex is not available 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-27T16:22:58.053

我在一个类似的项目中遇到了同样的问题，并花了一些时间了解其中的技巧。即使您清理了路径，MikTeX 仍然被选中的事实是由于在安装 MikTeX 时设置了相当多的 Windows 注册表项这一有点令人恼火的事实（特别是对于像我和其他人这样面向 *nix 的开发人员）。便携式 MikTeX（仅限 win32）发行版是唯一的例外。因此，如果您确实需要 MikTeX，我的建议就是做我所做的：

1.  卸载您当前的 MikTeX 发行版
2.  清理注册表（ccleaner 效果很好）
3.  安装便携式 win32 MikTeX 发行版

现在再次检查您的路径是否包含您的 TeXlive bin 目录路径。
如果您使用 pandoc 从 Rmarkdown 或其他 markdown 语言创建 pdf 文件，解决路径问题的一种便捷方法是指定`--latex-engine`选项并将完整文件路径添加为参数。下面是一个可能的命令行，改编自 RStudio IDE：
`path/to/pandoc.exe -V papersize=A4 +RTS -K512m -RTS file.utf8.md --to latex --from markdown+autolink_bare_uris+ascii_identifiers+tex_math_single_backslash-implicit_figures --output file.pdf --template path/to/default.tex --highlight-style tango --latex-engine /path/to/pdflatex.exe --variable geometry:margin=1in`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-04T20:37:18.217

我很确定您需要在全局环境变量中添加路径。请参阅：[http](http://statmath.wu.ac.at/software/R/qfin/) ://statmath.wu.ac.at/software/R/qfin/和[http://www.howtogeek.com/51807/how-to-create-and-use-global-system-environment-variables /](http://www.howtogeek.com/51807/how-to-create-and-use-global-system-environment-variables/)

# powershell - Filewatcher - 捕获多个事件问题

> ID：15033617
> 
> 赞同：0
> 
> 时间：2013-02-22T21:37:21.820
> 
> 标签：powershell, powershell-2.0

我有一个脚本可以监视文件并触发诸如更改之类的事件。它可以工作，除了我需要处理的同一个文件（之前的 Stackflow 问题）触发了重复事件。我正在将文件名写入日志文件，并且只有在它不存在时才重新记录它。

问题是我认为事件是同步触发的，即使我正在检查重复，我在日志中也有 2 个条目用于 1 个文件更改。我不知道如何解决这个问题。

这是代码：

```
Unregister-Event FW*

$source = 'S:\FIS-BIC Reporting\Report Output Files\IT\'
$filter = '*.*'
$MasterFile = "H:\PS\EmailNotifications.csv"
$LogFile = "H:\EmailNotify.log"

$FilesToCheck = import-csv -path $Masterfile 

if (! (Test-Path $Logfile))
{
$Output =  "Date|Filename|FilenameSpec|Email"
$Output | Out-File $LogFile 
}

function Get-CharRight($str,$chars)
{
 return $str.Substring($str.Length – $chars, $chars)
}

function ProcessFile()
{
param ([string]$filename)

Write-Host "file: $filename"

$ext= (Get-CharRight $filename 3)

if ($ext -ne "tmp")
{
  foreach($FileToCheck in $FilesToCheck)
    {
        if($filename  -like $FileToCheck.FilenameSpec)
            {
               Write-Host "Match"
               #check log to see if an email was already sent
                $Exists = import-csv -path $Logfile -delimiter "|"  | where-object {$_.Filename -eq $filename} 

                Write-Host ($Exists.Count -eq $null)

                if ($Exists.Count -eq $null)
                    {            
                    Write-Host "Not in logfile"        
                    $Date = Get-Date -format G
                    $Output = $Date + "|" + $filename + "|" + $FileToCheck.FilenameSpec + "|" + $FileToCheck.Email
                    $Output | Out-File $LogFile -append    

                    }
                    else
                    {write-host "duplicate"}
            }
    }
}
}

    $fsw = New-Object IO.FileSystemWatcher $source, $filter -Property @{IncludeSubdirectories = $true; NotifyFilter = [IO.NotifyFilters]'FileName, LastWrite, Attributes'}
Register-ObjectEvent $fsw Changed -SourceIdentifier FWFileChanged -Action {
ProcessFile $Event.SourceEventArgs.FullPath 
}

Register-ObjectEvent $fsw Created -SourceIdentifier FWFileCreated -Action {
ProcessFile $Event.SourceEventArgs.FullPath 
}

while($true) {
  start-sleep -s 2
} 
```

`

# r - 存在缺失观察时使用逻辑比较对行进行子集化

> ID：15033619
> 
> 赞同：0
> 
> 时间：2013-02-22T21:37:31.470
> 
> 标签：r

我试图从包含缺失观察的数据框中子集行。我可以选择满足特定条件的行。但是，在使用`!`. 最终，我能够通过使用排除不符合所需条件的行`-`。

有没有办法用 排除所需的行`!`？

这是一个示例数据集：

```
df = read.table(text = "
     state  county    var1.a  var2.a  var1.b  var2.b
        1       1       10       25      20      25
        1       2       20       15      20      15
        2       1       30       NA      40      25
        2       2       40       35      10      35
        3       1       20       45      10      NA
        3       2       20       55      20      55
        4       1       NA       65      NA      NA
        4       2       80       NA      30      NA
        5       1       NA       15      NA      15
        5       2       NA       15      NA      35
", na.strings = "NA", header = TRUE)

# 1\. works, selects Rows 2, 6 and 9, rows in which columns 3 and 5 are the same and
# columns 4 and 6 are the same

df[ (which( ( ((df$var1.a == df$var1.b) | (is.na(df$var1.a) & is.na(df$var1.b))) & 
              ((df$var2.a == df$var2.b) | (is.na(df$var2.a) & is.na(df$var2.b))) ) , arr.ind=TRUE)),]

# 2\. does not work when excluding Rows 2, 6 and 9, does not retain Row 7

df[ (which(!( ((df$var1.a == df$var1.b) | (is.na(df$var1.a) & is.na(df$var1.b))) & 
              ((df$var2.a == df$var2.b) | (is.na(df$var2.a) & is.na(df$var2.b))) ) , arr.ind=TRUE)),]

# 3\. does not work, does not select any rows

df[!(which( ( ((df$var1.a == df$var1.b) | (is.na(df$var1.a) & is.na(df$var1.b))) & 
              ((df$var2.a == df$var2.b) | (is.na(df$var2.a) & is.na(df$var2.b))) ) , arr.ind=TRUE)),]

# 4\. works, selects Rows 1,3,4,5,7,8,10

df[-(which( ( ((df$var1.a == df$var1.b) | (is.na(df$var1.a) & is.na(df$var1.b))) & 
              ((df$var2.a == df$var2.b) | (is.na(df$var2.a) & is.na(df$var2.b))) ) , arr.ind=TRUE)),] 
```

上面的第二个`which`语句没有选择第 7 行，因为：

```
( ((df$var1.a == df$var1.b) | (is.na(df$var1.a) & is.na(df$var1.b))) & 
  ((df$var2.a == df$var2.b) | (is.na(df$var2.a) & is.na(df$var2.b))) ) 
```

返回：

```
# [1] FALSE  TRUE FALSE FALSE FALSE  TRUE    NA FALSE  TRUE FALSE 
```

所以，我想我明白为什么`!`在这种情况下不起作用；但我不知道如何获得：

```
# [1] FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE 
```

除了第 1、3、4、5、8、10 行之外，我如何修改第二`which`条语句以还返回第 7 行？`which`如果没有缺失的观察结果 ，第二个语句确实有效。

即使没有缺失的观察，第三个`which`语句也不起作用。我知道那`-`是用来删除行或列的。我知道这`!`是为了逻辑比较。我猜第三个`which`语句不符合逻辑比较的要求，但第二个`which`语句可以。

我想我可以使用第一`which`条语句来选择符合所需条件的行，并使用第四条`which`语句来选择不符合所需条件的行。但是，我想知道如何使用`!`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:57:42.797

你错过了一个是`NA`而另一个不是的情况；应该是`FALSE`这样，因为它不匹配，但你得到一个`NA`. 由于这是您获得 的唯一情况`NA`，因此我们可以事后检查。这是一种方法：

```
> ok1 <- ((df$var1.a == df$var1.b) | (is.na(df$var1.a) & is.na(df$var1.b)))
> ok2 <- ((df$var2.a == df$var2.b) | (is.na(df$var2.a) & is.na(df$var2.b)))
> ok.both <- ok1 & !is.na(ok1) & ok2 & !is.na(ok2)
> ok.both
[1] FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE 
```

此外，创建一个新函数来执行此操作可能很有用，如下所示：

```
eqna <- function(a, b) {
  ok <- ((a == b) | (is.na(a) & is.na(b)))
  ok & !is.na(ok)
} 
```

你会这样使用它：

```
> with(df, eqna(var1.a, var1.b) & eqna(var2.a, var2.b))
 [1] FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T05:25:32.993

我在这里可能是错的（用我的手机写的）但看起来#2 不起作用的原因只是由于括号。

`!`只是否定你的条款的前半部分。尝试在逗号之后添加另一组括号`!`并在逗号之前将其关闭。

另外，请记住，这`!`只是反转逻辑值。即它交换 T/F，同时将 NA 保留为 NA。

# c++ - 过载 - 不在范围内

> ID：15033623
> 
> 赞同：0
> 
> 时间：2013-02-22T21:37:43.107
> 
> 标签：c++, class, compiler-errors, overloading

我收到这些错误：

```
circleType.cpp||In function 'std::ostream& operator<<(std::ostream&, circleType&)':|
circleType.cpp|48|error: 'getRadius' was not declared in this scope|
circleType.cpp|49|error: 'circumference' was not declared in this scope|
circleType.cpp|50|error: 'area' was not declared in this scope|
||=== Build finished: 3 errors, 0 warnings (0 minutes, 0 seconds) ===| 
```

在这里发现错误：

```
ostream& operator <<(ostream& outs, circleType& circle1)
{
   outs << "radius: " << getRadius() << endl
   << "circumference: " << circumference() << endl
   << "area: " << area() << endl;
   return outs;
} 
```

例如，这是圆周函数：

```
double circleType::circumference()
{
    return (radius*2*pi);
} 
```

头文件：

```
class circleType
{
public:
    circleType(); // færibreytulaus smiður
    circleType(double the_radius);
    double getRadius();
    void setRadius(double the_radius);
    double area();
    double circumference();
    friend ostream& operator <<(ostream& outs, circleType& );
private:
    double radius;
}; 
```

主要的：

```
circleType circle1(3.0);
cout << "circle1:" << endl;
cout << "--------" << endl;
cout << circle1 << endl; 
```

所有标题都包含在任何地方。我对重载功能仍然有些困惑，请提供任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:39:07.360

您没有在输入对象 ( `circle1`) 上调用成员函数；相反，您正在尝试调用一些不存在的具有相同名称的*全局*`friend`函数（请注意，函数不是它是朋友的类的成员函数，而是具有被授予访问班级内部的权限）。

`operator <<`要解决此问题，请按如下方式更改重载的定义：

```
ostream& operator << (ostream& outs, circleType& circle1)
{
   outs << "radius: " << circle1.getRadius() << endl
   << "circumference: " << circl1.circumference() << endl
   << "area: " << circle1.area() << endl;
   return outs;
} 
```

# ios - 带有 UIScrollView 的 UIPanGestureRecognizer

> ID：15033625
> 
> 赞同：2
> 
> 时间：2013-02-22T21:38:02.507
> 
> 标签：ios, objective-c, uikit

我已经和 UIScrollView 斗争了一段时间了。我有一个滚动视图，其中包含多个“卡片”样式视图。我希望卡片垂直移动，就像上下滑动一样。

**想象一下 MobileSafari 的标签视图，但通过向下滑动来关闭标签。**

如果不与滚动视图水平平移发生冲突，我无法弄清楚如何做到这一点。**我要么让他们都平移，要么只平移一次（垂直/水平）。**

使这项工作完美的最佳实践是什么，例如**“如果您垂直滑动，停止水平滑动，如果您水平滑动，停止垂直滑动”。**

谢谢！

*这是我想要的说明：*

![扫一扫](../Images/b43d702f6054c217d8c8c3398e028d6b.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T21:57:23.530

滚动视图有它自己的手势识别器：查看它的[`panGestureRecognizer`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/occ/instp/UIScrollView/panGestureRecognizer)属性。如果您添加自己的识别器来检测垂直滑动，您可以使用[`requireGestureRecognizerToFail:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIGestureRecognizer_Class/Reference/Reference.html#//apple_ref/occ/instm/UIGestureRecognizer/requireGestureRecognizerToFail%3a)或[委托方法](http://developer.apple.com/library/ios/documentation/uikit/reference/UIGestureRecognizerDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UIGestureRecognizerDelegate)来管理两个识别器之间的依赖关系。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T23:15:10.340

我真的对您的应用程序的预期行为感到困惑。您可以互换使用滑动和平移，但它们是不同的手势识别器。

区分的一种方法是比较`translationInView:`手势方法的 x 和 y 值。如果 y > x，你有一个垂直滑动/平移；x > y 你有一个水平滑动/平移。

如果检测到的滑动/平移不是您正在寻找的类型，则使该手势识别器失败。

# sql - 如何保存更改/将新对象添加到相关实体实体框架

> ID：15033629
> 
> 赞同：0
> 
> 时间：2013-02-22T21:38:16.810
> 
> 标签：sql, entity-framework, relational-database, primary-key

我有两个在 SQL 中相关的表：

```
 MasterPartNumbers           MasterPartsLists
 (pk) pn       (one-> many)  (fk) pn
      desc                        parentAssemblyPn
                             (pk) partsListLineItemID 
```

注意：`MasterPartNumbers`确实与 共享导航关系`MasterPartsList`，但关系的“多”侧 ( `MasterPartsLists.pn`) 不是主键或唯一键。同一个`pn`（零件号）可以属于几个不同`parentAssmeblyPn`的

现在，我想确保添加到我`ObjectContext`的属于这两个实体中的任何一个的任何数据都转发给另一个。

问题1：在向上下文添加新对象（_context.MasterPartNumbers.AddObject(someEnumerable)）和应用.SaveChanges()时，如何使用.Include()方法传递相关信息？

# bash - 特定行下方的 Awk Calc Avg 行

> ID：15033632
> 
> 赞同：0
> 
> 时间：2013-02-22T21:38:34.377
> 
> 标签：bash

我无法使用 awk 计算特定文本标识符下方列中特定数字的平均值。我有两列数据，我试图在重复的公共标识符上开始平均键控，即 01/1991。因此，awk 应该计算从 01/1991 开始的所有行的平均值，然后重复使用接下来的 21 行，其中 1991-2012 年的总行数为平均值 = 22。所需的输出是 1991 年至 2012 年每年所有一月 (01) 的每个 TextID/Name 条目的平均值，如下所示：

TextID/Name 1 Avg: 50.34 TextID/Name 2 Avg: 45.67 TextID/Name 3 Avg: 39.97 ...

样本数据：

```
TextID/Name 1
01/1991, 57.67
01/1992, 56.43
01/1993, 49.41
..
01/2012, 39.88
TextID/Name 2
01/1991, 45.66
01/1992, 34.77
01/1993, 56.21
..
01/2012, 42.11
TextID/Name 3
01/1991, 32.22
01/1992, 23.71
01/1993, 29.55
..
01/2012, 35.10
continues with the same data for TextID/Name 4 
```

我正在使用下面显示的此代码得到答案，但平均值是在特定标识符行之前开始计算的，而不是在该行（01/1991）之上和之下。

```
awk '$1="01/1991" {sum+=$2} (NR%22==0){avg=sum/22;print"Average: "avg;sum=0;next}' myfile 
```

非常感谢您对解决方案的解释！我已经用更多描述编辑了原始答案 - 再次感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T23:25:46.243

如果您查看文件，第一个字段是“01/1991”，末尾有一个逗号，而不是“01/1991”。此外， NR%22==0 将查看可被 22 整除的行号，而不是它认为您关心的点之后的 22 行。

你可以这样做：

```
awk '
  BEGIN { l=-1; }
  $1 == "01/1991," { 
    l=22; 
    s=0; 
  }  

  l > 0 { s+=$2; l--; }
  l == 0 { print s/22; l--; }' 
```

它有一个计数器 l ，它设置为要计数的行数，然后将这些行数相加。

您可能想考虑简单地将从 01/1991 到下一个的所有行相加，这可能更健壮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T23:02:22.453

如果你被允许使用 Perl 而不是 Awk，你可以这样做：

```
#!/usr/bin/env perl

$start = 0;
$have_started = 0;
$count = 0;
$sum = 0;

while (<>) {
  $line = $_;

  # Grab the value after the date and comma
  if ($line = /\d+\/\d+,\s+([\d\.]+)/) {
    $val = $+;
  }

  # Start summing values after 01/1991
  if (/01\/1991,\s+([\d\.]+)/) {
    $have_started = 1;
    $val = $+;
  }

  # If we have started counting,
  if ($have_started) {
    $count++;
    $sum += $+;
  }
}

print "Average of all values = " . $sum/$count; 
```

像这样运行它：

```
$ cat your-text-file.txt | above-perl-script.pl 
```

# mysql - MySQL 更新触发器 - 如何检测未通过的值？

> ID：15033633
> 
> 赞同：1
> 
> 时间：2013-02-22T21:38:35.723
> 
> 标签：mysql, triggers

假设我有这些可能的查询：

```
UPDATE table SET field1 = 2 WHERE id = 1;
UPDATE table SET field1 = 4, field2 = 8 WHERE id = 16; 
```

`table`有一个`BEFORE UPDATE`触发器可以计算`field2`基于的新值`field1`，但我希望它仅在我没有专门传递值时才这样做。

我正在检测对`field1`with的更改`IF OLD.field1 != NEW.field1 THEN ...`，但是无论实际值如何变化，我如何检测`field2`是否通过？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T20:10:43.523

如果 MySQL 没有通过 UPDATE 接收到值，`field2`它将包含`NEW.field2`.

`field2`在 Oracle 中，如果未通过更新传递，您将获得 NULL 。

如果`NEW`和`OLD`值相同，您可以假设该字段不需要更新。`NEW`如果所有值与表中已有的值匹配，MySQL 还将返回 0 行更新。

# html - Firefox中未显示Textarea滚动条

> ID：15033635
> 
> 赞同：1
> 
> 时间：2013-02-22T21:38:43.310
> 
> 标签：html, firefox, textarea, scrollbar

我有一个动态创建/插入到 DOM 中的文本区域。如果文本区域的高度低于 75px 并且其中的文本超过了该高度，那么您会看到滚动条，但您看不到它。

任何其他大于 75px 的 textarea 都会正确显示滚动条。

有没有办法解决这个问题，或者这只是 Firefox 的默认行为？

这是我的 CSS

```
textarea {
           position:absolute; 
           border:0;  
           overflow:auto; 
           resize:none;
} 
```

更新：行为现在不一致，现在下降到 60px 以下 60px 没有滚动条

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:49:14.333

适用于高度小于 75 像素的我。但是，当 textarea 的高度非常小时（大约 35 像素）滚动条将不适合，因此不会显示。尝试为 textarea 添加以下 CSS：

```
textarea {    
    resize: none; //disable resizing, so that the scrollbar is 100% high
    overflow: auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-29T10:03:19.850

由于 Firefox 和 Internet Explorer 根本不支持滚动条的任何 CSS 样式。使用插件真的是你唯一的选择

# ruby-on-rails - 简单的 SSH 测试 Rails

> ID：15033640
> 
> 赞同：1
> 
> 时间：2013-02-22T21:39:00.073
> 
> 标签：ruby-on-rails, ruby, ssh, controller

我只是想在我的 rails 应用程序中 ssh 到远程机器后列出目录，但我没有得到所需的输出，我忽略了什么？主机是一个IP。

控制器-

```
def index
  @ssh_test = Net::SSH.start( :host =>'xx.x.xx.xx',:user => 'name', :password => 'secret' ) do |ssh|
   result = ssh.exec!('ls')
   puts result
  end
end 
```

宝石文件-

```
gem 'net-ssh' 
```

看法

```
<h2><%= @ssh_test %></h2> 
```

当前目录不应该打印到我的视图吗？感谢您的关注。

*更新*

这是更新的进度，似乎仍然没有完全掌握这一点。

```
before_filter :set_ssh, :only => [:index]

  def index
    @ssh_dir = Net::SSH.start( @host, @user, :password => @password ) do |ssh|
    result = ssh.exec!('ls')
  end

  def set_ssh
    @host = 'xx.x.xx.xx'
    @user = 'user'
    @password = 'password'
  end 
```

看法-

```
<h1><%= @ssh_dir( host, user, password).inspect %></h1> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:41:36.733

您需要返回结果并且您调用 start 的方式不正确，请尝试以下操作：

```
def index
  @ssh_test = Net::SSH.start('xx.x.xx.xx','name', :password => 'secret' ) do |ssh|
   result = ssh.exec!('ls')
   result
  end
end 
```

这是根据：[http ://net-ssh.github.com/net-ssh/ 在 net-ssh 版本 2 中调用 start 的正确方法](http://net-ssh.github.com/net-ssh/)

编辑：回答在哪里放置你的配置。

如果您要使用的 ssh 服务器在所有环境中都是固定的，那么我可能会将其放入初始化程序中：

```
config/initializers/my_ssh_config.rb 
```

这将有：

```
$SSH_HOST = 'xx.x.xx.xx'
$SSH_USERNAME = 'name'
$SSH_PASSWORD = 'secret' 
```

请注意，我个人不会将用户名和密码存储在配置中，但可能先尝试一下以使其正常工作。（我通常会将其设为环境变量并执行此操作 $SSH_PASSWORD = ENV['SSH_PASSWORD'] 等）

然后您的控制器操作将如下所示：

def index @ssh_test = Net::SSH.start($SSH_HOST, $SSH_USERNAME, :password => $SSH_PASSWORD) 做 |ssh| 结果 = ssh.exec!('ls') 结果结束结束

您还可以将其添加到您的环境文件（例如 test.rb、development.rb）。

# linux - xlsx 与 7z 的压缩方法

> ID：15033646
> 
> 赞同：7
> 
> 时间：2013-02-22T21:39:13.533
> 
> 标签：linux, compression, zip, xlsx

我正在尝试以编程方式修改 excel 文件（xlsx）。我可以成功解压，根据需要修改xml，重新压缩。但是，每次打开 excel 时都会收到警告，即使它确实读取了文件。我相信错误是由于使用的压缩方法造成的。这是我能得到的最接近的例子：

解压

```
7z x original.xlsx -o./decomp_xlsx 
```

..做一些事情..

压缩

```
7z a -tzip new ./decomp_xlsx/* 
```

改名

```
mv ./new.zip ./new.xlsx 
```

我得到的错误是：Excel 在“new.xlsx”中发现了不可读的内容。是否要恢复此工作簿的内容？如果您信任此工作簿的来源，请单击“是”。

来自 ECMA-376-2 Office Open Formats Part 2 (Packaging Conventions) 支持的压缩算法是 DEFLATE，如 .ZIP 规范中所述。包实现者不得使用除 DEFLATE 之外的任何压缩算法。

那么，我需要在 7z 或其他 linux 兼容程序中使用哪些开关才能在没有警告的情况下完成工作？我试过删除 -tzip 并使用 -m0=COPY，但 excel 甚至无法从那个中恢复。

所以这里是 zip 程序和 zipinfo 的结果。我猜除了下面提供的工具外，我不会找到执行此操作的工具，因此我将授予该答案，并看看是否可以找到可以翻译为 python 进行测试的人。我不确定它是否处理 4.5 / 3.0，然后是 b- / tx 或 defS / defF 之间的差异。

```
$ zipinfo original.xlsx
Archive:  original.xlsx
Zip file size: 228039 bytes, number of entries: 20
-rw----     4.5 fat     1969 b- defS 80-Jan-01 00:00 [Content_Types].xml
-rw----     4.5 fat      588 b- defS 80-Jan-01 00:00 _rels/.rels
-rw----     4.5 fat     1408 b- defS 80-Jan-01 00:00 xl/_rels/workbook.xml.rels
-rw----     4.5 fat      908 b- defS 80-Jan-01 00:00 xl/workbook.xml
-rw----     4.5 fat    35772 b- defS 80-Jan-01 00:00 xl/worksheets/sheet4.xml
-rw----     4.5 fat      322 b- defS 80-Jan-01 00:00 xl/worksheets/_rels/sheet4.xml.rels
-rw----     4.5 fat      322 b- defS 80-Jan-01 00:00 xl/worksheets/_rels/sheet1.xml.rels
-rw----     4.5 fat   230959 b- defS 80-Jan-01 00:00 xl/worksheets/sheet2.xml
-rw----     4.5 fat   263127 b- defS 80-Jan-01 00:00 xl/worksheets/sheet3.xml
-rw----     4.5 fat   295775 b- defS 80-Jan-01 00:00 xl/worksheets/sheet1.xml
-rw----     4.5 fat     1947 b- defS 80-Jan-01 00:00 xl/sharedStrings.xml
-rw----     4.5 fat    22698 b- defS 80-Jan-01 00:00 xl/styles.xml
-rw----     4.5 fat     7079 b- defS 80-Jan-01 00:00 xl/theme/theme1.xml
-rw----     4.5 fat      220 b- defS 80-Jan-01 00:00 xl/printerSettings/printerSettings2.bin
-rw----     4.5 fat   464247 b- defS 80-Jan-01 00:00 xl/externalLinks/externalLink1.xml
-rw----     4.5 fat      338 b- defS 80-Jan-01 00:00 xl/externalLinks/_rels/externalLink1.xml.rels
-rw----     4.5 fat      220 b- defS 80-Jan-01 00:00 xl/printerSettings/printerSettings1.bin
-rw----     4.5 fat      593 b- defS 80-Jan-01 00:00 docProps/core.xml
-rw----     4.5 fat    62899 b- defS 80-Jan-01 00:00 xl/calcChain.xml
-rw----     4.5 fat     1031 b- defS 80-Jan-01 00:00 docProps/app.xml
20 files, 1392422 bytes uncompressed, 223675 bytes compressed:  83.9%

$ zipinfo new.xlsx
Archive:  new.xlsx
Zip file size: 233180 bytes, number of entries: 20
-rw-r--r--  3.0 unx     1031 tx defF 80-Jan-01 00:00 docProps/app.xml
-rw-r--r--  3.0 unx      593 tx defF 80-Jan-01 00:00 docProps/core.xml
-rw-r--r--  3.0 unx    62899 tx defF 80-Jan-01 00:00 xl/calcChain.xml
-rw-r--r--  3.0 unx   464247 tx defF 80-Jan-01 00:00 xl/externalLinks/externalLink1.xml
-rw-r--r--  3.0 unx      338 tx defF 80-Jan-01 00:00 xl/externalLinks/_rels/externalLink1.xml.rels
-rw-r--r--  3.0 unx      220 bx defF 80-Jan-01 00:00 xl/printerSettings/printerSettings1.bin
-rw-r--r--  3.0 unx      220 bx defF 80-Jan-01 00:00 xl/printerSettings/printerSettings2.bin
-rw-r--r--  3.0 unx     1947 tx defF 80-Jan-01 00:00 xl/sharedStrings.xml
-rw-r--r--  3.0 unx    22698 tx defF 80-Jan-01 00:00 xl/styles.xml
-rw-r--r--  3.0 unx     7079 tx defF 80-Jan-01 00:00 xl/theme/theme1.xml
-rw-r--r--  3.0 unx      908 tx defF 80-Jan-01 00:00 xl/workbook.xml
-rw-r--r--  3.0 unx   295775 tx defF 80-Jan-01 00:00 xl/worksheets/sheet1.xml
-rw-r--r--  3.0 unx   230959 tx defF 80-Jan-01 00:00 xl/worksheets/sheet2.xml
-rw-r--r--  3.0 unx   263127 tx defF 80-Jan-01 00:00 xl/worksheets/sheet3.xml
-rw-r--r--  3.0 unx    35772 tx defF 80-Jan-01 00:00 xl/worksheets/sheet4.xml
-rw-r--r--  3.0 unx      322 tx defF 80-Jan-01 00:00 xl/worksheets/_rels/sheet1.xml.rels
-rw-r--r--  3.0 unx      322 tx defF 80-Jan-01 00:00 xl/worksheets/_rels/sheet4.xml.rels
-rw-r--r--  3.0 unx     1408 tx defF 80-Jan-01 00:00 xl/_rels/workbook.xml.rels
-rw-r--r--  3.0 unx     1969 tx defF 80-Jan-01 00:00 [Content_Types].xml
-rw-r--r--  3.0 unx      588 tx defF 80-Jan-01 00:00 _rels/.rels
20 files, 1392422 bytes uncompressed, 229608 bytes compressed:  83.5% 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T08:17:46.460

出于某种奇怪的原因，微软正在查看本地文件头和中央目录头中“需要提取的版本”中的操作系统编码。它希望那些为零，但 7z 将它们设置为 3 用于 Unix。如果您打算使用 7z，则需要修补生成的文件。

该程序将这样做：

```
/* needz.c - zero the operating system byte for "version needed to extract" in
   the local and central headers of the zip files given on the command line.
   Placed in the public domain by Mark Adler, 23 Feb 2013\. */

#include <stdio.h>
#include <stdlib.h>

static void bail(char *why, char *what)
{
    fprintf(stderr, "needz error: %s%s\n", why, what);
    exit(1);
}

/* Read len bytes from offset as a little-endian integer.  Negative offsets are
   considered to be from the end of the file. */
static unsigned long peek(FILE *stream, off_t offset, int len)
{
    int ret, shift;
    unsigned long val;

    ret = fseeko(stream, offset, offset < 0 ? SEEK_END : SEEK_SET);
    if (ret)
        bail("not a zip file", "");
    val = 0;
    shift = 0;
    while (len--) {
        ret = getc(stream);
        if (ret == EOF)
            bail("not a zip file", "");
        val += (unsigned long)ret << shift;
        shift += 8;
    }
    return val;
}

/* Write len bytes to offset from val as a little-endian integer.  Negative
   offsets are considered to be from the end of the file. */
static void poke(FILE *stream, off_t offset, int len, unsigned long val)
{
    int ret;

    ret = fseeko(stream, offset, offset < 0 ? SEEK_END : SEEK_SET);
    if (ret)
        bail("not a zip file", "");
    while (len--) {
        ret = putc(val, stream);
        if (ret == EOF)
            bail("could not write", "");
        val >>= 8;
    }
}

/* Zero out the OS byte in the extract fields.  This assumes the classic zip
   format (not Zip64), and no zip file comment. */
static void zip_zero_os(char *path)
{
    FILE *zip;
    unsigned entries;
    off_t central, local;

    zip = fopen(path, "r+b");
    if (zip == NULL)
        bail("could not open", path);
    if (peek(zip, -22, 4) != 0x06054b50)
        bail(path, " is not a zip file or has an end comment");
    entries = peek(zip, -12, 2);
    central = peek(zip, -6, 4);
    while (entries--) {
        if (peek(zip, central, 4) != 0x02014b50)
            bail(path, " has a structure error or is Zip64");
        poke(zip, central + 7, 1, 0);
        local = peek(zip, central + 42, 4);
        if (peek(zip, local, 4) != 0x04034b50)
            bail(path, " has a structure error or is Zip64");
        poke(zip, local + 5, 1, 0);
        central += 46 + peek(zip, central + 28, 2) +
                   peek(zip, central + 30, 2) + peek(zip, central + 32, 2);
    }
    if (fclose(zip) == EOF)
        bail("could not close ", path);
}

int main(int argc, char **argv)
{
    while (--argc)
        zip_zero_os(*++argv);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T00:42:08.577

您可以使用 system`zip`而`unzip`不是。我经常使用类似下面的东西。

将 xlsx 文件解压缩到一个目录：

```
$ unzip -o -d xlsx_dir Workbook1.xlsx
Archive:  Workbook1.xlsx
  inflating: xlsx_dir/[Content_Types].xml  
  inflating: xlsx_dir/_rels/.rels    
  inflating: xlsx_dir/xl/_rels/workbook.xml.rels  
  inflating: xlsx_dir/xl/workbook.xml  
  inflating: xlsx_dir/xl/sharedStrings.xml  
  inflating: xlsx_dir/xl/theme/theme1.xml  
  inflating: xlsx_dir/xl/styles.xml  
  inflating: xlsx_dir/xl/worksheets/sheet1.xml  
 extracting: xlsx_dir/docProps/thumbnail.jpeg  
  inflating: xlsx_dir/docProps/core.xml  
  inflating: xlsx_dir/docProps/app.xml 
```

然后修改一个或多个 XML 文件并重新压缩它们：

```
$ cd xlsx_dir

# Do something with the files like:
$ sed -i '' s/Foo/Bar/ xl/sharedStrings.xml     

$ find . -type f | xargs zip ../newfile.xlsx 
```

目录中的`find|zip`from 不是很漂亮，但它会生成一个与原始文件结构匹配的文件结构，而无需额外的路径剥离。

# php - 花括号作为 .inc 文件中的注释

> ID：15033647
> 
> 赞同：0
> 
> 时间：2013-02-22T21:39:19.650
> 
> 标签：php

我有一个非常奇怪的问题，我确信是基本问题。服务器上有一个 .inc 文件。我需要在其中添加 php 代码。我无法将 ext 更改为 .php，因为它正在被其他页面使用。所以我做了一些研究，并在此基础上将其添加到我的 .htaccess

```
<Files myfilename.inc>
AddType application/x-httpd-php .inc

</Files> 
```

它似乎执行 .php 代码，但有一个问题。我需要在我的代码中使用一个包含大括号的 foreach 循环。出于某种原因，我的记事本（notepad++）将其显示为评论。当我运行代码时，甚至“回显”1“；” 不工作。有什么想法吗？

我的PHP代码：

```
 <div id="install-guides-wrap">
                    <label for="install-guides">Installation Videos</label>
                    <select id="install-guides">
                        <?php

foreach(glob('../files/videos/*.*') as $filename)
{
     $name1 = str_replace('../files/videos/', '', $filename);
     $ext = pathinfo($name1, PATHINFO_EXTENSION);
     $notneeded=".".$ext;
     $name = str_replace($notneeded, '', $name1);

     echo "<option value='".$name1."'>".$name."</option>"."<br/>";
     echo "myname";
      echo $name;

 }

            ?>
                        </select>

                    <a class="btn-download" title="Download this file!" href="">DOWNLOAD</a>
                </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:04:03.663

虽然这并不能解决您的问题的根源，但我敢打赌，它被视为评论的原因是`glob('../files/videos/*.*')`（请注意您`/*`在那里有一个？）。当您寻找问题的真正原因时，您可以通过将其切换为来解决该问题（通过将其分成两部分来`glob('../files/videos/'.'*.*')`摆脱它）。`/*`

# java - XML 不显示到 ListView 会导致错误和崩溃

> ID：15033649
> 
> 赞同：0
> 
> 时间：2013-02-22T21:39:23.037
> 
> 标签：java, android, android-listview, logcat

我收到一个 XML 文档作为变量`xml`，在调试器中我可以确认 XML 已被抓取并`data`正确保存。现在它永远不会在我的列表中显示带有错误的崩溃。

我的代码：

```
if (xml != null) {
                {
                    NodeList nl = doc.getElementsByTagName(KEY_ITEM);
                    for (int i = 0; i < nl.getLength(); i++) {
                        HashMap<String, String> map = new HashMap<String, String>();
                        Element e = (Element) nl.item(i);
                        map.put(KEY_CONTACTTITLE, getValue(e, KEY_CONTACTTITLE));
                        map.put(KEY_NAME, getValue(e, KEY_NAME));
                        map.put(KEY_MAINPHONE, getValue(e, KEY_MAINPHONE));
                        map.put(KEY_CELLPHONE, getValue(e, KEY_CELLPHONE));
                        map.put(KEY_FAX, getValue(e, KEY_FAX));
                        map.put(KEY_EMAIL, getValue(e, KEY_EMAIL));
                        menuItems.add(map);
                    }

                    ListAdapter adapter = new SimpleAdapter(context, menuItems,
                            R.layout.activity_move_contacts, new String[] {
                                    KEY_CONTACTTITLE, KEY_NAME, KEY_MAINPHONE, KEY_CELLPHONE, KEY_FAX, KEY_EMAIL },
                            new int[] { R.id.ContactTitle, R.id.Name,
                                    R.id.MainPhone, R.id.CellPhone, R.id.Fax, R.id.Email });
                    setListAdapter(adapter);
                }
            } 
```

LogCat 错误：

```
02-22 21:31:59.466: E/AndroidRuntime(4482): FATAL EXCEPTION: main
02-22 21:31:59.466: E/AndroidRuntime(4482): java.lang.NullPointerException
02-22 21:31:59.466: E/AndroidRuntime(4482):     at android.widget.SimpleAdapter.<init>(SimpleAdapter.java:85)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at com.testingapp.MoveContactsActivity$contentCall.onPostExecute(MoveContactsActivity.java:120)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at com.testingapp.MoveContactsActivity$contentCall.onPostExecute(MoveContactsActivity.java:1)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at android.os.AsyncTask.finish(AsyncTask.java:631)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at android.os.AsyncTask.access$600(AsyncTask.java:177)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at android.os.Looper.loop(Looper.java:137)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at android.app.ActivityThread.main(ActivityThread.java:5039)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at java.lang.reflect.Method.invokeNative(Native Method)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at java.lang.reflect.Method.invoke(Method.java:511)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-22 21:31:59.466: E/AndroidRuntime(4482):     at dalvik.system.NativeStart.main(Native Method) 
```

我个人没有过多地使用适配器，并且相信我可能会搞砸一些事情。

# vb.net - Visual Basic.Net 将 Long 转换为 Ulong

> ID：15033650
> 
> 赞同：0
> 
> 时间：2013-02-22T21:39:31.637
> 
> 标签：vb.net, type-conversion, long-integer

我在使用**VB.Net**尝试将 a 转换`Long`为 a时遇到问题，`ULong.` 我尝试了许多组合并不断出现溢出错误。我的有符号值为 -2147483648，我知道`Ulong`一旦转换它就会有 2151196588。

但是我想以编程方式执行此操作，因为我正在解析可以是负数和正数的值，但是当数字为负数时，它们需要具有正确的`ulong`值。注意：绝对值不起作用，它需要`ulong`为真值。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T23:01:55.217

您可以使用 BitConverter 类：

```
Dim a As Int64 = -2147483648
Dim b = BitConverter.ToUInt64(BitConverter.GetBytes(a), 0)
Console.WriteLine(b.ToString) ' outputs: 18446744071562067968 
```

您确定您的预期值 2151196588 是正确的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:46:48.127

如果你的意思是`reinterpret_cast<ulong>(long)`，然后使用[相同的技术](https://stackoverflow.com/q/6474003/11683)：

```
<Runtime.InteropServices.StructLayout(Runtime.InteropServices.LayoutKind.Explicit)> _
Public Structure LongULongUnion
    <Runtime.InteropServices.FieldOffset(0)> Public l As Long
    <Runtime.InteropServices.FieldOffset(0)> Public ul As ULong
End Structure

Sub Main()
    Dim u As LongULongUnion

    u.l =  -2147483648L
    Console.WriteLine(u.ul)

    Console.ReadLine()
End Sub 
```

但这会`18446744071562067968`在转换时给出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T23:54:39.427

这是将*任何*Long 转换为 ULong 的最简单方法：

```
Dim x As Long = -2147483648
Dim y As ULong = Not (CType((Not x), ULong)) ' = 18446744071562067968 
```

我是一名 C# 程序员，所以如果我将它错误地转换为 VB.NET，请纠正我。我的 C# 代码是：

```
long x = -2147483648;
ulong y = ~((ulong)~x); // = 18446744071562067968 
```

基本上你取负值的补码，它总是一个正值。然后，您可以安全地将其转换为 ULong。再次取补码，您就可以将相同的位模式转换为 ULong。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T21:44:12.673

确保在将值转换为 ulong 之前将其转换为正值，负值不在 ulong 的值范围内。

```
long: -9223372036854775808 to 9223372036854775807
ulong: 0 to 18446744073709551615 
```

# javascript - 使用多个按钮打开 JQuery 对话框？

> ID：15033653
> 
> 赞同：0
> 
> 时间：2013-02-22T21:39:51.343
> 
> 标签：javascript, jquery, facebook

我想为几个不同的按钮打开我的 Jquery 对话框。我有一个在点击时调用的 facebook ui 提要（我希望在对话框中有它，但那是另一回事了）。它只打开一个按钮（出现在我的 html 中的第一个按钮）。这是代码：

```
<script>
$(function() {
  $( "#dialog-modal" ).dialog({autoOpen: false, resizable: false, draggable: false, height: 250, width: 500, modal: true, dialogCLass: 'main-dialog-class'});

  $( "#opener" ).click(function() {
                       $( "#dialog-modal" ).dialog( "open" );

                       $.getJSON(
                                 "/like_artist.php", // The server URL
                                 { artist_id : $(this).data('artist_id') }, // Data you want to pass to the server.
                                 function(json) {

                                 var artist = json[1];

                                    var text = '';
                                    text = ' ' +  artist ;

                                    FB.ui({
                                    method: 'feed',
                                   // redirect_uri: '/index.php',
                                    link: 'WEBPAGE',
                                    name: '',
                                    caption: '',
                                    description: ''

                                    });

                                    $('#dialog-modal').text(text);

                                    alert(artist);
                                 }// The function to call on completion.
                                 );

        });

  });

</script> 
```

按钮：

```
<button type="button" id="opener" data-artist_id="3">Play My City</button>

<button type="button" id="opener" data-artist_id="4">Play My City</button>

<button type="button" id="opener" data-artist_id="2">Play My City</button> 
```

ETC...

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T23:22:00.960

全部更改`id="opener"`为`class="opener"`

然后将您的 js 更改`$( "#opener" ).click`为`$( ".opener" ).click`

# ruby - 通过 XML-RPC 更新 WordPress 中的 post_meta

> ID：15033654
> 
> 赞同：2
> 
> 时间：2013-02-22T21:39:53.283
> 
> 标签：ruby, wordpress, xml-rpc

我目前正在从事一个项目，该项目涉及从 300 多个静态页面中抓取数据并将该数据传输到 WordPress 站点。[我已经使用 Simple Fields ( http://simple-fields.com/](http://simple-fields.com/) ) 插件设置了各种自定义字段，并且有一个基本的 XML-RPC 连接正常工作。下面是我用来测试注入自定义帖子的内容（用 Ruby 编写）：

```
connection = XMLRPC::Client.new_from_uri "http://localhost:8888/xmlrpc.php"
username   = "admin"
password   = "password"
test_post  = {
  :post_type   => "custom_property",
  :post_status => "draft",
  :post_title  => "test post!",
  :post_meta   => {
    :_simple_fields_fieldGroupID_1_fieldID_3_numInSet_0 => "test"
  }
}
puts connection.call("wp.newPost", 1, username, password, test_post) 
```

我试过 :custom_fields 代替 :post_meta 但仍然无济于事。我似乎无法更新通过简单字段创建的自定义字段。

如果有人对做什么有任何建议，将不胜感激。

* * *

编辑：通过使用本文扩展 XML-RPC 功能解决了这个问题：http: [//kovshenin.com/2010/custom-xml-rpc-methods-in-wordpress/](http://kovshenin.com/2010/custom-xml-rpc-methods-in-wordpress/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T23:14:47.233

弄清楚 Wordpress 帖子的结构实际上非常棘手。如果它是您要发布的自定义字段，则应使用以下格式：

```
'custom_fields' => [{'key' => 'something', 'value' => 'something else'}] 
```

如果是自定义分类法，请使用：

```
'terms' => {
            'custom_type' => [value],
            'custom_something' => ['array_item','array_item']
        } 
```

对于术语，即使它只是一项，您也总是需要将值放入数组中。希望它有所帮助。

# mysql - 为什么 Mysql 不在带有索引列的 INNER JOIN 表上使用索引？

> ID：15033655
> 
> 赞同：2
> 
> 时间：2013-02-22T21:40:03.323
> 
> 标签：mysql, join, database-performance

首先，我有以下表结构。

```
Table Document
     ## DocID ## ##DocName ##
         1          Doc1
         2          Doc2
         3          Doc3 
Table FolderTree
     ## FolderID ##  ## MemberDocID ##
          1                1
          1                2
          1                3 
```

我有关于 DocID、FolderID 和 MemberDocID 的索引

我有以下查询。

```
 SELECT DISTINCT d.* FROM Document d inner join FolderTree f on (d.DocID = f.MemberDocID ) where f.FolderID = 1 
```

解释输出：

```
| select type | table | type | possible_keys | key       | rows    |   extra         |

   simple        d     All     PRIMARY        NULL          83168    Using temporary
   simple        f     ref     MemberDocID    MemberDocID   11       Using index 
```

我的问题是，为什么 mysql 在我有 DocID 索引的表 d 上使用表扫描？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:44:08.023

这是因为您在 Document 表中的所有列上都选择了 DISTINCT。DocName 上没有索引，因此无法优化对不同值的搜索。

# batch-file - 将文件类型从子目录复制到一个文件夹中，重命名文件，这样它们就不会被覆盖

> ID：15033659
> 
> 赞同：3
> 
> 时间：2013-02-22T21:40:24.210
> 
> 标签：batch-file, batch-processing, batch-rename

我想从子目录复制一种文件类型，将副本放入一个文件夹，重命名它们，以免它们被覆盖。重命名它但保留文件扩展名。我不在乎它被重命名为什么，只要每个副本都有一个唯一的名称，这样它们就不会被覆盖。

这是我现在的代码。它做了我想做的一切，除了它覆盖同名的文件：

代码：

```
set dSource=C:\Users\P Ditty\Documents\SH3\data\cfg\Careers
set dTarget=C:\Users\P Ditty\Documents\SH3\data\cfg\Backups_SCR
set fType=*.clg
for /f "delims=" %%f in ('dir /a-d /b /s "%dSource%\%fType%"') do (
copy  /v "%%f" "%dTarget%\" 2>nul
) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:09:15.590

通过保留原始目录结构来避免重复问题：

```
set dSource=C:\Users\P Ditty\Documents\SH3\data\cfg\Careers
set dTarget=C:\Users\P Ditty\Documents\SH3\data\cfg\Backups_SCR
set fType=*.clg

xcopy/s/i "%dSource%\%fType%" "%dTarget%" 
```

# wcf - Azure - 多个角色实例陷入“等待状态”

> ID：15033669
> 
> 赞同：0
> 
> 时间：2013-02-22T21:41:03.520
> 
> 标签：wcf, azure, azure-web-roles

我遇到了许多拒绝离开“等待状态”状态的角色实例的问题。这与用户在[这里](https://stackoverflow.com/questions/7058987/azure-deployment-problem-one-instance-of-an-azure-role-starts-the-other-is-wa)遇到的问题相同。

我的 Azure 订阅来自 BizSpark，因此我无法提交支持票来解决此问题（假设它与坏节点的问题相同）。

据推测，虽然我的订阅来自 BizSpark，但我仍然有权使用功能性服务。有人可以帮我想出一个自我补救办法或联系支持的方式吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:50:32.787

目前有几个 Azure 服务出现问题，请先检查这里：

[http://www.windowsazure.com/en-us/support/service-dashboard/](http://www.windowsazure.com/en-us/support/service-dashboard/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:49:51.473

我认为拥有基于 Bizspark 的订阅不会将您排除在购买支持之外。[支持计划](http://www.windowsazure.com/en-us/support/plans/)应该有适合您需求的内容。允许您提交支持票（通过网络）的最便宜的计划是每月 29 美元。我建议您至少花 29 美元购买 Bizspark，这样您就可以关注您的问题。

# c# - 如何查询 DynomoDB 并将键值对作为字符串返回

> ID：15033670
> 
> 赞同：0
> 
> 时间：2013-02-22T21:41:09.260
> 
> 标签：c#, logging, amazon-dynamodb

我正在尝试查询我使用 Amazon 文档中的代码创建的 DynamoDB，并进行了一些简单的修改。我正在尝试获取我获得的数据并将其作为字符串写入日志文件。但我似乎能得到的是：

2013-02-22 20:21:37.9268|跟踪|[System.Collections.Generic.Dictionary `2+KeyCollection[System.String,Amazon.DynamoDB.Model.AttributeValue] System.Collections.Generic.Dictionary`2+ValueCollection[System.String,Amazon.DynamoDB.Model.AttributeValue]]|

我尝试了一些不同的东西，但都返回相同的东西，或者非常相似的东西。

我正在使用的代码：

```
 private static void GetCallsForRange()
  {
     AmazonDynamoDBConfig config = new AmazonDynamoDBConfig();
     config.ServiceURL = "http://dynamodb.us-west-2.amazonaws.com";
     AmazonDynamoDBClient client = new AmazonDynamoDBClient(config);

     DateTime startDate = DateTime.Today.AddDays(-21);
     string start = startDate.ToString("G", DateTimeFormatInfo.InvariantInfo);

     DateTime endDate = DateTime.Today;
     string end = endDate.ToString("G", DateTimeFormatInfo.InvariantInfo);

     QueryRequest request = new QueryRequest
     {
        TableName = "Inquiry",
        HashKeyValue = new AttributeValue { S = "+15555555555" },
        RangeKeyCondition = new Condition
        {
           ComparisonOperator = "BETWEEN",
           AttributeValueList = new List<AttributeValue>()
           {
              new AttributeValue { S = start },
              new AttributeValue { S = end }
           }
        }
     };

     QueryResponse response = client.Query(request);
     QueryResult result = response.QueryResult;

     foreach (Dictionary<string, AttributeValue> item in response.QueryResult.Items)
     {
        string logMsg = String.Format("[{0} {1}]", item.Keys, item.Values);
        Logging.LogTrace(logMsg);
     }

  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T23:50:23.697

您将需要遍历`response.QueryResult.Items`. 您可以像这样重写循环（取自 Amazon DynamoDB 文档）：

```
foreach (Dictionary<string, AttributeValue> item in response.QueryResult.Items) 
{
     LogItem(item);
}
private void LogItem(Dictionary<string, AttributeValue> attributeList)
{
     foreach (KeyValuePair<string, AttributeValue> kvp in attributeList)
     {
          string attributeName = kvp.Key;
          AttributeValue value = kvp.Value;
          string logValue = 
               (value.S == null ? "" : value.S) +
               (value.N == null ? "" : value.N.ToString()) +
               (value.B == null ? "" : value.B.ToString()) +
               (value.SS == null ? "" : string.Join(",", value.SS.ToArray())) +
               (value.NS == null ? "" : string.Join(",", value.NS.ToArray())) +
               (value.BS == null ? "" : string.Join(",", value.BS.ToArray()));
          string logMsg = string.Format("[{0} {1}]", attributeName, logValue);
          Logging.LogTrace(logMsg);
     }
} 
```

本质上，您需要发现`AttributeValue`(String, Number, Binary, StringSet, NumberSet, BinarySet) 的“类型”，然后将其输出到您的日志中。

我希望这会有所帮助！

# linux - 检索 Windows 和 Linux 的硬件信息

> ID：15033680
> 
> 赞同：1
> 
> 时间：2013-02-22T21:41:37.310
> 
> 标签：linux, windows, hardware, serial-number

我有一台双启动（Ubuntu 和 Win7）机器，我需要检索一些硬件信息。在这第一刻，我将列出以下内容：

1.  处理器 ID 或序列号；
2.  主板序列号；
3.  硬盘序列号；
4.  显卡序列号。

有没有办法使用本机程序（非下载程序）从两个操作系统中获取具有相同数据的这些信息？

PS：我正在使用 Java 进行开发，因此可以接受任何命令行或其他库。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T01:43:57.733

对于 Windows 7，您可以在 PowerShell 中使用[WMIC](http://technet.microsoft.com/en-us/library/bb742610.aspx)和[Get-WmiObject](http://technet.microsoft.com/en-us/library/ee176860.aspx)来获取处理器和 GPU 序列号，例如，

```
> Get-WmiObject Win32_Processor
> WMIC PATH Win32_VideoController GET Description,PNPDeviceID 
```

另请参阅[此线程](https://superuser.com/questions/469216/is-it-possible-to-get-the-serial-number-of-a-gpu-without-opening-the-case)。

# scheme - 无法识别为字符串的哈希表键

> ID：15033682
> 
> 赞同：1
> 
> 时间：2013-02-22T21:41:43.033
> 
> 标签：scheme, key, hashtable

Scheme 的`eqv-hashtable`数据结构似乎无法识别字符串键。在以下代码中，我正在创建一个`eqv-hashtable`并创建一个新数据：

```
(define state-hash (make-eqv-hashtable))
(hashtable-set! state-hash "S" (State "S" #f '() '())) 
```

但是，当我尝试检查我的数据是否存储在哈希表中时，我遇到以下情况：

```
(hashtable-contains? state-hash "S")  ; --> #f 
```

尽管该`hashtable-contains?`过程显示密钥`"S"`当前不在哈希表中，但以下建议并非如此：

```
(hashtable-keys state-hash)   ; --> #("S") 
```

如果我使用非字符串作为键，例如符号（例如`'S`），我没有任何问题。任何想法为什么它不喜欢字符串作为键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T22:05:10.497

`eqv?``#t`仅当其参数引用完全相同的对象时才返回。试试这个：

```
(define key "S")
(define state-hash (make-eqv-hashtable))
(hashtable-set! state-hash key (State "S" #f '() '()))
(hashtable-contains? state-hash key) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:03:12.873

你试过了`make-equal-hashtable`吗？我对这些没有太多经验，但我知道

```
(define str "S")
(eqv? str "S") => #f
(equal? str "S") => #t 
```

[http://www.gnu.org/software/mit-scheme/documentation/mit-scheme-ref/Equivalence-Predicates.html#Equivalence-Predicates](http://www.gnu.org/software/mit-scheme/documentation/mit-scheme-ref/Equivalence-Predicates.html#Equivalence-Predicates)

编辑：奥斯卡有一个很好的解决方案

# python - 使用可变 C 数组从 C 线程调用 Python 函数

> ID：15033683
> 
> 赞同：3
> 
> 时间：2013-02-22T21:41:53.017
> 
> 标签：python, cpython

我正在为一个用 C++ 编写的小型音频库创建 Python 扩展。打开音频流时，回调函数作为参数传递（当然还有其他参数）。一个稍微简化的用例：

```
AudioThingy *a = new AudioThingy();
a->openStream(..., callbackFunction);
a->startStream(); 
```

我的 Python 扩展将它封装在一个 Python 类中。

```
thingy = AudioThingy()
thingy.openStream(..., pythonCallbackFunction)
thingy.startStream() 
```

现在，扩展有一个作为 C 函数的回调，它传递给 C++ 库。对于每个流滴答，回调接收有关流的一些信息以及指向音频缓冲区的空指针，回调根据流格式参数将其转换为正确的数据类型。我的意图当然是让这个用 C 实现的回调函数以某种数组作为参数调用用户指定的 Python 函数，然后填充来自例如用 Python 打开的 wav 文件的音频数据。

这就是我想要做的，在代码中：

```
static int __audiothingy_callback(void *buffer, ...) {
  PyGILState_STATE state = PyGILState_Ensure();
  /*
      cast the void pointer to the correct data type (short, int, long, etc.)
      wrap it for Python somehow
  */
  PyEval_CallObject(the_python_function, arglist);
  PyGILState_Release(state);
  //proceed to fill the buffer with stuff passed back from python
  for (...)
    *casted_buffer++ = ????
  Py_DECREF(arglist);
  return 0;
} 
```

TL;DR：如何在线程中将正确类型的可变数组从 C 传递给 Python 函数，然后该函数可用于填充音频缓冲区？也许它可以用不同于我上面描述的方式来完成？欢迎所有输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T01:05:03.020

我认为你可以做几件事。如果您使用的是 Python 2.7，您可以使用新的缓冲区协议创建一个 memoryview 对象：

*   [新的缓冲协议，Py_buffer](http://docs.python.org/2/c-api/buffer.html#the-new-style-py-buffer-struct)

然后，您需要从缓冲区创建一个 memoryview 对象：

*   [PyMemoryView_FromBuffer](http://docs.python.org/2/c-api/buffer.html#PyMemoryView_FromBuffer)

另一种策略是导入数组模块，并使用它来创建所需类型的数组。你用：

*   [PyImport_ImportModule](http://docs.python.org/2/c-api/import.html#PyImport_ImportModule)
*   [PyModule_GetDict](http://docs.python.org/2/c-api/module.html#PyModule_GetDict)
*   PyObject* array_type = [PyDict_GetItemString](http://docs.python.org/2/c-api/dict.html#PyDict_GetItemString) (dict, "array");

然后，根据需要的[类型](http://docs.python.org/2/library/array.html)构造数组：

```
PyObject *array = PyObject_CallFunction(array_type, "c", 'd'); 
```

更简单的是，您可以只使用一个 bytearray 对象：

*   [PyByteArray_FromStringAndSize](http://docs.python.org/2/c-api/bytearray.html#PyByteArray_FromStringAndSize)构造一个字节数组，如果你可以构造一些东西，你不需要担心数组元素的大小。

# node.js - 无法使用nodejs连接到数据库

> ID：15033687
> 
> 赞同：0
> 
> 时间：2013-02-22T21:42:22.587
> 
> 标签：node.js, mongodb, express

我对nodejs非常陌生，无法弄清楚这里到底发生了什么-我有一个基本的登录页面，当用户输入值时，我会转到主页，在此之前我会检查数据库是否存在该用户名。我遇到的问题是，当我单击提交按钮时，代码似乎永远不会到达数据库功能。
这是我在 app.js 中的模块 -

```
app.post('/home',function(req,res){
        //check for user existence....
        var str;
        console.log("in home");
        user_login.perform_login(req.body.username,function(err,str){
            if(!err){
                console.log(str+" in login");
                var cookie_val=req.body.username;
                res.cookie('username',cookie_val,{signed: true});
                req.session.username=cookie_val;
                res.render('home.ejs',{
                    layout: false,
                    locals: {varname: cookie_val},
                    udata: req.session.username
                });
            }
            else{   
                console.log("Couldn't find it.");
                res.redirect("/login");
            }
        });
}); 
```

这是来自 user_login.js- 的 perform_login

```
var mongo_db=require("./testdb.js");
exports.perform_login=function (username,callback){
    mongo_db.getInfo(username,function(err,bundle){
        if(!err){
            //console.log("success\n"+bundle);
            callback(false,bundle);
        }
        else{
            //console.log("couldn't find it");
            callback(true,null);
        }
    });
} 
```

这是 testdb.js-

```
var mongoose=require('mongoose');
mongoose.connect('mongodb://localhost/test');
exports.getInfo=function(value,callback){
    var db=mongoose.connection;
    db.on('error',console.error.bind(console,'connection error:'));
    db.once('open',function(){
        console.log("Connected!");
        var userSchema=mongoose.Schema({
            username:       String,
            password:   String
        });
        var userInstances=mongoose.model('userInstances',userSchema);
        userInstances.findOne({username: value},'username password',function(err,ui){
                                if(!err){
                                    callback(false,ui);
                                }
                                else{
                                    callback(true,"error");
                                }
                            });//findone

    });//db.once function
}//getinfo 
```

在终端中，我只得到-“在家中”，之后什么也没有发生。在浏览器中，它似乎正在处理，但仍保留在登录页面中。
当我使用实际的硬编码值而不是 req.body.username 运行 perform_login 时，立即启动 app.js，我得到了正确的结果。所以我能够在 app.post() 之外以某种方式访问​​数据库。
回调有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:33:58.793

我认为你在这里做的有点太多了。根据我的经验，您描述的症状来自未连接的猫鼬。如果已连接，则无需管理连接和侦听事件。Mongoose 会为您处理这个问题。您可以查询一个模型，它会在建立连接后立即返回结果。

这是一个应该有效的示例：

```
app.js
//initialize mongo connection
var mongooseConnection = mongoose.connect("mongodb://localhost/test");

user.js
var mongoose = require('mongoose');
var userSchema=mongoose.Schema({
    username:       String,
    password:   String
});

userSchema.statics.performLogin = function(username, callback) {
    this.findOne({username: value},'username password',function(err,user){
    if(!err){
        callback(false,user);
    }
    else{
        callback(true,"error");
    }
});

module.exports = mongoose.model('users',userSchema);

route:
var User = require("./user");
app.post('/home',function(req,res){
    User.performLogin(req.body.username, function (err, user) {
        ...
    });
}); 
```

# ios - 向 __weak 对象发送消息？

> ID：15033691
> 
> 赞同：14
> 
> 时间：2013-02-22T21:42:36.967
> 
> 标签：ios, automatic-ref-counting

如果我向弱对象发送消息会发生什么？发送消息是否拥有对象并将其保存在内存中直到返回？

我正在考虑这种模式：

```
__weak MyObject *weakSelf = self;
dispatch_async(dispatch_get_main_queue(), ^{
    [weakSelf doSomeAction];
}); 
```

假设`weakSelf`在发送消息时为非零，它可能在`doSomeAction`工作时被释放还是保证在`doSomeAction`返回之前保持有效？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-22T21:47:59.250

来自[Clang ARC 文档](http://clang.llvm.org/docs/AutomaticReferenceCounting.html#semantics)：

> *对对象左值执行左值到右值转换时会发生***读取。****
> 
>  **   对于`__weak`对象，当前指针被保留，然后在当前完整表达式结束时释放。这必须针对分配和指针的最终版本自动执行。*

 *向弱引用发送消息会对变量执行左值到右值的转换，这意味着弱引用的值将被保留，然后在当前完整表达式（基本上是语句）结束时释放。它基本上相当于分配给一个强变量，其范围仅持续当前语句，然后消息传递该强变量。

这里的要点是，如果您想向一个弱变量发送一次消息，并且永远不会再触摸它，并且您不关心在弱引用结束的情况下评估方法参数的副作用`nil`，然后去提前并直接向弱引用发送消息。但是，如果您需要两次引用弱引用（在单独的语句中），或者评估参数的副作用确实很重要，那么您应该分配给一个强变量并`nil`在继续之前测试 non-。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T03:53:59.743

您问：

> 假设在发送消息时`weakSelf`是 non- `nil`，它可能在`doSomeAction`工作时被释放还是保证在`doSomeAction`返回之前保持有效？

这种 ARC 行为随着时间的推移而发生了变化。但是现在，`weak`只要删除最后一个强引用，就可以释放引用。

因此，请考虑以下事项：

```
- (void)dealloc {
    NSLog(@"%s", __FUNCTION__);
}

- (void)startBackgroundOperation {
    __weak typeof(self) weakSelf = self;

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        [weakSelf doSomeAction];
        [NSThread sleepForTimeInterval:5];
        [weakSelf doSomeAction2];
    });
}

- (void)doSomeAction {
    NSLog(@"%s", __FUNCTION__);
}

- (void)doSomeAction2 {
    NSLog(@"%s", __FUNCTION__);
} 
```

如果您有一些代码调用并让对象在and`startBackgroundOperation`之间的中间时间被释放，您会看到前者将被调用而后者不会。即，如果没有更多的强引用，则可以在块的中间释放对象。`doSomeAction``doSomeAction2`

所以，如果你想要弱引用，但想要一种“全有或全无”的行为，在闭包期间保留它，我们执行被戏称为“<code>weakSelf- `strongSelf`dance”的操作：

```
- (void)startBackgroundOperation {
    __weak typeof(self) weakSelf = self;

     dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        typeof(self) strongSelf = weakSelf;        // establish just-in-time strong reference (if `weakSelf` is not yet `nil`)

        [strongSelf doSomeAction];
        [NSThread sleepForTimeInterval:5];
        [strongSelf doSomeAction2];
    });
} 
```

这将确保该块有一个`weak`引用，但如果它在分配 时没有被释放`strongSelf`，那么它将在该块的持续时间内建立并维护一个强引用。

* * *

对于它的价值，这种`weakSelf`-`strongSelf`模式在取消引用 ivars 时必不可少`->`（避免使用 的竞争条件`weakSelf`）。

例如

```
- (void)badDeferenceExample {
    __weak typeof(self) weakSelf = self;

     dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        if (!weakSelf) { return; }

        NSInteger value = weakSelf->_someIVar;     // this is race and can crash!!!

        ...
    });
}

- (void)properDeferenceExample {
    __weak typeof(self) weakSelf = self;

     dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        typeof(self) strongSelf = weakSelf;        // establish just-in-time strong reference (if `weakSelf` is not yet `nil`)

        if (!strongSelf) { return; }

        NSInteger value = strongSelf->_someIVar;   // this is safe

        ...
    });
} 
```*

# ios - 切换通话到扬声器 - iOS 私有 api

> ID：15033695
> 
> 赞同：1
> 
> 时间：2013-02-22T21:42:53.863
> 
> 标签：ios, objective-c, iphone-privateapi, cydia

我试图弄清楚如何将当前呼叫切换为通过扬声器输出音频（就好像该人要在电话应用程序上按“扬声器”一样。理想情况下，我想接受扬声器上的呼叫；但是一步一次！

我已经搜索了各种标题，包括私有和非私有框架，但我找不到合适的方法来调用以切换到扬声器。

最初，我预计它会出现在 CTCall.h 中，但那里没有任何有用的东西（在这方面）..

有谁知道在哪里找到合适的方法？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T22:30:22.347

几个想法：

1）查看系统范围的事件生成。您可以以编程方式单击所需按钮（“扬声器”或“应答”按钮）。这里有几个关于这个的问题：

[在 iOS 上模拟系统范围的触摸事件](https://stackoverflow.com/questions/9221086/simulating-system-wide-touch-events-on-ios)

[在不越狱设备的情况下在 iOS 中模拟系统范围的触摸事件](https://stackoverflow.com/questions/13415669/simulating-system-wide-touch-events-in-ios-without-jailbreaking-the-device)

[如何向 iPhone OS 发送触摸事件？](https://stackoverflow.com/questions/1746452/how-to-send-a-touch-event-to-iphone-os/10515571#10515571)

您可能有兴趣在 GSEvent 上搜索更多内容，这是模拟的关键。

2）转到模拟器文件夹（/Application/XCode/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.1.sdk

做这样的事情

grep -R "演讲者" ./

这个想法是在二进制文件（与头文件）中搜索扬声器。大多数私有 API 没有记录在头文件中（这是它们私有的部分原因）。

我相信几个有趣的热门歌曲是：

*   **TelephoneUI**私有框架
*   **AudioToolbox**框架（顺便说一句。它甚至在 .h 文件中包含以下内容：kAudioSessionOverrrideAudioRoute_Speaker）
*   **AVFoundation**框架
*   **IOKit***框架（它在 .h 文件中有 kIOAudioOutputPortSubTypeExternalSpeaker）

等等。

下一步将是拆卸它们。这些框架中的大多数都有很多有趣的 API，这些 API 没有在 .h 文件中定义。浏览它们以检查您是否会发现有关此主题的任何有趣内容，这很有用。

如果您不想打扰反汇编，可以从此处获取提取的标头： [https ://github.com/nst/iOS-Runtime-Headers/tree/master/PrivateFrameworks](https://github.com/nst/iOS-Runtime-Headers/tree/master/PrivateFrameworks)

# c# - 如何用替换而不是混合来绘制

> ID：15033697
> 
> 赞同：0
> 
> 时间：2013-02-22T21:43:09.150
> 
> 标签：c#, .net, graphics, gdi+, alphablending

我正在尝试在位图上“绘制”透明区域 - 就像在图像中切割孔一样。

以下代码不会绘制透明线，因为在位图上绘制透明线当然是混合而不是替换。（为什么默认是做两个绘图操作中更复杂的，没有意义。）

```
Bitmap myBitmap = new Bitmap(50, 50);
Graphics g = Graphics.FromImage(myBitmap);
g.FillRectangle(Brushes.Black, 0, 0, 50, 50);
g.FillEllipse(Brushes.Transparent, 25, 0, 25, 25); //Does nothing
g.DrawLine(Pens.Transparent, 0, 0, 50, 50); //Does nothing 
```

我将如何修改它以使透明的圆圈和线条替换位图中的内容而不是混合？

（请注意，这是“绘制”完全透明的小例子。我要达到的目的是能够“绘制”修改 Alpha 通道，而无需创建我自己的逐个像素操作。能够做到完全透明将不过就够了。）

* * *

在建议重复的文章中的答案之后，我还尝试了以下方法（不起作用）

```
 base.OnPaint(e);
        Bitmap myBitmap = new Bitmap(50, 50);
        e.Graphics.FillRectangle(Brushes.Black, 0, 0, 50, 50);
        Graphics g = Graphics.FromImage(myBitmap);
        g.FillEllipse(new SolidBrush(Color.FromArgb(150, 125, 125, 125)), 25, 0, 25, 25);
        g.DrawLine(new Pen(Color.FromArgb(150,25,25,25)), 0, 0, 50, 50);
        g.CompositingMode = System.Drawing.Drawing2D.CompositingMode.SourceOver;
        e.Graphics.CompositingMode = System.Drawing.Drawing2D.CompositingMode.SourceOver;
        e.Graphics.DrawImage(myBitmap, 0, 0); 
```

还测试了这个`SourceCopy`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:53:06.997

这对我来说完全没问题

```
Bitmap bmp = new Bitmap(50, 50, System.Drawing.Imaging.PixelFormat.Format32bppPArgb);
using (Graphics g = Graphics.FromImage(bmp))
{
    g.CompositingMode = System.Drawing.Drawing2D.CompositingMode.SourceCopy;
    g.FillRectangle(Brushes.Black, 0, 0, 50, 50);
    g.FillEllipse(Brushes.Transparent, 25, 0, 25, 25);
    g.DrawLine(Pens.Transparent, 0, 0, 50, 50);
    g.Flush();
}
bmp.Save("Test.bmp"); 
```

# android - 无法从 SimpleCursorAdapter 中的 DB 加载游标，因为没有这样的列：_id

> ID：15033699
> 
> 赞同：0
> 
> 时间：2013-02-22T21:43:35.070
> 
> 标签：android, simplecursoradapter

我正在尝试从具有表（带有 _id 字段）的数据库中检索游标，但无法创建 simplecursoradapter 错误说

```
 SqlliteException: no such column: _id 
```

但是我的数据库类有什么问题：

```
//The columns we'll include in the dictionary table
public static final String COLUMN_ID = "_id";
public static final String COL_WORD = "WORD";
public static final String COL_DEFINITION = "DEFINITION";

private static final String FTS_TABLE_CREATE =
                "CREATE VIRTUAL TABLE " + FTS_VIRTUAL_TABLE +
                " USING fts3 (" + COLUMN_ID + " integer primary key autoincrement, " +
                COL_WORD + ", " +
                COL_DEFINITION + ")"; 
```

并返回光标

```
public Cursor getWordMatches(String query, String[] columns) {
    String selection = COL_WORD + " MATCH ?";
    String[] selectionArgs = new String[] {query+"*"};

    return query(selection, selectionArgs, columns);
}

private Cursor query(String selection, String[] selectionArgs, String[] columns) {
    SQLiteQueryBuilder builder = new SQLiteQueryBuilder();
    builder.setTables(FTS_VIRTUAL_TABLE);

    String[] col = new String[] {COLUMN_ID, COL_WORD};
    //ubacio null - col
    Cursor cursor = builder.query(mDatabaseOpenHelper.getReadableDatabase(),
            col, selection, selectionArgs, null, null, null);

    if (cursor == null) {
        return null;
    } else if (!cursor.moveToFirst()) {
        cursor.close();
        return null;
    }
    return cursor;
} 
```

这是我显示 ListView 的活动

```
 //query the db class method getWordMatches()
      Cursor c = db.getWordMatches(query, null);
          displayWords(c);

      }
    }

public void displayWords(Cursor c){

    // Creates a new SimpleCursorAdapter
    SimpleCursorAdapter mCursorAdapter = new SimpleCursorAdapter(
        getApplicationContext(),                    // The application's Context object
        android.R.layout.simple_list_item_1,        // A layout in XML for one row in the ListView
        c,                                          // The result from the query
        new String[] {DatabaseTable.COL_WORD},      // A string array of column names in the cursor
        new int[] { android.R.id.text1 });          // An integer array of view IDs in the row layout

    // Sets the adapter for the ListView
    setListAdapter(mCursorAdapter);

} 
```

该教程来自[http://developer.android.com/training/search/search.html](http://developer.android.com/training/search/search.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:49:01.123

您需要使用别名将 FTS' 更改`rowid`为 Android 的`_id`：

```
String[] col = new String[] {"rowid as " + COLUMN_ID, COL_WORD}; 
```

FTS 不允许您覆盖主键的默认列名，因为`"integer primary key autoincrement"`它被完全忽略为[“语法糖”](https://www.sqlite.org/fts3.html#section_1_2)。事实上，FTS 只是将您的`_id`列解释为通用列......

所以你应该`_id`从你的 create-table 语句中删除，否则它会添加一个额外的`_id`列：

```
private static final String FTS_TABLE_CREATE =
            "CREATE VIRTUAL TABLE " + FTS_VIRTUAL_TABLE +
            " USING fts3 (" + COL_WORD + ", " + COL_DEFINITION + ")"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:27:24.150

作为 CursorAdpater 类的要求，基础 Cursor 对象必须包含名为“_id”的列，这就是您收到该错误的原因。这直接来自 CursorAdapter 文档：http: [//developer.android.com/reference/android/widget/CursorAdapter.html](http://developer.android.com/reference/android/widget/CursorAdapter.html)

# php - 我究竟做错了什么

> ID：15033715
> 
> 赞同：-4
> 
> 时间：2013-02-22T21:44:41.553
> 
> 标签：php, explode, server-variables

我已经为此苦苦挣扎了一两个星期了，我似乎无法解决它。这是我的脚本：

```
<?php
$Domain = $_SERVER['SERVER_NAME'];
$paryDomain = explode(".",$Domain);
$Array = count($paryDomain);
$RootDomain = "";
$G_SYSTEMID = "";

if ($Array == "1")
{
    $RootDomain = $paryDomain[0].'.'.$paryDomain[1];
}    
elseif ($Array == "2")
{
    $RootDomain = $paryDomain[1].'.'.$paryDomain[2];
}

if ($RootDomain == "storeboard.com")
{
    $G_SYSTEMID = 1;
}
elseif ($RootDomain == "dcwn.org")
{
    $G_SYSTEMID = 2;
}

echo $G_SYSTEMID;
echo "------------";

?> 
```

为什么我在 1 或 2.. 的末尾都没有得到任何结果？

任何帮助将不胜感激。

新杰基

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:51:40.503

```
if ($Array == 1)
{
    $RootDomain = $paryDomain[0]; 
}    
elseif ($Array == 2)
{
    $RootDomain = $paryDomain[0].'.'.$paryDomain[1];
}    
elseif ($Array == 3)
{
    $RootDomain = $paryDomain[1].'.'.$paryDomain[2];
} else {
    //to debug the possible cause 
    $G_SYSTEMID = 'Array length was equal to '.$Array;
    $RootDomain = false;
} 
```

您的数组计数与您使用的指针不匹配，这应该会有所帮助。您还在检查字符串而不是整数...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:53:42.377

```
$Array = count($paryDomain);
if ($Array == "1")
{
    $RootDomain = $paryDomain[0].'.'.$paryDomain[1];
} 
```

如果`$Array`包含一个元素`$paryDomain[1]`则不存在，或者该数组必须只包含一个元素。

对于谁说 $Array 是整数：

```
$Array = 1;
var_dump(($Array == "1"));
var_dump(($Array == "2"));

bool(true) 

bool(false) 
```

什么是错是：您的服务器名称（如果有）（（www.）？example.com）：

```
if ($Array == "1")
{
    $RootDomain = $paryDomain[0].'.'.$paryDomain[1];
}    
elseif ($Array == "2")
{
    $RootDomain = $paryDomain[1].'.'.$paryDomain[2];
} 
```

因为 `$paryDomain = explode(".",$Domain);`至少包含两个元素，那么，$Array 永远不会等于一个，只有在一种情况下，当 SERVER_NAME 是一个单词时！

解决方案：

```
if ($Array == "2")
{
    $RootDomain = $paryDomain[0].'.'.$paryDomain[1];
}    
elseif ($Array == "3")
{
    $RootDomain = $paryDomain[1].'.'.$paryDomain[2];
}else{

}

if ($RootDomain == "storeboard.com")
{
    $G_SYSTEMID = 1;
}
elseif ($RootDomain == "dcwn.org")
{
    $G_SYSTEMID = 2;
}else{
//in case when none of above cases true
    $G_SYSTEMID = 100;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T22:19:28.967

只是想向您展示一种更简单的方法。它将支持具有无限子域的域，因为它总是抓住最后两个部分：

```
if (strpos($_SERVER['SERVER_NAME'], ".") !== false) {
    preg_match('/(?P<domain>[a-z0-9][a-z0-9\-]{1,63}\.[a-z]+)$/i', $_SERVER['SERVER_NAME'], $item);
    $RootDomain = $item['domain'];
} else {
    $RootDomain = $_SERVER['SERVER_NAME'];
}

switch ($RootDomain)
{
    case 'storeboard.com':
        $G_SYSTEMID = 1;
        break;
    case 'dcwn.org':
        $G_SYSTEMID = 2;
        break;
    default:
        $G_SYSTEMID = '';
        break;
}

echo $G_SYSTEMID; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T22:09:11.427

首先回显您的 $Domain

```
echo $_SERVER['SERVER_NAME']; 
```

然后 print_r 你的 $paryDomain

```
print_r($paryDomain); 
```

如果这些是正确的，请回显您的 count()

```
echo count(explode(".",$_SERVER['SERVER_NAME'])); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-22T21:53:42.240

```
$G_SYSTEMID = strstr($_SERVER['SERVER_NAME'], 'storeboard.com') ? 1 : 2; 
```

# documentation - 如何在 LuaForWindows 中使用 LuaDoc

> ID：15033719
> 
> 赞同：2
> 
> 时间：2013-02-22T21:45:19.717
> 
> 标签：documentation, lua, documentation-generation, luadoc

问题都在标题中：如何将 LuaDoc 与 LuaForWindows 一起使用？

在我的 Lua 安装中，我有一个 luadoc_start.bat，但命令窗口一打开就关闭。从那里我不知道我还能做什么。

有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T23:11:33.537

`luadoc`在**Lua For Windows**中使用，命令如下：

```
luadoc_start.bat path\to\lua\file\name.lua 
```

这将在命令提示符窗口或 powershell 中完成。

> 我得到了一个正确生成的 doc 文件，**但是如何为整个项目做**呢？我知道有一个 -d 参数，但我不确定如何使用它，我的尝试都没有成功。

对于此任务，您需要编写一个 shell 脚本。这是一个小的[powershell](/questions/tagged/powershell "显示标记为“powershell”的问题")脚本。

```
$files = Get-ChildItem .\
foreach( $file in $files ) {
    luadoc_start.bat "$file"
} 
```

在哪里，您必须到`cd`目录`path\to\lua\file`并运行此`PS1`文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:49:29.353

只需附加`pause`行`luadoc_start.bat`，您将看到帮助屏幕。

# java - 如何保持扫描仪类打开以输入实例的新值

> ID：15033720
> 
> 赞同：0
> 
> 时间：2013-02-22T21:45:23.547
> 
> 标签：java

我有一个任务来创建一个 Circle 类，它使用半径创建一个圆，然后使用 get 来查找面积、直径等。

分配的下一步是“继续使用开始时创建的扫描仪对象，要求用户输入另一个半径值。” 起初我尝试复制+粘贴代码以询问用户半径并像我最初所做的那样分配给局部变量，我收到以下错误：“从未使用过分配的值。” 分配还说要更改圆实例的值，而不是创建一个新圆并为其分配不同的值。

我做了一些搜索，但不确定如何进行。

我的 circle.java 类的代码：

```
public class Circle {

    // intialize variable radius
    private double radius;
    // create constant PI
    public final static double PI = 3.14159;

    // Circle constructtor
    public Circle(double r) {
        radius = r;
    }

    // setRadius method
    public void setRadius(double r) {
        radius = r;
    }

    // getRaduis method
    public double getRadius() {
        return radius;
    }

    // getArea method
    public double getArea() {
        double area = PI * radius * radius;
        return area;
    }

    // getDiameter method
    public double getDiameter() {
        double diameter = 2 * radius;
        return diameter;
    }

    // getCircumference method
    public double getCircumference() {
        double circumference = 2 * PI * radius;
        return circumference;
    }

} 
```

我的程序 circleTest 的代码：

```
package circle;

import java.util.Scanner;
public class CircleTest {

    public static void main(String[] args) {
        double circleRadius;
        double radius;

        // import scanner
        Scanner keyboard = new Scanner(System.in);

        // ask user for raduis and store in a local variable
        System.out.print("What is the radius of the circle?");
        circleRadius = keyboard.nextDouble();

        // Create a circle object called circle1
        Circle circle1 = new Circle(circleRadius);

        // display area using getArea method for circle1
        System.out.println("The area of the circle is " + circle1.getArea());

        // display diameter for circle1 using getDiameter method
        System.out.println("The diamter of a the circle is "
                + circle1.getDiameter());

        // display the circumference of circle1 using getCircumference
        System.out.println("The circumference of a circle is "
                + circle1.getCircumference());

        // ask user for radius and store in a local variable
        System.out.print("What is the radius of the circle?");
        circleRadius = keyboard.nextDouble();

    }
} 
```

# ios - Monotouch 导入联系人 - 返回类型问题

> ID：15033727
> 
> 赞同：1
> 
> 时间：2013-02-22T21:46:01.770
> 
> 标签：ios, xamarin.ios

如果他们被选中，我试图让这个方法返回一个人。我的问题是我收到一条错误消息，指出委托不能返回`void`令人讨厌的类型，因为我不希望此方法返回，除非发生这两个操作之一。有什么建议么？

```
public static ABPerson ImportContact ()
        {
            // Create placeholder for contact
            ABPeoplePickerNavigationController _contactController = new ABPeoplePickerNavigationController ();
            AppDelegate.navigation.PresentViewController (_contactController, true, null);

            _contactController.Cancelled += delegate {
                AppDelegate.navigation.DismissViewController (true, null);
                return;
            };

            _contactController.SelectPerson += delegate(object sender, ABPeoplePickerSelectPersonEventArgs e) {
                _importedContact = e.Person.GetEmails().FirstOrDefault;
                AppDelegate.navigation.DismissViewController (true, delegate {
                    return e.Person;
                });
            };
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:26:07.357

您正在尝试在内部委托方法中返回函数结果。不可能实现。尝试改用公共事件。IE。：

```
 public event Action<ABPerson> OnPersonSelect;
    public void ImportContact ()
    {
        // Create placeholder for contact
        ABPeoplePickerNavigationController _contactController = new ABPeoplePickerNavigationController ();
        NavigationController.PresentViewController (_contactController, true, null);

        _contactController.Cancelled += delegate {
            NavigationController.DismissViewController (true, null);
            return;
        };

        _contactController.SelectPerson += delegate(object sender, ABPeoplePickerSelectPersonEventArgs e) {
            var _importedContact = e.Person;
            NavigationController.DismissViewController (true, delegate {
                if (OnPersonSelect != null)
                {
                    OnPersonSelect(_importedContact);
                }
            });
        };
    } 
```

请注意，我将此方法标记为非静态，以便在我自己的测试样本中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T00:21:39.263

这就是我为解决它所做的：

```
 private static void ImportContact ()
        {
            if (_contactController == null)
                _contactController = new ABPeoplePickerNavigationController ();
            AppDelegate.navigation.PresentViewController (_contactController, true, null);

            _contactController.Cancelled += delegate {
                if (!AppDelegate.navigation.PresentedViewController.IsBeingPresented)
                    AppDelegate.navigation.DismissViewController (true, null);
                return;
            };

            _contactController.SelectPerson += delegate(object sender, ABPeoplePickerSelectPersonEventArgs e) {
                if (!AppDelegate.navigation.PresentedViewController.IsBeingPresented) {
                    AppDelegate.navigation.DismissViewController (true, delegate { 
                        MapImportedContact (e.Person);
                    });
                }
                return;
            };
        } 
```

在我映射字段之后，我调用了一个方法

```
PopulateClientFields (Client mappedClient) 
```

该方法将所有的设置`EntryElements`为传入的值，然后重新加载视图：

```
clientsView.ReloadData (); 
```

像魅力一样工作。对不起，我实际上并没有早点发布这个。

# ruby - 将 Perl 字符串替换移植到 Ruby？

> ID：15033734
> 
> 赞同：2
> 
> 时间：2013-02-22T21:46:18.897
> 
> 标签：ruby, regex, string-substitution

我试图弄清楚在将 Perl 脚本移植到 Ruby 的过程中如何进行字符串替换。

这是 Perl 行。我试图找出 Ruby 的等价物：

```
$historyURL =~ s/COMPONENT_NAME/$componentName/g; 
```

对于那些可能了解 Ruby 但不了解 Perl 的人来说，这一行基本上用变量`$historyVariable`的值替换了 中的字符串“COMPONENT_NAME”。`$componentName`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T21:51:42.030

等价的很简单：

```
history_url.gsub!(/COMPONENT_NAME/, component_name) 
```

该`gsub!`方法用第二个参数替换给定模式的*所有*实例，并将结果存储在原始变量中，因为它是一个就地修饰符。`gsub`通过比较返回修改后的副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:05:43.450

- 方法的`gsub`好处是它不需要正则表达式，它适用于字符串（或指向字符串的变量）：

```
history_url = "some random text COMPONENT_NAME random text COMPONENT_NAME"
component_name = "lemonade"
p history_url.gsub("COMPONENT_NAME", component_name) # no regex
#=> "some random text lemonade random text lemonade" 
```

# php - MODX不发送电子邮件

> ID：15033736
> 
> 赞同：0
> 
> 时间：2013-02-22T21:46:32.683
> 
> 标签：php, email, modx-revolution

我正在使用 modMail 类发送自定义电子邮件。我遵循了 MODX 网站上的指南，并使用了我放在片段中的以下代码：

```
$message = $modx->getChunk('myEmailTemplate');

$modx->getService('mail', 'mail.modPHPMailer');
$modx->mail->set(modMail::MAIL_BODY,$message);
$modx->mail->set(modMail::MAIL_FROM,'me@example.org');
$modx->mail->set(modMail::MAIL_FROM_NAME,'Johnny Tester');
$modx->mail->set(modMail::MAIL_SUBJECT,'Check out my new email template!');
$modx->mail->address('to','user@example.com');
$modx->mail->address('reply-to','me@xexample.org');
$modx->mail->setHTML(true);
if (!$modx->mail->send()) {
    $modx->log(modX::LOG_LEVEL_ERROR,'An error occurred while trying to send the email: '.$modx->mail->mailer->ErrorInfo);
}
$modx->mail->reset(); 
```

该片段已被修改以包含来自自定义块的消息，并且电子邮件地址已替换为正确的地址。该片段发送了一次电子邮件，并且再也没有发送过。我不知道是什么导致了这种阻​​止它发送电子邮件的行为。

我已经读到使用重置功能会`$modx->mail->reset();`重置电子邮件字段并允许再次发送电子邮件，但我觉得这会导致问题。

该片段在页面上被称为未缓存`[[!email]]`

有谁知道为什么电子邮件没有被发送，即使它工作过一次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:48:50.527

如果你的块或处理你的块有错误，modx 永远不会到达它记录错误的地步。尝试类似：

```
if (!$modx->mail->send()) {
    $modx->log(modX::LOG_LEVEL_ERROR,'An error occurred while trying to send the email: '.$modx->mail->mailer->ErrorInfo);
}else{
 $modx->log(modX::LOG_LEVEL_ERROR,'This mail was sent: '.$message);
} 
```

看看它是否记录了一些东西。但除此之外，您所拥有的完全正确 - 尝试取出 $message 变量并仅发送一个字符串。如果它发送了一次邮件，那么肯定有其他问题。我会开始查看邮件服务器日志、标头、垃圾邮件 [gmail??] 等。

# java - 如何导出已包含外部 jar 的 java 项目

> ID：15033738
> 
> 赞同：0
> 
> 时间：2013-02-22T21:46:43.233
> 
> 标签：java, eclipse, dll, jar

我使用 eclipse 创建了一个 java 项目，在该项目中我包含了一些 jar 文件，例如 sqljdbc4.jar、jtds-1.2.4.jar 和 log4j-1.2.17.jar。我还在这个项目中包含了一个用于 Windows 身份验证的 dll。我正在尝试将此项目导出为 .zip .tar 等，以便该项目稍后可以由其他人导入并使用该项目。

我想以其他开发人员可以导入项目并立即开始工作而无需下载项目所依赖的 jar 文件的方式导出文件。这有可能吗

我已经尝试过我认为可以导出的方法 -> 存档文件 -> 以 .zip 格式保存。我没有成功，我还想去属性-> 订单和导出选项卡，然后选择所需的罐子，然后导出仍然不成功。

一旦其他开发人员导入项目，罐子就不适合他了......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T19:04:46.680

以下内容有很多变化，但基本思想是使用代码库并共享项目。存储库可以是您本地的，甚至更好地将其放在 http 服务器上（ala VisualSVN 或 google 等）。

第一个（本地）解决方案：

```
Install SVN ( http://subversion.apache.org/ )
Install SubVersion
Create a repo on your local file system
Share the project
Dump the repo 
Send the repo
Load the repo (Other developer) 
```

第二（网络）解决方案（使用谷歌代码作为您的库）

```
Install SVN ( http://subversion.apache.org/ )
Install SubVersion
Put your project on GoogleCode (http://code.google.com/)
Other developer gets project 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T01:52:14.527

我会用蚂蚁。它直接集成到 eclipse 中，并采用一个名为 .xml 的文件`build.xml`。它通过在 xml 文件中指定“目标”来工作，每个目标都执行一些操作，例如“构建”（即运行`javac`）、“部署”（即运行`jar`命令）等。可以从`jar`目标中调用一个命令调用`zipgroupfileset`它，您可以使用它来打包主 jar 文件中的所有 jar。

更多关于蚂蚁的信息可以在[这里找到](http://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.platform.doc.user%2FgettingStarted%2Fqs-81_basics.htm "蚂蚁资讯")

# scala - :+= 方法为 scala.collection.immutable.Vector 定义了什么？

> ID：15033743
> 
> 赞同：10
> 
> 时间：2013-02-22T21:47:05.510
> 
> 标签：scala

给定以下scala代码：

```
var v1 = Vector("foo")
v1 :+= "" 
```

做什么`:+=`，它与它有什么不同`+=`以及它在哪里定义？

谢谢！

PS：是的，我确实搜索过这个，但没有找到任何东西。通过这个（[http://simply.liftweb.net/index-2.3.html#prev](http://simply.liftweb.net/index-2.3.html#prev)）教程找到了。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-22T22:04:57.047

Scala 序列具有三个运算符，它们通过向旧序列添加一些内容来生成新序列`++`：`+:`和`:+`. `++`运算符只是将 Scala 序列与另一个（或可遍历的）序列连接起来。另外两个分别前置和附加元素。

`+:`和的特殊语法`:+`是由于它们的使用方式。任何以结尾的运算符`:`都适用于*右侧*的对象，而不是左侧的对象。那是：

```
1 +: Seq.empty == Seq.empty.+:(1) 
```

通过对称性，另一个运算符是`:+`，尽管在这种情况下冒号是没有意义的。这使您可以编写如下内容：

```
scala> 1 +: 2 +: 3 +: Seq.empty :+ 4 :+ 5 :+ 6
res2: Seq[Int] = List(1, 2, 3, 4, 5, 6) 
```

注意被添加的元素是如何在表达式中出现的完全相同的位置结束的。这使得可视化正在发生的事情变得更容易。

现在，你有`:+=`，不是以上任何一个。碰巧的是，Scala 允许将任何运算符与`=`组成一个 get-and-set 操作连接起来。所以常见的增量表达式：

```
x += 1 
```

其实意味着

```
x = x + 1 
```

同样地，

```
v1 :+= "" 
```

方法

```
v1 = v1 :+ "" 
```

which creates a new vector by appending the empty string to the old vector, and then assigns it to `v1`.

# c - 读取、填充结构数组并将其写入二进制文件

> ID：15033749
> 
> 赞同：1
> 
> 时间：2013-02-22T21:47:24.977
> 
> 标签：c, binaryfiles

我正在为班级创建一个 EMPLOYEE 记录文件的这个程序。我创建了两个结构。一个叫员工，一个叫约会。EMPLOYEE 结构有一个 char 数组、一个 int、6 个浮点值和 DATE（另一个结构）。DATE 结构只有三个 int 值（月、日、年）。

我创建了一个名为 person[1000] 的 EMPLOYEE 类型的数组。

这是我的代码，我在 Visual Studio 中不断收到调试断言失败错误，指向 fwrite.c Expression: (Stream !=NULL)。我确信这与我的 fread 或 fwite 有关，因为我从未尝试过存储结构。

这个函数的开始点是如果文件存在且不为空则填充数组，因此当用户开始将数据存储到数组时，下标会更新。我知道这里可能还有其他一些问题，但首先是阅读和写作部分。

再次感谢，

麦克风

```
void loadPayRoll(EMPLOYEE person[], int *i) 
{
    char sValidate[5] = "exit";
    FILE *f;
    int count = 0;

    f = fopen("emplyeeRecords.bin", "rb");
    if(f){
        while(fread(&person[*i], sizeof(person), 1, f) > 0){
            (*i)++;
        }
        fclose(f);
    }
    else {

        while (strcmp( sValidate, person[*i].name)) {

            fopen("employeeRecords.bin", "ab+");
            printf("Please enter name or type exit to return to main menu: ");
            scanf("%s", person[*i].name);         //must use the '->' when passing by by refrence, must use '&' sign
            flush;

            if (!strcmp( sValidate, person[*i].name))
                break;

            printf("\nPlease enter age of %s: ", person[*i].name);
            scanf("%i", &person[*i].age);
            flush;
            printf("\nPlease enter the hourlyWage for %s: ", person[*i].name);
            scanf("%f", &person[*i].hourlyWage);
            flush;
            printf("\nPlease enter the hours worked for %s: ", person[*i].name);
            scanf("%f", &person[*i].hoursWkd);

            if (person[*i].hoursWkd > 40) {
                person[*i].regPay = person[*i].hoursWkd * 40;
                person[*i].otHoursWkd = person[*i].hoursWkd - 40;
                person[*i].otPay = person[*i].otHoursWkd * (person[*i].hourlyWage * 1.5);
                person[*i].totalPay = person[*i].regPay + person[*i].otPay;
            }
            else {
                person[*i].totalPay = person[*i].hoursWkd * person[*i].hourlyWage;
            }
            flush;
            printf("\nEnter 2 digit month: ");
            scanf("%i", &person[*i].payDate.month);   //must use the '->' when passing by by refrence, must use '&' sign
            flush;
            printf("\nEnter 2 digit day: ");
            scanf("%i", &person[*i].payDate.day);  //must use the '->' when passing by by refrence, must use '&' sign
            flush;
            printf("\nEnter 4 digit year: ");
            scanf("%i", &person[*i].payDate.year);   //must use the '->' when passing by by refrence, must use '&' sign 
            flush;
            fwrite(&person[*i], sizeof(person), 1, f);
            fclose(f);
            (*i)++;
        }
    }
}//end function loadPayRoll 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:53:05.450

我很确定：

```
fopen("employeeRecords.bin", "ab+"); 
```

孤独地坐在一行上而不分配结果`FILE*`与您的问题有很大关系。还有很多其他问题，例如：

```
flush; 
```

不太确定那是怎么回事。也许你的意思是：

```
fflush(f); 
```

假设`f`曾经正确分配过，

正如评论中指出的那样，您应该在循环开始*之前*打开文件，然后根据需要写入数据，在循环结束后关闭它。

# apache - mod_rewrite 保持锚链接

> ID：15033757
> 
> 赞同：0
> 
> 时间：2013-02-22T21:47:49.567
> 
> 标签：apache, mod-rewrite, anchor

我想`example.com/site/about#whoami`被重定向到`example.com/site/?page=about#whoami`使用 mod_rewrite 指令，但我不知道该怎么做

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T22:13:50.747

注意：`#`可以传递锚字符，但它对替换 URL 没有影响，除非重定向到存在锚的页面。尽管 Apache 不能将窗口向下滚动到锚点，但在这种情况下浏览器会这样做。这是一些[关于重定向锚点的 Apache 信息](https://httpd.apache.org/docs/2.0/rewrite/rewrite_guide.html#redirectanchors)

你可以尝试这样的事情：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^site/(.*)/?   site?page=$1  [NC,NE,L] 
```

地图

`http://example.com/site/anything`

到

`http://example.com/site/?page=anything`

假定字符串`site`是固定的。

字符串`anything`可能包含一个锚点`#`，它将在替换 URL 中传递。

# windows - 为另一个用户运行 Windows 应用程序

> ID：15033760
> 
> 赞同：2
> 
> 时间：2013-02-22T21:48:07.623
> 
> 标签：windows, shell, powershell, administrator, runas

我想在另一个用户的上下文中运行一个 Windows 应用程序。我在一台机器上有一个管理员和几个用户帐户，我想让管理员为每个用户帐户启动某些应用程序（最好使用 shell 命令）。

我尝试了 runas 命令，但它似乎以指定用户身份在管理员会话中运行。我想在用户上下文中将应用程序作为用户会话运行（希望这是有道理的）。

例如，使用用户管理员我想启动 notepad.exe 以便 user1（登录）可以看到它出现在屏幕上。那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:56:57.977

您可以为此使用 PsExec：[http ://technet.microsoft.com/en-us/sysinternals/bb897553.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)

与参数一起使用：-i 运行程序，以便它与远程系统上指定会话的桌面交互。如果未指定会话，则进程在控制台会话中运行。

前任。这将在其他计算机上启动 IE psexec \client -i "c:\program files\internet explorer\iexplore.exe"

/勒内

# c# - 从另一个 DataTable 更新 DataTable 列

> ID：15033761
> 
> 赞同：1
> 
> 时间：2013-02-22T21:48:19.893
> 
> 标签：c#, .net, datatable, dataset, updates

使用 .NET 4 C#，我有一个 DataSet，其中包含从导入的 csv 文件生成的两个 DataTables，这些文件是从表单注册数据创建的。一个包含记录 ID 和时间戳。另一种是产品注册列表（名称、地址等），有对应的记录ID（约10000条记录）

如何将第一个数据表中的时间戳插入到与正确记录 ID 匹配的第二个数据表中？我可以将 DataAdapter 附加到现有 DataSet 并以这种方式查询它们吗？我希望我可以在我的第二个数据表中添加一个时间戳列并从第一个数据表中更新它。

我知道这没有意义（为什么在导出表单数据时不包括时间戳？）。我正在使用 Joomla 表单模块进行注册，并且导出不包括时间戳。从数据库中，我可以导出匹配的时间戳和记录 ID 数据，但是数据库结构将记录字段拆分为单独的表，我无法弄清楚如何将整个记录重新合并为可用内容，所以我m 坚持使用两个 csv 显示同一记录的数据）。

任何朝着正确方向的轻推都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:00:41.143

试试这个：

将新列添加到第二个数据表

```
DataColumn dc = new DataColumn("DateCol", typeof(System.DateTime));
dt2.Columns.Add(dc); 
```

现在使用第一个数据表更新第二个数据表中的这个 datecol 列

```
dt2.AsEnumerable().Join(  dt1.AsEnumerable(),
       dt2Rows => dt2Rows.ItemArray["record_id"],
       dt1Rows => dt1Rows.ItemArray["record_id"],
       (dt2Rows, dt1Rows) => new { dt2Rows, dt1Rows })
 .ToList()
 .ForEach(i => i.dt2Rows.SetField("DateCol", i.dt1Rows.ItemArray["DateCol"])); 
```

要使用上述 linq 查询，您必须在类文件中导入[Systems.Linq命名空间](http://msdn.microsoft.com/en-us/library/system.linq.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:00:51.457

您当然可以自己迭代所有记录并匹配它们。但是您也可以在数据集中的 DataTables 之间建立关系，然后在 records 数据表中创建一个计算列，以提取父列的值。请参阅此示例： http: [//windowsdevcenter.com/dotnet/2003/05/26/datacolumn_expressions.html](http://windowsdevcenter.com/dotnet/2003/05/26/datacolumn_expressions.html)

请参阅这篇关于如何实际添加关系的文章：http: [//msdn.microsoft.com/en-us/library/ay82azad%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/ay82azad%28v=vs.71%29.aspx)

走向底部：

> Parent.ColumnName 父表中的列

因此，在创建关系后，您将执行以下操作：`ds["Table2"].Columns.Add("Timestamp", typeof(DateTime), "Parent.Timestamp")`

# objective-c - CALayer 和浮动位置列表

> ID：15033762
> 
> 赞同：0
> 
> 时间：2013-02-22T21:48:32.070
> 
> 标签：objective-c, macos, calayer

我需要创建一个行为类似于将`UISegmentControl`子层列表显示为超级层的控件。这些子层的数量可以改变，我必须计算它们的位置。

这里的问题...如果我采用宽度等于 31 的超级层并且我想在其中放置 4 个子层，我应该创建 4 个子层，每个宽度为 31/4 = 7.75。所以第一层的 origin.x = 0，第二层的 origin.x = 7.75，第三层的 15.5 和最后的 23.25。

显然这些位置是无效的，它们会产生模糊的层......我找不到一种方法来舍入这个值，能够填充整个超级层并保持宽度和 origin.x 的整数值，有人有解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:58:38.627

您可以使用精确值计算所有原点，然后将它们四舍五入到最接近的整数。然后通过简单地减去两个相邻的原点（或从最终子层的原点减去父级的总宽度）来计算所有宽度。这将生成完全覆盖您的父级的图层，具有整数坐标，但某些图层将比其他图层宽 1 个像素。

# ios - 检查日期是否在范围之间

> ID：15033769
> 
> 赞同：1
> 
> 时间：2013-02-22T21:49:19.097
> 
> 标签：ios, objective-c

我有一个使用 UICollectionView 的自定义日历设置，并且我有一个将日期保存到 30 天的数组。我想要做的是找出一个值是否在当前日期和它之前的 7 天之间。如果是我需要它做某事。我无法弄清楚我做错了什么。这是我到目前为止所拥有的：

```
 NSDateFormatter *df = [NSDateFormatter new];
    [df setDateFormat:@"MM-dd-yy"];
    NSdate *date = [NSDate date];
    NSDate *newCurrentDate = [date dateByAddingTimeInterval:+14*24*60*60];
    NSDate *sevenDaysBeforeCurrent = [date dateByAddingTimeInterval:-7*24*60*60];

    if([[df stringFromDate:[days objectAtIndex:indexPath.item]] compare:[df stringFromDate:newCurrentDate]] == NSOrderedAscending && [[df stringFromDate:[days objectAtIndex:indexPath.item]] compare:[df stringFromDate:sevenDaysBeforeCurrent]] == NSOrderedDescending )
    {

            UIImage *buttonImage = [UIImage imageNamed:@"dates.png"];
            [myButton setBackgroundImage:buttonImage forState:UIControlStateNormal];

    } 
```

它的作用是更改 newCurrentDate 之前的每个日期的图像，而不仅仅是前 7 个。任何人都可以看到我做错了什么吗？

下面是数组的初始化：

```
myDays = [[NSMutableArray alloc] init];
    NSCalendar *cal = [NSCalendar autoupdatingCurrentCalendar];
    NSDate *today = [NSDate date];
    date = [NSDate date];

    for (int i = 0; i < 31; i++)
    {
        NSDateComponents *comps = [[NSDateComponents alloc]init];
        [comps setDay:i];
        [myDays addObject:[cal dateByAddingComponents:comps toDate:today options:0]];
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T22:33:06.490

您不需要使用 dateFormatter。

```
if([dateInQuestion compare:newCurrentDate] == NSOrderedAscending && [dateInQuestion compare:sevenDaysBeforeCurrent] == NSOrderedDescending){
    // do something
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:13:09.127

尝试以下方式：

```
NSDate *currentDate = [NSDate date];
NSDate *dateSevenDaysPrior = [currentDate dateByAddingTimeInterval:-(7 * 24 * 60 * 60)];
NSDate *someDate = [currentDate dateByAddingTimeInterval:-(3 * 24 * 60 * 60)]; // adjust as you like

if (([dateSevenDaysPrior compare:someDate] != NSOrderedDescending) &&
    ([someDate compare:currentDate] != NSOrderedDescending))
{
    NSLog(@"date is in range");
}
else
{
    NSLog(@"date is not in range");
} 
```

这假设你提供的（`someDate`在这个例子中代表什么）真的是 NSDate 的一个实例。

# php - 使用 PHP 将一些数据保存到会话中并通过 post 将表单提交给 WorldPay

> ID：15033771
> 
> 赞同：0
> 
> 时间：2013-02-22T21:49:27.580
> 
> 标签：php, worldpay

我有以下表格，我想提交给 WorldPay。不过，在提交之前，我想使用 PHP 将一些变量保存到会话中。如果可能的话，我不喜欢使用 jQuery 或 Ajax。

提前致谢。

```
<form action="https://secure-test.worldpay.com/wcc/purchase" name="buyform" id="buyform" method="post"> 
  <input type="hidden" name="instId"  value="123456">
  <input type="hidden" name="cartId" value="abc123">
  <input type="hidden" name="currency" value="GBP">
  <input type="hidden" name="hideCurrency">
  <input type="hidden" name="amount"  value="10">
  <input type="hidden" name="desc" value="">
  <input type="hidden" name="testMode" value="100">
  <input type="hidden" name="lang" value="en-GB">
  <input type="hidden" name="noLanguageMenu">
  <input type="hidden" name="hideContact">

  <input type="hidden" name="fixContact">
  <input type="hidden" name="name" value="AUTHORISED">
  <input type="hidden" name="address1" value="4 The Street">
  <input type="hidden" name="address2" value="My Suburb">
  <input type="hidden" name="address3" value="">
  <input type="hidden" name="town" value="my town">
  <input type="hidden" name="region" value="region or county">
  <input type="hidden" name="postcode" value="AB10 5AB">
  <input type="hidden" name="country" value="GB">
  <input type="hidden" name="tel" value="0123456789">
  <input type="hidden" name="email" value="demo@worldpay.com">
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:57:14.623

确保`session_start()`在发送任何标头之前首先运行。然后在会话中输入一个值就像这样简单：

```
$_SESSION['instId'] = $_POST['instId'] 
```

对每个表单值执行此操作，只要该会话有效，它将被保存并可以访问会话数组。

**您需要首先将您的表单指向您自己的脚本才能使其正常工作。**

之后，您可以使用`curl`发送帖子数据来发送请求，`https://secure-test.worldpay.com/wcc/purchase`如下所示：

```
//set POST variables
$url = 'https://secure-test.worldpay.com/wcc/purchase';
$fields = array(
    'instId' => urlencode($_POST['instId']),
    ... other fields
);

$postVars = http_build_query($fields);

$ch = curl_init();
curl_setopt($ch,CURLOPT_URL, $url);
curl_setopt($ch,CURLOPT_POST, count($fields));
curl_setopt($ch,CURLOPT_POSTFIELDS, $postVars);

$result = curl_exec($ch);
curl_close($ch); 
```

# html - 绝对定位链接上方的 Internet Explorer 文本

> ID：15033782
> 
> 赞同：1
> 
> 时间：2013-02-22T21:50:04.220
> 
> 标签：html, css, internet-explorer, anchor

我创建了一个包含可点击文本的框列表，但是 IE 将文本设置在链接上方，因此当将鼠标悬停在文本上时，它会优先考虑它使链接不再起作用。Chrome + Firefox 按预期工作。

如果可能的话，我还想看看是否可以在不使用 javascript 或 jQuery 的情况下进行修复。我还需要它来支持 IE8+。

这是[jsfiddle](http://jsfiddle.net/X5T5H/2/)。

HTML：

```
<!DOCTYPE html>
<html>

    <body>
        <ul class="container">
            <li class="optionBox"> <i class="reporting"></i>
    <a href="#">Lorem ipsum dolor sit amet.</a>

                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur lobortis
                    tortor egestas massa dignissim eu auctor turpis rutrum. Morbi suscipit
                    dictum lacinia.</p>
              </li>
                <li class="optionBox"> <i class="reporting"></i>
    <a href="#">Lorem ipsum dolor sit amet.</a>

                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur lobortis
                        tortor egestas massa dignissim eu auctor turpis rutrum. Morbi suscipit
                        dictum lacinia.</p>
                </li>
                <li class="optionBox"> <i class="reporting"></i>
    <a href="#">Lorem ipsum dolor sit amet.</a>

                    <p>CLorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur lobortis
                        tortor egestas massa dignissim eu auctor turpis rutrum. Morbi suscipit
                        dictum lacinia.</p>
                </li>
                <li class="optionBox"> <i class="reporting"></i>
    <a href="#">Lorem ipsum dolor sit amet.</a>

                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur lobortis
                        tortor egestas massa dignissim eu auctor turpis rutrum. Morbi suscipit
                        dictum lacinia.</p>
                </li>
                <li class="optionBox"> <i class="reporting"></i>
    <a href="#">Lorem ipsum dolor sit amet.</a>

                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur lobortis
                        tortor egestas massa dignissim eu auctor turpis rutrum. Morbi suscipit
                        dictum lacinia.</p>
                </li>
                <li class="optionBox"> <i class="reporting"></i>
    <a href="#">Lorem ipsum dolor sit amet.</a>

                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur lobortis
                        tortor egestas massa dignissim eu auctor turpis rutrum. Morbi suscipit
                        dictum lacinia.</p>
                </li>
                <li class="optionBox"> <i class="reporting"></i>
    <a href="#">Lorem ipsum dolor sit amet.</a>

                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur lobortis
                        tortor egestas massa dignissim eu auctor turpis rutrum. Morbi suscipit
                        dictum lacinia.</p>
                </li>
                <li class="optionBox"> <i class="reporting"></i>
    <a href="#">Lorem ipsum dolor sit amet.</a>

                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur lobortis
                        tortor egestas massa dignissim eu auctor turpis rutrum. Morbi suscipit
                        dictum lacinia.</p>
                </li>
        </ul>
    </body>

</html> 
```

CSS：

```
.container {
    overflow: hidden;
    width: 1000px;
    list-style: none;
    margin: 15px;
    padding: 0;
}
.optionBox {
    float: left;
    overflow: hidden;
    width: 400px;
    height: 125px;
    cursor: pointer;
    margin: 0.3em;
    padding: 0.5em 0.5em 2em 0.5em;
    color: #555;
    background: transparent;
    border: solid 1px #DDD;
    -webkit-box-shadow: 0 0 4px rgba(0, 0, 0, .1);
    -moz-box-shadow: 0 0 4px rgba(0, 0, 0, .1);
    box-shadow: 0 0 4px rgba(0, 0, 0, .1);
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}
.reporting {
    position: absolute;
    background:url('http://s13.postimage.org/w73u674ur/icon.png') no-repeat;
    float: left;
    width:30px;
    height:30px;
}
a {
    position: absolute;
    width: 340px;
    height: 115px;
    font-size: 1.2em;
    padding-left: 3.8em;
    color: #08C;
    text-decoration: none;
}
a:hover{
    text-decoration:underline;
}
p {
    font-size: 1.2em;
    margin: 1.6em 0 0 3.8em;
}
body {
    font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    line-height: 20px;
    color: #333;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T22:24:43.297

这是 IE 中带有绝对定位锚元素的错误。

最常见的解决方法是为锚设置背景。但是，由于您显然不希望链接隐藏其下方的文本，因此您需要设置透明背景图像。为了做到这一点，我通常更喜欢将背景设置为将用作无效图像的现有路径。

例如：

```
a {
    position:absolute;
    /* ... */
    background:url('about:blank');
} 
```

参见**[jsFiddle 演示](http://jsfiddle.net/X5T5H/6/)**

或者，您也可以创建一个实际的透明图像并将其设置为背景。

# java - 如何在球体周围“包裹”方形图像

> ID：15033784
> 
> 赞同：0
> 
> 时间：2013-02-22T21:50:09.390
> 
> 标签：java, image

这可能听起来很奇怪，但我会尽力解释我想要做什么。所以我有一个正方形 (128x128) 图像，我想重新缩放它，就好像它被映射到一个半径为 64 的球体上一样，所以如果我有一个只是一个网格的图像，它会在缩放完成后看起来像这样： http: [//www.cartographersguild.com/attachments/virtual-tabletop-battlemap-mapping/42871d1331205337-representing-sphere-battlemap-sphere7.jpg](http://www.cartographersguild.com/attachments/virtual-tabletop-battlemap-mapping/42871d1331205337-representing-sphere-battlemap-sphere7.jpg)。我浏览了网络，但是对于各种球面映射的术语实在太多了，以至于让我不知所措，我想选择最好的选择。我所看到的大部分似乎都与 3D 球体有关，但我只对 2D 操作感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:53:18.277

首先，你不需要一个矩形来包裹一个球体吗？长度应该是球面的直径。

# delphi - 排序的 TStringList 错误 - 排序列表上不允许操作

> ID：15033785
> 
> 赞同：3
> 
> 时间：2013-02-22T21:50:12.137
> 
> 标签：delphi, delphi-2010

我收到以下错误 - “排序列表上不允许操作”

```
Idx:= Customers.IndexOfName(ListView1.Selected.Caption);
Customers[idx]:= Edit1.Text + '=' + Edit2.Text + ',' + Edit3.Text //error occurs here 
```

有没有办法解决？除了编写我自己的例程来获取索引值

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T21:57:44.310

编写自己的例程来*获取*索引值显然无济于事，因为这不是问题所在。您不能直接修改排序列表的元素，因为这样做可能会使排序顺序无效。

从列表中删除项目并插入新项目。

```
Customers.Delete(idx);
Customers.Add(Edit1.Text + '=' + Edit2.Text + ',' + Edit3.Text); 
```

或者，设置`Sorted := False`.

# visual-studio-2010 - VsVim 设置保存文件

> ID：15033789
> 
> 赞同：18
> 
> 时间：2013-02-22T21:50:49.203
> 
> 标签：visual-studio-2010, vim, settings, vsvim

我有 VsVim，当我加载我的解决方案文件时，我总是需要 :set ignorecase 和 :set smartcase 每次。我想保存这些设置，但我找不到 VsVim 存储其设置的位置或如何保存其设置。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-22T22:03:02.670

这最近发生了变化：

*   [https://github.com/jaredpar/VsVim/wiki/faq](https://github.com/jaredpar/VsVim/wiki/faq)

> 如何验证我的 .vimrc 正在加载？
> 
> 有 2 个非标准 vim 设置可用于诊断潜在的 .vimrc 加载问题
> 
> *   vimrc – 此设置将显示为 .vimrc 加载的文件的完整路径
> *   vimrcpaths – 此设置将显示搜索到 .vimrc 的文件和路径
> 
> 默认情况下，VsVim 将在路径 HOME、VIM 和 USERPROFILE 中查找名为 .vsvimrc、_vsvimrc、.vimrc 或 _vimrc 的文件
> 
> 到目前为止，.vimrc 文件中支持的命令仅限于命令模式中支持的命令。

# google-places-api - 为什么 Google Places API 不返回隔壁的位置？

> ID：15033795
> 
> 赞同：1
> 
> 时间：2013-02-22T21:51:22.490
> 
> 标签：google-places-api, google-places

我正在使用 Google Places API 搜索汉堡王。我为任何名称中带有“Burger”的地方创建一个查询，查询我工作的位置。

结果中没有汉堡王，但隔壁有一家汉堡王。

我如何报告这个位置（如果我在 google.com 上搜索“我附近的汉堡”很容易出现）？是否有什么我做错了导致搜索结果遗漏了汉堡王？

补充说明：

*   我在不同的位置运行相同的代码，它似乎在那里找到了汉堡王。
*   结果集包含 20 个带有单词“Burger”的合法位置。
*   写完这篇文章后，我将尝试寻找“King”，并会回来确认它只是一些 20 帽可能会阻碍结果。
*   汉堡王是[两个字](https://stackoverflow.com/questions/14405271/google-places-nearby-search-doesnt-return-correct-place-when-criteria-is-2-word)，所以也许这就是问题所在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:31:42.310

在较小的区域内搜索。

这是由于一个区域中的结果过多而产生的效果。您可以在洛杉矶或西雅图的星巴克尝试此操作，并找到相同的行为。

如果返回的结果集大于 20 上限，那么您将丢失任何超出该上限的结果。这可以包括“隔壁位置”。

我们现在正在做的是搜索结果集小于 20 的较小区域，以确保我们获得准确的结果。通过在较小的区域中搜索（以获得较小的结果集），我可以看到隔壁的汉堡王。

# google-apps-script - 尝试在 ScriptDb 中存储数组时出错

> ID：15033802
> 
> 赞同：1
> 
> 时间：2013-02-22T21:51:45.940
> 
> 标签：google-apps-script

我有一个由我的脚本创建的对象数组，我试图将该数组复制到一个新数组中，然后使用以下函数将其存储在 scriptDb 中：

```
function copyAndStore (currentArray) {
  var db = ScriptDb.getMyDb();
  var copyArray = [];
  for (var i in currentArray) {
    copyArray.push(currentArray[i]);
  }
  var id = db.save(copyArray);
  return id;
} 
```

它正确复制了所有内容，但是当它到达时，`var id = db.save(copyArray);`我得到了错误：`Invalid argument. Expected a javascript map object.`

ScriptDb 是否存在存储数组的问题？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T00:37:32.817

正如@Thomas 所说，您可以将数组保存在地图对象中。

在将对象放入 ScriptDB 之前，您也不需要执行复制操作。您可以简单地保存数组`db.save({myArray})`，并记住 ID。

这是一些要演示的极简代码。我展示了两种检索您保存的数组的方法 - 一种通过 ID，这似乎是您计划的方式，但也是使用“键”值进行查询的第二种方式。如果您希望在以后的代码运行中检索 ScriptDB 的内容，则这种方法无需以某种方式记住存储数组的 ID。

```
function saveArray (currentArray) {
  var db = ScriptDb.getMyDb();
  return db.save({type: "savedArray", data:currentArray}).getId();
}

function loadArrayById (id) {
  var db = ScriptDb.getMyDb();
  return db.load(id).data;
}

function loadArrayByType () {
  var db = ScriptDb.getMyDb();
  var result = db.query({type: "savedArray"});
  if (result.hasNext()) {
    return result.next().data;
  }
  else {
    return [];
  }
}

function test() {
  var arr = ['this','is','a','test'];
  var savedId = saveArray( arr );
  var loaded1 = loadArrayById( savedId );
  var loaded2 = loadArrayByType();
  debugger;  // pause if running debugger
} 
```

这是您在调试器暂停时看到的内容：

![调试器截图](../Images/124313b0ccd75d2b6a63a08f2cbef0f2.png)

请注意，通过使用 map 标记`data`从保存的对象中提取数组，两者`loaded1`和`loaded2`都与源数组相同`arr`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:58:39.783

`ScriptDb`只存储地图对象。但是，您可以存储包含数组的地图！

您可以使用数组在一次调用中保存多个对象，使用`db.saveBatch`.

# java - 使用 SnakeYaml 的 yaml

> ID：15033804
> 
> 赞同：0
> 
> 时间：2013-02-22T21:52:01.160
> 
> 标签：java, yaml, snakeyaml

```
---
university: scsb
country: us

Entities:
 !Entity 
   name: john
   subjects:
    -math
    -English
    -C++
 !Entity
   name: mary
   subjects:
    -science
    -French 
```

我正在尝试将上述文件加载到地图中，实体部分下的数据将映射到实体对象的集合。这是一个正确的 yaml 语法，因为我得到 yaml 解析器错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:53:26.587

我在以下方面有更多的运气：

```
---
university: scsb
country: us

Entities: {
 !Entity {
   name: john,
   subjects:
    -math
    -English
    -C++
 },
 !Entity {
   name: mary,
   subjects:
    -science
    -French
 }
} 
```

这是使用 SnakeYAML 的自定义标签 (!dice) 的示例。完整的例子在[这里](https://code.google.com/p/snakeyaml/source/browse/src/test/java/examples/DiceExampleTest.java)。它来自[SnakeYAML 文档](https://code.google.com/p/snakeyaml/wiki/Documentation#Constructors,_representers,_resolvers)。

```
class DiceConstructor extends SafeConstructor {
    public DiceConstructor() {
        this.yamlConstructors.put(new Tag("!dice"), new ConstructDice());
    }

    private class ConstructDice extends AbstractConstruct {
        public Object construct(Node node) {
            String val = (String) constructScalar((ScalarNode) node);
            int position = val.indexOf('d');
            Integer a = new Integer(val.substring(0, position));
            Integer b = new Integer(val.substring(position + 1));
            return new Dice(a, b);
        }
    }
}

@SuppressWarnings("unchecked")
public void testConstructor() {
    Yaml yaml = new Yaml(new DiceConstructor());
    Object data = yaml.load("{initial hit points: !dice '8d4'}");
    Map<String, Dice> map = (Map<String, Dice>) data;
    assertEquals(new Dice(8, 4), map.get("initial hit points"));
} 
```

# java - 在eclipse java web应用程序中引用特定资源的url

> ID：15033805
> 
> 赞同：0
> 
> 时间：2013-02-22T21:52:08.377
> 
> 标签：java, eclipse, jsp, servlets, applet

谁能告诉我如何使用 java servlet 指定特定资源的 url？我正在使用日食。下面的代码生成一个 servlet，其主页可以在 url 中查看：

```
http://www.mysite.com/myapp/thisservlet/ 
```

相反，我希望能够在 url 访问特定的 jsp：

```
http://www.mysite.com/myapp/thisservlet/thishere.jsp 
```

另外，我希望 thishere.jsp 能够在 Eclipse 中调用位于我的应用程序目录结构中其他位置的代码。例如，在我的 eclipse 项目中，thishere.jsp 位于 myapp/web/WEB-INF/web 文件夹中。但是，ThatThereApplet.java 位于包 myapp.myapplets 中，该包位于我的 Eclipse 项目中的路径 myapp/src/myapp.myapplets/ThatThereApplet.java 中。或者，我还将 ThatThereApplet.class 捆绑在 test_applets_1.jar 中，我将其放置在我的 Eclipse 项目的 myapp/web/WEB-INF/lib 文件夹中，然后使用 Eclipse 中的上下文菜单将其添加到我的应用程序的构建路径中.

谁能告诉我如何更改下面的代码，以便它完成我上面描述的操作？

这是 ThisServlet.java 的代码：

```
package myapp.web;
import java.io.IOException;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletConfig;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class ThisServlet extends HttpServlet {

   private RequestDispatcher jsp;

   public void init(ServletConfig config) throws ServletException {
      ServletContext context = config.getServletContext();
      jsp = context.getRequestDispatcher("/WEB-INF/jsp/thishere.jsp");
   }

   protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
   throws ServletException, IOException {
      jsp.forward(req, resp);
   }
} 
```

这是 thishere.jsp 的代码：

```
<html>
<head>
<title>Test Applets Go Here</title>
</head>
<body>
<h1>Gonna put an applet below:</h1>
<applet code="myapp.myapplets.ThatThereApplet.class" archive="test_applets_1.jar" width="500" height="500">
<h1>The applet should be above this line.</h1>
</body>
</html> 
```

这是我封装在 test_applets_1.jar 中并添加到构建路径中的代码：

```
package myapp.myapplets;
import java.applet.*;
import java.awt.*;

public class ThatThereApplet extends Applet {

   int width, height;

   public void init() {
      width = getSize().width;
      height = getSize().height;
      setBackground( Color.black );
   }

   public void paint( Graphics g ) {
      g.setColor( Color.green );
      for ( int i = 0; i < 10; ++i ) {
         g.drawLine( width, height, i * width / 10, 0 );
      }
   }
} 
```

这是 web.xml 的相关部分：

```
<servlet>
    <servlet-name>thisservlet</servlet-name>
    <servlet-class>myapp.web.ThisServlet</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>thisservlet</servlet-name>
    <url-pattern>/thisservlet</url-pattern>
</servlet-mapping> 
```

编辑：

* * *

我遵循了 Sudhakar 的建议并更改了 web.xml 以表明：

```
<url-pattern>/thisservlet/thishere.jsp</url-pattern> 
```

但是，当我在浏览器中加载 thishere.jsp 时，应用程序无法找到小程序的位置，因此即使加载了 thishere.jsp，小程序也不会加载。当我在 Web 浏览器中加载 thatthere.jsp 时，我运行了 Java 控制台，以下是它产生的错误日志：

```
load: class myapp.myapplets.ThatThereApplet.class not found.
java.lang.ClassNotFoundException: myapp.myapplets.ThatThereApplet.class
    at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Exception: java.lang.ClassNotFoundException: myapp.myapplets.ThatThereApplet.class 
```

谁能告诉我如何更改上面的代码，以便应用程序能够找到 ThatThereApplet.class 并将其成功加载到 thishere.jsp 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T05:44:38.587

将`url-pattern`web.xml 中的更改为

```
<servlet-mapping>
    <servlet-name>thisservlet</servlet-name>
    <url-pattern>/thisservlet/thishere.jsp</url-pattern>
</servlet-mapping> 
```

# wpf - 平板电脑输入服务运行时出现 WPF 性能问题

> ID：15033808
> 
> 赞同：2
> 
> 时间：2013-02-22T21:52:55.497
> 
> 标签：wpf, performance

当我们在运行 Tablet PC 输入服务的 Windows 7 平板电脑或 Windows 7 笔记本电脑中部署 WPF (.Net 4.0) 应用程序时，我们所有的 ComboBoxes 和 TextBoxes 都非常缓慢。当我们停止此服务时，一切正常。[我已经找到了一些在之前](http://social.msdn.microsoft.com/Forums/en/windowsaccessibilityandautomation/thread/6c4465e2-207c-4277-a67f-e0f55eff0110)和[这里](http://blogs.msdn.com/b/jgoldb/archive/2010/02/16/wpf-4-and-visual-studio-2010-ui-automation-performance-on-tablets-touch-enabled-machines.aspx)提到过的地方。我还尝试在.Net 4.5 中构建我们的应用程序，并在有问题的机器上安装.Net 4.5 Framework，但没有结果。在台式机和装有 Windows XP 的平板电脑上，该应用程序运行良好。有没有其他人遇到同样的问题？如果是，你如何解决它？

# system.reactive - 要求对响应式扩展 (RX) 进行清晰、生动的解释？

> ID：15033809
> 
> 赞同：14
> 
> 时间：2013-02-22T21:52:57.523
> 
> 标签：system.reactive, reactive-extensions-js

很长一段时间以来，我都在尝试围绕 RX。而且，说实话，我永远不确定我是否得到它 - 或者没有。

今天，我在[http://reactive-extensions.github.com/RxJS/](http://reactive-extensions.github.com/RxJS/)上找到了一个解释——在我看来——这太可怕了。它说：

> RxJS 之于事件就像 Promise 之于异步。

伟大的。这是一个非常复杂的句子，如果你对 RX 是什么一无所知，那么在这句话之后你就和以前一样愚蠢。

这基本上是我的问题：你在通常的地方找到的关于 RX 的所有解释都让（至少我）觉得很愚蠢。他们将 RX 解释为一个高度复杂的概念，其中包含*许多*高度复杂的单词和术语等等，我永远不太确定它是关于什么的。

所以我的问题是：你会如何向五岁的人解释 RX？我想要对它是什么、它有什么用处以及它的主要概念有什么清晰、生动的解释？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-22T23:10:35.467

因此，LINQ（在 JavaScript 中，这些是高级数组方法，如`map`, `filter`,`reduce`等 - 如果您不是 C# 开发人员，只要我提到“LINQ”就替换它）为您提供了一堆可以应用的工具*序列*（粗略意义上的“列表”），用于过滤输入并将其转换为输出（又名“我真正感兴趣的列表”）。但什么是列表？

## 什么是列表？

一个列表，是一些**元素**，以特定的**顺序**。我可以使用 LINQ将任何**列表**转换为*更好的列表。*

（不一定是*排序*顺序，而是顺序）。

## 事件是一个列表

但是事件呢？让我们订阅一个事件：

```
OnKeyUp += (o,e) => Console.WriteLine(e.Key)
>>> 'H'
>>> 'e'
>>> 'l'
>>> 'l'
>>> 'o' 
```

嗯。这看起来像**一些事情**，以**特定的顺序**。现在你突然意识到，**一个列表和一个事件是一回事！**

## 如果列表和事件相同......

...那为什么我不能将输入*事件*转换和过滤成*更有趣的事件*。**这就是 Rx 是什么**。它将您所知道的有关处理序列的所有知识，包括所有 LINQ 运算符（如 Select 和 Where 和 Aggregate），并将它们应用于事件。

十分简单。

## 回调也是一个序列

回调不是基本上只发生一次的事件吗？它基本上不就像一个包含一个项目的列表吗？事实证明是这样，关于 Rx 的一个有趣的事情是，它让我们可以用相同的语言处理事件和回调（以及诸如地理定位请求之类的东西）（即我们可以将两者结合起来，或者等待一个或另一个，等等等等）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-23T02:17:09.203

除了 Paul 的出色回答，我还想添加拉取数据与推送数据的概念。

## 管道

让我们以一些生成一系列数字并输出结果的代码为例。如果您将其视为一端的流，则您有一个`producer`正在为您创建新数字的流，而在另一端您有一个`consumer`正在对这些数字进行操作的流。

## 拉 - 素数列表

可以说`producer`正在生成一个素数列表。通常你会有一些函数产生一个数字列表，每次它返回时，它都会通过管道将它计算的下一个值推送到`consumer`，这会将那个数字输出到屏幕上。

> Prime 生成器 ---> Console.WriteLine

在这种情况下，很容易看出`producer`正在做大部分工作，并且`consumer`会坐等`producer`发送下一个值。`consumer`正在*拉动*管道，等待`producer`返回下一个值。

## Push - 来自快速进程的进度百分比事件（反应式）

好的，假设您有一个处理 1,000,000 个项目的函数。每个项目需要几毫秒的时间来处理，然后该函数会产生一个百分比值，表示它已经走了多远。如此多的进度值，非常快。

在管道的另一端，您有一个进度条。现在，如果进度条要处理每次更新，UI 将阻止尝试跟上值流。

> 100 万个项目处理器 ---> 进度条

在这种情况下，数据被*推送*通过管道，`producer`然后被阻塞，因为*推送*`consumer`了太多数据以使其无法处理。

 *Reactive 允许您根据您希望`consume`数据的方式设置延迟、窗口或对管道进行采样。在这种情况下，我会在更新进度条之前每秒对数据进行一次采样。

## 列表与事件

所以列表和事件有点相同。区别在于数据是通过系统*拉*取还是*推送*。使用列表来*提取*数据。使用事件*推送*数据。*

# matlab - 两个像素之间的距离但属于不同的集合

> ID：15033810
> 
> 赞同：0
> 
> 时间：2013-02-22T21:52:59.323
> 
> 标签：matlab, distance, set, pixels

如何找到`distance`属于两个不同集合的两个像素之间的值？我认为`pdist`除了单个对象之外会这样做吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T23:54:01.297

只需计算欧几里得距离：

```
p1 % a 1x2 vector of the x y position of the first pixel
p2 % a 1x2 vector of the x y position of the second pixel
d = sqrt( ( p1(1)-p2(1) ).^2 + (p1(2)-p2(2)).^2 ); 
```

# php - Readfile 显示内容

> ID：15033816
> 
> 赞同：0
> 
> 时间：2013-02-22T21:53:19.803
> 
> 标签：php, readfile

当我使用以下标题时，IE7 向我显示文件的内容，而不是下载提示。我在谷歌上搜索了al，但没有找到扩展。

```
header('Content-Description: File Transfer');
header('Content-Type: application/force-download');
header('Content-Disposition: attachment; filename=\"Copy van '.basename($file).'\"');
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header("Cache-Control: must-revalidate, post-check=0, pre-check=0"); 
header('Pragma: public');
header('Content-Length: ' . filesize($file));
ob_clean();
flush();
readfile($file);
exit; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T11:15:47.147

当您要发送标头时，请确保它们是脚本的第一个输出。

这不起作用：

```
<html>  //==>output buffer
echo ... //==>output buffer
<?php header(...) ?> 
```

这有效：

```
<?php
session_start();
$some_variable=$_POST[];
$k="2";
//until here, nothing is send to the output buffer
header(...);
?>
<html> 
```

# sql - 带有连接表的 Cakephp 分页

> ID：15033817
> 
> 赞同：0
> 
> 时间：2013-02-22T21:53:24.290
> 
> 标签：sql, cakephp, pagination

我想将“部门”表加入我的分页结果。这是发生的事情：

我设置了分页变量，以便它加入扇区：

```
$this->paginate = array(
        'joins' => array(
            array(
            'table' => 'sectors',
            'alias' => 'Sector',
            'type' => 'left',
            'foreignKey' => false,
            'conditions' => array('Company.sector_id = Sector.id'))),
        'conditions' => $conditions); 
```

然后走

```
$jobs = $this->paginate('Job'); 
```

分页器生成的查询已损坏，因为**它在 Company 之前加入 Sector**。这是sql输出的一部分：

```
SELECT COUNT(*) AS `count` FROM `jobs` AS `Job` left JOIN sectors AS `Sector` ON (`Company`.`sector_id` = 'Sector.id') LEFT JOIN `companies` AS `Company` ON (`Job`.`company_id` = `Company`.`id`) 
```

它应该是：

```
SELECT COUNT(*) AS `count` FROM `jobs` AS `Job` LEFT JOIN `companies` AS `Company` ON (`Job`.`company_id` = `Company`.`id`) left JOIN sectors AS `Sector` ON (`Company`.`sector_id` = 'Sector.id') 
```

我对 Job 模型进行了分页，它与 Company 模型相关，但与 Sector 模型无关。这就是为什么我需要通过分页加入该部门。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T15:00:25.840

我的解决方案是将 Job 模型与 Sector 结合起来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T23:30:09.470

CakePHP 中的“加入”条件不应指定为关联数组，而应指定为字符串，否则 CakePHP 会将“Sector.id”作为*文字字符串*处理，而不是作为对另一个模型/字段的引用。

所以，替换这个：

```
'conditions' => array('Company.sector_id' => 'Sector.id') 
```

有了这个

```
'conditions' => array('Company.sector_id = Sector.id') 
```

你的查询应该没问题

# c# - 如何使用 C# 类作为数据源

> ID：15033822
> 
> 赞同：1
> 
> 时间：2013-02-22T21:53:50.717
> 
> 标签：c#, dataset

如何使用 C# 类作为数据源并与 DataSet 绑定。我需要使用一些特殊的标签来标记数据字段吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:56:59.680

你的意思是一个类，还是你的类的集合？

要直接使用您的类，您需要实现您的类，以便它继承一个集合接口，如`IEnumerable<T>`.

如果您只有一个班级列表，那么应该可以直接使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T23:24:42.370

正如其他人所说，一个简单的类不能成为 DataSet 对象的数据源。通过数据绑定，您确实可以将控件绑定到单个类及其属性，就像 WPF 中的数据绑定一样。但是，由于您特别提到了 DataSet，DataSet 本身是表（DataTables）和关系的集合，因此它是一个聚合对象，因此一个简单的类是不够的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T23:32:32.360

`DataSource`= 你如何连接到你的数据库 `DataSet`= 你的数据库在内存中的结构

DataSource 这是您分配数据的主要属性。您可以分配实现 IList、IListSource、IBindingList 或 IBindingListView 接口的任何内容。可以分配给 DataSource 属性的项目示例包括数组 (IList)、列表 (IList)、数据表 (IListSource) 和数据集 (IListSource)。

DataSet 是数据的基于内存的表格关系表示，是主要的断开连接的数据对象。从概念上讲，将 DataSet 视为内存中的关系数据库，但它只是缓存数据，不提供当今关系数据库所必需的任何事务属性（原子性、一致性、隔离性、持久性）。DataSet 包含 DataTable 和 DataRelation 对象的集合

**来自：** [https ://stackoverflow.com/a/9326218/335216](https://stackoverflow.com/a/9326218/335216)

# ruby-on-rails - Heroku 不更新资产修改

> ID：15033824
> 
> 赞同：3
> 
> 时间：2013-02-22T21:54:05.053
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我正在使用 heroku 在 ruby​​ on rails 中部署我的应用程序，但是有一个问题，当我部署我的应用程序时，在我编译资产之前，heroku 不会更新我所做的修改。我使用简单的方法在 localhost 中解决了我的问题，`rake assets:clean`但是在 heroku 中，这并不能解决我在修改资产时所做的更新

```
config.assets.initialize_on_precompile = false

config.assets.initialize_on_precompile = true 
```

改变了这个，但它不起作用

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T22:26:55.820

有几件事要做。首先是重新部署

```
$ rake assets:clean
$ rake assets:precompile
$ git add .
... deploy to heroku 
```

如果它仍然不起作用，则可能是缓存问题，在这种情况下，您可以手动插入版本`config/application.rb`并重新部署以使之前的所有资产过期

前任：

```
config.assets.version = '1.2' # change to '1.3' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T01:00:18.270

首先。当您部署没有资产的应用程序时，Heroku 将为您预编译资产，因为它不会找到**manifest.yml。**在资产。

使这项工作。

从 local 和 heroku 中的 public 文件夹中删除所有资产文件。

**在生产中.rb**

确保你有这些代码。

```
 config.serve_static_assets = false
  config.assets.compress = true
  config.assets.digest = true
  config.assets.compile = false 
```

如果您希望 rails 应用程序在找到任何资产时为您查找资产，请设置 assets.compile = true。在预编译。理想情况下，此选项应为 false。

```
 config.assets.compile = true 
```

将这些干净的更改推送到 heroku。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T16:59:58.393

昨晚深夜我遇到了同样的问题，我发现在推送到 heroku 后它与 git 断开连接。一旦我再次完成 GIT 流程，然后将其推送到 heroku，一切都会更新。不知道为什么它会断开连接，但这一直是我整天的工作。花了 2-3 个小时试图解决根本问题，但解决方法更快。

# tsql - 根据函数结果返回函数参数

> ID：15033825
> 
> 赞同：1
> 
> 时间：2013-02-22T21:54:05.377
> 
> 标签：tsql

在我的简化示例场景中，我的目标是在给定特定时间戳和建筑物的情况下返回最接近 70 度的传感器温度（称为“TemperatureOfRecord”）。例如，建筑#1 的 8:00 am 时间戳的 TemperatureOfRecord 是 65 度，因为 65 度比 80 度更接近 70 度。“Delta”列是一个计算列，它返回传感器温度减去 70 度的绝对值。我使用差异来测试每个传感器温度与 70 度的目标温度。

下面的嵌套相关子查询返回正确的结果，但是我在将这种方法扩展到我的实际场景时遇到了很多麻烦。因此，我想问一下是否有更简单的方法可以使用。

```
SELECT
    tt.TmStamp
    , tt.Building
    , tt.Sensor
    , tt.Temperature
    , tt.Delta
    , (SELECT tt2.Temperature
        FROM dbo.TempTest tt2
        WHERE tt2.Building = tt.Building
            AND tt2.TmStamp = tt.TmStamp
            AND tt2.Delta = 
            (SELECT MIN(tt3.Delta)
            FROM dbo.TempTest tt3
            WHERE tt3.Building = tt.Building
                AND tt3.TmStamp = tt.TmStamp)
    ) AS TemperatureOfRecord
FROM dbo.TempTest tt 
```

上述查询的结果如下。

![在此处输入图像描述](../Images/f457c0e6766642d6b0fa8c21ff621909.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:22:59.693

您可以尝试改用 CTE。[这也是一个 SQLFiddle。](http://sqlfiddle.com/#!3/d0912/2)我也比较了这两个查询的执行计划——尽管 CTE 成本更高，但它的扫描/读取量仅比子查询方法少三分之一。

```
WITH rec AS (
    SELECT TmStamp, Building, Temperature, ROW_NUMBER() OVER (PARTITION BY TmStamp, Building ORDER BY Delta) AS RowOrder
    FROM dbo.TempTest
)
SELECT
    tt.TmStamp
    , tt.Building
    , tt.Sensor
    , tt.Temperature
    , tt.Delta
    , rec.Temperature AS TemperatureOfRecord
FROM dbo.TempTest tt
JOIN rec
    ON tt.TmStamp = rec.TmStamp AND tt.Building = rec.Building
WHERE rec.RowOrder = 1 
```

# c++ - 多个线程写入 std::cout 或 std::cerr

> ID：15033827
> 
> 赞同：18
> 
> 时间：2013-02-22T21:54:05.577
> 
> 标签：c++, multithreading, openmp, valgrind

我有通过 cout 和 cerr 写入控制台的 OpenMP 线程。这当然是不安全的，因为输出可以交错。我可以做类似的事情

```
#pragma omp critical(cerr)
{
   cerr << "my variable: " << variable << endl;
} 
```

如果可以用线程安全版本替换 cerr 会更好，类似于 valgrind DRD 手册中解释的方法（[http://valgrind.org/docs/manual/drd-manual.html#drd-manual.effective- use](http://valgrind.org/docs/manual/drd-manual.html#drd-manual.effective-use) )，它涉及从 std::ostreambuf 派生一个类。理想情况下，最后我会用我自己的线程 cerr 替换 cerr，例如：

```
tcerr << "my variable: " << variable << endl; 
```

这样的类一旦遇到“endl”就可以打印到控制台。我不介意来自不同线程的行是否交错，但每一行应该只来自一个线程。

我真的不明白 C++ 中的所有这些流是如何工作的，它太复杂了。有没有人这样的课程或可以告诉我如何为此目的创建这样的课程？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-02-22T22:52:02.153

正如其他人指出的那样，在 C++11 中，`std::cout` **是**线程安全的。

但是，如果您像这样使用它

```
std::cout << 1 << 2 << 3; 
```

对于不同的线程，输出仍然可以交错，因为每个`<<`都是一个新的函数调用，可以在另一个线程上的任何函数调用之前。

为了避免*没有*a 的交错`#pragma omp critical`- 这会锁定所有内容 - 您可以执行以下操作：

```
std::stringstream stream; // #include <sstream> for this
stream << 1 << 2 << 3;
std::cout << stream.str(); 
```

将 123 写入流的三个调用仅发生在一个本地非共享对象的线程中，因此不受任何其他线程的影响。然后，只有一个对共享输出流的调用`std::cout`，其中项目 123 的顺序已经固定，因此不会弄乱。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-22T22:42:42.853

您可以使用类似于字符串生成器的方法。创建一个非模板类：

*   提供模板`operator<<`以插入此对象
*   内部构建成一个`std::ostringstream`
*   在销毁时转储内容

粗略的做法：

```
 class AtomicWriter {
    std::ostringstream st;
 public:
    template <typename T> 
    AtomicWriter& operator<<(T const& t) {
       st << t;
       return *this;
    }
    ~AtomicWriter() {
       std::string s = st.str();
       std::cerr << s;
       //fprintf(stderr,"%s", s.c_str());
       // write(2,s.c_str(),s.size());
    }
 }; 
```

用于：

```
AtomicWriter() << "my variable: " << variable << "\n"; 
```

或者在更复杂的场景中：

```
{
   AtomicWriter w;
   w << "my variables:";
   for (auto & v : vars) {
      w << ' ' << v;
   }
}  // now it dumps 
```

如果您想要操纵器，您将需要添加更多重载，您可以使用`write`比析构函数中`fprintf`的*原子写入*`std::cerr`更好的方法，或者，您可以泛化以便将目标传递给构造函数（`std::ostream`/file descriptor/ `FILE*`），

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-21T20:07:49.997

我没有足够的声誉发表评论，但我想将我添加到 AtomicWriter 类以支持 std::endl 并允许使用除 std::cout 之外的其他流。这里是：

```
class AtomicWriter {
    std::ostringstream st;
    std::ostream &stream;
public:
    AtomicWriter(std::ostream &s=std::cout):stream(s) { }
    template <typename T>
    AtomicWriter& operator<<(T const& t) {
        st << t;
        return *this;
    }
    AtomicWriter& operator<<( std::ostream&(*f)(std::ostream&) ) {
        st << f;
        return *this;
    }
    ~AtomicWriter() { stream << st.str(); }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T22:00:52.777

您可以通过继承来做到这一点[`std::basic_streambuf`](http://en.cppreference.com/w/cpp/io/basic_streambuf)，并覆盖正确的函数以使其成为线程安全的。然后将此类用于您的流对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-01T13:39:30.067

将以下代码放入头文件`atomic_stream_macro.h`

```
#ifndef atomic_stream_macro_h
#define atomic_stream_macro_h

#include <mutex>

/************************************************************************/
/************************************************************************/

extern std::mutex print_mutex;

#define PRINT_MSG(out,msg)                                           \
{                                                                    \
    std::unique_lock<std::mutex> lock (print_mutex);                 \
                                                                     \
    out << __FILE__ << "(" << __LINE__ << ")" << ": "                \
        << msg << std::endl;                                         \
}

/************************************************************************/
/************************************************************************/

#endif 
```

现在可以从文件中使用宏，如下所示。

```
#include <atomic_stream_macro.h>
#include <iostream>

int foo (void)
{
    PRINT_MSG (std::cout, "Some " << "Text " << "Here ");
} 
```

最后，在 main.cxx 中，声明互斥锁。

```
#include <mutex>

std::mutex print_mutex;

int main (void)
{
    // launch threads from here
} 
```

# c# - 如何在多个解决方案之间共享公共 JS 文件？

> ID：15033828
> 
> 赞同：1
> 
> 时间：2013-02-22T21:54:15.270
> 
> 标签：c#, asp.net-mvc, tfs

我目前在两个解决方案中有两个 MVC 项目，它们将共享相当多的外观和感觉，但功能却截然不同。因此，他们有不同的解决方案来管理他们的代码。一切都存储在 TFS 存储库中。

目前，任何共享的 C# 代码都是通过类库管理的，虽然这对 C# 代码来说非常有用，但似乎没有类似的方式来为 JavaScript 或 CSS 文件执行此操作。是否有最佳实践方法来处理 TFS 中单独的解决方案之间的共享 JS 和 CSS 文件，或者只是在一般的解决方案文件中？

为了清楚我所说的“共享”是什么意思，它应该具有以下标准：

1.  文件在两种解决方案中具有相同的名称。
2.  在解决方案 A 中编辑文件会导致将这些更改应用于解决方案 B 中的该文件。
3.  理想情况下，这对开发人员来说是透明的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:01:36.480

您可以创建一个包含所有共享 .js 和 .css 文件的单独项目（例如“CommonJsCss”）。然后将该项目包含在解决方案 A 和解决方案 B 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-02T22:16:55.673

你为什么不把你的文件放在一个文件夹里，比如说'c:\myprojects\shared\javascripts'，然后把这个文件夹包含在你需要的所有解决方案中？所有代码更改都可用于其他项目。此外，您可以在每个解决方案中定义自己的包，包括这些文件。

# ruby-on-rails - Rails自定义路线不起作用

> ID：15033830
> 
> 赞同：1
> 
> 时间：2013-02-22T21:54:20.553
> 
> 标签：ruby-on-rails, ruby-on-rails-3

感觉我做对了，但显然不是。

我有一个安静的资源，帖子，在控制器中有索引、显示、新建、更新、编辑等操作。在路线中，我有

```
resources :posts 
```

我想让索引操作发生在 URL '/archive' 而不是 '/posts'

所以我在 routes.rb 文件中添加了这一行，在资源之后：

```
match '/archive', to: "posts#index" 
```

但是当我单击posts_path 的链接时，它仍然会转到/post（尽管如果我将/archive 作为url 输入，它可以工作——虽然不理想）。使困惑。这可能与我安装了friendly_id有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T22:07:06.613

```
resources :posts, except: [:index]
get 'archive' => 'posts#index', as: :posts 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T22:07:17.757

您需要使用类似`match '/archive', :to => 'posts#index', :as => 'archived'`. 然后你将有一条新的路线来调音`archived_posts_path`。该方法`posts_path`不会根据自定义匹配器动态更改。您可以随时运行`rake routes`以查看您站点的路线列表。

# c - 找到给定输入和目标字符串所需的最小转换次数

> ID：15033832
> 
> 赞同：2
> 
> 时间：2013-02-22T21:54:25.763
> 
> 标签：c, string, algorithm

假设我有一个**输入**字符串，例如： `aab`
给我一个**目标**字符串，例如：`bababa`
然后给我一组转换规则。例如：

```
ab -> bba
b -> ba 
```

在 C 语言中，我怎样才能找到一种算法，该算法将找到需要在输入字符串中应用以获得目标字符串的**最少转换次数。**

例如，在这个例子中，数字是 3。因为我们会这样做：

```
1 - Apply rule 1 (abba)
2 - Apply rule 1 again (bbaba)
3 - Apply rule 2 (bababa) 
```

给定一个输入和一个目标，可能没有解决方案，这也应该引起注意。

我几乎迷失在这样做的策略中。我想到了创建一个自动机，但我不确定在这种情况下我将如何应用。我认为这是一个有趣的问题，我一直在网上研究，但我能找到的只是给定规则的转换，而不是如何确保它是最低限度的。

编辑：作为建议的答案之一，我们可以从初始字符串开始制作一个图表，并创建将转换应用于前一个节点的结果的节点。但是，从我的角度来看，这带来了一些问题：

1.  想象一下，我有一个看起来像 a --> ab 的转换。我的初始字符串是'a'。我的输出字符串是'c'。所以，我一直在做这样的转换（增长图表）：

    a -> ab ab -> abb abb -> abbb ...

我怎么知道何时需要停止构建图表？

1.  假设我有以下字符串 aaaa，并且我有一个像 aa->b 这样的转换规则。我将如何创建新节点？我的意思是，我将如何在该输入字符串中找到子字符串并记住它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:59:15.353

我认为没有有效的解决方案。我认为您必须进行广度优先搜索。通过这样做，您将知道，只要您*有*一个解决方案，它就是*一个最短的*解决方案。

**编辑**：

图片：先修改字符串宽度

![首先搜索字符串宽度](../Images/d2c823c56d1541f32174d6e9d9669674.png)

通过将所有可能的规则应用于所有可能的子字符串，每一层都是从前一层组成的。例如，该`b->ba`规则可以应用于`abba`每个`b`. 重要的是只应用一个规则，然后在列表中记住该字符串（例如 ababa 和 abbaa）。在开始下一层之前，您必须在程序的列表中完全拥有每一层（=宽度优先）。

**编辑 2**：

你写你现在有一个输出`c`。为此，您显然需要一个带有`XX->c`. 所以说你有规则`aaa->c`。`aaa`现在在第 2 层中，您将有一个来自某些`a->aa`规则的字符串。然后您将再次申请`a->aa`并获得`aaaa`，这没关系，因为您应该先去广度，然后您将`aaa->c`规则应用到`aaa`现在有由和其他组成`aaaa`的第 3 层。`c`您不要继续修改`aaaa`，因为那会转到第 4 层，您已经`c`在第 3 层找到了目标，因此您可以停止。

**编辑 3**：

您现在询问是否可以决定一组未指定的规则如何决定何时停止分层。一般来说这是不可能的，它被称为停机问题[https://en.wikipedia.org/wiki/Halting_problem](https://en.wikipedia.org/wiki/Halting_problem)。

**但是**对于特定规则，您可以判断您是否可以达到输出。

*   示例 1：如果目标包含任何规则都无法提供的原子（您的“c”示例）。
*   示例 2：如果您的规则都是增加字符串的长度或保持长度不变（没有*减少*字符串长度的规则）
*   示例 3：如果您通过算法发现某些规则是循环的，则可以删除某些规则
*   存在其他示例

# r - 在 R 中使用两个向量来创建一个新向量

> ID：15033833
> 
> 赞同：1
> 
> 时间：2013-02-22T21:54:26.153
> 
> 标签：r, vector

所以这是一个非常奇怪的问题，但是我在 R 中有两个向量：一个是 ID 的顺序列表，另一个是我希望该 id 在新向量中出现多少次。

例如：

```
ids: A B C D
times: 4 2 5 3 
```

我想结束

```
new: A A A A B B C C C C C D D D 
```

这有意义吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T21:56:44.343

使用`rep`函数如下：

```
> rep(c('A', 'B', 'C', 'D'), times=c(4, 2, 5, 3))
 [1] "A" "A" "A" "A" "B" "B" "C" "C" "C" "C" "C" "D" "D" "D" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:56:29.473

采用`rep()`

```
> rep(LETTERS[1:4], times = c(4,2,5,3))
 [1] "A" "A" "A" "A" "B" "B" "C" "C" "C" "C" "C" "D" "D" "D" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T21:57:21.263

这当然是有道理的。

```
rep(c("A","B","C","D"),times=c(4,2,5,3))
[1] "A" "A" "A" "A" "B" "B" "C" "C" "C" "C" "C" "D" "D" "D" 
```

# internet-explorer - 为什么这段代码在 Firefox 和 Internet Explorer 上不起作用

> ID：15033836
> 
> 赞同：0
> 
> 时间：2013-02-22T21:54:50.143
> 
> 标签：internet-explorer, firefox

你好我已经开发了这段代码

page1.php

```
<META HTTP-EQUIV="Refresh" CONTENT="0; url=page2.php"> 
```

--

page2.php

```
$referer = $_SERVER['HTTP_REFERER'];  
echo $referer;
$query = parse_url($referer, PHP_URL_QUERY);
parse_str($query, $queryArr);
$id = $queryArr['id'];
echo '<br>';
echo $h; 
```

所以当我需要尝试代码时，我会转到链接 domain.com/page1.php?id=83

在 chrome 中显示

```
    domain.com/page.php?id=83
    83

```

我Firefox，Internet Explorer它只显示一个空白页面我想知道如何修复此代码，使其适用于所有浏览器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:59:27.630

也许您应该只在第 1 页中使用 php 标头重定向？

```
<?php header('Location: page2.php?id=83'); ?> 
```

# java - 需要有关制作逐帧启动画面的教程或帮助？

> ID：15033838
> 
> 赞同：0
> 
> 时间：2013-02-22T21:55:03.913
> 
> 标签：java, android, xml, splash-screen

我一直在寻找这个问题和答案，但没有发现任何帮助。我有13个PNG。我试图在启动画面中一个接一个地运行的图像。这是我正在使用的代码。

飞溅.xml

```
<ImageView
android:contentDescription="@string/desc"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:id="@+id/logo"
android:background="@drawable/logo" /> 
```

飞溅.java

```
public class Splash extends Activity{
Animation animation;
MediaPlayer ourSong;

@Override
public void onAttachedToWindow() {
    // TODO Auto-generated method stub
    super.onAttachedToWindow();
    Window window = getWindow();
    window.setFormat(PixelFormat.RGBA_8888);
}

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.splash);
    ourSong = MediaPlayer.create(Splash.this, R.raw.splashsound);
    ourSong.start();
    Thread timer = new Thread(){
        public void run(){
            try{
                sleep(7000);
            } catch (InterruptedException e){
                e.printStackTrace();
            }finally{
                Intent openStartingPoint = new Intent("com.thegoodwarren.lonte.STARTINGPOINT");
                startActivity(openStartingPoint);
            }
        }
    };
    timer.start();

    StartAnimations();
}

private void StartAnimations() {
    // TODO Auto-generated method stub
    Animation anim = AnimationUtils.loadAnimation(this, R.anim.alpha);
    anim.reset();
    LinearLayout l=(LinearLayout) findViewById(R.id.lin_lay);
    l.clearAnimation();
    l.startAnimation(anim);

    anim = AnimationUtils.loadAnimation(this, R.anim.translate);
    anim.reset();
    ImageView iv = (ImageView) findViewById(R.id.logo);
    iv.clearAnimation();
    iv.startAnimation(anim);

}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    ourSong.release();
    finish();
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:08:27.557

> 我有13个PNG。我试图在启动画面中一个接一个地运行的图像。

[以可绘制资源](http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html)[`AnimationDrawable`的形式`<animation-list>`](http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html)创建一个。在 XML 中列出每个 PNG 以及应该在该帧上花费的时间。`AnimationDrawable`在你的中使用它`ImageView`，并调用`startAnimation()`它让它开始动画。

# c# - Windows 窗体中的图形

> ID：15033844
> 
> 赞同：1
> 
> 时间：2013-02-22T21:55:32.927
> 
> 标签：c#, .net, winforms, form-load

加载表单时**CreateGraphics()**不应该返回图形对象吗？

我的意思是，在 Form1_Load 事件中，我可以编写例如以下内容吗？

```
Graphics x;
private void Form1_Load(object sender, EventArgs e)
{
    x = this.CreateGraphics();
} 
```

如果不是，那为什么？

我以为当你创建一个新表单时，[构造函数](http://en.wikipedia.org/wiki/Constructor_%28object-oriented_programming%29)会启动表单的所有对象。那么为什么不是图形对象呢？

我在问这个问题，因为当我尝试绘制时 - 在 form_load 上，它并没有显示我绘制的内容。

主要原因是：我想创建一个有棋盘的游戏——所以当用户点击新游戏时——首先——我正在启动棋盘并绘制它。在**onPaint**事件中，我只想绘制电路板的当前状态。所以我认为板子的初始状态应该是在**formLoad**事件上绘制的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T21:59:51.770

您不应该以这种方式使用 Graphics 对象；您应该将它的每次使用都包含在 using 块中，或者确保在每组绘图操作之后将其丢弃。您在此处的代码将留下一个不必要的 Graphics 对象。

简要示例：

```
private void MyonPaintOverload()
{
    using(Graphics x = this.CreateGraphics())
    {
        // draw here...
    }
} 
```

此外，绘图`Form_Load()`不起作用，因为此时窗口实际上是不可见的；基本上没有什么可借鉴的。

是的，您通常需要在每个循环中重绘*整个东西*- 因为像在您的窗口上拖动另一个窗口这样简单的东西会“抹掉”您的绘图，并且当它因另一个窗口被移走而无效时，您需要重绘*所有内容*您手动绘制的。

# java - 获取调用方法的注解

> ID：15033845
> 
> 赞同：3
> 
> 时间：2013-02-22T21:55:39.043
> 
> 标签：java, reflection

这是我的代码示例：

```
class foo extends afoo{

    @HTTPPost
    returnClass runTransaction(RequestData req){
        return sendData(req, returnClass.class)
    }

    @HTTPGet
    returnClass runTransaction2(RequestData req){
        return sendData(req, returnClass.class)
    }
}

abstract class afoo {

public <T> T sendData(ARestMessage req, Class<T> returnClassType)
    //here i need the annotation of the calling method
} 
```

基本上我正在构建一个非常复杂的消息传递系统，我想尽可能多地在注释中放置切换和配置。

是的，我知道有一些库（比如 Google 反射）可以让这更容易，但为了让我使用它们，我必须做 4-6 个月的文书工作和与企业架构会议才能获得使用它们的批准. 看到项目必须在2个月内完成，我正在手工完成。

所以我正在做的是创建注释，开发人员可以注释方法，指示生成的服务期望发送数据的方式。这可能是 get、post、put 等。在所有服务类扩展的抽象类内部，是一个 senddata 方法。该方法必须能够确定使用哪个方法来调用它，也就是说，是通过 runTransaction 还是 runTransaction2，所以 sendData 拉取该方法注释，因此确切地知道如何将数据发送到服务。

现在我找到了这个（这是我的 sendData 方法中的第一行代码）

```
final Method callingMethod = this.getClass().getEnclosingMethod(); 
```

但它一直返回null。我已经阅读了几次关于它的 javadoc，但我不明白为什么它一直返回 null。

我知道我可以使用堆栈获取父调用者，但我不希望这样做，因为此应用程序与另一个执行大量 AOP 工作的应用程序共享应用程序服务器内存。AOP 工作非常擅长以意想不到的方式弄乱堆栈，所以我宁愿使用直接反射来解决这个问题。

有谁知道为什么这个方法一直返回null？是因为它包含在一个抽象类中，而不是我的 foo 类本身吗？有没有办法使用我更喜欢使用的技术来实现这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T21:59:52.250

该方法`Class.getEnclosingMethod()`不会像您认为的那样做。这是它的Javadoc：

> 如果此 Class 对象表示方法中的本地或匿名类，则返回一个 Method 对象，该对象表示基础类的直接封闭方法。**否则返回 null**。特别是，如果基础类是直接由类型声明、实例初始化程序或静态初始化程序包围的本地或匿名类，则此方法返回 null。

具体来说，它返回在该方法的上下文中定义的匿名内部类的外部封闭方法。我在您的描述中没有看到这些消息传递方法是从匿名/本地内部类调用的。这是代码中的示例（需要 jUnit）：

```
import java.lang.reflect.Method;

import org.junit.Assert;
import org.junit.Test;

interface Introspector {
    public Method getEnclosingMethod();
}

public class Encloser {

    public Encloser() {
        super();
    }

    public Method noop() {

        final Introspector inner = new Introspector() {
            @Override
            public Method getEnclosingMethod() {
                return getClass().getEnclosingMethod();
            }
        };

        return inner.getEnclosingMethod();
    }

    @Test
    public void testEnclosingMethods() throws Exception {
        final Encloser encloser = new Encloser();
        Method method = encloser.getClass().getEnclosingMethod();
        Assert.assertNull(method);

        method = encloser.noop();
        Assert.assertNotNull(method);
    }
} 
```

您当前的解决方案听起来很复杂。您是否打算沿着方法调用链（只能通过转储堆栈跟踪 btw 来做到这一点）并在进行大量反思后寻找注释？我预见了很多错误。坦率地说，采用某种构建器模式可能更适合您的场景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:43:37.390

在这里使用注释没有意义，只需将另一个参数传递给 method `sendData()`。

# php - 测试完全使用另一个对象方法的方法

> ID：15033847
> 
> 赞同：3
> 
> 时间：2013-02-22T21:55:49.723
> 
> 标签：php, unit-testing, testing, phpunit

我在为它编写单元测试时重构一个类。有一种情况是我的一个方法完全调用了另一个对象的方法，该方法注入到我正在测试的这个类中。

所以我必须模拟我注入类的对象。

现在，问题是，是否值得为这个特定方法编写单元测试？编写单元测试似乎很奇怪，它调用其他对象的方法，该对象本身必须被模拟，那么我为什么要测试这个方法呢？

测试的目的不是检查方法的功能是否按预期工作吗？如果是，那么当我嘲笑它所拥有的一切并且该特定方法没有任何东西可以测试时，我为什么要测试？

我真的很困惑！

我坚持的方法是这个（用于自定义会话处理）：

```
public function write($sessionId, $sessionData)
{
    $sth = $this->databaseConnection->prepare("INSERT INTO `{$this->DBTableName}` (`session_id`,`session_name`,`session_data`) VALUES(:session_id, :session_name, :session_data) ON DUPLICATE KEY UPDATE `session_data`=:session_data;");
    $sth->bindValue(':session_id', $sessionId);
    $sth->bindValue(':session_name', $this->sessionName);
    $sth->bindValue(':session_data', $sessionData);

    return $sth->execute();
} 
```

这里也是这段代码的链接：http: [//pastebin.com/1FBeU6mb](http://pastebin.com/1FBeU6mb)

顺便说一句，我刚开始为我的课程编写测试，我是这个测试领域的初学者并且没有经验。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T22:16:45.313

我对 php 不是很熟悉，但看起来您只是在构建和执行数据库查询，对吧？

除非这个方法和数据库之间有我看不到的其他层，否则这里真的没有什么值得嘲笑的。所以你是对的，在这里嘲笑并没有给你很多价值。而且从某种意义上说，测试这种方法的价值是有限的，因为您实际上只是在测试数据库层，通常我们可以假设它已经正确且稳定，因此不需要测试。

一般来说，模拟的价值在于它允许您通过假设其他方法正在做什么来简化测试，并且允许您不必间接测试那些其他方法。

在选择测试 write 方法时，事实证明您正在测试的是您有正确的步骤来返回正确的结果。而已。我不熟悉 php 模拟框架，但我知道对于其他语言的框架，您可以设置所谓的期望，它可以让您指定将在具有某些参数的某个对象上调用某个方法。您甚至可以经常指定它们的执行顺序。这里的要点是您正在测试您的对象发送的*传出*消息，而不是这些消息的返回值。

与此测试所需的维护相比，这是否有价值由您决定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:09:26.890

您正在测试是否将正确的参数传递给您准备好的语句。此外，您应该测试该`write`方法是否返回准备好的语句结果。

如果您不对此进行测试，那么您的应用程序可能会以多种方式中断。

*   重命名或删除方法参数 ( `$sessionId`, `$sessionData`)
*   重命名您的财产`$this->sessionName`
*   删除其中一个`bindValue`呼叫。
*   绑定别名的错误命名。它们应该与您的查询匹配。
*   返回的结果不是`execute()`.

等等等等

所以是的，测试这个是很好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-28T20:31:38.933

假设您的示例描述了一个`SessionHandler`类，它看起来类似于：

```
class SessionHandler
{
    public function __construct($sessionTableName, $sessionName, \PDO $databaseConnection)
    { 
        $this->DBTableName = $sessionTableName;
        $this->sessionName = $sessionName;
        $this->databaseConnection = $databaseConnection;
    }

    // among others, your method write($sessionId, $sessionData) follows
} 
```

这可以涵盖方法`write()`：

```
public function testWriteInsertsOrUpdatesSessionData()
{
    /**
     * initialize a few explaining variables which we can refer to 
     * later when arranging test doubles and eventually act
     */
    $sessionTableName = 'sessions';
    $sessionName = 'foobarbaz';

    $sessionId = 'foo';
    $sessionData = serialize([
        'bar' => 'baz',
    ]);

    $executed = true;

    /**
     * create a test double for the statement that we expect to be returned 
     * from `PDO::prepare()`
     */
    $statement = $this->createMock(\PDOStatement::class);

    /**
     * set up expectations towards which methods should be invoked 
     * on the statement, specifying their order
     */
    $statement
        ->expects($this->at(0))
        ->method('bindValue')
        ->with(
            $this->identicalTo(':session_id'),
            $this->identicalTo(sessionId)
        );

    $statement
        ->expects($this->at(1))
        ->method('bindValue')
        ->with(
            $this->identicalTo(':session_name'),
            $this->identicalTo($sessionName)
        );

    $statement
        ->expects($this->at(2))
        ->method('bindValue')
        ->with(
            $this->identicalTo(':session_data'),
            $this->identicalTo(sessionData)
        );

    $statement
        ->expects($this->at(3))
        ->method('execute')
        ->willReturn($executed);

    /**
     * create a test double for the database connection we inject
     * into SessionHandler during construction
     */
    $databaseConnection = $this->createMock(\PDO::class);

    $databaseConnection
        ->expects($this->once())
        ->method('prepare')
        ->with($this->identicalTo(sprintf(
            'INSERT INTO `%s` (`session_id`,`session_name`,`session_data`) VALUES(:session_id, :session_name, :session_data) ON DUPLICATE KEY UPDATE `session_data`=:session_data;',
            $sessionTableName
        )))
        ->willReturn($statement);

    $sessionHandler = new SessionHandler(
        $sessionTableName,
        $sessionName,
        $databaseConnection
    );

    $result = $sessionHandler->write(
        $sessionId,
        $sessionData
    );

    $this->assertSame($executed, $result);
} 
```

供参考，请参阅：

*   [https://phpunit.de/manual/current/en/test-doubles.html](https://phpunit.de/manual/current/en/test-doubles.html)

# rabbitmq - RabbitMQ 客户端如何判断它何时失去与服务器的连接？

> ID：15033848
> 
> 赞同：12
> 
> 时间：2013-02-22T21:55:51.477
> 
> 标签：rabbitmq

如果我连接到 RabbitMQ 并使用 EventingBasicConsumer 侦听事件，我如何判断我是否已与服务器断开连接？

我知道有一个 Shutdown 事件，但是如果我拔下网络电缆来模拟故障，它不会触发。

我还尝试了 ModelShutdown 事件和模型上的 CallbackException，但似乎都没有。

编辑-----我标记为答案的那个是正确的，但这只是我解决方案的一部分。RabbitMQ 中还内置了 HeartBeat 功能。服务器在配置文件中指定它。它默认为 10 分钟，但您当然可以更改它。

客户端还可以通过在 ConnectionFactory 实例上设置 RequestedHeartbeat 值来请求不同的心跳间隔。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T12:05:36.493

我猜你正在使用 C# 库？（但即便如此，我认为其他人也有类似的事件）。

您可以执行以下操作：

```
public class MyRabbitConsumer
{
  private IConnection connection;

  public void Connect()
  {
    connection = CreateAndOpenConnection();
    connection.ConnectionShutdown += connection_ConnectionShutdown;
  }

  public IConnection CreateAndOpenConnection() { ... }

  private void connection_ConnectionShutdown(IConnection connection, ShutdownEventArgs reason)
  {

  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-18T17:39:30.463

这是一个例子，但标记的答案是导致我这样做的原因。

```
var factory = new ConnectionFactory
{
    HostName = "MY_HOST_NAME",
    UserName = "USERNAME",
    Password = "PASSWORD",
    RequestedHeartbeat = 30
};

using (var connection = factory.CreateConnection())
{
    connection.ConnectionShutdown += (o, e) =>
    {                       
        //handle disconnect                            
    };

    using (var model = connection.CreateModel())
    {
        model.ExchangeDeclare(EXCHANGE_NAME, "topic");
        var queueName = model.QueueDeclare();

        model.QueueBind(queueName, EXCHANGE_NAME, "#"); 

        var consumer = new QueueingBasicConsumer(model);
        model.BasicConsume(queueName, true, consumer);

        while (!stop)
        {
            BasicDeliverEventArgs args;                       
            consumer.Queue.Dequeue(5000, out args);

            if (stop) return;

            if (args == null) continue;
            if (args.Body.Length == 0) continue;

            Task.Factory.StartNew(() =>
            {
                //Do work here on different thread then this one
            }, TaskCreationOptions.PreferFairness);
        }
    }
} 
```

关于这一点有几点需要注意。

我正在使用 # 作为主题。这抓住了一切。通常你想限制一个主题。

我正在设置一个名为“stop”的变量来确定进程何时结束。您会注意到循环永远运行，直到该变量为真。

如果没有新消息，出队等待 5 秒然后离开而不获取数据。这是为了确保我们监听那个停止变量并在某个时候真正退出。根据您的喜好更改值。

当有消息进来时，我在一个新线程上生成处理代码。当前线程被保留用于仅收听 rabbitmq 消息，如果处理程序处理时间过长，我不希望它减慢其他消息的速度。根据您的实施，您可能需要也可能不需要。但是要小心编写代码来处理消息。如果运行需要一分钟并且您在亚秒级时间内收到消息，您将耗尽内存或至少会出现严重的性能问题。

# python - 与 Django 一起同步读取分段上传

> ID：15033849
> 
> 赞同：3
> 
> 时间：2013-02-22T21:55:52.623
> 
> 标签：python, django, multipart, synchronous

我有一个 Django 应用程序，该应用程序需要在上传多部分文件时将其作为类文件对象读取*，*这意味着我需要或多或少同步访问请求对象以及将其解压缩为二进制文件的方法数据。不幸的是，Django 通过将它们直接移动到内存或临时文件来处理上传，这不适用于我的用例。

有人建议我使用 gevent/greenlet 来处理上传，但我不确定这对等式有何影响，以及与 Django 一起需要什么设置才能使其正常工作。另外，在 Django 之外运行某些东西意味着我必须实现一个数据库连接层来验证是否允许上传（使用票证 ID）。

话虽如此，我该如何设置呢？Django 应该在 WSGI 应用程序中运行，并且有人还建议编写第二个 WSGI 应用程序来捕获用于上传的单个 URL 路径。我想尽可能多地利用 Django 框架，同时能够同步读取上传内容？

^(（我刚刚熟悉了`requests`Python 库，不得不说我是一个非常忠实的粉丝，尽管我不知道在服务器上下文中使用它的第一件事。）)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T20:14:12.347

我相信很多这些建议都过于复杂了。

您需要更改 Django 处理上传文件的方式吗？只需修改[上传处理程序](https://docs.djangoproject.com/en/dev/topics/http/file-uploads/#upload-handlers)。

基[类](https://github.com/django/django/blob/master/django/core/files/uploadhandler.py#L56)相对简单，并为您提供了许多很棒的钩子。你应该能够扩展它来做你想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T07:38:23.787

虽然我无法为您编写所有代码（这很复杂），但这是我推荐的设置。

1.  使用 Tornado + Django：Tornado 可以嵌入 WSGI 进程，因此这使您能够让一个进程同时托管 Django 和这个 Tornado 处理程序。这是我的一个活动项目中的一个快速示例（尽管它使用 Tornado 作为 Socket.io 处理程序，但它应该为您提供解决方案的要点（：

    ```
    # Socket Server
    db = momoko.Pool(DB_DSN, **DB_CONFIG)
    router   = tornadio2.TornadioRouter(QueryRouter, user_settings={'db':db})
    sock_app = tornado.web.Application(router.urls, flash_policy_port = FL_PORT, flash_policy_file = path.join(PROJECT_ROOT, 'assets/xml/flashpolicy.xml'), socket_io_port = WS_PORT, debug=True)
    # Django Server
    os.environ['DJANGO_SETTINGS_MODULE'] = 'sever.settings'
    application = django.core.handlers.wsgi.WSGIHandler()
    container = tornado.wsgi.WSGIContainer(application)

    # Start the web servers
    if __name__ == "__main__":
        try:
            import logging
            tornado.options.parse_command_line()
            logging.getLogger().setLevel(logging.INFO)
            logging.info('Server started')
            tornado.locale.set_default_locale('us_US')
            http_server = tornado.httpserver.HTTPServer(container)
            http_server.listen(8000)
            tornadio2.SocketServer(sock_app, auto_start=True)
            tornado.ioloop.IOLoop.instance().start()
        except KeyboardInterrupt:
            tornado.ioloop.IOLoop.instance().stop()
            logging.info("Stopping servers.") 
    ```

这可以很容易地转换为在两个不同端口上运行的两个服务器实例，其中 80 为 Django 保留，8080 用于您的上传处理程序。

1.  我推荐 Tornado，因为它支持流式请求体，并且非常适合这种类型的使用。[这是一个可能对您有所帮助的要点](https://gist.github.com/sarva/1651121)。

2.  您的代理设置很重要。如果您使用 NGINX，请确保关闭 proxy_buffering。

3.  我不会使用数据库进行票证/上传检查。Redis 或 memcache 可能是处理此问题的更快方法。缓存也是在 Django 和 Tornado 之间来回上传进度的好方法，因为设置/获取新值的开销非常小。

这是一个棘手的大问题，需要严肃的工程才能提出一些优雅的东西，但它不仅仅是可行的。

# graph - Powerbuilder Graph 标签可以显示值而不是百分比吗？

> ID：15033850
> 
> 赞同：0
> 
> 时间：2013-02-22T21:55:52.890
> 
> 标签：graph, powerbuilder

使用 PB 12

我有一个分解项目账单的饼图。它显示百分比，但对我来说显示值会更有用。

我很难找到有关操纵图表的任何资源。我还希望能够将更多信息放入图例中，但同样没有找到任何指南。

非常感谢任何帮助，谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T22:55:57.573

要获取值而不是百分比：

*   编辑数据窗口，选择“文本”选项卡
*   在 TextObject 下拉列表中选择“饼图标签”
*   在“显示表达式”字段中输入“值”

我用的是PB10.5，希望和12一样。

# c# - windows-phone-7.1 在设置后立即退出应用程序

> ID：15033851
> 
> 赞同：0
> 
> 时间：2013-02-22T21:56:20.677
> 
> 标签：c#, set, windows-phone-7.1, windows-phone

我正在尝试制作一个应用程序，而我只是想弄清楚 Windows 手机上的一切是如何工作的。

在 Windows Phone 模拟器中，我尝试运行我的应用程序，但它只是返回到前一个屏幕而没有任何错误。（编译器也没有给我任何错误。）

即使我除了 this.voice = value 没有放任何东西，它仍然不起作用。

这是发生错误的代码：

```
 // volume of the voice of the commentator;
   public int voice { 
        get 
        { 
            return voice; 
        }
        set 
        {
            settings["voice"] = this.voice = (int)value;  // right here it just stops.
        } 
```

我调用这个函数的代码是：

```
public partial class MainPage : PhoneApplicationPage
{
    // Constructor
    public MainPage()
    {
        InitializeComponent();
       // example :: ExceptionHandler.newException("er is geen exception");

        Option option = new Option();
        option.backgroundMusic = 22; // here
        option.voice = 32; // here

    }
} 
```

而对于一个完整的图片：

主页 ：

```
public partial class MainPage : PhoneApplicationPage
{
    // Constructor
    public MainPage()
    {
        InitializeComponent();
       // example :: ExceptionHandler.newException("er is geen exception");

        Option option = new Option();
        option.backgroundMusic = 22;
        option.voice = 32;

    }
} 
```

类选项：

```
 public class Option
    {
    // isolated storage settings connection.
    private static IsolatedStorageSettings settings = IsolatedStorageSettings.ApplicationSettings; 

    // volume of the backgroundMusic;
    public int backgroundMusic { 
        get 
        { 
            return backgroundMusic; 
        } 
        set 
        {
            settings["backgroundMusic"] = this.backgroundMusic = (int)value; 
        } 
    } 

    // volume of the voice of the commentator;
    public int voice { 
        get 
        { 
            return voice; 
        }
        set 
        {
            settings["voice"] = this.voice = (int)value; 
        } 
    }

    public Option()
    {
        // If the keys doesn't exists
        if (!settings.Contains("backgroundMusic") && !settings.Contains("voice"))
        {

            // Create the settings.
            settings.Add("backgroundMusic", (int)50 );
            settings.Add("voice", (int)50);
        }
        // If the key exists, retrieve the value and set the properties of backgroundMusic and voice
        else
        {
            this.backgroundMusic = (int)settings["backgroundMusic"];
            this.voice = (int)settings["voice"];
        }
    }
} 
```

编辑 ：

如果我做错了什么或者有什么更好的，我愿意接受建议，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:02:25.800

无限循环？`this.voice = value`再次触发集合，形成循环。

您必须声明另一个字段并将其用作值存储：

```
private int _voice;
public int voice
{ 
    get 
    { 
        return _voice; 
    }
    set 
    {
        settings["voice"] = _voice = (int)value; 
    } 
} 
```

您也必须对第二个属性执行相同的操作。

# jquery - 简单但有缺陷的 jQuery 动画

> ID：15033858
> 
> 赞同：0
> 
> 时间：2013-02-22T21:56:51.417
> 
> 标签：jquery, animation

我一直在自己试验 jQuery，但遇到了一些我无法弄清楚的错误。任何帮助将不胜感激。

可以在下面找到简单的动画（带有指向 jsfiddle 的链接）。

单击按钮后，猪应该从左侧进入，向前移动（沿途完成几个旋转），然后淡出。George Costanza 从左边进入并给予掌声。

不幸的是，乔治没有什么可以鼓掌的，因为猪的动作非常糟糕。它以我从未想过的方式来回跳跃。乔治的动作也是如此。此外，他似乎从来没有像我打算的那样在最后完全离开页面。

顺便说一句，我在编写动画的计算机上对此没有任何问题（在 jsfiddle 中使用 chrome）。然而，在我的笔记本电脑（chrome）和朋友的笔记本电脑（safari？）上，它是无可救药的错误。

关于我要去哪里错的任何想法？提前致谢！

这是 jsfiddle 的代码和链接：jsfiddle.net/corduroy_joy/v69st/

```
$(文档).ready(函数() {
    $('#button').click(function(){
        $('#pig').animate({left:'+=200px'}, 1000).animate({top:'+=10px'}, 100).animate({left:'+=10px'}, 100).animate({bottom:'+=12px'}, 100).animate({left:'+=100px'}, 690, 'linear').animate({bottom:'+=15px'}, 100 ).animate({left:'+=130px'}, 590, 'linear').animate({top:'+=10px'}, 100).animate({left:'+=10px'}, 100) .animate({bottom:'+=12px'}, 100).animate({left:'+=100px'}, 690, 'linear').animate({top:'-=15px'}, 100)。 animate({left:'+=130px'}, 590, 'linear').animate({top:'+=10px'}, 100).animate({left:'+=10px'}, 100).animate ({bottom:'+=12px'}, 100).animate({left:'+=100px'}, 690, 'linear').animate({top:'-=12px'}, 100).animate( {left:'+=100px'}, 690, 'linear').animate({bottom:'+=15px'}, 100).animate({left:'+=130px'}, 590, 'linear').animate({bottom:'+=15px'}, 100).animate({left:'+=130px'}, 590, 'linear').fadeTo('slow', 0).animate({left:'+=200px'}, 1000, function() {$ ('#pig').removeAttr('style');});

$('#george').animate({left:'-=1px'}, 7000).animate({left:'+=280px'}, 1500).delay(1400).animate({left:'- =281px'}, 3500);   
});
});

```

更新：呃，我尝试过的无数种方法似乎都不起作用。我放弃了 jQuery 动画！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:09:58.803

您应该使用`animate`方法的回调函数，否则在一个动画完成之前执行另一个动画。

```
$('#button').click(function(){
    $('#pig').animate({left:'+=200px'}, 1000, function(){
        $(this).animate(..., function(){
             $(this).animate(..., function() {  })
        })
}) 
```

# php - 当数据库中表中的 1 个对象被移动并且其 ID 设置为自动递增时，ID 会发生什么情况？

> ID：15033861
> 
> 赞同：-2
> 
> 时间：2013-02-22T21:57:05.043
> 
> 标签：php, mysql, auto-increment

我已经在数据库中创建了表，以便用户可以将对象放入数据库中，ID 将自动增加。假设用户想在一段时间后从数据库中移动对象，而数据库中已经添加了更多对象。在下一次用对象填充数据库时，现在未覆盖的 ID 数量是否会被覆盖？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:58:04.667

不，它会像以前一样保持计数

# azure - 如何使用 msbuild 为 Azure SDK 1.8 创建 csx 输出？

> ID：15033863
> 
> 赞同：2
> 
> 时间：2013-02-22T21:57:09.237
> 
> 标签：azure, msbuild, azure-web-roles, azure-1.8

我有一个带有 Azure Cloud 项目的 Visual Studio 项目，该项目具有一个用于 WCF 服务的 Web 角色。我不需要使用 Visual Studio 中的 Package 命令或使用 cspack 创建 cspkg，而是需要使用 msbuild 在项目的 csx 文件夹中创建相同的输出。但是，如果我在 msbuild 中运行以下命令，则输出的文件夹结构与 csx 文件夹不同：

```
msbuild MyAzureProject.ccproj /p:configuration=debug /maxcpucount /p:outdir="c:\OutDir" /p:overwritereadonlyfiles=true /p:targetprofile="Cloud" 
```

相反，它会创建一个 _PublishedWebsites 文件夹。有谁知道如何使用 msbuild 命令行（即 csx/roles/MyAzureRole/approot）手动创建 csx 文件夹的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T22:33:42.297

您只是缺少目标开关。

这对我有用。

msbuild MyAzureProject.ccproj /p:configuration=debug /maxcpucount /p:outdir="c:\OutDir" /p:overwritereadonlyfiles=true /p:targetprofile="Cloud" /target:Clean;Publish

# vim - VIM 搜索/替换模式

> ID：15033864
> 
> 赞同：1
> 
> 时间：2013-02-22T21:57:14.030
> 
> 标签：vim

如何使用以下条件进行 VIM 搜索/替换：

a) 该行包含 str1

b）该行还包含 str2

c) 该行不包含 str3

在这样一条线上，我确实想用 yyy 替换 xxx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:51:38.043

正则表达式处理得不是`and, not`很好。有办法做到这一点，但有点棘手。一个非常简单的功能可以解决您的问题：

```
function! Rep()
        let l = getline('.')
        if stridx(l, 'str1')>=0 && stridx(l,'str2') >=0 && stridx(l,'str3')<0
                execute 's/xxx/yyy/g'
        endif
endfunction 
```

你可以

*   要么把它写在你的`.vimrc`文件中。
*   或将其保存在`foo.vim`文件中并使用 vim 类型打开它`:so %`

然后打开您的目标文件，输入`:%call Rep()`您将看到的示例：

```
str1 str2 str3 xxx
str3 str2 xxx
str2 xxx
*str1 str2 xxx
*xxx str2 xxx str2 xxx str1 
```

将更改为：

```
str1 str2 str3 xxx
str3 str2 xxx
str2 xxx
*str1 str2 yyy
*yyy str2 yyy str2 yyy str1 
```

我认为在该函数中将 str1,str2,xxx,yyy 替换为您的实际值对您来说并不难，是吗？

**编辑**

您真正的问题似乎比您所描述的问题要容易得多。试试这一行：

```
:%s/\(\s*return\s*aLib\.[^(]\+(\)\s*\()\)/\1aHandle\2/ 
```

请注意，它可以写得更短，仅用于您的示例工作，但我希望它是安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:51:46.383

这将替换`()`包含该字符串的文件的每一行中的字符串`return`，并`aLib`在之后的某个时间点替换该字符串：

```
:%s/return.*aLib.*\zs()\ze/(aHandle)/ 
```

`%`是命令的操作范围，包括文件中的所有行。

`\zs`表示被替换字符串的开始并`\ze`表示它的结束。

如果每行必须替换多个实例，`g`请在命令末尾的最后一个`/`. 如果您想确认每个替换，请将`c`标志放在末尾。

通过假设`()`如果存在则字符串永远不`aHandle`存在，此命令不能准确回答您的问题，但根据评论中提供的示例，这可能符合您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T01:53:21.327

我认为**@Kent**的答案（函数）在进行复杂搜索/替换时是“最正确的”。后面改比较容易，过段时间也能理解，写起来也比这个快。但我认为如果可以使用“oneliner”来做到这一点会很有趣。
我欢迎对此不起作用的评论，如果可能的话，我觉得自己很有趣，**而不是**如果它是“最佳解决方案”。

原始问题中描述的所有情况的“oneliner”。

```
:v/str3/s/\v(.*str1&.*str2)@=.{-}\zsxxx/yyy/g 
```

**解释：**

*   `:v/str3/`所有不包含“ `str3`”的行
*   `s/`代替
*   `\v`“非常神奇”（不必逃避正则表达式，如`{}`），[`:h \v`](http://vimdoc.sourceforge.net/htmldoc/pattern.html#/%5Cv)
*   `(.*str1&.*str2)@=`积极前瞻，[`:h \@=`](http://vimdoc.sourceforge.net/htmldoc/pattern.html#/%5C@=)
    *   `.*str1`任何字符 0 或更多（“贪婪”）后跟“ `str1`”，前面`.*`对于两者`&`和`@=`工作都很重要
    *   `&``&`必须存在前后模式，与`|`使用“或”不同，两种模式**必须**从同一位置开始，这就是为什么`.*`使用 before `str1/2`，[`:h \&`](http://vimdoc.sourceforge.net/htmldoc/pattern.html#/%5C&)
    *   `@=`前面的原子（在括号中）应该存在，但模式不包括在匹配中，但是原子必须从行的开头开始才能起作用（`.*`确保这一点）。
*   `.{-}`任何字符 0 或更多（“不贪婪”），如果应该替换不止一次的出现，`{-}`而不是`*`很重要（在这种情况下，标志还不够）`xxx``g`
*   `\zs`设置比赛的开始（替换什么）。
*   `xxx`最后，要替换的字符串
*   `/yyy/`将匹配替换为`yyy`
*   `g`在线上的所有事件

这给出了与使用@Kent 答案中的示例相同的结果，它将处理、`str1`和的任何顺序。 我再说一遍，如果由于某种原因一个函数不是一个替代方案，这是一个替代方案。据我了解 OP，例如，在他的情况下总是如此，所以这对于这种情况来说是一个更通用的解决方案（也许更多的学术兴趣）。`str2``str3``xxx`
`str2``str1`

# java - Java评分方法

> ID：15033866
> 
> 赞同：1
> 
> 时间：2013-02-22T21:57:16.500
> 
> 标签：java, string, loops

目前停留在确定某个国家/地区的最高分的程序上。我遇到的问题是确定如何通过用户的输入获得得分最高的国家。主要关注的是输出得分最高的国家和获得的奖牌（例如美国赢得2金1银1铜）。我只关心美国方法atm。我对我关心的领域发表了一些评论。

```
import java.util.Scanner;
class OlympicMedalsEM
{
public static void main (String[] args)
{
    Scanner kb = new Scanner(System.in);
    int winner=0;
    String countrywin;
    int gold=0, silver=0, bronze=0, count=0, num=0, sum=0;      //num as in the number of countries
    int goldscore=0, silverscore=0, bronzescore=0;
    String country;
    {
    System.out.println("Please choose a scoring method. a for American or c for Canadian. ");
    char again = kb.next().charAt(0);
        if(again == 'a')//american method
        {
            // American method counts the medals with the most score. ex: gold is worth 3, silver 2, and bronze 1.
            // USA win 3 gold 1 silver 0 bronze = 11 points so to speak.
            {
            System.out.println("Enter the number of countries competing: ");
            num = kb.nextInt();
            {
            for (int x=0; x < num; x++)
                {
                System.out.println("Enter country and medal count(from gold to bronze): ");
                country = kb.next();
                gold = kb.nextInt();
                silver = kb.nextInt();
                bronze = kb.nextInt();
                country += country; // not sure if for loops works better than while. Not even sure is country should be counted
                }
            }
                    {
                    goldscore = gold * 3;
                    silverscore = silver * 2;
                    bronzescore = bronze * 1;
                    sum = goldscore + silverscore + bronzescore;
                        winner = sum;
                        // determine the highest score for the winner(?)
                        if (sum < winner) 
                    winner = sum;
                    }
                {
                // country is String need to change to a int(?). 
                // need it to also figure out how to pick the country with the high quality of medals
                // Possibly substitute countrywin instead of country?
                    System.out.println("The winner is: " + country + " with " + gold + " gold medals," + silver + " silver medals, and " + bronze + " bronze medals.");
                }
            }
        }
        else if(again == 'c')//canadian method
        {
            // Canadian method which counts the total number of medals
            {
            System.out.println("Enter the number of countries competing: ");
            num = kb.nextInt();
            {
            while (count<=num)
                {
                System.out.println("Enter country and medal count(from gold to bronze): ");
                country = kb.next();
                gold = kb.nextInt();
                silver = kb.nextInt();
                bronze = kb.nextInt();
                // need to understand the american version first before proceding
                +=;
                }
            }
                    {
                    sum = gold + silver + bronze;
                        }
                {
                    System.out.println("The winner is: " + country + " with " + gold + " gold medals," + silver + " silver medals, and " + bronze + " bronze medals.");
                }
            }
        }
        else
        {
            System.err.println("invalid answer");
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:55:04.223

您可以尝试使用数组来存储总和值和国家/地区名称。对于您的情况，您可以使用代码。它不一定是完美的，但它确实有效。您还可以添加 try 和 catch 块，以确保当用户输入错误类型的数据（即 int 而不是 char）时程序不会崩溃。

```
 import java.util.Scanner;
 class OlympicMedalsEM
  {
    public static void main (String[] args)
      {
        Scanner kb = new Scanner(System.in);
        int goldscore=0, silverscore=0, bronzescore=0;
        String[] country;
       {
         System.out.println("Please choose a scoring method. a for American or c for Canadian.");                              
char again = kb.next().charAt(0);
    if(again == 'a')//american method
    {
        // American method counts the medals with the most score. ex: gold is worth 3,    silver 2, and bronze 1.
        // USA win 3 gold 1 silver 0 bronze = 11 points so to speak.
        {
        System.out.println("Enter the number of countries competing: ");
        int num = kb.nextInt();
        int []sum = new int[num];            // Create sum array with "num"         number of elements, each representing sum for one country
        country = new String[num];           
        {
        /** each country is saved in a string array "country" element with corresponding sum in the "sum" array */
        for (int x=0; x < num; x++)
            {
            System.out.println("Enter country and medal count(from gold to bronze): ");
            country[x] = kb.next();
            goldscore = kb.nextInt()*3;
            silverscore = kb.nextInt()*2;
            bronzescore = kb.nextInt()*1;
            sum[x]= goldscore+silverscore+bronzescore;

            }
        }       /** gets index of array "sum" with highest value element */
                int MaxIndex=0;
                for (int c=0; c<sum.length-1; c++){
                   if (sum[c+1]>sum[c]){
                   MaxIndex=c+1;
                   }
                }
                /** country with most medals is saved in the same index number as the maximum sum index */
                System.out.println(" the country with most medals is :" + country[MaxIndex]);
                }
                }

                }
                }
                } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:01:51.293

查看[优先队列](http://docs.oracle.com/javase/7/docs/api/java/util/PriorityQueue.html)
您可以使用自己的[比较器获得所需的最小值/最大值](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T22:23:32.767

如果这是家庭作业，你了解过课程吗？这看起来是使用它们的好时机。

我会创建一个国家类，其中包含每个奖牌数量和国家名称的字段。然后，您可以在该类中编写一个 sum 方法，该方法将返回该国家拥有的所有奖牌的值。然后检查当前国家与得分最高的国家之和，类似于@pattmorters 答案。

另外，我会将您的`if/else`陈述换成`switch`. （几乎是为菜单选择而制作的）。

如果这不是家庭作业，我可以给你一些示例代码。;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T22:03:40.820

像这样想。如果一个国家的奖牌数量输入少于前一个，为什么还要继续存储呢？为当前高点设置一个变量，并且仅在需要时覆盖它们。

```
int currentHigh = 0;
int noOfCountries = 10;
int input;

for(int i=0; i<noOfCountries; i++) {
    input = in.nextInt();
    if(input>currentHigh) {
        currentHigh=input;
    }
} 
```

# .net - 服务器上奇怪的 GAC 行为

> ID：15033868
> 
> 赞同：1
> 
> 时间：2013-02-22T21:57:19.077
> 
> 标签：.net

我注意到 GAC 在我们的开发服务器和我的本地机器上的奇怪行为。我签署了一个程序集并使用 MSI 文件将其放入 GAC。当我运行我的应用程序时，它会找到程序集并加载它，并且应用程序运行正常。

作为测试，我决定从 GAC 中删除程序集并重新运行我的应用程序。奇怪的是，应用程序仍然运行，却没有告诉我找不到程序集。

我确保程序集不在应用程序的 bin 文件夹中。我仔细检查了 GAC 以确保它没有真正卸载。它确实卸载了，因为 GAC 文件夹中缺少程序集。除了在名为 c:\Windows\Assembly\temp\GPFPFRGYT 的奇怪文件夹中之外，服务器上没有程序集的踪迹。那么，当我清楚地看到它不再在 GAC 中时，为什么我的应用程序仍然在找到程序集（我使用的是 .NET 4.0，所以它在 C:\Windows\Microsoft.NET\assembly 中）。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:12:12.287

我会删除 dll 的所有副本，包括您提到的临时文件中的那个。

通过使用以下方法卸载 GAC dll 总是值得的：

GacUtil -u 你的DLL文件名

注意：将上述命令与 YourDLLFileName 一起使用时，您不必使用扩展名 .dll

我不是 100% 确定您需要这样做，但是一旦卸载了 .dll，我也会重新启动服务器。

我希望这有帮助

# sql - 是否可以自定义 SSRS 订阅中的参数值？

> ID：15033873
> 
> 赞同：2
> 
> 时间：2013-02-22T21:57:25.957
> 
> 标签：sql, sql-server, tsql, reporting-services

我有一个 SSRS 2008 报告，其中默认参数值为：

```
<ReportParameter Name="BegDate">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>=DateAdd("D",-13,DateAdd("D",6-(Weekday(Today)),Today))</Value>
        </Values>
      </DefaultValue>
      <Prompt>BegDate</Prompt>
    </ReportParameter>
    <ReportParameter Name="EndDate">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>=DateAdd("D",-7,DateAdd("D",6-(Weekday(Today)),Today))</Value>
        </Values>
      </DefaultValue> 
```

我正在尝试创建对此报告的订阅，但在此处传递不同的参数值：

![在此处输入图像描述](../Images/5aa9af45bc6d3663090bc570a0f43832.png)

我怎样才能做到这一点？我可以在这些文本框中输入公式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T22:02:21.690

您需要数据驱动订阅：仅在 SQL Server 企业版中找到：

[http://msdn.microsoft.com/en-us/library/ms159150.aspx](http://msdn.microsoft.com/en-us/library/ms159150.aspx)

我之前在一家没有资金（嗯……太便宜了）无法获得企业版的公司工作。我最终编写了一个非常酷的 Windows 服务，它通过 SSRS 进行身份验证，然后使用这种技术发送报告：

[http://msdn.microsoft.com/en-us/library/ms155391.aspx](http://msdn.microsoft.com/en-us/library/ms155391.aspx)

# android - 片段旋转不恢复当前片段

> ID：15033876
> 
> 赞同：0
> 
> 时间：2013-02-22T21:57:38.550
> 
> 标签：android, android-fragments, android-fragmentactivity

我有一个从片段 A 开始的片段活动，然后可以更改为片段 B。如果我在片段 B 上并且我旋转我的设备。它加载了原始的片段 A 而不是片段 B。我正在务实地加载片段 A 和 B。我认为android应该自动保存我所在的片段我没有覆盖onSaveInstanceState

这就是我加载片段的方式

```
FragmentTransaction t = this.getSupportFragmentManager()
            .beginTransaction();
    t.replace(R.id.fragholder, new MainFragment());
    t.commit(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:16:32.257

当您旋转设备时，它会破坏您的 Activity 并重新创建它。因此，假设 Fragment A 是默认 Fragment，那么在重新创建 Activity 时它会加载它是合乎逻辑的。因此，您需要覆盖 onSaveInstanceState 以存储可见的 Fragment，然后在 onCreate 中重新加载该 Fragment。

参考相关活动生命周期文档：http: [//developer.android.com/training/basics/activity-lifecycle/recreating.html](http://developer.android.com/training/basics/activity-lifecycle/recreating.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:01:01.720

只需将 android:configChanges="orientation|screenSize" 添加到您的清单中，android 就会为您处理一切

# ios - Contre Jour 应用程序中的菜单

> ID：15033879
> 
> 赞同：0
> 
> 时间：2013-02-22T21:57:44.010
> 
> 标签：ios, objective-c, core-animation, calayer

我正在尝试制作一个类似于“Contre Jour”游戏的菜单，当用户左右拖动时，3 个元素会旋转一圈。我正在使用带有 CATransforms 的 CALayers 将它们定位在 3d 旋转轮中（到目前为止没有问题）。

我需要一种方法（也许使用 NSTimers？）来计算中间值，因为 CoreAnimation 只是插入值，但如果你 NSLog 它们，它只会显示开始和结束，或者只是结束。我需要所有中间值，当我在一个位置（有 3 个元素，每个元素应该是 120 度）释放手指（触摸末端）时，我需要捕捉轮子的移动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T23:43:29.047

查看 CADisplayLink。这与 NSTimer 非常相似，只是它的刷新率与显示器的刷新率相关，因此您的动画将比使用计时器更流畅。这将允许您计算所有中间值并更新您的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:13:50.137

我的猜测并且我很确定我是正确的，他们正在使用诸如 Unity3D 或 Cocos2D 之类的游戏引擎或许多其他引擎来管理他们的精灵、动画、纹理、物理以及基本上所有内容。试图在游戏引擎之外复制它很可能会导致糟糕的性能和大量的头发拉扯。我建议研究一个专门的游戏引擎并在那里试一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T22:25:30.023

我不确定我是否完全理解 Contre Jour 对纺纱机的作用，无论如何，我认为对您的情况而言，一种合理的方法是使用 a`UIPanGestureRecognizers`根据平移来更新纺车的状态。

现在，尚不清楚您要为纺车设置动画效果（如果您可以提供一些代码，这将有助于准确理解您要做什么），但想法是这样的：而不是远距离指定动画结束点远离起点（让 Core Animation 为您完成所有处理，即使拖动已停止），您只会以较小的增量修改旋转轮的状态。

如果您唯一的问题是在拖动停止时停止动画，您可以尝试调用 `removeAnimationForKey`您的图层以停止特定动画。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T21:19:37.670

我不清楚您在问什么，但我确实对您有一个见解：要获取飞行中动画的中间值，请查询图层的 presentationLayer 属性。正在动画的属性将具有一个非常接近您获取该值时它在屏幕上的外观的值。

# mysql - Mysql删除与加入和限制

> ID：15033881
> 
> 赞同：2
> 
> 时间：2013-02-22T21:57:48.303
> 
> 标签：mysql, sql

我有这个查询：

```
DELETE `LINK_LA_TYP` 
FROM `LINK_LA_TYP` 
JOIN `LINK_ART` ON `LINK_LA_TYP`.LAT_LA_ID = `LINK_ART`.LA_ID 
JOIN `ARTICLES` ON `LINK_ART`.LA_ART_ID = `ARTICLES`.ART_ID 
WHERE (`ARTICLES`.ART_SUP_ID in (10008,10439,11005,10097,10669,11100,80,10912,10683,10675,10194,11196,1166,10730,10248,10870,11200,11059,247,10121,10911,489,10724,496,10093,10205,1318,10953,11199,11047,128,114,194,10865,11058,10345,1286,10667,10064,11077,10622,11205,10917,10344,495,10709,10954,10744,304,10957,10447,10764,10129,10862,10918,10731,11115,10095,10859,10580,1345,10177,10323,144,11182,10132,256,10941,58,10006,10017,10780,10765,10665,11110,10714,10224,750,10267,10179,10725,10774,11063,10868,10103,10676,10057,10649,255,10322,11022,309,10754,11121,10801,10018,11004,10245,146,11056,381,10781,10699,11120,11126,830,10240,11162,10436,10584,10342,10861,11190,10721,11171,10564,10545,94,10087,73,10755,10869,10547,10706,10346,444,426,10059,153,122,10674,64,113,11101,10231,10337,806,11117,10385,251,11188,491,11192,100,10792,10069,10864,11099,10246,10178,10758,10568,10230,10124,10384,10782,10726,384,10670,305,10763,10768,10585,10394,10552,498,10677,1348,168,10814,10582,10382,11093,11173,10381,427,441)) limit 50000; 
```

但为什么我会收到错误消息？

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“限制 50”附近使用正确的语法

怎么了？以及如何限制删除查询条目的删除？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T22:00:35.250

从[手册](http://dev.mysql.com/doc/refman/5.0/en/delete.html)：

> 对于多表语法，DELETE 从每个 tbl_name 中删除满足条件的行。在这种情况下，不能使用 ORDER BY 和 LIMIT。

您最好`SELECT`使用所述限制删除要删除的 id，然后删除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:00:17.427

如果您尝试使用连接删除，则需要检查[DELETE的语法，您最好在更新时使用 CASCADE 创建表。](http://dev.mysql.com/doc/refman/5.0/en/delete.html)

# ruby-on-rails - 我的 Rails 应用程序如何从 S3 下载文件？

> ID：15033882
> 
> 赞同：0
> 
> 时间：2013-02-22T21:57:49.397
> 
> 标签：ruby-on-rails, ruby-on-rails-3, amazon-s3

我有一个应用程序，用户可以将文件直接上传到 S3。这是有效的。现在，我需要一个后台工作人员（目前为delayed_job）来检索文件并将其存储在“tmp/files”中进行处理。

如何才能做到这一点？

编辑：该应用程序目前正在 EC2 中运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:59:20.410

后台工作人员将独立于您的 Web 应用程序运行。

尝试使用[Resque](http://railscasts.com/episodes/271-resque)获取常用的 Rails 后台工作程序解决方案。这个想法是你独立于你的 web 应用程序启动 Resque，它的工作独立于应用程序。

让这个工作人员向 S3 发送基本的 HTTP 请求。这是一个[API 参考卡](http://awsdocs.s3.amazonaws.com/S3/latest/s3-qrc.pdf)，可帮助您入门。这个想法是您使用某种 Ruby REST 客户端来发送这些请求，并解析您从 S3 获得的响应。[Rest-client](https://rubygems.org/gems/rest-client)是一个可以用来执行此操作的 gem。

或者，您也可以让工作人员使用[S3 gem](http://amazon.rubyforge.org/)，这可能会更容易一些。

使用这种方法，您可以让您的工作人员运行一个执行类似操作的脚本

`picture = S3Object.find 'headshot.jpg', 'photos'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:11:01.393

使用 Resque。

添加

```
gem 'resque'
gem 'resque-status' 
```

使用 Resque，您需要 Redis（存储有关工作人员的信息）或者使用 Redis-to-go，或者在您的 EC2 机器上本地安装 Redis。

所以在安装 Resque 后编辑 config/initializers/resque.rb

```
rails_root = ENV['RAILS_ROOT'] || File.dirname(__FILE__) + '/../..'
rails_env = ENV['RAILS_ENV'] || 'production'
resque_config = YAML.load_file(rails_root + '/config/resque.yml')
Resque.redis = resque_config[rails_env]

    # This is if you are using Redis to go:
    # ENV["REDISTOGO_URL"] ||= "redis://REDISTOGOSTUFFGOESHERE"
    # uri = URI.parse(ENV["REDISTOGO_URL"])
    # Resque.redis = Redis.new(:host => uri.host, :port => uri.port, :password => uri.password, :thread_safe => true)

Resque::Plugins::Status::Hash.expire_in = (24 * 60 * 60) # 24hrs in seconds

Dir["#{Rails.root}/app/workers/*.rb"].each { |file| require file } 
```

这里我们使用的是本地 Redis，所以 resque.yml 看起来像这样：

```
development: localhost:6379
test: localhost:6379
fi: localhost:6379
production: localhost:6379 
```

你需要像上帝一样的东西来启动/管理工人

所以安装它然后将“resque-production.god”添加到你的应用程序的config/文件夹你将能够通过这个启动你的worker：god -c config/resque-production.god config/resque-production.god 文件将有类似的东西：

```
rails_env   = ENV['RAILS_ENV']  || "production"
rails_root  = ENV['RAILS_ROOT'] || File.dirname(__FILE__) + '/..'
num_workers = 1

num_workers.times do |num|
  God.watch do |w|
    w.dir      = "#{rails_root}"
    w.name     = "resque-#{num}"
    w.group    = 'resque'
    w.interval = 30.seconds
    w.env      = {"QUEUE"=>"*", "RAILS_ENV"=>"production"}
    w.start    = "rake -f #{rails_root}/Rakefile environment resque:work --trace"
    w.log      = "#{rails_root}/log/resque.log"
    w.err_log  = "#{rails_root}/log/resque_error.log"

    # restart if memory gets too high
    w.transition(:up, :restart) do |on|
      on.condition(:memory_usage) do |c|
        c.above = 350.megabytes
        c.times = 2
      end
    end

    # determine the state on startup
    w.transition(:init, { true => :up, false => :start }) do |on|
      on.condition(:process_running) do |c|
        c.running = true
      end
    end

    # determine when process has finished starting
    w.transition([:start, :restart], :up) do |on|
      on.condition(:process_running) do |c|
        c.running = true
        c.interval = 5.seconds
      end

      # failsafe
      on.condition(:tries) do |c|
        c.times = 5
        c.transition = :start
        c.interval = 5.seconds
      end
    end

    # start if process is not running
    w.transition(:up, :start) do |on|
      on.condition(:process_running) do |c|
        c.running = false
      end
    end
  end
end 
```

最后是工人。他们进入 app/workers/ 文件夹（这里是 app/workers/processor.rb）

```
class Processor
  include Resque::Plugins::Status
  @queue = :collect_queue

  def perform
    article_id = options["article_id"]
    article = Article.find(article_id)
    article.download_remote_file(article.file_url)
  end
 end 
```

它由 Article 模型中的回调触发 (app/models/article.rb)

```
class Article < ActiveRecord::Base

  after_create :process

  def download_remote_file(url)
    # OpenURI extends Kernel.open to handle URLs as files
    io = open(url)

    # overrides Paperclip::Upfile#original_filename;
    # we are creating a singleton method on specific object ('io')
    def io.original_filename
      base_uri.path.split('/').last
    end

    io.original_filename.blank? ? nil : io
  end     

def process
    Processor.create(:article_id => self.id)
  end

end 
```

# mysql - 在mysql命令行中恢复数据库

> ID：15033887
> 
> 赞同：3
> 
> 时间：2013-02-22T21:58:21.297
> 
> 标签：mysql, mysqldump

我已经从一台服务器上备份了一个数据库，并试图在另一台服务器上恢复它。

mysql版本是5.5

当我尝试使用以下命令恢复数据库时， screen -r

```
mysql -u root -p password mydb < mydump.sql
ERROR 1005 (HY000) at line 356: Can't create table 'mydb.mytable' (errno: 150) 
```

我知道这是外键约束问题。转储文件里面有以下语句。

```
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */; 
```

但它仍然失败。我的 dumo 文件非常大，因此无法打开和编辑。所以我可以直接在mysql命令行中设置它而不是添加`SET FOREIGN_KEY_CHECKS=0;`转储，如下所示？

```
mysql> SET FOREIGN_KEY_CHECKS=0;
...
mysql> source "mydump.sql";
...
mysql> SET FOREIGN_KEY_CHECKS=1; 
```

它会起作用吗？我的数据库重新加载需要几个小时才能完成。所以我在花费数小时之前在这里寻求帮助。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:58:29.340

通常，我只会输入 2 个 sql 文件——首先，一个带有 . 的单行`SET FOREIGN_KEY_CHECKS=0;`文件，然后是转储文件。您不必担心将其放回原处；它只会持续到当前会话（加载文件后将终止）。

`sed -i 1i"SET FOREIGN_KEY_CHECKS=0;" dump.sql`仅供参考，如果您想永久添加此行而不用视觉编辑文件，您也可以使用。

# php - 如何在 Wordpress 中检查 body_class() 中的类

> ID：15033888
> 
> 赞同：17
> 
> 时间：2013-02-22T21:58:28.910
> 
> 标签：php, wordpress

在 Wordpress header.php 中，我有

```
<body <?php body_class($class); ?>> 
```

如何检查特定类是否存在，然后加载标记作为结果？例如。

```
<body class"home logged-in">

<?php if $class == 'home' ?>
    <div class="home"></div>
<? else : ?>
    <div class="internal-page"></div>
<? endif; ?> 
```

谢谢！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-02-22T22:28:29.930

如果你真的，真的需要根据`body_class`类使用不同的标记，那么使用[`get_body_class`](http://codex.wordpress.org/Function_Reference/get_body_class)

```
$classes = get_body_class();
if (in_array('home',$classes)) {
    // your markup
} else {
    // some other markup
} 
```

但是可能有更好的方法可以做到这一点，例如@Rob 对[Conditional Tags](http://codex.wordpress.org/Conditional_Tags)的建议。这些映射非常接近`body_class`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:12:30.850

您可以使用`body_class`过滤器访问，`add_filter('body_class', function ...)`但是我认为您采用了错误的方法。为什么不只使用 css 来满足您的需要？例如，`.home>div { /* home styles */ }`

或者您可以加载不同的样式表

```
add_filter('body_class', function($classes) {
    if (in_array('home', $classes)) {
        wp_enqueue_style('home');
    }
    return $classes;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-03T10:47:04.200

我遇到了同样的问题，因为我使用不同的模板创建了页面，但是每个页面上的自定义子菜单需要相同。

我首先尝试了这个，但失败了

`<body <?php body_class( 'extra-class' ); ?>>`

额外的类被添加到 body 标记中，但是当我运行错误日志时，它不在类数组中。所以我确信它后来被添加到body标签中。

这个解决方案对我有用：

`functions.php`

`$GLOBALS['extraBodyClass'] = '';`

在模板文件中

`<?php $GLOBALS['extraBodyClass'] = 'extra-class' ?>`- 模板文件的第一行

`<body <?php body_class( $GLOBALS['extraBodyClass'] ); ?>>`- 在模板名称声明之后

在`header.php`文件中

```
$classes = get_body_class();
if($GLOBALS['extraBodyClass']){
   $classes[] = $GLOBALS['extraBodyClass'];
} 
```

# c - 命名管道短读（matlab->linux）

> ID：15033897
> 
> 赞同：0
> 
> 时间：2013-02-22T21:58:54.237
> 
> 标签：c, linux, matlab, named-pipes

我正在编写一些代码，这些代码期望通过命名管道（例如“/tmp/named_pipe_0”）从 Matlab 程序发出消息。我可以得到管道 mkfifo 并打开 find，但是当 C 程序从管道转到 read() 时，而不是预期的 5004 字节，我会得到短值，如 4096、904、5000、4096 等。我已经已经验证 Matlab 应该发送正确的 5004 字节（至少，它被告知），所以我想知道原因是什么。以前有人遇到过这样的事情吗？

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:06:25.697

这是意料之中的，只要有东西可用，对管道/套接字/命名管道的读取就会给您返回数据。

如果您需要读取 5004 字节，您将在一个循环中执行此操作，该循环将您自己的缓冲区附加到您获得那么多字节（或发生错误或 eof）

例如

```
size_t readn(int fd, void *buf, ssize_t len)
{
    ssize_t tot = 0;
    unsigned char *p = buf;

    while (tot != len) {
       ssize_t r = read(fd, p + tot, len - tot);
       if (r == 0) //premature end of reading
           break;
       else if (r == -1) //error
          return -1
       tot += r;
    }

   return tot;
}

...
char buf[5004];
if (readn(pipe_fd, buf, sizeof buf) != sizeof buf) {
   // something went bad
} else {
   //got all the 5004 bytes
} 
```

# javascript - JS进入页面和刷新页面的区别

> ID：15033899
> 
> 赞同：3
> 
> 时间：2013-02-22T21:58:57.660
> 
> 标签：javascript, browser

是否可以检测**进入页面和****刷新**同一页面时的情况

 **```
if (entered) alert("hi");
if (refreshed) alert("you've refreshed"); 
```

不知何故，页面渲染在输入时和刷新时之间存在一些细微差别，检测这种情况比为我调试它要容易得多（如果它甚至可能的话——也许是一些浏览器优化的东西导致了它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T23:06:05.647

这不是一个理想的解决方案，但如果您的页面可以在 5 秒内加载，那么这将起作用，并且假设您没有导航到另一个页面，然后在 5 秒内返回。

```
window.onbeforeunload = function(){
  window.sessionStorage.setItem('lastvisit', new Date().getTime());
}

var lastVisit = +window.sessionStorage.getItem('lastvisit');

var isRefresh = (new Date().getTime() - lastVisit) < 5000;
console.log(isRefresh); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T23:40:59.173

没有完美的方法来跟踪重新加载和新页面加载，但这种解决方案在大多数情况下都有效。将 sessionStorage 与卸载事件结合使用：

```
(function (win) {
  'use strict';
  var reloaded = false,
    ss = win.sessionStorage,
    offset = 1000, // 1 second, may need tweaking if
    // your page takes a long time to load/where
    // this code is located in your page
    now = function () {
    return (new Date()).getTime();
    },
    lastUnload = ss.getItem('lastunload'),
    loadStatus = document.getElementById('status');

  // sessionStorage returns null if nothing was stored
  if (lastUnload !== null) {
    // sessionStorage returns a string, +lastUnload
    // coerces the string held in lastUnload into an integer
    // see https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators#-_.28Unary_Negation.29
    if (+lastUnload + offset > now()) {
        reloaded = true;
    }
  }

  win.addEventListener('unload', function () {
    ss.setItem('lastunload', now());
  }, false);

  if (lastUnload === null) {
    loadStatus.innerHTML = 'First visit of session.';
  } else if (reloaded) {
    loadStatus.innerHTML = 'Page was reloaded.';
  } else {
    loadStatus.innerHTML = 'Navigated back to page after leaving';
  }

}(window)); 
```

此代码将页面重新加载定义为在离开页面后 1 秒内返回页面，因此如果有人离开页面并立即点击后退按钮但实际上不应该发生正常浏览行为，则可能会出现误报。如果您想给予更多或更少的余地，您可以修改该`offset`变量，但 1 秒似乎是一个不错的默认值。

开发此代码后，我也找到了[类似的答案](https://stackoverflow.com/questions/568977/identifying-between-refresh-and-close-browser-actions/13916847#13916847)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-22T22:09:01.437

如果`sessionStorage`可用，您可以使用它。

```
if (!window.sessionStorage.getItem('visited')) {
    //entered
    window.sessionStorage.setItem('visited', true);
}
else {
    //refreshed
} 
```

[更多关于`sessionStorage`](http://www.w3.org/TR/webstorage/#the-sessionstorage-attribute)**

# dynamics-crm-4 - 如何在 CRM 动态 4.0 上更新工作流中的查找值

> ID：15033901
> 
> 赞同：1
> 
> 时间：2013-02-22T21:59:12.437
> 
> 标签：dynamics-crm-4

我想更新工作流中的查找值，所有查找记录都包含一个唯一字段。

我们是否可以安排使用 Workflow 中查找的唯一值更新实体记录的查找字段值。

建议我不应该进行插件开发和 Web 应用程序开发的方式。

请您建议我使用 CRM Dynamics 4.0 下的工作流来实施此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T10:44:14.577

是的，您可以通过工作流设计器将查找字段设置为特定记录。

# php - 提取标签之间文本但不提取标签的正则表达式

> ID：15033905
> 
> 赞同：3
> 
> 时间：2013-02-22T21:59:22.360
> 
> 标签：php, regex, preg-match, preg-match-all

我想编写一个正则表达式来提取`<title>`字符串中两个标签之间的内容，而不是标签。IE 我有以下

```
<title>My work</title>
<p>This is my work.</p> <p>Learning regex.</p> 
```

正则表达式

```
(<title>)(.*?)(<\/title>) 
```

提取`<title>My work</title>`但我只想提取`My work`. 我怎样才能做到这一点？这是示例[http://regex101.com/r/mD8fB0的链接](http://regex101.com/r/mD8fB0)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T23:04:00.817

您可以使用以下正则表达式：

```
>([^<]*)< 
```

或者，>[^<]*<

然后消除不需要的字符，如 '<' & '>'

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-22T15:09:03.807

最好的方法是使用断言，对于您的情况，正则表达式将是：

```
(?<=\<title\>).*?(?=\<\/title\>) 
```

有关更多详细信息，请查看[**此处**](http://php.net/manual/en/regexp.reference.assertions.php)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-22T22:09:24.687

在您的情况下，您可以只使用正则表达式中的第二个反向引用，它将保存您感兴趣的文本。

既然你`preg_match`在标签中提到，我假设你想要这个用于 PHP。

```
$matches = array();
$pattern = '#<title>(.*?)</title>#'; // note I changed the pattern a bit
preg_match($pattern, $string, $matches);
$title = $matches[1]; 
```

请注意，这实际上是我的模式中的第一个反向引用，因为我省略了标签本身周围的括号，这是不需要的。

通常，您不应该使用正则表达式来解析 HTML 文档，但我认为这可能是其中一种例外情况，情况还不错，因为标题标签应该只在页面上存在一次。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-30T21:05:08.863

我用它作为正则表达式的替换函数： (<.+?>)

# ios - 如何创建与视图边界不同的可访问性框架？

> ID：15033906
> 
> 赞同：7
> 
> 时间：2013-02-22T21:59:26.307
> 
> 标签：ios, accessibility, voiceover

我实际上知道如何做到这一点，但我这样做的方式让我想到了两个真正的问题。首先，我在 UIButton 子类中更改此框架，如下所示：

```
- (CGRect)accessibilityFrame {
    CGRect rect = [self.superview convertRect:self.frame toView:nil];
    rect.size.width *= 5;
    return rect;
} 
```

如果我省略了这个方法的第一行，那么这个按钮的可访问性框架会出现在屏幕的绝对左上角，而不管它的原始位置。我发现用于覆盖可访问性框架的所有代码示例都使用了坐标转换的一些变体，但我完全不明白为什么。为什么不能在与视图框架相同的坐标系中处理此属性，因为这会使修改可访问性框架变得非常简单？

我的第二个问题与打开 VoiceOver 的情况下这个可访问性框架的实际功能有关。当我以这种方式修改可访问性框架时，焦点矩形会按预期变大。不幸的是，这种效果似乎纯粹是装饰性的。即使焦点矩形现在比按钮本身大得多，我仍然只能通过在按钮边界内正确点击来将焦点应用于按钮；如果我在焦点矩形内部但在按钮本身之外点击，则不会发生任何事情。这对我来说是个大问题，因为我正在尝试扩展一些控件的“虚拟”大小，这些控件非常小，除非你能看到它们，否则它们很难实际点击。如果视力受损的用户可以，我根本不理解让焦点矩形在外观上更大的意义

**编辑：**添加这个位就可以了：

```
- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
    CGPoint newPoint = [self.superview convertPoint:point toView:nil];
    return CGRectContainsPoint(self.accessibilityFrame, newPoint);
} 
```

我仍然很想知道为什么这样的事情甚至是必要的。

**编辑 2：**上面的代码仅在特殊情况下有效（在多个嵌套子视图内）。更通用的解决方案是：

```
- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
    CGPoint newPoint = [self convertPoint:point toView:nil];
    return CGRectContainsPoint(self.accessibilityFrame, newPoint);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T23:50:06.933

可访问性框架在屏幕坐标中指定（[参见文档](http://developer.apple.com/library/ios/documentation/uikit/reference/UIAccessibility_Protocol/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008786-CH1-SW12)）。

转换

```
-[UIView convertRect:toView:] 
```

如果 toView 为 nil，则将视图坐标转换为窗口坐标。

为了 100% 正确，从窗口到屏幕坐标的额外转换使用

```
-[UIWindow convertPoint:toWindow:] 
```

（再次，使用 nil toWindow）将是必需的。

现在，您可能已经知道需要在 VoiceOver 光标内双击才能触发按钮的操作。默认情况下，双击会点击辅助框架的中心。但是，如果您修改的辅助功能框架的中心不在您的按钮上，则不会发生任何事情。方便的是，该`accessibilityActivationPoint`方法允许您将该中心放在其他地方（例如，就在按钮的实际中心上）。同样，不要忘记转换为屏幕坐标。

在你开始制作巨大的辅助框架之前要考虑的一件事：如果你有非常小的按钮，普通用户也可能很难点击它们。考虑使它们（或至少它们响应触摸的区域）更大。[Apple 建议](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/Characteristics/Characteristics.html)至少 44 x 44 点。

# asp.net - 将按钮对齐到顶部

> ID：15033908
> 
> 赞同：0
> 
> 时间：2013-02-22T21:59:31.330
> 
> 标签：asp.net, css, ajax, tabcontainer

我正在使用一些 AJAX 功能在 .net 中构建 webapp；在这种情况下，它是 TabContainer。

下面是我想玩的区域的截图。左侧的菜单是 TabContainer 的选项卡。右侧是标签的内容。我希望“更新 PCR”按钮位于“受影响的学科”下方。问题是左右两边是ONE块的一部分，也就是TabContainer。

对于如何格式化按钮的 CSS 以在 TabContainer 的菜单下方对齐是否有任何建议？我可以将按钮添加为菜单的一部分，但是，然后我必须将控件设置为 AutoPostback，这首先在这种情况下破坏了它的目的......任何建议将不胜感激！

![截屏](../Images/5fa0fc89c47e59e0e79d2252057b6daa.png)

编辑：

这是现有的 CSS

```
.ajax_tabController .ajax__tab_tab
{
    background-color: #3c6f91;
    padding: 5px;
    border: 1px solid #ffffff;
    color:#ffffff;
    border-left: 3px solid #5AB0DB;
}

.ajax_tabController .ajax__tab_hover .ajax__tab_tab
{
    background-color:#5AB0DB;
    text-decoration:none;
}

.ajax_tabController .ajax__tab_active .ajax__tab_tab
{
    background-color:#5AB0DB;
    text-decoration: underline;
} 
```

此外，还有一些 CSS 会覆盖一些设置以使 TabContainer 垂直而不是水平。我知道，有一个属性 .UseVerticalStripPlacement 但它与控件的高度混淆并引发 JavaScript 错误。

```
.ajax__tab_header
        {
            float: left;
        }
        .ajax__tab_body
        {
            margin-left: 160px;
        }
        .ajax__tab_outer
        {
            display: block !important;
        }
        .ajax__tab_tab
        {
            width: 210px;
            height: auto !important;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T00:32:30.000

您需要相对于选项卡元素的底部定位按钮的顶部。这可以用 jquery 来完成。请参阅[如何使用 jQuery 相对于另一个元素定位一个元素？](https://stackoverflow.com/questions/158070/jquery-how-to-position-one-element-relative-to-another)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:36:38.567

这会有点失败，但请尝试以下方式：

```
.updatePcrButton {
    position: absolute;
    top: 100px;   /* These will be whatever the measurement is to */
    left: 5px;    /* be directly under the last element */
    z-index: 99;  /* Arbitrary amount to put it above any other elements */
} 
```

老实说，这非常混乱 - 它依赖于您此后不更改控件的位置。

也许更好的方法是添加一个额外的选项卡`TabContainer`并自己处理任何选项卡点击。

-- 编辑 -- 可能更有用 --

Nikita，我完全忘记了这一点，因为它是在我的一个旧的 Classic ASP 应用程序中，但你可以尝试这两个可能对你更有用的 JS 函数：

```
function curTop(obj){
rv = 0;
while(obj) {
    rv += obj.offsetTop;
    obj = obj.offsetParent;
}
return rv;
}
function curLeft(obj){
rv = 0;
while(obj) {
    rv += obj.offsetLeft;
    obj = obj.offsetParent;
}
return rv;
} 
```

他们从指定的对象中拉出位置。如果您添加要放置在下方的按钮的高度，那么您可能会发现这会改善您的位置并防止使用 CSS 进行任何有趣的业务。

亲切的问候，韦斯蒂。

# javascript - 服务器无法识别客户端发送的特殊字符

> ID：15033910
> 
> 赞同：0
> 
> 时间：2013-02-22T21:59:36.150
> 
> 标签：javascript, .net, query-string, special-characters

在我的 C#.NET Web 应用程序中，使用 IE8，我使用 javascript 将特殊字符（¿、«、»）插入到 URL 查询字符串中，然后由服务器代码解析。但是，服务器似乎无法识别这些字符，并将它们读取为 ��。我的脚本标签如下所示：

```
 <script type="text/javascript" charset="UTF-8"> 
```

下面说明了我正在尝试使用 javascript 完成的任务。

```
 window.open('../../CommonPages/Email.aspx?specialChar1=¿&specialChar2=«&specialChar3=»', 'EmailSearch', 'status=1,width=605,height=605,modal=1'); 
```

我错过了什么？非常感谢所有帮助，谢谢！

# embedded - 位被加扰

> ID：15033912
> 
> 赞同：2
> 
> 时间：2013-02-22T21:59:44.027
> 
> 标签：embedded, serial-port, pic, uart

问题：我将一个值发送到 UART，而另一个 UART 上出现空值。

- - 细节 - -

这些都是 PIC 处理器（PIC24 和 PIC32）

它们都硬连线到印刷电路板上。

它们通过其中一个 UART 模块进行通信。

它们（表面上；根据文档）都配置为 115200 bps，8-N-1

没有握手，没有启用 CTS，没有启用 RTS；我只是把字节放在线上，然后它们就出来了。

（这些是简短的 4 字节命令和响应，非常适合）

PIC32 的频率为 80 MHz。

PIC24 的 F[cy] = 14745600

即，它是 14.7456 MHz

PIC24 发送四个字节（一个特定的命令序列）

当我在 UART 的中断服务程序中设置断点时，PIC32 显示空值，然后我看到在前四个断点上重复命中（PIC32 代码），并且我继续看到空值（因为 PIC24没有发送任何东西）

即，UART 似乎在没有原因的情况下重复产生中断

我没有在 PIC32 端编写代码，我每天都在学习它是如何工作的。

然后我让代码运行，我不可避免地会在一行上写着

```
 52570 1D01_335C 9D01_335C  _general_execption_handler  sdbbp 0x0 
```

当我到那的时候，

*   原因寄存器持有`0080181C`
*   EPC 寄存器持有`9D00F228`
*   SP寄存器持有`9F8FFFA0`

这就像发条一样发生，所以我对不会停止的 __ISR 产生了怀疑。MpLab向我展示了这个......

```
 432:
           433:                 //*********************************************************//
           434:                 void __ISR(_UART1_VECTOR, ipl5) IntUart1Handler(void)   //MCU communication port
           435:                 {
           9D00F204  415DE800   rdpgpr      sp,sp
           9D00F208  401A7000   mfc0        k0,EPC
           9D00F20C  401B6000   mfc0        k1,Status
           9D00F210  27BDFF88   addiu       sp,sp,-120
           9D00F214  AFBA0074   sw          k0,116(sp)
           9D00F218  AFBB0070   sw          k1,112(sp)
           9D00F21C  7C1B7844   ins         k1,zero,1,15
           9D00F220  377B1400   ori         k1,k1,0x1400
           9D00F224  409B6000   mtc0        k1,Status
           9D00F228  AFBF0064   sw          ra,100(sp) ;<<<-------EPC register always points here
           9D00F22C  AFBE0060   sw          s8,96(sp)
           9D00F230  AFB9005C   sw          t9,92(sp)
           9D00F234  AFB80058   sw          t8,88(sp)
           9D00F238  AFAF0054   sw          t7,84(sp)
           9D00F23C  AFAE0050   sw          t6,80(sp)
           9D00F240  AFAD004C   sw          t5,76(sp)
           9D00F244  AFAC0048   sw          t4,72(sp)
           9D00F248  AFAB0044   sw          t3,68(sp)
           9D00F24C  AFAA0040   sw          t2,64(sp)
           9D00F250  AFA9003C   sw          t1,60(sp)
           9D00F254  AFA80038   sw          t0,56(sp)
           9D00F258  AFA70034   sw          a3,52(sp)
           9D00F25C  AFA60030   sw          a2,48(sp)
           9D00F260  AFA5002C   sw          a1,44(sp)
           9D00F264  AFA40028   sw          a0,40(sp)
           9D00F268  AFA30024   sw          v1,36(sp)
           9D00F26C  AFA20020   sw          v0,32(sp)
           9D00F270  AFA1001C   sw          at,28(sp)
           9D00F274  00001012   mflo        v0
           9D00F278  AFA2006C   sw          v0,108(sp)
           9D00F27C  00001810   mfhi        v1
           9D00F280  AFA30068   sw          v1,104(sp)
           9D00F284  03A0F021   addu        s8,sp,zero 
```

我更仔细地查看了这些数字，我发现当时，如果我们将 100 (0x64) 加到 FFA0（SP 的底部 16 位），我们得到 0x10004，我猜这个数字是 4 太多了。

PIC 手册 DS61143E 第 50 页说该命名法意味着，`SW Store Word Mem[Rs+offset> = Rt`其他专家告诉我原因寄存器告诉我 EXCCODE 位是 7，这是加载或存储时总线异常的代码。

或者，我在这里完全猜测（希望获得一些专家的知识）某些东西没有清除某些东西，我在 int 处理程序上遇到了无限递归。

所有这些都开始变得有意义了。

# 问题

有人可以建议像这样的 int 反复打击我的最常见原因吗？

有没有人看到来自 UART 的虚假 nuls 之间的任何共同关系，这可能以某种方式与这个无休止生成的 int 相关联？我什至走在正确的轨道上吗？

在您的回答中，请告诉我如何从 UART 确认 Int。我知道我是如何在 PIC24 中做到这一点的（我完全用 ASM 编写了该代码），但我不知道这是如何在 PIC32 上的 C 语言中完成的。组装会好的。我会内联它。我正在使用我没有在这里编写的代码，感谢您的回答

UART（在这种情况下为#1）会重复产生中断的最常见原因是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T08:39:26.413

在许多设备上，必须明确清除中断以防止 ISR 在完成后简单地重新进入。

在大多数情况下，UART 将具有指示中断源的状态位，知道这可能会告诉您一些事情，但不告诉我们会很难为您提供帮助。您可以直接在调试器中检查 UART 寄存器，但是在某些设备中，读取位的行为实际上可能会清除位，在调试器中也是如此，因此请注意这种可能性（检查数据表/用户手动的）。

一些 UARTS 要求明确关闭其发送器以停止发送空值，而另一些 UARTS 在数据放入 tx 寄存器时自动触发，并在移出必要数量的位后停止。再次检查零件的数据表/手册。如果已知 PIC32 代码可以正常工作，那么由于 PIC24 代码可能出现此错误，因此它似乎很合适。您可以通过在 PIC24 的 Tx 线上使用示波器来简单地检查这一点，如果它正在发送，您将至少看到开始/停止位转换（帧）。如果什么都没有，那么问题很可能出在 PIC32 端。

当您有示波器时，您可以检查位时序是否正确，并且您实际上在 115200 传输。很容易弄错时钟，这应该是您的第一个检查。如果波特率不正确，PIC32 可能会产生帧错误中断，如果不加以处理，可能会无限期地持续存在。

另一种可能性是在传输后 PIC24 使线路处于“中断”状态，而 PIC32 UART 正在生成“线路中断”中断。这就是为什么查看 UART 状态寄存器以确定中断原因很重要的原因。

如您所见，有很多可能性；我想我已经介绍了最有可能的那些，但是需要您进行更有条理的调试工作和信息收集。我希望我在这方面也为您提供了指导。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T22:15:55.387

反复调用中断子程序的最常见原因是中断请求在程序中从未得到确认。你确定你清除了相应的IRQ位吗？

为了简化 UART 调试，您应该首先将 UART 连接到 PC，并确保您的目标可以与 PC 进行双向通信。同时使用两个目标，除了用示波器检查信号外，您无法确定问题出在哪一个上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T01:17:28.480

存在三个根本原因...

*   在 UART1 的初始化代码中，中断优先级设置为值 6
*   中断服务程序的第一行被编码为中断优先级为 5
*   UART 数据的前三个字节从数据流中消失（这仍未解决）

这是他们导致问题的不那么明显的方式

*   前三个字节从未出现
*   第四个字节确实出现了
*   中断命中（如第 6 级）和调用`__ISR`例程
*   `__ISR`担任`ipl5`代理人
*   执行的第一条指令（可能更多，我无法准确调试）
*   第一条指令完成后，“更高”优先级 6 中断立即启动
*   这再次导致了相同的中断
*   这个过程无限重复。
*   很快，Stack Overflow 就产生了

### 修复

确保这两行代码彼此一致...

*初始化代码中的 IPL 行，错误的方式然后正确的方式*

```
 //IPC6bits.U1IP=6; //// Wrong !!! Uart 1 IPL should not be 6 !!!

     IPC6bits.U1IP=5;   //// Uart 1 IPL = 5  Correct way; matches __ISR 
```

*中断服务程序*

```
 void __ISR(_UART1_VECTOR, ipl5) IntUart1Handler(void)  //// Operating as IPL 5
     :
     :
     :
     : 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-22T06:45:13.843

糟糕的设计决策。如果两者都在同一块板上，那么 SPI 会更可行且速度更快。

# c++ - C ++：仅在未设置时设置布尔值

> ID：15033916
> 
> 赞同：10
> 
> 时间：2013-02-22T22:00:04.727
> 
> 标签：c++, boolean, variable-assignment, conditional-statements, compiler-optimization

我的 C++ 应用程序中有代码通常执行以下操作：

```
bool myFlag = false;
while (/*some finite condition unrelated to myFlag*/) {
    if (...) {
        // statements, unrelated to myFlag
    } else {
        // set myFlag to true, perhaps only if it was false before?
    }
}
if (myFlag) {
    // Do something...
} 
```

我的问题与`else`我的代码声明有关。基本上，我的循环可能会根据不满足的某个条件将 myFlag 的值从 false 设置为 true。永远不会将标志从真设置为假。我想知道哪种语句在性能方面更有意义，也许由于编译器优化，这个问题实际上不是问题。

```
myFlag = true; 
```

或者

```
if (!myFlag) myFlag = true; 
```

我通常会选择前者，因为它需要编写更少的代码。但是，我开始怀疑它是否涉及对内存的不必要写入，因此如果 myFlag 已经为真，后者将阻止不必要的写入。但是，使用后者是否会因为有条件语句而需要更多时间，因此使用更多指令编译代码？

又或者是我想太多了……

* * *

### 更新 1

只是为了澄清一点......我后一种情况的目的是如果变量已经为真，则不写入内存。因此，仅当变量为假时才写入内存。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-22T22:05:42.970

几乎可以肯定，您最好只使用`myFlag = true;`.

您可以期望的最好的`if (!myFlag) myFlag = true;`结果是编译器会注意到`if`无关紧要并对其进行优化。特别是，该`if`语句需要*读取*的当前值`myFlag`。如果该值尚未在缓存中，则意味着指令将在等待从内存中读取数据时停止。

相比之下，如果您只是写入（无需先测试），则可以将值写入写入队列，然后可以立即执行更多指令。直到/除非您读取 myFlag 的值（并且假设它在写入后很快被读取，它可能仍会在缓存中，因此停滞将是最小的），您才会停止。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T22:05:20.780

CPU 周期方面，更喜欢`myFlag = true;`考虑一下：即使编译器没有进行优化（不太可能），只需设置它需要一条`asm`语句，并通过`if`至少需要 1`asm`条语句。

所以就去接任务吧。

更重要的是，不要试图对这样低级的细节做出假设，具体的编译器优化完全违背直觉。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T22:01:50.703

你知道支票没有实际意义吗？如果您盲目地将其设置为`true`并且未设置，则您正在*设置*它。如果它已经是`true`，则没有更改并且您**没有** *设置*它，因此您可以有效地将其实现为：

```
myFlag = true; 
```

关于潜在的优化，为了能够测试，值必须在*缓存*中，因此大部分成本已经支付。另一方面，分支（如果编译器不优化`if`离开，大多数都会）可能会对性能产生更大的影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T22:41:11.417

正如其他人已经提到的那样，您很可能会过度思考这个问题，所以让我也这样做。如果您负担得起与`myFlag`. 事实上，你可以摆脱`myFlag`. 好的，我们开始：

```
while (/*some finite condition*/) {
    if (...) {
        // statements
    } else {
        while (/*some finite condition*/) {
            if (...) {
               // statements, repeated
            }
        }
        // Do something (as if myFlag was true in the OPs example)
        break;
    }
} 
```

与所有性能优化一样：测量、测量、测量！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T03:46:41.500

即使没有任何优化，是否`if (!myFlag) myFlag = true;`会比简单的执行时间更长，这是特定于架构的。`myFlag = true;`在某些体系结构（例如，[https](https://developer.qualcomm.com/hexagon-processor) ://developer.qualcomm.com/hexagon-processor ）中，两条语句都只需要一个周期即可执行。

在您的机器上计算的唯一方法是通过测量。

在任何情况下`myFlag = true`总是会更快或具有相同的执行时间`if (!myFlag) myFlag = true;`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-21T17:07:50.730

这个问题也让我很头疼，所以我只是用以下代码（C#）自己测试了它：

```
 System.Diagnostics.Stopwatch time = new System.Diagnostics.Stopwatch();
        int i = 0;
        int j = 1;

        time.Start();
        if (i != 0)
            i = 0;
        time.Stop();
        Console.WriteLine("compare + set - {0} ticks", time.ElapsedTicks);

        time.Reset();
        time.Start();
        if (j != 0)
            j = 0;
        time.Stop();
        Console.WriteLine("compare - {0} ticks", time.ElapsedTicks);

        time.Reset();
        time.Start();
        i = 0;
        time.Stop();
        Console.WriteLine("set - {0} ticks", time.ElapsedTicks);

        Console.ReadLine(); 
```

结果：

比较 + 设置 - 1 个刻度

比较 - 1 个刻度

设置 - 0 滴答声

虽然用于设置值的时间肯定不为零，但它表明即使是单个查询也需要比设置变量更多的时间。

# php - PHP - 保存相当于 mysql_fetch_object 的对象

> ID：15033918
> 
> 赞同：0
> 
> 时间：2013-02-22T22:00:14.943
> 
> 标签：php, mysql, object

是否有任何等价物可以将 PHP 对象保存到 mysql-DB 中的单独字段，例如从数据库读取和创建对象的函数：

```
$obj = mysql_fetch_object($result, 'Post'); 
```

如果我的对象看起来像

```
class Post {
public $id;
public $title;
public $text;
public $url;
} 
```

和 mysql-tabel 的结构相同......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:05:15.653

不，没有。但是您可以使用像[Propel](http://propelorm.org/)或[Doctrine2](http://www.doctrine-project.org/projects/orm.html)这样的 ORM 来处理从 db 到 php 对象的映射数据，然后使用映射的对象作为源来持久化该数据。

或者，您可以自己编写某种基本实现，但我个人认为这没有多大价值。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-22T22:02:19.437

你在寻找类似[FOR EACH 的东西吗？](http://php.net/manual/en/control-structures.foreach.php)

# command-line-interface - 为什么可以在未装箱的值类型（没有基类）上调用虚拟 System.Object 成员？

> ID：15033919
> 
> 赞同：4
> 
> 时间：2013-02-22T22:00:16.647
> 
> 标签：command-line-interface, cil, value-type, boxing, virtual-functions

考虑这个 IL 片段（由 Microsoft 的 C# 编译器生成）：

```
.class public sequential ansi sealed beforefieldinit Foo
       extends [mscorlib]System.ValueType
{ … }

.method private hidebysig static void  Main(string[] args) cil managed
{
  .maxstack  1
  .locals init ([0] valuetype Foo foo)

  ldloca.s          foo                                                   // ?
  constrained. Foo                                                        // ?
  callvirt          instance string [mscorlib]System.Object::ToString()   // ?
  pop
  ret
} 
```

我想确切地知道标记的三行中发生了什么`// ?`：如何在未*装箱*的值类型上调用虚拟方法（ `System.Object`'s ） ，（根据 CLI 规范的第 I.8.9.7 节) 根本没有基本类型？`ToString`

 *我目前的不完全理解是这样的：

*   `ldloca.s foo``*`产生一个指向局部变量`foo`（它包含一个未装箱的类型的值）的临时指针（ ） `valuetype Foo`，在这种情况下，根据 CLI 规范的第 I.12.3.2.1 节，可以在需要托管指针（`&`）的地方使用。

*   此`*`指针将充当方法调用的**this**指针。这似乎是合法的，因为它可以在此处充当托管指针 ( `&`)。CLI 标准在第 I.8.9.7 节中提到了这种可能性。

*   `constrained. Foo`前缀是为了防止将值装箱到`valuetype Foo`对象`boxed Foo`中。

但主要问题仍然存在：为什么可以在未继承该虚拟方法的未装箱值上调用虚拟方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T22:26:03.700

> `System.Object.ToString`一个未装箱的值类型（根据 CLI 规范的第 I.8.9.7 节）根本没有基本类型，怎么可能调用虚拟方法？

我对这个问题感到困惑。有或没有基本类型与它有什么关系？

> 我想知道这三行到底发生了什么

关键是`constrained`前缀。文档——Partition III 第 2.1 节——非常简单。在文档中，我们有一个接收器类型`thisType`、一个指向该类型的托管指针`ptr`和一个`constrained.callvirt`of `method`。规则是：

> 1.  如果`thisType`是引用类型，则`ptr`取消引用并作为指向of的`this`指针传递`callvirt``method`
> 2.  If`thisType`是一个值类型并`thisType`实现`method`then未经`ptr`修改地作为`this`指向 a`call`的指针传递`method``thisType`
> 3.  If`thisType`是一个值类型并且`thisType`没有实现方法 then `ptr`被取消引用，装箱，并作为`this`指针传递给`callvirt`of`method`

在您的示例中，第 (3) 点适用。该类型`Foo`是一个值类型，它没有实现方法`ToString`，所以它被装箱并且方法（由基类提供）被调用时引用该框作为`this`。

假设我们有 int.ToString。然后第 (2) 点适用。类型是`int`，它是一个值类型，并`int`实现了对 的覆盖`System.Object.ToString()`。因此，指向 的托管指针`int`成为`this`调用的`ToString`。从而消除了不必要的拳击。（如果`ToString`发生突变，`int`那么突变将发生在作为接收者给出的变量上，而不是盒装副本上。）

> 为什么可以在未继承该虚拟方法的未装箱值上调用虚拟方法？

手头的问题是该方法是否已*实现*，正如我在上面引用的文档中所指出的那样。继承与它有什么关系？

一个你没有问的问题，但这是一个回答它的好地方：

> 我应该总是在我的值类型上实现 ToString 吗？

好吧，我不知道*always*，但是这样做当然是个好主意，因为（1）默认实现`ToString`是令人沮丧的，并且（2）通过在值类型上实现它，您可以设法消除装箱惩罚任何时候直接调用该方法。

> 对象的其他虚拟方法也一样吗？

是的。无论如何，有充分的理由在值类型中创建自己的相等和散列。默认值类型相等有时可能出乎意料。

> 我注意到 GetType 不是虚拟的。这有关系吗？

是的; 不是虚拟的意味着它不能在值类型中被覆盖，这意味着调用`GetType`任何值类型总是将它装箱。当然，如果您手头有一个未装箱的值类型，那么*您不需要调用`GetType`*，因为您在编译时已经知道它的类型是什么！*

# regex - 简化正则表达式，[star] 神秘消失

> ID：15033924
> 
> 赞同：3
> 
> 时间：2013-02-22T22:00:27.337
> 
> 标签：regex, computer-science, regular-language, computation-theory

![在此处输入图像描述](../Images/3d4c04548c49bbcf0f2d4bf57517d9a2.png)！ **问题** 这是我的讲义；“证明 a*(b+ab*)=b+aa *b* ”
我无法理解第 3 行-> 第 4 行发生的事情；
**我的理解** 在那两条线上发生了两件事；

1.  取出`ab*`term`ab*`和 term `aa*b`, results(Λ+aa*);
2.  最后一项`aa*ab*`简化为`aa*b*`因为中间的 a 是多余的；

问题是 * at 发生了什么`aa*b(*)`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T22:31:07.603

看起来您的教授遗漏了第 3⅓ 和 3⅔ 行：

```
第 3 行：b + ab* + aa*b + aa*ab*
第 3⅓ 行：b + ab* + aa*ab* + aa*b ← 通勤最后两个学期
第 3 行⅔：b + Λab* + aa*ab* + aa*b ← ab* = Λab*
第 4 行： b + (Λ + aa*)ab* + aa*b ← 分配性质

```

# java - 如何将仿射变换应用于组件的孩子？

> ID：15033925
> 
> 赞同：-1
> 
> 时间：2013-02-22T22:00:27.507
> 
> 标签：java, swing, affinetransform

是否可以将转换应用于 Swing 中的自定义或预制控件？一方面允许转换，另一方面在实现中可能存在一些差距。

**注意**问题是关于如何从控件的父级应用转换，而不是关于如何使用转换。即转换必须由父母发出，而孩子应该服从它。因此，请提示如何转换标准 Swing 控件或如何编写遵循 PARENT 转换的自定义控件。

在绘制孩子之前应用变换`Graphics`并且不起作用的简单示例：

```
public class Tester_TransformDuringPaint_01 {

private static Logger log = LoggerFactory.getLogger(Tester_TransformDuringPaint_01.class);  
private static class JPanelEx extends JPanel {
private AffineTransform transform = new AffineTransform();

    public AffineTransform getTransform() {
        return transform;
    }

    public void setTransform(AffineTransform transform) {
        this.transform = transform;
    }       

    @Override
    public void paintComponent(Graphics g) {
        Graphics2D g2 = (Graphics2D) g;
        AffineTransform savedTransform = g2.getTransform();
        g2.transform(transform);
        super.paintComponent(g);            
        g2.drawOval(0, 0, 100, 100);            
        g2.setTransform(savedTransform);

    }

    @Override
    protected void paintChildren(Graphics g) {
        Graphics2D g2 = (Graphics2D) g;
        AffineTransform savedTransform = g2.getTransform();
        g2.transform(transform);
        super.paintChildren(g);
        g2.setTransform(savedTransform);
    }
}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {             
            JButton button = new JButton("Button");
            button.setBounds(0,20,100,60);              
            JPanelEx panel = new JPanelEx();
            panel.setLayout(null);
            panel.setBounds(10, 10, 640, 480);
            panel.setBackground(Color.PINK);
            panel.setTransform(AffineTransform.getScaleInstance(2, 1));
            panel.add(button);
            JFrameEx frame = new JFrameEx();
            frame.setLayout(null);
            frame.add(panel);               
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);               
            frame.setSize(0.5);
            frame.center();
            frame.setVisible(true);
        }
    });
}
} 
```

绘制以下内容：

![在此处输入图像描述](../Images/a14fcc893fcf0e7cb8a8bb5eaafba2b8.png)

而按钮的左半部分看起来还活着，而更大的部分看起来已经死了。

这是因为 API 的不同部分使用不同的方法绘制按钮。

**修改后的 O'Reilly hack 51**

下面是基于@lbalazscs 示例的代码，它表明即使转换在“范围内”也不起作用

```
public class BackwardsJButton extends JButton {

public BackwardsJButton(String text) {
    super(text);
}

public void paint(Graphics g) {
    if (g instanceof Graphics2D) {
        Graphics2D g2 = (Graphics2D) g;
        AffineTransform savedTransform = g2.getTransform();
        AffineTransform flipTrans = new AffineTransform();
        double widthD = (double) getWidth();
        //flipTrans.setToTranslation(widthD, 0);
        //flipTrans.scale(-2.0, 1);
        flipTrans.scale(0.5, 1);
        g2.transform(flipTrans);
        super.paint(g);
        g2.setTransform(savedTransform);
    } else {
        super.paint(g);
    }
}

public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
        @Override
        public void run() {
            buildFrame();
        }
    });
}

private static void buildFrame() {
    JFrame f = new JFrame("Test");
    f.setLayout(new FlowLayout());
    f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

    f.add(new BackwardsJButton("BackwardsJLabel"));

    f.pack();
    f.setLocationRelativeTo(null);
    f.setVisible(true);
}
} 
```

输出如下（您可能需要调整窗口大小并移动鼠标才能看到它，因为 Swing 错误位于鼠标悬停代码中：

![在此处输入图像描述](../Images/054d567025309d4de5aafff2061ea5d5.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T22:35:43.777

你有一些创新的想法如何滥用 Swing :)

可以在绘制组件时应用仿射变换，但前提是您在组件的范围内感到满意（例如，您可以镜像文本）。如果你重写了paint，你改变了组件的绘制方式，但这不会改变它的大小，因为大小完全取决于其他变量，你仍然不能可靠地在它的边界之外绘制。

我认为对预制组件的绘制进行改造不是一个好主意，因为即使你在图形上成功了，鼠标点击也会出现在原来的地方。

请注意，您需要在完成后重置转换，因为相同的 Graphics 对象将用于绘制其他组件。

```
AffineTransform savedTransform = g.getTransform();
g.setTransform(specialTransform);
... your drawing here
g.setTransform(savedTransform); 
```

编辑：这是一个转换组件的完整运行示例

```
import javax.swing.*;
import javax.swing.plaf.metal.MetalButtonUI;
import java.awt.*;
import java.awt.geom.AffineTransform;

public class ScaledButton extends JButton {

    public ScaledButton(String text) {
        super(text);
    }

    public void paintComponent(Graphics g) {
        Graphics2D g2 = (Graphics2D) g;
        Color savedColor = g2.getColor();
        g2.setColor(getBackground());
        g2.fill(new Rectangle(0, 0, getWidth(), getHeight()));
        g2.setColor(savedColor);

        AffineTransform backup = g2.getTransform();
        g2.scale(0.5, 1);
        super.paintComponent(g);
        g2.setTransform(backup);
    }

    @Override
    protected void paintBorder(Graphics g) {
        Graphics2D g2 = (Graphics2D) g;
        AffineTransform backup = g2.getTransform();
        g2.scale(0.5, 1);
        super.paintBorder(g);
        g2.setTransform(backup);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                buildFrame();
            }
        });
    }

    private static void buildFrame() {
        JFrame f = new JFrame("Test");
        f.setLayout(new FlowLayout());
        f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

        f.add(new ScaledButton("ScaledButton"));

        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }
} 
```

# linux-kernel - Linux中命名的进程何时何地

> ID：15033926
> 
> 赞同：4
> 
> 时间：2013-02-22T22:00:31.127
> 
> 标签：linux-kernel

我一直在尝试遵循 Linux 上的流程创建流程。到目前为止，我已经添加了一些 debug`printk`来了解 Linux 内核上的 pid 分配。但是，现在我希望在创建（或执行）时将 PID 映射到二进制文件。

我知道Linux创建进程的方式是通过分叉init然后执行exec..或直接从init执行exec..

我正在尝试跟踪`comm`新字段的`task_struct`填充时间和位置。该`comm`字段存储正在执行的二进制文件。到目前为止，无论我在哪里尝试打印该`comm`字段（在`context_switch`函数期间除外），所有进程始终将其名称显示为`khelper`

我已经尝试过广泛调试该`do_execve`功能，但这似乎不包含与更改`comm`字段相关的代码..

有人可以指出该`comm`字段的分配地点和时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T22:12:05.513

更正：该函数`setup_new_exec`在实际设置此字段的`fs/exec.c`调用中。`set_task_comm`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:31:28.813

我发现`setup_new_exec`in`fs/exec.c`填充了大多数用户进程`comm`的结构中的字段。`task_struct`但是，对于在内核本身内启动的许多进程来说，这似乎并没有发生。

# visual-studio-2012 - 参数不正确

> ID：15033931
> 
> 赞同：0
> 
> 时间：2013-02-22T22:01:16.413
> 
> 标签：visual-studio-2012

当我尝试在 Visual Studio 中为我的项目添加服务引用时，我不断收到错误“参数不正确”，我知道这不是代码，因为它不会发生在我同事的计算机上。我已经卸载并重新安装了 Visual Studio，以查看问题是否与我的安装有关。但这似乎并不能解决它。

我正在使用视觉工作室 2012。

以前有人遇到过这个问题吗？请帮忙！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-17T15:35:31.837

我在从 ClearCase 复制的项目中遇到了这个问题。.csproj 文件仍然有参考告诉视觉工作室它仍然在 CC 之下。我删除了以下引用并且它有效。

```
<SccProjectName>Rational ClearCase</SccProjectName>
<SccLocalPath>Rational ClearCase</SccLocalPath>
<SccAuxPath>Rational ClearCase</SccAuxPath>
<SccProvider>Rational ClearCase</SccProvider> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-26T15:03:47.397

除了 Frisons 的回答 - 这个问题也适用于其他方式：

如果您*使用*ClearCase，请确保 Frison 提到的条目在您的项目文件中可用。我刚遇到这种情况，我的解决方案中的一个项目（但是）没有这些条目，我得到了同样的错误。添加这些行为我解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T07:31:01.540

更新 Windows Phone 的 SQLite 插件后，我遇到了同样的问题。似乎 sqlite-net-wp8 项目（它是与插件一起使用的包装器）具有来自该插件的一些导入方法，并且当版本更改时，包装器不再起作用。

解决方案是将 sqlite 插件降级为与 wp8 包装器兼容的版本。

**编辑：**包装器有一个更新，所以我已经升级了插件和包装器，现在问题已经解决。

如果它在您的解决方案中显示名称旁边带有“（失败）”的任何项目，请尝试将其删除并将其重新添加到您的解决方案中，它会告诉您究竟是什么问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-26T08:48:19.057

我在 WindowsPhone 项目中遇到了同样的错误，在明确清单后错误消失了。

# javascript - 在图像外部单击时隐藏 div

> ID：15033939
> 
> 赞同：0
> 
> 时间：2013-02-22T22:01:54.210
> 
> 标签：javascript, jquery

我有一个包含几个隐藏 div 的网页。我对它们进行了设置，以便在单击图像时显示它们，如果再次单击图像，它们将隐藏。问题是，如果它们可见并且单击页面的任何部分，我需要隐藏它们。我搜索了高低并找到了一些建议，但还没有找到一个可行的。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:06:02.030

```
$(window).click(function() {
    $('img').hide();
}); 
```

[非常简单的例子](http://jsfiddle.net/PHauN/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:10:44.017

我通常会绑定一个 document.click 事件来监听外部的点击，然后在窗口关闭时将其移除。

```
// in function after your image shows up.
document.click = hideImage;
// other code to hide image when image is clicked

// in function after your image is hidden.
document.click = null; 
```

如果您使用 jQuery，它会更容易，因为您可以命名您的事件以安全地添加和删除。

```
// in function after your image shows up.
$(document).bind('click.imagehide', hideImage);
// other code to hide image when image is clicked

// in function after your image is hidden.
$(document).unbind('click.imagehide'); 
```

此方法更安全，因此您不会干扰绑定到`document`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T22:11:22.223

您需要做的是防止事件冒泡。如果您使用的是 jquery，您可以执行以下操作：

```
$(document).on ('click', function () { $('div').hide (); });
$('img').on ('click', function (e) { e.stopPropagation (); }); 
```

请记住更改选择器以满足您的需求。

# python - 获取创建时间

> ID：15033941
> 
> 赞同：1
> 
> 时间：2013-02-22T22:02:15.243
> 
> 标签：python

为了在 python 中获取文件的最后修改时间，我这样做：

```
lastmodifiedTime = os.path.getmtime(filename) 
```

如何获得创建时间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T22:04:11.423

*如果*您在 Windows 上，[`os.path.getctime()`](http://docs.python.org/2/library/os.path.html#os.path.getctime)则为文件创建时间。在其他平台上，不存储信息，该函数返回最后更改时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:03:57.207

尝试[`os.path.getctime`](http://docs.python.org/2/library/os.path.html#os.path.getctime)获取创建时间。

# php - 使用 CodeIgniter 将 html 插入数据库

> ID：15033945
> 
> 赞同：1
> 
> 时间：2013-02-22T22:02:28.547
> 
> 标签：php, codeigniter

我想让用户使用编辑器（CKEditor）编辑页面。

问题是我想防止 XSS，所以当我使用时：

```
$this->input->post('content', TRUE) 
```

它还删除了一些 html 内容，例如，以下代码：

```
<script></script><p><span style="color:#800000;">text</span></p> 
```

变为：

```
[removed][removed]<p><span 
```

所以是的，它可以防止 XSS，但也会删除一些必要的 html 内容。

我应该怎么做才能修复它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T22:05:43.927

不要使用他们内置的 XSS 功能。使用[HTML 净化器](http://htmlpurifier.org/)为您完成。这样，您可以更好地控制哪些是删除，哪些不删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-13T13:13:07.390

尝试这种简单的方法将这段代码更改`$this->input->post('content', TRUE)`为`$_POST['content']`我的工作，因为 codeigniter 将在运行时进行 XSS 过滤`$this->input`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-23T05:23:23.033

而不是这个，你可以使用下面的代码。

$content = htmlspecialchars($this->input->post('content'));

保存到数据库和检索时，您可以使用

htmlspecialchars_decode('你的html代码');

# c# - 将所有 mp3 加载到音频数组中

> ID：15033946
> 
> 赞同：2
> 
> 时间：2013-02-22T22:02:29.917
> 
> 标签：c#, audio, unity3d

我正在尝试将所有 .mp3 文件从 menusound 映射加载到

```
public AudioClip[] menuSound; 
```

是否可以在一个文件夹中找到所有 .mp3 并将它们全部加载到一个文件夹中`Audioclip[]`？

我知道你可以单独加载所有音轨但是当我尝试

```
AudioClip[] menuSound = {
    Resources.Load("Gamegeluiden/MenuSounds/menuselect") as AudioClip
}; 
```

我似乎只能将 1 首歌曲放入声音阵列

```
AudioClip[] menuSound = {Resources.Load("Gamegeluiden/MenuSounds/menuselect") as AudioClip,Resources.Load("Gamegeluiden/MenuSounds/menuselect2") as AudioClip
    }; 
```

如果我在这样做之后尝试超出数组，它会说 0 = 好的 1 = 超出范围

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T20:17:54.683

你确定你的第二个声音真的存在吗？因为下面的测试代码工作得很好（因为它在我的数组中播放第三个声音）：

```
public class SoundLoader : MonoBehaviour {
public AudioClip[] menuSound;
void Start () {
    menuSound = new AudioClip[]{
        Resources.Load("sound1") as AudioClip,
        Resources.Load("sound2") as AudioClip,
        Resources.Load("sound3") as AudioClip
    };
    AudioSource.PlayClipAtPoint(menuSound[2],Vector3.zero);
}
} 
```

我目前的**项目层次结构**：

> 资产\
> 资产\资源\
> 资产
> \资源\声音1 资产\资源\声音2
> 资产\资源\声音3

# vba - 在vba中将对象集合作为参数传递

> ID：15033951
> 
> 赞同：0
> 
> 时间：2013-02-22T22:02:49.270
> 
> 标签：vba, excel

我对 VBA 完全陌生，我会很感激一些应该是微不足道的帮助。我有以下代码：

```
Sub sub1()
Dim buys As Collection
Dim sells As Collection
Set buys = New Collection
Set sells = New Collection

handleBuy rowCounter, buys, sells

End Sub

Sub handleBuy(ByVal rowNum As Integer, ByRef listBuys As Collection, ByRef listSells As Collection)
'do something here with the collections

End Sub 
```

上述集合包含由我定义的类实例化的对象。当我尝试运行上面的代码时，我得到一个运行时错误 424 “Object Required” 错误发生在对 handleBuy 的调用发生的地方。我在这里想念什么？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T23:01:11.440

发生错误是因为 since `rowCounter`is not `Dim`'ed 因为`Integer`（并且在没有 的情况下`Option Explicit`）是默认类型`Variant`。这与声明的不兼容`Sub handleBuy(ByVal rowNum As Integer`

解决方案：使用`Option Explict`- 这将有助于防止此类错误并声明`Dim rowCounter As Integer`

顺便说一句，你*应该*使用`Long`而不是`Integer`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:57:25.777

2个选项：

1.  定义`rowCounter`变量；或者
2.  去除`Option Explicit`

1是首选。

# c - mallocing 等效于具有指定数组大小的指针

> ID：15033952
> 
> 赞同：4
> 
> 时间：2013-02-22T22:02:57.340
> 
> 标签：c, pointers

我已经阅读了有关指针的各种教程，现在我提出一个问题，

这是：

字符 *输入 = malloc(sizeof(char)*24);

一样

字符 *输入[24];

我的印象是 malloc 也会在堆上用 24 个插槽创建我的空间。通常，我看到 char input[24]，但我认为 char *input[24] 比 mallocing 更简单。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T22:05:02.623

不，它们不一样。

```
char *input = malloc(sizeof(char)*24); 
```

将在堆上分配一个 24 个字符的块，并分配一个指向该块开头的指针以供输入。（从技术上讲，您只是告诉它分配 x 个字节，其中 x 是每个字符大小的 24 倍，以字节为单位）

```
char *input[24]; 
```

将在堆栈上创建一个包含 24 个字符*指针*的数组。这些指针不会指向您编写的任何内容（或初始化时的垃圾）。

对于第二个示例，然后您可以获取数组中的每个指针`input`并为其分配一些内容以指向堆上。前任：

```
char *input[NUM_STRS];
for( int i = 0; i < NUM_STRS; i++ )
    {
    input[i] = malloc( MAX_STR_LEN * sizeof(char) );
    } 
```

然后你会在堆栈上有一个字符指针数组。这些指针中的每一个都将指向堆上的一个字符块。

但是请记住，当函数退出并且该变量超出范围时，堆栈上的内容将被弹出。如果你 malloc 一些东西，那个指针在它被释放之前将是有效的，但对于在堆栈上创建的数组来说，情况并非如此。

**编辑**：根据您的评论，这里是在堆上创建 24 个字符指针并为它们分配空间以指向的示例：

```
#define NUM_STRS 24
#define MAX_STR_LEN 32
char **input = malloc( sizeof(char *) * NUM_STRS );
for( int i = 0; i < NUM_STRS; i++ )
    {
    input[i] = malloc( sizeof(char) * MAX_STR_LEN );
    } 
```

请记住，在此示例中，您必须释放输入中的每个指针，然后在适当的时间输入自身以避免内存泄漏。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-22T22:04:39.823

这些根本不一样。

```
char *input = malloc(sizeof(char)*24); 
```

这分配了足够的内存来保存 24 `char`，并将地址分配给`input`（指针）。此内存是动态分配的，因此需要在某个时候通过适当的调用来释放它`free()`。

```
char *input[24]; 
```

这声明`input`为一个包含 24 个指针的数组。这有*自动存储*，这意味着你不需要`free`它。（但是，您可能需要`free`每个指针指向的东西，但那是另一回事！）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T22:22:45.577

从根本上说，这两个变量的*类型*是不同的。在第一种情况下，您声明一个**指向`char`**动态分配的内存的指针（您在稍后的时刻`malloc`有义务这样做）。`free`在第二种情况下，您声明**一个指向 char 的指针数组**。

几个观察：

*   `sizeof(char)`根据定义是一个，所以你可以忽略它。（不，它没有传达*记录目的*。您最好将其重写为`char *input = malloc( 24 * sizeof *input );`）
*   很少会调用`malloc`具有整数文字。如果`24`在您的示例中是 ( )，那么通常人们更愿意使用一个数组来保存它（关于堆栈使用的一些注意事项，我在这里回避）。

希望这可以帮助，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T22:10:58.773

您可以将其更好地与`char input[24];`（注意没有*）进行比较。有了它，您可以`input`以相同的方式使用，但内存在堆栈上而不是在堆上。

# c++ - 指向对象类型的指针

> ID：15033959
> 
> 赞同：2
> 
> 时间：2013-02-22T22:03:37.570
> 
> 标签：c++, linux, oop, gcc

我一直在尝试创建类的层次结构，让每个类都包含一个包含数据的嵌套结构。

```
////////Class.h////////////////////////////
#ifndef _CLASS_H_
#define _CLASS_H_
#include <stdio.h>

class A{//Base
    protected:
    struct dataA{
        int v1, v2;
    };
    public:
    A();
    virtual void met1();
    dataA * const set;
    const dataA * const get;
};

class B : public A{//Child1
    protected:
    struct dataB : public dataA{
        int v3, v4;
    };
    public:
    B();
    virtual void met2();
    dataB * const set;
    const dataB * const get;    
};

class C : public B{//Child2
    struct dataC : public dataB{
        int v5, v6;
    };
    public:
    C();
    void met3();
    dataC * const set;
    const dataC * const get;
};
#endif
////////Class.cpp///////////////////////////
#include "Class.h"

A::A() : set( new dataA ), get( set ) {
    this->set->v1 = -1;
    this->set->v2 = -1;
}

void A::met1() {
    printf( "%i, %i", this->get->v1, this->get->v2 );//PRINTS "-1, -1"
}

B::B() : A(), set( new dataB ), get( set ) {
    this->set->v3 = -1;
    this->set->v4 = -1;
}

void B::met2() {
    printf( "%i, %i", this->get->v1, this->get->v2 );//An attempt to access C's "get" variable, PRINTS "-1, -1"
}

C::C() : B(), set( new dataC ), get( set ) {
    this->set->v5 = -1;
    this->set->v6 = -1;
}

void C::met3() {
    printf( "%i, %i", this->get->v1, this->get->v2 );//PRINTS "2, 3"
}
///////main.cpp////////////////////////////////
#include "Class.h"

int main() {
    C memb;
    memb.set->v1 = 2;
    memb.set->v2 = 3;
    printf( "%i, %i", memb.get->v1, memb.get->v2 );//PRINTS "2, 3"
    memb.met2();//PRINTS "-1, -1"
    return 0;
} 
```

![在此处输入图像描述](../Images/6a9bb3bc0e878bf1ae1f0ff086a6de84.png) 所以，我一直在尝试做的是在声明 C 类型的成员之后，访问从 B 继承的函数，该函数可以访问 C 的数据结构。void 指针无法完成这项工作，因为它不能指向对象类型。我试过将 C 的地址传递给 B，不过，它们都是不同的类型。首先，如果我从主块访问 v1，只要我为它设置了一个值，如示例所示，我会得到一个正确的值——我设置的值。但是，如果我尝试访问相同的变量，但从 B 类中访问，它会打印该值，就好像它之前没有设置过一样，而不是来自构造函数。所以我试图创建一个从类 B 到类 C 的数据结构的链接 - 到类 C 的数据父类 B 的数据结构。示例代码尚未编译。问候！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T23:01:45.090

我很确定这与您想要的很接近，尽管我必须告诉您，写完后我需要淋浴。这里面有很多我不会做的事情，但是......

```
#include <cstdio>
#include <cstdlib>
using namespace std;

class A{//Base
protected:
    struct dataA
    {
        int v1, v2;
    }  * const data;

    A(dataA* const p)
        : data(p)
    {
        p->v1=-1;
        p->v2=-1;
    };

public:
    virtual void met1()
    {
        printf( "%i, %i", get()->v1, get()->v2 );
    }

    const dataA * const get() const { return data; }
    dataA * const set() const { return data; }
};

class B : public A {//Child1
protected:
    struct dataB : public dataA
    {
        int v3, v4;
    } * const data;

    // protected constructor
    B(dataB * const p)
        : A(p), data(p)
    {
        p->v3 = 0;
        p->v4 = 0;
    };

public:
    virtual void met2()
    {
        printf( "%i, %i, %i, %i", get()->v1, get()->v2, get()->v3, get()->v4);
    }

    const dataB * const get() const { return data; }
    dataB * const set() const { return data; }
};

class C : public B
{
    struct dataC : public dataB
    {
        int v5, v6;
    } * const data;

public:
    C() : B(new dataC),
    data(static_cast<dataC*>(B::data))
    {
        data->v5 = 0;
        data->v6 = 0;
    };

    ~C()
    {
        // note, the pointers in B and A are left
        //  dangling after this is done.
        delete data;
    }

    virtual void met2()
    {
        printf( "%i, %i, %i, %i, %i, %i",
               get()->v1, get()->v2,
               get()->v3, get()->v4,
               get()->v5, get()->v6);
    }

    const dataC * const get() const { return data; }
    dataC * const set() const { return data; }
};

///////main.cpp////////////////////////////////

int main() {
    C memb;
    memb.set()->v1 = 2;
    memb.set()->v2 = 3;
    printf( "%i, %i\n", memb.get()->v1, memb.get()->v2 );
    memb.met2();
    return 0;
} 
```

**输出**

```
2, 3
2, 3, 0, 0, 0, 0 
```

* * *

**更新**

OP 希望在没有 get() 和 set() 成员的情况下仅使用成员变量来查看这一点。再次，只是可怕的，但你去：

```
#include <cstdio>
#include <cstddef>

class A{//Base
protected:
    struct dataA
    {
        int v1, v2;
    };
    dataA * const set;
    const dataA * const get;

    A(dataA* const p)
        : get(p), set(p)
    {
        p->v1=-1;
        p->v2=-1;
    };

public:
    virtual void met1()
    {
        printf( "%i, %i\n", get->v1, get->v2 );
    }
};

class B : public A {//Child1
protected:
    struct dataB : public dataA
    {
        int v3, v4;
    };
    dataB * const set;
    const dataB *const get;

    // protected constructor
    B(dataB * const p)
        : A(p), set(p), get(p)
    {
        p->v3 = 0;
        p->v4 = 0;
    };

public:
    virtual void met2()
    {
        printf( "%i, %i, %i, %i\n", get->v1, get->v2, get->v3, get->v4);
    }
};

class C : public B
{
    struct dataC : public dataB
    {
        int v5, v6;
    };
public:
    dataC * const set;
    const dataC * const get;

    C() : B(new dataC),
        set(static_cast<dataC *const>(B::set)),
        get(static_cast<const dataC *const>(B::get))
    {
        set->v5 = 0;
        set->v6 = 0;
    }

    ~C()
    {
        // note, the pointers in B and A are left
        //  dangling after this is done.
        delete set;
    }

    virtual void met2()
    {
        printf( "%i, %i, %i, %i, %i, %i\n",
               get->v1, get->v2,
               get->v3, get->v4,
               get->v5, get->v6);
    }
};

///////main.cpp////////////////////////////////

int main() {
    C memb;

    memb.set->v1 = 2;
    memb.set->v2 = 3;

    printf( "%i, %i\n", memb.get->v1, memb.get->v2 );
    memb.met2();

    B& obj = memb;
    obj.met1();
    obj.met2();

    return 0;
} 
```

**输出**

```
2, 3
2, 3, 0, 0, 0, 0
2, 3
2, 3, 0, 0, 0, 0 
```

# javascript - 从图像单击将高度和宽度发送到fancybox

> ID：15033964
> 
> 赞同：1
> 
> 时间：2013-02-22T22:03:59.440
> 
> 标签：javascript, jquery, html, css, fancybox

我说有 10 张图片，当其中任何一张被点击时，它们会打开一个 Fancybox 框架 (HTML)。问题是每个图像都有不同大小的 Fancybox 框架需要打开。如何从被点击的图像发送高度和宽度。

```
$("a.various").fancybox({
    beforeClose: function () {
        $("#gallery_spacer").remove();
    },
    openEffect: 'fade',
    openSpeed: 1500,
    closeEffect: 'fade',
    closeSpeed: 400,
    padding: '0',
    width: 660,
    height: 700,
    maxWidth: 660,
    maxHeight: 700,
    fitToView: false,
    autoSize: false,
    closeClick: false,
    autoScale: 'false',
    autoDimensions: 'false',
    transitionIn: 'true',
    transitionOut: 'true',
    type: 'iframe',
    openEffect: 'fade',
    helpers: {
        overlay: {
            css: {
                'background': 'rgba(255, 255, 255, 0.0)'
            }
        }
    }
});

$("a.various1").fancybox({
    beforeClose: function () {
        $("#gallery_spacer").remove();
    },
    openEffect: 'fade',
    openSpeed: 1500,
    closeEffect: 'fade',
    closeSpeed: 400,
    padding: '0',
    scrolling: 'no',
    width: 660,
    height: 1870,
    maxWidth: 660,
    maxHeight: 1870,
    fitToView: false,
    autoSize: false,
    closeClick: false,
    autoScale: 'false',
    autoDimensions: 'false',
    transitionIn: 'true',
    transitionOut: 'true',
    type: 'iframe',
    openEffect: 'fade',
    helpers: {
        overlay: {
            css: {
                'background': 'rgba(255, 255, 255, 0.0)'
            }
        }
    }
}); 
```

的HTML

```
<li><a class="various1 fade " href="FOOTWEAR_SUB_PAGES/MERCURIAL_SUPERFLY.html"><img src="MAIN_IMAGES/MERCURIAL_SUPERFLY-2.jpg"  border="0" /></a></li>
<li><a class="various2 fade " href="FOOTWEAR_SUB_PAGES/AIRMAX_MOTO.html"><img src="MAIN_IMAGES/AIRMX-22.jpg"  border="0"  /></a></li> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T18:35:40.893

您基本上需要一个脚本将所有链接绑定到fancybox，然后使用（HTML5）属性单独`data-*`传递`width`和`height`

你可以使用这个 html ：

```
<li><a class="fancybox" data-width="660" data-height="700"  href="FOOTWEAR_SUB_PAGES/MERCURIAL_SUPERFLY.html"><img src="MAIN_IMAGES/MERCURIAL_SUPERFLY-2.jpg"  border="0" /></a></li>
<li><a class="fancybox" data-width="660" data-height="1870" href="FOOTWEAR_SUB_PAGES/AIRMAX_MOTO.html"><img src="MAIN_IMAGES/AIRMX-22.jpg"  border="0"  /></a></li> 
```

...并使用fancybox`beforeShow`回调获取每个链接的大小，例如：

```
beforeShow: function () {
    this.width  = $(this.element).data("width");
    this.height = $(this.element).data("height");
} 
```

...其中`$(this.element)`指的是每个单击的元素。

见**[JSFIDDLE](http://jsfiddle.net/AWpcz/)**

请**注意**在小提琴中我注释掉了一些在 v2.x 中无效的 API 选项（它们适用于 v1.3.4 并且不兼容）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:54:40.330

您可以像这样获得图像的宽度和高度：

```
var w = $("a.various1 img").width();
var h = $("a.various1 img").heigth(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T23:52:01.570

由于您将内容加载到 iframe 中，因此在 iframe 中呈现 html 之前，您无法获得 fancybox 所需的尺寸。

您可以做的是在呈现 html 后使用 onComplete 调整fancybox 的大小，如此处[所述](https://stackoverflow.com/questions/5389927/fancybox-updating-size-of-fancybox-with-iframe-content)。

因此，对于您的情况，您可以执行以下操作：

```
$("a.various").fancybox({
            beforeClose: function () { $("#gallery_spacer").remove(); },
            'onComplete' : function() {
                $('#fancybox-frame').load(function() {
                    $('#fancybox-content').height($(this).contents().find('body').height()).width($(this).contents().find('body').width());
            });
            openEffect: 'fade',openSpeed: 1500,closeEffect: 'fade',closeSpeed: 400,'padding': '0','width': 660,'height': 700,
            maxWidth: 660,maxHeight: 700,fitToView: false,autoSize: false,closeClick: false,'autoScale': 'false','autoDimensions': 'false',
            'transitionIn': 'true','transitionOut': 'true','type': 'iframe','openEffect': 'fade',
            helpers: {overlay: { css: {'background': 'rgba(255, 255, 255, 0.0)'}}}}); 
```

# android - Android：使用 root 在代码中切换 2G 和 3G

> ID：15033965
> 
> 赞同：0
> 
> 时间：2013-02-22T22:04:01.220
> 
> 标签：android, toggle, root, 3g

我读过没有办法在我自己的代码中在 android 上切换 2g/3g。但是有没有解决方案如何使用root权限或类似的东西来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:30:18.240

你也许可以这样做：（免责声明：我没有亲自做过，但理论上它可以工作）

首先看到这个关于在 Android 上发送 AT 命令的 SO 问题，尤其是关于使用 root 权限的解决方法的第二个答案：[如何在 android 中发送 AT 命令？](https://stackoverflow.com/questions/2574401/how-to-send-at-command-in-android).

然后使用 AT 命令将设备设置为“2G only”或“3G only”或任何您想要的。使用[3GPP 27.007](http://www.3gpp.org/ftp/Specs/html-info/27007.htm)中定义的标准 AT 命令，您可以告诉设备选择特定的 2G 或 3G 网络（参见 AT+COPS， AT+CREG). 您可以通过将 AT+COPS set 命令的参数分别设置为 1 或 4 来调整是“仅 2G”还是“首选 2G”。

我发现了两种使用不同的专有 AT 命令的方法。一个可在[此处](http://www.kayraelektronik.com/pdf/leon/AT_Commands_Examples_Application_Note_WLS-CS-11003.pdf)在 Internet 上公开获得。它使用 AT+URAT，据我所知，这不是标准的 AT 命令。

这里的重点是，该设备可能不支持 AT+URAT，但它可能有自己的专有 AT 命令来实现此功能。

# mongodb - Mongo DB C# 驱动程序 - 从 C# 代码中获取翻译后的 BSON

> ID：15033970
> 
> 赞同：0
> 
> 时间：2013-02-22T22:04:23.930
> 
> 标签：mongodb, mongodb-.net-driver

假设我使用 C# 驱动程序设置了以下光标：

```
 var cursor = _mongoClient.GetServer()
                               .GetDatabase("test")
                                .GetCollection<BsonDocument>("somecollection")
                                .Find(Query.EQ("field", "value"))
                                .SetFields(Fields.Exclude())
                                .SetLimit(5)
                                .SetSortOrder("field");
     var results = cursor.ToList(); 
```

我想查看发送到 mongo 服务器的翻译后的 BSON 命令（即“db.somecollection.find({...})”。

无论哪种方式都是可以接受的：

**1.**某种将其打印为字符串的函数。

**2.**某种方式来“嗅探”发送到服务器的命令。*（mongo.exe 中的 db 分析功能仅显示 where 子句和 order by --我想查看所有内容 --limit、字段投影等）*

此外，使用 MongoQueryable 执行此操作也很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:23:41.720

因此，看起来 MongoCursor 的序列化被封装在 MongoDB.Driver 程序集内部的类中。因此，发送到服务器的序列化 BSON 消息至少在客户端代码中不可见。

但是，我可以合理地相信 MongoCursor 在较低级别得到正确翻译。（毕竟，10gen 支持这个项目。）

更令人担忧的是如何翻译 LINQ 表达式。如果我可以验证 LINQ IQueryables 是否被转换为具有正确状态的 MongoCursor，那我就很成功了。

因此，这是一个将光标拉出 IQueryable 的扩展方法：

```
 public static class MongoExtensions
    {

       public static MongoCursor GetCursor<T>(this IQueryable<T> source)
       {
           var queryProvider = source.Provider as MongoQueryProvider;
           if (queryProvider == null)
           {
               throw new NotSupportedException("Explain can only be called on a Linq to Mongo queryable.");
           }

           var selectQuery = (SelectQuery)MongoQueryTranslator.Translate(queryProvider, source.Expression);

           if (selectQuery.Take.HasValue && selectQuery.Take.Value == 0)
           {
               throw new NotSupportedException("A query that has a .Take(0) expression will not be sent to the server and can't be explained");
           }

           var projector = selectQuery.Execute();

           var cursorProp = projector.GetType().GetProperties().FirstOrDefault(p => p.Name == "Cursor");
           return cursorProp.GetValue(projector) as MongoCursor<T>;

       }
    } 
```

然后我可以测试 MongoCursor 的状态，检查“Query”、“Skip”、“Limit”等属性以及“Options”集合中的所有项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T07:10:27.200

就像是：

```
var queryable= (MongoQueryable<BsonDocument>)someCollection;
var debug = queryable.GetMongoQuery().ToJson(); 
```

# java - 设备的 Android 布局位置

> ID：15033974
> 
> 赞同：0
> 
> 时间：2013-02-22T22:04:59.187
> 
> 标签：java, android, layout

所以我制作了一个带有 2 个文本视图和 1 个按钮的测试应用程序。

当然，我可以在我的模拟器和 Eclipse 中的内部布局编辑器上得到很好的结果。

我在我的 HTC Desire HD 上安装了应用程序，发现该按钮略微覆盖了一个 textView。

这种东西我应该注意什么？我是否应该为这些元素等设置一些属性以动态地从不相互覆盖（例如以百分比表示的 HTML 动态宽度等）？

我应该在某处阅读布局最佳实践以避免覆盖，还是可以在某些具有不同尺寸和分辨率的设备上进行覆盖是否正常？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T01:35:51.687

对不同屏幕尺寸的不同支持呢？

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:34:15.540

好的，如果其他人到达这里。

我使用了 RelativeLayout，这意味着您可以随时添加元素。它类似于css中的“相对”位置+“绝对”。

关键是，当您添加元素时，您必须寻找一个箭头，表明您将在元素上方或下方添加元素，这样它就不会覆盖另一个元素。

不要忘记这一点。小绿色箭头可帮助您定位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T22:36:28.487

如果您希望所有元素都处于垂直方向，则必须使用具有垂直方向的 LinearLayout，然后将元素放入其中。提醒使用 FillParent 或 WrapContent 作为宽度和高度，这样你的大小是相对的而不是绝对的。

已编辑

对不起，我上次没有看到你的答案，如果你使用的是相对布局，你可以使用 Under of、Above of、left to 和 right to 属性，你只需要放置引用元素的 Id。有时，ide 会显示错误，因此您必须在新元素之前定义引用的元素。

此致

# node.js - Mongoose：在插入新行之前从表中获取最大 ID

> ID：15033981
> 
> 赞同：1
> 
> 时间：2013-02-22T22:05:18.093
> 
> 标签：node.js, mongoose

当我向我的节点服务器发布创建新项目的请求时，我需要从项目表中获取最大项目 ID。

IE 我正在使用 itemId 作为该表中的一个向上序列。

```
var Item = new Schema({
  itemId: {type: Number, required: true}
  ...
}); 
```

有没有推荐的方法来获取最大 itemId 以便我可以添加 1 并在创建新项目时使用该值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T23:33:21.730

您可以通过以下方式获得最大值`itemId`：

```
ItemModel.findOne().sort('-itemId').exec(function(err, item) {
    // item.itemId is the max value
}); 
```

但是，您不能确定在查询最大值和添加最大值并使用它之间，最大值不会发生变化，因为可能会同时出现另一个请求来执行相同的操作。

这就是为什么`ObjectId`s 更适合 ID 的原因之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T19:59:21.430

这是我发现的一个链接，它正是我需要做的。甚至给出了几个选项。

[http://docs.mongodb.org/manual/tutorial/create-an-auto-incrementing-field/](http://docs.mongodb.org/manual/tutorial/create-an-auto-incrementing-field/)

# c# - 使用 Windows7 修改 .EXE.CONFIG 文件中的 ConnectionString？

> ID：15033982
> 
> 赞同：1
> 
> 时间：2013-02-22T22:05:19.760
> 
> 标签：c#, windows-7, sql-server-ce

我在用户应用程序数据文件夹下有一个 SQL Server CE 4.0 (SDF) 文件（因为由于 Win7 UAC，如果数据库位于 \Programs Files\ 文件夹中，则无法修改它。但问题仍然存在，我现在需要（安装时）修改 .EXE.CONFIG 文件（ConnectionString）以指向数据库的新路径，但显然我无权修改 \Program Files\ 文件夹中的 .EXE.CONFIG 文件......

那么人们如何解决这个问题呢？您可以将 .EXE.CONFIG 文件与 SDF 文件一起部署到用户应用程序数据文件夹吗？如果没有怎么办？我不敢相信您需要授予对 \Program Files\Application 文件夹的特殊访问权限才能拥有完全访问权限...

我正在使用 VS2010 并使用标准部署项目 (MSI)，但无论如何我都看不到将 .EXE 部署在一个地方，而将 .EXE.CONFIG 部署在另一个地方（可以这样做吗？这是正确的解决方案吗？）

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:12:10.273

使用`%APPDATA%`连接字符串中的变量，您不必修改配置文件。这也比硬编码包含用户名的路径更灵活，因为它将允许计算机的所有用户使用您的程序并拥有自己的*.sdf*文件。

但是，[环境变量在 .NET 中不会自动扩展](https://stackoverflow.com/q/867485/95)，因此您需要使用以下`Environment.ExpandEnvironmentVariable`方法强制执行它：

```
// Example appSetting element:
//   <add key="examplePath" value="%APPDATA%\example.txt" />

string path = System.Configuration.ConfigurationManager.AppSettings["examplePath"].ToString();
path = Environment.ExpandEnvironmentVariables(path);
System.IO.File.WriteAllText(path, "foobar"); 
```

# java - 通过接口进行多重继承

> ID：15033983
> 
> 赞同：0
> 
> 时间：2013-02-22T22:05:20.493
> 
> 标签：java

假设我有 2 个接口

```
interface A {

    public static final int CONSTANT1 = 6;

}

interface B {

    public static final int CONSTANT1 = 7;
}

class MYclass implements A, B {

    public static void main(String[] args) {

        System.out.println(CONSTANT1);//<- ??

    }
} 
```

哪个常量会被打印出来还是编译错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:16:09.797

然而，作为参考，代码：

```
interface A
{
    int CONSTANT1 = 6;
}

interface B
{
    int CONSTANT1 = 7;
}

public class Test implements A, B
{
    public static void main(String[] args)
    {
        System.out.println(CONSTANT1);
    }
} 
```

打印 7.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:20:53.890

我的 javac 7 在 adchilds 的示例中失败：

> 错误：对 CONSTANT1 的引用不明确，A 中的变量 CONSTANT1 和 B 中的变量 CONSTANT1 都匹配

JLS [http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3)

> 一个类可以继承多个同名字段。这种情况本身不会导致编译时错误。但是，在类的主体中通过其简单名称引用任何此类字段的任何尝试都将导致编译时错误，因为此类引用是不明确的。

[http://docs.oracle.com/javase/specs/jls/se7/html/jls-6.html#jls-6.5.6.1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-6.html#jls-6.5.6.1)

> 如果表达式名称由单个标识符组成，那么在标识符出现的点处必须有一个声明表示局部变量、参数或可见字段（第 6.4.1 节）。否则，会发生编译时错误。

# c# - 使用 Windows 应用程序修改 Windows 服务使用的设置

> ID：15033987
> 
> 赞同：1
> 
> 时间：2013-02-22T22:05:40.853
> 
> 标签：c#, windows, service, settings, installshield

我目前有一个使用 InstallSheild LE 安装的 Windows 服务（作为 LocalSystem 运行）。该服务旨在从本地数据库文件中读取一些数据，将其打包，并以设定的时间间隔将其发布到外部服务器。而是具有硬编码的数据库位置、服务器 url 等，我想从设置文件中读取它们。我可以使用 App.config 轻松地做到这一点，但从我的研究中我了解到，修改 App.config（或 Program Files 中的任何文件）在安装后很难/不可能。

我的问题是拥有一个应用程序的最佳方式是什么，我可以运行该应用程序来修改服务的必要设置，而无需“以管理员身份运行”。我应该将这些设置放在注册表中吗？将它们放在 AppData 中是正确的答案吗？如果是，这些设置如何在设置更改应用程序和服务之间共享？

我更像是一个 Web 应用程序开发人员，并且在桌面应用程序/服务开发方面还没有太多经验，所以任何朝着正确方向发展的点都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T22:14:12.633

您可以在应用程序安装目录之外找到 App.Config，并将其放在一个公共文件夹中（如 AppData）。然后，您将告诉您的应用程序从那里加载它，而不是仅仅从应用程序安装目录中拉取它。

[ConfigurationManager.OpenMappedExeConfig](http://msdn.microsoft.com/en-us/library/ms134269.aspx)允许您从自定义位置加载配置。

```
// Access a configuration file using mapping. 
  // This function uses the OpenMappedExeConfiguration  
  // method to access a new configuration file.    
  // It also gets the custom ConsoleSection and  
  // sets its ConsoleEment BackgroundColor and 
  // ForegroundColor properties to green and red 
  // respectively. Then it uses these properties to 
  // set the console colors.   
  public static void MapExeConfiguration()
  {

    // Get the application configuration file.
    System.Configuration.Configuration config =
      ConfigurationManager.OpenExeConfiguration(
            ConfigurationUserLevel.None);

    Console.WriteLine(config.FilePath);

    if (config == null)
    {
      Console.WriteLine(
        "The configuration file does not exist.");
      Console.WriteLine(
       "Use OpenExeConfiguration to create the file.");
    }

    // Create a new configuration file by saving  
    // the application configuration to a new file. 
    string appName = 
      Environment.GetCommandLineArgs()[0];

    string configFile =  string.Concat(appName, 
      ".2.config");
    config.SaveAs(configFile, ConfigurationSaveMode.Full);

    // Map the new configuration file.
    ExeConfigurationFileMap configFileMap = 
        new ExeConfigurationFileMap();
    configFileMap.ExeConfigFilename = configFile;

    // Get the mapped configuration file
   config = 
      ConfigurationManager.OpenMappedExeConfiguration(
        configFileMap, ConfigurationUserLevel.None);

    // Make changes to the new configuration file.  
    // This is to show that this file is the  
    // one that is used. 
    string sectionName = "consoleSection";

    ConsoleSection customSection =
      (ConsoleSection)config.GetSection(sectionName);

    if (customSection == null)
    {
        customSection = new ConsoleSection();
        config.Sections.Add(sectionName, customSection);
    }
    else 
        // Change the section configuration values.
        customSection =
            (ConsoleSection)config.GetSection(sectionName);

    customSection.ConsoleElement.BackgroundColor =
        ConsoleColor.Green;
    customSection.ConsoleElement.ForegroundColor =
        ConsoleColor.Red;

    // Save the configuration file.
    config.Save(ConfigurationSaveMode.Modified);

    // Force a reload of the changed section. This  
    // makes the new values available for reading.
    ConfigurationManager.RefreshSection(sectionName);

    // Set console properties using the  
    // configuration values contained in the  
    // new configuration file.
    Console.BackgroundColor =
      customSection.ConsoleElement.BackgroundColor;
    Console.ForegroundColor =
      customSection.ConsoleElement.ForegroundColor;
    Console.Clear();

    Console.WriteLine();
    Console.WriteLine("Using OpenMappedExeConfiguration.");
    Console.WriteLine("Configuration file is: {0}", 
      config.FilePath);
  } 
```

样本来源：[MSDN](http://msdn.microsoft.com/en-us/library/ms134269.aspx)

# javascript - 在继续执行默认操作之前执行 AJAX 请求

> ID：15033991
> 
> 赞同：-5
> 
> 时间：2013-02-22T22:05:48.210
> 
> 标签：javascript, jquery, ajax, preventdefault

我有一个基本的 AJAX 请求，如下所示：

```
 $.ajax({
        url: 'check_password.php',
        type: 'post',
        data: 'password='+password,
        dataType: 'json',
        success: function(json) {
            if (json['success']) {
               //Continue with default action
            }else{
                //Password is invalid, stop the script and return an error
                preventDefault();
                $(".error").show();
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:24:41.703

我建议完全阻止默认设置，然后通过`.submit()`在表单节点上使用提交表单（如果它是表单），从而绕过 jQuery 事件处理程序。

```
$("#myform").on("submit",function(event){
    event.preventDefault();
    var form = this;
    $.ajax({
        url: theurl,
        type: "POST",
        data: thedata
        dataType: "json"
    }).done(function(json){
        if (json.success) {
            form.submit();
        }
        else {
            $("#error").show();
        }
    });    
}); 
```

# ruby-on-rails - 设计：自定义用户注册表单，但更改不会出现在 rails 应用程序上？

> ID：15033998
> 
> 赞同：0
> 
> 时间：2013-02-22T22:06:08.607
> 
> 标签：ruby-on-rails, ruby, devise

我已经关注了这个网站上的所有内容：http: [//eureka.ykyuen.info/2011/03/03/rails-%E2%80%93-add-custom-fields-to-devise-user-model/](http://eureka.ykyuen.info/2011/03/03/rails-%E2%80%93-add-custom-fields-to-devise-user-model/)

所有信息似乎都是可靠的，并且在没有 ROR 给我任何错误的情况下运行，但在 rails 应用程序上，注册或登录页面上没有用户名文本字段。我将如何解决这个问题？如果您需要，请要求更多说明:)

感谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T22:07:07.663

尝试`config.scoped_views = true`在“config/initializers/devise.rb”中添加。并重新启动您的服务器。